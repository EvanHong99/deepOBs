This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/CHTR_orderbooks/CHTR_orderbooks_2019-11-13.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-11-05.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-10-23.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-10-24.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-11-01.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-10-28.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-10-30.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-10-25.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-11-15.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-10-29.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-11-11.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-10-31.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-10-22.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-11-07.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-11-06.csv
training model: results/CHTR/W8/deepLOB_L1/h10
Epoch 1/50
358/358 - 18s - loss: 3.3351 - accuracy10: 0.3538 - val_loss: 3.3549 - val_accuracy10: 0.3437 - 18s/epoch - 52ms/step
Epoch 2/50
358/358 - 8s - loss: 3.2995 - accuracy10: 0.3631 - val_loss: 3.3486 - val_accuracy10: 0.3428 - 8s/epoch - 23ms/step
Epoch 3/50
358/358 - 9s - loss: 3.2776 - accuracy10: 0.3762 - val_loss: 3.3335 - val_accuracy10: 0.3517 - 9s/epoch - 24ms/step
Epoch 4/50
358/358 - 8s - loss: 3.2680 - accuracy10: 0.3838 - val_loss: 3.3356 - val_accuracy10: 0.3569 - 8s/epoch - 23ms/step
Epoch 5/50
358/358 - 9s - loss: 3.2543 - accuracy10: 0.3908 - val_loss: 3.3330 - val_accuracy10: 0.3535 - 9s/epoch - 24ms/step
Epoch 6/50
358/358 - 8s - loss: 3.2486 - accuracy10: 0.3948 - val_loss: 3.3353 - val_accuracy10: 0.3607 - 8s/epoch - 24ms/step
Epoch 7/50
358/358 - 8s - loss: 3.2423 - accuracy10: 0.3999 - val_loss: 3.3137 - val_accuracy10: 0.3675 - 8s/epoch - 23ms/step
Epoch 8/50
358/358 - 8s - loss: 3.2381 - accuracy10: 0.4022 - val_loss: 3.3225 - val_accuracy10: 0.3642 - 8s/epoch - 23ms/step
Epoch 9/50
358/358 - 8s - loss: 3.2338 - accuracy10: 0.4035 - val_loss: 3.3177 - val_accuracy10: 0.3682 - 8s/epoch - 24ms/step
Epoch 10/50
358/358 - 8s - loss: 3.2297 - accuracy10: 0.4073 - val_loss: 3.3148 - val_accuracy10: 0.3709 - 8s/epoch - 24ms/step
Epoch 11/50
358/358 - 9s - loss: 3.2259 - accuracy10: 0.4076 - val_loss: 3.3013 - val_accuracy10: 0.3735 - 9s/epoch - 24ms/step
Epoch 12/50
358/358 - 9s - loss: 3.2231 - accuracy10: 0.4114 - val_loss: 3.3178 - val_accuracy10: 0.3677 - 9s/epoch - 24ms/step
Epoch 13/50
358/358 - 9s - loss: 3.2168 - accuracy10: 0.4123 - val_loss: 3.3008 - val_accuracy10: 0.3754 - 9s/epoch - 24ms/step
Epoch 14/50
358/358 - 8s - loss: 3.2140 - accuracy10: 0.4143 - val_loss: 3.3216 - val_accuracy10: 0.3668 - 8s/epoch - 23ms/step
Epoch 15/50
358/358 - 9s - loss: 3.2114 - accuracy10: 0.4170 - val_loss: 3.3222 - val_accuracy10: 0.3643 - 9s/epoch - 24ms/step
Epoch 16/50
358/358 - 8s - loss: 3.2095 - accuracy10: 0.4163 - val_loss: 3.3109 - val_accuracy10: 0.3724 - 8s/epoch - 24ms/step
Epoch 17/50
358/358 - 8s - loss: 3.2045 - accuracy10: 0.4195 - val_loss: 3.3248 - val_accuracy10: 0.3669 - 8s/epoch - 23ms/step
Epoch 18/50
358/358 - 8s - loss: 3.2007 - accuracy10: 0.4221 - val_loss: 3.3152 - val_accuracy10: 0.3645 - 8s/epoch - 24ms/step
Epoch 19/50
358/358 - 8s - loss: 3.1998 - accuracy10: 0.4236 - val_loss: 3.3313 - val_accuracy10: 0.3683 - 8s/epoch - 23ms/step
Epoch 20/50
358/358 - 8s - loss: 3.1945 - accuracy10: 0.4247 - val_loss: 3.3324 - val_accuracy10: 0.3630 - 8s/epoch - 23ms/step
Epoch 21/50
358/358 - 8s - loss: 3.1931 - accuracy10: 0.4251 - val_loss: 3.3294 - val_accuracy10: 0.3709 - 8s/epoch - 23ms/step
Epoch 22/50
358/358 - 8s - loss: 3.1870 - accuracy10: 0.4265 - val_loss: 3.3541 - val_accuracy10: 0.3657 - 8s/epoch - 23ms/step
Epoch 23/50
358/358 - 8s - loss: 3.1873 - accuracy10: 0.4277 - val_loss: 3.3368 - val_accuracy10: 0.3637 - 8s/epoch - 23ms/step
testing model: results/CHTR/W8/deepLOB_L1/h10
Evaluating performance on  test set...
1223/1223 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1061586
{'0': {'precision': 0.36149032602593417, 'recall': 0.5155897546066187, 'f1-score': 0.425002716636683, 'support': 102407}, '1': {'precision': 0.3547468900346936, 'recall': 0.34107977110842863, 'f1-score': 0.34777910882484203, 'support': 108523}, '2': {'precision': 0.3689345191524693, 'recall': 0.22630089223627123, 'f1-score': 0.28052837335793895, 'support': 102103}, 'accuracy': 0.3607319356106225, 'macro avg': {'precision': 0.3617239117376991, 'recall': 0.3609901393171062, 'f1-score': 0.351103399606488, 'support': 313033}, 'weighted avg': {'precision': 0.36158059301606377, 'recall': 0.3607319356106225, 'f1-score': 0.3511069885110412, 'support': 313033}}
[[52800 30587 19020]
 [51005 37015 20503]
 [42257 36740 23106]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0922301
{'0': {'precision': 0.4011159178055255, 'recall': 0.5168820473837578, 'f1-score': 0.45169951284322407, 'support': 31572}, '1': {'precision': 0.35981399493219723, 'recall': 0.4291027429102743, 'f1-score': 0.39141563299862175, 'support': 30114}, '2': {'precision': 0.37957090810956684, 'recall': 0.18921736790771196, 'f1-score': 0.2525418022668612, 'support': 29733}, 'accuracy': 0.3813977400759142, 'macro avg': {'precision': 0.38016694028242987, 'recall': 0.37840071940058134, 'f1-score': 0.3652189827029024, 'support': 91419}, 'weighted avg': {'precision': 0.3805035300229273, 'recall': 0.3813977400759142, 'f1-score': 0.3670678173947139, 'support': 91419}}
[[16319 10715  4538]
 [12534 12922  4658]
 [11831 12276  5626]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0978446
{'0': {'precision': 0.39357196246158954, 'recall': 0.5549180327868852, 'f1-score': 0.46052184053253, 'support': 8540}, '1': {'precision': 0.34611953612845675, 'recall': 0.47589844229118117, 'f1-score': 0.40076434436812475, 'support': 8153}, '2': {'precision': 0.43946188340807174, 'recall': 0.10297723292469352, 'f1-score': 0.16685584562996594, 'support': 8565}, 'accuracy': 0.3761580489349909, 'macro avg': {'precision': 0.393051127332706, 'recall': 0.37793123600091993, 'f1-score': 0.3427140101768736, 'support': 25258}, 'weighted avg': {'precision': 0.3938161441470986, 'recall': 0.3761580489349909, 'f1-score': 0.34165050817965736, 'support': 25258}}
[[4739 3295  506]
 [3654 3880  619]
 [3648 4035  882]]
training model: results/CHTR/W8/deepLOB_L1/h20
Epoch 1/50
358/358 - 11s - loss: 3.3368 - accuracy20: 0.3512 - val_loss: 3.3539 - val_accuracy20: 0.3388 - 11s/epoch - 29ms/step
Epoch 2/50
358/358 - 8s - loss: 3.2980 - accuracy20: 0.3627 - val_loss: 3.3672 - val_accuracy20: 0.3410 - 8s/epoch - 24ms/step
Epoch 3/50
358/358 - 8s - loss: 3.2847 - accuracy20: 0.3704 - val_loss: 3.3061 - val_accuracy20: 0.3607 - 8s/epoch - 23ms/step
Epoch 4/50
358/358 - 8s - loss: 3.2702 - accuracy20: 0.3795 - val_loss: 3.2870 - val_accuracy20: 0.3702 - 8s/epoch - 24ms/step
Epoch 5/50
358/358 - 8s - loss: 3.2606 - accuracy20: 0.3874 - val_loss: 3.2901 - val_accuracy20: 0.3691 - 8s/epoch - 23ms/step
Epoch 6/50
358/358 - 8s - loss: 3.2565 - accuracy20: 0.3913 - val_loss: 3.2941 - val_accuracy20: 0.3673 - 8s/epoch - 23ms/step
Epoch 7/50
358/358 - 8s - loss: 3.2500 - accuracy20: 0.3941 - val_loss: 3.2877 - val_accuracy20: 0.3712 - 8s/epoch - 23ms/step
Epoch 8/50
358/358 - 8s - loss: 3.2493 - accuracy20: 0.3956 - val_loss: 3.2917 - val_accuracy20: 0.3739 - 8s/epoch - 24ms/step
Epoch 9/50
358/358 - 8s - loss: 3.2413 - accuracy20: 0.4005 - val_loss: 3.2887 - val_accuracy20: 0.3756 - 8s/epoch - 23ms/step
Epoch 10/50
358/358 - 8s - loss: 3.2389 - accuracy20: 0.4020 - val_loss: 3.2997 - val_accuracy20: 0.3723 - 8s/epoch - 23ms/step
Epoch 11/50
358/358 - 8s - loss: 3.2357 - accuracy20: 0.4039 - val_loss: 3.2998 - val_accuracy20: 0.3711 - 8s/epoch - 24ms/step
Epoch 12/50
358/358 - 8s - loss: 3.2331 - accuracy20: 0.4042 - val_loss: 3.2991 - val_accuracy20: 0.3751 - 8s/epoch - 24ms/step
Epoch 13/50
358/358 - 8s - loss: 3.2294 - accuracy20: 0.4071 - val_loss: 3.3022 - val_accuracy20: 0.3713 - 8s/epoch - 23ms/step
Epoch 14/50
358/358 - 9s - loss: 3.2277 - accuracy20: 0.4072 - val_loss: 3.3179 - val_accuracy20: 0.3682 - 9s/epoch - 24ms/step
testing model: results/CHTR/W8/deepLOB_L1/h20
Evaluating performance on  test set...
1223/1223 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1010603
{'0': {'precision': 0.3525050535644914, 'recall': 0.5131803454688368, 'f1-score': 0.4179316536232167, 'support': 104322}, '1': {'precision': 0.35222366888234086, 'recall': 0.23812391709210856, 'f1-score': 0.2841474470955045, 'support': 107927}, '2': {'precision': 0.35701570383808606, 'recall': 0.3124206223210033, 'f1-score': 0.3332327930616629, 'support': 100784}, 'accuracy': 0.3537103116923775, 'macro avg': {'precision': 0.35391480876163944, 'recall': 0.3545749616273162, 'f1-score': 0.34510396459346143, 'support': 313033}, 'weighted avg': {'precision': 0.3538602856728746, 'recall': 0.3537103116923775, 'f1-score': 0.3445361393459615, 'support': 313033}}
[[53536 23422 27364]
 [52883 25700 29344]
 [45454 23843 31487]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0990866
{'0': {'precision': 0.3755189028910304, 'recall': 0.6439853805815986, 'f1-score': 0.47440444834650286, 'support': 31465}, '1': {'precision': 0.3573731281198003, 'recall': 0.22837680677853464, 'f1-score': 0.2786709104547206, 'support': 30095}, '2': {'precision': 0.3721402315246612, 'recall': 0.22716768813423088, 'f1-score': 0.28211953583163496, 'support': 29859}, 'accuracy': 0.37102790448375067, 'macro avg': {'precision': 0.3683440875118306, 'recall': 0.36650995849812135, 'f1-score': 0.34506496487761945, 'support': 91419}, 'weighted avg': {'precision': 0.3684418090695208, 'recall': 0.37102790448375067, 'f1-score': 0.3471657340132173, 'support': 91419}}
[[20263  5807  5395]
 [17173  6873  6049]
 [16524  6552  6783]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0941929
{'0': {'precision': 0.37804167273786976, 'recall': 0.6027413172261586, 'f1-score': 0.4646518916498769, 'support': 8609}, '1': {'precision': 0.33495145631067963, 'recall': 0.2496081032195828, 'f1-score': 0.2860498859946107, 'support': 8293}, '2': {'precision': 0.37649476831091183, 'recall': 0.24114408808042126, 'f1-score': 0.2939889115844762, 'support': 8356}, 'accuracy': 0.36717079737112995, 'macro avg': {'precision': 0.3631626324531538, 'recall': 0.3644978361753876, 'f1-score': 0.34823022974298795, 'support': 25258}, 'weighted avg': {'precision': 0.36338203625745374, 'recall': 0.36717079737112995, 'f1-score': 0.3495514761646599, 'support': 25258}}
[[5189 1891 1529]
 [4415 2070 1808]
 [4122 2219 2015]]
training model: results/CHTR/W8/deepLOB_L1/h30
Epoch 1/50
358/358 - 11s - loss: 3.3374 - accuracy30: 0.3528 - val_loss: 3.3753 - val_accuracy30: 0.3349 - 11s/epoch - 30ms/step
Epoch 2/50
358/358 - 8s - loss: 3.3051 - accuracy30: 0.3578 - val_loss: 3.2993 - val_accuracy30: 0.3502 - 8s/epoch - 24ms/step
Epoch 3/50
358/358 - 9s - loss: 3.2888 - accuracy30: 0.3651 - val_loss: 3.3181 - val_accuracy30: 0.3498 - 9s/epoch - 24ms/step
Epoch 4/50
358/358 - 8s - loss: 3.2785 - accuracy30: 0.3739 - val_loss: 3.2996 - val_accuracy30: 0.3458 - 8s/epoch - 23ms/step
Epoch 5/50
358/358 - 8s - loss: 3.2707 - accuracy30: 0.3780 - val_loss: 3.2903 - val_accuracy30: 0.3625 - 8s/epoch - 23ms/step
Epoch 6/50
358/358 - 9s - loss: 3.2665 - accuracy30: 0.3824 - val_loss: 3.2877 - val_accuracy30: 0.3629 - 9s/epoch - 24ms/step
Epoch 7/50
358/358 - 9s - loss: 3.2588 - accuracy30: 0.3876 - val_loss: 3.2898 - val_accuracy30: 0.3596 - 9s/epoch - 24ms/step
Epoch 8/50
358/358 - 9s - loss: 3.2544 - accuracy30: 0.3923 - val_loss: 3.2977 - val_accuracy30: 0.3555 - 9s/epoch - 24ms/step
Epoch 9/50
358/358 - 9s - loss: 3.2503 - accuracy30: 0.3938 - val_loss: 3.3073 - val_accuracy30: 0.3534 - 9s/epoch - 24ms/step
Epoch 10/50
358/358 - 8s - loss: 3.2468 - accuracy30: 0.3939 - val_loss: 3.3156 - val_accuracy30: 0.3522 - 8s/epoch - 24ms/step
Epoch 11/50
358/358 - 8s - loss: 3.2435 - accuracy30: 0.3966 - val_loss: 3.3033 - val_accuracy30: 0.3522 - 8s/epoch - 23ms/step
Epoch 12/50
358/358 - 9s - loss: 3.2373 - accuracy30: 0.4008 - val_loss: 3.3006 - val_accuracy30: 0.3517 - 9s/epoch - 24ms/step
Epoch 13/50
358/358 - 8s - loss: 3.2363 - accuracy30: 0.4013 - val_loss: 3.2938 - val_accuracy30: 0.3576 - 8s/epoch - 24ms/step
Epoch 14/50
358/358 - 8s - loss: 3.2331 - accuracy30: 0.4038 - val_loss: 3.3001 - val_accuracy30: 0.3555 - 8s/epoch - 24ms/step
Epoch 15/50
358/358 - 8s - loss: 3.2285 - accuracy30: 0.4068 - val_loss: 3.2968 - val_accuracy30: 0.3547 - 8s/epoch - 24ms/step
Epoch 16/50
358/358 - 8s - loss: 3.2259 - accuracy30: 0.4067 - val_loss: 3.3067 - val_accuracy30: 0.3503 - 8s/epoch - 23ms/step
testing model: results/CHTR/W8/deepLOB_L1/h30
Evaluating performance on  test set...
1223/1223 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0976738
{'0': {'precision': 0.3534719674589536, 'recall': 0.516646127505856, 'f1-score': 0.4197589366922201, 'support': 106301}, '1': {'precision': 0.33467530767216547, 'recall': 0.2885266563828586, 'f1-score': 0.3098923080031519, 'support': 106316}, '2': {'precision': 0.3689776377189261, 'recall': 0.2425310707456979, 'f1-score': 0.29268116812883066, 'support': 100416}, 'accuracy': 0.3512377289295378, 'macro avg': {'precision': 0.3523749709500151, 'recall': 0.3492346182114708, 'f1-score': 0.3407774709414009, 'support': 313033}, 'weighted avg': {'precision': 0.3520619937594817, 'recall': 0.3512377289295378, 'f1-score': 0.3416801983363014, 'support': 313033}}
[[54920 31225 20156]
 [54147 30675 21494]
 [46306 29756 24354]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0950782
{'0': {'precision': 0.3733191645890383, 'recall': 0.5822098989705835, 'f1-score': 0.4549314539726812, 'support': 31377}, '1': {'precision': 0.33686421331385263, 'recall': 0.24563856705286988, 'f1-score': 0.2841079748931418, 'support': 30036}, '2': {'precision': 0.3828887917213234, 'recall': 0.2626474705058988, 'f1-score': 0.31156970882998275, 'support': 30006}, 'accuracy': 0.3667399555891007, 'macro avg': {'precision': 0.36435738987473815, 'recall': 0.3634986455097841, 'f1-score': 0.3502030458986019, 'support': 91419}, 'weighted avg': {'precision': 0.36448276641393107, 'recall': 0.3667399555891007, 'f1-score': 0.3517519558116331, 'support': 91419}}
[[18268  7150  5959]
 [15915  7378  6743]
 [14751  7374  7881]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0945066
{'0': {'precision': 0.3713235294117647, 'recall': 0.5965257672264042, 'f1-score': 0.4577242635624472, 'support': 8635}, '1': {'precision': 0.33373955431754876, 'recall': 0.22867708457592748, 'f1-score': 0.2713952006795498, 'support': 8383}, '2': {'precision': 0.3828429634881248, 'recall': 0.2621359223300971, 'f1-score': 0.3111943523987898, 'support': 8240}, 'accuracy': 0.36534959220840924, 'macro avg': {'precision': 0.3626353490724794, 'recall': 0.36244625804414293, 'f1-score': 0.3467712722135956, 'support': 25258}, 'weighted avg': {'precision': 0.36260762449349704, 'recall': 0.36534959220840924, 'f1-score': 0.34807967562453185, 'support': 25258}}
[[5151 1882 1602]
 [4586 1917 1880]
 [4135 1945 2160]]
training model: results/CHTR/W8/deepLOB_L1/h50
Epoch 1/50
358/358 - 11s - loss: 3.3487 - accuracy50: 0.3448 - val_loss: 3.3613 - val_accuracy50: 0.3433 - 11s/epoch - 32ms/step
Epoch 2/50
358/358 - 9s - loss: 3.3105 - accuracy50: 0.3526 - val_loss: 3.3240 - val_accuracy50: 0.3444 - 9s/epoch - 25ms/step
Epoch 3/50
358/358 - 8s - loss: 3.2986 - accuracy50: 0.3561 - val_loss: 3.3133 - val_accuracy50: 0.3431 - 8s/epoch - 24ms/step
Epoch 4/50
358/358 - 8s - loss: 3.2866 - accuracy50: 0.3655 - val_loss: 3.3220 - val_accuracy50: 0.3451 - 8s/epoch - 23ms/step
Epoch 5/50
358/358 - 9s - loss: 3.2807 - accuracy50: 0.3697 - val_loss: 3.3141 - val_accuracy50: 0.3439 - 9s/epoch - 24ms/step
Epoch 6/50
358/358 - 9s - loss: 3.2740 - accuracy50: 0.3734 - val_loss: 3.3313 - val_accuracy50: 0.3452 - 9s/epoch - 24ms/step
Epoch 7/50
358/358 - 9s - loss: 3.2682 - accuracy50: 0.3774 - val_loss: 3.3218 - val_accuracy50: 0.3460 - 9s/epoch - 24ms/step
Epoch 8/50
358/358 - 9s - loss: 3.2639 - accuracy50: 0.3809 - val_loss: 3.3223 - val_accuracy50: 0.3496 - 9s/epoch - 24ms/step
Epoch 9/50
358/358 - 9s - loss: 3.2622 - accuracy50: 0.3828 - val_loss: 3.3207 - val_accuracy50: 0.3471 - 9s/epoch - 24ms/step
Epoch 10/50
358/358 - 8s - loss: 3.2578 - accuracy50: 0.3854 - val_loss: 3.3175 - val_accuracy50: 0.3498 - 8s/epoch - 24ms/step
Epoch 11/50
358/358 - 8s - loss: 3.2550 - accuracy50: 0.3887 - val_loss: 3.3133 - val_accuracy50: 0.3559 - 8s/epoch - 23ms/step
Epoch 12/50
358/358 - 8s - loss: 3.2517 - accuracy50: 0.3901 - val_loss: 3.3214 - val_accuracy50: 0.3555 - 8s/epoch - 23ms/step
Epoch 13/50
358/358 - 8s - loss: 3.2487 - accuracy50: 0.3928 - val_loss: 3.3265 - val_accuracy50: 0.3507 - 8s/epoch - 24ms/step
Epoch 14/50
358/358 - 8s - loss: 3.2486 - accuracy50: 0.3926 - val_loss: 3.3171 - val_accuracy50: 0.3536 - 8s/epoch - 23ms/step
Epoch 15/50
358/358 - 9s - loss: 3.2441 - accuracy50: 0.3962 - val_loss: 3.3226 - val_accuracy50: 0.3487 - 9s/epoch - 24ms/step
Epoch 16/50
358/358 - 8s - loss: 3.2437 - accuracy50: 0.3957 - val_loss: 3.3154 - val_accuracy50: 0.3539 - 8s/epoch - 24ms/step
Epoch 17/50
358/358 - 8s - loss: 3.2394 - accuracy50: 0.3997 - val_loss: 3.3317 - val_accuracy50: 0.3524 - 8s/epoch - 23ms/step
Epoch 18/50
358/358 - 8s - loss: 3.2395 - accuracy50: 0.3987 - val_loss: 3.3314 - val_accuracy50: 0.3484 - 8s/epoch - 24ms/step
Epoch 19/50
358/358 - 8s - loss: 3.2362 - accuracy50: 0.4020 - val_loss: 3.3327 - val_accuracy50: 0.3508 - 8s/epoch - 23ms/step
Epoch 20/50
358/358 - 8s - loss: 3.2318 - accuracy50: 0.4049 - val_loss: 3.3224 - val_accuracy50: 0.3552 - 8s/epoch - 23ms/step
Epoch 21/50
358/358 - 8s - loss: 3.2317 - accuracy50: 0.4022 - val_loss: 3.3341 - val_accuracy50: 0.3486 - 8s/epoch - 23ms/step
testing model: results/CHTR/W8/deepLOB_L1/h50
Evaluating performance on  test set...
1223/1223 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.103976
{'0': {'precision': 0.3520106420348861, 'recall': 0.5785035584494246, 'f1-score': 0.4376922113026511, 'support': 105664}, '1': {'precision': 0.33888819279121246, 'recall': 0.2970039715221728, 'f1-score': 0.3165666910509632, 'support': 109278}, '2': {'precision': 0.3428112818160972, 'recall': 0.15240949730352427, 'f1-score': 0.2110076851962936, 'support': 98091}, 'accuracy': 0.34671424418511787, 'macro avg': {'precision': 0.34457003888073184, 'recall': 0.34263900909170725, 'f1-score': 0.3217555291833027, 'support': 313033}, 'weighted avg': {'precision': 0.34454698979479836, 'recall': 0.34671424418511787, 'f1-score': 0.32437487270779797, 'support': 313033}}
[[61127 30503 14034]
 [62196 32456 14626]
 [50328 32813 14950]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1065497
{'0': {'precision': 0.36440775802355113, 'recall': 0.6061837851678776, 'f1-score': 0.45518235894970865, 'support': 31243}, '1': {'precision': 0.3454665058655849, 'recall': 0.31248553766817627, 'f1-score': 0.32814940812996846, 'support': 30251}, '2': {'precision': 0.35526315789473684, 'recall': 0.14345864661654134, 'f1-score': 0.2043847746911376, 'support': 29925}, 'accuracy': 0.357529616381715, 'macro avg': {'precision': 0.3550458072612909, 'recall': 0.35404265648419836, 'f1-score': 0.32923884725693825, 'support': 91419}, 'weighted avg': {'precision': 0.35514661999004166, 'recall': 0.357529616381715, 'f1-score': 0.3310507068403474, 'support': 91419}}
[[18939  8488  3816]
 [16823  9453  3975]
 [16210  9422  4293]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1036369
{'0': {'precision': 0.35523678276121273, 'recall': 0.6633524388817406, 'f1-score': 0.46269326479827033, 'support': 8549}, '1': {'precision': 0.34938524590163933, 'recall': 0.28052650135151014, 'f1-score': 0.3111922299719705, 'support': 8509}, '2': {'precision': 0.3476848090982941, 'recall': 0.10439024390243902, 'f1-score': 0.1605702494841493, 'support': 8200}, 'accuracy': 0.35291788740201124, 'macro avg': {'precision': 0.35076894592038205, 'recall': 0.3494230613785632, 'f1-score': 0.3114852480847967, 'support': 25258}, 'weighted avg': {'precision': 0.3508137519917914, 'recall': 0.35291788740201124, 'f1-score': 0.31357096568857135, 'support': 25258}}
[[5671 2143  735]
 [5251 2387  871]
 [5042 2302  856]]
training model: results/CHTR/W8/deepLOB_L1/h100
Epoch 1/50
358/358 - 10s - loss: 3.3460 - accuracy100: 0.3477 - val_loss: 3.3819 - val_accuracy100: 0.3410 - 10s/epoch - 29ms/step
Epoch 2/50
358/358 - 9s - loss: 3.3150 - accuracy100: 0.3459 - val_loss: 3.3152 - val_accuracy100: 0.3370 - 9s/epoch - 24ms/step
Epoch 3/50
358/358 - 8s - loss: 3.3016 - accuracy100: 0.3522 - val_loss: 3.3096 - val_accuracy100: 0.3483 - 8s/epoch - 24ms/step
Epoch 4/50
358/358 - 8s - loss: 3.2940 - accuracy100: 0.3564 - val_loss: 3.3178 - val_accuracy100: 0.3469 - 8s/epoch - 24ms/step
Epoch 5/50
358/358 - 9s - loss: 3.2877 - accuracy100: 0.3626 - val_loss: 3.3123 - val_accuracy100: 0.3474 - 9s/epoch - 24ms/step
Epoch 6/50
358/358 - 8s - loss: 3.2816 - accuracy100: 0.3669 - val_loss: 3.3116 - val_accuracy100: 0.3520 - 8s/epoch - 24ms/step
Epoch 7/50
358/358 - 9s - loss: 3.2772 - accuracy100: 0.3714 - val_loss: 3.3116 - val_accuracy100: 0.3469 - 9s/epoch - 24ms/step
Epoch 8/50
358/358 - 9s - loss: 3.2752 - accuracy100: 0.3750 - val_loss: 3.3123 - val_accuracy100: 0.3528 - 9s/epoch - 24ms/step
Epoch 9/50
358/358 - 8s - loss: 3.2692 - accuracy100: 0.3777 - val_loss: 3.3166 - val_accuracy100: 0.3463 - 8s/epoch - 23ms/step
Epoch 10/50
358/358 - 8s - loss: 3.2656 - accuracy100: 0.3833 - val_loss: 3.3230 - val_accuracy100: 0.3435 - 8s/epoch - 23ms/step
Epoch 11/50
358/358 - 9s - loss: 3.2619 - accuracy100: 0.3852 - val_loss: 3.3295 - val_accuracy100: 0.3418 - 9s/epoch - 24ms/step
Epoch 12/50
358/358 - 8s - loss: 3.2594 - accuracy100: 0.3871 - val_loss: 3.3253 - val_accuracy100: 0.3467 - 8s/epoch - 24ms/step
Epoch 13/50
358/358 - 8s - loss: 3.2564 - accuracy100: 0.3888 - val_loss: 3.3294 - val_accuracy100: 0.3436 - 8s/epoch - 23ms/step
testing model: results/CHTR/W8/deepLOB_L1/h100
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.102199
{'0': {'precision': 0.33400224678105406, 'recall': 0.3353352291897624, 'f1-score': 0.334667410671336, 'support': 103735}, '1': {'precision': 0.3556404147982063, 'recall': 0.4487242958431317, 'f1-score': 0.39679636013977815, 'support': 113114}, '2': {'precision': 0.3276404086814582, 'recall': 0.2253805206687183, 'f1-score': 0.26705595387685716, 'support': 96184}, 'accuracy': 0.34252299278350845, 'macro avg': {'precision': 0.33909435675357286, 'recall': 0.3364800152338708, 'f1-score': 0.3328399082293238, 'support': 313033}, 'weighted avg': {'precision': 0.3398663975297631, 'recall': 0.34252299278350845, 'f1-score': 0.3363429964078341, 'support': 313033}}
[[34786 47646 21303]
 [39174 50757 23183]
 [30189 44317 21678]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1138737
{'0': {'precision': 0.34915586832222484, 'recall': 0.3339373543877815, 'f1-score': 0.34137708605547373, 'support': 30904}, '1': {'precision': 0.3315868928159133, 'recall': 0.4955540809555408, 'f1-score': 0.3973185784209406, 'support': 30140}, '2': {'precision': 0.3497443215602331, 'recall': 0.19364609053497941, 'f1-score': 0.2492742567753692, 'support': 30375}, 'accuracy': 0.340607532351043, 'macro avg': {'precision': 0.3434956942327904, 'recall': 0.34104584195943394, 'f1-score': 0.3293233070839278, 'support': 91419}, 'weighted avg': {'precision': 0.3435590596210169, 'recall': 0.340607532351043, 'f1-score': 0.32921826940370547, 'support': 91419}}
[[10320 15128  5456]
 [ 9724 14936  5480]
 [ 9513 14980  5882]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1028947
{'0': {'precision': 0.3485135989879823, 'recall': 0.3242320819112628, 'f1-score': 0.335934642116815, 'support': 8497}, '1': {'precision': 0.34272441180878166, 'recall': 0.5276271772984197, 'f1-score': 0.4155348625936861, 'support': 8669}, '2': {'precision': 0.3311704517095084, 'recall': 0.16398912506178942, 'f1-score': 0.21935697165054963, 'support': 8092}, 'accuracy': 0.34270330192414283, 'macro avg': {'precision': 0.3408028208354241, 'recall': 0.3386161280904907, 'f1-score': 0.3236088254536836, 'support': 25258}, 'weighted avg': {'precision': 0.3409703567901083, 'recall': 0.34270330192414283, 'f1-score': 0.3259064451851884, 'support': 25258}}
[[2755 4458 1284]
 [2699 4574 1396]
 [2451 4314 1327]]
training model: results/CHTR/W8/deepLOB_L1/h200
Epoch 1/50
358/358 - 11s - loss: 3.3516 - accuracy200: 0.3435 - val_loss: 3.4135 - val_accuracy200: 0.3420 - 11s/epoch - 29ms/step
Epoch 2/50
358/358 - 8s - loss: 3.3159 - accuracy200: 0.3509 - val_loss: 3.3585 - val_accuracy200: 0.3368 - 8s/epoch - 24ms/step
Epoch 3/50
358/358 - 8s - loss: 3.3034 - accuracy200: 0.3544 - val_loss: 3.4156 - val_accuracy200: 0.3366 - 8s/epoch - 24ms/step
Epoch 4/50
358/358 - 8s - loss: 3.2989 - accuracy200: 0.3561 - val_loss: 3.4269 - val_accuracy200: 0.3374 - 8s/epoch - 24ms/step
Epoch 5/50
358/358 - 9s - loss: 3.2835 - accuracy200: 0.3657 - val_loss: 3.3991 - val_accuracy200: 0.3382 - 9s/epoch - 24ms/step
Epoch 6/50
358/358 - 8s - loss: 3.2760 - accuracy200: 0.3741 - val_loss: 3.4103 - val_accuracy200: 0.3389 - 8s/epoch - 23ms/step
Epoch 7/50
358/358 - 8s - loss: 3.2751 - accuracy200: 0.3752 - val_loss: 3.4853 - val_accuracy200: 0.3353 - 8s/epoch - 23ms/step
Epoch 8/50
358/358 - 8s - loss: 3.2682 - accuracy200: 0.3797 - val_loss: 3.4144 - val_accuracy200: 0.3401 - 8s/epoch - 23ms/step
Epoch 9/50
358/358 - 8s - loss: 3.2666 - accuracy200: 0.3845 - val_loss: 3.4007 - val_accuracy200: 0.3361 - 8s/epoch - 24ms/step
Epoch 10/50
358/358 - 9s - loss: 3.2592 - accuracy200: 0.3897 - val_loss: 3.3723 - val_accuracy200: 0.3384 - 9s/epoch - 24ms/step
Epoch 11/50
358/358 - 8s - loss: 3.2540 - accuracy200: 0.3924 - val_loss: 3.3865 - val_accuracy200: 0.3378 - 8s/epoch - 23ms/step
Epoch 12/50
358/358 - 8s - loss: 3.2491 - accuracy200: 0.3973 - val_loss: 3.4127 - val_accuracy200: 0.3425 - 8s/epoch - 24ms/step
testing model: results/CHTR/W8/deepLOB_L1/h200
Evaluating performance on  test set...
1223/1223 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1202271
{'0': {'precision': 0.32586143633877046, 'recall': 0.28600845133650177, 'f1-score': 0.30463706953005626, 'support': 102469}, '1': {'precision': 0.35209940859422356, 'recall': 0.3791768109805582, 'f1-score': 0.3651368041928935, 'support': 113364}, '2': {'precision': 0.2932365810679708, 'recall': 0.30474279835390944, 'f1-score': 0.29887898937511986, 'support': 97200}, 'accuracy': 0.3255663140946801, 'macro avg': {'precision': 0.32373247533365496, 'recall': 0.3233093535569898, 'f1-score': 0.3228842876993565, 'support': 313033}, 'weighted avg': {'precision': 0.3252330858276277, 'recall': 0.3255663140946801, 'f1-score': 0.32475893057747957, 'support': 313033}}
[[29307 39605 33557]
 [32543 42985 37836]
 [28087 39492 29621]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1206083
{'0': {'precision': 0.3393073621440975, 'recall': 0.3428911992583273, 'f1-score': 0.3410898671014278, 'support': 30202}, '1': {'precision': 0.33558238636363635, 'recall': 0.40564635958395245, 'f1-score': 0.3673030062936331, 'support': 30285}, '2': {'precision': 0.33771099217785094, 'recall': 0.26519462045777836, 'f1-score': 0.2970917387997537, 'support': 30932}, 'accuracy': 0.33739157068005554, 'macro avg': {'precision': 0.33753358022852825, 'recall': 0.33791072643335274, 'f1-score': 0.3351615373982715, 'support': 91419}, 'weighted avg': {'precision': 0.33753322539673425, 'recall': 0.33739157068005554, 'f1-score': 0.3348867235077389, 'support': 91419}}
[[10356 12047  7799]
 [ 9712 12285  8288]
 [10453 12276  8203]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1177976
{'0': {'precision': 0.3449412281665385, 'recall': 0.3704140615783886, 'f1-score': 0.35722411831626844, 'support': 8477}, '1': {'precision': 0.34673850298248987, 'recall': 0.4159741458910434, 'f1-score': 0.3782138734389758, 'support': 8664}, '2': {'precision': 0.3219927095990279, 'recall': 0.22853270912898854, 'f1-score': 0.2673295863957343, 'support': 8117}, 'accuracy': 0.34044659117903237, 'macro avg': {'precision': 0.33789081358268547, 'recall': 0.33830697219947353, 'f1-score': 0.33425585938365954, 'support': 25258}, 'weighted avg': {'precision': 0.3381829125355669, 'recall': 0.34044659117903237, 'f1-score': 0.33553520085582667, 'support': 25258}}
[[3140 3451 1886]
 [3040 3604 2020]
 [2923 3339 1855]]
training model: results/CHTR/W8/deepLOB_L1/h300
Epoch 1/50
358/358 - 11s - loss: 3.3432 - accuracy300: 0.3527 - val_loss: 3.3681 - val_accuracy300: 0.3249 - 11s/epoch - 29ms/step
Epoch 2/50
358/358 - 8s - loss: 3.3193 - accuracy300: 0.3517 - val_loss: 3.3361 - val_accuracy300: 0.3361 - 8s/epoch - 23ms/step
Epoch 3/50
358/358 - 8s - loss: 3.3055 - accuracy300: 0.3537 - val_loss: 3.3229 - val_accuracy300: 0.3406 - 8s/epoch - 23ms/step
Epoch 4/50
358/358 - 8s - loss: 3.2906 - accuracy300: 0.3623 - val_loss: 3.3421 - val_accuracy300: 0.3354 - 8s/epoch - 23ms/step
Epoch 5/50
358/358 - 8s - loss: 3.2817 - accuracy300: 0.3691 - val_loss: 3.3268 - val_accuracy300: 0.3401 - 8s/epoch - 23ms/step
Epoch 6/50
358/358 - 8s - loss: 3.2740 - accuracy300: 0.3762 - val_loss: 3.3552 - val_accuracy300: 0.3366 - 8s/epoch - 24ms/step
Epoch 7/50
358/358 - 8s - loss: 3.2692 - accuracy300: 0.3796 - val_loss: 3.3555 - val_accuracy300: 0.3333 - 8s/epoch - 24ms/step
Epoch 8/50
358/358 - 9s - loss: 3.2617 - accuracy300: 0.3876 - val_loss: 3.3293 - val_accuracy300: 0.3476 - 9s/epoch - 24ms/step
Epoch 9/50
358/358 - 9s - loss: 3.2578 - accuracy300: 0.3899 - val_loss: 3.3442 - val_accuracy300: 0.3389 - 9s/epoch - 24ms/step
Epoch 10/50
358/358 - 9s - loss: 3.2477 - accuracy300: 0.3963 - val_loss: 3.3564 - val_accuracy300: 0.3357 - 9s/epoch - 25ms/step
Epoch 11/50
358/358 - 9s - loss: 3.2434 - accuracy300: 0.3995 - val_loss: 3.3557 - val_accuracy300: 0.3398 - 9s/epoch - 24ms/step
Epoch 12/50
358/358 - 8s - loss: 3.2371 - accuracy300: 0.4045 - val_loss: 3.3811 - val_accuracy300: 0.3389 - 8s/epoch - 24ms/step
Epoch 13/50
358/358 - 9s - loss: 3.2307 - accuracy300: 0.4076 - val_loss: 3.3744 - val_accuracy300: 0.3397 - 9s/epoch - 24ms/step
testing model: results/CHTR/W8/deepLOB_L1/h300
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1090777
{'0': {'precision': 0.3220492432443071, 'recall': 0.3239075567872519, 'f1-score': 0.3229757269815892, 'support': 101035}, '1': {'precision': 0.3636944089722947, 'recall': 0.4673170557705684, 'f1-score': 0.40904513983748725, 'support': 112138}, '2': {'precision': 0.3166783014243914, 'recall': 0.21350891247746845, 'f1-score': 0.2550557160544779, 'support': 99860}, 'accuracy': 0.34006318822616144, 'macro avg': {'precision': 0.33414065121366443, 'recall': 0.334911175011763, 'f1-score': 0.32902552762451814, 'support': 313033}, 'weighted avg': {'precision': 0.3352544431569946, 'recall': 0.34006318822616144, 'f1-score': 0.3321414044905207, 'support': 313033}}
[[32726 45594 22715]
 [36443 52404 23291]
 [32449 46090 21321]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1151131
{'0': {'precision': 0.3286248164790675, 'recall': 0.49304141774855653, 'f1-score': 0.39438311731649695, 'support': 29963}, '1': {'precision': 0.34429882916444915, 'recall': 0.3420009251305095, 'f1-score': 0.3431460301674125, 'support': 30266}, '2': {'precision': 0.34833241875495397, 'recall': 0.18316768194934274, 'f1-score': 0.24008741148536483, 'support': 31190}, 'accuracy': 0.33731500016407967, 'macro avg': {'precision': 0.3404186881328235, 'recall': 0.33940334160946967, 'f1-score': 0.3258721863230914, 'support': 91419}, 'weighted avg': {'precision': 0.34053776436649413, 'recall': 0.33731500016407967, 'f1-score': 0.3247780598937818, 'support': 91419}}
[[14773  9840  5350]
 [14577 10351  5338]
 [15604  9873  5713]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.108831
{'0': {'precision': 0.33710261049366763, 'recall': 0.6206281227694503, 'f1-score': 0.4368980822376685, 'support': 8406}, '1': {'precision': 0.34863206341089237, 'recall': 0.3069217782779966, 'f1-score': 0.32644999102172745, 'support': 8885}, '2': {'precision': 0.32346938775510203, 'recall': 0.07957826032383582, 'f1-score': 0.12773244686209329, 'support': 7967}, 'accuracy': 0.3396151714308338, 'macro avg': {'precision': 0.336401353886554, 'recall': 0.3357093871237609, 'f1-score': 0.29702684004049645, 'support': 25258}, 'weighted avg': {'precision': 0.33685806633385257, 'recall': 0.3396151714308338, 'f1-score': 0.3005272726925404, 'support': 25258}}
[[5217 2564  625]
 [5457 2727  701]
 [4802 2531  634]]
training model: results/CHTR/W8/deepLOB_L1/h500
Epoch 1/50
358/358 - 11s - loss: 3.3436 - accuracy500: 0.3542 - val_loss: 3.3452 - val_accuracy500: 0.3617 - 11s/epoch - 30ms/step
Epoch 2/50
358/358 - 9s - loss: 3.3168 - accuracy500: 0.3556 - val_loss: 3.3240 - val_accuracy500: 0.3423 - 9s/epoch - 24ms/step
Epoch 3/50
358/358 - 8s - loss: 3.3031 - accuracy500: 0.3599 - val_loss: 3.3354 - val_accuracy500: 0.3513 - 8s/epoch - 24ms/step
Epoch 4/50
358/358 - 8s - loss: 3.2922 - accuracy500: 0.3630 - val_loss: 3.3720 - val_accuracy500: 0.3521 - 8s/epoch - 24ms/step
Epoch 5/50
358/358 - 8s - loss: 3.2772 - accuracy500: 0.3725 - val_loss: 3.3802 - val_accuracy500: 0.3382 - 8s/epoch - 24ms/step
Epoch 6/50
358/358 - 8s - loss: 3.2684 - accuracy500: 0.3763 - val_loss: 3.4430 - val_accuracy500: 0.3247 - 8s/epoch - 23ms/step
Epoch 7/50
358/358 - 8s - loss: 3.2514 - accuracy500: 0.3918 - val_loss: 3.5139 - val_accuracy500: 0.3282 - 8s/epoch - 23ms/step
Epoch 8/50
358/358 - 8s - loss: 3.2479 - accuracy500: 0.3973 - val_loss: 3.4674 - val_accuracy500: 0.3261 - 8s/epoch - 23ms/step
Epoch 9/50
358/358 - 9s - loss: 3.2428 - accuracy500: 0.4007 - val_loss: 3.5056 - val_accuracy500: 0.3220 - 9s/epoch - 24ms/step
Epoch 10/50
358/358 - 9s - loss: 3.2294 - accuracy500: 0.4062 - val_loss: 3.4908 - val_accuracy500: 0.3247 - 9s/epoch - 24ms/step
Epoch 11/50
358/358 - 8s - loss: 3.2165 - accuracy500: 0.4109 - val_loss: 3.5291 - val_accuracy500: 0.3243 - 8s/epoch - 23ms/step
Epoch 12/50
358/358 - 8s - loss: 3.2039 - accuracy500: 0.4173 - val_loss: 3.4921 - val_accuracy500: 0.3206 - 8s/epoch - 23ms/step
testing model: results/CHTR/W8/deepLOB_L1/h500
Evaluating performance on  test set...
1223/1223 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1153293
{'0': {'precision': 0.33565743197383846, 'recall': 0.21569754762990426, 'f1-score': 0.26262748174521755, 'support': 100882}, '1': {'precision': 0.35315052727704876, 'recall': 0.512461879175138, 'f1-score': 0.41814600042954375, 'support': 110176}, '2': {'precision': 0.31573584521154346, 'recall': 0.2734787938220152, 'f1-score': 0.29309203266387107, 'support': 101975}, 'accuracy': 0.3389706516565346, 'macro avg': {'precision': 0.3348479348208102, 'recall': 0.3338794068756858, 'f1-score': 0.3246218382795441, 'support': 313033}, 'weighted avg': {'precision': 0.33532460910226086, 'recall': 0.3389706516565346, 'f1-score': 0.3272884947837599, 'support': 313033}}
[[21760 50237 28885]
 [22161 56461 31554]
 [20907 53180 27888]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1202341
{'0': {'precision': 0.33140013603980956, 'recall': 0.3094434230319238, 'f1-score': 0.3200456368413774, 'support': 29915}, '1': {'precision': 0.34406428065015887, 'recall': 0.43342926135423904, 'f1-score': 0.38361097286061424, 'support': 30231}, '2': {'precision': 0.34393575561941503, 'recall': 0.27937837751414957, 'f1-score': 0.3083139247653328, 'support': 31273}, 'accuracy': 0.3401590479003271, 'macro avg': {'precision': 0.3398000574364611, 'recall': 0.34075035396677084, 'f1-score': 0.33732351148910816, 'support': 91419}, 'weighted avg': {'precision': 0.3398762316745077, 'recall': 0.3401590479003271, 'f1-score': 0.3370525811466466, 'support': 91419}}
[[ 9257 12298  8360]
 [ 8822 13103  8306]
 [ 9854 12682  8737]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1079711
{'0': {'precision': 0.319501246882793, 'recall': 0.3947498151343357, 'f1-score': 0.35316169579359397, 'support': 8114}, '1': {'precision': 0.3642407277816655, 'recall': 0.4470689284947391, 'f1-score': 0.40142678106622964, 'support': 9314}, '2': {'precision': 0.324388318863457, 'recall': 0.15747126436781608, 'f1-score': 0.21201960278565898, 'support': 7830}, 'accuracy': 0.34048618259561325, 'macro avg': {'precision': 0.33604343117597185, 'recall': 0.333096669332297, 'f1-score': 0.3222026932151609, 'support': 25258}, 'weighted avg': {'precision': 0.3375141259191655, 'recall': 0.34048618259561325, 'f1-score': 0.327205500369459, 'support': 25258}}
[[3203 3716 1195]
 [3777 4164 1373]
 [3045 3552 1233]]
training model: results/CHTR/W8/deepLOB_L1/h1000
Epoch 1/50
358/358 - 11s - loss: 3.3352 - accuracy1000: 0.3622 - val_loss: 3.3245 - val_accuracy1000: 0.3560 - 11s/epoch - 30ms/step
Epoch 2/50
358/358 - 9s - loss: 3.3116 - accuracy1000: 0.3724 - val_loss: 3.3688 - val_accuracy1000: 0.3370 - 9s/epoch - 24ms/step
Epoch 3/50
358/358 - 9s - loss: 3.2895 - accuracy1000: 0.3820 - val_loss: 3.3659 - val_accuracy1000: 0.3348 - 9s/epoch - 24ms/step
Epoch 4/50
358/358 - 9s - loss: 3.2700 - accuracy1000: 0.3931 - val_loss: 3.3330 - val_accuracy1000: 0.3473 - 9s/epoch - 24ms/step
Epoch 5/50
358/358 - 9s - loss: 3.2673 - accuracy1000: 0.3922 - val_loss: 3.3339 - val_accuracy1000: 0.3293 - 9s/epoch - 24ms/step
Epoch 6/50
358/358 - 8s - loss: 3.2477 - accuracy1000: 0.4011 - val_loss: 3.3472 - val_accuracy1000: 0.3353 - 8s/epoch - 23ms/step
Epoch 7/50
358/358 - 8s - loss: 3.2361 - accuracy1000: 0.4041 - val_loss: 3.4205 - val_accuracy1000: 0.3216 - 8s/epoch - 23ms/step
Epoch 8/50
358/358 - 8s - loss: 3.2184 - accuracy1000: 0.4131 - val_loss: 3.3829 - val_accuracy1000: 0.3266 - 8s/epoch - 23ms/step
Epoch 9/50
358/358 - 8s - loss: 3.1939 - accuracy1000: 0.4289 - val_loss: 3.4007 - val_accuracy1000: 0.3292 - 8s/epoch - 24ms/step
Epoch 10/50
358/358 - 8s - loss: 3.1845 - accuracy1000: 0.4341 - val_loss: 3.4212 - val_accuracy1000: 0.3382 - 8s/epoch - 23ms/step
Epoch 11/50
358/358 - 8s - loss: 3.1748 - accuracy1000: 0.4369 - val_loss: 3.4222 - val_accuracy1000: 0.3266 - 8s/epoch - 24ms/step
testing model: results/CHTR/W8/deepLOB_L1/h1000
Evaluating performance on  test set...
1223/1223 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1378156
{'0': {'precision': 0.3355755422870531, 'recall': 0.13559598098398706, 'f1-score': 0.19314704986732015, 'support': 98233}, '1': {'precision': 0.36110491513106296, 'recall': 0.4508264462809917, 'f1-score': 0.40100839396082283, 'support': 111320}, '2': {'precision': 0.33318448061565487, 'recall': 0.4326149980672594, 'f1-score': 0.37644476772297464, 'support': 103480}, 'accuracy': 0.34588366082809163, 'macro avg': {'precision': 0.34328831267792365, 'recall': 0.3396791417774127, 'f1-score': 0.32353340385037255, 'support': 313033}, 'weighted avg': {'precision': 0.3438638145242897, 'recall': 0.34588366082809163, 'f1-score': 0.3276592983145824, 'support': 313033}}
[[13320 43421 41492]
 [13032 50186 48102]
 [13341 45372 44767]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1383457
{'0': {'precision': 0.3353343465045593, 'recall': 0.29571801916504725, 'f1-score': 0.3142826621087491, 'support': 29846}, '1': {'precision': 0.3415798374338552, 'recall': 0.4146963375057951, 'f1-score': 0.37460364941669166, 'support': 30198}, '2': {'precision': 0.35415128178077854, 'recall': 0.32098804780876494, 'f1-score': 0.33675516618738716, 'support': 31375}, 'accuracy': 0.3436922302803575, 'macro avg': {'precision': 0.3436884885730644, 'recall': 0.3438008014932024, 'f1-score': 0.34188049257094266, 'support': 91419}, 'weighted avg': {'precision': 0.34385536160398344, 'recall': 0.3436922302803575, 'f1-score': 0.34192076786567616, 'support': 91419}}
[[ 8826 12012  9008]
 [ 8317 12523  9358]
 [ 9177 12127 10071]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1078833
{'0': {'precision': 0.33922305764411026, 'recall': 0.3331692307692308, 'f1-score': 0.33616889164855634, 'support': 8125}, '1': {'precision': 0.36594022857954145, 'recall': 0.5498080204778157, 'f1-score': 0.43941524954183186, 'support': 9376}, '2': {'precision': 0.3321842682544657, 'recall': 0.13665076704911694, 'f1-score': 0.1936426744610888, 'support': 7757}, 'accuracy': 0.35323461873465833, 'macro avg': {'precision': 0.3457825181593724, 'recall': 0.33987600609872115, 'f1-score': 0.323075605217159, 'support': 25258}, 'weighted avg': {'precision': 0.3469790282433315, 'recall': 0.35323461873465833, 'f1-score': 0.3307235667963973, 'support': 25258}}
[[2707 4443  975]
 [3065 5155 1156]
 [2208 4489 1060]]
training model: results/CHTR/W8/deepOF_L1/h10
Epoch 1/50
358/358 - 10s - loss: 3.3002 - accuracy10: 0.3701 - val_loss: 3.2849 - val_accuracy10: 0.3793 - 10s/epoch - 29ms/step
Epoch 2/50
358/358 - 8s - loss: 3.2586 - accuracy10: 0.3919 - val_loss: 3.2698 - val_accuracy10: 0.3871 - 8s/epoch - 22ms/step
Epoch 3/50
358/358 - 8s - loss: 3.2449 - accuracy10: 0.4000 - val_loss: 3.2677 - val_accuracy10: 0.3892 - 8s/epoch - 22ms/step
Epoch 4/50
358/358 - 8s - loss: 3.2331 - accuracy10: 0.4078 - val_loss: 3.2698 - val_accuracy10: 0.3945 - 8s/epoch - 22ms/step
Epoch 5/50
358/358 - 8s - loss: 3.2240 - accuracy10: 0.4098 - val_loss: 3.2612 - val_accuracy10: 0.3953 - 8s/epoch - 22ms/step
Epoch 6/50
358/358 - 8s - loss: 3.2191 - accuracy10: 0.4138 - val_loss: 3.2577 - val_accuracy10: 0.3915 - 8s/epoch - 22ms/step
Epoch 7/50
358/358 - 8s - loss: 3.2130 - accuracy10: 0.4174 - val_loss: 3.2459 - val_accuracy10: 0.4001 - 8s/epoch - 22ms/step
Epoch 8/50
358/358 - 8s - loss: 3.2071 - accuracy10: 0.4201 - val_loss: 3.2526 - val_accuracy10: 0.3979 - 8s/epoch - 22ms/step
Epoch 9/50
358/358 - 8s - loss: 3.2029 - accuracy10: 0.4205 - val_loss: 3.2532 - val_accuracy10: 0.3980 - 8s/epoch - 22ms/step
Epoch 10/50
358/358 - 8s - loss: 3.1980 - accuracy10: 0.4252 - val_loss: 3.2505 - val_accuracy10: 0.4004 - 8s/epoch - 22ms/step
Epoch 11/50
358/358 - 8s - loss: 3.1958 - accuracy10: 0.4252 - val_loss: 3.2529 - val_accuracy10: 0.3998 - 8s/epoch - 22ms/step
Epoch 12/50
358/358 - 8s - loss: 3.1923 - accuracy10: 0.4258 - val_loss: 3.2496 - val_accuracy10: 0.4025 - 8s/epoch - 22ms/step
Epoch 13/50
358/358 - 8s - loss: 3.1901 - accuracy10: 0.4264 - val_loss: 3.2532 - val_accuracy10: 0.4008 - 8s/epoch - 22ms/step
Epoch 14/50
358/358 - 8s - loss: 3.1854 - accuracy10: 0.4289 - val_loss: 3.2539 - val_accuracy10: 0.4002 - 8s/epoch - 22ms/step
Epoch 15/50
358/358 - 8s - loss: 3.1825 - accuracy10: 0.4300 - val_loss: 3.2505 - val_accuracy10: 0.4023 - 8s/epoch - 22ms/step
Epoch 16/50
358/358 - 8s - loss: 3.1805 - accuracy10: 0.4309 - val_loss: 3.2505 - val_accuracy10: 0.4021 - 8s/epoch - 22ms/step
Epoch 17/50
358/358 - 8s - loss: 3.1765 - accuracy10: 0.4344 - val_loss: 3.2579 - val_accuracy10: 0.3957 - 8s/epoch - 23ms/step
testing model: results/CHTR/W8/deepOF_L1/h10
Evaluating performance on  test set...
1223/1223 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0812999
{'0': {'precision': 0.38105841942351143, 'recall': 0.5698201277268911, 'f1-score': 0.4567034515144401, 'support': 102406}, '1': {'precision': 0.40207007706126285, 'recall': 0.4413615797864008, 'f1-score': 0.4208006255298774, 'support': 108521}, '2': {'precision': 0.4629611459968603, 'recall': 0.18485617182985475, 'f1-score': 0.26421407023217075, 'support': 102101}, 'accuracy': 0.39972143067073873, 'macro avg': {'precision': 0.41536321416054484, 'recall': 0.39867929311438216, 'f1-score': 0.3805727157588294, 'support': 313028}, 'weighted avg': {'precision': 0.4150571555888765, 'recall': 0.39972143067073873, 'f1-score': 0.3814719422022645, 'support': 313028}}
[[58353 33376 10677]
 [49407 47897 11217]
 [45374 37853 18874]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0745292
{'0': {'precision': 0.4095053056344343, 'recall': 0.6103420843277645, 'f1-score': 0.4901484756331297, 'support': 31425}, '1': {'precision': 0.39364004468025693, 'recall': 0.37332406395868506, 'f1-score': 0.3832129810551355, 'support': 30207}, '2': {'precision': 0.4483429575696711, 'recall': 0.2398187006882659, 'f1-score': 0.31248769604304744, 'support': 29785}, 'accuracy': 0.41130205541638865, 'macro avg': {'precision': 0.41716276929478746, 'recall': 0.4078282829915718, 'f1-score': 0.39528305091043753, 'support': 91417}, 'weighted avg': {'precision': 0.4169168103354002, 'recall': 0.41130205541638865, 'f1-score': 0.3969291968905756, 'support': 91417}}
[[19180  8058  4187]
 [14328 11277  4602]
 [13329  9313  7143]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0819448
{'0': {'precision': 0.404359197907585, 'recall': 0.5446858485026423, 'f1-score': 0.4641481110833125, 'support': 8515}, '1': {'precision': 0.36256112817013536, 'recall': 0.39121364584611606, 'f1-score': 0.3763428166686341, 'support': 8149}, '2': {'precision': 0.44633560272326794, 'recall': 0.25939718375421855, 'f1-score': 0.3281077500551998, 'support': 8593}, 'accuracy': 0.3981074553589104, 'macro avg': {'precision': 0.40441864293366275, 'recall': 0.39843222603432565, 'f1-score': 0.38953289260238216, 'support': 25257}, 'weighted avg': {'precision': 0.4051546516942852, 'recall': 0.3981074553589104, 'f1-score': 0.389534334051211, 'support': 25257}}
[[4638 2608 1269]
 [3465 3188 1496]
 [3367 2997 2229]]
training model: results/CHTR/W8/deepOF_L1/h20
Epoch 1/50
358/358 - 10s - loss: 3.3003 - accuracy20: 0.3709 - val_loss: 3.2828 - val_accuracy20: 0.3779 - 10s/epoch - 29ms/step
Epoch 2/50
358/358 - 8s - loss: 3.2593 - accuracy20: 0.3916 - val_loss: 3.2677 - val_accuracy20: 0.3873 - 8s/epoch - 22ms/step
Epoch 3/50
358/358 - 8s - loss: 3.2469 - accuracy20: 0.4005 - val_loss: 3.2644 - val_accuracy20: 0.3877 - 8s/epoch - 22ms/step
Epoch 4/50
358/358 - 8s - loss: 3.2362 - accuracy20: 0.4060 - val_loss: 3.2631 - val_accuracy20: 0.3929 - 8s/epoch - 22ms/step
Epoch 5/50
358/358 - 8s - loss: 3.2288 - accuracy20: 0.4105 - val_loss: 3.2616 - val_accuracy20: 0.3956 - 8s/epoch - 22ms/step
Epoch 6/50
358/358 - 8s - loss: 3.2228 - accuracy20: 0.4149 - val_loss: 3.2594 - val_accuracy20: 0.3960 - 8s/epoch - 22ms/step
Epoch 7/50
358/358 - 8s - loss: 3.2181 - accuracy20: 0.4177 - val_loss: 3.2559 - val_accuracy20: 0.3974 - 8s/epoch - 22ms/step
Epoch 8/50
358/358 - 8s - loss: 3.2128 - accuracy20: 0.4188 - val_loss: 3.2540 - val_accuracy20: 0.3991 - 8s/epoch - 22ms/step
Epoch 9/50
358/358 - 8s - loss: 3.2094 - accuracy20: 0.4206 - val_loss: 3.2557 - val_accuracy20: 0.3985 - 8s/epoch - 22ms/step
Epoch 10/50
358/358 - 8s - loss: 3.2080 - accuracy20: 0.4220 - val_loss: 3.2544 - val_accuracy20: 0.4019 - 8s/epoch - 22ms/step
Epoch 11/50
358/358 - 8s - loss: 3.2042 - accuracy20: 0.4220 - val_loss: 3.2507 - val_accuracy20: 0.3991 - 8s/epoch - 22ms/step
Epoch 12/50
358/358 - 8s - loss: 3.2011 - accuracy20: 0.4232 - val_loss: 3.2504 - val_accuracy20: 0.4036 - 8s/epoch - 22ms/step
Epoch 13/50
358/358 - 8s - loss: 3.1977 - accuracy20: 0.4262 - val_loss: 3.2518 - val_accuracy20: 0.4005 - 8s/epoch - 22ms/step
Epoch 14/50
358/358 - 8s - loss: 3.1949 - accuracy20: 0.4272 - val_loss: 3.2478 - val_accuracy20: 0.4009 - 8s/epoch - 22ms/step
Epoch 15/50
358/358 - 8s - loss: 3.1932 - accuracy20: 0.4275 - val_loss: 3.2514 - val_accuracy20: 0.3959 - 8s/epoch - 22ms/step
Epoch 16/50
358/358 - 8s - loss: 3.1898 - accuracy20: 0.4304 - val_loss: 3.2499 - val_accuracy20: 0.4019 - 8s/epoch - 22ms/step
Epoch 17/50
358/358 - 8s - loss: 3.1883 - accuracy20: 0.4287 - val_loss: 3.2498 - val_accuracy20: 0.4001 - 8s/epoch - 22ms/step
Epoch 18/50
358/358 - 8s - loss: 3.1838 - accuracy20: 0.4330 - val_loss: 3.2533 - val_accuracy20: 0.3994 - 8s/epoch - 22ms/step
Epoch 19/50
358/358 - 8s - loss: 3.1825 - accuracy20: 0.4330 - val_loss: 3.2498 - val_accuracy20: 0.4022 - 8s/epoch - 22ms/step
Epoch 20/50
358/358 - 8s - loss: 3.1797 - accuracy20: 0.4331 - val_loss: 3.2516 - val_accuracy20: 0.3998 - 8s/epoch - 22ms/step
Epoch 21/50
358/358 - 8s - loss: 3.1780 - accuracy20: 0.4339 - val_loss: 3.2541 - val_accuracy20: 0.4029 - 8s/epoch - 22ms/step
Epoch 22/50
358/358 - 8s - loss: 3.1749 - accuracy20: 0.4375 - val_loss: 3.2515 - val_accuracy20: 0.4028 - 8s/epoch - 22ms/step
Epoch 23/50
358/358 - 8s - loss: 3.1721 - accuracy20: 0.4377 - val_loss: 3.2593 - val_accuracy20: 0.3971 - 8s/epoch - 22ms/step
Epoch 24/50
358/358 - 8s - loss: 3.1687 - accuracy20: 0.4388 - val_loss: 3.2530 - val_accuracy20: 0.4035 - 8s/epoch - 22ms/step
testing model: results/CHTR/W8/deepOF_L1/h20
Evaluating performance on  test set...
1223/1223 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0846912
{'0': {'precision': 0.37895656354245444, 'recall': 0.6196223159509202, 'f1-score': 0.4702882233321571, 'support': 104320}, '1': {'precision': 0.39531607242167704, 'recall': 0.29637625432004966, 'f1-score': 0.3387699770178244, 'support': 107927}, '2': {'precision': 0.43911475090182317, 'recall': 0.2681457814468997, 'f1-score': 0.33296575346685314, 'support': 100781}, 'accuracy': 0.39501258673345513, 'macro avg': {'precision': 0.4044624622886515, 'recall': 0.39471478390595655, 'f1-score': 0.38067465127227823, 'support': 313028}, 'weighted avg': {'precision': 0.4039653007642761, 'recall': 0.39501258673345513, 'f1-score': 0.38073116899368836, 'support': 313028}}
[[64639 23248 16433]
 [57855 31987 18085]
 [48077 25680 27024]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0728141
{'0': {'precision': 0.4042717397595941, 'recall': 0.6672292456134764, 'f1-score': 0.5034842368319877, 'support': 31403}, '1': {'precision': 0.4006143742386526, 'recall': 0.25072093871192286, 'f1-score': 0.30841997961264017, 'support': 30169}, '2': {'precision': 0.45177959144250734, 'recall': 0.3134528396716368, 'f1-score': 0.3701139420794429, 'support': 29845}, 'accuracy': 0.4142774319874859, 'macro avg': {'precision': 0.4188885684802513, 'recall': 0.41046767466567863, 'f1-score': 0.394006052841357, 'support': 91417}, 'weighted avg': {'precision': 0.4185746896822043, 'recall': 0.4142774319874859, 'f1-score': 0.39556853162463906, 'support': 91417}}
[[20953  5073  5377]
 [16630  7564  5975]
 [14246  6244  9355]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0808202
{'0': {'precision': 0.39859654534238126, 'recall': 0.6036435828564756, 'f1-score': 0.48014490734290094, 'support': 8563}, '1': {'precision': 0.3764784274529402, 'recall': 0.27036726881205886, 'f1-score': 0.3147193984124773, 'support': 8359}, '2': {'precision': 0.4357301940820872, 'recall': 0.3286142771445711, 'f1-score': 0.37466657547363386, 'support': 8335}, 'accuracy': 0.4025814625648335, 'macro avg': {'precision': 0.40360172229246954, 'recall': 0.4008750429377019, 'f1-score': 0.3898436270763374, 'support': 25257}, 'weighted avg': {'precision': 0.4035307661448365, 'recall': 0.4025814625648335, 'f1-score': 0.3905874094104564, 'support': 25257}}
[[5169 1711 1683]
 [4235 2260 1864]
 [3564 2032 2739]]
training model: results/CHTR/W8/deepOF_L1/h30
Epoch 1/50
358/358 - 10s - loss: 3.3039 - accuracy30: 0.3701 - val_loss: 3.2834 - val_accuracy30: 0.3783 - 10s/epoch - 28ms/step
Epoch 2/50
358/358 - 8s - loss: 3.2643 - accuracy30: 0.3899 - val_loss: 3.2649 - val_accuracy30: 0.3853 - 8s/epoch - 22ms/step
Epoch 3/50
358/358 - 8s - loss: 3.2526 - accuracy30: 0.3949 - val_loss: 3.2625 - val_accuracy30: 0.3874 - 8s/epoch - 22ms/step
Epoch 4/50
358/358 - 8s - loss: 3.2416 - accuracy30: 0.4027 - val_loss: 3.2623 - val_accuracy30: 0.3940 - 8s/epoch - 22ms/step
Epoch 5/50
358/358 - 8s - loss: 3.2367 - accuracy30: 0.4052 - val_loss: 3.2576 - val_accuracy30: 0.3973 - 8s/epoch - 22ms/step
Epoch 6/50
358/358 - 8s - loss: 3.2308 - accuracy30: 0.4069 - val_loss: 3.2591 - val_accuracy30: 0.3941 - 8s/epoch - 21ms/step
Epoch 7/50
358/358 - 8s - loss: 3.2271 - accuracy30: 0.4114 - val_loss: 3.2535 - val_accuracy30: 0.3996 - 8s/epoch - 21ms/step
Epoch 8/50
358/358 - 8s - loss: 3.2232 - accuracy30: 0.4122 - val_loss: 3.2539 - val_accuracy30: 0.4016 - 8s/epoch - 22ms/step
Epoch 9/50
358/358 - 8s - loss: 3.2199 - accuracy30: 0.4150 - val_loss: 3.2560 - val_accuracy30: 0.3975 - 8s/epoch - 21ms/step
Epoch 10/50
358/358 - 8s - loss: 3.2174 - accuracy30: 0.4146 - val_loss: 3.2508 - val_accuracy30: 0.3980 - 8s/epoch - 22ms/step
Epoch 11/50
358/358 - 8s - loss: 3.2128 - accuracy30: 0.4178 - val_loss: 3.2538 - val_accuracy30: 0.3968 - 8s/epoch - 21ms/step
Epoch 12/50
358/358 - 8s - loss: 3.2115 - accuracy30: 0.4183 - val_loss: 3.2545 - val_accuracy30: 0.3987 - 8s/epoch - 21ms/step
Epoch 13/50
358/358 - 8s - loss: 3.2078 - accuracy30: 0.4207 - val_loss: 3.2516 - val_accuracy30: 0.3987 - 8s/epoch - 21ms/step
Epoch 14/50
358/358 - 8s - loss: 3.2061 - accuracy30: 0.4212 - val_loss: 3.2544 - val_accuracy30: 0.3994 - 8s/epoch - 21ms/step
Epoch 15/50
358/358 - 8s - loss: 3.2033 - accuracy30: 0.4221 - val_loss: 3.2537 - val_accuracy30: 0.4006 - 8s/epoch - 21ms/step
Epoch 16/50
358/358 - 8s - loss: 3.2003 - accuracy30: 0.4229 - val_loss: 3.2544 - val_accuracy30: 0.3992 - 8s/epoch - 21ms/step
Epoch 17/50
358/358 - 8s - loss: 3.1996 - accuracy30: 0.4239 - val_loss: 3.2521 - val_accuracy30: 0.3991 - 8s/epoch - 21ms/step
Epoch 18/50
358/358 - 8s - loss: 3.1938 - accuracy30: 0.4269 - val_loss: 3.2591 - val_accuracy30: 0.3975 - 8s/epoch - 21ms/step
Epoch 19/50
358/358 - 8s - loss: 3.1923 - accuracy30: 0.4268 - val_loss: 3.2548 - val_accuracy30: 0.3995 - 8s/epoch - 21ms/step
Epoch 20/50
358/358 - 8s - loss: 3.1911 - accuracy30: 0.4270 - val_loss: 3.2557 - val_accuracy30: 0.3995 - 8s/epoch - 21ms/step
testing model: results/CHTR/W8/deepOF_L1/h30
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0875639
{'0': {'precision': 0.3817088163987545, 'recall': 0.6250388056331668, 'f1-score': 0.47396749191221316, 'support': 106299}, '1': {'precision': 0.37777964252748175, 'recall': 0.16938184280823207, 'f1-score': 0.23389443059019116, 'support': 106316}, '2': {'precision': 0.4028456264102171, 'recall': 0.36627727485484946, 'f1-score': 0.3836921199096557, 'support': 100413}, 'accuracy': 0.3872752597211751, 'macro avg': {'precision': 0.3874446951121511, 'recall': 0.38689930776541614, 'f1-score': 0.36385134747068665, 'support': 313028}, 'weighted avg': {'precision': 0.38715457989078317, 'recall': 0.3872752597211751, 'f1-score': 0.363471215168903, 'support': 313028}}
[[66441 14281 25577]
 [59366 18008 28942]
 [48255 15379 36779]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0776771
{'0': {'precision': 0.4000229108196346, 'recall': 0.6678779764750885, 'f1-score': 0.5003582175096719, 'support': 31371}, '1': {'precision': 0.38723064644852356, 'recall': 0.16178726242080693, 'f1-score': 0.22822201317027277, 'support': 29990}, '2': {'precision': 0.42685778951339115, 'recall': 0.3764972052169284, 'f1-score': 0.40009899939893223, 'support': 30056}, 'accuracy': 0.40605139087915815, 'macro avg': {'precision': 0.4047037822605164, 'recall': 0.4020541480376079, 'f1-score': 0.37622641002629226, 'support': 91417}, 'weighted avg': {'precision': 0.4046490646589635, 'recall': 0.40605139087915815, 'f1-score': 0.37811885472512446, 'support': 91417}}
[[20952  3367  7052]
 [16996  4852  8142]
 [14429  4311 11316]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0815585
{'0': {'precision': 0.4013903581683542, 'recall': 0.6171003717472119, 'f1-score': 0.4864023441076824, 'support': 8608}, '1': {'precision': 0.3829423264907136, 'recall': 0.18694822238129324, 'f1-score': 0.2512425845759179, 'support': 8382}, '2': {'precision': 0.41180179044256715, 'recall': 0.39506471513245434, 'f1-score': 0.40325966168662797, 'support': 8267}, 'accuracy': 0.4016708239299996, 'macro avg': {'precision': 0.398711491700545, 'recall': 0.3997044364203199, 'f1-score': 0.3803015301234094, 'support': 25257}, 'weighted avg': {'precision': 0.3986758595774263, 'recall': 0.4016708239299996, 'f1-score': 0.381146388928124, 'support': 25257}}
[[5312 1140 2156]
 [4306 1567 2509]
 [3616 1385 3266]]
training model: results/CHTR/W8/deepOF_L1/h50
Epoch 1/50
358/358 - 10s - loss: 3.3121 - accuracy50: 0.3628 - val_loss: 3.2942 - val_accuracy50: 0.3663 - 10s/epoch - 27ms/step
Epoch 2/50
358/358 - 8s - loss: 3.2757 - accuracy50: 0.3809 - val_loss: 3.2738 - val_accuracy50: 0.3797 - 8s/epoch - 21ms/step
Epoch 3/50
358/358 - 8s - loss: 3.2644 - accuracy50: 0.3868 - val_loss: 3.2684 - val_accuracy50: 0.3862 - 8s/epoch - 21ms/step
Epoch 4/50
358/358 - 8s - loss: 3.2564 - accuracy50: 0.3911 - val_loss: 3.2687 - val_accuracy50: 0.3854 - 8s/epoch - 21ms/step
Epoch 5/50
358/358 - 8s - loss: 3.2496 - accuracy50: 0.3961 - val_loss: 3.2644 - val_accuracy50: 0.3886 - 8s/epoch - 22ms/step
Epoch 6/50
358/358 - 8s - loss: 3.2450 - accuracy50: 0.3982 - val_loss: 3.2652 - val_accuracy50: 0.3910 - 8s/epoch - 22ms/step
Epoch 7/50
358/358 - 8s - loss: 3.2412 - accuracy50: 0.4022 - val_loss: 3.2633 - val_accuracy50: 0.3900 - 8s/epoch - 22ms/step
Epoch 8/50
358/358 - 8s - loss: 3.2382 - accuracy50: 0.4033 - val_loss: 3.2616 - val_accuracy50: 0.3907 - 8s/epoch - 23ms/step
Epoch 9/50
358/358 - 8s - loss: 3.2358 - accuracy50: 0.4048 - val_loss: 3.2635 - val_accuracy50: 0.3901 - 8s/epoch - 22ms/step
Epoch 10/50
358/358 - 8s - loss: 3.2327 - accuracy50: 0.4058 - val_loss: 3.2612 - val_accuracy50: 0.3907 - 8s/epoch - 22ms/step
Epoch 11/50
358/358 - 8s - loss: 3.2305 - accuracy50: 0.4079 - val_loss: 3.2579 - val_accuracy50: 0.3938 - 8s/epoch - 22ms/step
Epoch 12/50
358/358 - 8s - loss: 3.2269 - accuracy50: 0.4093 - val_loss: 3.2611 - val_accuracy50: 0.3927 - 8s/epoch - 21ms/step
Epoch 13/50
358/358 - 8s - loss: 3.2268 - accuracy50: 0.4115 - val_loss: 3.2603 - val_accuracy50: 0.3900 - 8s/epoch - 21ms/step
Epoch 14/50
358/358 - 8s - loss: 3.2232 - accuracy50: 0.4107 - val_loss: 3.2587 - val_accuracy50: 0.3928 - 8s/epoch - 21ms/step
Epoch 15/50
358/358 - 8s - loss: 3.2211 - accuracy50: 0.4132 - val_loss: 3.2603 - val_accuracy50: 0.3915 - 8s/epoch - 22ms/step
Epoch 16/50
358/358 - 8s - loss: 3.2187 - accuracy50: 0.4148 - val_loss: 3.2608 - val_accuracy50: 0.3938 - 8s/epoch - 21ms/step
Epoch 17/50
358/358 - 8s - loss: 3.2167 - accuracy50: 0.4148 - val_loss: 3.2631 - val_accuracy50: 0.3923 - 8s/epoch - 22ms/step
Epoch 18/50
358/358 - 8s - loss: 3.2142 - accuracy50: 0.4181 - val_loss: 3.2609 - val_accuracy50: 0.3920 - 8s/epoch - 22ms/step
Epoch 19/50
358/358 - 8s - loss: 3.2114 - accuracy50: 0.4177 - val_loss: 3.2628 - val_accuracy50: 0.3898 - 8s/epoch - 22ms/step
Epoch 20/50
358/358 - 8s - loss: 3.2090 - accuracy50: 0.4214 - val_loss: 3.2628 - val_accuracy50: 0.3908 - 8s/epoch - 21ms/step
Epoch 21/50
358/358 - 8s - loss: 3.2080 - accuracy50: 0.4215 - val_loss: 3.2622 - val_accuracy50: 0.3925 - 8s/epoch - 22ms/step
testing model: results/CHTR/W8/deepOF_L1/h50
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0906273
{'0': {'precision': 0.37885452137722286, 'recall': 0.6064999716075788, 'f1-score': 0.46638089762530294, 'support': 105662}, '1': {'precision': 0.3718132172998861, 'recall': 0.11651231743475236, 'f1-score': 0.1774259854095973, 'support': 109276}, '2': {'precision': 0.377422856256784, 'recall': 0.42183708838821493, 'f1-score': 0.39839594074801543, 'support': 98090}, 'accuracy': 0.3775828360402264, 'macro avg': {'precision': 0.3760301983112977, 'recall': 0.3816164591435154, 'f1-score': 0.34740094126097193, 'support': 313028}, 'weighted avg': {'precision': 0.375947824289362, 'recall': 0.3775828360402264, 'f1-score': 0.3442049855427526, 'support': 313028}}
[[64084 10197 31381]
 [59670 12732 36874]
 [45398 11314 41378]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0805383
{'0': {'precision': 0.39740713534118205, 'recall': 0.6422704228967464, 'f1-score': 0.4910038633715582, 'support': 31166}, '1': {'precision': 0.39443519153522094, 'recall': 0.1328449811918432, 'f1-score': 0.19875101819169155, 'support': 30306}, '2': {'precision': 0.41062222366330536, 'recall': 0.42290866588746034, 'f1-score': 0.4166748922449248, 'support': 29945}, 'accuracy': 0.4015336316002494, 'macro avg': {'precision': 0.40082151684656947, 'recall': 0.39934135665868337, 'f1-score': 0.3688099246027248, 'support': 91417}, 'weighted avg': {'precision': 0.4007506938786808, 'recall': 0.4015336316002494, 'f1-score': 0.36977044107146007, 'support': 91417}}
[[20017  2692  8457]
 [16560  4026  9720]
 [13792  3489 12664]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0859487
{'0': {'precision': 0.3994092288040875, 'recall': 0.5867933380248651, 'f1-score': 0.47529925897776937, 'support': 8526}, '1': {'precision': 0.3926733272782319, 'recall': 0.1518735362997658, 'f1-score': 0.21903233977877223, 'support': 8540}, '2': {'precision': 0.3896902842596521, 'recall': 0.44854108167500917, 'f1-score': 0.4170497758102049, 'support': 8191}, 'accuracy': 0.3949004236449301, 'macro avg': {'precision': 0.39392428011399055, 'recall': 0.3957359853332134, 'f1-score': 0.3704604581889155, 'support': 25257}, 'weighted avg': {'precision': 0.3939797449463737, 'recall': 0.3949004236449301, 'f1-score': 0.3697585769258647, 'support': 25257}}
[[5003  871 2652]
 [4141 1297 3102]
 [3382 1135 3674]]
training model: results/CHTR/W8/deepOF_L1/h100
Epoch 1/50
358/358 - 10s - loss: 3.3244 - accuracy100: 0.3527 - val_loss: 3.2967 - val_accuracy100: 0.3605 - 10s/epoch - 28ms/step
Epoch 2/50
358/358 - 8s - loss: 3.2927 - accuracy100: 0.3678 - val_loss: 3.2871 - val_accuracy100: 0.3660 - 8s/epoch - 22ms/step
Epoch 3/50
358/358 - 8s - loss: 3.2841 - accuracy100: 0.3717 - val_loss: 3.2868 - val_accuracy100: 0.3686 - 8s/epoch - 21ms/step
Epoch 4/50
358/358 - 8s - loss: 3.2780 - accuracy100: 0.3755 - val_loss: 3.2836 - val_accuracy100: 0.3666 - 8s/epoch - 21ms/step
Epoch 5/50
358/358 - 8s - loss: 3.2716 - accuracy100: 0.3799 - val_loss: 3.2799 - val_accuracy100: 0.3697 - 8s/epoch - 22ms/step
Epoch 6/50
358/358 - 8s - loss: 3.2681 - accuracy100: 0.3818 - val_loss: 3.2796 - val_accuracy100: 0.3699 - 8s/epoch - 22ms/step
Epoch 7/50
358/358 - 8s - loss: 3.2649 - accuracy100: 0.3843 - val_loss: 3.2819 - val_accuracy100: 0.3677 - 8s/epoch - 21ms/step
Epoch 8/50
358/358 - 8s - loss: 3.2627 - accuracy100: 0.3864 - val_loss: 3.2807 - val_accuracy100: 0.3704 - 8s/epoch - 22ms/step
Epoch 9/50
358/358 - 8s - loss: 3.2600 - accuracy100: 0.3881 - val_loss: 3.2814 - val_accuracy100: 0.3702 - 8s/epoch - 21ms/step
Epoch 10/50
358/358 - 8s - loss: 3.2584 - accuracy100: 0.3898 - val_loss: 3.2831 - val_accuracy100: 0.3709 - 8s/epoch - 21ms/step
Epoch 11/50
358/358 - 22s - loss: 3.2546 - accuracy100: 0.3914 - val_loss: 3.2795 - val_accuracy100: 0.3711 - 22s/epoch - 62ms/step
Epoch 12/50
358/358 - 8s - loss: 3.2529 - accuracy100: 0.3920 - val_loss: 3.2797 - val_accuracy100: 0.3727 - 8s/epoch - 23ms/step
Epoch 13/50
358/358 - 8s - loss: 3.2517 - accuracy100: 0.3950 - val_loss: 3.2817 - val_accuracy100: 0.3705 - 8s/epoch - 22ms/step
Epoch 14/50
358/358 - 8s - loss: 3.2486 - accuracy100: 0.3976 - val_loss: 3.2801 - val_accuracy100: 0.3692 - 8s/epoch - 22ms/step
Epoch 15/50
358/358 - 8s - loss: 3.2484 - accuracy100: 0.3971 - val_loss: 3.2808 - val_accuracy100: 0.3719 - 8s/epoch - 22ms/step
Epoch 16/50
358/358 - 8s - loss: 3.2461 - accuracy100: 0.3985 - val_loss: 3.2824 - val_accuracy100: 0.3713 - 8s/epoch - 21ms/step
Epoch 17/50
358/358 - 8s - loss: 3.2443 - accuracy100: 0.3983 - val_loss: 3.2825 - val_accuracy100: 0.3699 - 8s/epoch - 22ms/step
Epoch 18/50
358/358 - 8s - loss: 3.2429 - accuracy100: 0.4001 - val_loss: 3.2834 - val_accuracy100: 0.3698 - 8s/epoch - 22ms/step
Epoch 19/50
358/358 - 8s - loss: 3.2409 - accuracy100: 0.4006 - val_loss: 3.2804 - val_accuracy100: 0.3726 - 8s/epoch - 22ms/step
Epoch 20/50
358/358 - 8s - loss: 3.2383 - accuracy100: 0.4016 - val_loss: 3.2831 - val_accuracy100: 0.3724 - 8s/epoch - 22ms/step
Epoch 21/50
358/358 - 8s - loss: 3.2363 - accuracy100: 0.4047 - val_loss: 3.2834 - val_accuracy100: 0.3719 - 8s/epoch - 23ms/step
testing model: results/CHTR/W8/deepOF_L1/h100
Evaluating performance on  test set...
1223/1223 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0920382
{'0': {'precision': 0.3708597369016077, 'recall': 0.616656383758146, 'f1-score': 0.46316818420433353, 'support': 103732}, '1': {'precision': 0.368445607941733, 'recall': 0.12567190041728551, 'f1-score': 0.18741800874133943, 'support': 113112}, '2': {'precision': 0.3635793024989212, 'recall': 0.3854279298012143, 'f1-score': 0.37418495266164675, 'support': 96184}, 'accuracy': 0.36819070498485756, 'macro avg': {'precision': 0.36762821578075394, 'recall': 0.3759187379922153, 'f1-score': 0.3415903818691066, 'support': 313028}, 'weighted avg': {'precision': 0.36775034011442775, 'recall': 0.36819070498485756, 'f1-score': 0.33618460129905997, 'support': 313028}}
[[63967 11794 27971]
 [61976 14215 36921]
 [46540 12572 37072]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0868131
{'0': {'precision': 0.3830177743431221, 'recall': 0.6423549233710268, 'f1-score': 0.47989058736671386, 'support': 30863}, '1': {'precision': 0.3658224375971473, 'recall': 0.13246151299453732, 'f1-score': 0.1944971075786301, 'support': 30205}, '2': {'precision': 0.40424791086350975, 'recall': 0.38254967214735247, 'f1-score': 0.393099595388444, 'support': 30349}, 'accuracy': 0.38763030946104116, 'macro avg': {'precision': 0.3843627076012597, 'recall': 0.38578870283763883, 'f1-score': 0.35582909677792934, 'support': 91417}, 'weighted avg': {'precision': 0.3843843502189994, 'recall': 0.38763030946104116, 'f1-score': 0.35678077329988184, 'support': 91417}}
[[19825  3214  7824]
 [16918  4001  9286]
 [15017  3722 11610]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0926094
{'0': {'precision': 0.3772211350293542, 'recall': 0.5674084540209584, 'f1-score': 0.4531690803084446, 'support': 8493}, '1': {'precision': 0.36662883087400683, 'recall': 0.14914002077802146, 'f1-score': 0.21202921145482895, 'support': 8663}, '2': {'precision': 0.36939048894842597, 'recall': 0.4084680903592149, 'f1-score': 0.38794771088574936, 'support': 8101}, 'accuracy': 0.3729659104406699, 'macro avg': {'precision': 0.3710801516172624, 'recall': 0.3750055217193982, 'f1-score': 0.3510486675496743, 'support': 25257}, 'weighted avg': {'precision': 0.37107641495969534, 'recall': 0.3729659104406699, 'f1-score': 0.34954026463072646, 'support': 25257}}
[[4819 1109 2565]
 [4287 1292 3084]
 [3669 1123 3309]]
training model: results/CHTR/W8/deepOF_L1/h200
Epoch 1/50
358/358 - 10s - loss: 3.3408 - accuracy200: 0.3399 - val_loss: 3.3159 - val_accuracy200: 0.3381 - 10s/epoch - 28ms/step
Epoch 2/50
358/358 - 8s - loss: 3.3124 - accuracy200: 0.3512 - val_loss: 3.3116 - val_accuracy200: 0.3368 - 8s/epoch - 22ms/step
Epoch 3/50
358/358 - 8s - loss: 3.3038 - accuracy200: 0.3531 - val_loss: 3.3045 - val_accuracy200: 0.3432 - 8s/epoch - 22ms/step
Epoch 4/50
358/358 - 8s - loss: 3.2951 - accuracy200: 0.3563 - val_loss: 3.3006 - val_accuracy200: 0.3441 - 8s/epoch - 22ms/step
Epoch 5/50
358/358 - 8s - loss: 3.2910 - accuracy200: 0.3598 - val_loss: 3.3000 - val_accuracy200: 0.3483 - 8s/epoch - 22ms/step
Epoch 6/50
358/358 - 8s - loss: 3.2883 - accuracy200: 0.3614 - val_loss: 3.2989 - val_accuracy200: 0.3458 - 8s/epoch - 22ms/step
Epoch 7/50
358/358 - 8s - loss: 3.2859 - accuracy200: 0.3619 - val_loss: 3.2974 - val_accuracy200: 0.3500 - 8s/epoch - 22ms/step
Epoch 8/50
358/358 - 8s - loss: 3.2833 - accuracy200: 0.3656 - val_loss: 3.2984 - val_accuracy200: 0.3469 - 8s/epoch - 21ms/step
Epoch 9/50
358/358 - 8s - loss: 3.2798 - accuracy200: 0.3686 - val_loss: 3.2983 - val_accuracy200: 0.3489 - 8s/epoch - 22ms/step
Epoch 10/50
358/358 - 8s - loss: 3.2794 - accuracy200: 0.3707 - val_loss: 3.2978 - val_accuracy200: 0.3514 - 8s/epoch - 21ms/step
Epoch 11/50
358/358 - 8s - loss: 3.2767 - accuracy200: 0.3711 - val_loss: 3.2955 - val_accuracy200: 0.3534 - 8s/epoch - 22ms/step
Epoch 12/50
358/358 - 8s - loss: 3.2751 - accuracy200: 0.3720 - val_loss: 3.2975 - val_accuracy200: 0.3487 - 8s/epoch - 22ms/step
Epoch 13/50
358/358 - 8s - loss: 3.2739 - accuracy200: 0.3729 - val_loss: 3.2993 - val_accuracy200: 0.3473 - 8s/epoch - 21ms/step
Epoch 14/50
358/358 - 8s - loss: 3.2718 - accuracy200: 0.3752 - val_loss: 3.2963 - val_accuracy200: 0.3522 - 8s/epoch - 22ms/step
Epoch 15/50
358/358 - 8s - loss: 3.2700 - accuracy200: 0.3770 - val_loss: 3.2961 - val_accuracy200: 0.3535 - 8s/epoch - 21ms/step
Epoch 16/50
358/358 - 8s - loss: 3.2698 - accuracy200: 0.3777 - val_loss: 3.2966 - val_accuracy200: 0.3515 - 8s/epoch - 22ms/step
Epoch 17/50
358/358 - 8s - loss: 3.2680 - accuracy200: 0.3791 - val_loss: 3.2992 - val_accuracy200: 0.3533 - 8s/epoch - 22ms/step
Epoch 18/50
358/358 - 8s - loss: 3.2663 - accuracy200: 0.3814 - val_loss: 3.3001 - val_accuracy200: 0.3510 - 8s/epoch - 22ms/step
Epoch 19/50
358/358 - 8s - loss: 3.2629 - accuracy200: 0.3820 - val_loss: 3.2990 - val_accuracy200: 0.3499 - 8s/epoch - 21ms/step
Epoch 20/50
358/358 - 8s - loss: 3.2626 - accuracy200: 0.3838 - val_loss: 3.3000 - val_accuracy200: 0.3527 - 8s/epoch - 22ms/step
Epoch 21/50
358/358 - 8s - loss: 3.2626 - accuracy200: 0.3827 - val_loss: 3.2994 - val_accuracy200: 0.3477 - 8s/epoch - 21ms/step
testing model: results/CHTR/W8/deepOF_L1/h200
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0978049
{'0': {'precision': 0.3603940286381639, 'recall': 0.5195038402607669, 'f1-score': 0.4255632125097933, 'support': 102467}, '1': {'precision': 0.3624541035055691, 'recall': 0.15586958822906744, 'f1-score': 0.21799339974709311, 'support': 113364}, '2': {'precision': 0.33542360086470163, 'recall': 0.40228607878843997, 'f1-score': 0.36582479218221536, 'support': 97197}, 'accuracy': 0.35141584778358487, 'macro avg': {'precision': 0.35275724433614486, 'recall': 0.35921983575942473, 'f1-score': 0.33646046814636726, 'support': 313028}, 'weighted avg': {'precision': 0.3533866288495549, 'recall': 0.35141584778358487, 'f1-score': 0.3318420773569944, 'support': 313028}}
[[53232 15298 33937]
 [52160 17670 43534]
 [42313 15783 39101]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.09361
{'0': {'precision': 0.363940158456159, 'recall': 0.5450236966824644, 'f1-score': 0.4364442203320108, 'support': 30173}, '1': {'precision': 0.3548999660902001, 'recall': 0.17261512072832827, 'f1-score': 0.23226293246931937, 'support': 30316}, '2': {'precision': 0.3805500857523979, 'recall': 0.3874159337816865, 'f1-score': 0.3839523183901048, 'support': 30928}, 'accuracy': 0.36820285067328834, 'macro avg': {'precision': 0.36646340343291905, 'recall': 0.36835158373082644, 'f1-score': 0.350886490397145, 'support': 91417}, 'weighted avg': {'precision': 0.36656165511051947, 'recall': 0.36820285067328834, 'f1-score': 0.3509740182240372, 'support': 91417}}
[[16445  4521  9207]
 [14786  5233 10297]
 [13955  4991 11982]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0986844
{'0': {'precision': 0.3610481457974431, 'recall': 0.4701298701298701, 'f1-score': 0.408431201600082, 'support': 8470}, '1': {'precision': 0.3440377273748035, 'recall': 0.17645703754895187, 'f1-score': 0.23326988960791778, 'support': 8682}, '2': {'precision': 0.3447570332480818, 'recall': 0.41579272054287475, 'f1-score': 0.37695749440715887, 'support': 8105}, 'accuracy': 0.35174407095062754, 'macro avg': {'precision': 0.3499476354734428, 'recall': 0.3541265427405656, 'f1-score': 0.33955286187171957, 'support': 25257}, 'weighted avg': {'precision': 0.3499730410756658, 'recall': 0.35174407095062754, 'f1-score': 0.3381202023715667, 'support': 25257}}
[[3982 1473 3015]
 [3760 1532 3390]
 [3287 1448 3370]]
training model: results/CHTR/W8/deepOF_L1/h300
Epoch 1/50
358/358 - 10s - loss: 3.3453 - accuracy300: 0.3392 - val_loss: 3.3227 - val_accuracy300: 0.3403 - 10s/epoch - 28ms/step
Epoch 2/50
358/358 - 8s - loss: 3.3170 - accuracy300: 0.3487 - val_loss: 3.3202 - val_accuracy300: 0.3369 - 8s/epoch - 23ms/step
Epoch 3/50
358/358 - 8s - loss: 3.3063 - accuracy300: 0.3527 - val_loss: 3.3139 - val_accuracy300: 0.3370 - 8s/epoch - 22ms/step
Epoch 4/50
358/358 - 8s - loss: 3.3009 - accuracy300: 0.3547 - val_loss: 3.3094 - val_accuracy300: 0.3390 - 8s/epoch - 23ms/step
Epoch 5/50
358/358 - 8s - loss: 3.2961 - accuracy300: 0.3582 - val_loss: 3.3101 - val_accuracy300: 0.3362 - 8s/epoch - 22ms/step
Epoch 6/50
358/358 - 8s - loss: 3.2932 - accuracy300: 0.3584 - val_loss: 3.3081 - val_accuracy300: 0.3367 - 8s/epoch - 22ms/step
Epoch 7/50
358/358 - 8s - loss: 3.2907 - accuracy300: 0.3606 - val_loss: 3.3073 - val_accuracy300: 0.3373 - 8s/epoch - 23ms/step
Epoch 8/50
358/358 - 8s - loss: 3.2889 - accuracy300: 0.3610 - val_loss: 3.3074 - val_accuracy300: 0.3379 - 8s/epoch - 22ms/step
Epoch 9/50
358/358 - 8s - loss: 3.2858 - accuracy300: 0.3636 - val_loss: 3.3081 - val_accuracy300: 0.3357 - 8s/epoch - 23ms/step
Epoch 10/50
358/358 - 8s - loss: 3.2842 - accuracy300: 0.3650 - val_loss: 3.3066 - val_accuracy300: 0.3395 - 8s/epoch - 22ms/step
Epoch 11/50
358/358 - 8s - loss: 3.2823 - accuracy300: 0.3666 - val_loss: 3.3064 - val_accuracy300: 0.3380 - 8s/epoch - 22ms/step
Epoch 12/50
358/358 - 8s - loss: 3.2802 - accuracy300: 0.3689 - val_loss: 3.3068 - val_accuracy300: 0.3397 - 8s/epoch - 21ms/step
Epoch 13/50
358/358 - 8s - loss: 3.2796 - accuracy300: 0.3685 - val_loss: 3.3098 - val_accuracy300: 0.3328 - 8s/epoch - 22ms/step
Epoch 14/50
358/358 - 8s - loss: 3.2779 - accuracy300: 0.3706 - val_loss: 3.3057 - val_accuracy300: 0.3412 - 8s/epoch - 22ms/step
Epoch 15/50
358/358 - 8s - loss: 3.2767 - accuracy300: 0.3718 - val_loss: 3.3053 - val_accuracy300: 0.3394 - 8s/epoch - 22ms/step
Epoch 16/50
358/358 - 8s - loss: 3.2740 - accuracy300: 0.3736 - val_loss: 3.3091 - val_accuracy300: 0.3388 - 8s/epoch - 22ms/step
Epoch 17/50
358/358 - 8s - loss: 3.2740 - accuracy300: 0.3728 - val_loss: 3.3074 - val_accuracy300: 0.3394 - 8s/epoch - 21ms/step
Epoch 18/50
358/358 - 8s - loss: 3.2720 - accuracy300: 0.3744 - val_loss: 3.3107 - val_accuracy300: 0.3373 - 8s/epoch - 21ms/step
Epoch 19/50
358/358 - 8s - loss: 3.2690 - accuracy300: 0.3770 - val_loss: 3.3115 - val_accuracy300: 0.3394 - 8s/epoch - 22ms/step
Epoch 20/50
358/358 - 8s - loss: 3.2701 - accuracy300: 0.3760 - val_loss: 3.3102 - val_accuracy300: 0.3380 - 8s/epoch - 22ms/step
Epoch 21/50
358/358 - 8s - loss: 3.2678 - accuracy300: 0.3801 - val_loss: 3.3103 - val_accuracy300: 0.3420 - 8s/epoch - 21ms/step
Epoch 22/50
358/358 - 8s - loss: 3.2669 - accuracy300: 0.3794 - val_loss: 3.3125 - val_accuracy300: 0.3398 - 8s/epoch - 22ms/step
Epoch 23/50
358/358 - 8s - loss: 3.2635 - accuracy300: 0.3834 - val_loss: 3.3125 - val_accuracy300: 0.3380 - 8s/epoch - 22ms/step
Epoch 24/50
358/358 - 8s - loss: 3.2617 - accuracy300: 0.3811 - val_loss: 3.3108 - val_accuracy300: 0.3415 - 8s/epoch - 22ms/step
Epoch 25/50
358/358 - 8s - loss: 3.2612 - accuracy300: 0.3857 - val_loss: 3.3130 - val_accuracy300: 0.3420 - 8s/epoch - 21ms/step
testing model: results/CHTR/W8/deepOF_L1/h300
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991375
{'0': {'precision': 0.35182054810914315, 'recall': 0.4655607573763028, 'f1-score': 0.40077706631903176, 'support': 101033}, '1': {'precision': 0.3552377833569843, 'recall': 0.17412473916067703, 'f1-score': 0.2336987744159326, 'support': 112138}, '2': {'precision': 0.33259090105012623, 'recall': 0.41422233794325886, 'f1-score': 0.3689452018749192, 'support': 99857}, 'accuracy': 0.34478065859923074, 'macro avg': {'precision': 0.34654974417208456, 'recall': 0.35130261149341285, 'f1-score': 0.33447368086996115, 'support': 313028}, 'weighted avg': {'precision': 0.3469104028820394, 'recall': 0.34478065859923074, 'f1-score': 0.330769079860231, 'support': 313028}}
[[47037 17251 36745]
 [46354 19526 46258]
 [40305 18189 41363]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0934836
{'0': {'precision': 0.3620259655501946, 'recall': 0.5182170025357, 'f1-score': 0.42626415094339626, 'support': 29972}, '1': {'precision': 0.3523489932885906, 'recall': 0.19116186693147963, 'f1-score': 0.24785407725321884, 'support': 30210}, '2': {'precision': 0.3799962644751588, 'recall': 0.3908115895629902, 'f1-score': 0.38532805126343533, 'support': 31235}, 'accuracy': 0.36660577354321405, 'macro avg': {'precision': 0.36479040777131466, 'recall': 0.3667301530100566, 'f1-score': 0.35314875982001687, 'support': 91417}, 'weighted avg': {'precision': 0.3649680983580771, 'recall': 0.36660577354321405, 'f1-score': 0.3533192129156351, 'support': 91417}}
[[15532  5098  9342]
 [13860  5775 10575]
 [13511  5517 12207]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1007931
{'0': {'precision': 0.3487905153456353, 'recall': 0.4325349774721366, 'f1-score': 0.3861747737257185, 'support': 8434}, '1': {'precision': 0.35762855928601783, 'recall': 0.18980489455283636, 'f1-score': 0.24799233772931556, 'support': 8867}, '2': {'precision': 0.32619896948077687, 'recall': 0.41377576671694316, 'f1-score': 0.36480496453900707, 'support': 7956}, 'accuracy': 0.3414103020944689, 'macro avg': {'precision': 0.3442060147041433, 'recall': 0.3453718795806387, 'f1-score': 0.3329906919980137, 'support': 25257}, 'weighted avg': {'precision': 0.3447769189849653, 'recall': 0.3414103020944689, 'f1-score': 0.33093140112130864, 'support': 25257}}
[[3648 1542 3244]
 [3628 1683 3556]
 [3183 1481 3292]]
training model: results/CHTR/W8/deepOF_L1/h500
Epoch 1/50
358/358 - 10s - loss: 3.3496 - accuracy500: 0.3365 - val_loss: 3.3390 - val_accuracy500: 0.3391 - 10s/epoch - 28ms/step
Epoch 2/50
358/358 - 8s - loss: 3.3218 - accuracy500: 0.3437 - val_loss: 3.3247 - val_accuracy500: 0.3399 - 8s/epoch - 22ms/step
Epoch 3/50
358/358 - 8s - loss: 3.3122 - accuracy500: 0.3461 - val_loss: 3.3110 - val_accuracy500: 0.3467 - 8s/epoch - 22ms/step
Epoch 4/50
358/358 - 8s - loss: 3.3045 - accuracy500: 0.3488 - val_loss: 3.3086 - val_accuracy500: 0.3422 - 8s/epoch - 22ms/step
Epoch 5/50
358/358 - 8s - loss: 3.2996 - accuracy500: 0.3505 - val_loss: 3.3068 - val_accuracy500: 0.3405 - 8s/epoch - 21ms/step
Epoch 6/50
358/358 - 8s - loss: 3.2966 - accuracy500: 0.3530 - val_loss: 3.3041 - val_accuracy500: 0.3437 - 8s/epoch - 22ms/step
Epoch 7/50
358/358 - 8s - loss: 3.2933 - accuracy500: 0.3557 - val_loss: 3.3046 - val_accuracy500: 0.3428 - 8s/epoch - 21ms/step
Epoch 8/50
358/358 - 8s - loss: 3.2922 - accuracy500: 0.3561 - val_loss: 3.3040 - val_accuracy500: 0.3423 - 8s/epoch - 22ms/step
Epoch 9/50
358/358 - 8s - loss: 3.2890 - accuracy500: 0.3582 - val_loss: 3.3047 - val_accuracy500: 0.3400 - 8s/epoch - 21ms/step
Epoch 10/50
358/358 - 8s - loss: 3.2877 - accuracy500: 0.3583 - val_loss: 3.3017 - val_accuracy500: 0.3437 - 8s/epoch - 22ms/step
Epoch 11/50
358/358 - 8s - loss: 3.2859 - accuracy500: 0.3610 - val_loss: 3.3035 - val_accuracy500: 0.3359 - 8s/epoch - 21ms/step
Epoch 12/50
358/358 - 8s - loss: 3.2838 - accuracy500: 0.3625 - val_loss: 3.3030 - val_accuracy500: 0.3390 - 8s/epoch - 21ms/step
Epoch 13/50
358/358 - 8s - loss: 3.2815 - accuracy500: 0.3654 - val_loss: 3.3054 - val_accuracy500: 0.3379 - 8s/epoch - 21ms/step
Epoch 14/50
358/358 - 8s - loss: 3.2817 - accuracy500: 0.3653 - val_loss: 3.3035 - val_accuracy500: 0.3390 - 8s/epoch - 21ms/step
Epoch 15/50
358/358 - 8s - loss: 3.2803 - accuracy500: 0.3672 - val_loss: 3.3038 - val_accuracy500: 0.3388 - 8s/epoch - 21ms/step
Epoch 16/50
358/358 - 8s - loss: 3.2779 - accuracy500: 0.3692 - val_loss: 3.3040 - val_accuracy500: 0.3417 - 8s/epoch - 22ms/step
Epoch 17/50
358/358 - 8s - loss: 3.2763 - accuracy500: 0.3696 - val_loss: 3.3060 - val_accuracy500: 0.3394 - 8s/epoch - 22ms/step
Epoch 18/50
358/358 - 8s - loss: 3.2771 - accuracy500: 0.3708 - val_loss: 3.3064 - val_accuracy500: 0.3379 - 8s/epoch - 22ms/step
Epoch 19/50
358/358 - 8s - loss: 3.2748 - accuracy500: 0.3709 - val_loss: 3.3067 - val_accuracy500: 0.3410 - 8s/epoch - 22ms/step
Epoch 20/50
358/358 - 8s - loss: 3.2736 - accuracy500: 0.3745 - val_loss: 3.3048 - val_accuracy500: 0.3430 - 8s/epoch - 23ms/step
testing model: results/CHTR/W8/deepOF_L1/h500
Evaluating performance on  test set...
1223/1223 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0979607
{'0': {'precision': 0.35375181028240404, 'recall': 0.30993566550025275, 'f1-score': 0.3303973835350808, 'support': 100879}, '1': {'precision': 0.35393972564043713, 'recall': 0.36391773162939295, 'f1-score': 0.3588593829712966, 'support': 110176}, '2': {'precision': 0.3415437941128931, 'recall': 0.37299088974532474, 'f1-score': 0.3565753392551621, 'support': 101973}, 'accuracy': 0.34947672412691516, 'macro avg': {'precision': 0.3497451100119114, 'recall': 0.34894809562499013, 'f1-score': 0.34861070192051313, 'support': 313028}, 'weighted avg': {'precision': 0.3498410282745105, 'recall': 0.34947672412691516, 'f1-score': 0.3489429255585687, 'support': 313028}}
[[31266 36404 33209]
 [29963 40095 40118]
 [27155 36783 38035]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.095285
{'0': {'precision': 0.36358412641407795, 'recall': 0.339082962119436, 'f1-score': 0.35090638106131505, 'support': 29857}, '1': {'precision': 0.34494751878765295, 'recall': 0.3669761141762199, 'f1-score': 0.3556210081477806, 'support': 30269}, '2': {'precision': 0.3700669429391138, 'recall': 0.37100124636476944, 'f1-score': 0.37053350568934423, 'support': 31291}, 'accuracy': 0.35924390430663883, 'macro avg': {'precision': 0.35953286271361495, 'recall': 0.35902010755347513, 'f1-score': 0.35902029829947996, 'support': 91417}, 'weighted avg': {'precision': 0.35963237056604797, 'recall': 0.35924390430663883, 'f1-score': 0.35918557862868095, 'support': 91417}}
[[10124 10339  9394]
 [ 8794 11108 10367]
 [ 8927 10755 11609]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0997357
{'0': {'precision': 0.3383892006673745, 'recall': 0.2750585624460609, 'f1-score': 0.3034548422198042, 'support': 8111}, '1': {'precision': 0.3664071921938384, 'recall': 0.3587761674718196, 'f1-score': 0.36255152961596865, 'support': 9315}, '2': {'precision': 0.3144713402493975, 'recall': 0.3832205337760184, 'f1-score': 0.3454587314377806, 'support': 7831}, 'accuracy': 0.3394702458724314, 'macro avg': {'precision': 0.33975591103687014, 'recall': 0.33901842123129966, 'f1-score': 0.33715503442451783, 'support': 25257}, 'weighted avg': {'precision': 0.3413066820046605, 'recall': 0.3394702458724314, 'f1-score': 0.33827362907339903, 'support': 25257}}
[[2231 2985 2895]
 [2326 3342 3647]
 [2036 2794 3001]]
training model: results/CHTR/W8/deepOF_L1/h1000
Epoch 1/50
358/358 - 10s - loss: 3.3523 - accuracy1000: 0.3362 - val_loss: 3.3446 - val_accuracy1000: 0.3277 - 10s/epoch - 28ms/step
Epoch 2/50
358/358 - 8s - loss: 3.3269 - accuracy1000: 0.3410 - val_loss: 3.3318 - val_accuracy1000: 0.3291 - 8s/epoch - 22ms/step
Epoch 3/50
358/358 - 8s - loss: 3.3164 - accuracy1000: 0.3421 - val_loss: 3.3266 - val_accuracy1000: 0.3255 - 8s/epoch - 22ms/step
Epoch 4/50
358/358 - 8s - loss: 3.3084 - accuracy1000: 0.3429 - val_loss: 3.3195 - val_accuracy1000: 0.3279 - 8s/epoch - 22ms/step
Epoch 5/50
358/358 - 8s - loss: 3.3022 - accuracy1000: 0.3469 - val_loss: 3.3183 - val_accuracy1000: 0.3260 - 8s/epoch - 22ms/step
Epoch 6/50
358/358 - 8s - loss: 3.2992 - accuracy1000: 0.3471 - val_loss: 3.3170 - val_accuracy1000: 0.3300 - 8s/epoch - 22ms/step
Epoch 7/50
358/358 - 8s - loss: 3.2966 - accuracy1000: 0.3508 - val_loss: 3.3155 - val_accuracy1000: 0.3265 - 8s/epoch - 22ms/step
Epoch 8/50
358/358 - 8s - loss: 3.2959 - accuracy1000: 0.3498 - val_loss: 3.3146 - val_accuracy1000: 0.3246 - 8s/epoch - 21ms/step
Epoch 9/50
358/358 - 8s - loss: 3.2926 - accuracy1000: 0.3535 - val_loss: 3.3135 - val_accuracy1000: 0.3269 - 8s/epoch - 21ms/step
Epoch 10/50
358/358 - 8s - loss: 3.2906 - accuracy1000: 0.3550 - val_loss: 3.3143 - val_accuracy1000: 0.3262 - 8s/epoch - 22ms/step
Epoch 11/50
358/358 - 8s - loss: 3.2890 - accuracy1000: 0.3569 - val_loss: 3.3119 - val_accuracy1000: 0.3260 - 8s/epoch - 21ms/step
Epoch 12/50
358/358 - 8s - loss: 3.2884 - accuracy1000: 0.3581 - val_loss: 3.3093 - val_accuracy1000: 0.3291 - 8s/epoch - 22ms/step
Epoch 13/50
358/358 - 8s - loss: 3.2857 - accuracy1000: 0.3599 - val_loss: 3.3122 - val_accuracy1000: 0.3296 - 8s/epoch - 22ms/step
Epoch 14/50
358/358 - 8s - loss: 3.2850 - accuracy1000: 0.3607 - val_loss: 3.3118 - val_accuracy1000: 0.3283 - 8s/epoch - 22ms/step
Epoch 15/50
358/358 - 8s - loss: 3.2834 - accuracy1000: 0.3624 - val_loss: 3.3126 - val_accuracy1000: 0.3281 - 8s/epoch - 21ms/step
Epoch 16/50
358/358 - 8s - loss: 3.2818 - accuracy1000: 0.3644 - val_loss: 3.3134 - val_accuracy1000: 0.3285 - 8s/epoch - 21ms/step
Epoch 17/50
358/358 - 8s - loss: 3.2824 - accuracy1000: 0.3624 - val_loss: 3.3122 - val_accuracy1000: 0.3284 - 8s/epoch - 22ms/step
Epoch 18/50
358/358 - 8s - loss: 3.2809 - accuracy1000: 0.3637 - val_loss: 3.3131 - val_accuracy1000: 0.3268 - 8s/epoch - 22ms/step
Epoch 19/50
358/358 - 8s - loss: 3.2795 - accuracy1000: 0.3651 - val_loss: 3.3129 - val_accuracy1000: 0.3304 - 8s/epoch - 21ms/step
Epoch 20/50
358/358 - 8s - loss: 3.2779 - accuracy1000: 0.3684 - val_loss: 3.3131 - val_accuracy1000: 0.3293 - 8s/epoch - 22ms/step
Epoch 21/50
358/358 - 8s - loss: 3.2772 - accuracy1000: 0.3684 - val_loss: 3.3136 - val_accuracy1000: 0.3325 - 8s/epoch - 22ms/step
Epoch 22/50
358/358 - 8s - loss: 3.2745 - accuracy1000: 0.3703 - val_loss: 3.3148 - val_accuracy1000: 0.3321 - 8s/epoch - 22ms/step
testing model: results/CHTR/W8/deepOF_L1/h1000
Evaluating performance on  test set...
1223/1223 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017382
{'0': {'precision': 0.3305608907917114, 'recall': 0.3977196375852591, 'f1-score': 0.3610437257701567, 'support': 98230}, '1': {'precision': 0.3499264650896129, 'recall': 0.12610492274523896, 'f1-score': 0.18539722789014576, 'support': 111320}, '2': {'precision': 0.3374266435717794, 'recall': 0.5045323643673051, 'f1-score': 0.4043965577338673, 'support': 103478}, 'accuracy': 0.33643635713099146, 'macro avg': {'precision': 0.3393046664843679, 'recall': 0.34278564156593444, 'f1-score': 0.3169458371313899, 'support': 313028}, 'weighted avg': {'precision': 0.33971735633798295, 'recall': 0.33643635713099146, 'f1-score': 0.3129109587395333, 'support': 313028}}
[[39068 12766 46396]
 [41162 14038 56120]
 [37957 13313 52208]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0954617
{'0': {'precision': 0.3560539389638041, 'recall': 0.42047740378168164, 'f1-score': 0.38559328547492044, 'support': 29828}, '1': {'precision': 0.3639448255513757, 'recall': 0.16308587294242083, 'f1-score': 0.22524023647029287, 'support': 30254}, '2': {'precision': 0.36732731324029555, 'recall': 0.49979256422530716, 'f1-score': 0.42344193591996754, 'support': 31335}, 'accuracy': 0.3624818141045976, 'macro avg': {'precision': 0.3624420259184918, 'recall': 0.36111861364980324, 'f1-score': 0.3447584859550603, 'support': 91417}, 'weighted avg': {'precision': 0.36252956237929845, 'recall': 0.3624818141045976, 'f1-score': 0.34549862383769264, 'support': 91417}}
[[12542  4174 13112]
 [11458  4934 13862]
 [11225  4449 15661]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1020999
{'0': {'precision': 0.33364794714487966, 'recall': 0.3483187584677916, 'f1-score': 0.340825549864417, 'support': 8119}, '1': {'precision': 0.37489943684633953, 'recall': 0.1489928594266226, 'f1-score': 0.2132397803538743, 'support': 9383}, '2': {'precision': 0.3094544897333742, 'recall': 0.5208252740167634, 'f1-score': 0.3882347286970731, 'support': 7755}, 'accuracy': 0.3272360137783585, 'macro avg': {'precision': 0.3393339579081978, 'recall': 0.3393789639703925, 'f1-score': 0.3141000196384548, 'support': 25257}, 'weighted avg': {'precision': 0.3415444695205606, 'recall': 0.3272360137783585, 'f1-score': 0.307983997286115, 'support': 25257}}
[[2828 1201 4090]
 [3062 1398 4923]
 [2586 1130 4039]]
training model: results/CHTR/W8/deepLOB_L2/h10
Epoch 1/50
358/358 - 19s - loss: 3.3434 - accuracy10: 0.3434 - val_loss: 3.3873 - val_accuracy10: 0.3356 - 19s/epoch - 53ms/step
Epoch 2/50
358/358 - 17s - loss: 3.3124 - accuracy10: 0.3473 - val_loss: 3.3988 - val_accuracy10: 0.3353 - 17s/epoch - 47ms/step
Epoch 3/50
358/358 - 17s - loss: 3.2935 - accuracy10: 0.3608 - val_loss: 3.3053 - val_accuracy10: 0.3595 - 17s/epoch - 47ms/step
Epoch 4/50
358/358 - 17s - loss: 3.2779 - accuracy10: 0.3756 - val_loss: 3.2983 - val_accuracy10: 0.3738 - 17s/epoch - 46ms/step
Epoch 5/50
358/358 - 17s - loss: 3.2642 - accuracy10: 0.3857 - val_loss: 3.2894 - val_accuracy10: 0.3806 - 17s/epoch - 47ms/step
Epoch 6/50
358/358 - 17s - loss: 3.2530 - accuracy10: 0.3926 - val_loss: 3.3060 - val_accuracy10: 0.3751 - 17s/epoch - 46ms/step
Epoch 7/50
358/358 - 17s - loss: 3.2412 - accuracy10: 0.4016 - val_loss: 3.2996 - val_accuracy10: 0.3782 - 17s/epoch - 47ms/step
Epoch 8/50
358/358 - 17s - loss: 3.2335 - accuracy10: 0.4071 - val_loss: 3.3078 - val_accuracy10: 0.3771 - 17s/epoch - 46ms/step
Epoch 9/50
358/358 - 17s - loss: 3.2248 - accuracy10: 0.4104 - val_loss: 3.2987 - val_accuracy10: 0.3787 - 17s/epoch - 46ms/step
Epoch 10/50
358/358 - 17s - loss: 3.2164 - accuracy10: 0.4168 - val_loss: 3.3174 - val_accuracy10: 0.3739 - 17s/epoch - 46ms/step
Epoch 11/50
358/358 - 16s - loss: 3.2097 - accuracy10: 0.4190 - val_loss: 3.3104 - val_accuracy10: 0.3768 - 16s/epoch - 46ms/step
Epoch 12/50
358/358 - 17s - loss: 3.2012 - accuracy10: 0.4230 - val_loss: 3.3113 - val_accuracy10: 0.3782 - 17s/epoch - 47ms/step
Epoch 13/50
358/358 - 17s - loss: 3.1930 - accuracy10: 0.4283 - val_loss: 3.3102 - val_accuracy10: 0.3797 - 17s/epoch - 47ms/step
Epoch 14/50
358/358 - 17s - loss: 3.1892 - accuracy10: 0.4293 - val_loss: 3.2956 - val_accuracy10: 0.3853 - 17s/epoch - 47ms/step
Epoch 15/50
358/358 - 17s - loss: 3.1817 - accuracy10: 0.4335 - val_loss: 3.3011 - val_accuracy10: 0.3821 - 17s/epoch - 47ms/step
testing model: results/CHTR/W8/deepLOB_L2/h10
Evaluating performance on  test set...
1223/1223 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1016184
{'0': {'precision': 0.34926068939536636, 'recall': 0.724257130860195, 'f1-score': 0.4712628706312923, 'support': 102407}, '1': {'precision': 0.3752541035832398, 'recall': 0.11396662458649319, 'f1-score': 0.17483496133783802, 'support': 108523}, '2': {'precision': 0.3820184895294917, 'recall': 0.25335200728675944, 'f1-score': 0.3046573664591884, 'support': 102103}, 'accuracy': 0.3590835471020627, 'macro avg': {'precision': 0.36884442750269936, 'recall': 0.3638585875778159, 'f1-score': 0.3169183994761062, 'support': 313033}, 'weighted avg': {'precision': 0.3689568650541793, 'recall': 0.3590835471020627, 'f1-score': 0.3141542980758817, 'support': 313033}}
[[74169  9364 18874]
 [73183 12368 22972]
 [65008 11227 25868]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0937965
{'0': {'precision': 0.3768562017387548, 'recall': 0.6631508931965032, 'f1-score': 0.4805977343938298, 'support': 31572}, '1': {'precision': 0.3664903600068248, 'recall': 0.14265789998007572, 'f1-score': 0.20537336265417344, 'support': 30114}, '2': {'precision': 0.37945318972659486, 'recall': 0.3080752026368009, 'f1-score': 0.3400590277133258, 'support': 29733}, 'accuracy': 0.37621282227983244, 'macro avg': {'precision': 0.37426658382405814, 'recall': 0.3712946652711266, 'f1-score': 0.3420100415871097, 'support': 91419}, 'weighted avg': {'precision': 0.3742862686387111, 'recall': 0.37621282227983244, 'f1-score': 0.34422844468053787, 'support': 91419}}
[[20937  3484  7151]
 [17989  4296  7829]
 [16631  3942  9160]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0940413
{'0': {'precision': 0.3702682837192209, 'recall': 0.7078454332552693, 'f1-score': 0.4862060645057509, 'support': 8540}, '1': {'precision': 0.3426013195098963, 'recall': 0.08916963081074451, 'f1-score': 0.14150851581508517, 'support': 8153}, '2': {'precision': 0.40205580029368576, 'recall': 0.3196730881494454, 'f1-score': 0.3561626016260162, 'support': 8565}, 'accuracy': 0.37651437168421886, 'macro avg': {'precision': 0.37164180117426765, 'recall': 0.37222938407181977, 'f1-score': 0.32795906064895075, 'support': 25258}, 'weighted avg': {'precision': 0.37211685923041216, 'recall': 0.37651437168421886, 'f1-score': 0.3308437486438487, 'support': 25258}}
[[6045  603 1892]
 [5246  727 2180]
 [5035  792 2738]]
training model: results/CHTR/W8/deepLOB_L2/h20
Epoch 1/50
358/358 - 19s - loss: 3.3453 - accuracy20: 0.3409 - val_loss: 3.3949 - val_accuracy20: 0.3379 - 19s/epoch - 52ms/step
Epoch 2/50
358/358 - 17s - loss: 3.3061 - accuracy20: 0.3537 - val_loss: 3.3519 - val_accuracy20: 0.3426 - 17s/epoch - 47ms/step
Epoch 3/50
358/358 - 17s - loss: 3.2938 - accuracy20: 0.3612 - val_loss: 3.3571 - val_accuracy20: 0.3455 - 17s/epoch - 46ms/step
Epoch 4/50
358/358 - 17s - loss: 3.2789 - accuracy20: 0.3764 - val_loss: 3.3526 - val_accuracy20: 0.3514 - 17s/epoch - 46ms/step
Epoch 5/50
358/358 - 17s - loss: 3.2671 - accuracy20: 0.3849 - val_loss: 3.3732 - val_accuracy20: 0.3473 - 17s/epoch - 46ms/step
Epoch 6/50
358/358 - 17s - loss: 3.2582 - accuracy20: 0.3917 - val_loss: 3.3471 - val_accuracy20: 0.3512 - 17s/epoch - 47ms/step
Epoch 7/50
358/358 - 17s - loss: 3.2459 - accuracy20: 0.3978 - val_loss: 3.3243 - val_accuracy20: 0.3614 - 17s/epoch - 47ms/step
Epoch 8/50
358/358 - 17s - loss: 3.2408 - accuracy20: 0.4017 - val_loss: 3.3062 - val_accuracy20: 0.3705 - 17s/epoch - 47ms/step
Epoch 9/50
358/358 - 17s - loss: 3.2322 - accuracy20: 0.4079 - val_loss: 3.3184 - val_accuracy20: 0.3687 - 17s/epoch - 47ms/step
Epoch 10/50
358/358 - 17s - loss: 3.2240 - accuracy20: 0.4103 - val_loss: 3.3215 - val_accuracy20: 0.3691 - 17s/epoch - 47ms/step
Epoch 11/50
358/358 - 17s - loss: 3.2146 - accuracy20: 0.4156 - val_loss: 3.3056 - val_accuracy20: 0.3764 - 17s/epoch - 47ms/step
Epoch 12/50
358/358 - 17s - loss: 3.2106 - accuracy20: 0.4190 - val_loss: 3.3089 - val_accuracy20: 0.3733 - 17s/epoch - 46ms/step
Epoch 13/50
358/358 - 17s - loss: 3.2030 - accuracy20: 0.4217 - val_loss: 3.2982 - val_accuracy20: 0.3824 - 17s/epoch - 47ms/step
Epoch 14/50
358/358 - 17s - loss: 3.1971 - accuracy20: 0.4235 - val_loss: 3.2978 - val_accuracy20: 0.3843 - 17s/epoch - 47ms/step
Epoch 15/50
358/358 - 17s - loss: 3.1900 - accuracy20: 0.4286 - val_loss: 3.2940 - val_accuracy20: 0.3839 - 17s/epoch - 46ms/step
Epoch 16/50
358/358 - 17s - loss: 3.1819 - accuracy20: 0.4307 - val_loss: 3.3019 - val_accuracy20: 0.3862 - 17s/epoch - 47ms/step
Epoch 17/50
358/358 - 17s - loss: 3.1786 - accuracy20: 0.4330 - val_loss: 3.3081 - val_accuracy20: 0.3846 - 17s/epoch - 47ms/step
Epoch 18/50
358/358 - 17s - loss: 3.1710 - accuracy20: 0.4361 - val_loss: 3.2905 - val_accuracy20: 0.3886 - 17s/epoch - 47ms/step
Epoch 19/50
358/358 - 17s - loss: 3.1614 - accuracy20: 0.4401 - val_loss: 3.2978 - val_accuracy20: 0.3871 - 17s/epoch - 46ms/step
Epoch 20/50
358/358 - 17s - loss: 3.1575 - accuracy20: 0.4426 - val_loss: 3.2960 - val_accuracy20: 0.3824 - 17s/epoch - 46ms/step
Epoch 21/50
358/358 - 17s - loss: 3.1491 - accuracy20: 0.4445 - val_loss: 3.3043 - val_accuracy20: 0.3857 - 17s/epoch - 46ms/step
Epoch 22/50
358/358 - 17s - loss: 3.1440 - accuracy20: 0.4470 - val_loss: 3.3101 - val_accuracy20: 0.3865 - 17s/epoch - 46ms/step
Epoch 23/50
358/358 - 17s - loss: 3.1357 - accuracy20: 0.4501 - val_loss: 3.3180 - val_accuracy20: 0.3830 - 17s/epoch - 46ms/step
Epoch 24/50
358/358 - 17s - loss: 3.1275 - accuracy20: 0.4529 - val_loss: 3.3188 - val_accuracy20: 0.3870 - 17s/epoch - 46ms/step
Epoch 25/50
358/358 - 17s - loss: 3.1186 - accuracy20: 0.4560 - val_loss: 3.3188 - val_accuracy20: 0.3844 - 17s/epoch - 47ms/step
Epoch 26/50
358/358 - 17s - loss: 3.1093 - accuracy20: 0.4598 - val_loss: 3.3312 - val_accuracy20: 0.3823 - 17s/epoch - 46ms/step
Epoch 27/50
358/358 - 17s - loss: 3.1032 - accuracy20: 0.4634 - val_loss: 3.3409 - val_accuracy20: 0.3819 - 17s/epoch - 47ms/step
Epoch 28/50
358/358 - 17s - loss: 3.0981 - accuracy20: 0.4640 - val_loss: 3.3523 - val_accuracy20: 0.3813 - 17s/epoch - 46ms/step
testing model: results/CHTR/W8/deepLOB_L2/h20
Evaluating performance on  test set...
1223/1223 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1022817
{'0': {'precision': 0.3671928175542087, 'recall': 0.5429823047871015, 'f1-score': 0.4381117380224065, 'support': 104322}, '1': {'precision': 0.3681202049913576, 'recall': 0.22495761023654878, 'f1-score': 0.2792599536464594, 'support': 107927}, '2': {'precision': 0.38718296808671104, 'recall': 0.3565645340530243, 'f1-score': 0.37124350458165895, 'support': 100784}, 'accuracy': 0.3733152734695703, 'macro avg': {'precision': 0.3741653302107591, 'recall': 0.37483481635889154, 'f1-score': 0.36287173208350826, 'support': 313033}, 'weighted avg': {'precision': 0.3739485828415646, 'recall': 0.3733152734695703, 'f1-score': 0.36181420846023526, 'support': 313033}}
[[56645 20785 26892]
 [53662 24279 29986]
 [43958 20890 35936]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0995299
{'0': {'precision': 0.3901631136017871, 'recall': 0.643890036548546, 'f1-score': 0.4858979278587874, 'support': 31465}, '1': {'precision': 0.3970987144710461, 'recall': 0.22375809935205185, 'f1-score': 0.28623042101460056, 'support': 30095}, '2': {'precision': 0.4167036478210704, 'recall': 0.31447804682005426, 'f1-score': 0.358444830416277, 'support': 29859}, 'accuracy': 0.3979916647524038, 'macro avg': {'precision': 0.40132182529796784, 'recall': 0.39404206090688404, 'f1-score': 0.3768577264298883, 'support': 91419}, 'weighted avg': {'precision': 0.40111489298478115, 'recall': 0.3979916647524038, 'f1-score': 0.37853933002888634, 'support': 91419}}
[[20260  4892  6313]
 [16530  6734  6831]
 [15137  5332  9390]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0965317
{'0': {'precision': 0.3928995958475315, 'recall': 0.575908932512487, 'f1-score': 0.4671188995666101, 'support': 8609}, '1': {'precision': 0.3478351809244928, 'recall': 0.20053056794887256, 'f1-score': 0.25439804191525167, 'support': 8293}, '2': {'precision': 0.4031560193433444, 'recall': 0.3791287697462901, 'f1-score': 0.3907734056987789, 'support': 8356}, 'accuracy': 0.38756037691028583, 'macro avg': {'precision': 0.3812969320384562, 'recall': 0.3851894234025499, 'f1-score': 0.3707634490602136, 'support': 25258}, 'weighted avg': {'precision': 0.38149661389227973, 'recall': 0.38756037691028583, 'f1-score': 0.37201885129428797, 'support': 25258}}
[[4958 1506 2145]
 [4085 1663 2545]
 [3576 1612 3168]]
training model: results/CHTR/W8/deepLOB_L2/h30
Epoch 1/50
358/358 - 19s - loss: 3.3455 - accuracy30: 0.3418 - val_loss: 3.3542 - val_accuracy30: 0.3427 - 19s/epoch - 53ms/step
Epoch 2/50
358/358 - 17s - loss: 3.3101 - accuracy30: 0.3509 - val_loss: 3.3072 - val_accuracy30: 0.3454 - 17s/epoch - 47ms/step
Epoch 3/50
358/358 - 17s - loss: 3.2909 - accuracy30: 0.3619 - val_loss: 3.2993 - val_accuracy30: 0.3534 - 17s/epoch - 47ms/step
Epoch 4/50
358/358 - 17s - loss: 3.2775 - accuracy30: 0.3744 - val_loss: 3.2983 - val_accuracy30: 0.3642 - 17s/epoch - 47ms/step
Epoch 5/50
358/358 - 17s - loss: 3.2668 - accuracy30: 0.3820 - val_loss: 3.3025 - val_accuracy30: 0.3650 - 17s/epoch - 46ms/step
Epoch 6/50
358/358 - 17s - loss: 3.2582 - accuracy30: 0.3891 - val_loss: 3.3057 - val_accuracy30: 0.3662 - 17s/epoch - 47ms/step
Epoch 7/50
358/358 - 17s - loss: 3.2510 - accuracy30: 0.3940 - val_loss: 3.3186 - val_accuracy30: 0.3618 - 17s/epoch - 47ms/step
Epoch 8/50
358/358 - 17s - loss: 3.2427 - accuracy30: 0.4017 - val_loss: 3.3088 - val_accuracy30: 0.3660 - 17s/epoch - 46ms/step
Epoch 9/50
358/358 - 17s - loss: 3.2365 - accuracy30: 0.4025 - val_loss: 3.3005 - val_accuracy30: 0.3699 - 17s/epoch - 46ms/step
Epoch 10/50
358/358 - 17s - loss: 3.2296 - accuracy30: 0.4091 - val_loss: 3.3177 - val_accuracy30: 0.3648 - 17s/epoch - 46ms/step
Epoch 11/50
358/358 - 17s - loss: 3.2224 - accuracy30: 0.4108 - val_loss: 3.3291 - val_accuracy30: 0.3617 - 17s/epoch - 46ms/step
Epoch 12/50
358/358 - 17s - loss: 3.2212 - accuracy30: 0.4106 - val_loss: 3.3159 - val_accuracy30: 0.3679 - 17s/epoch - 47ms/step
Epoch 13/50
358/358 - 17s - loss: 3.2134 - accuracy30: 0.4154 - val_loss: 3.3078 - val_accuracy30: 0.3663 - 17s/epoch - 47ms/step
Epoch 14/50
358/358 - 17s - loss: 3.2073 - accuracy30: 0.4195 - val_loss: 3.3057 - val_accuracy30: 0.3693 - 17s/epoch - 47ms/step
testing model: results/CHTR/W8/deepLOB_L2/h30
Evaluating performance on  test set...
1223/1223 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0995654
{'0': {'precision': 0.3563169372948696, 'recall': 0.6209442996773313, 'f1-score': 0.4528021018765285, 'support': 106301}, '1': {'precision': 0.35809346171296064, 'recall': 0.13362993340607246, 'f1-score': 0.1946297691622714, 'support': 106316}, '2': {'precision': 0.3558579519015787, 'recall': 0.31225103569152324, 'f1-score': 0.3326314002768834, 'support': 100416}, 'accuracy': 0.356412902154086, 'macro avg': {'precision': 0.35675611696980297, 'recall': 0.35560842292497563, 'f1-score': 0.32668775710522774, 'support': 313033}, 'weighted avg': {'precision': 0.3567730664978005, 'recall': 0.356412902154086, 'f1-score': 0.3265696890105402, 'support': 313033}}
[[66007 12391 27903]
 [63256 14207 28853]
 [55985 13076 31355]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0987625
{'0': {'precision': 0.3708080416720479, 'recall': 0.549032730981292, 'f1-score': 0.4426543328836641, 'support': 31377}, '1': {'precision': 0.34469304395537403, 'recall': 0.1882407777333866, 'f1-score': 0.2435022287301621, 'support': 30036}, '2': {'precision': 0.35713285244064713, 'recall': 0.3398986869292808, 'f1-score': 0.3483027115634178, 'support': 30006}, 'accuracy': 0.3618503812117831, 'macro avg': {'precision': 0.3575446460226897, 'recall': 0.3590573985479865, 'f1-score': 0.34481975772574797, 'support': 91419}, 'weighted avg': {'precision': 0.3577393382351757, 'recall': 0.3618503812117831, 'f1-score': 0.3462537230575897, 'support': 91419}}
[[17227  5257  8893]
 [14916  5654  9466]
 [14315  5492 10199]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0986464
{'0': {'precision': 0.3663232104121475, 'recall': 0.625825130283729, 'f1-score': 0.4621370847051781, 'support': 8635}, '1': {'precision': 0.3556420233463035, 'recall': 0.10903018012644639, 'f1-score': 0.16689491463525977, 'support': 8383}, '2': {'precision': 0.3572328629032258, 'recall': 0.3440533980582524, 'f1-score': 0.35051928783382785, 'support': 8240}, 'accuracy': 0.3623802359648428, 'macro avg': {'precision': 0.3597326988872256, 'recall': 0.35963623615614254, 'f1-score': 0.32651709572475524, 'support': 25258}, 'weighted avg': {'precision': 0.3598126056672553, 'recall': 0.3623802359648428, 'f1-score': 0.3277342912173306, 'support': 25258}}
[[5404  750 2481]
 [4849  914 2620]
 [4499  906 2835]]
training model: results/CHTR/W8/deepLOB_L2/h50
Epoch 1/50
358/358 - 19s - loss: 3.3451 - accuracy50: 0.3421 - val_loss: 3.3577 - val_accuracy50: 0.3408 - 19s/epoch - 53ms/step
Epoch 2/50
358/358 - 17s - loss: 3.3065 - accuracy50: 0.3529 - val_loss: 3.4059 - val_accuracy50: 0.3490 - 17s/epoch - 46ms/step
Epoch 3/50
358/358 - 17s - loss: 3.2924 - accuracy50: 0.3595 - val_loss: 3.3711 - val_accuracy50: 0.3486 - 17s/epoch - 46ms/step
Epoch 4/50
358/358 - 17s - loss: 3.2793 - accuracy50: 0.3732 - val_loss: 3.3712 - val_accuracy50: 0.3513 - 17s/epoch - 46ms/step
Epoch 5/50
358/358 - 17s - loss: 3.2691 - accuracy50: 0.3792 - val_loss: 3.3512 - val_accuracy50: 0.3512 - 17s/epoch - 47ms/step
Epoch 6/50
358/358 - 17s - loss: 3.2643 - accuracy50: 0.3838 - val_loss: 3.3731 - val_accuracy50: 0.3506 - 17s/epoch - 47ms/step
Epoch 7/50
358/358 - 17s - loss: 3.2542 - accuracy50: 0.3914 - val_loss: 3.3658 - val_accuracy50: 0.3568 - 17s/epoch - 46ms/step
Epoch 8/50
358/358 - 17s - loss: 3.2486 - accuracy50: 0.3942 - val_loss: 3.3699 - val_accuracy50: 0.3516 - 17s/epoch - 46ms/step
Epoch 9/50
358/358 - 17s - loss: 3.2414 - accuracy50: 0.4001 - val_loss: 3.3637 - val_accuracy50: 0.3583 - 17s/epoch - 46ms/step
Epoch 10/50
358/358 - 17s - loss: 3.2352 - accuracy50: 0.4023 - val_loss: 3.3557 - val_accuracy50: 0.3609 - 17s/epoch - 47ms/step
Epoch 11/50
358/358 - 17s - loss: 3.2282 - accuracy50: 0.4066 - val_loss: 3.3704 - val_accuracy50: 0.3583 - 17s/epoch - 46ms/step
Epoch 12/50
358/358 - 17s - loss: 3.2207 - accuracy50: 0.4103 - val_loss: 3.3690 - val_accuracy50: 0.3599 - 17s/epoch - 47ms/step
Epoch 13/50
358/358 - 17s - loss: 3.2176 - accuracy50: 0.4116 - val_loss: 3.3632 - val_accuracy50: 0.3585 - 17s/epoch - 47ms/step
Epoch 14/50
358/358 - 17s - loss: 3.2101 - accuracy50: 0.4164 - val_loss: 3.3723 - val_accuracy50: 0.3643 - 17s/epoch - 47ms/step
Epoch 15/50
358/358 - 17s - loss: 3.2058 - accuracy50: 0.4189 - val_loss: 3.3701 - val_accuracy50: 0.3692 - 17s/epoch - 46ms/step
testing model: results/CHTR/W8/deepLOB_L2/h50
Evaluating performance on  test set...
1223/1223 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0978957
{'0': {'precision': 0.36669164144214345, 'recall': 0.5789767565112053, 'f1-score': 0.449007152319825, 'support': 105664}, '1': {'precision': 0.3703859649122807, 'recall': 0.2897930049964311, 'f1-score': 0.32517019375904876, 'support': 109278}, '2': {'precision': 0.36401528880687994, 'recall': 0.2252500229378842, 'f1-score': 0.2782938364748188, 'support': 98091}, 'accuracy': 0.3671817348330687, 'macro avg': {'precision': 0.36703096505376803, 'recall': 0.3646732614818402, 'f1-score': 0.35082372751789753, 'support': 313033}, 'weighted avg': {'precision': 0.36714265514940125, 'recall': 0.3671817348330687, 'f1-score': 0.35228222228958217, 'support': 313033}}
[[61177 26546 17941]
 [56948 31668 20662]
 [48710 27286 22095]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1109091
{'0': {'precision': 0.36621088567739196, 'recall': 0.6626444323528471, 'f1-score': 0.4717234779438571, 'support': 31243}, '1': {'precision': 0.35145067698259186, 'recall': 0.2402565204456051, 'f1-score': 0.2854057450275863, 'support': 30251}, '2': {'precision': 0.3749120090102773, 'recall': 0.1779782790309106, 'f1-score': 0.24137227799052818, 'support': 29925}, 'accuracy': 0.36422406720703576, 'macro avg': {'precision': 0.3641911905567537, 'recall': 0.36029307727645427, 'f1-score': 0.33283383365399055, 'support': 91419}, 'weighted avg': {'precision': 0.36417487612259697, 'recall': 0.36422406720703576, 'f1-score': 0.33466709582358156, 'support': 91419}}
[[20703  6385  4155]
 [18258  7268  4725]
 [17572  7027  5326]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1134062
{'0': {'precision': 0.3546594287191418, 'recall': 0.6419464264826296, 'f1-score': 0.4568954751696291, 'support': 8549}, '1': {'precision': 0.3423250718882651, 'recall': 0.29380655776236925, 'f1-score': 0.3162155325069568, 'support': 8509}, '2': {'precision': 0.37605804111245467, 'recall': 0.11378048780487805, 'f1-score': 0.17470274318884002, 'support': 8200}, 'accuracy': 0.35319502731807745, 'macro avg': {'precision': 0.3576808472399538, 'recall': 0.34984449068329226, 'f1-score': 0.315937916955142, 'support': 25258}, 'weighted avg': {'precision': 0.357451240396679, 'recall': 0.35319502731807745, 'f1-score': 0.31788898081698247, 'support': 25258}}
[[5488 2360  701]
 [5162 2500  847]
 [4824 2443  933]]
training model: results/CHTR/W8/deepLOB_L2/h100
Epoch 1/50
358/358 - 19s - loss: 3.3515 - accuracy100: 0.3356 - val_loss: 3.3509 - val_accuracy100: 0.3421 - 19s/epoch - 53ms/step
Epoch 2/50
358/358 - 17s - loss: 3.3140 - accuracy100: 0.3450 - val_loss: 3.3461 - val_accuracy100: 0.3412 - 17s/epoch - 47ms/step
Epoch 3/50
358/358 - 17s - loss: 3.2993 - accuracy100: 0.3515 - val_loss: 3.3648 - val_accuracy100: 0.3411 - 17s/epoch - 46ms/step
Epoch 4/50
358/358 - 17s - loss: 3.2900 - accuracy100: 0.3595 - val_loss: 3.3791 - val_accuracy100: 0.3398 - 17s/epoch - 47ms/step
Epoch 5/50
358/358 - 17s - loss: 3.2815 - accuracy100: 0.3643 - val_loss: 3.3682 - val_accuracy100: 0.3404 - 17s/epoch - 47ms/step
Epoch 6/50
358/358 - 17s - loss: 3.2739 - accuracy100: 0.3708 - val_loss: 3.3873 - val_accuracy100: 0.3465 - 17s/epoch - 47ms/step
Epoch 7/50
358/358 - 17s - loss: 3.2680 - accuracy100: 0.3778 - val_loss: 3.3870 - val_accuracy100: 0.3440 - 17s/epoch - 47ms/step
Epoch 8/50
358/358 - 17s - loss: 3.2595 - accuracy100: 0.3844 - val_loss: 3.4207 - val_accuracy100: 0.3445 - 17s/epoch - 47ms/step
Epoch 9/50
358/358 - 17s - loss: 3.2522 - accuracy100: 0.3900 - val_loss: 3.4090 - val_accuracy100: 0.3526 - 17s/epoch - 47ms/step
Epoch 10/50
358/358 - 17s - loss: 3.2513 - accuracy100: 0.3923 - val_loss: 3.3931 - val_accuracy100: 0.3496 - 17s/epoch - 47ms/step
Epoch 11/50
358/358 - 17s - loss: 3.2424 - accuracy100: 0.3977 - val_loss: 3.4291 - val_accuracy100: 0.3494 - 17s/epoch - 47ms/step
Epoch 12/50
358/358 - 17s - loss: 3.2343 - accuracy100: 0.4026 - val_loss: 3.4103 - val_accuracy100: 0.3475 - 17s/epoch - 47ms/step
testing model: results/CHTR/W8/deepLOB_L2/h100
Evaluating performance on  test set...
1223/1223 - 21s - 21s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1048797
{'0': {'precision': 0.32972972972972975, 'recall': 0.2493276136308864, 'f1-score': 0.28394675449430495, 'support': 103735}, '1': {'precision': 0.36150944823087905, 'recall': 0.676185087610729, 'f1-score': 0.47113536687527724, 'support': 113114}, '2': {'precision': 0.314218688909162, 'recall': 0.07519961739998336, 'f1-score': 0.12135600614078504, 'support': 96184}, 'accuracy': 0.3500685231269547, 'macro avg': {'precision': 0.33515262228992365, 'recall': 0.3335707728805329, 'f1-score': 0.2921460425034557, 'support': 313033}, 'weighted avg': {'precision': 0.336447287074334, 'recall': 0.3500685231269547, 'f1-score': 0.3016286735291235, 'support': 313033}}
[[25864 70664  7207]
 [28049 76486  8579]
 [24527 64424  7233]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1184713
{'0': {'precision': 0.338579690907367, 'recall': 0.23110276986797826, 'f1-score': 0.2747028731874303, 'support': 30904}, '1': {'precision': 0.3328175620134423, 'recall': 0.6851028533510285, 'f1-score': 0.44800017356779454, 'support': 30140}, '2': {'precision': 0.34085969572567015, 'recall': 0.09293827160493827, 'f1-score': 0.14605375481801483, 'support': 30375}, 'accuracy': 0.3348756822979906, 'macro avg': {'precision': 0.3374189828821598, 'recall': 0.33638129827464835, 'f1-score': 0.28958560052441323, 'support': 91419}, 'weighted avg': {'precision': 0.3374375276972364, 'recall': 0.3348756822979906, 'f1-score': 0.2890922633907051, 'support': 91419}}
[[ 7142 20889  2873]
 [ 6905 20649  2586]
 [ 7047 20505  2823]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1138408
{'0': {'precision': 0.33548298572996704, 'recall': 0.2877486171589973, 'f1-score': 0.3097877732024073, 'support': 8497}, '1': {'precision': 0.3447143795141169, 'recall': 0.6661668012458184, 'f1-score': 0.454330894500826, 'support': 8669}, '2': {'precision': 0.36811832374691866, 'recall': 0.05536332179930796, 'f1-score': 0.09625093995058545, 'support': 8092}, 'accuracy': 0.34317839892311347, 'macro avg': {'precision': 0.3494385629970009, 'recall': 0.3364262467347079, 'f1-score': 0.28678986921793953, 'support': 25258}, 'weighted avg': {'precision': 0.3491068715462616, 'recall': 0.34317839892311347, 'f1-score': 0.29098597828049144, 'support': 25258}}
[[2445 5678  374]
 [2499 5775  395]
 [2344 5300  448]]
training model: results/CHTR/W8/deepLOB_L2/h200
Epoch 1/50
358/358 - 19s - loss: 3.3605 - accuracy200: 0.3339 - val_loss: 3.3300 - val_accuracy200: 0.3359 - 19s/epoch - 53ms/step
Epoch 2/50
358/358 - 17s - loss: 3.3156 - accuracy200: 0.3458 - val_loss: 3.3243 - val_accuracy200: 0.3462 - 17s/epoch - 47ms/step
Epoch 3/50
358/358 - 17s - loss: 3.3024 - accuracy200: 0.3522 - val_loss: 3.3141 - val_accuracy200: 0.3424 - 17s/epoch - 47ms/step
Epoch 4/50
358/358 - 17s - loss: 3.2942 - accuracy200: 0.3577 - val_loss: 3.3981 - val_accuracy200: 0.3496 - 17s/epoch - 47ms/step
Epoch 5/50
358/358 - 17s - loss: 3.2868 - accuracy200: 0.3622 - val_loss: 3.4124 - val_accuracy200: 0.3465 - 17s/epoch - 47ms/step
Epoch 6/50
358/358 - 17s - loss: 3.2795 - accuracy200: 0.3668 - val_loss: 3.3673 - val_accuracy200: 0.3461 - 17s/epoch - 47ms/step
Epoch 7/50
358/358 - 17s - loss: 3.2719 - accuracy200: 0.3729 - val_loss: 3.3813 - val_accuracy200: 0.3417 - 17s/epoch - 46ms/step
Epoch 8/50
358/358 - 17s - loss: 3.2597 - accuracy200: 0.3831 - val_loss: 3.3968 - val_accuracy200: 0.3398 - 17s/epoch - 47ms/step
Epoch 9/50
358/358 - 17s - loss: 3.2509 - accuracy200: 0.3884 - val_loss: 3.3741 - val_accuracy200: 0.3444 - 17s/epoch - 46ms/step
Epoch 10/50
358/358 - 17s - loss: 3.2445 - accuracy200: 0.3960 - val_loss: 3.3663 - val_accuracy200: 0.3492 - 17s/epoch - 47ms/step
Epoch 11/50
358/358 - 17s - loss: 3.2354 - accuracy200: 0.4037 - val_loss: 3.3734 - val_accuracy200: 0.3458 - 17s/epoch - 47ms/step
Epoch 12/50
358/358 - 17s - loss: 3.2227 - accuracy200: 0.4088 - val_loss: 3.3576 - val_accuracy200: 0.3452 - 17s/epoch - 46ms/step
Epoch 13/50
358/358 - 17s - loss: 3.2157 - accuracy200: 0.4132 - val_loss: 3.4246 - val_accuracy200: 0.3542 - 17s/epoch - 46ms/step
testing model: results/CHTR/W8/deepLOB_L2/h200
Evaluating performance on  test set...
1223/1223 - 23s - 23s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1047083
{'0': {'precision': 0.30812910013615546, 'recall': 0.19435146239350437, 'f1-score': 0.2383588368711139, 'support': 102469}, '1': {'precision': 0.3542943175856012, 'recall': 0.6850146430965739, 'f1-score': 0.4670349331978145, 'support': 113364}, '2': {'precision': 0.3178737677984666, 'recall': 0.09554526748971194, 'f1-score': 0.14692760410074676, 'support': 97200}, 'accuracy': 0.34136337063504485, 'macro avg': {'precision': 0.3267657285067411, 'recall': 0.3249704576599301, 'f1-score': 0.284107124723225, 'support': 313033}, 'weighted avg': {'precision': 0.3278735213560128, 'recall': 0.34136337063504485, 'f1-score': 0.29278287893281474, 'support': 313033}}
[[19915 72985  9569]
 [25348 77656 10360]
 [19369 68544  9287]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1134586
{'0': {'precision': 0.3292580494633691, 'recall': 0.23362691212502484, 'f1-score': 0.27331887201735355, 'support': 30202}, '1': {'precision': 0.3328594955361012, 'recall': 0.6340102360904738, 'f1-score': 0.436535182448562, 'support': 30285}, '2': {'precision': 0.35208062418725616, 'recall': 0.14004914004914004, 'f1-score': 0.20038856508465167, 'support': 30932}, 'accuracy': 0.33460221616950525, 'macro avg': {'precision': 0.33806605639557546, 'recall': 0.3358954294215462, 'f1-score': 0.30341420651685574, 'support': 91419}, 'weighted avg': {'precision': 0.33817323859989395, 'recall': 0.33460221616950525, 'f1-score': 0.30271238657523336, 'support': 91419}}
[[ 7056 19067  4079]
 [ 7191 19201  3893]
 [ 7183 19417  4332]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1052303
{'0': {'precision': 0.3363023591718825, 'recall': 0.32959773504777634, 'f1-score': 0.33291629431039615, 'support': 8477}, '1': {'precision': 0.35587529976019183, 'recall': 0.5994921514312096, 'f1-score': 0.4466228126746636, 'support': 8664}, '2': {'precision': 0.31507430997876856, 'recall': 0.09141308365159542, 'f1-score': 0.14171122994652405, 'support': 8117}, 'accuracy': 0.34563306675112837, 'macro avg': {'precision': 0.3357506563036143, 'recall': 0.34016765671019383, 'f1-score': 0.30708344564386125, 'support': 25258}, 'weighted avg': {'precision': 0.3361943491139447, 'recall': 0.34563306675112837, 'f1-score': 0.3104735738917748, 'support': 25258}}
[[2794 4897  786]
 [2643 5194  827]
 [2871 4504  742]]
training model: results/CHTR/W8/deepLOB_L2/h300
Epoch 1/50
358/358 - 20s - loss: 3.3566 - accuracy300: 0.3402 - val_loss: 3.3885 - val_accuracy300: 0.3372 - 20s/epoch - 55ms/step
Epoch 2/50
358/358 - 17s - loss: 3.3199 - accuracy300: 0.3464 - val_loss: 3.3318 - val_accuracy300: 0.3504 - 17s/epoch - 47ms/step
Epoch 3/50
358/358 - 17s - loss: 3.3038 - accuracy300: 0.3567 - val_loss: 3.3216 - val_accuracy300: 0.3494 - 17s/epoch - 47ms/step
Epoch 4/50
358/358 - 17s - loss: 3.2970 - accuracy300: 0.3598 - val_loss: 3.3401 - val_accuracy300: 0.3483 - 17s/epoch - 47ms/step
Epoch 5/50
358/358 - 17s - loss: 3.2833 - accuracy300: 0.3669 - val_loss: 3.3343 - val_accuracy300: 0.3427 - 17s/epoch - 47ms/step
Epoch 6/50
358/358 - 17s - loss: 3.2787 - accuracy300: 0.3724 - val_loss: 3.3681 - val_accuracy300: 0.3511 - 17s/epoch - 47ms/step
Epoch 7/50
358/358 - 17s - loss: 3.2674 - accuracy300: 0.3811 - val_loss: 3.3976 - val_accuracy300: 0.3464 - 17s/epoch - 47ms/step
Epoch 8/50
358/358 - 17s - loss: 3.2574 - accuracy300: 0.3902 - val_loss: 3.4315 - val_accuracy300: 0.3458 - 17s/epoch - 47ms/step
Epoch 9/50
358/358 - 17s - loss: 3.2479 - accuracy300: 0.3975 - val_loss: 3.4024 - val_accuracy300: 0.3466 - 17s/epoch - 47ms/step
Epoch 10/50
358/358 - 17s - loss: 3.2402 - accuracy300: 0.4006 - val_loss: 3.4379 - val_accuracy300: 0.3458 - 17s/epoch - 47ms/step
Epoch 11/50
358/358 - 17s - loss: 3.2268 - accuracy300: 0.4113 - val_loss: 3.4656 - val_accuracy300: 0.3459 - 17s/epoch - 46ms/step
Epoch 12/50
358/358 - 17s - loss: 3.2128 - accuracy300: 0.4179 - val_loss: 3.4462 - val_accuracy300: 0.3520 - 17s/epoch - 47ms/step
Epoch 13/50
358/358 - 17s - loss: 3.2003 - accuracy300: 0.4248 - val_loss: 3.4433 - val_accuracy300: 0.3459 - 17s/epoch - 47ms/step
testing model: results/CHTR/W8/deepLOB_L2/h300
Evaluating performance on  test set...
1223/1223 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1129097
{'0': {'precision': 0.3308498311799958, 'recall': 0.2628297124758747, 'f1-score': 0.29294311023839203, 'support': 101035}, '1': {'precision': 0.36796151793793064, 'recall': 0.4242986320426617, 'f1-score': 0.39412702685911905, 'support': 112138}, '2': {'precision': 0.31596802721745937, 'recall': 0.32736831564189867, 'f1-score': 0.3215671616098523, 'support': 99860}, 'accuracy': 0.34126114499110316, 'macro avg': {'precision': 0.3382597921117953, 'recall': 0.3381655533868117, 'f1-score': 0.3362124329024545, 'support': 313033}, 'weighted avg': {'precision': 0.33939696003210534, 'recall': 0.34126114499110316, 'f1-score': 0.3383215841116549, 'support': 313033}}
[[26555 40269 34211]
 [27997 47580 36561]
 [25711 41458 32691]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1158988
{'0': {'precision': 0.3333571173742419, 'recall': 0.31185128324934086, 'f1-score': 0.322245788284793, 'support': 29963}, '1': {'precision': 0.34484887459807073, 'recall': 0.44293927179012754, 'f1-score': 0.387787275278055, 'support': 30266}, '2': {'precision': 0.343395610671453, 'recall': 0.2698941968579673, 'f1-score': 0.3022404136148212, 'support': 31190}, 'accuracy': 0.34093569170522536, 'macro avg': {'precision': 0.3405338675479219, 'recall': 0.34156158396581193, 'f1-score': 0.3374244923925564, 'support': 91419}, 'weighted avg': {'precision': 0.34058657875619114, 'recall': 0.34093569170522536, 'f1-score': 0.3371191845085719, 'support': 91419}}
[[ 9344 12467  8152]
 [ 8916 13406  7944]
 [ 9770 13002  8418]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.106486
{'0': {'precision': 0.3402333981661573, 'recall': 0.29133951939091124, 'f1-score': 0.3138938733658036, 'support': 8406}, '1': {'precision': 0.3608498545233101, 'recall': 0.6002250984805853, 'f1-score': 0.4507268424611224, 'support': 8885}, '2': {'precision': 0.3227674489484913, 'recall': 0.13292330864817373, 'f1-score': 0.18830014224751068, 'support': 7967}, 'accuracy': 0.3500277139916066, 'macro avg': {'precision': 0.3412835672126529, 'recall': 0.34149597550655675, 'f1-score': 0.31764028602481226, 'support': 25258}, 'weighted avg': {'precision': 0.3419764497662902, 'recall': 0.3500277139916066, 'f1-score': 0.32241219130833537, 'support': 25258}}
[[2449 4822 1135]
 [2465 5333 1087]
 [2284 4624 1059]]
training model: results/CHTR/W8/deepLOB_L2/h500
Epoch 1/50
358/358 - 19s - loss: 3.3441 - accuracy500: 0.3476 - val_loss: 3.3676 - val_accuracy500: 0.3442 - 19s/epoch - 53ms/step
Epoch 2/50
358/358 - 17s - loss: 3.3194 - accuracy500: 0.3553 - val_loss: 3.4825 - val_accuracy500: 0.3428 - 17s/epoch - 47ms/step
Epoch 3/50
358/358 - 17s - loss: 3.3050 - accuracy500: 0.3614 - val_loss: 3.5093 - val_accuracy500: 0.3420 - 17s/epoch - 47ms/step
Epoch 4/50
358/358 - 17s - loss: 3.2933 - accuracy500: 0.3613 - val_loss: 3.4750 - val_accuracy500: 0.3311 - 17s/epoch - 47ms/step
Epoch 5/50
358/358 - 17s - loss: 3.2789 - accuracy500: 0.3732 - val_loss: 3.5561 - val_accuracy500: 0.3251 - 17s/epoch - 47ms/step
Epoch 6/50
358/358 - 17s - loss: 3.2608 - accuracy500: 0.3854 - val_loss: 3.4573 - val_accuracy500: 0.3302 - 17s/epoch - 47ms/step
Epoch 7/50
358/358 - 17s - loss: 3.2475 - accuracy500: 0.3996 - val_loss: 3.6004 - val_accuracy500: 0.3347 - 17s/epoch - 46ms/step
Epoch 8/50
358/358 - 17s - loss: 3.2370 - accuracy500: 0.4081 - val_loss: 3.6382 - val_accuracy500: 0.3261 - 17s/epoch - 47ms/step
Epoch 9/50
358/358 - 17s - loss: 3.2243 - accuracy500: 0.4108 - val_loss: 3.5881 - val_accuracy500: 0.3240 - 17s/epoch - 47ms/step
Epoch 10/50
358/358 - 17s - loss: 3.2030 - accuracy500: 0.4248 - val_loss: 3.5494 - val_accuracy500: 0.3318 - 17s/epoch - 46ms/step
Epoch 11/50
358/358 - 17s - loss: 3.1852 - accuracy500: 0.4309 - val_loss: 3.6125 - val_accuracy500: 0.3275 - 17s/epoch - 47ms/step
testing model: results/CHTR/W8/deepLOB_L2/h500
Evaluating performance on  test set...
1223/1223 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1412884
{'0': {'precision': 0.31630969853619256, 'recall': 0.24140084455105965, 'f1-score': 0.27382458270788707, 'support': 100882}, '1': {'precision': 0.3501307329046717, 'recall': 0.4764467760673831, 'f1-score': 0.4036370626682046, 'support': 110176}, '2': {'precision': 0.32283610859518336, 'recall': 0.272635449865163, 'f1-score': 0.2956197200321118, 'support': 101975}, 'accuracy': 0.3343034121003217, 'macro avg': {'precision': 0.32975884667868255, 'recall': 0.3301610234945353, 'f1-score': 0.3243604551360678, 'support': 313033}, 'weighted avg': {'precision': 0.33033951950825347, 'recall': 0.3343034121003217, 'f1-score': 0.32661383790061677, 'support': 313033}}
[[24353 48364 28165]
 [27532 52493 30151]
 [25106 49067 27802]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1764593
{'0': {'precision': 0.32672893345237275, 'recall': 0.3180678589336453, 'f1-score': 0.3223402273150736, 'support': 29915}, '1': {'precision': 0.31991861212251016, 'recall': 0.49409546492011513, 'f1-score': 0.38837248605712354, 'support': 30231}, '2': {'precision': 0.3525341193054399, 'recall': 0.1759345121990215, 'f1-score': 0.2347269624573379, 'support': 31273}, 'accuracy': 0.32765617650597795, 'macro avg': {'precision': 0.3330605549601076, 'recall': 0.3293659453509273, 'f1-score': 0.31514655860984503, 'support': 91419}, 'weighted avg': {'precision': 0.3333044019333219, 'recall': 0.32765617650597795, 'f1-score': 0.31420506484485344, 'support': 91419}}
[[ 9515 15449  4951]
 [10140 14937  5154]
 [ 9467 16304  5502]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1256388
{'0': {'precision': 0.32734257099739333, 'recall': 0.5881192999753513, 'f1-score': 0.42058875374581345, 'support': 8114}, '1': {'precision': 0.3647008271565152, 'recall': 0.36450504616706036, 'f1-score': 0.3646029103796381, 'support': 9314}, '2': {'precision': 0.3508388037928519, 'recall': 0.06143039591315454, 'f1-score': 0.10455385284208239, 'support': 7830}, 'accuracy': 0.34238657059149574, 'macro avg': {'precision': 0.3476274006489201, 'recall': 0.33801824735185537, 'f1-score': 0.29658183898917795, 'support': 25258}, 'weighted avg': {'precision': 0.34840244512260127, 'recall': 0.34238657059149574, 'f1-score': 0.30197265511612104, 'support': 25258}}
[[4772 2921  421]
 [5450 3395  469]
 [4356 2993  481]]
training model: results/CHTR/W8/deepLOB_L2/h1000
Epoch 1/50
358/358 - 19s - loss: 3.3366 - accuracy1000: 0.3556 - val_loss: 3.4839 - val_accuracy1000: 0.3355 - 19s/epoch - 53ms/step
Epoch 2/50
358/358 - 17s - loss: 3.3104 - accuracy1000: 0.3732 - val_loss: 3.4308 - val_accuracy1000: 0.3537 - 17s/epoch - 48ms/step
Epoch 3/50
358/358 - 17s - loss: 3.2892 - accuracy1000: 0.3760 - val_loss: 3.4437 - val_accuracy1000: 0.3414 - 17s/epoch - 47ms/step
Epoch 4/50
358/358 - 17s - loss: 3.2651 - accuracy1000: 0.3897 - val_loss: 3.4017 - val_accuracy1000: 0.3264 - 17s/epoch - 47ms/step
Epoch 5/50
358/358 - 17s - loss: 3.2411 - accuracy1000: 0.4025 - val_loss: 3.4476 - val_accuracy1000: 0.3247 - 17s/epoch - 47ms/step
Epoch 6/50
358/358 - 17s - loss: 3.2259 - accuracy1000: 0.4094 - val_loss: 3.4968 - val_accuracy1000: 0.3283 - 17s/epoch - 47ms/step
Epoch 7/50
358/358 - 17s - loss: 3.2072 - accuracy1000: 0.4178 - val_loss: 3.4227 - val_accuracy1000: 0.3279 - 17s/epoch - 47ms/step
Epoch 8/50
358/358 - 17s - loss: 3.1878 - accuracy1000: 0.4266 - val_loss: 3.4406 - val_accuracy1000: 0.3241 - 17s/epoch - 46ms/step
Epoch 9/50
358/358 - 17s - loss: 3.1757 - accuracy1000: 0.4337 - val_loss: 3.4138 - val_accuracy1000: 0.3292 - 17s/epoch - 46ms/step
Epoch 10/50
358/358 - 17s - loss: 3.1521 - accuracy1000: 0.4430 - val_loss: 3.4180 - val_accuracy1000: 0.3313 - 17s/epoch - 47ms/step
Epoch 11/50
358/358 - 17s - loss: 3.1329 - accuracy1000: 0.4542 - val_loss: 3.4355 - val_accuracy1000: 0.3230 - 17s/epoch - 46ms/step
Epoch 12/50
358/358 - 17s - loss: 3.1215 - accuracy1000: 0.4586 - val_loss: 3.4135 - val_accuracy1000: 0.3279 - 17s/epoch - 47ms/step
Epoch 13/50
358/358 - 17s - loss: 3.0978 - accuracy1000: 0.4649 - val_loss: 3.5020 - val_accuracy1000: 0.3238 - 17s/epoch - 46ms/step
Epoch 14/50
358/358 - 17s - loss: 3.0796 - accuracy1000: 0.4743 - val_loss: 3.4770 - val_accuracy1000: 0.3269 - 17s/epoch - 47ms/step
testing model: results/CHTR/W8/deepLOB_L2/h1000
Evaluating performance on  test set...
1223/1223 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1279368
{'0': {'precision': 0.3291723454342708, 'recall': 0.5409078415603717, 'f1-score': 0.40927699660701006, 'support': 98233}, '1': {'precision': 0.38762193514368576, 'recall': 0.15848904060366512, 'f1-score': 0.224986610217042, 'support': 111320}, '2': {'precision': 0.34810597849138053, 'recall': 0.3569095477386935, 'f1-score': 0.3524527977783822, 'support': 103480}, 'accuracy': 0.3440883229563656, 'macro avg': {'precision': 0.35496675302311237, 'recall': 0.3521021433009101, 'f1-score': 0.3289054682008114, 'support': 313033}, 'weighted avg': {'precision': 0.35621697227936955, 'recall': 0.3440883229563656, 'f1-score': 0.3249556186445663, 'support': 313033}}
[[53135 13909 31189]
 [55702 17643 37975]
 [52583 13964 36933]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.137178
{'0': {'precision': 0.3301037001719822, 'recall': 0.649534275949876, 'f1-score': 0.43774062073092246, 'support': 29846}, '1': {'precision': 0.3306873977086743, 'recall': 0.13381680906020266, 'f1-score': 0.19053232118440283, 'support': 30198}, '2': {'precision': 0.3527745212973818, 'recall': 0.23018326693227092, 'f1-score': 0.2785889251065636, 'support': 31375}, 'accuracy': 0.33525853487787005, 'macro avg': {'precision': 0.3378552063926794, 'recall': 0.3378447839807832, 'f1-score': 0.3022872890072963, 'support': 91419}, 'weighted avg': {'precision': 0.3380771357928317, 'recall': 0.33525853487787005, 'f1-score': 0.3014606277325298, 'support': 91419}}
[[19386  4027  6433]
 [19340  4041  6817]
 [20001  4152  7222]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1357789
{'0': {'precision': 0.3218528409614145, 'recall': 0.8603076923076923, 'f1-score': 0.4684515631806454, 'support': 8125}, '1': {'precision': 0.3781785925487877, 'recall': 0.13641211604095563, 'f1-score': 0.2005016460260229, 'support': 9376}, '2': {'precision': 0.41139240506329117, 'recall': 0.008379528168106226, 'f1-score': 0.016424510423247, 'support': 7757}, 'accuracy': 0.3299548657850978, 'macro avg': {'precision': 0.3704746128578311, 'recall': 0.3350331121722514, 'f1-score': 0.22845923987663844, 'support': 25258}, 'weighted avg': {'precision': 0.37026002465060087, 'recall': 0.3299548657850978, 'f1-score': 0.23016380201662295, 'support': 25258}}
[[6990 1098   37]
 [8041 1279   56]
 [6687 1005   65]]
training model: results/CHTR/W8/deepOF_L2/h10
Epoch 1/50
358/358 - 13s - loss: 3.3320 - accuracy10: 0.3470 - val_loss: 3.3055 - val_accuracy10: 0.3596 - 13s/epoch - 37ms/step
Epoch 2/50
358/358 - 11s - loss: 3.2797 - accuracy10: 0.3761 - val_loss: 3.2808 - val_accuracy10: 0.3753 - 11s/epoch - 29ms/step
Epoch 3/50
358/358 - 11s - loss: 3.2560 - accuracy10: 0.3893 - val_loss: 3.2693 - val_accuracy10: 0.3836 - 11s/epoch - 29ms/step
Epoch 4/50
358/358 - 11s - loss: 3.2393 - accuracy10: 0.3997 - val_loss: 3.2675 - val_accuracy10: 0.3865 - 11s/epoch - 29ms/step
Epoch 5/50
358/358 - 11s - loss: 3.2261 - accuracy10: 0.4075 - val_loss: 3.2606 - val_accuracy10: 0.3883 - 11s/epoch - 29ms/step
Epoch 6/50
358/358 - 10s - loss: 3.2171 - accuracy10: 0.4123 - val_loss: 3.2565 - val_accuracy10: 0.3959 - 10s/epoch - 29ms/step
Epoch 7/50
358/358 - 11s - loss: 3.2048 - accuracy10: 0.4187 - val_loss: 3.2529 - val_accuracy10: 0.3955 - 11s/epoch - 30ms/step
Epoch 8/50
358/358 - 11s - loss: 3.1944 - accuracy10: 0.4221 - val_loss: 3.2523 - val_accuracy10: 0.3944 - 11s/epoch - 29ms/step
Epoch 9/50
358/358 - 11s - loss: 3.1857 - accuracy10: 0.4270 - val_loss: 3.2498 - val_accuracy10: 0.3972 - 11s/epoch - 30ms/step
Epoch 10/50
358/358 - 10s - loss: 3.1775 - accuracy10: 0.4319 - val_loss: 3.2509 - val_accuracy10: 0.3941 - 10s/epoch - 29ms/step
Epoch 11/50
358/358 - 11s - loss: 3.1692 - accuracy10: 0.4345 - val_loss: 3.2568 - val_accuracy10: 0.3957 - 11s/epoch - 29ms/step
Epoch 12/50
358/358 - 11s - loss: 3.1588 - accuracy10: 0.4377 - val_loss: 3.2611 - val_accuracy10: 0.3951 - 11s/epoch - 30ms/step
Epoch 13/50
358/358 - 11s - loss: 3.1513 - accuracy10: 0.4417 - val_loss: 3.2605 - val_accuracy10: 0.3958 - 11s/epoch - 30ms/step
Epoch 14/50
358/358 - 10s - loss: 3.1453 - accuracy10: 0.4439 - val_loss: 3.2600 - val_accuracy10: 0.3987 - 10s/epoch - 29ms/step
Epoch 15/50
358/358 - 11s - loss: 3.1338 - accuracy10: 0.4503 - val_loss: 3.2615 - val_accuracy10: 0.3955 - 11s/epoch - 29ms/step
Epoch 16/50
358/358 - 11s - loss: 3.1244 - accuracy10: 0.4535 - val_loss: 3.2634 - val_accuracy10: 0.3953 - 11s/epoch - 29ms/step
Epoch 17/50
358/358 - 10s - loss: 3.1189 - accuracy10: 0.4548 - val_loss: 3.2714 - val_accuracy10: 0.3979 - 10s/epoch - 29ms/step
Epoch 18/50
358/358 - 11s - loss: 3.1095 - accuracy10: 0.4584 - val_loss: 3.2748 - val_accuracy10: 0.3950 - 11s/epoch - 30ms/step
Epoch 19/50
358/358 - 11s - loss: 3.1009 - accuracy10: 0.4635 - val_loss: 3.2742 - val_accuracy10: 0.3981 - 11s/epoch - 29ms/step
testing model: results/CHTR/W8/deepOF_L2/h10
Evaluating performance on  test set...
1223/1223 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0855279
{'0': {'precision': 0.36928494956894126, 'recall': 0.6399722672499658, 'f1-score': 0.46832883133959324, 'support': 102406}, '1': {'precision': 0.40092698503479174, 'recall': 0.31006901889956784, 'f1-score': 0.34969264584383397, 'support': 108521}, '2': {'precision': 0.4352120859965137, 'recall': 0.2200761990577957, 'f1-score': 0.2923288081128725, 'support': 102101}, 'accuracy': 0.3886425495482832, 'macro avg': {'precision': 0.4018080068667489, 'recall': 0.3900391617357764, 'f1-score': 0.37011676176543323, 'support': 313028}, 'weighted avg': {'precision': 0.40175824872167243, 'recall': 0.3886425495482832, 'f1-score': 0.3697935697730346, 'support': 313028}}
[[65537 23547 13322]
 [59034 33649 15838]
 [52899 26732 22470]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0664501
{'0': {'precision': 0.40710865634871757, 'recall': 0.65206046141607, 'f1-score': 0.5012598155532181, 'support': 31425}, '1': {'precision': 0.41138059701492535, 'recall': 0.3211838315622207, 'f1-score': 0.3607294900633935, 'support': 30207}, '2': {'precision': 0.46262857142857144, 'recall': 0.27181467181467184, 'f1-score': 0.342434175742836, 'support': 29785}, 'accuracy': 0.4188389468042049, 'macro avg': {'precision': 0.4270392749307381, 'recall': 0.4150196549309875, 'f1-score': 0.40147449378648253, 'support': 91417}, 'weighted avg': {'precision': 0.42660944047374444, 'recall': 0.4188389468042049, 'f1-score': 0.40307653209583755, 'support': 91417}}
[[20491  6532  4402]
 [15503  9702  5002]
 [14339  7350  8096]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0821218
{'0': {'precision': 0.39133079847908747, 'recall': 0.6043452730475631, 'f1-score': 0.47505192707131316, 'support': 8515}, '1': {'precision': 0.3771048972655647, 'recall': 0.299545956559087, 'f1-score': 0.33388045411024486, 'support': 8149}, '2': {'precision': 0.4414270500532481, 'recall': 0.28942162225066914, 'f1-score': 0.3496169255640683, 'support': 8593}, 'accuracy': 0.39885972205725145, 'macro avg': {'precision': 0.40328758193263337, 'recall': 0.39777095061910644, 'f1-score': 0.3861831022485422, 'support': 25257}, 'weighted avg': {'precision': 0.4037847803766907, 'recall': 0.39885972205725145, 'f1-score': 0.38682809601016177, 'support': 25257}}
[[5146 1898 1471]
 [4032 2441 1676]
 [3972 2134 2487]]
training model: results/CHTR/W8/deepOF_L2/h20
Epoch 1/50
358/358 - 13s - loss: 3.3299 - accuracy20: 0.3482 - val_loss: 3.3080 - val_accuracy20: 0.3571 - 13s/epoch - 37ms/step
Epoch 2/50
358/358 - 11s - loss: 3.2803 - accuracy20: 0.3762 - val_loss: 3.2853 - val_accuracy20: 0.3776 - 11s/epoch - 29ms/step
Epoch 3/50
358/358 - 11s - loss: 3.2585 - accuracy20: 0.3899 - val_loss: 3.2696 - val_accuracy20: 0.3837 - 11s/epoch - 29ms/step
Epoch 4/50
358/358 - 11s - loss: 3.2419 - accuracy20: 0.4017 - val_loss: 3.2636 - val_accuracy20: 0.3878 - 11s/epoch - 30ms/step
Epoch 5/50
358/358 - 11s - loss: 3.2305 - accuracy20: 0.4053 - val_loss: 3.2606 - val_accuracy20: 0.3877 - 11s/epoch - 29ms/step
Epoch 6/50
358/358 - 11s - loss: 3.2203 - accuracy20: 0.4111 - val_loss: 3.2579 - val_accuracy20: 0.3917 - 11s/epoch - 29ms/step
Epoch 7/50
358/358 - 10s - loss: 3.2130 - accuracy20: 0.4150 - val_loss: 3.2538 - val_accuracy20: 0.3917 - 10s/epoch - 29ms/step
Epoch 8/50
358/358 - 10s - loss: 3.2059 - accuracy20: 0.4197 - val_loss: 3.2576 - val_accuracy20: 0.3909 - 10s/epoch - 29ms/step
Epoch 9/50
358/358 - 10s - loss: 3.1969 - accuracy20: 0.4235 - val_loss: 3.2601 - val_accuracy20: 0.3926 - 10s/epoch - 29ms/step
Epoch 10/50
358/358 - 10s - loss: 3.1888 - accuracy20: 0.4271 - val_loss: 3.2586 - val_accuracy20: 0.3900 - 10s/epoch - 29ms/step
Epoch 11/50
358/358 - 10s - loss: 3.1822 - accuracy20: 0.4312 - val_loss: 3.2580 - val_accuracy20: 0.3931 - 10s/epoch - 29ms/step
Epoch 12/50
358/358 - 10s - loss: 3.1755 - accuracy20: 0.4336 - val_loss: 3.2674 - val_accuracy20: 0.3886 - 10s/epoch - 29ms/step
Epoch 13/50
358/358 - 10s - loss: 3.1669 - accuracy20: 0.4386 - val_loss: 3.2692 - val_accuracy20: 0.3883 - 10s/epoch - 29ms/step
Epoch 14/50
358/358 - 10s - loss: 3.1574 - accuracy20: 0.4435 - val_loss: 3.2679 - val_accuracy20: 0.3940 - 10s/epoch - 29ms/step
Epoch 15/50
358/358 - 10s - loss: 3.1527 - accuracy20: 0.4462 - val_loss: 3.2735 - val_accuracy20: 0.3934 - 10s/epoch - 29ms/step
Epoch 16/50
358/358 - 10s - loss: 3.1432 - accuracy20: 0.4488 - val_loss: 3.2789 - val_accuracy20: 0.3890 - 10s/epoch - 29ms/step
Epoch 17/50
358/358 - 10s - loss: 3.1360 - accuracy20: 0.4525 - val_loss: 3.2773 - val_accuracy20: 0.3927 - 10s/epoch - 29ms/step
testing model: results/CHTR/W8/deepOF_L2/h20
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0890813
{'0': {'precision': 0.3689240640385182, 'recall': 0.6845571319018405, 'f1-score': 0.47945725114219634, 'support': 104320}, '1': {'precision': 0.3915951723135088, 'recall': 0.12476025461654637, 'f1-score': 0.18923210973073248, 'support': 107927}, '2': {'precision': 0.4093708858378785, 'recall': 0.34556116728351577, 'f1-score': 0.37476930692536575, 'support': 100781}, 'accuracy': 0.3824066856639023, 'macro avg': {'precision': 0.3899633740633018, 'recall': 0.38495951793396754, 'f1-score': 0.34781955593276487, 'support': 313028}, 'weighted avg': {'precision': 0.38976276169673485, 'recall': 0.3824066856639023, 'f1-score': 0.3456874780125355, 'support': 313028}}
[[71413 10071 22836]
 [67052 13465 27410]
 [55106 10849 34826]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0743133
{'0': {'precision': 0.39798474744869766, 'recall': 0.6879915931598892, 'f1-score': 0.504265424967032, 'support': 31403}, '1': {'precision': 0.4017613945887053, 'recall': 0.14667373794292154, 'f1-score': 0.21489449530145935, 'support': 30169}, '2': {'precision': 0.4352720450281426, 'recall': 0.3809013235047747, 'f1-score': 0.4062756870733712, 'support': 29845}, 'accuracy': 0.4090924007569708, 'macro avg': {'precision': 0.41167272902184854, 'recall': 0.40518888486919513, 'f1-score': 0.3751452024472875, 'support': 91417}, 'weighted avg': {'precision': 0.41140431999893917, 'recall': 0.4090924007569708, 'f1-score': 0.3767778099225986, 'support': 91417}}
[[21605  3023  6775]
 [17770  4425  7974]
 [14911  3566 11368]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0838777
{'0': {'precision': 0.3878161738510866, 'recall': 0.6356417143524465, 'f1-score': 0.48172404637578553, 'support': 8563}, '1': {'precision': 0.3750429700928154, 'recall': 0.13051800454599832, 'f1-score': 0.19364572239971603, 'support': 8359}, '2': {'precision': 0.4050282689763022, 'recall': 0.40395920815836833, 'f1-score': 0.40449303219605953, 'support': 8335}, 'accuracy': 0.39201013580393557, 'macro avg': {'precision': 0.3892958043067347, 'recall': 0.390039642352271, 'f1-score': 0.3599542669905204, 'support': 25257}, 'weighted avg': {'precision': 0.3892689038923933, 'recall': 0.39201013580393557, 'f1-score': 0.3608954755516979, 'support': 25257}}
[[5443  835 2285]
 [4607 1091 2661]
 [3985  983 3367]]
training model: results/CHTR/W8/deepOF_L2/h30
Epoch 1/50
358/358 - 13s - loss: 3.3292 - accuracy30: 0.3500 - val_loss: 3.3104 - val_accuracy30: 0.3574 - 13s/epoch - 35ms/step
Epoch 2/50
358/358 - 11s - loss: 3.2823 - accuracy30: 0.3775 - val_loss: 3.2865 - val_accuracy30: 0.3808 - 11s/epoch - 30ms/step
Epoch 3/50
358/358 - 11s - loss: 3.2626 - accuracy30: 0.3874 - val_loss: 3.2739 - val_accuracy30: 0.3835 - 11s/epoch - 30ms/step
Epoch 4/50
358/358 - 11s - loss: 3.2477 - accuracy30: 0.3968 - val_loss: 3.2698 - val_accuracy30: 0.3865 - 11s/epoch - 30ms/step
Epoch 5/50
358/358 - 11s - loss: 3.2407 - accuracy30: 0.3998 - val_loss: 3.2651 - val_accuracy30: 0.3877 - 11s/epoch - 30ms/step
Epoch 6/50
358/358 - 10s - loss: 3.2300 - accuracy30: 0.4090 - val_loss: 3.2680 - val_accuracy30: 0.3911 - 10s/epoch - 29ms/step
Epoch 7/50
358/358 - 10s - loss: 3.2248 - accuracy30: 0.4092 - val_loss: 3.2621 - val_accuracy30: 0.3920 - 10s/epoch - 29ms/step
Epoch 8/50
358/358 - 11s - loss: 3.2184 - accuracy30: 0.4132 - val_loss: 3.2621 - val_accuracy30: 0.3928 - 11s/epoch - 30ms/step
Epoch 9/50
358/358 - 11s - loss: 3.2112 - accuracy30: 0.4185 - val_loss: 3.2659 - val_accuracy30: 0.3900 - 11s/epoch - 30ms/step
Epoch 10/50
358/358 - 11s - loss: 3.2047 - accuracy30: 0.4209 - val_loss: 3.2642 - val_accuracy30: 0.3917 - 11s/epoch - 29ms/step
Epoch 11/50
358/358 - 11s - loss: 3.1962 - accuracy30: 0.4253 - val_loss: 3.2684 - val_accuracy30: 0.3922 - 11s/epoch - 29ms/step
Epoch 12/50
358/358 - 11s - loss: 3.1907 - accuracy30: 0.4294 - val_loss: 3.2689 - val_accuracy30: 0.3914 - 11s/epoch - 29ms/step
Epoch 13/50
358/358 - 11s - loss: 3.1842 - accuracy30: 0.4320 - val_loss: 3.2648 - val_accuracy30: 0.3952 - 11s/epoch - 30ms/step
Epoch 14/50
358/358 - 11s - loss: 3.1782 - accuracy30: 0.4358 - val_loss: 3.2704 - val_accuracy30: 0.3897 - 11s/epoch - 30ms/step
Epoch 15/50
358/358 - 11s - loss: 3.1703 - accuracy30: 0.4389 - val_loss: 3.2785 - val_accuracy30: 0.3892 - 11s/epoch - 30ms/step
Epoch 16/50
358/358 - 10s - loss: 3.1626 - accuracy30: 0.4421 - val_loss: 3.2833 - val_accuracy30: 0.3879 - 10s/epoch - 29ms/step
Epoch 17/50
358/358 - 11s - loss: 3.1568 - accuracy30: 0.4429 - val_loss: 3.2873 - val_accuracy30: 0.3914 - 11s/epoch - 29ms/step
testing model: results/CHTR/W8/deepOF_L2/h30
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0922257
{'0': {'precision': 0.36843946815955214, 'recall': 0.7231394462788926, 'f1-score': 0.48816097392143726, 'support': 106299}, '1': {'precision': 0.3830137516947511, 'recall': 0.07440084277060838, 'f1-score': 0.12459832398714636, 'support': 106316}, '2': {'precision': 0.39913066322753216, 'recall': 0.3328652664495633, 'f1-score': 0.36299856099481415, 'support': 100413}, 'accuracy': 0.3776115874618245, 'macro avg': {'precision': 0.38352796102727843, 'recall': 0.3768018518330214, 'f1-score': 0.3252526196344659, 'support': 313028}, 'weighted avg': {'precision': 0.38323454878712954, 'recall': 0.3776115874618245, 'f1-score': 0.32453196929688266, 'support': 313028}}
[[76869  6265 23165]
 [71253  7910 27153]
 [60512  6477 33424]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0788261
{'0': {'precision': 0.39123768175866586, 'recall': 0.7238851168276433, 'f1-score': 0.5079460940558073, 'support': 31371}, '1': {'precision': 0.4033043221714117, 'recall': 0.09116372124041347, 'f1-score': 0.14871223041148793, 'support': 29990}, '2': {'precision': 0.4308490636985786, 'recall': 0.38122171945701355, 'f1-score': 0.40451897616946153, 'support': 30056}, 'accuracy': 0.4036557751840467, 'macro avg': {'precision': 0.40846368920955206, 'recall': 0.39875685250835674, 'f1-score': 0.3537257668789189, 'support': 91417}, 'weighted avg': {'precision': 0.4082196243028783, 'recall': 0.4036557751840467, 'f1-score': 0.35609218257451664, 'support': 91417}}
[[22709  1820  6842]
 [18962  2734  8294]
 [16373  2225 11458]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0858077
{'0': {'precision': 0.3873879767122392, 'recall': 0.6879646840148699, 'f1-score': 0.49566854990583803, 'support': 8608}, '1': {'precision': 0.37343656938653963, 'recall': 0.07480314960629922, 'f1-score': 0.12463969784315675, 'support': 8382}, '2': {'precision': 0.3991074659269087, 'recall': 0.4002661183016814, 'f1-score': 0.39968595240971133, 'support': 8267}, 'accuracy': 0.3903076374866374, 'macro avg': {'precision': 0.3866440040085625, 'recall': 0.3876779839742835, 'f1-score': 0.3399980667195687, 'support': 25257}, 'weighted avg': {'precision': 0.38659391253730385, 'recall': 0.3903076374866374, 'f1-score': 0.34111923797291355, 'support': 25257}}
[[5922  477 2209]
 [4982  627 2773]
 [4383  575 3309]]
training model: results/CHTR/W8/deepOF_L2/h50
Epoch 1/50
358/358 - 13s - loss: 3.3314 - accuracy50: 0.3487 - val_loss: 3.3051 - val_accuracy50: 0.3578 - 13s/epoch - 36ms/step
Epoch 2/50
358/358 - 11s - loss: 3.2851 - accuracy50: 0.3742 - val_loss: 3.2875 - val_accuracy50: 0.3721 - 11s/epoch - 30ms/step
Epoch 3/50
358/358 - 11s - loss: 3.2683 - accuracy50: 0.3824 - val_loss: 3.2723 - val_accuracy50: 0.3820 - 11s/epoch - 30ms/step
Epoch 4/50
358/358 - 11s - loss: 3.2557 - accuracy50: 0.3912 - val_loss: 3.2723 - val_accuracy50: 0.3834 - 11s/epoch - 29ms/step
Epoch 5/50
358/358 - 11s - loss: 3.2473 - accuracy50: 0.3973 - val_loss: 3.2671 - val_accuracy50: 0.3830 - 11s/epoch - 29ms/step
Epoch 6/50
358/358 - 11s - loss: 3.2375 - accuracy50: 0.4033 - val_loss: 3.2690 - val_accuracy50: 0.3820 - 11s/epoch - 29ms/step
Epoch 7/50
358/358 - 11s - loss: 3.2321 - accuracy50: 0.4058 - val_loss: 3.2671 - val_accuracy50: 0.3857 - 11s/epoch - 30ms/step
Epoch 8/50
358/358 - 11s - loss: 3.2276 - accuracy50: 0.4092 - val_loss: 3.2680 - val_accuracy50: 0.3831 - 11s/epoch - 30ms/step
Epoch 9/50
358/358 - 11s - loss: 3.2202 - accuracy50: 0.4122 - val_loss: 3.2686 - val_accuracy50: 0.3848 - 11s/epoch - 30ms/step
Epoch 10/50
358/358 - 11s - loss: 3.2143 - accuracy50: 0.4155 - val_loss: 3.2699 - val_accuracy50: 0.3852 - 11s/epoch - 30ms/step
Epoch 11/50
358/358 - 11s - loss: 3.2075 - accuracy50: 0.4195 - val_loss: 3.2733 - val_accuracy50: 0.3824 - 11s/epoch - 30ms/step
Epoch 12/50
358/358 - 10s - loss: 3.2001 - accuracy50: 0.4246 - val_loss: 3.2721 - val_accuracy50: 0.3828 - 10s/epoch - 29ms/step
Epoch 13/50
358/358 - 11s - loss: 3.1970 - accuracy50: 0.4256 - val_loss: 3.2747 - val_accuracy50: 0.3803 - 11s/epoch - 30ms/step
Epoch 14/50
358/358 - 11s - loss: 3.1887 - accuracy50: 0.4299 - val_loss: 3.2762 - val_accuracy50: 0.3813 - 11s/epoch - 30ms/step
Epoch 15/50
358/358 - 11s - loss: 3.1826 - accuracy50: 0.4322 - val_loss: 3.2787 - val_accuracy50: 0.3800 - 11s/epoch - 30ms/step
Epoch 16/50
358/358 - 11s - loss: 3.1734 - accuracy50: 0.4366 - val_loss: 3.2810 - val_accuracy50: 0.3835 - 11s/epoch - 29ms/step
Epoch 17/50
358/358 - 11s - loss: 3.1686 - accuracy50: 0.4387 - val_loss: 3.2872 - val_accuracy50: 0.3780 - 11s/epoch - 30ms/step
testing model: results/CHTR/W8/deepOF_L2/h50
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0941765
{'0': {'precision': 0.3688795321134915, 'recall': 0.650044481459749, 'f1-score': 0.4706692569408041, 'support': 105662}, '1': {'precision': 0.3694358129609524, 'recall': 0.09030345181009554, 'f1-score': 0.1451315199246987, 'support': 109276}, '2': {'precision': 0.37567670149223914, 'recall': 0.3834437761239678, 'f1-score': 0.3795205037132709, 'support': 98090}, 'accuracy': 0.37110098777106204, 'macro avg': {'precision': 0.37133068218889437, 'recall': 0.37459723646460413, 'f1-score': 0.33177376019292454, 'support': 313028}, 'weighted avg': {'precision': 0.37120367720673714, 'recall': 0.37110098777106204, 'f1-score': 0.32846394957449604, 'support': 313028}}
[[68685  8394 28583]
 [65485  9868 33923]
 [52029  8449 37612]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0806944
{'0': {'precision': 0.3922067237575259, 'recall': 0.6730411345697234, 'f1-score': 0.4956053303090445, 'support': 31166}, '1': {'precision': 0.3981440071556351, 'recall': 0.11750148485448426, 'f1-score': 0.18145222929936305, 'support': 30306}, '2': {'precision': 0.41681901279707495, 'recall': 0.40353982300884955, 'f1-score': 0.41007194244604317, 'support': 29945}, 'accuracy': 0.40059288753732897, 'macro avg': {'precision': 0.40238991457007867, 'recall': 0.3980274808110191, 'f1-score': 0.36237650068481697, 'support': 91417}, 'weighted avg': {'precision': 0.40223713720308185, 'recall': 0.40059288753732897, 'f1-score': 0.3634414966811965, 'support': 91417}}
[[20976  2410  7780]
 [17618  3561  9127]
 [14888  2973 12084]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0883292
{'0': {'precision': 0.38350785340314136, 'recall': 0.6185784658691063, 'f1-score': 0.473471586318341, 'support': 8526}, '1': {'precision': 0.3610046828437633, 'recall': 0.09929742388758782, 'f1-score': 0.15575351271925794, 'support': 8540}, '2': {'precision': 0.38794233289646135, 'recall': 0.4336466853863997, 'f1-score': 0.4095232605061394, 'support': 8191}, 'accuracy': 0.38302252840796613, 'macro avg': {'precision': 0.377484956381122, 'recall': 0.38384085838103127, 'f1-score': 0.3462494531812461, 'support': 25257}, 'weighted avg': {'precision': 0.3773371183575182, 'recall': 0.38302252840796613, 'f1-score': 0.34530461932844064, 'support': 25257}}
[[5274  700 2552]
 [4640  848 3052]
 [3838  801 3552]]
training model: results/CHTR/W8/deepOF_L2/h100
Epoch 1/50
358/358 - 13s - loss: 3.3393 - accuracy100: 0.3421 - val_loss: 3.3073 - val_accuracy100: 0.3517 - 13s/epoch - 35ms/step
Epoch 2/50
358/358 - 11s - loss: 3.2970 - accuracy100: 0.3621 - val_loss: 3.2938 - val_accuracy100: 0.3613 - 11s/epoch - 30ms/step
Epoch 3/50
358/358 - 11s - loss: 3.2815 - accuracy100: 0.3721 - val_loss: 3.2872 - val_accuracy100: 0.3650 - 11s/epoch - 30ms/step
Epoch 4/50
358/358 - 10s - loss: 3.2729 - accuracy100: 0.3776 - val_loss: 3.2878 - val_accuracy100: 0.3630 - 10s/epoch - 29ms/step
Epoch 5/50
358/358 - 11s - loss: 3.2647 - accuracy100: 0.3851 - val_loss: 3.2840 - val_accuracy100: 0.3662 - 11s/epoch - 30ms/step
Epoch 6/50
358/358 - 11s - loss: 3.2573 - accuracy100: 0.3899 - val_loss: 3.2851 - val_accuracy100: 0.3674 - 11s/epoch - 30ms/step
Epoch 7/50
358/358 - 11s - loss: 3.2527 - accuracy100: 0.3920 - val_loss: 3.2869 - val_accuracy100: 0.3658 - 11s/epoch - 30ms/step
Epoch 8/50
358/358 - 11s - loss: 3.2471 - accuracy100: 0.3980 - val_loss: 3.2864 - val_accuracy100: 0.3697 - 11s/epoch - 30ms/step
Epoch 9/50
358/358 - 11s - loss: 3.2403 - accuracy100: 0.4009 - val_loss: 3.2865 - val_accuracy100: 0.3673 - 11s/epoch - 30ms/step
Epoch 10/50
358/358 - 11s - loss: 3.2341 - accuracy100: 0.4046 - val_loss: 3.2896 - val_accuracy100: 0.3693 - 11s/epoch - 30ms/step
Epoch 11/50
358/358 - 11s - loss: 3.2278 - accuracy100: 0.4088 - val_loss: 3.2934 - val_accuracy100: 0.3652 - 11s/epoch - 30ms/step
Epoch 12/50
358/358 - 11s - loss: 3.2229 - accuracy100: 0.4122 - val_loss: 3.2951 - val_accuracy100: 0.3637 - 11s/epoch - 30ms/step
Epoch 13/50
358/358 - 11s - loss: 3.2184 - accuracy100: 0.4133 - val_loss: 3.2956 - val_accuracy100: 0.3659 - 11s/epoch - 30ms/step
Epoch 14/50
358/358 - 11s - loss: 3.2103 - accuracy100: 0.4202 - val_loss: 3.2999 - val_accuracy100: 0.3673 - 11s/epoch - 30ms/step
Epoch 15/50
358/358 - 11s - loss: 3.2048 - accuracy100: 0.4212 - val_loss: 3.3040 - val_accuracy100: 0.3658 - 11s/epoch - 30ms/step
testing model: results/CHTR/W8/deepOF_L2/h100
Evaluating performance on  test set...
1223/1223 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0965534
{'0': {'precision': 0.3639212019287803, 'recall': 0.5027474646203679, 'f1-score': 0.42221547553990324, 'support': 103732}, '1': {'precision': 0.36182007378677516, 'recall': 0.16907136289695168, 'f1-score': 0.2304554519874433, 'support': 113112}, '2': {'precision': 0.34573457688029435, 'recall': 0.4200906595691591, 'f1-score': 0.37930289973433967, 'support': 96184}, 'accuracy': 0.35677639061042465, 'macro avg': {'precision': 0.35715861753194994, 'recall': 0.36396982902882624, 'f1-score': 0.34399127575389543, 'support': 313028}, 'weighted avg': {'precision': 0.3575737660761983, 'recall': 0.35677639061042465, 'f1-score': 0.33973766852152737, 'support': 313028}}
[[52151 17616 33965]
 [51489 19124 42499]
 [39663 16115 40406]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0879799
{'0': {'precision': 0.38470322350422265, 'recall': 0.5239607296763115, 'f1-score': 0.44366100578891055, 'support': 30863}, '1': {'precision': 0.36630882536512294, 'recall': 0.19430557854659825, 'f1-score': 0.2539208687563545, 'support': 30205}, '2': {'precision': 0.39211630695443644, 'recall': 0.4310191439586148, 'f1-score': 0.410648417021143, 'support': 30349}, 'accuracy': 0.3841845608584836, 'macro avg': {'precision': 0.38104278527459395, 'recall': 0.38309515072717487, 'f1-score': 0.36941009718880274, 'support': 91417}, 'weighted avg': {'precision': 0.3810865753298025, 'recall': 0.3841845608584836, 'f1-score': 0.37000949791202403, 'support': 91417}}
[[16171  5060  9632]
 [13689  5869 10647]
 [12175  5093 13081]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.094978
{'0': {'precision': 0.3779047619047619, 'recall': 0.46720828917932417, 'f1-score': 0.41783815089769916, 'support': 8493}, '1': {'precision': 0.36002753556677375, 'recall': 0.18111508715225672, 'f1-score': 0.24099531525996468, 'support': 8663}, '2': {'precision': 0.35599576882392536, 'recall': 0.45698061967658316, 'f1-score': 0.40021621621621617, 'support': 8101}, 'accuracy': 0.36579958031436827, 'macro avg': {'precision': 0.3646426887651537, 'recall': 0.3684346653360547, 'f1-score': 0.35301656079129334, 'support': 25257}, 'weighted avg': {'precision': 0.3647458291449786, 'recall': 0.36579958031436827, 'f1-score': 0.35153000749252883, 'support': 25257}}
[[3968 1422 3103]
 [3500 1569 3594]
 [3032 1367 3702]]
training model: results/CHTR/W8/deepOF_L2/h200
Epoch 1/50
358/358 - 13s - loss: 3.3483 - accuracy200: 0.3345 - val_loss: 3.3128 - val_accuracy200: 0.3405 - 13s/epoch - 35ms/step
Epoch 2/50
358/358 - 11s - loss: 3.3135 - accuracy200: 0.3471 - val_loss: 3.3051 - val_accuracy200: 0.3443 - 11s/epoch - 30ms/step
Epoch 3/50
358/358 - 11s - loss: 3.2989 - accuracy200: 0.3575 - val_loss: 3.3010 - val_accuracy200: 0.3471 - 11s/epoch - 30ms/step
Epoch 4/50
358/358 - 16s - loss: 3.2914 - accuracy200: 0.3623 - val_loss: 3.2983 - val_accuracy200: 0.3505 - 16s/epoch - 45ms/step
Epoch 5/50
358/358 - 11s - loss: 3.2849 - accuracy200: 0.3687 - val_loss: 3.2975 - val_accuracy200: 0.3531 - 11s/epoch - 31ms/step
Epoch 6/50
358/358 - 11s - loss: 3.2784 - accuracy200: 0.3722 - val_loss: 3.2960 - val_accuracy200: 0.3536 - 11s/epoch - 30ms/step
Epoch 7/50
358/358 - 11s - loss: 3.2739 - accuracy200: 0.3769 - val_loss: 3.2955 - val_accuracy200: 0.3534 - 11s/epoch - 30ms/step
Epoch 8/50
358/358 - 11s - loss: 3.2680 - accuracy200: 0.3810 - val_loss: 3.2989 - val_accuracy200: 0.3555 - 11s/epoch - 29ms/step
Epoch 9/50
358/358 - 11s - loss: 3.2620 - accuracy200: 0.3859 - val_loss: 3.2996 - val_accuracy200: 0.3553 - 11s/epoch - 29ms/step
Epoch 10/50
358/358 - 11s - loss: 3.2575 - accuracy200: 0.3892 - val_loss: 3.2989 - val_accuracy200: 0.3521 - 11s/epoch - 29ms/step
Epoch 11/50
358/358 - 11s - loss: 3.2535 - accuracy200: 0.3927 - val_loss: 3.2992 - val_accuracy200: 0.3496 - 11s/epoch - 29ms/step
Epoch 12/50
358/358 - 11s - loss: 3.2466 - accuracy200: 0.3964 - val_loss: 3.3042 - val_accuracy200: 0.3503 - 11s/epoch - 30ms/step
Epoch 13/50
358/358 - 10s - loss: 3.2416 - accuracy200: 0.3991 - val_loss: 3.3071 - val_accuracy200: 0.3501 - 10s/epoch - 29ms/step
Epoch 14/50
358/358 - 11s - loss: 3.2358 - accuracy200: 0.4037 - val_loss: 3.3110 - val_accuracy200: 0.3489 - 11s/epoch - 29ms/step
Epoch 15/50
358/358 - 11s - loss: 3.2310 - accuracy200: 0.4069 - val_loss: 3.3152 - val_accuracy200: 0.3490 - 11s/epoch - 29ms/step
Epoch 16/50
358/358 - 11s - loss: 3.2237 - accuracy200: 0.4097 - val_loss: 3.3176 - val_accuracy200: 0.3505 - 11s/epoch - 30ms/step
Epoch 17/50
358/358 - 11s - loss: 3.2160 - accuracy200: 0.4156 - val_loss: 3.3244 - val_accuracy200: 0.3508 - 11s/epoch - 29ms/step
testing model: results/CHTR/W8/deepOF_L2/h200
Evaluating performance on  test set...
1223/1223 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0993899
{'0': {'precision': 0.3583216503104346, 'recall': 0.34920510993783366, 'f1-score': 0.35370464643868593, 'support': 102467}, '1': {'precision': 0.35948782621076825, 'recall': 0.3118009244557355, 'f1-score': 0.3339505881241438, 'support': 113364}, '2': {'precision': 0.327362811514951, 'recall': 0.3867917734086443, 'f1-score': 0.35460457745980695, 'support': 97197}, 'accuracy': 0.3473299513142594, 'macro avg': {'precision': 0.34839076267871794, 'recall': 0.3492659359340711, 'f1-score': 0.3474199373408789, 'support': 313028}, 'weighted avg': {'precision': 0.3491310862406415, 'recall': 0.3473299513142594, 'f1-score': 0.3468300905800731, 'support': 313028}}
[[35782 32412 34273]
 [35043 35347 42974]
 [29035 30567 37595]]
Evaluating performance on  train set...
358/358 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0920733
{'0': {'precision': 0.36686507284027753, 'recall': 0.3697345308719716, 'f1-score': 0.36829421280248265, 'support': 30173}, '1': {'precision': 0.3619277436019441, 'recall': 0.35126665787043143, 'f1-score': 0.35651751786939856, 'support': 30316}, '2': {'precision': 0.3843280037992718, 'recall': 0.39249224004138644, 'f1-score': 0.38836721961831944, 'support': 30928}, 'accuracy': 0.37130949385781636, 'macro avg': {'precision': 0.3710402734138311, 'recall': 0.37116447626126314, 'f1-score': 0.3710596500967336, 'support': 91417}, 'weighted avg': {'precision': 0.3711357605188324, 'recall': 0.37130949385781636, 'f1-score': 0.3711798431689224, 'support': 91417}}
[[11156  9419  9598]
 [ 9819 10649  9848]
 [ 9434  9355 12139]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0975925
{'0': {'precision': 0.3673469387755102, 'recall': 0.32514757969303426, 'f1-score': 0.3449614830588088, 'support': 8470}, '1': {'precision': 0.3557729437508045, 'recall': 0.3183598249251325, 'f1-score': 0.33602820497234215, 'support': 8682}, '2': {'precision': 0.3487138424582124, 'recall': 0.4298581122763726, 'f1-score': 0.3850574712643678, 'support': 8105}, 'accuracy': 0.35641604307716673, 'macro avg': {'precision': 0.3572779083281757, 'recall': 0.35778850563151315, 'f1-score': 0.35534905309850623, 'support': 25257}, 'weighted avg': {'precision': 0.3573890391652559, 'recall': 0.35641604307716673, 'f1-score': 0.3547575500524879, 'support': 25257}}
[[2754 2631 3085]
 [2496 2764 3422]
 [2247 2374 3484]]
training model: results/CHTR/W8/deepOF_L2/h300
Epoch 1/50
358/358 - 13s - loss: 3.3505 - accuracy300: 0.3334 - val_loss: 3.3211 - val_accuracy300: 0.3403 - 13s/epoch - 37ms/step
Epoch 2/50
358/358 - 11s - loss: 3.3150 - accuracy300: 0.3487 - val_loss: 3.3179 - val_accuracy300: 0.3392 - 11s/epoch - 30ms/step
Epoch 3/50
358/358 - 11s - loss: 3.3008 - accuracy300: 0.3575 - val_loss: 3.3131 - val_accuracy300: 0.3365 - 11s/epoch - 30ms/step
Epoch 4/50
358/358 - 11s - loss: 3.2921 - accuracy300: 0.3617 - val_loss: 3.3099 - val_accuracy300: 0.3408 - 11s/epoch - 30ms/step
Epoch 5/50
358/358 - 11s - loss: 3.2855 - accuracy300: 0.3673 - val_loss: 3.3091 - val_accuracy300: 0.3424 - 11s/epoch - 30ms/step
Epoch 6/50
358/358 - 11s - loss: 3.2788 - accuracy300: 0.3732 - val_loss: 3.3075 - val_accuracy300: 0.3439 - 11s/epoch - 30ms/step
Epoch 7/50
358/358 - 11s - loss: 3.2739 - accuracy300: 0.3785 - val_loss: 3.3060 - val_accuracy300: 0.3448 - 11s/epoch - 30ms/step
Epoch 8/50
358/358 - 11s - loss: 3.2705 - accuracy300: 0.3788 - val_loss: 3.3086 - val_accuracy300: 0.3413 - 11s/epoch - 29ms/step
Epoch 9/50
358/358 - 11s - loss: 3.2638 - accuracy300: 0.3831 - val_loss: 3.3098 - val_accuracy300: 0.3437 - 11s/epoch - 29ms/step
Epoch 10/50
358/358 - 11s - loss: 3.2590 - accuracy300: 0.3887 - val_loss: 3.3136 - val_accuracy300: 0.3420 - 11s/epoch - 29ms/step
Epoch 11/50
358/358 - 11s - loss: 3.2556 - accuracy300: 0.3917 - val_loss: 3.3197 - val_accuracy300: 0.3399 - 11s/epoch - 30ms/step
Epoch 12/50
358/358 - 11s - loss: 3.2477 - accuracy300: 0.3962 - val_loss: 3.3188 - val_accuracy300: 0.3413 - 11s/epoch - 30ms/step
Epoch 13/50
358/358 - 11s - loss: 3.2432 - accuracy300: 0.3996 - val_loss: 3.3311 - val_accuracy300: 0.3378 - 11s/epoch - 29ms/step
Epoch 14/50
358/358 - 11s - loss: 3.2372 - accuracy300: 0.4030 - val_loss: 3.3306 - val_accuracy300: 0.3422 - 11s/epoch - 29ms/step
Epoch 15/50
358/358 - 11s - loss: 3.2310 - accuracy300: 0.4062 - val_loss: 3.3363 - val_accuracy300: 0.3381 - 11s/epoch - 29ms/step
Epoch 16/50
358/358 - 11s - loss: 3.2245 - accuracy300: 0.4105 - val_loss: 3.3365 - val_accuracy300: 0.3436 - 11s/epoch - 30ms/step
Epoch 17/50
358/358 - 11s - loss: 3.2173 - accuracy300: 0.4139 - val_loss: 3.3391 - val_accuracy300: 0.3378 - 11s/epoch - 30ms/step
testing model: results/CHTR/W8/deepOF_L2/h300
Evaluating performance on  test set...
1223/1223 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0994234
{'0': {'precision': 0.3532898963017344, 'recall': 0.1905219086833015, 'f1-score': 0.24754690775344332, 'support': 101033}, '1': {'precision': 0.3638142803586293, 'recall': 0.5105851718418377, 'f1-score': 0.4248817320000742, 'support': 112138}, '2': {'precision': 0.3325030148468853, 'recall': 0.33686171224851535, 'f1-score': 0.3346681722986922, 'support': 99857}, 'accuracy': 0.3518630921195548, 'macro avg': {'precision': 0.3498690638357496, 'recall': 0.34598959759121817, 'f1-score': 0.3356989373507366, 'support': 313028}, 'weighted avg': {'precision': 0.3504290268521491, 'recall': 0.3518630921195548, 'f1-score': 0.33886666392561837, 'support': 313028}}
[[19249 50787 30997]
 [18351 57256 36531]
 [16885 49334 33638]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0925208
{'0': {'precision': 0.3798362678030728, 'recall': 0.22601094354731083, 'f1-score': 0.28339538970003764, 'support': 29972}, '1': {'precision': 0.35347411748915036, 'recall': 0.523038728897716, 'f1-score': 0.42185497650576675, 'support': 30210}, '2': {'precision': 0.3899103216647623, 'recall': 0.360525052024972, 'f1-score': 0.37464235810765856, 'support': 31235}, 'accuracy': 0.3701280943369395, 'macro avg': {'precision': 0.37440690231899515, 'recall': 0.36985824148999963, 'f1-score': 0.359964241437821, 'support': 91417}, 'weighted avg': {'precision': 0.37456659707865914, 'recall': 0.3701280943369395, 'f1-score': 0.36032816123720374, 'support': 91417}}
[[ 6774 14494  8704]
 [ 5493 15801  8916]
 [ 5567 14407 11261]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.100674
{'0': {'precision': 0.36629367435487553, 'recall': 0.19018259426132322, 'f1-score': 0.2503707172403028, 'support': 8434}, '1': {'precision': 0.3504806881430258, 'recall': 0.46870418405323105, 'f1-score': 0.4010615199034982, 'support': 8867}, '2': {'precision': 0.33348115299334813, 'recall': 0.3780794369029663, 'f1-score': 0.354382657869934, 'support': 7956}, 'accuracy': 0.3471512847923348, 'macro avg': {'precision': 0.3500851718304165, 'recall': 0.34565540507250686, 'f1-score': 0.335271631671245, 'support': 25257}, 'weighted avg': {'precision': 0.350406190936703, 'recall': 0.3471512847923348, 'f1-score': 0.33603783316317165, 'support': 25257}}
[[1604 4030 2800]
 [1499 4156 3212]
 [1276 3672 3008]]
training model: results/CHTR/W8/deepOF_L2/h500
Epoch 1/50
358/358 - 13s - loss: 3.3535 - accuracy500: 0.3320 - val_loss: 3.3318 - val_accuracy500: 0.3450 - 13s/epoch - 36ms/step
Epoch 2/50
358/358 - 11s - loss: 3.3191 - accuracy500: 0.3444 - val_loss: 3.3195 - val_accuracy500: 0.3493 - 11s/epoch - 30ms/step
Epoch 3/50
358/358 - 11s - loss: 3.3057 - accuracy500: 0.3509 - val_loss: 3.3140 - val_accuracy500: 0.3516 - 11s/epoch - 30ms/step
Epoch 4/50
358/358 - 11s - loss: 3.2962 - accuracy500: 0.3569 - val_loss: 3.3108 - val_accuracy500: 0.3552 - 11s/epoch - 30ms/step
Epoch 5/50
358/358 - 11s - loss: 3.2904 - accuracy500: 0.3629 - val_loss: 3.3097 - val_accuracy500: 0.3517 - 11s/epoch - 30ms/step
Epoch 6/50
358/358 - 11s - loss: 3.2856 - accuracy500: 0.3663 - val_loss: 3.3068 - val_accuracy500: 0.3527 - 11s/epoch - 30ms/step
Epoch 7/50
358/358 - 11s - loss: 3.2796 - accuracy500: 0.3688 - val_loss: 3.3071 - val_accuracy500: 0.3528 - 11s/epoch - 30ms/step
Epoch 8/50
358/358 - 11s - loss: 3.2751 - accuracy500: 0.3747 - val_loss: 3.3083 - val_accuracy500: 0.3527 - 11s/epoch - 29ms/step
Epoch 9/50
358/358 - 11s - loss: 3.2687 - accuracy500: 0.3814 - val_loss: 3.3090 - val_accuracy500: 0.3507 - 11s/epoch - 29ms/step
Epoch 10/50
358/358 - 11s - loss: 3.2639 - accuracy500: 0.3844 - val_loss: 3.3107 - val_accuracy500: 0.3556 - 11s/epoch - 30ms/step
Epoch 11/50
358/358 - 11s - loss: 3.2617 - accuracy500: 0.3858 - val_loss: 3.3119 - val_accuracy500: 0.3553 - 11s/epoch - 30ms/step
Epoch 12/50
358/358 - 11s - loss: 3.2552 - accuracy500: 0.3898 - val_loss: 3.3154 - val_accuracy500: 0.3542 - 11s/epoch - 30ms/step
Epoch 13/50
358/358 - 11s - loss: 3.2499 - accuracy500: 0.3938 - val_loss: 3.3230 - val_accuracy500: 0.3544 - 11s/epoch - 30ms/step
Epoch 14/50
358/358 - 11s - loss: 3.2458 - accuracy500: 0.3957 - val_loss: 3.3265 - val_accuracy500: 0.3548 - 11s/epoch - 29ms/step
Epoch 15/50
358/358 - 11s - loss: 3.2390 - accuracy500: 0.4031 - val_loss: 3.3313 - val_accuracy500: 0.3498 - 11s/epoch - 30ms/step
Epoch 16/50
358/358 - 11s - loss: 3.2312 - accuracy500: 0.4066 - val_loss: 3.3337 - val_accuracy500: 0.3527 - 11s/epoch - 30ms/step
testing model: results/CHTR/W8/deepOF_L2/h500
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018288
{'0': {'precision': 0.3563343788354016, 'recall': 0.0777069558580081, 'f1-score': 0.12758996728462377, 'support': 100879}, '1': {'precision': 0.3533410597391651, 'recall': 0.7000980249782167, 'f1-score': 0.4696491361595251, 'support': 110176}, '2': {'precision': 0.3305926027773958, 'recall': 0.23578790464142468, 'f1-score': 0.2752557197071602, 'support': 101973}, 'accuracy': 0.34826596981739655, 'macro avg': {'precision': 0.3467560137839875, 'recall': 0.3378642951592165, 'f1-score': 0.290831607717103, 'support': 313028}, 'weighted avg': {'precision': 0.34689510166304016, 'recall': 0.34826596981739655, 'f1-score': 0.29608809129188324, 'support': 313028}}
[[ 7839 69987 23053]
 [ 7409 77134 25633]
 [ 6751 71178 24044]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0968355
{'0': {'precision': 0.3758921490880254, 'recall': 0.09525404427772381, 'f1-score': 0.15199209042567402, 'support': 29857}, '1': {'precision': 0.34312958435207824, 'recall': 0.6954640060788265, 'f1-score': 0.459533502876041, 'support': 30269}, '2': {'precision': 0.3805608639616017, 'recall': 0.2736569620657697, 'f1-score': 0.3183744794765021, 'support': 31291}, 'accuracy': 0.35505431156130696, 'macro avg': {'precision': 0.3665275324672351, 'recall': 0.35479167080744006, 'f1-score': 0.3099666909260724, 'support': 91417}, 'weighted avg': {'precision': 0.36664221401158115, 'recall': 0.35505431156130696, 'f1-score': 0.31077264928507237, 'support': 91417}}
[[ 2844 20075  6938]
 [ 2218 21051  7000]
 [ 2504 20224  8563]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1006103
{'0': {'precision': 0.34016139044072, 'recall': 0.06756256935026507, 'f1-score': 0.11273400534869368, 'support': 8111}, '1': {'precision': 0.36592818945760125, 'recall': 0.668491680085883, 'f1-score': 0.4729606562357587, 'support': 9315}, '2': {'precision': 0.3167898627243928, 'recall': 0.2681649853147746, 'f1-score': 0.2904564315352697, 'support': 7831}, 'accuracy': 0.35138773409351864, 'macro avg': {'precision': 0.3409598142075714, 'recall': 0.3347397449169742, 'f1-score': 0.29205036437324067, 'support': 25257}, 'weighted avg': {'precision': 0.34241800442083203, 'recall': 0.35138773409351864, 'f1-score': 0.30069201985873395, 'support': 25257}}
[[ 548 5541 2022]
 [ 581 6227 2507]
 [ 482 5249 2100]]
training model: results/CHTR/W8/deepOF_L2/h1000
Epoch 1/50
358/358 - 13s - loss: 3.3560 - accuracy1000: 0.3326 - val_loss: 3.3466 - val_accuracy1000: 0.3256 - 13s/epoch - 35ms/step
Epoch 2/50
358/358 - 11s - loss: 3.3237 - accuracy1000: 0.3419 - val_loss: 3.3339 - val_accuracy1000: 0.3245 - 11s/epoch - 29ms/step
Epoch 3/50
358/358 - 11s - loss: 3.3092 - accuracy1000: 0.3476 - val_loss: 3.3233 - val_accuracy1000: 0.3291 - 11s/epoch - 30ms/step
Epoch 4/50
358/358 - 11s - loss: 3.2991 - accuracy1000: 0.3529 - val_loss: 3.3224 - val_accuracy1000: 0.3308 - 11s/epoch - 30ms/step
Epoch 5/50
358/358 - 11s - loss: 3.2938 - accuracy1000: 0.3568 - val_loss: 3.3188 - val_accuracy1000: 0.3280 - 11s/epoch - 30ms/step
Epoch 6/50
358/358 - 11s - loss: 3.2887 - accuracy1000: 0.3613 - val_loss: 3.3172 - val_accuracy1000: 0.3272 - 11s/epoch - 29ms/step
Epoch 7/50
358/358 - 11s - loss: 3.2857 - accuracy1000: 0.3616 - val_loss: 3.3172 - val_accuracy1000: 0.3290 - 11s/epoch - 29ms/step
Epoch 8/50
358/358 - 11s - loss: 3.2804 - accuracy1000: 0.3681 - val_loss: 3.3178 - val_accuracy1000: 0.3322 - 11s/epoch - 30ms/step
Epoch 9/50
358/358 - 11s - loss: 3.2750 - accuracy1000: 0.3740 - val_loss: 3.3183 - val_accuracy1000: 0.3297 - 11s/epoch - 30ms/step
Epoch 10/50
358/358 - 11s - loss: 3.2711 - accuracy1000: 0.3770 - val_loss: 3.3184 - val_accuracy1000: 0.3299 - 11s/epoch - 29ms/step
Epoch 11/50
358/358 - 11s - loss: 3.2657 - accuracy1000: 0.3783 - val_loss: 3.3190 - val_accuracy1000: 0.3336 - 11s/epoch - 29ms/step
Epoch 12/50
358/358 - 11s - loss: 3.2636 - accuracy1000: 0.3839 - val_loss: 3.3190 - val_accuracy1000: 0.3361 - 11s/epoch - 30ms/step
Epoch 13/50
358/358 - 11s - loss: 3.2558 - accuracy1000: 0.3878 - val_loss: 3.3248 - val_accuracy1000: 0.3339 - 11s/epoch - 30ms/step
Epoch 14/50
358/358 - 11s - loss: 3.2512 - accuracy1000: 0.3921 - val_loss: 3.3238 - val_accuracy1000: 0.3373 - 11s/epoch - 30ms/step
Epoch 15/50
358/358 - 11s - loss: 3.2464 - accuracy1000: 0.3953 - val_loss: 3.3292 - val_accuracy1000: 0.3345 - 11s/epoch - 30ms/step
Epoch 16/50
358/358 - 11s - loss: 3.2401 - accuracy1000: 0.3983 - val_loss: 3.3264 - val_accuracy1000: 0.3359 - 11s/epoch - 30ms/step
testing model: results/CHTR/W8/deepOF_L2/h1000
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1023142
{'0': {'precision': 0.323700639338097, 'recall': 0.21905731446604906, 'f1-score': 0.2612913997753559, 'support': 98230}, '1': {'precision': 0.35521604818591906, 'recall': 0.24687387711103126, 'f1-score': 0.29129722768394223, 'support': 111320}, '2': {'precision': 0.3325511567150946, 'recall': 0.5437194379481629, 'f1-score': 0.4126910776633512, 'support': 103478}, 'accuracy': 0.3362734324086024, 'macro avg': {'precision': 0.33715594807970356, 'recall': 0.3365502098417477, 'f1-score': 0.3217599017075498, 'support': 313028}, 'weighted avg': {'precision': 0.33783397293789164, 'recall': 0.3362734324086024, 'f1-score': 0.3220105195706388, 'support': 313028}}
[[21518 24284 52428]
 [23343 27482 60495]
 [21614 25601 56263]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.094349
{'0': {'precision': 0.3667193635575501, 'recall': 0.24108220463993563, 'f1-score': 0.2909157109047879, 'support': 29828}, '1': {'precision': 0.36204633041121415, 'recall': 0.2825742050637932, 'f1-score': 0.31741140215716485, 'support': 30254}, '2': {'precision': 0.3620085071065463, 'recall': 0.5567895324716771, 'f1-score': 0.4387526719476927, 'support': 31335}, 'accuracy': 0.3630287583272258, 'macro avg': {'precision': 0.36359140035843684, 'recall': 0.3601486473918019, 'f1-score': 0.34902659500321515, 'support': 91417}, 'weighted avg': {'precision': 0.3635581065517257, 'recall': 0.3630287583272258, 'f1-score': 0.3503583946225738, 'support': 91417}}
[[ 7191  7402 15235]
 [ 6192  8549 15513]
 [ 6226  7662 17447]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030936
{'0': {'precision': 0.3400974025974026, 'recall': 0.20642936322207167, 'f1-score': 0.25691729899593774, 'support': 8119}, '1': {'precision': 0.36124513618677045, 'recall': 0.2473622508792497, 'f1-score': 0.2936487854251012, 'support': 9383}, '2': {'precision': 0.3135069044879171, 'recall': 0.5620889748549323, 'f1-score': 0.40251165797128213, 'support': 7755}, 'accuracy': 0.3308389753335709, 'macro avg': {'precision': 0.3382831477573634, 'recall': 0.3386268629854179, 'f1-score': 0.3176925807974404, 'support': 25257}, 'weighted avg': {'precision': 0.3397893640904531, 'recall': 0.3308389753335709, 'f1-score': 0.3152668967715499, 'support': 25257}}
[[1676 2099 4344]
 [1861 2321 5201]
 [1391 2005 4359]]
training model: results/CHTR/W8/deepVOL_L2/h10
Epoch 1/50
358/358 - 19s - loss: 3.3305 - accuracy10: 0.3503 - val_loss: 3.3798 - val_accuracy10: 0.3321 - 19s/epoch - 53ms/step
Epoch 2/50
358/358 - 10s - loss: 3.2986 - accuracy10: 0.3600 - val_loss: 3.3297 - val_accuracy10: 0.3512 - 10s/epoch - 28ms/step
Epoch 3/50
358/358 - 10s - loss: 3.2854 - accuracy10: 0.3685 - val_loss: 3.3141 - val_accuracy10: 0.3482 - 10s/epoch - 28ms/step
Epoch 4/50
358/358 - 10s - loss: 3.2824 - accuracy10: 0.3663 - val_loss: 3.3096 - val_accuracy10: 0.3571 - 10s/epoch - 28ms/step
Epoch 5/50
358/358 - 10s - loss: 3.2748 - accuracy10: 0.3740 - val_loss: 3.3003 - val_accuracy10: 0.3640 - 10s/epoch - 28ms/step
Epoch 6/50
358/358 - 10s - loss: 3.2682 - accuracy10: 0.3787 - val_loss: 3.2919 - val_accuracy10: 0.3627 - 10s/epoch - 28ms/step
Epoch 7/50
358/358 - 11s - loss: 3.2643 - accuracy10: 0.3826 - val_loss: 3.2901 - val_accuracy10: 0.3619 - 11s/epoch - 31ms/step
Epoch 8/50
358/358 - 10s - loss: 3.2595 - accuracy10: 0.3876 - val_loss: 3.2826 - val_accuracy10: 0.3665 - 10s/epoch - 29ms/step
Epoch 9/50
358/358 - 10s - loss: 3.2543 - accuracy10: 0.3890 - val_loss: 3.2920 - val_accuracy10: 0.3677 - 10s/epoch - 28ms/step
Epoch 10/50
358/358 - 10s - loss: 3.2527 - accuracy10: 0.3900 - val_loss: 3.2955 - val_accuracy10: 0.3711 - 10s/epoch - 28ms/step
Epoch 11/50
358/358 - 10s - loss: 3.2487 - accuracy10: 0.3922 - val_loss: 3.2901 - val_accuracy10: 0.3760 - 10s/epoch - 28ms/step
Epoch 12/50
358/358 - 10s - loss: 3.2440 - accuracy10: 0.3954 - val_loss: 3.2886 - val_accuracy10: 0.3701 - 10s/epoch - 28ms/step
Epoch 13/50
358/358 - 10s - loss: 3.2428 - accuracy10: 0.3959 - val_loss: 3.2993 - val_accuracy10: 0.3733 - 10s/epoch - 28ms/step
Epoch 14/50
358/358 - 10s - loss: 3.2390 - accuracy10: 0.3969 - val_loss: 3.2884 - val_accuracy10: 0.3755 - 10s/epoch - 28ms/step
Epoch 15/50
358/358 - 10s - loss: 3.2343 - accuracy10: 0.4009 - val_loss: 3.3082 - val_accuracy10: 0.3739 - 10s/epoch - 28ms/step
Epoch 16/50
358/358 - 10s - loss: 3.2345 - accuracy10: 0.4005 - val_loss: 3.2896 - val_accuracy10: 0.3773 - 10s/epoch - 28ms/step
Epoch 17/50
358/358 - 10s - loss: 3.2292 - accuracy10: 0.4022 - val_loss: 3.2886 - val_accuracy10: 0.3743 - 10s/epoch - 28ms/step
Epoch 18/50
358/358 - 10s - loss: 3.2259 - accuracy10: 0.4062 - val_loss: 3.2927 - val_accuracy10: 0.3734 - 10s/epoch - 28ms/step
testing model: results/CHTR/W8/deepVOL_L2/h10
Evaluating performance on  test set...
1223/1223 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0928171
{'0': {'precision': 0.3655878467635403, 'recall': 0.27024519808216235, 'f1-score': 0.31076824605433817, 'support': 102407}, '1': {'precision': 0.37201559245307775, 'recall': 0.6270099425928144, 'f1-score': 0.46696999643141457, 'support': 108523}, '2': {'precision': 0.38837645156548584, 'recall': 0.20701644417891737, 'f1-score': 0.2700748113743955, 'support': 102103}, 'accuracy': 0.37330568981545076, 'macro avg': {'precision': 0.37532663026070123, 'recall': 0.36809052828463135, 'f1-score': 0.3492710179533827, 'support': 313033}, 'weighted avg': {'precision': 0.3752492663632589, 'recall': 0.37330568981545076, 'f1-score': 0.3516475169141046, 'support': 313033}}
[[27675 58049 16683]
 [23874 68045 16604]
 [24151 56815 21137]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0888
{'0': {'precision': 0.4114830124004436, 'recall': 0.25855188141391106, 'f1-score': 0.31756467613304806, 'support': 31572}, '1': {'precision': 0.3623665337220324, 'recall': 0.6728099887095703, 'f1-score': 0.4710381624373743, 'support': 30114}, '2': {'precision': 0.40675261679857033, 'recall': 0.21434096794807117, 'f1-score': 0.28074271491817365, 'support': 29733}, 'accuracy': 0.38063203491615527, 'macro avg': {'precision': 0.39353405430701544, 'recall': 0.3819009460238509, 'f1-score': 0.356448517829532, 'support': 91419}, 'weighted avg': {'precision': 0.39376522407031345, 'recall': 0.38063203491615527, 'f1-score': 0.3561438904513694, 'support': 91419}}
[[ 8163 18456  4953]
 [ 5511 20261  4342]
 [ 6164 17196  6373]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0934582
{'0': {'precision': 0.3972997299729973, 'recall': 0.25843091334894613, 'f1-score': 0.3131606952820149, 'support': 8540}, '1': {'precision': 0.34806629834254144, 'recall': 0.6490862259291058, 'f1-score': 0.453140386179732, 'support': 8153}, '2': {'precision': 0.4078684152033785, 'recall': 0.21424401634559254, 'f1-score': 0.28092467850581754, 'support': 8565}, 'accuracy': 0.3695462823659831, 'macro avg': {'precision': 0.3844114811729724, 'recall': 0.37392038520788146, 'f1-score': 0.3490752533225215, 'support': 25258}, 'weighted avg': {'precision': 0.3849915749692404, 'recall': 0.3695462823659831, 'f1-score': 0.34741332558532306, 'support': 25258}}
[[2207 4956 1377]
 [1574 5292 1287]
 [1774 4956 1835]]
training model: results/CHTR/W8/deepVOL_L2/h20
Epoch 1/50
358/358 - 13s - loss: 3.3295 - accuracy20: 0.3523 - val_loss: 3.3782 - val_accuracy20: 0.3385 - 13s/epoch - 35ms/step
Epoch 2/50
358/358 - 10s - loss: 3.3047 - accuracy20: 0.3597 - val_loss: 3.3480 - val_accuracy20: 0.3380 - 10s/epoch - 28ms/step
Epoch 3/50
358/358 - 10s - loss: 3.2907 - accuracy20: 0.3678 - val_loss: 3.3296 - val_accuracy20: 0.3441 - 10s/epoch - 28ms/step
Epoch 4/50
358/358 - 10s - loss: 3.2833 - accuracy20: 0.3706 - val_loss: 3.3080 - val_accuracy20: 0.3493 - 10s/epoch - 28ms/step
Epoch 5/50
358/358 - 10s - loss: 3.2775 - accuracy20: 0.3752 - val_loss: 3.3093 - val_accuracy20: 0.3528 - 10s/epoch - 28ms/step
Epoch 6/50
358/358 - 10s - loss: 3.2738 - accuracy20: 0.3784 - val_loss: 3.3035 - val_accuracy20: 0.3507 - 10s/epoch - 28ms/step
Epoch 7/50
358/358 - 10s - loss: 3.2708 - accuracy20: 0.3782 - val_loss: 3.2998 - val_accuracy20: 0.3593 - 10s/epoch - 28ms/step
Epoch 8/50
358/358 - 10s - loss: 3.2678 - accuracy20: 0.3808 - val_loss: 3.3020 - val_accuracy20: 0.3620 - 10s/epoch - 28ms/step
Epoch 9/50
358/358 - 10s - loss: 3.2644 - accuracy20: 0.3833 - val_loss: 3.2979 - val_accuracy20: 0.3589 - 10s/epoch - 28ms/step
Epoch 10/50
358/358 - 10s - loss: 3.2599 - accuracy20: 0.3858 - val_loss: 3.3041 - val_accuracy20: 0.3607 - 10s/epoch - 27ms/step
Epoch 11/50
358/358 - 10s - loss: 3.2574 - accuracy20: 0.3880 - val_loss: 3.3002 - val_accuracy20: 0.3628 - 10s/epoch - 28ms/step
Epoch 12/50
358/358 - 10s - loss: 3.2560 - accuracy20: 0.3880 - val_loss: 3.2916 - val_accuracy20: 0.3625 - 10s/epoch - 28ms/step
Epoch 13/50
358/358 - 10s - loss: 3.2527 - accuracy20: 0.3905 - val_loss: 3.2896 - val_accuracy20: 0.3671 - 10s/epoch - 28ms/step
Epoch 14/50
358/358 - 10s - loss: 3.2481 - accuracy20: 0.3942 - val_loss: 3.2875 - val_accuracy20: 0.3680 - 10s/epoch - 28ms/step
Epoch 15/50
358/358 - 10s - loss: 3.2474 - accuracy20: 0.3920 - val_loss: 3.2928 - val_accuracy20: 0.3667 - 10s/epoch - 28ms/step
Epoch 16/50
358/358 - 10s - loss: 3.2464 - accuracy20: 0.3938 - val_loss: 3.2862 - val_accuracy20: 0.3680 - 10s/epoch - 28ms/step
Epoch 17/50
358/358 - 10s - loss: 3.2426 - accuracy20: 0.3936 - val_loss: 3.2825 - val_accuracy20: 0.3758 - 10s/epoch - 28ms/step
Epoch 18/50
358/358 - 10s - loss: 3.2397 - accuracy20: 0.3963 - val_loss: 3.2883 - val_accuracy20: 0.3716 - 10s/epoch - 28ms/step
Epoch 19/50
358/358 - 10s - loss: 3.2363 - accuracy20: 0.3994 - val_loss: 3.2890 - val_accuracy20: 0.3726 - 10s/epoch - 28ms/step
Epoch 20/50
358/358 - 10s - loss: 3.2330 - accuracy20: 0.3993 - val_loss: 3.2903 - val_accuracy20: 0.3739 - 10s/epoch - 28ms/step
Epoch 21/50
358/358 - 10s - loss: 3.2302 - accuracy20: 0.4021 - val_loss: 3.2930 - val_accuracy20: 0.3702 - 10s/epoch - 27ms/step
Epoch 22/50
358/358 - 10s - loss: 3.2284 - accuracy20: 0.4031 - val_loss: 3.2954 - val_accuracy20: 0.3707 - 10s/epoch - 28ms/step
Epoch 23/50
358/358 - 10s - loss: 3.2273 - accuracy20: 0.4030 - val_loss: 3.2922 - val_accuracy20: 0.3701 - 10s/epoch - 27ms/step
Epoch 24/50
358/358 - 10s - loss: 3.2239 - accuracy20: 0.4045 - val_loss: 3.2940 - val_accuracy20: 0.3744 - 10s/epoch - 27ms/step
Epoch 25/50
358/358 - 10s - loss: 3.2222 - accuracy20: 0.4073 - val_loss: 3.2992 - val_accuracy20: 0.3701 - 10s/epoch - 27ms/step
Epoch 26/50
358/358 - 10s - loss: 3.2185 - accuracy20: 0.4095 - val_loss: 3.3060 - val_accuracy20: 0.3684 - 10s/epoch - 28ms/step
Epoch 27/50
358/358 - 10s - loss: 3.2173 - accuracy20: 0.4092 - val_loss: 3.3034 - val_accuracy20: 0.3679 - 10s/epoch - 28ms/step
testing model: results/CHTR/W8/deepVOL_L2/h20
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0928177
{'0': {'precision': 0.373040293040293, 'recall': 0.26845727650926937, 'f1-score': 0.3122237272641125, 'support': 104322}, '1': {'precision': 0.37393447062009205, 'recall': 0.6397565020801097, 'f1-score': 0.471991988433814, 'support': 107927}, '2': {'precision': 0.3879342687776694, 'recall': 0.20519130020638196, 'f1-score': 0.26841107909560524, 'support': 100784}, 'accuracy': 0.3761041168183546, 'macro avg': {'precision': 0.3783030108126848, 'recall': 0.3711350262652537, 'f1-score': 0.35087559826451065, 'support': 313033}, 'weighted avg': {'precision': 0.37814384555511, 'recall': 0.3761041168183546, 'f1-score': 0.3532024585488254, 'support': 313033}}
[[28006 59511 16805]
 [23057 69047 15823]
 [24012 56092 20680]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0866089
{'0': {'precision': 0.4115057680631451, 'recall': 0.25847767360559354, 'f1-score': 0.31751546975345996, 'support': 31465}, '1': {'precision': 0.3682063029044901, 'recall': 0.6836683834524008, 'f1-score': 0.47863307511573266, 'support': 30095}, '2': {'precision': 0.421526369168357, 'recall': 0.22271341973944203, 'f1-score': 0.291442971403528, 'support': 29859}, 'accuracy': 0.386768614839366, 'macro avg': {'precision': 0.400412813378664, 'recall': 0.3882864922658121, 'f1-score': 0.3625305054242402, 'support': 91419}, 'weighted avg': {'precision': 0.40052454670271453, 'recall': 0.386768614839366, 'f1-score': 0.36203942653648075, 'support': 91419}}
[[ 8133 18328  5004]
 [ 5398 20575  4122]
 [ 6233 16976  6650]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0937926
{'0': {'precision': 0.39041464728056, 'recall': 0.25264258334301315, 'f1-score': 0.3067700987306065, 'support': 8609}, '1': {'precision': 0.35610013871457824, 'recall': 0.6500663209936091, 'f1-score': 0.46013997951519287, 'support': 8293}, '2': {'precision': 0.4003957783641161, 'recall': 0.21792723791287696, 'f1-score': 0.28223806571605703, 'support': 8356}, 'accuracy': 0.37164462744476995, 'macro avg': {'precision': 0.38230352145308477, 'recall': 0.37354538074983307, 'f1-score': 0.34971604798728545, 'support': 25258}, 'weighted avg': {'precision': 0.38245012561599867, 'recall': 0.37164462744476995, 'f1-score': 0.3490104484604742, 'support': 25258}}
[[2175 4993 1441]
 [1616 5391 1286]
 [1780 4755 1821]]
training model: results/CHTR/W8/deepVOL_L2/h30
Epoch 1/50
358/358 - 12s - loss: 3.3368 - accuracy30: 0.3459 - val_loss: 3.3466 - val_accuracy30: 0.3412 - 12s/epoch - 34ms/step
Epoch 2/50
358/358 - 10s - loss: 3.3067 - accuracy30: 0.3591 - val_loss: 3.3883 - val_accuracy30: 0.3398 - 10s/epoch - 28ms/step
Epoch 3/50
358/358 - 10s - loss: 3.2928 - accuracy30: 0.3667 - val_loss: 3.3211 - val_accuracy30: 0.3519 - 10s/epoch - 28ms/step
Epoch 4/50
358/358 - 10s - loss: 3.2861 - accuracy30: 0.3682 - val_loss: 3.3245 - val_accuracy30: 0.3539 - 10s/epoch - 27ms/step
Epoch 5/50
358/358 - 10s - loss: 3.2830 - accuracy30: 0.3704 - val_loss: 3.3146 - val_accuracy30: 0.3515 - 10s/epoch - 28ms/step
Epoch 6/50
358/358 - 10s - loss: 3.2790 - accuracy30: 0.3724 - val_loss: 3.3138 - val_accuracy30: 0.3602 - 10s/epoch - 27ms/step
Epoch 7/50
358/358 - 10s - loss: 3.2742 - accuracy30: 0.3770 - val_loss: 3.3227 - val_accuracy30: 0.3585 - 10s/epoch - 27ms/step
Epoch 8/50
358/358 - 10s - loss: 3.2723 - accuracy30: 0.3768 - val_loss: 3.3556 - val_accuracy30: 0.3534 - 10s/epoch - 28ms/step
Epoch 9/50
358/358 - 10s - loss: 3.2714 - accuracy30: 0.3789 - val_loss: 3.3766 - val_accuracy30: 0.3487 - 10s/epoch - 29ms/step
Epoch 10/50
358/358 - 10s - loss: 3.2678 - accuracy30: 0.3797 - val_loss: 3.3268 - val_accuracy30: 0.3554 - 10s/epoch - 28ms/step
Epoch 11/50
358/358 - 10s - loss: 3.2662 - accuracy30: 0.3813 - val_loss: 3.3239 - val_accuracy30: 0.3537 - 10s/epoch - 28ms/step
Epoch 12/50
358/358 - 10s - loss: 3.2638 - accuracy30: 0.3837 - val_loss: 3.3151 - val_accuracy30: 0.3577 - 10s/epoch - 28ms/step
Epoch 13/50
358/358 - 10s - loss: 3.2622 - accuracy30: 0.3852 - val_loss: 3.3191 - val_accuracy30: 0.3581 - 10s/epoch - 28ms/step
Epoch 14/50
358/358 - 10s - loss: 3.2596 - accuracy30: 0.3860 - val_loss: 3.3237 - val_accuracy30: 0.3567 - 10s/epoch - 28ms/step
Epoch 15/50
358/358 - 10s - loss: 3.2589 - accuracy30: 0.3858 - val_loss: 3.3198 - val_accuracy30: 0.3609 - 10s/epoch - 28ms/step
Epoch 16/50
358/358 - 10s - loss: 3.2567 - accuracy30: 0.3868 - val_loss: 3.3280 - val_accuracy30: 0.3577 - 10s/epoch - 28ms/step
testing model: results/CHTR/W8/deepVOL_L2/h30
Evaluating performance on  test set...
1223/1223 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1046644
{'0': {'precision': 0.36102323883684145, 'recall': 0.22330928213281154, 'f1-score': 0.2759382283366172, 'support': 106301}, '1': {'precision': 0.3530782832342067, 'recall': 0.6198032281124196, 'f1-score': 0.4498781345367406, 'support': 106316}, '2': {'precision': 0.3613625496694201, 'recall': 0.2182620299553856, 'f1-score': 0.2721476155885439, 'support': 100416}, 'accuracy': 0.35635220567799564, 'macro avg': {'precision': 0.3584880239134894, 'recall': 0.3537915134002056, 'f1-score': 0.33265465948730055, 'support': 313033}, 'weighted avg': {'precision': 0.3584337237911897, 'recall': 0.35635220567799564, 'f1-score': 0.3337978051156206, 'support': 313033}}
[[23738 62882 19681]
 [21368 65895 19053]
 [20646 57853 21917]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1010418
{'0': {'precision': 0.3898068419827787, 'recall': 0.21353220511839882, 'f1-score': 0.2759188716153609, 'support': 31377}, '1': {'precision': 0.34995167384236886, 'recall': 0.6630043947263284, 'f1-score': 0.4581037715232169, 'support': 30036}, '2': {'precision': 0.39189657162645736, 'recall': 0.2262880757181897, 'f1-score': 0.28690949040818053, 'support': 30006}, 'accuracy': 0.3653945022369529, 'macro avg': {'precision': 0.3772183624838683, 'recall': 0.36760822518763897, 'f1-score': 0.34031071118225276, 'support': 91419}, 'weighted avg': {'precision': 0.3773982026126573, 'recall': 0.3653945022369529, 'f1-score': 0.3393836892258107, 'support': 91419}}
[[ 6700 19164  5513]
 [ 5099 19914  5023]
 [ 5389 17827  6790]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1052736
{'0': {'precision': 0.3804034582132565, 'recall': 0.2140127388535032, 'f1-score': 0.2739198102719929, 'support': 8635}, '1': {'precision': 0.3477759261633124, 'recall': 0.6472623165931051, 'f1-score': 0.45244944757139877, 'support': 8383}, '2': {'precision': 0.3653605669028762, 'recall': 0.21274271844660195, 'f1-score': 0.26890627396840006, 'support': 8240}, 'accuracy': 0.3573917174756513, 'macro avg': {'precision': 0.36451331709314844, 'recall': 0.35800592463107006, 'f1-score': 0.3317585106039306, 'support': 25258}, 'weighted avg': {'precision': 0.36466705685241174, 'recall': 0.3573917174756513, 'f1-score': 0.3315372942509031, 'support': 25258}}
[[1848 5221 1566]
 [1478 5426 1479]
 [1532 4955 1753]]
training model: results/CHTR/W8/deepVOL_L2/h50
Epoch 1/50
358/358 - 12s - loss: 3.3271 - accuracy50: 0.3539 - val_loss: 3.3769 - val_accuracy50: 0.3389 - 12s/epoch - 34ms/step
Epoch 2/50
358/358 - 10s - loss: 3.3057 - accuracy50: 0.3593 - val_loss: 3.3996 - val_accuracy50: 0.3455 - 10s/epoch - 28ms/step
Epoch 3/50
358/358 - 10s - loss: 3.2954 - accuracy50: 0.3621 - val_loss: 3.3954 - val_accuracy50: 0.3394 - 10s/epoch - 28ms/step
Epoch 4/50
358/358 - 10s - loss: 3.2926 - accuracy50: 0.3627 - val_loss: 3.3737 - val_accuracy50: 0.3430 - 10s/epoch - 28ms/step
Epoch 5/50
358/358 - 10s - loss: 3.2891 - accuracy50: 0.3643 - val_loss: 3.3432 - val_accuracy50: 0.3445 - 10s/epoch - 28ms/step
Epoch 6/50
358/358 - 10s - loss: 3.2882 - accuracy50: 0.3638 - val_loss: 3.3420 - val_accuracy50: 0.3455 - 10s/epoch - 28ms/step
Epoch 7/50
358/358 - 10s - loss: 3.2844 - accuracy50: 0.3673 - val_loss: 3.3035 - val_accuracy50: 0.3496 - 10s/epoch - 28ms/step
Epoch 8/50
358/358 - 10s - loss: 3.2821 - accuracy50: 0.3692 - val_loss: 3.3125 - val_accuracy50: 0.3516 - 10s/epoch - 28ms/step
Epoch 9/50
358/358 - 10s - loss: 3.2818 - accuracy50: 0.3675 - val_loss: 3.3116 - val_accuracy50: 0.3475 - 10s/epoch - 28ms/step
Epoch 10/50
358/358 - 10s - loss: 3.2776 - accuracy50: 0.3734 - val_loss: 3.3154 - val_accuracy50: 0.3477 - 10s/epoch - 28ms/step
Epoch 11/50
358/358 - 10s - loss: 3.2778 - accuracy50: 0.3728 - val_loss: 3.2999 - val_accuracy50: 0.3553 - 10s/epoch - 28ms/step
Epoch 12/50
358/358 - 10s - loss: 3.2750 - accuracy50: 0.3732 - val_loss: 3.3038 - val_accuracy50: 0.3545 - 10s/epoch - 28ms/step
Epoch 13/50
358/358 - 10s - loss: 3.2768 - accuracy50: 0.3715 - val_loss: 3.3109 - val_accuracy50: 0.3565 - 10s/epoch - 28ms/step
Epoch 14/50
358/358 - 10s - loss: 3.2741 - accuracy50: 0.3738 - val_loss: 3.2996 - val_accuracy50: 0.3534 - 10s/epoch - 28ms/step
Epoch 15/50
358/358 - 10s - loss: 3.2720 - accuracy50: 0.3751 - val_loss: 3.3035 - val_accuracy50: 0.3532 - 10s/epoch - 28ms/step
Epoch 16/50
358/358 - 10s - loss: 3.2689 - accuracy50: 0.3759 - val_loss: 3.3120 - val_accuracy50: 0.3494 - 10s/epoch - 28ms/step
Epoch 17/50
358/358 - 10s - loss: 3.2668 - accuracy50: 0.3781 - val_loss: 3.3188 - val_accuracy50: 0.3534 - 10s/epoch - 28ms/step
Epoch 18/50
358/358 - 10s - loss: 3.2665 - accuracy50: 0.3783 - val_loss: 3.3160 - val_accuracy50: 0.3518 - 10s/epoch - 28ms/step
Epoch 19/50
358/358 - 10s - loss: 3.2641 - accuracy50: 0.3803 - val_loss: 3.3239 - val_accuracy50: 0.3525 - 10s/epoch - 28ms/step
Epoch 20/50
358/358 - 10s - loss: 3.2622 - accuracy50: 0.3809 - val_loss: 3.3098 - val_accuracy50: 0.3544 - 10s/epoch - 28ms/step
Epoch 21/50
358/358 - 10s - loss: 3.2629 - accuracy50: 0.3816 - val_loss: 3.3148 - val_accuracy50: 0.3598 - 10s/epoch - 28ms/step
Epoch 22/50
358/358 - 10s - loss: 3.2598 - accuracy50: 0.3835 - val_loss: 3.3181 - val_accuracy50: 0.3524 - 10s/epoch - 28ms/step
Epoch 23/50
358/358 - 10s - loss: 3.2572 - accuracy50: 0.3837 - val_loss: 3.3241 - val_accuracy50: 0.3553 - 10s/epoch - 27ms/step
Epoch 24/50
358/358 - 10s - loss: 3.2583 - accuracy50: 0.3843 - val_loss: 3.3256 - val_accuracy50: 0.3565 - 10s/epoch - 28ms/step
testing model: results/CHTR/W8/deepVOL_L2/h50
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1002415
{'0': {'precision': 0.35636682975787226, 'recall': 0.2688332828588734, 'f1-score': 0.3064723208216902, 'support': 105664}, '1': {'precision': 0.3556947538370358, 'recall': 0.6370724207983308, 'f1-score': 0.456508481911594, 'support': 109278}, '2': {'precision': 0.34814755711588075, 'recall': 0.13344751302362093, 'f1-score': 0.19293978922544036, 'support': 98091}, 'accuracy': 0.35495938127929005, 'macro avg': {'precision': 0.35340304690359625, 'recall': 0.34645107222694177, 'f1-score': 0.3186401973195749, 'support': 313033}, 'weighted avg': {'precision': 0.3535566474920959, 'recall': 0.35495938127929005, 'f1-score': 0.32327288834899487, 'support': 313033}}
[[28406 65262 11996]
 [27147 69618 12513]
 [24157 60844 13090]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0945642
{'0': {'precision': 0.39242550276459365, 'recall': 0.2566975002400538, 'f1-score': 0.3103715170278638, 'support': 31243}, '1': {'precision': 0.35157343521003837, 'recall': 0.7057617929985786, 'f1-score': 0.4693442370683022, 'support': 30251}, '2': {'precision': 0.4043881033642126, 'recall': 0.1385797827903091, 'f1-score': 0.20642110502737682, 'support': 29925}, 'accuracy': 0.3666305691377066, 'macro avg': {'precision': 0.38279568044628154, 'recall': 0.36701302534298047, 'f1-score': 0.3287122863745143, 'support': 91419}, 'weighted avg': {'precision': 0.38282317641395264, 'recall': 0.3666305691377066, 'f1-score': 0.3289493583390653, 'support': 91419}}
[[ 8020 20019  3204]
 [ 5997 21350  2904]
 [ 6420 19358  4147]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1004999
{'0': {'precision': 0.36347486232012793, 'recall': 0.23932623698678207, 'f1-score': 0.2886161658908168, 'support': 8549}, '1': {'precision': 0.34078012066184815, 'recall': 0.6704665648137267, 'f1-score': 0.4518811881188119, 'support': 8509}, '2': {'precision': 0.3601108033240997, 'recall': 0.12682926829268293, 'f1-score': 0.1875901875901876, 'support': 8200}, 'accuracy': 0.34804814316256233, 'macro avg': {'precision': 0.3547885954353586, 'recall': 0.34554069003106386, 'f1-score': 0.30936251386660546, 'support': 25258}, 'weighted avg': {'precision': 0.3547372409511465, 'recall': 0.34804814316256233, 'f1-score': 0.31081939069376446, 'support': 25258}}
[[2046 5582  921]
 [1877 5705  927]
 [1706 5454 1040]]
training model: results/CHTR/W8/deepVOL_L2/h100
Epoch 1/50
358/358 - 12s - loss: 3.3307 - accuracy100: 0.3501 - val_loss: 3.3649 - val_accuracy100: 0.3421 - 12s/epoch - 34ms/step
Epoch 2/50
358/358 - 10s - loss: 3.3077 - accuracy100: 0.3527 - val_loss: 3.3957 - val_accuracy100: 0.3425 - 10s/epoch - 28ms/step
Epoch 3/50
358/358 - 10s - loss: 3.3053 - accuracy100: 0.3543 - val_loss: 3.3262 - val_accuracy100: 0.3425 - 10s/epoch - 28ms/step
Epoch 4/50
358/358 - 10s - loss: 3.2981 - accuracy100: 0.3561 - val_loss: 3.3192 - val_accuracy100: 0.3415 - 10s/epoch - 29ms/step
Epoch 5/50
358/358 - 10s - loss: 3.2959 - accuracy100: 0.3555 - val_loss: 3.3127 - val_accuracy100: 0.3419 - 10s/epoch - 29ms/step
Epoch 6/50
358/358 - 10s - loss: 3.2944 - accuracy100: 0.3523 - val_loss: 3.3188 - val_accuracy100: 0.3418 - 10s/epoch - 29ms/step
Epoch 7/50
358/358 - 10s - loss: 3.2930 - accuracy100: 0.3526 - val_loss: 3.3045 - val_accuracy100: 0.3447 - 10s/epoch - 29ms/step
Epoch 8/50
358/358 - 10s - loss: 3.2905 - accuracy100: 0.3566 - val_loss: 3.3089 - val_accuracy100: 0.3409 - 10s/epoch - 28ms/step
Epoch 9/50
358/358 - 10s - loss: 3.2888 - accuracy100: 0.3588 - val_loss: 3.3221 - val_accuracy100: 0.3448 - 10s/epoch - 27ms/step
Epoch 10/50
358/358 - 10s - loss: 3.2881 - accuracy100: 0.3588 - val_loss: 3.3108 - val_accuracy100: 0.3421 - 10s/epoch - 28ms/step
Epoch 11/50
358/358 - 10s - loss: 3.2864 - accuracy100: 0.3600 - val_loss: 3.3090 - val_accuracy100: 0.3441 - 10s/epoch - 28ms/step
Epoch 12/50
358/358 - 10s - loss: 3.2853 - accuracy100: 0.3617 - val_loss: 3.3136 - val_accuracy100: 0.3436 - 10s/epoch - 28ms/step
Epoch 13/50
358/358 - 10s - loss: 3.2841 - accuracy100: 0.3623 - val_loss: 3.3348 - val_accuracy100: 0.3443 - 10s/epoch - 28ms/step
Epoch 14/50
358/358 - 10s - loss: 3.2833 - accuracy100: 0.3634 - val_loss: 3.3412 - val_accuracy100: 0.3429 - 10s/epoch - 28ms/step
Epoch 15/50
358/358 - 10s - loss: 3.2844 - accuracy100: 0.3630 - val_loss: 3.3631 - val_accuracy100: 0.3435 - 10s/epoch - 28ms/step
Epoch 16/50
358/358 - 10s - loss: 3.2822 - accuracy100: 0.3643 - val_loss: 3.3269 - val_accuracy100: 0.3451 - 10s/epoch - 28ms/step
Epoch 17/50
358/358 - 10s - loss: 3.2819 - accuracy100: 0.3646 - val_loss: 3.3467 - val_accuracy100: 0.3442 - 10s/epoch - 27ms/step
testing model: results/CHTR/W8/deepVOL_L2/h100
Evaluating performance on  test set...
1223/1223 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0992908
{'0': {'precision': 0.323024305050211, 'recall': 0.12837518677399143, 'f1-score': 0.18373217624050606, 'support': 103735}, '1': {'precision': 0.36031409924736185, 'recall': 0.7326148840992274, 'f1-score': 0.48305329272380176, 'support': 113114}, '2': {'precision': 0.3274105605509853, 'recall': 0.14234176162355486, 'f1-score': 0.19842028985507248, 'support': 96184}, 'accuracy': 0.351007721230669, 'macro avg': {'precision': 0.33691632161618607, 'recall': 0.33444394416559126, 'f1-score': 0.28840191960646006, 'support': 313033}, 'weighted avg': {'precision': 0.3378466572619682, 'recall': 0.351007721230669, 'f1-score': 0.2964045471719892, 'support': 313033}}
[[13317 77271 13147]
 [15267 82869 14978]
 [12642 69851 13691]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1008508
{'0': {'precision': 0.3657291376589622, 'recall': 0.12749158684959877, 'f1-score': 0.18907310986875256, 'support': 30904}, '1': {'precision': 0.33594754249895287, 'recall': 0.7717319177173192, 'f1-score': 0.4681163649536613, 'support': 30140}, '2': {'precision': 0.37689543342974846, 'recall': 0.14156378600823044, 'f1-score': 0.205820409726211, 'support': 30375}, 'accuracy': 0.3445673218915105, 'macro avg': {'precision': 0.35952403786255455, 'recall': 0.34692909685838275, 'f1-score': 0.2876699615162083, 'support': 91419}, 'weighted avg': {'precision': 0.35962054924643255, 'recall': 0.3445673218915105, 'f1-score': 0.28663557436113873, 'support': 91419}}
[[ 3940 23452  3512]
 [ 3283 23260  3597]
 [ 3550 22525  4300]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.101861
{'0': {'precision': 0.3469321148825065, 'recall': 0.12510297752147817, 'f1-score': 0.18389412680563968, 'support': 8497}, '1': {'precision': 0.3458055786844296, 'recall': 0.766524397277656, 'f1-score': 0.47660032275416886, 'support': 8669}, '2': {'precision': 0.3371390194761585, 'recall': 0.1240731586752348, 'f1-score': 0.1813911472448058, 'support': 8092}, 'accuracy': 0.3449204212526724, 'macro avg': {'precision': 0.3432922376810315, 'recall': 0.3385668444914563, 'f1-score': 0.2806285322682048, 'support': 25258}, 'weighted avg': {'precision': 0.3434080167619389, 'recall': 0.3449204212526724, 'f1-score': 0.2835542702085826, 'support': 25258}}
[[1063 6464  970]
 [1020 6645 1004]
 [ 981 6107 1004]]
training model: results/CHTR/W8/deepVOL_L2/h200
Epoch 1/50
358/358 - 13s - loss: 3.3384 - accuracy200: 0.3467 - val_loss: 3.3707 - val_accuracy200: 0.3391 - 13s/epoch - 35ms/step
Epoch 2/50
358/358 - 11s - loss: 3.3090 - accuracy200: 0.3563 - val_loss: 3.3851 - val_accuracy200: 0.3420 - 11s/epoch - 30ms/step
Epoch 3/50
358/358 - 10s - loss: 3.3024 - accuracy200: 0.3580 - val_loss: 3.3890 - val_accuracy200: 0.3418 - 10s/epoch - 28ms/step
Epoch 4/50
358/358 - 10s - loss: 3.2973 - accuracy200: 0.3566 - val_loss: 3.3604 - val_accuracy200: 0.3406 - 10s/epoch - 28ms/step
Epoch 5/50
358/358 - 10s - loss: 3.2958 - accuracy200: 0.3589 - val_loss: 3.3520 - val_accuracy200: 0.3404 - 10s/epoch - 28ms/step
Epoch 6/50
358/358 - 10s - loss: 3.2896 - accuracy200: 0.3604 - val_loss: 3.3523 - val_accuracy200: 0.3420 - 10s/epoch - 28ms/step
Epoch 7/50
358/358 - 10s - loss: 3.2892 - accuracy200: 0.3613 - val_loss: 3.3285 - val_accuracy200: 0.3402 - 10s/epoch - 28ms/step
Epoch 8/50
358/358 - 10s - loss: 3.2863 - accuracy200: 0.3600 - val_loss: 3.3428 - val_accuracy200: 0.3416 - 10s/epoch - 28ms/step
Epoch 9/50
358/358 - 10s - loss: 3.2832 - accuracy200: 0.3632 - val_loss: 3.3355 - val_accuracy200: 0.3420 - 10s/epoch - 28ms/step
Epoch 10/50
358/358 - 10s - loss: 3.2814 - accuracy200: 0.3651 - val_loss: 3.3283 - val_accuracy200: 0.3411 - 10s/epoch - 28ms/step
Epoch 11/50
358/358 - 10s - loss: 3.2807 - accuracy200: 0.3651 - val_loss: 3.3347 - val_accuracy200: 0.3421 - 10s/epoch - 28ms/step
Epoch 12/50
358/358 - 10s - loss: 3.2792 - accuracy200: 0.3690 - val_loss: 3.3359 - val_accuracy200: 0.3418 - 10s/epoch - 28ms/step
Epoch 13/50
358/358 - 10s - loss: 3.2764 - accuracy200: 0.3699 - val_loss: 3.3341 - val_accuracy200: 0.3423 - 10s/epoch - 28ms/step
Epoch 14/50
358/358 - 10s - loss: 3.2761 - accuracy200: 0.3707 - val_loss: 3.3416 - val_accuracy200: 0.3425 - 10s/epoch - 28ms/step
Epoch 15/50
358/358 - 10s - loss: 3.2740 - accuracy200: 0.3740 - val_loss: 3.3439 - val_accuracy200: 0.3419 - 10s/epoch - 28ms/step
Epoch 16/50
358/358 - 10s - loss: 3.2735 - accuracy200: 0.3721 - val_loss: 3.3408 - val_accuracy200: 0.3411 - 10s/epoch - 28ms/step
Epoch 17/50
358/358 - 10s - loss: 3.2725 - accuracy200: 0.3722 - val_loss: 3.3337 - val_accuracy200: 0.3437 - 10s/epoch - 28ms/step
Epoch 18/50
358/358 - 10s - loss: 3.2692 - accuracy200: 0.3763 - val_loss: 3.3497 - val_accuracy200: 0.3413 - 10s/epoch - 28ms/step
Epoch 19/50
358/358 - 10s - loss: 3.2689 - accuracy200: 0.3756 - val_loss: 3.3423 - val_accuracy200: 0.3418 - 10s/epoch - 28ms/step
Epoch 20/50
358/358 - 10s - loss: 3.2674 - accuracy200: 0.3795 - val_loss: 3.3481 - val_accuracy200: 0.3432 - 10s/epoch - 28ms/step
testing model: results/CHTR/W8/deepVOL_L2/h200
Evaluating performance on  test set...
1223/1223 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1039852
{'0': {'precision': 0.31696823990889533, 'recall': 0.024446417941035827, 'f1-score': 0.045391947232993876, 'support': 102469}, '1': {'precision': 0.36182017351085627, 'recall': 0.9440122084612399, 'f1-score': 0.5231340036857979, 'support': 113364}, '2': {'precision': 0.33636169303120994, 'recall': 0.03237654320987654, 'f1-score': 0.05906753256503622, 'support': 97200}, 'accuracy': 0.3599269086645817, 'macro avg': {'precision': 0.3383833688169872, 'recall': 0.33361172320405075, 'f1-score': 0.20919782782794263, 'support': 313033}, 'weighted avg': {'precision': 0.3392331073329103, 'recall': 0.3599269086645817, 'f1-score': 0.22265126935555024, 'support': 313033}}
[[  2505  97283   2681]
 [  2819 107017   3528]
 [  2579  91474   3147]]
Evaluating performance on  train set...
358/358 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1106557
{'0': {'precision': 0.387589013224822, 'recall': 0.025230117210780743, 'f1-score': 0.04737627455856752, 'support': 30202}, '1': {'precision': 0.33531643683299517, 'recall': 0.9658907049694568, 'f1-score': 0.497813175405456, 'support': 30285}, '2': {'precision': 0.42734657039711194, 'recall': 0.03061554377343851, 'f1-score': 0.05713768553155545, 'support': 30932}, 'accuracy': 0.3386713921613669, 'macro avg': {'precision': 0.383417340151643, 'recall': 0.3405787886512253, 'f1-score': 0.20077571183185963, 'support': 91419}, 'weighted avg': {'precision': 0.3837244531489821, 'recall': 0.3386713921613669, 'f1-score': 0.1998984144459485, 'support': 91419}}
[[  762 28705   735]
 [  499 29252   534]
 [  705 29280   947]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1112397
{'0': {'precision': 0.34977578475336324, 'recall': 0.01840273681727026, 'f1-score': 0.03496581867085061, 'support': 8477}, '1': {'precision': 0.3434796935497158, 'recall': 0.9624884579870729, 'f1-score': 0.5062837714771417, 'support': 8664}, '2': {'precision': 0.31647940074906367, 'recall': 0.02082050018479734, 'f1-score': 0.03907062767310137, 'support': 8117}, 'accuracy': 0.3430200332567899, 'macro avg': {'precision': 0.3365782930173809, 'recall': 0.3339038983297135, 'f1-score': 0.1934400726070312, 'support': 25258}, 'weighted avg': {'precision': 0.3369158558931486, 'recall': 0.3430200332567899, 'f1-score': 0.1979564544213049, 'support': 25258}}
[[ 156 8152  169]
 [ 129 8339  196]
 [ 161 7787  169]]
training model: results/CHTR/W8/deepVOL_L2/h300
Epoch 1/50
358/358 - 13s - loss: 3.3333 - accuracy300: 0.3546 - val_loss: 3.4360 - val_accuracy300: 0.3451 - 13s/epoch - 36ms/step
Epoch 2/50
358/358 - 10s - loss: 3.3170 - accuracy300: 0.3525 - val_loss: 3.3587 - val_accuracy300: 0.3488 - 10s/epoch - 29ms/step
Epoch 3/50
358/358 - 10s - loss: 3.3029 - accuracy300: 0.3570 - val_loss: 3.3590 - val_accuracy300: 0.3439 - 10s/epoch - 28ms/step
Epoch 4/50
358/358 - 10s - loss: 3.2944 - accuracy300: 0.3620 - val_loss: 3.3798 - val_accuracy300: 0.3482 - 10s/epoch - 28ms/step
Epoch 5/50
358/358 - 10s - loss: 3.2921 - accuracy300: 0.3624 - val_loss: 3.3380 - val_accuracy300: 0.3500 - 10s/epoch - 28ms/step
Epoch 6/50
358/358 - 10s - loss: 3.2874 - accuracy300: 0.3638 - val_loss: 3.3219 - val_accuracy300: 0.3522 - 10s/epoch - 28ms/step
Epoch 7/50
358/358 - 10s - loss: 3.2855 - accuracy300: 0.3662 - val_loss: 3.3195 - val_accuracy300: 0.3515 - 10s/epoch - 28ms/step
Epoch 8/50
358/358 - 10s - loss: 3.2826 - accuracy300: 0.3639 - val_loss: 3.3186 - val_accuracy300: 0.3503 - 10s/epoch - 28ms/step
Epoch 9/50
358/358 - 10s - loss: 3.2793 - accuracy300: 0.3673 - val_loss: 3.3142 - val_accuracy300: 0.3500 - 10s/epoch - 28ms/step
Epoch 10/50
358/358 - 10s - loss: 3.2794 - accuracy300: 0.3675 - val_loss: 3.3083 - val_accuracy300: 0.3520 - 10s/epoch - 28ms/step
Epoch 11/50
358/358 - 10s - loss: 3.2764 - accuracy300: 0.3715 - val_loss: 3.3148 - val_accuracy300: 0.3489 - 10s/epoch - 28ms/step
Epoch 12/50
358/358 - 10s - loss: 3.2766 - accuracy300: 0.3724 - val_loss: 3.3126 - val_accuracy300: 0.3499 - 10s/epoch - 28ms/step
Epoch 13/50
358/358 - 10s - loss: 3.2729 - accuracy300: 0.3732 - val_loss: 3.3135 - val_accuracy300: 0.3507 - 10s/epoch - 29ms/step
Epoch 14/50
358/358 - 10s - loss: 3.2734 - accuracy300: 0.3718 - val_loss: 3.3086 - val_accuracy300: 0.3522 - 10s/epoch - 28ms/step
Epoch 15/50
358/358 - 10s - loss: 3.2714 - accuracy300: 0.3724 - val_loss: 3.3109 - val_accuracy300: 0.3526 - 10s/epoch - 28ms/step
Epoch 16/50
358/358 - 10s - loss: 3.2699 - accuracy300: 0.3746 - val_loss: 3.3127 - val_accuracy300: 0.3500 - 10s/epoch - 28ms/step
Epoch 17/50
358/358 - 10s - loss: 3.2691 - accuracy300: 0.3739 - val_loss: 3.3150 - val_accuracy300: 0.3494 - 10s/epoch - 28ms/step
Epoch 18/50
358/358 - 10s - loss: 3.2681 - accuracy300: 0.3756 - val_loss: 3.3163 - val_accuracy300: 0.3499 - 10s/epoch - 28ms/step
Epoch 19/50
358/358 - 10s - loss: 3.2653 - accuracy300: 0.3780 - val_loss: 3.3104 - val_accuracy300: 0.3490 - 10s/epoch - 28ms/step
Epoch 20/50
358/358 - 10s - loss: 3.2645 - accuracy300: 0.3770 - val_loss: 3.3110 - val_accuracy300: 0.3508 - 10s/epoch - 28ms/step
testing model: results/CHTR/W8/deepVOL_L2/h300
Evaluating performance on  test set...
1223/1223 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011709
{'0': {'precision': 0.2962807840509298, 'recall': 0.03500767060919483, 'f1-score': 0.06261673143140395, 'support': 101035}, '1': {'precision': 0.35967887671390053, 'recall': 0.8945495728477412, 'f1-score': 0.5130653600454181, 'support': 112138}, '2': {'precision': 0.3432136582728952, 'recall': 0.07629681554175846, 'f1-score': 0.12484126528973692, 'support': 99860}, 'accuracy': 0.3560934470167682, 'macro avg': {'precision': 0.33305777301257516, 'recall': 0.33528468633289815, 'f1-score': 0.23350778558885302, 'support': 313033}, 'weighted avg': {'precision': 0.33396387859637927, 'recall': 0.3560934470167682, 'f1-score': 0.24383133266070392, 'support': 313033}}
[[  3537  90337   7161]
 [  4406 100313   7419]
 [  3995  88246   7619]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1017425
{'0': {'precision': 0.3765833618623759, 'recall': 0.03671194473183593, 'f1-score': 0.0669018367595183, 'support': 29963}, '1': {'precision': 0.3380865326020719, 'recall': 0.9165400118945352, 'f1-score': 0.49396346023718796, 'support': 30266}, '2': {'precision': 0.3860111662531017, 'recall': 0.07980121833921129, 'f1-score': 0.1322599500504809, 'support': 31190}, 'accuracy': 0.3426968135726709, 'macro avg': {'precision': 0.36689368690584984, 'recall': 0.3443510583218608, 'f1-score': 0.23104174901572905, 'support': 91419}, 'weighted avg': {'precision': 0.3670547976093692, 'recall': 0.3426968135726709, 'f1-score': 0.23058735781881967, 'support': 91419}}
[[ 1100 26677  2186]
 [  753 27740  1773]
 [ 1068 27633  2489]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1022843
{'0': {'precision': 0.3209054593874834, 'recall': 0.028669997620747085, 'f1-score': 0.05263732663536093, 'support': 8406}, '1': {'precision': 0.3529308912881934, 'recall': 0.9087225661226787, 'f1-score': 0.5084062716453625, 'support': 8885}, '2': {'precision': 0.3361963190184049, 'recall': 0.0687837328982051, 'f1-score': 0.11420235490257372, 'support': 7967}, 'accuracy': 0.3508987251563861, 'macro avg': {'precision': 0.33667755656469395, 'recall': 0.3353920988805436, 'f1-score': 0.22508198439443236, 'support': 25258}, 'weighted avg': {'precision': 0.3369941537068024, 'recall': 0.3508987251563861, 'f1-score': 0.23238218595196353, 'support': 25258}}
[[ 241 7650  515]
 [ 244 8074  567]
 [ 266 7153  548]]
training model: results/CHTR/W8/deepVOL_L2/h500
Epoch 1/50
358/358 - 12s - loss: 3.3344 - accuracy500: 0.3524 - val_loss: 3.4027 - val_accuracy500: 0.3520 - 12s/epoch - 35ms/step
Epoch 2/50
358/358 - 10s - loss: 3.3077 - accuracy500: 0.3646 - val_loss: 3.3459 - val_accuracy500: 0.3657 - 10s/epoch - 28ms/step
Epoch 3/50
358/358 - 10s - loss: 3.3037 - accuracy500: 0.3569 - val_loss: 3.3755 - val_accuracy500: 0.3653 - 10s/epoch - 28ms/step
Epoch 4/50
358/358 - 10s - loss: 3.2947 - accuracy500: 0.3620 - val_loss: 3.4250 - val_accuracy500: 0.3602 - 10s/epoch - 29ms/step
Epoch 5/50
358/358 - 10s - loss: 3.3011 - accuracy500: 0.3584 - val_loss: 3.3238 - val_accuracy500: 0.3596 - 10s/epoch - 28ms/step
Epoch 6/50
358/358 - 10s - loss: 3.2932 - accuracy500: 0.3597 - val_loss: 3.3190 - val_accuracy500: 0.3681 - 10s/epoch - 28ms/step
Epoch 7/50
358/358 - 10s - loss: 3.2906 - accuracy500: 0.3605 - val_loss: 3.3131 - val_accuracy500: 0.3645 - 10s/epoch - 28ms/step
Epoch 8/50
358/358 - 10s - loss: 3.2867 - accuracy500: 0.3619 - val_loss: 3.2985 - val_accuracy500: 0.3686 - 10s/epoch - 29ms/step
Epoch 9/50
358/358 - 10s - loss: 3.2828 - accuracy500: 0.3637 - val_loss: 3.3019 - val_accuracy500: 0.3671 - 10s/epoch - 28ms/step
Epoch 10/50
358/358 - 10s - loss: 3.2821 - accuracy500: 0.3651 - val_loss: 3.3015 - val_accuracy500: 0.3703 - 10s/epoch - 29ms/step
Epoch 11/50
358/358 - 10s - loss: 3.2812 - accuracy500: 0.3672 - val_loss: 3.3005 - val_accuracy500: 0.3669 - 10s/epoch - 29ms/step
Epoch 12/50
358/358 - 10s - loss: 3.2787 - accuracy500: 0.3671 - val_loss: 3.2981 - val_accuracy500: 0.3686 - 10s/epoch - 29ms/step
Epoch 13/50
358/358 - 10s - loss: 3.2770 - accuracy500: 0.3668 - val_loss: 3.2959 - val_accuracy500: 0.3679 - 10s/epoch - 28ms/step
Epoch 14/50
358/358 - 10s - loss: 3.2745 - accuracy500: 0.3685 - val_loss: 3.3007 - val_accuracy500: 0.3692 - 10s/epoch - 27ms/step
Epoch 15/50
358/358 - 10s - loss: 3.2727 - accuracy500: 0.3721 - val_loss: 3.3041 - val_accuracy500: 0.3687 - 10s/epoch - 29ms/step
Epoch 16/50
358/358 - 10s - loss: 3.2722 - accuracy500: 0.3709 - val_loss: 3.2987 - val_accuracy500: 0.3691 - 10s/epoch - 28ms/step
Epoch 17/50
358/358 - 10s - loss: 3.2709 - accuracy500: 0.3721 - val_loss: 3.3018 - val_accuracy500: 0.3685 - 10s/epoch - 28ms/step
Epoch 18/50
358/358 - 10s - loss: 3.2705 - accuracy500: 0.3730 - val_loss: 3.3060 - val_accuracy500: 0.3685 - 10s/epoch - 28ms/step
Epoch 19/50
358/358 - 10s - loss: 3.2693 - accuracy500: 0.3723 - val_loss: 3.3054 - val_accuracy500: 0.3678 - 10s/epoch - 28ms/step
Epoch 20/50
358/358 - 10s - loss: 3.2671 - accuracy500: 0.3762 - val_loss: 3.3014 - val_accuracy500: 0.3673 - 10s/epoch - 28ms/step
Epoch 21/50
358/358 - 10s - loss: 3.2658 - accuracy500: 0.3770 - val_loss: 3.3017 - val_accuracy500: 0.3665 - 10s/epoch - 28ms/step
Epoch 22/50
358/358 - 10s - loss: 3.2653 - accuracy500: 0.3769 - val_loss: 3.3059 - val_accuracy500: 0.3690 - 10s/epoch - 29ms/step
Epoch 23/50
358/358 - 10s - loss: 3.2634 - accuracy500: 0.3784 - val_loss: 3.3070 - val_accuracy500: 0.3680 - 10s/epoch - 28ms/step
testing model: results/CHTR/W8/deepVOL_L2/h500
Evaluating performance on  test set...
1223/1223 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1013877
{'0': {'precision': 0.3269586674892042, 'recall': 0.036775638865208855, 'f1-score': 0.06611481880797297, 'support': 100882}, '1': {'precision': 0.35587169985134937, 'recall': 0.9256553151321522, 'f1-score': 0.5140968963135847, 'support': 110176}, '2': {'precision': 0.3602727032036007, 'recall': 0.0533758274086786, 'f1-score': 0.09297677715808444, 'support': 101975}, 'accuracy': 0.3550360505122463, 'macro avg': {'precision': 0.34770102351471815, 'recall': 0.33860226046867986, 'f1-score': 0.22439616409321403, 'support': 313033}, 'weighted avg': {'precision': 0.3479875080443766, 'recall': 0.3550360505122463, 'f1-score': 0.23253855551947267, 'support': 313033}}
[[  3710  92178   4994]
 [  3520 101985   4671]
 [  4117  92415   5443]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1026949
{'0': {'precision': 0.39548973409626387, 'recall': 0.0392779542035768, 'f1-score': 0.0714589795049565, 'support': 29915}, '1': {'precision': 0.3359800660490957, 'recall': 0.9321888128080448, 'f1-score': 0.4939355698110562, 'support': 30231}, '2': {'precision': 0.3675344563552833, 'recall': 0.053720461740159244, 'f1-score': 0.0937395379979913, 'support': 31273}, 'accuracy': 0.3394917905468229, 'macro avg': {'precision': 0.36633475216688094, 'recall': 0.3417290762505936, 'f1-score': 0.2197113624380013, 'support': 91419}, 'weighted avg': {'precision': 0.36624764902064916, 'recall': 0.3394917905468229, 'f1-score': 0.21878797793303353, 'support': 91419}}
[[ 1175 27170  1570]
 [  729 28181  1321]
 [ 1067 28526  1680]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0979564
{'0': {'precision': 0.33473980309423346, 'recall': 0.02933201873305398, 'f1-score': 0.053937677053824365, 'support': 8114}, '1': {'precision': 0.37172348809319855, 'recall': 0.9318230620571183, 'f1-score': 0.5314432674055478, 'support': 9314}, '2': {'precision': 0.33444537114261885, 'recall': 0.05121328224776501, 'f1-score': 0.08882489755233137, 'support': 7830}, 'accuracy': 0.3689128197006889, 'macro avg': {'precision': 0.3469695541100169, 'recall': 0.3374561210126458, 'f1-score': 0.22473528067056783, 'support': 25258}, 'weighted avg': {'precision': 0.3482864275260657, 'recall': 0.3689128197006889, 'f1-score': 0.24083505630155821, 'support': 25258}}
[[ 238 7485  391]
 [ 228 8679  407]
 [ 245 7184  401]]
training model: results/CHTR/W8/deepVOL_L2/h1000
Epoch 1/50
358/358 - 13s - loss: 3.3401 - accuracy1000: 0.3566 - val_loss: 3.3542 - val_accuracy1000: 0.3476 - 13s/epoch - 36ms/step
Epoch 2/50
358/358 - 10s - loss: 3.3166 - accuracy1000: 0.3602 - val_loss: 3.3680 - val_accuracy1000: 0.3490 - 10s/epoch - 28ms/step
Epoch 3/50
358/358 - 10s - loss: 3.3142 - accuracy1000: 0.3566 - val_loss: 3.3691 - val_accuracy1000: 0.3471 - 10s/epoch - 28ms/step
Epoch 4/50
358/358 - 10s - loss: 3.3140 - accuracy1000: 0.3462 - val_loss: 3.3182 - val_accuracy1000: 0.3366 - 10s/epoch - 28ms/step
Epoch 5/50
358/358 - 10s - loss: 3.3022 - accuracy1000: 0.3464 - val_loss: 3.3146 - val_accuracy1000: 0.3286 - 10s/epoch - 29ms/step
Epoch 6/50
358/358 - 10s - loss: 3.2978 - accuracy1000: 0.3474 - val_loss: 3.3007 - val_accuracy1000: 0.3494 - 10s/epoch - 28ms/step
Epoch 7/50
358/358 - 10s - loss: 3.2948 - accuracy1000: 0.3465 - val_loss: 3.3045 - val_accuracy1000: 0.3450 - 10s/epoch - 28ms/step
Epoch 8/50
358/358 - 10s - loss: 3.2906 - accuracy1000: 0.3538 - val_loss: 3.3054 - val_accuracy1000: 0.3411 - 10s/epoch - 28ms/step
Epoch 9/50
358/358 - 10s - loss: 3.2885 - accuracy1000: 0.3536 - val_loss: 3.2996 - val_accuracy1000: 0.3540 - 10s/epoch - 28ms/step
Epoch 10/50
358/358 - 10s - loss: 3.2860 - accuracy1000: 0.3563 - val_loss: 3.3018 - val_accuracy1000: 0.3536 - 10s/epoch - 28ms/step
Epoch 11/50
358/358 - 10s - loss: 3.2841 - accuracy1000: 0.3594 - val_loss: 3.2980 - val_accuracy1000: 0.3583 - 10s/epoch - 28ms/step
Epoch 12/50
358/358 - 11s - loss: 3.2823 - accuracy1000: 0.3607 - val_loss: 3.2958 - val_accuracy1000: 0.3570 - 11s/epoch - 30ms/step
Epoch 13/50
358/358 - 10s - loss: 3.2805 - accuracy1000: 0.3618 - val_loss: 3.2963 - val_accuracy1000: 0.3585 - 10s/epoch - 29ms/step
Epoch 14/50
358/358 - 10s - loss: 3.2778 - accuracy1000: 0.3653 - val_loss: 3.2991 - val_accuracy1000: 0.3575 - 10s/epoch - 28ms/step
Epoch 15/50
358/358 - 10s - loss: 3.2756 - accuracy1000: 0.3670 - val_loss: 3.3009 - val_accuracy1000: 0.3542 - 10s/epoch - 29ms/step
Epoch 16/50
358/358 - 10s - loss: 3.2754 - accuracy1000: 0.3675 - val_loss: 3.2993 - val_accuracy1000: 0.3549 - 10s/epoch - 29ms/step
Epoch 17/50
358/358 - 10s - loss: 3.2728 - accuracy1000: 0.3702 - val_loss: 3.2984 - val_accuracy1000: 0.3592 - 10s/epoch - 28ms/step
Epoch 18/50
358/358 - 10s - loss: 3.2719 - accuracy1000: 0.3720 - val_loss: 3.3023 - val_accuracy1000: 0.3631 - 10s/epoch - 28ms/step
Epoch 19/50
358/358 - 10s - loss: 3.2700 - accuracy1000: 0.3722 - val_loss: 3.3084 - val_accuracy1000: 0.3513 - 10s/epoch - 28ms/step
Epoch 20/50
358/358 - 10s - loss: 3.2681 - accuracy1000: 0.3756 - val_loss: 3.3056 - val_accuracy1000: 0.3522 - 10s/epoch - 28ms/step
Epoch 21/50
358/358 - 10s - loss: 3.2667 - accuracy1000: 0.3754 - val_loss: 3.3121 - val_accuracy1000: 0.3527 - 10s/epoch - 28ms/step
Epoch 22/50
358/358 - 10s - loss: 3.2671 - accuracy1000: 0.3772 - val_loss: 3.3001 - val_accuracy1000: 0.3582 - 10s/epoch - 28ms/step
testing model: results/CHTR/W8/deepVOL_L2/h1000
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0971081
{'0': {'precision': 0.30304717956878036, 'recall': 0.07755031404925025, 'f1-score': 0.12349741835601559, 'support': 98233}, '1': {'precision': 0.37439180052320953, 'recall': 0.5322403880704276, 'f1-score': 0.4395750332005312, 'support': 111320}, '2': {'precision': 0.3554816763215341, 'recall': 0.4453517587939699, 'f1-score': 0.3953740761235582, 'support': 103480}, 'accuracy': 0.36083096670319104, 'macro avg': {'precision': 0.34430688547117466, 'recall': 0.35171415363788255, 'f1-score': 0.31948217589336836, 'support': 313033}, 'weighted avg': {'precision': 0.3457519580701588, 'recall': 0.36083096670319104, 'f1-score': 0.3257749949382826, 'support': 313033}}
[[ 7618 50333 40282]
 [ 8797 59249 43274]
 [ 8723 48672 46085]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0949395
{'0': {'precision': 0.3589199029126214, 'recall': 0.07927360450311599, 'f1-score': 0.12986442724628133, 'support': 29846}, '1': {'precision': 0.3586164783879269, 'recall': 0.5445393734684416, 'f1-score': 0.4324409614474307, 'support': 30198}, '2': {'precision': 0.3630718702691607, 'recall': 0.450996015936255, 'f1-score': 0.40228577926877807, 'support': 31375}, 'accuracy': 0.36053774379505354, 'macro avg': {'precision': 0.3602027505232363, 'recall': 0.3582696646359375, 'f1-score': 0.32153038932083006, 'support': 91419}, 'weighted avg': {'precision': 0.3602446293044513, 'recall': 0.36053774379505354, 'f1-score': 0.3233080888430188, 'support': 91419}}
[[ 2366 14359 13121]
 [ 2052 16444 11702]
 [ 2174 15051 14150]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.096081
{'0': {'precision': 0.31858902575587905, 'recall': 0.07003076923076923, 'f1-score': 0.11482191504389062, 'support': 8125}, '1': {'precision': 0.400676246830093, 'recall': 0.5561006825938567, 'f1-score': 0.46576443789360855, 'support': 9376}, '2': {'precision': 0.3240271536475762, 'recall': 0.4368957071032616, 'f1-score': 0.3720904699165569, 'support': 7757}, 'accuracy': 0.36313247287987965, 'macro avg': {'precision': 0.34776414207784945, 'recall': 0.3543423863092958, 'f1-score': 0.317558940951352, 'support': 25258}, 'weighted avg': {'precision': 0.350730657826816, 'recall': 0.36313247287987965, 'f1-score': 0.3241048857615336, 'support': 25258}}
[[ 569 4000 3556]
 [ 648 5214 3514]
 [ 569 3799 3389]]
training model: results/CHTR/W8/deepVOL_L3/h10
Epoch 1/50
358/358 - 17s - loss: 3.3253 - accuracy10: 0.3498 - val_loss: 3.4080 - val_accuracy10: 0.3292 - 17s/epoch - 47ms/step
Epoch 2/50
358/358 - 15s - loss: 3.3152 - accuracy10: 0.3490 - val_loss: 3.3437 - val_accuracy10: 0.3254 - 15s/epoch - 41ms/step
Epoch 3/50
358/358 - 14s - loss: 3.3012 - accuracy10: 0.3490 - val_loss: 3.3155 - val_accuracy10: 0.3266 - 14s/epoch - 40ms/step
Epoch 4/50
358/358 - 14s - loss: 3.2912 - accuracy10: 0.3555 - val_loss: 3.3040 - val_accuracy10: 0.3457 - 14s/epoch - 39ms/step
Epoch 5/50
358/358 - 14s - loss: 3.2862 - accuracy10: 0.3656 - val_loss: 3.3114 - val_accuracy10: 0.3410 - 14s/epoch - 39ms/step
Epoch 6/50
358/358 - 14s - loss: 3.2800 - accuracy10: 0.3733 - val_loss: 3.3340 - val_accuracy10: 0.3448 - 14s/epoch - 39ms/step
Epoch 7/50
358/358 - 14s - loss: 3.2782 - accuracy10: 0.3732 - val_loss: 3.3002 - val_accuracy10: 0.3514 - 14s/epoch - 39ms/step
Epoch 8/50
358/358 - 14s - loss: 3.2719 - accuracy10: 0.3768 - val_loss: 3.2902 - val_accuracy10: 0.3571 - 14s/epoch - 40ms/step
Epoch 9/50
358/358 - 14s - loss: 3.2679 - accuracy10: 0.3813 - val_loss: 3.2985 - val_accuracy10: 0.3543 - 14s/epoch - 39ms/step
Epoch 10/50
358/358 - 14s - loss: 3.2657 - accuracy10: 0.3816 - val_loss: 3.2898 - val_accuracy10: 0.3575 - 14s/epoch - 39ms/step
Epoch 11/50
358/358 - 14s - loss: 3.2591 - accuracy10: 0.3851 - val_loss: 3.3043 - val_accuracy10: 0.3531 - 14s/epoch - 39ms/step
Epoch 12/50
358/358 - 14s - loss: 3.2563 - accuracy10: 0.3878 - val_loss: 3.3002 - val_accuracy10: 0.3573 - 14s/epoch - 39ms/step
Epoch 13/50
358/358 - 14s - loss: 3.2529 - accuracy10: 0.3887 - val_loss: 3.2950 - val_accuracy10: 0.3602 - 14s/epoch - 39ms/step
Epoch 14/50
358/358 - 14s - loss: 3.2489 - accuracy10: 0.3900 - val_loss: 3.2939 - val_accuracy10: 0.3582 - 14s/epoch - 39ms/step
Epoch 15/50
358/358 - 14s - loss: 3.2478 - accuracy10: 0.3919 - val_loss: 3.2958 - val_accuracy10: 0.3602 - 14s/epoch - 39ms/step
Epoch 16/50
358/358 - 14s - loss: 3.2476 - accuracy10: 0.3909 - val_loss: 3.2994 - val_accuracy10: 0.3612 - 14s/epoch - 40ms/step
Epoch 17/50
358/358 - 14s - loss: 3.2428 - accuracy10: 0.3936 - val_loss: 3.3021 - val_accuracy10: 0.3599 - 14s/epoch - 40ms/step
Epoch 18/50
358/358 - 14s - loss: 3.2389 - accuracy10: 0.3973 - val_loss: 3.3003 - val_accuracy10: 0.3638 - 14s/epoch - 40ms/step
Epoch 19/50
358/358 - 14s - loss: 3.2378 - accuracy10: 0.3976 - val_loss: 3.3008 - val_accuracy10: 0.3650 - 14s/epoch - 40ms/step
Epoch 20/50
358/358 - 14s - loss: 3.2339 - accuracy10: 0.3975 - val_loss: 3.2946 - val_accuracy10: 0.3641 - 14s/epoch - 40ms/step
testing model: results/CHTR/W8/deepVOL_L3/h10
Evaluating performance on  test set...
1223/1223 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0938028
{'0': {'precision': 0.3657205747856955, 'recall': 0.2303846416748855, 'f1-score': 0.28268970392647885, 'support': 102407}, '1': {'precision': 0.36512324241115846, 'recall': 0.7168895072933849, 'f1-score': 0.4838261313001595, 'support': 108523}, '2': {'precision': 0.38715228798736107, 'recall': 0.13440349451044534, 'f1-score': 0.19953616529382254, 'support': 102103}, 'accuracy': 0.36774078132337484, 'macro avg': {'precision': 0.3726653683947383, 'recall': 0.36055921449290523, 'f1-score': 0.3220173335068203, 'support': 313033}, 'weighted avg': {'precision': 0.3725039423915, 'recall': 0.36774078132337484, 'f1-score': 0.32529768057067876, 'support': 313033}}
[[23593 67643 11171]
 [20172 77799 10552]
 [20746 67634 13723]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.091725
{'0': {'precision': 0.4109548570077996, 'recall': 0.22029013049537566, 'f1-score': 0.28682777961068956, 'support': 31572}, '1': {'precision': 0.35456088514490475, 'recall': 0.7491532177724647, 'f1-score': 0.48132107273153973, 'support': 30114}, '2': {'precision': 0.40471151191681237, 'recall': 0.1479164564625164, 'f1-score': 0.21665024630541874, 'support': 29733}, 'accuracy': 0.37096227261291415, 'macro avg': {'precision': 0.3900757513565056, 'recall': 0.37245326824345226, 'f1-score': 0.3282663662158827, 'support': 91419}, 'weighted avg': {'precision': 0.3903477463604556, 'recall': 0.37096227261291415, 'f1-score': 0.32807065506629135, 'support': 91419}}
[[ 6955 21156  3461]
 [ 4546 22560  3008]
 [ 5423 19912  4398]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0956045
{'0': {'precision': 0.38118410381184104, 'recall': 0.22014051522248243, 'f1-score': 0.27909738717339666, 'support': 8540}, '1': {'precision': 0.34234181648377304, 'recall': 0.7193671041334478, 'f1-score': 0.46391140992683405, 'support': 8153}, '2': {'precision': 0.408891671884784, 'recall': 0.1524810274372446, 'f1-score': 0.22212773194999574, 'support': 8565}, 'accuracy': 0.3583419114735925, 'macro avg': {'precision': 0.37747253072679937, 'recall': 0.363996215597725, 'f1-score': 0.3217121763500755, 'support': 25258}, 'weighted avg': {'precision': 0.3780418974597553, 'recall': 0.3583419114735925, 'f1-score': 0.3194348497801092, 'support': 25258}}
[[1880 5693  967]
 [1367 5865  921]
 [1685 5574 1306]]
training model: results/CHTR/W8/deepVOL_L3/h20
Epoch 1/50
358/358 - 17s - loss: 3.3268 - accuracy20: 0.3493 - val_loss: 3.3758 - val_accuracy20: 0.3381 - 17s/epoch - 47ms/step
Epoch 2/50
358/358 - 14s - loss: 3.3013 - accuracy20: 0.3575 - val_loss: 3.3600 - val_accuracy20: 0.3359 - 14s/epoch - 40ms/step
Epoch 3/50
358/358 - 14s - loss: 3.2920 - accuracy20: 0.3611 - val_loss: 3.3511 - val_accuracy20: 0.3349 - 14s/epoch - 40ms/step
Epoch 4/50
358/358 - 14s - loss: 3.2890 - accuracy20: 0.3625 - val_loss: 3.3279 - val_accuracy20: 0.3402 - 14s/epoch - 40ms/step
Epoch 5/50
358/358 - 14s - loss: 3.2840 - accuracy20: 0.3669 - val_loss: 3.3247 - val_accuracy20: 0.3453 - 14s/epoch - 40ms/step
Epoch 6/50
358/358 - 14s - loss: 3.2802 - accuracy20: 0.3702 - val_loss: 3.3169 - val_accuracy20: 0.3511 - 14s/epoch - 40ms/step
Epoch 7/50
358/358 - 14s - loss: 3.2735 - accuracy20: 0.3769 - val_loss: 3.3191 - val_accuracy20: 0.3456 - 14s/epoch - 40ms/step
Epoch 8/50
358/358 - 15s - loss: 3.2717 - accuracy20: 0.3781 - val_loss: 3.3040 - val_accuracy20: 0.3560 - 15s/epoch - 41ms/step
Epoch 9/50
358/358 - 14s - loss: 3.2699 - accuracy20: 0.3765 - val_loss: 3.2987 - val_accuracy20: 0.3591 - 14s/epoch - 40ms/step
Epoch 10/50
358/358 - 14s - loss: 3.2669 - accuracy20: 0.3795 - val_loss: 3.3006 - val_accuracy20: 0.3616 - 14s/epoch - 40ms/step
Epoch 11/50
358/358 - 14s - loss: 3.2637 - accuracy20: 0.3821 - val_loss: 3.3038 - val_accuracy20: 0.3605 - 14s/epoch - 39ms/step
Epoch 12/50
358/358 - 14s - loss: 3.2587 - accuracy20: 0.3851 - val_loss: 3.2944 - val_accuracy20: 0.3657 - 14s/epoch - 40ms/step
Epoch 13/50
358/358 - 15s - loss: 3.2594 - accuracy20: 0.3870 - val_loss: 3.2983 - val_accuracy20: 0.3642 - 15s/epoch - 41ms/step
Epoch 14/50
358/358 - 14s - loss: 3.2536 - accuracy20: 0.3897 - val_loss: 3.3035 - val_accuracy20: 0.3644 - 14s/epoch - 40ms/step
Epoch 15/50
358/358 - 14s - loss: 3.2529 - accuracy20: 0.3895 - val_loss: 3.3030 - val_accuracy20: 0.3676 - 14s/epoch - 39ms/step
Epoch 16/50
358/358 - 14s - loss: 3.2496 - accuracy20: 0.3902 - val_loss: 3.2975 - val_accuracy20: 0.3645 - 14s/epoch - 39ms/step
Epoch 17/50
358/358 - 14s - loss: 3.2459 - accuracy20: 0.3925 - val_loss: 3.3030 - val_accuracy20: 0.3626 - 14s/epoch - 40ms/step
Epoch 18/50
358/358 - 15s - loss: 3.2444 - accuracy20: 0.3967 - val_loss: 3.2953 - val_accuracy20: 0.3691 - 15s/epoch - 41ms/step
Epoch 19/50
358/358 - 15s - loss: 3.2418 - accuracy20: 0.3951 - val_loss: 3.2997 - val_accuracy20: 0.3660 - 15s/epoch - 42ms/step
Epoch 20/50
358/358 - 15s - loss: 3.2418 - accuracy20: 0.3957 - val_loss: 3.2994 - val_accuracy20: 0.3668 - 15s/epoch - 42ms/step
Epoch 21/50
358/358 - 14s - loss: 3.2350 - accuracy20: 0.3986 - val_loss: 3.3074 - val_accuracy20: 0.3642 - 14s/epoch - 39ms/step
Epoch 22/50
358/358 - 16s - loss: 3.2326 - accuracy20: 0.4013 - val_loss: 3.2986 - val_accuracy20: 0.3650 - 16s/epoch - 44ms/step
testing model: results/CHTR/W8/deepVOL_L3/h20
Evaluating performance on  test set...
1223/1223 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.095782
{'0': {'precision': 0.36735306791324446, 'recall': 0.26967466114530014, 'f1-score': 0.3110251236837014, 'support': 104322}, '1': {'precision': 0.36677046492684284, 'recall': 0.6591585052859803, 'f1-score': 0.4712994339053903, 'support': 107927}, '2': {'precision': 0.3838856981451841, 'recall': 0.1618213208445785, 'f1-score': 0.22767121757824496, 'support': 100784}, 'accuracy': 0.3692358313660221, 'macro avg': {'precision': 0.37266974366175715, 'recall': 0.36355149575861967, 'f1-score': 0.33666525838911227, 'support': 313033}, 'weighted avg': {'precision': 0.3724750391200579, 'recall': 0.3692358313660221, 'f1-score': 0.33944763954101964, 'support': 313033}}
[[28133 63142 13047]
 [23658 71141 13128]
 [24792 59683 16309]]
Evaluating performance on  train set...
358/358 - 9s - 9s/epoch - 24ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0919102
{'0': {'precision': 0.40459435005529304, 'recall': 0.25580804068012075, 'f1-score': 0.31344068225627447, 'support': 31465}, '1': {'precision': 0.35921818119960536, 'recall': 0.7016780196045855, 'f1-score': 0.475174671752118, 'support': 30095}, '2': {'precision': 0.414396734437554, 'recall': 0.17679761545932549, 'f1-score': 0.24785201183154137, 'support': 29859}, 'accuracy': 0.3767816318270819, 'macro avg': {'precision': 0.3927364218974841, 'recall': 0.37809455858134394, 'f1-score': 0.34548912194664466, 'support': 91419}, 'weighted avg': {'precision': 0.39285820760742124, 'recall': 0.3767816318270819, 'f1-score': 0.34526089800645005, 'support': 91419}}
[[ 8049 19501  3915]
 [ 5433 21117  3545]
 [ 6412 18168  5279]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 24ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0980278
{'0': {'precision': 0.3852706299911269, 'recall': 0.2521779533046811, 'f1-score': 0.30483010390339793, 'support': 8609}, '1': {'precision': 0.35005383494838177, 'recall': 0.6664656939587604, 'f1-score': 0.4590150319740885, 'support': 8293}, '2': {'precision': 0.38706311945748567, 'recall': 0.17759693633317378, 'f1-score': 0.2434782608695652, 'support': 8356}, 'accuracy': 0.3635283870456885, 'macro avg': {'precision': 0.37412919479899814, 'recall': 0.36541352786553843, 'f1-score': 0.3357744655823505, 'support': 25258}, 'weighted avg': {'precision': 0.3743008446039786, 'recall': 0.3635283870456885, 'f1-score': 0.33515711348846133, 'support': 25258}}
[[2171 5235 1203]
 [1619 5527 1147]
 [1845 5027 1484]]
training model: results/CHTR/W8/deepVOL_L3/h30
Epoch 1/50
358/358 - 17s - loss: 3.3232 - accuracy30: 0.3552 - val_loss: 3.4039 - val_accuracy30: 0.3321 - 17s/epoch - 47ms/step
Epoch 2/50
358/358 - 14s - loss: 3.3092 - accuracy30: 0.3573 - val_loss: 3.3865 - val_accuracy30: 0.3333 - 14s/epoch - 40ms/step
Epoch 3/50
358/358 - 14s - loss: 3.2981 - accuracy30: 0.3596 - val_loss: 3.3462 - val_accuracy30: 0.3378 - 14s/epoch - 40ms/step
Epoch 4/50
358/358 - 14s - loss: 3.2907 - accuracy30: 0.3620 - val_loss: 3.3525 - val_accuracy30: 0.3420 - 14s/epoch - 40ms/step
Epoch 5/50
358/358 - 14s - loss: 3.2890 - accuracy30: 0.3618 - val_loss: 3.3608 - val_accuracy30: 0.3408 - 14s/epoch - 40ms/step
Epoch 6/50
358/358 - 14s - loss: 3.2849 - accuracy30: 0.3647 - val_loss: 3.3376 - val_accuracy30: 0.3422 - 14s/epoch - 40ms/step
Epoch 7/50
358/358 - 14s - loss: 3.2835 - accuracy30: 0.3687 - val_loss: 3.3437 - val_accuracy30: 0.3443 - 14s/epoch - 40ms/step
Epoch 8/50
358/358 - 14s - loss: 3.2824 - accuracy30: 0.3687 - val_loss: 3.3252 - val_accuracy30: 0.3442 - 14s/epoch - 40ms/step
Epoch 9/50
358/358 - 14s - loss: 3.2792 - accuracy30: 0.3706 - val_loss: 3.3147 - val_accuracy30: 0.3442 - 14s/epoch - 40ms/step
Epoch 10/50
358/358 - 14s - loss: 3.2778 - accuracy30: 0.3720 - val_loss: 3.3128 - val_accuracy30: 0.3440 - 14s/epoch - 39ms/step
Epoch 11/50
358/358 - 14s - loss: 3.2756 - accuracy30: 0.3729 - val_loss: 3.3178 - val_accuracy30: 0.3451 - 14s/epoch - 40ms/step
Epoch 12/50
358/358 - 14s - loss: 3.2739 - accuracy30: 0.3753 - val_loss: 3.3153 - val_accuracy30: 0.3465 - 14s/epoch - 40ms/step
Epoch 13/50
358/358 - 15s - loss: 3.2723 - accuracy30: 0.3760 - val_loss: 3.3151 - val_accuracy30: 0.3453 - 15s/epoch - 41ms/step
Epoch 14/50
358/358 - 15s - loss: 3.2716 - accuracy30: 0.3757 - val_loss: 3.3067 - val_accuracy30: 0.3476 - 15s/epoch - 41ms/step
Epoch 15/50
358/358 - 14s - loss: 3.2687 - accuracy30: 0.3786 - val_loss: 3.3097 - val_accuracy30: 0.3519 - 14s/epoch - 40ms/step
Epoch 16/50
358/358 - 14s - loss: 3.2674 - accuracy30: 0.3788 - val_loss: 3.3106 - val_accuracy30: 0.3497 - 14s/epoch - 39ms/step
Epoch 17/50
358/358 - 14s - loss: 3.2644 - accuracy30: 0.3828 - val_loss: 3.3137 - val_accuracy30: 0.3441 - 14s/epoch - 39ms/step
Epoch 18/50
358/358 - 14s - loss: 3.2622 - accuracy30: 0.3816 - val_loss: 3.3149 - val_accuracy30: 0.3498 - 14s/epoch - 39ms/step
Epoch 19/50
358/358 - 14s - loss: 3.2601 - accuracy30: 0.3838 - val_loss: 3.3171 - val_accuracy30: 0.3463 - 14s/epoch - 40ms/step
Epoch 20/50
358/358 - 14s - loss: 3.2605 - accuracy30: 0.3831 - val_loss: 3.3194 - val_accuracy30: 0.3480 - 14s/epoch - 39ms/step
Epoch 21/50
358/358 - 14s - loss: 3.2564 - accuracy30: 0.3866 - val_loss: 3.3185 - val_accuracy30: 0.3493 - 14s/epoch - 40ms/step
Epoch 22/50
358/358 - 14s - loss: 3.2546 - accuracy30: 0.3887 - val_loss: 3.3104 - val_accuracy30: 0.3492 - 14s/epoch - 39ms/step
Epoch 23/50
358/358 - 14s - loss: 3.2545 - accuracy30: 0.3875 - val_loss: 3.3165 - val_accuracy30: 0.3519 - 14s/epoch - 39ms/step
Epoch 24/50
358/358 - 14s - loss: 3.2491 - accuracy30: 0.3897 - val_loss: 3.3145 - val_accuracy30: 0.3533 - 14s/epoch - 39ms/step
testing model: results/CHTR/W8/deepVOL_L3/h30
Evaluating performance on  test set...
1223/1223 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1023444
{'0': {'precision': 0.3600412049948494, 'recall': 0.13480588141221625, 'f1-score': 0.19616432355477678, 'support': 106301}, '1': {'precision': 0.34707481949381547, 'recall': 0.765924225892622, 'f1-score': 0.4776877636140719, 'support': 106316}, '2': {'precision': 0.36287356917180297, 'recall': 0.13953951561504144, 'f1-score': 0.20156800690498455, 'support': 100416}, 'accuracy': 0.3506722933364853, 'macro avg': {'precision': 0.3566631978868226, 'recall': 0.3467565409732933, 'f1-score': 0.29180669802461107, 'support': 313033}, 'weighted avg': {'precision': 0.3565459838528772, 'recall': 0.3506722933364853, 'f1-score': 0.29351208663610845, 'support': 313033}}
[[14330 79691 12280]
 [12564 81430 12322]
 [12907 73497 14012]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0987248
{'0': {'precision': 0.40101703987866893, 'recall': 0.1432578002995825, 'f1-score': 0.21110224017282675, 'support': 31377}, '1': {'precision': 0.34278275115557894, 'recall': 0.7801970968171528, 'f1-score': 0.47630081300813004, 'support': 30036}, '2': {'precision': 0.39802464967077494, 'recall': 0.15713523961874293, 'f1-score': 0.22531778648571157, 'support': 30006}, 'accuracy': 0.35708113193099905, 'macro avg': {'precision': 0.38060814690167427, 'recall': 0.3601967122451594, 'f1-score': 0.3042402798888894, 'support': 91419}, 'weighted avg': {'precision': 0.3809018039138827, 'recall': 0.35708113193099905, 'f1-score': 0.3028999629257073, 'support': 91419}}
[[ 4495 23169  3713]
 [ 3184 23434  3418]
 [ 3530 21761  4715]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1030676
{'0': {'precision': 0.37155252556554075, 'recall': 0.13885350318471337, 'f1-score': 0.20215815208227955, 'support': 8635}, '1': {'precision': 0.3417428725121033, 'recall': 0.7578432542049386, 'f1-score': 0.4710636562488414, 'support': 8383}, '2': {'precision': 0.3679163034001744, 'recall': 0.15364077669902912, 'f1-score': 0.21676226350483688, 'support': 8240}, 'accuracy': 0.34911711141024626, 'macro avg': {'precision': 0.3604039004926061, 'recall': 0.35011251136289373, 'f1-score': 0.2966613572786526, 'support': 25258}, 'weighted avg': {'precision': 0.36047259872297266, 'recall': 0.34911711141024626, 'f1-score': 0.2961708498235956, 'support': 25258}}
[[1199 6331 1105]
 [ 960 6353 1070]
 [1068 5906 1266]]
training model: results/CHTR/W8/deepVOL_L3/h50
Epoch 1/50
358/358 - 17s - loss: 3.3319 - accuracy50: 0.3502 - val_loss: 3.4027 - val_accuracy50: 0.3396 - 17s/epoch - 48ms/step
Epoch 2/50
358/358 - 14s - loss: 3.3058 - accuracy50: 0.3556 - val_loss: 3.4229 - val_accuracy50: 0.3376 - 14s/epoch - 40ms/step
Epoch 3/50
358/358 - 14s - loss: 3.2982 - accuracy50: 0.3533 - val_loss: 3.3801 - val_accuracy50: 0.3385 - 14s/epoch - 40ms/step
Epoch 4/50
358/358 - 14s - loss: 3.2957 - accuracy50: 0.3550 - val_loss: 3.3257 - val_accuracy50: 0.3382 - 14s/epoch - 40ms/step
Epoch 5/50
358/358 - 14s - loss: 3.2913 - accuracy50: 0.3567 - val_loss: 3.4838 - val_accuracy50: 0.3376 - 14s/epoch - 39ms/step
Epoch 6/50
358/358 - 14s - loss: 3.2908 - accuracy50: 0.3580 - val_loss: 3.3101 - val_accuracy50: 0.3381 - 14s/epoch - 40ms/step
Epoch 7/50
358/358 - 14s - loss: 3.2892 - accuracy50: 0.3576 - val_loss: 3.3099 - val_accuracy50: 0.3427 - 14s/epoch - 40ms/step
Epoch 8/50
358/358 - 14s - loss: 3.2852 - accuracy50: 0.3600 - val_loss: 3.3317 - val_accuracy50: 0.3381 - 14s/epoch - 39ms/step
Epoch 9/50
358/358 - 14s - loss: 3.2866 - accuracy50: 0.3611 - val_loss: 3.3058 - val_accuracy50: 0.3429 - 14s/epoch - 40ms/step
Epoch 10/50
358/358 - 14s - loss: 3.2863 - accuracy50: 0.3599 - val_loss: 3.3458 - val_accuracy50: 0.3385 - 14s/epoch - 40ms/step
Epoch 11/50
358/358 - 14s - loss: 3.2863 - accuracy50: 0.3621 - val_loss: 3.3125 - val_accuracy50: 0.3391 - 14s/epoch - 40ms/step
Epoch 12/50
358/358 - 14s - loss: 3.2840 - accuracy50: 0.3626 - val_loss: 3.3136 - val_accuracy50: 0.3389 - 14s/epoch - 40ms/step
Epoch 13/50
358/358 - 14s - loss: 3.2829 - accuracy50: 0.3618 - val_loss: 3.3133 - val_accuracy50: 0.3395 - 14s/epoch - 39ms/step
Epoch 14/50
358/358 - 15s - loss: 3.2808 - accuracy50: 0.3646 - val_loss: 3.3275 - val_accuracy50: 0.3407 - 15s/epoch - 42ms/step
Epoch 15/50
358/358 - 14s - loss: 3.2792 - accuracy50: 0.3667 - val_loss: 3.3125 - val_accuracy50: 0.3416 - 14s/epoch - 40ms/step
Epoch 16/50
358/358 - 14s - loss: 3.2783 - accuracy50: 0.3675 - val_loss: 3.3257 - val_accuracy50: 0.3413 - 14s/epoch - 40ms/step
Epoch 17/50
358/358 - 15s - loss: 3.2775 - accuracy50: 0.3687 - val_loss: 3.3191 - val_accuracy50: 0.3410 - 15s/epoch - 41ms/step
Epoch 18/50
358/358 - 15s - loss: 3.2741 - accuracy50: 0.3708 - val_loss: 3.3309 - val_accuracy50: 0.3439 - 15s/epoch - 41ms/step
Epoch 19/50
358/358 - 14s - loss: 3.2741 - accuracy50: 0.3717 - val_loss: 3.3388 - val_accuracy50: 0.3435 - 14s/epoch - 39ms/step
testing model: results/CHTR/W8/deepVOL_L3/h50
Evaluating performance on  test set...
1223/1223 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1014168
{'0': {'precision': 0.35214138061548317, 'recall': 0.11446661114476075, 'f1-score': 0.17277213933190966, 'support': 105664}, '1': {'precision': 0.35093362165862235, 'recall': 0.8257014220611651, 'f1-score': 0.49253401383752515, 'support': 109278}, '2': {'precision': 0.32810978719458483, 'recall': 0.072147291800471, 'f1-score': 0.11828514123349493, 'support': 98091}, 'accuracy': 0.3494935038797826, 'macro avg': {'precision': 0.3437282631562301, 'recall': 0.337438441668799, 'f1-score': 0.2611970981343099, 'support': 313033}, 'weighted avg': {'precision': 0.34418929724555997, 'recall': 0.3494935038797826, 'f1-score': 0.26732528226493285, 'support': 313033}}
[[12095 86612  6957]
 [11512 90231  7535]
 [10740 80274  7077]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1022792
{'0': {'precision': 0.38070250588991217, 'recall': 0.11378548794930064, 'f1-score': 0.17520514526502548, 'support': 31243}, '1': {'precision': 0.3373153346872138, 'recall': 0.8400714025982612, 'f1-score': 0.4813524007955299, 'support': 30251}, '2': {'precision': 0.3733313556808069, 'recall': 0.08411027568922305, 'f1-score': 0.1372896610030818, 'support': 29925}, 'accuracy': 0.3444032422144193, 'macro avg': {'precision': 0.363783065419311, 'recall': 0.3459890554122616, 'f1-score': 0.26461573568787905, 'support': 91419}, 'weighted avg': {'precision': 0.3639326113815463, 'recall': 0.3444032422144193, 'f1-score': 0.2640995737811394, 'support': 91419}}
[[ 3555 25580  2108]
 [ 2721 25413  2117]
 [ 3062 24346  2517]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1031293
{'0': {'precision': 0.36799410029498525, 'recall': 0.1167387998596327, 'f1-score': 0.17724891217476246, 'support': 8549}, '1': {'precision': 0.3404296779850928, 'recall': 0.8212480902573746, 'f1-score': 0.4813335170133627, 'support': 8509}, '2': {'precision': 0.3452204061416543, 'recall': 0.085, 'f1-score': 0.1364125648302182, 'support': 8200}, 'accuracy': 0.34377227017182677, 'macro avg': {'precision': 0.35121472814057747, 'recall': 0.3409956300390024, 'f1-score': 0.2649983313394478, 'support': 25258}, 'weighted avg': {'precision': 0.3513146339282029, 'recall': 0.34377227017182677, 'f1-score': 0.2664324522153986, 'support': 25258}}
[[ 998 6915  636]
 [ 835 6988  686]
 [ 879 6624  697]]
training model: results/CHTR/W8/deepVOL_L3/h100
Epoch 1/50
358/358 - 17s - loss: 3.3320 - accuracy100: 0.3495 - val_loss: 3.3936 - val_accuracy100: 0.3408 - 17s/epoch - 47ms/step
Epoch 2/50
358/358 - 14s - loss: 3.3026 - accuracy100: 0.3523 - val_loss: 3.4121 - val_accuracy100: 0.3420 - 14s/epoch - 39ms/step
Epoch 3/50
358/358 - 14s - loss: 3.2962 - accuracy100: 0.3565 - val_loss: 3.3982 - val_accuracy100: 0.3420 - 14s/epoch - 39ms/step
Epoch 4/50
358/358 - 15s - loss: 3.2956 - accuracy100: 0.3540 - val_loss: 3.3671 - val_accuracy100: 0.3414 - 15s/epoch - 43ms/step
Epoch 5/50
358/358 - 15s - loss: 3.2917 - accuracy100: 0.3565 - val_loss: 3.3539 - val_accuracy100: 0.3418 - 15s/epoch - 43ms/step
Epoch 6/50
358/358 - 15s - loss: 3.2937 - accuracy100: 0.3560 - val_loss: 3.3514 - val_accuracy100: 0.3423 - 15s/epoch - 43ms/step
Epoch 7/50
358/358 - 14s - loss: 3.2926 - accuracy100: 0.3562 - val_loss: 3.3232 - val_accuracy100: 0.3426 - 14s/epoch - 40ms/step
Epoch 8/50
358/358 - 14s - loss: 3.2913 - accuracy100: 0.3564 - val_loss: 3.3320 - val_accuracy100: 0.3427 - 14s/epoch - 39ms/step
Epoch 9/50
358/358 - 14s - loss: 3.2914 - accuracy100: 0.3547 - val_loss: 3.3187 - val_accuracy100: 0.3425 - 14s/epoch - 39ms/step
Epoch 10/50
358/358 - 14s - loss: 3.2896 - accuracy100: 0.3549 - val_loss: 3.3422 - val_accuracy100: 0.3431 - 14s/epoch - 39ms/step
Epoch 11/50
358/358 - 14s - loss: 3.2897 - accuracy100: 0.3546 - val_loss: 3.3568 - val_accuracy100: 0.3425 - 14s/epoch - 39ms/step
Epoch 12/50
358/358 - 14s - loss: 3.2893 - accuracy100: 0.3548 - val_loss: 3.3312 - val_accuracy100: 0.3429 - 14s/epoch - 39ms/step
Epoch 13/50
358/358 - 14s - loss: 3.2879 - accuracy100: 0.3557 - val_loss: 3.3530 - val_accuracy100: 0.3421 - 14s/epoch - 39ms/step
Epoch 14/50
358/358 - 14s - loss: 3.2878 - accuracy100: 0.3563 - val_loss: 3.3190 - val_accuracy100: 0.3427 - 14s/epoch - 39ms/step
Epoch 15/50
358/358 - 14s - loss: 3.2859 - accuracy100: 0.3587 - val_loss: 3.3218 - val_accuracy100: 0.3420 - 14s/epoch - 39ms/step
Epoch 16/50
358/358 - 14s - loss: 3.2843 - accuracy100: 0.3609 - val_loss: 3.3393 - val_accuracy100: 0.3428 - 14s/epoch - 40ms/step
Epoch 17/50
358/358 - 14s - loss: 3.2839 - accuracy100: 0.3621 - val_loss: 3.3233 - val_accuracy100: 0.3414 - 14s/epoch - 40ms/step
Epoch 18/50
358/358 - 14s - loss: 3.2839 - accuracy100: 0.3612 - val_loss: 3.3490 - val_accuracy100: 0.3424 - 14s/epoch - 40ms/step
Epoch 19/50
358/358 - 14s - loss: 3.2827 - accuracy100: 0.3645 - val_loss: 3.3443 - val_accuracy100: 0.3435 - 14s/epoch - 40ms/step
testing model: results/CHTR/W8/deepVOL_L3/h100
Evaluating performance on  test set...
1223/1223 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1023985
{'0': {'precision': 0.3080198722498226, 'recall': 0.004183737407817998, 'f1-score': 0.008255345050597277, 'support': 103735}, '1': {'precision': 0.36025981541142316, 'recall': 0.9796930530261506, 'f1-score': 0.5268006759888476, 'support': 113114}, '2': {'precision': 0.2912210892812733, 'recall': 0.012174582051068784, 'f1-score': 0.023372087221196543, 'support': 96184}, 'accuracy': 0.35913785447540675, 'macro avg': {'precision': 0.319833592314173, 'recall': 0.3320171241616791, 'f1-score': 0.18614270275354716, 'support': 313033}, 'weighted avg': {'precision': 0.321735023015826, 'recall': 0.35913785447540675, 'f1-score': 0.2002757559743215, 'support': 313033}}
[[   434 102164   1137]
 [   584 110817   1713]
 [   391  94622   1171]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1106474
{'0': {'precision': 0.37410071942446044, 'recall': 0.005047890240745535, 'f1-score': 0.00996136777242106, 'support': 30904}, '1': {'precision': 0.3299019717303441, 'recall': 0.9803583278035832, 'f1-score': 0.49367617329123015, 'support': 30140}, '2': {'precision': 0.3969359331476323, 'recall': 0.018765432098765432, 'f1-score': 0.03583666027474773, 'support': 30375}, 'accuracy': 0.33115654295059016, 'macro avg': {'precision': 0.36697954143414563, 'recall': 0.3347238833810314, 'f1-score': 0.1798247337794663, 'support': 91419}, 'weighted avg': {'precision': 0.36711605935752334, 'recall': 0.33115654295059016, 'f1-score': 0.17803503132261386, 'support': 91419}}
[[  156 30345   403]
 [  129 29548   463]
 [  132 29673   570]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1081113
{'0': {'precision': 0.3787878787878788, 'recall': 0.005884429798752501, 'f1-score': 0.01158882836945185, 'support': 8497}, '1': {'precision': 0.34318044049302887, 'recall': 0.9795824201176606, 'f1-score': 0.508289938349195, 'support': 8669}, '2': {'precision': 0.29133858267716534, 'recall': 0.013717251606524964, 'f1-score': 0.026200873362445417, 'support': 8092}, 'accuracy': 0.3425845276744002, 'macro avg': {'precision': 0.3377689673193576, 'recall': 0.3330613671743127, 'f1-score': 0.18202654669369742, 'support': 25258}, 'weighted avg': {'precision': 0.33855030705987393, 'recall': 0.3425845276744002, 'f1-score': 0.18674690068308306, 'support': 25258}}
[[  50 8317  130]
 [  37 8492  140]
 [  45 7936  111]]
training model: results/CHTR/W8/deepVOL_L3/h200
Epoch 1/50
358/358 - 16s - loss: 3.3262 - accuracy200: 0.3527 - val_loss: 3.4824 - val_accuracy200: 0.3399 - 16s/epoch - 46ms/step
Epoch 2/50
358/358 - 14s - loss: 3.3174 - accuracy200: 0.3435 - val_loss: 3.3206 - val_accuracy200: 0.3421 - 14s/epoch - 38ms/step
Epoch 3/50
358/358 - 14s - loss: 3.3083 - accuracy200: 0.3371 - val_loss: 3.3001 - val_accuracy200: 0.3406 - 14s/epoch - 38ms/step
Epoch 4/50
358/358 - 14s - loss: 3.3034 - accuracy200: 0.3377 - val_loss: 3.2987 - val_accuracy200: 0.3432 - 14s/epoch - 38ms/step
Epoch 5/50
358/358 - 14s - loss: 3.3010 - accuracy200: 0.3375 - val_loss: 3.2979 - val_accuracy200: 0.3438 - 14s/epoch - 38ms/step
Epoch 6/50
358/358 - 14s - loss: 3.2993 - accuracy200: 0.3411 - val_loss: 3.2974 - val_accuracy200: 0.3442 - 14s/epoch - 38ms/step
Epoch 7/50
358/358 - 14s - loss: 3.2981 - accuracy200: 0.3430 - val_loss: 3.3038 - val_accuracy200: 0.3426 - 14s/epoch - 38ms/step
Epoch 8/50
358/358 - 14s - loss: 3.2963 - accuracy200: 0.3450 - val_loss: 3.3090 - val_accuracy200: 0.3423 - 14s/epoch - 38ms/step
Epoch 9/50
358/358 - 14s - loss: 3.2950 - accuracy200: 0.3473 - val_loss: 3.3076 - val_accuracy200: 0.3418 - 14s/epoch - 38ms/step
Epoch 10/50
358/358 - 14s - loss: 3.2930 - accuracy200: 0.3511 - val_loss: 3.3174 - val_accuracy200: 0.3428 - 14s/epoch - 38ms/step
Epoch 11/50
358/358 - 15s - loss: 3.2924 - accuracy200: 0.3508 - val_loss: 3.3302 - val_accuracy200: 0.3425 - 15s/epoch - 41ms/step
Epoch 12/50
358/358 - 14s - loss: 3.2914 - accuracy200: 0.3521 - val_loss: 3.3547 - val_accuracy200: 0.3427 - 14s/epoch - 38ms/step
Epoch 13/50
358/358 - 14s - loss: 3.2901 - accuracy200: 0.3545 - val_loss: 3.3448 - val_accuracy200: 0.3427 - 14s/epoch - 38ms/step
Epoch 14/50
358/358 - 13s - loss: 3.2883 - accuracy200: 0.3558 - val_loss: 3.3653 - val_accuracy200: 0.3427 - 13s/epoch - 38ms/step
Epoch 15/50
358/358 - 14s - loss: 3.2884 - accuracy200: 0.3566 - val_loss: 3.3590 - val_accuracy200: 0.3428 - 14s/epoch - 38ms/step
Epoch 16/50
358/358 - 14s - loss: 3.2852 - accuracy200: 0.3594 - val_loss: 3.3706 - val_accuracy200: 0.3426 - 14s/epoch - 38ms/step
testing model: results/CHTR/W8/deepVOL_L3/h200
Evaluating performance on  test set...
1223/1223 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096356
{'0': {'precision': 0.33691529709228824, 'recall': 0.15084562160263104, 'f1-score': 0.20838978880597517, 'support': 102469}, '1': {'precision': 0.365291781720485, 'recall': 0.820366253837197, 'f1-score': 0.5054965960511475, 'support': 113364}, '2': {'precision': 0.31566380133715377, 'recall': 0.04080246913580247, 'f1-score': 0.07226413031595058, 'support': 97200}, 'accuracy': 0.3591410490267799, 'macro avg': {'precision': 0.339290293383309, 'recall': 0.3373381148585435, 'f1-score': 0.26205017172435774, 'support': 313033}, 'weighted avg': {'precision': 0.3405929490203336, 'recall': 0.3591410490267799, 'f1-score': 0.2737177321579902, 'support': 313033}}
[[15457 82887  4125]
 [15891 93000  4473]
 [14530 78704  3966]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0997041
{'0': {'precision': 0.34421299691946605, 'recall': 0.1553870604595722, 'f1-score': 0.21411625148279953, 'support': 30202}, '1': {'precision': 0.33597483597483596, 'recall': 0.8217599471685653, 'f1-score': 0.47694975996320393, 'support': 30285}, '2': {'precision': 0.3290218270008084, 'recall': 0.039473684210526314, 'f1-score': 0.07049043096729497, 'support': 30932}, 'accuracy': 0.3369212089390608, 'macro avg': {'precision': 0.3364032199650368, 'recall': 0.33887356394622126, 'f1-score': 0.25385214747109947, 'support': 91419}, 'weighted avg': {'precision': 0.336343889052042, 'recall': 0.3369212089390608, 'f1-score': 0.2525905174903413, 'support': 91419}}
[[ 4693 24173  1336]
 [ 4244 24887  1154]
 [ 4697 25014  1221]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0993373
{'0': {'precision': 0.3526490066225166, 'recall': 0.15076088238763713, 'f1-score': 0.2112222130402446, 'support': 8477}, '1': {'precision': 0.3465691734056462, 'recall': 0.826061865189289, 'f1-score': 0.48828244925805897, 'support': 8664}, '2': {'precision': 0.34791454730417093, 'recall': 0.042133793273376866, 'f1-score': 0.07516483516483517, 'support': 8117}, 'accuracy': 0.34749386333043, 'macro avg': {'precision': 0.3490442424441112, 'recall': 0.3396521802834344, 'f1-score': 0.25822316582104626, 'support': 25258}, 'weighted avg': {'precision': 0.3490420194787215, 'recall': 0.34749386333043, 'f1-score': 0.2625355454646822, 'support': 25258}}
[[1278 6892  307]
 [1173 7157  334]
 [1173 6602  342]]
training model: results/CHTR/W8/deepVOL_L3/h300
Epoch 1/50
358/358 - 17s - loss: 3.3271 - accuracy300: 0.3571 - val_loss: 3.4358 - val_accuracy300: 0.3465 - 17s/epoch - 47ms/step
Epoch 2/50
358/358 - 14s - loss: 3.3044 - accuracy300: 0.3629 - val_loss: 3.4009 - val_accuracy300: 0.3519 - 14s/epoch - 39ms/step
Epoch 3/50
358/358 - 14s - loss: 3.3026 - accuracy300: 0.3551 - val_loss: 3.3132 - val_accuracy300: 0.3512 - 14s/epoch - 39ms/step
Epoch 4/50
358/358 - 14s - loss: 3.3014 - accuracy300: 0.3405 - val_loss: 3.2937 - val_accuracy300: 0.3520 - 14s/epoch - 38ms/step
Epoch 5/50
358/358 - 15s - loss: 3.2957 - accuracy300: 0.3487 - val_loss: 3.2916 - val_accuracy300: 0.3571 - 15s/epoch - 41ms/step
Epoch 6/50
358/358 - 15s - loss: 3.2930 - accuracy300: 0.3511 - val_loss: 3.2913 - val_accuracy300: 0.3562 - 15s/epoch - 41ms/step
Epoch 7/50
358/358 - 15s - loss: 3.2905 - accuracy300: 0.3526 - val_loss: 3.2918 - val_accuracy300: 0.3557 - 15s/epoch - 41ms/step
Epoch 8/50
358/358 - 14s - loss: 3.2893 - accuracy300: 0.3542 - val_loss: 3.2912 - val_accuracy300: 0.3579 - 14s/epoch - 38ms/step
Epoch 9/50
358/358 - 15s - loss: 3.2863 - accuracy300: 0.3589 - val_loss: 3.2983 - val_accuracy300: 0.3503 - 15s/epoch - 41ms/step
Epoch 10/50
358/358 - 14s - loss: 3.2866 - accuracy300: 0.3575 - val_loss: 3.2979 - val_accuracy300: 0.3524 - 14s/epoch - 40ms/step
Epoch 11/50
358/358 - 14s - loss: 3.2842 - accuracy300: 0.3604 - val_loss: 3.2985 - val_accuracy300: 0.3531 - 14s/epoch - 39ms/step
Epoch 12/50
358/358 - 14s - loss: 3.2826 - accuracy300: 0.3623 - val_loss: 3.3131 - val_accuracy300: 0.3522 - 14s/epoch - 39ms/step
Epoch 13/50
358/358 - 14s - loss: 3.2812 - accuracy300: 0.3611 - val_loss: 3.3070 - val_accuracy300: 0.3511 - 14s/epoch - 39ms/step
Epoch 14/50
358/358 - 14s - loss: 3.2795 - accuracy300: 0.3642 - val_loss: 3.3093 - val_accuracy300: 0.3514 - 14s/epoch - 38ms/step
Epoch 15/50
358/358 - 14s - loss: 3.2782 - accuracy300: 0.3647 - val_loss: 3.3116 - val_accuracy300: 0.3515 - 14s/epoch - 39ms/step
Epoch 16/50
358/358 - 14s - loss: 3.2776 - accuracy300: 0.3644 - val_loss: 3.3038 - val_accuracy300: 0.3533 - 14s/epoch - 38ms/step
Epoch 17/50
358/358 - 13s - loss: 3.2741 - accuracy300: 0.3685 - val_loss: 3.3089 - val_accuracy300: 0.3556 - 13s/epoch - 38ms/step
Epoch 18/50
358/358 - 14s - loss: 3.2731 - accuracy300: 0.3673 - val_loss: 3.3197 - val_accuracy300: 0.3513 - 14s/epoch - 38ms/step
testing model: results/CHTR/W8/deepVOL_L3/h300
Evaluating performance on  test set...
1223/1223 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0962387
{'0': {'precision': 0.3334992428173548, 'recall': 0.31169396743702676, 'f1-score': 0.3222281340809561, 'support': 101035}, '1': {'precision': 0.3697188947747282, 'recall': 0.7145124756995844, 'f1-score': 0.48729223302742253, 'support': 112138}, '2': {'precision': 0.3485169491525424, 'recall': 0.006589224914880833, 'f1-score': 0.012933915162951606, 'support': 99860}, 'accuracy': 0.3586650608721764, 'macro avg': {'precision': 0.35057836224820843, 'recall': 0.3442652226838307, 'f1-score': 0.27415142742377674, 'support': 313033}, 'weighted avg': {'precision': 0.3512649975008155, 'recall': 0.3586650608721764, 'f1-score': 0.2826918462982205, 'support': 313033}}
[[31492 68940   603]
 [31387 80124   627]
 [31550 67652   658]]
Evaluating performance on  train set...
358/358 - 8s - 8s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988666
{'0': {'precision': 0.34604579294844784, 'recall': 0.32887227580682843, 'f1-score': 0.3372405414192577, 'support': 29963}, '1': {'precision': 0.3462371456531853, 'recall': 0.7130773805590431, 'f1-score': 0.4661389431851315, 'support': 30266}, '2': {'precision': 0.36065573770491804, 'recall': 0.007053542802180186, 'f1-score': 0.013836477987421386, 'support': 31190}, 'accuracy': 0.34627375053325893, 'macro avg': {'precision': 0.3509795587688504, 'recall': 0.34966773305601734, 'f1-score': 0.2724053208639368, 'support': 91419}, 'weighted avg': {'precision': 0.3510937114108669, 'recall': 0.34627375053325893, 'f1-score': 0.26957699543217584, 'support': 91419}}
[[ 9854 19913   196]
 [ 8490 21582   194]
 [10132 20838   220]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0966057
{'0': {'precision': 0.3404283274208383, 'recall': 0.30823221508446347, 'f1-score': 0.32353124804894795, 'support': 8406}, '1': {'precision': 0.36549356223175966, 'recall': 0.7188519977490152, 'f1-score': 0.48459787556904393, 'support': 8885}, '2': {'precision': 0.313953488372093, 'recall': 0.006777959081209991, 'f1-score': 0.013269443420567637, 'support': 7967}, 'accuracy': 0.3575896745585557, 'macro avg': {'precision': 0.33995845934156366, 'recall': 0.3446207239715629, 'f1-score': 0.27379952234618654, 'support': 25258}, 'weighted avg': {'precision': 0.3408946972281739, 'recall': 0.3575896745585557, 'f1-score': 0.2823253405361499, 'support': 25258}}
[[2591 5754   61]
 [2441 6387   57]
 [2579 5334   54]]
training model: results/CHTR/W8/deepVOL_L3/h500
Epoch 1/50
358/358 - 16s - loss: 3.3216 - accuracy500: 0.3590 - val_loss: 3.4205 - val_accuracy500: 0.3668 - 16s/epoch - 44ms/step
Epoch 2/50
358/358 - 14s - loss: 3.3051 - accuracy500: 0.3508 - val_loss: 3.2994 - val_accuracy500: 0.3671 - 14s/epoch - 38ms/step
Epoch 3/50
358/358 - 14s - loss: 3.2997 - accuracy500: 0.3484 - val_loss: 3.2891 - val_accuracy500: 0.3623 - 14s/epoch - 38ms/step
Epoch 4/50
358/358 - 14s - loss: 3.2970 - accuracy500: 0.3502 - val_loss: 3.2910 - val_accuracy500: 0.3674 - 14s/epoch - 38ms/step
Epoch 5/50
358/358 - 14s - loss: 3.2949 - accuracy500: 0.3533 - val_loss: 3.2871 - val_accuracy500: 0.3689 - 14s/epoch - 39ms/step
Epoch 6/50
358/358 - 14s - loss: 3.2930 - accuracy500: 0.3559 - val_loss: 3.2869 - val_accuracy500: 0.3664 - 14s/epoch - 38ms/step
Epoch 7/50
358/358 - 14s - loss: 3.2910 - accuracy500: 0.3588 - val_loss: 3.2972 - val_accuracy500: 0.3675 - 14s/epoch - 39ms/step
Epoch 8/50
358/358 - 14s - loss: 3.2910 - accuracy500: 0.3573 - val_loss: 3.2877 - val_accuracy500: 0.3645 - 14s/epoch - 38ms/step
Epoch 9/50
358/358 - 14s - loss: 3.2885 - accuracy500: 0.3620 - val_loss: 3.2894 - val_accuracy500: 0.3663 - 14s/epoch - 38ms/step
Epoch 10/50
358/358 - 13s - loss: 3.2867 - accuracy500: 0.3624 - val_loss: 3.2905 - val_accuracy500: 0.3689 - 13s/epoch - 38ms/step
Epoch 11/50
358/358 - 14s - loss: 3.2849 - accuracy500: 0.3630 - val_loss: 3.2902 - val_accuracy500: 0.3702 - 14s/epoch - 39ms/step
Epoch 12/50
358/358 - 13s - loss: 3.2833 - accuracy500: 0.3644 - val_loss: 3.2931 - val_accuracy500: 0.3687 - 13s/epoch - 38ms/step
Epoch 13/50
358/358 - 13s - loss: 3.2815 - accuracy500: 0.3655 - val_loss: 3.2978 - val_accuracy500: 0.3687 - 13s/epoch - 38ms/step
Epoch 14/50
358/358 - 14s - loss: 3.2792 - accuracy500: 0.3677 - val_loss: 3.2950 - val_accuracy500: 0.3695 - 14s/epoch - 38ms/step
Epoch 15/50
358/358 - 14s - loss: 3.2780 - accuracy500: 0.3686 - val_loss: 3.3068 - val_accuracy500: 0.3681 - 14s/epoch - 38ms/step
Epoch 16/50
358/358 - 13s - loss: 3.2752 - accuracy500: 0.3679 - val_loss: 3.3049 - val_accuracy500: 0.3678 - 13s/epoch - 38ms/step
testing model: results/CHTR/W8/deepVOL_L3/h500
Evaluating performance on  test set...
1223/1223 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0969331
{'0': {'precision': 0.3274059997285191, 'recall': 0.023909121547947106, 'f1-score': 0.04456392206856414, 'support': 100882}, '1': {'precision': 0.36193762507514804, 'recall': 0.7977962532674993, 'f1-score': 0.4979633458912841, 'support': 110176}, '2': {'precision': 0.35367445711010637, 'recall': 0.21784751164501104, 'f1-score': 0.26962078319284893, 'support': 101975}, 'accuracy': 0.35946689326684406, 'macro avg': {'precision': 0.34767269397125783, 'recall': 0.3465176288201525, 'f1-score': 0.2707160170508991, 'support': 313033}, 'weighted avg': {'precision': 0.3481171780888759, 'recall': 0.35946689326684406, 'f1-score': 0.27745920254136075, 'support': 313033}}
[[ 2412 77899 20571]
 [ 2252 87898 20026]
 [ 2703 77057 22215]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0989013
{'0': {'precision': 0.338931955211025, 'recall': 0.02630787230486378, 'f1-score': 0.04882588330179608, 'support': 29915}, '1': {'precision': 0.3451581837259778, 'recall': 0.7943170917270351, 'f1-score': 0.48121280134666644, 'support': 30231}, '2': {'precision': 0.3644371607087985, 'recall': 0.22754452722796023, 'f1-score': 0.2801629953345538, 'support': 31273}, 'accuracy': 0.34911779826950634, 'macro avg': {'precision': 0.34950909988193374, 'recall': 0.34938983041995303, 'f1-score': 0.2700672266610054, 'support': 91419}, 'weighted avg': {'precision': 0.3497158120216159, 'recall': 0.34911779826950634, 'f1-score': 0.27094704437350886, 'support': 91419}}
[[  787 22261  6867]
 [  675 24013  5543]
 [  860 23297  7116]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0951594
{'0': {'precision': 0.3277310924369748, 'recall': 0.024032536356913974, 'f1-score': 0.04478126076472615, 'support': 8114}, '1': {'precision': 0.3779519491829312, 'recall': 0.7921408632166631, 'f1-score': 0.5117392058262529, 'support': 9314}, '2': {'precision': 0.3372228704784131, 'recall': 0.221455938697318, 'f1-score': 0.26734505087881594, 'support': 7830}, 'accuracy': 0.36847731411829915, 'macro avg': {'precision': 0.34763530403277304, 'recall': 0.34587644609029833, 'f1-score': 0.27462183915659827, 'support': 25258}, 'weighted avg': {'precision': 0.34919271575617267, 'recall': 0.36847731411829915, 'f1-score': 0.28596903402058105, 'support': 25258}}
[[ 195 6250 1669]
 [ 197 7378 1739]
 [ 203 5893 1734]]
training model: results/CHTR/W8/deepVOL_L3/h1000
Epoch 1/50
358/358 - 16s - loss: 3.3372 - accuracy1000: 0.3636 - val_loss: 3.4147 - val_accuracy1000: 0.3630 - 16s/epoch - 45ms/step
Epoch 2/50
358/358 - 15s - loss: 3.3171 - accuracy1000: 0.3492 - val_loss: 3.3573 - val_accuracy1000: 0.3598 - 15s/epoch - 42ms/step
Epoch 3/50
358/358 - 15s - loss: 3.3093 - accuracy1000: 0.3431 - val_loss: 3.3474 - val_accuracy1000: 0.3674 - 15s/epoch - 41ms/step
Epoch 4/50
358/358 - 14s - loss: 3.3112 - accuracy1000: 0.3307 - val_loss: 3.2998 - val_accuracy1000: 0.3431 - 14s/epoch - 39ms/step
Epoch 5/50
358/358 - 14s - loss: 3.3008 - accuracy1000: 0.3419 - val_loss: 3.2970 - val_accuracy1000: 0.3461 - 14s/epoch - 40ms/step
Epoch 6/50
358/358 - 14s - loss: 3.2975 - accuracy1000: 0.3485 - val_loss: 3.2914 - val_accuracy1000: 0.3566 - 14s/epoch - 39ms/step
Epoch 7/50
358/358 - 14s - loss: 3.2969 - accuracy1000: 0.3482 - val_loss: 3.2930 - val_accuracy1000: 0.3522 - 14s/epoch - 38ms/step
Epoch 8/50
358/358 - 15s - loss: 3.2957 - accuracy1000: 0.3502 - val_loss: 3.2894 - val_accuracy1000: 0.3606 - 15s/epoch - 41ms/step
Epoch 9/50
358/358 - 15s - loss: 3.2946 - accuracy1000: 0.3527 - val_loss: 3.2880 - val_accuracy1000: 0.3607 - 15s/epoch - 41ms/step
Epoch 10/50
358/358 - 14s - loss: 3.2947 - accuracy1000: 0.3502 - val_loss: 3.2895 - val_accuracy1000: 0.3576 - 14s/epoch - 38ms/step
Epoch 11/50
358/358 - 14s - loss: 3.2936 - accuracy1000: 0.3522 - val_loss: 3.2862 - val_accuracy1000: 0.3686 - 14s/epoch - 39ms/step
Epoch 12/50
358/358 - 14s - loss: 3.2932 - accuracy1000: 0.3519 - val_loss: 3.2872 - val_accuracy1000: 0.3644 - 14s/epoch - 38ms/step
Epoch 13/50
358/358 - 14s - loss: 3.2916 - accuracy1000: 0.3521 - val_loss: 3.2866 - val_accuracy1000: 0.3672 - 14s/epoch - 38ms/step
Epoch 14/50
358/358 - 14s - loss: 3.2906 - accuracy1000: 0.3550 - val_loss: 3.2896 - val_accuracy1000: 0.3591 - 14s/epoch - 38ms/step
Epoch 15/50
358/358 - 14s - loss: 3.2892 - accuracy1000: 0.3562 - val_loss: 3.2916 - val_accuracy1000: 0.3580 - 14s/epoch - 38ms/step
Epoch 16/50
358/358 - 14s - loss: 3.2868 - accuracy1000: 0.3572 - val_loss: 3.2888 - val_accuracy1000: 0.3646 - 14s/epoch - 38ms/step
Epoch 17/50
358/358 - 14s - loss: 3.2873 - accuracy1000: 0.3571 - val_loss: 3.2901 - val_accuracy1000: 0.3574 - 14s/epoch - 38ms/step
Epoch 18/50
358/358 - 14s - loss: 3.2859 - accuracy1000: 0.3567 - val_loss: 3.2873 - val_accuracy1000: 0.3611 - 14s/epoch - 38ms/step
Epoch 19/50
358/358 - 13s - loss: 3.2857 - accuracy1000: 0.3609 - val_loss: 3.2904 - val_accuracy1000: 0.3570 - 13s/epoch - 38ms/step
Epoch 20/50
358/358 - 13s - loss: 3.2835 - accuracy1000: 0.3603 - val_loss: 3.2886 - val_accuracy1000: 0.3583 - 13s/epoch - 37ms/step
Epoch 21/50
358/358 - 13s - loss: 3.2810 - accuracy1000: 0.3626 - val_loss: 3.2895 - val_accuracy1000: 0.3598 - 13s/epoch - 37ms/step
testing model: results/CHTR/W8/deepVOL_L3/h1000
Evaluating performance on  test set...
1223/1223 - 21s - 21s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0951785
{'0': {'precision': 0.3245355826551562, 'recall': 0.1335600052935368, 'f1-score': 0.18923986730131254, 'support': 98233}, '1': {'precision': 0.3890103663453366, 'recall': 0.48104563420768953, 'f1-score': 0.4301602156022444, 'support': 111320}, '2': {'precision': 0.36018051263810774, 'recall': 0.4697139543873212, 'f1-score': 0.40771885970246907, 'support': 103480}, 'accuracy': 0.3682551040944565, 'macro avg': {'precision': 0.35790882054620016, 'recall': 0.36143986462951583, 'f1-score': 0.3423729808686753, 'support': 313033}, 'weighted avg': {'precision': 0.3592471634630158, 'recall': 0.3682551040944565, 'f1-score': 0.3471384253016876, 'support': 313033}}
[[13120 42847 42266]
 [13693 53550 44077]
 [13614 41260 48606]]
Evaluating performance on  train set...
358/358 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0961474
{'0': {'precision': 0.33246496586417534, 'recall': 0.12400321651142532, 'f1-score': 0.1806335106642589, 'support': 29846}, '1': {'precision': 0.3642439012134764, 'recall': 0.48009801973640637, 'f1-score': 0.4142226539620862, 'support': 30198}, '2': {'precision': 0.357005236636696, 'recall': 0.46065338645418324, 'f1-score': 0.4022599813523706, 'support': 31375}, 'accuracy': 0.3571686410921143, 'macro avg': {'precision': 0.35123803457144925, 'recall': 0.35491820756733833, 'f1-score': 0.3323720486595719, 'support': 91419}, 'weighted avg': {'precision': 0.3513845699417307, 'recall': 0.3571686410921143, 'f1-score': 0.33385609532551414, 'support': 91419}}
[[ 3701 12260 13885]
 [ 3554 14498 12146]
 [ 3877 13045 14453]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0938131
{'0': {'precision': 0.3317261330761813, 'recall': 0.1270153846153846, 'f1-score': 0.18369526521893914, 'support': 8125}, '1': {'precision': 0.4121734541296508, 'recall': 0.4997866894197952, 'f1-score': 0.4517715112075199, 'support': 9376}, '2': {'precision': 0.32232325106698834, 'recall': 0.4478535516307851, 'f1-score': 0.3748583760453197, 'support': 7757}, 'accuracy': 0.3639243012114973, 'macro avg': {'precision': 0.35540761275760674, 'recall': 0.358218541888655, 'f1-score': 0.3367750508239262, 'support': 25258}, 'weighted avg': {'precision': 0.3587011875718666, 'recall': 0.3639243012114973, 'f1-score': 0.34191583426910815, 'support': 25258}}
[[1032 3371 3722]
 [1108 4686 3582]
 [ 971 3312 3474]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        16 (peak)  12.10 (ave)

============================================
