This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/XRAY_orderbooks/XRAY_orderbooks_2019-05-22.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-05-14.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-05-01.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-05-02.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-05-10.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-05-06.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-05-08.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-05-03.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-05-24.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-05-07.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-05-20.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-05-09.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-04-30.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-05-16.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-05-15.csv
training model: results/XRAY/W3/deepLOB_L1/h10
Epoch 1/50
444/444 - 53s - loss: 3.2791 - accuracy10: 0.3851 - val_loss: 3.3280 - val_accuracy10: 0.3733 - 53s/epoch - 119ms/step
Epoch 2/50
444/444 - 26s - loss: 3.2232 - accuracy10: 0.4156 - val_loss: 3.2568 - val_accuracy10: 0.3916 - 26s/epoch - 59ms/step
Epoch 3/50
444/444 - 23s - loss: 3.1870 - accuracy10: 0.4308 - val_loss: 3.2191 - val_accuracy10: 0.4079 - 23s/epoch - 53ms/step
Epoch 4/50
444/444 - 24s - loss: 3.1649 - accuracy10: 0.4408 - val_loss: 3.1996 - val_accuracy10: 0.4154 - 24s/epoch - 55ms/step
Epoch 5/50
444/444 - 25s - loss: 3.1490 - accuracy10: 0.4484 - val_loss: 3.2210 - val_accuracy10: 0.4102 - 25s/epoch - 57ms/step
Epoch 6/50
444/444 - 23s - loss: 3.1342 - accuracy10: 0.4552 - val_loss: 3.2146 - val_accuracy10: 0.4099 - 23s/epoch - 52ms/step
Epoch 7/50
444/444 - 28s - loss: 3.1246 - accuracy10: 0.4581 - val_loss: 3.2254 - val_accuracy10: 0.4104 - 28s/epoch - 63ms/step
Epoch 8/50
444/444 - 24s - loss: 3.1134 - accuracy10: 0.4607 - val_loss: 3.2323 - val_accuracy10: 0.4107 - 24s/epoch - 54ms/step
Epoch 9/50
444/444 - 24s - loss: 3.1083 - accuracy10: 0.4644 - val_loss: 3.2400 - val_accuracy10: 0.4089 - 24s/epoch - 53ms/step
Epoch 10/50
444/444 - 26s - loss: 3.1017 - accuracy10: 0.4650 - val_loss: 3.2426 - val_accuracy10: 0.4094 - 26s/epoch - 59ms/step
Epoch 11/50
444/444 - 25s - loss: 3.0961 - accuracy10: 0.4688 - val_loss: 3.2379 - val_accuracy10: 0.4128 - 25s/epoch - 57ms/step
Epoch 12/50
444/444 - 22s - loss: 3.0911 - accuracy10: 0.4703 - val_loss: 3.2587 - val_accuracy10: 0.4095 - 22s/epoch - 51ms/step
Epoch 13/50
444/444 - 25s - loss: 3.0877 - accuracy10: 0.4722 - val_loss: 3.2720 - val_accuracy10: 0.4106 - 25s/epoch - 56ms/step
Epoch 14/50
444/444 - 24s - loss: 3.0824 - accuracy10: 0.4725 - val_loss: 3.2669 - val_accuracy10: 0.4103 - 24s/epoch - 54ms/step
testing model: results/XRAY/W3/deepLOB_L1/h10
Evaluating performance on  test set...
1359/1359 - 34s - 34s/epoch - 25ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.053323
{'0': {'precision': 0.42599069781376153, 'recall': 0.5168521968285701, 'f1-score': 0.46704329903679553, 'support': 110045}, '1': {'precision': 0.44337637549011716, 'recall': 0.29475840665346775, 'f1-score': 0.35410582768563925, 'support': 130819}, '2': {'precision': 0.4203118250009818, 'recall': 0.5004067815629764, 'f1-score': 0.4568755015965712, 'support': 106937}, 'accuracy': 0.42825926319935825, 'macro avg': {'precision': 0.4298929661016202, 'recall': 0.43733912834833805, 'f1-score': 0.42600820943966866, 'support': 347801}, 'weighted avg': {'precision': 0.4307839426461885, 'recall': 0.42825926319935825, 'f1-score': 0.42143767737512067, 'support': 347801}}
[[56877 25865 27303]
 [45759 38560 46500]
 [30881 22544 53512]]
Evaluating performance on  train set...
444/444 - 14s - 14s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0701575
{'0': {'precision': 0.42964856560022724, 'recall': 0.44332835979963764, 'f1-score': 0.4363812795866717, 'support': 37532}, '1': {'precision': 0.3886471306994791, 'recall': 0.4741232772823557, 'f1-score': 0.42715106964470834, 'support': 38239}, '2': {'precision': 0.4424556055718995, 'recall': 0.3300809138505474, 'f1-score': 0.378095137132559, 'support': 37818}, 'accuracy': 0.41599098504256576, 'macro avg': {'precision': 0.42025043395720196, 'recall': 0.41584418364418024, 'f1-score': 0.4138758287879796, 'support': 113589}, 'weighted avg': {'precision': 0.42010963813787605, 'recall': 0.41599098504256576, 'f1-score': 0.4138683660712752, 'support': 113589}}
[[16639 14357  6536]
 [10915 18130  9194]
 [11173 14162 12483]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 30ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0670218
{'0': {'precision': 0.4446058091286307, 'recall': 0.36408426775399255, 'f1-score': 0.4003362600410984, 'support': 11772}, '1': {'precision': 0.4208554194845549, 'recall': 0.3479410653570079, 'f1-score': 0.38094056334532816, 'support': 13235}, '2': {'precision': 0.3869240348692404, 'recall': 0.5340782122905028, 'f1-score': 0.44874526087741473, 'support': 11635}, 'accuracy': 0.4122318650728672, 'macro avg': {'precision': 0.41746175449414197, 'recall': 0.41536784846716773, 'f1-score': 0.4100073614212804, 'support': 36642}, 'weighted avg': {'precision': 0.4177114297157343, 'recall': 0.4122318650728672, 'f1-score': 0.4087019791329062, 'support': 36642}}
[[4286 3322 4164]
 [2948 4605 5682]
 [2406 3015 6214]]
training model: results/XRAY/W3/deepLOB_L1/h20
Epoch 1/50
444/444 - 33s - loss: 3.3106 - accuracy20: 0.3657 - val_loss: 3.3157 - val_accuracy20: 0.3729 - 33s/epoch - 74ms/step
Epoch 2/50
444/444 - 24s - loss: 3.2527 - accuracy20: 0.3959 - val_loss: 3.2836 - val_accuracy20: 0.3736 - 24s/epoch - 53ms/step
Epoch 3/50
444/444 - 27s - loss: 3.2354 - accuracy20: 0.4057 - val_loss: 3.2725 - val_accuracy20: 0.3816 - 27s/epoch - 60ms/step
Epoch 4/50
444/444 - 25s - loss: 3.2225 - accuracy20: 0.4130 - val_loss: 3.2456 - val_accuracy20: 0.3930 - 25s/epoch - 56ms/step
Epoch 5/50
444/444 - 25s - loss: 3.2095 - accuracy20: 0.4175 - val_loss: 3.2424 - val_accuracy20: 0.3918 - 25s/epoch - 56ms/step
Epoch 6/50
444/444 - 28s - loss: 3.1994 - accuracy20: 0.4249 - val_loss: 3.2529 - val_accuracy20: 0.3921 - 28s/epoch - 63ms/step
Epoch 7/50
444/444 - 27s - loss: 3.1919 - accuracy20: 0.4275 - val_loss: 3.2677 - val_accuracy20: 0.3853 - 27s/epoch - 61ms/step
Epoch 8/50
444/444 - 22s - loss: 3.1856 - accuracy20: 0.4314 - val_loss: 3.2590 - val_accuracy20: 0.3948 - 22s/epoch - 50ms/step
Epoch 9/50
444/444 - 23s - loss: 3.1827 - accuracy20: 0.4337 - val_loss: 3.2544 - val_accuracy20: 0.3977 - 23s/epoch - 52ms/step
Epoch 10/50
444/444 - 26s - loss: 3.1770 - accuracy20: 0.4340 - val_loss: 3.2600 - val_accuracy20: 0.3951 - 26s/epoch - 58ms/step
Epoch 11/50
444/444 - 25s - loss: 3.1733 - accuracy20: 0.4359 - val_loss: 3.2555 - val_accuracy20: 0.3960 - 25s/epoch - 57ms/step
Epoch 12/50
444/444 - 26s - loss: 3.1700 - accuracy20: 0.4374 - val_loss: 3.2864 - val_accuracy20: 0.3889 - 26s/epoch - 58ms/step
Epoch 13/50
444/444 - 26s - loss: 3.1654 - accuracy20: 0.4398 - val_loss: 3.2866 - val_accuracy20: 0.3925 - 26s/epoch - 58ms/step
Epoch 14/50
444/444 - 25s - loss: 3.1633 - accuracy20: 0.4412 - val_loss: 3.2756 - val_accuracy20: 0.3979 - 25s/epoch - 56ms/step
Epoch 15/50
444/444 - 24s - loss: 3.1575 - accuracy20: 0.4412 - val_loss: 3.2918 - val_accuracy20: 0.3931 - 24s/epoch - 55ms/step
testing model: results/XRAY/W3/deepLOB_L1/h20
Evaluating performance on  test set...
1359/1359 - 38s - 38s/epoch - 28ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0692608
{'0': {'precision': 0.42689322425005244, 'recall': 0.30756305509374915, 'f1-score': 0.35753410500206695, 'support': 112481}, '1': {'precision': 0.3790504856417746, 'recall': 0.5484700437130368, 'f1-score': 0.4482872989862701, 'support': 124448}, '2': {'precision': 0.43768095880771934, 'recall': 0.34222346489645716, 'f1-score': 0.38411038504173345, 'support': 110872}, 'accuracy': 0.40481194706168183, 'macro avg': {'precision': 0.4145415562331822, 'recall': 0.39941885456774767, 'f1-score': 0.3966439296766902, 'support': 347801}, 'weighted avg': {'precision': 0.4132133457320341, 'recall': 0.40481194706168183, 'f1-score': 0.3984788372067013, 'support': 347801}}
[[34595 59736 18150]
 [25594 68256 30598]
 [20850 52079 37943]]
Evaluating performance on  train set...
444/444 - 13s - 13s/epoch - 30ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0852232
{'0': {'precision': 0.41368722707423583, 'recall': 0.32254289134193376, 'f1-score': 0.3624732838118583, 'support': 37595}, '1': {'precision': 0.35789258344217667, 'recall': 0.6003642891082837, 'f1-score': 0.44845162626073415, 'support': 37882}, '2': {'precision': 0.44664737095996143, 'recall': 0.24294185558354325, 'f1-score': 0.31470718194486935, 'support': 38112}, 'accuracy': 0.3884883219325815, 'macro avg': {'precision': 0.4060757271587913, 'recall': 0.38861634534458683, 'f1-score': 0.37521069733915385, 'support': 113589}, 'weighted avg': {'precision': 0.4061386467865593, 'recall': 0.3884883219325815, 'f1-score': 0.3751203701872435, 'support': 113589}}
[[12126 20732  4737]
 [ 8405 22743  6734]
 [ 8781 20072  9259]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 30ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.081769
{'0': {'precision': 0.4181994191674734, 'recall': 0.32238805970149254, 'f1-score': 0.3640960809102402, 'support': 12060}, '1': {'precision': 0.3592220748879207, 'recall': 0.45457451058729526, 'f1-score': 0.4013120767494357, 'support': 12515}, '2': {'precision': 0.4098018769551616, 'recall': 0.390817933206265, 'f1-score': 0.40008483563096503, 'support': 12067}, 'accuracy': 0.3900715026472354, 'macro avg': {'precision': 0.39574112367018527, 'recall': 0.38926016783168427, 'f1-score': 0.3884976644302136, 'support': 36642}, 'weighted avg': {'precision': 0.3952903365427649, 'recall': 0.3900715026472354, 'f1-score': 0.38865900026896844, 'support': 36642}}
[[3888 5367 2805]
 [2839 5689 3987]
 [2570 4781 4716]]
training model: results/XRAY/W3/deepLOB_L1/h30
Epoch 1/50
444/444 - 30s - loss: 3.3196 - accuracy30: 0.3624 - val_loss: 3.3131 - val_accuracy30: 0.3652 - 30s/epoch - 67ms/step
Epoch 2/50
444/444 - 22s - loss: 3.2728 - accuracy30: 0.3822 - val_loss: 3.2762 - val_accuracy30: 0.3760 - 22s/epoch - 50ms/step
Epoch 3/50
444/444 - 23s - loss: 3.2548 - accuracy30: 0.3903 - val_loss: 3.2673 - val_accuracy30: 0.3826 - 23s/epoch - 52ms/step
Epoch 4/50
444/444 - 20s - loss: 3.2447 - accuracy30: 0.3976 - val_loss: 3.2634 - val_accuracy30: 0.3868 - 20s/epoch - 45ms/step
Epoch 5/50
444/444 - 23s - loss: 3.2344 - accuracy30: 0.4027 - val_loss: 3.2688 - val_accuracy30: 0.3844 - 23s/epoch - 53ms/step
Epoch 6/50
444/444 - 21s - loss: 3.2286 - accuracy30: 0.4068 - val_loss: 3.2708 - val_accuracy30: 0.3859 - 21s/epoch - 48ms/step
Epoch 7/50
444/444 - 22s - loss: 3.2211 - accuracy30: 0.4090 - val_loss: 3.2611 - val_accuracy30: 0.3929 - 22s/epoch - 50ms/step
Epoch 8/50
444/444 - 21s - loss: 3.2166 - accuracy30: 0.4124 - val_loss: 3.2610 - val_accuracy30: 0.3900 - 21s/epoch - 47ms/step
Epoch 9/50
444/444 - 20s - loss: 3.2137 - accuracy30: 0.4125 - val_loss: 3.2503 - val_accuracy30: 0.3990 - 20s/epoch - 44ms/step
Epoch 10/50
444/444 - 21s - loss: 3.2086 - accuracy30: 0.4175 - val_loss: 3.2670 - val_accuracy30: 0.3980 - 21s/epoch - 47ms/step
Epoch 11/50
444/444 - 23s - loss: 3.2067 - accuracy30: 0.4173 - val_loss: 3.2626 - val_accuracy30: 0.3944 - 23s/epoch - 51ms/step
Epoch 12/50
444/444 - 23s - loss: 3.2035 - accuracy30: 0.4200 - val_loss: 3.2576 - val_accuracy30: 0.3914 - 23s/epoch - 52ms/step
Epoch 13/50
444/444 - 22s - loss: 3.1971 - accuracy30: 0.4221 - val_loss: 3.2593 - val_accuracy30: 0.3975 - 22s/epoch - 51ms/step
Epoch 14/50
444/444 - 24s - loss: 3.1959 - accuracy30: 0.4235 - val_loss: 3.2652 - val_accuracy30: 0.3912 - 24s/epoch - 54ms/step
Epoch 15/50
444/444 - 24s - loss: 3.1924 - accuracy30: 0.4253 - val_loss: 3.2584 - val_accuracy30: 0.3966 - 24s/epoch - 55ms/step
Epoch 16/50
444/444 - 22s - loss: 3.1865 - accuracy30: 0.4274 - val_loss: 3.2502 - val_accuracy30: 0.3985 - 22s/epoch - 51ms/step
Epoch 17/50
444/444 - 22s - loss: 3.1841 - accuracy30: 0.4277 - val_loss: 3.2594 - val_accuracy30: 0.3939 - 22s/epoch - 51ms/step
Epoch 18/50
444/444 - 24s - loss: 3.1823 - accuracy30: 0.4293 - val_loss: 3.2593 - val_accuracy30: 0.4031 - 24s/epoch - 53ms/step
Epoch 19/50
444/444 - 20s - loss: 3.1772 - accuracy30: 0.4307 - val_loss: 3.2735 - val_accuracy30: 0.3982 - 20s/epoch - 46ms/step
Epoch 20/50
444/444 - 22s - loss: 3.1749 - accuracy30: 0.4325 - val_loss: 3.2725 - val_accuracy30: 0.3956 - 22s/epoch - 50ms/step
Epoch 21/50
444/444 - 20s - loss: 3.1716 - accuracy30: 0.4337 - val_loss: 3.2625 - val_accuracy30: 0.3991 - 20s/epoch - 45ms/step
Epoch 22/50
444/444 - 21s - loss: 3.1671 - accuracy30: 0.4357 - val_loss: 3.2564 - val_accuracy30: 0.3983 - 21s/epoch - 47ms/step
Epoch 23/50
444/444 - 22s - loss: 3.1679 - accuracy30: 0.4355 - val_loss: 3.2712 - val_accuracy30: 0.4010 - 22s/epoch - 49ms/step
Epoch 24/50
444/444 - 25s - loss: 3.1640 - accuracy30: 0.4386 - val_loss: 3.2622 - val_accuracy30: 0.3977 - 25s/epoch - 57ms/step
Epoch 25/50
444/444 - 23s - loss: 3.1626 - accuracy30: 0.4369 - val_loss: 3.2652 - val_accuracy30: 0.3994 - 23s/epoch - 51ms/step
Epoch 26/50
444/444 - 23s - loss: 3.1568 - accuracy30: 0.4399 - val_loss: 3.2784 - val_accuracy30: 0.4019 - 23s/epoch - 52ms/step
testing model: results/XRAY/W3/deepLOB_L1/h30
Evaluating performance on  test set...
1359/1359 - 36s - 36s/epoch - 27ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0770003
{'0': {'precision': 0.3983272612070331, 'recall': 0.5491535491535492, 'f1-score': 0.46173564007741374, 'support': 114478}, '1': {'precision': 0.39573212375810213, 'recall': 0.2535816027414227, 'f1-score': 0.30909676510256257, 'support': 121105}, '2': {'precision': 0.41884616411415554, 'recall': 0.4194246912260065, 'f1-score': 0.4191352280367423, 'support': 112218}, 'accuracy': 0.4043777907481577, 'macro avg': {'precision': 0.40430184969309685, 'recall': 0.4073866143736595, 'f1-score': 0.3966558777389062, 'support': 347801}, 'weighted avg': {'precision': 0.40404405364201373, 'recall': 0.4043777907481577, 'f1-score': 0.39484145635681084, 'support': 347801}}
[[62866 24517 27095]
 [52184 30710 38211]
 [42775 22376 47067]]
Evaluating performance on  train set...
444/444 - 12s - 12s/epoch - 27ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0857614
{'0': {'precision': 0.37570805390975975, 'recall': 0.6157170294494239, 'f1-score': 0.4666612753224698, 'support': 37488}, '1': {'precision': 0.3903763917247756, 'recall': 0.2696524562243866, 'f1-score': 0.3189737939718265, 'support': 37578}, '2': {'precision': 0.42892044586959843, 'recall': 0.29166991148145266, 'f1-score': 0.3472241536488513, 'support': 38523}, 'accuracy': 0.3913319071388955, 'macro avg': {'precision': 0.3983349638347113, 'recall': 0.392346465718421, 'f1-score': 0.3776197409810493, 'support': 113589}, 'weighted avg': {'precision': 0.39860734674517107, 'recall': 0.3913319071388955, 'f1-score': 0.3772963155778883, 'support': 113589}}
[[23082  7677  6729]
 [19214 10133  8231]
 [19140  8147 11236]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 29ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0839875
{'0': {'precision': 0.39446176416651385, 'recall': 0.5228064489994328, 'f1-score': 0.4496550763013031, 'support': 12343}, '1': {'precision': 0.3972904122278833, 'recall': 0.2858452053653253, 'f1-score': 0.3324773487087553, 'support': 12003}, '2': {'precision': 0.4078303425774878, 'recall': 0.38630448926480154, 'f1-score': 0.39677567556279497, 'support': 12296}, 'accuracy': 0.39937776322253155, 'macro avg': {'precision': 0.39986083965729496, 'recall': 0.39831871454318657, 'f1-score': 0.39296936685761774, 'support': 36642}, 'weighted avg': {'precision': 0.39987446824440137, 'recall': 0.39937776322253155, 'f1-score': 0.39352578816817585, 'support': 36642}}
[[6453 2631 3259]
 [4934 3431 3638]
 [4972 2574 4750]]
training model: results/XRAY/W3/deepLOB_L1/h50
Epoch 1/50
444/444 - 29s - loss: 3.3293 - accuracy50: 0.3602 - val_loss: 3.3683 - val_accuracy50: 0.3425 - 29s/epoch - 65ms/step
Epoch 2/50
444/444 - 22s - loss: 3.2940 - accuracy50: 0.3670 - val_loss: 3.3166 - val_accuracy50: 0.3554 - 22s/epoch - 49ms/step
Epoch 3/50
444/444 - 22s - loss: 3.2764 - accuracy50: 0.3769 - val_loss: 3.2855 - val_accuracy50: 0.3718 - 22s/epoch - 50ms/step
Epoch 4/50
444/444 - 25s - loss: 3.2649 - accuracy50: 0.3798 - val_loss: 3.2819 - val_accuracy50: 0.3764 - 25s/epoch - 55ms/step
Epoch 5/50
444/444 - 24s - loss: 3.2587 - accuracy50: 0.3842 - val_loss: 3.2880 - val_accuracy50: 0.3795 - 24s/epoch - 54ms/step
Epoch 6/50
444/444 - 24s - loss: 3.2454 - accuracy50: 0.3919 - val_loss: 3.2872 - val_accuracy50: 0.3823 - 24s/epoch - 54ms/step
Epoch 7/50
444/444 - 23s - loss: 3.2388 - accuracy50: 0.3967 - val_loss: 3.2882 - val_accuracy50: 0.3840 - 23s/epoch - 52ms/step
Epoch 8/50
444/444 - 23s - loss: 3.2321 - accuracy50: 0.4012 - val_loss: 3.2867 - val_accuracy50: 0.3881 - 23s/epoch - 51ms/step
Epoch 9/50
444/444 - 28s - loss: 3.2255 - accuracy50: 0.4052 - val_loss: 3.2982 - val_accuracy50: 0.3837 - 28s/epoch - 62ms/step
Epoch 10/50
444/444 - 25s - loss: 3.2169 - accuracy50: 0.4098 - val_loss: 3.2978 - val_accuracy50: 0.3848 - 25s/epoch - 56ms/step
Epoch 11/50
444/444 - 25s - loss: 3.2148 - accuracy50: 0.4107 - val_loss: 3.3081 - val_accuracy50: 0.3845 - 25s/epoch - 56ms/step
Epoch 12/50
444/444 - 24s - loss: 3.2085 - accuracy50: 0.4168 - val_loss: 3.3116 - val_accuracy50: 0.3814 - 24s/epoch - 55ms/step
Epoch 13/50
444/444 - 27s - loss: 3.2066 - accuracy50: 0.4173 - val_loss: 3.3050 - val_accuracy50: 0.3842 - 27s/epoch - 61ms/step
Epoch 14/50
444/444 - 27s - loss: 3.2007 - accuracy50: 0.4198 - val_loss: 3.3118 - val_accuracy50: 0.3854 - 27s/epoch - 60ms/step
testing model: results/XRAY/W3/deepLOB_L1/h50
Evaluating performance on  test set...
1359/1359 - 40s - 40s/epoch - 30ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1008171
{'0': {'precision': 0.3853611065713819, 'recall': 0.4150332026562125, 'f1-score': 0.3996471548974592, 'support': 124990}, '1': {'precision': 0.3125848858365579, 'recall': 0.3621124711796313, 'f1-score': 0.3355308399732265, 'support': 101057}, '2': {'precision': 0.3962109074262885, 'recall': 0.31278643822790214, 'f1-score': 0.3495905852977895, 'support': 121754}, 'accuracy': 0.3638632436364473, 'macro avg': {'precision': 0.36471896661140946, 'recall': 0.36331070402124865, 'f1-score': 0.3615895267228251, 'support': 347801}, 'weighted avg': {'precision': 0.3680134281992357, 'recall': 0.3638632436364473, 'f1-score': 0.36349432608921434, 'support': 347801}}
[[51875 42951 30164]
 [36592 36594 27871]
 [46147 37524 38083]]
Evaluating performance on  train set...
444/444 - 13s - 13s/epoch - 29ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1003507
{'0': {'precision': 0.35651888461328035, 'recall': 0.5225468445109727, 'f1-score': 0.42385412601361605, 'support': 37411}, '1': {'precision': 0.36806926571680026, 'recall': 0.41297037630104083, 'f1-score': 0.38922916326042933, 'support': 37470}, '2': {'precision': 0.3864193837870176, 'recall': 0.16686473080500155, 'f1-score': 0.23308012918824314, 'support': 38708}, 'accuracy': 0.3651938127811672, 'macro avg': {'precision': 0.3703358447056994, 'recall': 0.367460650539005, 'f1-score': 0.3487211394874295, 'support': 113589}, 'weighted avg': {'precision': 0.3705183150331794, 'recall': 0.3651938127811672, 'f1-score': 0.34742174943244675, 'support': 113589}}
[[19549 12941  4921]
 [16661 15474  5335]
 [18623 13626  6459]]
Evaluating performance on  val set...
144/144 - 5s - 5s/epoch - 33ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0950495
{'0': {'precision': 0.38363864823755045, 'recall': 0.45634046570169917, 'f1-score': 0.4168433154888082, 'support': 12712}, '1': {'precision': 0.36390856642079894, 'recall': 0.44277590190154614, 'f1-score': 0.3994869122539785, 'support': 11254}, '2': {'precision': 0.3944813490035769, 'recall': 0.24360997159987377, 'f1-score': 0.30120952009364027, 'support': 12676}, 'accuracy': 0.37858195513345344, 'macro avg': {'precision': 0.3806761878873088, 'recall': 0.38090877973437304, 'f1-score': 0.37251324927880897, 'support': 36642}, 'weighted avg': {'precision': 0.3813298150446142, 'recall': 0.37858195513345344, 'f1-score': 0.37151001074469153, 'support': 36642}}
[[5801 4479 2432]
 [3963 4983 2308]
 [5357 4231 3088]]
training model: results/XRAY/W3/deepLOB_L1/h100
Epoch 1/50
444/444 - 28s - loss: 3.3418 - accuracy100: 0.3497 - val_loss: 3.3386 - val_accuracy100: 0.3480 - 28s/epoch - 63ms/step
Epoch 2/50
444/444 - 22s - loss: 3.3060 - accuracy100: 0.3605 - val_loss: 3.3442 - val_accuracy100: 0.3522 - 22s/epoch - 49ms/step
Epoch 3/50
444/444 - 22s - loss: 3.3007 - accuracy100: 0.3564 - val_loss: 3.3077 - val_accuracy100: 0.3479 - 22s/epoch - 50ms/step
Epoch 4/50
444/444 - 23s - loss: 3.2890 - accuracy100: 0.3626 - val_loss: 3.3024 - val_accuracy100: 0.3531 - 23s/epoch - 52ms/step
Epoch 5/50
444/444 - 20s - loss: 3.2802 - accuracy100: 0.3702 - val_loss: 3.3093 - val_accuracy100: 0.3528 - 20s/epoch - 45ms/step
Epoch 6/50
444/444 - 22s - loss: 3.2752 - accuracy100: 0.3761 - val_loss: 3.3159 - val_accuracy100: 0.3613 - 22s/epoch - 50ms/step
Epoch 7/50
444/444 - 23s - loss: 3.2651 - accuracy100: 0.3821 - val_loss: 3.3252 - val_accuracy100: 0.3595 - 23s/epoch - 53ms/step
Epoch 8/50
444/444 - 22s - loss: 3.2600 - accuracy100: 0.3862 - val_loss: 3.3294 - val_accuracy100: 0.3608 - 22s/epoch - 50ms/step
Epoch 9/50
444/444 - 20s - loss: 3.2537 - accuracy100: 0.3917 - val_loss: 3.3478 - val_accuracy100: 0.3612 - 20s/epoch - 46ms/step
Epoch 10/50
444/444 - 24s - loss: 3.2491 - accuracy100: 0.3940 - val_loss: 3.3412 - val_accuracy100: 0.3597 - 24s/epoch - 55ms/step
Epoch 11/50
444/444 - 23s - loss: 3.2462 - accuracy100: 0.3961 - val_loss: 3.3411 - val_accuracy100: 0.3572 - 23s/epoch - 52ms/step
Epoch 12/50
444/444 - 22s - loss: 3.2405 - accuracy100: 0.4000 - val_loss: 3.3542 - val_accuracy100: 0.3622 - 22s/epoch - 49ms/step
Epoch 13/50
444/444 - 22s - loss: 3.2372 - accuracy100: 0.3999 - val_loss: 3.3661 - val_accuracy100: 0.3587 - 22s/epoch - 50ms/step
Epoch 14/50
444/444 - 26s - loss: 3.2314 - accuracy100: 0.4042 - val_loss: 3.3800 - val_accuracy100: 0.3605 - 26s/epoch - 59ms/step
testing model: results/XRAY/W3/deepLOB_L1/h100
Evaluating performance on  test set...
1359/1359 - 37s - 37s/epoch - 27ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1045942
{'0': {'precision': 0.34595022048278357, 'recall': 0.2476469177260734, 'f1-score': 0.2886587561649351, 'support': 104225}, '1': {'precision': 0.4298594724051703, 'recall': 0.17031460407610782, 'f1-score': 0.24396703796430944, 'support': 143323}, '2': {'precision': 0.2957727604595067, 'recall': 0.6384547095847506, 'f1-score': 0.4042645242990094, 'support': 100253}, 'accuracy': 0.3284291879551813, 'macro avg': {'precision': 0.35719415111582015, 'recall': 0.35213874379564397, 'f1-score': 0.312296772809418, 'support': 347801}, 'weighted avg': {'precision': 0.36606426504722894, 'recall': 0.3284291879551813, 'f1-score': 0.30356519388385217, 'support': 347801}}
[[25811 16956 61458]
 [27972 24410 90941]
 [20826 15420 64007]]
Evaluating performance on  train set...
444/444 - 14s - 14s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1089424
{'0': {'precision': 0.33812881248514615, 'recall': 0.5749501589525298, 'f1-score': 0.4258278211766584, 'support': 37118}, '1': {'precision': 0.35840330474608234, 'recall': 0.2109742559602474, 'f1-score': 0.2656018634057067, 'support': 37834}, '2': {'precision': 0.35329574867921854, 'recall': 0.2578875171467764, 'f1-score': 0.29814482345900656, 'support': 38637}, 'accuracy': 0.3458697585153492, 'macro avg': {'precision': 0.34994262197014897, 'recall': 0.34793731068651784, 'f1-score': 0.32985816934712386, 'support': 113589}, 'weighted avg': {'precision': 0.35004079387357845, 'recall': 0.3458697585153492, 'f1-score': 0.3290290389959622, 'support': 113589}}
[[21341  6873  8904]
 [20517  7982  9335]
 [21257  7416  9964]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 26ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1003146
{'0': {'precision': 0.35107334525939177, 'recall': 0.4436102365383063, 'f1-score': 0.39195406398231036, 'support': 12387}, '1': {'precision': 0.3607090103397341, 'recall': 0.20512389752204957, 'f1-score': 0.2615261044176707, 'support': 11905}, '2': {'precision': 0.35590717299578056, 'recall': 0.4097975708502024, 'f1-score': 0.38095596537448245, 'support': 12350}, 'accuracy': 0.35472954533049506, 'macro avg': {'precision': 0.3558965095316355, 'recall': 0.35284390163685275, 'f1-score': 0.3448120445914879, 'support': 36642}, 'weighted avg': {'precision': 0.3558331936662985, 'recall': 0.35472954533049506, 'f1-score': 0.34587111609672255, 'support': 36642}}
[[5495 2155 4737]
 [5041 2442 4422]
 [5116 2173 5061]]
training model: results/XRAY/W3/deepLOB_L1/h200
Epoch 1/50
444/444 - 27s - loss: 3.3289 - accuracy200: 0.3589 - val_loss: 3.3633 - val_accuracy200: 0.3382 - 27s/epoch - 60ms/step
Epoch 2/50
444/444 - 21s - loss: 3.3007 - accuracy200: 0.3677 - val_loss: 3.3489 - val_accuracy200: 0.3507 - 21s/epoch - 47ms/step
Epoch 3/50
444/444 - 24s - loss: 3.2888 - accuracy200: 0.3671 - val_loss: 3.3464 - val_accuracy200: 0.3468 - 24s/epoch - 54ms/step
Epoch 4/50
444/444 - 23s - loss: 3.2718 - accuracy200: 0.3830 - val_loss: 3.3593 - val_accuracy200: 0.3523 - 23s/epoch - 52ms/step
Epoch 5/50
444/444 - 21s - loss: 3.2621 - accuracy200: 0.3908 - val_loss: 3.3578 - val_accuracy200: 0.3567 - 21s/epoch - 47ms/step
Epoch 6/50
444/444 - 20s - loss: 3.2559 - accuracy200: 0.3967 - val_loss: 3.3415 - val_accuracy200: 0.3580 - 20s/epoch - 45ms/step
Epoch 7/50
444/444 - 22s - loss: 3.2461 - accuracy200: 0.4047 - val_loss: 3.3552 - val_accuracy200: 0.3580 - 22s/epoch - 50ms/step
Epoch 8/50
444/444 - 23s - loss: 3.2402 - accuracy200: 0.4086 - val_loss: 3.3626 - val_accuracy200: 0.3593 - 23s/epoch - 52ms/step
Epoch 9/50
444/444 - 22s - loss: 3.2349 - accuracy200: 0.4106 - val_loss: 3.3597 - val_accuracy200: 0.3557 - 22s/epoch - 51ms/step
Epoch 10/50
444/444 - 24s - loss: 3.2281 - accuracy200: 0.4118 - val_loss: 3.3692 - val_accuracy200: 0.3575 - 24s/epoch - 53ms/step
Epoch 11/50
444/444 - 24s - loss: 3.2275 - accuracy200: 0.4121 - val_loss: 3.3738 - val_accuracy200: 0.3605 - 24s/epoch - 53ms/step
Epoch 12/50
444/444 - 21s - loss: 3.2214 - accuracy200: 0.4151 - val_loss: 3.3864 - val_accuracy200: 0.3608 - 21s/epoch - 47ms/step
Epoch 13/50
444/444 - 22s - loss: 3.2188 - accuracy200: 0.4173 - val_loss: 3.3950 - val_accuracy200: 0.3572 - 22s/epoch - 50ms/step
Epoch 14/50
444/444 - 24s - loss: 3.2096 - accuracy200: 0.4215 - val_loss: 3.3894 - val_accuracy200: 0.3611 - 24s/epoch - 54ms/step
Epoch 15/50
444/444 - 23s - loss: 3.2088 - accuracy200: 0.4224 - val_loss: 3.4048 - val_accuracy200: 0.3566 - 23s/epoch - 51ms/step
Epoch 16/50
444/444 - 24s - loss: 3.1994 - accuracy200: 0.4283 - val_loss: 3.3928 - val_accuracy200: 0.3555 - 24s/epoch - 55ms/step
testing model: results/XRAY/W3/deepLOB_L1/h200
Evaluating performance on  test set...
1359/1359 - 34s - 34s/epoch - 25ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0881382
{'0': {'precision': 0.3821712681328966, 'recall': 0.08258671250884822, 'f1-score': 0.13582238483286213, 'support': 98890}, '1': {'precision': 0.4539675523893713, 'recall': 0.6796878041184943, 'f1-score': 0.5443562843915137, 'support': 154134}, '2': {'precision': 0.28903710053418913, 'recall': 0.29172689576585037, 'f1-score': 0.2903757692873196, 'support': 94777}, 'accuracy': 0.40419377747620044, 'macro avg': {'precision': 0.37505864035215236, 'recall': 0.3513338041310643, 'f1-score': 0.3235181461705652, 'support': 347801}, 'weighted avg': {'precision': 0.3886096379911913, 'recall': 0.40419377747620044, 'f1-score': 0.3589875574258487, 'support': 347801}}
[[  8167  65534  25189]
 [  6550 104763  42821]
 [  6653  60475  27649]]
Evaluating performance on  train set...
444/444 - 12s - 12s/epoch - 28ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.119457
{'0': {'precision': 0.34632683658170915, 'recall': 0.35994841760249313, 'f1-score': 0.35300627074880114, 'support': 37222}, '1': {'precision': 0.36068220325437167, 'recall': 0.6001170181644105, 'f1-score': 0.45056557810768455, 'support': 37601}, '2': {'precision': 0.3710396240175026, 'recall': 0.11811897023164629, 'f1-score': 0.17919267419335902, 'support': 38766}, 'accuracy': 0.35691836357393764, 'macro avg': {'precision': 0.35934955461786117, 'recall': 0.3593948019995166, 'f1-score': 0.32758817434994825, 'support': 113589}, 'weighted avg': {'precision': 0.35951290266200525, 'recall': 0.35691836357393764, 'f1-score': 0.3259813795351546, 'support': 113589}}
[[13398 19732  4092]
 [11366 22565  3670]
 [13922 20265  4579]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1120758
{'0': {'precision': 0.35804905553989286, 'recall': 0.2047396421086571, 'f1-score': 0.2605128205128205, 'support': 12406}, '1': {'precision': 0.35438233264320224, 'recall': 0.5901329830898047, 'f1-score': 0.4428360231612665, 'support': 12182}, '2': {'precision': 0.3684949255020514, 'recall': 0.28314252530280404, 'f1-score': 0.3202289360105085, 'support': 12054}, 'accuracy': 0.35865946181976965, 'macro avg': {'precision': 0.3603087712283821, 'recall': 0.35933838350042197, 'f1-score': 0.3411925932281985, 'support': 36642}, 'weighted avg': {'precision': 0.3602663607687661, 'recall': 0.35865946181976965, 'f1-score': 0.340772612851462, 'support': 36642}}
[[2540 6775 3091]
 [2235 7189 2758]
 [2319 6322 3413]]
training model: results/XRAY/W3/deepLOB_L1/h300
Epoch 1/50
444/444 - 32s - loss: 3.3291 - accuracy300: 0.3626 - val_loss: 3.3543 - val_accuracy300: 0.3502 - 32s/epoch - 73ms/step
Epoch 2/50
444/444 - 22s - loss: 3.3056 - accuracy300: 0.3654 - val_loss: 3.3729 - val_accuracy300: 0.3460 - 22s/epoch - 49ms/step
Epoch 3/50
444/444 - 23s - loss: 3.2807 - accuracy300: 0.3802 - val_loss: 3.3899 - val_accuracy300: 0.3539 - 23s/epoch - 52ms/step
Epoch 4/50
444/444 - 20s - loss: 3.2626 - accuracy300: 0.3918 - val_loss: 3.3833 - val_accuracy300: 0.3623 - 20s/epoch - 46ms/step
Epoch 5/50
444/444 - 22s - loss: 3.2514 - accuracy300: 0.3994 - val_loss: 3.4094 - val_accuracy300: 0.3550 - 22s/epoch - 49ms/step
Epoch 6/50
444/444 - 21s - loss: 3.2406 - accuracy300: 0.4068 - val_loss: 3.4119 - val_accuracy300: 0.3569 - 21s/epoch - 48ms/step
Epoch 7/50
444/444 - 20s - loss: 3.2320 - accuracy300: 0.4121 - val_loss: 3.4407 - val_accuracy300: 0.3617 - 20s/epoch - 44ms/step
Epoch 8/50
444/444 - 23s - loss: 3.2236 - accuracy300: 0.4166 - val_loss: 3.4373 - val_accuracy300: 0.3544 - 23s/epoch - 51ms/step
Epoch 9/50
444/444 - 22s - loss: 3.2190 - accuracy300: 0.4188 - val_loss: 3.4193 - val_accuracy300: 0.3549 - 22s/epoch - 49ms/step
Epoch 10/50
444/444 - 21s - loss: 3.2110 - accuracy300: 0.4241 - val_loss: 3.4315 - val_accuracy300: 0.3555 - 21s/epoch - 47ms/step
Epoch 11/50
444/444 - 23s - loss: 3.2076 - accuracy300: 0.4239 - val_loss: 3.4452 - val_accuracy300: 0.3408 - 23s/epoch - 52ms/step
testing model: results/XRAY/W3/deepLOB_L1/h300
Evaluating performance on  test set...
1359/1359 - 36s - 36s/epoch - 26ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0966016
{'0': {'precision': 0.3065180372217727, 'recall': 0.24881865061469383, 'f1-score': 0.27467086573269917, 'support': 102002}, '1': {'precision': 0.44024709204074525, 'recall': 0.5749803058702089, 'f1-score': 0.4986733182357636, 'support': 147252}, '2': {'precision': 0.31128324367458693, 'recall': 0.22958588287822054, 'f1-score': 0.264264439642586, 'support': 98547}, 'accuracy': 0.38145951276735834, 'macro avg': {'precision': 0.35268279097903493, 'recall': 0.3511282797877077, 'f1-score': 0.3458695412036829, 'support': 347801}, 'weighted avg': {'precision': 0.36448643748660464, 'recall': 0.38145951276735834, 'f1-score': 0.36656044357772793, 'support': 347801}}
[[25380 56204 20418]
 [32945 84667 29640]
 [24476 51446 22625]]
Evaluating performance on  train set...
444/444 - 14s - 14s/epoch - 32ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1208403
{'0': {'precision': 0.34036546555795094, 'recall': 0.35553053455578787, 'f1-score': 0.3477827603388141, 'support': 37302}, '1': {'precision': 0.351319258910018, 'recall': 0.5414592136071266, 'f1-score': 0.42614165890027955, 'support': 37157}, '2': {'precision': 0.36985827860352577, 'recall': 0.164068489649885, 'f1-score': 0.22730491431808522, 'support': 39130}, 'accuracy': 0.3503948445712173, 'macro avg': {'precision': 0.35384766769049825, 'recall': 0.35368607927093315, 'f1-score': 0.3337431111857263, 'support': 113589}, 'weighted avg': {'precision': 0.3541085557696448, 'recall': 0.3503948445712173, 'f1-score': 0.33191224012169146, 'support': 113589}}
[[13262 18469  5571]
 [11671 20119  5367]
 [14031 18679  6420]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 30ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1200736
{'0': {'precision': 0.3670967741935484, 'recall': 0.26605361596009974, 'f1-score': 0.3085125609976505, 'support': 12832}, '1': {'precision': 0.3251757221281617, 'recall': 0.5562088635366389, 'f1-score': 0.41041248462086377, 'support': 11395}, '2': {'precision': 0.3697618137816839, 'recall': 0.23383004430124849, 'f1-score': 0.28648968716076184, 'support': 12415}, 'accuracy': 0.3453687025817368, 'macro avg': {'precision': 0.35401143670113133, 'recall': 0.35203084126599565, 'f1-score': 0.33513824425975874, 'support': 36642}, 'weighted avg': {'precision': 0.3549630500027734, 'recall': 0.3453687025817368, 'f1-score': 0.3327398316433997, 'support': 36642}}
[[3414 6705 2713]
 [2822 6338 2235]
 [3064 6448 2903]]
training model: results/XRAY/W3/deepLOB_L1/h500
Epoch 1/50
444/444 - 30s - loss: 3.3204 - accuracy500: 0.3674 - val_loss: 3.3524 - val_accuracy500: 0.3500 - 30s/epoch - 69ms/step
Epoch 2/50
444/444 - 24s - loss: 3.2931 - accuracy500: 0.3776 - val_loss: 3.3617 - val_accuracy500: 0.3452 - 24s/epoch - 55ms/step
Epoch 3/50
444/444 - 22s - loss: 3.2792 - accuracy500: 0.3879 - val_loss: 3.3751 - val_accuracy500: 0.3663 - 22s/epoch - 51ms/step
Epoch 4/50
444/444 - 23s - loss: 3.2595 - accuracy500: 0.3927 - val_loss: 3.3943 - val_accuracy500: 0.3625 - 23s/epoch - 52ms/step
Epoch 5/50
444/444 - 21s - loss: 3.2398 - accuracy500: 0.4047 - val_loss: 3.3998 - val_accuracy500: 0.3635 - 21s/epoch - 47ms/step
Epoch 6/50
444/444 - 23s - loss: 3.2258 - accuracy500: 0.4122 - val_loss: 3.3897 - val_accuracy500: 0.3696 - 23s/epoch - 52ms/step
Epoch 7/50
444/444 - 22s - loss: 3.2056 - accuracy500: 0.4245 - val_loss: 3.4280 - val_accuracy500: 0.3671 - 22s/epoch - 49ms/step
Epoch 8/50
444/444 - 22s - loss: 3.2026 - accuracy500: 0.4265 - val_loss: 3.4330 - val_accuracy500: 0.3664 - 22s/epoch - 50ms/step
Epoch 9/50
444/444 - 22s - loss: 3.1916 - accuracy500: 0.4322 - val_loss: 3.4366 - val_accuracy500: 0.3647 - 22s/epoch - 50ms/step
Epoch 10/50
444/444 - 22s - loss: 3.1813 - accuracy500: 0.4352 - val_loss: 3.4462 - val_accuracy500: 0.3679 - 22s/epoch - 51ms/step
Epoch 11/50
444/444 - 24s - loss: 3.1735 - accuracy500: 0.4400 - val_loss: 3.4751 - val_accuracy500: 0.3667 - 24s/epoch - 54ms/step
testing model: results/XRAY/W3/deepLOB_L1/h500
Evaluating performance on  test set...
1359/1359 - 37s - 37s/epoch - 27ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1081659
{'0': {'precision': 0.32284665448935074, 'recall': 0.18361069087241552, 'f1-score': 0.23408919949337467, 'support': 99150}, '1': {'precision': 0.4573631405292573, 'recall': 0.45220801182399817, 'f1-score': 0.45477096745036205, 'support': 150203}, '2': {'precision': 0.29980686064575723, 'recall': 0.4351840565577767, 'f1-score': 0.3550279676817899, 'support': 98448}, 'accuracy': 0.37081837027495607, 'macro avg': {'precision': 0.3600055518881217, 'recall': 0.3570009197513968, 'f1-score': 0.3479627115418422, 'support': 347801}, 'weighted avg': {'precision': 0.3744179786900805, 'recall': 0.37081837027495607, 'f1-score': 0.36362661727841983, 'support': 347801}}
[[18205 41948 38997]
 [21218 67923 61062]
 [16966 38639 42843]]
Evaluating performance on  train set...
444/444 - 13s - 13s/epoch - 30ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1401801
{'0': {'precision': 0.34430904848327715, 'recall': 0.4974315068493151, 'f1-score': 0.40694289403988, 'support': 37376}, '1': {'precision': 0.3686839715091544, 'recall': 0.41145402651444424, 'f1-score': 0.3888965925851223, 'support': 37489}, '2': {'precision': 0.35909423759364617, 'recall': 0.16462658816237993, 'f1-score': 0.22575561733094893, 'support': 38724}, 'accuracy': 0.3555978131685286, 'macro avg': {'precision': 0.3573624191953592, 'recall': 0.3578373738420464, 'f1-score': 0.3405317013186504, 'support': 113589}, 'weighted avg': {'precision': 0.35739423413001264, 'recall': 0.3555978131685286, 'f1-score': 0.3392177278837024, 'support': 113589}}
[[18592 13050  5734]
 [16420 15425  5644]
 [18986 13363  6375]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 25ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.119248
{'0': {'precision': 0.36385972749609113, 'recall': 0.38022251614409086, 'f1-score': 0.37186120833967434, 'support': 12853}, '1': {'precision': 0.33156612695228543, 'recall': 0.4061786905388801, 'f1-score': 0.36509940044177974, 'support': 11394}, '2': {'precision': 0.3712309521236356, 'recall': 0.2771278741427995, 'f1-score': 0.31735033259423506, 'support': 12395}, 'accuracy': 0.3534195731674035, 'macro avg': {'precision': 0.3555522688573374, 'recall': 0.35450969360859014, 'f1-score': 0.35143698045856303, 'support': 36642}, 'weighted avg': {'precision': 0.35631136890928616, 'recall': 0.3534195731674035, 'f1-score': 0.3513190342210855, 'support': 36642}}
[[4887 4776 3190]
 [4138 4628 2628]
 [4406 4554 3435]]
training model: results/XRAY/W3/deepLOB_L1/h1000
Epoch 1/50
444/444 - 29s - loss: 3.3102 - accuracy1000: 0.3809 - val_loss: 3.4258 - val_accuracy1000: 0.3701 - 29s/epoch - 66ms/step
Epoch 2/50
444/444 - 24s - loss: 3.2713 - accuracy1000: 0.3950 - val_loss: 3.5519 - val_accuracy1000: 0.3714 - 24s/epoch - 54ms/step
Epoch 3/50
444/444 - 23s - loss: 3.2144 - accuracy1000: 0.4220 - val_loss: 3.6530 - val_accuracy1000: 0.3628 - 23s/epoch - 52ms/step
Epoch 4/50
444/444 - 23s - loss: 3.1890 - accuracy1000: 0.4311 - val_loss: 3.6072 - val_accuracy1000: 0.3653 - 23s/epoch - 52ms/step
Epoch 5/50
444/444 - 26s - loss: 3.1599 - accuracy1000: 0.4478 - val_loss: 3.7424 - val_accuracy1000: 0.3658 - 26s/epoch - 59ms/step
Epoch 6/50
444/444 - 25s - loss: 3.1383 - accuracy1000: 0.4519 - val_loss: 3.6838 - val_accuracy1000: 0.3658 - 25s/epoch - 57ms/step
Epoch 7/50
444/444 - 24s - loss: 3.1233 - accuracy1000: 0.4619 - val_loss: 3.7590 - val_accuracy1000: 0.3661 - 24s/epoch - 53ms/step
Epoch 8/50
444/444 - 24s - loss: 3.1005 - accuracy1000: 0.4672 - val_loss: 3.6811 - val_accuracy1000: 0.3687 - 24s/epoch - 54ms/step
Epoch 9/50
444/444 - 24s - loss: 3.0951 - accuracy1000: 0.4724 - val_loss: 3.6509 - val_accuracy1000: 0.3659 - 24s/epoch - 55ms/step
Epoch 10/50
444/444 - 26s - loss: 3.0864 - accuracy1000: 0.4756 - val_loss: 3.6360 - val_accuracy1000: 0.3682 - 26s/epoch - 59ms/step
Epoch 11/50
444/444 - 25s - loss: 3.0765 - accuracy1000: 0.4788 - val_loss: 3.7127 - val_accuracy1000: 0.3664 - 25s/epoch - 57ms/step
testing model: results/XRAY/W3/deepLOB_L1/h1000
Evaluating performance on  test set...
1359/1359 - 37s - 37s/epoch - 27ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1351042
{'0': {'precision': 0.327502712429543, 'recall': 0.2597680642283675, 'f1-score': 0.2897291982465484, 'support': 95285}, '1': {'precision': 0.4914886216310225, 'recall': 0.28619390160070707, 'f1-score': 0.3617441359808535, 'support': 162928}, '2': {'precision': 0.2560304482661404, 'recall': 0.5068424342545876, 'f1-score': 0.3402063400490002, 'support': 89588}, 'accuracy': 0.33578971883347086, 'macro avg': {'precision': 0.35834059410890196, 'recall': 0.3509348000278874, 'f1-score': 0.3305598914254674, 'support': 347801}, 'weighted avg': {'precision': 0.3859120873666701, 'recall': 0.33578971883347086, 'f1-score': 0.33646683256897103, 'support': 347801}}
[[24752 24455 46078]
 [30434 46629 85865]
 [20392 23789 45407]]
Evaluating performance on  train set...
444/444 - 13s - 13s/epoch - 29ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.148265
{'0': {'precision': 0.3378923373662984, 'recall': 0.5206560211828916, 'f1-score': 0.40982124817898574, 'support': 37011}, '1': {'precision': 0.3772456973853947, 'recall': 0.3176411370440035, 'f1-score': 0.34488709909391635, 'support': 37747}, '2': {'precision': 0.3787939941879238, 'recall': 0.24168834178877702, 'f1-score': 0.295093307340387, 'support': 38831}, 'accuracy': 0.3578251415189851, 'macro avg': {'precision': 0.36464400964653904, 'recall': 0.35999516667189063, 'f1-score': 0.3499338848710964, 'support': 113589}, 'weighted avg': {'precision': 0.3649523829400896, 'recall': 0.3578251415189851, 'f1-score': 0.3490224912903985, 'support': 113589}}
[[19270  9978  7763]
 [18129 11990  7628]
 [19631  9815  9385]]
Evaluating performance on  val set...
144/144 - 5s - 5s/epoch - 34ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1406528
{'0': {'precision': 0.3730707319382634, 'recall': 0.31692406692406694, 'f1-score': 0.34271299960857654, 'support': 12432}, '1': {'precision': 0.3727051966974259, 'recall': 0.3119258596862044, 'f1-score': 0.33961763143919277, 'support': 12301}, '2': {'precision': 0.36576713543646266, 'recall': 0.4848433957511126, 'f1-score': 0.4169705723054703, 'support': 11909}, 'accuracy': 0.36982151629277876, 'macro avg': {'precision': 0.3705143546907173, 'recall': 0.3712311074537947, 'f1-score': 0.3664337344510799, 'support': 36642}, 'weighted avg': {'precision': 0.37057428033252443, 'recall': 0.36982151629277876, 'f1-score': 0.3658082812361001, 'support': 36642}}
[[3940 3505 4987]
 [3439 3837 5025]
 [3182 2953 5774]]
training model: results/XRAY/W3/deepOF_L1/h10
Epoch 1/50
444/444 - 27s - loss: 3.2950 - accuracy10: 0.3735 - val_loss: 3.2479 - val_accuracy10: 0.3903 - 27s/epoch - 61ms/step
Epoch 2/50
444/444 - 20s - loss: 3.2559 - accuracy10: 0.3967 - val_loss: 3.2352 - val_accuracy10: 0.3974 - 20s/epoch - 45ms/step
Epoch 3/50
444/444 - 29s - loss: 3.2410 - accuracy10: 0.4010 - val_loss: 3.2298 - val_accuracy10: 0.3968 - 29s/epoch - 65ms/step
Epoch 4/50
444/444 - 22s - loss: 3.2334 - accuracy10: 0.4040 - val_loss: 3.2255 - val_accuracy10: 0.4013 - 22s/epoch - 50ms/step
Epoch 5/50
444/444 - 25s - loss: 3.2262 - accuracy10: 0.4083 - val_loss: 3.2259 - val_accuracy10: 0.4025 - 25s/epoch - 57ms/step
Epoch 6/50
444/444 - 24s - loss: 3.2227 - accuracy10: 0.4079 - val_loss: 3.2245 - val_accuracy10: 0.4027 - 24s/epoch - 53ms/step
Epoch 7/50
444/444 - 23s - loss: 3.2184 - accuracy10: 0.4108 - val_loss: 3.2220 - val_accuracy10: 0.4046 - 23s/epoch - 53ms/step
Epoch 8/50
444/444 - 23s - loss: 3.2132 - accuracy10: 0.4118 - val_loss: 3.2197 - val_accuracy10: 0.4043 - 23s/epoch - 52ms/step
Epoch 9/50
444/444 - 21s - loss: 3.2093 - accuracy10: 0.4148 - val_loss: 3.2186 - val_accuracy10: 0.4059 - 21s/epoch - 48ms/step
Epoch 10/50
444/444 - 21s - loss: 3.2059 - accuracy10: 0.4167 - val_loss: 3.2183 - val_accuracy10: 0.4079 - 21s/epoch - 47ms/step
Epoch 11/50
444/444 - 19s - loss: 3.2027 - accuracy10: 0.4170 - val_loss: 3.2193 - val_accuracy10: 0.4065 - 19s/epoch - 43ms/step
Epoch 12/50
444/444 - 23s - loss: 3.1981 - accuracy10: 0.4182 - val_loss: 3.2164 - val_accuracy10: 0.4083 - 23s/epoch - 52ms/step
Epoch 13/50
444/444 - 23s - loss: 3.1956 - accuracy10: 0.4204 - val_loss: 3.2176 - val_accuracy10: 0.4082 - 23s/epoch - 51ms/step
Epoch 14/50
444/444 - 22s - loss: 3.1908 - accuracy10: 0.4236 - val_loss: 3.2179 - val_accuracy10: 0.4057 - 22s/epoch - 49ms/step
Epoch 15/50
444/444 - 20s - loss: 3.1880 - accuracy10: 0.4238 - val_loss: 3.2169 - val_accuracy10: 0.4091 - 20s/epoch - 45ms/step
Epoch 16/50
444/444 - 21s - loss: 3.1843 - accuracy10: 0.4254 - val_loss: 3.2173 - val_accuracy10: 0.4106 - 21s/epoch - 48ms/step
Epoch 17/50
444/444 - 22s - loss: 3.1817 - accuracy10: 0.4271 - val_loss: 3.2182 - val_accuracy10: 0.4079 - 22s/epoch - 50ms/step
Epoch 18/50
444/444 - 22s - loss: 3.1781 - accuracy10: 0.4284 - val_loss: 3.2218 - val_accuracy10: 0.4039 - 22s/epoch - 50ms/step
Epoch 19/50
444/444 - 22s - loss: 3.1764 - accuracy10: 0.4274 - val_loss: 3.2156 - val_accuracy10: 0.4089 - 22s/epoch - 50ms/step
Epoch 20/50
444/444 - 20s - loss: 3.1714 - accuracy10: 0.4323 - val_loss: 3.2179 - val_accuracy10: 0.4065 - 20s/epoch - 46ms/step
Epoch 21/50
444/444 - 25s - loss: 3.1679 - accuracy10: 0.4331 - val_loss: 3.2186 - val_accuracy10: 0.4080 - 25s/epoch - 57ms/step
Epoch 22/50
444/444 - 22s - loss: 3.1674 - accuracy10: 0.4331 - val_loss: 3.2205 - val_accuracy10: 0.4051 - 22s/epoch - 49ms/step
Epoch 23/50
444/444 - 23s - loss: 3.1630 - accuracy10: 0.4342 - val_loss: 3.2185 - val_accuracy10: 0.4072 - 23s/epoch - 52ms/step
Epoch 24/50
444/444 - 22s - loss: 3.1601 - accuracy10: 0.4357 - val_loss: 3.2195 - val_accuracy10: 0.4081 - 22s/epoch - 49ms/step
Epoch 25/50
444/444 - 23s - loss: 3.1563 - accuracy10: 0.4380 - val_loss: 3.2250 - val_accuracy10: 0.4028 - 23s/epoch - 51ms/step
Epoch 26/50
444/444 - 21s - loss: 3.1539 - accuracy10: 0.4402 - val_loss: 3.2262 - val_accuracy10: 0.4052 - 21s/epoch - 48ms/step
Epoch 27/50
444/444 - 22s - loss: 3.1511 - accuracy10: 0.4405 - val_loss: 3.2242 - val_accuracy10: 0.4070 - 22s/epoch - 50ms/step
Epoch 28/50
444/444 - 24s - loss: 3.1471 - accuracy10: 0.4424 - val_loss: 3.2260 - val_accuracy10: 0.4050 - 24s/epoch - 53ms/step
Epoch 29/50
444/444 - 26s - loss: 3.1438 - accuracy10: 0.4422 - val_loss: 3.2289 - val_accuracy10: 0.4084 - 26s/epoch - 60ms/step
testing model: results/XRAY/W3/deepOF_L1/h10
Evaluating performance on  test set...
1359/1359 - 38s - 38s/epoch - 28ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0789809
{'0': {'precision': 0.4157972936270829, 'recall': 0.23650754704978963, 'f1-score': 0.3015130100326699, 'support': 110043}, '1': {'precision': 0.3924058038848584, 'recall': 0.5639667324068554, 'f1-score': 0.46279835649092, 'support': 130818}, '2': {'precision': 0.3884681866820314, 'recall': 0.35307099573576717, 'f1-score': 0.3699247530960965, 'support': 106936}, 'accuracy': 0.3955151999585965, 'macro avg': {'precision': 0.3988904280646575, 'recall': 0.38451509173080406, 'f1-score': 0.37807870653989545, 'support': 347797}, 'weighted avg': {'precision': 0.39859618698908905, 'recall': 0.3955151999585965, 'f1-score': 0.3832121178720301, 'support': 347797}}
[[26026 59882 24135]
 [21740 73777 35301]
 [14827 54353 37756]]
Evaluating performance on  train set...
444/444 - 13s - 13s/epoch - 28ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0700204
{'0': {'precision': 0.4755705237760129, 'recall': 0.2518768968638518, 'f1-score': 0.3293302701197438, 'support': 37562}, '1': {'precision': 0.37825673928955195, 'recall': 0.6345917700849119, 'f1-score': 0.4739871985012879, 'support': 38275}, '2': {'precision': 0.44170821885282047, 'recall': 0.3449445047813303, 'f1-score': 0.3873750594954784, 'support': 37751}, 'accuracy': 0.41176884882205866, 'macro avg': {'precision': 0.43184516063946177, 'recall': 0.4104710572433647, 'f1-score': 0.39689750937217005, 'support': 113588}, 'weighted avg': {'precision': 0.4315251935089536, 'recall': 0.41176884882205866, 'f1-score': 0.397365562382368, 'support': 113588}}
[[ 9461 20299  7802]
 [ 5329 24289  8657]
 [ 5104 19625 13022]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 25ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0723525
{'0': {'precision': 0.44240800789510787, 'recall': 0.2673368546600784, 'f1-score': 0.3332802294089533, 'support': 11738}, '1': {'precision': 0.3873960171414167, 'recall': 0.5813284914510516, 'f1-score': 0.46495023144646475, 'support': 13218}, '2': {'precision': 0.42639489396746966, 'recall': 0.35444121170631526, 'f1-score': 0.38710280373831774, 'support': 11686}, 'accuracy': 0.4083838218437858, 'macro avg': {'precision': 0.4187329730013314, 'recall': 0.4010355192724817, 'f1-score': 0.3951110881979119, 'support': 36642}, 'weighted avg': {'precision': 0.4174563747107656, 'recall': 0.4083838218437858, 'f1-score': 0.3979433124978889, 'support': 36642}}
[[3138 6255 2345]
 [2307 7684 3227]
 [1648 5896 4142]]
training model: results/XRAY/W3/deepOF_L1/h20
Epoch 1/50
444/444 - 29s - loss: 3.3053 - accuracy20: 0.3651 - val_loss: 3.2570 - val_accuracy20: 0.3834 - 29s/epoch - 65ms/step
Epoch 2/50
444/444 - 20s - loss: 3.2681 - accuracy20: 0.3848 - val_loss: 3.2434 - val_accuracy20: 0.3913 - 20s/epoch - 45ms/step
Epoch 3/50
444/444 - 21s - loss: 3.2555 - accuracy20: 0.3911 - val_loss: 3.2400 - val_accuracy20: 0.3910 - 21s/epoch - 47ms/step
Epoch 4/50
444/444 - 21s - loss: 3.2465 - accuracy20: 0.3960 - val_loss: 3.2326 - val_accuracy20: 0.3951 - 21s/epoch - 46ms/step
Epoch 5/50
444/444 - 21s - loss: 3.2409 - accuracy20: 0.3986 - val_loss: 3.2338 - val_accuracy20: 0.3919 - 21s/epoch - 46ms/step
Epoch 6/50
444/444 - 22s - loss: 3.2363 - accuracy20: 0.4005 - val_loss: 3.2321 - val_accuracy20: 0.3954 - 22s/epoch - 48ms/step
Epoch 7/50
444/444 - 21s - loss: 3.2335 - accuracy20: 0.4016 - val_loss: 3.2314 - val_accuracy20: 0.3967 - 21s/epoch - 47ms/step
Epoch 8/50
444/444 - 21s - loss: 3.2277 - accuracy20: 0.4037 - val_loss: 3.2295 - val_accuracy20: 0.3941 - 21s/epoch - 46ms/step
Epoch 9/50
444/444 - 20s - loss: 3.2254 - accuracy20: 0.4070 - val_loss: 3.2282 - val_accuracy20: 0.3954 - 20s/epoch - 45ms/step
Epoch 10/50
444/444 - 19s - loss: 3.2219 - accuracy20: 0.4083 - val_loss: 3.2282 - val_accuracy20: 0.3927 - 19s/epoch - 44ms/step
Epoch 11/50
444/444 - 19s - loss: 3.2181 - accuracy20: 0.4106 - val_loss: 3.2289 - val_accuracy20: 0.3957 - 19s/epoch - 43ms/step
Epoch 12/50
444/444 - 20s - loss: 3.2168 - accuracy20: 0.4121 - val_loss: 3.2271 - val_accuracy20: 0.3975 - 20s/epoch - 45ms/step
Epoch 13/50
444/444 - 20s - loss: 3.2136 - accuracy20: 0.4124 - val_loss: 3.2280 - val_accuracy20: 0.3961 - 20s/epoch - 45ms/step
Epoch 14/50
444/444 - 20s - loss: 3.2106 - accuracy20: 0.4141 - val_loss: 3.2264 - val_accuracy20: 0.3977 - 20s/epoch - 45ms/step
Epoch 15/50
444/444 - 20s - loss: 3.2071 - accuracy20: 0.4168 - val_loss: 3.2254 - val_accuracy20: 0.3997 - 20s/epoch - 46ms/step
Epoch 16/50
444/444 - 21s - loss: 3.2055 - accuracy20: 0.4166 - val_loss: 3.2267 - val_accuracy20: 0.3969 - 21s/epoch - 47ms/step
Epoch 17/50
444/444 - 19s - loss: 3.2031 - accuracy20: 0.4184 - val_loss: 3.2283 - val_accuracy20: 0.3975 - 19s/epoch - 43ms/step
Epoch 18/50
444/444 - 20s - loss: 3.1997 - accuracy20: 0.4195 - val_loss: 3.2258 - val_accuracy20: 0.4003 - 20s/epoch - 46ms/step
Epoch 19/50
444/444 - 19s - loss: 3.1958 - accuracy20: 0.4227 - val_loss: 3.2280 - val_accuracy20: 0.3977 - 19s/epoch - 43ms/step
Epoch 20/50
444/444 - 17s - loss: 3.1925 - accuracy20: 0.4242 - val_loss: 3.2286 - val_accuracy20: 0.3969 - 17s/epoch - 39ms/step
Epoch 21/50
444/444 - 16s - loss: 3.1888 - accuracy20: 0.4253 - val_loss: 3.2300 - val_accuracy20: 0.4002 - 16s/epoch - 37ms/step
Epoch 22/50
444/444 - 18s - loss: 3.1867 - accuracy20: 0.4264 - val_loss: 3.2284 - val_accuracy20: 0.3992 - 18s/epoch - 40ms/step
Epoch 23/50
444/444 - 18s - loss: 3.1836 - accuracy20: 0.4266 - val_loss: 3.2263 - val_accuracy20: 0.4020 - 18s/epoch - 40ms/step
Epoch 24/50
444/444 - 17s - loss: 3.1802 - accuracy20: 0.4307 - val_loss: 3.2293 - val_accuracy20: 0.4013 - 17s/epoch - 39ms/step
Epoch 25/50
444/444 - 18s - loss: 3.1765 - accuracy20: 0.4300 - val_loss: 3.2327 - val_accuracy20: 0.3988 - 18s/epoch - 40ms/step
testing model: results/XRAY/W3/deepOF_L1/h20
Evaluating performance on  test set...
1359/1359 - 28s - 28s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0836779
{'0': {'precision': 0.3998424671021652, 'recall': 0.41520639408245097, 'f1-score': 0.4073796231681786, 'support': 112479}, '1': {'precision': 0.3670846921964832, 'recall': 0.4386686701969513, 'f1-score': 0.3996968831682299, 'support': 124447}, '2': {'precision': 0.39967914828453716, 'recall': 0.2966149849825473, 'f1-score': 0.34051938369781315, 'support': 110871}, 'accuracy': 0.3857968872646975, 'macro avg': {'precision': 0.3888687691943952, 'recall': 0.38349668308731655, 'f1-score': 0.38253196334474054, 'support': 347797}, 'weighted avg': {'precision': 0.38806917942482283, 'recall': 0.3857968872646975, 'f1-score': 0.38331686369902707, 'support': 347797}}
[[46702 45995 19782]
 [40243 54591 29613]
 [29856 48129 32886]]
Evaluating performance on  train set...
444/444 - 11s - 11s/epoch - 24ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0738388
{'0': {'precision': 0.4302337966661341, 'recall': 0.4300734667802385, 'f1-score': 0.43015361678336567, 'support': 37568}, '1': {'precision': 0.368171214119079, 'recall': 0.4795233565842317, 'f1-score': 0.4165337433873059, 'support': 37848}, '2': {'precision': 0.44156475560043384, 'recall': 0.3093104893639317, 'f1-score': 0.3637904207299225, 'support': 38172}, 'accuracy': 0.40596717963165124, 'macro avg': {'precision': 0.41332325546188226, 'recall': 0.406302437576134, 'f1-score': 0.40349259363353135, 'support': 113588}, 'weighted avg': {'precision': 0.41336212659710525, 'recall': 0.40596717963165124, 'f1-score': 0.4033136258684266, 'support': 113588}}
[[16157 14790  6621]
 [11388 18149  8311]
 [10009 16356 11807]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0764438
{'0': {'precision': 0.41886332469907056, 'recall': 0.4567583284871646, 'f1-score': 0.4369908198545484, 'support': 12037}, '1': {'precision': 0.355575185160019, 'recall': 0.4171050534034752, 'f1-score': 0.3838902541906613, 'support': 12546}, '2': {'precision': 0.43664052733265146, 'recall': 0.3186002156066009, 'f1-score': 0.3683958193498898, 'support': 12059}, 'accuracy': 0.397713006931936, 'macro avg': {'precision': 0.40369301239724703, 'recall': 0.3974878658324135, 'f1-score': 0.3964256311316998, 'support': 36642}, 'weighted avg': {'precision': 0.40304438162558687, 'recall': 0.397713006931936, 'f1-score': 0.3962346709569772, 'support': 36642}}
[[5498 4492 2047]
 [4403 5233 2910]
 [3225 4992 3842]]
training model: results/XRAY/W3/deepOF_L1/h30
Epoch 1/50
444/444 - 26s - loss: 3.3048 - accuracy30: 0.3649 - val_loss: 3.2628 - val_accuracy30: 0.3806 - 26s/epoch - 59ms/step
Epoch 2/50
444/444 - 19s - loss: 3.2696 - accuracy30: 0.3845 - val_loss: 3.2502 - val_accuracy30: 0.3895 - 19s/epoch - 44ms/step
Epoch 3/50
444/444 - 19s - loss: 3.2560 - accuracy30: 0.3907 - val_loss: 3.2478 - val_accuracy30: 0.3868 - 19s/epoch - 42ms/step
Epoch 4/50
444/444 - 18s - loss: 3.2475 - accuracy30: 0.3940 - val_loss: 3.2434 - val_accuracy30: 0.3915 - 18s/epoch - 40ms/step
Epoch 5/50
444/444 - 18s - loss: 3.2436 - accuracy30: 0.3958 - val_loss: 3.2418 - val_accuracy30: 0.3895 - 18s/epoch - 40ms/step
Epoch 6/50
444/444 - 18s - loss: 3.2394 - accuracy30: 0.3993 - val_loss: 3.2386 - val_accuracy30: 0.3962 - 18s/epoch - 42ms/step
Epoch 7/50
444/444 - 18s - loss: 3.2353 - accuracy30: 0.4015 - val_loss: 3.2391 - val_accuracy30: 0.3950 - 18s/epoch - 40ms/step
Epoch 8/50
444/444 - 19s - loss: 3.2311 - accuracy30: 0.4045 - val_loss: 3.2360 - val_accuracy30: 0.3939 - 19s/epoch - 42ms/step
Epoch 9/50
444/444 - 17s - loss: 3.2261 - accuracy30: 0.4057 - val_loss: 3.2368 - val_accuracy30: 0.3946 - 17s/epoch - 39ms/step
Epoch 10/50
444/444 - 17s - loss: 3.2238 - accuracy30: 0.4068 - val_loss: 3.2388 - val_accuracy30: 0.3941 - 17s/epoch - 39ms/step
Epoch 11/50
444/444 - 17s - loss: 3.2203 - accuracy30: 0.4095 - val_loss: 3.2367 - val_accuracy30: 0.3969 - 17s/epoch - 39ms/step
Epoch 12/50
444/444 - 18s - loss: 3.2194 - accuracy30: 0.4112 - val_loss: 3.2347 - val_accuracy30: 0.3959 - 18s/epoch - 40ms/step
Epoch 13/50
444/444 - 18s - loss: 3.2152 - accuracy30: 0.4128 - val_loss: 3.2379 - val_accuracy30: 0.3946 - 18s/epoch - 40ms/step
Epoch 14/50
444/444 - 17s - loss: 3.2129 - accuracy30: 0.4129 - val_loss: 3.2356 - val_accuracy30: 0.3972 - 17s/epoch - 39ms/step
Epoch 15/50
444/444 - 17s - loss: 3.2094 - accuracy30: 0.4161 - val_loss: 3.2352 - val_accuracy30: 0.4002 - 17s/epoch - 39ms/step
Epoch 16/50
444/444 - 19s - loss: 3.2058 - accuracy30: 0.4179 - val_loss: 3.2370 - val_accuracy30: 0.3983 - 19s/epoch - 43ms/step
Epoch 17/50
444/444 - 20s - loss: 3.2048 - accuracy30: 0.4177 - val_loss: 3.2391 - val_accuracy30: 0.3975 - 20s/epoch - 44ms/step
Epoch 18/50
444/444 - 18s - loss: 3.2002 - accuracy30: 0.4202 - val_loss: 3.2381 - val_accuracy30: 0.4012 - 18s/epoch - 40ms/step
Epoch 19/50
444/444 - 20s - loss: 3.1985 - accuracy30: 0.4212 - val_loss: 3.2395 - val_accuracy30: 0.3974 - 20s/epoch - 44ms/step
Epoch 20/50
444/444 - 18s - loss: 3.1944 - accuracy30: 0.4235 - val_loss: 3.2398 - val_accuracy30: 0.3961 - 18s/epoch - 40ms/step
Epoch 21/50
444/444 - 18s - loss: 3.1907 - accuracy30: 0.4253 - val_loss: 3.2412 - val_accuracy30: 0.3999 - 18s/epoch - 40ms/step
Epoch 22/50
444/444 - 20s - loss: 3.1883 - accuracy30: 0.4258 - val_loss: 3.2421 - val_accuracy30: 0.3995 - 20s/epoch - 46ms/step
testing model: results/XRAY/W3/deepOF_L1/h30
Evaluating performance on  test set...
1359/1359 - 29s - 29s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0878974
{'0': {'precision': 0.3917499145364075, 'recall': 0.4504739025988207, 'f1-score': 0.41906464589004916, 'support': 114475}, '1': {'precision': 0.36641941570694253, 'recall': 0.3720077618595434, 'f1-score': 0.3691924427490299, 'support': 121105}, '2': {'precision': 0.3895826628044201, 'recall': 0.32359624655800817, 'f1-score': 0.3535367794885775, 'support': 112217}, 'accuracy': 0.382214337673988, 'macro avg': {'precision': 0.38258399768259005, 'recall': 0.38202597033879077, 'f1-score': 0.38059795604255214, 'support': 347797}, 'weighted avg': {'precision': 0.3822304173919503, 'recall': 0.382214337673988, 'f1-score': 0.3805562236053052, 'support': 347797}}
[[51568 38655 24252]
 [43408 45052 32645]
 [36659 39245 36313]]
Evaluating performance on  train set...
444/444 - 11s - 11s/epoch - 25ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0759208
{'0': {'precision': 0.41508294224246084, 'recall': 0.4762107844443852, 'f1-score': 0.4435506895567224, 'support': 37517}, '1': {'precision': 0.3652261254764603, 'recall': 0.3774554165557626, 'f1-score': 0.37124008481897436, 'support': 37570}, '2': {'precision': 0.4336654265716628, 'recall': 0.35726344770265706, 'f1-score': 0.39177430609948866, 'support': 38501}, 'accuracy': 0.4032292143536289, 'macro avg': {'precision': 0.40465816476352795, 'recall': 0.4036432162342683, 'f1-score': 0.40218836015839515, 'support': 113588}, 'weighted avg': {'precision': 0.4048910524588566, 'recall': 0.4032292143536289, 'f1-score': 0.4020837039641937, 'support': 113588}}
[[17866 11752  7899]
 [13325 14181 10064]
 [11851 12895 13755]]
Evaluating performance on  val set...
144/144 - 5s - 5s/epoch - 33ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0799859
{'0': {'precision': 0.41191235330031883, 'recall': 0.49249736393868115, 'f1-score': 0.4486147026228297, 'support': 12329}, '1': {'precision': 0.33405279760916484, 'recall': 0.33550108387527094, 'f1-score': 0.33477537437603994, 'support': 11994}, '2': {'precision': 0.4359208523592085, 'recall': 0.3487296046757042, 'f1-score': 0.38748083340849643, 'support': 12319}, 'accuracy': 0.3927733202336117, 'macro avg': {'precision': 0.3939620010895641, 'recall': 0.3922426841632188, 'f1-score': 0.390290303469122, 'support': 36642}, 'weighted avg': {'precision': 0.39449827079791067, 'recall': 0.3927733202336117, 'f1-score': 0.3907986162235238, 'support': 36642}}
[[6072 3919 2338]
 [4749 4024 3221]
 [3920 4103 4296]]
training model: results/XRAY/W3/deepOF_L1/h50
Epoch 1/50
444/444 - 20s - loss: 3.3119 - accuracy50: 0.3603 - val_loss: 3.2827 - val_accuracy50: 0.3715 - 20s/epoch - 45ms/step
Epoch 2/50
444/444 - 19s - loss: 3.2778 - accuracy50: 0.3757 - val_loss: 3.2694 - val_accuracy50: 0.3775 - 19s/epoch - 43ms/step
Epoch 3/50
444/444 - 20s - loss: 3.2650 - accuracy50: 0.3825 - val_loss: 3.2715 - val_accuracy50: 0.3798 - 20s/epoch - 44ms/step
Epoch 4/50
444/444 - 19s - loss: 3.2564 - accuracy50: 0.3878 - val_loss: 3.2665 - val_accuracy50: 0.3818 - 19s/epoch - 44ms/step
Epoch 5/50
444/444 - 18s - loss: 3.2521 - accuracy50: 0.3908 - val_loss: 3.2657 - val_accuracy50: 0.3800 - 18s/epoch - 41ms/step
Epoch 6/50
444/444 - 21s - loss: 3.2487 - accuracy50: 0.3924 - val_loss: 3.2615 - val_accuracy50: 0.3879 - 21s/epoch - 48ms/step
Epoch 7/50
444/444 - 22s - loss: 3.2454 - accuracy50: 0.3951 - val_loss: 3.2634 - val_accuracy50: 0.3885 - 22s/epoch - 49ms/step
Epoch 8/50
444/444 - 21s - loss: 3.2397 - accuracy50: 0.3983 - val_loss: 3.2623 - val_accuracy50: 0.3843 - 21s/epoch - 48ms/step
Epoch 9/50
444/444 - 19s - loss: 3.2364 - accuracy50: 0.3997 - val_loss: 3.2610 - val_accuracy50: 0.3890 - 19s/epoch - 44ms/step
Epoch 10/50
444/444 - 20s - loss: 3.2336 - accuracy50: 0.4021 - val_loss: 3.2619 - val_accuracy50: 0.3882 - 20s/epoch - 44ms/step
Epoch 11/50
444/444 - 19s - loss: 3.2298 - accuracy50: 0.4050 - val_loss: 3.2599 - val_accuracy50: 0.3906 - 19s/epoch - 42ms/step
Epoch 12/50
444/444 - 20s - loss: 3.2260 - accuracy50: 0.4066 - val_loss: 3.2642 - val_accuracy50: 0.3908 - 20s/epoch - 45ms/step
Epoch 13/50
444/444 - 19s - loss: 3.2241 - accuracy50: 0.4088 - val_loss: 3.2611 - val_accuracy50: 0.3918 - 19s/epoch - 42ms/step
Epoch 14/50
444/444 - 20s - loss: 3.2197 - accuracy50: 0.4110 - val_loss: 3.2630 - val_accuracy50: 0.3890 - 20s/epoch - 46ms/step
Epoch 15/50
444/444 - 20s - loss: 3.2167 - accuracy50: 0.4136 - val_loss: 3.2622 - val_accuracy50: 0.3931 - 20s/epoch - 45ms/step
Epoch 16/50
444/444 - 19s - loss: 3.2140 - accuracy50: 0.4144 - val_loss: 3.2623 - val_accuracy50: 0.3908 - 19s/epoch - 44ms/step
Epoch 17/50
444/444 - 19s - loss: 3.2079 - accuracy50: 0.4191 - val_loss: 3.2669 - val_accuracy50: 0.3897 - 19s/epoch - 44ms/step
Epoch 18/50
444/444 - 20s - loss: 3.2060 - accuracy50: 0.4182 - val_loss: 3.2682 - val_accuracy50: 0.3889 - 20s/epoch - 46ms/step
Epoch 19/50
444/444 - 21s - loss: 3.2003 - accuracy50: 0.4232 - val_loss: 3.2676 - val_accuracy50: 0.3960 - 21s/epoch - 47ms/step
Epoch 20/50
444/444 - 21s - loss: 3.1980 - accuracy50: 0.4236 - val_loss: 3.2674 - val_accuracy50: 0.3963 - 21s/epoch - 47ms/step
Epoch 21/50
444/444 - 21s - loss: 3.1946 - accuracy50: 0.4264 - val_loss: 3.2721 - val_accuracy50: 0.3898 - 21s/epoch - 48ms/step
testing model: results/XRAY/W3/deepOF_L1/h50
Evaluating performance on  test set...
1359/1359 - 26s - 26s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1002892
{'0': {'precision': 0.41309333974092927, 'recall': 0.4539112067655036, 'f1-score': 0.43254143730653694, 'support': 124987}, '1': {'precision': 0.3137502087159793, 'recall': 0.37187923647050675, 'f1-score': 0.3403505753112024, 'support': 101057}, '2': {'precision': 0.41414865460961625, 'recall': 0.3084523584634465, 'f1-score': 0.3535703021658594, 'support': 121753}, 'accuracy': 0.37915508184371916, 'macro avg': {'precision': 0.38033073435550824, 'recall': 0.37808093389981895, 'f1-score': 0.3754874382611996, 'support': 347797}, 'weighted avg': {'precision': 0.3845973175188252, 'recall': 0.37915508184371916, 'f1-score': 0.378108809775404, 'support': 347797}}
[[56733 40980 27274]
 [37625 37581 25851]
 [42979 41219 37555]]
Evaluating performance on  train set...
444/444 - 10s - 10s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0799073
{'0': {'precision': 0.4048770920502092, 'recall': 0.49626048400021366, 'f1-score': 0.44593524230132253, 'support': 37438}, '1': {'precision': 0.36689566934609075, 'recall': 0.3515350175887432, 'f1-score': 0.3590511316466377, 'support': 37524}, '2': {'precision': 0.4282294390021104, 'recall': 0.35196499766996325, 'f1-score': 0.3863697724979751, 'support': 38626}, 'accuracy': 0.3993819769693982, 'macro avg': {'precision': 0.4000007334661368, 'recall': 0.39992016641964007, 'f1-score': 0.3971187154819784, 'support': 113588}, 'weighted avg': {'precision': 0.4002709087193538, 'recall': 0.3993819769693982, 'f1-score': 0.39697747207180456, 'support': 113588}}
[[18579 10724  8135]
 [14316 13191 10017]
 [12993 12038 13595]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0885476
{'0': {'precision': 0.413129130655821, 'recall': 0.5115675165250236, 'f1-score': 0.45710870482351285, 'support': 12708}, '1': {'precision': 0.32535087719298245, 'recall': 0.3292206639446121, 'f1-score': 0.3272743315979882, 'support': 11266}, '2': {'precision': 0.4413002314327793, 'recall': 0.3311493526997158, 'f1-score': 0.378371065211509, 'support': 12668}, 'accuracy': 0.39312810436111567, 'macro avg': {'precision': 0.3932600797605275, 'recall': 0.39064584438978384, 'f1-score': 0.3875847005443367, 'support': 36642}, 'weighted avg': {'precision': 0.3958801186240042, 'recall': 0.39312810436111567, 'f1-score': 0.38996819755416, 'support': 36642}}
[[6501 3690 2517]
 [4763 3709 2794]
 [4472 4001 4195]]
training model: results/XRAY/W3/deepOF_L1/h100
Epoch 1/50
444/444 - 26s - loss: 3.3282 - accuracy100: 0.3470 - val_loss: 3.2930 - val_accuracy100: 0.3635 - 26s/epoch - 58ms/step
Epoch 2/50
444/444 - 20s - loss: 3.2993 - accuracy100: 0.3595 - val_loss: 3.2831 - val_accuracy100: 0.3694 - 20s/epoch - 45ms/step
Epoch 3/50
444/444 - 19s - loss: 3.2866 - accuracy100: 0.3683 - val_loss: 3.2820 - val_accuracy100: 0.3709 - 19s/epoch - 42ms/step
Epoch 4/50
444/444 - 18s - loss: 3.2783 - accuracy100: 0.3724 - val_loss: 3.2776 - val_accuracy100: 0.3768 - 18s/epoch - 42ms/step
Epoch 5/50
444/444 - 19s - loss: 3.2742 - accuracy100: 0.3731 - val_loss: 3.2801 - val_accuracy100: 0.3713 - 19s/epoch - 43ms/step
Epoch 6/50
444/444 - 19s - loss: 3.2695 - accuracy100: 0.3793 - val_loss: 3.2773 - val_accuracy100: 0.3774 - 19s/epoch - 42ms/step
Epoch 7/50
444/444 - 19s - loss: 3.2673 - accuracy100: 0.3790 - val_loss: 3.2793 - val_accuracy100: 0.3743 - 19s/epoch - 44ms/step
Epoch 8/50
444/444 - 17s - loss: 3.2622 - accuracy100: 0.3838 - val_loss: 3.2795 - val_accuracy100: 0.3751 - 17s/epoch - 39ms/step
Epoch 9/50
444/444 - 20s - loss: 3.2603 - accuracy100: 0.3855 - val_loss: 3.2771 - val_accuracy100: 0.3754 - 20s/epoch - 44ms/step
Epoch 10/50
444/444 - 19s - loss: 3.2574 - accuracy100: 0.3880 - val_loss: 3.2795 - val_accuracy100: 0.3762 - 19s/epoch - 43ms/step
Epoch 11/50
444/444 - 21s - loss: 3.2540 - accuracy100: 0.3897 - val_loss: 3.2797 - val_accuracy100: 0.3759 - 21s/epoch - 48ms/step
Epoch 12/50
444/444 - 20s - loss: 3.2517 - accuracy100: 0.3908 - val_loss: 3.2800 - val_accuracy100: 0.3766 - 20s/epoch - 44ms/step
Epoch 13/50
444/444 - 19s - loss: 3.2503 - accuracy100: 0.3927 - val_loss: 3.2775 - val_accuracy100: 0.3764 - 19s/epoch - 43ms/step
Epoch 14/50
444/444 - 17s - loss: 3.2478 - accuracy100: 0.3942 - val_loss: 3.2795 - val_accuracy100: 0.3769 - 17s/epoch - 39ms/step
Epoch 15/50
444/444 - 18s - loss: 3.2451 - accuracy100: 0.3966 - val_loss: 3.2793 - val_accuracy100: 0.3770 - 18s/epoch - 40ms/step
Epoch 16/50
444/444 - 18s - loss: 3.2430 - accuracy100: 0.3982 - val_loss: 3.2809 - val_accuracy100: 0.3752 - 18s/epoch - 39ms/step
Epoch 17/50
444/444 - 18s - loss: 3.2399 - accuracy100: 0.3999 - val_loss: 3.2812 - val_accuracy100: 0.3786 - 18s/epoch - 39ms/step
Epoch 18/50
444/444 - 17s - loss: 3.2388 - accuracy100: 0.3983 - val_loss: 3.2820 - val_accuracy100: 0.3774 - 17s/epoch - 39ms/step
Epoch 19/50
444/444 - 18s - loss: 3.2344 - accuracy100: 0.4026 - val_loss: 3.2824 - val_accuracy100: 0.3769 - 18s/epoch - 41ms/step
testing model: results/XRAY/W3/deepOF_L1/h100
Evaluating performance on  test set...
1359/1359 - 27s - 27s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1014857
{'0': {'precision': 0.3217988569136669, 'recall': 0.6158584559881791, 'f1-score': 0.4227185015904796, 'support': 104222}, '1': {'precision': 0.4356389104326776, 'recall': 0.12933025404157045, 'f1-score': 0.1994490832400792, 'support': 143323}, '2': {'precision': 0.32116119030513857, 'recall': 0.3388959821250449, 'f1-score': 0.3297903319743739, 'support': 100252}, 'accuracy': 0.33553193385796887, 'macro avg': {'precision': 0.35953298588382765, 'recall': 0.3613615640515982, 'f1-score': 0.31731930560164423, 'support': 347797}, 'weighted avg': {'precision': 0.36852718015299035, 'recall': 0.33553193385796887, 'f1-score': 0.3039254191125161, 'support': 347797}}
[[64186 12025 28011]
 [80985 18536 43802]
 [54289 11988 33975]]
Evaluating performance on  train set...
444/444 - 11s - 11s/epoch - 24ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0885098
{'0': {'precision': 0.36619894959630006, 'recall': 0.6284607312938898, 'f1-score': 0.46275457643236395, 'support': 37167}, '1': {'precision': 0.39454492415402564, 'recall': 0.14304222521879378, 'f1-score': 0.20996254827004052, 'support': 37821}, '2': {'precision': 0.4014020115818348, 'recall': 0.37531088082901554, 'f1-score': 0.3879182230790858, 'support': 38600}, 'accuracy': 0.3808060710638448, 'macro avg': {'precision': 0.3873819617773868, 'recall': 0.38227127911389974, 'f1-score': 0.3535451159271634, 'support': 113588}, 'weighted avg': {'precision': 0.3876000773244877, 'recall': 0.3808060710638448, 'f1-score': 0.3531520608799837, 'support': 113588}}
[[23358  3919  9890]
 [20697  5410 11714]
 [19730  4383 14487]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 25ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0932041
{'0': {'precision': 0.370076194874163, 'recall': 0.6466031950944006, 'f1-score': 0.47073335487092133, 'support': 12394}, '1': {'precision': 0.35224704996233996, 'recall': 0.11836665822998398, 'f1-score': 0.1771912099014903, 'support': 11853}, '2': {'precision': 0.4088513267902581, 'recall': 0.36296893908834205, 'f1-score': 0.38454634813453564, 'support': 12395}, 'accuracy': 0.37978276294962066, 'macro avg': {'precision': 0.37705819054225365, 'recall': 0.3759795974709088, 'f1-score': 0.34415697096898246, 'support': 36642}, 'weighted avg': {'precision': 0.3774253817487921, 'recall': 0.37978276294962066, 'f1-score': 0.34662323553190694, 'support': 36642}}
[[8014 1276 3104]
 [7049 1403 3401]
 [6592 1304 4499]]
training model: results/XRAY/W3/deepOF_L1/h200
Epoch 1/50
444/444 - 26s - loss: 3.3381 - accuracy200: 0.3399 - val_loss: 3.3183 - val_accuracy200: 0.3359 - 26s/epoch - 58ms/step
Epoch 2/50
444/444 - 18s - loss: 3.3153 - accuracy200: 0.3448 - val_loss: 3.3065 - val_accuracy200: 0.3383 - 18s/epoch - 40ms/step
Epoch 3/50
444/444 - 19s - loss: 3.3041 - accuracy200: 0.3488 - val_loss: 3.3022 - val_accuracy200: 0.3415 - 19s/epoch - 43ms/step
Epoch 4/50
444/444 - 17s - loss: 3.2965 - accuracy200: 0.3527 - val_loss: 3.3011 - val_accuracy200: 0.3387 - 17s/epoch - 39ms/step
Epoch 5/50
444/444 - 19s - loss: 3.2923 - accuracy200: 0.3567 - val_loss: 3.2997 - val_accuracy200: 0.3390 - 19s/epoch - 43ms/step
Epoch 6/50
444/444 - 19s - loss: 3.2867 - accuracy200: 0.3615 - val_loss: 3.2972 - val_accuracy200: 0.3452 - 19s/epoch - 42ms/step
Epoch 7/50
444/444 - 18s - loss: 3.2851 - accuracy200: 0.3628 - val_loss: 3.2993 - val_accuracy200: 0.3444 - 18s/epoch - 41ms/step
Epoch 8/50
444/444 - 17s - loss: 3.2835 - accuracy200: 0.3641 - val_loss: 3.2960 - val_accuracy200: 0.3443 - 17s/epoch - 37ms/step
Epoch 9/50
444/444 - 17s - loss: 3.2810 - accuracy200: 0.3674 - val_loss: 3.2964 - val_accuracy200: 0.3448 - 17s/epoch - 37ms/step
Epoch 10/50
444/444 - 17s - loss: 3.2787 - accuracy200: 0.3688 - val_loss: 3.2970 - val_accuracy200: 0.3453 - 17s/epoch - 38ms/step
Epoch 11/50
444/444 - 16s - loss: 3.2753 - accuracy200: 0.3702 - val_loss: 3.2957 - val_accuracy200: 0.3480 - 16s/epoch - 37ms/step
Epoch 12/50
444/444 - 16s - loss: 3.2734 - accuracy200: 0.3726 - val_loss: 3.2984 - val_accuracy200: 0.3461 - 16s/epoch - 37ms/step
Epoch 13/50
444/444 - 17s - loss: 3.2717 - accuracy200: 0.3749 - val_loss: 3.2977 - val_accuracy200: 0.3457 - 17s/epoch - 39ms/step
Epoch 14/50
444/444 - 19s - loss: 3.2708 - accuracy200: 0.3754 - val_loss: 3.2980 - val_accuracy200: 0.3456 - 19s/epoch - 42ms/step
Epoch 15/50
444/444 - 18s - loss: 3.2680 - accuracy200: 0.3781 - val_loss: 3.2996 - val_accuracy200: 0.3437 - 18s/epoch - 40ms/step
Epoch 16/50
444/444 - 19s - loss: 3.2674 - accuracy200: 0.3787 - val_loss: 3.2986 - val_accuracy200: 0.3491 - 19s/epoch - 42ms/step
Epoch 17/50
444/444 - 18s - loss: 3.2657 - accuracy200: 0.3805 - val_loss: 3.2988 - val_accuracy200: 0.3492 - 18s/epoch - 40ms/step
Epoch 18/50
444/444 - 17s - loss: 3.2621 - accuracy200: 0.3820 - val_loss: 3.2994 - val_accuracy200: 0.3484 - 17s/epoch - 39ms/step
Epoch 19/50
444/444 - 18s - loss: 3.2608 - accuracy200: 0.3840 - val_loss: 3.3002 - val_accuracy200: 0.3507 - 18s/epoch - 39ms/step
Epoch 20/50
444/444 - 16s - loss: 3.2595 - accuracy200: 0.3840 - val_loss: 3.3010 - val_accuracy200: 0.3481 - 16s/epoch - 37ms/step
Epoch 21/50
444/444 - 17s - loss: 3.2585 - accuracy200: 0.3860 - val_loss: 3.3020 - val_accuracy200: 0.3477 - 17s/epoch - 37ms/step
testing model: results/XRAY/W3/deepOF_L1/h200
Evaluating performance on  test set...
1359/1359 - 29s - 29s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0873334
{'0': {'precision': 0.3008944042847391, 'recall': 0.3476862713372704, 'f1-score': 0.3226024376741698, 'support': 98888}, '1': {'precision': 0.44764793664107994, 'recall': 0.5955376201073099, 'f1-score': 0.5111098118807196, 'support': 154133}, '2': {'precision': 0.29065561681356883, 'recall': 0.08733223600911623, 'f1-score': 0.1343091040380356, 'support': 94776}, 'accuracy': 0.3865789526649166, 'macro avg': {'precision': 0.34639931924646267, 'recall': 0.34351870915123217, 'f1-score': 0.322673784530975, 'support': 347797}, 'weighted avg': {'precision': 0.3631409759380664, 'recall': 0.3865789526649166, 'f1-score': 0.354832497507578, 'support': 347797}}
[[34382 57413  7093]
 [49234 91792 13107]
 [30650 55849  8277]]
Evaluating performance on  train set...
444/444 - 11s - 11s/epoch - 26ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0965663
{'0': {'precision': 0.36730925875644854, 'recall': 0.36338240034382724, 'f1-score': 0.3653352777552729, 'support': 37228}, '1': {'precision': 0.3450490130652074, 'recall': 0.6186057641178347, 'f1-score': 0.4429995335243662, 'support': 37612}, '2': {'precision': 0.4151388442157178, 'recall': 0.09992773820584289, 'f1-score': 0.16108164326573063, 'support': 38748}, 'accuracy': 0.35802197415219916, 'macro avg': {'precision': 0.3758323720124579, 'recall': 0.3606386342225016, 'f1-score': 0.3231388181817899, 'support': 113588}, 'weighted avg': {'precision': 0.3762542918271673, 'recall': 0.35802197415219916, 'f1-score': 0.3213754242389363, 'support': 113588}}
[[13528 21106  2594]
 [11484 23267  2861]
 [11818 23058  3872]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1000123
{'0': {'precision': 0.36013118950483963, 'recall': 0.36294743631086746, 'f1-score': 0.36153382854848426, 'support': 12404}, '1': {'precision': 0.3333333333333333, 'recall': 0.578031360315245, 'f1-score': 0.4228320922411722, 'support': 12181}, '2': {'precision': 0.3790589794565938, 'recall': 0.09488264078958282, 'f1-score': 0.1517744610281924, 'support': 12057}, 'accuracy': 0.34624201735713117, 'macro avg': {'precision': 0.3575078340982556, 'recall': 0.3452871458052318, 'f1-score': 0.312046793939283, 'support': 36642}, 'weighted avg': {'precision': 0.3574508684913355, 'recall': 0.34624201735713117, 'f1-score': 0.3128903444550524, 'support': 36642}}
[[4502 6984  918]
 [4184 7041  956]
 [3815 7098 1144]]
training model: results/XRAY/W3/deepOF_L1/h300
Epoch 1/50
444/444 - 22s - loss: 3.3411 - accuracy300: 0.3415 - val_loss: 3.3267 - val_accuracy300: 0.3249 - 22s/epoch - 49ms/step
Epoch 2/50
444/444 - 17s - loss: 3.3178 - accuracy300: 0.3428 - val_loss: 3.3156 - val_accuracy300: 0.3265 - 17s/epoch - 37ms/step
Epoch 3/50
444/444 - 18s - loss: 3.3039 - accuracy300: 0.3480 - val_loss: 3.3121 - val_accuracy300: 0.3277 - 18s/epoch - 41ms/step
Epoch 4/50
444/444 - 19s - loss: 3.2998 - accuracy300: 0.3506 - val_loss: 3.3100 - val_accuracy300: 0.3275 - 19s/epoch - 42ms/step
Epoch 5/50
444/444 - 20s - loss: 3.2941 - accuracy300: 0.3540 - val_loss: 3.3075 - val_accuracy300: 0.3306 - 20s/epoch - 45ms/step
Epoch 6/50
444/444 - 17s - loss: 3.2913 - accuracy300: 0.3567 - val_loss: 3.3076 - val_accuracy300: 0.3358 - 17s/epoch - 38ms/step
Epoch 7/50
444/444 - 18s - loss: 3.2874 - accuracy300: 0.3605 - val_loss: 3.3086 - val_accuracy300: 0.3330 - 18s/epoch - 40ms/step
Epoch 8/50
444/444 - 19s - loss: 3.2858 - accuracy300: 0.3613 - val_loss: 3.3059 - val_accuracy300: 0.3343 - 19s/epoch - 42ms/step
Epoch 9/50
444/444 - 18s - loss: 3.2831 - accuracy300: 0.3643 - val_loss: 3.3059 - val_accuracy300: 0.3335 - 18s/epoch - 42ms/step
Epoch 10/50
444/444 - 17s - loss: 3.2813 - accuracy300: 0.3656 - val_loss: 3.3077 - val_accuracy300: 0.3331 - 17s/epoch - 38ms/step
Epoch 11/50
444/444 - 18s - loss: 3.2785 - accuracy300: 0.3665 - val_loss: 3.3055 - val_accuracy300: 0.3384 - 18s/epoch - 41ms/step
Epoch 12/50
444/444 - 17s - loss: 3.2770 - accuracy300: 0.3699 - val_loss: 3.3075 - val_accuracy300: 0.3353 - 17s/epoch - 39ms/step
Epoch 13/50
444/444 - 17s - loss: 3.2752 - accuracy300: 0.3718 - val_loss: 3.3092 - val_accuracy300: 0.3354 - 17s/epoch - 38ms/step
Epoch 14/50
444/444 - 17s - loss: 3.2733 - accuracy300: 0.3720 - val_loss: 3.3086 - val_accuracy300: 0.3346 - 17s/epoch - 38ms/step
Epoch 15/50
444/444 - 17s - loss: 3.2718 - accuracy300: 0.3729 - val_loss: 3.3077 - val_accuracy300: 0.3385 - 17s/epoch - 38ms/step
Epoch 16/50
444/444 - 18s - loss: 3.2695 - accuracy300: 0.3755 - val_loss: 3.3119 - val_accuracy300: 0.3371 - 18s/epoch - 40ms/step
Epoch 17/50
444/444 - 17s - loss: 3.2674 - accuracy300: 0.3776 - val_loss: 3.3109 - val_accuracy300: 0.3402 - 17s/epoch - 39ms/step
Epoch 18/50
444/444 - 19s - loss: 3.2655 - accuracy300: 0.3789 - val_loss: 3.3126 - val_accuracy300: 0.3381 - 19s/epoch - 42ms/step
Epoch 19/50
444/444 - 19s - loss: 3.2639 - accuracy300: 0.3811 - val_loss: 3.3161 - val_accuracy300: 0.3400 - 19s/epoch - 43ms/step
Epoch 20/50
444/444 - 18s - loss: 3.2614 - accuracy300: 0.3822 - val_loss: 3.3188 - val_accuracy300: 0.3361 - 18s/epoch - 41ms/step
Epoch 21/50
444/444 - 18s - loss: 3.2594 - accuracy300: 0.3820 - val_loss: 3.3198 - val_accuracy300: 0.3359 - 18s/epoch - 40ms/step
testing model: results/XRAY/W3/deepOF_L1/h300
Evaluating performance on  test set...
1359/1359 - 32s - 32s/epoch - 24ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0923105
{'0': {'precision': 0.30581332834669595, 'recall': 0.38479411764705884, 'f1-score': 0.34078743439132075, 'support': 102000}, '1': {'precision': 0.42546585522032276, 'recall': 0.5369638442941352, 'f1-score': 0.47475629929178936, 'support': 147252}, '2': {'precision': 0.2857227858269122, 'recall': 0.09745801410523111, 'f1-score': 0.14534118252394862, 'support': 98545}, 'accuracy': 0.36780650781921637, 'macro avg': {'precision': 0.33900065646464367, 'recall': 0.33973865868214176, 'f1-score': 0.3202949720690196, 'support': 347797}, 'weighted avg': {'precision': 0.35077993638121957, 'recall': 0.36780650781921637, 'f1-score': 0.3421299773231276, 'support': 347797}}
[[39249 54092  8659]
 [52833 79069 15350]
 [36261 52680  9604]]
Evaluating performance on  train set...
444/444 - 11s - 11s/epoch - 25ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979192
{'0': {'precision': 0.3594740438768056, 'recall': 0.4084665434974697, 'f1-score': 0.3824075002506768, 'support': 37347}, '1': {'precision': 0.34175637958532695, 'recall': 0.5543399175402194, 'f1-score': 0.4228322422174489, 'support': 37109}, '2': {'precision': 0.40021899808376676, 'recall': 0.1120821833793315, 'f1-score': 0.17512127927172547, 'support': 39132}, 'accuracy': 0.35401626932422436, 'macro avg': {'precision': 0.3671498071819664, 'recall': 0.3582962148056735, 'f1-score': 0.3267870072466171, 'support': 113588}, 'weighted avg': {'precision': 0.3677226858445691, 'recall': 0.35401626932422436, 'f1-score': 0.32420238483616665, 'support': 113588}}
[[15255 18886  3206]
 [13171 20571  3367]
 [14011 20735  4386]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 23ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.104243
{'0': {'precision': 0.3662522202486678, 'recall': 0.40110488639900405, 'f1-score': 0.3828870650276674, 'support': 12852}, '1': {'precision': 0.31140350877192985, 'recall': 0.5320461958917394, 'f1-score': 0.3928652800833252, 'support': 11343}, '2': {'precision': 0.36240978977094446, 'recall': 0.09279344420342252, 'f1-score': 0.14775489318152743, 'support': 12447}, 'accuracy': 0.33690846569510396, 'macro avg': {'precision': 0.3466885062638474, 'recall': 0.34198150883138867, 'f1-score': 0.3078357460975067, 'support': 36642}, 'weighted avg': {'precision': 0.34796785622823057, 'recall': 0.33690846569510396, 'f1-score': 0.306103394660532, 'support': 36642}}
[[5155 6668 1029]
 [4305 6035 1003]
 [4615 6677 1155]]
training model: results/XRAY/W3/deepOF_L1/h500
Epoch 1/50
444/444 - 20s - loss: 3.3396 - accuracy500: 0.3435 - val_loss: 3.3276 - val_accuracy500: 0.3329 - 20s/epoch - 44ms/step
Epoch 2/50
444/444 - 17s - loss: 3.3193 - accuracy500: 0.3446 - val_loss: 3.3213 - val_accuracy500: 0.3319 - 17s/epoch - 39ms/step
Epoch 3/50
444/444 - 18s - loss: 3.3083 - accuracy500: 0.3482 - val_loss: 3.3161 - val_accuracy500: 0.3327 - 18s/epoch - 40ms/step
Epoch 4/50
444/444 - 16s - loss: 3.3029 - accuracy500: 0.3517 - val_loss: 3.3151 - val_accuracy500: 0.3368 - 16s/epoch - 36ms/step
Epoch 5/50
444/444 - 17s - loss: 3.2986 - accuracy500: 0.3530 - val_loss: 3.3144 - val_accuracy500: 0.3350 - 17s/epoch - 38ms/step
Epoch 6/50
444/444 - 18s - loss: 3.2950 - accuracy500: 0.3554 - val_loss: 3.3111 - val_accuracy500: 0.3392 - 18s/epoch - 40ms/step
Epoch 7/50
444/444 - 18s - loss: 3.2916 - accuracy500: 0.3588 - val_loss: 3.3105 - val_accuracy500: 0.3366 - 18s/epoch - 40ms/step
Epoch 8/50
444/444 - 17s - loss: 3.2895 - accuracy500: 0.3614 - val_loss: 3.3089 - val_accuracy500: 0.3397 - 17s/epoch - 38ms/step
Epoch 9/50
444/444 - 18s - loss: 3.2884 - accuracy500: 0.3620 - val_loss: 3.3077 - val_accuracy500: 0.3380 - 18s/epoch - 41ms/step
Epoch 10/50
444/444 - 18s - loss: 3.2853 - accuracy500: 0.3643 - val_loss: 3.3100 - val_accuracy500: 0.3413 - 18s/epoch - 40ms/step
Epoch 11/50
444/444 - 18s - loss: 3.2840 - accuracy500: 0.3659 - val_loss: 3.3088 - val_accuracy500: 0.3405 - 18s/epoch - 41ms/step
Epoch 12/50
444/444 - 18s - loss: 3.2818 - accuracy500: 0.3697 - val_loss: 3.3102 - val_accuracy500: 0.3417 - 18s/epoch - 41ms/step
Epoch 13/50
444/444 - 19s - loss: 3.2798 - accuracy500: 0.3703 - val_loss: 3.3097 - val_accuracy500: 0.3453 - 19s/epoch - 42ms/step
Epoch 14/50
444/444 - 17s - loss: 3.2781 - accuracy500: 0.3718 - val_loss: 3.3095 - val_accuracy500: 0.3447 - 17s/epoch - 38ms/step
Epoch 15/50
444/444 - 16s - loss: 3.2764 - accuracy500: 0.3721 - val_loss: 3.3111 - val_accuracy500: 0.3425 - 16s/epoch - 36ms/step
Epoch 16/50
444/444 - 17s - loss: 3.2758 - accuracy500: 0.3742 - val_loss: 3.3118 - val_accuracy500: 0.3420 - 17s/epoch - 38ms/step
Epoch 17/50
444/444 - 17s - loss: 3.2740 - accuracy500: 0.3732 - val_loss: 3.3128 - val_accuracy500: 0.3415 - 17s/epoch - 37ms/step
Epoch 18/50
444/444 - 20s - loss: 3.2704 - accuracy500: 0.3770 - val_loss: 3.3169 - val_accuracy500: 0.3451 - 20s/epoch - 46ms/step
Epoch 19/50
444/444 - 18s - loss: 3.2692 - accuracy500: 0.3780 - val_loss: 3.3177 - val_accuracy500: 0.3426 - 18s/epoch - 41ms/step
testing model: results/XRAY/W3/deepOF_L1/h500
Evaluating performance on  test set...
1359/1359 - 26s - 26s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0947073
{'0': {'precision': 0.2941220030418164, 'recall': 0.5207717677434972, 'f1-score': 0.3759273685666649, 'support': 99149}, '1': {'precision': 0.44046936844490053, 'recall': 0.44009400673759336, 'f1-score': 0.440281607587686, 'support': 150202}, '2': {'precision': 0.26842580063148397, 'recall': 0.06044938341832071, 'f1-score': 0.09867679246534458, 'support': 98446}, 'accuracy': 0.35563273978786475, 'macro avg': {'precision': 0.3343390573727336, 'recall': 0.3404383859664704, 'f1-score': 0.3049619228732318, 'support': 347797}, 'weighted avg': {'precision': 0.35005111869199873, 'recall': 0.35563273978786475, 'f1-score': 0.32524241497179446, 'support': 347797}}
[[51634 42112  5403]
 [73283 66103 10816]
 [50636 41859  5951]]
Evaluating performance on  train set...
444/444 - 11s - 11s/epoch - 25ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1007215
{'0': {'precision': 0.34451803045444535, 'recall': 0.5441266953800059, 'f1-score': 0.42190416925948976, 'support': 37381}, '1': {'precision': 0.34537893751949267, 'recall': 0.4433383153624426, 'f1-score': 0.38827530591493986, 'support': 37468}, '2': {'precision': 0.4011465757669662, 'recall': 0.0668318748547975, 'f1-score': 0.11457526608103026, 'support': 38739}, 'accuracy': 0.3481001514244462, 'macro avg': {'precision': 0.3636811812469681, 'recall': 0.35143229519908203, 'f1-score': 0.3082515804184866, 'support': 113588}, 'weighted avg': {'precision': 0.36411508016722255, 'recall': 0.3481001514244462, 'f1-score': 0.30599737776722, 'support': 113588}}
[[20340 15146  1895]
 [18887 16611  1970]
 [19812 16338  2589]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 27ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1042995
{'0': {'precision': 0.35837547573119233, 'recall': 0.5349416342412452, 'f1-score': 0.429209203584028, 'support': 12850}, '1': {'precision': 0.31779172537466377, 'recall': 0.4355688202247191, 'f1-score': 0.36747389469006886, 'support': 11392}, '2': {'precision': 0.34055224688684355, 'recall': 0.050725806451612905, 'f1-score': 0.08829929107882362, 'support': 12400}, 'accuracy': 0.3401833961028328, 'macro avg': {'precision': 0.33890648266423323, 'recall': 0.34041208697252573, 'f1-score': 0.29499412978430684, 'support': 36642}, 'weighted avg': {'precision': 0.339726435784369, 'recall': 0.3401833961028328, 'f1-score': 0.29464854767047205, 'support': 36642}}
[[6874 5340  636]
 [5848 4962  582]
 [6459 5312  629]]
training model: results/XRAY/W3/deepOF_L1/h1000
Epoch 1/50
444/444 - 24s - loss: 3.3450 - accuracy1000: 0.3390 - val_loss: 3.3367 - val_accuracy1000: 0.3343 - 24s/epoch - 54ms/step
Epoch 2/50
444/444 - 19s - loss: 3.3251 - accuracy1000: 0.3400 - val_loss: 3.3246 - val_accuracy1000: 0.3385 - 19s/epoch - 43ms/step
Epoch 3/50
444/444 - 18s - loss: 3.3135 - accuracy1000: 0.3424 - val_loss: 3.3208 - val_accuracy1000: 0.3374 - 18s/epoch - 40ms/step
Epoch 4/50
444/444 - 17s - loss: 3.3086 - accuracy1000: 0.3449 - val_loss: 3.3175 - val_accuracy1000: 0.3351 - 17s/epoch - 39ms/step
Epoch 5/50
444/444 - 17s - loss: 3.3036 - accuracy1000: 0.3465 - val_loss: 3.3137 - val_accuracy1000: 0.3365 - 17s/epoch - 38ms/step
Epoch 6/50
444/444 - 17s - loss: 3.2990 - accuracy1000: 0.3518 - val_loss: 3.3109 - val_accuracy1000: 0.3379 - 17s/epoch - 39ms/step
Epoch 7/50
444/444 - 19s - loss: 3.2954 - accuracy1000: 0.3527 - val_loss: 3.3109 - val_accuracy1000: 0.3356 - 19s/epoch - 42ms/step
Epoch 8/50
444/444 - 21s - loss: 3.2937 - accuracy1000: 0.3565 - val_loss: 3.3108 - val_accuracy1000: 0.3369 - 21s/epoch - 48ms/step
Epoch 9/50
444/444 - 20s - loss: 3.2916 - accuracy1000: 0.3571 - val_loss: 3.3100 - val_accuracy1000: 0.3359 - 20s/epoch - 45ms/step
Epoch 10/50
444/444 - 18s - loss: 3.2897 - accuracy1000: 0.3603 - val_loss: 3.3091 - val_accuracy1000: 0.3385 - 18s/epoch - 41ms/step
Epoch 11/50
444/444 - 20s - loss: 3.2894 - accuracy1000: 0.3583 - val_loss: 3.3086 - val_accuracy1000: 0.3388 - 20s/epoch - 44ms/step
Epoch 12/50
444/444 - 19s - loss: 3.2869 - accuracy1000: 0.3622 - val_loss: 3.3086 - val_accuracy1000: 0.3409 - 19s/epoch - 43ms/step
Epoch 13/50
444/444 - 20s - loss: 3.2848 - accuracy1000: 0.3651 - val_loss: 3.3079 - val_accuracy1000: 0.3391 - 20s/epoch - 45ms/step
Epoch 14/50
444/444 - 19s - loss: 3.2837 - accuracy1000: 0.3665 - val_loss: 3.3108 - val_accuracy1000: 0.3398 - 19s/epoch - 43ms/step
Epoch 15/50
444/444 - 18s - loss: 3.2829 - accuracy1000: 0.3673 - val_loss: 3.3099 - val_accuracy1000: 0.3399 - 18s/epoch - 40ms/step
Epoch 16/50
444/444 - 18s - loss: 3.2807 - accuracy1000: 0.3691 - val_loss: 3.3106 - val_accuracy1000: 0.3395 - 18s/epoch - 40ms/step
Epoch 17/50
444/444 - 19s - loss: 3.2786 - accuracy1000: 0.3695 - val_loss: 3.3131 - val_accuracy1000: 0.3394 - 19s/epoch - 43ms/step
Epoch 18/50
444/444 - 20s - loss: 3.2783 - accuracy1000: 0.3705 - val_loss: 3.3142 - val_accuracy1000: 0.3384 - 20s/epoch - 45ms/step
Epoch 19/50
444/444 - 19s - loss: 3.2768 - accuracy1000: 0.3717 - val_loss: 3.3151 - val_accuracy1000: 0.3403 - 19s/epoch - 43ms/step
Epoch 20/50
444/444 - 20s - loss: 3.2736 - accuracy1000: 0.3751 - val_loss: 3.3153 - val_accuracy1000: 0.3388 - 20s/epoch - 46ms/step
Epoch 21/50
444/444 - 20s - loss: 3.2729 - accuracy1000: 0.3761 - val_loss: 3.3173 - val_accuracy1000: 0.3397 - 20s/epoch - 44ms/step
Epoch 22/50
444/444 - 19s - loss: 3.2717 - accuracy1000: 0.3766 - val_loss: 3.3171 - val_accuracy1000: 0.3394 - 19s/epoch - 43ms/step
Epoch 23/50
444/444 - 17s - loss: 3.2691 - accuracy1000: 0.3801 - val_loss: 3.3195 - val_accuracy1000: 0.3387 - 17s/epoch - 37ms/step
testing model: results/XRAY/W3/deepOF_L1/h1000
Evaluating performance on  test set...
1359/1359 - 28s - 28s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.08162
{'0': {'precision': 0.28041666666666665, 'recall': 0.21189509146437455, 'f1-score': 0.24138734958124852, 'support': 95283}, '1': {'precision': 0.4710929954167956, 'recall': 0.7753424825689875, 'f1-score': 0.5860847497338086, 'support': 162928}, '2': {'precision': 0.250523286237572, 'recall': 0.02137610787399817, 'f1-score': 0.039391134423531836, 'support': 89586}, 'accuracy': 0.42677193880338243, 'macro avg': {'precision': 0.3340109827736781, 'recall': 0.3362045606357868, 'f1-score': 0.2889544112461963, 'support': 347797}, 'weighted avg': {'precision': 0.36204038542065287, 'recall': 0.42677193880338243, 'f1-score': 0.3508328740709281, 'support': 347797}}
[[ 20190  73166   1927]
 [ 32801 126325   3802]
 [ 19009  68662   1915]]
Evaluating performance on  train set...
444/444 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1018105
{'0': {'precision': 0.3532950832735676, 'recall': 0.23983662870898811, 'f1-score': 0.2857142857142857, 'support': 36971}, '1': {'precision': 0.339970065091023, 'recall': 0.775794964124017, 'f1-score': 0.47276452934912383, 'support': 37769}, '2': {'precision': 0.4003473729917499, 'recall': 0.0237335255354201, 'f1-score': 0.044810575684673525, 'support': 38848}, 'accuracy': 0.3441384653308448, 'macro avg': {'precision': 0.3645375071187802, 'recall': 0.3464550394561417, 'f1-score': 0.267763130249361, 'support': 113588}, 'weighted avg': {'precision': 0.3649566561442531, 'recall': 0.3441384653308448, 'f1-score': 0.2655191359151329, 'support': 113588}}
[[ 8867 27411   693]
 [ 7780 29301   688]
 [ 8451 29475   922]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.103823
{'0': {'precision': 0.34274928404061444, 'recall': 0.21172402701833387, 'f1-score': 0.26175564171388804, 'support': 12436}, '1': {'precision': 0.3358921748974105, 'recall': 0.7715121475583001, 'f1-score': 0.4680221811460259, 'support': 12307}, '2': {'precision': 0.3179190751445087, 'recall': 0.018488948651147155, 'f1-score': 0.03494559606067826, 'support': 11899}, 'accuracy': 0.3369903389552972, 'macro avg': {'precision': 0.33218684469417786, 'recall': 0.3339083744092604, 'f1-score': 0.25490780630686405, 'support': 36642}, 'weighted avg': {'precision': 0.33238289852999353, 'recall': 0.3369903389552972, 'f1-score': 0.2573811416201098, 'support': 36642}}
[[2633 9564  239]
 [2579 9495  233]
 [2470 9209  220]]
training model: results/XRAY/W3/deepLOB_L2/h10
Epoch 1/50
444/444 - 41s - loss: 3.3224 - accuracy10: 0.3655 - val_loss: 3.3222 - val_accuracy10: 0.3738 - 41s/epoch - 93ms/step
Epoch 2/50
444/444 - 33s - loss: 3.2553 - accuracy10: 0.3937 - val_loss: 3.2455 - val_accuracy10: 0.3936 - 33s/epoch - 75ms/step
Epoch 3/50
444/444 - 31s - loss: 3.2090 - accuracy10: 0.4175 - val_loss: 3.2021 - val_accuracy10: 0.4097 - 31s/epoch - 70ms/step
Epoch 4/50
444/444 - 30s - loss: 3.1709 - accuracy10: 0.4363 - val_loss: 3.1825 - val_accuracy10: 0.4215 - 30s/epoch - 69ms/step
Epoch 5/50
444/444 - 31s - loss: 3.1496 - accuracy10: 0.4464 - val_loss: 3.1641 - val_accuracy10: 0.4306 - 31s/epoch - 70ms/step
Epoch 6/50
444/444 - 30s - loss: 3.1305 - accuracy10: 0.4534 - val_loss: 3.1533 - val_accuracy10: 0.4372 - 30s/epoch - 67ms/step
Epoch 7/50
444/444 - 31s - loss: 3.1161 - accuracy10: 0.4583 - val_loss: 3.1457 - val_accuracy10: 0.4396 - 31s/epoch - 69ms/step
Epoch 8/50
444/444 - 31s - loss: 3.1055 - accuracy10: 0.4626 - val_loss: 3.1387 - val_accuracy10: 0.4463 - 31s/epoch - 71ms/step
Epoch 9/50
444/444 - 31s - loss: 3.0919 - accuracy10: 0.4679 - val_loss: 3.1438 - val_accuracy10: 0.4422 - 31s/epoch - 70ms/step
Epoch 10/50
444/444 - 30s - loss: 3.0839 - accuracy10: 0.4702 - val_loss: 3.1430 - val_accuracy10: 0.4446 - 30s/epoch - 67ms/step
Epoch 11/50
444/444 - 28s - loss: 3.0743 - accuracy10: 0.4743 - val_loss: 3.1481 - val_accuracy10: 0.4463 - 28s/epoch - 63ms/step
Epoch 12/50
444/444 - 30s - loss: 3.0663 - accuracy10: 0.4772 - val_loss: 3.1554 - val_accuracy10: 0.4448 - 30s/epoch - 69ms/step
Epoch 13/50
444/444 - 33s - loss: 3.0565 - accuracy10: 0.4802 - val_loss: 3.1777 - val_accuracy10: 0.4394 - 33s/epoch - 74ms/step
Epoch 14/50
444/444 - 31s - loss: 3.0469 - accuracy10: 0.4836 - val_loss: 3.1658 - val_accuracy10: 0.4430 - 31s/epoch - 71ms/step
Epoch 15/50
444/444 - 29s - loss: 3.0414 - accuracy10: 0.4857 - val_loss: 3.1725 - val_accuracy10: 0.4425 - 29s/epoch - 65ms/step
Epoch 16/50
444/444 - 30s - loss: 3.0341 - accuracy10: 0.4866 - val_loss: 3.1598 - val_accuracy10: 0.4472 - 30s/epoch - 68ms/step
Epoch 17/50
444/444 - 29s - loss: 3.0263 - accuracy10: 0.4895 - val_loss: 3.1852 - val_accuracy10: 0.4418 - 29s/epoch - 66ms/step
Epoch 18/50
444/444 - 28s - loss: 3.0182 - accuracy10: 0.4926 - val_loss: 3.1739 - val_accuracy10: 0.4423 - 28s/epoch - 63ms/step
testing model: results/XRAY/W3/deepLOB_L2/h10
Evaluating performance on  test set...
1359/1359 - 37s - 37s/epoch - 27ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.047314
{'0': {'precision': 0.4318341773238349, 'recall': 0.45720387114362304, 'f1-score': 0.44415704795744965, 'support': 110045}, '1': {'precision': 0.4544249568037113, 'recall': 0.4402800816395172, 'f1-score': 0.44724070723620357, 'support': 130819}, '2': {'precision': 0.4364573767982859, 'recall': 0.42669048131142634, 'f1-score': 0.4315186707080068, 'support': 106937}, 'accuracy': 0.44145646504754155, 'macro avg': {'precision': 0.44090550364194403, 'recall': 0.4413914780315222, 'f1-score': 0.44097214196721995, 'support': 347801}, 'weighted avg': {'precision': 0.44175276370793765, 'recall': 0.44145646504754155, 'f1-score': 0.4414310381853778, 'support': 347801}}
[[50313 37915 21817]
 [36124 57597 37098]
 [30073 31235 45629]]
Evaluating performance on  train set...
444/444 - 14s - 14s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0483721
{'0': {'precision': 0.43284261302873783, 'recall': 0.5068474901417457, 'f1-score': 0.46693094095556015, 'support': 37532}, '1': {'precision': 0.4564878520748226, 'recall': 0.44418002562828524, 'f1-score': 0.4502498442615346, 'support': 38239}, '2': {'precision': 0.46472619634928464, 'recall': 0.39854037759796923, 'f1-score': 0.4290960854092527, 'support': 37818}, 'accuracy': 0.4496914313886028, 'macro avg': {'precision': 0.4513522204842817, 'recall': 0.44985596445600007, 'f1-score': 0.44875895687544914, 'support': 113589}, 'weighted avg': {'precision': 0.4514178593105052, 'recall': 0.4496914313886028, 'f1-score': 0.44871872829823334, 'support': 113589}}
[[19023 10773  7736]
 [11630 16985  9624]
 [13296  9450 15072]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.046067
{'0': {'precision': 0.4483835570186545, 'recall': 0.4512402310567448, 'f1-score': 0.4498073584825776, 'support': 11772}, '1': {'precision': 0.47032236056626303, 'recall': 0.4166981488477522, 'f1-score': 0.4418893473819158, 'support': 13235}, '2': {'precision': 0.4233682760731502, 'recall': 0.47554791577137945, 'f1-score': 0.44794365284974097, 'support': 11635}, 'accuracy': 0.4464821789203646, 'macro avg': {'precision': 0.44735806455268917, 'recall': 0.4478287652252922, 'f1-score': 0.4465467862380781, 'support': 36642}, 'weighted avg': {'precision': 0.44836465169557327, 'recall': 0.4464821789203646, 'f1-score': 0.44635560661435775, 'support': 36642}}
[[5312 3328 3132]
 [3316 5515 4404]
 [3219 2883 5533]]
training model: results/XRAY/W3/deepLOB_L2/h20
Epoch 1/50
444/444 - 36s - loss: 3.3358 - accuracy20: 0.3528 - val_loss: 3.3501 - val_accuracy20: 0.3492 - 36s/epoch - 81ms/step
Epoch 2/50
444/444 - 29s - loss: 3.2904 - accuracy20: 0.3671 - val_loss: 3.2960 - val_accuracy20: 0.3658 - 29s/epoch - 65ms/step
Epoch 3/50
444/444 - 34s - loss: 3.2676 - accuracy20: 0.3807 - val_loss: 3.2727 - val_accuracy20: 0.3799 - 34s/epoch - 77ms/step
Epoch 4/50
444/444 - 32s - loss: 3.2414 - accuracy20: 0.3971 - val_loss: 3.2556 - val_accuracy20: 0.3848 - 32s/epoch - 71ms/step
Epoch 5/50
444/444 - 31s - loss: 3.2179 - accuracy20: 0.4123 - val_loss: 3.2481 - val_accuracy20: 0.3928 - 31s/epoch - 70ms/step
Epoch 6/50
444/444 - 31s - loss: 3.1981 - accuracy20: 0.4248 - val_loss: 3.2266 - val_accuracy20: 0.4040 - 31s/epoch - 69ms/step
Epoch 7/50
444/444 - 32s - loss: 3.1866 - accuracy20: 0.4305 - val_loss: 3.2245 - val_accuracy20: 0.4136 - 32s/epoch - 71ms/step
Epoch 8/50
444/444 - 30s - loss: 3.1765 - accuracy20: 0.4350 - val_loss: 3.2223 - val_accuracy20: 0.4114 - 30s/epoch - 67ms/step
Epoch 9/50
444/444 - 31s - loss: 3.1725 - accuracy20: 0.4386 - val_loss: 3.2184 - val_accuracy20: 0.4125 - 31s/epoch - 70ms/step
Epoch 10/50
444/444 - 32s - loss: 3.1647 - accuracy20: 0.4409 - val_loss: 3.2205 - val_accuracy20: 0.4151 - 32s/epoch - 73ms/step
Epoch 11/50
444/444 - 33s - loss: 3.1546 - accuracy20: 0.4450 - val_loss: 3.2234 - val_accuracy20: 0.4152 - 33s/epoch - 75ms/step
Epoch 12/50
444/444 - 33s - loss: 3.1442 - accuracy20: 0.4496 - val_loss: 3.2175 - val_accuracy20: 0.4143 - 33s/epoch - 74ms/step
Epoch 13/50
444/444 - 30s - loss: 3.1393 - accuracy20: 0.4522 - val_loss: 3.2131 - val_accuracy20: 0.4164 - 30s/epoch - 67ms/step
Epoch 14/50
444/444 - 28s - loss: 3.1325 - accuracy20: 0.4543 - val_loss: 3.2128 - val_accuracy20: 0.4170 - 28s/epoch - 64ms/step
Epoch 15/50
444/444 - 29s - loss: 3.1247 - accuracy20: 0.4574 - val_loss: 3.2165 - val_accuracy20: 0.4174 - 29s/epoch - 66ms/step
Epoch 16/50
444/444 - 28s - loss: 3.1175 - accuracy20: 0.4608 - val_loss: 3.2123 - val_accuracy20: 0.4156 - 28s/epoch - 63ms/step
Epoch 17/50
444/444 - 33s - loss: 3.1125 - accuracy20: 0.4612 - val_loss: 3.2178 - val_accuracy20: 0.4149 - 33s/epoch - 73ms/step
Epoch 18/50
444/444 - 33s - loss: 3.1059 - accuracy20: 0.4649 - val_loss: 3.2177 - val_accuracy20: 0.4163 - 33s/epoch - 75ms/step
Epoch 19/50
444/444 - 30s - loss: 3.0978 - accuracy20: 0.4680 - val_loss: 3.2151 - val_accuracy20: 0.4178 - 30s/epoch - 67ms/step
Epoch 20/50
444/444 - 30s - loss: 3.0885 - accuracy20: 0.4708 - val_loss: 3.2194 - val_accuracy20: 0.4152 - 30s/epoch - 68ms/step
Epoch 21/50
444/444 - 30s - loss: 3.0871 - accuracy20: 0.4709 - val_loss: 3.2207 - val_accuracy20: 0.4158 - 30s/epoch - 66ms/step
Epoch 22/50
444/444 - 30s - loss: 3.0752 - accuracy20: 0.4745 - val_loss: 3.2145 - val_accuracy20: 0.4172 - 30s/epoch - 69ms/step
Epoch 23/50
444/444 - 31s - loss: 3.0700 - accuracy20: 0.4783 - val_loss: 3.2243 - val_accuracy20: 0.4137 - 31s/epoch - 69ms/step
Epoch 24/50
444/444 - 31s - loss: 3.0635 - accuracy20: 0.4779 - val_loss: 3.2201 - val_accuracy20: 0.4163 - 31s/epoch - 71ms/step
Epoch 25/50
444/444 - 30s - loss: 3.0594 - accuracy20: 0.4808 - val_loss: 3.2350 - val_accuracy20: 0.4139 - 30s/epoch - 67ms/step
Epoch 26/50
444/444 - 29s - loss: 3.0525 - accuracy20: 0.4828 - val_loss: 3.2291 - val_accuracy20: 0.4141 - 29s/epoch - 65ms/step
testing model: results/XRAY/W3/deepLOB_L2/h20
Evaluating performance on  test set...
1359/1359 - 38s - 38s/epoch - 28ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0661618
{'0': {'precision': 0.4285405204920566, 'recall': 0.36979578773303934, 'f1-score': 0.3970068196026591, 'support': 112481}, '1': {'precision': 0.4312100751475649, 'recall': 0.3997653638467472, 'f1-score': 0.41489277419408643, 'support': 124448}, '2': {'precision': 0.41043541214189677, 'recall': 0.5011093874016884, 'f1-score': 0.4512625995987621, 'support': 110872}, 'accuracy': 0.4223794641188496, 'macro avg': {'precision': 0.4233953359271727, 'recall': 0.42355684632715834, 'f1-score': 0.4210540644651692, 'support': 347801}, 'weighted avg': {'precision': 0.42372417771204673, 'recall': 0.4223794641188496, 'f1-score': 0.4207023182260727, 'support': 347801}}
[[41595 35844 35042]
 [29933 49750 44765]
 [25534 29779 55559]]
Evaluating performance on  train set...
444/444 - 15s - 15s/epoch - 34ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.064184
{'0': {'precision': 0.41183226872468615, 'recall': 0.5436361218247108, 'f1-score': 0.46864323221205656, 'support': 37595}, '1': {'precision': 0.43087313857921716, 'recall': 0.4193284409482076, 'f1-score': 0.4250224083265328, 'support': 37882}, '2': {'precision': 0.44701974534046873, 'recall': 0.3178001679261125, 'f1-score': 0.3714938580213781, 'support': 38112}, 'accuracy': 0.42640572590655784, 'macro avg': {'precision': 0.42990838421479066, 'recall': 0.42692157689967697, 'f1-score': 0.4217198328533225, 'support': 113589}, 'weighted avg': {'precision': 0.42998870412432916, 'recall': 0.42640572590655784, 'f1-score': 0.4214995739389266, 'support': 113589}}
[[20438 10182  6975]
 [13989 15885  8008]
 [15200 10800 12112]]
Evaluating performance on  val set...
144/144 - 5s - 5s/epoch - 34ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0719591
{'0': {'precision': 0.4251828072052791, 'recall': 0.3953565505804312, 'f1-score': 0.4097275930222566, 'support': 12060}, '1': {'precision': 0.42419645396795297, 'recall': 0.35749101078705553, 'f1-score': 0.3879975717630734, 'support': 12515}, '2': {'precision': 0.3972851286875882, 'recall': 0.4899312173696859, 'f1-score': 0.4387709663054772, 'support': 12067}, 'accuracy': 0.4135691283226898, 'macro avg': {'precision': 0.41555479662027345, 'recall': 0.4142595929123909, 'f1-score': 0.4121653770302691, 'support': 36642}, 'weighted avg': {'precision': 0.4156586137268087, 'recall': 0.4135691283226898, 'f1-score': 0.41187035731869087, 'support': 36642}}
[[4768 3095 4197]
 [3269 4474 4772]
 [3177 2978 5912]]
training model: results/XRAY/W3/deepLOB_L2/h30
Epoch 1/50
444/444 - 38s - loss: 3.3366 - accuracy30: 0.3512 - val_loss: 3.3730 - val_accuracy30: 0.3482 - 38s/epoch - 86ms/step
Epoch 2/50
444/444 - 29s - loss: 3.3026 - accuracy30: 0.3606 - val_loss: 3.3460 - val_accuracy30: 0.3565 - 29s/epoch - 66ms/step
Epoch 3/50
444/444 - 31s - loss: 3.2786 - accuracy30: 0.3717 - val_loss: 3.2938 - val_accuracy30: 0.3684 - 31s/epoch - 69ms/step
Epoch 4/50
444/444 - 30s - loss: 3.2563 - accuracy30: 0.3876 - val_loss: 3.2794 - val_accuracy30: 0.3823 - 30s/epoch - 68ms/step
Epoch 5/50
444/444 - 30s - loss: 3.2360 - accuracy30: 0.4024 - val_loss: 3.2759 - val_accuracy30: 0.3896 - 30s/epoch - 68ms/step
Epoch 6/50
444/444 - 30s - loss: 3.2238 - accuracy30: 0.4094 - val_loss: 3.2538 - val_accuracy30: 0.3947 - 30s/epoch - 67ms/step
Epoch 7/50
444/444 - 30s - loss: 3.2115 - accuracy30: 0.4137 - val_loss: 3.2467 - val_accuracy30: 0.3983 - 30s/epoch - 68ms/step
Epoch 8/50
444/444 - 31s - loss: 3.2047 - accuracy30: 0.4172 - val_loss: 3.2531 - val_accuracy30: 0.3975 - 31s/epoch - 69ms/step
Epoch 9/50
444/444 - 29s - loss: 3.1959 - accuracy30: 0.4221 - val_loss: 3.2551 - val_accuracy30: 0.4014 - 29s/epoch - 65ms/step
Epoch 10/50
444/444 - 30s - loss: 3.1894 - accuracy30: 0.4255 - val_loss: 3.2680 - val_accuracy30: 0.3978 - 30s/epoch - 67ms/step
Epoch 11/50
444/444 - 31s - loss: 3.1790 - accuracy30: 0.4309 - val_loss: 3.2790 - val_accuracy30: 0.3971 - 31s/epoch - 70ms/step
Epoch 12/50
444/444 - 30s - loss: 3.1722 - accuracy30: 0.4342 - val_loss: 3.2827 - val_accuracy30: 0.3923 - 30s/epoch - 68ms/step
Epoch 13/50
444/444 - 31s - loss: 3.1666 - accuracy30: 0.4385 - val_loss: 3.3038 - val_accuracy30: 0.3969 - 31s/epoch - 69ms/step
Epoch 14/50
444/444 - 30s - loss: 3.1584 - accuracy30: 0.4408 - val_loss: 3.2879 - val_accuracy30: 0.3942 - 30s/epoch - 67ms/step
Epoch 15/50
444/444 - 30s - loss: 3.1468 - accuracy30: 0.4470 - val_loss: 3.2917 - val_accuracy30: 0.3949 - 30s/epoch - 68ms/step
Epoch 16/50
444/444 - 32s - loss: 3.1436 - accuracy30: 0.4478 - val_loss: 3.2942 - val_accuracy30: 0.3947 - 32s/epoch - 72ms/step
Epoch 17/50
444/444 - 30s - loss: 3.1383 - accuracy30: 0.4502 - val_loss: 3.2799 - val_accuracy30: 0.3935 - 30s/epoch - 67ms/step
testing model: results/XRAY/W3/deepLOB_L2/h30
Evaluating performance on  test set...
1359/1359 - 39s - 39s/epoch - 29ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.082195
{'0': {'precision': 0.3946357604882023, 'recall': 0.4146298852181205, 'f1-score': 0.40438583039411136, 'support': 114478}, '1': {'precision': 0.3913778763515387, 'recall': 0.34970480161843026, 'f1-score': 0.3693696443756405, 'support': 121105}, '2': {'precision': 0.39877465154677194, 'recall': 0.4239872391238482, 'f1-score': 0.4109946400266055, 'support': 112218}, 'accuracy': 0.39504199240370214, 'macro avg': {'precision': 0.394929429462171, 'recall': 0.39610730865346633, 'f1-score': 0.39491670493211917, 'support': 347801}, 'weighted avg': {'precision': 0.3948367720391752, 'recall': 0.39504199240370214, 'f1-score': 0.39432545734047525, 'support': 347801}}
[[47466 35658 31354]
 [38374 42351 40380]
 [34438 30201 47579]]
Evaluating performance on  train set...
444/444 - 13s - 13s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0833373
{'0': {'precision': 0.3807003919160541, 'recall': 0.5622865983781477, 'f1-score': 0.454009929246045, 'support': 37488}, '1': {'precision': 0.40870734988382046, 'recall': 0.3557400606737985, 'f1-score': 0.38038869760692035, 'support': 37578}, '2': {'precision': 0.414079648792725, 'recall': 0.2742257871920671, 'f1-score': 0.3299445615678926, 'support': 38523}, 'accuracy': 0.39626196198575564, 'macro avg': {'precision': 0.40116246353086654, 'recall': 0.3974174820813377, 'f1-score': 0.388114396140286, 'support': 113589}, 'weighted avg': {'precision': 0.4012861403527224, 'recall': 0.39626196198575564, 'f1-score': 0.3875782430651605, 'support': 113589}}
[[21079  9432  6977]
 [16239 13368  7971]
 [18051  9908 10564]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0825977
{'0': {'precision': 0.38978315009415054, 'recall': 0.5198898160900915, 'f1-score': 0.4455321807956676, 'support': 12343}, '1': {'precision': 0.41093809342954807, 'recall': 0.2704323919020245, 'f1-score': 0.3261983720229123, 'support': 12003}, '2': {'precision': 0.4001628664495114, 'recall': 0.39964216005204944, 'f1-score': 0.39990234375, 'support': 12296}, 'accuracy': 0.3978221712788603, 'macro avg': {'precision': 0.4002947033244033, 'recall': 0.3966547893480552, 'f1-score': 0.3905442988561933, 'support': 36642}, 'weighted avg': {'precision': 0.4001961127370274, 'recall': 0.3978221712788603, 'f1-score': 0.39112935936089577, 'support': 36642}}
[[6417 2389 3537]
 [4928 3246 3829]
 [5118 2264 4914]]
training model: results/XRAY/W3/deepLOB_L2/h50
Epoch 1/50
444/444 - 32s - loss: 3.3294 - accuracy50: 0.3610 - val_loss: 3.3850 - val_accuracy50: 0.3395 - 32s/epoch - 72ms/step
Epoch 2/50
444/444 - 33s - loss: 3.2913 - accuracy50: 0.3698 - val_loss: 3.3054 - val_accuracy50: 0.3656 - 33s/epoch - 74ms/step
Epoch 3/50
444/444 - 32s - loss: 3.2718 - accuracy50: 0.3772 - val_loss: 3.2829 - val_accuracy50: 0.3769 - 32s/epoch - 71ms/step
Epoch 4/50
444/444 - 32s - loss: 3.2569 - accuracy50: 0.3881 - val_loss: 3.2816 - val_accuracy50: 0.3711 - 32s/epoch - 71ms/step
Epoch 5/50
444/444 - 32s - loss: 3.2424 - accuracy50: 0.3961 - val_loss: 3.2909 - val_accuracy50: 0.3769 - 32s/epoch - 72ms/step
Epoch 6/50
444/444 - 29s - loss: 3.2325 - accuracy50: 0.4026 - val_loss: 3.2881 - val_accuracy50: 0.3802 - 29s/epoch - 66ms/step
Epoch 7/50
444/444 - 30s - loss: 3.2216 - accuracy50: 0.4085 - val_loss: 3.2784 - val_accuracy50: 0.3829 - 30s/epoch - 67ms/step
Epoch 8/50
444/444 - 31s - loss: 3.2116 - accuracy50: 0.4127 - val_loss: 3.3173 - val_accuracy50: 0.3832 - 31s/epoch - 71ms/step
Epoch 9/50
444/444 - 33s - loss: 3.2030 - accuracy50: 0.4176 - val_loss: 3.2846 - val_accuracy50: 0.3854 - 33s/epoch - 73ms/step
Epoch 10/50
444/444 - 31s - loss: 3.1916 - accuracy50: 0.4229 - val_loss: 3.2827 - val_accuracy50: 0.3839 - 31s/epoch - 69ms/step
Epoch 11/50
444/444 - 31s - loss: 3.1819 - accuracy50: 0.4269 - val_loss: 3.2903 - val_accuracy50: 0.3831 - 31s/epoch - 69ms/step
Epoch 12/50
444/444 - 29s - loss: 3.1745 - accuracy50: 0.4304 - val_loss: 3.2843 - val_accuracy50: 0.3855 - 29s/epoch - 66ms/step
Epoch 13/50
444/444 - 31s - loss: 3.1634 - accuracy50: 0.4364 - val_loss: 3.2950 - val_accuracy50: 0.3848 - 31s/epoch - 70ms/step
Epoch 14/50
444/444 - 30s - loss: 3.1529 - accuracy50: 0.4388 - val_loss: 3.2983 - val_accuracy50: 0.3856 - 30s/epoch - 68ms/step
Epoch 15/50
444/444 - 34s - loss: 3.1491 - accuracy50: 0.4418 - val_loss: 3.3129 - val_accuracy50: 0.3810 - 34s/epoch - 77ms/step
Epoch 16/50
444/444 - 30s - loss: 3.1393 - accuracy50: 0.4465 - val_loss: 3.3119 - val_accuracy50: 0.3870 - 30s/epoch - 67ms/step
Epoch 17/50
444/444 - 29s - loss: 3.1320 - accuracy50: 0.4485 - val_loss: 3.3221 - val_accuracy50: 0.3836 - 29s/epoch - 66ms/step
testing model: results/XRAY/W3/deepLOB_L2/h50
Evaluating performance on  test set...
1359/1359 - 37s - 37s/epoch - 27ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1011152
{'0': {'precision': 0.38814973903842964, 'recall': 0.39329546363709095, 'f1-score': 0.3907056593426245, 'support': 124990}, '1': {'precision': 0.3206717256885891, 'recall': 0.45160651909318505, 'f1-score': 0.37503954769760495, 'support': 101057}, '2': {'precision': 0.4016287388690159, 'recall': 0.26004895116382215, 'f1-score': 0.3156918659142122, 'support': 121754}, 'accuracy': 0.3635929741432601, 'macro avg': {'precision': 0.3701500678653449, 'recall': 0.36831697796469937, 'f1-score': 0.36047902431814727, 'support': 347801}, 'weighted avg': {'precision': 0.3732619053354741, 'recall': 0.3635929741432601, 'f1-score': 0.3598937880438254, 'support': 347801}}
[[49158 50783 25049]
 [33296 45638 22123]
 [44193 45899 31662]]
Evaluating performance on  train set...
444/444 - 13s - 13s/epoch - 29ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0978453
{'0': {'precision': 0.35680324070100755, 'recall': 0.555638715885702, 'f1-score': 0.4345562872373785, 'support': 37411}, '1': {'precision': 0.4074156968069233, 'recall': 0.4372297838270616, 'f1-score': 0.4217965551865297, 'support': 37470}, '2': {'precision': 0.4001852096838206, 'recall': 0.1562984395990493, 'f1-score': 0.2247984245531899, 'support': 38708}, 'accuracy': 0.3804945901451725, 'macro avg': {'precision': 0.38813471573058383, 'recall': 0.38305564643727097, 'f1-score': 0.36038375565903275, 'support': 113589}, 'weighted avg': {'precision': 0.3882823274583114, 'recall': 0.38049459014517245, 'f1-score': 0.35886749247094096, 'support': 113589}}
[[20787 11716  4908]
 [16927 16383  4160]
 [20545 12113  6050]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 26ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0941246
{'0': {'precision': 0.3730600767858108, 'recall': 0.5427155443675268, 'f1-score': 0.4421727287293703, 'support': 12712}, '1': {'precision': 0.3994276003935247, 'recall': 0.3968366802914519, 'f1-score': 0.3981279251170046, 'support': 11254}, '2': {'precision': 0.3794489092996556, 'recall': 0.20858314925844115, 'f1-score': 0.26919161066992464, 'support': 12676}, 'accuracy': 0.3823208340156105, 'macro avg': {'precision': 0.38397886215966376, 'recall': 0.3827117913058066, 'f1-score': 0.3698307548387665, 'support': 36642}, 'weighted avg': {'precision': 0.38336860120114585, 'recall': 0.3823208340156105, 'f1-score': 0.3688036748465283, 'support': 36642}}
[[6899 3420 2393]
 [4857 4466 1931]
 [6737 3295 2644]]
training model: results/XRAY/W3/deepLOB_L2/h100
Epoch 1/50
444/444 - 45s - loss: 3.3395 - accuracy100: 0.3517 - val_loss: 3.3572 - val_accuracy100: 0.3484 - 45s/epoch - 101ms/step
Epoch 2/50
444/444 - 32s - loss: 3.3029 - accuracy100: 0.3573 - val_loss: 3.3314 - val_accuracy100: 0.3543 - 32s/epoch - 72ms/step
Epoch 3/50
444/444 - 30s - loss: 3.2927 - accuracy100: 0.3609 - val_loss: 3.3170 - val_accuracy100: 0.3523 - 30s/epoch - 68ms/step
Epoch 4/50
444/444 - 30s - loss: 3.2768 - accuracy100: 0.3735 - val_loss: 3.3304 - val_accuracy100: 0.3483 - 30s/epoch - 67ms/step
Epoch 5/50
444/444 - 30s - loss: 3.2631 - accuracy100: 0.3841 - val_loss: 3.3330 - val_accuracy100: 0.3551 - 30s/epoch - 68ms/step
Epoch 6/50
444/444 - 29s - loss: 3.2555 - accuracy100: 0.3863 - val_loss: 3.3486 - val_accuracy100: 0.3555 - 29s/epoch - 66ms/step
Epoch 7/50
444/444 - 34s - loss: 3.2463 - accuracy100: 0.3944 - val_loss: 3.3694 - val_accuracy100: 0.3573 - 34s/epoch - 78ms/step
Epoch 8/50
444/444 - 34s - loss: 3.2382 - accuracy100: 0.3977 - val_loss: 3.3477 - val_accuracy100: 0.3576 - 34s/epoch - 78ms/step
Epoch 9/50
444/444 - 30s - loss: 3.2299 - accuracy100: 0.4043 - val_loss: 3.3423 - val_accuracy100: 0.3556 - 30s/epoch - 67ms/step
Epoch 10/50
444/444 - 34s - loss: 3.2206 - accuracy100: 0.4067 - val_loss: 3.3520 - val_accuracy100: 0.3569 - 34s/epoch - 76ms/step
Epoch 11/50
444/444 - 31s - loss: 3.2092 - accuracy100: 0.4131 - val_loss: 3.3539 - val_accuracy100: 0.3587 - 31s/epoch - 70ms/step
Epoch 12/50
444/444 - 32s - loss: 3.1996 - accuracy100: 0.4185 - val_loss: 3.3948 - val_accuracy100: 0.3589 - 32s/epoch - 71ms/step
Epoch 13/50
444/444 - 31s - loss: 3.1922 - accuracy100: 0.4208 - val_loss: 3.3987 - val_accuracy100: 0.3582 - 31s/epoch - 69ms/step
testing model: results/XRAY/W3/deepLOB_L2/h100
Evaluating performance on  test set...
1359/1359 - 35s - 35s/epoch - 26ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1006495
{'0': {'precision': 0.30512192948177397, 'recall': 0.4270184696569921, 'f1-score': 0.3559227152042481, 'support': 104225}, '1': {'precision': 0.43941192039410215, 'recall': 0.3590979814823859, 'f1-score': 0.3952159723555385, 'support': 143323}, '2': {'precision': 0.30284986617302, 'recall': 0.2562018094221619, 'f1-score': 0.27757964812173086, 'support': 100253}, 'accuracy': 0.3497919787464671, 'macro avg': {'precision': 0.34912790534963206, 'recall': 0.34743942018718, 'f1-score': 0.3429061118938392, 'support': 347801}, 'weighted avg': {'precision': 0.3598056802606248, 'recall': 0.3497919787464671, 'f1-score': 0.349532566787397, 'support': 347801}}
[[44506 34934 24785]
 [57515 51467 34341]
 [43842 30726 25685]]
Evaluating performance on  train set...
444/444 - 14s - 14s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1008108
{'0': {'precision': 0.3409052489223227, 'recall': 0.43464087504714694, 'f1-score': 0.3821084294545368, 'support': 37118}, '1': {'precision': 0.37573232942015106, 'recall': 0.44581593275889414, 'f1-score': 0.4077848292535509, 'support': 37834}, '2': {'precision': 0.3602507719659399, 'recall': 0.199290835209773, 'f1-score': 0.25661961973638164, 'support': 38637}, 'accuracy': 0.35830934333430176, 'macro avg': {'precision': 0.3589627834361379, 'recall': 0.3599158810052714, 'f1-score': 0.3488376261481565, 'support': 113589}, 'weighted avg': {'precision': 0.35908571302880377, 'recall': 0.35830934333430176, 'f1-score': 0.3479759850181525, 'support': 113589}}
[[16133 13921  7064]
 [14357 16867  6610]
 [16834 14103  7700]]
Evaluating performance on  val set...
144/144 - 5s - 5s/epoch - 33ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1058897
{'0': {'precision': 0.34447374046889473, 'recall': 0.3902478404779204, 'f1-score': 0.36593489780469346, 'support': 12387}, '1': {'precision': 0.3569447945550794, 'recall': 0.35682486350272996, 'f1-score': 0.35688481895320506, 'support': 11905}, '2': {'precision': 0.3614120283899888, 'recall': 0.3133603238866397, 'f1-score': 0.33567525370804063, 'support': 12350}, 'accuracy': 0.3534741553408657, 'macro avg': {'precision': 0.354276854471321, 'recall': 0.35347767595576335, 'f1-score': 0.35283165682197976, 'support': 36642}, 'weighted avg': {'precision': 0.35423455469086784, 'recall': 0.3534741553408657, 'f1-score': 0.3527956643206961, 'support': 36642}}
[[4834 3925 3628]
 [4447 4248 3210]
 [4752 3728 3870]]
training model: results/XRAY/W3/deepLOB_L2/h200
Epoch 1/50
444/444 - 34s - loss: 3.3266 - accuracy200: 0.3620 - val_loss: 3.4184 - val_accuracy200: 0.3529 - 34s/epoch - 77ms/step
Epoch 2/50
444/444 - 31s - loss: 3.2922 - accuracy200: 0.3740 - val_loss: 3.3435 - val_accuracy200: 0.3582 - 31s/epoch - 70ms/step
Epoch 3/50
444/444 - 30s - loss: 3.2785 - accuracy200: 0.3769 - val_loss: 3.3415 - val_accuracy200: 0.3539 - 30s/epoch - 68ms/step
Epoch 4/50
444/444 - 30s - loss: 3.2683 - accuracy200: 0.3813 - val_loss: 3.3521 - val_accuracy200: 0.3536 - 30s/epoch - 67ms/step
Epoch 5/50
444/444 - 31s - loss: 3.2514 - accuracy200: 0.3956 - val_loss: 3.3605 - val_accuracy200: 0.3511 - 31s/epoch - 69ms/step
Epoch 6/50
444/444 - 31s - loss: 3.2381 - accuracy200: 0.4029 - val_loss: 3.3726 - val_accuracy200: 0.3536 - 31s/epoch - 69ms/step
Epoch 7/50
444/444 - 28s - loss: 3.2249 - accuracy200: 0.4097 - val_loss: 3.3661 - val_accuracy200: 0.3576 - 28s/epoch - 64ms/step
Epoch 8/50
444/444 - 28s - loss: 3.2100 - accuracy200: 0.4186 - val_loss: 3.3755 - val_accuracy200: 0.3531 - 28s/epoch - 62ms/step
Epoch 9/50
444/444 - 30s - loss: 3.1958 - accuracy200: 0.4251 - val_loss: 3.3715 - val_accuracy200: 0.3528 - 30s/epoch - 67ms/step
Epoch 10/50
444/444 - 28s - loss: 3.1868 - accuracy200: 0.4299 - val_loss: 3.4018 - val_accuracy200: 0.3505 - 28s/epoch - 62ms/step
Epoch 11/50
444/444 - 29s - loss: 3.1798 - accuracy200: 0.4327 - val_loss: 3.4051 - val_accuracy200: 0.3554 - 29s/epoch - 66ms/step
Epoch 12/50
444/444 - 29s - loss: 3.1690 - accuracy200: 0.4351 - val_loss: 3.4189 - val_accuracy200: 0.3482 - 29s/epoch - 65ms/step
Epoch 13/50
444/444 - 32s - loss: 3.1558 - accuracy200: 0.4411 - val_loss: 3.4181 - val_accuracy200: 0.3468 - 32s/epoch - 72ms/step
testing model: results/XRAY/W3/deepLOB_L2/h200
Evaluating performance on  test set...
1359/1359 - 38s - 38s/epoch - 28ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0807319
{'0': {'precision': 0.3194157390844973, 'recall': 0.3485084437253514, 'f1-score': 0.33332849743939413, 'support': 98890}, '1': {'precision': 0.4870216427134582, 'recall': 0.6518678552428406, 'f1-score': 0.5575145863793873, 'support': 154134}, '2': {'precision': 0.2825679335694515, 'recall': 0.10017198265401943, 'f1-score': 0.14790926652956937, 'support': 94777}, 'accuracy': 0.4152748266968755, 'macro avg': {'precision': 0.3630017717891357, 'recall': 0.3668494272074039, 'f1-score': 0.3462507834494503, 'support': 347801}, 'weighted avg': {'precision': 0.3836520233006058, 'recall': 0.4152748266968755, 'f1-score': 0.3821530269397016, 'support': 347801}}
[[ 34464  55735   8691]
 [ 38245 100475  15414]
 [ 35188  50095   9494]]
Evaluating performance on  train set...
444/444 - 15s - 15s/epoch - 33ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1088977
{'0': {'precision': 0.34611919165915817, 'recall': 0.5779377787330073, 'f1-score': 0.43295026868194897, 'support': 37222}, '1': {'precision': 0.389777883926439, 'recall': 0.47743411079492565, 'f1-score': 0.42917593057448183, 'support': 37601}, '2': {'precision': 0.36654275092936806, 'recall': 0.050869318474952276, 'f1-score': 0.08933991754632356, 'support': 38766}, 'accuracy': 0.3647888439901751, 'macro avg': {'precision': 0.3674799421716551, 'recall': 0.3687470693342951, 'f1-score': 0.3171553722675848, 'support': 113589}, 'weighted avg': {'precision': 0.3675416021620324, 'recall': 0.3647888439901751, 'f1-score': 0.3144324741833397, 'support': 113589}}
[[21512 13935  1775]
 [18016 17952  1633]
 [22624 14170  1972]]
Evaluating performance on  val set...
144/144 - 5s - 5s/epoch - 33ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1152976
{'0': {'precision': 0.34904218463419606, 'recall': 0.5522327905852007, 'f1-score': 0.42773303365174503, 'support': 12406}, '1': {'precision': 0.36718647621543704, 'recall': 0.46002298473157116, 'f1-score': 0.40839527765631833, 'support': 12182}, '2': {'precision': 0.3481735159817352, 'recall': 0.05060560809689729, 'f1-score': 0.08836737650296972, 'support': 12054}, 'accuracy': 0.356558048141477, 'macro avg': {'precision': 0.3548007256104561, 'recall': 0.35428712780455635, 'f1-score': 0.30816522927034434, 'support': 36642}, 'weighted avg': {'precision': 0.3547886730383747, 'recall': 0.356558048141477, 'f1-score': 0.30966398243162535, 'support': 36642}}
[[6851 4910  645]
 [6081 5604  497]
 [6696 4748  610]]
training model: results/XRAY/W3/deepLOB_L2/h300
Epoch 1/50
444/444 - 38s - loss: 3.3299 - accuracy300: 0.3575 - val_loss: 3.3822 - val_accuracy300: 0.3464 - 38s/epoch - 86ms/step
Epoch 2/50
444/444 - 29s - loss: 3.2900 - accuracy300: 0.3804 - val_loss: 3.3944 - val_accuracy300: 0.3578 - 29s/epoch - 65ms/step
Epoch 3/50
444/444 - 33s - loss: 3.2624 - accuracy300: 0.3915 - val_loss: 3.3760 - val_accuracy300: 0.3505 - 33s/epoch - 74ms/step
Epoch 4/50
444/444 - 33s - loss: 3.2494 - accuracy300: 0.4035 - val_loss: 3.4042 - val_accuracy300: 0.3476 - 33s/epoch - 75ms/step
Epoch 5/50
444/444 - 32s - loss: 3.2304 - accuracy300: 0.4125 - val_loss: 3.3977 - val_accuracy300: 0.3561 - 32s/epoch - 72ms/step
Epoch 6/50
444/444 - 31s - loss: 3.2143 - accuracy300: 0.4235 - val_loss: 3.3853 - val_accuracy300: 0.3540 - 31s/epoch - 69ms/step
Epoch 7/50
444/444 - 29s - loss: 3.2036 - accuracy300: 0.4264 - val_loss: 3.3840 - val_accuracy300: 0.3523 - 29s/epoch - 65ms/step
Epoch 8/50
444/444 - 28s - loss: 3.1951 - accuracy300: 0.4297 - val_loss: 3.4038 - val_accuracy300: 0.3504 - 28s/epoch - 64ms/step
Epoch 9/50
444/444 - 32s - loss: 3.1806 - accuracy300: 0.4354 - val_loss: 3.4124 - val_accuracy300: 0.3525 - 32s/epoch - 72ms/step
Epoch 10/50
444/444 - 34s - loss: 3.1631 - accuracy300: 0.4422 - val_loss: 3.4408 - val_accuracy300: 0.3539 - 34s/epoch - 77ms/step
Epoch 11/50
444/444 - 30s - loss: 3.1535 - accuracy300: 0.4467 - val_loss: 3.4570 - val_accuracy300: 0.3576 - 30s/epoch - 67ms/step
Epoch 12/50
444/444 - 30s - loss: 3.1400 - accuracy300: 0.4523 - val_loss: 3.4630 - val_accuracy300: 0.3519 - 30s/epoch - 68ms/step
Epoch 13/50
444/444 - 31s - loss: 3.1332 - accuracy300: 0.4547 - val_loss: 3.4677 - val_accuracy300: 0.3544 - 31s/epoch - 69ms/step
testing model: results/XRAY/W3/deepLOB_L2/h300
Evaluating performance on  test set...
1359/1359 - 34s - 34s/epoch - 25ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1132452
{'0': {'precision': 0.3345791066025983, 'recall': 0.23960314503637184, 'f1-score': 0.27923609960639595, 'support': 102002}, '1': {'precision': 0.4689833933749231, 'recall': 0.3624738543449325, 'f1-score': 0.4089066964935533, 'support': 147252}, '2': {'precision': 0.2892434635649667, 'recall': 0.472383735679422, 'f1-score': 0.35879471735050544, 'support': 98547}, 'accuracy': 0.35758091552353216, 'macro avg': {'precision': 0.36426865451416274, 'recall': 0.3581535783535754, 'f1-score': 0.3489791711501516, 'support': 347801}, 'weighted avg': {'precision': 0.37863765853709214, 'recall': 0.35758091552353216, 'f1-score': 0.3566784239115488, 'support': 347801}}
[[24440 32333 45229]
 [24714 53375 69163]
 [23893 28102 46552]]
Evaluating performance on  train set...
444/444 - 14s - 14s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.152427
{'0': {'precision': 0.33538178363614773, 'recall': 0.605704787947027, 'f1-score': 0.4317187350721315, 'support': 37302}, '1': {'precision': 0.38971589361895254, 'recall': 0.2311004655919477, 'f1-score': 0.2901454613032387, 'support': 37157}, '2': {'precision': 0.3768553355108116, 'recall': 0.23294147712752364, 'f1-score': 0.287916357376376, 'support': 39130}, 'accuracy': 0.3547526609090669, 'macro avg': {'precision': 0.3673176709219706, 'recall': 0.35658224355549945, 'f1-score': 0.3365935179172488, 'support': 113589}, 'weighted avg': {'precision': 0.36744256953519316, 'recall': 0.3547526609090669, 'f1-score': 0.33586944356797477, 'support': 113589}}
[[22594  6817  7891]
 [21389  8587  7181]
 [23385  6630  9115]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 29ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1265382
{'0': {'precision': 0.349454608414613, 'recall': 0.47186720698254364, 'f1-score': 0.4015385125501509, 'support': 12832}, '1': {'precision': 0.32826269408308856, 'recall': 0.27459412022817026, 'f1-score': 0.2990395183256081, 'support': 11395}, '2': {'precision': 0.37943371154042727, 'recall': 0.2989931534434152, 'f1-score': 0.33444454455356337, 'support': 12415}, 'accuracy': 0.35194585448392557, 'macro avg': {'precision': 0.3523836713460429, 'recall': 0.34848482688470966, 'f1-score': 0.34500752514310745, 'support': 36642}, 'weighted avg': {'precision': 0.35302179092373537, 'recall': 0.35194585448392557, 'f1-score': 0.34693047663872956, 'support': 36642}}
[[6055 3353 3424]
 [5619 3129 2647]
 [5653 3050 3712]]
training model: results/XRAY/W3/deepLOB_L2/h500
Epoch 1/50
444/444 - 37s - loss: 3.3204 - accuracy500: 0.3675 - val_loss: 3.4123 - val_accuracy500: 0.3466 - 37s/epoch - 82ms/step
Epoch 2/50
444/444 - 32s - loss: 3.2901 - accuracy500: 0.3786 - val_loss: 3.3655 - val_accuracy500: 0.3432 - 32s/epoch - 71ms/step
Epoch 3/50
444/444 - 29s - loss: 3.2664 - accuracy500: 0.3860 - val_loss: 3.3985 - val_accuracy500: 0.3454 - 29s/epoch - 66ms/step
Epoch 4/50
444/444 - 29s - loss: 3.2403 - accuracy500: 0.4056 - val_loss: 3.4260 - val_accuracy500: 0.3559 - 29s/epoch - 65ms/step
Epoch 5/50
444/444 - 29s - loss: 3.2172 - accuracy500: 0.4208 - val_loss: 3.4059 - val_accuracy500: 0.3654 - 29s/epoch - 66ms/step
Epoch 6/50
444/444 - 28s - loss: 3.1935 - accuracy500: 0.4318 - val_loss: 3.4794 - val_accuracy500: 0.3632 - 28s/epoch - 64ms/step
Epoch 7/50
444/444 - 31s - loss: 3.1709 - accuracy500: 0.4438 - val_loss: 3.5218 - val_accuracy500: 0.3633 - 31s/epoch - 70ms/step
Epoch 8/50
444/444 - 29s - loss: 3.1530 - accuracy500: 0.4483 - val_loss: 3.5348 - val_accuracy500: 0.3651 - 29s/epoch - 66ms/step
Epoch 9/50
444/444 - 29s - loss: 3.1366 - accuracy500: 0.4554 - val_loss: 3.5720 - val_accuracy500: 0.3650 - 29s/epoch - 66ms/step
Epoch 10/50
444/444 - 33s - loss: 3.1231 - accuracy500: 0.4603 - val_loss: 3.6384 - val_accuracy500: 0.3625 - 33s/epoch - 74ms/step
Epoch 11/50
444/444 - 31s - loss: 3.1085 - accuracy500: 0.4654 - val_loss: 3.6812 - val_accuracy500: 0.3650 - 31s/epoch - 69ms/step
Epoch 12/50
444/444 - 29s - loss: 3.0948 - accuracy500: 0.4702 - val_loss: 3.6596 - val_accuracy500: 0.3664 - 29s/epoch - 66ms/step
testing model: results/XRAY/W3/deepLOB_L2/h500
Evaluating performance on  test set...
1359/1359 - 37s - 37s/epoch - 27ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1186043
{'0': {'precision': 0.30929595617850814, 'recall': 0.19362581946545637, 'f1-score': 0.23815903734028032, 'support': 99150}, '1': {'precision': 0.44763726372637264, 'recall': 0.2648815270001265, 'f1-score': 0.3328216560775965, 'support': 150203}, '2': {'precision': 0.27601078988676714, 'recall': 0.5518954168698196, 'f1-score': 0.3679863460424857, 'support': 98448}, 'accuracy': 0.32580987403716494, 'macro avg': {'precision': 0.3443146699305493, 'recall': 0.3368009211118008, 'f1-score': 0.3129890131534542, 'support': 347801}, 'weighted avg': {'precision': 0.3596190471601976, 'recall': 0.32580987403716494, 'f1-score': 0.3157892000175464, 'support': 347801}}
[[19198 25443 54509]
 [22408 39786 88009]
 [20464 23651 54333]]
Evaluating performance on  train set...
444/444 - 13s - 13s/epoch - 30ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1311349
{'0': {'precision': 0.332526480232099, 'recall': 0.5182470034246576, 'f1-score': 0.4051157099982223, 'support': 37376}, '1': {'precision': 0.351302598258577, 'recall': 0.27013257222118486, 'f1-score': 0.30541649074129923, 'support': 37489}, '2': {'precision': 0.3649428539096979, 'recall': 0.24984505732878834, 'f1-score': 0.29661991262359166, 'support': 38724}, 'accuracy': 0.344857336537869, 'macro avg': {'precision': 0.349590644133458, 'recall': 0.34607487765821027, 'f1-score': 0.3357173711210377, 'support': 113589}, 'weighted avg': {'precision': 0.34977453720052004, 'recall': 0.344857336537869, 'f1-score': 0.3352232442818414, 'support': 113589}}
[[19370  9316  8690]
 [19216 10127  8146]
 [19665  9384  9675]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1207875
{'0': {'precision': 0.3537031484257871, 'recall': 0.4588811950517389, 'f1-score': 0.3994852343538337, 'support': 12853}, '1': {'precision': 0.3218946894689469, 'recall': 0.25109706863261366, 'f1-score': 0.28212207869046446, 'support': 11394}, '2': {'precision': 0.3643830670638144, 'recall': 0.32569584509883015, 'f1-score': 0.34395501405810686, 'support': 12395}, 'accuracy': 0.3492167458108182, 'macro avg': {'precision': 0.3466603016528495, 'recall': 0.34522470292772756, 'f1-score': 0.341854109034135, 'support': 36642}, 'weighted avg': {'precision': 0.3474248887828667, 'recall': 0.3492167458108182, 'f1-score': 0.34420624095298324, 'support': 36642}}
[[5898 3137 3818]
 [5309 2861 3224]
 [5468 2890 4037]]
training model: results/XRAY/W3/deepLOB_L2/h1000
Epoch 1/50
444/444 - 39s - loss: 3.3149 - accuracy1000: 0.3778 - val_loss: 3.4744 - val_accuracy1000: 0.3712 - 39s/epoch - 87ms/step
Epoch 2/50
444/444 - 33s - loss: 3.2702 - accuracy1000: 0.3948 - val_loss: 3.4089 - val_accuracy1000: 0.3684 - 33s/epoch - 75ms/step
Epoch 3/50
444/444 - 28s - loss: 3.2309 - accuracy1000: 0.4149 - val_loss: 3.4787 - val_accuracy1000: 0.3575 - 28s/epoch - 63ms/step
Epoch 4/50
444/444 - 30s - loss: 3.1830 - accuracy1000: 0.4373 - val_loss: 3.4972 - val_accuracy1000: 0.3681 - 30s/epoch - 67ms/step
Epoch 5/50
444/444 - 31s - loss: 3.1686 - accuracy1000: 0.4422 - val_loss: 3.4747 - val_accuracy1000: 0.3598 - 31s/epoch - 71ms/step
Epoch 6/50
444/444 - 28s - loss: 3.1665 - accuracy1000: 0.4393 - val_loss: 3.4958 - val_accuracy1000: 0.3605 - 28s/epoch - 64ms/step
Epoch 7/50
444/444 - 32s - loss: 3.1221 - accuracy1000: 0.4624 - val_loss: 3.5900 - val_accuracy1000: 0.3601 - 32s/epoch - 73ms/step
Epoch 8/50
444/444 - 32s - loss: 3.0961 - accuracy1000: 0.4696 - val_loss: 3.6519 - val_accuracy1000: 0.3610 - 32s/epoch - 72ms/step
Epoch 9/50
444/444 - 31s - loss: 3.0692 - accuracy1000: 0.4824 - val_loss: 3.6483 - val_accuracy1000: 0.3594 - 31s/epoch - 71ms/step
Epoch 10/50
444/444 - 30s - loss: 3.0473 - accuracy1000: 0.4894 - val_loss: 3.6869 - val_accuracy1000: 0.3602 - 30s/epoch - 68ms/step
Epoch 11/50
444/444 - 31s - loss: 3.0301 - accuracy1000: 0.4953 - val_loss: 3.7787 - val_accuracy1000: 0.3627 - 31s/epoch - 70ms/step
Epoch 12/50
444/444 - 29s - loss: 3.0144 - accuracy1000: 0.5010 - val_loss: 3.7989 - val_accuracy1000: 0.3632 - 29s/epoch - 65ms/step
testing model: results/XRAY/W3/deepLOB_L2/h1000
Evaluating performance on  test set...
1359/1359 - 36s - 36s/epoch - 26ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2024888
{'0': {'precision': 0.34088101174832086, 'recall': 0.15925906491053157, 'f1-score': 0.21709274545428536, 'support': 95285}, '1': {'precision': 0.4236662565708534, 'recall': 0.09299813414514387, 'f1-score': 0.15251746421597245, 'support': 162928}, '2': {'precision': 0.2422211423444976, 'recall': 0.7232999955351163, 'f1-score': 0.36290981999843186, 'support': 89588}, 'accuracy': 0.2735069766906938, 'macro avg': {'precision': 0.33558947022122393, 'recall': 0.3251857315302639, 'f1-score': 0.24417334322289655, 'support': 347801}, 'weighted avg': {'precision': 0.35424869610890597, 'recall': 0.2735069766906938, 'f1-score': 0.22440249629647718, 'support': 347801}}
[[ 15175  10218  69892]
 [ 14947  15152 132829]
 [ 14395  10394  64799]]
Evaluating performance on  train set...
444/444 - 13s - 13s/epoch - 28ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1829857
{'0': {'precision': 0.3352311282501117, 'recall': 0.5472697306206263, 'f1-score': 0.41577715740208554, 'support': 37011}, '1': {'precision': 0.36134946437136917, 'recall': 0.17961692319919464, 'f1-score': 0.23995752964077155, 'support': 37747}, '2': {'precision': 0.37279465194012495, 'recall': 0.33030310834127374, 'f1-score': 0.35026489704516905, 'support': 38831}, 'accuracy': 0.35092306473338086, 'macro avg': {'precision': 0.3564584148538686, 'recall': 0.3523965873870316, 'f1-score': 0.3353331946960087, 'support': 113589}, 'weighted avg': {'precision': 0.3567518566831115, 'recall': 0.35092306473338086, 'f1-score': 0.3349544538742286, 'support': 113589}}
[[20255  5867 10889]
 [20277  6780 10690]
 [19889  6116 12826]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 29ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1332724
{'0': {'precision': 0.3707679603633361, 'recall': 0.28893178893178895, 'f1-score': 0.32477396021699817, 'support': 12432}, '1': {'precision': 0.36703988803358994, 'recall': 0.17055523941142997, 'f1-score': 0.2328911583504468, 'support': 12301}, '2': {'precision': 0.3726810434127507, 'recall': 0.6646233940717104, 'f1-score': 0.4775696141430597, 'support': 11909}, 'accuracy': 0.37129523497625677, 'macro avg': {'precision': 0.3701629639365589, 'recall': 0.3747034741383098, 'f1-score': 0.3450782442368349, 'support': 36642}, 'weighted avg': {'precision': 0.37013818819771394, 'recall': 0.37129523497625677, 'f1-score': 0.343588247014799, 'support': 36642}}
[[3592 2222 6618]
 [3498 2098 6705]
 [2598 1396 7915]]
training model: results/XRAY/W3/deepOF_L2/h10
Epoch 1/50
444/444 - 32s - loss: 3.2557 - accuracy10: 0.3945 - val_loss: 3.1793 - val_accuracy10: 0.4247 - 32s/epoch - 72ms/step
Epoch 2/50
444/444 - 23s - loss: 3.1704 - accuracy10: 0.4350 - val_loss: 3.1269 - val_accuracy10: 0.4468 - 23s/epoch - 51ms/step
Epoch 3/50
444/444 - 23s - loss: 3.1286 - accuracy10: 0.4550 - val_loss: 3.0962 - val_accuracy10: 0.4571 - 23s/epoch - 51ms/step
Epoch 4/50
444/444 - 25s - loss: 3.0993 - accuracy10: 0.4647 - val_loss: 3.0771 - val_accuracy10: 0.4676 - 25s/epoch - 56ms/step
Epoch 5/50
444/444 - 21s - loss: 3.0740 - accuracy10: 0.4738 - val_loss: 3.0608 - val_accuracy10: 0.4745 - 21s/epoch - 48ms/step
Epoch 6/50
444/444 - 24s - loss: 3.0528 - accuracy10: 0.4804 - val_loss: 3.0516 - val_accuracy10: 0.4775 - 24s/epoch - 53ms/step
Epoch 7/50
444/444 - 25s - loss: 3.0381 - accuracy10: 0.4864 - val_loss: 3.0490 - val_accuracy10: 0.4798 - 25s/epoch - 57ms/step
Epoch 8/50
444/444 - 27s - loss: 3.0239 - accuracy10: 0.4909 - val_loss: 3.0495 - val_accuracy10: 0.4788 - 27s/epoch - 61ms/step
Epoch 9/50
444/444 - 23s - loss: 3.0126 - accuracy10: 0.4941 - val_loss: 3.0456 - val_accuracy10: 0.4827 - 23s/epoch - 53ms/step
Epoch 10/50
444/444 - 23s - loss: 3.0018 - accuracy10: 0.4971 - val_loss: 3.0446 - val_accuracy10: 0.4822 - 23s/epoch - 52ms/step
Epoch 11/50
444/444 - 24s - loss: 2.9924 - accuracy10: 0.5002 - val_loss: 3.0385 - val_accuracy10: 0.4873 - 24s/epoch - 55ms/step
Epoch 12/50
444/444 - 23s - loss: 2.9854 - accuracy10: 0.5025 - val_loss: 3.0382 - val_accuracy10: 0.4870 - 23s/epoch - 53ms/step
Epoch 13/50
444/444 - 23s - loss: 2.9762 - accuracy10: 0.5049 - val_loss: 3.0432 - val_accuracy10: 0.4864 - 23s/epoch - 52ms/step
Epoch 14/50
444/444 - 26s - loss: 2.9669 - accuracy10: 0.5074 - val_loss: 3.0359 - val_accuracy10: 0.4871 - 26s/epoch - 60ms/step
Epoch 15/50
444/444 - 25s - loss: 2.9623 - accuracy10: 0.5086 - val_loss: 3.0463 - val_accuracy10: 0.4833 - 25s/epoch - 55ms/step
Epoch 16/50
444/444 - 25s - loss: 2.9535 - accuracy10: 0.5119 - val_loss: 3.0445 - val_accuracy10: 0.4876 - 25s/epoch - 55ms/step
Epoch 17/50
444/444 - 23s - loss: 2.9451 - accuracy10: 0.5150 - val_loss: 3.0382 - val_accuracy10: 0.4872 - 23s/epoch - 53ms/step
Epoch 18/50
444/444 - 25s - loss: 2.9367 - accuracy10: 0.5158 - val_loss: 3.0472 - val_accuracy10: 0.4865 - 25s/epoch - 56ms/step
Epoch 19/50
444/444 - 20s - loss: 2.9302 - accuracy10: 0.5188 - val_loss: 3.0355 - val_accuracy10: 0.4869 - 20s/epoch - 46ms/step
Epoch 20/50
444/444 - 21s - loss: 2.9224 - accuracy10: 0.5211 - val_loss: 3.0375 - val_accuracy10: 0.4890 - 21s/epoch - 48ms/step
Epoch 21/50
444/444 - 25s - loss: 2.9197 - accuracy10: 0.5212 - val_loss: 3.0454 - val_accuracy10: 0.4848 - 25s/epoch - 57ms/step
Epoch 22/50
444/444 - 28s - loss: 2.9123 - accuracy10: 0.5225 - val_loss: 3.0463 - val_accuracy10: 0.4882 - 28s/epoch - 62ms/step
Epoch 23/50
444/444 - 23s - loss: 2.9039 - accuracy10: 0.5267 - val_loss: 3.0467 - val_accuracy10: 0.4883 - 23s/epoch - 52ms/step
Epoch 24/50
444/444 - 20s - loss: 2.8953 - accuracy10: 0.5286 - val_loss: 3.0526 - val_accuracy10: 0.4909 - 20s/epoch - 46ms/step
Epoch 25/50
444/444 - 20s - loss: 2.8885 - accuracy10: 0.5296 - val_loss: 3.0477 - val_accuracy10: 0.4899 - 20s/epoch - 45ms/step
Epoch 26/50
444/444 - 27s - loss: 2.8834 - accuracy10: 0.5307 - val_loss: 3.0504 - val_accuracy10: 0.4901 - 27s/epoch - 61ms/step
Epoch 27/50
444/444 - 21s - loss: 2.8753 - accuracy10: 0.5318 - val_loss: 3.0469 - val_accuracy10: 0.4910 - 21s/epoch - 48ms/step
Epoch 28/50
444/444 - 22s - loss: 2.8672 - accuracy10: 0.5356 - val_loss: 3.0601 - val_accuracy10: 0.4911 - 22s/epoch - 49ms/step
Epoch 29/50
444/444 - 21s - loss: 2.8626 - accuracy10: 0.5364 - val_loss: 3.0715 - val_accuracy10: 0.4851 - 21s/epoch - 48ms/step
testing model: results/XRAY/W3/deepOF_L2/h10
Evaluating performance on  test set...
1359/1359 - 27s - 27s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0159475
{'0': {'precision': 0.5043936295470037, 'recall': 0.3698281580836582, 'f1-score': 0.4267543307747158, 'support': 110043}, '1': {'precision': 0.46109625867379583, 'recall': 0.7106285067804125, 'f1-score': 0.5592920034533482, 'support': 130818}, '2': {'precision': 0.5219927021786592, 'recall': 0.3197239470337398, 'f1-score': 0.396555223707484, 'support': 106936}, 'accuracy': 0.48260910818667213, 'macro avg': {'precision': 0.49582753013315295, 'recall': 0.46672687063260354, 'f1-score': 0.460867185978516, 'support': 347797}, 'weighted avg': {'precision': 0.49351917970427195, 'recall': 0.48260910818667213, 'f1-score': 0.4673209301160897, 'support': 347797}}
[[40697 54987 14359]
 [20905 92963 16950]
 [19083 53663 34190]]
Evaluating performance on  train set...
444/444 - 12s - 12s/epoch - 26ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.995297
{'0': {'precision': 0.5186387723221123, 'recall': 0.45077471913103667, 'f1-score': 0.48233132504379783, 'support': 37562}, '1': {'precision': 0.4674147029127693, 'recall': 0.6410450685826258, 'f1-score': 0.5406310594041953, 'support': 38275}, '2': {'precision': 0.5345542744656918, 'recall': 0.4028237662578475, 'f1-score': 0.4594329219474615, 'support': 37751}, 'accuracy': 0.4989523541219143, 'macro avg': {'precision': 0.5068692499001911, 'recall': 0.4982145179905033, 'f1-score': 0.4941317687984849, 'support': 113588}, 'weighted avg': {'precision': 0.5066676562251625, 'recall': 0.4989523541219143, 'f1-score': 0.4943659124769283, 'support': 113588}}
[[16932 13737  6893]
 [ 7391 24536  6348]
 [ 8324 14220 15207]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 27ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0109975
{'0': {'precision': 0.49925737322300023, 'recall': 0.40092008860112455, 'f1-score': 0.44471744471744473, 'support': 11738}, '1': {'precision': 0.46925735833246046, 'recall': 0.6778635194431836, 'f1-score': 0.5545927209705372, 'support': 13218}, '2': {'precision': 0.5190839694656488, 'recall': 0.3607735752182098, 'f1-score': 0.425686591276252, 'support': 11686}, 'accuracy': 0.4880192129250587, 'macro avg': {'precision': 0.4958662336737032, 'recall': 0.47985239442083927, 'f1-score': 0.47499891898807794, 'support': 36642}, 'weighted avg': {'precision': 0.49475853055252467, 'recall': 0.4880192129250587, 'f1-score': 0.47828375791540334, 'support': 36642}}
[[4706 5068 1964]
 [2316 8960 1942]
 [2404 5066 4216]]
training model: results/XRAY/W3/deepOF_L2/h20
Epoch 1/50
444/444 - 29s - loss: 3.2886 - accuracy20: 0.3750 - val_loss: 3.2316 - val_accuracy20: 0.4001 - 29s/epoch - 66ms/step
Epoch 2/50
444/444 - 22s - loss: 3.2278 - accuracy20: 0.4087 - val_loss: 3.2036 - val_accuracy20: 0.4140 - 22s/epoch - 50ms/step
Epoch 3/50
444/444 - 22s - loss: 3.2016 - accuracy20: 0.4215 - val_loss: 3.1829 - val_accuracy20: 0.4215 - 22s/epoch - 50ms/step
Epoch 4/50
444/444 - 21s - loss: 3.1813 - accuracy20: 0.4305 - val_loss: 3.1729 - val_accuracy20: 0.4269 - 21s/epoch - 48ms/step
Epoch 5/50
444/444 - 23s - loss: 3.1684 - accuracy20: 0.4371 - val_loss: 3.1619 - val_accuracy20: 0.4331 - 23s/epoch - 51ms/step
Epoch 6/50
444/444 - 23s - loss: 3.1542 - accuracy20: 0.4425 - val_loss: 3.1603 - val_accuracy20: 0.4311 - 23s/epoch - 51ms/step
Epoch 7/50
444/444 - 22s - loss: 3.1406 - accuracy20: 0.4466 - val_loss: 3.1546 - val_accuracy20: 0.4375 - 22s/epoch - 50ms/step
Epoch 8/50
444/444 - 26s - loss: 3.1303 - accuracy20: 0.4502 - val_loss: 3.1565 - val_accuracy20: 0.4385 - 26s/epoch - 58ms/step
Epoch 9/50
444/444 - 23s - loss: 3.1199 - accuracy20: 0.4545 - val_loss: 3.1533 - val_accuracy20: 0.4411 - 23s/epoch - 53ms/step
Epoch 10/50
444/444 - 26s - loss: 3.1101 - accuracy20: 0.4586 - val_loss: 3.1539 - val_accuracy20: 0.4425 - 26s/epoch - 58ms/step
Epoch 11/50
444/444 - 23s - loss: 3.1027 - accuracy20: 0.4620 - val_loss: 3.1568 - val_accuracy20: 0.4422 - 23s/epoch - 52ms/step
Epoch 12/50
444/444 - 25s - loss: 3.0938 - accuracy20: 0.4651 - val_loss: 3.1577 - val_accuracy20: 0.4436 - 25s/epoch - 56ms/step
Epoch 13/50
444/444 - 22s - loss: 3.0856 - accuracy20: 0.4663 - val_loss: 3.1566 - val_accuracy20: 0.4440 - 22s/epoch - 49ms/step
Epoch 14/50
444/444 - 22s - loss: 3.0777 - accuracy20: 0.4703 - val_loss: 3.1582 - val_accuracy20: 0.4450 - 22s/epoch - 49ms/step
Epoch 15/50
444/444 - 22s - loss: 3.0698 - accuracy20: 0.4736 - val_loss: 3.1598 - val_accuracy20: 0.4439 - 22s/epoch - 49ms/step
Epoch 16/50
444/444 - 20s - loss: 3.0622 - accuracy20: 0.4770 - val_loss: 3.1590 - val_accuracy20: 0.4483 - 20s/epoch - 44ms/step
Epoch 17/50
444/444 - 21s - loss: 3.0568 - accuracy20: 0.4787 - val_loss: 3.1686 - val_accuracy20: 0.4420 - 21s/epoch - 46ms/step
Epoch 18/50
444/444 - 21s - loss: 3.0468 - accuracy20: 0.4817 - val_loss: 3.1678 - val_accuracy20: 0.4467 - 21s/epoch - 46ms/step
Epoch 19/50
444/444 - 21s - loss: 3.0391 - accuracy20: 0.4842 - val_loss: 3.1697 - val_accuracy20: 0.4453 - 21s/epoch - 48ms/step
testing model: results/XRAY/W3/deepOF_L2/h20
Evaluating performance on  test set...
1359/1359 - 32s - 32s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0531092
{'0': {'precision': 0.4396779551460902, 'recall': 0.47775140248401926, 'f1-score': 0.45792465210611083, 'support': 112479}, '1': {'precision': 0.4262611922466019, 'recall': 0.4873640987729716, 'f1-score': 0.45476937611769075, 'support': 124447}, '2': {'precision': 0.45677856216683477, 'recall': 0.343155559163352, 'f1-score': 0.39189752939540495, 'support': 110871}, 'accuracy': 0.4382844015330782, 'macro avg': {'precision': 0.44090590318650896, 'recall': 0.43609035347344766, 'f1-score': 0.43486385253973553, 'support': 347797}, 'weighted avg': {'precision': 0.4403285803914038, 'recall': 0.4382844015330782, 'f1-score': 0.4357474689993284, 'support': 347797}}
[[53737 39554 19188]
 [37738 60651 26058]
 [30744 42081 38046]]
Evaluating performance on  train set...
444/444 - 11s - 11s/epoch - 25ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0435507
{'0': {'precision': 0.4500935529324802, 'recall': 0.5186594974446337, 'f1-score': 0.4819500612176752, 'support': 37568}, '1': {'precision': 0.4404845096668996, 'recall': 0.44966708941027267, 'f1-score': 0.4450284369484213, 'support': 37848}, '2': {'precision': 0.47725837018319645, 'recall': 0.39583988263648745, 'f1-score': 0.43275289265666167, 'support': 38172}, 'accuracy': 0.4543965911892101, 'macro avg': {'precision': 0.4559454775941921, 'recall': 0.45472215649713127, 'f1-score': 0.4532437969409194, 'support': 113588}, 'weighted avg': {'precision': 0.4560206960688912, 'recall': 0.4543965911892101, 'f1-score': 0.4531145860472898, 'support': 113588}}
[[19485 10203  7880]
 [12159 17019  8670]
 [11647 11415 15110]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 29ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0508362
{'0': {'precision': 0.44570960779936, 'recall': 0.4975492232283792, 'f1-score': 0.47020491481510557, 'support': 12037}, '1': {'precision': 0.4214851775755797, 'recall': 0.45783516658696, 'f1-score': 0.43890884083441584, 'support': 12546}, '2': {'precision': 0.46622115485016186, 'recall': 0.37026287420184095, 'f1-score': 0.41273802921057495, 'support': 12059}, 'accuracy': 0.44206102286993065, 'macro avg': {'precision': 0.44447198007503386, 'recall': 0.44188242133906, 'f1-score': 0.4406172616200321, 'support': 36642}, 'weighted avg': {'precision': 0.44416572494083895, 'recall': 0.44206102286993065, 'f1-score': 0.4405767908680839, 'support': 36642}}
[[5989 3766 2282]
 [3972 5744 2830]
 [3476 4118 4465]]
training model: results/XRAY/W3/deepOF_L2/h30
Epoch 1/50
444/444 - 27s - loss: 3.3031 - accuracy30: 0.3664 - val_loss: 3.2507 - val_accuracy30: 0.3910 - 27s/epoch - 60ms/step
Epoch 2/50
444/444 - 27s - loss: 3.2521 - accuracy30: 0.3960 - val_loss: 3.2295 - val_accuracy30: 0.4011 - 27s/epoch - 62ms/step
Epoch 3/50
444/444 - 31s - loss: 3.2277 - accuracy30: 0.4076 - val_loss: 3.2195 - val_accuracy30: 0.4078 - 31s/epoch - 69ms/step
Epoch 4/50
444/444 - 25s - loss: 3.2106 - accuracy30: 0.4175 - val_loss: 3.2095 - val_accuracy30: 0.4125 - 25s/epoch - 56ms/step
Epoch 5/50
444/444 - 23s - loss: 3.1986 - accuracy30: 0.4249 - val_loss: 3.2039 - val_accuracy30: 0.4162 - 23s/epoch - 52ms/step
Epoch 6/50
444/444 - 22s - loss: 3.1869 - accuracy30: 0.4271 - val_loss: 3.2018 - val_accuracy30: 0.4180 - 22s/epoch - 49ms/step
Epoch 7/50
444/444 - 20s - loss: 3.1756 - accuracy30: 0.4328 - val_loss: 3.2009 - val_accuracy30: 0.4206 - 20s/epoch - 46ms/step
Epoch 8/50
444/444 - 19s - loss: 3.1664 - accuracy30: 0.4375 - val_loss: 3.2004 - val_accuracy30: 0.4193 - 19s/epoch - 44ms/step
Epoch 9/50
444/444 - 22s - loss: 3.1581 - accuracy30: 0.4390 - val_loss: 3.2040 - val_accuracy30: 0.4223 - 22s/epoch - 48ms/step
Epoch 10/50
444/444 - 32s - loss: 3.1493 - accuracy30: 0.4436 - val_loss: 3.2034 - val_accuracy30: 0.4231 - 32s/epoch - 73ms/step
Epoch 11/50
444/444 - 28s - loss: 3.1445 - accuracy30: 0.4457 - val_loss: 3.2050 - val_accuracy30: 0.4231 - 28s/epoch - 63ms/step
Epoch 12/50
444/444 - 24s - loss: 3.1363 - accuracy30: 0.4483 - val_loss: 3.2057 - val_accuracy30: 0.4224 - 24s/epoch - 53ms/step
Epoch 13/50
444/444 - 24s - loss: 3.1294 - accuracy30: 0.4519 - val_loss: 3.2054 - val_accuracy30: 0.4241 - 24s/epoch - 53ms/step
Epoch 14/50
444/444 - 25s - loss: 3.1236 - accuracy30: 0.4540 - val_loss: 3.2054 - val_accuracy30: 0.4248 - 25s/epoch - 55ms/step
Epoch 15/50
444/444 - 20s - loss: 3.1153 - accuracy30: 0.4573 - val_loss: 3.2065 - val_accuracy30: 0.4259 - 20s/epoch - 45ms/step
Epoch 16/50
444/444 - 22s - loss: 3.1087 - accuracy30: 0.4603 - val_loss: 3.2101 - val_accuracy30: 0.4242 - 22s/epoch - 50ms/step
Epoch 17/50
444/444 - 30s - loss: 3.1013 - accuracy30: 0.4621 - val_loss: 3.2180 - val_accuracy30: 0.4221 - 30s/epoch - 69ms/step
Epoch 18/50
444/444 - 25s - loss: 3.0932 - accuracy30: 0.4655 - val_loss: 3.2187 - val_accuracy30: 0.4205 - 25s/epoch - 56ms/step
testing model: results/XRAY/W3/deepOF_L2/h30
Evaluating performance on  test set...
1359/1359 - 30s - 30s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0776153
{'0': {'precision': 0.41701506454596177, 'recall': 0.47661934920288274, 'f1-score': 0.44482944169058175, 'support': 114475}, '1': {'precision': 0.38634103215824955, 'recall': 0.4618801866149209, 'f1-score': 0.42074700344880755, 'support': 121105}, '2': {'precision': 0.43877466193748615, 'recall': 0.2822121425452472, 'f1-score': 0.34349460120503494, 'support': 112217}, 'accuracy': 0.4087614326748074, 'macro avg': {'precision': 0.41404358621389914, 'recall': 0.4069038927876836, 'f1-score': 0.40302368211480805, 'support': 347797}, 'weighted avg': {'precision': 0.4133549353561493, 'recall': 0.4087614326748074, 'f1-score': 0.4037480192572753, 'support': 347797}}
[[54561 42633 17281]
 [41943 55936 23226]
 [34333 46215 31669]]
Evaluating performance on  train set...
444/444 - 14s - 14s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0591552
{'0': {'precision': 0.4343938766164381, 'recall': 0.5309592984513687, 'f1-score': 0.4778468107563509, 'support': 37517}, '1': {'precision': 0.4126736067350591, 'recall': 0.4357732233164759, 'f1-score': 0.4239089626244449, 'support': 37570}, '2': {'precision': 0.46899280062727206, 'recall': 0.34178333030310903, 'f1-score': 0.3954085848645562, 'support': 38501}, 'accuracy': 0.4353540866992992, 'macro avg': {'precision': 0.4386867613262564, 'recall': 0.4361719506903179, 'f1-score': 0.43238811941511734, 'support': 113588}, 'weighted avg': {'precision': 0.43893716141674893, 'recall': 0.4353540866992992, 'f1-score': 0.4320638135262236, 'support': 113588}}
[[19920 10821  6776]
 [13075 16372  8123]
 [12862 12480 13159]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0684295
{'0': {'precision': 0.4378213949445933, 'recall': 0.49030740530456646, 'f1-score': 0.4625803489439853, 'support': 12329}, '1': {'precision': 0.3834771021810786, 'recall': 0.4558946139736535, 'f1-score': 0.4165619167333257, 'support': 11994}, '2': {'precision': 0.4608208955223881, 'recall': 0.3208052601672214, 'f1-score': 0.37827231395070593, 'support': 12319}, 'accuracy': 0.4220566562960537, 'macro avg': {'precision': 0.4273731308826867, 'recall': 0.4223357598151471, 'f1-score': 0.419138193209339, 'support': 36642}, 'weighted avg': {'precision': 0.4277653226835884, 'recall': 0.4220566562960537, 'f1-score': 0.4191728995957822, 'support': 36642}}
[[6045 4200 2084]
 [3986 5468 2540]
 [3776 4591 3952]]
training model: results/XRAY/W3/deepOF_L2/h50
Epoch 1/50
444/444 - 27s - loss: 3.3132 - accuracy50: 0.3604 - val_loss: 3.2956 - val_accuracy50: 0.3640 - 27s/epoch - 60ms/step
Epoch 2/50
444/444 - 22s - loss: 3.2695 - accuracy50: 0.3847 - val_loss: 3.2667 - val_accuracy50: 0.3837 - 22s/epoch - 50ms/step
Epoch 3/50
444/444 - 25s - loss: 3.2460 - accuracy50: 0.3977 - val_loss: 3.2629 - val_accuracy50: 0.3895 - 25s/epoch - 55ms/step
Epoch 4/50
444/444 - 24s - loss: 3.2297 - accuracy50: 0.4086 - val_loss: 3.2552 - val_accuracy50: 0.3921 - 24s/epoch - 53ms/step
Epoch 5/50
444/444 - 26s - loss: 3.2147 - accuracy50: 0.4148 - val_loss: 3.2478 - val_accuracy50: 0.3957 - 26s/epoch - 58ms/step
Epoch 6/50
444/444 - 21s - loss: 3.2026 - accuracy50: 0.4205 - val_loss: 3.2502 - val_accuracy50: 0.3991 - 21s/epoch - 48ms/step
Epoch 7/50
444/444 - 24s - loss: 3.1914 - accuracy50: 0.4271 - val_loss: 3.2516 - val_accuracy50: 0.3940 - 24s/epoch - 53ms/step
Epoch 8/50
444/444 - 21s - loss: 3.1820 - accuracy50: 0.4330 - val_loss: 3.2501 - val_accuracy50: 0.4001 - 21s/epoch - 48ms/step
Epoch 9/50
444/444 - 20s - loss: 3.1714 - accuracy50: 0.4373 - val_loss: 3.2495 - val_accuracy50: 0.3982 - 20s/epoch - 44ms/step
Epoch 10/50
444/444 - 23s - loss: 3.1636 - accuracy50: 0.4407 - val_loss: 3.2545 - val_accuracy50: 0.3984 - 23s/epoch - 51ms/step
Epoch 11/50
444/444 - 24s - loss: 3.1568 - accuracy50: 0.4436 - val_loss: 3.2559 - val_accuracy50: 0.3999 - 24s/epoch - 55ms/step
Epoch 12/50
444/444 - 20s - loss: 3.1488 - accuracy50: 0.4469 - val_loss: 3.2591 - val_accuracy50: 0.4009 - 20s/epoch - 46ms/step
Epoch 13/50
444/444 - 24s - loss: 3.1398 - accuracy50: 0.4508 - val_loss: 3.2611 - val_accuracy50: 0.4021 - 24s/epoch - 54ms/step
Epoch 14/50
444/444 - 26s - loss: 3.1340 - accuracy50: 0.4530 - val_loss: 3.2631 - val_accuracy50: 0.4002 - 26s/epoch - 58ms/step
Epoch 15/50
444/444 - 22s - loss: 3.1243 - accuracy50: 0.4579 - val_loss: 3.2638 - val_accuracy50: 0.4014 - 22s/epoch - 49ms/step
testing model: results/XRAY/W3/deepOF_L2/h50
Evaluating performance on  test set...
1359/1359 - 35s - 35s/epoch - 26ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.101737
{'0': {'precision': 0.42419125705240085, 'recall': 0.4180754798499044, 'f1-score': 0.4211111648372903, 'support': 124987}, '1': {'precision': 0.3120268907563025, 'recall': 0.4592853538102259, 'f1-score': 0.37159887433098354, 'support': 101057}, '2': {'precision': 0.42380902164456513, 'recall': 0.2640674151766281, 'f1-score': 0.3253902790780052, 'support': 121753}, 'accuracy': 0.3761360793796381, 'macro avg': {'precision': 0.3866757231510895, 'recall': 0.38047608294558616, 'f1-score': 0.372700106082093, 'support': 347797}, 'weighted avg': {'precision': 0.39146661402099164, 'recall': 0.3761360793796381, 'f1-score': 0.373215787517917, 'support': 347797}}
[[52254 50451 22282]
 [33214 46414 21429]
 [37717 51885 32151]]
Evaluating performance on  train set...
444/444 - 10s - 10s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.072096
{'0': {'precision': 0.41631436689999307, 'recall': 0.4813558416582082, 'f1-score': 0.4464787860018581, 'support': 37438}, '1': {'precision': 0.396813372107231, 'recall': 0.4327363820488221, 'f1-score': 0.41399706800943337, 'support': 37524}, '2': {'precision': 0.4379169503063308, 'recall': 0.33309169989126497, 'f1-score': 0.37837837837837834, 'support': 38626}, 'accuracy': 0.4148765714688171, 'macro avg': {'precision': 0.41701489643785167, 'recall': 0.4157279745327651, 'f1-score': 0.4129514107965566, 'support': 113588}, 'weighted avg': {'precision': 0.41721821288768185, 'recall': 0.4148765714688171, 'f1-score': 0.4125906082822726, 'support': 113588}}
[[18021 11473  7944]
 [12716 16238  8570]
 [12550 13210 12866]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0835305
{'0': {'precision': 0.4270564842771927, 'recall': 0.45632672332389046, 'f1-score': 0.44120668010803815, 'support': 12708}, '1': {'precision': 0.3494391133937019, 'recall': 0.45899165631102434, 'f1-score': 0.396792510742787, 'support': 11266}, '2': {'precision': 0.4471869328493648, 'recall': 0.29175876223555414, 'f1-score': 0.3531266421439832, 'support': 12668}, 'accuracy': 0.40025107799792586, 'macro avg': {'precision': 0.4078941768400865, 'recall': 0.4023590472901563, 'f1-score': 0.3970419443316027, 'support': 36642}, 'weighted avg': {'precision': 0.41015170894120856, 'recall': 0.40025107799792586, 'f1-score': 0.3970997003307998, 'support': 36642}}
[[5799 4596 2313]
 [3839 5171 2256]
 [3941 5031 3696]]
training model: results/XRAY/W3/deepOF_L2/h100
Epoch 1/50
444/444 - 29s - loss: 3.3271 - accuracy100: 0.3473 - val_loss: 3.3014 - val_accuracy100: 0.3578 - 29s/epoch - 65ms/step
Epoch 2/50
444/444 - 26s - loss: 3.2939 - accuracy100: 0.3677 - val_loss: 3.2805 - val_accuracy100: 0.3750 - 26s/epoch - 58ms/step
Epoch 3/50
444/444 - 24s - loss: 3.2768 - accuracy100: 0.3764 - val_loss: 3.2748 - val_accuracy100: 0.3761 - 24s/epoch - 55ms/step
Epoch 4/50
444/444 - 28s - loss: 3.2651 - accuracy100: 0.3850 - val_loss: 3.2747 - val_accuracy100: 0.3777 - 28s/epoch - 62ms/step
Epoch 5/50
444/444 - 29s - loss: 3.2553 - accuracy100: 0.3905 - val_loss: 3.2701 - val_accuracy100: 0.3769 - 29s/epoch - 66ms/step
Epoch 6/50
444/444 - 26s - loss: 3.2455 - accuracy100: 0.3966 - val_loss: 3.2729 - val_accuracy100: 0.3804 - 26s/epoch - 59ms/step
Epoch 7/50
444/444 - 26s - loss: 3.2387 - accuracy100: 0.3995 - val_loss: 3.2732 - val_accuracy100: 0.3787 - 26s/epoch - 58ms/step
Epoch 8/50
444/444 - 25s - loss: 3.2316 - accuracy100: 0.4040 - val_loss: 3.2719 - val_accuracy100: 0.3805 - 25s/epoch - 55ms/step
Epoch 9/50
444/444 - 21s - loss: 3.2262 - accuracy100: 0.4060 - val_loss: 3.2726 - val_accuracy100: 0.3799 - 21s/epoch - 48ms/step
Epoch 10/50
444/444 - 23s - loss: 3.2183 - accuracy100: 0.4098 - val_loss: 3.2722 - val_accuracy100: 0.3794 - 23s/epoch - 53ms/step
Epoch 11/50
444/444 - 25s - loss: 3.2133 - accuracy100: 0.4146 - val_loss: 3.2741 - val_accuracy100: 0.3827 - 25s/epoch - 55ms/step
Epoch 12/50
444/444 - 23s - loss: 3.2085 - accuracy100: 0.4158 - val_loss: 3.2744 - val_accuracy100: 0.3801 - 23s/epoch - 52ms/step
Epoch 13/50
444/444 - 24s - loss: 3.2020 - accuracy100: 0.4190 - val_loss: 3.2800 - val_accuracy100: 0.3813 - 24s/epoch - 54ms/step
Epoch 14/50
444/444 - 24s - loss: 3.1973 - accuracy100: 0.4205 - val_loss: 3.2802 - val_accuracy100: 0.3809 - 24s/epoch - 54ms/step
Epoch 15/50
444/444 - 30s - loss: 3.1921 - accuracy100: 0.4253 - val_loss: 3.2809 - val_accuracy100: 0.3805 - 30s/epoch - 67ms/step
testing model: results/XRAY/W3/deepOF_L2/h100
Evaluating performance on  test set...
1359/1359 - 27s - 27s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0924035
{'0': {'precision': 0.33176152610302007, 'recall': 0.5488284623208152, 'f1-score': 0.4135413089449997, 'support': 104222}, '1': {'precision': 0.45621315627061654, 'recall': 0.2991424963195021, 'f1-score': 0.3613469812600874, 'support': 143323}, '2': {'precision': 0.3351350023339803, 'recall': 0.27213422176116187, 'f1-score': 0.30036662299485845, 'support': 100252}, 'accuracy': 0.3661791217290546, 'macro avg': {'precision': 0.37436989490253897, 'recall': 0.3733683934671597, 'f1-score': 0.35841830439998185, 'support': 347797}, 'weighted avg': {'precision': 0.38401895997857577, 'recall': 0.3661791217290546, 'f1-score': 0.3594102030336254, 'support': 347797}}
[[57200 25263 21759]
 [68084 42874 32365]
 [47129 25841 27282]]
Evaluating performance on  train set...
444/444 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0841691
{'0': {'precision': 0.37696156857405455, 'recall': 0.5959049694621573, 'f1-score': 0.4617966868568927, 'support': 37167}, '1': {'precision': 0.40689791091840755, 'recall': 0.2729436027603712, 'f1-score': 0.3267237423050751, 'support': 37821}, '2': {'precision': 0.410127613358675, 'recall': 0.31305699481865285, 'f1-score': 0.35507757404795487, 'support': 38600}, 'accuracy': 0.3922509420009156, 'macro avg': {'precision': 0.3979956976170456, 'recall': 0.3939685223470604, 'f1-score': 0.38119933440330755, 'support': 113588}, 'weighted avg': {'precision': 0.3982000068993365, 'recall': 0.3922509420009156, 'f1-score': 0.38055613688401446, 'support': 113588}}
[[22148  6918  8101]
 [18219 10323  9279]
 [18387  8129 12084]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 26ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0908691
{'0': {'precision': 0.3787637828668363, 'recall': 0.5764886235275133, 'f1-score': 0.4571629662806322, 'support': 12394}, '1': {'precision': 0.36078645548880395, 'recall': 0.27866362946089596, 'f1-score': 0.31445163747143945, 'support': 11853}, '2': {'precision': 0.4061231589933898, 'recall': 0.2825332795482049, 'f1-score': 0.33323817680083734, 'support': 12395}, 'accuracy': 0.38071065989847713, 'macro avg': {'precision': 0.3818911324496767, 'recall': 0.37922851084553805, 'f1-score': 0.36828426018430305, 'support': 36642}, 'weighted avg': {'precision': 0.38220339330504416, 'recall': 0.38071065989847713, 'f1-score': 0.3690781143081029, 'support': 36642}}
[[7145 2756 2493]
 [5922 3303 2628]
 [5797 3096 3502]]
training model: results/XRAY/W3/deepOF_L2/h200
Epoch 1/50
444/444 - 27s - loss: 3.3310 - accuracy200: 0.3449 - val_loss: 3.3325 - val_accuracy200: 0.3497 - 27s/epoch - 61ms/step
Epoch 2/50
444/444 - 25s - loss: 3.3025 - accuracy200: 0.3596 - val_loss: 3.3158 - val_accuracy200: 0.3539 - 25s/epoch - 56ms/step
Epoch 3/50
444/444 - 25s - loss: 3.2859 - accuracy200: 0.3703 - val_loss: 3.3076 - val_accuracy200: 0.3591 - 25s/epoch - 55ms/step
Epoch 4/50
444/444 - 21s - loss: 3.2734 - accuracy200: 0.3763 - val_loss: 3.3158 - val_accuracy200: 0.3594 - 21s/epoch - 48ms/step
Epoch 5/50
444/444 - 22s - loss: 3.2635 - accuracy200: 0.3823 - val_loss: 3.3184 - val_accuracy200: 0.3587 - 22s/epoch - 50ms/step
Epoch 6/50
444/444 - 23s - loss: 3.2558 - accuracy200: 0.3874 - val_loss: 3.3314 - val_accuracy200: 0.3583 - 23s/epoch - 52ms/step
Epoch 7/50
444/444 - 21s - loss: 3.2500 - accuracy200: 0.3905 - val_loss: 3.3345 - val_accuracy200: 0.3566 - 21s/epoch - 48ms/step
Epoch 8/50
444/444 - 22s - loss: 3.2429 - accuracy200: 0.3933 - val_loss: 3.3375 - val_accuracy200: 0.3566 - 22s/epoch - 50ms/step
Epoch 9/50
444/444 - 22s - loss: 3.2376 - accuracy200: 0.3958 - val_loss: 3.3470 - val_accuracy200: 0.3556 - 22s/epoch - 50ms/step
Epoch 10/50
444/444 - 21s - loss: 3.2318 - accuracy200: 0.4007 - val_loss: 3.3411 - val_accuracy200: 0.3584 - 21s/epoch - 48ms/step
Epoch 11/50
444/444 - 23s - loss: 3.2270 - accuracy200: 0.4035 - val_loss: 3.3405 - val_accuracy200: 0.3587 - 23s/epoch - 51ms/step
Epoch 12/50
444/444 - 23s - loss: 3.2224 - accuracy200: 0.4058 - val_loss: 3.3524 - val_accuracy200: 0.3561 - 23s/epoch - 53ms/step
Epoch 13/50
444/444 - 21s - loss: 3.2190 - accuracy200: 0.4084 - val_loss: 3.3567 - val_accuracy200: 0.3558 - 21s/epoch - 48ms/step
testing model: results/XRAY/W3/deepOF_L2/h200
Evaluating performance on  test set...
1359/1359 - 31s - 31s/epoch - 23ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0773351
{'0': {'precision': 0.31358594212355273, 'recall': 0.2089737885284362, 'f1-score': 0.250808619611984, 'support': 98888}, '1': {'precision': 0.46072234241586657, 'recall': 0.7764722674573258, 'f1-score': 0.5783053353595925, 'support': 154133}, '2': {'precision': 0.310500632568227, 'recall': 0.07250780788385246, 'f1-score': 0.11756252779963733, 'support': 94776}, 'accuracy': 0.42328427214725833, 'macro avg': {'precision': 0.3616029723692155, 'recall': 0.35265128795653816, 'f1-score': 0.3155588275904046, 'support': 347797}, 'weighted avg': {'precision': 0.3779515389741284, 'recall': 0.42328427214725833, 'f1-score': 0.3596350893363323, 'support': 347797}}
[[ 20665  71782   6441]
 [ 25634 119680   8819]
 [ 19600  68304   6872]]
Evaluating performance on  train set...
444/444 - 10s - 10s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0991403
{'0': {'precision': 0.3764993419815755, 'recall': 0.2689642204792092, 'f1-score': 0.31377403130532877, 'support': 37228}, '1': {'precision': 0.35722589134017196, 'recall': 0.7434861214506009, 'f1-score': 0.482583072316706, 'support': 37612}, '2': {'precision': 0.402089072543618, 'recall': 0.09040466604727986, 'f1-score': 0.14761904761904762, 'support': 38748}, 'accuracy': 0.3651794203613058, 'macro avg': {'precision': 0.37860476862178843, 'recall': 0.3676183359923633, 'f1-score': 0.3146587170803608, 'support': 113588}, 'weighted avg': {'precision': 0.378846754157981, 'recall': 0.3651794203613058, 'f1-score': 0.3129911347198083, 'support': 113588}}
[[10013 24390  2825]
 [ 7264 27964  2384]
 [ 9318 25927  3503]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1035635
{'0': {'precision': 0.3845732292094807, 'recall': 0.2262979683972912, 'f1-score': 0.2849312287468913, 'support': 12404}, '1': {'precision': 0.3515538495607884, 'recall': 0.781955504474181, 'f1-score': 0.4850413749204328, 'support': 12181}, '2': {'precision': 0.3903957314361939, 'recall': 0.07282076801857842, 'f1-score': 0.12274570110443173, 'support': 12057}, 'accuracy': 0.36051525571748266, 'macro avg': {'precision': 0.37550760340215433, 'recall': 0.36035808029668354, 'f1-score': 0.29757276825725193, 'support': 36642}, 'weighted avg': {'precision': 0.3755123931701477, 'recall': 0.36051525571748266, 'f1-score': 0.2980874643168595, 'support': 36642}}
[[2807 8869  728]
 [2013 9525  643]
 [2479 8700  878]]
training model: results/XRAY/W3/deepOF_L2/h300
Epoch 1/50
444/444 - 27s - loss: 3.3328 - accuracy300: 0.3447 - val_loss: 3.3411 - val_accuracy300: 0.3346 - 27s/epoch - 61ms/step
Epoch 2/50
444/444 - 21s - loss: 3.3066 - accuracy300: 0.3562 - val_loss: 3.3286 - val_accuracy300: 0.3340 - 21s/epoch - 46ms/step
Epoch 3/50
444/444 - 23s - loss: 3.2911 - accuracy300: 0.3643 - val_loss: 3.3268 - val_accuracy300: 0.3336 - 23s/epoch - 52ms/step
Epoch 4/50
444/444 - 22s - loss: 3.2812 - accuracy300: 0.3705 - val_loss: 3.3338 - val_accuracy300: 0.3340 - 22s/epoch - 51ms/step
Epoch 5/50
444/444 - 21s - loss: 3.2732 - accuracy300: 0.3760 - val_loss: 3.3340 - val_accuracy300: 0.3355 - 21s/epoch - 48ms/step
Epoch 6/50
444/444 - 22s - loss: 3.2670 - accuracy300: 0.3779 - val_loss: 3.3368 - val_accuracy300: 0.3362 - 22s/epoch - 50ms/step
Epoch 7/50
444/444 - 21s - loss: 3.2593 - accuracy300: 0.3851 - val_loss: 3.3488 - val_accuracy300: 0.3345 - 21s/epoch - 47ms/step
Epoch 8/50
444/444 - 20s - loss: 3.2554 - accuracy300: 0.3867 - val_loss: 3.3500 - val_accuracy300: 0.3345 - 20s/epoch - 45ms/step
Epoch 9/50
444/444 - 22s - loss: 3.2500 - accuracy300: 0.3899 - val_loss: 3.3564 - val_accuracy300: 0.3328 - 22s/epoch - 49ms/step
Epoch 10/50
444/444 - 23s - loss: 3.2452 - accuracy300: 0.3932 - val_loss: 3.3561 - val_accuracy300: 0.3339 - 23s/epoch - 52ms/step
Epoch 11/50
444/444 - 21s - loss: 3.2421 - accuracy300: 0.3949 - val_loss: 3.3574 - val_accuracy300: 0.3337 - 21s/epoch - 47ms/step
Epoch 12/50
444/444 - 22s - loss: 3.2363 - accuracy300: 0.3987 - val_loss: 3.3629 - val_accuracy300: 0.3340 - 22s/epoch - 50ms/step
Epoch 13/50
444/444 - 24s - loss: 3.2347 - accuracy300: 0.3998 - val_loss: 3.3694 - val_accuracy300: 0.3332 - 24s/epoch - 54ms/step
testing model: results/XRAY/W3/deepOF_L2/h300
Evaluating performance on  test set...
1359/1359 - 29s - 29s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0842894
{'0': {'precision': 0.31550484844375126, 'recall': 0.18246078431372548, 'f1-score': 0.23120977961090264, 'support': 102000}, '1': {'precision': 0.4364830726325173, 'recall': 0.8014016787547877, 'f1-score': 0.5651548203719712, 'support': 147252}, '2': {'precision': 0.3217692974848222, 'recall': 0.0602364402049825, 'f1-score': 0.1014761566931355, 'support': 98545}, 'accuracy': 0.4098799012067384, 'macro avg': {'precision': 0.3579190728536969, 'recall': 0.34803296775783193, 'f1-score': 0.29928025222533644, 'support': 347797}, 'weighted avg': {'precision': 0.36850017502505156, 'recall': 0.4098799012067384, 'f1-score': 0.3358382705746473, 'support': 347797}}
[[ 18611  78007   5382]
 [ 22114 118008   7130]
 [ 18263  74346   5936]]
Evaluating performance on  train set...
444/444 - 10s - 10s/epoch - 23ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1006565
{'0': {'precision': 0.37264480111653875, 'recall': 0.24307173266929072, 'f1-score': 0.2942244117456408, 'support': 37347}, '1': {'precision': 0.3456114502210061, 'recall': 0.752216443450376, 'f1-score': 0.4736163425973056, 'support': 37109}, '2': {'precision': 0.4067375886524823, 'recall': 0.08793314934069305, 'f1-score': 0.14460413514876452, 'support': 39132}, 'accuracy': 0.3559618973835264, 'macro avg': {'precision': 0.37499794666334235, 'recall': 0.36107377515345324, 'f1-score': 0.304148296497237, 'support': 113588}, 'weighted avg': {'precision': 0.3755582985236084, 'recall': 0.3559618973835264, 'f1-score': 0.3012860247521685, 'support': 113588}}
[[ 9078 25603  2666]
 [ 6842 27914  2353]
 [ 8441 27250  3441]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1109294
{'0': {'precision': 0.3785859171254709, 'recall': 0.20331465919701214, 'f1-score': 0.26455401437683507, 'support': 12852}, '1': {'precision': 0.32310042556287055, 'recall': 0.783126157101296, 'f1-score': 0.45746214852198985, 'support': 11343}, '2': {'precision': 0.3658210947930574, 'recall': 0.06604000964087732, 'f1-score': 0.11188240097999183, 'support': 12447}, 'accuracy': 0.336171606353365, 'macro avg': {'precision': 0.35583581249379964, 'recall': 0.35082694197972847, 'f1-score': 0.27796618795960554, 'support': 36642}, 'weighted avg': {'precision': 0.357073563150084, 'recall': 0.336171606353365, 'f1-score': 0.27240984630898896, 'support': 36642}}
[[2613 9407  832]
 [1867 8883  593]
 [2422 9203  822]]
training model: results/XRAY/W3/deepOF_L2/h500
Epoch 1/50
444/444 - 27s - loss: 3.3361 - accuracy500: 0.3464 - val_loss: 3.3575 - val_accuracy500: 0.3299 - 27s/epoch - 61ms/step
Epoch 2/50
444/444 - 22s - loss: 3.3148 - accuracy500: 0.3518 - val_loss: 3.3300 - val_accuracy500: 0.3317 - 22s/epoch - 50ms/step
Epoch 3/50
444/444 - 22s - loss: 3.2995 - accuracy500: 0.3589 - val_loss: 3.3251 - val_accuracy500: 0.3360 - 22s/epoch - 50ms/step
Epoch 4/50
444/444 - 20s - loss: 3.2899 - accuracy500: 0.3650 - val_loss: 3.3265 - val_accuracy500: 0.3382 - 20s/epoch - 45ms/step
Epoch 5/50
444/444 - 22s - loss: 3.2824 - accuracy500: 0.3682 - val_loss: 3.3274 - val_accuracy500: 0.3379 - 22s/epoch - 50ms/step
Epoch 6/50
444/444 - 24s - loss: 3.2773 - accuracy500: 0.3737 - val_loss: 3.3281 - val_accuracy500: 0.3370 - 24s/epoch - 53ms/step
Epoch 7/50
444/444 - 23s - loss: 3.2719 - accuracy500: 0.3762 - val_loss: 3.3309 - val_accuracy500: 0.3397 - 23s/epoch - 53ms/step
Epoch 8/50
444/444 - 24s - loss: 3.2654 - accuracy500: 0.3812 - val_loss: 3.3370 - val_accuracy500: 0.3375 - 24s/epoch - 54ms/step
Epoch 9/50
444/444 - 23s - loss: 3.2606 - accuracy500: 0.3830 - val_loss: 3.3506 - val_accuracy500: 0.3328 - 23s/epoch - 52ms/step
Epoch 10/50
444/444 - 25s - loss: 3.2561 - accuracy500: 0.3857 - val_loss: 3.3456 - val_accuracy500: 0.3353 - 25s/epoch - 56ms/step
Epoch 11/50
444/444 - 25s - loss: 3.2534 - accuracy500: 0.3889 - val_loss: 3.3499 - val_accuracy500: 0.3349 - 25s/epoch - 57ms/step
Epoch 12/50
444/444 - 21s - loss: 3.2502 - accuracy500: 0.3928 - val_loss: 3.3488 - val_accuracy500: 0.3331 - 21s/epoch - 47ms/step
Epoch 13/50
444/444 - 20s - loss: 3.2450 - accuracy500: 0.3943 - val_loss: 3.3502 - val_accuracy500: 0.3346 - 20s/epoch - 46ms/step
testing model: results/XRAY/W3/deepOF_L2/h500
Evaluating performance on  test set...
1359/1359 - 28s - 28s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0845485
{'0': {'precision': 0.3076624425394459, 'recall': 0.19981038638816326, 'f1-score': 0.242275637301961, 'support': 99149}, '1': {'precision': 0.4459427314085219, 'recall': 0.798790961505173, 'f1-score': 0.5723553965414431, 'support': 150202}, '2': {'precision': 0.30918715609110536, 'recall': 0.04509070962761311, 'f1-score': 0.07870358057853072, 'support': 98446}, 'accuracy': 0.4146959289470582, 'macro avg': {'precision': 0.35426411001302444, 'recall': 0.3478973525069831, 'f1-score': 0.2977782048073116, 'support': 347797}, 'weighted avg': {'precision': 0.36781269656412013, 'recall': 0.4146959289470582, 'f1-score': 0.3385261089883006, 'support': 347797}}
[[ 19811  75184   4154]
 [ 24458 119980   5764]
 [ 20123  73884   4439]]
Evaluating performance on  train set...
444/444 - 10s - 10s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1032474
{'0': {'precision': 0.36315541178056343, 'recall': 0.28830154356491267, 'f1-score': 0.32142803883263493, 'support': 37381}, '1': {'precision': 0.34809245335561123, 'recall': 0.7339596455642148, 'f1-score': 0.4722246071949858, 'support': 37468}, '2': {'precision': 0.38818737270875764, 'recall': 0.04920106352771109, 'f1-score': 0.08733304313959084, 'support': 38739}, 'accuracy': 0.35376096066485896, 'macro avg': {'precision': 0.36647841261497743, 'recall': 0.3571540842189462, 'f1-score': 0.29366189638907053, 'support': 113588}, 'weighted avg': {'precision': 0.3667238715485953, 'recall': 0.35376096066485896, 'f1-score': 0.2913319000261389, 'support': 113588}}
[[10777 25036  1568]
 [ 8532 27500  1436]
 [10367 26466  1906]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 26ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1105634
{'0': {'precision': 0.3679090334807328, 'recall': 0.2266147859922179, 'f1-score': 0.2804719479894052, 'support': 12850}, '1': {'precision': 0.3231858665498613, 'recall': 0.7772120786516854, 'f1-score': 0.4565329483345365, 'support': 11392}, '2': {'precision': 0.37415477084898574, 'recall': 0.040161290322580645, 'f1-score': 0.07253659602359624, 'support': 12400}, 'accuracy': 0.334697887669887, 'macro avg': {'precision': 0.35508322362652667, 'recall': 0.3479960516554946, 'f1-score': 0.26984716411584597, 'support': 36642}, 'weighted avg': {'precision': 0.356118214903413, 'recall': 0.334697887669887, 'f1-score': 0.26484203017803315, 'support': 36642}}
[[2912 9445  493]
 [2198 8854  340]
 [2805 9097  498]]
training model: results/XRAY/W3/deepOF_L2/h1000
Epoch 1/50
444/444 - 34s - loss: 3.3448 - accuracy1000: 0.3422 - val_loss: 3.3448 - val_accuracy1000: 0.3398 - 34s/epoch - 75ms/step
Epoch 2/50
444/444 - 21s - loss: 3.3195 - accuracy1000: 0.3496 - val_loss: 3.3275 - val_accuracy1000: 0.3480 - 21s/epoch - 47ms/step
Epoch 3/50
444/444 - 22s - loss: 3.3026 - accuracy1000: 0.3593 - val_loss: 3.3214 - val_accuracy1000: 0.3486 - 22s/epoch - 50ms/step
Epoch 4/50
444/444 - 24s - loss: 3.2921 - accuracy1000: 0.3654 - val_loss: 3.3272 - val_accuracy1000: 0.3458 - 24s/epoch - 54ms/step
Epoch 5/50
444/444 - 24s - loss: 3.2819 - accuracy1000: 0.3718 - val_loss: 3.3308 - val_accuracy1000: 0.3470 - 24s/epoch - 53ms/step
Epoch 6/50
444/444 - 24s - loss: 3.2762 - accuracy1000: 0.3755 - val_loss: 3.3318 - val_accuracy1000: 0.3462 - 24s/epoch - 55ms/step
Epoch 7/50
444/444 - 22s - loss: 3.2700 - accuracy1000: 0.3806 - val_loss: 3.3410 - val_accuracy1000: 0.3452 - 22s/epoch - 50ms/step
Epoch 8/50
444/444 - 24s - loss: 3.2635 - accuracy1000: 0.3839 - val_loss: 3.3433 - val_accuracy1000: 0.3458 - 24s/epoch - 54ms/step
Epoch 9/50
444/444 - 28s - loss: 3.2591 - accuracy1000: 0.3864 - val_loss: 3.3398 - val_accuracy1000: 0.3471 - 28s/epoch - 63ms/step
Epoch 10/50
444/444 - 23s - loss: 3.2555 - accuracy1000: 0.3886 - val_loss: 3.3461 - val_accuracy1000: 0.3468 - 23s/epoch - 51ms/step
Epoch 11/50
444/444 - 22s - loss: 3.2500 - accuracy1000: 0.3926 - val_loss: 3.3423 - val_accuracy1000: 0.3471 - 22s/epoch - 49ms/step
Epoch 12/50
444/444 - 24s - loss: 3.2467 - accuracy1000: 0.3940 - val_loss: 3.3441 - val_accuracy1000: 0.3470 - 24s/epoch - 54ms/step
Epoch 13/50
444/444 - 21s - loss: 3.2428 - accuracy1000: 0.3952 - val_loss: 3.3538 - val_accuracy1000: 0.3450 - 21s/epoch - 47ms/step
testing model: results/XRAY/W3/deepOF_L2/h1000
Evaluating performance on  test set...
1359/1359 - 24s - 24s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0695134
{'0': {'precision': 0.3005585774568871, 'recall': 0.12932002560792585, 'f1-score': 0.1808335779277957, 'support': 95283}, '1': {'precision': 0.48044194532186035, 'recall': 0.8663335952076991, 'f1-score': 0.6181029952706254, 'support': 162928}, '2': {'precision': 0.29566420664206644, 'recall': 0.04293081508271382, 'f1-score': 0.07497514474530674, 'support': 89586}, 'accuracy': 0.4523270758517181, 'macro avg': {'precision': 0.3588882431402713, 'recall': 0.34619481196611296, 'f1-score': 0.2913039059812426, 'support': 347797}, 'weighted avg': {'precision': 0.38356553339868027, 'recall': 0.4523270758517181, 'f1-score': 0.3584084219711489, 'support': 347797}}
[[ 12322  79225   3736]
 [ 16352 141150   5426]
 [ 12323  73417   3846]]
Evaluating performance on  train set...
444/444 - 14s - 14s/epoch - 31ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1068164
{'0': {'precision': 0.36342155009451793, 'recall': 0.20800086554326364, 'f1-score': 0.2645748395864512, 'support': 36971}, '1': {'precision': 0.34856411779488705, 'recall': 0.8079112499669041, 'f1-score': 0.4870123133643495, 'support': 37769}, '2': {'precision': 0.381498158002456, 'recall': 0.04798187808896211, 'f1-score': 0.08524260300910048, 'support': 38848}, 'accuracy': 0.35274852977427196, 'macro avg': {'precision': 0.3644946086306204, 'recall': 0.35463133119970996, 'f1-score': 0.2789432519866337, 'support': 113588}, 'weighted avg': {'precision': 0.3646636681306029, 'recall': 0.35274852977427196, 'f1-score': 0.2772041861772928, 'support': 113588}}
[[ 7690 27672  1609]
 [ 5842 30514  1413]
 [ 7628 29356  1864]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 30ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1076185
{'0': {'precision': 0.35556770548569344, 'recall': 0.15688324220006433, 'f1-score': 0.21770908888020982, 'support': 12436}, '1': {'precision': 0.3479048545643641, 'recall': 0.8426098968066954, 'f1-score': 0.4924728118915325, 'support': 12307}, '2': {'precision': 0.35311572700296734, 'recall': 0.04000336162702748, 'f1-score': 0.07186532799879218, 'support': 11899}, 'accuracy': 0.34924403689754924, 'macro avg': {'precision': 0.3521960956843417, 'recall': 0.34649883354459576, 'f1-score': 0.2606824095901782, 'support': 36642}, 'weighted avg': {'precision': 0.35219772572872715, 'recall': 0.34924403689754924, 'f1-score': 0.26263355338466804, 'support': 36642}}
[[ 1951 10019   466]
 [ 1531 10370   406]
 [ 2005  9418   476]]
training model: results/XRAY/W3/deepVOL_L2/h10
Epoch 1/50
444/444 - 32s - loss: 3.3008 - accuracy10: 0.3753 - val_loss: 3.2792 - val_accuracy10: 0.3932 - 32s/epoch - 73ms/step
Epoch 2/50
444/444 - 25s - loss: 3.2304 - accuracy10: 0.4052 - val_loss: 3.1871 - val_accuracy10: 0.4310 - 25s/epoch - 56ms/step
Epoch 3/50
444/444 - 28s - loss: 3.1872 - accuracy10: 0.4264 - val_loss: 3.1630 - val_accuracy10: 0.4393 - 28s/epoch - 63ms/step
Epoch 4/50
444/444 - 26s - loss: 3.1593 - accuracy10: 0.4381 - val_loss: 3.1625 - val_accuracy10: 0.4421 - 26s/epoch - 58ms/step
Epoch 5/50
444/444 - 27s - loss: 3.1402 - accuracy10: 0.4501 - val_loss: 3.1424 - val_accuracy10: 0.4512 - 27s/epoch - 61ms/step
Epoch 6/50
444/444 - 26s - loss: 3.1238 - accuracy10: 0.4550 - val_loss: 3.1124 - val_accuracy10: 0.4596 - 26s/epoch - 58ms/step
Epoch 7/50
444/444 - 24s - loss: 3.1120 - accuracy10: 0.4620 - val_loss: 3.1245 - val_accuracy10: 0.4583 - 24s/epoch - 53ms/step
Epoch 8/50
444/444 - 24s - loss: 3.0994 - accuracy10: 0.4651 - val_loss: 3.1075 - val_accuracy10: 0.4633 - 24s/epoch - 55ms/step
Epoch 9/50
444/444 - 25s - loss: 3.0890 - accuracy10: 0.4699 - val_loss: 3.1075 - val_accuracy10: 0.4651 - 25s/epoch - 57ms/step
Epoch 10/50
444/444 - 22s - loss: 3.0774 - accuracy10: 0.4726 - val_loss: 3.1104 - val_accuracy10: 0.4646 - 22s/epoch - 50ms/step
Epoch 11/50
444/444 - 23s - loss: 3.0706 - accuracy10: 0.4767 - val_loss: 3.1060 - val_accuracy10: 0.4682 - 23s/epoch - 53ms/step
Epoch 12/50
444/444 - 27s - loss: 3.0617 - accuracy10: 0.4801 - val_loss: 3.0932 - val_accuracy10: 0.4710 - 27s/epoch - 62ms/step
Epoch 13/50
444/444 - 23s - loss: 3.0536 - accuracy10: 0.4815 - val_loss: 3.0836 - val_accuracy10: 0.4719 - 23s/epoch - 52ms/step
Epoch 14/50
444/444 - 23s - loss: 3.0477 - accuracy10: 0.4852 - val_loss: 3.0800 - val_accuracy10: 0.4727 - 23s/epoch - 51ms/step
Epoch 15/50
444/444 - 25s - loss: 3.0413 - accuracy10: 0.4875 - val_loss: 3.0717 - val_accuracy10: 0.4745 - 25s/epoch - 55ms/step
Epoch 16/50
444/444 - 22s - loss: 3.0376 - accuracy10: 0.4881 - val_loss: 3.0650 - val_accuracy10: 0.4766 - 22s/epoch - 50ms/step
Epoch 17/50
444/444 - 22s - loss: 3.0300 - accuracy10: 0.4906 - val_loss: 3.0691 - val_accuracy10: 0.4770 - 22s/epoch - 49ms/step
Epoch 18/50
444/444 - 25s - loss: 3.0217 - accuracy10: 0.4928 - val_loss: 3.0614 - val_accuracy10: 0.4774 - 25s/epoch - 56ms/step
Epoch 19/50
444/444 - 21s - loss: 3.0163 - accuracy10: 0.4964 - val_loss: 3.0672 - val_accuracy10: 0.4774 - 21s/epoch - 48ms/step
Epoch 20/50
444/444 - 22s - loss: 3.0104 - accuracy10: 0.4966 - val_loss: 3.0605 - val_accuracy10: 0.4795 - 22s/epoch - 50ms/step
Epoch 21/50
444/444 - 23s - loss: 3.0042 - accuracy10: 0.4984 - val_loss: 3.0638 - val_accuracy10: 0.4795 - 23s/epoch - 52ms/step
Epoch 22/50
444/444 - 27s - loss: 2.9974 - accuracy10: 0.5014 - val_loss: 3.0620 - val_accuracy10: 0.4772 - 27s/epoch - 60ms/step
Epoch 23/50
444/444 - 25s - loss: 2.9954 - accuracy10: 0.5010 - val_loss: 3.0708 - val_accuracy10: 0.4756 - 25s/epoch - 55ms/step
Epoch 24/50
444/444 - 22s - loss: 2.9887 - accuracy10: 0.5029 - val_loss: 3.0616 - val_accuracy10: 0.4793 - 22s/epoch - 49ms/step
Epoch 25/50
444/444 - 20s - loss: 2.9819 - accuracy10: 0.5048 - val_loss: 3.0644 - val_accuracy10: 0.4808 - 20s/epoch - 46ms/step
Epoch 26/50
444/444 - 21s - loss: 2.9792 - accuracy10: 0.5049 - val_loss: 3.0691 - val_accuracy10: 0.4793 - 21s/epoch - 48ms/step
Epoch 27/50
444/444 - 21s - loss: 2.9738 - accuracy10: 0.5061 - val_loss: 3.0656 - val_accuracy10: 0.4796 - 21s/epoch - 48ms/step
Epoch 28/50
444/444 - 21s - loss: 2.9700 - accuracy10: 0.5093 - val_loss: 3.0784 - val_accuracy10: 0.4767 - 21s/epoch - 46ms/step
Epoch 29/50
444/444 - 24s - loss: 2.9644 - accuracy10: 0.5107 - val_loss: 3.0678 - val_accuracy10: 0.4786 - 24s/epoch - 55ms/step
Epoch 30/50
444/444 - 22s - loss: 2.9588 - accuracy10: 0.5113 - val_loss: 3.0846 - val_accuracy10: 0.4777 - 22s/epoch - 50ms/step
testing model: results/XRAY/W3/deepVOL_L2/h10
Evaluating performance on  test set...
1359/1359 - 33s - 33s/epoch - 24ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0144515
{'0': {'precision': 0.47288002627161935, 'recall': 0.4710709255304648, 'f1-score': 0.47197374231229716, 'support': 110045}, '1': {'precision': 0.5271158687098272, 'recall': 0.49460705249237497, 'f1-score': 0.5103442836297669, 'support': 130819}, '2': {'precision': 0.4596364770502313, 'recall': 0.496123886026352, 'f1-score': 0.4771837041234378, 'support': 106937}, 'accuracy': 0.48762654506456277, 'macro avg': {'precision': 0.48654412401055924, 'recall': 0.48726728801639724, 'f1-score': 0.4865005766885006, 'support': 347801}, 'weighted avg': {'precision': 0.4892079070104221, 'recall': 0.48762654506456277, 'f1-score': 0.48800800768476027, 'support': 347801}}
[[51839 30505 27701]
 [31444 64704 34671]
 [26341 27542 53054]]
Evaluating performance on  train set...
444/444 - 12s - 12s/epoch - 27ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.022669
{'0': {'precision': 0.4706044368771596, 'recall': 0.5007726739848662, 'f1-score': 0.48522008519426874, 'support': 37532}, '1': {'precision': 0.524480866726856, 'recall': 0.39498940871884725, 'f1-score': 0.4506168235452064, 'support': 38239}, '2': {'precision': 0.4627784094709384, 'recall': 0.5488656195462478, 'f1-score': 0.5021591610117211, 'support': 37818}, 'accuracy': 0.48117335305355274, 'macro avg': {'precision': 0.4859545710249846, 'recall': 0.4815425674166538, 'f1-score': 0.47933202325039875, 'support': 113589}, 'weighted avg': {'precision': 0.48613601208755913, 'recall': 0.48117335305355274, 'f1-score': 0.4792107695656948, 'support': 113589}}
[[18795  7256 11481]
 [10520 15104 12615]
 [10623  6438 20757]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 24ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0207362
{'0': {'precision': 0.4690514812601383, 'recall': 0.4667006455997282, 'f1-score': 0.4678731104960613, 'support': 11772}, '1': {'precision': 0.5364109232769831, 'recall': 0.43634302984510764, 'f1-score': 0.4812299487521354, 'support': 13235}, '2': {'precision': 0.44234978465014474, 'recall': 0.5384615384615384, 'f1-score': 0.4856965656252422, 'support': 11635}, 'accuracy': 0.47852191474264505, 'macro avg': {'precision': 0.48260406306242204, 'recall': 0.4805017379687914, 'f1-score': 0.47826654162447957, 'support': 36642}, 'weighted avg': {'precision': 0.4849029079026705, 'recall': 0.47852191474264505, 'f1-score': 0.478357081205825, 'support': 36642}}
[[5494 2637 3641]
 [3203 5775 4257]
 [3016 2354 6265]]
training model: results/XRAY/W3/deepVOL_L2/h20
Epoch 1/50
444/444 - 36s - loss: 3.3162 - accuracy20: 0.3646 - val_loss: 3.3157 - val_accuracy20: 0.3683 - 36s/epoch - 80ms/step
Epoch 2/50
444/444 - 27s - loss: 3.2602 - accuracy20: 0.3892 - val_loss: 3.2661 - val_accuracy20: 0.3945 - 27s/epoch - 62ms/step
Epoch 3/50
444/444 - 29s - loss: 3.2362 - accuracy20: 0.4045 - val_loss: 3.2410 - val_accuracy20: 0.3987 - 29s/epoch - 64ms/step
Epoch 4/50
444/444 - 23s - loss: 3.2246 - accuracy20: 0.4105 - val_loss: 3.2430 - val_accuracy20: 0.3973 - 23s/epoch - 51ms/step
Epoch 5/50
444/444 - 21s - loss: 3.2084 - accuracy20: 0.4178 - val_loss: 3.2291 - val_accuracy20: 0.4069 - 21s/epoch - 48ms/step
Epoch 6/50
444/444 - 22s - loss: 3.1976 - accuracy20: 0.4257 - val_loss: 3.2280 - val_accuracy20: 0.4085 - 22s/epoch - 50ms/step
Epoch 7/50
444/444 - 21s - loss: 3.1901 - accuracy20: 0.4289 - val_loss: 3.1959 - val_accuracy20: 0.4224 - 21s/epoch - 48ms/step
Epoch 8/50
444/444 - 21s - loss: 3.1873 - accuracy20: 0.4284 - val_loss: 3.1921 - val_accuracy20: 0.4266 - 21s/epoch - 47ms/step
Epoch 9/50
444/444 - 23s - loss: 3.1823 - accuracy20: 0.4318 - val_loss: 3.1873 - val_accuracy20: 0.4301 - 23s/epoch - 51ms/step
Epoch 10/50
444/444 - 24s - loss: 3.1754 - accuracy20: 0.4344 - val_loss: 3.1898 - val_accuracy20: 0.4310 - 24s/epoch - 54ms/step
Epoch 11/50
444/444 - 22s - loss: 3.1714 - accuracy20: 0.4366 - val_loss: 3.1830 - val_accuracy20: 0.4329 - 22s/epoch - 51ms/step
Epoch 12/50
444/444 - 22s - loss: 3.1662 - accuracy20: 0.4395 - val_loss: 3.1810 - val_accuracy20: 0.4367 - 22s/epoch - 49ms/step
Epoch 13/50
444/444 - 25s - loss: 3.1624 - accuracy20: 0.4399 - val_loss: 3.1806 - val_accuracy20: 0.4341 - 25s/epoch - 56ms/step
Epoch 14/50
444/444 - 20s - loss: 3.1578 - accuracy20: 0.4426 - val_loss: 3.1835 - val_accuracy20: 0.4359 - 20s/epoch - 46ms/step
Epoch 15/50
444/444 - 22s - loss: 3.1520 - accuracy20: 0.4444 - val_loss: 3.1863 - val_accuracy20: 0.4364 - 22s/epoch - 50ms/step
Epoch 16/50
444/444 - 23s - loss: 3.1481 - accuracy20: 0.4471 - val_loss: 3.1857 - val_accuracy20: 0.4373 - 23s/epoch - 52ms/step
Epoch 17/50
444/444 - 22s - loss: 3.1425 - accuracy20: 0.4489 - val_loss: 3.1849 - val_accuracy20: 0.4367 - 22s/epoch - 49ms/step
Epoch 18/50
444/444 - 21s - loss: 3.1390 - accuracy20: 0.4503 - val_loss: 3.1815 - val_accuracy20: 0.4383 - 21s/epoch - 48ms/step
Epoch 19/50
444/444 - 29s - loss: 3.1342 - accuracy20: 0.4525 - val_loss: 3.1810 - val_accuracy20: 0.4399 - 29s/epoch - 64ms/step
Epoch 20/50
444/444 - 26s - loss: 3.1311 - accuracy20: 0.4539 - val_loss: 3.1848 - val_accuracy20: 0.4389 - 26s/epoch - 59ms/step
Epoch 21/50
444/444 - 21s - loss: 3.1256 - accuracy20: 0.4569 - val_loss: 3.1833 - val_accuracy20: 0.4397 - 21s/epoch - 48ms/step
Epoch 22/50
444/444 - 22s - loss: 3.1217 - accuracy20: 0.4576 - val_loss: 3.1899 - val_accuracy20: 0.4373 - 22s/epoch - 50ms/step
Epoch 23/50
444/444 - 22s - loss: 3.1188 - accuracy20: 0.4592 - val_loss: 3.1852 - val_accuracy20: 0.4391 - 22s/epoch - 50ms/step
testing model: results/XRAY/W3/deepVOL_L2/h20
Evaluating performance on  test set...
1359/1359 - 30s - 30s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0541857
{'0': {'precision': 0.43518234753294516, 'recall': 0.41660369306816264, 'f1-score': 0.4256904069767442, 'support': 112481}, '1': {'precision': 0.45081313582872196, 'recall': 0.4497300077140653, 'f1-score': 0.4502709204053146, 'support': 124448}, '2': {'precision': 0.4347994791891216, 'recall': 0.4548037376434086, 'f1-score': 0.44457669333685995, 'support': 110872}, 'accuracy': 0.44063415573848264, 'macro avg': {'precision': 0.44026498751692955, 'recall': 0.44037914614187884, 'f1-score': 0.4401793402396396, 'support': 347801}, 'weighted avg': {'precision': 0.44065320863689955, 'recall': 0.44063415573848264, 'f1-score': 0.4405062242874405, 'support': 347801}}
[[46860 36312 29309]
 [32241 55968 36239]
 [28578 31869 50425]]
Evaluating performance on  train set...
444/444 - 15s - 15s/epoch - 33ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0637665
{'0': {'precision': 0.43466484190117755, 'recall': 0.40550605133661394, 'f1-score': 0.419579457257665, 'support': 37595}, '1': {'precision': 0.4361442730928782, 'recall': 0.36357636872393223, 'f1-score': 0.39656785822259977, 'support': 37882}, '2': {'precision': 0.42603915887253124, 'recall': 0.5246903862300588, 'f1-score': 0.4702465637456055, 'support': 38112}, 'accuracy': 0.4315118541408059, 'macro avg': {'precision': 0.432282757955529, 'recall': 0.43125760209686836, 'f1-score': 0.4287979597419567, 'support': 113589}, 'weighted avg': {'precision': 0.4322640969418614, 'recall': 0.4315118541408059, 'f1-score': 0.42890517865517747, 'support': 113589}}
[[15245  9397 12953]
 [10122 13773 13987]
 [ 9706  8409 19997]]
Evaluating performance on  val set...
144/144 - 5s - 5s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0600455
{'0': {'precision': 0.4430036771821173, 'recall': 0.37960199004975126, 'f1-score': 0.4088595159417701, 'support': 12060}, '1': {'precision': 0.4491089787525703, 'recall': 0.41885737115461447, 'f1-score': 0.4334559887542895, 'support': 12515}, '2': {'precision': 0.42245148947799943, 'recall': 0.5123891605204276, 'f1-score': 0.46309403437815977, 'support': 12067}, 'accuracy': 0.4367392609573713, 'macro avg': {'precision': 0.4381880484708957, 'recall': 0.4369495072415978, 'f1-score': 0.43513651302473977, 'support': 36642}, 'weighted avg': {'precision': 0.43832065224157446, 'recall': 0.4367392609573713, 'f1-score': 0.4351209861459237, 'support': 36642}}
[[4578 3389 4093]
 [2913 5242 4360]
 [2843 3041 6183]]
training model: results/XRAY/W3/deepVOL_L2/h30
Epoch 1/50
444/444 - 23s - loss: 3.3288 - accuracy30: 0.3550 - val_loss: 3.3118 - val_accuracy30: 0.3510 - 23s/epoch - 51ms/step
Epoch 2/50
444/444 - 19s - loss: 3.2813 - accuracy30: 0.3722 - val_loss: 3.2718 - val_accuracy30: 0.3805 - 19s/epoch - 43ms/step
Epoch 3/50
444/444 - 22s - loss: 3.2596 - accuracy30: 0.3815 - val_loss: 3.2639 - val_accuracy30: 0.3887 - 22s/epoch - 50ms/step
Epoch 4/50
444/444 - 22s - loss: 3.2472 - accuracy30: 0.3931 - val_loss: 3.2504 - val_accuracy30: 0.3936 - 22s/epoch - 49ms/step
Epoch 5/50
444/444 - 20s - loss: 3.2352 - accuracy30: 0.4001 - val_loss: 3.2549 - val_accuracy30: 0.3917 - 20s/epoch - 45ms/step
Epoch 6/50
444/444 - 20s - loss: 3.2301 - accuracy30: 0.4035 - val_loss: 3.2616 - val_accuracy30: 0.3931 - 20s/epoch - 46ms/step
Epoch 7/50
444/444 - 22s - loss: 3.2249 - accuracy30: 0.4069 - val_loss: 3.2458 - val_accuracy30: 0.3965 - 22s/epoch - 50ms/step
Epoch 8/50
444/444 - 26s - loss: 3.2197 - accuracy30: 0.4120 - val_loss: 3.2493 - val_accuracy30: 0.3981 - 26s/epoch - 60ms/step
Epoch 9/50
444/444 - 22s - loss: 3.2146 - accuracy30: 0.4114 - val_loss: 3.2522 - val_accuracy30: 0.3957 - 22s/epoch - 50ms/step
Epoch 10/50
444/444 - 23s - loss: 3.2136 - accuracy30: 0.4145 - val_loss: 3.2499 - val_accuracy30: 0.3992 - 23s/epoch - 52ms/step
Epoch 11/50
444/444 - 21s - loss: 3.2064 - accuracy30: 0.4170 - val_loss: 3.2450 - val_accuracy30: 0.4003 - 21s/epoch - 48ms/step
Epoch 12/50
444/444 - 22s - loss: 3.2048 - accuracy30: 0.4193 - val_loss: 3.2413 - val_accuracy30: 0.4058 - 22s/epoch - 51ms/step
Epoch 13/50
444/444 - 23s - loss: 3.1992 - accuracy30: 0.4208 - val_loss: 3.2511 - val_accuracy30: 0.4026 - 23s/epoch - 51ms/step
Epoch 14/50
444/444 - 21s - loss: 3.1948 - accuracy30: 0.4244 - val_loss: 3.2530 - val_accuracy30: 0.4003 - 21s/epoch - 48ms/step
Epoch 15/50
444/444 - 21s - loss: 3.1930 - accuracy30: 0.4243 - val_loss: 3.2494 - val_accuracy30: 0.4032 - 21s/epoch - 48ms/step
Epoch 16/50
444/444 - 20s - loss: 3.1869 - accuracy30: 0.4276 - val_loss: 3.2566 - val_accuracy30: 0.4017 - 20s/epoch - 46ms/step
Epoch 17/50
444/444 - 23s - loss: 3.1841 - accuracy30: 0.4307 - val_loss: 3.2526 - val_accuracy30: 0.4036 - 23s/epoch - 51ms/step
Epoch 18/50
444/444 - 21s - loss: 3.1800 - accuracy30: 0.4309 - val_loss: 3.2520 - val_accuracy30: 0.4086 - 21s/epoch - 46ms/step
Epoch 19/50
444/444 - 21s - loss: 3.1760 - accuracy30: 0.4347 - val_loss: 3.2574 - val_accuracy30: 0.4068 - 21s/epoch - 48ms/step
Epoch 20/50
444/444 - 24s - loss: 3.1708 - accuracy30: 0.4349 - val_loss: 3.2606 - val_accuracy30: 0.4055 - 24s/epoch - 53ms/step
Epoch 21/50
444/444 - 22s - loss: 3.1675 - accuracy30: 0.4376 - val_loss: 3.2542 - val_accuracy30: 0.4091 - 22s/epoch - 49ms/step
Epoch 22/50
444/444 - 22s - loss: 3.1636 - accuracy30: 0.4403 - val_loss: 3.2643 - val_accuracy30: 0.4104 - 22s/epoch - 49ms/step
testing model: results/XRAY/W3/deepVOL_L2/h30
Evaluating performance on  test set...
1359/1359 - 34s - 34s/epoch - 25ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0830815
{'0': {'precision': 0.4216056556265737, 'recall': 0.22817484582190464, 'f1-score': 0.29609939127379076, 'support': 114478}, '1': {'precision': 0.38284223960934466, 'recall': 0.5696874612939185, 'f1-score': 0.45793936577999766, 'support': 121105}, '2': {'precision': 0.4115681355611303, 'recall': 0.3874244773565738, 'f1-score': 0.3991315244683342, 'support': 112218}, 'accuracy': 0.39847211480128003, 'macro avg': {'precision': 0.40533867693234954, 'recall': 0.3950955948241323, 'f1-score': 0.3843900938407076, 'support': 347801}, 'weighted avg': {'precision': 0.40486955100505034, 'recall': 0.39847211480128003, 'f1-score': 0.3856957122602153, 'support': 347801}}
[[26121 58796 29561]
 [19515 68992 32598]
 [16320 52422 43476]]
Evaluating performance on  train set...
444/444 - 10s - 10s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0768467
{'0': {'precision': 0.43042810281111155, 'recall': 0.2765151515151515, 'f1-score': 0.33671696090692044, 'support': 37488}, '1': {'precision': 0.39061992859461214, 'recall': 0.4483740486454841, 'f1-score': 0.41750916840122904, 'support': 37578}, '2': {'precision': 0.4113258000517554, 'recall': 0.495132777821042, 'f1-score': 0.44935508569409277, 'support': 38523}, 'accuracy': 0.4075130514398401, 'macro avg': {'precision': 0.41079127715249303, 'recall': 0.40667399266055915, 'f1-score': 0.40119373833408073, 'support': 113589}, 'weighted avg': {'precision': 0.41078016524755967, 'recall': 0.4075130514398401, 'f1-score': 0.4016455020015456, 'support': 113589}}
[[10366 13764 13358]
 [ 6789 16849 13940]
 [ 6928 12521 19074]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0815134
{'0': {'precision': 0.4343974124595697, 'recall': 0.2502633071376489, 'f1-score': 0.3175696514855557, 'support': 12343}, '1': {'precision': 0.3841778012964678, 'recall': 0.4838790302424394, 'f1-score': 0.42830279119501485, 'support': 12003}, '2': {'precision': 0.40664677721501424, 'recall': 0.4766590761223162, 'f1-score': 0.4388782807293422, 'support': 12296}, 'accuracy': 0.40276185797718467, 'macro avg': {'precision': 0.4084073303236839, 'recall': 0.40360047116746817, 'f1-score': 0.3949169078033042, 'support': 36642}, 'weighted avg': {'precision': 0.40863441361240616, 'recall': 0.40276185797718467, 'f1-score': 0.3945507327888208, 'support': 36642}}
[[3089 4964 4290]
 [1933 5808 4262]
 [2089 4346 5861]]
training model: results/XRAY/W3/deepVOL_L2/h50
Epoch 1/50
444/444 - 33s - loss: 3.3300 - accuracy50: 0.3602 - val_loss: 3.3182 - val_accuracy50: 0.3434 - 33s/epoch - 73ms/step
Epoch 2/50
444/444 - 20s - loss: 3.2963 - accuracy50: 0.3616 - val_loss: 3.3062 - val_accuracy50: 0.3489 - 20s/epoch - 46ms/step
Epoch 3/50
444/444 - 20s - loss: 3.2786 - accuracy50: 0.3710 - val_loss: 3.2908 - val_accuracy50: 0.3615 - 20s/epoch - 44ms/step
Epoch 4/50
444/444 - 19s - loss: 3.2744 - accuracy50: 0.3715 - val_loss: 3.3016 - val_accuracy50: 0.3572 - 19s/epoch - 42ms/step
Epoch 5/50
444/444 - 21s - loss: 3.2668 - accuracy50: 0.3772 - val_loss: 3.2935 - val_accuracy50: 0.3721 - 21s/epoch - 46ms/step
Epoch 6/50
444/444 - 25s - loss: 3.2611 - accuracy50: 0.3816 - val_loss: 3.2882 - val_accuracy50: 0.3738 - 25s/epoch - 56ms/step
Epoch 7/50
444/444 - 22s - loss: 3.2592 - accuracy50: 0.3823 - val_loss: 3.2949 - val_accuracy50: 0.3685 - 22s/epoch - 50ms/step
Epoch 8/50
444/444 - 21s - loss: 3.2509 - accuracy50: 0.3882 - val_loss: 3.2989 - val_accuracy50: 0.3759 - 21s/epoch - 47ms/step
Epoch 9/50
444/444 - 23s - loss: 3.2474 - accuracy50: 0.3916 - val_loss: 3.3006 - val_accuracy50: 0.3766 - 23s/epoch - 51ms/step
Epoch 10/50
444/444 - 24s - loss: 3.2414 - accuracy50: 0.3969 - val_loss: 3.2991 - val_accuracy50: 0.3755 - 24s/epoch - 55ms/step
Epoch 11/50
444/444 - 24s - loss: 3.2354 - accuracy50: 0.4007 - val_loss: 3.3063 - val_accuracy50: 0.3684 - 24s/epoch - 54ms/step
Epoch 12/50
444/444 - 20s - loss: 3.2306 - accuracy50: 0.4035 - val_loss: 3.3063 - val_accuracy50: 0.3684 - 20s/epoch - 45ms/step
Epoch 13/50
444/444 - 24s - loss: 3.2248 - accuracy50: 0.4069 - val_loss: 3.3069 - val_accuracy50: 0.3680 - 24s/epoch - 54ms/step
Epoch 14/50
444/444 - 22s - loss: 3.2216 - accuracy50: 0.4080 - val_loss: 3.3102 - val_accuracy50: 0.3700 - 22s/epoch - 50ms/step
Epoch 15/50
444/444 - 23s - loss: 3.2150 - accuracy50: 0.4109 - val_loss: 3.3244 - val_accuracy50: 0.3641 - 23s/epoch - 51ms/step
Epoch 16/50
444/444 - 22s - loss: 3.2102 - accuracy50: 0.4140 - val_loss: 3.3115 - val_accuracy50: 0.3744 - 22s/epoch - 50ms/step
testing model: results/XRAY/W3/deepVOL_L2/h50
Evaluating performance on  test set...
1359/1359 - 35s - 35s/epoch - 26ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1079423
{'0': {'precision': 0.420735516372796, 'recall': 0.16704536362909034, 'f1-score': 0.23914325802479744, 'support': 124990}, '1': {'precision': 0.3028593582561574, 'recall': 0.6879780717812719, 'f1-score': 0.4205747401087052, 'support': 101057}, '2': {'precision': 0.4109365435625383, 'recall': 0.23158171394779636, 'f1-score': 0.29622625651369977, 'support': 121754}, 'accuracy': 0.34099959459576024, 'macro avg': {'precision': 0.37817713939716385, 'recall': 0.3622017164527196, 'f1-score': 0.31864808488240076, 'support': 347801}, 'weighted avg': {'precision': 0.3830551329169311, 'recall': 0.34099959459576024, 'f1-score': 0.31184288994929243, 'support': 347801}}
[[20879 81936 22175]
 [13289 69525 18243]
 [15457 78101 28196]]
Evaluating performance on  train set...
444/444 - 11s - 11s/epoch - 25ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0901347
{'0': {'precision': 0.4045741711151379, 'recall': 0.22081740664510438, 'f1-score': 0.2856994639460488, 'support': 37411}, '1': {'precision': 0.3624155475852865, 'recall': 0.5797971710701895, 'f1-score': 0.44602987219627366, 'support': 37470}, '2': {'precision': 0.39696012039127165, 'recall': 0.34073059832592745, 'f1-score': 0.3667023480182948, 'support': 38708}, 'accuracy': 0.3800984250235498, 'macro avg': {'precision': 0.387983279697232, 'recall': 0.3804483920137405, 'f1-score': 0.36614389472020575, 'support': 113589}, 'weighted avg': {'precision': 0.38807250018676503, 'recall': 0.3800984250235498, 'f1-score': 0.3661917654347882, 'support': 113589}}
[[ 8261 19191  9959]
 [ 5668 21725 10077]
 [ 6490 19029 13189]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 27ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.096574
{'0': {'precision': 0.4089406853365803, 'recall': 0.18494336060415356, 'f1-score': 0.25469909539028224, 'support': 12712}, '1': {'precision': 0.3432285700054789, 'recall': 0.6123156211124934, 'f1-score': 0.4398838211356165, 'support': 11254}, '2': {'precision': 0.40652736686390534, 'recall': 0.34687598611549386, 'f1-score': 0.37434020091946196, 'support': 12676}, 'accuracy': 0.37222313192511325, 'macro avg': {'precision': 0.38623220740198816, 'recall': 0.38137832261071364, 'f1-score': 0.3563077058151203, 'support': 36642}, 'weighted avg': {'precision': 0.38792339995652886, 'recall': 0.37222313192511325, 'f1-score': 0.35296446183386815, 'support': 36642}}
[[2351 6770 3591]
 [1535 6891 2828]
 [1863 6416 4397]]
training model: results/XRAY/W3/deepVOL_L2/h100
Epoch 1/50
444/444 - 29s - loss: 3.3442 - accuracy100: 0.3461 - val_loss: 3.3112 - val_accuracy100: 0.3530 - 29s/epoch - 65ms/step
Epoch 2/50
444/444 - 20s - loss: 3.3078 - accuracy100: 0.3472 - val_loss: 3.2966 - val_accuracy100: 0.3578 - 20s/epoch - 45ms/step
Epoch 3/50
444/444 - 25s - loss: 3.2940 - accuracy100: 0.3548 - val_loss: 3.2920 - val_accuracy100: 0.3569 - 25s/epoch - 56ms/step
Epoch 4/50
444/444 - 23s - loss: 3.2878 - accuracy100: 0.3626 - val_loss: 3.2971 - val_accuracy100: 0.3576 - 23s/epoch - 52ms/step
Epoch 5/50
444/444 - 21s - loss: 3.2817 - accuracy100: 0.3678 - val_loss: 3.2982 - val_accuracy100: 0.3540 - 21s/epoch - 46ms/step
Epoch 6/50
444/444 - 20s - loss: 3.2780 - accuracy100: 0.3708 - val_loss: 3.2951 - val_accuracy100: 0.3572 - 20s/epoch - 46ms/step
Epoch 7/50
444/444 - 22s - loss: 3.2747 - accuracy100: 0.3739 - val_loss: 3.2964 - val_accuracy100: 0.3569 - 22s/epoch - 49ms/step
Epoch 8/50
444/444 - 22s - loss: 3.2704 - accuracy100: 0.3756 - val_loss: 3.3000 - val_accuracy100: 0.3573 - 22s/epoch - 49ms/step
Epoch 9/50
444/444 - 20s - loss: 3.2654 - accuracy100: 0.3801 - val_loss: 3.2961 - val_accuracy100: 0.3567 - 20s/epoch - 46ms/step
Epoch 10/50
444/444 - 22s - loss: 3.2619 - accuracy100: 0.3824 - val_loss: 3.2957 - val_accuracy100: 0.3585 - 22s/epoch - 50ms/step
Epoch 11/50
444/444 - 23s - loss: 3.2574 - accuracy100: 0.3855 - val_loss: 3.3077 - val_accuracy100: 0.3589 - 23s/epoch - 52ms/step
Epoch 12/50
444/444 - 21s - loss: 3.2532 - accuracy100: 0.3892 - val_loss: 3.3045 - val_accuracy100: 0.3602 - 21s/epoch - 48ms/step
Epoch 13/50
444/444 - 23s - loss: 3.2494 - accuracy100: 0.3885 - val_loss: 3.3117 - val_accuracy100: 0.3601 - 23s/epoch - 52ms/step
testing model: results/XRAY/W3/deepVOL_L2/h100
Evaluating performance on  test set...
1359/1359 - 31s - 31s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0889195
{'0': {'precision': 0.3216528661146446, 'recall': 0.23145118733509235, 'f1-score': 0.2691968619923894, 'support': 104225}, '1': {'precision': 0.43645870502017403, 'recall': 0.6656921778081676, 'f1-score': 0.5272366068838228, 'support': 143323}, '2': {'precision': 0.3199092351400214, 'recall': 0.17297237987890637, 'f1-score': 0.22453855068335285, 'support': 100253}, 'accuracy': 0.39353825894692657, 'macro avg': {'precision': 0.35934026875828, 'recall': 0.3567052483407221, 'f1-score': 0.340324006519855, 'support': 347801}, 'weighted avg': {'precision': 0.3684598419811841, 'recall': 0.39353825894692657, 'f1-score': 0.3626580673178774, 'support': 347801}}
[[24123 63591 16511]
 [27560 95409 20354]
 [23314 59598 17341]]
Evaluating performance on  train set...
444/444 - 12s - 12s/epoch - 26ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0957186
{'0': {'precision': 0.34838727134971315, 'recall': 0.34686674928606065, 'f1-score': 0.3476253476253476, 'support': 37118}, '1': {'precision': 0.3719502013099059, 'recall': 0.52986731511339, 'f1-score': 0.43708233857692597, 'support': 37834}, '2': {'precision': 0.36426812104152007, 'recall': 0.2143541165204338, 'f1-score': 0.2698906685350236, 'support': 38637}, 'accuracy': 0.3627463926964759, 'macro avg': {'precision': 0.36153519790037975, 'recall': 0.36369606030662815, 'f1-score': 0.35153278491243234, 'support': 113589}, 'weighted avg': {'precision': 0.3616373948797757, 'recall': 0.3627463926964759, 'f1-score': 0.3509802587492167, 'support': 113589}}
[[12875 16754  7489]
 [10822 20047  6965]
 [13259 17096  8282]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0974331
{'0': {'precision': 0.3550147237138403, 'recall': 0.33091143941228707, 'f1-score': 0.3425395896878787, 'support': 12387}, '1': {'precision': 0.36034739982949704, 'recall': 0.5680806383872322, 'f1-score': 0.440974146643628, 'support': 11905}, '2': {'precision': 0.36172566371681414, 'recall': 0.18534412955465587, 'f1-score': 0.2451011885640861, 'support': 12350}, 'accuracy': 0.35890508160034934, 'macro avg': {'precision': 0.35902926242005045, 'recall': 0.36144540245139173, 'f1-score': 0.34287164163186423, 'support': 36642}, 'weighted avg': {'precision': 0.3590092004944096, 'recall': 0.35890508160034934, 'f1-score': 0.34167989716780217, 'support': 36642}}
[[4099 6091 2197]
 [3300 6763 1842]
 [4147 5914 2289]]
training model: results/XRAY/W3/deepVOL_L2/h200
Epoch 1/50
444/444 - 30s - loss: 3.3316 - accuracy200: 0.3586 - val_loss: 3.3515 - val_accuracy200: 0.3465 - 30s/epoch - 67ms/step
Epoch 2/50
444/444 - 22s - loss: 3.3006 - accuracy200: 0.3584 - val_loss: 3.3008 - val_accuracy200: 0.3634 - 22s/epoch - 50ms/step
Epoch 3/50
444/444 - 23s - loss: 3.2871 - accuracy200: 0.3677 - val_loss: 3.2905 - val_accuracy200: 0.3684 - 23s/epoch - 51ms/step
Epoch 4/50
444/444 - 22s - loss: 3.2752 - accuracy200: 0.3736 - val_loss: 3.3026 - val_accuracy200: 0.3708 - 22s/epoch - 50ms/step
Epoch 5/50
444/444 - 22s - loss: 3.2686 - accuracy200: 0.3793 - val_loss: 3.2986 - val_accuracy200: 0.3750 - 22s/epoch - 51ms/step
Epoch 6/50
444/444 - 25s - loss: 3.2644 - accuracy200: 0.3823 - val_loss: 3.3084 - val_accuracy200: 0.3656 - 25s/epoch - 57ms/step
Epoch 7/50
444/444 - 21s - loss: 3.2588 - accuracy200: 0.3859 - val_loss: 3.3118 - val_accuracy200: 0.3761 - 21s/epoch - 47ms/step
Epoch 8/50
444/444 - 22s - loss: 3.2550 - accuracy200: 0.3888 - val_loss: 3.3033 - val_accuracy200: 0.3727 - 22s/epoch - 49ms/step
Epoch 9/50
444/444 - 24s - loss: 3.2468 - accuracy200: 0.3929 - val_loss: 3.3125 - val_accuracy200: 0.3735 - 24s/epoch - 53ms/step
Epoch 10/50
444/444 - 24s - loss: 3.2424 - accuracy200: 0.3968 - val_loss: 3.3010 - val_accuracy200: 0.3702 - 24s/epoch - 55ms/step
Epoch 11/50
444/444 - 22s - loss: 3.2366 - accuracy200: 0.3990 - val_loss: 3.3101 - val_accuracy200: 0.3714 - 22s/epoch - 49ms/step
Epoch 12/50
444/444 - 23s - loss: 3.2339 - accuracy200: 0.4001 - val_loss: 3.3152 - val_accuracy200: 0.3666 - 23s/epoch - 52ms/step
Epoch 13/50
444/444 - 22s - loss: 3.2306 - accuracy200: 0.4012 - val_loss: 3.3281 - val_accuracy200: 0.3684 - 22s/epoch - 49ms/step
testing model: results/XRAY/W3/deepVOL_L2/h200
Evaluating performance on  test set...
1359/1359 - 28s - 28s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0688864
{'0': {'precision': 0.3207329389698456, 'recall': 0.06743856810597634, 'f1-score': 0.11144439895390325, 'support': 98890}, '1': {'precision': 0.47013975252694856, 'recall': 0.8265405426447118, 'f1-score': 0.5993606405826216, 'support': 154134}, '2': {'precision': 0.32363597422763213, 'recall': 0.19132278928432003, 'f1-score': 0.2404811479649351, 'support': 94777}, 'accuracy': 0.4376065623733112, 'macro avg': {'precision': 0.3715028885748088, 'recall': 0.3617673000116694, 'f1-score': 0.31709539583382, 'support': 347801}, 'weighted avg': {'precision': 0.3877362275556684, 'recall': 0.4376065623733112, 'f1-score': 0.3628358496634166, 'support': 347801}}
[[  6669  73761  18460]
 [  7300 127398  19436]
 [  6824  69820  18133]]
Evaluating performance on  train set...
444/444 - 10s - 10s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0993137
{'0': {'precision': 0.3495435945860875, 'recall': 0.11933802589866208, 'f1-score': 0.17792910074103746, 'support': 37222}, '1': {'precision': 0.36317092672358203, 'recall': 0.7489428472647004, 'f1-score': 0.48914827649097203, 'support': 37601}, '2': {'precision': 0.37975063198937403, 'recall': 0.22862817933240467, 'f1-score': 0.2854198534739554, 'support': 38766}, 'accuracy': 0.3650529540712569, 'macro avg': {'precision': 0.36415505109968116, 'recall': 0.3656363508319224, 'f1-score': 0.3174990769019883, 'support': 113589}, 'weighted avg': {'precision': 0.364363756112976, 'recall': 0.3650529540712569, 'f1-score': 0.3176357514538493, 'support': 113589}}
[[ 4442 24466  8314]
 [ 3278 28161  6162]
 [ 4988 24915  8863]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0967906
{'0': {'precision': 0.3885828743114672, 'recall': 0.12510075769788812, 'f1-score': 0.18926829268292683, 'support': 12406}, '1': {'precision': 0.3648664144020181, 'recall': 0.783615169922837, 'f1-score': 0.49790063893597597, 'support': 12182}, '2': {'precision': 0.37656129529683885, 'recall': 0.2025883524141364, 'f1-score': 0.26344463023895576, 'support': 12054}, 'accuracy': 0.369521314338737, 'macro avg': {'precision': 0.3766701946701081, 'recall': 0.37043476001162046, 'f1-score': 0.31687118728595287, 'support': 36642}, 'weighted avg': {'precision': 0.37674339971785226, 'recall': 0.369521314338737, 'f1-score': 0.31627775763994387, 'support': 36642}}
[[1552 8495 2359]
 [ 952 9546 1684]
 [1490 8122 2442]]
training model: results/XRAY/W3/deepVOL_L2/h300
Epoch 1/50
444/444 - 31s - loss: 3.3424 - accuracy300: 0.3576 - val_loss: 3.3518 - val_accuracy300: 0.3288 - 31s/epoch - 71ms/step
Epoch 2/50
444/444 - 24s - loss: 3.3106 - accuracy300: 0.3561 - val_loss: 3.3101 - val_accuracy300: 0.3452 - 24s/epoch - 55ms/step
Epoch 3/50
444/444 - 23s - loss: 3.2926 - accuracy300: 0.3592 - val_loss: 3.2925 - val_accuracy300: 0.3508 - 23s/epoch - 52ms/step
Epoch 4/50
444/444 - 20s - loss: 3.2831 - accuracy300: 0.3660 - val_loss: 3.2890 - val_accuracy300: 0.3557 - 20s/epoch - 46ms/step
Epoch 5/50
444/444 - 21s - loss: 3.2786 - accuracy300: 0.3694 - val_loss: 3.2935 - val_accuracy300: 0.3530 - 21s/epoch - 47ms/step
Epoch 6/50
444/444 - 22s - loss: 3.2698 - accuracy300: 0.3758 - val_loss: 3.3050 - val_accuracy300: 0.3540 - 22s/epoch - 50ms/step
Epoch 7/50
444/444 - 20s - loss: 3.2670 - accuracy300: 0.3791 - val_loss: 3.3157 - val_accuracy300: 0.3540 - 20s/epoch - 44ms/step
Epoch 8/50
444/444 - 21s - loss: 3.2602 - accuracy300: 0.3835 - val_loss: 3.3154 - val_accuracy300: 0.3551 - 21s/epoch - 48ms/step
Epoch 9/50
444/444 - 24s - loss: 3.2574 - accuracy300: 0.3828 - val_loss: 3.3277 - val_accuracy300: 0.3499 - 24s/epoch - 55ms/step
Epoch 10/50
444/444 - 22s - loss: 3.2522 - accuracy300: 0.3874 - val_loss: 3.3254 - val_accuracy300: 0.3514 - 22s/epoch - 49ms/step
Epoch 11/50
444/444 - 19s - loss: 3.2512 - accuracy300: 0.3868 - val_loss: 3.3289 - val_accuracy300: 0.3504 - 19s/epoch - 43ms/step
Epoch 12/50
444/444 - 24s - loss: 3.2494 - accuracy300: 0.3914 - val_loss: 3.3279 - val_accuracy300: 0.3495 - 24s/epoch - 55ms/step
Epoch 13/50
444/444 - 24s - loss: 3.2490 - accuracy300: 0.3887 - val_loss: 3.3118 - val_accuracy300: 0.3583 - 24s/epoch - 54ms/step
Epoch 14/50
444/444 - 22s - loss: 3.2446 - accuracy300: 0.3923 - val_loss: 3.3203 - val_accuracy300: 0.3600 - 22s/epoch - 50ms/step
testing model: results/XRAY/W3/deepVOL_L2/h300
Evaluating performance on  test set...
1359/1359 - 28s - 28s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0792623
{'0': {'precision': 0.32071281750110114, 'recall': 0.17132017019274132, 'f1-score': 0.22333695443798324, 'support': 102002}, '1': {'precision': 0.4537299896733187, 'recall': 0.8086205959851139, 'f1-score': 0.5812892532934322, 'support': 147252}, '2': {'precision': 0.33267499838114356, 'recall': 0.1042649700143079, 'f1-score': 0.15876940192995606, 'support': 98547}, 'accuracy': 0.42214082190678004, 'macro avg': {'precision': 0.3690392685185211, 'recall': 0.36140191206405436, 'f1-score': 0.32113186988712383, 'support': 347801}, 'weighted avg': {'precision': 0.38041903363012014, 'recall': 0.42214082190678004, 'f1-score': 0.35659204373920433, 'support': 347801}}
[[ 17475  74298  10229]
 [ 17799 119071  10382]
 [ 19214  69058  10275]]
Evaluating performance on  train set...
444/444 - 12s - 12s/epoch - 27ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0934304
{'0': {'precision': 0.35907429227469106, 'recall': 0.31861562382714065, 'f1-score': 0.3376372494708882, 'support': 37302}, '1': {'precision': 0.3683100253732224, 'recall': 0.6719326102753183, 'f1-score': 0.47581113916813567, 'support': 37157}, '2': {'precision': 0.38450637694851203, 'recall': 0.12481472016355737, 'f1-score': 0.18845500848896432, 'support': 39130}, 'accuracy': 0.36742994480099306, 'macro avg': {'precision': 0.37063023153214186, 'recall': 0.3717876514220055, 'f1-score': 0.33396779904266266, 'support': 113589}, 'weighted avg': {'precision': 0.37085650365104567, 'recall': 0.36742994480099306, 'f1-score': 0.3314449784750871, 'support': 113589}}
[[11885 21054  4363]
 [ 8735 24967  3455]
 [12479 21767  4884]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0972188
{'0': {'precision': 0.37310079178258077, 'recall': 0.2717425187032419, 'f1-score': 0.3144557669762828, 'support': 12832}, '1': {'precision': 0.34588215388519944, 'recall': 0.7175954365949978, 'f1-score': 0.46677702934124904, 'support': 11395}, '2': {'precision': 0.38331053351573185, 'recall': 0.11284736206202174, 'f1-score': 0.1743621655258245, 'support': 12415}, 'accuracy': 0.356558048141477, 'macro avg': {'precision': 0.3674311597278373, 'recall': 0.3673951057867539, 'f1-score': 0.31853165394778543, 'support': 36642}, 'weighted avg': {'precision': 0.36809554001620365, 'recall': 0.356558048141477, 'f1-score': 0.31435857584701443, 'support': 36642}}
[[3487 7983 1362]
 [2326 8177  892]
 [3533 7481 1401]]
training model: results/XRAY/W3/deepVOL_L2/h500
Epoch 1/50
444/444 - 30s - loss: 3.3403 - accuracy500: 0.3569 - val_loss: 3.3782 - val_accuracy500: 0.3169 - 30s/epoch - 68ms/step
Epoch 2/50
444/444 - 24s - loss: 3.3102 - accuracy500: 0.3468 - val_loss: 3.3134 - val_accuracy500: 0.3298 - 24s/epoch - 55ms/step
Epoch 3/50
444/444 - 23s - loss: 3.2958 - accuracy500: 0.3564 - val_loss: 3.3008 - val_accuracy500: 0.3474 - 23s/epoch - 52ms/step
Epoch 4/50
444/444 - 23s - loss: 3.2860 - accuracy500: 0.3623 - val_loss: 3.2948 - val_accuracy500: 0.3525 - 23s/epoch - 53ms/step
Epoch 5/50
444/444 - 27s - loss: 3.2804 - accuracy500: 0.3670 - val_loss: 3.2950 - val_accuracy500: 0.3483 - 27s/epoch - 60ms/step
Epoch 6/50
444/444 - 24s - loss: 3.2748 - accuracy500: 0.3756 - val_loss: 3.2911 - val_accuracy500: 0.3590 - 24s/epoch - 54ms/step
Epoch 7/50
444/444 - 25s - loss: 3.2699 - accuracy500: 0.3763 - val_loss: 3.2956 - val_accuracy500: 0.3551 - 25s/epoch - 55ms/step
Epoch 8/50
444/444 - 24s - loss: 3.2623 - accuracy500: 0.3814 - val_loss: 3.2976 - val_accuracy500: 0.3519 - 24s/epoch - 54ms/step
Epoch 9/50
444/444 - 24s - loss: 3.2566 - accuracy500: 0.3862 - val_loss: 3.2999 - val_accuracy500: 0.3527 - 24s/epoch - 55ms/step
Epoch 10/50
444/444 - 24s - loss: 3.2484 - accuracy500: 0.3909 - val_loss: 3.3057 - val_accuracy500: 0.3529 - 24s/epoch - 54ms/step
Epoch 11/50
444/444 - 23s - loss: 3.2449 - accuracy500: 0.3953 - val_loss: 3.3028 - val_accuracy500: 0.3533 - 23s/epoch - 52ms/step
Epoch 12/50
444/444 - 24s - loss: 3.2357 - accuracy500: 0.3999 - val_loss: 3.3129 - val_accuracy500: 0.3528 - 24s/epoch - 54ms/step
Epoch 13/50
444/444 - 23s - loss: 3.2307 - accuracy500: 0.4037 - val_loss: 3.3214 - val_accuracy500: 0.3503 - 23s/epoch - 52ms/step
Epoch 14/50
444/444 - 25s - loss: 3.2257 - accuracy500: 0.4060 - val_loss: 3.3311 - val_accuracy500: 0.3519 - 25s/epoch - 56ms/step
Epoch 15/50
444/444 - 23s - loss: 3.2185 - accuracy500: 0.4085 - val_loss: 3.3421 - val_accuracy500: 0.3484 - 23s/epoch - 53ms/step
Epoch 16/50
444/444 - 24s - loss: 3.2213 - accuracy500: 0.4069 - val_loss: 3.3321 - val_accuracy500: 0.3540 - 24s/epoch - 55ms/step
testing model: results/XRAY/W3/deepVOL_L2/h500
Evaluating performance on  test set...
1359/1359 - 36s - 36s/epoch - 26ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0846143
{'0': {'precision': 0.3123236280335978, 'recall': 0.3795259707513868, 'f1-score': 0.34266097234490106, 'support': 99150}, '1': {'precision': 0.4757919176883072, 'recall': 0.6766975360012782, 'f1-score': 0.5587334744248688, 'support': 150203}, '2': {'precision': 0.343827611395179, 'recall': 0.04781204290589956, 'f1-score': 0.08395013287199701, 'support': 98448}, 'accuracy': 0.41396948254892885, 'macro avg': {'precision': 0.37731438570569464, 'recall': 0.3680118498861882, 'f1-score': 0.3284481932139223, 'support': 347801}, 'weighted avg': {'precision': 0.3918372914934132, 'recall': 0.41396948254892885, 'f1-score': 0.362744794143829, 'support': 347801}}
[[ 37630  57605   3915]
 [ 43493 101642   5068]
 [ 39361  54380   4707]]
Evaluating performance on  train set...
444/444 - 10s - 10s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0946195
{'0': {'precision': 0.35382465944813135, 'recall': 0.4878531678082192, 'f1-score': 0.4101675851985153, 'support': 37376}, '1': {'precision': 0.3713140460593464, 'recall': 0.53372989410227, 'f1-score': 0.4379486954999125, 'support': 37489}, '2': {'precision': 0.38503917727717923, 'recall': 0.08121578349344076, 'f1-score': 0.13413801927834174, 'support': 38724}, 'accuracy': 0.36436626786044424, 'macro avg': {'precision': 0.3700592942615524, 'recall': 0.3675996151346434, 'f1-score': 0.3274180999922565, 'support': 113589}, 'weighted avg': {'precision': 0.37023831396643764, 'recall': 0.36436626786044424, 'f1-score': 0.32523433579405076, 'support': 113589}}
[[18234 16520  2622]
 [15079 20009  2401]
 [18221 17358  3145]]
Evaluating performance on  val set...
144/144 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0970049
{'0': {'precision': 0.3691170750680669, 'recall': 0.4430094141445577, 'f1-score': 0.4027016514021005, 'support': 12853}, '1': {'precision': 0.34945193265852, 'recall': 0.5847814639283834, 'f1-score': 0.4374774301565937, 'support': 11394}, '2': {'precision': 0.3652861796184272, 'recall': 0.06333198870512304, 'f1-score': 0.10794829482948295, 'support': 12395}, 'accuracy': 0.35865946181976965, 'macro avg': {'precision': 0.3612850624483381, 'recall': 0.3637076222593547, 'f1-score': 0.3160424587960591, 'support': 36642}, 'weighted avg': {'precision': 0.36170621917284657, 'recall': 0.35865946181976965, 'f1-score': 0.3138082331501246, 'support': 36642}}
[[5694 6383  776]
 [4143 6663  588]
 [5589 6021  785]]
training model: results/XRAY/W3/deepVOL_L2/h1000
Epoch 1/50
444/444 - 34s - loss: 3.3436 - accuracy1000: 0.3615 - val_loss: 3.3780 - val_accuracy1000: 0.3537 - 34s/epoch - 76ms/step
Epoch 2/50
444/444 - 26s - loss: 3.3202 - accuracy1000: 0.3568 - val_loss: 3.3357 - val_accuracy1000: 0.3456 - 26s/epoch - 58ms/step
Epoch 3/50
444/444 - 23s - loss: 3.2997 - accuracy1000: 0.3551 - val_loss: 3.3089 - val_accuracy1000: 0.3559 - 23s/epoch - 52ms/step
Epoch 4/50
444/444 - 21s - loss: 3.2877 - accuracy1000: 0.3649 - val_loss: 3.3215 - val_accuracy1000: 0.3570 - 21s/epoch - 48ms/step
Epoch 5/50
444/444 - 27s - loss: 3.2798 - accuracy1000: 0.3720 - val_loss: 3.3362 - val_accuracy1000: 0.3628 - 27s/epoch - 61ms/step
Epoch 6/50
444/444 - 24s - loss: 3.2768 - accuracy1000: 0.3756 - val_loss: 3.2971 - val_accuracy1000: 0.3655 - 24s/epoch - 54ms/step
Epoch 7/50
444/444 - 22s - loss: 3.2724 - accuracy1000: 0.3789 - val_loss: 3.3597 - val_accuracy1000: 0.3620 - 22s/epoch - 49ms/step
Epoch 8/50
444/444 - 22s - loss: 3.2549 - accuracy1000: 0.3920 - val_loss: 3.3718 - val_accuracy1000: 0.3658 - 22s/epoch - 50ms/step
Epoch 9/50
444/444 - 27s - loss: 3.2442 - accuracy1000: 0.3970 - val_loss: 3.4183 - val_accuracy1000: 0.3567 - 27s/epoch - 60ms/step
Epoch 10/50
444/444 - 25s - loss: 3.2355 - accuracy1000: 0.4010 - val_loss: 3.3920 - val_accuracy1000: 0.3594 - 25s/epoch - 55ms/step
Epoch 11/50
444/444 - 22s - loss: 3.2245 - accuracy1000: 0.4090 - val_loss: 3.3933 - val_accuracy1000: 0.3547 - 22s/epoch - 50ms/step
Epoch 12/50
444/444 - 25s - loss: 3.2155 - accuracy1000: 0.4132 - val_loss: 3.4287 - val_accuracy1000: 0.3564 - 25s/epoch - 56ms/step
Epoch 13/50
444/444 - 21s - loss: 3.2045 - accuracy1000: 0.4193 - val_loss: 3.4431 - val_accuracy1000: 0.3559 - 21s/epoch - 48ms/step
Epoch 14/50
444/444 - 23s - loss: 3.1960 - accuracy1000: 0.4211 - val_loss: 3.4635 - val_accuracy1000: 0.3579 - 23s/epoch - 53ms/step
Epoch 15/50
444/444 - 20s - loss: 3.1876 - accuracy1000: 0.4257 - val_loss: 3.5225 - val_accuracy1000: 0.3504 - 20s/epoch - 46ms/step
Epoch 16/50
444/444 - 24s - loss: 3.1781 - accuracy1000: 0.4292 - val_loss: 3.5446 - val_accuracy1000: 0.3485 - 24s/epoch - 55ms/step
testing model: results/XRAY/W3/deepVOL_L2/h1000
Evaluating performance on  test set...
1359/1359 - 31s - 31s/epoch - 23ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0681077
{'0': {'precision': 0.3228060118589112, 'recall': 0.18911685994647637, 'f1-score': 0.23850491039521401, 'support': 95285}, '1': {'precision': 0.4920490019188361, 'recall': 0.8436057645094766, 'f1-score': 0.6215608776658285, 'support': 162928}, '2': {'precision': 0.3298528713811106, 'recall': 0.04654641246595526, 'f1-score': 0.08158074929081484, 'support': 89588}, 'accuracy': 0.45898947961621733, 'macro avg': {'precision': 0.3815692950529526, 'recall': 0.3597563456406361, 'f1-score': 0.3138821791172858, 'support': 347801}, 'weighted avg': {'precision': 0.4039033518187108, 'recall': 0.45898947961621733, 'f1-score': 0.37752699742327245, 'support': 347801}}
[[ 18020  73456   3809]
 [ 20818 137447   4663]
 [ 16985  68433   4170]]
Evaluating performance on  train set...
444/444 - 12s - 12s/epoch - 27ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0960162
{'0': {'precision': 0.3657456606447042, 'recall': 0.2789711166950366, 'f1-score': 0.31651875354455017, 'support': 37011}, '1': {'precision': 0.36122741003762787, 'recall': 0.7222825655018942, 'f1-score': 0.48159826183725923, 'support': 37747}, '2': {'precision': 0.41576444399473844, 'recall': 0.10581751693234787, 'f1-score': 0.16869893665065483, 'support': 38831}, 'accuracy': 0.3670954053649561, 'macro avg': {'precision': 0.3809125048923569, 'recall': 0.3690237330430928, 'f1-score': 0.3222719840108214, 'support': 113589}, 'weighted avg': {'precision': 0.3813433767140407, 'recall': 0.3670954053649561, 'f1-score': 0.3208436872064192, 'support': 113589}}
[[10325 23482  3204]
 [ 7913 27264  2570]
 [ 9992 24730  4109]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 25ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990509
{'0': {'precision': 0.3643061359137893, 'recall': 0.266489703989704, 'f1-score': 0.30781380655950946, 'support': 12432}, '1': {'precision': 0.36618775831529227, 'recall': 0.756279977237623, 'f1-score': 0.4934493184108629, 'support': 12301}, '2': {'precision': 0.37984134391040597, 'recall': 0.06835166680661685, 'f1-score': 0.11585539424992884, 'support': 11909}, 'accuracy': 0.36651929479831885, 'macro avg': {'precision': 0.3701117460464958, 'recall': 0.3637071160113146, 'f1-score': 0.30570617307343373, 'support': 36642}, 'weighted avg': {'precision': 0.3699869019525589, 'recall': 0.36651929479831885, 'f1-score': 0.3077447518978836, 'support': 36642}}
[[3313 8358  761]
 [2430 9303  568]
 [3351 7744  814]]
training model: results/XRAY/W3/deepVOL_L3/h10
Epoch 1/50
444/444 - 38s - loss: 3.3153 - accuracy10: 0.3667 - val_loss: 3.3640 - val_accuracy10: 0.3572 - 38s/epoch - 86ms/step
Epoch 2/50
444/444 - 33s - loss: 3.2856 - accuracy10: 0.3710 - val_loss: 3.2548 - val_accuracy10: 0.3925 - 33s/epoch - 73ms/step
Epoch 3/50
444/444 - 30s - loss: 3.2530 - accuracy10: 0.3889 - val_loss: 3.2454 - val_accuracy10: 0.3814 - 30s/epoch - 67ms/step
Epoch 4/50
444/444 - 29s - loss: 3.2396 - accuracy10: 0.3971 - val_loss: 3.2225 - val_accuracy10: 0.4069 - 29s/epoch - 66ms/step
Epoch 5/50
444/444 - 30s - loss: 3.2161 - accuracy10: 0.4086 - val_loss: 3.1925 - val_accuracy10: 0.4173 - 30s/epoch - 67ms/step
Epoch 6/50
444/444 - 29s - loss: 3.1869 - accuracy10: 0.4232 - val_loss: 3.1685 - val_accuracy10: 0.4283 - 29s/epoch - 66ms/step
Epoch 7/50
444/444 - 29s - loss: 3.1628 - accuracy10: 0.4363 - val_loss: 3.1934 - val_accuracy10: 0.4162 - 29s/epoch - 65ms/step
Epoch 8/50
444/444 - 31s - loss: 3.1404 - accuracy10: 0.4476 - val_loss: 3.1279 - val_accuracy10: 0.4467 - 31s/epoch - 70ms/step
Epoch 9/50
444/444 - 30s - loss: 3.1224 - accuracy10: 0.4556 - val_loss: 3.1153 - val_accuracy10: 0.4529 - 30s/epoch - 67ms/step
Epoch 10/50
444/444 - 27s - loss: 3.1141 - accuracy10: 0.4579 - val_loss: 3.1220 - val_accuracy10: 0.4493 - 27s/epoch - 61ms/step
Epoch 11/50
444/444 - 32s - loss: 3.1008 - accuracy10: 0.4637 - val_loss: 3.1280 - val_accuracy10: 0.4516 - 32s/epoch - 71ms/step
Epoch 12/50
444/444 - 29s - loss: 3.0930 - accuracy10: 0.4648 - val_loss: 3.1108 - val_accuracy10: 0.4548 - 29s/epoch - 66ms/step
Epoch 13/50
444/444 - 27s - loss: 3.0802 - accuracy10: 0.4718 - val_loss: 3.0960 - val_accuracy10: 0.4631 - 27s/epoch - 61ms/step
Epoch 14/50
444/444 - 30s - loss: 3.0715 - accuracy10: 0.4742 - val_loss: 3.0895 - val_accuracy10: 0.4631 - 30s/epoch - 67ms/step
Epoch 15/50
444/444 - 28s - loss: 3.0639 - accuracy10: 0.4760 - val_loss: 3.0898 - val_accuracy10: 0.4629 - 28s/epoch - 64ms/step
Epoch 16/50
444/444 - 29s - loss: 3.0545 - accuracy10: 0.4818 - val_loss: 3.0815 - val_accuracy10: 0.4686 - 29s/epoch - 65ms/step
Epoch 17/50
444/444 - 30s - loss: 3.0479 - accuracy10: 0.4829 - val_loss: 3.0690 - val_accuracy10: 0.4719 - 30s/epoch - 67ms/step
Epoch 18/50
444/444 - 30s - loss: 3.0396 - accuracy10: 0.4852 - val_loss: 3.0775 - val_accuracy10: 0.4696 - 30s/epoch - 67ms/step
Epoch 19/50
444/444 - 28s - loss: 3.0329 - accuracy10: 0.4877 - val_loss: 3.0747 - val_accuracy10: 0.4713 - 28s/epoch - 63ms/step
Epoch 20/50
444/444 - 29s - loss: 3.0251 - accuracy10: 0.4902 - val_loss: 3.0704 - val_accuracy10: 0.4748 - 29s/epoch - 65ms/step
Epoch 21/50
444/444 - 30s - loss: 3.0196 - accuracy10: 0.4925 - val_loss: 3.0654 - val_accuracy10: 0.4743 - 30s/epoch - 68ms/step
Epoch 22/50
444/444 - 29s - loss: 3.0141 - accuracy10: 0.4936 - val_loss: 3.0742 - val_accuracy10: 0.4725 - 29s/epoch - 65ms/step
Epoch 23/50
444/444 - 28s - loss: 3.0076 - accuracy10: 0.4964 - val_loss: 3.0801 - val_accuracy10: 0.4704 - 28s/epoch - 62ms/step
Epoch 24/50
444/444 - 29s - loss: 3.0017 - accuracy10: 0.4974 - val_loss: 3.0722 - val_accuracy10: 0.4738 - 29s/epoch - 65ms/step
Epoch 25/50
444/444 - 30s - loss: 2.9990 - accuracy10: 0.4975 - val_loss: 3.0731 - val_accuracy10: 0.4721 - 30s/epoch - 69ms/step
Epoch 26/50
444/444 - 29s - loss: 2.9930 - accuracy10: 0.5007 - val_loss: 3.0704 - val_accuracy10: 0.4728 - 29s/epoch - 66ms/step
Epoch 27/50
444/444 - 29s - loss: 2.9863 - accuracy10: 0.5024 - val_loss: 3.0651 - val_accuracy10: 0.4737 - 29s/epoch - 65ms/step
Epoch 28/50
444/444 - 27s - loss: 2.9812 - accuracy10: 0.5033 - val_loss: 3.0687 - val_accuracy10: 0.4718 - 27s/epoch - 62ms/step
Epoch 29/50
444/444 - 26s - loss: 2.9782 - accuracy10: 0.5044 - val_loss: 3.0720 - val_accuracy10: 0.4721 - 26s/epoch - 59ms/step
Epoch 30/50
444/444 - 28s - loss: 2.9714 - accuracy10: 0.5064 - val_loss: 3.0660 - val_accuracy10: 0.4763 - 28s/epoch - 62ms/step
Epoch 31/50
444/444 - 29s - loss: 2.9667 - accuracy10: 0.5077 - val_loss: 3.0706 - val_accuracy10: 0.4738 - 29s/epoch - 65ms/step
Epoch 32/50
444/444 - 29s - loss: 2.9606 - accuracy10: 0.5097 - val_loss: 3.0620 - val_accuracy10: 0.4765 - 29s/epoch - 65ms/step
Epoch 33/50
444/444 - 32s - loss: 2.9571 - accuracy10: 0.5094 - val_loss: 3.0681 - val_accuracy10: 0.4732 - 32s/epoch - 71ms/step
Epoch 34/50
444/444 - 31s - loss: 2.9574 - accuracy10: 0.5104 - val_loss: 3.0644 - val_accuracy10: 0.4774 - 31s/epoch - 71ms/step
Epoch 35/50
444/444 - 29s - loss: 2.9487 - accuracy10: 0.5136 - val_loss: 3.0633 - val_accuracy10: 0.4791 - 29s/epoch - 66ms/step
Epoch 36/50
444/444 - 32s - loss: 2.9439 - accuracy10: 0.5141 - val_loss: 3.0720 - val_accuracy10: 0.4751 - 32s/epoch - 72ms/step
Epoch 37/50
444/444 - 29s - loss: 2.9389 - accuracy10: 0.5168 - val_loss: 3.0768 - val_accuracy10: 0.4770 - 29s/epoch - 66ms/step
Epoch 38/50
444/444 - 30s - loss: 2.9354 - accuracy10: 0.5172 - val_loss: 3.0592 - val_accuracy10: 0.4788 - 30s/epoch - 67ms/step
Epoch 39/50
444/444 - 29s - loss: 2.9290 - accuracy10: 0.5192 - val_loss: 3.0839 - val_accuracy10: 0.4713 - 29s/epoch - 64ms/step
Epoch 40/50
444/444 - 29s - loss: 2.9264 - accuracy10: 0.5190 - val_loss: 3.0759 - val_accuracy10: 0.4756 - 29s/epoch - 66ms/step
Epoch 41/50
444/444 - 30s - loss: 2.9209 - accuracy10: 0.5199 - val_loss: 3.0823 - val_accuracy10: 0.4760 - 30s/epoch - 67ms/step
Epoch 42/50
444/444 - 29s - loss: 2.9176 - accuracy10: 0.5216 - val_loss: 3.0731 - val_accuracy10: 0.4766 - 29s/epoch - 66ms/step
Epoch 43/50
444/444 - 28s - loss: 2.9125 - accuracy10: 0.5218 - val_loss: 3.0834 - val_accuracy10: 0.4749 - 28s/epoch - 64ms/step
Epoch 44/50
444/444 - 32s - loss: 2.9101 - accuracy10: 0.5246 - val_loss: 3.0861 - val_accuracy10: 0.4764 - 32s/epoch - 71ms/step
Epoch 45/50
444/444 - 30s - loss: 2.9031 - accuracy10: 0.5250 - val_loss: 3.0853 - val_accuracy10: 0.4779 - 30s/epoch - 68ms/step
Epoch 46/50
444/444 - 28s - loss: 2.9004 - accuracy10: 0.5259 - val_loss: 3.0892 - val_accuracy10: 0.4766 - 28s/epoch - 62ms/step
Epoch 47/50
444/444 - 30s - loss: 2.8962 - accuracy10: 0.5276 - val_loss: 3.0767 - val_accuracy10: 0.4786 - 30s/epoch - 67ms/step
Epoch 48/50
444/444 - 31s - loss: 2.8918 - accuracy10: 0.5280 - val_loss: 3.0832 - val_accuracy10: 0.4741 - 31s/epoch - 69ms/step
testing model: results/XRAY/W3/deepVOL_L3/h10
Evaluating performance on  test set...
1359/1359 - 42s - 42s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0108929
{'0': {'precision': 0.4690200106314926, 'recall': 0.4730519333000136, 'f1-score': 0.4710273439620695, 'support': 110045}, '1': {'precision': 0.5524627847913538, 'recall': 0.4556142456371016, 'f1-score': 0.4993862717580277, 'support': 130819}, '2': {'precision': 0.4503428376407806, 'recall': 0.5429364953196743, 'f1-score': 0.49232386871928807, 'support': 106937}, 'accuracy': 0.4879801955716056, 'macro avg': {'precision': 0.4906085443545423, 'recall': 0.4905342247522631, 'f1-score': 0.4875791614797951, 'support': 347801}, 'weighted avg': {'precision': 0.49466289097028143, 'recall': 0.4879801955716056, 'f1-score': 0.4882419955683102, 'support': 347801}}
[[52057 26289 31699]
 [32051 59603 39165]
 [26883 21994 58060]]
Evaluating performance on  train set...
444/444 - 15s - 15s/epoch - 33ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0160954
{'0': {'precision': 0.4788840407245802, 'recall': 0.4824949376532026, 'f1-score': 0.4806827080043001, 'support': 37532}, '1': {'precision': 0.5812471131639723, 'recall': 0.329088103768404, 'f1-score': 0.42024411828549485, 'support': 38239}, '2': {'precision': 0.45140787820560196, 'recall': 0.646041567507536, 'f1-score': 0.5314654891127014, 'support': 37818}, 'accuracy': 0.4853022739877981, 'macro avg': {'precision': 0.5038463440313848, 'recall': 0.48587486964304755, 'f1-score': 0.47746410513416543, 'support': 113589}, 'weighted avg': {'precision': 0.5041960692913181, 'recall': 0.4853022739877981, 'f1-score': 0.4772439241757615, 'support': 113589}}
[[18109  4862 14561]
 [10524 12584 15131]
 [ 9182  4204 24432]]
Evaluating performance on  val set...
144/144 - 5s - 5s/epoch - 37ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0211239
{'0': {'precision': 0.46325016857720835, 'recall': 0.46687054026503566, 'f1-score': 0.4650533085124386, 'support': 11772}, '1': {'precision': 0.5770371248962164, 'recall': 0.3675859463543634, 'f1-score': 0.449090741253577, 'support': 13235}, '2': {'precision': 0.4304153667339573, 'recall': 0.60472711645896, 'f1-score': 0.5028947180330213, 'support': 11635}, 'accuracy': 0.474783035860488, 'macro avg': {'precision': 0.4902342200691274, 'recall': 0.47972786769278636, 'f1-score': 0.4723462559330123, 'support': 36642}, 'weighted avg': {'precision': 0.4939236429354815, 'recall': 0.474783035860488, 'f1-score': 0.4713035192569653, 'support': 36642}}
[[5496 1880 4396]
 [3455 4865 4915]
 [2913 1686 7036]]
training model: results/XRAY/W3/deepVOL_L3/h20
Epoch 1/50
444/444 - 35s - loss: 3.3316 - accuracy20: 0.3551 - val_loss: 3.3747 - val_accuracy20: 0.3474 - 35s/epoch - 79ms/step
Epoch 2/50
444/444 - 31s - loss: 3.3061 - accuracy20: 0.3544 - val_loss: 3.2760 - val_accuracy20: 0.3759 - 31s/epoch - 70ms/step
Epoch 3/50
444/444 - 31s - loss: 3.2818 - accuracy20: 0.3661 - val_loss: 3.2631 - val_accuracy20: 0.3877 - 31s/epoch - 70ms/step
Epoch 4/50
444/444 - 30s - loss: 3.2692 - accuracy20: 0.3782 - val_loss: 3.2484 - val_accuracy20: 0.3973 - 30s/epoch - 67ms/step
Epoch 5/50
444/444 - 30s - loss: 3.2576 - accuracy20: 0.3871 - val_loss: 3.2439 - val_accuracy20: 0.3950 - 30s/epoch - 67ms/step
Epoch 6/50
444/444 - 28s - loss: 3.2428 - accuracy20: 0.3985 - val_loss: 3.2290 - val_accuracy20: 0.4098 - 28s/epoch - 63ms/step
Epoch 7/50
444/444 - 26s - loss: 3.2268 - accuracy20: 0.4092 - val_loss: 3.2185 - val_accuracy20: 0.4141 - 26s/epoch - 59ms/step
Epoch 8/50
444/444 - 32s - loss: 3.2136 - accuracy20: 0.4145 - val_loss: 3.2177 - val_accuracy20: 0.4105 - 32s/epoch - 71ms/step
Epoch 9/50
444/444 - 27s - loss: 3.2025 - accuracy20: 0.4214 - val_loss: 3.2049 - val_accuracy20: 0.4209 - 27s/epoch - 61ms/step
Epoch 10/50
444/444 - 28s - loss: 3.1899 - accuracy20: 0.4274 - val_loss: 3.2061 - val_accuracy20: 0.4174 - 28s/epoch - 63ms/step
Epoch 11/50
444/444 - 27s - loss: 3.1817 - accuracy20: 0.4320 - val_loss: 3.1853 - val_accuracy20: 0.4268 - 27s/epoch - 61ms/step
Epoch 12/50
444/444 - 28s - loss: 3.1719 - accuracy20: 0.4366 - val_loss: 3.1837 - val_accuracy20: 0.4295 - 28s/epoch - 64ms/step
Epoch 13/50
444/444 - 29s - loss: 3.1628 - accuracy20: 0.4409 - val_loss: 3.1790 - val_accuracy20: 0.4299 - 29s/epoch - 66ms/step
Epoch 14/50
444/444 - 28s - loss: 3.1549 - accuracy20: 0.4443 - val_loss: 3.1726 - val_accuracy20: 0.4350 - 28s/epoch - 64ms/step
Epoch 15/50
444/444 - 31s - loss: 3.1513 - accuracy20: 0.4462 - val_loss: 3.1717 - val_accuracy20: 0.4334 - 31s/epoch - 69ms/step
Epoch 16/50
444/444 - 31s - loss: 3.1428 - accuracy20: 0.4489 - val_loss: 3.1713 - val_accuracy20: 0.4356 - 31s/epoch - 71ms/step
Epoch 17/50
444/444 - 29s - loss: 3.1368 - accuracy20: 0.4500 - val_loss: 3.1695 - val_accuracy20: 0.4381 - 29s/epoch - 66ms/step
Epoch 18/50
444/444 - 32s - loss: 3.1316 - accuracy20: 0.4539 - val_loss: 3.1695 - val_accuracy20: 0.4379 - 32s/epoch - 71ms/step
Epoch 19/50
444/444 - 30s - loss: 3.1276 - accuracy20: 0.4556 - val_loss: 3.1701 - val_accuracy20: 0.4359 - 30s/epoch - 68ms/step
Epoch 20/50
444/444 - 28s - loss: 3.1223 - accuracy20: 0.4572 - val_loss: 3.1741 - val_accuracy20: 0.4330 - 28s/epoch - 64ms/step
Epoch 21/50
444/444 - 28s - loss: 3.1189 - accuracy20: 0.4579 - val_loss: 3.1707 - val_accuracy20: 0.4381 - 28s/epoch - 62ms/step
Epoch 22/50
444/444 - 29s - loss: 3.1106 - accuracy20: 0.4611 - val_loss: 3.1728 - val_accuracy20: 0.4363 - 29s/epoch - 66ms/step
Epoch 23/50
444/444 - 28s - loss: 3.1081 - accuracy20: 0.4636 - val_loss: 3.1746 - val_accuracy20: 0.4333 - 28s/epoch - 62ms/step
Epoch 24/50
444/444 - 29s - loss: 3.1009 - accuracy20: 0.4659 - val_loss: 3.1748 - val_accuracy20: 0.4347 - 29s/epoch - 65ms/step
Epoch 25/50
444/444 - 28s - loss: 3.0976 - accuracy20: 0.4646 - val_loss: 3.1671 - val_accuracy20: 0.4398 - 28s/epoch - 63ms/step
Epoch 26/50
444/444 - 29s - loss: 3.0942 - accuracy20: 0.4671 - val_loss: 3.1655 - val_accuracy20: 0.4417 - 29s/epoch - 64ms/step
Epoch 27/50
444/444 - 30s - loss: 3.0889 - accuracy20: 0.4702 - val_loss: 3.1758 - val_accuracy20: 0.4368 - 30s/epoch - 68ms/step
Epoch 28/50
444/444 - 31s - loss: 3.0844 - accuracy20: 0.4707 - val_loss: 3.1745 - val_accuracy20: 0.4352 - 31s/epoch - 69ms/step
Epoch 29/50
444/444 - 26s - loss: 3.0810 - accuracy20: 0.4727 - val_loss: 3.1766 - val_accuracy20: 0.4391 - 26s/epoch - 59ms/step
Epoch 30/50
444/444 - 31s - loss: 3.0746 - accuracy20: 0.4738 - val_loss: 3.1754 - val_accuracy20: 0.4399 - 31s/epoch - 69ms/step
Epoch 31/50
444/444 - 33s - loss: 3.0705 - accuracy20: 0.4754 - val_loss: 3.1829 - val_accuracy20: 0.4377 - 33s/epoch - 74ms/step
Epoch 32/50
444/444 - 31s - loss: 3.0660 - accuracy20: 0.4777 - val_loss: 3.1764 - val_accuracy20: 0.4384 - 31s/epoch - 70ms/step
Epoch 33/50
444/444 - 29s - loss: 3.0626 - accuracy20: 0.4793 - val_loss: 3.1890 - val_accuracy20: 0.4349 - 29s/epoch - 65ms/step
Epoch 34/50
444/444 - 30s - loss: 3.0559 - accuracy20: 0.4807 - val_loss: 3.1998 - val_accuracy20: 0.4350 - 30s/epoch - 67ms/step
Epoch 35/50
444/444 - 32s - loss: 3.0517 - accuracy20: 0.4831 - val_loss: 3.1908 - val_accuracy20: 0.4352 - 32s/epoch - 72ms/step
Epoch 36/50
444/444 - 31s - loss: 3.0474 - accuracy20: 0.4850 - val_loss: 3.1878 - val_accuracy20: 0.4374 - 31s/epoch - 71ms/step
testing model: results/XRAY/W3/deepVOL_L3/h20
Evaluating performance on  test set...
1359/1359 - 44s - 44s/epoch - 33ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0606349
{'0': {'precision': 0.42109375, 'recall': 0.4073132351241543, 'f1-score': 0.4140888734233848, 'support': 112481}, '1': {'precision': 0.45017719999675604, 'recall': 0.4460497557212651, 'f1-score': 0.44810397368367944, 'support': 124448}, '2': {'precision': 0.4265562604802323, 'recall': 0.4451078721408471, 'f1-score': 0.4356346495061042, 'support': 110872}, 'accuracy': 0.4332218711274551, 'macro avg': {'precision': 0.43260907015899613, 'recall': 0.43282362099542215, 'f1-score': 0.43260916553772283, 'support': 347801}, 'weighted avg': {'precision': 0.43324154902059114, 'recall': 0.4332218711274551, 'f1-score': 0.4331283082813536, 'support': 347801}}
[[45815 36806 29860]
 [32454 55510 36484]
 [30531 30991 49350]]
Evaluating performance on  train set...
444/444 - 13s - 13s/epoch - 29ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0554307
{'0': {'precision': 0.42521057875192464, 'recall': 0.49950791328634125, 'f1-score': 0.4593745031128072, 'support': 37595}, '1': {'precision': 0.4810698312890227, 'recall': 0.2867852806082044, 'f1-score': 0.3593483833622757, 'support': 37882}, '2': {'precision': 0.4348021006788779, 'recall': 0.5343986146095718, 'f1-score': 0.4794830143371707, 'support': 38112}, 'accuracy': 0.44027150516335206, 'macro avg': {'precision': 0.4470275035732751, 'recall': 0.44023060283470583, 'f1-score': 0.4327353002707512, 'support': 113589}, 'weighted avg': {'precision': 0.44705787284105647, 'recall': 0.44027150516335206, 'f1-score': 0.43276264907230416, 'support': 113589}}
[[18779  6273 12543]
 [13086 10864 13932]
 [12299  5446 20367]]
Evaluating performance on  val set...
144/144 - 5s - 5s/epoch - 37ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0550667
{'0': {'precision': 0.4288661369193154, 'recall': 0.4654228855721393, 'f1-score': 0.4463973278193097, 'support': 12060}, '1': {'precision': 0.4823201338538762, 'recall': 0.34550539352776666, 'f1-score': 0.4026070763500931, 'support': 12515}, '2': {'precision': 0.4221673863870039, 'recall': 0.5104002651860445, 'f1-score': 0.462109843937575, 'support': 12067}, 'accuracy': 0.43927733202336117, 'macro avg': {'precision': 0.44445121905339846, 'recall': 0.4404428480953168, 'f1-score': 0.4370380827023259, 'support': 36642}, 'weighted avg': {'precision': 0.44491719714972383, 'recall': 0.43927733202336117, 'f1-score': 0.43661532724242696, 'support': 36642}}
[[5613 2465 3982]
 [3743 4324 4448]
 [3732 2176 6159]]
training model: results/XRAY/W3/deepVOL_L3/h30
Epoch 1/50
444/444 - 35s - loss: 3.3349 - accuracy30: 0.3479 - val_loss: 3.3770 - val_accuracy30: 0.3275 - 35s/epoch - 78ms/step
Epoch 2/50
444/444 - 29s - loss: 3.2996 - accuracy30: 0.3557 - val_loss: 3.2965 - val_accuracy30: 0.3523 - 29s/epoch - 65ms/step
Epoch 3/50
444/444 - 27s - loss: 3.2884 - accuracy30: 0.3632 - val_loss: 3.3010 - val_accuracy30: 0.3479 - 27s/epoch - 61ms/step
Epoch 4/50
444/444 - 28s - loss: 3.2822 - accuracy30: 0.3673 - val_loss: 3.2713 - val_accuracy30: 0.3803 - 28s/epoch - 63ms/step
Epoch 5/50
444/444 - 28s - loss: 3.2753 - accuracy30: 0.3716 - val_loss: 3.2680 - val_accuracy30: 0.3812 - 28s/epoch - 64ms/step
Epoch 6/50
444/444 - 30s - loss: 3.2649 - accuracy30: 0.3819 - val_loss: 3.2651 - val_accuracy30: 0.3785 - 30s/epoch - 67ms/step
Epoch 7/50
444/444 - 28s - loss: 3.2564 - accuracy30: 0.3891 - val_loss: 3.2568 - val_accuracy30: 0.3866 - 28s/epoch - 64ms/step
Epoch 8/50
444/444 - 29s - loss: 3.2433 - accuracy30: 0.3954 - val_loss: 3.2526 - val_accuracy30: 0.3911 - 29s/epoch - 64ms/step
Epoch 9/50
444/444 - 30s - loss: 3.2320 - accuracy30: 0.4038 - val_loss: 3.2627 - val_accuracy30: 0.3852 - 30s/epoch - 69ms/step
Epoch 10/50
444/444 - 28s - loss: 3.2213 - accuracy30: 0.4107 - val_loss: 3.2416 - val_accuracy30: 0.4009 - 28s/epoch - 64ms/step
Epoch 11/50
444/444 - 31s - loss: 3.2135 - accuracy30: 0.4152 - val_loss: 3.2479 - val_accuracy30: 0.3987 - 31s/epoch - 69ms/step
Epoch 12/50
444/444 - 27s - loss: 3.2088 - accuracy30: 0.4191 - val_loss: 3.2366 - val_accuracy30: 0.4067 - 27s/epoch - 61ms/step
Epoch 13/50
444/444 - 31s - loss: 3.2013 - accuracy30: 0.4236 - val_loss: 3.2350 - val_accuracy30: 0.4075 - 31s/epoch - 70ms/step
Epoch 14/50
444/444 - 29s - loss: 3.1956 - accuracy30: 0.4251 - val_loss: 3.2295 - val_accuracy30: 0.4089 - 29s/epoch - 65ms/step
Epoch 15/50
444/444 - 28s - loss: 3.1897 - accuracy30: 0.4295 - val_loss: 3.2287 - val_accuracy30: 0.4105 - 28s/epoch - 63ms/step
Epoch 16/50
444/444 - 31s - loss: 3.1859 - accuracy30: 0.4294 - val_loss: 3.2254 - val_accuracy30: 0.4088 - 31s/epoch - 69ms/step
Epoch 17/50
444/444 - 30s - loss: 3.1816 - accuracy30: 0.4324 - val_loss: 3.2277 - val_accuracy30: 0.4104 - 30s/epoch - 67ms/step
Epoch 18/50
444/444 - 30s - loss: 3.1780 - accuracy30: 0.4342 - val_loss: 3.2297 - val_accuracy30: 0.4076 - 30s/epoch - 67ms/step
Epoch 19/50
444/444 - 30s - loss: 3.1729 - accuracy30: 0.4357 - val_loss: 3.2324 - val_accuracy30: 0.4082 - 30s/epoch - 67ms/step
Epoch 20/50
444/444 - 33s - loss: 3.1706 - accuracy30: 0.4366 - val_loss: 3.2307 - val_accuracy30: 0.4084 - 33s/epoch - 74ms/step
Epoch 21/50
444/444 - 31s - loss: 3.1649 - accuracy30: 0.4376 - val_loss: 3.2305 - val_accuracy30: 0.4125 - 31s/epoch - 70ms/step
Epoch 22/50
444/444 - 33s - loss: 3.1597 - accuracy30: 0.4405 - val_loss: 3.2309 - val_accuracy30: 0.4124 - 33s/epoch - 74ms/step
Epoch 23/50
444/444 - 33s - loss: 3.1557 - accuracy30: 0.4448 - val_loss: 3.2277 - val_accuracy30: 0.4140 - 33s/epoch - 75ms/step
Epoch 24/50
444/444 - 29s - loss: 3.1504 - accuracy30: 0.4443 - val_loss: 3.2310 - val_accuracy30: 0.4122 - 29s/epoch - 66ms/step
Epoch 25/50
444/444 - 28s - loss: 3.1478 - accuracy30: 0.4455 - val_loss: 3.2327 - val_accuracy30: 0.4115 - 28s/epoch - 64ms/step
Epoch 26/50
444/444 - 33s - loss: 3.1447 - accuracy30: 0.4461 - val_loss: 3.2360 - val_accuracy30: 0.4069 - 33s/epoch - 75ms/step
testing model: results/XRAY/W3/deepVOL_L3/h30
Evaluating performance on  test set...
1359/1359 - 38s - 38s/epoch - 28ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0848783
{'0': {'precision': 0.397207296992807, 'recall': 0.3202973497091144, 'f1-score': 0.35463030127182166, 'support': 114478}, '1': {'precision': 0.399603477199939, 'recall': 0.43271541224557203, 'f1-score': 0.4155008027909374, 'support': 121105}, '2': {'precision': 0.40273745667436006, 'recall': 0.44627421625764135, 'f1-score': 0.42338956828298113, 'support': 112218}, 'accuracy': 0.40008798134565454, 'macro avg': {'precision': 0.3998494102890353, 'recall': 0.39976232607077594, 'f1-score': 0.3978402241152467, 'support': 347801}, 'weighted avg': {'precision': 0.39982595784521746, 'recall': 0.40008798134565454, 'f1-score': 0.39801070993059723, 'support': 347801}}
[[36667 43174 34637]
 [29069 52404 39632]
 [26576 35562 50080]]
Evaluating performance on  train set...
444/444 - 15s - 15s/epoch - 33ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0746644
{'0': {'precision': 0.40709016791225855, 'recall': 0.4475298762270593, 'f1-score': 0.4263532401524777, 'support': 37488}, '1': {'precision': 0.43224498986714704, 'recall': 0.25541540262919793, 'f1-score': 0.3210946255624509, 'support': 37578}, '2': {'precision': 0.4031132902814319, 'recall': 0.5250110323702724, 'f1-score': 0.45605727493094317, 'support': 38523}, 'accuracy': 0.4102509926137214, 'macro avg': {'precision': 0.41414948268694585, 'recall': 0.40931877040884324, 'f1-score': 0.40116838021529055, 'support': 113589}, 'weighted avg': {'precision': 0.4140632607509002, 'recall': 0.4102509926137214, 'f1-score': 0.40160507186775646, 'support': 113589}}
[[16777  6907 13804]
 [11837  9598 16143]
 [12598  5700 20225]]
Evaluating performance on  val set...
144/144 - 5s - 5s/epoch - 32ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0754524
{'0': {'precision': 0.4163636363636364, 'recall': 0.4081665721461557, 'f1-score': 0.41222435871210567, 'support': 12343}, '1': {'precision': 0.4234527687296417, 'recall': 0.32491877030742317, 'f1-score': 0.36769905246782636, 'support': 12003}, '2': {'precision': 0.396034437777198, 'recall': 0.49381912817176316, 'f1-score': 0.43955407557550313, 'support': 12296}, 'accuracy': 0.40963921183341523, 'macro avg': {'precision': 0.4119502809568254, 'recall': 0.408968156875114, 'f1-score': 0.40649249558514505, 'support': 36642}, 'weighted avg': {'precision': 0.4118639646745996, 'recall': 0.40963921183341523, 'f1-score': 0.40681005129717884, 'support': 36642}}
[[5038 2910 4395]
 [3238 3900 4865]
 [3824 2400 6072]]
training model: results/XRAY/W3/deepVOL_L3/h50
Epoch 1/50
444/444 - 41s - loss: 3.3149 - accuracy50: 0.3637 - val_loss: 3.3344 - val_accuracy50: 0.3161 - 41s/epoch - 92ms/step
Epoch 2/50
444/444 - 29s - loss: 3.3003 - accuracy50: 0.3621 - val_loss: 3.3272 - val_accuracy50: 0.3126 - 29s/epoch - 65ms/step
Epoch 3/50
444/444 - 27s - loss: 3.2971 - accuracy50: 0.3564 - val_loss: 3.3104 - val_accuracy50: 0.3176 - 27s/epoch - 62ms/step
Epoch 4/50
444/444 - 34s - loss: 3.2956 - accuracy50: 0.3524 - val_loss: 3.2900 - val_accuracy50: 0.3550 - 34s/epoch - 77ms/step
Epoch 5/50
444/444 - 31s - loss: 3.2878 - accuracy50: 0.3592 - val_loss: 3.2830 - val_accuracy50: 0.3641 - 31s/epoch - 70ms/step
Epoch 6/50
444/444 - 29s - loss: 3.2848 - accuracy50: 0.3633 - val_loss: 3.2735 - val_accuracy50: 0.3747 - 29s/epoch - 66ms/step
Epoch 7/50
444/444 - 29s - loss: 3.2804 - accuracy50: 0.3673 - val_loss: 3.2699 - val_accuracy50: 0.3773 - 29s/epoch - 66ms/step
Epoch 8/50
444/444 - 29s - loss: 3.2754 - accuracy50: 0.3730 - val_loss: 3.2643 - val_accuracy50: 0.3767 - 29s/epoch - 64ms/step
Epoch 9/50
444/444 - 32s - loss: 3.2713 - accuracy50: 0.3768 - val_loss: 3.2613 - val_accuracy50: 0.3813 - 32s/epoch - 73ms/step
Epoch 10/50
444/444 - 31s - loss: 3.2674 - accuracy50: 0.3833 - val_loss: 3.2601 - val_accuracy50: 0.3815 - 31s/epoch - 70ms/step
Epoch 11/50
444/444 - 31s - loss: 3.2642 - accuracy50: 0.3833 - val_loss: 3.2586 - val_accuracy50: 0.3850 - 31s/epoch - 70ms/step
Epoch 12/50
444/444 - 31s - loss: 3.2621 - accuracy50: 0.3840 - val_loss: 3.2570 - val_accuracy50: 0.3823 - 31s/epoch - 69ms/step
Epoch 13/50
444/444 - 32s - loss: 3.2583 - accuracy50: 0.3863 - val_loss: 3.2583 - val_accuracy50: 0.3833 - 32s/epoch - 73ms/step
Epoch 14/50
444/444 - 29s - loss: 3.2555 - accuracy50: 0.3911 - val_loss: 3.2562 - val_accuracy50: 0.3818 - 29s/epoch - 66ms/step
Epoch 15/50
444/444 - 27s - loss: 3.2507 - accuracy50: 0.3945 - val_loss: 3.2579 - val_accuracy50: 0.3826 - 27s/epoch - 61ms/step
Epoch 16/50
444/444 - 33s - loss: 3.2464 - accuracy50: 0.3965 - val_loss: 3.2623 - val_accuracy50: 0.3835 - 33s/epoch - 73ms/step
Epoch 17/50
444/444 - 33s - loss: 3.2430 - accuracy50: 0.3992 - val_loss: 3.2591 - val_accuracy50: 0.3890 - 33s/epoch - 74ms/step
Epoch 18/50
444/444 - 31s - loss: 3.2417 - accuracy50: 0.4002 - val_loss: 3.2594 - val_accuracy50: 0.3859 - 31s/epoch - 70ms/step
Epoch 19/50
444/444 - 30s - loss: 3.2343 - accuracy50: 0.4044 - val_loss: 3.2626 - val_accuracy50: 0.3860 - 30s/epoch - 67ms/step
Epoch 20/50
444/444 - 27s - loss: 3.2301 - accuracy50: 0.4075 - val_loss: 3.2615 - val_accuracy50: 0.3837 - 27s/epoch - 61ms/step
Epoch 21/50
444/444 - 29s - loss: 3.2236 - accuracy50: 0.4096 - val_loss: 3.2579 - val_accuracy50: 0.3879 - 29s/epoch - 66ms/step
Epoch 22/50
444/444 - 32s - loss: 3.2193 - accuracy50: 0.4121 - val_loss: 3.2585 - val_accuracy50: 0.3890 - 32s/epoch - 73ms/step
Epoch 23/50
444/444 - 32s - loss: 3.2177 - accuracy50: 0.4138 - val_loss: 3.2629 - val_accuracy50: 0.3929 - 32s/epoch - 72ms/step
Epoch 24/50
444/444 - 33s - loss: 3.2102 - accuracy50: 0.4174 - val_loss: 3.2645 - val_accuracy50: 0.3879 - 33s/epoch - 74ms/step
testing model: results/XRAY/W3/deepVOL_L3/h50
Evaluating performance on  test set...
1359/1359 - 40s - 40s/epoch - 30ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.105464
{'0': {'precision': 0.3793371407171613, 'recall': 0.32416193295463636, 'f1-score': 0.34958584987057806, 'support': 124990}, '1': {'precision': 0.31856682552239096, 'recall': 0.4901491237618374, 'f1-score': 0.38615598104028936, 'support': 101057}, '2': {'precision': 0.381233626497006, 'recall': 0.2677283703204823, 'f1-score': 0.3145548060870992, 'support': 121754}, 'accuracy': 0.3526355588396813, 'macro avg': {'precision': 0.3597125309121861, 'recall': 0.36067980901231866, 'f1-score': 0.35009887899932224, 'support': 347801}, 'weighted avg': {'precision': 0.3623436271476238, 'recall': 0.3526355588396813, 'f1-score': 0.34794841363780077, 'support': 347801}}
[[40517 54785 29688]
 [28305 49533 23219]
 [37988 51169 32597]]
Evaluating performance on  train set...
444/444 - 15s - 15s/epoch - 33ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0864146
{'0': {'precision': 0.3700060694776679, 'recall': 0.5540349095185908, 'f1-score': 0.44369521240728255, 'support': 37411}, '1': {'precision': 0.421023136658394, 'recall': 0.2807045636509207, 'f1-score': 0.3368346890411836, 'support': 37470}, '2': {'precision': 0.3659823866948971, 'recall': 0.3081275188591506, 'f1-score': 0.33457228214370877, 'support': 38708}, 'accuracy': 0.38007201401544166, 'macro avg': {'precision': 0.385670530943653, 'recall': 0.380955664009554, 'f1-score': 0.3717007278640583, 'support': 113589}, 'weighted avg': {'precision': 0.38546408736766, 'recall': 0.38007201401544166, 'f1-score': 0.3712586719397184, 'support': 113589}}
[[20727  7082  9602]
 [15892 10518 11060]
 [19399  7382 11927]]
Evaluating performance on  val set...
144/144 - 5s - 5s/epoch - 32ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0852228
{'0': {'precision': 0.38054565564704435, 'recall': 0.48717747010698553, 'f1-score': 0.4273097357344925, 'support': 12712}, '1': {'precision': 0.3958629081322247, 'recall': 0.3468988803980807, 'f1-score': 0.36976700132600876, 'support': 11254}, '2': {'precision': 0.36950314106225013, 'recall': 0.30624802776901233, 'f1-score': 0.33491502027435077, 'support': 12676}, 'accuracy': 0.3815021014136783, 'macro avg': {'precision': 0.3819705682805064, 'recall': 0.3801081260913595, 'f1-score': 0.377330585778284, 'support': 36642}, 'weighted avg': {'precision': 0.3814300354459464, 'recall': 0.3815021014136783, 'f1-score': 0.37767321627033024, 'support': 36642}}
[[6193 2926 3593]
 [4319 3904 3031]
 [5762 3032 3882]]
training model: results/XRAY/W3/deepVOL_L3/h100
Epoch 1/50
444/444 - 34s - loss: 3.3323 - accuracy100: 0.3573 - val_loss: 3.3314 - val_accuracy100: 0.3391 - 34s/epoch - 77ms/step
Epoch 2/50
444/444 - 27s - loss: 3.3076 - accuracy100: 0.3547 - val_loss: 3.2977 - val_accuracy100: 0.3531 - 27s/epoch - 62ms/step
Epoch 3/50
444/444 - 30s - loss: 3.3022 - accuracy100: 0.3459 - val_loss: 3.2912 - val_accuracy100: 0.3555 - 30s/epoch - 67ms/step
Epoch 4/50
444/444 - 31s - loss: 3.2944 - accuracy100: 0.3530 - val_loss: 3.2888 - val_accuracy100: 0.3574 - 31s/epoch - 69ms/step
Epoch 5/50
444/444 - 30s - loss: 3.2879 - accuracy100: 0.3585 - val_loss: 3.2887 - val_accuracy100: 0.3566 - 30s/epoch - 67ms/step
Epoch 6/50
444/444 - 33s - loss: 3.2820 - accuracy100: 0.3629 - val_loss: 3.2915 - val_accuracy100: 0.3604 - 33s/epoch - 74ms/step
Epoch 7/50
444/444 - 29s - loss: 3.2755 - accuracy100: 0.3727 - val_loss: 3.2897 - val_accuracy100: 0.3595 - 29s/epoch - 65ms/step
Epoch 8/50
444/444 - 30s - loss: 3.2707 - accuracy100: 0.3765 - val_loss: 3.2862 - val_accuracy100: 0.3621 - 30s/epoch - 67ms/step
Epoch 9/50
444/444 - 30s - loss: 3.2658 - accuracy100: 0.3805 - val_loss: 3.2896 - val_accuracy100: 0.3590 - 30s/epoch - 67ms/step
Epoch 10/50
444/444 - 30s - loss: 3.2616 - accuracy100: 0.3865 - val_loss: 3.2915 - val_accuracy100: 0.3519 - 30s/epoch - 67ms/step
Epoch 11/50
444/444 - 31s - loss: 3.2557 - accuracy100: 0.3892 - val_loss: 3.3026 - val_accuracy100: 0.3487 - 31s/epoch - 69ms/step
Epoch 12/50
444/444 - 31s - loss: 3.2493 - accuracy100: 0.3945 - val_loss: 3.3054 - val_accuracy100: 0.3584 - 31s/epoch - 69ms/step
Epoch 13/50
444/444 - 29s - loss: 3.2413 - accuracy100: 0.3982 - val_loss: 3.3116 - val_accuracy100: 0.3503 - 29s/epoch - 65ms/step
Epoch 14/50
444/444 - 31s - loss: 3.2349 - accuracy100: 0.4008 - val_loss: 3.3364 - val_accuracy100: 0.3414 - 31s/epoch - 71ms/step
Epoch 15/50
444/444 - 28s - loss: 3.2318 - accuracy100: 0.4036 - val_loss: 3.3516 - val_accuracy100: 0.3417 - 28s/epoch - 63ms/step
Epoch 16/50
444/444 - 30s - loss: 3.2250 - accuracy100: 0.4064 - val_loss: 3.3408 - val_accuracy100: 0.3476 - 30s/epoch - 68ms/step
Epoch 17/50
444/444 - 30s - loss: 3.2182 - accuracy100: 0.4107 - val_loss: 3.3455 - val_accuracy100: 0.3489 - 30s/epoch - 67ms/step
Epoch 18/50
444/444 - 29s - loss: 3.2075 - accuracy100: 0.4141 - val_loss: 3.3756 - val_accuracy100: 0.3433 - 29s/epoch - 66ms/step
testing model: results/XRAY/W3/deepVOL_L3/h100
Evaluating performance on  test set...
1359/1359 - 41s - 41s/epoch - 30ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0912935
{'0': {'precision': 0.3114679723679818, 'recall': 0.34911009834492684, 'f1-score': 0.32921654316296156, 'support': 104225}, '1': {'precision': 0.4469461011707533, 'recall': 0.5646895473859743, 'f1-score': 0.4989657925481578, 'support': 143323}, '2': {'precision': 0.31236472945891786, 'recall': 0.15547664409045117, 'f1-score': 0.20761489946920808, 'support': 100253}, 'accuracy': 0.382132311292952, 'macro avg': {'precision': 0.35692626766588426, 'recall': 0.3564254299404508, 'f1-score': 0.3452657450601091, 'support': 347801}, 'weighted avg': {'precision': 0.3675547416499483, 'recall': 0.382132311292952, 'f1-score': 0.36411593127399233, 'support': 347801}}
[[36386 51999 15840]
 [43917 80933 18473]
 [36518 48148 15587]]
Evaluating performance on  train set...
444/444 - 14s - 14s/epoch - 32ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0933752
{'0': {'precision': 0.3514989725846959, 'recall': 0.5391993103076674, 'f1-score': 0.4255717277820896, 'support': 37118}, '1': {'precision': 0.39566354915345986, 'recall': 0.3477559866786488, 'f1-score': 0.3701661344549636, 'support': 37834}, '2': {'precision': 0.36602983288455787, 'recall': 0.2216528198359086, 'f1-score': 0.2761066511912822, 'support': 38637}, 'accuracy': 0.36742114113162366, 'macro avg': {'precision': 0.3710641182075712, 'recall': 0.3695360389407416, 'f1-score': 0.3572815044761118, 'support': 113589}, 'weighted avg': {'precision': 0.37115185657265587, 'recall': 0.36742114113162366, 'f1-score': 0.35627718885510273, 'support': 113589}}
[[20014  9940  7164]
 [17008 13157  7669]
 [19917 10156  8564]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 28ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0959744
{'0': {'precision': 0.3530365831681384, 'recall': 0.474449019132962, 'f1-score': 0.40483570985740863, 'support': 12387}, '1': {'precision': 0.36583268178264267, 'recall': 0.39302813943721127, 'f1-score': 0.3789431058918809, 'support': 11905}, '2': {'precision': 0.3551700208188758, 'recall': 0.20720647773279352, 'f1-score': 0.26172334441319356, 'support': 12350}, 'accuracy': 0.35792260247803065, 'macro avg': {'precision': 0.3580130952565523, 'recall': 0.3582278787676556, 'f1-score': 0.34850072005416105, 'support': 36642}, 'weighted avg': {'precision': 0.35791310489163275, 'recall': 0.35792260247803065, 'f1-score': 0.34818789687106333, 'support': 36642}}
[[5877 4109 2401]
 [4981 4679 2245]
 [5789 4002 2559]]
training model: results/XRAY/W3/deepVOL_L3/h200
Epoch 1/50
444/444 - 45s - loss: 3.3239 - accuracy200: 0.3609 - val_loss: 3.3484 - val_accuracy200: 0.3309 - 45s/epoch - 102ms/step
Epoch 2/50
444/444 - 30s - loss: 3.3118 - accuracy200: 0.3562 - val_loss: 3.3406 - val_accuracy200: 0.3368 - 30s/epoch - 67ms/step
Epoch 3/50
444/444 - 32s - loss: 3.3051 - accuracy200: 0.3513 - val_loss: 3.3057 - val_accuracy200: 0.3381 - 32s/epoch - 72ms/step
Epoch 4/50
444/444 - 28s - loss: 3.2936 - accuracy200: 0.3540 - val_loss: 3.2748 - val_accuracy200: 0.3777 - 28s/epoch - 63ms/step
Epoch 5/50
444/444 - 34s - loss: 3.2810 - accuracy200: 0.3707 - val_loss: 3.2694 - val_accuracy200: 0.3796 - 34s/epoch - 76ms/step
Epoch 6/50
444/444 - 32s - loss: 3.2698 - accuracy200: 0.3792 - val_loss: 3.2931 - val_accuracy200: 0.3679 - 32s/epoch - 72ms/step
Epoch 7/50
444/444 - 31s - loss: 3.2630 - accuracy200: 0.3825 - val_loss: 3.3122 - val_accuracy200: 0.3660 - 31s/epoch - 69ms/step
Epoch 8/50
444/444 - 30s - loss: 3.2562 - accuracy200: 0.3864 - val_loss: 3.3688 - val_accuracy200: 0.3563 - 30s/epoch - 67ms/step
Epoch 9/50
444/444 - 29s - loss: 3.2493 - accuracy200: 0.3920 - val_loss: 3.3243 - val_accuracy200: 0.3731 - 29s/epoch - 66ms/step
Epoch 10/50
444/444 - 30s - loss: 3.2444 - accuracy200: 0.3936 - val_loss: 3.3201 - val_accuracy200: 0.3764 - 30s/epoch - 68ms/step
Epoch 11/50
444/444 - 29s - loss: 3.2390 - accuracy200: 0.3967 - val_loss: 3.3580 - val_accuracy200: 0.3655 - 29s/epoch - 65ms/step
Epoch 12/50
444/444 - 29s - loss: 3.2333 - accuracy200: 0.4016 - val_loss: 3.3310 - val_accuracy200: 0.3752 - 29s/epoch - 66ms/step
Epoch 13/50
444/444 - 32s - loss: 3.2284 - accuracy200: 0.4026 - val_loss: 3.3415 - val_accuracy200: 0.3743 - 32s/epoch - 73ms/step
Epoch 14/50
444/444 - 29s - loss: 3.2262 - accuracy200: 0.4040 - val_loss: 3.3579 - val_accuracy200: 0.3699 - 29s/epoch - 66ms/step
Epoch 15/50
444/444 - 30s - loss: 3.2199 - accuracy200: 0.4068 - val_loss: 3.3165 - val_accuracy200: 0.3774 - 30s/epoch - 68ms/step
testing model: results/XRAY/W3/deepVOL_L3/h200
Evaluating performance on  test set...
1359/1359 - 39s - 39s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.06944
{'0': {'precision': 0.3445425545039567, 'recall': 0.197684295682071, 'f1-score': 0.2512256713080467, 'support': 98890}, '1': {'precision': 0.47693534872318394, 'recall': 0.845660269635512, 'f1-score': 0.6098996095276197, 'support': 154134}, '2': {'precision': 0.3378553335209682, 'recall': 0.06332760057819935, 'f1-score': 0.10666240159229443, 'support': 94777}, 'accuracy': 0.44823332882884176, 'macro avg': {'precision': 0.3864444122493696, 'recall': 0.3688907219652608, 'f1-score': 0.3225958941426536, 'support': 347801}, 'weighted avg': {'precision': 0.4013924088778132, 'recall': 0.44823332882884176, 'f1-score': 0.3707841998335133, 'support': 347801}}
[[ 19549  73655   5686]
 [ 17712 130345   6077]
 [ 19478  69297   6002]]
Evaluating performance on  train set...
444/444 - 13s - 13s/epoch - 30ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.090353
{'0': {'precision': 0.3560255119167506, 'recall': 0.42740852184192146, 'f1-score': 0.3884649663642912, 'support': 37222}, '1': {'precision': 0.3902311279313374, 'recall': 0.6142655780431372, 'f1-score': 0.4772649784582959, 'support': 37601}, '2': {'precision': 0.37484561547962125, 'recall': 0.09394830521591085, 'f1-score': 0.15024132667794235, 'support': 38766}, 'accuracy': 0.3754588912658796, 'macro avg': {'precision': 0.37370075177590306, 'recall': 0.37854080170032317, 'f1-score': 0.33865709050017645, 'support': 113589}, 'weighted avg': {'precision': 0.37377146885344975, 'recall': 0.3754588912658796, 'f1-score': 0.3365584581519262, 'support': 113589}}
[[15909 18060  3253]
 [11683 23097  2821]
 [17093 18031  3642]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0902075
{'0': {'precision': 0.3814971400149217, 'recall': 0.37094954054489765, 'f1-score': 0.3761494135436675, 'support': 12406}, '1': {'precision': 0.3818692902319044, 'recall': 0.6691019537021835, 'f1-score': 0.4862349747964327, 'support': 12182}, '2': {'precision': 0.34724799010513296, 'recall': 0.09316409490625518, 'f1-score': 0.14691261119832547, 'support': 12054}, 'accuracy': 0.3786911194803777, 'macro avg': {'precision': 0.3702048067839863, 'recall': 0.3777385297177787, 'f1-score': 0.3364323331794752, 'support': 36642}, 'weighted avg': {'precision': 0.3703540332230078, 'recall': 0.3786911194803777, 'f1-score': 0.33733717326503726, 'support': 36642}}
[[4602 6673 1131]
 [3051 8151  980]
 [4410 6521 1123]]
training model: results/XRAY/W3/deepVOL_L3/h300
Epoch 1/50
444/444 - 33s - loss: 3.3264 - accuracy300: 0.3639 - val_loss: 3.4595 - val_accuracy300: 0.3120 - 33s/epoch - 74ms/step
Epoch 2/50
444/444 - 29s - loss: 3.3121 - accuracy300: 0.3569 - val_loss: 3.3588 - val_accuracy300: 0.3124 - 29s/epoch - 65ms/step
Epoch 3/50
444/444 - 29s - loss: 3.3024 - accuracy300: 0.3490 - val_loss: 3.3110 - val_accuracy300: 0.3305 - 29s/epoch - 66ms/step
Epoch 4/50
444/444 - 31s - loss: 3.2908 - accuracy300: 0.3601 - val_loss: 3.3077 - val_accuracy300: 0.3415 - 31s/epoch - 70ms/step
Epoch 5/50
444/444 - 31s - loss: 3.2823 - accuracy300: 0.3670 - val_loss: 3.3295 - val_accuracy300: 0.3242 - 31s/epoch - 69ms/step
Epoch 6/50
444/444 - 28s - loss: 3.2763 - accuracy300: 0.3735 - val_loss: 3.3205 - val_accuracy300: 0.3271 - 28s/epoch - 64ms/step
Epoch 7/50
444/444 - 28s - loss: 3.2696 - accuracy300: 0.3763 - val_loss: 3.3235 - val_accuracy300: 0.3295 - 28s/epoch - 62ms/step
Epoch 8/50
444/444 - 30s - loss: 3.2620 - accuracy300: 0.3810 - val_loss: 3.3283 - val_accuracy300: 0.3327 - 30s/epoch - 68ms/step
Epoch 9/50
444/444 - 29s - loss: 3.2572 - accuracy300: 0.3849 - val_loss: 3.3330 - val_accuracy300: 0.3309 - 29s/epoch - 65ms/step
Epoch 10/50
444/444 - 31s - loss: 3.2493 - accuracy300: 0.3902 - val_loss: 3.3314 - val_accuracy300: 0.3400 - 31s/epoch - 69ms/step
Epoch 11/50
444/444 - 30s - loss: 3.2467 - accuracy300: 0.3919 - val_loss: 3.3244 - val_accuracy300: 0.3482 - 30s/epoch - 68ms/step
Epoch 12/50
444/444 - 28s - loss: 3.2397 - accuracy300: 0.3956 - val_loss: 3.3446 - val_accuracy300: 0.3393 - 28s/epoch - 63ms/step
Epoch 13/50
444/444 - 29s - loss: 3.2334 - accuracy300: 0.4001 - val_loss: 3.3310 - val_accuracy300: 0.3510 - 29s/epoch - 65ms/step
Epoch 14/50
444/444 - 30s - loss: 3.2270 - accuracy300: 0.4046 - val_loss: 3.3411 - val_accuracy300: 0.3464 - 30s/epoch - 67ms/step
testing model: results/XRAY/W3/deepVOL_L3/h300
Evaluating performance on  test set...
1359/1359 - 45s - 45s/epoch - 33ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0727775
{'0': {'precision': 0.31788292761480447, 'recall': 0.11611537028685712, 'f1-score': 0.17009787377657778, 'support': 102002}, '1': {'precision': 0.4384102592887307, 'recall': 0.9017195012631407, 'f1-score': 0.5899773171094755, 'support': 147252}, '2': {'precision': 0.3962214983713355, 'recall': 0.030858372147300275, 'f1-score': 0.05725744196117565, 'support': 98547}, 'accuracy': 0.4245674969307161, 'macro avg': {'precision': 0.3841715617582902, 'recall': 0.3495644145657661, 'f1-score': 0.27244421094907634, 'support': 347801}, 'weighted avg': {'precision': 0.3911084841140464, 'recall': 0.4245674969307161, 'f1-score': 0.3158938943617498, 'support': 347801}}
[[ 11844  88022   2136]
 [ 11974 132780   2498]
 [ 13441  82065   3041]]
Evaluating performance on  train set...
444/444 - 12s - 12s/epoch - 28ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099634
{'0': {'precision': 0.3554637626736763, 'recall': 0.2537665540721677, 'f1-score': 0.2961271350810236, 'support': 37302}, '1': {'precision': 0.34853726449777606, 'recall': 0.7781844605323358, 'f1-score': 0.48144324747331796, 'support': 37157}, '2': {'precision': 0.3776888444222111, 'recall': 0.038589317659085104, 'f1-score': 0.07002411426451495, 'support': 39130}, 'accuracy': 0.35118717481446265, 'macro avg': {'precision': 0.3605632905312211, 'recall': 0.35684677742119614, 'f1-score': 0.2825314989396189, 'support': 113589}, 'weighted avg': {'precision': 0.3608542455205914, 'recall': 0.35118717481446265, 'f1-score': 0.27885767750687906, 'support': 113589}}
[[ 9466 26509  1327]
 [ 7081 28915  1161]
 [10083 27537  1510]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 28ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1046344
{'0': {'precision': 0.38741077222582737, 'recall': 0.2326215710723192, 'f1-score': 0.29069484345327945, 'support': 12832}, '1': {'precision': 0.3258100398292009, 'recall': 0.7968407196138657, 'f1-score': 0.46251018744906275, 'support': 11395}, '2': {'precision': 0.3960674157303371, 'recall': 0.03407168747482884, 'f1-score': 0.0627456797448639, 'support': 12415}, 'accuracy': 0.3408110910976475, 'macro avg': {'precision': 0.3697627425951218, 'recall': 0.35451132605367125, 'f1-score': 0.2719835702157353, 'support': 36642}, 'weighted avg': {'precision': 0.3711870912981741, 'recall': 0.3408110910976475, 'f1-score': 0.2668928396705157, 'support': 36642}}
[[2985 9487  360]
 [2030 9080  285]
 [2690 9302  423]]
training model: results/XRAY/W3/deepVOL_L3/h500
Epoch 1/50
444/444 - 37s - loss: 3.3387 - accuracy500: 0.3568 - val_loss: 3.3931 - val_accuracy500: 0.3133 - 37s/epoch - 83ms/step
Epoch 2/50
444/444 - 30s - loss: 3.3195 - accuracy500: 0.3469 - val_loss: 3.3397 - val_accuracy500: 0.3151 - 30s/epoch - 67ms/step
Epoch 3/50
444/444 - 28s - loss: 3.3075 - accuracy500: 0.3406 - val_loss: 3.3548 - val_accuracy500: 0.3147 - 28s/epoch - 63ms/step
Epoch 4/50
444/444 - 29s - loss: 3.3004 - accuracy500: 0.3430 - val_loss: 3.3188 - val_accuracy500: 0.3241 - 29s/epoch - 66ms/step
Epoch 5/50
444/444 - 31s - loss: 3.2915 - accuracy500: 0.3522 - val_loss: 3.3174 - val_accuracy500: 0.3094 - 31s/epoch - 71ms/step
Epoch 6/50
444/444 - 28s - loss: 3.2840 - accuracy500: 0.3608 - val_loss: 3.3177 - val_accuracy500: 0.3122 - 28s/epoch - 62ms/step
Epoch 7/50
444/444 - 29s - loss: 3.2783 - accuracy500: 0.3649 - val_loss: 3.3159 - val_accuracy500: 0.3132 - 29s/epoch - 66ms/step
Epoch 8/50
444/444 - 31s - loss: 3.2759 - accuracy500: 0.3700 - val_loss: 3.3137 - val_accuracy500: 0.3113 - 31s/epoch - 70ms/step
Epoch 9/50
444/444 - 28s - loss: 3.2734 - accuracy500: 0.3679 - val_loss: 3.3089 - val_accuracy500: 0.3153 - 28s/epoch - 62ms/step
Epoch 10/50
444/444 - 28s - loss: 3.2730 - accuracy500: 0.3685 - val_loss: 3.3148 - val_accuracy500: 0.3191 - 28s/epoch - 64ms/step
Epoch 11/50
444/444 - 30s - loss: 3.2641 - accuracy500: 0.3750 - val_loss: 3.3164 - val_accuracy500: 0.3254 - 30s/epoch - 67ms/step
Epoch 12/50
444/444 - 27s - loss: 3.2587 - accuracy500: 0.3792 - val_loss: 3.3173 - val_accuracy500: 0.3357 - 27s/epoch - 60ms/step
Epoch 13/50
444/444 - 30s - loss: 3.2511 - accuracy500: 0.3851 - val_loss: 3.3313 - val_accuracy500: 0.3370 - 30s/epoch - 67ms/step
Epoch 14/50
444/444 - 30s - loss: 3.2480 - accuracy500: 0.3880 - val_loss: 3.3442 - val_accuracy500: 0.3345 - 30s/epoch - 68ms/step
Epoch 15/50
444/444 - 28s - loss: 3.2429 - accuracy500: 0.3907 - val_loss: 3.3681 - val_accuracy500: 0.3265 - 28s/epoch - 64ms/step
Epoch 16/50
444/444 - 31s - loss: 3.2389 - accuracy500: 0.3925 - val_loss: 3.3561 - val_accuracy500: 0.3431 - 31s/epoch - 70ms/step
Epoch 17/50
444/444 - 30s - loss: 3.2362 - accuracy500: 0.3952 - val_loss: 3.3494 - val_accuracy500: 0.3316 - 30s/epoch - 68ms/step
Epoch 18/50
444/444 - 29s - loss: 3.2273 - accuracy500: 0.4016 - val_loss: 3.3681 - val_accuracy500: 0.3277 - 29s/epoch - 65ms/step
Epoch 19/50
444/444 - 32s - loss: 3.2230 - accuracy500: 0.4036 - val_loss: 3.3731 - val_accuracy500: 0.3339 - 32s/epoch - 72ms/step
testing model: results/XRAY/W3/deepVOL_L3/h500
Evaluating performance on  test set...
1359/1359 - 42s - 42s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0865148
{'0': {'precision': 0.29283759428609574, 'recall': 0.044246091780131114, 'f1-score': 0.07687657165888322, 'support': 99150}, '1': {'precision': 0.4332637661577808, 'recall': 0.9564322949608197, 'f1-score': 0.5963713502305009, 'support': 150203}, '2': {'precision': 0.35714285714285715, 'recall': 0.004520152771006014, 'f1-score': 0.008927317591831003, 'support': 98448}, 'accuracy': 0.42694241822191425, 'macro avg': {'precision': 0.3610814058622445, 'recall': 0.3350661798373189, 'f1-score': 0.22739174649373836, 'support': 347801}, 'weighted avg': {'precision': 0.3716848569775922, 'recall': 0.42694241822191425, 'f1-score': 0.2819944582129746, 'support': 347801}}
[[  4387  94352    411]
 [  6154 143659    390]
 [  4440  93563    445]]
Evaluating performance on  train set...
444/444 - 12s - 12s/epoch - 27ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1022825
{'0': {'precision': 0.33442922374429224, 'recall': 0.04898865582191781, 'f1-score': 0.08545891577792816, 'support': 37376}, '1': {'precision': 0.33080304751969897, 'recall': 0.947397903384993, 'f1-score': 0.4903800352076214, 'support': 37489}, '2': {'precision': 0.393048128342246, 'recall': 0.007592190889370932, 'f1-score': 0.014896635589785165, 'support': 38724}, 'accuracy': 0.3313877224026974, 'macro avg': {'precision': 0.3527601332020791, 'recall': 0.3346595833654273, 'f1-score': 0.19691186219177825, 'support': 113589}, 'weighted avg': {'precision': 0.35321640156227985, 'recall': 0.3313877224026974, 'f1-score': 0.1950437708985307, 'support': 113589}}
[[ 1831 35305   240]
 [ 1758 35517   214]
 [ 1886 36544   294]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 28ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1036993
{'0': {'precision': 0.3494318181818182, 'recall': 0.047848751264296274, 'f1-score': 0.08417162800246357, 'support': 12853}, '1': {'precision': 0.3108933717579251, 'recall': 0.94681411269089, 'f1-score': 0.46808695274873086, 'support': 11394}, '2': {'precision': 0.3956043956043956, 'recall': 0.005808793868495361, 'f1-score': 0.011449471257056532, 'support': 12395}, 'accuracy': 0.3131652202390699, 'macro avg': {'precision': 0.35197652851471295, 'recall': 0.3334905526078939, 'f1-score': 0.18790268400275031, 'support': 36642}, 'weighted avg': {'precision': 0.35306704656997956, 'recall': 0.3131652202390699, 'f1-score': 0.17895193686386984, 'support': 36642}}
[[  615 12170    68]
 [  564 10788    42]
 [  581 11742    72]]
training model: results/XRAY/W3/deepVOL_L3/h1000
Epoch 1/50
444/444 - 43s - loss: 3.3347 - accuracy1000: 0.3707 - val_loss: 3.3552 - val_accuracy1000: 0.3360 - 43s/epoch - 97ms/step
Epoch 2/50
444/444 - 32s - loss: 3.3199 - accuracy1000: 0.3364 - val_loss: 3.3084 - val_accuracy1000: 0.3374 - 32s/epoch - 73ms/step
Epoch 3/50
444/444 - 30s - loss: 3.3065 - accuracy1000: 0.3365 - val_loss: 3.3063 - val_accuracy1000: 0.3363 - 30s/epoch - 67ms/step
Epoch 4/50
444/444 - 31s - loss: 3.3051 - accuracy1000: 0.3371 - val_loss: 3.2977 - val_accuracy1000: 0.3391 - 31s/epoch - 70ms/step
Epoch 5/50
444/444 - 28s - loss: 3.3016 - accuracy1000: 0.3470 - val_loss: 3.2946 - val_accuracy1000: 0.3526 - 28s/epoch - 62ms/step
Epoch 6/50
444/444 - 30s - loss: 3.2954 - accuracy1000: 0.3613 - val_loss: 3.2895 - val_accuracy1000: 0.3617 - 30s/epoch - 69ms/step
Epoch 7/50
444/444 - 32s - loss: 3.2970 - accuracy1000: 0.3671 - val_loss: 3.2976 - val_accuracy1000: 0.3485 - 32s/epoch - 72ms/step
Epoch 8/50
444/444 - 29s - loss: 3.2936 - accuracy1000: 0.3633 - val_loss: 3.2882 - val_accuracy1000: 0.3681 - 29s/epoch - 66ms/step
Epoch 9/50
444/444 - 28s - loss: 3.2800 - accuracy1000: 0.3777 - val_loss: 3.2903 - val_accuracy1000: 0.3720 - 28s/epoch - 63ms/step
Epoch 10/50
444/444 - 28s - loss: 3.2718 - accuracy1000: 0.3839 - val_loss: 3.2906 - val_accuracy1000: 0.3712 - 28s/epoch - 63ms/step
Epoch 11/50
444/444 - 27s - loss: 3.2683 - accuracy1000: 0.3870 - val_loss: 3.2920 - val_accuracy1000: 0.3718 - 27s/epoch - 62ms/step
Epoch 12/50
444/444 - 30s - loss: 3.2626 - accuracy1000: 0.3898 - val_loss: 3.2962 - val_accuracy1000: 0.3726 - 30s/epoch - 67ms/step
Epoch 13/50
444/444 - 33s - loss: 3.2553 - accuracy1000: 0.3948 - val_loss: 3.2909 - val_accuracy1000: 0.3813 - 33s/epoch - 73ms/step
Epoch 14/50
444/444 - 31s - loss: 3.2529 - accuracy1000: 0.3957 - val_loss: 3.3020 - val_accuracy1000: 0.3640 - 31s/epoch - 71ms/step
Epoch 15/50
444/444 - 30s - loss: 3.2469 - accuracy1000: 0.4000 - val_loss: 3.3028 - val_accuracy1000: 0.3722 - 30s/epoch - 69ms/step
Epoch 16/50
444/444 - 33s - loss: 3.2420 - accuracy1000: 0.4040 - val_loss: 3.3127 - val_accuracy1000: 0.3642 - 33s/epoch - 74ms/step
Epoch 17/50
444/444 - 30s - loss: 3.2334 - accuracy1000: 0.4077 - val_loss: 3.3260 - val_accuracy1000: 0.3601 - 30s/epoch - 67ms/step
Epoch 18/50
444/444 - 30s - loss: 3.2317 - accuracy1000: 0.4108 - val_loss: 3.3232 - val_accuracy1000: 0.3554 - 30s/epoch - 68ms/step
testing model: results/XRAY/W3/deepVOL_L3/h1000
Evaluating performance on  test set...
1359/1359 - 39s - 39s/epoch - 29ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0674366
{'0': {'precision': 0.31272003421840555, 'recall': 0.19949624809781183, 'f1-score': 0.243594261586073, 'support': 95285}, '1': {'precision': 0.5302313507557176, 'recall': 0.6143020229794756, 'f1-score': 0.5691790189627769, 'support': 162928}, '2': {'precision': 0.371353838011684, 'recall': 0.40727552797249633, 'f1-score': 0.3884860680784915, 'support': 89588}, 'accuracy': 0.4473333889206759, 'macro avg': {'precision': 0.4047684076619357, 'recall': 0.40702459968326127, 'f1-score': 0.4004197828757805, 'support': 347801}, 'weighted avg': {'precision': 0.4297167334660311, 'recall': 0.4473333889206759, 'f1-score': 0.433436845448438, 'support': 347801}}
[[ 19009  50470  25806]
 [ 26880 100087  35961]
 [ 14897  38204  36487]]
Evaluating performance on  train set...
444/444 - 13s - 13s/epoch - 30ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0890387
{'0': {'precision': 0.3422675026123302, 'recall': 0.1770014320067007, 'f1-score': 0.23333511424551656, 'support': 37011}, '1': {'precision': 0.40096606011040686, 'recall': 0.4156356796566615, 'f1-score': 0.4081691056910569, 'support': 37747}, '2': {'precision': 0.3968655664214313, 'recall': 0.5653987793257964, 'f1-score': 0.46637352366386264, 'support': 38831}, 'accuracy': 0.38907816778033083, 'macro avg': {'precision': 0.38003304304805613, 'recall': 0.38601196366305285, 'f1-score': 0.36929258120014535, 'support': 113589}, 'weighted avg': {'precision': 0.3804383806520269, 'recall': 0.38907816778033083, 'f1-score': 0.3710999783716081, 'support': 113589}}
[[ 6551 12396 18064]
 [ 6756 15689 15302]
 [ 5833 11043 21955]]
Evaluating performance on  val set...
144/144 - 4s - 4s/epoch - 28ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0948039
{'0': {'precision': 0.3678631995477671, 'recall': 0.20937902187902188, 'f1-score': 0.2668648759483289, 'support': 12432}, '1': {'precision': 0.38056059127039465, 'recall': 0.4437037639216324, 'f1-score': 0.4097136208384942, 'support': 12301}, '2': {'precision': 0.3613373620599054, 'recall': 0.4619195566378369, 'f1-score': 0.4054840968562267, 'support': 11909}, 'accuracy': 0.3701217182468206, 'macro avg': {'precision': 0.36992038429268903, 'recall': 0.37166744747949704, 'f1-score': 0.36068753121435, 'support': 36642}, 'weighted avg': {'precision': 0.3700048516665678, 'recall': 0.3701217182468206, 'f1-score': 0.359872864395632, 'support': 36642}}
[[2603 4668 5161]
 [2281 5458 4562]
 [2192 4216 5501]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        15 (peak)  14.67 (ave)

============================================
