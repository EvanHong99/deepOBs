This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/ATVI_orderbooks/ATVI_orderbooks_2019-10-09.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-10-01.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-09-18.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-09-19.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-09-27.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-09-23.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-09-25.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-09-20.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-10-11.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-09-24.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-10-07.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-09-26.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-09-17.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-10-03.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-10-02.csv
training model: results/ATVI/W7/deepLOB_L1/h10
Epoch 1/50
2083/2083 - 60s - loss: 3.0383 - accuracy10: 0.4483 - val_loss: 3.2983 - val_accuracy10: 0.5107 - 60s/epoch - 29ms/step
Epoch 2/50
2083/2083 - 32s - loss: 2.9244 - accuracy10: 0.4895 - val_loss: 3.3533 - val_accuracy10: 0.5052 - 32s/epoch - 15ms/step
Epoch 3/50
2083/2083 - 31s - loss: 2.8668 - accuracy10: 0.5122 - val_loss: 3.3618 - val_accuracy10: 0.5239 - 31s/epoch - 15ms/step
Epoch 4/50
2083/2083 - 31s - loss: 2.8283 - accuracy10: 0.5258 - val_loss: 3.2808 - val_accuracy10: 0.5289 - 31s/epoch - 15ms/step
Epoch 5/50
2083/2083 - 32s - loss: 2.8034 - accuracy10: 0.5337 - val_loss: 3.2330 - val_accuracy10: 0.5387 - 32s/epoch - 16ms/step
Epoch 6/50
2083/2083 - 31s - loss: 2.7828 - accuracy10: 0.5385 - val_loss: 3.2093 - val_accuracy10: 0.5408 - 31s/epoch - 15ms/step
Epoch 7/50
2083/2083 - 31s - loss: 2.7692 - accuracy10: 0.5426 - val_loss: 3.1967 - val_accuracy10: 0.5424 - 31s/epoch - 15ms/step
Epoch 8/50
2083/2083 - 31s - loss: 2.7548 - accuracy10: 0.5450 - val_loss: 3.1488 - val_accuracy10: 0.5399 - 31s/epoch - 15ms/step
Epoch 9/50
2083/2083 - 31s - loss: 2.7442 - accuracy10: 0.5469 - val_loss: 3.1492 - val_accuracy10: 0.5378 - 31s/epoch - 15ms/step
Epoch 10/50
2083/2083 - 32s - loss: 2.7351 - accuracy10: 0.5493 - val_loss: 3.1059 - val_accuracy10: 0.5423 - 32s/epoch - 15ms/step
Epoch 11/50
2083/2083 - 31s - loss: 2.7267 - accuracy10: 0.5506 - val_loss: 3.1204 - val_accuracy10: 0.5418 - 31s/epoch - 15ms/step
Epoch 12/50
2083/2083 - 31s - loss: 2.7205 - accuracy10: 0.5519 - val_loss: 3.1227 - val_accuracy10: 0.5455 - 31s/epoch - 15ms/step
Epoch 13/50
2083/2083 - 31s - loss: 2.7140 - accuracy10: 0.5530 - val_loss: 3.1322 - val_accuracy10: 0.5454 - 31s/epoch - 15ms/step
Epoch 14/50
2083/2083 - 31s - loss: 2.7080 - accuracy10: 0.5551 - val_loss: 3.1054 - val_accuracy10: 0.5430 - 31s/epoch - 15ms/step
Epoch 15/50
2083/2083 - 32s - loss: 2.7031 - accuracy10: 0.5558 - val_loss: 3.1165 - val_accuracy10: 0.5450 - 32s/epoch - 15ms/step
Epoch 16/50
2083/2083 - 31s - loss: 2.6983 - accuracy10: 0.5570 - val_loss: 3.1514 - val_accuracy10: 0.5450 - 31s/epoch - 15ms/step
Epoch 17/50
2083/2083 - 30s - loss: 2.6937 - accuracy10: 0.5578 - val_loss: 3.1713 - val_accuracy10: 0.5452 - 30s/epoch - 15ms/step
Epoch 18/50
2083/2083 - 31s - loss: 2.6888 - accuracy10: 0.5590 - val_loss: 3.1729 - val_accuracy10: 0.5421 - 31s/epoch - 15ms/step
Epoch 19/50
2083/2083 - 31s - loss: 2.6850 - accuracy10: 0.5589 - val_loss: 3.1927 - val_accuracy10: 0.5426 - 31s/epoch - 15ms/step
Epoch 20/50
2083/2083 - 31s - loss: 2.6818 - accuracy10: 0.5603 - val_loss: 3.1770 - val_accuracy10: 0.5428 - 31s/epoch - 15ms/step
Epoch 21/50
2083/2083 - 31s - loss: 2.6769 - accuracy10: 0.5609 - val_loss: 3.2078 - val_accuracy10: 0.5431 - 31s/epoch - 15ms/step
Epoch 22/50
2083/2083 - 31s - loss: 2.6743 - accuracy10: 0.5615 - val_loss: 3.1944 - val_accuracy10: 0.5422 - 31s/epoch - 15ms/step
Epoch 23/50
2083/2083 - 31s - loss: 2.6707 - accuracy10: 0.5622 - val_loss: 3.2252 - val_accuracy10: 0.5429 - 31s/epoch - 15ms/step
Epoch 24/50
2083/2083 - 32s - loss: 2.6673 - accuracy10: 0.5626 - val_loss: 3.2279 - val_accuracy10: 0.5427 - 32s/epoch - 15ms/step
testing model: results/ATVI/W7/deepLOB_L1/h10
Evaluating performance on  test set...
6143/6143 - 42s - 42s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9088655
{'0': {'precision': 0.4249733973713727, 'recall': 0.1867761700567846, 'f1-score': 0.25950129845042075, 'support': 316459}, '1': {'precision': 0.6347356723531579, 'recall': 0.8814453681471212, 'f1-score': 0.7380184865111254, 'support': 944147}, '2': {'precision': 0.4468883637642172, 'recall': 0.17523148741888322, 'f1-score': 0.2517486382846417, 'support': 311896}, 'accuracy': 0.6015731617511456, 'macro avg': {'precision': 0.5021991444962493, 'recall': 0.414484341874263, 'f1-score': 0.4164228077487293, 'support': 1572502}, 'weighted avg': {'precision': 0.555263605584329, 'recall': 0.6015731617511456, 'f1-score': 0.5452704382422203, 'support': 1572502}}
[[ 59107 239597  17755]
 [ 62043 832214  49890]
 [ 17934 239308  54654]]
Evaluating performance on  train set...
2083/2083 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93636024
{'0': {'precision': 0.4676882345862249, 'recall': 0.27618363286061715, 'f1-score': 0.34728517457590935, 'support': 126644}, '1': {'precision': 0.6029220769744887, 'recall': 0.7356401655164555, 'f1-score': 0.6627016397439414, 'support': 280818}, '2': {'precision': 0.42168622675889705, 'recall': 0.38829470001192795, 'f1-score': 0.40430217924090883, 'support': 125755}, 'accuracy': 0.5445962900657706, 'macro avg': {'precision': 0.49743217943987017, 'recall': 0.4667061661296668, 'f1-score': 0.47142966452025314, 'support': 533217}, 'weighted avg': {'precision': 0.5280597431042614, 'recall': 0.5445962900657706, 'f1-score': 0.5268458306262667, 'support': 533217}}
[[ 34977  70510  21157]
 [ 28427 206581  45810]
 [ 11383  65542  48830]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94960904
{'0': {'precision': 0.4519437670348587, 'recall': 0.15535392884439952, 'f1-score': 0.23122511513550212, 'support': 40559}, '1': {'precision': 0.5768681334864952, 'recall': 0.8328567024228443, 'f1-score': 0.6816202412699518, 'support': 94063}, '2': {'precision': 0.4177842450937979, 'recall': 0.2619664126655323, 'f1-score': 0.3220164297189972, 'support': 40551}, 'accuracy': 0.5438338100049666, 'macro avg': {'precision': 0.48219871520505064, 'recall': 0.4167256813109254, 'f1-score': 0.41162059537481704, 'support': 175173}, 'weighted avg': {'precision': 0.5111170295085752, 'recall': 0.5438338100049666, 'f1-score': 0.4940920829174094, 'support': 175173}}
[[ 6301 29712  4546]
 [ 5464 78341 10258]
 [ 2177 27751 10623]]
training model: results/ATVI/W7/deepLOB_L1/h20
Epoch 1/50
2083/2083 - 34s - loss: 3.1026 - accuracy20: 0.4543 - val_loss: 3.4740 - val_accuracy20: 0.4272 - 34s/epoch - 16ms/step
Epoch 2/50
2083/2083 - 31s - loss: 3.0068 - accuracy20: 0.4896 - val_loss: 3.4199 - val_accuracy20: 0.4400 - 31s/epoch - 15ms/step
Epoch 3/50
2083/2083 - 31s - loss: 2.9536 - accuracy20: 0.5072 - val_loss: 3.3948 - val_accuracy20: 0.4543 - 31s/epoch - 15ms/step
Epoch 4/50
2083/2083 - 32s - loss: 2.9206 - accuracy20: 0.5177 - val_loss: 3.3269 - val_accuracy20: 0.4705 - 32s/epoch - 15ms/step
Epoch 5/50
2083/2083 - 31s - loss: 2.8981 - accuracy20: 0.5240 - val_loss: 3.3157 - val_accuracy20: 0.4730 - 31s/epoch - 15ms/step
Epoch 6/50
2083/2083 - 31s - loss: 2.8819 - accuracy20: 0.5276 - val_loss: 3.2837 - val_accuracy20: 0.4734 - 31s/epoch - 15ms/step
Epoch 7/50
2083/2083 - 31s - loss: 2.8677 - accuracy20: 0.5317 - val_loss: 3.2809 - val_accuracy20: 0.4766 - 31s/epoch - 15ms/step
Epoch 8/50
2083/2083 - 32s - loss: 2.8554 - accuracy20: 0.5341 - val_loss: 3.2701 - val_accuracy20: 0.4799 - 32s/epoch - 15ms/step
Epoch 9/50
2083/2083 - 31s - loss: 2.8449 - accuracy20: 0.5369 - val_loss: 3.2469 - val_accuracy20: 0.4829 - 31s/epoch - 15ms/step
Epoch 10/50
2083/2083 - 31s - loss: 2.8354 - accuracy20: 0.5388 - val_loss: 3.2307 - val_accuracy20: 0.4873 - 31s/epoch - 15ms/step
Epoch 11/50
2083/2083 - 31s - loss: 2.8273 - accuracy20: 0.5405 - val_loss: 3.2262 - val_accuracy20: 0.4888 - 31s/epoch - 15ms/step
Epoch 12/50
2083/2083 - 31s - loss: 2.8216 - accuracy20: 0.5408 - val_loss: 3.2324 - val_accuracy20: 0.4895 - 31s/epoch - 15ms/step
Epoch 13/50
2083/2083 - 32s - loss: 2.8153 - accuracy20: 0.5431 - val_loss: 3.2425 - val_accuracy20: 0.4903 - 32s/epoch - 15ms/step
Epoch 14/50
2083/2083 - 31s - loss: 2.8092 - accuracy20: 0.5442 - val_loss: 3.2562 - val_accuracy20: 0.4910 - 31s/epoch - 15ms/step
Epoch 15/50
2083/2083 - 31s - loss: 2.8043 - accuracy20: 0.5450 - val_loss: 3.2622 - val_accuracy20: 0.4916 - 31s/epoch - 15ms/step
Epoch 16/50
2083/2083 - 31s - loss: 2.7997 - accuracy20: 0.5455 - val_loss: 3.2768 - val_accuracy20: 0.4906 - 31s/epoch - 15ms/step
Epoch 17/50
2083/2083 - 32s - loss: 2.7954 - accuracy20: 0.5466 - val_loss: 3.2236 - val_accuracy20: 0.4977 - 32s/epoch - 15ms/step
Epoch 18/50
2083/2083 - 32s - loss: 2.7913 - accuracy20: 0.5476 - val_loss: 3.2160 - val_accuracy20: 0.4976 - 32s/epoch - 15ms/step
Epoch 19/50
2083/2083 - 32s - loss: 2.7869 - accuracy20: 0.5483 - val_loss: 3.1881 - val_accuracy20: 0.5013 - 32s/epoch - 15ms/step
Epoch 20/50
2083/2083 - 31s - loss: 2.7835 - accuracy20: 0.5494 - val_loss: 3.1603 - val_accuracy20: 0.5034 - 31s/epoch - 15ms/step
Epoch 21/50
2083/2083 - 31s - loss: 2.7812 - accuracy20: 0.5495 - val_loss: 3.1609 - val_accuracy20: 0.5042 - 31s/epoch - 15ms/step
Epoch 22/50
2083/2083 - 31s - loss: 2.7775 - accuracy20: 0.5505 - val_loss: 3.1740 - val_accuracy20: 0.5031 - 31s/epoch - 15ms/step
Epoch 23/50
2083/2083 - 32s - loss: 2.7741 - accuracy20: 0.5508 - val_loss: 3.1797 - val_accuracy20: 0.5016 - 32s/epoch - 15ms/step
Epoch 24/50
2083/2083 - 32s - loss: 2.7712 - accuracy20: 0.5521 - val_loss: 3.1681 - val_accuracy20: 0.5032 - 32s/epoch - 15ms/step
Epoch 25/50
2083/2083 - 31s - loss: 2.7683 - accuracy20: 0.5523 - val_loss: 3.1658 - val_accuracy20: 0.5033 - 31s/epoch - 15ms/step
Epoch 26/50
2083/2083 - 31s - loss: 2.7656 - accuracy20: 0.5534 - val_loss: 3.1637 - val_accuracy20: 0.5033 - 31s/epoch - 15ms/step
Epoch 27/50
2083/2083 - 30s - loss: 2.7622 - accuracy20: 0.5535 - val_loss: 3.1657 - val_accuracy20: 0.5010 - 30s/epoch - 15ms/step
Epoch 28/50
2083/2083 - 31s - loss: 2.7600 - accuracy20: 0.5540 - val_loss: 3.1424 - val_accuracy20: 0.5056 - 31s/epoch - 15ms/step
Epoch 29/50
2083/2083 - 31s - loss: 2.7572 - accuracy20: 0.5546 - val_loss: 3.1686 - val_accuracy20: 0.5028 - 31s/epoch - 15ms/step
Epoch 30/50
2083/2083 - 31s - loss: 2.7545 - accuracy20: 0.5553 - val_loss: 3.1483 - val_accuracy20: 0.5042 - 31s/epoch - 15ms/step
Epoch 31/50
2083/2083 - 32s - loss: 2.7513 - accuracy20: 0.5564 - val_loss: 3.1546 - val_accuracy20: 0.5013 - 32s/epoch - 15ms/step
Epoch 32/50
2083/2083 - 31s - loss: 2.7498 - accuracy20: 0.5563 - val_loss: 3.1693 - val_accuracy20: 0.4983 - 31s/epoch - 15ms/step
Epoch 33/50
2083/2083 - 31s - loss: 2.7473 - accuracy20: 0.5568 - val_loss: 3.1376 - val_accuracy20: 0.5010 - 31s/epoch - 15ms/step
Epoch 34/50
2083/2083 - 31s - loss: 2.7450 - accuracy20: 0.5573 - val_loss: 3.1329 - val_accuracy20: 0.5011 - 31s/epoch - 15ms/step
Epoch 35/50
2083/2083 - 32s - loss: 2.7416 - accuracy20: 0.5583 - val_loss: 3.1376 - val_accuracy20: 0.5038 - 32s/epoch - 15ms/step
Epoch 36/50
2083/2083 - 31s - loss: 2.7403 - accuracy20: 0.5581 - val_loss: 3.1370 - val_accuracy20: 0.4979 - 31s/epoch - 15ms/step
Epoch 37/50
2083/2083 - 31s - loss: 2.7388 - accuracy20: 0.5587 - val_loss: 3.1356 - val_accuracy20: 0.5021 - 31s/epoch - 15ms/step
Epoch 38/50
2083/2083 - 31s - loss: 2.7358 - accuracy20: 0.5591 - val_loss: 3.1192 - val_accuracy20: 0.5006 - 31s/epoch - 15ms/step
Epoch 39/50
2083/2083 - 31s - loss: 2.7327 - accuracy20: 0.5601 - val_loss: 3.1567 - val_accuracy20: 0.4949 - 31s/epoch - 15ms/step
Epoch 40/50
2083/2083 - 31s - loss: 2.7312 - accuracy20: 0.5604 - val_loss: 3.1298 - val_accuracy20: 0.4948 - 31s/epoch - 15ms/step
Epoch 41/50
2083/2083 - 31s - loss: 2.7295 - accuracy20: 0.5607 - val_loss: 3.1403 - val_accuracy20: 0.4925 - 31s/epoch - 15ms/step
Epoch 42/50
2083/2083 - 31s - loss: 2.7277 - accuracy20: 0.5614 - val_loss: 3.1388 - val_accuracy20: 0.4942 - 31s/epoch - 15ms/step
Epoch 43/50
2083/2083 - 31s - loss: 2.7256 - accuracy20: 0.5621 - val_loss: 3.1318 - val_accuracy20: 0.4974 - 31s/epoch - 15ms/step
Epoch 44/50
2083/2083 - 31s - loss: 2.7237 - accuracy20: 0.5624 - val_loss: 3.1621 - val_accuracy20: 0.4900 - 31s/epoch - 15ms/step
Epoch 45/50
2083/2083 - 31s - loss: 2.7200 - accuracy20: 0.5632 - val_loss: 3.1518 - val_accuracy20: 0.4959 - 31s/epoch - 15ms/step
Epoch 46/50
2083/2083 - 30s - loss: 2.7191 - accuracy20: 0.5631 - val_loss: 3.1680 - val_accuracy20: 0.4884 - 30s/epoch - 15ms/step
Epoch 47/50
2083/2083 - 31s - loss: 2.7176 - accuracy20: 0.5638 - val_loss: 3.1665 - val_accuracy20: 0.4911 - 31s/epoch - 15ms/step
Epoch 48/50
2083/2083 - 31s - loss: 2.7157 - accuracy20: 0.5640 - val_loss: 3.1571 - val_accuracy20: 0.4866 - 31s/epoch - 15ms/step
testing model: results/ATVI/W7/deepLOB_L1/h20
Evaluating performance on  test set...
6143/6143 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91263777
{'0': {'precision': 0.5029925269992772, 'recall': 0.41202803370188057, 'f1-score': 0.4529887759187487, 'support': 403657}, '1': {'precision': 0.6135031909860265, 'recall': 0.7423688198645131, 'f1-score': 0.6718121418993052, 'support': 772030}, '2': {'precision': 0.5065512545059174, 'recall': 0.3927296095157693, 'f1-score': 0.44243725034281284, 'support': 396815}, 'accuracy': 0.5693410882784251, 'macro avg': {'precision': 0.5410156574970737, 'recall': 0.5157088210273877, 'f1-score': 0.5224127227202889, 'support': 1572502}, 'weighted avg': {'precision': 0.5581464818897875, 'recall': 0.5693410882784251, 'f1-score': 0.5577588808957561, 'support': 1572502}}
[[166318 178137  59202]
 [106291 573131  92608]
 [ 58048 182926 155841]]
Evaluating performance on  train set...
2083/2083 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9816222
{'0': {'precision': 0.5252409481635842, 'recall': 0.31967987621203764, 'f1-score': 0.3974549009713637, 'support': 157689}, '1': {'precision': 0.5415126978284873, 'recall': 0.6710711760815526, 'f1-score': 0.5993706015948834, 'support': 219245}, '2': {'precision': 0.47379516980584985, 'recall': 0.5018652060684783, 'f1-score': 0.487426396333411, 'support': 156283}, 'accuracy': 0.5175603928606928, 'macro avg': {'precision': 0.5135162719326405, 'recall': 0.4975387527873562, 'f1-score': 0.49475063296655275, 'support': 533217}, 'weighted avg': {'precision': 0.5168529919960201, 'recall': 0.5175603928606928, 'f1-score': 0.5068475553557333, 'support': 533217}}
[[ 50410  66356  40923]
 [ 25930 147129  46186]
 [ 19635  58215  78433]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0085658
{'0': {'precision': 0.5057569151110506, 'recall': 0.2945424246632412, 'f1-score': 0.37227787319935307, 'support': 50407}, '1': {'precision': 0.5353479012183652, 'recall': 0.6597611602329092, 'f1-score': 0.5910786953739148, 'support': 74192}, '2': {'precision': 0.43835389735763014, 'recall': 0.47136868746786886, 'f1-score': 0.4542622216717322, 'support': 50574}, 'accuracy': 0.5002768691522095, 'macro avg': {'precision': 0.49315290456234867, 'recall': 0.4752240907880065, 'f1-score': 0.4725395967483334, 'support': 175173}, 'weighted avg': {'precision': 0.4988299013669942, 'recall': 0.5002768691522095, 'f1-score': 0.4886174177548336, 'support': 175173}}
[[14847 21870 13690]
 [ 8389 48949 16854]
 [ 6120 20615 23839]]
training model: results/ATVI/W7/deepLOB_L1/h30
Epoch 1/50
2083/2083 - 34s - loss: 3.1334 - accuracy30: 0.4500 - val_loss: 3.3087 - val_accuracy30: 0.3736 - 34s/epoch - 17ms/step
Epoch 2/50
2083/2083 - 31s - loss: 3.0578 - accuracy30: 0.4789 - val_loss: 3.4863 - val_accuracy30: 0.3923 - 31s/epoch - 15ms/step
Epoch 3/50
2083/2083 - 31s - loss: 3.0155 - accuracy30: 0.4913 - val_loss: 3.3164 - val_accuracy30: 0.4026 - 31s/epoch - 15ms/step
Epoch 4/50
2083/2083 - 31s - loss: 2.9900 - accuracy30: 0.4982 - val_loss: 3.3314 - val_accuracy30: 0.4016 - 31s/epoch - 15ms/step
Epoch 5/50
2083/2083 - 31s - loss: 2.9696 - accuracy30: 0.5039 - val_loss: 3.3722 - val_accuracy30: 0.3971 - 31s/epoch - 15ms/step
Epoch 6/50
2083/2083 - 31s - loss: 2.9531 - accuracy30: 0.5078 - val_loss: 3.4071 - val_accuracy30: 0.4014 - 31s/epoch - 15ms/step
Epoch 7/50
2083/2083 - 31s - loss: 2.9394 - accuracy30: 0.5116 - val_loss: 3.3861 - val_accuracy30: 0.3982 - 31s/epoch - 15ms/step
Epoch 8/50
2083/2083 - 31s - loss: 2.9265 - accuracy30: 0.5146 - val_loss: 3.3961 - val_accuracy30: 0.3924 - 31s/epoch - 15ms/step
Epoch 9/50
2083/2083 - 31s - loss: 2.9149 - accuracy30: 0.5166 - val_loss: 3.3658 - val_accuracy30: 0.4070 - 31s/epoch - 15ms/step
Epoch 10/50
2083/2083 - 31s - loss: 2.9066 - accuracy30: 0.5188 - val_loss: 3.3267 - val_accuracy30: 0.4049 - 31s/epoch - 15ms/step
Epoch 11/50
2083/2083 - 31s - loss: 2.8988 - accuracy30: 0.5198 - val_loss: 3.3206 - val_accuracy30: 0.4061 - 31s/epoch - 15ms/step
testing model: results/ATVI/W7/deepLOB_L1/h30
Evaluating performance on  test set...
6143/6143 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0528009
{'0': {'precision': 0.5249450849209654, 'recall': 0.07908756432191347, 'f1-score': 0.13746484803825737, 'support': 462323}, '1': {'precision': 0.4264372327430394, 'recall': 0.9157829480090944, 'f1-score': 0.5819074273245166, 'support': 654903}, '2': {'precision': 0.4663852910371146, 'recall': 0.09878403430007292, 'f1-score': 0.16303581429998168, 'support': 455276}, 'accuracy': 0.43325032337001795, 'macro avg': {'precision': 0.47258920290037315, 'recall': 0.3645515155436936, 'f1-score': 0.29413602988758525, 'support': 1572502}, 'weighted avg': {'precision': 0.46696490007214214, 'recall': 0.43325032337001795, 'f1-score': 0.3299661140068106, 'support': 1572502}}
[[ 36564 407851  17908]
 [ 21605 599749  33549]
 [ 11484 398818  44974]]
Evaluating performance on  train set...
2083/2083 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0932347
{'0': {'precision': 0.503175351507252, 'recall': 0.10248589293884398, 'f1-score': 0.17028784878318895, 'support': 177039}, '1': {'precision': 0.34972326868517745, 'recall': 0.8318840579710145, 'f1-score': 0.4924296005239031, 'support': 180780}, '2': {'precision': 0.4514135065089815, 'recall': 0.1727898835790602, 'f1-score': 0.2499175380149751, 'support': 175398}, 'accuracy': 0.3729044647863815, 'macro avg': {'precision': 0.43477070890047037, 'recall': 0.3690532781629729, 'f1-score': 0.30421166244068903, 'support': 533217}, 'weighted avg': {'precision': 0.4341228051301086, 'recall': 0.3729044647863815, 'f1-score': 0.30569927435957367, 'support': 533217}}
[[ 18144 141986  16909]
 [ 10470 150388  19922]
 [  7445 137646  30307]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1002635
{'0': {'precision': 0.4467005076142132, 'recall': 0.06195874111103288, 'f1-score': 0.10882334755456627, 'support': 56812}, '1': {'precision': 0.3584317009265012, 'recall': 0.8622157244964263, 'f1-score': 0.5063631680372441, 'support': 61560}, '2': {'precision': 0.4473944505179864, 'recall': 0.1513001531663175, 'f1-score': 0.22612814103407444, 'support': 56801}, 'accuracy': 0.3721578097081171, 'macro avg': {'precision': 0.41750888635290023, 'recall': 0.35849153959125885, 'f1-score': 0.2804382188752949, 'support': 175173}, 'weighted avg': {'precision': 0.4159057442156396, 'recall': 0.3721578097081171, 'f1-score': 0.2865652422720353, 'support': 175173}}
[[ 3520 48299  4993]
 [ 2860 53078  5622]
 [ 1500 46707  8594]]
training model: results/ATVI/W7/deepLOB_L1/h50
Epoch 1/50
2083/2083 - 34s - loss: 3.1928 - accuracy50: 0.4254 - val_loss: 3.2637 - val_accuracy50: 0.3692 - 34s/epoch - 16ms/step
Epoch 2/50
2083/2083 - 31s - loss: 3.1538 - accuracy50: 0.4403 - val_loss: 3.4107 - val_accuracy50: 0.3652 - 31s/epoch - 15ms/step
Epoch 3/50
2083/2083 - 31s - loss: 3.1215 - accuracy50: 0.4544 - val_loss: 3.4844 - val_accuracy50: 0.3672 - 31s/epoch - 15ms/step
Epoch 4/50
2083/2083 - 31s - loss: 3.1057 - accuracy50: 0.4596 - val_loss: 3.4205 - val_accuracy50: 0.3791 - 31s/epoch - 15ms/step
Epoch 5/50
2083/2083 - 31s - loss: 3.0939 - accuracy50: 0.4626 - val_loss: 3.3546 - val_accuracy50: 0.3830 - 31s/epoch - 15ms/step
Epoch 6/50
2083/2083 - 30s - loss: 3.0850 - accuracy50: 0.4653 - val_loss: 3.3530 - val_accuracy50: 0.3909 - 30s/epoch - 15ms/step
Epoch 7/50
2083/2083 - 31s - loss: 3.0776 - accuracy50: 0.4676 - val_loss: 3.3522 - val_accuracy50: 0.3956 - 31s/epoch - 15ms/step
Epoch 8/50
2083/2083 - 31s - loss: 3.0707 - accuracy50: 0.4696 - val_loss: 3.3147 - val_accuracy50: 0.3934 - 31s/epoch - 15ms/step
Epoch 9/50
2083/2083 - 30s - loss: 3.0646 - accuracy50: 0.4715 - val_loss: 3.3160 - val_accuracy50: 0.3957 - 30s/epoch - 15ms/step
Epoch 10/50
2083/2083 - 31s - loss: 3.0601 - accuracy50: 0.4728 - val_loss: 3.3563 - val_accuracy50: 0.3940 - 31s/epoch - 15ms/step
Epoch 11/50
2083/2083 - 31s - loss: 3.0549 - accuracy50: 0.4747 - val_loss: 3.3814 - val_accuracy50: 0.3870 - 31s/epoch - 15ms/step
testing model: results/ATVI/W7/deepLOB_L1/h50
Evaluating performance on  test set...
6143/6143 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0612228
{'0': {'precision': 0.4431668237511781, 'recall': 0.07405284178961559, 'f1-score': 0.1269006763358037, 'support': 476214}, '1': {'precision': 0.39745712244374026, 'recall': 0.853274414665447, 'f1-score': 0.5423066156813297, 'support': 618706}, '2': {'precision': 0.45578375883596084, 'recall': 0.15715207022040195, 'f1-score': 0.23371895679252627, 'support': 477582}, 'accuracy': 0.4058780211408316, 'macro avg': {'precision': 0.4321359016769597, 'recall': 0.36149310889182146, 'f1-score': 0.30097541626988655, 'support': 1572502}, 'weighted avg': {'precision': 0.4290140625047956, 'recall': 0.4058780211408316, 'f1-score': 0.32278509182512927, 'support': 1572502}}
[[ 35265 411875  29074]
 [ 30239 527926  60541]
 [ 14071 388458  75053]]
Evaluating performance on  train set...
2083/2083 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0902727
{'0': {'precision': 0.42708447263844834, 'recall': 0.13187029667861785, 'f1-score': 0.2015181163315772, 'support': 177667}, '1': {'precision': 0.3405138685346276, 'recall': 0.7110681857743687, 'f1-score': 0.46050344381168495, 'support': 178087}, '2': {'precision': 0.4371959351578789, 'recall': 0.2623081994556612, 'f1-score': 0.3278896374900066, 'support': 177463}, 'accuracy': 0.36872605337039144, 'macro avg': {'precision': 0.4015980921103183, 'recall': 0.3684155606362159, 'f1-score': 0.3299703992110896, 'support': 533217}, 'weighted avg': {'precision': 0.4015363586436743, 'recall': 0.36872605337039144, 'f1-score': 0.3300740124757142, 'support': 533217}}
[[ 23429 128560  25678]
 [ 17209 126632  34246]
 [ 14220 116693  46550]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.08763
{'0': {'precision': 0.45500998003992016, 'recall': 0.09933936446512925, 'f1-score': 0.16307551435030193, 'support': 57369}, '1': {'precision': 0.34907728365658114, 'recall': 0.7679548791883594, 'f1-score': 0.47997830700798366, 'support': 59928}, '2': {'precision': 0.4260118796455581, 'recall': 0.22677793904208998, 'f1-score': 0.29599143034335007, 'support': 57876}, 'accuracy': 0.370182619467612, 'macro avg': {'precision': 0.41003304778068644, 'recall': 0.3646907275651929, 'f1-score': 0.3130150839005452, 'support': 175173}, 'weighted avg': {'precision': 0.4091888278801419, 'recall': 0.370182619467612, 'f1-score': 0.315404880818897, 'support': 175173}}
[[ 5699 44430  7240]
 [ 3462 46022 10444]
 [ 3364 41387 13125]]
training model: results/ATVI/W7/deepLOB_L1/h100
Epoch 1/50
2083/2083 - 35s - loss: 3.2438 - accuracy100: 0.3969 - val_loss: 3.3590 - val_accuracy100: 0.3726 - 35s/epoch - 17ms/step
Epoch 2/50
2083/2083 - 32s - loss: 3.2208 - accuracy100: 0.4079 - val_loss: 3.3312 - val_accuracy100: 0.3671 - 32s/epoch - 16ms/step
Epoch 3/50
2083/2083 - 32s - loss: 3.2071 - accuracy100: 0.4148 - val_loss: 3.4028 - val_accuracy100: 0.3741 - 32s/epoch - 16ms/step
Epoch 4/50
2083/2083 - 31s - loss: 3.2000 - accuracy100: 0.4183 - val_loss: 3.4670 - val_accuracy100: 0.3675 - 31s/epoch - 15ms/step
Epoch 5/50
2083/2083 - 31s - loss: 3.1953 - accuracy100: 0.4201 - val_loss: 3.4580 - val_accuracy100: 0.3670 - 31s/epoch - 15ms/step
Epoch 6/50
2083/2083 - 30s - loss: 3.1910 - accuracy100: 0.4221 - val_loss: 3.4400 - val_accuracy100: 0.3704 - 30s/epoch - 15ms/step
Epoch 7/50
2083/2083 - 31s - loss: 3.1874 - accuracy100: 0.4240 - val_loss: 3.4492 - val_accuracy100: 0.3585 - 31s/epoch - 15ms/step
Epoch 8/50
2083/2083 - 31s - loss: 3.1851 - accuracy100: 0.4247 - val_loss: 3.4366 - val_accuracy100: 0.3559 - 31s/epoch - 15ms/step
Epoch 9/50
2083/2083 - 32s - loss: 3.1827 - accuracy100: 0.4262 - val_loss: 3.4094 - val_accuracy100: 0.3597 - 32s/epoch - 15ms/step
Epoch 10/50
2083/2083 - 31s - loss: 3.1810 - accuracy100: 0.4272 - val_loss: 3.4491 - val_accuracy100: 0.3554 - 31s/epoch - 15ms/step
Epoch 11/50
2083/2083 - 31s - loss: 3.1791 - accuracy100: 0.4274 - val_loss: 3.4248 - val_accuracy100: 0.3590 - 31s/epoch - 15ms/step
Epoch 12/50
2083/2083 - 31s - loss: 3.1774 - accuracy100: 0.4281 - val_loss: 3.4199 - val_accuracy100: 0.3614 - 31s/epoch - 15ms/step
testing model: results/ATVI/W7/deepLOB_L1/h100
Evaluating performance on  test set...
6143/6143 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.084962
{'0': {'precision': 0.345268908559235, 'recall': 0.30330933004128796, 'f1-score': 0.32293183800047354, 'support': 460909}, '1': {'precision': 0.41671212271879005, 'recall': 0.6759543903443589, 'f1-score': 0.5155797958369467, 'support': 638549}, '2': {'precision': 0.424029072811004, 'recall': 0.11814968586431707, 'f1-score': 0.1848058447452348, 'support': 473044}, 'accuracy': 0.3989298582768098, 'macro avg': {'precision': 0.39533670136300963, 'recall': 0.36580446874998795, 'f1-score': 0.34110582619421836, 'support': 1572502}, 'weighted avg': {'precision': 0.3979728263263879, 'recall': 0.3989298582768098, 'f1-score': 0.35960936748857014, 'support': 1572502}}
[[139798 289951  31160]
 [162162 431630  44757]
 [102936 314218  55890]]
Evaluating performance on  train set...
2083/2083 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1076645
{'0': {'precision': 0.37659360810338804, 'recall': 0.19251521898034227, 'f1-score': 0.25478431358069364, 'support': 179217}, '1': {'precision': 0.33397917455620435, 'recall': 0.6505655500531812, 'f1-score': 0.44137222001299675, 'support': 174874}, '2': {'precision': 0.41164817749603805, 'recall': 0.23201545280975402, 'f1-score': 0.2967659933020572, 'support': 179126}, 'accuracy': 0.35600702903320786, 'macro avg': {'precision': 0.3740736533852102, 'recall': 0.3583654072810925, 'f1-score': 0.33097417563191583, 'support': 533217}, 'weighted avg': {'precision': 0.37439380641832853, 'recall': 0.35600702903320786, 'f1-score': 0.33008083246739744, 'support': 533217}}
[[ 34502 115223  29492]
 [ 31199 113767  29908]
 [ 25915 111651  41560]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1112822
{'0': {'precision': 0.3380816714150047, 'recall': 0.25167903852951573, 'f1-score': 0.2885511651469098, 'support': 56580}, '1': {'precision': 0.3627785783375116, 'recall': 0.6080598200105876, 'f1-score': 0.4544341827083565, 'support': 60448}, '2': {'precision': 0.41919016858358277, 'recall': 0.22879009373118928, 'f1-score': 0.2960169114374722, 'support': 58145}, 'accuracy': 0.36705999212207363, 'macro avg': {'precision': 0.3733501394453664, 'recall': 0.36284298409043086, 'f1-score': 0.34633408643091285, 'support': 175173}, 'weighted avg': {'precision': 0.37352624448002425, 'recall': 0.36705999212207363, 'f1-score': 0.34827151282388674, 'support': 175173}}
[[14240 32784  9556]
 [14816 36756  8876]
 [13064 31778 13303]]
training model: results/ATVI/W7/deepLOB_L1/h200
Epoch 1/50
2083/2083 - 35s - loss: 3.2838 - accuracy200: 0.3731 - val_loss: 3.3707 - val_accuracy200: 0.3377 - 35s/epoch - 17ms/step
Epoch 2/50
2083/2083 - 31s - loss: 3.2653 - accuracy200: 0.3827 - val_loss: 3.3937 - val_accuracy200: 0.3199 - 31s/epoch - 15ms/step
Epoch 3/50
2083/2083 - 32s - loss: 3.2542 - accuracy200: 0.3913 - val_loss: 3.3889 - val_accuracy200: 0.3344 - 32s/epoch - 15ms/step
Epoch 4/50
2083/2083 - 31s - loss: 3.2475 - accuracy200: 0.3954 - val_loss: 3.3932 - val_accuracy200: 0.3282 - 31s/epoch - 15ms/step
Epoch 5/50
2083/2083 - 31s - loss: 3.2423 - accuracy200: 0.3991 - val_loss: 3.3955 - val_accuracy200: 0.3316 - 31s/epoch - 15ms/step
Epoch 6/50
2083/2083 - 31s - loss: 3.2390 - accuracy200: 0.4004 - val_loss: 3.4168 - val_accuracy200: 0.3342 - 31s/epoch - 15ms/step
Epoch 7/50
2083/2083 - 30s - loss: 3.2366 - accuracy200: 0.4026 - val_loss: 3.3742 - val_accuracy200: 0.3327 - 30s/epoch - 14ms/step
Epoch 8/50
2083/2083 - 30s - loss: 3.2325 - accuracy200: 0.4046 - val_loss: 3.4427 - val_accuracy200: 0.3376 - 30s/epoch - 14ms/step
Epoch 9/50
2083/2083 - 31s - loss: 3.2304 - accuracy200: 0.4058 - val_loss: 3.4389 - val_accuracy200: 0.3420 - 31s/epoch - 15ms/step
Epoch 10/50
2083/2083 - 31s - loss: 3.2278 - accuracy200: 0.4071 - val_loss: 3.4186 - val_accuracy200: 0.3396 - 31s/epoch - 15ms/step
Epoch 11/50
2083/2083 - 31s - loss: 3.2264 - accuracy200: 0.4079 - val_loss: 3.3762 - val_accuracy200: 0.3416 - 31s/epoch - 15ms/step
testing model: results/ATVI/W7/deepLOB_L1/h200
Evaluating performance on  test set...
6143/6143 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.114951
{'0': {'precision': 0.33547311163948185, 'recall': 0.374200334096393, 'f1-score': 0.353780041257375, 'support': 484890}, '1': {'precision': 0.38401129272149626, 'recall': 0.50504656718366, 'f1-score': 0.43629013114948667, 'support': 582277}, '2': {'precision': 0.3511828854957812, 'recall': 0.1847408154986296, 'f1-score': 0.2421158554296859, 'support': 505335}, 'accuracy': 0.3617667894858003, 'macro avg': {'precision': 0.35688909661891977, 'recall': 0.3546625722595609, 'f1-score': 0.34406200927884917, 'support': 1572502}, 'weighted avg': {'precision': 0.35849461815430034, 'recall': 0.3617667894858003, 'f1-score': 0.348448350910955, 'support': 1572502}}
[[181446 219912  83532]
 [199255 294077  88945]
 [160165 251814  93356]]
Evaluating performance on  train set...
2083/2083 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1127261
{'0': {'precision': 0.35292318982387477, 'recall': 0.29227981519726737, 'f1-score': 0.3197515321466059, 'support': 177703}, '1': {'precision': 0.3245599373204492, 'recall': 0.3545762170243605, 'f1-score': 0.3389047513860368, 'support': 175243}, '2': {'precision': 0.3547551631817224, 'recall': 0.38295122343582716, 'f1-score': 0.36831434897431115, 'support': 180271}, 'accuracy': 0.343408030876735, 'macro avg': {'precision': 0.3440794301086821, 'recall': 0.3432690852191517, 'f1-score': 0.34232354416898464, 'support': 533217}, 'weighted avg': {'precision': 0.34422089828165975, 'recall': 0.343408030876735, 'f1-score': 0.34246448981960365, 'support': 533217}}
[[51939 64156 61608]
 [49150 62137 63956]
 [46079 65157 69035]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1244676
{'0': {'precision': 0.34685607122071094, 'recall': 0.2837768724758831, 'f1-score': 0.3121617164917454, 'support': 56703}, '1': {'precision': 0.3256493318678776, 'recall': 0.3781360201511335, 'f1-score': 0.3499355079333012, 'support': 59550}, '2': {'precision': 0.340527216017708, 'recall': 0.34465376782077395, 'f1-score': 0.3425780656915836, 'support': 58920}, 'accuracy': 0.3363303705479726, 'macro avg': {'precision': 0.33767753970209885, 'recall': 0.33552222014926353, 'f1-score': 0.3348917633722101, 'support': 175173}, 'weighted avg': {'precision': 0.33751811687259703, 'recall': 0.3363303705479726, 'f1-score': 0.3352335402042988, 'support': 175173}}
[[16091 22732 17880]
 [15585 22518 21447]
 [14715 23898 20307]]
training model: results/ATVI/W7/deepLOB_L1/h300
Epoch 1/50
2083/2083 - 35s - loss: 3.2625 - accuracy300: 0.3912 - val_loss: 3.5182 - val_accuracy300: 0.3282 - 35s/epoch - 17ms/step
Epoch 2/50
2083/2083 - 32s - loss: 3.2399 - accuracy300: 0.4016 - val_loss: 3.3721 - val_accuracy300: 0.3363 - 32s/epoch - 16ms/step
Epoch 3/50
2083/2083 - 31s - loss: 3.2275 - accuracy300: 0.4106 - val_loss: 3.4235 - val_accuracy300: 0.3450 - 31s/epoch - 15ms/step
Epoch 4/50
2083/2083 - 32s - loss: 3.2188 - accuracy300: 0.4151 - val_loss: 3.3724 - val_accuracy300: 0.3483 - 32s/epoch - 16ms/step
Epoch 5/50
2083/2083 - 33s - loss: 3.2172 - accuracy300: 0.4156 - val_loss: 3.4607 - val_accuracy300: 0.3278 - 33s/epoch - 16ms/step
Epoch 6/50
2083/2083 - 34s - loss: 3.2146 - accuracy300: 0.4181 - val_loss: 3.4586 - val_accuracy300: 0.3517 - 34s/epoch - 16ms/step
Epoch 7/50
2083/2083 - 34s - loss: 3.2108 - accuracy300: 0.4202 - val_loss: 3.4547 - val_accuracy300: 0.3439 - 34s/epoch - 16ms/step
Epoch 8/50
2083/2083 - 33s - loss: 3.2038 - accuracy300: 0.4243 - val_loss: 3.4378 - val_accuracy300: 0.3283 - 33s/epoch - 16ms/step
Epoch 9/50
2083/2083 - 34s - loss: 3.2000 - accuracy300: 0.4257 - val_loss: 3.4892 - val_accuracy300: 0.3267 - 34s/epoch - 16ms/step
Epoch 10/50
2083/2083 - 33s - loss: 3.1968 - accuracy300: 0.4273 - val_loss: 3.4473 - val_accuracy300: 0.3339 - 33s/epoch - 16ms/step
Epoch 11/50
2083/2083 - 33s - loss: 3.1949 - accuracy300: 0.4280 - val_loss: 3.4458 - val_accuracy300: 0.3370 - 33s/epoch - 16ms/step
Epoch 12/50
2083/2083 - 33s - loss: 3.1904 - accuracy300: 0.4296 - val_loss: 3.5071 - val_accuracy300: 0.3321 - 33s/epoch - 16ms/step
testing model: results/ATVI/W7/deepLOB_L1/h300
Evaluating performance on  test set...
6143/6143 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.121027
{'0': {'precision': 0.2722822621864149, 'recall': 0.5930201866027061, 'f1-score': 0.3732079532569208, 'support': 435685}, '1': {'precision': 0.5018673551635662, 'recall': 0.2284922694542929, 'f1-score': 0.3140173883690417, 'support': 683975}, '2': {'precision': 0.3470982786344388, 'recall': 0.23929317510301606, 'f1-score': 0.2832860152986265, 'support': 452842}, 'accuracy': 0.3326005308737286, 'macro avg': {'precision': 0.3737492986614733, 'recall': 0.3536018770533384, 'f1-score': 0.32350378564152965, 'support': 1572502}, 'weighted avg': {'precision': 0.39368770299946515, 'recall': 0.3326005308737286, 'f1-score': 0.32156713063914544, 'support': 1572502}}
[[258370  76013 101302]
 [425162 156283 102530]
 [265373  79107 108362]]
Evaluating performance on  train set...
2083/2083 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1217923
{'0': {'precision': 0.3290515828482387, 'recall': 0.4597872316422423, 'f1-score': 0.3835858823529411, 'support': 177282}, '1': {'precision': 0.3427213330722259, 'recall': 0.10910543855274195, 'f1-score': 0.16551813081701525, 'support': 176444}, '2': {'precision': 0.35505912928207634, 'recall': 0.45364391529380305, 'f1-score': 0.39834254278788417, 'support': 179491}, 'accuracy': 0.3416770283017983, 'macro avg': {'precision': 0.342277348400847, 'recall': 0.34084552849626243, 'f1-score': 0.31581551865261354, 'support': 533217}, 'weighted avg': {'precision': 0.3423296027265943, 'recall': 0.3416770283017983, 'f1-score': 0.31639361613885464, 'support': 533217}}
[[81512 18331 77439]
 [86729 19251 70464]
 [79477 18589 81425]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1243674
{'0': {'precision': 0.31246423105077525, 'recall': 0.42631970800268754, 'f1-score': 0.3606187213910479, 'support': 55069}, '1': {'precision': 0.37514979029358897, 'recall': 0.1605268639735927, 'f1-score': 0.22484317312116348, 'support': 62407}, '2': {'precision': 0.34937409659912183, 'recall': 0.44406121635440315, 'f1-score': 0.391067762590532, 'support': 57697}, 'accuracy': 0.3374720990106923, 'macro avg': {'precision': 0.34566270598116206, 'recall': 0.34363592944356114, 'f1-score': 0.3255098857009145, 'support': 175173}, 'weighted avg': {'precision': 0.3469535998930582, 'recall': 0.3374720990106923, 'f1-score': 0.3222764750928624, 'support': 175173}}
[[23477  8189 23403]
 [28079 10018 24310]
 [23579  8497 25621]]
training model: results/ATVI/W7/deepLOB_L1/h500
Epoch 1/50
2083/2083 - 35s - loss: 3.2266 - accuracy500: 0.4144 - val_loss: 3.4704 - val_accuracy500: 0.3162 - 35s/epoch - 17ms/step
Epoch 2/50
2083/2083 - 31s - loss: 3.2111 - accuracy500: 0.4197 - val_loss: 3.5429 - val_accuracy500: 0.3272 - 31s/epoch - 15ms/step
Epoch 3/50
2083/2083 - 31s - loss: 3.1957 - accuracy500: 0.4269 - val_loss: 3.4191 - val_accuracy500: 0.3334 - 31s/epoch - 15ms/step
Epoch 4/50
2083/2083 - 31s - loss: 3.1796 - accuracy500: 0.4340 - val_loss: 3.4363 - val_accuracy500: 0.3374 - 31s/epoch - 15ms/step
Epoch 5/50
2083/2083 - 32s - loss: 3.1684 - accuracy500: 0.4393 - val_loss: 3.3816 - val_accuracy500: 0.3329 - 32s/epoch - 15ms/step
Epoch 6/50
2083/2083 - 31s - loss: 3.1639 - accuracy500: 0.4421 - val_loss: 3.3934 - val_accuracy500: 0.3428 - 31s/epoch - 15ms/step
Epoch 7/50
2083/2083 - 32s - loss: 3.1610 - accuracy500: 0.4418 - val_loss: 3.3902 - val_accuracy500: 0.3489 - 32s/epoch - 15ms/step
Epoch 8/50
2083/2083 - 31s - loss: 3.1567 - accuracy500: 0.4452 - val_loss: 3.3812 - val_accuracy500: 0.3439 - 31s/epoch - 15ms/step
Epoch 9/50
2083/2083 - 31s - loss: 3.1533 - accuracy500: 0.4451 - val_loss: 3.4011 - val_accuracy500: 0.3502 - 31s/epoch - 15ms/step
Epoch 10/50
2083/2083 - 30s - loss: 3.1470 - accuracy500: 0.4478 - val_loss: 3.4003 - val_accuracy500: 0.3534 - 30s/epoch - 14ms/step
Epoch 11/50
2083/2083 - 30s - loss: 3.1459 - accuracy500: 0.4495 - val_loss: 3.4100 - val_accuracy500: 0.3421 - 30s/epoch - 15ms/step
Epoch 12/50
2083/2083 - 30s - loss: 3.1434 - accuracy500: 0.4484 - val_loss: 3.3982 - val_accuracy500: 0.3441 - 30s/epoch - 15ms/step
Epoch 13/50
2083/2083 - 31s - loss: 3.1363 - accuracy500: 0.4536 - val_loss: 3.4363 - val_accuracy500: 0.3417 - 31s/epoch - 15ms/step
Epoch 14/50
2083/2083 - 31s - loss: 3.1293 - accuracy500: 0.4561 - val_loss: 3.3961 - val_accuracy500: 0.3445 - 31s/epoch - 15ms/step
Epoch 15/50
2083/2083 - 31s - loss: 3.1238 - accuracy500: 0.4587 - val_loss: 3.4141 - val_accuracy500: 0.3398 - 31s/epoch - 15ms/step
Epoch 16/50
2083/2083 - 31s - loss: 3.1208 - accuracy500: 0.4601 - val_loss: 3.3977 - val_accuracy500: 0.3470 - 31s/epoch - 15ms/step
Epoch 17/50
2083/2083 - 30s - loss: 3.1184 - accuracy500: 0.4607 - val_loss: 3.4015 - val_accuracy500: 0.3407 - 30s/epoch - 15ms/step
Epoch 18/50
2083/2083 - 30s - loss: 3.1162 - accuracy500: 0.4614 - val_loss: 3.3928 - val_accuracy500: 0.3493 - 30s/epoch - 15ms/step
testing model: results/ATVI/W7/deepLOB_L1/h500
Evaluating performance on  test set...
6143/6143 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1017678
{'0': {'precision': 0.2951932360083087, 'recall': 0.13827063496232617, 'f1-score': 0.18832737357350726, 'support': 437837}, '1': {'precision': 0.44004388820812035, 'recall': 0.6322457362422357, 'f1-score': 0.5189192653461504, 'support': 678744}, '2': {'precision': 0.2949891767441505, 'recall': 0.2537676483425857, 'f1-score': 0.27283017266180265, 'support': 455921}, 'accuracy': 0.3849731192710725, 'macro avg': {'precision': 0.3434087669868598, 'recall': 0.34142800651571587, 'f1-score': 0.32669227052715344, 'support': 1572502}, 'weighted avg': {'precision': 0.3576564164512809, 'recall': 0.3849731192710725, 'f1-score': 0.355521986777475, 'support': 1572502}}
[[ 60540 264929 112368]
 [ 85466 429133 164145]
 [ 59080 281143 115698]]
Evaluating performance on  train set...
2083/2083 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1314695
{'0': {'precision': 0.3144280405290922, 'recall': 0.15713769588583298, 'f1-score': 0.20955083881312742, 'support': 177144}, '1': {'precision': 0.3355519266297176, 'recall': 0.4553670861990811, 'f1-score': 0.38638419514372474, 'support': 178691}, '2': {'precision': 0.35233837144891983, 'recall': 0.40161910453146316, 'f1-score': 0.3753681759024591, 'support': 177382}, 'accuracy': 0.33841006569557985, 'macro avg': {'precision': 0.33410611286924324, 'recall': 0.3380412955387924, 'f1-score': 0.3237677366197704, 'support': 533217}, 'weighted avg': {'precision': 0.3341184454682215, 'recall': 0.33841006569557985, 'f1-score': 0.3239724348306036, 'support': 533217}}
[[27836 80597 68711]
 [35080 81370 62241]
 [25613 80529 71240]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1268085
{'0': {'precision': 0.3291356611333715, 'recall': 0.07020389653428218, 'f1-score': 0.1157241022397286, 'support': 57333}, '1': {'precision': 0.3365704741784557, 'recall': 0.5325527669851937, 'f1-score': 0.412465180586525, 'support': 57138}, '2': {'precision': 0.35302957193079204, 'recall': 0.4218477150670489, 'f1-score': 0.38438271651268047, 'support': 60702}, 'accuracy': 0.3428667659970429, 'macro avg': {'precision': 0.3395785690808731, 'recall': 0.341534792862175, 'f1-score': 0.3041906664463114, 'support': 175173}, 'weighted avg': {'precision': 0.3398406129295675, 'recall': 0.3428667659970429, 'f1-score': 0.3056124237172164, 'support': 175173}}
[[ 4025 28982 24326]
 [ 4107 30429 22602]
 [ 4097 30998 25607]]
training model: results/ATVI/W7/deepLOB_L1/h1000
Epoch 1/50
2083/2083 - 35s - loss: 3.2561 - accuracy1000: 0.3984 - val_loss: 3.3760 - val_accuracy1000: 0.3296 - 35s/epoch - 17ms/step
Epoch 2/50
2083/2083 - 32s - loss: 3.1940 - accuracy1000: 0.4270 - val_loss: 3.3244 - val_accuracy1000: 0.3352 - 32s/epoch - 15ms/step
Epoch 3/50
2083/2083 - 31s - loss: 3.1675 - accuracy1000: 0.4387 - val_loss: 3.3415 - val_accuracy1000: 0.3345 - 31s/epoch - 15ms/step
Epoch 4/50
2083/2083 - 30s - loss: 3.1460 - accuracy1000: 0.4469 - val_loss: 3.3275 - val_accuracy1000: 0.3285 - 30s/epoch - 15ms/step
Epoch 5/50
2083/2083 - 31s - loss: 3.1316 - accuracy1000: 0.4533 - val_loss: 3.3429 - val_accuracy1000: 0.3318 - 31s/epoch - 15ms/step
Epoch 6/50
2083/2083 - 31s - loss: 3.1198 - accuracy1000: 0.4594 - val_loss: 3.3513 - val_accuracy1000: 0.3303 - 31s/epoch - 15ms/step
Epoch 7/50
2083/2083 - 31s - loss: 3.1115 - accuracy1000: 0.4624 - val_loss: 3.3486 - val_accuracy1000: 0.3293 - 31s/epoch - 15ms/step
Epoch 8/50
2083/2083 - 32s - loss: 3.1048 - accuracy1000: 0.4644 - val_loss: 3.3660 - val_accuracy1000: 0.3257 - 32s/epoch - 15ms/step
Epoch 9/50
2083/2083 - 31s - loss: 3.0943 - accuracy1000: 0.4675 - val_loss: 3.3686 - val_accuracy1000: 0.3279 - 31s/epoch - 15ms/step
Epoch 10/50
2083/2083 - 31s - loss: 3.0888 - accuracy1000: 0.4686 - val_loss: 3.3883 - val_accuracy1000: 0.3357 - 31s/epoch - 15ms/step
Epoch 11/50
2083/2083 - 31s - loss: 3.0838 - accuracy1000: 0.4704 - val_loss: 3.4083 - val_accuracy1000: 0.3351 - 31s/epoch - 15ms/step
Epoch 12/50
2083/2083 - 30s - loss: 3.0827 - accuracy1000: 0.4712 - val_loss: 3.4547 - val_accuracy1000: 0.3225 - 30s/epoch - 15ms/step
testing model: results/ATVI/W7/deepLOB_L1/h1000
Evaluating performance on  test set...
6143/6143 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1101621
{'0': {'precision': 0.3058523470191216, 'recall': 0.3542906769219901, 'f1-score': 0.3282944184327255, 'support': 481311}, '1': {'precision': 0.38041017591475046, 'recall': 0.4161076006190627, 'f1-score': 0.39745896504606815, 'support': 584755}, '2': {'precision': 0.33990786946131074, 'recall': 0.25191732025369445, 'f1-score': 0.28937152759270246, 'support': 506436}, 'accuracy': 0.3443079881615413, 'macro avg': {'precision': 0.34205679746506096, 'recall': 0.34077186593158243, 'f1-score': 0.3383749703571654, 'support': 1572502}, 'weighted avg': {'precision': 0.344545465246886, 'recall': 0.3443079881615413, 'f1-score': 0.34147873318045063, 'support': 1572502}}
[[170524 193256 117531]
 [211208 243321 130226]
 [175805 203051 127580]]
Evaluating performance on  train set...
2083/2083 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1156776
{'0': {'precision': 0.3325849226055259, 'recall': 0.2827024114239526, 'f1-score': 0.305621632118064, 'support': 178152}, '1': {'precision': 0.3293307269850135, 'recall': 0.3401326690455859, 'f1-score': 0.33464455213624805, 'support': 176831}, '2': {'precision': 0.344386755977786, 'recall': 0.3848087345848716, 'f1-score': 0.36347737606919134, 'support': 178234}, 'accuracy': 0.3358782634462142, 'macro avg': {'precision': 0.3354341351894418, 'recall': 0.33588127168480336, 'f1-score': 0.33458118677450116, 'support': 533217}, 'weighted avg': {'precision': 0.3354506326325892, 'recall': 0.3358782634462142, 'f1-score': 0.3345854735505778, 'support': 533217}}
[[50364 61568 66220]
 [52337 60146 64348]
 [48731 60917 68586]]
Evaluating performance on  val set...
685/685 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1073008
{'0': {'precision': 0.3298306537082554, 'recall': 0.2667602859644003, 'f1-score': 0.2949616350235433, 'support': 54832}, '1': {'precision': 0.3509006334125099, 'recall': 0.3463247863247863, 'f1-score': 0.3485976943686552, 'support': 61425}, '2': {'precision': 0.3308880088886357, 'recall': 0.3942732025256297, 'f1-score': 0.35981040598522285, 'support': 58916}, 'accuracy': 0.33754631136076907, 'macro avg': {'precision': 0.33720643200313366, 'recall': 0.3357860916049387, 'f1-score': 0.33445657845914045, 'support': 175173}, 'weighted avg': {'precision': 0.3375745334222588, 'recall': 0.33754631136076907, 'f1-score': 0.3355799103014218, 'support': 175173}}
[[14627 19317 20888]
 [14067 21273 26085]
 [15653 20034 23229]]
training model: results/ATVI/W7/deepOF_L1/h10
Epoch 1/50
2083/2083 - 32s - loss: 3.2014 - accuracy10: 0.4089 - val_loss: 3.3313 - val_accuracy10: 0.5299 - 32s/epoch - 15ms/step
Epoch 2/50
2083/2083 - 27s - loss: 3.1730 - accuracy10: 0.4002 - val_loss: 3.2598 - val_accuracy10: 0.5243 - 27s/epoch - 13ms/step
Epoch 3/50
2083/2083 - 28s - loss: 3.1577 - accuracy10: 0.4107 - val_loss: 3.2694 - val_accuracy10: 0.5296 - 28s/epoch - 13ms/step
Epoch 4/50
2083/2083 - 28s - loss: 3.1477 - accuracy10: 0.4189 - val_loss: 3.2939 - val_accuracy10: 0.5316 - 28s/epoch - 14ms/step
Epoch 5/50
2083/2083 - 27s - loss: 3.1369 - accuracy10: 0.4255 - val_loss: 3.3159 - val_accuracy10: 0.5318 - 27s/epoch - 13ms/step
Epoch 6/50
2083/2083 - 27s - loss: 3.1272 - accuracy10: 0.4306 - val_loss: 3.3359 - val_accuracy10: 0.5313 - 27s/epoch - 13ms/step
Epoch 7/50
2083/2083 - 27s - loss: 3.1179 - accuracy10: 0.4370 - val_loss: 3.3622 - val_accuracy10: 0.5306 - 27s/epoch - 13ms/step
Epoch 8/50
2083/2083 - 27s - loss: 3.1097 - accuracy10: 0.4416 - val_loss: 3.4088 - val_accuracy10: 0.5316 - 27s/epoch - 13ms/step
Epoch 9/50
2083/2083 - 27s - loss: 3.0999 - accuracy10: 0.4450 - val_loss: 3.4284 - val_accuracy10: 0.5313 - 27s/epoch - 13ms/step
Epoch 10/50
2083/2083 - 27s - loss: 3.0929 - accuracy10: 0.4492 - val_loss: 3.4468 - val_accuracy10: 0.5321 - 27s/epoch - 13ms/step
Epoch 11/50
2083/2083 - 27s - loss: 3.0864 - accuracy10: 0.4516 - val_loss: 3.4539 - val_accuracy10: 0.5296 - 27s/epoch - 13ms/step
Epoch 12/50
2083/2083 - 28s - loss: 3.0806 - accuracy10: 0.4543 - val_loss: 3.4562 - val_accuracy10: 0.5304 - 28s/epoch - 13ms/step
testing model: results/ATVI/W7/deepOF_L1/h10
Evaluating performance on  test set...
6143/6143 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96152806
{'0': {'precision': 0.3665828009272347, 'recall': 0.16390852469687825, 'f1-score': 0.2265297967258649, 'support': 316457}, '1': {'precision': 0.617850078998186, 'recall': 0.838729391428868, 'f1-score': 0.7115423926721871, 'support': 944146}, '2': {'precision': 0.3688172187027042, 'recall': 0.17657922242813265, 'f1-score': 0.2388187849616235, 'support': 311894}, 'accuracy': 0.5715921874572734, 'macro avg': {'precision': 0.45108336620937495, 'recall': 0.39307237951795965, 'f1-score': 0.3922969914532252, 'support': 1572497}, 'weighted avg': {'precision': 0.5178898603488035, 'recall': 0.5715921874572734, 'f1-score': 0.5201745948457597, 'support': 1572497}}
[[ 51870 247921  16666]
 [ 74677 791883  77586]
 [ 14949 241871  55074]]
Evaluating performance on  train set...
2083/2083 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.007233
{'0': {'precision': 0.385405111473627, 'recall': 0.13934742090486563, 'f1-score': 0.20468775269736383, 'support': 127157}, '1': {'precision': 0.5368451025056947, 'recall': 0.8398367899650774, 'f1-score': 0.6549984714154694, 'support': 280620}, '2': {'precision': 0.3791173483136751, 'recall': 0.14579995057358558, 'f1-score': 0.21060571165361586, 'support': 125439}, 'accuracy': 0.5095177188981576, 'macro avg': {'precision': 0.4337891874309989, 'recall': 0.37499472048117616, 'f1-score': 0.35676397858881637, 'support': 533216}, 'weighted avg': {'precision': 0.4636254941335578, 'recall': 0.5095177188981576, 'f1-score': 0.4430687028942598, 'support': 533216}}
[[ 17719 102777   6661]
 [ 21654 235675  23291]
 [  6602 100548  18289]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.00177
{'0': {'precision': 0.39747211895910783, 'recall': 0.13203586159203734, 'f1-score': 0.19822391961289607, 'support': 40489}, '1': {'precision': 0.5487663153369206, 'recall': 0.8694231587909749, 'f1-score': 0.6728440057160977, 'support': 93960}, '2': {'precision': 0.3993779160186625, 'recall': 0.1261172772812101, 'f1-score': 0.19169901463123323, 'support': 40724}, 'accuracy': 0.5261826879713197, 'macro avg': {'precision': 0.44853878343823034, 'recall': 0.3758587658880741, 'f1-score': 0.35425564665340903, 'support': 175173}, 'weighted avg': {'precision': 0.47906696731537607, 'recall': 0.5261826879713197, 'f1-score': 0.4512856532121584, 'support': 175173}}
[[ 5346 33360  1783]
 [ 6328 81691  5941]
 [ 1776 33812  5136]]
training model: results/ATVI/W7/deepOF_L1/h20
Epoch 1/50
2083/2083 - 31s - loss: 3.2361 - accuracy20: 0.4048 - val_loss: 3.3361 - val_accuracy20: 0.4284 - 31s/epoch - 15ms/step
Epoch 2/50
2083/2083 - 28s - loss: 3.2112 - accuracy20: 0.4059 - val_loss: 3.2978 - val_accuracy20: 0.4316 - 28s/epoch - 14ms/step
Epoch 3/50
2083/2083 - 29s - loss: 3.1974 - accuracy20: 0.4137 - val_loss: 3.3140 - val_accuracy20: 0.4321 - 29s/epoch - 14ms/step
Epoch 4/50
2083/2083 - 27s - loss: 3.1855 - accuracy20: 0.4204 - val_loss: 3.3369 - val_accuracy20: 0.4324 - 27s/epoch - 13ms/step
Epoch 5/50
2083/2083 - 28s - loss: 3.1747 - accuracy20: 0.4270 - val_loss: 3.3818 - val_accuracy20: 0.4310 - 28s/epoch - 13ms/step
Epoch 6/50
2083/2083 - 28s - loss: 3.1623 - accuracy20: 0.4338 - val_loss: 3.4123 - val_accuracy20: 0.4313 - 28s/epoch - 13ms/step
Epoch 7/50
2083/2083 - 29s - loss: 3.1529 - accuracy20: 0.4386 - val_loss: 3.4326 - val_accuracy20: 0.4337 - 29s/epoch - 14ms/step
Epoch 8/50
2083/2083 - 29s - loss: 3.1438 - accuracy20: 0.4429 - val_loss: 3.4658 - val_accuracy20: 0.4335 - 29s/epoch - 14ms/step
Epoch 9/50
2083/2083 - 29s - loss: 3.1353 - accuracy20: 0.4475 - val_loss: 3.5062 - val_accuracy20: 0.4318 - 29s/epoch - 14ms/step
Epoch 10/50
2083/2083 - 29s - loss: 3.1284 - accuracy20: 0.4501 - val_loss: 3.5418 - val_accuracy20: 0.4325 - 29s/epoch - 14ms/step
Epoch 11/50
2083/2083 - 30s - loss: 3.1219 - accuracy20: 0.4532 - val_loss: 3.5581 - val_accuracy20: 0.4328 - 30s/epoch - 14ms/step
Epoch 12/50
2083/2083 - 30s - loss: 3.1161 - accuracy20: 0.4554 - val_loss: 3.5847 - val_accuracy20: 0.4327 - 30s/epoch - 14ms/step
testing model: results/ATVI/W7/deepOF_L1/h20
Evaluating performance on  test set...
6143/6143 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0198607
{'0': {'precision': 0.43899202726971165, 'recall': 0.09507647638819385, 'f1-score': 0.1563013539628205, 'support': 403654}, '1': {'precision': 0.5012861419853742, 'recall': 0.8839928500187817, 'f1-score': 0.6397749014983131, 'support': 772030}, '2': {'precision': 0.43638687135023213, 'recall': 0.1359683276505558, 'f1-score': 0.20733556088853708, 'support': 396813}, 'accuracy': 0.4927201768906395, 'macro avg': {'precision': 0.4588883468684393, 'recall': 0.3716792180191771, 'f1-score': 0.3344706054498902, 'support': 1572497}, 'weighted avg': {'precision': 0.46891842181803606, 'recall': 0.4927201768906395, 'f1-score': 0.40654483274633535, 'support': 1572497}}
[[ 38378 347923  17353]
 [ 37230 682469  52331]
 [ 11815 331044  53954]]
Evaluating performance on  train set...
2083/2083 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0699972
{'0': {'precision': 0.449016480595428, 'recall': 0.08012877273762238, 'f1-score': 0.13598965237785995, 'support': 158108}, '1': {'precision': 0.41623059695563575, 'recall': 0.884373232111247, 'f1-score': 0.5660496918532751, 'support': 219188}, '2': {'precision': 0.44313785379759724, 'recall': 0.11165982555156491, 'f1-score': 0.17837383713782223, 'support': 155920}, 'accuracy': 0.41994801356298384, 'macro avg': {'precision': 0.43612831044955364, 'recall': 0.3587206101334781, 'f1-score': 0.2934710604563191, 'support': 533216}, 'weighted avg': {'precision': 0.43382026038906407, 'recall': 0.41994801356298384, 'f1-score': 0.3251672877457233, 'support': 533216}}
[[ 12669 138430   7009]
 [ 10475 193844  14869]
 [  5071 133439  17410]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0663992
{'0': {'precision': 0.45568989156175993, 'recall': 0.07249509230433662, 'f1-score': 0.12508981421288534, 'support': 50431}, '1': {'precision': 0.42901189346209956, 'recall': 0.9099814882375992, 'f1-score': 0.5831139819208256, 'support': 74007}, '2': {'precision': 0.4626953700973164, 'recall': 0.09277619000689859, 'f1-score': 0.1545609772115321, 'support': 50735}, 'accuracy': 0.43218989227791954, 'macro avg': {'precision': 0.44913238504039193, 'recall': 0.3584175901829448, 'f1-score': 0.2875882577817477, 'support': 175173}, 'weighted avg': {'precision': 0.44644796699655803, 'recall': 0.43218989227791954, 'f1-score': 0.3271313048210149, 'support': 175173}}
[[ 3656 44995  1780]
 [ 2976 67345  3686]
 [ 1391 44637  4707]]
training model: results/ATVI/W7/deepOF_L1/h30
Epoch 1/50
2083/2083 - 31s - loss: 3.2557 - accuracy30: 0.4007 - val_loss: 3.3559 - val_accuracy30: 0.3647 - 31s/epoch - 15ms/step
Epoch 2/50
2083/2083 - 28s - loss: 3.2336 - accuracy30: 0.4046 - val_loss: 3.3167 - val_accuracy30: 0.3696 - 28s/epoch - 14ms/step
Epoch 3/50
2083/2083 - 28s - loss: 3.2186 - accuracy30: 0.4117 - val_loss: 3.3531 - val_accuracy30: 0.3636 - 28s/epoch - 13ms/step
Epoch 4/50
2083/2083 - 27s - loss: 3.2038 - accuracy30: 0.4201 - val_loss: 3.4027 - val_accuracy30: 0.3591 - 27s/epoch - 13ms/step
Epoch 5/50
2083/2083 - 28s - loss: 3.1923 - accuracy30: 0.4259 - val_loss: 3.4343 - val_accuracy30: 0.3587 - 28s/epoch - 13ms/step
Epoch 6/50
2083/2083 - 27s - loss: 3.1808 - accuracy30: 0.4320 - val_loss: 3.4391 - val_accuracy30: 0.3624 - 27s/epoch - 13ms/step
Epoch 7/50
2083/2083 - 27s - loss: 3.1714 - accuracy30: 0.4367 - val_loss: 3.4796 - val_accuracy30: 0.3619 - 27s/epoch - 13ms/step
Epoch 8/50
2083/2083 - 27s - loss: 3.1636 - accuracy30: 0.4395 - val_loss: 3.5101 - val_accuracy30: 0.3625 - 27s/epoch - 13ms/step
Epoch 9/50
2083/2083 - 27s - loss: 3.1569 - accuracy30: 0.4427 - val_loss: 3.5278 - val_accuracy30: 0.3635 - 27s/epoch - 13ms/step
Epoch 10/50
2083/2083 - 28s - loss: 3.1517 - accuracy30: 0.4447 - val_loss: 3.5555 - val_accuracy30: 0.3622 - 28s/epoch - 13ms/step
Epoch 11/50
2083/2083 - 27s - loss: 3.1467 - accuracy30: 0.4467 - val_loss: 3.5604 - val_accuracy30: 0.3633 - 27s/epoch - 13ms/step
Epoch 12/50
2083/2083 - 27s - loss: 3.1418 - accuracy30: 0.4477 - val_loss: 3.6139 - val_accuracy30: 0.3623 - 27s/epoch - 13ms/step
testing model: results/ATVI/W7/deepOF_L1/h30
Evaluating performance on  test set...
6143/6143 - 42s - 42s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0590861
{'0': {'precision': 0.4537950942939621, 'recall': 0.11356901526654814, 'f1-score': 0.18167191446662748, 'support': 462318}, '1': {'precision': 0.42605636440171435, 'recall': 0.8685667953880193, 'f1-score': 0.5716851398567137, 'support': 654903}, '2': {'precision': 0.47301905552314355, 'recall': 0.1264397859759794, 'f1-score': 0.199541399684214, 'support': 455276}, 'accuracy': 0.43173182524354575, 'macro avg': {'precision': 0.45095683807294, 'recall': 0.3695251988768489, 'f1-score': 0.31763281800251836, 'support': 1572497}, 'weighted avg': {'precision': 0.44780845695853577, 'recall': 0.43173182524354575, 'f1-score': 0.3492756549504348, 'support': 1572497}}
[[ 52505 389635  20178]
 [ 42122 568827  43954]
 [ 21075 376636  57565]]
Evaluating performance on  train set...
2083/2083 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1059525
{'0': {'precision': 0.45841350714111495, 'recall': 0.0953989667696889, 'f1-score': 0.15793134678138435, 'support': 177308}, '1': {'precision': 0.3429090615233074, 'recall': 0.8686155616535364, 'f1-score': 0.49170465275418057, 'support': 180752}, '2': {'precision': 0.46557283270060845, 'recall': 0.1022231610678481, 'f1-score': 0.1676388251706349, 'support': 175156}, 'accuracy': 0.3597491448118586, 'macro avg': {'precision': 0.42229846712167696, 'recall': 0.35541256316369113, 'f1-score': 0.27242494156873326, 'support': 533216}, 'weighted avg': {'precision': 0.42161104673742994, 'recall': 0.3597491448118586, 'f1-score': 0.27426415691075484, 'support': 533216}}
[[ 16915 152255   8138]
 [ 11333 157004  12415]
 [  8651 148600  17905]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1031451
{'0': {'precision': 0.4555137269304931, 'recall': 0.08726012699417797, 'f1-score': 0.14646315540859708, 'support': 56853}, '1': {'precision': 0.3559329718945739, 'recall': 0.8945577677568496, 'f1-score': 0.5092442426208239, 'support': 61427}, '2': {'precision': 0.48004848974643904, 'recall': 0.08352521399820716, 'f1-score': 0.1422924901185771, 'support': 56893}, 'accuracy': 0.3691379379242235, 'macro avg': {'precision': 0.430498396190502, 'recall': 0.35511436958307824, 'f1-score': 0.2659999627159994, 'support': 175173}, 'weighted avg': {'precision': 0.42856270834484467, 'recall': 0.3691379379242235, 'f1-score': 0.2723231462966926, 'support': 175173}}
[[ 4961 49790  2102]
 [ 3432 54950  3045]
 [ 2498 49643  4752]]
training model: results/ATVI/W7/deepOF_L1/h50
Epoch 1/50
2083/2083 - 32s - loss: 3.2716 - accuracy50: 0.3876 - val_loss: 3.3327 - val_accuracy50: 0.3491 - 32s/epoch - 15ms/step
Epoch 2/50
2083/2083 - 28s - loss: 3.2488 - accuracy50: 0.3957 - val_loss: 3.3063 - val_accuracy50: 0.3565 - 28s/epoch - 14ms/step
Epoch 3/50
2083/2083 - 28s - loss: 3.2364 - accuracy50: 0.4018 - val_loss: 3.3308 - val_accuracy50: 0.3509 - 28s/epoch - 13ms/step
Epoch 4/50
2083/2083 - 27s - loss: 3.2263 - accuracy50: 0.4084 - val_loss: 3.3639 - val_accuracy50: 0.3475 - 27s/epoch - 13ms/step
Epoch 5/50
2083/2083 - 28s - loss: 3.2182 - accuracy50: 0.4140 - val_loss: 3.4000 - val_accuracy50: 0.3460 - 28s/epoch - 13ms/step
Epoch 6/50
2083/2083 - 28s - loss: 3.2109 - accuracy50: 0.4176 - val_loss: 3.4343 - val_accuracy50: 0.3465 - 28s/epoch - 13ms/step
Epoch 7/50
2083/2083 - 27s - loss: 3.2052 - accuracy50: 0.4206 - val_loss: 3.4793 - val_accuracy50: 0.3468 - 27s/epoch - 13ms/step
Epoch 8/50
2083/2083 - 28s - loss: 3.2000 - accuracy50: 0.4239 - val_loss: 3.5178 - val_accuracy50: 0.3465 - 28s/epoch - 13ms/step
Epoch 9/50
2083/2083 - 27s - loss: 3.1965 - accuracy50: 0.4252 - val_loss: 3.5490 - val_accuracy50: 0.3460 - 27s/epoch - 13ms/step
Epoch 10/50
2083/2083 - 27s - loss: 3.1926 - accuracy50: 0.4275 - val_loss: 3.5515 - val_accuracy50: 0.3466 - 27s/epoch - 13ms/step
Epoch 11/50
2083/2083 - 27s - loss: 3.1899 - accuracy50: 0.4283 - val_loss: 3.5687 - val_accuracy50: 0.3469 - 27s/epoch - 13ms/step
Epoch 12/50
2083/2083 - 27s - loss: 3.1878 - accuracy50: 0.4294 - val_loss: 3.5868 - val_accuracy50: 0.3476 - 27s/epoch - 13ms/step
testing model: results/ATVI/W7/deepOF_L1/h50
Evaluating performance on  test set...
6143/6143 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0727732
{'0': {'precision': 0.434011906349649, 'recall': 0.07516851809075828, 'f1-score': 0.12814330743332136, 'support': 476210}, '1': {'precision': 0.39675520879442344, 'recall': 0.8330079229876549, 'f1-score': 0.5375022618110863, 'support': 618706}, '2': {'precision': 0.42923330628484674, 'recall': 0.1716776839949663, 'f1-score': 0.24526021693219818, 'support': 477581}, 'accuracy': 0.40265450426932453, 'macro avg': {'precision': 0.42000014047630635, 'recall': 0.35995137502445984, 'f1-score': 0.30363526205886865, 'support': 1572497}, 'weighted avg': {'precision': 0.41790178918239734, 'recall': 0.40265450426932453, 'f1-score': 0.3247768475816539, 'support': 1572497}}
[[ 35796 404332  36082]
 [ 30376 515387  72943]
 [ 16305 379286  81990]]
Evaluating performance on  train set...
2083/2083 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1036159
{'0': {'precision': 0.4429174692547044, 'recall': 0.06726825728125299, 'f1-score': 0.11679780411923008, 'support': 177751}, '1': {'precision': 0.33370645120044506, 'recall': 0.8348007609299507, 'f1-score': 0.4768107487868512, 'support': 178203}, '2': {'precision': 0.4301388452181972, 'recall': 0.14663041148131015, 'f1-score': 0.21870595610230176, 'support': 177262}, 'accuracy': 0.3501639110604333, 'macro avg': {'precision': 0.40225425522444885, 'recall': 0.3495664765641713, 'f1-score': 0.27077150300279434, 'support': 533216}, 'weighted avg': {'precision': 0.4021705758676295, 'recall': 0.3501639110604333, 'f1-score': 0.2709939077909641, 'support': 533216}}
[[ 11957 151875  13919]
 [  8923 148764  20516]
 [  6116 145154  25992]]
Evaluating performance on  val set...
685/685 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1020479
{'0': {'precision': 0.43263684143058584, 'recall': 0.0588132787313758, 'f1-score': 0.10354984199061149, 'support': 57385}, '1': {'precision': 0.3435764336047656, 'recall': 0.8689639045248794, 'f1-score': 0.49244632918102305, 'support': 59869}, '2': {'precision': 0.4422365699241522, 'recall': 0.1218080422659231, 'f1-score': 0.19100606454407623, 'support': 57919}, 'accuracy': 0.3565275470534843, 'macro avg': {'precision': 0.40614994831983453, 'recall': 0.3498617418407261, 'f1-score': 0.26233407857190355, 'support': 175173}, 'weighted avg': {'precision': 0.40537264614075713, 'recall': 0.3565275470534843, 'f1-score': 0.26537969445461496, 'support': 175173}}
[[ 3375 50315  3695]
 [ 2642 52024  5203]
 [ 1784 49080  7055]]
training model: results/ATVI/W7/deepOF_L1/h100
Epoch 1/50
2083/2083 - 30s - loss: 3.2822 - accuracy100: 0.3796 - val_loss: 3.2833 - val_accuracy100: 0.3635 - 30s/epoch - 14ms/step
Epoch 2/50
2083/2083 - 27s - loss: 3.2663 - accuracy100: 0.3865 - val_loss: 3.2819 - val_accuracy100: 0.3665 - 27s/epoch - 13ms/step
Epoch 3/50
2083/2083 - 27s - loss: 3.2637 - accuracy100: 0.3870 - val_loss: 3.2819 - val_accuracy100: 0.3683 - 27s/epoch - 13ms/step
Epoch 4/50
2083/2083 - 27s - loss: 3.2597 - accuracy100: 0.3898 - val_loss: 3.2801 - val_accuracy100: 0.3698 - 27s/epoch - 13ms/step
Epoch 5/50
2083/2083 - 27s - loss: 3.2567 - accuracy100: 0.3916 - val_loss: 3.2791 - val_accuracy100: 0.3695 - 27s/epoch - 13ms/step
Epoch 6/50
2083/2083 - 27s - loss: 3.2531 - accuracy100: 0.3942 - val_loss: 3.2807 - val_accuracy100: 0.3680 - 27s/epoch - 13ms/step
Epoch 7/50
2083/2083 - 27s - loss: 3.2493 - accuracy100: 0.3968 - val_loss: 3.2827 - val_accuracy100: 0.3679 - 27s/epoch - 13ms/step
Epoch 8/50
2083/2083 - 27s - loss: 3.2477 - accuracy100: 0.3975 - val_loss: 3.2879 - val_accuracy100: 0.3629 - 27s/epoch - 13ms/step
Epoch 9/50
2083/2083 - 27s - loss: 3.2453 - accuracy100: 0.3986 - val_loss: 3.2899 - val_accuracy100: 0.3630 - 27s/epoch - 13ms/step
Epoch 10/50
2083/2083 - 27s - loss: 3.2438 - accuracy100: 0.3991 - val_loss: 3.2933 - val_accuracy100: 0.3612 - 27s/epoch - 13ms/step
Epoch 11/50
2083/2083 - 27s - loss: 3.2425 - accuracy100: 0.4000 - val_loss: 3.2976 - val_accuracy100: 0.3590 - 27s/epoch - 13ms/step
Epoch 12/50
2083/2083 - 28s - loss: 3.2407 - accuracy100: 0.4003 - val_loss: 3.3003 - val_accuracy100: 0.3598 - 28s/epoch - 13ms/step
Epoch 13/50
2083/2083 - 27s - loss: 3.2397 - accuracy100: 0.4013 - val_loss: 3.3063 - val_accuracy100: 0.3603 - 27s/epoch - 13ms/step
Epoch 14/50
2083/2083 - 27s - loss: 3.2379 - accuracy100: 0.4020 - val_loss: 3.3132 - val_accuracy100: 0.3579 - 27s/epoch - 13ms/step
Epoch 15/50
2083/2083 - 28s - loss: 3.2365 - accuracy100: 0.4035 - val_loss: 3.3143 - val_accuracy100: 0.3577 - 28s/epoch - 13ms/step
testing model: results/ATVI/W7/deepOF_L1/h100
Evaluating performance on  test set...
6143/6143 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0850263
{'0': {'precision': 0.3572879949434433, 'recall': 0.39981471276138736, 'f1-score': 0.37735698371612986, 'support': 460906}, '1': {'precision': 0.40811888461825113, 'recall': 0.24011820567913453, 'f1-score': 0.30234855655466164, 'support': 638548}, '2': {'precision': 0.3523704222518828, 'recall': 0.5073069467257734, 'f1-score': 0.4158768614361891, 'support': 473043}, 'accuracy': 0.36730244954362395, 'macro avg': {'precision': 0.37259243393785907, 'recall': 0.38241328838876515, 'f1-score': 0.36519413390232686, 'support': 1572497}, 'weighted avg': {'precision': 0.37644971010177775, 'recall': 0.36730244954362395, 'f1-score': 0.3584857727498951, 'support': 1572497}}
[[184277 114110 162519]
 [206679 153327 278542]
 [124810 108255 239978]]
Evaluating performance on  train set...
2083/2083 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0939195
{'0': {'precision': 0.3911851751209513, 'recall': 0.3694440570169321, 'f1-score': 0.3800039021255107, 'support': 179245}, '1': {'precision': 0.33087563219791605, 'recall': 0.24846709984442208, 'f1-score': 0.2838102704821639, 'support': 174832}, '2': {'precision': 0.38379075415332375, 'recall': 0.49842301229771296, 'f1-score': 0.4336593942455268, 'support': 179139}, 'accuracy': 0.37310958410850387, 'macro avg': {'precision': 0.36861718715739705, 'recall': 0.37211138971968905, 'f1-score': 0.3658245222844005, 'support': 533216}, 'weighted avg': {'precision': 0.3689265272445936, 'recall': 0.37310958410850387, 'f1-score': 0.3664898031401426, 'support': 533216}}
[[66221 45806 67218]
 [55252 43440 76140]
 [47810 42042 89287]]
Evaluating performance on  val set...
685/685 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0929253
{'0': {'precision': 0.3760899941631144, 'recall': 0.3754856254856255, 'f1-score': 0.3757875668271992, 'support': 56628}, '1': {'precision': 0.34708514278194497, 'recall': 0.26211180124223604, 'f1-score': 0.2986722532061263, 'support': 60375}, '2': {'precision': 0.37906957640809397, 'recall': 0.4759841842874334, 'f1-score': 0.4220345700088407, 'support': 58170}, 'accuracy': 0.36978301450566015, 'macro avg': {'precision': 0.3674149044510511, 'recall': 0.3711938703384316, 'f1-score': 0.3654981300140554, 'support': 175173}, 'weighted avg': {'precision': 0.367082637989802, 'recall': 0.36978301450566015, 'f1-score': 0.36456638042977385, 'support': 175173}}
[[21263 15084 20281]
 [19477 15825 25073]
 [15797 14685 27688]]
training model: results/ATVI/W7/deepOF_L1/h200
Epoch 1/50
2083/2083 - 31s - loss: 3.3026 - accuracy200: 0.3577 - val_loss: 3.2937 - val_accuracy200: 0.3524 - 31s/epoch - 15ms/step
Epoch 2/50
2083/2083 - 28s - loss: 3.2868 - accuracy200: 0.3630 - val_loss: 3.2928 - val_accuracy200: 0.3527 - 28s/epoch - 13ms/step
Epoch 3/50
2083/2083 - 27s - loss: 3.2842 - accuracy200: 0.3649 - val_loss: 3.2928 - val_accuracy200: 0.3553 - 27s/epoch - 13ms/step
Epoch 4/50
2083/2083 - 28s - loss: 3.2818 - accuracy200: 0.3663 - val_loss: 3.2927 - val_accuracy200: 0.3549 - 28s/epoch - 14ms/step
Epoch 5/50
2083/2083 - 28s - loss: 3.2807 - accuracy200: 0.3678 - val_loss: 3.2918 - val_accuracy200: 0.3573 - 28s/epoch - 14ms/step
Epoch 6/50
2083/2083 - 27s - loss: 3.2794 - accuracy200: 0.3697 - val_loss: 3.2912 - val_accuracy200: 0.3577 - 27s/epoch - 13ms/step
Epoch 7/50
2083/2083 - 27s - loss: 3.2788 - accuracy200: 0.3699 - val_loss: 3.2919 - val_accuracy200: 0.3583 - 27s/epoch - 13ms/step
Epoch 8/50
2083/2083 - 28s - loss: 3.2779 - accuracy200: 0.3711 - val_loss: 3.2924 - val_accuracy200: 0.3598 - 28s/epoch - 13ms/step
Epoch 9/50
2083/2083 - 27s - loss: 3.2770 - accuracy200: 0.3717 - val_loss: 3.2925 - val_accuracy200: 0.3599 - 27s/epoch - 13ms/step
Epoch 10/50
2083/2083 - 28s - loss: 3.2759 - accuracy200: 0.3725 - val_loss: 3.2929 - val_accuracy200: 0.3597 - 28s/epoch - 14ms/step
Epoch 11/50
2083/2083 - 27s - loss: 3.2749 - accuracy200: 0.3733 - val_loss: 3.2934 - val_accuracy200: 0.3606 - 27s/epoch - 13ms/step
Epoch 12/50
2083/2083 - 27s - loss: 3.2743 - accuracy200: 0.3740 - val_loss: 3.2937 - val_accuracy200: 0.3610 - 27s/epoch - 13ms/step
Epoch 13/50
2083/2083 - 28s - loss: 3.2736 - accuracy200: 0.3744 - val_loss: 3.2936 - val_accuracy200: 0.3609 - 28s/epoch - 13ms/step
Epoch 14/50
2083/2083 - 27s - loss: 3.2728 - accuracy200: 0.3743 - val_loss: 3.2936 - val_accuracy200: 0.3615 - 27s/epoch - 13ms/step
Epoch 15/50
2083/2083 - 28s - loss: 3.2721 - accuracy200: 0.3757 - val_loss: 3.2946 - val_accuracy200: 0.3620 - 28s/epoch - 13ms/step
Epoch 16/50
2083/2083 - 28s - loss: 3.2710 - accuracy200: 0.3766 - val_loss: 3.2955 - val_accuracy200: 0.3627 - 28s/epoch - 13ms/step
testing model: results/ATVI/W7/deepOF_L1/h200
Evaluating performance on  test set...
6143/6143 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0934308
{'0': {'precision': 0.3696614459951538, 'recall': 0.16895482865079905, 'f1-score': 0.231913104771934, 'support': 484887}, '1': {'precision': 0.3799870660332196, 'recall': 0.23310383202496407, 'f1-score': 0.28895043620060545, 'support': 582277}, '2': {'precision': 0.3456045664646229, 'recall': 0.6795914773030853, 'f1-score': 0.45819513119307914, 'support': 505333}, 'accuracy': 0.3568051322196481, 'macro avg': {'precision': 0.3650843594976654, 'recall': 0.36055004599294954, 'f1-score': 0.3263528907218729, 'support': 1572497}, 'weighted avg': {'precision': 0.36575405282054235, 'recall': 0.3568051322196481, 'f1-score': 0.32575067742852354, 'support': 1572497}}
[[ 81924 119048 283915]
 [ 80202 135731 366344]
 [ 59493 102420 343420]]
Evaluating performance on  train set...
2083/2083 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0978831
{'0': {'precision': 0.38116397215266823, 'recall': 0.14816919476076879, 'f1-score': 0.2133883246160266, 'support': 177736}, '1': {'precision': 0.33996929629079387, 'recall': 0.23497532730539947, 'f1-score': 0.27788553328858195, 'support': 175295}, '2': {'precision': 0.35762624392434256, 'recall': 0.6807114909676166, 'f1-score': 0.46890387497323915, 'support': 180185}, 'accuracy': 0.356664091100042, 'macro avg': {'precision': 0.35958650412260157, 'recall': 0.3546186710112616, 'f1-score': 0.3200592442926159, 'support': 533216}, 'weighted avg': {'precision': 0.35966730613734216, 'recall': 0.356664091100042, 'f1-score': 0.3209359369070493, 'support': 533216}}
[[ 26335  42821 108580]
 [ 22372  41190 111733]
 [ 20384  37147 122654]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0966351
{'0': {'precision': 0.3766312072009992, 'recall': 0.15432534500405887, 'f1-score': 0.21893972585591787, 'support': 56666}, '1': {'precision': 0.35685847754538697, 'recall': 0.22554562077468923, 'f1-score': 0.2763986966398388, 'support': 59611}, '2': {'precision': 0.3552739809937171, 'recall': 0.6893507199130671, 'f1-score': 0.4688925589291695, 'support': 58896}, 'accuracy': 0.3584456508708534, 'macro avg': {'precision': 0.36292122191336773, 'recall': 0.35640722856393836, 'f1-score': 0.321410327141642, 'support': 175173}, 'weighted avg': {'precision': 0.36272194388870344, 'recall': 0.3584456508708534, 'f1-score': 0.3225310827664151, 'support': 175173}}
[[ 8745 12746 35175]
 [ 7663 13445 38503]
 [ 6811 11485 40600]]
training model: results/ATVI/W7/deepOF_L1/h300
Epoch 1/50
2083/2083 - 30s - loss: 3.2906 - accuracy300: 0.3731 - val_loss: 3.3328 - val_accuracy300: 0.3315 - 30s/epoch - 14ms/step
Epoch 2/50
2083/2083 - 27s - loss: 3.2822 - accuracy300: 0.3738 - val_loss: 3.3292 - val_accuracy300: 0.3298 - 27s/epoch - 13ms/step
Epoch 3/50
2083/2083 - 27s - loss: 3.2832 - accuracy300: 0.3709 - val_loss: 3.3258 - val_accuracy300: 0.3307 - 27s/epoch - 13ms/step
Epoch 4/50
2083/2083 - 27s - loss: 3.2816 - accuracy300: 0.3716 - val_loss: 3.3268 - val_accuracy300: 0.3310 - 27s/epoch - 13ms/step
Epoch 5/50
2083/2083 - 28s - loss: 3.2803 - accuracy300: 0.3726 - val_loss: 3.3247 - val_accuracy300: 0.3317 - 28s/epoch - 13ms/step
Epoch 6/50
2083/2083 - 28s - loss: 3.2791 - accuracy300: 0.3735 - val_loss: 3.3258 - val_accuracy300: 0.3322 - 28s/epoch - 13ms/step
Epoch 7/50
2083/2083 - 28s - loss: 3.2773 - accuracy300: 0.3753 - val_loss: 3.3239 - val_accuracy300: 0.3329 - 28s/epoch - 13ms/step
Epoch 8/50
2083/2083 - 28s - loss: 3.2764 - accuracy300: 0.3759 - val_loss: 3.3218 - val_accuracy300: 0.3347 - 28s/epoch - 13ms/step
Epoch 9/50
2083/2083 - 28s - loss: 3.2755 - accuracy300: 0.3768 - val_loss: 3.3214 - val_accuracy300: 0.3341 - 28s/epoch - 13ms/step
Epoch 10/50
2083/2083 - 28s - loss: 3.2743 - accuracy300: 0.3770 - val_loss: 3.3204 - val_accuracy300: 0.3356 - 28s/epoch - 13ms/step
Epoch 11/50
2083/2083 - 27s - loss: 3.2735 - accuracy300: 0.3782 - val_loss: 3.3198 - val_accuracy300: 0.3358 - 27s/epoch - 13ms/step
Epoch 12/50
2083/2083 - 27s - loss: 3.2727 - accuracy300: 0.3783 - val_loss: 3.3189 - val_accuracy300: 0.3381 - 27s/epoch - 13ms/step
Epoch 13/50
2083/2083 - 27s - loss: 3.2715 - accuracy300: 0.3793 - val_loss: 3.3179 - val_accuracy300: 0.3402 - 27s/epoch - 13ms/step
Epoch 14/50
2083/2083 - 27s - loss: 3.2707 - accuracy300: 0.3789 - val_loss: 3.3165 - val_accuracy300: 0.3407 - 27s/epoch - 13ms/step
Epoch 15/50
2083/2083 - 27s - loss: 3.2711 - accuracy300: 0.3796 - val_loss: 3.3146 - val_accuracy300: 0.3415 - 27s/epoch - 13ms/step
Epoch 16/50
2083/2083 - 27s - loss: 3.2699 - accuracy300: 0.3794 - val_loss: 3.3164 - val_accuracy300: 0.3424 - 27s/epoch - 13ms/step
Epoch 17/50
2083/2083 - 29s - loss: 3.2691 - accuracy300: 0.3800 - val_loss: 3.3162 - val_accuracy300: 0.3442 - 29s/epoch - 14ms/step
Epoch 18/50
2083/2083 - 27s - loss: 3.2681 - accuracy300: 0.3808 - val_loss: 3.3163 - val_accuracy300: 0.3451 - 27s/epoch - 13ms/step
Epoch 19/50
2083/2083 - 27s - loss: 3.2666 - accuracy300: 0.3814 - val_loss: 3.3210 - val_accuracy300: 0.3444 - 27s/epoch - 13ms/step
Epoch 20/50
2083/2083 - 27s - loss: 3.2667 - accuracy300: 0.3813 - val_loss: 3.3192 - val_accuracy300: 0.3458 - 27s/epoch - 13ms/step
Epoch 21/50
2083/2083 - 27s - loss: 3.2654 - accuracy300: 0.3822 - val_loss: 3.3168 - val_accuracy300: 0.3469 - 27s/epoch - 13ms/step
Epoch 22/50
2083/2083 - 27s - loss: 3.2653 - accuracy300: 0.3825 - val_loss: 3.3182 - val_accuracy300: 0.3473 - 27s/epoch - 13ms/step
Epoch 23/50
2083/2083 - 28s - loss: 3.2646 - accuracy300: 0.3829 - val_loss: 3.3204 - val_accuracy300: 0.3469 - 28s/epoch - 13ms/step
Epoch 24/50
2083/2083 - 28s - loss: 3.2633 - accuracy300: 0.3832 - val_loss: 3.3167 - val_accuracy300: 0.3482 - 28s/epoch - 13ms/step
Epoch 25/50
2083/2083 - 27s - loss: 3.2626 - accuracy300: 0.3840 - val_loss: 3.3168 - val_accuracy300: 0.3493 - 27s/epoch - 13ms/step
testing model: results/ATVI/W7/deepOF_L1/h300
Evaluating performance on  test set...
6143/6143 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1035498
{'0': {'precision': 0.32822627364116547, 'recall': 0.11053704307269982, 'f1-score': 0.16537919358798917, 'support': 435682}, '1': {'precision': 0.4428238711334272, 'recall': 0.14621922210379648, 'f1-score': 0.2198459253983484, 'support': 683973}, '2': {'precision': 0.29728083231799296, 'recall': 0.7877250785042024, 'f1-score': 0.431657679722744, 'support': 452842}, 'accuracy': 0.32107151873739664, 'macro avg': {'precision': 0.3561103256975285, 'recall': 0.34816044789356626, 'f1-score': 0.27229426623636055, 'support': 1572497}, 'weighted avg': {'precision': 0.3691600668438912, 'recall': 0.32107151873739664, 'f1-score': 0.2657519486233002, 'support': 1572497}}
[[ 48159  66465 321058]
 [ 61810 100010 522153]
 [ 36756  59371 356715]]
Evaluating performance on  train set...
2083/2083 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1042722
{'0': {'precision': 0.36363636363636365, 'recall': 0.09412905808911019, 'f1-score': 0.14954711199906823, 'support': 177331}, '1': {'precision': 0.3482255306173854, 'recall': 0.14891518178571225, 'f1-score': 0.20861726630132635, 'support': 176389}, '2': {'precision': 0.34548244400095174, 'recall': 0.7927641841600928, 'f1-score': 0.48124211587174354, 'support': 179496}, 'accuracy': 0.34743331032827224, 'macro avg': {'precision': 0.3524481127515669, 'recall': 0.3452694746783051, 'f1-score': 0.27980216472404607, 'support': 533216}, 'weighted avg': {'precision': 0.3524272900446814, 'recall': 0.34743331032827224, 'f1-score': 0.28074582295738665, 'support': 533216}}
[[ 16692  25932 134707]
 [ 15245  26267 134877]
 [ 13966  23232 142298]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1037378
{'0': {'precision': 0.34512855209742893, 'recall': 0.0925956179999637, 'f1-score': 0.14601611587399277, 'support': 55089}, '1': {'precision': 0.37947786606129397, 'recall': 0.1339058269381739, 'f1-score': 0.19795836195258285, 'support': 62417}, '2': {'precision': 0.33634221785383905, 'recall': 0.8070300171675309, 'f1-score': 0.474802968857602, 'support': 57667}, 'accuracy': 0.3425071215312862, 'macro avg': {'precision': 0.35364954533752063, 'recall': 0.3445104873685561, 'f1-score': 0.27292581556139256, 'support': 175173}, 'weighted avg': {'precision': 0.35447530983325276, 'recall': 0.3425071215312862, 'f1-score': 0.27276070907324806, 'support': 175173}}
[[ 5101  7000 42988]
 [ 5218  8358 48841]
 [ 4461  6667 46539]]
training model: results/ATVI/W7/deepOF_L1/h500
Epoch 1/50
2083/2083 - 33s - loss: 3.2818 - accuracy500: 0.3817 - val_loss: 3.3840 - val_accuracy500: 0.3468 - 33s/epoch - 16ms/step
Epoch 2/50
2083/2083 - 29s - loss: 3.2777 - accuracy500: 0.3773 - val_loss: 3.3696 - val_accuracy500: 0.3466 - 29s/epoch - 14ms/step
Epoch 3/50
2083/2083 - 29s - loss: 3.2773 - accuracy500: 0.3782 - val_loss: 3.3586 - val_accuracy500: 0.3468 - 29s/epoch - 14ms/step
Epoch 4/50
2083/2083 - 28s - loss: 3.2794 - accuracy500: 0.3758 - val_loss: 3.3546 - val_accuracy500: 0.3465 - 28s/epoch - 13ms/step
Epoch 5/50
2083/2083 - 28s - loss: 3.2779 - accuracy500: 0.3762 - val_loss: 3.3565 - val_accuracy500: 0.3466 - 28s/epoch - 13ms/step
Epoch 6/50
2083/2083 - 27s - loss: 3.2766 - accuracy500: 0.3773 - val_loss: 3.3569 - val_accuracy500: 0.3469 - 27s/epoch - 13ms/step
Epoch 7/50
2083/2083 - 27s - loss: 3.2752 - accuracy500: 0.3785 - val_loss: 3.3632 - val_accuracy500: 0.3468 - 27s/epoch - 13ms/step
Epoch 8/50
2083/2083 - 27s - loss: 3.2738 - accuracy500: 0.3790 - val_loss: 3.3601 - val_accuracy500: 0.3470 - 27s/epoch - 13ms/step
Epoch 9/50
2083/2083 - 27s - loss: 3.2726 - accuracy500: 0.3797 - val_loss: 3.3625 - val_accuracy500: 0.3467 - 27s/epoch - 13ms/step
Epoch 10/50
2083/2083 - 27s - loss: 3.2710 - accuracy500: 0.3803 - val_loss: 3.3632 - val_accuracy500: 0.3466 - 27s/epoch - 13ms/step
Epoch 11/50
2083/2083 - 27s - loss: 3.2697 - accuracy500: 0.3811 - val_loss: 3.3647 - val_accuracy500: 0.3467 - 27s/epoch - 13ms/step
Epoch 12/50
2083/2083 - 27s - loss: 3.2687 - accuracy500: 0.3825 - val_loss: 3.3636 - val_accuracy500: 0.3470 - 27s/epoch - 13ms/step
Epoch 13/50
2083/2083 - 27s - loss: 3.2691 - accuracy500: 0.3815 - val_loss: 3.3651 - val_accuracy500: 0.3466 - 27s/epoch - 13ms/step
Epoch 14/50
2083/2083 - 27s - loss: 3.2671 - accuracy500: 0.3833 - val_loss: 3.3649 - val_accuracy500: 0.3467 - 27s/epoch - 13ms/step
testing model: results/ATVI/W7/deepOF_L1/h500
Evaluating performance on  test set...
6143/6143 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1616278
{'0': {'precision': 0.3204401242068314, 'recall': 0.010842033378023128, 'f1-score': 0.02097440168608209, 'support': 437833}, '1': {'precision': 0.4, 'recall': 1.1786476197211319e-05, 'f1-score': 2.3572257809783664e-05, 'support': 678744}, '2': {'precision': 0.29027588124003717, 'recall': 0.9917353921740656, 'f1-score': 0.44910192428124396, 'support': 455920}, 'accuracy': 0.2905614446323268, 'macro avg': {'precision': 0.3369053351489562, 'recall': 0.3341964040094287, 'f1-score': 0.15669996607504527, 'support': 1572497}, 'weighted avg': {'precision': 0.3460352806248962, 'recall': 0.2905614446323268, 'f1-score': 0.13605993147222664, 'support': 1572497}}
[[  4747      9 433077]
 [  6302      8 672434]
 [  3765      3 452152]]
Evaluating performance on  train set...
2083/2083 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1245154
{'0': {'precision': 0.36637931034482757, 'recall': 0.010555013066767514, 'f1-score': 0.020518897685314723, 'support': 177167}, '1': {'precision': 0.2857142857142857, 'recall': 1.1191190294999776e-05, 'f1-score': 2.238150392515625e-05, 'support': 178712}, '2': {'precision': 0.3330644474110262, 'recall': 0.9918573112210086, 'f1-score': 0.4986745898316233, 'support': 177337}, 'accuracy': 0.3333827191982236, 'macro avg': {'precision': 0.3283860144900465, 'recall': 0.3341411718260237, 'f1-score': 0.17307195634028774, 'support': 533216}, 'weighted avg': {'precision': 0.32826386420317966, 'recall': 0.3333827191982236, 'f1-score': 0.17267435171959247, 'support': 533216}}
[[  1870      2 175295]
 [  1793      2 176917]
 [  1441      3 175893]]
Evaluating performance on  val set...
685/685 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1187125
{'0': {'precision': 0.3424657534246575, 'recall': 0.006984947438270527, 'f1-score': 0.013690659547523699, 'support': 57266}, '1': {'precision': 0.3333333333333333, 'recall': 1.7477628635346756e-05, 'f1-score': 3.4953424561771436e-05, 'support': 57216}, '2': {'precision': 0.346760382064574, 'recall': 0.9941671747046514, 'f1-score': 0.514178096492013, 'support': 60691}, 'accuracy': 0.34673151684334913, 'macro avg': {'precision': 0.3408531562741883, 'recall': 0.3337231999238524, 'f1-score': 0.17596790315469948, 'support': 175173}, 'weighted avg': {'precision': 0.3409708013420875, 'recall': 0.34673151684334913, 'f1-score': 0.18263083956423065, 'support': 175173}}
[[  400     0 56866]
 [  416     1 56799]
 [  352     2 60337]]
training model: results/ATVI/W7/deepOF_L1/h1000
Epoch 1/50
2083/2083 - 31s - loss: 3.3042 - accuracy1000: 0.3650 - val_loss: 3.3176 - val_accuracy1000: 0.3366 - 31s/epoch - 15ms/step
Epoch 2/50
2083/2083 - 28s - loss: 3.2937 - accuracy1000: 0.3610 - val_loss: 3.3151 - val_accuracy1000: 0.3365 - 28s/epoch - 13ms/step
Epoch 3/50
2083/2083 - 27s - loss: 3.2920 - accuracy1000: 0.3578 - val_loss: 3.3098 - val_accuracy1000: 0.3364 - 27s/epoch - 13ms/step
Epoch 4/50
2083/2083 - 27s - loss: 3.2901 - accuracy1000: 0.3593 - val_loss: 3.3077 - val_accuracy1000: 0.3367 - 27s/epoch - 13ms/step
Epoch 5/50
2083/2083 - 27s - loss: 3.2884 - accuracy1000: 0.3611 - val_loss: 3.3082 - val_accuracy1000: 0.3371 - 27s/epoch - 13ms/step
Epoch 6/50
2083/2083 - 28s - loss: 3.2868 - accuracy1000: 0.3627 - val_loss: 3.3071 - val_accuracy1000: 0.3379 - 28s/epoch - 13ms/step
Epoch 7/50
2083/2083 - 28s - loss: 3.2849 - accuracy1000: 0.3644 - val_loss: 3.3068 - val_accuracy1000: 0.3391 - 28s/epoch - 13ms/step
Epoch 8/50
2083/2083 - 27s - loss: 3.2825 - accuracy1000: 0.3671 - val_loss: 3.3075 - val_accuracy1000: 0.3408 - 27s/epoch - 13ms/step
Epoch 9/50
2083/2083 - 28s - loss: 3.2805 - accuracy1000: 0.3684 - val_loss: 3.3069 - val_accuracy1000: 0.3421 - 28s/epoch - 14ms/step
Epoch 10/50
2083/2083 - 28s - loss: 3.2786 - accuracy1000: 0.3699 - val_loss: 3.3068 - val_accuracy1000: 0.3445 - 28s/epoch - 13ms/step
Epoch 11/50
2083/2083 - 27s - loss: 3.2768 - accuracy1000: 0.3712 - val_loss: 3.3059 - val_accuracy1000: 0.3454 - 27s/epoch - 13ms/step
Epoch 12/50
2083/2083 - 28s - loss: 3.2753 - accuracy1000: 0.3722 - val_loss: 3.3049 - val_accuracy1000: 0.3454 - 28s/epoch - 13ms/step
Epoch 13/50
2083/2083 - 27s - loss: 3.2745 - accuracy1000: 0.3727 - val_loss: 3.3054 - val_accuracy1000: 0.3475 - 27s/epoch - 13ms/step
Epoch 14/50
2083/2083 - 27s - loss: 3.2730 - accuracy1000: 0.3740 - val_loss: 3.3074 - val_accuracy1000: 0.3485 - 27s/epoch - 13ms/step
Epoch 15/50
2083/2083 - 28s - loss: 3.2717 - accuracy1000: 0.3743 - val_loss: 3.3080 - val_accuracy1000: 0.3487 - 28s/epoch - 13ms/step
Epoch 16/50
2083/2083 - 27s - loss: 3.2706 - accuracy1000: 0.3756 - val_loss: 3.3097 - val_accuracy1000: 0.3487 - 27s/epoch - 13ms/step
Epoch 17/50
2083/2083 - 28s - loss: 3.2694 - accuracy1000: 0.3771 - val_loss: 3.3085 - val_accuracy1000: 0.3484 - 28s/epoch - 13ms/step
Epoch 18/50
2083/2083 - 27s - loss: 3.2680 - accuracy1000: 0.3780 - val_loss: 3.3116 - val_accuracy1000: 0.3488 - 27s/epoch - 13ms/step
Epoch 19/50
2083/2083 - 27s - loss: 3.2677 - accuracy1000: 0.3777 - val_loss: 3.3117 - val_accuracy1000: 0.3504 - 27s/epoch - 13ms/step
Epoch 20/50
2083/2083 - 28s - loss: 3.2665 - accuracy1000: 0.3786 - val_loss: 3.3120 - val_accuracy1000: 0.3515 - 28s/epoch - 13ms/step
Epoch 21/50
2083/2083 - 29s - loss: 3.2659 - accuracy1000: 0.3797 - val_loss: 3.3119 - val_accuracy1000: 0.3495 - 29s/epoch - 14ms/step
Epoch 22/50
2083/2083 - 28s - loss: 3.2650 - accuracy1000: 0.3797 - val_loss: 3.3134 - val_accuracy1000: 0.3520 - 28s/epoch - 14ms/step
testing model: results/ATVI/W7/deepOF_L1/h1000
Evaluating performance on  test set...
6143/6143 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993922
{'0': {'precision': 0.30903790087463556, 'recall': 0.0002202336554423684, 'f1-score': 0.0004401536385342053, 'support': 481307}, '1': {'precision': 0.37228236393054326, 'recall': 0.38167608656616875, 'f1-score': 0.37692070609196415, 'support': 584755}, '2': {'precision': 0.3290669556384453, 'recall': 0.6319962087928362, 'f1-score': 0.4327895940649553, 'support': 506435}, 'accuracy': 0.3455383380699613, 'macro avg': {'precision': 0.3367957401478747, 'recall': 0.3379641763381491, 'f1-score': 0.27005015126515125, 'support': 1572497}, 'weighted avg': {'precision': 0.3390067531799609, 'recall': 0.3455383380699613, 'f1-score': 0.27968124237336806, 'support': 1572497}}
[[   106 190052 291149]
 [   138 223187 361430]
 [    99 186271 320065]]
Evaluating performance on  train set...
2083/2083 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1071333
{'0': {'precision': 0.4540229885057471, 'recall': 0.0004434266213136654, 'f1-score': 0.000885987932620057, 'support': 178158}, '1': {'precision': 0.33493287829320495, 'recall': 0.38413851227141343, 'f1-score': 0.3578521389296525, 'support': 176793}, '2': {'precision': 0.3404940110695297, 'recall': 0.6308417243990688, 'f1-score': 0.44227309105853807, 'support': 178265}, 'accuracy': 0.3384163265918502, 'macro avg': {'precision': 0.3764832926228272, 'recall': 0.33847455443059865, 'f1-score': 0.2670037393069369, 'support': 533216}, 'weighted avg': {'precision': 0.3765824371766923, 'recall': 0.3384163265918502, 'f1-score': 0.26680634417091775, 'support': 533216}}
[[    79  69082 108997]
 [    58  67913 108822]
 [    37  65771 112457]]
Evaluating performance on  val set...
685/685 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1016146
{'0': {'precision': 0.21212121212121213, 'recall': 0.00012759054371798846, 'f1-score': 0.00025502768872048967, 'support': 54863}, '1': {'precision': 0.35503265263812583, 'recall': 0.3905804538715931, 'f1-score': 0.3719591659426586, 'support': 61383}, '2': {'precision': 0.34072724907305013, 'recall': 0.6222275018242911, 'f1-score': 0.4403319362547886, 'support': 58927}, 'accuracy': 0.34621773903512526, 'macro avg': {'precision': 0.3026270379441294, 'recall': 0.3376451820798674, 'f1-score': 0.2708487099620559, 'support': 175173}, 'weighted avg': {'precision': 0.305461515094334, 'recall': 0.34621773903512526, 'f1-score': 0.2785440740001622, 'support': 175173}}
[[    7 21314 33542]
 [    5 23975 37403]
 [   21 22240 36666]]
training model: results/ATVI/W7/deepLOB_L2/h10
Epoch 1/50
2083/2083 - 88s - loss: 3.0217 - accuracy10: 0.4619 - val_loss: 3.1426 - val_accuracy10: 0.5388 - 88s/epoch - 42ms/step
Epoch 2/50
2083/2083 - 84s - loss: 2.8614 - accuracy10: 0.5082 - val_loss: 3.0247 - val_accuracy10: 0.5676 - 84s/epoch - 40ms/step
Epoch 3/50
2083/2083 - 83s - loss: 2.7977 - accuracy10: 0.5340 - val_loss: 2.9919 - val_accuracy10: 0.5689 - 83s/epoch - 40ms/step
Epoch 4/50
2083/2083 - 83s - loss: 2.7549 - accuracy10: 0.5490 - val_loss: 2.9988 - val_accuracy10: 0.5772 - 83s/epoch - 40ms/step
Epoch 5/50
2083/2083 - 83s - loss: 2.7178 - accuracy10: 0.5589 - val_loss: 2.8927 - val_accuracy10: 0.5950 - 83s/epoch - 40ms/step
Epoch 6/50
2083/2083 - 83s - loss: 2.6891 - accuracy10: 0.5655 - val_loss: 2.8838 - val_accuracy10: 0.6010 - 83s/epoch - 40ms/step
Epoch 7/50
2083/2083 - 83s - loss: 2.6689 - accuracy10: 0.5698 - val_loss: 2.8900 - val_accuracy10: 0.5961 - 83s/epoch - 40ms/step
Epoch 8/50
2083/2083 - 85s - loss: 2.6532 - accuracy10: 0.5728 - val_loss: 2.8711 - val_accuracy10: 0.5860 - 85s/epoch - 41ms/step
Epoch 9/50
2083/2083 - 86s - loss: 2.6401 - accuracy10: 0.5746 - val_loss: 2.8755 - val_accuracy10: 0.5980 - 86s/epoch - 41ms/step
Epoch 10/50
2083/2083 - 87s - loss: 2.6310 - accuracy10: 0.5762 - val_loss: 2.8711 - val_accuracy10: 0.6019 - 87s/epoch - 42ms/step
Epoch 11/50
2083/2083 - 86s - loss: 2.6219 - accuracy10: 0.5779 - val_loss: 2.8726 - val_accuracy10: 0.5986 - 86s/epoch - 41ms/step
Epoch 12/50
2083/2083 - 86s - loss: 2.6147 - accuracy10: 0.5792 - val_loss: 2.8671 - val_accuracy10: 0.6004 - 86s/epoch - 41ms/step
Epoch 13/50
2083/2083 - 87s - loss: 2.6066 - accuracy10: 0.5801 - val_loss: 2.8648 - val_accuracy10: 0.5955 - 87s/epoch - 42ms/step
Epoch 14/50
2083/2083 - 85s - loss: 2.6001 - accuracy10: 0.5810 - val_loss: 2.8590 - val_accuracy10: 0.6053 - 85s/epoch - 41ms/step
Epoch 15/50
2083/2083 - 87s - loss: 2.5951 - accuracy10: 0.5816 - val_loss: 2.8569 - val_accuracy10: 0.6051 - 87s/epoch - 42ms/step
Epoch 16/50
2083/2083 - 87s - loss: 2.5899 - accuracy10: 0.5829 - val_loss: 2.8583 - val_accuracy10: 0.6046 - 87s/epoch - 42ms/step
Epoch 17/50
2083/2083 - 87s - loss: 2.5838 - accuracy10: 0.5840 - val_loss: 2.8623 - val_accuracy10: 0.6041 - 87s/epoch - 42ms/step
Epoch 18/50
2083/2083 - 88s - loss: 2.5789 - accuracy10: 0.5848 - val_loss: 2.8559 - val_accuracy10: 0.6028 - 88s/epoch - 42ms/step
Epoch 19/50
2083/2083 - 87s - loss: 2.5747 - accuracy10: 0.5856 - val_loss: 2.8712 - val_accuracy10: 0.6051 - 87s/epoch - 42ms/step
Epoch 20/50
2083/2083 - 86s - loss: 2.5698 - accuracy10: 0.5866 - val_loss: 2.8562 - val_accuracy10: 0.6030 - 86s/epoch - 41ms/step
Epoch 21/50
2083/2083 - 86s - loss: 2.5669 - accuracy10: 0.5870 - val_loss: 2.8519 - val_accuracy10: 0.6050 - 86s/epoch - 41ms/step
Epoch 22/50
2083/2083 - 86s - loss: 2.5614 - accuracy10: 0.5877 - val_loss: 2.8366 - val_accuracy10: 0.6029 - 86s/epoch - 41ms/step
Epoch 23/50
2083/2083 - 86s - loss: 2.5572 - accuracy10: 0.5886 - val_loss: 2.8368 - val_accuracy10: 0.6005 - 86s/epoch - 41ms/step
Epoch 24/50
2083/2083 - 87s - loss: 2.5536 - accuracy10: 0.5889 - val_loss: 2.8542 - val_accuracy10: 0.5990 - 87s/epoch - 42ms/step
Epoch 25/50
2083/2083 - 86s - loss: 2.5494 - accuracy10: 0.5905 - val_loss: 2.8528 - val_accuracy10: 0.5907 - 86s/epoch - 41ms/step
Epoch 26/50
2083/2083 - 86s - loss: 2.5454 - accuracy10: 0.5904 - val_loss: 2.8504 - val_accuracy10: 0.5991 - 86s/epoch - 41ms/step
Epoch 27/50
2083/2083 - 85s - loss: 2.5416 - accuracy10: 0.5908 - val_loss: 2.8414 - val_accuracy10: 0.5896 - 85s/epoch - 41ms/step
Epoch 28/50
2083/2083 - 86s - loss: 2.5373 - accuracy10: 0.5913 - val_loss: 2.8582 - val_accuracy10: 0.5938 - 86s/epoch - 41ms/step
Epoch 29/50
2083/2083 - 86s - loss: 2.5333 - accuracy10: 0.5922 - val_loss: 2.8899 - val_accuracy10: 0.5899 - 86s/epoch - 41ms/step
Epoch 30/50
2083/2083 - 86s - loss: 2.5299 - accuracy10: 0.5924 - val_loss: 2.8564 - val_accuracy10: 0.5863 - 86s/epoch - 41ms/step
Epoch 31/50
2083/2083 - 86s - loss: 2.5270 - accuracy10: 0.5930 - val_loss: 2.9143 - val_accuracy10: 0.5876 - 86s/epoch - 41ms/step
Epoch 32/50
2083/2083 - 86s - loss: 2.5240 - accuracy10: 0.5935 - val_loss: 2.8913 - val_accuracy10: 0.5895 - 86s/epoch - 41ms/step
testing model: results/ATVI/W7/deepLOB_L2/h10
Evaluating performance on  test set...
6143/6143 - 89s - 89s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7757174
{'0': {'precision': 0.4758427374261107, 'recall': 0.5176531557010545, 'f1-score': 0.49586816885719304, 'support': 316459}, '1': {'precision': 0.7492270893577523, 'recall': 0.7779837249919769, 'f1-score': 0.763334670454947, 'support': 944147}, '2': {'precision': 0.5179986443522747, 'recall': 0.41163400620719726, 'f1-score': 0.4587314291431144, 'support': 311896}, 'accuracy': 0.6529301711539953, 'macro avg': {'precision': 0.5810228237120459, 'recall': 0.5690902956334095, 'f1-score': 0.5726447561517515, 'support': 1572502}, 'weighted avg': {'precision': 0.6483469850962863, 'recall': 0.6529301711539953, 'f1-score': 0.6490920722380169, 'support': 1572502}}
[[163816 117583  35060]
 [125211 734531  84405]
 [ 55238 128271 128387]]
Evaluating performance on  train set...
2083/2083 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86135226
{'0': {'precision': 0.4991034976219538, 'recall': 0.4681706200056852, 'f1-score': 0.4831424508737405, 'support': 126644}, '1': {'precision': 0.7244349845201239, 'recall': 0.6666025682114395, 'f1-score': 0.6943165843870197, 'support': 280818}, '2': {'precision': 0.46125546397302947, 'recall': 0.5722714802592342, 'f1-score': 0.5108010944825163, 'support': 125755}, 'accuracy': 0.5972258948983247, 'macro avg': {'precision': 0.5615979820383691, 'recall': 0.5690148894921196, 'f1-score': 0.5627533765810923, 'support': 533217}, 'weighted avg': {'precision': 0.6088478568907878, 'recall': 0.5972258948983247, 'f1-score': 0.6008800896811184, 'support': 533217}}
[[ 59291  38330  29023]
 [ 38591 187194  55033]
 [ 20913  32876  71966]]
Evaluating performance on  val set...
685/685 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8637349
{'0': {'precision': 0.49345632747189394, 'recall': 0.4220518257353485, 'f1-score': 0.45496950125583063, 'support': 40559}, '1': {'precision': 0.6996159083057288, 'recall': 0.7319775044385146, 'f1-score': 0.7154309346051736, 'support': 94063}, '2': {'precision': 0.46642420784900995, 'recall': 0.4838844911346206, 'f1-score': 0.4749939481965626, 'support': 40551}, 'accuracy': 0.6027869591774988, 'macro avg': {'precision': 0.5531654812088775, 'recall': 0.5459712737694945, 'f1-score': 0.5484647946858556, 'support': 175173}, 'weighted avg': {'precision': 0.5979005578564021, 'recall': 0.6027869591774988, 'f1-score': 0.599465486099573, 'support': 175173}}
[[17118 15368  8073]
 [10837 68852 14374]
 [ 6735 14194 19622]]
training model: results/ATVI/W7/deepLOB_L2/h20
Epoch 1/50
2083/2083 - 90s - loss: 3.0931 - accuracy20: 0.4572 - val_loss: 3.3727 - val_accuracy20: 0.4603 - 90s/epoch - 43ms/step
Epoch 2/50
2083/2083 - 86s - loss: 2.9618 - accuracy20: 0.4987 - val_loss: 3.3751 - val_accuracy20: 0.4599 - 86s/epoch - 41ms/step
Epoch 3/50
2083/2083 - 85s - loss: 2.9143 - accuracy20: 0.5149 - val_loss: 3.1869 - val_accuracy20: 0.4878 - 85s/epoch - 41ms/step
Epoch 4/50
2083/2083 - 86s - loss: 2.8646 - accuracy20: 0.5318 - val_loss: 3.1395 - val_accuracy20: 0.5070 - 86s/epoch - 41ms/step
Epoch 5/50
2083/2083 - 86s - loss: 2.8278 - accuracy20: 0.5423 - val_loss: 3.0617 - val_accuracy20: 0.5218 - 86s/epoch - 41ms/step
Epoch 6/50
2083/2083 - 85s - loss: 2.8046 - accuracy20: 0.5484 - val_loss: 2.9836 - val_accuracy20: 0.5360 - 85s/epoch - 41ms/step
Epoch 7/50
2083/2083 - 86s - loss: 2.7879 - accuracy20: 0.5525 - val_loss: 2.9524 - val_accuracy20: 0.5422 - 86s/epoch - 41ms/step
Epoch 8/50
2083/2083 - 86s - loss: 2.7738 - accuracy20: 0.5552 - val_loss: 2.9529 - val_accuracy20: 0.5428 - 86s/epoch - 41ms/step
Epoch 9/50
2083/2083 - 85s - loss: 2.7593 - accuracy20: 0.5577 - val_loss: 2.9244 - val_accuracy20: 0.5480 - 85s/epoch - 41ms/step
Epoch 10/50
2083/2083 - 85s - loss: 2.7470 - accuracy20: 0.5604 - val_loss: 2.9070 - val_accuracy20: 0.5492 - 85s/epoch - 41ms/step
Epoch 11/50
2083/2083 - 86s - loss: 2.7361 - accuracy20: 0.5620 - val_loss: 2.8902 - val_accuracy20: 0.5511 - 86s/epoch - 41ms/step
Epoch 12/50
2083/2083 - 86s - loss: 2.7289 - accuracy20: 0.5635 - val_loss: 2.8887 - val_accuracy20: 0.5507 - 86s/epoch - 41ms/step
Epoch 13/50
2083/2083 - 86s - loss: 2.7212 - accuracy20: 0.5648 - val_loss: 2.8820 - val_accuracy20: 0.5535 - 86s/epoch - 41ms/step
Epoch 14/50
2083/2083 - 85s - loss: 2.7150 - accuracy20: 0.5651 - val_loss: 2.8872 - val_accuracy20: 0.5517 - 85s/epoch - 41ms/step
Epoch 15/50
2083/2083 - 86s - loss: 2.7097 - accuracy20: 0.5675 - val_loss: 2.8869 - val_accuracy20: 0.5506 - 86s/epoch - 41ms/step
Epoch 16/50
2083/2083 - 85s - loss: 2.7038 - accuracy20: 0.5683 - val_loss: 2.9123 - val_accuracy20: 0.5482 - 85s/epoch - 41ms/step
Epoch 17/50
2083/2083 - 85s - loss: 2.7001 - accuracy20: 0.5690 - val_loss: 2.9133 - val_accuracy20: 0.5461 - 85s/epoch - 41ms/step
Epoch 18/50
2083/2083 - 85s - loss: 2.6951 - accuracy20: 0.5696 - val_loss: 2.8965 - val_accuracy20: 0.5522 - 85s/epoch - 41ms/step
Epoch 19/50
2083/2083 - 85s - loss: 2.6913 - accuracy20: 0.5710 - val_loss: 2.9229 - val_accuracy20: 0.5463 - 85s/epoch - 41ms/step
Epoch 20/50
2083/2083 - 85s - loss: 2.6867 - accuracy20: 0.5715 - val_loss: 2.9069 - val_accuracy20: 0.5474 - 85s/epoch - 41ms/step
Epoch 21/50
2083/2083 - 85s - loss: 2.6824 - accuracy20: 0.5728 - val_loss: 2.9313 - val_accuracy20: 0.5444 - 85s/epoch - 41ms/step
Epoch 22/50
2083/2083 - 85s - loss: 2.6785 - accuracy20: 0.5734 - val_loss: 2.9292 - val_accuracy20: 0.5436 - 85s/epoch - 41ms/step
Epoch 23/50
2083/2083 - 85s - loss: 2.6744 - accuracy20: 0.5741 - val_loss: 2.9564 - val_accuracy20: 0.5390 - 85s/epoch - 41ms/step
testing model: results/ATVI/W7/deepLOB_L2/h20
Evaluating performance on  test set...
6143/6143 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.865791
{'0': {'precision': 0.5056680777712996, 'recall': 0.4941844189497519, 'f1-score': 0.4998603014231714, 'support': 403657}, '1': {'precision': 0.6456436616058175, 'recall': 0.7594782586168931, 'f1-score': 0.6979498600743492, 'support': 772030}, '2': {'precision': 0.569312690836866, 'recall': 0.3871753839950607, 'f1-score': 0.4609024733042439, 'support': 396815}, 'accuracy': 0.5974288109013534, 'macro avg': {'precision': 0.5735414767379944, 'recall': 0.5469460205205686, 'f1-score': 0.5529042116005882, 'support': 1572502}, 'weighted avg': {'precision': 0.5904504736737377, 'recall': 0.5974288109013534, 'f1-score': 0.5872827857191892, 'support': 1572502}}
[[199481 153738  50438]
 [119901 586340  65789]
 [ 75108 168070 153637]]
Evaluating performance on  train set...
2083/2083 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9253325
{'0': {'precision': 0.5340362964207697, 'recall': 0.4030782109088142, 'f1-score': 0.45940681365622366, 'support': 157689}, '1': {'precision': 0.6026606879537775, 'recall': 0.6841296266733563, 'f1-score': 0.6408161870257707, 'support': 219245}, '2': {'precision': 0.50194175931863, 'recall': 0.5309470639800874, 'f1-score': 0.5160371520878616, 'support': 156283}, 'accuracy': 0.5561169280049211, 'macro avg': {'precision': 0.5462129145643924, 'recall': 0.5393849671874192, 'f1-score': 0.5387533842566187, 'support': 533217}, 'weighted avg': {'precision': 0.552846132153165, 'recall': 0.5561169280049211, 'f1-score': 0.550595686564473, 'support': 533217}}
[[ 63561  52069  42059]
 [ 28976 149992  40277]
 [ 26483  46822  82978]]
Evaluating performance on  val set...
685/685 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9346981
{'0': {'precision': 0.5249685973482205, 'recall': 0.3731029420516992, 'f1-score': 0.4361953799053716, 'support': 50407}, '1': {'precision': 0.5856226512893612, 'recall': 0.7309548199266768, 'f1-score': 0.6502673925034174, 'support': 74192}, '2': {'precision': 0.5069527639911005, 'recall': 0.46856092063115434, 'f1-score': 0.4870013769292423, 'support': 50574}, 'accuracy': 0.5522255142059564, 'macro avg': {'precision': 0.5391813375428941, 'recall': 0.5242062275365101, 'f1-score': 0.5244880497793437, 'support': 175173}, 'weighted avg': {'precision': 0.5454564168968845, 'recall': 0.5522255142059564, 'f1-score': 0.5415306384906527, 'support': 175173}}
[[18807 19554 12046]
 [ 8960 54231 11001]
 [ 8058 18819 23697]]
training model: results/ATVI/W7/deepLOB_L2/h30
Epoch 1/50
2083/2083 - 88s - loss: 3.1216 - accuracy30: 0.4454 - val_loss: 3.4849 - val_accuracy30: 0.3782 - 88s/epoch - 42ms/step
Epoch 2/50
2083/2083 - 85s - loss: 3.0192 - accuracy30: 0.4816 - val_loss: 3.1586 - val_accuracy30: 0.4360 - 85s/epoch - 41ms/step
Epoch 3/50
2083/2083 - 86s - loss: 2.9819 - accuracy30: 0.4944 - val_loss: 3.1826 - val_accuracy30: 0.4485 - 86s/epoch - 41ms/step
Epoch 4/50
2083/2083 - 87s - loss: 2.9541 - accuracy30: 0.5040 - val_loss: 3.1692 - val_accuracy30: 0.4506 - 87s/epoch - 42ms/step
Epoch 5/50
2083/2083 - 87s - loss: 2.9337 - accuracy30: 0.5096 - val_loss: 3.1475 - val_accuracy30: 0.4645 - 87s/epoch - 42ms/step
Epoch 6/50
2083/2083 - 87s - loss: 2.9159 - accuracy30: 0.5144 - val_loss: 3.1384 - val_accuracy30: 0.4679 - 87s/epoch - 42ms/step
Epoch 7/50
2083/2083 - 87s - loss: 2.8982 - accuracy30: 0.5186 - val_loss: 3.1168 - val_accuracy30: 0.4742 - 87s/epoch - 42ms/step
Epoch 8/50
2083/2083 - 87s - loss: 2.8814 - accuracy30: 0.5234 - val_loss: 3.0802 - val_accuracy30: 0.4865 - 87s/epoch - 42ms/step
Epoch 9/50
2083/2083 - 87s - loss: 2.8661 - accuracy30: 0.5267 - val_loss: 3.0772 - val_accuracy30: 0.4883 - 87s/epoch - 42ms/step
Epoch 10/50
2083/2083 - 87s - loss: 2.8524 - accuracy30: 0.5299 - val_loss: 3.0306 - val_accuracy30: 0.4982 - 87s/epoch - 42ms/step
Epoch 11/50
2083/2083 - 86s - loss: 2.8394 - accuracy30: 0.5323 - val_loss: 3.0351 - val_accuracy30: 0.4968 - 86s/epoch - 41ms/step
Epoch 12/50
2083/2083 - 86s - loss: 2.8285 - accuracy30: 0.5347 - val_loss: 3.0246 - val_accuracy30: 0.5006 - 86s/epoch - 41ms/step
Epoch 13/50
2083/2083 - 86s - loss: 2.8182 - accuracy30: 0.5375 - val_loss: 3.0404 - val_accuracy30: 0.4983 - 86s/epoch - 41ms/step
Epoch 14/50
2083/2083 - 86s - loss: 2.8095 - accuracy30: 0.5396 - val_loss: 3.0409 - val_accuracy30: 0.5027 - 86s/epoch - 41ms/step
Epoch 15/50
2083/2083 - 86s - loss: 2.8023 - accuracy30: 0.5411 - val_loss: 2.9953 - val_accuracy30: 0.5068 - 86s/epoch - 41ms/step
Epoch 16/50
2083/2083 - 86s - loss: 2.7958 - accuracy30: 0.5424 - val_loss: 3.0328 - val_accuracy30: 0.5041 - 86s/epoch - 41ms/step
Epoch 17/50
2083/2083 - 86s - loss: 2.7900 - accuracy30: 0.5437 - val_loss: 2.9921 - val_accuracy30: 0.5085 - 86s/epoch - 41ms/step
Epoch 18/50
2083/2083 - 86s - loss: 2.7840 - accuracy30: 0.5455 - val_loss: 3.0200 - val_accuracy30: 0.5062 - 86s/epoch - 41ms/step
Epoch 19/50
2083/2083 - 86s - loss: 2.7805 - accuracy30: 0.5466 - val_loss: 3.0360 - val_accuracy30: 0.5049 - 86s/epoch - 41ms/step
Epoch 20/50
2083/2083 - 85s - loss: 2.7744 - accuracy30: 0.5477 - val_loss: 3.0185 - val_accuracy30: 0.5046 - 85s/epoch - 41ms/step
Epoch 21/50
2083/2083 - 86s - loss: 2.7699 - accuracy30: 0.5490 - val_loss: 3.0386 - val_accuracy30: 0.5056 - 86s/epoch - 41ms/step
Epoch 22/50
2083/2083 - 86s - loss: 2.7652 - accuracy30: 0.5498 - val_loss: 3.0470 - val_accuracy30: 0.5058 - 86s/epoch - 41ms/step
Epoch 23/50
2083/2083 - 87s - loss: 2.7626 - accuracy30: 0.5507 - val_loss: 3.0319 - val_accuracy30: 0.5068 - 87s/epoch - 42ms/step
Epoch 24/50
2083/2083 - 86s - loss: 2.7578 - accuracy30: 0.5517 - val_loss: 3.0308 - val_accuracy30: 0.5049 - 86s/epoch - 41ms/step
Epoch 25/50
2083/2083 - 85s - loss: 2.7530 - accuracy30: 0.5531 - val_loss: 3.0443 - val_accuracy30: 0.5024 - 85s/epoch - 41ms/step
Epoch 26/50
2083/2083 - 85s - loss: 2.7502 - accuracy30: 0.5537 - val_loss: 3.0885 - val_accuracy30: 0.5003 - 85s/epoch - 41ms/step
Epoch 27/50
2083/2083 - 86s - loss: 2.7469 - accuracy30: 0.5540 - val_loss: 3.1147 - val_accuracy30: 0.4955 - 86s/epoch - 41ms/step
testing model: results/ATVI/W7/deepLOB_L2/h30
Evaluating performance on  test set...
6143/6143 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94934916
{'0': {'precision': 0.5235713067771933, 'recall': 0.4317068369949148, 'f1-score': 0.4732219914454529, 'support': 462323}, '1': {'precision': 0.5407417005286936, 'recall': 0.7774342154487001, 'f1-score': 0.6378376279151052, 'support': 654903}, '2': {'precision': 0.5815817819974293, 'recall': 0.31901308217432944, 'f1-score': 0.4120214409218632, 'support': 455276}, 'accuracy': 0.5430651280570709, 'macro avg': {'precision': 0.5486315964344387, 'recall': 0.5093847115393147, 'f1-score': 0.5076936867608072, 'support': 1572502}, 'weighted avg': {'precision': 0.5475176798154515, 'recall': 0.5430651280570709, 'f1-score': 0.5240608026715797, 'support': 1572502}}
[[199588 211907  50828]
 [ 92095 509144  53664]
 [ 89522 220515 145239]]
Evaluating performance on  train set...
2083/2083 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9772435
{'0': {'precision': 0.5314767868629158, 'recall': 0.39670355119493445, 'f1-score': 0.45430552680604436, 'support': 177039}, '1': {'precision': 0.5048423765399168, 'recall': 0.680501161632924, 'f1-score': 0.5796561294061658, 'support': 180780}, '2': {'precision': 0.5195438083741025, 'recall': 0.46620257927684466, 'f1-score': 0.4914299794463743, 'support': 175398}, 'accuracy': 0.515782505058916, 'macro avg': {'precision': 0.5186209905923117, 'recall': 0.5144690973682343, 'f1-score': 0.5084638785528616, 'support': 533217}, 'weighted avg': {'precision': 0.5185214811259032, 'recall': 0.515782505058916, 'f1-score': 0.5090157792590955, 'support': 533217}}
[[ 70232  63373  43434]
 [ 25574 123021  32185]
 [ 36339  57288  81771]]
Evaluating performance on  val set...
685/685 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9953095
{'0': {'precision': 0.5299879839088867, 'recall': 0.3571252552277688, 'f1-score': 0.4267146192188782, 'support': 56812}, '1': {'precision': 0.4919119142695029, 'recall': 0.7464100064977258, 'f1-score': 0.5930089243655182, 'support': 61560}, '2': {'precision': 0.5233429925026448, 'recall': 0.4006267495290576, 'f1-score': 0.45383564512429825, 'support': 56801}, 'accuracy': 0.50803491405639, 'macro avg': {'precision': 0.5150809635603447, 'recall': 0.5013873370848507, 'f1-score': 0.49118639623623156, 'support': 175173}, 'weighted avg': {'precision': 0.514452456151376, 'recall': 0.50803491405639, 'f1-score': 0.4939486040069502, 'support': 175173}}
[[20289 24196 12327]
 [ 7212 45949  8399]
 [10781 23264 22756]]
training model: results/ATVI/W7/deepLOB_L2/h50
Epoch 1/50
2083/2083 - 90s - loss: 3.1869 - accuracy50: 0.4239 - val_loss: 3.5840 - val_accuracy50: 0.3686 - 90s/epoch - 43ms/step
Epoch 2/50
2083/2083 - 87s - loss: 3.1172 - accuracy50: 0.4504 - val_loss: 3.3107 - val_accuracy50: 0.4000 - 87s/epoch - 42ms/step
Epoch 3/50
2083/2083 - 86s - loss: 3.0932 - accuracy50: 0.4589 - val_loss: 3.3129 - val_accuracy50: 0.4139 - 86s/epoch - 41ms/step
Epoch 4/50
2083/2083 - 86s - loss: 3.0746 - accuracy50: 0.4661 - val_loss: 3.2596 - val_accuracy50: 0.4199 - 86s/epoch - 41ms/step
Epoch 5/50
2083/2083 - 86s - loss: 3.0601 - accuracy50: 0.4716 - val_loss: 3.2448 - val_accuracy50: 0.4208 - 86s/epoch - 41ms/step
Epoch 6/50
2083/2083 - 86s - loss: 3.0484 - accuracy50: 0.4756 - val_loss: 3.2653 - val_accuracy50: 0.4184 - 86s/epoch - 41ms/step
Epoch 7/50
2083/2083 - 87s - loss: 3.0383 - accuracy50: 0.4786 - val_loss: 3.2794 - val_accuracy50: 0.4214 - 87s/epoch - 42ms/step
Epoch 8/50
2083/2083 - 87s - loss: 3.0295 - accuracy50: 0.4816 - val_loss: 3.3131 - val_accuracy50: 0.4210 - 87s/epoch - 42ms/step
Epoch 9/50
2083/2083 - 88s - loss: 3.0226 - accuracy50: 0.4832 - val_loss: 3.3372 - val_accuracy50: 0.4210 - 88s/epoch - 42ms/step
Epoch 10/50
2083/2083 - 87s - loss: 3.0152 - accuracy50: 0.4859 - val_loss: 3.3443 - val_accuracy50: 0.4176 - 87s/epoch - 42ms/step
Epoch 11/50
2083/2083 - 86s - loss: 3.0082 - accuracy50: 0.4882 - val_loss: 3.4097 - val_accuracy50: 0.4124 - 86s/epoch - 41ms/step
Epoch 12/50
2083/2083 - 86s - loss: 3.0024 - accuracy50: 0.4901 - val_loss: 3.4128 - val_accuracy50: 0.4168 - 86s/epoch - 41ms/step
Epoch 13/50
2083/2083 - 86s - loss: 2.9963 - accuracy50: 0.4915 - val_loss: 3.4107 - val_accuracy50: 0.4182 - 86s/epoch - 41ms/step
Epoch 14/50
2083/2083 - 86s - loss: 2.9906 - accuracy50: 0.4935 - val_loss: 3.4998 - val_accuracy50: 0.4146 - 86s/epoch - 41ms/step
Epoch 15/50
2083/2083 - 85s - loss: 2.9858 - accuracy50: 0.4941 - val_loss: 3.4747 - val_accuracy50: 0.4178 - 85s/epoch - 41ms/step
testing model: results/ATVI/W7/deepLOB_L2/h50
Evaluating performance on  test set...
6143/6143 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0620215
{'0': {'precision': 0.4393280424263827, 'recall': 0.29781358800875235, 'f1-score': 0.3549870343115169, 'support': 476214}, '1': {'precision': 0.4427134651120389, 'recall': 0.7770572776084279, 'f1-score': 0.5640629143035476, 'support': 618706}, '2': {'precision': 0.4776389245183909, 'recall': 0.16374151454619312, 'f1-score': 0.2438780983745618, 'support': 477582}, 'accuracy': 0.445654759103645, 'macro avg': {'precision': 0.45322681068560416, 'recall': 0.41287079338779115, 'f1-score': 0.3876426823298755, 'support': 1572502}, 'weighted avg': {'precision': 0.45229538302080935, 'recall': 0.445654759103645, 'f1-score': 0.4035039033289849, 'support': 1572502}}
[[141823 298525  35866]
 [ 88280 480770  49656]
 [ 92715 306667  78200]]
Evaluating performance on  train set...
2083/2083 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.065747
{'0': {'precision': 0.4289973280832513, 'recall': 0.3434064851660691, 'f1-score': 0.3814597029576069, 'support': 177667}, '1': {'precision': 0.42513464171611137, 'recall': 0.5230421086322977, 'f1-score': 0.4690334779335678, 'support': 178087}, '2': {'precision': 0.43298021489612964, 'recall': 0.4194001003025983, 'f1-score': 0.42608197847492557, 'support': 177463}, 'accuracy': 0.4286941339079587, 'macro avg': {'precision': 0.4290373948984974, 'recall': 0.42861623136698834, 'f1-score': 0.42552505312203337, 'support': 533217}, 'weighted avg': {'precision': 0.4290328123521493, 'recall': 0.4286941339079587, 'f1-score': 0.4255591104113713, 'support': 533217}}
[[61012 65046 51609]
 [39080 93147 45860]
 [42128 60907 74428]]
Evaluating performance on  val set...
685/685 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0812036
{'0': {'precision': 0.4096576456361286, 'recall': 0.34248461712771705, 'f1-score': 0.37307155538255593, 'support': 57369}, '1': {'precision': 0.4222905146984601, 'recall': 0.6282705913763182, 'f1-score': 0.5050876333952657, 'support': 59928}, '2': {'precision': 0.4345369494376117, 'recall': 0.2856970073951206, 'f1-score': 0.34473771995663416, 'support': 57876}, 'accuracy': 0.42149189658223585, 'macro avg': {'precision': 0.4221617032574001, 'recall': 0.4188174052997186, 'f1-score': 0.4076323029114853, 'support': 175173}, 'weighted avg': {'precision': 0.4221994024364462, 'recall': 0.42149189658223585, 'f1-score': 0.40887393625195373, 'support': 175173}}
[[19648 25758 11963]
 [12723 37651  9554]
 [15591 25750 16535]]
training model: results/ATVI/W7/deepLOB_L2/h100
Epoch 1/50
2083/2083 - 89s - loss: 3.2567 - accuracy100: 0.3913 - val_loss: 3.3421 - val_accuracy100: 0.3685 - 89s/epoch - 43ms/step
Epoch 2/50
2083/2083 - 87s - loss: 3.2093 - accuracy100: 0.4127 - val_loss: 3.3206 - val_accuracy100: 0.3773 - 87s/epoch - 42ms/step
Epoch 3/50
2083/2083 - 86s - loss: 3.1948 - accuracy100: 0.4200 - val_loss: 3.3403 - val_accuracy100: 0.3688 - 86s/epoch - 41ms/step
Epoch 4/50
2083/2083 - 85s - loss: 3.1869 - accuracy100: 0.4228 - val_loss: 3.3819 - val_accuracy100: 0.3771 - 85s/epoch - 41ms/step
Epoch 5/50
2083/2083 - 85s - loss: 3.1824 - accuracy100: 0.4251 - val_loss: 3.3915 - val_accuracy100: 0.3796 - 85s/epoch - 41ms/step
Epoch 6/50
2083/2083 - 85s - loss: 3.1772 - accuracy100: 0.4272 - val_loss: 3.4118 - val_accuracy100: 0.3824 - 85s/epoch - 41ms/step
Epoch 7/50
2083/2083 - 85s - loss: 3.1722 - accuracy100: 0.4289 - val_loss: 3.4791 - val_accuracy100: 0.3776 - 85s/epoch - 41ms/step
Epoch 8/50
2083/2083 - 85s - loss: 3.1689 - accuracy100: 0.4304 - val_loss: 3.4706 - val_accuracy100: 0.3790 - 85s/epoch - 41ms/step
Epoch 9/50
2083/2083 - 85s - loss: 3.1655 - accuracy100: 0.4328 - val_loss: 3.4947 - val_accuracy100: 0.3765 - 85s/epoch - 41ms/step
Epoch 10/50
2083/2083 - 85s - loss: 3.1610 - accuracy100: 0.4337 - val_loss: 3.5119 - val_accuracy100: 0.3789 - 85s/epoch - 41ms/step
Epoch 11/50
2083/2083 - 86s - loss: 3.1571 - accuracy100: 0.4360 - val_loss: 3.4935 - val_accuracy100: 0.3736 - 86s/epoch - 41ms/step
Epoch 12/50
2083/2083 - 86s - loss: 3.1514 - accuracy100: 0.4387 - val_loss: 3.4830 - val_accuracy100: 0.3714 - 86s/epoch - 41ms/step
testing model: results/ATVI/W7/deepLOB_L2/h100
Evaluating performance on  test set...
6143/6143 - 83s - 83s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0886154
{'0': {'precision': 0.33173650870151705, 'recall': 0.5196969466857883, 'f1-score': 0.404969876589964, 'support': 460909}, '1': {'precision': 0.43254434980981843, 'recall': 0.45786775956113, 'f1-score': 0.44484595452809544, 'support': 638549}, '2': {'precision': 0.41332638057199833, 'recall': 0.15248053035235623, 'f1-score': 0.222776443699763, 'support': 473044}, 'accuracy': 0.3841228818786876, 'macro avg': {'precision': 0.3925357463611112, 'recall': 0.3766817455330915, 'f1-score': 0.3575307582726075, 'support': 1572502}, 'weighted avg': {'precision': 0.39721581841366027, 'recall': 0.3841228818786876, 'f1-score': 0.3663545485479034, 'support': 1572502}}
[[239533 176164  45212]
 [289009 292371  57169]
 [193516 207398  72130]]
Evaluating performance on  train set...
2083/2083 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.094752
{'0': {'precision': 0.37361171068639376, 'recall': 0.4249596857440979, 'f1-score': 0.3976348661454322, 'support': 179217}, '1': {'precision': 0.3806964880523416, 'recall': 0.38364193647997985, 'f1-score': 0.3821635369879322, 'support': 174874}, '2': {'precision': 0.40312259210406026, 'recall': 0.34464566841217914, 'f1-score': 0.3715976260127367, 'support': 179126}, 'accuracy': 0.3844288535436792, 'macro avg': {'precision': 0.38581026361426524, 'recall': 0.3844157635454189, 'f1-score': 0.38379867638203374, 'support': 533217}, 'weighted avg': {'precision': 0.38584896025254356, 'recall': 0.3844288535436792, 'f1-score': 0.3838140766899237, 'support': 533217}}
[[76160 55462 47595]
 [63973 67089 43812]
 [63715 53676 61735]]
Evaluating performance on  val set...
685/685 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1073873
{'0': {'precision': 0.34736668317649, 'recall': 0.3718628490632732, 'f1-score': 0.3591976099018352, 'support': 56580}, '1': {'precision': 0.3836158633440096, 'recall': 0.487427210164108, 'f1-score': 0.42933539277543825, 'support': 60448}, '2': {'precision': 0.40696351562293304, 'recall': 0.2645455327199243, 'f1-score': 0.3206520606199578, 'support': 58145}, 'accuracy': 0.3761196074737545, 'macro avg': {'precision': 0.37931535404781086, 'recall': 0.3746118639824352, 'f1-score': 0.3697283544324104, 'support': 175173}, 'weighted avg': {'precision': 0.3796573230888318, 'recall': 0.3761196074737545, 'f1-score': 0.37060609029635266, 'support': 175173}}
[[21040 23676 11864]
 [20433 29464 10551]
 [19097 23666 15382]]
training model: results/ATVI/W7/deepLOB_L2/h200
Epoch 1/50
2083/2083 - 90s - loss: 3.2946 - accuracy200: 0.3655 - val_loss: 3.4444 - val_accuracy200: 0.3234 - 90s/epoch - 43ms/step
Epoch 2/50
2083/2083 - 86s - loss: 3.2658 - accuracy200: 0.3802 - val_loss: 3.3733 - val_accuracy200: 0.3345 - 86s/epoch - 41ms/step
Epoch 3/50
2083/2083 - 85s - loss: 3.2508 - accuracy200: 0.3925 - val_loss: 3.3721 - val_accuracy200: 0.3381 - 85s/epoch - 41ms/step
Epoch 4/50
2083/2083 - 85s - loss: 3.2421 - accuracy200: 0.3989 - val_loss: 3.3913 - val_accuracy200: 0.3395 - 85s/epoch - 41ms/step
Epoch 5/50
2083/2083 - 86s - loss: 3.2360 - accuracy200: 0.4029 - val_loss: 3.4077 - val_accuracy200: 0.3403 - 86s/epoch - 41ms/step
Epoch 6/50
2083/2083 - 86s - loss: 3.2294 - accuracy200: 0.4064 - val_loss: 3.4382 - val_accuracy200: 0.3437 - 86s/epoch - 41ms/step
Epoch 7/50
2083/2083 - 86s - loss: 3.2233 - accuracy200: 0.4096 - val_loss: 3.4001 - val_accuracy200: 0.3427 - 86s/epoch - 41ms/step
Epoch 8/50
2083/2083 - 85s - loss: 3.2183 - accuracy200: 0.4121 - val_loss: 3.4547 - val_accuracy200: 0.3398 - 85s/epoch - 41ms/step
Epoch 9/50
2083/2083 - 85s - loss: 3.2131 - accuracy200: 0.4141 - val_loss: 3.4680 - val_accuracy200: 0.3458 - 85s/epoch - 41ms/step
Epoch 10/50
2083/2083 - 85s - loss: 3.2092 - accuracy200: 0.4164 - val_loss: 3.5091 - val_accuracy200: 0.3401 - 85s/epoch - 41ms/step
Epoch 11/50
2083/2083 - 85s - loss: 3.2041 - accuracy200: 0.4184 - val_loss: 3.4856 - val_accuracy200: 0.3439 - 85s/epoch - 41ms/step
Epoch 12/50
2083/2083 - 85s - loss: 3.1983 - accuracy200: 0.4213 - val_loss: 3.5593 - val_accuracy200: 0.3381 - 85s/epoch - 41ms/step
Epoch 13/50
2083/2083 - 85s - loss: 3.1931 - accuracy200: 0.4226 - val_loss: 3.6190 - val_accuracy200: 0.3351 - 85s/epoch - 41ms/step
testing model: results/ATVI/W7/deepLOB_L2/h200
Evaluating performance on  test set...
6143/6143 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1197813
{'0': {'precision': 0.3088833746898263, 'recall': 0.6803027490771103, 'f1-score': 0.4248628319723861, 'support': 484890}, '1': {'precision': 0.3807947401367964, 'recall': 0.17028665051169803, 'f1-score': 0.23533460548925786, 'support': 582277}, '2': {'precision': 0.3494399279175967, 'recall': 0.16884047216203113, 'f1-score': 0.22767444963308872, 'support': 505335}, 'accuracy': 0.32708829623110175, 'macro avg': {'precision': 0.34637268091473983, 'recall': 0.3398099572502798, 'f1-score': 0.2959572956982442, 'support': 1572502}, 'weighted avg': {'precision': 0.3485443607895074, 'recall': 0.32708829623110175, 'f1-score': 0.29131507284626396, 'support': 1572502}}
[[329872  76358  78660]
 [402939  99154  80184]
 [335139  84875  85321]]
Evaluating performance on  train set...
2083/2083 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1148871
{'0': {'precision': 0.34594332572559633, 'recall': 0.4819277108433735, 'f1-score': 0.4027672612860898, 'support': 177703}, '1': {'precision': 0.36871247342475993, 'recall': 0.1801156108945864, 'f1-score': 0.2420097451015722, 'support': 175243}, '2': {'precision': 0.3562002639261007, 'recall': 0.39529375218421153, 'f1-score': 0.37473016640943185, 'support': 180271}, 'accuracy': 0.3534470956477382, 'macro avg': {'precision': 0.3569520210254857, 'recall': 0.3524456913073905, 'f1-score': 0.33983572426569797, 'support': 533217}, 'weighted avg': {'precision': 0.3568941436038479, 'recall': 0.3534470956477382, 'f1-score': 0.3404550984345051, 'support': 533217}}
[[85640 26477 65586]
 [80469 31564 63210]
 [81446 27565 71260]]
Evaluating performance on  val set...
685/685 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1243182
{'0': {'precision': 0.3385263260388014, 'recall': 0.49052078373278307, 'f1-score': 0.40059050156626935, 'support': 56703}, '1': {'precision': 0.3528036311952684, 'recall': 0.1292191435768262, 'f1-score': 0.1891569670972579, 'support': 59550}, '2': {'precision': 0.33296348314606744, 'recall': 0.40235913102511883, 'f1-score': 0.3643867199508147, 'support': 58920}, 'accuracy': 0.33804296324205213, 'macro avg': {'precision': 0.3414311467933791, 'recall': 0.34069968611157603, 'f1-score': 0.31804472953811397, 'support': 175173}, 'weighted avg': {'precision': 0.34150881088993557, 'recall': 0.33804296324205213, 'f1-score': 0.31653648758915975, 'support': 175173}}
[[27814  6863 22026]
 [26388  7695 25467]
 [27960  7253 23707]]
training model: results/ATVI/W7/deepLOB_L2/h300
Epoch 1/50
2083/2083 - 88s - loss: 3.2667 - accuracy300: 0.3892 - val_loss: 3.3121 - val_accuracy300: 0.3496 - 88s/epoch - 42ms/step
Epoch 2/50
2083/2083 - 86s - loss: 3.2399 - accuracy300: 0.3996 - val_loss: 3.4015 - val_accuracy300: 0.3498 - 86s/epoch - 41ms/step
Epoch 3/50
2083/2083 - 85s - loss: 3.2220 - accuracy300: 0.4119 - val_loss: 3.4292 - val_accuracy300: 0.3502 - 85s/epoch - 41ms/step
Epoch 4/50
2083/2083 - 85s - loss: 3.2112 - accuracy300: 0.4184 - val_loss: 3.3911 - val_accuracy300: 0.3517 - 85s/epoch - 41ms/step
Epoch 5/50
2083/2083 - 85s - loss: 3.2022 - accuracy300: 0.4236 - val_loss: 3.4141 - val_accuracy300: 0.3423 - 85s/epoch - 41ms/step
Epoch 6/50
2083/2083 - 86s - loss: 3.1966 - accuracy300: 0.4263 - val_loss: 3.4291 - val_accuracy300: 0.3379 - 86s/epoch - 41ms/step
Epoch 7/50
2083/2083 - 85s - loss: 3.1896 - accuracy300: 0.4301 - val_loss: 3.4234 - val_accuracy300: 0.3436 - 85s/epoch - 41ms/step
Epoch 8/50
2083/2083 - 85s - loss: 3.1837 - accuracy300: 0.4331 - val_loss: 3.4362 - val_accuracy300: 0.3471 - 85s/epoch - 41ms/step
Epoch 9/50
2083/2083 - 86s - loss: 3.1774 - accuracy300: 0.4348 - val_loss: 3.4690 - val_accuracy300: 0.3476 - 86s/epoch - 41ms/step
Epoch 10/50
2083/2083 - 85s - loss: 3.1731 - accuracy300: 0.4365 - val_loss: 3.5180 - val_accuracy300: 0.3462 - 85s/epoch - 41ms/step
Epoch 11/50
2083/2083 - 85s - loss: 3.1682 - accuracy300: 0.4380 - val_loss: 3.5405 - val_accuracy300: 0.3528 - 85s/epoch - 41ms/step
testing model: results/ATVI/W7/deepLOB_L2/h300
Evaluating performance on  test set...
6143/6143 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991087
{'0': {'precision': 0.2714981294348438, 'recall': 0.25634804962300745, 'f1-score': 0.2637056730471822, 'support': 435685}, '1': {'precision': 0.4548970892187042, 'recall': 0.43794290727000257, 'f1-score': 0.4462590263531522, 'support': 683975}, '2': {'precision': 0.30138705968017254, 'recall': 0.3345338992407948, 'f1-score': 0.3170966040389832, 'support': 452842}, 'accuracy': 0.35785010130352773, 'macro avg': {'precision': 0.3425940927779069, 'recall': 0.3429416187112683, 'f1-score': 0.34235376781310584, 'support': 1572502}, 'weighted avg': {'precision': 0.359876564863429, 'recall': 0.35785010130352773, 'f1-score': 0.3584843034079957, 'support': 1572502}}
[[111687 178279 145719]
 [178997 299542 205436]
 [120689 180662 151491]]
Evaluating performance on  train set...
2083/2083 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1070298
{'0': {'precision': 0.32847494209945555, 'recall': 0.3056035017655487, 'f1-score': 0.3166267313424113, 'support': 177282}, '1': {'precision': 0.32334715382658025, 'recall': 0.24486522636077168, 'f1-score': 0.2786861982442221, 'support': 176444}, '2': {'precision': 0.3491888298439025, 'recall': 0.45651871124457494, 'f1-score': 0.3957049585659371, 'support': 179491}, 'accuracy': 0.33630585671499597, 'macro avg': {'precision': 0.3336703085899794, 'recall': 0.33566247979029845, 'f1-score': 0.3303392960508568, 'support': 533217}, 'weighted avg': {'precision': 0.3337508221841477, 'recall': 0.33630585671499597, 'f1-score': 0.3306912691583493, 'support': 533217}}
[[54178 45243 77861]
 [58380 43205 74859]
 [52380 45170 81941]]
Evaluating performance on  val set...
685/685 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103559
{'0': {'precision': 0.3010351619797997, 'recall': 0.1304363616553778, 'f1-score': 0.18200937539592044, 'support': 55069}, '1': {'precision': 0.3793869467883589, 'recall': 0.35302129568798374, 'f1-score': 0.36572955833893606, 'support': 62407}, '2': {'precision': 0.3459814246798653, 'recall': 0.5591278576009151, 'f1-score': 0.4274574496982224, 'support': 57697}, 'accuracy': 0.35093307758615766, 'macro avg': {'precision': 0.3421345111493413, 'recall': 0.34752850498142557, 'f1-score': 0.32506546114435964, 'support': 175173}, 'weighted avg': {'precision': 0.3437527289196445, 'recall': 0.35093307758615766, 'f1-score': 0.32830499743781444, 'support': 175173}}
[[ 7183 18112 29774]
 [ 9168 22031 31208]
 [ 7510 17927 32260]]
training model: results/ATVI/W7/deepLOB_L2/h500
Epoch 1/50
2083/2083 - 87s - loss: 3.2422 - accuracy500: 0.4059 - val_loss: 3.3580 - val_accuracy500: 0.3609 - 87s/epoch - 42ms/step
Epoch 2/50
2083/2083 - 85s - loss: 3.2009 - accuracy500: 0.4250 - val_loss: 3.5833 - val_accuracy500: 0.3457 - 85s/epoch - 41ms/step
Epoch 3/50
2083/2083 - 85s - loss: 3.1901 - accuracy500: 0.4315 - val_loss: 3.4588 - val_accuracy500: 0.3521 - 85s/epoch - 41ms/step
Epoch 4/50
2083/2083 - 85s - loss: 3.1686 - accuracy500: 0.4408 - val_loss: 3.4211 - val_accuracy500: 0.3370 - 85s/epoch - 41ms/step
Epoch 5/50
2083/2083 - 86s - loss: 3.1721 - accuracy500: 0.4387 - val_loss: 3.4242 - val_accuracy500: 0.3329 - 86s/epoch - 41ms/step
Epoch 6/50
2083/2083 - 85s - loss: 3.1560 - accuracy500: 0.4441 - val_loss: 3.3867 - val_accuracy500: 0.3302 - 85s/epoch - 41ms/step
Epoch 7/50
2083/2083 - 85s - loss: 3.1485 - accuracy500: 0.4472 - val_loss: 3.3827 - val_accuracy500: 0.3298 - 85s/epoch - 41ms/step
Epoch 8/50
2083/2083 - 85s - loss: 3.1436 - accuracy500: 0.4490 - val_loss: 3.4163 - val_accuracy500: 0.3290 - 85s/epoch - 41ms/step
Epoch 9/50
2083/2083 - 85s - loss: 3.1382 - accuracy500: 0.4506 - val_loss: 3.3831 - val_accuracy500: 0.3330 - 85s/epoch - 41ms/step
Epoch 10/50
2083/2083 - 85s - loss: 3.1335 - accuracy500: 0.4527 - val_loss: 3.4004 - val_accuracy500: 0.3343 - 85s/epoch - 41ms/step
Epoch 11/50
2083/2083 - 85s - loss: 3.1284 - accuracy500: 0.4557 - val_loss: 3.4244 - val_accuracy500: 0.3432 - 85s/epoch - 41ms/step
testing model: results/ATVI/W7/deepLOB_L2/h500
Evaluating performance on  test set...
6143/6143 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1128441
{'0': {'precision': 0.2713638757240653, 'recall': 0.23539353686417547, 'f1-score': 0.25210209420561935, 'support': 437837}, '1': {'precision': 0.45363806412047203, 'recall': 0.5220215574649647, 'f1-score': 0.48543332842400183, 'support': 678744}, '2': {'precision': 0.31998999127880845, 'recall': 0.28891189482388396, 'f1-score': 0.3036578365580788, 'support': 455921}, 'accuracy': 0.37462845834218333, 'macro avg': {'precision': 0.34833064370778194, 'recall': 0.3487756630510081, 'f1-score': 0.34706441972923335, 'support': 1572502}, 'weighted avg': {'precision': 0.36413779840191546, 'recall': 0.37462845834218333, 'f1-score': 0.367763327607801, 'support': 1572502}}
[[103064 210329 124444]
 [168949 354319 155476]
 [107787 216413 131721]]
Evaluating performance on  train set...
2083/2083 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1285858
{'0': {'precision': 0.32232412836833224, 'recall': 0.2178340784898162, 'f1-score': 0.25997264722328894, 'support': 177144}, '1': {'precision': 0.3448204380845891, 'recall': 0.30719510215959395, 'f1-score': 0.32492216263569745, 'support': 178691}, '2': {'precision': 0.3505697860058355, 'recall': 0.5025989108252247, 'f1-score': 0.41303904671892666, 'support': 177382}, 'accuracy': 0.34251158533955217, 'macro avg': {'precision': 0.33923811748625227, 'recall': 0.3425426971582117, 'f1-score': 0.33264461885930435, 'support': 533217}, 'weighted avg': {'precision': 0.33925937109795873, 'recall': 0.34251158533955217, 'f1-score': 0.3326580978632608, 'support': 533217}}
[[38588 52261 86295]
 [44939 54893 78859]
 [36191 52039 89152]]
Evaluating performance on  val set...
685/685 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.119363
{'0': {'precision': 0.3019906650177524, 'recall': 0.1320356513700661, 'f1-score': 0.18373786407766987, 'support': 57333}, '1': {'precision': 0.36074514369753047, 'recall': 0.41212503062760336, 'f1-score': 0.38472723708072604, 'support': 57138}, '2': {'precision': 0.37592832724272074, 'recall': 0.52535336562222, 'f1-score': 0.4382541296759475, 'support': 60702}, 'accuracy': 0.3596901348952179, 'macro avg': {'precision': 0.34622137865266783, 'recall': 0.35650468253996315, 'f1-score': 0.3355730769447811, 'support': 175173}, 'weighted avg': {'precision': 0.346776547403652, 'recall': 0.3596901348952179, 'f1-score': 0.33749316397545814, 'support': 175173}}
[[ 7570 20825 28938]
 [ 9588 23548 24002]
 [ 7909 20903 31890]]
training model: results/ATVI/W7/deepLOB_L2/h1000
Epoch 1/50
2083/2083 - 88s - loss: 3.2494 - accuracy1000: 0.4044 - val_loss: 3.4034 - val_accuracy1000: 0.3302 - 88s/epoch - 42ms/step
Epoch 2/50
2083/2083 - 86s - loss: 3.1869 - accuracy1000: 0.4322 - val_loss: 3.3673 - val_accuracy1000: 0.3254 - 86s/epoch - 41ms/step
Epoch 3/50
2083/2083 - 85s - loss: 3.1581 - accuracy1000: 0.4423 - val_loss: 3.3292 - val_accuracy1000: 0.3305 - 85s/epoch - 41ms/step
Epoch 4/50
2083/2083 - 86s - loss: 3.1422 - accuracy1000: 0.4490 - val_loss: 3.3383 - val_accuracy1000: 0.3290 - 86s/epoch - 41ms/step
Epoch 5/50
2083/2083 - 85s - loss: 3.1367 - accuracy1000: 0.4514 - val_loss: 3.3249 - val_accuracy1000: 0.3344 - 85s/epoch - 41ms/step
Epoch 6/50
2083/2083 - 85s - loss: 3.1210 - accuracy1000: 0.4570 - val_loss: 3.3107 - val_accuracy1000: 0.3334 - 85s/epoch - 41ms/step
Epoch 7/50
2083/2083 - 85s - loss: 3.1124 - accuracy1000: 0.4609 - val_loss: 3.3969 - val_accuracy1000: 0.3330 - 85s/epoch - 41ms/step
Epoch 8/50
2083/2083 - 86s - loss: 3.0984 - accuracy1000: 0.4655 - val_loss: 3.3849 - val_accuracy1000: 0.3320 - 86s/epoch - 41ms/step
Epoch 9/50
2083/2083 - 86s - loss: 3.0908 - accuracy1000: 0.4680 - val_loss: 3.3758 - val_accuracy1000: 0.3386 - 86s/epoch - 41ms/step
Epoch 10/50
2083/2083 - 85s - loss: 3.0821 - accuracy1000: 0.4708 - val_loss: 3.3887 - val_accuracy1000: 0.3410 - 85s/epoch - 41ms/step
Epoch 11/50
2083/2083 - 87s - loss: 3.0747 - accuracy1000: 0.4732 - val_loss: 3.4288 - val_accuracy1000: 0.3402 - 87s/epoch - 42ms/step
Epoch 12/50
2083/2083 - 87s - loss: 3.0681 - accuracy1000: 0.4754 - val_loss: 3.4881 - val_accuracy1000: 0.3391 - 87s/epoch - 42ms/step
Epoch 13/50
2083/2083 - 86s - loss: 3.0591 - accuracy1000: 0.4797 - val_loss: 3.4999 - val_accuracy1000: 0.3380 - 86s/epoch - 41ms/step
Epoch 14/50
2083/2083 - 86s - loss: 3.0508 - accuracy1000: 0.4814 - val_loss: 3.4565 - val_accuracy1000: 0.3424 - 86s/epoch - 41ms/step
Epoch 15/50
2083/2083 - 85s - loss: 3.0445 - accuracy1000: 0.4841 - val_loss: 3.5266 - val_accuracy1000: 0.3328 - 85s/epoch - 41ms/step
Epoch 16/50
2083/2083 - 85s - loss: 3.0370 - accuracy1000: 0.4872 - val_loss: 3.5152 - val_accuracy1000: 0.3402 - 85s/epoch - 41ms/step
testing model: results/ATVI/W7/deepLOB_L2/h1000
Evaluating performance on  test set...
6143/6143 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.105312
{'0': {'precision': 0.3096770388544198, 'recall': 0.2727321835569933, 'f1-score': 0.2900328214396582, 'support': 481311}, '1': {'precision': 0.38899276407016087, 'recall': 0.43512069157168387, 'f1-score': 0.4107657734741519, 'support': 584755}, '2': {'precision': 0.34167012122989193, 'recall': 0.3336275462249919, 'f1-score': 0.3376009415046291, 'support': 506436}, 'accuracy': 0.3527302350012909, 'macro avg': {'precision': 0.34677997471815747, 'recall': 0.34716014045122306, 'f1-score': 0.34613317880614636, 'support': 1572502}, 'weighted avg': {'precision': 0.349475217530463, 'recall': 0.3527302350012909, 'f1-score': 0.35024858321303204, 'support': 1572502}}
[[131269 195604 154438]
 [159200 254439 171116]
 [133421 204054 168961]]
Evaluating performance on  train set...
2083/2083 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1155889
{'0': {'precision': 0.3297278959866828, 'recall': 0.2345974224257937, 'f1-score': 0.2741444056345419, 'support': 178152}, '1': {'precision': 0.32338474698601943, 'recall': 0.27365111320978786, 'f1-score': 0.29644650148407037, 'support': 176831}, '2': {'precision': 0.34231470088931115, 'recall': 0.49326166724642884, 'f1-score': 0.4041538907098299, 'support': 178234}, 'accuracy': 0.33401035600890444, 'macro avg': {'precision': 0.33180911462067114, 'recall': 0.33383673429400346, 'f1-score': 0.32491493260948073, 'support': 533217}, 'weighted avg': {'precision': 0.33183160086495705, 'recall': 0.33401035600890444, 'f1-score': 0.324997646386575, 'support': 533217}}
[[41794 50171 86187]
 [45716 48390 82725]
 [39243 51075 87916]]
Evaluating performance on  val set...
685/685 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.104015
{'0': {'precision': 0.32062893505269185, 'recall': 0.1736759556463379, 'f1-score': 0.22530845941821537, 'support': 54832}, '1': {'precision': 0.33767011088709675, 'recall': 0.34901098901098904, 'f1-score': 0.34324689984229023, 'support': 61425}, '2': {'precision': 0.33295521077283374, 'recall': 0.4633206599226017, 'f1-score': 0.38746628814762246, 'support': 58916}, 'accuracy': 0.3325740839056247, 'macro avg': {'precision': 0.3304180855708741, 'recall': 0.32866920152664286, 'f1-score': 0.318673882469376, 'support': 175173}, 'weighted avg': {'precision': 0.3307501813974836, 'recall': 0.3325740839056247, 'f1-score': 0.321202571755565, 'support': 175173}}
[[ 9523 20610 24699]
 [ 9999 21438 29988]
 [10179 21440 27297]]
training model: results/ATVI/W7/deepOF_L2/h10
Epoch 1/50
2083/2083 - 51s - loss: 2.9464 - accuracy10: 0.4974 - val_loss: 3.0082 - val_accuracy10: 0.5865 - 51s/epoch - 24ms/step
Epoch 2/50
2083/2083 - 47s - loss: 2.7483 - accuracy10: 0.5593 - val_loss: 2.8377 - val_accuracy10: 0.5971 - 47s/epoch - 23ms/step
Epoch 3/50
2083/2083 - 46s - loss: 2.7019 - accuracy10: 0.5680 - val_loss: 2.8049 - val_accuracy10: 0.6013 - 46s/epoch - 22ms/step
Epoch 4/50
2083/2083 - 46s - loss: 2.6801 - accuracy10: 0.5711 - val_loss: 2.8003 - val_accuracy10: 0.6005 - 46s/epoch - 22ms/step
Epoch 5/50
2083/2083 - 47s - loss: 2.6666 - accuracy10: 0.5738 - val_loss: 2.7804 - val_accuracy10: 0.6002 - 47s/epoch - 22ms/step
Epoch 6/50
2083/2083 - 47s - loss: 2.6556 - accuracy10: 0.5756 - val_loss: 2.7672 - val_accuracy10: 0.6023 - 47s/epoch - 22ms/step
Epoch 7/50
2083/2083 - 47s - loss: 2.6460 - accuracy10: 0.5772 - val_loss: 2.7520 - val_accuracy10: 0.5989 - 47s/epoch - 23ms/step
Epoch 8/50
2083/2083 - 46s - loss: 2.6374 - accuracy10: 0.5780 - val_loss: 2.7480 - val_accuracy10: 0.5979 - 46s/epoch - 22ms/step
Epoch 9/50
2083/2083 - 47s - loss: 2.6308 - accuracy10: 0.5797 - val_loss: 2.7314 - val_accuracy10: 0.6000 - 47s/epoch - 22ms/step
Epoch 10/50
2083/2083 - 47s - loss: 2.6246 - accuracy10: 0.5801 - val_loss: 2.7293 - val_accuracy10: 0.5995 - 47s/epoch - 23ms/step
Epoch 11/50
2083/2083 - 46s - loss: 2.6192 - accuracy10: 0.5814 - val_loss: 2.7340 - val_accuracy10: 0.5991 - 46s/epoch - 22ms/step
Epoch 12/50
2083/2083 - 47s - loss: 2.6135 - accuracy10: 0.5825 - val_loss: 2.7413 - val_accuracy10: 0.5979 - 47s/epoch - 22ms/step
Epoch 13/50
2083/2083 - 47s - loss: 2.6078 - accuracy10: 0.5833 - val_loss: 2.7324 - val_accuracy10: 0.6010 - 47s/epoch - 23ms/step
Epoch 14/50
2083/2083 - 47s - loss: 2.6037 - accuracy10: 0.5832 - val_loss: 2.7256 - val_accuracy10: 0.5960 - 47s/epoch - 22ms/step
Epoch 15/50
2083/2083 - 46s - loss: 2.5985 - accuracy10: 0.5846 - val_loss: 2.7212 - val_accuracy10: 0.5988 - 46s/epoch - 22ms/step
Epoch 16/50
2083/2083 - 46s - loss: 2.5939 - accuracy10: 0.5854 - val_loss: 2.7217 - val_accuracy10: 0.5975 - 46s/epoch - 22ms/step
Epoch 17/50
2083/2083 - 46s - loss: 2.5882 - accuracy10: 0.5866 - val_loss: 2.7148 - val_accuracy10: 0.5991 - 46s/epoch - 22ms/step
Epoch 18/50
2083/2083 - 46s - loss: 2.5850 - accuracy10: 0.5869 - val_loss: 2.7123 - val_accuracy10: 0.5976 - 46s/epoch - 22ms/step
Epoch 19/50
2083/2083 - 47s - loss: 2.5805 - accuracy10: 0.5878 - val_loss: 2.7114 - val_accuracy10: 0.5943 - 47s/epoch - 22ms/step
Epoch 20/50
2083/2083 - 46s - loss: 2.5763 - accuracy10: 0.5876 - val_loss: 2.7196 - val_accuracy10: 0.5971 - 46s/epoch - 22ms/step
Epoch 21/50
2083/2083 - 46s - loss: 2.5733 - accuracy10: 0.5887 - val_loss: 2.7108 - val_accuracy10: 0.5963 - 46s/epoch - 22ms/step
Epoch 22/50
2083/2083 - 46s - loss: 2.5688 - accuracy10: 0.5893 - val_loss: 2.7051 - val_accuracy10: 0.5979 - 46s/epoch - 22ms/step
Epoch 23/50
2083/2083 - 46s - loss: 2.5649 - accuracy10: 0.5897 - val_loss: 2.7082 - val_accuracy10: 0.6001 - 46s/epoch - 22ms/step
Epoch 24/50
2083/2083 - 46s - loss: 2.5624 - accuracy10: 0.5896 - val_loss: 2.7096 - val_accuracy10: 0.5998 - 46s/epoch - 22ms/step
Epoch 25/50
2083/2083 - 46s - loss: 2.5583 - accuracy10: 0.5906 - val_loss: 2.7091 - val_accuracy10: 0.6007 - 46s/epoch - 22ms/step
Epoch 26/50
2083/2083 - 46s - loss: 2.5547 - accuracy10: 0.5909 - val_loss: 2.7062 - val_accuracy10: 0.5988 - 46s/epoch - 22ms/step
Epoch 27/50
2083/2083 - 46s - loss: 2.5514 - accuracy10: 0.5918 - val_loss: 2.7068 - val_accuracy10: 0.5999 - 46s/epoch - 22ms/step
Epoch 28/50
2083/2083 - 46s - loss: 2.5484 - accuracy10: 0.5918 - val_loss: 2.7134 - val_accuracy10: 0.5976 - 46s/epoch - 22ms/step
Epoch 29/50
2083/2083 - 46s - loss: 2.5460 - accuracy10: 0.5923 - val_loss: 2.7066 - val_accuracy10: 0.5996 - 46s/epoch - 22ms/step
Epoch 30/50
2083/2083 - 46s - loss: 2.5419 - accuracy10: 0.5931 - val_loss: 2.7148 - val_accuracy10: 0.6005 - 46s/epoch - 22ms/step
Epoch 31/50
2083/2083 - 46s - loss: 2.5384 - accuracy10: 0.5934 - val_loss: 2.7008 - val_accuracy10: 0.5970 - 46s/epoch - 22ms/step
Epoch 32/50
2083/2083 - 46s - loss: 2.5352 - accuracy10: 0.5944 - val_loss: 2.7081 - val_accuracy10: 0.5984 - 46s/epoch - 22ms/step
Epoch 33/50
2083/2083 - 46s - loss: 2.5327 - accuracy10: 0.5944 - val_loss: 2.7048 - val_accuracy10: 0.5982 - 46s/epoch - 22ms/step
Epoch 34/50
2083/2083 - 46s - loss: 2.5295 - accuracy10: 0.5946 - val_loss: 2.6990 - val_accuracy10: 0.5970 - 46s/epoch - 22ms/step
Epoch 35/50
2083/2083 - 46s - loss: 2.5263 - accuracy10: 0.5952 - val_loss: 2.7008 - val_accuracy10: 0.5943 - 46s/epoch - 22ms/step
Epoch 36/50
2083/2083 - 46s - loss: 2.5234 - accuracy10: 0.5953 - val_loss: 2.7048 - val_accuracy10: 0.5962 - 46s/epoch - 22ms/step
Epoch 37/50
2083/2083 - 46s - loss: 2.5197 - accuracy10: 0.5963 - val_loss: 2.7084 - val_accuracy10: 0.5965 - 46s/epoch - 22ms/step
Epoch 38/50
2083/2083 - 46s - loss: 2.5173 - accuracy10: 0.5966 - val_loss: 2.7109 - val_accuracy10: 0.5978 - 46s/epoch - 22ms/step
Epoch 39/50
2083/2083 - 46s - loss: 2.5143 - accuracy10: 0.5972 - val_loss: 2.7045 - val_accuracy10: 0.5995 - 46s/epoch - 22ms/step
Epoch 40/50
2083/2083 - 46s - loss: 2.5121 - accuracy10: 0.5973 - val_loss: 2.7155 - val_accuracy10: 0.5977 - 46s/epoch - 22ms/step
Epoch 41/50
2083/2083 - 46s - loss: 2.5097 - accuracy10: 0.5981 - val_loss: 2.7175 - val_accuracy10: 0.5995 - 46s/epoch - 22ms/step
Epoch 42/50
2083/2083 - 46s - loss: 2.5052 - accuracy10: 0.5982 - val_loss: 2.7029 - val_accuracy10: 0.5988 - 46s/epoch - 22ms/step
Epoch 43/50
2083/2083 - 46s - loss: 2.5036 - accuracy10: 0.5985 - val_loss: 2.7266 - val_accuracy10: 0.5997 - 46s/epoch - 22ms/step
Epoch 44/50
2083/2083 - 46s - loss: 2.5002 - accuracy10: 0.5988 - val_loss: 2.7117 - val_accuracy10: 0.5988 - 46s/epoch - 22ms/step
testing model: results/ATVI/W7/deepOF_L2/h10
Evaluating performance on  test set...
6143/6143 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77895164
{'0': {'precision': 0.45859024380382485, 'recall': 0.5734649573243759, 'f1-score': 0.5096344348729613, 'support': 316457}, '1': {'precision': 0.7723272055662516, 'recall': 0.7516125683951422, 'f1-score': 0.7618291018261709, 'support': 944146}, '2': {'precision': 0.5218960557636094, 'recall': 0.4316242056596151, 'f1-score': 0.47248701389863823, 'support': 311894}, 'accuracy': 0.6522937722615687, 'macro avg': {'precision': 0.5842711683778953, 'recall': 0.5855672437930444, 'f1-score': 0.5813168501992568, 'support': 1572497}, 'weighted avg': {'precision': 0.6595179405915028, 'recall': 0.6522937722615687, 'f1-score': 0.6536871919261319, 'support': 1572497}}
[[181477 100540  34440]
 [145629 709632  88885]
 [ 68622 108651 134621]]
Evaluating performance on  train set...
2083/2083 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85294276
{'0': {'precision': 0.46602319944598336, 'recall': 0.5927239554251831, 'f1-score': 0.5217924087439638, 'support': 127157}, '1': {'precision': 0.7271793050554815, 'recall': 0.6858812629178248, 'f1-score': 0.7059267966616725, 'support': 280620}, '2': {'precision': 0.5150788820748092, 'recall': 0.4385637640606191, 'f1-score': 0.4737517438556001, 'support': 125439}, 'accuracy': 0.6054844565804477, 'macro avg': {'precision': 0.569427128858758, 'recall': 0.572389660801209, 'f1-score': 0.5671569830870787, 'support': 533216}, 'weighted avg': {'precision': 0.615004329287201, 'recall': 0.6054844565804477, 'f1-score': 0.6073967772822971, 'support': 533216}}
[[ 75369  34688  17100]
 [ 53456 192472  34692]
 [ 32903  37523  55013]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8702119
{'0': {'precision': 0.44375231053604436, 'recall': 0.592926473857097, 'f1-score': 0.5076065927327702, 'support': 40489}, '1': {'precision': 0.7328723564168681, 'recall': 0.6745530012771392, 'f1-score': 0.702504391968655, 'support': 93960}, '2': {'precision': 0.49696444058976585, 'recall': 0.42210981239563894, 'f1-score': 0.45648883341742574, 'support': 40724}, 'accuracy': 0.5969983958715098, 'macro avg': {'precision': 0.5578630358475594, 'recall': 0.563196429176625, 'f1-score': 0.5555332727062836, 'support': 175173}, 'weighted avg': {'precision': 0.6112023758729966, 'recall': 0.5969983958715098, 'f1-score': 0.600262867306167, 'support': 175173}}
[[24007 10723  5759]
 [18938 63381 11641]
 [11155 12379 17190]]
training model: results/ATVI/W7/deepOF_L2/h20
Epoch 1/50
2083/2083 - 49s - loss: 3.0134 - accuracy20: 0.4839 - val_loss: 3.1961 - val_accuracy20: 0.5084 - 49s/epoch - 23ms/step
Epoch 2/50
2083/2083 - 46s - loss: 2.8477 - accuracy20: 0.5358 - val_loss: 3.0117 - val_accuracy20: 0.5322 - 46s/epoch - 22ms/step
Epoch 3/50
2083/2083 - 46s - loss: 2.8037 - accuracy20: 0.5478 - val_loss: 2.9506 - val_accuracy20: 0.5401 - 46s/epoch - 22ms/step
Epoch 4/50
2083/2083 - 46s - loss: 2.7829 - accuracy20: 0.5521 - val_loss: 2.9142 - val_accuracy20: 0.5455 - 46s/epoch - 22ms/step
Epoch 5/50
2083/2083 - 46s - loss: 2.7695 - accuracy20: 0.5546 - val_loss: 2.8979 - val_accuracy20: 0.5480 - 46s/epoch - 22ms/step
Epoch 6/50
2083/2083 - 46s - loss: 2.7580 - accuracy20: 0.5569 - val_loss: 2.8836 - val_accuracy20: 0.5507 - 46s/epoch - 22ms/step
Epoch 7/50
2083/2083 - 46s - loss: 2.7500 - accuracy20: 0.5588 - val_loss: 2.8846 - val_accuracy20: 0.5507 - 46s/epoch - 22ms/step
Epoch 8/50
2083/2083 - 46s - loss: 2.7428 - accuracy20: 0.5601 - val_loss: 2.8715 - val_accuracy20: 0.5529 - 46s/epoch - 22ms/step
Epoch 9/50
2083/2083 - 46s - loss: 2.7362 - accuracy20: 0.5614 - val_loss: 2.8560 - val_accuracy20: 0.5545 - 46s/epoch - 22ms/step
Epoch 10/50
2083/2083 - 46s - loss: 2.7305 - accuracy20: 0.5630 - val_loss: 2.8477 - val_accuracy20: 0.5558 - 46s/epoch - 22ms/step
Epoch 11/50
2083/2083 - 47s - loss: 2.7260 - accuracy20: 0.5636 - val_loss: 2.8426 - val_accuracy20: 0.5559 - 47s/epoch - 22ms/step
Epoch 12/50
2083/2083 - 46s - loss: 2.7215 - accuracy20: 0.5641 - val_loss: 2.8389 - val_accuracy20: 0.5572 - 46s/epoch - 22ms/step
Epoch 13/50
2083/2083 - 46s - loss: 2.7157 - accuracy20: 0.5655 - val_loss: 2.8421 - val_accuracy20: 0.5571 - 46s/epoch - 22ms/step
Epoch 14/50
2083/2083 - 46s - loss: 2.7116 - accuracy20: 0.5659 - val_loss: 2.8318 - val_accuracy20: 0.5580 - 46s/epoch - 22ms/step
Epoch 15/50
2083/2083 - 46s - loss: 2.7082 - accuracy20: 0.5662 - val_loss: 2.8265 - val_accuracy20: 0.5595 - 46s/epoch - 22ms/step
Epoch 16/50
2083/2083 - 46s - loss: 2.7036 - accuracy20: 0.5677 - val_loss: 2.8242 - val_accuracy20: 0.5585 - 46s/epoch - 22ms/step
Epoch 17/50
2083/2083 - 46s - loss: 2.6996 - accuracy20: 0.5685 - val_loss: 2.8226 - val_accuracy20: 0.5601 - 46s/epoch - 22ms/step
Epoch 18/50
2083/2083 - 46s - loss: 2.6955 - accuracy20: 0.5692 - val_loss: 2.8254 - val_accuracy20: 0.5598 - 46s/epoch - 22ms/step
Epoch 19/50
2083/2083 - 47s - loss: 2.6927 - accuracy20: 0.5693 - val_loss: 2.8106 - val_accuracy20: 0.5596 - 47s/epoch - 22ms/step
Epoch 20/50
2083/2083 - 47s - loss: 2.6891 - accuracy20: 0.5706 - val_loss: 2.8094 - val_accuracy20: 0.5601 - 47s/epoch - 22ms/step
Epoch 21/50
2083/2083 - 48s - loss: 2.6859 - accuracy20: 0.5703 - val_loss: 2.8186 - val_accuracy20: 0.5603 - 48s/epoch - 23ms/step
Epoch 22/50
2083/2083 - 47s - loss: 2.6829 - accuracy20: 0.5713 - val_loss: 2.8197 - val_accuracy20: 0.5604 - 47s/epoch - 22ms/step
Epoch 23/50
2083/2083 - 47s - loss: 2.6784 - accuracy20: 0.5723 - val_loss: 2.8151 - val_accuracy20: 0.5604 - 47s/epoch - 22ms/step
Epoch 24/50
2083/2083 - 46s - loss: 2.6769 - accuracy20: 0.5728 - val_loss: 2.8136 - val_accuracy20: 0.5617 - 46s/epoch - 22ms/step
Epoch 25/50
2083/2083 - 46s - loss: 2.6739 - accuracy20: 0.5725 - val_loss: 2.8212 - val_accuracy20: 0.5625 - 46s/epoch - 22ms/step
Epoch 26/50
2083/2083 - 46s - loss: 2.6696 - accuracy20: 0.5741 - val_loss: 2.8055 - val_accuracy20: 0.5627 - 46s/epoch - 22ms/step
Epoch 27/50
2083/2083 - 46s - loss: 2.6674 - accuracy20: 0.5743 - val_loss: 2.8104 - val_accuracy20: 0.5622 - 46s/epoch - 22ms/step
Epoch 28/50
2083/2083 - 46s - loss: 2.6649 - accuracy20: 0.5745 - val_loss: 2.8100 - val_accuracy20: 0.5607 - 46s/epoch - 22ms/step
Epoch 29/50
2083/2083 - 46s - loss: 2.6622 - accuracy20: 0.5757 - val_loss: 2.8143 - val_accuracy20: 0.5622 - 46s/epoch - 22ms/step
Epoch 30/50
2083/2083 - 46s - loss: 2.6584 - accuracy20: 0.5762 - val_loss: 2.8151 - val_accuracy20: 0.5630 - 46s/epoch - 22ms/step
Epoch 31/50
2083/2083 - 46s - loss: 2.6554 - accuracy20: 0.5772 - val_loss: 2.8084 - val_accuracy20: 0.5625 - 46s/epoch - 22ms/step
Epoch 32/50
2083/2083 - 46s - loss: 2.6524 - accuracy20: 0.5776 - val_loss: 2.8197 - val_accuracy20: 0.5622 - 46s/epoch - 22ms/step
Epoch 33/50
2083/2083 - 46s - loss: 2.6496 - accuracy20: 0.5784 - val_loss: 2.8252 - val_accuracy20: 0.5622 - 46s/epoch - 22ms/step
Epoch 34/50
2083/2083 - 46s - loss: 2.6471 - accuracy20: 0.5783 - val_loss: 2.8191 - val_accuracy20: 0.5617 - 46s/epoch - 22ms/step
Epoch 35/50
2083/2083 - 47s - loss: 2.6443 - accuracy20: 0.5788 - val_loss: 2.8094 - val_accuracy20: 0.5618 - 47s/epoch - 22ms/step
Epoch 36/50
2083/2083 - 46s - loss: 2.6420 - accuracy20: 0.5795 - val_loss: 2.8164 - val_accuracy20: 0.5605 - 46s/epoch - 22ms/step
testing model: results/ATVI/W7/deepOF_L2/h20
Evaluating performance on  test set...
6143/6143 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84474105
{'0': {'precision': 0.5260252365930599, 'recall': 0.4775451252805621, 'f1-score': 0.5006142011619179, 'support': 403654}, '1': {'precision': 0.6521550196601246, 'recall': 0.8008963382251985, 'f1-score': 0.7189127409248771, 'support': 772030}, '2': {'precision': 0.578181155571408, 'recall': 0.37582438075365476, 'f1-score': 0.45554153824536536, 'support': 396813}, 'accuracy': 0.6106281919774728, 'macro avg': {'precision': 0.5854538039415308, 'recall': 0.5514219480864718, 'f1-score': 0.5583561601107201, 'support': 1572497}, 'weighted avg': {'precision': 0.6011109907145756, 'recall': 0.6106281919774728, 'f1-score': 0.5964157213322531, 'support': 1572497}}
[[192763 161681  49210]
 [ 94123 618316  59591]
 [ 79566 168115 149132]]
Evaluating performance on  train set...
2083/2083 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.909151
{'0': {'precision': 0.5202203812967268, 'recall': 0.4968692286285324, 'f1-score': 0.5082767477896861, 'support': 158108}, '1': {'precision': 0.5937721574503856, 'recall': 0.7411993357300583, 'f1-score': 0.6593452083815274, 'support': 219188}, '2': {'precision': 0.5569777614070629, 'recall': 0.3879232939969215, 'f1-score': 0.45732756176398315, 'support': 155920}, 'accuracy': 0.5654481485926904, 'macro avg': {'precision': 0.5569901000513918, 'recall': 0.5419972861185041, 'f1-score': 0.5416498393117323, 'support': 533216}, 'weighted avg': {'precision': 0.5612035427516939, 'recall': 0.5654481485926904, 'f1-score': 0.5554778757661102, 'support': 533216}}
[[ 78559  54699  24850]
 [ 33466 162462  23260]
 [ 38986  56449  60485]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91840565
{'0': {'precision': 0.5034717386546764, 'recall': 0.5017945311415598, 'f1-score': 0.5026317357538682, 'support': 50431}, '1': {'precision': 0.6047595682041217, 'recall': 0.7327685218965774, 'f1-score': 0.6626384569798202, 'support': 74007}, '2': {'precision': 0.5436744423633577, 'recall': 0.3776091455602641, 'f1-score': 0.445674804880602, 'support': 50735}, 'accuracy': 0.5634087444982959, 'macro avg': {'precision': 0.5506352497407186, 'recall': 0.5373907328661337, 'f1-score': 0.5369816658714301, 'support': 175173}, 'weighted avg': {'precision': 0.5579075967727981, 'recall': 0.5634087444982959, 'f1-score': 0.5537349738665561, 'support': 175173}}
[[25306 17029  8096]
 [11793 54230  7984]
 [13164 18413 19158]]
training model: results/ATVI/W7/deepOF_L2/h30
Epoch 1/50
2083/2083 - 49s - loss: 3.0615 - accuracy30: 0.4668 - val_loss: 3.3150 - val_accuracy30: 0.4506 - 49s/epoch - 23ms/step
Epoch 2/50
2083/2083 - 47s - loss: 2.9128 - accuracy30: 0.5123 - val_loss: 3.0766 - val_accuracy30: 0.4842 - 47s/epoch - 23ms/step
Epoch 3/50
2083/2083 - 47s - loss: 2.8713 - accuracy30: 0.5244 - val_loss: 3.0051 - val_accuracy30: 0.4933 - 47s/epoch - 23ms/step
Epoch 4/50
2083/2083 - 47s - loss: 2.8521 - accuracy30: 0.5292 - val_loss: 2.9711 - val_accuracy30: 0.4978 - 47s/epoch - 23ms/step
Epoch 5/50
2083/2083 - 47s - loss: 2.8413 - accuracy30: 0.5320 - val_loss: 2.9583 - val_accuracy30: 0.4993 - 47s/epoch - 23ms/step
Epoch 6/50
2083/2083 - 47s - loss: 2.8329 - accuracy30: 0.5340 - val_loss: 2.9344 - val_accuracy30: 0.5053 - 47s/epoch - 22ms/step
Epoch 7/50
2083/2083 - 46s - loss: 2.8244 - accuracy30: 0.5354 - val_loss: 2.9339 - val_accuracy30: 0.5055 - 46s/epoch - 22ms/step
Epoch 8/50
2083/2083 - 46s - loss: 2.8192 - accuracy30: 0.5371 - val_loss: 2.9233 - val_accuracy30: 0.5073 - 46s/epoch - 22ms/step
Epoch 9/50
2083/2083 - 46s - loss: 2.8137 - accuracy30: 0.5375 - val_loss: 2.9196 - val_accuracy30: 0.5092 - 46s/epoch - 22ms/step
Epoch 10/50
2083/2083 - 46s - loss: 2.8092 - accuracy30: 0.5390 - val_loss: 2.9189 - val_accuracy30: 0.5099 - 46s/epoch - 22ms/step
Epoch 11/50
2083/2083 - 47s - loss: 2.8045 - accuracy30: 0.5399 - val_loss: 2.9265 - val_accuracy30: 0.5088 - 47s/epoch - 22ms/step
Epoch 12/50
2083/2083 - 47s - loss: 2.7999 - accuracy30: 0.5411 - val_loss: 2.9172 - val_accuracy30: 0.5115 - 47s/epoch - 23ms/step
Epoch 13/50
2083/2083 - 46s - loss: 2.7958 - accuracy30: 0.5419 - val_loss: 2.9185 - val_accuracy30: 0.5131 - 46s/epoch - 22ms/step
Epoch 14/50
2083/2083 - 46s - loss: 2.7913 - accuracy30: 0.5434 - val_loss: 2.9040 - val_accuracy30: 0.5167 - 46s/epoch - 22ms/step
Epoch 15/50
2083/2083 - 46s - loss: 2.7879 - accuracy30: 0.5442 - val_loss: 2.9076 - val_accuracy30: 0.5146 - 46s/epoch - 22ms/step
Epoch 16/50
2083/2083 - 46s - loss: 2.7843 - accuracy30: 0.5444 - val_loss: 2.9046 - val_accuracy30: 0.5180 - 46s/epoch - 22ms/step
Epoch 17/50
2083/2083 - 46s - loss: 2.7806 - accuracy30: 0.5456 - val_loss: 2.9129 - val_accuracy30: 0.5170 - 46s/epoch - 22ms/step
Epoch 18/50
2083/2083 - 46s - loss: 2.7773 - accuracy30: 0.5465 - val_loss: 2.9087 - val_accuracy30: 0.5175 - 46s/epoch - 22ms/step
Epoch 19/50
2083/2083 - 46s - loss: 2.7731 - accuracy30: 0.5470 - val_loss: 2.9000 - val_accuracy30: 0.5207 - 46s/epoch - 22ms/step
Epoch 20/50
2083/2083 - 46s - loss: 2.7696 - accuracy30: 0.5483 - val_loss: 2.9024 - val_accuracy30: 0.5202 - 46s/epoch - 22ms/step
Epoch 21/50
2083/2083 - 46s - loss: 2.7673 - accuracy30: 0.5482 - val_loss: 2.9054 - val_accuracy30: 0.5203 - 46s/epoch - 22ms/step
Epoch 22/50
2083/2083 - 46s - loss: 2.7630 - accuracy30: 0.5495 - val_loss: 2.9071 - val_accuracy30: 0.5202 - 46s/epoch - 22ms/step
Epoch 23/50
2083/2083 - 46s - loss: 2.7597 - accuracy30: 0.5502 - val_loss: 2.9210 - val_accuracy30: 0.5207 - 46s/epoch - 22ms/step
Epoch 24/50
2083/2083 - 46s - loss: 2.7564 - accuracy30: 0.5512 - val_loss: 2.9169 - val_accuracy30: 0.5195 - 46s/epoch - 22ms/step
Epoch 25/50
2083/2083 - 46s - loss: 2.7530 - accuracy30: 0.5515 - val_loss: 2.9106 - val_accuracy30: 0.5209 - 46s/epoch - 22ms/step
Epoch 26/50
2083/2083 - 46s - loss: 2.7502 - accuracy30: 0.5532 - val_loss: 2.9044 - val_accuracy30: 0.5215 - 46s/epoch - 22ms/step
Epoch 27/50
2083/2083 - 46s - loss: 2.7478 - accuracy30: 0.5533 - val_loss: 2.9242 - val_accuracy30: 0.5187 - 46s/epoch - 22ms/step
Epoch 28/50
2083/2083 - 46s - loss: 2.7433 - accuracy30: 0.5539 - val_loss: 2.9146 - val_accuracy30: 0.5219 - 46s/epoch - 22ms/step
Epoch 29/50
2083/2083 - 46s - loss: 2.7414 - accuracy30: 0.5541 - val_loss: 2.9047 - val_accuracy30: 0.5227 - 46s/epoch - 22ms/step
testing model: results/ATVI/W7/deepOF_L2/h30
Evaluating performance on  test set...
6143/6143 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91672647
{'0': {'precision': 0.5293038570084666, 'recall': 0.4624673925739426, 'f1-score': 0.49363353642910085, 'support': 462318}, '1': {'precision': 0.5574344072454045, 'recall': 0.8081502146119349, 'f1-score': 0.6597771073823829, 'support': 654903}, '2': {'precision': 0.604148790506618, 'recall': 0.29074451541482527, 'f1-score': 0.3925673511512865, 'support': 455276}, 'accuracy': 0.5567171193331371, 'macro avg': {'precision': 0.5636290182534963, 'recall': 0.520454040866901, 'f1-score': 0.5153259983209234, 'support': 1572497}, 'weighted avg': {'precision': 0.5626889023758828, 'recall': 0.5567171193331371, 'f1-score': 0.5335667855732804, 'support': 1572497}}
[[213807 199286  49225]
 [ 88137 529260  37506]
 [101996 220911 132369]]
Evaluating performance on  train set...
2083/2083 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9623018
{'0': {'precision': 0.5231935290593169, 'recall': 0.4924820087080109, 'f1-score': 0.5073734486124669, 'support': 177308}, '1': {'precision': 0.4988739357319418, 'recall': 0.7536846065327077, 'f1-score': 0.6003609304867273, 'support': 180752}, '2': {'precision': 0.5791336429253225, 'recall': 0.3082908949736235, 'f1-score': 0.4023815467385999, 'support': 175156}, 'accuracy': 0.520520764568205, 'macro avg': {'precision': 0.5337337025721937, 'recall': 0.5181525034047807, 'f1-score': 0.5033719752792647, 'support': 533216}, 'weighted avg': {'precision': 0.5333253170236772, 'recall': 0.520520764568205, 'f1-score': 0.5044060053232882, 'support': 533216}}
[[ 87321  65363  24624]
 [ 29904 136230  14618]
 [ 49675  71482  53999]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96535677
{'0': {'precision': 0.5096268590257369, 'recall': 0.5032803897771446, 'f1-score': 0.5064337421901272, 'support': 56853}, '1': {'precision': 0.5129130547216694, 'recall': 0.742653881843489, 'f1-score': 0.606764737178123, 'support': 61427}, '2': {'precision': 0.566756406421378, 'recall': 0.2997205280087181, 'f1-score': 0.39209013566337086, 'support': 56893}, 'accuracy': 0.5211077049545306, 'macro avg': {'precision': 0.5297654400562615, 'recall': 0.5152182665431172, 'f1-score': 0.501762871677207, 'support': 175173}, 'weighted avg': {'precision': 0.529333848590306, 'recall': 0.5211077049545306, 'f1-score': 0.5044795667350106, 'support': 175173}}
[[28613 20195  8045]
 [10818 45619  4990]
 [16714 23127 17052]]
training model: results/ATVI/W7/deepOF_L2/h50
Epoch 1/50
2083/2083 - 49s - loss: 3.1634 - accuracy50: 0.4332 - val_loss: 3.3780 - val_accuracy50: 0.4007 - 49s/epoch - 23ms/step
Epoch 2/50
2083/2083 - 47s - loss: 3.0744 - accuracy50: 0.4666 - val_loss: 3.3175 - val_accuracy50: 0.4198 - 47s/epoch - 23ms/step
Epoch 3/50
2083/2083 - 46s - loss: 3.0438 - accuracy50: 0.4765 - val_loss: 3.2110 - val_accuracy50: 0.4373 - 46s/epoch - 22ms/step
Epoch 4/50
2083/2083 - 47s - loss: 3.0250 - accuracy50: 0.4831 - val_loss: 3.1447 - val_accuracy50: 0.4513 - 47s/epoch - 22ms/step
Epoch 5/50
2083/2083 - 47s - loss: 3.0140 - accuracy50: 0.4863 - val_loss: 3.1293 - val_accuracy50: 0.4562 - 47s/epoch - 23ms/step
Epoch 6/50
2083/2083 - 47s - loss: 3.0061 - accuracy50: 0.4882 - val_loss: 3.1169 - val_accuracy50: 0.4595 - 47s/epoch - 23ms/step
Epoch 7/50
2083/2083 - 47s - loss: 2.9995 - accuracy50: 0.4900 - val_loss: 3.1040 - val_accuracy50: 0.4649 - 47s/epoch - 22ms/step
Epoch 8/50
2083/2083 - 46s - loss: 2.9937 - accuracy50: 0.4911 - val_loss: 3.0899 - val_accuracy50: 0.4670 - 46s/epoch - 22ms/step
Epoch 9/50
2083/2083 - 46s - loss: 2.9897 - accuracy50: 0.4925 - val_loss: 3.0805 - val_accuracy50: 0.4704 - 46s/epoch - 22ms/step
Epoch 10/50
2083/2083 - 46s - loss: 2.9850 - accuracy50: 0.4937 - val_loss: 3.0707 - val_accuracy50: 0.4723 - 46s/epoch - 22ms/step
Epoch 11/50
2083/2083 - 46s - loss: 2.9814 - accuracy50: 0.4949 - val_loss: 3.0711 - val_accuracy50: 0.4733 - 46s/epoch - 22ms/step
Epoch 12/50
2083/2083 - 46s - loss: 2.9774 - accuracy50: 0.4955 - val_loss: 3.0575 - val_accuracy50: 0.4761 - 46s/epoch - 22ms/step
Epoch 13/50
2083/2083 - 46s - loss: 2.9738 - accuracy50: 0.4971 - val_loss: 3.0538 - val_accuracy50: 0.4768 - 46s/epoch - 22ms/step
Epoch 14/50
2083/2083 - 46s - loss: 2.9710 - accuracy50: 0.4975 - val_loss: 3.0647 - val_accuracy50: 0.4758 - 46s/epoch - 22ms/step
Epoch 15/50
2083/2083 - 46s - loss: 2.9680 - accuracy50: 0.4984 - val_loss: 3.0574 - val_accuracy50: 0.4767 - 46s/epoch - 22ms/step
Epoch 16/50
2083/2083 - 46s - loss: 2.9640 - accuracy50: 0.4990 - val_loss: 3.0639 - val_accuracy50: 0.4766 - 46s/epoch - 22ms/step
Epoch 17/50
2083/2083 - 46s - loss: 2.9619 - accuracy50: 0.4999 - val_loss: 3.0590 - val_accuracy50: 0.4782 - 46s/epoch - 22ms/step
Epoch 18/50
2083/2083 - 46s - loss: 2.9596 - accuracy50: 0.5004 - val_loss: 3.0552 - val_accuracy50: 0.4797 - 46s/epoch - 22ms/step
Epoch 19/50
2083/2083 - 46s - loss: 2.9560 - accuracy50: 0.5014 - val_loss: 3.0525 - val_accuracy50: 0.4798 - 46s/epoch - 22ms/step
Epoch 20/50
2083/2083 - 46s - loss: 2.9527 - accuracy50: 0.5028 - val_loss: 3.0533 - val_accuracy50: 0.4797 - 46s/epoch - 22ms/step
Epoch 21/50
2083/2083 - 46s - loss: 2.9499 - accuracy50: 0.5027 - val_loss: 3.0617 - val_accuracy50: 0.4788 - 46s/epoch - 22ms/step
Epoch 22/50
2083/2083 - 46s - loss: 2.9461 - accuracy50: 0.5040 - val_loss: 3.0632 - val_accuracy50: 0.4797 - 46s/epoch - 22ms/step
Epoch 23/50
2083/2083 - 46s - loss: 2.9434 - accuracy50: 0.5056 - val_loss: 3.0717 - val_accuracy50: 0.4788 - 46s/epoch - 22ms/step
Epoch 24/50
2083/2083 - 46s - loss: 2.9409 - accuracy50: 0.5064 - val_loss: 3.0614 - val_accuracy50: 0.4784 - 46s/epoch - 22ms/step
Epoch 25/50
2083/2083 - 46s - loss: 2.9367 - accuracy50: 0.5073 - val_loss: 3.0713 - val_accuracy50: 0.4783 - 46s/epoch - 22ms/step
Epoch 26/50
2083/2083 - 47s - loss: 2.9347 - accuracy50: 0.5074 - val_loss: 3.0737 - val_accuracy50: 0.4786 - 47s/epoch - 22ms/step
Epoch 27/50
2083/2083 - 46s - loss: 2.9311 - accuracy50: 0.5087 - val_loss: 3.0825 - val_accuracy50: 0.4795 - 46s/epoch - 22ms/step
Epoch 28/50
2083/2083 - 46s - loss: 2.9285 - accuracy50: 0.5096 - val_loss: 3.0807 - val_accuracy50: 0.4774 - 46s/epoch - 22ms/step
Epoch 29/50
2083/2083 - 46s - loss: 2.9247 - accuracy50: 0.5107 - val_loss: 3.0788 - val_accuracy50: 0.4771 - 46s/epoch - 22ms/step
testing model: results/ATVI/W7/deepOF_L2/h50
Evaluating performance on  test set...
6143/6143 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9886878
{'0': {'precision': 0.4843845069111889, 'recall': 0.4262972218139056, 'f1-score': 0.45348833313042475, 'support': 476210}, '1': {'precision': 0.5087286822403806, 'recall': 0.7301480832576377, 'f1-score': 0.5996516886595722, 'support': 618706}, '2': {'precision': 0.5399921628322318, 'recall': 0.30008522114573233, 'f1-score': 0.38578271642823586, 'support': 477581}, 'accuracy': 0.5075170254696829, 'macro avg': {'precision': 0.5110351173279337, 'recall': 0.4855101754057585, 'f1-score': 0.47964091273941095, 'support': 1572497}, 'weighted avg': {'precision': 0.510851360115774, 'recall': 0.5075170254696829, 'f1-score': 0.49043417717067955, 'support': 1572497}}
[[203007 212547  60656]
 [105528 451747  61431]
 [110568 223698 143315]]
Evaluating performance on  train set...
2083/2083 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0125276
{'0': {'precision': 0.48253299258940163, 'recall': 0.46632649042762064, 'f1-score': 0.4742913381321309, 'support': 177751}, '1': {'precision': 0.46786793544653765, 'recall': 0.6533447809520603, 'f1-score': 0.5452650854347607, 'support': 178203}, '2': {'precision': 0.5195093572082035, 'recall': 0.3299635567690763, 'f1-score': 0.40358945519908646, 'support': 177262}, 'accuracy': 0.4834963692012243, 'macro avg': {'precision': 0.48997009508138095, 'recall': 0.48321160938291907, 'f1-score': 0.47438195958865936, 'support': 533216}, 'weighted avg': {'precision': 0.48992426960852375, 'recall': 0.4834963692012243, 'f1-score': 0.47450696841721846, 'support': 533216}}
[[ 82890  64993  29868]
 [ 37546 116428  24229]
 [ 51345  67427  58490]]
Evaluating performance on  val set...
685/685 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0179503
{'0': {'precision': 0.46701678196906193, 'recall': 0.4834887165635619, 'f1-score': 0.4751100227751426, 'support': 57385}, '1': {'precision': 0.4772724407066033, 'recall': 0.63224707277556, 'f1-score': 0.5439365416948081, 'support': 59869}, '2': {'precision': 0.5051158963105198, 'recall': 0.3179267597852173, 'f1-score': 0.3902345985123021, 'support': 57919}, 'accuracy': 0.4795887494077284, 'macro avg': {'precision': 0.48313503966206167, 'recall': 0.4778875163747798, 'f1-score': 0.46976038766075096, 'support': 175173}, 'weighted avg': {'precision': 0.48311891321360734, 'recall': 0.4795887494077284, 'f1-score': 0.4705697977594267, 'support': 175173}}
[[27745 19849  9791]
 [13767 37852  8250]
 [17897 21608 18414]]
training model: results/ATVI/W7/deepOF_L2/h100
Epoch 1/50
2083/2083 - 48s - loss: 3.2477 - accuracy100: 0.3942 - val_loss: 3.2747 - val_accuracy100: 0.3741 - 48s/epoch - 23ms/step
Epoch 2/50
2083/2083 - 46s - loss: 3.2093 - accuracy100: 0.4132 - val_loss: 3.2749 - val_accuracy100: 0.3733 - 46s/epoch - 22ms/step
Epoch 3/50
2083/2083 - 46s - loss: 3.1973 - accuracy100: 0.4187 - val_loss: 3.2698 - val_accuracy100: 0.3774 - 46s/epoch - 22ms/step
Epoch 4/50
2083/2083 - 46s - loss: 3.1897 - accuracy100: 0.4225 - val_loss: 3.2670 - val_accuracy100: 0.3783 - 46s/epoch - 22ms/step
Epoch 5/50
2083/2083 - 46s - loss: 3.1857 - accuracy100: 0.4247 - val_loss: 3.2604 - val_accuracy100: 0.3841 - 46s/epoch - 22ms/step
Epoch 6/50
2083/2083 - 46s - loss: 3.1820 - accuracy100: 0.4263 - val_loss: 3.2553 - val_accuracy100: 0.3851 - 46s/epoch - 22ms/step
Epoch 7/50
2083/2083 - 46s - loss: 3.1785 - accuracy100: 0.4277 - val_loss: 3.2515 - val_accuracy100: 0.3886 - 46s/epoch - 22ms/step
Epoch 8/50
2083/2083 - 46s - loss: 3.1760 - accuracy100: 0.4288 - val_loss: 3.2466 - val_accuracy100: 0.3914 - 46s/epoch - 22ms/step
Epoch 9/50
2083/2083 - 46s - loss: 3.1735 - accuracy100: 0.4296 - val_loss: 3.2438 - val_accuracy100: 0.3916 - 46s/epoch - 22ms/step
Epoch 10/50
2083/2083 - 46s - loss: 3.1713 - accuracy100: 0.4306 - val_loss: 3.2408 - val_accuracy100: 0.3942 - 46s/epoch - 22ms/step
Epoch 11/50
2083/2083 - 46s - loss: 3.1684 - accuracy100: 0.4316 - val_loss: 3.2436 - val_accuracy100: 0.3952 - 46s/epoch - 22ms/step
Epoch 12/50
2083/2083 - 46s - loss: 3.1655 - accuracy100: 0.4328 - val_loss: 3.2348 - val_accuracy100: 0.3996 - 46s/epoch - 22ms/step
Epoch 13/50
2083/2083 - 47s - loss: 3.1630 - accuracy100: 0.4341 - val_loss: 3.2354 - val_accuracy100: 0.4001 - 47s/epoch - 22ms/step
Epoch 14/50
2083/2083 - 46s - loss: 3.1606 - accuracy100: 0.4353 - val_loss: 3.2325 - val_accuracy100: 0.4010 - 46s/epoch - 22ms/step
Epoch 15/50
2083/2083 - 46s - loss: 3.1583 - accuracy100: 0.4361 - val_loss: 3.2328 - val_accuracy100: 0.4019 - 46s/epoch - 22ms/step
Epoch 16/50
2083/2083 - 46s - loss: 3.1558 - accuracy100: 0.4364 - val_loss: 3.2400 - val_accuracy100: 0.4020 - 46s/epoch - 22ms/step
Epoch 17/50
2083/2083 - 46s - loss: 3.1530 - accuracy100: 0.4382 - val_loss: 3.2359 - val_accuracy100: 0.4036 - 46s/epoch - 22ms/step
Epoch 18/50
2083/2083 - 46s - loss: 3.1497 - accuracy100: 0.4401 - val_loss: 3.2339 - val_accuracy100: 0.4035 - 46s/epoch - 22ms/step
Epoch 19/50
2083/2083 - 46s - loss: 3.1462 - accuracy100: 0.4406 - val_loss: 3.2371 - val_accuracy100: 0.4040 - 46s/epoch - 22ms/step
Epoch 20/50
2083/2083 - 46s - loss: 3.1428 - accuracy100: 0.4427 - val_loss: 3.2426 - val_accuracy100: 0.4021 - 46s/epoch - 22ms/step
Epoch 21/50
2083/2083 - 47s - loss: 3.1388 - accuracy100: 0.4436 - val_loss: 3.2369 - val_accuracy100: 0.4046 - 47s/epoch - 22ms/step
Epoch 22/50
2083/2083 - 46s - loss: 3.1352 - accuracy100: 0.4455 - val_loss: 3.2496 - val_accuracy100: 0.4041 - 46s/epoch - 22ms/step
Epoch 23/50
2083/2083 - 46s - loss: 3.1314 - accuracy100: 0.4468 - val_loss: 3.2631 - val_accuracy100: 0.4029 - 46s/epoch - 22ms/step
Epoch 24/50
2083/2083 - 46s - loss: 3.1269 - accuracy100: 0.4487 - val_loss: 3.2658 - val_accuracy100: 0.4017 - 46s/epoch - 22ms/step
testing model: results/ATVI/W7/deepOF_L2/h100
Evaluating performance on  test set...
6143/6143 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0694969
{'0': {'precision': 0.3827953263652288, 'recall': 0.43146758775108157, 'f1-score': 0.4056767739408577, 'support': 460906}, '1': {'precision': 0.4229644646859786, 'recall': 0.46395415849709026, 'f1-score': 0.44251212491915476, 'support': 638548}, '2': {'precision': 0.40091673119523935, 'recall': 0.2988015888619005, 'f1-score': 0.34240794573643407, 'support': 473043}, 'accuracy': 0.4047505337053107, 'macro avg': {'precision': 0.4022255074154822, 'recall': 0.3980744450366908, 'f1-score': 0.39686561486548216, 'support': 1572497}, 'weighted avg': {'precision': 0.4045582465116207, 'recall': 0.4047505337053107, 'f1-score': 0.40160189392276197, 'support': 1572497}}
[[198866 188916  73124]
 [204204 296257 138087]
 [116440 215257 141346]]
Evaluating performance on  train set...
2083/2083 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0755106
{'0': {'precision': 0.42427843803056026, 'recall': 0.4321961560991938, 'f1-score': 0.42820069921373, 'support': 179245}, '1': {'precision': 0.3705485301283876, 'recall': 0.4392845703303743, 'f1-score': 0.4019995027414648, 'support': 174832}, '2': {'precision': 0.4324825791870985, 'recall': 0.34611112041487335, 'f1-score': 0.38450614259756527, 'support': 179139}, 'accuracy': 0.4055992318310028, 'macro avg': {'precision': 0.40910318244868216, 'recall': 0.4058639489481471, 'f1-score': 0.40490211485092004, 'support': 533216}, 'weighted avg': {'precision': 0.4094176206212711, 'recall': 0.4055992318310028, 'f1-score': 0.40493019202845765, 'support': 533216}}
[[77469 63247 38529]
 [55199 76801 42832]
 [49922 67215 62002]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0775795
{'0': {'precision': 0.40429960594890046, 'recall': 0.4493360175178357, 'f1-score': 0.42562978823057107, 'support': 56628}, '1': {'precision': 0.38551023190293704, 'recall': 0.42154865424430643, 'f1-score': 0.4027248128866877, 'support': 60375}, '2': {'precision': 0.42156735471028606, 'recall': 0.3349492865738353, 'f1-score': 0.3732996129823352, 'support': 58170}, 'accuracy': 0.40177424603106643, 'macro avg': {'precision': 0.40379239752070784, 'recall': 0.40194465277865915, 'f1-score': 0.40055140469986467, 'support': 175173}, 'weighted avg': {'precision': 0.40355780491463583, 'recall': 0.40177424603106643, 'f1-score': 0.4003580044478144, 'support': 175173}}
[[25445 19017 12166]
 [20356 25451 14568]
 [17135 21551 19484]]
training model: results/ATVI/W7/deepOF_L2/h200
Epoch 1/50
2083/2083 - 49s - loss: 3.2867 - accuracy200: 0.3697 - val_loss: 3.2794 - val_accuracy200: 0.3699 - 49s/epoch - 23ms/step
Epoch 2/50
2083/2083 - 46s - loss: 3.2610 - accuracy200: 0.3839 - val_loss: 3.2746 - val_accuracy200: 0.3749 - 46s/epoch - 22ms/step
Epoch 3/50
2083/2083 - 46s - loss: 3.2530 - accuracy200: 0.3884 - val_loss: 3.2706 - val_accuracy200: 0.3771 - 46s/epoch - 22ms/step
Epoch 4/50
2083/2083 - 46s - loss: 3.2484 - accuracy200: 0.3915 - val_loss: 3.2710 - val_accuracy200: 0.3776 - 46s/epoch - 22ms/step
Epoch 5/50
2083/2083 - 46s - loss: 3.2454 - accuracy200: 0.3940 - val_loss: 3.2712 - val_accuracy200: 0.3772 - 46s/epoch - 22ms/step
Epoch 6/50
2083/2083 - 46s - loss: 3.2421 - accuracy200: 0.3956 - val_loss: 3.2716 - val_accuracy200: 0.3784 - 46s/epoch - 22ms/step
Epoch 7/50
2083/2083 - 46s - loss: 3.2398 - accuracy200: 0.3970 - val_loss: 3.2707 - val_accuracy200: 0.3794 - 46s/epoch - 22ms/step
Epoch 8/50
2083/2083 - 46s - loss: 3.2371 - accuracy200: 0.3991 - val_loss: 3.2669 - val_accuracy200: 0.3809 - 46s/epoch - 22ms/step
Epoch 9/50
2083/2083 - 46s - loss: 3.2356 - accuracy200: 0.4003 - val_loss: 3.2711 - val_accuracy200: 0.3805 - 46s/epoch - 22ms/step
Epoch 10/50
2083/2083 - 46s - loss: 3.2331 - accuracy200: 0.4018 - val_loss: 3.2704 - val_accuracy200: 0.3811 - 46s/epoch - 22ms/step
Epoch 11/50
2083/2083 - 47s - loss: 3.2305 - accuracy200: 0.4028 - val_loss: 3.2723 - val_accuracy200: 0.3809 - 47s/epoch - 22ms/step
Epoch 12/50
2083/2083 - 46s - loss: 3.2288 - accuracy200: 0.4050 - val_loss: 3.2712 - val_accuracy200: 0.3809 - 46s/epoch - 22ms/step
Epoch 13/50
2083/2083 - 46s - loss: 3.2264 - accuracy200: 0.4058 - val_loss: 3.2749 - val_accuracy200: 0.3819 - 46s/epoch - 22ms/step
Epoch 14/50
2083/2083 - 47s - loss: 3.2235 - accuracy200: 0.4075 - val_loss: 3.2672 - val_accuracy200: 0.3837 - 47s/epoch - 22ms/step
Epoch 15/50
2083/2083 - 46s - loss: 3.2212 - accuracy200: 0.4092 - val_loss: 3.2778 - val_accuracy200: 0.3829 - 46s/epoch - 22ms/step
Epoch 16/50
2083/2083 - 46s - loss: 3.2187 - accuracy200: 0.4109 - val_loss: 3.2736 - val_accuracy200: 0.3847 - 46s/epoch - 22ms/step
Epoch 17/50
2083/2083 - 46s - loss: 3.2157 - accuracy200: 0.4130 - val_loss: 3.2715 - val_accuracy200: 0.3863 - 46s/epoch - 22ms/step
Epoch 18/50
2083/2083 - 46s - loss: 3.2125 - accuracy200: 0.4146 - val_loss: 3.2650 - val_accuracy200: 0.3875 - 46s/epoch - 22ms/step
Epoch 19/50
2083/2083 - 46s - loss: 3.2106 - accuracy200: 0.4160 - val_loss: 3.2655 - val_accuracy200: 0.3878 - 46s/epoch - 22ms/step
Epoch 20/50
2083/2083 - 46s - loss: 3.2076 - accuracy200: 0.4173 - val_loss: 3.2735 - val_accuracy200: 0.3842 - 46s/epoch - 22ms/step
Epoch 21/50
2083/2083 - 46s - loss: 3.2036 - accuracy200: 0.4197 - val_loss: 3.2698 - val_accuracy200: 0.3858 - 46s/epoch - 22ms/step
Epoch 22/50
2083/2083 - 46s - loss: 3.1988 - accuracy200: 0.4227 - val_loss: 3.2928 - val_accuracy200: 0.3812 - 46s/epoch - 22ms/step
Epoch 23/50
2083/2083 - 46s - loss: 3.1967 - accuracy200: 0.4227 - val_loss: 3.2849 - val_accuracy200: 0.3819 - 46s/epoch - 22ms/step
Epoch 24/50
2083/2083 - 47s - loss: 3.1924 - accuracy200: 0.4256 - val_loss: 3.2886 - val_accuracy200: 0.3811 - 47s/epoch - 22ms/step
Epoch 25/50
2083/2083 - 47s - loss: 3.1873 - accuracy200: 0.4277 - val_loss: 3.2885 - val_accuracy200: 0.3811 - 47s/epoch - 22ms/step
Epoch 26/50
2083/2083 - 47s - loss: 3.1837 - accuracy200: 0.4298 - val_loss: 3.2918 - val_accuracy200: 0.3794 - 47s/epoch - 22ms/step
Epoch 27/50
2083/2083 - 46s - loss: 3.1795 - accuracy200: 0.4318 - val_loss: 3.3019 - val_accuracy200: 0.3782 - 46s/epoch - 22ms/step
Epoch 28/50
2083/2083 - 47s - loss: 3.1761 - accuracy200: 0.4334 - val_loss: 3.3056 - val_accuracy200: 0.3795 - 47s/epoch - 22ms/step
testing model: results/ATVI/W7/deepOF_L2/h200
Evaluating performance on  test set...
6143/6143 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.080647
{'0': {'precision': 0.37888348490601287, 'recall': 0.38895866459608114, 'f1-score': 0.3838549744165883, 'support': 484887}, '1': {'precision': 0.42596227529513, 'recall': 0.2873460569454057, 'f1-score': 0.34318561744285025, 'support': 582277}, '2': {'precision': 0.3822440363501451, 'recall': 0.515820261095159, 'f1-score': 0.43909822312963664, 'support': 505333}, 'accuracy': 0.392100589063127, 'macro avg': {'precision': 0.3956965988504293, 'recall': 0.3973749942122153, 'f1-score': 0.38871293832969167, 'support': 1572497}, 'weighted avg': {'precision': 0.3973961398581823, 'recall': 0.392100589063127, 'f1-score': 0.3865484011330231, 'support': 1572497}}
[[188601 111997 184289]
 [177989 167315 236973]
 [131191 113481 260661]]
Evaluating performance on  train set...
2083/2083 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0793557
{'0': {'precision': 0.41540149990854214, 'recall': 0.35776657514515914, 'f1-score': 0.38443587294294035, 'support': 177736}, '1': {'precision': 0.39454810719496275, 'recall': 0.29311731652357453, 'f1-score': 0.3363521806726127, 'support': 175295}, '2': {'precision': 0.4029250530190869, 'recall': 0.5588423009684491, 'f1-score': 0.4682453876469152, 'support': 180185}, 'accuracy': 0.40446085638840545, 'macro avg': {'precision': 0.40429155337419725, 'recall': 0.4032420642123942, 'f1-score': 0.39634448042082276, 'support': 533216}, 'weighted avg': {'precision': 0.40432988154280775, 'recall': 0.40446085638840545, 'f1-score': 0.39694935072756915, 'support': 533216}}
[[ 63588  40676  73472]
 [ 48170  51382  75743]
 [ 41318  38172 100695]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0879403
{'0': {'precision': 0.3807910464806426, 'recall': 0.3530512123672043, 'f1-score': 0.366396835280759, 'support': 56666}, '1': {'precision': 0.4017581192683792, 'recall': 0.2660415024072738, 'f1-score': 0.3201089973255286, 'support': 59611}, '2': {'precision': 0.38409831531607364, 'recall': 0.542345829937517, 'f1-score': 0.4497068078306595, 'support': 58896}, 'accuracy': 0.3870859093581773, 'macro avg': {'precision': 0.3888824936883652, 'recall': 0.387146181570665, 'f1-score': 0.3787375468123157, 'support': 175173}, 'weighted avg': {'precision': 0.3890380541889157, 'recall': 0.3870859093581773, 'f1-score': 0.3786553444970749, 'support': 175173}}
[[20006 11732 24928]
 [17461 15859 26291]
 [15071 11883 31942]]
training model: results/ATVI/W7/deepOF_L2/h300
Epoch 1/50
2083/2083 - 50s - loss: 3.2768 - accuracy300: 0.3794 - val_loss: 3.3265 - val_accuracy300: 0.3393 - 50s/epoch - 24ms/step
Epoch 2/50
2083/2083 - 47s - loss: 3.2540 - accuracy300: 0.3887 - val_loss: 3.3223 - val_accuracy300: 0.3419 - 47s/epoch - 23ms/step
Epoch 3/50
2083/2083 - 47s - loss: 3.2484 - accuracy300: 0.3934 - val_loss: 3.3170 - val_accuracy300: 0.3442 - 47s/epoch - 22ms/step
Epoch 4/50
2083/2083 - 46s - loss: 3.2452 - accuracy300: 0.3952 - val_loss: 3.3162 - val_accuracy300: 0.3458 - 46s/epoch - 22ms/step
Epoch 5/50
2083/2083 - 46s - loss: 3.2441 - accuracy300: 0.3947 - val_loss: 3.3121 - val_accuracy300: 0.3472 - 46s/epoch - 22ms/step
Epoch 6/50
2083/2083 - 46s - loss: 3.2428 - accuracy300: 0.3952 - val_loss: 3.3107 - val_accuracy300: 0.3479 - 46s/epoch - 22ms/step
Epoch 7/50
2083/2083 - 46s - loss: 3.2416 - accuracy300: 0.3957 - val_loss: 3.3109 - val_accuracy300: 0.3493 - 46s/epoch - 22ms/step
Epoch 8/50
2083/2083 - 47s - loss: 3.2399 - accuracy300: 0.3970 - val_loss: 3.3081 - val_accuracy300: 0.3503 - 47s/epoch - 22ms/step
Epoch 9/50
2083/2083 - 46s - loss: 3.2395 - accuracy300: 0.3969 - val_loss: 3.3068 - val_accuracy300: 0.3505 - 46s/epoch - 22ms/step
Epoch 10/50
2083/2083 - 47s - loss: 3.2391 - accuracy300: 0.3976 - val_loss: 3.3027 - val_accuracy300: 0.3507 - 47s/epoch - 22ms/step
Epoch 11/50
2083/2083 - 47s - loss: 3.2383 - accuracy300: 0.3980 - val_loss: 3.3034 - val_accuracy300: 0.3516 - 47s/epoch - 22ms/step
Epoch 12/50
2083/2083 - 46s - loss: 3.2368 - accuracy300: 0.3992 - val_loss: 3.3024 - val_accuracy300: 0.3538 - 46s/epoch - 22ms/step
Epoch 13/50
2083/2083 - 47s - loss: 3.2353 - accuracy300: 0.3997 - val_loss: 3.3048 - val_accuracy300: 0.3539 - 47s/epoch - 22ms/step
Epoch 14/50
2083/2083 - 47s - loss: 3.2353 - accuracy300: 0.3995 - val_loss: 3.3031 - val_accuracy300: 0.3557 - 47s/epoch - 22ms/step
Epoch 15/50
2083/2083 - 47s - loss: 3.2325 - accuracy300: 0.4018 - val_loss: 3.2996 - val_accuracy300: 0.3596 - 47s/epoch - 23ms/step
Epoch 16/50
2083/2083 - 47s - loss: 3.2307 - accuracy300: 0.4036 - val_loss: 3.3020 - val_accuracy300: 0.3587 - 47s/epoch - 22ms/step
Epoch 17/50
2083/2083 - 46s - loss: 3.2289 - accuracy300: 0.4045 - val_loss: 3.2967 - val_accuracy300: 0.3631 - 46s/epoch - 22ms/step
Epoch 18/50
2083/2083 - 46s - loss: 3.2269 - accuracy300: 0.4059 - val_loss: 3.3034 - val_accuracy300: 0.3628 - 46s/epoch - 22ms/step
Epoch 19/50
2083/2083 - 47s - loss: 3.2251 - accuracy300: 0.4070 - val_loss: 3.3000 - val_accuracy300: 0.3637 - 47s/epoch - 22ms/step
Epoch 20/50
2083/2083 - 47s - loss: 3.2214 - accuracy300: 0.4095 - val_loss: 3.3063 - val_accuracy300: 0.3630 - 47s/epoch - 23ms/step
Epoch 21/50
2083/2083 - 47s - loss: 3.2193 - accuracy300: 0.4118 - val_loss: 3.3128 - val_accuracy300: 0.3605 - 47s/epoch - 22ms/step
Epoch 22/50
2083/2083 - 46s - loss: 3.2178 - accuracy300: 0.4123 - val_loss: 3.3147 - val_accuracy300: 0.3615 - 46s/epoch - 22ms/step
Epoch 23/50
2083/2083 - 47s - loss: 3.2153 - accuracy300: 0.4132 - val_loss: 3.3141 - val_accuracy300: 0.3624 - 47s/epoch - 22ms/step
Epoch 24/50
2083/2083 - 46s - loss: 3.2133 - accuracy300: 0.4148 - val_loss: 3.3197 - val_accuracy300: 0.3616 - 46s/epoch - 22ms/step
Epoch 25/50
2083/2083 - 47s - loss: 3.2096 - accuracy300: 0.4169 - val_loss: 3.3346 - val_accuracy300: 0.3575 - 47s/epoch - 22ms/step
Epoch 26/50
2083/2083 - 47s - loss: 3.2076 - accuracy300: 0.4185 - val_loss: 3.3375 - val_accuracy300: 0.3588 - 47s/epoch - 22ms/step
Epoch 27/50
2083/2083 - 47s - loss: 3.2062 - accuracy300: 0.4191 - val_loss: 3.3346 - val_accuracy300: 0.3579 - 47s/epoch - 23ms/step
testing model: results/ATVI/W7/deepOF_L2/h300
Evaluating performance on  test set...
6143/6143 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001617
{'0': {'precision': 0.3445516219518388, 'recall': 0.2647320752291809, 'f1-score': 0.29941344672411485, 'support': 435682}, '1': {'precision': 0.4602582108496624, 'recall': 0.17919420795850127, 'f1-score': 0.25795697419777813, 'support': 683973}, '2': {'precision': 0.3097919403120278, 'recall': 0.6645761656383463, 'f1-score': 0.42259252654297497, 'support': 452842}, 'accuracy': 0.34267219587700326, 'macro avg': {'precision': 0.3715339243711763, 'recall': 0.3695008162753428, 'f1-score': 0.3266543158216227, 'support': 1572497}, 'weighted avg': {'precision': 0.3848693707138879, 'recall': 0.34267219587700326, 'f1-score': 0.31685421321211205, 'support': 1572497}}
[[115339  75074 245269]
 [136174 122564 425235]
 [ 83238  68656 300948]]
Evaluating performance on  train set...
2083/2083 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0957658
{'0': {'precision': 0.3967579644321953, 'recall': 0.2743908284507503, 'f1-score': 0.32441910857752443, 'support': 177331}, '1': {'precision': 0.3828742809611397, 'recall': 0.18527799352567337, 'f1-score': 0.24971537291878385, 'support': 176389}, '2': {'precision': 0.36078346965131297, 'recall': 0.653685876008379, 'f1-score': 0.4649505860721673, 'support': 179496}, 'accuracy': 0.37259384564604214, 'macro avg': {'precision': 0.3801385716815493, 'recall': 0.3711182326616009, 'f1-score': 0.3463616891894919, 'support': 533216}, 'weighted avg': {'precision': 0.3800551517653487, 'recall': 0.37259384564604214, 'f1-score': 0.3470139310420957, 'support': 533216}}
[[ 48658  27324 101349]
 [ 37171  32681 106537]
 [ 36810  25352 117334]]
Evaluating performance on  val set...
685/685 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979387
{'0': {'precision': 0.373727237125514, 'recall': 0.27716967089618616, 'f1-score': 0.3182865183177862, 'support': 55089}, '1': {'precision': 0.4058688281828456, 'recall': 0.16686159219443422, 'f1-score': 0.23649492495288266, 'support': 62417}, '2': {'precision': 0.34906493888970697, 'recall': 0.6577071808833475, 'f1-score': 0.45607642959783073, 'support': 57667}, 'accuracy': 0.3631381548526314, 'macro avg': {'precision': 0.37622033473268884, 'recall': 0.36724614799132266, 'f1-score': 0.33695262428949985, 'support': 175173}, 'weighted avg': {'precision': 0.37706097541087297, 'recall': 0.3631381548526314, 'f1-score': 0.3345033150314872, 'support': 175173}}
[[15269  7821 31999]
 [13273 10415 38729]
 [12314  7425 37928]]
training model: results/ATVI/W7/deepOF_L2/h500
Epoch 1/50
2083/2083 - 50s - loss: 3.2561 - accuracy500: 0.3944 - val_loss: 3.3897 - val_accuracy500: 0.3463 - 50s/epoch - 24ms/step
Epoch 2/50
2083/2083 - 47s - loss: 3.2294 - accuracy500: 0.4042 - val_loss: 3.3890 - val_accuracy500: 0.3461 - 47s/epoch - 23ms/step
Epoch 3/50
2083/2083 - 47s - loss: 3.2191 - accuracy500: 0.4100 - val_loss: 3.3898 - val_accuracy500: 0.3469 - 47s/epoch - 23ms/step
Epoch 4/50
2083/2083 - 47s - loss: 3.2178 - accuracy500: 0.4089 - val_loss: 3.3840 - val_accuracy500: 0.3473 - 47s/epoch - 22ms/step
Epoch 5/50
2083/2083 - 47s - loss: 3.2153 - accuracy500: 0.4113 - val_loss: 3.3723 - val_accuracy500: 0.3475 - 47s/epoch - 22ms/step
Epoch 6/50
2083/2083 - 47s - loss: 3.2147 - accuracy500: 0.4113 - val_loss: 3.3801 - val_accuracy500: 0.3481 - 47s/epoch - 22ms/step
Epoch 7/50
2083/2083 - 46s - loss: 3.2133 - accuracy500: 0.4129 - val_loss: 3.3762 - val_accuracy500: 0.3482 - 46s/epoch - 22ms/step
Epoch 8/50
2083/2083 - 46s - loss: 3.2116 - accuracy500: 0.4145 - val_loss: 3.3780 - val_accuracy500: 0.3485 - 46s/epoch - 22ms/step
Epoch 9/50
2083/2083 - 47s - loss: 3.2106 - accuracy500: 0.4149 - val_loss: 3.3813 - val_accuracy500: 0.3488 - 47s/epoch - 23ms/step
Epoch 10/50
2083/2083 - 48s - loss: 3.2089 - accuracy500: 0.4161 - val_loss: 3.3729 - val_accuracy500: 0.3485 - 48s/epoch - 23ms/step
Epoch 11/50
2083/2083 - 49s - loss: 3.2074 - accuracy500: 0.4172 - val_loss: 3.3838 - val_accuracy500: 0.3491 - 49s/epoch - 23ms/step
Epoch 12/50
2083/2083 - 49s - loss: 3.2061 - accuracy500: 0.4174 - val_loss: 3.3831 - val_accuracy500: 0.3490 - 49s/epoch - 23ms/step
Epoch 13/50
2083/2083 - 48s - loss: 3.2050 - accuracy500: 0.4184 - val_loss: 3.3839 - val_accuracy500: 0.3500 - 48s/epoch - 23ms/step
Epoch 14/50
2083/2083 - 47s - loss: 3.2042 - accuracy500: 0.4191 - val_loss: 3.3803 - val_accuracy500: 0.3494 - 47s/epoch - 23ms/step
Epoch 15/50
2083/2083 - 47s - loss: 3.2030 - accuracy500: 0.4191 - val_loss: 3.3806 - val_accuracy500: 0.3492 - 47s/epoch - 23ms/step
testing model: results/ATVI/W7/deepOF_L2/h500
Evaluating performance on  test set...
6143/6143 - 52s - 52s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1693428
{'0': {'precision': 0.31275272161741835, 'recall': 0.03215152809404499, 'f1-score': 0.05830880845326536, 'support': 437833}, '1': {'precision': 0.4314234924107753, 'recall': 0.004648291550275214, 'f1-score': 0.009197486506223243, 'support': 678744}, '2': {'precision': 0.290808157487235, 'recall': 0.9696416037901386, 'f1-score': 0.44742709607943754, 'support': 455920}, 'accuracy': 0.29209022338357404, 'macro avg': {'precision': 0.3449947905051429, 'recall': 0.33548047447815293, 'f1-score': 0.17164446367964203, 'support': 1572497}, 'weighted avg': {'precision': 0.35761265328859676, 'recall': 0.29209022338357404, 'f1-score': 0.1499292023814581, 'support': 1572497}}
[[ 14077   2076 421680]
 [ 19174   3155 656415]
 [ 11759   2082 442079]]
Evaluating performance on  train set...
2083/2083 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1289973
{'0': {'precision': 0.3691702819956616, 'recall': 0.030739358909955015, 'f1-score': 0.05675310938468833, 'support': 177167}, '1': {'precision': 0.38020148926850633, 'recall': 0.004856976588029903, 'f1-score': 0.009591425177491092, 'support': 178712}, '2': {'precision': 0.3342877788992621, 'recall': 0.9730231141837293, 'f1-score': 0.4976165002206144, 'support': 177337}, 'accuracy': 0.3354494238732521, 'macro avg': {'precision': 0.3612198500544766, 'recall': 0.33620648322723806, 'f1-score': 0.1879870115942646, 'support': 533216}, 'weighted avg': {'precision': 0.3612662631037649, 'recall': 0.3354494238732521, 'f1-score': 0.18756882427815358, 'support': 533216}}
[[  5446    743 170978]
 [  5194    868 172650]
 [  4112    672 172553]]
Evaluating performance on  val set...
685/685 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.124654
{'0': {'precision': 0.343988197688714, 'recall': 0.024429853665351168, 'f1-score': 0.04561981315115843, 'support': 57266}, '1': {'precision': 0.3686708860759494, 'recall': 0.004072287472035794, 'f1-score': 0.008055593970405199, 'support': 57216}, '2': {'precision': 0.3475896617666037, 'recall': 0.9763391606663261, 'f1-score': 0.5126641143771765, 'support': 60691}, 'accuracy': 0.3475821045480753, 'macro avg': {'precision': 0.35341624851042236, 'recall': 0.33494710060123767, 'f1-score': 0.18877984049958005, 'support': 175173}, 'weighted avg': {'precision': 0.3532979723407167, 'recall': 0.3475821045480753, 'f1-score': 0.1951640426903128, 'support': 175173}}
[[ 1399   187 55680]
 [ 1444   233 55539]
 [ 1224   212 59255]]
training model: results/ATVI/W7/deepOF_L2/h1000
Epoch 1/50
2083/2083 - 51s - loss: 3.2890 - accuracy1000: 0.3711 - val_loss: 3.3154 - val_accuracy1000: 0.3370 - 51s/epoch - 25ms/step
Epoch 2/50
2083/2083 - 49s - loss: 3.2606 - accuracy1000: 0.3822 - val_loss: 3.3042 - val_accuracy1000: 0.3440 - 49s/epoch - 24ms/step
Epoch 3/50
2083/2083 - 49s - loss: 3.2504 - accuracy1000: 0.3883 - val_loss: 3.2978 - val_accuracy1000: 0.3484 - 49s/epoch - 23ms/step
Epoch 4/50
2083/2083 - 48s - loss: 3.2466 - accuracy1000: 0.3911 - val_loss: 3.2962 - val_accuracy1000: 0.3530 - 48s/epoch - 23ms/step
Epoch 5/50
2083/2083 - 48s - loss: 3.2450 - accuracy1000: 0.3922 - val_loss: 3.2952 - val_accuracy1000: 0.3543 - 48s/epoch - 23ms/step
Epoch 6/50
2083/2083 - 48s - loss: 3.2433 - accuracy1000: 0.3933 - val_loss: 3.2960 - val_accuracy1000: 0.3544 - 48s/epoch - 23ms/step
Epoch 7/50
2083/2083 - 47s - loss: 3.2427 - accuracy1000: 0.3941 - val_loss: 3.2951 - val_accuracy1000: 0.3556 - 47s/epoch - 23ms/step
Epoch 8/50
2083/2083 - 48s - loss: 3.2410 - accuracy1000: 0.3947 - val_loss: 3.2951 - val_accuracy1000: 0.3551 - 48s/epoch - 23ms/step
Epoch 9/50
2083/2083 - 47s - loss: 3.2400 - accuracy1000: 0.3950 - val_loss: 3.2954 - val_accuracy1000: 0.3562 - 47s/epoch - 23ms/step
Epoch 10/50
2083/2083 - 46s - loss: 3.2390 - accuracy1000: 0.3962 - val_loss: 3.2959 - val_accuracy1000: 0.3571 - 46s/epoch - 22ms/step
Epoch 11/50
2083/2083 - 47s - loss: 3.2380 - accuracy1000: 0.3968 - val_loss: 3.2966 - val_accuracy1000: 0.3558 - 47s/epoch - 22ms/step
Epoch 12/50
2083/2083 - 47s - loss: 3.2376 - accuracy1000: 0.3971 - val_loss: 3.2959 - val_accuracy1000: 0.3580 - 47s/epoch - 23ms/step
Epoch 13/50
2083/2083 - 47s - loss: 3.2363 - accuracy1000: 0.3976 - val_loss: 3.2971 - val_accuracy1000: 0.3574 - 47s/epoch - 23ms/step
Epoch 14/50
2083/2083 - 47s - loss: 3.2355 - accuracy1000: 0.3980 - val_loss: 3.2994 - val_accuracy1000: 0.3569 - 47s/epoch - 22ms/step
Epoch 15/50
2083/2083 - 47s - loss: 3.2350 - accuracy1000: 0.3986 - val_loss: 3.2996 - val_accuracy1000: 0.3550 - 47s/epoch - 23ms/step
Epoch 16/50
2083/2083 - 47s - loss: 3.2337 - accuracy1000: 0.3993 - val_loss: 3.3015 - val_accuracy1000: 0.3553 - 47s/epoch - 22ms/step
Epoch 17/50
2083/2083 - 48s - loss: 3.2324 - accuracy1000: 0.4003 - val_loss: 3.3015 - val_accuracy1000: 0.3563 - 48s/epoch - 23ms/step
Epoch 18/50
2083/2083 - 47s - loss: 3.2318 - accuracy1000: 0.4015 - val_loss: 3.3017 - val_accuracy1000: 0.3534 - 47s/epoch - 23ms/step
testing model: results/ATVI/W7/deepOF_L2/h1000
Evaluating performance on  test set...
6143/6143 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0978149
{'0': {'precision': 0.307814816848811, 'recall': 0.011645373950513913, 'f1-score': 0.022441723588433604, 'support': 481307}, '1': {'precision': 0.4028595023305738, 'recall': 0.372910022146027, 'f1-score': 0.38730664506881657, 'support': 584755}, '2': {'precision': 0.3281652114254125, 'recall': 0.6564179016063266, 'f1-score': 0.4375730532301374, 'support': 506435}, 'accuracy': 0.35364073826531944, 'macro avg': {'precision': 0.3462798435349324, 'recall': 0.3469910992342891, 'f1-score': 0.2824404739624625, 'support': 1572497}, 'weighted avg': {'precision': 0.34971251658133157, 'recall': 0.35364073826531944, 'f1-score': 0.2918181497993311, 'support': 1572497}}
[[  5605 154791 320911]
 [  7033 218061 359661]
 [  5571 168431 332433]]
Evaluating performance on  train set...
2083/2083 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013845
{'0': {'precision': 0.3630172865374542, 'recall': 0.011669417034317852, 'f1-score': 0.02261195856105718, 'support': 178158}, '1': {'precision': 0.38100955894683886, 'recall': 0.3212740323429095, 'f1-score': 0.34860127413553954, 'support': 176793}, '2': {'precision': 0.3452382839958352, 'recall': 0.7328583849886405, 'f1-score': 0.4693656487850269, 'support': 178265}, 'accuracy': 0.35543006961531537, 'macro avg': {'precision': 0.3630883764933761, 'recall': 0.35526727812195597, 'f1-score': 0.28019296049387454, 'support': 533216}, 'weighted avg': {'precision': 0.36303891741122885, 'recall': 0.35543006961531537, 'f1-score': 0.2800558005615512, 'support': 533216}}
[[  2079  46311 129768]
 [  1991  56799 118003]
 [  1657  45965 130643]]
Evaluating performance on  val set...
685/685 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980358
{'0': {'precision': 0.31341385886840434, 'recall': 0.008986019721852615, 'f1-score': 0.01747111772627401, 'support': 54863}, '1': {'precision': 0.39884708605367164, 'recall': 0.29757424694133555, 'f1-score': 0.3408471729800336, 'support': 61383}, '2': {'precision': 0.3424176271292536, 'recall': 0.7426476827260848, 'f1-score': 0.46871954158410534, 'support': 58927}, 'accuracy': 0.35691002608849537, 'macro avg': {'precision': 0.3515595240171099, 'recall': 0.3497359831297577, 'f1-score': 0.27567927743013765, 'support': 175173}, 'weighted avg': {'precision': 0.35310749222868437, 'recall': 0.35691002608849537, 'f1-score': 0.28258336831461783, 'support': 175173}}
[[  493 12901 41469]
 [  545 18266 42572]
 [  535 14630 43762]]
training model: results/ATVI/W7/deepVOL_L2/h10
Epoch 1/50
2083/2083 - 53s - loss: 2.9610 - accuracy10: 0.4942 - val_loss: 2.9297 - val_accuracy10: 0.5727 - 53s/epoch - 26ms/step
Epoch 2/50
2083/2083 - 47s - loss: 2.8371 - accuracy10: 0.5255 - val_loss: 3.0710 - val_accuracy10: 0.5877 - 47s/epoch - 23ms/step
Epoch 3/50
2083/2083 - 51s - loss: 2.7859 - accuracy10: 0.5401 - val_loss: 3.0450 - val_accuracy10: 0.5914 - 51s/epoch - 24ms/step
Epoch 4/50
2083/2083 - 48s - loss: 2.7502 - accuracy10: 0.5525 - val_loss: 2.9904 - val_accuracy10: 0.5941 - 48s/epoch - 23ms/step
Epoch 5/50
2083/2083 - 48s - loss: 2.7251 - accuracy10: 0.5590 - val_loss: 2.9383 - val_accuracy10: 0.5988 - 48s/epoch - 23ms/step
Epoch 6/50
2083/2083 - 49s - loss: 2.7082 - accuracy10: 0.5641 - val_loss: 2.9722 - val_accuracy10: 0.6001 - 49s/epoch - 23ms/step
Epoch 7/50
2083/2083 - 48s - loss: 2.6956 - accuracy10: 0.5666 - val_loss: 2.9291 - val_accuracy10: 0.6048 - 48s/epoch - 23ms/step
Epoch 8/50
2083/2083 - 47s - loss: 2.6828 - accuracy10: 0.5698 - val_loss: 2.9163 - val_accuracy10: 0.6051 - 47s/epoch - 23ms/step
Epoch 9/50
2083/2083 - 48s - loss: 2.6710 - accuracy10: 0.5726 - val_loss: 2.8876 - val_accuracy10: 0.6052 - 48s/epoch - 23ms/step
Epoch 10/50
2083/2083 - 45s - loss: 2.6623 - accuracy10: 0.5745 - val_loss: 2.8801 - val_accuracy10: 0.6073 - 45s/epoch - 22ms/step
Epoch 11/50
2083/2083 - 47s - loss: 2.6529 - accuracy10: 0.5766 - val_loss: 2.8763 - val_accuracy10: 0.6085 - 47s/epoch - 23ms/step
Epoch 12/50
2083/2083 - 48s - loss: 2.6454 - accuracy10: 0.5776 - val_loss: 2.8603 - val_accuracy10: 0.6086 - 48s/epoch - 23ms/step
Epoch 13/50
2083/2083 - 46s - loss: 2.6382 - accuracy10: 0.5786 - val_loss: 2.8651 - val_accuracy10: 0.6094 - 46s/epoch - 22ms/step
Epoch 14/50
2083/2083 - 46s - loss: 2.6317 - accuracy10: 0.5799 - val_loss: 2.8566 - val_accuracy10: 0.6100 - 46s/epoch - 22ms/step
Epoch 15/50
2083/2083 - 48s - loss: 2.6260 - accuracy10: 0.5810 - val_loss: 2.8463 - val_accuracy10: 0.6106 - 48s/epoch - 23ms/step
Epoch 16/50
2083/2083 - 49s - loss: 2.6207 - accuracy10: 0.5815 - val_loss: 2.8878 - val_accuracy10: 0.6103 - 49s/epoch - 24ms/step
Epoch 17/50
2083/2083 - 51s - loss: 2.6152 - accuracy10: 0.5823 - val_loss: 2.8589 - val_accuracy10: 0.6097 - 51s/epoch - 24ms/step
Epoch 18/50
2083/2083 - 45s - loss: 2.6099 - accuracy10: 0.5837 - val_loss: 2.8589 - val_accuracy10: 0.6127 - 45s/epoch - 22ms/step
Epoch 19/50
2083/2083 - 48s - loss: 2.6057 - accuracy10: 0.5842 - val_loss: 2.8486 - val_accuracy10: 0.6124 - 48s/epoch - 23ms/step
Epoch 20/50
2083/2083 - 48s - loss: 2.6018 - accuracy10: 0.5850 - val_loss: 2.8513 - val_accuracy10: 0.6115 - 48s/epoch - 23ms/step
Epoch 21/50
2083/2083 - 47s - loss: 2.5975 - accuracy10: 0.5857 - val_loss: 2.8428 - val_accuracy10: 0.6121 - 47s/epoch - 23ms/step
Epoch 22/50
2083/2083 - 50s - loss: 2.5936 - accuracy10: 0.5868 - val_loss: 2.8587 - val_accuracy10: 0.6114 - 50s/epoch - 24ms/step
Epoch 23/50
2083/2083 - 49s - loss: 2.5892 - accuracy10: 0.5868 - val_loss: 2.8538 - val_accuracy10: 0.6116 - 49s/epoch - 23ms/step
Epoch 24/50
2083/2083 - 46s - loss: 2.5861 - accuracy10: 0.5875 - val_loss: 2.8296 - val_accuracy10: 0.6135 - 46s/epoch - 22ms/step
Epoch 25/50
2083/2083 - 48s - loss: 2.5831 - accuracy10: 0.5887 - val_loss: 2.8479 - val_accuracy10: 0.6142 - 48s/epoch - 23ms/step
Epoch 26/50
2083/2083 - 49s - loss: 2.5799 - accuracy10: 0.5886 - val_loss: 2.8241 - val_accuracy10: 0.6143 - 49s/epoch - 24ms/step
Epoch 27/50
2083/2083 - 46s - loss: 2.5754 - accuracy10: 0.5892 - val_loss: 2.8359 - val_accuracy10: 0.6140 - 46s/epoch - 22ms/step
Epoch 28/50
2083/2083 - 45s - loss: 2.5732 - accuracy10: 0.5903 - val_loss: 2.8301 - val_accuracy10: 0.6131 - 45s/epoch - 21ms/step
Epoch 29/50
2083/2083 - 48s - loss: 2.5690 - accuracy10: 0.5907 - val_loss: 2.8388 - val_accuracy10: 0.6141 - 48s/epoch - 23ms/step
Epoch 30/50
2083/2083 - 47s - loss: 2.5660 - accuracy10: 0.5915 - val_loss: 2.8392 - val_accuracy10: 0.6131 - 47s/epoch - 23ms/step
Epoch 31/50
2083/2083 - 46s - loss: 2.5627 - accuracy10: 0.5916 - val_loss: 2.8520 - val_accuracy10: 0.6133 - 46s/epoch - 22ms/step
Epoch 32/50
2083/2083 - 44s - loss: 2.5605 - accuracy10: 0.5926 - val_loss: 2.8442 - val_accuracy10: 0.6140 - 44s/epoch - 21ms/step
Epoch 33/50
2083/2083 - 49s - loss: 2.5576 - accuracy10: 0.5931 - val_loss: 2.8519 - val_accuracy10: 0.6134 - 49s/epoch - 23ms/step
Epoch 34/50
2083/2083 - 50s - loss: 2.5546 - accuracy10: 0.5926 - val_loss: 2.8485 - val_accuracy10: 0.6147 - 50s/epoch - 24ms/step
Epoch 35/50
2083/2083 - 46s - loss: 2.5514 - accuracy10: 0.5936 - val_loss: 2.8447 - val_accuracy10: 0.6139 - 46s/epoch - 22ms/step
Epoch 36/50
2083/2083 - 49s - loss: 2.5483 - accuracy10: 0.5943 - val_loss: 2.8301 - val_accuracy10: 0.6139 - 49s/epoch - 24ms/step
testing model: results/ATVI/W7/deepVOL_L2/h10
Evaluating performance on  test set...
6143/6143 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7608935
{'0': {'precision': 0.5070897761540465, 'recall': 0.4245668475221119, 'f1-score': 0.4621735137199055, 'support': 316459}, '1': {'precision': 0.7468270868422889, 'recall': 0.8387698102096389, 'f1-score': 0.7901327444003056, 'support': 944147}, '2': {'precision': 0.5332637430662605, 'recall': 0.4225831687485572, 'f1-score': 0.4715154268706054, 'support': 311896}, 'accuracy': 0.6728652809344599, 'macro avg': {'precision': 0.595726868687532, 'recall': 0.561973275493436, 'f1-score': 0.5746072283302722, 'support': 1572502}, 'weighted avg': {'precision': 0.656222062318658, 'recall': 0.6728652809344599, 'f1-score': 0.6609366498642528, 'support': 1572502}}
[[134358 137147  44954]
 [ 81820 791922  70405]
 [ 48781 131313 131802]]
Evaluating performance on  train set...
2083/2083 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86036736
{'0': {'precision': 0.501392207232292, 'recall': 0.44077887621995515, 'f1-score': 0.4691358024691358, 'support': 126644}, '1': {'precision': 0.6878056152923359, 'recall': 0.7778881695617802, 'f1-score': 0.7300786243660337, 'support': 280818}, '2': {'precision': 0.5164643384538673, 'recall': 0.42829310961790784, 'f1-score': 0.4682643528762264, 'support': 125755}, 'accuracy': 0.6153723530945188, 'macro avg': {'precision': 0.5685540536594984, 'recall': 0.5489867184665477, 'f1-score': 0.5558262599037986, 'support': 533217}, 'weighted avg': {'precision': 0.6031212149090439, 'recall': 0.6153723530945188, 'f1-score': 0.6063554564109395, 'support': 533217}}
[[ 55822  50432  20390]
 [ 32337 218445  30036]
 [ 23175  48720  53860]]
Evaluating performance on  val set...
685/685 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8636146
{'0': {'precision': 0.4895288682324951, 'recall': 0.4362780147439533, 'f1-score': 0.46137199176074883, 'support': 40559}, '1': {'precision': 0.6958121217942561, 'recall': 0.770132783347331, 'f1-score': 0.7310884933870911, 'support': 94063}, '2': {'precision': 0.49773742696757933, 'recall': 0.42857142857142855, 'f1-score': 0.4605721706176209, 'support': 40551}, 'accuracy': 0.6137646783465488, 'macro avg': {'precision': 0.5610261389981103, 'recall': 0.5449940755542376, 'f1-score': 0.5510108852551536, 'support': 175173}, 'weighted avg': {'precision': 0.602197412728772, 'recall': 0.6137646783465488, 'f1-score': 0.6060170554709304, 'support': 175173}}
[[17695 15775  7089]
 [11174 72441 10448]
 [ 7278 15894 17379]]
training model: results/ATVI/W7/deepVOL_L2/h20
Epoch 1/50
2083/2083 - 50s - loss: 3.0451 - accuracy20: 0.4769 - val_loss: 3.1655 - val_accuracy20: 0.4936 - 50s/epoch - 24ms/step
Epoch 2/50
2083/2083 - 53s - loss: 2.9073 - accuracy20: 0.5178 - val_loss: 3.0528 - val_accuracy20: 0.5254 - 53s/epoch - 26ms/step
Epoch 3/50
2083/2083 - 50s - loss: 2.8578 - accuracy20: 0.5338 - val_loss: 3.0770 - val_accuracy20: 0.5209 - 50s/epoch - 24ms/step
Epoch 4/50
2083/2083 - 46s - loss: 2.8340 - accuracy20: 0.5405 - val_loss: 3.0675 - val_accuracy20: 0.5267 - 46s/epoch - 22ms/step
Epoch 5/50
2083/2083 - 47s - loss: 2.8191 - accuracy20: 0.5439 - val_loss: 3.0107 - val_accuracy20: 0.5357 - 47s/epoch - 22ms/step
Epoch 6/50
2083/2083 - 49s - loss: 2.8061 - accuracy20: 0.5468 - val_loss: 3.0146 - val_accuracy20: 0.5335 - 49s/epoch - 23ms/step
Epoch 7/50
2083/2083 - 50s - loss: 2.7940 - accuracy20: 0.5494 - val_loss: 2.9736 - val_accuracy20: 0.5388 - 50s/epoch - 24ms/step
Epoch 8/50
2083/2083 - 44s - loss: 2.7835 - accuracy20: 0.5517 - val_loss: 2.9860 - val_accuracy20: 0.5401 - 44s/epoch - 21ms/step
Epoch 9/50
2083/2083 - 49s - loss: 2.7756 - accuracy20: 0.5534 - val_loss: 2.9883 - val_accuracy20: 0.5400 - 49s/epoch - 24ms/step
Epoch 10/50
2083/2083 - 49s - loss: 2.7674 - accuracy20: 0.5554 - val_loss: 2.9789 - val_accuracy20: 0.5430 - 49s/epoch - 23ms/step
Epoch 11/50
2083/2083 - 44s - loss: 2.7602 - accuracy20: 0.5566 - val_loss: 2.9852 - val_accuracy20: 0.5445 - 44s/epoch - 21ms/step
Epoch 12/50
2083/2083 - 46s - loss: 2.7546 - accuracy20: 0.5581 - val_loss: 2.9746 - val_accuracy20: 0.5475 - 46s/epoch - 22ms/step
Epoch 13/50
2083/2083 - 46s - loss: 2.7486 - accuracy20: 0.5600 - val_loss: 2.9792 - val_accuracy20: 0.5465 - 46s/epoch - 22ms/step
Epoch 14/50
2083/2083 - 48s - loss: 2.7435 - accuracy20: 0.5604 - val_loss: 2.9883 - val_accuracy20: 0.5452 - 48s/epoch - 23ms/step
Epoch 15/50
2083/2083 - 46s - loss: 2.7395 - accuracy20: 0.5617 - val_loss: 2.9850 - val_accuracy20: 0.5470 - 46s/epoch - 22ms/step
Epoch 16/50
2083/2083 - 48s - loss: 2.7347 - accuracy20: 0.5627 - val_loss: 2.9608 - val_accuracy20: 0.5492 - 48s/epoch - 23ms/step
Epoch 17/50
2083/2083 - 45s - loss: 2.7300 - accuracy20: 0.5641 - val_loss: 2.9762 - val_accuracy20: 0.5508 - 45s/epoch - 22ms/step
Epoch 18/50
2083/2083 - 47s - loss: 2.7268 - accuracy20: 0.5639 - val_loss: 3.0002 - val_accuracy20: 0.5476 - 47s/epoch - 22ms/step
Epoch 19/50
2083/2083 - 48s - loss: 2.7233 - accuracy20: 0.5651 - val_loss: 2.9830 - val_accuracy20: 0.5508 - 48s/epoch - 23ms/step
Epoch 20/50
2083/2083 - 47s - loss: 2.7201 - accuracy20: 0.5653 - val_loss: 2.9768 - val_accuracy20: 0.5515 - 47s/epoch - 22ms/step
Epoch 21/50
2083/2083 - 48s - loss: 2.7157 - accuracy20: 0.5665 - val_loss: 2.9849 - val_accuracy20: 0.5512 - 48s/epoch - 23ms/step
Epoch 22/50
2083/2083 - 47s - loss: 2.7131 - accuracy20: 0.5672 - val_loss: 2.9722 - val_accuracy20: 0.5513 - 47s/epoch - 22ms/step
Epoch 23/50
2083/2083 - 45s - loss: 2.7103 - accuracy20: 0.5678 - val_loss: 2.9749 - val_accuracy20: 0.5522 - 45s/epoch - 21ms/step
Epoch 24/50
2083/2083 - 49s - loss: 2.7073 - accuracy20: 0.5685 - val_loss: 2.9740 - val_accuracy20: 0.5525 - 49s/epoch - 24ms/step
Epoch 25/50
2083/2083 - 44s - loss: 2.7047 - accuracy20: 0.5690 - val_loss: 2.9605 - val_accuracy20: 0.5530 - 44s/epoch - 21ms/step
Epoch 26/50
2083/2083 - 46s - loss: 2.7026 - accuracy20: 0.5696 - val_loss: 2.9668 - val_accuracy20: 0.5537 - 46s/epoch - 22ms/step
Epoch 27/50
2083/2083 - 49s - loss: 2.6995 - accuracy20: 0.5697 - val_loss: 2.9640 - val_accuracy20: 0.5550 - 49s/epoch - 24ms/step
Epoch 28/50
2083/2083 - 50s - loss: 2.6967 - accuracy20: 0.5708 - val_loss: 2.9470 - val_accuracy20: 0.5561 - 50s/epoch - 24ms/step
Epoch 29/50
2083/2083 - 45s - loss: 2.6953 - accuracy20: 0.5713 - val_loss: 2.9569 - val_accuracy20: 0.5552 - 45s/epoch - 22ms/step
Epoch 30/50
2083/2083 - 43s - loss: 2.6917 - accuracy20: 0.5719 - val_loss: 2.9615 - val_accuracy20: 0.5557 - 43s/epoch - 21ms/step
Epoch 31/50
2083/2083 - 44s - loss: 2.6895 - accuracy20: 0.5722 - val_loss: 2.9567 - val_accuracy20: 0.5566 - 44s/epoch - 21ms/step
Epoch 32/50
2083/2083 - 47s - loss: 2.6878 - accuracy20: 0.5724 - val_loss: 2.9503 - val_accuracy20: 0.5574 - 47s/epoch - 22ms/step
Epoch 33/50
2083/2083 - 44s - loss: 2.6842 - accuracy20: 0.5736 - val_loss: 2.9694 - val_accuracy20: 0.5550 - 44s/epoch - 21ms/step
Epoch 34/50
2083/2083 - 50s - loss: 2.6819 - accuracy20: 0.5736 - val_loss: 2.9561 - val_accuracy20: 0.5564 - 50s/epoch - 24ms/step
Epoch 35/50
2083/2083 - 45s - loss: 2.6805 - accuracy20: 0.5740 - val_loss: 2.9592 - val_accuracy20: 0.5556 - 45s/epoch - 21ms/step
Epoch 36/50
2083/2083 - 49s - loss: 2.6775 - accuracy20: 0.5744 - val_loss: 2.9888 - val_accuracy20: 0.5551 - 49s/epoch - 24ms/step
Epoch 37/50
2083/2083 - 45s - loss: 2.6743 - accuracy20: 0.5752 - val_loss: 2.9706 - val_accuracy20: 0.5576 - 45s/epoch - 22ms/step
Epoch 38/50
2083/2083 - 48s - loss: 2.6722 - accuracy20: 0.5755 - val_loss: 2.9800 - val_accuracy20: 0.5557 - 48s/epoch - 23ms/step
testing model: results/ATVI/W7/deepVOL_L2/h20
Evaluating performance on  test set...
6143/6143 - 64s - 64s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86533785
{'0': {'precision': 0.5528973873993056, 'recall': 0.3830876214211571, 'f1-score': 0.4525887552316563, 'support': 403657}, '1': {'precision': 0.6307604692226461, 'recall': 0.8564667176146005, 'f1-score': 0.7264866504021004, 'support': 772030}, '2': {'precision': 0.5811304859895637, 'recall': 0.35811398258634375, 'f1-score': 0.4431454423268527, 'support': 396815}, 'accuracy': 0.6091941377499043, 'macro avg': {'precision': 0.5882627808705051, 'recall': 0.5325561072073671, 'f1-score': 0.5407402826535365, 'support': 1572502}, 'weighted avg': {'precision': 0.5982492865238643, 'recall': 0.6091941377499043, 'f1-score': 0.5846777088852085, 'support': 1572502}}
[[154636 196636  52385]
 [ 60770 661218  50042]
 [ 64277 190433 142105]]
Evaluating performance on  train set...
2083/2083 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9478581
{'0': {'precision': 0.5408075305151369, 'recall': 0.39785907704405504, 'f1-score': 0.4584485763453746, 'support': 157689}, '1': {'precision': 0.557144878547284, 'recall': 0.8081643823120254, 'f1-score': 0.6595789826344296, 'support': 219245}, '2': {'precision': 0.5604734634618487, 'recall': 0.35570087597499406, 'f1-score': 0.43520298120696604, 'support': 156283}, 'accuracy': 0.5542096369770656, 'macro avg': {'precision': 0.5528086241747565, 'recall': 0.5205747784436915, 'f1-score': 0.5177435133955901, 'support': 533217}, 'weighted avg': {'precision': 0.5532890021636759, 'recall': 0.5542096369770656, 'f1-score': 0.5343350251679514, 'support': 533217}}
[[ 62738  70865  24086]
 [ 22551 177186  19508]
 [ 30719  69974  55590]]
Evaluating performance on  val set...
685/685 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9496979
{'0': {'precision': 0.5276671557325509, 'recall': 0.3995476818695816, 'f1-score': 0.45475585661868473, 'support': 50407}, '1': {'precision': 0.5706509739168835, 'recall': 0.8012049816691826, 'f1-score': 0.6665545332727812, 'support': 74192}, '2': {'precision': 0.542938059565138, 'recall': 0.3525329220548108, 'f1-score': 0.4274924471299094, 'support': 50574}, 'accuracy': 0.5560902650522627, 'macro avg': {'precision': 0.5470853964048574, 'recall': 0.517761861864525, 'f1-score': 0.5162676123404585, 'support': 175173}, 'weighted avg': {'precision': 0.550281178037137, 'recall': 0.5560902650522627, 'f1-score': 0.5365889458894936, 'support': 175173}}
[[20140 22113  8154]
 [ 7894 59443  6855]
 [10134 22611 17829]]
training model: results/ATVI/W7/deepVOL_L2/h30
Epoch 1/50
2083/2083 - 49s - loss: 3.0810 - accuracy30: 0.4613 - val_loss: 3.4326 - val_accuracy30: 0.4408 - 49s/epoch - 24ms/step
Epoch 2/50
2083/2083 - 47s - loss: 2.9688 - accuracy30: 0.4965 - val_loss: 3.1706 - val_accuracy30: 0.4757 - 47s/epoch - 22ms/step
Epoch 3/50
2083/2083 - 51s - loss: 2.9272 - accuracy30: 0.5079 - val_loss: 3.0965 - val_accuracy30: 0.4806 - 51s/epoch - 25ms/step
Epoch 4/50
2083/2083 - 50s - loss: 2.9043 - accuracy30: 0.5137 - val_loss: 3.0843 - val_accuracy30: 0.4835 - 50s/epoch - 24ms/step
Epoch 5/50
2083/2083 - 49s - loss: 2.8885 - accuracy30: 0.5185 - val_loss: 3.1103 - val_accuracy30: 0.4864 - 49s/epoch - 24ms/step
Epoch 6/50
2083/2083 - 48s - loss: 2.8764 - accuracy30: 0.5219 - val_loss: 3.1113 - val_accuracy30: 0.4844 - 48s/epoch - 23ms/step
Epoch 7/50
2083/2083 - 50s - loss: 2.8686 - accuracy30: 0.5232 - val_loss: 3.1192 - val_accuracy30: 0.4883 - 50s/epoch - 24ms/step
Epoch 8/50
2083/2083 - 47s - loss: 2.8594 - accuracy30: 0.5255 - val_loss: 3.1214 - val_accuracy30: 0.4906 - 47s/epoch - 23ms/step
Epoch 9/50
2083/2083 - 44s - loss: 2.8514 - accuracy30: 0.5283 - val_loss: 3.1068 - val_accuracy30: 0.4919 - 44s/epoch - 21ms/step
Epoch 10/50
2083/2083 - 49s - loss: 2.8452 - accuracy30: 0.5289 - val_loss: 3.1248 - val_accuracy30: 0.4923 - 49s/epoch - 23ms/step
Epoch 11/50
2083/2083 - 50s - loss: 2.8380 - accuracy30: 0.5316 - val_loss: 3.1194 - val_accuracy30: 0.4943 - 50s/epoch - 24ms/step
Epoch 12/50
2083/2083 - 45s - loss: 2.8326 - accuracy30: 0.5324 - val_loss: 3.1084 - val_accuracy30: 0.4947 - 45s/epoch - 22ms/step
Epoch 13/50
2083/2083 - 44s - loss: 2.8264 - accuracy30: 0.5341 - val_loss: 3.1345 - val_accuracy30: 0.4940 - 44s/epoch - 21ms/step
Epoch 14/50
2083/2083 - 50s - loss: 2.8222 - accuracy30: 0.5347 - val_loss: 3.1347 - val_accuracy30: 0.4922 - 50s/epoch - 24ms/step
testing model: results/ATVI/W7/deepVOL_L2/h30
Evaluating performance on  test set...
6143/6143 - 60s - 60s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96495783
{'0': {'precision': 0.571228122852705, 'recall': 0.2139781062157842, 'f1-score': 0.3113330165254144, 'support': 462323}, '1': {'precision': 0.5238787522488703, 'recall': 0.9034895244028505, 'f1-score': 0.6632051061473616, 'support': 654903}, '2': {'precision': 0.5314511437284845, 'recall': 0.3150155070770258, 'f1-score': 0.3955627817563253, 'support': 455276}, 'accuracy': 0.5303929661138745, 'macro avg': {'precision': 0.5421860062766864, 'recall': 0.4774943792318868, 'f1-score': 0.4567003014763671, 'support': 1572502}, 'weighted avg': {'precision': 0.5399920743107497, 'recall': 0.5303929661138745, 'f1-score': 0.48226435887343705, 'support': 1572502}}
[[ 98927 276243  87153]
 [ 23914 591698  39291]
 [ 50342 261515 143419]]
Evaluating performance on  train set...
2083/2083 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0284165
{'0': {'precision': 0.5417453338232872, 'recall': 0.24149481187760888, 'f1-score': 0.33407043343048465, 'support': 177039}, '1': {'precision': 0.45385829926121435, 'recall': 0.8522734815798207, 'f1-score': 0.5923007134948949, 'support': 180780}, '2': {'precision': 0.5121144031631569, 'recall': 0.3352489766131883, 'f1-score': 0.4052236234580663, 'support': 175398}, 'accuracy': 0.4794108214854365, 'macro avg': {'precision': 0.5025726787492194, 'recall': 0.4763390900235393, 'f1-score': 0.44386492346114864, 'support': 533217}, 'weighted avg': {'precision': 0.5022015381752545, 'recall': 0.4794108214854365, 'f1-score': 0.4450252553031966, 'support': 533217}}
[[ 42754  94474  39811]
 [ 10497 154074  16209]
 [ 25668  90928  58802]]
Evaluating performance on  val set...
685/685 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0261173
{'0': {'precision': 0.5356219864995179, 'recall': 0.24442019291698938, 'f1-score': 0.33566602608264745, 'support': 56812}, '1': {'precision': 0.46654671404795106, 'recall': 0.8424139051332034, 'f1-score': 0.6005152997712995, 'support': 61560}, '2': {'precision': 0.49555036358386056, 'recall': 0.3323356983151705, 'f1-score': 0.39785444812106135, 'support': 56801}, 'accuracy': 0.4830767298613371, 'macro avg': {'precision': 0.49923968804377644, 'recall': 0.47305659878845435, 'f1-score': 0.4446785913250027, 'support': 175173}, 'weighted avg': {'precision': 0.49835378863026464, 'recall': 0.4830767298613371, 'f1-score': 0.4489054285503643, 'support': 175173}}
[[13886 29613 13313]
 [ 3798 51859  5903]
 [ 8241 29683 18877]]
training model: results/ATVI/W7/deepVOL_L2/h50
Epoch 1/50
2083/2083 - 51s - loss: 3.1711 - accuracy50: 0.4287 - val_loss: 3.2032 - val_accuracy50: 0.4273 - 51s/epoch - 25ms/step
Epoch 2/50
2083/2083 - 46s - loss: 3.0912 - accuracy50: 0.4597 - val_loss: 3.1992 - val_accuracy50: 0.4397 - 46s/epoch - 22ms/step
Epoch 3/50
2083/2083 - 46s - loss: 3.0627 - accuracy50: 0.4699 - val_loss: 3.2137 - val_accuracy50: 0.4421 - 46s/epoch - 22ms/step
Epoch 4/50
2083/2083 - 51s - loss: 3.0523 - accuracy50: 0.4729 - val_loss: 3.2694 - val_accuracy50: 0.4449 - 51s/epoch - 25ms/step
Epoch 5/50
2083/2083 - 48s - loss: 3.0419 - accuracy50: 0.4770 - val_loss: 3.2734 - val_accuracy50: 0.4470 - 48s/epoch - 23ms/step
Epoch 6/50
2083/2083 - 48s - loss: 3.0358 - accuracy50: 0.4779 - val_loss: 3.2530 - val_accuracy50: 0.4491 - 48s/epoch - 23ms/step
Epoch 7/50
2083/2083 - 46s - loss: 3.0303 - accuracy50: 0.4808 - val_loss: 3.2392 - val_accuracy50: 0.4514 - 46s/epoch - 22ms/step
Epoch 8/50
2083/2083 - 47s - loss: 3.0248 - accuracy50: 0.4824 - val_loss: 3.2620 - val_accuracy50: 0.4507 - 47s/epoch - 23ms/step
Epoch 9/50
2083/2083 - 51s - loss: 3.0199 - accuracy50: 0.4832 - val_loss: 3.2785 - val_accuracy50: 0.4501 - 51s/epoch - 24ms/step
Epoch 10/50
2083/2083 - 49s - loss: 3.0173 - accuracy50: 0.4840 - val_loss: 3.2659 - val_accuracy50: 0.4503 - 49s/epoch - 23ms/step
Epoch 11/50
2083/2083 - 50s - loss: 3.0123 - accuracy50: 0.4859 - val_loss: 3.2751 - val_accuracy50: 0.4521 - 50s/epoch - 24ms/step
Epoch 12/50
2083/2083 - 47s - loss: 3.0093 - accuracy50: 0.4873 - val_loss: 3.2779 - val_accuracy50: 0.4524 - 47s/epoch - 23ms/step
testing model: results/ATVI/W7/deepVOL_L2/h50
Evaluating performance on  test set...
6143/6143 - 58s - 58s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0348488
{'0': {'precision': 0.4648923867783049, 'recall': 0.23890099829068445, 'f1-score': 0.3156132400653043, 'support': 476214}, '1': {'precision': 0.46991647561972943, 'recall': 0.8497719433785998, 'f1-score': 0.6051759354167757, 'support': 618706}, '2': {'precision': 0.4926632463579455, 'recall': 0.21554623080434354, 'f1-score': 0.29988784175491234, 'support': 477582}, 'accuracy': 0.47215711013404116, 'macro avg': {'precision': 0.47582403625199327, 'recall': 0.4347397241578759, 'f1-score': 0.4068923390789975, 'support': 1572502}, 'weighted avg': {'precision': 0.47530337294588143, 'recall': 0.47215711013404116, 'f1-score': 0.4247666845850911, 'support': 1572502}}
[[113768 301145  61301]
 [ 48241 525759  44706]
 [ 82710 291931 102941]]
Evaluating performance on  train set...
2083/2083 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.069056
{'0': {'precision': 0.447361886529481, 'recall': 0.31435213067142465, 'f1-score': 0.369243991934151, 'support': 177667}, '1': {'precision': 0.421020381228907, 'recall': 0.7523457635874601, 'f1-score': 0.5399046181805727, 'support': 178087}, '2': {'precision': 0.4757821167073441, 'recall': 0.24166727712255512, 'f1-score': 0.32052704939780197, 'support': 177463}, 'accuracy': 0.4364451996091647, 'macro avg': {'precision': 0.4480547948219107, 'recall': 0.4361217237938133, 'f1-score': 0.40989188650417524, 'support': 533217}, 'weighted avg': {'precision': 0.44802289256190453, 'recall': 0.4364451996091647, 'f1-score': 0.41002848337575615, 'support': 533217}}
[[ 55850  94043  27774]
 [ 24625 133983  19479]
 [ 44368  90208  42887]]
Evaluating performance on  val set...
685/685 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0658097
{'0': {'precision': 0.4438453092594852, 'recall': 0.3170876257212083, 'f1-score': 0.36990869715517416, 'support': 57369}, '1': {'precision': 0.4305766056241493, 'recall': 0.7442764650914431, 'f1-score': 0.5455457230746651, 'support': 59928}, '2': {'precision': 0.46658387529004214, 'recall': 0.24668256272029856, 'f1-score': 0.3227352359423566, 'support': 57876}, 'accuracy': 0.43997077175135435, 'macro avg': {'precision': 0.44700193005789224, 'recall': 0.43601555117765, 'f1-score': 0.41272988539073197, 'support': 175173}, 'weighted avg': {'precision': 0.44681865775569235, 'recall': 0.43997077175135435, 'f1-score': 0.4144096444938064, 'support': 175173}}
[[18191 29859  9319]
 [ 8322 44603  7003]
 [14472 29127 14277]]
training model: results/ATVI/W7/deepVOL_L2/h100
Epoch 1/50
2083/2083 - 50s - loss: 3.2571 - accuracy100: 0.3904 - val_loss: 3.2659 - val_accuracy100: 0.3744 - 50s/epoch - 24ms/step
Epoch 2/50
2083/2083 - 48s - loss: 3.2231 - accuracy100: 0.4057 - val_loss: 3.2922 - val_accuracy100: 0.3722 - 48s/epoch - 23ms/step
Epoch 3/50
2083/2083 - 48s - loss: 3.2158 - accuracy100: 0.4101 - val_loss: 3.2811 - val_accuracy100: 0.3806 - 48s/epoch - 23ms/step
Epoch 4/50
2083/2083 - 48s - loss: 3.2095 - accuracy100: 0.4132 - val_loss: 3.2902 - val_accuracy100: 0.3783 - 48s/epoch - 23ms/step
Epoch 5/50
2083/2083 - 46s - loss: 3.2090 - accuracy100: 0.4137 - val_loss: 3.2823 - val_accuracy100: 0.3868 - 46s/epoch - 22ms/step
Epoch 6/50
2083/2083 - 48s - loss: 3.2053 - accuracy100: 0.4160 - val_loss: 3.2921 - val_accuracy100: 0.3835 - 48s/epoch - 23ms/step
Epoch 7/50
2083/2083 - 48s - loss: 3.2021 - accuracy100: 0.4165 - val_loss: 3.3009 - val_accuracy100: 0.3823 - 48s/epoch - 23ms/step
Epoch 8/50
2083/2083 - 50s - loss: 3.1991 - accuracy100: 0.4181 - val_loss: 3.3036 - val_accuracy100: 0.3831 - 50s/epoch - 24ms/step
Epoch 9/50
2083/2083 - 45s - loss: 3.1951 - accuracy100: 0.4195 - val_loss: 3.2970 - val_accuracy100: 0.3854 - 45s/epoch - 22ms/step
Epoch 10/50
2083/2083 - 46s - loss: 3.1915 - accuracy100: 0.4212 - val_loss: 3.3009 - val_accuracy100: 0.3836 - 46s/epoch - 22ms/step
Epoch 11/50
2083/2083 - 44s - loss: 3.1886 - accuracy100: 0.4233 - val_loss: 3.2984 - val_accuracy100: 0.3859 - 44s/epoch - 21ms/step
testing model: results/ATVI/W7/deepVOL_L2/h100
Evaluating performance on  test set...
6143/6143 - 62s - 62s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0724608
{'0': {'precision': 0.38600875905620735, 'recall': 0.2881826998387968, 'f1-score': 0.3299983851132284, 'support': 460909}, '1': {'precision': 0.42626303273760147, 'recall': 0.56733625767169, 'f1-score': 0.4867847151491372, 'support': 638549}, '2': {'precision': 0.37848526637817614, 'recall': 0.3028576622893431, 'f1-score': 0.33647421339038897, 'support': 473044}, 'accuracy': 0.40595369672025855, 'macro avg': {'precision': 0.3969190193906617, 'recall': 0.38612553993327664, 'f1-score': 0.38441910455091816, 'support': 1572502}, 'weighted avg': {'precision': 0.4000916556977339, 'recall': 0.40595369672025855, 'f1-score': 0.3956129954409994, 'support': 1572502}}
[[132826 244163  83920]
 [124940 362272 151337]
 [ 86335 243444 143265]]
Evaluating performance on  train set...
2083/2083 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0929123
{'0': {'precision': 0.40390211084013117, 'recall': 0.2679879698912492, 'f1-score': 0.3221982577894656, 'support': 179217}, '1': {'precision': 0.3386189593256088, 'recall': 0.5618502464631677, 'f1-score': 0.42256446868172515, 'support': 174874}, '2': {'precision': 0.4009778572521728, 'recall': 0.2779105210857162, 'f1-score': 0.3282895062237243, 'support': 179126}, 'accuracy': 0.36769645378898275, 'macro avg': {'precision': 0.38116630913930427, 'recall': 0.369249579146711, 'f1-score': 0.35768407756497167, 'support': 533217}, 'weighted avg': {'precision': 0.38150947203426555, 'recall': 0.36769645378898275, 'f1-score': 0.3571606497060924, 'support': 533217}}
[[48028 97491 33698]
 [35951 98253 40670]
 [34931 94414 49781]]
Evaluating performance on  val set...
685/685 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0893394
{'0': {'precision': 0.3880778260517581, 'recall': 0.25417108518911274, 'f1-score': 0.30716490276279673, 'support': 56580}, '1': {'precision': 0.3584748347737672, 'recall': 0.5832451032292219, 'f1-score': 0.4440358190909206, 'support': 60448}, '2': {'precision': 0.39951214605441837, 'recall': 0.2732307163126666, 'f1-score': 0.3245192062178917, 'support': 58145}, 'accuracy': 0.37405307895623185, 'macro avg': {'precision': 0.38202160229331455, 'recall': 0.37021563491033377, 'f1-score': 0.358573309357203, 'support': 175173}, 'weighted avg': {'precision': 0.3816579264084494, 'recall': 0.37405307895623185, 'f1-score': 0.36015616925134764, 'support': 175173}}
[[14381 31619 10580]
 [11893 35256 13299]
 [10783 31475 15887]]
training model: results/ATVI/W7/deepVOL_L2/h200
Epoch 1/50
2083/2083 - 47s - loss: 3.2955 - accuracy200: 0.3624 - val_loss: 3.2970 - val_accuracy200: 0.3562 - 47s/epoch - 23ms/step
Epoch 2/50
2083/2083 - 50s - loss: 3.2757 - accuracy200: 0.3705 - val_loss: 3.2905 - val_accuracy200: 0.3632 - 50s/epoch - 24ms/step
Epoch 3/50
2083/2083 - 49s - loss: 3.2678 - accuracy200: 0.3794 - val_loss: 3.2894 - val_accuracy200: 0.3662 - 49s/epoch - 24ms/step
Epoch 4/50
2083/2083 - 47s - loss: 3.2629 - accuracy200: 0.3840 - val_loss: 3.2890 - val_accuracy200: 0.3719 - 47s/epoch - 23ms/step
Epoch 5/50
2083/2083 - 47s - loss: 3.2589 - accuracy200: 0.3868 - val_loss: 3.2836 - val_accuracy200: 0.3724 - 47s/epoch - 23ms/step
Epoch 6/50
2083/2083 - 45s - loss: 3.2555 - accuracy200: 0.3887 - val_loss: 3.2965 - val_accuracy200: 0.3667 - 45s/epoch - 22ms/step
Epoch 7/50
2083/2083 - 45s - loss: 3.2527 - accuracy200: 0.3913 - val_loss: 3.2893 - val_accuracy200: 0.3704 - 45s/epoch - 21ms/step
Epoch 8/50
2083/2083 - 50s - loss: 3.2498 - accuracy200: 0.3929 - val_loss: 3.2955 - val_accuracy200: 0.3671 - 50s/epoch - 24ms/step
Epoch 9/50
2083/2083 - 49s - loss: 3.2476 - accuracy200: 0.3941 - val_loss: 3.3013 - val_accuracy200: 0.3693 - 49s/epoch - 24ms/step
Epoch 10/50
2083/2083 - 49s - loss: 3.2454 - accuracy200: 0.3957 - val_loss: 3.3019 - val_accuracy200: 0.3698 - 49s/epoch - 24ms/step
Epoch 11/50
2083/2083 - 46s - loss: 3.2427 - accuracy200: 0.3979 - val_loss: 3.3066 - val_accuracy200: 0.3673 - 46s/epoch - 22ms/step
Epoch 12/50
2083/2083 - 46s - loss: 3.2408 - accuracy200: 0.3987 - val_loss: 3.3059 - val_accuracy200: 0.3677 - 46s/epoch - 22ms/step
Epoch 13/50
2083/2083 - 50s - loss: 3.2382 - accuracy200: 0.4001 - val_loss: 3.3101 - val_accuracy200: 0.3670 - 50s/epoch - 24ms/step
Epoch 14/50
2083/2083 - 47s - loss: 3.2362 - accuracy200: 0.4017 - val_loss: 3.3101 - val_accuracy200: 0.3659 - 47s/epoch - 22ms/step
Epoch 15/50
2083/2083 - 47s - loss: 3.2342 - accuracy200: 0.4030 - val_loss: 3.3070 - val_accuracy200: 0.3692 - 47s/epoch - 22ms/step
testing model: results/ATVI/W7/deepVOL_L2/h200
Evaluating performance on  test set...
6143/6143 - 67s - 67s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0864971
{'0': {'precision': 0.38435463630728295, 'recall': 0.26213780445049395, 'f1-score': 0.31169391671111274, 'support': 484890}, '1': {'precision': 0.392304620299828, 'recall': 0.4386331591321656, 'f1-score': 0.4141773769436406, 'support': 582277}, '2': {'precision': 0.3804288396074867, 'recall': 0.4447366598395124, 'f1-score': 0.41007689135583514, 'support': 505335}, 'accuracy': 0.38617120995712567, 'macro avg': {'precision': 0.3856960320715325, 'recall': 0.3818358744740573, 'f1-score': 0.3786493950035295, 'support': 1572502}, 'weighted avg': {'precision': 0.3860368283515128, 'recall': 0.38617120995712567, 'f1-score': 0.3812582939048501, 'support': 1572502}}
[[127108 200208 157574]
 [118429 255406 208442]
 [ 85168 195426 224741]]
Evaluating performance on  train set...
2083/2083 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0967847
{'0': {'precision': 0.39997863133714406, 'recall': 0.21066611143312156, 'f1-score': 0.27597696997397697, 'support': 177703}, '1': {'precision': 0.3438075265058837, 'recall': 0.5051671108118442, 'f1-score': 0.4091529881012079, 'support': 175243}, '2': {'precision': 0.385039421957701, 'recall': 0.3890143173333481, 'f1-score': 0.3870166637693397, 'support': 180271}, 'accuracy': 0.3677508406521172, 'macro avg': {'precision': 0.37627519326690956, 'recall': 0.36828251319277133, 'f1-score': 0.3573822072815082, 'support': 533217}, 'weighted avg': {'precision': 0.3764671920207192, 'recall': 0.3677508406521172, 'f1-score': 0.3572860834959655, 'support': 533217}}
[[37436 85467 54800]
 [29512 88527 57204]
 [26647 83496 70128]]
Evaluating performance on  val set...
685/685 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0946605
{'0': {'precision': 0.386041439476554, 'recall': 0.1935347336119782, 'f1-score': 0.25781745565605546, 'support': 56703}, '1': {'precision': 0.3589975189508707, 'recall': 0.5272712006717044, 'f1-score': 0.427159502901104, 'support': 59550}, '2': {'precision': 0.38439350235311975, 'recall': 0.38676171079429733, 'f1-score': 0.3855739702038019, 'support': 58920}, 'accuracy': 0.37198084179639557, 'macro avg': {'precision': 0.3764774869268481, 'recall': 0.3691892150259933, 'f1-score': 0.3568503095869871, 'support': 175173}, 'weighted avg': {'precision': 0.3762935792320118, 'recall': 0.37198084179639557, 'f1-score': 0.3583565384518965, 'support': 175173}}
[[10974 28042 17687]
 [ 9343 31399 18808]
 [ 8110 28022 22788]]
training model: results/ATVI/W7/deepVOL_L2/h300
Epoch 1/50
2083/2083 - 49s - loss: 3.2899 - accuracy300: 0.3699 - val_loss: 3.3195 - val_accuracy300: 0.3297 - 49s/epoch - 24ms/step
Epoch 2/50
2083/2083 - 45s - loss: 3.2824 - accuracy300: 0.3676 - val_loss: 3.3149 - val_accuracy300: 0.3307 - 45s/epoch - 21ms/step
Epoch 3/50
2083/2083 - 45s - loss: 3.2750 - accuracy300: 0.3767 - val_loss: 3.3330 - val_accuracy300: 0.3317 - 45s/epoch - 22ms/step
Epoch 4/50
2083/2083 - 46s - loss: 3.2721 - accuracy300: 0.3776 - val_loss: 3.3220 - val_accuracy300: 0.3347 - 46s/epoch - 22ms/step
Epoch 5/50
2083/2083 - 47s - loss: 3.2632 - accuracy300: 0.3823 - val_loss: 3.3284 - val_accuracy300: 0.3346 - 47s/epoch - 23ms/step
Epoch 6/50
2083/2083 - 51s - loss: 3.2579 - accuracy300: 0.3848 - val_loss: 3.3332 - val_accuracy300: 0.3339 - 51s/epoch - 24ms/step
Epoch 7/50
2083/2083 - 51s - loss: 3.2531 - accuracy300: 0.3876 - val_loss: 3.3312 - val_accuracy300: 0.3359 - 51s/epoch - 24ms/step
Epoch 8/50
2083/2083 - 49s - loss: 3.2489 - accuracy300: 0.3896 - val_loss: 3.3354 - val_accuracy300: 0.3378 - 49s/epoch - 24ms/step
Epoch 9/50
2083/2083 - 50s - loss: 3.2463 - accuracy300: 0.3906 - val_loss: 3.3377 - val_accuracy300: 0.3399 - 50s/epoch - 24ms/step
Epoch 10/50
2083/2083 - 47s - loss: 3.2457 - accuracy300: 0.3912 - val_loss: 3.3392 - val_accuracy300: 0.3368 - 47s/epoch - 23ms/step
Epoch 11/50
2083/2083 - 49s - loss: 3.2410 - accuracy300: 0.3943 - val_loss: 3.3471 - val_accuracy300: 0.3385 - 49s/epoch - 23ms/step
Epoch 12/50
2083/2083 - 48s - loss: 3.2436 - accuracy300: 0.3946 - val_loss: 3.3395 - val_accuracy300: 0.3366 - 48s/epoch - 23ms/step
testing model: results/ATVI/W7/deepVOL_L2/h300
Evaluating performance on  test set...
6143/6143 - 64s - 64s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1138898
{'0': {'precision': 0.2580312217778351, 'recall': 0.009180944948758851, 'f1-score': 0.01773100732068965, 'support': 435685}, '1': {'precision': 0.49588843675822314, 'recall': 0.017104426331371762, 'f1-score': 0.033068246540610295, 'support': 683975}, '2': {'precision': 0.2889107139130616, 'recall': 0.9783058991877962, 'f1-score': 0.44608483322844555, 'support': 452842}, 'accuracy': 0.2917115526721111, 'macro avg': {'precision': 0.34761012414970666, 'recall': 0.33486375682264224, 'f1-score': 0.16562802902991516, 'support': 1572502}, 'weighted avg': {'precision': 0.37038206113683825, 'recall': 0.2917115526721111, 'f1-score': 0.1477574819624804, 'support': 1572502}}
[[  4000   6153 425532]
 [  7418  11699 664858]
 [  4084   5740 443018]]
Evaluating performance on  train set...
2083/2083 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1022131
{'0': {'precision': 0.32232117207698935, 'recall': 0.012657799438183234, 'f1-score': 0.0243590021927444, 'support': 177282}, '1': {'precision': 0.3535161553081727, 'recall': 0.014758223572351568, 'f1-score': 0.028333605353354007, 'support': 176444}, '2': {'precision': 0.33722819331302073, 'recall': 0.9748901059106028, 'f1-score': 0.5011140067012229, 'support': 179491}, 'accuracy': 0.3372585645243869, 'macro avg': {'precision': 0.3376885068993943, 'recall': 0.3341020429737125, 'f1-score': 0.18460220474910707, 'support': 533217}, 'weighted avg': {'precision': 0.3376617253037609, 'recall': 0.3372585645243869, 'f1-score': 0.18615903368893058, 'support': 533217}}
[[  2244   2569 172469]
 [  2404   2604 171436]
 [  2314   2193 174984]]
Evaluating performance on  val set...
685/685 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1041616
{'0': {'precision': 0.31039814456899883, 'recall': 0.014581706586282663, 'f1-score': 0.02785486332732066, 'support': 55069}, '1': {'precision': 0.4050739957716702, 'recall': 0.015350842052974826, 'f1-score': 0.029580683011177666, 'support': 62407}, '2': {'precision': 0.33018840213604667, 'recall': 0.9741407698840494, 'f1-score': 0.49320369606612907, 'support': 57697}, 'accuracy': 0.33090716035005396, 'macro avg': {'precision': 0.3485535141589052, 'recall': 0.3346911061744356, 'f1-score': 0.1835464141348758, 'support': 175173}, 'weighted avg': {'precision': 0.35064563897082485, 'recall': 0.33090716035005396, 'f1-score': 0.1817423621515772, 'support': 175173}}
[[  803   717 53549]
 [  982   958 60467]
 [  802   690 56205]]
training model: results/ATVI/W7/deepVOL_L2/h500
Epoch 1/50
2083/2083 - 49s - loss: 3.2515 - accuracy500: 0.4003 - val_loss: 3.3580 - val_accuracy500: 0.3467 - 49s/epoch - 23ms/step
Epoch 2/50
2083/2083 - 50s - loss: 3.2408 - accuracy500: 0.3990 - val_loss: 3.3611 - val_accuracy500: 0.3466 - 50s/epoch - 24ms/step
Epoch 3/50
2083/2083 - 53s - loss: 3.2531 - accuracy500: 0.3923 - val_loss: 3.3828 - val_accuracy500: 0.3463 - 53s/epoch - 25ms/step
Epoch 4/50
2083/2083 - 47s - loss: 3.2388 - accuracy500: 0.3968 - val_loss: 3.3890 - val_accuracy500: 0.3454 - 47s/epoch - 23ms/step
Epoch 5/50
2083/2083 - 46s - loss: 3.2373 - accuracy500: 0.3957 - val_loss: 3.3675 - val_accuracy500: 0.3451 - 46s/epoch - 22ms/step
Epoch 6/50
2083/2083 - 52s - loss: 3.2316 - accuracy500: 0.3984 - val_loss: 3.3652 - val_accuracy500: 0.3453 - 52s/epoch - 25ms/step
Epoch 7/50
2083/2083 - 47s - loss: 3.2332 - accuracy500: 0.3995 - val_loss: 3.3563 - val_accuracy500: 0.3465 - 47s/epoch - 22ms/step
Epoch 8/50
2083/2083 - 48s - loss: 3.2309 - accuracy500: 0.4001 - val_loss: 3.3529 - val_accuracy500: 0.3472 - 48s/epoch - 23ms/step
Epoch 9/50
2083/2083 - 47s - loss: 3.2296 - accuracy500: 0.4006 - val_loss: 3.3526 - val_accuracy500: 0.3477 - 47s/epoch - 22ms/step
Epoch 10/50
2083/2083 - 51s - loss: 3.2289 - accuracy500: 0.4011 - val_loss: 3.3501 - val_accuracy500: 0.3481 - 51s/epoch - 24ms/step
Epoch 11/50
2083/2083 - 50s - loss: 3.2321 - accuracy500: 0.3990 - val_loss: 3.3538 - val_accuracy500: 0.3483 - 50s/epoch - 24ms/step
Epoch 12/50
2083/2083 - 48s - loss: 3.2284 - accuracy500: 0.4008 - val_loss: 3.3556 - val_accuracy500: 0.3492 - 48s/epoch - 23ms/step
Epoch 13/50
2083/2083 - 50s - loss: 3.2266 - accuracy500: 0.4023 - val_loss: 3.3554 - val_accuracy500: 0.3487 - 50s/epoch - 24ms/step
Epoch 14/50
2083/2083 - 46s - loss: 3.2257 - accuracy500: 0.4020 - val_loss: 3.3481 - val_accuracy500: 0.3490 - 46s/epoch - 22ms/step
Epoch 15/50
2083/2083 - 47s - loss: 3.2221 - accuracy500: 0.4036 - val_loss: 3.3564 - val_accuracy500: 0.3487 - 47s/epoch - 23ms/step
Epoch 16/50
2083/2083 - 47s - loss: 3.2189 - accuracy500: 0.4066 - val_loss: 3.3530 - val_accuracy500: 0.3484 - 47s/epoch - 23ms/step
Epoch 17/50
2083/2083 - 50s - loss: 3.2177 - accuracy500: 0.4071 - val_loss: 3.3516 - val_accuracy500: 0.3485 - 50s/epoch - 24ms/step
Epoch 18/50
2083/2083 - 49s - loss: 3.2160 - accuracy500: 0.4086 - val_loss: 3.3525 - val_accuracy500: 0.3477 - 49s/epoch - 23ms/step
Epoch 19/50
2083/2083 - 48s - loss: 3.2125 - accuracy500: 0.4093 - val_loss: 3.3530 - val_accuracy500: 0.3482 - 48s/epoch - 23ms/step
Epoch 20/50
2083/2083 - 48s - loss: 3.2096 - accuracy500: 0.4130 - val_loss: 3.3542 - val_accuracy500: 0.3492 - 48s/epoch - 23ms/step
Epoch 21/50
2083/2083 - 50s - loss: 3.2109 - accuracy500: 0.4118 - val_loss: 3.3596 - val_accuracy500: 0.3488 - 50s/epoch - 24ms/step
Epoch 22/50
2083/2083 - 50s - loss: 3.2090 - accuracy500: 0.4135 - val_loss: 3.3618 - val_accuracy500: 0.3503 - 50s/epoch - 24ms/step
Epoch 23/50
2083/2083 - 47s - loss: 3.2054 - accuracy500: 0.4147 - val_loss: 3.3653 - val_accuracy500: 0.3494 - 47s/epoch - 23ms/step
Epoch 24/50
2083/2083 - 46s - loss: 3.2016 - accuracy500: 0.4173 - val_loss: 3.3647 - val_accuracy500: 0.3497 - 46s/epoch - 22ms/step
testing model: results/ATVI/W7/deepVOL_L2/h500
Evaluating performance on  test set...
6143/6143 - 62s - 62s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1352813
{'0': {'precision': 0.2530293694803861, 'recall': 0.019696827814917425, 'f1-score': 0.036548567553822686, 'support': 437837}, '1': {'precision': 0.5182088455598718, 'recall': 0.11222345980222292, 'f1-score': 0.1844930504170234, 'support': 678744}, '2': {'precision': 0.2971561630840215, 'recall': 0.9068939575057959, 'f1-score': 0.4476377255865291, 'support': 455921}, 'accuracy': 0.31686255406988356, 'macro avg': {'precision': 0.3561314593747598, 'recall': 0.34627141504097875, 'f1-score': 0.22289311451912508, 'support': 1572502}, 'weighted avg': {'precision': 0.3802834589369702, 'recall': 0.31686255406988356, 'f1-score': 0.2195948276513805, 'support': 1572502}}
[[  8624  36316 392897]
 [ 17512  76171 585061]
 [  7947  34502 413472]]
Evaluating performance on  train set...
2083/2083 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1182947
{'0': {'precision': 0.3499341816586222, 'recall': 0.009003974167908595, 'f1-score': 0.017556218423572665, 'support': 177144}, '1': {'precision': 0.44435160427807485, 'recall': 0.044641308180042645, 'f1-score': 0.08113179721627518, 'support': 178691}, '2': {'precision': 0.33696228953196256, 'recall': 0.9701604446899911, 'f1-score': 0.5001940155997262, 'support': 177382}, 'accuracy': 0.34068868772000893, 'macro avg': {'precision': 0.3770826918228865, 'recall': 0.3412685756793141, 'f1-score': 0.1996273437465247, 'support': 533217}, 'weighted avg': {'precision': 0.37725994864669926, 'recall': 0.34068868772000893, 'f1-score': 0.19941771475386086, 'support': 533217}}
[[  1595   5898 169651]
 [  1747   7977 168967]
 [  1216   4077 172089]]
Evaluating performance on  val set...
685/685 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1165646
{'0': {'precision': 0.31310861423220976, 'recall': 0.007290740062442224, 'f1-score': 0.014249676143724004, 'support': 57333}, '1': {'precision': 0.38990927196282366, 'recall': 0.030837621197801812, 'f1-score': 0.05715490536354347, 'support': 57138}, '2': {'precision': 0.34810033132725804, 'recall': 0.9709729498204343, 'f1-score': 0.512474947939536, 'support': 60702}, 'accuracy': 0.3489122182071438, 'macro avg': {'precision': 0.35037273917409717, 'recall': 0.33636710369355943, 'f1-score': 0.19462650981560115, 'support': 175173}, 'weighted avg': {'precision': 0.35028502379598636, 'recall': 0.3489122182071438, 'f1-score': 0.2008925345506213, 'support': 175173}}
[[  418  1402 55513]
 [  510  1762 54866]
 [  407  1355 58940]]
training model: results/ATVI/W7/deepVOL_L2/h1000
Epoch 1/50
2083/2083 - 49s - loss: 3.2857 - accuracy1000: 0.3747 - val_loss: 3.3124 - val_accuracy1000: 0.3364 - 49s/epoch - 24ms/step
Epoch 2/50
2083/2083 - 47s - loss: 3.2800 - accuracy1000: 0.3669 - val_loss: 3.3008 - val_accuracy1000: 0.3527 - 47s/epoch - 22ms/step
Epoch 3/50
2083/2083 - 45s - loss: 3.2669 - accuracy1000: 0.3758 - val_loss: 3.2970 - val_accuracy1000: 0.3500 - 45s/epoch - 22ms/step
Epoch 4/50
2083/2083 - 46s - loss: 3.2606 - accuracy1000: 0.3830 - val_loss: 3.2920 - val_accuracy1000: 0.3629 - 46s/epoch - 22ms/step
Epoch 5/50
2083/2083 - 47s - loss: 3.2576 - accuracy1000: 0.3856 - val_loss: 3.2909 - val_accuracy1000: 0.3653 - 47s/epoch - 22ms/step
Epoch 6/50
2083/2083 - 50s - loss: 3.2523 - accuracy1000: 0.3879 - val_loss: 3.2963 - val_accuracy1000: 0.3614 - 50s/epoch - 24ms/step
Epoch 7/50
2083/2083 - 51s - loss: 3.2469 - accuracy1000: 0.3920 - val_loss: 3.2953 - val_accuracy1000: 0.3594 - 51s/epoch - 25ms/step
Epoch 8/50
2083/2083 - 51s - loss: 3.2468 - accuracy1000: 0.3922 - val_loss: 3.2946 - val_accuracy1000: 0.3611 - 51s/epoch - 25ms/step
Epoch 9/50
2083/2083 - 50s - loss: 3.2427 - accuracy1000: 0.3931 - val_loss: 3.2887 - val_accuracy1000: 0.3671 - 50s/epoch - 24ms/step
Epoch 10/50
2083/2083 - 46s - loss: 3.2395 - accuracy1000: 0.3949 - val_loss: 3.2894 - val_accuracy1000: 0.3628 - 46s/epoch - 22ms/step
Epoch 11/50
2083/2083 - 44s - loss: 3.2360 - accuracy1000: 0.3966 - val_loss: 3.2846 - val_accuracy1000: 0.3661 - 44s/epoch - 21ms/step
Epoch 12/50
2083/2083 - 47s - loss: 3.2336 - accuracy1000: 0.3969 - val_loss: 3.2887 - val_accuracy1000: 0.3648 - 47s/epoch - 22ms/step
Epoch 13/50
2083/2083 - 45s - loss: 3.2323 - accuracy1000: 0.3979 - val_loss: 3.3013 - val_accuracy1000: 0.3559 - 45s/epoch - 22ms/step
Epoch 14/50
2083/2083 - 46s - loss: 3.2303 - accuracy1000: 0.3991 - val_loss: 3.3107 - val_accuracy1000: 0.3527 - 46s/epoch - 22ms/step
Epoch 15/50
2083/2083 - 50s - loss: 3.2283 - accuracy1000: 0.4009 - val_loss: 3.3167 - val_accuracy1000: 0.3521 - 50s/epoch - 24ms/step
Epoch 16/50
2083/2083 - 45s - loss: 3.2261 - accuracy1000: 0.4022 - val_loss: 3.3104 - val_accuracy1000: 0.3483 - 45s/epoch - 22ms/step
Epoch 17/50
2083/2083 - 49s - loss: 3.2207 - accuracy1000: 0.4064 - val_loss: 3.3156 - val_accuracy1000: 0.3475 - 49s/epoch - 23ms/step
Epoch 18/50
2083/2083 - 47s - loss: 3.2217 - accuracy1000: 0.4058 - val_loss: 3.3134 - val_accuracy1000: 0.3473 - 47s/epoch - 22ms/step
Epoch 19/50
2083/2083 - 48s - loss: 3.2207 - accuracy1000: 0.4072 - val_loss: 3.3028 - val_accuracy1000: 0.3546 - 48s/epoch - 23ms/step
Epoch 20/50
2083/2083 - 46s - loss: 3.2150 - accuracy1000: 0.4098 - val_loss: 3.3217 - val_accuracy1000: 0.3529 - 46s/epoch - 22ms/step
Epoch 21/50
2083/2083 - 46s - loss: 3.2098 - accuracy1000: 0.4119 - val_loss: 3.3322 - val_accuracy1000: 0.3507 - 46s/epoch - 22ms/step
testing model: results/ATVI/W7/deepVOL_L2/h1000
Evaluating performance on  test set...
6143/6143 - 56s - 56s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0940015
{'0': {'precision': 0.295202634970643, 'recall': 0.021414428508802, 'f1-score': 0.03993212275243788, 'support': 481311}, '1': {'precision': 0.4016536154702084, 'recall': 0.6580414019546648, 'f1-score': 0.49883165227378934, 'support': 584755}, '2': {'precision': 0.3306497114214972, 'recall': 0.3783952957530665, 'f1-score': 0.3529149604834618, 'support': 506436}, 'accuracy': 0.3731206701167948, 'macro avg': {'precision': 0.3425019872874495, 'recall': 0.35261704207217776, 'f1-score': 0.2972262451698963, 'support': 1572502}, 'weighted avg': {'precision': 0.34620379027059694, 'recall': 0.3731206701167948, 'f1-score': 0.3113782454247186, 'support': 1572502}}
[[ 10307 269264 201740]
 [ 13770 384793 186192]
 [ 10838 303965 191633]]
Evaluating performance on  train set...
2083/2083 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0968748
{'0': {'precision': 0.3724676187313185, 'recall': 0.012590372266379272, 'f1-score': 0.024357401153257248, 'support': 178152}, '1': {'precision': 0.37853822314049584, 'recall': 0.49732230208504163, 'f1-score': 0.42987552272877244, 'support': 176831}, '2': {'precision': 0.3578465451462484, 'recall': 0.5920307012130122, 'f1-score': 0.44607056724771665, 'support': 178234}, 'accuracy': 0.36702693274970605, 'macro avg': {'precision': 0.3696174623393543, 'recall': 0.36731445852147776, 'f1-score': 0.3001011637099154, 'support': 533217}, 'weighted avg': {'precision': 0.3695935517359261, 'recall': 0.36702693274970605, 'f1-score': 0.29980210640834065, 'support': 533217}}
[[  2243  73270 102639]
 [  2173  87942  86716]
 [  1606  71108 105520]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0947458
{'0': {'precision': 0.2915173237753883, 'recall': 0.008899912459877445, 'f1-score': 0.01727250203518211, 'support': 54832}, '1': {'precision': 0.39616342464831394, 'recall': 0.4791045991045991, 'f1-score': 0.433704222238597, 'support': 61425}, '2': {'precision': 0.3471284294555204, 'recall': 0.5845610699979632, 'f1-score': 0.43559096945551123, 'support': 58916}, 'accuracy': 0.3673910933762623, 'macro avg': {'precision': 0.3449363926264075, 'recall': 0.35752186052081325, 'f1-score': 0.2955225645764301, 'support': 175173}, 'weighted avg': {'precision': 0.3469155338212865, 'recall': 0.3673910933762623, 'f1-score': 0.30398888663800827, 'support': 175173}}
[[  488 20948 33396]
 [  618 29429 31378]
 [  568 23908 34440]]
training model: results/ATVI/W7/deepVOL_L3/h10
Epoch 1/50
2083/2083 - 74s - loss: 3.2298 - accuracy10: 0.4060 - val_loss: 3.3249 - val_accuracy10: 0.5368 - 74s/epoch - 35ms/step
Epoch 2/50
2083/2083 - 69s - loss: 3.0556 - accuracy10: 0.4778 - val_loss: 3.0996 - val_accuracy10: 0.5350 - 69s/epoch - 33ms/step
Epoch 3/50
2083/2083 - 70s - loss: 2.8459 - accuracy10: 0.5237 - val_loss: 2.9893 - val_accuracy10: 0.5761 - 70s/epoch - 34ms/step
Epoch 4/50
2083/2083 - 70s - loss: 2.7695 - accuracy10: 0.5475 - val_loss: 2.9441 - val_accuracy10: 0.5874 - 70s/epoch - 34ms/step
Epoch 5/50
2083/2083 - 71s - loss: 2.7311 - accuracy10: 0.5581 - val_loss: 2.8704 - val_accuracy10: 0.5913 - 71s/epoch - 34ms/step
Epoch 6/50
2083/2083 - 72s - loss: 2.7062 - accuracy10: 0.5630 - val_loss: 2.8160 - val_accuracy10: 0.5850 - 72s/epoch - 35ms/step
Epoch 7/50
2083/2083 - 71s - loss: 2.6882 - accuracy10: 0.5672 - val_loss: 2.7622 - val_accuracy10: 0.5909 - 71s/epoch - 34ms/step
Epoch 8/50
2083/2083 - 71s - loss: 2.6722 - accuracy10: 0.5699 - val_loss: 2.7574 - val_accuracy10: 0.5976 - 71s/epoch - 34ms/step
Epoch 9/50
2083/2083 - 70s - loss: 2.6590 - accuracy10: 0.5726 - val_loss: 2.7264 - val_accuracy10: 0.5916 - 70s/epoch - 34ms/step
Epoch 10/50
2083/2083 - 70s - loss: 2.6502 - accuracy10: 0.5745 - val_loss: 2.7134 - val_accuracy10: 0.5970 - 70s/epoch - 34ms/step
Epoch 11/50
2083/2083 - 70s - loss: 2.6417 - accuracy10: 0.5760 - val_loss: 2.6981 - val_accuracy10: 0.5941 - 70s/epoch - 33ms/step
Epoch 12/50
2083/2083 - 72s - loss: 2.6341 - accuracy10: 0.5778 - val_loss: 2.7090 - val_accuracy10: 0.5937 - 72s/epoch - 35ms/step
Epoch 13/50
2083/2083 - 71s - loss: 2.6284 - accuracy10: 0.5786 - val_loss: 2.6842 - val_accuracy10: 0.5964 - 71s/epoch - 34ms/step
Epoch 14/50
2083/2083 - 71s - loss: 2.6221 - accuracy10: 0.5791 - val_loss: 2.6851 - val_accuracy10: 0.5971 - 71s/epoch - 34ms/step
Epoch 15/50
2083/2083 - 70s - loss: 2.6169 - accuracy10: 0.5803 - val_loss: 2.6734 - val_accuracy10: 0.5940 - 70s/epoch - 34ms/step
Epoch 16/50
2083/2083 - 72s - loss: 2.6116 - accuracy10: 0.5819 - val_loss: 2.6765 - val_accuracy10: 0.5937 - 72s/epoch - 34ms/step
Epoch 17/50
2083/2083 - 72s - loss: 2.6077 - accuracy10: 0.5822 - val_loss: 2.6679 - val_accuracy10: 0.5952 - 72s/epoch - 35ms/step
Epoch 18/50
2083/2083 - 70s - loss: 2.6029 - accuracy10: 0.5833 - val_loss: 2.6647 - val_accuracy10: 0.5956 - 70s/epoch - 34ms/step
Epoch 19/50
2083/2083 - 72s - loss: 2.5986 - accuracy10: 0.5843 - val_loss: 2.6631 - val_accuracy10: 0.5929 - 72s/epoch - 34ms/step
Epoch 20/50
2083/2083 - 70s - loss: 2.5954 - accuracy10: 0.5848 - val_loss: 2.6599 - val_accuracy10: 0.5924 - 70s/epoch - 34ms/step
Epoch 21/50
2083/2083 - 71s - loss: 2.5906 - accuracy10: 0.5852 - val_loss: 2.6635 - val_accuracy10: 0.5917 - 71s/epoch - 34ms/step
Epoch 22/50
2083/2083 - 70s - loss: 2.5879 - accuracy10: 0.5860 - val_loss: 2.6581 - val_accuracy10: 0.5935 - 70s/epoch - 34ms/step
Epoch 23/50
2083/2083 - 70s - loss: 2.5849 - accuracy10: 0.5864 - val_loss: 2.6498 - val_accuracy10: 0.5896 - 70s/epoch - 34ms/step
Epoch 24/50
2083/2083 - 70s - loss: 2.5809 - accuracy10: 0.5871 - val_loss: 2.6554 - val_accuracy10: 0.5909 - 70s/epoch - 33ms/step
Epoch 25/50
2083/2083 - 70s - loss: 2.5781 - accuracy10: 0.5877 - val_loss: 2.6479 - val_accuracy10: 0.5931 - 70s/epoch - 34ms/step
Epoch 26/50
2083/2083 - 71s - loss: 2.5745 - accuracy10: 0.5883 - val_loss: 2.6582 - val_accuracy10: 0.5888 - 71s/epoch - 34ms/step
Epoch 27/50
2083/2083 - 70s - loss: 2.5723 - accuracy10: 0.5889 - val_loss: 2.6478 - val_accuracy10: 0.5849 - 70s/epoch - 34ms/step
Epoch 28/50
2083/2083 - 70s - loss: 2.5686 - accuracy10: 0.5890 - val_loss: 2.6498 - val_accuracy10: 0.5849 - 70s/epoch - 34ms/step
Epoch 29/50
2083/2083 - 70s - loss: 2.5662 - accuracy10: 0.5894 - val_loss: 2.6458 - val_accuracy10: 0.5902 - 70s/epoch - 34ms/step
Epoch 30/50
2083/2083 - 70s - loss: 2.5638 - accuracy10: 0.5902 - val_loss: 2.6411 - val_accuracy10: 0.5851 - 70s/epoch - 34ms/step
Epoch 31/50
2083/2083 - 72s - loss: 2.5608 - accuracy10: 0.5904 - val_loss: 2.6483 - val_accuracy10: 0.5869 - 72s/epoch - 34ms/step
Epoch 32/50
2083/2083 - 71s - loss: 2.5586 - accuracy10: 0.5908 - val_loss: 2.6405 - val_accuracy10: 0.5881 - 71s/epoch - 34ms/step
Epoch 33/50
2083/2083 - 70s - loss: 2.5555 - accuracy10: 0.5912 - val_loss: 2.6439 - val_accuracy10: 0.5798 - 70s/epoch - 34ms/step
Epoch 34/50
2083/2083 - 70s - loss: 2.5527 - accuracy10: 0.5917 - val_loss: 2.6407 - val_accuracy10: 0.5870 - 70s/epoch - 34ms/step
Epoch 35/50
2083/2083 - 70s - loss: 2.5507 - accuracy10: 0.5919 - val_loss: 2.6448 - val_accuracy10: 0.5854 - 70s/epoch - 34ms/step
Epoch 36/50
2083/2083 - 71s - loss: 2.5490 - accuracy10: 0.5927 - val_loss: 2.6455 - val_accuracy10: 0.5876 - 71s/epoch - 34ms/step
Epoch 37/50
2083/2083 - 71s - loss: 2.5458 - accuracy10: 0.5934 - val_loss: 2.6488 - val_accuracy10: 0.5883 - 71s/epoch - 34ms/step
Epoch 38/50
2083/2083 - 72s - loss: 2.5431 - accuracy10: 0.5934 - val_loss: 2.6512 - val_accuracy10: 0.5863 - 72s/epoch - 35ms/step
Epoch 39/50
2083/2083 - 73s - loss: 2.5404 - accuracy10: 0.5939 - val_loss: 2.6460 - val_accuracy10: 0.5878 - 73s/epoch - 35ms/step
Epoch 40/50
2083/2083 - 70s - loss: 2.5397 - accuracy10: 0.5942 - val_loss: 2.6488 - val_accuracy10: 0.5863 - 70s/epoch - 34ms/step
Epoch 41/50
2083/2083 - 70s - loss: 2.5368 - accuracy10: 0.5942 - val_loss: 2.6485 - val_accuracy10: 0.5830 - 70s/epoch - 34ms/step
Epoch 42/50
2083/2083 - 70s - loss: 2.5340 - accuracy10: 0.5943 - val_loss: 2.6510 - val_accuracy10: 0.5787 - 70s/epoch - 33ms/step
testing model: results/ATVI/W7/deepVOL_L3/h10
Evaluating performance on  test set...
6143/6143 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7913018
{'0': {'precision': 0.46813315246851395, 'recall': 0.5594405594405595, 'f1-score': 0.5097301919549927, 'support': 316459}, '1': {'precision': 0.8010554076739493, 'recall': 0.690390373532935, 'f1-score': 0.7416172268455812, 'support': 944147}, '2': {'precision': 0.46996492426531444, 'recall': 0.5734956523969529, 'f1-score': 0.5165941998639714, 'support': 311896}, 'accuracy': 0.6408519671199147, 'macro avg': {'precision': 0.579717828135926, 'recall': 0.6077755284568158, 'f1-score': 0.5893138728881817, 'support': 1572502}, 'weighted avg': {'precision': 0.6683865516894886, 'recall': 0.6408519671199147, 'f1-score': 0.6503190782913046, 'support': 1572502}}
[[177040  87652  51767]
 [142350 651830 149967]
 [ 58793  74232 178871]]
Evaluating performance on  train set...
2083/2083 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87104726
{'0': {'precision': 0.4748155171156358, 'recall': 0.5654827706010549, 'f1-score': 0.516198089169679, 'support': 126644}, '1': {'precision': 0.7567780821917808, 'recall': 0.6147754061349344, 'f1-score': 0.6784256783176114, 'support': 280818}, '2': {'precision': 0.46984085826337796, 'recall': 0.5763587928909387, 'f1-score': 0.5176773087636597, 'support': 125755}, 'accuracy': 0.5940076929280199, 'macro avg': {'precision': 0.5671448191902648, 'recall': 0.5855389898756426, 'f1-score': 0.5707670254169833, 'support': 533217}, 'weighted avg': {'precision': 0.6221374805481356, 'recall': 0.5940076929280199, 'f1-score': 0.6019838881771846, 'support': 533217}}
[[ 71615  30261  24768]
 [ 51161 172640  57017]
 [ 28051  25224  72480]]
Evaluating performance on  val set...
685/685 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88185614
{'0': {'precision': 0.4589036953410076, 'recall': 0.5612317857935354, 'f1-score': 0.5049355604356602, 'support': 40559}, '1': {'precision': 0.7642684215454169, 'recall': 0.6074545783145339, 'f1-score': 0.6768981081113099, 'support': 94063}, '2': {'precision': 0.45422874800716434, 'recall': 0.5691105028236049, 'f1-score': 0.5052212176273561, 'support': 40551}, 'accuracy': 0.5878759854543794, 'macro avg': {'precision': 0.5591336216311963, 'recall': 0.579265622310558, 'f1-score': 0.5623516287247754, 'support': 175173}, 'weighted avg': {'precision': 0.6217938008460264, 'recall': 0.5878759854543794, 'f1-score': 0.5973407644727841, 'support': 175173}}
[[22763  9398  8398]
 [17593 57139 19331]
 [ 9247  8226 23078]]
training model: results/ATVI/W7/deepVOL_L3/h20
Epoch 1/50
2083/2083 - 74s - loss: 3.2815 - accuracy20: 0.3816 - val_loss: 3.3228 - val_accuracy20: 0.4235 - 74s/epoch - 35ms/step
Epoch 2/50
2083/2083 - 71s - loss: 3.2259 - accuracy20: 0.4159 - val_loss: 3.1393 - val_accuracy20: 0.4676 - 71s/epoch - 34ms/step
Epoch 3/50
2083/2083 - 70s - loss: 3.1264 - accuracy20: 0.4638 - val_loss: 3.1319 - val_accuracy20: 0.4917 - 70s/epoch - 33ms/step
Epoch 4/50
2083/2083 - 70s - loss: 3.0103 - accuracy20: 0.4954 - val_loss: 3.0605 - val_accuracy20: 0.5159 - 70s/epoch - 34ms/step
Epoch 5/50
2083/2083 - 70s - loss: 2.8864 - accuracy20: 0.5260 - val_loss: 3.0401 - val_accuracy20: 0.5274 - 70s/epoch - 34ms/step
Epoch 6/50
2083/2083 - 70s - loss: 2.8432 - accuracy20: 0.5368 - val_loss: 3.0666 - val_accuracy20: 0.5322 - 70s/epoch - 34ms/step
Epoch 7/50
2083/2083 - 71s - loss: 2.8213 - accuracy20: 0.5422 - val_loss: 2.9921 - val_accuracy20: 0.5366 - 71s/epoch - 34ms/step
Epoch 8/50
2083/2083 - 70s - loss: 2.8048 - accuracy20: 0.5456 - val_loss: 2.9731 - val_accuracy20: 0.5388 - 70s/epoch - 34ms/step
Epoch 9/50
2083/2083 - 72s - loss: 2.7897 - accuracy20: 0.5490 - val_loss: 2.9385 - val_accuracy20: 0.5455 - 72s/epoch - 34ms/step
Epoch 10/50
2083/2083 - 70s - loss: 2.7775 - accuracy20: 0.5517 - val_loss: 2.9429 - val_accuracy20: 0.5441 - 70s/epoch - 33ms/step
Epoch 11/50
2083/2083 - 70s - loss: 2.7679 - accuracy20: 0.5533 - val_loss: 2.8975 - val_accuracy20: 0.5494 - 70s/epoch - 34ms/step
Epoch 12/50
2083/2083 - 70s - loss: 2.7589 - accuracy20: 0.5556 - val_loss: 2.9023 - val_accuracy20: 0.5485 - 70s/epoch - 34ms/step
Epoch 13/50
2083/2083 - 71s - loss: 2.7515 - accuracy20: 0.5570 - val_loss: 2.9029 - val_accuracy20: 0.5505 - 71s/epoch - 34ms/step
Epoch 14/50
2083/2083 - 70s - loss: 2.7456 - accuracy20: 0.5580 - val_loss: 2.8821 - val_accuracy20: 0.5526 - 70s/epoch - 34ms/step
Epoch 15/50
2083/2083 - 70s - loss: 2.7400 - accuracy20: 0.5595 - val_loss: 2.8550 - val_accuracy20: 0.5538 - 70s/epoch - 34ms/step
Epoch 16/50
2083/2083 - 71s - loss: 2.7347 - accuracy20: 0.5604 - val_loss: 2.8758 - val_accuracy20: 0.5534 - 71s/epoch - 34ms/step
Epoch 17/50
2083/2083 - 70s - loss: 2.7300 - accuracy20: 0.5620 - val_loss: 2.8546 - val_accuracy20: 0.5550 - 70s/epoch - 34ms/step
Epoch 18/50
2083/2083 - 69s - loss: 2.7254 - accuracy20: 0.5627 - val_loss: 2.8613 - val_accuracy20: 0.5563 - 69s/epoch - 33ms/step
Epoch 19/50
2083/2083 - 70s - loss: 2.7207 - accuracy20: 0.5636 - val_loss: 2.8614 - val_accuracy20: 0.5563 - 70s/epoch - 34ms/step
Epoch 20/50
2083/2083 - 70s - loss: 2.7175 - accuracy20: 0.5644 - val_loss: 2.8613 - val_accuracy20: 0.5569 - 70s/epoch - 34ms/step
Epoch 21/50
2083/2083 - 72s - loss: 2.7141 - accuracy20: 0.5649 - val_loss: 2.8538 - val_accuracy20: 0.5576 - 72s/epoch - 35ms/step
Epoch 22/50
2083/2083 - 70s - loss: 2.7106 - accuracy20: 0.5661 - val_loss: 2.8456 - val_accuracy20: 0.5570 - 70s/epoch - 34ms/step
Epoch 23/50
2083/2083 - 70s - loss: 2.7070 - accuracy20: 0.5671 - val_loss: 2.8227 - val_accuracy20: 0.5600 - 70s/epoch - 34ms/step
Epoch 24/50
2083/2083 - 70s - loss: 2.7040 - accuracy20: 0.5677 - val_loss: 2.8222 - val_accuracy20: 0.5620 - 70s/epoch - 34ms/step
Epoch 25/50
2083/2083 - 70s - loss: 2.7014 - accuracy20: 0.5674 - val_loss: 2.8147 - val_accuracy20: 0.5621 - 70s/epoch - 34ms/step
Epoch 26/50
2083/2083 - 69s - loss: 2.6982 - accuracy20: 0.5682 - val_loss: 2.8072 - val_accuracy20: 0.5630 - 69s/epoch - 33ms/step
Epoch 27/50
2083/2083 - 70s - loss: 2.6952 - accuracy20: 0.5690 - val_loss: 2.8139 - val_accuracy20: 0.5628 - 70s/epoch - 34ms/step
Epoch 28/50
2083/2083 - 70s - loss: 2.6922 - accuracy20: 0.5695 - val_loss: 2.8206 - val_accuracy20: 0.5604 - 70s/epoch - 34ms/step
Epoch 29/50
2083/2083 - 70s - loss: 2.6892 - accuracy20: 0.5703 - val_loss: 2.8200 - val_accuracy20: 0.5625 - 70s/epoch - 34ms/step
Epoch 30/50
2083/2083 - 70s - loss: 2.6875 - accuracy20: 0.5708 - val_loss: 2.8271 - val_accuracy20: 0.5617 - 70s/epoch - 33ms/step
Epoch 31/50
2083/2083 - 71s - loss: 2.6840 - accuracy20: 0.5712 - val_loss: 2.8169 - val_accuracy20: 0.5638 - 71s/epoch - 34ms/step
Epoch 32/50
2083/2083 - 70s - loss: 2.6827 - accuracy20: 0.5718 - val_loss: 2.8071 - val_accuracy20: 0.5643 - 70s/epoch - 33ms/step
Epoch 33/50
2083/2083 - 71s - loss: 2.6789 - accuracy20: 0.5723 - val_loss: 2.8142 - val_accuracy20: 0.5632 - 71s/epoch - 34ms/step
Epoch 34/50
2083/2083 - 70s - loss: 2.6776 - accuracy20: 0.5724 - val_loss: 2.8070 - val_accuracy20: 0.5634 - 70s/epoch - 33ms/step
Epoch 35/50
2083/2083 - 70s - loss: 2.6744 - accuracy20: 0.5734 - val_loss: 2.8144 - val_accuracy20: 0.5638 - 70s/epoch - 34ms/step
Epoch 36/50
2083/2083 - 70s - loss: 2.6720 - accuracy20: 0.5739 - val_loss: 2.8035 - val_accuracy20: 0.5645 - 70s/epoch - 34ms/step
Epoch 37/50
2083/2083 - 69s - loss: 2.6702 - accuracy20: 0.5747 - val_loss: 2.8044 - val_accuracy20: 0.5639 - 69s/epoch - 33ms/step
Epoch 38/50
2083/2083 - 70s - loss: 2.6681 - accuracy20: 0.5746 - val_loss: 2.8089 - val_accuracy20: 0.5642 - 70s/epoch - 33ms/step
Epoch 39/50
2083/2083 - 70s - loss: 2.6652 - accuracy20: 0.5754 - val_loss: 2.8146 - val_accuracy20: 0.5648 - 70s/epoch - 33ms/step
Epoch 40/50
2083/2083 - 69s - loss: 2.6632 - accuracy20: 0.5759 - val_loss: 2.8143 - val_accuracy20: 0.5647 - 69s/epoch - 33ms/step
Epoch 41/50
2083/2083 - 69s - loss: 2.6604 - accuracy20: 0.5761 - val_loss: 2.8040 - val_accuracy20: 0.5645 - 69s/epoch - 33ms/step
Epoch 42/50
2083/2083 - 70s - loss: 2.6595 - accuracy20: 0.5761 - val_loss: 2.8172 - val_accuracy20: 0.5631 - 70s/epoch - 34ms/step
Epoch 43/50
2083/2083 - 69s - loss: 2.6554 - accuracy20: 0.5769 - val_loss: 2.8257 - val_accuracy20: 0.5637 - 69s/epoch - 33ms/step
Epoch 44/50
2083/2083 - 70s - loss: 2.6544 - accuracy20: 0.5776 - val_loss: 2.8207 - val_accuracy20: 0.5640 - 70s/epoch - 34ms/step
Epoch 45/50
2083/2083 - 70s - loss: 2.6521 - accuracy20: 0.5776 - val_loss: 2.8203 - val_accuracy20: 0.5629 - 70s/epoch - 34ms/step
Epoch 46/50
2083/2083 - 70s - loss: 2.6508 - accuracy20: 0.5785 - val_loss: 2.8224 - val_accuracy20: 0.5637 - 70s/epoch - 34ms/step
testing model: results/ATVI/W7/deepVOL_L3/h20
Evaluating performance on  test set...
6143/6143 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8445509
{'0': {'precision': 0.5266948547267377, 'recall': 0.4567219198477916, 'f1-score': 0.48921899939895475, 'support': 403657}, '1': {'precision': 0.6572507987542725, 'recall': 0.8017628848619872, 'f1-score': 0.7223500401736717, 'support': 772030}, '2': {'precision': 0.5683469128193436, 'recall': 0.40202865315071257, 'f1-score': 0.4709346605501337, 'support': 396815}, 'accuracy': 0.6123203658882469, 'macro avg': {'precision': 0.584097522100118, 'recall': 0.5535044859534971, 'f1-score': 0.5608345667075867, 'support': 1572502}, 'weighted avg': {'precision': 0.6013028786908376, 'recall': 0.6123203658882469, 'f1-score': 0.599062203089004, 'support': 1572502}}
[[184359 168521  50777]
 [ 82660 618985  70385]
 [ 83011 154273 159531]]
Evaluating performance on  train set...
2083/2083 - 35s - 35s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9105173
{'0': {'precision': 0.5172478427644748, 'recall': 0.48999613162617556, 'f1-score': 0.5032533298596411, 'support': 157689}, '1': {'precision': 0.5934353436215711, 'recall': 0.7448926999475473, 'f1-score': 0.660593876783309, 'support': 219245}, '2': {'precision': 0.5588714502692502, 'recall': 0.38848115278053275, 'f1-score': 0.458353150786281, 'support': 156283}, 'accuracy': 0.5650495014224978, 'macro avg': {'precision': 0.5565182122184321, 'recall': 0.5411233281180852, 'f1-score': 0.5407334524764104, 'support': 533217}, 'weighted avg': {'precision': 0.5607738197627379, 'recall': 0.5650495014224978, 'f1-score': 0.5547876836483568, 'support': 533217}}
[[ 77267  57585  22837]
 [ 30846 163314  25085]
 [ 41268  54302  60713]]
Evaluating performance on  val set...
685/685 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9188314
{'0': {'precision': 0.5028226789050443, 'recall': 0.49122145733727457, 'f1-score': 0.4969543707539312, 'support': 50407}, '1': {'precision': 0.6053618711385702, 'recall': 0.7395676083674789, 'f1-score': 0.665768782760629, 'support': 74192}, '2': {'precision': 0.5414151718665873, 'recall': 0.3777830505793491, 'f1-score': 0.44503453175407337, 'support': 50574}, 'accuracy': 0.5636542161177807, 'macro avg': {'precision': 0.5498665739700672, 'recall': 0.5361907054280343, 'f1-score': 0.5359192284228779, 'support': 175173}, 'weighted avg': {'precision': 0.557393671519356, 'recall': 0.5636542161177807, 'f1-score': 0.5534635640543948, 'support': 175173}}
[[24761 18004  7642]
 [10781 54870  8541]
 [13702 17766 19106]]
training model: results/ATVI/W7/deepVOL_L3/h30
Epoch 1/50
2083/2083 - 73s - loss: 3.2847 - accuracy30: 0.3685 - val_loss: 3.2958 - val_accuracy30: 0.3514 - 73s/epoch - 35ms/step
Epoch 2/50
2083/2083 - 70s - loss: 3.2284 - accuracy30: 0.3938 - val_loss: 3.2368 - val_accuracy30: 0.4374 - 70s/epoch - 34ms/step
Epoch 3/50
2083/2083 - 70s - loss: 3.1071 - accuracy30: 0.4499 - val_loss: 3.2457 - val_accuracy30: 0.4550 - 70s/epoch - 34ms/step
Epoch 4/50
2083/2083 - 69s - loss: 2.9605 - accuracy30: 0.4999 - val_loss: 3.2810 - val_accuracy30: 0.4690 - 69s/epoch - 33ms/step
Epoch 5/50
2083/2083 - 71s - loss: 2.9094 - accuracy30: 0.5139 - val_loss: 3.2005 - val_accuracy30: 0.4724 - 71s/epoch - 34ms/step
Epoch 6/50
2083/2083 - 70s - loss: 2.8814 - accuracy30: 0.5206 - val_loss: 3.1704 - val_accuracy30: 0.4734 - 70s/epoch - 34ms/step
Epoch 7/50
2083/2083 - 71s - loss: 2.8668 - accuracy30: 0.5244 - val_loss: 3.1072 - val_accuracy30: 0.4845 - 71s/epoch - 34ms/step
Epoch 8/50
2083/2083 - 69s - loss: 2.8544 - accuracy30: 0.5272 - val_loss: 3.0998 - val_accuracy30: 0.4905 - 69s/epoch - 33ms/step
Epoch 9/50
2083/2083 - 69s - loss: 2.8446 - accuracy30: 0.5305 - val_loss: 3.0623 - val_accuracy30: 0.4943 - 69s/epoch - 33ms/step
Epoch 10/50
2083/2083 - 68s - loss: 2.8366 - accuracy30: 0.5316 - val_loss: 3.0271 - val_accuracy30: 0.4989 - 68s/epoch - 33ms/step
Epoch 11/50
2083/2083 - 69s - loss: 2.8289 - accuracy30: 0.5335 - val_loss: 3.0160 - val_accuracy30: 0.5007 - 69s/epoch - 33ms/step
Epoch 12/50
2083/2083 - 69s - loss: 2.8230 - accuracy30: 0.5348 - val_loss: 3.0234 - val_accuracy30: 0.5019 - 69s/epoch - 33ms/step
Epoch 13/50
2083/2083 - 69s - loss: 2.8174 - accuracy30: 0.5369 - val_loss: 2.9885 - val_accuracy30: 0.5067 - 69s/epoch - 33ms/step
Epoch 14/50
2083/2083 - 70s - loss: 2.8106 - accuracy30: 0.5384 - val_loss: 2.9748 - val_accuracy30: 0.5127 - 70s/epoch - 34ms/step
Epoch 15/50
2083/2083 - 69s - loss: 2.8060 - accuracy30: 0.5393 - val_loss: 2.9787 - val_accuracy30: 0.5077 - 69s/epoch - 33ms/step
Epoch 16/50
2083/2083 - 69s - loss: 2.8017 - accuracy30: 0.5403 - val_loss: 2.9567 - val_accuracy30: 0.5124 - 69s/epoch - 33ms/step
Epoch 17/50
2083/2083 - 70s - loss: 2.7972 - accuracy30: 0.5410 - val_loss: 2.9355 - val_accuracy30: 0.5170 - 70s/epoch - 34ms/step
Epoch 18/50
2083/2083 - 70s - loss: 2.7925 - accuracy30: 0.5428 - val_loss: 2.9451 - val_accuracy30: 0.5174 - 70s/epoch - 33ms/step
Epoch 19/50
2083/2083 - 69s - loss: 2.7888 - accuracy30: 0.5432 - val_loss: 2.9221 - val_accuracy30: 0.5212 - 69s/epoch - 33ms/step
Epoch 20/50
2083/2083 - 69s - loss: 2.7857 - accuracy30: 0.5443 - val_loss: 2.9244 - val_accuracy30: 0.5204 - 69s/epoch - 33ms/step
Epoch 21/50
2083/2083 - 69s - loss: 2.7811 - accuracy30: 0.5455 - val_loss: 2.9244 - val_accuracy30: 0.5206 - 69s/epoch - 33ms/step
Epoch 22/50
2083/2083 - 69s - loss: 2.7785 - accuracy30: 0.5463 - val_loss: 2.9191 - val_accuracy30: 0.5242 - 69s/epoch - 33ms/step
Epoch 23/50
2083/2083 - 69s - loss: 2.7761 - accuracy30: 0.5462 - val_loss: 2.9108 - val_accuracy30: 0.5223 - 69s/epoch - 33ms/step
Epoch 24/50
2083/2083 - 69s - loss: 2.7727 - accuracy30: 0.5475 - val_loss: 2.9130 - val_accuracy30: 0.5232 - 69s/epoch - 33ms/step
Epoch 25/50
2083/2083 - 70s - loss: 2.7704 - accuracy30: 0.5480 - val_loss: 2.9174 - val_accuracy30: 0.5241 - 70s/epoch - 33ms/step
Epoch 26/50
2083/2083 - 69s - loss: 2.7684 - accuracy30: 0.5484 - val_loss: 2.9235 - val_accuracy30: 0.5233 - 69s/epoch - 33ms/step
Epoch 27/50
2083/2083 - 70s - loss: 2.7651 - accuracy30: 0.5492 - val_loss: 2.9199 - val_accuracy30: 0.5230 - 70s/epoch - 34ms/step
Epoch 28/50
2083/2083 - 69s - loss: 2.7628 - accuracy30: 0.5499 - val_loss: 2.9140 - val_accuracy30: 0.5256 - 69s/epoch - 33ms/step
Epoch 29/50
2083/2083 - 70s - loss: 2.7607 - accuracy30: 0.5505 - val_loss: 2.9012 - val_accuracy30: 0.5281 - 70s/epoch - 34ms/step
Epoch 30/50
2083/2083 - 69s - loss: 2.7591 - accuracy30: 0.5505 - val_loss: 2.9041 - val_accuracy30: 0.5267 - 69s/epoch - 33ms/step
Epoch 31/50
2083/2083 - 69s - loss: 2.7553 - accuracy30: 0.5519 - val_loss: 2.9022 - val_accuracy30: 0.5289 - 69s/epoch - 33ms/step
Epoch 32/50
2083/2083 - 69s - loss: 2.7540 - accuracy30: 0.5518 - val_loss: 2.8989 - val_accuracy30: 0.5290 - 69s/epoch - 33ms/step
Epoch 33/50
2083/2083 - 68s - loss: 2.7525 - accuracy30: 0.5520 - val_loss: 2.9060 - val_accuracy30: 0.5280 - 68s/epoch - 33ms/step
Epoch 34/50
2083/2083 - 68s - loss: 2.7498 - accuracy30: 0.5530 - val_loss: 2.9046 - val_accuracy30: 0.5280 - 68s/epoch - 33ms/step
Epoch 35/50
2083/2083 - 69s - loss: 2.7483 - accuracy30: 0.5533 - val_loss: 2.9131 - val_accuracy30: 0.5270 - 69s/epoch - 33ms/step
Epoch 36/50
2083/2083 - 70s - loss: 2.7465 - accuracy30: 0.5540 - val_loss: 2.9069 - val_accuracy30: 0.5268 - 70s/epoch - 34ms/step
Epoch 37/50
2083/2083 - 69s - loss: 2.7440 - accuracy30: 0.5547 - val_loss: 2.8972 - val_accuracy30: 0.5303 - 69s/epoch - 33ms/step
Epoch 38/50
2083/2083 - 69s - loss: 2.7430 - accuracy30: 0.5541 - val_loss: 2.9004 - val_accuracy30: 0.5297 - 69s/epoch - 33ms/step
Epoch 39/50
2083/2083 - 69s - loss: 2.7407 - accuracy30: 0.5550 - val_loss: 2.9015 - val_accuracy30: 0.5288 - 69s/epoch - 33ms/step
Epoch 40/50
2083/2083 - 69s - loss: 2.7377 - accuracy30: 0.5561 - val_loss: 2.9116 - val_accuracy30: 0.5286 - 69s/epoch - 33ms/step
Epoch 41/50
2083/2083 - 69s - loss: 2.7371 - accuracy30: 0.5555 - val_loss: 2.9086 - val_accuracy30: 0.5277 - 69s/epoch - 33ms/step
Epoch 42/50
2083/2083 - 68s - loss: 2.7351 - accuracy30: 0.5566 - val_loss: 2.9126 - val_accuracy30: 0.5285 - 68s/epoch - 33ms/step
Epoch 43/50
2083/2083 - 69s - loss: 2.7315 - accuracy30: 0.5569 - val_loss: 2.9178 - val_accuracy30: 0.5276 - 69s/epoch - 33ms/step
Epoch 44/50
2083/2083 - 69s - loss: 2.7312 - accuracy30: 0.5570 - val_loss: 2.9102 - val_accuracy30: 0.5278 - 69s/epoch - 33ms/step
Epoch 45/50
2083/2083 - 68s - loss: 2.7291 - accuracy30: 0.5578 - val_loss: 2.9194 - val_accuracy30: 0.5271 - 68s/epoch - 33ms/step
Epoch 46/50
2083/2083 - 69s - loss: 2.7268 - accuracy30: 0.5586 - val_loss: 2.9246 - val_accuracy30: 0.5261 - 69s/epoch - 33ms/step
Epoch 47/50
2083/2083 - 69s - loss: 2.7244 - accuracy30: 0.5583 - val_loss: 2.9225 - val_accuracy30: 0.5288 - 69s/epoch - 33ms/step
testing model: results/ATVI/W7/deepVOL_L3/h30
Evaluating performance on  test set...
6143/6143 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9157657
{'0': {'precision': 0.5252090725447713, 'recall': 0.4341466896520398, 'f1-score': 0.4753560445572282, 'support': 462323}, '1': {'precision': 0.582854613613603, 'recall': 0.7580466114829219, 'f1-score': 0.6590059827936606, 'support': 654903}, '2': {'precision': 0.5560609237802987, 'recall': 0.4135403579367241, 'f1-score': 0.47432617466741744, 'support': 455276}, 'accuracy': 0.5630759134169623, 'macro avg': {'precision': 0.5547082033128911, 'recall': 0.5352445530238953, 'f1-score': 0.5362294006727687, 'support': 1572502}, 'weighted avg': {'precision': 0.5581491547867697, 'recall': 0.5630759134169623, 'f1-score': 0.5515429241013565, 'support': 1572502}}
[[200716 189338  72269]
 [ 80413 496447  78043]
 [101035 165966 188275]]
Evaluating performance on  train set...
2083/2083 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9555074
{'0': {'precision': 0.5200667586506076, 'recall': 0.48755358988697406, 'f1-score': 0.5032856184950876, 'support': 177039}, '1': {'precision': 0.5282093453552233, 'recall': 0.6963989379356124, 'f1-score': 0.6007544324697046, 'support': 180780}, '2': {'precision': 0.5506078213850725, 'recall': 0.40465113627293353, 'f1-score': 0.4664789139700494, 'support': 175398}, 'accuracy': 0.5310895939176733, 'macro avg': {'precision': 0.5329613084636345, 'recall': 0.5295345546985066, 'f1-score': 0.5235063216449473, 'support': 533217}, 'weighted avg': {'precision': 0.532873661179897, 'recall': 0.5310895939176733, 'f1-score': 0.5242237915654298, 'support': 533217}}
[[ 86316  58915  31808]
 [ 28765 125895  26120]
 [ 50890  53533  70975]]
Evaluating performance on  val set...
685/685 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9654021
{'0': {'precision': 0.5078009124532978, 'recall': 0.47607899739491655, 'f1-score': 0.49142857142857144, 'support': 56812}, '1': {'precision': 0.5387219422234012, 'recall': 0.6928037686809617, 'f1-score': 0.6061239136768353, 'support': 61560}, '2': {'precision': 0.5357602414430434, 'recall': 0.4031619161634478, 'f1-score': 0.46009804709475205, 'support': 56801}, 'accuracy': 0.528597443669972, 'macro avg': {'precision': 0.5274276987065808, 'recall': 0.5240148940797754, 'f1-score': 0.5192168440667196, 'support': 175173}, 'weighted avg': {'precision': 0.5277333017975123, 'recall': 0.528597443669972, 'f1-score': 0.5215761407235989, 'support': 175173}}
[[27047 18810 10955]
 [10023 42649  8888]
 [16193 17708 22900]]
training model: results/ATVI/W7/deepVOL_L3/h50
Epoch 1/50
2083/2083 - 72s - loss: 3.2873 - accuracy50: 0.3677 - val_loss: 3.3215 - val_accuracy50: 0.3421 - 72s/epoch - 35ms/step
Epoch 2/50
2083/2083 - 69s - loss: 3.2642 - accuracy50: 0.3766 - val_loss: 3.2570 - val_accuracy50: 0.4137 - 69s/epoch - 33ms/step
Epoch 3/50
2083/2083 - 68s - loss: 3.1730 - accuracy50: 0.4248 - val_loss: 3.2663 - val_accuracy50: 0.4393 - 68s/epoch - 33ms/step
Epoch 4/50
2083/2083 - 70s - loss: 3.1057 - accuracy50: 0.4551 - val_loss: 3.1957 - val_accuracy50: 0.4512 - 70s/epoch - 33ms/step
Epoch 5/50
2083/2083 - 68s - loss: 3.0794 - accuracy50: 0.4662 - val_loss: 3.1548 - val_accuracy50: 0.4532 - 68s/epoch - 33ms/step
Epoch 6/50
2083/2083 - 69s - loss: 3.0618 - accuracy50: 0.4714 - val_loss: 3.1650 - val_accuracy50: 0.4600 - 69s/epoch - 33ms/step
Epoch 7/50
2083/2083 - 69s - loss: 3.0483 - accuracy50: 0.4747 - val_loss: 3.1304 - val_accuracy50: 0.4626 - 69s/epoch - 33ms/step
Epoch 8/50
2083/2083 - 70s - loss: 3.0396 - accuracy50: 0.4769 - val_loss: 3.1737 - val_accuracy50: 0.4615 - 70s/epoch - 33ms/step
Epoch 9/50
2083/2083 - 70s - loss: 3.0339 - accuracy50: 0.4774 - val_loss: 3.1704 - val_accuracy50: 0.4665 - 70s/epoch - 33ms/step
Epoch 10/50
2083/2083 - 69s - loss: 3.0278 - accuracy50: 0.4800 - val_loss: 3.2156 - val_accuracy50: 0.4618 - 69s/epoch - 33ms/step
Epoch 11/50
2083/2083 - 69s - loss: 3.0228 - accuracy50: 0.4812 - val_loss: 3.2056 - val_accuracy50: 0.4592 - 69s/epoch - 33ms/step
Epoch 12/50
2083/2083 - 68s - loss: 3.0193 - accuracy50: 0.4826 - val_loss: 3.2111 - val_accuracy50: 0.4639 - 68s/epoch - 33ms/step
Epoch 13/50
2083/2083 - 68s - loss: 3.0148 - accuracy50: 0.4841 - val_loss: 3.1988 - val_accuracy50: 0.4611 - 68s/epoch - 33ms/step
Epoch 14/50
2083/2083 - 68s - loss: 3.0106 - accuracy50: 0.4850 - val_loss: 3.1894 - val_accuracy50: 0.4616 - 68s/epoch - 33ms/step
Epoch 15/50
2083/2083 - 69s - loss: 3.0070 - accuracy50: 0.4864 - val_loss: 3.1791 - val_accuracy50: 0.4619 - 69s/epoch - 33ms/step
Epoch 16/50
2083/2083 - 68s - loss: 3.0038 - accuracy50: 0.4876 - val_loss: 3.1938 - val_accuracy50: 0.4621 - 68s/epoch - 33ms/step
Epoch 17/50
2083/2083 - 69s - loss: 3.0008 - accuracy50: 0.4880 - val_loss: 3.1510 - val_accuracy50: 0.4667 - 69s/epoch - 33ms/step
testing model: results/ATVI/W7/deepVOL_L3/h50
Evaluating performance on  test set...
6143/6143 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0144466
{'0': {'precision': 0.4536139947430428, 'recall': 0.43740839202543397, 'f1-score': 0.4453638224745167, 'support': 476214}, '1': {'precision': 0.5133636642741969, 'recall': 0.6864568955206511, 'f1-score': 0.5874245517363473, 'support': 618706}, '2': {'precision': 0.4835392313529126, 'recall': 0.2895502761829382, 'f1-score': 0.362206229986969, 'support': 477582}, 'accuracy': 0.49049158602024034, 'macro avg': {'precision': 0.48350563012338404, 'recall': 0.47113852124300776, 'f1-score': 0.4649982013992777, 'support': 1572502}, 'weighted avg': {'precision': 0.486211240016853, 'recall': 0.49049158602024034, 'f1-score': 0.47600242021447653, 'support': 1572502}}
[[208300 204701  63213]
 [109505 424715  84486]
 [141396 197902 138284]]
Evaluating performance on  train set...
2083/2083 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0461065
{'0': {'precision': 0.44435848781199827, 'recall': 0.5140459398762854, 'f1-score': 0.47666865867947816, 'support': 177667}, '1': {'precision': 0.4726535179745419, 'recall': 0.5692161696249586, 'f1-score': 0.5164600300083809, 'support': 178087}, '2': {'precision': 0.4668733494086577, 'recall': 0.29785363709618345, 'f1-score': 0.3636851520572451, 'support': 177463}, 'accuracy': 0.4605198258870216, 'macro avg': {'precision': 0.4612951183983993, 'recall': 0.46037191553247586, 'f1-score': 0.4522712802483681, 'support': 533217}, 'weighted avg': {'precision': 0.46130193095069205, 'recall': 0.4605198258870216, 'f1-score': 0.45235573150376723, 'support': 533217}}
[[ 91329  57780  28558]
 [ 44916 101370  31801]
 [ 69285  55320  52858]]
Evaluating performance on  val set...
685/685 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.043668
{'0': {'precision': 0.44033230407293045, 'recall': 0.522006658648399, 'f1-score': 0.4777036026766843, 'support': 57369}, '1': {'precision': 0.48263672869181606, 'recall': 0.5695835002002403, 'f1-score': 0.5225178336343875, 'support': 59928}, '2': {'precision': 0.4646395345646148, 'recall': 0.2925392217845048, 'f1-score': 0.35903090706674434, 'support': 57876}, 'accuracy': 0.4624685311092463, 'macro avg': {'precision': 0.46253618910978717, 'recall': 0.461376460211048, 'f1-score': 0.4530841144592721, 'support': 175173}, 'weighted avg': {'precision': 0.46283591382156347, 'recall': 0.4624685311092463, 'f1-score': 0.4538262146186637, 'support': 175173}}
[[29947 18371  9051]
 [15337 34134 10457]
 [22726 18219 16931]]
training model: results/ATVI/W7/deepVOL_L3/h100
Epoch 1/50
2083/2083 - 74s - loss: 3.2806 - accuracy100: 0.3758 - val_loss: 3.3004 - val_accuracy100: 0.3328 - 74s/epoch - 35ms/step
Epoch 2/50
2083/2083 - 69s - loss: 3.2754 - accuracy100: 0.3731 - val_loss: 3.2873 - val_accuracy100: 0.3446 - 69s/epoch - 33ms/step
Epoch 3/50
2083/2083 - 69s - loss: 3.2606 - accuracy100: 0.3838 - val_loss: 3.3596 - val_accuracy100: 0.3613 - 69s/epoch - 33ms/step
Epoch 4/50
2083/2083 - 69s - loss: 3.2293 - accuracy100: 0.4026 - val_loss: 3.3072 - val_accuracy100: 0.3685 - 69s/epoch - 33ms/step
Epoch 5/50
2083/2083 - 69s - loss: 3.2140 - accuracy100: 0.4105 - val_loss: 3.3110 - val_accuracy100: 0.3761 - 69s/epoch - 33ms/step
Epoch 6/50
2083/2083 - 69s - loss: 3.2038 - accuracy100: 0.4159 - val_loss: 3.2878 - val_accuracy100: 0.3892 - 69s/epoch - 33ms/step
Epoch 7/50
2083/2083 - 68s - loss: 3.1972 - accuracy100: 0.4182 - val_loss: 3.2771 - val_accuracy100: 0.3965 - 68s/epoch - 33ms/step
Epoch 8/50
2083/2083 - 68s - loss: 3.1926 - accuracy100: 0.4198 - val_loss: 3.2946 - val_accuracy100: 0.3969 - 68s/epoch - 33ms/step
Epoch 9/50
2083/2083 - 69s - loss: 3.1901 - accuracy100: 0.4214 - val_loss: 3.2850 - val_accuracy100: 0.3985 - 69s/epoch - 33ms/step
Epoch 10/50
2083/2083 - 69s - loss: 3.1861 - accuracy100: 0.4232 - val_loss: 3.2896 - val_accuracy100: 0.3979 - 69s/epoch - 33ms/step
Epoch 11/50
2083/2083 - 70s - loss: 3.1837 - accuracy100: 0.4247 - val_loss: 3.2759 - val_accuracy100: 0.3960 - 70s/epoch - 34ms/step
Epoch 12/50
2083/2083 - 68s - loss: 3.1815 - accuracy100: 0.4252 - val_loss: 3.2942 - val_accuracy100: 0.3949 - 68s/epoch - 33ms/step
Epoch 13/50
2083/2083 - 70s - loss: 3.1786 - accuracy100: 0.4265 - val_loss: 3.2842 - val_accuracy100: 0.3956 - 70s/epoch - 33ms/step
Epoch 14/50
2083/2083 - 68s - loss: 3.1761 - accuracy100: 0.4283 - val_loss: 3.3005 - val_accuracy100: 0.3916 - 68s/epoch - 33ms/step
Epoch 15/50
2083/2083 - 69s - loss: 3.1734 - accuracy100: 0.4293 - val_loss: 3.3270 - val_accuracy100: 0.3897 - 69s/epoch - 33ms/step
Epoch 16/50
2083/2083 - 69s - loss: 3.1703 - accuracy100: 0.4310 - val_loss: 3.3602 - val_accuracy100: 0.3912 - 69s/epoch - 33ms/step
Epoch 17/50
2083/2083 - 68s - loss: 3.1679 - accuracy100: 0.4313 - val_loss: 3.3125 - val_accuracy100: 0.3948 - 68s/epoch - 33ms/step
Epoch 18/50
2083/2083 - 69s - loss: 3.1637 - accuracy100: 0.4334 - val_loss: 3.3280 - val_accuracy100: 0.3939 - 69s/epoch - 33ms/step
Epoch 19/50
2083/2083 - 68s - loss: 3.1606 - accuracy100: 0.4354 - val_loss: 3.3044 - val_accuracy100: 0.3959 - 68s/epoch - 33ms/step
Epoch 20/50
2083/2083 - 69s - loss: 3.1574 - accuracy100: 0.4359 - val_loss: 3.2968 - val_accuracy100: 0.3989 - 69s/epoch - 33ms/step
Epoch 21/50
2083/2083 - 68s - loss: 3.1550 - accuracy100: 0.4370 - val_loss: 3.3192 - val_accuracy100: 0.3974 - 68s/epoch - 33ms/step
testing model: results/ATVI/W7/deepVOL_L3/h100
Evaluating performance on  test set...
6143/6143 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0721071
{'0': {'precision': 0.4090768768329637, 'recall': 0.21850083205144616, 'f1-score': 0.28485281327120116, 'support': 460909}, '1': {'precision': 0.4528690714424718, 'recall': 0.630479415048806, 'f1-score': 0.5271150157443716, 'support': 638549}, '2': {'precision': 0.3718568145700664, 'recall': 0.3437862017063952, 'f1-score': 0.3572709827445493, 'support': 473044}, 'accuracy': 0.42348245026079456, 'macro avg': {'precision': 0.4112675876151673, 'recall': 0.3975888162688824, 'f1-score': 0.38974627058670736, 'support': 1572502}, 'weighted avg': {'precision': 0.4156630274023218, 'recall': 0.42348245026079456, 'f1-score': 0.40501372097585975, 'support': 1572502}}
[[100709 232656 127544]
 [ 88792 402592 147165]
 [ 56685 253733 162626]]
Evaluating performance on  train set...
2083/2083 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0955755
{'0': {'precision': 0.4326559379772113, 'recall': 0.20551621776951964, 'f1-score': 0.2786640287198266, 'support': 179217}, '1': {'precision': 0.3821341002667818, 'recall': 0.5668138202362845, 'f1-score': 0.4565032169519784, 'support': 174874}, '2': {'precision': 0.40056916040890517, 'recall': 0.42197670913211927, 'f1-score': 0.4109943587303745, 'support': 179126}, 'accuracy': 0.3967240354302282, 'macro avg': {'precision': 0.4051197328842994, 'recall': 0.39810224904597447, 'f1-score': 0.3820538681340599, 'support': 533217}, 'weighted avg': {'precision': 0.40530772521116293, 'recall': 0.3967240354302282, 'f1-score': 0.38144254646471976, 'support': 533217}}
[[36832 80080 62305]
 [24946 99121 50807]
 [23352 80187 75587]]
Evaluating performance on  val set...
685/685 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.093539
{'0': {'precision': 0.4137039165777157, 'recall': 0.178101802757158, 'f1-score': 0.24900541154958117, 'support': 56580}, '1': {'precision': 0.39709885149040697, 'recall': 0.5937169137109581, 'f1-score': 0.4758993807433731, 'support': 60448}, '2': {'precision': 0.3904065390406539, 'recall': 0.4057958551896122, 'f1-score': 0.3979524717073418, 'support': 58145}, 'accuracy': 0.39709886797622923, 'macro avg': {'precision': 0.4004031023695922, 'recall': 0.39253819055257616, 'f1-score': 0.37428575466676534, 'support': 175173}, 'weighted avg': {'precision': 0.40024083156295837, 'recall': 0.39709886797622923, 'f1-score': 0.3767409270839348, 'support': 175173}}
[[10077 26595 19908]
 [ 7625 35889 16934]
 [ 6656 27894 23595]]
training model: results/ATVI/W7/deepVOL_L3/h200
Epoch 1/50
2083/2083 - 73s - loss: 3.2991 - accuracy200: 0.3546 - val_loss: 3.3014 - val_accuracy200: 0.3388 - 73s/epoch - 35ms/step
Epoch 2/50
2083/2083 - 68s - loss: 3.2927 - accuracy200: 0.3518 - val_loss: 3.2995 - val_accuracy200: 0.3409 - 68s/epoch - 33ms/step
Epoch 3/50
2083/2083 - 68s - loss: 3.2874 - accuracy200: 0.3579 - val_loss: 3.2956 - val_accuracy200: 0.3446 - 68s/epoch - 32ms/step
Epoch 4/50
2083/2083 - 68s - loss: 3.2801 - accuracy200: 0.3673 - val_loss: 3.2942 - val_accuracy200: 0.3505 - 68s/epoch - 33ms/step
Epoch 5/50
2083/2083 - 68s - loss: 3.2688 - accuracy200: 0.3774 - val_loss: 3.2881 - val_accuracy200: 0.3605 - 68s/epoch - 33ms/step
Epoch 6/50
2083/2083 - 69s - loss: 3.2592 - accuracy200: 0.3849 - val_loss: 3.2781 - val_accuracy200: 0.3702 - 69s/epoch - 33ms/step
Epoch 7/50
2083/2083 - 68s - loss: 3.2524 - accuracy200: 0.3898 - val_loss: 3.2793 - val_accuracy200: 0.3708 - 68s/epoch - 33ms/step
Epoch 8/50
2083/2083 - 68s - loss: 3.2475 - accuracy200: 0.3932 - val_loss: 3.2733 - val_accuracy200: 0.3739 - 68s/epoch - 33ms/step
Epoch 9/50
2083/2083 - 68s - loss: 3.2435 - accuracy200: 0.3954 - val_loss: 3.2815 - val_accuracy200: 0.3748 - 68s/epoch - 33ms/step
Epoch 10/50
2083/2083 - 68s - loss: 3.2377 - accuracy200: 0.3998 - val_loss: 3.2900 - val_accuracy200: 0.3735 - 68s/epoch - 33ms/step
Epoch 11/50
2083/2083 - 69s - loss: 3.2328 - accuracy200: 0.4022 - val_loss: 3.2905 - val_accuracy200: 0.3752 - 69s/epoch - 33ms/step
Epoch 12/50
2083/2083 - 69s - loss: 3.2287 - accuracy200: 0.4046 - val_loss: 3.2972 - val_accuracy200: 0.3749 - 69s/epoch - 33ms/step
Epoch 13/50
2083/2083 - 68s - loss: 3.2251 - accuracy200: 0.4052 - val_loss: 3.3074 - val_accuracy200: 0.3753 - 68s/epoch - 33ms/step
Epoch 14/50
2083/2083 - 68s - loss: 3.2204 - accuracy200: 0.4083 - val_loss: 3.3093 - val_accuracy200: 0.3752 - 68s/epoch - 33ms/step
Epoch 15/50
2083/2083 - 68s - loss: 3.2157 - accuracy200: 0.4114 - val_loss: 3.3080 - val_accuracy200: 0.3748 - 68s/epoch - 33ms/step
Epoch 16/50
2083/2083 - 68s - loss: 3.2122 - accuracy200: 0.4129 - val_loss: 3.3245 - val_accuracy200: 0.3743 - 68s/epoch - 32ms/step
Epoch 17/50
2083/2083 - 68s - loss: 3.2067 - accuracy200: 0.4158 - val_loss: 3.3363 - val_accuracy200: 0.3740 - 68s/epoch - 33ms/step
Epoch 18/50
2083/2083 - 74s - loss: 3.2045 - accuracy200: 0.4172 - val_loss: 3.3317 - val_accuracy200: 0.3759 - 74s/epoch - 35ms/step
testing model: results/ATVI/W7/deepVOL_L3/h200
Evaluating performance on  test set...
6143/6143 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0896225
{'0': {'precision': 0.3559598698481562, 'recall': 0.4061065396275444, 'f1-score': 0.3793832904661446, 'support': 484890}, '1': {'precision': 0.4109065372829418, 'recall': 0.2763478550586748, 'f1-score': 0.330454461908434, 'support': 582277}, '2': {'precision': 0.36310542263685636, 'recall': 0.45103149395945263, 'f1-score': 0.40232048909258916, 'support': 505335}, 'accuracy': 0.372495551674974, 'macro avg': {'precision': 0.37665727658931814, 'recall': 0.3778286295485573, 'f1-score': 0.37071941382238927, 'support': 1572502}, 'weighted avg': {'precision': 0.3786021803777469, 'recall': 0.372495551674974, 'f1-score': 0.3686366190862648, 'support': 1572502}}
[[196917 106114 181859]
 [203445 160911 217921]
 [152838 124575 227922]]
Evaluating performance on  train set...
2083/2083 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0891112
{'0': {'precision': 0.3900485564997097, 'recall': 0.3327011924390697, 'f1-score': 0.3590997300161869, 'support': 177703}, '1': {'precision': 0.3798200204865909, 'recall': 0.3152707954098024, 'f1-score': 0.3445482438635003, 'support': 175243}, '2': {'precision': 0.37774155305275636, 'recall': 0.4948937987807246, 'f1-score': 0.42845376767014604, 'support': 180271}, 'accuracy': 0.38180703165878055, 'macro avg': {'precision': 0.38253671001301903, 'recall': 0.38095526220986553, 'f1-score': 0.3773672471832778, 'support': 533217}, 'weighted avg': {'precision': 0.38252614975924065, 'recall': 0.38180703165878055, 'f1-score': 0.37776469312513056, 'support': 533217}}
[[59122 45127 73454]
 [46483 55249 73511]
 [45971 45085 89215]]
Evaluating performance on  val set...
685/685 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0908021
{'0': {'precision': 0.3690409663414005, 'recall': 0.3028058480150962, 'f1-score': 0.3326584583789439, 'support': 56703}, '1': {'precision': 0.3909291078520033, 'recall': 0.33392107472712007, 'f1-score': 0.36018330676713517, 'support': 59550}, '2': {'precision': 0.36786618840076624, 'recall': 0.4856245756958588, 'f1-score': 0.41862166333823453, 'support': 58920}, 'accuracy': 0.37487512344939006, 'macro avg': {'precision': 0.3759454208647233, 'recall': 0.374117166146025, 'f1-score': 0.3704878094947712, 'support': 175173}, 'weighted avg': {'precision': 0.3760866920565177, 'recall': 0.37487512344939006, 'f1-score': 0.3709295204588204, 'support': 175173}}
[[17170 15064 24469]
 [14966 19885 24699]
 [14390 15917 28613]]
training model: results/ATVI/W7/deepVOL_L3/h300
Epoch 1/50
2083/2083 - 72s - loss: 3.2837 - accuracy300: 0.3775 - val_loss: 3.3290 - val_accuracy300: 0.3293 - 72s/epoch - 35ms/step
Epoch 2/50
2083/2083 - 69s - loss: 3.2847 - accuracy300: 0.3699 - val_loss: 3.3286 - val_accuracy300: 0.3294 - 69s/epoch - 33ms/step
Epoch 3/50
2083/2083 - 68s - loss: 3.2804 - accuracy300: 0.3719 - val_loss: 3.3269 - val_accuracy300: 0.3297 - 68s/epoch - 33ms/step
Epoch 4/50
2083/2083 - 68s - loss: 3.2749 - accuracy300: 0.3741 - val_loss: 3.3310 - val_accuracy300: 0.3294 - 68s/epoch - 33ms/step
Epoch 5/50
2083/2083 - 69s - loss: 3.2656 - accuracy300: 0.3800 - val_loss: 3.3294 - val_accuracy300: 0.3296 - 69s/epoch - 33ms/step
Epoch 6/50
2083/2083 - 69s - loss: 3.2622 - accuracy300: 0.3824 - val_loss: 3.3335 - val_accuracy300: 0.3311 - 69s/epoch - 33ms/step
Epoch 7/50
2083/2083 - 68s - loss: 3.2585 - accuracy300: 0.3853 - val_loss: 3.3351 - val_accuracy300: 0.3294 - 68s/epoch - 33ms/step
Epoch 8/50
2083/2083 - 70s - loss: 3.2527 - accuracy300: 0.3880 - val_loss: 3.3384 - val_accuracy300: 0.3318 - 70s/epoch - 33ms/step
Epoch 9/50
2083/2083 - 69s - loss: 3.2467 - accuracy300: 0.3924 - val_loss: 3.3254 - val_accuracy300: 0.3346 - 69s/epoch - 33ms/step
Epoch 10/50
2083/2083 - 69s - loss: 3.2445 - accuracy300: 0.3914 - val_loss: 3.3296 - val_accuracy300: 0.3331 - 69s/epoch - 33ms/step
Epoch 11/50
2083/2083 - 69s - loss: 3.2394 - accuracy300: 0.3945 - val_loss: 3.3260 - val_accuracy300: 0.3358 - 69s/epoch - 33ms/step
Epoch 12/50
2083/2083 - 71s - loss: 3.2342 - accuracy300: 0.3983 - val_loss: 3.3184 - val_accuracy300: 0.3397 - 71s/epoch - 34ms/step
Epoch 13/50
2083/2083 - 72s - loss: 3.2315 - accuracy300: 0.3999 - val_loss: 3.3266 - val_accuracy300: 0.3389 - 72s/epoch - 35ms/step
Epoch 14/50
2083/2083 - 70s - loss: 3.2290 - accuracy300: 0.4017 - val_loss: 3.3225 - val_accuracy300: 0.3391 - 70s/epoch - 33ms/step
Epoch 15/50
2083/2083 - 69s - loss: 3.2253 - accuracy300: 0.4045 - val_loss: 3.3213 - val_accuracy300: 0.3440 - 69s/epoch - 33ms/step
Epoch 16/50
2083/2083 - 69s - loss: 3.2216 - accuracy300: 0.4061 - val_loss: 3.3123 - val_accuracy300: 0.3428 - 69s/epoch - 33ms/step
Epoch 17/50
2083/2083 - 68s - loss: 3.2168 - accuracy300: 0.4095 - val_loss: 3.3292 - val_accuracy300: 0.3390 - 68s/epoch - 33ms/step
Epoch 18/50
2083/2083 - 70s - loss: 3.2128 - accuracy300: 0.4110 - val_loss: 3.3258 - val_accuracy300: 0.3419 - 70s/epoch - 33ms/step
Epoch 19/50
2083/2083 - 68s - loss: 3.2105 - accuracy300: 0.4136 - val_loss: 3.3277 - val_accuracy300: 0.3433 - 68s/epoch - 33ms/step
Epoch 20/50
2083/2083 - 69s - loss: 3.2067 - accuracy300: 0.4159 - val_loss: 3.3335 - val_accuracy300: 0.3433 - 69s/epoch - 33ms/step
Epoch 21/50
2083/2083 - 69s - loss: 3.2021 - accuracy300: 0.4181 - val_loss: 3.3269 - val_accuracy300: 0.3425 - 69s/epoch - 33ms/step
Epoch 22/50
2083/2083 - 68s - loss: 3.2002 - accuracy300: 0.4195 - val_loss: 3.3323 - val_accuracy300: 0.3426 - 68s/epoch - 33ms/step
Epoch 23/50
2083/2083 - 68s - loss: 3.1958 - accuracy300: 0.4213 - val_loss: 3.3470 - val_accuracy300: 0.3427 - 68s/epoch - 33ms/step
Epoch 24/50
2083/2083 - 70s - loss: 3.1940 - accuracy300: 0.4227 - val_loss: 3.3516 - val_accuracy300: 0.3427 - 70s/epoch - 33ms/step
Epoch 25/50
2083/2083 - 68s - loss: 3.1906 - accuracy300: 0.4242 - val_loss: 3.3533 - val_accuracy300: 0.3391 - 68s/epoch - 33ms/step
Epoch 26/50
2083/2083 - 69s - loss: 3.1883 - accuracy300: 0.4254 - val_loss: 3.3521 - val_accuracy300: 0.3426 - 69s/epoch - 33ms/step
testing model: results/ATVI/W7/deepVOL_L3/h300
Evaluating performance on  test set...
6143/6143 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.104126
{'0': {'precision': 0.28077461667627274, 'recall': 0.3097191778463798, 'f1-score': 0.29453750147334234, 'support': 435685}, '1': {'precision': 0.45213838337679096, 'recall': 0.09836616835410651, 'f1-score': 0.1615794826718733, 'support': 683975}, '2': {'precision': 0.3122461162613893, 'recall': 0.6502908299141864, 'f1-score': 0.4219075161486051, 'support': 452842}, 'accuracy': 0.315865417023317, 'macro avg': {'precision': 0.3483863721048177, 'recall': 0.3527920587048909, 'f1-score': 0.2926748334312736, 'support': 1572502}, 'weighted avg': {'precision': 0.3643739692647656, 'recall': 0.315865417023317, 'f1-score': 0.2733855609834991, 'support': 1572502}}
[[134940  39161 261584]
 [229659  67280 387036]
 [116000  42363 294479]]
Evaluating performance on  train set...
2083/2083 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1005449
{'0': {'precision': 0.36605261226501146, 'recall': 0.1969348269987929, 'f1-score': 0.25609277522473123, 'support': 177282}, '1': {'precision': 0.363965613308923, 'recall': 0.10365895128199315, 'f1-score': 0.16136147086847585, 'support': 176444}, '2': {'precision': 0.35543670082665096, 'recall': 0.7675203770662596, 'f1-score': 0.4858688119292021, 'support': 179491}, 'accuracy': 0.3581393691498958, 'macro avg': {'precision': 0.36181830880019517, 'recall': 0.35603805178234854, 'f1-score': 0.30110768600746973, 'support': 533217}, 'weighted avg': {'precision': 0.3617884965226574, 'recall': 0.3581393691498958, 'f1-score': 0.30209273460015823, 'support': 533217}}
[[ 34913  16014 126355]
 [ 34684  18290 123470]
 [ 25780  15948 137763]]
Evaluating performance on  val set...
685/685 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033117
{'0': {'precision': 0.32239906181940026, 'recall': 0.17472625251956636, 'f1-score': 0.22662929552252867, 'support': 55069}, '1': {'precision': 0.3818877694602353, 'recall': 0.10872177800567244, 'f1-score': 0.1692568663157632, 'support': 62407}, '2': {'precision': 0.34139744906358527, 'recall': 0.754787943913895, 'f1-score': 0.47014433924580856, 'support': 57697}, 'accuracy': 0.34226735855411505, 'macro avg': {'precision': 0.34856142678107355, 'recall': 0.34607865814637795, 'f1-score': 0.28867683369470015, 'support': 175173}, 'weighted avg': {'precision': 0.34984999162347585, 'recall': 0.34226735855411505, 'f1-score': 0.28639676133173136, 'support': 175173}}
[[ 9622  5249 40198]
 [11808  6785 43814]
 [ 8415  5733 43549]]
training model: results/ATVI/W7/deepVOL_L3/h500
Epoch 1/50
2083/2083 - 74s - loss: 3.2541 - accuracy500: 0.3946 - val_loss: 3.3942 - val_accuracy500: 0.3463 - 74s/epoch - 35ms/step
Epoch 2/50
2083/2083 - 72s - loss: 3.2775 - accuracy500: 0.3775 - val_loss: 3.3808 - val_accuracy500: 0.3463 - 72s/epoch - 35ms/step
Epoch 3/50
2083/2083 - 69s - loss: 3.2642 - accuracy500: 0.3863 - val_loss: 3.3921 - val_accuracy500: 0.3458 - 69s/epoch - 33ms/step
Epoch 4/50
2083/2083 - 74s - loss: 3.2498 - accuracy500: 0.3944 - val_loss: 3.4073 - val_accuracy500: 0.3464 - 74s/epoch - 36ms/step
Epoch 5/50
2083/2083 - 71s - loss: 3.2316 - accuracy500: 0.4012 - val_loss: 3.4089 - val_accuracy500: 0.3462 - 71s/epoch - 34ms/step
Epoch 6/50
2083/2083 - 68s - loss: 3.2204 - accuracy500: 0.4095 - val_loss: 3.4091 - val_accuracy500: 0.3441 - 68s/epoch - 33ms/step
Epoch 7/50
2083/2083 - 74s - loss: 3.2156 - accuracy500: 0.4122 - val_loss: 3.4199 - val_accuracy500: 0.3423 - 74s/epoch - 35ms/step
Epoch 8/50
2083/2083 - 69s - loss: 3.2062 - accuracy500: 0.4175 - val_loss: 3.4236 - val_accuracy500: 0.3409 - 69s/epoch - 33ms/step
Epoch 9/50
2083/2083 - 68s - loss: 3.2006 - accuracy500: 0.4216 - val_loss: 3.4179 - val_accuracy500: 0.3440 - 68s/epoch - 33ms/step
Epoch 10/50
2083/2083 - 69s - loss: 3.1937 - accuracy500: 0.4232 - val_loss: 3.4249 - val_accuracy500: 0.3419 - 69s/epoch - 33ms/step
Epoch 11/50
2083/2083 - 69s - loss: 3.1904 - accuracy500: 0.4245 - val_loss: 3.4279 - val_accuracy500: 0.3404 - 69s/epoch - 33ms/step
Epoch 12/50
2083/2083 - 69s - loss: 3.1850 - accuracy500: 0.4281 - val_loss: 3.4211 - val_accuracy500: 0.3434 - 69s/epoch - 33ms/step
testing model: results/ATVI/W7/deepVOL_L3/h500
Evaluating performance on  test set...
6143/6143 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.180366
{'0': {'precision': 0.2376165501165501, 'recall': 0.0037251305851264283, 'f1-score': 0.007335265717864363, 'support': 437837}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 678744}, '2': {'precision': 0.2900474375605584, 'recall': 0.9960256272468256, 'f1-score': 0.44926635792789527, 'support': 455921}, 'accuracy': 0.28981839132796017, 'macro avg': {'precision': 0.1758879958923695, 'recall': 0.3332502526106507, 'f1-score': 0.1522005412152532, 'support': 1572502}, 'weighted avg': {'precision': 0.15025483925198652, 'recall': 0.28981839132796017, 'f1-score': 0.13229974773256664, 'support': 1572502}}
[[  1631      1 436205]
 [  3421      0 675323]
 [  1812      0 454109]]
Evaluating performance on  train set...
2083/2083 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1343501
{'0': {'precision': 0.32972972972972975, 'recall': 0.004132231404958678, 'f1-score': 0.008162173011306617, 'support': 177144}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 178691}, '2': {'precision': 0.33285184822484537, 'recall': 0.9963976051685064, 'f1-score': 0.49900759199184613, 'support': 177382}, 'accuracy': 0.3328382253379018, 'macro avg': {'precision': 0.2208605259848584, 'recall': 0.33350994552448837, 'f1-score': 0.16905658833438428, 'support': 533217}, 'weighted avg': {'precision': 0.22026973968396127, 'recall': 0.3328382253379018, 'f1-score': 0.1687133843418581, 'support': 533217}}
[[   732      1 176411]
 [   849      0 177842]
 [   639      0 176743]]
Evaluating performance on  val set...
685/685 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1276338
{'0': {'precision': 0.33076923076923076, 'recall': 0.0045000261629428075, 'f1-score': 0.008879252490836818, 'support': 57333}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 57138}, '2': {'precision': 0.34652767026199444, 'recall': 0.9955520411189087, 'f1-score': 0.5141070631021502, 'support': 60702}, 'accuracy': 0.3464575020122964, 'macro avg': {'precision': 0.22576563367707506, 'recall': 0.33335068909395055, 'f1-score': 0.17432877186432896, 'support': 175173}, 'weighted avg': {'precision': 0.22833949836981662, 'recall': 0.3464575020122964, 'f1-score': 0.18105758951141937, 'support': 175173}}
[[  258     0 57075]
 [  252     0 56886]
 [  270     0 60432]]
training model: results/ATVI/W7/deepVOL_L3/h1000
Epoch 1/50
2083/2083 - 73s - loss: 3.2796 - accuracy1000: 0.3782 - val_loss: 3.3150 - val_accuracy1000: 0.3364 - 73s/epoch - 35ms/step
Epoch 2/50
2083/2083 - 70s - loss: 3.2904 - accuracy1000: 0.3632 - val_loss: 3.3098 - val_accuracy1000: 0.3363 - 70s/epoch - 33ms/step
Epoch 3/50
2083/2083 - 69s - loss: 3.2943 - accuracy1000: 0.3577 - val_loss: 3.3088 - val_accuracy1000: 0.3364 - 69s/epoch - 33ms/step
Epoch 4/50
2083/2083 - 70s - loss: 3.2899 - accuracy1000: 0.3601 - val_loss: 3.3097 - val_accuracy1000: 0.3361 - 70s/epoch - 33ms/step
Epoch 5/50
2083/2083 - 70s - loss: 3.2856 - accuracy1000: 0.3608 - val_loss: 3.2955 - val_accuracy1000: 0.3431 - 70s/epoch - 34ms/step
Epoch 6/50
2083/2083 - 70s - loss: 3.2909 - accuracy1000: 0.3597 - val_loss: 3.3057 - val_accuracy1000: 0.3397 - 70s/epoch - 34ms/step
Epoch 7/50
2083/2083 - 70s - loss: 3.2819 - accuracy1000: 0.3688 - val_loss: 3.3120 - val_accuracy1000: 0.3378 - 70s/epoch - 33ms/step
Epoch 8/50
2083/2083 - 70s - loss: 3.2665 - accuracy1000: 0.3832 - val_loss: 3.3022 - val_accuracy1000: 0.3446 - 70s/epoch - 34ms/step
Epoch 9/50
2083/2083 - 71s - loss: 3.2533 - accuracy1000: 0.3951 - val_loss: 3.3234 - val_accuracy1000: 0.3275 - 71s/epoch - 34ms/step
Epoch 10/50
2083/2083 - 70s - loss: 3.2408 - accuracy1000: 0.4038 - val_loss: 3.3299 - val_accuracy1000: 0.3350 - 70s/epoch - 33ms/step
Epoch 11/50
2083/2083 - 69s - loss: 3.2218 - accuracy1000: 0.4124 - val_loss: 3.3277 - val_accuracy1000: 0.3360 - 69s/epoch - 33ms/step
Epoch 12/50
2083/2083 - 69s - loss: 3.2082 - accuracy1000: 0.4172 - val_loss: 3.3148 - val_accuracy1000: 0.3545 - 69s/epoch - 33ms/step
Epoch 13/50
2083/2083 - 70s - loss: 3.1910 - accuracy1000: 0.4270 - val_loss: 3.3641 - val_accuracy1000: 0.3535 - 70s/epoch - 33ms/step
Epoch 14/50
2083/2083 - 70s - loss: 3.1819 - accuracy1000: 0.4315 - val_loss: 3.3492 - val_accuracy1000: 0.3349 - 70s/epoch - 33ms/step
Epoch 15/50
2083/2083 - 70s - loss: 3.1688 - accuracy1000: 0.4372 - val_loss: 3.3638 - val_accuracy1000: 0.3431 - 70s/epoch - 34ms/step
testing model: results/ATVI/W7/deepVOL_L3/h1000
Evaluating performance on  test set...
6143/6143 - 92s - 92s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999274
{'0': {'precision': 0.3067608476286579, 'recall': 0.0006316082532915308, 'f1-score': 0.0012606209387479215, 'support': 481311}, '1': {'precision': 0.3963193235513554, 'recall': 0.06813109763918222, 'f1-score': 0.11627363997198226, 'support': 584755}, '2': {'precision': 0.32236540660482155, 'recall': 0.9363374641613156, 'f1-score': 0.4796093094948878, 'support': 506436}, 'accuracy': 0.3270832087971907, 'macro avg': {'precision': 0.3418151925949449, 'recall': 0.3350333900179298, 'f1-score': 0.19904785680187265, 'support': 1572502}, 'weighted avg': {'precision': 0.3450898780641228, 'recall': 0.3270832087971907, 'f1-score': 0.19808544811378248, 'support': 1572502}}
[[   304  28830 452177]
 [   301  39840 544614]
 [   386  31855 474195]]
Evaluating performance on  train set...
2083/2083 - 34s - 34s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1018342
{'0': {'precision': 0.37755102040816324, 'recall': 0.00041537563428981994, 'f1-score': 0.0008298382936730436, 'support': 178152}, '1': {'precision': 0.36595118518281566, 'recall': 0.06469453885348157, 'f1-score': 0.10995136766430232, 'support': 176831}, '2': {'precision': 0.33559869260204084, 'recall': 0.9447692359482478, 'f1-score': 0.4952690759036109, 'support': 178234}, 'accuracy': 0.33739359397768637, 'macro avg': {'precision': 0.35970029939767323, 'recall': 0.3366263834786731, 'f1-score': 0.20201676062052876, 'support': 533217}, 'weighted avg': {'precision': 0.35968110692654154, 'recall': 0.33739359397768637, 'f1-score': 0.20228994222191876, 'support': 533217}}
[[    74  10041 168037]
 [    58  11440 165333]
 [    64   9780 168390]]
Evaluating performance on  val set...
685/685 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983933
{'0': {'precision': 0.2647058823529412, 'recall': 0.0003282754595856434, 'f1-score': 0.0006557377049180328, 'support': 54832}, '1': {'precision': 0.40408057404685743, 'recall': 0.0760927960927961, 'f1-score': 0.1280688294607628, 'support': 61425}, '2': {'precision': 0.338679695239027, 'recall': 0.9401011609749473, 'f1-score': 0.49796362394023036, 'support': 58916}, 'accuracy': 0.3429695215586877, 'macro avg': {'precision': 0.33582205054627523, 'recall': 0.33884074417577636, 'f1-score': 0.20889606370197042, 'support': 175173}, 'weighted avg': {'precision': 0.33845772537267277, 'recall': 0.3429695215586877, 'f1-score': 0.21259331134093745, 'support': 175173}}
[[   18  3389 51425]
 [   25  4674 56726]
 [   25  3504 55387]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        26 (peak)  17.81 (ave)

============================================
