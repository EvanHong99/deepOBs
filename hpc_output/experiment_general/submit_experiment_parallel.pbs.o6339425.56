This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAL_orderbooks/AAL_orderbooks_2019-07-31.csv
data/AAL_orderbooks/AAL_orderbooks_2019-07-23.csv
data/AAL_orderbooks/AAL_orderbooks_2019-07-10.csv
data/AAL_orderbooks/AAL_orderbooks_2019-07-11.csv
data/AAL_orderbooks/AAL_orderbooks_2019-07-19.csv
data/AAL_orderbooks/AAL_orderbooks_2019-07-15.csv
data/AAL_orderbooks/AAL_orderbooks_2019-07-17.csv
data/AAL_orderbooks/AAL_orderbooks_2019-07-12.csv
data/AAL_orderbooks/AAL_orderbooks_2019-08-02.csv
data/AAL_orderbooks/AAL_orderbooks_2019-07-16.csv
data/AAL_orderbooks/AAL_orderbooks_2019-07-29.csv
data/AAL_orderbooks/AAL_orderbooks_2019-07-18.csv
data/AAL_orderbooks/AAL_orderbooks_2019-07-09.csv
data/AAL_orderbooks/AAL_orderbooks_2019-07-25.csv
data/AAL_orderbooks/AAL_orderbooks_2019-07-24.csv
training model: results/AAL/W5/deepLOB_L1/h10
Epoch 1/50
1701/1701 - 58s - loss: 2.9284 - accuracy10: 0.4382 - val_loss: 3.1388 - val_accuracy10: 0.5440 - 58s/epoch - 34ms/step
Epoch 2/50
1701/1701 - 49s - loss: 2.8373 - accuracy10: 0.4523 - val_loss: 2.9418 - val_accuracy10: 0.4836 - 49s/epoch - 29ms/step
Epoch 3/50
1701/1701 - 50s - loss: 2.7282 - accuracy10: 0.5088 - val_loss: 3.0373 - val_accuracy10: 0.3801 - 50s/epoch - 29ms/step
Epoch 4/50
1701/1701 - 49s - loss: 2.6464 - accuracy10: 0.5433 - val_loss: 3.0470 - val_accuracy10: 0.4599 - 49s/epoch - 29ms/step
Epoch 5/50
1701/1701 - 44s - loss: 2.5941 - accuracy10: 0.5625 - val_loss: 3.0546 - val_accuracy10: 0.5529 - 44s/epoch - 26ms/step
Epoch 6/50
1701/1701 - 46s - loss: 2.5535 - accuracy10: 0.5757 - val_loss: 3.0967 - val_accuracy10: 0.5691 - 46s/epoch - 27ms/step
Epoch 7/50
1701/1701 - 45s - loss: 2.5281 - accuracy10: 0.5835 - val_loss: 3.1614 - val_accuracy10: 0.5538 - 45s/epoch - 26ms/step
Epoch 8/50
1701/1701 - 46s - loss: 2.5062 - accuracy10: 0.5895 - val_loss: 3.1976 - val_accuracy10: 0.5339 - 46s/epoch - 27ms/step
Epoch 9/50
1701/1701 - 46s - loss: 2.4891 - accuracy10: 0.5932 - val_loss: 3.1757 - val_accuracy10: 0.5957 - 46s/epoch - 27ms/step
Epoch 10/50
1701/1701 - 46s - loss: 2.4714 - accuracy10: 0.5964 - val_loss: 3.2912 - val_accuracy10: 0.5659 - 46s/epoch - 27ms/step
Epoch 11/50
1701/1701 - 44s - loss: 2.4610 - accuracy10: 0.5990 - val_loss: 3.2759 - val_accuracy10: 0.6003 - 44s/epoch - 26ms/step
Epoch 12/50
1701/1701 - 48s - loss: 2.4479 - accuracy10: 0.6006 - val_loss: 3.3542 - val_accuracy10: 0.6087 - 48s/epoch - 28ms/step
testing model: results/AAL/W5/deepLOB_L1/h10
Evaluating performance on  test set...
6357/6357 - 105s - 105s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98315835
{'0': {'precision': 0.2818960297552115, 'recall': 0.3666983529594351, 'f1-score': 0.3187533305003002, 'support': 257735}, '1': {'precision': 0.7196527377139618, 'recall': 0.5152249694741419, 'f1-score': 0.6005178612624817, 'support': 1106439}, '2': {'precision': 0.26563897543025566, 'recall': 0.5047852620772258, 'f1-score': 0.348095590201847, 'support': 262995}, 'accuracy': 0.4900117934891827, 'macro avg': {'precision': 0.42239591429980966, 'recall': 0.4622361948369343, 'f1-score': 0.4224555939882097, 'support': 1627169}, 'weighted avg': {'precision': 0.5769333431473546, 'recall': 0.4900117934891827, 'f1-score': 0.5150895028598927, 'support': 1627169}}
[[ 94511 115493  47731]
 [217100 570065 319274]
 [ 23658 106581 132756]]
Evaluating performance on  train set...
1701/1701 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.018567
{'0': {'precision': 0.2776727017050448, 'recall': 0.5849886681775763, 'f1-score': 0.3765913013626785, 'support': 67509}, '1': {'precision': 0.7824857505685007, 'recall': 0.356113705856658, 'f1-score': 0.4894678261833397, 'support': 297610}, '2': {'precision': 0.2709304020944665, 'recall': 0.6079602839300702, 'f1-score': 0.3748245983301761, 'support': 70299}, 'accuracy': 0.4322604945133182, 'macro avg': {'precision': 0.4436962847893373, 'recall': 0.5163542193214349, 'f1-score': 0.41362790862539817, 'support': 435418}, 'weighted avg': {'precision': 0.6216259479004915, 'recall': 0.4322604945133182, 'f1-score': 0.4534576346226611, 'support': 435418}}
[[ 39492  13163  14854]
 [ 91471 105983 100156]
 [ 11262  16298  42739]]
Evaluating performance on  val set...
563/563 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.976709
{'0': {'precision': 0.27982516106312016, 'recall': 0.6061204343534057, 'f1-score': 0.3828852449722927, 'support': 22286}, '1': {'precision': 0.7532600233553912, 'recall': 0.4684870982710271, 'f1-score': 0.5776851794265813, 'support': 99134}, '2': {'precision': 0.28581892762965133, 'recall': 0.4308935907063033, 'f1-score': 0.3436734837675492, 'support': 22639}, 'accuracy': 0.48387119166452636, 'macro avg': {'precision': 0.4396347040160542, 'recall': 0.501833707776912, 'f1-score': 0.4347479693888077, 'support': 144059}, 'weighted avg': {'precision': 0.6065606272247741, 'recall': 0.48387119166452636, 'f1-score': 0.5107743851181862, 'support': 144059}}
[[13508  6102  2676]
 [30992 46443 21699]
 [ 3773  9111  9755]]
training model: results/AAL/W5/deepLOB_L1/h20
Epoch 1/50
1701/1701 - 47s - loss: 2.9883 - accuracy20: 0.4585 - val_loss: 3.2177 - val_accuracy20: 0.3507 - 47s/epoch - 27ms/step
Epoch 2/50
1701/1701 - 45s - loss: 2.9330 - accuracy20: 0.4496 - val_loss: 3.2846 - val_accuracy20: 0.4490 - 45s/epoch - 26ms/step
Epoch 3/50
1701/1701 - 45s - loss: 2.8801 - accuracy20: 0.4727 - val_loss: 3.2644 - val_accuracy20: 0.5355 - 45s/epoch - 26ms/step
Epoch 4/50
1701/1701 - 49s - loss: 2.8171 - accuracy20: 0.5002 - val_loss: 3.4315 - val_accuracy20: 0.5758 - 49s/epoch - 29ms/step
Epoch 5/50
1701/1701 - 45s - loss: 2.7503 - accuracy20: 0.5365 - val_loss: 3.4039 - val_accuracy20: 0.5570 - 45s/epoch - 27ms/step
Epoch 6/50
1701/1701 - 45s - loss: 2.7016 - accuracy20: 0.5541 - val_loss: 3.4840 - val_accuracy20: 0.5619 - 45s/epoch - 26ms/step
Epoch 7/50
1701/1701 - 47s - loss: 2.6747 - accuracy20: 0.5611 - val_loss: 3.4833 - val_accuracy20: 0.5374 - 47s/epoch - 28ms/step
Epoch 8/50
1701/1701 - 47s - loss: 2.6492 - accuracy20: 0.5682 - val_loss: 3.5565 - val_accuracy20: 0.5563 - 47s/epoch - 28ms/step
Epoch 9/50
1701/1701 - 45s - loss: 2.6264 - accuracy20: 0.5747 - val_loss: 3.4796 - val_accuracy20: 0.5449 - 45s/epoch - 27ms/step
Epoch 10/50
1701/1701 - 45s - loss: 2.6087 - accuracy20: 0.5786 - val_loss: 3.4090 - val_accuracy20: 0.4736 - 45s/epoch - 27ms/step
Epoch 11/50
1701/1701 - 45s - loss: 2.5963 - accuracy20: 0.5811 - val_loss: 3.3139 - val_accuracy20: 0.3341 - 45s/epoch - 26ms/step
testing model: results/AAL/W5/deepLOB_L1/h20
Evaluating performance on  test set...
6357/6357 - 95s - 95s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0689692
{'0': {'precision': 0.2503839165832665, 'recall': 0.5370690700280609, 'f1-score': 0.3415402811742263, 'support': 338193}, '1': {'precision': 0.5950705085905614, 'recall': 0.30873057635371165, 'f1-score': 0.40654180250201405, 'support': 946398}, '2': {'precision': 0.28979639534798796, 'recall': 0.34746247569896493, 'f1-score': 0.316020309959181, 'support': 342578}, 'accuracy': 0.36434322433625516, 'macro avg': {'precision': 0.3784169401739386, 'recall': 0.3977540406935791, 'f1-score': 0.35470079787847375, 'support': 1627169}, 'weighted avg': {'precision': 0.45915912644332446, 'recall': 0.36434322433625516, 'f1-score': 0.37397374634143876, 'support': 1627169}}
[[181633  94139  62421]
 [424923 292182 229293]
 [118862 104683 119033]]
Evaluating performance on  train set...
1701/1701 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0280676
{'0': {'precision': 0.2622403039688212, 'recall': 0.4837779054960163, 'f1-score': 0.3401151966027301, 'support': 88737}, '1': {'precision': 0.6003567156753782, 'recall': 0.44377459763549726, 'f1-score': 0.5103248155479576, 'support': 255614}, '2': {'precision': 0.3210907201797731, 'recall': 0.2918400737918236, 'f1-score': 0.30576743864977735, 'support': 91067}, 'accuracy': 0.4201502923627411, 'macro avg': {'precision': 0.39456257994132415, 'recall': 0.406464192307779, 'f1-score': 0.385402483600155, 'support': 435418}, 'weighted avg': {'precision': 0.4730414635787652, 'recall': 0.4201502923627411, 'f1-score': 0.43285370135807744, 'support': 435418}}
[[ 42929  35897   9911]
 [ 95896 113435  46283]
 [ 24876  39614  26577]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0699525
{'0': {'precision': 0.24481173621050314, 'recall': 0.599683117583603, 'f1-score': 0.3476858728793683, 'support': 29664}, '1': {'precision': 0.5860627707272589, 'recall': 0.2734105412432049, 'f1-score': 0.3728696100630957, 'support': 84620}, '2': {'precision': 0.2987029262485118, 'recall': 0.32020151133501257, 'f1-score': 0.30907882579871293, 'support': 29775}, 'accuracy': 0.3502662103721392, 'macro avg': {'precision': 0.37652581106209126, 'recall': 0.3977650567206068, 'f1-score': 0.343211436247059, 'support': 144059}, 'weighted avg': {'precision': 0.45640054860118734, 'recall': 0.3502662103721392, 'f1-score': 0.3544992133416824, 'support': 144059}}
[[17789  7777  4098]
 [43198 23136 18286]
 [11677  8564  9534]]
training model: results/AAL/W5/deepLOB_L1/h30
Epoch 1/50
1701/1701 - 48s - loss: 3.0371 - accuracy30: 0.4519 - val_loss: 3.4962 - val_accuracy30: 0.3774 - 48s/epoch - 28ms/step
Epoch 2/50
1701/1701 - 45s - loss: 3.0031 - accuracy30: 0.4478 - val_loss: 3.2469 - val_accuracy30: 0.3745 - 45s/epoch - 26ms/step
Epoch 3/50
1701/1701 - 47s - loss: 2.9349 - accuracy30: 0.4802 - val_loss: 3.2080 - val_accuracy30: 0.4259 - 47s/epoch - 27ms/step
Epoch 4/50
1701/1701 - 44s - loss: 2.8698 - accuracy30: 0.5076 - val_loss: 3.3801 - val_accuracy30: 0.4990 - 44s/epoch - 26ms/step
Epoch 5/50
1701/1701 - 46s - loss: 2.8094 - accuracy30: 0.5329 - val_loss: 3.4968 - val_accuracy30: 0.5151 - 46s/epoch - 27ms/step
Epoch 6/50
1701/1701 - 47s - loss: 2.7801 - accuracy30: 0.5428 - val_loss: 3.4271 - val_accuracy30: 0.5130 - 47s/epoch - 28ms/step
Epoch 7/50
1701/1701 - 47s - loss: 2.7506 - accuracy30: 0.5511 - val_loss: 3.3624 - val_accuracy30: 0.5042 - 47s/epoch - 28ms/step
Epoch 8/50
1701/1701 - 49s - loss: 2.7331 - accuracy30: 0.5559 - val_loss: 3.3216 - val_accuracy30: 0.4981 - 49s/epoch - 29ms/step
Epoch 9/50
1701/1701 - 47s - loss: 2.7163 - accuracy30: 0.5595 - val_loss: 3.2897 - val_accuracy30: 0.5083 - 47s/epoch - 28ms/step
Epoch 10/50
1701/1701 - 50s - loss: 2.7000 - accuracy30: 0.5632 - val_loss: 3.2655 - val_accuracy30: 0.5141 - 50s/epoch - 29ms/step
Epoch 11/50
1701/1701 - 50s - loss: 2.6866 - accuracy30: 0.5665 - val_loss: 3.4339 - val_accuracy30: 0.5208 - 50s/epoch - 29ms/step
Epoch 12/50
1701/1701 - 50s - loss: 2.6737 - accuracy30: 0.5683 - val_loss: 3.3465 - val_accuracy30: 0.5251 - 50s/epoch - 29ms/step
Epoch 13/50
1701/1701 - 50s - loss: 2.6636 - accuracy30: 0.5712 - val_loss: 3.3132 - val_accuracy30: 0.5188 - 50s/epoch - 30ms/step
testing model: results/AAL/W5/deepLOB_L1/h30
Evaluating performance on  test set...
6357/6357 - 102s - 102s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0619761
{'0': {'precision': 0.4318178091849617, 'recall': 0.0663188350326218, 'f1-score': 0.11497911018558536, 'support': 397127}, '1': {'precision': 0.5229009466685166, 'recall': 0.47195511083817987, 'f1-score': 0.4961235796479388, 'support': 830490}, '2': {'precision': 0.3174508512102591, 'recall': 0.6488041606599392, 'f1-score': 0.4263127860451884, 'support': 399552}, 'accuracy': 0.41638084304703443, 'macro avg': {'precision': 0.42405653568791246, 'recall': 0.3956927021769136, 'f1-score': 0.34580515862623756, 'support': 1627169}, 'weighted avg': {'precision': 0.4502228353721673, 'recall': 0.41638084304703443, 'f1-score': 0.3859593607316848, 'support': 1627169}}
[[ 26337 223883 146907]
 [ 28072 391954 410464]
 [  6582 133739 259231]]
Evaluating performance on  train set...
1701/1701 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0370908
{'0': {'precision': 0.4034814517869808, 'recall': 0.2525892107371408, 'f1-score': 0.3106831848320976, 'support': 103603}, '1': {'precision': 0.5590683215972904, 'recall': 0.44359134166987135, 'f1-score': 0.49468005136332166, 'support': 226233}, '2': {'precision': 0.33630453898333473, 'recall': 0.6085601712413101, 'f1-score': 0.4332081526979012, 'support': 105582}, 'accuracy': 0.43814679227776526, 'macro avg': {'precision': 0.43295143745586867, 'recall': 0.4349135745494408, 'f1-score': 0.4128571296311068, 'support': 435418}, 'weighted avg': {'precision': 0.4680314049587863, 'recall': 0.43814679227776526, 'f1-score': 0.43599402237938706, 'support': 435418}}
[[ 26169  45943  31491]
 [ 30566 100355  95312]
 [  8123  33206  64253]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0547371
{'0': {'precision': 0.4075128454381336, 'recall': 0.1682722633178508, 'f1-score': 0.23818993506493508, 'support': 34878}, '1': {'precision': 0.5251359314723125, 'recall': 0.4649811726734804, 'f1-score': 0.4932311949900858, 'support': 74360}, '2': {'precision': 0.32714878946956044, 'recall': 0.599551994486086, 'f1-score': 0.42331400300093264, 'support': 34821}, 'accuracy': 0.42567281461068035, 'macro avg': {'precision': 0.4199325221266688, 'recall': 0.4109351434924724, 'f1-score': 0.3849117110186511, 'support': 144059}, 'weighted avg': {'precision': 0.4488021497136031, 'recall': 0.42567281461068035, 'f1-score': 0.4145834492336686, 'support': 144059}}
[[ 5869 19023  9986]
 [ 6832 34576 32952]
 [ 1701 12243 20877]]
training model: results/AAL/W5/deepLOB_L1/h50
Epoch 1/50
1701/1701 - 48s - loss: 3.1122 - accuracy50: 0.4414 - val_loss: 3.3086 - val_accuracy50: 0.3528 - 48s/epoch - 28ms/step
Epoch 2/50
1701/1701 - 44s - loss: 3.1075 - accuracy50: 0.4315 - val_loss: 3.3416 - val_accuracy50: 0.3411 - 44s/epoch - 26ms/step
Epoch 3/50
1701/1701 - 45s - loss: 3.0705 - accuracy50: 0.4523 - val_loss: 3.2203 - val_accuracy50: 0.3872 - 45s/epoch - 27ms/step
Epoch 4/50
1701/1701 - 46s - loss: 3.0277 - accuracy50: 0.4726 - val_loss: 3.2746 - val_accuracy50: 0.3694 - 46s/epoch - 27ms/step
Epoch 5/50
1701/1701 - 46s - loss: 2.9851 - accuracy50: 0.4898 - val_loss: 3.1794 - val_accuracy50: 0.4207 - 46s/epoch - 27ms/step
Epoch 6/50
1701/1701 - 45s - loss: 2.9490 - accuracy50: 0.5028 - val_loss: 3.1953 - val_accuracy50: 0.4095 - 45s/epoch - 27ms/step
Epoch 7/50
1701/1701 - 46s - loss: 2.9216 - accuracy50: 0.5120 - val_loss: 3.2538 - val_accuracy50: 0.4173 - 46s/epoch - 27ms/step
Epoch 8/50
1701/1701 - 46s - loss: 2.9019 - accuracy50: 0.5180 - val_loss: 3.3125 - val_accuracy50: 0.4026 - 46s/epoch - 27ms/step
Epoch 9/50
1701/1701 - 50s - loss: 2.8782 - accuracy50: 0.5254 - val_loss: 3.3517 - val_accuracy50: 0.4256 - 50s/epoch - 29ms/step
Epoch 10/50
1701/1701 - 49s - loss: 2.8634 - accuracy50: 0.5284 - val_loss: 3.3783 - val_accuracy50: 0.4350 - 49s/epoch - 29ms/step
Epoch 11/50
1701/1701 - 49s - loss: 2.8460 - accuracy50: 0.5319 - val_loss: 3.3728 - val_accuracy50: 0.4344 - 49s/epoch - 29ms/step
Epoch 12/50
1701/1701 - 47s - loss: 2.8354 - accuracy50: 0.5345 - val_loss: 3.4574 - val_accuracy50: 0.4241 - 47s/epoch - 28ms/step
Epoch 13/50
1701/1701 - 44s - loss: 2.8248 - accuracy50: 0.5367 - val_loss: 3.5805 - val_accuracy50: 0.4108 - 44s/epoch - 26ms/step
Epoch 14/50
1701/1701 - 44s - loss: 2.8139 - accuracy50: 0.5394 - val_loss: 3.7126 - val_accuracy50: 0.3960 - 44s/epoch - 26ms/step
Epoch 15/50
1701/1701 - 43s - loss: 2.8057 - accuracy50: 0.5403 - val_loss: 3.6601 - val_accuracy50: 0.4060 - 43s/epoch - 25ms/step
testing model: results/AAL/W5/deepLOB_L1/h50
Evaluating performance on  test set...
6357/6357 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0654894
{'0': {'precision': 0.4452919401019224, 'recall': 0.35821349563245125, 'f1-score': 0.3970342336143127, 'support': 483223}, '1': {'precision': 0.46645133150219853, 'recall': 0.2980730406484467, 'f1-score': 0.3637204300086866, 'support': 663740}, '2': {'precision': 0.3706841606932114, 'recall': 0.6285781518764864, 'f1-score': 0.46635195128941376, 'support': 480206}, 'accuracy': 0.4134708810209634, 'macro avg': {'precision': 0.42747581076577745, 'recall': 0.42828822938579475, 'f1-score': 0.4090355383041377, 'support': 1627169}, 'weighted avg': {'precision': 0.43190502769717515, 'recall': 0.4134708810209634, 'f1-score': 0.40390203894288723, 'support': 1627169}}
[[173097 130680 179446]
 [132893 197843 333004]
 [ 82737  95622 301847]]
Evaluating performance on  train set...
1701/1701 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0466212
{'0': {'precision': 0.41520299452922543, 'recall': 0.5331468621399177, 'f1-score': 0.4668407384208267, 'support': 124416}, '1': {'precision': 0.5218904507998061, 'recall': 0.29170662981928525, 'f1-score': 0.3742366047376562, 'support': 184545}, '2': {'precision': 0.4015767201901339, 'recall': 0.5478225800074333, 'f1-score': 0.46343576381339746, 'support': 126457}, 'accuracy': 0.4350784763147137, 'macro avg': {'precision': 0.4462233885063885, 'recall': 0.4575586906555455, 'f1-score': 0.4348377023239601, 'support': 435418}, 'weighted avg': {'precision': 0.4564633439942356, 'recall': 0.4350784763147137, 'f1-score': 0.4266030525086862, 'support': 435418}}
[[66332 26680 31404]
 [58882 53833 71830]
 [34544 22637 69276]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0615205
{'0': {'precision': 0.40625519603604804, 'recall': 0.581627309083984, 'f1-score': 0.4783749388154675, 'support': 42008}, '1': {'precision': 0.5071336852618062, 'recall': 0.23544412797244485, 'f1-score': 0.3215868994843029, 'support': 60388}, '2': {'precision': 0.3940695406309837, 'recall': 0.5285505124450952, 'f1-score': 0.45150906257688844, 'support': 41663}, 'accuracy': 0.4211607744049313, 'macro avg': {'precision': 0.43581947397627935, 'recall': 0.44854064983384134, 'f1-score': 0.4171569669588863, 'support': 144059}, 'weighted avg': {'precision': 0.44501819762722866, 'recall': 0.4211607744049313, 'f1-score': 0.40488123747880483, 'support': 144059}}
[[24433  7415 10160]
 [22470 14218 23700]
 [13239  6403 22021]]
training model: results/AAL/W5/deepLOB_L1/h100
Epoch 1/50
1701/1701 - 47s - loss: 3.1992 - accuracy100: 0.4224 - val_loss: 3.6214 - val_accuracy100: 0.3270 - 47s/epoch - 28ms/step
Epoch 2/50
1701/1701 - 45s - loss: 3.1800 - accuracy100: 0.4304 - val_loss: 3.4951 - val_accuracy100: 0.3292 - 45s/epoch - 26ms/step
Epoch 3/50
1701/1701 - 43s - loss: 3.1685 - accuracy100: 0.4361 - val_loss: 3.3827 - val_accuracy100: 0.3239 - 43s/epoch - 26ms/step
Epoch 4/50
1701/1701 - 45s - loss: 3.1443 - accuracy100: 0.4460 - val_loss: 3.4783 - val_accuracy100: 0.3341 - 45s/epoch - 27ms/step
Epoch 5/50
1701/1701 - 48s - loss: 3.1418 - accuracy100: 0.4466 - val_loss: 3.5776 - val_accuracy100: 0.3284 - 48s/epoch - 28ms/step
Epoch 6/50
1701/1701 - 49s - loss: 3.1177 - accuracy100: 0.4543 - val_loss: 3.5879 - val_accuracy100: 0.3281 - 49s/epoch - 29ms/step
Epoch 7/50
1701/1701 - 51s - loss: 3.1049 - accuracy100: 0.4578 - val_loss: 3.4399 - val_accuracy100: 0.3352 - 51s/epoch - 30ms/step
Epoch 8/50
1701/1701 - 52s - loss: 3.0949 - accuracy100: 0.4606 - val_loss: 3.5247 - val_accuracy100: 0.3287 - 52s/epoch - 30ms/step
Epoch 9/50
1701/1701 - 51s - loss: 3.0836 - accuracy100: 0.4642 - val_loss: 3.4333 - val_accuracy100: 0.3335 - 51s/epoch - 30ms/step
Epoch 10/50
1701/1701 - 48s - loss: 3.0775 - accuracy100: 0.4653 - val_loss: 3.4139 - val_accuracy100: 0.3344 - 48s/epoch - 28ms/step
Epoch 11/50
1701/1701 - 48s - loss: 3.0685 - accuracy100: 0.4691 - val_loss: 3.4430 - val_accuracy100: 0.3338 - 48s/epoch - 28ms/step
Epoch 12/50
1701/1701 - 44s - loss: 3.0619 - accuracy100: 0.4709 - val_loss: 3.4303 - val_accuracy100: 0.3363 - 44s/epoch - 26ms/step
Epoch 13/50
1701/1701 - 44s - loss: 3.0550 - accuracy100: 0.4724 - val_loss: 3.4213 - val_accuracy100: 0.3384 - 44s/epoch - 26ms/step
testing model: results/AAL/W5/deepLOB_L1/h100
Evaluating performance on  test set...
6357/6357 - 101s - 101s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1351326
{'0': {'precision': 0.35573981834974944, 'recall': 0.4549149048822339, 'f1-score': 0.3992608467935577, 'support': 564721}, '1': {'precision': 0.3052573901142441, 'recall': 0.4916789355369808, 'f1-score': 0.37666404154314814, 'support': 505344}, '2': {'precision': 0.3817666633718823, 'recall': 0.0623958901749045, 'f1-score': 0.10726104940623954, 'support': 557104}, 'accuracy': 0.33194339371018006, 'macro avg': {'precision': 0.3475879572786253, 'recall': 0.3363299101980397, 'f1-score': 0.2943953125809818, 'support': 1627169}, 'weighted avg': {'precision': 0.3489726461967445, 'recall': 0.33194339371018006, 'f1-score': 0.29226924661181414, 'support': 1627169}}
[[256900 283060  24761]
 [225346 248467  31531]
 [239911 282432  34761]]
Evaluating performance on  train set...
1701/1701 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1078113
{'0': {'precision': 0.3638410590013755, 'recall': 0.5504141085335201, 'f1-score': 0.4380905008786626, 'support': 145614}, '1': {'precision': 0.3418469835256646, 'recall': 0.39092583522464663, 'f1-score': 0.364742834707499, 'support': 144961}, '2': {'precision': 0.4287508609861837, 'recall': 0.14611682994690803, 'f1-score': 0.21795525346927216, 'support': 144843}, 'accuracy': 0.3628260659871664, 'macro avg': {'precision': 0.3781463011710746, 'recall': 0.36248559123502494, 'f1-score': 0.3402628630184779, 'support': 435418}, 'weighted avg': {'precision': 0.3781111334444418, 'recall': 0.3628260659871664, 'f1-score': 0.3404427217874068, 'support': 435418}}
[[80148 54263 11203]
 [71297 56669 16995]
 [68838 54841 21164]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1280246
{'0': {'precision': 0.3360464293297473, 'recall': 0.29124665180853454, 'f1-score': 0.31204679387473433, 'support': 48907}, '1': {'precision': 0.3125321087451116, 'recall': 0.6313994619897905, 'f1-score': 0.4181078617013816, 'support': 47211}, '2': {'precision': 0.4102971555696806, 'recall': 0.053857866961473475, 'f1-score': 0.09521702253199099, 'support': 47941}, 'accuracy': 0.3237215307617018, 'macro avg': {'precision': 0.35295856454817987, 'recall': 0.32550132691993283, 'f1-score': 0.27512389270270227, 'support': 144059}, 'weighted avg': {'precision': 0.35305001451045387, 'recall': 0.32372153076170174, 'f1-score': 0.27464692996634527, 'support': 144059}}
[[14244 33086  1577]
 [15268 29809  2134]
 [12875 32484  2582]]
training model: results/AAL/W5/deepLOB_L1/h200
Epoch 1/50
1701/1701 - 48s - loss: 3.2588 - accuracy200: 0.3949 - val_loss: 3.3540 - val_accuracy200: 0.3385 - 48s/epoch - 28ms/step
Epoch 2/50
1701/1701 - 47s - loss: 3.2359 - accuracy200: 0.4022 - val_loss: 3.3731 - val_accuracy200: 0.3342 - 47s/epoch - 28ms/step
Epoch 3/50
1701/1701 - 47s - loss: 3.2279 - accuracy200: 0.4074 - val_loss: 3.3178 - val_accuracy200: 0.3371 - 47s/epoch - 27ms/step
Epoch 4/50
1701/1701 - 49s - loss: 3.2214 - accuracy200: 0.4104 - val_loss: 3.3404 - val_accuracy200: 0.3298 - 49s/epoch - 29ms/step
Epoch 5/50
1701/1701 - 47s - loss: 3.2229 - accuracy200: 0.4076 - val_loss: 3.3248 - val_accuracy200: 0.3359 - 47s/epoch - 28ms/step
Epoch 6/50
1701/1701 - 50s - loss: 3.2146 - accuracy200: 0.4132 - val_loss: 3.3200 - val_accuracy200: 0.3375 - 50s/epoch - 29ms/step
Epoch 7/50
1701/1701 - 48s - loss: 3.2081 - accuracy200: 0.4167 - val_loss: 3.3704 - val_accuracy200: 0.3322 - 48s/epoch - 28ms/step
Epoch 8/50
1701/1701 - 49s - loss: 3.2032 - accuracy200: 0.4206 - val_loss: 3.3703 - val_accuracy200: 0.3323 - 49s/epoch - 29ms/step
Epoch 9/50
1701/1701 - 44s - loss: 3.1992 - accuracy200: 0.4214 - val_loss: 3.4119 - val_accuracy200: 0.3312 - 44s/epoch - 26ms/step
Epoch 10/50
1701/1701 - 46s - loss: 3.1959 - accuracy200: 0.4241 - val_loss: 3.4096 - val_accuracy200: 0.3215 - 46s/epoch - 27ms/step
Epoch 11/50
1701/1701 - 44s - loss: 3.1936 - accuracy200: 0.4241 - val_loss: 3.3321 - val_accuracy200: 0.3440 - 44s/epoch - 26ms/step
Epoch 12/50
1701/1701 - 45s - loss: 3.1927 - accuracy200: 0.4240 - val_loss: 3.3237 - val_accuracy200: 0.3425 - 45s/epoch - 26ms/step
Epoch 13/50
1701/1701 - 45s - loss: 3.1879 - accuracy200: 0.4260 - val_loss: 3.3410 - val_accuracy200: 0.3364 - 45s/epoch - 27ms/step
testing model: results/AAL/W5/deepLOB_L1/h200
Evaluating performance on  test set...
6357/6357 - 99s - 99s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1016698
{'0': {'precision': 0.37263754741964045, 'recall': 0.37776968902401864, 'f1-score': 0.37518606849937997, 'support': 607153}, '1': {'precision': 0.25821277761008715, 'recall': 0.19790784700475336, 'f1-score': 0.22407377403326853, 'support': 419281}, '2': {'precision': 0.37042713622436785, 'recall': 0.42565190974389705, 'f1-score': 0.3961240250032919, 'support': 600735}, 'accuracy': 0.3491014147885069, 'macro avg': {'precision': 0.3337591537513651, 'recall': 0.33377648192422305, 'f1-score': 0.33179462251198016, 'support': 1627169}, 'weighted avg': {'precision': 0.3423370664739541, 'recall': 0.3491014147885069, 'f1-score': 0.34397827715400153, 'support': 1627169}}
[[229364 120212 257577]
 [159288  82979 177014]
 [226863 118168 255704]]
Evaluating performance on  train set...
1701/1701 - 31s - 31s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1032637
{'0': {'precision': 0.3426654844057211, 'recall': 0.30591425975384784, 'f1-score': 0.3232486334922592, 'support': 145276}, '1': {'precision': 0.35091845520936316, 'recall': 0.3004375337023815, 'f1-score': 0.32372182649275005, 'support': 146503}, '2': {'precision': 0.33819573476801906, 'recall': 0.4245017021839473, 'f1-score': 0.37646557632110245, 'support': 143639}, 'accuracy': 0.343192059124795, 'macro avg': {'precision': 0.3439265581277011, 'recall': 0.3436178318800589, 'f1-score': 0.34114534543537056, 'support': 435418}, 'weighted avg': {'precision': 0.3439678068026732, 'recall': 0.343192059124795, 'f1-score': 0.34096345613427936, 'support': 435418}}
[[44442 41151 59683]
 [42851 44015 59637]
 [42402 40262 60975]]
Evaluating performance on  val set...
563/563 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.105939
{'0': {'precision': 0.34468176745825096, 'recall': 0.352564230930973, 'f1-score': 0.3485784430189277, 'support': 49937}, '1': {'precision': 0.31634274980131494, 'recall': 0.19209423739223902, 'f1-score': 0.23903697334479795, 'support': 45587}, '2': {'precision': 0.33958161046280133, 'recall': 0.45686617904604926, 'f1-score': 0.38958825648098533, 'support': 48535}, 'accuracy': 0.33692445456375514, 'macro avg': {'precision': 0.33353537590745574, 'recall': 0.3338415491230871, 'f1-score': 0.3257345576149037, 'support': 144059}, 'weighted avg': {'precision': 0.333995681079053, 'recall': 0.33692445456375514, 'f1-score': 0.3277310424285197, 'support': 144059}}
[[17606  9634 22697]
 [16403  8757 20427]
 [17070  9291 22174]]
training model: results/AAL/W5/deepLOB_L1/h300
Epoch 1/50
1701/1701 - 53s - loss: 3.2815 - accuracy300: 0.3794 - val_loss: 3.3298 - val_accuracy300: 0.3358 - 53s/epoch - 31ms/step
Epoch 2/50
1701/1701 - 50s - loss: 3.2617 - accuracy300: 0.3862 - val_loss: 3.3279 - val_accuracy300: 0.3319 - 50s/epoch - 29ms/step
Epoch 3/50
1701/1701 - 50s - loss: 3.2512 - accuracy300: 0.3936 - val_loss: 3.3160 - val_accuracy300: 0.3377 - 50s/epoch - 29ms/step
Epoch 4/50
1701/1701 - 47s - loss: 3.2460 - accuracy300: 0.3966 - val_loss: 3.3146 - val_accuracy300: 0.3359 - 47s/epoch - 28ms/step
Epoch 5/50
1701/1701 - 47s - loss: 3.2376 - accuracy300: 0.4036 - val_loss: 3.3221 - val_accuracy300: 0.3326 - 47s/epoch - 28ms/step
Epoch 6/50
1701/1701 - 49s - loss: 3.2342 - accuracy300: 0.4057 - val_loss: 3.3242 - val_accuracy300: 0.3378 - 49s/epoch - 29ms/step
Epoch 7/50
1701/1701 - 47s - loss: 3.2299 - accuracy300: 0.4094 - val_loss: 3.3246 - val_accuracy300: 0.3373 - 47s/epoch - 28ms/step
Epoch 8/50
1701/1701 - 43s - loss: 3.2237 - accuracy300: 0.4121 - val_loss: 3.3186 - val_accuracy300: 0.3373 - 43s/epoch - 25ms/step
Epoch 9/50
1701/1701 - 45s - loss: 3.2186 - accuracy300: 0.4152 - val_loss: 3.3175 - val_accuracy300: 0.3388 - 45s/epoch - 26ms/step
Epoch 10/50
1701/1701 - 42s - loss: 3.2175 - accuracy300: 0.4151 - val_loss: 3.3203 - val_accuracy300: 0.3342 - 42s/epoch - 25ms/step
Epoch 11/50
1701/1701 - 46s - loss: 3.2132 - accuracy300: 0.4181 - val_loss: 3.3293 - val_accuracy300: 0.3382 - 46s/epoch - 27ms/step
Epoch 12/50
1701/1701 - 48s - loss: 3.2098 - accuracy300: 0.4191 - val_loss: 3.4127 - val_accuracy300: 0.3360 - 48s/epoch - 28ms/step
Epoch 13/50
1701/1701 - 46s - loss: 3.2069 - accuracy300: 0.4208 - val_loss: 3.3551 - val_accuracy300: 0.3389 - 46s/epoch - 27ms/step
Epoch 14/50
1701/1701 - 45s - loss: 3.2032 - accuracy300: 0.4230 - val_loss: 3.3400 - val_accuracy300: 0.3396 - 45s/epoch - 27ms/step
testing model: results/AAL/W5/deepLOB_L1/h300
Evaluating performance on  test set...
6357/6357 - 101s - 101s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1056262
{'0': {'precision': 0.3548405234821968, 'recall': 0.1776937751216044, 'f1-score': 0.23680334712333134, 'support': 568236}, '1': {'precision': 0.30757713281939997, 'recall': 0.2537429712066718, 'f1-score': 0.27807853307601704, 'support': 495462}, '2': {'precision': 0.34930236542559456, 'recall': 0.5789171048731878, 'f1-score': 0.4357097013973437, 'support': 563471}, 'accuracy': 0.3397895363050796, 'macro avg': {'precision': 0.3372400072423971, 'recall': 0.3367846170671547, 'f1-score': 0.3168638605322307, 'support': 1627169}, 'weighted avg': {'precision': 0.3385313352399907, 'recall': 0.3397895363050796, 'f1-score': 0.31825047924766603, 'support': 1627169}}
[[100972 143385 323879]
 [ 85954 125720 283788]
 [ 97630 139638 326203]]
Evaluating performance on  train set...
1701/1701 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1071943
{'0': {'precision': 0.35084274865715875, 'recall': 0.12837073131061216, 'f1-score': 0.18796608235299955, 'support': 147557}, '1': {'precision': 0.33460254984170446, 'recall': 0.22023386296278044, 'f1-score': 0.26563077119021844, 'support': 142049}, '2': {'precision': 0.34083394690413016, 'recall': 0.6730378843990893, 'f1-score': 0.45251115865579694, 'support': 145812}, 'accuracy': 0.34073694702561674, 'macro avg': {'precision': 0.3420930818009978, 'recall': 0.34054749289082736, 'f1-score': 0.3020360040663383, 'support': 435418}, 'weighted avg': {'precision': 0.34219288254517194, 'recall': 0.34073694702561674, 'f1-score': 0.3018934763755287, 'support': 435418}}
[[18942 32193 96422]
 [17392 31284 93373]
 [17656 30019 98137]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1046907
{'0': {'precision': 0.3494827950179438, 'recall': 0.2031496062992126, 'f1-score': 0.2569421989989265, 'support': 48895}, '1': {'precision': 0.33256932654216187, 'recall': 0.24790128664838643, 'f1-score': 0.2840604229607251, 'support': 47410}, '2': {'precision': 0.3345330460664782, 'recall': 0.5625078527453198, 'f1-score': 0.4195515849153853, 'support': 47754}, 'accuracy': 0.33700081216723704, 'macro avg': {'precision': 0.3388617225421946, 'recall': 0.3378529152309729, 'f1-score': 0.32018473562501226, 'support': 144059}, 'weighted avg': {'precision': 0.33896087100163724, 'recall': 0.33700081216723704, 'f1-score': 0.31977009321645855, 'support': 144059}}
[[ 9933 11865 27097]
 [ 9319 11753 26338]
 [ 9170 11722 26862]]
training model: results/AAL/W5/deepLOB_L1/h500
Epoch 1/50
1701/1701 - 50s - loss: 3.2082 - accuracy500: 0.4253 - val_loss: 3.4396 - val_accuracy500: 0.2961 - 50s/epoch - 30ms/step
Epoch 2/50
1701/1701 - 48s - loss: 3.1831 - accuracy500: 0.4356 - val_loss: 3.3740 - val_accuracy500: 0.3269 - 48s/epoch - 28ms/step
Epoch 3/50
1701/1701 - 47s - loss: 3.1784 - accuracy500: 0.4351 - val_loss: 3.5942 - val_accuracy500: 0.2993 - 47s/epoch - 28ms/step
Epoch 4/50
1701/1701 - 44s - loss: 3.1824 - accuracy500: 0.4363 - val_loss: 3.3572 - val_accuracy500: 0.3476 - 44s/epoch - 26ms/step
Epoch 5/50
1701/1701 - 43s - loss: 3.1740 - accuracy500: 0.4404 - val_loss: 3.4083 - val_accuracy500: 0.3422 - 43s/epoch - 25ms/step
Epoch 6/50
1701/1701 - 44s - loss: 3.1716 - accuracy500: 0.4417 - val_loss: 3.3850 - val_accuracy500: 0.3199 - 44s/epoch - 26ms/step
Epoch 7/50
1701/1701 - 46s - loss: 3.1650 - accuracy500: 0.4457 - val_loss: 3.3840 - val_accuracy500: 0.3234 - 46s/epoch - 27ms/step
Epoch 8/50
1701/1701 - 45s - loss: 3.1578 - accuracy500: 0.4509 - val_loss: 3.4464 - val_accuracy500: 0.3022 - 45s/epoch - 27ms/step
Epoch 9/50
1701/1701 - 47s - loss: 3.1530 - accuracy500: 0.4525 - val_loss: 3.4706 - val_accuracy500: 0.2964 - 47s/epoch - 27ms/step
Epoch 10/50
1701/1701 - 45s - loss: 3.1436 - accuracy500: 0.4574 - val_loss: 3.4856 - val_accuracy500: 0.2953 - 45s/epoch - 26ms/step
Epoch 11/50
1701/1701 - 44s - loss: 3.1401 - accuracy500: 0.4599 - val_loss: 3.5850 - val_accuracy500: 0.3163 - 44s/epoch - 26ms/step
Epoch 12/50
1701/1701 - 42s - loss: 3.1410 - accuracy500: 0.4585 - val_loss: 3.6319 - val_accuracy500: 0.3398 - 42s/epoch - 25ms/step
Epoch 13/50
1701/1701 - 44s - loss: 3.1361 - accuracy500: 0.4612 - val_loss: 3.5999 - val_accuracy500: 0.2978 - 44s/epoch - 26ms/step
Epoch 14/50
1701/1701 - 47s - loss: 3.1332 - accuracy500: 0.4618 - val_loss: 3.4778 - val_accuracy500: 0.2986 - 47s/epoch - 28ms/step
testing model: results/AAL/W5/deepLOB_L1/h500
Evaluating performance on  test set...
6357/6357 - 96s - 96s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1165706
{'0': {'precision': 0.3811937396570021, 'recall': 0.0845220367429883, 'f1-score': 0.1383645257566452, 'support': 607735}, '1': {'precision': 0.2603809443526973, 'recall': 0.16363697658682477, 'f1-score': 0.2009724041865431, 'support': 415279}, '2': {'precision': 0.3724400759115599, 'recall': 0.7591346591520388, 'f1-score': 0.49971453289082296, 'support': 604155}, 'accuracy': 0.3551917471387422, 'macro avg': {'precision': 0.3380049199737531, 'recall': 0.3357645574939507, 'f1-score': 0.2796838209446704, 'support': 1627169}, 'weighted avg': {'precision': 0.34711025690794284, 'recall': 0.3551917471387422, 'f1-score': 0.2885094404561256, 'support': 1627169}}
[[ 51367  97494 458874]
 [ 33400  67955 313924]
 [ 49986  95534 458635]]
Evaluating performance on  train set...
1701/1701 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1161935
{'0': {'precision': 0.358196152117969, 'recall': 0.06030534351145038, 'f1-score': 0.10323089510333096, 'support': 145410}, '1': {'precision': 0.3685567855230519, 'recall': 0.22994061782010813, 'f1-score': 0.2831964666565906, 'support': 146677}, '2': {'precision': 0.33201430065179416, 'recall': 0.739923673176075, 'f1-score': 0.45835719394844376, 'support': 143331}, 'accuracy': 0.3411664193946966, 'macro avg': {'precision': 0.35292241276427166, 'recall': 0.3433898781692111, 'f1-score': 0.28159485190278843, 'support': 435418}, 'weighted avg': {'precision': 0.3530677368330222, 'recall': 0.3411664193946966, 'f1-score': 0.280755521275162, 'support': 435418}}
[[  8769  29016 107625]
 [  7203  33727 105747]
 [  8509  28768 106054]]
Evaluating performance on  val set...
563/563 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1188396
{'0': {'precision': 0.37367685240663073, 'recall': 0.10621830292937703, 'f1-score': 0.16541663596846679, 'support': 52844}, '1': {'precision': 0.2860243465131641, 'recall': 0.15237664328984743, 'f1-score': 0.19882906669727932, 'support': 39783}, '2': {'precision': 0.3578131374949, 'recall': 0.7502722040752838, 'f1-score': 0.48454255506165395, 'support': 51432}, 'accuracy': 0.34890565671009793, 'macro avg': {'precision': 0.3391714454715649, 'recall': 0.33628905009816945, 'f1-score': 0.2829294192424667, 'support': 144059}, 'weighted avg': {'precision': 0.34380726961555264, 'recall': 0.34890565671009793, 'f1-score': 0.28857819479148483, 'support': 144059}}
[[ 5613  7622 39609]
 [ 4074  6062 29647]
 [ 5334  7510 38588]]
training model: results/AAL/W5/deepLOB_L1/h1000
Epoch 1/50
1701/1701 - 53s - loss: 3.2193 - accuracy1000: 0.4221 - val_loss: 3.3511 - val_accuracy1000: 0.3529 - 53s/epoch - 31ms/step
Epoch 2/50
1701/1701 - 51s - loss: 3.1711 - accuracy1000: 0.4411 - val_loss: 3.2968 - val_accuracy1000: 0.3578 - 51s/epoch - 30ms/step
Epoch 3/50
1701/1701 - 46s - loss: 3.1603 - accuracy1000: 0.4402 - val_loss: 3.2810 - val_accuracy1000: 0.3556 - 46s/epoch - 27ms/step
Epoch 4/50
1701/1701 - 48s - loss: 3.1418 - accuracy1000: 0.4488 - val_loss: 3.2837 - val_accuracy1000: 0.3541 - 48s/epoch - 28ms/step
Epoch 5/50
1701/1701 - 48s - loss: 3.1367 - accuracy1000: 0.4528 - val_loss: 3.2817 - val_accuracy1000: 0.3592 - 48s/epoch - 28ms/step
Epoch 6/50
1701/1701 - 44s - loss: 3.1237 - accuracy1000: 0.4603 - val_loss: 3.2895 - val_accuracy1000: 0.3474 - 44s/epoch - 26ms/step
Epoch 7/50
1701/1701 - 46s - loss: 3.1204 - accuracy1000: 0.4630 - val_loss: 3.2901 - val_accuracy1000: 0.3445 - 46s/epoch - 27ms/step
Epoch 8/50
1701/1701 - 48s - loss: 3.1132 - accuracy1000: 0.4639 - val_loss: 3.3125 - val_accuracy1000: 0.3154 - 48s/epoch - 28ms/step
Epoch 9/50
1701/1701 - 47s - loss: 3.1055 - accuracy1000: 0.4676 - val_loss: 3.3124 - val_accuracy1000: 0.3203 - 47s/epoch - 28ms/step
Epoch 10/50
1701/1701 - 46s - loss: 3.0969 - accuracy1000: 0.4698 - val_loss: 3.3148 - val_accuracy1000: 0.3137 - 46s/epoch - 27ms/step
Epoch 11/50
1701/1701 - 44s - loss: 3.0895 - accuracy1000: 0.4731 - val_loss: 3.3259 - val_accuracy1000: 0.3193 - 44s/epoch - 26ms/step
Epoch 12/50
1701/1701 - 48s - loss: 3.0777 - accuracy1000: 0.4764 - val_loss: 3.3245 - val_accuracy1000: 0.3275 - 48s/epoch - 28ms/step
Epoch 13/50
1701/1701 - 48s - loss: 3.0693 - accuracy1000: 0.4790 - val_loss: 3.3338 - val_accuracy1000: 0.3230 - 48s/epoch - 28ms/step
testing model: results/AAL/W5/deepLOB_L1/h1000
Evaluating performance on  test set...
6357/6357 - 105s - 105s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0783386
{'0': {'precision': 0.40570204930327824, 'recall': 0.3565245717835471, 'f1-score': 0.3795268897675577, 'support': 660005}, '1': {'precision': 0.18343977929783456, 'recall': 0.015865959769626525, 'f1-score': 0.02920586403689542, 'support': 305938}, '2': {'precision': 0.4065930836107557, 'recall': 0.6276401714391147, 'f1-score': 0.49349438621775443, 'support': 661226}, 'accuracy': 0.4026465597611557, 'macro avg': {'precision': 0.33191163740395613, 'recall': 0.33334356766409606, 'f1-score': 0.3007423800074025, 'support': 1627169}, 'weighted avg': {'precision': 0.36427469952588615, 'recall': 0.4026465597611557, 'f1-score': 0.3599725336052847, 'support': 1627169}}
[[235308  10726 413971]
 [109361   4854 191723]
 [235333  10881 415012]]
Evaluating performance on  train set...
1701/1701 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1021872
{'0': {'precision': 0.3456884190985475, 'recall': 0.33621450466534175, 'f1-score': 0.34088564968818524, 'support': 148435}, '1': {'precision': 0.29277381723914453, 'recall': 0.012657784502444697, 'f1-score': 0.02426643389511851, 'support': 142758}, '2': {'precision': 0.33170925199821677, 'recall': 0.6552054082163287, 'f1-score': 0.44043868153174986, 'support': 144225}, 'accuracy': 0.33579227317198646, 'macro avg': {'precision': 0.32339049611196957, 'recall': 0.334692565794705, 'f1-score': 0.2685302550383512, 'support': 435418}, 'weighted avg': {'precision': 0.3237092448170758, 'recall': 0.33579227317198646, 'f1-score': 0.2700528178104298, 'support': 435418}}
[[49906  2263 96266]
 [46835  1807 94116]
 [47626  2102 94497]]
Evaluating performance on  val set...
563/563 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0941489
{'0': {'precision': 0.3717304420086265, 'recall': 0.35178909131761754, 'f1-score': 0.3614849589702642, 'support': 53407}, '1': {'precision': 0.26771956856702617, 'recall': 0.01733988672937302, 'f1-score': 0.03257023689575181, 'support': 40081}, '2': {'precision': 0.35242683208499687, 'recall': 0.6336240137628285, 'f1-score': 0.45293020100076326, 'support': 50571}, 'accuracy': 0.35767289790988416, 'macro avg': {'precision': 0.33062561422021647, 'recall': 0.3342509972699397, 'f1-score': 0.28232846562225977, 'support': 144059}, 'weighted avg': {'precision': 0.33601547330926956, 'recall': 0.35767289790988416, 'f1-score': 0.30207351198851257, 'support': 144059}}
[[18788   983 33636]
 [14144   695 25242]
 [17610   918 32043]]
training model: results/AAL/W5/deepOF_L1/h10
Epoch 1/50
1701/1701 - 47s - loss: 3.1149 - accuracy10: 0.4238 - val_loss: 3.1538 - val_accuracy10: 0.5599 - 47s/epoch - 28ms/step
Epoch 2/50
1701/1701 - 44s - loss: 3.0608 - accuracy10: 0.4224 - val_loss: 3.1153 - val_accuracy10: 0.5807 - 44s/epoch - 26ms/step
Epoch 3/50
1701/1701 - 44s - loss: 3.0353 - accuracy10: 0.4390 - val_loss: 3.0942 - val_accuracy10: 0.5588 - 44s/epoch - 26ms/step
Epoch 4/50
1701/1701 - 45s - loss: 3.0144 - accuracy10: 0.4502 - val_loss: 3.0809 - val_accuracy10: 0.5834 - 45s/epoch - 27ms/step
Epoch 5/50
1701/1701 - 45s - loss: 3.0006 - accuracy10: 0.4536 - val_loss: 3.0666 - val_accuracy10: 0.5666 - 45s/epoch - 26ms/step
Epoch 6/50
1701/1701 - 44s - loss: 2.9870 - accuracy10: 0.4632 - val_loss: 3.0596 - val_accuracy10: 0.5742 - 44s/epoch - 26ms/step
Epoch 7/50
1701/1701 - 42s - loss: 2.9750 - accuracy10: 0.4708 - val_loss: 3.0613 - val_accuracy10: 0.5788 - 42s/epoch - 25ms/step
Epoch 8/50
1701/1701 - 44s - loss: 2.9661 - accuracy10: 0.4762 - val_loss: 3.0517 - val_accuracy10: 0.5749 - 44s/epoch - 26ms/step
Epoch 9/50
1701/1701 - 43s - loss: 2.9544 - accuracy10: 0.4815 - val_loss: 3.0480 - val_accuracy10: 0.5818 - 43s/epoch - 25ms/step
Epoch 10/50
1701/1701 - 41s - loss: 2.9453 - accuracy10: 0.4853 - val_loss: 3.0456 - val_accuracy10: 0.5754 - 41s/epoch - 24ms/step
Epoch 11/50
1701/1701 - 44s - loss: 2.9368 - accuracy10: 0.4887 - val_loss: 3.0480 - val_accuracy10: 0.5791 - 44s/epoch - 26ms/step
Epoch 12/50
1701/1701 - 44s - loss: 2.9267 - accuracy10: 0.4921 - val_loss: 3.0483 - val_accuracy10: 0.5800 - 44s/epoch - 26ms/step
Epoch 13/50
1701/1701 - 43s - loss: 2.9200 - accuracy10: 0.4934 - val_loss: 3.0506 - val_accuracy10: 0.5849 - 43s/epoch - 26ms/step
Epoch 14/50
1701/1701 - 43s - loss: 2.9120 - accuracy10: 0.4956 - val_loss: 3.0529 - val_accuracy10: 0.5864 - 43s/epoch - 25ms/step
Epoch 15/50
1701/1701 - 43s - loss: 2.9037 - accuracy10: 0.4974 - val_loss: 3.0505 - val_accuracy10: 0.5772 - 43s/epoch - 25ms/step
Epoch 16/50
1701/1701 - 44s - loss: 2.8957 - accuracy10: 0.4990 - val_loss: 3.0463 - val_accuracy10: 0.5758 - 44s/epoch - 26ms/step
Epoch 17/50
1701/1701 - 43s - loss: 2.8863 - accuracy10: 0.5025 - val_loss: 3.0439 - val_accuracy10: 0.5774 - 43s/epoch - 25ms/step
Epoch 18/50
1701/1701 - 42s - loss: 2.8776 - accuracy10: 0.5026 - val_loss: 3.0456 - val_accuracy10: 0.5691 - 42s/epoch - 25ms/step
Epoch 19/50
1701/1701 - 40s - loss: 2.8708 - accuracy10: 0.5024 - val_loss: 3.0404 - val_accuracy10: 0.5674 - 40s/epoch - 23ms/step
Epoch 20/50
1701/1701 - 42s - loss: 2.8626 - accuracy10: 0.5044 - val_loss: 3.0396 - val_accuracy10: 0.5516 - 42s/epoch - 24ms/step
Epoch 21/50
1701/1701 - 44s - loss: 2.8535 - accuracy10: 0.5048 - val_loss: 3.0300 - val_accuracy10: 0.5587 - 44s/epoch - 26ms/step
Epoch 22/50
1701/1701 - 45s - loss: 2.8459 - accuracy10: 0.5052 - val_loss: 3.0383 - val_accuracy10: 0.5616 - 45s/epoch - 26ms/step
Epoch 23/50
1701/1701 - 44s - loss: 2.8373 - accuracy10: 0.5065 - val_loss: 3.0436 - val_accuracy10: 0.5497 - 44s/epoch - 26ms/step
Epoch 24/50
1701/1701 - 46s - loss: 2.8300 - accuracy10: 0.5073 - val_loss: 3.0295 - val_accuracy10: 0.5425 - 46s/epoch - 27ms/step
Epoch 25/50
1701/1701 - 44s - loss: 2.8195 - accuracy10: 0.5105 - val_loss: 3.0262 - val_accuracy10: 0.5356 - 44s/epoch - 26ms/step
Epoch 26/50
1701/1701 - 45s - loss: 2.8168 - accuracy10: 0.5099 - val_loss: 3.0386 - val_accuracy10: 0.5274 - 45s/epoch - 26ms/step
Epoch 27/50
1701/1701 - 45s - loss: 2.8081 - accuracy10: 0.5121 - val_loss: 3.0248 - val_accuracy10: 0.5352 - 45s/epoch - 26ms/step
Epoch 28/50
1701/1701 - 46s - loss: 2.7989 - accuracy10: 0.5133 - val_loss: 3.0320 - val_accuracy10: 0.5226 - 46s/epoch - 27ms/step
Epoch 29/50
1701/1701 - 42s - loss: 2.7942 - accuracy10: 0.5143 - val_loss: 3.0166 - val_accuracy10: 0.5214 - 42s/epoch - 25ms/step
Epoch 30/50
1701/1701 - 38s - loss: 2.7858 - accuracy10: 0.5167 - val_loss: 3.0159 - val_accuracy10: 0.5228 - 38s/epoch - 22ms/step
Epoch 31/50
1701/1701 - 41s - loss: 2.7798 - accuracy10: 0.5174 - val_loss: 3.0139 - val_accuracy10: 0.5216 - 41s/epoch - 24ms/step
Epoch 32/50
1701/1701 - 42s - loss: 2.7746 - accuracy10: 0.5193 - val_loss: 3.0331 - val_accuracy10: 0.5199 - 42s/epoch - 25ms/step
Epoch 33/50
1701/1701 - 42s - loss: 2.7679 - accuracy10: 0.5218 - val_loss: 3.0295 - val_accuracy10: 0.5117 - 42s/epoch - 25ms/step
Epoch 34/50
1701/1701 - 42s - loss: 2.7620 - accuracy10: 0.5222 - val_loss: 3.0298 - val_accuracy10: 0.5007 - 42s/epoch - 25ms/step
Epoch 35/50
1701/1701 - 42s - loss: 2.7546 - accuracy10: 0.5234 - val_loss: 3.0188 - val_accuracy10: 0.5023 - 42s/epoch - 24ms/step
Epoch 36/50
1701/1701 - 42s - loss: 2.7483 - accuracy10: 0.5258 - val_loss: 3.0244 - val_accuracy10: 0.5007 - 42s/epoch - 25ms/step
Epoch 37/50
1701/1701 - 42s - loss: 2.7450 - accuracy10: 0.5256 - val_loss: 3.0330 - val_accuracy10: 0.5067 - 42s/epoch - 25ms/step
Epoch 38/50
1701/1701 - 42s - loss: 2.7371 - accuracy10: 0.5279 - val_loss: 3.0427 - val_accuracy10: 0.4980 - 42s/epoch - 25ms/step
Epoch 39/50
1701/1701 - 41s - loss: 2.7313 - accuracy10: 0.5293 - val_loss: 3.0333 - val_accuracy10: 0.4981 - 41s/epoch - 24ms/step
Epoch 40/50
1701/1701 - 42s - loss: 2.7260 - accuracy10: 0.5314 - val_loss: 3.0339 - val_accuracy10: 0.4922 - 42s/epoch - 24ms/step
Epoch 41/50
1701/1701 - 42s - loss: 2.7209 - accuracy10: 0.5313 - val_loss: 3.0481 - val_accuracy10: 0.5017 - 42s/epoch - 25ms/step
testing model: results/AAL/W5/deepOF_L1/h10
Evaluating performance on  test set...
6357/6357 - 100s - 100s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98861694
{'0': {'precision': 0.28266492654749675, 'recall': 0.4655572455108407, 'f1-score': 0.35175836675344163, 'support': 257732}, '1': {'precision': 0.7719390535151178, 'recall': 0.48143230800099057, 'f1-score': 0.5930188156211627, 'support': 1106438}, '2': {'precision': 0.2748076562938918, 'recall': 0.5356510034449455, 'f1-score': 0.3632535603866852, 'support': 262994}, 'accuracy': 0.4876810204748876, 'macro avg': {'precision': 0.4431372121188355, 'recall': 0.4942135189855923, 'f1-score': 0.43601024758709644, 'support': 1627164}, 'weighted avg': {'precision': 0.6140913049338943, 'recall': 0.4876810204748876, 'f1-score': 0.5176684381898087, 'support': 1627164}}
[[119989  79339  58404]
 [260416 532675 313347]
 [ 44087  78034 140873]]
Evaluating performance on  train set...
1701/1701 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91878414
{'0': {'precision': 0.3053748749134016, 'recall': 0.4702892537490368, 'f1-score': 0.37030079574358854, 'support': 67484}, '1': {'precision': 0.7732803015171383, 'recall': 0.5980462282937575, 'f1-score': 0.674467178579206, 'support': 297783}, '2': {'precision': 0.31633197612365105, 'recall': 0.45628715200068426, 'f1-score': 0.3736335568667962, 'support': 70151}, 'accuracy': 0.5554065288986675, 'macro avg': {'precision': 0.4649957175180637, 'recall': 0.5082075446811595, 'f1-score': 0.47280051039653026, 'support': 435418}, 'weighted avg': {'precision': 0.6271413918174817, 'recall': 0.5554065288986675, 'f1-score': 0.5788575722330603, 'support': 435418}}
[[ 31737  24933  10814]
 [ 61330 178088  58365]
 [ 10861  27281  32009]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95706254
{'0': {'precision': 0.2878223616050178, 'recall': 0.4601369801692108, 'f1-score': 0.3541307793013161, 'support': 22339}, '1': {'precision': 0.7709292680834025, 'recall': 0.544299835421694, 'f1-score': 0.6380890943201927, 'support': 99041}, '2': {'precision': 0.28814618147743243, 'recall': 0.48815980949861093, 'f1-score': 0.36238644733611586, 'support': 22677}, 'accuracy': 0.5224112677620664, 'macro avg': {'precision': 0.44896593705528426, 'recall': 0.49753220836317186, 'f1-score': 0.4515354403192082, 'support': 144057}, 'weighted avg': {'precision': 0.6200154128817515, 'recall': 0.5224112677620664, 'f1-score': 0.5506552748954885, 'support': 144057}}
[[10279  8009  4051]
 [21836 53908 23297]
 [ 3598  8009 11070]]
training model: results/AAL/W5/deepOF_L1/h20
Epoch 1/50
1701/1701 - 43s - loss: 3.1525 - accuracy20: 0.4195 - val_loss: 3.1876 - val_accuracy20: 0.5016 - 43s/epoch - 26ms/step
Epoch 2/50
1701/1701 - 43s - loss: 3.1030 - accuracy20: 0.4191 - val_loss: 3.1514 - val_accuracy20: 0.5094 - 43s/epoch - 26ms/step
Epoch 3/50
1701/1701 - 41s - loss: 3.0793 - accuracy20: 0.4312 - val_loss: 3.1499 - val_accuracy20: 0.5054 - 41s/epoch - 24ms/step
Epoch 4/50
1701/1701 - 41s - loss: 3.0618 - accuracy20: 0.4397 - val_loss: 3.1314 - val_accuracy20: 0.5128 - 41s/epoch - 24ms/step
Epoch 5/50
1701/1701 - 43s - loss: 3.0462 - accuracy20: 0.4471 - val_loss: 3.1332 - val_accuracy20: 0.5249 - 43s/epoch - 25ms/step
Epoch 6/50
1701/1701 - 45s - loss: 3.0342 - accuracy20: 0.4523 - val_loss: 3.1174 - val_accuracy20: 0.5291 - 45s/epoch - 26ms/step
Epoch 7/50
1701/1701 - 42s - loss: 3.0213 - accuracy20: 0.4599 - val_loss: 3.1203 - val_accuracy20: 0.5286 - 42s/epoch - 25ms/step
Epoch 8/50
1701/1701 - 41s - loss: 3.0108 - accuracy20: 0.4650 - val_loss: 3.1084 - val_accuracy20: 0.5323 - 41s/epoch - 24ms/step
Epoch 9/50
1701/1701 - 42s - loss: 2.9992 - accuracy20: 0.4699 - val_loss: 3.1083 - val_accuracy20: 0.5325 - 42s/epoch - 25ms/step
Epoch 10/50
1701/1701 - 42s - loss: 2.9896 - accuracy20: 0.4746 - val_loss: 3.1077 - val_accuracy20: 0.5361 - 42s/epoch - 24ms/step
Epoch 11/50
1701/1701 - 43s - loss: 2.9809 - accuracy20: 0.4785 - val_loss: 3.1041 - val_accuracy20: 0.5320 - 43s/epoch - 25ms/step
Epoch 12/50
1701/1701 - 42s - loss: 2.9712 - accuracy20: 0.4808 - val_loss: 3.1033 - val_accuracy20: 0.5359 - 42s/epoch - 25ms/step
Epoch 13/50
1701/1701 - 43s - loss: 2.9629 - accuracy20: 0.4843 - val_loss: 3.1016 - val_accuracy20: 0.5257 - 43s/epoch - 25ms/step
Epoch 14/50
1701/1701 - 42s - loss: 2.9552 - accuracy20: 0.4874 - val_loss: 3.1044 - val_accuracy20: 0.5352 - 42s/epoch - 25ms/step
Epoch 15/50
1701/1701 - 43s - loss: 2.9458 - accuracy20: 0.4903 - val_loss: 3.0979 - val_accuracy20: 0.5373 - 43s/epoch - 25ms/step
Epoch 16/50
1701/1701 - 42s - loss: 2.9384 - accuracy20: 0.4925 - val_loss: 3.0944 - val_accuracy20: 0.5283 - 42s/epoch - 25ms/step
Epoch 17/50
1701/1701 - 45s - loss: 2.9274 - accuracy20: 0.4952 - val_loss: 3.1017 - val_accuracy20: 0.5256 - 45s/epoch - 26ms/step
Epoch 18/50
1701/1701 - 45s - loss: 2.9211 - accuracy20: 0.4973 - val_loss: 3.0935 - val_accuracy20: 0.5227 - 45s/epoch - 26ms/step
Epoch 19/50
1701/1701 - 45s - loss: 2.9122 - accuracy20: 0.4988 - val_loss: 3.0890 - val_accuracy20: 0.5202 - 45s/epoch - 27ms/step
Epoch 20/50
1701/1701 - 42s - loss: 2.9046 - accuracy20: 0.5016 - val_loss: 3.0886 - val_accuracy20: 0.5174 - 42s/epoch - 25ms/step
Epoch 21/50
1701/1701 - 43s - loss: 2.8955 - accuracy20: 0.5030 - val_loss: 3.0828 - val_accuracy20: 0.5057 - 43s/epoch - 25ms/step
Epoch 22/50
1701/1701 - 42s - loss: 2.8898 - accuracy20: 0.5040 - val_loss: 3.0826 - val_accuracy20: 0.5097 - 42s/epoch - 25ms/step
Epoch 23/50
1701/1701 - 42s - loss: 2.8835 - accuracy20: 0.5060 - val_loss: 3.0821 - val_accuracy20: 0.5038 - 42s/epoch - 24ms/step
Epoch 24/50
1701/1701 - 38s - loss: 2.8750 - accuracy20: 0.5083 - val_loss: 3.0831 - val_accuracy20: 0.4955 - 38s/epoch - 22ms/step
Epoch 25/50
1701/1701 - 41s - loss: 2.8657 - accuracy20: 0.5105 - val_loss: 3.0855 - val_accuracy20: 0.5015 - 41s/epoch - 24ms/step
Epoch 26/50
1701/1701 - 41s - loss: 2.8592 - accuracy20: 0.5120 - val_loss: 3.0742 - val_accuracy20: 0.5004 - 41s/epoch - 24ms/step
Epoch 27/50
1701/1701 - 40s - loss: 2.8539 - accuracy20: 0.5136 - val_loss: 3.0824 - val_accuracy20: 0.5080 - 40s/epoch - 24ms/step
Epoch 28/50
1701/1701 - 42s - loss: 2.8466 - accuracy20: 0.5166 - val_loss: 3.0766 - val_accuracy20: 0.4997 - 42s/epoch - 25ms/step
Epoch 29/50
1701/1701 - 41s - loss: 2.8422 - accuracy20: 0.5157 - val_loss: 3.0760 - val_accuracy20: 0.5034 - 41s/epoch - 24ms/step
Epoch 30/50
1701/1701 - 41s - loss: 2.8349 - accuracy20: 0.5198 - val_loss: 3.0795 - val_accuracy20: 0.4994 - 41s/epoch - 24ms/step
Epoch 31/50
1701/1701 - 42s - loss: 2.8284 - accuracy20: 0.5201 - val_loss: 3.0767 - val_accuracy20: 0.5010 - 42s/epoch - 25ms/step
Epoch 32/50
1701/1701 - 43s - loss: 2.8223 - accuracy20: 0.5214 - val_loss: 3.0806 - val_accuracy20: 0.4995 - 43s/epoch - 25ms/step
Epoch 33/50
1701/1701 - 45s - loss: 2.8183 - accuracy20: 0.5228 - val_loss: 3.0828 - val_accuracy20: 0.4919 - 45s/epoch - 27ms/step
Epoch 34/50
1701/1701 - 43s - loss: 2.8125 - accuracy20: 0.5237 - val_loss: 3.0749 - val_accuracy20: 0.4977 - 43s/epoch - 26ms/step
Epoch 35/50
1701/1701 - 42s - loss: 2.8052 - accuracy20: 0.5245 - val_loss: 3.0788 - val_accuracy20: 0.4868 - 42s/epoch - 25ms/step
Epoch 36/50
1701/1701 - 43s - loss: 2.8022 - accuracy20: 0.5268 - val_loss: 3.0800 - val_accuracy20: 0.4953 - 43s/epoch - 25ms/step
testing model: results/AAL/W5/deepOF_L1/h20
Evaluating performance on  test set...
6357/6357 - 104s - 104s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0207893
{'0': {'precision': 0.3250733921534215, 'recall': 0.481970140956684, 'f1-score': 0.3882706749006973, 'support': 338189}, '1': {'precision': 0.6703961736601765, 'recall': 0.4745223468350525, 'f1-score': 0.5557041133317784, 'support': 946398}, '2': {'precision': 0.34412819584745485, 'recall': 0.4579291662896225, 'f1-score': 0.39295528040859573, 'support': 342577}, 'accuracy': 0.4725768269209496, 'macro avg': {'precision': 0.44653258722035094, 'recall': 0.4714738846937863, 'f1-score': 0.4456433562136904, 'support': 1627164}, 'weighted avg': {'precision': 0.5299332140629037, 'recall': 0.4725768269209496, 'f1-score': 0.48664029797825903, 'support': 1627164}}
[[162997 106989  68203]
 [266525 449087 230786]
 [ 71894 113807 156876]]
Evaluating performance on  train set...
1701/1701 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96881515
{'0': {'precision': 0.35580290145072535, 'recall': 0.48134947043098686, 'f1-score': 0.4091621643647799, 'support': 88657}, '1': {'precision': 0.6767341144985715, 'recall': 0.5855348076757594, 'f1-score': 0.6278398725019397, 'support': 255662}, '2': {'precision': 0.3874933701071391, 'recall': 0.4009813499599337, 'f1-score': 0.39412199450825114, 'support': 91099}, 'accuracy': 0.5257086294089817, 'macro avg': {'precision': 0.47334346201881194, 'recall': 0.4892885426888933, 'f1-score': 0.4770413437916569, 'support': 435418}, 'weighted avg': {'precision': 0.5508726638270375, 'recall': 0.5257086294089817, 'f1-score': 0.5344152218497774, 'support': 435418}}
[[ 42675  33270  12712]
 [ 60934 149699  45029]
 [ 16331  38239  36529]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9979804
{'0': {'precision': 0.33998096028510755, 'recall': 0.46889307837328303, 'f1-score': 0.394164508780122, 'support': 29704}, '1': {'precision': 0.6700070633939608, 'recall': 0.5381914893617021, 'f1-score': 0.5969086761582632, 'support': 84600}, '2': {'precision': 0.35703307337621676, 'recall': 0.42160454407958864, 'f1-score': 0.3866413919583276, 'support': 29753}, 'accuracy': 0.4998229867344176, 'macro avg': {'precision': 0.4556736990184284, 'recall': 0.47622970393819125, 'f1-score': 0.4592381922989042, 'support': 144057}, 'weighted avg': {'precision': 0.5373164583435758, 'recall': 0.4998229867344176, 'f1-score': 0.5116757804669674, 'support': 144057}}
[[13928 10818  4958]
 [21437 45531 17632]
 [ 5602 11607 12544]]
training model: results/AAL/W5/deepOF_L1/h30
Epoch 1/50
1701/1701 - 44s - loss: 3.1786 - accuracy30: 0.4177 - val_loss: 3.2350 - val_accuracy30: 0.4691 - 44s/epoch - 26ms/step
Epoch 2/50
1701/1701 - 43s - loss: 3.1363 - accuracy30: 0.4141 - val_loss: 3.1928 - val_accuracy30: 0.4614 - 43s/epoch - 25ms/step
Epoch 3/50
1701/1701 - 44s - loss: 3.1120 - accuracy30: 0.4227 - val_loss: 3.1696 - val_accuracy30: 0.4576 - 44s/epoch - 26ms/step
Epoch 4/50
1701/1701 - 44s - loss: 3.0938 - accuracy30: 0.4311 - val_loss: 3.1664 - val_accuracy30: 0.4729 - 44s/epoch - 26ms/step
Epoch 5/50
1701/1701 - 42s - loss: 3.0781 - accuracy30: 0.4412 - val_loss: 3.1656 - val_accuracy30: 0.4847 - 42s/epoch - 25ms/step
Epoch 6/50
1701/1701 - 42s - loss: 3.0665 - accuracy30: 0.4483 - val_loss: 3.1641 - val_accuracy30: 0.4966 - 42s/epoch - 25ms/step
Epoch 7/50
1701/1701 - 42s - loss: 3.0552 - accuracy30: 0.4551 - val_loss: 3.1647 - val_accuracy30: 0.5005 - 42s/epoch - 25ms/step
Epoch 8/50
1701/1701 - 43s - loss: 3.0460 - accuracy30: 0.4593 - val_loss: 3.1674 - val_accuracy30: 0.4982 - 43s/epoch - 25ms/step
Epoch 9/50
1701/1701 - 42s - loss: 3.0359 - accuracy30: 0.4645 - val_loss: 3.1697 - val_accuracy30: 0.5018 - 42s/epoch - 25ms/step
Epoch 10/50
1701/1701 - 42s - loss: 3.0275 - accuracy30: 0.4686 - val_loss: 3.1717 - val_accuracy30: 0.5043 - 42s/epoch - 25ms/step
Epoch 11/50
1701/1701 - 43s - loss: 3.0206 - accuracy30: 0.4716 - val_loss: 3.1742 - val_accuracy30: 0.5045 - 43s/epoch - 25ms/step
Epoch 12/50
1701/1701 - 43s - loss: 3.0128 - accuracy30: 0.4747 - val_loss: 3.1800 - val_accuracy30: 0.5095 - 43s/epoch - 25ms/step
Epoch 13/50
1701/1701 - 43s - loss: 3.0048 - accuracy30: 0.4772 - val_loss: 3.1718 - val_accuracy30: 0.5085 - 43s/epoch - 25ms/step
Epoch 14/50
1701/1701 - 42s - loss: 2.9970 - accuracy30: 0.4796 - val_loss: 3.1747 - val_accuracy30: 0.5103 - 42s/epoch - 25ms/step
Epoch 15/50
1701/1701 - 40s - loss: 2.9895 - accuracy30: 0.4814 - val_loss: 3.1750 - val_accuracy30: 0.5088 - 40s/epoch - 24ms/step
Epoch 16/50
1701/1701 - 43s - loss: 2.9822 - accuracy30: 0.4840 - val_loss: 3.1735 - val_accuracy30: 0.5085 - 43s/epoch - 25ms/step
testing model: results/AAL/W5/deepOF_L1/h30
Evaluating performance on  test set...
6357/6357 - 102s - 102s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.028238
{'0': {'precision': 0.37567157725137573, 'recall': 0.31939897865654054, 'f1-score': 0.3452573758577608, 'support': 397124}, '1': {'precision': 0.5422644837705358, 'recall': 0.6425869065250636, 'f1-score': 0.5881785006938068, 'support': 830490}, '2': {'precision': 0.3927764497855202, 'recall': 0.3002127393317482, 'f1-score': 0.34031265072204725, 'support': 399550}, 'accuracy': 0.4796400362839886, 'macro avg': {'precision': 0.4369041702691439, 'recall': 0.4207328748377841, 'f1-score': 0.4245828424245383, 'support': 1627164}, 'weighted avg': {'precision': 0.464899211808258, 'recall': 0.4796400362839886, 'f1-score': 0.4680279755251044, 'support': 1627164}}
[[126841 223178  47105]
 [158493 533662 138335]
 [ 52304 227296 119950]]
Evaluating performance on  train set...
1701/1701 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0142702
{'0': {'precision': 0.39313935615163126, 'recall': 0.35071506513321166, 'f1-score': 0.3707174171553392, 'support': 103557}, '1': {'precision': 0.5608393063497903, 'recall': 0.666953885854676, 'f1-score': 0.6093110095168892, 'support': 226308}, '2': {'precision': 0.416620438647526, 'recall': 0.29172074692334654, 'f1-score': 0.34315899744792766, 'support': 105553}, 'accuracy': 0.5007785622091875, 'macro avg': {'precision': 0.45686636704964917, 'recall': 0.43646323263707804, 'f1-score': 0.44106247470671867, 'support': 435418}, 'weighted avg': {'precision': 0.48599343896431735, 'recall': 0.5007785622091875, 'f1-score': 0.488045512973108, 'support': 435418}}
[[ 36319  56436  10802]
 [ 43056 150937  32315]
 [ 13007  61754  30792]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0199046
{'0': {'precision': 0.3930137386729027, 'recall': 0.30791251574487577, 'f1-score': 0.3452969502407705, 'support': 34932}, '1': {'precision': 0.5537528697123147, 'recall': 0.6778813183266772, 'f1-score': 0.6095620420304224, 'support': 74367}, '2': {'precision': 0.40729767659441757, 'recall': 0.30059266931353934, 'f1-score': 0.34590299619268333, 'support': 34758}, 'accuracy': 0.4971365501155792, 'macro avg': {'precision': 0.4513547616598783, 'recall': 0.4287955011283641, 'f1-score': 0.4335873294879588, 'support': 144057}, 'weighted avg': {'precision': 0.47943902916405523, 'recall': 0.4971365501155792, 'f1-score': 0.4818655795077803, 'support': 144057}}
[[10756 20295  3881]
 [12632 50412 11323]
 [ 3980 20330 10448]]
training model: results/AAL/W5/deepOF_L1/h50
Epoch 1/50
1701/1701 - 44s - loss: 3.2180 - accuracy50: 0.4117 - val_loss: 3.2956 - val_accuracy50: 0.4286 - 44s/epoch - 26ms/step
Epoch 2/50
1701/1701 - 42s - loss: 3.1858 - accuracy50: 0.4143 - val_loss: 3.2554 - val_accuracy50: 0.4249 - 42s/epoch - 25ms/step
Epoch 3/50
1701/1701 - 42s - loss: 3.1703 - accuracy50: 0.4165 - val_loss: 3.2481 - val_accuracy50: 0.4265 - 42s/epoch - 25ms/step
Epoch 4/50
1701/1701 - 43s - loss: 3.1596 - accuracy50: 0.4190 - val_loss: 3.2337 - val_accuracy50: 0.4280 - 43s/epoch - 25ms/step
Epoch 5/50
1701/1701 - 43s - loss: 3.1466 - accuracy50: 0.4247 - val_loss: 3.2226 - val_accuracy50: 0.4321 - 43s/epoch - 25ms/step
Epoch 6/50
1701/1701 - 44s - loss: 3.1369 - accuracy50: 0.4311 - val_loss: 3.2224 - val_accuracy50: 0.4338 - 44s/epoch - 26ms/step
Epoch 7/50
1701/1701 - 45s - loss: 3.1268 - accuracy50: 0.4358 - val_loss: 3.2222 - val_accuracy50: 0.4398 - 45s/epoch - 27ms/step
Epoch 8/50
1701/1701 - 47s - loss: 3.1187 - accuracy50: 0.4410 - val_loss: 3.2185 - val_accuracy50: 0.4407 - 47s/epoch - 28ms/step
Epoch 9/50
1701/1701 - 45s - loss: 3.1111 - accuracy50: 0.4447 - val_loss: 3.2241 - val_accuracy50: 0.4441 - 45s/epoch - 27ms/step
Epoch 10/50
1701/1701 - 45s - loss: 3.1034 - accuracy50: 0.4482 - val_loss: 3.2266 - val_accuracy50: 0.4460 - 45s/epoch - 26ms/step
Epoch 11/50
1701/1701 - 44s - loss: 3.0967 - accuracy50: 0.4523 - val_loss: 3.2296 - val_accuracy50: 0.4459 - 44s/epoch - 26ms/step
Epoch 12/50
1701/1701 - 43s - loss: 3.0905 - accuracy50: 0.4547 - val_loss: 3.2360 - val_accuracy50: 0.4460 - 43s/epoch - 25ms/step
Epoch 13/50
1701/1701 - 45s - loss: 3.0855 - accuracy50: 0.4567 - val_loss: 3.2412 - val_accuracy50: 0.4484 - 45s/epoch - 27ms/step
Epoch 14/50
1701/1701 - 45s - loss: 3.0790 - accuracy50: 0.4602 - val_loss: 3.2512 - val_accuracy50: 0.4497 - 45s/epoch - 26ms/step
Epoch 15/50
1701/1701 - 44s - loss: 3.0729 - accuracy50: 0.4623 - val_loss: 3.2534 - val_accuracy50: 0.4490 - 44s/epoch - 26ms/step
Epoch 16/50
1701/1701 - 43s - loss: 3.0683 - accuracy50: 0.4632 - val_loss: 3.2561 - val_accuracy50: 0.4501 - 43s/epoch - 25ms/step
Epoch 17/50
1701/1701 - 42s - loss: 3.0622 - accuracy50: 0.4658 - val_loss: 3.2635 - val_accuracy50: 0.4504 - 42s/epoch - 24ms/step
Epoch 18/50
1701/1701 - 43s - loss: 3.0565 - accuracy50: 0.4687 - val_loss: 3.2784 - val_accuracy50: 0.4503 - 43s/epoch - 25ms/step
testing model: results/AAL/W5/deepOF_L1/h50
Evaluating performance on  test set...
6357/6357 - 105s - 105s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0642523
{'0': {'precision': 0.4202409933972013, 'recall': 0.29793200212739096, 'f1-score': 0.34867153546305835, 'support': 483221}, '1': {'precision': 0.4330186596300385, 'recall': 0.6057305657796213, 'f1-score': 0.505016285499311, 'support': 663739}, '2': {'precision': 0.41515050251750174, 'recall': 0.30786499071228063, 'f1-score': 0.3535479026343071, 'support': 480204}, 'accuracy': 0.42641798859856783, 'macro avg': {'precision': 0.4228033851815805, 'recall': 0.4038425195397643, 'f1-score': 0.4024119078655588, 'support': 1627164}, 'weighted avg': {'precision': 0.4239508599658581, 'recall': 0.42641798859856783, 'f1-score': 0.41388546538371457, 'support': 1627164}}
[[143967 264460  74794]
 [128217 402047 133475]
 [ 70398 261968 147838]]
Evaluating performance on  train set...
1701/1701 - 31s - 31s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0460489
{'0': {'precision': 0.4367886608842818, 'recall': 0.3321749762697685, 'f1-score': 0.377365732406079, 'support': 124314}, '1': {'precision': 0.4562520084964298, 'recall': 0.6302477790830495, 'f1-score': 0.5293177566056737, 'support': 184721}, '2': {'precision': 0.43848002613403025, 'recall': 0.2973738556609671, 'f1-score': 0.3543977934416182, 'support': 126383}, 'accuracy': 0.4485276217335985, 'macro avg': {'precision': 0.4438402318382473, 'recall': 0.41993220367126166, 'f1-score': 0.420360427484457, 'support': 435418}, 'weighted avg': {'precision': 0.4455366888680183, 'recall': 0.4485276217335985, 'f1-score': 0.43516300498559546, 'support': 435418}}
[[ 41294  66876  16144]
 [ 36316 116420  31985]
 [ 16930  71870  37583]]
Evaluating performance on  val set...
563/563 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0557597
{'0': {'precision': 0.43218693916419443, 'recall': 0.28043157944769237, 'f1-score': 0.34015076173592196, 'support': 42078}, '1': {'precision': 0.44776497988078356, 'recall': 0.643534168489428, 'f1-score': 0.5280899640334239, 'support': 60348}, '2': {'precision': 0.42450284800639554, 'recall': 0.30611803703970597, 'f1-score': 0.3557193099983252, 'support': 41631}, 'accuracy': 0.43996473618081733, 'macro avg': {'precision': 0.4348182556837912, 'recall': 0.41002792832560875, 'f1-score': 0.40798667858922366, 'support': 144057}, 'weighted avg': {'precision': 0.43649222944633553, 'recall': 0.43996473618081733, 'f1-score': 0.4233809359930685, 'support': 144057}}
[[11800 24212  6066]
 [10301 38836 11211]
 [ 5202 23685 12744]]
training model: results/AAL/W5/deepOF_L1/h100
Epoch 1/50
1701/1701 - 47s - loss: 3.2627 - accuracy100: 0.3943 - val_loss: 3.3238 - val_accuracy100: 0.3633 - 47s/epoch - 28ms/step
Epoch 2/50
1701/1701 - 43s - loss: 3.2377 - accuracy100: 0.4037 - val_loss: 3.3045 - val_accuracy100: 0.3676 - 43s/epoch - 25ms/step
Epoch 3/50
1701/1701 - 44s - loss: 3.2313 - accuracy100: 0.4061 - val_loss: 3.2796 - val_accuracy100: 0.3742 - 44s/epoch - 26ms/step
Epoch 4/50
1701/1701 - 44s - loss: 3.2235 - accuracy100: 0.4084 - val_loss: 3.2729 - val_accuracy100: 0.3763 - 44s/epoch - 26ms/step
Epoch 5/50
1701/1701 - 45s - loss: 3.2174 - accuracy100: 0.4115 - val_loss: 3.2724 - val_accuracy100: 0.3771 - 45s/epoch - 27ms/step
Epoch 6/50
1701/1701 - 45s - loss: 3.2110 - accuracy100: 0.4155 - val_loss: 3.2732 - val_accuracy100: 0.3758 - 45s/epoch - 26ms/step
Epoch 7/50
1701/1701 - 45s - loss: 3.2059 - accuracy100: 0.4178 - val_loss: 3.2695 - val_accuracy100: 0.3768 - 45s/epoch - 26ms/step
Epoch 8/50
1701/1701 - 46s - loss: 3.2014 - accuracy100: 0.4203 - val_loss: 3.2693 - val_accuracy100: 0.3775 - 46s/epoch - 27ms/step
Epoch 9/50
1701/1701 - 44s - loss: 3.1967 - accuracy100: 0.4223 - val_loss: 3.2715 - val_accuracy100: 0.3776 - 44s/epoch - 26ms/step
Epoch 10/50
1701/1701 - 45s - loss: 3.1921 - accuracy100: 0.4250 - val_loss: 3.2730 - val_accuracy100: 0.3779 - 45s/epoch - 26ms/step
Epoch 11/50
1701/1701 - 46s - loss: 3.1886 - accuracy100: 0.4268 - val_loss: 3.2723 - val_accuracy100: 0.3791 - 46s/epoch - 27ms/step
Epoch 12/50
1701/1701 - 43s - loss: 3.1852 - accuracy100: 0.4279 - val_loss: 3.2748 - val_accuracy100: 0.3784 - 43s/epoch - 25ms/step
Epoch 13/50
1701/1701 - 46s - loss: 3.1825 - accuracy100: 0.4287 - val_loss: 3.2742 - val_accuracy100: 0.3787 - 46s/epoch - 27ms/step
Epoch 14/50
1701/1701 - 46s - loss: 3.1786 - accuracy100: 0.4316 - val_loss: 3.2782 - val_accuracy100: 0.3791 - 46s/epoch - 27ms/step
Epoch 15/50
1701/1701 - 43s - loss: 3.1749 - accuracy100: 0.4335 - val_loss: 3.2803 - val_accuracy100: 0.3787 - 43s/epoch - 25ms/step
Epoch 16/50
1701/1701 - 44s - loss: 3.1722 - accuracy100: 0.4346 - val_loss: 3.2823 - val_accuracy100: 0.3781 - 44s/epoch - 26ms/step
Epoch 17/50
1701/1701 - 45s - loss: 3.1696 - accuracy100: 0.4358 - val_loss: 3.2814 - val_accuracy100: 0.3796 - 45s/epoch - 27ms/step
Epoch 18/50
1701/1701 - 45s - loss: 3.1663 - accuracy100: 0.4368 - val_loss: 3.2828 - val_accuracy100: 0.3806 - 45s/epoch - 26ms/step
testing model: results/AAL/W5/deepOF_L1/h100
Evaluating performance on  test set...
6357/6357 - 102s - 102s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.096301
{'0': {'precision': 0.4588931874592676, 'recall': 0.17580841377185386, 'f1-score': 0.2542211433575566, 'support': 564717}, '1': {'precision': 0.3183492754539193, 'recall': 0.5880608061043566, 'f1-score': 0.41307733741073455, 'support': 505344}, '2': {'precision': 0.41728398682677886, 'recall': 0.3575335261163555, 'f1-score': 0.38510491234345323, 'support': 557103}, 'accuracy': 0.366058983605832, 'macro avg': {'precision': 0.39817548324665525, 'recall': 0.3738009153308553, 'f1-score': 0.35080113103724814, 'support': 1627164}, 'weighted avg': {'precision': 0.40099881838006474, 'recall': 0.366058983605832, 'f1-score': 0.34836823909035247, 'support': 1627164}}
[[ 99282 332613 132822]
 [ 62844 297173 145327]
 [ 54225 303695 199183]]
Evaluating performance on  train set...
1701/1701 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0812451
{'0': {'precision': 0.4775438702467607, 'recall': 0.2171095090971507, 'f1-score': 0.2985066173277702, 'support': 145650}, '1': {'precision': 0.3480636928539725, 'recall': 0.6061436320722163, 'f1-score': 0.44220283258734144, 'support': 144898}, '2': {'precision': 0.4291484118291347, 'recall': 0.34618623593566644, 'f1-score': 0.38322877425172125, 'support': 144870}, 'accuracy': 0.3895176588932933, 'macro avg': {'precision': 0.41825199164328924, 'recall': 0.38981312570167787, 'f1-score': 0.3746460747222777, 'support': 435418}, 'weighted avg': {'precision': 0.41835369252139865, 'recall': 0.3895176588932933, 'f1-score': 0.3745140241695961, 'support': 435418}}
[[31622 84242 29786]
 [20143 87829 36926]
 [14453 80265 50152]]
Evaluating performance on  val set...
563/563 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0898709
{'0': {'precision': 0.47196693675566914, 'recall': 0.17755365070272702, 'f1-score': 0.25803478519399436, 'support': 48881}, '1': {'precision': 0.34060168866300516, 'recall': 0.6161032028469751, 'f1-score': 0.4386844744760597, 'support': 47208}, '2': {'precision': 0.4132836747361887, 'recall': 0.34700216811207474, 'f1-score': 0.37725371984180045, 'support': 47968}, 'accuracy': 0.3776907751792693, 'macro avg': {'precision': 0.4086174333849544, 'recall': 0.3802196738872589, 'f1-score': 0.35799099317061817, 'support': 144057}, 'weighted avg': {'precision': 0.409377757857671, 'recall': 0.3776907751792693, 'f1-score': 0.35693178005584564, 'support': 144057}}
[[ 8679 29299 10903]
 [ 5396 29085 12727]
 [ 4314 27009 16645]]
training model: results/AAL/W5/deepOF_L1/h200
Epoch 1/50
1701/1701 - 48s - loss: 3.2892 - accuracy200: 0.3716 - val_loss: 3.3126 - val_accuracy200: 0.3367 - 48s/epoch - 28ms/step
Epoch 2/50
1701/1701 - 47s - loss: 3.2735 - accuracy200: 0.3775 - val_loss: 3.3193 - val_accuracy200: 0.3443 - 47s/epoch - 28ms/step
Epoch 3/50
1701/1701 - 46s - loss: 3.2693 - accuracy200: 0.3783 - val_loss: 3.3127 - val_accuracy200: 0.3508 - 46s/epoch - 27ms/step
Epoch 4/50
1701/1701 - 48s - loss: 3.2655 - accuracy200: 0.3799 - val_loss: 3.3096 - val_accuracy200: 0.3527 - 48s/epoch - 28ms/step
Epoch 5/50
1701/1701 - 47s - loss: 3.2633 - accuracy200: 0.3814 - val_loss: 3.3078 - val_accuracy200: 0.3548 - 47s/epoch - 28ms/step
Epoch 6/50
1701/1701 - 46s - loss: 3.2607 - accuracy200: 0.3827 - val_loss: 3.3080 - val_accuracy200: 0.3547 - 46s/epoch - 27ms/step
Epoch 7/50
1701/1701 - 44s - loss: 3.2591 - accuracy200: 0.3835 - val_loss: 3.3099 - val_accuracy200: 0.3536 - 44s/epoch - 26ms/step
Epoch 8/50
1701/1701 - 42s - loss: 3.2571 - accuracy200: 0.3849 - val_loss: 3.3096 - val_accuracy200: 0.3550 - 42s/epoch - 25ms/step
Epoch 9/50
1701/1701 - 46s - loss: 3.2558 - accuracy200: 0.3857 - val_loss: 3.3090 - val_accuracy200: 0.3563 - 46s/epoch - 27ms/step
Epoch 10/50
1701/1701 - 43s - loss: 3.2541 - accuracy200: 0.3870 - val_loss: 3.3091 - val_accuracy200: 0.3573 - 43s/epoch - 25ms/step
Epoch 11/50
1701/1701 - 43s - loss: 3.2524 - accuracy200: 0.3879 - val_loss: 3.3105 - val_accuracy200: 0.3568 - 43s/epoch - 26ms/step
Epoch 12/50
1701/1701 - 45s - loss: 3.2510 - accuracy200: 0.3887 - val_loss: 3.3138 - val_accuracy200: 0.3593 - 45s/epoch - 27ms/step
Epoch 13/50
1701/1701 - 45s - loss: 3.2493 - accuracy200: 0.3903 - val_loss: 3.3131 - val_accuracy200: 0.3587 - 45s/epoch - 27ms/step
Epoch 14/50
1701/1701 - 44s - loss: 3.2479 - accuracy200: 0.3907 - val_loss: 3.3133 - val_accuracy200: 0.3591 - 44s/epoch - 26ms/step
Epoch 15/50
1701/1701 - 43s - loss: 3.2467 - accuracy200: 0.3924 - val_loss: 3.3161 - val_accuracy200: 0.3607 - 43s/epoch - 25ms/step
testing model: results/AAL/W5/deepOF_L1/h200
Evaluating performance on  test set...
6357/6357 - 101s - 101s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1105845
{'0': {'precision': 0.4557090527033167, 'recall': 0.10572840319525653, 'f1-score': 0.17163582499792784, 'support': 607150}, '1': {'precision': 0.26149189411040424, 'recall': 0.37685317687464226, 'f1-score': 0.3087485296014194, 'support': 419280}, '2': {'precision': 0.4024860325061675, 'recall': 0.5909637210479181, 'f1-score': 0.47884584517481327, 'support': 600734}, 'accuracy': 0.354734986762244, 'macro avg': {'precision': 0.3732289931066295, 'recall': 0.35784843370593894, 'f1-score': 0.3197433999247202, 'support': 1627164}, 'weighted avg': {'precision': 0.3860146346422297, 'recall': 0.354734986762244, 'f1-score': 0.3203855017650472, 'support': 1627164}}
[[ 64193 242373 300584]
 [ 34821 158007 226452]
 [ 41850 203872 355012]]
Evaluating performance on  train set...
1701/1701 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0954686
{'0': {'precision': 0.41595897339386956, 'recall': 0.12174332139906362, 'f1-score': 0.18835786076090952, 'support': 145240}, '1': {'precision': 0.3392262192177692, 'recall': 0.38349163459701413, 'f1-score': 0.36000333081387154, 'support': 146556}, '2': {'precision': 0.3715326828881877, 'recall': 0.5878138446756068, 'f1-score': 0.45529336579920243, 'support': 143622}, 'accuracy': 0.36357706847213483, 'macro avg': {'precision': 0.3755726251666088, 'recall': 0.36434960022389484, 'f1-score': 0.33455151912466113, 'support': 435418}, 'weighted avg': {'precision': 0.37547778470612675, 'recall': 0.36357706847213483, 'f1-score': 0.3341797712324371, 'support': 435418}}
[[17682 60313 67245]
 [14792 56203 75561]
 [10035 49164 84423]]
Evaluating performance on  val set...
563/563 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1024623
{'0': {'precision': 0.42722486413043476, 'recall': 0.10080548208704015, 'f1-score': 0.16312171713896634, 'support': 49908}, '1': {'precision': 0.3164366612734368, 'recall': 0.36417008039606563, 'f1-score': 0.33862951193677177, 'support': 45649}, '2': {'precision': 0.3682441752564392, 'recall': 0.6054845360824742, 'f1-score': 0.4579636012039362, 'support': 48500}, 'accuracy': 0.3541723067952269, 'macro avg': {'precision': 0.3706352335534369, 'recall': 0.3568200328551933, 'f1-score': 0.3199049434265581, 'support': 144057}, 'weighted avg': {'precision': 0.372260967321478, 'recall': 0.3541723067952269, 'f1-score': 0.3180019846849798, 'support': 144057}}
[[ 5031 19868 25009]
 [ 3654 16624 25371]
 [ 3091 16043 29366]]
training model: results/AAL/W5/deepOF_L1/h300
Epoch 1/50
1701/1701 - 49s - loss: 3.3005 - accuracy300: 0.3611 - val_loss: 3.3044 - val_accuracy300: 0.3458 - 49s/epoch - 29ms/step
Epoch 2/50
1701/1701 - 46s - loss: 3.2839 - accuracy300: 0.3667 - val_loss: 3.3044 - val_accuracy300: 0.3488 - 46s/epoch - 27ms/step
Epoch 3/50
1701/1701 - 45s - loss: 3.2802 - accuracy300: 0.3684 - val_loss: 3.3003 - val_accuracy300: 0.3506 - 45s/epoch - 27ms/step
Epoch 4/50
1701/1701 - 46s - loss: 3.2778 - accuracy300: 0.3697 - val_loss: 3.2989 - val_accuracy300: 0.3542 - 46s/epoch - 27ms/step
Epoch 5/50
1701/1701 - 46s - loss: 3.2758 - accuracy300: 0.3720 - val_loss: 3.2979 - val_accuracy300: 0.3551 - 46s/epoch - 27ms/step
Epoch 6/50
1701/1701 - 43s - loss: 3.2744 - accuracy300: 0.3725 - val_loss: 3.2981 - val_accuracy300: 0.3557 - 43s/epoch - 25ms/step
Epoch 7/50
1701/1701 - 43s - loss: 3.2727 - accuracy300: 0.3742 - val_loss: 3.2986 - val_accuracy300: 0.3549 - 43s/epoch - 25ms/step
Epoch 8/50
1701/1701 - 44s - loss: 3.2719 - accuracy300: 0.3753 - val_loss: 3.2977 - val_accuracy300: 0.3565 - 44s/epoch - 26ms/step
Epoch 9/50
1701/1701 - 42s - loss: 3.2708 - accuracy300: 0.3751 - val_loss: 3.2980 - val_accuracy300: 0.3557 - 42s/epoch - 25ms/step
Epoch 10/50
1701/1701 - 45s - loss: 3.2695 - accuracy300: 0.3763 - val_loss: 3.2979 - val_accuracy300: 0.3574 - 45s/epoch - 26ms/step
Epoch 11/50
1701/1701 - 44s - loss: 3.2687 - accuracy300: 0.3781 - val_loss: 3.2980 - val_accuracy300: 0.3569 - 44s/epoch - 26ms/step
Epoch 12/50
1701/1701 - 44s - loss: 3.2677 - accuracy300: 0.3780 - val_loss: 3.2986 - val_accuracy300: 0.3560 - 44s/epoch - 26ms/step
Epoch 13/50
1701/1701 - 42s - loss: 3.2668 - accuracy300: 0.3786 - val_loss: 3.2999 - val_accuracy300: 0.3567 - 42s/epoch - 24ms/step
Epoch 14/50
1701/1701 - 41s - loss: 3.2653 - accuracy300: 0.3797 - val_loss: 3.3013 - val_accuracy300: 0.3560 - 41s/epoch - 24ms/step
Epoch 15/50
1701/1701 - 45s - loss: 3.2644 - accuracy300: 0.3807 - val_loss: 3.2990 - val_accuracy300: 0.3581 - 45s/epoch - 27ms/step
Epoch 16/50
1701/1701 - 45s - loss: 3.2632 - accuracy300: 0.3817 - val_loss: 3.3004 - val_accuracy300: 0.3569 - 45s/epoch - 26ms/step
Epoch 17/50
1701/1701 - 44s - loss: 3.2622 - accuracy300: 0.3822 - val_loss: 3.3011 - val_accuracy300: 0.3564 - 44s/epoch - 26ms/step
Epoch 18/50
1701/1701 - 43s - loss: 3.2611 - accuracy300: 0.3834 - val_loss: 3.3009 - val_accuracy300: 0.3564 - 43s/epoch - 25ms/step
testing model: results/AAL/W5/deepOF_L1/h300
Evaluating performance on  test set...
6357/6357 - 98s - 98s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.098959
{'0': {'precision': 0.3919206630963037, 'recall': 0.27276838902351674, 'f1-score': 0.32166489746407373, 'support': 568233}, '1': {'precision': 0.33474507855679064, 'recall': 0.05439782344119921, 'f1-score': 0.09358723280136672, 'support': 495461}, '2': {'precision': 0.3657171697341229, 'recall': 0.7471613395566756, 'f1-score': 0.4910683927422708, 'support': 563470}, 'accuracy': 0.3705533062432551, 'macro avg': {'precision': 0.3641276371290724, 'recall': 0.3581091840071305, 'f1-score': 0.3021068410025704, 'support': 1627164}, 'weighted avg': {'precision': 0.3654370666694409, 'recall': 0.3705533062432551, 'f1-score': 0.31087938332595133, 'support': 1627164}}
[[154996  28300 384937]
 [123278  26952 345231]
 [117204  25263 421003]]
Evaluating performance on  train set...
1701/1701 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958577
{'0': {'precision': 0.3923801899494196, 'recall': 0.29242826924119975, 'f1-score': 0.3351099370678268, 'support': 147496}, '1': {'precision': 0.3566160347645816, 'recall': 0.06296989834708416, 'f1-score': 0.1070392197923834, 'support': 142052}, '2': {'precision': 0.35981705064062236, 'recall': 0.7410228285459656, 'f1-score': 0.48441676880709694, 'support': 145870}, 'accuracy': 0.36785341901345375, 'macro avg': {'precision': 0.36960442511820785, 'recall': 0.3654736653780832, 'f1-score': 0.30885530855576904, 'support': 435418}, 'weighted avg': {'precision': 0.36980336744026543, 'recall': 0.36785341901345375, 'f1-score': 0.31072299398186354, 'support': 435418}}
[[ 43132   8816  95548]
 [ 36337   8945  96770]
 [ 30455   7322 108093]]
Evaluating performance on  val set...
563/563 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099501
{'0': {'precision': 0.38286083664234927, 'recall': 0.25438183863380714, 'f1-score': 0.3056695583790028, 'support': 48895}, '1': {'precision': 0.3530986481060099, 'recall': 0.05561059932120497, 'f1-score': 0.09608800174837911, 'support': 47437}, '2': {'precision': 0.3486008511128829, 'recall': 0.7603771608171818, 'f1-score': 0.4780403625250289, 'support': 47725}, 'accuracy': 0.35656025045641654, 'macro avg': {'precision': 0.3615201119537474, 'recall': 0.356789866257398, 'f1-score': 0.2932659742174703, 'support': 144057}, 'weighted avg': {'precision': 0.36171027299745795, 'recall': 0.35656025045641654, 'f1-score': 0.29376091337030624, 'support': 144057}}
[[12438  2702 33755]
 [10744  2638 34055]
 [ 9305  2131 36289]]
training model: results/AAL/W5/deepOF_L1/h500
Epoch 1/50
1701/1701 - 47s - loss: 3.2757 - accuracy500: 0.3887 - val_loss: 3.5409 - val_accuracy500: 0.2773 - 47s/epoch - 27ms/step
Epoch 2/50
1701/1701 - 45s - loss: 3.2861 - accuracy500: 0.3703 - val_loss: 3.4993 - val_accuracy500: 0.2770 - 45s/epoch - 27ms/step
Epoch 3/50
1701/1701 - 45s - loss: 3.2843 - accuracy500: 0.3682 - val_loss: 3.4632 - val_accuracy500: 0.2770 - 45s/epoch - 26ms/step
Epoch 4/50
1701/1701 - 45s - loss: 3.2815 - accuracy500: 0.3719 - val_loss: 3.5205 - val_accuracy500: 0.2767 - 45s/epoch - 27ms/step
Epoch 5/50
1701/1701 - 43s - loss: 3.2805 - accuracy500: 0.3712 - val_loss: 3.4516 - val_accuracy500: 0.2767 - 43s/epoch - 25ms/step
Epoch 6/50
1701/1701 - 42s - loss: 3.2783 - accuracy500: 0.3722 - val_loss: 3.4424 - val_accuracy500: 0.2766 - 42s/epoch - 25ms/step
Epoch 7/50
1701/1701 - 43s - loss: 3.2755 - accuracy500: 0.3744 - val_loss: 3.4490 - val_accuracy500: 0.2768 - 43s/epoch - 25ms/step
Epoch 8/50
1701/1701 - 41s - loss: 3.2740 - accuracy500: 0.3764 - val_loss: 3.4607 - val_accuracy500: 0.2768 - 41s/epoch - 24ms/step
Epoch 9/50
1701/1701 - 43s - loss: 3.2724 - accuracy500: 0.3771 - val_loss: 3.4676 - val_accuracy500: 0.2765 - 43s/epoch - 25ms/step
Epoch 10/50
1701/1701 - 43s - loss: 3.2714 - accuracy500: 0.3778 - val_loss: 3.4625 - val_accuracy500: 0.2767 - 43s/epoch - 25ms/step
Epoch 11/50
1701/1701 - 44s - loss: 3.2698 - accuracy500: 0.3792 - val_loss: 3.4745 - val_accuracy500: 0.2767 - 44s/epoch - 26ms/step
Epoch 12/50
1701/1701 - 44s - loss: 3.2691 - accuracy500: 0.3800 - val_loss: 3.4824 - val_accuracy500: 0.2766 - 44s/epoch - 26ms/step
Epoch 13/50
1701/1701 - 45s - loss: 3.2685 - accuracy500: 0.3790 - val_loss: 3.4806 - val_accuracy500: 0.2768 - 45s/epoch - 26ms/step
Epoch 14/50
1701/1701 - 44s - loss: 3.2668 - accuracy500: 0.3810 - val_loss: 3.4786 - val_accuracy500: 0.2766 - 44s/epoch - 26ms/step
Epoch 15/50
1701/1701 - 43s - loss: 3.2655 - accuracy500: 0.3825 - val_loss: 3.4802 - val_accuracy500: 0.2766 - 43s/epoch - 25ms/step
Epoch 16/50
1701/1701 - 44s - loss: 3.2645 - accuracy500: 0.3830 - val_loss: 3.4909 - val_accuracy500: 0.2767 - 44s/epoch - 26ms/step
testing model: results/AAL/W5/deepOF_L1/h500
Evaluating performance on  test set...
6357/6357 - 101s - 101s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.15279
{'0': {'precision': 0.4722483537158984, 'recall': 0.0016520439930758953, 'f1-score': 0.0032925697457440914, 'support': 607732}, '1': {'precision': 0.2551557167143555, 'recall': 0.997864081410525, 'f1-score': 0.40639537421010336, 'support': 415278}, '2': {'precision': 0.39710444674250256, 'recall': 0.0006355995325695104, 'f1-score': 0.0012691676540724911, 'support': 604154}, 'accuracy': 0.2555237210262764, 'macro avg': {'precision': 0.3748361723909188, 'recall': 0.33338390831205683, 'f1-score': 0.1369857038699733, 'support': 1627164}, 'weighted avg': {'precision': 0.388942498816004, 'recall': 0.2555237210262764, 'f1-score': 0.10541950960248775, 'support': 1627164}}
[[  1004 606421    307]
 [   611 414391    276]
 [   511 603259    384]]
Evaluating performance on  train set...
1701/1701 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1183676
{'0': {'precision': 0.4386422976501306, 'recall': 0.002310215138784799, 'f1-score': 0.004596223163049648, 'support': 145441}, '1': {'precision': 0.33682533763330963, 'recall': 0.9978518675113714, 'f1-score': 0.5036450624720338, 'support': 146639}, '2': {'precision': 0.36796536796536794, 'recall': 0.0005930039487086467, 'f1-score': 0.0011840996315360557, 'support': 143338}, 'accuracy': 0.33702097754341803, 'macro avg': {'precision': 0.38114433441626944, 'recall': 0.33358502886628827, 'f1-score': 0.16980846175553985, 'support': 435418}, 'weighted avg': {'precision': 0.38108604837458127, 'recall': 0.33702097754341803, 'f1-score': 0.1715414017837544, 'support': 435418}}
[[   336 145035     70]
 [   239 146324     76]
 [   191 143062     85]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1455833
{'0': {'precision': 0.421875, 'recall': 0.00204425432038008, 'f1-score': 0.004068792736451485, 'support': 52831}, '1': {'precision': 0.2763491135788038, 'recall': 0.9974134250772205, 'f1-score': 0.4327875997711733, 'support': 39821}, '2': {'precision': 0.45454545454545453, 'recall': 0.0006808676198813345, 'f1-score': 0.0013596985354104346, 'support': 51405}, 'accuracy': 0.2767029717403528, 'macro avg': {'precision': 0.38425652270808613, 'recall': 0.33337951567249396, 'f1-score': 0.14607203034767843, 'support': 144057}, 'weighted avg': {'precision': 0.393306019615365, 'recall': 0.2767029717403528, 'f1-score': 0.12161081171175392, 'support': 144057}}
[[  108 52702    21]
 [   82 39718    21]
 [   66 51304    35]]
training model: results/AAL/W5/deepOF_L1/h1000
Epoch 1/50
1701/1701 - 47s - loss: 3.2841 - accuracy1000: 0.3801 - val_loss: 3.3461 - val_accuracy1000: 0.3271 - 47s/epoch - 28ms/step
Epoch 2/50
1701/1701 - 42s - loss: 3.2815 - accuracy1000: 0.3707 - val_loss: 3.3367 - val_accuracy1000: 0.3399 - 42s/epoch - 25ms/step
Epoch 3/50
1701/1701 - 40s - loss: 3.2814 - accuracy1000: 0.3687 - val_loss: 3.3283 - val_accuracy1000: 0.3358 - 40s/epoch - 23ms/step
Epoch 4/50
1701/1701 - 39s - loss: 3.2795 - accuracy1000: 0.3708 - val_loss: 3.3248 - val_accuracy1000: 0.3284 - 39s/epoch - 23ms/step
Epoch 5/50
1701/1701 - 40s - loss: 3.2785 - accuracy1000: 0.3704 - val_loss: 3.3244 - val_accuracy1000: 0.3378 - 40s/epoch - 23ms/step
Epoch 6/50
1701/1701 - 40s - loss: 3.2766 - accuracy1000: 0.3718 - val_loss: 3.3301 - val_accuracy1000: 0.3327 - 40s/epoch - 23ms/step
Epoch 7/50
1701/1701 - 40s - loss: 3.2743 - accuracy1000: 0.3731 - val_loss: 3.3350 - val_accuracy1000: 0.3299 - 40s/epoch - 23ms/step
Epoch 8/50
1701/1701 - 39s - loss: 3.2723 - accuracy1000: 0.3740 - val_loss: 3.3411 - val_accuracy1000: 0.3309 - 39s/epoch - 23ms/step
Epoch 9/50
1701/1701 - 40s - loss: 3.2706 - accuracy1000: 0.3747 - val_loss: 3.3464 - val_accuracy1000: 0.3334 - 40s/epoch - 24ms/step
Epoch 10/50
1701/1701 - 43s - loss: 3.2688 - accuracy1000: 0.3766 - val_loss: 3.3502 - val_accuracy1000: 0.3312 - 43s/epoch - 25ms/step
Epoch 11/50
1701/1701 - 43s - loss: 3.2680 - accuracy1000: 0.3770 - val_loss: 3.3530 - val_accuracy1000: 0.3259 - 43s/epoch - 25ms/step
Epoch 12/50
1701/1701 - 43s - loss: 3.2683 - accuracy1000: 0.3773 - val_loss: 3.3535 - val_accuracy1000: 0.3268 - 43s/epoch - 25ms/step
Epoch 13/50
1701/1701 - 42s - loss: 3.2668 - accuracy1000: 0.3780 - val_loss: 3.3580 - val_accuracy1000: 0.3230 - 42s/epoch - 25ms/step
Epoch 14/50
1701/1701 - 43s - loss: 3.2658 - accuracy1000: 0.3790 - val_loss: 3.3576 - val_accuracy1000: 0.3161 - 43s/epoch - 25ms/step
Epoch 15/50
1701/1701 - 41s - loss: 3.2660 - accuracy1000: 0.3798 - val_loss: 3.3570 - val_accuracy1000: 0.3156 - 41s/epoch - 24ms/step
testing model: results/AAL/W5/deepOF_L1/h1000
Evaluating performance on  test set...
6357/6357 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1159874
{'0': {'precision': 0.42315081652257447, 'recall': 0.017352977718249337, 'f1-score': 0.03333876705071405, 'support': 660002}, '1': {'precision': 0.18878720688033326, 'recall': 0.2295988076015402, 'f1-score': 0.20720251676590273, 'support': 305938}, '2': {'precision': 0.41084816815320235, 'recall': 0.763025842982106, 'f1-score': 0.534108033518116, 'support': 661224}, 'accuracy': 0.3602753010759825, 'macro avg': {'precision': 0.34092873051870337, 'recall': 0.33665920943396516, 'f1-score': 0.2582164391115776, 'support': 1627164}, 'weighted avg': {'precision': 0.3740865916674783, 'recall': 0.3602753010759825, 'f1-score': 0.269524047275084, 'support': 1627164}}
[[ 11453 155052 493497]
 [  5700  70243 229995]
 [  9913 146780 504531]]
Evaluating performance on  train set...
1701/1701 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1049403
{'0': {'precision': 0.3771998654859321, 'recall': 0.022670619147072694, 'f1-score': 0.042770621095512586, 'support': 148430}, '1': {'precision': 0.32831276734988096, 'recall': 0.24240026330347827, 'f1-score': 0.2788900795217416, 'support': 142801}, '2': {'precision': 0.33647185607853886, 'recall': 0.7492284325216559, 'f1-score': 0.4643901893816456, 'support': 144187}, 'accuracy': 0.33533064779131777, 'macro avg': {'precision': 0.34732816297145064, 'recall': 0.3380997716574023, 'f1-score': 0.2620169633329666, 'support': 435418}, 'weighted avg': {'precision': 0.3476797813521801, 'recall': 0.33533064779131777, 'f1-score': 0.2598267728283224, 'support': 435418}}
[[  3365  37193 107872]
 [  3023  34615 105163]
 [  2533  33625 108029]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1115303
{'0': {'precision': 0.41353996737357257, 'recall': 0.018980233602875114, 'f1-score': 0.03629465244469898, 'support': 53424}, '1': {'precision': 0.27456390174439305, 'recall': 0.23106306486243572, 'f1-score': 0.2509422195710529, 'support': 40054}, '2': {'precision': 0.3549496278858541, 'recall': 0.7571917198837462, 'f1-score': 0.48332870592392546, 'support': 50579}, 'accuracy': 0.337137383119182, 'macro avg': {'precision': 0.34768449900127324, 'recall': 0.33574500611635233, 'f1-score': 0.25685519264655915, 'support': 144057}, 'weighted avg': {'precision': 0.35432737712345996, 'recall': 0.337137383119182, 'f1-score': 0.25293132434960314, 'support': 144057}}
[[ 1014 12942 39468]
 [  668  9255 30131]
 [  770 11511 38298]]
training model: results/AAL/W5/deepLOB_L2/h10
Epoch 1/50
1701/1701 - 83s - loss: 2.9672 - accuracy10: 0.4306 - val_loss: 3.3961 - val_accuracy10: 0.3165 - 83s/epoch - 49ms/step
Epoch 2/50
1701/1701 - 80s - loss: 2.8188 - accuracy10: 0.4542 - val_loss: 3.1404 - val_accuracy10: 0.2646 - 80s/epoch - 47ms/step
Epoch 3/50
1701/1701 - 81s - loss: 2.7079 - accuracy10: 0.4986 - val_loss: 3.0981 - val_accuracy10: 0.3613 - 81s/epoch - 47ms/step
Epoch 4/50
1701/1701 - 80s - loss: 2.6157 - accuracy10: 0.5474 - val_loss: 2.8605 - val_accuracy10: 0.5237 - 80s/epoch - 47ms/step
Epoch 5/50
1701/1701 - 81s - loss: 2.5158 - accuracy10: 0.5918 - val_loss: 2.7278 - val_accuracy10: 0.5243 - 81s/epoch - 48ms/step
Epoch 6/50
1701/1701 - 90s - loss: 2.4592 - accuracy10: 0.6089 - val_loss: 2.6841 - val_accuracy10: 0.5206 - 90s/epoch - 53ms/step
Epoch 7/50
1701/1701 - 81s - loss: 2.4248 - accuracy10: 0.6180 - val_loss: 2.6423 - val_accuracy10: 0.5000 - 81s/epoch - 48ms/step
Epoch 8/50
1701/1701 - 80s - loss: 2.3978 - accuracy10: 0.6223 - val_loss: 2.6339 - val_accuracy10: 0.5547 - 80s/epoch - 47ms/step
Epoch 9/50
1701/1701 - 80s - loss: 2.3756 - accuracy10: 0.6265 - val_loss: 2.6273 - val_accuracy10: 0.5331 - 80s/epoch - 47ms/step
Epoch 10/50
1701/1701 - 81s - loss: 2.3574 - accuracy10: 0.6275 - val_loss: 2.6575 - val_accuracy10: 0.5100 - 81s/epoch - 48ms/step
Epoch 11/50
1701/1701 - 81s - loss: 2.3419 - accuracy10: 0.6291 - val_loss: 2.6310 - val_accuracy10: 0.5393 - 81s/epoch - 47ms/step
Epoch 12/50
1701/1701 - 81s - loss: 2.3300 - accuracy10: 0.6303 - val_loss: 2.6368 - val_accuracy10: 0.5276 - 81s/epoch - 47ms/step
Epoch 13/50
1701/1701 - 81s - loss: 2.3185 - accuracy10: 0.6315 - val_loss: 2.5866 - val_accuracy10: 0.5047 - 81s/epoch - 48ms/step
Epoch 14/50
1701/1701 - 81s - loss: 2.3078 - accuracy10: 0.6329 - val_loss: 2.5646 - val_accuracy10: 0.5342 - 81s/epoch - 48ms/step
Epoch 15/50
1701/1701 - 81s - loss: 2.2979 - accuracy10: 0.6334 - val_loss: 2.5786 - val_accuracy10: 0.5129 - 81s/epoch - 47ms/step
Epoch 16/50
1701/1701 - 81s - loss: 2.2900 - accuracy10: 0.6343 - val_loss: 2.5889 - val_accuracy10: 0.5142 - 81s/epoch - 48ms/step
Epoch 17/50
1701/1701 - 80s - loss: 2.2825 - accuracy10: 0.6355 - val_loss: 2.5645 - val_accuracy10: 0.5178 - 80s/epoch - 47ms/step
Epoch 18/50
1701/1701 - 81s - loss: 2.2753 - accuracy10: 0.6360 - val_loss: 2.5611 - val_accuracy10: 0.5572 - 81s/epoch - 48ms/step
Epoch 19/50
1701/1701 - 83s - loss: 2.2681 - accuracy10: 0.6375 - val_loss: 2.5942 - val_accuracy10: 0.5077 - 83s/epoch - 49ms/step
Epoch 20/50
1701/1701 - 81s - loss: 2.2614 - accuracy10: 0.6371 - val_loss: 2.5708 - val_accuracy10: 0.5374 - 81s/epoch - 48ms/step
Epoch 21/50
1701/1701 - 82s - loss: 2.2544 - accuracy10: 0.6374 - val_loss: 2.6122 - val_accuracy10: 0.5009 - 82s/epoch - 48ms/step
Epoch 22/50
1701/1701 - 82s - loss: 2.2474 - accuracy10: 0.6387 - val_loss: 2.5737 - val_accuracy10: 0.5499 - 82s/epoch - 48ms/step
Epoch 23/50
1701/1701 - 82s - loss: 2.2416 - accuracy10: 0.6399 - val_loss: 2.5982 - val_accuracy10: 0.5191 - 82s/epoch - 48ms/step
Epoch 24/50
1701/1701 - 81s - loss: 2.2350 - accuracy10: 0.6397 - val_loss: 2.5849 - val_accuracy10: 0.5308 - 81s/epoch - 48ms/step
Epoch 25/50
1701/1701 - 81s - loss: 2.2290 - accuracy10: 0.6408 - val_loss: 2.6306 - val_accuracy10: 0.5196 - 81s/epoch - 48ms/step
Epoch 26/50
1701/1701 - 81s - loss: 2.2238 - accuracy10: 0.6413 - val_loss: 2.6732 - val_accuracy10: 0.4854 - 81s/epoch - 48ms/step
Epoch 27/50
1701/1701 - 80s - loss: 2.2189 - accuracy10: 0.6418 - val_loss: 2.6712 - val_accuracy10: 0.4941 - 80s/epoch - 47ms/step
Epoch 28/50
1701/1701 - 81s - loss: 2.2118 - accuracy10: 0.6427 - val_loss: 2.7634 - val_accuracy10: 0.4628 - 81s/epoch - 48ms/step
testing model: results/AAL/W5/deepLOB_L2/h10
Evaluating performance on  test set...
6357/6357 - 119s - 119s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9017179
{'0': {'precision': 0.45547033815597165, 'recall': 0.3712029798048383, 'f1-score': 0.4090417413090601, 'support': 257735}, '1': {'precision': 0.8404346204793125, 'recall': 0.5459108003242836, 'f1-score': 0.6618874768167835, 'support': 1106439}, '2': {'precision': 0.297132679096592, 'recall': 0.789079640297344, 'f1-score': 0.4317044529064912, 'support': 262995}, 'accuracy': 0.5575407348591327, 'macro avg': {'precision': 0.5310125459106254, 'recall': 0.5687311401421553, 'f1-score': 0.5008778903441117, 'support': 1627169}, 'weighted avg': {'precision': 0.6916458570634935, 'recall': 0.5575407348591327, 'f1-score': 0.5846341736784061, 'support': 1627169}}
[[ 95672  77801  84262]
 [ 95786 604017 406636]
 [ 18593  36878 207524]]
Evaluating performance on  train set...
1701/1701 - 32s - 32s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87767524
{'0': {'precision': 0.37129564359227407, 'recall': 0.5851664222548104, 'f1-score': 0.45431962462048026, 'support': 67509}, '1': {'precision': 0.8777167368191671, 'recall': 0.5142905144316388, 'f1-score': 0.6485618400311869, 'support': 297610}, '2': {'precision': 0.3356160397307312, 'recall': 0.738275082149106, 'f1-score': 0.4614563883702321, 'support': 70299}, 'accuracy': 0.5614421085026342, 'macro avg': {'precision': 0.528209473380724, 'recall': 0.6125773396118518, 'f1-score': 0.5214459510072997, 'support': 435418}, 'weighted avg': {'precision': 0.7116760162075382, 'recall': 0.5614421085026342, 'f1-score': 0.5882372235328455, 'support': 435418}}
[[ 39504  11817  16188]
 [ 57999 153058  86553]
 [  8892   9507  51900]]
Evaluating performance on  val set...
563/563 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8847785
{'0': {'precision': 0.38049378392575733, 'recall': 0.5850309611415239, 'f1-score': 0.4610977507426793, 'support': 22286}, '1': {'precision': 0.8679313058054805, 'recall': 0.5118425565396332, 'f1-score': 0.6439376633924718, 'support': 99134}, '2': {'precision': 0.3209171845473496, 'recall': 0.7276381465612439, 'f1-score': 0.4453967824793835, 'support': 22639}, 'accuracy': 0.5570773086027253, 'macro avg': {'precision': 0.5231140914261958, 'recall': 0.608170554747467, 'f1-score': 0.5168107322048449, 'support': 144059}, 'weighted avg': {'precision': 0.7065607194223018, 'recall': 0.5570773086027253, 'f1-score': 0.5844513605838678, 'support': 144059}}
[[13038  4332  4916]
 [18451 50741 29942]
 [ 2777  3389 16473]]
training model: results/AAL/W5/deepLOB_L2/h20
Epoch 1/50
1701/1701 - 83s - loss: 3.0219 - accuracy20: 0.4461 - val_loss: 3.4742 - val_accuracy20: 0.4311 - 83s/epoch - 49ms/step
Epoch 2/50
1701/1701 - 81s - loss: 2.8614 - accuracy20: 0.4846 - val_loss: 3.6953 - val_accuracy20: 0.3503 - 81s/epoch - 47ms/step
Epoch 3/50
1701/1701 - 82s - loss: 2.7776 - accuracy20: 0.5155 - val_loss: 3.2576 - val_accuracy20: 0.4824 - 82s/epoch - 48ms/step
Epoch 4/50
1701/1701 - 82s - loss: 2.6920 - accuracy20: 0.5530 - val_loss: 3.2027 - val_accuracy20: 0.5428 - 82s/epoch - 48ms/step
Epoch 5/50
1701/1701 - 82s - loss: 2.6184 - accuracy20: 0.5793 - val_loss: 2.9404 - val_accuracy20: 0.5380 - 82s/epoch - 48ms/step
Epoch 6/50
1701/1701 - 81s - loss: 2.5731 - accuracy20: 0.5932 - val_loss: 3.0021 - val_accuracy20: 0.5570 - 81s/epoch - 48ms/step
Epoch 7/50
1701/1701 - 81s - loss: 2.5418 - accuracy20: 0.6006 - val_loss: 2.9662 - val_accuracy20: 0.5619 - 81s/epoch - 47ms/step
Epoch 8/50
1701/1701 - 80s - loss: 2.5160 - accuracy20: 0.6061 - val_loss: 2.9691 - val_accuracy20: 0.5376 - 80s/epoch - 47ms/step
Epoch 9/50
1701/1701 - 81s - loss: 2.4956 - accuracy20: 0.6093 - val_loss: 2.9126 - val_accuracy20: 0.5782 - 81s/epoch - 48ms/step
Epoch 10/50
1701/1701 - 80s - loss: 2.4771 - accuracy20: 0.6118 - val_loss: 2.8453 - val_accuracy20: 0.5733 - 80s/epoch - 47ms/step
Epoch 11/50
1701/1701 - 81s - loss: 2.4613 - accuracy20: 0.6138 - val_loss: 2.8488 - val_accuracy20: 0.5518 - 81s/epoch - 47ms/step
Epoch 12/50
1701/1701 - 81s - loss: 2.4490 - accuracy20: 0.6158 - val_loss: 2.8015 - val_accuracy20: 0.5588 - 81s/epoch - 48ms/step
Epoch 13/50
1701/1701 - 82s - loss: 2.4376 - accuracy20: 0.6172 - val_loss: 2.7907 - val_accuracy20: 0.5698 - 82s/epoch - 48ms/step
Epoch 14/50
1701/1701 - 83s - loss: 2.4294 - accuracy20: 0.6181 - val_loss: 2.7391 - val_accuracy20: 0.5566 - 83s/epoch - 49ms/step
Epoch 15/50
1701/1701 - 83s - loss: 2.4185 - accuracy20: 0.6195 - val_loss: 2.7660 - val_accuracy20: 0.5662 - 83s/epoch - 49ms/step
Epoch 16/50
1701/1701 - 81s - loss: 2.4122 - accuracy20: 0.6213 - val_loss: 2.7786 - val_accuracy20: 0.5411 - 81s/epoch - 48ms/step
Epoch 17/50
1701/1701 - 81s - loss: 2.4056 - accuracy20: 0.6221 - val_loss: 2.7387 - val_accuracy20: 0.5602 - 81s/epoch - 48ms/step
Epoch 18/50
1701/1701 - 80s - loss: 2.3975 - accuracy20: 0.6227 - val_loss: 2.7275 - val_accuracy20: 0.5586 - 80s/epoch - 47ms/step
Epoch 19/50
1701/1701 - 81s - loss: 2.3913 - accuracy20: 0.6239 - val_loss: 2.7880 - val_accuracy20: 0.5361 - 81s/epoch - 48ms/step
Epoch 20/50
1701/1701 - 82s - loss: 2.3866 - accuracy20: 0.6240 - val_loss: 2.7485 - val_accuracy20: 0.5690 - 82s/epoch - 48ms/step
Epoch 21/50
1701/1701 - 81s - loss: 2.3807 - accuracy20: 0.6245 - val_loss: 2.7638 - val_accuracy20: 0.5668 - 81s/epoch - 48ms/step
Epoch 22/50
1701/1701 - 81s - loss: 2.3745 - accuracy20: 0.6254 - val_loss: 2.7651 - val_accuracy20: 0.5493 - 81s/epoch - 48ms/step
Epoch 23/50
1701/1701 - 82s - loss: 2.3707 - accuracy20: 0.6259 - val_loss: 2.8319 - val_accuracy20: 0.5318 - 82s/epoch - 48ms/step
Epoch 24/50
1701/1701 - 81s - loss: 2.3632 - accuracy20: 0.6263 - val_loss: 2.7658 - val_accuracy20: 0.5473 - 81s/epoch - 48ms/step
Epoch 25/50
1701/1701 - 81s - loss: 2.3579 - accuracy20: 0.6269 - val_loss: 2.8154 - val_accuracy20: 0.5419 - 81s/epoch - 47ms/step
Epoch 26/50
1701/1701 - 81s - loss: 2.3528 - accuracy20: 0.6281 - val_loss: 2.8078 - val_accuracy20: 0.5236 - 81s/epoch - 48ms/step
Epoch 27/50
1701/1701 - 81s - loss: 2.3468 - accuracy20: 0.6288 - val_loss: 2.8143 - val_accuracy20: 0.5238 - 81s/epoch - 47ms/step
Epoch 28/50
1701/1701 - 81s - loss: 2.3411 - accuracy20: 0.6299 - val_loss: 2.8320 - val_accuracy20: 0.5226 - 81s/epoch - 47ms/step
testing model: results/AAL/W5/deepLOB_L2/h20
Evaluating performance on  test set...
6357/6357 - 120s - 120s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9340193
{'0': {'precision': 0.4970852515659534, 'recall': 0.3045805205903138, 'f1-score': 0.3777197180128893, 'support': 338193}, '1': {'precision': 0.7168870620682304, 'recall': 0.5685303646034755, 'f1-score': 0.6341474050689977, 'support': 946398}, '2': {'precision': 0.3556861198502544, 'recall': 0.6950154417388157, 'f1-score': 0.47055673037016543, 'support': 342578}, 'accuracy': 0.5403003621627501, 'macro avg': {'precision': 0.523219477828146, 'recall': 0.5227087756442016, 'f1-score': 0.49414128448401745, 'support': 1627169}, 'weighted avg': {'precision': 0.5951572785716506, 'recall': 0.5403003621627501, 'f1-score': 0.5464093674554843, 'support': 1627169}}
[[103007 136683  98503]
 [ 75540 538056 332802]
 [ 28675  75806 238097]]
Evaluating performance on  train set...
1701/1701 - 34s - 34s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91360873
{'0': {'precision': 0.4204435627447988, 'recall': 0.5588762297575983, 'f1-score': 0.4798757565641465, 'support': 88737}, '1': {'precision': 0.7854372173490758, 'recall': 0.5061890193807851, 'f1-score': 0.6156265388998189, 'support': 255614}, '2': {'precision': 0.3925056799952858, 'recall': 0.6582735787936355, 'f1-score': 0.4917800127975849, 'support': 91067}, 'accuracy': 0.5487347789939782, 'macro avg': {'precision': 0.5327954866963868, 'recall': 0.5744462759773397, 'f1-score': 0.5290941027538502, 'support': 435418}, 'weighted avg': {'precision': 0.6288714845570982, 'recall': 0.5487347789939782, 'f1-score': 0.5620585909402198, 'support': 435418}}
[[ 49593  19500  19644]
 [ 53087 129389  73138]
 [ 15274  15846  59947]]
Evaluating performance on  val set...
563/563 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90513676
{'0': {'precision': 0.4380938711066456, 'recall': 0.5144619741100324, 'f1-score': 0.47321663901765915, 'support': 29664}, '1': {'precision': 0.7559086005687947, 'recall': 0.546537461593004, 'f1-score': 0.6343945899233208, 'support': 84620}, '2': {'precision': 0.39182382082344613, 'recall': 0.632208228379513, 'f1-score': 0.48380173997969594, 'support': 29775}, 'accuracy': 0.5576395782283647, 'macro avg': {'precision': 0.5286087641662954, 'recall': 0.5644025546941831, 'f1-score': 0.5304709896402252, 'support': 144059}, 'weighted avg': {'precision': 0.6152142985697322, 'recall': 0.5576395782283647, 'f1-score': 0.5700800740462358, 'support': 144059}}
[[15261  8331  6072]
 [15226 46248 23146]
 [ 4348  6603 18824]]
training model: results/AAL/W5/deepLOB_L2/h30
Epoch 1/50
1701/1701 - 83s - loss: 3.0649 - accuracy30: 0.4392 - val_loss: 3.2363 - val_accuracy30: 0.3640 - 83s/epoch - 49ms/step
Epoch 2/50
1701/1701 - 81s - loss: 2.9459 - accuracy30: 0.4740 - val_loss: 3.3053 - val_accuracy30: 0.4820 - 81s/epoch - 47ms/step
Epoch 3/50
1701/1701 - 81s - loss: 2.8859 - accuracy30: 0.5004 - val_loss: 3.1829 - val_accuracy30: 0.3668 - 81s/epoch - 48ms/step
Epoch 4/50
1701/1701 - 81s - loss: 2.8290 - accuracy30: 0.5234 - val_loss: 3.3084 - val_accuracy30: 0.3574 - 81s/epoch - 47ms/step
Epoch 5/50
1701/1701 - 81s - loss: 2.7876 - accuracy30: 0.5382 - val_loss: 3.1827 - val_accuracy30: 0.3960 - 81s/epoch - 47ms/step
Epoch 6/50
1701/1701 - 82s - loss: 2.7551 - accuracy30: 0.5487 - val_loss: 3.1502 - val_accuracy30: 0.4605 - 82s/epoch - 48ms/step
Epoch 7/50
1701/1701 - 81s - loss: 2.7184 - accuracy30: 0.5614 - val_loss: 3.1832 - val_accuracy30: 0.4872 - 81s/epoch - 48ms/step
Epoch 8/50
1701/1701 - 81s - loss: 2.6861 - accuracy30: 0.5715 - val_loss: 3.1787 - val_accuracy30: 0.4967 - 81s/epoch - 47ms/step
Epoch 9/50
1701/1701 - 81s - loss: 2.6633 - accuracy30: 0.5767 - val_loss: 3.1199 - val_accuracy30: 0.4916 - 81s/epoch - 47ms/step
Epoch 10/50
1701/1701 - 81s - loss: 2.6404 - accuracy30: 0.5816 - val_loss: 3.0769 - val_accuracy30: 0.5084 - 81s/epoch - 48ms/step
Epoch 11/50
1701/1701 - 81s - loss: 2.6212 - accuracy30: 0.5850 - val_loss: 2.9990 - val_accuracy30: 0.5141 - 81s/epoch - 47ms/step
Epoch 12/50
1701/1701 - 80s - loss: 2.6038 - accuracy30: 0.5885 - val_loss: 3.0057 - val_accuracy30: 0.4978 - 80s/epoch - 47ms/step
Epoch 13/50
1701/1701 - 82s - loss: 2.5900 - accuracy30: 0.5913 - val_loss: 3.0192 - val_accuracy30: 0.4898 - 82s/epoch - 48ms/step
Epoch 14/50
1701/1701 - 82s - loss: 2.5776 - accuracy30: 0.5935 - val_loss: 3.0101 - val_accuracy30: 0.4848 - 82s/epoch - 48ms/step
Epoch 15/50
1701/1701 - 82s - loss: 2.5663 - accuracy30: 0.5957 - val_loss: 3.0141 - val_accuracy30: 0.4890 - 82s/epoch - 48ms/step
Epoch 16/50
1701/1701 - 82s - loss: 2.5565 - accuracy30: 0.5978 - val_loss: 3.1172 - val_accuracy30: 0.4289 - 82s/epoch - 48ms/step
Epoch 17/50
1701/1701 - 80s - loss: 2.5471 - accuracy30: 0.5992 - val_loss: 2.9715 - val_accuracy30: 0.5500 - 80s/epoch - 47ms/step
Epoch 18/50
1701/1701 - 81s - loss: 2.5383 - accuracy30: 0.6011 - val_loss: 3.0869 - val_accuracy30: 0.4485 - 81s/epoch - 47ms/step
Epoch 19/50
1701/1701 - 82s - loss: 2.5305 - accuracy30: 0.6024 - val_loss: 3.0895 - val_accuracy30: 0.4389 - 82s/epoch - 48ms/step
Epoch 20/50
1701/1701 - 81s - loss: 2.5231 - accuracy30: 0.6031 - val_loss: 3.0857 - val_accuracy30: 0.4536 - 81s/epoch - 48ms/step
Epoch 21/50
1701/1701 - 82s - loss: 2.5152 - accuracy30: 0.6048 - val_loss: 3.0506 - val_accuracy30: 0.4474 - 82s/epoch - 48ms/step
Epoch 22/50
1701/1701 - 82s - loss: 2.5091 - accuracy30: 0.6052 - val_loss: 3.0433 - val_accuracy30: 0.4555 - 82s/epoch - 48ms/step
Epoch 23/50
1701/1701 - 81s - loss: 2.5021 - accuracy30: 0.6064 - val_loss: 3.0038 - val_accuracy30: 0.4698 - 81s/epoch - 48ms/step
Epoch 24/50
1701/1701 - 80s - loss: 2.4962 - accuracy30: 0.6069 - val_loss: 3.0287 - val_accuracy30: 0.4520 - 80s/epoch - 47ms/step
Epoch 25/50
1701/1701 - 80s - loss: 2.4894 - accuracy30: 0.6082 - val_loss: 3.1359 - val_accuracy30: 0.4400 - 80s/epoch - 47ms/step
Epoch 26/50
1701/1701 - 81s - loss: 2.4832 - accuracy30: 0.6096 - val_loss: 3.0484 - val_accuracy30: 0.4586 - 81s/epoch - 47ms/step
Epoch 27/50
1701/1701 - 80s - loss: 2.4780 - accuracy30: 0.6096 - val_loss: 3.0218 - val_accuracy30: 0.4700 - 80s/epoch - 47ms/step
testing model: results/AAL/W5/deepLOB_L2/h30
Evaluating performance on  test set...
6357/6357 - 118s - 118s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9909887
{'0': {'precision': 0.5209342808944403, 'recall': 0.14618749165883962, 'f1-score': 0.2283063721682912, 'support': 397127}, '1': {'precision': 0.6023219608879193, 'recall': 0.6396272080338113, 'f1-score': 0.6204143032917799, 'support': 830490}, '2': {'precision': 0.3897787623185936, 'recall': 0.618294990389236, 'f1-score': 0.4781361590942081, 'support': 399552}, 'accuracy': 0.5139601356712179, 'macro avg': {'precision': 0.5043450013669843, 'recall': 0.46803656336062893, 'f1-score': 0.4422856115180931, 'support': 1627169}, 'weighted avg': {'precision': 0.530268409432882, 'recall': 0.5139601356712179, 'f1-score': 0.4897799540424359, 'support': 1627169}}
[[ 58055 218506 120566]
 [ 33095 531204 266191]
 [ 20294 132217 247041]]
Evaluating performance on  train set...
1701/1701 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93526435
{'0': {'precision': 0.47615267114201876, 'recall': 0.4573323166317578, 'f1-score': 0.4665527716371836, 'support': 103603}, '1': {'precision': 0.6843895501322186, 'recall': 0.5594144090384692, 'f1-score': 0.6156233430782626, 'support': 226233}, '2': {'precision': 0.4196597103100226, 'recall': 0.6001401754086871, 'f1-score': 0.4939295555616183, 'support': 105582}, 'accuracy': 0.5450004363623001, 'macro avg': {'precision': 0.5267339771947533, 'recall': 0.5389623003596381, 'f1-score': 0.5253685567590215, 'support': 435418}, 'weighted avg': {'precision': 0.5706490264925694, 'recall': 0.5450004363623001, 'f1-score': 0.5506447893974491, 'support': 435418}}
[[ 47381  33087  23135]
 [ 35185 126558  64490]
 [ 16942  25276  63364]]
Evaluating performance on  val set...
563/563 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9374566
{'0': {'precision': 0.489853738003329, 'recall': 0.3965823728424795, 'f1-score': 0.4383110195674562, 'support': 34878}, '1': {'precision': 0.6480098286958829, 'recall': 0.62419311457773, 'f1-score': 0.6358785371300184, 'support': 74360}, '2': {'precision': 0.42658671795451975, 'recall': 0.5414261508859596, 'f1-score': 0.4771944922547332, 'support': 34821}, 'accuracy': 0.5490805850380747, 'macro avg': {'precision': 0.5214834282179105, 'recall': 0.5207338794353897, 'f1-score': 0.5171280163174026, 'support': 144059}, 'weighted avg': {'precision': 0.5561978470057427, 'recall': 0.5490805850380747, 'f1-score': 0.5496895659157981, 'support': 144059}}
[[13832 14040  7006]
 [ 9609 46415 18336]
 [ 4796 11172 18853]]
training model: results/AAL/W5/deepLOB_L2/h50
Epoch 1/50
1701/1701 - 84s - loss: 3.1392 - accuracy50: 0.4398 - val_loss: 3.7694 - val_accuracy50: 0.3674 - 84s/epoch - 50ms/step
Epoch 2/50
1701/1701 - 82s - loss: 3.0289 - accuracy50: 0.4692 - val_loss: 3.6370 - val_accuracy50: 0.3906 - 82s/epoch - 48ms/step
Epoch 3/50
1701/1701 - 82s - loss: 2.9754 - accuracy50: 0.4876 - val_loss: 3.3893 - val_accuracy50: 0.4113 - 82s/epoch - 48ms/step
Epoch 4/50
1701/1701 - 82s - loss: 2.9425 - accuracy50: 0.5017 - val_loss: 3.3066 - val_accuracy50: 0.4068 - 82s/epoch - 48ms/step
Epoch 5/50
1701/1701 - 81s - loss: 2.9132 - accuracy50: 0.5129 - val_loss: 3.2977 - val_accuracy50: 0.4324 - 81s/epoch - 47ms/step
Epoch 6/50
1701/1701 - 81s - loss: 2.8773 - accuracy50: 0.5237 - val_loss: 3.2558 - val_accuracy50: 0.4501 - 81s/epoch - 47ms/step
Epoch 7/50
1701/1701 - 80s - loss: 2.8421 - accuracy50: 0.5338 - val_loss: 3.1444 - val_accuracy50: 0.4638 - 80s/epoch - 47ms/step
Epoch 8/50
1701/1701 - 81s - loss: 2.8125 - accuracy50: 0.5418 - val_loss: 3.1111 - val_accuracy50: 0.4646 - 81s/epoch - 47ms/step
Epoch 9/50
1701/1701 - 83s - loss: 2.7894 - accuracy50: 0.5465 - val_loss: 3.0728 - val_accuracy50: 0.4787 - 83s/epoch - 49ms/step
Epoch 10/50
1701/1701 - 82s - loss: 2.7713 - accuracy50: 0.5516 - val_loss: 3.0761 - val_accuracy50: 0.4748 - 82s/epoch - 48ms/step
Epoch 11/50
1701/1701 - 81s - loss: 2.7568 - accuracy50: 0.5534 - val_loss: 3.1104 - val_accuracy50: 0.4546 - 81s/epoch - 48ms/step
Epoch 12/50
1701/1701 - 80s - loss: 2.7443 - accuracy50: 0.5569 - val_loss: 3.1585 - val_accuracy50: 0.4410 - 80s/epoch - 47ms/step
Epoch 13/50
1701/1701 - 80s - loss: 2.7322 - accuracy50: 0.5591 - val_loss: 3.1793 - val_accuracy50: 0.4405 - 80s/epoch - 47ms/step
Epoch 14/50
1701/1701 - 80s - loss: 2.7225 - accuracy50: 0.5612 - val_loss: 3.1402 - val_accuracy50: 0.4568 - 80s/epoch - 47ms/step
Epoch 15/50
1701/1701 - 81s - loss: 2.7136 - accuracy50: 0.5626 - val_loss: 3.1547 - val_accuracy50: 0.4308 - 81s/epoch - 47ms/step
Epoch 16/50
1701/1701 - 81s - loss: 2.7050 - accuracy50: 0.5648 - val_loss: 3.1804 - val_accuracy50: 0.4287 - 81s/epoch - 48ms/step
Epoch 17/50
1701/1701 - 82s - loss: 2.6966 - accuracy50: 0.5667 - val_loss: 3.1680 - val_accuracy50: 0.4357 - 82s/epoch - 48ms/step
Epoch 18/50
1701/1701 - 82s - loss: 2.6902 - accuracy50: 0.5672 - val_loss: 3.1828 - val_accuracy50: 0.4344 - 82s/epoch - 48ms/step
Epoch 19/50
1701/1701 - 81s - loss: 2.6826 - accuracy50: 0.5689 - val_loss: 3.1660 - val_accuracy50: 0.4290 - 81s/epoch - 48ms/step
testing model: results/AAL/W5/deepLOB_L2/h50
Evaluating performance on  test set...
6357/6357 - 120s - 120s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0401455
{'0': {'precision': 0.48264301747588584, 'recall': 0.17220206819625722, 'f1-score': 0.2538375186079996, 'support': 483223}, '1': {'precision': 0.49030714099718525, 'recall': 0.5957423087353482, 'f1-score': 0.5379068296365825, 'support': 663740}, '2': {'precision': 0.39775717657221304, 'recall': 0.5369820452055992, 'f1-score': 0.45700117678751184, 'support': 480206}, 'accuracy': 0.45262170063466056, 'macro avg': {'precision': 0.4569024450150947, 'recall': 0.43497547404573494, 'f1-score': 0.41624850834403126, 'support': 1627169}, 'weighted avg': {'precision': 0.4607180024522701, 'recall': 0.45262170063466056, 'f1-score': 0.4296696369324407, 'support': 1627169}}
[[ 83212 236110 163901]
 [ 41795 395418 226527]
 [ 47402 174942 257862]]
Evaluating performance on  train set...
1701/1701 - 33s - 33s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99167794
{'0': {'precision': 0.46774516721985554, 'recall': 0.4315522119341564, 'f1-score': 0.44892038209903634, 'support': 124416}, '1': {'precision': 0.5693941360391718, 'recall': 0.5230052290769189, 'f1-score': 0.5452147265255399, 'support': 184545}, '2': {'precision': 0.42633288997412633, 'recall': 0.5094775299113533, 'f1-score': 0.4642116033086434, 'support': 126457}, 'accuracy': 0.4929447105999293, 'macro avg': {'precision': 0.4878240644110512, 'recall': 0.48801165697414284, 'f1-score': 0.4861155706444065, 'support': 435418}, 'weighted avg': {'precision': 0.4988002375364192, 'recall': 0.4929447105999293, 'f1-score': 0.4941741882179666, 'support': 435418}}
[[53692 39705 31019]
 [32354 96518 55673]
 [28743 33287 64427]]
Evaluating performance on  val set...
563/563 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0067993
{'0': {'precision': 0.4668713427274397, 'recall': 0.4235383736431156, 'f1-score': 0.44415042999613064, 'support': 42008}, '1': {'precision': 0.543049281662874, 'recall': 0.5295422931708287, 'f1-score': 0.5362107416536713, 'support': 60388}, '2': {'precision': 0.4150730919598844, 'recall': 0.4688812615510165, 'f1-score': 0.4403394682565623, 'support': 41663}, 'accuracy': 0.48108760993759503, 'macro avg': {'precision': 0.4749979054500661, 'recall': 0.4739873094549869, 'f1-score': 0.47356687996878805, 'support': 144059}, 'weighted avg': {'precision': 0.4838238611726902, 'recall': 0.48108760993759503, 'f1-score': 0.4816389728946648, 'support': 144059}}
[[17792 14395  9821]
 [10702 31978 17708]
 [ 9615 12513 19535]]
training model: results/AAL/W5/deepLOB_L2/h100
Epoch 1/50
1701/1701 - 86s - loss: 3.2230 - accuracy100: 0.4123 - val_loss: 3.3338 - val_accuracy100: 0.3524 - 86s/epoch - 51ms/step
Epoch 2/50
1701/1701 - 83s - loss: 3.1678 - accuracy100: 0.4336 - val_loss: 3.2875 - val_accuracy100: 0.3835 - 83s/epoch - 49ms/step
Epoch 3/50
1701/1701 - 83s - loss: 3.1239 - accuracy100: 0.4492 - val_loss: 3.5146 - val_accuracy100: 0.3475 - 83s/epoch - 49ms/step
Epoch 4/50
1701/1701 - 82s - loss: 3.1026 - accuracy100: 0.4550 - val_loss: 3.7624 - val_accuracy100: 0.3349 - 82s/epoch - 48ms/step
Epoch 5/50
1701/1701 - 81s - loss: 3.0896 - accuracy100: 0.4602 - val_loss: 3.6356 - val_accuracy100: 0.3455 - 81s/epoch - 48ms/step
Epoch 6/50
1701/1701 - 81s - loss: 3.0763 - accuracy100: 0.4638 - val_loss: 3.5792 - val_accuracy100: 0.3459 - 81s/epoch - 48ms/step
Epoch 7/50
1701/1701 - 81s - loss: 3.0667 - accuracy100: 0.4678 - val_loss: 3.6743 - val_accuracy100: 0.3477 - 81s/epoch - 48ms/step
Epoch 8/50
1701/1701 - 81s - loss: 3.0561 - accuracy100: 0.4713 - val_loss: 3.5859 - val_accuracy100: 0.3507 - 81s/epoch - 47ms/step
Epoch 9/50
1701/1701 - 80s - loss: 3.0466 - accuracy100: 0.4754 - val_loss: 3.5197 - val_accuracy100: 0.3585 - 80s/epoch - 47ms/step
Epoch 10/50
1701/1701 - 81s - loss: 3.0377 - accuracy100: 0.4780 - val_loss: 3.7004 - val_accuracy100: 0.3489 - 81s/epoch - 47ms/step
Epoch 11/50
1701/1701 - 81s - loss: 3.0298 - accuracy100: 0.4804 - val_loss: 3.5997 - val_accuracy100: 0.3532 - 81s/epoch - 47ms/step
Epoch 12/50
1701/1701 - 81s - loss: 3.0220 - accuracy100: 0.4832 - val_loss: 3.5355 - val_accuracy100: 0.3633 - 81s/epoch - 47ms/step
testing model: results/AAL/W5/deepLOB_L2/h100
Evaluating performance on  test set...
6357/6357 - 118s - 118s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1207026
{'0': {'precision': 0.38465794726600017, 'recall': 0.32622303757076504, 'f1-score': 0.3530387973780557, 'support': 564721}, '1': {'precision': 0.31933750623165125, 'recall': 0.2053452697568389, 'f1-score': 0.24995844865337505, 'support': 505344}, '2': {'precision': 0.37772916481938773, 'recall': 0.5582045722163187, 'f1-score': 0.4505663991329968, 'support': 557104}, 'accuracy': 0.36810743075857516, 'macro avg': {'precision': 0.36057487277234634, 'recall': 0.36325762651464083, 'f1-score': 0.3511878817214759, 'support': 1627169}, 'weighted avg': {'precision': 0.36199936332653254, 'recall': 0.36810743075857516, 'f1-score': 0.3544166390786778, 'support': 1627169}}
[[184225 129461 251035]
 [140304 103770 261270]
 [154403  91723 310978]]
Evaluating performance on  train set...
1701/1701 - 34s - 34s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.105625
{'0': {'precision': 0.39667138613586517, 'recall': 0.19625173403656243, 'f1-score': 0.2625886720329327, 'support': 145614}, '1': {'precision': 0.3465056652783376, 'recall': 0.4269907078455585, 'f1-score': 0.38256080941182286, 'support': 144961}, '2': {'precision': 0.39816178062616375, 'recall': 0.5078464268207645, 'f1-score': 0.44636469278217894, 'support': 144843}, 'accuracy': 0.3767230569246104, 'macro avg': {'precision': 0.3804462773467889, 'recall': 0.3770296229009618, 'f1-score': 0.36383805807564484, 'support': 435418}, 'weighted avg': {'precision': 0.3804658093060838, 'recall': 0.3767230569246104, 'f1-score': 0.36366384848398514, 'support': 435418}}
[[28577 66666 50371]
 [22249 61897 60815]
 [21216 50069 73558]]
Evaluating performance on  val set...
563/563 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0958182
{'0': {'precision': 0.40699253224711474, 'recall': 0.36773876950129836, 'f1-score': 0.3863712042278484, 'support': 48907}, '1': {'precision': 0.3443853517702477, 'recall': 0.2400288068458622, 'f1-score': 0.28288980977582506, 'support': 47211}, '2': {'precision': 0.3845797742070366, 'recall': 0.5371811184581048, 'f1-score': 0.4482485531526043, 'support': 47941}, 'accuracy': 0.3822739294316912, 'macro avg': {'precision': 0.3786525527414663, 'recall': 0.38164956493508845, 'f1-score': 0.3725031890520926, 'support': 144059}, 'weighted avg': {'precision': 0.3790162334341787, 'recall': 0.3822739294316912, 'f1-score': 0.37305028621041975, 'support': 144059}}
[[17985 12557 18365]
 [13033 11332 22846]
 [13172  9016 25753]]
training model: results/AAL/W5/deepLOB_L2/h200
Epoch 1/50
1701/1701 - 84s - loss: 3.2796 - accuracy200: 0.3831 - val_loss: 3.3539 - val_accuracy200: 0.3413 - 84s/epoch - 50ms/step
Epoch 2/50
1701/1701 - 82s - loss: 3.2564 - accuracy200: 0.3879 - val_loss: 3.3619 - val_accuracy200: 0.3386 - 82s/epoch - 48ms/step
Epoch 3/50
1701/1701 - 82s - loss: 3.2317 - accuracy200: 0.4061 - val_loss: 3.4640 - val_accuracy200: 0.3379 - 82s/epoch - 48ms/step
Epoch 4/50
1701/1701 - 81s - loss: 3.2138 - accuracy200: 0.4144 - val_loss: 3.3605 - val_accuracy200: 0.3399 - 81s/epoch - 47ms/step
Epoch 5/50
1701/1701 - 81s - loss: 3.1992 - accuracy200: 0.4207 - val_loss: 3.4641 - val_accuracy200: 0.3368 - 81s/epoch - 48ms/step
Epoch 6/50
1701/1701 - 82s - loss: 3.1903 - accuracy200: 0.4242 - val_loss: 3.6081 - val_accuracy200: 0.3396 - 82s/epoch - 48ms/step
Epoch 7/50
1701/1701 - 82s - loss: 3.1795 - accuracy200: 0.4307 - val_loss: 3.5509 - val_accuracy200: 0.3387 - 82s/epoch - 48ms/step
Epoch 8/50
1701/1701 - 82s - loss: 3.1703 - accuracy200: 0.4345 - val_loss: 3.6736 - val_accuracy200: 0.3380 - 82s/epoch - 48ms/step
Epoch 9/50
1701/1701 - 81s - loss: 3.1600 - accuracy200: 0.4399 - val_loss: 3.4971 - val_accuracy200: 0.3425 - 81s/epoch - 48ms/step
Epoch 10/50
1701/1701 - 80s - loss: 3.1527 - accuracy200: 0.4432 - val_loss: 3.4510 - val_accuracy200: 0.3449 - 80s/epoch - 47ms/step
Epoch 11/50
1701/1701 - 81s - loss: 3.1421 - accuracy200: 0.4462 - val_loss: 3.4981 - val_accuracy200: 0.3375 - 81s/epoch - 48ms/step
testing model: results/AAL/W5/deepLOB_L2/h200
Evaluating performance on  test set...
6357/6357 - 118s - 118s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1016549
{'0': {'precision': 0.3691951952516494, 'recall': 0.7116064649272918, 'f1-score': 0.48616077757998705, 'support': 607153}, '1': {'precision': 0.2666040100250627, 'recall': 0.012177990416928026, 'f1-score': 0.023292042341703293, 'support': 419281}, '2': {'precision': 0.36991442760612026, 'recall': 0.26955812463066076, 'f1-score': 0.3118615147141097, 'support': 600735}, 'accuracy': 0.36818117847623694, 'macro avg': {'precision': 0.3352378776276108, 'recall': 0.3311141933249602, 'f1-score': 0.2737714448786, 'support': 1627169}, 'weighted avg': {'precision': 0.3430255308317118, 'recall': 0.36818117847623694, 'f1-score': 0.30254141545031543, 'support': 1627169}}
[[432054   7190 167909]
 [306259   5106 107916]
 [431946   6856 161933]]
Evaluating performance on  train set...
1701/1701 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1155274
{'0': {'precision': 0.3376017172226514, 'recall': 0.5023334893581872, 'f1-score': 0.403813644902736, 'support': 145276}, '1': {'precision': 0.3620691122286609, 'recall': 0.2904377384763452, 'f1-score': 0.3223216247130921, 'support': 146503}, '2': {'precision': 0.34383109223873554, 'recall': 0.24352717576702707, 'f1-score': 0.2851146204788588, 'support': 143639}, 'accuracy': 0.3456609510860828, 'macro avg': {'precision': 0.34783397389668264, 'recall': 0.34543280120051983, 'f1-score': 0.33708329669822895, 'support': 435418}, 'weighted avg': {'precision': 0.34788913751418904, 'recall': 0.3456609510860828, 'f1-score': 0.33723708030718713, 'support': 435418}}
[[72977 37306 34993]
 [72190 42550 31763]
 [70996 37663 34980]]
Evaluating performance on  val set...
563/563 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1182699
{'0': {'precision': 0.3422216068125847, 'recall': 0.6928930452369986, 'f1-score': 0.4581578877678027, 'support': 49937}, '1': {'precision': 0.3247741321921065, 'recall': 0.014982341456994319, 'f1-score': 0.028643321451037953, 'support': 45587}, '2': {'precision': 0.3423829224705623, 'recall': 0.2881631812094365, 'f1-score': 0.3129419135415734, 'support': 48535}, 'accuracy': 0.3420126475957767, 'macro avg': {'precision': 0.3364595538250845, 'recall': 0.3320128559678098, 'f1-score': 0.266581040920138, 'support': 144059}, 'weighted avg': {'precision': 0.3367547594093416, 'recall': 0.3420126475957767, 'f1-score': 0.2733146093627576, 'support': 144059}}
[[34601   742 14594]
 [32635   683 12269]
 [33871   678 13986]]
training model: results/AAL/W5/deepLOB_L2/h300
Epoch 1/50
1701/1701 - 86s - loss: 3.2947 - accuracy300: 0.3736 - val_loss: 3.3047 - val_accuracy300: 0.3337 - 86s/epoch - 51ms/step
Epoch 2/50
1701/1701 - 82s - loss: 3.2702 - accuracy300: 0.3794 - val_loss: 3.3402 - val_accuracy300: 0.3347 - 82s/epoch - 48ms/step
Epoch 3/50
1701/1701 - 81s - loss: 3.2553 - accuracy300: 0.3933 - val_loss: 3.3538 - val_accuracy300: 0.3357 - 81s/epoch - 48ms/step
Epoch 4/50
1701/1701 - 82s - loss: 3.2413 - accuracy300: 0.4032 - val_loss: 3.4023 - val_accuracy300: 0.3411 - 82s/epoch - 48ms/step
Epoch 5/50
1701/1701 - 83s - loss: 3.2327 - accuracy300: 0.4092 - val_loss: 3.4044 - val_accuracy300: 0.3379 - 83s/epoch - 49ms/step
Epoch 6/50
1701/1701 - 83s - loss: 3.2225 - accuracy300: 0.4148 - val_loss: 3.3958 - val_accuracy300: 0.3420 - 83s/epoch - 49ms/step
Epoch 7/50
1701/1701 - 82s - loss: 3.2156 - accuracy300: 0.4176 - val_loss: 3.3235 - val_accuracy300: 0.3436 - 82s/epoch - 48ms/step
Epoch 8/50
1701/1701 - 82s - loss: 3.2071 - accuracy300: 0.4226 - val_loss: 3.3598 - val_accuracy300: 0.3426 - 82s/epoch - 48ms/step
Epoch 9/50
1701/1701 - 81s - loss: 3.1980 - accuracy300: 0.4268 - val_loss: 3.3983 - val_accuracy300: 0.3392 - 81s/epoch - 48ms/step
Epoch 10/50
1701/1701 - 82s - loss: 3.1900 - accuracy300: 0.4302 - val_loss: 3.3874 - val_accuracy300: 0.3457 - 82s/epoch - 48ms/step
Epoch 11/50
1701/1701 - 82s - loss: 3.1838 - accuracy300: 0.4330 - val_loss: 3.4081 - val_accuracy300: 0.3395 - 82s/epoch - 48ms/step
testing model: results/AAL/W5/deepLOB_L2/h300
Evaluating performance on  test set...
6357/6357 - 119s - 119s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1085641
{'0': {'precision': 0.34194993015420855, 'recall': 0.08788073969266291, 'f1-score': 0.13982628466466557, 'support': 568236}, '1': {'precision': 0.2971587414083603, 'recall': 0.3588105646850818, 'f1-score': 0.3250874539872252, 'support': 495462}, '2': {'precision': 0.34142015252407754, 'recall': 0.5349556587650474, 'f1-score': 0.4168180825084973, 'support': 563471}, 'accuracy': 0.32519424841549954, 'macro avg': {'precision': 0.3268429413622155, 'recall': 0.3272156543809307, 'f1-score': 0.29391060705346267, 'support': 1627169}, 'weighted avg': {'precision': 0.3281278586364848, 'recall': 0.32519424841549954, 'f1-score': 0.2921563221701464, 'support': 1627169}}
[[ 49937 211001 307298]
 [ 43538 177777 274147]
 [ 52561 209478 301432]]
Evaluating performance on  train set...
1701/1701 - 32s - 32s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.109077
{'0': {'precision': 0.3476796241301361, 'recall': 0.053159118171282965, 'f1-score': 0.09221834256222153, 'support': 147557}, '1': {'precision': 0.317916594566534, 'recall': 0.3233461692796148, 'f1-score': 0.320608395806285, 'support': 142049}, '2': {'precision': 0.33121073693466774, 'recall': 0.6096274655035251, 'f1-score': 0.4292239868274287, 'support': 145812}, 'accuracy': 0.32765296795263404, 'macro avg': {'precision': 0.33226898521044596, 'recall': 0.32871091765147425, 'f1-score': 0.2806835750653117, 'support': 435418}, 'weighted avg': {'precision': 0.3324547827909499, 'recall': 0.32765296795263404, 'f1-score': 0.2795832325641607, 'support': 435418}}
[[ 7844 49223 90490]
 [ 7117 45931 89001]
 [ 7600 49321 88891]]
Evaluating performance on  val set...
563/563 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1021087
{'0': {'precision': 0.36545101424255505, 'recall': 0.13854177318744249, 'f1-score': 0.20091649241446813, 'support': 48895}, '1': {'precision': 0.32564601278132815, 'recall': 0.3460873233495043, 'f1-score': 0.3355556464477075, 'support': 47410}, '2': {'precision': 0.33054287501497265, 'recall': 0.5200820873644093, 'f1-score': 0.40419558796006216, 'support': 47754}, 'accuracy': 0.33332176399947244, 'macro avg': {'precision': 0.34054663401295193, 'recall': 0.3349037279671187, 'f1-score': 0.3135559089407459, 'support': 144059}, 'weighted avg': {'precision': 0.34077946716843444, 'recall': 0.33332176399947244, 'f1-score': 0.3126112301358196, 'support': 144059}}
[[ 6774 17151 24970]
 [ 5671 16408 25331]
 [ 6091 16827 24836]]
training model: results/AAL/W5/deepLOB_L2/h500
Epoch 1/50
1701/1701 - 83s - loss: 3.2141 - accuracy500: 0.4191 - val_loss: 3.3351 - val_accuracy500: 0.3451 - 83s/epoch - 49ms/step
Epoch 2/50
1701/1701 - 80s - loss: 3.1976 - accuracy500: 0.4264 - val_loss: 3.3130 - val_accuracy500: 0.3520 - 80s/epoch - 47ms/step
Epoch 3/50
1701/1701 - 80s - loss: 3.1909 - accuracy500: 0.4343 - val_loss: 3.4087 - val_accuracy500: 0.3006 - 80s/epoch - 47ms/step
Epoch 4/50
1701/1701 - 80s - loss: 3.1754 - accuracy500: 0.4411 - val_loss: 3.4581 - val_accuracy500: 0.2791 - 80s/epoch - 47ms/step
Epoch 5/50
1701/1701 - 80s - loss: 3.1586 - accuracy500: 0.4497 - val_loss: 3.6101 - val_accuracy500: 0.2788 - 80s/epoch - 47ms/step
Epoch 6/50
1701/1701 - 80s - loss: 3.1535 - accuracy500: 0.4531 - val_loss: 3.6261 - val_accuracy500: 0.2772 - 80s/epoch - 47ms/step
Epoch 7/50
1701/1701 - 82s - loss: 3.1459 - accuracy500: 0.4531 - val_loss: 3.7581 - val_accuracy500: 0.2762 - 82s/epoch - 48ms/step
Epoch 8/50
1701/1701 - 80s - loss: 3.1347 - accuracy500: 0.4593 - val_loss: 3.6595 - val_accuracy500: 0.2762 - 80s/epoch - 47ms/step
Epoch 9/50
1701/1701 - 81s - loss: 3.1239 - accuracy500: 0.4621 - val_loss: 3.7924 - val_accuracy500: 0.2791 - 81s/epoch - 48ms/step
Epoch 10/50
1701/1701 - 83s - loss: 3.1230 - accuracy500: 0.4618 - val_loss: 3.7502 - val_accuracy500: 0.2784 - 83s/epoch - 49ms/step
Epoch 11/50
1701/1701 - 81s - loss: 3.1213 - accuracy500: 0.4630 - val_loss: 3.6406 - val_accuracy500: 0.3079 - 81s/epoch - 47ms/step
Epoch 12/50
1701/1701 - 82s - loss: 3.1141 - accuracy500: 0.4647 - val_loss: 3.7133 - val_accuracy500: 0.3000 - 82s/epoch - 48ms/step
testing model: results/AAL/W5/deepLOB_L2/h500
Evaluating performance on  test set...
6357/6357 - 121s - 121s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.101156
{'0': {'precision': 0.3673095246710328, 'recall': 0.10022131356594569, 'f1-score': 0.15747514404239119, 'support': 607735}, '1': {'precision': 0.27425455886530475, 'recall': 0.1325133223688171, 'f1-score': 0.17868855652896745, 'support': 415279}, '2': {'precision': 0.3731373354676075, 'recall': 0.7786280010924349, 'f1-score': 0.5045041180277867, 'support': 604155}, 'accuracy': 0.36034978542486984, 'macro avg': {'precision': 0.33823380633464833, 'recall': 0.3371208790090659, 'f1-score': 0.2802226061997151, 'support': 1627169}, 'weighted avg': {'precision': 0.34572426087051034, 'recall': 0.36034978542486984, 'f1-score': 0.2917382565415597, 'support': 1627169}}
[[ 60908  75286 471541]
 [ 41508  55030 318741]
 [ 63406  70337 470412]]
Evaluating performance on  train set...
1701/1701 - 33s - 33s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1095854
{'0': {'precision': 0.3668191467097199, 'recall': 0.08437521490956605, 'f1-score': 0.1371934003142175, 'support': 145410}, '1': {'precision': 0.3889040423326605, 'recall': 0.48603393851796806, 'f1-score': 0.43207762730046945, 'support': 146677}, '2': {'precision': 0.3424387522237619, 'recall': 0.5224131555629975, 'f1-score': 0.41369975027072425, 'support': 143331}, 'accuracy': 0.36387333550748935, 'macro avg': {'precision': 0.36605398042204745, 'recall': 0.3642741029968439, 'f1-score': 0.32765692596180374, 'support': 435418}, 'weighted avg': {'precision': 0.3662332267735188, 'recall': 0.36387333550748935, 'f1-score': 0.3275499436984564, 'support': 435418}}
[[12269 55573 77568]
 [ 9172 71290 66215]
 [12006 56447 74878]]
Evaluating performance on  val set...
563/563 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1040374
{'0': {'precision': 0.36756689015602484, 'recall': 0.1110059798652638, 'f1-score': 0.17051582053108152, 'support': 52844}, '1': {'precision': 0.2897043432757718, 'recall': 0.1113289596058618, 'f1-score': 0.16084690672041543, 'support': 39783}, '2': {'precision': 0.3584015884834947, 'recall': 0.7861253694198165, 'f1-score': 0.49234066389030945, 'support': 51432}, 'accuracy': 0.3521265592569711, 'macro avg': {'precision': 0.3385576073050971, 'recall': 0.3361534362969807, 'f1-score': 0.2745677970472688, 'support': 144059}, 'weighted avg': {'precision': 0.34279234987628754, 'recall': 0.3521265592569711, 'f1-score': 0.2827437059497092, 'support': 144059}}
[[ 5866  5643 41335]
 [ 4309  4429 31045]
 [ 5784  5216 40432]]
training model: results/AAL/W5/deepLOB_L2/h1000
Epoch 1/50
1701/1701 - 85s - loss: 3.2360 - accuracy1000: 0.4098 - val_loss: 3.2893 - val_accuracy1000: 0.3514 - 85s/epoch - 50ms/step
Epoch 2/50
1701/1701 - 81s - loss: 3.1838 - accuracy1000: 0.4362 - val_loss: 3.3114 - val_accuracy1000: 0.3423 - 81s/epoch - 48ms/step
Epoch 3/50
1701/1701 - 81s - loss: 3.1493 - accuracy1000: 0.4480 - val_loss: 3.3389 - val_accuracy1000: 0.3458 - 81s/epoch - 48ms/step
Epoch 4/50
1701/1701 - 80s - loss: 3.1267 - accuracy1000: 0.4583 - val_loss: 3.3164 - val_accuracy1000: 0.3664 - 80s/epoch - 47ms/step
Epoch 5/50
1701/1701 - 80s - loss: 3.1304 - accuracy1000: 0.4549 - val_loss: 3.3197 - val_accuracy1000: 0.3600 - 80s/epoch - 47ms/step
Epoch 6/50
1701/1701 - 81s - loss: 3.1088 - accuracy1000: 0.4622 - val_loss: 3.3440 - val_accuracy1000: 0.3529 - 81s/epoch - 47ms/step
Epoch 7/50
1701/1701 - 81s - loss: 3.0932 - accuracy1000: 0.4688 - val_loss: 3.3264 - val_accuracy1000: 0.3587 - 81s/epoch - 47ms/step
Epoch 8/50
1701/1701 - 82s - loss: 3.0775 - accuracy1000: 0.4752 - val_loss: 3.3433 - val_accuracy1000: 0.3683 - 82s/epoch - 48ms/step
Epoch 9/50
1701/1701 - 82s - loss: 3.0624 - accuracy1000: 0.4814 - val_loss: 3.3570 - val_accuracy1000: 0.3691 - 82s/epoch - 48ms/step
Epoch 10/50
1701/1701 - 81s - loss: 3.0514 - accuracy1000: 0.4843 - val_loss: 3.3454 - val_accuracy1000: 0.3664 - 81s/epoch - 48ms/step
Epoch 11/50
1701/1701 - 81s - loss: 3.0403 - accuracy1000: 0.4880 - val_loss: 3.3716 - val_accuracy1000: 0.3595 - 81s/epoch - 48ms/step
testing model: results/AAL/W5/deepLOB_L2/h1000
Evaluating performance on  test set...
6357/6357 - 120s - 120s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.081869
{'0': {'precision': 0.40738239236995877, 'recall': 0.18094862917705168, 'f1-score': 0.2505911901649457, 'support': 660005}, '1': {'precision': 0.188348271446863, 'recall': 0.03365714621916859, 'f1-score': 0.05710910462330287, 'support': 305938}, '2': {'precision': 0.40620803506802716, 'recall': 0.7859324950924494, 'f1-score': 0.5355947330884565, 'support': 661226}, 'accuracy': 0.39909990910593796, 'macro avg': {'precision': 0.3339795662949497, 'recall': 0.3335127568295566, 'f1-score': 0.2810983426255684, 'support': 1627169}, 'weighted avg': {'precision': 0.36572268986315265, 'recall': 0.39909990910593796, 'f1-score': 0.33002868583177697, 'support': 1627169}}
[[119427  22221 518357]
 [ 54335  10297 241306]
 [119395  22152 519679]]
Evaluating performance on  train set...
1701/1701 - 34s - 34s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1037835
{'0': {'precision': 0.36379461871281776, 'recall': 0.14501296863947183, 'f1-score': 0.20736694556437046, 'support': 148435}, '1': {'precision': 0.32699757869249396, 'recall': 0.03784026114123201, 'f1-score': 0.0678310877836236, 'support': 142758}, '2': {'precision': 0.32954160064492816, 'recall': 0.8219518114057895, 'f1-score': 0.470462640513538, 'support': 144225}, 'accuracy': 0.33409964677620124, 'macro avg': {'precision': 0.3401112660167466, 'recall': 0.33493501372883117, 'f1-score': 0.24855355795384404, 'support': 435418}, 'weighted avg': {'precision': 0.34038443959743264, 'recall': 0.33409964677620124, 'f1-score': 0.24876421581727648, 'support': 435418}}
[[ 21525   5689 121221]
 [ 17393   5402 119963]
 [ 20250   5429 118546]]
Evaluating performance on  val set...
563/563 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0971189
{'0': {'precision': 0.3714763580612565, 'recall': 0.19961802759937836, 'f1-score': 0.2596886951014542, 'support': 53407}, '1': {'precision': 0.2738828967642527, 'recall': 0.03547815673261645, 'f1-score': 0.06281889868133325, 'support': 40081}, '2': {'precision': 0.3513724493500835, 'recall': 0.7654584643372684, 'f1-score': 0.48165037731975435, 'support': 50571}, 'accuracy': 0.35258470487786253, 'macro avg': {'precision': 0.3322439013918642, 'recall': 0.3335182162230877, 'f1-score': 0.26805265703418063, 'support': 144059}, 'weighted avg': {'precision': 0.3372659422616332, 'recall': 0.35258470487786253, 'f1-score': 0.2828325869870483, 'support': 144059}}
[[10661  2006 40740]
 [ 7941  1422 30718]
 [10097  1764 38710]]
training model: results/AAL/W5/deepOF_L2/h10
Epoch 1/50
1701/1701 - 55s - loss: 2.8498 - accuracy10: 0.4899 - val_loss: 2.8086 - val_accuracy10: 0.6024 - 55s/epoch - 32ms/step
Epoch 2/50
1701/1701 - 52s - loss: 2.5654 - accuracy10: 0.5771 - val_loss: 2.6999 - val_accuracy10: 0.6430 - 52s/epoch - 31ms/step
Epoch 3/50
1701/1701 - 51s - loss: 2.4578 - accuracy10: 0.6077 - val_loss: 2.6144 - val_accuracy10: 0.6391 - 51s/epoch - 30ms/step
Epoch 4/50
1701/1701 - 51s - loss: 2.4168 - accuracy10: 0.6159 - val_loss: 2.6084 - val_accuracy10: 0.6332 - 51s/epoch - 30ms/step
Epoch 5/50
1701/1701 - 51s - loss: 2.3938 - accuracy10: 0.6192 - val_loss: 2.5409 - val_accuracy10: 0.6347 - 51s/epoch - 30ms/step
Epoch 6/50
1701/1701 - 51s - loss: 2.3752 - accuracy10: 0.6225 - val_loss: 2.5107 - val_accuracy10: 0.6230 - 51s/epoch - 30ms/step
Epoch 7/50
1701/1701 - 52s - loss: 2.3636 - accuracy10: 0.6238 - val_loss: 2.4985 - val_accuracy10: 0.6537 - 52s/epoch - 30ms/step
Epoch 8/50
1701/1701 - 50s - loss: 2.3508 - accuracy10: 0.6263 - val_loss: 2.4856 - val_accuracy10: 0.6348 - 50s/epoch - 30ms/step
Epoch 9/50
1701/1701 - 51s - loss: 2.3421 - accuracy10: 0.6273 - val_loss: 2.4878 - val_accuracy10: 0.6303 - 51s/epoch - 30ms/step
Epoch 10/50
1701/1701 - 52s - loss: 2.3328 - accuracy10: 0.6287 - val_loss: 2.4817 - val_accuracy10: 0.6270 - 52s/epoch - 30ms/step
Epoch 11/50
1701/1701 - 51s - loss: 2.3256 - accuracy10: 0.6291 - val_loss: 2.4751 - val_accuracy10: 0.6370 - 51s/epoch - 30ms/step
Epoch 12/50
1701/1701 - 51s - loss: 2.3183 - accuracy10: 0.6299 - val_loss: 2.4738 - val_accuracy10: 0.6259 - 51s/epoch - 30ms/step
Epoch 13/50
1701/1701 - 52s - loss: 2.3112 - accuracy10: 0.6321 - val_loss: 2.4698 - val_accuracy10: 0.6290 - 52s/epoch - 30ms/step
Epoch 14/50
1701/1701 - 55s - loss: 2.3039 - accuracy10: 0.6316 - val_loss: 2.4630 - val_accuracy10: 0.6263 - 55s/epoch - 32ms/step
Epoch 15/50
1701/1701 - 53s - loss: 2.2994 - accuracy10: 0.6328 - val_loss: 2.4721 - val_accuracy10: 0.6185 - 53s/epoch - 31ms/step
Epoch 16/50
1701/1701 - 54s - loss: 2.2943 - accuracy10: 0.6333 - val_loss: 2.4643 - val_accuracy10: 0.6252 - 54s/epoch - 32ms/step
Epoch 17/50
1701/1701 - 54s - loss: 2.2882 - accuracy10: 0.6334 - val_loss: 2.4714 - val_accuracy10: 0.6110 - 54s/epoch - 32ms/step
Epoch 18/50
1701/1701 - 54s - loss: 2.2831 - accuracy10: 0.6343 - val_loss: 2.4697 - val_accuracy10: 0.6248 - 54s/epoch - 32ms/step
Epoch 19/50
1701/1701 - 50s - loss: 2.2780 - accuracy10: 0.6346 - val_loss: 2.4770 - val_accuracy10: 0.6098 - 50s/epoch - 29ms/step
Epoch 20/50
1701/1701 - 52s - loss: 2.2738 - accuracy10: 0.6357 - val_loss: 2.4650 - val_accuracy10: 0.6140 - 52s/epoch - 30ms/step
Epoch 21/50
1701/1701 - 53s - loss: 2.2676 - accuracy10: 0.6359 - val_loss: 2.4764 - val_accuracy10: 0.6113 - 53s/epoch - 31ms/step
Epoch 22/50
1701/1701 - 52s - loss: 2.2636 - accuracy10: 0.6356 - val_loss: 2.4723 - val_accuracy10: 0.6049 - 52s/epoch - 31ms/step
Epoch 23/50
1701/1701 - 53s - loss: 2.2577 - accuracy10: 0.6367 - val_loss: 2.4688 - val_accuracy10: 0.6162 - 53s/epoch - 31ms/step
Epoch 24/50
1701/1701 - 53s - loss: 2.2545 - accuracy10: 0.6372 - val_loss: 2.4667 - val_accuracy10: 0.6069 - 53s/epoch - 31ms/step
testing model: results/AAL/W5/deepOF_L2/h10
Evaluating performance on  test set...
6357/6357 - 96s - 96s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94771856
{'0': {'precision': 0.3478382026924935, 'recall': 0.6538303353871463, 'f1-score': 0.45409665988493514, 'support': 257732}, '1': {'precision': 0.8471452085153788, 'recall': 0.5195944101702942, 'f1-score': 0.6441196390727754, 'support': 1106438}, '2': {'precision': 0.34104832193072243, 'recall': 0.6018084062754283, 'f1-score': 0.43536995800948747, 'support': 262994}, 'accuracy': 0.5541445115550737, 'macro avg': {'precision': 0.5120105777128648, 'recall': 0.5917443839442896, 'f1-score': 0.511195418989066, 'support': 1627164}, 'weighted avg': {'precision': 0.6862592512208535, 'recall': 0.5541445115550737, 'f1-score': 0.5802816263748551, 'support': 1627164}}
[[168513  50263  38956]
 [264692 574899 266847]
 [ 51253  53469 158272]]
Evaluating performance on  train set...
1701/1701 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80023664
{'0': {'precision': 0.380318096695065, 'recall': 0.640996384328137, 'f1-score': 0.4773897352984996, 'support': 67484}, '1': {'precision': 0.8622195210239131, 'recall': 0.6479147567188187, 'f1-score': 0.7398610301561493, 'support': 297783}, '2': {'precision': 0.4174139515881932, 'recall': 0.5825861356217302, 'f1-score': 0.4863591196053813, 'support': 70151}, 'accuracy': 0.6363172859183589, 'macro avg': {'precision': 0.5533171897690571, 'recall': 0.6238324255562286, 'f1-score': 0.5678699616866768, 'support': 435418}, 'weighted avg': {'precision': 0.7158677596798869, 'recall': 0.6363172859183589, 'f1-score': 0.6583393076062765, 'support': 435418}}
[[ 43257  13587  10640]
 [ 58444 192938  46401]
 [ 12038  17244  40869]]
Evaluating performance on  val set...
563/563 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8166506
{'0': {'precision': 0.3770791347574903, 'recall': 0.6281838936389275, 'f1-score': 0.47126977197165604, 'support': 22339}, '1': {'precision': 0.8563027847134106, 'recall': 0.6336870588948011, 'f1-score': 0.7283646871772256, 'support': 99041}, '2': {'precision': 0.4034099377030612, 'recall': 0.5968161573400361, 'f1-score': 0.4814142923202788, 'support': 22677}, 'accuracy': 0.627029578569594, 'macro avg': {'precision': 0.545597285724654, 'recall': 0.6195623699579216, 'f1-score': 0.5603495838230536, 'support': 144057}, 'weighted avg': {'precision': 0.7106963358215206, 'recall': 0.627029578569594, 'f1-score': 0.6496226793959431, 'support': 144057}}
[[14033  5035  3271]
 [19536 62761 16744]
 [ 3646  5497 13534]]
training model: results/AAL/W5/deepOF_L2/h20
Epoch 1/50
1701/1701 - 54s - loss: 2.9054 - accuracy20: 0.4850 - val_loss: 2.9010 - val_accuracy20: 0.5710 - 54s/epoch - 32ms/step
Epoch 2/50
1701/1701 - 51s - loss: 2.6480 - accuracy20: 0.5662 - val_loss: 2.8127 - val_accuracy20: 0.6028 - 51s/epoch - 30ms/step
Epoch 3/50
1701/1701 - 52s - loss: 2.5582 - accuracy20: 0.5937 - val_loss: 2.7275 - val_accuracy20: 0.6027 - 52s/epoch - 31ms/step
Epoch 4/50
1701/1701 - 52s - loss: 2.5213 - accuracy20: 0.6030 - val_loss: 2.6814 - val_accuracy20: 0.6076 - 52s/epoch - 31ms/step
Epoch 5/50
1701/1701 - 52s - loss: 2.4992 - accuracy20: 0.6068 - val_loss: 2.6782 - val_accuracy20: 0.5987 - 52s/epoch - 31ms/step
Epoch 6/50
1701/1701 - 53s - loss: 2.4834 - accuracy20: 0.6095 - val_loss: 2.6599 - val_accuracy20: 0.6079 - 53s/epoch - 31ms/step
Epoch 7/50
1701/1701 - 53s - loss: 2.4717 - accuracy20: 0.6117 - val_loss: 2.6484 - val_accuracy20: 0.6123 - 53s/epoch - 31ms/step
Epoch 8/50
1701/1701 - 53s - loss: 2.4614 - accuracy20: 0.6129 - val_loss: 2.6488 - val_accuracy20: 0.6010 - 53s/epoch - 31ms/step
Epoch 9/50
1701/1701 - 53s - loss: 2.4536 - accuracy20: 0.6153 - val_loss: 2.6310 - val_accuracy20: 0.6025 - 53s/epoch - 31ms/step
Epoch 10/50
1701/1701 - 52s - loss: 2.4456 - accuracy20: 0.6163 - val_loss: 2.6326 - val_accuracy20: 0.5945 - 52s/epoch - 31ms/step
Epoch 11/50
1701/1701 - 52s - loss: 2.4376 - accuracy20: 0.6175 - val_loss: 2.6226 - val_accuracy20: 0.5998 - 52s/epoch - 31ms/step
Epoch 12/50
1701/1701 - 51s - loss: 2.4312 - accuracy20: 0.6188 - val_loss: 2.6299 - val_accuracy20: 0.5868 - 51s/epoch - 30ms/step
Epoch 13/50
1701/1701 - 50s - loss: 2.4250 - accuracy20: 0.6189 - val_loss: 2.6136 - val_accuracy20: 0.5983 - 50s/epoch - 29ms/step
Epoch 14/50
1701/1701 - 51s - loss: 2.4168 - accuracy20: 0.6198 - val_loss: 2.6158 - val_accuracy20: 0.5935 - 51s/epoch - 30ms/step
Epoch 15/50
1701/1701 - 52s - loss: 2.4128 - accuracy20: 0.6207 - val_loss: 2.6225 - val_accuracy20: 0.5845 - 52s/epoch - 30ms/step
Epoch 16/50
1701/1701 - 51s - loss: 2.4078 - accuracy20: 0.6217 - val_loss: 2.6128 - val_accuracy20: 0.5844 - 51s/epoch - 30ms/step
Epoch 17/50
1701/1701 - 51s - loss: 2.4011 - accuracy20: 0.6221 - val_loss: 2.6079 - val_accuracy20: 0.5895 - 51s/epoch - 30ms/step
Epoch 18/50
1701/1701 - 50s - loss: 2.3973 - accuracy20: 0.6231 - val_loss: 2.6149 - val_accuracy20: 0.5807 - 50s/epoch - 29ms/step
Epoch 19/50
1701/1701 - 50s - loss: 2.3908 - accuracy20: 0.6238 - val_loss: 2.6146 - val_accuracy20: 0.5848 - 50s/epoch - 30ms/step
Epoch 20/50
1701/1701 - 51s - loss: 2.3865 - accuracy20: 0.6246 - val_loss: 2.6259 - val_accuracy20: 0.5811 - 51s/epoch - 30ms/step
Epoch 21/50
1701/1701 - 51s - loss: 2.3818 - accuracy20: 0.6253 - val_loss: 2.6103 - val_accuracy20: 0.5903 - 51s/epoch - 30ms/step
Epoch 22/50
1701/1701 - 52s - loss: 2.3769 - accuracy20: 0.6258 - val_loss: 2.6075 - val_accuracy20: 0.5815 - 52s/epoch - 30ms/step
Epoch 23/50
1701/1701 - 50s - loss: 2.3729 - accuracy20: 0.6266 - val_loss: 2.6121 - val_accuracy20: 0.5880 - 50s/epoch - 30ms/step
Epoch 24/50
1701/1701 - 51s - loss: 2.3686 - accuracy20: 0.6274 - val_loss: 2.6282 - val_accuracy20: 0.5715 - 51s/epoch - 30ms/step
Epoch 25/50
1701/1701 - 53s - loss: 2.3631 - accuracy20: 0.6278 - val_loss: 2.6114 - val_accuracy20: 0.5773 - 53s/epoch - 31ms/step
Epoch 26/50
1701/1701 - 52s - loss: 2.3583 - accuracy20: 0.6281 - val_loss: 2.6000 - val_accuracy20: 0.5793 - 52s/epoch - 31ms/step
Epoch 27/50
1701/1701 - 52s - loss: 2.3532 - accuracy20: 0.6288 - val_loss: 2.6161 - val_accuracy20: 0.5771 - 52s/epoch - 31ms/step
Epoch 28/50
1701/1701 - 52s - loss: 2.3480 - accuracy20: 0.6297 - val_loss: 2.6211 - val_accuracy20: 0.5812 - 52s/epoch - 31ms/step
Epoch 29/50
1701/1701 - 51s - loss: 2.3459 - accuracy20: 0.6296 - val_loss: 2.6172 - val_accuracy20: 0.5702 - 51s/epoch - 30ms/step
Epoch 30/50
1701/1701 - 51s - loss: 2.3404 - accuracy20: 0.6310 - val_loss: 2.6207 - val_accuracy20: 0.5729 - 51s/epoch - 30ms/step
Epoch 31/50
1701/1701 - 54s - loss: 2.3357 - accuracy20: 0.6306 - val_loss: 2.6415 - val_accuracy20: 0.5632 - 54s/epoch - 32ms/step
Epoch 32/50
1701/1701 - 54s - loss: 2.3337 - accuracy20: 0.6312 - val_loss: 2.6291 - val_accuracy20: 0.5758 - 54s/epoch - 32ms/step
Epoch 33/50
1701/1701 - 55s - loss: 2.3262 - accuracy20: 0.6321 - val_loss: 2.6316 - val_accuracy20: 0.5689 - 55s/epoch - 32ms/step
Epoch 34/50
1701/1701 - 54s - loss: 2.3229 - accuracy20: 0.6321 - val_loss: 2.6225 - val_accuracy20: 0.5761 - 54s/epoch - 32ms/step
Epoch 35/50
1701/1701 - 53s - loss: 2.3174 - accuracy20: 0.6328 - val_loss: 2.6397 - val_accuracy20: 0.5709 - 53s/epoch - 31ms/step
Epoch 36/50
1701/1701 - 53s - loss: 2.3132 - accuracy20: 0.6343 - val_loss: 2.6432 - val_accuracy20: 0.5675 - 53s/epoch - 31ms/step
testing model: results/AAL/W5/deepOF_L2/h20
Evaluating performance on  test set...
6357/6357 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0066475
{'0': {'precision': 0.3838213562290974, 'recall': 0.6712370893198774, 'f1-score': 0.4883807737114937, 'support': 338189}, '1': {'precision': 0.7772154589995577, 'recall': 0.43261608752343095, 'f1-score': 0.555839219106901, 'support': 946398}, '2': {'precision': 0.3832609938637529, 'recall': 0.5693844011711235, 'f1-score': 0.45814073656520105, 'support': 342577}, 'accuracy': 0.5110056515507964, 'macro avg': {'precision': 0.514765936364136, 'recall': 0.557745859338144, 'f1-score': 0.5007869097945319, 'support': 1627164}, 'weighted avg': {'precision': 0.6125109196755142, 'recall': 0.5110056515507964, 'f1-score': 0.5212496158195155, 'support': 1627164}}
[[227005  51285  59899]
 [282985 409427 253986]
 [ 81444  66075 195058]]
Evaluating performance on  train set...
1701/1701 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8606037
{'0': {'precision': 0.4209516417653019, 'recall': 0.6606923311188062, 'f1-score': 0.514253355925656, 'support': 88657}, '1': {'precision': 0.7916501246605581, 'recall': 0.5849637411895393, 'f1-score': 0.6727908676826183, 'support': 255662}, '2': {'precision': 0.4687488356496144, 'recall': 0.5523990384087641, 'f1-score': 0.5071477161069261, 'support': 91099}, 'accuracy': 0.5935698570109642, 'macro avg': {'precision': 0.5604502006918247, 'recall': 0.5993517035723698, 'f1-score': 0.5647306465717334, 'support': 435418}, 'weighted avg': {'precision': 0.6486128594908759, 'recall': 0.5935698570109642, 'f1-score': 0.6058543017959738, 'support': 435418}}
[[ 58575  16793  13289]
 [ 62365 149553  43744]
 [ 18209  22567  50323]]
Evaluating performance on  val set...
563/563 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88692325
{'0': {'precision': 0.4125788634924793, 'recall': 0.6362442768650687, 'f1-score': 0.5005628319052854, 'support': 29704}, '1': {'precision': 0.7806514817536125, 'recall': 0.5651418439716313, 'f1-score': 0.6556412629846756, 'support': 84600}, '2': {'precision': 0.4510201324145386, 'recall': 0.5609518367895674, 'f1-score': 0.500014979478115, 'support': 29753}, 'accuracy': 0.5789375039047044, 'macro avg': {'precision': 0.5480834925535435, 'recall': 0.5874459858754225, 'f1-score': 0.5520730247893587, 'support': 144057}, 'weighted avg': {'precision': 0.6366754820471479, 'recall': 0.5789375039047044, 'f1-score': 0.5915222092076782, 'support': 144057}}
[[18899  6408  4397]
 [20871 47811 15918]
 [ 6037  7026 16690]]
training model: results/AAL/W5/deepOF_L2/h30
Epoch 1/50
1701/1701 - 55s - loss: 2.9665 - accuracy30: 0.4788 - val_loss: 3.0753 - val_accuracy30: 0.5591 - 55s/epoch - 32ms/step
Epoch 2/50
1701/1701 - 53s - loss: 2.7281 - accuracy30: 0.5563 - val_loss: 2.8976 - val_accuracy30: 0.5686 - 53s/epoch - 31ms/step
Epoch 3/50
1701/1701 - 54s - loss: 2.6431 - accuracy30: 0.5797 - val_loss: 2.8264 - val_accuracy30: 0.5779 - 54s/epoch - 32ms/step
Epoch 4/50
1701/1701 - 54s - loss: 2.6123 - accuracy30: 0.5870 - val_loss: 2.8289 - val_accuracy30: 0.5702 - 54s/epoch - 32ms/step
Epoch 5/50
1701/1701 - 53s - loss: 2.5909 - accuracy30: 0.5908 - val_loss: 2.7958 - val_accuracy30: 0.5800 - 53s/epoch - 31ms/step
Epoch 6/50
1701/1701 - 52s - loss: 2.5774 - accuracy30: 0.5932 - val_loss: 2.7745 - val_accuracy30: 0.5778 - 52s/epoch - 30ms/step
Epoch 7/50
1701/1701 - 51s - loss: 2.5669 - accuracy30: 0.5949 - val_loss: 2.7727 - val_accuracy30: 0.5753 - 51s/epoch - 30ms/step
Epoch 8/50
1701/1701 - 51s - loss: 2.5573 - accuracy30: 0.5956 - val_loss: 2.7696 - val_accuracy30: 0.5706 - 51s/epoch - 30ms/step
Epoch 9/50
1701/1701 - 51s - loss: 2.5492 - accuracy30: 0.5973 - val_loss: 2.7517 - val_accuracy30: 0.5736 - 51s/epoch - 30ms/step
Epoch 10/50
1701/1701 - 51s - loss: 2.5419 - accuracy30: 0.5982 - val_loss: 2.7467 - val_accuracy30: 0.5752 - 51s/epoch - 30ms/step
Epoch 11/50
1701/1701 - 51s - loss: 2.5352 - accuracy30: 0.5995 - val_loss: 2.7516 - val_accuracy30: 0.5697 - 51s/epoch - 30ms/step
Epoch 12/50
1701/1701 - 52s - loss: 2.5292 - accuracy30: 0.6005 - val_loss: 2.7470 - val_accuracy30: 0.5712 - 52s/epoch - 31ms/step
Epoch 13/50
1701/1701 - 52s - loss: 2.5238 - accuracy30: 0.6006 - val_loss: 2.7466 - val_accuracy30: 0.5769 - 52s/epoch - 31ms/step
Epoch 14/50
1701/1701 - 52s - loss: 2.5176 - accuracy30: 0.6021 - val_loss: 2.7426 - val_accuracy30: 0.5710 - 52s/epoch - 30ms/step
Epoch 15/50
1701/1701 - 53s - loss: 2.5115 - accuracy30: 0.6029 - val_loss: 2.7311 - val_accuracy30: 0.5751 - 53s/epoch - 31ms/step
Epoch 16/50
1701/1701 - 52s - loss: 2.5072 - accuracy30: 0.6041 - val_loss: 2.7445 - val_accuracy30: 0.5745 - 52s/epoch - 31ms/step
Epoch 17/50
1701/1701 - 53s - loss: 2.5011 - accuracy30: 0.6041 - val_loss: 2.7350 - val_accuracy30: 0.5683 - 53s/epoch - 31ms/step
Epoch 18/50
1701/1701 - 53s - loss: 2.4958 - accuracy30: 0.6046 - val_loss: 2.7365 - val_accuracy30: 0.5696 - 53s/epoch - 31ms/step
Epoch 19/50
1701/1701 - 53s - loss: 2.4916 - accuracy30: 0.6062 - val_loss: 2.7426 - val_accuracy30: 0.5735 - 53s/epoch - 31ms/step
Epoch 20/50
1701/1701 - 51s - loss: 2.4879 - accuracy30: 0.6067 - val_loss: 2.7585 - val_accuracy30: 0.5649 - 51s/epoch - 30ms/step
Epoch 21/50
1701/1701 - 53s - loss: 2.4810 - accuracy30: 0.6070 - val_loss: 2.7805 - val_accuracy30: 0.5630 - 53s/epoch - 31ms/step
Epoch 22/50
1701/1701 - 53s - loss: 2.4778 - accuracy30: 0.6082 - val_loss: 2.7779 - val_accuracy30: 0.5532 - 53s/epoch - 31ms/step
Epoch 23/50
1701/1701 - 52s - loss: 2.4720 - accuracy30: 0.6085 - val_loss: 2.7619 - val_accuracy30: 0.5715 - 52s/epoch - 31ms/step
Epoch 24/50
1701/1701 - 54s - loss: 2.4685 - accuracy30: 0.6090 - val_loss: 2.7651 - val_accuracy30: 0.5646 - 54s/epoch - 32ms/step
Epoch 25/50
1701/1701 - 55s - loss: 2.4614 - accuracy30: 0.6099 - val_loss: 2.7822 - val_accuracy30: 0.5679 - 55s/epoch - 32ms/step
testing model: results/AAL/W5/deepOF_L2/h30
Evaluating performance on  test set...
6357/6357 - 96s - 96s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9693408
{'0': {'precision': 0.44103671875612566, 'recall': 0.5665585560177677, 'f1-score': 0.4959791550935111, 'support': 397124}, '1': {'precision': 0.672665999437025, 'recall': 0.5179388072102012, 'f1-score': 0.5852484778393823, 'support': 830490}, '2': {'precision': 0.41776252418564525, 'recall': 0.49932423976974094, 'f1-score': 0.45491650952108414, 'support': 399550}, 'accuracy': 0.5252340882664562, 'macro avg': {'precision': 0.5104884141262653, 'recall': 0.5279405343325699, 'f1-score': 0.5120480474846592, 'support': 1627164}, 'weighted avg': {'precision': 0.5535432619638445, 'recall': 0.5252340882664562, 'f1-score': 0.5314584920311248, 'support': 1627164}}
[[224994  95698  76432]
 [198728 430143 201619]
 [ 86426 113619 199505]]
Evaluating performance on  train set...
1701/1701 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8733695
{'0': {'precision': 0.47040401377337837, 'recall': 0.5685757602093533, 'f1-score': 0.5148518314489826, 'support': 103557}, '1': {'precision': 0.6932865638357183, 'recall': 0.6593801368047086, 'f1-score': 0.6759083950102821, 'support': 226308}, '2': {'precision': 0.5129724552410824, 'recall': 0.46173012609778974, 'f1-score': 0.48600432783877306, 'support': 105553}, 'accuracy': 0.5898699640345599, 'macro avg': {'precision': 0.5588876776167263, 'recall': 0.5632286743706172, 'f1-score': 0.558921518099346, 'support': 435418}, 'weighted avg': {'precision': 0.5965663011426386, 'recall': 0.5898699640345599, 'f1-score': 0.5915676498989826, 'support': 435418}}
[[ 58880  29902  14775]
 [ 45588 149223  31497]
 [ 20701  36115  48737]]
Evaluating performance on  val set...
563/563 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8935146
{'0': {'precision': 0.45962717979555023, 'recall': 0.5470342379480133, 'f1-score': 0.49953599017083405, 'support': 34932}, '1': {'precision': 0.682653194168995, 'recall': 0.6341119044737585, 'f1-score': 0.6574878351435384, 'support': 74367}, '2': {'precision': 0.498937221207676, 'recall': 0.4794867368663329, 'f1-score': 0.48901864702689224, 'support': 34758}, 'accuracy': 0.5756887898540162, 'macro avg': {'precision': 0.5470725317240737, 'recall': 0.5535442930960349, 'f1-score': 0.548680824113755, 'support': 144057}, 'weighted avg': {'precision': 0.584245310329385, 'recall': 0.5756887898540162, 'f1-score': 0.5785383506398704, 'support': 144057}}
[[19109 10724  5099]
 [15572 47157 11638]
 [ 6894 11198 16666]]
training model: results/AAL/W5/deepOF_L2/h50
Epoch 1/50
1701/1701 - 54s - loss: 3.0609 - accuracy50: 0.4608 - val_loss: 3.1386 - val_accuracy50: 0.4873 - 54s/epoch - 32ms/step
Epoch 2/50
1701/1701 - 51s - loss: 2.8804 - accuracy50: 0.5166 - val_loss: 3.1136 - val_accuracy50: 0.5010 - 51s/epoch - 30ms/step
Epoch 3/50
1701/1701 - 51s - loss: 2.8078 - accuracy50: 0.5364 - val_loss: 3.0327 - val_accuracy50: 0.5133 - 51s/epoch - 30ms/step
Epoch 4/50
1701/1701 - 52s - loss: 2.7766 - accuracy50: 0.5460 - val_loss: 3.0132 - val_accuracy50: 0.5156 - 52s/epoch - 31ms/step
Epoch 5/50
1701/1701 - 53s - loss: 2.7574 - accuracy50: 0.5500 - val_loss: 3.0348 - val_accuracy50: 0.5181 - 53s/epoch - 31ms/step
Epoch 6/50
1701/1701 - 53s - loss: 2.7485 - accuracy50: 0.5520 - val_loss: 2.9754 - val_accuracy50: 0.5265 - 53s/epoch - 31ms/step
Epoch 7/50
1701/1701 - 52s - loss: 2.7355 - accuracy50: 0.5550 - val_loss: 2.9758 - val_accuracy50: 0.5257 - 52s/epoch - 31ms/step
Epoch 8/50
1701/1701 - 53s - loss: 2.7275 - accuracy50: 0.5569 - val_loss: 2.9564 - val_accuracy50: 0.5284 - 53s/epoch - 31ms/step
Epoch 9/50
1701/1701 - 54s - loss: 2.7188 - accuracy50: 0.5583 - val_loss: 2.9604 - val_accuracy50: 0.5258 - 54s/epoch - 32ms/step
Epoch 10/50
1701/1701 - 53s - loss: 2.7143 - accuracy50: 0.5602 - val_loss: 2.9553 - val_accuracy50: 0.5260 - 53s/epoch - 31ms/step
Epoch 11/50
1701/1701 - 54s - loss: 2.7072 - accuracy50: 0.5615 - val_loss: 2.9509 - val_accuracy50: 0.5274 - 54s/epoch - 32ms/step
Epoch 12/50
1701/1701 - 54s - loss: 2.7000 - accuracy50: 0.5628 - val_loss: 2.9494 - val_accuracy50: 0.5279 - 54s/epoch - 32ms/step
Epoch 13/50
1701/1701 - 55s - loss: 2.6952 - accuracy50: 0.5640 - val_loss: 2.9493 - val_accuracy50: 0.5261 - 55s/epoch - 32ms/step
Epoch 14/50
1701/1701 - 54s - loss: 2.6885 - accuracy50: 0.5648 - val_loss: 2.9531 - val_accuracy50: 0.5239 - 54s/epoch - 32ms/step
Epoch 15/50
1701/1701 - 53s - loss: 2.6843 - accuracy50: 0.5660 - val_loss: 2.9420 - val_accuracy50: 0.5286 - 53s/epoch - 31ms/step
Epoch 16/50
1701/1701 - 51s - loss: 2.6785 - accuracy50: 0.5675 - val_loss: 2.9326 - val_accuracy50: 0.5299 - 51s/epoch - 30ms/step
Epoch 17/50
1701/1701 - 51s - loss: 2.6733 - accuracy50: 0.5681 - val_loss: 2.9463 - val_accuracy50: 0.5229 - 51s/epoch - 30ms/step
Epoch 18/50
1701/1701 - 52s - loss: 2.6668 - accuracy50: 0.5702 - val_loss: 2.9418 - val_accuracy50: 0.5267 - 52s/epoch - 31ms/step
Epoch 19/50
1701/1701 - 52s - loss: 2.6621 - accuracy50: 0.5705 - val_loss: 2.9665 - val_accuracy50: 0.5255 - 52s/epoch - 31ms/step
Epoch 20/50
1701/1701 - 51s - loss: 2.6559 - accuracy50: 0.5715 - val_loss: 2.9444 - val_accuracy50: 0.5261 - 51s/epoch - 30ms/step
Epoch 21/50
1701/1701 - 52s - loss: 2.6505 - accuracy50: 0.5723 - val_loss: 2.9696 - val_accuracy50: 0.5236 - 52s/epoch - 31ms/step
Epoch 22/50
1701/1701 - 52s - loss: 2.6459 - accuracy50: 0.5734 - val_loss: 2.9609 - val_accuracy50: 0.5243 - 52s/epoch - 30ms/step
Epoch 23/50
1701/1701 - 52s - loss: 2.6409 - accuracy50: 0.5742 - val_loss: 2.9501 - val_accuracy50: 0.5273 - 52s/epoch - 31ms/step
Epoch 24/50
1701/1701 - 51s - loss: 2.6350 - accuracy50: 0.5758 - val_loss: 2.9901 - val_accuracy50: 0.5203 - 51s/epoch - 30ms/step
Epoch 25/50
1701/1701 - 54s - loss: 2.6296 - accuracy50: 0.5768 - val_loss: 2.9629 - val_accuracy50: 0.5202 - 54s/epoch - 32ms/step
Epoch 26/50
1701/1701 - 54s - loss: 2.6237 - accuracy50: 0.5776 - val_loss: 2.9762 - val_accuracy50: 0.5221 - 54s/epoch - 32ms/step
testing model: results/AAL/W5/deepOF_L2/h50
Evaluating performance on  test set...
6357/6357 - 102s - 102s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9837873
{'0': {'precision': 0.47950022245595475, 'recall': 0.4839814494817071, 'f1-score': 0.4817304147038286, 'support': 483221}, '1': {'precision': 0.5322818220908849, 'recall': 0.613584556580222, 'f1-score': 0.5700488501322732, 'support': 663739}, '2': {'precision': 0.4771470401222529, 'recall': 0.37192318264737484, 'f1-score': 0.41801500275011405, 'support': 480204}, 'accuracy': 0.5037777384455409, 'macro avg': {'precision': 0.4963096948896975, 'recall': 0.489829729569768, 'f1-score': 0.48993142252873856, 'support': 1627164}, 'weighted avg': {'precision': 0.5003359824596888, 'recall': 0.5037777384455409, 'f1-score': 0.498953014473132, 'support': 1627164}}
[[233870 172418  76933]
 [137705 407260 118774]
 [116162 185443 178599]]
Evaluating performance on  train set...
1701/1701 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9369202
{'0': {'precision': 0.48746455695224555, 'recall': 0.5075373650594462, 'f1-score': 0.4972984902284559, 'support': 124314}, '1': {'precision': 0.563789378310566, 'recall': 0.7006674931383005, 'f1-score': 0.6248198721182556, 'support': 184721}, '2': {'precision': 0.5612887184788725, 'recall': 0.33938108764628155, 'f1-score': 0.4229980276134122, 'support': 126383}, 'accuracy': 0.5406620764414884, 'macro avg': {'precision': 0.5375142179138948, 'recall': 0.5158619819480094, 'f1-score': 0.5150387966533746, 'support': 435418}, 'weighted avg': {'precision': 0.5412724296914294, 'recall': 0.5406620764414884, 'f1-score': 0.5298317383196893, 'support': 435418}}
[[ 63094  47459  13761]
 [ 35529 129428  19764]
 [ 30810  52681  42892]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9576101
{'0': {'precision': 0.47691515265030904, 'recall': 0.48410095536860115, 'f1-score': 0.48048118881943624, 'support': 42078}, '1': {'precision': 0.5522788203753352, 'recall': 0.6929475707562802, 'f1-score': 0.6146677739642971, 'support': 60348}, '2': {'precision': 0.5563490205260283, 'recall': 0.3424611467416108, 'f1-score': 0.42395587076438135, 'support': 41631}, 'accuracy': 0.5306580034291981, 'macro avg': {'precision': 0.5285143311838909, 'recall': 0.5065032242888307, 'f1-score': 0.5063682778493716, 'support': 144057}, 'weighted avg': {'precision': 0.5314418884104869, 'recall': 0.5306580034291981, 'f1-score': 0.520359060247913, 'support': 144057}}
[[20370 16940  4768]
 [11929 41818  6601]
 [10413 16961 14257]]
training model: results/AAL/W5/deepOF_L2/h100
Epoch 1/50
1701/1701 - 57s - loss: 3.1807 - accuracy100: 0.4259 - val_loss: 3.2425 - val_accuracy100: 0.3934 - 57s/epoch - 33ms/step
Epoch 2/50
1701/1701 - 54s - loss: 3.0838 - accuracy100: 0.4588 - val_loss: 3.2541 - val_accuracy100: 0.4016 - 54s/epoch - 32ms/step
Epoch 3/50
1701/1701 - 54s - loss: 3.0392 - accuracy100: 0.4721 - val_loss: 3.2168 - val_accuracy100: 0.4159 - 54s/epoch - 32ms/step
Epoch 4/50
1701/1701 - 52s - loss: 3.0137 - accuracy100: 0.4788 - val_loss: 3.1918 - val_accuracy100: 0.4234 - 52s/epoch - 31ms/step
Epoch 5/50
1701/1701 - 50s - loss: 2.9997 - accuracy100: 0.4825 - val_loss: 3.1747 - val_accuracy100: 0.4302 - 50s/epoch - 29ms/step
Epoch 6/50
1701/1701 - 53s - loss: 2.9915 - accuracy100: 0.4843 - val_loss: 3.1675 - val_accuracy100: 0.4357 - 53s/epoch - 31ms/step
Epoch 7/50
1701/1701 - 53s - loss: 2.9830 - accuracy100: 0.4873 - val_loss: 3.1641 - val_accuracy100: 0.4376 - 53s/epoch - 31ms/step
Epoch 8/50
1701/1701 - 52s - loss: 2.9766 - accuracy100: 0.4884 - val_loss: 3.1787 - val_accuracy100: 0.4330 - 52s/epoch - 31ms/step
Epoch 9/50
1701/1701 - 52s - loss: 2.9721 - accuracy100: 0.4894 - val_loss: 3.1589 - val_accuracy100: 0.4388 - 52s/epoch - 31ms/step
Epoch 10/50
1701/1701 - 53s - loss: 2.9664 - accuracy100: 0.4917 - val_loss: 3.1531 - val_accuracy100: 0.4397 - 53s/epoch - 31ms/step
Epoch 11/50
1701/1701 - 52s - loss: 2.9613 - accuracy100: 0.4932 - val_loss: 3.1657 - val_accuracy100: 0.4386 - 52s/epoch - 31ms/step
Epoch 12/50
1701/1701 - 53s - loss: 2.9560 - accuracy100: 0.4949 - val_loss: 3.1623 - val_accuracy100: 0.4407 - 53s/epoch - 31ms/step
Epoch 13/50
1701/1701 - 54s - loss: 2.9505 - accuracy100: 0.4969 - val_loss: 3.2056 - val_accuracy100: 0.4375 - 54s/epoch - 32ms/step
Epoch 14/50
1701/1701 - 53s - loss: 2.9456 - accuracy100: 0.4977 - val_loss: 3.1803 - val_accuracy100: 0.4380 - 53s/epoch - 31ms/step
Epoch 15/50
1701/1701 - 53s - loss: 2.9401 - accuracy100: 0.4992 - val_loss: 3.1905 - val_accuracy100: 0.4394 - 53s/epoch - 31ms/step
Epoch 16/50
1701/1701 - 53s - loss: 2.9338 - accuracy100: 0.5018 - val_loss: 3.2127 - val_accuracy100: 0.4396 - 53s/epoch - 31ms/step
Epoch 17/50
1701/1701 - 53s - loss: 2.9293 - accuracy100: 0.5031 - val_loss: 3.2169 - val_accuracy100: 0.4397 - 53s/epoch - 31ms/step
Epoch 18/50
1701/1701 - 51s - loss: 2.9239 - accuracy100: 0.5051 - val_loss: 3.2092 - val_accuracy100: 0.4393 - 51s/epoch - 30ms/step
Epoch 19/50
1701/1701 - 52s - loss: 2.9183 - accuracy100: 0.5063 - val_loss: 3.2019 - val_accuracy100: 0.4394 - 52s/epoch - 31ms/step
Epoch 20/50
1701/1701 - 54s - loss: 2.9126 - accuracy100: 0.5085 - val_loss: 3.2223 - val_accuracy100: 0.4389 - 54s/epoch - 32ms/step
testing model: results/AAL/W5/deepOF_L2/h100
Evaluating performance on  test set...
6357/6357 - 96s - 96s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0777646
{'0': {'precision': 0.5218479736355351, 'recall': 0.2403062064715601, 'f1-score': 0.3290759538486161, 'support': 564717}, '1': {'precision': 0.36634652358696274, 'recall': 0.6466486195542046, 'f1-score': 0.46771689945403444, 'support': 505344}, '2': {'precision': 0.4368201717460852, 'recall': 0.37253793284186226, 'f1-score': 0.4021262847272343, 'support': 557103}, 'accuracy': 0.41177594882875973, 'macro avg': {'precision': 0.44167155632286104, 'recall': 0.4198309196225423, 'f1-score': 0.39963971267662823, 'support': 1627164}, 'weighted avg': {'precision': 0.44444276537787697, 'recall': 0.41177594882875973, 'f1-score': 0.39714403334121506, 'support': 1627164}}
[[135705 288663 140349]
 [ 51335 326780 127229]
 [ 73007 276554 207542]]
Evaluating performance on  train set...
1701/1701 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0321106
{'0': {'precision': 0.5319111896727194, 'recall': 0.2727154136628905, 'f1-score': 0.3605657071793614, 'support': 145650}, '1': {'precision': 0.4073275143158948, 'recall': 0.7584576736738947, 'f1-score': 0.5300130454807417, 'support': 144898}, '2': {'precision': 0.5118268691511706, 'recall': 0.32128114861600054, 'f1-score': 0.39476351422985745, 'support': 144870}, 'accuracy': 0.4505188118084232, 'macro avg': {'precision': 0.48368852437992826, 'recall': 0.4508180786509286, 'f1-score': 0.4284474222966535, 'support': 435418}, 'weighted avg': {'precision': 0.4837699991252226, 'recall': 0.4505188118084232, 'f1-score': 0.42833235149034254, 'support': 435418}}
[[ 39721  82392  23537]
 [ 14143 109899  20856]
 [ 20812  77514  46544]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0520644
{'0': {'precision': 0.509263994335392, 'recall': 0.26484728217507825, 'f1-score': 0.34846975855293266, 'support': 48881}, '1': {'precision': 0.3972386633195919, 'recall': 0.7307447890188103, 'f1-score': 0.5146885490488623, 'support': 47208}, '2': {'precision': 0.4937095049380386, 'recall': 0.32723899266177453, 'f1-score': 0.3935959479451368, 'support': 47968}, 'accuracy': 0.43829872897533617, 'macro avg': {'precision': 0.4667373875310075, 'recall': 0.4409436879518877, 'f1-score': 0.4189180851823106, 'support': 144057}, 'weighted avg': {'precision': 0.4673735650330593, 'recall': 0.43829872897533617, 'f1-score': 0.4179663447271352, 'support': 144057}}
[[12946 27330  8605]
 [ 5219 34497  7492]
 [ 7256 25015 15697]]
training model: results/AAL/W5/deepOF_L2/h200
Epoch 1/50
1701/1701 - 56s - loss: 3.2659 - accuracy200: 0.3863 - val_loss: 3.2950 - val_accuracy200: 0.3530 - 56s/epoch - 33ms/step
Epoch 2/50
1701/1701 - 53s - loss: 3.2380 - accuracy200: 0.3986 - val_loss: 3.2862 - val_accuracy200: 0.3657 - 53s/epoch - 31ms/step
Epoch 3/50
1701/1701 - 52s - loss: 3.2235 - accuracy200: 0.4072 - val_loss: 3.2885 - val_accuracy200: 0.3672 - 52s/epoch - 30ms/step
Epoch 4/50
1701/1701 - 53s - loss: 3.2127 - accuracy200: 0.4124 - val_loss: 3.2862 - val_accuracy200: 0.3692 - 53s/epoch - 31ms/step
Epoch 5/50
1701/1701 - 50s - loss: 3.2037 - accuracy200: 0.4173 - val_loss: 3.2898 - val_accuracy200: 0.3702 - 50s/epoch - 30ms/step
Epoch 6/50
1701/1701 - 51s - loss: 3.1982 - accuracy200: 0.4198 - val_loss: 3.2818 - val_accuracy200: 0.3781 - 51s/epoch - 30ms/step
Epoch 7/50
1701/1701 - 51s - loss: 3.1917 - accuracy200: 0.4233 - val_loss: 3.2782 - val_accuracy200: 0.3793 - 51s/epoch - 30ms/step
Epoch 8/50
1701/1701 - 51s - loss: 3.1871 - accuracy200: 0.4254 - val_loss: 3.2798 - val_accuracy200: 0.3806 - 51s/epoch - 30ms/step
Epoch 9/50
1701/1701 - 52s - loss: 3.1830 - accuracy200: 0.4265 - val_loss: 3.2787 - val_accuracy200: 0.3788 - 52s/epoch - 31ms/step
Epoch 10/50
1701/1701 - 52s - loss: 3.1780 - accuracy200: 0.4284 - val_loss: 3.2864 - val_accuracy200: 0.3805 - 52s/epoch - 30ms/step
Epoch 11/50
1701/1701 - 52s - loss: 3.1738 - accuracy200: 0.4309 - val_loss: 3.2959 - val_accuracy200: 0.3785 - 52s/epoch - 30ms/step
Epoch 12/50
1701/1701 - 52s - loss: 3.1708 - accuracy200: 0.4314 - val_loss: 3.2921 - val_accuracy200: 0.3813 - 52s/epoch - 30ms/step
Epoch 13/50
1701/1701 - 52s - loss: 3.1663 - accuracy200: 0.4333 - val_loss: 3.3020 - val_accuracy200: 0.3804 - 52s/epoch - 31ms/step
Epoch 14/50
1701/1701 - 52s - loss: 3.1620 - accuracy200: 0.4355 - val_loss: 3.3085 - val_accuracy200: 0.3798 - 52s/epoch - 30ms/step
Epoch 15/50
1701/1701 - 52s - loss: 3.1575 - accuracy200: 0.4375 - val_loss: 3.3171 - val_accuracy200: 0.3778 - 52s/epoch - 31ms/step
Epoch 16/50
1701/1701 - 53s - loss: 3.1533 - accuracy200: 0.4399 - val_loss: 3.3116 - val_accuracy200: 0.3808 - 53s/epoch - 31ms/step
Epoch 17/50
1701/1701 - 53s - loss: 3.1481 - accuracy200: 0.4413 - val_loss: 3.3017 - val_accuracy200: 0.3833 - 53s/epoch - 31ms/step
testing model: results/AAL/W5/deepOF_L2/h200
Evaluating performance on  test set...
6357/6357 - 100s - 100s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1071517
{'0': {'precision': 0.4721472415907554, 'recall': 0.24602981141398336, 'f1-score': 0.32349208686688435, 'support': 607150}, '1': {'precision': 0.26087760603754256, 'recall': 0.4373688227437512, 'f1-score': 0.326817944867962, 'support': 419280}, '2': {'precision': 0.4274304064647422, 'recall': 0.4324942487024207, 'f1-score': 0.4299474178481447, 'support': 600734}, 'accuracy': 0.36417410906337655, 'macro avg': {'precision': 0.3868184180310134, 'recall': 0.37196429428671846, 'f1-score': 0.3600858165276637, 'support': 1627164}, 'weighted avg': {'precision': 0.40119922649987244, 'recall': 0.36417410906337655, 'f1-score': 0.3636514085728638, 'support': 1627164}}
[[149377 267381 190392]
 [ 78255 183380 157645]
 [ 88746 252174 259814]]
Evaluating performance on  train set...
1701/1701 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.080889
{'0': {'precision': 0.42864926927043806, 'recall': 0.303318645001377, 'f1-score': 0.35525413887925683, 'support': 145240}, '1': {'precision': 0.3506436901357543, 'recall': 0.450121455279893, 'f1-score': 0.39420359138307093, 'support': 146556}, '2': {'precision': 0.4132585980208982, 'recall': 0.4158137332720614, 'f1-score': 0.4145322282842586, 'support': 143622}, 'accuracy': 0.38983689236549707, 'macro avg': {'precision': 0.3975171858090302, 'recall': 0.3897512778511105, 'f1-score': 0.38799665284886214, 'support': 435418}, 'weighted avg': {'precision': 0.39731702154098236, 'recall': 0.38983689236549707, 'f1-score': 0.3879168072064141, 'support': 435418}}
[[44054 63330 37856]
 [33654 65968 46934]
 [25066 58836 59720]]
Evaluating performance on  val set...
563/563 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0923617
{'0': {'precision': 0.4390544775621791, 'recall': 0.2638655125430793, 'f1-score': 0.3296287952742109, 'support': 49908}, '1': {'precision': 0.32738284985655086, 'recall': 0.44995509211592805, 'f1-score': 0.3790052496102003, 'support': 45649}, '2': {'precision': 0.4080626619644214, 'recall': 0.43181443298969074, 'f1-score': 0.41960269677328876, 'support': 48500}, 'accuracy': 0.37937760747481897, 'macro avg': {'precision': 0.39149999646105044, 'recall': 0.3818783458828994, 'f1-score': 0.3760789138859, 'support': 144057}, 'weighted avg': {'precision': 0.3932337177960763, 'recall': 0.37937760747481897, 'f1-score': 0.375567000197879, 'support': 144057}}
[[13169 22328 14411]
 [ 9140 20540 15969]
 [ 7685 19872 20943]]
training model: results/AAL/W5/deepOF_L2/h300
Epoch 1/50
1701/1701 - 56s - loss: 3.2842 - accuracy300: 0.3740 - val_loss: 3.2865 - val_accuracy300: 0.3627 - 56s/epoch - 33ms/step
Epoch 2/50
1701/1701 - 52s - loss: 3.2617 - accuracy300: 0.3840 - val_loss: 3.2868 - val_accuracy300: 0.3635 - 52s/epoch - 31ms/step
Epoch 3/50
1701/1701 - 53s - loss: 3.2516 - accuracy300: 0.3888 - val_loss: 3.2850 - val_accuracy300: 0.3645 - 53s/epoch - 31ms/step
Epoch 4/50
1701/1701 - 53s - loss: 3.2451 - accuracy300: 0.3934 - val_loss: 3.2797 - val_accuracy300: 0.3688 - 53s/epoch - 31ms/step
Epoch 5/50
1701/1701 - 53s - loss: 3.2396 - accuracy300: 0.3973 - val_loss: 3.2831 - val_accuracy300: 0.3667 - 53s/epoch - 31ms/step
Epoch 6/50
1701/1701 - 54s - loss: 3.2356 - accuracy300: 0.4002 - val_loss: 3.2826 - val_accuracy300: 0.3682 - 54s/epoch - 32ms/step
Epoch 7/50
1701/1701 - 52s - loss: 3.2319 - accuracy300: 0.4020 - val_loss: 3.2819 - val_accuracy300: 0.3704 - 52s/epoch - 31ms/step
Epoch 8/50
1701/1701 - 53s - loss: 3.2286 - accuracy300: 0.4046 - val_loss: 3.2821 - val_accuracy300: 0.3699 - 53s/epoch - 31ms/step
Epoch 9/50
1701/1701 - 52s - loss: 3.2252 - accuracy300: 0.4066 - val_loss: 3.2811 - val_accuracy300: 0.3720 - 52s/epoch - 31ms/step
Epoch 10/50
1701/1701 - 50s - loss: 3.2221 - accuracy300: 0.4084 - val_loss: 3.2849 - val_accuracy300: 0.3713 - 50s/epoch - 29ms/step
Epoch 11/50
1701/1701 - 50s - loss: 3.2189 - accuracy300: 0.4104 - val_loss: 3.2856 - val_accuracy300: 0.3732 - 50s/epoch - 29ms/step
Epoch 12/50
1701/1701 - 52s - loss: 3.2161 - accuracy300: 0.4120 - val_loss: 3.2893 - val_accuracy300: 0.3726 - 52s/epoch - 31ms/step
Epoch 13/50
1701/1701 - 53s - loss: 3.2130 - accuracy300: 0.4140 - val_loss: 3.2973 - val_accuracy300: 0.3733 - 53s/epoch - 31ms/step
Epoch 14/50
1701/1701 - 52s - loss: 3.2092 - accuracy300: 0.4167 - val_loss: 3.3040 - val_accuracy300: 0.3742 - 52s/epoch - 31ms/step
testing model: results/AAL/W5/deepOF_L2/h300
Evaluating performance on  test set...
6357/6357 - 96s - 96s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0932165
{'0': {'precision': 0.41083438769394687, 'recall': 0.2171468394127057, 'f1-score': 0.28412119649125633, 'support': 568233}, '1': {'precision': 0.3773844321749486, 'recall': 0.07035669810540082, 'f1-score': 0.11860211523380017, 'support': 495461}, '2': {'precision': 0.3700340393404696, 'recall': 0.8106731503008145, 'f1-score': 0.508130488274254, 'support': 563470}, 'accuracy': 0.37798218249666293, 'macro avg': {'precision': 0.3860842864031217, 'recall': 0.3660588959396403, 'f1-score': 0.3036179333331035, 'support': 1627164}, 'weighted avg': {'precision': 0.3865203537685821, 'recall': 0.37798218249666293, 'f1-score': 0.3112937901093951, 'support': 1627164}}
[[123390  29568 415275]
 [ 98213  34859 362389]
 [ 78737  27943 456790]]
Evaluating performance on  train set...
1701/1701 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0891279
{'0': {'precision': 0.40999077774362125, 'recall': 0.27126837337961707, 'f1-score': 0.326505797964796, 'support': 147496}, '1': {'precision': 0.40413330747707565, 'recall': 0.10269478782417706, 'f1-score': 0.1637730214595647, 'support': 142052}, '2': {'precision': 0.3652889494284644, 'recall': 0.7555974497840543, 'f1-score': 0.4924877290265213, 'support': 145870}, 'accuracy': 0.3785282188609566, 'macro avg': {'precision': 0.3931376782163871, 'recall': 0.3765202036626161, 'f1-score': 0.3275888494836274, 'support': 435418}, 'weighted avg': {'precision': 0.3931041973481501, 'recall': 0.3785282188609566, 'f1-score': 0.3290212381070335, 'support': 435418}}
[[ 40011  11658  95827]
 [ 31779  14588  95685]
 [ 25800   9851 110219]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0932003
{'0': {'precision': 0.4040172267720983, 'recall': 0.23407301360057264, 'f1-score': 0.2964142807194748, 'support': 48895}, '1': {'precision': 0.4083071353720111, 'recall': 0.09035141345363323, 'f1-score': 0.14796147340076637, 'support': 47437}, '2': {'precision': 0.3553481830621864, 'recall': 0.7835306443163961, 'f1-score': 0.48894787423916525, 'support': 47725}, 'accuracy': 0.3687776366299451, 'macro avg': {'precision': 0.3892241817354319, 'recall': 0.36931835712353395, 'f1-score': 0.3111078761198021, 'support': 144057}, 'weighted avg': {'precision': 0.38930617686267716, 'recall': 0.3687776366299451, 'f1-score': 0.3113147015941956, 'support': 144057}}
[[11445  3355 34095]
 [ 9408  4286 33743]
 [ 7475  2856 37394]]
training model: results/AAL/W5/deepOF_L2/h500
Epoch 1/50
1701/1701 - 54s - loss: 3.2672 - accuracy500: 0.3951 - val_loss: 3.4960 - val_accuracy500: 0.2779 - 54s/epoch - 32ms/step
Epoch 2/50
1701/1701 - 53s - loss: 3.2728 - accuracy500: 0.3852 - val_loss: 3.4732 - val_accuracy500: 0.2774 - 53s/epoch - 31ms/step
Epoch 3/50
1701/1701 - 53s - loss: 3.2765 - accuracy500: 0.3765 - val_loss: 3.4373 - val_accuracy500: 0.2769 - 53s/epoch - 31ms/step
Epoch 4/50
1701/1701 - 53s - loss: 3.2740 - accuracy500: 0.3759 - val_loss: 3.4280 - val_accuracy500: 0.2770 - 53s/epoch - 31ms/step
Epoch 5/50
1701/1701 - 55s - loss: 3.2711 - accuracy500: 0.3765 - val_loss: 3.4481 - val_accuracy500: 0.2771 - 55s/epoch - 32ms/step
Epoch 6/50
1701/1701 - 54s - loss: 3.2655 - accuracy500: 0.3809 - val_loss: 3.4745 - val_accuracy500: 0.2773 - 54s/epoch - 32ms/step
Epoch 7/50
1701/1701 - 55s - loss: 3.2585 - accuracy500: 0.3875 - val_loss: 3.4833 - val_accuracy500: 0.2776 - 55s/epoch - 32ms/step
Epoch 8/50
1701/1701 - 57s - loss: 3.2527 - accuracy500: 0.3928 - val_loss: 3.4786 - val_accuracy500: 0.2776 - 57s/epoch - 34ms/step
Epoch 9/50
1701/1701 - 54s - loss: 3.2455 - accuracy500: 0.3969 - val_loss: 3.5029 - val_accuracy500: 0.2786 - 54s/epoch - 32ms/step
Epoch 10/50
1701/1701 - 53s - loss: 3.2380 - accuracy500: 0.4019 - val_loss: 3.5218 - val_accuracy500: 0.2782 - 53s/epoch - 31ms/step
Epoch 11/50
1701/1701 - 51s - loss: 3.2326 - accuracy500: 0.4046 - val_loss: 3.5283 - val_accuracy500: 0.2782 - 51s/epoch - 30ms/step
Epoch 12/50
1701/1701 - 55s - loss: 3.2280 - accuracy500: 0.4077 - val_loss: 3.5595 - val_accuracy500: 0.2784 - 55s/epoch - 32ms/step
Epoch 13/50
1701/1701 - 55s - loss: 3.2232 - accuracy500: 0.4113 - val_loss: 3.5842 - val_accuracy500: 0.2788 - 55s/epoch - 32ms/step
Epoch 14/50
1701/1701 - 54s - loss: 3.2190 - accuracy500: 0.4133 - val_loss: 3.5846 - val_accuracy500: 0.2789 - 54s/epoch - 32ms/step
testing model: results/AAL/W5/deepOF_L2/h500
Evaluating performance on  test set...
6357/6357 - 107s - 107s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1499754
{'0': {'precision': 0.3339449541284404, 'recall': 0.000598948220597237, 'f1-score': 0.0011957517960914685, 'support': 607732}, '1': {'precision': 0.2551202263432346, 'recall': 0.9962121759399727, 'f1-score': 0.4062132097721718, 'support': 415278}, '2': {'precision': 0.4245409762651142, 'recall': 0.0031382726920619578, 'f1-score': 0.006230488646446058, 'support': 604154}, 'accuracy': 0.2556380303399043, 'macro avg': {'precision': 0.33786871891226306, 'recall': 0.33331646561754397, 'f1-score': 0.13787981673823643, 'support': 1627164}, 'weighted avg': {'precision': 0.3474652715966091, 'recall': 0.2556380303399043, 'f1-score': 0.10643197649162296, 'support': 1627164}}
[[   364 606058   1310]
 [   313 413705   1260]
 [   413 601845   1896]]
Evaluating performance on  train set...
1701/1701 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1132376
{'0': {'precision': 0.39361702127659576, 'recall': 0.0027983855996589683, 'f1-score': 0.0055572623314558795, 'support': 145441}, '1': {'precision': 0.33685325970269164, 'recall': 0.9950217882009561, 'f1-score': 0.5033149819245522, 'support': 146639}, '2': {'precision': 0.41186027619821286, 'recall': 0.0035370941411209866, 'f1-score': 0.007013951815396108, 'support': 143338}, 'accuracy': 0.33720011575084174, 'macro avg': {'precision': 0.3807768523925001, 'recall': 0.33378575598057864, 'f1-score': 0.17196206535713474, 'support': 435418}, 'weighted avg': {'precision': 0.3805058739205357, 'recall': 0.33720011575084174, 'f1-score': 0.17367041613001513, 'support': 435418}}
[[   407 144725    309]
 [   315 145909    415]
 [   312 142519    507]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1407201
{'0': {'precision': 0.38562091503267976, 'recall': 0.00223353712782268, 'f1-score': 0.004441349718651786, 'support': 52831}, '1': {'precision': 0.27636546338876367, 'recall': 0.9945506139976394, 'f1-score': 0.4325375155632249, 'support': 39821}, '2': {'precision': 0.43080357142857145, 'recall': 0.0037544985896313587, 'f1-score': 0.00744412088018051, 'support': 51405}, 'accuracy': 0.27707782336158604, 'macro avg': {'precision': 0.3642633166166716, 'recall': 0.3335128832383645, 'f1-score': 0.1481409953873524, 'support': 144057}, 'weighted avg': {'precision': 0.3715428286649117, 'recall': 0.27707782336158604, 'f1-score': 0.12384946505948997, 'support': 144057}}
[[  118 52587   126]
 [   88 39604   129]
 [  100 51112   193]]
training model: results/AAL/W5/deepOF_L2/h1000
Epoch 1/50
1701/1701 - 56s - loss: 3.2737 - accuracy1000: 0.3870 - val_loss: 3.3099 - val_accuracy1000: 0.3438 - 56s/epoch - 33ms/step
Epoch 2/50
1701/1701 - 53s - loss: 3.2680 - accuracy1000: 0.3846 - val_loss: 3.3410 - val_accuracy1000: 0.3268 - 53s/epoch - 31ms/step
Epoch 3/50
1701/1701 - 53s - loss: 3.2610 - accuracy1000: 0.3854 - val_loss: 3.3361 - val_accuracy1000: 0.3212 - 53s/epoch - 31ms/step
Epoch 4/50
1701/1701 - 54s - loss: 3.2499 - accuracy1000: 0.3922 - val_loss: 3.3418 - val_accuracy1000: 0.3119 - 54s/epoch - 31ms/step
Epoch 5/50
1701/1701 - 53s - loss: 3.2414 - accuracy1000: 0.3980 - val_loss: 3.3464 - val_accuracy1000: 0.3089 - 53s/epoch - 31ms/step
Epoch 6/50
1701/1701 - 54s - loss: 3.2392 - accuracy1000: 0.4002 - val_loss: 3.3403 - val_accuracy1000: 0.3162 - 54s/epoch - 32ms/step
Epoch 7/50
1701/1701 - 54s - loss: 3.2360 - accuracy1000: 0.4031 - val_loss: 3.3566 - val_accuracy1000: 0.3090 - 54s/epoch - 32ms/step
Epoch 8/50
1701/1701 - 54s - loss: 3.2316 - accuracy1000: 0.4054 - val_loss: 3.3468 - val_accuracy1000: 0.3198 - 54s/epoch - 32ms/step
Epoch 9/50
1701/1701 - 56s - loss: 3.2284 - accuracy1000: 0.4075 - val_loss: 3.3515 - val_accuracy1000: 0.3130 - 56s/epoch - 33ms/step
Epoch 10/50
1701/1701 - 53s - loss: 3.2267 - accuracy1000: 0.4091 - val_loss: 3.3591 - val_accuracy1000: 0.3143 - 53s/epoch - 31ms/step
Epoch 11/50
1701/1701 - 51s - loss: 3.2219 - accuracy1000: 0.4106 - val_loss: 3.3607 - val_accuracy1000: 0.3071 - 51s/epoch - 30ms/step
testing model: results/AAL/W5/deepOF_L2/h1000
Evaluating performance on  test set...
6357/6357 - 97s - 97s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1066159
{'0': {'precision': 0.4205072790034519, 'recall': 0.10612998142429872, 'f1-score': 0.1694845126346366, 'support': 660002}, '1': {'precision': 0.18316059999813317, 'recall': 0.1924180716354294, 'f1-score': 0.18767524416623227, 'support': 305938}, '2': {'precision': 0.4122743568225789, 'recall': 0.7102857730511899, 'f1-score': 0.5217228056689247, 'support': 661224}, 'accuracy': 0.3678621208433815, 'macro avg': {'precision': 0.338647411941388, 'recall': 0.33627794203697264, 'f1-score': 0.29296085415659784, 'support': 1627164}, 'weighted avg': {'precision': 0.37253597800511684, 'recall': 0.3678621208433815, 'f1-score': 0.31604235750867354, 'support': 1627164}}
[[ 70046 133946 456010]
 [ 33550  58868 213520]
 [ 62979 128587 469658]]
Evaluating performance on  train set...
1701/1701 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.10153
{'0': {'precision': 0.36635085199908934, 'recall': 0.14093512093242605, 'f1-score': 0.20356053344750913, 'support': 148430}, '1': {'precision': 0.33495101699133467, 'recall': 0.2073444863831486, 'f1-score': 0.2561343258405097, 'support': 142801}, '2': {'precision': 0.3371907325839286, 'recall': 0.6779945487457261, 'f1-score': 0.4503876933283576, 'support': 144187}, 'accuracy': 0.34056010546187804, 'macro avg': {'precision': 0.34616420052478425, 'recall': 0.3420913853537669, 'f1-score': 0.3033608508721255, 'support': 435418}, 'weighted avg': {'precision': 0.34639660578727416, 'recall': 0.34056010546187804, 'f1-score': 0.3025386598209085, 'support': 435418}}
[[20919 30644 96867]
 [17898 29609 95294]
 [18284 28145 97758]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1058954
{'0': {'precision': 0.38834179460517465, 'recall': 0.11884171907756813, 'f1-score': 0.18199016811660673, 'support': 53424}, '1': {'precision': 0.27754719507296827, 'recall': 0.2070205222949019, 'f1-score': 0.23715143715143716, 'support': 40054}, '2': {'precision': 0.3540661542235669, 'recall': 0.684849443444908, 'f1-score': 0.4667982831461279, 'support': 50579}, 'accuracy': 0.34208681285879894, 'macro avg': {'precision': 0.3399850479672366, 'recall': 0.33690389493912604, 'f1-score': 0.2953132961380573, 'support': 144057}, 'weighted avg': {'precision': 0.3455018458034897, 'recall': 0.34208681285879894, 'f1-score': 0.29732464766289224, 'support': 144057}}
[[ 6349 11182 35893]
 [ 4462  8292 27300]
 [ 5538 10402 34639]]
training model: results/AAL/W5/deepVOL_L2/h10
Epoch 1/50
1701/1701 - 60s - loss: 2.8753 - accuracy10: 0.5023 - val_loss: 2.8426 - val_accuracy10: 0.5161 - 60s/epoch - 35ms/step
Epoch 2/50
1701/1701 - 57s - loss: 2.6432 - accuracy10: 0.5614 - val_loss: 2.6815 - val_accuracy10: 0.5554 - 57s/epoch - 34ms/step
Epoch 3/50
1701/1701 - 60s - loss: 2.5680 - accuracy10: 0.5827 - val_loss: 2.6461 - val_accuracy10: 0.5606 - 60s/epoch - 35ms/step
Epoch 4/50
1701/1701 - 61s - loss: 2.5244 - accuracy10: 0.5957 - val_loss: 2.6190 - val_accuracy10: 0.5796 - 61s/epoch - 36ms/step
Epoch 5/50
1701/1701 - 59s - loss: 2.4906 - accuracy10: 0.6054 - val_loss: 2.5947 - val_accuracy10: 0.5932 - 59s/epoch - 35ms/step
Epoch 6/50
1701/1701 - 61s - loss: 2.4620 - accuracy10: 0.6107 - val_loss: 2.5625 - val_accuracy10: 0.6148 - 61s/epoch - 36ms/step
Epoch 7/50
1701/1701 - 57s - loss: 2.4387 - accuracy10: 0.6144 - val_loss: 2.5538 - val_accuracy10: 0.6030 - 57s/epoch - 34ms/step
Epoch 8/50
1701/1701 - 55s - loss: 2.4219 - accuracy10: 0.6174 - val_loss: 2.5926 - val_accuracy10: 0.6416 - 55s/epoch - 32ms/step
Epoch 9/50
1701/1701 - 52s - loss: 2.4047 - accuracy10: 0.6212 - val_loss: 2.5266 - val_accuracy10: 0.6358 - 52s/epoch - 30ms/step
Epoch 10/50
1701/1701 - 56s - loss: 2.3904 - accuracy10: 0.6234 - val_loss: 2.5108 - val_accuracy10: 0.6294 - 56s/epoch - 33ms/step
Epoch 11/50
1701/1701 - 55s - loss: 2.3834 - accuracy10: 0.6255 - val_loss: 2.4922 - val_accuracy10: 0.6255 - 55s/epoch - 32ms/step
Epoch 12/50
1701/1701 - 55s - loss: 2.3702 - accuracy10: 0.6270 - val_loss: 2.5051 - val_accuracy10: 0.6174 - 55s/epoch - 32ms/step
Epoch 13/50
1701/1701 - 56s - loss: 2.3647 - accuracy10: 0.6293 - val_loss: 2.4880 - val_accuracy10: 0.6253 - 56s/epoch - 33ms/step
Epoch 14/50
1701/1701 - 56s - loss: 2.3544 - accuracy10: 0.6309 - val_loss: 2.4892 - val_accuracy10: 0.6352 - 56s/epoch - 33ms/step
Epoch 15/50
1701/1701 - 55s - loss: 2.3499 - accuracy10: 0.6309 - val_loss: 2.4816 - val_accuracy10: 0.6258 - 55s/epoch - 32ms/step
Epoch 16/50
1701/1701 - 56s - loss: 2.3403 - accuracy10: 0.6329 - val_loss: 2.4738 - val_accuracy10: 0.6181 - 56s/epoch - 33ms/step
Epoch 17/50
1701/1701 - 56s - loss: 2.3355 - accuracy10: 0.6331 - val_loss: 2.4814 - val_accuracy10: 0.6137 - 56s/epoch - 33ms/step
Epoch 18/50
1701/1701 - 57s - loss: 2.3288 - accuracy10: 0.6343 - val_loss: 2.5021 - val_accuracy10: 0.6307 - 57s/epoch - 34ms/step
Epoch 19/50
1701/1701 - 54s - loss: 2.3234 - accuracy10: 0.6352 - val_loss: 2.4817 - val_accuracy10: 0.6232 - 54s/epoch - 32ms/step
Epoch 20/50
1701/1701 - 57s - loss: 2.3190 - accuracy10: 0.6347 - val_loss: 2.4668 - val_accuracy10: 0.6214 - 57s/epoch - 33ms/step
Epoch 21/50
1701/1701 - 59s - loss: 2.3165 - accuracy10: 0.6352 - val_loss: 2.4704 - val_accuracy10: 0.6081 - 59s/epoch - 35ms/step
Epoch 22/50
1701/1701 - 60s - loss: 2.3106 - accuracy10: 0.6365 - val_loss: 2.4776 - val_accuracy10: 0.6187 - 60s/epoch - 35ms/step
Epoch 23/50
1701/1701 - 67s - loss: 2.3046 - accuracy10: 0.6366 - val_loss: 2.4804 - val_accuracy10: 0.6192 - 67s/epoch - 39ms/step
Epoch 24/50
1701/1701 - 66s - loss: 2.2997 - accuracy10: 0.6380 - val_loss: 2.4743 - val_accuracy10: 0.6118 - 66s/epoch - 39ms/step
Epoch 25/50
1701/1701 - 63s - loss: 2.2963 - accuracy10: 0.6375 - val_loss: 2.4771 - val_accuracy10: 0.6232 - 63s/epoch - 37ms/step
Epoch 26/50
1701/1701 - 59s - loss: 2.2920 - accuracy10: 0.6370 - val_loss: 2.4803 - val_accuracy10: 0.6125 - 59s/epoch - 35ms/step
Epoch 27/50
1701/1701 - 61s - loss: 2.2873 - accuracy10: 0.6383 - val_loss: 2.4775 - val_accuracy10: 0.6098 - 61s/epoch - 36ms/step
Epoch 28/50
1701/1701 - 55s - loss: 2.2836 - accuracy10: 0.6387 - val_loss: 2.4900 - val_accuracy10: 0.5943 - 55s/epoch - 32ms/step
Epoch 29/50
1701/1701 - 58s - loss: 2.2807 - accuracy10: 0.6391 - val_loss: 2.4861 - val_accuracy10: 0.6116 - 58s/epoch - 34ms/step
Epoch 30/50
1701/1701 - 60s - loss: 2.2760 - accuracy10: 0.6393 - val_loss: 2.4895 - val_accuracy10: 0.6070 - 60s/epoch - 35ms/step
testing model: results/AAL/W5/deepVOL_L2/h10
Evaluating performance on  test set...
6357/6357 - 109s - 109s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8346325
{'0': {'precision': 0.40342959608821116, 'recall': 0.6232680854365918, 'f1-score': 0.48981271992145337, 'support': 257735}, '1': {'precision': 0.8554503555504401, 'recall': 0.6180024384534529, 'f1-score': 0.7175939505594348, 'support': 1106439}, '2': {'precision': 0.3722490131823937, 'recall': 0.6081560485940798, 'f1-score': 0.46182031851170635, 'support': 262995}, 'accuracy': 0.6172450433851677, 'macro avg': {'precision': 0.5437096549403483, 'recall': 0.6164755241613749, 'f1-score': 0.5564089963308648, 'support': 1627169}, 'weighted avg': {'precision': 0.7057540993680265, 'recall': 0.6172450433851677, 'f1-score': 0.6401745910221818, 'support': 1627169}}
[[160638  57905  39192]
 [192127 683782 230530]
 [ 45416  57637 159942]]
Evaluating performance on  train set...
1701/1701 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81639856
{'0': {'precision': 0.39162854815464626, 'recall': 0.6480617399161593, 'f1-score': 0.4882213121157001, 'support': 67509}, '1': {'precision': 0.8703381687797334, 'recall': 0.623940727798125, 'f1-score': 0.7268247335923205, 'support': 297610}, '2': {'precision': 0.394789306751246, 'recall': 0.6197100954494374, 'f1-score': 0.48231653648788536, 'support': 70299}, 'accuracy': 0.6269975058449582, 'macro avg': {'precision': 0.5522520078952086, 'recall': 0.6305708543879073, 'f1-score': 0.5657875273986354, 'support': 435418}, 'weighted avg': {'precision': 0.719338859540061, 'recall': 0.6269975058449582, 'f1-score': 0.650354399043198, 'support': 435418}}
[[ 43750  13498  10261]
 [ 55395 185691  56524]
 [ 12568  14166  43565]]
Evaluating performance on  val set...
563/563 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8277852
{'0': {'precision': 0.39532075047747445, 'recall': 0.6315624158664632, 'f1-score': 0.48626705821385385, 'support': 22286}, '1': {'precision': 0.8602670768370272, 'recall': 0.6205943470454133, 'f1-score': 0.7210355759482915, 'support': 99134}, '2': {'precision': 0.37690850027070927, 'recall': 0.6150006625734352, 'f1-score': 0.46737944577787477, 'support': 22639}, 'accuracy': 0.62141206033639, 'macro avg': {'precision': 0.5441654425284036, 'recall': 0.6223858084951039, 'f1-score': 0.5582273599800067, 'support': 144059}, 'weighted avg': {'precision': 0.7123794152252303, 'recall': 0.62141206033639, 'f1-score': 0.6448544812776514, 'support': 144059}}
[[14075  4982  3229]
 [17824 61522 19788]
 [ 3705  5011 13923]]
training model: results/AAL/W5/deepVOL_L2/h20
Epoch 1/50
1701/1701 - 58s - loss: 2.9639 - accuracy20: 0.4824 - val_loss: 2.8851 - val_accuracy20: 0.5182 - 58s/epoch - 34ms/step
Epoch 2/50
1701/1701 - 55s - loss: 2.7148 - accuracy20: 0.5608 - val_loss: 2.8251 - val_accuracy20: 0.5475 - 55s/epoch - 32ms/step
Epoch 3/50
1701/1701 - 56s - loss: 2.6484 - accuracy20: 0.5802 - val_loss: 2.7948 - val_accuracy20: 0.5727 - 56s/epoch - 33ms/step
Epoch 4/50
1701/1701 - 58s - loss: 2.6147 - accuracy20: 0.5889 - val_loss: 2.8067 - val_accuracy20: 0.5789 - 58s/epoch - 34ms/step
Epoch 5/50
1701/1701 - 60s - loss: 2.5904 - accuracy20: 0.5945 - val_loss: 2.7870 - val_accuracy20: 0.5810 - 60s/epoch - 35ms/step
Epoch 6/50
1701/1701 - 60s - loss: 2.5668 - accuracy20: 0.5978 - val_loss: 2.7660 - val_accuracy20: 0.5786 - 60s/epoch - 35ms/step
Epoch 7/50
1701/1701 - 61s - loss: 2.5512 - accuracy20: 0.6005 - val_loss: 2.7288 - val_accuracy20: 0.5917 - 61s/epoch - 36ms/step
Epoch 8/50
1701/1701 - 62s - loss: 2.5298 - accuracy20: 0.6039 - val_loss: 2.7307 - val_accuracy20: 0.5936 - 62s/epoch - 36ms/step
Epoch 9/50
1701/1701 - 60s - loss: 2.5166 - accuracy20: 0.6064 - val_loss: 2.7037 - val_accuracy20: 0.5982 - 60s/epoch - 36ms/step
Epoch 10/50
1701/1701 - 57s - loss: 2.5057 - accuracy20: 0.6083 - val_loss: 2.6756 - val_accuracy20: 0.5906 - 57s/epoch - 33ms/step
Epoch 11/50
1701/1701 - 56s - loss: 2.4944 - accuracy20: 0.6110 - val_loss: 2.6821 - val_accuracy20: 0.5944 - 56s/epoch - 33ms/step
Epoch 12/50
1701/1701 - 55s - loss: 2.4858 - accuracy20: 0.6116 - val_loss: 2.6633 - val_accuracy20: 0.5870 - 55s/epoch - 32ms/step
Epoch 13/50
1701/1701 - 57s - loss: 2.4782 - accuracy20: 0.6135 - val_loss: 2.6638 - val_accuracy20: 0.5969 - 57s/epoch - 34ms/step
Epoch 14/50
1701/1701 - 59s - loss: 2.4713 - accuracy20: 0.6141 - val_loss: 2.6660 - val_accuracy20: 0.5915 - 59s/epoch - 35ms/step
Epoch 15/50
1701/1701 - 57s - loss: 2.4662 - accuracy20: 0.6152 - val_loss: 2.6520 - val_accuracy20: 0.5921 - 57s/epoch - 34ms/step
Epoch 16/50
1701/1701 - 61s - loss: 2.4594 - accuracy20: 0.6160 - val_loss: 2.6633 - val_accuracy20: 0.5886 - 61s/epoch - 36ms/step
Epoch 17/50
1701/1701 - 64s - loss: 2.4532 - accuracy20: 0.6166 - val_loss: 2.6360 - val_accuracy20: 0.5877 - 64s/epoch - 38ms/step
Epoch 18/50
1701/1701 - 62s - loss: 2.4480 - accuracy20: 0.6174 - val_loss: 2.6281 - val_accuracy20: 0.5867 - 62s/epoch - 36ms/step
Epoch 19/50
1701/1701 - 60s - loss: 2.4446 - accuracy20: 0.6185 - val_loss: 2.6247 - val_accuracy20: 0.5884 - 60s/epoch - 35ms/step
Epoch 20/50
1701/1701 - 57s - loss: 2.4398 - accuracy20: 0.6192 - val_loss: 2.6172 - val_accuracy20: 0.5875 - 57s/epoch - 33ms/step
Epoch 21/50
1701/1701 - 60s - loss: 2.4346 - accuracy20: 0.6196 - val_loss: 2.6295 - val_accuracy20: 0.5780 - 60s/epoch - 35ms/step
Epoch 22/50
1701/1701 - 62s - loss: 2.4308 - accuracy20: 0.6198 - val_loss: 2.6227 - val_accuracy20: 0.5826 - 62s/epoch - 36ms/step
Epoch 23/50
1701/1701 - 60s - loss: 2.4255 - accuracy20: 0.6212 - val_loss: 2.6265 - val_accuracy20: 0.5792 - 60s/epoch - 35ms/step
Epoch 24/50
1701/1701 - 60s - loss: 2.4205 - accuracy20: 0.6216 - val_loss: 2.6296 - val_accuracy20: 0.5887 - 60s/epoch - 36ms/step
Epoch 25/50
1701/1701 - 58s - loss: 2.4175 - accuracy20: 0.6217 - val_loss: 2.6307 - val_accuracy20: 0.5745 - 58s/epoch - 34ms/step
Epoch 26/50
1701/1701 - 56s - loss: 2.4141 - accuracy20: 0.6230 - val_loss: 2.6363 - val_accuracy20: 0.5908 - 56s/epoch - 33ms/step
Epoch 27/50
1701/1701 - 59s - loss: 2.4089 - accuracy20: 0.6243 - val_loss: 2.6304 - val_accuracy20: 0.5841 - 59s/epoch - 35ms/step
Epoch 28/50
1701/1701 - 59s - loss: 2.4039 - accuracy20: 0.6240 - val_loss: 2.6292 - val_accuracy20: 0.5814 - 59s/epoch - 35ms/step
Epoch 29/50
1701/1701 - 59s - loss: 2.4009 - accuracy20: 0.6244 - val_loss: 2.6345 - val_accuracy20: 0.5753 - 59s/epoch - 35ms/step
Epoch 30/50
1701/1701 - 57s - loss: 2.3969 - accuracy20: 0.6250 - val_loss: 2.6424 - val_accuracy20: 0.5740 - 57s/epoch - 34ms/step
testing model: results/AAL/W5/deepVOL_L2/h20
Evaluating performance on  test set...
6357/6357 - 103s - 103s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89370257
{'0': {'precision': 0.4682721482106617, 'recall': 0.5512710198023022, 'f1-score': 0.506393201951845, 'support': 338193}, '1': {'precision': 0.7674160910347857, 'recall': 0.575915206921401, 'f1-score': 0.658015781416754, 'support': 946398}, '2': {'precision': 0.39808287988218943, 'recall': 0.6028554081114373, 'f1-score': 0.4795229034441365, 'support': 342578}, 'accuracy': 0.5764650137754591, 'macro avg': {'precision': 0.5445903730425455, 'recall': 0.5766805449450468, 'f1-score': 0.5479772956042451, 'support': 1627169}, 'weighted avg': {'precision': 0.6274835946156964, 'recall': 0.5764650137754591, 'f1-score': 0.5889231252961672, 'support': 1627169}}
[[186436  90448  61309]
 [150388 545045 250965]
 [ 61312  74741 206525]]
Evaluating performance on  train set...
1701/1701 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85863423
{'0': {'precision': 0.4683326698273678, 'recall': 0.5833192467629061, 'f1-score': 0.5195396991885015, 'support': 88737}, '1': {'precision': 0.7912215845264599, 'recall': 0.6062109274139914, 'f1-score': 0.6864691732121261, 'support': 255614}, '2': {'precision': 0.4244246416117784, 'recall': 0.6014472860641067, 'f1-score': 0.4976626067046162, 'support': 91067}, 'accuracy': 0.6005493571694326, 'macro avg': {'precision': 0.561326298655202, 'recall': 0.5969924867470014, 'f1-score': 0.5678904930350812, 'support': 435418}, 'weighted avg': {'precision': 0.6487026927395686, 'recall': 0.6005493571694326, 'f1-score': 0.6129608011912777, 'support': 435418}}
[[ 51762  22089  14886]
 [ 41266 154956  59392]
 [ 17496  18799  54772]]
Evaluating performance on  val set...
563/563 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8771339
{'0': {'precision': 0.470506415351425, 'recall': 0.5587580906148867, 'f1-score': 0.5108487949207915, 'support': 29664}, '1': {'precision': 0.7751928359691462, 'recall': 0.5902623493264004, 'f1-score': 0.6702045581102024, 'support': 84620}, '2': {'precision': 0.40983828100364883, 'recall': 0.6111167086481948, 'f1-score': 0.49063675461421263, 'support': 29775}, 'accuracy': 0.5880854372166959, 'macro avg': {'precision': 0.5518458441080734, 'recall': 0.5867123828631606, 'f1-score': 0.5572300358817355, 'support': 144059}, 'weighted avg': {'precision': 0.6369394130292273, 'recall': 0.5880854372166959, 'f1-score': 0.6002765375884455, 'support': 144059}}
[[16575  7992  5097]
 [13567 49948 21105]
 [ 5086  6493 18196]]
training model: results/AAL/W5/deepVOL_L2/h30
Epoch 1/50
1701/1701 - 58s - loss: 3.0019 - accuracy30: 0.4864 - val_loss: 2.9619 - val_accuracy30: 0.5296 - 58s/epoch - 34ms/step
Epoch 2/50
1701/1701 - 59s - loss: 2.8092 - accuracy30: 0.5434 - val_loss: 2.9059 - val_accuracy30: 0.5428 - 59s/epoch - 34ms/step
Epoch 3/50
1701/1701 - 57s - loss: 2.7455 - accuracy30: 0.5594 - val_loss: 2.9050 - val_accuracy30: 0.5431 - 57s/epoch - 33ms/step
Epoch 4/50
1701/1701 - 59s - loss: 2.7139 - accuracy30: 0.5690 - val_loss: 2.8989 - val_accuracy30: 0.5478 - 59s/epoch - 35ms/step
Epoch 5/50
1701/1701 - 57s - loss: 2.6942 - accuracy30: 0.5723 - val_loss: 2.8828 - val_accuracy30: 0.5637 - 57s/epoch - 33ms/step
Epoch 6/50
1701/1701 - 56s - loss: 2.6744 - accuracy30: 0.5782 - val_loss: 2.8828 - val_accuracy30: 0.5735 - 56s/epoch - 33ms/step
Epoch 7/50
1701/1701 - 57s - loss: 2.6628 - accuracy30: 0.5802 - val_loss: 2.8646 - val_accuracy30: 0.5669 - 57s/epoch - 33ms/step
Epoch 8/50
1701/1701 - 56s - loss: 2.6498 - accuracy30: 0.5831 - val_loss: 2.8409 - val_accuracy30: 0.5703 - 56s/epoch - 33ms/step
Epoch 9/50
1701/1701 - 56s - loss: 2.6375 - accuracy30: 0.5851 - val_loss: 2.8326 - val_accuracy30: 0.5759 - 56s/epoch - 33ms/step
Epoch 10/50
1701/1701 - 54s - loss: 2.6268 - accuracy30: 0.5861 - val_loss: 2.8281 - val_accuracy30: 0.5769 - 54s/epoch - 32ms/step
Epoch 11/50
1701/1701 - 53s - loss: 2.6160 - accuracy30: 0.5874 - val_loss: 2.8189 - val_accuracy30: 0.5795 - 53s/epoch - 31ms/step
Epoch 12/50
1701/1701 - 54s - loss: 2.6083 - accuracy30: 0.5878 - val_loss: 2.8322 - val_accuracy30: 0.5681 - 54s/epoch - 32ms/step
Epoch 13/50
1701/1701 - 55s - loss: 2.5981 - accuracy30: 0.5902 - val_loss: 2.8106 - val_accuracy30: 0.5709 - 55s/epoch - 32ms/step
Epoch 14/50
1701/1701 - 57s - loss: 2.5899 - accuracy30: 0.5910 - val_loss: 2.7963 - val_accuracy30: 0.5709 - 57s/epoch - 33ms/step
Epoch 15/50
1701/1701 - 55s - loss: 2.5832 - accuracy30: 0.5910 - val_loss: 2.7902 - val_accuracy30: 0.5766 - 55s/epoch - 32ms/step
Epoch 16/50
1701/1701 - 54s - loss: 2.5763 - accuracy30: 0.5921 - val_loss: 2.7874 - val_accuracy30: 0.5687 - 54s/epoch - 32ms/step
Epoch 17/50
1701/1701 - 55s - loss: 2.5707 - accuracy30: 0.5943 - val_loss: 2.7888 - val_accuracy30: 0.5717 - 55s/epoch - 32ms/step
Epoch 18/50
1701/1701 - 57s - loss: 2.5635 - accuracy30: 0.5954 - val_loss: 2.7807 - val_accuracy30: 0.5753 - 57s/epoch - 33ms/step
Epoch 19/50
1701/1701 - 58s - loss: 2.5598 - accuracy30: 0.5960 - val_loss: 2.7674 - val_accuracy30: 0.5717 - 58s/epoch - 34ms/step
Epoch 20/50
1701/1701 - 58s - loss: 2.5537 - accuracy30: 0.5970 - val_loss: 2.7604 - val_accuracy30: 0.5813 - 58s/epoch - 34ms/step
Epoch 21/50
1701/1701 - 59s - loss: 2.5491 - accuracy30: 0.5982 - val_loss: 2.7788 - val_accuracy30: 0.5768 - 59s/epoch - 35ms/step
Epoch 22/50
1701/1701 - 60s - loss: 2.5439 - accuracy30: 0.5976 - val_loss: 2.7807 - val_accuracy30: 0.5742 - 60s/epoch - 35ms/step
Epoch 23/50
1701/1701 - 58s - loss: 2.5405 - accuracy30: 0.5993 - val_loss: 2.7962 - val_accuracy30: 0.5701 - 58s/epoch - 34ms/step
Epoch 24/50
1701/1701 - 57s - loss: 2.5360 - accuracy30: 0.5989 - val_loss: 2.7999 - val_accuracy30: 0.5705 - 57s/epoch - 33ms/step
Epoch 25/50
1701/1701 - 54s - loss: 2.5334 - accuracy30: 0.5994 - val_loss: 2.8043 - val_accuracy30: 0.5646 - 54s/epoch - 32ms/step
Epoch 26/50
1701/1701 - 55s - loss: 2.5286 - accuracy30: 0.6009 - val_loss: 2.8267 - val_accuracy30: 0.5719 - 55s/epoch - 32ms/step
Epoch 27/50
1701/1701 - 55s - loss: 2.5243 - accuracy30: 0.6012 - val_loss: 2.8024 - val_accuracy30: 0.5703 - 55s/epoch - 32ms/step
Epoch 28/50
1701/1701 - 56s - loss: 2.5218 - accuracy30: 0.6020 - val_loss: 2.8019 - val_accuracy30: 0.5723 - 56s/epoch - 33ms/step
Epoch 29/50
1701/1701 - 55s - loss: 2.5164 - accuracy30: 0.6022 - val_loss: 2.8025 - val_accuracy30: 0.5770 - 55s/epoch - 32ms/step
Epoch 30/50
1701/1701 - 54s - loss: 2.5144 - accuracy30: 0.6033 - val_loss: 2.7887 - val_accuracy30: 0.5732 - 54s/epoch - 32ms/step
testing model: results/AAL/W5/deepVOL_L2/h30
Evaluating performance on  test set...
6357/6357 - 102s - 102s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9101457
{'0': {'precision': 0.5009585979915326, 'recall': 0.508610595602918, 'f1-score': 0.5047555977608957, 'support': 397127}, '1': {'precision': 0.6688283815712126, 'recall': 0.6397885585618129, 'f1-score': 0.6539862553317978, 'support': 830490}, '2': {'precision': 0.45289550570952986, 'recall': 0.4868928199583534, 'f1-score': 0.46927922788286536, 'support': 399552}, 'accuracy': 0.5702296442471556, 'macro avg': {'precision': 0.5408941617574251, 'recall': 0.5450973247076948, 'f1-score': 0.5426736936585196, 'support': 1627169}, 'weighted avg': {'precision': 0.5748356641829545, 'recall': 0.5702296442471556, 'f1-score': 0.5722101241613813, 'support': 1627169}}
[[201983 137760  57384]
 [121530 531338 177622]
 [ 79680 125333 194539]]
Evaluating performance on  train set...
1701/1701 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8734525
{'0': {'precision': 0.4976776206286546, 'recall': 0.551238863739467, 'f1-score': 0.5230907325651688, 'support': 103603}, '1': {'precision': 0.6989322136701099, 'recall': 0.6570703655081266, 'f1-score': 0.6773551203419332, 'support': 226233}, '2': {'precision': 0.48311755662980865, 'recall': 0.4940993729991855, 'f1-score': 0.48854675881702914, 'support': 105582}, 'accuracy': 0.5923710090074366, 'macro avg': {'precision': 0.5599091303095244, 'recall': 0.5674695340822598, 'f1-score': 0.562997537241377, 'support': 435418}, 'weighted avg': {'precision': 0.5987142099989182, 'recall': 0.5923710090074366, 'f1-score': 0.594866528245698, 'support': 435418}}
[[ 57110  33010  13483]
 [ 35251 148651  42331]
 [ 22392  31022  52168]]
Evaluating performance on  val set...
563/563 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89476144
{'0': {'precision': 0.5047434656340755, 'recall': 0.5232238087046276, 'f1-score': 0.5138175214336997, 'support': 34878}, '1': {'precision': 0.6788096749171426, 'recall': 0.6472700376546531, 'f1-score': 0.6626647850480156, 'support': 74360}, '2': {'precision': 0.4653909565123382, 'recall': 0.4945004451336837, 'f1-score': 0.47950431634642166, 'support': 34821}, 'accuracy': 0.5803108448621745, 'macro avg': {'precision': 0.5496480323545188, 'recall': 0.5549980971643215, 'f1-score': 0.5519955409427123, 'support': 144059}, 'weighted avg': {'precision': 0.585080477567803, 'recall': 0.5803108448621745, 'f1-score': 0.5823551512105025, 'support': 144059}}
[[18249 11987  4642]
 [11091 48131 15138]
 [ 6815 10787 17219]]
training model: results/AAL/W5/deepVOL_L2/h50
Epoch 1/50
1701/1701 - 57s - loss: 3.0843 - accuracy50: 0.4679 - val_loss: 3.0618 - val_accuracy50: 0.4897 - 57s/epoch - 33ms/step
Epoch 2/50
1701/1701 - 54s - loss: 2.9215 - accuracy50: 0.5150 - val_loss: 3.0493 - val_accuracy50: 0.4998 - 54s/epoch - 32ms/step
Epoch 3/50
1701/1701 - 54s - loss: 2.8705 - accuracy50: 0.5284 - val_loss: 3.0507 - val_accuracy50: 0.5046 - 54s/epoch - 32ms/step
Epoch 4/50
1701/1701 - 54s - loss: 2.8447 - accuracy50: 0.5352 - val_loss: 3.0384 - val_accuracy50: 0.4989 - 54s/epoch - 32ms/step
Epoch 5/50
1701/1701 - 54s - loss: 2.8305 - accuracy50: 0.5374 - val_loss: 3.0152 - val_accuracy50: 0.5039 - 54s/epoch - 32ms/step
Epoch 6/50
1701/1701 - 54s - loss: 2.8158 - accuracy50: 0.5418 - val_loss: 3.0108 - val_accuracy50: 0.5079 - 54s/epoch - 32ms/step
Epoch 7/50
1701/1701 - 54s - loss: 2.8059 - accuracy50: 0.5440 - val_loss: 2.9951 - val_accuracy50: 0.5106 - 54s/epoch - 32ms/step
Epoch 8/50
1701/1701 - 55s - loss: 2.7972 - accuracy50: 0.5452 - val_loss: 2.9941 - val_accuracy50: 0.5124 - 55s/epoch - 32ms/step
Epoch 9/50
1701/1701 - 55s - loss: 2.7885 - accuracy50: 0.5471 - val_loss: 3.0095 - val_accuracy50: 0.5180 - 55s/epoch - 32ms/step
Epoch 10/50
1701/1701 - 52s - loss: 2.7798 - accuracy50: 0.5486 - val_loss: 3.0031 - val_accuracy50: 0.5207 - 52s/epoch - 31ms/step
Epoch 11/50
1701/1701 - 55s - loss: 2.7723 - accuracy50: 0.5499 - val_loss: 2.9887 - val_accuracy50: 0.5202 - 55s/epoch - 32ms/step
Epoch 12/50
1701/1701 - 55s - loss: 2.7657 - accuracy50: 0.5509 - val_loss: 2.9731 - val_accuracy50: 0.5242 - 55s/epoch - 32ms/step
Epoch 13/50
1701/1701 - 53s - loss: 2.7579 - accuracy50: 0.5526 - val_loss: 2.9684 - val_accuracy50: 0.5214 - 53s/epoch - 31ms/step
Epoch 14/50
1701/1701 - 54s - loss: 2.7513 - accuracy50: 0.5532 - val_loss: 2.9677 - val_accuracy50: 0.5232 - 54s/epoch - 32ms/step
Epoch 15/50
1701/1701 - 54s - loss: 2.7448 - accuracy50: 0.5548 - val_loss: 2.9723 - val_accuracy50: 0.5208 - 54s/epoch - 32ms/step
Epoch 16/50
1701/1701 - 55s - loss: 2.7394 - accuracy50: 0.5561 - val_loss: 2.9665 - val_accuracy50: 0.5211 - 55s/epoch - 32ms/step
Epoch 17/50
1701/1701 - 55s - loss: 2.7347 - accuracy50: 0.5571 - val_loss: 2.9691 - val_accuracy50: 0.5211 - 55s/epoch - 33ms/step
Epoch 18/50
1701/1701 - 54s - loss: 2.7288 - accuracy50: 0.5572 - val_loss: 2.9734 - val_accuracy50: 0.5267 - 54s/epoch - 32ms/step
Epoch 19/50
1701/1701 - 53s - loss: 2.7227 - accuracy50: 0.5593 - val_loss: 2.9690 - val_accuracy50: 0.5231 - 53s/epoch - 31ms/step
Epoch 20/50
1701/1701 - 53s - loss: 2.7192 - accuracy50: 0.5599 - val_loss: 2.9618 - val_accuracy50: 0.5251 - 53s/epoch - 31ms/step
Epoch 21/50
1701/1701 - 55s - loss: 2.7149 - accuracy50: 0.5606 - val_loss: 2.9586 - val_accuracy50: 0.5267 - 55s/epoch - 32ms/step
Epoch 22/50
1701/1701 - 54s - loss: 2.7096 - accuracy50: 0.5616 - val_loss: 2.9551 - val_accuracy50: 0.5252 - 54s/epoch - 32ms/step
Epoch 23/50
1701/1701 - 54s - loss: 2.7065 - accuracy50: 0.5616 - val_loss: 2.9757 - val_accuracy50: 0.5236 - 54s/epoch - 32ms/step
Epoch 24/50
1701/1701 - 55s - loss: 2.7006 - accuracy50: 0.5627 - val_loss: 2.9742 - val_accuracy50: 0.5236 - 55s/epoch - 32ms/step
Epoch 25/50
1701/1701 - 54s - loss: 2.6971 - accuracy50: 0.5648 - val_loss: 2.9701 - val_accuracy50: 0.5223 - 54s/epoch - 32ms/step
Epoch 26/50
1701/1701 - 54s - loss: 2.6933 - accuracy50: 0.5644 - val_loss: 2.9835 - val_accuracy50: 0.5238 - 54s/epoch - 32ms/step
Epoch 27/50
1701/1701 - 53s - loss: 2.6891 - accuracy50: 0.5653 - val_loss: 2.9858 - val_accuracy50: 0.5248 - 53s/epoch - 31ms/step
Epoch 28/50
1701/1701 - 54s - loss: 2.6850 - accuracy50: 0.5669 - val_loss: 2.9925 - val_accuracy50: 0.5224 - 54s/epoch - 32ms/step
Epoch 29/50
1701/1701 - 53s - loss: 2.6818 - accuracy50: 0.5672 - val_loss: 2.9953 - val_accuracy50: 0.5201 - 53s/epoch - 31ms/step
Epoch 30/50
1701/1701 - 54s - loss: 2.6771 - accuracy50: 0.5683 - val_loss: 3.0212 - val_accuracy50: 0.5241 - 54s/epoch - 32ms/step
Epoch 31/50
1701/1701 - 53s - loss: 2.6727 - accuracy50: 0.5689 - val_loss: 3.0073 - val_accuracy50: 0.5229 - 53s/epoch - 31ms/step
Epoch 32/50
1701/1701 - 53s - loss: 2.6694 - accuracy50: 0.5694 - val_loss: 3.0068 - val_accuracy50: 0.5211 - 53s/epoch - 31ms/step
testing model: results/AAL/W5/deepVOL_L2/h50
Evaluating performance on  test set...
6357/6357 - 104s - 104s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9818152
{'0': {'precision': 0.4876695036568543, 'recall': 0.46529449136320084, 'f1-score': 0.4762193217018347, 'support': 483223}, '1': {'precision': 0.5510446678899895, 'recall': 0.599929189140326, 'f1-score': 0.5744488091854796, 'support': 663740}, '2': {'precision': 0.47017666490039345, 'recall': 0.4342323919317959, 'f1-score': 0.45149025496345674, 'support': 480206}, 'accuracy': 0.5110464862592637, 'macro avg': {'precision': 0.5029636121490791, 'recall': 0.49981869081177427, 'f1-score': 0.500719461950257, 'support': 1627169}, 'weighted avg': {'precision': 0.5083584827243119, 'recall': 0.5110464862592637, 'f1-score': 0.5089902224504508, 'support': 1627169}}
[[224841 169093  89289]
 [119858 398197 145685]
 [116353 155332 208521]]
Evaluating performance on  train set...
1701/1701 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9373165
{'0': {'precision': 0.5015968903963754, 'recall': 0.4885223765432099, 'f1-score': 0.4949733090651455, 'support': 124416}, '1': {'precision': 0.5844346194032739, 'recall': 0.6546858489799235, 'f1-score': 0.6175688074566863, 'support': 184545}, '2': {'precision': 0.5030088265111564, 'recall': 0.42767106605407373, 'f1-score': 0.46229068187063516, 'support': 126457}, 'accuracy': 0.5412752803053618, 'macro avg': {'precision': 0.5296801121036019, 'recall': 0.5236264305257358, 'f1-score': 0.5249442661308222, 'support': 435418}, 'weighted avg': {'precision': 0.5371164093525163, 'recall': 0.5412752803053618, 'f1-score': 0.537441556274794, 'support': 435418}}
[[ 60780  43397  20239]
 [ 30530 120819  33196]
 [ 29863  42512  54082]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9645069
{'0': {'precision': 0.5000923507216549, 'recall': 0.45117596648257474, 'f1-score': 0.47437646263781647, 'support': 42008}, '1': {'precision': 0.5618989244487252, 'recall': 0.6375935616347619, 'f1-score': 0.5973578670555656, 'support': 60388}, '2': {'precision': 0.4811488694635598, 'recall': 0.4346542495739625, 'f1-score': 0.45672131147540984, 'support': 41663}, 'accuracy': 0.5245420279191165, 'macro avg': {'precision': 0.5143800482113133, 'recall': 0.5078079258970997, 'f1-score': 0.5094852137229307, 'support': 144059}, 'weighted avg': {'precision': 0.5205224044813944, 'recall': 0.5245420279191165, 'f1-score': 0.5208229497514275, 'support': 144059}}
[[18953 15763  7292]
 [ 9649 38503 12236]
 [ 9297 14257 18109]]
training model: results/AAL/W5/deepVOL_L2/h100
Epoch 1/50
1701/1701 - 58s - loss: 3.2241 - accuracy100: 0.4100 - val_loss: 3.2773 - val_accuracy100: 0.3817 - 58s/epoch - 34ms/step
Epoch 2/50
1701/1701 - 53s - loss: 3.1179 - accuracy100: 0.4529 - val_loss: 3.2473 - val_accuracy100: 0.4216 - 53s/epoch - 31ms/step
Epoch 3/50
1701/1701 - 55s - loss: 3.0730 - accuracy100: 0.4636 - val_loss: 3.2230 - val_accuracy100: 0.4165 - 55s/epoch - 32ms/step
Epoch 4/50
1701/1701 - 55s - loss: 3.0500 - accuracy100: 0.4699 - val_loss: 3.2160 - val_accuracy100: 0.4211 - 55s/epoch - 32ms/step
Epoch 5/50
1701/1701 - 56s - loss: 3.0350 - accuracy100: 0.4739 - val_loss: 3.1954 - val_accuracy100: 0.4267 - 56s/epoch - 33ms/step
Epoch 6/50
1701/1701 - 57s - loss: 3.0264 - accuracy100: 0.4757 - val_loss: 3.2136 - val_accuracy100: 0.4256 - 57s/epoch - 33ms/step
Epoch 7/50
1701/1701 - 54s - loss: 3.0185 - accuracy100: 0.4773 - val_loss: 3.2093 - val_accuracy100: 0.4279 - 54s/epoch - 32ms/step
Epoch 8/50
1701/1701 - 53s - loss: 3.0121 - accuracy100: 0.4793 - val_loss: 3.2365 - val_accuracy100: 0.4257 - 53s/epoch - 31ms/step
Epoch 9/50
1701/1701 - 53s - loss: 3.0054 - accuracy100: 0.4821 - val_loss: 3.2199 - val_accuracy100: 0.4289 - 53s/epoch - 31ms/step
Epoch 10/50
1701/1701 - 54s - loss: 3.0010 - accuracy100: 0.4825 - val_loss: 3.2154 - val_accuracy100: 0.4307 - 54s/epoch - 32ms/step
Epoch 11/50
1701/1701 - 54s - loss: 2.9961 - accuracy100: 0.4845 - val_loss: 3.2291 - val_accuracy100: 0.4269 - 54s/epoch - 32ms/step
Epoch 12/50
1701/1701 - 53s - loss: 2.9913 - accuracy100: 0.4858 - val_loss: 3.2406 - val_accuracy100: 0.4276 - 53s/epoch - 31ms/step
Epoch 13/50
1701/1701 - 53s - loss: 2.9875 - accuracy100: 0.4870 - val_loss: 3.2458 - val_accuracy100: 0.4276 - 53s/epoch - 31ms/step
Epoch 14/50
1701/1701 - 53s - loss: 2.9826 - accuracy100: 0.4894 - val_loss: 3.2510 - val_accuracy100: 0.4273 - 53s/epoch - 31ms/step
Epoch 15/50
1701/1701 - 52s - loss: 2.9785 - accuracy100: 0.4903 - val_loss: 3.2602 - val_accuracy100: 0.4270 - 52s/epoch - 30ms/step
testing model: results/AAL/W5/deepVOL_L2/h100
Evaluating performance on  test set...
6357/6357 - 104s - 104s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0791253
{'0': {'precision': 0.5043243840835452, 'recall': 0.21002583576668832, 'f1-score': 0.29655243974551787, 'support': 564721}, '1': {'precision': 0.3734535921086677, 'recall': 0.6254947125126646, 'f1-score': 0.4676783496246692, 'support': 505344}, '2': {'precision': 0.44105690311843604, 'recall': 0.4319444843332663, 'f1-score': 0.4364531358540597, 'support': 557104}, 'accuracy': 0.41503617632833467, 'macro avg': {'precision': 0.439611626436883, 'recall': 0.42248834420420645, 'f1-score': 0.4002279750747489, 'support': 1627169}, 'weighted avg': {'precision': 0.44201903275535576, 'recall': 0.41503617632833467, 'f1-score': 0.39759706953309554, 'support': 1627169}}
[[118606 289481 156634]
 [ 40932 316090 148322]
 [ 75640 240826 240638]]
Evaluating performance on  train set...
1701/1701 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0463094
{'0': {'precision': 0.5120065001958765, 'recall': 0.24233933550345435, 'f1-score': 0.3289719626168225, 'support': 145614}, '1': {'precision': 0.41560775842296, 'recall': 0.6874883589379213, 'f1-score': 0.5180427912005655, 'support': 144961}, '2': {'precision': 0.4565056114154026, 'recall': 0.3993427366182694, 'f1-score': 0.4260151943111556, 'support': 144843}, 'accuracy': 0.442767639371822, 'macro avg': {'precision': 0.461373290011413, 'recall': 0.44305681035321504, 'f1-score': 0.42434331604284786, 'support': 435418}, 'weighted avg': {'precision': 0.46145054421846177, 'recall': 0.442767639371822, 'f1-score': 0.42419983374440623, 'support': 435418}}
[[35288 75546 34780]
 [11218 99659 34084]
 [22415 64586 57842]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0659244
{'0': {'precision': 0.5103611891159098, 'recall': 0.21553151900545933, 'f1-score': 0.3030721237475022, 'support': 48907}, '1': {'precision': 0.39546792984252976, 'recall': 0.6542966681493719, 'f1-score': 0.49297404265845307, 'support': 47211}, '2': {'precision': 0.4377083563307208, 'recall': 0.41354998852756514, 'f1-score': 0.4252863700716461, 'support': 47941}, 'accuracy': 0.42522161059010544, 'macro avg': {'precision': 0.4478458250963868, 'recall': 0.4277927252274654, 'f1-score': 0.4071108454925338, 'support': 144059}, 'weighted avg': {'precision': 0.4485304453226703, 'recall': 0.42522161059010544, 'f1-score': 0.4059781044688086, 'support': 144059}}
[[10541 25770 12596]
 [ 3448 30890 12873]
 [ 6665 21450 19826]]
training model: results/AAL/W5/deepVOL_L2/h200
Epoch 1/50
1701/1701 - 57s - loss: 3.2779 - accuracy200: 0.3831 - val_loss: 3.3124 - val_accuracy200: 0.3319 - 57s/epoch - 34ms/step
Epoch 2/50
1701/1701 - 54s - loss: 3.2456 - accuracy200: 0.3977 - val_loss: 3.3266 - val_accuracy200: 0.3419 - 54s/epoch - 32ms/step
Epoch 3/50
1701/1701 - 54s - loss: 3.2323 - accuracy200: 0.4072 - val_loss: 3.3183 - val_accuracy200: 0.3503 - 54s/epoch - 32ms/step
Epoch 4/50
1701/1701 - 54s - loss: 3.2259 - accuracy200: 0.4102 - val_loss: 3.3251 - val_accuracy200: 0.3502 - 54s/epoch - 32ms/step
Epoch 5/50
1701/1701 - 55s - loss: 3.2204 - accuracy200: 0.4134 - val_loss: 3.3280 - val_accuracy200: 0.3526 - 55s/epoch - 32ms/step
Epoch 6/50
1701/1701 - 55s - loss: 3.2170 - accuracy200: 0.4148 - val_loss: 3.3333 - val_accuracy200: 0.3501 - 55s/epoch - 32ms/step
Epoch 7/50
1701/1701 - 55s - loss: 3.2125 - accuracy200: 0.4167 - val_loss: 3.3442 - val_accuracy200: 0.3472 - 55s/epoch - 32ms/step
Epoch 8/50
1701/1701 - 54s - loss: 3.2089 - accuracy200: 0.4179 - val_loss: 3.3443 - val_accuracy200: 0.3558 - 54s/epoch - 32ms/step
Epoch 9/50
1701/1701 - 55s - loss: 3.2056 - accuracy200: 0.4198 - val_loss: 3.3325 - val_accuracy200: 0.3582 - 55s/epoch - 32ms/step
Epoch 10/50
1701/1701 - 54s - loss: 3.2025 - accuracy200: 0.4208 - val_loss: 3.3466 - val_accuracy200: 0.3571 - 54s/epoch - 31ms/step
Epoch 11/50
1701/1701 - 54s - loss: 3.1966 - accuracy200: 0.4238 - val_loss: 3.3641 - val_accuracy200: 0.3564 - 54s/epoch - 32ms/step
testing model: results/AAL/W5/deepVOL_L2/h200
Evaluating performance on  test set...
6357/6357 - 103s - 103s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1111904
{'0': {'precision': 0.4070029410132623, 'recall': 0.06040157917361851, 'f1-score': 0.10519205229628058, 'support': 607153}, '1': {'precision': 0.2593299731767722, 'recall': 0.7816929457809918, 'f1-score': 0.38945619154054606, 'support': 419281}, '2': {'precision': 0.41012099519093526, 'recall': 0.1865364927963245, 'f1-score': 0.25643701321213913, 'support': 600735}, 'accuracy': 0.2928282188266861, 'macro avg': {'precision': 0.3588179697936566, 'recall': 0.3428770059169783, 'f1-score': 0.25036175234965524, 'support': 1627169}, 'weighted avg': {'precision': 0.37010244367646017, 'recall': 0.2928282188266861, 'f1-score': 0.23427802564155892, 'support': 1627169}}
[[ 36673 477980  92500]
 [ 22857 327749  68675]
 [ 30575 458101 112059]]
Evaluating performance on  train set...
1701/1701 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0985734
{'0': {'precision': 0.3773468442981328, 'recall': 0.050496985049147826, 'f1-score': 0.08907398750584335, 'support': 145276}, '1': {'precision': 0.3388146415140695, 'recall': 0.8283721152467868, 'f1-score': 0.48092492421090177, 'support': 146503}, '2': {'precision': 0.3757916594566534, 'recall': 0.15119152876307967, 'f1-score': 0.21562932844823732, 'support': 143639}, 'accuracy': 0.3454427699360155, 'macro avg': {'precision': 0.3639843817562853, 'recall': 0.3433535430196714, 'f1-score': 0.26187608005499413, 'support': 435418}, 'weighted avg': {'precision': 0.3638690631776488, 'recall': 0.3454427699360155, 'f1-score': 0.2626672252629542, 'support': 435418}}
[[  7336 120464  17476]
 [  6547 121359  18597]
 [  5558 116364  21717]]
Evaluating performance on  val set...
563/563 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1031396
{'0': {'precision': 0.38604525862068967, 'recall': 0.05739231431603821, 'f1-score': 0.0999285228639668, 'support': 49937}, '1': {'precision': 0.3207008039147151, 'recall': 0.8050760085111983, 'f1-score': 0.45868509688989983, 'support': 45587}, '2': {'precision': 0.3753548096418112, 'recall': 0.17164932522921603, 'f1-score': 0.23557189311466134, 'support': 48535}, 'accuracy': 0.332488771961488, 'macro avg': {'precision': 0.3607002907257386, 'recall': 0.34470588268548413, 'f1-score': 0.26472850428950934, 'support': 144059}, 'weighted avg': {'precision': 0.3617654940945502, 'recall': 0.332488771961488, 'f1-score': 0.25915555425553327, 'support': 144059}}
[[ 2866 39730  7341]
 [ 2363 36701  6523]
 [ 2195 38009  8331]]
training model: results/AAL/W5/deepVOL_L2/h300
Epoch 1/50
1701/1701 - 57s - loss: 3.3010 - accuracy300: 0.3661 - val_loss: 3.3121 - val_accuracy300: 0.3396 - 57s/epoch - 33ms/step
Epoch 2/50
1701/1701 - 53s - loss: 3.2824 - accuracy300: 0.3698 - val_loss: 3.3103 - val_accuracy300: 0.3438 - 53s/epoch - 31ms/step
Epoch 3/50
1701/1701 - 54s - loss: 3.2683 - accuracy300: 0.3827 - val_loss: 3.3011 - val_accuracy300: 0.3504 - 54s/epoch - 32ms/step
Epoch 4/50
1701/1701 - 52s - loss: 3.2586 - accuracy300: 0.3892 - val_loss: 3.3132 - val_accuracy300: 0.3537 - 52s/epoch - 31ms/step
Epoch 5/50
1701/1701 - 52s - loss: 3.2531 - accuracy300: 0.3929 - val_loss: 3.3130 - val_accuracy300: 0.3560 - 52s/epoch - 31ms/step
Epoch 6/50
1701/1701 - 52s - loss: 3.2468 - accuracy300: 0.3975 - val_loss: 3.3266 - val_accuracy300: 0.3571 - 52s/epoch - 31ms/step
Epoch 7/50
1701/1701 - 53s - loss: 3.2407 - accuracy300: 0.4011 - val_loss: 3.3360 - val_accuracy300: 0.3574 - 53s/epoch - 31ms/step
Epoch 8/50
1701/1701 - 53s - loss: 3.2364 - accuracy300: 0.4050 - val_loss: 3.3461 - val_accuracy300: 0.3571 - 53s/epoch - 31ms/step
Epoch 9/50
1701/1701 - 53s - loss: 3.2316 - accuracy300: 0.4070 - val_loss: 3.3430 - val_accuracy300: 0.3573 - 53s/epoch - 31ms/step
Epoch 10/50
1701/1701 - 52s - loss: 3.2262 - accuracy300: 0.4103 - val_loss: 3.3490 - val_accuracy300: 0.3606 - 52s/epoch - 31ms/step
Epoch 11/50
1701/1701 - 54s - loss: 3.2222 - accuracy300: 0.4116 - val_loss: 3.3132 - val_accuracy300: 0.3641 - 54s/epoch - 32ms/step
Epoch 12/50
1701/1701 - 54s - loss: 3.2195 - accuracy300: 0.4127 - val_loss: 3.3768 - val_accuracy300: 0.3603 - 54s/epoch - 32ms/step
Epoch 13/50
1701/1701 - 54s - loss: 3.2145 - accuracy300: 0.4166 - val_loss: 3.3715 - val_accuracy300: 0.3609 - 54s/epoch - 32ms/step
testing model: results/AAL/W5/deepVOL_L2/h300
Evaluating performance on  test set...
6357/6357 - 101s - 101s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1025915
{'0': {'precision': 0.38279103398409253, 'recall': 0.009316551573641937, 'f1-score': 0.01819037703628111, 'support': 568236}, '1': {'precision': 0.3209119770555127, 'recall': 0.46882909284667645, 'f1-score': 0.38101822691126686, 'support': 495462}, '2': {'precision': 0.36880737039139744, 'recall': 0.5822056503351548, 'f1-score': 0.4515642378125998, 'support': 563471}, 'accuracy': 0.34762031479213285, 'macro avg': {'precision': 0.3575034604770009, 'recall': 0.3534504315851577, 'f1-score': 0.2835909472533826, 'support': 1627169}, 'weighted avg': {'precision': 0.35910688672453467, 'recall': 0.34762031479213285, 'f1-score': 0.2787416872322431, 'support': 1627169}}
[[  5294 260521 302421]
 [  4147 232287 259028]
 [  4389 231026 328056]]
Evaluating performance on  train set...
1701/1701 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001345
{'0': {'precision': 0.37576821773485514, 'recall': 0.00870172204639563, 'f1-score': 0.017009551313471195, 'support': 147557}, '1': {'precision': 0.3383932148195371, 'recall': 0.5530415560827602, 'f1-score': 0.4198748269651151, 'support': 142049}, '2': {'precision': 0.36823986229534444, 'recall': 0.504704688228678, 'f1-score': 0.4258057050280622, 'support': 145812}, 'accuracy': 0.35238552379552524, 'macro avg': {'precision': 0.3608004316165789, 'recall': 0.3554826554526113, 'f1-score': 0.28756336110221614, 'support': 435418}, 'weighted avg': {'precision': 0.3610540663849708, 'recall': 0.35238552379552524, 'f1-score': 0.2853356065212768, 'support': 435418}}
[[ 1284 82402 63871]
 [ 1105 78559 62385]
 [ 1028 71192 73592]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011068
{'0': {'precision': 0.3514765489287782, 'recall': 0.01241435729624706, 'f1-score': 0.02398166804946466, 'support': 48895}, '1': {'precision': 0.34442748091603054, 'recall': 0.5234338747099768, 'f1-score': 0.4154696132596685, 'support': 47410}, '2': {'precision': 0.35465695341623743, 'recall': 0.5219667462411526, 'f1-score': 0.4223457250330408, 'support': 47754}, 'accuracy': 0.34950263433732015, 'macro avg': {'precision': 0.3501869944203487, 'recall': 0.3526049927491255, 'f1-score': 0.2872656687807247, 'support': 144059}, 'weighted avg': {'precision': 0.35021096136680546, 'recall': 0.34950263433732015, 'f1-score': 0.2848742235969102, 'support': 144059}}
[[  607 24897 23391]
 [  629 24816 21965]
 [  491 22337 24926]]
training model: results/AAL/W5/deepVOL_L2/h500
Epoch 1/50
1701/1701 - 57s - loss: 3.2530 - accuracy500: 0.4025 - val_loss: 3.5801 - val_accuracy500: 0.2762 - 57s/epoch - 33ms/step
Epoch 2/50
1701/1701 - 53s - loss: 3.2748 - accuracy500: 0.3789 - val_loss: 3.5222 - val_accuracy500: 0.2763 - 53s/epoch - 31ms/step
Epoch 3/50
1701/1701 - 53s - loss: 3.2667 - accuracy500: 0.3842 - val_loss: 3.4904 - val_accuracy500: 0.2762 - 53s/epoch - 31ms/step
Epoch 4/50
1701/1701 - 53s - loss: 3.2680 - accuracy500: 0.3818 - val_loss: 3.4900 - val_accuracy500: 0.2772 - 53s/epoch - 31ms/step
Epoch 5/50
1701/1701 - 52s - loss: 3.2524 - accuracy500: 0.3927 - val_loss: 3.4443 - val_accuracy500: 0.2830 - 52s/epoch - 31ms/step
Epoch 6/50
1701/1701 - 52s - loss: 3.2456 - accuracy500: 0.3952 - val_loss: 3.4740 - val_accuracy500: 0.2805 - 52s/epoch - 31ms/step
Epoch 7/50
1701/1701 - 53s - loss: 3.2409 - accuracy500: 0.3997 - val_loss: 3.4241 - val_accuracy500: 0.2771 - 53s/epoch - 31ms/step
Epoch 8/50
1701/1701 - 53s - loss: 3.2345 - accuracy500: 0.4005 - val_loss: 3.4392 - val_accuracy500: 0.2789 - 53s/epoch - 31ms/step
Epoch 9/50
1701/1701 - 53s - loss: 3.2290 - accuracy500: 0.4033 - val_loss: 3.5744 - val_accuracy500: 0.2784 - 53s/epoch - 31ms/step
Epoch 10/50
1701/1701 - 53s - loss: 3.2221 - accuracy500: 0.4087 - val_loss: 3.5933 - val_accuracy500: 0.2785 - 53s/epoch - 31ms/step
Epoch 11/50
1701/1701 - 52s - loss: 3.2190 - accuracy500: 0.4100 - val_loss: 3.6620 - val_accuracy500: 0.2807 - 52s/epoch - 31ms/step
Epoch 12/50
1701/1701 - 54s - loss: 3.2110 - accuracy500: 0.4145 - val_loss: 3.5678 - val_accuracy500: 0.2890 - 54s/epoch - 32ms/step
Epoch 13/50
1701/1701 - 53s - loss: 3.2066 - accuracy500: 0.4182 - val_loss: 3.4884 - val_accuracy500: 0.3014 - 53s/epoch - 31ms/step
Epoch 14/50
1701/1701 - 54s - loss: 3.2022 - accuracy500: 0.4206 - val_loss: 3.5127 - val_accuracy500: 0.2918 - 54s/epoch - 32ms/step
Epoch 15/50
1701/1701 - 55s - loss: 3.1953 - accuracy500: 0.4241 - val_loss: 3.5076 - val_accuracy500: 0.2985 - 55s/epoch - 32ms/step
Epoch 16/50
1701/1701 - 55s - loss: 3.1854 - accuracy500: 0.4288 - val_loss: 3.5295 - val_accuracy500: 0.2985 - 55s/epoch - 32ms/step
Epoch 17/50
1701/1701 - 57s - loss: 3.1777 - accuracy500: 0.4319 - val_loss: 3.5559 - val_accuracy500: 0.3004 - 57s/epoch - 34ms/step
testing model: results/AAL/W5/deepVOL_L2/h500
Evaluating performance on  test set...
6357/6357 - 110s - 110s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1467471
{'0': {'precision': 0.16666666666666666, 'recall': 1.6454540219009931e-06, 'f1-score': 3.290875553895492e-06, 'support': 607735}, '1': {'precision': 0.2551713725832329, 'recall': 0.9930600873147932, 'f1-score': 0.40601525226490026, 'support': 415279}, '2': {'precision': 0.39996365618753404, 'recall': 0.007286209664738354, 'f1-score': 0.014311700514174339, 'support': 604155}, 'accuracy': 0.25615040601191397, 'macro avg': {'precision': 0.27393389847914457, 'recall': 0.33344931414451784, 'f1-score': 0.1401100812182095, 'support': 1627169}, 'weighted avg': {'precision': 0.27587578291230885, 'recall': 0.25615040601191397, 'f1-score': 0.10893649851349875, 'support': 1627169}}
[[     1 604009   3725]
 [     3 412397   2879]
 [     2 599751   4402]]
Evaluating performance on  train set...
1701/1701 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1129929
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 145410}, '1': {'precision': 0.3371453507702538, 'recall': 0.9955139524260791, 'f1-score': 0.5037039847804602, 'support': 146677}, '2': {'precision': 0.38245462402765773, 'recall': 0.0061745191200786986, 'f1-score': 0.012152837378557449, 'support': 143331}, 'accuracy': 0.33738614388932014, 'macro avg': {'precision': 0.23986665826597053, 'recall': 0.3338961571820526, 'f1-score': 0.17195227405300587, 'support': 435418}, 'weighted avg': {'precision': 0.23946890650234195, 'recall': 0.33738614388932014, 'f1-score': 0.173680618876458, 'support': 435418}}
[[     0 144639    771]
 [     0 146019    658]
 [     0 142446    885]]
Evaluating performance on  val set...
563/563 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1400721
{'0': {'precision': 1.0, 'recall': 1.892362425251684e-05, 'f1-score': 3.784653231147696e-05, 'support': 52844}, '1': {'precision': 0.27638412234656007, 'recall': 0.9939421360882789, 'f1-score': 0.43250278914094464, 'support': 39783}, '2': {'precision': 0.40950455005055614, 'recall': 0.007874475034997667, 'f1-score': 0.015451822742793919, 'support': 51432}, 'accuracy': 0.27730304944501905, 'macro avg': {'precision': 0.5619628907990387, 'recall': 0.3339451782491763, 'f1-score': 0.14933081947201668, 'support': 144059}, 'weighted avg': {'precision': 0.5893489997675494, 'recall': 0.27730304944501905, 'f1-score': 0.12496946785591351, 'support': 144059}}
[[    1 52500   343]
 [    0 39542   241]
 [    0 51027   405]]
training model: results/AAL/W5/deepVOL_L2/h1000
Epoch 1/50
1701/1701 - 57s - loss: 3.2659 - accuracy1000: 0.3933 - val_loss: 3.2974 - val_accuracy1000: 0.3362 - 57s/epoch - 33ms/step
Epoch 2/50
1701/1701 - 54s - loss: 3.2694 - accuracy1000: 0.3831 - val_loss: 3.3215 - val_accuracy1000: 0.3267 - 54s/epoch - 32ms/step
Epoch 3/50
1701/1701 - 54s - loss: 3.2737 - accuracy1000: 0.3762 - val_loss: 3.3049 - val_accuracy1000: 0.3452 - 54s/epoch - 32ms/step
Epoch 4/50
1701/1701 - 54s - loss: 3.2622 - accuracy1000: 0.3871 - val_loss: 3.3071 - val_accuracy1000: 0.3494 - 54s/epoch - 32ms/step
Epoch 5/50
1701/1701 - 55s - loss: 3.2526 - accuracy1000: 0.3939 - val_loss: 3.3352 - val_accuracy1000: 0.3537 - 55s/epoch - 32ms/step
Epoch 6/50
1701/1701 - 55s - loss: 3.2387 - accuracy1000: 0.4074 - val_loss: 3.3311 - val_accuracy1000: 0.3599 - 55s/epoch - 32ms/step
Epoch 7/50
1701/1701 - 56s - loss: 3.2411 - accuracy1000: 0.4047 - val_loss: 3.3417 - val_accuracy1000: 0.3513 - 56s/epoch - 33ms/step
Epoch 8/50
1701/1701 - 55s - loss: 3.2289 - accuracy1000: 0.4148 - val_loss: 3.3745 - val_accuracy1000: 0.3445 - 55s/epoch - 32ms/step
Epoch 9/50
1701/1701 - 54s - loss: 3.2193 - accuracy1000: 0.4172 - val_loss: 3.3731 - val_accuracy1000: 0.3508 - 54s/epoch - 32ms/step
Epoch 10/50
1701/1701 - 55s - loss: 3.2108 - accuracy1000: 0.4228 - val_loss: 3.3743 - val_accuracy1000: 0.3547 - 55s/epoch - 32ms/step
Epoch 11/50
1701/1701 - 55s - loss: 3.2062 - accuracy1000: 0.4252 - val_loss: 3.3656 - val_accuracy1000: 0.3561 - 55s/epoch - 33ms/step
testing model: results/AAL/W5/deepVOL_L2/h1000
Evaluating performance on  test set...
6357/6357 - 106s - 106s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1012113
{'0': {'precision': 0.4155668815607385, 'recall': 0.01865440413330202, 'f1-score': 0.03570599972159065, 'support': 660005}, '1': {'precision': 0.18721093064307762, 'recall': 0.24820388444717556, 'f1-score': 0.213435457803387, 'support': 305938}, '2': {'precision': 0.40620086750060824, 'recall': 0.7322201486329939, 'f1-score': 0.5225280548426576, 'support': 661226}, 'accuracy': 0.35178275888982646, 'macro avg': {'precision': 0.33632622656814143, 'recall': 0.3330261457378238, 'f1-score': 0.25722317078921175, 'support': 1627169}, 'weighted avg': {'precision': 0.3688256918473338, 'recall': 0.35178275888982646, 'f1-score': 0.26695032355403286, 'support': 1627169}}
[[ 12312 164546 483147]
 [  5383  75935 224620]
 [ 11932 165131 484163]]
Evaluating performance on  train set...
1701/1701 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1005864
{'0': {'precision': 0.3448140900195695, 'recall': 0.0178057735709233, 'f1-score': 0.03386290839205637, 'support': 148435}, '1': {'precision': 0.3312733809454404, 'recall': 0.23881673881673882, 'f1-score': 0.2775477972752398, 'support': 142758}, '2': {'precision': 0.33267043880334196, 'recall': 0.7492737042815046, 'f1-score': 0.46076539825140755, 'support': 144225}, 'accuracy': 0.33255400557625087, 'macro avg': {'precision': 0.33625263658945065, 'recall': 0.3352987388897222, 'f1-score': 0.2573920346395679, 'support': 435418}, 'weighted avg': {'precision': 0.33635219215897366, 'recall': 0.33255400557625087, 'f1-score': 0.2551628522785067, 'support': 435418}}
[[  2643  35152 110640]
 [  2531  34093 106134]
 [  2491  33670 108064]]
Evaluating performance on  val set...
563/563 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1014227
{'0': {'precision': 0.37268418785006463, 'recall': 0.016196378751849008, 'f1-score': 0.03104364053976457, 'support': 53407}, '1': {'precision': 0.28140632507136193, 'recall': 0.24842194556024053, 'f1-score': 0.26388741651648473, 'support': 40081}, '2': {'precision': 0.35108833623242913, 'recall': 0.7383678392754741, 'f1-score': 0.47589309610899405, 'support': 50571}, 'accuracy': 0.3343213544450538, 'macro avg': {'precision': 0.3350596163846185, 'recall': 0.33432872119585455, 'f1-score': 0.25694138438841446, 'support': 144059}, 'weighted avg': {'precision': 0.33970720043387664, 'recall': 0.3343213544450538, 'f1-score': 0.25198848398942353, 'support': 144059}}
[[  865 13017 39525]
 [  634  9957 29490]
 [  822 12409 37340]]
training model: results/AAL/W5/deepVOL_L3/h10
Epoch 1/50
1701/1701 - 81s - loss: 3.1424 - accuracy10: 0.4158 - val_loss: 3.0703 - val_accuracy10: 0.5133 - 81s/epoch - 47ms/step
Epoch 2/50
1701/1701 - 76s - loss: 2.9570 - accuracy10: 0.4469 - val_loss: 2.9154 - val_accuracy10: 0.4824 - 76s/epoch - 45ms/step
Epoch 3/50
1701/1701 - 76s - loss: 2.6947 - accuracy10: 0.5384 - val_loss: 2.7082 - val_accuracy10: 0.4993 - 76s/epoch - 45ms/step
Epoch 4/50
1701/1701 - 76s - loss: 2.5852 - accuracy10: 0.5710 - val_loss: 2.6354 - val_accuracy10: 0.6031 - 76s/epoch - 45ms/step
Epoch 5/50
1701/1701 - 75s - loss: 2.5276 - accuracy10: 0.5901 - val_loss: 2.6161 - val_accuracy10: 0.5864 - 75s/epoch - 44ms/step
Epoch 6/50
1701/1701 - 75s - loss: 2.4951 - accuracy10: 0.5968 - val_loss: 2.5766 - val_accuracy10: 0.5858 - 75s/epoch - 44ms/step
Epoch 7/50
1701/1701 - 76s - loss: 2.4636 - accuracy10: 0.6039 - val_loss: 2.5680 - val_accuracy10: 0.5946 - 76s/epoch - 45ms/step
Epoch 8/50
1701/1701 - 76s - loss: 2.4401 - accuracy10: 0.6121 - val_loss: 2.5554 - val_accuracy10: 0.5924 - 76s/epoch - 45ms/step
Epoch 9/50
1701/1701 - 76s - loss: 2.4251 - accuracy10: 0.6144 - val_loss: 2.5393 - val_accuracy10: 0.5913 - 76s/epoch - 45ms/step
Epoch 10/50
1701/1701 - 77s - loss: 2.4089 - accuracy10: 0.6165 - val_loss: 2.5452 - val_accuracy10: 0.5892 - 77s/epoch - 45ms/step
Epoch 11/50
1701/1701 - 79s - loss: 2.3951 - accuracy10: 0.6195 - val_loss: 2.5236 - val_accuracy10: 0.6200 - 79s/epoch - 46ms/step
Epoch 12/50
1701/1701 - 77s - loss: 2.3794 - accuracy10: 0.6219 - val_loss: 2.5079 - val_accuracy10: 0.6136 - 77s/epoch - 45ms/step
Epoch 13/50
1701/1701 - 76s - loss: 2.3657 - accuracy10: 0.6247 - val_loss: 2.4964 - val_accuracy10: 0.6044 - 76s/epoch - 44ms/step
Epoch 14/50
1701/1701 - 76s - loss: 2.3563 - accuracy10: 0.6253 - val_loss: 2.4760 - val_accuracy10: 0.5946 - 76s/epoch - 45ms/step
Epoch 15/50
1701/1701 - 74s - loss: 2.3475 - accuracy10: 0.6272 - val_loss: 2.4583 - val_accuracy10: 0.6184 - 74s/epoch - 44ms/step
Epoch 16/50
1701/1701 - 72s - loss: 2.3381 - accuracy10: 0.6269 - val_loss: 2.5064 - val_accuracy10: 0.6038 - 72s/epoch - 42ms/step
Epoch 17/50
1701/1701 - 72s - loss: 2.3302 - accuracy10: 0.6294 - val_loss: 2.4576 - val_accuracy10: 0.6029 - 72s/epoch - 42ms/step
Epoch 18/50
1701/1701 - 72s - loss: 2.3245 - accuracy10: 0.6300 - val_loss: 2.4675 - val_accuracy10: 0.6146 - 72s/epoch - 43ms/step
Epoch 19/50
1701/1701 - 72s - loss: 2.3185 - accuracy10: 0.6310 - val_loss: 2.4436 - val_accuracy10: 0.6100 - 72s/epoch - 42ms/step
Epoch 20/50
1701/1701 - 74s - loss: 2.3095 - accuracy10: 0.6320 - val_loss: 2.4430 - val_accuracy10: 0.6212 - 74s/epoch - 44ms/step
Epoch 21/50
1701/1701 - 74s - loss: 2.3043 - accuracy10: 0.6321 - val_loss: 2.4516 - val_accuracy10: 0.6024 - 74s/epoch - 44ms/step
Epoch 22/50
1701/1701 - 75s - loss: 2.2980 - accuracy10: 0.6327 - val_loss: 2.4522 - val_accuracy10: 0.6088 - 75s/epoch - 44ms/step
Epoch 23/50
1701/1701 - 74s - loss: 2.2949 - accuracy10: 0.6335 - val_loss: 2.4611 - val_accuracy10: 0.6184 - 74s/epoch - 44ms/step
Epoch 24/50
1701/1701 - 78s - loss: 2.2894 - accuracy10: 0.6341 - val_loss: 2.4254 - val_accuracy10: 0.6219 - 78s/epoch - 46ms/step
Epoch 25/50
1701/1701 - 79s - loss: 2.2862 - accuracy10: 0.6343 - val_loss: 2.4422 - val_accuracy10: 0.6153 - 79s/epoch - 46ms/step
Epoch 26/50
1701/1701 - 78s - loss: 2.2816 - accuracy10: 0.6348 - val_loss: 2.4445 - val_accuracy10: 0.6167 - 78s/epoch - 46ms/step
Epoch 27/50
1701/1701 - 77s - loss: 2.2744 - accuracy10: 0.6364 - val_loss: 2.4151 - val_accuracy10: 0.6197 - 77s/epoch - 45ms/step
Epoch 28/50
1701/1701 - 78s - loss: 2.2710 - accuracy10: 0.6362 - val_loss: 2.4208 - val_accuracy10: 0.6279 - 78s/epoch - 46ms/step
Epoch 29/50
1701/1701 - 77s - loss: 2.2658 - accuracy10: 0.6373 - val_loss: 2.4484 - val_accuracy10: 0.6207 - 77s/epoch - 45ms/step
Epoch 30/50
1701/1701 - 74s - loss: 2.2631 - accuracy10: 0.6372 - val_loss: 2.4413 - val_accuracy10: 0.6349 - 74s/epoch - 44ms/step
Epoch 31/50
1701/1701 - 73s - loss: 2.2585 - accuracy10: 0.6377 - val_loss: 2.4766 - val_accuracy10: 0.6201 - 73s/epoch - 43ms/step
Epoch 32/50
1701/1701 - 72s - loss: 2.2555 - accuracy10: 0.6390 - val_loss: 2.4535 - val_accuracy10: 0.6047 - 72s/epoch - 43ms/step
Epoch 33/50
1701/1701 - 73s - loss: 2.2483 - accuracy10: 0.6392 - val_loss: 2.4371 - val_accuracy10: 0.6306 - 73s/epoch - 43ms/step
Epoch 34/50
1701/1701 - 72s - loss: 2.2469 - accuracy10: 0.6388 - val_loss: 2.4604 - val_accuracy10: 0.6254 - 72s/epoch - 43ms/step
Epoch 35/50
1701/1701 - 73s - loss: 2.2428 - accuracy10: 0.6398 - val_loss: 2.4350 - val_accuracy10: 0.6201 - 73s/epoch - 43ms/step
Epoch 36/50
1701/1701 - 75s - loss: 2.2397 - accuracy10: 0.6408 - val_loss: 2.4468 - val_accuracy10: 0.6244 - 75s/epoch - 44ms/step
Epoch 37/50
1701/1701 - 73s - loss: 2.2359 - accuracy10: 0.6406 - val_loss: 2.4488 - val_accuracy10: 0.6316 - 73s/epoch - 43ms/step
testing model: results/AAL/W5/deepVOL_L3/h10
Evaluating performance on  test set...
6357/6357 - 137s - 137s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8209312
{'0': {'precision': 0.4246818978680088, 'recall': 0.582741963644829, 'f1-score': 0.49131249028860235, 'support': 257735}, '1': {'precision': 0.8663373325751914, 'recall': 0.60452225563271, 'f1-score': 0.7121280680031217, 'support': 1106439}, '2': {'precision': 0.3582180334472705, 'recall': 0.6830053803304246, 'f1-score': 0.4699564780015724, 'support': 262995}, 'accuracy': 0.6137573909040794, 'macro avg': {'precision': 0.5497457546301568, 'recall': 0.6234231998693213, 'f1-score': 0.5577990120977655, 'support': 1627169}, 'weighted avg': {'precision': 0.7142554661320604, 'recall': 0.6137573909040794, 'f1-score': 0.6380104931017383, 'support': 1627169}}
[[150193  56835  50707]
 [166460 668867 271112]
 [ 37007  46361 179627]]
Evaluating performance on  train set...
1701/1701 - 41s - 41s/epoch - 24ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79952943
{'0': {'precision': 0.4167515408603618, 'recall': 0.5879364232917093, 'f1-score': 0.48776021825152993, 'support': 67509}, '1': {'precision': 0.8806128770909785, 'recall': 0.6208763146399651, 'f1-score': 0.7282792054233014, 'support': 297610}, '2': {'precision': 0.378990249253926, 'recall': 0.7027269235693253, 'f1-score': 0.4924145767712611, 'support': 70299}, 'accuracy': 0.628984102632413, 'macro avg': {'precision': 0.558784889068422, 'recall': 0.6371798871669999, 'f1-score': 0.5694846668153641, 'support': 435418}, 'weighted avg': {'precision': 0.7277060517830912, 'recall': 0.628984102632413, 'f1-score': 0.6529073929704655, 'support': 435418}}
[[ 39691  13571  14247]
 [ 46130 184779  66701]
 [  9418  11480  49401]]
Evaluating performance on  val set...
563/563 - 13s - 13s/epoch - 24ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81056
{'0': {'precision': 0.41302495819266083, 'recall': 0.5873642645607108, 'f1-score': 0.48500342725874884, 'support': 22286}, '1': {'precision': 0.8706636825342171, 'recall': 0.612171404361773, 'f1-score': 0.7188869672344761, 'support': 99134}, '2': {'precision': 0.3642180761297581, 'recall': 0.6863819073280621, 'f1-score': 0.4759046291900832, 'support': 22639}, 'accuracy': 0.6199959738718164, 'macro avg': {'precision': 0.5493022389522121, 'recall': 0.6286391920835153, 'f1-score': 0.5599316745611027, 'support': 144059}, 'weighted avg': {'precision': 0.7202783633659147, 'recall': 0.6199959738718164, 'f1-score': 0.6445201749973645, 'support': 144059}}
[[13090  4950  4246]
 [15568 60687 22879]
 [ 3035  4065 15539]]
training model: results/AAL/W5/deepVOL_L3/h20
Epoch 1/50
1701/1701 - 80s - loss: 3.1343 - accuracy20: 0.3983 - val_loss: 3.1370 - val_accuracy20: 0.4056 - 80s/epoch - 47ms/step
Epoch 2/50
1701/1701 - 75s - loss: 2.9817 - accuracy20: 0.3932 - val_loss: 3.0042 - val_accuracy20: 0.3964 - 75s/epoch - 44ms/step
Epoch 3/50
1701/1701 - 76s - loss: 2.7869 - accuracy20: 0.5146 - val_loss: 2.8237 - val_accuracy20: 0.5364 - 76s/epoch - 45ms/step
Epoch 4/50
1701/1701 - 77s - loss: 2.6663 - accuracy20: 0.5679 - val_loss: 2.7877 - val_accuracy20: 0.5354 - 77s/epoch - 45ms/step
Epoch 5/50
1701/1701 - 73s - loss: 2.6101 - accuracy20: 0.5855 - val_loss: 2.7605 - val_accuracy20: 0.5886 - 73s/epoch - 43ms/step
Epoch 6/50
1701/1701 - 72s - loss: 2.5820 - accuracy20: 0.5916 - val_loss: 2.7431 - val_accuracy20: 0.5826 - 72s/epoch - 42ms/step
Epoch 7/50
1701/1701 - 76s - loss: 2.5599 - accuracy20: 0.5974 - val_loss: 2.7570 - val_accuracy20: 0.5911 - 76s/epoch - 45ms/step
Epoch 8/50
1701/1701 - 79s - loss: 2.5463 - accuracy20: 0.5992 - val_loss: 2.7505 - val_accuracy20: 0.5945 - 79s/epoch - 47ms/step
Epoch 9/50
1701/1701 - 73s - loss: 2.5375 - accuracy20: 0.6002 - val_loss: 2.7033 - val_accuracy20: 0.5826 - 73s/epoch - 43ms/step
Epoch 10/50
1701/1701 - 73s - loss: 2.5160 - accuracy20: 0.6054 - val_loss: 2.7211 - val_accuracy20: 0.6005 - 73s/epoch - 43ms/step
Epoch 11/50
1701/1701 - 74s - loss: 2.5052 - accuracy20: 0.6064 - val_loss: 2.7024 - val_accuracy20: 0.6074 - 74s/epoch - 43ms/step
Epoch 12/50
1701/1701 - 73s - loss: 2.4933 - accuracy20: 0.6089 - val_loss: 2.6765 - val_accuracy20: 0.6064 - 73s/epoch - 43ms/step
Epoch 13/50
1701/1701 - 78s - loss: 2.4826 - accuracy20: 0.6101 - val_loss: 2.7164 - val_accuracy20: 0.5984 - 78s/epoch - 46ms/step
Epoch 14/50
1701/1701 - 75s - loss: 2.4706 - accuracy20: 0.6116 - val_loss: 2.7013 - val_accuracy20: 0.6098 - 75s/epoch - 44ms/step
Epoch 15/50
1701/1701 - 74s - loss: 2.4618 - accuracy20: 0.6123 - val_loss: 2.6820 - val_accuracy20: 0.5996 - 74s/epoch - 44ms/step
Epoch 16/50
1701/1701 - 73s - loss: 2.4525 - accuracy20: 0.6138 - val_loss: 2.6409 - val_accuracy20: 0.6076 - 73s/epoch - 43ms/step
Epoch 17/50
1701/1701 - 73s - loss: 2.4440 - accuracy20: 0.6150 - val_loss: 2.6371 - val_accuracy20: 0.6042 - 73s/epoch - 43ms/step
Epoch 18/50
1701/1701 - 79s - loss: 2.4376 - accuracy20: 0.6151 - val_loss: 2.6228 - val_accuracy20: 0.6048 - 79s/epoch - 46ms/step
Epoch 19/50
1701/1701 - 76s - loss: 2.4316 - accuracy20: 0.6166 - val_loss: 2.6251 - val_accuracy20: 0.6176 - 76s/epoch - 45ms/step
Epoch 20/50
1701/1701 - 81s - loss: 2.4253 - accuracy20: 0.6176 - val_loss: 2.6182 - val_accuracy20: 0.6069 - 81s/epoch - 48ms/step
Epoch 21/50
1701/1701 - 76s - loss: 2.4207 - accuracy20: 0.6185 - val_loss: 2.6017 - val_accuracy20: 0.5979 - 76s/epoch - 44ms/step
Epoch 22/50
1701/1701 - 75s - loss: 2.4150 - accuracy20: 0.6195 - val_loss: 2.5943 - val_accuracy20: 0.6048 - 75s/epoch - 44ms/step
Epoch 23/50
1701/1701 - 73s - loss: 2.4103 - accuracy20: 0.6203 - val_loss: 2.6125 - val_accuracy20: 0.6038 - 73s/epoch - 43ms/step
Epoch 24/50
1701/1701 - 71s - loss: 2.4062 - accuracy20: 0.6206 - val_loss: 2.6006 - val_accuracy20: 0.5984 - 71s/epoch - 42ms/step
Epoch 25/50
1701/1701 - 73s - loss: 2.4022 - accuracy20: 0.6213 - val_loss: 2.6035 - val_accuracy20: 0.6040 - 73s/epoch - 43ms/step
Epoch 26/50
1701/1701 - 74s - loss: 2.3977 - accuracy20: 0.6220 - val_loss: 2.6129 - val_accuracy20: 0.6044 - 74s/epoch - 44ms/step
Epoch 27/50
1701/1701 - 77s - loss: 2.3936 - accuracy20: 0.6226 - val_loss: 2.6473 - val_accuracy20: 0.6069 - 77s/epoch - 45ms/step
Epoch 28/50
1701/1701 - 76s - loss: 2.3882 - accuracy20: 0.6234 - val_loss: 2.6205 - val_accuracy20: 0.6030 - 76s/epoch - 45ms/step
Epoch 29/50
1701/1701 - 76s - loss: 2.3864 - accuracy20: 0.6232 - val_loss: 2.6009 - val_accuracy20: 0.6080 - 76s/epoch - 44ms/step
Epoch 30/50
1701/1701 - 72s - loss: 2.3829 - accuracy20: 0.6236 - val_loss: 2.5891 - val_accuracy20: 0.6146 - 72s/epoch - 43ms/step
Epoch 31/50
1701/1701 - 73s - loss: 2.3796 - accuracy20: 0.6250 - val_loss: 2.5933 - val_accuracy20: 0.6096 - 73s/epoch - 43ms/step
Epoch 32/50
1701/1701 - 74s - loss: 2.3764 - accuracy20: 0.6251 - val_loss: 2.6027 - val_accuracy20: 0.6068 - 74s/epoch - 44ms/step
Epoch 33/50
1701/1701 - 74s - loss: 2.3724 - accuracy20: 0.6261 - val_loss: 2.6188 - val_accuracy20: 0.6141 - 74s/epoch - 43ms/step
Epoch 34/50
1701/1701 - 74s - loss: 2.3695 - accuracy20: 0.6259 - val_loss: 2.6041 - val_accuracy20: 0.6137 - 74s/epoch - 44ms/step
Epoch 35/50
1701/1701 - 75s - loss: 2.3655 - accuracy20: 0.6262 - val_loss: 2.5974 - val_accuracy20: 0.6111 - 75s/epoch - 44ms/step
Epoch 36/50
1701/1701 - 75s - loss: 2.3625 - accuracy20: 0.6267 - val_loss: 2.5960 - val_accuracy20: 0.6100 - 75s/epoch - 44ms/step
Epoch 37/50
1701/1701 - 77s - loss: 2.3587 - accuracy20: 0.6281 - val_loss: 2.5778 - val_accuracy20: 0.5980 - 77s/epoch - 45ms/step
Epoch 38/50
1701/1701 - 78s - loss: 2.3573 - accuracy20: 0.6279 - val_loss: 2.5745 - val_accuracy20: 0.6022 - 78s/epoch - 46ms/step
Epoch 39/50
1701/1701 - 76s - loss: 2.3514 - accuracy20: 0.6288 - val_loss: 2.5891 - val_accuracy20: 0.5952 - 76s/epoch - 45ms/step
Epoch 40/50
1701/1701 - 72s - loss: 2.3482 - accuracy20: 0.6296 - val_loss: 2.6044 - val_accuracy20: 0.6062 - 72s/epoch - 43ms/step
Epoch 41/50
1701/1701 - 76s - loss: 2.3447 - accuracy20: 0.6303 - val_loss: 2.5960 - val_accuracy20: 0.5953 - 76s/epoch - 45ms/step
Epoch 42/50
1701/1701 - 71s - loss: 2.3426 - accuracy20: 0.6309 - val_loss: 2.6105 - val_accuracy20: 0.6106 - 71s/epoch - 42ms/step
Epoch 43/50
1701/1701 - 71s - loss: 2.3401 - accuracy20: 0.6303 - val_loss: 2.6060 - val_accuracy20: 0.6095 - 71s/epoch - 42ms/step
Epoch 44/50
1701/1701 - 71s - loss: 2.3337 - accuracy20: 0.6312 - val_loss: 2.6002 - val_accuracy20: 0.6067 - 71s/epoch - 42ms/step
Epoch 45/50
1701/1701 - 72s - loss: 2.3317 - accuracy20: 0.6315 - val_loss: 2.6096 - val_accuracy20: 0.6134 - 72s/epoch - 42ms/step
Epoch 46/50
1701/1701 - 71s - loss: 2.3284 - accuracy20: 0.6326 - val_loss: 2.6155 - val_accuracy20: 0.6063 - 71s/epoch - 42ms/step
Epoch 47/50
1701/1701 - 72s - loss: 2.3259 - accuracy20: 0.6322 - val_loss: 2.6178 - val_accuracy20: 0.6091 - 72s/epoch - 42ms/step
Epoch 48/50
1701/1701 - 72s - loss: 2.3212 - accuracy20: 0.6335 - val_loss: 2.6067 - val_accuracy20: 0.6083 - 72s/epoch - 43ms/step
testing model: results/AAL/W5/deepVOL_L3/h20
Evaluating performance on  test set...
6357/6357 - 128s - 128s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8731229
{'0': {'precision': 0.464853722743754, 'recall': 0.5534650332798136, 'f1-score': 0.5053040211755908, 'support': 338193}, '1': {'precision': 0.777117474374514, 'recall': 0.5859965891728427, 'f1-score': 0.6681585958917932, 'support': 946398}, '2': {'precision': 0.4100073600801779, 'recall': 0.6114169619765426, 'f1-score': 0.4908546802243152, 'support': 342578}, 'accuracy': 0.5845870957472764, 'macro avg': {'precision': 0.5506595190661486, 'recall': 0.583626194809733, 'f1-score': 0.5547724324305664, 'support': 1627169}, 'weighted avg': {'precision': 0.6349261815893229, 'recall': 0.5845870957472764, 'f1-score': 0.5969817863480211, 'support': 1627169}}
[[187178  85419  65596]
 [156002 554586 235810]
 [ 59480  73640 209458]]
Evaluating performance on  train set...
1701/1701 - 41s - 41s/epoch - 24ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8299501
{'0': {'precision': 0.47871267716094335, 'recall': 0.5778085804117786, 'f1-score': 0.5236133024923025, 'support': 88737}, '1': {'precision': 0.8020730628239161, 'recall': 0.6205841620568513, 'f1-score': 0.6997523098266609, 'support': 255614}, '2': {'precision': 0.43805204654618995, 'recall': 0.6279113180405635, 'f1-score': 0.5160737170809191, 'support': 91067}, 'accuracy': 0.6133990785865536, 'macro avg': {'precision': 0.5729459288436831, 'recall': 0.6087680201697311, 'f1-score': 0.5798131097999608, 'support': 435418}, 'weighted avg': {'precision': 0.660038667296081, 'recall': 0.6133990785865536, 'f1-score': 0.6254395678191981, 'support': 435418}}
[[ 51273  21109  16355]
 [ 39984 158630  57000]
 [ 15849  18036  57182]]
Evaluating performance on  val set...
563/563 - 14s - 14s/epoch - 24ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8503717
{'0': {'precision': 0.475947187141217, 'recall': 0.5589940668824164, 'f1-score': 0.5141386580677167, 'support': 29664}, '1': {'precision': 0.7877482687771098, 'recall': 0.6116639092413141, 'f1-score': 0.6886279727257608, 'support': 84620}, '2': {'precision': 0.4250126396102404, 'recall': 0.6211251049538203, 'f1-score': 0.5046869243679133, 'support': 29775}, 'accuracy': 0.6027738634864882, 'macro avg': {'precision': 0.5629026985095225, 'recall': 0.5972610270258504, 'f1-score': 0.5691511850537969, 'support': 144059}, 'weighted avg': {'precision': 0.6485711216076122, 'recall': 0.6027738634864882, 'f1-score': 0.614679828251128, 'support': 144059}}
[[16582  7720  5362]
 [13203 51759 19658]
 [ 5055  6226 18494]]
training model: results/AAL/W5/deepVOL_L3/h30
Epoch 1/50
1701/1701 - 75s - loss: 3.2232 - accuracy30: 0.4275 - val_loss: 3.2073 - val_accuracy30: 0.4274 - 75s/epoch - 44ms/step
Epoch 2/50
1701/1701 - 71s - loss: 3.0610 - accuracy30: 0.4065 - val_loss: 3.0202 - val_accuracy30: 0.4464 - 71s/epoch - 42ms/step
Epoch 3/50
1701/1701 - 71s - loss: 2.8647 - accuracy30: 0.5180 - val_loss: 3.0111 - val_accuracy30: 0.4976 - 71s/epoch - 41ms/step
Epoch 4/50
1701/1701 - 70s - loss: 2.7652 - accuracy30: 0.5500 - val_loss: 2.9072 - val_accuracy30: 0.5455 - 70s/epoch - 41ms/step
Epoch 5/50
1701/1701 - 70s - loss: 2.7188 - accuracy30: 0.5604 - val_loss: 2.8562 - val_accuracy30: 0.5530 - 70s/epoch - 41ms/step
Epoch 6/50
1701/1701 - 79s - loss: 2.6811 - accuracy30: 0.5693 - val_loss: 2.8539 - val_accuracy30: 0.5579 - 79s/epoch - 46ms/step
Epoch 7/50
1701/1701 - 77s - loss: 2.6566 - accuracy30: 0.5757 - val_loss: 2.8343 - val_accuracy30: 0.5553 - 77s/epoch - 45ms/step
Epoch 8/50
1701/1701 - 76s - loss: 2.6363 - accuracy30: 0.5791 - val_loss: 2.8058 - val_accuracy30: 0.5640 - 76s/epoch - 44ms/step
Epoch 9/50
1701/1701 - 71s - loss: 2.6190 - accuracy30: 0.5824 - val_loss: 2.8010 - val_accuracy30: 0.5646 - 71s/epoch - 42ms/step
Epoch 10/50
1701/1701 - 71s - loss: 2.6021 - accuracy30: 0.5844 - val_loss: 2.7807 - val_accuracy30: 0.5620 - 71s/epoch - 42ms/step
Epoch 11/50
1701/1701 - 72s - loss: 2.5891 - accuracy30: 0.5878 - val_loss: 2.7790 - val_accuracy30: 0.5692 - 72s/epoch - 42ms/step
Epoch 12/50
1701/1701 - 75s - loss: 2.5773 - accuracy30: 0.5899 - val_loss: 2.7800 - val_accuracy30: 0.5662 - 75s/epoch - 44ms/step
Epoch 13/50
1701/1701 - 78s - loss: 2.5702 - accuracy30: 0.5908 - val_loss: 2.7608 - val_accuracy30: 0.5672 - 78s/epoch - 46ms/step
Epoch 14/50
1701/1701 - 78s - loss: 2.5626 - accuracy30: 0.5926 - val_loss: 2.7617 - val_accuracy30: 0.5690 - 78s/epoch - 46ms/step
Epoch 15/50
1701/1701 - 77s - loss: 2.5548 - accuracy30: 0.5942 - val_loss: 2.7613 - val_accuracy30: 0.5701 - 77s/epoch - 45ms/step
Epoch 16/50
1701/1701 - 73s - loss: 2.5484 - accuracy30: 0.5954 - val_loss: 2.7352 - val_accuracy30: 0.5751 - 73s/epoch - 43ms/step
Epoch 17/50
1701/1701 - 73s - loss: 2.5435 - accuracy30: 0.5959 - val_loss: 2.7262 - val_accuracy30: 0.5856 - 73s/epoch - 43ms/step
Epoch 18/50
1701/1701 - 75s - loss: 2.5383 - accuracy30: 0.5973 - val_loss: 2.7113 - val_accuracy30: 0.5870 - 75s/epoch - 44ms/step
Epoch 19/50
1701/1701 - 70s - loss: 2.5317 - accuracy30: 0.5989 - val_loss: 2.7349 - val_accuracy30: 0.5756 - 70s/epoch - 41ms/step
Epoch 20/50
1701/1701 - 72s - loss: 2.5278 - accuracy30: 0.5997 - val_loss: 2.7247 - val_accuracy30: 0.5838 - 72s/epoch - 42ms/step
Epoch 21/50
1701/1701 - 72s - loss: 2.5218 - accuracy30: 0.6005 - val_loss: 2.7209 - val_accuracy30: 0.5795 - 72s/epoch - 43ms/step
Epoch 22/50
1701/1701 - 73s - loss: 2.5163 - accuracy30: 0.6015 - val_loss: 2.7158 - val_accuracy30: 0.5803 - 73s/epoch - 43ms/step
Epoch 23/50
1701/1701 - 76s - loss: 2.5133 - accuracy30: 0.6017 - val_loss: 2.7297 - val_accuracy30: 0.5809 - 76s/epoch - 44ms/step
Epoch 24/50
1701/1701 - 72s - loss: 2.5100 - accuracy30: 0.6024 - val_loss: 2.7154 - val_accuracy30: 0.5828 - 72s/epoch - 42ms/step
Epoch 25/50
1701/1701 - 73s - loss: 2.5052 - accuracy30: 0.6031 - val_loss: 2.7247 - val_accuracy30: 0.5762 - 73s/epoch - 43ms/step
Epoch 26/50
1701/1701 - 74s - loss: 2.5014 - accuracy30: 0.6045 - val_loss: 2.7219 - val_accuracy30: 0.5782 - 74s/epoch - 44ms/step
Epoch 27/50
1701/1701 - 75s - loss: 2.4972 - accuracy30: 0.6043 - val_loss: 2.7172 - val_accuracy30: 0.5807 - 75s/epoch - 44ms/step
Epoch 28/50
1701/1701 - 71s - loss: 2.4960 - accuracy30: 0.6044 - val_loss: 2.7239 - val_accuracy30: 0.5828 - 71s/epoch - 42ms/step
testing model: results/AAL/W5/deepVOL_L3/h30
Evaluating performance on  test set...
6357/6357 - 126s - 126s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9082717
{'0': {'precision': 0.46900272963879897, 'recall': 0.5581237236450808, 'f1-score': 0.5096968324179015, 'support': 397127}, '1': {'precision': 0.6920566408891231, 'recall': 0.5977266433069633, 'f1-score': 0.6414421678519119, 'support': 830490}, '2': {'precision': 0.451871535464042, 'recall': 0.4945488947621336, 'f1-score': 0.47224798049806416, 'support': 399552}, 'accuracy': 0.5627258139750696, 'macro avg': {'precision': 0.5376436353306547, 'recall': 0.5501330872380592, 'f1-score': 0.5411289935892926, 'support': 1627169}, 'weighted avg': {'precision': 0.578640536074006, 'recall': 0.5627258139750696, 'f1-score': 0.5677426899424219, 'support': 1627169}}
[[221646 117062  58419]
 [152813 496406 181271]
 [ 98131 103823 197598]]
Evaluating performance on  train set...
1701/1701 - 35s - 35s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86413044
{'0': {'precision': 0.48137309182947086, 'recall': 0.5874347267936256, 'f1-score': 0.5291414710063339, 'support': 103603}, '1': {'precision': 0.7198568961263262, 'recall': 0.6448175111500091, 'f1-score': 0.6802741073905938, 'support': 226233}, '2': {'precision': 0.4814741672779251, 'recall': 0.48492167225474037, 'f1-score': 0.4831917704794262, 'support': 105582}, 'accuracy': 0.5923916788006008, 'macro avg': {'precision': 0.5609013850779073, 'recall': 0.5723913033994584, 'f1-score': 0.5642024496254513, 'support': 435418}, 'weighted avg': {'precision': 0.6053082030225982, 'recall': 0.5923916788006008, 'f1-score': 0.5965243730592769, 'support': 435418}}
[[ 60860  29407  13336]
 [ 38551 145879  41803]
 [ 27019  27364  51199]]
Evaluating performance on  val set...
563/563 - 13s - 13s/epoch - 24ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88001066
{'0': {'precision': 0.488438061950713, 'recall': 0.5529273467515339, 'f1-score': 0.5186858702814647, 'support': 34878}, '1': {'precision': 0.7039941262848752, 'recall': 0.6447283485745025, 'f1-score': 0.6730591043099818, 'support': 74360}, '2': {'precision': 0.47242022151551705, 'recall': 0.4948737830619454, 'f1-score': 0.48338639774464565, 'support': 34821}, 'accuracy': 0.5862806211343963, 'macro avg': {'precision': 0.5549508032503684, 'recall': 0.5641764927959939, 'f1-score': 0.5583771241120307, 'support': 144059}, 'weighted avg': {'precision': 0.5958315029859441, 'recall': 0.5862806211343963, 'f1-score': 0.5898374869743194, 'support': 144059}}
[[19285 10817  4776]
 [11950 47942 14468]
 [ 8248  9341 17232]]
training model: results/AAL/W5/deepVOL_L3/h50
Epoch 1/50
1701/1701 - 75s - loss: 3.2446 - accuracy50: 0.4036 - val_loss: 3.2564 - val_accuracy50: 0.3961 - 75s/epoch - 44ms/step
Epoch 2/50
1701/1701 - 70s - loss: 3.1404 - accuracy50: 0.4068 - val_loss: 3.2330 - val_accuracy50: 0.3910 - 70s/epoch - 41ms/step
Epoch 3/50
1701/1701 - 70s - loss: 3.0800 - accuracy50: 0.4367 - val_loss: 3.1057 - val_accuracy50: 0.4654 - 70s/epoch - 41ms/step
Epoch 4/50
1701/1701 - 70s - loss: 2.9518 - accuracy50: 0.5047 - val_loss: 3.0322 - val_accuracy50: 0.4871 - 70s/epoch - 41ms/step
Epoch 5/50
1701/1701 - 72s - loss: 2.8845 - accuracy50: 0.5236 - val_loss: 3.0044 - val_accuracy50: 0.5046 - 72s/epoch - 43ms/step
Epoch 6/50
1701/1701 - 73s - loss: 2.8430 - accuracy50: 0.5341 - val_loss: 2.9687 - val_accuracy50: 0.5165 - 73s/epoch - 43ms/step
Epoch 7/50
1701/1701 - 73s - loss: 2.8186 - accuracy50: 0.5395 - val_loss: 2.9808 - val_accuracy50: 0.5081 - 73s/epoch - 43ms/step
Epoch 8/50
1701/1701 - 72s - loss: 2.7992 - accuracy50: 0.5429 - val_loss: 2.9864 - val_accuracy50: 0.5153 - 72s/epoch - 42ms/step
Epoch 9/50
1701/1701 - 73s - loss: 2.7834 - accuracy50: 0.5461 - val_loss: 2.9320 - val_accuracy50: 0.5225 - 73s/epoch - 43ms/step
Epoch 10/50
1701/1701 - 68s - loss: 2.7722 - accuracy50: 0.5473 - val_loss: 2.9449 - val_accuracy50: 0.5270 - 68s/epoch - 40ms/step
Epoch 11/50
1701/1701 - 69s - loss: 2.7653 - accuracy50: 0.5490 - val_loss: 2.9349 - val_accuracy50: 0.5194 - 69s/epoch - 41ms/step
Epoch 12/50
1701/1701 - 69s - loss: 2.7532 - accuracy50: 0.5508 - val_loss: 2.9319 - val_accuracy50: 0.5202 - 69s/epoch - 41ms/step
Epoch 13/50
1701/1701 - 68s - loss: 2.7440 - accuracy50: 0.5530 - val_loss: 2.9140 - val_accuracy50: 0.5286 - 68s/epoch - 40ms/step
Epoch 14/50
1701/1701 - 69s - loss: 2.7384 - accuracy50: 0.5539 - val_loss: 2.9112 - val_accuracy50: 0.5304 - 69s/epoch - 41ms/step
Epoch 15/50
1701/1701 - 69s - loss: 2.7311 - accuracy50: 0.5561 - val_loss: 2.8996 - val_accuracy50: 0.5314 - 69s/epoch - 40ms/step
Epoch 16/50
1701/1701 - 68s - loss: 2.7247 - accuracy50: 0.5567 - val_loss: 2.9173 - val_accuracy50: 0.5278 - 68s/epoch - 40ms/step
Epoch 17/50
1701/1701 - 69s - loss: 2.7195 - accuracy50: 0.5577 - val_loss: 3.0052 - val_accuracy50: 0.5103 - 69s/epoch - 40ms/step
Epoch 18/50
1701/1701 - 69s - loss: 2.7156 - accuracy50: 0.5583 - val_loss: 2.9131 - val_accuracy50: 0.5245 - 69s/epoch - 41ms/step
Epoch 19/50
1701/1701 - 69s - loss: 2.7092 - accuracy50: 0.5595 - val_loss: 2.9153 - val_accuracy50: 0.5292 - 69s/epoch - 40ms/step
Epoch 20/50
1701/1701 - 69s - loss: 2.7048 - accuracy50: 0.5603 - val_loss: 2.9152 - val_accuracy50: 0.5278 - 69s/epoch - 41ms/step
Epoch 21/50
1701/1701 - 71s - loss: 2.6993 - accuracy50: 0.5612 - val_loss: 2.8834 - val_accuracy50: 0.5311 - 71s/epoch - 42ms/step
Epoch 22/50
1701/1701 - 71s - loss: 2.6955 - accuracy50: 0.5619 - val_loss: 2.9066 - val_accuracy50: 0.5311 - 71s/epoch - 42ms/step
Epoch 23/50
1701/1701 - 71s - loss: 2.6903 - accuracy50: 0.5633 - val_loss: 2.9133 - val_accuracy50: 0.5243 - 71s/epoch - 42ms/step
Epoch 24/50
1701/1701 - 68s - loss: 2.6878 - accuracy50: 0.5638 - val_loss: 2.9109 - val_accuracy50: 0.5281 - 68s/epoch - 40ms/step
Epoch 25/50
1701/1701 - 69s - loss: 2.6823 - accuracy50: 0.5644 - val_loss: 2.9186 - val_accuracy50: 0.5281 - 69s/epoch - 40ms/step
Epoch 26/50
1701/1701 - 69s - loss: 2.6781 - accuracy50: 0.5648 - val_loss: 2.9152 - val_accuracy50: 0.5237 - 69s/epoch - 40ms/step
Epoch 27/50
1701/1701 - 69s - loss: 2.6749 - accuracy50: 0.5662 - val_loss: 2.9176 - val_accuracy50: 0.5294 - 69s/epoch - 41ms/step
Epoch 28/50
1701/1701 - 70s - loss: 2.6692 - accuracy50: 0.5670 - val_loss: 2.9001 - val_accuracy50: 0.5252 - 70s/epoch - 41ms/step
Epoch 29/50
1701/1701 - 72s - loss: 2.6664 - accuracy50: 0.5670 - val_loss: 2.9064 - val_accuracy50: 0.5276 - 72s/epoch - 42ms/step
Epoch 30/50
1701/1701 - 70s - loss: 2.6616 - accuracy50: 0.5691 - val_loss: 2.9126 - val_accuracy50: 0.5291 - 70s/epoch - 41ms/step
Epoch 31/50
1701/1701 - 70s - loss: 2.6578 - accuracy50: 0.5699 - val_loss: 2.9129 - val_accuracy50: 0.5323 - 70s/epoch - 41ms/step
testing model: results/AAL/W5/deepVOL_L3/h50
Evaluating performance on  test set...
6357/6357 - 121s - 121s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97003263
{'0': {'precision': 0.5194442107624576, 'recall': 0.3833406108566852, 'f1-score': 0.44113293952488175, 'support': 483223}, '1': {'precision': 0.5574069960132572, 'recall': 0.5594796155120981, 'f1-score': 0.5584413826706006, 'support': 663740}, '2': {'precision': 0.4481617470642061, 'recall': 0.5640225236669263, 'f1-score': 0.499461070280308, 'support': 480206}, 'accuracy': 0.5085120230289539, 'macro avg': {'precision': 0.5083376512799737, 'recall': 0.5022809166785699, 'f1-score': 0.4996784641585968, 'support': 1627169}, 'weighted avg': {'precision': 0.5138929449257087, 'recall': 0.5085120230289539, 'f1-score': 0.50619798464993, 'support': 1627169}}
[[185239 163875 134109]
 [ 92996 371349 199395]
 [ 78375 130984 270847]]
Evaluating performance on  train set...
1701/1701 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92274225
{'0': {'precision': 0.5457613286720999, 'recall': 0.39776234567901236, 'f1-score': 0.46015444482154233, 'support': 124416}, '1': {'precision': 0.5939283688559355, 'recall': 0.6298192852691755, 'f1-score': 0.6113475102697756, 'support': 184545}, '2': {'precision': 0.4778253401680041, 'recall': 0.5631716710027914, 'f1-score': 0.5169999382942347, 'support': 126457}, 'accuracy': 0.54415527148625, 'macro avg': {'precision': 0.5391716792320133, 'recall': 0.5302511006503264, 'f1-score': 0.5295006311285176, 'support': 435418}, 'weighted avg': {'precision': 0.5464457402776456, 'recall': 0.54415527148625, 'f1-score': 0.5407446703777217, 'support': 435418}}
[[ 49488  43732  31196]
 [ 21684 116230  46631]
 [ 19505  35735  71217]]
Evaluating performance on  val set...
563/563 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94503486
{'0': {'precision': 0.5453722334004024, 'recall': 0.38714054465816033, 'f1-score': 0.45283176477139836, 'support': 42008}, '1': {'precision': 0.5774185128890117, 'recall': 0.6227892958866, 'f1-score': 0.5992463412496714, 'support': 60388}, '2': {'precision': 0.4645868122021749, 'recall': 0.5475841874084919, 'f1-score': 0.5026826339388998, 'support': 41663}, 'accuracy': 0.5323235618739545, 'macro avg': {'precision': 0.5291258528305297, 'recall': 0.5191713426510841, 'f1-score': 0.5182535799866566, 'support': 144059}, 'weighted avg': {'precision': 0.5354419112572276, 'recall': 0.5323235618739545, 'f1-score': 0.528624462252955, 'support': 144059}}
[[16263 15329 10416]
 [ 6903 37609 15876]
 [ 6654 12195 22814]]
training model: results/AAL/W5/deepVOL_L3/h100
Epoch 1/50
1701/1701 - 78s - loss: 3.2823 - accuracy100: 0.3711 - val_loss: 3.3402 - val_accuracy100: 0.3309 - 78s/epoch - 46ms/step
Epoch 2/50
1701/1701 - 75s - loss: 3.2544 - accuracy100: 0.3814 - val_loss: 3.2669 - val_accuracy100: 0.3672 - 75s/epoch - 44ms/step
Epoch 3/50
1701/1701 - 71s - loss: 3.2237 - accuracy100: 0.4000 - val_loss: 3.2708 - val_accuracy100: 0.3612 - 71s/epoch - 42ms/step
Epoch 4/50
1701/1701 - 72s - loss: 3.1825 - accuracy100: 0.4241 - val_loss: 3.2305 - val_accuracy100: 0.4071 - 72s/epoch - 42ms/step
Epoch 5/50
1701/1701 - 72s - loss: 3.1250 - accuracy100: 0.4506 - val_loss: 3.1795 - val_accuracy100: 0.4370 - 72s/epoch - 42ms/step
Epoch 6/50
1701/1701 - 71s - loss: 3.0933 - accuracy100: 0.4604 - val_loss: 3.1979 - val_accuracy100: 0.4317 - 71s/epoch - 42ms/step
Epoch 7/50
1701/1701 - 69s - loss: 3.0698 - accuracy100: 0.4666 - val_loss: 3.2074 - val_accuracy100: 0.4317 - 69s/epoch - 41ms/step
Epoch 8/50
1701/1701 - 68s - loss: 3.0498 - accuracy100: 0.4705 - val_loss: 3.1970 - val_accuracy100: 0.4383 - 68s/epoch - 40ms/step
Epoch 9/50
1701/1701 - 70s - loss: 3.0367 - accuracy100: 0.4739 - val_loss: 3.2011 - val_accuracy100: 0.4262 - 70s/epoch - 41ms/step
Epoch 10/50
1701/1701 - 70s - loss: 3.0243 - accuracy100: 0.4762 - val_loss: 3.2246 - val_accuracy100: 0.4358 - 70s/epoch - 41ms/step
Epoch 11/50
1701/1701 - 72s - loss: 3.0150 - accuracy100: 0.4780 - val_loss: 3.2109 - val_accuracy100: 0.4369 - 72s/epoch - 42ms/step
Epoch 12/50
1701/1701 - 73s - loss: 3.0094 - accuracy100: 0.4790 - val_loss: 3.2010 - val_accuracy100: 0.4373 - 73s/epoch - 43ms/step
Epoch 13/50
1701/1701 - 72s - loss: 3.0033 - accuracy100: 0.4811 - val_loss: 3.1981 - val_accuracy100: 0.4369 - 72s/epoch - 42ms/step
Epoch 14/50
1701/1701 - 73s - loss: 2.9997 - accuracy100: 0.4820 - val_loss: 3.2031 - val_accuracy100: 0.4382 - 73s/epoch - 43ms/step
Epoch 15/50
1701/1701 - 74s - loss: 2.9940 - accuracy100: 0.4835 - val_loss: 3.1878 - val_accuracy100: 0.4405 - 74s/epoch - 44ms/step
testing model: results/AAL/W5/deepVOL_L3/h100
Evaluating performance on  test set...
6357/6357 - 124s - 124s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0731823
{'0': {'precision': 0.4610448688127491, 'recall': 0.35625025455047715, 'f1-score': 0.4019291127000586, 'support': 564721}, '1': {'precision': 0.3949538870871526, 'recall': 0.4441410207700101, 'f1-score': 0.4181057969138142, 'support': 505344}, '2': {'precision': 0.42017480310154226, 'recall': 0.4695191562078176, 'f1-score': 0.4434786073295678, 'support': 557104}, 'accuracy': 0.4223267527835154, 'macro avg': {'precision': 0.4253911863338147, 'recall': 0.4233034771761017, 'f1-score': 0.4211711723144802, 'support': 1627169}, 'weighted avg': {'precision': 0.4265262919733943, 'recall': 0.4223267527835154, 'f1-score': 0.4211786067374906, 'support': 1627169}}
[[201182 178111 185428]
 [105370 224444 175530]
 [129809 165724 261571]]
Evaluating performance on  train set...
1701/1701 - 41s - 41s/epoch - 24ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0495708
{'0': {'precision': 0.46672404627496644, 'recall': 0.37984671803535375, 'f1-score': 0.4188275916902352, 'support': 145614}, '1': {'precision': 0.4446488552336415, 'recall': 0.5168700547043688, 'f1-score': 0.47804713095796364, 'support': 144961}, '2': {'precision': 0.43496425274421674, 'recall': 0.4456549505326457, 'f1-score': 0.4402447092202451, 'support': 144843}, 'accuracy': 0.4473563334542899, 'macro avg': {'precision': 0.4487790514176082, 'recall': 0.4474572410907894, 'f1-score': 0.44570647728948126, 'support': 435418}, 'weighted avg': {'precision': 0.44880970754088595, 'recall': 0.4473563334542899, 'f1-score': 0.4456676469616948, 'support': 435418}}
[[55311 48477 41826]
 [28008 74926 42027]
 [35190 45103 64550]]
Evaluating performance on  val set...
563/563 - 13s - 13s/epoch - 24ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0600656
{'0': {'precision': 0.4656272335018662, 'recall': 0.3596622160426933, 'f1-score': 0.4058419085413686, 'support': 48907}, '1': {'precision': 0.4278165329612836, 'recall': 0.5196034822393086, 'f1-score': 0.4692638042677736, 'support': 47211}, '2': {'precision': 0.4254219279964039, 'recall': 0.43430466615214536, 'f1-score': 0.42981740862690043, 'support': 47941}, 'accuracy': 0.43691820712347024, 'macro avg': {'precision': 0.43962189815318453, 'recall': 0.43785678814471574, 'f1-score': 0.4349743738120142, 'support': 144059}, 'weighted avg': {'precision': 0.43985610129590325, 'recall': 0.43691820712347024, 'f1-score': 0.43460526639294184, 'support': 144059}}
[[17590 16840 14477]
 [ 9036 24531 13644]
 [11151 15969 20821]]
training model: results/AAL/W5/deepVOL_L3/h200
Epoch 1/50
1701/1701 - 75s - loss: 3.2924 - accuracy200: 0.3653 - val_loss: 3.3229 - val_accuracy200: 0.3342 - 75s/epoch - 44ms/step
Epoch 2/50
1701/1701 - 71s - loss: 3.2820 - accuracy200: 0.3673 - val_loss: 3.3221 - val_accuracy200: 0.3253 - 71s/epoch - 41ms/step
Epoch 3/50
1701/1701 - 70s - loss: 3.2707 - accuracy200: 0.3755 - val_loss: 3.3164 - val_accuracy200: 0.3474 - 70s/epoch - 41ms/step
Epoch 4/50
1701/1701 - 70s - loss: 3.2635 - accuracy200: 0.3831 - val_loss: 3.3046 - val_accuracy200: 0.3661 - 70s/epoch - 41ms/step
Epoch 5/50
1701/1701 - 72s - loss: 3.2473 - accuracy200: 0.3957 - val_loss: 3.3159 - val_accuracy200: 0.3732 - 72s/epoch - 42ms/step
Epoch 6/50
1701/1701 - 72s - loss: 3.2343 - accuracy200: 0.4054 - val_loss: 3.3094 - val_accuracy200: 0.3694 - 72s/epoch - 43ms/step
Epoch 7/50
1701/1701 - 70s - loss: 3.2229 - accuracy200: 0.4135 - val_loss: 3.3111 - val_accuracy200: 0.3646 - 70s/epoch - 41ms/step
Epoch 8/50
1701/1701 - 71s - loss: 3.2147 - accuracy200: 0.4176 - val_loss: 3.3035 - val_accuracy200: 0.3745 - 71s/epoch - 42ms/step
Epoch 9/50
1701/1701 - 72s - loss: 3.2090 - accuracy200: 0.4203 - val_loss: 3.3140 - val_accuracy200: 0.3640 - 72s/epoch - 42ms/step
Epoch 10/50
1701/1701 - 70s - loss: 3.2020 - accuracy200: 0.4225 - val_loss: 3.3239 - val_accuracy200: 0.3634 - 70s/epoch - 41ms/step
Epoch 11/50
1701/1701 - 71s - loss: 3.1977 - accuracy200: 0.4250 - val_loss: 3.3361 - val_accuracy200: 0.3550 - 71s/epoch - 42ms/step
Epoch 12/50
1701/1701 - 71s - loss: 3.1908 - accuracy200: 0.4276 - val_loss: 3.3320 - val_accuracy200: 0.3591 - 71s/epoch - 41ms/step
Epoch 13/50
1701/1701 - 72s - loss: 3.1864 - accuracy200: 0.4294 - val_loss: 3.3434 - val_accuracy200: 0.3631 - 72s/epoch - 43ms/step
Epoch 14/50
1701/1701 - 71s - loss: 3.1812 - accuracy200: 0.4312 - val_loss: 3.3475 - val_accuracy200: 0.3578 - 71s/epoch - 42ms/step
Epoch 15/50
1701/1701 - 71s - loss: 3.1794 - accuracy200: 0.4328 - val_loss: 3.3488 - val_accuracy200: 0.3553 - 71s/epoch - 42ms/step
Epoch 16/50
1701/1701 - 69s - loss: 3.1733 - accuracy200: 0.4341 - val_loss: 3.3659 - val_accuracy200: 0.3533 - 69s/epoch - 41ms/step
Epoch 17/50
1701/1701 - 69s - loss: 3.1678 - accuracy200: 0.4381 - val_loss: 3.3526 - val_accuracy200: 0.3597 - 69s/epoch - 41ms/step
Epoch 18/50
1701/1701 - 68s - loss: 3.1621 - accuracy200: 0.4393 - val_loss: 3.3425 - val_accuracy200: 0.3569 - 68s/epoch - 40ms/step
testing model: results/AAL/W5/deepVOL_L3/h200
Evaluating performance on  test set...
6357/6357 - 122s - 122s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1125853
{'0': {'precision': 0.44386867832299304, 'recall': 0.12443321535099061, 'f1-score': 0.19437558611764677, 'support': 607153}, '1': {'precision': 0.2699550180243724, 'recall': 0.4281186125772453, 'f1-score': 0.33111913330763115, 'support': 419281}, '2': {'precision': 0.4086433812946007, 'recall': 0.5387683421142434, 'f1-score': 0.46476967007308495, 'support': 600735}, 'accuracy': 0.355653899502756, 'macro avg': {'precision': 0.374155692547322, 'recall': 0.36377339001415976, 'f1-score': 0.3300881298327876, 'support': 1627169}, 'weighted avg': {'precision': 0.3860506138109373, 'recall': 0.355653899502756, 'f1-score': 0.3294378698966113, 'support': 1627169}}
[[ 75550 258112 273491]
 [ 44899 179502 194880]
 [ 49759 227319 323657]]
Evaluating performance on  train set...
1701/1701 - 40s - 40s/epoch - 24ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0918618
{'0': {'precision': 0.4455528063549941, 'recall': 0.11775516947052507, 'f1-score': 0.18627872663621367, 'support': 145276}, '1': {'precision': 0.36756907497701496, 'recall': 0.5757970826535975, 'f1-score': 0.4487021276595745, 'support': 146503}, '2': {'precision': 0.39235700727051326, 'recall': 0.4576055249618836, 'f1-score': 0.42247682097922323, 'support': 143639}, 'accuracy': 0.3839827476126389, 'macro avg': {'precision': 0.4018262962008408, 'recall': 0.3837192590286687, 'f1-score': 0.3524858917583371, 'support': 435418}, 'weighted avg': {'precision': 0.4017653607676187, 'recall': 0.3839827476126389, 'f1-score': 0.3524938890628037, 'support': 435418}}
[[17107 76254 51915]
 [12266 84356 49881]
 [ 9022 68887 65730]]
Evaluating performance on  val set...
563/563 - 14s - 14s/epoch - 24ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1005923
{'0': {'precision': 0.42440154440154443, 'recall': 0.11005867392915072, 'f1-score': 0.17478970216419928, 'support': 49937}, '1': {'precision': 0.3538116469268853, 'recall': 0.5674863447912782, 'f1-score': 0.4358704351122531, 'support': 45587}, '2': {'precision': 0.3930265041127071, 'recall': 0.4695992582672298, 'f1-score': 0.4279143119989486, 'support': 48535}, 'accuracy': 0.37594318994300946, 'macro avg': {'precision': 0.39041323181371235, 'recall': 0.3823814256625529, 'f1-score': 0.3461914830918003, 'support': 144059}, 'weighted avg': {'precision': 0.3914930191681608, 'recall': 0.37594318994300946, 'f1-score': 0.3426882042448224, 'support': 144059}}
[[ 5496 25020 19421]
 [ 3939 25870 15778]
 [ 3515 22228 22792]]
training model: results/AAL/W5/deepVOL_L3/h300
Epoch 1/50
1701/1701 - 77s - loss: 3.2961 - accuracy300: 0.3634 - val_loss: 3.3086 - val_accuracy300: 0.3320 - 77s/epoch - 45ms/step
Epoch 2/50
1701/1701 - 72s - loss: 3.2923 - accuracy300: 0.3552 - val_loss: 3.3074 - val_accuracy300: 0.3353 - 72s/epoch - 42ms/step
Epoch 3/50
1701/1701 - 71s - loss: 3.2867 - accuracy300: 0.3614 - val_loss: 3.3013 - val_accuracy300: 0.3358 - 71s/epoch - 42ms/step
Epoch 4/50
1701/1701 - 74s - loss: 3.2805 - accuracy300: 0.3682 - val_loss: 3.2984 - val_accuracy300: 0.3403 - 74s/epoch - 43ms/step
Epoch 5/50
1701/1701 - 70s - loss: 3.2749 - accuracy300: 0.3729 - val_loss: 3.2972 - val_accuracy300: 0.3412 - 70s/epoch - 41ms/step
Epoch 6/50
1701/1701 - 70s - loss: 3.2710 - accuracy300: 0.3770 - val_loss: 3.2972 - val_accuracy300: 0.3427 - 70s/epoch - 41ms/step
Epoch 7/50
1701/1701 - 73s - loss: 3.2679 - accuracy300: 0.3793 - val_loss: 3.2944 - val_accuracy300: 0.3496 - 73s/epoch - 43ms/step
Epoch 8/50
1701/1701 - 73s - loss: 3.2600 - accuracy300: 0.3865 - val_loss: 3.2946 - val_accuracy300: 0.3492 - 73s/epoch - 43ms/step
Epoch 9/50
1701/1701 - 72s - loss: 3.2526 - accuracy300: 0.3925 - val_loss: 3.3000 - val_accuracy300: 0.3504 - 72s/epoch - 42ms/step
Epoch 10/50
1701/1701 - 72s - loss: 3.2453 - accuracy300: 0.3981 - val_loss: 3.3038 - val_accuracy300: 0.3538 - 72s/epoch - 42ms/step
Epoch 11/50
1701/1701 - 71s - loss: 3.2367 - accuracy300: 0.4040 - val_loss: 3.3186 - val_accuracy300: 0.3487 - 71s/epoch - 42ms/step
Epoch 12/50
1701/1701 - 71s - loss: 3.2300 - accuracy300: 0.4077 - val_loss: 3.3200 - val_accuracy300: 0.3518 - 71s/epoch - 42ms/step
Epoch 13/50
1701/1701 - 71s - loss: 3.2260 - accuracy300: 0.4095 - val_loss: 3.3247 - val_accuracy300: 0.3497 - 71s/epoch - 42ms/step
Epoch 14/50
1701/1701 - 71s - loss: 3.2209 - accuracy300: 0.4125 - val_loss: 3.3391 - val_accuracy300: 0.3455 - 71s/epoch - 41ms/step
Epoch 15/50
1701/1701 - 70s - loss: 3.2175 - accuracy300: 0.4146 - val_loss: 3.3455 - val_accuracy300: 0.3477 - 70s/epoch - 41ms/step
Epoch 16/50
1701/1701 - 72s - loss: 3.2126 - accuracy300: 0.4180 - val_loss: 3.3363 - val_accuracy300: 0.3468 - 72s/epoch - 42ms/step
Epoch 17/50
1701/1701 - 70s - loss: 3.2065 - accuracy300: 0.4206 - val_loss: 3.3398 - val_accuracy300: 0.3522 - 70s/epoch - 41ms/step
testing model: results/AAL/W5/deepVOL_L3/h300
Evaluating performance on  test set...
6357/6357 - 123s - 123s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0982317
{'0': {'precision': 0.4180223990568818, 'recall': 0.04992115951822834, 'f1-score': 0.08919093973236744, 'support': 568236}, '1': {'precision': 0.3246574850514446, 'recall': 0.14596881294630062, 'f1-score': 0.20139064862591996, 'support': 495462}, '2': {'precision': 0.36014724532282866, 'recall': 0.8542640171366406, 'f1-score': 0.5066831016159864, 'support': 563471}, 'accuracy': 0.35770224236081194, 'macro avg': {'precision': 0.3676090431437184, 'recall': 0.3500513298670565, 'f1-score': 0.26575489665809127, 'support': 1627169}, 'weighted avg': {'precision': 0.3695518727792533, 'recall': 0.35770224236081194, 'f1-score': 0.26792800890990337, 'support': 1627169}}
[[ 28367  86343 453526]
 [ 21474  72322 401666]
 [ 18019  64099 481353]]
Evaluating performance on  train set...
1701/1701 - 39s - 39s/epoch - 23ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0961783
{'0': {'precision': 0.3968990193479989, 'recall': 0.060891723198492786, 'f1-score': 0.10558477041041159, 'support': 147557}, '1': {'precision': 0.343907697686615, 'recall': 0.2077381748551556, 'f1-score': 0.2590167387888736, 'support': 142049}, '2': {'precision': 0.3529474730483982, 'recall': 0.7914643513565413, 'f1-score': 0.48819024211748624, 'support': 145812}, 'accuracy': 0.3534511664653276, 'macro avg': {'precision': 0.3645847300276707, 'recall': 0.35336474980339655, 'f1-score': 0.28426391710559046, 'support': 435418}, 'weighted avg': {'precision': 0.3648929306706468, 'recall': 0.3534511664653276, 'f1-score': 0.28376602776941856, 'support': 435418}}
[[  8985  31849 106723]
 [  7693  29509 104847]
 [  5960  24447 115405]]
Evaluating performance on  val set...
563/563 - 13s - 13s/epoch - 23ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0986195
{'0': {'precision': 0.3697259678120922, 'recall': 0.052152571837611204, 'f1-score': 0.09141095497562375, 'support': 48895}, '1': {'precision': 0.35595852747345, 'recall': 0.17886521830837376, 'f1-score': 0.23809189561018065, 'support': 47410}, '2': {'precision': 0.3443916039492143, 'recall': 0.8173765548435733, 'f1-score': 0.48460206216285, 'support': 47754}, 'accuracy': 0.3475173366467906, 'macro avg': {'precision': 0.3566920330782522, 'recall': 0.3494647816631861, 'f1-score': 0.27136830424955144, 'support': 144059}, 'weighted avg': {'precision': 0.3567970181570002, 'recall': 0.3475173366467906, 'f1-score': 0.2700224372717881, 'support': 144059}}
[[ 2550  8609 37736]
 [ 2360  8480 36570]
 [ 1987  6734 39033]]
training model: results/AAL/W5/deepVOL_L3/h500
Epoch 1/50
1701/1701 - 74s - loss: 3.2460 - accuracy500: 0.4072 - val_loss: 3.4830 - val_accuracy500: 0.2763 - 74s/epoch - 43ms/step
Epoch 2/50
1701/1701 - 71s - loss: 3.2771 - accuracy500: 0.3775 - val_loss: 3.4915 - val_accuracy500: 0.2763 - 71s/epoch - 42ms/step
Epoch 3/50
1701/1701 - 71s - loss: 3.2804 - accuracy500: 0.3702 - val_loss: 3.4970 - val_accuracy500: 0.2762 - 71s/epoch - 42ms/step
Epoch 4/50
1701/1701 - 72s - loss: 3.2789 - accuracy500: 0.3745 - val_loss: 3.3744 - val_accuracy500: 0.2814 - 72s/epoch - 42ms/step
Epoch 5/50
1701/1701 - 71s - loss: 3.2845 - accuracy500: 0.3675 - val_loss: 3.3894 - val_accuracy500: 0.2876 - 71s/epoch - 42ms/step
Epoch 6/50
1701/1701 - 72s - loss: 3.2799 - accuracy500: 0.3721 - val_loss: 3.3984 - val_accuracy500: 0.2798 - 72s/epoch - 43ms/step
Epoch 7/50
1701/1701 - 71s - loss: 3.2700 - accuracy500: 0.3790 - val_loss: 3.5120 - val_accuracy500: 0.2810 - 71s/epoch - 42ms/step
Epoch 8/50
1701/1701 - 70s - loss: 3.2638 - accuracy500: 0.3854 - val_loss: 3.5316 - val_accuracy500: 0.2782 - 70s/epoch - 41ms/step
Epoch 9/50
1701/1701 - 70s - loss: 3.2587 - accuracy500: 0.3917 - val_loss: 3.4599 - val_accuracy500: 0.2844 - 70s/epoch - 41ms/step
Epoch 10/50
1701/1701 - 69s - loss: 3.2728 - accuracy500: 0.3807 - val_loss: 3.3731 - val_accuracy500: 0.3057 - 69s/epoch - 41ms/step
Epoch 11/50
1701/1701 - 69s - loss: 3.2630 - accuracy500: 0.3850 - val_loss: 3.4507 - val_accuracy500: 0.2943 - 69s/epoch - 41ms/step
Epoch 12/50
1701/1701 - 69s - loss: 3.2561 - accuracy500: 0.3940 - val_loss: 3.5230 - val_accuracy500: 0.2812 - 69s/epoch - 41ms/step
Epoch 13/50
1701/1701 - 68s - loss: 3.2612 - accuracy500: 0.3874 - val_loss: 3.4495 - val_accuracy500: 0.2909 - 68s/epoch - 40ms/step
Epoch 14/50
1701/1701 - 67s - loss: 3.2456 - accuracy500: 0.3994 - val_loss: 3.6814 - val_accuracy500: 0.2790 - 67s/epoch - 39ms/step
Epoch 15/50
1701/1701 - 68s - loss: 3.2504 - accuracy500: 0.3948 - val_loss: 3.5423 - val_accuracy500: 0.2828 - 68s/epoch - 40ms/step
Epoch 16/50
1701/1701 - 69s - loss: 3.2474 - accuracy500: 0.3987 - val_loss: 3.4810 - val_accuracy500: 0.2955 - 69s/epoch - 41ms/step
Epoch 17/50
1701/1701 - 69s - loss: 3.2266 - accuracy500: 0.4127 - val_loss: 3.4994 - val_accuracy500: 0.2986 - 69s/epoch - 40ms/step
Epoch 18/50
1701/1701 - 69s - loss: 3.2134 - accuracy500: 0.4186 - val_loss: 3.5100 - val_accuracy500: 0.3063 - 69s/epoch - 40ms/step
Epoch 19/50
1701/1701 - 69s - loss: 3.2007 - accuracy500: 0.4254 - val_loss: 3.5929 - val_accuracy500: 0.3057 - 69s/epoch - 40ms/step
Epoch 20/50
1701/1701 - 70s - loss: 3.1912 - accuracy500: 0.4307 - val_loss: 3.5187 - val_accuracy500: 0.3108 - 70s/epoch - 41ms/step
testing model: results/AAL/W5/deepVOL_L3/h500
Evaluating performance on  test set...
6357/6357 - 122s - 122s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.127054
{'0': {'precision': 0.38461538461538464, 'recall': 4.1136350547524826e-05, 'f1-score': 8.226390259953932e-05, 'support': 607735}, '1': {'precision': 0.25482509430048306, 'recall': 0.7247296395916962, 'f1-score': 0.37706785003733534, 'support': 415279}, '2': {'precision': 0.38296651189694175, 'recall': 0.28273870116112587, 'f1-score': 0.3253075146115861, 'support': 604155}, 'accuracy': 0.28995635978807366, 'macro avg': {'precision': 0.3408023302709364, 'recall': 0.33583649236778984, 'f1-score': 0.234152542850507, 'support': 1627169}, 'weighted avg': {'precision': 0.3508786574107164, 'recall': 0.28995635978807366, 'f1-score': 0.2170484539950452, 'support': 1627169}}
[[    25 446787 160923]
 [    16 300965 114298]
 [    24 433313 170818]]
Evaluating performance on  train set...
1701/1701 - 33s - 33s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1026613
{'0': {'precision': 0.3333333333333333, 'recall': 6.877106113747335e-05, 'f1-score': 0.0001375137513751375, 'support': 145410}, '1': {'precision': 0.34834048850996685, 'recall': 0.8247987073637993, 'f1-score': 0.4898153359056475, 'support': 146677}, '2': {'precision': 0.39514343773769117, 'recall': 0.24284348814980708, 'f1-score': 0.3008149754988808, 'support': 143331}, 'accuracy': 0.35780789953561865, 'macro avg': {'precision': 0.3589390865269971, 'recall': 0.35590365552491465, 'f1-score': 0.26358927505196783, 'support': 435418}, 'weighted avg': {'precision': 0.35873538050231596, 'recall': 0.35780789953561865, 'f1-score': 0.2640698160215017, 'support': 435418}}
[[    10 117804  27596]
 [    14 120979  25684]
 [     6 108518  34807]]
Evaluating performance on  val set...
563/563 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1232442
{'0': {'precision': 0.125, 'recall': 1.892362425251684e-05, 'f1-score': 3.784151971543177e-05, 'support': 52844}, '1': {'precision': 0.28351846237240796, 'recall': 0.7756830807128673, 'f1-score': 0.41525708826181157, 'support': 39783}, '2': {'precision': 0.3729266075891843, 'recall': 0.2552885363198009, 'f1-score': 0.30309325946445065, 'support': 51432}, 'accuracy': 0.30536099792446153, 'macro avg': {'precision': 0.2604816899871974, 'recall': 0.3436635135523069, 'f1-score': 0.2394627297486592, 'support': 144059}, 'weighted avg': {'precision': 0.257290945168913, 'recall': 0.30536099792446153, 'f1-score': 0.22290079037313265, 'support': 144059}}
[[    1 39686 13157]
 [    3 30859  8921]
 [    4 38298 13130]]
training model: results/AAL/W5/deepVOL_L3/h1000
Epoch 1/50
1701/1701 - 72s - loss: 3.2602 - accuracy1000: 0.3977 - val_loss: 3.3450 - val_accuracy1000: 0.3358 - 72s/epoch - 42ms/step
Epoch 2/50
1701/1701 - 71s - loss: 3.2679 - accuracy1000: 0.3880 - val_loss: 3.3220 - val_accuracy1000: 0.3348 - 71s/epoch - 42ms/step
Epoch 3/50
1701/1701 - 69s - loss: 3.2652 - accuracy1000: 0.3932 - val_loss: 3.3301 - val_accuracy1000: 0.3297 - 69s/epoch - 40ms/step
Epoch 4/50
1701/1701 - 69s - loss: 3.2725 - accuracy1000: 0.3845 - val_loss: 3.2992 - val_accuracy1000: 0.3689 - 69s/epoch - 40ms/step
Epoch 5/50
1701/1701 - 68s - loss: 3.2683 - accuracy1000: 0.3872 - val_loss: 3.2982 - val_accuracy1000: 0.3742 - 68s/epoch - 40ms/step
Epoch 6/50
1701/1701 - 70s - loss: 3.2574 - accuracy1000: 0.3935 - val_loss: 3.3431 - val_accuracy1000: 0.3206 - 70s/epoch - 41ms/step
Epoch 7/50
1701/1701 - 70s - loss: 3.2476 - accuracy1000: 0.3988 - val_loss: 3.3272 - val_accuracy1000: 0.3652 - 70s/epoch - 41ms/step
Epoch 8/50
1701/1701 - 70s - loss: 3.2409 - accuracy1000: 0.4028 - val_loss: 3.3220 - val_accuracy1000: 0.3541 - 70s/epoch - 41ms/step
Epoch 9/50
1701/1701 - 70s - loss: 3.2318 - accuracy1000: 0.4084 - val_loss: 3.3485 - val_accuracy1000: 0.3588 - 70s/epoch - 41ms/step
Epoch 10/50
1701/1701 - 68s - loss: 3.2250 - accuracy1000: 0.4119 - val_loss: 3.3493 - val_accuracy1000: 0.3553 - 68s/epoch - 40ms/step
Epoch 11/50
1701/1701 - 69s - loss: 3.2165 - accuracy1000: 0.4164 - val_loss: 3.3558 - val_accuracy1000: 0.3481 - 69s/epoch - 41ms/step
Epoch 12/50
1701/1701 - 69s - loss: 3.2093 - accuracy1000: 0.4203 - val_loss: 3.3461 - val_accuracy1000: 0.3428 - 69s/epoch - 40ms/step
Epoch 13/50
1701/1701 - 68s - loss: 3.1954 - accuracy1000: 0.4283 - val_loss: 3.3424 - val_accuracy1000: 0.3524 - 68s/epoch - 40ms/step
Epoch 14/50
1701/1701 - 68s - loss: 3.1872 - accuracy1000: 0.4318 - val_loss: 3.3490 - val_accuracy1000: 0.3389 - 68s/epoch - 40ms/step
Epoch 15/50
1701/1701 - 70s - loss: 3.1762 - accuracy1000: 0.4355 - val_loss: 3.3412 - val_accuracy1000: 0.3318 - 70s/epoch - 41ms/step
testing model: results/AAL/W5/deepVOL_L3/h1000
Evaluating performance on  test set...
6357/6357 - 125s - 125s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990814
{'0': {'precision': 0.4193647683129856, 'recall': 0.43967394186407677, 'f1-score': 0.42927928294426, 'support': 660005}, '1': {'precision': 0.16302400573271228, 'recall': 0.0014872294386444312, 'f1-score': 0.0029475689034719767, 'support': 305938}, '2': {'precision': 0.41061657425381537, 'recall': 0.5790198812508885, 'f1-score': 0.48048989857156843, 'support': 661226}, 'accuracy': 0.41391213819830636, 'macro avg': {'precision': 0.33100178276650444, 'recall': 0.34006035085120323, 'f1-score': 0.30423891680643345, 'support': 1627169}, 'weighted avg': {'precision': 0.36761297511433655, 'recall': 0.41391213819830636, 'f1-score': 0.3699312487809814, 'support': 1627169}}
[[290187   1201 368617]
 [124553    455 180930]
 [277228   1135 382863]]
Evaluating performance on  train set...
1701/1701 - 34s - 34s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007186
{'0': {'precision': 0.35280292657006807, 'recall': 0.46520025600431164, 'f1-score': 0.4012796410961213, 'support': 148435}, '1': {'precision': 0.315035799522673, 'recall': 0.0018492834026814608, 'f1-score': 0.003676982645756149, 'support': 142758}, '2': {'precision': 0.3428216163713702, 'recall': 0.567758710348414, 'f1-score': 0.4275074984141735, 'support': 144225}, 'accuracy': 0.3472548218034165, 'macro avg': {'precision': 0.33688678082137047, 'recall': 0.3449360832518023, 'f1-score': 0.27748804071868366, 'support': 435418}, 'weighted avg': {'precision': 0.3371142917721515, 'recall': 0.3472548218034165, 'f1-score': 0.2796074833227607, 'support': 435418}}
[[69052   323 79060]
 [64583   264 77911]
 [62089   251 81885]]
Evaluating performance on  val set...
563/563 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1015198
{'0': {'precision': 0.388692515779982, 'recall': 0.40356133091167823, 'f1-score': 0.39598739630891905, 'support': 53407}, '1': {'precision': 0.22264150943396227, 'recall': 0.001472019161198573, 'f1-score': 0.002924701333465523, 'support': 40081}, '2': {'precision': 0.36512949379697546, 'recall': 0.637855688042554, 'f1-score': 0.4644134902638304, 'support': 50571}, 'accuracy': 0.37393706745153027, 'macro avg': {'precision': 0.3254878396703066, 'recall': 0.3476296793718103, 'f1-score': 0.2877751959687383, 'support': 144059}, 'weighted avg': {'precision': 0.33422111191033527, 'recall': 0.37393706745153027, 'f1-score': 0.31064757109898883, 'support': 144059}}
[[21553   109 31745]
 [15680    59 24342]
 [18217    97 32257]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        26 (peak)  16.04 (ave)

============================================
