This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAL_orderbooks/AAL_orderbooks_2019-10-09.csv
data/AAL_orderbooks/AAL_orderbooks_2019-10-01.csv
data/AAL_orderbooks/AAL_orderbooks_2019-09-18.csv
data/AAL_orderbooks/AAL_orderbooks_2019-09-19.csv
data/AAL_orderbooks/AAL_orderbooks_2019-09-27.csv
data/AAL_orderbooks/AAL_orderbooks_2019-09-23.csv
data/AAL_orderbooks/AAL_orderbooks_2019-09-25.csv
data/AAL_orderbooks/AAL_orderbooks_2019-09-20.csv
data/AAL_orderbooks/AAL_orderbooks_2019-10-11.csv
data/AAL_orderbooks/AAL_orderbooks_2019-09-24.csv
data/AAL_orderbooks/AAL_orderbooks_2019-10-07.csv
data/AAL_orderbooks/AAL_orderbooks_2019-09-26.csv
data/AAL_orderbooks/AAL_orderbooks_2019-09-17.csv
data/AAL_orderbooks/AAL_orderbooks_2019-10-03.csv
data/AAL_orderbooks/AAL_orderbooks_2019-10-02.csv
training model: results/AAL/W7/deepLOB_L1/h10
Epoch 1/50
2013/2013 - 57s - loss: 2.8419 - accuracy10: 0.4493 - val_loss: 3.0099 - val_accuracy10: 0.3249 - 57s/epoch - 28ms/step
Epoch 2/50
2013/2013 - 47s - loss: 2.7164 - accuracy10: 0.4775 - val_loss: 2.6170 - val_accuracy10: 0.4921 - 47s/epoch - 24ms/step
Epoch 3/50
2013/2013 - 49s - loss: 2.5874 - accuracy10: 0.5277 - val_loss: 2.7918 - val_accuracy10: 0.7028 - 49s/epoch - 24ms/step
Epoch 4/50
2013/2013 - 48s - loss: 2.5124 - accuracy10: 0.5635 - val_loss: 2.5280 - val_accuracy10: 0.6013 - 48s/epoch - 24ms/step
Epoch 5/50
2013/2013 - 48s - loss: 2.4547 - accuracy10: 0.5826 - val_loss: 2.5499 - val_accuracy10: 0.6619 - 48s/epoch - 24ms/step
Epoch 6/50
2013/2013 - 48s - loss: 2.4093 - accuracy10: 0.5984 - val_loss: 2.5478 - val_accuracy10: 0.7309 - 48s/epoch - 24ms/step
Epoch 7/50
2013/2013 - 49s - loss: 2.3763 - accuracy10: 0.6083 - val_loss: 2.4858 - val_accuracy10: 0.7071 - 49s/epoch - 24ms/step
Epoch 8/50
2013/2013 - 48s - loss: 2.3440 - accuracy10: 0.6175 - val_loss: 2.5267 - val_accuracy10: 0.7142 - 48s/epoch - 24ms/step
Epoch 9/50
2013/2013 - 48s - loss: 2.3231 - accuracy10: 0.6220 - val_loss: 2.6354 - val_accuracy10: 0.7185 - 48s/epoch - 24ms/step
Epoch 10/50
2013/2013 - 47s - loss: 2.3016 - accuracy10: 0.6259 - val_loss: 2.5241 - val_accuracy10: 0.7167 - 47s/epoch - 23ms/step
Epoch 11/50
2013/2013 - 49s - loss: 2.2800 - accuracy10: 0.6291 - val_loss: 2.6170 - val_accuracy10: 0.7390 - 49s/epoch - 24ms/step
Epoch 12/50
2013/2013 - 48s - loss: 2.2650 - accuracy10: 0.6319 - val_loss: 2.5006 - val_accuracy10: 0.7147 - 48s/epoch - 24ms/step
Epoch 13/50
2013/2013 - 47s - loss: 2.2521 - accuracy10: 0.6350 - val_loss: 2.5107 - val_accuracy10: 0.7294 - 47s/epoch - 23ms/step
Epoch 14/50
2013/2013 - 48s - loss: 2.2418 - accuracy10: 0.6375 - val_loss: 2.5344 - val_accuracy10: 0.7167 - 48s/epoch - 24ms/step
Epoch 15/50
2013/2013 - 48s - loss: 2.2336 - accuracy10: 0.6382 - val_loss: 2.5097 - val_accuracy10: 0.7089 - 48s/epoch - 24ms/step
Epoch 16/50
2013/2013 - 48s - loss: 2.2236 - accuracy10: 0.6399 - val_loss: 2.5030 - val_accuracy10: 0.7249 - 48s/epoch - 24ms/step
Epoch 17/50
2013/2013 - 48s - loss: 2.2137 - accuracy10: 0.6422 - val_loss: 2.4373 - val_accuracy10: 0.7162 - 48s/epoch - 24ms/step
Epoch 18/50
2013/2013 - 48s - loss: 2.2091 - accuracy10: 0.6431 - val_loss: 2.4780 - val_accuracy10: 0.7149 - 48s/epoch - 24ms/step
Epoch 19/50
2013/2013 - 48s - loss: 2.2027 - accuracy10: 0.6438 - val_loss: 2.4595 - val_accuracy10: 0.7019 - 48s/epoch - 24ms/step
Epoch 20/50
2013/2013 - 48s - loss: 2.1939 - accuracy10: 0.6450 - val_loss: 2.4614 - val_accuracy10: 0.7125 - 48s/epoch - 24ms/step
Epoch 21/50
2013/2013 - 49s - loss: 2.1895 - accuracy10: 0.6450 - val_loss: 2.4630 - val_accuracy10: 0.7260 - 49s/epoch - 24ms/step
Epoch 22/50
2013/2013 - 48s - loss: 2.1835 - accuracy10: 0.6476 - val_loss: 2.4436 - val_accuracy10: 0.7159 - 48s/epoch - 24ms/step
Epoch 23/50
2013/2013 - 46s - loss: 2.1796 - accuracy10: 0.6471 - val_loss: 2.4918 - val_accuracy10: 0.7227 - 46s/epoch - 23ms/step
Epoch 24/50
2013/2013 - 47s - loss: 2.1732 - accuracy10: 0.6489 - val_loss: 2.4311 - val_accuracy10: 0.7068 - 47s/epoch - 23ms/step
Epoch 25/50
2013/2013 - 48s - loss: 2.1674 - accuracy10: 0.6489 - val_loss: 2.4087 - val_accuracy10: 0.7107 - 48s/epoch - 24ms/step
Epoch 26/50
2013/2013 - 46s - loss: 2.1622 - accuracy10: 0.6500 - val_loss: 2.4127 - val_accuracy10: 0.7129 - 46s/epoch - 23ms/step
Epoch 27/50
2013/2013 - 47s - loss: 2.1581 - accuracy10: 0.6514 - val_loss: 2.3703 - val_accuracy10: 0.7032 - 47s/epoch - 24ms/step
Epoch 28/50
2013/2013 - 48s - loss: 2.1540 - accuracy10: 0.6509 - val_loss: 2.3846 - val_accuracy10: 0.7102 - 48s/epoch - 24ms/step
Epoch 29/50
2013/2013 - 48s - loss: 2.1492 - accuracy10: 0.6521 - val_loss: 2.3907 - val_accuracy10: 0.6954 - 48s/epoch - 24ms/step
Epoch 30/50
2013/2013 - 48s - loss: 2.1451 - accuracy10: 0.6526 - val_loss: 2.4401 - val_accuracy10: 0.7257 - 48s/epoch - 24ms/step
Epoch 31/50
2013/2013 - 48s - loss: 2.1418 - accuracy10: 0.6528 - val_loss: 2.3898 - val_accuracy10: 0.7023 - 48s/epoch - 24ms/step
Epoch 32/50
2013/2013 - 48s - loss: 2.1394 - accuracy10: 0.6526 - val_loss: 2.4109 - val_accuracy10: 0.6851 - 48s/epoch - 24ms/step
Epoch 33/50
2013/2013 - 47s - loss: 2.1357 - accuracy10: 0.6526 - val_loss: 2.4238 - val_accuracy10: 0.6823 - 47s/epoch - 23ms/step
Epoch 34/50
2013/2013 - 48s - loss: 2.1321 - accuracy10: 0.6536 - val_loss: 2.4074 - val_accuracy10: 0.6894 - 48s/epoch - 24ms/step
Epoch 35/50
2013/2013 - 47s - loss: 2.1267 - accuracy10: 0.6535 - val_loss: 2.3655 - val_accuracy10: 0.7037 - 47s/epoch - 24ms/step
Epoch 36/50
2013/2013 - 47s - loss: 2.1225 - accuracy10: 0.6547 - val_loss: 2.3949 - val_accuracy10: 0.6983 - 47s/epoch - 23ms/step
Epoch 37/50
2013/2013 - 47s - loss: 2.1205 - accuracy10: 0.6556 - val_loss: 2.3901 - val_accuracy10: 0.7010 - 47s/epoch - 23ms/step
Epoch 38/50
2013/2013 - 48s - loss: 2.1182 - accuracy10: 0.6555 - val_loss: 2.3948 - val_accuracy10: 0.6869 - 48s/epoch - 24ms/step
Epoch 39/50
2013/2013 - 48s - loss: 2.1127 - accuracy10: 0.6561 - val_loss: 2.4092 - val_accuracy10: 0.6934 - 48s/epoch - 24ms/step
Epoch 40/50
2013/2013 - 48s - loss: 2.1099 - accuracy10: 0.6558 - val_loss: 2.4085 - val_accuracy10: 0.6846 - 48s/epoch - 24ms/step
Epoch 41/50
2013/2013 - 48s - loss: 2.1064 - accuracy10: 0.6555 - val_loss: 2.3953 - val_accuracy10: 0.6872 - 48s/epoch - 24ms/step
Epoch 42/50
2013/2013 - 49s - loss: 2.1017 - accuracy10: 0.6568 - val_loss: 2.4237 - val_accuracy10: 0.6934 - 49s/epoch - 24ms/step
Epoch 43/50
2013/2013 - 47s - loss: 2.0979 - accuracy10: 0.6577 - val_loss: 2.4145 - val_accuracy10: 0.6954 - 47s/epoch - 23ms/step
Epoch 44/50
2013/2013 - 46s - loss: 2.0943 - accuracy10: 0.6570 - val_loss: 2.5009 - val_accuracy10: 0.6820 - 46s/epoch - 23ms/step
Epoch 45/50
2013/2013 - 46s - loss: 2.0903 - accuracy10: 0.6573 - val_loss: 2.3913 - val_accuracy10: 0.6798 - 46s/epoch - 23ms/step
testing model: results/AAL/W7/deepLOB_L1/h10
Evaluating performance on  test set...
5331/5331 - 78s - 78s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67574817
{'0': {'precision': 0.3345525202880329, 'recall': 0.4412119384986434, 'f1-score': 0.3805499577455632, 'support': 145948}, '1': {'precision': 0.8468913066318013, 'recall': 0.8130896898261869, 'f1-score': 0.8296463529342253, 'support': 1070690}, '2': {'precision': 0.3273381793968316, 'recall': 0.31894058174740486, 'f1-score': 0.32308482234545083, 'support': 147968}, 'accuracy': 0.7197344874637808, 'macro avg': {'precision': 0.5029273354388886, 'recall': 0.5244140700240784, 'f1-score': 0.511093711008413, 'support': 1364606}, 'weighted avg': {'precision': 0.7357588198040985, 'recall': 0.7197344874637808, 'f1-score': 0.726686511600423, 'support': 1364606}}
[[ 64394  72683   8871]
 [112015 870567  88108]
 [ 16069  84706  47193]]
Evaluating performance on  train set...
2013/2013 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72389
{'0': {'precision': 0.4109743493375928, 'recall': 0.3265982706867972, 'f1-score': 0.3639601258133769, 'support': 66963}, '1': {'precision': 0.8287164287843163, 'recall': 0.7844175452161284, 'f1-score': 0.8059587327829606, 'support': 382828}, '2': {'precision': 0.3436375121574604, 'recall': 0.5230689397292471, 'f1-score': 0.4147796725041451, 'support': 65521}, 'accuracy': 0.6916955165026236, 'macro avg': {'precision': 0.5277760967597899, 'recall': 0.5446949185440575, 'f1-score': 0.5282328437001609, 'support': 515312}, 'weighted avg': {'precision': 0.712755382733964, 'recall': 0.6916955165026236, 'f1-score': 0.6987848343931841, 'support': 515312}}
[[ 21870  35486   9607]
 [ 26677 300297  55854]
 [  4668  26581  34272]]
Evaluating performance on  val set...
696/696 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6733007
{'0': {'precision': 0.39677595452939857, 'recall': 0.5751256749208713, 'f1-score': 0.46958669833729216, 'support': 21484}, '1': {'precision': 0.8888221419295564, 'recall': 0.7417411882662578, 'f1-score': 0.8086481273107218, 'support': 135643}, '2': {'precision': 0.36634812896311514, 'recall': 0.5915777329102971, 'f1-score': 0.4524846947217473, 'support': 20802}, 'accuracy': 0.7040673527081027, 'macro avg': {'precision': 0.5506487418073568, 'recall': 0.6361481986991421, 'f1-score': 0.5769065067899204, 'support': 177929}, 'weighted avg': {'precision': 0.7683267493413167, 'recall': 0.7040673527081027, 'f1-score': 0.7260685171022622, 'support': 177929}}
[[ 12356   6762   2366]
 [ 16112 100612  18919]
 [  2673   5823  12306]]
training model: results/AAL/W7/deepLOB_L1/h20
Epoch 1/50
2013/2013 - 50s - loss: 2.9062 - accuracy20: 0.4569 - val_loss: 2.9757 - val_accuracy20: 0.3872 - 50s/epoch - 25ms/step
Epoch 2/50
2013/2013 - 47s - loss: 2.8179 - accuracy20: 0.4703 - val_loss: 2.9622 - val_accuracy20: 0.5379 - 47s/epoch - 23ms/step
Epoch 3/50
2013/2013 - 47s - loss: 2.7142 - accuracy20: 0.5181 - val_loss: 3.4545 - val_accuracy20: 0.6673 - 47s/epoch - 23ms/step
Epoch 4/50
2013/2013 - 47s - loss: 2.6158 - accuracy20: 0.5585 - val_loss: 3.4291 - val_accuracy20: 0.6845 - 47s/epoch - 24ms/step
Epoch 5/50
2013/2013 - 47s - loss: 2.5632 - accuracy20: 0.5757 - val_loss: 3.6298 - val_accuracy20: 0.5959 - 47s/epoch - 23ms/step
Epoch 6/50
2013/2013 - 47s - loss: 2.5237 - accuracy20: 0.5865 - val_loss: 3.6207 - val_accuracy20: 0.5793 - 47s/epoch - 23ms/step
Epoch 7/50
2013/2013 - 47s - loss: 2.4942 - accuracy20: 0.5954 - val_loss: 3.6339 - val_accuracy20: 0.5185 - 47s/epoch - 23ms/step
Epoch 8/50
2013/2013 - 46s - loss: 2.4666 - accuracy20: 0.6007 - val_loss: 3.4688 - val_accuracy20: 0.5928 - 46s/epoch - 23ms/step
Epoch 9/50
2013/2013 - 48s - loss: 2.4436 - accuracy20: 0.6049 - val_loss: 3.6624 - val_accuracy20: 0.4079 - 48s/epoch - 24ms/step
Epoch 10/50
2013/2013 - 48s - loss: 2.4275 - accuracy20: 0.6078 - val_loss: 3.7820 - val_accuracy20: 0.3093 - 48s/epoch - 24ms/step
Epoch 11/50
2013/2013 - 47s - loss: 2.4151 - accuracy20: 0.6105 - val_loss: 3.7160 - val_accuracy20: 0.3023 - 47s/epoch - 24ms/step
Epoch 12/50
2013/2013 - 49s - loss: 2.4027 - accuracy20: 0.6111 - val_loss: 3.9706 - val_accuracy20: 0.2664 - 49s/epoch - 24ms/step
testing model: results/AAL/W7/deepLOB_L1/h20
Evaluating performance on  test set...
5331/5331 - 70s - 70s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0081784
{'0': {'precision': 0.29182694214220567, 'recall': 0.29730029996667034, 'f1-score': 0.29453819560834305, 'support': 198022}, '1': {'precision': 0.7380103315480793, 'recall': 0.4021219395798978, 'f1-score': 0.5205889763273007, 'support': 966003}, '2': {'precision': 0.18933546575839602, 'recall': 0.600834575558004, 'f1-score': 0.2879362371610628, 'support': 200581}, 'accuracy': 0.416119378047583, 'macro avg': {'precision': 0.4063909131495604, 'recall': 0.43341893836819073, 'f1-score': 0.3676878030322355, 'support': 1364606}, 'weighted avg': {'precision': 0.592614605315093, 'recall': 0.416119378047583, 'f1-score': 0.45358887023496886, 'support': 1364606}}
[[ 58872  67721  71429]
 [132976 388451 444576]
 [  9888  70177 120516]]
Evaluating performance on  train set...
2013/2013 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92537355
{'0': {'precision': 0.3261293748610665, 'recall': 0.14929895974672094, 'f1-score': 0.20482908932962066, 'support': 88440}, '1': {'precision': 0.6674819025004108, 'recall': 0.7997207894311452, 'f1-score': 0.7276420046583894, 'support': 340245}, '2': {'precision': 0.24315190853331745, 'recall': 0.1885439874404054, 'f1-score': 0.21239409879127952, 'support': 86627}, 'accuracy': 0.5853502344210886, 'macro avg': {'precision': 0.4122543952982649, 'recall': 0.37918791220609055, 'f1-score': 0.3816217309264298, 'support': 515312}, 'weighted avg': {'precision': 0.5375651686929097, 'recall': 0.5853502344210886, 'f1-score': 0.5512984408111931, 'support': 515312}}
[[ 13204  68375   6861]
 [ 24166 272101  43978]
 [  3117  67177  16333]]
Evaluating performance on  val set...
696/696 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93579143
{'0': {'precision': 0.3530296127562642, 'recall': 0.27172312223858613, 'f1-score': 0.30708567805342, 'support': 28518}, '1': {'precision': 0.7182445843661263, 'recall': 0.6226300147365128, 'f1-score': 0.667028276093207, 'support': 121467}, '2': {'precision': 0.24537311076910934, 'recall': 0.4450329229888348, 'f1-score': 0.31633301961183324, 'support': 27944}, 'accuracy': 0.5384956921019058, 'macro avg': {'precision': 0.43888243596383325, 'recall': 0.4464620199879779, 'f1-score': 0.4301489912528201, 'support': 177929}, 'weighted avg': {'precision': 0.5854437423529352, 'recall': 0.5384956921019058, 'f1-score': 0.5542604234215562, 'support': 177929}}
[[ 7749 15730  5039]
 [12631 75629 33207]
 [ 1570 13938 12436]]
training model: results/AAL/W7/deepLOB_L1/h30
Epoch 1/50
2013/2013 - 49s - loss: 2.9811 - accuracy30: 0.4527 - val_loss: 3.1762 - val_accuracy30: 0.2776 - 49s/epoch - 24ms/step
Epoch 2/50
2013/2013 - 47s - loss: 2.8996 - accuracy30: 0.4656 - val_loss: 3.1193 - val_accuracy30: 0.4659 - 47s/epoch - 23ms/step
Epoch 3/50
2013/2013 - 47s - loss: 2.8159 - accuracy30: 0.5010 - val_loss: 2.8762 - val_accuracy30: 0.5638 - 47s/epoch - 24ms/step
Epoch 4/50
2013/2013 - 47s - loss: 2.7288 - accuracy30: 0.5396 - val_loss: 3.0015 - val_accuracy30: 0.5867 - 47s/epoch - 23ms/step
Epoch 5/50
2013/2013 - 47s - loss: 2.6815 - accuracy30: 0.5548 - val_loss: 3.1379 - val_accuracy30: 0.5824 - 47s/epoch - 23ms/step
Epoch 6/50
2013/2013 - 47s - loss: 2.6522 - accuracy30: 0.5636 - val_loss: 3.2472 - val_accuracy30: 0.6130 - 47s/epoch - 23ms/step
Epoch 7/50
2013/2013 - 47s - loss: 2.6260 - accuracy30: 0.5709 - val_loss: 3.4209 - val_accuracy30: 0.6340 - 47s/epoch - 23ms/step
Epoch 8/50
2013/2013 - 47s - loss: 2.6028 - accuracy30: 0.5760 - val_loss: 3.3198 - val_accuracy30: 0.6388 - 47s/epoch - 24ms/step
Epoch 9/50
2013/2013 - 47s - loss: 2.5831 - accuracy30: 0.5800 - val_loss: 3.5052 - val_accuracy30: 0.6357 - 47s/epoch - 23ms/step
Epoch 10/50
2013/2013 - 48s - loss: 2.5665 - accuracy30: 0.5834 - val_loss: 3.6471 - val_accuracy30: 0.6343 - 48s/epoch - 24ms/step
Epoch 11/50
2013/2013 - 48s - loss: 2.5521 - accuracy30: 0.5857 - val_loss: 3.9209 - val_accuracy30: 0.6311 - 48s/epoch - 24ms/step
Epoch 12/50
2013/2013 - 46s - loss: 2.5401 - accuracy30: 0.5887 - val_loss: 3.8953 - val_accuracy30: 0.6308 - 46s/epoch - 23ms/step
Epoch 13/50
2013/2013 - 47s - loss: 2.5289 - accuracy30: 0.5914 - val_loss: 3.7627 - val_accuracy30: 0.6335 - 47s/epoch - 24ms/step
testing model: results/AAL/W7/deepLOB_L1/h30
Evaluating performance on  test set...
5331/5331 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9068395
{'0': {'precision': 0.3342705177405238, 'recall': 0.5210676338845299, 'f1-score': 0.40727178467485, 'support': 238209}, '1': {'precision': 0.6983828788334001, 'recall': 0.6752109317163315, 'f1-score': 0.686601454797049, 'support': 884765}, '2': {'precision': 0.2660728791922943, 'recall': 0.1518176400476758, 'f1-score': 0.1933260255491378, 'support': 241632}, 'accuracy': 0.5556255798376968, 'macro avg': {'precision': 0.4329087585887394, 'recall': 0.44936540188284574, 'f1-score': 0.429066421673679, 'support': 1364606}, 'weighted avg': {'precision': 0.5582730073709761, 'recall': 0.5556255798376968, 'f1-score': 0.5504962567324281, 'support': 1364606}}
[[124123  97869  16217]
 [202391 597403  84971]
 [ 44811 160137  36684]]
Evaluating performance on  train set...
2013/2013 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91427135
{'0': {'precision': 0.35729352913996426, 'recall': 0.3390105124710502, 'f1-score': 0.3479119901015762, 'support': 104923}, '1': {'precision': 0.6412704703401225, 'recall': 0.7364643003439599, 'f1-score': 0.6855787025477832, 'support': 307594}, '2': {'precision': 0.39639697294529863, 'recall': 0.24102339607957585, 'f1-score': 0.2997737419690498, 'support': 102795}, 'accuracy': 0.5567073928028068, 'macro avg': {'precision': 0.4649869908084618, 'recall': 0.43883273629819536, 'f1-score': 0.4444214782061364, 'support': 515312}, 'weighted avg': {'precision': 0.5346021145357843, 'recall': 0.5567073928028068, 'f1-score': 0.5398653766545685, 'support': 515312}}
[[ 35570  62013   7340]
 [ 50675 226532  30387]
 [ 13309  64710  24776]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89714444
{'0': {'precision': 0.3472476208247807, 'recall': 0.5457504838993489, 'f1-score': 0.4244366389927926, 'support': 34098}, '1': {'precision': 0.6964542904790783, 'recall': 0.6663131175777355, 'f1-score': 0.6810503785106048, 'support': 110310}, '2': {'precision': 0.43051640695633675, 'recall': 0.24149040899734495, 'f1-score': 0.3094182401957037, 'support': 33521}, 'accuracy': 0.5631740750524086, 'macro avg': {'precision': 0.4914061060867319, 'recall': 0.4845180034914764, 'f1-score': 0.47163508589970043, 'support': 177929}, 'weighted avg': {'precision': 0.579431473425995, 'recall': 0.5631740750524086, 'f1-score': 0.5618595990506395, 'support': 177929}}
[[18609 13276  2213]
 [28314 73501  8495]
 [ 6667 18759  8095]]
training model: results/AAL/W7/deepLOB_L1/h50
Epoch 1/50
2013/2013 - 49s - loss: 3.0589 - accuracy50: 0.4516 - val_loss: 3.3780 - val_accuracy50: 0.4269 - 49s/epoch - 25ms/step
Epoch 2/50
2013/2013 - 46s - loss: 3.0283 - accuracy50: 0.4535 - val_loss: 3.1538 - val_accuracy50: 0.3463 - 46s/epoch - 23ms/step
Epoch 3/50
2013/2013 - 47s - loss: 2.9907 - accuracy50: 0.4708 - val_loss: 3.0906 - val_accuracy50: 0.5159 - 47s/epoch - 23ms/step
Epoch 4/50
2013/2013 - 46s - loss: 2.9209 - accuracy50: 0.4993 - val_loss: 3.4543 - val_accuracy50: 0.5329 - 46s/epoch - 23ms/step
Epoch 5/50
2013/2013 - 47s - loss: 2.8761 - accuracy50: 0.5182 - val_loss: 3.8608 - val_accuracy50: 0.5086 - 47s/epoch - 23ms/step
Epoch 6/50
2013/2013 - 47s - loss: 2.8372 - accuracy50: 0.5301 - val_loss: 4.4345 - val_accuracy50: 0.2729 - 47s/epoch - 23ms/step
Epoch 7/50
2013/2013 - 46s - loss: 2.8072 - accuracy50: 0.5386 - val_loss: 4.2027 - val_accuracy50: 0.2804 - 46s/epoch - 23ms/step
Epoch 8/50
2013/2013 - 47s - loss: 2.7850 - accuracy50: 0.5438 - val_loss: 4.5067 - val_accuracy50: 0.2676 - 47s/epoch - 23ms/step
Epoch 9/50
2013/2013 - 46s - loss: 2.7676 - accuracy50: 0.5488 - val_loss: 4.2056 - val_accuracy50: 0.3308 - 46s/epoch - 23ms/step
Epoch 10/50
2013/2013 - 47s - loss: 2.7546 - accuracy50: 0.5511 - val_loss: 4.0146 - val_accuracy50: 0.4216 - 47s/epoch - 23ms/step
Epoch 11/50
2013/2013 - 47s - loss: 2.7428 - accuracy50: 0.5537 - val_loss: 4.3594 - val_accuracy50: 0.3923 - 47s/epoch - 23ms/step
Epoch 12/50
2013/2013 - 46s - loss: 2.7321 - accuracy50: 0.5555 - val_loss: 4.6461 - val_accuracy50: 0.3047 - 46s/epoch - 23ms/step
Epoch 13/50
2013/2013 - 46s - loss: 2.7223 - accuracy50: 0.5571 - val_loss: 4.4731 - val_accuracy50: 0.3474 - 46s/epoch - 23ms/step
testing model: results/AAL/W7/deepLOB_L1/h50
Evaluating performance on  test set...
5331/5331 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9611826
{'0': {'precision': 0.4161022698868032, 'recall': 0.350061918574571, 'f1-score': 0.3802358844579479, 'support': 299587}, '1': {'precision': 0.5959219938257662, 'recall': 0.7802397570882132, 'f1-score': 0.67573747257157, 'support': 760770}, '2': {'precision': 0.3654070665796793, 'recall': 0.13990843026599922, 'f1-score': 0.20234300911962463, 'support': 304249}, 'accuracy': 0.5430314684238527, 'macro avg': {'precision': 0.4591437767640829, 'recall': 0.42340336864292777, 'f1-score': 0.41943878871638085, 'support': 1364606}, 'weighted avg': {'precision': 0.5050491794490181, 'recall': 0.5430314684238527, 'f1-score': 0.505315954280586, 'support': 1364606}}
[[104874 175065  19648]
 [112910 593583  54277]
 [ 34255 227427  42567]]
Evaluating performance on  train set...
2013/2013 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0152798
{'0': {'precision': 0.4119558866491382, 'recall': 0.2599149053821578, 'f1-score': 0.3187323413072142, 'support': 130208}, '1': {'precision': 0.5474879028106662, 'recall': 0.6603132227171837, 'f1-score': 0.5986308405625796, 'support': 257708}, '2': {'precision': 0.3637039822140849, 'recall': 0.3492809821344469, 'f1-score': 0.3563466004644831, 'support': 127396}, 'accuracy': 0.48224764802682646, 'macro avg': {'precision': 0.4410492572246298, 'recall': 0.42316970341126287, 'f1-score': 0.42456992744475897, 'support': 515312}, 'weighted avg': {'precision': 0.4678066822905108, 'recall': 0.48224764802682646, 'f1-score': 0.4680088739819843, 'support': 515312}}
[[ 33843  71104  25261]
 [ 34954 170168  52586]
 [ 13355  69544  44497]]
Evaluating performance on  val set...
696/696 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9868119
{'0': {'precision': 0.4416320841384991, 'recall': 0.3254049764250035, 'f1-score': 0.37471273636253677, 'support': 42842}, '1': {'precision': 0.5686654918838321, 'recall': 0.7217837326336617, 'f1-score': 0.636140490541719, 'support': 92996}, '2': {'precision': 0.373684953752736, 'recall': 0.25147893849041364, 'f1-score': 0.30063763011772726, 'support': 42091}, 'accuracy': 0.5150874787134194, 'macro avg': {'precision': 0.4613275099250224, 'recall': 0.4328892158496929, 'f1-score': 0.43716361900732775, 'support': 177929}, 'weighted avg': {'precision': 0.4919534826829626, 'recall': 0.5150874787134194, 'f1-score': 0.4938267657264794, 'support': 177929}}
[[13941 23807  5094]
 [13226 67123 12647]
 [ 4400 27106 10585]]
training model: results/AAL/W7/deepLOB_L1/h100
Epoch 1/50
2013/2013 - 49s - loss: 3.1704 - accuracy100: 0.4334 - val_loss: 3.5009 - val_accuracy100: 0.3532 - 49s/epoch - 24ms/step
Epoch 2/50
2013/2013 - 45s - loss: 3.1432 - accuracy100: 0.4408 - val_loss: 3.5761 - val_accuracy100: 0.3593 - 45s/epoch - 23ms/step
Epoch 3/50
2013/2013 - 45s - loss: 3.1096 - accuracy100: 0.4527 - val_loss: 3.3903 - val_accuracy100: 0.3871 - 45s/epoch - 22ms/step
Epoch 4/50
2013/2013 - 46s - loss: 3.0904 - accuracy100: 0.4599 - val_loss: 3.3924 - val_accuracy100: 0.3869 - 46s/epoch - 23ms/step
Epoch 5/50
2013/2013 - 47s - loss: 3.0728 - accuracy100: 0.4669 - val_loss: 3.4831 - val_accuracy100: 0.3867 - 47s/epoch - 23ms/step
Epoch 6/50
2013/2013 - 46s - loss: 3.0600 - accuracy100: 0.4709 - val_loss: 3.5154 - val_accuracy100: 0.3859 - 46s/epoch - 23ms/step
Epoch 7/50
2013/2013 - 46s - loss: 3.0472 - accuracy100: 0.4756 - val_loss: 3.5339 - val_accuracy100: 0.3860 - 46s/epoch - 23ms/step
Epoch 8/50
2013/2013 - 46s - loss: 3.0347 - accuracy100: 0.4796 - val_loss: 3.5130 - val_accuracy100: 0.3861 - 46s/epoch - 23ms/step
Epoch 9/50
2013/2013 - 46s - loss: 3.0254 - accuracy100: 0.4833 - val_loss: 3.3542 - val_accuracy100: 0.3858 - 46s/epoch - 23ms/step
Epoch 10/50
2013/2013 - 47s - loss: 3.0154 - accuracy100: 0.4850 - val_loss: 3.3613 - val_accuracy100: 0.3820 - 47s/epoch - 24ms/step
Epoch 11/50
2013/2013 - 48s - loss: 3.0075 - accuracy100: 0.4870 - val_loss: 3.3518 - val_accuracy100: 0.3795 - 48s/epoch - 24ms/step
Epoch 12/50
2013/2013 - 47s - loss: 3.0007 - accuracy100: 0.4885 - val_loss: 3.3742 - val_accuracy100: 0.3737 - 47s/epoch - 24ms/step
Epoch 13/50
2013/2013 - 47s - loss: 2.9944 - accuracy100: 0.4896 - val_loss: 3.3448 - val_accuracy100: 0.3622 - 47s/epoch - 23ms/step
Epoch 14/50
2013/2013 - 47s - loss: 2.9892 - accuracy100: 0.4915 - val_loss: 3.3697 - val_accuracy100: 0.3554 - 47s/epoch - 23ms/step
Epoch 15/50
2013/2013 - 44s - loss: 2.9836 - accuracy100: 0.4931 - val_loss: 3.3658 - val_accuracy100: 0.3669 - 44s/epoch - 22ms/step
Epoch 16/50
2013/2013 - 46s - loss: 2.9783 - accuracy100: 0.4938 - val_loss: 3.3964 - val_accuracy100: 0.3562 - 46s/epoch - 23ms/step
Epoch 17/50
2013/2013 - 46s - loss: 2.9730 - accuracy100: 0.4951 - val_loss: 3.4093 - val_accuracy100: 0.3608 - 46s/epoch - 23ms/step
Epoch 18/50
2013/2013 - 46s - loss: 2.9697 - accuracy100: 0.4960 - val_loss: 3.4087 - val_accuracy100: 0.3606 - 46s/epoch - 23ms/step
Epoch 19/50
2013/2013 - 47s - loss: 2.9645 - accuracy100: 0.4976 - val_loss: 3.4835 - val_accuracy100: 0.3485 - 47s/epoch - 23ms/step
Epoch 20/50
2013/2013 - 45s - loss: 2.9597 - accuracy100: 0.4983 - val_loss: 3.5434 - val_accuracy100: 0.3406 - 45s/epoch - 23ms/step
Epoch 21/50
2013/2013 - 46s - loss: 2.9546 - accuracy100: 0.5001 - val_loss: 3.5539 - val_accuracy100: 0.3401 - 46s/epoch - 23ms/step
Epoch 22/50
2013/2013 - 46s - loss: 2.9525 - accuracy100: 0.5004 - val_loss: 3.5623 - val_accuracy100: 0.3429 - 46s/epoch - 23ms/step
Epoch 23/50
2013/2013 - 46s - loss: 2.9493 - accuracy100: 0.5013 - val_loss: 3.4642 - val_accuracy100: 0.3586 - 46s/epoch - 23ms/step
testing model: results/AAL/W7/deepLOB_L1/h100
Evaluating performance on  test set...
5331/5331 - 80s - 80s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1082541
{'0': {'precision': 0.28417408667437155, 'recall': 0.13564796228907394, 'f1-score': 0.18363797655655567, 'support': 386095}, '1': {'precision': 0.4337897996381697, 'recall': 0.5474480642640065, 'f1-score': 0.48403632767490185, 'support': 584713}, '2': {'precision': 0.2997612976726523, 'recall': 0.336751329361754, 'f1-score': 0.31718150181178917, 'support': 393798}, 'accuracy': 0.37013247779945274, 'macro avg': {'precision': 0.3392417279950645, 'recall': 0.33994911863827815, 'f1-score': 0.3282852686810822, 'support': 1364606}, 'weighted avg': {'precision': 0.3527803106620297, 'recall': 0.3701324777994528, 'f1-score': 0.3508921101569663, 'support': 1364606}}
[[ 52373 207927 125795]
 [ 80628 320100 183985]
 [ 51298 209888 132612]]
Evaluating performance on  train set...
2013/2013 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.10813
{'0': {'precision': 0.35966707094647765, 'recall': 0.23420609992102295, 'f1-score': 0.28368421436969204, 'support': 165871}, '1': {'precision': 0.3785450941526264, 'recall': 0.509090133606304, 'f1-score': 0.434217945686378, 'support': 187566}, '2': {'precision': 0.34686651488864956, 'recall': 0.33224401544401544, 'f1-score': 0.3393978405053546, 'support': 161875}, 'accuracy': 0.36505650945446644, 'macro avg': {'precision': 0.3616928933292512, 'recall': 0.3585134163237808, 'f1-score': 0.35243333352047485, 'support': 515312}, 'weighted avg': {'precision': 0.3625173544423473, 'recall': 0.36505650945446644, 'f1-score': 0.3559776076515405, 'support': 515312}}
[[38848 79451 47572]
 [38381 95488 53697]
 [30782 77311 53782]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1108348
{'0': {'precision': 0.3317340100717713, 'recall': 0.15245280268241126, 'f1-score': 0.2089019289593608, 'support': 54876}, '1': {'precision': 0.3941933150798161, 'recall': 0.5541643668477472, 'f1-score': 0.4606867071985317, 'support': 68846}, '2': {'precision': 0.3255789003129191, 'recall': 0.3358975778036047, 'f1-score': 0.33065775614716886, 'support': 54207}, 'accuracy': 0.36377431447375075, 'macro avg': {'precision': 0.3505020751548355, 'recall': 0.34750491577792103, 'f1-score': 0.33341546410168715, 'support': 177929}, 'weighted avg': {'precision': 0.3540261787339104, 'recall': 0.36377431447375075, 'f1-score': 0.3434184662693186, 'support': 177929}}
[[ 8366 29749 16761]
 [ 9738 38152 20956]
 [ 7115 28884 18208]]
training model: results/AAL/W7/deepLOB_L1/h200
Epoch 1/50
2013/2013 - 49s - loss: 3.2574 - accuracy200: 0.3945 - val_loss: 3.6489 - val_accuracy200: 0.3315 - 49s/epoch - 24ms/step
Epoch 2/50
2013/2013 - 46s - loss: 3.2395 - accuracy200: 0.4004 - val_loss: 3.4697 - val_accuracy200: 0.3331 - 46s/epoch - 23ms/step
Epoch 3/50
2013/2013 - 46s - loss: 3.2329 - accuracy200: 0.4029 - val_loss: 3.4113 - val_accuracy200: 0.3397 - 46s/epoch - 23ms/step
Epoch 4/50
2013/2013 - 46s - loss: 3.2173 - accuracy200: 0.4137 - val_loss: 3.4437 - val_accuracy200: 0.3337 - 46s/epoch - 23ms/step
Epoch 5/50
2013/2013 - 47s - loss: 3.2036 - accuracy200: 0.4190 - val_loss: 3.4261 - val_accuracy200: 0.3348 - 47s/epoch - 23ms/step
Epoch 6/50
2013/2013 - 47s - loss: 3.1949 - accuracy200: 0.4217 - val_loss: 3.4590 - val_accuracy200: 0.3320 - 47s/epoch - 23ms/step
Epoch 7/50
2013/2013 - 49s - loss: 3.1878 - accuracy200: 0.4235 - val_loss: 3.4246 - val_accuracy200: 0.3328 - 49s/epoch - 24ms/step
Epoch 8/50
2013/2013 - 47s - loss: 3.1821 - accuracy200: 0.4274 - val_loss: 3.4322 - val_accuracy200: 0.3332 - 47s/epoch - 23ms/step
Epoch 9/50
2013/2013 - 47s - loss: 3.1778 - accuracy200: 0.4289 - val_loss: 3.3726 - val_accuracy200: 0.3322 - 47s/epoch - 23ms/step
Epoch 10/50
2013/2013 - 46s - loss: 3.1739 - accuracy200: 0.4312 - val_loss: 3.3762 - val_accuracy200: 0.3348 - 46s/epoch - 23ms/step
Epoch 11/50
2013/2013 - 44s - loss: 3.1687 - accuracy200: 0.4330 - val_loss: 3.4548 - val_accuracy200: 0.3327 - 44s/epoch - 22ms/step
Epoch 12/50
2013/2013 - 46s - loss: 3.1651 - accuracy200: 0.4343 - val_loss: 3.4354 - val_accuracy200: 0.3344 - 46s/epoch - 23ms/step
Epoch 13/50
2013/2013 - 46s - loss: 3.1610 - accuracy200: 0.4360 - val_loss: 3.4402 - val_accuracy200: 0.3334 - 46s/epoch - 23ms/step
Epoch 14/50
2013/2013 - 46s - loss: 3.1579 - accuracy200: 0.4377 - val_loss: 3.3925 - val_accuracy200: 0.3410 - 46s/epoch - 23ms/step
Epoch 15/50
2013/2013 - 47s - loss: 3.1538 - accuracy200: 0.4387 - val_loss: 3.4225 - val_accuracy200: 0.3379 - 47s/epoch - 23ms/step
Epoch 16/50
2013/2013 - 46s - loss: 3.1509 - accuracy200: 0.4396 - val_loss: 3.3782 - val_accuracy200: 0.3427 - 46s/epoch - 23ms/step
Epoch 17/50
2013/2013 - 46s - loss: 3.1477 - accuracy200: 0.4409 - val_loss: 3.4504 - val_accuracy200: 0.3361 - 46s/epoch - 23ms/step
Epoch 18/50
2013/2013 - 46s - loss: 3.1447 - accuracy200: 0.4418 - val_loss: 3.4089 - val_accuracy200: 0.3411 - 46s/epoch - 23ms/step
Epoch 19/50
2013/2013 - 47s - loss: 3.1414 - accuracy200: 0.4437 - val_loss: 3.4228 - val_accuracy200: 0.3379 - 47s/epoch - 23ms/step
testing model: results/AAL/W7/deepLOB_L1/h200
Evaluating performance on  test set...
5331/5331 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.123686
{'0': {'precision': 0.3072448849078479, 'recall': 0.7071191687458308, 'f1-score': 0.4283644453584349, 'support': 421243}, '1': {'precision': 0.3738011823954456, 'recall': 0.2648797517455392, 'f1-score': 0.31005266981474755, 'support': 515600}, '2': {'precision': 0.30992540823869363, 'recall': 0.0215633423180593, 'f1-score': 0.04032129391836512, 'support': 427763}, 'accuracy': 0.325123149099447, 'macro avg': {'precision': 0.33032382518066233, 'recall': 0.3311874209364764, 'f1-score': 0.25957946969718254, 'support': 1364606}, 'weighted avg': {'precision': 0.3332326467132173, 'recall': 0.325123149099447, 'f1-score': 0.2620218863635428, 'support': 1364606}}
[[297869 114167   9207]
 [367697 136572  11331]
 [303918 114621   9224]]
Evaluating performance on  train set...
2013/2013 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1150811
{'0': {'precision': 0.34962714863498484, 'recall': 0.8062382647198947, 'f1-score': 0.48774326553517144, 'support': 178415}, '1': {'precision': 0.326067468742628, 'recall': 0.16836899389111196, 'f1-score': 0.22206959155229405, 'support': 164187}, '2': {'precision': 0.35937827088130625, 'recall': 0.03976029181865555, 'f1-score': 0.07159911999916588, 'support': 172710}, 'accuracy': 0.3461126463191232, 'macro avg': {'precision': 0.34502429608630636, 'recall': 0.33812251680988736, 'f1-score': 0.26047065902887717, 'support': 515312}, 'weighted avg': {'precision': 0.345388790437768, 'recall': 0.3461126463191232, 'f1-score': 0.26362191985381683, 'support': 515312}}
[[143845  28824   5746]
 [130048  27644   6495]
 [137531  28312   6867]]
Evaluating performance on  val set...
696/696 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.121262
{'0': {'precision': 0.3321449707306291, 'recall': 0.7883531621790858, 'f1-score': 0.4673770179293462, 'support': 59089}, '1': {'precision': 0.3357628765792031, 'recall': 0.19654658925494, 'f1-score': 0.2479499329836522, 'support': 59767}, '2': {'precision': 0.3348181143281366, 'recall': 0.015269243139843921, 'f1-score': 0.029206534233490376, 'support': 59073}, 'accuracy': 0.33289682963429235, 'macro avg': {'precision': 0.33424198721265624, 'recall': 0.3333896648579566, 'f1-score': 0.24817782838216296, 'support': 177929}, 'weighted avg': {'precision': 0.33424773076742625, 'recall': 0.33289682963429235, 'f1-score': 0.24819665065186708, 'support': 177929}}
[[46583 11681   825]
 [47053 11747   967]
 [46613 11558   902]]
training model: results/AAL/W7/deepLOB_L1/h300
Epoch 1/50
2013/2013 - 50s - loss: 3.2811 - accuracy300: 0.3790 - val_loss: 3.4263 - val_accuracy300: 0.3374 - 50s/epoch - 25ms/step
Epoch 2/50
2013/2013 - 47s - loss: 3.2553 - accuracy300: 0.3908 - val_loss: 3.4687 - val_accuracy300: 0.3381 - 47s/epoch - 23ms/step
Epoch 3/50
2013/2013 - 46s - loss: 3.2409 - accuracy300: 0.3981 - val_loss: 3.4259 - val_accuracy300: 0.3300 - 46s/epoch - 23ms/step
Epoch 4/50
2013/2013 - 46s - loss: 3.2293 - accuracy300: 0.4069 - val_loss: 3.4154 - val_accuracy300: 0.3327 - 46s/epoch - 23ms/step
Epoch 5/50
2013/2013 - 46s - loss: 3.2216 - accuracy300: 0.4123 - val_loss: 3.4008 - val_accuracy300: 0.3342 - 46s/epoch - 23ms/step
Epoch 6/50
2013/2013 - 46s - loss: 3.2181 - accuracy300: 0.4131 - val_loss: 3.5480 - val_accuracy300: 0.3280 - 46s/epoch - 23ms/step
Epoch 7/50
2013/2013 - 46s - loss: 3.2135 - accuracy300: 0.4147 - val_loss: 3.6434 - val_accuracy300: 0.3284 - 46s/epoch - 23ms/step
Epoch 8/50
2013/2013 - 47s - loss: 3.2082 - accuracy300: 0.4185 - val_loss: 3.7044 - val_accuracy300: 0.3289 - 47s/epoch - 23ms/step
Epoch 9/50
2013/2013 - 47s - loss: 3.2034 - accuracy300: 0.4211 - val_loss: 3.6912 - val_accuracy300: 0.3281 - 47s/epoch - 23ms/step
Epoch 10/50
2013/2013 - 46s - loss: 3.2006 - accuracy300: 0.4231 - val_loss: 3.6229 - val_accuracy300: 0.3291 - 46s/epoch - 23ms/step
Epoch 11/50
2013/2013 - 46s - loss: 3.1962 - accuracy300: 0.4248 - val_loss: 3.5655 - val_accuracy300: 0.3311 - 46s/epoch - 23ms/step
Epoch 12/50
2013/2013 - 47s - loss: 3.1924 - accuracy300: 0.4261 - val_loss: 3.4967 - val_accuracy300: 0.3319 - 47s/epoch - 23ms/step
Epoch 13/50
2013/2013 - 46s - loss: 3.1901 - accuracy300: 0.4273 - val_loss: 3.5044 - val_accuracy300: 0.3313 - 46s/epoch - 23ms/step
Epoch 14/50
2013/2013 - 46s - loss: 3.1866 - accuracy300: 0.4296 - val_loss: 3.5320 - val_accuracy300: 0.3298 - 46s/epoch - 23ms/step
Epoch 15/50
2013/2013 - 46s - loss: 3.1836 - accuracy300: 0.4305 - val_loss: 3.5172 - val_accuracy300: 0.3278 - 46s/epoch - 23ms/step
testing model: results/AAL/W7/deepLOB_L1/h300
Evaluating performance on  test set...
5331/5331 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1387558
{'0': {'precision': 0.3013614543308528, 'recall': 0.8049567235415177, 'f1-score': 0.4385409798587896, 'support': 411078}, '1': {'precision': 0.3849370170424473, 'recall': 0.0955888427424503, 'f1-score': 0.15314757047327116, 'support': 532604}, '2': {'precision': 0.3028712657539957, 'recall': 0.0966564035312788, 'f1-score': 0.14654528099701938, 'support': 420924}, 'accuracy': 0.3096102464740738, 'macro avg': {'precision': 0.3297232457090986, 'recall': 0.3324006566050823, 'f1-score': 0.24607794377636005, 'support': 1364606}, 'weighted avg': {'precision': 0.3344466048181884, 'recall': 0.3096102464740738, 'f1-score': 0.23708380543624097, 'support': 1364606}}
[[330900  40042  40136]
 [428183  50911  53510]
 [338934  41305  40685]]
Evaluating performance on  train set...
2013/2013 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1319922
{'0': {'precision': 0.34159411361285147, 'recall': 0.841812473502687, 'f1-score': 0.48598375037829233, 'support': 174546}, '1': {'precision': 0.3473195930630963, 'recall': 0.11426738116296412, 'f1-score': 0.1719602265313046, 'support': 172989}, '2': {'precision': 0.3391024279748, 'recall': 0.05710556274101933, 'f1-score': 0.09774984568767184, 'support': 167777}, 'accuracy': 0.34208984071785636, 'macro avg': {'precision': 0.34267204488358255, 'recall': 0.3377284724688901, 'f1-score': 0.2518979408657563, 'support': 515312}, 'weighted avg': {'precision': 0.3427048919826993, 'recall': 0.34208984071785636, 'f1-score': 0.2541643182788171, 'support': 515312}}
[[146935  18393   9218]
 [143767  19767   9455]
 [139443  18753   9581]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1304792
{'0': {'precision': 0.3295973062122045, 'recall': 0.8216500496796519, 'f1-score': 0.47046995007209624, 'support': 58374}, '1': {'precision': 0.35214937038645244, 'recall': 0.12028080351993145, 'f1-score': 0.17931458051836385, 'support': 60683}, '2': {'precision': 0.34617360041088857, 'recall': 0.06869139828781085, 'f1-score': 0.11463559826515861, 'support': 58872}, 'accuracy': 0.33331272586256316, 'macro avg': {'precision': 0.34264009233651516, 'recall': 0.33687408382913137, 'f1-score': 0.2548067096185396, 'support': 177929}, 'weighted avg': {'precision': 0.34277338488600595, 'recall': 0.33331272586256316, 'f1-score': 0.2534347211312987, 'support': 177929}}
[[47963  6643  3768]
 [49514  7299  3870]
 [48043  6785  4044]]
training model: results/AAL/W7/deepLOB_L1/h500
Epoch 1/50
2013/2013 - 50s - loss: 3.2533 - accuracy500: 0.3978 - val_loss: 3.3517 - val_accuracy500: 0.3401 - 50s/epoch - 25ms/step
Epoch 2/50
2013/2013 - 47s - loss: 3.2354 - accuracy500: 0.4042 - val_loss: 3.5096 - val_accuracy500: 0.3144 - 47s/epoch - 23ms/step
Epoch 3/50
2013/2013 - 46s - loss: 3.2257 - accuracy500: 0.4081 - val_loss: 3.4098 - val_accuracy500: 0.3190 - 46s/epoch - 23ms/step
Epoch 4/50
2013/2013 - 46s - loss: 3.2208 - accuracy500: 0.4118 - val_loss: 3.3423 - val_accuracy500: 0.3367 - 46s/epoch - 23ms/step
Epoch 5/50
2013/2013 - 46s - loss: 3.2092 - accuracy500: 0.4200 - val_loss: 3.5182 - val_accuracy500: 0.3133 - 46s/epoch - 23ms/step
Epoch 6/50
2013/2013 - 47s - loss: 3.1976 - accuracy500: 0.4268 - val_loss: 3.4036 - val_accuracy500: 0.3146 - 47s/epoch - 23ms/step
Epoch 7/50
2013/2013 - 48s - loss: 3.1928 - accuracy500: 0.4286 - val_loss: 3.4301 - val_accuracy500: 0.3136 - 48s/epoch - 24ms/step
Epoch 8/50
2013/2013 - 45s - loss: 3.1855 - accuracy500: 0.4312 - val_loss: 3.3467 - val_accuracy500: 0.3144 - 45s/epoch - 23ms/step
Epoch 9/50
2013/2013 - 46s - loss: 3.1886 - accuracy500: 0.4291 - val_loss: 3.4688 - val_accuracy500: 0.3130 - 46s/epoch - 23ms/step
Epoch 10/50
2013/2013 - 47s - loss: 3.1803 - accuracy500: 0.4328 - val_loss: 3.4835 - val_accuracy500: 0.3131 - 47s/epoch - 23ms/step
Epoch 11/50
2013/2013 - 46s - loss: 3.1765 - accuracy500: 0.4350 - val_loss: 3.4922 - val_accuracy500: 0.3132 - 46s/epoch - 23ms/step
Epoch 12/50
2013/2013 - 46s - loss: 3.1704 - accuracy500: 0.4378 - val_loss: 3.6001 - val_accuracy500: 0.3131 - 46s/epoch - 23ms/step
Epoch 13/50
2013/2013 - 47s - loss: 3.1670 - accuracy500: 0.4384 - val_loss: 3.6080 - val_accuracy500: 0.3130 - 47s/epoch - 23ms/step
Epoch 14/50
2013/2013 - 47s - loss: 3.1628 - accuracy500: 0.4404 - val_loss: 3.5791 - val_accuracy500: 0.3132 - 47s/epoch - 23ms/step
testing model: results/AAL/W7/deepLOB_L1/h500
Evaluating performance on  test set...
5331/5331 - 78s - 78s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1137822
{'0': {'precision': 0.32268491879110156, 'recall': 0.8515156895955126, 'f1-score': 0.4680141863050481, 'support': 439272}, '1': {'precision': 0.3551851318434285, 'recall': 0.1187253797947915, 'f1-score': 0.17796393470911673, 'support': 477758}, '2': {'precision': 0.3067689885871704, 'recall': 0.03134886589093249, 'f1-score': 0.056884661696201606, 'support': 447576}, 'accuracy': 0.3259548910088333, 'macro avg': {'precision': 0.32821301307390016, 'recall': 0.3338633117604122, 'f1-score': 0.23428759423678883, 'support': 1364606}, 'weighted avg': {'precision': 0.3288432153327399, 'recall': 0.3259548910088333, 'f1-score': 0.23161955209686053, 'support': 1364606}}
[[374047  50172  15053]
 [404382  56722  16654]
 [380742  52803  14031]]
Evaluating performance on  train set...
2013/2013 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1072611
{'0': {'precision': 0.3492383307384681, 'recall': 0.7067677618646447, 'f1-score': 0.46747910850574975, 'support': 178050}, '1': {'precision': 0.3400912083966725, 'recall': 0.2662564065761224, 'f1-score': 0.298678384543137, 'support': 167211}, '2': {'precision': 0.33921747798637647, 'recall': 0.04802676844005622, 'f1-score': 0.08414079442838968, 'support': 170051}, 'accuracy': 0.3464464246902847, 'macro avg': {'precision': 0.3428490057071724, 'recall': 0.3403503122936078, 'f1-score': 0.2834327624924255, 'support': 515312}, 'weighted avg': {'precision': 0.3429633837059132, 'recall': 0.3464464246902847, 'f1-score': 0.28620562467133176, 'support': 515312}}
[[125840  43914   8296]
 [115077  44521   7613]
 [119410  42474   8167]]
Evaluating performance on  val set...
696/696 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1124874
{'0': {'precision': 0.3427448787836432, 'recall': 0.731015750509283, 'f1-score': 0.46668111674429175, 'support': 60379}, '1': {'precision': 0.3233356410657257, 'recall': 0.2598908594815825, 'f1-score': 0.2881624123003433, 'support': 55708}, '2': {'precision': 0.34476451760402377, 'recall': 0.024384722356974226, 'f1-score': 0.04554790382989005, 'support': 61842}, 'accuracy': 0.3379100652507461, 'macro avg': {'precision': 0.33694834581779753, 'recall': 0.33843044411594664, 'f1-score': 0.26679714429150836, 'support': 177929}, 'weighted avg': {'precision': 0.33736997468785346, 'recall': 0.3379100652507461, 'f1-score': 0.26441706681305, 'support': 177929}}
[[44138 14743  1498]
 [39862 14478  1368]
 [44778 15556  1508]]
training model: results/AAL/W7/deepLOB_L1/h1000
Epoch 1/50
2013/2013 - 50s - loss: 3.1600 - accuracy1000: 0.4541 - val_loss: 3.3081 - val_accuracy1000: 0.3608 - 50s/epoch - 25ms/step
Epoch 2/50
2013/2013 - 47s - loss: 3.1285 - accuracy1000: 0.4656 - val_loss: 3.4524 - val_accuracy1000: 0.3355 - 47s/epoch - 23ms/step
Epoch 3/50
2013/2013 - 47s - loss: 3.1145 - accuracy1000: 0.4677 - val_loss: 3.5464 - val_accuracy1000: 0.3618 - 47s/epoch - 23ms/step
Epoch 4/50
2013/2013 - 46s - loss: 3.1057 - accuracy1000: 0.4692 - val_loss: 3.4945 - val_accuracy1000: 0.3374 - 46s/epoch - 23ms/step
Epoch 5/50
2013/2013 - 46s - loss: 3.0965 - accuracy1000: 0.4727 - val_loss: 3.3510 - val_accuracy1000: 0.3243 - 46s/epoch - 23ms/step
Epoch 6/50
2013/2013 - 46s - loss: 3.0886 - accuracy1000: 0.4742 - val_loss: 3.3885 - val_accuracy1000: 0.3229 - 46s/epoch - 23ms/step
Epoch 7/50
2013/2013 - 46s - loss: 3.0944 - accuracy1000: 0.4740 - val_loss: 3.5389 - val_accuracy1000: 0.3051 - 46s/epoch - 23ms/step
Epoch 8/50
2013/2013 - 47s - loss: 3.0835 - accuracy1000: 0.4770 - val_loss: 3.5334 - val_accuracy1000: 0.2965 - 47s/epoch - 23ms/step
Epoch 9/50
2013/2013 - 46s - loss: 3.0773 - accuracy1000: 0.4786 - val_loss: 3.8274 - val_accuracy1000: 0.3484 - 46s/epoch - 23ms/step
Epoch 10/50
2013/2013 - 47s - loss: 3.0758 - accuracy1000: 0.4782 - val_loss: 3.6966 - val_accuracy1000: 0.3202 - 47s/epoch - 23ms/step
Epoch 11/50
2013/2013 - 46s - loss: 3.0639 - accuracy1000: 0.4830 - val_loss: 3.9540 - val_accuracy1000: 0.3523 - 46s/epoch - 23ms/step
testing model: results/AAL/W7/deepLOB_L1/h1000
Evaluating performance on  test set...
5331/5331 - 81s - 81s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.128524
{'0': {'precision': 0.2386835992318241, 'recall': 0.5434034625677373, 'f1-score': 0.331680449954673, 'support': 329582}, '1': {'precision': 0.5006496062992126, 'recall': 0.11106792555003363, 'f1-score': 0.18180323532985926, 'support': 686958}, '2': {'precision': 0.2629428589368571, 'recall': 0.3489050927123017, 'f1-score': 0.29988529773818, 'support': 348066}, 'accuracy': 0.2761507717245857, 'macro avg': {'precision': 0.33409202148929795, 'recall': 0.33445882694335755, 'f1-score': 0.2711229943409041, 'support': 1364606}, 'weighted avg': {'precision': 0.37674796929284615, 'recall': 0.2761507717245857, 'f1-score': 0.24812068028077547, 'support': 1364606}}
[[179096  37358 113128]
 [383372  76299 227287]
 [187881  38743 121442]]
Evaluating performance on  train set...
2013/2013 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.109559
{'0': {'precision': 0.35039832979293584, 'recall': 0.6968991728895289, 'f1-score': 0.4663284417066107, 'support': 179178}, '1': {'precision': 0.33969668582423984, 'recall': 0.08015844092220742, 'f1-score': 0.12970929726698827, 'support': 167381}, '2': {'precision': 0.3247078324347855, 'recall': 0.22984480275906205, 'f1-score': 0.2691625752502559, 'support': 168753}, 'accuracy': 0.34362289253888906, 'macro avg': {'precision': 0.33826761601732036, 'recall': 0.3356341388569328, 'f1-score': 0.2884001047412849, 'support': 515312}, 'weighted avg': {'precision': 0.3385092211174068, 'recall': 0.34362289253888906, 'f1-score': 0.2924221859284458, 'support': 515312}}
[[124869  13368  40941]
 [114240  13417  39724]
 [117254  12712  38787]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1025896
{'0': {'precision': 0.35785416589827757, 'recall': 0.6026210366137698, 'f1-score': 0.44904948685017415, 'support': 64402}, '1': {'precision': 0.23846198390178933, 'recall': 0.09123335622659902, 'f1-score': 0.13197448963240713, 'support': 45137}, '2': {'precision': 0.39949816120134846, 'recall': 0.3049714870595116, 'f1-score': 0.3458929667158659, 'support': 68390}, 'accuracy': 0.3584856881115501, 'macro avg': {'precision': 0.33193810366713844, 'recall': 0.3329419599666268, 'f1-score': 0.3089723143994824, 'support': 177929}, 'weighted avg': {'precision': 0.343573345571077, 'recall': 0.3584856881115501, 'f1-score': 0.32896401139983333, 'support': 177929}}
[[38810  6461 19131]
 [28799  4118 12220]
 [40843  6690 20857]]
training model: results/AAL/W7/deepOF_L1/h10
Epoch 1/50
2013/2013 - 47s - loss: 3.0877 - accuracy10: 0.3944 - val_loss: 3.0230 - val_accuracy10: 0.6859 - 47s/epoch - 24ms/step
Epoch 2/50
2013/2013 - 45s - loss: 3.0161 - accuracy10: 0.4070 - val_loss: 2.9699 - val_accuracy10: 0.6860 - 45s/epoch - 22ms/step
Epoch 3/50
2013/2013 - 45s - loss: 2.9781 - accuracy10: 0.4348 - val_loss: 2.9388 - val_accuracy10: 0.6786 - 45s/epoch - 23ms/step
Epoch 4/50
2013/2013 - 44s - loss: 2.9513 - accuracy10: 0.4502 - val_loss: 2.9024 - val_accuracy10: 0.6644 - 44s/epoch - 22ms/step
Epoch 5/50
2013/2013 - 43s - loss: 2.9310 - accuracy10: 0.4634 - val_loss: 2.8791 - val_accuracy10: 0.6617 - 43s/epoch - 21ms/step
Epoch 6/50
2013/2013 - 43s - loss: 2.9157 - accuracy10: 0.4720 - val_loss: 2.8741 - val_accuracy10: 0.6673 - 43s/epoch - 21ms/step
Epoch 7/50
2013/2013 - 43s - loss: 2.9013 - accuracy10: 0.4783 - val_loss: 2.8837 - val_accuracy10: 0.6790 - 43s/epoch - 21ms/step
Epoch 8/50
2013/2013 - 43s - loss: 2.8892 - accuracy10: 0.4817 - val_loss: 2.8810 - val_accuracy10: 0.6742 - 43s/epoch - 22ms/step
Epoch 9/50
2013/2013 - 44s - loss: 2.8788 - accuracy10: 0.4857 - val_loss: 2.8627 - val_accuracy10: 0.6599 - 44s/epoch - 22ms/step
Epoch 10/50
2013/2013 - 43s - loss: 2.8667 - accuracy10: 0.4907 - val_loss: 2.8646 - val_accuracy10: 0.6679 - 43s/epoch - 21ms/step
Epoch 11/50
2013/2013 - 43s - loss: 2.8562 - accuracy10: 0.4936 - val_loss: 2.8360 - val_accuracy10: 0.6459 - 43s/epoch - 21ms/step
Epoch 12/50
2013/2013 - 43s - loss: 2.8471 - accuracy10: 0.4965 - val_loss: 2.8584 - val_accuracy10: 0.6621 - 43s/epoch - 21ms/step
Epoch 13/50
2013/2013 - 43s - loss: 2.8374 - accuracy10: 0.4986 - val_loss: 2.8383 - val_accuracy10: 0.6525 - 43s/epoch - 21ms/step
Epoch 14/50
2013/2013 - 44s - loss: 2.8337 - accuracy10: 0.4971 - val_loss: 2.8371 - val_accuracy10: 0.6375 - 44s/epoch - 22ms/step
Epoch 15/50
2013/2013 - 43s - loss: 2.8256 - accuracy10: 0.4999 - val_loss: 2.8267 - val_accuracy10: 0.6427 - 43s/epoch - 21ms/step
Epoch 16/50
2013/2013 - 44s - loss: 2.8091 - accuracy10: 0.5041 - val_loss: 2.8283 - val_accuracy10: 0.6490 - 44s/epoch - 22ms/step
Epoch 17/50
2013/2013 - 42s - loss: 2.7981 - accuracy10: 0.5059 - val_loss: 2.8407 - val_accuracy10: 0.6559 - 42s/epoch - 21ms/step
Epoch 18/50
2013/2013 - 44s - loss: 2.7887 - accuracy10: 0.5065 - val_loss: 2.8157 - val_accuracy10: 0.6436 - 44s/epoch - 22ms/step
Epoch 19/50
2013/2013 - 41s - loss: 2.7826 - accuracy10: 0.5089 - val_loss: 2.8061 - val_accuracy10: 0.6384 - 41s/epoch - 20ms/step
Epoch 20/50
2013/2013 - 42s - loss: 2.7691 - accuracy10: 0.5111 - val_loss: 2.8027 - val_accuracy10: 0.6224 - 42s/epoch - 21ms/step
Epoch 21/50
2013/2013 - 44s - loss: 2.7613 - accuracy10: 0.5149 - val_loss: 2.7991 - val_accuracy10: 0.6275 - 44s/epoch - 22ms/step
Epoch 22/50
2013/2013 - 44s - loss: 2.7517 - accuracy10: 0.5170 - val_loss: 2.7999 - val_accuracy10: 0.6307 - 44s/epoch - 22ms/step
Epoch 23/50
2013/2013 - 44s - loss: 2.7409 - accuracy10: 0.5191 - val_loss: 2.7975 - val_accuracy10: 0.6407 - 44s/epoch - 22ms/step
Epoch 24/50
2013/2013 - 43s - loss: 2.7333 - accuracy10: 0.5203 - val_loss: 2.7872 - val_accuracy10: 0.6190 - 43s/epoch - 21ms/step
Epoch 25/50
2013/2013 - 45s - loss: 2.7233 - accuracy10: 0.5221 - val_loss: 2.7880 - val_accuracy10: 0.6233 - 45s/epoch - 22ms/step
Epoch 26/50
2013/2013 - 44s - loss: 2.7160 - accuracy10: 0.5235 - val_loss: 2.7807 - val_accuracy10: 0.6116 - 44s/epoch - 22ms/step
Epoch 27/50
2013/2013 - 43s - loss: 2.7096 - accuracy10: 0.5253 - val_loss: 2.7959 - val_accuracy10: 0.6266 - 43s/epoch - 22ms/step
Epoch 28/50
2013/2013 - 44s - loss: 2.7083 - accuracy10: 0.5254 - val_loss: 2.7804 - val_accuracy10: 0.6304 - 44s/epoch - 22ms/step
Epoch 29/50
2013/2013 - 43s - loss: 2.6937 - accuracy10: 0.5287 - val_loss: 2.7850 - val_accuracy10: 0.6251 - 43s/epoch - 21ms/step
Epoch 30/50
2013/2013 - 43s - loss: 2.6825 - accuracy10: 0.5315 - val_loss: 2.7750 - val_accuracy10: 0.6201 - 43s/epoch - 21ms/step
Epoch 31/50
2013/2013 - 44s - loss: 2.6753 - accuracy10: 0.5325 - val_loss: 2.7797 - val_accuracy10: 0.6201 - 44s/epoch - 22ms/step
Epoch 32/50
2013/2013 - 44s - loss: 2.6658 - accuracy10: 0.5347 - val_loss: 2.7722 - val_accuracy10: 0.6155 - 44s/epoch - 22ms/step
Epoch 33/50
2013/2013 - 44s - loss: 2.6636 - accuracy10: 0.5351 - val_loss: 2.7747 - val_accuracy10: 0.6018 - 44s/epoch - 22ms/step
Epoch 34/50
2013/2013 - 44s - loss: 2.6581 - accuracy10: 0.5366 - val_loss: 2.7513 - val_accuracy10: 0.5956 - 44s/epoch - 22ms/step
Epoch 35/50
2013/2013 - 43s - loss: 2.6520 - accuracy10: 0.5375 - val_loss: 2.7675 - val_accuracy10: 0.5893 - 43s/epoch - 21ms/step
Epoch 36/50
2013/2013 - 43s - loss: 2.6437 - accuracy10: 0.5390 - val_loss: 2.7632 - val_accuracy10: 0.5926 - 43s/epoch - 22ms/step
Epoch 37/50
2013/2013 - 43s - loss: 2.6350 - accuracy10: 0.5403 - val_loss: 2.7711 - val_accuracy10: 0.5951 - 43s/epoch - 21ms/step
Epoch 38/50
2013/2013 - 43s - loss: 2.6290 - accuracy10: 0.5415 - val_loss: 2.7785 - val_accuracy10: 0.5875 - 43s/epoch - 22ms/step
Epoch 39/50
2013/2013 - 43s - loss: 2.6255 - accuracy10: 0.5422 - val_loss: 2.7750 - val_accuracy10: 0.5927 - 43s/epoch - 21ms/step
Epoch 40/50
2013/2013 - 43s - loss: 2.6206 - accuracy10: 0.5423 - val_loss: 2.7764 - val_accuracy10: 0.5721 - 43s/epoch - 22ms/step
Epoch 41/50
2013/2013 - 43s - loss: 2.6138 - accuracy10: 0.5450 - val_loss: 2.7827 - val_accuracy10: 0.5934 - 43s/epoch - 22ms/step
Epoch 42/50
2013/2013 - 43s - loss: 2.6070 - accuracy10: 0.5451 - val_loss: 2.7650 - val_accuracy10: 0.5761 - 43s/epoch - 21ms/step
Epoch 43/50
2013/2013 - 42s - loss: 2.6023 - accuracy10: 0.5468 - val_loss: 2.7650 - val_accuracy10: 0.5750 - 42s/epoch - 21ms/step
Epoch 44/50
2013/2013 - 44s - loss: 2.5970 - accuracy10: 0.5468 - val_loss: 2.7830 - val_accuracy10: 0.5713 - 44s/epoch - 22ms/step
testing model: results/AAL/W7/deepOF_L1/h10
Evaluating performance on  test set...
5331/5331 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8283307
{'0': {'precision': 0.2587731933114222, 'recall': 0.5416244141749116, 'f1-score': 0.35022063514567237, 'support': 145948}, '1': {'precision': 0.8708902292506511, 'recall': 0.6668575100449619, 'f1-score': 0.7553380505265451, 'support': 1070686}, '2': {'precision': 0.27898696088264796, 'recall': 0.45115464934748967, 'f1-score': 0.34477219965551703, 'support': 147967}, 'accuracy': 0.6300742854504723, 'macro avg': {'precision': 0.469550127814907, 'recall': 0.553212191189121, 'f1-score': 0.4834436284425782, 'support': 1364601}, 'weighted avg': {'precision': 0.7412410438317141, 'recall': 0.6300742854504723, 'f1-score': 0.6674909261320584, 'support': 1364601}}
[[ 79049  48302  18597]
 [202764 713995 153927]
 [ 23663  57548  66756]]
Evaluating performance on  train set...
2013/2013 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91200864
{'0': {'precision': 0.274438233384535, 'recall': 0.5174673792959302, 'f1-score': 0.35866100993377487, 'support': 66982}, '1': {'precision': 0.8360073730067712, 'recall': 0.5769184558324192, 'f1-score': 0.6827082821407984, 'support': 382860}, '2': {'precision': 0.2668963583189776, 'recall': 0.5087981914828619, 'f1-score': 0.35012849957692366, 'support': 65468}, 'accuracy': 0.560536376161922, 'macro avg': {'precision': 0.45911398823676125, 'recall': 0.5343946755370704, 'f1-score': 0.4638325972171656, 'support': 515310}, 'weighted avg': {'precision': 0.6907092339841303, 'recall': 0.560536376161922, 'f1-score': 0.5983344729931734, 'support': 515310}}
[[ 34661  21681  10640]
 [ 81126 220879  80855]
 [ 10511  21647  33310]]
Evaluating performance on  val set...
696/696 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8635932
{'0': {'precision': 0.2683029748927491, 'recall': 0.5322265625, 'f1-score': 0.35675877869733946, 'support': 21504}, '1': {'precision': 0.8510398648376846, 'recall': 0.6243608756280573, 'f1-score': 0.7202870116992166, 'support': 135537}, '2': {'precision': 0.2739703091862931, 'recall': 0.4700306396016852, 'f1-score': 0.346167407093999, 'support': 20888}, 'accuracy': 0.595108161120447, 'macro avg': {'precision': 0.46443771630557557, 'recall': 0.5422060259099142, 'f1-score': 0.47440439916351834, 'support': 177929}, 'weighted avg': {'precision': 0.7128667566888041, 'recall': 0.595108161120447, 'f1-score': 0.6324321852040069, 'support': 177929}}
[[11445  7204  2855]
 [27750 84624 23163]
 [ 3462  7608  9818]]
training model: results/AAL/W7/deepOF_L1/h20
Epoch 1/50
2013/2013 - 48s - loss: 3.1335 - accuracy20: 0.3963 - val_loss: 3.0722 - val_accuracy20: 0.6141 - 48s/epoch - 24ms/step
Epoch 2/50
2013/2013 - 45s - loss: 3.0717 - accuracy20: 0.4005 - val_loss: 3.0116 - val_accuracy20: 0.6049 - 45s/epoch - 22ms/step
Epoch 3/50
2013/2013 - 42s - loss: 3.0345 - accuracy20: 0.4306 - val_loss: 3.0066 - val_accuracy20: 0.6238 - 42s/epoch - 21ms/step
Epoch 4/50
2013/2013 - 43s - loss: 3.0103 - accuracy20: 0.4450 - val_loss: 2.9964 - val_accuracy20: 0.6247 - 43s/epoch - 21ms/step
Epoch 5/50
2013/2013 - 43s - loss: 2.9933 - accuracy20: 0.4530 - val_loss: 2.9828 - val_accuracy20: 0.6286 - 43s/epoch - 21ms/step
Epoch 6/50
2013/2013 - 43s - loss: 2.9791 - accuracy20: 0.4611 - val_loss: 2.9741 - val_accuracy20: 0.6312 - 43s/epoch - 21ms/step
Epoch 7/50
2013/2013 - 44s - loss: 2.9646 - accuracy20: 0.4664 - val_loss: 2.9741 - val_accuracy20: 0.6299 - 44s/epoch - 22ms/step
Epoch 8/50
2013/2013 - 44s - loss: 2.9546 - accuracy20: 0.4700 - val_loss: 2.9646 - val_accuracy20: 0.6287 - 44s/epoch - 22ms/step
Epoch 9/50
2013/2013 - 44s - loss: 2.9446 - accuracy20: 0.4732 - val_loss: 2.9534 - val_accuracy20: 0.6246 - 44s/epoch - 22ms/step
Epoch 10/50
2013/2013 - 43s - loss: 2.9330 - accuracy20: 0.4776 - val_loss: 2.9505 - val_accuracy20: 0.6266 - 43s/epoch - 22ms/step
Epoch 11/50
2013/2013 - 44s - loss: 2.9236 - accuracy20: 0.4789 - val_loss: 2.9479 - val_accuracy20: 0.6217 - 44s/epoch - 22ms/step
Epoch 12/50
2013/2013 - 43s - loss: 2.9154 - accuracy20: 0.4822 - val_loss: 2.9445 - val_accuracy20: 0.6233 - 43s/epoch - 21ms/step
Epoch 13/50
2013/2013 - 43s - loss: 2.9086 - accuracy20: 0.4834 - val_loss: 2.9377 - val_accuracy20: 0.6187 - 43s/epoch - 21ms/step
Epoch 14/50
2013/2013 - 42s - loss: 2.8991 - accuracy20: 0.4860 - val_loss: 2.9420 - val_accuracy20: 0.6262 - 42s/epoch - 21ms/step
Epoch 15/50
2013/2013 - 43s - loss: 2.8900 - accuracy20: 0.4884 - val_loss: 2.9419 - val_accuracy20: 0.6237 - 43s/epoch - 22ms/step
Epoch 16/50
2013/2013 - 44s - loss: 2.8835 - accuracy20: 0.4884 - val_loss: 2.9505 - val_accuracy20: 0.6253 - 44s/epoch - 22ms/step
Epoch 17/50
2013/2013 - 43s - loss: 2.8740 - accuracy20: 0.4914 - val_loss: 2.9614 - val_accuracy20: 0.6239 - 43s/epoch - 21ms/step
Epoch 18/50
2013/2013 - 43s - loss: 2.8689 - accuracy20: 0.4930 - val_loss: 2.9398 - val_accuracy20: 0.6261 - 43s/epoch - 22ms/step
Epoch 19/50
2013/2013 - 42s - loss: 2.8576 - accuracy20: 0.4962 - val_loss: 2.9436 - val_accuracy20: 0.6162 - 42s/epoch - 21ms/step
Epoch 20/50
2013/2013 - 43s - loss: 2.8483 - accuracy20: 0.4981 - val_loss: 2.9353 - val_accuracy20: 0.6170 - 43s/epoch - 21ms/step
Epoch 21/50
2013/2013 - 43s - loss: 2.8391 - accuracy20: 0.5002 - val_loss: 2.9479 - val_accuracy20: 0.6197 - 43s/epoch - 21ms/step
Epoch 22/50
2013/2013 - 43s - loss: 2.8402 - accuracy20: 0.5007 - val_loss: 2.9384 - val_accuracy20: 0.6054 - 43s/epoch - 22ms/step
Epoch 23/50
2013/2013 - 43s - loss: 2.8244 - accuracy20: 0.5055 - val_loss: 2.9266 - val_accuracy20: 0.6122 - 43s/epoch - 21ms/step
Epoch 24/50
2013/2013 - 44s - loss: 2.8152 - accuracy20: 0.5080 - val_loss: 2.9182 - val_accuracy20: 0.6058 - 44s/epoch - 22ms/step
Epoch 25/50
2013/2013 - 42s - loss: 2.8066 - accuracy20: 0.5094 - val_loss: 2.9341 - val_accuracy20: 0.6062 - 42s/epoch - 21ms/step
Epoch 26/50
2013/2013 - 44s - loss: 2.8001 - accuracy20: 0.5114 - val_loss: 2.9092 - val_accuracy20: 0.6023 - 44s/epoch - 22ms/step
Epoch 27/50
2013/2013 - 43s - loss: 2.8029 - accuracy20: 0.5117 - val_loss: 2.8941 - val_accuracy20: 0.5902 - 43s/epoch - 21ms/step
Epoch 28/50
2013/2013 - 43s - loss: 2.7915 - accuracy20: 0.5139 - val_loss: 2.8789 - val_accuracy20: 0.5856 - 43s/epoch - 22ms/step
Epoch 29/50
2013/2013 - 43s - loss: 2.7795 - accuracy20: 0.5176 - val_loss: 2.9008 - val_accuracy20: 0.5785 - 43s/epoch - 21ms/step
Epoch 30/50
2013/2013 - 43s - loss: 2.7722 - accuracy20: 0.5192 - val_loss: 2.8842 - val_accuracy20: 0.5846 - 43s/epoch - 22ms/step
Epoch 31/50
2013/2013 - 43s - loss: 2.7663 - accuracy20: 0.5199 - val_loss: 2.8718 - val_accuracy20: 0.5830 - 43s/epoch - 21ms/step
Epoch 32/50
2013/2013 - 44s - loss: 2.7585 - accuracy20: 0.5227 - val_loss: 2.8879 - val_accuracy20: 0.5935 - 44s/epoch - 22ms/step
Epoch 33/50
2013/2013 - 44s - loss: 2.7526 - accuracy20: 0.5248 - val_loss: 2.8679 - val_accuracy20: 0.5787 - 44s/epoch - 22ms/step
Epoch 34/50
2013/2013 - 43s - loss: 2.7526 - accuracy20: 0.5247 - val_loss: 2.8841 - val_accuracy20: 0.5815 - 43s/epoch - 21ms/step
Epoch 35/50
2013/2013 - 43s - loss: 2.7384 - accuracy20: 0.5266 - val_loss: 2.8728 - val_accuracy20: 0.5831 - 43s/epoch - 21ms/step
Epoch 36/50
2013/2013 - 43s - loss: 2.7336 - accuracy20: 0.5269 - val_loss: 2.8691 - val_accuracy20: 0.5764 - 43s/epoch - 22ms/step
Epoch 37/50
2013/2013 - 43s - loss: 2.7258 - accuracy20: 0.5299 - val_loss: 2.8816 - val_accuracy20: 0.5822 - 43s/epoch - 22ms/step
Epoch 38/50
2013/2013 - 43s - loss: 2.7204 - accuracy20: 0.5317 - val_loss: 2.8838 - val_accuracy20: 0.5882 - 43s/epoch - 21ms/step
Epoch 39/50
2013/2013 - 42s - loss: 2.7133 - accuracy20: 0.5322 - val_loss: 2.8797 - val_accuracy20: 0.5808 - 42s/epoch - 21ms/step
Epoch 40/50
2013/2013 - 43s - loss: 2.7074 - accuracy20: 0.5350 - val_loss: 2.8827 - val_accuracy20: 0.5804 - 43s/epoch - 21ms/step
Epoch 41/50
2013/2013 - 43s - loss: 2.7020 - accuracy20: 0.5352 - val_loss: 2.8798 - val_accuracy20: 0.5781 - 43s/epoch - 21ms/step
Epoch 42/50
2013/2013 - 43s - loss: 2.6984 - accuracy20: 0.5359 - val_loss: 2.8878 - val_accuracy20: 0.5795 - 43s/epoch - 22ms/step
Epoch 43/50
2013/2013 - 44s - loss: 2.6906 - accuracy20: 0.5390 - val_loss: 2.9014 - val_accuracy20: 0.5800 - 44s/epoch - 22ms/step
testing model: results/AAL/W7/deepOF_L1/h20
Evaluating performance on  test set...
5331/5331 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8552374
{'0': {'precision': 0.3240735308834542, 'recall': 0.4742476808015311, 'f1-score': 0.38503579306442753, 'support': 198021}, '1': {'precision': 0.7974947908802658, 'recall': 0.6834623530800144, 'f1-score': 0.7360883717222529, 'support': 966002}, '2': {'precision': 0.3266907747941833, 'recall': 0.4022076199782628, 'f1-score': 0.360537270876674, 'support': 200578}, 'accuracy': 0.6117619729136942, 'macro avg': {'precision': 0.4827530321859677, 'recall': 0.5199725512866027, 'f1-score': 0.4938871452211182, 'support': 1364601}, 'weighted avg': {'precision': 0.6595934708135628, 'recall': 0.6117619729136942, 'f1-score': 0.6299452050502324, 'support': 1364601}}
[[ 93911  78589  25521]
 [165028 660226 140748]
 [ 30844  89060  80674]]
Evaluating performance on  train set...
2013/2013 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91285837
{'0': {'precision': 0.3476319909167541, 'recall': 0.45705916945625624, 'f1-score': 0.3949052676835286, 'support': 88424}, '1': {'precision': 0.7541674898080135, 'recall': 0.6171218965937848, 'f1-score': 0.6787965782786647, 'support': 340231}, '2': {'precision': 0.33076661665851614, 'recall': 0.46051583867059026, 'f1-score': 0.3850035214324994, 'support': 86655}, 'accuracy': 0.5633211076827541, 'macro avg': {'precision': 0.47752203246109465, 'recall': 0.5115656349068771, 'f1-score': 0.4862351224648976, 'support': 515310}, 'weighted avg': {'precision': 0.6132090422391123, 'recall': 0.5633211076827541, 'f1-score': 0.580678081472725, 'support': 515310}}
[[ 40415  35090  12919]
 [ 62445 209964  67822]
 [ 13398  33351  39906]]
Evaluating performance on  val set...
696/696 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8923364
{'0': {'precision': 0.33123312331233123, 'recall': 0.4773189371100049, 'f1-score': 0.39107894245544494, 'support': 28526}, '1': {'precision': 0.7751673474303262, 'recall': 0.6363538997684938, 'f1-score': 0.6989349476522699, 'support': 121379}, '2': {'precision': 0.3292450039000511, 'recall': 0.4368041678561233, 'f1-score': 0.375473521157002, 'support': 28024}, 'accuracy': 0.5794277492707766, 'macro avg': {'precision': 0.47854849154756957, 'recall': 0.516825668244874, 'f1-score': 0.48849580375490564, 'support': 177929}, 'weighted avg': {'precision': 0.6337615314459596, 'recall': 0.5794277492707766, 'f1-score': 0.5986332350570885, 'support': 177929}}
[[13616 11206  3704]
 [22905 77240 21234]
 [ 4586 11197 12241]]
training model: results/AAL/W7/deepOF_L1/h30
Epoch 1/50
2013/2013 - 46s - loss: 3.1626 - accuracy30: 0.4047 - val_loss: 3.1130 - val_accuracy30: 0.5625 - 46s/epoch - 23ms/step
Epoch 2/50
2013/2013 - 43s - loss: 3.1111 - accuracy30: 0.4057 - val_loss: 3.0583 - val_accuracy30: 0.5455 - 43s/epoch - 21ms/step
Epoch 3/50
2013/2013 - 43s - loss: 3.0809 - accuracy30: 0.4269 - val_loss: 3.0491 - val_accuracy30: 0.5508 - 43s/epoch - 22ms/step
Epoch 4/50
2013/2013 - 44s - loss: 3.0603 - accuracy30: 0.4414 - val_loss: 3.0281 - val_accuracy30: 0.5466 - 44s/epoch - 22ms/step
Epoch 5/50
2013/2013 - 44s - loss: 3.0451 - accuracy30: 0.4495 - val_loss: 3.0248 - val_accuracy30: 0.5568 - 44s/epoch - 22ms/step
Epoch 6/50
2013/2013 - 42s - loss: 3.0312 - accuracy30: 0.4555 - val_loss: 3.0165 - val_accuracy30: 0.5544 - 42s/epoch - 21ms/step
Epoch 7/50
2013/2013 - 42s - loss: 3.0196 - accuracy30: 0.4603 - val_loss: 3.0184 - val_accuracy30: 0.5710 - 42s/epoch - 21ms/step
Epoch 8/50
2013/2013 - 43s - loss: 3.0085 - accuracy30: 0.4628 - val_loss: 3.0167 - val_accuracy30: 0.5785 - 43s/epoch - 21ms/step
Epoch 9/50
2013/2013 - 43s - loss: 2.9995 - accuracy30: 0.4664 - val_loss: 3.0019 - val_accuracy30: 0.5738 - 43s/epoch - 22ms/step
Epoch 10/50
2013/2013 - 42s - loss: 2.9896 - accuracy30: 0.4686 - val_loss: 3.0057 - val_accuracy30: 0.5754 - 42s/epoch - 21ms/step
Epoch 11/50
2013/2013 - 43s - loss: 2.9824 - accuracy30: 0.4717 - val_loss: 3.0043 - val_accuracy30: 0.5748 - 43s/epoch - 21ms/step
Epoch 12/50
2013/2013 - 43s - loss: 2.9840 - accuracy30: 0.4703 - val_loss: 3.0082 - val_accuracy30: 0.5747 - 43s/epoch - 22ms/step
Epoch 13/50
2013/2013 - 44s - loss: 2.9661 - accuracy30: 0.4770 - val_loss: 3.0179 - val_accuracy30: 0.5815 - 44s/epoch - 22ms/step
Epoch 14/50
2013/2013 - 43s - loss: 2.9568 - accuracy30: 0.4799 - val_loss: 3.0093 - val_accuracy30: 0.5771 - 43s/epoch - 21ms/step
Epoch 15/50
2013/2013 - 42s - loss: 2.9476 - accuracy30: 0.4834 - val_loss: 3.0131 - val_accuracy30: 0.5844 - 42s/epoch - 21ms/step
Epoch 16/50
2013/2013 - 43s - loss: 2.9403 - accuracy30: 0.4856 - val_loss: 2.9922 - val_accuracy30: 0.5755 - 43s/epoch - 21ms/step
Epoch 17/50
2013/2013 - 43s - loss: 2.9321 - accuracy30: 0.4872 - val_loss: 3.0076 - val_accuracy30: 0.5800 - 43s/epoch - 21ms/step
Epoch 18/50
2013/2013 - 43s - loss: 2.9230 - accuracy30: 0.4893 - val_loss: 2.9929 - val_accuracy30: 0.5763 - 43s/epoch - 22ms/step
Epoch 19/50
2013/2013 - 43s - loss: 2.9134 - accuracy30: 0.4924 - val_loss: 2.9838 - val_accuracy30: 0.5701 - 43s/epoch - 22ms/step
Epoch 20/50
2013/2013 - 44s - loss: 2.9054 - accuracy30: 0.4955 - val_loss: 2.9742 - val_accuracy30: 0.5649 - 44s/epoch - 22ms/step
Epoch 21/50
2013/2013 - 44s - loss: 2.9084 - accuracy30: 0.4945 - val_loss: 2.9815 - val_accuracy30: 0.5715 - 44s/epoch - 22ms/step
Epoch 22/50
2013/2013 - 43s - loss: 2.8920 - accuracy30: 0.4977 - val_loss: 2.9696 - val_accuracy30: 0.5680 - 43s/epoch - 21ms/step
Epoch 23/50
2013/2013 - 43s - loss: 2.8807 - accuracy30: 0.5006 - val_loss: 2.9622 - val_accuracy30: 0.5609 - 43s/epoch - 21ms/step
Epoch 24/50
2013/2013 - 42s - loss: 2.8746 - accuracy30: 0.5038 - val_loss: 2.9565 - val_accuracy30: 0.5658 - 42s/epoch - 21ms/step
Epoch 25/50
2013/2013 - 42s - loss: 2.8657 - accuracy30: 0.5064 - val_loss: 2.9382 - val_accuracy30: 0.5492 - 42s/epoch - 21ms/step
Epoch 26/50
2013/2013 - 43s - loss: 2.8607 - accuracy30: 0.5067 - val_loss: 2.9391 - val_accuracy30: 0.5562 - 43s/epoch - 21ms/step
Epoch 27/50
2013/2013 - 44s - loss: 2.8518 - accuracy30: 0.5092 - val_loss: 2.9321 - val_accuracy30: 0.5473 - 44s/epoch - 22ms/step
Epoch 28/50
2013/2013 - 43s - loss: 2.8457 - accuracy30: 0.5119 - val_loss: 2.9316 - val_accuracy30: 0.5611 - 43s/epoch - 21ms/step
Epoch 29/50
2013/2013 - 43s - loss: 2.8395 - accuracy30: 0.5127 - val_loss: 2.9228 - val_accuracy30: 0.5411 - 43s/epoch - 22ms/step
Epoch 30/50
2013/2013 - 41s - loss: 2.8312 - accuracy30: 0.5152 - val_loss: 2.9208 - val_accuracy30: 0.5513 - 41s/epoch - 21ms/step
Epoch 31/50
2013/2013 - 43s - loss: 2.8255 - accuracy30: 0.5166 - val_loss: 2.9377 - val_accuracy30: 0.5575 - 43s/epoch - 21ms/step
Epoch 32/50
2013/2013 - 42s - loss: 2.8180 - accuracy30: 0.5179 - val_loss: 2.9311 - val_accuracy30: 0.5464 - 42s/epoch - 21ms/step
Epoch 33/50
2013/2013 - 43s - loss: 2.8110 - accuracy30: 0.5185 - val_loss: 2.9212 - val_accuracy30: 0.5463 - 43s/epoch - 21ms/step
Epoch 34/50
2013/2013 - 42s - loss: 2.8043 - accuracy30: 0.5203 - val_loss: 2.9171 - val_accuracy30: 0.5364 - 42s/epoch - 21ms/step
Epoch 35/50
2013/2013 - 42s - loss: 2.7979 - accuracy30: 0.5217 - val_loss: 2.9293 - val_accuracy30: 0.5446 - 42s/epoch - 21ms/step
Epoch 36/50
2013/2013 - 43s - loss: 2.7925 - accuracy30: 0.5225 - val_loss: 2.9205 - val_accuracy30: 0.5400 - 43s/epoch - 21ms/step
Epoch 37/50
2013/2013 - 43s - loss: 2.7873 - accuracy30: 0.5236 - val_loss: 2.9294 - val_accuracy30: 0.5429 - 43s/epoch - 21ms/step
Epoch 38/50
2013/2013 - 42s - loss: 2.7789 - accuracy30: 0.5259 - val_loss: 2.9258 - val_accuracy30: 0.5354 - 42s/epoch - 21ms/step
Epoch 39/50
2013/2013 - 42s - loss: 2.7736 - accuracy30: 0.5264 - val_loss: 2.9334 - val_accuracy30: 0.5413 - 42s/epoch - 21ms/step
Epoch 40/50
2013/2013 - 43s - loss: 2.7682 - accuracy30: 0.5280 - val_loss: 2.9374 - val_accuracy30: 0.5433 - 43s/epoch - 21ms/step
Epoch 41/50
2013/2013 - 42s - loss: 2.7607 - accuracy30: 0.5296 - val_loss: 2.9410 - val_accuracy30: 0.5307 - 42s/epoch - 21ms/step
Epoch 42/50
2013/2013 - 42s - loss: 2.7551 - accuracy30: 0.5303 - val_loss: 2.9385 - val_accuracy30: 0.5396 - 42s/epoch - 21ms/step
Epoch 43/50
2013/2013 - 42s - loss: 2.7477 - accuracy30: 0.5319 - val_loss: 2.9492 - val_accuracy30: 0.5422 - 42s/epoch - 21ms/step
Epoch 44/50
2013/2013 - 42s - loss: 2.7460 - accuracy30: 0.5315 - val_loss: 2.9390 - val_accuracy30: 0.5401 - 42s/epoch - 21ms/step
testing model: results/AAL/W7/deepOF_L1/h30
Evaluating performance on  test set...
5331/5331 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9358541
{'0': {'precision': 0.33481826131432624, 'recall': 0.5111415233745298, 'f1-score': 0.4046043777477229, 'support': 238208}, '1': {'precision': 0.7636773837767042, 'recall': 0.6010337219868801, 'f1-score': 0.6726637724717538, 'support': 884764}, '2': {'precision': 0.3470708927662787, 'recall': 0.4375426790658406, 'f1-score': 0.3870907506535541, 'support': 241629}, 'accuracy': 0.5563926744887333, 'macro avg': {'precision': 0.4818555126191031, 'recall': 0.5165726414757502, 'f1-score': 0.48811963362434363, 'support': 1364601}, 'weighted avg': {'precision': 0.6150464772627297, 'recall': 0.5563926744887333, 'f1-score': 0.5753044593924495, 'support': 1364601}}
[[121758  77782  38668]
 [192767 531773 160224]
 [ 49129  86777 105723]]
Evaluating performance on  train set...
2013/2013 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9632915
{'0': {'precision': 0.3571253835454628, 'recall': 0.48709222292131404, 'f1-score': 0.41210464126853547, 'support': 104898}, '1': {'precision': 0.7075458285943668, 'recall': 0.5500918385591912, 'f1-score': 0.6189623543914389, 'support': 307605}, '2': {'precision': 0.36252770785588156, 'recall': 0.46929683776396547, 'f1-score': 0.40906007834093566, 'support': 102807}, 'accuracy': 0.5211484349226679, 'macro avg': {'precision': 0.47573297333190373, 'recall': 0.5021602997481569, 'f1-score': 0.4800423580003033, 'support': 515310}, 'weighted avg': {'precision': 0.5673803325172455, 'recall': 0.5211484349226679, 'f1-score': 0.534977212078869, 'support': 515310}}
[[ 51095  36258  17545]
 [ 71101 169211  67293]
 [ 20877  33683  48247]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9474631
{'0': {'precision': 0.344364461098511, 'recall': 0.512263099219621, 'f1-score': 0.4118597492658419, 'support': 34086}, '1': {'precision': 0.731469198724662, 'recall': 0.5701212599424991, 'f1-score': 0.6407947114379935, 'support': 110259}, '2': {'precision': 0.3621808845613525, 'recall': 0.44524178180085755, 'f1-score': 0.3994390276479231, 'support': 33584}, 'accuracy': 0.5354663938986899, 'macro avg': {'precision': 0.47933818146150853, 'recall': 0.5092087136543259, 'f1-score': 0.48403116278391956, 'support': 177929}, 'weighted avg': {'precision': 0.5876082720090305, 'recall': 0.5354663938986899, 'f1-score': 0.5513817073464419, 'support': 177929}}
[[17461 11646  4979]
 [26044 62861 21354]
 [ 7200 11431 14953]]
training model: results/AAL/W7/deepOF_L1/h50
Epoch 1/50
2013/2013 - 45s - loss: 3.2116 - accuracy50: 0.4024 - val_loss: 3.1799 - val_accuracy50: 0.4919 - 45s/epoch - 22ms/step
Epoch 2/50
2013/2013 - 42s - loss: 3.1714 - accuracy50: 0.4101 - val_loss: 3.1515 - val_accuracy50: 0.4798 - 42s/epoch - 21ms/step
Epoch 3/50
2013/2013 - 43s - loss: 3.1502 - accuracy50: 0.4210 - val_loss: 3.1385 - val_accuracy50: 0.4796 - 43s/epoch - 21ms/step
Epoch 4/50
2013/2013 - 43s - loss: 3.1340 - accuracy50: 0.4312 - val_loss: 3.1315 - val_accuracy50: 0.4884 - 43s/epoch - 22ms/step
Epoch 5/50
2013/2013 - 42s - loss: 3.1214 - accuracy50: 0.4380 - val_loss: 3.1294 - val_accuracy50: 0.4877 - 42s/epoch - 21ms/step
Epoch 6/50
2013/2013 - 43s - loss: 3.1109 - accuracy50: 0.4431 - val_loss: 3.1190 - val_accuracy50: 0.4922 - 43s/epoch - 21ms/step
Epoch 7/50
2013/2013 - 42s - loss: 3.1013 - accuracy50: 0.4477 - val_loss: 3.1228 - val_accuracy50: 0.4905 - 42s/epoch - 21ms/step
Epoch 8/50
2013/2013 - 42s - loss: 3.0936 - accuracy50: 0.4499 - val_loss: 3.1243 - val_accuracy50: 0.4934 - 42s/epoch - 21ms/step
Epoch 9/50
2013/2013 - 42s - loss: 3.0865 - accuracy50: 0.4527 - val_loss: 3.1203 - val_accuracy50: 0.4989 - 42s/epoch - 21ms/step
Epoch 10/50
2013/2013 - 42s - loss: 3.0792 - accuracy50: 0.4556 - val_loss: 3.1202 - val_accuracy50: 0.5046 - 42s/epoch - 21ms/step
Epoch 11/50
2013/2013 - 41s - loss: 3.0719 - accuracy50: 0.4577 - val_loss: 3.1236 - val_accuracy50: 0.5070 - 41s/epoch - 21ms/step
Epoch 12/50
2013/2013 - 42s - loss: 3.0661 - accuracy50: 0.4598 - val_loss: 3.1263 - val_accuracy50: 0.5051 - 42s/epoch - 21ms/step
Epoch 13/50
2013/2013 - 42s - loss: 3.0596 - accuracy50: 0.4616 - val_loss: 3.1279 - val_accuracy50: 0.5086 - 42s/epoch - 21ms/step
Epoch 14/50
2013/2013 - 43s - loss: 3.0552 - accuracy50: 0.4632 - val_loss: 3.1214 - val_accuracy50: 0.5102 - 43s/epoch - 21ms/step
Epoch 15/50
2013/2013 - 42s - loss: 3.0452 - accuracy50: 0.4664 - val_loss: 3.1415 - val_accuracy50: 0.5159 - 42s/epoch - 21ms/step
Epoch 16/50
2013/2013 - 42s - loss: 3.0407 - accuracy50: 0.4679 - val_loss: 3.1377 - val_accuracy50: 0.5159 - 42s/epoch - 21ms/step
testing model: results/AAL/W7/deepOF_L1/h50
Evaluating performance on  test set...
5331/5331 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0205584
{'0': {'precision': 0.34530449005068575, 'recall': 0.39886376532948803, 'f1-score': 0.37015674369617746, 'support': 299586}, '1': {'precision': 0.6022681663544972, 'recall': 0.6627364380824691, 'f1-score': 0.6310570853896499, 'support': 760770}, '2': {'precision': 0.3885002342953224, 'recall': 0.2316291146937501, 'f1-score': 0.29022321060868134, 'support': 304245}, 'accuracy': 0.5086878875217005, 'macro avg': {'precision': 0.4453576302335018, 'recall': 0.4310764393685691, 'f1-score': 0.4304790132315029, 'support': 1364601}, 'weighted avg': {'precision': 0.498193389611334, 'recall': 0.5086878875217005, 'f1-score': 0.497788025789579, 'support': 1364601}}
[[119494 154702  25390]
 [171047 504190  85533]
 [ 55513 178260  70472]]
Evaluating performance on  train set...
2013/2013 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.029489
{'0': {'precision': 0.3877067979073317, 'recall': 0.364961316543612, 'f1-score': 0.37599037525427215, 'support': 130159}, '1': {'precision': 0.5377938585570793, 'recall': 0.6620585564962326, 'f1-score': 0.5934913681413375, 'support': 257734}, '2': {'precision': 0.42743046357615894, 'recall': 0.25327075664942666, 'f1-score': 0.31807093540708764, 'support': 127417}, 'accuracy': 0.48593856125439056, 'macro avg': {'precision': 0.45097704001352334, 'recall': 0.4267635432297571, 'f1-score': 0.4291842262675658, 'support': 515310}, 'weighted avg': {'precision': 0.4725955227487417, 'recall': 0.48593856125439056, 'f1-score': 0.4704528922513151, 'support': 515310}}
[[ 47503  71370  11286]
 [ 55156 170635  31943]
 [ 19864  75282  32271]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.024309
{'0': {'precision': 0.37846630518977536, 'recall': 0.39908053487666567, 'f1-score': 0.3885001590258531, 'support': 42851}, '1': {'precision': 0.5663752444495571, 'recall': 0.6357004519044545, 'f1-score': 0.5990388125076043, 'support': 92940}, '2': {'precision': 0.40224426621640635, 'recall': 0.271370259623143, 'f1-score': 0.3240937561998696, 'support': 42138}, 'accuracy': 0.4924323747112612, 'macro avg': {'precision': 0.4490286052852463, 'recall': 0.435383748801421, 'f1-score': 0.4372109092444423, 'support': 177929}, 'weighted avg': {'precision': 0.48225046930323795, 'recall': 0.4924323747112612, 'f1-score': 0.48322055565772687, 'support': 177929}}
[[17101 21798  3952]
 [20817 59082 13041]
 [ 7267 23436 11435]]
training model: results/AAL/W7/deepOF_L1/h100
Epoch 1/50
2013/2013 - 44s - loss: 3.2662 - accuracy100: 0.3897 - val_loss: 3.2573 - val_accuracy100: 0.3990 - 44s/epoch - 22ms/step
Epoch 2/50
2013/2013 - 42s - loss: 3.2448 - accuracy100: 0.3979 - val_loss: 3.2486 - val_accuracy100: 0.4008 - 42s/epoch - 21ms/step
Epoch 3/50
2013/2013 - 42s - loss: 3.2351 - accuracy100: 0.4035 - val_loss: 3.2448 - val_accuracy100: 0.4023 - 42s/epoch - 21ms/step
Epoch 4/50
2013/2013 - 42s - loss: 3.2278 - accuracy100: 0.4074 - val_loss: 3.2433 - val_accuracy100: 0.4066 - 42s/epoch - 21ms/step
Epoch 5/50
2013/2013 - 42s - loss: 3.2207 - accuracy100: 0.4121 - val_loss: 3.2425 - val_accuracy100: 0.4101 - 42s/epoch - 21ms/step
Epoch 6/50
2013/2013 - 41s - loss: 3.2139 - accuracy100: 0.4158 - val_loss: 3.2385 - val_accuracy100: 0.4128 - 41s/epoch - 20ms/step
Epoch 7/50
2013/2013 - 42s - loss: 3.2081 - accuracy100: 0.4195 - val_loss: 3.2403 - val_accuracy100: 0.4135 - 42s/epoch - 21ms/step
Epoch 8/50
2013/2013 - 42s - loss: 3.2039 - accuracy100: 0.4214 - val_loss: 3.2378 - val_accuracy100: 0.4153 - 42s/epoch - 21ms/step
Epoch 9/50
2013/2013 - 41s - loss: 3.1992 - accuracy100: 0.4247 - val_loss: 3.2406 - val_accuracy100: 0.4154 - 41s/epoch - 21ms/step
Epoch 10/50
2013/2013 - 41s - loss: 3.1957 - accuracy100: 0.4252 - val_loss: 3.2415 - val_accuracy100: 0.4157 - 41s/epoch - 20ms/step
Epoch 11/50
2013/2013 - 42s - loss: 3.1918 - accuracy100: 0.4277 - val_loss: 3.2428 - val_accuracy100: 0.4175 - 42s/epoch - 21ms/step
Epoch 12/50
2013/2013 - 42s - loss: 3.1882 - accuracy100: 0.4284 - val_loss: 3.2421 - val_accuracy100: 0.4181 - 42s/epoch - 21ms/step
Epoch 13/50
2013/2013 - 43s - loss: 3.1845 - accuracy100: 0.4306 - val_loss: 3.2485 - val_accuracy100: 0.4187 - 43s/epoch - 21ms/step
Epoch 14/50
2013/2013 - 42s - loss: 3.1819 - accuracy100: 0.4306 - val_loss: 3.2414 - val_accuracy100: 0.4186 - 42s/epoch - 21ms/step
Epoch 15/50
2013/2013 - 42s - loss: 3.1779 - accuracy100: 0.4324 - val_loss: 3.2430 - val_accuracy100: 0.4191 - 42s/epoch - 21ms/step
Epoch 16/50
2013/2013 - 43s - loss: 3.1748 - accuracy100: 0.4339 - val_loss: 3.2432 - val_accuracy100: 0.4190 - 43s/epoch - 21ms/step
Epoch 17/50
2013/2013 - 42s - loss: 3.1708 - accuracy100: 0.4354 - val_loss: 3.2437 - val_accuracy100: 0.4194 - 42s/epoch - 21ms/step
Epoch 18/50
2013/2013 - 42s - loss: 3.1675 - accuracy100: 0.4365 - val_loss: 3.2477 - val_accuracy100: 0.4198 - 42s/epoch - 21ms/step
testing model: results/AAL/W7/deepOF_L1/h100
Evaluating performance on  test set...
5331/5331 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0674778
{'0': {'precision': 0.4085809112449612, 'recall': 0.24965940936663092, 'f1-score': 0.3099356444318688, 'support': 386094}, '1': {'precision': 0.45676887623695267, 'recall': 0.7203512156412045, 'f1-score': 0.5590491871383567, 'support': 584712}, '2': {'precision': 0.3999428729115934, 'recall': 0.2097817392298023, 'f1-score': 0.2752085443206652, 'support': 393795}, 'accuracy': 0.4398362598297964, 'macro avg': {'precision': 0.4217642201311691, 'recall': 0.3932641214125459, 'f1-score': 0.3813977919636303, 'support': 1364601}, 'weighted avg': {'precision': 0.426736009387868, 'recall': 0.4398362598297964, 'f1-score': 0.40665572553594576, 'support': 1364601}}
[[ 96392 244424  45278]
 [ 84846 421198  78668]
 [ 54681 256503  82611]]
Evaluating performance on  train set...
2013/2013 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.081458
{'0': {'precision': 0.44826118820775906, 'recall': 0.22865929030118484, 'f1-score': 0.3028393686387721, 'support': 165845}, '1': {'precision': 0.38535795815482077, 'recall': 0.7086029133308087, 'f1-score': 0.4992240196907352, 'support': 187483}, '2': {'precision': 0.43458384226138547, 'recall': 0.23063673741526836, 'f1-score': 0.30134665876175154, 'support': 161982}, 'accuracy': 0.4038966835497079, 'macro avg': {'precision': 0.4227343295413218, 'recall': 0.389299647015754, 'f1-score': 0.3678033490304196, 'support': 515310}, 'weighted avg': {'precision': 0.4210760566731478, 'recall': 0.4038966835497079, 'f1-score': 0.37381992675306375, 'support': 515310}}
[[ 37922 107041  20882]
 [ 26908 132851  27724]
 [ 19768 104855  37359]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.076752
{'0': {'precision': 0.4319129002035344, 'recall': 0.24379969363192064, 'f1-score': 0.31167165953677045, 'support': 54836}, '1': {'precision': 0.41227648785695226, 'recall': 0.6734871824681742, 'f1-score': 0.5114610808842194, 'support': 68812}, '2': {'precision': 0.4128044899612336, 'recall': 0.26287282842983734, 'f1-score': 0.32120386732247574, 'support': 54281}, 'accuracy': 0.4157950643234099, 'macro avg': {'precision': 0.41899795934057343, 'recall': 0.393386568176644, 'f1-score': 0.38144553591448854, 'support': 177929}, 'weighted avg': {'precision': 0.41848931875950146, 'recall': 0.4157950643234099, 'f1-score': 0.39184592810781016, 'support': 177929}}
[[13369 33360  8107]
 [10278 46344 12190]
 [ 7306 32706 14269]]
training model: results/AAL/W7/deepOF_L1/h200
Epoch 1/50
2013/2013 - 45s - loss: 3.2952 - accuracy200: 0.3673 - val_loss: 3.2910 - val_accuracy200: 0.3517 - 45s/epoch - 22ms/step
Epoch 2/50
2013/2013 - 42s - loss: 3.2784 - accuracy200: 0.3747 - val_loss: 3.2834 - val_accuracy200: 0.3627 - 42s/epoch - 21ms/step
Epoch 3/50
2013/2013 - 42s - loss: 3.2735 - accuracy200: 0.3786 - val_loss: 3.2809 - val_accuracy200: 0.3674 - 42s/epoch - 21ms/step
Epoch 4/50
2013/2013 - 42s - loss: 3.2705 - accuracy200: 0.3806 - val_loss: 3.2795 - val_accuracy200: 0.3690 - 42s/epoch - 21ms/step
Epoch 5/50
2013/2013 - 42s - loss: 3.2678 - accuracy200: 0.3825 - val_loss: 3.2787 - val_accuracy200: 0.3694 - 42s/epoch - 21ms/step
Epoch 6/50
2013/2013 - 42s - loss: 3.2653 - accuracy200: 0.3842 - val_loss: 3.2780 - val_accuracy200: 0.3721 - 42s/epoch - 21ms/step
Epoch 7/50
2013/2013 - 42s - loss: 3.2632 - accuracy200: 0.3857 - val_loss: 3.2777 - val_accuracy200: 0.3715 - 42s/epoch - 21ms/step
Epoch 8/50
2013/2013 - 42s - loss: 3.2609 - accuracy200: 0.3876 - val_loss: 3.2774 - val_accuracy200: 0.3732 - 42s/epoch - 21ms/step
Epoch 9/50
2013/2013 - 42s - loss: 3.2593 - accuracy200: 0.3884 - val_loss: 3.2774 - val_accuracy200: 0.3725 - 42s/epoch - 21ms/step
Epoch 10/50
2013/2013 - 42s - loss: 3.2576 - accuracy200: 0.3900 - val_loss: 3.2765 - val_accuracy200: 0.3747 - 42s/epoch - 21ms/step
Epoch 11/50
2013/2013 - 44s - loss: 3.2557 - accuracy200: 0.3910 - val_loss: 3.2775 - val_accuracy200: 0.3744 - 44s/epoch - 22ms/step
Epoch 12/50
2013/2013 - 41s - loss: 3.2539 - accuracy200: 0.3932 - val_loss: 3.2786 - val_accuracy200: 0.3750 - 41s/epoch - 21ms/step
Epoch 13/50
2013/2013 - 43s - loss: 3.2523 - accuracy200: 0.3941 - val_loss: 3.2789 - val_accuracy200: 0.3738 - 43s/epoch - 21ms/step
Epoch 14/50
2013/2013 - 41s - loss: 3.2506 - accuracy200: 0.3959 - val_loss: 3.2794 - val_accuracy200: 0.3745 - 41s/epoch - 21ms/step
Epoch 15/50
2013/2013 - 43s - loss: 3.2489 - accuracy200: 0.3964 - val_loss: 3.2807 - val_accuracy200: 0.3744 - 43s/epoch - 21ms/step
Epoch 16/50
2013/2013 - 43s - loss: 3.2469 - accuracy200: 0.3979 - val_loss: 3.2818 - val_accuracy200: 0.3735 - 43s/epoch - 22ms/step
Epoch 17/50
2013/2013 - 43s - loss: 3.2456 - accuracy200: 0.3989 - val_loss: 3.2868 - val_accuracy200: 0.3724 - 43s/epoch - 21ms/step
Epoch 18/50
2013/2013 - 42s - loss: 3.2439 - accuracy200: 0.4004 - val_loss: 3.2862 - val_accuracy200: 0.3720 - 42s/epoch - 21ms/step
Epoch 19/50
2013/2013 - 42s - loss: 3.2414 - accuracy200: 0.4024 - val_loss: 3.2903 - val_accuracy200: 0.3721 - 42s/epoch - 21ms/step
Epoch 20/50
2013/2013 - 42s - loss: 3.2401 - accuracy200: 0.4029 - val_loss: 3.2889 - val_accuracy200: 0.3706 - 42s/epoch - 21ms/step
testing model: results/AAL/W7/deepOF_L1/h200
Evaluating performance on  test set...
5331/5331 - 72s - 72s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0890638
{'0': {'precision': 0.3749209378115586, 'recall': 0.24907060549517854, 'f1-score': 0.2993046492222769, 'support': 421242}, '1': {'precision': 0.3972873730925892, 'recall': 0.6337269855061782, 'f1-score': 0.48839616486391757, 'support': 515599}, '2': {'precision': 0.38112447961937873, 'recall': 0.23371049186459697, 'f1-score': 0.28974535842844473, 'support': 427760}, 'accuracy': 0.3895937347253886, 'macro avg': {'precision': 0.38444426350784217, 'recall': 0.3721693609553179, 'f1-score': 0.35914872417154636, 'support': 1364601}, 'weighted avg': {'precision': 0.38531645907248196, 'recall': 0.3895937347253886, 'f1-score': 0.3677541917210327, 'support': 1364601}}
[[104919 245370  70953]
 [ 97467 326749  91383]
 [ 77457 250331  99972]]
Evaluating performance on  train set...
2013/2013 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0951328
{'0': {'precision': 0.414759392614286, 'recall': 0.23178024761936789, 'f1-score': 0.2973770786516854, 'support': 178419}, '1': {'precision': 0.33104010197980116, 'recall': 0.6137390817059949, 'f1-score': 0.43009467546548064, 'support': 164174}, '2': {'precision': 0.4051604782882316, 'recall': 0.2609239391605922, 'f1-score': 0.31742543502836795, 'support': 172717}, 'accuracy': 0.363237662766102, 'macro avg': {'precision': 0.38365332429410626, 'recall': 0.3688144228286516, 'f1-score': 0.3482990630485114, 'support': 515310}, 'weighted avg': {'precision': 0.3848697601478501, 'recall': 0.363237662766102, 'f1-score': 0.34637956396658226, 'support': 515310}}
[[ 41354 104186  32879]
 [ 30129 100760  33285]
 [ 28223  99428  45066]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0923233
{'0': {'precision': 0.40254422362961345, 'recall': 0.24974172241510711, 'f1-score': 0.30824545083980476, 'support': 59045}, '1': {'precision': 0.3520103553116126, 'recall': 0.5864720731564605, 'f1-score': 0.4399533472121197, 'support': 59817}, '2': {'precision': 0.4006196263028964, 'recall': 0.28240811282103373, 'f1-score': 0.331284444665111, 'support': 59067}, 'accuracy': 0.37378954526805636, 'macro avg': {'precision': 0.3850580684147074, 'recall': 0.3728739694642004, 'f1-score': 0.3598277475723452, 'support': 177929}, 'weighted avg': {'precision': 0.3849166047958367, 'recall': 0.37378954526805636, 'f1-score': 0.36017186803757534, 'support': 177929}}
[[14746 32540 11759]
 [11538 35081 13198]
 [10348 32038 16681]]
training model: results/AAL/W7/deepOF_L1/h300
Epoch 1/50
2013/2013 - 45s - loss: 3.3040 - accuracy300: 0.3553 - val_loss: 3.3006 - val_accuracy300: 0.3433 - 45s/epoch - 22ms/step
Epoch 2/50
2013/2013 - 43s - loss: 3.2894 - accuracy300: 0.3583 - val_loss: 3.2941 - val_accuracy300: 0.3443 - 43s/epoch - 21ms/step
Epoch 3/50
2013/2013 - 42s - loss: 3.2857 - accuracy300: 0.3617 - val_loss: 3.2915 - val_accuracy300: 0.3471 - 42s/epoch - 21ms/step
Epoch 4/50
2013/2013 - 42s - loss: 3.2835 - accuracy300: 0.3637 - val_loss: 3.2900 - val_accuracy300: 0.3502 - 42s/epoch - 21ms/step
Epoch 5/50
2013/2013 - 42s - loss: 3.2821 - accuracy300: 0.3644 - val_loss: 3.2898 - val_accuracy300: 0.3504 - 42s/epoch - 21ms/step
Epoch 6/50
2013/2013 - 41s - loss: 3.2810 - accuracy300: 0.3663 - val_loss: 3.2897 - val_accuracy300: 0.3500 - 41s/epoch - 21ms/step
Epoch 7/50
2013/2013 - 43s - loss: 3.2799 - accuracy300: 0.3671 - val_loss: 3.2893 - val_accuracy300: 0.3534 - 43s/epoch - 21ms/step
Epoch 8/50
2013/2013 - 43s - loss: 3.2788 - accuracy300: 0.3684 - val_loss: 3.2891 - val_accuracy300: 0.3527 - 43s/epoch - 21ms/step
Epoch 9/50
2013/2013 - 42s - loss: 3.2775 - accuracy300: 0.3702 - val_loss: 3.2890 - val_accuracy300: 0.3526 - 42s/epoch - 21ms/step
Epoch 10/50
2013/2013 - 42s - loss: 3.2767 - accuracy300: 0.3702 - val_loss: 3.2894 - val_accuracy300: 0.3538 - 42s/epoch - 21ms/step
Epoch 11/50
2013/2013 - 43s - loss: 3.2758 - accuracy300: 0.3714 - val_loss: 3.2889 - val_accuracy300: 0.3538 - 43s/epoch - 21ms/step
Epoch 12/50
2013/2013 - 43s - loss: 3.2748 - accuracy300: 0.3725 - val_loss: 3.2900 - val_accuracy300: 0.3538 - 43s/epoch - 21ms/step
Epoch 13/50
2013/2013 - 42s - loss: 3.2737 - accuracy300: 0.3739 - val_loss: 3.2902 - val_accuracy300: 0.3531 - 42s/epoch - 21ms/step
Epoch 14/50
2013/2013 - 41s - loss: 3.2726 - accuracy300: 0.3747 - val_loss: 3.2909 - val_accuracy300: 0.3536 - 41s/epoch - 21ms/step
Epoch 15/50
2013/2013 - 43s - loss: 3.2710 - accuracy300: 0.3761 - val_loss: 3.2918 - val_accuracy300: 0.3525 - 43s/epoch - 21ms/step
Epoch 16/50
2013/2013 - 42s - loss: 3.2700 - accuracy300: 0.3778 - val_loss: 3.2924 - val_accuracy300: 0.3534 - 42s/epoch - 21ms/step
Epoch 17/50
2013/2013 - 41s - loss: 3.2689 - accuracy300: 0.3785 - val_loss: 3.2946 - val_accuracy300: 0.3517 - 41s/epoch - 20ms/step
Epoch 18/50
2013/2013 - 42s - loss: 3.2675 - accuracy300: 0.3802 - val_loss: 3.2966 - val_accuracy300: 0.3513 - 42s/epoch - 21ms/step
Epoch 19/50
2013/2013 - 42s - loss: 3.2663 - accuracy300: 0.3811 - val_loss: 3.3005 - val_accuracy300: 0.3494 - 42s/epoch - 21ms/step
Epoch 20/50
2013/2013 - 43s - loss: 3.2646 - accuracy300: 0.3821 - val_loss: 3.3013 - val_accuracy300: 0.3502 - 43s/epoch - 21ms/step
Epoch 21/50
2013/2013 - 42s - loss: 3.2635 - accuracy300: 0.3841 - val_loss: 3.3010 - val_accuracy300: 0.3508 - 42s/epoch - 21ms/step
testing model: results/AAL/W7/deepOF_L1/h300
Evaluating performance on  test set...
5331/5331 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0929458
{'0': {'precision': 0.32742676792986575, 'recall': 0.3894054169768268, 'f1-score': 0.35573669759736165, 'support': 411078}, '1': {'precision': 0.3936911820896367, 'recall': 0.5223290142939487, 'f1-score': 0.4489777144411099, 'support': 532603}, '2': {'precision': 0.3393837236810977, 'recall': 0.13632756818397795, 'f1-score': 0.19451864406779662, 'support': 420920}, 'accuracy': 0.3632219234779983, 'macro avg': {'precision': 0.3535005579002, 'recall': 0.34935399981825116, 'f1-score': 0.33307768536875604, 'support': 1364601}, 'weighted avg': {'precision': 0.3569779316689698, 'recall': 0.3632219234779983, 'f1-score': 0.34239986302254183, 'support': 1364601}}
[[160076 205623  45379]
 [188091 278194  66318]
 [140724 222813  57383]]
Evaluating performance on  train set...
2013/2013 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952451
{'0': {'precision': 0.37408347593522284, 'recall': 0.3783085306943402, 'f1-score': 0.37618414042445286, 'support': 174511}, '1': {'precision': 0.3381379512337995, 'recall': 0.5336757924905525, 'f1-score': 0.41397842232890036, 'support': 173062}, '2': {'precision': 0.36320180246011446, 'recall': 0.1422345695940669, 'f1-score': 0.20441683624290458, 'support': 167737}, 'accuracy': 0.3536434379305661, 'macro avg': {'precision': 0.35847440987637896, 'recall': 0.3514062975929866, 'f1-score': 0.331526466332086, 'support': 515310}, 'weighted avg': {'precision': 0.35846945008753506, 'recall': 0.3536434379305661, 'f1-score': 0.3329655374736992, 'support': 515310}}
[[66019 88661 19831]
 [58704 92359 21999]
 [51759 92120 23858]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0956423
{'0': {'precision': 0.3618380232855214, 'recall': 0.3393752674368849, 'f1-score': 0.3502468579705537, 'support': 58425}, '1': {'precision': 0.3453855274038797, 'recall': 0.5715463373617133, 'f1-score': 0.43057470407770365, 'support': 60653}, '2': {'precision': 0.371759950795185, 'recall': 0.14378685154033066, 'f1-score': 0.2073689240684695, 'support': 58851}, 'accuracy': 0.35382652631105665, 'macro avg': {'precision': 0.3596611671615287, 'recall': 0.3515694854463096, 'f1-score': 0.32939682870557563, 'support': 177929}, 'weighted avg': {'precision': 0.35951137683194717, 'recall': 0.35382652631105665, 'f1-score': 0.33037160189574527, 'support': 177929}}
[[19828 31987  6610]
 [18297 34666  7690]
 [16673 33716  8462]]
training model: results/AAL/W7/deepOF_L1/h500
Epoch 1/50
2013/2013 - 45s - loss: 3.2859 - accuracy500: 0.3681 - val_loss: 3.2946 - val_accuracy500: 0.3450 - 45s/epoch - 22ms/step
Epoch 2/50
2013/2013 - 43s - loss: 3.2801 - accuracy500: 0.3659 - val_loss: 3.2918 - val_accuracy500: 0.3541 - 43s/epoch - 22ms/step
Epoch 3/50
2013/2013 - 43s - loss: 3.2804 - accuracy500: 0.3663 - val_loss: 3.2905 - val_accuracy500: 0.3581 - 43s/epoch - 22ms/step
Epoch 4/50
2013/2013 - 43s - loss: 3.2791 - accuracy500: 0.3696 - val_loss: 3.2915 - val_accuracy500: 0.3572 - 43s/epoch - 21ms/step
Epoch 5/50
2013/2013 - 43s - loss: 3.2788 - accuracy500: 0.3704 - val_loss: 3.2907 - val_accuracy500: 0.3592 - 43s/epoch - 21ms/step
Epoch 6/50
2013/2013 - 43s - loss: 3.2755 - accuracy500: 0.3729 - val_loss: 3.2917 - val_accuracy500: 0.3556 - 43s/epoch - 21ms/step
Epoch 7/50
2013/2013 - 42s - loss: 3.2740 - accuracy500: 0.3750 - val_loss: 3.2917 - val_accuracy500: 0.3563 - 42s/epoch - 21ms/step
Epoch 8/50
2013/2013 - 42s - loss: 3.2740 - accuracy500: 0.3750 - val_loss: 3.2913 - val_accuracy500: 0.3589 - 42s/epoch - 21ms/step
Epoch 9/50
2013/2013 - 42s - loss: 3.2724 - accuracy500: 0.3761 - val_loss: 3.2911 - val_accuracy500: 0.3589 - 42s/epoch - 21ms/step
Epoch 10/50
2013/2013 - 41s - loss: 3.2723 - accuracy500: 0.3762 - val_loss: 3.2911 - val_accuracy500: 0.3581 - 41s/epoch - 20ms/step
Epoch 11/50
2013/2013 - 42s - loss: 3.2714 - accuracy500: 0.3762 - val_loss: 3.2912 - val_accuracy500: 0.3565 - 42s/epoch - 21ms/step
Epoch 12/50
2013/2013 - 42s - loss: 3.2705 - accuracy500: 0.3776 - val_loss: 3.2904 - val_accuracy500: 0.3603 - 42s/epoch - 21ms/step
Epoch 13/50
2013/2013 - 42s - loss: 3.2717 - accuracy500: 0.3770 - val_loss: 3.2911 - val_accuracy500: 0.3592 - 42s/epoch - 21ms/step
Epoch 14/50
2013/2013 - 42s - loss: 3.2709 - accuracy500: 0.3773 - val_loss: 3.2913 - val_accuracy500: 0.3580 - 42s/epoch - 21ms/step
Epoch 15/50
2013/2013 - 42s - loss: 3.2692 - accuracy500: 0.3782 - val_loss: 3.2911 - val_accuracy500: 0.3593 - 42s/epoch - 21ms/step
Epoch 16/50
2013/2013 - 42s - loss: 3.2686 - accuracy500: 0.3793 - val_loss: 3.2915 - val_accuracy500: 0.3595 - 42s/epoch - 21ms/step
Epoch 17/50
2013/2013 - 42s - loss: 3.2674 - accuracy500: 0.3807 - val_loss: 3.2904 - val_accuracy500: 0.3609 - 42s/epoch - 21ms/step
Epoch 18/50
2013/2013 - 42s - loss: 3.2670 - accuracy500: 0.3808 - val_loss: 3.2919 - val_accuracy500: 0.3586 - 42s/epoch - 21ms/step
Epoch 19/50
2013/2013 - 41s - loss: 3.2664 - accuracy500: 0.3816 - val_loss: 3.2924 - val_accuracy500: 0.3560 - 41s/epoch - 21ms/step
Epoch 20/50
2013/2013 - 42s - loss: 3.2659 - accuracy500: 0.3814 - val_loss: 3.2938 - val_accuracy500: 0.3535 - 42s/epoch - 21ms/step
Epoch 21/50
2013/2013 - 43s - loss: 3.2651 - accuracy500: 0.3825 - val_loss: 3.2919 - val_accuracy500: 0.3547 - 43s/epoch - 21ms/step
Epoch 22/50
2013/2013 - 42s - loss: 3.2640 - accuracy500: 0.3838 - val_loss: 3.2944 - val_accuracy500: 0.3504 - 42s/epoch - 21ms/step
testing model: results/AAL/W7/deepOF_L1/h500
Evaluating performance on  test set...
5331/5331 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985374
{'0': {'precision': 0.34234768309216596, 'recall': 0.3023691525277107, 'f1-score': 0.321118894644271, 'support': 439271}, '1': {'precision': 0.39215848395151554, 'recall': 0.04963810129814676, 'f1-score': 0.08812201452536178, 'support': 477758}, '2': {'precision': 0.3405366346705903, 'recall': 0.6970587972437954, 'f1-score': 0.45754645727954146, 'support': 447572}, 'accuracy': 0.3433391885247043, 'macro avg': {'precision': 0.3583476005714239, 'recall': 0.34968868368988426, 'f1-score': 0.28892912214972477, 'support': 1364601}, 'weighted avg': {'precision': 0.35919285177723925, 'recall': 0.3433391885247043, 'f1-score': 0.28429130446365664, 'support': 1364601}}
[[132822  19488 286961]
 [136834  23715 317209]
 [118318  17270 311984]]
Evaluating performance on  train set...
2013/2013 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0982819
{'0': {'precision': 0.3712069358886607, 'recall': 0.29244837890668884, 'f1-score': 0.32715436528383457, 'support': 178028}, '1': {'precision': 0.3442769665567593, 'recall': 0.04370365941162401, 'f1-score': 0.0775614156099114, 'support': 167240}, '2': {'precision': 0.33758309215881344, 'recall': 0.702444102045377, 'f1-score': 0.4560135607197261, 'support': 170042}, 'accuracy': 0.34701053734645165, 'macro avg': {'precision': 0.3510223315347445, 'recall': 0.34619871345456327, 'f1-score': 0.286909780537824, 'support': 515310}, 'weighted avg': {'precision': 0.35137181973221526, 'recall': 0.34701053734645165, 'f1-score': 0.28867180217976707, 'support': 515310}}
[[ 52064   6921 119043]
 [ 44595   7309 115336]
 [ 43597   7000 119445]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0969174
{'0': {'precision': 0.3645661750622486, 'recall': 0.3150802847210727, 'f1-score': 0.33802166577872494, 'support': 60410}, '1': {'precision': 0.33750224941515206, 'recall': 0.06736709770114943, 'f1-score': 0.11231547743809325, 'support': 55680}, '2': {'precision': 0.36005409886130624, 'recall': 0.6672811656074645, 'f1-score': 0.4677291378567704, 'support': 61839}, 'accuracy': 0.35996942600700277, 'macro avg': {'precision': 0.35404084111290235, 'recall': 0.3499095160098955, 'f1-score': 0.3060220936911962, 'support': 177929}, 'weighted avg': {'precision': 0.35452879127309445, 'recall': 0.35996942600700277, 'f1-score': 0.31247023683250413, 'support': 177929}}
[[19034  3664 37712]
 [16300  3751 35629]
 [16876  3699 41264]]
training model: results/AAL/W7/deepOF_L1/h1000
Epoch 1/50
2013/2013 - 45s - loss: 3.2249 - accuracy1000: 0.4156 - val_loss: 3.2517 - val_accuracy1000: 0.3836 - 45s/epoch - 22ms/step
Epoch 2/50
2013/2013 - 42s - loss: 3.2257 - accuracy1000: 0.4091 - val_loss: 3.2515 - val_accuracy1000: 0.3840 - 42s/epoch - 21ms/step
Epoch 3/50
2013/2013 - 42s - loss: 3.2236 - accuracy1000: 0.4084 - val_loss: 3.2506 - val_accuracy1000: 0.3856 - 42s/epoch - 21ms/step
Epoch 4/50
2013/2013 - 43s - loss: 3.2249 - accuracy1000: 0.4070 - val_loss: 3.2513 - val_accuracy1000: 0.3855 - 43s/epoch - 21ms/step
Epoch 5/50
2013/2013 - 43s - loss: 3.2192 - accuracy1000: 0.4100 - val_loss: 3.2519 - val_accuracy1000: 0.3860 - 43s/epoch - 21ms/step
Epoch 6/50
2013/2013 - 42s - loss: 3.2185 - accuracy1000: 0.4110 - val_loss: 3.2511 - val_accuracy1000: 0.3853 - 42s/epoch - 21ms/step
Epoch 7/50
2013/2013 - 42s - loss: 3.2240 - accuracy1000: 0.4077 - val_loss: 3.2517 - val_accuracy1000: 0.3857 - 42s/epoch - 21ms/step
Epoch 8/50
2013/2013 - 42s - loss: 3.2217 - accuracy1000: 0.4110 - val_loss: 3.2504 - val_accuracy1000: 0.3859 - 42s/epoch - 21ms/step
Epoch 9/50
2013/2013 - 42s - loss: 3.2171 - accuracy1000: 0.4144 - val_loss: 3.2513 - val_accuracy1000: 0.3853 - 42s/epoch - 21ms/step
Epoch 10/50
2013/2013 - 42s - loss: 3.2125 - accuracy1000: 0.4189 - val_loss: 3.2508 - val_accuracy1000: 0.3852 - 42s/epoch - 21ms/step
Epoch 11/50
2013/2013 - 43s - loss: 3.2180 - accuracy1000: 0.4145 - val_loss: 3.2505 - val_accuracy1000: 0.3850 - 43s/epoch - 21ms/step
Epoch 12/50
2013/2013 - 43s - loss: 3.2137 - accuracy1000: 0.4154 - val_loss: 3.2501 - val_accuracy1000: 0.3860 - 43s/epoch - 21ms/step
Epoch 13/50
2013/2013 - 43s - loss: 3.2132 - accuracy1000: 0.4149 - val_loss: 3.2508 - val_accuracy1000: 0.3858 - 43s/epoch - 21ms/step
Epoch 14/50
2013/2013 - 43s - loss: 3.2126 - accuracy1000: 0.4155 - val_loss: 3.2505 - val_accuracy1000: 0.3868 - 43s/epoch - 21ms/step
Epoch 15/50
2013/2013 - 43s - loss: 3.2185 - accuracy1000: 0.4173 - val_loss: 3.2499 - val_accuracy1000: 0.3850 - 43s/epoch - 22ms/step
Epoch 16/50
2013/2013 - 43s - loss: 3.2235 - accuracy1000: 0.4137 - val_loss: 3.2491 - val_accuracy1000: 0.3851 - 43s/epoch - 21ms/step
Epoch 17/50
2013/2013 - 43s - loss: 3.2177 - accuracy1000: 0.4169 - val_loss: 3.2502 - val_accuracy1000: 0.3850 - 43s/epoch - 21ms/step
Epoch 18/50
2013/2013 - 41s - loss: 3.2158 - accuracy1000: 0.4171 - val_loss: 3.2516 - val_accuracy1000: 0.3857 - 41s/epoch - 20ms/step
Epoch 19/50
2013/2013 - 43s - loss: 3.2142 - accuracy1000: 0.4162 - val_loss: 3.2507 - val_accuracy1000: 0.3851 - 43s/epoch - 21ms/step
Epoch 20/50
2013/2013 - 42s - loss: 3.2206 - accuracy1000: 0.4150 - val_loss: 3.2512 - val_accuracy1000: 0.3863 - 42s/epoch - 21ms/step
Epoch 21/50
2013/2013 - 42s - loss: 3.2154 - accuracy1000: 0.4210 - val_loss: 3.2494 - val_accuracy1000: 0.3850 - 42s/epoch - 21ms/step
Epoch 22/50
2013/2013 - 42s - loss: 3.2140 - accuracy1000: 0.4179 - val_loss: 3.2506 - val_accuracy1000: 0.3863 - 42s/epoch - 21ms/step
Epoch 23/50
2013/2013 - 42s - loss: 3.2110 - accuracy1000: 0.4207 - val_loss: 3.2500 - val_accuracy1000: 0.3855 - 42s/epoch - 21ms/step
Epoch 24/50
2013/2013 - 43s - loss: 3.2182 - accuracy1000: 0.4211 - val_loss: 3.2507 - val_accuracy1000: 0.3860 - 43s/epoch - 21ms/step
Epoch 25/50
2013/2013 - 42s - loss: 3.2139 - accuracy1000: 0.4208 - val_loss: 3.2509 - val_accuracy1000: 0.3862 - 42s/epoch - 21ms/step
Epoch 26/50
2013/2013 - 42s - loss: 3.2089 - accuracy1000: 0.4232 - val_loss: 3.2513 - val_accuracy1000: 0.3860 - 42s/epoch - 21ms/step
testing model: results/AAL/W7/deepOF_L1/h1000
Evaluating performance on  test set...
5331/5331 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1813264
{'0': {'precision': 0.2588829633437209, 'recall': 0.09779993385541036, 'f1-score': 0.14196776402863756, 'support': 329581}, '1': {'precision': 0.45454545454545453, 'recall': 2.911390378145939e-05, 'f1-score': 5.822407827645083e-05, 'support': 686957}, '2': {'precision': 0.2578769064770828, 'recall': 0.9187417220445724, 'f1-score': 0.4027171887121312, 'support': 348063}, 'accuracy': 0.25797504178877195, 'macro avg': {'precision': 0.3237684414554194, 'recall': 0.33885692326792144, 'f1-score': 0.1815810589396817, 'support': 1364601}, 'weighted avg': {'precision': 0.35712526772228775, 'recall': 0.25797504178877195, 'f1-score': 0.13703700050723508, 'support': 1364601}}
[[ 32233     14 297334]
 [ 64002     20 622935]
 [ 28273     10 319780]]
Evaluating performance on  train set...
2013/2013 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1135125
{'0': {'precision': 0.38180623973727423, 'recall': 0.09736746601155746, 'f1-score': 0.15516505027137648, 'support': 179105}, '1': {'precision': 0.3333333333333333, 'recall': 3.583501558823178e-05, 'f1-score': 7.166232711463584e-05, 'support': 167434}, '2': {'precision': 0.3283058321994306, 'recall': 0.9135337232107412, 'f1-score': 0.48302286383829274, 'support': 168771}, 'accuracy': 0.3330480681531505, 'macro avg': {'precision': 0.3478151350900127, 'recall': 0.33697900807929565, 'f1-score': 0.21275319214559463, 'support': 515310}, 'weighted avg': {'precision': 0.3485343647660785, 'recall': 0.3330480681531505, 'f1-score': 0.21215013640679492, 'support': 515310}}
[[ 17439      7 161659]
 [ 13648      6 153780]
 [ 14588      5 154178]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0828927
{'0': {'precision': 0.3660983925962007, 'recall': 0.1166609753826095, 'f1-score': 0.17693865059560243, 'support': 64426}, '1': {'precision': 0.375, 'recall': 6.648494116082707e-05, 'f1-score': 0.00013294631184773215, 'support': 45123}, '2': {'precision': 0.3878176007522666, 'recall': 0.8926440479672418, 'f1-score': 0.5407160352746809, 'support': 68380}, 'accuracy': 0.38531099483501846, 'macro avg': {'precision': 0.3763053311161558, 'recall': 0.3364571694303374, 'f1-score': 0.23926254406071035, 'support': 177929}, 'weighted avg': {'precision': 0.3767027723465136, 'recall': 0.38531099483501846, 'f1-score': 0.2719040231316113, 'support': 177929}}
[[ 7516     4 56906]
 [ 5674     3 39446]
 [ 7340     1 61039]]
training model: results/AAL/W7/deepLOB_L2/h10
Epoch 1/50
2013/2013 - 96s - loss: 2.9065 - accuracy10: 0.4381 - val_loss: 2.9198 - val_accuracy10: 0.4961 - 96s/epoch - 48ms/step
Epoch 2/50
2013/2013 - 92s - loss: 2.6519 - accuracy10: 0.4999 - val_loss: 2.6597 - val_accuracy10: 0.5035 - 92s/epoch - 46ms/step
Epoch 3/50
2013/2013 - 93s - loss: 2.5006 - accuracy10: 0.5740 - val_loss: 2.7863 - val_accuracy10: 0.3793 - 93s/epoch - 46ms/step
Epoch 4/50
2013/2013 - 92s - loss: 2.3699 - accuracy10: 0.6198 - val_loss: 2.6623 - val_accuracy10: 0.5257 - 92s/epoch - 46ms/step
Epoch 5/50
2013/2013 - 93s - loss: 2.3034 - accuracy10: 0.6404 - val_loss: 2.5591 - val_accuracy10: 0.6426 - 93s/epoch - 46ms/step
Epoch 6/50
2013/2013 - 93s - loss: 2.2656 - accuracy10: 0.6482 - val_loss: 2.5531 - val_accuracy10: 0.5323 - 93s/epoch - 46ms/step
Epoch 7/50
2013/2013 - 93s - loss: 2.2398 - accuracy10: 0.6526 - val_loss: 2.6295 - val_accuracy10: 0.5398 - 93s/epoch - 46ms/step
Epoch 8/50
2013/2013 - 93s - loss: 2.2140 - accuracy10: 0.6565 - val_loss: 2.6198 - val_accuracy10: 0.5522 - 93s/epoch - 46ms/step
Epoch 9/50
2013/2013 - 93s - loss: 2.1929 - accuracy10: 0.6583 - val_loss: 2.3990 - val_accuracy10: 0.6105 - 93s/epoch - 46ms/step
Epoch 10/50
2013/2013 - 93s - loss: 2.1744 - accuracy10: 0.6601 - val_loss: 2.3114 - val_accuracy10: 0.6075 - 93s/epoch - 46ms/step
Epoch 11/50
2013/2013 - 93s - loss: 2.1588 - accuracy10: 0.6612 - val_loss: 2.4535 - val_accuracy10: 0.5405 - 93s/epoch - 46ms/step
Epoch 12/50
2013/2013 - 92s - loss: 2.1451 - accuracy10: 0.6623 - val_loss: 2.7070 - val_accuracy10: 0.4784 - 92s/epoch - 46ms/step
Epoch 13/50
2013/2013 - 92s - loss: 2.1329 - accuracy10: 0.6641 - val_loss: 2.4740 - val_accuracy10: 0.5411 - 92s/epoch - 46ms/step
Epoch 14/50
2013/2013 - 93s - loss: 2.1218 - accuracy10: 0.6652 - val_loss: 2.3920 - val_accuracy10: 0.5653 - 93s/epoch - 46ms/step
Epoch 15/50
2013/2013 - 93s - loss: 2.1143 - accuracy10: 0.6654 - val_loss: 2.5816 - val_accuracy10: 0.4850 - 93s/epoch - 46ms/step
Epoch 16/50
2013/2013 - 93s - loss: 2.1041 - accuracy10: 0.6662 - val_loss: 2.3568 - val_accuracy10: 0.5830 - 93s/epoch - 46ms/step
Epoch 17/50
2013/2013 - 93s - loss: 2.0965 - accuracy10: 0.6663 - val_loss: 2.3743 - val_accuracy10: 0.5681 - 93s/epoch - 46ms/step
Epoch 18/50
2013/2013 - 93s - loss: 2.0863 - accuracy10: 0.6688 - val_loss: 2.3866 - val_accuracy10: 0.6211 - 93s/epoch - 46ms/step
Epoch 19/50
2013/2013 - 94s - loss: 2.0809 - accuracy10: 0.6680 - val_loss: 2.5466 - val_accuracy10: 0.5376 - 94s/epoch - 47ms/step
Epoch 20/50
2013/2013 - 93s - loss: 2.0728 - accuracy10: 0.6695 - val_loss: 2.2994 - val_accuracy10: 0.6148 - 93s/epoch - 46ms/step
Epoch 21/50
2013/2013 - 93s - loss: 2.0651 - accuracy10: 0.6694 - val_loss: 2.3804 - val_accuracy10: 0.5803 - 93s/epoch - 46ms/step
Epoch 22/50
2013/2013 - 93s - loss: 2.0583 - accuracy10: 0.6701 - val_loss: 2.4167 - val_accuracy10: 0.5579 - 93s/epoch - 46ms/step
Epoch 23/50
2013/2013 - 93s - loss: 2.0528 - accuracy10: 0.6701 - val_loss: 2.4733 - val_accuracy10: 0.5300 - 93s/epoch - 46ms/step
Epoch 24/50
2013/2013 - 92s - loss: 2.0474 - accuracy10: 0.6708 - val_loss: 2.2895 - val_accuracy10: 0.6077 - 92s/epoch - 46ms/step
Epoch 25/50
2013/2013 - 92s - loss: 2.0394 - accuracy10: 0.6717 - val_loss: 2.3422 - val_accuracy10: 0.6253 - 92s/epoch - 46ms/step
Epoch 26/50
2013/2013 - 93s - loss: 2.0328 - accuracy10: 0.6714 - val_loss: 2.4750 - val_accuracy10: 0.6075 - 93s/epoch - 46ms/step
Epoch 27/50
2013/2013 - 93s - loss: 2.0284 - accuracy10: 0.6720 - val_loss: 2.4267 - val_accuracy10: 0.5992 - 93s/epoch - 46ms/step
Epoch 28/50
2013/2013 - 93s - loss: 2.0235 - accuracy10: 0.6724 - val_loss: 2.3732 - val_accuracy10: 0.6138 - 93s/epoch - 46ms/step
Epoch 29/50
2013/2013 - 93s - loss: 2.0165 - accuracy10: 0.6733 - val_loss: 2.5539 - val_accuracy10: 0.5536 - 93s/epoch - 46ms/step
Epoch 30/50
2013/2013 - 92s - loss: 2.0096 - accuracy10: 0.6732 - val_loss: 2.4738 - val_accuracy10: 0.5927 - 92s/epoch - 46ms/step
Epoch 31/50
2013/2013 - 93s - loss: 2.0048 - accuracy10: 0.6726 - val_loss: 2.4023 - val_accuracy10: 0.6013 - 93s/epoch - 46ms/step
Epoch 32/50
2013/2013 - 93s - loss: 1.9987 - accuracy10: 0.6737 - val_loss: 2.4086 - val_accuracy10: 0.6353 - 93s/epoch - 46ms/step
Epoch 33/50
2013/2013 - 93s - loss: 1.9961 - accuracy10: 0.6733 - val_loss: 2.4623 - val_accuracy10: 0.6090 - 93s/epoch - 46ms/step
Epoch 34/50
2013/2013 - 93s - loss: 1.9921 - accuracy10: 0.6734 - val_loss: 2.5130 - val_accuracy10: 0.5897 - 93s/epoch - 46ms/step
testing model: results/AAL/W7/deepLOB_L2/h10
Evaluating performance on  test set...
5331/5331 - 94s - 94s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7758068
{'0': {'precision': 0.2821612486647641, 'recall': 0.7275742045111958, 'f1-score': 0.4066277863086508, 'support': 145948}, '1': {'precision': 0.914147132413581, 'recall': 0.671892891499874, 'f1-score': 0.7745188655935136, 'support': 1070690}, '2': {'precision': 0.381790906878207, 'recall': 0.51944339316609, 'f1-score': 0.44010478549035886, 'support': 147968}, 'accuracy': 0.6613176257469189, 'macro avg': {'precision': 0.5260330959855174, 'recall': 0.6396368297257199, 'f1-score': 0.5404171457975077, 'support': 1364606}, 'weighted avg': {'precision': 0.7888298161029459, 'recall': 0.661317625746919, 'f1-score': 0.69891055825486, 'support': 1364606}}
[[106188  24937  14823]
 [241668 719389 109633]
 [ 28482  42625  76861]]
Evaluating performance on  train set...
2013/2013 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.887373
{'0': {'precision': 0.27949601647122013, 'recall': 0.7460239236593342, 'f1-score': 0.40664390168458153, 'support': 66963}, '1': {'precision': 0.9141523777717234, 'recall': 0.5434033038335754, 'f1-score': 0.6816253108647857, 'support': 382828}, '2': {'precision': 0.33970277956150813, 'recall': 0.5651775766548129, 'f1-score': 0.4243486830419811, 'support': 65521}, 'accuracy': 0.5725017077032943, 'macro avg': {'precision': 0.5111170579348173, 'recall': 0.6182016013825743, 'f1-score': 0.5042059651971161, 'support': 515312}, 'weighted avg': {'precision': 0.7586407536564357, 'recall': 0.5725017077032943, 'f1-score': 0.6131801707661426, 'support': 515312}}
[[ 49956   9524   7483]
 [110302 208030  64496]
 [ 18478  10012  37031]]
Evaluating performance on  val set...
696/696 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85663456
{'0': {'precision': 0.2872441276640567, 'recall': 0.7615900204803575, 'f1-score': 0.4171532009280268, 'support': 21484}, '1': {'precision': 0.9243218732923298, 'recall': 0.5860973290180842, 'f1-score': 0.7173406962265173, 'support': 135643}, '2': {'precision': 0.3485325247439785, 'recall': 0.5857129122199789, 'f1-score': 0.4370157819225251, 'support': 20802}, 'accuracy': 0.6072422145912133, 'macro avg': {'precision': 0.5200328419001217, 'recall': 0.6444667539061403, 'f1-score': 0.5238365596923564, 'support': 177929}, 'weighted avg': {'precision': 0.780081483498757, 'recall': 0.6072422145912133, 'f1-score': 0.648321328858947, 'support': 177929}}
[[16362  3079  2043]
 [35412 79500 20731]
 [ 5188  3430 12184]]
training model: results/AAL/W7/deepLOB_L2/h20
Epoch 1/50
2013/2013 - 96s - loss: 2.9739 - accuracy20: 0.4498 - val_loss: 3.1382 - val_accuracy20: 0.6492 - 96s/epoch - 48ms/step
Epoch 2/50
2013/2013 - 94s - loss: 2.7843 - accuracy20: 0.4843 - val_loss: 3.1936 - val_accuracy20: 0.6390 - 94s/epoch - 47ms/step
Epoch 3/50
2013/2013 - 93s - loss: 2.6582 - accuracy20: 0.5381 - val_loss: 3.3055 - val_accuracy20: 0.6026 - 93s/epoch - 46ms/step
Epoch 4/50
2013/2013 - 100s - loss: 2.5694 - accuracy20: 0.5763 - val_loss: 2.7326 - val_accuracy20: 0.6540 - 100s/epoch - 50ms/step
Epoch 5/50
2013/2013 - 93s - loss: 2.5015 - accuracy20: 0.5946 - val_loss: 2.6272 - val_accuracy20: 0.6650 - 93s/epoch - 46ms/step
Epoch 6/50
2013/2013 - 93s - loss: 2.4511 - accuracy20: 0.6058 - val_loss: 2.5524 - val_accuracy20: 0.6615 - 93s/epoch - 46ms/step
Epoch 7/50
2013/2013 - 93s - loss: 2.4156 - accuracy20: 0.6158 - val_loss: 2.6815 - val_accuracy20: 0.6444 - 93s/epoch - 46ms/step
Epoch 8/50
2013/2013 - 94s - loss: 2.3867 - accuracy20: 0.6225 - val_loss: 2.5323 - val_accuracy20: 0.6546 - 94s/epoch - 47ms/step
Epoch 9/50
2013/2013 - 95s - loss: 2.3642 - accuracy20: 0.6263 - val_loss: 2.5915 - val_accuracy20: 0.6603 - 95s/epoch - 47ms/step
Epoch 10/50
2013/2013 - 98s - loss: 2.3480 - accuracy20: 0.6296 - val_loss: 2.5007 - val_accuracy20: 0.5500 - 98s/epoch - 49ms/step
Epoch 11/50
2013/2013 - 95s - loss: 2.3308 - accuracy20: 0.6318 - val_loss: 2.4576 - val_accuracy20: 0.6076 - 95s/epoch - 47ms/step
Epoch 12/50
2013/2013 - 93s - loss: 2.3185 - accuracy20: 0.6341 - val_loss: 2.4511 - val_accuracy20: 0.5909 - 93s/epoch - 46ms/step
Epoch 13/50
2013/2013 - 94s - loss: 2.3047 - accuracy20: 0.6353 - val_loss: 2.3705 - val_accuracy20: 0.6468 - 94s/epoch - 47ms/step
Epoch 14/50
2013/2013 - 95s - loss: 2.2941 - accuracy20: 0.6364 - val_loss: 2.4859 - val_accuracy20: 0.6072 - 95s/epoch - 47ms/step
Epoch 15/50
2013/2013 - 94s - loss: 2.2862 - accuracy20: 0.6376 - val_loss: 2.5158 - val_accuracy20: 0.5562 - 94s/epoch - 47ms/step
Epoch 16/50
2013/2013 - 95s - loss: 2.2776 - accuracy20: 0.6384 - val_loss: 2.4465 - val_accuracy20: 0.5857 - 95s/epoch - 47ms/step
Epoch 17/50
2013/2013 - 97s - loss: 2.2688 - accuracy20: 0.6389 - val_loss: 2.4647 - val_accuracy20: 0.6042 - 97s/epoch - 48ms/step
Epoch 18/50
2013/2013 - 97s - loss: 2.2613 - accuracy20: 0.6404 - val_loss: 2.5474 - val_accuracy20: 0.5452 - 97s/epoch - 48ms/step
Epoch 19/50
2013/2013 - 97s - loss: 2.2538 - accuracy20: 0.6416 - val_loss: 2.6381 - val_accuracy20: 0.5238 - 97s/epoch - 48ms/step
Epoch 20/50
2013/2013 - 98s - loss: 2.2468 - accuracy20: 0.6420 - val_loss: 2.5593 - val_accuracy20: 0.5589 - 98s/epoch - 49ms/step
Epoch 21/50
2013/2013 - 96s - loss: 2.2425 - accuracy20: 0.6425 - val_loss: 2.6039 - val_accuracy20: 0.5452 - 96s/epoch - 48ms/step
Epoch 22/50
2013/2013 - 97s - loss: 2.2356 - accuracy20: 0.6440 - val_loss: 2.5371 - val_accuracy20: 0.5698 - 97s/epoch - 48ms/step
Epoch 23/50
2013/2013 - 97s - loss: 2.2279 - accuracy20: 0.6442 - val_loss: 2.5682 - val_accuracy20: 0.5591 - 97s/epoch - 48ms/step
testing model: results/AAL/W7/deepLOB_L2/h20
Evaluating performance on  test set...
5331/5331 - 100s - 100s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77557284
{'0': {'precision': 0.4147738296267021, 'recall': 0.5829857288584097, 'f1-score': 0.4847003896278383, 'support': 198022}, '1': {'precision': 0.8440733644290378, 'recall': 0.6740175755147758, 'f1-score': 0.7495206877001932, 'support': 966003}, '2': {'precision': 0.34224850267074, 'recall': 0.5372991459809254, 'f1-score': 0.4181463698530482, 'support': 200581}, 'accuracy': 0.6407116779495327, 'macro avg': {'precision': 0.5336985655754933, 'recall': 0.5981008167847036, 'f1-score': 0.5507891490603599, 'support': 1364606}, 'weighted avg': {'precision': 0.7080141025783869, 'recall': 0.6407116779495327, 'f1-score': 0.6623837140147616, 'support': 1364606}}
[[115444  57923  24655]
 [132433 651103 182467]
 [ 30453  62356 107772]]
Evaluating performance on  train set...
2013/2013 - 39s - 39s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.841083
{'0': {'precision': 0.4002371354043159, 'recall': 0.5725237449118046, 'f1-score': 0.47112351709699923, 'support': 88440}, '1': {'precision': 0.8288833232855761, 'recall': 0.6020984878543403, 'f1-score': 0.6975202503243116, 'support': 340245}, '2': {'precision': 0.36821297714773843, 'recall': 0.6020871090999342, 'f1-score': 0.4569643764565701, 'support': 86627}, 'accuracy': 0.5970208339801907, 'macro avg': {'precision': 0.5324444786125435, 'recall': 0.5922364472886931, 'f1-score': 0.541869381292627, 'support': 515312}, 'weighted avg': {'precision': 0.6778758580390825, 'recall': 0.5970208339801907, 'f1-score': 0.6182262288923164, 'support': 515312}}
[[ 50634  23404  14402]
 [ 60294 204861  75090]
 [ 15582  18888  52157]]
Evaluating performance on  val set...
696/696 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7679638
{'0': {'precision': 0.40569553864351554, 'recall': 0.6374219791009187, 'f1-score': 0.49581997954312984, 'support': 28518}, '1': {'precision': 0.8485357657225157, 'recall': 0.6693587558760816, 'f1-score': 0.7483719538854501, 'support': 121467}, '2': {'precision': 0.416389663306884, 'recall': 0.5558617234468938, 'f1-score': 0.47612187346738594, 'support': 27944}, 'accuracy': 0.6464151431188845, 'macro avg': {'precision': 0.5568736558909717, 'recall': 0.6208808194746314, 'f1-score': 0.5734379356319886, 'support': 177929}, 'weighted avg': {'precision': 0.7096893253910276, 'recall': 0.6464151431188845, 'f1-score': 0.6651363180335278, 'support': 177929}}
[[18178  7480  2860]
 [21251 81305 18911]
 [ 5378  7033 15533]]
training model: results/AAL/W7/deepLOB_L2/h30
Epoch 1/50
2013/2013 - 99s - loss: 3.0502 - accuracy30: 0.4428 - val_loss: 3.2729 - val_accuracy30: 0.6017 - 99s/epoch - 49ms/step
Epoch 2/50
2013/2013 - 95s - loss: 2.8958 - accuracy30: 0.4743 - val_loss: 3.1488 - val_accuracy30: 0.5990 - 95s/epoch - 47ms/step
Epoch 3/50
2013/2013 - 95s - loss: 2.7835 - accuracy30: 0.5128 - val_loss: 3.1358 - val_accuracy30: 0.4916 - 95s/epoch - 47ms/step
Epoch 4/50
2013/2013 - 95s - loss: 2.6822 - accuracy30: 0.5520 - val_loss: 2.8046 - val_accuracy30: 0.4802 - 95s/epoch - 47ms/step
Epoch 5/50
2013/2013 - 95s - loss: 2.6059 - accuracy30: 0.5792 - val_loss: 3.0731 - val_accuracy30: 0.4728 - 95s/epoch - 47ms/step
Epoch 6/50
2013/2013 - 96s - loss: 2.5584 - accuracy30: 0.5915 - val_loss: 2.6927 - val_accuracy30: 0.5287 - 96s/epoch - 48ms/step
Epoch 7/50
2013/2013 - 95s - loss: 2.5278 - accuracy30: 0.5972 - val_loss: 2.6974 - val_accuracy30: 0.4992 - 95s/epoch - 47ms/step
Epoch 8/50
2013/2013 - 95s - loss: 2.5041 - accuracy30: 0.6023 - val_loss: 2.8168 - val_accuracy30: 0.4567 - 95s/epoch - 47ms/step
Epoch 9/50
2013/2013 - 94s - loss: 2.4874 - accuracy30: 0.6049 - val_loss: 2.7629 - val_accuracy30: 0.4599 - 94s/epoch - 47ms/step
Epoch 10/50
2013/2013 - 95s - loss: 2.4699 - accuracy30: 0.6075 - val_loss: 2.7884 - val_accuracy30: 0.4656 - 95s/epoch - 47ms/step
Epoch 11/50
2013/2013 - 95s - loss: 2.4561 - accuracy30: 0.6094 - val_loss: 2.6902 - val_accuracy30: 0.5042 - 95s/epoch - 47ms/step
Epoch 12/50
2013/2013 - 96s - loss: 2.4461 - accuracy30: 0.6110 - val_loss: 2.7343 - val_accuracy30: 0.4956 - 96s/epoch - 47ms/step
Epoch 13/50
2013/2013 - 96s - loss: 2.4332 - accuracy30: 0.6130 - val_loss: 2.9345 - val_accuracy30: 0.4687 - 96s/epoch - 48ms/step
Epoch 14/50
2013/2013 - 95s - loss: 2.4243 - accuracy30: 0.6140 - val_loss: 2.8377 - val_accuracy30: 0.4663 - 95s/epoch - 47ms/step
Epoch 15/50
2013/2013 - 96s - loss: 2.4161 - accuracy30: 0.6161 - val_loss: 2.9075 - val_accuracy30: 0.4530 - 96s/epoch - 47ms/step
Epoch 16/50
2013/2013 - 95s - loss: 2.4073 - accuracy30: 0.6171 - val_loss: 2.8573 - val_accuracy30: 0.4597 - 95s/epoch - 47ms/step
Epoch 17/50
2013/2013 - 95s - loss: 2.3992 - accuracy30: 0.6175 - val_loss: 2.8963 - val_accuracy30: 0.4482 - 95s/epoch - 47ms/step
Epoch 18/50
2013/2013 - 95s - loss: 2.3909 - accuracy30: 0.6187 - val_loss: 3.1054 - val_accuracy30: 0.4088 - 95s/epoch - 47ms/step
Epoch 19/50
2013/2013 - 99s - loss: 2.3865 - accuracy30: 0.6190 - val_loss: 3.2141 - val_accuracy30: 0.3756 - 99s/epoch - 49ms/step
Epoch 20/50
2013/2013 - 95s - loss: 2.3775 - accuracy30: 0.6205 - val_loss: 3.1789 - val_accuracy30: 0.3979 - 95s/epoch - 47ms/step
Epoch 21/50
2013/2013 - 94s - loss: 2.3713 - accuracy30: 0.6210 - val_loss: 3.2893 - val_accuracy30: 0.3980 - 94s/epoch - 47ms/step
testing model: results/AAL/W7/deepLOB_L2/h30
Evaluating performance on  test set...
5331/5331 - 99s - 99s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0108632
{'0': {'precision': 0.27531144852701234, 'recall': 0.8429320470679109, 'f1-score': 0.4150595890828625, 'support': 238209}, '1': {'precision': 0.8234548258688271, 'recall': 0.45802670765683545, 'f1-score': 0.5886379053144251, 'support': 884765}, '2': {'precision': 0.4726741789678853, 'recall': 0.2800125811150841, 'f1-score': 0.35168605028912997, 'support': 241632}, 'accuracy': 0.4936956161705283, 'macro avg': {'precision': 0.5238134844545749, 'recall': 0.5269904452799435, 'f1-score': 0.4517945148954725, 'support': 1364606}, 'weighted avg': {'precision': 0.6656565199510862, 'recall': 0.4936956161705283, 'f1-score': 0.5163803688792369, 'support': 1364606}}
[[200794  27302  10113]
 [414149 405246  65370]
 [114391  59581  67660]]
Evaluating performance on  train set...
2013/2013 - 39s - 39s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9656632
{'0': {'precision': 0.31481803733221964, 'recall': 0.7759118591729173, 'f1-score': 0.44790382922535216, 'support': 104923}, '1': {'precision': 0.7990394707124922, 'recall': 0.3910641950103058, 'f1-score': 0.5251235441004418, 'support': 307594}, '2': {'precision': 0.45214885140289907, 'recall': 0.4670071501532176, 'f1-score': 0.45945790743080284, 'support': 102795}, 'accuracy': 0.48457245319340514, 'macro avg': {'precision': 0.5220021198158703, 'recall': 0.5446610681121469, 'f1-score': 0.47749509358553227, 'support': 515312}, 'weighted avg': {'precision': 0.6312487212898357, 'recall': 0.48457245319340514, 'f1-score': 0.49630173660266463, 'support': 515312}}
[[ 81411  10996  12516]
 [141654 120289  45651]
 [ 35532  19257  48006]]
Evaluating performance on  val set...
696/696 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95614535
{'0': {'precision': 0.3066921268446672, 'recall': 0.8148865036072497, 'f1-score': 0.4456562708004202, 'support': 34098}, '1': {'precision': 0.8092676037393234, 'recall': 0.43633396790862117, 'f1-score': 0.566972541905693, 'support': 110310}, '2': {'precision': 0.4984562360881741, 'recall': 0.41418812087944873, 'f1-score': 0.45243177189409367, 'support': 33521}, 'accuracy': 0.5047069336645515, 'macro avg': {'precision': 0.5381386555573883, 'recall': 0.5551361974651065, 'f1-score': 0.4883535282000689, 'support': 177929}, 'weighted avg': {'precision': 0.6543995020460178, 'recall': 0.5047069336645515, 'f1-score': 0.5221447546214031, 'support': 177929}}
[[27786  3663  2649]
 [50857 48132 11321]
 [11956  7681 13884]]
training model: results/AAL/W7/deepLOB_L2/h50
Epoch 1/50
2013/2013 - 98s - loss: 3.0904 - accuracy50: 0.4535 - val_loss: 3.0976 - val_accuracy50: 0.4415 - 98s/epoch - 49ms/step
Epoch 2/50
2013/2013 - 95s - loss: 2.9536 - accuracy50: 0.4841 - val_loss: 3.0104 - val_accuracy50: 0.4900 - 95s/epoch - 47ms/step
Epoch 3/50
2013/2013 - 95s - loss: 2.9004 - accuracy50: 0.5049 - val_loss: 3.3669 - val_accuracy50: 0.5386 - 95s/epoch - 47ms/step
Epoch 4/50
2013/2013 - 96s - loss: 2.8547 - accuracy50: 0.5236 - val_loss: 3.0748 - val_accuracy50: 0.5531 - 96s/epoch - 48ms/step
Epoch 5/50
2013/2013 - 97s - loss: 2.8084 - accuracy50: 0.5375 - val_loss: 2.9892 - val_accuracy50: 0.5572 - 97s/epoch - 48ms/step
Epoch 6/50
2013/2013 - 96s - loss: 2.7688 - accuracy50: 0.5486 - val_loss: 3.0577 - val_accuracy50: 0.5333 - 96s/epoch - 48ms/step
Epoch 7/50
2013/2013 - 97s - loss: 2.7352 - accuracy50: 0.5577 - val_loss: 3.1865 - val_accuracy50: 0.5291 - 97s/epoch - 48ms/step
Epoch 8/50
2013/2013 - 95s - loss: 2.7114 - accuracy50: 0.5624 - val_loss: 3.0355 - val_accuracy50: 0.5270 - 95s/epoch - 47ms/step
Epoch 9/50
2013/2013 - 94s - loss: 2.6940 - accuracy50: 0.5660 - val_loss: 2.9979 - val_accuracy50: 0.5355 - 94s/epoch - 47ms/step
Epoch 10/50
2013/2013 - 96s - loss: 2.6776 - accuracy50: 0.5694 - val_loss: 3.1093 - val_accuracy50: 0.5297 - 96s/epoch - 48ms/step
Epoch 11/50
2013/2013 - 100s - loss: 2.6656 - accuracy50: 0.5703 - val_loss: 3.1959 - val_accuracy50: 0.5082 - 100s/epoch - 50ms/step
Epoch 12/50
2013/2013 - 97s - loss: 2.6548 - accuracy50: 0.5720 - val_loss: 3.2083 - val_accuracy50: 0.4991 - 97s/epoch - 48ms/step
Epoch 13/50
2013/2013 - 95s - loss: 2.6448 - accuracy50: 0.5742 - val_loss: 3.3322 - val_accuracy50: 0.4495 - 95s/epoch - 47ms/step
Epoch 14/50
2013/2013 - 95s - loss: 2.6346 - accuracy50: 0.5753 - val_loss: 3.4830 - val_accuracy50: 0.4598 - 95s/epoch - 47ms/step
Epoch 15/50
2013/2013 - 96s - loss: 2.6277 - accuracy50: 0.5769 - val_loss: 3.3872 - val_accuracy50: 0.4747 - 96s/epoch - 48ms/step
testing model: results/AAL/W7/deepLOB_L2/h50
Evaluating performance on  test set...
5331/5331 - 97s - 97s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9382569
{'0': {'precision': 0.39131805020527266, 'recall': 0.464195709426644, 'f1-score': 0.4246528074654029, 'support': 299587}, '1': {'precision': 0.6226342710997442, 'recall': 0.8000118301194842, 'f1-score': 0.7002652062107728, 'support': 760770}, '2': {'precision': 0.5100078802206461, 'recall': 0.0531801254893196, 'f1-score': 0.09631697690892747, 'support': 304249}, 'accuracy': 0.5597747628253137, 'macro avg': {'precision': 0.5079867338418876, 'recall': 0.43912922167848256, 'f1-score': 0.4070783301950344, 'support': 1364606}, 'weighted avg': {'precision': 0.5467399840544823, 'recall': 0.5597747628253137, 'f1-score': 0.5051022532999794, 'support': 1364606}}
[[139067 156268   4252]
 [140852 608625  11293]
 [ 75462 212607  16180]]
Evaluating performance on  train set...
2013/2013 - 38s - 38s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9632337
{'0': {'precision': 0.4355173894375268, 'recall': 0.3894998771196854, 'f1-score': 0.4112252592658661, 'support': 130208}, '1': {'precision': 0.5863042137409173, 'recall': 0.7561542520992751, 'f1-score': 0.6604843807461112, 'support': 257708}, '2': {'precision': 0.4686827977201979, 'recall': 0.24463876416841973, 'f1-score': 0.3214762781534145, 'support': 127396}, 'accuracy': 0.5370513397708573, 'macro avg': {'precision': 0.49683480029954735, 'recall': 0.4634309644624601, 'f1-score': 0.4643953060551305, 'support': 515312}, 'weighted avg': {'precision': 0.519125206199328, 'recall': 0.5370513397708573, 'f1-score': 0.5136921307546518, 'support': 515312}}
[[ 50716  67298  12194]
 [ 39704 194867  23137]
 [ 26030  70200  31166]]
Evaluating performance on  val set...
696/696 - 14s - 14s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93304527
{'0': {'precision': 0.4314378602628797, 'recall': 0.5049017319452873, 'f1-score': 0.4652878606997279, 'support': 42842}, '1': {'precision': 0.616873235224264, 'recall': 0.7540969504064691, 'f1-score': 0.6786175663710391, 'support': 92996}, '2': {'precision': 0.5250549294776384, 'recall': 0.1759996198712314, 'f1-score': 0.26362989323843417, 'support': 42091}, 'accuracy': 0.557340287418015, 'macro avg': {'precision': 0.5244553416549275, 'recall': 0.4783327674076627, 'f1-score': 0.46917844010306703, 'support': 177929}, 'weighted avg': {'precision': 0.5505032413431269, 'recall': 0.557340287418015, 'f1-score': 0.5290819797033526, 'support': 177929}}
[[21631 19027  2184]
 [18351 70128  4517]
 [10155 24528  7408]]
training model: results/AAL/W7/deepLOB_L2/h100
Epoch 1/50
2013/2013 - 97s - loss: 3.2030 - accuracy100: 0.4258 - val_loss: 3.5213 - val_accuracy100: 0.3866 - 97s/epoch - 48ms/step
Epoch 2/50
2013/2013 - 96s - loss: 3.1185 - accuracy100: 0.4508 - val_loss: 3.4506 - val_accuracy100: 0.3299 - 96s/epoch - 48ms/step
Epoch 3/50
2013/2013 - 96s - loss: 3.0718 - accuracy100: 0.4644 - val_loss: 3.2807 - val_accuracy100: 0.4141 - 96s/epoch - 48ms/step
Epoch 4/50
2013/2013 - 96s - loss: 3.0492 - accuracy100: 0.4715 - val_loss: 3.3240 - val_accuracy100: 0.3669 - 96s/epoch - 48ms/step
Epoch 5/50
2013/2013 - 96s - loss: 3.0307 - accuracy100: 0.4789 - val_loss: 3.3802 - val_accuracy100: 0.3593 - 96s/epoch - 48ms/step
Epoch 6/50
2013/2013 - 96s - loss: 3.0116 - accuracy100: 0.4853 - val_loss: 3.4121 - val_accuracy100: 0.3699 - 96s/epoch - 48ms/step
Epoch 7/50
2013/2013 - 96s - loss: 2.9973 - accuracy100: 0.4894 - val_loss: 3.4605 - val_accuracy100: 0.3799 - 96s/epoch - 48ms/step
Epoch 8/50
2013/2013 - 96s - loss: 2.9823 - accuracy100: 0.4940 - val_loss: 3.3071 - val_accuracy100: 0.4281 - 96s/epoch - 48ms/step
Epoch 9/50
2013/2013 - 95s - loss: 2.9677 - accuracy100: 0.4970 - val_loss: 3.3128 - val_accuracy100: 0.4441 - 95s/epoch - 47ms/step
Epoch 10/50
2013/2013 - 96s - loss: 2.9554 - accuracy100: 0.5007 - val_loss: 3.3325 - val_accuracy100: 0.4306 - 96s/epoch - 47ms/step
Epoch 11/50
2013/2013 - 95s - loss: 2.9439 - accuracy100: 0.5037 - val_loss: 3.3832 - val_accuracy100: 0.4377 - 95s/epoch - 47ms/step
Epoch 12/50
2013/2013 - 95s - loss: 2.9316 - accuracy100: 0.5056 - val_loss: 3.4314 - val_accuracy100: 0.4193 - 95s/epoch - 47ms/step
Epoch 13/50
2013/2013 - 96s - loss: 2.9229 - accuracy100: 0.5074 - val_loss: 3.3706 - val_accuracy100: 0.4444 - 96s/epoch - 48ms/step
testing model: results/AAL/W7/deepLOB_L2/h100
Evaluating performance on  test set...
5331/5331 - 100s - 100s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1010154
{'0': {'precision': 0.3433813410864425, 'recall': 0.6533961848767791, 'f1-score': 0.4501788059616263, 'support': 386095}, '1': {'precision': 0.4705858462429522, 'recall': 0.45577402931010597, 'f1-score': 0.46306152271633383, 'support': 584713}, '2': {'precision': 0.3980730541933861, 'recall': 0.0643146994144206, 'f1-score': 0.11073800560532726, 'support': 393798}, 'accuracy': 0.3987209494901825, 'macro avg': {'precision': 0.404013413840927, 'recall': 0.3911616378671019, 'f1-score': 0.3413261114277624, 'support': 1364606}, 'weighted avg': {'precision': 0.41366947924622366, 'recall': 0.3987209494901825, 'f1-score': 0.35774302864794416, 'support': 1364606}}
[[252273 122776  11046]
 [290965 266497  27251]
 [191435 177036  25327]]
Evaluating performance on  train set...
2013/2013 - 38s - 38s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0849755
{'0': {'precision': 0.38810334011368175, 'recall': 0.6153999192143292, 'f1-score': 0.47600994203587904, 'support': 165871}, '1': {'precision': 0.443940413152342, 'recall': 0.41166842604736464, 'f1-score': 0.42719579968851745, 'support': 187566}, '2': {'precision': 0.4478983232524309, 'recall': 0.21683397683397684, 'f1-score': 0.29220657589670374, 'support': 161875}, 'accuracy': 0.41604309622131835, 'macro avg': {'precision': 0.42664735883948485, 'recall': 0.41463410736522355, 'f1-score': 0.3984707725403667, 'support': 515312}, 'weighted avg': {'precision': 0.42721061752455974, 'recall': 0.41604309622131835, 'f1-score': 0.4005041449317863, 'support': 515312}}
[[102077  42044  21750]
 [ 88835  77215  21516]
 [ 72103  54672  35100]]
Evaluating performance on  val set...
696/696 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0873647
{'0': {'precision': 0.3741865190376631, 'recall': 0.6946752678766674, 'f1-score': 0.4863830357313735, 'support': 54876}, '1': {'precision': 0.46036527060623444, 'recall': 0.41958864712546845, 'f1-score': 0.43903217471921213, 'support': 68846}, '2': {'precision': 0.47376728803367407, 'recall': 0.11627649565554264, 'f1-score': 0.18672512627571802, 'support': 54207}, 'accuracy': 0.4120238971724677, 'macro avg': {'precision': 0.43610635922585717, 'recall': 0.41018013688589283, 'f1-score': 0.37071344557543456, 'support': 177929}, 'weighted avg': {'precision': 0.4378694323090052, 'recall': 0.4120238971724677, 'f1-score': 0.3767692365468337, 'support': 177929}}
[[38121 13380  3375]
 [36333 28887  3626]
 [27423 20481  6303]]
training model: results/AAL/W7/deepLOB_L2/h200
Epoch 1/50
2013/2013 - 99s - loss: 3.2724 - accuracy200: 0.3873 - val_loss: 3.3540 - val_accuracy200: 0.3487 - 99s/epoch - 49ms/step
Epoch 2/50
2013/2013 - 97s - loss: 3.2190 - accuracy200: 0.4099 - val_loss: 3.4776 - val_accuracy200: 0.3374 - 97s/epoch - 48ms/step
Epoch 3/50
2013/2013 - 96s - loss: 3.1966 - accuracy200: 0.4192 - val_loss: 3.6201 - val_accuracy200: 0.3336 - 96s/epoch - 48ms/step
Epoch 4/50
2013/2013 - 95s - loss: 3.1819 - accuracy200: 0.4257 - val_loss: 3.5574 - val_accuracy200: 0.3372 - 95s/epoch - 47ms/step
Epoch 5/50
2013/2013 - 96s - loss: 3.1685 - accuracy200: 0.4325 - val_loss: 3.5261 - val_accuracy200: 0.3491 - 96s/epoch - 48ms/step
Epoch 6/50
2013/2013 - 96s - loss: 3.1566 - accuracy200: 0.4371 - val_loss: 3.5484 - val_accuracy200: 0.3397 - 96s/epoch - 48ms/step
Epoch 7/50
2013/2013 - 94s - loss: 3.1479 - accuracy200: 0.4407 - val_loss: 3.4963 - val_accuracy200: 0.3530 - 94s/epoch - 47ms/step
Epoch 8/50
2013/2013 - 95s - loss: 3.1381 - accuracy200: 0.4443 - val_loss: 3.4434 - val_accuracy200: 0.3558 - 95s/epoch - 47ms/step
Epoch 9/50
2013/2013 - 94s - loss: 3.1291 - accuracy200: 0.4479 - val_loss: 3.5546 - val_accuracy200: 0.3680 - 94s/epoch - 47ms/step
Epoch 10/50
2013/2013 - 95s - loss: 3.1195 - accuracy200: 0.4510 - val_loss: 3.5375 - val_accuracy200: 0.3662 - 95s/epoch - 47ms/step
Epoch 11/50
2013/2013 - 94s - loss: 3.1116 - accuracy200: 0.4534 - val_loss: 3.5423 - val_accuracy200: 0.3611 - 94s/epoch - 47ms/step
testing model: results/AAL/W7/deepLOB_L2/h200
Evaluating performance on  test set...
5331/5331 - 96s - 96s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.114399
{'0': {'precision': 0.31838685679327505, 'recall': 0.8005901581747352, 'f1-score': 0.45559002666050646, 'support': 421243}, '1': {'precision': 0.38329639271730126, 'recall': 0.17675717610550815, 'f1-score': 0.2419425274998042, 'support': 515600}, '2': {'precision': 0.3470782246017778, 'recall': 0.05485981723524475, 'f1-score': 0.09474419430896935, 'support': 427763}, 'accuracy': 0.3311182861573231, 'macro avg': {'precision': 0.3495871580374514, 'recall': 0.3440690505051627, 'f1-score': 0.26409224948976, 'support': 1364606}, 'weighted avg': {'precision': 0.35190602810741006, 'recall': 0.3311182861573231, 'f1-score': 0.2617515514145756, 'support': 1364606}}
[[337243  64017  19983]
 [400301  91136  24163]
 [321680  82616  23467]]
Evaluating performance on  train set...
2013/2013 - 38s - 38s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1132739
{'0': {'precision': 0.35660897133359326, 'recall': 0.7792450186363254, 'f1-score': 0.4892983904033054, 'support': 178415}, '1': {'precision': 0.3272043975768454, 'recall': 0.17764500234488723, 'f1-score': 0.23027154626234075, 'support': 164187}, '2': {'precision': 0.36768756196981384, 'recall': 0.07729720340455098, 'f1-score': 0.12774019462438643, 'support': 172710}, 'accuracy': 0.3523030707610147, 'macro avg': {'precision': 0.3505003102934175, 'recall': 0.34472907479525455, 'f1-score': 0.2824367104300109, 'support': 515312}, 'weighted avg': {'precision': 0.35095324167346986, 'recall': 0.3523030707610147, 'f1-score': 0.28558965384768537, 'support': 515312}}
[[139029  28098  11288]
 [123350  29167  11670]
 [127485  31875  13350]]
Evaluating performance on  val set...
696/696 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1153008
{'0': {'precision': 0.3456748146560326, 'recall': 0.7914501853136794, 'f1-score': 0.4811861424646822, 'support': 59089}, '1': {'precision': 0.3537471612414837, 'recall': 0.23456087807653053, 'f1-score': 0.2820809481171464, 'support': 59767}, '2': {'precision': 0.34717607973421927, 'recall': 0.017689976808355764, 'f1-score': 0.03366461027978674, 'support': 59073}, 'accuracy': 0.34749815937817896, 'macro avg': {'precision': 0.34886601854391186, 'recall': 0.34790034673285525, 'f1-score': 0.26564390028720514, 'support': 177929}, 'weighted avg': {'precision': 0.3488847701457862, 'recall': 0.34749815937817896, 'f1-score': 0.26572739419246405, 'support': 177929}}
[[46766 11353   970]
 [44753 14019   995]
 [43770 14258  1045]]
training model: results/AAL/W7/deepLOB_L2/h300
Epoch 1/50
2013/2013 - 96s - loss: 3.2872 - accuracy300: 0.3769 - val_loss: 3.3353 - val_accuracy300: 0.3415 - 96s/epoch - 48ms/step
Epoch 2/50
2013/2013 - 94s - loss: 3.2524 - accuracy300: 0.3923 - val_loss: 3.3342 - val_accuracy300: 0.3414 - 94s/epoch - 47ms/step
Epoch 3/50
2013/2013 - 94s - loss: 3.2363 - accuracy300: 0.4016 - val_loss: 3.3328 - val_accuracy300: 0.3423 - 94s/epoch - 47ms/step
Epoch 4/50
2013/2013 - 94s - loss: 3.2227 - accuracy300: 0.4093 - val_loss: 3.3234 - val_accuracy300: 0.3423 - 94s/epoch - 47ms/step
Epoch 5/50
2013/2013 - 93s - loss: 3.2104 - accuracy300: 0.4167 - val_loss: 3.3511 - val_accuracy300: 0.3407 - 93s/epoch - 46ms/step
Epoch 6/50
2013/2013 - 94s - loss: 3.2007 - accuracy300: 0.4218 - val_loss: 3.4027 - val_accuracy300: 0.3426 - 94s/epoch - 47ms/step
Epoch 7/50
2013/2013 - 94s - loss: 3.1919 - accuracy300: 0.4255 - val_loss: 3.4044 - val_accuracy300: 0.3414 - 94s/epoch - 47ms/step
Epoch 8/50
2013/2013 - 94s - loss: 3.1845 - accuracy300: 0.4289 - val_loss: 3.4391 - val_accuracy300: 0.3378 - 94s/epoch - 47ms/step
Epoch 9/50
2013/2013 - 95s - loss: 3.1752 - accuracy300: 0.4321 - val_loss: 3.6308 - val_accuracy300: 0.3329 - 95s/epoch - 47ms/step
Epoch 10/50
2013/2013 - 95s - loss: 3.1649 - accuracy300: 0.4361 - val_loss: 3.6116 - val_accuracy300: 0.3356 - 95s/epoch - 47ms/step
Epoch 11/50
2013/2013 - 94s - loss: 3.1567 - accuracy300: 0.4389 - val_loss: 3.6587 - val_accuracy300: 0.3352 - 94s/epoch - 47ms/step
Epoch 12/50
2013/2013 - 94s - loss: 3.1463 - accuracy300: 0.4440 - val_loss: 3.6449 - val_accuracy300: 0.3350 - 94s/epoch - 47ms/step
Epoch 13/50
2013/2013 - 94s - loss: 3.1352 - accuracy300: 0.4477 - val_loss: 3.8053 - val_accuracy300: 0.3310 - 94s/epoch - 47ms/step
Epoch 14/50
2013/2013 - 94s - loss: 3.1268 - accuracy300: 0.4511 - val_loss: 3.5318 - val_accuracy300: 0.3350 - 94s/epoch - 47ms/step
testing model: results/AAL/W7/deepLOB_L2/h300
Evaluating performance on  test set...
5331/5331 - 96s - 96s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0949789
{'0': {'precision': 0.31636256621542086, 'recall': 0.02876583032903731, 'f1-score': 0.05273650034786021, 'support': 411078}, '1': {'precision': 0.390734728668081, 'recall': 0.9364387049289904, 'f1-score': 0.551396093414879, 'support': 532604}, '2': {'precision': 0.3170092942659105, 'recall': 0.03824680940027178, 'f1-score': 0.06825832930541775, 'support': 420924}, 'accuracy': 0.38595389438416655, 'macro avg': {'precision': 0.3413688630498042, 'recall': 0.33448378155276653, 'f1-score': 0.2241303076893857, 'support': 1364606}, 'weighted avg': {'precision': 0.34558941599393633, 'recall': 0.38595389438416655, 'f1-score': 0.2521505467744459, 'support': 1364606}}
[[ 11825 384028  15225]
 [ 14393 498751  19460]
 [ 11160 393665  16099]]
Evaluating performance on  train set...
2013/2013 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1059412
{'0': {'precision': 0.3699663059773493, 'recall': 0.1427990329196888, 'f1-score': 0.20606240983477805, 'support': 174546}, '1': {'precision': 0.33857631581572095, 'recall': 0.7849285214666829, 'f1-score': 0.47308778415178215, 'support': 172989}, '2': {'precision': 0.35074738256178434, 'recall': 0.09804085184500855, 'f1-score': 0.15324631767237765, 'support': 167777}, 'accuracy': 0.34378784115254446, 'macro avg': {'precision': 0.35309666811828483, 'recall': 0.3419228020771268, 'f1-score': 0.2774655038863126, 'support': 515312}, 'weighted avg': {'precision': 0.35317140051820384, 'recall': 0.34378784115254446, 'f1-score': 0.2785061467999432, 'support': 515312}}
[[ 24925 134973  14648]
 [ 21405 135784  15800]
 [ 21041 130287  16449]]
Evaluating performance on  val set...
696/696 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1072505
{'0': {'precision': 0.33951540532455876, 'recall': 0.038887175797444065, 'f1-score': 0.06978173993237011, 'support': 58374}, '1': {'precision': 0.34312717300817785, 'recall': 0.923751297727535, 'f1-score': 0.500386072813779, 'support': 60683}, '2': {'precision': 0.34184126984126983, 'recall': 0.04572632151107488, 'f1-score': 0.08066280132440411, 'support': 58872}, 'accuracy': 0.34293454130580175, 'macro avg': {'precision': 0.34149461605800213, 'recall': 0.3361215983453513, 'f1-score': 0.21694353802351773, 'support': 177929}, 'weighted avg': {'precision': 0.341516772129143, 'recall': 0.34293454130580175, 'f1-score': 0.2202403643191444, 'support': 177929}}
[[ 2270 53435  2669]
 [ 2113 56056  2514]
 [ 2303 53877  2692]]
training model: results/AAL/W7/deepLOB_L2/h500
Epoch 1/50
2013/2013 - 97s - loss: 3.2657 - accuracy500: 0.3914 - val_loss: 3.6129 - val_accuracy500: 0.3370 - 97s/epoch - 48ms/step
Epoch 2/50
2013/2013 - 94s - loss: 3.2488 - accuracy500: 0.4002 - val_loss: 3.4315 - val_accuracy500: 0.3220 - 94s/epoch - 47ms/step
Epoch 3/50
2013/2013 - 94s - loss: 3.2231 - accuracy500: 0.4129 - val_loss: 3.5848 - val_accuracy500: 0.3186 - 94s/epoch - 47ms/step
Epoch 4/50
2013/2013 - 95s - loss: 3.2073 - accuracy500: 0.4196 - val_loss: 3.3507 - val_accuracy500: 0.3175 - 95s/epoch - 47ms/step
Epoch 5/50
2013/2013 - 94s - loss: 3.1941 - accuracy500: 0.4272 - val_loss: 3.5498 - val_accuracy500: 0.3134 - 94s/epoch - 47ms/step
Epoch 6/50
2013/2013 - 95s - loss: 3.1878 - accuracy500: 0.4290 - val_loss: 3.8271 - val_accuracy500: 0.3131 - 95s/epoch - 47ms/step
Epoch 7/50
2013/2013 - 95s - loss: 3.1749 - accuracy500: 0.4340 - val_loss: 3.6989 - val_accuracy500: 0.3131 - 95s/epoch - 47ms/step
Epoch 8/50
2013/2013 - 96s - loss: 3.1659 - accuracy500: 0.4377 - val_loss: 3.6887 - val_accuracy500: 0.3133 - 96s/epoch - 48ms/step
Epoch 9/50
2013/2013 - 95s - loss: 3.1565 - accuracy500: 0.4417 - val_loss: 4.0538 - val_accuracy500: 0.3133 - 95s/epoch - 47ms/step
Epoch 10/50
2013/2013 - 94s - loss: 3.1473 - accuracy500: 0.4439 - val_loss: 3.8648 - val_accuracy500: 0.3137 - 94s/epoch - 46ms/step
Epoch 11/50
2013/2013 - 94s - loss: 3.1387 - accuracy500: 0.4479 - val_loss: 3.9268 - val_accuracy500: 0.3139 - 94s/epoch - 47ms/step
Epoch 12/50
2013/2013 - 94s - loss: 3.1332 - accuracy500: 0.4516 - val_loss: 4.1247 - val_accuracy500: 0.3134 - 94s/epoch - 47ms/step
Epoch 13/50
2013/2013 - 93s - loss: 3.1279 - accuracy500: 0.4528 - val_loss: 4.0087 - val_accuracy500: 0.3137 - 93s/epoch - 46ms/step
Epoch 14/50
2013/2013 - 94s - loss: 3.1200 - accuracy500: 0.4567 - val_loss: 4.0870 - val_accuracy500: 0.3135 - 94s/epoch - 47ms/step
testing model: results/AAL/W7/deepLOB_L2/h500
Evaluating performance on  test set...
5331/5331 - 97s - 97s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1104888
{'0': {'precision': 0.32233675465394845, 'recall': 0.13354823435138138, 'f1-score': 0.1888524759041187, 'support': 439272}, '1': {'precision': 0.3502257411611055, 'recall': 0.8464222472465139, 'f1-score': 0.4954487230144101, 'support': 477758}, '2': {'precision': 0.3291501305016268, 'recall': 0.02056857382880226, 'f1-score': 0.038717681817703894, 'support': 447576}, 'accuracy': 0.3460742514689222, 'macro avg': {'precision': 0.3339042087722269, 'recall': 0.33351301847556586, 'f1-score': 0.24100629357874423, 'support': 1364606}, 'weighted avg': {'precision': 0.334335595289331, 'recall': 0.3460742514689222, 'f1-score': 0.24695135516223232, 'support': 1364606}}
[[ 58664 371652   8956]
 [ 63566 404385   9807]
 [ 59766 378604   9206]]
Evaluating performance on  train set...
2013/2013 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1129398
{'0': {'precision': 0.35901399800936024, 'recall': 0.1904296545914069, 'f1-score': 0.24885868208974946, 'support': 178050}, '1': {'precision': 0.3267928142031296, 'recall': 0.7795958399866038, 'f1-score': 0.4605367517562872, 'support': 167211}, '2': {'precision': 0.3479883488075733, 'recall': 0.04496298169372718, 'f1-score': 0.07963629356899954, 'support': 170051}, 'accuracy': 0.33360177911634115, 'macro avg': {'precision': 0.3445983870066877, 'recall': 0.3383294920905793, 'f1-score': 0.2630105758050121, 'support': 515312}, 'weighted avg': {'precision': 0.34492028577708794, 'recall': 0.33360177911634115, 'f1-score': 0.2617022900722327, 'support': 515312}}
[[ 33906 136817   7327]
 [ 29855 130357   6999]
 [ 30681 131724   7646]]
Evaluating performance on  val set...
696/696 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.118528
{'0': {'precision': 0.3373172959805116, 'recall': 0.14677288461219962, 'f1-score': 0.20454466768992857, 'support': 60379}, '1': {'precision': 0.31327785401864483, 'recall': 0.8318553888130968, 'f1-score': 0.45514680967043325, 'support': 55708}, '2': {'precision': 0.3352972683449384, 'recall': 0.020245140842792924, 'f1-score': 0.03818470172014151, 'support': 61842}, 'accuracy': 0.3172894806355344, 'macro avg': {'precision': 0.3286308061146983, 'recall': 0.3329578047560298, 'f1-score': 0.23262539302683446, 'support': 177929}, 'weighted avg': {'precision': 0.32908866668539505, 'recall': 0.3172894806355344, 'f1-score': 0.2251849855130287, 'support': 177929}}
[[ 8862 50228  1289]
 [ 8174 46341  1193]
 [ 9236 51354  1252]]
training model: results/AAL/W7/deepLOB_L2/h1000
Epoch 1/50
2013/2013 - 97s - loss: 3.1569 - accuracy1000: 0.4576 - val_loss: 3.4942 - val_accuracy1000: 0.2756 - 97s/epoch - 48ms/step
Epoch 2/50
2013/2013 - 94s - loss: 3.1193 - accuracy1000: 0.4656 - val_loss: 3.3358 - val_accuracy1000: 0.3407 - 94s/epoch - 47ms/step
Epoch 3/50
2013/2013 - 94s - loss: 3.1167 - accuracy1000: 0.4638 - val_loss: 3.5364 - val_accuracy1000: 0.3351 - 94s/epoch - 47ms/step
Epoch 4/50
2013/2013 - 94s - loss: 3.1092 - accuracy1000: 0.4685 - val_loss: 3.5121 - val_accuracy1000: 0.3334 - 94s/epoch - 47ms/step
Epoch 5/50
2013/2013 - 94s - loss: 3.0911 - accuracy1000: 0.4739 - val_loss: 3.7256 - val_accuracy1000: 0.3388 - 94s/epoch - 46ms/step
Epoch 6/50
2013/2013 - 94s - loss: 3.0876 - accuracy1000: 0.4734 - val_loss: 4.1064 - val_accuracy1000: 0.3490 - 94s/epoch - 47ms/step
Epoch 7/50
2013/2013 - 95s - loss: 3.0691 - accuracy1000: 0.4817 - val_loss: 4.0106 - val_accuracy1000: 0.3363 - 95s/epoch - 47ms/step
Epoch 8/50
2013/2013 - 95s - loss: 3.0678 - accuracy1000: 0.4812 - val_loss: 4.1793 - val_accuracy1000: 0.2815 - 95s/epoch - 47ms/step
Epoch 9/50
2013/2013 - 94s - loss: 3.0500 - accuracy1000: 0.4892 - val_loss: 4.0489 - val_accuracy1000: 0.2943 - 94s/epoch - 47ms/step
Epoch 10/50
2013/2013 - 93s - loss: 3.0433 - accuracy1000: 0.4900 - val_loss: 4.0321 - val_accuracy1000: 0.2881 - 93s/epoch - 46ms/step
Epoch 11/50
2013/2013 - 93s - loss: 3.0372 - accuracy1000: 0.4926 - val_loss: 3.9508 - val_accuracy1000: 0.2784 - 93s/epoch - 46ms/step
Epoch 12/50
2013/2013 - 94s - loss: 3.0263 - accuracy1000: 0.4949 - val_loss: 3.8845 - val_accuracy1000: 0.2916 - 94s/epoch - 47ms/step
testing model: results/AAL/W7/deepLOB_L2/h1000
Evaluating performance on  test set...
5331/5331 - 96s - 96s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1242075
{'0': {'precision': 0.24140505307084323, 'recall': 0.7701937605815852, 'f1-score': 0.3675936806938812, 'support': 329582}, '1': {'precision': 0.5044789789566175, 'recall': 0.19724204390952577, 'f1-score': 0.2836012081051043, 'support': 686958}, '2': {'precision': 0.2540057079934381, 'recall': 0.03247372624732091, 'f1-score': 0.057585368028224615, 'support': 348066}, 'accuracy': 0.293595367454049, 'macro avg': {'precision': 0.33329658000696627, 'recall': 0.3333031769128106, 'f1-score': 0.23626008560907005, 'support': 1364606}, 'weighted avg': {'precision': 0.3770534362194793, 'recall': 0.293595367454049, 'f1-score': 0.2462380261379688, 'support': 1364606}}
[[253842  64796  10944]
 [529209 135497  22252]
 [268468  68295  11303]]
Evaluating performance on  train set...
2013/2013 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1078982
{'0': {'precision': 0.3484955557457422, 'recall': 0.7954045697574479, 'f1-score': 0.48464888044030857, 'support': 179178}, '1': {'precision': 0.33632979206392444, 'recall': 0.15490408110836953, 'f1-score': 0.21211427075493308, 'support': 167381}, '2': {'precision': 0.3518417276019955, 'recall': 0.06101817449171274, 'f1-score': 0.10400012120049086, 'support': 168753}, 'accuracy': 0.34686558822616204, 'macro avg': {'precision': 0.3455556918038874, 'recall': 0.33710894178584333, 'f1-score': 0.2669210907985775, 'support': 515312}, 'weighted avg': {'precision': 0.345639730242808, 'recall': 0.34686558822616204, 'f1-score': 0.2714717458660219, 'support': 515312}}
[[142519  26302  10357]
 [132841  25928   8612]
 [133595  24861  10297]]
Evaluating performance on  val set...
696/696 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1104202
{'0': {'precision': 0.36278222659073167, 'recall': 0.7794167882985, 'f1-score': 0.4951125928410087, 'support': 64402}, '1': {'precision': 0.24550194388354782, 'recall': 0.1804727828610674, 'f1-score': 0.2080236982558288, 'support': 45137}, '2': {'precision': 0.39348370927318294, 'recall': 0.03673051615733294, 'f1-score': 0.06718912991146654, 'support': 68390}, 'accuracy': 0.3420128253404448, 'macro avg': {'precision': 0.3339226265824875, 'recall': 0.3322066957723001, 'f1-score': 0.2567751403361013, 'support': 177929}, 'weighted avg': {'precision': 0.34483121399637484, 'recall': 0.3420128253404448, 'f1-score': 0.25780435717036115, 'support': 177929}}
[[50196 12019  2187]
 [35306  8146  1685]
 [52862 13016  2512]]
training model: results/AAL/W7/deepOF_L2/h10
Epoch 1/50
2013/2013 - 61s - loss: 2.7193 - accuracy10: 0.5193 - val_loss: 2.5189 - val_accuracy10: 0.7331 - 61s/epoch - 30ms/step
Epoch 2/50
2013/2013 - 57s - loss: 2.3561 - accuracy10: 0.6205 - val_loss: 2.3910 - val_accuracy10: 0.7423 - 57s/epoch - 28ms/step
Epoch 3/50
2013/2013 - 56s - loss: 2.2615 - accuracy10: 0.6375 - val_loss: 2.4058 - val_accuracy10: 0.7252 - 56s/epoch - 28ms/step
Epoch 4/50
2013/2013 - 57s - loss: 2.2259 - accuracy10: 0.6420 - val_loss: 2.4056 - val_accuracy10: 0.7267 - 57s/epoch - 28ms/step
Epoch 5/50
2013/2013 - 57s - loss: 2.2016 - accuracy10: 0.6450 - val_loss: 2.3754 - val_accuracy10: 0.7379 - 57s/epoch - 28ms/step
Epoch 6/50
2013/2013 - 57s - loss: 2.1847 - accuracy10: 0.6474 - val_loss: 2.3872 - val_accuracy10: 0.7439 - 57s/epoch - 28ms/step
Epoch 7/50
2013/2013 - 57s - loss: 2.1744 - accuracy10: 0.6487 - val_loss: 2.4028 - val_accuracy10: 0.7340 - 57s/epoch - 28ms/step
Epoch 8/50
2013/2013 - 59s - loss: 2.1623 - accuracy10: 0.6495 - val_loss: 2.3601 - val_accuracy10: 0.7363 - 59s/epoch - 29ms/step
Epoch 9/50
2013/2013 - 61s - loss: 2.1515 - accuracy10: 0.6515 - val_loss: 2.3638 - val_accuracy10: 0.7374 - 61s/epoch - 30ms/step
Epoch 10/50
2013/2013 - 59s - loss: 2.1446 - accuracy10: 0.6513 - val_loss: 2.3412 - val_accuracy10: 0.7398 - 59s/epoch - 29ms/step
Epoch 11/50
2013/2013 - 58s - loss: 2.1351 - accuracy10: 0.6527 - val_loss: 2.3611 - val_accuracy10: 0.7420 - 58s/epoch - 29ms/step
Epoch 12/50
2013/2013 - 57s - loss: 2.1286 - accuracy10: 0.6535 - val_loss: 2.3447 - val_accuracy10: 0.7436 - 57s/epoch - 28ms/step
Epoch 13/50
2013/2013 - 57s - loss: 2.1229 - accuracy10: 0.6537 - val_loss: 2.3451 - val_accuracy10: 0.7369 - 57s/epoch - 28ms/step
Epoch 14/50
2013/2013 - 57s - loss: 2.1157 - accuracy10: 0.6553 - val_loss: 2.3298 - val_accuracy10: 0.7347 - 57s/epoch - 28ms/step
Epoch 15/50
2013/2013 - 57s - loss: 2.1095 - accuracy10: 0.6558 - val_loss: 2.3322 - val_accuracy10: 0.7359 - 57s/epoch - 28ms/step
Epoch 16/50
2013/2013 - 57s - loss: 2.1036 - accuracy10: 0.6570 - val_loss: 2.3405 - val_accuracy10: 0.7336 - 57s/epoch - 28ms/step
Epoch 17/50
2013/2013 - 57s - loss: 2.0981 - accuracy10: 0.6573 - val_loss: 2.3394 - val_accuracy10: 0.7349 - 57s/epoch - 28ms/step
Epoch 18/50
2013/2013 - 57s - loss: 2.0932 - accuracy10: 0.6573 - val_loss: 2.3127 - val_accuracy10: 0.7376 - 57s/epoch - 28ms/step
Epoch 19/50
2013/2013 - 57s - loss: 2.0869 - accuracy10: 0.6585 - val_loss: 2.3401 - val_accuracy10: 0.7376 - 57s/epoch - 28ms/step
Epoch 20/50
2013/2013 - 57s - loss: 2.0810 - accuracy10: 0.6593 - val_loss: 2.3346 - val_accuracy10: 0.7362 - 57s/epoch - 28ms/step
Epoch 21/50
2013/2013 - 57s - loss: 2.0773 - accuracy10: 0.6588 - val_loss: 2.3252 - val_accuracy10: 0.7378 - 57s/epoch - 28ms/step
Epoch 22/50
2013/2013 - 57s - loss: 2.0733 - accuracy10: 0.6591 - val_loss: 2.3225 - val_accuracy10: 0.7349 - 57s/epoch - 28ms/step
Epoch 23/50
2013/2013 - 57s - loss: 2.0672 - accuracy10: 0.6594 - val_loss: 2.3377 - val_accuracy10: 0.7318 - 57s/epoch - 28ms/step
Epoch 24/50
2013/2013 - 58s - loss: 2.0612 - accuracy10: 0.6607 - val_loss: 2.3345 - val_accuracy10: 0.7326 - 58s/epoch - 29ms/step
Epoch 25/50
2013/2013 - 59s - loss: 2.0581 - accuracy10: 0.6613 - val_loss: 2.3254 - val_accuracy10: 0.7381 - 59s/epoch - 29ms/step
Epoch 26/50
2013/2013 - 59s - loss: 2.0531 - accuracy10: 0.6611 - val_loss: 2.3342 - val_accuracy10: 0.7413 - 59s/epoch - 29ms/step
Epoch 27/50
2013/2013 - 59s - loss: 2.0479 - accuracy10: 0.6614 - val_loss: 2.3449 - val_accuracy10: 0.7346 - 59s/epoch - 29ms/step
Epoch 28/50
2013/2013 - 57s - loss: 2.0444 - accuracy10: 0.6620 - val_loss: 2.3406 - val_accuracy10: 0.7358 - 57s/epoch - 28ms/step
testing model: results/AAL/W7/deepOF_L2/h10
Evaluating performance on  test set...
5331/5331 - 68s - 68s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6037538
{'0': {'precision': 0.39858177543513706, 'recall': 0.5761504097349741, 'f1-score': 0.4711921012226966, 'support': 145948}, '1': {'precision': 0.9003813079846462, 'recall': 0.7959308331294143, 'f1-score': 0.8449402998763116, 'support': 1070686}, '2': {'precision': 0.4053650907054655, 'recall': 0.5675116749004846, 'f1-score': 0.47292612940378076, 'support': 147967}, 'accuracy': 0.7476566410254719, 'macro avg': {'precision': 0.5681093913750829, 'recall': 0.646530972588291, 'f1-score': 0.5963528435009297, 'support': 1364601}, 'weighted avg': {'precision': 0.7930365949156362, 'recall': 0.7476566410254719, 'f1-score': 0.7646284557113089, 'support': 1364601}}
[[ 84088  43986  17874]
 [113187 852192 105307]
 [ 13693  50301  83973]]
Evaluating performance on  train set...
2013/2013 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6643547
{'0': {'precision': 0.44011145421210074, 'recall': 0.5447284345047924, 'f1-score': 0.48686334947893734, 'support': 66982}, '1': {'precision': 0.8836255489432182, 'recall': 0.7636185550854098, 'f1-score': 0.8192506056271129, 'support': 382860}, '2': {'precision': 0.39578306727199314, 'recall': 0.6138724262234985, 'f1-score': 0.4812736885594362, 'support': 65468}, 'accuracy': 0.7161417399235411, 'macro avg': {'precision': 0.5731733568091041, 'recall': 0.6407398052712335, 'f1-score': 0.5957958812218288, 'support': 515310}, 'weighted avg': {'precision': 0.7639974946005285, 'recall': 0.7161417399235411, 'f1-score': 0.7331070493252679, 'support': 515310}}
[[ 36487  21043   9452]
 [ 38599 292359  51902]
 [  7818  17461  40189]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.623301
{'0': {'precision': 0.4375091360912147, 'recall': 0.5567336309523809, 'f1-score': 0.48997298845870507, 'support': 21504}, '1': {'precision': 0.889249627298327, 'recall': 0.7921674524299638, 'f1-score': 0.8379058596752732, 'support': 135537}, '2': {'precision': 0.4015758591785415, 'recall': 0.5733914209115282, 'f1-score': 0.4723443692938694, 'support': 20888}, 'accuracy': 0.7380303379437866, 'macro avg': {'precision': 0.5761115408560277, 'recall': 0.6407641680979577, 'f1-score': 0.6000744058092825, 'support': 177929}, 'weighted avg': {'precision': 0.7774030076275379, 'recall': 0.7380303379437866, 'f1-score': 0.7529405258975987, 'support': 177929}}
[[ 11972   6924   2608]
 [ 12929 107368  15240]
 [  2463   6448  11977]]
training model: results/AAL/W7/deepOF_L2/h20
Epoch 1/50
2013/2013 - 60s - loss: 2.7918 - accuracy20: 0.5126 - val_loss: 2.6767 - val_accuracy20: 0.6785 - 60s/epoch - 30ms/step
Epoch 2/50
2013/2013 - 57s - loss: 2.4809 - accuracy20: 0.5931 - val_loss: 2.5938 - val_accuracy20: 0.6791 - 57s/epoch - 28ms/step
Epoch 3/50
2013/2013 - 57s - loss: 2.4046 - accuracy20: 0.6127 - val_loss: 2.5885 - val_accuracy20: 0.6719 - 57s/epoch - 28ms/step
Epoch 4/50
2013/2013 - 58s - loss: 2.3713 - accuracy20: 0.6184 - val_loss: 2.5828 - val_accuracy20: 0.6892 - 58s/epoch - 29ms/step
Epoch 5/50
2013/2013 - 59s - loss: 2.3504 - accuracy20: 0.6215 - val_loss: 2.6063 - val_accuracy20: 0.6952 - 59s/epoch - 29ms/step
Epoch 6/50
2013/2013 - 59s - loss: 2.3344 - accuracy20: 0.6240 - val_loss: 2.5755 - val_accuracy20: 0.6965 - 59s/epoch - 29ms/step
Epoch 7/50
2013/2013 - 59s - loss: 2.3227 - accuracy20: 0.6260 - val_loss: 2.5765 - val_accuracy20: 0.6995 - 59s/epoch - 30ms/step
Epoch 8/50
2013/2013 - 57s - loss: 2.3125 - accuracy20: 0.6272 - val_loss: 2.5804 - val_accuracy20: 0.6951 - 57s/epoch - 28ms/step
Epoch 9/50
2013/2013 - 57s - loss: 2.3043 - accuracy20: 0.6293 - val_loss: 2.5662 - val_accuracy20: 0.7012 - 57s/epoch - 29ms/step
Epoch 10/50
2013/2013 - 57s - loss: 2.2966 - accuracy20: 0.6295 - val_loss: 2.5665 - val_accuracy20: 0.6985 - 57s/epoch - 28ms/step
Epoch 11/50
2013/2013 - 57s - loss: 2.2896 - accuracy20: 0.6310 - val_loss: 2.5525 - val_accuracy20: 0.6959 - 57s/epoch - 28ms/step
Epoch 12/50
2013/2013 - 58s - loss: 2.2833 - accuracy20: 0.6315 - val_loss: 2.5574 - val_accuracy20: 0.6988 - 58s/epoch - 29ms/step
Epoch 13/50
2013/2013 - 56s - loss: 2.2781 - accuracy20: 0.6324 - val_loss: 2.5610 - val_accuracy20: 0.6987 - 56s/epoch - 28ms/step
Epoch 14/50
2013/2013 - 57s - loss: 2.2716 - accuracy20: 0.6329 - val_loss: 2.5530 - val_accuracy20: 0.6989 - 57s/epoch - 28ms/step
Epoch 15/50
2013/2013 - 57s - loss: 2.2656 - accuracy20: 0.6339 - val_loss: 2.5416 - val_accuracy20: 0.6992 - 57s/epoch - 28ms/step
Epoch 16/50
2013/2013 - 60s - loss: 2.2613 - accuracy20: 0.6345 - val_loss: 2.5277 - val_accuracy20: 0.7013 - 60s/epoch - 30ms/step
Epoch 17/50
2013/2013 - 58s - loss: 2.2555 - accuracy20: 0.6353 - val_loss: 2.5466 - val_accuracy20: 0.6986 - 58s/epoch - 29ms/step
Epoch 18/50
2013/2013 - 59s - loss: 2.2524 - accuracy20: 0.6355 - val_loss: 2.5430 - val_accuracy20: 0.7045 - 59s/epoch - 29ms/step
Epoch 19/50
2013/2013 - 58s - loss: 2.2464 - accuracy20: 0.6366 - val_loss: 2.5279 - val_accuracy20: 0.7014 - 58s/epoch - 29ms/step
Epoch 20/50
2013/2013 - 58s - loss: 2.2418 - accuracy20: 0.6366 - val_loss: 2.5399 - val_accuracy20: 0.6999 - 58s/epoch - 29ms/step
Epoch 21/50
2013/2013 - 57s - loss: 2.2365 - accuracy20: 0.6376 - val_loss: 2.5652 - val_accuracy20: 0.7036 - 57s/epoch - 28ms/step
Epoch 22/50
2013/2013 - 57s - loss: 2.2328 - accuracy20: 0.6377 - val_loss: 2.5427 - val_accuracy20: 0.7013 - 57s/epoch - 28ms/step
Epoch 23/50
2013/2013 - 57s - loss: 2.2279 - accuracy20: 0.6381 - val_loss: 2.5394 - val_accuracy20: 0.6980 - 57s/epoch - 28ms/step
Epoch 24/50
2013/2013 - 57s - loss: 2.2231 - accuracy20: 0.6389 - val_loss: 2.5360 - val_accuracy20: 0.7021 - 57s/epoch - 29ms/step
Epoch 25/50
2013/2013 - 56s - loss: 2.2194 - accuracy20: 0.6393 - val_loss: 2.5415 - val_accuracy20: 0.6986 - 56s/epoch - 28ms/step
Epoch 26/50
2013/2013 - 57s - loss: 2.2144 - accuracy20: 0.6396 - val_loss: 2.5501 - val_accuracy20: 0.6985 - 57s/epoch - 28ms/step
testing model: results/AAL/W7/deepOF_L2/h20
Evaluating performance on  test set...
5331/5331 - 68s - 68s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6749885
{'0': {'precision': 0.46088813616102586, 'recall': 0.5002247236404219, 'f1-score': 0.4797514426930593, 'support': 198021}, '1': {'precision': 0.833851712051766, 'recall': 0.8004010343663884, 'f1-score': 0.8167840308632976, 'support': 966002}, '2': {'precision': 0.46385138628506173, 'recall': 0.5143834318818614, 'f1-score': 0.48781225842598347, 'support': 200578}, 'accuracy': 0.7148008831885657, 'macro avg': {'precision': 0.5861970781659512, 'recall': 0.6050030632962239, 'f1-score': 0.5947825773274468, 'support': 1364601}, 'weighted avg': {'precision': 0.7253448696831217, 'recall': 0.7148008831885657, 'f1-score': 0.7195218785462537, 'support': 1364601}}
[[ 99055  70642  28324]
 [101882 773189  90931]
 [ 13985  83419 103174]]
Evaluating performance on  train set...
2013/2013 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7391056
{'0': {'precision': 0.5050955244531957, 'recall': 0.42935175970324796, 'f1-score': 0.4641538499156417, 'support': 88424}, '1': {'precision': 0.8078440187586411, 'recall': 0.7711025744273743, 'f1-score': 0.789045817368133, 'support': 340231}, '2': {'precision': 0.4426851779632374, 'recall': 0.5894755063181583, 'f1-score': 0.5056423353328978, 'support': 86655}, 'accuracy': 0.6819176806194329, 'macro avg': {'precision': 0.5852082403916915, 'recall': 0.5966432801495934, 'f1-score': 0.5862806675388909, 'support': 515310}, 'weighted avg': {'precision': 0.6944888108069415, 'recall': 0.6819176806194329, 'f1-score': 0.6856389825196293, 'support': 515310}}
[[ 37965  33629  16830]
 [ 30400 262353  47478]
 [  6799  28775  51081]]
Evaluating performance on  val set...
696/696 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.704179
{'0': {'precision': 0.48701155346235925, 'recall': 0.46399775643272806, 'f1-score': 0.4752261956053425, 'support': 28526}, '1': {'precision': 0.8146516574330175, 'recall': 0.7983423821254089, 'f1-score': 0.806414566758763, 'support': 121379}, '2': {'precision': 0.4609772970253443, 'recall': 0.5231230373965172, 'f1-score': 0.49008792163942094, 'support': 28024}, 'accuracy': 0.7013921283208471, 'macro avg': {'precision': 0.5875468359735737, 'recall': 0.5951543919848847, 'f1-score': 0.5905762280011755, 'support': 177929}, 'weighted avg': {'precision': 0.7064195430394581, 'recall': 0.7013921283208471, 'f1-score': 0.7034958892056551, 'support': 177929}}
[[13236 11048  4242]
 [11577 96902 12900]
 [ 2365 10999 14660]]
training model: results/AAL/W7/deepOF_L2/h30
Epoch 1/50
2013/2013 - 59s - loss: 2.8889 - accuracy30: 0.4943 - val_loss: 2.8546 - val_accuracy30: 0.6569 - 59s/epoch - 29ms/step
Epoch 2/50
2013/2013 - 57s - loss: 2.6029 - accuracy30: 0.5703 - val_loss: 2.7543 - val_accuracy30: 0.6531 - 57s/epoch - 28ms/step
Epoch 3/50
2013/2013 - 57s - loss: 2.5360 - accuracy30: 0.5862 - val_loss: 2.7332 - val_accuracy30: 0.6665 - 57s/epoch - 28ms/step
Epoch 4/50
2013/2013 - 59s - loss: 2.5006 - accuracy30: 0.5957 - val_loss: 2.7397 - val_accuracy30: 0.6634 - 59s/epoch - 29ms/step
Epoch 5/50
2013/2013 - 57s - loss: 2.4791 - accuracy30: 0.5996 - val_loss: 2.8051 - val_accuracy30: 0.6588 - 57s/epoch - 28ms/step
Epoch 6/50
2013/2013 - 58s - loss: 2.4624 - accuracy30: 0.6022 - val_loss: 2.7319 - val_accuracy30: 0.6656 - 58s/epoch - 29ms/step
Epoch 7/50
2013/2013 - 57s - loss: 2.4503 - accuracy30: 0.6045 - val_loss: 2.7170 - val_accuracy30: 0.6660 - 57s/epoch - 28ms/step
Epoch 8/50
2013/2013 - 59s - loss: 2.4419 - accuracy30: 0.6059 - val_loss: 2.6961 - val_accuracy30: 0.6632 - 59s/epoch - 29ms/step
Epoch 9/50
2013/2013 - 59s - loss: 2.4332 - accuracy30: 0.6078 - val_loss: 2.6787 - val_accuracy30: 0.6667 - 59s/epoch - 29ms/step
Epoch 10/50
2013/2013 - 60s - loss: 2.4255 - accuracy30: 0.6088 - val_loss: 2.7163 - val_accuracy30: 0.6622 - 60s/epoch - 30ms/step
Epoch 11/50
2013/2013 - 59s - loss: 2.4193 - accuracy30: 0.6100 - val_loss: 2.6931 - val_accuracy30: 0.6617 - 59s/epoch - 29ms/step
Epoch 12/50
2013/2013 - 58s - loss: 2.4118 - accuracy30: 0.6110 - val_loss: 2.7107 - val_accuracy30: 0.6590 - 58s/epoch - 29ms/step
Epoch 13/50
2013/2013 - 57s - loss: 2.4074 - accuracy30: 0.6113 - val_loss: 2.6682 - val_accuracy30: 0.6621 - 57s/epoch - 29ms/step
Epoch 14/50
2013/2013 - 57s - loss: 2.4014 - accuracy30: 0.6115 - val_loss: 2.6829 - val_accuracy30: 0.6620 - 57s/epoch - 28ms/step
Epoch 15/50
2013/2013 - 57s - loss: 2.3939 - accuracy30: 0.6128 - val_loss: 2.6658 - val_accuracy30: 0.6632 - 57s/epoch - 29ms/step
Epoch 16/50
2013/2013 - 57s - loss: 2.3879 - accuracy30: 0.6143 - val_loss: 2.6707 - val_accuracy30: 0.6651 - 57s/epoch - 28ms/step
Epoch 17/50
2013/2013 - 56s - loss: 2.3821 - accuracy30: 0.6144 - val_loss: 2.6779 - val_accuracy30: 0.6610 - 56s/epoch - 28ms/step
Epoch 18/50
2013/2013 - 57s - loss: 2.3770 - accuracy30: 0.6151 - val_loss: 2.6738 - val_accuracy30: 0.6602 - 57s/epoch - 28ms/step
Epoch 19/50
2013/2013 - 58s - loss: 2.3729 - accuracy30: 0.6157 - val_loss: 2.6750 - val_accuracy30: 0.6617 - 58s/epoch - 29ms/step
Epoch 20/50
2013/2013 - 59s - loss: 2.3664 - accuracy30: 0.6163 - val_loss: 2.6595 - val_accuracy30: 0.6601 - 59s/epoch - 29ms/step
Epoch 21/50
2013/2013 - 58s - loss: 2.3635 - accuracy30: 0.6163 - val_loss: 2.6416 - val_accuracy30: 0.6650 - 58s/epoch - 29ms/step
Epoch 22/50
2013/2013 - 58s - loss: 2.3557 - accuracy30: 0.6171 - val_loss: 2.6593 - val_accuracy30: 0.6576 - 58s/epoch - 29ms/step
Epoch 23/50
2013/2013 - 56s - loss: 2.3506 - accuracy30: 0.6176 - val_loss: 2.6531 - val_accuracy30: 0.6597 - 56s/epoch - 28ms/step
Epoch 24/50
2013/2013 - 57s - loss: 2.3450 - accuracy30: 0.6189 - val_loss: 2.6501 - val_accuracy30: 0.6587 - 57s/epoch - 28ms/step
Epoch 25/50
2013/2013 - 57s - loss: 2.3392 - accuracy30: 0.6192 - val_loss: 2.6618 - val_accuracy30: 0.6550 - 57s/epoch - 28ms/step
Epoch 26/50
2013/2013 - 57s - loss: 2.3347 - accuracy30: 0.6194 - val_loss: 2.6582 - val_accuracy30: 0.6548 - 57s/epoch - 28ms/step
Epoch 27/50
2013/2013 - 57s - loss: 2.3297 - accuracy30: 0.6200 - val_loss: 2.6674 - val_accuracy30: 0.6511 - 57s/epoch - 28ms/step
Epoch 28/50
2013/2013 - 57s - loss: 2.3232 - accuracy30: 0.6211 - val_loss: 2.6718 - val_accuracy30: 0.6560 - 57s/epoch - 28ms/step
Epoch 29/50
2013/2013 - 56s - loss: 2.3173 - accuracy30: 0.6212 - val_loss: 2.6564 - val_accuracy30: 0.6535 - 56s/epoch - 28ms/step
Epoch 30/50
2013/2013 - 56s - loss: 2.3125 - accuracy30: 0.6218 - val_loss: 2.6884 - val_accuracy30: 0.6535 - 56s/epoch - 28ms/step
Epoch 31/50
2013/2013 - 57s - loss: 2.3078 - accuracy30: 0.6223 - val_loss: 2.6876 - val_accuracy30: 0.6472 - 57s/epoch - 28ms/step
testing model: results/AAL/W7/deepOF_L2/h30
Evaluating performance on  test set...
5331/5331 - 64s - 64s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7460197
{'0': {'precision': 0.46660531402573113, 'recall': 0.5299905964535196, 'f1-score': 0.49628224657265, 'support': 238208}, '1': {'precision': 0.7773492329321093, 'recall': 0.7843085839839776, 'f1-score': 0.7808134016784728, 'support': 884764}, '2': {'precision': 0.5150708471360672, 'recall': 0.4292075868376726, 'f1-score': 0.4682354428436627, 'support': 241629}, 'accuracy': 0.6770367308832399, 'macro avg': {'precision': 0.5863417980313025, 'recall': 0.5811689224250566, 'f1-score': 0.5817770303649286, 'support': 1364601}, 'weighted avg': {'precision': 0.6766635735222434, 'recall': 0.6770367308832399, 'f1-score': 0.6757969924784618, 'support': 1364601}}
[[126248  84773  27187]
 [120383 693928  70453]
 [ 23936 113984 103709]]
Evaluating performance on  train set...
2013/2013 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7818489
{'0': {'precision': 0.49852807742716, 'recall': 0.4714007893382143, 'f1-score': 0.4845850809454745, 'support': 104898}, '1': {'precision': 0.7457826883018249, 'recall': 0.7693438013036199, 'f1-score': 0.7573800501817809, 'support': 307605}, '2': {'precision': 0.5096308592366166, 'recall': 0.48975264330249885, 'f1-score': 0.49949405765758625, 'support': 102807}, 'accuracy': 0.6529137800547243, 'macro avg': {'precision': 0.5846472083218671, 'recall': 0.5768324113147777, 'f1-score': 0.5804863962616138, 'support': 515310}, 'weighted avg': {'precision': 0.6483373151046475, 'recall': 0.6529137800547243, 'f1-score': 0.6503995298806321, 'support': 515310}}
[[ 49449  39767  15682]
 [ 38186 236654  32765]
 [ 11555  40902  50350]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76936185
{'0': {'precision': 0.4973369449432389, 'recall': 0.4794050343249428, 'f1-score': 0.4882063845360978, 'support': 34086}, '1': {'precision': 0.7504063292772069, 'recall': 0.7914183876146165, 'f1-score': 0.7703669044424042, 'support': 110259}, '2': {'precision': 0.5125230138604231, 'recall': 0.4393163411148166, 'f1-score': 0.47310448766253543, 'support': 33584}, 'accuracy': 0.6651866755840813, 'macro avg': {'precision': 0.5867554293602896, 'recall': 0.570046587684792, 'f1-score': 0.5772259255470125, 'support': 177929}, 'weighted avg': {'precision': 0.6570252823463248, 'recall': 0.6651866755840813, 'f1-score': 0.6602050731127083, 'support': 177929}}
[[16341 13845  3900]
 [12865 87261 10133]
 [ 3651 15179 14754]]
training model: results/AAL/W7/deepOF_L2/h50
Epoch 1/50
2013/2013 - 59s - loss: 3.0150 - accuracy50: 0.4760 - val_loss: 3.0054 - val_accuracy50: 0.5732 - 59s/epoch - 29ms/step
Epoch 2/50
2013/2013 - 56s - loss: 2.7889 - accuracy50: 0.5357 - val_loss: 2.9468 - val_accuracy50: 0.5853 - 56s/epoch - 28ms/step
Epoch 3/50
2013/2013 - 56s - loss: 2.7243 - accuracy50: 0.5507 - val_loss: 2.9244 - val_accuracy50: 0.5916 - 56s/epoch - 28ms/step
Epoch 4/50
2013/2013 - 56s - loss: 2.6920 - accuracy50: 0.5590 - val_loss: 2.9177 - val_accuracy50: 0.5931 - 56s/epoch - 28ms/step
Epoch 5/50
2013/2013 - 57s - loss: 2.6709 - accuracy50: 0.5633 - val_loss: 2.9092 - val_accuracy50: 0.5959 - 57s/epoch - 28ms/step
Epoch 6/50
2013/2013 - 57s - loss: 2.6578 - accuracy50: 0.5670 - val_loss: 2.9127 - val_accuracy50: 0.5951 - 57s/epoch - 28ms/step
Epoch 7/50
2013/2013 - 56s - loss: 2.6471 - accuracy50: 0.5694 - val_loss: 2.9144 - val_accuracy50: 0.5947 - 56s/epoch - 28ms/step
Epoch 8/50
2013/2013 - 57s - loss: 2.6372 - accuracy50: 0.5710 - val_loss: 2.9075 - val_accuracy50: 0.5966 - 57s/epoch - 28ms/step
Epoch 9/50
2013/2013 - 57s - loss: 2.6298 - accuracy50: 0.5731 - val_loss: 2.8986 - val_accuracy50: 0.5979 - 57s/epoch - 28ms/step
Epoch 10/50
2013/2013 - 57s - loss: 2.6230 - accuracy50: 0.5737 - val_loss: 2.8919 - val_accuracy50: 0.5955 - 57s/epoch - 28ms/step
Epoch 11/50
2013/2013 - 58s - loss: 2.6174 - accuracy50: 0.5752 - val_loss: 2.8786 - val_accuracy50: 0.5978 - 58s/epoch - 29ms/step
Epoch 12/50
2013/2013 - 57s - loss: 2.6106 - accuracy50: 0.5763 - val_loss: 2.8704 - val_accuracy50: 0.5955 - 57s/epoch - 28ms/step
Epoch 13/50
2013/2013 - 58s - loss: 2.6034 - accuracy50: 0.5782 - val_loss: 2.8666 - val_accuracy50: 0.5944 - 58s/epoch - 29ms/step
Epoch 14/50
2013/2013 - 58s - loss: 2.5976 - accuracy50: 0.5789 - val_loss: 2.8618 - val_accuracy50: 0.5958 - 58s/epoch - 29ms/step
Epoch 15/50
2013/2013 - 58s - loss: 2.5911 - accuracy50: 0.5797 - val_loss: 2.8803 - val_accuracy50: 0.5961 - 58s/epoch - 29ms/step
Epoch 16/50
2013/2013 - 56s - loss: 2.5848 - accuracy50: 0.5808 - val_loss: 2.8754 - val_accuracy50: 0.5948 - 56s/epoch - 28ms/step
Epoch 17/50
2013/2013 - 58s - loss: 2.5773 - accuracy50: 0.5825 - val_loss: 2.8947 - val_accuracy50: 0.5892 - 58s/epoch - 29ms/step
Epoch 18/50
2013/2013 - 58s - loss: 2.5711 - accuracy50: 0.5828 - val_loss: 2.8919 - val_accuracy50: 0.5924 - 58s/epoch - 29ms/step
Epoch 19/50
2013/2013 - 58s - loss: 2.5656 - accuracy50: 0.5837 - val_loss: 2.9199 - val_accuracy50: 0.5904 - 58s/epoch - 29ms/step
Epoch 20/50
2013/2013 - 57s - loss: 2.5602 - accuracy50: 0.5840 - val_loss: 2.9059 - val_accuracy50: 0.5890 - 57s/epoch - 28ms/step
Epoch 21/50
2013/2013 - 56s - loss: 2.5537 - accuracy50: 0.5852 - val_loss: 2.9198 - val_accuracy50: 0.5872 - 56s/epoch - 28ms/step
Epoch 22/50
2013/2013 - 56s - loss: 2.5477 - accuracy50: 0.5857 - val_loss: 2.9350 - val_accuracy50: 0.5885 - 56s/epoch - 28ms/step
Epoch 23/50
2013/2013 - 56s - loss: 2.5397 - accuracy50: 0.5872 - val_loss: 2.9206 - val_accuracy50: 0.5880 - 56s/epoch - 28ms/step
Epoch 24/50
2013/2013 - 56s - loss: 2.5352 - accuracy50: 0.5872 - val_loss: 2.9579 - val_accuracy50: 0.5869 - 56s/epoch - 28ms/step
testing model: results/AAL/W7/deepOF_L2/h50
Evaluating performance on  test set...
5331/5331 - 65s - 65s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8483964
{'0': {'precision': 0.517309023314679, 'recall': 0.43659917352613276, 'f1-score': 0.4735396818788229, 'support': 299586}, '1': {'precision': 0.6711571546788788, 'recall': 0.7825058821982991, 'f1-score': 0.7225669334537395, 'support': 760770}, '2': {'precision': 0.516786047960137, 'recall': 0.3817909908133248, 'f1-score': 0.4391482283111065, 'support': 304245}, 'accuracy': 0.6172236426618477, 'macro avg': {'precision': 0.5684174086512316, 'recall': 0.5336320155125855, 'f1-score': 0.545084947881223, 'support': 1364601}, 'weighted avg': {'precision': 0.6029633136612343, 'recall': 0.6172236426618477, 'f1-score': 0.6047055203839533, 'support': 1364601}}
[[130799 135719  33068]
 [ 89919 595307  75544]
 [ 32127 155960 116158]]
Evaluating performance on  train set...
2013/2013 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8850912
{'0': {'precision': 0.5358473440352932, 'recall': 0.39006906936900254, 'f1-score': 0.4514823839080868, 'support': 130159}, '1': {'precision': 0.6261089340192236, 'recall': 0.7612499709002305, 'f1-score': 0.6870974858955906, 'support': 257734}, '2': {'precision': 0.5187458604251984, 'recall': 0.4364252807710117, 'f1-score': 0.47403820743860126, 'support': 127417}, 'accuracy': 0.5871785915274301, 'macro avg': {'precision': 0.560234046159905, 'recall': 0.529248107013415, 'f1-score': 0.5375393590807596, 'support': 515310}, 'weighted avg': {'precision': 0.5767634157120914, 'recall': 0.5871785915274301, 'f1-score': 0.5749032724265221, 'support': 515310}}
[[ 50771  59768  19620]
 [ 29565 196200  31969]
 [ 14413  57396  55608]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8827797
{'0': {'precision': 0.5328955443721616, 'recall': 0.40526475461482814, 'f1-score': 0.46039846763610337, 'support': 42851}, '1': {'precision': 0.6333205481362669, 'recall': 0.7817086292231548, 'f1-score': 0.6997341757522055, 'support': 92940}, '2': {'precision': 0.5258122448979592, 'recall': 0.3821491290521619, 'f1-score': 0.4426150653491472, 'support': 42138}, 'accuracy': 0.5964232924368709, 'macro avg': {'precision': 0.5640094458021292, 'recall': 0.5230408376300483, 'f1-score': 0.5342492362458187, 'support': 177929}, 'weighted avg': {'precision': 0.5836743593859706, 'recall': 0.5964232924368709, 'f1-score': 0.5812022922332336, 'support': 177929}}
[[17366 20866  4619]
 [10385 72652  9903]
 [ 4837 21198 16103]]
training model: results/AAL/W7/deepOF_L2/h100
Epoch 1/50
2013/2013 - 59s - loss: 3.1505 - accuracy100: 0.4377 - val_loss: 3.1517 - val_accuracy100: 0.4463 - 59s/epoch - 29ms/step
Epoch 2/50
2013/2013 - 57s - loss: 3.0169 - accuracy100: 0.4787 - val_loss: 3.1187 - val_accuracy100: 0.4613 - 57s/epoch - 28ms/step
Epoch 3/50
2013/2013 - 56s - loss: 2.9710 - accuracy100: 0.4904 - val_loss: 3.1113 - val_accuracy100: 0.4674 - 56s/epoch - 28ms/step
Epoch 4/50
2013/2013 - 56s - loss: 2.9525 - accuracy100: 0.4953 - val_loss: 3.1126 - val_accuracy100: 0.4701 - 56s/epoch - 28ms/step
Epoch 5/50
2013/2013 - 57s - loss: 2.9390 - accuracy100: 0.4981 - val_loss: 3.0962 - val_accuracy100: 0.4726 - 57s/epoch - 28ms/step
Epoch 6/50
2013/2013 - 57s - loss: 2.9295 - accuracy100: 0.5011 - val_loss: 3.0902 - val_accuracy100: 0.4752 - 57s/epoch - 28ms/step
Epoch 7/50
2013/2013 - 57s - loss: 2.9201 - accuracy100: 0.5030 - val_loss: 3.0967 - val_accuracy100: 0.4747 - 57s/epoch - 28ms/step
Epoch 8/50
2013/2013 - 57s - loss: 2.9130 - accuracy100: 0.5044 - val_loss: 3.1002 - val_accuracy100: 0.4745 - 57s/epoch - 28ms/step
Epoch 9/50
2013/2013 - 56s - loss: 2.9055 - accuracy100: 0.5060 - val_loss: 3.0864 - val_accuracy100: 0.4758 - 56s/epoch - 28ms/step
Epoch 10/50
2013/2013 - 57s - loss: 2.8982 - accuracy100: 0.5078 - val_loss: 3.0799 - val_accuracy100: 0.4776 - 57s/epoch - 28ms/step
Epoch 11/50
2013/2013 - 58s - loss: 2.8913 - accuracy100: 0.5102 - val_loss: 3.0601 - val_accuracy100: 0.4799 - 58s/epoch - 29ms/step
Epoch 12/50
2013/2013 - 58s - loss: 2.8857 - accuracy100: 0.5109 - val_loss: 3.0655 - val_accuracy100: 0.4789 - 58s/epoch - 29ms/step
Epoch 13/50
2013/2013 - 58s - loss: 2.8791 - accuracy100: 0.5125 - val_loss: 3.0591 - val_accuracy100: 0.4824 - 58s/epoch - 29ms/step
Epoch 14/50
2013/2013 - 58s - loss: 2.8721 - accuracy100: 0.5143 - val_loss: 3.0648 - val_accuracy100: 0.4799 - 58s/epoch - 29ms/step
Epoch 15/50
2013/2013 - 58s - loss: 2.8661 - accuracy100: 0.5158 - val_loss: 3.0620 - val_accuracy100: 0.4787 - 58s/epoch - 29ms/step
Epoch 16/50
2013/2013 - 58s - loss: 2.8601 - accuracy100: 0.5168 - val_loss: 3.0646 - val_accuracy100: 0.4805 - 58s/epoch - 29ms/step
Epoch 17/50
2013/2013 - 57s - loss: 2.8553 - accuracy100: 0.5185 - val_loss: 3.0718 - val_accuracy100: 0.4813 - 57s/epoch - 28ms/step
Epoch 18/50
2013/2013 - 57s - loss: 2.8485 - accuracy100: 0.5201 - val_loss: 3.0681 - val_accuracy100: 0.4813 - 57s/epoch - 28ms/step
Epoch 19/50
2013/2013 - 57s - loss: 2.8428 - accuracy100: 0.5207 - val_loss: 3.0622 - val_accuracy100: 0.4804 - 57s/epoch - 28ms/step
Epoch 20/50
2013/2013 - 59s - loss: 2.8331 - accuracy100: 0.5235 - val_loss: 3.0829 - val_accuracy100: 0.4804 - 59s/epoch - 29ms/step
Epoch 21/50
2013/2013 - 57s - loss: 2.8279 - accuracy100: 0.5249 - val_loss: 3.0753 - val_accuracy100: 0.4806 - 57s/epoch - 28ms/step
Epoch 22/50
2013/2013 - 57s - loss: 2.8192 - accuracy100: 0.5279 - val_loss: 3.0689 - val_accuracy100: 0.4796 - 57s/epoch - 28ms/step
Epoch 23/50
2013/2013 - 56s - loss: 2.8132 - accuracy100: 0.5286 - val_loss: 3.0838 - val_accuracy100: 0.4781 - 56s/epoch - 28ms/step
testing model: results/AAL/W7/deepOF_L2/h100
Evaluating performance on  test set...
5331/5331 - 66s - 66s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98243827
{'0': {'precision': 0.4896745158067443, 'recall': 0.41510357581314394, 'f1-score': 0.44931601323818215, 'support': 386094}, '1': {'precision': 0.506906663804929, 'recall': 0.7432120428518655, 'f1-score': 0.6027253814147018, 'support': 584712}, '2': {'precision': 0.5218924984445827, 'recall': 0.23857336939270432, 'f1-score': 0.3274562530171084, 'support': 393795}, 'accuracy': 0.5047504728488401, 'macro avg': {'precision': 0.5061578926854187, 'recall': 0.4656296626859046, 'f1-score': 0.4598325492233308, 'support': 1364601}, 'weighted avg': {'precision': 0.5063556732976022, 'recall': 0.5047504728488401, 'f1-score': 0.4798835814936439, 'support': 1364601}}
[[160269 191440  34385]
 [ 98465 434565  51682]
 [ 68563 231283  93949]]
Evaluating performance on  train set...
2013/2013 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.007674
{'0': {'precision': 0.5120507915835741, 'recall': 0.37931803792698, 'f1-score': 0.4358018704537582, 'support': 165845}, '1': {'precision': 0.44140603921394356, 'recall': 0.7417259164830945, 'f1-score': 0.5534501834738241, 'support': 187483}, '2': {'precision': 0.548117911488878, 'recall': 0.2619550320405971, 'f1-score': 0.35449213854868084, 'support': 161982}, 'accuracy': 0.47427955987657916, 'macro avg': {'precision': 0.5005249140954652, 'recall': 0.46099966215022387, 'f1-score': 0.44791473082542105, 'support': 515310}, 'weighted avg': {'precision': 0.4976857183421961, 'recall': 0.47427955987657916, 'f1-score': 0.45304653032159076, 'support': 515310}}
[[ 62908  85039  17898]
 [ 31338 139061  17084]
 [ 28609  90941  42432]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0108681
{'0': {'precision': 0.5000590026197164, 'recall': 0.38638850390254575, 'f1-score': 0.435935683644182, 'support': 54836}, '1': {'precision': 0.46048301533924363, 'recall': 0.744259722141487, 'f1-score': 0.5689496195078597, 'support': 68812}, '2': {'precision': 0.5442481511914544, 'recall': 0.24404487758147417, 'f1-score': 0.33698375752025533, 'support': 54281}, 'accuracy': 0.48136616290767664, 'macro avg': {'precision': 0.5015967230501381, 'recall': 0.4582310345418356, 'f1-score': 0.44728968689076565, 'support': 177929}, 'weighted avg': {'precision': 0.4982342766721678, 'recall': 0.48136616290767664, 'f1-score': 0.4571899224288575, 'support': 177929}}
[[21188 28653  4995]
 [11500 51214  6098]
 [ 9683 31351 13247]]
training model: results/AAL/W7/deepOF_L2/h200
Epoch 1/50
2013/2013 - 61s - loss: 3.2513 - accuracy200: 0.3898 - val_loss: 3.2329 - val_accuracy200: 0.3878 - 61s/epoch - 30ms/step
Epoch 2/50
2013/2013 - 57s - loss: 3.1972 - accuracy200: 0.4138 - val_loss: 3.2102 - val_accuracy200: 0.4019 - 57s/epoch - 28ms/step
Epoch 3/50
2013/2013 - 57s - loss: 3.1740 - accuracy200: 0.4232 - val_loss: 3.1953 - val_accuracy200: 0.4082 - 57s/epoch - 28ms/step
Epoch 4/50
2013/2013 - 58s - loss: 3.1600 - accuracy200: 0.4280 - val_loss: 3.1912 - val_accuracy200: 0.4095 - 58s/epoch - 29ms/step
Epoch 5/50
2013/2013 - 58s - loss: 3.1507 - accuracy200: 0.4303 - val_loss: 3.1836 - val_accuracy200: 0.4136 - 58s/epoch - 29ms/step
Epoch 6/50
2013/2013 - 57s - loss: 3.1434 - accuracy200: 0.4329 - val_loss: 3.1900 - val_accuracy200: 0.4128 - 57s/epoch - 28ms/step
Epoch 7/50
2013/2013 - 56s - loss: 3.1380 - accuracy200: 0.4348 - val_loss: 3.1993 - val_accuracy200: 0.4103 - 56s/epoch - 28ms/step
Epoch 8/50
2013/2013 - 56s - loss: 3.1329 - accuracy200: 0.4369 - val_loss: 3.1927 - val_accuracy200: 0.4116 - 56s/epoch - 28ms/step
Epoch 9/50
2013/2013 - 57s - loss: 3.1290 - accuracy200: 0.4380 - val_loss: 3.1922 - val_accuracy200: 0.4145 - 57s/epoch - 28ms/step
Epoch 10/50
2013/2013 - 58s - loss: 3.1239 - accuracy200: 0.4396 - val_loss: 3.1929 - val_accuracy200: 0.4135 - 58s/epoch - 29ms/step
Epoch 11/50
2013/2013 - 58s - loss: 3.1189 - accuracy200: 0.4405 - val_loss: 3.2147 - val_accuracy200: 0.4075 - 58s/epoch - 29ms/step
Epoch 12/50
2013/2013 - 58s - loss: 3.1153 - accuracy200: 0.4425 - val_loss: 3.2026 - val_accuracy200: 0.4105 - 58s/epoch - 29ms/step
Epoch 13/50
2013/2013 - 57s - loss: 3.1109 - accuracy200: 0.4440 - val_loss: 3.1979 - val_accuracy200: 0.4138 - 57s/epoch - 28ms/step
Epoch 14/50
2013/2013 - 57s - loss: 3.1060 - accuracy200: 0.4449 - val_loss: 3.2121 - val_accuracy200: 0.4107 - 57s/epoch - 28ms/step
Epoch 15/50
2013/2013 - 56s - loss: 3.1002 - accuracy200: 0.4473 - val_loss: 3.2125 - val_accuracy200: 0.4097 - 56s/epoch - 28ms/step
testing model: results/AAL/W7/deepOF_L2/h200
Evaluating performance on  test set...
5331/5331 - 67s - 67s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0601292
{'0': {'precision': 0.38897451409299283, 'recall': 0.5601791844118108, 'f1-score': 0.459136231370836, 'support': 421242}, '1': {'precision': 0.4217796022684563, 'recall': 0.3917715123574716, 'f1-score': 0.4062221283741321, 'support': 515599}, '2': {'precision': 0.4343238865236027, 'recall': 0.28331774827005796, 'f1-score': 0.3429334631209005, 'support': 427760}, 'accuracy': 0.40976080187542, 'macro avg': {'precision': 0.41502600096168396, 'recall': 0.41175614834644675, 'f1-score': 0.4027639409552895, 'support': 1364601}, 'weighted avg': {'precision': 0.41558516307324306, 'recall': 0.40976080187542, 'f1-score': 0.4027172819947254, 'support': 1364601}}
[[235971 122917  62354]
 [218112 201997  95490]
 [152566 154002 121192]]
Evaluating performance on  train set...
2013/2013 - 24s - 24s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0603104
{'0': {'precision': 0.4442806901798873, 'recall': 0.46801629871258105, 'f1-score': 0.45583972486830254, 'support': 178419}, '1': {'precision': 0.36187672385125486, 'recall': 0.4507291044867031, 'f1-score': 0.40144524193154624, 'support': 164174}, '2': {'precision': 0.4488626653102747, 'recall': 0.3193316234070763, 'f1-score': 0.37317654063709443, 'support': 172717}, 'accuracy': 0.41267392443383594, 'macro avg': {'precision': 0.4183400264471389, 'recall': 0.4126923422021201, 'f1-score': 0.4101538358123144, 'support': 515310}, 'weighted avg': {'precision': 0.4195631342049561, 'recall': 0.41267392443383594, 'f1-score': 0.4108037328780043, 'support': 515310}}
[[83503 63645 31271]
 [53726 73998 36450]
 [50722 66841 55154]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0604603
{'0': {'precision': 0.4318241217618572, 'recall': 0.4757049707849945, 'f1-score': 0.45270368281086304, 'support': 59045}, '1': {'precision': 0.38198126483674255, 'recall': 0.44923683902569506, 'f1-score': 0.4128881581979934, 'support': 59817}, '2': {'precision': 0.441330668860938, 'recall': 0.31780859024497604, 'f1-score': 0.36952028503375917, 'support': 59067}, 'accuracy': 0.4143900094981706, 'macro avg': {'precision': 0.4183786851531792, 'recall': 0.4142501333518886, 'f1-score': 0.41170404201420524, 'support': 177929}, 'weighted avg': {'precision': 0.4182236015814022, 'recall': 0.4143900094981706, 'f1-score': 0.4117039638652824, 'support': 177929}}
[[28088 20780 10177]
 [19359 26872 13586]
 [17598 22697 18772]]
training model: results/AAL/W7/deepOF_L2/h300
Epoch 1/50
2013/2013 - 59s - loss: 3.2829 - accuracy300: 0.3737 - val_loss: 3.2826 - val_accuracy300: 0.3580 - 59s/epoch - 29ms/step
Epoch 2/50
2013/2013 - 56s - loss: 3.2536 - accuracy300: 0.3916 - val_loss: 3.2713 - val_accuracy300: 0.3664 - 56s/epoch - 28ms/step
Epoch 3/50
2013/2013 - 57s - loss: 3.2406 - accuracy300: 0.3999 - val_loss: 3.2658 - val_accuracy300: 0.3736 - 57s/epoch - 28ms/step
Epoch 4/50
2013/2013 - 58s - loss: 3.2328 - accuracy300: 0.4037 - val_loss: 3.2624 - val_accuracy300: 0.3782 - 58s/epoch - 29ms/step
Epoch 5/50
2013/2013 - 58s - loss: 3.2251 - accuracy300: 0.4073 - val_loss: 3.2658 - val_accuracy300: 0.3791 - 58s/epoch - 29ms/step
Epoch 6/50
2013/2013 - 58s - loss: 3.2190 - accuracy300: 0.4102 - val_loss: 3.2620 - val_accuracy300: 0.3831 - 58s/epoch - 29ms/step
Epoch 7/50
2013/2013 - 57s - loss: 3.2142 - accuracy300: 0.4130 - val_loss: 3.2727 - val_accuracy300: 0.3775 - 57s/epoch - 28ms/step
Epoch 8/50
2013/2013 - 57s - loss: 3.2100 - accuracy300: 0.4159 - val_loss: 3.2709 - val_accuracy300: 0.3792 - 57s/epoch - 28ms/step
Epoch 9/50
2013/2013 - 57s - loss: 3.2067 - accuracy300: 0.4170 - val_loss: 3.2844 - val_accuracy300: 0.3757 - 57s/epoch - 28ms/step
Epoch 10/50
2013/2013 - 56s - loss: 3.2026 - accuracy300: 0.4190 - val_loss: 3.2794 - val_accuracy300: 0.3808 - 56s/epoch - 28ms/step
Epoch 11/50
2013/2013 - 56s - loss: 3.1984 - accuracy300: 0.4210 - val_loss: 3.2876 - val_accuracy300: 0.3775 - 56s/epoch - 28ms/step
Epoch 12/50
2013/2013 - 57s - loss: 3.1952 - accuracy300: 0.4226 - val_loss: 3.2978 - val_accuracy300: 0.3768 - 57s/epoch - 28ms/step
Epoch 13/50
2013/2013 - 56s - loss: 3.1918 - accuracy300: 0.4249 - val_loss: 3.2843 - val_accuracy300: 0.3821 - 56s/epoch - 28ms/step
Epoch 14/50
2013/2013 - 57s - loss: 3.1870 - accuracy300: 0.4264 - val_loss: 3.3043 - val_accuracy300: 0.3746 - 57s/epoch - 28ms/step
Epoch 15/50
2013/2013 - 57s - loss: 3.1822 - accuracy300: 0.4294 - val_loss: 3.2932 - val_accuracy300: 0.3807 - 57s/epoch - 28ms/step
Epoch 16/50
2013/2013 - 58s - loss: 3.1782 - accuracy300: 0.4313 - val_loss: 3.2857 - val_accuracy300: 0.3824 - 58s/epoch - 29ms/step
testing model: results/AAL/W7/deepOF_L2/h300
Evaluating performance on  test set...
5331/5331 - 65s - 65s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0785176
{'0': {'precision': 0.3702902039398914, 'recall': 0.45652893124905736, 'f1-score': 0.4089121401817639, 'support': 411078}, '1': {'precision': 0.41322647746978003, 'recall': 0.4304219090016391, 'f1-score': 0.42164895265544633, 'support': 532603}, '2': {'precision': 0.38532567264758977, 'recall': 0.2773947543476195, 'f1-score': 0.3225713768701507, 'support': 420920}, 'accuracy': 0.3910842803134396, 'macro avg': {'precision': 0.3896141180190871, 'recall': 0.3881151981994386, 'f1-score': 0.38437748990245363, 'support': 1364601}, 'weighted avg': {'precision': 0.3916859947822575, 'recall': 0.3910842803134396, 'f1-score': 0.3872509443016469, 'support': 1364601}}
[[187669 153616  69793]
 [186894 229244 116465]
 [132253 171906 116761]]
Evaluating performance on  train set...
2013/2013 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0854595
{'0': {'precision': 0.41816179848145046, 'recall': 0.3547226249348179, 'f1-score': 0.3838386343695647, 'support': 174511}, '1': {'precision': 0.3567499075602211, 'recall': 0.45714830523165106, 'f1-score': 0.4007567852330635, 'support': 173062}, '2': {'precision': 0.3977650713362839, 'recall': 0.34505207557068507, 'f1-score': 0.36953822088141874, 'support': 167737}, 'accuracy': 0.38597349168461703, 'macro avg': {'precision': 0.39089225912598513, 'recall': 0.38564100191238465, 'f1-score': 0.38471121349468235, 'support': 515310}, 'weighted avg': {'precision': 0.39089791754034975, 'recall': 0.38597349168461703, 'f1-score': 0.3848655513078692, 'support': 515310}}
[[61903 73217 39391]
 [45708 79115 48239]
 [40425 69434 57878]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0868667
{'0': {'precision': 0.41034806047111216, 'recall': 0.359589216944801, 'f1-score': 0.3832954763142771, 'support': 58425}, '1': {'precision': 0.36102538179109245, 'recall': 0.4474469523354162, 'f1-score': 0.39961715442665197, 'support': 60653}, '2': {'precision': 0.39032952539808763, 'recall': 0.3419653022038708, 'f1-score': 0.3645503124716964, 'support': 58851}, 'accuracy': 0.3837092323342457, 'macro avg': {'precision': 0.38723432255343077, 'recall': 0.383000490494696, 'f1-score': 0.38248764773754185, 'support': 177929}, 'weighted avg': {'precision': 0.3869135487413671, 'recall': 0.3837092323342457, 'f1-score': 0.38265919501808676, 'support': 177929}}
[[21009 24015 13401]
 [15481 27139 18033]
 [14708 24018 20125]]
training model: results/AAL/W7/deepOF_L2/h500
Epoch 1/50
2013/2013 - 59s - loss: 3.2765 - accuracy500: 0.3776 - val_loss: 3.2874 - val_accuracy500: 0.3589 - 59s/epoch - 29ms/step
Epoch 2/50
2013/2013 - 57s - loss: 3.2579 - accuracy500: 0.3864 - val_loss: 3.2834 - val_accuracy500: 0.3613 - 57s/epoch - 28ms/step
Epoch 3/50
2013/2013 - 57s - loss: 3.2507 - accuracy500: 0.3920 - val_loss: 3.2812 - val_accuracy500: 0.3651 - 57s/epoch - 28ms/step
Epoch 4/50
2013/2013 - 57s - loss: 3.2432 - accuracy500: 0.3954 - val_loss: 3.2781 - val_accuracy500: 0.3725 - 57s/epoch - 28ms/step
Epoch 5/50
2013/2013 - 57s - loss: 3.2397 - accuracy500: 0.3981 - val_loss: 3.2775 - val_accuracy500: 0.3727 - 57s/epoch - 28ms/step
Epoch 6/50
2013/2013 - 56s - loss: 3.2364 - accuracy500: 0.4006 - val_loss: 3.2770 - val_accuracy500: 0.3741 - 56s/epoch - 28ms/step
Epoch 7/50
2013/2013 - 57s - loss: 3.2339 - accuracy500: 0.4028 - val_loss: 3.2753 - val_accuracy500: 0.3761 - 57s/epoch - 28ms/step
Epoch 8/50
2013/2013 - 57s - loss: 3.2295 - accuracy500: 0.4056 - val_loss: 3.2749 - val_accuracy500: 0.3786 - 57s/epoch - 28ms/step
Epoch 9/50
2013/2013 - 56s - loss: 3.2265 - accuracy500: 0.4079 - val_loss: 3.2732 - val_accuracy500: 0.3809 - 56s/epoch - 28ms/step
Epoch 10/50
2013/2013 - 56s - loss: 3.2240 - accuracy500: 0.4100 - val_loss: 3.2717 - val_accuracy500: 0.3821 - 56s/epoch - 28ms/step
Epoch 11/50
2013/2013 - 57s - loss: 3.2214 - accuracy500: 0.4116 - val_loss: 3.2727 - val_accuracy500: 0.3829 - 57s/epoch - 28ms/step
Epoch 12/50
2013/2013 - 57s - loss: 3.2197 - accuracy500: 0.4127 - val_loss: 3.2711 - val_accuracy500: 0.3855 - 57s/epoch - 29ms/step
Epoch 13/50
2013/2013 - 58s - loss: 3.2168 - accuracy500: 0.4150 - val_loss: 3.2726 - val_accuracy500: 0.3835 - 58s/epoch - 29ms/step
Epoch 14/50
2013/2013 - 57s - loss: 3.2151 - accuracy500: 0.4170 - val_loss: 3.2743 - val_accuracy500: 0.3828 - 57s/epoch - 28ms/step
Epoch 15/50
2013/2013 - 58s - loss: 3.2114 - accuracy500: 0.4191 - val_loss: 3.2751 - val_accuracy500: 0.3834 - 58s/epoch - 29ms/step
Epoch 16/50
2013/2013 - 58s - loss: 3.2080 - accuracy500: 0.4205 - val_loss: 3.2766 - val_accuracy500: 0.3817 - 58s/epoch - 29ms/step
Epoch 17/50
2013/2013 - 60s - loss: 3.2058 - accuracy500: 0.4221 - val_loss: 3.2847 - val_accuracy500: 0.3798 - 60s/epoch - 30ms/step
Epoch 18/50
2013/2013 - 58s - loss: 3.2014 - accuracy500: 0.4250 - val_loss: 3.2884 - val_accuracy500: 0.3774 - 58s/epoch - 29ms/step
Epoch 19/50
2013/2013 - 56s - loss: 3.1977 - accuracy500: 0.4275 - val_loss: 3.2948 - val_accuracy500: 0.3783 - 56s/epoch - 28ms/step
Epoch 20/50
2013/2013 - 57s - loss: 3.1952 - accuracy500: 0.4287 - val_loss: 3.2940 - val_accuracy500: 0.3760 - 57s/epoch - 28ms/step
Epoch 21/50
2013/2013 - 58s - loss: 3.1902 - accuracy500: 0.4311 - val_loss: 3.2955 - val_accuracy500: 0.3774 - 58s/epoch - 29ms/step
Epoch 22/50
2013/2013 - 58s - loss: 3.1873 - accuracy500: 0.4335 - val_loss: 3.2893 - val_accuracy500: 0.3771 - 58s/epoch - 29ms/step
testing model: results/AAL/W7/deepOF_L2/h500
Evaluating performance on  test set...
5331/5331 - 65s - 65s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0885854
{'0': {'precision': 0.37234660565107064, 'recall': 0.47567219324744864, 'f1-score': 0.4177146232803799, 'support': 439271}, '1': {'precision': 0.4058742690546533, 'recall': 0.15269027415553482, 'f1-score': 0.22190113628931804, 'support': 477758}, '2': {'precision': 0.3761038961038961, 'recall': 0.5241078530381704, 'f1-score': 0.4379391975147302, 'support': 447572}, 'accuracy': 0.37847986334467, 'macro avg': {'precision': 0.3847749236032067, 'recall': 0.38415677348038463, 'f1-score': 0.35918498569480944, 'support': 1364601}, 'weighted avg': {'precision': 0.3853172596480418, 'recall': 0.37847986334467, 'f1-score': 0.3557921222865663, 'support': 1364601}}
[[208949  53994 176328]
 [192013  72949 212796]
 [160206  52790 234576]]
Evaluating performance on  train set...
2013/2013 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0896205
{'0': {'precision': 0.40998607519395264, 'recall': 0.38203541016019954, 'f1-score': 0.39551754919036164, 'support': 178028}, '1': {'precision': 0.3686109040570759, 'recall': 0.16558837598660608, 'f1-score': 0.22852026670187484, 'support': 167240}, '2': {'precision': 0.36658147733611385, 'recall': 0.5913244963009139, 'f1-score': 0.4525884865630057, 'support': 170042}, 'accuracy': 0.38085036191806876, 'macro avg': {'precision': 0.3817261521957141, 'recall': 0.3796494274825732, 'f1-score': 0.35887543415174744, 'support': 515310}, 'weighted avg': {'precision': 0.3822354236446447, 'recall': 0.38085036191806876, 'f1-score': 0.360152100837612, 'support': 515310}}
[[ 68013  24630  85385]
 [ 51191  27693  88356]
 [ 46687  22805 100550]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0908816
{'0': {'precision': 0.3977783444362987, 'recall': 0.4131600728356232, 'f1-score': 0.4053233297606288, 'support': 60410}, '1': {'precision': 0.3562372188139059, 'recall': 0.17207255747126438, 'f1-score': 0.23205570693309113, 'support': 55680}, '2': {'precision': 0.38624728162377675, 'recall': 0.5514481152670645, 'f1-score': 0.4542953632591073, 'support': 61839}, 'accuracy': 0.3857774730369979, 'macro avg': {'precision': 0.38008761495799376, 'recall': 0.378893581857984, 'f1-score': 0.36389146665094246, 'support': 177929}, 'weighted avg': {'precision': 0.38077111532851765, 'recall': 0.3857774730369979, 'f1-score': 0.36812220088605024, 'support': 177929}}
[[24959  8626 26825]
 [18737  9581 27362]
 [19050  8688 34101]]
training model: results/AAL/W7/deepOF_L2/h1000
Epoch 1/50
2013/2013 - 61s - loss: 3.2206 - accuracy1000: 0.4154 - val_loss: 3.2532 - val_accuracy1000: 0.3810 - 61s/epoch - 30ms/step
Epoch 2/50
2013/2013 - 58s - loss: 3.2067 - accuracy1000: 0.4169 - val_loss: 3.2504 - val_accuracy1000: 0.3901 - 58s/epoch - 29ms/step
Epoch 3/50
2013/2013 - 58s - loss: 3.1984 - accuracy1000: 0.4172 - val_loss: 3.2501 - val_accuracy1000: 0.3906 - 58s/epoch - 29ms/step
Epoch 4/50
2013/2013 - 58s - loss: 3.1909 - accuracy1000: 0.4200 - val_loss: 3.2525 - val_accuracy1000: 0.3899 - 58s/epoch - 29ms/step
Epoch 5/50
2013/2013 - 57s - loss: 3.1902 - accuracy1000: 0.4200 - val_loss: 3.2551 - val_accuracy1000: 0.3878 - 57s/epoch - 29ms/step
Epoch 6/50
2013/2013 - 58s - loss: 3.1869 - accuracy1000: 0.4221 - val_loss: 3.2549 - val_accuracy1000: 0.3887 - 58s/epoch - 29ms/step
Epoch 7/50
2013/2013 - 58s - loss: 3.1839 - accuracy1000: 0.4232 - val_loss: 3.2562 - val_accuracy1000: 0.3861 - 58s/epoch - 29ms/step
Epoch 8/50
2013/2013 - 58s - loss: 3.1836 - accuracy1000: 0.4230 - val_loss: 3.2574 - val_accuracy1000: 0.3866 - 58s/epoch - 29ms/step
Epoch 9/50
2013/2013 - 58s - loss: 3.1833 - accuracy1000: 0.4237 - val_loss: 3.2571 - val_accuracy1000: 0.3866 - 58s/epoch - 29ms/step
Epoch 10/50
2013/2013 - 58s - loss: 3.1826 - accuracy1000: 0.4250 - val_loss: 3.2593 - val_accuracy1000: 0.3868 - 58s/epoch - 29ms/step
Epoch 11/50
2013/2013 - 58s - loss: 3.1826 - accuracy1000: 0.4254 - val_loss: 3.2611 - val_accuracy1000: 0.3873 - 58s/epoch - 29ms/step
Epoch 12/50
2013/2013 - 57s - loss: 3.1818 - accuracy1000: 0.4259 - val_loss: 3.2606 - val_accuracy1000: 0.3878 - 57s/epoch - 29ms/step
Epoch 13/50
2013/2013 - 57s - loss: 3.1783 - accuracy1000: 0.4275 - val_loss: 3.2597 - val_accuracy1000: 0.3886 - 57s/epoch - 29ms/step
testing model: results/AAL/W7/deepOF_L2/h1000
Evaluating performance on  test set...
5331/5331 - 65s - 65s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1494046
{'0': {'precision': 0.2768271440910695, 'recall': 0.2927019458039147, 'f1-score': 0.28454330135002404, 'support': 329581}, '1': {'precision': 0.37994428969359334, 'recall': 0.006949488832634357, 'f1-score': 0.013649320536023168, 'support': 686957}, '2': {'precision': 0.2586036639745704, 'recall': 0.7456207640570817, 'f1-score': 0.3840182655158484, 'support': 348063}, 'accuracy': 0.2643747146601827, 'macro avg': {'precision': 0.30512503258641105, 'recall': 0.3484240662312102, 'f1-score': 0.2274036291339652, 'support': 1364601}, 'weighted avg': {'precision': 0.3240894030457998, 'recall': 0.2643747146601827, 'f1-score': 0.17354458309787982, 'support': 1364601}}
[[ 96469   3862 229250]
 [167401   4774 514782]
 [ 84611   3929 259523]]
Evaluating performance on  train set...
2013/2013 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1039962
{'0': {'precision': 0.3849157805589536, 'recall': 0.27406270065045646, 'f1-score': 0.32016541162121, 'support': 179105}, '1': {'precision': 0.32357626443647947, 'recall': 0.009705316721812775, 'f1-score': 0.01884538664934824, 'support': 167434}, '2': {'precision': 0.32973320374956894, 'recall': 0.7478180493094193, 'f1-score': 0.4576681443607387, 'support': 168771}, 'accuracy': 0.3433292581164736, 'macro avg': {'precision': 0.3460750829150007, 'recall': 0.3438620222272295, 'f1-score': 0.26555964754376565, 'support': 515310}, 'weighted avg': {'precision': 0.34691236666606007, 'recall': 0.3433292581164736, 'f1-score': 0.26729482235658153, 'support': 515310}}
[[ 49086   1724 128295]
 [ 37550   1625 128259]
 [ 40888   1673 126210]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0839567
{'0': {'precision': 0.3847870379353837, 'recall': 0.2462359916803775, 'f1-score': 0.30030098245215514, 'support': 64426}, '1': {'precision': 0.3165775401069519, 'recall': 0.013119695055736543, 'f1-score': 0.025195241844530036, 'support': 45123}, '2': {'precision': 0.39444193100993097, 'recall': 0.7777566539923955, 'f1-score': 0.5234263893194758, 'support': 68380}, 'accuracy': 0.3913864518993531, 'macro avg': {'precision': 0.3652688363507555, 'recall': 0.3457041135761698, 'f1-score': 0.2829742045387203, 'support': 177929}, 'weighted avg': {'precision': 0.3711995081787123, 'recall': 0.3913864518993531, 'f1-score': 0.31628330679585137, 'support': 177929}}
[[15864   605 47957]
 [10840   592 33691]
 [14524   673 53183]]
training model: results/AAL/W7/deepVOL_L2/h10
Epoch 1/50
2013/2013 - 61s - loss: 2.8752 - accuracy10: 0.4447 - val_loss: 2.4381 - val_accuracy10: 0.6733 - 61s/epoch - 30ms/step
Epoch 2/50
2013/2013 - 60s - loss: 2.5277 - accuracy10: 0.5798 - val_loss: 2.3819 - val_accuracy10: 0.7301 - 60s/epoch - 30ms/step
Epoch 3/50
2013/2013 - 57s - loss: 2.4281 - accuracy10: 0.6160 - val_loss: 2.3609 - val_accuracy10: 0.7159 - 57s/epoch - 28ms/step
Epoch 4/50
2013/2013 - 55s - loss: 2.3582 - accuracy10: 0.6314 - val_loss: 2.3289 - val_accuracy10: 0.7189 - 55s/epoch - 27ms/step
Epoch 5/50
2013/2013 - 56s - loss: 2.3142 - accuracy10: 0.6437 - val_loss: 2.3124 - val_accuracy10: 0.7259 - 56s/epoch - 28ms/step
Epoch 6/50
2013/2013 - 56s - loss: 2.2871 - accuracy10: 0.6489 - val_loss: 2.2855 - val_accuracy10: 0.7239 - 56s/epoch - 28ms/step
Epoch 7/50
2013/2013 - 55s - loss: 2.2617 - accuracy10: 0.6531 - val_loss: 2.2896 - val_accuracy10: 0.7388 - 55s/epoch - 27ms/step
Epoch 8/50
2013/2013 - 55s - loss: 2.2439 - accuracy10: 0.6552 - val_loss: 2.2827 - val_accuracy10: 0.7340 - 55s/epoch - 27ms/step
Epoch 9/50
2013/2013 - 56s - loss: 2.2269 - accuracy10: 0.6564 - val_loss: 2.2608 - val_accuracy10: 0.7362 - 56s/epoch - 28ms/step
Epoch 10/50
2013/2013 - 56s - loss: 2.2126 - accuracy10: 0.6583 - val_loss: 2.2808 - val_accuracy10: 0.7454 - 56s/epoch - 28ms/step
Epoch 11/50
2013/2013 - 56s - loss: 2.2007 - accuracy10: 0.6601 - val_loss: 2.2855 - val_accuracy10: 0.7388 - 56s/epoch - 28ms/step
Epoch 12/50
2013/2013 - 55s - loss: 2.1948 - accuracy10: 0.6601 - val_loss: 2.3216 - val_accuracy10: 0.7564 - 55s/epoch - 27ms/step
Epoch 13/50
2013/2013 - 56s - loss: 2.1862 - accuracy10: 0.6614 - val_loss: 2.2804 - val_accuracy10: 0.7404 - 56s/epoch - 28ms/step
Epoch 14/50
2013/2013 - 56s - loss: 2.1751 - accuracy10: 0.6626 - val_loss: 2.2723 - val_accuracy10: 0.7429 - 56s/epoch - 28ms/step
Epoch 15/50
2013/2013 - 56s - loss: 2.1663 - accuracy10: 0.6632 - val_loss: 2.3016 - val_accuracy10: 0.7496 - 56s/epoch - 28ms/step
Epoch 16/50
2013/2013 - 56s - loss: 2.1610 - accuracy10: 0.6634 - val_loss: 2.2753 - val_accuracy10: 0.7459 - 56s/epoch - 28ms/step
Epoch 17/50
2013/2013 - 56s - loss: 2.1527 - accuracy10: 0.6650 - val_loss: 2.2699 - val_accuracy10: 0.7498 - 56s/epoch - 28ms/step
Epoch 18/50
2013/2013 - 56s - loss: 2.1500 - accuracy10: 0.6640 - val_loss: 2.2698 - val_accuracy10: 0.7470 - 56s/epoch - 28ms/step
Epoch 19/50
2013/2013 - 57s - loss: 2.1428 - accuracy10: 0.6665 - val_loss: 2.2638 - val_accuracy10: 0.7494 - 57s/epoch - 28ms/step
testing model: results/AAL/W7/deepVOL_L2/h10
Evaluating performance on  test set...
5331/5331 - 67s - 67s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6173935
{'0': {'precision': 0.40155379624150667, 'recall': 0.5393633348863979, 'f1-score': 0.46036656685692895, 'support': 145948}, '1': {'precision': 0.8996306862897366, 'recall': 0.8060764553699017, 'f1-score': 0.8502879504166673, 'support': 1070690}, '2': {'precision': 0.41045678534386754, 'recall': 0.5803754865916955, 'f1-score': 0.48084638190771883, 'support': 147968}, 'accuracy': 0.7530774450647293, 'macro avg': {'precision': 0.5705470892917036, 'recall': 0.6419384256159983, 'f1-score': 0.5971669663937716, 'support': 1364606}, 'weighted avg': {'precision': 0.7933176481498505, 'recall': 0.7530774450647293, 'f1-score': 0.7685253199600308, 'support': 1364606}}
[[ 78719  44042  23187]
 [107473 863058 100159]
 [  9844  52247  85877]]
Evaluating performance on  train set...
2013/2013 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6917802
{'0': {'precision': 0.395747215021369, 'recall': 0.5061153174140943, 'f1-score': 0.44417795427290774, 'support': 66963}, '1': {'precision': 0.8814778451293435, 'recall': 0.7551511383702342, 'f1-score': 0.8134390932931153, 'support': 382828}, '2': {'precision': 0.395732966276669, 'recall': 0.61430686344836, 'f1-score': 0.4813700809060521, 'support': 65521}, 'accuracy': 0.7048817027354302, 'macro avg': {'precision': 0.5576526754757939, 'recall': 0.6251911064108961, 'f1-score': 0.5796623761573584, 'support': 515312}, 'weighted avg': {'precision': 0.7565972477607077, 'recall': 0.7048817027354302, 'f1-score': 0.7232329125466492, 'support': 515312}}
[[ 33891  18700  14372]
 [ 46647 289093  47088]
 [  5100  20171  40250]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6405896
{'0': {'precision': 0.4085530704680313, 'recall': 0.5416123626885124, 'f1-score': 0.4657660362253578, 'support': 21484}, '1': {'precision': 0.8895798221653978, 'recall': 0.7899338705277825, 'f1-score': 0.8368008371991317, 'support': 135643}, '2': {'precision': 0.41791096244698095, 'recall': 0.5825882126718585, 'f1-score': 0.4866970542760185, 'support': 20802}, 'accuracy': 0.7357091873724912, 'macro avg': {'precision': 0.5720146183601367, 'recall': 0.6380448152960512, 'f1-score': 0.5964213092335027, 'support': 177929}, 'weighted avg': {'precision': 0.7763546910550744, 'recall': 0.7357091873724912, 'f1-score': 0.7510690534174705, 'support': 177929}}
[[ 11636   6356   3492]
 [ 15106 107149  13388]
 [  1739   6944  12119]]
training model: results/AAL/W7/deepVOL_L2/h20
Epoch 1/50
2013/2013 - 64s - loss: 2.9119 - accuracy20: 0.4890 - val_loss: 2.6384 - val_accuracy20: 0.6503 - 64s/epoch - 32ms/step
Epoch 2/50
2013/2013 - 58s - loss: 2.6221 - accuracy20: 0.5698 - val_loss: 2.5722 - val_accuracy20: 0.6745 - 58s/epoch - 29ms/step
Epoch 3/50
2013/2013 - 55s - loss: 2.5398 - accuracy20: 0.5948 - val_loss: 2.5303 - val_accuracy20: 0.6756 - 55s/epoch - 27ms/step
Epoch 4/50
2013/2013 - 56s - loss: 2.4916 - accuracy20: 0.6036 - val_loss: 2.5219 - val_accuracy20: 0.6831 - 56s/epoch - 28ms/step
Epoch 5/50
2013/2013 - 55s - loss: 2.4537 - accuracy20: 0.6112 - val_loss: 2.4969 - val_accuracy20: 0.6862 - 55s/epoch - 28ms/step
Epoch 6/50
2013/2013 - 56s - loss: 2.4294 - accuracy20: 0.6156 - val_loss: 2.5082 - val_accuracy20: 0.7010 - 56s/epoch - 28ms/step
Epoch 7/50
2013/2013 - 57s - loss: 2.4071 - accuracy20: 0.6200 - val_loss: 2.5108 - val_accuracy20: 0.6954 - 57s/epoch - 28ms/step
Epoch 8/50
2013/2013 - 57s - loss: 2.3922 - accuracy20: 0.6223 - val_loss: 2.5090 - val_accuracy20: 0.7012 - 57s/epoch - 28ms/step
Epoch 9/50
2013/2013 - 57s - loss: 2.3780 - accuracy20: 0.6244 - val_loss: 2.4861 - val_accuracy20: 0.7064 - 57s/epoch - 28ms/step
Epoch 10/50
2013/2013 - 56s - loss: 2.3650 - accuracy20: 0.6278 - val_loss: 2.4710 - val_accuracy20: 0.7018 - 56s/epoch - 28ms/step
Epoch 11/50
2013/2013 - 56s - loss: 2.3549 - accuracy20: 0.6289 - val_loss: 2.4767 - val_accuracy20: 0.7018 - 56s/epoch - 28ms/step
Epoch 12/50
2013/2013 - 57s - loss: 2.3447 - accuracy20: 0.6305 - val_loss: 2.4842 - val_accuracy20: 0.7042 - 57s/epoch - 28ms/step
Epoch 13/50
2013/2013 - 56s - loss: 2.3361 - accuracy20: 0.6314 - val_loss: 2.4804 - val_accuracy20: 0.7044 - 56s/epoch - 28ms/step
Epoch 14/50
2013/2013 - 56s - loss: 2.3283 - accuracy20: 0.6327 - val_loss: 2.4808 - val_accuracy20: 0.7036 - 56s/epoch - 28ms/step
Epoch 15/50
2013/2013 - 57s - loss: 2.3227 - accuracy20: 0.6328 - val_loss: 2.4780 - val_accuracy20: 0.7038 - 57s/epoch - 29ms/step
Epoch 16/50
2013/2013 - 58s - loss: 2.3149 - accuracy20: 0.6349 - val_loss: 2.4829 - val_accuracy20: 0.7018 - 58s/epoch - 29ms/step
Epoch 17/50
2013/2013 - 59s - loss: 2.3095 - accuracy20: 0.6356 - val_loss: 2.4997 - val_accuracy20: 0.7025 - 59s/epoch - 29ms/step
Epoch 18/50
2013/2013 - 57s - loss: 2.3051 - accuracy20: 0.6361 - val_loss: 2.4719 - val_accuracy20: 0.7028 - 57s/epoch - 28ms/step
Epoch 19/50
2013/2013 - 57s - loss: 2.2983 - accuracy20: 0.6361 - val_loss: 2.4899 - val_accuracy20: 0.7090 - 57s/epoch - 28ms/step
Epoch 20/50
2013/2013 - 56s - loss: 2.2923 - accuracy20: 0.6380 - val_loss: 2.4824 - val_accuracy20: 0.7062 - 56s/epoch - 28ms/step
testing model: results/AAL/W7/deepVOL_L2/h20
Evaluating performance on  test set...
5331/5331 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6852937
{'0': {'precision': 0.4631179849093434, 'recall': 0.498409267657129, 'f1-score': 0.48011597192156324, 'support': 198022}, '1': {'precision': 0.8296403242309736, 'recall': 0.8066268945334538, 'f1-score': 0.8179717721406039, 'support': 966003}, '2': {'precision': 0.4697649879644067, 'recall': 0.4971806900952732, 'f1-score': 0.4830841818692657, 'support': 200581}, 'accuracy': 0.7164155807610402, 'macro avg': {'precision': 0.5875077657015746, 'recall': 0.600738950761952, 'f1-score': 0.5937239753104776, 'support': 1364606}, 'weighted avg': {'precision': 0.7235557536656734, 'recall': 0.7164155807610402, 'f1-score': 0.7197199917620989, 'support': 1364606}}
[[ 98696  75040  24286]
 [ 98523 779204  88276]
 [ 15893  84963  99725]]
Evaluating performance on  train set...
2013/2013 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7439401
{'0': {'precision': 0.465111531353419, 'recall': 0.48945047489823607, 'f1-score': 0.47697071203473124, 'support': 88440}, '1': {'precision': 0.8016432753745114, 'recall': 0.7673529368543256, 'f1-score': 0.7841233992455732, 'support': 340245}, '2': {'precision': 0.46772239081126427, 'recall': 0.5213155251826798, 'f1-score': 0.493066928704007, 'support': 86627}, 'accuracy': 0.6782978079299531, 'macro avg': {'precision': 0.5781590658463982, 'recall': 0.5927063123117472, 'f1-score': 0.5847203466614371, 'support': 515312}, 'weighted avg': {'precision': 0.6877522114980912, 'recall': 0.6782978079299531, 'f1-score': 0.6824802538685373, 'support': 515312}}
[[ 43287  31468  13685]
 [ 41449 261088  37708]
 [  8332  33135  45160]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7096724
{'0': {'precision': 0.4712143526576516, 'recall': 0.49365313135563504, 'f1-score': 0.48217282597527145, 'support': 28518}, '1': {'precision': 0.8115588831382008, 'recall': 0.7977886998114714, 'f1-score': 0.8046148800405193, 'support': 121467}, '2': {'precision': 0.4828079729116487, 'recall': 0.4949541941024907, 'f1-score': 0.4888056404728667, 'support': 27944}, 'accuracy': 0.7014820518296624, 'macro avg': {'precision': 0.588527069569167, 'recall': 0.5954653417565324, 'f1-score': 0.5918644488295525, 'support': 177929}, 'weighted avg': {'precision': 0.7053785485349878, 'recall': 0.7014820518296624, 'f1-score': 0.7033364156625302, 'support': 177929}}
[[14078 10911  3529]
 [13275 96905 11287]
 [ 2523 11590 13831]]
training model: results/AAL/W7/deepVOL_L2/h30
Epoch 1/50
2013/2013 - 58s - loss: 3.0445 - accuracy30: 0.4288 - val_loss: 2.7837 - val_accuracy30: 0.5560 - 58s/epoch - 29ms/step
Epoch 2/50
2013/2013 - 56s - loss: 2.7615 - accuracy30: 0.5421 - val_loss: 2.7626 - val_accuracy30: 0.6220 - 56s/epoch - 28ms/step
Epoch 3/50
2013/2013 - 58s - loss: 2.6650 - accuracy30: 0.5655 - val_loss: 2.7153 - val_accuracy30: 0.6283 - 58s/epoch - 29ms/step
Epoch 4/50
2013/2013 - 59s - loss: 2.6158 - accuracy30: 0.5811 - val_loss: 2.6737 - val_accuracy30: 0.6324 - 59s/epoch - 29ms/step
Epoch 5/50
2013/2013 - 59s - loss: 2.5863 - accuracy30: 0.5880 - val_loss: 2.6798 - val_accuracy30: 0.6291 - 59s/epoch - 29ms/step
Epoch 6/50
2013/2013 - 59s - loss: 2.5658 - accuracy30: 0.5922 - val_loss: 2.6614 - val_accuracy30: 0.6450 - 59s/epoch - 29ms/step
Epoch 7/50
2013/2013 - 57s - loss: 2.5456 - accuracy30: 0.5948 - val_loss: 2.6415 - val_accuracy30: 0.6541 - 57s/epoch - 28ms/step
Epoch 8/50
2013/2013 - 55s - loss: 2.5276 - accuracy30: 0.5976 - val_loss: 2.6437 - val_accuracy30: 0.6565 - 55s/epoch - 27ms/step
Epoch 9/50
2013/2013 - 55s - loss: 2.5131 - accuracy30: 0.5984 - val_loss: 2.6657 - val_accuracy30: 0.6558 - 55s/epoch - 27ms/step
Epoch 10/50
2013/2013 - 56s - loss: 2.4991 - accuracy30: 0.6009 - val_loss: 2.6635 - val_accuracy30: 0.6621 - 56s/epoch - 28ms/step
Epoch 11/50
2013/2013 - 57s - loss: 2.4901 - accuracy30: 0.6034 - val_loss: 2.6880 - val_accuracy30: 0.6619 - 57s/epoch - 28ms/step
Epoch 12/50
2013/2013 - 56s - loss: 2.4822 - accuracy30: 0.6035 - val_loss: 2.6731 - val_accuracy30: 0.6641 - 56s/epoch - 28ms/step
Epoch 13/50
2013/2013 - 56s - loss: 2.4726 - accuracy30: 0.6048 - val_loss: 2.6843 - val_accuracy30: 0.6638 - 56s/epoch - 28ms/step
Epoch 14/50
2013/2013 - 57s - loss: 2.4666 - accuracy30: 0.6062 - val_loss: 2.6539 - val_accuracy30: 0.6613 - 57s/epoch - 28ms/step
Epoch 15/50
2013/2013 - 57s - loss: 2.4582 - accuracy30: 0.6082 - val_loss: 2.6679 - val_accuracy30: 0.6665 - 57s/epoch - 29ms/step
Epoch 16/50
2013/2013 - 57s - loss: 2.4527 - accuracy30: 0.6085 - val_loss: 2.6663 - val_accuracy30: 0.6675 - 57s/epoch - 28ms/step
Epoch 17/50
2013/2013 - 57s - loss: 2.4471 - accuracy30: 0.6100 - val_loss: 2.6622 - val_accuracy30: 0.6654 - 57s/epoch - 28ms/step
testing model: results/AAL/W7/deepVOL_L2/h30
Evaluating performance on  test set...
5331/5331 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77388823
{'0': {'precision': 0.46670511012699856, 'recall': 0.43489120898034916, 'f1-score': 0.4502368638358903, 'support': 238209}, '1': {'precision': 0.7576259349493808, 'recall': 0.8031126909405323, 'f1-score': 0.7797064713466656, 'support': 884765}, '2': {'precision': 0.49085225885225886, 'recall': 0.41593000927029533, 'f1-score': 0.4502959348719259, 'support': 241632}, 'accuracy': 0.670276255563877, 'macro avg': {'precision': 0.5717277679762127, 'recall': 0.5513113030637256, 'f1-score': 0.5600797566848272, 'support': 1364606}, 'weighted avg': {'precision': 0.6596042234349843, 'recall': 0.670276255563877, 'f1-score': 0.6638644242759372, 'support': 1364606}}
[[103595 104009  30605]
 [100556 710566  73643]
 [ 17820 123310 100502]]
Evaluating performance on  train set...
2013/2013 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8165431
{'0': {'precision': 0.4689411074809416, 'recall': 0.42680823079782315, 'f1-score': 0.4468837784840759, 'support': 104923}, '1': {'precision': 0.7201490055211868, 'recall': 0.7743063908918899, 'f1-score': 0.7462463967915779, 'support': 307594}, '2': {'precision': 0.4995622404310248, 'recall': 0.4329588014981273, 'f1-score': 0.46388201266383516, 'support': 102795}, 'accuracy': 0.6354596826776787, 'macro avg': {'precision': 0.5628841178110511, 'recall': 0.5446911410626135, 'f1-score': 0.5523373959798297, 'support': 515312}, 'weighted avg': {'precision': 0.6249975190362614, 'recall': 0.6354596826776787, 'f1-score': 0.6289666306167375, 'support': 515312}}
[[ 44782  43505  16636]
 [ 41474 238172  27948]
 [  9240  49049  44506]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7939765
{'0': {'precision': 0.47988207852792536, 'recall': 0.4344243064109332, 'f1-score': 0.45602315057106796, 'support': 34098}, '1': {'precision': 0.7340039869121617, 'recall': 0.791088749886683, 'f1-score': 0.7614780169197946, 'support': 110310}, '2': {'precision': 0.5057148942212125, 'recall': 0.42501715342621044, 'f1-score': 0.4618676349018527, 'support': 33521}, 'accuracy': 0.6537720101838373, 'macro avg': {'precision': 0.5732003198870999, 'recall': 0.5501767365746089, 'f1-score': 0.5597896007975717, 'support': 177929}, 'weighted avg': {'precision': 0.6422959038667954, 'recall': 0.6537720101838373, 'f1-score': 0.6464959754966297, 'support': 177929}}
[[14813 15116  4169]
 [13289 87265  9756]
 [ 2766 16508 14247]]
training model: results/AAL/W7/deepVOL_L2/h50
Epoch 1/50
2013/2013 - 62s - loss: 3.1174 - accuracy50: 0.4352 - val_loss: 2.9559 - val_accuracy50: 0.5318 - 62s/epoch - 31ms/step
Epoch 2/50
2013/2013 - 55s - loss: 2.9312 - accuracy50: 0.5044 - val_loss: 2.9243 - val_accuracy50: 0.5590 - 55s/epoch - 27ms/step
Epoch 3/50
2013/2013 - 55s - loss: 2.8415 - accuracy50: 0.5293 - val_loss: 2.9093 - val_accuracy50: 0.5673 - 55s/epoch - 27ms/step
Epoch 4/50
2013/2013 - 55s - loss: 2.7916 - accuracy50: 0.5440 - val_loss: 2.8733 - val_accuracy50: 0.5674 - 55s/epoch - 27ms/step
Epoch 5/50
2013/2013 - 55s - loss: 2.7683 - accuracy50: 0.5509 - val_loss: 2.8651 - val_accuracy50: 0.5711 - 55s/epoch - 27ms/step
Epoch 6/50
2013/2013 - 55s - loss: 2.7509 - accuracy50: 0.5549 - val_loss: 2.8452 - val_accuracy50: 0.5681 - 55s/epoch - 27ms/step
Epoch 7/50
2013/2013 - 55s - loss: 2.7338 - accuracy50: 0.5577 - val_loss: 2.8363 - val_accuracy50: 0.5809 - 55s/epoch - 27ms/step
Epoch 8/50
2013/2013 - 55s - loss: 2.7204 - accuracy50: 0.5599 - val_loss: 2.8370 - val_accuracy50: 0.5815 - 55s/epoch - 27ms/step
Epoch 9/50
2013/2013 - 56s - loss: 2.7106 - accuracy50: 0.5612 - val_loss: 2.8503 - val_accuracy50: 0.5861 - 56s/epoch - 28ms/step
Epoch 10/50
2013/2013 - 55s - loss: 2.7021 - accuracy50: 0.5622 - val_loss: 2.8402 - val_accuracy50: 0.5888 - 55s/epoch - 27ms/step
Epoch 11/50
2013/2013 - 55s - loss: 2.6900 - accuracy50: 0.5647 - val_loss: 2.8548 - val_accuracy50: 0.5888 - 55s/epoch - 27ms/step
Epoch 12/50
2013/2013 - 55s - loss: 2.6826 - accuracy50: 0.5657 - val_loss: 2.8498 - val_accuracy50: 0.5864 - 55s/epoch - 27ms/step
Epoch 13/50
2013/2013 - 55s - loss: 2.6748 - accuracy50: 0.5676 - val_loss: 2.8466 - val_accuracy50: 0.5885 - 55s/epoch - 27ms/step
Epoch 14/50
2013/2013 - 55s - loss: 2.6700 - accuracy50: 0.5682 - val_loss: 2.8474 - val_accuracy50: 0.5857 - 55s/epoch - 27ms/step
Epoch 15/50
2013/2013 - 55s - loss: 2.6635 - accuracy50: 0.5689 - val_loss: 2.8540 - val_accuracy50: 0.5868 - 55s/epoch - 27ms/step
Epoch 16/50
2013/2013 - 55s - loss: 2.6571 - accuracy50: 0.5700 - val_loss: 2.8574 - val_accuracy50: 0.5867 - 55s/epoch - 27ms/step
Epoch 17/50
2013/2013 - 55s - loss: 2.6526 - accuracy50: 0.5707 - val_loss: 2.8780 - val_accuracy50: 0.5863 - 55s/epoch - 27ms/step
testing model: results/AAL/W7/deepVOL_L2/h50
Evaluating performance on  test set...
5331/5331 - 72s - 72s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8736124
{'0': {'precision': 0.4676892412366808, 'recall': 0.4166736206844756, 'f1-score': 0.4407099797879946, 'support': 299587}, '1': {'precision': 0.6646626105942055, 'recall': 0.7650945752329876, 'f1-score': 0.7113512179085288, 'support': 760770}, '2': {'precision': 0.4979321902565165, 'recall': 0.36328139122889475, 'f1-score': 0.4200804601851307, 'support': 304249}, 'accuracy': 0.5990146606419728, 'macro avg': {'precision': 0.5434280140291343, 'recall': 0.515016529048786, 'f1-score': 0.5240472192938846, 'support': 1364606}, 'weighted avg': {'precision': 0.5842450948694949, 'recall': 0.5990146606419728, 'f1-score': 0.5869933934731955, 'support': 1364606}}
[[124830 136203  38554]
 [105817 582061  72892]
 [ 36261 157460 110528]]
Evaluating performance on  train set...
2013/2013 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9118994
{'0': {'precision': 0.47145350482719584, 'recall': 0.46054773900221185, 'f1-score': 0.4659368152787059, 'support': 130208}, '1': {'precision': 0.6214358253261464, 'recall': 0.7099701988296832, 'f1-score': 0.6627593813786945, 'support': 257708}, '2': {'precision': 0.5118205202096208, 'recall': 0.37641684197306036, 'f1-score': 0.43379815368471514, 'support': 127396}, 'accuracy': 0.5644852050796411, 'macro avg': {'precision': 0.5349032834543209, 'recall': 0.5156449266016518, 'f1-score': 0.5208314501140384, 'support': 515312}, 'weighted avg': {'precision': 0.5564393777406986, 'recall': 0.5644852050796411, 'f1-score': 0.5564226043386692, 'support': 515312}}
[[ 59967  52786  17455]
 [ 46459 182965  28284]
 [ 20770  58672  47954]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8948608
{'0': {'precision': 0.4831021270973709, 'recall': 0.42675411978899214, 'f1-score': 0.45318328850992107, 'support': 42842}, '1': {'precision': 0.6294033265543288, 'recall': 0.7454621704159319, 'f1-score': 0.6825342128581274, 'support': 92996}, '2': {'precision': 0.525751503006012, 'recall': 0.3739754341783279, 'f1-score': 0.43706182060501725, 'support': 42091}, 'accuracy': 0.5808440445346177, 'macro avg': {'precision': 0.5460856522192373, 'recall': 0.515397241461084, 'f1-score': 0.5242597739910219, 'support': 177929}, 'weighted avg': {'precision': 0.5696567709500867, 'recall': 0.5808440445346177, 'f1-score': 0.5692416592932138, 'support': 177929}}
[[18283 19634  4925]
 [14397 69325  9274]
 [ 5165 21185 15741]]
training model: results/AAL/W7/deepVOL_L2/h100
Epoch 1/50
2013/2013 - 57s - loss: 3.2238 - accuracy100: 0.4103 - val_loss: 3.1991 - val_accuracy100: 0.4155 - 57s/epoch - 29ms/step
Epoch 2/50
2013/2013 - 55s - loss: 3.1051 - accuracy100: 0.4519 - val_loss: 3.0997 - val_accuracy100: 0.4547 - 55s/epoch - 27ms/step
Epoch 3/50
2013/2013 - 56s - loss: 3.0312 - accuracy100: 0.4718 - val_loss: 3.0606 - val_accuracy100: 0.4596 - 56s/epoch - 28ms/step
Epoch 4/50
2013/2013 - 55s - loss: 3.0021 - accuracy100: 0.4800 - val_loss: 3.0511 - val_accuracy100: 0.4602 - 55s/epoch - 27ms/step
Epoch 5/50
2013/2013 - 55s - loss: 2.9864 - accuracy100: 0.4833 - val_loss: 3.0461 - val_accuracy100: 0.4671 - 55s/epoch - 27ms/step
Epoch 6/50
2013/2013 - 55s - loss: 2.9766 - accuracy100: 0.4866 - val_loss: 3.0422 - val_accuracy100: 0.4702 - 55s/epoch - 27ms/step
Epoch 7/50
2013/2013 - 55s - loss: 2.9689 - accuracy100: 0.4888 - val_loss: 3.0385 - val_accuracy100: 0.4724 - 55s/epoch - 27ms/step
Epoch 8/50
2013/2013 - 55s - loss: 2.9631 - accuracy100: 0.4901 - val_loss: 3.0364 - val_accuracy100: 0.4747 - 55s/epoch - 27ms/step
Epoch 9/50
2013/2013 - 55s - loss: 2.9585 - accuracy100: 0.4916 - val_loss: 3.0346 - val_accuracy100: 0.4724 - 55s/epoch - 27ms/step
Epoch 10/50
2013/2013 - 58s - loss: 2.9541 - accuracy100: 0.4928 - val_loss: 3.0321 - val_accuracy100: 0.4770 - 58s/epoch - 29ms/step
Epoch 11/50
2013/2013 - 55s - loss: 2.9474 - accuracy100: 0.4949 - val_loss: 3.0327 - val_accuracy100: 0.4728 - 55s/epoch - 27ms/step
Epoch 12/50
2013/2013 - 55s - loss: 2.9432 - accuracy100: 0.4960 - val_loss: 3.0318 - val_accuracy100: 0.4742 - 55s/epoch - 27ms/step
Epoch 13/50
2013/2013 - 54s - loss: 2.9386 - accuracy100: 0.4976 - val_loss: 3.0373 - val_accuracy100: 0.4727 - 54s/epoch - 27ms/step
Epoch 14/50
2013/2013 - 55s - loss: 2.9339 - accuracy100: 0.4993 - val_loss: 3.0367 - val_accuracy100: 0.4715 - 55s/epoch - 27ms/step
Epoch 15/50
2013/2013 - 55s - loss: 2.9297 - accuracy100: 0.5008 - val_loss: 3.0372 - val_accuracy100: 0.4712 - 55s/epoch - 27ms/step
Epoch 16/50
2013/2013 - 55s - loss: 2.9253 - accuracy100: 0.5016 - val_loss: 3.0445 - val_accuracy100: 0.4698 - 55s/epoch - 28ms/step
Epoch 17/50
2013/2013 - 54s - loss: 2.9208 - accuracy100: 0.5033 - val_loss: 3.0450 - val_accuracy100: 0.4683 - 54s/epoch - 27ms/step
Epoch 18/50
2013/2013 - 56s - loss: 2.9156 - accuracy100: 0.5045 - val_loss: 3.0466 - val_accuracy100: 0.4682 - 56s/epoch - 28ms/step
Epoch 19/50
2013/2013 - 55s - loss: 2.9121 - accuracy100: 0.5054 - val_loss: 3.0450 - val_accuracy100: 0.4656 - 55s/epoch - 27ms/step
Epoch 20/50
2013/2013 - 55s - loss: 2.9068 - accuracy100: 0.5072 - val_loss: 3.0407 - val_accuracy100: 0.4658 - 55s/epoch - 27ms/step
Epoch 21/50
2013/2013 - 54s - loss: 2.9030 - accuracy100: 0.5077 - val_loss: 3.0508 - val_accuracy100: 0.4657 - 54s/epoch - 27ms/step
Epoch 22/50
2013/2013 - 56s - loss: 2.8999 - accuracy100: 0.5087 - val_loss: 3.0514 - val_accuracy100: 0.4654 - 56s/epoch - 28ms/step
testing model: results/AAL/W7/deepVOL_L2/h100
Evaluating performance on  test set...
5331/5331 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9966232
{'0': {'precision': 0.4414606108886715, 'recall': 0.4406350768593222, 'f1-score': 0.4410474575743906, 'support': 386095}, '1': {'precision': 0.5210779226395105, 'recall': 0.6594790948721851, 'f1-score': 0.5821658618479705, 'support': 584713}, '2': {'precision': 0.4829339051990452, 'recall': 0.2933636026592314, 'f1-score': 0.3650024091056294, 'support': 393798}, 'accuracy': 0.49190682145615655, 'macro avg': {'precision': 0.48182414624240905, 'recall': 0.4644925914635796, 'f1-score': 0.46273857617599684, 'support': 1364606}, 'weighted avg': {'precision': 0.48754378622177486, 'recall': 0.49190682145615655, 'f1-score': 0.47956947603328387, 'support': 1364606}}
[[170127 157635  58333]
 [133749 385606  65358]
 [ 81497 196775 115526]]
Evaluating performance on  train set...
2013/2013 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0085567
{'0': {'precision': 0.4673703967078957, 'recall': 0.48340577918985234, 'f1-score': 0.47525286501320263, 'support': 165871}, '1': {'precision': 0.4593104383118178, 'recall': 0.6142211274964546, 'f1-score': 0.5255889706016533, 'support': 187566}, '2': {'precision': 0.5122465670870819, 'recall': 0.29405405405405405, 'f1-score': 0.37362783998367344, 'support': 161875}, 'accuracy': 0.4715395721427019, 'macro avg': {'precision': 0.47964246736893185, 'recall': 0.46389365358012036, 'f1-score': 0.4581565585328431, 'support': 515312}, 'weighted avg': {'precision': 0.4785336452323081, 'recall': 0.4715395721427019, 'f1-score': 0.4616509909139158, 'support': 515312}}
[[ 80183  61969  23719]
 [ 50754 115207  21605]
 [ 40625  73650  47600]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0078832
{'0': {'precision': 0.46117503196042464, 'recall': 0.4535862672206429, 'f1-score': 0.4573491717884408, 'support': 54876}, '1': {'precision': 0.4695464078266885, 'recall': 0.6211399355082358, 'f1-score': 0.5348082466748791, 'support': 68846}, '2': {'precision': 0.5082565459355898, 'recall': 0.3083181138967292, 'f1-score': 0.38380985187736827, 'support': 54207}, 'accuracy': 0.4741610417638496, 'macro avg': {'precision': 0.4796593285742343, 'recall': 0.461014772208536, 'f1-score': 0.4586557567802294, 'support': 177929}, 'weighted avg': {'precision': 0.47875779458450823, 'recall': 0.4741610417638496, 'f1-score': 0.46491624379588325, 'support': 177929}}
[[24891 22298  7687]
 [17600 42763  8483]
 [11482 26012 16713]]
training model: results/AAL/W7/deepVOL_L2/h200
Epoch 1/50
2013/2013 - 58s - loss: 3.2776 - accuracy200: 0.3789 - val_loss: 3.2761 - val_accuracy200: 0.3823 - 58s/epoch - 29ms/step
Epoch 2/50
2013/2013 - 56s - loss: 3.2365 - accuracy200: 0.3969 - val_loss: 3.2661 - val_accuracy200: 0.3870 - 56s/epoch - 28ms/step
Epoch 3/50
2013/2013 - 55s - loss: 3.2060 - accuracy200: 0.4096 - val_loss: 3.2355 - val_accuracy200: 0.3986 - 55s/epoch - 27ms/step
Epoch 4/50
2013/2013 - 54s - loss: 3.1796 - accuracy200: 0.4182 - val_loss: 3.2052 - val_accuracy200: 0.4079 - 54s/epoch - 27ms/step
Epoch 5/50
2013/2013 - 54s - loss: 3.1672 - accuracy200: 0.4217 - val_loss: 3.2006 - val_accuracy200: 0.4050 - 54s/epoch - 27ms/step
Epoch 6/50
2013/2013 - 57s - loss: 3.1581 - accuracy200: 0.4243 - val_loss: 3.1955 - val_accuracy200: 0.4094 - 57s/epoch - 28ms/step
Epoch 7/50
2013/2013 - 55s - loss: 3.1520 - accuracy200: 0.4257 - val_loss: 3.1919 - val_accuracy200: 0.4103 - 55s/epoch - 27ms/step
Epoch 8/50
2013/2013 - 55s - loss: 3.1472 - accuracy200: 0.4279 - val_loss: 3.1888 - val_accuracy200: 0.4092 - 55s/epoch - 27ms/step
Epoch 9/50
2013/2013 - 55s - loss: 3.1422 - accuracy200: 0.4301 - val_loss: 3.1935 - val_accuracy200: 0.4089 - 55s/epoch - 27ms/step
Epoch 10/50
2013/2013 - 55s - loss: 3.1374 - accuracy200: 0.4317 - val_loss: 3.1946 - val_accuracy200: 0.4073 - 55s/epoch - 27ms/step
Epoch 11/50
2013/2013 - 55s - loss: 3.1330 - accuracy200: 0.4348 - val_loss: 3.1953 - val_accuracy200: 0.4072 - 55s/epoch - 27ms/step
Epoch 12/50
2013/2013 - 54s - loss: 3.1285 - accuracy200: 0.4356 - val_loss: 3.1927 - val_accuracy200: 0.4089 - 54s/epoch - 27ms/step
Epoch 13/50
2013/2013 - 55s - loss: 3.1257 - accuracy200: 0.4370 - val_loss: 3.1980 - val_accuracy200: 0.4079 - 55s/epoch - 27ms/step
Epoch 14/50
2013/2013 - 56s - loss: 3.1203 - accuracy200: 0.4394 - val_loss: 3.2052 - val_accuracy200: 0.4041 - 56s/epoch - 28ms/step
Epoch 15/50
2013/2013 - 55s - loss: 3.1159 - accuracy200: 0.4408 - val_loss: 3.2057 - val_accuracy200: 0.4032 - 55s/epoch - 27ms/step
Epoch 16/50
2013/2013 - 55s - loss: 3.1118 - accuracy200: 0.4442 - val_loss: 3.2073 - val_accuracy200: 0.4064 - 55s/epoch - 27ms/step
Epoch 17/50
2013/2013 - 55s - loss: 3.1078 - accuracy200: 0.4456 - val_loss: 3.2167 - val_accuracy200: 0.4030 - 55s/epoch - 27ms/step
Epoch 18/50
2013/2013 - 54s - loss: 3.1016 - accuracy200: 0.4480 - val_loss: 3.2142 - val_accuracy200: 0.4041 - 54s/epoch - 27ms/step
testing model: results/AAL/W7/deepVOL_L2/h200
Evaluating performance on  test set...
5331/5331 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0613946
{'0': {'precision': 0.3928778195782843, 'recall': 0.41723898082579414, 'f1-score': 0.4046921158730195, 'support': 421243}, '1': {'precision': 0.44125540193470003, 'recall': 0.44517843289371606, 'f1-score': 0.44320823646629026, 'support': 515600}, '2': {'precision': 0.4000085629591572, 'recall': 0.3712967227179536, 'f1-score': 0.3851182436937909, 'support': 427763}, 'accuracy': 0.41339404927136475, 'macro avg': {'precision': 0.4113805948240472, 'recall': 0.4112380454791546, 'f1-score': 0.4110061986777002, 'support': 1364606}, 'weighted avg': {'precision': 0.4133919823797085, 'recall': 0.41339404927136475, 'f1-score': 0.4131091486963305, 'support': 1364606}}
[[175759 138598 106886]
 [154720 229534 131346]
 [116884 152052 158827]]
Evaluating performance on  train set...
2013/2013 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0629283
{'0': {'precision': 0.42667807636594207, 'recall': 0.46391839251184036, 'f1-score': 0.44451963201056927, 'support': 178415}, '1': {'precision': 0.38247689463955636, 'recall': 0.4095878480025824, 'f1-score': 0.3955683917038222, 'support': 164187}, '2': {'precision': 0.42210309278350516, 'recall': 0.3556018759770714, 'f1-score': 0.38600923918167246, 'support': 172710}, 'accuracy': 0.4103048250380352, 'macro avg': {'precision': 0.41041935459633455, 'recall': 0.4097027054971647, 'f1-score': 0.40869908763202134, 'support': 515312}, 'weighted avg': {'precision': 0.41106150846410244, 'recall': 0.4103048250380352, 'f1-score': 0.40931283062088175, 'support': 515312}}
[[82770 53711 41934]
 [54788 67249 42150]
 [56429 54865 61416]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0620356
{'0': {'precision': 0.421924742136763, 'recall': 0.4485944930528525, 'f1-score': 0.43485108232920194, 'support': 59089}, '1': {'precision': 0.38933930787704907, 'recall': 0.4041527933474995, 'f1-score': 0.3966077761723368, 'support': 59767}, '2': {'precision': 0.4160636212875019, 'recall': 0.37374096456926176, 'f1-score': 0.3937683369449869, 'support': 59073}, 'accuracy': 0.40881475195162115, 'macro avg': {'precision': 0.4091092237671046, 'recall': 0.40882941698987124, 'f1-score': 0.4084090651488419, 'support': 177929}, 'weighted avg': {'precision': 0.40903326496705644, 'recall': 0.40881475195162115, 'f1-score': 0.408365412780342, 'support': 177929}}
[[26507 18261 14321]
 [18947 24155 16665]
 [17370 19625 22078]]
training model: results/AAL/W7/deepVOL_L2/h300
Epoch 1/50
2013/2013 - 58s - loss: 3.3003 - accuracy300: 0.3602 - val_loss: 3.2894 - val_accuracy300: 0.3559 - 58s/epoch - 29ms/step
Epoch 2/50
2013/2013 - 56s - loss: 3.2727 - accuracy300: 0.3758 - val_loss: 3.2736 - val_accuracy300: 0.3804 - 56s/epoch - 28ms/step
Epoch 3/50
2013/2013 - 56s - loss: 3.2575 - accuracy300: 0.3889 - val_loss: 3.2674 - val_accuracy300: 0.3839 - 56s/epoch - 28ms/step
Epoch 4/50
2013/2013 - 55s - loss: 3.2447 - accuracy300: 0.3985 - val_loss: 3.2693 - val_accuracy300: 0.3853 - 55s/epoch - 27ms/step
Epoch 5/50
2013/2013 - 57s - loss: 3.2363 - accuracy300: 0.4025 - val_loss: 3.2676 - val_accuracy300: 0.3874 - 57s/epoch - 28ms/step
Epoch 6/50
2013/2013 - 55s - loss: 3.2294 - accuracy300: 0.4064 - val_loss: 3.2685 - val_accuracy300: 0.3839 - 55s/epoch - 27ms/step
Epoch 7/50
2013/2013 - 54s - loss: 3.2227 - accuracy300: 0.4103 - val_loss: 3.2678 - val_accuracy300: 0.3871 - 54s/epoch - 27ms/step
Epoch 8/50
2013/2013 - 55s - loss: 3.2177 - accuracy300: 0.4124 - val_loss: 3.2690 - val_accuracy300: 0.3881 - 55s/epoch - 27ms/step
Epoch 9/50
2013/2013 - 55s - loss: 3.2126 - accuracy300: 0.4149 - val_loss: 3.2692 - val_accuracy300: 0.3886 - 55s/epoch - 27ms/step
Epoch 10/50
2013/2013 - 55s - loss: 3.2078 - accuracy300: 0.4181 - val_loss: 3.2715 - val_accuracy300: 0.3898 - 55s/epoch - 27ms/step
Epoch 11/50
2013/2013 - 55s - loss: 3.2023 - accuracy300: 0.4204 - val_loss: 3.2846 - val_accuracy300: 0.3881 - 55s/epoch - 27ms/step
Epoch 12/50
2013/2013 - 55s - loss: 3.1983 - accuracy300: 0.4216 - val_loss: 3.2777 - val_accuracy300: 0.3884 - 55s/epoch - 27ms/step
Epoch 13/50
2013/2013 - 55s - loss: 3.1934 - accuracy300: 0.4245 - val_loss: 3.2802 - val_accuracy300: 0.3900 - 55s/epoch - 28ms/step
testing model: results/AAL/W7/deepVOL_L2/h300
Evaluating performance on  test set...
5331/5331 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0886823
{'0': {'precision': 0.3475527008594707, 'recall': 0.4878198298133201, 'f1-score': 0.40591016141715947, 'support': 411078}, '1': {'precision': 0.41223611206349114, 'recall': 0.2596131459771237, 'f1-score': 0.31858906639355505, 'support': 532604}, '2': {'precision': 0.36730826216370416, 'recall': 0.39460567703433397, 'f1-score': 0.38046797155062817, 'support': 420924}, 'accuracy': 0.36999837315679396, 'macro avg': {'precision': 0.3756990250288887, 'recall': 0.3806795509415926, 'f1-score': 0.3683223997871143, 'support': 1364606}, 'weighted avg': {'precision': 0.37889232081375, 'recall': 0.36999837315679396, 'f1-score': 0.3639809944478426, 'support': 1364606}}
[[200532  96144 114402]
 [222628 138271 171705]
 [153823 101002 166099]]
Evaluating performance on  train set...
2013/2013 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0908982
{'0': {'precision': 0.385111738624893, 'recall': 0.5180296311574026, 'f1-score': 0.44178973212649786, 'support': 174546}, '1': {'precision': 0.35737146748382703, 'recall': 0.27303470162842725, 'f1-score': 0.3095617294874064, 'support': 172989}, '2': {'precision': 0.3917820407392928, 'recall': 0.3464360430809944, 'f1-score': 0.3677163237224603, 'support': 167777}, 'accuracy': 0.37991740925885675, 'macro avg': {'precision': 0.37808841561600426, 'recall': 0.3791667919556081, 'f1-score': 0.37302259511212155, 'support': 515312}, 'weighted avg': {'precision': 0.3779711354823808, 'recall': 0.37991740925885675, 'f1-score': 0.3732840420002482, 'support': 515312}}
[[90420 41724 42402]
 [77925 47232 47832]
 [66444 43209 58124]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0881537
{'0': {'precision': 0.38514776917882926, 'recall': 0.5081200534484531, 'f1-score': 0.43816938235858954, 'support': 58374}, '1': {'precision': 0.36682867840282785, 'recall': 0.2599410048942867, 'f1-score': 0.3042706685698854, 'support': 60683}, '2': {'precision': 0.39812832377926655, 'recall': 0.39166326946596003, 'f1-score': 0.3948693358906737, 'support': 58872}, 'accuracy': 0.38494568058045625, 'macro avg': {'precision': 0.38336825712030786, 'recall': 0.3865747759362333, 'f1-score': 0.3791031289397162, 'support': 177929}, 'weighted avg': {'precision': 0.38319493307497243, 'recall': 0.38494568058045625, 'f1-score': 0.3781761491897465, 'support': 177929}}
[[29661 13073 15640]
 [25691 15774 19218]
 [21660 14154 23058]]
training model: results/AAL/W7/deepVOL_L2/h500
Epoch 1/50
2013/2013 - 59s - loss: 3.2779 - accuracy500: 0.3764 - val_loss: 3.2958 - val_accuracy500: 0.3408 - 59s/epoch - 30ms/step
Epoch 2/50
2013/2013 - 56s - loss: 3.2796 - accuracy500: 0.3651 - val_loss: 3.2900 - val_accuracy500: 0.3542 - 56s/epoch - 28ms/step
Epoch 3/50
2013/2013 - 55s - loss: 3.2670 - accuracy500: 0.3782 - val_loss: 3.2855 - val_accuracy500: 0.3635 - 55s/epoch - 27ms/step
Epoch 4/50
2013/2013 - 56s - loss: 3.2584 - accuracy500: 0.3824 - val_loss: 3.2806 - val_accuracy500: 0.3715 - 56s/epoch - 28ms/step
Epoch 5/50
2013/2013 - 55s - loss: 3.2491 - accuracy500: 0.3917 - val_loss: 3.2814 - val_accuracy500: 0.3735 - 55s/epoch - 27ms/step
Epoch 6/50
2013/2013 - 56s - loss: 3.2437 - accuracy500: 0.3951 - val_loss: 3.2810 - val_accuracy500: 0.3739 - 56s/epoch - 28ms/step
Epoch 7/50
2013/2013 - 56s - loss: 3.2343 - accuracy500: 0.4009 - val_loss: 3.2942 - val_accuracy500: 0.3659 - 56s/epoch - 28ms/step
Epoch 8/50
2013/2013 - 55s - loss: 3.2325 - accuracy500: 0.4026 - val_loss: 3.2930 - val_accuracy500: 0.3709 - 55s/epoch - 27ms/step
Epoch 9/50
2013/2013 - 55s - loss: 3.2254 - accuracy500: 0.4071 - val_loss: 3.2928 - val_accuracy500: 0.3666 - 55s/epoch - 27ms/step
Epoch 10/50
2013/2013 - 55s - loss: 3.2190 - accuracy500: 0.4101 - val_loss: 3.3003 - val_accuracy500: 0.3643 - 55s/epoch - 27ms/step
Epoch 11/50
2013/2013 - 55s - loss: 3.2194 - accuracy500: 0.4109 - val_loss: 3.2992 - val_accuracy500: 0.3695 - 55s/epoch - 27ms/step
Epoch 12/50
2013/2013 - 55s - loss: 3.2111 - accuracy500: 0.4143 - val_loss: 3.3016 - val_accuracy500: 0.3709 - 55s/epoch - 27ms/step
Epoch 13/50
2013/2013 - 58s - loss: 3.2067 - accuracy500: 0.4162 - val_loss: 3.3101 - val_accuracy500: 0.3717 - 58s/epoch - 29ms/step
Epoch 14/50
2013/2013 - 55s - loss: 3.1977 - accuracy500: 0.4205 - val_loss: 3.3369 - val_accuracy500: 0.3638 - 55s/epoch - 27ms/step
testing model: results/AAL/W7/deepVOL_L2/h500
Evaluating performance on  test set...
5331/5331 - 71s - 71s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0974557
{'0': {'precision': 0.347558655157489, 'recall': 0.4844333351545284, 'f1-score': 0.4047370658379116, 'support': 439272}, '1': {'precision': 0.3602185582822086, 'recall': 0.196637209633329, 'f1-score': 0.25440114385058454, 'support': 477758}, '2': {'precision': 0.3520581192616689, 'recall': 0.3866404811696784, 'f1-score': 0.368539809203752, 'support': 447576}, 'accuracy': 0.3515989230591101, 'macro avg': {'precision': 0.35327844423378885, 'recall': 0.3559036753191786, 'f1-score': 0.34255933963074936, 'support': 1364606}, 'weighted avg': {'precision': 0.3534667503461018, 'recall': 0.3515989230591101, 'f1-score': 0.34023111118718313, 'support': 1364606}}
[[212798  81479 144995]
 [210318  93945 173495]
 [189149  85376 173051]]
Evaluating performance on  train set...
2013/2013 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0951357
{'0': {'precision': 0.37287784281738795, 'recall': 0.545599550688009, 'f1-score': 0.44299834691899903, 'support': 178050}, '1': {'precision': 0.3510439334235135, 'recall': 0.1784810807901394, 'f1-score': 0.2366449136885174, 'support': 167211}, '2': {'precision': 0.3622976698159885, 'recall': 0.3617032537297634, 'f1-score': 0.36200021776042235, 'support': 170051}, 'accuracy': 0.3657900456422517, 'macro avg': {'precision': 0.36207314868562995, 'recall': 0.3619279617359707, 'f1-score': 0.3472144927893129, 'support': 515312}, 'weighted avg': {'precision': 0.36230165048590696, 'recall': 0.3657900456422517, 'f1-score': 0.34931068432731244, 'support': 515312}}
[[97144 28077 52829]
 [81932 29844 55435]
 [81449 27094 61508]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.093532
{'0': {'precision': 0.3811501309018687, 'recall': 0.4894748174034018, 'f1-score': 0.42857350019576845, 'support': 60379}, '1': {'precision': 0.3283724701045256, 'recall': 0.2035793781862569, 'f1-score': 0.2513380242672725, 'support': 55708}, '2': {'precision': 0.38455347516438126, 'recall': 0.40949516509815337, 'f1-score': 0.3966326011198559, 'support': 61842}, 'accuracy': 0.37216530189007974, 'macro avg': {'precision': 0.3646920253902585, 'recall': 0.36751645356260404, 'f1-score': 0.3588480418609656, 'support': 177929}, 'weighted avg': {'precision': 0.3658087963705889, 'recall': 0.37216530189007974, 'f1-score': 0.3619810786474136, 'support': 177929}}
[[29554 11078 19747]
 [23585 11341 20782]
 [24400 12118 25324]]
training model: results/AAL/W7/deepVOL_L2/h1000
Epoch 1/50
2013/2013 - 59s - loss: 3.2183 - accuracy1000: 0.4188 - val_loss: 3.2533 - val_accuracy1000: 0.3822 - 59s/epoch - 29ms/step
Epoch 2/50
2013/2013 - 54s - loss: 3.2203 - accuracy1000: 0.4120 - val_loss: 3.2567 - val_accuracy1000: 0.3797 - 54s/epoch - 27ms/step
Epoch 3/50
2013/2013 - 55s - loss: 3.2053 - accuracy1000: 0.4157 - val_loss: 3.2527 - val_accuracy1000: 0.3839 - 55s/epoch - 27ms/step
Epoch 4/50
2013/2013 - 55s - loss: 3.2143 - accuracy1000: 0.4151 - val_loss: 3.2559 - val_accuracy1000: 0.3830 - 55s/epoch - 27ms/step
Epoch 5/50
2013/2013 - 56s - loss: 3.2027 - accuracy1000: 0.4171 - val_loss: 3.2584 - val_accuracy1000: 0.3853 - 56s/epoch - 28ms/step
Epoch 6/50
2013/2013 - 54s - loss: 3.2035 - accuracy1000: 0.4188 - val_loss: 3.2555 - val_accuracy1000: 0.3840 - 54s/epoch - 27ms/step
Epoch 7/50
2013/2013 - 55s - loss: 3.1928 - accuracy1000: 0.4264 - val_loss: 3.2499 - val_accuracy1000: 0.3942 - 55s/epoch - 27ms/step
Epoch 8/50
2013/2013 - 54s - loss: 3.1841 - accuracy1000: 0.4301 - val_loss: 3.2521 - val_accuracy1000: 0.3960 - 54s/epoch - 27ms/step
Epoch 9/50
2013/2013 - 55s - loss: 3.1817 - accuracy1000: 0.4303 - val_loss: 3.2573 - val_accuracy1000: 0.3926 - 55s/epoch - 27ms/step
Epoch 10/50
2013/2013 - 56s - loss: 3.1745 - accuracy1000: 0.4341 - val_loss: 3.2661 - val_accuracy1000: 0.3896 - 56s/epoch - 28ms/step
Epoch 11/50
2013/2013 - 55s - loss: 3.1673 - accuracy1000: 0.4372 - val_loss: 3.2764 - val_accuracy1000: 0.3840 - 55s/epoch - 27ms/step
Epoch 12/50
2013/2013 - 55s - loss: 3.1640 - accuracy1000: 0.4389 - val_loss: 3.2747 - val_accuracy1000: 0.3864 - 55s/epoch - 27ms/step
Epoch 13/50
2013/2013 - 55s - loss: 3.1595 - accuracy1000: 0.4404 - val_loss: 3.2822 - val_accuracy1000: 0.3795 - 55s/epoch - 27ms/step
Epoch 14/50
2013/2013 - 54s - loss: 3.1531 - accuracy1000: 0.4421 - val_loss: 3.2843 - val_accuracy1000: 0.3860 - 54s/epoch - 27ms/step
Epoch 15/50
2013/2013 - 54s - loss: 3.1440 - accuracy1000: 0.4458 - val_loss: 3.2893 - val_accuracy1000: 0.3809 - 54s/epoch - 27ms/step
Epoch 16/50
2013/2013 - 55s - loss: 3.1367 - accuracy1000: 0.4490 - val_loss: 3.2870 - val_accuracy1000: 0.3813 - 55s/epoch - 27ms/step
Epoch 17/50
2013/2013 - 54s - loss: 3.1305 - accuracy1000: 0.4523 - val_loss: 3.3004 - val_accuracy1000: 0.3784 - 54s/epoch - 27ms/step
testing model: results/AAL/W7/deepVOL_L2/h1000
Evaluating performance on  test set...
5331/5331 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1809945
{'0': {'precision': 0.2501946820632926, 'recall': 0.5176344581924984, 'f1-score': 0.3373390821018663, 'support': 329582}, '1': {'precision': 0.5, 'recall': 2.9113861400551417e-06, 'f1-score': 5.8227383756306755e-06, 'support': 686958}, '2': {'precision': 0.2603230309306437, 'recall': 0.5106158027500531, 'f1-score': 0.3448394285143293, 'support': 348066}, 'accuracy': 0.2552626912090376, 'macro avg': {'precision': 0.3368392376646454, 'recall': 0.3427510574428972, 'f1-score': 0.22739477778485706, 'support': 1364606}, 'weighted avg': {'precision': 0.37853289505372945, 'recall': 0.2552626912090376, 'f1-score': 0.16943481844523248, 'support': 1364606}}
[[170603      2 158977]
 [340940      2 346016]
 [170338      0 177728]]
Evaluating performance on  train set...
2013/2013 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1105125
{'0': {'precision': 0.3629166828359657, 'recall': 0.5219390773420844, 'f1-score': 0.428138476610784, 'support': 179178}, '1': {'precision': 1.0, 'recall': 5.974393748394382e-06, 'f1-score': 1.1948716110453932e-05, 'support': 167381}, '2': {'precision': 0.3484692629871012, 'recall': 0.5319786907492015, 'f1-score': 0.42109978563420847, 'support': 168753}, 'accuracy': 0.3556951904865402, 'macro avg': {'precision': 0.5704619819410223, 'recall': 0.3513079141616781, 'f1-score': 0.28308340365370094, 'support': 515312}, 'weighted avg': {'precision': 0.5651196147849166, 'recall': 0.3556951904865402, 'f1-score': 0.2867716025928911, 'support': 515312}}
[[93520     0 85658]
 [85190     1 82190]
 [78980     0 89773]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0825398
{'0': {'precision': 0.3875102230142939, 'recall': 0.4929350020185709, 'f1-score': 0.43391081496668377, 'support': 64402}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 45137}, '2': {'precision': 0.40045413828302395, 'recall': 0.5621582102646586, 'f1-score': 0.46772427552981827, 'support': 68390}, 'accuracy': 0.3944944331727824, 'macro avg': {'precision': 0.26265478709910595, 'recall': 0.3516977374277432, 'f1-score': 0.30054503016550066, 'support': 177929}, 'weighted avg': {'precision': 0.294181903454426, 'recall': 0.3944944331727824, 'f1-score': 0.3368331610303471, 'support': 177929}}
[[31746     0 32656]
 [20233     0 24904]
 [29944     0 38446]]
training model: results/AAL/W7/deepVOL_L3/h10
Epoch 1/50
2013/2013 - 84s - loss: 3.2580 - accuracy10: 0.4452 - val_loss: 2.9706 - val_accuracy10: 0.5375 - 84s/epoch - 42ms/step
Epoch 2/50
2013/2013 - 79s - loss: 2.9621 - accuracy10: 0.3372 - val_loss: 2.7767 - val_accuracy10: 0.4253 - 79s/epoch - 39ms/step
Epoch 3/50
2013/2013 - 79s - loss: 2.8874 - accuracy10: 0.3881 - val_loss: 2.6975 - val_accuracy10: 0.5849 - 79s/epoch - 39ms/step
Epoch 4/50
2013/2013 - 80s - loss: 2.7345 - accuracy10: 0.4604 - val_loss: 2.4268 - val_accuracy10: 0.6029 - 80s/epoch - 40ms/step
Epoch 5/50
2013/2013 - 85s - loss: 2.4499 - accuracy10: 0.5921 - val_loss: 2.3357 - val_accuracy10: 0.6471 - 85s/epoch - 42ms/step
Epoch 6/50
2013/2013 - 85s - loss: 2.3606 - accuracy10: 0.6202 - val_loss: 2.2962 - val_accuracy10: 0.6785 - 85s/epoch - 42ms/step
Epoch 7/50
2013/2013 - 85s - loss: 2.3110 - accuracy10: 0.6314 - val_loss: 2.2626 - val_accuracy10: 0.6793 - 85s/epoch - 42ms/step
Epoch 8/50
2013/2013 - 85s - loss: 2.2845 - accuracy10: 0.6365 - val_loss: 2.2875 - val_accuracy10: 0.6979 - 85s/epoch - 42ms/step
Epoch 9/50
2013/2013 - 79s - loss: 2.2635 - accuracy10: 0.6411 - val_loss: 2.2299 - val_accuracy10: 0.6860 - 79s/epoch - 39ms/step
Epoch 10/50
2013/2013 - 78s - loss: 2.2362 - accuracy10: 0.6452 - val_loss: 2.2159 - val_accuracy10: 0.7014 - 78s/epoch - 39ms/step
Epoch 11/50
2013/2013 - 78s - loss: 2.2182 - accuracy10: 0.6491 - val_loss: 2.2081 - val_accuracy10: 0.7009 - 78s/epoch - 39ms/step
Epoch 12/50
2013/2013 - 78s - loss: 2.1999 - accuracy10: 0.6522 - val_loss: 2.1983 - val_accuracy10: 0.6989 - 78s/epoch - 39ms/step
Epoch 13/50
2013/2013 - 78s - loss: 2.1849 - accuracy10: 0.6554 - val_loss: 2.2080 - val_accuracy10: 0.7201 - 78s/epoch - 39ms/step
Epoch 14/50
2013/2013 - 79s - loss: 2.1749 - accuracy10: 0.6571 - val_loss: 2.1947 - val_accuracy10: 0.7116 - 79s/epoch - 39ms/step
Epoch 15/50
2013/2013 - 78s - loss: 2.1640 - accuracy10: 0.6584 - val_loss: 2.1799 - val_accuracy10: 0.7133 - 78s/epoch - 39ms/step
Epoch 16/50
2013/2013 - 79s - loss: 2.1553 - accuracy10: 0.6600 - val_loss: 2.1632 - val_accuracy10: 0.7092 - 79s/epoch - 39ms/step
Epoch 17/50
2013/2013 - 79s - loss: 2.1425 - accuracy10: 0.6618 - val_loss: 2.1649 - val_accuracy10: 0.7185 - 79s/epoch - 39ms/step
Epoch 18/50
2013/2013 - 78s - loss: 2.1368 - accuracy10: 0.6622 - val_loss: 2.1580 - val_accuracy10: 0.7227 - 78s/epoch - 39ms/step
Epoch 19/50
2013/2013 - 79s - loss: 2.1302 - accuracy10: 0.6634 - val_loss: 2.1337 - val_accuracy10: 0.7211 - 79s/epoch - 39ms/step
Epoch 20/50
2013/2013 - 79s - loss: 2.1220 - accuracy10: 0.6649 - val_loss: 2.1467 - val_accuracy10: 0.7224 - 79s/epoch - 39ms/step
Epoch 21/50
2013/2013 - 79s - loss: 2.1133 - accuracy10: 0.6656 - val_loss: 2.1471 - val_accuracy10: 0.7148 - 79s/epoch - 39ms/step
Epoch 22/50
2013/2013 - 79s - loss: 2.1074 - accuracy10: 0.6657 - val_loss: 2.1610 - val_accuracy10: 0.7288 - 79s/epoch - 39ms/step
Epoch 23/50
2013/2013 - 79s - loss: 2.1036 - accuracy10: 0.6666 - val_loss: 2.1324 - val_accuracy10: 0.7091 - 79s/epoch - 39ms/step
Epoch 24/50
2013/2013 - 78s - loss: 2.0982 - accuracy10: 0.6677 - val_loss: 2.1694 - val_accuracy10: 0.7331 - 78s/epoch - 39ms/step
Epoch 25/50
2013/2013 - 79s - loss: 2.0954 - accuracy10: 0.6676 - val_loss: 2.1551 - val_accuracy10: 0.7203 - 79s/epoch - 39ms/step
Epoch 26/50
2013/2013 - 80s - loss: 2.0886 - accuracy10: 0.6690 - val_loss: 2.1481 - val_accuracy10: 0.7148 - 80s/epoch - 40ms/step
Epoch 27/50
2013/2013 - 79s - loss: 2.0831 - accuracy10: 0.6697 - val_loss: 2.1543 - val_accuracy10: 0.6999 - 79s/epoch - 39ms/step
Epoch 28/50
2013/2013 - 79s - loss: 2.0778 - accuracy10: 0.6705 - val_loss: 2.1373 - val_accuracy10: 0.7094 - 79s/epoch - 39ms/step
Epoch 29/50
2013/2013 - 79s - loss: 2.0743 - accuracy10: 0.6697 - val_loss: 2.1192 - val_accuracy10: 0.7046 - 79s/epoch - 39ms/step
Epoch 30/50
2013/2013 - 79s - loss: 2.0708 - accuracy10: 0.6700 - val_loss: 2.1306 - val_accuracy10: 0.7101 - 79s/epoch - 39ms/step
Epoch 31/50
2013/2013 - 79s - loss: 2.0668 - accuracy10: 0.6709 - val_loss: 2.1420 - val_accuracy10: 0.7212 - 79s/epoch - 39ms/step
Epoch 32/50
2013/2013 - 79s - loss: 2.0655 - accuracy10: 0.6705 - val_loss: 2.1312 - val_accuracy10: 0.7090 - 79s/epoch - 39ms/step
Epoch 33/50
2013/2013 - 79s - loss: 2.0584 - accuracy10: 0.6715 - val_loss: 2.1296 - val_accuracy10: 0.7070 - 79s/epoch - 39ms/step
Epoch 34/50
2013/2013 - 79s - loss: 2.0536 - accuracy10: 0.6722 - val_loss: 2.1251 - val_accuracy10: 0.6983 - 79s/epoch - 39ms/step
Epoch 35/50
2013/2013 - 80s - loss: 2.0509 - accuracy10: 0.6726 - val_loss: 2.1384 - val_accuracy10: 0.7057 - 80s/epoch - 40ms/step
Epoch 36/50
2013/2013 - 80s - loss: 2.0476 - accuracy10: 0.6724 - val_loss: 2.1504 - val_accuracy10: 0.7145 - 80s/epoch - 40ms/step
Epoch 37/50
2013/2013 - 79s - loss: 2.0436 - accuracy10: 0.6727 - val_loss: 2.1392 - val_accuracy10: 0.6966 - 79s/epoch - 39ms/step
Epoch 38/50
2013/2013 - 80s - loss: 2.0400 - accuracy10: 0.6729 - val_loss: 2.1288 - val_accuracy10: 0.6921 - 80s/epoch - 40ms/step
Epoch 39/50
2013/2013 - 82s - loss: 2.0357 - accuracy10: 0.6733 - val_loss: 2.1332 - val_accuracy10: 0.7041 - 82s/epoch - 41ms/step
testing model: results/AAL/W7/deepVOL_L3/h10
Evaluating performance on  test set...
5331/5331 - 99s - 99s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68568456
{'0': {'precision': 0.35210012444891114, 'recall': 0.6145202400855099, 'f1-score': 0.4476890016996488, 'support': 145948}, '1': {'precision': 0.923257792030034, 'recall': 0.7055973250894283, 'f1-score': 0.799884804458745, 'support': 1070690}, '2': {'precision': 0.3573356286285497, 'recall': 0.704226589532872, 'f1-score': 0.4741036309741821, 'support': 147968}, 'accuracy': 0.6957077720602137, 'macro avg': {'precision': 0.5442311817024983, 'recall': 0.6747813849026034, 'f1-score': 0.573892479044192, 'support': 1364606}, 'weighted avg': {'precision': 0.800806557063809, 'recall': 0.6957077720602137, 'f1-score': 0.7268912358394891, 'support': 1364606}}
[[ 89688  30249  26011]
 [153817 755476 161397]
 [ 11218  32547 104203]]
Evaluating performance on  train set...
2013/2013 - 39s - 39s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72139406
{'0': {'precision': 0.3730099687546496, 'recall': 0.5990173678001284, 'f1-score': 0.45973902429240276, 'support': 66963}, '1': {'precision': 0.9051015666719837, 'recall': 0.681807495794456, 'f1-score': 0.7777446700734494, 'support': 382828}, '2': {'precision': 0.3823977754326013, 'recall': 0.6968147616794615, 'f1-score': 0.49380526187707857, 'support': 65521}, 'accuracy': 0.6729573539913684, 'macro avg': {'precision': 0.5535031036197449, 'recall': 0.6592132084246819, 'f1-score': 0.5770963187476436, 'support': 515312}, 'weighted avg': {'precision': 0.7694972633040551, 'recall': 0.6729573539913684, 'f1-score': 0.7003185553645533, 'support': 515312}}
[[ 40112  13358  13493]
 [ 61568 261015  60245]
 [  5856  14009  45656]]
Evaluating performance on  val set...
696/696 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6697907
{'0': {'precision': 0.37797206832871655, 'recall': 0.6097095512939862, 'f1-score': 0.4666547915924475, 'support': 21484}, '1': {'precision': 0.908240493508885, 'recall': 0.7272325147630176, 'f1-score': 0.807719864239129, 'support': 135643}, '2': {'precision': 0.3957822461991172, 'recall': 0.65950389385636, 'f1-score': 0.4946903452627784, 'support': 20802}, 'accuracy': 0.7051239539366826, 'macro avg': {'precision': 0.5606649360122397, 'recall': 0.665481986637788, 'f1-score': 0.5896883336981183, 'support': 177929}, 'weighted avg': {'precision': 0.784300926001011, 'recall': 0.7051239539366826, 'f1-score': 0.7299411880565654, 'support': 177929}}
[[13099  4834  3551]
 [19606 98644 17393]
 [ 1951  5132 13719]]
training model: results/AAL/W7/deepVOL_L3/h20
Epoch 1/50
2013/2013 - 84s - loss: 3.2100 - accuracy20: 0.4155 - val_loss: 2.9692 - val_accuracy20: 0.4922 - 84s/epoch - 42ms/step
Epoch 2/50
2013/2013 - 81s - loss: 3.0032 - accuracy20: 0.3734 - val_loss: 2.8663 - val_accuracy20: 0.4942 - 81s/epoch - 40ms/step
Epoch 3/50
2013/2013 - 82s - loss: 2.8871 - accuracy20: 0.4310 - val_loss: 2.6754 - val_accuracy20: 0.5398 - 82s/epoch - 41ms/step
Epoch 4/50
2013/2013 - 82s - loss: 2.6914 - accuracy20: 0.5405 - val_loss: 2.6096 - val_accuracy20: 0.6164 - 82s/epoch - 41ms/step
Epoch 5/50
2013/2013 - 81s - loss: 2.6098 - accuracy20: 0.5723 - val_loss: 2.5230 - val_accuracy20: 0.6324 - 81s/epoch - 40ms/step
Epoch 6/50
2013/2013 - 82s - loss: 2.5125 - accuracy20: 0.5957 - val_loss: 2.5157 - val_accuracy20: 0.6521 - 82s/epoch - 41ms/step
Epoch 7/50
2013/2013 - 83s - loss: 2.4572 - accuracy20: 0.6057 - val_loss: 2.4828 - val_accuracy20: 0.6519 - 83s/epoch - 41ms/step
Epoch 8/50
2013/2013 - 82s - loss: 2.4262 - accuracy20: 0.6103 - val_loss: 2.4635 - val_accuracy20: 0.6597 - 82s/epoch - 41ms/step
Epoch 9/50
2013/2013 - 81s - loss: 2.3989 - accuracy20: 0.6161 - val_loss: 2.4307 - val_accuracy20: 0.6352 - 81s/epoch - 40ms/step
Epoch 10/50
2013/2013 - 81s - loss: 2.3847 - accuracy20: 0.6179 - val_loss: 2.4375 - val_accuracy20: 0.6775 - 81s/epoch - 40ms/step
Epoch 11/50
2013/2013 - 82s - loss: 2.3644 - accuracy20: 0.6223 - val_loss: 2.4153 - val_accuracy20: 0.6821 - 82s/epoch - 41ms/step
Epoch 12/50
2013/2013 - 81s - loss: 2.3509 - accuracy20: 0.6255 - val_loss: 2.3707 - val_accuracy20: 0.6652 - 81s/epoch - 40ms/step
Epoch 13/50
2013/2013 - 80s - loss: 2.3372 - accuracy20: 0.6281 - val_loss: 2.3651 - val_accuracy20: 0.6693 - 80s/epoch - 40ms/step
Epoch 14/50
2013/2013 - 84s - loss: 2.3262 - accuracy20: 0.6306 - val_loss: 2.3331 - val_accuracy20: 0.6686 - 84s/epoch - 42ms/step
Epoch 15/50
2013/2013 - 81s - loss: 2.3183 - accuracy20: 0.6318 - val_loss: 2.3540 - val_accuracy20: 0.6507 - 81s/epoch - 40ms/step
Epoch 16/50
2013/2013 - 82s - loss: 2.3107 - accuracy20: 0.6339 - val_loss: 2.3363 - val_accuracy20: 0.6716 - 82s/epoch - 41ms/step
Epoch 17/50
2013/2013 - 81s - loss: 2.3022 - accuracy20: 0.6349 - val_loss: 2.3355 - val_accuracy20: 0.6752 - 81s/epoch - 40ms/step
Epoch 18/50
2013/2013 - 81s - loss: 2.2974 - accuracy20: 0.6364 - val_loss: 2.2875 - val_accuracy20: 0.6490 - 81s/epoch - 40ms/step
Epoch 19/50
2013/2013 - 81s - loss: 2.2904 - accuracy20: 0.6378 - val_loss: 2.3022 - val_accuracy20: 0.6789 - 81s/epoch - 40ms/step
Epoch 20/50
2013/2013 - 81s - loss: 2.2843 - accuracy20: 0.6380 - val_loss: 2.2951 - val_accuracy20: 0.6723 - 81s/epoch - 40ms/step
Epoch 21/50
2013/2013 - 81s - loss: 2.2807 - accuracy20: 0.6384 - val_loss: 2.2959 - val_accuracy20: 0.6753 - 81s/epoch - 40ms/step
Epoch 22/50
2013/2013 - 82s - loss: 2.2733 - accuracy20: 0.6397 - val_loss: 2.2891 - val_accuracy20: 0.6661 - 82s/epoch - 41ms/step
Epoch 23/50
2013/2013 - 81s - loss: 2.2704 - accuracy20: 0.6405 - val_loss: 2.2829 - val_accuracy20: 0.6691 - 81s/epoch - 40ms/step
Epoch 24/50
2013/2013 - 82s - loss: 2.2727 - accuracy20: 0.6399 - val_loss: 2.2888 - val_accuracy20: 0.6775 - 82s/epoch - 41ms/step
Epoch 25/50
2013/2013 - 81s - loss: 2.2625 - accuracy20: 0.6415 - val_loss: 2.2871 - val_accuracy20: 0.6810 - 81s/epoch - 40ms/step
Epoch 26/50
2013/2013 - 81s - loss: 2.2579 - accuracy20: 0.6417 - val_loss: 2.2874 - val_accuracy20: 0.6739 - 81s/epoch - 40ms/step
Epoch 27/50
2013/2013 - 81s - loss: 2.2538 - accuracy20: 0.6419 - val_loss: 2.2941 - val_accuracy20: 0.6723 - 81s/epoch - 40ms/step
Epoch 28/50
2013/2013 - 80s - loss: 2.2494 - accuracy20: 0.6426 - val_loss: 2.3083 - val_accuracy20: 0.6812 - 80s/epoch - 40ms/step
Epoch 29/50
2013/2013 - 81s - loss: 2.2470 - accuracy20: 0.6436 - val_loss: 2.2787 - val_accuracy20: 0.6669 - 81s/epoch - 40ms/step
Epoch 30/50
2013/2013 - 80s - loss: 2.2447 - accuracy20: 0.6433 - val_loss: 2.2759 - val_accuracy20: 0.6407 - 80s/epoch - 40ms/step
Epoch 31/50
2013/2013 - 83s - loss: 2.2413 - accuracy20: 0.6439 - val_loss: 2.2862 - val_accuracy20: 0.6706 - 83s/epoch - 41ms/step
Epoch 32/50
2013/2013 - 82s - loss: 2.2362 - accuracy20: 0.6442 - val_loss: 2.2808 - val_accuracy20: 0.6642 - 82s/epoch - 41ms/step
Epoch 33/50
2013/2013 - 82s - loss: 2.2334 - accuracy20: 0.6445 - val_loss: 2.2737 - val_accuracy20: 0.6617 - 82s/epoch - 41ms/step
Epoch 34/50
2013/2013 - 82s - loss: 2.2293 - accuracy20: 0.6447 - val_loss: 2.2827 - val_accuracy20: 0.6585 - 82s/epoch - 41ms/step
Epoch 35/50
2013/2013 - 81s - loss: 2.2281 - accuracy20: 0.6449 - val_loss: 2.2780 - val_accuracy20: 0.6663 - 81s/epoch - 40ms/step
Epoch 36/50
2013/2013 - 81s - loss: 2.2245 - accuracy20: 0.6459 - val_loss: 2.3017 - val_accuracy20: 0.6624 - 81s/epoch - 40ms/step
Epoch 37/50
2013/2013 - 81s - loss: 2.2218 - accuracy20: 0.6454 - val_loss: 2.2827 - val_accuracy20: 0.6594 - 81s/epoch - 40ms/step
Epoch 38/50
2013/2013 - 80s - loss: 2.2202 - accuracy20: 0.6456 - val_loss: 2.2816 - val_accuracy20: 0.6530 - 80s/epoch - 40ms/step
Epoch 39/50
2013/2013 - 80s - loss: 2.2150 - accuracy20: 0.6468 - val_loss: 2.2890 - val_accuracy20: 0.6523 - 80s/epoch - 40ms/step
Epoch 40/50
2013/2013 - 81s - loss: 2.2128 - accuracy20: 0.6469 - val_loss: 2.2904 - val_accuracy20: 0.6491 - 81s/epoch - 40ms/step
Epoch 41/50
2013/2013 - 80s - loss: 2.2089 - accuracy20: 0.6469 - val_loss: 2.2938 - val_accuracy20: 0.6399 - 80s/epoch - 40ms/step
Epoch 42/50
2013/2013 - 79s - loss: 2.2084 - accuracy20: 0.6472 - val_loss: 2.2865 - val_accuracy20: 0.6450 - 79s/epoch - 39ms/step
Epoch 43/50
2013/2013 - 81s - loss: 2.2045 - accuracy20: 0.6472 - val_loss: 2.3168 - val_accuracy20: 0.6295 - 81s/epoch - 40ms/step
testing model: results/AAL/W7/deepVOL_L3/h20
Evaluating performance on  test set...
5331/5331 - 101s - 101s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7747187
{'0': {'precision': 0.39201231888272875, 'recall': 0.6466554221248144, 'f1-score': 0.48811931195501973, 'support': 198022}, '1': {'precision': 0.8814394009786417, 'recall': 0.6383034007140764, 'f1-score': 0.7404223484939455, 'support': 966003}, '2': {'precision': 0.39024620876328264, 'recall': 0.6584073267158903, 'f1-score': 0.490039759328971, 'support': 200581}, 'accuracy': 0.6424704273614509, 'macro avg': {'precision': 0.5545659762082177, 'recall': 0.6477887165182604, 'f1-score': 0.572860473259312, 'support': 1364606}, 'weighted avg': {'precision': 0.7382175835906588, 'recall': 0.6424704273614509, 'f1-score': 0.6670066211566695, 'support': 1364606}}
[[128052  38628  31342]
 [174394 616603 175006]
 [ 24207  44310 132064]]
Evaluating performance on  train set...
2013/2013 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7871809
{'0': {'precision': 0.4191516680215464, 'recall': 0.6238127544097694, 'f1-score': 0.5014018712823146, 'support': 88440}, '1': {'precision': 0.8549559410657616, 'recall': 0.6381871886434775, 'f1-score': 0.7308367397424873, 'support': 340245}, '2': {'precision': 0.42850644895190076, 'recall': 0.641624435799462, 'f1-score': 0.5138440773234475, 'support': 86627}, 'accuracy': 0.6362980097494334, 'macro avg': {'precision': 0.5675380193464029, 'recall': 0.6345414596175697, 'f1-score': 0.5820275627827498, 'support': 515312}, 'weighted avg': {'precision': 0.7084727036069446, 'recall': 0.6362980097494334, 'f1-score': 0.6549824162763311, 'support': 515312}}
[[ 55170  17338  15932]
 [ 64908 217140  58197]
 [ 11545  19500  55582]]
Evaluating performance on  val set...
696/696 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74913245
{'0': {'precision': 0.4165554390313662, 'recall': 0.6128410126937373, 'f1-score': 0.4959843346482391, 'support': 28518}, '1': {'precision': 0.8546146585686146, 'recall': 0.6857912025488404, 'f1-score': 0.7609516806051, 'support': 121467}, '2': {'precision': 0.4383262772395522, 'recall': 0.6039221299742342, 'f1-score': 0.5079689969147415, 'support': 27944}, 'accuracy': 0.6612412816348094, 'macro avg': {'precision': 0.569832124946511, 'recall': 0.6341847817389373, 'f1-score': 0.5883016707226935, 'support': 177929}, 'weighted avg': {'precision': 0.7190249831889824, 'recall': 0.6612412816348094, 'f1-score': 0.6787521128840363, 'support': 177929}}
[[17477  6712  4329]
 [20870 83301 17296]
 [ 3609  7459 16876]]
training model: results/AAL/W7/deepVOL_L3/h30
Epoch 1/50
2013/2013 - 83s - loss: 3.2285 - accuracy30: 0.4149 - val_loss: 2.9983 - val_accuracy30: 0.3546 - 83s/epoch - 41ms/step
Epoch 2/50
2013/2013 - 80s - loss: 3.0553 - accuracy30: 0.3553 - val_loss: 2.9764 - val_accuracy30: 0.4803 - 80s/epoch - 40ms/step
Epoch 3/50
2013/2013 - 81s - loss: 2.9631 - accuracy30: 0.4087 - val_loss: 2.8218 - val_accuracy30: 0.4683 - 81s/epoch - 40ms/step
Epoch 4/50
2013/2013 - 80s - loss: 2.8161 - accuracy30: 0.5095 - val_loss: 2.7185 - val_accuracy30: 0.5697 - 80s/epoch - 40ms/step
Epoch 5/50
2013/2013 - 81s - loss: 2.6961 - accuracy30: 0.5560 - val_loss: 2.6733 - val_accuracy30: 0.5965 - 81s/epoch - 40ms/step
Epoch 6/50
2013/2013 - 81s - loss: 2.6429 - accuracy30: 0.5704 - val_loss: 2.6318 - val_accuracy30: 0.6074 - 81s/epoch - 40ms/step
Epoch 7/50
2013/2013 - 80s - loss: 2.5997 - accuracy30: 0.5800 - val_loss: 2.6205 - val_accuracy30: 0.6228 - 80s/epoch - 40ms/step
Epoch 8/50
2013/2013 - 81s - loss: 2.5647 - accuracy30: 0.5863 - val_loss: 2.5848 - val_accuracy30: 0.6323 - 81s/epoch - 40ms/step
Epoch 9/50
2013/2013 - 79s - loss: 2.5345 - accuracy30: 0.5927 - val_loss: 2.5526 - val_accuracy30: 0.6404 - 79s/epoch - 39ms/step
Epoch 10/50
2013/2013 - 80s - loss: 2.5067 - accuracy30: 0.5980 - val_loss: 2.5531 - val_accuracy30: 0.6299 - 80s/epoch - 40ms/step
Epoch 11/50
2013/2013 - 85s - loss: 2.4892 - accuracy30: 0.6002 - val_loss: 2.5304 - val_accuracy30: 0.6230 - 85s/epoch - 42ms/step
Epoch 12/50
2013/2013 - 80s - loss: 2.4760 - accuracy30: 0.6028 - val_loss: 2.5350 - val_accuracy30: 0.6235 - 80s/epoch - 40ms/step
Epoch 13/50
2013/2013 - 81s - loss: 2.4645 - accuracy30: 0.6056 - val_loss: 2.4945 - val_accuracy30: 0.6169 - 81s/epoch - 40ms/step
Epoch 14/50
2013/2013 - 81s - loss: 2.4549 - accuracy30: 0.6065 - val_loss: 2.5009 - val_accuracy30: 0.6019 - 81s/epoch - 40ms/step
Epoch 15/50
2013/2013 - 79s - loss: 2.4462 - accuracy30: 0.6079 - val_loss: 2.4976 - val_accuracy30: 0.6168 - 79s/epoch - 39ms/step
Epoch 16/50
2013/2013 - 81s - loss: 2.4389 - accuracy30: 0.6097 - val_loss: 2.4751 - val_accuracy30: 0.6161 - 81s/epoch - 40ms/step
Epoch 17/50
2013/2013 - 80s - loss: 2.4320 - accuracy30: 0.6105 - val_loss: 2.4829 - val_accuracy30: 0.6020 - 80s/epoch - 40ms/step
Epoch 18/50
2013/2013 - 81s - loss: 2.4254 - accuracy30: 0.6121 - val_loss: 2.4679 - val_accuracy30: 0.6267 - 81s/epoch - 40ms/step
Epoch 19/50
2013/2013 - 81s - loss: 2.4207 - accuracy30: 0.6126 - val_loss: 2.4789 - val_accuracy30: 0.6051 - 81s/epoch - 40ms/step
Epoch 20/50
2013/2013 - 82s - loss: 2.4119 - accuracy30: 0.6137 - val_loss: 2.4976 - val_accuracy30: 0.5979 - 82s/epoch - 41ms/step
Epoch 21/50
2013/2013 - 81s - loss: 2.4095 - accuracy30: 0.6144 - val_loss: 2.4949 - val_accuracy30: 0.6312 - 81s/epoch - 40ms/step
Epoch 22/50
2013/2013 - 82s - loss: 2.4038 - accuracy30: 0.6154 - val_loss: 2.4704 - val_accuracy30: 0.6111 - 82s/epoch - 41ms/step
Epoch 23/50
2013/2013 - 82s - loss: 2.3999 - accuracy30: 0.6159 - val_loss: 2.4692 - val_accuracy30: 0.6078 - 82s/epoch - 41ms/step
Epoch 24/50
2013/2013 - 82s - loss: 2.3949 - accuracy30: 0.6166 - val_loss: 2.4717 - val_accuracy30: 0.6057 - 82s/epoch - 41ms/step
Epoch 25/50
2013/2013 - 82s - loss: 2.3926 - accuracy30: 0.6169 - val_loss: 2.4642 - val_accuracy30: 0.6127 - 82s/epoch - 41ms/step
Epoch 26/50
2013/2013 - 83s - loss: 2.3869 - accuracy30: 0.6186 - val_loss: 2.4634 - val_accuracy30: 0.5979 - 83s/epoch - 41ms/step
Epoch 27/50
2013/2013 - 82s - loss: 2.3821 - accuracy30: 0.6184 - val_loss: 2.4716 - val_accuracy30: 0.6061 - 82s/epoch - 41ms/step
Epoch 28/50
2013/2013 - 81s - loss: 2.3802 - accuracy30: 0.6185 - val_loss: 2.4748 - val_accuracy30: 0.5964 - 81s/epoch - 40ms/step
Epoch 29/50
2013/2013 - 82s - loss: 2.3755 - accuracy30: 0.6193 - val_loss: 2.4746 - val_accuracy30: 0.5967 - 82s/epoch - 41ms/step
Epoch 30/50
2013/2013 - 82s - loss: 2.3714 - accuracy30: 0.6191 - val_loss: 2.4733 - val_accuracy30: 0.6092 - 82s/epoch - 41ms/step
Epoch 31/50
2013/2013 - 81s - loss: 2.3702 - accuracy30: 0.6192 - val_loss: 2.4688 - val_accuracy30: 0.6141 - 81s/epoch - 40ms/step
Epoch 32/50
2013/2013 - 82s - loss: 2.3662 - accuracy30: 0.6210 - val_loss: 2.4728 - val_accuracy30: 0.5965 - 82s/epoch - 41ms/step
Epoch 33/50
2013/2013 - 82s - loss: 2.3623 - accuracy30: 0.6212 - val_loss: 2.4786 - val_accuracy30: 0.5946 - 82s/epoch - 41ms/step
Epoch 34/50
2013/2013 - 81s - loss: 2.3587 - accuracy30: 0.6213 - val_loss: 2.4755 - val_accuracy30: 0.5862 - 81s/epoch - 40ms/step
Epoch 35/50
2013/2013 - 82s - loss: 2.3563 - accuracy30: 0.6223 - val_loss: 2.4715 - val_accuracy30: 0.5911 - 82s/epoch - 41ms/step
Epoch 36/50
2013/2013 - 82s - loss: 2.3526 - accuracy30: 0.6226 - val_loss: 2.4759 - val_accuracy30: 0.5858 - 82s/epoch - 41ms/step
testing model: results/AAL/W7/deepVOL_L3/h30
Evaluating performance on  test set...
5331/5331 - 100s - 100s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8474265
{'0': {'precision': 0.3927589824921982, 'recall': 0.6112909251959414, 'f1-score': 0.4782431629110711, 'support': 238209}, '1': {'precision': 0.8402717950143123, 'recall': 0.5467756975015965, 'f1-score': 0.6624721926089341, 'support': 884765}, '2': {'precision': 0.38737088314850204, 'recall': 0.6703209839756323, 'f1-score': 0.49099901327905104, 'support': 241632}, 'accuracy': 0.5799139092162866, 'macro avg': {'precision': 0.5401338868850042, 'recall': 0.6094625355577233, 'f1-score': 0.5439047895996855, 'support': 1364606}, 'weighted avg': {'precision': 0.6819572832108761, 'recall': 0.5799139092162866, 'f1-score': 0.5999498087097452, 'support': 1364606}}
[[145615  43594  49000]
 [193839 483768 207158]
 [ 31295  48366 161971]]
Evaluating performance on  train set...
2013/2013 - 38s - 38s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85524786
{'0': {'precision': 0.4251819689177416, 'recall': 0.5767753495420451, 'f1-score': 0.4895108289013367, 'support': 104923}, '1': {'precision': 0.8034699555509369, 'recall': 0.5529919309219296, 'f1-score': 0.655104882177251, 'support': 307594}, '2': {'precision': 0.41907401551368145, 'recall': 0.6574930687290238, 'f1-score': 0.511883122784695, 'support': 102795}, 'accuracy': 0.5786804887136336, 'macro avg': {'precision': 0.54924197999412, 'recall': 0.5957534497309994, 'f1-score': 0.5521662779544276, 'support': 515312}, 'weighted avg': {'precision': 0.6497667794602493, 'recall': 0.5786804887136336, 'f1-score': 0.5928181401479047, 'support': 515312}}
[[ 60517  20356  24050]
 [ 67857 170097  69640]
 [ 13958  21250  67587]]
Evaluating performance on  val set...
696/696 - 15s - 15s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83048445
{'0': {'precision': 0.41239758338161053, 'recall': 0.5845504135139891, 'f1-score': 0.48361033604270287, 'support': 34098}, '1': {'precision': 0.8019786298232148, 'recall': 0.5967183392258182, 'f1-score': 0.6842873998762911, 'support': 110310}, '2': {'precision': 0.42954545454545456, 'recall': 0.6089317144476597, 'f1-score': 0.5037450179538753, 'support': 33521}, 'accuracy': 0.5966874427440159, 'macro avg': {'precision': 0.5479738892500933, 'recall': 0.596733489062489, 'f1-score': 0.5572142512909565, 'support': 177929}, 'weighted avg': {'precision': 0.6571553183335104, 'recall': 0.5966874427440159, 'f1-score': 0.6118166519542605, 'support': 177929}}
[[19932  7819  6347]
 [23725 65824 20761]
 [ 4675  8434 20412]]
training model: results/AAL/W7/deepVOL_L3/h50
Epoch 1/50
2013/2013 - 85s - loss: 3.2624 - accuracy50: 0.4074 - val_loss: 3.1385 - val_accuracy50: 0.3206 - 85s/epoch - 42ms/step
Epoch 2/50
2013/2013 - 83s - loss: 3.1318 - accuracy50: 0.3882 - val_loss: 3.0721 - val_accuracy50: 0.4322 - 83s/epoch - 41ms/step
Epoch 3/50
2013/2013 - 83s - loss: 3.0829 - accuracy50: 0.4126 - val_loss: 3.0428 - val_accuracy50: 0.4503 - 83s/epoch - 41ms/step
Epoch 4/50
2013/2013 - 82s - loss: 2.9877 - accuracy50: 0.4754 - val_loss: 2.9346 - val_accuracy50: 0.5324 - 82s/epoch - 41ms/step
Epoch 5/50
2013/2013 - 81s - loss: 2.8868 - accuracy50: 0.5160 - val_loss: 2.8894 - val_accuracy50: 0.5239 - 81s/epoch - 40ms/step
Epoch 6/50
2013/2013 - 82s - loss: 2.8169 - accuracy50: 0.5395 - val_loss: 2.8542 - val_accuracy50: 0.5544 - 82s/epoch - 41ms/step
Epoch 7/50
2013/2013 - 81s - loss: 2.7738 - accuracy50: 0.5511 - val_loss: 2.8312 - val_accuracy50: 0.5758 - 81s/epoch - 40ms/step
Epoch 8/50
2013/2013 - 81s - loss: 2.7539 - accuracy50: 0.5552 - val_loss: 2.7903 - val_accuracy50: 0.5635 - 81s/epoch - 40ms/step
Epoch 9/50
2013/2013 - 82s - loss: 2.7356 - accuracy50: 0.5582 - val_loss: 2.8026 - val_accuracy50: 0.5638 - 82s/epoch - 41ms/step
Epoch 10/50
2013/2013 - 81s - loss: 2.7212 - accuracy50: 0.5624 - val_loss: 2.7835 - val_accuracy50: 0.5603 - 81s/epoch - 40ms/step
Epoch 11/50
2013/2013 - 83s - loss: 2.7074 - accuracy50: 0.5648 - val_loss: 2.7698 - val_accuracy50: 0.5598 - 83s/epoch - 41ms/step
Epoch 12/50
2013/2013 - 82s - loss: 2.6957 - accuracy50: 0.5666 - val_loss: 2.7667 - val_accuracy50: 0.5648 - 82s/epoch - 41ms/step
Epoch 13/50
2013/2013 - 80s - loss: 2.6851 - accuracy50: 0.5674 - val_loss: 2.7446 - val_accuracy50: 0.5585 - 80s/epoch - 40ms/step
Epoch 14/50
2013/2013 - 81s - loss: 2.6723 - accuracy50: 0.5687 - val_loss: 2.7477 - val_accuracy50: 0.5612 - 81s/epoch - 40ms/step
Epoch 15/50
2013/2013 - 81s - loss: 2.6656 - accuracy50: 0.5698 - val_loss: 2.7350 - val_accuracy50: 0.5622 - 81s/epoch - 40ms/step
Epoch 16/50
2013/2013 - 81s - loss: 2.6586 - accuracy50: 0.5706 - val_loss: 2.7394 - val_accuracy50: 0.5629 - 81s/epoch - 40ms/step
Epoch 17/50
2013/2013 - 83s - loss: 2.6505 - accuracy50: 0.5722 - val_loss: 2.7347 - val_accuracy50: 0.5509 - 83s/epoch - 41ms/step
Epoch 18/50
2013/2013 - 83s - loss: 2.6478 - accuracy50: 0.5718 - val_loss: 2.7315 - val_accuracy50: 0.5354 - 83s/epoch - 41ms/step
Epoch 19/50
2013/2013 - 83s - loss: 2.6418 - accuracy50: 0.5729 - val_loss: 2.7294 - val_accuracy50: 0.5366 - 83s/epoch - 41ms/step
Epoch 20/50
2013/2013 - 81s - loss: 2.6363 - accuracy50: 0.5749 - val_loss: 2.7318 - val_accuracy50: 0.5445 - 81s/epoch - 40ms/step
Epoch 21/50
2013/2013 - 81s - loss: 2.6303 - accuracy50: 0.5752 - val_loss: 2.7596 - val_accuracy50: 0.5327 - 81s/epoch - 40ms/step
Epoch 22/50
2013/2013 - 83s - loss: 2.6272 - accuracy50: 0.5751 - val_loss: 2.7650 - val_accuracy50: 0.5357 - 83s/epoch - 41ms/step
Epoch 23/50
2013/2013 - 81s - loss: 2.6216 - accuracy50: 0.5766 - val_loss: 2.7395 - val_accuracy50: 0.5382 - 81s/epoch - 40ms/step
Epoch 24/50
2013/2013 - 82s - loss: 2.6170 - accuracy50: 0.5777 - val_loss: 2.7626 - val_accuracy50: 0.5331 - 82s/epoch - 41ms/step
Epoch 25/50
2013/2013 - 83s - loss: 2.6128 - accuracy50: 0.5785 - val_loss: 2.7724 - val_accuracy50: 0.5262 - 83s/epoch - 41ms/step
Epoch 26/50
2013/2013 - 83s - loss: 2.6099 - accuracy50: 0.5794 - val_loss: 2.7463 - val_accuracy50: 0.5350 - 83s/epoch - 41ms/step
Epoch 27/50
2013/2013 - 83s - loss: 2.6050 - accuracy50: 0.5803 - val_loss: 2.7627 - val_accuracy50: 0.5221 - 83s/epoch - 41ms/step
Epoch 28/50
2013/2013 - 81s - loss: 2.7309 - accuracy50: 0.5449 - val_loss: 3.2566 - val_accuracy50: 0.4780 - 81s/epoch - 40ms/step
Epoch 29/50
2013/2013 - 81s - loss: 3.1102 - accuracy50: 0.4121 - val_loss: 3.0954 - val_accuracy50: 0.4531 - 81s/epoch - 40ms/step
testing model: results/AAL/W7/deepVOL_L3/h50
Evaluating performance on  test set...
5331/5331 - 100s - 100s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9548723
{'0': {'precision': 0.38257620399118225, 'recall': 0.6609699352775654, 'f1-score': 0.4846385977106579, 'support': 299587}, '1': {'precision': 0.7550602348630272, 'recall': 0.43120522628389657, 'f1-score': 0.5489259024995901, 'support': 760770}, '2': {'precision': 0.40430348879769434, 'recall': 0.5482187287386319, 'f1-score': 0.4653891333402158, 'support': 304249}, 'accuracy': 0.50773703178793, 'macro avg': {'precision': 0.5139799758839679, 'recall': 0.5467979634333647, 'f1-score': 0.49965121118348793, 'support': 1364606}, 'weighted avg': {'precision': 0.5950808982703149, 'recall': 0.50773703178793, 'f1-score': 0.5161870612078383, 'support': 1364606}}
[[198018  46627  54942]
 [241910 328048 190812]
 [ 77663  59791 166795]]
Evaluating performance on  train set...
2013/2013 - 38s - 38s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9552382
{'0': {'precision': 0.4172773706417944, 'recall': 0.6638148193659376, 'f1-score': 0.5124353038127027, 'support': 130208}, '1': {'precision': 0.7112722395161086, 'recall': 0.43622239123348905, 'f1-score': 0.5407831441216085, 'support': 257708}, '2': {'precision': 0.4399488416088248, 'recall': 0.5184307199598104, 'f1-score': 0.47597633306668397, 'support': 127396}, 'accuracy': 0.5140536218834415, 'macro avg': {'precision': 0.522832817255576, 'recall': 0.5394893101864123, 'f1-score': 0.5097315936669984, 'support': 515312}, 'weighted avg': {'precision': 0.56990933803859, 'recall': 0.5140536218834415, 'f1-score': 0.5175986576510914, 'support': 515312}}
[[ 86434  20302  23472]
 [ 84686 112418  60604]
 [ 36018  25332  66046]]
Evaluating performance on  val set...
696/696 - 15s - 15s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9287015
{'0': {'precision': 0.4188175223388026, 'recall': 0.6279818869333831, 'f1-score': 0.5025028016436309, 'support': 42842}, '1': {'precision': 0.6971642745075252, 'recall': 0.5160437008043357, 'f1-score': 0.5930841860695042, 'support': 92996}, '2': {'precision': 0.45847731579534057, 'recall': 0.48858425791736954, 'f1-score': 0.47305223932095786, 'support': 42091}, 'accuracy': 0.5365005142500661, 'macro avg': {'precision': 0.5248197042138895, 'recall': 0.5442032818850294, 'f1-score': 0.5228797423446977, 'support': 177929}, 'weighted avg': {'precision': 0.5736796017697086, 'recall': 0.5365005142500661, 'f1-score': 0.5428790349015309, 'support': 177929}}
[[26904  9387  6551]
 [27267 47990 17739]
 [10067 11459 20565]]
training model: results/AAL/W7/deepVOL_L3/h100
Epoch 1/50
2013/2013 - 85s - loss: 3.2806 - accuracy100: 0.3802 - val_loss: 3.2912 - val_accuracy100: 0.3702 - 85s/epoch - 42ms/step
Epoch 2/50
2013/2013 - 82s - loss: 3.2577 - accuracy100: 0.3854 - val_loss: 3.2771 - val_accuracy100: 0.3658 - 82s/epoch - 41ms/step
Epoch 3/50
2013/2013 - 84s - loss: 3.1852 - accuracy100: 0.4211 - val_loss: 3.1966 - val_accuracy100: 0.4132 - 84s/epoch - 42ms/step
Epoch 4/50
2013/2013 - 83s - loss: 3.1168 - accuracy100: 0.4476 - val_loss: 3.1612 - val_accuracy100: 0.4322 - 83s/epoch - 41ms/step
Epoch 5/50
2013/2013 - 82s - loss: 3.0773 - accuracy100: 0.4629 - val_loss: 3.1469 - val_accuracy100: 0.4311 - 82s/epoch - 41ms/step
Epoch 6/50
2013/2013 - 81s - loss: 3.0382 - accuracy100: 0.4750 - val_loss: 3.0885 - val_accuracy100: 0.4561 - 81s/epoch - 40ms/step
Epoch 7/50
2013/2013 - 83s - loss: 3.0013 - accuracy100: 0.4836 - val_loss: 3.0582 - val_accuracy100: 0.4662 - 83s/epoch - 41ms/step
Epoch 8/50
2013/2013 - 82s - loss: 2.9777 - accuracy100: 0.4894 - val_loss: 3.0603 - val_accuracy100: 0.4633 - 82s/epoch - 41ms/step
Epoch 9/50
2013/2013 - 81s - loss: 2.9619 - accuracy100: 0.4917 - val_loss: 3.0627 - val_accuracy100: 0.4587 - 81s/epoch - 40ms/step
Epoch 10/50
2013/2013 - 82s - loss: 2.9514 - accuracy100: 0.4951 - val_loss: 3.0592 - val_accuracy100: 0.4567 - 82s/epoch - 41ms/step
Epoch 11/50
2013/2013 - 82s - loss: 2.9464 - accuracy100: 0.4963 - val_loss: 3.0564 - val_accuracy100: 0.4612 - 82s/epoch - 41ms/step
Epoch 12/50
2013/2013 - 82s - loss: 2.9397 - accuracy100: 0.4980 - val_loss: 3.0523 - val_accuracy100: 0.4624 - 82s/epoch - 41ms/step
Epoch 13/50
2013/2013 - 81s - loss: 2.9338 - accuracy100: 0.4997 - val_loss: 3.0644 - val_accuracy100: 0.4604 - 81s/epoch - 40ms/step
Epoch 14/50
2013/2013 - 81s - loss: 2.9278 - accuracy100: 0.5014 - val_loss: 3.0759 - val_accuracy100: 0.4592 - 81s/epoch - 40ms/step
Epoch 15/50
2013/2013 - 82s - loss: 2.9229 - accuracy100: 0.5024 - val_loss: 3.0666 - val_accuracy100: 0.4614 - 82s/epoch - 41ms/step
Epoch 16/50
2013/2013 - 81s - loss: 2.9190 - accuracy100: 0.5034 - val_loss: 3.0786 - val_accuracy100: 0.4597 - 81s/epoch - 40ms/step
Epoch 17/50
2013/2013 - 81s - loss: 2.9135 - accuracy100: 0.5047 - val_loss: 3.0931 - val_accuracy100: 0.4523 - 81s/epoch - 40ms/step
Epoch 18/50
2013/2013 - 80s - loss: 2.9094 - accuracy100: 0.5071 - val_loss: 3.0944 - val_accuracy100: 0.4538 - 80s/epoch - 40ms/step
Epoch 19/50
2013/2013 - 81s - loss: 2.9041 - accuracy100: 0.5077 - val_loss: 3.0895 - val_accuracy100: 0.4600 - 81s/epoch - 40ms/step
Epoch 20/50
2013/2013 - 80s - loss: 2.9004 - accuracy100: 0.5081 - val_loss: 3.1161 - val_accuracy100: 0.4554 - 80s/epoch - 40ms/step
Epoch 21/50
2013/2013 - 81s - loss: 2.8964 - accuracy100: 0.5098 - val_loss: 3.0996 - val_accuracy100: 0.4582 - 81s/epoch - 40ms/step
Epoch 22/50
2013/2013 - 80s - loss: 2.8917 - accuracy100: 0.5108 - val_loss: 3.0871 - val_accuracy100: 0.4595 - 80s/epoch - 40ms/step
testing model: results/AAL/W7/deepVOL_L3/h100
Evaluating performance on  test set...
5331/5331 - 101s - 101s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0280738
{'0': {'precision': 0.38148696913005503, 'recall': 0.685533353190277, 'f1-score': 0.49019130315609927, 'support': 386095}, '1': {'precision': 0.5788514922290058, 'recall': 0.4097617121562202, 'f1-score': 0.47984626846540834, 'support': 584713}, '2': {'precision': 0.43420883599799126, 'recall': 0.28324166196882666, 'f1-score': 0.34284186211634304, 'support': 393798}, 'accuracy': 0.4512760459795721, 'macro avg': {'precision': 0.46484909911901734, 'recall': 0.4595122424384413, 'f1-score': 0.4376264779126169, 'support': 1364606}, 'weighted avg': {'precision': 0.4812691539684746, 'recall': 0.4512760459795721, 'f1-score': 0.4432365107459297, 'support': 1364606}}
[[264681  73834  47580]
 [247359 239593  97761]
 [181774 100484 111540]]
Evaluating performance on  train set...
2013/2013 - 38s - 38s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0195895
{'0': {'precision': 0.4250473460038476, 'recall': 0.6846585599652742, 'f1-score': 0.5244854555908861, 'support': 165871}, '1': {'precision': 0.5058800017486994, 'recall': 0.43185332096435386, 'f1-score': 0.4659447488387477, 'support': 187566}, '2': {'precision': 0.4846098783106657, 'recall': 0.2634810810810811, 'f1-score': 0.34136366182979433, 'support': 161875}, 'accuracy': 0.46033665041761107, 'macro avg': {'precision': 0.4718457420210709, 'recall': 0.45999765400356973, 'f1-score': 0.44393128875314275, 'support': 515312}, 'weighted avg': {'precision': 0.47317962862991697, 'recall': 0.46033665041761107, 'f1-score': 0.4456534342761325, 'support': 515312}}
[[113565  33454  18852]
 [ 80057  81001  26508]
 [ 73560  45664  42651]]
Evaluating performance on  val set...
696/696 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0179408
{'0': {'precision': 0.4170052130145605, 'recall': 0.6341023398206866, 'f1-score': 0.5031340143579066, 'support': 54876}, '1': {'precision': 0.5045159573681799, 'recall': 0.49574412456787614, 'f1-score': 0.500091578446097, 'support': 68846}, '2': {'precision': 0.49931060182597353, 'recall': 0.24718209825299314, 'f1-score': 0.3306680486661237, 'support': 54207}, 'accuracy': 0.46269017417059616, 'macro avg': {'precision': 0.473610590736238, 'recall': 0.45900952088051866, 'f1-score': 0.44463121382337584, 'support': 177929}, 'weighted avg': {'precision': 0.4759404788625648, 'recall': 0.46269017417059616, 'f1-score': 0.44941414775359295, 'support': 177929}}
[[34797 14588  5491]
 [26771 34130  7945]
 [21877 18931 13399]]
training model: results/AAL/W7/deepVOL_L3/h200
Epoch 1/50
2013/2013 - 84s - loss: 3.2970 - accuracy200: 0.3593 - val_loss: 3.2998 - val_accuracy200: 0.3363 - 84s/epoch - 42ms/step
Epoch 2/50
2013/2013 - 82s - loss: 3.2918 - accuracy200: 0.3554 - val_loss: 3.3021 - val_accuracy200: 0.3418 - 82s/epoch - 41ms/step
Epoch 3/50
2013/2013 - 82s - loss: 3.2786 - accuracy200: 0.3695 - val_loss: 3.2840 - val_accuracy200: 0.3721 - 82s/epoch - 41ms/step
Epoch 4/50
2013/2013 - 81s - loss: 3.2640 - accuracy200: 0.3826 - val_loss: 3.2823 - val_accuracy200: 0.3706 - 81s/epoch - 40ms/step
Epoch 5/50
2013/2013 - 82s - loss: 3.2520 - accuracy200: 0.3901 - val_loss: 3.2951 - val_accuracy200: 0.3748 - 82s/epoch - 41ms/step
Epoch 6/50
2013/2013 - 82s - loss: 3.2299 - accuracy200: 0.4033 - val_loss: 3.2975 - val_accuracy200: 0.3658 - 82s/epoch - 41ms/step
Epoch 7/50
2013/2013 - 81s - loss: 3.2177 - accuracy200: 0.4087 - val_loss: 3.2786 - val_accuracy200: 0.3721 - 81s/epoch - 40ms/step
Epoch 8/50
2013/2013 - 82s - loss: 3.2081 - accuracy200: 0.4110 - val_loss: 3.3005 - val_accuracy200: 0.3727 - 82s/epoch - 41ms/step
Epoch 9/50
2013/2013 - 82s - loss: 3.2007 - accuracy200: 0.4143 - val_loss: 3.2905 - val_accuracy200: 0.3797 - 82s/epoch - 41ms/step
Epoch 10/50
2013/2013 - 82s - loss: 3.1912 - accuracy200: 0.4179 - val_loss: 3.2791 - val_accuracy200: 0.3877 - 82s/epoch - 40ms/step
Epoch 11/50
2013/2013 - 81s - loss: 3.1832 - accuracy200: 0.4207 - val_loss: 3.2750 - val_accuracy200: 0.3888 - 81s/epoch - 40ms/step
Epoch 12/50
2013/2013 - 82s - loss: 3.1718 - accuracy200: 0.4255 - val_loss: 3.2656 - val_accuracy200: 0.3926 - 82s/epoch - 41ms/step
Epoch 13/50
2013/2013 - 81s - loss: 3.1614 - accuracy200: 0.4277 - val_loss: 3.2545 - val_accuracy200: 0.3930 - 81s/epoch - 40ms/step
Epoch 14/50
2013/2013 - 81s - loss: 3.1508 - accuracy200: 0.4303 - val_loss: 3.2361 - val_accuracy200: 0.3963 - 81s/epoch - 40ms/step
Epoch 15/50
2013/2013 - 83s - loss: 3.1409 - accuracy200: 0.4326 - val_loss: 3.2462 - val_accuracy200: 0.3905 - 83s/epoch - 41ms/step
Epoch 16/50
2013/2013 - 93s - loss: 3.1329 - accuracy200: 0.4345 - val_loss: 3.2556 - val_accuracy200: 0.3882 - 93s/epoch - 46ms/step
Epoch 17/50
2013/2013 - 82s - loss: 3.1289 - accuracy200: 0.4358 - val_loss: 3.2612 - val_accuracy200: 0.3849 - 82s/epoch - 41ms/step
Epoch 18/50
2013/2013 - 82s - loss: 3.1226 - accuracy200: 0.4383 - val_loss: 3.2461 - val_accuracy200: 0.3878 - 82s/epoch - 41ms/step
Epoch 19/50
2013/2013 - 82s - loss: 3.1183 - accuracy200: 0.4405 - val_loss: 3.2555 - val_accuracy200: 0.3884 - 82s/epoch - 41ms/step
Epoch 20/50
2013/2013 - 82s - loss: 3.1132 - accuracy200: 0.4419 - val_loss: 3.2496 - val_accuracy200: 0.3923 - 82s/epoch - 41ms/step
Epoch 21/50
2013/2013 - 82s - loss: 3.1102 - accuracy200: 0.4436 - val_loss: 3.2488 - val_accuracy200: 0.3918 - 82s/epoch - 40ms/step
Epoch 22/50
2013/2013 - 81s - loss: 3.1056 - accuracy200: 0.4451 - val_loss: 3.2425 - val_accuracy200: 0.3960 - 81s/epoch - 40ms/step
Epoch 23/50
2013/2013 - 82s - loss: 3.1013 - accuracy200: 0.4465 - val_loss: 3.2511 - val_accuracy200: 0.3953 - 82s/epoch - 41ms/step
Epoch 24/50
2013/2013 - 81s - loss: 3.0982 - accuracy200: 0.4482 - val_loss: 3.2492 - val_accuracy200: 0.3973 - 81s/epoch - 40ms/step
testing model: results/AAL/W7/deepVOL_L3/h200
Evaluating performance on  test set...
5331/5331 - 99s - 99s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0768694
{'0': {'precision': 0.36795802993435345, 'recall': 0.5750932359706867, 'f1-score': 0.4487776683768411, 'support': 421243}, '1': {'precision': 0.43769158148696374, 'recall': 0.29133824670287045, 'f1-score': 0.3498246382144305, 'support': 515600}, '2': {'precision': 0.38543560418250533, 'recall': 0.3271133782024158, 'f1-score': 0.35388765033845515, 'support': 427763}, 'accuracy': 0.39014558048257153, 'macro avg': {'precision': 0.3970284052012742, 'recall': 0.39784828695865765, 'f1-score': 0.3841633189765756, 'support': 1364606}, 'weighted avg': {'precision': 0.3997847101436139, 'recall': 0.39014558048257153, 'f1-score': 0.3816442825219548, 'support': 1364606}}
[[242254  86646  92343]
 [234620 150214 130766]
 [181500 106336 139927]]
Evaluating performance on  train set...
2013/2013 - 38s - 38s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0719424
{'0': {'precision': 0.40706725485177436, 'recall': 0.6061597959812796, 'f1-score': 0.48705332916001454, 'support': 178415}, '1': {'precision': 0.3799459204683585, 'recall': 0.2798516325896691, 'f1-score': 0.3223063973063973, 'support': 164187}, '2': {'precision': 0.4099282844999728, 'recall': 0.3054773898442476, 'f1-score': 0.3500778002275947, 'support': 172710}, 'accuracy': 0.4014170056198963, 'macro avg': {'precision': 0.3989804866067019, 'recall': 0.39716293947173203, 'f1-score': 0.3864791755646689, 'support': 515312}, 'weighted avg': {'precision': 0.399384837019724, 'recall': 0.4014170056198963, 'f1-score': 0.3886540135955253, 'support': 515312}}
[[108148  33702  36565]
 [ 78860  45948  39379]
 [ 78668  41283  52759]]
Evaluating performance on  val set...
696/696 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0756123
{'0': {'precision': 0.39327727383080624, 'recall': 0.6031241009324917, 'f1-score': 0.4761033218219589, 'support': 59089}, '1': {'precision': 0.389181426519866, 'recall': 0.3128649589238208, 'f1-score': 0.34687517391062384, 'support': 59767}, '2': {'precision': 0.4117512224938875, 'recall': 0.27367833020161497, 'f1-score': 0.3288080783428414, 'support': 59073}, 'accuracy': 0.396247941594681, 'macro avg': {'precision': 0.3980699742815199, 'recall': 0.39655579668597585, 'f1-score': 0.3839288580251414, 'support': 177929}, 'weighted avg': {'precision': 0.39803487412722355, 'recall': 0.396247941594681, 'f1-score': 0.3837926212938906, 'support': 177929}}
[[35638 12658 10793]
 [28764 18699 12304]
 [26216 16690 16167]]
training model: results/AAL/W7/deepVOL_L3/h300
Epoch 1/50
2013/2013 - 84s - loss: 3.2985 - accuracy300: 0.3626 - val_loss: 3.3032 - val_accuracy300: 0.3404 - 84s/epoch - 42ms/step
Epoch 2/50
2013/2013 - 81s - loss: 3.2918 - accuracy300: 0.3572 - val_loss: 3.2980 - val_accuracy300: 0.3407 - 81s/epoch - 40ms/step
Epoch 3/50
2013/2013 - 83s - loss: 3.2833 - accuracy300: 0.3669 - val_loss: 3.3069 - val_accuracy300: 0.3461 - 83s/epoch - 41ms/step
Epoch 4/50
2013/2013 - 83s - loss: 3.2678 - accuracy300: 0.3812 - val_loss: 3.3068 - val_accuracy300: 0.3575 - 83s/epoch - 41ms/step
Epoch 5/50
2013/2013 - 82s - loss: 3.2541 - accuracy300: 0.3921 - val_loss: 3.3133 - val_accuracy300: 0.3591 - 82s/epoch - 41ms/step
Epoch 6/50
2013/2013 - 81s - loss: 3.2458 - accuracy300: 0.3967 - val_loss: 3.3097 - val_accuracy300: 0.3578 - 81s/epoch - 40ms/step
Epoch 7/50
2013/2013 - 82s - loss: 3.2388 - accuracy300: 0.4014 - val_loss: 3.2955 - val_accuracy300: 0.3645 - 82s/epoch - 41ms/step
Epoch 8/50
2013/2013 - 81s - loss: 3.2323 - accuracy300: 0.4039 - val_loss: 3.3031 - val_accuracy300: 0.3619 - 81s/epoch - 40ms/step
Epoch 9/50
2013/2013 - 81s - loss: 3.2274 - accuracy300: 0.4060 - val_loss: 3.3016 - val_accuracy300: 0.3627 - 81s/epoch - 40ms/step
Epoch 10/50
2013/2013 - 81s - loss: 3.2225 - accuracy300: 0.4092 - val_loss: 3.2931 - val_accuracy300: 0.3662 - 81s/epoch - 40ms/step
Epoch 11/50
2013/2013 - 81s - loss: 3.2176 - accuracy300: 0.4131 - val_loss: 3.3076 - val_accuracy300: 0.3614 - 81s/epoch - 40ms/step
Epoch 12/50
2013/2013 - 81s - loss: 3.2106 - accuracy300: 0.4163 - val_loss: 3.3004 - val_accuracy300: 0.3616 - 81s/epoch - 40ms/step
Epoch 13/50
2013/2013 - 82s - loss: 3.2059 - accuracy300: 0.4187 - val_loss: 3.3003 - val_accuracy300: 0.3648 - 82s/epoch - 41ms/step
Epoch 14/50
2013/2013 - 81s - loss: 3.2013 - accuracy300: 0.4210 - val_loss: 3.3174 - val_accuracy300: 0.3629 - 81s/epoch - 40ms/step
Epoch 15/50
2013/2013 - 81s - loss: 3.1959 - accuracy300: 0.4244 - val_loss: 3.3308 - val_accuracy300: 0.3610 - 81s/epoch - 40ms/step
Epoch 16/50
2013/2013 - 82s - loss: 3.1901 - accuracy300: 0.4267 - val_loss: 3.3346 - val_accuracy300: 0.3633 - 82s/epoch - 41ms/step
Epoch 17/50
2013/2013 - 84s - loss: 3.1839 - accuracy300: 0.4289 - val_loss: 3.3274 - val_accuracy300: 0.3654 - 84s/epoch - 42ms/step
Epoch 18/50
2013/2013 - 82s - loss: 3.1784 - accuracy300: 0.4323 - val_loss: 3.3397 - val_accuracy300: 0.3616 - 82s/epoch - 41ms/step
Epoch 19/50
2013/2013 - 82s - loss: 3.1713 - accuracy300: 0.4346 - val_loss: 3.3343 - val_accuracy300: 0.3643 - 82s/epoch - 41ms/step
Epoch 20/50
2013/2013 - 82s - loss: 3.1674 - accuracy300: 0.4365 - val_loss: 3.3351 - val_accuracy300: 0.3652 - 82s/epoch - 40ms/step
testing model: results/AAL/W7/deepVOL_L3/h300
Evaluating performance on  test set...
5331/5331 - 99s - 99s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.093292
{'0': {'precision': 0.34313218881822877, 'recall': 0.40545103362378915, 'f1-score': 0.37169761879540375, 'support': 411078}, '1': {'precision': 0.391695932393108, 'recall': 0.5400766798597082, 'f1-score': 0.4540718108680021, 'support': 532604}, '2': {'precision': 0.3672373465461642, 'recall': 0.12607501591736275, 'f1-score': 0.18770846966025856, 'support': 420924}, 'accuracy': 0.37181941161038423, 'macro avg': {'precision': 0.367355155919167, 'recall': 0.3572009098002867, 'f1-score': 0.3378259664412215, 'support': 1364606}, 'weighted avg': {'precision': 0.36952199180489925, 'recall': 0.37181941161038423, 'f1-score': 0.34709518819204443, 'support': 1364606}}
[[166672 209655  34751]
 [188270 287647  56687]
 [130795 237061  53068]]
Evaluating performance on  train set...
2013/2013 - 42s - 42s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0939547
{'0': {'precision': 0.38618996304661246, 'recall': 0.44965224067008125, 'f1-score': 0.41551187876381446, 'support': 174546}, '1': {'precision': 0.34341652943397843, 'recall': 0.5099225962344427, 'f1-score': 0.41042498348268713, 'support': 172989}, '2': {'precision': 0.4085114089098153, 'recall': 0.13445227891784928, 'f1-score': 0.2023166230935842, 'support': 167777}, 'accuracy': 0.36726099916167293, 'macro avg': {'precision': 0.37937263379680203, 'recall': 0.36467570527412435, 'f1-score': 0.34275116178002857, 'support': 515312}, 'weighted avg': {'precision': 0.3790985149828659, 'recall': 0.36726099916167293, 'f1-score': 0.344391397699195, 'support': 515312}}
[[78485 81368 14693]
 [66809 88211 17969]
 [57935 87284 22558]]
Evaluating performance on  val set...
696/696 - 15s - 15s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958737
{'0': {'precision': 0.3759841404701218, 'recall': 0.4548600404289581, 'f1-score': 0.41167806254554484, 'support': 58374}, '1': {'precision': 0.3494399964015833, 'recall': 0.5120874050393026, 'f1-score': 0.415410631571208, 'support': 60683}, '2': {'precision': 0.402752842609216, 'recall': 0.12574738415545592, 'f1-score': 0.1916559874697423, 'support': 58872}, 'accuracy': 0.36548286114124173, 'macro avg': {'precision': 0.37605899316030705, 'recall': 0.3642316098745722, 'f1-score': 0.3395815605288317, 'support': 177929}, 'weighted avg': {'precision': 0.37578826873376425, 'recall': 0.36548286114124173, 'f1-score': 0.34015157660071105, 'support': 177929}}
[[26552 26717  5105]
 [23735 31075  5873]
 [20333 31136  7403]]
training model: results/AAL/W7/deepVOL_L3/h500
Epoch 1/50
2013/2013 - 84s - loss: 3.2720 - accuracy500: 0.3764 - val_loss: 3.2969 - val_accuracy500: 0.3453 - 84s/epoch - 42ms/step
Epoch 2/50
2013/2013 - 83s - loss: 3.2751 - accuracy500: 0.3755 - val_loss: 3.3021 - val_accuracy500: 0.3381 - 83s/epoch - 41ms/step
Epoch 3/50
2013/2013 - 83s - loss: 3.2788 - accuracy500: 0.3784 - val_loss: 3.3061 - val_accuracy500: 0.3427 - 83s/epoch - 41ms/step
Epoch 4/50
2013/2013 - 82s - loss: 3.2698 - accuracy500: 0.3863 - val_loss: 3.3219 - val_accuracy500: 0.3448 - 82s/epoch - 41ms/step
Epoch 5/50
2013/2013 - 82s - loss: 3.2694 - accuracy500: 0.3876 - val_loss: 3.3316 - val_accuracy500: 0.3441 - 82s/epoch - 41ms/step
Epoch 6/50
2013/2013 - 82s - loss: 3.2630 - accuracy500: 0.3908 - val_loss: 3.3599 - val_accuracy500: 0.3452 - 82s/epoch - 40ms/step
Epoch 7/50
2013/2013 - 83s - loss: 3.2566 - accuracy500: 0.3962 - val_loss: 3.3563 - val_accuracy500: 0.3436 - 83s/epoch - 41ms/step
Epoch 8/50
2013/2013 - 82s - loss: 3.2518 - accuracy500: 0.3981 - val_loss: 3.3070 - val_accuracy500: 0.3361 - 82s/epoch - 41ms/step
Epoch 9/50
2013/2013 - 82s - loss: 3.2439 - accuracy500: 0.4011 - val_loss: 3.3393 - val_accuracy500: 0.3482 - 82s/epoch - 41ms/step
Epoch 10/50
2013/2013 - 81s - loss: 3.2378 - accuracy500: 0.4047 - val_loss: 3.3682 - val_accuracy500: 0.3448 - 81s/epoch - 40ms/step
Epoch 11/50
2013/2013 - 81s - loss: 3.2278 - accuracy500: 0.4093 - val_loss: 3.3802 - val_accuracy500: 0.3406 - 81s/epoch - 40ms/step
testing model: results/AAL/W7/deepVOL_L3/h500
Evaluating performance on  test set...
5331/5331 - 101s - 101s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0998024
{'0': {'precision': 0.3236715033118314, 'recall': 0.6215146879382251, 'f1-score': 0.4256655360343259, 'support': 439272}, '1': {'precision': 0.3527331650283791, 'recall': 0.08247062320254188, 'f1-score': 0.13368506768907135, 'support': 477758}, '2': {'precision': 0.3335018673075843, 'recall': 0.305065508427619, 'f1-score': 0.3186505311036664, 'support': 447576}, 'accuracy': 0.32899972592821664, 'macro avg': {'precision': 0.33663551188259827, 'recall': 0.3363502731894619, 'f1-score': 0.29266704494235457, 'support': 1364606}, 'weighted avg': {'precision': 0.33707044511198286, 'recall': 0.32899972592821664, 'f1-score': 0.2883413908652903, 'support': 1364606}}
[[273014  35008 131250]
 [296734  39401 141623]
 [273743  37293 136540]]
Evaluating performance on  train set...
2013/2013 - 38s - 38s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985721
{'0': {'precision': 0.3492728138267383, 'recall': 0.6057455770850885, 'f1-score': 0.4430709694911912, 'support': 178050}, '1': {'precision': 0.32066073579835047, 'recall': 0.08277565471171155, 'f1-score': 0.1315840760546643, 'support': 167211}, '2': {'precision': 0.34002632303878055, 'recall': 0.326637302926769, 'f1-score': 0.3331973629748714, 'support': 170051}, 'accuracy': 0.3439450274784985, 'macro avg': {'precision': 0.3366532908879565, 'recall': 0.33838617824118966, 'f1-score': 0.302617469506909, 'support': 515312}, 'weighted avg': {'precision': 0.33693731769199325, 'recall': 0.3439450274784985, 'f1-score': 0.30574028128652725, 'support': 515312}}
[[107853  14910  55287]
 [100847  13841  52523]
 [100093  14413  55545]]
Evaluating performance on  val set...
696/696 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098403
{'0': {'precision': 0.3433231530231774, 'recall': 0.6069494360622071, 'f1-score': 0.4385684623715751, 'support': 60379}, '1': {'precision': 0.3201252099557184, 'recall': 0.07526746607309542, 'f1-score': 0.12187890590936837, 'support': 55708}, '2': {'precision': 0.35416343886105806, 'recall': 0.33267035348145274, 'f1-score': 0.34308060468102497, 'support': 61842}, 'accuracy': 0.3451545279296798, 'macro avg': {'precision': 0.3392039339466513, 'recall': 0.33829575187225175, 'f1-score': 0.3011759909873228, 'support': 177929}, 'weighted avg': {'precision': 0.3398277922016374, 'recall': 0.3451545279296798, 'f1-score': 0.30622746171009996, 'support': 177929}}
[[36647  4419 19313]
 [33312  4193 18203]
 [36783  4486 20573]]
training model: results/AAL/W7/deepVOL_L3/h1000
Epoch 1/50
2013/2013 - 84s - loss: 3.2044 - accuracy1000: 0.4281 - val_loss: 3.2594 - val_accuracy1000: 0.3753 - 84s/epoch - 42ms/step
Epoch 2/50
2013/2013 - 82s - loss: 3.2246 - accuracy1000: 0.4146 - val_loss: 3.2595 - val_accuracy1000: 0.3705 - 82s/epoch - 41ms/step
Epoch 3/50
2013/2013 - 81s - loss: 3.2319 - accuracy1000: 0.4144 - val_loss: 3.2612 - val_accuracy1000: 0.3708 - 81s/epoch - 40ms/step
Epoch 4/50
2013/2013 - 82s - loss: 3.2123 - accuracy1000: 0.4221 - val_loss: 3.2669 - val_accuracy1000: 0.3768 - 82s/epoch - 41ms/step
Epoch 5/50
2013/2013 - 82s - loss: 3.2017 - accuracy1000: 0.4286 - val_loss: 3.2634 - val_accuracy1000: 0.3751 - 82s/epoch - 41ms/step
Epoch 6/50
2013/2013 - 81s - loss: 3.2155 - accuracy1000: 0.4228 - val_loss: 3.3184 - val_accuracy1000: 0.3698 - 81s/epoch - 40ms/step
Epoch 7/50
2013/2013 - 82s - loss: 3.2009 - accuracy1000: 0.4298 - val_loss: 3.2750 - val_accuracy1000: 0.3750 - 82s/epoch - 41ms/step
Epoch 8/50
2013/2013 - 82s - loss: 3.1944 - accuracy1000: 0.4347 - val_loss: 3.2853 - val_accuracy1000: 0.3787 - 82s/epoch - 41ms/step
Epoch 9/50
2013/2013 - 83s - loss: 3.1920 - accuracy1000: 0.4354 - val_loss: 3.2891 - val_accuracy1000: 0.3780 - 83s/epoch - 41ms/step
Epoch 10/50
2013/2013 - 81s - loss: 3.1855 - accuracy1000: 0.4400 - val_loss: 3.2978 - val_accuracy1000: 0.3725 - 81s/epoch - 40ms/step
Epoch 11/50
2013/2013 - 81s - loss: 3.1806 - accuracy1000: 0.4389 - val_loss: 3.3021 - val_accuracy1000: 0.3760 - 81s/epoch - 40ms/step
testing model: results/AAL/W7/deepVOL_L3/h1000
Evaluating performance on  test set...
5331/5331 - 100s - 100s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1824353
{'0': {'precision': 0.24162351933248902, 'recall': 0.629803812101389, 'f1-score': 0.34925554450664364, 'support': 329582}, '1': {'precision': 1.0, 'recall': 4.367079210082713e-06, 'f1-score': 8.734120277570343e-06, 'support': 686958}, '2': {'precision': 0.25359077880486064, 'recall': 0.36831520458763567, 'f1-score': 0.3003712524762857, 'support': 348066}, 'accuracy': 0.2460585692866659, 'macro avg': {'precision': 0.49840476604578315, 'recall': 0.3327077945894116, 'f1-score': 0.21654517703440232, 'support': 1364606}, 'weighted avg': {'precision': 0.6264512179809653, 'recall': 0.2460585692866659, 'f1-score': 0.1609720030600753, 'support': 1364606}}
[[207572      0 122010]
 [431632      3 255323]
 [219868      0 128198]]
Evaluating performance on  train set...
2013/2013 - 38s - 38s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.11135
{'0': {'precision': 0.3469903413382128, 'recall': 0.6307749835359252, 'f1-score': 0.4477001204208392, 'support': 179178}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 167381}, '2': {'precision': 0.3422436482359581, 'recall': 0.38450871984498053, 'f1-score': 0.3621471985176338, 'support': 168753}, 'accuracy': 0.34524327009656286, 'macro avg': {'precision': 0.2297446631913903, 'recall': 0.3384279011269686, 'f1-score': 0.2699491063128243, 'support': 515312}, 'weighted avg': {'precision': 0.2327282845170711, 'recall': 0.34524327009656286, 'f1-score': 0.27426382146779305, 'support': 515312}}
[[113021      0  66157]
 [108832      0  58549]
 [103865      1  64887]]
Evaluating performance on  val set...
696/696 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0852103
{'0': {'precision': 0.3667806575473962, 'recall': 0.5695630570479178, 'f1-score': 0.44621373395778846, 'support': 64402}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 45137}, '2': {'precision': 0.3830289652340191, 'recall': 0.436408831700541, 'f1-score': 0.4079802612243782, 'support': 68390}, 'accuracy': 0.3738963294347745, 'macro avg': {'precision': 0.24993654092713843, 'recall': 0.3353239629161529, 'f1-score': 0.2847313317273889, 'support': 177929}, 'weighted avg': {'precision': 0.27998110954213185, 'recall': 0.3738963294347745, 'f1-score': 0.31832262846126663, 'support': 177929}}
[[36681     0 27721]
 [24783     0 20354]
 [38544     0 29846]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        25 (peak)  15.16 (ave)

============================================
