This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/WBA_orderbooks/WBA_orderbooks_2020-01-22.csv
data/WBA_orderbooks/WBA_orderbooks_2020-01-14.csv
data/WBA_orderbooks/WBA_orderbooks_2020-01-02.csv
data/WBA_orderbooks/WBA_orderbooks_2020-01-10.csv
data/WBA_orderbooks/WBA_orderbooks_2020-01-06.csv
data/WBA_orderbooks/WBA_orderbooks_2020-01-08.csv
data/WBA_orderbooks/WBA_orderbooks_2020-01-03.csv
data/WBA_orderbooks/WBA_orderbooks_2020-01-24.csv
data/WBA_orderbooks/WBA_orderbooks_2020-01-07.csv
data/WBA_orderbooks/WBA_orderbooks_2020-01-09.csv
data/WBA_orderbooks/WBA_orderbooks_2019-12-31.csv
data/WBA_orderbooks/WBA_orderbooks_2020-01-16.csv
data/WBA_orderbooks/WBA_orderbooks_2020-01-15.csv
training model: results/WBA/W10/deepLOB_L1/h10
Epoch 1/50
1230/1230 - 32s - loss: 3.0538 - accuracy10: 0.4238 - val_loss: 3.1486 - val_accuracy10: 0.4247 - 32s/epoch - 26ms/step
Epoch 2/50
1230/1230 - 20s - loss: 2.9670 - accuracy10: 0.4218 - val_loss: 2.8663 - val_accuracy10: 0.5221 - 20s/epoch - 16ms/step
Epoch 3/50
1230/1230 - 21s - loss: 2.9077 - accuracy10: 0.4431 - val_loss: 2.8663 - val_accuracy10: 0.4872 - 21s/epoch - 17ms/step
Epoch 4/50
1230/1230 - 20s - loss: 2.8470 - accuracy10: 0.4748 - val_loss: 2.8949 - val_accuracy10: 0.5922 - 20s/epoch - 16ms/step
Epoch 5/50
1230/1230 - 21s - loss: 2.8076 - accuracy10: 0.4881 - val_loss: 2.8321 - val_accuracy10: 0.5897 - 21s/epoch - 17ms/step
Epoch 6/50
1230/1230 - 20s - loss: 2.7758 - accuracy10: 0.5032 - val_loss: 2.8453 - val_accuracy10: 0.6001 - 20s/epoch - 17ms/step
Epoch 7/50
1230/1230 - 21s - loss: 2.7503 - accuracy10: 0.5146 - val_loss: 2.8917 - val_accuracy10: 0.6025 - 21s/epoch - 17ms/step
Epoch 8/50
1230/1230 - 20s - loss: 2.7368 - accuracy10: 0.5177 - val_loss: 2.8892 - val_accuracy10: 0.5906 - 20s/epoch - 16ms/step
Epoch 9/50
1230/1230 - 20s - loss: 2.7240 - accuracy10: 0.5220 - val_loss: 2.8670 - val_accuracy10: 0.5999 - 20s/epoch - 16ms/step
Epoch 10/50
1230/1230 - 21s - loss: 2.7155 - accuracy10: 0.5228 - val_loss: 2.9064 - val_accuracy10: 0.5969 - 21s/epoch - 17ms/step
Epoch 11/50
1230/1230 - 21s - loss: 2.7043 - accuracy10: 0.5270 - val_loss: 2.8885 - val_accuracy10: 0.6009 - 21s/epoch - 17ms/step
Epoch 12/50
1230/1230 - 20s - loss: 2.6930 - accuracy10: 0.5316 - val_loss: 2.8936 - val_accuracy10: 0.5963 - 20s/epoch - 16ms/step
Epoch 13/50
1230/1230 - 20s - loss: 2.6869 - accuracy10: 0.5339 - val_loss: 2.8662 - val_accuracy10: 0.6039 - 20s/epoch - 17ms/step
Epoch 14/50
1230/1230 - 21s - loss: 2.6784 - accuracy10: 0.5369 - val_loss: 2.9268 - val_accuracy10: 0.6139 - 21s/epoch - 17ms/step
Epoch 15/50
1230/1230 - 21s - loss: 2.6710 - accuracy10: 0.5382 - val_loss: 2.9319 - val_accuracy10: 0.6112 - 21s/epoch - 17ms/step
testing model: results/WBA/W10/deepLOB_L1/h10
Evaluating performance on  test set...
6546/6546 - 45s - 45s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9149944
{'0': {'precision': 0.3987931794298112, 'recall': 0.11425907400033022, 'f1-score': 0.17762611544791557, 'support': 308877}, '1': {'precision': 0.6993784962571239, 'recall': 0.689810888338554, 'f1-score': 0.6945617453424783, 'support': 1061172}, '2': {'precision': 0.33243682681084763, 'recall': 0.5878614418422086, 'f1-score': 0.4247031619792116, 'support': 305720}, 'accuracy': 0.5651262196639274, 'macro avg': {'precision': 0.4768695008325943, 'recall': 0.4639771347270309, 'f1-score': 0.4322970075898685, 'support': 1675769}, 'weighted avg': {'precision': 0.5770315032713452, 'recall': 0.5651262196639274, 'f1-score': 0.5500485739801003, 'support': 1675769}}
[[ 35292 199955  73630]
 [ 41898 732008 287266]
 [ 11307 114692 179721]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9273483
{'0': {'precision': 0.36524896746948815, 'recall': 0.5047941251924064, 'f1-score': 0.42383080692496167, 'support': 62368}, '1': {'precision': 0.7008285494466473, 'recall': 0.6205470837918566, 'f1-score': 0.658249027237354, 'support': 190830}, '2': {'precision': 0.3621065700288571, 'recall': 0.3505327096732281, 'f1-score': 0.35622565524526306, 'support': 61572}, 'accuracy': 0.544794611938876, 'macro avg': {'precision': 0.47606136231499746, 'recall': 0.4919579728858303, 'f1-score': 0.47943516313585954, 'support': 314770}, 'weighted avg': {'precision': 0.5680801392250137, 'recall': 0.544794611938876, 'f1-score': 0.5527231555699769, 'support': 314770}}
[[ 31483  24045   6840]
 [ 41230 118419  31181]
 [ 13483  26506  21583]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8649023
{'0': {'precision': 0.34803653965134473, 'recall': 0.49068705423572273, 'f1-score': 0.40723076267938507, 'support': 19489}, '1': {'precision': 0.7386951275568835, 'recall': 0.6848448528432548, 'f1-score': 0.7107514546736141, 'support': 75090}, '2': {'precision': 0.3588519674438529, 'recall': 0.31100503845133914, 'f1-score': 0.33321968405500624, 'support': 18855}, 'accuracy': 0.589347109332299, 'macro avg': {'precision': 0.48186121155069367, 'recall': 0.49551231517677224, 'f1-score': 0.48373396713600175, 'support': 113434}, 'weighted avg': {'precision': 0.6084388727865128, 'recall': 0.589347109332299, 'f1-score': 0.5958504875800673, 'support': 113434}}
[[ 9563  8247  1679]
 [14867 51425  8798]
 [ 3047  9944  5864]]
training model: results/WBA/W10/deepLOB_L1/h20
Epoch 1/50
1230/1230 - 23s - loss: 3.0716 - accuracy20: 0.4457 - val_loss: 3.2352 - val_accuracy20: 0.4515 - 23s/epoch - 19ms/step
Epoch 2/50
1230/1230 - 20s - loss: 3.0425 - accuracy20: 0.4373 - val_loss: 3.1557 - val_accuracy20: 0.3983 - 20s/epoch - 17ms/step
Epoch 3/50
1230/1230 - 21s - loss: 2.9932 - accuracy20: 0.4551 - val_loss: 3.1141 - val_accuracy20: 0.4458 - 21s/epoch - 17ms/step
Epoch 4/50
1230/1230 - 19s - loss: 2.9335 - accuracy20: 0.4814 - val_loss: 3.0705 - val_accuracy20: 0.5048 - 19s/epoch - 15ms/step
Epoch 5/50
1230/1230 - 19s - loss: 2.8984 - accuracy20: 0.4970 - val_loss: 3.1580 - val_accuracy20: 0.5336 - 19s/epoch - 16ms/step
Epoch 6/50
1230/1230 - 20s - loss: 2.8694 - accuracy20: 0.5083 - val_loss: 3.0960 - val_accuracy20: 0.5435 - 20s/epoch - 16ms/step
Epoch 7/50
1230/1230 - 19s - loss: 2.8503 - accuracy20: 0.5145 - val_loss: 3.0330 - val_accuracy20: 0.5310 - 19s/epoch - 15ms/step
Epoch 8/50
1230/1230 - 18s - loss: 2.8208 - accuracy20: 0.5252 - val_loss: 3.0470 - val_accuracy20: 0.5437 - 18s/epoch - 15ms/step
Epoch 9/50
1230/1230 - 18s - loss: 2.8026 - accuracy20: 0.5303 - val_loss: 3.0709 - val_accuracy20: 0.5552 - 18s/epoch - 15ms/step
Epoch 10/50
1230/1230 - 18s - loss: 2.7881 - accuracy20: 0.5337 - val_loss: 3.0475 - val_accuracy20: 0.5654 - 18s/epoch - 15ms/step
Epoch 11/50
1230/1230 - 18s - loss: 2.7778 - accuracy20: 0.5373 - val_loss: 3.0746 - val_accuracy20: 0.5580 - 18s/epoch - 15ms/step
Epoch 12/50
1230/1230 - 18s - loss: 2.7677 - accuracy20: 0.5398 - val_loss: 3.1069 - val_accuracy20: 0.5582 - 18s/epoch - 15ms/step
Epoch 13/50
1230/1230 - 18s - loss: 2.7604 - accuracy20: 0.5415 - val_loss: 3.1093 - val_accuracy20: 0.5550 - 18s/epoch - 15ms/step
Epoch 14/50
1230/1230 - 18s - loss: 2.7501 - accuracy20: 0.5453 - val_loss: 3.1515 - val_accuracy20: 0.5564 - 18s/epoch - 15ms/step
Epoch 15/50
1230/1230 - 19s - loss: 2.7445 - accuracy20: 0.5467 - val_loss: 3.1390 - val_accuracy20: 0.5576 - 19s/epoch - 15ms/step
Epoch 16/50
1230/1230 - 19s - loss: 2.7389 - accuracy20: 0.5485 - val_loss: 3.1219 - val_accuracy20: 0.5545 - 19s/epoch - 15ms/step
Epoch 17/50
1230/1230 - 19s - loss: 2.7292 - accuracy20: 0.5498 - val_loss: 3.1087 - val_accuracy20: 0.5520 - 19s/epoch - 16ms/step
testing model: results/WBA/W10/deepLOB_L1/h20
Evaluating performance on  test set...
6546/6546 - 43s - 43s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98081434
{'0': {'precision': 0.530285646463048, 'recall': 0.06763193613983036, 'f1-score': 0.11996384124157006, 'support': 396366}, '1': {'precision': 0.565554093442357, 'recall': 0.813927755689028, 'f1-score': 0.6673812696935869, 'support': 886575}, '2': {'precision': 0.4211047680124597, 'recall': 0.37442850305986336, 'f1-score': 0.39639731901028685, 'support': 392828}, 'accuracy': 0.5343821254600127, 'macro avg': {'precision': 0.5056481693059549, 'recall': 0.4186627316295739, 'f1-score': 0.3945808099818146, 'support': 1675769}, 'weighted avg': {'precision': 0.523350810731329, 'recall': 0.5343821254600127, 'f1-score': 0.47437869008695166, 'support': 1675769}}
[[ 26807 315546  54013]
 [ 16780 721608 148187]
 [  6965 238777 147086]]
Evaluating performance on  train set...
1230/1230 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0004246
{'0': {'precision': 0.437023274007432, 'recall': 0.3385135902841777, 'f1-score': 0.381512019179466, 'support': 79211}, '1': {'precision': 0.5484447246742329, 'recall': 0.6967337130651478, 'f1-score': 0.6137593100744806, 'support': 157304}, '2': {'precision': 0.4016760610698421, 'recall': 0.27501118139416014, 'f1-score': 0.3264888153952349, 'support': 78255}, 'accuracy': 0.5017441306350668, 'macro avg': {'precision': 0.46238135325050234, 'recall': 0.4367528282478285, 'f1-score': 0.44058671488306045, 'support': 314770}, 'weighted avg': {'precision': 0.48391765316446517, 'recall': 0.5017441306350668, 'f1-score': 0.48389657626817956, 'support': 314770}}
[[ 26814  44596   7801]
 [ 23449 109599  24256]
 [ 11093  45641  21521]]
Evaluating performance on  val set...
444/444 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9630877
{'0': {'precision': 0.3891882644769481, 'recall': 0.36531513448414293, 'f1-score': 0.376874016400232, 'support': 24910}, '1': {'precision': 0.6132007356447109, 'recall': 0.7004559530664011, 'f1-score': 0.6539305275086078, 'support': 64261}, '2': {'precision': 0.36937586351895235, 'recall': 0.2534311503111734, 'f1-score': 0.30061109753116594, 'support': 24263}, 'accuracy': 0.5312428372445651, 'macro avg': {'precision': 0.4572549545468705, 'recall': 0.4397340792872391, 'f1-score': 0.44380521381333526, 'support': 113434}, 'weighted avg': {'precision': 0.511854811766718, 'recall': 0.5312428372445651, 'f1-score': 0.5175158103933486, 'support': 113434}}
[[ 9100 14005  1805]
 [10556 45012  8693]
 [ 3726 14388  6149]]
training model: results/WBA/W10/deepLOB_L1/h30
Epoch 1/50
1230/1230 - 21s - loss: 3.1257 - accuracy30: 0.4405 - val_loss: 3.3380 - val_accuracy30: 0.3875 - 21s/epoch - 17ms/step
Epoch 2/50
1230/1230 - 20s - loss: 3.1004 - accuracy30: 0.4309 - val_loss: 3.2110 - val_accuracy30: 0.3805 - 20s/epoch - 16ms/step
Epoch 3/50
1230/1230 - 19s - loss: 3.0633 - accuracy30: 0.4470 - val_loss: 3.0145 - val_accuracy30: 0.4566 - 19s/epoch - 15ms/step
Epoch 4/50
1230/1230 - 19s - loss: 3.0133 - accuracy30: 0.4750 - val_loss: 3.1032 - val_accuracy30: 0.4596 - 19s/epoch - 15ms/step
Epoch 5/50
1230/1230 - 19s - loss: 2.9751 - accuracy30: 0.4880 - val_loss: 3.2650 - val_accuracy30: 0.4556 - 19s/epoch - 15ms/step
Epoch 6/50
1230/1230 - 19s - loss: 2.9405 - accuracy30: 0.5020 - val_loss: 3.2844 - val_accuracy30: 0.4304 - 19s/epoch - 16ms/step
Epoch 7/50
1230/1230 - 21s - loss: 2.9143 - accuracy30: 0.5107 - val_loss: 3.2625 - val_accuracy30: 0.4402 - 21s/epoch - 17ms/step
Epoch 8/50
1230/1230 - 20s - loss: 2.8964 - accuracy30: 0.5153 - val_loss: 3.2746 - val_accuracy30: 0.4303 - 20s/epoch - 17ms/step
Epoch 9/50
1230/1230 - 21s - loss: 2.8770 - accuracy30: 0.5211 - val_loss: 3.2769 - val_accuracy30: 0.4248 - 21s/epoch - 17ms/step
Epoch 10/50
1230/1230 - 21s - loss: 2.8702 - accuracy30: 0.5228 - val_loss: 3.2009 - val_accuracy30: 0.4378 - 21s/epoch - 17ms/step
Epoch 11/50
1230/1230 - 21s - loss: 2.8614 - accuracy30: 0.5250 - val_loss: 3.1683 - val_accuracy30: 0.4630 - 21s/epoch - 17ms/step
Epoch 12/50
1230/1230 - 20s - loss: 2.8535 - accuracy30: 0.5278 - val_loss: 3.2230 - val_accuracy30: 0.4331 - 20s/epoch - 16ms/step
Epoch 13/50
1230/1230 - 20s - loss: 2.8450 - accuracy30: 0.5299 - val_loss: 3.2285 - val_accuracy30: 0.4483 - 20s/epoch - 17ms/step
testing model: results/WBA/W10/deepLOB_L1/h30
Evaluating performance on  test set...
6546/6546 - 41s - 41s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0429993
{'0': {'precision': 0.4687736388627516, 'recall': 0.05580410580114077, 'f1-score': 0.09973543104328096, 'support': 455307}, '1': {'precision': 0.5070143339310604, 'recall': 0.6853650022903072, 'f1-score': 0.5828512279272972, 'support': 770639}, '2': {'precision': 0.38309096929518976, 'recall': 0.4938231259851097, 'f1-score': 0.43146570687416425, 'support': 449823}, 'accuracy': 0.4628979292491984, 'macro avg': {'precision': 0.4529596473630006, 'recall': 0.41166407802551924, 'f1-score': 0.3713507886149141, 'support': 1675769}, 'weighted avg': {'precision': 0.4633598470655869, 'recall': 0.4628979292491984, 'f1-score': 0.4109524200554758, 'support': 1675769}}
[[ 25408 294903 134996]
 [ 19755 528169 222715]
 [  9038 218652 222133]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0450734
{'0': {'precision': 0.4095034272504265, 'recall': 0.4497527551721844, 'f1-score': 0.42868541053510384, 'support': 90194}, '1': {'precision': 0.4714846760873555, 'recall': 0.47411584938251555, 'f1-score': 0.47279660205967006, 'support': 135469}, '2': {'precision': 0.4093676873914903, 'recall': 0.36516771970776707, 'f1-score': 0.38600653645169136, 'support': 89107}, 'accuracy': 0.4362931664389872, 'macro avg': {'precision': 0.4301185969097574, 'recall': 0.42967877475415567, 'f1-score': 0.4291628496821551, 'support': 314770}, 'weighted avg': {'precision': 0.43614015383517, 'recall': 0.4362931664389872, 'f1-score': 0.4355879507126647, 'support': 314770}}
[[40565 35821 13808]
 [38102 64228 33139]
 [20392 36176 32539]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0128932
{'0': {'precision': 0.36954805368806376, 'recall': 0.5404289562996396, 'f1-score': 0.43894398817812386, 'support': 28581}, '1': {'precision': 0.5577031945006066, 'recall': 0.484967825872921, 'f1-score': 0.5187985480261054, 'support': 56878}, '2': {'precision': 0.3944627316589259, 'recall': 0.31270777479892764, 'f1-score': 0.3488594672196523, 'support': 27975}, 'accuracy': 0.4564592626549359, 'macro avg': {'precision': 0.44057132661586546, 'recall': 0.4460348523238295, 'f1-score': 0.4355340011412938, 'support': 113434}, 'weighted avg': {'precision': 0.4700371153042518, 'recall': 0.4564592626549359, 'f1-score': 0.45676803723943044, 'support': 113434}}
[[15446 10284  2851]
 [18716 27584 10578]
 [ 7635 11592  8748]]
training model: results/WBA/W10/deepLOB_L1/h50
Epoch 1/50
1230/1230 - 22s - loss: 3.1736 - accuracy50: 0.4319 - val_loss: 3.3908 - val_accuracy50: 0.3551 - 22s/epoch - 18ms/step
Epoch 2/50
1230/1230 - 20s - loss: 3.1327 - accuracy50: 0.4483 - val_loss: 3.3505 - val_accuracy50: 0.3959 - 20s/epoch - 17ms/step
Epoch 3/50
1230/1230 - 21s - loss: 3.1317 - accuracy50: 0.4475 - val_loss: 3.3327 - val_accuracy50: 0.4098 - 21s/epoch - 17ms/step
Epoch 4/50
1230/1230 - 21s - loss: 3.1060 - accuracy50: 0.4560 - val_loss: 3.3511 - val_accuracy50: 0.4015 - 21s/epoch - 17ms/step
Epoch 5/50
1230/1230 - 20s - loss: 3.0804 - accuracy50: 0.4648 - val_loss: 3.3310 - val_accuracy50: 0.4138 - 20s/epoch - 17ms/step
Epoch 6/50
1230/1230 - 20s - loss: 3.0565 - accuracy50: 0.4722 - val_loss: 3.3727 - val_accuracy50: 0.4037 - 20s/epoch - 17ms/step
Epoch 7/50
1230/1230 - 20s - loss: 3.0346 - accuracy50: 0.4797 - val_loss: 3.3851 - val_accuracy50: 0.4151 - 20s/epoch - 16ms/step
Epoch 8/50
1230/1230 - 21s - loss: 3.0131 - accuracy50: 0.4852 - val_loss: 3.4147 - val_accuracy50: 0.4110 - 21s/epoch - 17ms/step
Epoch 9/50
1230/1230 - 20s - loss: 2.9973 - accuracy50: 0.4910 - val_loss: 3.4186 - val_accuracy50: 0.4092 - 20s/epoch - 16ms/step
Epoch 10/50
1230/1230 - 20s - loss: 2.9891 - accuracy50: 0.4940 - val_loss: 3.4501 - val_accuracy50: 0.4049 - 20s/epoch - 16ms/step
Epoch 11/50
1230/1230 - 20s - loss: 2.9792 - accuracy50: 0.4957 - val_loss: 3.4801 - val_accuracy50: 0.4130 - 20s/epoch - 16ms/step
Epoch 12/50
1230/1230 - 20s - loss: 2.9723 - accuracy50: 0.4973 - val_loss: 3.5570 - val_accuracy50: 0.4101 - 20s/epoch - 16ms/step
Epoch 13/50
1230/1230 - 20s - loss: 2.9624 - accuracy50: 0.4995 - val_loss: 3.6396 - val_accuracy50: 0.4105 - 20s/epoch - 16ms/step
Epoch 14/50
1230/1230 - 20s - loss: 2.9557 - accuracy50: 0.5023 - val_loss: 3.6303 - val_accuracy50: 0.4178 - 20s/epoch - 16ms/step
Epoch 15/50
1230/1230 - 20s - loss: 2.9465 - accuracy50: 0.5040 - val_loss: 3.5325 - val_accuracy50: 0.4217 - 20s/epoch - 16ms/step
testing model: results/WBA/W10/deepLOB_L1/h50
Evaluating performance on  test set...
6546/6546 - 35s - 35s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1034919
{'0': {'precision': 0.4657544378698225, 'recall': 0.011843367375726457, 'f1-score': 0.023099356211368098, 'support': 531690}, '1': {'precision': 0.3772208721892325, 'recall': 0.8437750345053906, 'f1-score': 0.5213605593638225, 'support': 621642}, '2': {'precision': 0.4276903601866435, 'recall': 0.22246510105524686, 'f1-score': 0.2926874720625547, 'support': 522437}, 'accuracy': 0.38611944725078456, 'macro avg': {'precision': 0.4235552234152329, 'recall': 0.35936116764545467, 'f1-score': 0.2790491292125818, 'support': 1675769}, 'weighted avg': {'precision': 0.4210452533763868, 'recall': 0.38611944725078456, 'f1-score': 0.29198062644076395, 'support': 1675769}}
[[  6297 461637  63756]
 [  5348 524526  91768]
 [  1875 404338 116224]]
Evaluating performance on  train set...
1230/1230 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1332666
{'0': {'precision': 0.4487098361808339, 'recall': 0.06094463225042495, 'f1-score': 0.10731371015881824, 'support': 104718}, '1': {'precision': 0.3433773085094026, 'recall': 0.8555757830369229, 'f1-score': 0.4900697311287459, 'support': 107115}, '2': {'precision': 0.47827895643905627, 'recall': 0.1563674869094689, 'f1-score': 0.23568170670102714, 'support': 102937}, 'accuracy': 0.3625599644184643, 'macro avg': {'precision': 0.42345536704309755, 'recall': 0.3576293007322722, 'f1-score': 0.2776883826628638, 'support': 314770}, 'weighted avg': {'precision': 0.4225353685711356, 'recall': 0.3625599644184643, 'f1-score': 0.27954336243272987, 'support': 314770}}
[[ 6382 91203  7133]
 [ 5045 91645 10425]
 [ 2796 84045 16096]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1065266
{'0': {'precision': 0.39798387096774196, 'recall': 0.11688427036148859, 'f1-score': 0.18069890381490722, 'support': 33777}, '1': {'precision': 0.41538268821245145, 'recall': 0.851366096835619, 'f1-score': 0.558347072648823, 'support': 46739}, '2': {'precision': 0.42770147706659756, 'recall': 0.10027948235008202, 'f1-score': 0.16246677822620337, 'support': 32918}, 'accuracy': 0.41469929650722004, 'macro avg': {'precision': 0.413689345415597, 'recall': 0.3561766165157299, 'f1-score': 0.30050425156331123, 'support': 113434}, 'weighted avg': {'precision': 0.4137767326914104, 'recall': 0.41469929650722004, 'f1-score': 0.3310130305582067, 'support': 113434}}
[[ 3948 28569  1260]
 [ 3790 39792  3157]
 [ 2182 27435  3301]]
training model: results/WBA/W10/deepLOB_L1/h100
Epoch 1/50
1230/1230 - 23s - loss: 3.2492 - accuracy100: 0.3979 - val_loss: 3.3698 - val_accuracy100: 0.3716 - 23s/epoch - 19ms/step
Epoch 2/50
1230/1230 - 20s - loss: 3.2309 - accuracy100: 0.4017 - val_loss: 3.3181 - val_accuracy100: 0.3594 - 20s/epoch - 16ms/step
Epoch 3/50
1230/1230 - 20s - loss: 3.2150 - accuracy100: 0.4098 - val_loss: 3.3308 - val_accuracy100: 0.3755 - 20s/epoch - 16ms/step
Epoch 4/50
1230/1230 - 20s - loss: 3.2055 - accuracy100: 0.4154 - val_loss: 3.2577 - val_accuracy100: 0.3846 - 20s/epoch - 17ms/step
Epoch 5/50
1230/1230 - 20s - loss: 3.1885 - accuracy100: 0.4249 - val_loss: 3.3284 - val_accuracy100: 0.3649 - 20s/epoch - 16ms/step
Epoch 6/50
1230/1230 - 20s - loss: 3.1795 - accuracy100: 0.4307 - val_loss: 3.2855 - val_accuracy100: 0.3715 - 20s/epoch - 16ms/step
Epoch 7/50
1230/1230 - 20s - loss: 3.1759 - accuracy100: 0.4313 - val_loss: 3.3306 - val_accuracy100: 0.3610 - 20s/epoch - 17ms/step
Epoch 8/50
1230/1230 - 20s - loss: 3.1678 - accuracy100: 0.4346 - val_loss: 3.3026 - val_accuracy100: 0.3692 - 20s/epoch - 16ms/step
Epoch 9/50
1230/1230 - 20s - loss: 3.1616 - accuracy100: 0.4362 - val_loss: 3.3324 - val_accuracy100: 0.3617 - 20s/epoch - 17ms/step
Epoch 10/50
1230/1230 - 20s - loss: 3.1532 - accuracy100: 0.4395 - val_loss: 3.3039 - val_accuracy100: 0.3684 - 20s/epoch - 16ms/step
Epoch 11/50
1230/1230 - 21s - loss: 3.1465 - accuracy100: 0.4423 - val_loss: 3.3147 - val_accuracy100: 0.3624 - 21s/epoch - 17ms/step
Epoch 12/50
1230/1230 - 21s - loss: 3.1440 - accuracy100: 0.4434 - val_loss: 3.3295 - val_accuracy100: 0.3571 - 21s/epoch - 17ms/step
Epoch 13/50
1230/1230 - 20s - loss: 3.1394 - accuracy100: 0.4442 - val_loss: 3.3283 - val_accuracy100: 0.3584 - 20s/epoch - 16ms/step
Epoch 14/50
1230/1230 - 20s - loss: 3.1368 - accuracy100: 0.4457 - val_loss: 3.3544 - val_accuracy100: 0.3551 - 20s/epoch - 16ms/step
testing model: results/WBA/W10/deepLOB_L1/h100
Evaluating performance on  test set...
6546/6546 - 43s - 43s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.111186
{'0': {'precision': 0.4338297038571349, 'recall': 0.02794022209402942, 'f1-score': 0.05249929714148288, 'support': 554720}, '1': {'precision': 0.3609800670673887, 'recall': 0.6360218135083971, 'f1-score': 0.4605632173210958, 'support': 575790}, '2': {'precision': 0.3953170135930339, 'recall': 0.4535220876684291, 'f1-score': 0.4224239836009566, 'support': 545259}, 'accuracy': 0.3753506599059894, 'macro avg': {'precision': 0.3967089281725192, 'recall': 0.37249470775695187, 'f1-score': 0.3118288326878451, 'support': 1675769}, 'weighted avg': {'precision': 0.3962675557640019, 'recall': 0.3753506599059894, 'f1-score': 0.313074525120056, 'support': 1675769}}
[[ 15499 357771 181450]
 [ 12771 366215 196804]
 [  7456 290516 247287]]
Evaluating performance on  train set...
1230/1230 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1095268
{'0': {'precision': 0.43199414741205877, 'recall': 0.06572308377235289, 'f1-score': 0.11408882699103999, 'support': 107816}, '1': {'precision': 0.32278562473483746, 'recall': 0.6669785859222631, 'f1-score': 0.43503512700008673, 'support': 101522}, '2': {'precision': 0.4134891071227001, 'recall': 0.34743721071401473, 'f1-score': 0.3775963550525198, 'support': 105432}, 'accuracy': 0.3540045112304222, 'macro avg': {'precision': 0.3894229597565321, 'recall': 0.3600462934695436, 'f1-score': 0.3089067696812155, 'support': 314770}, 'weighted avg': {'precision': 0.3905731382719739, 'recall': 0.3540045112304222, 'f1-score': 0.3058645234300157, 'support': 314770}}
[[ 7086 76905 23825]
 [ 5675 67713 28134]
 [ 3642 65159 36631]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0871149
{'0': {'precision': 0.39951256092988374, 'recall': 0.11789112635538836, 'f1-score': 0.18205894916702264, 'support': 36152}, '1': {'precision': 0.37240732422649087, 'recall': 0.6704642755208828, 'f1-score': 0.478842854473492, 'support': 42044}, '2': {'precision': 0.40802304964539005, 'recall': 0.3134684147794994, 'f1-score': 0.3545498314877227, 'support': 35238}, 'accuracy': 0.3834564592626549, 'macro avg': {'precision': 0.3933143116005882, 'recall': 0.36727460555192354, 'f1-score': 0.3384838783760791, 'support': 113434}, 'weighted avg': {'precision': 0.39210984242749075, 'recall': 0.3834564592626549, 'f1-score': 0.34564496593379473, 'support': 113434}}
[[ 4262 26047  5843]
 [ 3672 28189 10183]
 [ 2734 21458 11046]]
training model: results/WBA/W10/deepLOB_L1/h200
Epoch 1/50
1230/1230 - 23s - loss: 3.2814 - accuracy200: 0.3791 - val_loss: 3.3568 - val_accuracy200: 0.3646 - 23s/epoch - 18ms/step
Epoch 2/50
1230/1230 - 20s - loss: 3.2596 - accuracy200: 0.3851 - val_loss: 3.3568 - val_accuracy200: 0.3642 - 20s/epoch - 16ms/step
Epoch 3/50
1230/1230 - 20s - loss: 3.2494 - accuracy200: 0.3929 - val_loss: 3.3268 - val_accuracy200: 0.3573 - 20s/epoch - 16ms/step
Epoch 4/50
1230/1230 - 20s - loss: 3.2415 - accuracy200: 0.3977 - val_loss: 3.3411 - val_accuracy200: 0.3697 - 20s/epoch - 16ms/step
Epoch 5/50
1230/1230 - 20s - loss: 3.2340 - accuracy200: 0.4006 - val_loss: 3.3512 - val_accuracy200: 0.3608 - 20s/epoch - 16ms/step
Epoch 6/50
1230/1230 - 19s - loss: 3.2305 - accuracy200: 0.4033 - val_loss: 3.3360 - val_accuracy200: 0.3736 - 19s/epoch - 16ms/step
Epoch 7/50
1230/1230 - 20s - loss: 3.2273 - accuracy200: 0.4052 - val_loss: 3.3325 - val_accuracy200: 0.3765 - 20s/epoch - 16ms/step
Epoch 8/50
1230/1230 - 20s - loss: 3.2206 - accuracy200: 0.4097 - val_loss: 3.3287 - val_accuracy200: 0.3715 - 20s/epoch - 16ms/step
Epoch 9/50
1230/1230 - 21s - loss: 3.2187 - accuracy200: 0.4105 - val_loss: 3.3448 - val_accuracy200: 0.3559 - 21s/epoch - 17ms/step
Epoch 10/50
1230/1230 - 20s - loss: 3.2147 - accuracy200: 0.4121 - val_loss: 3.3666 - val_accuracy200: 0.3596 - 20s/epoch - 17ms/step
Epoch 11/50
1230/1230 - 20s - loss: 3.2130 - accuracy200: 0.4143 - val_loss: 3.3866 - val_accuracy200: 0.3584 - 20s/epoch - 16ms/step
Epoch 12/50
1230/1230 - 20s - loss: 3.2094 - accuracy200: 0.4150 - val_loss: 3.3760 - val_accuracy200: 0.3585 - 20s/epoch - 16ms/step
Epoch 13/50
1230/1230 - 20s - loss: 3.2084 - accuracy200: 0.4154 - val_loss: 3.3633 - val_accuracy200: 0.3670 - 20s/epoch - 16ms/step
testing model: results/WBA/W10/deepLOB_L1/h200
Evaluating performance on  test set...
6546/6546 - 40s - 40s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1143326
{'0': {'precision': 0.3179748794712133, 'recall': 0.14820526788474847, 'f1-score': 0.2021774305917324, 'support': 543368}, '1': {'precision': 0.38822575018319544, 'recall': 0.3857320551943744, 'f1-score': 0.3869748853414217, 'support': 602960}, '2': {'precision': 0.34541906164875164, 'recall': 0.5372194446595561, 'f1-score': 0.4204798117179554, 'support': 529441}, 'accuracy': 0.35657480237431294, 'macro avg': {'precision': 0.35053989710105343, 'recall': 0.357052255912893, 'f1-score': 0.33654404255036985, 'support': 1675769}, 'weighted avg': {'precision': 0.3519226015383686, 'recall': 0.35657480237431294, 'f1-score': 0.33763983876476894, 'support': 1675769}}
[[ 80530 198849 263989]
 [ 95371 232581 275008]
 [ 77358 167657 284426]]
Evaluating performance on  train set...
1230/1230 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1160908
{'0': {'precision': 0.3512562030710073, 'recall': 0.25525105965203765, 'f1-score': 0.29565521652843757, 'support': 105931}, '1': {'precision': 0.36071500903887843, 'recall': 0.4504182160486311, 'f1-score': 0.4006064746163715, 'support': 106763}, '2': {'precision': 0.3497353535160176, 'recall': 0.357968572436224, 'f1-score': 0.3538040715547917, 'support': 102076}, 'accuracy': 0.35475744194173525, 'macro avg': {'precision': 0.3539021885419678, 'recall': 0.3545459493789642, 'f1-score': 0.35002192089986695, 'support': 314770}, 'weighted avg': {'precision': 0.35397122757262023, 'recall': 0.35475744194173525, 'f1-score': 0.35010930584099026, 'support': 314770}}
[[27039 43975 34917]
 [25653 48088 33022]
 [24286 41250 36540]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1103368
{'0': {'precision': 0.32839831668610253, 'recall': 0.1799116691203022, 'f1-score': 0.23246715957217717, 'support': 36001}, '1': {'precision': 0.39161554192229037, 'recall': 0.4378470440016798, 'f1-score': 0.4134428974268593, 'support': 42862}, '2': {'precision': 0.32678154141824456, 'recall': 0.43281941511671634, 'f1-score': 0.3723992035838726, 'support': 34571}, 'accuracy': 0.3544528095632703, 'macro avg': {'precision': 0.3489318000088792, 'recall': 0.35019270941289943, 'f1-score': 0.339436420194303, 'support': 113434}, 'weighted avg': {'precision': 0.3517927413761281, 'recall': 0.3544528095632703, 'f1-score': 0.34349712210065814, 'support': 113434}}
[[ 6477 15133 14391]
 [ 7660 18767 16435]
 [ 5586 14022 14963]]
training model: results/WBA/W10/deepLOB_L1/h300
Epoch 1/50
1230/1230 - 22s - loss: 3.3019 - accuracy300: 0.3662 - val_loss: 3.3425 - val_accuracy300: 0.3486 - 22s/epoch - 18ms/step
Epoch 2/50
1230/1230 - 19s - loss: 3.2733 - accuracy300: 0.3791 - val_loss: 3.3517 - val_accuracy300: 0.3458 - 19s/epoch - 16ms/step
Epoch 3/50
1230/1230 - 20s - loss: 3.2611 - accuracy300: 0.3870 - val_loss: 3.3606 - val_accuracy300: 0.3487 - 20s/epoch - 16ms/step
Epoch 4/50
1230/1230 - 19s - loss: 3.2544 - accuracy300: 0.3917 - val_loss: 3.3694 - val_accuracy300: 0.3416 - 19s/epoch - 16ms/step
Epoch 5/50
1230/1230 - 20s - loss: 3.2471 - accuracy300: 0.3983 - val_loss: 3.4004 - val_accuracy300: 0.3466 - 20s/epoch - 16ms/step
Epoch 6/50
1230/1230 - 20s - loss: 3.2409 - accuracy300: 0.4002 - val_loss: 3.3943 - val_accuracy300: 0.3444 - 20s/epoch - 16ms/step
Epoch 7/50
1230/1230 - 20s - loss: 3.2353 - accuracy300: 0.4040 - val_loss: 3.3991 - val_accuracy300: 0.3403 - 20s/epoch - 16ms/step
Epoch 8/50
1230/1230 - 20s - loss: 3.2321 - accuracy300: 0.4064 - val_loss: 3.4038 - val_accuracy300: 0.3412 - 20s/epoch - 16ms/step
Epoch 9/50
1230/1230 - 20s - loss: 3.2288 - accuracy300: 0.4092 - val_loss: 3.4070 - val_accuracy300: 0.3396 - 20s/epoch - 16ms/step
Epoch 10/50
1230/1230 - 20s - loss: 3.2262 - accuracy300: 0.4095 - val_loss: 3.4241 - val_accuracy300: 0.3423 - 20s/epoch - 16ms/step
Epoch 11/50
1230/1230 - 20s - loss: 3.2224 - accuracy300: 0.4126 - val_loss: 3.4148 - val_accuracy300: 0.3392 - 20s/epoch - 16ms/step
testing model: results/WBA/W10/deepLOB_L1/h300
Evaluating performance on  test set...
6546/6546 - 34s - 34s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1149485
{'0': {'precision': 0.3496505726018313, 'recall': 0.09589958656583816, 'f1-score': 0.150516590175454, 'support': 571796}, '1': {'precision': 0.33633136937571473, 'recall': 0.46468408938909916, 'f1-score': 0.39022426946002403, 'support': 548747}, '2': {'precision': 0.33903320022398126, 'recall': 0.464547769737008, 'f1-score': 0.3919881702487227, 'support': 555226}, 'accuracy': 0.3388044533584283, 'macro avg': {'precision': 0.3416717140671757, 'recall': 0.3417104818973151, 'f1-score': 0.3109096766280669, 'support': 1675769}, 'weighted avg': {'precision': 0.3417712562947592, 'recall': 0.3388044533584283, 'f1-score': 0.30901705736522217, 'support': 1675769}}
[[ 54835 254189 262772]
 [ 53676 254994 240077]
 [ 48317 248980 257929]]
Evaluating performance on  train set...
1230/1230 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1141895
{'0': {'precision': 0.3705712716286734, 'recall': 0.24528027486661153, 'f1-score': 0.2951809535269119, 'support': 110017}, '1': {'precision': 0.3263144369222862, 'recall': 0.4106707902529739, 'f1-score': 0.3636648408692228, 'support': 98943}, '2': {'precision': 0.35114835347316253, 'recall': 0.3897079671108591, 'f1-score': 0.36942469729751526, 'support': 105810}, 'accuracy': 0.3458175810909553, 'macro avg': {'precision': 0.3493446873413741, 'recall': 0.34855301074348155, 'f1-score': 0.34275683056455003, 'support': 314770}, 'weighted avg': {'precision': 0.35013081362318155, 'recall': 0.3458175810909553, 'f1-score': 0.34166483634191275, 'support': 314770}}
[[26985 43134 39898]
 [22014 40633 36296]
 [23821 40754 41235]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.113502
{'0': {'precision': 0.34510286507635995, 'recall': 0.2879673512374934, 'f1-score': 0.313956826271673, 'support': 37980}, '1': {'precision': 0.35549647439602355, 'recall': 0.3934044567247422, 'f1-score': 0.37349104952515116, 'support': 39087}, '2': {'precision': 0.3379842544235716, 'recall': 0.35768691396045865, 'f1-score': 0.3475565768028429, 'support': 36367}, 'accuracy': 0.34665091595112574, 'macro avg': {'precision': 0.3461945312986517, 'recall': 0.3463529073075648, 'f1-score': 0.34500148419988896, 'support': 113434}, 'weighted avg': {'precision': 0.34640205662270174, 'recall': 0.34665091595112574, 'f1-score': 0.345243180555889, 'support': 113434}}
[[10937 14133 12910]
 [11141 15377 12569]
 [ 9614 13745 13008]]
training model: results/WBA/W10/deepLOB_L1/h500
Epoch 1/50
1230/1230 - 22s - loss: 3.2617 - accuracy500: 0.3990 - val_loss: 3.3302 - val_accuracy500: 0.3508 - 22s/epoch - 18ms/step
Epoch 2/50
1230/1230 - 20s - loss: 3.2350 - accuracy500: 0.4095 - val_loss: 3.3567 - val_accuracy500: 0.3397 - 20s/epoch - 17ms/step
Epoch 3/50
1230/1230 - 20s - loss: 3.2172 - accuracy500: 0.4214 - val_loss: 3.3201 - val_accuracy500: 0.3496 - 20s/epoch - 16ms/step
Epoch 4/50
1230/1230 - 20s - loss: 3.2017 - accuracy500: 0.4296 - val_loss: 3.3278 - val_accuracy500: 0.3573 - 20s/epoch - 16ms/step
Epoch 5/50
1230/1230 - 20s - loss: 3.1962 - accuracy500: 0.4309 - val_loss: 3.3470 - val_accuracy500: 0.3526 - 20s/epoch - 16ms/step
Epoch 6/50
1230/1230 - 20s - loss: 3.1935 - accuracy500: 0.4322 - val_loss: 3.3393 - val_accuracy500: 0.3474 - 20s/epoch - 16ms/step
Epoch 7/50
1230/1230 - 20s - loss: 3.1861 - accuracy500: 0.4346 - val_loss: 3.3298 - val_accuracy500: 0.3537 - 20s/epoch - 16ms/step
Epoch 8/50
1230/1230 - 20s - loss: 3.1781 - accuracy500: 0.4387 - val_loss: 3.3392 - val_accuracy500: 0.3559 - 20s/epoch - 16ms/step
Epoch 9/50
1230/1230 - 20s - loss: 3.1715 - accuracy500: 0.4420 - val_loss: 3.3501 - val_accuracy500: 0.3518 - 20s/epoch - 16ms/step
Epoch 10/50
1230/1230 - 20s - loss: 3.1649 - accuracy500: 0.4437 - val_loss: 3.3533 - val_accuracy500: 0.3487 - 20s/epoch - 17ms/step
Epoch 11/50
1230/1230 - 20s - loss: 3.1618 - accuracy500: 0.4447 - val_loss: 3.3626 - val_accuracy500: 0.3493 - 20s/epoch - 16ms/step
Epoch 12/50
1230/1230 - 20s - loss: 3.1559 - accuracy500: 0.4467 - val_loss: 3.3621 - val_accuracy500: 0.3552 - 20s/epoch - 16ms/step
Epoch 13/50
1230/1230 - 20s - loss: 3.1502 - accuracy500: 0.4490 - val_loss: 3.3676 - val_accuracy500: 0.3503 - 20s/epoch - 16ms/step
testing model: results/WBA/W10/deepLOB_L1/h500
Evaluating performance on  test set...
6546/6546 - 41s - 41s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1184077
{'0': {'precision': 0.35898411126614754, 'recall': 0.25670525831297536, 'f1-score': 0.29934935883601477, 'support': 621378}, '1': {'precision': 0.2828062248171731, 'recall': 0.19368833452906528, 'f1-score': 0.22991350312349831, 'support': 444637}, '2': {'precision': 0.3640325987748488, 'recall': 0.5533772636177868, 'f1-score': 0.4391654627568883, 'support': 609754}, 'accuracy': 0.34793339654809224, 'macro avg': {'precision': 0.33527431161938975, 'recall': 0.33459028548660913, 'f1-score': 0.3228094415721338, 'support': 1675769}, 'weighted avg': {'precision': 0.34060856460987693, 'recall': 0.34793339654809224, 'f1-score': 0.33179994006392993, 'support': 1675769}}
[[159511 108479 353388]
 [122422  86121 236094]
 [162407 109923 337424]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1064435
{'0': {'precision': 0.3466547592468557, 'recall': 0.2995828662783219, 'f1-score': 0.3214044564483457, 'support': 108838}, '1': {'precision': 0.377072406511818, 'recall': 0.27346737143704, 'f1-score': 0.3170198144542435, 'support': 101215}, '2': {'precision': 0.34236215768536243, 'recall': 0.4816027961076043, 'f1-score': 0.40021744047170293, 'support': 104717}, 'accuracy': 0.35173936525081806, 'macro avg': {'precision': 0.35536310781467867, 'recall': 0.3515510112743221, 'f1-score': 0.3462139037914307, 'support': 314770}, 'weighted avg': {'precision': 0.3550075686321474, 'recall': 0.35173936525081806, 'f1-score': 0.34621389733706076, 'support': 314770}}
[[32606 23607 52625]
 [29287 27679 44249]
 [32166 22119 50432]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1084261
{'0': {'precision': 0.34914460365974676, 'recall': 0.21915487343033685, 'f1-score': 0.26928316674065117, 'support': 40136}, '1': {'precision': 0.34624567758932984, 'recall': 0.24305736165294034, 'f1-score': 0.2856172640372175, 'support': 34605}, '2': {'precision': 0.3503416785250747, 'recall': 0.5790194608843977, 'f1-score': 0.4365464429765593, 'support': 38693}, 'accuracy': 0.3491986529611933, 'macro avg': {'precision': 0.3485773199247171, 'recall': 0.34707723198922497, 'f1-score': 0.330482291251476, 'support': 113434}, 'weighted avg': {'precision': 0.3486685654445498, 'recall': 0.3491986529611933, 'f1-score': 0.3313206456653446, 'support': 113434}}
[[ 8796  8217 23123]
 [ 7772  8411 18422]
 [ 8625  7664 22404]]
training model: results/WBA/W10/deepLOB_L1/h1000
Epoch 1/50
1230/1230 - 22s - loss: 3.2757 - accuracy1000: 0.3884 - val_loss: 3.3970 - val_accuracy1000: 0.3370 - 22s/epoch - 18ms/step
Epoch 2/50
1230/1230 - 20s - loss: 3.2338 - accuracy1000: 0.4042 - val_loss: 3.3482 - val_accuracy1000: 0.3617 - 20s/epoch - 16ms/step
Epoch 3/50
1230/1230 - 20s - loss: 3.2062 - accuracy1000: 0.4160 - val_loss: 3.3413 - val_accuracy1000: 0.3635 - 20s/epoch - 16ms/step
Epoch 4/50
1230/1230 - 20s - loss: 3.1951 - accuracy1000: 0.4267 - val_loss: 3.3469 - val_accuracy1000: 0.3603 - 20s/epoch - 16ms/step
Epoch 5/50
1230/1230 - 20s - loss: 3.1807 - accuracy1000: 0.4336 - val_loss: 3.3629 - val_accuracy1000: 0.3510 - 20s/epoch - 16ms/step
Epoch 6/50
1230/1230 - 20s - loss: 3.1697 - accuracy1000: 0.4394 - val_loss: 3.3887 - val_accuracy1000: 0.3498 - 20s/epoch - 16ms/step
Epoch 7/50
1230/1230 - 20s - loss: 3.1565 - accuracy1000: 0.4446 - val_loss: 3.3785 - val_accuracy1000: 0.3593 - 20s/epoch - 16ms/step
Epoch 8/50
1230/1230 - 20s - loss: 3.1564 - accuracy1000: 0.4461 - val_loss: 3.3911 - val_accuracy1000: 0.3701 - 20s/epoch - 17ms/step
Epoch 9/50
1230/1230 - 20s - loss: 3.1529 - accuracy1000: 0.4455 - val_loss: 3.3872 - val_accuracy1000: 0.3710 - 20s/epoch - 16ms/step
Epoch 10/50
1230/1230 - 20s - loss: 3.1443 - accuracy1000: 0.4492 - val_loss: 3.3735 - val_accuracy1000: 0.3635 - 20s/epoch - 16ms/step
Epoch 11/50
1230/1230 - 19s - loss: 3.1416 - accuracy1000: 0.4512 - val_loss: 3.3781 - val_accuracy1000: 0.3651 - 19s/epoch - 16ms/step
Epoch 12/50
1230/1230 - 20s - loss: 3.1303 - accuracy1000: 0.4550 - val_loss: 3.3967 - val_accuracy1000: 0.3587 - 20s/epoch - 16ms/step
Epoch 13/50
1230/1230 - 20s - loss: 3.1262 - accuracy1000: 0.4558 - val_loss: 3.4099 - val_accuracy1000: 0.3666 - 20s/epoch - 16ms/step
testing model: results/WBA/W10/deepLOB_L1/h1000
Evaluating performance on  test set...
6546/6546 - 34s - 34s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1268257
{'0': {'precision': 0.3224229157626822, 'recall': 0.0914560217503123, 'f1-score': 0.14249344203878533, 'support': 544360}, '1': {'precision': 0.3591954521366286, 'recall': 0.618429238076121, 'f1-score': 0.45444222513840526, 'support': 602803}, '2': {'precision': 0.30896775661310005, 'recall': 0.28260935365849044, 'f1-score': 0.2952013405578017, 'support': 528606}, 'accuracy': 0.34131494257263384, 'macro avg': {'precision': 0.3301953748374703, 'recall': 0.33083153782830793, 'f1-score': 0.2973790025783308, 'support': 1675769}, 'weighted avg': {'precision': 0.33140632420764093, 'recall': 0.34131494257263384, 'f1-score': 0.3028771069134448, 'support': 1675769}}
[[ 49785 331763 162812]
 [ 58703 372791 171309]
 [ 45921 333296 149389]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1273265
{'0': {'precision': 0.32016593685180916, 'recall': 0.13045478875752425, 'f1-score': 0.18537620347079978, 'support': 106489}, '1': {'precision': 0.34057825214189125, 'recall': 0.6836869839659594, 'f1-score': 0.45466527575630755, 'support': 106461}, '2': {'precision': 0.3333622349003763, 'recall': 0.1888037713612257, 'f1-score': 0.24107294011424127, 'support': 101820}, 'accuracy': 0.3364424818121168, 'macro avg': {'precision': 0.33136880796469226, 'recall': 0.33431518136156974, 'f1-score': 0.2937048064471162, 'support': 314770}, 'weighted avg': {'precision': 0.3313384201424739, 'recall': 0.3364424818121168, 'f1-score': 0.2944711796426797, 'support': 314770}}
[[13892 73087 19510]
 [14742 72786 18933]
 [14756 67840 19224]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1153864
{'0': {'precision': 0.3109895925207268, 'recall': 0.04860498456109396, 'f1-score': 0.08407047995994374, 'support': 36272}, '1': {'precision': 0.3843774168600155, 'recall': 0.6800188723755602, 'f1-score': 0.49114018946364063, 'support': 42390}, '2': {'precision': 0.3210765615940923, 'recall': 0.30259979293684575, 'f1-score': 0.31156448484669025, 'support': 34772}, 'accuracy': 0.36242220145635345, 'macro avg': {'precision': 0.3388145236582782, 'recall': 0.34374121662449997, 'f1-score': 0.29559171809009155, 'support': 113434}, 'weighted avg': {'precision': 0.341506491883894, 'recall': 0.36242220145635345, 'f1-score': 0.3059272999943572, 'support': 113434}}
[[ 1763 23525 10984]
 [ 2299 28826 11265]
 [ 1607 22643 10522]]
training model: results/WBA/W10/deepOF_L1/h10
Epoch 1/50
1230/1230 - 21s - loss: 3.1871 - accuracy10: 0.4172 - val_loss: 2.9519 - val_accuracy10: 0.5137 - 21s/epoch - 17ms/step
Epoch 2/50
1230/1230 - 19s - loss: 3.1458 - accuracy10: 0.4247 - val_loss: 2.9417 - val_accuracy10: 0.4429 - 19s/epoch - 15ms/step
Epoch 3/50
1230/1230 - 19s - loss: 3.1339 - accuracy10: 0.4272 - val_loss: 2.9382 - val_accuracy10: 0.4150 - 19s/epoch - 15ms/step
Epoch 4/50
1230/1230 - 19s - loss: 3.1212 - accuracy10: 0.4387 - val_loss: 2.9305 - val_accuracy10: 0.4221 - 19s/epoch - 15ms/step
Epoch 5/50
1230/1230 - 19s - loss: 3.1133 - accuracy10: 0.4414 - val_loss: 2.9270 - val_accuracy10: 0.4253 - 19s/epoch - 15ms/step
Epoch 6/50
1230/1230 - 19s - loss: 3.1033 - accuracy10: 0.4458 - val_loss: 2.9201 - val_accuracy10: 0.4299 - 19s/epoch - 15ms/step
Epoch 7/50
1230/1230 - 19s - loss: 3.0964 - accuracy10: 0.4458 - val_loss: 2.9123 - val_accuracy10: 0.4314 - 19s/epoch - 16ms/step
Epoch 8/50
1230/1230 - 19s - loss: 3.0874 - accuracy10: 0.4494 - val_loss: 2.9058 - val_accuracy10: 0.4570 - 19s/epoch - 15ms/step
Epoch 9/50
1230/1230 - 18s - loss: 3.0809 - accuracy10: 0.4527 - val_loss: 2.9022 - val_accuracy10: 0.4362 - 18s/epoch - 15ms/step
Epoch 10/50
1230/1230 - 19s - loss: 3.0740 - accuracy10: 0.4523 - val_loss: 2.8957 - val_accuracy10: 0.4669 - 19s/epoch - 15ms/step
Epoch 11/50
1230/1230 - 19s - loss: 3.0694 - accuracy10: 0.4537 - val_loss: 2.8955 - val_accuracy10: 0.4620 - 19s/epoch - 15ms/step
Epoch 12/50
1230/1230 - 18s - loss: 3.0610 - accuracy10: 0.4552 - val_loss: 2.8885 - val_accuracy10: 0.4901 - 18s/epoch - 15ms/step
Epoch 13/50
1230/1230 - 18s - loss: 3.0561 - accuracy10: 0.4562 - val_loss: 2.8860 - val_accuracy10: 0.5026 - 18s/epoch - 15ms/step
Epoch 14/50
1230/1230 - 18s - loss: 3.0503 - accuracy10: 0.4593 - val_loss: 2.8834 - val_accuracy10: 0.5237 - 18s/epoch - 15ms/step
Epoch 15/50
1230/1230 - 18s - loss: 3.0448 - accuracy10: 0.4596 - val_loss: 2.8793 - val_accuracy10: 0.5453 - 18s/epoch - 15ms/step
Epoch 16/50
1230/1230 - 19s - loss: 3.0385 - accuracy10: 0.4618 - val_loss: 2.8784 - val_accuracy10: 0.5408 - 19s/epoch - 16ms/step
Epoch 17/50
1230/1230 - 19s - loss: 3.0340 - accuracy10: 0.4636 - val_loss: 2.8760 - val_accuracy10: 0.5487 - 19s/epoch - 15ms/step
Epoch 18/50
1230/1230 - 19s - loss: 3.0268 - accuracy10: 0.4647 - val_loss: 2.8757 - val_accuracy10: 0.5533 - 19s/epoch - 15ms/step
Epoch 19/50
1230/1230 - 18s - loss: 3.0231 - accuracy10: 0.4650 - val_loss: 2.8750 - val_accuracy10: 0.5710 - 18s/epoch - 15ms/step
Epoch 20/50
1230/1230 - 19s - loss: 3.0183 - accuracy10: 0.4667 - val_loss: 2.8753 - val_accuracy10: 0.5770 - 19s/epoch - 15ms/step
Epoch 21/50
1230/1230 - 18s - loss: 3.0123 - accuracy10: 0.4686 - val_loss: 2.8784 - val_accuracy10: 0.5842 - 18s/epoch - 15ms/step
Epoch 22/50
1230/1230 - 18s - loss: 3.0083 - accuracy10: 0.4699 - val_loss: 2.8780 - val_accuracy10: 0.5835 - 18s/epoch - 15ms/step
Epoch 23/50
1230/1230 - 18s - loss: 3.0034 - accuracy10: 0.4712 - val_loss: 2.8816 - val_accuracy10: 0.5871 - 18s/epoch - 15ms/step
Epoch 24/50
1230/1230 - 18s - loss: 3.0001 - accuracy10: 0.4712 - val_loss: 2.8848 - val_accuracy10: 0.5912 - 18s/epoch - 15ms/step
Epoch 25/50
1230/1230 - 18s - loss: 2.9952 - accuracy10: 0.4729 - val_loss: 2.8898 - val_accuracy10: 0.5932 - 18s/epoch - 15ms/step
Epoch 26/50
1230/1230 - 17s - loss: 2.9900 - accuracy10: 0.4732 - val_loss: 2.8868 - val_accuracy10: 0.5927 - 17s/epoch - 14ms/step
Epoch 27/50
1230/1230 - 18s - loss: 2.9842 - accuracy10: 0.4740 - val_loss: 2.8856 - val_accuracy10: 0.6016 - 18s/epoch - 14ms/step
Epoch 28/50
1230/1230 - 18s - loss: 2.9809 - accuracy10: 0.4752 - val_loss: 2.8954 - val_accuracy10: 0.6019 - 18s/epoch - 15ms/step
Epoch 29/50
1230/1230 - 17s - loss: 2.9737 - accuracy10: 0.4762 - val_loss: 2.8982 - val_accuracy10: 0.5996 - 17s/epoch - 14ms/step
testing model: results/WBA/W10/deepOF_L1/h10
Evaluating performance on  test set...
6546/6546 - 48s - 48s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9819334
{'0': {'precision': 0.31498852865030974, 'recall': 0.29070012140833673, 'f1-score': 0.30235733660194, 'support': 308875}, '1': {'precision': 0.6719425011908955, 'recall': 0.6938787433882004, 'f1-score': 0.6827344650055517, 'support': 1061171}, '2': {'precision': 0.3042639339147891, 'recall': 0.2934894248948377, 'f1-score': 0.29877957409966527, 'support': 305718}, 'accuracy': 0.5465202737378294, 'macro avg': {'precision': 0.4303983212519982, 'recall': 0.4260227632304583, 'f1-score': 0.427957125235719, 'support': 1675764}, 'weighted avg': {'precision': 0.5390716945027281, 'recall': 0.5465202737378294, 'f1-score': 0.5425769566251167, 'support': 1675764}}
[[ 89790 183627  35458]
 [155138 736324 169709]
 [ 40130 175863  89725]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9811113
{'0': {'precision': 0.3362793198467639, 'recall': 0.3206292754041108, 'f1-score': 0.32826787603434565, 'support': 62421}, '1': {'precision': 0.6486289841434607, 'recall': 0.7010731942602194, 'f1-score': 0.6738321995464853, 'support': 190739}, '2': {'precision': 0.3593530382351144, 'recall': 0.28634268276847163, 'f1-score': 0.31872013297319757, 'support': 61608}, 'accuracy': 0.5444549636557718, 'macro avg': {'precision': 0.44808711407511304, 'recall': 0.43601505081093395, 'f1-score': 0.44027340285134287, 'support': 314768}, 'weighted avg': {'precision': 0.5300689943395877, 'recall': 0.5444549636557718, 'f1-score': 0.5357996967653945, 'support': 314768}}
[[ 20014  36194   6213]
 [ 31780 133722  25237]
 [  7722  36245  17641]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9604214
{'0': {'precision': 0.3102361505681818, 'recall': 0.35782305959451155, 'f1-score': 0.33233475986685684, 'support': 19532}, '1': {'precision': 0.71234336781405, 'recall': 0.6945295638039916, 'f1-score': 0.7033236867491011, 'support': 75058}, '2': {'precision': 0.32759690797269087, 'recall': 0.30814138626472776, 'f1-score': 0.3175714481061125, 'support': 18842}, 'accuracy': 0.5723693490373087, 'macro avg': {'precision': 0.45005880878497423, 'recall': 0.4534980032210769, 'f1-score': 0.4510766315740235, 'support': 113432}, 'weighted avg': {'precision': 0.5791944242745093, 'recall': 0.5723693490373087, 'f1-score': 0.5753659728731649, 'support': 113432}}
[[ 6989 10581  1962]
 [12973 52130  9955]
 [ 2566 10470  5806]]
training model: results/WBA/W10/deepOF_L1/h20
Epoch 1/50
1230/1230 - 21s - loss: 3.2130 - accuracy20: 0.4119 - val_loss: 3.0377 - val_accuracy20: 0.4750 - 21s/epoch - 17ms/step
Epoch 2/50
1230/1230 - 18s - loss: 3.1771 - accuracy20: 0.4167 - val_loss: 3.0410 - val_accuracy20: 0.3456 - 18s/epoch - 15ms/step
Epoch 3/50
1230/1230 - 18s - loss: 3.1631 - accuracy20: 0.4202 - val_loss: 3.0264 - val_accuracy20: 0.3810 - 18s/epoch - 15ms/step
Epoch 4/50
1230/1230 - 18s - loss: 3.1524 - accuracy20: 0.4267 - val_loss: 3.0253 - val_accuracy20: 0.3594 - 18s/epoch - 15ms/step
Epoch 5/50
1230/1230 - 18s - loss: 3.1436 - accuracy20: 0.4307 - val_loss: 3.0213 - val_accuracy20: 0.3553 - 18s/epoch - 15ms/step
Epoch 6/50
1230/1230 - 18s - loss: 3.1356 - accuracy20: 0.4333 - val_loss: 3.0146 - val_accuracy20: 0.3781 - 18s/epoch - 15ms/step
Epoch 7/50
1230/1230 - 18s - loss: 3.1274 - accuracy20: 0.4375 - val_loss: 3.0076 - val_accuracy20: 0.3767 - 18s/epoch - 15ms/step
Epoch 8/50
1230/1230 - 18s - loss: 3.1207 - accuracy20: 0.4400 - val_loss: 3.0087 - val_accuracy20: 0.3876 - 18s/epoch - 14ms/step
Epoch 9/50
1230/1230 - 18s - loss: 3.1134 - accuracy20: 0.4429 - val_loss: 2.9986 - val_accuracy20: 0.4022 - 18s/epoch - 15ms/step
Epoch 10/50
1230/1230 - 18s - loss: 3.1056 - accuracy20: 0.4462 - val_loss: 2.9932 - val_accuracy20: 0.4325 - 18s/epoch - 14ms/step
Epoch 11/50
1230/1230 - 18s - loss: 3.0999 - accuracy20: 0.4482 - val_loss: 2.9896 - val_accuracy20: 0.4481 - 18s/epoch - 15ms/step
Epoch 12/50
1230/1230 - 18s - loss: 3.0945 - accuracy20: 0.4512 - val_loss: 2.9870 - val_accuracy20: 0.4613 - 18s/epoch - 14ms/step
Epoch 13/50
1230/1230 - 17s - loss: 3.0872 - accuracy20: 0.4544 - val_loss: 2.9798 - val_accuracy20: 0.4813 - 17s/epoch - 14ms/step
Epoch 14/50
1230/1230 - 17s - loss: 3.0813 - accuracy20: 0.4564 - val_loss: 2.9820 - val_accuracy20: 0.4777 - 17s/epoch - 14ms/step
Epoch 15/50
1230/1230 - 17s - loss: 3.0748 - accuracy20: 0.4586 - val_loss: 2.9803 - val_accuracy20: 0.4989 - 17s/epoch - 14ms/step
Epoch 16/50
1230/1230 - 17s - loss: 3.0685 - accuracy20: 0.4612 - val_loss: 2.9809 - val_accuracy20: 0.5024 - 17s/epoch - 14ms/step
Epoch 17/50
1230/1230 - 17s - loss: 3.0639 - accuracy20: 0.4621 - val_loss: 2.9809 - val_accuracy20: 0.5074 - 17s/epoch - 14ms/step
Epoch 18/50
1230/1230 - 17s - loss: 3.0583 - accuracy20: 0.4641 - val_loss: 2.9808 - val_accuracy20: 0.5114 - 17s/epoch - 14ms/step
Epoch 19/50
1230/1230 - 17s - loss: 3.0534 - accuracy20: 0.4657 - val_loss: 2.9790 - val_accuracy20: 0.5273 - 17s/epoch - 14ms/step
Epoch 20/50
1230/1230 - 17s - loss: 3.0484 - accuracy20: 0.4667 - val_loss: 2.9808 - val_accuracy20: 0.5222 - 17s/epoch - 14ms/step
Epoch 21/50
1230/1230 - 17s - loss: 3.0431 - accuracy20: 0.4691 - val_loss: 2.9813 - val_accuracy20: 0.5228 - 17s/epoch - 14ms/step
Epoch 22/50
1230/1230 - 17s - loss: 3.0383 - accuracy20: 0.4713 - val_loss: 2.9851 - val_accuracy20: 0.5315 - 17s/epoch - 14ms/step
Epoch 23/50
1230/1230 - 17s - loss: 3.0320 - accuracy20: 0.4725 - val_loss: 2.9900 - val_accuracy20: 0.5401 - 17s/epoch - 14ms/step
Epoch 24/50
1230/1230 - 17s - loss: 3.0285 - accuracy20: 0.4735 - val_loss: 2.9908 - val_accuracy20: 0.5413 - 17s/epoch - 14ms/step
Epoch 25/50
1230/1230 - 17s - loss: 3.0240 - accuracy20: 0.4753 - val_loss: 2.9882 - val_accuracy20: 0.5446 - 17s/epoch - 14ms/step
Epoch 26/50
1230/1230 - 17s - loss: 3.0182 - accuracy20: 0.4767 - val_loss: 3.0000 - val_accuracy20: 0.5411 - 17s/epoch - 14ms/step
Epoch 27/50
1230/1230 - 17s - loss: 3.0134 - accuracy20: 0.4783 - val_loss: 2.9952 - val_accuracy20: 0.5413 - 17s/epoch - 13ms/step
Epoch 28/50
1230/1230 - 17s - loss: 3.0090 - accuracy20: 0.4805 - val_loss: 2.9978 - val_accuracy20: 0.5402 - 17s/epoch - 14ms/step
Epoch 29/50
1230/1230 - 17s - loss: 3.0051 - accuracy20: 0.4814 - val_loss: 3.0000 - val_accuracy20: 0.5467 - 17s/epoch - 14ms/step
testing model: results/WBA/W10/deepOF_L1/h20
Evaluating performance on  test set...
6546/6546 - 34s - 34s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0197575
{'0': {'precision': 0.358876560332871, 'recall': 0.26112361364806086, 'f1-score': 0.30229392900327706, 'support': 396364}, '1': {'precision': 0.5588027203422367, 'recall': 0.6895288046696557, 'f1-score': 0.6173209024743064, 'support': 886575}, '2': {'precision': 0.357357592779429, 'recall': 0.2668949277668173, 'f1-score': 0.3055716261372264, 'support': 392825}, 'accuracy': 0.4891273472875656, 'macro avg': {'precision': 0.42501229115151223, 'recall': 0.4058491153615113, 'f1-score': 0.40839548587160324, 'support': 1675764}, 'weighted avg': {'precision': 0.4642928641090128, 'recall': 0.4891273472875656, 'f1-score': 0.46972955859176413, 'support': 1675764}}
[[103500 247470  45394]
 [132109 611319 143147]
 [ 52791 235191 104843]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0182866
{'0': {'precision': 0.38965817441153766, 'recall': 0.29927080967880304, 'f1-score': 0.33853508865817544, 'support': 79266}, '1': {'precision': 0.5357768168935063, 'recall': 0.7038722057720901, 'f1-score': 0.6084277130271439, 'support': 157378}, '2': {'precision': 0.42110957886920547, 'recall': 0.2540704521017869, 'f1-score': 0.3169273265793277, 'support': 78124}, 'accuracy': 0.4903452701672343, 'macro avg': {'precision': 0.44884819005808313, 'recall': 0.41907115585089333, 'f1-score': 0.421296709421549, 'support': 314768}, 'weighted avg': {'precision': 0.4705208073296809, 'recall': 0.4903452701672343, 'f1-score': 0.46811330700721865, 'support': 314768}}
[[ 23722  48107   7437]
 [ 26755 110774  19849]
 [ 10402  47873  19849]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9907859
{'0': {'precision': 0.35424710424710426, 'recall': 0.32420494699646646, 'f1-score': 0.33856088560885605, 'support': 24904}, '1': {'precision': 0.6106906338694418, 'recall': 0.7033451115296608, 'f1-score': 0.65375127502116, 'support': 64243}, '2': {'precision': 0.3961561561561562, 'recall': 0.27160798847024914, 'f1-score': 0.3222670086722853, 'support': 24285}, 'accuracy': 0.5276729670639678, 'macro avg': {'precision': 0.4536979647575674, 'recall': 0.43305268233212546, 'f1-score': 0.4381930564341004, 'support': 113432}, 'weighted avg': {'precision': 0.5084581117153597, 'recall': 0.5276729670639678, 'f1-score': 0.5135827435114763, 'support': 113432}}
[[ 8074 14520  2310]
 [11314 45185  7744]
 [ 3404 14285  6596]]
training model: results/WBA/W10/deepOF_L1/h30
Epoch 1/50
1230/1230 - 21s - loss: 3.2343 - accuracy30: 0.4090 - val_loss: 3.1067 - val_accuracy30: 0.4433 - 21s/epoch - 17ms/step
Epoch 2/50
1230/1230 - 18s - loss: 3.2023 - accuracy30: 0.4129 - val_loss: 3.1254 - val_accuracy30: 0.3371 - 18s/epoch - 15ms/step
Epoch 3/50
1230/1230 - 18s - loss: 3.1889 - accuracy30: 0.4181 - val_loss: 3.1151 - val_accuracy30: 0.3554 - 18s/epoch - 14ms/step
Epoch 4/50
1230/1230 - 18s - loss: 3.1792 - accuracy30: 0.4241 - val_loss: 3.1101 - val_accuracy30: 0.3602 - 18s/epoch - 15ms/step
Epoch 5/50
1230/1230 - 18s - loss: 3.1710 - accuracy30: 0.4280 - val_loss: 3.1017 - val_accuracy30: 0.3592 - 18s/epoch - 15ms/step
Epoch 6/50
1230/1230 - 18s - loss: 3.1617 - accuracy30: 0.4318 - val_loss: 3.0970 - val_accuracy30: 0.3676 - 18s/epoch - 15ms/step
Epoch 7/50
1230/1230 - 18s - loss: 3.1535 - accuracy30: 0.4360 - val_loss: 3.0896 - val_accuracy30: 0.3835 - 18s/epoch - 14ms/step
Epoch 8/50
1230/1230 - 19s - loss: 3.1451 - accuracy30: 0.4398 - val_loss: 3.0816 - val_accuracy30: 0.3991 - 19s/epoch - 15ms/step
Epoch 9/50
1230/1230 - 20s - loss: 3.1376 - accuracy30: 0.4436 - val_loss: 3.0709 - val_accuracy30: 0.4197 - 20s/epoch - 16ms/step
Epoch 10/50
1230/1230 - 19s - loss: 3.1311 - accuracy30: 0.4463 - val_loss: 3.0630 - val_accuracy30: 0.4343 - 19s/epoch - 16ms/step
Epoch 11/50
1230/1230 - 20s - loss: 3.1235 - accuracy30: 0.4490 - val_loss: 3.0586 - val_accuracy30: 0.4534 - 20s/epoch - 17ms/step
Epoch 12/50
1230/1230 - 19s - loss: 3.1181 - accuracy30: 0.4516 - val_loss: 3.0547 - val_accuracy30: 0.4599 - 19s/epoch - 15ms/step
Epoch 13/50
1230/1230 - 19s - loss: 3.1107 - accuracy30: 0.4540 - val_loss: 3.0490 - val_accuracy30: 0.4760 - 19s/epoch - 16ms/step
Epoch 14/50
1230/1230 - 19s - loss: 3.1052 - accuracy30: 0.4553 - val_loss: 3.0490 - val_accuracy30: 0.4797 - 19s/epoch - 15ms/step
Epoch 15/50
1230/1230 - 19s - loss: 3.0991 - accuracy30: 0.4581 - val_loss: 3.0512 - val_accuracy30: 0.4854 - 19s/epoch - 15ms/step
Epoch 16/50
1230/1230 - 17s - loss: 3.0934 - accuracy30: 0.4605 - val_loss: 3.0511 - val_accuracy30: 0.4937 - 17s/epoch - 14ms/step
Epoch 17/50
1230/1230 - 18s - loss: 3.0893 - accuracy30: 0.4624 - val_loss: 3.0491 - val_accuracy30: 0.4947 - 18s/epoch - 15ms/step
Epoch 18/50
1230/1230 - 18s - loss: 3.0833 - accuracy30: 0.4647 - val_loss: 3.0522 - val_accuracy30: 0.5026 - 18s/epoch - 14ms/step
Epoch 19/50
1230/1230 - 17s - loss: 3.0788 - accuracy30: 0.4662 - val_loss: 3.0552 - val_accuracy30: 0.5044 - 17s/epoch - 14ms/step
Epoch 20/50
1230/1230 - 19s - loss: 3.0744 - accuracy30: 0.4681 - val_loss: 3.0613 - val_accuracy30: 0.5063 - 19s/epoch - 16ms/step
Epoch 21/50
1230/1230 - 20s - loss: 3.0694 - accuracy30: 0.4697 - val_loss: 3.0611 - val_accuracy30: 0.5125 - 20s/epoch - 16ms/step
Epoch 22/50
1230/1230 - 18s - loss: 3.0652 - accuracy30: 0.4716 - val_loss: 3.0537 - val_accuracy30: 0.5100 - 18s/epoch - 15ms/step
Epoch 23/50
1230/1230 - 17s - loss: 3.0589 - accuracy30: 0.4737 - val_loss: 3.0610 - val_accuracy30: 0.5108 - 17s/epoch - 14ms/step
Epoch 24/50
1230/1230 - 16s - loss: 3.0554 - accuracy30: 0.4747 - val_loss: 3.0676 - val_accuracy30: 0.5150 - 16s/epoch - 13ms/step
testing model: results/WBA/W10/deepOF_L1/h30
Evaluating performance on  test set...
6546/6546 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0498927
{'0': {'precision': 0.3810170453393867, 'recall': 0.28902164483148657, 'f1-score': 0.3287039234248974, 'support': 455305}, '1': {'precision': 0.4863593239110872, 'recall': 0.6199764091877, 'f1-score': 0.5450991018228802, 'support': 770639}, '2': {'precision': 0.37685864927377993, 'recall': 0.2915832999866613, 'f1-score': 0.32878154551892264, 'support': 449820}, 'accuracy': 0.44190649757364403, 'macro avg': {'precision': 0.4147450061747513, 'recall': 0.40019378466861594, 'f1-score': 0.4008615235889001, 'support': 1675764}, 'weighted avg': {'precision': 0.42834491399988156, 'recall': 0.44190649757364403, 'f1-score': 0.4282391084842361, 'support': 1675764}}
[[131593 257258  66454]
 [142440 477778 150421]
 [ 71340 247320 131160]]
Evaluating performance on  train set...
1230/1230 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0472693
{'0': {'precision': 0.4147179604174984, 'recall': 0.3221429679020003, 'f1-score': 0.3626151678739294, 'support': 90286}, '1': {'precision': 0.4625841064395509, 'recall': 0.6511638207871017, 'f1-score': 0.5409088121665543, 'support': 135459}, '2': {'precision': 0.4347511815401724, 'recall': 0.26349370387427967, 'f1-score': 0.3281204101330275, 'support': 89023}, 'accuracy': 0.447148375946729, 'macro avg': {'precision': 0.43735108279907386, 'recall': 0.4122668308544606, 'f1-score': 0.4105481300578371, 'support': 314768}, 'weighted avg': {'precision': 0.44098275772219586, 'recall': 0.447148375946729, 'f1-score': 0.4295871978892625, 'support': 314768}}
[[29085 50754 10447]
 [27202 88206 20051]
 [13845 51721 23457]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0240659
{'0': {'precision': 0.3804731909663543, 'recall': 0.34590404357846216, 'f1-score': 0.3623660240699418, 'support': 28638}, '1': {'precision': 0.5402319018584316, 'recall': 0.6500290293636412, 'f1-score': 0.590066278048391, 'support': 56839}, '2': {'precision': 0.40726124704025257, 'recall': 0.2768735467715972, 'f1-score': 0.32964224872231684, 'support': 27955}, 'accuracy': 0.48128394103956557, 'macro avg': {'precision': 0.4426554466216795, 'recall': 0.42426887323790013, 'f1-score': 0.4273581836135499, 'support': 113432}, 'weighted avg': {'precision': 0.4671276224842735, 'recall': 0.48128394103956557, 'f1-score': 0.46839837469444123, 'support': 113432}}
[[ 9906 15585  3147]
 [11774 36947  8118]
 [ 4356 15859  7740]]
training model: results/WBA/W10/deepOF_L1/h50
Epoch 1/50
1230/1230 - 19s - loss: 3.2598 - accuracy50: 0.3974 - val_loss: 3.2204 - val_accuracy50: 0.4117 - 19s/epoch - 15ms/step
Epoch 2/50
1230/1230 - 17s - loss: 3.2314 - accuracy50: 0.4065 - val_loss: 3.2420 - val_accuracy50: 0.3656 - 17s/epoch - 14ms/step
Epoch 3/50
1230/1230 - 17s - loss: 3.2214 - accuracy50: 0.4119 - val_loss: 3.2388 - val_accuracy50: 0.3657 - 17s/epoch - 14ms/step
Epoch 4/50
1230/1230 - 16s - loss: 3.2136 - accuracy50: 0.4151 - val_loss: 3.2357 - val_accuracy50: 0.3707 - 16s/epoch - 13ms/step
Epoch 5/50
1230/1230 - 17s - loss: 3.2078 - accuracy50: 0.4182 - val_loss: 3.2283 - val_accuracy50: 0.3762 - 17s/epoch - 13ms/step
Epoch 6/50
1230/1230 - 17s - loss: 3.2004 - accuracy50: 0.4226 - val_loss: 3.2260 - val_accuracy50: 0.3794 - 17s/epoch - 13ms/step
Epoch 7/50
1230/1230 - 16s - loss: 3.1932 - accuracy50: 0.4250 - val_loss: 3.2246 - val_accuracy50: 0.3801 - 16s/epoch - 13ms/step
Epoch 8/50
1230/1230 - 17s - loss: 3.1877 - accuracy50: 0.4283 - val_loss: 3.2156 - val_accuracy50: 0.3850 - 17s/epoch - 14ms/step
Epoch 9/50
1230/1230 - 17s - loss: 3.1815 - accuracy50: 0.4324 - val_loss: 3.2138 - val_accuracy50: 0.3884 - 17s/epoch - 14ms/step
Epoch 10/50
1230/1230 - 16s - loss: 3.1749 - accuracy50: 0.4350 - val_loss: 3.2035 - val_accuracy50: 0.3965 - 16s/epoch - 13ms/step
Epoch 11/50
1230/1230 - 16s - loss: 3.1676 - accuracy50: 0.4379 - val_loss: 3.1997 - val_accuracy50: 0.4022 - 16s/epoch - 13ms/step
Epoch 12/50
1230/1230 - 17s - loss: 3.1618 - accuracy50: 0.4407 - val_loss: 3.1931 - val_accuracy50: 0.4068 - 17s/epoch - 13ms/step
Epoch 13/50
1230/1230 - 17s - loss: 3.1563 - accuracy50: 0.4436 - val_loss: 3.1892 - val_accuracy50: 0.4121 - 17s/epoch - 13ms/step
Epoch 14/50
1230/1230 - 16s - loss: 3.1497 - accuracy50: 0.4458 - val_loss: 3.1822 - val_accuracy50: 0.4186 - 16s/epoch - 13ms/step
Epoch 15/50
1230/1230 - 17s - loss: 3.1449 - accuracy50: 0.4481 - val_loss: 3.1772 - val_accuracy50: 0.4224 - 17s/epoch - 14ms/step
Epoch 16/50
1230/1230 - 16s - loss: 3.1398 - accuracy50: 0.4493 - val_loss: 3.1757 - val_accuracy50: 0.4274 - 16s/epoch - 13ms/step
Epoch 17/50
1230/1230 - 17s - loss: 3.1344 - accuracy50: 0.4524 - val_loss: 3.1723 - val_accuracy50: 0.4331 - 17s/epoch - 13ms/step
Epoch 18/50
1230/1230 - 17s - loss: 3.1307 - accuracy50: 0.4542 - val_loss: 3.1718 - val_accuracy50: 0.4336 - 17s/epoch - 14ms/step
Epoch 19/50
1230/1230 - 18s - loss: 3.1258 - accuracy50: 0.4553 - val_loss: 3.1647 - val_accuracy50: 0.4389 - 18s/epoch - 14ms/step
Epoch 20/50
1230/1230 - 17s - loss: 3.1216 - accuracy50: 0.4570 - val_loss: 3.1674 - val_accuracy50: 0.4397 - 17s/epoch - 14ms/step
Epoch 21/50
1230/1230 - 17s - loss: 3.1169 - accuracy50: 0.4593 - val_loss: 3.1638 - val_accuracy50: 0.4404 - 17s/epoch - 13ms/step
Epoch 22/50
1230/1230 - 16s - loss: 3.1126 - accuracy50: 0.4609 - val_loss: 3.1655 - val_accuracy50: 0.4436 - 16s/epoch - 13ms/step
Epoch 23/50
1230/1230 - 17s - loss: 3.1087 - accuracy50: 0.4620 - val_loss: 3.1674 - val_accuracy50: 0.4452 - 17s/epoch - 13ms/step
Epoch 24/50
1230/1230 - 16s - loss: 3.1052 - accuracy50: 0.4635 - val_loss: 3.1713 - val_accuracy50: 0.4414 - 16s/epoch - 13ms/step
Epoch 25/50
1230/1230 - 17s - loss: 3.1013 - accuracy50: 0.4636 - val_loss: 3.1726 - val_accuracy50: 0.4438 - 17s/epoch - 13ms/step
Epoch 26/50
1230/1230 - 16s - loss: 3.0967 - accuracy50: 0.4661 - val_loss: 3.1794 - val_accuracy50: 0.4468 - 16s/epoch - 13ms/step
Epoch 27/50
1230/1230 - 17s - loss: 3.0929 - accuracy50: 0.4679 - val_loss: 3.1783 - val_accuracy50: 0.4459 - 17s/epoch - 14ms/step
Epoch 28/50
1230/1230 - 17s - loss: 3.0898 - accuracy50: 0.4689 - val_loss: 3.1786 - val_accuracy50: 0.4486 - 17s/epoch - 14ms/step
Epoch 29/50
1230/1230 - 17s - loss: 3.0862 - accuracy50: 0.4703 - val_loss: 3.1843 - val_accuracy50: 0.4454 - 17s/epoch - 14ms/step
Epoch 30/50
1230/1230 - 16s - loss: 3.0810 - accuracy50: 0.4725 - val_loss: 3.1882 - val_accuracy50: 0.4467 - 16s/epoch - 13ms/step
Epoch 31/50
1230/1230 - 17s - loss: 3.0766 - accuracy50: 0.4743 - val_loss: 3.1911 - val_accuracy50: 0.4463 - 17s/epoch - 14ms/step
testing model: results/WBA/W10/deepOF_L1/h50
Evaluating performance on  test set...
6546/6546 - 34s - 34s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0781918
{'0': {'precision': 0.425304501722873, 'recall': 0.23005640536631514, 'f1-score': 0.29859585396100025, 'support': 531687}, '1': {'precision': 0.3887431263187747, 'recall': 0.701207447373247, 'f1-score': 0.5001870394297477, 'support': 621642}, '2': {'precision': 0.42988192177833073, 'recall': 0.21958138332998364, 'f1-score': 0.2906832959158334, 'support': 522435}, 'accuracy': 0.4015690753590601, 'macro avg': {'precision': 0.41464318327332617, 'recall': 0.3836150786898486, 'f1-score': 0.36315539643552713, 'support': 1675764}, 'weighted avg': {'precision': 0.41316873434615325, 'recall': 0.4015690753590601, 'f1-score': 0.37091137718195283, 'support': 1675764}}
[[122318 348333  61036]
 [ 94638 435900  91104]
 [ 70645 337073 114717]]
Evaluating performance on  train set...
1230/1230 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0777248
{'0': {'precision': 0.4701764496499822, 'recall': 0.26468764014923807, 'f1-score': 0.3387017997997509, 'support': 104799}, '1': {'precision': 0.362187355965046, 'recall': 0.72001982160555, 'f1-score': 0.4819448268956368, 'support': 106954}, '2': {'precision': 0.49071820899673224, 'recall': 0.20554288210454788, 'f1-score': 0.2897293451191812, 'support': 103015}, 'accuracy': 0.4000470187566716, 'macro avg': {'precision': 0.4410273382039202, 'recall': 0.39675011461977866, 'f1-score': 0.37012532393818964, 'support': 314768}, 'weighted avg': {'precision': 0.44020594379527894, 'recall': 0.4000470187566716, 'f1-score': 0.37134653274939794, 'support': 314768}}
[[27739 67296  9764]
 [17734 77009 12211]
 [13524 68317 21174]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0548048
{'0': {'precision': 0.43234038884338494, 'recall': 0.296452852497783, 'f1-score': 0.3517281287811037, 'support': 33830}, '1': {'precision': 0.43952979478557896, 'recall': 0.705616485305458, 'f1-score': 0.541659130148812, 'support': 46684}, '2': {'precision': 0.4571260383282098, 'recall': 0.21231545051339692, 'f1-score': 0.28995788993299726, 'support': 32918}, 'accuracy': 0.4404312715988434, 'macro avg': {'precision': 0.44299874065239125, 'recall': 0.4047949294388793, 'f1-score': 0.39444838295430434, 'support': 113432}, 'weighted avg': {'precision': 0.44249205889016935, 'recall': 0.4404312715988434, 'f1-score': 0.4119702663211993, 'support': 113432}}
[[10029 20770  3031]
 [ 8474 32941  5269]
 [ 4694 21235  6989]]
training model: results/WBA/W10/deepOF_L1/h100
Epoch 1/50
1230/1230 - 19s - loss: 3.2868 - accuracy100: 0.3778 - val_loss: 3.2677 - val_accuracy100: 0.3858 - 19s/epoch - 16ms/step
Epoch 2/50
1230/1230 - 17s - loss: 3.2631 - accuracy100: 0.3866 - val_loss: 3.2598 - val_accuracy100: 0.3901 - 17s/epoch - 14ms/step
Epoch 3/50
1230/1230 - 17s - loss: 3.2554 - accuracy100: 0.3900 - val_loss: 3.2570 - val_accuracy100: 0.3906 - 17s/epoch - 14ms/step
Epoch 4/50
1230/1230 - 18s - loss: 3.2511 - accuracy100: 0.3933 - val_loss: 3.2551 - val_accuracy100: 0.3905 - 18s/epoch - 14ms/step
Epoch 5/50
1230/1230 - 17s - loss: 3.2467 - accuracy100: 0.3960 - val_loss: 3.2508 - val_accuracy100: 0.3941 - 17s/epoch - 14ms/step
Epoch 6/50
1230/1230 - 17s - loss: 3.2438 - accuracy100: 0.3979 - val_loss: 3.2508 - val_accuracy100: 0.3933 - 17s/epoch - 14ms/step
Epoch 7/50
1230/1230 - 17s - loss: 3.2402 - accuracy100: 0.4000 - val_loss: 3.2491 - val_accuracy100: 0.3922 - 17s/epoch - 14ms/step
Epoch 8/50
1230/1230 - 17s - loss: 3.2380 - accuracy100: 0.4011 - val_loss: 3.2470 - val_accuracy100: 0.3958 - 17s/epoch - 14ms/step
Epoch 9/50
1230/1230 - 17s - loss: 3.2353 - accuracy100: 0.4039 - val_loss: 3.2448 - val_accuracy100: 0.3938 - 17s/epoch - 14ms/step
Epoch 10/50
1230/1230 - 17s - loss: 3.2325 - accuracy100: 0.4049 - val_loss: 3.2441 - val_accuracy100: 0.3937 - 17s/epoch - 14ms/step
Epoch 11/50
1230/1230 - 17s - loss: 3.2302 - accuracy100: 0.4057 - val_loss: 3.2427 - val_accuracy100: 0.3957 - 17s/epoch - 14ms/step
Epoch 12/50
1230/1230 - 17s - loss: 3.2277 - accuracy100: 0.4075 - val_loss: 3.2445 - val_accuracy100: 0.3936 - 17s/epoch - 14ms/step
Epoch 13/50
1230/1230 - 17s - loss: 3.2261 - accuracy100: 0.4093 - val_loss: 3.2433 - val_accuracy100: 0.3942 - 17s/epoch - 14ms/step
Epoch 14/50
1230/1230 - 17s - loss: 3.2232 - accuracy100: 0.4105 - val_loss: 3.2438 - val_accuracy100: 0.3928 - 17s/epoch - 14ms/step
Epoch 15/50
1230/1230 - 18s - loss: 3.2212 - accuracy100: 0.4115 - val_loss: 3.2409 - val_accuracy100: 0.3955 - 18s/epoch - 15ms/step
Epoch 16/50
1230/1230 - 20s - loss: 3.2189 - accuracy100: 0.4129 - val_loss: 3.2405 - val_accuracy100: 0.3955 - 20s/epoch - 16ms/step
Epoch 17/50
1230/1230 - 20s - loss: 3.2170 - accuracy100: 0.4145 - val_loss: 3.2399 - val_accuracy100: 0.3949 - 20s/epoch - 16ms/step
Epoch 18/50
1230/1230 - 17s - loss: 3.2147 - accuracy100: 0.4159 - val_loss: 3.2406 - val_accuracy100: 0.3945 - 17s/epoch - 14ms/step
Epoch 19/50
1230/1230 - 17s - loss: 3.2115 - accuracy100: 0.4175 - val_loss: 3.2390 - val_accuracy100: 0.3965 - 17s/epoch - 14ms/step
Epoch 20/50
1230/1230 - 17s - loss: 3.2098 - accuracy100: 0.4188 - val_loss: 3.2379 - val_accuracy100: 0.3959 - 17s/epoch - 14ms/step
Epoch 21/50
1230/1230 - 17s - loss: 3.2078 - accuracy100: 0.4195 - val_loss: 3.2411 - val_accuracy100: 0.3948 - 17s/epoch - 14ms/step
Epoch 22/50
1230/1230 - 18s - loss: 3.2052 - accuracy100: 0.4217 - val_loss: 3.2413 - val_accuracy100: 0.3946 - 18s/epoch - 14ms/step
Epoch 23/50
1230/1230 - 17s - loss: 3.2031 - accuracy100: 0.4223 - val_loss: 3.2403 - val_accuracy100: 0.3965 - 17s/epoch - 14ms/step
Epoch 24/50
1230/1230 - 17s - loss: 3.2005 - accuracy100: 0.4241 - val_loss: 3.2439 - val_accuracy100: 0.3940 - 17s/epoch - 14ms/step
Epoch 25/50
1230/1230 - 17s - loss: 3.1972 - accuracy100: 0.4265 - val_loss: 3.2436 - val_accuracy100: 0.3949 - 17s/epoch - 14ms/step
Epoch 26/50
1230/1230 - 17s - loss: 3.1946 - accuracy100: 0.4270 - val_loss: 3.2451 - val_accuracy100: 0.3947 - 17s/epoch - 13ms/step
Epoch 27/50
1230/1230 - 17s - loss: 3.1923 - accuracy100: 0.4292 - val_loss: 3.2509 - val_accuracy100: 0.3914 - 17s/epoch - 14ms/step
Epoch 28/50
1230/1230 - 17s - loss: 3.1899 - accuracy100: 0.4301 - val_loss: 3.2492 - val_accuracy100: 0.3937 - 17s/epoch - 14ms/step
Epoch 29/50
1230/1230 - 17s - loss: 3.1872 - accuracy100: 0.4317 - val_loss: 3.2493 - val_accuracy100: 0.3936 - 17s/epoch - 14ms/step
Epoch 30/50
1230/1230 - 17s - loss: 3.1839 - accuracy100: 0.4330 - val_loss: 3.2574 - val_accuracy100: 0.3903 - 17s/epoch - 14ms/step
testing model: results/WBA/W10/deepOF_L1/h100
Evaluating performance on  test set...
6546/6546 - 35s - 35s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0903598
{'0': {'precision': 0.41238504060643866, 'recall': 0.24193821703358115, 'f1-score': 0.30496150118672016, 'support': 554716}, '1': {'precision': 0.35041253346233237, 'recall': 0.6315410132166241, 'f1-score': 0.4507339215282822, 'support': 575790}, '2': {'precision': 0.4092050583993679, 'recall': 0.23459169787513434, 'f1-score': 0.2982186800210294, 'support': 545258}, 'accuracy': 0.3734147529127013, 'macro avg': {'precision': 0.3906675441560463, 'recall': 0.36935697604177986, 'f1-score': 0.35130470091201055, 'support': 1675764}, 'weighted avg': {'precision': 0.39005668134656196, 'recall': 0.3734147529127013, 'f1-score': 0.35285471569980537, 'support': 1675764}}
[[134207 339059  81450]
 [108929 363635 103226]
 [ 82305 335040 127913]]
Evaluating performance on  train set...
1230/1230 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0872176
{'0': {'precision': 0.4450666211667623, 'recall': 0.26607010385756674, 'f1-score': 0.33304122245500817, 'support': 107840}, '1': {'precision': 0.33309827127183905, 'recall': 0.6422736991457371, 'f1-score': 0.4386844513836546, 'support': 101491}, '2': {'precision': 0.4440171409735194, 'recall': 0.22995722564185248, 'f1-score': 0.302993570477934, 'support': 105437}, 'accuracy': 0.3752732170995781, 'macro avg': {'precision': 0.40739401113737356, 'recall': 0.3794336762150521, 'f1-score': 0.3582397481055322, 'support': 314768}, 'weighted avg': {'precision': 0.40861299868188267, 'recall': 0.3752732170995781, 'f1-score': 0.3570389054014655, 'support': 314768}}
[[28693 65278 13869]
 [19815 65185 16491]
 [15961 65230 24246]]
Evaluating performance on  val set...
444/444 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0786542
{'0': {'precision': 0.4128779242099503, 'recall': 0.25053266554138187, 'f1-score': 0.31184128952262863, 'support': 36139}, '1': {'precision': 0.3820204508032267, 'recall': 0.6559359483024875, 'f1-score': 0.48283520749899445, 'support': 42091}, '2': {'precision': 0.4262687188019967, 'recall': 0.23288449519913643, 'f1-score': 0.3012088033214535, 'support': 35202}, 'accuracy': 0.3954880457013894, 'macro avg': {'precision': 0.40705569793839125, 'recall': 0.37978436968100193, 'f1-score': 0.3652951001143589, 'support': 113432}, 'weighted avg': {'precision': 0.4055833410065052, 'recall': 0.3954880457013894, 'f1-score': 0.37199204259309765, 'support': 113432}}
[[ 9054 22652  4433]
 [ 7881 27609  6601]
 [ 4994 22010  8198]]
training model: results/WBA/W10/deepOF_L1/h200
Epoch 1/50
1230/1230 - 20s - loss: 3.3027 - accuracy200: 0.3591 - val_loss: 3.2791 - val_accuracy200: 0.3731 - 20s/epoch - 16ms/step
Epoch 2/50
1230/1230 - 18s - loss: 3.2834 - accuracy200: 0.3653 - val_loss: 3.2731 - val_accuracy200: 0.3726 - 18s/epoch - 14ms/step
Epoch 3/50
1230/1230 - 17s - loss: 3.2771 - accuracy200: 0.3693 - val_loss: 3.2688 - val_accuracy200: 0.3747 - 17s/epoch - 14ms/step
Epoch 4/50
1230/1230 - 17s - loss: 3.2739 - accuracy200: 0.3709 - val_loss: 3.2680 - val_accuracy200: 0.3743 - 17s/epoch - 14ms/step
Epoch 5/50
1230/1230 - 17s - loss: 3.2713 - accuracy200: 0.3734 - val_loss: 3.2672 - val_accuracy200: 0.3706 - 17s/epoch - 14ms/step
Epoch 6/50
1230/1230 - 17s - loss: 3.2697 - accuracy200: 0.3740 - val_loss: 3.2681 - val_accuracy200: 0.3690 - 17s/epoch - 14ms/step
Epoch 7/50
1230/1230 - 17s - loss: 3.2685 - accuracy200: 0.3745 - val_loss: 3.2672 - val_accuracy200: 0.3693 - 17s/epoch - 14ms/step
Epoch 8/50
1230/1230 - 17s - loss: 3.2668 - accuracy200: 0.3765 - val_loss: 3.2672 - val_accuracy200: 0.3671 - 17s/epoch - 14ms/step
Epoch 9/50
1230/1230 - 17s - loss: 3.2661 - accuracy200: 0.3764 - val_loss: 3.2655 - val_accuracy200: 0.3697 - 17s/epoch - 14ms/step
Epoch 10/50
1230/1230 - 17s - loss: 3.2637 - accuracy200: 0.3786 - val_loss: 3.2656 - val_accuracy200: 0.3707 - 17s/epoch - 14ms/step
Epoch 11/50
1230/1230 - 17s - loss: 3.2630 - accuracy200: 0.3787 - val_loss: 3.2639 - val_accuracy200: 0.3703 - 17s/epoch - 14ms/step
Epoch 12/50
1230/1230 - 17s - loss: 3.2618 - accuracy200: 0.3799 - val_loss: 3.2655 - val_accuracy200: 0.3688 - 17s/epoch - 14ms/step
Epoch 13/50
1230/1230 - 17s - loss: 3.2601 - accuracy200: 0.3807 - val_loss: 3.2646 - val_accuracy200: 0.3719 - 17s/epoch - 14ms/step
Epoch 14/50
1230/1230 - 19s - loss: 3.2596 - accuracy200: 0.3814 - val_loss: 3.2650 - val_accuracy200: 0.3686 - 19s/epoch - 15ms/step
Epoch 15/50
1230/1230 - 18s - loss: 3.2583 - accuracy200: 0.3823 - val_loss: 3.2654 - val_accuracy200: 0.3712 - 18s/epoch - 15ms/step
Epoch 16/50
1230/1230 - 17s - loss: 3.2564 - accuracy200: 0.3844 - val_loss: 3.2642 - val_accuracy200: 0.3703 - 17s/epoch - 14ms/step
Epoch 17/50
1230/1230 - 17s - loss: 3.2558 - accuracy200: 0.3848 - val_loss: 3.2648 - val_accuracy200: 0.3700 - 17s/epoch - 14ms/step
Epoch 18/50
1230/1230 - 17s - loss: 3.2543 - accuracy200: 0.3861 - val_loss: 3.2649 - val_accuracy200: 0.3707 - 17s/epoch - 14ms/step
Epoch 19/50
1230/1230 - 17s - loss: 3.2528 - accuracy200: 0.3871 - val_loss: 3.2641 - val_accuracy200: 0.3711 - 17s/epoch - 14ms/step
Epoch 20/50
1230/1230 - 17s - loss: 3.2513 - accuracy200: 0.3882 - val_loss: 3.2658 - val_accuracy200: 0.3683 - 17s/epoch - 14ms/step
Epoch 21/50
1230/1230 - 17s - loss: 3.2504 - accuracy200: 0.3885 - val_loss: 3.2667 - val_accuracy200: 0.3667 - 17s/epoch - 14ms/step
testing model: results/WBA/W10/deepOF_L1/h200
Evaluating performance on  test set...
6546/6546 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0928136
{'0': {'precision': 0.36242820489444005, 'recall': 0.2560668131609265, 'f1-score': 0.3001021276412182, 'support': 543366}, '1': {'precision': 0.3622925504392102, 'recall': 0.5968783843624006, 'f1-score': 0.45089896769529625, 'support': 602957}, '2': {'precision': 0.3622929125416688, 'recall': 0.204251276346184, 'f1-score': 0.2612286605324631, 'support': 529441}, 'accuracy': 0.36232369235763506, 'macro avg': {'precision': 0.362337889291773, 'recall': 0.35239882462317035, 'f1-score': 0.3374099186229926, 'support': 1675764}, 'weighted avg': {'precision': 0.3623366507603821, 'recall': 0.36232369235763506, 'f1-score': 0.34207868459611185, 'support': 1675764}}
[[139138 319250  84978]
 [137697 359892 105368]
 [107070 314232 108139]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0917442
{'0': {'precision': 0.38047705288576283, 'recall': 0.2559088205021671, 'f1-score': 0.3060012420256309, 'support': 105901}, '1': {'precision': 0.3461654313284637, 'recall': 0.6022947413736629, 'f1-score': 0.43964654486332133, 'support': 106853}, '2': {'precision': 0.38150108459869847, 'recall': 0.215499833356206, 'f1-score': 0.27542141957792265, 'support': 102014}, 'accuracy': 0.3603987698876633, 'macro avg': {'precision': 0.36938118960430827, 'recall': 0.357901131744012, 'f1-score': 0.34035640215562496, 'support': 314768}, 'weighted avg': {'precision': 0.36916130882315584, 'recall': 0.3603987698876633, 'f1-score': 0.341458567855878, 'support': 314768}}
[[27101 62334 16466]
 [23321 64357 19175]
 [20807 59223 21984]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0887697
{'0': {'precision': 0.3595663433261643, 'recall': 0.2274355201421472, 'f1-score': 0.27862997857215743, 'support': 36019}, '1': {'precision': 0.3784303084527494, 'recall': 0.6029961671496681, 'f1-score': 0.4650211324087341, 'support': 42788}, '2': {'precision': 0.3575878949710725, 'recall': 0.23205776173285197, 'f1-score': 0.28146072335581046, 'support': 34625}, 'accuracy': 0.3705127300938007, 'macro avg': {'precision': 0.36519484891666204, 'recall': 0.3541631496748891, 'f1-score': 0.3417039447789007, 'support': 113432}, 'weighted avg': {'precision': 0.36607815274097905, 'recall': 0.3705127300938007, 'f1-score': 0.3498031856785598, 'support': 113432}}
[[ 8192 21727  6100]
 [ 8652 25801  8335]
 [ 5939 20651  8035]]
training model: results/WBA/W10/deepOF_L1/h300
Epoch 1/50
1230/1230 - 19s - loss: 3.3098 - accuracy300: 0.3539 - val_loss: 3.2996 - val_accuracy300: 0.3466 - 19s/epoch - 16ms/step
Epoch 2/50
1230/1230 - 17s - loss: 3.2916 - accuracy300: 0.3595 - val_loss: 3.2930 - val_accuracy300: 0.3457 - 17s/epoch - 14ms/step
Epoch 3/50
1230/1230 - 18s - loss: 3.2861 - accuracy300: 0.3615 - val_loss: 3.2907 - val_accuracy300: 0.3490 - 18s/epoch - 14ms/step
Epoch 4/50
1230/1230 - 18s - loss: 3.2833 - accuracy300: 0.3638 - val_loss: 3.2892 - val_accuracy300: 0.3477 - 18s/epoch - 14ms/step
Epoch 5/50
1230/1230 - 18s - loss: 3.2817 - accuracy300: 0.3651 - val_loss: 3.2876 - val_accuracy300: 0.3513 - 18s/epoch - 14ms/step
Epoch 6/50
1230/1230 - 18s - loss: 3.2801 - accuracy300: 0.3666 - val_loss: 3.2875 - val_accuracy300: 0.3518 - 18s/epoch - 14ms/step
Epoch 7/50
1230/1230 - 17s - loss: 3.2784 - accuracy300: 0.3676 - val_loss: 3.2875 - val_accuracy300: 0.3527 - 17s/epoch - 14ms/step
Epoch 8/50
1230/1230 - 17s - loss: 3.2776 - accuracy300: 0.3694 - val_loss: 3.2873 - val_accuracy300: 0.3529 - 17s/epoch - 14ms/step
Epoch 9/50
1230/1230 - 17s - loss: 3.2773 - accuracy300: 0.3691 - val_loss: 3.2865 - val_accuracy300: 0.3530 - 17s/epoch - 14ms/step
Epoch 10/50
1230/1230 - 17s - loss: 3.2759 - accuracy300: 0.3709 - val_loss: 3.2866 - val_accuracy300: 0.3530 - 17s/epoch - 14ms/step
Epoch 11/50
1230/1230 - 17s - loss: 3.2750 - accuracy300: 0.3712 - val_loss: 3.2864 - val_accuracy300: 0.3565 - 17s/epoch - 14ms/step
Epoch 12/50
1230/1230 - 17s - loss: 3.2746 - accuracy300: 0.3717 - val_loss: 3.2869 - val_accuracy300: 0.3551 - 17s/epoch - 14ms/step
Epoch 13/50
1230/1230 - 18s - loss: 3.2733 - accuracy300: 0.3734 - val_loss: 3.2859 - val_accuracy300: 0.3561 - 18s/epoch - 14ms/step
Epoch 14/50
1230/1230 - 17s - loss: 3.2727 - accuracy300: 0.3736 - val_loss: 3.2864 - val_accuracy300: 0.3538 - 17s/epoch - 14ms/step
Epoch 15/50
1230/1230 - 17s - loss: 3.2716 - accuracy300: 0.3741 - val_loss: 3.2864 - val_accuracy300: 0.3554 - 17s/epoch - 14ms/step
Epoch 16/50
1230/1230 - 17s - loss: 3.2706 - accuracy300: 0.3754 - val_loss: 3.2868 - val_accuracy300: 0.3538 - 17s/epoch - 14ms/step
Epoch 17/50
1230/1230 - 17s - loss: 3.2701 - accuracy300: 0.3758 - val_loss: 3.2872 - val_accuracy300: 0.3553 - 17s/epoch - 14ms/step
Epoch 18/50
1230/1230 - 17s - loss: 3.2695 - accuracy300: 0.3765 - val_loss: 3.2859 - val_accuracy300: 0.3566 - 17s/epoch - 14ms/step
Epoch 19/50
1230/1230 - 17s - loss: 3.2683 - accuracy300: 0.3780 - val_loss: 3.2861 - val_accuracy300: 0.3552 - 17s/epoch - 14ms/step
Epoch 20/50
1230/1230 - 17s - loss: 3.2676 - accuracy300: 0.3785 - val_loss: 3.2875 - val_accuracy300: 0.3547 - 17s/epoch - 14ms/step
Epoch 21/50
1230/1230 - 19s - loss: 3.2666 - accuracy300: 0.3793 - val_loss: 3.2879 - val_accuracy300: 0.3550 - 19s/epoch - 16ms/step
Epoch 22/50
1230/1230 - 20s - loss: 3.2656 - accuracy300: 0.3802 - val_loss: 3.2873 - val_accuracy300: 0.3551 - 20s/epoch - 16ms/step
Epoch 23/50
1230/1230 - 19s - loss: 3.2642 - accuracy300: 0.3817 - val_loss: 3.2882 - val_accuracy300: 0.3549 - 19s/epoch - 15ms/step
testing model: results/WBA/W10/deepOF_L1/h300
Evaluating performance on  test set...
6546/6546 - 34s - 34s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0981543
{'0': {'precision': 0.3740000760858664, 'recall': 0.1891261348075265, 'f1-score': 0.25121611262108856, 'support': 571793}, '1': {'precision': 0.3292270959680586, 'recall': 0.6462935492923867, 'f1-score': 0.43623340912403624, 'support': 548746}, '2': {'precision': 0.36340717660975974, 'recall': 0.20250529064793552, 'f1-score': 0.2600821864890778, 'support': 555225}, 'accuracy': 0.34326313251746665, 'macro avg': {'precision': 0.3555447828878949, 'recall': 0.34597499158261624, 'f1-score': 0.31584390274473423, 'support': 1675764}, 'weighted avg': {'precision': 0.3558289992759171, 'recall': 0.34326313251746665, 'f1-score': 0.31473947703884714, 'support': 1675764}}
[[108141 366762  96890]
 [ 94027 354651 100068]
 [ 86979 355810 112436]]
Evaluating performance on  train set...
1230/1230 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965205
{'0': {'precision': 0.3904670469305924, 'recall': 0.1885430680289423, 'f1-score': 0.25429557477640946, 'support': 110012}, '1': {'precision': 0.31952165544732447, 'recall': 0.6612679829749376, 'f1-score': 0.4308557764830265, 'support': 98913}, '2': {'precision': 0.3812894048225356, 'recall': 0.20512457129899947, 'f1-score': 0.26674611755455085, 'support': 105843}, 'accuracy': 0.34266825090225184, 'macro avg': {'precision': 0.3637593690668175, 'recall': 0.3516452074342931, 'f1-score': 0.31729915627132893, 'support': 314768}, 'weighted avg': {'precision': 0.3650870506113111, 'recall': 0.34266825090225184, 'f1-score': 0.31396460730409154, 'support': 314768}}
[[20742 71441 17829]
 [16104 65408 17401]
 [16275 67857 21711]]
Evaluating performance on  val set...
444/444 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0944645
{'0': {'precision': 0.3699454793275784, 'recall': 0.1717238288561411, 'f1-score': 0.2345654561495112, 'support': 37933}, '1': {'precision': 0.3468193350067788, 'recall': 0.6600332098607741, 'f1-score': 0.454708646451136, 'support': 39145}, '2': {'precision': 0.3633891311483097, 'recall': 0.21318149309567036, 'f1-score': 0.26871933565645534, 'support': 36354}, 'accuracy': 0.35352457860215813, 'macro avg': {'precision': 0.360051315160889, 'recall': 0.34831284393752854, 'f1-score': 0.31933114608570085, 'support': 113432}, 'weighted avg': {'precision': 0.35986347071319413, 'recall': 0.35352457860215813, 'f1-score': 0.32148215796163254, 'support': 113432}}
[[ 6514 25117  6302]
 [ 6033 25837  7275]
 [ 5061 23543  7750]]
training model: results/WBA/W10/deepOF_L1/h500
Epoch 1/50
1230/1230 - 19s - loss: 3.2929 - accuracy500: 0.3741 - val_loss: 3.2968 - val_accuracy500: 0.3546 - 19s/epoch - 16ms/step
Epoch 2/50
1230/1230 - 17s - loss: 3.2776 - accuracy500: 0.3791 - val_loss: 3.2937 - val_accuracy500: 0.3604 - 17s/epoch - 14ms/step
Epoch 3/50
1230/1230 - 17s - loss: 3.2760 - accuracy500: 0.3769 - val_loss: 3.2921 - val_accuracy500: 0.3536 - 17s/epoch - 14ms/step
Epoch 4/50
1230/1230 - 17s - loss: 3.2784 - accuracy500: 0.3725 - val_loss: 3.2918 - val_accuracy500: 0.3639 - 17s/epoch - 14ms/step
Epoch 5/50
1230/1230 - 17s - loss: 3.2763 - accuracy500: 0.3742 - val_loss: 3.2919 - val_accuracy500: 0.3629 - 17s/epoch - 14ms/step
Epoch 6/50
1230/1230 - 17s - loss: 3.2742 - accuracy500: 0.3749 - val_loss: 3.2906 - val_accuracy500: 0.3649 - 17s/epoch - 14ms/step
Epoch 7/50
1230/1230 - 17s - loss: 3.2719 - accuracy500: 0.3772 - val_loss: 3.2900 - val_accuracy500: 0.3650 - 17s/epoch - 14ms/step
Epoch 8/50
1230/1230 - 18s - loss: 3.2683 - accuracy500: 0.3801 - val_loss: 3.2934 - val_accuracy500: 0.3634 - 18s/epoch - 14ms/step
Epoch 9/50
1230/1230 - 18s - loss: 3.2646 - accuracy500: 0.3824 - val_loss: 3.2912 - val_accuracy500: 0.3653 - 18s/epoch - 15ms/step
Epoch 10/50
1230/1230 - 18s - loss: 3.2621 - accuracy500: 0.3856 - val_loss: 3.2924 - val_accuracy500: 0.3635 - 18s/epoch - 14ms/step
Epoch 11/50
1230/1230 - 17s - loss: 3.2600 - accuracy500: 0.3866 - val_loss: 3.2920 - val_accuracy500: 0.3627 - 17s/epoch - 14ms/step
Epoch 12/50
1230/1230 - 17s - loss: 3.2558 - accuracy500: 0.3891 - val_loss: 3.2905 - val_accuracy500: 0.3636 - 17s/epoch - 14ms/step
Epoch 13/50
1230/1230 - 18s - loss: 3.2540 - accuracy500: 0.3905 - val_loss: 3.2914 - val_accuracy500: 0.3649 - 18s/epoch - 14ms/step
Epoch 14/50
1230/1230 - 18s - loss: 3.2542 - accuracy500: 0.3901 - val_loss: 3.2926 - val_accuracy500: 0.3653 - 18s/epoch - 14ms/step
Epoch 15/50
1230/1230 - 18s - loss: 3.2511 - accuracy500: 0.3922 - val_loss: 3.2928 - val_accuracy500: 0.3661 - 18s/epoch - 14ms/step
Epoch 16/50
1230/1230 - 17s - loss: 3.2502 - accuracy500: 0.3927 - val_loss: 3.2930 - val_accuracy500: 0.3674 - 17s/epoch - 14ms/step
Epoch 17/50
1230/1230 - 17s - loss: 3.2492 - accuracy500: 0.3931 - val_loss: 3.2922 - val_accuracy500: 0.3657 - 17s/epoch - 14ms/step
testing model: results/WBA/W10/deepOF_L1/h500
Evaluating performance on  test set...
6546/6546 - 35s - 35s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0908698
{'0': {'precision': 0.38341691077900797, 'recall': 0.6213970974002775, 'f1-score': 0.47422538601740094, 'support': 621374}, '1': {'precision': 0.2802048929058798, 'recall': 0.03186419483758662, 'f1-score': 0.05722132471728594, 'support': 444637}, '2': {'precision': 0.3820231626253132, 'recall': 0.387284687406212, 'f1-score': 0.38463593245074534, 'support': 609753}, 'accuracy': 0.3797885621125648, 'macro avg': {'precision': 0.3485483221034003, 'recall': 0.3468486598813587, 'f1-score': 0.30536088106181075, 'support': 1675764}, 'weighted avg': {'precision': 0.3555241262884628, 'recall': 0.3797885621125648, 'f1-score': 0.33098154447114014, 'support': 1675764}}
[[386120  16825 218429]
 [266895  14168 163574]
 [354035  19570 236148]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0979422
{'0': {'precision': 0.3588010563286734, 'recall': 0.6208373940385782, 'f1-score': 0.4547741316316738, 'support': 108766}, '1': {'precision': 0.33938277291570706, 'recall': 0.036361841780585304, 'f1-score': 0.06568601230275475, 'support': 101315}, '2': {'precision': 0.3525934631937363, 'recall': 0.389733204695903, 'f1-score': 0.3702342548355044, 'support': 104687}, 'accuracy': 0.3558493874853861, 'macro avg': {'precision': 0.3502590974793723, 'recall': 0.3489774801716889, 'f1-score': 0.29689813292331096, 'support': 314768}, 'weighted avg': {'precision': 0.3504863048720392, 'recall': 0.3558493874853861, 'f1-score': 0.30142090356538365, 'support': 314768}}
[[67526  3334 37906]
 [60623  3684 37008]
 [60050  3837 40800]]
Evaluating performance on  val set...
444/444 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.095977
{'0': {'precision': 0.36914103923647934, 'recall': 0.6065063719633612, 'f1-score': 0.45894939069180496, 'support': 40176}, '1': {'precision': 0.2946490618485059, 'recall': 0.02452639190166305, 'f1-score': 0.04528342188876725, 'support': 34575}, '2': {'precision': 0.3620689655172414, 'recall': 0.41694888963573845, 'f1-score': 0.3875758486031841, 'support': 38681}, 'accuracy': 0.3644738698074617, 'macro avg': {'precision': 0.34195302220074225, 'recall': 0.34932721783358756, 'f1-score': 0.2972695537279188, 'support': 113432}, 'weighted avg': {'precision': 0.3440236561195192, 'recall': 0.3644738698074617, 'f1-score': 0.3085218142328253, 'support': 113432}}
[[24367   929 14880]
 [20191   848 13536]
 [21452  1101 16128]]
training model: results/WBA/W10/deepOF_L1/h1000
Epoch 1/50
1230/1230 - 20s - loss: 3.3133 - accuracy1000: 0.3583 - val_loss: 3.2989 - val_accuracy1000: 0.3728 - 20s/epoch - 16ms/step
Epoch 2/50
1230/1230 - 18s - loss: 3.2964 - accuracy1000: 0.3612 - val_loss: 3.2881 - val_accuracy1000: 0.3720 - 18s/epoch - 15ms/step
Epoch 3/50
1230/1230 - 18s - loss: 3.2912 - accuracy1000: 0.3608 - val_loss: 3.2855 - val_accuracy1000: 0.3721 - 18s/epoch - 15ms/step
Epoch 4/50
1230/1230 - 18s - loss: 3.2883 - accuracy1000: 0.3628 - val_loss: 3.2850 - val_accuracy1000: 0.3727 - 18s/epoch - 15ms/step
Epoch 5/50
1230/1230 - 18s - loss: 3.2868 - accuracy1000: 0.3641 - val_loss: 3.2848 - val_accuracy1000: 0.3729 - 18s/epoch - 15ms/step
Epoch 6/50
1230/1230 - 17s - loss: 3.2851 - accuracy1000: 0.3659 - val_loss: 3.2845 - val_accuracy1000: 0.3729 - 17s/epoch - 14ms/step
Epoch 7/50
1230/1230 - 18s - loss: 3.2845 - accuracy1000: 0.3674 - val_loss: 3.2844 - val_accuracy1000: 0.3725 - 18s/epoch - 14ms/step
Epoch 8/50
1230/1230 - 17s - loss: 3.2832 - accuracy1000: 0.3686 - val_loss: 3.2844 - val_accuracy1000: 0.3729 - 17s/epoch - 14ms/step
Epoch 9/50
1230/1230 - 17s - loss: 3.2820 - accuracy1000: 0.3701 - val_loss: 3.2841 - val_accuracy1000: 0.3730 - 17s/epoch - 14ms/step
Epoch 10/50
1230/1230 - 17s - loss: 3.2811 - accuracy1000: 0.3716 - val_loss: 3.2843 - val_accuracy1000: 0.3733 - 17s/epoch - 14ms/step
Epoch 11/50
1230/1230 - 17s - loss: 3.2803 - accuracy1000: 0.3719 - val_loss: 3.2846 - val_accuracy1000: 0.3728 - 17s/epoch - 14ms/step
Epoch 12/50
1230/1230 - 17s - loss: 3.2791 - accuracy1000: 0.3730 - val_loss: 3.2842 - val_accuracy1000: 0.3735 - 17s/epoch - 14ms/step
Epoch 13/50
1230/1230 - 17s - loss: 3.2782 - accuracy1000: 0.3745 - val_loss: 3.2845 - val_accuracy1000: 0.3728 - 17s/epoch - 14ms/step
Epoch 14/50
1230/1230 - 17s - loss: 3.2768 - accuracy1000: 0.3755 - val_loss: 3.2846 - val_accuracy1000: 0.3737 - 17s/epoch - 14ms/step
Epoch 15/50
1230/1230 - 17s - loss: 3.2757 - accuracy1000: 0.3764 - val_loss: 3.2847 - val_accuracy1000: 0.3728 - 17s/epoch - 14ms/step
Epoch 16/50
1230/1230 - 18s - loss: 3.2749 - accuracy1000: 0.3786 - val_loss: 3.2843 - val_accuracy1000: 0.3729 - 18s/epoch - 14ms/step
Epoch 17/50
1230/1230 - 17s - loss: 3.2733 - accuracy1000: 0.3792 - val_loss: 3.2852 - val_accuracy1000: 0.3727 - 17s/epoch - 14ms/step
Epoch 18/50
1230/1230 - 17s - loss: 3.2720 - accuracy1000: 0.3804 - val_loss: 3.2861 - val_accuracy1000: 0.3728 - 17s/epoch - 14ms/step
Epoch 19/50
1230/1230 - 17s - loss: 3.2706 - accuracy1000: 0.3811 - val_loss: 3.2862 - val_accuracy1000: 0.3726 - 17s/epoch - 14ms/step
testing model: results/WBA/W10/deepOF_L1/h1000
Evaluating performance on  test set...
6546/6546 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0973519
{'0': {'precision': 0.3309115221751727, 'recall': 0.027276217629239635, 'f1-score': 0.05039823361794351, 'support': 544357}, '1': {'precision': 0.3597649549438029, 'recall': 0.9449787078033786, 'f1-score': 0.5211295244307482, 'support': 602803}, '2': {'precision': 0.3492784719592747, 'recall': 0.031411037373913174, 'f1-score': 0.057638568269627974, 'support': 528604}, 'accuracy': 0.35869489975915464, 'macro avg': {'precision': 0.3466516496927501, 'recall': 0.3345553209355105, 'f1-score': 0.20972210877277322, 'support': 1675764}, 'weighted avg': {'precision': 0.3470843119933715, 'recall': 0.35869489975915464, 'f1-score': 0.22201279518750233, 'support': 1675764}}
[[ 14848 515494  14015]
 [ 16248 569636  16919]
 [ 13774 498226  16604]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0997381
{'0': {'precision': 0.38037324386663873, 'recall': 0.03408236885615512, 'f1-score': 0.06255927439518563, 'support': 106448}, '1': {'precision': 0.339366256144331, 'recall': 0.9440729540374537, 'f1-score': 0.4992624526305856, 'support': 106478}, '2': {'precision': 0.37541565063178894, 'recall': 0.03325739871565759, 'f1-score': 0.06110189060470487, 'support': 101842}, 'accuracy': 0.3416420983073248, 'macro avg': {'precision': 0.3650517168809196, 'recall': 0.3371375738697555, 'f1-score': 0.20764120587682536, 'support': 314768}, 'weighted avg': {'precision': 0.36489761340572957, 'recall': 0.3416420983073248, 'f1-score': 0.20981330953267985, 'support': 314768}}
[[  3628 100087   2733]
 [  3053 100523   2902]
 [  2857  95598   3387]]
Evaluating performance on  val set...
444/444 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0945712
{'0': {'precision': 0.3572593800978793, 'recall': 0.02413821608663305, 'f1-score': 0.045221072193686596, 'support': 36291}, '1': {'precision': 0.37402083949157555, 'recall': 0.9557417679688422, 'f1-score': 0.5376408336154985, 'support': 42365}, '2': {'precision': 0.3542584434654919, 'recall': 0.027749022314239705, 'f1-score': 0.05146666666666666, 'support': 34776}, 'accuracy': 0.373183933986882, 'macro avg': {'precision': 0.36184622101831554, 'recall': 0.3358763354565717, 'f1-score': 0.21144285749195058, 'support': 113432}, 'weighted avg': {'precision': 0.36259948390356056, 'recall': 0.373183933986882, 'f1-score': 0.2310465886795761, 'support': 113432}}
[[  876 34660   755]
 [  871 40490  1004]
 [  705 33106   965]]
training model: results/WBA/W10/deepLOB_L2/h10
Epoch 1/50
1230/1230 - 55s - loss: 3.1345 - accuracy10: 0.3965 - val_loss: 2.9348 - val_accuracy10: 0.3181 - 55s/epoch - 44ms/step
Epoch 2/50
1230/1230 - 50s - loss: 3.0012 - accuracy10: 0.3939 - val_loss: 2.9307 - val_accuracy10: 0.4309 - 50s/epoch - 41ms/step
Epoch 3/50
1230/1230 - 50s - loss: 2.9130 - accuracy10: 0.4450 - val_loss: 2.8984 - val_accuracy10: 0.5361 - 50s/epoch - 40ms/step
Epoch 4/50
1230/1230 - 51s - loss: 2.8402 - accuracy10: 0.4771 - val_loss: 2.9321 - val_accuracy10: 0.4844 - 51s/epoch - 41ms/step
Epoch 5/50
1230/1230 - 50s - loss: 2.7747 - accuracy10: 0.5086 - val_loss: 2.7598 - val_accuracy10: 0.5279 - 50s/epoch - 41ms/step
Epoch 6/50
1230/1230 - 50s - loss: 2.7254 - accuracy10: 0.5331 - val_loss: 2.8324 - val_accuracy10: 0.5777 - 50s/epoch - 41ms/step
Epoch 7/50
1230/1230 - 50s - loss: 2.6866 - accuracy10: 0.5474 - val_loss: 2.7668 - val_accuracy10: 0.5933 - 50s/epoch - 41ms/step
Epoch 8/50
1230/1230 - 51s - loss: 2.6584 - accuracy10: 0.5566 - val_loss: 2.7904 - val_accuracy10: 0.6052 - 51s/epoch - 41ms/step
Epoch 9/50
1230/1230 - 50s - loss: 2.6358 - accuracy10: 0.5634 - val_loss: 2.7484 - val_accuracy10: 0.6139 - 50s/epoch - 41ms/step
Epoch 10/50
1230/1230 - 51s - loss: 2.6175 - accuracy10: 0.5681 - val_loss: 2.7641 - val_accuracy10: 0.6221 - 51s/epoch - 42ms/step
Epoch 11/50
1230/1230 - 51s - loss: 2.6028 - accuracy10: 0.5707 - val_loss: 2.7501 - val_accuracy10: 0.6260 - 51s/epoch - 41ms/step
Epoch 12/50
1230/1230 - 51s - loss: 2.5910 - accuracy10: 0.5743 - val_loss: 2.7711 - val_accuracy10: 0.6180 - 51s/epoch - 41ms/step
Epoch 13/50
1230/1230 - 50s - loss: 2.5801 - accuracy10: 0.5752 - val_loss: 2.8080 - val_accuracy10: 0.6390 - 50s/epoch - 41ms/step
Epoch 14/50
1230/1230 - 51s - loss: 2.5697 - accuracy10: 0.5782 - val_loss: 2.8190 - val_accuracy10: 0.6405 - 51s/epoch - 41ms/step
Epoch 15/50
1230/1230 - 50s - loss: 2.5629 - accuracy10: 0.5790 - val_loss: 2.8094 - val_accuracy10: 0.6487 - 50s/epoch - 41ms/step
Epoch 16/50
1230/1230 - 51s - loss: 2.5549 - accuracy10: 0.5804 - val_loss: 2.8493 - val_accuracy10: 0.6481 - 51s/epoch - 41ms/step
Epoch 17/50
1230/1230 - 51s - loss: 2.5455 - accuracy10: 0.5821 - val_loss: 2.8623 - val_accuracy10: 0.6424 - 51s/epoch - 41ms/step
Epoch 18/50
1230/1230 - 51s - loss: 2.5371 - accuracy10: 0.5837 - val_loss: 2.8717 - val_accuracy10: 0.6519 - 51s/epoch - 42ms/step
Epoch 19/50
1230/1230 - 51s - loss: 2.5304 - accuracy10: 0.5854 - val_loss: 2.8410 - val_accuracy10: 0.6397 - 51s/epoch - 42ms/step
testing model: results/WBA/W10/deepLOB_L2/h10
Evaluating performance on  test set...
6546/6546 - 92s - 92s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90438926
{'0': {'precision': 0.4379054483782065, 'recall': 0.13374903278651373, 'f1-score': 0.2049119952779769, 'support': 308877}, '1': {'precision': 0.7333945515763698, 'recall': 0.6299487736201106, 'f1-score': 0.6777471086068846, 'support': 1061172}, '2': {'precision': 0.3156719447827852, 'recall': 0.6917440795499149, 'f1-score': 0.4335134514624006, 'support': 305720}, 'accuracy': 0.5497631236763539, 'macro avg': {'precision': 0.49565731491245385, 'recall': 0.4851472953188464, 'f1-score': 0.438724185115754, 'support': 1675769}, 'weighted avg': {'precision': 0.6027226373223923, 'recall': 0.5497631236763539, 'f1-score': 0.5460374248963585, 'support': 1675769}}
[[ 41312 161347 106218]
 [ 40450 668484 352238]
 [ 12578  81662 211480]]
Evaluating performance on  train set...
1230/1230 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87518805
{'0': {'precision': 0.3824125354585979, 'recall': 0.5447024114930734, 'f1-score': 0.44935319171450494, 'support': 62368}, '1': {'precision': 0.7573065712371837, 'recall': 0.657606246397317, 'f1-score': 0.7039437702117873, 'support': 190830}, '2': {'precision': 0.4117422418516612, 'recall': 0.4027480023387254, 'f1-score': 0.40719546137488816, 'support': 61572}, 'accuracy': 0.5853829780474632, 'macro avg': {'precision': 0.5171537828491476, 'recall': 0.5350188867430387, 'f1-score': 0.5201641411003934, 'support': 314770}, 'weighted avg': {'precision': 0.6154300324553295, 'recall': 0.5853829780474632, 'f1-score': 0.5954528337457198, 'support': 314770}}
[[ 33972  19027   9369]
 [ 39279 125491  26060]
 [ 15585  21189  24798]]
Evaluating performance on  val set...
444/444 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84631914
{'0': {'precision': 0.35077023926581447, 'recall': 0.549130278618708, 'f1-score': 0.4280885617712354, 'support': 19489}, '1': {'precision': 0.7762783047960292, 'recall': 0.7039952057530963, 'f1-score': 0.7383719306087102, 'support': 75090}, '2': {'precision': 0.40692027519222984, 'recall': 0.3199681782020684, 'f1-score': 0.35824352008550814, 'support': 18855}, 'accuracy': 0.6135550187774389, 'macro avg': {'precision': 0.5113229397513578, 'recall': 0.5243645541912909, 'f1-score': 0.5082346708218178, 'support': 113434}, 'weighted avg': {'precision': 0.6417774290683109, 'recall': 0.6135550187774389, 'f1-score': 0.6218774602057577, 'support': 113434}}
[[10702  6882  1905]
 [15339 52863  6888]
 [ 4469  8353  6033]]
training model: results/WBA/W10/deepLOB_L2/h20
Epoch 1/50
1230/1230 - 54s - loss: 3.1425 - accuracy20: 0.4325 - val_loss: 2.9899 - val_accuracy20: 0.4733 - 54s/epoch - 44ms/step
Epoch 2/50
1230/1230 - 51s - loss: 3.0209 - accuracy20: 0.4493 - val_loss: 3.0930 - val_accuracy20: 0.4974 - 51s/epoch - 41ms/step
Epoch 3/50
1230/1230 - 50s - loss: 2.9458 - accuracy20: 0.4795 - val_loss: 3.0684 - val_accuracy20: 0.4748 - 50s/epoch - 40ms/step
Epoch 4/50
1230/1230 - 49s - loss: 2.9031 - accuracy20: 0.4965 - val_loss: 3.0357 - val_accuracy20: 0.4938 - 49s/epoch - 40ms/step
Epoch 5/50
1230/1230 - 50s - loss: 2.8658 - accuracy20: 0.5098 - val_loss: 3.0616 - val_accuracy20: 0.4960 - 50s/epoch - 41ms/step
Epoch 6/50
1230/1230 - 50s - loss: 2.8344 - accuracy20: 0.5201 - val_loss: 2.9937 - val_accuracy20: 0.4846 - 50s/epoch - 41ms/step
Epoch 7/50
1230/1230 - 50s - loss: 2.8016 - accuracy20: 0.5313 - val_loss: 2.9534 - val_accuracy20: 0.5012 - 50s/epoch - 41ms/step
Epoch 8/50
1230/1230 - 50s - loss: 2.7771 - accuracy20: 0.5389 - val_loss: 3.0011 - val_accuracy20: 0.5111 - 50s/epoch - 41ms/step
Epoch 9/50
1230/1230 - 50s - loss: 2.7605 - accuracy20: 0.5430 - val_loss: 2.8371 - val_accuracy20: 0.5474 - 50s/epoch - 41ms/step
Epoch 10/50
1230/1230 - 51s - loss: 2.7409 - accuracy20: 0.5492 - val_loss: 2.8262 - val_accuracy20: 0.5542 - 51s/epoch - 41ms/step
Epoch 11/50
1230/1230 - 50s - loss: 2.7227 - accuracy20: 0.5545 - val_loss: 2.8228 - val_accuracy20: 0.5548 - 50s/epoch - 41ms/step
Epoch 12/50
1230/1230 - 50s - loss: 2.7072 - accuracy20: 0.5580 - val_loss: 2.7814 - val_accuracy20: 0.5717 - 50s/epoch - 41ms/step
Epoch 13/50
1230/1230 - 50s - loss: 2.6943 - accuracy20: 0.5610 - val_loss: 2.7814 - val_accuracy20: 0.5682 - 50s/epoch - 41ms/step
Epoch 14/50
1230/1230 - 50s - loss: 2.6818 - accuracy20: 0.5634 - val_loss: 2.7248 - val_accuracy20: 0.5836 - 50s/epoch - 41ms/step
Epoch 15/50
1230/1230 - 50s - loss: 2.6711 - accuracy20: 0.5669 - val_loss: 2.7610 - val_accuracy20: 0.5784 - 50s/epoch - 41ms/step
Epoch 16/50
1230/1230 - 51s - loss: 2.6606 - accuracy20: 0.5691 - val_loss: 2.7513 - val_accuracy20: 0.5809 - 51s/epoch - 41ms/step
Epoch 17/50
1230/1230 - 50s - loss: 2.6511 - accuracy20: 0.5724 - val_loss: 2.7749 - val_accuracy20: 0.5807 - 50s/epoch - 41ms/step
Epoch 18/50
1230/1230 - 50s - loss: 2.6419 - accuracy20: 0.5741 - val_loss: 2.7885 - val_accuracy20: 0.5696 - 50s/epoch - 41ms/step
Epoch 19/50
1230/1230 - 50s - loss: 2.6365 - accuracy20: 0.5745 - val_loss: 2.7742 - val_accuracy20: 0.5890 - 50s/epoch - 41ms/step
Epoch 20/50
1230/1230 - 51s - loss: 2.6281 - accuracy20: 0.5760 - val_loss: 2.7710 - val_accuracy20: 0.5758 - 51s/epoch - 41ms/step
Epoch 21/50
1230/1230 - 51s - loss: 2.6220 - accuracy20: 0.5775 - val_loss: 2.7864 - val_accuracy20: 0.5837 - 51s/epoch - 41ms/step
Epoch 22/50
1230/1230 - 50s - loss: 2.6136 - accuracy20: 0.5792 - val_loss: 2.7474 - val_accuracy20: 0.5838 - 50s/epoch - 41ms/step
Epoch 23/50
1230/1230 - 50s - loss: 2.6085 - accuracy20: 0.5803 - val_loss: 2.7825 - val_accuracy20: 0.5868 - 50s/epoch - 40ms/step
Epoch 24/50
1230/1230 - 50s - loss: 2.6016 - accuracy20: 0.5811 - val_loss: 2.7892 - val_accuracy20: 0.5761 - 50s/epoch - 41ms/step
testing model: results/WBA/W10/deepLOB_L2/h20
Evaluating performance on  test set...
6546/6546 - 89s - 89s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9759939
{'0': {'precision': 0.5058682611593559, 'recall': 0.13212283596473967, 'f1-score': 0.20952251399810756, 'support': 396366}, '1': {'precision': 0.6318110671417472, 'recall': 0.6292191861940614, 'f1-score': 0.6305124630336142, 'support': 886575}, '2': {'precision': 0.37324244024441905, 'recall': 0.6549405846833729, 'f1-score': 0.4755021549971538, 'support': 392828}, 'accuracy': 0.5176715883871822, 'macro avg': {'precision': 0.503640589515174, 'recall': 0.47209420228072463, 'f1-score': 0.4385123773429585, 'support': 1675769}, 'weighted avg': {'precision': 0.5414093215533994, 'recall': 0.5176715883871822, 'f1-score': 0.4945996424570585, 'support': 1675769}}
[[ 52369 206677 137320]
 [ 34016 557850 294709]
 [ 17138 118411 257279]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9226307
{'0': {'precision': 0.48114575175378665, 'recall': 0.3645327037911401, 'f1-score': 0.41479917255645576, 'support': 79211}, '1': {'precision': 0.6263201526266778, 'recall': 0.701221837969791, 'f1-score': 0.6616579689280786, 'support': 157304}, '2': {'precision': 0.45300797294032374, 'recall': 0.45524247651907224, 'f1-score': 0.45412247603508055, 'support': 78255}, 'accuracy': 0.5553419957429234, 'macro avg': {'precision': 0.5201579591069294, 'recall': 0.5069990060933344, 'f1-score': 0.5101932058398716, 'support': 314770}, 'weighted avg': {'precision': 0.5467002584534777, 'recall': 0.5553419957429234, 'f1-score': 0.547941216646304, 'support': 314770}}
[[ 28875  35571  14765]
 [ 18748 110305  28251]
 [ 12390  30240  35625]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88036925
{'0': {'precision': 0.44219149195020074, 'recall': 0.4377358490566038, 'f1-score': 0.4399523895983377, 'support': 24910}, '1': {'precision': 0.687473537772939, 'recall': 0.7074897682886977, 'f1-score': 0.6973380472878146, 'support': 64261}, '2': {'precision': 0.4350571920681888, 'recall': 0.40600914973416313, 'f1-score': 0.42003155246663537, 'support': 24263}, 'accuracy': 0.5837667718673414, 'macro avg': {'precision': 0.5215740739304429, 'recall': 0.5170782556931549, 'f1-score': 0.5191073297842626, 'support': 113434}, 'weighted avg': {'precision': 0.5796191593918648, 'recall': 0.5837667718673414, 'f1-score': 0.5815018410631276, 'support': 113434}}
[[10904 10528  3478]
 [ 9483 45464  9314]
 [ 4272 10140  9851]]
training model: results/WBA/W10/deepLOB_L2/h30
Epoch 1/50
1230/1230 - 53s - loss: 3.1799 - accuracy30: 0.4255 - val_loss: 3.1032 - val_accuracy30: 0.4623 - 53s/epoch - 43ms/step
Epoch 2/50
1230/1230 - 50s - loss: 3.0823 - accuracy30: 0.4435 - val_loss: 3.2281 - val_accuracy30: 0.4853 - 50s/epoch - 41ms/step
Epoch 3/50
1230/1230 - 50s - loss: 3.0219 - accuracy30: 0.4709 - val_loss: 3.1162 - val_accuracy30: 0.4830 - 50s/epoch - 41ms/step
Epoch 4/50
1230/1230 - 51s - loss: 2.9850 - accuracy30: 0.4835 - val_loss: 3.1096 - val_accuracy30: 0.4512 - 51s/epoch - 41ms/step
Epoch 5/50
1230/1230 - 50s - loss: 2.9489 - accuracy30: 0.4953 - val_loss: 3.1276 - val_accuracy30: 0.4443 - 50s/epoch - 41ms/step
Epoch 6/50
1230/1230 - 50s - loss: 2.9207 - accuracy30: 0.5057 - val_loss: 3.1018 - val_accuracy30: 0.4650 - 50s/epoch - 41ms/step
Epoch 7/50
1230/1230 - 50s - loss: 2.8959 - accuracy30: 0.5140 - val_loss: 3.1555 - val_accuracy30: 0.4541 - 50s/epoch - 41ms/step
Epoch 8/50
1230/1230 - 50s - loss: 2.8679 - accuracy30: 0.5230 - val_loss: 3.1719 - val_accuracy30: 0.4778 - 50s/epoch - 41ms/step
Epoch 9/50
1230/1230 - 51s - loss: 2.8458 - accuracy30: 0.5288 - val_loss: 3.2104 - val_accuracy30: 0.4906 - 51s/epoch - 41ms/step
Epoch 10/50
1230/1230 - 51s - loss: 2.8230 - accuracy30: 0.5343 - val_loss: 3.1492 - val_accuracy30: 0.5018 - 51s/epoch - 41ms/step
Epoch 11/50
1230/1230 - 50s - loss: 2.8023 - accuracy30: 0.5390 - val_loss: 3.2568 - val_accuracy30: 0.5002 - 50s/epoch - 41ms/step
Epoch 12/50
1230/1230 - 50s - loss: 2.7868 - accuracy30: 0.5427 - val_loss: 3.1729 - val_accuracy30: 0.5098 - 50s/epoch - 41ms/step
Epoch 13/50
1230/1230 - 50s - loss: 2.7717 - accuracy30: 0.5467 - val_loss: 3.2130 - val_accuracy30: 0.4987 - 50s/epoch - 40ms/step
Epoch 14/50
1230/1230 - 50s - loss: 2.7597 - accuracy30: 0.5492 - val_loss: 3.1926 - val_accuracy30: 0.5024 - 50s/epoch - 41ms/step
Epoch 15/50
1230/1230 - 50s - loss: 2.7481 - accuracy30: 0.5518 - val_loss: 3.1510 - val_accuracy30: 0.5081 - 50s/epoch - 41ms/step
Epoch 16/50
1230/1230 - 50s - loss: 2.7376 - accuracy30: 0.5544 - val_loss: 3.1797 - val_accuracy30: 0.5071 - 50s/epoch - 40ms/step
testing model: results/WBA/W10/deepLOB_L2/h30
Evaluating performance on  test set...
6546/6546 - 89s - 89s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0904648
{'0': {'precision': 0.49650277455155506, 'recall': 0.04225061332243958, 'f1-score': 0.07787439378850809, 'support': 455307}, '1': {'precision': 0.5388677139487871, 'recall': 0.5312941597816877, 'f1-score': 0.5350541377780479, 'support': 770639}, '2': {'precision': 0.3495524477437712, 'recall': 0.6816747920848867, 'f1-score': 0.4621311054158921, 'support': 449823}, 'accuracy': 0.4387872075447153, 'macro avg': {'precision': 0.4616409787480378, 'recall': 0.41840652172967135, 'f1-score': 0.3583532123274827, 'support': 1675769}, 'weighted avg': {'precision': 0.4765396636910998, 'recall': 0.4387872075447153, 'f1-score': 0.39126367806499235, 'support': 1675769}}
[[ 19237 213324 222746]
 [ 13366 409436 347837]
 [  6142 137048 306633]]
Evaluating performance on  train set...
1230/1230 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0444741
{'0': {'precision': 0.4563831038945758, 'recall': 0.21502538971550214, 'f1-score': 0.29232264920226997, 'support': 90194}, '1': {'precision': 0.5000354366982447, 'recall': 0.6249695502292038, 'f1-score': 0.5555653985596404, 'support': 135469}, '2': {'precision': 0.41114424188269116, 'recall': 0.4750580762454128, 'f1-score': 0.440796392906605, 'support': 89107}, 'accuracy': 0.4650665565333418, 'macro avg': {'precision': 0.45585426082517055, 'recall': 0.4383510053967062, 'f1-score': 0.42956148022283847, 'support': 314770}, 'weighted avg': {'precision': 0.4623634660488066, 'recall': 0.4650665565333418, 'f1-score': 0.4476464789603657, 'support': 314770}}
[[19394 48233 22567]
 [12744 84664 38061]
 [10357 36419 42331]]
Evaluating performance on  val set...
444/444 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0180166
{'0': {'precision': 0.43696877516328175, 'recall': 0.1708827542773171, 'f1-score': 0.2456864027365562, 'support': 28581}, '1': {'precision': 0.525553613053613, 'recall': 0.6342346777312845, 'f1-score': 0.5748020204273491, 'support': 56878}, '2': {'precision': 0.35208376714162476, 'recall': 0.42309204647006254, 'f1-score': 0.38433562800363685, 'support': 27975}, 'accuracy': 0.46541601283565776, 'macro avg': {'precision': 0.43820205178617316, 'recall': 0.409403159492888, 'f1-score': 0.40160801705584737, 'support': 113434}, 'weighted avg': {'precision': 0.4604526539837448, 'recall': 0.46541601283565776, 'f1-score': 0.4449048926061147, 'support': 113434}}
[[ 4884 18320  5377]
 [ 4400 36074 16404]
 [ 1893 14246 11836]]
training model: results/WBA/W10/deepLOB_L2/h50
Epoch 1/50
1230/1230 - 54s - loss: 3.2315 - accuracy50: 0.4017 - val_loss: 3.2270 - val_accuracy50: 0.3868 - 54s/epoch - 44ms/step
Epoch 2/50
1230/1230 - 53s - loss: 3.1566 - accuracy50: 0.4352 - val_loss: 3.1728 - val_accuracy50: 0.4189 - 53s/epoch - 43ms/step
Epoch 3/50
1230/1230 - 52s - loss: 3.0812 - accuracy50: 0.4670 - val_loss: 3.1677 - val_accuracy50: 0.4330 - 52s/epoch - 42ms/step
Epoch 4/50
1230/1230 - 52s - loss: 3.0447 - accuracy50: 0.4747 - val_loss: 3.1775 - val_accuracy50: 0.4370 - 52s/epoch - 43ms/step
Epoch 5/50
1230/1230 - 52s - loss: 3.0197 - accuracy50: 0.4811 - val_loss: 3.1706 - val_accuracy50: 0.4345 - 52s/epoch - 42ms/step
Epoch 6/50
1230/1230 - 52s - loss: 3.0018 - accuracy50: 0.4876 - val_loss: 3.1479 - val_accuracy50: 0.4372 - 52s/epoch - 42ms/step
Epoch 7/50
1230/1230 - 51s - loss: 2.9882 - accuracy50: 0.4912 - val_loss: 3.1452 - val_accuracy50: 0.4403 - 51s/epoch - 42ms/step
Epoch 8/50
1230/1230 - 51s - loss: 2.9768 - accuracy50: 0.4952 - val_loss: 3.1996 - val_accuracy50: 0.4410 - 51s/epoch - 42ms/step
Epoch 9/50
1230/1230 - 51s - loss: 2.9626 - accuracy50: 0.4996 - val_loss: 3.2033 - val_accuracy50: 0.4417 - 51s/epoch - 41ms/step
Epoch 10/50
1230/1230 - 50s - loss: 2.9498 - accuracy50: 0.5026 - val_loss: 3.1709 - val_accuracy50: 0.4555 - 50s/epoch - 41ms/step
Epoch 11/50
1230/1230 - 50s - loss: 2.9435 - accuracy50: 0.5044 - val_loss: 3.2605 - val_accuracy50: 0.4442 - 50s/epoch - 41ms/step
Epoch 12/50
1230/1230 - 50s - loss: 2.9281 - accuracy50: 0.5091 - val_loss: 3.2839 - val_accuracy50: 0.4430 - 50s/epoch - 41ms/step
Epoch 13/50
1230/1230 - 50s - loss: 2.9143 - accuracy50: 0.5126 - val_loss: 3.3454 - val_accuracy50: 0.4377 - 50s/epoch - 41ms/step
Epoch 14/50
1230/1230 - 50s - loss: 2.9029 - accuracy50: 0.5159 - val_loss: 3.3068 - val_accuracy50: 0.4425 - 50s/epoch - 41ms/step
Epoch 15/50
1230/1230 - 51s - loss: 2.8919 - accuracy50: 0.5179 - val_loss: 3.3009 - val_accuracy50: 0.4472 - 51s/epoch - 41ms/step
Epoch 16/50
1230/1230 - 50s - loss: 2.8832 - accuracy50: 0.5206 - val_loss: 3.3243 - val_accuracy50: 0.4403 - 50s/epoch - 41ms/step
Epoch 17/50
1230/1230 - 50s - loss: 2.8737 - accuracy50: 0.5231 - val_loss: 3.3112 - val_accuracy50: 0.4356 - 50s/epoch - 41ms/step
testing model: results/WBA/W10/deepLOB_L2/h50
Evaluating performance on  test set...
6546/6546 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0516495
{'0': {'precision': 0.48928006273719, 'recall': 0.13142620700031973, 'f1-score': 0.20719694948021372, 'support': 531690}, '1': {'precision': 0.4517406495148715, 'recall': 0.606287863432651, 'f1-score': 0.5177268284708958, 'support': 621642}, '2': {'precision': 0.4183866849117423, 'recall': 0.5594932977564759, 'f1-score': 0.4787592551796658, 'support': 522437}, 'accuracy': 0.44103453399603404, 'macro avg': {'precision': 0.4531357990546013, 'recall': 0.4324024560631489, 'f1-score': 0.4012276777102584, 'support': 1675769}, 'weighted avg': {'precision': 0.45325278239882477, 'recall': 0.44103453399603404, 'f1-score': 0.407053022326907, 'support': 1675769}}
[[ 69878 264435 197377]
 [ 35789 376894 208959]
 [ 37151 192986 292300]]
Evaluating performance on  train set...
1230/1230 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0726409
{'0': {'precision': 0.4915290528062522, 'recall': 0.17537577111862335, 'f1-score': 0.25851450932918546, 'support': 104718}, '1': {'precision': 0.3885519831272452, 'recall': 0.6896793166223218, 'f1-score': 0.49706638317341983, 'support': 107115}, '2': {'precision': 0.4554756066820963, 'recall': 0.38618766818539496, 'f1-score': 0.41797965460137215, 'support': 102937}, 'accuracy': 0.41933157543603267, 'macro avg': {'precision': 0.4451855475385312, 'recall': 0.4170809186421134, 'f1-score': 0.3911868490346591, 'support': 314770}, 'weighted avg': {'precision': 0.44469605600748147, 'recall': 0.41933157543603267, 'f1-score': 0.39184153422262585, 'support': 314770}}
[[18365 64408 21945]
 [ 7660 73875 25580]
 [11338 51846 39753]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0485332
{'0': {'precision': 0.43220555650247144, 'recall': 0.30029309885424993, 'f1-score': 0.35437156083500737, 'support': 33777}, '1': {'precision': 0.45697931745952514, 'recall': 0.587603500288838, 'f1-score': 0.5141241880229881, 'support': 46739}, '2': {'precision': 0.40794187564870926, 'recall': 0.3701318427607996, 'f1-score': 0.3881181810942105, 'support': 32918}, 'accuracy': 0.4389424687483471, 'macro avg': {'precision': 0.43237558320356856, 'recall': 0.4193428139679625, 'f1-score': 0.41887130998406863, 'support': 113434}, 'weighted avg': {'precision': 0.4353720583187487, 'recall': 0.4389424687483471, 'f1-score': 0.4299886534865182, 'support': 113434}}
[[10143 17929  5705]
 [ 7297 27464 11978]
 [ 6028 14706 12184]]
training model: results/WBA/W10/deepLOB_L2/h100
Epoch 1/50
1230/1230 - 55s - loss: 3.2825 - accuracy100: 0.3802 - val_loss: 3.3137 - val_accuracy100: 0.3630 - 55s/epoch - 45ms/step
Epoch 2/50
1230/1230 - 52s - loss: 3.2265 - accuracy100: 0.4048 - val_loss: 3.3538 - val_accuracy100: 0.3698 - 52s/epoch - 42ms/step
Epoch 3/50
1230/1230 - 52s - loss: 3.1942 - accuracy100: 0.4219 - val_loss: 3.3465 - val_accuracy100: 0.3725 - 52s/epoch - 43ms/step
Epoch 4/50
1230/1230 - 52s - loss: 3.1769 - accuracy100: 0.4287 - val_loss: 3.2760 - val_accuracy100: 0.3764 - 52s/epoch - 42ms/step
Epoch 5/50
1230/1230 - 52s - loss: 3.1633 - accuracy100: 0.4348 - val_loss: 3.2911 - val_accuracy100: 0.3754 - 52s/epoch - 42ms/step
Epoch 6/50
1230/1230 - 52s - loss: 3.1525 - accuracy100: 0.4383 - val_loss: 3.2971 - val_accuracy100: 0.3775 - 52s/epoch - 42ms/step
Epoch 7/50
1230/1230 - 52s - loss: 3.1435 - accuracy100: 0.4414 - val_loss: 3.2894 - val_accuracy100: 0.3781 - 52s/epoch - 43ms/step
Epoch 8/50
1230/1230 - 51s - loss: 3.1344 - accuracy100: 0.4458 - val_loss: 3.3330 - val_accuracy100: 0.3681 - 51s/epoch - 42ms/step
Epoch 9/50
1230/1230 - 51s - loss: 3.1271 - accuracy100: 0.4490 - val_loss: 3.3532 - val_accuracy100: 0.3630 - 51s/epoch - 42ms/step
Epoch 10/50
1230/1230 - 51s - loss: 3.1195 - accuracy100: 0.4523 - val_loss: 3.3935 - val_accuracy100: 0.3589 - 51s/epoch - 42ms/step
Epoch 11/50
1230/1230 - 51s - loss: 3.1130 - accuracy100: 0.4547 - val_loss: 3.4076 - val_accuracy100: 0.3591 - 51s/epoch - 41ms/step
Epoch 12/50
1230/1230 - 52s - loss: 3.1031 - accuracy100: 0.4574 - val_loss: 3.3957 - val_accuracy100: 0.3627 - 52s/epoch - 43ms/step
Epoch 13/50
1230/1230 - 52s - loss: 3.0935 - accuracy100: 0.4620 - val_loss: 3.4395 - val_accuracy100: 0.3595 - 52s/epoch - 42ms/step
Epoch 14/50
1230/1230 - 52s - loss: 3.0868 - accuracy100: 0.4645 - val_loss: 3.4700 - val_accuracy100: 0.3531 - 52s/epoch - 42ms/step
testing model: results/WBA/W10/deepLOB_L2/h100
Evaluating performance on  test set...
6546/6546 - 92s - 92s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1259898
{'0': {'precision': 0.4231531195268311, 'recall': 0.05313671762330545, 'f1-score': 0.09441716396157455, 'support': 554720}, '1': {'precision': 0.36178731802039965, 'recall': 0.5953854703971935, 'f1-score': 0.4500815633913303, 'support': 575790}, '2': {'precision': 0.3878149742007392, 'recall': 0.4683902512384023, 'f1-score': 0.42431124642280105, 'support': 545259}, 'accuracy': 0.3745665422859595, 'macro avg': {'precision': 0.39091847058265666, 'recall': 0.3723041464196337, 'f1-score': 0.3229366579252353, 'support': 1675769}, 'weighted avg': {'precision': 0.3905697165448284, 'recall': 0.3745665422859595, 'f1-score': 0.3239629558078165, 'support': 1675769}}
[[ 29476 331233 194011]
 [ 23832 342817 209141]
 [ 16350 273515 255394]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1115719
{'0': {'precision': 0.436973208910295, 'recall': 0.1077112858944869, 'f1-score': 0.17282278707065898, 'support': 107816}, '1': {'precision': 0.3273519637703965, 'recall': 0.6044896672642383, 'f1-score': 0.4247092490129519, 'support': 101522}, '2': {'precision': 0.4033338959324087, 'recall': 0.3853194476060399, 'f1-score': 0.39412092842763946, 'support': 105432}, 'accuracy': 0.36092067223687135, 'macro avg': {'precision': 0.38921968953770003, 'recall': 0.365840133588255, 'f1-score': 0.3305509881704168, 'support': 314770}, 'weighted avg': {'precision': 0.3903498709334316, 'recall': 0.36092067223687135, 'f1-score': 0.32818677674202096, 'support': 314770}}
[[11613 68451 27752]
 [ 7807 61369 32346]
 [ 7156 57651 40625]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0931967
{'0': {'precision': 0.4172461752433936, 'recall': 0.09128125691524673, 'f1-score': 0.14979233335602915, 'support': 36152}, '1': {'precision': 0.3652344033041084, 'recall': 0.599443440205499, 'f1-score': 0.45390773442354276, 'support': 42044}, '2': {'precision': 0.38819824753559695, 'recall': 0.40232135762529087, 'f1-score': 0.3951336436355528, 'support': 35238}, 'accuracy': 0.376254033182291, 'macro avg': {'precision': 0.390226275361033, 'recall': 0.3643486849153455, 'f1-score': 0.3329445704717082, 'support': 113434}, 'weighted avg': {'precision': 0.38894448601456766, 'recall': 0.376254033182291, 'f1-score': 0.33872655955022485, 'support': 113434}}
[[ 3300 24747  8105]
 [ 2603 25203 14238]
 [ 2006 19055 14177]]
training model: results/WBA/W10/deepLOB_L2/h200
Epoch 1/50
1230/1230 - 53s - loss: 3.3051 - accuracy200: 0.3665 - val_loss: 3.3145 - val_accuracy200: 0.3506 - 53s/epoch - 43ms/step
Epoch 2/50
1230/1230 - 50s - loss: 3.2700 - accuracy200: 0.3783 - val_loss: 3.3082 - val_accuracy200: 0.3511 - 50s/epoch - 41ms/step
Epoch 3/50
1230/1230 - 50s - loss: 3.2485 - accuracy200: 0.3917 - val_loss: 3.3150 - val_accuracy200: 0.3524 - 50s/epoch - 41ms/step
Epoch 4/50
1230/1230 - 50s - loss: 3.2344 - accuracy200: 0.4017 - val_loss: 3.3514 - val_accuracy200: 0.3477 - 50s/epoch - 41ms/step
Epoch 5/50
1230/1230 - 50s - loss: 3.2213 - accuracy200: 0.4072 - val_loss: 3.3445 - val_accuracy200: 0.3472 - 50s/epoch - 41ms/step
Epoch 6/50
1230/1230 - 50s - loss: 3.2112 - accuracy200: 0.4130 - val_loss: 3.3332 - val_accuracy200: 0.3484 - 50s/epoch - 41ms/step
Epoch 7/50
1230/1230 - 50s - loss: 3.2001 - accuracy200: 0.4187 - val_loss: 3.3729 - val_accuracy200: 0.3495 - 50s/epoch - 41ms/step
Epoch 8/50
1230/1230 - 50s - loss: 3.1930 - accuracy200: 0.4225 - val_loss: 3.3849 - val_accuracy200: 0.3448 - 50s/epoch - 41ms/step
Epoch 9/50
1230/1230 - 50s - loss: 3.1823 - accuracy200: 0.4292 - val_loss: 3.4048 - val_accuracy200: 0.3484 - 50s/epoch - 41ms/step
Epoch 10/50
1230/1230 - 50s - loss: 3.1754 - accuracy200: 0.4311 - val_loss: 3.3908 - val_accuracy200: 0.3434 - 50s/epoch - 41ms/step
Epoch 11/50
1230/1230 - 51s - loss: 3.1647 - accuracy200: 0.4361 - val_loss: 3.4303 - val_accuracy200: 0.3470 - 51s/epoch - 41ms/step
Epoch 12/50
1230/1230 - 50s - loss: 3.1551 - accuracy200: 0.4396 - val_loss: 3.4361 - val_accuracy200: 0.3439 - 50s/epoch - 41ms/step
testing model: results/WBA/W10/deepLOB_L2/h200
Evaluating performance on  test set...
6546/6546 - 91s - 91s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1154975
{'0': {'precision': 0.33466482192269925, 'recall': 0.11040031801651919, 'f1-score': 0.16603009067056362, 'support': 543368}, '1': {'precision': 0.3648672599982276, 'recall': 0.38238689133607534, 'f1-score': 0.3734216987671597, 'support': 602960}, '2': {'precision': 0.32093119548836524, 'recall': 0.5240999469251532, 'f1-score': 0.39809189053477273, 'support': 529441}, 'accuracy': 0.33896796038117427, 'macro avg': {'precision': 0.34015442580309735, 'recall': 0.3389623854259159, 'f1-score': 0.31251455999083205, 'support': 1675769}, 'weighted avg': {'precision': 0.341192999224583, 'recall': 0.33896796038117427, 'f1-score': 0.3139692609260286, 'support': 1675769}}
[[ 59988 199211 284169]
 [ 69436 230564 302960]
 [ 49824 202137 277480]]
Evaluating performance on  train set...
1230/1230 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1112458
{'0': {'precision': 0.36715993843968275, 'recall': 0.1463877429647601, 'f1-score': 0.20931927702711825, 'support': 105931}, '1': {'precision': 0.3531335564344387, 'recall': 0.5218661895975197, 'f1-score': 0.42123089601155217, 'support': 106763}, '2': {'precision': 0.33677532916808267, 'recall': 0.37861985187507347, 'f1-score': 0.3564738164964143, 'support': 102076}, 'accuracy': 0.3490516885344855, 'macro avg': {'precision': 0.3523562746807347, 'recall': 0.3489579281457844, 'f1-score': 0.32900799651169493, 'support': 314770}, 'weighted avg': {'precision': 0.35254914961599015, 'recall': 0.3490516885344855, 'f1-score': 0.32891538513304636, 'support': 314770}}
[[15507 51321 39103]
 [14039 55716 37008]
 [12689 50739 38648]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1042583
{'0': {'precision': 0.32888187446886, 'recall': 0.07524790978028388, 'f1-score': 0.12247389122473891, 'support': 36001}, '1': {'precision': 0.3838612228255833, 'recall': 0.48322523447342636, 'f1-score': 0.4278499054937564, 'support': 42862}, '2': {'precision': 0.3156518345042935, 'recall': 0.46784877498481386, 'f1-score': 0.37696798778711355, 'support': 34571}, 'accuracy': 0.34905760177724493, 'macro avg': {'precision': 0.34279831059957894, 'recall': 0.3421073064128413, 'f1-score': 0.3090972615018696, 'support': 113434}, 'weighted avg': {'precision': 0.3456242014400578, 'recall': 0.34905760177724493, 'f1-score': 0.31542434819404686, 'support': 113434}}
[[ 2709 17100 16192]
 [ 3276 20712 18874]
 [ 2252 16145 16174]]
training model: results/WBA/W10/deepLOB_L2/h300
Epoch 1/50
1230/1230 - 53s - loss: 3.3102 - accuracy300: 0.3587 - val_loss: 3.3364 - val_accuracy300: 0.3407 - 53s/epoch - 43ms/step
Epoch 2/50
1230/1230 - 50s - loss: 3.2849 - accuracy300: 0.3646 - val_loss: 3.3301 - val_accuracy300: 0.3357 - 50s/epoch - 41ms/step
Epoch 3/50
1230/1230 - 50s - loss: 3.2693 - accuracy300: 0.3816 - val_loss: 3.3311 - val_accuracy300: 0.3357 - 50s/epoch - 41ms/step
Epoch 4/50
1230/1230 - 50s - loss: 3.2549 - accuracy300: 0.3928 - val_loss: 3.3705 - val_accuracy300: 0.3317 - 50s/epoch - 41ms/step
Epoch 5/50
1230/1230 - 50s - loss: 3.2418 - accuracy300: 0.4005 - val_loss: 3.3855 - val_accuracy300: 0.3348 - 50s/epoch - 41ms/step
Epoch 6/50
1230/1230 - 51s - loss: 3.2310 - accuracy300: 0.4081 - val_loss: 3.3733 - val_accuracy300: 0.3406 - 51s/epoch - 41ms/step
Epoch 7/50
1230/1230 - 50s - loss: 3.2226 - accuracy300: 0.4111 - val_loss: 3.3651 - val_accuracy300: 0.3397 - 50s/epoch - 41ms/step
Epoch 8/50
1230/1230 - 50s - loss: 3.2131 - accuracy300: 0.4162 - val_loss: 3.3907 - val_accuracy300: 0.3423 - 50s/epoch - 41ms/step
Epoch 9/50
1230/1230 - 50s - loss: 3.2041 - accuracy300: 0.4202 - val_loss: 3.3632 - val_accuracy300: 0.3457 - 50s/epoch - 40ms/step
Epoch 10/50
1230/1230 - 50s - loss: 3.1960 - accuracy300: 0.4234 - val_loss: 3.4175 - val_accuracy300: 0.3446 - 50s/epoch - 41ms/step
Epoch 11/50
1230/1230 - 50s - loss: 3.1854 - accuracy300: 0.4301 - val_loss: 3.3626 - val_accuracy300: 0.3476 - 50s/epoch - 41ms/step
Epoch 12/50
1230/1230 - 50s - loss: 3.1754 - accuracy300: 0.4334 - val_loss: 3.3690 - val_accuracy300: 0.3476 - 50s/epoch - 41ms/step
testing model: results/WBA/W10/deepLOB_L2/h300
Evaluating performance on  test set...
6546/6546 - 91s - 91s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1057159
{'0': {'precision': 0.3392160984080752, 'recall': 0.2370863035068451, 'f1-score': 0.2791017028364136, 'support': 571796}, '1': {'precision': 0.3337036749711854, 'recall': 0.4389746094283887, 'f1-score': 0.3791680013347993, 'support': 548747}, '2': {'precision': 0.34249130840329006, 'recall': 0.34190221639476537, 'f1-score': 0.3421965088684331, 'support': 555226}, 'accuracy': 0.33792485718497, 'macro avg': {'precision': 0.3384703605941836, 'recall': 0.3393210431099997, 'f1-score': 0.333488737679882, 'support': 1675769}, 'weighted avg': {'precision': 0.33849616381152886, 'recall': 0.33792485718497, 'f1-score': 0.3327743497680776, 'support': 1675769}}
[[135565 244063 192168]
 [135591 240886 172270]
 [128486 236907 189833]]
Evaluating performance on  train set...
1230/1230 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1061593
{'0': {'precision': 0.35801171347049104, 'recall': 0.3683794322695583, 'f1-score': 0.3631215840874473, 'support': 110017}, '1': {'precision': 0.33363530477546266, 'recall': 0.4168864902014291, 'f1-score': 0.3706436032797933, 'support': 98943}, '2': {'precision': 0.3465708603323282, 'recall': 0.255268878177866, 'f1-score': 0.29399439440528996, 'support': 105810}, 'accuracy': 0.3456047272611748, 'macro avg': {'precision': 0.3460726261927607, 'recall': 0.3468449335496178, 'f1-score': 0.3425865272575102, 'support': 314770}, 'weighted avg': {'precision': 0.3465035275694801, 'recall': 0.3456047272611748, 'f1-score': 0.34224889356636595, 'support': 314770}}
[[40528 42050 27439]
 [34209 41248 23486]
 [38466 40334 27010]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1086334
{'0': {'precision': 0.33543577981651373, 'recall': 0.24644549763033174, 'f1-score': 0.2841357537490134, 'support': 37980}, '1': {'precision': 0.33995813927177415, 'recall': 0.46125310205439146, 'f1-score': 0.3914242292661745, 'support': 39087}, '2': {'precision': 0.3274456103640336, 'recall': 0.2926004344598125, 'f1-score': 0.30904391263940517, 'support': 36367}, 'accuracy': 0.33526103284729447, 'macro avg': {'precision': 0.3342798431507738, 'recall': 0.3334330113815119, 'f1-score': 0.328201298551531, 'support': 113434}, 'weighted avg': {'precision': 0.3344324384157822, 'recall': 0.33526103284729447, 'f1-score': 0.3290907025025278, 'support': 113434}}
[[ 9360 17894 10726]
 [ 9928 18029 11130]
 [ 8616 17110 10641]]
training model: results/WBA/W10/deepLOB_L2/h500
Epoch 1/50
1230/1230 - 53s - loss: 3.2679 - accuracy500: 0.3939 - val_loss: 3.3167 - val_accuracy500: 0.3501 - 53s/epoch - 43ms/step
Epoch 2/50
1230/1230 - 51s - loss: 3.2447 - accuracy500: 0.3970 - val_loss: 3.3399 - val_accuracy500: 0.3417 - 51s/epoch - 41ms/step
Epoch 3/50
1230/1230 - 50s - loss: 3.2344 - accuracy500: 0.4063 - val_loss: 3.3725 - val_accuracy500: 0.3362 - 50s/epoch - 41ms/step
Epoch 4/50
1230/1230 - 51s - loss: 3.2134 - accuracy500: 0.4198 - val_loss: 3.3883 - val_accuracy500: 0.3396 - 51s/epoch - 41ms/step
Epoch 5/50
1230/1230 - 50s - loss: 3.2008 - accuracy500: 0.4272 - val_loss: 3.3858 - val_accuracy500: 0.3234 - 50s/epoch - 41ms/step
Epoch 6/50
1230/1230 - 50s - loss: 3.1794 - accuracy500: 0.4382 - val_loss: 3.4183 - val_accuracy500: 0.3298 - 50s/epoch - 41ms/step
Epoch 7/50
1230/1230 - 50s - loss: 3.1662 - accuracy500: 0.4435 - val_loss: 3.3930 - val_accuracy500: 0.3369 - 50s/epoch - 41ms/step
Epoch 8/50
1230/1230 - 50s - loss: 3.1446 - accuracy500: 0.4536 - val_loss: 3.4327 - val_accuracy500: 0.3356 - 50s/epoch - 41ms/step
Epoch 9/50
1230/1230 - 51s - loss: 3.1335 - accuracy500: 0.4570 - val_loss: 3.3887 - val_accuracy500: 0.3400 - 51s/epoch - 41ms/step
Epoch 10/50
1230/1230 - 50s - loss: 3.1242 - accuracy500: 0.4609 - val_loss: 3.4123 - val_accuracy500: 0.3383 - 50s/epoch - 41ms/step
Epoch 11/50
1230/1230 - 50s - loss: 3.1078 - accuracy500: 0.4655 - val_loss: 3.4375 - val_accuracy500: 0.3330 - 50s/epoch - 41ms/step
testing model: results/WBA/W10/deepLOB_L2/h500
Evaluating performance on  test set...
6546/6546 - 95s - 95s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1035496
{'0': {'precision': 0.36711796790877477, 'recall': 0.3347012607462768, 'f1-score': 0.3501609579354283, 'support': 621378}, '1': {'precision': 0.25936507936507935, 'recall': 0.06982324907733724, 'f1-score': 0.11002645582338214, 'support': 444637}, '2': {'precision': 0.3651656950217218, 'recall': 0.5926209586160976, 'f1-score': 0.4518852782413449, 'support': 609754}, 'accuracy': 0.3582683532157475, 'macro avg': {'precision': 0.330549580765192, 'recall': 0.3323818228132372, 'f1-score': 0.30402423066671846, 'support': 1675769}, 'weighted avg': {'precision': 0.3378171947679808, 'recall': 0.3582683532157475, 'f1-score': 0.32345926252766033, 'support': 1675769}}
[[207976  45786 367616]
 [153001  31046 260590]
 [205533  42868 361353]]
Evaluating performance on  train set...
1230/1230 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1137499
{'0': {'precision': 0.32587383205618137, 'recall': 0.2992980392877488, 'f1-score': 0.31202107279693486, 'support': 108838}, '1': {'precision': 0.33424565188081434, 'recall': 0.24493405127698464, 'f1-score': 0.28270376600051317, 'support': 101215}, '2': {'precision': 0.3492086064932664, 'recall': 0.46899739297344273, 'f1-score': 0.40033420961464, 'support': 104717}, 'accuracy': 0.33827238936366233, 'macro avg': {'precision': 0.33644269681008737, 'recall': 0.337743161179392, 'f1-score': 0.33168634947069603, 'support': 314770}, 'weighted avg': {'precision': 0.33632877159387065, 'recall': 0.33827238936366233, 'f1-score': 0.33197384955691767, 'support': 314770}}
[[32575 24993 51270]
 [36168 24791 40256]
 [31219 24386 49112]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1071502
{'0': {'precision': 0.3331185105621196, 'recall': 0.23181183974486744, 'f1-score': 0.27338171774454206, 'support': 40136}, '1': {'precision': 0.34651539708265805, 'recall': 0.27802340702210665, 'f1-score': 0.3085137085137086, 'support': 34605}, '2': {'precision': 0.36013786175721785, 'recall': 0.5374098674178792, 'f1-score': 0.4312676290028207, 'support': 38693}, 'accuracy': 0.35015074845284483, 'macro avg': {'precision': 0.34659058980066515, 'recall': 0.3490817047282844, 'f1-score': 0.3377210184203571, 'support': 113434}, 'weighted avg': {'precision': 0.3464219205964582, 'recall': 0.35015074845284483, 'f1-score': 0.33795514462610826, 'support': 113434}}
[[ 9304  9365 21467]
 [ 9506  9621 15478]
 [ 9120  8779 20794]]
training model: results/WBA/W10/deepLOB_L2/h1000
Epoch 1/50
1230/1230 - 54s - loss: 3.2878 - accuracy1000: 0.3880 - val_loss: 3.3184 - val_accuracy1000: 0.3666 - 54s/epoch - 44ms/step
Epoch 2/50
1230/1230 - 50s - loss: 3.2582 - accuracy1000: 0.3893 - val_loss: 3.3954 - val_accuracy1000: 0.3420 - 50s/epoch - 41ms/step
Epoch 3/50
1230/1230 - 50s - loss: 3.2067 - accuracy1000: 0.4168 - val_loss: 3.3628 - val_accuracy1000: 0.3486 - 50s/epoch - 41ms/step
Epoch 4/50
1230/1230 - 50s - loss: 3.1966 - accuracy1000: 0.4230 - val_loss: 3.3611 - val_accuracy1000: 0.3627 - 50s/epoch - 41ms/step
Epoch 5/50
1230/1230 - 50s - loss: 3.1728 - accuracy1000: 0.4330 - val_loss: 3.3819 - val_accuracy1000: 0.3605 - 50s/epoch - 40ms/step
Epoch 6/50
1230/1230 - 50s - loss: 3.1686 - accuracy1000: 0.4405 - val_loss: 3.3707 - val_accuracy1000: 0.3674 - 50s/epoch - 40ms/step
Epoch 7/50
1230/1230 - 50s - loss: 3.1517 - accuracy1000: 0.4457 - val_loss: 3.4244 - val_accuracy1000: 0.3397 - 50s/epoch - 41ms/step
Epoch 8/50
1230/1230 - 51s - loss: 3.1381 - accuracy1000: 0.4499 - val_loss: 3.5282 - val_accuracy1000: 0.3405 - 51s/epoch - 41ms/step
Epoch 9/50
1230/1230 - 50s - loss: 3.1354 - accuracy1000: 0.4524 - val_loss: 3.5267 - val_accuracy1000: 0.3346 - 50s/epoch - 41ms/step
Epoch 10/50
1230/1230 - 50s - loss: 3.1253 - accuracy1000: 0.4554 - val_loss: 3.4471 - val_accuracy1000: 0.3647 - 50s/epoch - 41ms/step
Epoch 11/50
1230/1230 - 50s - loss: 3.1190 - accuracy1000: 0.4577 - val_loss: 3.4567 - val_accuracy1000: 0.3509 - 50s/epoch - 41ms/step
testing model: results/WBA/W10/deepLOB_L2/h1000
Evaluating performance on  test set...
6546/6546 - 88s - 88s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.105945
{'0': {'precision': 0.4006611248845462, 'recall': 0.015140715702843706, 'f1-score': 0.02917878466573794, 'support': 544360}, '1': {'precision': 0.36201140212373595, 'recall': 0.8968601682473378, 'f1-score': 0.5158168865795348, 'support': 602803}, '2': {'precision': 0.321153085443038, 'recall': 0.09829627359507838, 'f1-score': 0.15052187289070942, 'support': 528606}, 'accuracy': 0.3585410638339771, 'macro avg': {'precision': 0.36127520415044007, 'recall': 0.3367657191817533, 'f1-score': 0.23183918137866075, 'support': 1675769}, 'weighted avg': {'precision': 0.3616780696266899, 'recall': 0.3585410638339771, 'f1-score': 0.24250746674673584, 'support': 1675769}}
[[  8242 481318  54800]
 [  7141 540630  55032]
 [  5188 471458  51960]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1190714
{'0': {'precision': 0.32818446384598166, 'recall': 0.027533360253171688, 'f1-score': 0.05080443239215754, 'support': 106489}, '1': {'precision': 0.3381989814751766, 'recall': 0.8864091075605152, 'f1-score': 0.48959770890187093, 'support': 106461}, '2': {'precision': 0.323484424547659, 'recall': 0.08516008642702809, 'f1-score': 0.13482604470359572, 'support': 101820}, 'accuracy': 0.33666168948756237, 'macro avg': {'precision': 0.3299559566229391, 'recall': 0.333034184746905, 'f1-score': 0.22507606199920807, 'support': 314770}, 'weighted avg': {'precision': 0.3300512159505867, 'recall': 0.33666168948756237, 'f1-score': 0.22639121504632162, 'support': 314770}}
[[ 2932 94247  9310]
 [ 3269 94368  8824]
 [ 2733 90416  8671]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1057172
{'0': {'precision': 0.3111758474576271, 'recall': 0.03239413321570357, 'f1-score': 0.05867958449860168, 'support': 36272}, '1': {'precision': 0.37198326293453904, 'recall': 0.8850200518990328, 'f1-score': 0.52380553461227, 'support': 42390}, '2': {'precision': 0.3078146297137665, 'recall': 0.07793627056252157, 'f1-score': 0.12438039287681293, 'support': 34772}, 'accuracy': 0.36497875416541775, 'macro avg': {'precision': 0.3303245800353109, 'recall': 0.3317834852257527, 'f1-score': 0.23562183732922817, 'support': 113434}, 'weighted avg': {'precision': 0.3328690794575282, 'recall': 0.36497875416541775, 'f1-score': 0.25263587215702477, 'support': 113434}}
[[ 1175 32330  2767]
 [ 1547 37516  3327]
 [ 1054 31008  2710]]
training model: results/WBA/W10/deepOF_L2/h10
Epoch 1/50
1230/1230 - 30s - loss: 3.0192 - accuracy10: 0.4547 - val_loss: 2.6622 - val_accuracy10: 0.6436 - 30s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 28s - loss: 2.7995 - accuracy10: 0.5275 - val_loss: 2.5753 - val_accuracy10: 0.6650 - 28s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 27s - loss: 2.6999 - accuracy10: 0.5566 - val_loss: 2.5173 - val_accuracy10: 0.6651 - 27s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 27s - loss: 2.6522 - accuracy10: 0.5675 - val_loss: 2.4898 - val_accuracy10: 0.6615 - 27s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 27s - loss: 2.6248 - accuracy10: 0.5719 - val_loss: 2.4852 - val_accuracy10: 0.6532 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 27s - loss: 2.6056 - accuracy10: 0.5751 - val_loss: 2.5022 - val_accuracy10: 0.6477 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 27s - loss: 2.5907 - accuracy10: 0.5776 - val_loss: 2.4785 - val_accuracy10: 0.6420 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 27s - loss: 2.5779 - accuracy10: 0.5794 - val_loss: 2.4766 - val_accuracy10: 0.6491 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 27s - loss: 2.5670 - accuracy10: 0.5814 - val_loss: 2.4719 - val_accuracy10: 0.6445 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 27s - loss: 2.5571 - accuracy10: 0.5822 - val_loss: 2.4716 - val_accuracy10: 0.6475 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 27s - loss: 2.5490 - accuracy10: 0.5843 - val_loss: 2.4764 - val_accuracy10: 0.6497 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 27s - loss: 2.5415 - accuracy10: 0.5853 - val_loss: 2.4620 - val_accuracy10: 0.6492 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 27s - loss: 2.5339 - accuracy10: 0.5865 - val_loss: 2.4813 - val_accuracy10: 0.6490 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 27s - loss: 2.5276 - accuracy10: 0.5868 - val_loss: 2.4658 - val_accuracy10: 0.6451 - 27s/epoch - 22ms/step
Epoch 15/50
1230/1230 - 27s - loss: 2.5188 - accuracy10: 0.5892 - val_loss: 2.4793 - val_accuracy10: 0.6461 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 27s - loss: 2.5131 - accuracy10: 0.5895 - val_loss: 2.4712 - val_accuracy10: 0.6474 - 27s/epoch - 22ms/step
Epoch 17/50
1230/1230 - 27s - loss: 2.5085 - accuracy10: 0.5900 - val_loss: 2.4794 - val_accuracy10: 0.6483 - 27s/epoch - 22ms/step
Epoch 18/50
1230/1230 - 27s - loss: 2.5007 - accuracy10: 0.5916 - val_loss: 2.4822 - val_accuracy10: 0.6469 - 27s/epoch - 22ms/step
Epoch 19/50
1230/1230 - 27s - loss: 2.4947 - accuracy10: 0.5921 - val_loss: 2.4723 - val_accuracy10: 0.6484 - 27s/epoch - 22ms/step
Epoch 20/50
1230/1230 - 27s - loss: 2.4877 - accuracy10: 0.5936 - val_loss: 2.4874 - val_accuracy10: 0.6396 - 27s/epoch - 22ms/step
Epoch 21/50
1230/1230 - 27s - loss: 2.4830 - accuracy10: 0.5931 - val_loss: 2.4780 - val_accuracy10: 0.6450 - 27s/epoch - 22ms/step
Epoch 22/50
1230/1230 - 27s - loss: 2.4768 - accuracy10: 0.5946 - val_loss: 2.4887 - val_accuracy10: 0.6464 - 27s/epoch - 22ms/step
testing model: results/WBA/W10/deepOF_L2/h10
Evaluating performance on  test set...
6546/6546 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90960914
{'0': {'precision': 0.43231080845759745, 'recall': 0.45813678672602187, 'f1-score': 0.44484927743075314, 'support': 308875}, '1': {'precision': 0.7910204232745467, 'recall': 0.5637583386654931, 'f1-score': 0.6583279457926288, 'support': 1061171}, '2': {'precision': 0.33513526293479784, 'recall': 0.6491210854447563, 'f1-score': 0.4420461519099282, 'support': 305718}, 'accuracy': 0.5598634413915086, 'macro avg': {'precision': 0.5194888315556473, 'recall': 0.5570054036120905, 'f1-score': 0.51507445837777, 'support': 1675764}, 'weighted avg': {'precision': 0.6417340489847705, 'recall': 0.5598634413915086, 'f1-score': 0.579522421176689, 'support': 1675764}}
[[141507  86928  80440]
 [149672 598244 313255]
 [ 36148  71122 198448]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85082704
{'0': {'precision': 0.44149241988682786, 'recall': 0.4674708831963602, 'f1-score': 0.4541104151266389, 'support': 62421}, '1': {'precision': 0.781108775286698, 'recall': 0.6506325397532754, 'f1-score': 0.7099254326877698, 'support': 190739}, '2': {'precision': 0.4019889527373157, 'recall': 0.5859141669912998, 'f1-score': 0.47683020263665427, 'support': 61608}, 'accuracy': 0.6016431149290906, 'macro avg': {'precision': 0.5415300493036138, 'recall': 0.5680058633136452, 'f1-score': 0.5469553501503542, 'support': 314768}, 'weighted avg': {'precision': 0.6395568813583519, 'recall': 0.6016431149290906, 'f1-score': 0.6135726898925286, 'support': 314768}}
[[ 29180  17915  15326]
 [ 28265 124101  38373]
 [  8649  16862  36097]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78016835
{'0': {'precision': 0.4424185214626391, 'recall': 0.45591849272987917, 'f1-score': 0.4490670700958144, 'support': 19532}, '1': {'precision': 0.8140834348355663, 'recall': 0.7123691012283834, 'f1-score': 0.7598374284130797, 'support': 75058}, '2': {'precision': 0.40110049232551404, 'recall': 0.5880479779216644, 'f1-score': 0.4769078465975122, 'support': 18842}, 'accuracy': 0.6475597714930531, 'macro avg': {'precision': 0.5525341495412398, 'recall': 0.5854451906266424, 'f1-score': 0.5619374483688021, 'support': 113432}, 'weighted avg': {'precision': 0.6814860752653003, 'recall': 0.6475597714930531, 'f1-score': 0.6593285259938174, 'support': 113432}}
[[ 8905  6429  4198]
 [ 9243 53469 12346]
 [ 1980  5782 11080]]
training model: results/WBA/W10/deepOF_L2/h20
Epoch 1/50
1230/1230 - 29s - loss: 3.0759 - accuracy20: 0.4496 - val_loss: 2.7748 - val_accuracy20: 0.5875 - 29s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 27s - loss: 2.8684 - accuracy20: 0.5197 - val_loss: 2.6981 - val_accuracy20: 0.6105 - 27s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 27s - loss: 2.7730 - accuracy20: 0.5484 - val_loss: 2.6340 - val_accuracy20: 0.6184 - 27s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 27s - loss: 2.7294 - accuracy20: 0.5594 - val_loss: 2.6491 - val_accuracy20: 0.6090 - 27s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 27s - loss: 2.7044 - accuracy20: 0.5650 - val_loss: 2.6123 - val_accuracy20: 0.6179 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 27s - loss: 2.6849 - accuracy20: 0.5698 - val_loss: 2.6034 - val_accuracy20: 0.6216 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 27s - loss: 2.6721 - accuracy20: 0.5719 - val_loss: 2.5885 - val_accuracy20: 0.6240 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 27s - loss: 2.6612 - accuracy20: 0.5741 - val_loss: 2.6069 - val_accuracy20: 0.6228 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 27s - loss: 2.6507 - accuracy20: 0.5762 - val_loss: 2.6018 - val_accuracy20: 0.6233 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 27s - loss: 2.6428 - accuracy20: 0.5765 - val_loss: 2.6076 - val_accuracy20: 0.6208 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 27s - loss: 2.6355 - accuracy20: 0.5782 - val_loss: 2.5868 - val_accuracy20: 0.6238 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 27s - loss: 2.6278 - accuracy20: 0.5792 - val_loss: 2.5926 - val_accuracy20: 0.6234 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 27s - loss: 2.6202 - accuracy20: 0.5809 - val_loss: 2.5868 - val_accuracy20: 0.6272 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 27s - loss: 2.6154 - accuracy20: 0.5813 - val_loss: 2.5885 - val_accuracy20: 0.6258 - 27s/epoch - 22ms/step
Epoch 15/50
1230/1230 - 27s - loss: 2.6085 - accuracy20: 0.5828 - val_loss: 2.5930 - val_accuracy20: 0.6255 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 27s - loss: 2.6039 - accuracy20: 0.5837 - val_loss: 2.5958 - val_accuracy20: 0.6269 - 27s/epoch - 22ms/step
Epoch 17/50
1230/1230 - 27s - loss: 2.5980 - accuracy20: 0.5852 - val_loss: 2.5856 - val_accuracy20: 0.6243 - 27s/epoch - 22ms/step
Epoch 18/50
1230/1230 - 27s - loss: 2.5913 - accuracy20: 0.5864 - val_loss: 2.5926 - val_accuracy20: 0.6233 - 27s/epoch - 22ms/step
Epoch 19/50
1230/1230 - 27s - loss: 2.5865 - accuracy20: 0.5866 - val_loss: 2.5847 - val_accuracy20: 0.6233 - 27s/epoch - 22ms/step
Epoch 20/50
1230/1230 - 27s - loss: 2.5797 - accuracy20: 0.5880 - val_loss: 2.5903 - val_accuracy20: 0.6268 - 27s/epoch - 22ms/step
Epoch 21/50
1230/1230 - 27s - loss: 2.5747 - accuracy20: 0.5886 - val_loss: 2.5900 - val_accuracy20: 0.6235 - 27s/epoch - 22ms/step
Epoch 22/50
1230/1230 - 27s - loss: 2.5703 - accuracy20: 0.5892 - val_loss: 2.5856 - val_accuracy20: 0.6207 - 27s/epoch - 22ms/step
Epoch 23/50
1230/1230 - 27s - loss: 2.5623 - accuracy20: 0.5905 - val_loss: 2.6015 - val_accuracy20: 0.6165 - 27s/epoch - 22ms/step
Epoch 24/50
1230/1230 - 27s - loss: 2.5577 - accuracy20: 0.5915 - val_loss: 2.6069 - val_accuracy20: 0.6194 - 27s/epoch - 22ms/step
Epoch 25/50
1230/1230 - 27s - loss: 2.5545 - accuracy20: 0.5918 - val_loss: 2.6039 - val_accuracy20: 0.6191 - 27s/epoch - 22ms/step
Epoch 26/50
1230/1230 - 27s - loss: 2.5471 - accuracy20: 0.5936 - val_loss: 2.6138 - val_accuracy20: 0.6182 - 27s/epoch - 22ms/step
Epoch 27/50
1230/1230 - 27s - loss: 2.5414 - accuracy20: 0.5945 - val_loss: 2.6132 - val_accuracy20: 0.6176 - 27s/epoch - 22ms/step
Epoch 28/50
1230/1230 - 27s - loss: 2.5371 - accuracy20: 0.5948 - val_loss: 2.6268 - val_accuracy20: 0.6148 - 27s/epoch - 22ms/step
Epoch 29/50
1230/1230 - 27s - loss: 2.5296 - accuracy20: 0.5954 - val_loss: 2.6278 - val_accuracy20: 0.6179 - 27s/epoch - 22ms/step
testing model: results/WBA/W10/deepOF_L2/h20
Evaluating performance on  test set...
6546/6546 - 48s - 48s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9554824
{'0': {'precision': 0.4715557214505767, 'recall': 0.4525966031223825, 'f1-score': 0.4618816877619749, 'support': 396364}, '1': {'precision': 0.7060756549190467, 'recall': 0.5608076022897104, 'f1-score': 0.6251129972981231, 'support': 886575}, '2': {'precision': 0.4056160293657439, 'recall': 0.6104143066250876, 'f1-score': 0.4873748716958507, 'support': 392825}, 'accuracy': 0.5468413213316433, 'macro avg': {'precision': 0.5277491352451223, 'recall': 0.5412728373457268, 'f1-score': 0.5247898522519829, 'support': 1675764}, 'weighted avg': {'precision': 0.580172895749335, 'recall': 0.5468413213316433, 'f1-score': 0.554216382999989, 'support': 1675764}}
[[179393 110811 106160]
 [144158 497198 245219]
 [ 56877  96162 239786]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89293164
{'0': {'precision': 0.518258619377426, 'recall': 0.4295284232836273, 'f1-score': 0.46974013700236616, 'support': 79266}, '1': {'precision': 0.6804215950048226, 'recall': 0.681346821029623, 'f1-score': 0.6808838937041622, 'support': 157378}, '2': {'precision': 0.4680534755850942, 'recall': 0.548077415390917, 'f1-score': 0.5049143598360898, 'support': 78124}, 'accuracy': 0.5848561480201291, 'macro avg': {'precision': 0.555577896655781, 'recall': 0.552984219901389, 'f1-score': 0.5518461301808727, 'support': 314768}, 'weighted avg': {'precision': 0.5868763255122817, 'recall': 0.5848561480201291, 'f1-score': 0.5840380742986513, 'support': 314768}}
[[ 34047  26472  18747]
 [ 20233 107229  29916]
 [ 11415  23891  42818]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.835177
{'0': {'precision': 0.518186372745491, 'recall': 0.4153148088660456, 'f1-score': 0.46108238231098425, 'support': 24904}, '1': {'precision': 0.7268092686147751, 'recall': 0.7367650950298087, 'f1-score': 0.7317533200377224, 'support': 64243}, '2': {'precision': 0.4644255529295566, 'recall': 0.5421453572163887, 'f1-score': 0.5002849868906031, 'support': 24285}, 'accuracy': 0.6245239438606389, 'macro avg': {'precision': 0.5698070647632743, 'recall': 0.564741753704081, 'f1-score': 0.5643735630797698, 'support': 113432}, 'weighted avg': {'precision': 0.6248315803597484, 'recall': 0.6245239438606389, 'f1-score': 0.6227717495494609, 'support': 113432}}
[[10343  9512  5049]
 [ 6777 47332 10134]
 [ 2840  8279 13166]]
training model: results/WBA/W10/deepOF_L2/h30
Epoch 1/50
1230/1230 - 29s - loss: 3.1123 - accuracy30: 0.4442 - val_loss: 2.8763 - val_accuracy30: 0.5469 - 29s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 27s - loss: 2.9312 - accuracy30: 0.5069 - val_loss: 2.7778 - val_accuracy30: 0.5722 - 27s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 27s - loss: 2.8449 - accuracy30: 0.5320 - val_loss: 2.7296 - val_accuracy30: 0.5799 - 27s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 27s - loss: 2.8016 - accuracy30: 0.5437 - val_loss: 2.7358 - val_accuracy30: 0.5768 - 27s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 27s - loss: 2.7781 - accuracy30: 0.5496 - val_loss: 2.7308 - val_accuracy30: 0.5788 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 27s - loss: 2.7621 - accuracy30: 0.5535 - val_loss: 2.7247 - val_accuracy30: 0.5810 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 27s - loss: 2.7494 - accuracy30: 0.5561 - val_loss: 2.7141 - val_accuracy30: 0.5796 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 27s - loss: 2.7385 - accuracy30: 0.5587 - val_loss: 2.7246 - val_accuracy30: 0.5787 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 27s - loss: 2.7302 - accuracy30: 0.5600 - val_loss: 2.7147 - val_accuracy30: 0.5832 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 27s - loss: 2.7225 - accuracy30: 0.5615 - val_loss: 2.7220 - val_accuracy30: 0.5826 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 26s - loss: 2.7140 - accuracy30: 0.5630 - val_loss: 2.7007 - val_accuracy30: 0.5842 - 26s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 26s - loss: 2.7073 - accuracy30: 0.5647 - val_loss: 2.7152 - val_accuracy30: 0.5771 - 26s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 27s - loss: 2.7005 - accuracy30: 0.5665 - val_loss: 2.7179 - val_accuracy30: 0.5824 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 27s - loss: 2.6935 - accuracy30: 0.5672 - val_loss: 2.7191 - val_accuracy30: 0.5797 - 27s/epoch - 22ms/step
Epoch 15/50
1230/1230 - 27s - loss: 2.6873 - accuracy30: 0.5685 - val_loss: 2.7223 - val_accuracy30: 0.5791 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 27s - loss: 2.6824 - accuracy30: 0.5700 - val_loss: 2.7224 - val_accuracy30: 0.5777 - 27s/epoch - 22ms/step
Epoch 17/50
1230/1230 - 27s - loss: 2.6770 - accuracy30: 0.5706 - val_loss: 2.7210 - val_accuracy30: 0.5762 - 27s/epoch - 22ms/step
Epoch 18/50
1230/1230 - 26s - loss: 2.6691 - accuracy30: 0.5727 - val_loss: 2.7323 - val_accuracy30: 0.5732 - 26s/epoch - 22ms/step
Epoch 19/50
1230/1230 - 27s - loss: 2.6634 - accuracy30: 0.5730 - val_loss: 2.7170 - val_accuracy30: 0.5777 - 27s/epoch - 22ms/step
Epoch 20/50
1230/1230 - 27s - loss: 2.6576 - accuracy30: 0.5747 - val_loss: 2.7515 - val_accuracy30: 0.5692 - 27s/epoch - 22ms/step
Epoch 21/50
1230/1230 - 27s - loss: 2.6522 - accuracy30: 0.5751 - val_loss: 2.7428 - val_accuracy30: 0.5697 - 27s/epoch - 22ms/step
testing model: results/WBA/W10/deepOF_L2/h30
Evaluating performance on  test set...
6546/6546 - 49s - 49s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99402004
{'0': {'precision': 0.4897302600256804, 'recall': 0.44732651738944224, 'f1-score': 0.46756896051020047, 'support': 455305}, '1': {'precision': 0.6190833564733165, 'recall': 0.5352116879628465, 'f1-score': 0.5741004430451104, 'support': 770639}, '2': {'precision': 0.4198252496854191, 'recall': 0.55406162464986, 'f1-score': 0.4776921550945071, 'support': 449820}, 'accuracy': 0.5163931197949114, 'macro avg': {'precision': 0.5095462887281387, 'recall': 0.5121999433340495, 'f1-score': 0.5064538528832726, 'support': 1675764}, 'weighted avg': {'precision': 0.5304519064759284, 'recall': 0.5163931197949114, 'f1-score': 0.5192772741851173, 'support': 1675764}}
[[203670 134834 116801]
 [130566 412455 227618]
 [ 81646 118946 249228]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9454485
{'0': {'precision': 0.5198508902270536, 'recall': 0.44175176660833354, 'f1-score': 0.47762981414064004, 'support': 90286}, '1': {'precision': 0.5913989041024232, 'recall': 0.6676928074177426, 'f1-score': 0.6272343642182716, 'support': 135459}, '2': {'precision': 0.4969334523921421, 'recall': 0.4751019399481033, 'f1-score': 0.4857725328050076, 'support': 89023}, 'accuracy': 0.5484166115996544, 'macro avg': {'precision': 0.5360610822405396, 'recall': 0.5281821713247264, 'f1-score': 0.5302122370546397, 'support': 314768}, 'weighted avg': {'precision': 0.5441597251250303, 'recall': 0.5484166115996544, 'f1-score': 0.5443143945065726, 'support': 314768}}
[[39884 32586 17816]
 [20013 90445 25001]
 [16825 29903 42295]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8904238
{'0': {'precision': 0.5281035531230996, 'recall': 0.4245408198896571, 'f1-score': 0.47069299264421216, 'support': 28638}, '1': {'precision': 0.647169691786246, 'recall': 0.7188901986312215, 'f1-score': 0.681147219883811, 'support': 56839}, '2': {'precision': 0.4914197711938985, 'recall': 0.4794133428724736, 'f1-score': 0.48534231444764336, 'support': 27955}, 'accuracy': 0.5855578672684957, 'macro avg': {'precision': 0.5555643387010814, 'recall': 0.5409481204644507, 'f1-score': 0.5457275089918888, 'support': 113432}, 'weighted avg': {'precision': 0.5787251161004231, 'recall': 0.5855578672684957, 'f1-score': 0.5797585968219264, 'support': 113432}}
[[12158 11761  4719]
 [ 6827 40861  9151]
 [ 4037 10516 13402]]
training model: results/WBA/W10/deepOF_L2/h50
Epoch 1/50
1230/1230 - 30s - loss: 3.1681 - accuracy50: 0.4306 - val_loss: 3.0494 - val_accuracy50: 0.4782 - 30s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 26s - loss: 3.0237 - accuracy50: 0.4799 - val_loss: 2.9720 - val_accuracy50: 0.5014 - 26s/epoch - 21ms/step
Epoch 3/50
1230/1230 - 27s - loss: 2.9623 - accuracy50: 0.4962 - val_loss: 2.9192 - val_accuracy50: 0.5125 - 27s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 26s - loss: 2.9247 - accuracy50: 0.5057 - val_loss: 2.8937 - val_accuracy50: 0.5198 - 26s/epoch - 21ms/step
Epoch 5/50
1230/1230 - 27s - loss: 2.8999 - accuracy50: 0.5118 - val_loss: 2.8999 - val_accuracy50: 0.5168 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 27s - loss: 2.8847 - accuracy50: 0.5158 - val_loss: 2.8917 - val_accuracy50: 0.5214 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 27s - loss: 2.8721 - accuracy50: 0.5195 - val_loss: 2.9017 - val_accuracy50: 0.5202 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 27s - loss: 2.8636 - accuracy50: 0.5230 - val_loss: 2.8998 - val_accuracy50: 0.5224 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 27s - loss: 2.8549 - accuracy50: 0.5251 - val_loss: 2.9074 - val_accuracy50: 0.5196 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 27s - loss: 2.8484 - accuracy50: 0.5264 - val_loss: 2.9057 - val_accuracy50: 0.5200 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 27s - loss: 2.8407 - accuracy50: 0.5278 - val_loss: 2.9080 - val_accuracy50: 0.5193 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 27s - loss: 2.8328 - accuracy50: 0.5298 - val_loss: 2.9210 - val_accuracy50: 0.5170 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 27s - loss: 2.8269 - accuracy50: 0.5318 - val_loss: 2.9216 - val_accuracy50: 0.5162 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 27s - loss: 2.8210 - accuracy50: 0.5336 - val_loss: 2.9270 - val_accuracy50: 0.5151 - 27s/epoch - 22ms/step
Epoch 15/50
1230/1230 - 27s - loss: 2.8146 - accuracy50: 0.5355 - val_loss: 2.9350 - val_accuracy50: 0.5156 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 27s - loss: 2.8098 - accuracy50: 0.5364 - val_loss: 2.9609 - val_accuracy50: 0.5098 - 27s/epoch - 22ms/step
testing model: results/WBA/W10/deepOF_L2/h50
Evaluating performance on  test set...
6546/6546 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0261776
{'0': {'precision': 0.5208506361415038, 'recall': 0.3255430356581974, 'f1-score': 0.4006629606610162, 'support': 531687}, '1': {'precision': 0.5051052043544132, 'recall': 0.5556204374865276, 'f1-score': 0.5291599704011017, 'support': 621642}, '2': {'precision': 0.43157286746023565, 'recall': 0.5449118072104664, 'f1-score': 0.48166480693630076, 'support': 522435}, 'accuracy': 0.47928288231517086, 'macro avg': {'precision': 0.48584290265205093, 'recall': 0.47535842678506385, 'f1-score': 0.4704959126661396, 'support': 1675764}, 'weighted avg': {'precision': 0.4871765312031062, 'recall': 0.47928288231517086, 'f1-score': 0.47358333470394504, 'support': 1675764}}
[[173087 181282 177318]
 [ 78608 345397 197637]
 [ 80621 157133 284681]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0006934
{'0': {'precision': 0.5420408031192868, 'recall': 0.31968816496340613, 'f1-score': 0.4021775665034092, 'support': 104799}, '1': {'precision': 0.46429994769223104, 'recall': 0.697131477083606, 'f1-score': 0.5573779070202062, 'support': 106954}, '2': {'precision': 0.5017592101417111, 'recall': 0.44991506091345923, 'f1-score': 0.4744249843898744, 'support': 103015}, 'accuracy': 0.49055812534946375, 'macro avg': {'precision': 0.5026999869844097, 'recall': 0.4889115676534905, 'f1-score': 0.47799348597116326, 'support': 314768}, 'weighted avg': {'precision': 0.5024424203359978, 'recall': 0.49055812534946375, 'f1-score': 0.4785572015781554, 'support': 314768}}
[[33503 46375 24921]
 [11291 74561 21102]
 [17015 39652 46348]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9641141
{'0': {'precision': 0.5524924685954641, 'recall': 0.28731894767957433, 'f1-score': 0.37804095443673064, 'support': 33830}, '1': {'precision': 0.5256662330983999, 'recall': 0.7444949018935824, 'f1-score': 0.6162302086842432, 'support': 46684}, '2': {'precision': 0.4951717640725413, 'recall': 0.4470806245822954, 'f1-score': 0.46989894474688293, 'support': 32918}, 'accuracy': 0.5218368714295789, 'macro avg': {'precision': 0.5244434885888017, 'recall': 0.4929648247184841, 'f1-score': 0.48805670262261885, 'support': 113432}, 'weighted avg': {'precision': 0.524817395164417, 'recall': 0.5218368714295789, 'f1-score': 0.5027271846920419, 'support': 113432}}
[[ 9720 17282  6828]
 [ 3752 34756  8176]
 [ 4121 14080 14717]]
training model: results/WBA/W10/deepOF_L2/h100
Epoch 1/50
1230/1230 - 30s - loss: 3.2522 - accuracy100: 0.3938 - val_loss: 3.2039 - val_accuracy100: 0.4114 - 30s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 27s - loss: 3.1909 - accuracy100: 0.4216 - val_loss: 3.1854 - val_accuracy100: 0.4203 - 27s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 27s - loss: 3.1653 - accuracy100: 0.4335 - val_loss: 3.1663 - val_accuracy100: 0.4265 - 27s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 27s - loss: 3.1507 - accuracy100: 0.4381 - val_loss: 3.1509 - val_accuracy100: 0.4325 - 27s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 27s - loss: 3.1385 - accuracy100: 0.4420 - val_loss: 3.1423 - val_accuracy100: 0.4364 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 27s - loss: 3.1287 - accuracy100: 0.4456 - val_loss: 3.1344 - val_accuracy100: 0.4397 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 27s - loss: 3.1203 - accuracy100: 0.4486 - val_loss: 3.1267 - val_accuracy100: 0.4446 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 27s - loss: 3.1126 - accuracy100: 0.4508 - val_loss: 3.1241 - val_accuracy100: 0.4476 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 27s - loss: 3.1061 - accuracy100: 0.4547 - val_loss: 3.1230 - val_accuracy100: 0.4484 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 27s - loss: 3.1003 - accuracy100: 0.4558 - val_loss: 3.1167 - val_accuracy100: 0.4507 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 27s - loss: 3.0936 - accuracy100: 0.4583 - val_loss: 3.1185 - val_accuracy100: 0.4500 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 27s - loss: 3.0876 - accuracy100: 0.4608 - val_loss: 3.1187 - val_accuracy100: 0.4515 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 27s - loss: 3.0817 - accuracy100: 0.4623 - val_loss: 3.1248 - val_accuracy100: 0.4495 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 27s - loss: 3.0775 - accuracy100: 0.4642 - val_loss: 3.1258 - val_accuracy100: 0.4519 - 27s/epoch - 22ms/step
Epoch 15/50
1230/1230 - 27s - loss: 3.0721 - accuracy100: 0.4674 - val_loss: 3.1339 - val_accuracy100: 0.4506 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 26s - loss: 3.0667 - accuracy100: 0.4689 - val_loss: 3.1485 - val_accuracy100: 0.4409 - 26s/epoch - 21ms/step
Epoch 17/50
1230/1230 - 27s - loss: 3.0611 - accuracy100: 0.4715 - val_loss: 3.1534 - val_accuracy100: 0.4433 - 27s/epoch - 22ms/step
Epoch 18/50
1230/1230 - 27s - loss: 3.0551 - accuracy100: 0.4745 - val_loss: 3.1666 - val_accuracy100: 0.4389 - 27s/epoch - 22ms/step
Epoch 19/50
1230/1230 - 27s - loss: 3.0483 - accuracy100: 0.4765 - val_loss: 3.1780 - val_accuracy100: 0.4365 - 27s/epoch - 22ms/step
Epoch 20/50
1230/1230 - 27s - loss: 3.0432 - accuracy100: 0.4790 - val_loss: 3.1603 - val_accuracy100: 0.4408 - 27s/epoch - 22ms/step
testing model: results/WBA/W10/deepOF_L2/h100
Evaluating performance on  test set...
6546/6546 - 49s - 49s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0629162
{'0': {'precision': 0.4500550621382579, 'recall': 0.3514230705442064, 'f1-score': 0.3946701111388928, 'support': 554716}, '1': {'precision': 0.413788354541949, 'recall': 0.5740044113305198, 'f1-score': 0.4809031794325591, 'support': 575790}, '2': {'precision': 0.43199927909255775, 'recall': 0.3516830564613449, 'f1-score': 0.38772553614593647, 'support': 545258}, 'accuracy': 0.427986279690935, 'macro avg': {'precision': 0.4319475652575882, 'recall': 0.4257035127786904, 'f1-score': 0.4210996089057961, 'support': 1675764}, 'weighted avg': {'precision': 0.43171890757305, 'recall': 0.427986279690935, 'f1-score': 0.42204004707336845, 'support': 1675764}}
[[194940 236587 123189]
 [116346 330506 128938]
 [121861 231639 191758]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0550774
{'0': {'precision': 0.4719839870623948, 'recall': 0.3301743323442137, 'f1-score': 0.38854424129332876, 'support': 107840}, '1': {'precision': 0.3930018501121018, 'recall': 0.6718526765920131, 'f1-score': 0.49591627453689896, 'support': 101491}, '2': {'precision': 0.4835627259745389, 'recall': 0.30189591888995326, 'f1-score': 0.3717206868967611, 'support': 105437}, 'accuracy': 0.4308697199207035, 'macro avg': {'precision': 0.44951618771634516, 'recall': 0.43464097594206, 'f1-score': 0.4187270675756629, 'support': 314768}, 'weighted avg': {'precision': 0.45039618726526665, 'recall': 0.4308697199207035, 'f1-score': 0.4175289853620151, 'support': 314768}}
[[35606 54355 17879]
 [17188 68187 16116]
 [22645 50961 31831]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0398822
{'0': {'precision': 0.46825181159420287, 'recall': 0.2860898198621987, 'f1-score': 0.35517614524467955, 'support': 36139}, '1': {'precision': 0.43476540418315435, 'recall': 0.7308925898648168, 'f1-score': 0.5452144863581183, 'support': 42091}, '2': {'precision': 0.48096348096348096, 'recall': 0.2813476507016647, 'f1-score': 0.35502025307380725, 'support': 35202}, 'accuracy': 0.44967028704422035, 'macro avg': {'precision': 0.4613268989136127, 'recall': 0.4327766868095601, 'f1-score': 0.4184702948922017, 'support': 113432}, 'weighted avg': {'precision': 0.45977095796206097, 'recall': 0.44967028704422035, 'f1-score': 0.4256449379981063, 'support': 113432}}
[[10339 20857  4943]
 [ 5582 30764  5745]
 [ 6159 19139  9904]]
training model: results/WBA/W10/deepOF_L2/h200
Epoch 1/50
1230/1230 - 30s - loss: 3.2920 - accuracy200: 0.3663 - val_loss: 3.2638 - val_accuracy200: 0.3778 - 30s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 27s - loss: 3.2597 - accuracy200: 0.3836 - val_loss: 3.2514 - val_accuracy200: 0.3826 - 27s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 27s - loss: 3.2462 - accuracy200: 0.3924 - val_loss: 3.2443 - val_accuracy200: 0.3858 - 27s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 27s - loss: 3.2375 - accuracy200: 0.3968 - val_loss: 3.2403 - val_accuracy200: 0.3864 - 27s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 27s - loss: 3.2318 - accuracy200: 0.3997 - val_loss: 3.2385 - val_accuracy200: 0.3883 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 27s - loss: 3.2267 - accuracy200: 0.4027 - val_loss: 3.2383 - val_accuracy200: 0.3882 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 27s - loss: 3.2223 - accuracy200: 0.4044 - val_loss: 3.2360 - val_accuracy200: 0.3904 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 27s - loss: 3.2185 - accuracy200: 0.4061 - val_loss: 3.2345 - val_accuracy200: 0.3925 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 27s - loss: 3.2157 - accuracy200: 0.4078 - val_loss: 3.2336 - val_accuracy200: 0.3927 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 27s - loss: 3.2114 - accuracy200: 0.4102 - val_loss: 3.2326 - val_accuracy200: 0.3919 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 27s - loss: 3.2079 - accuracy200: 0.4119 - val_loss: 3.2315 - val_accuracy200: 0.3950 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 27s - loss: 3.2038 - accuracy200: 0.4140 - val_loss: 3.2292 - val_accuracy200: 0.3948 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 27s - loss: 3.1998 - accuracy200: 0.4165 - val_loss: 3.2310 - val_accuracy200: 0.3953 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 27s - loss: 3.1961 - accuracy200: 0.4176 - val_loss: 3.2311 - val_accuracy200: 0.3953 - 27s/epoch - 22ms/step
Epoch 15/50
1230/1230 - 27s - loss: 3.1911 - accuracy200: 0.4203 - val_loss: 3.2343 - val_accuracy200: 0.3943 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 27s - loss: 3.1869 - accuracy200: 0.4225 - val_loss: 3.2337 - val_accuracy200: 0.3955 - 27s/epoch - 22ms/step
Epoch 17/50
1230/1230 - 27s - loss: 3.1827 - accuracy200: 0.4244 - val_loss: 3.2404 - val_accuracy200: 0.3936 - 27s/epoch - 22ms/step
Epoch 18/50
1230/1230 - 27s - loss: 3.1781 - accuracy200: 0.4275 - val_loss: 3.2412 - val_accuracy200: 0.3939 - 27s/epoch - 22ms/step
Epoch 19/50
1230/1230 - 27s - loss: 3.1734 - accuracy200: 0.4295 - val_loss: 3.2546 - val_accuracy200: 0.3895 - 27s/epoch - 22ms/step
Epoch 20/50
1230/1230 - 27s - loss: 3.1663 - accuracy200: 0.4325 - val_loss: 3.2579 - val_accuracy200: 0.3897 - 27s/epoch - 22ms/step
Epoch 21/50
1230/1230 - 27s - loss: 3.1614 - accuracy200: 0.4347 - val_loss: 3.2646 - val_accuracy200: 0.3883 - 27s/epoch - 22ms/step
Epoch 22/50
1230/1230 - 27s - loss: 3.1588 - accuracy200: 0.4366 - val_loss: 3.2722 - val_accuracy200: 0.3859 - 27s/epoch - 22ms/step
testing model: results/WBA/W10/deepOF_L2/h200
Evaluating performance on  test set...
6546/6546 - 48s - 48s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0855213
{'0': {'precision': 0.406148124265192, 'recall': 0.22951196799210846, 'f1-score': 0.29328836726366647, 'support': 543366}, '1': {'precision': 0.3757942804711647, 'recall': 0.5271055813266949, 'f1-score': 0.4387712769665857, 'support': 602957}, '2': {'precision': 0.38196134820460553, 'recall': 0.3772979425469505, 'f1-score': 0.37961532394922926, 'support': 529441}, 'accuracy': 0.3832807006237155, 'macro avg': {'precision': 0.3879679176469874, 'recall': 0.37797183062191797, 'f1-score': 0.37055832272649375, 'support': 1675764}, 'weighted avg': {'precision': 0.3875849295093623, 'recall': 0.3832807006237155, 'f1-score': 0.37290874880922065, 'support': 1675764}}
[[124709 272338 146319]
 [108234 317822 176901]
 [ 74110 255574 199757]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0820547
{'0': {'precision': 0.42103994621405283, 'recall': 0.3134153596283321, 'f1-score': 0.3593421821882511, 'support': 105901}, '1': {'precision': 0.36361003192433866, 'recall': 0.5404246956098565, 'f1-score': 0.4347263104800765, 'support': 106853}, '2': {'precision': 0.40817384990405065, 'recall': 0.30858509616327173, 'f1-score': 0.35146088490437544, 'support': 102014}, 'accuracy': 0.38891183347735475, 'macro avg': {'precision': 0.39760794268081406, 'recall': 0.3874750504671534, 'f1-score': 0.3818431258575677, 'support': 314768}, 'weighted avg': {'precision': 0.3973746416704925, 'recall': 0.38891183347735475, 'f1-score': 0.38237825192611874, 'support': 314768}}
[[33191 51722 20988]
 [24451 57746 24656]
 [21189 49345 31480]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0767376
{'0': {'precision': 0.4034415389239555, 'recall': 0.2981204364363253, 'f1-score': 0.3428753891594156, 'support': 36019}, '1': {'precision': 0.3971082073321386, 'recall': 0.5333972141721978, 'f1-score': 0.4552717407566252, 'support': 42788}, '2': {'precision': 0.3848618069045428, 'recall': 0.3261516245487365, 'f1-score': 0.3530827913956979, 'support': 34625}, 'accuracy': 0.3954263347203611, 'macro avg': {'precision': 0.39513718438687895, 'recall': 0.3858897583857532, 'f1-score': 0.3837433071039129, 'support': 113432}, 'weighted avg': {'precision': 0.3953810814399754, 'recall': 0.3954263347203611, 'f1-score': 0.3883885282610155, 'support': 113432}}
[[10738 17899  7382]
 [ 9297 22823 10668]
 [ 6581 16751 11293]]
training model: results/WBA/W10/deepOF_L2/h300
Epoch 1/50
1230/1230 - 30s - loss: 3.3018 - accuracy300: 0.3594 - val_loss: 3.2887 - val_accuracy300: 0.3585 - 30s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 27s - loss: 3.2775 - accuracy300: 0.3734 - val_loss: 3.2787 - val_accuracy300: 0.3629 - 27s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 27s - loss: 3.2677 - accuracy300: 0.3799 - val_loss: 3.2750 - val_accuracy300: 0.3660 - 27s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 27s - loss: 3.2625 - accuracy300: 0.3828 - val_loss: 3.2731 - val_accuracy300: 0.3664 - 27s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 27s - loss: 3.2582 - accuracy300: 0.3861 - val_loss: 3.2718 - val_accuracy300: 0.3664 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 27s - loss: 3.2540 - accuracy300: 0.3892 - val_loss: 3.2724 - val_accuracy300: 0.3703 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 27s - loss: 3.2508 - accuracy300: 0.3909 - val_loss: 3.2717 - val_accuracy300: 0.3660 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 27s - loss: 3.2477 - accuracy300: 0.3921 - val_loss: 3.2722 - val_accuracy300: 0.3680 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 27s - loss: 3.2456 - accuracy300: 0.3936 - val_loss: 3.2715 - val_accuracy300: 0.3692 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 26s - loss: 3.2433 - accuracy300: 0.3953 - val_loss: 3.2717 - val_accuracy300: 0.3694 - 26s/epoch - 21ms/step
Epoch 11/50
1230/1230 - 27s - loss: 3.2408 - accuracy300: 0.3973 - val_loss: 3.2710 - val_accuracy300: 0.3703 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 27s - loss: 3.2381 - accuracy300: 0.3996 - val_loss: 3.2720 - val_accuracy300: 0.3721 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 27s - loss: 3.2351 - accuracy300: 0.4013 - val_loss: 3.2714 - val_accuracy300: 0.3749 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 27s - loss: 3.2333 - accuracy300: 0.4024 - val_loss: 3.2715 - val_accuracy300: 0.3747 - 27s/epoch - 22ms/step
Epoch 15/50
1230/1230 - 27s - loss: 3.2301 - accuracy300: 0.4047 - val_loss: 3.2709 - val_accuracy300: 0.3759 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 27s - loss: 3.2271 - accuracy300: 0.4069 - val_loss: 3.2741 - val_accuracy300: 0.3763 - 27s/epoch - 22ms/step
Epoch 17/50
1230/1230 - 27s - loss: 3.2232 - accuracy300: 0.4093 - val_loss: 3.2757 - val_accuracy300: 0.3758 - 27s/epoch - 22ms/step
Epoch 18/50
1230/1230 - 27s - loss: 3.2212 - accuracy300: 0.4114 - val_loss: 3.2798 - val_accuracy300: 0.3743 - 27s/epoch - 22ms/step
Epoch 19/50
1230/1230 - 27s - loss: 3.2179 - accuracy300: 0.4139 - val_loss: 3.2803 - val_accuracy300: 0.3749 - 27s/epoch - 22ms/step
Epoch 20/50
1230/1230 - 27s - loss: 3.2141 - accuracy300: 0.4170 - val_loss: 3.2835 - val_accuracy300: 0.3747 - 27s/epoch - 22ms/step
Epoch 21/50
1230/1230 - 27s - loss: 3.2097 - accuracy300: 0.4196 - val_loss: 3.2859 - val_accuracy300: 0.3758 - 27s/epoch - 22ms/step
Epoch 22/50
1230/1230 - 27s - loss: 3.2049 - accuracy300: 0.4213 - val_loss: 3.2912 - val_accuracy300: 0.3742 - 27s/epoch - 22ms/step
Epoch 23/50
1230/1230 - 26s - loss: 3.2004 - accuracy300: 0.4247 - val_loss: 3.2987 - val_accuracy300: 0.3720 - 26s/epoch - 21ms/step
Epoch 24/50
1230/1230 - 27s - loss: 3.1954 - accuracy300: 0.4280 - val_loss: 3.3080 - val_accuracy300: 0.3712 - 27s/epoch - 22ms/step
Epoch 25/50
1230/1230 - 27s - loss: 3.1901 - accuracy300: 0.4301 - val_loss: 3.3179 - val_accuracy300: 0.3705 - 27s/epoch - 22ms/step
testing model: results/WBA/W10/deepOF_L2/h300
Evaluating performance on  test set...
6546/6546 - 49s - 49s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1006761
{'0': {'precision': 0.3952607349170346, 'recall': 0.256916401564902, 'f1-score': 0.31141528892770604, 'support': 571793}, '1': {'precision': 0.33674549674281784, 'recall': 0.4764718102728767, 'f1-score': 0.3946048246884961, 'support': 548746}, '2': {'precision': 0.37996645599006945, 'recall': 0.3611058579855014, 'f1-score': 0.37029615196372667, 'support': 555225}, 'accuracy': 0.36333278433001304, 'macro avg': {'precision': 0.37065756254997395, 'recall': 0.36483135660776006, 'f1-score': 0.35877208852664294, 'support': 1675764}, 'weighted avg': {'precision': 0.37103192411529107, 'recall': 0.36333278433001304, 'f1-score': 0.358165339752145, 'support': 1675764}}
[[146903 261066 163824]
 [123938 261462 163346]
 [100820 253910 200495]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0937244
{'0': {'precision': 0.42767669056000907, 'recall': 0.2749700032723703, 'f1-score': 0.3347294224395966, 'support': 110012}, '1': {'precision': 0.33392221767644836, 'recall': 0.5446099097186416, 'f1-score': 0.41400272830326434, 'support': 98913}, '2': {'precision': 0.40655262044369217, 'recall': 0.31771586217321884, 'f1-score': 0.35668600642773046, 'support': 105843}, 'accuracy': 0.37407550958166014, 'macro avg': {'precision': 0.3893838428933832, 'recall': 0.37909859172141025, 'f1-score': 0.3684727190568638, 'support': 314768}, 'weighted avg': {'precision': 0.3911120743040587, 'recall': 0.37407550958166014, 'f1-score': 0.367023401566919, 'support': 314768}}
[[30250 54665 25097]
 [21054 53869 23990]
 [19427 52788 33628]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.091527
{'0': {'precision': 0.40888259311724023, 'recall': 0.2587193209079166, 'f1-score': 0.31691289254863975, 'support': 37933}, '1': {'precision': 0.3604717420959025, 'recall': 0.5332992719376677, 'f1-score': 0.43017577118836164, 'support': 39145}, '2': {'precision': 0.38011232033505726, 'recall': 0.32953732739175884, 'f1-score': 0.3530226459017842, 'support': 36354}, 'accuracy': 0.37617250863953733, 'macro avg': {'precision': 0.38315555184940003, 'recall': 0.3738519734124477, 'f1-score': 0.3667037698795952, 'support': 113432}, 'weighted avg': {'precision': 0.3829555420209557, 'recall': 0.37617250863953733, 'f1-score': 0.3675724009567797, 'support': 113432}}
[[ 9814 18978  9141]
 [ 7873 20876 10396]
 [ 6315 18059 11980]]
training model: results/WBA/W10/deepOF_L2/h500
Epoch 1/50
1230/1230 - 29s - loss: 3.2864 - accuracy500: 0.3781 - val_loss: 3.2960 - val_accuracy500: 0.3603 - 29s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 27s - loss: 3.2723 - accuracy500: 0.3812 - val_loss: 3.2877 - val_accuracy500: 0.3671 - 27s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 26s - loss: 3.2675 - accuracy500: 0.3817 - val_loss: 3.2859 - val_accuracy500: 0.3693 - 26s/epoch - 21ms/step
Epoch 4/50
1230/1230 - 27s - loss: 3.2593 - accuracy500: 0.3847 - val_loss: 3.2850 - val_accuracy500: 0.3695 - 27s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 27s - loss: 3.2550 - accuracy500: 0.3864 - val_loss: 3.2840 - val_accuracy500: 0.3701 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 27s - loss: 3.2516 - accuracy500: 0.3881 - val_loss: 3.2844 - val_accuracy500: 0.3710 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 27s - loss: 3.2493 - accuracy500: 0.3899 - val_loss: 3.2830 - val_accuracy500: 0.3722 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 26s - loss: 3.2484 - accuracy500: 0.3917 - val_loss: 3.2820 - val_accuracy500: 0.3746 - 26s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 27s - loss: 3.2463 - accuracy500: 0.3926 - val_loss: 3.2830 - val_accuracy500: 0.3750 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 27s - loss: 3.2428 - accuracy500: 0.3948 - val_loss: 3.2799 - val_accuracy500: 0.3751 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 27s - loss: 3.2415 - accuracy500: 0.3957 - val_loss: 3.2822 - val_accuracy500: 0.3736 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 26s - loss: 3.2384 - accuracy500: 0.3976 - val_loss: 3.2822 - val_accuracy500: 0.3710 - 26s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 27s - loss: 3.2358 - accuracy500: 0.3992 - val_loss: 3.2850 - val_accuracy500: 0.3740 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 27s - loss: 3.2323 - accuracy500: 0.4015 - val_loss: 3.2832 - val_accuracy500: 0.3718 - 27s/epoch - 22ms/step
Epoch 15/50
1230/1230 - 27s - loss: 3.2296 - accuracy500: 0.4040 - val_loss: 3.2856 - val_accuracy500: 0.3712 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 27s - loss: 3.2260 - accuracy500: 0.4061 - val_loss: 3.2859 - val_accuracy500: 0.3732 - 27s/epoch - 22ms/step
Epoch 17/50
1230/1230 - 26s - loss: 3.2225 - accuracy500: 0.4080 - val_loss: 3.2870 - val_accuracy500: 0.3711 - 26s/epoch - 21ms/step
Epoch 18/50
1230/1230 - 27s - loss: 3.2203 - accuracy500: 0.4096 - val_loss: 3.2860 - val_accuracy500: 0.3725 - 27s/epoch - 22ms/step
Epoch 19/50
1230/1230 - 27s - loss: 3.2177 - accuracy500: 0.4105 - val_loss: 3.2857 - val_accuracy500: 0.3738 - 27s/epoch - 22ms/step
Epoch 20/50
1230/1230 - 27s - loss: 3.2152 - accuracy500: 0.4126 - val_loss: 3.2872 - val_accuracy500: 0.3727 - 27s/epoch - 22ms/step
testing model: results/WBA/W10/deepOF_L2/h500
Evaluating performance on  test set...
6546/6546 - 49s - 49s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0935335
{'0': {'precision': 0.39211565157036266, 'recall': 0.5818750060350127, 'f1-score': 0.4685102374285207, 'support': 621374}, '1': {'precision': 0.2800585703118979, 'recall': 0.1144214269167883, 'f1-score': 0.1624655316390414, 'support': 444637}, '2': {'precision': 0.39584666324022505, 'recall': 0.3713520064681929, 'f1-score': 0.3832083095343869, 'support': 609753}, 'accuracy': 0.3812416306830795, 'macro avg': {'precision': 0.35600696170749524, 'recall': 0.355882813139998, 'f1-score': 0.33806135953398303, 'support': 1675764}, 'weighted avg': {'precision': 0.3637406960988366, 'recall': 0.3812416306830795, 'f1-score': 0.3562677580057927, 'support': 1675764}}
[[361562  62421 197391]
 [245563  50876 148198]
 [314955  68365 226433]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0941703
{'0': {'precision': 0.3700888438787488, 'recall': 0.591333688836585, 'f1-score': 0.455254570807704, 'support': 108766}, '1': {'precision': 0.34379506319450337, 'recall': 0.16001579233084934, 'f1-score': 0.2183860821305171, 'support': 101315}, '2': {'precision': 0.3652157230559345, 'recall': 0.3273185782379856, 'f1-score': 0.34523023913032524, 'support': 104687}, 'accuracy': 0.36469717379149086, 'macro avg': {'precision': 0.35969987670972886, 'recall': 0.3595560198018067, 'f1-score': 0.33962363068951545, 'support': 314768}, 'weighted avg': {'precision': 0.3600048874740245, 'recall': 0.36469717379149086, 'f1-score': 0.3424208388507104, 'support': 314768}}
[[64317 15209 29240]
 [54785 16212 30318]
 [54686 15735 34266]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0936648
{'0': {'precision': 0.3802488973421437, 'recall': 0.5772351652727997, 'f1-score': 0.4584787228784659, 'support': 40176}, '1': {'precision': 0.3273495248152059, 'recall': 0.15242227042660883, 'f1-score': 0.2079962110747129, 'support': 34575}, '2': {'precision': 0.38240149680827645, 'recall': 0.35929784648793983, 'f1-score': 0.370489836721093, 'support': 38681}, 'accuracy': 0.37343077791099516, 'macro avg': {'precision': 0.3633333063218753, 'recall': 0.3629850940624495, 'f1-score': 0.3456549235580906, 'support': 113432}, 'weighted avg': {'precision': 0.3648587860404881, 'recall': 0.37343077791099516, 'f1-score': 0.3521248637287718, 'support': 113432}}
[[23191  5346 11639]
 [18498  5270 10807]
 [19300  5483 13898]]
training model: results/WBA/W10/deepOF_L2/h1000
Epoch 1/50
1230/1230 - 30s - loss: 3.3064 - accuracy1000: 0.3654 - val_loss: 3.3115 - val_accuracy1000: 0.3763 - 30s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 27s - loss: 3.2756 - accuracy1000: 0.3771 - val_loss: 3.3150 - val_accuracy1000: 0.3778 - 27s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 27s - loss: 3.2612 - accuracy1000: 0.3835 - val_loss: 3.3171 - val_accuracy1000: 0.3764 - 27s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 27s - loss: 3.2540 - accuracy1000: 0.3871 - val_loss: 3.3211 - val_accuracy1000: 0.3760 - 27s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 27s - loss: 3.2493 - accuracy1000: 0.3892 - val_loss: 3.3243 - val_accuracy1000: 0.3763 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 27s - loss: 3.2466 - accuracy1000: 0.3905 - val_loss: 3.3243 - val_accuracy1000: 0.3757 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 27s - loss: 3.2438 - accuracy1000: 0.3916 - val_loss: 3.3239 - val_accuracy1000: 0.3757 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 27s - loss: 3.2420 - accuracy1000: 0.3926 - val_loss: 3.3234 - val_accuracy1000: 0.3763 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 27s - loss: 3.2393 - accuracy1000: 0.3952 - val_loss: 3.3253 - val_accuracy1000: 0.3759 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 27s - loss: 3.2382 - accuracy1000: 0.3952 - val_loss: 3.3242 - val_accuracy1000: 0.3762 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 26s - loss: 3.2358 - accuracy1000: 0.3973 - val_loss: 3.3234 - val_accuracy1000: 0.3757 - 26s/epoch - 22ms/step
testing model: results/WBA/W10/deepOF_L2/h1000
Evaluating performance on  test set...
6546/6546 - 48s - 48s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1093171
{'0': {'precision': 0.3585302123026674, 'recall': 0.06049522647821191, 'f1-score': 0.1035229099962748, 'support': 544357}, '1': {'precision': 0.3645768029155687, 'recall': 0.9299903948719566, 'f1-score': 0.523808923142904, 'support': 602803}, '2': {'precision': 0.3457978286258056, 'recall': 0.030247595553571295, 'f1-score': 0.05562919897989361, 'support': 528604}, 'accuracy': 0.363727231280777, 'macro avg': {'precision': 0.35630161461468063, 'recall': 0.3402444056345799, 'f1-score': 0.2276536773730241, 'support': 1675764}, 'weighted avg': {'precision': 0.3566889709465486, 'recall': 0.363727231280777, 'f1-score': 0.23959986496411295, 'support': 1675764}}
[[ 32931 495142  16284]
 [ 28237 560601  13965]
 [ 30682 481933  15989]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.11517
{'0': {'precision': 0.37512897767138553, 'recall': 0.08538441304674584, 'f1-score': 0.13910634618180706, 'support': 106448}, '1': {'precision': 0.3467105995183179, 'recall': 0.9071920960198351, 'f1-score': 0.501686640611813, 'support': 106478}, '2': {'precision': 0.37420382165605093, 'recall': 0.043842422576147365, 'f1-score': 0.07848893420289346, 'support': 101842}, 'accuracy': 0.349940273471255, 'macro avg': {'precision': 0.3653477996152515, 'recall': 0.3454729772142428, 'f1-score': 0.23976064033217118, 'support': 314768}, 'weighted avg': {'precision': 0.36521643316909796, 'recall': 0.349940273471255, 'f1-score': 0.24214549285351974, 'support': 314768}}
[[ 9089 93203  4156]
 [ 6571 96596  3311]
 [ 8569 88808  4465]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1028757
{'0': {'precision': 0.3398951989803144, 'recall': 0.0661320988674878, 'f1-score': 0.11072153533862336, 'support': 36291}, '1': {'precision': 0.3800390401180915, 'recall': 0.9237106101734923, 'f1-score': 0.5385176418781307, 'support': 42365}, '2': {'precision': 0.34911764705882353, 'recall': 0.03413273521969174, 'f1-score': 0.06218566638725901, 'support': 34776}, 'accuracy': 0.37661330136116794, 'macro avg': {'precision': 0.35635062871907647, 'recall': 0.34132514808689063, 'f1-score': 0.237141614534671, 'support': 113432}, 'weighted avg': {'precision': 0.3577156877681358, 'recall': 0.37661330136116794, 'f1-score': 0.2556162623547527, 'support': 113432}}
[[ 2400 32736  1155]
 [ 2174 39133  1058]
 [ 2487 31102  1187]]
training model: results/WBA/W10/deepVOL_L2/h10
Epoch 1/50
1230/1230 - 29s - loss: 3.0490 - accuracy10: 0.4586 - val_loss: 2.6002 - val_accuracy10: 0.5691 - 29s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 27s - loss: 2.8047 - accuracy10: 0.5159 - val_loss: 2.5330 - val_accuracy10: 0.5774 - 27s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 27s - loss: 2.7217 - accuracy10: 0.5420 - val_loss: 2.6112 - val_accuracy10: 0.5921 - 27s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 26s - loss: 2.6907 - accuracy10: 0.5521 - val_loss: 2.5791 - val_accuracy10: 0.6083 - 26s/epoch - 21ms/step
Epoch 5/50
1230/1230 - 27s - loss: 2.6675 - accuracy10: 0.5567 - val_loss: 2.5377 - val_accuracy10: 0.6084 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 27s - loss: 2.6539 - accuracy10: 0.5591 - val_loss: 2.5496 - val_accuracy10: 0.6098 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 26s - loss: 2.6418 - accuracy10: 0.5625 - val_loss: 2.5058 - val_accuracy10: 0.6133 - 26s/epoch - 21ms/step
Epoch 8/50
1230/1230 - 27s - loss: 2.6308 - accuracy10: 0.5655 - val_loss: 2.5149 - val_accuracy10: 0.6155 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 27s - loss: 2.6232 - accuracy10: 0.5665 - val_loss: 2.4684 - val_accuracy10: 0.6214 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 26s - loss: 2.6170 - accuracy10: 0.5674 - val_loss: 2.5003 - val_accuracy10: 0.6191 - 26s/epoch - 21ms/step
Epoch 11/50
1230/1230 - 26s - loss: 2.6090 - accuracy10: 0.5699 - val_loss: 2.4943 - val_accuracy10: 0.6259 - 26s/epoch - 21ms/step
Epoch 12/50
1230/1230 - 25s - loss: 2.6013 - accuracy10: 0.5723 - val_loss: 2.4942 - val_accuracy10: 0.6217 - 25s/epoch - 21ms/step
Epoch 13/50
1230/1230 - 27s - loss: 2.5946 - accuracy10: 0.5734 - val_loss: 2.4959 - val_accuracy10: 0.6240 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 27s - loss: 2.5908 - accuracy10: 0.5742 - val_loss: 2.5047 - val_accuracy10: 0.6165 - 27s/epoch - 22ms/step
Epoch 15/50
1230/1230 - 25s - loss: 2.5837 - accuracy10: 0.5761 - val_loss: 2.5296 - val_accuracy10: 0.6181 - 25s/epoch - 21ms/step
Epoch 16/50
1230/1230 - 25s - loss: 2.5771 - accuracy10: 0.5775 - val_loss: 2.4935 - val_accuracy10: 0.6166 - 25s/epoch - 21ms/step
Epoch 17/50
1230/1230 - 26s - loss: 2.5729 - accuracy10: 0.5782 - val_loss: 2.5161 - val_accuracy10: 0.6136 - 26s/epoch - 21ms/step
Epoch 18/50
1230/1230 - 26s - loss: 2.5675 - accuracy10: 0.5792 - val_loss: 2.5034 - val_accuracy10: 0.6188 - 26s/epoch - 21ms/step
Epoch 19/50
1230/1230 - 26s - loss: 2.5618 - accuracy10: 0.5798 - val_loss: 2.5488 - val_accuracy10: 0.6118 - 26s/epoch - 21ms/step
testing model: results/WBA/W10/deepVOL_L2/h10
Evaluating performance on  test set...
6546/6546 - 63s - 63s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8977041
{'0': {'precision': 0.40497280497280497, 'recall': 0.4218507690763637, 'f1-score': 0.41323952193610486, 'support': 308877}, '1': {'precision': 0.7865266384096617, 'recall': 0.6094148733664289, 'f1-score': 0.6867351213531792, 'support': 1061172}, '2': {'precision': 0.35753585907590013, 'recall': 0.6219383749836451, 'f1-score': 0.4540502719922056, 'support': 305720}, 'accuracy': 0.5771278738298655, 'macro avg': {'precision': 0.5163451008194556, 'recall': 0.5510680058088125, 'f1-score': 0.5180083050938299, 'support': 1675769}, 'weighted avg': {'precision': 0.6379355948539011, 'recall': 0.5771278738298655, 'f1-score': 0.5938745227815476, 'support': 1675769}}
[[130300  99437  79140]
 [151953 646694 262525]
 [ 39497  76084 190139]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9111319
{'0': {'precision': 0.4377640274150292, 'recall': 0.4004297075423294, 'f1-score': 0.41826540609795926, 'support': 62368}, '1': {'precision': 0.7919554114480684, 'recall': 0.5874862443012105, 'f1-score': 0.6745670009115771, 'support': 190830}, '2': {'precision': 0.3556043388429752, 'recall': 0.6708731241473397, 'f1-score': 0.46482344203632436, 'support': 61572}, 'accuracy': 0.5667344410204276, 'macro avg': {'precision': 0.5284412592353577, 'recall': 0.5529296919969598, 'f1-score': 0.5192186163486202, 'support': 314770}, 'weighted avg': {'precision': 0.6364221125891765, 'recall': 0.5667344410204276, 'f1-score': 0.5827560015393283, 'support': 314770}}
[[ 24974  16517  20877]
 [ 24744 112110  53976]
 [  7331  12934  41307]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8146178
{'0': {'precision': 0.4200431668792308, 'recall': 0.4393760582892914, 'f1-score': 0.42949216300940435, 'support': 19489}, '1': {'precision': 0.8262736451201114, 'recall': 0.663736849114396, 'f1-score': 0.7361401383955276, 'support': 75090}, '2': {'precision': 0.36823612087139845, 'recall': 0.6391938477857332, 'f1-score': 0.4672766749379653, 'support': 18855}, 'accuracy': 0.6211100728176737, 'macro avg': {'precision': 0.5381843109569135, 'recall': 0.5807689183964735, 'f1-score': 0.5443029921142991, 'support': 113434}, 'weighted avg': {'precision': 0.6803445294215906, 'recall': 0.6211100728176737, 'f1-score': 0.6387647218908421, 'support': 113434}}
[[ 8563  5955  4971]
 [ 9544 49840 15706]
 [ 2279  4524 12052]]
training model: results/WBA/W10/deepVOL_L2/h20
Epoch 1/50
1230/1230 - 31s - loss: 3.0704 - accuracy20: 0.4580 - val_loss: 2.7006 - val_accuracy20: 0.5446 - 31s/epoch - 25ms/step
Epoch 2/50
1230/1230 - 29s - loss: 2.8558 - accuracy20: 0.5260 - val_loss: 2.6534 - val_accuracy20: 0.5699 - 29s/epoch - 24ms/step
Epoch 3/50
1230/1230 - 26s - loss: 2.7945 - accuracy20: 0.5435 - val_loss: 2.6497 - val_accuracy20: 0.5896 - 26s/epoch - 21ms/step
Epoch 4/50
1230/1230 - 27s - loss: 2.7703 - accuracy20: 0.5494 - val_loss: 2.6420 - val_accuracy20: 0.5925 - 27s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 27s - loss: 2.7495 - accuracy20: 0.5543 - val_loss: 2.6324 - val_accuracy20: 0.5932 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 27s - loss: 2.7369 - accuracy20: 0.5567 - val_loss: 2.6185 - val_accuracy20: 0.5955 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 25s - loss: 2.7244 - accuracy20: 0.5605 - val_loss: 2.6133 - val_accuracy20: 0.5986 - 25s/epoch - 21ms/step
Epoch 8/50
1230/1230 - 28s - loss: 2.7142 - accuracy20: 0.5628 - val_loss: 2.6183 - val_accuracy20: 0.5984 - 28s/epoch - 23ms/step
Epoch 9/50
1230/1230 - 27s - loss: 2.7061 - accuracy20: 0.5643 - val_loss: 2.6070 - val_accuracy20: 0.6004 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 26s - loss: 2.6963 - accuracy20: 0.5665 - val_loss: 2.6151 - val_accuracy20: 0.6055 - 26s/epoch - 21ms/step
Epoch 11/50
1230/1230 - 26s - loss: 2.6908 - accuracy20: 0.5676 - val_loss: 2.6130 - val_accuracy20: 0.6066 - 26s/epoch - 21ms/step
Epoch 12/50
1230/1230 - 27s - loss: 2.6842 - accuracy20: 0.5695 - val_loss: 2.6069 - val_accuracy20: 0.6070 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 28s - loss: 2.6787 - accuracy20: 0.5702 - val_loss: 2.5948 - val_accuracy20: 0.6099 - 28s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 29s - loss: 2.6744 - accuracy20: 0.5705 - val_loss: 2.6087 - val_accuracy20: 0.6122 - 29s/epoch - 23ms/step
Epoch 15/50
1230/1230 - 25s - loss: 2.6667 - accuracy20: 0.5724 - val_loss: 2.6219 - val_accuracy20: 0.6128 - 25s/epoch - 21ms/step
Epoch 16/50
1230/1230 - 27s - loss: 2.6622 - accuracy20: 0.5735 - val_loss: 2.6220 - val_accuracy20: 0.6155 - 27s/epoch - 22ms/step
Epoch 17/50
1230/1230 - 27s - loss: 2.6572 - accuracy20: 0.5745 - val_loss: 2.6087 - val_accuracy20: 0.6143 - 27s/epoch - 22ms/step
Epoch 18/50
1230/1230 - 25s - loss: 2.6526 - accuracy20: 0.5750 - val_loss: 2.6089 - val_accuracy20: 0.6115 - 25s/epoch - 21ms/step
Epoch 19/50
1230/1230 - 26s - loss: 2.6497 - accuracy20: 0.5764 - val_loss: 2.6150 - val_accuracy20: 0.6136 - 26s/epoch - 21ms/step
Epoch 20/50
1230/1230 - 28s - loss: 2.6444 - accuracy20: 0.5776 - val_loss: 2.6124 - val_accuracy20: 0.6111 - 28s/epoch - 22ms/step
Epoch 21/50
1230/1230 - 25s - loss: 2.6409 - accuracy20: 0.5769 - val_loss: 2.6083 - val_accuracy20: 0.6117 - 25s/epoch - 21ms/step
Epoch 22/50
1230/1230 - 27s - loss: 2.6368 - accuracy20: 0.5782 - val_loss: 2.5988 - val_accuracy20: 0.6113 - 27s/epoch - 22ms/step
Epoch 23/50
1230/1230 - 26s - loss: 2.6334 - accuracy20: 0.5785 - val_loss: 2.6079 - val_accuracy20: 0.6126 - 26s/epoch - 21ms/step
testing model: results/WBA/W10/deepVOL_L2/h20
Evaluating performance on  test set...
6546/6546 - 60s - 60s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9356059
{'0': {'precision': 0.4741890318989221, 'recall': 0.35460155512834096, 'f1-score': 0.4057675624412685, 'support': 396366}, '1': {'precision': 0.6715214431055118, 'recall': 0.6797191438964555, 'f1-score': 0.6755954266123984, 'support': 886575}, '2': {'precision': 0.4256213093869692, 'recall': 0.5222005559685154, 'f1-score': 0.4689904137431212, 'support': 392828}, 'accuracy': 0.5658948220190253, 'macro avg': {'precision': 0.523777261463801, 'recall': 0.518840418331104, 'f1-score': 0.5167844675989294, 'support': 1675769}, 'weighted avg': {'precision': 0.5672037738869627, 'recall': 0.5658948220190253, 'f1-score': 0.5633419923947547, 'support': 1675769}}
[[140552 163058  92756]
 [ 99878 602622 184075]
 [ 55975 131718 205135]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9234669
{'0': {'precision': 0.5036946238044266, 'recall': 0.3683200565578013, 'f1-score': 0.42549933276454244, 'support': 79211}, '1': {'precision': 0.6687606209306322, 'recall': 0.6679741138178305, 'f1-score': 0.6683671359919598, 'support': 157304}, '2': {'precision': 0.432281482818438, 'recall': 0.5509040955849467, 'f1-score': 0.4844368033081625, 'support': 78255}, 'accuracy': 0.5634622105029069, 'macro avg': {'precision': 0.5349122425178322, 'recall': 0.5290660886535261, 'f1-score': 0.5261010906882216, 'support': 314770}, 'weighted avg': {'precision': 0.5684311179559726, 'recall': 0.5634622105029069, 'f1-score': 0.5615231872496479, 'support': 314770}}
[[ 29175  28214  21822]
 [ 17433 105075  34796]
 [ 11314  23830  43111]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85084504
{'0': {'precision': 0.5046158743633277, 'recall': 0.38181453231633883, 'f1-score': 0.4347090817679053, 'support': 24910}, '1': {'precision': 0.7219580721850011, 'recall': 0.7277664524361588, 'f1-score': 0.7248506265547625, 'support': 64261}, '2': {'precision': 0.436694847020934, 'recall': 0.5364958991056341, 'f1-score': 0.48147805662924675, 'support': 24263}, 'accuracy': 0.6108838619814165, 'macro avg': {'precision': 0.5544229311897543, 'recall': 0.5486922946193772, 'f1-score': 0.5470125883173048, 'support': 113434}, 'weighted avg': {'precision': 0.613213464925329, 'recall': 0.6108838619814165, 'f1-score': 0.6090795654554149, 'support': 113434}}
[[ 9511  9928  5471]
 [ 6174 46767 11320]
 [ 3163  8083 13017]]
training model: results/WBA/W10/deepVOL_L2/h30
Epoch 1/50
1230/1230 - 28s - loss: 3.1185 - accuracy30: 0.4545 - val_loss: 2.8229 - val_accuracy30: 0.5287 - 28s/epoch - 23ms/step
Epoch 2/50
1230/1230 - 26s - loss: 2.9306 - accuracy30: 0.5081 - val_loss: 2.8143 - val_accuracy30: 0.5483 - 26s/epoch - 21ms/step
Epoch 3/50
1230/1230 - 25s - loss: 2.8636 - accuracy30: 0.5278 - val_loss: 2.7967 - val_accuracy30: 0.5622 - 25s/epoch - 21ms/step
Epoch 4/50
1230/1230 - 26s - loss: 2.8363 - accuracy30: 0.5348 - val_loss: 2.7752 - val_accuracy30: 0.5678 - 26s/epoch - 21ms/step
Epoch 5/50
1230/1230 - 28s - loss: 2.8192 - accuracy30: 0.5393 - val_loss: 2.7748 - val_accuracy30: 0.5698 - 28s/epoch - 23ms/step
Epoch 6/50
1230/1230 - 27s - loss: 2.8103 - accuracy30: 0.5418 - val_loss: 2.7569 - val_accuracy30: 0.5746 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 26s - loss: 2.8013 - accuracy30: 0.5449 - val_loss: 2.7597 - val_accuracy30: 0.5762 - 26s/epoch - 21ms/step
Epoch 8/50
1230/1230 - 26s - loss: 2.7923 - accuracy30: 0.5465 - val_loss: 2.7606 - val_accuracy30: 0.5753 - 26s/epoch - 21ms/step
Epoch 9/50
1230/1230 - 27s - loss: 2.7864 - accuracy30: 0.5482 - val_loss: 2.7527 - val_accuracy30: 0.5786 - 27s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 25s - loss: 2.7759 - accuracy30: 0.5496 - val_loss: 2.7556 - val_accuracy30: 0.5793 - 25s/epoch - 21ms/step
Epoch 11/50
1230/1230 - 27s - loss: 2.7709 - accuracy30: 0.5511 - val_loss: 2.7584 - val_accuracy30: 0.5789 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 28s - loss: 2.7642 - accuracy30: 0.5525 - val_loss: 2.7528 - val_accuracy30: 0.5803 - 28s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 26s - loss: 2.7587 - accuracy30: 0.5537 - val_loss: 2.7487 - val_accuracy30: 0.5795 - 26s/epoch - 21ms/step
Epoch 14/50
1230/1230 - 26s - loss: 2.7538 - accuracy30: 0.5550 - val_loss: 2.7508 - val_accuracy30: 0.5784 - 26s/epoch - 21ms/step
Epoch 15/50
1230/1230 - 27s - loss: 2.7454 - accuracy30: 0.5557 - val_loss: 2.7514 - val_accuracy30: 0.5798 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 27s - loss: 2.7414 - accuracy30: 0.5575 - val_loss: 2.7562 - val_accuracy30: 0.5794 - 27s/epoch - 22ms/step
Epoch 17/50
1230/1230 - 28s - loss: 2.7357 - accuracy30: 0.5587 - val_loss: 2.7504 - val_accuracy30: 0.5785 - 28s/epoch - 22ms/step
Epoch 18/50
1230/1230 - 28s - loss: 2.7312 - accuracy30: 0.5594 - val_loss: 2.7522 - val_accuracy30: 0.5790 - 28s/epoch - 23ms/step
Epoch 19/50
1230/1230 - 28s - loss: 2.7255 - accuracy30: 0.5605 - val_loss: 2.7568 - val_accuracy30: 0.5816 - 28s/epoch - 22ms/step
Epoch 20/50
1230/1230 - 27s - loss: 2.7216 - accuracy30: 0.5614 - val_loss: 2.7542 - val_accuracy30: 0.5806 - 27s/epoch - 22ms/step
Epoch 21/50
1230/1230 - 25s - loss: 2.7175 - accuracy30: 0.5616 - val_loss: 2.7695 - val_accuracy30: 0.5797 - 25s/epoch - 21ms/step
Epoch 22/50
1230/1230 - 27s - loss: 2.7123 - accuracy30: 0.5625 - val_loss: 2.7615 - val_accuracy30: 0.5811 - 27s/epoch - 22ms/step
Epoch 23/50
1230/1230 - 25s - loss: 2.7102 - accuracy30: 0.5630 - val_loss: 2.7609 - val_accuracy30: 0.5815 - 25s/epoch - 20ms/step
testing model: results/WBA/W10/deepVOL_L2/h30
Evaluating performance on  test set...
6546/6546 - 61s - 61s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9840445
{'0': {'precision': 0.5023092673373097, 'recall': 0.309815135721612, 'f1-score': 0.38324919987176215, 'support': 455307}, '1': {'precision': 0.5852830067870406, 'recall': 0.7116912069075144, 'f1-score': 0.6423269870511483, 'support': 770639}, '2': {'precision': 0.4578805060017822, 'recall': 0.4660655413351474, 'f1-score': 0.461936768952293, 'support': 449823}, 'accuracy': 0.536568584333521, 'macro avg': {'precision': 0.5151575933753775, 'recall': 0.4958572946547579, 'f1-score': 0.4958376519584012, 'support': 1675769}, 'weighted avg': {'precision': 0.5285406398508066, 'recall': 0.536568584333521, 'f1-score': 0.5235137143845898, 'support': 1675769}}
[[141061 209957 104289]
 [ 78254 548457 143928]
 [ 61510 178666 209647]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9624768
{'0': {'precision': 0.5355679968519148, 'recall': 0.33197330199348074, 'f1-score': 0.4098808358601242, 'support': 90194}, '1': {'precision': 0.5791935407379304, 'recall': 0.7212203529958884, 'f1-score': 0.6424511025555881, 'support': 135469}, '2': {'precision': 0.4737233157748822, 'recall': 0.47940116938063226, 'f1-score': 0.47654533081960265, 'support': 89107}, 'accuracy': 0.5412301045207611, 'macro avg': {'precision': 0.5294949511215757, 'recall': 0.5108649414566672, 'f1-score': 0.5096257564117717, 'support': 314770}, 'weighted avg': {'precision': 0.5368359537981406, 'recall': 0.5412301045207611, 'f1-score': 0.5288449512819308, 'support': 314770}}
[[29942 37647 22605]
 [12914 97703 24852]
 [13051 33338 42718]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90585124
{'0': {'precision': 0.5305094948831609, 'recall': 0.3391763759140688, 'f1-score': 0.4137960472958552, 'support': 28581}, '1': {'precision': 0.6404142906320627, 'recall': 0.7522768029818208, 'f1-score': 0.6918530855114762, 'support': 56878}, '2': {'precision': 0.46588824608437984, 'recall': 0.4721000893655049, 'f1-score': 0.46897359870745514, 'support': 27975}, 'accuracy': 0.5790944513990515, 'macro avg': {'precision': 0.5456040105332012, 'recall': 0.5211844227537982, 'f1-score': 0.5248742438382622, 'support': 113434}, 'weighted avg': {'precision': 0.5696810443080259, 'recall': 0.5790944513990515, 'f1-score': 0.5668270628676202, 'support': 113434}}
[[ 9694 12807  6080]
 [ 5029 42788  9061]
 [ 3550 11218 13207]]
training model: results/WBA/W10/deepVOL_L2/h50
Epoch 1/50
1230/1230 - 28s - loss: 3.1736 - accuracy50: 0.4314 - val_loss: 3.0252 - val_accuracy50: 0.4852 - 28s/epoch - 23ms/step
Epoch 2/50
1230/1230 - 26s - loss: 3.0097 - accuracy50: 0.4816 - val_loss: 2.9564 - val_accuracy50: 0.4989 - 26s/epoch - 21ms/step
Epoch 3/50
1230/1230 - 26s - loss: 2.9605 - accuracy50: 0.4956 - val_loss: 2.9324 - val_accuracy50: 0.5070 - 26s/epoch - 21ms/step
Epoch 4/50
1230/1230 - 29s - loss: 2.9394 - accuracy50: 0.5021 - val_loss: 2.9403 - val_accuracy50: 0.5082 - 29s/epoch - 24ms/step
Epoch 5/50
1230/1230 - 28s - loss: 2.9248 - accuracy50: 0.5060 - val_loss: 2.9117 - val_accuracy50: 0.5157 - 28s/epoch - 23ms/step
Epoch 6/50
1230/1230 - 27s - loss: 2.9148 - accuracy50: 0.5088 - val_loss: 2.9134 - val_accuracy50: 0.5176 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 25s - loss: 2.9062 - accuracy50: 0.5104 - val_loss: 2.8965 - val_accuracy50: 0.5195 - 25s/epoch - 21ms/step
Epoch 8/50
1230/1230 - 26s - loss: 2.8983 - accuracy50: 0.5140 - val_loss: 2.9060 - val_accuracy50: 0.5175 - 26s/epoch - 21ms/step
Epoch 9/50
1230/1230 - 26s - loss: 2.8941 - accuracy50: 0.5142 - val_loss: 2.9112 - val_accuracy50: 0.5192 - 26s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 26s - loss: 2.8879 - accuracy50: 0.5166 - val_loss: 2.9181 - val_accuracy50: 0.5180 - 26s/epoch - 21ms/step
Epoch 11/50
1230/1230 - 27s - loss: 2.8831 - accuracy50: 0.5184 - val_loss: 2.9187 - val_accuracy50: 0.5169 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 28s - loss: 2.8780 - accuracy50: 0.5194 - val_loss: 2.9188 - val_accuracy50: 0.5189 - 28s/epoch - 23ms/step
Epoch 13/50
1230/1230 - 26s - loss: 2.8743 - accuracy50: 0.5198 - val_loss: 2.9178 - val_accuracy50: 0.5193 - 26s/epoch - 21ms/step
Epoch 14/50
1230/1230 - 27s - loss: 2.8695 - accuracy50: 0.5212 - val_loss: 2.9197 - val_accuracy50: 0.5196 - 27s/epoch - 22ms/step
Epoch 15/50
1230/1230 - 25s - loss: 2.8648 - accuracy50: 0.5219 - val_loss: 2.9271 - val_accuracy50: 0.5180 - 25s/epoch - 20ms/step
Epoch 16/50
1230/1230 - 27s - loss: 2.8614 - accuracy50: 0.5231 - val_loss: 2.9366 - val_accuracy50: 0.5161 - 27s/epoch - 22ms/step
Epoch 17/50
1230/1230 - 28s - loss: 2.8561 - accuracy50: 0.5251 - val_loss: 2.9288 - val_accuracy50: 0.5173 - 28s/epoch - 23ms/step
testing model: results/WBA/W10/deepVOL_L2/h50
Evaluating performance on  test set...
6546/6546 - 62s - 62s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0075811
{'0': {'precision': 0.5105268474832472, 'recall': 0.25663074347834264, 'f1-score': 0.34156446075455693, 'support': 531690}, '1': {'precision': 0.49770960617773174, 'recall': 0.6891635378561938, 'f1-score': 0.5779949015488957, 'support': 621642}, '2': {'precision': 0.46387916696334514, 'recall': 0.48633806564236454, 'f1-score': 0.4748432021888152, 'support': 522437}, 'accuracy': 0.4886962343855269, 'macro avg': {'precision': 0.49070520687477465, 'recall': 0.47737744899230034, 'f1-score': 0.4648008548307559, 'support': 1675769}, 'weighted avg': {'precision': 0.4912293131647228, 'recall': 0.4886962343855269, 'f1-score': 0.4708214394401418, 'support': 1675769}}
[[136448 233342 161900]
 [ 61479 428413 131750]
 [ 69342 199014 254081]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99884874
{'0': {'precision': 0.5243699002719855, 'recall': 0.2761607364540958, 'f1-score': 0.3617859734280782, 'support': 104718}, '1': {'precision': 0.4803458553040972, 'recall': 0.6846099985996359, 'f1-score': 0.5645700207868196, 'support': 107115}, '2': {'precision': 0.4746388668131457, 'recall': 0.49316572272360765, 'f1-score': 0.4837249633144665, 'support': 102937}, 'accuracy': 0.4861200241446135, 'macro avg': {'precision': 0.49311820746307616, 'recall': 0.4846454859257798, 'f1-score': 0.4700269858431214, 'support': 314770}, 'weighted avg': {'precision': 0.4931255028774182, 'recall': 0.4861200241446135, 'f1-score': 0.4706694344782632, 'support': 314770}}
[[28919 42572 33227]
 [10820 73332 22963]
 [15411 36761 50765]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96621585
{'0': {'precision': 0.5271233472985473, 'recall': 0.2868223939367025, 'f1-score': 0.3715008819694762, 'support': 33777}, '1': {'precision': 0.5412994629396485, 'recall': 0.7267164466505488, 'f1-score': 0.6204515563349409, 'support': 46739}, '2': {'precision': 0.47084132978394105, 'recall': 0.46208761164104745, 'f1-score': 0.4664234024285539, 'support': 32918}, 'accuracy': 0.5189361214450694, 'macro avg': {'precision': 0.5130880466740456, 'recall': 0.49187548407609966, 'f1-score': 0.48612528024432367, 'support': 113434}, 'weighted avg': {'precision': 0.5166316606473106, 'recall': 0.5189361214450694, 'f1-score': 0.5016238177527456, 'support': 113434}}
[[ 9688 15392  8697]
 [ 4375 33966  8398]
 [ 4316 13391 15211]]
training model: results/WBA/W10/deepVOL_L2/h100
Epoch 1/50
1230/1230 - 29s - loss: 3.2686 - accuracy100: 0.3869 - val_loss: 3.2486 - val_accuracy100: 0.3823 - 29s/epoch - 24ms/step
Epoch 2/50
1230/1230 - 26s - loss: 3.1933 - accuracy100: 0.4177 - val_loss: 3.1969 - val_accuracy100: 0.4086 - 26s/epoch - 21ms/step
Epoch 3/50
1230/1230 - 26s - loss: 3.1713 - accuracy100: 0.4299 - val_loss: 3.1688 - val_accuracy100: 0.4254 - 26s/epoch - 21ms/step
Epoch 4/50
1230/1230 - 26s - loss: 3.1562 - accuracy100: 0.4354 - val_loss: 3.1554 - val_accuracy100: 0.4326 - 26s/epoch - 21ms/step
Epoch 5/50
1230/1230 - 27s - loss: 3.1428 - accuracy100: 0.4415 - val_loss: 3.1664 - val_accuracy100: 0.4297 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 27s - loss: 3.1331 - accuracy100: 0.4455 - val_loss: 3.1491 - val_accuracy100: 0.4384 - 27s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 26s - loss: 3.1256 - accuracy100: 0.4487 - val_loss: 3.1635 - val_accuracy100: 0.4346 - 26s/epoch - 21ms/step
Epoch 8/50
1230/1230 - 26s - loss: 3.1201 - accuracy100: 0.4507 - val_loss: 3.1654 - val_accuracy100: 0.4355 - 26s/epoch - 21ms/step
Epoch 9/50
1230/1230 - 26s - loss: 3.1142 - accuracy100: 0.4525 - val_loss: 3.1442 - val_accuracy100: 0.4392 - 26s/epoch - 21ms/step
Epoch 10/50
1230/1230 - 27s - loss: 3.1092 - accuracy100: 0.4545 - val_loss: 3.1487 - val_accuracy100: 0.4402 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 27s - loss: 3.1048 - accuracy100: 0.4565 - val_loss: 3.1515 - val_accuracy100: 0.4381 - 27s/epoch - 22ms/step
Epoch 12/50
1230/1230 - 27s - loss: 3.1012 - accuracy100: 0.4572 - val_loss: 3.1547 - val_accuracy100: 0.4401 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 25s - loss: 3.0954 - accuracy100: 0.4596 - val_loss: 3.1508 - val_accuracy100: 0.4400 - 25s/epoch - 21ms/step
Epoch 14/50
1230/1230 - 25s - loss: 3.0932 - accuracy100: 0.4601 - val_loss: 3.1520 - val_accuracy100: 0.4405 - 25s/epoch - 21ms/step
Epoch 15/50
1230/1230 - 25s - loss: 3.0881 - accuracy100: 0.4621 - val_loss: 3.1543 - val_accuracy100: 0.4407 - 25s/epoch - 21ms/step
Epoch 16/50
1230/1230 - 26s - loss: 3.0847 - accuracy100: 0.4635 - val_loss: 3.1635 - val_accuracy100: 0.4399 - 26s/epoch - 21ms/step
Epoch 17/50
1230/1230 - 26s - loss: 3.0806 - accuracy100: 0.4642 - val_loss: 3.1601 - val_accuracy100: 0.4391 - 26s/epoch - 21ms/step
Epoch 18/50
1230/1230 - 28s - loss: 3.0765 - accuracy100: 0.4670 - val_loss: 3.1652 - val_accuracy100: 0.4369 - 28s/epoch - 23ms/step
Epoch 19/50
1230/1230 - 26s - loss: 3.0728 - accuracy100: 0.4676 - val_loss: 3.1693 - val_accuracy100: 0.4405 - 26s/epoch - 21ms/step
testing model: results/WBA/W10/deepVOL_L2/h100
Evaluating performance on  test set...
6546/6546 - 63s - 63s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0630196
{'0': {'precision': 0.4622951314706748, 'recall': 0.22078526103259302, 'f1-score': 0.2988460872132604, 'support': 554720}, '1': {'precision': 0.41680314255925743, 'recall': 0.6276507059865576, 'f1-score': 0.500944655523012, 'support': 575790}, '2': {'precision': 0.42142671931060227, 'recall': 0.42028283806411265, 'f1-score': 0.42085400142143803, 'support': 545259}, 'accuracy': 0.4254953994255771, 'macro avg': {'precision': 0.4335083311135115, 'recall': 0.42290626836108774, 'f1-score': 0.4068815813859035, 'support': 1675769}, 'weighted avg': {'precision': 0.4333665011873279, 'recall': 0.4254953994255771, 'f1-score': 0.40798538262945955, 'support': 1675769}}
[[122474 267149 165097]
 [ 64876 361395 149519]
 [ 77576 238520 229163]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0633401
{'0': {'precision': 0.4676221661567091, 'recall': 0.2423944498033687, 'f1-score': 0.31928553539031046, 'support': 107816}, '1': {'precision': 0.40071150726167437, 'recall': 0.6057800279742321, 'f1-score': 0.48235483276405, 'support': 101522}, '2': {'precision': 0.43419729427167336, 'recall': 0.43409021928826164, 'f1-score': 0.43414375017786166, 'support': 105432}, 'accuracy': 0.42380468278425515, 'macro avg': {'precision': 0.43417698923001896, 'recall': 0.42742156568862083, 'f1-score': 0.411928039444074, 'support': 314770}, 'weighted avg': {'precision': 0.43484599623923026, 'recall': 0.42380468278425515, 'f1-score': 0.41035155981912474, 'support': 314770}}
[[26134 49483 32199]
 [12582 61500 27440]
 [17171 42494 45767]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0483581
{'0': {'precision': 0.46930252738908773, 'recall': 0.23935052002655455, 'f1-score': 0.3170177688221286, 'support': 36152}, '1': {'precision': 0.4386044404168555, 'recall': 0.6446579773570545, 'f1-score': 0.5220338983050847, 'support': 42044}, '2': {'precision': 0.4276807228915663, 'recall': 0.4029456836369828, 'f1-score': 0.4149449136444665, 'support': 35238}, 'accuracy': 0.4403970590828147, 'macro avg': {'precision': 0.44519589689916983, 'recall': 0.428984727006864, 'f1-score': 0.41799886025722666, 'support': 113434}, 'weighted avg': {'precision': 0.44499465218814105, 'recall': 0.4403970590828147, 'f1-score': 0.4234272657739327, 'support': 113434}}
[[ 8653 18695  8804]
 [ 4743 27104 10197]
 [ 5042 15997 14199]]
training model: results/WBA/W10/deepVOL_L2/h200
Epoch 1/50
1230/1230 - 29s - loss: 3.3030 - accuracy200: 0.3657 - val_loss: 3.2804 - val_accuracy200: 0.3743 - 29s/epoch - 23ms/step
Epoch 2/50
1230/1230 - 27s - loss: 3.2718 - accuracy200: 0.3743 - val_loss: 3.2931 - val_accuracy200: 0.3675 - 27s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 28s - loss: 3.2585 - accuracy200: 0.3851 - val_loss: 3.2619 - val_accuracy200: 0.3827 - 28s/epoch - 23ms/step
Epoch 4/50
1230/1230 - 26s - loss: 3.2466 - accuracy200: 0.3956 - val_loss: 3.2582 - val_accuracy200: 0.3824 - 26s/epoch - 21ms/step
Epoch 5/50
1230/1230 - 27s - loss: 3.2397 - accuracy200: 0.3994 - val_loss: 3.2621 - val_accuracy200: 0.3824 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 26s - loss: 3.2346 - accuracy200: 0.4022 - val_loss: 3.2748 - val_accuracy200: 0.3777 - 26s/epoch - 21ms/step
Epoch 7/50
1230/1230 - 26s - loss: 3.2276 - accuracy200: 0.4070 - val_loss: 3.2761 - val_accuracy200: 0.3808 - 26s/epoch - 21ms/step
Epoch 8/50
1230/1230 - 28s - loss: 3.2211 - accuracy200: 0.4102 - val_loss: 3.2924 - val_accuracy200: 0.3774 - 28s/epoch - 23ms/step
Epoch 9/50
1230/1230 - 26s - loss: 3.2148 - accuracy200: 0.4133 - val_loss: 3.3002 - val_accuracy200: 0.3811 - 26s/epoch - 21ms/step
Epoch 10/50
1230/1230 - 28s - loss: 3.2129 - accuracy200: 0.4142 - val_loss: 3.3149 - val_accuracy200: 0.3790 - 28s/epoch - 23ms/step
Epoch 11/50
1230/1230 - 26s - loss: 3.2064 - accuracy200: 0.4180 - val_loss: 3.3263 - val_accuracy200: 0.3795 - 26s/epoch - 21ms/step
Epoch 12/50
1230/1230 - 27s - loss: 3.2017 - accuracy200: 0.4207 - val_loss: 3.3215 - val_accuracy200: 0.3790 - 27s/epoch - 22ms/step
Epoch 13/50
1230/1230 - 28s - loss: 3.1989 - accuracy200: 0.4224 - val_loss: 3.3254 - val_accuracy200: 0.3795 - 28s/epoch - 23ms/step
Epoch 14/50
1230/1230 - 27s - loss: 3.1902 - accuracy200: 0.4260 - val_loss: 3.3376 - val_accuracy200: 0.3802 - 27s/epoch - 22ms/step
testing model: results/WBA/W10/deepVOL_L2/h200
Evaluating performance on  test set...
6546/6546 - 64s - 64s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0964481
{'0': {'precision': 0.39289721398433425, 'recall': 0.1372697692907937, 'f1-score': 0.20345631327493255, 'support': 543368}, '1': {'precision': 0.36496737618019676, 'recall': 0.7952119543584981, 'f1-score': 0.5003130341144578, 'support': 602960}, '2': {'precision': 0.3527799075300295, 'recall': 0.114717220615706, 'f1-score': 0.1731344559973204, 'support': 529441}, 'accuracy': 0.36687932525306294, 'macro avg': {'precision': 0.3702148325648535, 'recall': 0.3490663147549993, 'f1-score': 0.29230126779557025, 'support': 1675769}, 'weighted avg': {'precision': 0.3701731262080021, 'recall': 0.36687932525306294, 'f1-score': 0.3006887444504012, 'support': 1675769}}
[[ 74588 417957  50823]
 [ 62874 479481  60605]
 [ 52379 416326  60736]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0986371
{'0': {'precision': 0.40330367161608516, 'recall': 0.14589685738829994, 'f1-score': 0.2142777916424036, 'support': 105931}, '1': {'precision': 0.3445311934303616, 'recall': 0.7576407556925152, 'f1-score': 0.4736663348363296, 'support': 106763}, '2': {'precision': 0.374712036859282, 'recall': 0.15297425447705632, 'f1-score': 0.21725519659403958, 'support': 102076}, 'accuracy': 0.35568192648600566, 'macro avg': {'precision': 0.37418230063524294, 'recall': 0.3521706225192905, 'f1-score': 0.30173310769092426, 'support': 314770}, 'weighted avg': {'precision': 0.3740974391352965, 'recall': 0.35568192648600566, 'f1-score': 0.30322216570872607, 'support': 314770}}
[[15455 78197 12279]
 [12097 80888 13778]
 [10769 75692 15615]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0855398
{'0': {'precision': 0.4004991558393893, 'recall': 0.15155134579595012, 'f1-score': 0.21989359987103013, 'support': 36001}, '1': {'precision': 0.3835431198656765, 'recall': 0.7940833372217815, 'f1-score': 0.5172526462162716, 'support': 42862}, '2': {'precision': 0.36305329719963864, 'recall': 0.11625350727488357, 'f1-score': 0.17611358208628206, 'support': 34571}, 'accuracy': 0.38357987904860974, 'macro avg': {'precision': 0.3823651909682348, 'recall': 0.35396273009753837, 'f1-score': 0.30441994272452794, 'support': 113434}, 'weighted avg': {'precision': 0.3826798918361795, 'recall': 0.38357987904860974, 'f1-score': 0.3189105123453607, 'support': 113434}}
[[ 5456 27649  2896]
 [ 4671 34036  4155]
 [ 3496 27056  4019]]
training model: results/WBA/W10/deepVOL_L2/h300
Epoch 1/50
1230/1230 - 28s - loss: 3.3133 - accuracy300: 0.3550 - val_loss: 3.3001 - val_accuracy300: 0.3460 - 28s/epoch - 23ms/step
Epoch 2/50
1230/1230 - 27s - loss: 3.2914 - accuracy300: 0.3488 - val_loss: 3.2980 - val_accuracy300: 0.3468 - 27s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 28s - loss: 3.2848 - accuracy300: 0.3586 - val_loss: 3.2963 - val_accuracy300: 0.3467 - 28s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 26s - loss: 3.2787 - accuracy300: 0.3676 - val_loss: 3.2926 - val_accuracy300: 0.3501 - 26s/epoch - 21ms/step
Epoch 5/50
1230/1230 - 27s - loss: 3.2690 - accuracy300: 0.3785 - val_loss: 3.2953 - val_accuracy300: 0.3554 - 27s/epoch - 22ms/step
Epoch 6/50
1230/1230 - 28s - loss: 3.2608 - accuracy300: 0.3879 - val_loss: 3.2989 - val_accuracy300: 0.3557 - 28s/epoch - 23ms/step
Epoch 7/50
1230/1230 - 27s - loss: 3.2572 - accuracy300: 0.3905 - val_loss: 3.2966 - val_accuracy300: 0.3585 - 27s/epoch - 22ms/step
Epoch 8/50
1230/1230 - 28s - loss: 3.2507 - accuracy300: 0.3957 - val_loss: 3.3033 - val_accuracy300: 0.3591 - 28s/epoch - 23ms/step
Epoch 9/50
1230/1230 - 26s - loss: 3.2475 - accuracy300: 0.3978 - val_loss: 3.2955 - val_accuracy300: 0.3594 - 26s/epoch - 21ms/step
Epoch 10/50
1230/1230 - 27s - loss: 3.2447 - accuracy300: 0.3987 - val_loss: 3.2981 - val_accuracy300: 0.3598 - 27s/epoch - 22ms/step
Epoch 11/50
1230/1230 - 25s - loss: 3.2380 - accuracy300: 0.4036 - val_loss: 3.3002 - val_accuracy300: 0.3607 - 25s/epoch - 21ms/step
Epoch 12/50
1230/1230 - 28s - loss: 3.2314 - accuracy300: 0.4079 - val_loss: 3.2997 - val_accuracy300: 0.3619 - 28s/epoch - 23ms/step
Epoch 13/50
1230/1230 - 26s - loss: 3.2270 - accuracy300: 0.4106 - val_loss: 3.3032 - val_accuracy300: 0.3610 - 26s/epoch - 21ms/step
Epoch 14/50
1230/1230 - 26s - loss: 3.2196 - accuracy300: 0.4154 - val_loss: 3.3102 - val_accuracy300: 0.3591 - 26s/epoch - 21ms/step
testing model: results/WBA/W10/deepVOL_L2/h300
Evaluating performance on  test set...
6546/6546 - 62s - 62s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1049385
{'0': {'precision': 0.3818464103964808, 'recall': 0.0232268151578535, 'f1-score': 0.043789988740093995, 'support': 571796}, '1': {'precision': 0.3323669408853493, 'recall': 0.7844780928187307, 'f1-score': 0.46691273369769765, 'support': 548747}, '2': {'precision': 0.3396078000422218, 'recall': 0.21150666575412536, 'f1-score': 0.2606693088603015, 'support': 555226}, 'accuracy': 0.33488804244499093, 'macro avg': {'precision': 0.3512737171080173, 'recall': 0.3397371912435698, 'f1-score': 0.2571240104326977, 'support': 1675769}, 'weighted avg': {'precision': 0.35164911880773636, 'recall': 0.33488804244499093, 'f1-score': 0.2542034611938227, 'support': 1675769}}
[[ 13281 437716 120799]
 [ 10707 430480 107560]
 [ 10793 426999 117434]]
Evaluating performance on  train set...
1230/1230 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1042327
{'0': {'precision': 0.40145886802647573, 'recall': 0.027014006926202313, 'f1-score': 0.05062169988076988, 'support': 110017}, '1': {'precision': 0.3209025099511209, 'recall': 0.7862910968941714, 'f1-score': 0.45578801211560205, 'support': 98943}, '2': {'precision': 0.37145013244625147, 'recall': 0.2279463188734524, 'f1-score': 0.2825198252333931, 'support': 105810}, 'accuracy': 0.3332242589827493, 'macro avg': {'precision': 0.3646038368079494, 'recall': 0.3470838075646087, 'f1-score': 0.2629765124099217, 'support': 314770}, 'weighted avg': {'precision': 0.36604980093369893, 'recall': 0.3332242589827493, 'f1-score': 0.2559319615798265, 'support': 314770}}
[[ 2972 85105 21940]
 [ 2272 77798 18873]
 [ 2159 79532 24119]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0985001
{'0': {'precision': 0.39723320158102765, 'recall': 0.03175355450236967, 'f1-score': 0.058806319485078994, 'support': 37980}, '1': {'precision': 0.34903844073809676, 'recall': 0.8255941873257093, 'f1-score': 0.49064550216282365, 'support': 39087}, '2': {'precision': 0.3547146678555506, 'recall': 0.1750213105287761, 'f1-score': 0.2343908232218151, 'support': 36367}, 'accuracy': 0.3512262637304512, 'macro avg': {'precision': 0.3669954367248917, 'recall': 0.3441230174522851, 'f1-score': 0.26128088162323926, 'support': 113434}, 'weighted avg': {'precision': 0.36699482390711985, 'recall': 0.3512262637304512, 'f1-score': 0.26390161525811784, 'support': 113434}}
[[ 1206 31026  5748]
 [  986 32270  5831]
 [  844 29158  6365]]
training model: results/WBA/W10/deepVOL_L2/h500
Epoch 1/50
1230/1230 - 29s - loss: 3.2807 - accuracy500: 0.3907 - val_loss: 3.3072 - val_accuracy500: 0.3440 - 29s/epoch - 23ms/step
Epoch 2/50
1230/1230 - 26s - loss: 3.2815 - accuracy500: 0.3730 - val_loss: 3.2965 - val_accuracy500: 0.3482 - 26s/epoch - 21ms/step
Epoch 3/50
1230/1230 - 27s - loss: 3.2783 - accuracy500: 0.3749 - val_loss: 3.2974 - val_accuracy500: 0.3498 - 27s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 26s - loss: 3.2730 - accuracy500: 0.3781 - val_loss: 3.2978 - val_accuracy500: 0.3493 - 26s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 26s - loss: 3.2658 - accuracy500: 0.3860 - val_loss: 3.2996 - val_accuracy500: 0.3512 - 26s/epoch - 21ms/step
Epoch 6/50
1230/1230 - 26s - loss: 3.2528 - accuracy500: 0.3962 - val_loss: 3.2993 - val_accuracy500: 0.3528 - 26s/epoch - 22ms/step
Epoch 7/50
1230/1230 - 26s - loss: 3.2390 - accuracy500: 0.4022 - val_loss: 3.3006 - val_accuracy500: 0.3500 - 26s/epoch - 21ms/step
Epoch 8/50
1230/1230 - 26s - loss: 3.2305 - accuracy500: 0.4082 - val_loss: 3.2960 - val_accuracy500: 0.3548 - 26s/epoch - 21ms/step
Epoch 9/50
1230/1230 - 26s - loss: 3.2168 - accuracy500: 0.4150 - val_loss: 3.2999 - val_accuracy500: 0.3570 - 26s/epoch - 21ms/step
Epoch 10/50
1230/1230 - 26s - loss: 3.2059 - accuracy500: 0.4207 - val_loss: 3.2942 - val_accuracy500: 0.3576 - 26s/epoch - 21ms/step
Epoch 11/50
1230/1230 - 26s - loss: 3.1980 - accuracy500: 0.4233 - val_loss: 3.3077 - val_accuracy500: 0.3527 - 26s/epoch - 21ms/step
Epoch 12/50
1230/1230 - 26s - loss: 3.1908 - accuracy500: 0.4282 - val_loss: 3.3096 - val_accuracy500: 0.3502 - 26s/epoch - 21ms/step
Epoch 13/50
1230/1230 - 25s - loss: 3.1759 - accuracy500: 0.4360 - val_loss: 3.3197 - val_accuracy500: 0.3498 - 25s/epoch - 21ms/step
Epoch 14/50
1230/1230 - 28s - loss: 3.1694 - accuracy500: 0.4390 - val_loss: 3.3143 - val_accuracy500: 0.3538 - 28s/epoch - 23ms/step
Epoch 15/50
1230/1230 - 27s - loss: 3.1630 - accuracy500: 0.4416 - val_loss: 3.3199 - val_accuracy500: 0.3522 - 27s/epoch - 22ms/step
Epoch 16/50
1230/1230 - 26s - loss: 3.1526 - accuracy500: 0.4475 - val_loss: 3.3152 - val_accuracy500: 0.3576 - 26s/epoch - 21ms/step
Epoch 17/50
1230/1230 - 28s - loss: 3.1429 - accuracy500: 0.4515 - val_loss: 3.3109 - val_accuracy500: 0.3569 - 28s/epoch - 23ms/step
Epoch 18/50
1230/1230 - 28s - loss: 3.1346 - accuracy500: 0.4549 - val_loss: 3.3217 - val_accuracy500: 0.3576 - 28s/epoch - 22ms/step
Epoch 19/50
1230/1230 - 27s - loss: 3.1247 - accuracy500: 0.4586 - val_loss: 3.3378 - val_accuracy500: 0.3543 - 27s/epoch - 22ms/step
Epoch 20/50
1230/1230 - 28s - loss: 3.1177 - accuracy500: 0.4607 - val_loss: 3.3348 - val_accuracy500: 0.3584 - 28s/epoch - 23ms/step
testing model: results/WBA/W10/deepVOL_L2/h500
Evaluating performance on  test set...
6546/6546 - 63s - 63s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1030128
{'0': {'precision': 0.36828785456868, 'recall': 0.34520533395131464, 'f1-score': 0.35637321805499367, 'support': 621378}, '1': {'precision': 0.26560923355374433, 'recall': 0.20660898665653105, 'f1-score': 0.23242328331473763, 'support': 444637}, '2': {'precision': 0.36338727997356407, 'recall': 0.4454583323766634, 'f1-score': 0.40025905876787937, 'support': 609754}, 'accuracy': 0.34490971010920957, 'macro avg': {'precision': 0.3324281226986628, 'recall': 0.33242421766150304, 'f1-score': 0.3296851867125369, 'support': 1675769}, 'weighted avg': {'precision': 0.3392606682596552, 'recall': 0.34490971010920957, 'f1-score': 0.3394537260396513, 'support': 1675769}}
[[214503 126919 279956]
 [156880  91866 195891]
 [211050 127084 271620]]
Evaluating performance on  train set...
1230/1230 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1009283
{'0': {'precision': 0.3633233411650328, 'recall': 0.3296275198000698, 'f1-score': 0.34565617442745517, 'support': 108838}, '1': {'precision': 0.3542830313921673, 'recall': 0.21620313194684582, 'f1-score': 0.2685327214048177, 'support': 101215}, '2': {'precision': 0.3514089939646957, 'recall': 0.5176618887095696, 'f1-score': 0.4186333868775485, 'support': 104717}, 'accuracy': 0.35571051879149856, 'macro avg': {'precision': 0.3563384555072986, 'recall': 0.3544975134854951, 'f1-score': 0.3442740942366071, 'support': 314770}, 'weighted avg': {'precision': 0.3564527701149382, 'recall': 0.35571051879149856, 'f1-score': 0.3451348555547868, 'support': 314770}}
[[35876 20358 52604]
 [31885 21883 47447]
 [30983 19526 54208]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0990357
{'0': {'precision': 0.37479686807504803, 'recall': 0.3792605142515447, 'f1-score': 0.37701547987616096, 'support': 40136}, '1': {'precision': 0.3172488997935896, 'recall': 0.23539950874151133, 'f1-score': 0.27026309677847454, 'support': 34605}, '2': {'precision': 0.3673504019684789, 'recall': 0.44757449667898586, 'f1-score': 0.4035136772449788, 'support': 38693}, 'accuracy': 0.35867552938272473, 'macro avg': {'precision': 0.3531320566123721, 'recall': 0.35407817322401397, 'f1-score': 0.35026408463320474, 'support': 113434}, 'weighted avg': {'precision': 0.35470083376927247, 'recall': 0.35867552938272473, 'f1-score': 0.3534875123681495, 'support': 113434}}
[[15222  8945 15969]
 [12603  8146 13856]
 [12789  8586 17318]]
training model: results/WBA/W10/deepVOL_L2/h1000
Epoch 1/50
1230/1230 - 29s - loss: 3.2914 - accuracy1000: 0.3824 - val_loss: 3.3430 - val_accuracy1000: 0.3689 - 29s/epoch - 23ms/step
Epoch 2/50
1230/1230 - 27s - loss: 3.2769 - accuracy1000: 0.3777 - val_loss: 3.3037 - val_accuracy1000: 0.3761 - 27s/epoch - 22ms/step
Epoch 3/50
1230/1230 - 27s - loss: 3.2543 - accuracy1000: 0.3945 - val_loss: 3.3079 - val_accuracy1000: 0.3776 - 27s/epoch - 22ms/step
Epoch 4/50
1230/1230 - 26s - loss: 3.2463 - accuracy1000: 0.3984 - val_loss: 3.3015 - val_accuracy1000: 0.3775 - 26s/epoch - 22ms/step
Epoch 5/50
1230/1230 - 26s - loss: 3.2340 - accuracy1000: 0.4033 - val_loss: 3.2978 - val_accuracy1000: 0.3792 - 26s/epoch - 21ms/step
Epoch 6/50
1230/1230 - 25s - loss: 3.2263 - accuracy1000: 0.4081 - val_loss: 3.3212 - val_accuracy1000: 0.3740 - 25s/epoch - 21ms/step
Epoch 7/50
1230/1230 - 25s - loss: 3.2181 - accuracy1000: 0.4127 - val_loss: 3.3283 - val_accuracy1000: 0.3747 - 25s/epoch - 21ms/step
Epoch 8/50
1230/1230 - 27s - loss: 3.2100 - accuracy1000: 0.4157 - val_loss: 3.3267 - val_accuracy1000: 0.3725 - 27s/epoch - 22ms/step
Epoch 9/50
1230/1230 - 26s - loss: 3.2014 - accuracy1000: 0.4194 - val_loss: 3.3149 - val_accuracy1000: 0.3729 - 26s/epoch - 22ms/step
Epoch 10/50
1230/1230 - 26s - loss: 3.1925 - accuracy1000: 0.4242 - val_loss: 3.3154 - val_accuracy1000: 0.3698 - 26s/epoch - 21ms/step
Epoch 11/50
1230/1230 - 28s - loss: 3.1869 - accuracy1000: 0.4274 - val_loss: 3.3221 - val_accuracy1000: 0.3757 - 28s/epoch - 23ms/step
Epoch 12/50
1230/1230 - 26s - loss: 3.1798 - accuracy1000: 0.4299 - val_loss: 3.3320 - val_accuracy1000: 0.3724 - 26s/epoch - 21ms/step
Epoch 13/50
1230/1230 - 27s - loss: 3.1704 - accuracy1000: 0.4339 - val_loss: 3.3403 - val_accuracy1000: 0.3662 - 27s/epoch - 22ms/step
Epoch 14/50
1230/1230 - 26s - loss: 3.1613 - accuracy1000: 0.4379 - val_loss: 3.3658 - val_accuracy1000: 0.3640 - 26s/epoch - 21ms/step
Epoch 15/50
1230/1230 - 28s - loss: 3.1547 - accuracy1000: 0.4394 - val_loss: 3.3717 - val_accuracy1000: 0.3635 - 28s/epoch - 23ms/step
testing model: results/WBA/W10/deepVOL_L2/h1000
Evaluating performance on  test set...
6546/6546 - 61s - 61s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1015323
{'0': {'precision': 0.3727141700724595, 'recall': 0.17339260783305166, 'f1-score': 0.2366785564283073, 'support': 544360}, '1': {'precision': 0.37504483580261294, 'recall': 0.806576941388812, 'f1-score': 0.5120124262847515, 'support': 602803}, '2': {'precision': 0.327764871914816, 'recall': 0.07820569573557622, 'f1-score': 0.12628048380026669, 'support': 528606}, 'accuracy': 0.3711340882902118, 'macro avg': {'precision': 0.3585079592632962, 'recall': 0.3527250816524799, 'f1-score': 0.2916571555044418, 'support': 1675769}, 'weighted avg': {'precision': 0.35937370583915196, 'recall': 0.3711340882902118, 'f1-score': 0.30089683422880137, 'support': 1675769}}
[[ 94388 407002  42970]
 [ 74779 486207  41817]
 [ 84078 403188  41340]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1077837
{'0': {'precision': 0.3660369658737311, 'recall': 0.20215233498295598, 'f1-score': 0.2604597701149425, 'support': 106489}, '1': {'precision': 0.35942883046237534, 'recall': 0.7447797785104404, 'f1-score': 0.4848636798640009, 'support': 106461}, '2': {'precision': 0.33649141661246074, 'recall': 0.1168532704773129, 'f1-score': 0.17346678427456094, 'support': 101820}, 'accuracy': 0.35808685707024174, 'macro avg': {'precision': 0.3539857376495224, 'recall': 0.3545951279902364, 'f1-score': 0.3062634114178348, 'support': 314770}, 'weighted avg': {'precision': 0.3542447476515025, 'recall': 0.35808685707024174, 'f1-score': 0.30821730360773675, 'support': 314770}}
[[21527 73202 11760]
 [15470 79290 11701]
 [21814 68108 11898]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990818
{'0': {'precision': 0.3512733152393602, 'recall': 0.16770511689457432, 'f1-score': 0.22702420272817184, 'support': 36272}, '1': {'precision': 0.3884606639381537, 'recall': 0.8060627506487379, 'f1-score': 0.524265439202148, 'support': 42390}, '2': {'precision': 0.3372563442442074, 'recall': 0.07911538019095825, 'f1-score': 0.12816510983251414, 'support': 34772}, 'accuracy': 0.3791015039582489, 'macro avg': {'precision': 0.3589967744739071, 'recall': 0.35096108257809017, 'f1-score': 0.29315158392094465, 'support': 113434}, 'weighted avg': {'precision': 0.3608733786762346, 'recall': 0.3791015039582489, 'f1-score': 0.3077982884164491, 'support': 113434}}
[[ 6083 27644  2545]
 [ 5360 34169  2861]
 [ 5874 26147  2751]]
training model: results/WBA/W10/deepVOL_L3/h10
Epoch 1/50
1230/1230 - 45s - loss: 3.2822 - accuracy10: 0.4308 - val_loss: 3.0490 - val_accuracy10: 0.6002 - 45s/epoch - 36ms/step
Epoch 2/50
1230/1230 - 41s - loss: 3.0271 - accuracy10: 0.4581 - val_loss: 2.6487 - val_accuracy10: 0.5027 - 41s/epoch - 33ms/step
Epoch 3/50
1230/1230 - 46s - loss: 2.8039 - accuracy10: 0.5111 - val_loss: 2.5605 - val_accuracy10: 0.5858 - 46s/epoch - 37ms/step
Epoch 4/50
1230/1230 - 46s - loss: 2.7333 - accuracy10: 0.5350 - val_loss: 2.5576 - val_accuracy10: 0.5833 - 46s/epoch - 37ms/step
Epoch 5/50
1230/1230 - 42s - loss: 2.7022 - accuracy10: 0.5428 - val_loss: 2.5642 - val_accuracy10: 0.6112 - 42s/epoch - 34ms/step
Epoch 6/50
1230/1230 - 41s - loss: 2.6726 - accuracy10: 0.5534 - val_loss: 2.4971 - val_accuracy10: 0.6137 - 41s/epoch - 33ms/step
Epoch 7/50
1230/1230 - 40s - loss: 2.6505 - accuracy10: 0.5571 - val_loss: 2.5078 - val_accuracy10: 0.6213 - 40s/epoch - 32ms/step
Epoch 8/50
1230/1230 - 45s - loss: 2.6313 - accuracy10: 0.5624 - val_loss: 2.4795 - val_accuracy10: 0.6157 - 45s/epoch - 36ms/step
Epoch 9/50
1230/1230 - 45s - loss: 2.6173 - accuracy10: 0.5658 - val_loss: 2.4663 - val_accuracy10: 0.6267 - 45s/epoch - 36ms/step
Epoch 10/50
1230/1230 - 41s - loss: 2.6102 - accuracy10: 0.5671 - val_loss: 2.4910 - val_accuracy10: 0.6211 - 41s/epoch - 34ms/step
Epoch 11/50
1230/1230 - 40s - loss: 2.6010 - accuracy10: 0.5696 - val_loss: 2.4917 - val_accuracy10: 0.6254 - 40s/epoch - 33ms/step
Epoch 12/50
1230/1230 - 41s - loss: 2.5900 - accuracy10: 0.5718 - val_loss: 2.4789 - val_accuracy10: 0.6234 - 41s/epoch - 33ms/step
Epoch 13/50
1230/1230 - 40s - loss: 2.5820 - accuracy10: 0.5731 - val_loss: 2.4945 - val_accuracy10: 0.6250 - 40s/epoch - 33ms/step
Epoch 14/50
1230/1230 - 40s - loss: 2.5763 - accuracy10: 0.5742 - val_loss: 2.5175 - val_accuracy10: 0.6191 - 40s/epoch - 33ms/step
Epoch 15/50
1230/1230 - 40s - loss: 2.5692 - accuracy10: 0.5765 - val_loss: 2.4961 - val_accuracy10: 0.6138 - 40s/epoch - 33ms/step
Epoch 16/50
1230/1230 - 41s - loss: 2.5683 - accuracy10: 0.5765 - val_loss: 2.5173 - val_accuracy10: 0.6188 - 41s/epoch - 33ms/step
Epoch 17/50
1230/1230 - 40s - loss: 2.5593 - accuracy10: 0.5768 - val_loss: 2.5268 - val_accuracy10: 0.6138 - 40s/epoch - 33ms/step
Epoch 18/50
1230/1230 - 40s - loss: 2.5538 - accuracy10: 0.5782 - val_loss: 2.5007 - val_accuracy10: 0.6176 - 40s/epoch - 33ms/step
Epoch 19/50
1230/1230 - 44s - loss: 2.5471 - accuracy10: 0.5803 - val_loss: 2.5224 - val_accuracy10: 0.6150 - 44s/epoch - 36ms/step
testing model: results/WBA/W10/deepVOL_L3/h10
Evaluating performance on  test set...
6546/6546 - 87s - 87s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87720466
{'0': {'precision': 0.42868007623022947, 'recall': 0.3138757498939707, 'f1-score': 0.3624031369969011, 'support': 308877}, '1': {'precision': 0.7848834734238048, 'recall': 0.6254707059741493, 'f1-score': 0.6961678525877694, 'support': 1061172}, '2': {'precision': 0.3451937851011974, 'recall': 0.6819508046578568, 'f1-score': 0.45836814380315005, 'support': 305720}, 'accuracy': 0.5783416449403229, 'macro avg': {'precision': 0.5195857782517439, 'recall': 0.5404324201753257, 'f1-score': 0.5056463777959402, 'support': 1675769}, 'weighted avg': {'precision': 0.639013148678003, 'recall': 0.5783416449403229, 'f1-score': 0.5912653445289652, 'support': 1675769}}
[[ 96949 113901  98027]
 [ 99985 663732 297455]
 [ 29223  68011 208486]]
Evaluating performance on  train set...
1230/1230 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89352584
{'0': {'precision': 0.4608248515691264, 'recall': 0.27876475115443816, 'f1-score': 0.3473865089514066, 'support': 62368}, '1': {'precision': 0.7828971987597563, 'recall': 0.6139443483728974, 'f1-score': 0.6882030557040397, 'support': 190830}, '2': {'precision': 0.3467588740443035, 'recall': 0.7174527382576495, 'f1-score': 0.46754442598139356, 'support': 61572}, 'accuracy': 0.5677796486323348, 'macro avg': {'precision': 0.5301603081243954, 'recall': 0.536720612594995, 'f1-score': 0.5010446635456133, 'support': 314770}, 'weighted avg': {'precision': 0.6337695275110189, 'recall': 0.5677796486323348, 'f1-score': 0.577511313996917, 'support': 314770}}
[[ 17386  19904  25078]
 [ 15530 117159  58141]
 [  4812  12585  44175]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7979106
{'0': {'precision': 0.4540300546448087, 'recall': 0.341064190055929, 'f1-score': 0.3895221072987781, 'support': 19489}, '1': {'precision': 0.8224661380641661, 'recall': 0.6865494739645759, 'f1-score': 0.7483868158030353, 'support': 75090}, '2': {'precision': 0.35715670257248083, 'recall': 0.6840625828692655, 'f1-score': 0.4692912239848639, 'support': 18855}, 'accuracy': 0.6267785672725991, 'macro avg': {'precision': 0.5445509650938186, 'recall': 0.5705587489632568, 'f1-score': 0.5357333823622258, 'support': 113434}, 'weighted avg': {'precision': 0.6818217083873886, 'recall': 0.6267785672725991, 'f1-score': 0.6403393019379587, 'support': 113434}}
[[ 6647  6843  5999]
 [ 6321 51553 17216]
 [ 1672  4285 12898]]
training model: results/WBA/W10/deepVOL_L3/h20
Epoch 1/50
1230/1230 - 45s - loss: 3.2410 - accuracy20: 0.4236 - val_loss: 2.9766 - val_accuracy20: 0.4859 - 45s/epoch - 36ms/step
Epoch 2/50
1230/1230 - 46s - loss: 3.0611 - accuracy20: 0.4581 - val_loss: 2.7495 - val_accuracy20: 0.4985 - 46s/epoch - 38ms/step
Epoch 3/50
1230/1230 - 45s - loss: 2.8891 - accuracy20: 0.5097 - val_loss: 2.6735 - val_accuracy20: 0.5395 - 45s/epoch - 37ms/step
Epoch 4/50
1230/1230 - 41s - loss: 2.8166 - accuracy20: 0.5338 - val_loss: 2.6170 - val_accuracy20: 0.5834 - 41s/epoch - 33ms/step
Epoch 5/50
1230/1230 - 42s - loss: 2.7818 - accuracy20: 0.5424 - val_loss: 2.6255 - val_accuracy20: 0.5759 - 42s/epoch - 34ms/step
Epoch 6/50
1230/1230 - 41s - loss: 2.7528 - accuracy20: 0.5488 - val_loss: 2.6279 - val_accuracy20: 0.5845 - 41s/epoch - 34ms/step
Epoch 7/50
1230/1230 - 42s - loss: 2.7377 - accuracy20: 0.5535 - val_loss: 2.6323 - val_accuracy20: 0.5861 - 42s/epoch - 34ms/step
Epoch 8/50
1230/1230 - 41s - loss: 2.7221 - accuracy20: 0.5564 - val_loss: 2.6164 - val_accuracy20: 0.5909 - 41s/epoch - 33ms/step
Epoch 9/50
1230/1230 - 41s - loss: 2.7092 - accuracy20: 0.5593 - val_loss: 2.6244 - val_accuracy20: 0.5849 - 41s/epoch - 34ms/step
Epoch 10/50
1230/1230 - 42s - loss: 2.6962 - accuracy20: 0.5630 - val_loss: 2.6038 - val_accuracy20: 0.5943 - 42s/epoch - 34ms/step
Epoch 11/50
1230/1230 - 41s - loss: 2.6880 - accuracy20: 0.5649 - val_loss: 2.6082 - val_accuracy20: 0.5884 - 41s/epoch - 34ms/step
Epoch 12/50
1230/1230 - 42s - loss: 2.6815 - accuracy20: 0.5668 - val_loss: 2.5998 - val_accuracy20: 0.5970 - 42s/epoch - 34ms/step
Epoch 13/50
1230/1230 - 41s - loss: 2.6749 - accuracy20: 0.5682 - val_loss: 2.5852 - val_accuracy20: 0.6012 - 41s/epoch - 34ms/step
Epoch 14/50
1230/1230 - 42s - loss: 2.6698 - accuracy20: 0.5700 - val_loss: 2.5799 - val_accuracy20: 0.6036 - 42s/epoch - 34ms/step
Epoch 15/50
1230/1230 - 43s - loss: 2.6640 - accuracy20: 0.5703 - val_loss: 2.5907 - val_accuracy20: 0.5952 - 43s/epoch - 35ms/step
Epoch 16/50
1230/1230 - 41s - loss: 2.6578 - accuracy20: 0.5723 - val_loss: 2.5932 - val_accuracy20: 0.5965 - 41s/epoch - 34ms/step
Epoch 17/50
1230/1230 - 43s - loss: 2.6531 - accuracy20: 0.5730 - val_loss: 2.5843 - val_accuracy20: 0.5976 - 43s/epoch - 35ms/step
Epoch 18/50
1230/1230 - 42s - loss: 2.6479 - accuracy20: 0.5749 - val_loss: 2.5711 - val_accuracy20: 0.5879 - 42s/epoch - 34ms/step
Epoch 19/50
1230/1230 - 44s - loss: 2.6433 - accuracy20: 0.5757 - val_loss: 2.5821 - val_accuracy20: 0.5932 - 44s/epoch - 35ms/step
Epoch 20/50
1230/1230 - 41s - loss: 2.6384 - accuracy20: 0.5774 - val_loss: 2.5479 - val_accuracy20: 0.5945 - 41s/epoch - 33ms/step
Epoch 21/50
1230/1230 - 41s - loss: 2.6348 - accuracy20: 0.5770 - val_loss: 2.5612 - val_accuracy20: 0.5872 - 41s/epoch - 33ms/step
Epoch 22/50
1230/1230 - 44s - loss: 2.6259 - accuracy20: 0.5793 - val_loss: 2.5755 - val_accuracy20: 0.5847 - 44s/epoch - 35ms/step
Epoch 23/50
1230/1230 - 41s - loss: 2.6241 - accuracy20: 0.5796 - val_loss: 2.5646 - val_accuracy20: 0.5893 - 41s/epoch - 33ms/step
Epoch 24/50
1230/1230 - 41s - loss: 2.6225 - accuracy20: 0.5797 - val_loss: 2.5624 - val_accuracy20: 0.5916 - 41s/epoch - 33ms/step
Epoch 25/50
1230/1230 - 41s - loss: 2.6160 - accuracy20: 0.5807 - val_loss: 2.5779 - val_accuracy20: 0.5910 - 41s/epoch - 33ms/step
Epoch 26/50
1230/1230 - 41s - loss: 2.6123 - accuracy20: 0.5814 - val_loss: 2.5516 - val_accuracy20: 0.5915 - 41s/epoch - 33ms/step
Epoch 27/50
1230/1230 - 41s - loss: 2.6081 - accuracy20: 0.5824 - val_loss: 2.5622 - val_accuracy20: 0.5960 - 41s/epoch - 33ms/step
Epoch 28/50
1230/1230 - 42s - loss: 2.6067 - accuracy20: 0.5817 - val_loss: 2.5336 - val_accuracy20: 0.6040 - 42s/epoch - 34ms/step
Epoch 29/50
1230/1230 - 40s - loss: 2.6029 - accuracy20: 0.5825 - val_loss: 2.5452 - val_accuracy20: 0.6029 - 40s/epoch - 33ms/step
Epoch 30/50
1230/1230 - 40s - loss: 2.5974 - accuracy20: 0.5831 - val_loss: 2.5488 - val_accuracy20: 0.5960 - 40s/epoch - 33ms/step
Epoch 31/50
1230/1230 - 40s - loss: 2.5930 - accuracy20: 0.5848 - val_loss: 2.5370 - val_accuracy20: 0.6078 - 40s/epoch - 33ms/step
Epoch 32/50
1230/1230 - 41s - loss: 2.5901 - accuracy20: 0.5853 - val_loss: 2.5403 - val_accuracy20: 0.6046 - 41s/epoch - 33ms/step
Epoch 33/50
1230/1230 - 41s - loss: 2.5884 - accuracy20: 0.5852 - val_loss: 2.5223 - val_accuracy20: 0.6061 - 41s/epoch - 33ms/step
Epoch 34/50
1230/1230 - 40s - loss: 2.5859 - accuracy20: 0.5850 - val_loss: 2.5265 - val_accuracy20: 0.6069 - 40s/epoch - 33ms/step
Epoch 35/50
1230/1230 - 40s - loss: 2.5820 - accuracy20: 0.5863 - val_loss: 2.5300 - val_accuracy20: 0.6042 - 40s/epoch - 33ms/step
Epoch 36/50
1230/1230 - 40s - loss: 2.5775 - accuracy20: 0.5867 - val_loss: 2.5170 - val_accuracy20: 0.6090 - 40s/epoch - 32ms/step
Epoch 37/50
1230/1230 - 40s - loss: 2.5734 - accuracy20: 0.5870 - val_loss: 2.5201 - val_accuracy20: 0.6127 - 40s/epoch - 32ms/step
Epoch 38/50
1230/1230 - 40s - loss: 2.5698 - accuracy20: 0.5891 - val_loss: 2.5410 - val_accuracy20: 0.6056 - 40s/epoch - 33ms/step
Epoch 39/50
1230/1230 - 40s - loss: 2.5652 - accuracy20: 0.5889 - val_loss: 2.5257 - val_accuracy20: 0.6038 - 40s/epoch - 33ms/step
Epoch 40/50
1230/1230 - 40s - loss: 2.5611 - accuracy20: 0.5898 - val_loss: 2.5299 - val_accuracy20: 0.6055 - 40s/epoch - 33ms/step
Epoch 41/50
1230/1230 - 40s - loss: 2.5597 - accuracy20: 0.5899 - val_loss: 2.5287 - val_accuracy20: 0.6025 - 40s/epoch - 33ms/step
Epoch 42/50
1230/1230 - 41s - loss: 2.5528 - accuracy20: 0.5914 - val_loss: 2.5452 - val_accuracy20: 0.6009 - 41s/epoch - 33ms/step
Epoch 43/50
1230/1230 - 40s - loss: 2.5492 - accuracy20: 0.5925 - val_loss: 2.5246 - val_accuracy20: 0.6071 - 40s/epoch - 33ms/step
Epoch 44/50
1230/1230 - 40s - loss: 2.5460 - accuracy20: 0.5932 - val_loss: 2.5317 - val_accuracy20: 0.6085 - 40s/epoch - 32ms/step
Epoch 45/50
1230/1230 - 40s - loss: 2.5429 - accuracy20: 0.5937 - val_loss: 2.5367 - val_accuracy20: 0.6042 - 40s/epoch - 32ms/step
Epoch 46/50
1230/1230 - 40s - loss: 2.5396 - accuracy20: 0.5943 - val_loss: 2.5377 - val_accuracy20: 0.6025 - 40s/epoch - 33ms/step
testing model: results/WBA/W10/deepVOL_L3/h20
Evaluating performance on  test set...
6546/6546 - 91s - 91s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91425407
{'0': {'precision': 0.4639647022401902, 'recall': 0.4499427296993183, 'f1-score': 0.4568461472450314, 'support': 396366}, '1': {'precision': 0.6962103291039581, 'recall': 0.6463277218509432, 'f1-score': 0.6703423200836672, 'support': 886575}, '2': {'precision': 0.43659265174695566, 'recall': 0.5205051574734999, 'f1-score': 0.47487043593676875, 'support': 392828}, 'accuracy': 0.5703823140301557, 'macro avg': {'precision': 0.5322558943637014, 'recall': 0.5389252030079205, 'f1-score': 0.5340196344218225, 'support': 1675769}, 'weighted avg': {'precision': 0.5804190934991219, 'recall': 0.5703823140301557, 'f1-score': 0.5740226881123056, 'support': 1675769}}
[[178342 133353  84671]
 [134368 573018 179189]
 [ 71677 116682 204469]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91404
{'0': {'precision': 0.4734298352396678, 'recall': 0.4958907222481726, 'f1-score': 0.48440004932790726, 'support': 79211}, '1': {'precision': 0.7031409341219661, 'recall': 0.6136525453898184, 'f1-score': 0.6553559547571522, 'support': 157304}, '2': {'precision': 0.4469566321402499, 'recall': 0.539837710050476, 'f1-score': 0.48902599958326576, 'support': 78255}, 'accuracy': 0.5656669949486927, 'macro avg': {'precision': 0.5411758005006279, 'recall': 0.549793659229489, 'f1-score': 0.5429273345561084, 'support': 314770}, 'weighted avg': {'precision': 0.5816447673807108, 'recall': 0.5656669949486927, 'f1-score': 0.5709840677695472, 'support': 314770}}
[[39280 20657 19274]
 [27776 96530 32998]
 [15913 20097 42245]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.843025
{'0': {'precision': 0.46939475992525076, 'recall': 0.49409875551987154, 'f1-score': 0.4814300522188105, 'support': 24910}, '1': {'precision': 0.7459505972869002, 'recall': 0.6879911610463578, 'f1-score': 0.7157995288555725, 'support': 64261}, '2': {'precision': 0.44852388620504563, 'recall': 0.5165890450480155, 'f1-score': 0.48015629788538156, 'support': 24263}, 'accuracy': 0.6087504628241973, 'macro avg': {'precision': 0.5546230811390654, 'recall': 0.5662263205380816, 'f1-score': 0.5591286263199214, 'support': 113434}, 'weighted avg': {'precision': 0.6216010177987596, 'recall': 0.6087504628241973, 'f1-score': 0.6139292309197554, 'support': 113434}}
[[12308  7693  4909]
 [ 9548 44211 10502]
 [ 4365  7364 12534]]
training model: results/WBA/W10/deepVOL_L3/h30
Epoch 1/50
1230/1230 - 44s - loss: 3.2733 - accuracy30: 0.3998 - val_loss: 3.2076 - val_accuracy30: 0.2869 - 44s/epoch - 35ms/step
Epoch 2/50
1230/1230 - 41s - loss: 3.2218 - accuracy30: 0.4220 - val_loss: 3.0408 - val_accuracy30: 0.4870 - 41s/epoch - 34ms/step
Epoch 3/50
1230/1230 - 41s - loss: 3.1032 - accuracy30: 0.4717 - val_loss: 2.9493 - val_accuracy30: 0.5071 - 41s/epoch - 34ms/step
Epoch 4/50
1230/1230 - 41s - loss: 2.9403 - accuracy30: 0.5059 - val_loss: 2.8021 - val_accuracy30: 0.5500 - 41s/epoch - 33ms/step
Epoch 5/50
1230/1230 - 41s - loss: 2.8765 - accuracy30: 0.5236 - val_loss: 2.7619 - val_accuracy30: 0.5610 - 41s/epoch - 34ms/step
Epoch 6/50
1230/1230 - 41s - loss: 2.8367 - accuracy30: 0.5329 - val_loss: 2.7589 - val_accuracy30: 0.5632 - 41s/epoch - 33ms/step
Epoch 7/50
1230/1230 - 40s - loss: 2.8182 - accuracy30: 0.5372 - val_loss: 2.7413 - val_accuracy30: 0.5604 - 40s/epoch - 33ms/step
Epoch 8/50
1230/1230 - 40s - loss: 2.8089 - accuracy30: 0.5394 - val_loss: 2.7060 - val_accuracy30: 0.5706 - 40s/epoch - 33ms/step
Epoch 9/50
1230/1230 - 40s - loss: 2.7952 - accuracy30: 0.5425 - val_loss: 2.6960 - val_accuracy30: 0.5718 - 40s/epoch - 33ms/step
Epoch 10/50
1230/1230 - 40s - loss: 2.7865 - accuracy30: 0.5448 - val_loss: 2.6973 - val_accuracy30: 0.5650 - 40s/epoch - 33ms/step
Epoch 11/50
1230/1230 - 40s - loss: 2.7771 - accuracy30: 0.5468 - val_loss: 2.6737 - val_accuracy30: 0.5678 - 40s/epoch - 33ms/step
Epoch 12/50
1230/1230 - 40s - loss: 2.7693 - accuracy30: 0.5486 - val_loss: 2.6728 - val_accuracy30: 0.5708 - 40s/epoch - 33ms/step
Epoch 13/50
1230/1230 - 40s - loss: 2.7641 - accuracy30: 0.5493 - val_loss: 2.6778 - val_accuracy30: 0.5716 - 40s/epoch - 33ms/step
Epoch 14/50
1230/1230 - 40s - loss: 2.7573 - accuracy30: 0.5523 - val_loss: 2.6862 - val_accuracy30: 0.5663 - 40s/epoch - 33ms/step
Epoch 15/50
1230/1230 - 40s - loss: 2.7515 - accuracy30: 0.5525 - val_loss: 2.6851 - val_accuracy30: 0.5638 - 40s/epoch - 33ms/step
Epoch 16/50
1230/1230 - 40s - loss: 2.7451 - accuracy30: 0.5547 - val_loss: 2.6812 - val_accuracy30: 0.5678 - 40s/epoch - 32ms/step
Epoch 17/50
1230/1230 - 40s - loss: 2.7428 - accuracy30: 0.5547 - val_loss: 2.7008 - val_accuracy30: 0.5561 - 40s/epoch - 33ms/step
Epoch 18/50
1230/1230 - 40s - loss: 2.7376 - accuracy30: 0.5565 - val_loss: 2.6803 - val_accuracy30: 0.5615 - 40s/epoch - 33ms/step
Epoch 19/50
1230/1230 - 41s - loss: 2.7309 - accuracy30: 0.5577 - val_loss: 2.7002 - val_accuracy30: 0.5568 - 41s/epoch - 33ms/step
Epoch 20/50
1230/1230 - 40s - loss: 2.7280 - accuracy30: 0.5575 - val_loss: 2.6737 - val_accuracy30: 0.5650 - 40s/epoch - 33ms/step
Epoch 21/50
1230/1230 - 41s - loss: 2.7238 - accuracy30: 0.5592 - val_loss: 2.6847 - val_accuracy30: 0.5628 - 41s/epoch - 33ms/step
Epoch 22/50
1230/1230 - 40s - loss: 2.7203 - accuracy30: 0.5594 - val_loss: 2.6800 - val_accuracy30: 0.5650 - 40s/epoch - 33ms/step
testing model: results/WBA/W10/deepVOL_L3/h30
Evaluating performance on  test set...
6546/6546 - 86s - 86s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9567819
{'0': {'precision': 0.4962911395443743, 'recall': 0.31784707900383696, 'f1-score': 0.38751328815138714, 'support': 455307}, '1': {'precision': 0.6236361514674135, 'recall': 0.6380043055178884, 'f1-score': 0.6307384128495035, 'support': 770639}, '2': {'precision': 0.4358064104629928, 'recall': 0.5772114809602888, 'f1-score': 0.49663972517188704, 'support': 449823}, 'accuracy': 0.5346989949092029, 'macro avg': {'precision': 0.5185779004915935, 'recall': 0.5110209551606714, 'f1-score': 0.5049638087242593, 'support': 1675769}, 'weighted avg': {'precision': 0.5386177432432043, 'recall': 0.5346989949092029, 'f1-score': 0.5286582479591554, 'support': 1675769}}
[[144718 170999 139590]
 [ 82425 491671 196543]
 [ 64456 125724 259643]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95776844
{'0': {'precision': 0.5191138727542888, 'recall': 0.2982570902720802, 'f1-score': 0.37884730486216245, 'support': 90194}, '1': {'precision': 0.6101316991419057, 'recall': 0.6261653957732027, 'f1-score': 0.6180445759167644, 'support': 135469}, '2': {'precision': 0.43898482892188506, 'recall': 0.6104907583018169, 'f1-score': 0.5107239927333155, 'support': 89107}, 'accuracy': 0.5277694824792706, 'macro avg': {'precision': 0.5227434669393598, 'recall': 0.5116377481157, 'f1-score': 0.5025386245040808, 'support': 314770}, 'weighted avg': {'precision': 0.535602214127768, 'recall': 0.5277694824792706, 'f1-score': 0.5191241773043607, 'support': 314770}}
[[26901 30718 32575]
 [13697 84826 36946]
 [11223 23485 54399]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8983281
{'0': {'precision': 0.514602053915276, 'recall': 0.33662223155242993, 'f1-score': 0.4070055206548639, 'support': 28581}, '1': {'precision': 0.669776855393376, 'recall': 0.6865571925876437, 'f1-score': 0.6780632222328336, 'support': 56878}, '2': {'precision': 0.44136132839302866, 'recall': 0.574834673815907, 'f1-score': 0.49933240180096267, 'support': 27975}, 'accuracy': 0.5708341414390747, 'macro avg': {'precision': 0.5419134125672269, 'recall': 0.5326713659853269, 'f1-score': 0.5281337148962201, 'support': 113434}, 'weighted avg': {'precision': 0.5743471308938406, 'recall': 0.5708341414390747, 'f1-score': 0.565688670772235, 'support': 113434}}
[[ 9621 10863  8097]
 [ 5571 39050 12257]
 [ 3504  8390 16081]]
training model: results/WBA/W10/deepVOL_L3/h50
Epoch 1/50
1230/1230 - 45s - loss: 3.2786 - accuracy50: 0.3761 - val_loss: 3.3038 - val_accuracy50: 0.2997 - 45s/epoch - 36ms/step
Epoch 2/50
1230/1230 - 45s - loss: 3.2918 - accuracy50: 0.3555 - val_loss: 3.2994 - val_accuracy50: 0.3088 - 45s/epoch - 37ms/step
Epoch 3/50
1230/1230 - 42s - loss: 3.2345 - accuracy50: 0.4004 - val_loss: 3.1492 - val_accuracy50: 0.4497 - 42s/epoch - 34ms/step
Epoch 4/50
1230/1230 - 41s - loss: 3.1655 - accuracy50: 0.4358 - val_loss: 3.0959 - val_accuracy50: 0.4752 - 41s/epoch - 33ms/step
Epoch 5/50
1230/1230 - 41s - loss: 3.0546 - accuracy50: 0.4713 - val_loss: 3.0777 - val_accuracy50: 0.4638 - 41s/epoch - 33ms/step
Epoch 6/50
1230/1230 - 40s - loss: 2.9967 - accuracy50: 0.4868 - val_loss: 3.0542 - val_accuracy50: 0.4813 - 40s/epoch - 33ms/step
Epoch 7/50
1230/1230 - 41s - loss: 2.9660 - accuracy50: 0.4951 - val_loss: 3.0104 - val_accuracy50: 0.4953 - 41s/epoch - 33ms/step
Epoch 8/50
1230/1230 - 41s - loss: 2.9473 - accuracy50: 0.4994 - val_loss: 3.0261 - val_accuracy50: 0.4977 - 41s/epoch - 33ms/step
Epoch 9/50
1230/1230 - 40s - loss: 2.9281 - accuracy50: 0.5043 - val_loss: 3.0403 - val_accuracy50: 0.4978 - 40s/epoch - 33ms/step
Epoch 10/50
1230/1230 - 40s - loss: 2.9165 - accuracy50: 0.5073 - val_loss: 3.0274 - val_accuracy50: 0.4985 - 40s/epoch - 33ms/step
Epoch 11/50
1230/1230 - 44s - loss: 2.9053 - accuracy50: 0.5100 - val_loss: 2.9846 - val_accuracy50: 0.5062 - 44s/epoch - 36ms/step
Epoch 12/50
1230/1230 - 45s - loss: 2.9042 - accuracy50: 0.5107 - val_loss: 2.9671 - val_accuracy50: 0.5064 - 45s/epoch - 37ms/step
Epoch 13/50
1230/1230 - 43s - loss: 2.8898 - accuracy50: 0.5140 - val_loss: 2.9550 - val_accuracy50: 0.5051 - 43s/epoch - 35ms/step
Epoch 14/50
1230/1230 - 42s - loss: 2.8823 - accuracy50: 0.5160 - val_loss: 2.9241 - val_accuracy50: 0.5112 - 42s/epoch - 34ms/step
Epoch 15/50
1230/1230 - 43s - loss: 2.8763 - accuracy50: 0.5173 - val_loss: 2.9479 - val_accuracy50: 0.5063 - 43s/epoch - 35ms/step
Epoch 16/50
1230/1230 - 43s - loss: 2.8691 - accuracy50: 0.5195 - val_loss: 2.9256 - val_accuracy50: 0.5104 - 43s/epoch - 35ms/step
Epoch 17/50
1230/1230 - 43s - loss: 2.8675 - accuracy50: 0.5206 - val_loss: 2.9314 - val_accuracy50: 0.5058 - 43s/epoch - 35ms/step
Epoch 18/50
1230/1230 - 42s - loss: 2.8611 - accuracy50: 0.5219 - val_loss: 2.9382 - val_accuracy50: 0.5057 - 42s/epoch - 34ms/step
Epoch 19/50
1230/1230 - 45s - loss: 2.8579 - accuracy50: 0.5227 - val_loss: 2.9344 - val_accuracy50: 0.5093 - 45s/epoch - 37ms/step
Epoch 20/50
1230/1230 - 45s - loss: 2.8545 - accuracy50: 0.5239 - val_loss: 2.9519 - val_accuracy50: 0.5090 - 45s/epoch - 37ms/step
Epoch 21/50
1230/1230 - 45s - loss: 2.8507 - accuracy50: 0.5248 - val_loss: 2.9113 - val_accuracy50: 0.5128 - 45s/epoch - 37ms/step
Epoch 22/50
1230/1230 - 47s - loss: 2.8463 - accuracy50: 0.5255 - val_loss: 2.9232 - val_accuracy50: 0.5107 - 47s/epoch - 38ms/step
Epoch 23/50
1230/1230 - 46s - loss: 2.8444 - accuracy50: 0.5257 - val_loss: 2.9228 - val_accuracy50: 0.5135 - 46s/epoch - 37ms/step
Epoch 24/50
1230/1230 - 45s - loss: 2.8399 - accuracy50: 0.5274 - val_loss: 2.9228 - val_accuracy50: 0.5107 - 45s/epoch - 37ms/step
Epoch 25/50
1230/1230 - 47s - loss: 2.8377 - accuracy50: 0.5271 - val_loss: 2.9121 - val_accuracy50: 0.5139 - 47s/epoch - 38ms/step
Epoch 26/50
1230/1230 - 45s - loss: 2.8340 - accuracy50: 0.5287 - val_loss: 2.9122 - val_accuracy50: 0.5150 - 45s/epoch - 37ms/step
Epoch 27/50
1230/1230 - 47s - loss: 2.8309 - accuracy50: 0.5298 - val_loss: 2.9176 - val_accuracy50: 0.5113 - 47s/epoch - 38ms/step
Epoch 28/50
1230/1230 - 45s - loss: 2.8287 - accuracy50: 0.5306 - val_loss: 2.9298 - val_accuracy50: 0.5141 - 45s/epoch - 37ms/step
Epoch 29/50
1230/1230 - 45s - loss: 2.8263 - accuracy50: 0.5305 - val_loss: 2.9166 - val_accuracy50: 0.5144 - 45s/epoch - 37ms/step
Epoch 30/50
1230/1230 - 45s - loss: 2.8217 - accuracy50: 0.5321 - val_loss: 2.9157 - val_accuracy50: 0.5151 - 45s/epoch - 37ms/step
Epoch 31/50
1230/1230 - 45s - loss: 2.8188 - accuracy50: 0.5335 - val_loss: 2.9158 - val_accuracy50: 0.5150 - 45s/epoch - 37ms/step
testing model: results/WBA/W10/deepVOL_L3/h50
Evaluating performance on  test set...
6546/6546 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0128361
{'0': {'precision': 0.5281012587386497, 'recall': 0.21297372529105305, 'f1-score': 0.3035366051432025, 'support': 531690}, '1': {'precision': 0.5512585979211058, 'recall': 0.5472796239636318, 'f1-score': 0.5492619048964439, 'support': 621642}, '2': {'precision': 0.4293271799221268, 'recall': 0.6937391494094025, 'f1-score': 0.530406913356212, 'support': 522437}, 'accuracy': 0.48687080379216946, 'macro avg': {'precision': 0.5028956788606274, 'recall': 0.48466416622136244, 'f1-score': 0.4610684744652862, 'support': 1675769}, 'weighted avg': {'precision': 0.505897924764452, 'recall': 0.48687080379216946, 'f1-score': 0.4654196630116107, 'support': 1675769}}
[[113236 164330 254124]
 [ 53796 340212 227634]
 [ 47389 112613 362435]]
Evaluating performance on  train set...
1230/1230 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0078336
{'0': {'precision': 0.5365732222101959, 'recall': 0.236702381634485, 'f1-score': 0.328493900459205, 'support': 104718}, '1': {'precision': 0.5379876160990712, 'recall': 0.48668253745973955, 'f1-score': 0.5110506580398501, 'support': 107115}, '2': {'precision': 0.4339886413280909, 'recall': 0.7237922224273099, 'f1-score': 0.5426201331332936, 'support': 102937}, 'accuracy': 0.4810591860723703, 'macro avg': {'precision': 0.502849826545786, 'recall': 0.48239238050717814, 'f1-score': 0.46072156387744956, 'support': 314770}, 'weighted avg': {'precision': 0.5035070272079581, 'recall': 0.4810591860723703, 'f1-score': 0.4606414338995692, 'support': 314770}}
[[24787 26202 53729]
 [11543 52131 43441]
 [ 9865 18567 74505]]
Evaluating performance on  val set...
444/444 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97252506
{'0': {'precision': 0.5538783535231814, 'recall': 0.25854871658228973, 'f1-score': 0.35253512029710965, 'support': 33777}, '1': {'precision': 0.5842358980780067, 'recall': 0.5989858576349515, 'f1-score': 0.5915189418749605, 'support': 46739}, '2': {'precision': 0.4327209134035539, 'recall': 0.6539583206756182, 'f1-score': 0.5208187162799699, 'support': 32918}, 'accuracy': 0.5135673607560344, 'macro avg': {'precision': 0.5236117216682473, 'recall': 0.5038309649642865, 'f1-score': 0.48829092615068, 'support': 113434}, 'weighted avg': {'precision': 0.5312274786628228, 'recall': 0.5135673607560344, 'f1-score': 0.49984037488824606, 'support': 113434}}
[[ 8733 11492 13552]
 [ 4074 27996 14669]
 [ 2960  8431 21527]]
training model: results/WBA/W10/deepVOL_L3/h100
Epoch 1/50
1230/1230 - 45s - loss: 3.2917 - accuracy100: 0.3690 - val_loss: 3.2925 - val_accuracy100: 0.3716 - 45s/epoch - 37ms/step
Epoch 2/50
1230/1230 - 42s - loss: 3.2613 - accuracy100: 0.3793 - val_loss: 3.2737 - val_accuracy100: 0.3791 - 42s/epoch - 34ms/step
Epoch 3/50
1230/1230 - 45s - loss: 3.2347 - accuracy100: 0.3941 - val_loss: 3.2405 - val_accuracy100: 0.4003 - 45s/epoch - 37ms/step
Epoch 4/50
1230/1230 - 45s - loss: 3.2002 - accuracy100: 0.4145 - val_loss: 3.2145 - val_accuracy100: 0.4165 - 45s/epoch - 36ms/step
Epoch 5/50
1230/1230 - 40s - loss: 3.1754 - accuracy100: 0.4262 - val_loss: 3.1780 - val_accuracy100: 0.4286 - 40s/epoch - 33ms/step
Epoch 6/50
1230/1230 - 41s - loss: 3.1622 - accuracy100: 0.4333 - val_loss: 3.1861 - val_accuracy100: 0.4301 - 41s/epoch - 33ms/step
Epoch 7/50
1230/1230 - 41s - loss: 3.1541 - accuracy100: 0.4374 - val_loss: 3.1744 - val_accuracy100: 0.4314 - 41s/epoch - 34ms/step
Epoch 8/50
1230/1230 - 40s - loss: 3.1436 - accuracy100: 0.4406 - val_loss: 3.1855 - val_accuracy100: 0.4309 - 40s/epoch - 33ms/step
Epoch 9/50
1230/1230 - 40s - loss: 3.1362 - accuracy100: 0.4433 - val_loss: 3.2002 - val_accuracy100: 0.4310 - 40s/epoch - 33ms/step
Epoch 10/50
1230/1230 - 40s - loss: 3.1298 - accuracy100: 0.4461 - val_loss: 3.2022 - val_accuracy100: 0.4282 - 40s/epoch - 33ms/step
Epoch 11/50
1230/1230 - 41s - loss: 3.1230 - accuracy100: 0.4482 - val_loss: 3.1992 - val_accuracy100: 0.4276 - 41s/epoch - 33ms/step
Epoch 12/50
1230/1230 - 44s - loss: 3.1161 - accuracy100: 0.4505 - val_loss: 3.1960 - val_accuracy100: 0.4265 - 44s/epoch - 36ms/step
Epoch 13/50
1230/1230 - 44s - loss: 3.1093 - accuracy100: 0.4538 - val_loss: 3.1875 - val_accuracy100: 0.4277 - 44s/epoch - 36ms/step
Epoch 14/50
1230/1230 - 40s - loss: 3.1045 - accuracy100: 0.4551 - val_loss: 3.1987 - val_accuracy100: 0.4242 - 40s/epoch - 32ms/step
Epoch 15/50
1230/1230 - 40s - loss: 3.1003 - accuracy100: 0.4561 - val_loss: 3.2016 - val_accuracy100: 0.4252 - 40s/epoch - 33ms/step
Epoch 16/50
1230/1230 - 40s - loss: 3.0944 - accuracy100: 0.4586 - val_loss: 3.1901 - val_accuracy100: 0.4239 - 40s/epoch - 33ms/step
Epoch 17/50
1230/1230 - 42s - loss: 3.0899 - accuracy100: 0.4600 - val_loss: 3.2063 - val_accuracy100: 0.4213 - 42s/epoch - 34ms/step
testing model: results/WBA/W10/deepVOL_L3/h100
Evaluating performance on  test set...
6546/6546 - 89s - 89s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0652092
{'0': {'precision': 0.4322528626431322, 'recall': 0.2493402076723392, 'f1-score': 0.31625326967751377, 'support': 554720}, '1': {'precision': 0.465385642170663, 'recall': 0.39964049393007867, 'f1-score': 0.43001463225936665, 'support': 575790}, '2': {'precision': 0.39349638991474883, 'recall': 0.6216000102703486, 'f1-score': 0.48191947083597564, 'support': 545259}, 'accuracy': 0.42210829774270797, 'macro avg': {'precision': 0.43037829824284796, 'recall': 0.4235269039575888, 'f1-score': 0.40939579092428535, 'support': 1675769}, 'weighted avg': {'precision': 0.43102668383253917, 'recall': 0.42210829774270797, 'f1-score': 0.40924558672029643, 'support': 1675769}}
[[138314 149919 266487]
 [ 89764 230109 255917]
 [ 91906 114420 338933]]
Evaluating performance on  train set...
1230/1230 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0783964
{'0': {'precision': 0.4299551805092676, 'recall': 0.24290457817021593, 'f1-score': 0.3104304586699224, 'support': 107816}, '1': {'precision': 0.44225231682321725, 'recall': 0.34643722542897104, 'f1-score': 0.3885246535468299, 'support': 101522}, '2': {'precision': 0.39386343298992726, 'recall': 0.6512538887624251, 'f1-score': 0.49086372799931366, 'support': 105432}, 'accuracy': 0.4130730374559202, 'macro avg': {'precision': 0.42202364344080406, 'recall': 0.41353189745387064, 'f1-score': 0.396606280072022, 'support': 314770}, 'weighted avg': {'precision': 0.4218324392963366, 'recall': 0.4130730374559202, 'f1-score': 0.3960539911038576, 'support': 314770}}
[[26189 25856 55771]
 [16453 35171 49898]
 [18269 18500 68663]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0574558
{'0': {'precision': 0.43743099889598236, 'recall': 0.2520745740208011, 'f1-score': 0.3198385540054401, 'support': 36152}, '1': {'precision': 0.4823922585794094, 'recall': 0.4600418609076206, 'f1-score': 0.47095203311419526, 'support': 42044}, '2': {'precision': 0.3923054947147891, 'recall': 0.5845394176741018, 'f1-score': 0.4695075390629452, 'support': 35238}, 'accuracy': 0.43243648288872827, 'macro avg': {'precision': 0.43737625073006026, 'recall': 0.4322186175341745, 'f1-score': 0.4200993753941935, 'support': 113434}, 'weighted avg': {'precision': 0.4400776364631414, 'recall': 0.43243648288872827, 'f1-score': 0.42234266045592994, 'support': 113434}}
[[ 9113 11893 15146]
 [ 5941 19342 16761]
 [ 5779  8861 20598]]
training model: results/WBA/W10/deepVOL_L3/h200
Epoch 1/50
1230/1230 - 46s - loss: 3.3033 - accuracy200: 0.3603 - val_loss: 3.2847 - val_accuracy200: 0.3769 - 46s/epoch - 37ms/step
Epoch 2/50
1230/1230 - 47s - loss: 3.2908 - accuracy200: 0.3544 - val_loss: 3.2848 - val_accuracy200: 0.3734 - 47s/epoch - 38ms/step
Epoch 3/50
1230/1230 - 46s - loss: 3.2798 - accuracy200: 0.3691 - val_loss: 3.2854 - val_accuracy200: 0.3737 - 46s/epoch - 38ms/step
Epoch 4/50
1230/1230 - 46s - loss: 3.2719 - accuracy200: 0.3771 - val_loss: 3.2867 - val_accuracy200: 0.3768 - 46s/epoch - 38ms/step
Epoch 5/50
1230/1230 - 46s - loss: 3.2645 - accuracy200: 0.3810 - val_loss: 3.2922 - val_accuracy200: 0.3743 - 46s/epoch - 38ms/step
Epoch 6/50
1230/1230 - 46s - loss: 3.2560 - accuracy200: 0.3864 - val_loss: 3.2868 - val_accuracy200: 0.3757 - 46s/epoch - 37ms/step
Epoch 7/50
1230/1230 - 46s - loss: 3.2502 - accuracy200: 0.3888 - val_loss: 3.2888 - val_accuracy200: 0.3727 - 46s/epoch - 38ms/step
Epoch 8/50
1230/1230 - 46s - loss: 3.2466 - accuracy200: 0.3915 - val_loss: 3.2863 - val_accuracy200: 0.3746 - 46s/epoch - 37ms/step
Epoch 9/50
1230/1230 - 46s - loss: 3.2431 - accuracy200: 0.3941 - val_loss: 3.2872 - val_accuracy200: 0.3764 - 46s/epoch - 37ms/step
Epoch 10/50
1230/1230 - 47s - loss: 3.2365 - accuracy200: 0.3989 - val_loss: 3.3006 - val_accuracy200: 0.3760 - 47s/epoch - 38ms/step
Epoch 11/50
1230/1230 - 47s - loss: 3.2306 - accuracy200: 0.4022 - val_loss: 3.2976 - val_accuracy200: 0.3745 - 47s/epoch - 38ms/step
testing model: results/WBA/W10/deepVOL_L3/h200
Evaluating performance on  test set...
6546/6546 - 89s - 89s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0978488
{'0': {'precision': 0.33898803465200966, 'recall': 0.027581675770380294, 'f1-score': 0.05101271488599831, 'support': 543368}, '1': {'precision': 0.3602976616607029, 'recall': 0.9707343770731061, 'f1-score': 0.5255370509124848, 'support': 602960}, '2': {'precision': 0.326789016929862, 'recall': 0.004338538194057506, 'f1-score': 0.008563386582660726, 'support': 529441}, 'accuracy': 0.35959490836744207, 'macro avg': {'precision': 0.3420249044141915, 'recall': 0.33421819701251465, 'f1-score': 0.19503771746038132, 'support': 1675769}, 'weighted avg': {'precision': 0.34280132428759197, 'recall': 0.35959490836744207, 'f1-score': 0.2083403530176757, 'support': 1675769}}
[[ 14987 526074   2307]
 [ 15221 585314   2425]
 [ 14003 513141   2297]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1009337
{'0': {'precision': 0.35750214697583116, 'recall': 0.027508472496247556, 'f1-score': 0.0510860609035606, 'support': 105931}, '1': {'precision': 0.3396919668171106, 'recall': 0.9707389264070886, 'f1-score': 0.5032729568299907, 'support': 106763}, '2': {'precision': 0.3324572930354796, 'recall': 0.004957090795093852, 'f1-score': 0.009768528349968145, 'support': 102076}, 'accuracy': 0.3401181815293707, 'macro avg': {'precision': 0.3432171356094738, 'recall': 0.3344014965661433, 'f1-score': 0.18804251536117314, 'support': 314770}, 'weighted avg': {'precision': 0.3433395940797458, 'recall': 0.3401181815293707, 'f1-score': 0.19105906060763964, 'support': 314770}}
[[  2914 102496    521]
 [  2629 103639    495]
 [  2608  98962    506]]
Evaluating performance on  val set...
444/444 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0950403
{'0': {'precision': 0.32914828639294197, 'recall': 0.02694369600844421, 'f1-score': 0.04981000308103112, 'support': 36001}, '1': {'precision': 0.3781625589360175, 'recall': 0.9711865988521301, 'f1-score': 0.5443608235963359, 'support': 42862}, '2': {'precision': 0.32195121951219513, 'recall': 0.0038182291516010527, 'f1-score': 0.0075469540607758494, 'support': 34571}, 'accuracy': 0.37668600243313294, 'macro avg': {'precision': 0.3430873549470515, 'recall': 0.3339828413373918, 'f1-score': 0.20057259357938095, 'support': 113434}, 'weighted avg': {'precision': 0.3454753131274925, 'recall': 0.37668600243313294, 'f1-score': 0.22379982448596922, 'support': 113434}}
[[  970 34906   125]
 [ 1082 41627   153]
 [  895 33544   132]]
training model: results/WBA/W10/deepVOL_L3/h300
Epoch 1/50
1230/1230 - 45s - loss: 3.3050 - accuracy300: 0.3524 - val_loss: 3.3003 - val_accuracy300: 0.3444 - 45s/epoch - 36ms/step
Epoch 2/50
1230/1230 - 41s - loss: 3.2918 - accuracy300: 0.3522 - val_loss: 3.3090 - val_accuracy300: 0.3431 - 41s/epoch - 33ms/step
Epoch 3/50
1230/1230 - 46s - loss: 3.2870 - accuracy300: 0.3591 - val_loss: 3.3028 - val_accuracy300: 0.3490 - 46s/epoch - 37ms/step
Epoch 4/50
1230/1230 - 42s - loss: 3.2799 - accuracy300: 0.3708 - val_loss: 3.3006 - val_accuracy300: 0.3511 - 42s/epoch - 34ms/step
Epoch 5/50
1230/1230 - 43s - loss: 3.2737 - accuracy300: 0.3758 - val_loss: 3.2942 - val_accuracy300: 0.3591 - 43s/epoch - 35ms/step
Epoch 6/50
1230/1230 - 42s - loss: 3.2670 - accuracy300: 0.3832 - val_loss: 3.2961 - val_accuracy300: 0.3576 - 42s/epoch - 34ms/step
Epoch 7/50
1230/1230 - 45s - loss: 3.2605 - accuracy300: 0.3870 - val_loss: 3.3000 - val_accuracy300: 0.3609 - 45s/epoch - 36ms/step
Epoch 8/50
1230/1230 - 46s - loss: 3.2533 - accuracy300: 0.3926 - val_loss: 3.3112 - val_accuracy300: 0.3588 - 46s/epoch - 37ms/step
Epoch 9/50
1230/1230 - 41s - loss: 3.2509 - accuracy300: 0.3948 - val_loss: 3.3067 - val_accuracy300: 0.3601 - 41s/epoch - 33ms/step
Epoch 10/50
1230/1230 - 41s - loss: 3.2449 - accuracy300: 0.3977 - val_loss: 3.3183 - val_accuracy300: 0.3587 - 41s/epoch - 34ms/step
Epoch 11/50
1230/1230 - 41s - loss: 3.2404 - accuracy300: 0.4010 - val_loss: 3.3274 - val_accuracy300: 0.3570 - 41s/epoch - 33ms/step
Epoch 12/50
1230/1230 - 41s - loss: 3.2349 - accuracy300: 0.4049 - val_loss: 3.3362 - val_accuracy300: 0.3552 - 41s/epoch - 34ms/step
Epoch 13/50
1230/1230 - 40s - loss: 3.2300 - accuracy300: 0.4065 - val_loss: 3.3341 - val_accuracy300: 0.3546 - 40s/epoch - 33ms/step
Epoch 14/50
1230/1230 - 41s - loss: 3.2204 - accuracy300: 0.4133 - val_loss: 3.3452 - val_accuracy300: 0.3524 - 41s/epoch - 33ms/step
Epoch 15/50
1230/1230 - 41s - loss: 3.2137 - accuracy300: 0.4175 - val_loss: 3.3523 - val_accuracy300: 0.3553 - 41s/epoch - 33ms/step
testing model: results/WBA/W10/deepVOL_L3/h300
Evaluating performance on  test set...
6546/6546 - 88s - 88s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1028608
{'0': {'precision': 0.3723996154396874, 'recall': 0.25471321939992586, 'f1-score': 0.30251367754639147, 'support': 571796}, '1': {'precision': 0.3378240306105828, 'recall': 0.6236207213889097, 'f1-score': 0.43824476702118803, 'support': 548747}, '2': {'precision': 0.3628915307887666, 'recall': 0.17757453721547622, 'f1-score': 0.23846194776736698, 'support': 555226}, 'accuracy': 0.3499575418807723, 'macro avg': {'precision': 0.3577050589463456, 'recall': 0.3519694926681039, 'f1-score': 0.32640679744498213, 'support': 1675769}, 'weighted avg': {'precision': 0.3579272244021346, 'recall': 0.3499575418807723, 'f1-score': 0.32573814490301256, 'support': 1675769}}
[[145644 339682  86470]
 [119911 342210  86626]
 [125541 331091  98594]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1007264
{'0': {'precision': 0.39452234274411985, 'recall': 0.28464691820355037, 'f1-score': 0.33069685417700667, 'support': 110017}, '1': {'precision': 0.33009963585997365, 'recall': 0.5973641389486877, 'f1-score': 0.4252234752423605, 'support': 98943}, '2': {'precision': 0.37081343959106156, 'recall': 0.19744825630847745, 'f1-score': 0.2576857373682555, 'support': 105810}, 'accuracy': 0.3536328112590145, 'macro avg': {'precision': 0.36514513939838505, 'recall': 0.35981977115357183, 'f1-score': 0.3378686889292076, 'support': 314770}, 'weighted avg': {'precision': 0.3663023251761713, 'recall': 0.3536328112590145, 'f1-score': 0.335867109279257, 'support': 314770}}
[[31316 61321 17380]
 [21769 59105 18069]
 [26292 58626 20892]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0981284
{'0': {'precision': 0.3644015267673637, 'recall': 0.294102159031069, 'f1-score': 0.3254993953346058, 'support': 37980}, '1': {'precision': 0.3541541330766454, 'recall': 0.6024253588149513, 'f1-score': 0.4460715131423159, 'support': 39087}, '2': {'precision': 0.3685018105935064, 'recall': 0.16509472873759176, 'f1-score': 0.22802886441321682, 'support': 36367}, 'accuracy': 0.35898407884761185, 'macro avg': {'precision': 0.3623524901458384, 'recall': 0.35387408219453736, 'f1-score': 0.33319992429671286, 'support': 113434}, 'weighted avg': {'precision': 0.36218504092287457, 'recall': 0.35898407884761185, 'f1-score': 0.33579693902284574, 'support': 113434}}
[[11170 22119  4691]
 [ 9942 23547  5598]
 [ 9541 20822  6004]]
training model: results/WBA/W10/deepVOL_L3/h500
Epoch 1/50
1230/1230 - 45s - loss: 3.2822 - accuracy500: 0.3885 - val_loss: 3.3023 - val_accuracy500: 0.3407 - 45s/epoch - 36ms/step
Epoch 2/50
1230/1230 - 41s - loss: 3.2819 - accuracy500: 0.3779 - val_loss: 3.3017 - val_accuracy500: 0.3472 - 41s/epoch - 33ms/step
Epoch 3/50
1230/1230 - 41s - loss: 3.2844 - accuracy500: 0.3713 - val_loss: 3.3146 - val_accuracy500: 0.3445 - 41s/epoch - 33ms/step
Epoch 4/50
1230/1230 - 41s - loss: 3.2832 - accuracy500: 0.3751 - val_loss: 3.3091 - val_accuracy500: 0.3429 - 41s/epoch - 33ms/step
Epoch 5/50
1230/1230 - 42s - loss: 3.2819 - accuracy500: 0.3760 - val_loss: 3.3071 - val_accuracy500: 0.3426 - 42s/epoch - 34ms/step
Epoch 6/50
1230/1230 - 40s - loss: 3.2840 - accuracy500: 0.3721 - val_loss: 3.3124 - val_accuracy500: 0.3403 - 40s/epoch - 33ms/step
Epoch 7/50
1230/1230 - 41s - loss: 3.2779 - accuracy500: 0.3799 - val_loss: 3.3150 - val_accuracy500: 0.3449 - 41s/epoch - 33ms/step
Epoch 8/50
1230/1230 - 41s - loss: 3.2695 - accuracy500: 0.3880 - val_loss: 3.3246 - val_accuracy500: 0.3460 - 41s/epoch - 33ms/step
Epoch 9/50
1230/1230 - 41s - loss: 3.2618 - accuracy500: 0.3930 - val_loss: 3.3124 - val_accuracy500: 0.3470 - 41s/epoch - 34ms/step
Epoch 10/50
1230/1230 - 45s - loss: 3.2561 - accuracy500: 0.3962 - val_loss: 3.3179 - val_accuracy500: 0.3478 - 45s/epoch - 37ms/step
Epoch 11/50
1230/1230 - 46s - loss: 3.2538 - accuracy500: 0.3973 - val_loss: 3.3272 - val_accuracy500: 0.3460 - 46s/epoch - 38ms/step
Epoch 12/50
1230/1230 - 45s - loss: 3.2392 - accuracy500: 0.4055 - val_loss: 3.3361 - val_accuracy500: 0.3501 - 45s/epoch - 36ms/step
testing model: results/WBA/W10/deepVOL_L3/h500
Evaluating performance on  test set...
6546/6546 - 88s - 88s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0922841
{'0': {'precision': 0.3747087154988765, 'recall': 0.7238074086948685, 'f1-score': 0.4937878259723933, 'support': 621378}, '1': {'precision': 0.26093366093366094, 'recall': 0.0011942325987266016, 'f1-score': 0.0023775835512411794, 'support': 444637}, '2': {'precision': 0.36975838900658364, 'recall': 0.28710102762753503, 'f1-score': 0.3232290221297802, 'support': 609754}, 'accuracy': 0.37317195866494723, 'macro avg': {'precision': 0.33513358847970703, 'recall': 0.33736755630704335, 'f1-score': 0.2731314772178049, 'support': 1675769}, 'weighted avg': {'precision': 0.34271917498541954, 'recall': 0.37317195866494723, 'f1-score': 0.3013400071873087, 'support': 1675769}}
[[449758    723 170897]
 [316617    531 127489]
 [433912    781 175061]]
Evaluating performance on  train set...
1230/1230 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1000566
{'0': {'precision': 0.34847163535017533, 'recall': 0.7122604237490582, 'f1-score': 0.4679835072955466, 'support': 108838}, '1': {'precision': 0.35082872928176795, 'recall': 0.0012547547300301339, 'f1-score': 0.002500566073028343, 'support': 101215}, '2': {'precision': 0.33572236481489537, 'recall': 0.29478499193063207, 'f1-score': 0.3139246942770701, 'support': 104717}, 'accuracy': 0.34475013501922036, 'macro avg': {'precision': 0.34500757648227953, 'recall': 0.3361000568032401, 'f1-score': 0.261469589215215, 'support': 314770}, 'weighted avg': {'precision': 0.3449881645608473, 'recall': 0.34475013501922036, 'f1-score': 0.26705447143224015, 'support': 314770}}
[[77521   120 31197]
 [71206   127 29882]
 [73733   115 30869]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994034
{'0': {'precision': 0.35024753958835303, 'recall': 0.7279748853896751, 'f1-score': 0.4729477083451363, 'support': 40136}, '1': {'precision': 0.24, 'recall': 0.0010403120936280884, 'f1-score': 0.0020716443677168753, 'support': 34605}, '2': {'precision': 0.3344941901349496, 'recall': 0.258160390768356, 'f1-score': 0.29141140089853546, 'support': 38693}, 'accuracy': 0.3459544757303807, 'macro avg': {'precision': 0.3082472432411009, 'recall': 0.32905852941721975, 'f1-score': 0.25547691787046284, 'support': 113434}, 'weighted avg': {'precision': 0.3112410648289732, 'recall': 0.3459544757303807, 'f1-score': 0.26737574105164463, 'support': 113434}}
[[29218    65 10853]
 [25548    36  9021]
 [28655    49  9989]]
training model: results/WBA/W10/deepVOL_L3/h1000
Epoch 1/50
1230/1230 - 45s - loss: 3.2854 - accuracy1000: 0.3809 - val_loss: 3.2912 - val_accuracy1000: 0.3654 - 45s/epoch - 36ms/step
Epoch 2/50
1230/1230 - 40s - loss: 3.2828 - accuracy1000: 0.3724 - val_loss: 3.2951 - val_accuracy1000: 0.3695 - 40s/epoch - 33ms/step
Epoch 3/50
1230/1230 - 44s - loss: 3.2779 - accuracy1000: 0.3758 - val_loss: 3.3030 - val_accuracy1000: 0.3690 - 44s/epoch - 36ms/step
Epoch 4/50
1230/1230 - 45s - loss: 3.2601 - accuracy1000: 0.3903 - val_loss: 3.3058 - val_accuracy1000: 0.3770 - 45s/epoch - 36ms/step
Epoch 5/50
1230/1230 - 40s - loss: 3.2477 - accuracy1000: 0.3984 - val_loss: 3.3154 - val_accuracy1000: 0.3779 - 40s/epoch - 33ms/step
Epoch 6/50
1230/1230 - 41s - loss: 3.2452 - accuracy1000: 0.3979 - val_loss: 3.3361 - val_accuracy1000: 0.3763 - 41s/epoch - 33ms/step
Epoch 7/50
1230/1230 - 40s - loss: 3.2373 - accuracy1000: 0.4004 - val_loss: 3.3348 - val_accuracy1000: 0.3749 - 40s/epoch - 33ms/step
Epoch 8/50
1230/1230 - 40s - loss: 3.2282 - accuracy1000: 0.4066 - val_loss: 3.3251 - val_accuracy1000: 0.3778 - 40s/epoch - 33ms/step
Epoch 9/50
1230/1230 - 41s - loss: 3.2261 - accuracy1000: 0.4067 - val_loss: 3.3352 - val_accuracy1000: 0.3734 - 41s/epoch - 33ms/step
Epoch 10/50
1230/1230 - 41s - loss: 3.2170 - accuracy1000: 0.4105 - val_loss: 3.3292 - val_accuracy1000: 0.3761 - 41s/epoch - 33ms/step
Epoch 11/50
1230/1230 - 40s - loss: 3.2128 - accuracy1000: 0.4118 - val_loss: 3.3404 - val_accuracy1000: 0.3768 - 40s/epoch - 33ms/step
testing model: results/WBA/W10/deepVOL_L3/h1000
Evaluating performance on  test set...
6546/6546 - 92s - 92s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0956233
{'0': {'precision': 0.3718668651889248, 'recall': 0.27711992064075247, 'f1-score': 0.31757724015393296, 'support': 544360}, '1': {'precision': 0.37425188439138535, 'recall': 0.786942002611135, 'f1-score': 0.507261587716761, 'support': 602803}, '2': {'precision': 0.3138770776961732, 'recall': 0.001536115745943103, 'f1-score': 0.0030572692034721845, 'support': 528606}, 'accuracy': 0.37358132296277113, 'macro avg': {'precision': 0.3533319424254944, 'recall': 0.3551993463326102, 'f1-score': 0.2759653656913887, 'support': 1675769}, 'weighted avg': {'precision': 0.354432449778989, 'recall': 0.37358132296277113, 'f1-score': 0.2865975227821927, 'support': 1675769}}
[[150853 392655    852]
 [127509 474371    923]
 [127302 400492    812]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003932
{'0': {'precision': 0.3610312679647079, 'recall': 0.2712862361370658, 'f1-score': 0.30978998107309647, 'support': 106489}, '1': {'precision': 0.35155636376054367, 'recall': 0.7735884502306009, 'f1-score': 0.4834221146085553, 'support': 106461}, '2': {'precision': 0.32581967213114754, 'recall': 0.0015615792575132588, 'f1-score': 0.0031082613285373577, 'support': 101820}, 'accuracy': 0.3539250881596086, 'macro avg': {'precision': 0.346135767952133, 'recall': 0.3488120885417267, 'f1-score': 0.26544011900339637, 'support': 314770}, 'weighted avg': {'precision': 0.34643663548940007, 'recall': 0.3539250881596086, 'f1-score': 0.2693119109391176, 'support': 314770}}
[[28889 77435   165]
 [23940 82357   164]
 [27189 74472   159]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0967221
{'0': {'precision': 0.32204218693965375, 'recall': 0.27233127481252756, 'f1-score': 0.295107924415565, 'support': 36272}, '1': {'precision': 0.38028765829681105, 'recall': 0.7410002359046945, 'f1-score': 0.5026242519281852, 'support': 42390}, '2': {'precision': 0.31901840490797545, 'recall': 0.001495456114114805, 'f1-score': 0.0029769572062401605, 'support': 34772}, 'accuracy': 0.36444981222561135, 'macro avg': {'precision': 0.3404494167148134, 'recall': 0.3382756556104456, 'f1-score': 0.2669030445166634, 'support': 113434}, 'weighted avg': {'precision': 0.3428814642464963, 'recall': 0.36444981222561135, 'f1-score': 0.2831065767725067, 'support': 113434}}
[[ 9878 26350    44]
 [10912 31411    67]
 [ 9883 24837    52]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        25 (peak)  15.34 (ave)

============================================
