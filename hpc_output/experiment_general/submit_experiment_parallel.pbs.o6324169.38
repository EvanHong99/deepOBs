This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/ATVI_orderbooks/ATVI_orderbooks_2019-05-22.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-05-14.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-05-01.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-05-02.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-05-10.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-05-06.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-05-08.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-05-03.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-05-24.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-05-07.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-05-20.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-05-09.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-04-30.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-05-16.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-05-15.csv
training model: results/ATVI/W3/deepLOB_L1/h10
Epoch 1/50
2440/2440 - 67s - loss: 3.0049 - accuracy10: 0.4655 - val_loss: 3.0089 - val_accuracy10: 0.5316 - 67s/epoch - 27ms/step
Epoch 2/50
2440/2440 - 55s - loss: 2.9716 - accuracy10: 0.4617 - val_loss: 2.9024 - val_accuracy10: 0.5791 - 55s/epoch - 23ms/step
Epoch 3/50
2440/2440 - 56s - loss: 2.9193 - accuracy10: 0.4845 - val_loss: 2.8682 - val_accuracy10: 0.5889 - 56s/epoch - 23ms/step
Epoch 4/50
2440/2440 - 57s - loss: 2.8594 - accuracy10: 0.5141 - val_loss: 2.7970 - val_accuracy10: 0.5684 - 57s/epoch - 23ms/step
Epoch 5/50
2440/2440 - 56s - loss: 2.8228 - accuracy10: 0.5250 - val_loss: 2.7789 - val_accuracy10: 0.5705 - 56s/epoch - 23ms/step
Epoch 6/50
2440/2440 - 56s - loss: 2.7963 - accuracy10: 0.5351 - val_loss: 2.7092 - val_accuracy10: 0.5617 - 56s/epoch - 23ms/step
Epoch 7/50
2440/2440 - 57s - loss: 2.7788 - accuracy10: 0.5411 - val_loss: 2.6893 - val_accuracy10: 0.5562 - 57s/epoch - 23ms/step
Epoch 8/50
2440/2440 - 57s - loss: 2.7619 - accuracy10: 0.5467 - val_loss: 2.6545 - val_accuracy10: 0.5693 - 57s/epoch - 23ms/step
Epoch 9/50
2440/2440 - 57s - loss: 2.7495 - accuracy10: 0.5495 - val_loss: 2.6289 - val_accuracy10: 0.5671 - 57s/epoch - 23ms/step
Epoch 10/50
2440/2440 - 57s - loss: 2.7387 - accuracy10: 0.5527 - val_loss: 2.6100 - val_accuracy10: 0.5658 - 57s/epoch - 23ms/step
Epoch 11/50
2440/2440 - 56s - loss: 2.7278 - accuracy10: 0.5548 - val_loss: 2.6118 - val_accuracy10: 0.5427 - 56s/epoch - 23ms/step
Epoch 12/50
2440/2440 - 57s - loss: 2.7186 - accuracy10: 0.5570 - val_loss: 2.6316 - val_accuracy10: 0.5572 - 57s/epoch - 24ms/step
Epoch 13/50
2440/2440 - 56s - loss: 2.7098 - accuracy10: 0.5594 - val_loss: 2.6321 - val_accuracy10: 0.5625 - 56s/epoch - 23ms/step
Epoch 14/50
2440/2440 - 56s - loss: 2.7027 - accuracy10: 0.5610 - val_loss: 2.6474 - val_accuracy10: 0.5655 - 56s/epoch - 23ms/step
Epoch 15/50
2440/2440 - 55s - loss: 2.6960 - accuracy10: 0.5618 - val_loss: 2.6465 - val_accuracy10: 0.5661 - 55s/epoch - 23ms/step
Epoch 16/50
2440/2440 - 55s - loss: 2.6914 - accuracy10: 0.5631 - val_loss: 2.6292 - val_accuracy10: 0.5784 - 55s/epoch - 23ms/step
Epoch 17/50
2440/2440 - 56s - loss: 2.6843 - accuracy10: 0.5643 - val_loss: 2.6551 - val_accuracy10: 0.5648 - 56s/epoch - 23ms/step
Epoch 18/50
2440/2440 - 56s - loss: 2.6804 - accuracy10: 0.5651 - val_loss: 2.6638 - val_accuracy10: 0.5705 - 56s/epoch - 23ms/step
Epoch 19/50
2440/2440 - 55s - loss: 2.6756 - accuracy10: 0.5660 - val_loss: 2.6542 - val_accuracy10: 0.5708 - 55s/epoch - 23ms/step
Epoch 20/50
2440/2440 - 55s - loss: 2.6718 - accuracy10: 0.5672 - val_loss: 2.6692 - val_accuracy10: 0.5715 - 55s/epoch - 23ms/step
testing model: results/ATVI/W3/deepLOB_L1/h10
Evaluating performance on  test set...
6082/6082 - 79s - 79s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8469305
{'0': {'precision': 0.4130140449896416, 'recall': 0.45850144509717283, 'f1-score': 0.43457067287310275, 'support': 276106}, '1': {'precision': 0.7911412026316897, 'recall': 0.6165254237288136, 'f1-score': 0.6930030961136259, 'support': 1005832}, '2': {'precision': 0.3551959661963135, 'recall': 0.602780991464932, 'f1-score': 0.4469948362659242, 'support': 274866}, 'accuracy': 0.5860724921056215, 'macro avg': {'precision': 0.519783737939215, 'recall': 0.5592692867636395, 'f1-score': 0.5248562017508843, 'support': 1556804}, 'weighted avg': {'precision': 0.6471091341465359, 'recall': 0.5860724921056215, 'f1-score': 0.6037342806413208, 'support': 1556804}}
[[126595  86430  63081]
 [148018 620121 237693]
 [ 31902  77280 165684]]
Evaluating performance on  train set...
2440/2440 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9334288
{'0': {'precision': 0.44194268701153705, 'recall': 0.4139938641751499, 'f1-score': 0.4275119703351693, 'support': 143420}, '1': {'precision': 0.6786042392865316, 'recall': 0.605698553899439, 'f1-score': 0.640082087474465, 'support': 337805}, '2': {'precision': 0.4024077488819652, 'recall': 0.5297359132824598, 'f1-score': 0.4573754991176984, 'support': 143362}, 'accuracy': 0.544242835665808, 'macro avg': {'precision': 0.5076515583933445, 'recall': 0.5164761104523495, 'f1-score': 0.5083231856424443, 'support': 624587}, 'weighted avg': {'precision': 0.5608655077973088, 'recall': 0.544242835665808, 'f1-score': 0.5493341402387387, 'support': 624587}}
[[ 59375  49453  34592]
 [ 55009 204608  78188]
 [ 19966  47452  75944]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8753742
{'0': {'precision': 0.40951137976828317, 'recall': 0.44785276073619634, 'f1-score': 0.42782475570811757, 'support': 39935}, '1': {'precision': 0.7619176729188252, 'recall': 0.5944920856786672, 'f1-score': 0.6678719665911232, 'support': 132355}, '2': {'precision': 0.3568759400244988, 'recall': 0.5879227546745683, 'f1-score': 0.4441485512490231, 'support': 39148}, 'accuracy': 0.5655795079408621, 'macro avg': {'precision': 0.5094349975705357, 'recall': 0.5434225336964773, 'f1-score': 0.5132817578494213, 'support': 211438}, 'weighted avg': {'precision': 0.6203635574035726, 'recall': 0.5655795079408621, 'f1-score': 0.5811107901213053, 'support': 211438}}
[[17885 12859  9191]
 [21385 78684 32286]
 [ 4404 11728 23016]]
training model: results/ATVI/W3/deepLOB_L1/h20
Epoch 1/50
2440/2440 - 57s - loss: 3.0666 - accuracy20: 0.4655 - val_loss: 3.2580 - val_accuracy20: 0.4980 - 57s/epoch - 23ms/step
Epoch 2/50
2440/2440 - 54s - loss: 3.0745 - accuracy20: 0.4542 - val_loss: 3.1228 - val_accuracy20: 0.4731 - 54s/epoch - 22ms/step
Epoch 3/50
2440/2440 - 55s - loss: 3.0314 - accuracy20: 0.4713 - val_loss: 3.0312 - val_accuracy20: 0.4873 - 55s/epoch - 22ms/step
Epoch 4/50
2440/2440 - 55s - loss: 2.9736 - accuracy20: 0.4935 - val_loss: 2.9122 - val_accuracy20: 0.5148 - 55s/epoch - 22ms/step
Epoch 5/50
2440/2440 - 54s - loss: 2.9208 - accuracy20: 0.5141 - val_loss: 2.8912 - val_accuracy20: 0.5258 - 54s/epoch - 22ms/step
Epoch 6/50
2440/2440 - 55s - loss: 2.8938 - accuracy20: 0.5233 - val_loss: 2.8758 - val_accuracy20: 0.5273 - 55s/epoch - 23ms/step
Epoch 7/50
2440/2440 - 55s - loss: 2.8730 - accuracy20: 0.5305 - val_loss: 2.8525 - val_accuracy20: 0.5459 - 55s/epoch - 22ms/step
Epoch 8/50
2440/2440 - 55s - loss: 2.8642 - accuracy20: 0.5334 - val_loss: 2.8431 - val_accuracy20: 0.5399 - 55s/epoch - 23ms/step
Epoch 9/50
2440/2440 - 55s - loss: 2.8522 - accuracy20: 0.5367 - val_loss: 2.8349 - val_accuracy20: 0.5506 - 55s/epoch - 22ms/step
Epoch 10/50
2440/2440 - 55s - loss: 2.8394 - accuracy20: 0.5405 - val_loss: 2.8199 - val_accuracy20: 0.5552 - 55s/epoch - 23ms/step
Epoch 11/50
2440/2440 - 54s - loss: 2.8312 - accuracy20: 0.5423 - val_loss: 2.8219 - val_accuracy20: 0.5509 - 54s/epoch - 22ms/step
Epoch 12/50
2440/2440 - 54s - loss: 2.8236 - accuracy20: 0.5441 - val_loss: 2.8037 - val_accuracy20: 0.5513 - 54s/epoch - 22ms/step
Epoch 13/50
2440/2440 - 55s - loss: 2.8160 - accuracy20: 0.5459 - val_loss: 2.8161 - val_accuracy20: 0.5570 - 55s/epoch - 23ms/step
Epoch 14/50
2440/2440 - 55s - loss: 2.8096 - accuracy20: 0.5476 - val_loss: 2.8001 - val_accuracy20: 0.5597 - 55s/epoch - 23ms/step
Epoch 15/50
2440/2440 - 54s - loss: 2.8019 - accuracy20: 0.5487 - val_loss: 2.8036 - val_accuracy20: 0.5614 - 54s/epoch - 22ms/step
Epoch 16/50
2440/2440 - 55s - loss: 2.7965 - accuracy20: 0.5499 - val_loss: 2.8083 - val_accuracy20: 0.5568 - 55s/epoch - 23ms/step
Epoch 17/50
2440/2440 - 54s - loss: 2.7907 - accuracy20: 0.5511 - val_loss: 2.8028 - val_accuracy20: 0.5594 - 54s/epoch - 22ms/step
Epoch 18/50
2440/2440 - 55s - loss: 2.7862 - accuracy20: 0.5520 - val_loss: 2.7998 - val_accuracy20: 0.5588 - 55s/epoch - 23ms/step
Epoch 19/50
2440/2440 - 55s - loss: 2.7814 - accuracy20: 0.5534 - val_loss: 2.7873 - val_accuracy20: 0.5627 - 55s/epoch - 22ms/step
Epoch 20/50
2440/2440 - 55s - loss: 2.7775 - accuracy20: 0.5539 - val_loss: 2.8077 - val_accuracy20: 0.5582 - 55s/epoch - 22ms/step
Epoch 21/50
2440/2440 - 54s - loss: 2.7736 - accuracy20: 0.5543 - val_loss: 2.8063 - val_accuracy20: 0.5553 - 54s/epoch - 22ms/step
Epoch 22/50
2440/2440 - 54s - loss: 2.7702 - accuracy20: 0.5557 - val_loss: 2.8013 - val_accuracy20: 0.5541 - 54s/epoch - 22ms/step
Epoch 23/50
2440/2440 - 55s - loss: 2.7663 - accuracy20: 0.5562 - val_loss: 2.7909 - val_accuracy20: 0.5601 - 55s/epoch - 23ms/step
Epoch 24/50
2440/2440 - 55s - loss: 2.7627 - accuracy20: 0.5570 - val_loss: 2.7990 - val_accuracy20: 0.5531 - 55s/epoch - 23ms/step
Epoch 25/50
2440/2440 - 55s - loss: 2.7597 - accuracy20: 0.5574 - val_loss: 2.8044 - val_accuracy20: 0.5533 - 55s/epoch - 23ms/step
Epoch 26/50
2440/2440 - 54s - loss: 2.7561 - accuracy20: 0.5579 - val_loss: 2.8124 - val_accuracy20: 0.5513 - 54s/epoch - 22ms/step
Epoch 27/50
2440/2440 - 55s - loss: 2.7542 - accuracy20: 0.5584 - val_loss: 2.8030 - val_accuracy20: 0.5499 - 55s/epoch - 23ms/step
Epoch 28/50
2440/2440 - 55s - loss: 2.7511 - accuracy20: 0.5588 - val_loss: 2.7950 - val_accuracy20: 0.5523 - 55s/epoch - 23ms/step
Epoch 29/50
2440/2440 - 55s - loss: 2.7487 - accuracy20: 0.5595 - val_loss: 2.8017 - val_accuracy20: 0.5482 - 55s/epoch - 23ms/step
testing model: results/ATVI/W3/deepLOB_L1/h20
Evaluating performance on  test set...
6082/6082 - 78s - 78s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8855568
{'0': {'precision': 0.4834369053032217, 'recall': 0.40206058500893593, 'f1-score': 0.4390095445501552, 'support': 356986}, '1': {'precision': 0.6903852135979641, 'recall': 0.6662951388560568, 'f1-score': 0.6781262969222719, 'support': 846056}, '2': {'precision': 0.4198973780659712, 'recall': 0.5262634200394616, 'f1-score': 0.467101639994129, 'support': 353762}, 'accuracy': 0.5738840599073487, 'macro avg': {'precision': 0.5312398323223856, 'recall': 0.5315397146348181, 'f1-score': 0.5280791604888521, 'support': 1556804}, 'weighted avg': {'precision': 0.5814659363746426, 'recall': 0.5738840599073487, 'f1-score': 0.5753427495736485, 'support': 1556804}}
[[143530 133078  80378]
 [105508 563723 176825]
 [ 47857 119733 186172]]
Evaluating performance on  train set...
2440/2440 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9916506
{'0': {'precision': 0.5097772974570713, 'recall': 0.30740480805650244, 'f1-score': 0.38353260850680876, 'support': 179532}, '1': {'precision': 0.5437345559558189, 'recall': 0.6872048614377363, 'f1-score': 0.6071087250999327, 'support': 265765}, '2': {'precision': 0.4618867631736461, 'recall': 0.4648390875118523, 'f1-score': 0.4633582226472371, 'support': 179290}, 'accuracy': 0.5142037858616975, 'macro avg': {'precision': 0.5051328721955121, 'recall': 0.4864829190020304, 'f1-score': 0.48466651875132616, 'support': 624587}, 'weighted avg': {'precision': 0.5104791322907203, 'recall': 0.5142037858616975, 'f1-score': 0.5015796395619044, 'support': 624587}}
[[ 55189  81323  43020]
 [ 29055 182635  54075]
 [ 24017  71932  83341]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9107253
{'0': {'precision': 0.5114785073216817, 'recall': 0.3130263842580993, 'f1-score': 0.3883694794481241, 'support': 51887}, '1': {'precision': 0.629474106784424, 'recall': 0.721871317030053, 'f1-score': 0.6725139176009401, 'support': 108608}, '2': {'precision': 0.4396096711588341, 'recall': 0.4757670337435958, 'f1-score': 0.45697424488102867, 'support': 50943}, 'accuracy': 0.5622451971736395, 'macro avg': {'precision': 0.5268540950883133, 'recall': 0.5035549116772494, 'f1-score': 0.5059525473100309, 'support': 211438}, 'weighted avg': {'precision': 0.5547727682672334, 'recall': 0.5622451971736395, 'f1-score': 0.5508534780876757, 'support': 211438}}
[[16242 25030 10615]
 [ 9926 78401 20281]
 [ 5587 21119 24237]]
training model: results/ATVI/W3/deepLOB_L1/h30
Epoch 1/50
2440/2440 - 58s - loss: 3.1022 - accuracy30: 0.4588 - val_loss: 3.5298 - val_accuracy30: 0.3413 - 58s/epoch - 24ms/step
Epoch 2/50
2440/2440 - 54s - loss: 3.1117 - accuracy30: 0.4562 - val_loss: 3.1971 - val_accuracy30: 0.4253 - 54s/epoch - 22ms/step
Epoch 3/50
2440/2440 - 55s - loss: 3.1024 - accuracy30: 0.4582 - val_loss: 3.2204 - val_accuracy30: 0.3907 - 55s/epoch - 23ms/step
Epoch 4/50
2440/2440 - 54s - loss: 3.0773 - accuracy30: 0.4692 - val_loss: 3.3114 - val_accuracy30: 0.3574 - 54s/epoch - 22ms/step
Epoch 5/50
2440/2440 - 57s - loss: 3.0377 - accuracy30: 0.4813 - val_loss: 3.1938 - val_accuracy30: 0.4386 - 57s/epoch - 23ms/step
Epoch 6/50
2440/2440 - 57s - loss: 2.9898 - accuracy30: 0.5000 - val_loss: 3.1307 - val_accuracy30: 0.4432 - 57s/epoch - 23ms/step
Epoch 7/50
2440/2440 - 56s - loss: 2.9590 - accuracy30: 0.5091 - val_loss: 3.1251 - val_accuracy30: 0.4542 - 56s/epoch - 23ms/step
Epoch 8/50
2440/2440 - 57s - loss: 2.9371 - accuracy30: 0.5152 - val_loss: 3.1274 - val_accuracy30: 0.4655 - 57s/epoch - 23ms/step
Epoch 9/50
2440/2440 - 57s - loss: 2.9208 - accuracy30: 0.5188 - val_loss: 3.0555 - val_accuracy30: 0.4818 - 57s/epoch - 23ms/step
Epoch 10/50
2440/2440 - 58s - loss: 2.9078 - accuracy30: 0.5215 - val_loss: 3.0424 - val_accuracy30: 0.4857 - 58s/epoch - 24ms/step
Epoch 11/50
2440/2440 - 56s - loss: 2.8987 - accuracy30: 0.5237 - val_loss: 3.0811 - val_accuracy30: 0.4831 - 56s/epoch - 23ms/step
Epoch 12/50
2440/2440 - 55s - loss: 2.8900 - accuracy30: 0.5250 - val_loss: 3.0803 - val_accuracy30: 0.4798 - 55s/epoch - 23ms/step
Epoch 13/50
2440/2440 - 58s - loss: 2.8831 - accuracy30: 0.5269 - val_loss: 3.1035 - val_accuracy30: 0.4825 - 58s/epoch - 24ms/step
Epoch 14/50
2440/2440 - 55s - loss: 2.8772 - accuracy30: 0.5282 - val_loss: 3.1080 - val_accuracy30: 0.4780 - 55s/epoch - 23ms/step
Epoch 15/50
2440/2440 - 54s - loss: 2.8708 - accuracy30: 0.5293 - val_loss: 3.0970 - val_accuracy30: 0.4796 - 54s/epoch - 22ms/step
Epoch 16/50
2440/2440 - 55s - loss: 2.8663 - accuracy30: 0.5301 - val_loss: 3.0649 - val_accuracy30: 0.4862 - 55s/epoch - 22ms/step
Epoch 17/50
2440/2440 - 54s - loss: 2.8613 - accuracy30: 0.5312 - val_loss: 3.1150 - val_accuracy30: 0.4791 - 54s/epoch - 22ms/step
Epoch 18/50
2440/2440 - 55s - loss: 2.8564 - accuracy30: 0.5318 - val_loss: 3.1119 - val_accuracy30: 0.4810 - 55s/epoch - 22ms/step
Epoch 19/50
2440/2440 - 54s - loss: 2.8522 - accuracy30: 0.5335 - val_loss: 3.1448 - val_accuracy30: 0.4770 - 54s/epoch - 22ms/step
Epoch 20/50
2440/2440 - 55s - loss: 2.8491 - accuracy30: 0.5340 - val_loss: 3.1280 - val_accuracy30: 0.4805 - 55s/epoch - 22ms/step
testing model: results/ATVI/W3/deepLOB_L1/h30
Evaluating performance on  test set...
6082/6082 - 78s - 78s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96426284
{'0': {'precision': 0.5591305091754238, 'recall': 0.19060245121746716, 'f1-score': 0.2842922779957769, 'support': 411469}, '1': {'precision': 0.5225301710834082, 'recall': 0.8634371901173039, 'f1-score': 0.6510571537282177, 'support': 739191}, '2': {'precision': 0.4860805691819547, 'recall': 0.23348369051370943, 'f1-score': 0.31544614299661855, 'support': 406144}, 'accuracy': 0.5212602228668477, 'macro avg': {'precision': 0.5225804164802622, 'recall': 0.4291744439494935, 'f1-score': 0.41693185824020434, 'support': 1556804}, 'weighted avg': {'precision': 0.5226946859482977, 'recall': 0.5212602228668477, 'f1-score': 0.4665645811273468, 'support': 1556804}}
[[ 78427 291470  41572]
 [ 42259 638245  58687]
 [ 19580 291736  94828]]
Evaluating performance on  train set...
2440/2440 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0922629
{'0': {'precision': 0.5784652176428613, 'recall': 0.14867061879176002, 'f1-score': 0.2365466740799451, 'support': 201748}, '1': {'precision': 0.3929731883551937, 'recall': 0.8643815874478764, 'f1-score': 0.5403069919672647, 'support': 221349}, '2': {'precision': 0.49819469356379137, 'recall': 0.21228845103975383, 'f1-score': 0.297715661845567, 'support': 201490}, 'accuracy': 0.4228362101676788, 'macro avg': {'precision': 0.48987769985394874, 'recall': 0.40844688575979676, 'f1-score': 0.35818977596425894, 'support': 624587}, 'weighted avg': {'precision': 0.486833174248606, 'recall': 0.4228362101676788, 'f1-score': 0.36393002011330067, 'support': 624587}}
[[ 29994 147211  24543]
 [ 11478 191330  18541]
 [ 10379 148337  42774]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0067837
{'0': {'precision': 0.5838663603055332, 'recall': 0.15670783539176958, 'f1-score': 0.24709592641261496, 'support': 59997}, '1': {'precision': 0.48235577576513905, 'recall': 0.8418731534795454, 'f1-score': 0.6133114434738892, 'support': 92742}, '2': {'precision': 0.450267411634647, 'recall': 0.2567335048297245, 'f1-score': 0.3270115441367937, 'support': 58699}, 'accuracy': 0.48500742534454544, 'macro avg': {'precision': 0.5054965159017731, 'recall': 0.41843816456701316, 'f1-score': 0.3958063046744327, 'support': 211438}, 'weighted avg': {'precision': 0.50225180038973, 'recall': 0.48500742534454544, 'f1-score': 0.42991323611138377, 'support': 211438}}
[[ 9402 42281  8314]
 [ 4580 78077 10085]
 [ 2121 41508 15070]]
training model: results/ATVI/W3/deepLOB_L1/h50
Epoch 1/50
2440/2440 - 57s - loss: 3.1600 - accuracy50: 0.4347 - val_loss: 3.3331 - val_accuracy50: 0.3565 - 57s/epoch - 23ms/step
Epoch 2/50
2440/2440 - 55s - loss: 3.1608 - accuracy50: 0.4358 - val_loss: 3.2232 - val_accuracy50: 0.3924 - 55s/epoch - 23ms/step
Epoch 3/50
2440/2440 - 54s - loss: 3.1485 - accuracy50: 0.4357 - val_loss: 3.2150 - val_accuracy50: 0.3993 - 54s/epoch - 22ms/step
Epoch 4/50
2440/2440 - 55s - loss: 3.1056 - accuracy50: 0.4600 - val_loss: 3.2916 - val_accuracy50: 0.4067 - 55s/epoch - 22ms/step
Epoch 5/50
2440/2440 - 55s - loss: 3.0819 - accuracy50: 0.4694 - val_loss: 3.2975 - val_accuracy50: 0.4244 - 55s/epoch - 22ms/step
Epoch 6/50
2440/2440 - 54s - loss: 3.0629 - accuracy50: 0.4754 - val_loss: 3.3014 - val_accuracy50: 0.4293 - 54s/epoch - 22ms/step
Epoch 7/50
2440/2440 - 55s - loss: 3.0494 - accuracy50: 0.4791 - val_loss: 3.3635 - val_accuracy50: 0.4234 - 55s/epoch - 22ms/step
Epoch 8/50
2440/2440 - 54s - loss: 3.0382 - accuracy50: 0.4824 - val_loss: 3.3161 - val_accuracy50: 0.4192 - 54s/epoch - 22ms/step
Epoch 9/50
2440/2440 - 55s - loss: 3.0300 - accuracy50: 0.4844 - val_loss: 3.3615 - val_accuracy50: 0.4207 - 55s/epoch - 23ms/step
Epoch 10/50
2440/2440 - 54s - loss: 3.0241 - accuracy50: 0.4861 - val_loss: 3.3374 - val_accuracy50: 0.4271 - 54s/epoch - 22ms/step
Epoch 11/50
2440/2440 - 55s - loss: 3.0184 - accuracy50: 0.4884 - val_loss: 3.3375 - val_accuracy50: 0.4245 - 55s/epoch - 22ms/step
Epoch 12/50
2440/2440 - 54s - loss: 3.0136 - accuracy50: 0.4892 - val_loss: 3.3231 - val_accuracy50: 0.4212 - 54s/epoch - 22ms/step
Epoch 13/50
2440/2440 - 55s - loss: 3.0077 - accuracy50: 0.4899 - val_loss: 3.3584 - val_accuracy50: 0.4143 - 55s/epoch - 23ms/step
testing model: results/ATVI/W3/deepLOB_L1/h50
Evaluating performance on  test set...
6082/6082 - 78s - 78s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.033326
{'0': {'precision': 0.47576724772894674, 'recall': 0.08877730768085433, 'f1-score': 0.14963331036093688, 'support': 436553}, '1': {'precision': 0.44917533082748673, 'recall': 0.847310499702862, 'f1-score': 0.5871116599275894, 'support': 684867}, '2': {'precision': 0.43741550002180646, 'recall': 0.18428789298642118, 'f1-score': 0.2593210259592512, 'support': 435384}, 'accuracy': 0.44918114290559374, 'macro avg': {'precision': 0.45411935952607996, 'recall': 0.37345856679004585, 'f1-score': 0.33202199874925914, 'support': 1556804}, 'weighted avg': {'precision': 0.45334331788531984, 'recall': 0.44918114290559374, 'f1-score': 0.37276400709650614, 'support': 1556804}}
[[ 38756 367334  30463]
 [ 31839 580295  72733]
 [ 10865 344283  80236]]
Evaluating performance on  train set...
2440/2440 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1069707
{'0': {'precision': 0.48201124391457034, 'recall': 0.152884877400479, 'f1-score': 0.2321394869412465, 'support': 209177}, '1': {'precision': 0.34474986707017374, 'recall': 0.6310778811372012, 'f1-score': 0.44590659782456216, 'support': 206507}, '2': {'precision': 0.41476298544564727, 'recall': 0.35781678578096054, 'f1-score': 0.38419115757444927, 'support': 208903}, 'accuracy': 0.3795323950066204, 'macro avg': {'precision': 0.4138413654767971, 'recall': 0.38059318143954696, 'f1-score': 0.354079080780086, 'support': 624587}, 'weighted avg': {'precision': 0.4141363152225879, 'recall': 0.3795323950066204, 'f1-score': 0.35367332436896887, 'support': 624587}}
[[ 31980 127561  49636]
 [ 20349 130322  55836]
 [ 14018 120136  74749]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0719168
{'0': {'precision': 0.46341984863385643, 'recall': 0.16685911351284774, 'f1-score': 0.24537016074258544, 'support': 64953}, '1': {'precision': 0.4037671032993421, 'recall': 0.5786165776487316, 'f1-score': 0.47563155620162656, 'support': 83691}, '2': {'precision': 0.3702985994891218, 'recall': 0.4016944294040832, 'f1-score': 0.38535810315326324, 'support': 62794}, 'accuracy': 0.39958285644018576, 'macro avg': {'precision': 0.41249518380744005, 'recall': 0.3823900401885542, 'f1-score': 0.36878660669915836, 'support': 211438}, 'weighted avg': {'precision': 0.41215255690490843, 'recall': 0.39958285644018576, 'f1-score': 0.3780861782186243, 'support': 211438}}
[[10838 37650 16465]
 [ 8837 48425 26429]
 [ 3712 33858 25224]]
training model: results/ATVI/W3/deepLOB_L1/h100
Epoch 1/50
2440/2440 - 57s - loss: 3.2461 - accuracy100: 0.3972 - val_loss: 3.3179 - val_accuracy100: 0.3488 - 57s/epoch - 23ms/step
Epoch 2/50
2440/2440 - 54s - loss: 3.2324 - accuracy100: 0.4016 - val_loss: 3.3077 - val_accuracy100: 0.3544 - 54s/epoch - 22ms/step
Epoch 3/50
2440/2440 - 55s - loss: 3.2167 - accuracy100: 0.4107 - val_loss: 3.3550 - val_accuracy100: 0.3507 - 55s/epoch - 23ms/step
Epoch 4/50
2440/2440 - 54s - loss: 3.2064 - accuracy100: 0.4167 - val_loss: 3.3048 - val_accuracy100: 0.3569 - 54s/epoch - 22ms/step
Epoch 5/50
2440/2440 - 56s - loss: 3.1977 - accuracy100: 0.4209 - val_loss: 3.2945 - val_accuracy100: 0.3616 - 56s/epoch - 23ms/step
Epoch 6/50
2440/2440 - 55s - loss: 3.1909 - accuracy100: 0.4232 - val_loss: 3.3183 - val_accuracy100: 0.3637 - 55s/epoch - 22ms/step
Epoch 7/50
2440/2440 - 56s - loss: 3.1870 - accuracy100: 0.4252 - val_loss: 3.3215 - val_accuracy100: 0.3610 - 56s/epoch - 23ms/step
Epoch 8/50
2440/2440 - 55s - loss: 3.1833 - accuracy100: 0.4251 - val_loss: 3.3426 - val_accuracy100: 0.3602 - 55s/epoch - 23ms/step
Epoch 9/50
2440/2440 - 56s - loss: 3.1799 - accuracy100: 0.4265 - val_loss: 3.3419 - val_accuracy100: 0.3597 - 56s/epoch - 23ms/step
Epoch 10/50
2440/2440 - 54s - loss: 3.1773 - accuracy100: 0.4283 - val_loss: 3.3371 - val_accuracy100: 0.3647 - 54s/epoch - 22ms/step
Epoch 11/50
2440/2440 - 56s - loss: 3.1742 - accuracy100: 0.4301 - val_loss: 3.3544 - val_accuracy100: 0.3599 - 56s/epoch - 23ms/step
Epoch 12/50
2440/2440 - 55s - loss: 3.1736 - accuracy100: 0.4297 - val_loss: 3.3569 - val_accuracy100: 0.3635 - 55s/epoch - 23ms/step
Epoch 13/50
2440/2440 - 56s - loss: 3.1712 - accuracy100: 0.4308 - val_loss: 3.3771 - val_accuracy100: 0.3600 - 56s/epoch - 23ms/step
Epoch 14/50
2440/2440 - 56s - loss: 3.1699 - accuracy100: 0.4316 - val_loss: 3.3337 - val_accuracy100: 0.3750 - 56s/epoch - 23ms/step
Epoch 15/50
2440/2440 - 56s - loss: 3.1675 - accuracy100: 0.4324 - val_loss: 3.3830 - val_accuracy100: 0.3635 - 56s/epoch - 23ms/step
testing model: results/ATVI/W3/deepLOB_L1/h100
Evaluating performance on  test set...
6082/6082 - 80s - 80s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0928465
{'0': {'precision': 0.4687680939645427, 'recall': 0.1343756915683981, 'f1-score': 0.20887568875811613, 'support': 506096}, '1': {'precision': 0.35920422662043155, 'recall': 0.7144665158601428, 'f1-score': 0.47805976659623883, 'support': 549932}, '2': {'precision': 0.40399623779879773, 'recall': 0.25646197102097545, 'f1-score': 0.31375087794301765, 'support': 500776}, 'accuracy': 0.3785608207584256, 'macro avg': {'precision': 0.41065618612792404, 'recall': 0.3684347261498388, 'f1-score': 0.3335621110991242, 'support': 1556804}, 'weighted avg': {'precision': 0.4092301767061474, 'recall': 0.3785608207584256, 'f1-score': 0.3376985309610734, 'support': 1556804}}
[[ 68007 359192  78897]
 [ 46452 392908 110572]
 [ 30617 341729 128430]]
Evaluating performance on  train set...
2440/2440 - 33s - 33s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1086283
{'0': {'precision': 0.395080692571732, 'recall': 0.09964795806109075, 'f1-score': 0.1591538482106365, 'support': 209066}, '1': {'precision': 0.3380769821819976, 'recall': 0.8117353478075116, 'f1-score': 0.47734578862921323, 'support': 205976}, '2': {'precision': 0.3829366106080207, 'recall': 0.1412632131523062, 'f1-score': 0.20639021074099254, 'support': 209545}, 'accuracy': 0.34844145011023286, 'macro avg': {'precision': 0.3720314284539168, 'recall': 0.3508821730069695, 'f1-score': 0.2809632825269474, 'support': 624587}, 'weighted avg': {'precision': 0.3722077734966923, 'recall': 0.34844145011023286, 'f1-score': 0.27993453481807506, 'support': 624587}}
[[ 20833 162481  25752]
 [ 16831 167198  21947]
 [ 15067 164877  29601]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0989405
{'0': {'precision': 0.4044438896517289, 'recall': 0.1350731646308417, 'f1-score': 0.20251265704106508, 'support': 71961}, '1': {'precision': 0.3578560755233427, 'recall': 0.7106211869107044, 'f1-score': 0.47600471825164625, 'support': 72120}, '2': {'precision': 0.34459505329139417, 'recall': 0.2260789524474071, 'f1-score': 0.27303044429303974, 'support': 67357}, 'accuracy': 0.3603798749515224, 'macro avg': {'precision': 0.3689650061554886, 'recall': 0.35725776799631775, 'f1-score': 0.3171826065285837, 'support': 211438}, 'weighted avg': {'precision': 0.3694873008376922, 'recall': 0.3603798749515224, 'f1-score': 0.31826344001497886, 'support': 211438}}
[[ 9720 45863 16378]
 [ 8285 51250 12585]
 [ 6028 46101 15228]]
training model: results/ATVI/W3/deepLOB_L1/h200
Epoch 1/50
2440/2440 - 62s - loss: 3.2749 - accuracy200: 0.3782 - val_loss: 3.3421 - val_accuracy200: 0.3461 - 62s/epoch - 26ms/step
Epoch 2/50
2440/2440 - 56s - loss: 3.2533 - accuracy200: 0.3909 - val_loss: 3.3694 - val_accuracy200: 0.3476 - 56s/epoch - 23ms/step
Epoch 3/50
2440/2440 - 58s - loss: 3.2441 - accuracy200: 0.3982 - val_loss: 3.4546 - val_accuracy200: 0.3456 - 58s/epoch - 24ms/step
Epoch 4/50
2440/2440 - 57s - loss: 3.2377 - accuracy200: 0.4018 - val_loss: 3.3949 - val_accuracy200: 0.3485 - 57s/epoch - 23ms/step
Epoch 5/50
2440/2440 - 54s - loss: 3.2321 - accuracy200: 0.4049 - val_loss: 3.4027 - val_accuracy200: 0.3462 - 54s/epoch - 22ms/step
Epoch 6/50
2440/2440 - 56s - loss: 3.2283 - accuracy200: 0.4070 - val_loss: 3.4130 - val_accuracy200: 0.3403 - 56s/epoch - 23ms/step
Epoch 7/50
2440/2440 - 55s - loss: 3.2252 - accuracy200: 0.4077 - val_loss: 3.4014 - val_accuracy200: 0.3457 - 55s/epoch - 23ms/step
Epoch 8/50
2440/2440 - 55s - loss: 3.2229 - accuracy200: 0.4094 - val_loss: 3.4715 - val_accuracy200: 0.3461 - 55s/epoch - 23ms/step
Epoch 9/50
2440/2440 - 56s - loss: 3.2196 - accuracy200: 0.4108 - val_loss: 3.4410 - val_accuracy200: 0.3468 - 56s/epoch - 23ms/step
Epoch 10/50
2440/2440 - 57s - loss: 3.2167 - accuracy200: 0.4127 - val_loss: 3.4068 - val_accuracy200: 0.3485 - 57s/epoch - 23ms/step
Epoch 11/50
2440/2440 - 57s - loss: 3.2144 - accuracy200: 0.4136 - val_loss: 3.4363 - val_accuracy200: 0.3455 - 57s/epoch - 23ms/step
testing model: results/ATVI/W3/deepLOB_L1/h200
Evaluating performance on  test set...
6082/6082 - 80s - 80s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0979942
{'0': {'precision': 0.38863947323413717, 'recall': 0.03562065249338689, 'f1-score': 0.06525992324895985, 'support': 510350}, '1': {'precision': 0.3509207420980241, 'recall': 0.9664866137791973, 'f1-score': 0.5148903992711744, 'support': 543544}, '2': {'precision': 0.43341776038068924, 'recall': 0.011228649261299238, 'f1-score': 0.021890184692376424, 'support': 502910}, 'accuracy': 0.35274446879632887, 'macro avg': {'precision': 0.39099265857095017, 'recall': 0.33777863851129447, 'f1-score': 0.20068016907083694, 'support': 1556804}, 'weighted avg': {'precision': 0.38993549919002185, 'recall': 0.35274446879632887, 'f1-score': 0.20823416550522794, 'support': 1556804}}
[[ 18179 489806   2365]
 [ 13199 525328   5017]
 [ 15398 481865   5647]]
Evaluating performance on  train set...
2440/2440 - 33s - 33s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.120783
{'0': {'precision': 0.3415170816444702, 'recall': 0.05665080226487948, 'f1-score': 0.0971812014186676, 'support': 208223}, '1': {'precision': 0.33204379146035434, 'recall': 0.9334909714163636, 'f1-score': 0.489848071401091, 'support': 205957}, '2': {'precision': 0.3766999093381686, 'recall': 0.01974744186267567, 'f1-score': 0.037527603787984844, 'support': 210407}, 'accuracy': 0.33335628183103394, 'macro avg': {'precision': 0.35008692748099773, 'recall': 0.33662973851463956, 'f1-score': 0.20818562553591446, 'support': 624587}, 'weighted avg': {'precision': 0.35024544582767936, 'recall': 0.33335628183103394, 'f1-score': 0.20656701320195944, 'support': 624587}}
[[ 11796 192802   3625]
 [ 10448 192259   3250]
 [ 12296 193956   4155]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1153256
{'0': {'precision': 0.3515537541015248, 'recall': 0.1261339870638911, 'f1-score': 0.1856563309073859, 'support': 72201}, '1': {'precision': 0.3465598814661825, 'recall': 0.8528160649669917, 'f1-score': 0.4928426908449496, 'support': 72406}, '2': {'precision': 0.3215062533985862, 'recall': 0.0353877691490476, 'f1-score': 0.06375780123202178, 'support': 66831}, 'accuracy': 0.34630009742808765, 'macro avg': {'precision': 0.33987329632209784, 'recall': 0.33811260705997676, 'f1-score': 0.24741894099478576, 'support': 211438}, 'weighted avg': {'precision': 0.34034625657736794, 'recall': 0.34630009742808765, 'f1-score': 0.25232142867081997, 'support': 211438}}
[[ 9107 60467  2627]
 [ 8293 61749  2364]
 [ 8505 55961  2365]]
training model: results/ATVI/W3/deepLOB_L1/h300
Epoch 1/50
2440/2440 - 59s - loss: 3.2597 - accuracy300: 0.3947 - val_loss: 3.3455 - val_accuracy300: 0.3356 - 59s/epoch - 24ms/step
Epoch 2/50
2440/2440 - 56s - loss: 3.2469 - accuracy300: 0.4000 - val_loss: 3.4347 - val_accuracy300: 0.3360 - 56s/epoch - 23ms/step
Epoch 3/50
2440/2440 - 56s - loss: 3.2249 - accuracy300: 0.4115 - val_loss: 3.4788 - val_accuracy300: 0.3255 - 56s/epoch - 23ms/step
Epoch 4/50
2440/2440 - 54s - loss: 3.2168 - accuracy300: 0.4146 - val_loss: 3.6310 - val_accuracy300: 0.3211 - 54s/epoch - 22ms/step
Epoch 5/50
2440/2440 - 54s - loss: 3.2110 - accuracy300: 0.4174 - val_loss: 3.7350 - val_accuracy300: 0.3178 - 54s/epoch - 22ms/step
Epoch 6/50
2440/2440 - 56s - loss: 3.2068 - accuracy300: 0.4204 - val_loss: 3.6382 - val_accuracy300: 0.3291 - 56s/epoch - 23ms/step
Epoch 7/50
2440/2440 - 55s - loss: 3.2056 - accuracy300: 0.4213 - val_loss: 3.6512 - val_accuracy300: 0.3215 - 55s/epoch - 23ms/step
Epoch 8/50
2440/2440 - 56s - loss: 3.2020 - accuracy300: 0.4220 - val_loss: 3.6166 - val_accuracy300: 0.3211 - 56s/epoch - 23ms/step
Epoch 9/50
2440/2440 - 55s - loss: 3.1968 - accuracy300: 0.4255 - val_loss: 3.6238 - val_accuracy300: 0.3216 - 55s/epoch - 23ms/step
Epoch 10/50
2440/2440 - 55s - loss: 3.1936 - accuracy300: 0.4260 - val_loss: 3.6574 - val_accuracy300: 0.3354 - 55s/epoch - 22ms/step
Epoch 11/50
2440/2440 - 54s - loss: 3.1888 - accuracy300: 0.4284 - val_loss: 3.7290 - val_accuracy300: 0.3300 - 54s/epoch - 22ms/step
testing model: results/ATVI/W3/deepLOB_L1/h300
Evaluating performance on  test set...
6082/6082 - 78s - 78s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1133587
{'0': {'precision': 0.34359431928024387, 'recall': 0.008488555788236159, 'f1-score': 0.016567801243750326, 'support': 544380}, '1': {'precision': 0.30489075351557066, 'recall': 0.8589138777630675, 'f1-score': 0.4500324063987408, 'support': 477368}, '2': {'precision': 0.3746222652000484, 'recall': 0.1390172243653001, 'f1-score': 0.20278404815650866, 'support': 535056}, 'accuracy': 0.3141185402915203, 'macro avg': {'precision': 0.3410357793319543, 'recall': 0.3354732193055346, 'f1-score': 0.2231280852663333, 'support': 1556804}, 'weighted avg': {'precision': 0.34239047142920825, 'recall': 0.3141185402915203, 'f1-score': 0.21348292469010602, 'support': 1556804}}
[[  4621 478611  61148]
 [  4328 410018  63022]
 [  4500 456174  74382]]
Evaluating performance on  train set...
2440/2440 - 32s - 32s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1158164
{'0': {'precision': 0.354161863038967, 'recall': 0.0073807830549522365, 'f1-score': 0.014460213231659962, 'support': 208108}, '1': {'precision': 0.3305830472969141, 'recall': 0.9615774587758151, 'f1-score': 0.49201504772850535, 'support': 206129}, '2': {'precision': 0.3661249758173728, 'recall': 0.03598763964820537, 'f1-score': 0.06553374944811406, 'support': 210350}, 'accuracy': 0.3319233349397282, 'macro avg': {'precision': 0.35028996205108465, 'recall': 0.3349819604929909, 'f1-score': 0.19066967013609312, 'support': 624587}, 'weighted avg': {'precision': 0.3504092442089946, 'recall': 0.3319233349397282, 'f1-score': 0.189265674797673, 'support': 624587}}
[[  1536 199959   6613]
 [  1427 198209   6493]
 [  1374 201406   7570]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1160028
{'0': {'precision': 0.37743506493506496, 'recall': 0.006405046901472472, 'f1-score': 0.012596334872885372, 'support': 72599}, '1': {'precision': 0.33619604866942493, 'recall': 0.9697889890116098, 'f1-score': 0.49930009416914817, 'support': 70802}, '2': {'precision': 0.33411488862837047, 'recall': 0.02932228052383262, 'f1-score': 0.05391309047670522, 'support': 68037}, 'accuracy': 0.33637756694633886, 'macro avg': {'precision': 0.34924866741095345, 'recall': 0.33517210547897164, 'f1-score': 0.18860317317291295, 'support': 211438}, 'weighted avg': {'precision': 0.34968612829634144, 'recall': 0.33637756694633886, 'f1-score': 0.18886865899017313, 'support': 211438}}
[[  465 69930  2204]
 [  367 68663  1772]
 [  400 65642  1995]]
training model: results/ATVI/W3/deepLOB_L1/h500
Epoch 1/50
2440/2440 - 57s - loss: 3.2441 - accuracy500: 0.4028 - val_loss: 3.5918 - val_accuracy500: 0.2942 - 57s/epoch - 24ms/step
Epoch 2/50
2440/2440 - 56s - loss: 3.2165 - accuracy500: 0.4164 - val_loss: 3.4825 - val_accuracy500: 0.2998 - 56s/epoch - 23ms/step
Epoch 3/50
2440/2440 - 57s - loss: 3.1942 - accuracy500: 0.4269 - val_loss: 3.4877 - val_accuracy500: 0.2963 - 57s/epoch - 23ms/step
Epoch 4/50
2440/2440 - 56s - loss: 3.1917 - accuracy500: 0.4289 - val_loss: 3.5201 - val_accuracy500: 0.2913 - 56s/epoch - 23ms/step
Epoch 5/50
2440/2440 - 57s - loss: 3.1832 - accuracy500: 0.4322 - val_loss: 3.6613 - val_accuracy500: 0.2904 - 57s/epoch - 23ms/step
Epoch 6/50
2440/2440 - 57s - loss: 3.1781 - accuracy500: 0.4341 - val_loss: 3.7024 - val_accuracy500: 0.3088 - 57s/epoch - 23ms/step
Epoch 7/50
2440/2440 - 57s - loss: 3.1740 - accuracy500: 0.4358 - val_loss: 3.5169 - val_accuracy500: 0.3334 - 57s/epoch - 23ms/step
Epoch 8/50
2440/2440 - 57s - loss: 3.1675 - accuracy500: 0.4389 - val_loss: 3.7800 - val_accuracy500: 0.3138 - 57s/epoch - 23ms/step
Epoch 9/50
2440/2440 - 57s - loss: 3.1635 - accuracy500: 0.4398 - val_loss: 3.7635 - val_accuracy500: 0.3012 - 57s/epoch - 23ms/step
Epoch 10/50
2440/2440 - 57s - loss: 3.1563 - accuracy500: 0.4433 - val_loss: 3.6971 - val_accuracy500: 0.3099 - 57s/epoch - 23ms/step
Epoch 11/50
2440/2440 - 57s - loss: 3.1531 - accuracy500: 0.4437 - val_loss: 3.6331 - val_accuracy500: 0.3051 - 57s/epoch - 23ms/step
Epoch 12/50
2440/2440 - 57s - loss: 3.1483 - accuracy500: 0.4463 - val_loss: 3.6851 - val_accuracy500: 0.3007 - 57s/epoch - 23ms/step
testing model: results/ATVI/W3/deepLOB_L1/h500
Evaluating performance on  test set...
6082/6082 - 81s - 81s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2586765
{'0': {'precision': 0.33868092691622104, 'recall': 0.00031880585394664866, 'f1-score': 0.0006370120780842699, 'support': 595974}, '1': {'precision': 0.2448395931876869, 'recall': 0.9918210544257824, 'f1-score': 0.3927303160316821, 'support': 381345}, '2': {'precision': 0.39154732797764585, 'recall': 0.007737905208935521, 'f1-score': 0.015175898615250018, 'support': 579485}, 'accuracy': 0.24595260546607023, 'macro avg': {'precision': 0.3250226160271846, 'recall': 0.3332925884962215, 'f1-score': 0.13618107557500547, 'support': 1556804}, 'weighted avg': {'precision': 0.3353724584181776, 'recall': 0.24595260546607023, 'f1-score': 0.10209351377076638, 'support': 1556804}}
[[   190 591799   3985]
 [   136 378226   2983]
 [   235 574766   4484]]
Evaluating performance on  train set...
2440/2440 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.142831
{'0': {'precision': 0.3436543988133865, 'recall': 0.017873415524365607, 'f1-score': 0.033979559099867086, 'support': 207403}, '1': {'precision': 0.3318941783261235, 'recall': 0.9536068508394213, 'f1-score': 0.49240965977438206, 'support': 206690}, '2': {'precision': 0.3449556012642352, 'recall': 0.03266601423318479, 'f1-score': 0.05968050619068078, 'support': 210494}, 'accuracy': 0.3325141253340207, 'macro avg': {'precision': 0.34016805946791506, 'recall': 0.3347154268656572, 'f1-score': 0.1953565750216433, 'support': 624587}, 'weighted avg': {'precision': 0.3402011974758251, 'recall': 0.3325141253340207, 'f1-score': 0.19434602952808483, 'support': 624587}}
[[  3707 196817   6879]
 [  3411 197101   6178]
 [  3669 199949   6876]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1628023
{'0': {'precision': 0.3847332924586144, 'recall': 0.01615976925652185, 'f1-score': 0.031016756462854036, 'support': 77662}, '1': {'precision': 0.29640083987005783, 'recall': 0.96198910300712, 'f1-score': 0.4531733262667752, 'support': 62219}, '2': {'precision': 0.36698717948717946, 'recall': 0.03200245957767933, 'f1-score': 0.058871164697867524, 'support': 71557}, 'accuracy': 0.29984676359027235, 'macro avg': {'precision': 0.3493737706052839, 'recall': 0.3367171106137737, 'f1-score': 0.18102041580916559, 'support': 211438}, 'weighted avg': {'precision': 0.35273424085244914, 'recall': 0.29984676359027235, 'f1-score': 0.16466982500636576, 'support': 211438}}
[[ 1255 74003  2404]
 [  819 59854  1546]
 [ 1188 68079  2290]]
training model: results/ATVI/W3/deepLOB_L1/h1000
Epoch 1/50
2440/2440 - 59s - loss: 3.2439 - accuracy1000: 0.4030 - val_loss: 3.3855 - val_accuracy1000: 0.3388 - 59s/epoch - 24ms/step
Epoch 2/50
2440/2440 - 54s - loss: 3.1855 - accuracy1000: 0.4304 - val_loss: 3.3666 - val_accuracy1000: 0.3425 - 54s/epoch - 22ms/step
Epoch 3/50
2440/2440 - 54s - loss: 3.1595 - accuracy1000: 0.4395 - val_loss: 3.4160 - val_accuracy1000: 0.3418 - 54s/epoch - 22ms/step
Epoch 4/50
2440/2440 - 55s - loss: 3.1347 - accuracy1000: 0.4512 - val_loss: 3.4037 - val_accuracy1000: 0.3417 - 55s/epoch - 22ms/step
Epoch 5/50
2440/2440 - 56s - loss: 3.1211 - accuracy1000: 0.4567 - val_loss: 3.4291 - val_accuracy1000: 0.3368 - 56s/epoch - 23ms/step
Epoch 6/50
2440/2440 - 55s - loss: 3.1059 - accuracy1000: 0.4624 - val_loss: 3.5194 - val_accuracy1000: 0.3255 - 55s/epoch - 23ms/step
Epoch 7/50
2440/2440 - 54s - loss: 3.0970 - accuracy1000: 0.4653 - val_loss: 3.5151 - val_accuracy1000: 0.3263 - 54s/epoch - 22ms/step
Epoch 8/50
2440/2440 - 56s - loss: 3.0850 - accuracy1000: 0.4690 - val_loss: 3.6464 - val_accuracy1000: 0.3213 - 56s/epoch - 23ms/step
Epoch 9/50
2440/2440 - 54s - loss: 3.0778 - accuracy1000: 0.4715 - val_loss: 3.6817 - val_accuracy1000: 0.3212 - 54s/epoch - 22ms/step
Epoch 10/50
2440/2440 - 55s - loss: 3.0701 - accuracy1000: 0.4742 - val_loss: 3.6037 - val_accuracy1000: 0.3223 - 55s/epoch - 23ms/step
Epoch 11/50
2440/2440 - 55s - loss: 3.0647 - accuracy1000: 0.4752 - val_loss: 3.6422 - val_accuracy1000: 0.3177 - 55s/epoch - 23ms/step
Epoch 12/50
2440/2440 - 55s - loss: 3.0609 - accuracy1000: 0.4763 - val_loss: 3.6778 - val_accuracy1000: 0.3178 - 55s/epoch - 22ms/step
testing model: results/ATVI/W3/deepLOB_L1/h1000
Evaluating performance on  test set...
6082/6082 - 77s - 77s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1274215
{'0': {'precision': 0.38922120629592405, 'recall': 0.23597632762690574, 'f1-score': 0.29381750858781674, 'support': 507089}, '1': {'precision': 0.3474247033097223, 'recall': 0.5295487187515359, 'f1-score': 0.41957555810042485, 'support': 549347}, '2': {'precision': 0.2886619455109381, 'recall': 0.23770904614203947, 'f1-score': 0.26071936642795923, 'support': 500368}, 'accuracy': 0.34012566771411173, 'macro avg': {'precision': 0.34176928503886145, 'recall': 0.33441136417349365, 'f1-score': 0.3247041443720669, 'support': 1556804}, 'weighted avg': {'precision': 0.3421520699586441, 'recall': 0.34012566771411173, 'f1-score': 0.3275555745417577, 'support': 1556804}}
[[119661 261208 126220]
 [ 91557 290906 166884]
 [ 96219 285207 118942]]
Evaluating performance on  train set...
2440/2440 - 32s - 32s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1237472
{'0': {'precision': 0.3178298912333725, 'recall': 0.08303236780668022, 'f1-score': 0.13166701446049447, 'support': 205173}, '1': {'precision': 0.32791611000848503, 'recall': 0.868046358419079, 'f1-score': 0.4760122372971534, 'support': 206133}, '2': {'precision': 0.37307950550969626, 'recall': 0.04428898964277174, 'f1-score': 0.07917854149203689, 'support': 213281}, 'accuracy': 0.32888132477941423, 'macro avg': {'precision': 0.3396085022505179, 'recall': 0.33178923862284365, 'f1-score': 0.22895259774989493, 'support': 624587}, 'weighted avg': {'precision': 0.34002503060905415, 'recall': 0.32888132477941423, 'f1-score': 0.22738805863176834, 'support': 624587}}
[[ 17036 180621   7516]
 [ 18843 178933   8357]
 [ 17722 186113   9446]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1210228
{'0': {'precision': 0.33263598326359833, 'recall': 0.13011811560599035, 'f1-score': 0.18706249142140044, 'support': 73318}, '1': {'precision': 0.3463359906186927, 'recall': 0.8344675822160642, 'f1-score': 0.4895075919056858, 'support': 73617}, '2': {'precision': 0.31036404160475484, 'recall': 0.025905771824566298, 'f1-score': 0.04782005237025484, 'support': 64503}, 'accuracy': 0.3435617060320283, 'macro avg': {'precision': 0.32977867182901527, 'recall': 0.33016382321554033, 'f1-score': 0.24146337856578037, 'support': 211438}, 'weighted avg': {'precision': 0.33061149565323317, 'recall': 0.3435617060320283, 'f1-score': 0.24988727181203785, 'support': 211438}}
[[ 9540 61892  1886]
 [10359 61431  1827]
 [ 8781 54051  1671]]
training model: results/ATVI/W3/deepOF_L1/h10
Epoch 1/50
2440/2440 - 54s - loss: 3.1703 - accuracy10: 0.4248 - val_loss: 2.9803 - val_accuracy10: 0.6158 - 54s/epoch - 22ms/step
Epoch 2/50
2440/2440 - 51s - loss: 3.1655 - accuracy10: 0.4106 - val_loss: 2.9382 - val_accuracy10: 0.6121 - 51s/epoch - 21ms/step
Epoch 3/50
2440/2440 - 51s - loss: 3.1544 - accuracy10: 0.4190 - val_loss: 2.9301 - val_accuracy10: 0.6101 - 51s/epoch - 21ms/step
Epoch 4/50
2440/2440 - 51s - loss: 3.1428 - accuracy10: 0.4272 - val_loss: 2.9293 - val_accuracy10: 0.6105 - 51s/epoch - 21ms/step
Epoch 5/50
2440/2440 - 51s - loss: 3.1329 - accuracy10: 0.4326 - val_loss: 2.9227 - val_accuracy10: 0.6114 - 51s/epoch - 21ms/step
Epoch 6/50
2440/2440 - 51s - loss: 3.1238 - accuracy10: 0.4394 - val_loss: 2.9222 - val_accuracy10: 0.6136 - 51s/epoch - 21ms/step
Epoch 7/50
2440/2440 - 51s - loss: 3.1168 - accuracy10: 0.4425 - val_loss: 2.9269 - val_accuracy10: 0.6137 - 51s/epoch - 21ms/step
Epoch 8/50
2440/2440 - 51s - loss: 3.1094 - accuracy10: 0.4458 - val_loss: 2.9406 - val_accuracy10: 0.6154 - 51s/epoch - 21ms/step
Epoch 9/50
2440/2440 - 51s - loss: 3.1033 - accuracy10: 0.4492 - val_loss: 2.9435 - val_accuracy10: 0.6160 - 51s/epoch - 21ms/step
Epoch 10/50
2440/2440 - 51s - loss: 3.0967 - accuracy10: 0.4519 - val_loss: 2.9443 - val_accuracy10: 0.6147 - 51s/epoch - 21ms/step
Epoch 11/50
2440/2440 - 51s - loss: 3.0920 - accuracy10: 0.4537 - val_loss: 2.9355 - val_accuracy10: 0.6139 - 51s/epoch - 21ms/step
Epoch 12/50
2440/2440 - 51s - loss: 3.0869 - accuracy10: 0.4553 - val_loss: 2.9256 - val_accuracy10: 0.6147 - 51s/epoch - 21ms/step
Epoch 13/50
2440/2440 - 51s - loss: 3.0812 - accuracy10: 0.4580 - val_loss: 2.9212 - val_accuracy10: 0.6130 - 51s/epoch - 21ms/step
Epoch 14/50
2440/2440 - 52s - loss: 3.0754 - accuracy10: 0.4598 - val_loss: 2.9330 - val_accuracy10: 0.6157 - 52s/epoch - 21ms/step
Epoch 15/50
2440/2440 - 52s - loss: 3.0701 - accuracy10: 0.4620 - val_loss: 2.9335 - val_accuracy10: 0.6140 - 52s/epoch - 21ms/step
Epoch 16/50
2440/2440 - 52s - loss: 3.0648 - accuracy10: 0.4632 - val_loss: 2.9347 - val_accuracy10: 0.6155 - 52s/epoch - 21ms/step
Epoch 17/50
2440/2440 - 52s - loss: 3.0592 - accuracy10: 0.4646 - val_loss: 2.9370 - val_accuracy10: 0.6172 - 52s/epoch - 21ms/step
Epoch 18/50
2440/2440 - 52s - loss: 3.0534 - accuracy10: 0.4666 - val_loss: 2.9336 - val_accuracy10: 0.6182 - 52s/epoch - 21ms/step
Epoch 19/50
2440/2440 - 52s - loss: 3.0487 - accuracy10: 0.4677 - val_loss: 2.9275 - val_accuracy10: 0.6165 - 52s/epoch - 21ms/step
Epoch 20/50
2440/2440 - 53s - loss: 3.0426 - accuracy10: 0.4702 - val_loss: 2.9541 - val_accuracy10: 0.6170 - 53s/epoch - 22ms/step
Epoch 21/50
2440/2440 - 52s - loss: 3.0377 - accuracy10: 0.4713 - val_loss: 2.9609 - val_accuracy10: 0.6171 - 52s/epoch - 21ms/step
Epoch 22/50
2440/2440 - 54s - loss: 3.0319 - accuracy10: 0.4725 - val_loss: 2.9622 - val_accuracy10: 0.6177 - 54s/epoch - 22ms/step
Epoch 23/50
2440/2440 - 54s - loss: 3.0289 - accuracy10: 0.4746 - val_loss: 2.9548 - val_accuracy10: 0.6172 - 54s/epoch - 22ms/step
testing model: results/ATVI/W3/deepOF_L1/h10
Evaluating performance on  test set...
6082/6082 - 78s - 78s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89254975
{'0': {'precision': 0.3747709613255338, 'recall': 0.13852650793535817, 'f1-score': 0.2022831424544443, 'support': 276106}, '1': {'precision': 0.6644270266253084, 'recall': 0.9155174487909973, 'f1-score': 0.7700201441110879, 'support': 1005829}, '2': {'precision': 0.40628724239165187, 'recall': 0.10170447310497881, 'f1-score': 0.16268466062018616, 'support': 274865}, 'accuracy': 0.6340294193216856, 'macro avg': {'precision': 0.4818284101141647, 'recall': 0.3852494766104448, 'f1-score': 0.37832931572857276, 'support': 1556800}, 'weighted avg': {'precision': 0.5674785622374335, 'recall': 0.6340294193216856, 'f1-score': 0.5620994990384157, 'support': 1556800}}
[[ 38248 230304   7554]
 [ 51678 920854  33297]
 [ 12131 234779  27955]]
Evaluating performance on  train set...
2440/2440 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9821862
{'0': {'precision': 0.4070238528769119, 'recall': 0.12475235092223122, 'f1-score': 0.19097199974370477, 'support': 143348}, '1': {'precision': 0.5558094913075916, 'recall': 0.9062672041769522, 'f1-score': 0.6890362390673506, 'support': 337854}, '2': {'precision': 0.43751259826647854, 'recall': 0.0908266670386308, 'f1-score': 0.15042535619610858, 'support': 143383}, 'accuracy': 0.5397055644948245, 'macro avg': {'precision': 0.466781980816994, 'recall': 0.37394874071260475, 'f1-score': 0.34347786500238797, 'support': 624585}, 'weighted avg': {'precision': 0.49450496572232305, 'recall': 0.5397055644948245, 'f1-score': 0.451079584973363, 'support': 624585}}
[[ 17883 121020   4445]
 [ 19370 306186  12298]
 [  6683 123677  13023]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9107525
{'0': {'precision': 0.3829934541792548, 'recall': 0.1522696561733647, 'f1-score': 0.21790510295434196, 'support': 39962}, '1': {'precision': 0.6435093355180889, 'recall': 0.9021929691986821, 'f1-score': 0.7512049329893663, 'support': 132332}, '2': {'precision': 0.4072041508680902, 'recall': 0.10425608011444921, 'f1-score': 0.1660090306309238, 'support': 39144}, 'accuracy': 0.6127328105638532, 'macro avg': {'precision': 0.4779023135218113, 'recall': 0.3862395684954987, 'f1-score': 0.378373022191544, 'support': 211438}, 'weighted avg': {'precision': 0.550523846637178, 'recall': 0.6127328105638532, 'f1-score': 0.5420720608955207, 'support': 211438}}
[[  6085  32611   1266]
 [  8268 119389   4675]
 [  1535  33528   4081]]
training model: results/ATVI/W3/deepOF_L1/h20
Epoch 1/50
2440/2440 - 53s - loss: 3.1946 - accuracy20: 0.4272 - val_loss: 3.1238 - val_accuracy20: 0.5116 - 53s/epoch - 22ms/step
Epoch 2/50
2440/2440 - 51s - loss: 3.1913 - accuracy20: 0.4199 - val_loss: 3.0875 - val_accuracy20: 0.5119 - 51s/epoch - 21ms/step
Epoch 3/50
2440/2440 - 51s - loss: 3.1798 - accuracy20: 0.4270 - val_loss: 3.1002 - val_accuracy20: 0.5114 - 51s/epoch - 21ms/step
Epoch 4/50
2440/2440 - 51s - loss: 3.1837 - accuracy20: 0.4249 - val_loss: 3.1101 - val_accuracy20: 0.5120 - 51s/epoch - 21ms/step
Epoch 5/50
2440/2440 - 52s - loss: 3.1671 - accuracy20: 0.4309 - val_loss: 3.1270 - val_accuracy20: 0.5136 - 52s/epoch - 21ms/step
Epoch 6/50
2440/2440 - 51s - loss: 3.1541 - accuracy20: 0.4374 - val_loss: 3.1703 - val_accuracy20: 0.5139 - 51s/epoch - 21ms/step
Epoch 7/50
2440/2440 - 51s - loss: 3.1468 - accuracy20: 0.4392 - val_loss: 3.1994 - val_accuracy20: 0.5155 - 51s/epoch - 21ms/step
Epoch 8/50
2440/2440 - 50s - loss: 3.1389 - accuracy20: 0.4432 - val_loss: 3.2191 - val_accuracy20: 0.5168 - 50s/epoch - 21ms/step
Epoch 9/50
2440/2440 - 51s - loss: 3.1342 - accuracy20: 0.4435 - val_loss: 3.2434 - val_accuracy20: 0.5170 - 51s/epoch - 21ms/step
Epoch 10/50
2440/2440 - 52s - loss: 3.1299 - accuracy20: 0.4462 - val_loss: 3.2685 - val_accuracy20: 0.5174 - 52s/epoch - 21ms/step
Epoch 11/50
2440/2440 - 52s - loss: 3.1255 - accuracy20: 0.4477 - val_loss: 3.3094 - val_accuracy20: 0.5189 - 52s/epoch - 21ms/step
Epoch 12/50
2440/2440 - 52s - loss: 3.1328 - accuracy20: 0.4474 - val_loss: 3.2136 - val_accuracy20: 0.5196 - 52s/epoch - 21ms/step
testing model: results/ATVI/W3/deepOF_L1/h20
Evaluating performance on  test set...
6082/6082 - 79s - 79s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9937347
{'0': {'precision': 0.346648247047526, 'recall': 0.057638276118044174, 'f1-score': 0.09884181754423046, 'support': 356985}, '1': {'precision': 0.5473400382584912, 'recall': 0.9347571966361525, 'f1-score': 0.6904135946324755, 'support': 846055}, '2': {'precision': 0.4039783001808318, 'recall': 0.05999265038444143, 'f1-score': 0.10447088937840732, 'support': 353760}, 'accuracy': 0.5348503340184995, 'macro avg': {'precision': 0.43265552849561634, 'recall': 0.3507960410462127, 'f1-score': 0.2979087671850378, 'support': 1556800}, 'weighted avg': {'precision': 0.46874316804536226, 'recall': 0.5348503340184995, 'f1-score': 0.42161519904246636, 'support': 1556800}}
[[ 20576 330942   5467]
 [ 29354 790856  25845]
 [  9427 323110  21223]]
Evaluating performance on  train set...
2440/2440 - 32s - 32s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0691855
{'0': {'precision': 0.4131004366812227, 'recall': 0.05007940709370037, 'f1-score': 0.08932955618508027, 'support': 179455}, '1': {'precision': 0.42744370779577506, 'recall': 0.9424928901394887, 'f1-score': 0.5881478838357399, 'support': 265828}, '2': {'precision': 0.44895758447160317, 'recall': 0.04179540663238558, 'f1-score': 0.07647172872638958, 'support': 179302}, 'accuracy': 0.42751907266424904, 'macro avg': {'precision': 0.42983390964953366, 'recall': 0.34478923462185823, 'f1-score': 0.25131638958240327, 'support': 624585}, 'weighted avg': {'precision': 0.4294986873387794, 'recall': 0.42751907266424904, 'f1-score': 0.29793918373572814, 'support': 624585}}
[[  8987 167804   2664]
 [  8753 250541   6534]
 [  4015 167793   7494]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0101346
{'0': {'precision': 0.40732423561927794, 'recall': 0.04552914599061613, 'f1-score': 0.08190343869399096, 'support': 51791}, '1': {'precision': 0.5158684877680924, 'recall': 0.957361593208791, 'f1-score': 0.6704623856287115, 'support': 108611}, '2': {'precision': 0.4522760646108664, 'recall': 0.036209734305196334, 'f1-score': 0.06705126809622293, 'support': 51036}, 'accuracy': 0.5116677229258695, 'macro avg': {'precision': 0.4584895959994122, 'recall': 0.3463668245015345, 'f1-score': 0.27313903080630847, 'support': 211438}, 'weighted avg': {'precision': 0.4739312850358898, 'recall': 0.5116677229258695, 'f1-score': 0.38064813173355455, 'support': 211438}}
[[  2358  48988    445]
 [  2838 103980   1793]
 [   593  48595   1848]]
training model: results/ATVI/W3/deepOF_L1/h30
Epoch 1/50
2440/2440 - 54s - loss: 3.2085 - accuracy30: 0.4239 - val_loss: 3.2173 - val_accuracy30: 0.4396 - 54s/epoch - 22ms/step
Epoch 2/50
2440/2440 - 52s - loss: 3.2110 - accuracy30: 0.4198 - val_loss: 3.2041 - val_accuracy30: 0.4397 - 52s/epoch - 21ms/step
Epoch 3/50
2440/2440 - 52s - loss: 3.2034 - accuracy30: 0.4228 - val_loss: 3.2514 - val_accuracy30: 0.4400 - 52s/epoch - 21ms/step
Epoch 4/50
2440/2440 - 53s - loss: 3.1882 - accuracy30: 0.4298 - val_loss: 3.3062 - val_accuracy30: 0.4406 - 53s/epoch - 22ms/step
Epoch 5/50
2440/2440 - 53s - loss: 3.1742 - accuracy30: 0.4348 - val_loss: 3.3392 - val_accuracy30: 0.4406 - 53s/epoch - 22ms/step
Epoch 6/50
2440/2440 - 51s - loss: 3.1603 - accuracy30: 0.4406 - val_loss: 3.4084 - val_accuracy30: 0.4409 - 51s/epoch - 21ms/step
Epoch 7/50
2440/2440 - 51s - loss: 3.1531 - accuracy30: 0.4427 - val_loss: 3.4619 - val_accuracy30: 0.4416 - 51s/epoch - 21ms/step
Epoch 8/50
2440/2440 - 52s - loss: 3.1491 - accuracy30: 0.4447 - val_loss: 3.4979 - val_accuracy30: 0.4423 - 52s/epoch - 21ms/step
Epoch 9/50
2440/2440 - 53s - loss: 3.1471 - accuracy30: 0.4446 - val_loss: 3.4905 - val_accuracy30: 0.4430 - 53s/epoch - 22ms/step
Epoch 10/50
2440/2440 - 53s - loss: 3.1564 - accuracy30: 0.4435 - val_loss: 3.3250 - val_accuracy30: 0.4446 - 53s/epoch - 22ms/step
Epoch 11/50
2440/2440 - 55s - loss: 3.1550 - accuracy30: 0.4441 - val_loss: 3.2326 - val_accuracy30: 0.4473 - 55s/epoch - 22ms/step
Epoch 12/50
2440/2440 - 55s - loss: 3.1515 - accuracy30: 0.4455 - val_loss: 3.2262 - val_accuracy30: 0.4483 - 55s/epoch - 22ms/step
testing model: results/ATVI/W3/deepOF_L1/h30
Evaluating performance on  test set...
6082/6082 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0394988
{'0': {'precision': 0.3821517147011032, 'recall': 0.04343969261204422, 'f1-score': 0.07801169258836546, 'support': 411467}, '1': {'precision': 0.477375288015895, 'recall': 0.9526833425776864, 'f1-score': 0.6360403347409578, 'support': 739190}, '2': {'precision': 0.4343022755315791, 'recall': 0.03726519969567369, 'f1-score': 0.06864070096509688, 'support': 406143}, 'accuracy': 0.4735502312435766, 'macro avg': {'precision': 0.43127642608285904, 'recall': 0.3444627449618014, 'f1-score': 0.26089757609814007, 'support': 1556800}, 'weighted avg': {'precision': 0.44097038015969325, 'recall': 0.4735502312435766, 'f1-score': 0.34052661379977706, 'support': 1556800}}
[[ 17874 388699   4894]
 [ 20156 704214  14820]
 [  8742 382266  15135]]
Evaluating performance on  train set...
2440/2440 - 32s - 32s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.118609
{'0': {'precision': 0.4381280673054452, 'recall': 0.03719022609713399, 'f1-score': 0.06856071861214601, 'support': 201639}, '1': {'precision': 0.3557109525852821, 'recall': 0.9577363088656723, 'f1-score': 0.5187529103768915, 'support': 221585}, '2': {'precision': 0.4750943743670012, 'recall': 0.025625617671743782, 'f1-score': 0.048628323171019026, 'support': 201361}, 'accuracy': 0.3600454701922076, 'macro avg': {'precision': 0.42297779808590946, 'recall': 0.3401840508781833, 'f1-score': 0.21198065072001884, 'support': 624585}, 'weighted avg': {'precision': 0.42080644765552505, 'recall': 0.3600454701922076, 'f1-score': 0.22185007031570975, 'support': 624585}}
[[  7499 191961   2179]
 [  5843 212220   3522]
 [  3774 192427   5160]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0629498
{'0': {'precision': 0.4481018740989909, 'recall': 0.031081779244371114, 'f1-score': 0.05813138003584509, 'support': 60003}, '1': {'precision': 0.4393118019332393, 'recall': 0.9707689985335979, 'f1-score': 0.604887716881939, 'support': 92744}, '2': {'precision': 0.48822269807280516, 'recall': 0.019423761735189383, 'f1-score': 0.037361124766492976, 'support': 58691}, 'accuracy': 0.440024971859363, 'macro avg': {'precision': 0.45854545803501184, 'recall': 0.34042484650438615, 'f1-score': 0.233460073894759, 'support': 211438}, 'weighted avg': {'precision': 0.4553829911494107, 'recall': 0.440024971859363, 'f1-score': 0.2921921574383961, 'support': 211438}}
[[ 1865 57843   295]
 [ 1811 90033   900]
 [  486 57065  1140]]
training model: results/ATVI/W3/deepOF_L1/h50
Epoch 1/50
2440/2440 - 56s - loss: 3.2315 - accuracy50: 0.4101 - val_loss: 3.2735 - val_accuracy50: 0.3980 - 56s/epoch - 23ms/step
Epoch 2/50
2440/2440 - 54s - loss: 3.2247 - accuracy50: 0.4137 - val_loss: 3.2429 - val_accuracy50: 0.3985 - 54s/epoch - 22ms/step
Epoch 3/50
2440/2440 - 53s - loss: 3.2196 - accuracy50: 0.4159 - val_loss: 3.2715 - val_accuracy50: 0.3992 - 53s/epoch - 22ms/step
Epoch 4/50
2440/2440 - 53s - loss: 3.2109 - accuracy50: 0.4202 - val_loss: 3.2978 - val_accuracy50: 0.3987 - 53s/epoch - 22ms/step
Epoch 5/50
2440/2440 - 52s - loss: 3.2098 - accuracy50: 0.4210 - val_loss: 3.3049 - val_accuracy50: 0.3990 - 52s/epoch - 21ms/step
Epoch 6/50
2440/2440 - 52s - loss: 3.2028 - accuracy50: 0.4250 - val_loss: 3.3670 - val_accuracy50: 0.3990 - 52s/epoch - 21ms/step
Epoch 7/50
2440/2440 - 53s - loss: 3.1985 - accuracy50: 0.4272 - val_loss: 3.4005 - val_accuracy50: 0.3991 - 53s/epoch - 22ms/step
Epoch 8/50
2440/2440 - 53s - loss: 3.1952 - accuracy50: 0.4276 - val_loss: 3.4292 - val_accuracy50: 0.3996 - 53s/epoch - 22ms/step
Epoch 9/50
2440/2440 - 53s - loss: 3.1877 - accuracy50: 0.4324 - val_loss: 3.4467 - val_accuracy50: 0.4001 - 53s/epoch - 22ms/step
Epoch 10/50
2440/2440 - 51s - loss: 3.1807 - accuracy50: 0.4354 - val_loss: 3.4471 - val_accuracy50: 0.4001 - 51s/epoch - 21ms/step
Epoch 11/50
2440/2440 - 52s - loss: 3.1755 - accuracy50: 0.4375 - val_loss: 3.4510 - val_accuracy50: 0.4003 - 52s/epoch - 21ms/step
Epoch 12/50
2440/2440 - 52s - loss: 3.1710 - accuracy50: 0.4384 - val_loss: 3.4521 - val_accuracy50: 0.4007 - 52s/epoch - 21ms/step
testing model: results/ATVI/W3/deepOF_L1/h50
Evaluating performance on  test set...
6082/6082 - 79s - 79s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0585337
{'0': {'precision': 0.4074619538537064, 'recall': 0.038025252432699885, 'f1-score': 0.06955909589936558, 'support': 436552}, '1': {'precision': 0.4413482763223291, 'recall': 0.960787949759515, 'f1-score': 0.6048515082198221, 'support': 684866}, '2': {'precision': 0.4277704878921627, 'recall': 0.024709335709790482, 'f1-score': 0.046719981933898036, 'support': 435382}, 'accuracy': 0.44024216341212746, 'macro avg': {'precision': 0.42552690602273274, 'recall': 0.34117417930066846, 'f1-score': 0.24037686201769526, 'support': 1556800}, 'weighted avg': {'precision': 0.42804877315646006, 'recall': 0.44024216341212746, 'f1-score': 0.2986571394115371, 'support': 1556800}}
[[ 16600 415914   4038]
 [ 16502 658011  10353]
 [  7638 416986  10758]]
Evaluating performance on  train set...
2440/2440 - 32s - 32s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1170264
{'0': {'precision': 0.4504731861198738, 'recall': 0.034117787600047786, 'f1-score': 0.06343142698500832, 'support': 209275}, '1': {'precision': 0.33089292130794107, 'recall': 0.9636410321005359, 'f1-score': 0.49262824719952647, 'support': 206414}, '2': {'precision': 0.4685158406730643, 'recall': 0.01706112132352941, 'f1-score': 0.03292333131642517, 'support': 208896}, 'accuracy': 0.3356036408175028, 'macro avg': {'precision': 0.4166273160336264, 'recall': 0.3382733136747043, 'f1-score': 0.19632766850032002, 'support': 624585}, 'weighted avg': {'precision': 0.4169885484559097, 'recall': 0.3356036408175028, 'f1-score': 0.19506957598790656, 'support': 624585}}
[[  7140 200529   1606]
 [  5068 198909   2437]
 [  3642 201690   3564]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0815203
{'0': {'precision': 0.4616100511865984, 'recall': 0.03058565988869533, 'f1-score': 0.05737005710980988, 'support': 64867}, '1': {'precision': 0.39643013472107386, 'recall': 0.9723597408949384, 'f1-score': 0.5632313767762933, 'support': 83827}, '2': {'precision': 0.4954248366013072, 'recall': 0.012080836414637256, 'f1-score': 0.02358652021034944, 'support': 62744}, 'accuracy': 0.39847141951777826, 'macro avg': {'precision': 0.45115500750299314, 'recall': 0.3383420790660903, 'f1-score': 0.2147293180321509, 'support': 211438}, 'weighted avg': {'precision': 0.44580323329437926, 'recall': 0.39847141951777826, 'f1-score': 0.24789930258348328, 'support': 211438}}
[[ 1984 62681   202]
 [ 1747 81510   570]
 [  567 61419   758]]
training model: results/ATVI/W3/deepOF_L1/h100
Epoch 1/50
2440/2440 - 55s - loss: 3.2737 - accuracy100: 0.3813 - val_loss: 3.2931 - val_accuracy100: 0.3447 - 55s/epoch - 23ms/step
Epoch 2/50
2440/2440 - 52s - loss: 3.2614 - accuracy100: 0.3860 - val_loss: 3.2753 - val_accuracy100: 0.3561 - 52s/epoch - 21ms/step
Epoch 3/50
2440/2440 - 52s - loss: 3.2562 - accuracy100: 0.3921 - val_loss: 3.2754 - val_accuracy100: 0.3583 - 52s/epoch - 22ms/step
Epoch 4/50
2440/2440 - 53s - loss: 3.2516 - accuracy100: 0.3958 - val_loss: 3.2799 - val_accuracy100: 0.3530 - 53s/epoch - 22ms/step
Epoch 5/50
2440/2440 - 52s - loss: 3.2487 - accuracy100: 0.3984 - val_loss: 3.2888 - val_accuracy100: 0.3491 - 52s/epoch - 21ms/step
Epoch 6/50
2440/2440 - 51s - loss: 3.2462 - accuracy100: 0.4004 - val_loss: 3.2930 - val_accuracy100: 0.3478 - 51s/epoch - 21ms/step
Epoch 7/50
2440/2440 - 52s - loss: 3.2438 - accuracy100: 0.4023 - val_loss: 3.2944 - val_accuracy100: 0.3478 - 52s/epoch - 21ms/step
Epoch 8/50
2440/2440 - 52s - loss: 3.2420 - accuracy100: 0.4028 - val_loss: 3.2995 - val_accuracy100: 0.3460 - 52s/epoch - 22ms/step
Epoch 9/50
2440/2440 - 53s - loss: 3.2402 - accuracy100: 0.4038 - val_loss: 3.3014 - val_accuracy100: 0.3463 - 53s/epoch - 22ms/step
Epoch 10/50
2440/2440 - 53s - loss: 3.2383 - accuracy100: 0.4054 - val_loss: 3.3044 - val_accuracy100: 0.3469 - 53s/epoch - 22ms/step
Epoch 11/50
2440/2440 - 53s - loss: 3.2371 - accuracy100: 0.4061 - val_loss: 3.3130 - val_accuracy100: 0.3445 - 53s/epoch - 22ms/step
Epoch 12/50
2440/2440 - 52s - loss: 3.2353 - accuracy100: 0.4064 - val_loss: 3.3163 - val_accuracy100: 0.3449 - 52s/epoch - 21ms/step
testing model: results/ATVI/W3/deepOF_L1/h100
Evaluating performance on  test set...
6082/6082 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0884513
{'0': {'precision': 0.4125717360114778, 'recall': 0.1090941424040941, 'f1-score': 0.17255933954141073, 'support': 506095}, '1': {'precision': 0.3554830639739543, 'recall': 0.8067008528358155, 'f1-score': 0.4934993278235444, 'support': 549930}, '2': {'precision': 0.39558323572265236, 'recall': 0.13825170984973292, 'f1-score': 0.2048950117640095, 'support': 500775}, 'accuracy': 0.36489850976361765, 'macro avg': {'precision': 0.38787934523602813, 'recall': 0.3513489016965475, 'f1-score': 0.2903178930429882, 'support': 1556800}, 'weighted avg': {'precision': 0.3869408331044044, 'recall': 0.36489850976361765, 'f1-score': 0.29633080923132954, 'support': 1556800}}
[[ 55212 405001  45882]
 [ 46401 443629  59900]
 [ 32211 399331  69233]]
Evaluating performance on  train set...
2440/2440 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0956331
{'0': {'precision': 0.4094309903524316, 'recall': 0.09951998774844104, 'f1-score': 0.16011981073599674, 'support': 208953}, '1': {'precision': 0.33406285392380664, 'recall': 0.82596795014899, 'f1-score': 0.47572048898634695, 'support': 206054}, '2': {'precision': 0.40167578659370723, 'recall': 0.12329061256429587, 'f1-score': 0.1886705658145495, 'support': 209578}, 'accuracy': 0.34715531112658804, 'macro avg': {'precision': 0.38172321028998185, 'recall': 0.349592850153909, 'f1-score': 0.2748369551789644, 'support': 624585}, 'weighted avg': {'precision': 0.3819643908071178, 'recall': 0.34715531112658804, 'f1-score': 0.27381833424208574, 'support': 624585}}
[[ 20795 169600  18558]
 [ 15929 170194  19931]
 [ 14066 169673  25839]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0922762
{'0': {'precision': 0.42566624172888967, 'recall': 0.0974213626764477, 'f1-score': 0.1585546473108797, 'support': 71976}, '1': {'precision': 0.34495289983632266, 'recall': 0.8355513044442596, 'f1-score': 0.4883097313587608, 'support': 72138}, '2': {'precision': 0.3939993079926845, 'recall': 0.11839759966728061, 'f1-score': 0.18207983553195134, 'support': 67324}, 'accuracy': 0.3559341272618924, 'macro avg': {'precision': 0.3882061498526323, 'recall': 0.35045675559599604, 'f1-score': 0.2763147380671973, 'support': 211438}, 'weighted avg': {'precision': 0.38804555053666184, 'recall': 0.3559341272618924, 'f1-score': 0.27855049491084505, 'support': 211438}}
[[ 7012 59156  5808]
 [ 5411 60275  6452]
 [ 4050 55303  7971]]
training model: results/ATVI/W3/deepOF_L1/h200
Epoch 1/50
2440/2440 - 53s - loss: 3.2906 - accuracy200: 0.3636 - val_loss: 3.3136 - val_accuracy200: 0.3423 - 53s/epoch - 22ms/step
Epoch 2/50
2440/2440 - 50s - loss: 3.2772 - accuracy200: 0.3688 - val_loss: 3.3049 - val_accuracy200: 0.3420 - 50s/epoch - 21ms/step
Epoch 3/50
2440/2440 - 50s - loss: 3.2747 - accuracy200: 0.3712 - val_loss: 3.3020 - val_accuracy200: 0.3429 - 50s/epoch - 20ms/step
Epoch 4/50
2440/2440 - 50s - loss: 3.2724 - accuracy200: 0.3736 - val_loss: 3.3000 - val_accuracy200: 0.3437 - 50s/epoch - 21ms/step
Epoch 5/50
2440/2440 - 50s - loss: 3.2711 - accuracy200: 0.3752 - val_loss: 3.3009 - val_accuracy200: 0.3430 - 50s/epoch - 20ms/step
Epoch 6/50
2440/2440 - 49s - loss: 3.2708 - accuracy200: 0.3766 - val_loss: 3.3004 - val_accuracy200: 0.3433 - 49s/epoch - 20ms/step
Epoch 7/50
2440/2440 - 51s - loss: 3.2697 - accuracy200: 0.3776 - val_loss: 3.2999 - val_accuracy200: 0.3437 - 51s/epoch - 21ms/step
Epoch 8/50
2440/2440 - 49s - loss: 3.2689 - accuracy200: 0.3779 - val_loss: 3.2994 - val_accuracy200: 0.3440 - 49s/epoch - 20ms/step
Epoch 9/50
2440/2440 - 49s - loss: 3.2685 - accuracy200: 0.3791 - val_loss: 3.2992 - val_accuracy200: 0.3440 - 49s/epoch - 20ms/step
Epoch 10/50
2440/2440 - 50s - loss: 3.2677 - accuracy200: 0.3794 - val_loss: 3.2974 - val_accuracy200: 0.3439 - 50s/epoch - 20ms/step
Epoch 11/50
2440/2440 - 49s - loss: 3.2669 - accuracy200: 0.3800 - val_loss: 3.2991 - val_accuracy200: 0.3437 - 49s/epoch - 20ms/step
Epoch 12/50
2440/2440 - 50s - loss: 3.2667 - accuracy200: 0.3804 - val_loss: 3.2991 - val_accuracy200: 0.3434 - 50s/epoch - 20ms/step
Epoch 13/50
2440/2440 - 49s - loss: 3.2660 - accuracy200: 0.3806 - val_loss: 3.2983 - val_accuracy200: 0.3441 - 49s/epoch - 20ms/step
Epoch 14/50
2440/2440 - 50s - loss: 3.2655 - accuracy200: 0.3809 - val_loss: 3.2985 - val_accuracy200: 0.3443 - 50s/epoch - 20ms/step
Epoch 15/50
2440/2440 - 50s - loss: 3.2647 - accuracy200: 0.3823 - val_loss: 3.2975 - val_accuracy200: 0.3444 - 50s/epoch - 21ms/step
Epoch 16/50
2440/2440 - 50s - loss: 3.2644 - accuracy200: 0.3824 - val_loss: 3.2999 - val_accuracy200: 0.3447 - 50s/epoch - 20ms/step
Epoch 17/50
2440/2440 - 50s - loss: 3.2635 - accuracy200: 0.3832 - val_loss: 3.3010 - val_accuracy200: 0.3451 - 50s/epoch - 20ms/step
Epoch 18/50
2440/2440 - 51s - loss: 3.2629 - accuracy200: 0.3827 - val_loss: 3.3007 - val_accuracy200: 0.3456 - 51s/epoch - 21ms/step
Epoch 19/50
2440/2440 - 49s - loss: 3.2623 - accuracy200: 0.3845 - val_loss: 3.3004 - val_accuracy200: 0.3455 - 49s/epoch - 20ms/step
Epoch 20/50
2440/2440 - 50s - loss: 3.2617 - accuracy200: 0.3853 - val_loss: 3.2978 - val_accuracy200: 0.3467 - 50s/epoch - 20ms/step
testing model: results/ATVI/W3/deepOF_L1/h200
Evaluating performance on  test set...
6082/6082 - 81s - 81s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0962763
{'0': {'precision': 0.3909308548091818, 'recall': 0.005439425646813547, 'f1-score': 0.010729559821354376, 'support': 510348}, '1': {'precision': 0.349541033412286, 'recall': 0.9613941097684824, 'f1-score': 0.512682404454576, 'support': 543544}, '2': {'precision': 0.38565161762017913, 'recall': 0.0419539955618125, 'f1-score': 0.07567546241333672, 'support': 502908}, 'accuracy': 0.35099884378211715, 'macro avg': {'precision': 0.37537450194721567, 'recall': 0.3362625103257028, 'f1-score': 0.19969580889642238, 'support': 1556800}, 'weighted avg': {'precision': 0.37477453434566604, 'recall': 0.35099884378211715, 'f1-score': 0.20696239060504432, 'support': 1556800}}
[[  2776 492521  15051]
 [  2424 522560  18560]
 [  1901 479908  21099]]
Evaluating performance on  train set...
2440/2440 - 30s - 30s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1022391
{'0': {'precision': 0.4091246290801187, 'recall': 0.005299597845566932, 'f1-score': 0.010463654689908692, 'support': 208129}, '1': {'precision': 0.3304065525437485, 'recall': 0.9685278694892212, 'f1-score': 0.492723803407456, 'support': 205960}, '2': {'precision': 0.3908780434064118, 'recall': 0.03371085436302828, 'f1-score': 0.06206866389678549, 'support': 210496}, 'accuracy': 0.33250398264447595, 'macro avg': {'precision': 0.376803075010093, 'recall': 0.3358461072326055, 'f1-score': 0.18841870733138336, 'support': 624585}, 'weighted avg': {'precision': 0.37701753662448273, 'recall': 0.33250398264447595, 'f1-score': 0.18688311440776417, 'support': 624585}}
[[  1103 201618   5408]
 [   832 199478   5650]
 [   761 202639   7096]]
Evaluating performance on  val set...
826/826 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0995593
{'0': {'precision': 0.41578947368421054, 'recall': 0.004377095049450093, 'f1-score': 0.008662993118951667, 'support': 72194}, '1': {'precision': 0.3428287657560724, 'recall': 0.973161226125653, 'f1-score': 0.5070367770157153, 'support': 72358}, '2': {'precision': 0.3766332134065518, 'recall': 0.029737164728044732, 'f1-score': 0.05512214724181413, 'support': 66886}, 'accuracy': 0.34393533801870996, 'macro avg': {'precision': 0.3784171509489449, 'recall': 0.3357584953010493, 'f1-score': 0.19027397245882702, 'support': 211438}, 'weighted avg': {'precision': 0.3784343316132692, 'recall': 0.34393533801870996, 'f1-score': 0.19391255676344224, 'support': 211438}}
[[  316 70270  1608]
 [  258 70416  1684]
 [  186 64711  1989]]
training model: results/ATVI/W3/deepOF_L1/h300
Epoch 1/50
2440/2440 - 51s - loss: 3.2810 - accuracy300: 0.3768 - val_loss: 3.2993 - val_accuracy300: 0.3383 - 51s/epoch - 21ms/step
Epoch 2/50
2440/2440 - 51s - loss: 3.2691 - accuracy300: 0.3805 - val_loss: 3.3060 - val_accuracy300: 0.3371 - 51s/epoch - 21ms/step
Epoch 3/50
2440/2440 - 50s - loss: 3.2662 - accuracy300: 0.3827 - val_loss: 3.3085 - val_accuracy300: 0.3380 - 50s/epoch - 21ms/step
Epoch 4/50
2440/2440 - 49s - loss: 3.2625 - accuracy300: 0.3847 - val_loss: 3.3122 - val_accuracy300: 0.3368 - 49s/epoch - 20ms/step
Epoch 5/50
2440/2440 - 49s - loss: 3.2604 - accuracy300: 0.3862 - val_loss: 3.3137 - val_accuracy300: 0.3363 - 49s/epoch - 20ms/step
Epoch 6/50
2440/2440 - 49s - loss: 3.2589 - accuracy300: 0.3867 - val_loss: 3.3166 - val_accuracy300: 0.3357 - 49s/epoch - 20ms/step
Epoch 7/50
2440/2440 - 50s - loss: 3.2573 - accuracy300: 0.3880 - val_loss: 3.3176 - val_accuracy300: 0.3355 - 50s/epoch - 20ms/step
Epoch 8/50
2440/2440 - 50s - loss: 3.2560 - accuracy300: 0.3889 - val_loss: 3.3188 - val_accuracy300: 0.3355 - 50s/epoch - 20ms/step
Epoch 9/50
2440/2440 - 49s - loss: 3.2557 - accuracy300: 0.3886 - val_loss: 3.3173 - val_accuracy300: 0.3360 - 49s/epoch - 20ms/step
Epoch 10/50
2440/2440 - 50s - loss: 3.2542 - accuracy300: 0.3898 - val_loss: 3.3206 - val_accuracy300: 0.3355 - 50s/epoch - 21ms/step
Epoch 11/50
2440/2440 - 49s - loss: 3.2534 - accuracy300: 0.3898 - val_loss: 3.3208 - val_accuracy300: 0.3354 - 49s/epoch - 20ms/step
testing model: results/ATVI/W3/deepOF_L1/h300
Evaluating performance on  test set...
6082/6082 - 77s - 77s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1048123
{'0': {'precision': 0.3790408856225871, 'recall': 0.014969377895506432, 'f1-score': 0.02880131194588223, 'support': 544378}, '1': {'precision': 0.3072043737385164, 'recall': 0.8646934859479479, 'f1-score': 0.4533460294867064, 'support': 477368}, '2': {'precision': 0.3764408150486577, 'recall': 0.13483311964773648, 'f1-score': 0.19854988103740337, 'support': 535054}, 'accuracy': 0.3167195529290853, 'macro avg': {'precision': 0.3542286914699204, 'recall': 0.33816532783039693, 'f1-score': 0.226899074156664, 'support': 1556800}, 'weighted avg': {'precision': 0.35611974599903984, 'recall': 0.3167195529290853, 'f1-score': 0.21732181143825302, 'support': 1556800}}
[[  8149 474710  61519]
 [  6608 412777  57983]
 [  6742 456169  72143]]
Evaluating performance on  train set...
2440/2440 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1005348
{'0': {'precision': 0.3658446362515413, 'recall': 0.014259692698095343, 'f1-score': 0.027449474740839766, 'support': 208069}, '1': {'precision': 0.33154198844813, 'recall': 0.8717546002753379, 'f1-score': 0.48038572754652975, 'support': 206292}, '2': {'precision': 0.36860584454167344, 'recall': 0.12984245376360454, 'f1-score': 0.19203872293123583, 'support': 210224}, 'accuracy': 0.33638175748697136, 'macro avg': {'precision': 0.3553308230804482, 'recall': 0.33861891557901264, 'f1-score': 0.2332913084062018, 'support': 624585}, 'weighted avg': {'precision': 0.35544430712247704, 'recall': 0.33638175748697136, 'f1-score': 0.2324459693338403, 'support': 624585}}
[[  2967 182213  22889]
 [  2589 179836  23867]
 [  2554 180374  27296]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0999599
{'0': {'precision': 0.3682445024226612, 'recall': 0.013611440222632464, 'f1-score': 0.026252507672481367, 'support': 72586}, '1': {'precision': 0.3357794363786044, 'recall': 0.8699625679779646, 'f1-score': 0.48454070554174405, 'support': 70795}, '2': {'precision': 0.3564774611194442, 'recall': 0.1326975917245838, 'f1-score': 0.19340193380518467, 'support': 68057}, 'accuracy': 0.33867138357343524, 'macro avg': {'precision': 0.3535004666402366, 'recall': 0.33875719997506026, 'f1-score': 0.2347317156731367, 'support': 211438}, 'weighted avg': {'precision': 0.35358680664157155, 'recall': 0.33867138357343524, 'f1-score': 0.233500975130875, 'support': 211438}}
[[  988 63604  7994]
 [  897 61589  8309]
 [  798 58228  9031]]
training model: results/ATVI/W3/deepOF_L1/h500
Epoch 1/50
2440/2440 - 52s - loss: 3.2760 - accuracy500: 0.3805 - val_loss: 3.5745 - val_accuracy500: 0.2947 - 52s/epoch - 21ms/step
Epoch 2/50
2440/2440 - 50s - loss: 3.2686 - accuracy500: 0.3794 - val_loss: 3.5413 - val_accuracy500: 0.2946 - 50s/epoch - 20ms/step
Epoch 3/50
2440/2440 - 50s - loss: 3.2653 - accuracy500: 0.3802 - val_loss: 3.5469 - val_accuracy500: 0.2946 - 50s/epoch - 21ms/step
Epoch 4/50
2440/2440 - 49s - loss: 3.2630 - accuracy500: 0.3829 - val_loss: 3.5111 - val_accuracy500: 0.2946 - 49s/epoch - 20ms/step
Epoch 5/50
2440/2440 - 49s - loss: 3.2614 - accuracy500: 0.3851 - val_loss: 3.4841 - val_accuracy500: 0.2946 - 49s/epoch - 20ms/step
Epoch 6/50
2440/2440 - 50s - loss: 3.2593 - accuracy500: 0.3852 - val_loss: 3.5466 - val_accuracy500: 0.2946 - 50s/epoch - 20ms/step
Epoch 7/50
2440/2440 - 49s - loss: 3.2587 - accuracy500: 0.3856 - val_loss: 3.5018 - val_accuracy500: 0.2946 - 49s/epoch - 20ms/step
Epoch 8/50
2440/2440 - 50s - loss: 3.2585 - accuracy500: 0.3851 - val_loss: 3.4895 - val_accuracy500: 0.2946 - 50s/epoch - 20ms/step
Epoch 9/50
2440/2440 - 49s - loss: 3.2572 - accuracy500: 0.3869 - val_loss: 3.4939 - val_accuracy500: 0.2947 - 49s/epoch - 20ms/step
Epoch 10/50
2440/2440 - 49s - loss: 3.2569 - accuracy500: 0.3867 - val_loss: 3.5035 - val_accuracy500: 0.2946 - 49s/epoch - 20ms/step
Epoch 11/50
2440/2440 - 50s - loss: 3.2559 - accuracy500: 0.3868 - val_loss: 3.5100 - val_accuracy500: 0.2946 - 50s/epoch - 21ms/step
Epoch 12/50
2440/2440 - 49s - loss: 3.2552 - accuracy500: 0.3871 - val_loss: 3.5159 - val_accuracy500: 0.2946 - 49s/epoch - 20ms/step
Epoch 13/50
2440/2440 - 49s - loss: 3.2547 - accuracy500: 0.3872 - val_loss: 3.5225 - val_accuracy500: 0.2946 - 49s/epoch - 20ms/step
Epoch 14/50
2440/2440 - 50s - loss: 3.2543 - accuracy500: 0.3876 - val_loss: 3.5300 - val_accuracy500: 0.2946 - 50s/epoch - 21ms/step
Epoch 15/50
2440/2440 - 50s - loss: 3.2541 - accuracy500: 0.3881 - val_loss: 3.5319 - val_accuracy500: 0.2946 - 50s/epoch - 20ms/step
testing model: results/ATVI/W3/deepOF_L1/h500
Evaluating performance on  test set...
6082/6082 - 75s - 75s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1915979
{'0': {'precision': 0.5, 'recall': 8.389669967162831e-06, 'f1-score': 1.6779058392801113e-05, 'support': 595971}, '1': {'precision': 0.24494739947666225, 'recall': 0.9993182026773656, 'f1-score': 0.3934536076087899, 'support': 381345}, '2': {'precision': 0.43892750744786496, 'recall': 0.000762747547818404, 'f1-score': 0.0015228487607904344, 'support': 579484}, 'accuracy': 0.24507451181911613, 'macro avg': {'precision': 0.3946249689748424, 'recall': 0.3333631132983837, 'f1-score': 0.1316644118093244, 'support': 1556800}, 'weighted avg': {'precision': 0.4147908747297959, 'recall': 0.24507451181911613, 'f1-score': 0.09695145960758046, 'support': 1556800}}
[[     5 595659    307]
 [     2 381085    258]
 [     3 579039    442]]
Evaluating performance on  train set...
2440/2440 - 30s - 30s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1401814
{'0': {'precision': 0.5, 'recall': 4.822112278062282e-06, 'f1-score': 9.644131545954286e-06, 'support': 207378}, '1': {'precision': 0.3307507278591492, 'recall': 0.9996902166547271, 'f1-score': 0.49705064799104726, 'support': 206596}, '2': {'precision': 0.3288590604026846, 'recall': 0.0002326564139574856, 'f1-score': 0.00046498386790662366, 'support': 210611}, 'accuracy': 0.3307508185435129, 'macro avg': {'precision': 0.386536596087278, 'recall': 0.33330923172698756, 'f1-score': 0.16584175866349996, 'support': 624585}, 'weighted avg': {'precision': 0.3863078891476078, 'recall': 0.3307508185435129, 'f1-score': 0.16457104536688172, 'support': 624585}}
[[     1 207340     37]
 [     1 206532     63]
 [     0 210562     49]]
Evaluating performance on  val set...
826/826 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1626301
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 77616}, '1': {'precision': 0.2946415479867375, 'recall': 0.9999518435879737, 'f1-score': 0.45516586292561745, 'support': 62297}, '2': {'precision': 0.5333333333333333, 'recall': 0.00011184900384480951, 'f1-score': 0.00022365110427732742, 'support': 71525}, 'accuracy': 0.2946584814460977, 'macro avg': {'precision': 0.2759916271066903, 'recall': 0.33335456419727283, 'f1-score': 0.15179650467663158, 'support': 211438}, 'weighted avg': {'precision': 0.26722704140975817, 'recall': 0.2946584814460977, 'f1-score': 0.13418337483286177, 'support': 211438}}
[[    0 77612     4]
 [    0 62294     3]
 [    0 71517     8]]
training model: results/ATVI/W3/deepOF_L1/h1000
Epoch 1/50
2440/2440 - 52s - loss: 3.2927 - accuracy1000: 0.3679 - val_loss: 3.3349 - val_accuracy1000: 0.3481 - 52s/epoch - 21ms/step
Epoch 2/50
2440/2440 - 50s - loss: 3.2816 - accuracy1000: 0.3660 - val_loss: 3.3293 - val_accuracy1000: 0.3482 - 50s/epoch - 21ms/step
Epoch 3/50
2440/2440 - 50s - loss: 3.2778 - accuracy1000: 0.3712 - val_loss: 3.3310 - val_accuracy1000: 0.3480 - 50s/epoch - 20ms/step
Epoch 4/50
2440/2440 - 49s - loss: 3.2745 - accuracy1000: 0.3740 - val_loss: 3.3387 - val_accuracy1000: 0.3482 - 49s/epoch - 20ms/step
Epoch 5/50
2440/2440 - 50s - loss: 3.2728 - accuracy1000: 0.3758 - val_loss: 3.3485 - val_accuracy1000: 0.3483 - 50s/epoch - 21ms/step
Epoch 6/50
2440/2440 - 50s - loss: 3.2711 - accuracy1000: 0.3775 - val_loss: 3.3477 - val_accuracy1000: 0.3483 - 50s/epoch - 20ms/step
Epoch 7/50
2440/2440 - 50s - loss: 3.2695 - accuracy1000: 0.3789 - val_loss: 3.3466 - val_accuracy1000: 0.3482 - 50s/epoch - 20ms/step
Epoch 8/50
2440/2440 - 50s - loss: 3.2687 - accuracy1000: 0.3792 - val_loss: 3.3392 - val_accuracy1000: 0.3483 - 50s/epoch - 20ms/step
Epoch 9/50
2440/2440 - 50s - loss: 3.2678 - accuracy1000: 0.3797 - val_loss: 3.3395 - val_accuracy1000: 0.3483 - 50s/epoch - 21ms/step
Epoch 10/50
2440/2440 - 50s - loss: 3.2669 - accuracy1000: 0.3805 - val_loss: 3.3411 - val_accuracy1000: 0.3483 - 50s/epoch - 20ms/step
Epoch 11/50
2440/2440 - 49s - loss: 3.2663 - accuracy1000: 0.3820 - val_loss: 3.3400 - val_accuracy1000: 0.3483 - 49s/epoch - 20ms/step
Epoch 12/50
2440/2440 - 51s - loss: 3.2658 - accuracy1000: 0.3825 - val_loss: 3.3418 - val_accuracy1000: 0.3483 - 51s/epoch - 21ms/step
testing model: results/ATVI/W3/deepOF_L1/h1000
Evaluating performance on  test set...
6082/6082 - 75s - 75s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1040537
{'0': {'precision': 0.29961089494163423, 'recall': 0.0006073920400089925, 'f1-score': 0.001212326367704885, 'support': 507086}, '1': {'precision': 0.35278019355917395, 'recall': 0.9909456136103411, 'f1-score': 0.5203233926309032, 'support': 549347}, '2': {'precision': 0.34555923647262976, 'recall': 0.008755573409117708, 'f1-score': 0.017078423919929052, 'support': 500367}, 'accuracy': 0.35268627954779036, 'macro avg': {'precision': 0.33265010832447933, 'recall': 0.33343619301982264, 'f1-score': 0.1795380476395124, 'support': 1556800}, 'weighted avg': {'precision': 0.3331408464411777, 'recall': 0.35268627954779036, 'f1-score': 0.189490190288827, 'support': 1556800}}
[[   308 503087   3691]
 [   368 544373   4606]
 [   352 495634   4381]]
Evaluating performance on  train set...
2440/2440 - 30s - 30s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1078601
{'0': {'precision': 0.33668341708542715, 'recall': 0.0003265823401818138, 'f1-score': 0.0006525317257029326, 'support': 205155}, '1': {'precision': 0.32985002715206285, 'recall': 0.9929614017045924, 'f1-score': 0.49520035610261176, 'support': 206149}, '2': {'precision': 0.3301812450748621, 'recall': 0.00589363328191447, 'f1-score': 0.011580557193396228, 'support': 213281}, 'accuracy': 0.3298542232042076, 'macro avg': {'precision': 0.332238229770784, 'recall': 0.3330605391088962, 'f1-score': 0.16914448167390364, 'support': 624585}, 'weighted avg': {'precision': 0.33220766718756145, 'recall': 0.3298542232042076, 'f1-score': 0.16761344120519808, 'support': 624585}}
[[    67 203924   1164]
 [    65 204698   1386]
 [    67 211957   1257]]
Evaluating performance on  val set...
826/826 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1080549
{'0': {'precision': 0.375, 'recall': 0.0001227730335852454, 'f1-score': 0.00024546570298649936, 'support': 73306}, '1': {'precision': 0.3481765032746477, 'recall': 0.9953025510134814, 'f1-score': 0.5158859169499039, 'support': 73657}, '2': {'precision': 0.25787631271878647, 'recall': 0.0034276851492826676, 'f1-score': 0.006765444192738628, 'support': 64475}, 'accuracy': 0.3478135434500894, 'macro avg': {'precision': 0.3270176053311447, 'recall': 0.3329510030654498, 'f1-score': 0.17429894228187634, 'support': 211438}, 'weighted avg': {'precision': 0.32994051194319135, 'recall': 0.3478135434500894, 'f1-score': 0.1818632653918833, 'support': 211438}}
[[    9 73000   297]
 [    7 73311   339]
 [    8 64246   221]]
training model: results/ATVI/W3/deepLOB_L2/h10
Epoch 1/50
2440/2440 - 116s - loss: 3.0571 - accuracy10: 0.4478 - val_loss: 2.9546 - val_accuracy10: 0.5837 - 116s/epoch - 48ms/step
Epoch 2/50
2440/2440 - 113s - loss: 2.9147 - accuracy10: 0.4853 - val_loss: 2.8138 - val_accuracy10: 0.6087 - 113s/epoch - 46ms/step
Epoch 3/50
2440/2440 - 112s - loss: 2.8277 - accuracy10: 0.5242 - val_loss: 2.7118 - val_accuracy10: 0.6057 - 112s/epoch - 46ms/step
Epoch 4/50
2440/2440 - 112s - loss: 2.7685 - accuracy10: 0.5466 - val_loss: 2.6536 - val_accuracy10: 0.6131 - 112s/epoch - 46ms/step
Epoch 5/50
2440/2440 - 113s - loss: 2.7292 - accuracy10: 0.5578 - val_loss: 2.6077 - val_accuracy10: 0.6105 - 113s/epoch - 46ms/step
Epoch 6/50
2440/2440 - 113s - loss: 2.7038 - accuracy10: 0.5649 - val_loss: 2.5751 - val_accuracy10: 0.6046 - 113s/epoch - 46ms/step
Epoch 7/50
2440/2440 - 112s - loss: 2.6839 - accuracy10: 0.5699 - val_loss: 2.5649 - val_accuracy10: 0.5990 - 112s/epoch - 46ms/step
Epoch 8/50
2440/2440 - 113s - loss: 2.6672 - accuracy10: 0.5729 - val_loss: 2.5592 - val_accuracy10: 0.6005 - 113s/epoch - 46ms/step
Epoch 9/50
2440/2440 - 113s - loss: 2.6541 - accuracy10: 0.5759 - val_loss: 2.4890 - val_accuracy10: 0.6134 - 113s/epoch - 46ms/step
Epoch 10/50
2440/2440 - 113s - loss: 2.6421 - accuracy10: 0.5780 - val_loss: 2.4905 - val_accuracy10: 0.6102 - 113s/epoch - 46ms/step
Epoch 11/50
2440/2440 - 114s - loss: 2.6310 - accuracy10: 0.5801 - val_loss: 2.5322 - val_accuracy10: 0.6052 - 114s/epoch - 47ms/step
Epoch 12/50
2440/2440 - 113s - loss: 2.6233 - accuracy10: 0.5811 - val_loss: 2.5649 - val_accuracy10: 0.5740 - 113s/epoch - 46ms/step
Epoch 13/50
2440/2440 - 112s - loss: 2.6147 - accuracy10: 0.5823 - val_loss: 2.5377 - val_accuracy10: 0.5936 - 112s/epoch - 46ms/step
Epoch 14/50
2440/2440 - 112s - loss: 2.6081 - accuracy10: 0.5836 - val_loss: 2.5772 - val_accuracy10: 0.5627 - 112s/epoch - 46ms/step
Epoch 15/50
2440/2440 - 112s - loss: 2.6010 - accuracy10: 0.5846 - val_loss: 2.6166 - val_accuracy10: 0.5685 - 112s/epoch - 46ms/step
Epoch 16/50
2440/2440 - 112s - loss: 2.5958 - accuracy10: 0.5857 - val_loss: 2.5797 - val_accuracy10: 0.5601 - 112s/epoch - 46ms/step
Epoch 17/50
2440/2440 - 112s - loss: 2.5887 - accuracy10: 0.5870 - val_loss: 2.6023 - val_accuracy10: 0.5699 - 112s/epoch - 46ms/step
Epoch 18/50
2440/2440 - 112s - loss: 2.5842 - accuracy10: 0.5871 - val_loss: 2.5447 - val_accuracy10: 0.5752 - 112s/epoch - 46ms/step
Epoch 19/50
2440/2440 - 112s - loss: 2.5800 - accuracy10: 0.5880 - val_loss: 2.5922 - val_accuracy10: 0.5688 - 112s/epoch - 46ms/step
testing model: results/ATVI/W3/deepLOB_L2/h10
Evaluating performance on  test set...
6082/6082 - 114s - 114s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8366592
{'0': {'precision': 0.43569288817323953, 'recall': 0.42825581479576685, 'f1-score': 0.43194234144719895, 'support': 276106}, '1': {'precision': 0.8058762195576078, 'recall': 0.6239501228833443, 'f1-score': 0.7033393514954067, 'support': 1005832}, '2': {'precision': 0.36053844407820074, 'recall': 0.6645601856904819, 'f1-score': 0.46746622888225503, 'support': 274866}, 'accuracy': 0.5964129074694052, 'macro avg': {'precision': 0.534035850603016, 'recall': 0.572255374456531, 'f1-score': 0.5342493072749536, 'support': 1556804}, 'weighted avg': {'precision': 0.6615946967132837, 'recall': 0.5964129074694052, 'f1-score': 0.6135606480898675, 'support': 1556804}}
[[118244  84294  73568]
 [127831 627589 250412]
 [ 25318  66883 182665]]
Evaluating performance on  train set...
2440/2440 - 45s - 45s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89434737
{'0': {'precision': 0.48820913251259196, 'recall': 0.36968344721796126, 'f1-score': 0.4207585875780193, 'support': 143420}, '1': {'precision': 0.700023492173397, 'recall': 0.6704045233196667, 'f1-score': 0.6848939313521352, 'support': 337805}, '2': {'precision': 0.4254860396728909, 'recall': 0.5712462158731044, 'f1-score': 0.4877082861873057, 'support': 143362}, 'accuracy': 0.5785919335496896, 'macro avg': {'precision': 0.53790622145296, 'recall': 0.5371113954702441, 'f1-score': 0.5311202683724867, 'support': 624587}, 'weighted avg': {'precision': 0.588371066285682, 'recall': 0.5785919335496896, 'f1-score': 0.5789819935977407, 'support': 624587}}
[[ 53020  51005  39395]
 [ 40155 226466  71184]
 [ 15426  46041  81895]]
Evaluating performance on  val set...
826/826 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8161581
{'0': {'precision': 0.4807230362719193, 'recall': 0.4009014648804307, 'f1-score': 0.4371987602233783, 'support': 39935}, '1': {'precision': 0.7863751798113978, 'recall': 0.6691095916285746, 'f1-score': 0.7230184550950512, 'support': 132355}, '2': {'precision': 0.3797393003235851, 'recall': 0.6355113926637376, 'f1-score': 0.47540701673928004, 'support': 39148}, 'accuracy': 0.6122314815690652, 'macro avg': {'precision': 0.5489458388023007, 'recall': 0.5685074830575809, 'f1-score': 0.5452080773525699, 'support': 211438}, 'weighted avg': {'precision': 0.6533565182536931, 'recall': 0.6122314815690652, 'f1-score': 0.6231891807760926, 'support': 211438}}
[[16010 13232 10693]
 [13851 88560 29944]
 [ 3443 10826 24879]]
training model: results/ATVI/W3/deepLOB_L2/h20
Epoch 1/50
2440/2440 - 116s - loss: 3.0947 - accuracy20: 0.4559 - val_loss: 3.1448 - val_accuracy20: 0.5072 - 116s/epoch - 47ms/step
Epoch 2/50
2440/2440 - 112s - loss: 2.9746 - accuracy20: 0.4977 - val_loss: 3.0383 - val_accuracy20: 0.5142 - 112s/epoch - 46ms/step
Epoch 3/50
2440/2440 - 112s - loss: 2.9093 - accuracy20: 0.5171 - val_loss: 2.9209 - val_accuracy20: 0.5325 - 112s/epoch - 46ms/step
Epoch 4/50
2440/2440 - 113s - loss: 2.8649 - accuracy20: 0.5305 - val_loss: 2.8473 - val_accuracy20: 0.5376 - 113s/epoch - 46ms/step
Epoch 5/50
2440/2440 - 114s - loss: 2.8329 - accuracy20: 0.5397 - val_loss: 2.8680 - val_accuracy20: 0.5222 - 114s/epoch - 47ms/step
Epoch 6/50
2440/2440 - 114s - loss: 2.8088 - accuracy20: 0.5460 - val_loss: 2.8058 - val_accuracy20: 0.5179 - 114s/epoch - 47ms/step
Epoch 7/50
2440/2440 - 113s - loss: 2.7898 - accuracy20: 0.5513 - val_loss: 2.8301 - val_accuracy20: 0.5137 - 113s/epoch - 46ms/step
Epoch 8/50
2440/2440 - 113s - loss: 2.7753 - accuracy20: 0.5548 - val_loss: 2.8187 - val_accuracy20: 0.5167 - 113s/epoch - 46ms/step
Epoch 9/50
2440/2440 - 113s - loss: 2.7629 - accuracy20: 0.5582 - val_loss: 2.8654 - val_accuracy20: 0.5077 - 113s/epoch - 46ms/step
Epoch 10/50
2440/2440 - 112s - loss: 2.7524 - accuracy20: 0.5606 - val_loss: 2.8455 - val_accuracy20: 0.5175 - 112s/epoch - 46ms/step
Epoch 11/50
2440/2440 - 112s - loss: 2.7433 - accuracy20: 0.5630 - val_loss: 2.8417 - val_accuracy20: 0.5263 - 112s/epoch - 46ms/step
Epoch 12/50
2440/2440 - 112s - loss: 2.7343 - accuracy20: 0.5649 - val_loss: 2.9495 - val_accuracy20: 0.5035 - 112s/epoch - 46ms/step
Epoch 13/50
2440/2440 - 112s - loss: 2.7274 - accuracy20: 0.5659 - val_loss: 2.9010 - val_accuracy20: 0.5153 - 112s/epoch - 46ms/step
Epoch 14/50
2440/2440 - 112s - loss: 2.7203 - accuracy20: 0.5676 - val_loss: 2.8662 - val_accuracy20: 0.5194 - 112s/epoch - 46ms/step
Epoch 15/50
2440/2440 - 113s - loss: 2.7135 - accuracy20: 0.5688 - val_loss: 2.9617 - val_accuracy20: 0.5069 - 113s/epoch - 46ms/step
Epoch 16/50
2440/2440 - 113s - loss: 2.7093 - accuracy20: 0.5694 - val_loss: 2.8705 - val_accuracy20: 0.5228 - 113s/epoch - 46ms/step
testing model: results/ATVI/W3/deepLOB_L2/h20
Evaluating performance on  test set...
6082/6082 - 109s - 109s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91610706
{'0': {'precision': 0.4571249215317012, 'recall': 0.40797118094267004, 'f1-score': 0.43115162244333066, 'support': 356986}, '1': {'precision': 0.7037575865886844, 'recall': 0.5957678924326522, 'f1-score': 0.645275803997601, 'support': 846056}, '2': {'precision': 0.3982811371469406, 'recall': 0.5876606305934499, 'f1-score': 0.4747828966525262, 'support': 353762}, 'accuracy': 0.5508625363244185, 'macro avg': {'precision': 0.5197212150891087, 'recall': 0.5304665679895907, 'f1-score': 0.5170701076978194, 'support': 1556804}, 'weighted avg': {'precision': 0.5777877353579306, 'recall': 0.5508625363244185, 'f1-score': 0.5574335020992623, 'support': 1556804}}
[[145640 116810  94536]
 [122458 504053 219545]
 [ 50502  95368 207892]]
Evaluating performance on  train set...
2440/2440 - 45s - 45s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9988215
{'0': {'precision': 0.49168316144042784, 'recall': 0.31546465254105116, 'f1-score': 0.38433767643865363, 'support': 179532}, '1': {'precision': 0.5804286560452122, 'recall': 0.5788911256184975, 'f1-score': 0.5796588712685513, 'support': 265765}, '2': {'precision': 0.4313287331483437, 'recall': 0.5878186178816442, 'f1-score': 0.49755917927993426, 'support': 179290}, 'accuracy': 0.5057341891521918, 'macro avg': {'precision': 0.501146850211328, 'recall': 0.49405813201373094, 'f1-score': 0.4871852423290464, 'support': 624587}, 'weighted avg': {'precision': 0.5121198674960338, 'recall': 0.5057341891521918, 'f1-score': 0.4999485050155868, 'support': 624587}}
[[ 56636  62060  60836]
 [ 33804 153849  78112]
 [ 24748  49152 105390]]
Evaluating performance on  val set...
826/826 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95092857
{'0': {'precision': 0.4822729984179267, 'recall': 0.35837493013664307, 'f1-score': 0.41119366679934544, 'support': 51887}, '1': {'precision': 0.687411885588664, 'recall': 0.5297491897466117, 'f1-score': 0.5983692656495376, 'support': 108608}, '2': {'precision': 0.37491450164268975, 'recall': 0.656341401173861, 'f1-score': 0.4772276379829582, 'support': 50943}, 'accuracy': 0.518194458895752, 'macro avg': {'precision': 0.5148664618830935, 'recall': 0.514821840352372, 'f1-score': 0.4955968568106138, 'support': 211438}, 'weighted avg': {'precision': 0.5617788599783772, 'recall': 0.518194458895752, 'f1-score': 0.5232489077396137, 'support': 211438}}
[[18595 15110 18182]
 [13508 57535 37565]
 [ 6454 11053 33436]]
training model: results/ATVI/W3/deepLOB_L2/h30
Epoch 1/50
2440/2440 - 115s - loss: 3.1276 - accuracy30: 0.4434 - val_loss: 3.2712 - val_accuracy30: 0.4235 - 115s/epoch - 47ms/step
Epoch 2/50
2440/2440 - 113s - loss: 3.0130 - accuracy30: 0.4853 - val_loss: 3.2327 - val_accuracy30: 0.4528 - 113s/epoch - 46ms/step
Epoch 3/50
2440/2440 - 112s - loss: 2.9617 - accuracy30: 0.5013 - val_loss: 3.1792 - val_accuracy30: 0.4813 - 112s/epoch - 46ms/step
Epoch 4/50
2440/2440 - 112s - loss: 2.9241 - accuracy30: 0.5131 - val_loss: 3.1415 - val_accuracy30: 0.5068 - 112s/epoch - 46ms/step
Epoch 5/50
2440/2440 - 113s - loss: 2.8947 - accuracy30: 0.5209 - val_loss: 3.0452 - val_accuracy30: 0.5177 - 113s/epoch - 46ms/step
Epoch 6/50
2440/2440 - 113s - loss: 2.8742 - accuracy30: 0.5262 - val_loss: 2.9796 - val_accuracy30: 0.5226 - 113s/epoch - 46ms/step
Epoch 7/50
2440/2440 - 113s - loss: 2.8570 - accuracy30: 0.5308 - val_loss: 2.9815 - val_accuracy30: 0.5213 - 113s/epoch - 46ms/step
Epoch 8/50
2440/2440 - 112s - loss: 2.8428 - accuracy30: 0.5341 - val_loss: 2.9926 - val_accuracy30: 0.5085 - 112s/epoch - 46ms/step
Epoch 9/50
2440/2440 - 113s - loss: 2.8304 - accuracy30: 0.5371 - val_loss: 2.9846 - val_accuracy30: 0.5126 - 113s/epoch - 46ms/step
Epoch 10/50
2440/2440 - 112s - loss: 2.8205 - accuracy30: 0.5393 - val_loss: 2.9895 - val_accuracy30: 0.5113 - 112s/epoch - 46ms/step
Epoch 11/50
2440/2440 - 112s - loss: 2.8129 - accuracy30: 0.5413 - val_loss: 2.9753 - val_accuracy30: 0.5094 - 112s/epoch - 46ms/step
Epoch 12/50
2440/2440 - 112s - loss: 2.8057 - accuracy30: 0.5426 - val_loss: 3.0013 - val_accuracy30: 0.5053 - 112s/epoch - 46ms/step
Epoch 13/50
2440/2440 - 112s - loss: 2.8000 - accuracy30: 0.5438 - val_loss: 3.0019 - val_accuracy30: 0.5086 - 112s/epoch - 46ms/step
Epoch 14/50
2440/2440 - 113s - loss: 2.7942 - accuracy30: 0.5456 - val_loss: 2.9960 - val_accuracy30: 0.5103 - 113s/epoch - 46ms/step
Epoch 15/50
2440/2440 - 112s - loss: 2.7891 - accuracy30: 0.5465 - val_loss: 2.9858 - val_accuracy30: 0.5152 - 112s/epoch - 46ms/step
Epoch 16/50
2440/2440 - 112s - loss: 2.7834 - accuracy30: 0.5476 - val_loss: 3.0066 - val_accuracy30: 0.5092 - 112s/epoch - 46ms/step
Epoch 17/50
2440/2440 - 112s - loss: 2.7794 - accuracy30: 0.5486 - val_loss: 3.0560 - val_accuracy30: 0.5053 - 112s/epoch - 46ms/step
Epoch 18/50
2440/2440 - 113s - loss: 2.7755 - accuracy30: 0.5498 - val_loss: 3.0429 - val_accuracy30: 0.5078 - 113s/epoch - 46ms/step
Epoch 19/50
2440/2440 - 113s - loss: 2.7717 - accuracy30: 0.5506 - val_loss: 3.0481 - val_accuracy30: 0.5047 - 113s/epoch - 46ms/step
Epoch 20/50
2440/2440 - 112s - loss: 2.7680 - accuracy30: 0.5517 - val_loss: 3.0904 - val_accuracy30: 0.5039 - 112s/epoch - 46ms/step
Epoch 21/50
2440/2440 - 113s - loss: 2.7638 - accuracy30: 0.5521 - val_loss: 3.0255 - val_accuracy30: 0.5125 - 113s/epoch - 46ms/step
testing model: results/ATVI/W3/deepLOB_L2/h30
Evaluating performance on  test set...
6082/6082 - 109s - 109s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9593797
{'0': {'precision': 0.4689076013205598, 'recall': 0.4501213943213219, 'f1-score': 0.45932248996531727, 'support': 411469}, '1': {'precision': 0.63573456974074, 'recall': 0.5887531098187072, 'f1-score': 0.6113425413782567, 'support': 739191}, '2': {'precision': 0.4340794039257757, 'recall': 0.5100826307910494, 'f1-score': 0.4690219606067466, 'support': 406144}, 'accuracy': 0.5315884337398927, 'macro avg': {'precision': 0.5129071916623585, 'recall': 0.5163190449770262, 'f1-score': 0.5132289973167735, 'support': 1556804}, 'weighted avg': {'precision': 0.5390331471251533, 'recall': 0.5315884337398927, 'f1-score': 0.5340340372302105, 'support': 1556804}}
[[185211 126345  99913]
 [133814 435201 170176]
 [ 75959 123018 207167]]
Evaluating performance on  train set...
2440/2440 - 44s - 44s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0357205
{'0': {'precision': 0.5169432748824795, 'recall': 0.3657483593393739, 'f1-score': 0.42839684286000423, 'support': 201748}, '1': {'precision': 0.503571643633517, 'recall': 0.6044798033874108, 'f1-score': 0.5494309654185479, 'support': 221349}, '2': {'precision': 0.464990608026205, 'recall': 0.4988039108640627, 'f1-score': 0.48130411462723166, 'support': 201490}, 'accuracy': 0.4932763570167166, 'macro avg': {'precision': 0.4951685088474005, 'recall': 0.4896773578636158, 'f1-score': 0.48637730763526127, 'support': 624587}, 'weighted avg': {'precision': 0.49544468453366125, 'recall': 0.4932763570167166, 'f1-score': 0.4883581744000295, 'support': 624587}}
[[ 73789  66961  60998]
 [ 32908 133801  54640]
 [ 36044  64942 100504]]
Evaluating performance on  val set...
826/826 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9939237
{'0': {'precision': 0.5143224299065421, 'recall': 0.3669016784172542, 'f1-score': 0.42828098096247946, 'support': 59997}, '1': {'precision': 0.5952007049811892, 'recall': 0.5680597787410235, 'f1-score': 0.5813136189346501, 'support': 92742}, '2': {'precision': 0.4117067082683307, 'recall': 0.5619857237772364, 'f1-score': 0.4752492364432663, 'support': 58699}, 'accuracy': 0.5092935044788544, 'macro avg': {'precision': 0.507076614385354, 'recall': 0.4989823936451714, 'f1-score': 0.49494794544679865, 'support': 211438}, 'weighted avg': {'precision': 0.5213096920946614, 'recall': 0.5092935044788544, 'f1-score': 0.5084441613713073, 'support': 211438}}
[[22013 18413 19571]
 [12493 52683 27566]
 [ 8294 17417 32988]]
training model: results/ATVI/W3/deepLOB_L2/h50
Epoch 1/50
2440/2440 - 115s - loss: 3.1703 - accuracy50: 0.4274 - val_loss: 3.3633 - val_accuracy50: 0.3982 - 115s/epoch - 47ms/step
Epoch 2/50
2440/2440 - 112s - loss: 3.1022 - accuracy50: 0.4534 - val_loss: 3.4384 - val_accuracy50: 0.4027 - 112s/epoch - 46ms/step
Epoch 3/50
2440/2440 - 113s - loss: 3.0723 - accuracy50: 0.4655 - val_loss: 3.6736 - val_accuracy50: 0.4110 - 113s/epoch - 46ms/step
Epoch 4/50
2440/2440 - 113s - loss: 3.0489 - accuracy50: 0.4747 - val_loss: 3.7181 - val_accuracy50: 0.4214 - 113s/epoch - 46ms/step
Epoch 5/50
2440/2440 - 113s - loss: 3.0291 - accuracy50: 0.4809 - val_loss: 3.7911 - val_accuracy50: 0.4211 - 113s/epoch - 46ms/step
Epoch 6/50
2440/2440 - 113s - loss: 3.0150 - accuracy50: 0.4859 - val_loss: 3.8071 - val_accuracy50: 0.3977 - 113s/epoch - 46ms/step
Epoch 7/50
2440/2440 - 113s - loss: 3.0033 - accuracy50: 0.4890 - val_loss: 3.7314 - val_accuracy50: 0.4347 - 113s/epoch - 46ms/step
Epoch 8/50
2440/2440 - 113s - loss: 2.9931 - accuracy50: 0.4922 - val_loss: 3.8994 - val_accuracy50: 0.4122 - 113s/epoch - 46ms/step
Epoch 9/50
2440/2440 - 113s - loss: 2.9833 - accuracy50: 0.4951 - val_loss: 3.8905 - val_accuracy50: 0.4238 - 113s/epoch - 46ms/step
Epoch 10/50
2440/2440 - 113s - loss: 2.9763 - accuracy50: 0.4973 - val_loss: 3.7650 - val_accuracy50: 0.4237 - 113s/epoch - 46ms/step
Epoch 11/50
2440/2440 - 112s - loss: 2.9692 - accuracy50: 0.4993 - val_loss: 3.7309 - val_accuracy50: 0.4189 - 112s/epoch - 46ms/step
testing model: results/ATVI/W3/deepLOB_L2/h50
Evaluating performance on  test set...
6082/6082 - 109s - 109s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0616608
{'0': {'precision': 0.4622274983811785, 'recall': 0.058865704736881894, 'f1-score': 0.1044317879341419, 'support': 436553}, '1': {'precision': 0.4466988350899223, 'recall': 0.9640484940871731, 'f1-score': 0.6105123580565356, 'support': 684867}, '2': {'precision': 0.4366848060810227, 'recall': 0.023223177700604523, 'f1-score': 0.044101034156383986, 'support': 435384}, 'accuracy': 0.4471044524551581, 'macro avg': {'precision': 0.4485370465173745, 'recall': 0.3487124588415531, 'f1-score': 0.25301506004902047, 'support': 1556804}, 'weighted avg': {'precision': 0.4482527471686278, 'recall': 0.4471044524551581, 'f1-score': 0.3101936159582464, 'support': 1556804}}
[[ 25698 406510   4345]
 [ 15924 660245   8698]
 [ 13974 411299  10111]]
Evaluating performance on  train set...
2440/2440 - 44s - 44s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1757423
{'0': {'precision': 0.48229589535408207, 'recall': 0.020446798644210406, 'f1-score': 0.039230434084707284, 'support': 209177}, '1': {'precision': 0.3338601074153838, 'recall': 0.972891960078835, 'f1-score': 0.49712538801385164, 'support': 206507}, '2': {'precision': 0.43577422362475793, 'recall': 0.029085269239790715, 'f1-score': 0.05453093167478887, 'support': 208903}, 'accuracy': 0.3382427107832856, 'macro avg': {'precision': 0.41731007546474125, 'recall': 0.3408080093209454, 'f1-score': 0.19696225125778258, 'support': 624587}, 'weighted avg': {'precision': 0.41765870942301436, 'recall': 0.3382427107832856, 'f1-score': 0.1957415896148522, 'support': 624587}}
[[  4277 200770   4130]
 [  1861 200909   3737]
 [  2730 200097   6076]]
Evaluating performance on  val set...
826/826 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1223427
{'0': {'precision': 0.46718648473034435, 'recall': 0.022139085184671992, 'f1-score': 0.04227484529111728, 'support': 64953}, '1': {'precision': 0.3977481539248897, 'recall': 0.9750630294774827, 'f1-score': 0.5650150940260892, 'support': 83691}, '2': {'precision': 0.38278560250391236, 'recall': 0.019476383093926172, 'f1-score': 0.03706678385791572, 'support': 62794}, 'accuracy': 0.3985329032624221, 'macro avg': {'precision': 0.41590674705304886, 'recall': 0.33889283258536024, 'f1-score': 0.2147855743917074, 'support': 211438}, 'weighted avg': {'precision': 0.41463570226945334, 'recall': 0.3985329032624221, 'f1-score': 0.2476382101888276, 'support': 211438}}
[[ 1438 62889   626]
 [  741 81604  1346]
 [  899 60672  1223]]
training model: results/ATVI/W3/deepLOB_L2/h100
Epoch 1/50
2440/2440 - 115s - loss: 3.2510 - accuracy100: 0.3945 - val_loss: 3.3850 - val_accuracy100: 0.3470 - 115s/epoch - 47ms/step
Epoch 2/50
2440/2440 - 112s - loss: 3.2126 - accuracy100: 0.4097 - val_loss: 3.4090 - val_accuracy100: 0.3536 - 112s/epoch - 46ms/step
Epoch 3/50
2440/2440 - 112s - loss: 3.1961 - accuracy100: 0.4176 - val_loss: 3.3878 - val_accuracy100: 0.3545 - 112s/epoch - 46ms/step
Epoch 4/50
2440/2440 - 112s - loss: 3.1871 - accuracy100: 0.4221 - val_loss: 3.3713 - val_accuracy100: 0.3509 - 112s/epoch - 46ms/step
Epoch 5/50
2440/2440 - 112s - loss: 3.1800 - accuracy100: 0.4259 - val_loss: 3.3801 - val_accuracy100: 0.3468 - 112s/epoch - 46ms/step
Epoch 6/50
2440/2440 - 113s - loss: 3.1745 - accuracy100: 0.4283 - val_loss: 3.4265 - val_accuracy100: 0.3466 - 113s/epoch - 46ms/step
Epoch 7/50
2440/2440 - 113s - loss: 3.1698 - accuracy100: 0.4307 - val_loss: 3.4789 - val_accuracy100: 0.3428 - 113s/epoch - 46ms/step
Epoch 8/50
2440/2440 - 113s - loss: 3.1649 - accuracy100: 0.4326 - val_loss: 3.4971 - val_accuracy100: 0.3363 - 113s/epoch - 46ms/step
Epoch 9/50
2440/2440 - 112s - loss: 3.1612 - accuracy100: 0.4351 - val_loss: 3.5448 - val_accuracy100: 0.3371 - 112s/epoch - 46ms/step
Epoch 10/50
2440/2440 - 113s - loss: 3.1565 - accuracy100: 0.4368 - val_loss: 3.5639 - val_accuracy100: 0.3323 - 113s/epoch - 46ms/step
Epoch 11/50
2440/2440 - 112s - loss: 3.1536 - accuracy100: 0.4383 - val_loss: 3.6226 - val_accuracy100: 0.3305 - 112s/epoch - 46ms/step
Epoch 12/50
2440/2440 - 112s - loss: 3.1491 - accuracy100: 0.4400 - val_loss: 3.6313 - val_accuracy100: 0.3312 - 112s/epoch - 46ms/step
Epoch 13/50
2440/2440 - 113s - loss: 3.1457 - accuracy100: 0.4417 - val_loss: 3.6752 - val_accuracy100: 0.3333 - 113s/epoch - 46ms/step
Epoch 14/50
2440/2440 - 113s - loss: 3.1421 - accuracy100: 0.4435 - val_loss: 3.7201 - val_accuracy100: 0.3318 - 113s/epoch - 46ms/step
testing model: results/ATVI/W3/deepLOB_L2/h100
Evaluating performance on  test set...
6082/6082 - 109s - 109s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0891528
{'0': {'precision': 0.4299324289266457, 'recall': 0.2128449938351617, 'f1-score': 0.2847298674282724, 'support': 506096}, '1': {'precision': 0.3885390167800768, 'recall': 0.5296363914083924, 'f1-score': 0.4482463828448003, 'support': 549932}, '2': {'precision': 0.3799868490551801, 'recall': 0.4223565027077975, 'f1-score': 0.40005296059164547, 'support': 500776}, 'accuracy': 0.3921431342673837, 'macro avg': {'precision': 0.39948609825396747, 'recall': 0.3882792959837839, 'f1-score': 0.37767640362157273, 'support': 1556804}, 'weighted avg': {'precision': 0.3992444877122731, 'recall': 0.3921431342673837, 'f1-score': 0.37958702456431737, 'support': 1556804}}
[[107720 239658 158718]
 [ 72278 291264 186390]
 [ 70553 218717 211506]]
Evaluating performance on  train set...
2440/2440 - 44s - 44s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1206403
{'0': {'precision': 0.36960523877185397, 'recall': 0.1430840021811294, 'f1-score': 0.20630273688711417, 'support': 209066}, '1': {'precision': 0.39659160073037125, 'recall': 0.1739911445993708, 'f1-score': 0.2418700078625637, 'support': 205976}, '2': {'precision': 0.34738035725710203, 'recall': 0.7514519554272352, 'f1-score': 0.47512190117556186, 'support': 209545}, 'accuracy': 0.3573801568076185, 'macro avg': {'precision': 0.3711923989197758, 'recall': 0.3561757007359118, 'f1-score': 0.30776488197507995, 'support': 624587}, 'weighted avg': {'precision': 0.3710484806160788, 'recall': 0.3573801568076185, 'f1-score': 0.30821922888464526, 'support': 624587}}
[[ 29914  26278 152874]
 [ 27188  35838 142950]
 [ 23833  28249 157463]]
Evaluating performance on  val set...
826/826 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1230707
{'0': {'precision': 0.3771604755269633, 'recall': 0.17679020580592264, 'f1-score': 0.24073723649850506, 'support': 71961}, '1': {'precision': 0.3940545373267769, 'recall': 0.19556295063782583, 'f1-score': 0.2613981762917933, 'support': 72120}, '2': {'precision': 0.3331007997745129, 'recall': 0.7018127291892453, 'f1-score': 0.4517756794984518, 'support': 67357}, 'accuracy': 0.3504478854321361, 'macro avg': {'precision': 0.3681052708760844, 'recall': 0.35805529521099794, 'f1-score': 0.31797036409625007, 'support': 211438}, 'weighted avg': {'precision': 0.36888699657495255, 'recall': 0.3504478854321361, 'f1-score': 0.3150142509568302, 'support': 211438}}
[[12722 10621 48618]
 [11991 14104 46025]
 [ 9018 11067 47272]]
training model: results/ATVI/W3/deepLOB_L2/h200
Epoch 1/50
2440/2440 - 115s - loss: 3.2837 - accuracy200: 0.3707 - val_loss: 3.3367 - val_accuracy200: 0.3421 - 115s/epoch - 47ms/step
Epoch 2/50
2440/2440 - 112s - loss: 3.2594 - accuracy200: 0.3806 - val_loss: 3.4765 - val_accuracy200: 0.3325 - 112s/epoch - 46ms/step
Epoch 3/50
2440/2440 - 112s - loss: 3.2445 - accuracy200: 0.3906 - val_loss: 3.4732 - val_accuracy200: 0.3344 - 112s/epoch - 46ms/step
Epoch 4/50
2440/2440 - 112s - loss: 3.2342 - accuracy200: 0.3982 - val_loss: 3.4679 - val_accuracy200: 0.3398 - 112s/epoch - 46ms/step
Epoch 5/50
2440/2440 - 112s - loss: 3.2275 - accuracy200: 0.4031 - val_loss: 3.6651 - val_accuracy200: 0.3359 - 112s/epoch - 46ms/step
Epoch 6/50
2440/2440 - 113s - loss: 3.2207 - accuracy200: 0.4073 - val_loss: 3.6778 - val_accuracy200: 0.3338 - 113s/epoch - 46ms/step
Epoch 7/50
2440/2440 - 111s - loss: 3.2148 - accuracy200: 0.4103 - val_loss: 3.7459 - val_accuracy200: 0.3304 - 111s/epoch - 46ms/step
Epoch 8/50
2440/2440 - 112s - loss: 3.2089 - accuracy200: 0.4144 - val_loss: 3.6770 - val_accuracy200: 0.3370 - 112s/epoch - 46ms/step
Epoch 9/50
2440/2440 - 112s - loss: 3.2045 - accuracy200: 0.4157 - val_loss: 3.7357 - val_accuracy200: 0.3347 - 112s/epoch - 46ms/step
Epoch 10/50
2440/2440 - 111s - loss: 3.1997 - accuracy200: 0.4187 - val_loss: 3.7204 - val_accuracy200: 0.3371 - 111s/epoch - 46ms/step
Epoch 11/50
2440/2440 - 111s - loss: 3.1958 - accuracy200: 0.4198 - val_loss: 3.7632 - val_accuracy200: 0.3358 - 111s/epoch - 46ms/step
testing model: results/ATVI/W3/deepLOB_L2/h200
Evaluating performance on  test set...
6082/6082 - 108s - 108s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1052927
{'0': {'precision': 0.38055813289558205, 'recall': 0.010447731948662683, 'f1-score': 0.02033713414994632, 'support': 510350}, '1': {'precision': 0.3503762621765827, 'recall': 0.9773836156778476, 'f1-score': 0.5158342614286809, 'support': 543544}, '2': {'precision': 0.36599781651168917, 'recall': 0.0193314907239864, 'f1-score': 0.036723307892942605, 'support': 502910}, 'accuracy': 0.3509144375271389, 'macro avg': {'precision': 0.3656440705279513, 'recall': 0.33572094611683223, 'f1-score': 0.19096490115718998, 'support': 1556804}, 'weighted avg': {'precision': 0.3653168414737259, 'recall': 0.3509144375271389, 'f1-score': 0.19862885307325506, 'support': 1556804}}
[[  5332 496438   8580]
 [  4032 531251   8261]
 [  4647 488541   9722]]
Evaluating performance on  train set...
2440/2440 - 44s - 44s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1110994
{'0': {'precision': 0.35030203507125685, 'recall': 0.02868559188946466, 'f1-score': 0.05302875609258059, 'support': 208223}, '1': {'precision': 0.33792849286828935, 'recall': 0.8548143544526284, 'f1-score': 0.4843728505791399, 'support': 205957}, '2': {'precision': 0.36488625466477187, 'recall': 0.15009956893069146, 'f1-score': 0.2127020474137931, 'support': 210407}, 'accuracy': 0.34200199491824196, 'macro avg': {'precision': 0.35103892753477267, 'recall': 0.34453317175759485, 'f1-score': 0.2500345513618379, 'support': 624587}, 'weighted avg': {'precision': 0.35113491225332455, 'recall': 0.34200199491824196, 'f1-score': 0.24905383166282244, 'support': 624587}}
[[  5973 171805  30445]
 [  5376 176055  24526]
 [  5702 173123  31582]]
Evaluating performance on  val set...
826/826 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1125815
{'0': {'precision': 0.35083612040133777, 'recall': 0.02905776928297392, 'f1-score': 0.05367032910809531, 'support': 72201}, '1': {'precision': 0.34701707156537775, 'recall': 0.8082479352539845, 'f1-score': 0.4855610270111056, 'support': 72406}, '2': {'precision': 0.32231427407306806, 'recall': 0.1775523334979276, 'f1-score': 0.22897169210582174, 'support': 66831}, 'accuracy': 0.34282390109630245, 'macro avg': {'precision': 0.3400558220132612, 'recall': 0.33828601267829533, 'f1-score': 0.2560676827416742, 'support': 211438}, 'weighted avg': {'precision': 0.3405131625508988, 'recall': 0.34282390109630245, 'f1-score': 0.25697835918247375, 'support': 211438}}
[[ 2098 57049 13054]
 [ 1989 58522 11895]
 [ 1893 53072 11866]]
training model: results/ATVI/W3/deepLOB_L2/h300
Epoch 1/50
2440/2440 - 114s - loss: 3.2624 - accuracy300: 0.3910 - val_loss: 3.3386 - val_accuracy300: 0.3470 - 114s/epoch - 47ms/step
Epoch 2/50
2440/2440 - 111s - loss: 3.2352 - accuracy300: 0.4060 - val_loss: 3.4302 - val_accuracy300: 0.3300 - 111s/epoch - 46ms/step
Epoch 3/50
2440/2440 - 111s - loss: 3.2177 - accuracy300: 0.4138 - val_loss: 3.5693 - val_accuracy300: 0.3344 - 111s/epoch - 45ms/step
Epoch 4/50
2440/2440 - 111s - loss: 3.2044 - accuracy300: 0.4189 - val_loss: 3.6141 - val_accuracy300: 0.3353 - 111s/epoch - 46ms/step
Epoch 5/50
2440/2440 - 112s - loss: 3.1939 - accuracy300: 0.4249 - val_loss: 3.5969 - val_accuracy300: 0.3366 - 112s/epoch - 46ms/step
Epoch 6/50
2440/2440 - 111s - loss: 3.1850 - accuracy300: 0.4295 - val_loss: 3.6260 - val_accuracy300: 0.3362 - 111s/epoch - 45ms/step
Epoch 7/50
2440/2440 - 111s - loss: 3.1770 - accuracy300: 0.4340 - val_loss: 3.6553 - val_accuracy300: 0.3305 - 111s/epoch - 46ms/step
Epoch 8/50
2440/2440 - 112s - loss: 3.1696 - accuracy300: 0.4371 - val_loss: 3.6515 - val_accuracy300: 0.3267 - 112s/epoch - 46ms/step
Epoch 9/50
2440/2440 - 112s - loss: 3.1638 - accuracy300: 0.4396 - val_loss: 3.7500 - val_accuracy300: 0.3252 - 112s/epoch - 46ms/step
Epoch 10/50
2440/2440 - 112s - loss: 3.1558 - accuracy300: 0.4444 - val_loss: 3.8159 - val_accuracy300: 0.3237 - 112s/epoch - 46ms/step
Epoch 11/50
2440/2440 - 112s - loss: 3.1495 - accuracy300: 0.4463 - val_loss: 3.8377 - val_accuracy300: 0.3228 - 112s/epoch - 46ms/step
testing model: results/ATVI/W3/deepLOB_L2/h300
Evaluating performance on  test set...
6082/6082 - 107s - 107s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1158386
{'0': {'precision': 0.37690848378357567, 'recall': 0.09890333957897057, 'f1-score': 0.156690128035924, 'support': 544380}, '1': {'precision': 0.3083765495552428, 'recall': 0.7830227413651523, 'f1-score': 0.4424885616369437, 'support': 477368}, '2': {'precision': 0.38130533659015126, 'recall': 0.1438354116204659, 'f1-score': 0.20887813497012442, 'support': 535056}, 'accuracy': 0.32411979928109125, 'macro avg': {'precision': 0.3555301233096566, 'recall': 0.3419204975215296, 'f1-score': 0.2693522748809974, 'support': 1556804}, 'weighted avg': {'precision': 0.35740545713189975, 'recall': 0.32411979928109125, 'f1-score': 0.26226188458937394, 'support': 1556804}}
[[ 53841 426858  63681]
 [ 42386 373790  61192]
 [ 46622 411474  76960]]
Evaluating performance on  train set...
2440/2440 - 44s - 44s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1091402
{'0': {'precision': 0.29084287200832465, 'recall': 0.010744421165933073, 'f1-score': 0.020723275686296318, 'support': 208108}, '1': {'precision': 0.3472909772830346, 'recall': 0.7021282788933144, 'f1-score': 0.4647195383918853, 'support': 206129}, '2': {'precision': 0.3548275896523816, 'recall': 0.33764202519610176, 'f1-score': 0.34602155357212455, 'support': 210350}, 'accuracy': 0.34901142675079694, 'macro avg': {'precision': 0.3309871463145803, 'recall': 0.3501715750851164, 'f1-score': 0.2771547892167687, 'support': 624587}, 'weighted avg': {'precision': 0.3310210647158227, 'recall': 0.34901142675079694, 'f1-score': 0.276807693691353, 'support': 624587}}
[[  2236 134839  71033]
 [  3294 144729  58106]
 [  2158 137169  71023]]
Evaluating performance on  val set...
826/826 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1132368
{'0': {'precision': 0.34892307692307695, 'recall': 0.01562004986294577, 'f1-score': 0.029901514851876754, 'support': 72599}, '1': {'precision': 0.3510126859297015, 'recall': 0.7022682975057202, 'f1-score': 0.46807088559930343, 'support': 70802}, '2': {'precision': 0.3351318854738108, 'recall': 0.32773343915810516, 'f1-score': 0.3313913741342924, 'support': 68037}, 'accuracy': 0.34598321966723106, 'macro avg': {'precision': 0.3450225494421964, 'recall': 0.34854059550892363, 'f1-score': 0.2764545915284909, 'support': 211438}, 'weighted avg': {'precision': 0.3451850412069488, 'recall': 0.34598321966723106, 'f1-score': 0.2736407355390617, 'support': 211438}}
[[ 1134 47179 24286]
 [ 1129 49722 19951]
 [  987 44752 22298]]
training model: results/ATVI/W3/deepLOB_L2/h500
Epoch 1/50
2440/2440 - 115s - loss: 3.2320 - accuracy500: 0.4109 - val_loss: 3.5605 - val_accuracy500: 0.3030 - 115s/epoch - 47ms/step
Epoch 2/50
2440/2440 - 112s - loss: 3.2028 - accuracy500: 0.4227 - val_loss: 3.7288 - val_accuracy500: 0.3002 - 112s/epoch - 46ms/step
Epoch 3/50
2440/2440 - 112s - loss: 3.1872 - accuracy500: 0.4297 - val_loss: 3.5668 - val_accuracy500: 0.3198 - 112s/epoch - 46ms/step
Epoch 4/50
2440/2440 - 113s - loss: 3.1777 - accuracy500: 0.4331 - val_loss: 3.5074 - val_accuracy500: 0.3358 - 113s/epoch - 46ms/step
Epoch 5/50
2440/2440 - 113s - loss: 3.1688 - accuracy500: 0.4391 - val_loss: 3.4919 - val_accuracy500: 0.3389 - 113s/epoch - 46ms/step
Epoch 6/50
2440/2440 - 112s - loss: 3.1593 - accuracy500: 0.4425 - val_loss: 3.5217 - val_accuracy500: 0.3324 - 112s/epoch - 46ms/step
Epoch 7/50
2440/2440 - 112s - loss: 3.1456 - accuracy500: 0.4486 - val_loss: 3.5979 - val_accuracy500: 0.3196 - 112s/epoch - 46ms/step
Epoch 8/50
2440/2440 - 112s - loss: 3.1362 - accuracy500: 0.4526 - val_loss: 3.6836 - val_accuracy500: 0.3311 - 112s/epoch - 46ms/step
Epoch 9/50
2440/2440 - 111s - loss: 3.1288 - accuracy500: 0.4547 - val_loss: 3.6396 - val_accuracy500: 0.3253 - 111s/epoch - 46ms/step
Epoch 10/50
2440/2440 - 112s - loss: 3.1210 - accuracy500: 0.4572 - val_loss: 3.6301 - val_accuracy500: 0.3195 - 112s/epoch - 46ms/step
Epoch 11/50
2440/2440 - 112s - loss: 3.1152 - accuracy500: 0.4595 - val_loss: 3.6195 - val_accuracy500: 0.3210 - 112s/epoch - 46ms/step
Epoch 12/50
2440/2440 - 112s - loss: 3.1078 - accuracy500: 0.4617 - val_loss: 3.6710 - val_accuracy500: 0.3138 - 112s/epoch - 46ms/step
Epoch 13/50
2440/2440 - 112s - loss: 3.0996 - accuracy500: 0.4653 - val_loss: 3.7860 - val_accuracy500: 0.3223 - 112s/epoch - 46ms/step
Epoch 14/50
2440/2440 - 112s - loss: 3.0939 - accuracy500: 0.4675 - val_loss: 3.7452 - val_accuracy500: 0.3242 - 112s/epoch - 46ms/step
Epoch 15/50
2440/2440 - 112s - loss: 3.0872 - accuracy500: 0.4697 - val_loss: 3.7033 - val_accuracy500: 0.2981 - 112s/epoch - 46ms/step
testing model: results/ATVI/W3/deepLOB_L2/h500
Evaluating performance on  test set...
6082/6082 - 107s - 107s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2469295
{'0': {'precision': 0.40369928953275785, 'recall': 0.11708061089913319, 'f1-score': 0.18151760234541855, 'support': 595974}, '1': {'precision': 0.24256572048702532, 'recall': 0.6945574217572015, 'f1-score': 0.35955962206776715, 'support': 381345}, '2': {'precision': 0.36883828439345945, 'recall': 0.18587193801392615, 'f1-score': 0.24718018152402152, 'support': 579485}, 'accuracy': 0.28414174167075623, 'macro avg': {'precision': 0.33836776480441416, 'recall': 0.3325033235567536, 'f1-score': 0.26275246864573576, 'support': 1556804}, 'weighted avg': {'precision': 0.35125279629989664, 'recall': 0.28414174167075623, 'f1-score': 0.2495710719577344, 'support': 1556804}}
[[ 69777 417106 109091]
 [ 41255 264866  75224]
 [ 61812 409963 107710]]
Evaluating performance on  train set...
2440/2440 - 44s - 44s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1576658
{'0': {'precision': 0.3433913778529163, 'recall': 0.24483252411970896, 'f1-score': 0.2858550205754367, 'support': 207403}, '1': {'precision': 0.3417393581104359, 'recall': 0.5999080748947699, 'f1-score': 0.43543303630218166, 'support': 206690}, '2': {'precision': 0.34279090597750206, 'recall': 0.1854494664931067, 'f1-score': 0.240687361077285, 'support': 210494}, 'accuracy': 0.3423222065140645, 'macro avg': {'precision': 0.3426405473136181, 'recall': 0.3433966885025286, 'f1-score': 0.32065847265163444, 'support': 624587}, 'weighted avg': {'precision': 0.34264232017557633, 'recall': 0.3423222065140645, 'f1-score': 0.3201316845984743, 'support': 624587}}
[[ 50779 118186  38438]
 [ 46292 123995  36403]
 [ 50804 120654  39036]]
Evaluating performance on  val set...
826/826 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1655327
{'0': {'precision': 0.382273894606916, 'recall': 0.2472509077798666, 'f1-score': 0.300282267207744, 'support': 77662}, '1': {'precision': 0.3167338926123031, 'recall': 0.6638486635915074, 'f1-score': 0.4288539909149902, 'support': 62219}, '2': {'precision': 0.3604428427648453, 'recall': 0.15514904202244365, 'f1-score': 0.21692491060786653, 'support': 71557}, 'accuracy': 0.33867138357343524, 'macro avg': {'precision': 0.35315020999468816, 'recall': 0.35541620446460587, 'f1-score': 0.31535372291020025, 'support': 211438}, 'weighted avg': {'precision': 0.3555994181137318, 'recall': 0.33867138357343524, 'f1-score': 0.3099059001929393, 'support': 211438}}
[[19202 46418 12042]
 [13258 41304  7657]
 [17771 42684 11102]]
training model: results/ATVI/W3/deepLOB_L2/h1000
Epoch 1/50
2440/2440 - 114s - loss: 3.2458 - accuracy1000: 0.4044 - val_loss: 3.3461 - val_accuracy1000: 0.3441 - 114s/epoch - 47ms/step
Epoch 2/50
2440/2440 - 112s - loss: 3.1791 - accuracy1000: 0.4328 - val_loss: 3.3396 - val_accuracy1000: 0.3431 - 112s/epoch - 46ms/step
Epoch 3/50
2440/2440 - 112s - loss: 3.1507 - accuracy1000: 0.4449 - val_loss: 3.3599 - val_accuracy1000: 0.3387 - 112s/epoch - 46ms/step
Epoch 4/50
2440/2440 - 112s - loss: 3.1302 - accuracy1000: 0.4545 - val_loss: 3.4570 - val_accuracy1000: 0.3185 - 112s/epoch - 46ms/step
Epoch 5/50
2440/2440 - 112s - loss: 3.1168 - accuracy1000: 0.4590 - val_loss: 3.3839 - val_accuracy1000: 0.3290 - 112s/epoch - 46ms/step
Epoch 6/50
2440/2440 - 111s - loss: 3.1040 - accuracy1000: 0.4631 - val_loss: 3.5725 - val_accuracy1000: 0.3152 - 111s/epoch - 46ms/step
Epoch 7/50
2440/2440 - 112s - loss: 3.0922 - accuracy1000: 0.4677 - val_loss: 3.5613 - val_accuracy1000: 0.3179 - 112s/epoch - 46ms/step
Epoch 8/50
2440/2440 - 112s - loss: 3.0811 - accuracy1000: 0.4717 - val_loss: 3.7197 - val_accuracy1000: 0.3136 - 112s/epoch - 46ms/step
Epoch 9/50
2440/2440 - 111s - loss: 3.0728 - accuracy1000: 0.4735 - val_loss: 3.6447 - val_accuracy1000: 0.3185 - 111s/epoch - 46ms/step
Epoch 10/50
2440/2440 - 112s - loss: 3.0634 - accuracy1000: 0.4765 - val_loss: 3.5036 - val_accuracy1000: 0.3327 - 112s/epoch - 46ms/step
Epoch 11/50
2440/2440 - 112s - loss: 3.0540 - accuracy1000: 0.4791 - val_loss: 3.5601 - val_accuracy1000: 0.3232 - 112s/epoch - 46ms/step
Epoch 12/50
2440/2440 - 112s - loss: 3.0452 - accuracy1000: 0.4832 - val_loss: 3.5354 - val_accuracy1000: 0.3198 - 112s/epoch - 46ms/step
testing model: results/ATVI/W3/deepLOB_L2/h1000
Evaluating performance on  test set...
6082/6082 - 107s - 107s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.136325
{'0': {'precision': 0.3783583762377647, 'recall': 0.20970283323045855, 'f1-score': 0.2698454589286167, 'support': 507089}, '1': {'precision': 0.3576461780276202, 'recall': 0.6121886530735583, 'f1-score': 0.45151385572538405, 'support': 549347}, '2': {'precision': 0.32390654300339566, 'recall': 0.2171341892367218, 'f1-score': 0.2599848048863657, 'support': 500368}, 'accuracy': 0.35411586815039015, 'macro avg': {'precision': 0.3533036990895935, 'recall': 0.34634189184691283, 'f1-score': 0.3271147065134555, 'support': 1556804}, 'weighted avg': {'precision': 0.35354848440683223, 'recall': 0.35411586815039015, 'f1-score': 0.33078121772246666, 'support': 1556804}}
[[106338 301499  99252]
 [ 85515 336304 127528]
 [ 89198 302523 108647]]
Evaluating performance on  train set...
2440/2440 - 44s - 44s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1178082
{'0': {'precision': 0.3319302532517706, 'recall': 0.5799788471192603, 'f1-score': 0.4222186740468714, 'support': 205173}, '1': {'precision': 0.33529173419773095, 'recall': 0.3050942837876517, 'f1-score': 0.31948102748024515, 'support': 206133}, '2': {'precision': 0.3445785894399022, 'recall': 0.1268608080419728, 'f1-score': 0.1854470310449173, 'support': 213281}, 'accuracy': 0.33452985732972346, 'macro avg': {'precision': 0.33726685896313463, 'recall': 0.33731131298296163, 'f1-score': 0.3090489108573446, 'support': 624587}, 'weighted avg': {'precision': 0.33735873950328493, 'recall': 0.33452985732972346, 'f1-score': 0.3074604224489065, 'support': 624587}}
[[118996  60236  25941]
 [117719  62890  25524]
 [121782  64442  27057]]
Evaluating performance on  val set...
826/826 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1133231
{'0': {'precision': 0.3484165048158865, 'recall': 0.5994571592242014, 'f1-score': 0.4406932614068775, 'support': 73318}, '1': {'precision': 0.3493794379139567, 'recall': 0.31814662374179875, 'f1-score': 0.3330323562241829, 'support': 73617}, '2': {'precision': 0.29484581256504355, 'recall': 0.0834534827837465, 'f1-score': 0.13008699855002417, 'support': 64503}, 'accuracy': 0.3440961416585477, 'macro avg': {'precision': 0.3308805850982956, 'recall': 0.33368575524991556, 'f1-score': 0.3012708720603615, 'support': 211438}, 'weighted avg': {'precision': 0.33240906000286574, 'recall': 0.3440961416585477, 'f1-score': 0.3084525637560766, 'support': 211438}}
[[43951 22875  6492]
 [43814 23421  6382]
 [38380 20740  5383]]
training model: results/ATVI/W3/deepOF_L2/h10
Epoch 1/50
2440/2440 - 72s - loss: 2.9176 - accuracy10: 0.5142 - val_loss: 2.7913 - val_accuracy10: 0.6551 - 72s/epoch - 30ms/step
Epoch 2/50
2440/2440 - 68s - loss: 2.7403 - accuracy10: 0.5649 - val_loss: 2.6916 - val_accuracy10: 0.6679 - 68s/epoch - 28ms/step
Epoch 3/50
2440/2440 - 68s - loss: 2.6964 - accuracy10: 0.5724 - val_loss: 2.6530 - val_accuracy10: 0.6705 - 68s/epoch - 28ms/step
Epoch 4/50
2440/2440 - 67s - loss: 2.6746 - accuracy10: 0.5760 - val_loss: 2.6496 - val_accuracy10: 0.6725 - 67s/epoch - 28ms/step
Epoch 5/50
2440/2440 - 67s - loss: 2.6588 - accuracy10: 0.5787 - val_loss: 2.6283 - val_accuracy10: 0.6755 - 67s/epoch - 27ms/step
Epoch 6/50
2440/2440 - 67s - loss: 2.6474 - accuracy10: 0.5805 - val_loss: 2.6148 - val_accuracy10: 0.6736 - 67s/epoch - 27ms/step
Epoch 7/50
2440/2440 - 67s - loss: 2.6386 - accuracy10: 0.5819 - val_loss: 2.6140 - val_accuracy10: 0.6750 - 67s/epoch - 27ms/step
Epoch 8/50
2440/2440 - 67s - loss: 2.6298 - accuracy10: 0.5832 - val_loss: 2.6178 - val_accuracy10: 0.6741 - 67s/epoch - 28ms/step
Epoch 9/50
2440/2440 - 68s - loss: 2.6227 - accuracy10: 0.5843 - val_loss: 2.6147 - val_accuracy10: 0.6745 - 68s/epoch - 28ms/step
Epoch 10/50
2440/2440 - 67s - loss: 2.6159 - accuracy10: 0.5855 - val_loss: 2.6162 - val_accuracy10: 0.6734 - 67s/epoch - 28ms/step
Epoch 11/50
2440/2440 - 67s - loss: 2.6114 - accuracy10: 0.5862 - val_loss: 2.6131 - val_accuracy10: 0.6733 - 67s/epoch - 27ms/step
Epoch 12/50
2440/2440 - 67s - loss: 2.6064 - accuracy10: 0.5870 - val_loss: 2.5946 - val_accuracy10: 0.6733 - 67s/epoch - 27ms/step
Epoch 13/50
2440/2440 - 68s - loss: 2.6006 - accuracy10: 0.5876 - val_loss: 2.5870 - val_accuracy10: 0.6728 - 68s/epoch - 28ms/step
Epoch 14/50
2440/2440 - 67s - loss: 2.5960 - accuracy10: 0.5884 - val_loss: 2.5749 - val_accuracy10: 0.6722 - 67s/epoch - 27ms/step
Epoch 15/50
2440/2440 - 67s - loss: 2.5917 - accuracy10: 0.5889 - val_loss: 2.5621 - val_accuracy10: 0.6712 - 67s/epoch - 27ms/step
Epoch 16/50
2440/2440 - 67s - loss: 2.5878 - accuracy10: 0.5896 - val_loss: 2.5863 - val_accuracy10: 0.6721 - 67s/epoch - 27ms/step
Epoch 17/50
2440/2440 - 67s - loss: 2.5834 - accuracy10: 0.5901 - val_loss: 2.5861 - val_accuracy10: 0.6718 - 67s/epoch - 28ms/step
Epoch 18/50
2440/2440 - 67s - loss: 2.5794 - accuracy10: 0.5904 - val_loss: 2.5785 - val_accuracy10: 0.6717 - 67s/epoch - 28ms/step
Epoch 19/50
2440/2440 - 67s - loss: 2.5760 - accuracy10: 0.5909 - val_loss: 2.5565 - val_accuracy10: 0.6711 - 67s/epoch - 28ms/step
Epoch 20/50
2440/2440 - 67s - loss: 2.5723 - accuracy10: 0.5916 - val_loss: 2.5573 - val_accuracy10: 0.6716 - 67s/epoch - 27ms/step
Epoch 21/50
2440/2440 - 68s - loss: 2.5693 - accuracy10: 0.5917 - val_loss: 2.5729 - val_accuracy10: 0.6709 - 68s/epoch - 28ms/step
Epoch 22/50
2440/2440 - 68s - loss: 2.5660 - accuracy10: 0.5921 - val_loss: 2.5659 - val_accuracy10: 0.6710 - 68s/epoch - 28ms/step
Epoch 23/50
2440/2440 - 70s - loss: 2.5627 - accuracy10: 0.5926 - val_loss: 2.5436 - val_accuracy10: 0.6710 - 70s/epoch - 29ms/step
Epoch 24/50
2440/2440 - 67s - loss: 2.5598 - accuracy10: 0.5933 - val_loss: 2.5640 - val_accuracy10: 0.6709 - 67s/epoch - 28ms/step
Epoch 25/50
2440/2440 - 68s - loss: 2.5563 - accuracy10: 0.5935 - val_loss: 2.5320 - val_accuracy10: 0.6706 - 68s/epoch - 28ms/step
Epoch 26/50
2440/2440 - 67s - loss: 2.5541 - accuracy10: 0.5941 - val_loss: 2.5316 - val_accuracy10: 0.6719 - 67s/epoch - 28ms/step
Epoch 27/50
2440/2440 - 67s - loss: 2.5510 - accuracy10: 0.5938 - val_loss: 2.5304 - val_accuracy10: 0.6706 - 67s/epoch - 28ms/step
Epoch 28/50
2440/2440 - 68s - loss: 2.5471 - accuracy10: 0.5948 - val_loss: 2.5622 - val_accuracy10: 0.6720 - 68s/epoch - 28ms/step
Epoch 29/50
2440/2440 - 67s - loss: 2.5453 - accuracy10: 0.5953 - val_loss: 2.5212 - val_accuracy10: 0.6683 - 67s/epoch - 28ms/step
Epoch 30/50
2440/2440 - 68s - loss: 2.5431 - accuracy10: 0.5951 - val_loss: 2.5196 - val_accuracy10: 0.6671 - 68s/epoch - 28ms/step
Epoch 31/50
2440/2440 - 67s - loss: 2.5413 - accuracy10: 0.5956 - val_loss: 2.5360 - val_accuracy10: 0.6710 - 67s/epoch - 28ms/step
Epoch 32/50
2440/2440 - 67s - loss: 2.5364 - accuracy10: 0.5961 - val_loss: 2.5387 - val_accuracy10: 0.6693 - 67s/epoch - 27ms/step
Epoch 33/50
2440/2440 - 67s - loss: 2.5339 - accuracy10: 0.5963 - val_loss: 2.5140 - val_accuracy10: 0.6662 - 67s/epoch - 28ms/step
Epoch 34/50
2440/2440 - 67s - loss: 2.5318 - accuracy10: 0.5966 - val_loss: 2.5381 - val_accuracy10: 0.6673 - 67s/epoch - 27ms/step
Epoch 35/50
2440/2440 - 68s - loss: 2.5285 - accuracy10: 0.5971 - val_loss: 2.5153 - val_accuracy10: 0.6664 - 68s/epoch - 28ms/step
Epoch 36/50
2440/2440 - 67s - loss: 2.5263 - accuracy10: 0.5974 - val_loss: 2.5277 - val_accuracy10: 0.6674 - 67s/epoch - 28ms/step
Epoch 37/50
2440/2440 - 68s - loss: 2.5250 - accuracy10: 0.5981 - val_loss: 2.5393 - val_accuracy10: 0.6671 - 68s/epoch - 28ms/step
Epoch 38/50
2440/2440 - 67s - loss: 2.5222 - accuracy10: 0.5977 - val_loss: 2.5351 - val_accuracy10: 0.6694 - 67s/epoch - 28ms/step
Epoch 39/50
2440/2440 - 68s - loss: 2.5192 - accuracy10: 0.5984 - val_loss: 2.5243 - val_accuracy10: 0.6673 - 68s/epoch - 28ms/step
Epoch 40/50
2440/2440 - 67s - loss: 2.5171 - accuracy10: 0.5989 - val_loss: 2.5436 - val_accuracy10: 0.6683 - 67s/epoch - 28ms/step
Epoch 41/50
2440/2440 - 68s - loss: 2.5148 - accuracy10: 0.5991 - val_loss: 2.5605 - val_accuracy10: 0.6670 - 68s/epoch - 28ms/step
Epoch 42/50
2440/2440 - 68s - loss: 2.5122 - accuracy10: 0.5993 - val_loss: 2.5458 - val_accuracy10: 0.6665 - 68s/epoch - 28ms/step
Epoch 43/50
2440/2440 - 68s - loss: 2.5093 - accuracy10: 0.5999 - val_loss: 2.5499 - val_accuracy10: 0.6669 - 68s/epoch - 28ms/step
testing model: results/ATVI/W3/deepOF_L2/h10
Evaluating performance on  test set...
6082/6082 - 75s - 75s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7516777
{'0': {'precision': 0.4518102971564947, 'recall': 0.44979102228854134, 'f1-score': 0.45079839848415, 'support': 276106}, '1': {'precision': 0.7915941026255123, 'recall': 0.7985134650124425, 'f1-score': 0.7950387289960157, 'support': 1005829}, '2': {'precision': 0.4700886995103009, 'recall': 0.4571626070980299, 'f1-score': 0.4635355569819172, 'support': 274865}, 'accuracy': 0.6763977389516957, 'macro avg': {'precision': 0.5711643664307693, 'recall': 0.5684890314663379, 'f1-score': 0.5697908948206942, 'support': 1556800}, 'weighted avg': {'precision': 0.6745675545653306, 'recall': 0.6763977389516957, 'f1-score': 0.6754566117863777, 'support': 1556800}}
[[124190 105043  46873]
 [107885 803168  94776]
 [ 42797 106410 125658]]
Evaluating performance on  train set...
2440/2440 - 30s - 30s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8658449
{'0': {'precision': 0.45982689901582674, 'recall': 0.49737701258475875, 'f1-score': 0.4778654298563682, 'support': 143348}, '1': {'precision': 0.720950440638559, 'recall': 0.7268997851142801, 'f1-score': 0.723912889685422, 'support': 337854}, '2': {'precision': 0.4872564765030375, 'recall': 0.43800171568456514, 'f1-score': 0.4613180936710349, 'support': 143383}, 'accuracy': 0.607901246427628, 'macro avg': {'precision': 0.5560112720524745, 'recall': 0.5540928377945348, 'f1-score': 0.5543654710709417, 'support': 624585}, 'weighted avg': {'precision': 0.6073721781055508, 'recall': 0.607901246427628, 'f1-score': 0.6071601003797132, 'support': 624585}}
[[ 71298  45499  26551]
 [ 52732 245586  39536]
 [ 31024  49557  62802]]
Evaluating performance on  val set...
826/826 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7683096
{'0': {'precision': 0.45986770895971135, 'recall': 0.478429508032631, 'f1-score': 0.46896500975017474, 'support': 39962}, '1': {'precision': 0.7663081193615545, 'recall': 0.801076081371097, 'f1-score': 0.783306486174945, 'support': 132332}, '2': {'precision': 0.4949408443556317, 'recall': 0.3986306969139587, 'f1-score': 0.4415955625362596, 'support': 39144}, 'accuracy': 0.6655899128822633, 'macro avg': {'precision': 0.5737055575589659, 'recall': 0.5593787621058955, 'f1-score': 0.5646223528204598, 'support': 211438}, 'weighted avg': {'precision': 0.6581517222460392, 'recall': 0.6655899128822633, 'f1-score': 0.6606338990534277, 'support': 211438}}
[[ 19119  15345   5498]
 [ 15899 106008  10425]
 [  6557  16983  15604]]
training model: results/ATVI/W3/deepOF_L2/h20
Epoch 1/50
2440/2440 - 70s - loss: 2.9767 - accuracy20: 0.5024 - val_loss: 2.9481 - val_accuracy20: 0.5816 - 70s/epoch - 29ms/step
Epoch 2/50
2440/2440 - 67s - loss: 2.8205 - accuracy20: 0.5480 - val_loss: 2.8495 - val_accuracy20: 0.5975 - 67s/epoch - 28ms/step
Epoch 3/50
2440/2440 - 67s - loss: 2.7828 - accuracy20: 0.5567 - val_loss: 2.8311 - val_accuracy20: 0.6028 - 67s/epoch - 28ms/step
Epoch 4/50
2440/2440 - 67s - loss: 2.7639 - accuracy20: 0.5608 - val_loss: 2.8250 - val_accuracy20: 0.6047 - 67s/epoch - 28ms/step
Epoch 5/50
2440/2440 - 67s - loss: 2.7497 - accuracy20: 0.5635 - val_loss: 2.8175 - val_accuracy20: 0.6061 - 67s/epoch - 28ms/step
Epoch 6/50
2440/2440 - 67s - loss: 2.7407 - accuracy20: 0.5655 - val_loss: 2.8272 - val_accuracy20: 0.6060 - 67s/epoch - 27ms/step
Epoch 7/50
2440/2440 - 67s - loss: 2.7323 - accuracy20: 0.5665 - val_loss: 2.8213 - val_accuracy20: 0.6069 - 67s/epoch - 28ms/step
Epoch 8/50
2440/2440 - 67s - loss: 2.7247 - accuracy20: 0.5679 - val_loss: 2.8341 - val_accuracy20: 0.6069 - 67s/epoch - 27ms/step
Epoch 9/50
2440/2440 - 67s - loss: 2.7193 - accuracy20: 0.5692 - val_loss: 2.8097 - val_accuracy20: 0.6078 - 67s/epoch - 27ms/step
Epoch 10/50
2440/2440 - 67s - loss: 2.7139 - accuracy20: 0.5701 - val_loss: 2.8216 - val_accuracy20: 0.6082 - 67s/epoch - 27ms/step
Epoch 11/50
2440/2440 - 67s - loss: 2.7088 - accuracy20: 0.5711 - val_loss: 2.8232 - val_accuracy20: 0.6093 - 67s/epoch - 27ms/step
Epoch 12/50
2440/2440 - 67s - loss: 2.7037 - accuracy20: 0.5719 - val_loss: 2.8228 - val_accuracy20: 0.6095 - 67s/epoch - 27ms/step
Epoch 13/50
2440/2440 - 67s - loss: 2.7003 - accuracy20: 0.5722 - val_loss: 2.8079 - val_accuracy20: 0.6092 - 67s/epoch - 27ms/step
Epoch 14/50
2440/2440 - 67s - loss: 2.6951 - accuracy20: 0.5737 - val_loss: 2.8205 - val_accuracy20: 0.6109 - 67s/epoch - 27ms/step
Epoch 15/50
2440/2440 - 67s - loss: 2.6913 - accuracy20: 0.5739 - val_loss: 2.7922 - val_accuracy20: 0.6114 - 67s/epoch - 27ms/step
Epoch 16/50
2440/2440 - 67s - loss: 2.6882 - accuracy20: 0.5747 - val_loss: 2.8098 - val_accuracy20: 0.6099 - 67s/epoch - 28ms/step
Epoch 17/50
2440/2440 - 67s - loss: 2.6841 - accuracy20: 0.5758 - val_loss: 2.8023 - val_accuracy20: 0.6110 - 67s/epoch - 27ms/step
Epoch 18/50
2440/2440 - 67s - loss: 2.6814 - accuracy20: 0.5760 - val_loss: 2.8004 - val_accuracy20: 0.6103 - 67s/epoch - 27ms/step
Epoch 19/50
2440/2440 - 67s - loss: 2.6778 - accuracy20: 0.5764 - val_loss: 2.7775 - val_accuracy20: 0.6115 - 67s/epoch - 27ms/step
Epoch 20/50
2440/2440 - 67s - loss: 2.6752 - accuracy20: 0.5773 - val_loss: 2.7818 - val_accuracy20: 0.6107 - 67s/epoch - 28ms/step
Epoch 21/50
2440/2440 - 67s - loss: 2.6723 - accuracy20: 0.5777 - val_loss: 2.7923 - val_accuracy20: 0.6112 - 67s/epoch - 27ms/step
Epoch 22/50
2440/2440 - 67s - loss: 2.6691 - accuracy20: 0.5782 - val_loss: 2.7968 - val_accuracy20: 0.6113 - 67s/epoch - 28ms/step
Epoch 23/50
2440/2440 - 67s - loss: 2.6662 - accuracy20: 0.5792 - val_loss: 2.7935 - val_accuracy20: 0.6110 - 67s/epoch - 28ms/step
Epoch 24/50
2440/2440 - 67s - loss: 2.6626 - accuracy20: 0.5790 - val_loss: 2.8053 - val_accuracy20: 0.6110 - 67s/epoch - 27ms/step
Epoch 25/50
2440/2440 - 66s - loss: 2.6603 - accuracy20: 0.5801 - val_loss: 2.7758 - val_accuracy20: 0.6114 - 66s/epoch - 27ms/step
Epoch 26/50
2440/2440 - 67s - loss: 2.6581 - accuracy20: 0.5801 - val_loss: 2.7710 - val_accuracy20: 0.6114 - 67s/epoch - 27ms/step
Epoch 27/50
2440/2440 - 67s - loss: 2.6551 - accuracy20: 0.5807 - val_loss: 2.7762 - val_accuracy20: 0.6108 - 67s/epoch - 27ms/step
Epoch 28/50
2440/2440 - 67s - loss: 2.6534 - accuracy20: 0.5806 - val_loss: 2.7863 - val_accuracy20: 0.6113 - 67s/epoch - 28ms/step
Epoch 29/50
2440/2440 - 67s - loss: 2.6505 - accuracy20: 0.5817 - val_loss: 2.7978 - val_accuracy20: 0.6101 - 67s/epoch - 27ms/step
Epoch 30/50
2440/2440 - 67s - loss: 2.6490 - accuracy20: 0.5817 - val_loss: 2.7728 - val_accuracy20: 0.6105 - 67s/epoch - 28ms/step
Epoch 31/50
2440/2440 - 67s - loss: 2.6451 - accuracy20: 0.5827 - val_loss: 2.7865 - val_accuracy20: 0.6104 - 67s/epoch - 27ms/step
Epoch 32/50
2440/2440 - 67s - loss: 2.6424 - accuracy20: 0.5830 - val_loss: 2.7786 - val_accuracy20: 0.6106 - 67s/epoch - 27ms/step
Epoch 33/50
2440/2440 - 67s - loss: 2.6400 - accuracy20: 0.5837 - val_loss: 2.7983 - val_accuracy20: 0.6105 - 67s/epoch - 27ms/step
Epoch 34/50
2440/2440 - 67s - loss: 2.6382 - accuracy20: 0.5839 - val_loss: 2.7793 - val_accuracy20: 0.6115 - 67s/epoch - 28ms/step
Epoch 35/50
2440/2440 - 67s - loss: 2.6343 - accuracy20: 0.5845 - val_loss: 2.7946 - val_accuracy20: 0.6099 - 67s/epoch - 27ms/step
Epoch 36/50
2440/2440 - 67s - loss: 2.6323 - accuracy20: 0.5849 - val_loss: 2.7816 - val_accuracy20: 0.6100 - 67s/epoch - 28ms/step
testing model: results/ATVI/W3/deepOF_L2/h20
Evaluating performance on  test set...
6082/6082 - 76s - 76s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8490426
{'0': {'precision': 0.5494047647133764, 'recall': 0.3261677661526395, 'f1-score': 0.40932788204978576, 'support': 356985}, '1': {'precision': 0.6782959953482686, 'recall': 0.8589819810768804, 'f1-score': 0.7580204059069073, 'support': 846055}, '2': {'precision': 0.5261594950226377, 'recall': 0.4066938037087291, 'f1-score': 0.45877697314085825, 'support': 353760}, 'accuracy': 0.6340281346351491, 'macro avg': {'precision': 0.5846200850280941, 'recall': 0.5306145169794163, 'f1-score': 0.5420417536991838, 'support': 1556800}, 'weighted avg': {'precision': 0.6141695537222458, 'recall': 0.6340281346351491, 'f1-score': 0.6100641126101113, 'support': 1556800}}
[[116437 176617  63931]
 [ 53674 726746  65635]
 [ 41822 168066 143872]]
Evaluating performance on  train set...
2440/2440 - 32s - 32s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96154016
{'0': {'precision': 0.5436587342274554, 'recall': 0.36638154411969576, 'f1-score': 0.437753209961617, 'support': 179455}, '1': {'precision': 0.5866601942830998, 'recall': 0.7910603849105436, 'f1-score': 0.6736977673265265, 'support': 265828}, '2': {'precision': 0.5195005544038953, 'recall': 0.42069804017802365, 'f1-score': 0.4649078745034715, 'support': 179302}, 'accuracy': 0.5627208466421704, 'macro avg': {'precision': 0.5499398276381501, 'recall': 0.5260466564027543, 'f1-score': 0.525452950597205, 'support': 624585}, 'weighted avg': {'precision': 0.5550252930864544, 'recall': 0.5627208466421704, 'f1-score': 0.5459683535479707, 'support': 624585}}
[[ 65749  74164  39542]
 [ 25315 210286  30227]
 [ 29874  73996  75432]]
Evaluating performance on  val set...
826/826 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8797713
{'0': {'precision': 0.5580383875949447, 'recall': 0.3418740707844992, 'f1-score': 0.4239942528735632, 'support': 51791}, '1': {'precision': 0.6429052108699121, 'recall': 0.8532192871808565, 'f1-score': 0.7332800531746535, 'support': 108611}, '2': {'precision': 0.5284806567701305, 'recall': 0.36830864487812526, 'f1-score': 0.4340908041199021, 'support': 51036}, 'accuracy': 0.6109214048562699, 'macro avg': {'precision': 0.5764747517449957, 'recall': 0.521134000947827, 'f1-score': 0.5304550367227062, 'support': 211438}, 'weighted avg': {'precision': 0.5944980693567011, 'recall': 0.6109214048562699, 'f1-score': 0.5853045549285858, 'support': 211438}}
[[17706 25614  8471]
 [ 7642 92669  8300]
 [ 6381 25858 18797]]
training model: results/ATVI/W3/deepOF_L2/h30
Epoch 1/50
2440/2440 - 69s - loss: 3.0206 - accuracy30: 0.4852 - val_loss: 3.1448 - val_accuracy30: 0.5157 - 69s/epoch - 28ms/step
Epoch 2/50
2440/2440 - 67s - loss: 2.8891 - accuracy30: 0.5227 - val_loss: 3.0454 - val_accuracy30: 0.5319 - 67s/epoch - 27ms/step
Epoch 3/50
2440/2440 - 67s - loss: 2.8494 - accuracy30: 0.5326 - val_loss: 3.0226 - val_accuracy30: 0.5392 - 67s/epoch - 27ms/step
Epoch 4/50
2440/2440 - 67s - loss: 2.8316 - accuracy30: 0.5373 - val_loss: 3.0173 - val_accuracy30: 0.5413 - 67s/epoch - 27ms/step
Epoch 5/50
2440/2440 - 67s - loss: 2.8193 - accuracy30: 0.5402 - val_loss: 3.0069 - val_accuracy30: 0.5450 - 67s/epoch - 27ms/step
Epoch 6/50
2440/2440 - 67s - loss: 2.8101 - accuracy30: 0.5427 - val_loss: 3.0186 - val_accuracy30: 0.5453 - 67s/epoch - 27ms/step
Epoch 7/50
2440/2440 - 67s - loss: 2.8021 - accuracy30: 0.5433 - val_loss: 3.0158 - val_accuracy30: 0.5456 - 67s/epoch - 27ms/step
Epoch 8/50
2440/2440 - 67s - loss: 2.7958 - accuracy30: 0.5455 - val_loss: 2.9937 - val_accuracy30: 0.5493 - 67s/epoch - 27ms/step
Epoch 9/50
2440/2440 - 67s - loss: 2.7901 - accuracy30: 0.5468 - val_loss: 2.9942 - val_accuracy30: 0.5496 - 67s/epoch - 28ms/step
Epoch 10/50
2440/2440 - 67s - loss: 2.7848 - accuracy30: 0.5479 - val_loss: 2.9902 - val_accuracy30: 0.5505 - 67s/epoch - 27ms/step
Epoch 11/50
2440/2440 - 67s - loss: 2.7801 - accuracy30: 0.5488 - val_loss: 2.9931 - val_accuracy30: 0.5517 - 67s/epoch - 28ms/step
Epoch 12/50
2440/2440 - 67s - loss: 2.7760 - accuracy30: 0.5496 - val_loss: 2.9773 - val_accuracy30: 0.5525 - 67s/epoch - 27ms/step
Epoch 13/50
2440/2440 - 67s - loss: 2.7721 - accuracy30: 0.5506 - val_loss: 2.9853 - val_accuracy30: 0.5524 - 67s/epoch - 27ms/step
Epoch 14/50
2440/2440 - 67s - loss: 2.7678 - accuracy30: 0.5516 - val_loss: 2.9748 - val_accuracy30: 0.5541 - 67s/epoch - 28ms/step
Epoch 15/50
2440/2440 - 67s - loss: 2.7642 - accuracy30: 0.5527 - val_loss: 2.9689 - val_accuracy30: 0.5544 - 67s/epoch - 28ms/step
Epoch 16/50
2440/2440 - 67s - loss: 2.7616 - accuracy30: 0.5532 - val_loss: 2.9639 - val_accuracy30: 0.5530 - 67s/epoch - 27ms/step
Epoch 17/50
2440/2440 - 67s - loss: 2.7583 - accuracy30: 0.5539 - val_loss: 2.9669 - val_accuracy30: 0.5553 - 67s/epoch - 28ms/step
Epoch 18/50
2440/2440 - 67s - loss: 2.7549 - accuracy30: 0.5547 - val_loss: 2.9966 - val_accuracy30: 0.5534 - 67s/epoch - 27ms/step
Epoch 19/50
2440/2440 - 66s - loss: 2.7530 - accuracy30: 0.5549 - val_loss: 2.9783 - val_accuracy30: 0.5545 - 66s/epoch - 27ms/step
Epoch 20/50
2440/2440 - 67s - loss: 2.7496 - accuracy30: 0.5559 - val_loss: 2.9880 - val_accuracy30: 0.5540 - 67s/epoch - 27ms/step
Epoch 21/50
2440/2440 - 66s - loss: 2.7459 - accuracy30: 0.5569 - val_loss: 2.9787 - val_accuracy30: 0.5548 - 66s/epoch - 27ms/step
Epoch 22/50
2440/2440 - 67s - loss: 2.7448 - accuracy30: 0.5569 - val_loss: 2.9900 - val_accuracy30: 0.5548 - 67s/epoch - 27ms/step
Epoch 23/50
2440/2440 - 67s - loss: 2.7401 - accuracy30: 0.5580 - val_loss: 2.9530 - val_accuracy30: 0.5555 - 67s/epoch - 28ms/step
Epoch 24/50
2440/2440 - 67s - loss: 2.7378 - accuracy30: 0.5585 - val_loss: 2.9721 - val_accuracy30: 0.5549 - 67s/epoch - 28ms/step
Epoch 25/50
2440/2440 - 67s - loss: 2.7356 - accuracy30: 0.5587 - val_loss: 2.9663 - val_accuracy30: 0.5550 - 67s/epoch - 28ms/step
Epoch 26/50
2440/2440 - 68s - loss: 2.7334 - accuracy30: 0.5600 - val_loss: 2.9833 - val_accuracy30: 0.5547 - 68s/epoch - 28ms/step
Epoch 27/50
2440/2440 - 67s - loss: 2.7307 - accuracy30: 0.5599 - val_loss: 2.9743 - val_accuracy30: 0.5530 - 67s/epoch - 28ms/step
Epoch 28/50
2440/2440 - 67s - loss: 2.7276 - accuracy30: 0.5610 - val_loss: 2.9777 - val_accuracy30: 0.5533 - 67s/epoch - 28ms/step
Epoch 29/50
2440/2440 - 67s - loss: 2.7246 - accuracy30: 0.5619 - val_loss: 3.0112 - val_accuracy30: 0.5538 - 67s/epoch - 28ms/step
Epoch 30/50
2440/2440 - 68s - loss: 2.7225 - accuracy30: 0.5620 - val_loss: 2.9834 - val_accuracy30: 0.5547 - 68s/epoch - 28ms/step
Epoch 31/50
2440/2440 - 68s - loss: 2.7203 - accuracy30: 0.5623 - val_loss: 2.9792 - val_accuracy30: 0.5545 - 68s/epoch - 28ms/step
Epoch 32/50
2440/2440 - 67s - loss: 2.7170 - accuracy30: 0.5630 - val_loss: 2.9690 - val_accuracy30: 0.5534 - 67s/epoch - 27ms/step
Epoch 33/50
2440/2440 - 67s - loss: 2.7137 - accuracy30: 0.5633 - val_loss: 2.9922 - val_accuracy30: 0.5542 - 67s/epoch - 28ms/step
testing model: results/ATVI/W3/deepOF_L2/h30
Evaluating performance on  test set...
6082/6082 - 81s - 81s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9384401
{'0': {'precision': 0.5327061968283342, 'recall': 0.35259692757863936, 'f1-score': 0.42433052166079765, 'support': 411467}, '1': {'precision': 0.6004229545182531, 'recall': 0.86190695220444, 'f1-score': 0.7077865485528222, 'support': 739190}, '2': {'precision': 0.570496632996633, 'recall': 0.3137244763543875, 'f1-score': 0.40482805840311237, 'support': 406143}, 'accuracy': 0.5842831449126413, 'macro avg': {'precision': 0.5678752614477401, 'recall': 0.5094094520458223, 'f1-score': 0.512315042872244, 'support': 1556800}, 'weighted avg': {'precision': 0.5747179332321835, 'recall': 0.5842831449126413, 'f1-score': 0.5538314669225202, 'support': 1556800}}
[[145082 212073  54312]
 [ 60462 637113  41615]
 [ 66805 211921 127417]]
Evaluating performance on  train set...
2440/2440 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0366385
{'0': {'precision': 0.5313329792883696, 'recall': 0.39694701917783765, 'f1-score': 0.4544125536861408, 'support': 201639}, '1': {'precision': 0.4947651957594379, 'recall': 0.813195839068529, 'f1-score': 0.615218630821705, 'support': 221585}, '2': {'precision': 0.559390603929001, 'recall': 0.3048852558340493, 'f1-score': 0.39466553523041764, 'support': 201361}, 'accuracy': 0.5149403203727275, 'macro avg': {'precision': 0.5284962596589362, 'recall': 0.5050093713601387, 'f1-score': 0.4880989065794212, 'support': 624585}, 'weighted avg': {'precision': 0.5274053137856819, 'recall': 0.5149403203727275, 'f1-score': 0.4922000369251254, 'support': 624585}}
[[ 80040  89984  31615]
 [ 24652 180192  16741]
 [ 45948  94021  61392]]
Evaluating performance on  val set...
826/826 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9731165
{'0': {'precision': 0.5422430830039525, 'recall': 0.3658150425812043, 'f1-score': 0.43688982215897215, 'support': 60003}, '1': {'precision': 0.5563894027714754, 'recall': 0.8593547830587424, 'f1-score': 0.6754552118954698, 'support': 92744}, '2': {'precision': 0.5732688629884891, 'recall': 0.27068886200609976, 'f1-score': 0.36773760474052125, 'support': 58691}, 'accuracy': 0.555893453400051, 'macro avg': {'precision': 0.5573004495879723, 'recall': 0.49861956254868217, 'f1-score': 0.49336087959832103, 'support': 211438}, 'weighted avg': {'precision': 0.5570602886793352, 'recall': 0.555893453400051, 'f1-score': 0.5223375454311154, 'support': 211438}}
[[21950 30977  7076]
 [ 8294 79700  4750]
 [10236 32568 15887]]
training model: results/ATVI/W3/deepOF_L2/h50
Epoch 1/50
2440/2440 - 70s - loss: 3.1165 - accuracy50: 0.4539 - val_loss: 3.2981 - val_accuracy50: 0.4546 - 70s/epoch - 28ms/step
Epoch 2/50
2440/2440 - 67s - loss: 3.0279 - accuracy50: 0.4833 - val_loss: 3.2446 - val_accuracy50: 0.4677 - 67s/epoch - 28ms/step
Epoch 3/50
2440/2440 - 67s - loss: 3.0005 - accuracy50: 0.4914 - val_loss: 3.1915 - val_accuracy50: 0.4785 - 67s/epoch - 27ms/step
Epoch 4/50
2440/2440 - 67s - loss: 2.9837 - accuracy50: 0.4952 - val_loss: 3.1298 - val_accuracy50: 0.4861 - 67s/epoch - 27ms/step
Epoch 5/50
2440/2440 - 67s - loss: 2.9718 - accuracy50: 0.4988 - val_loss: 3.1286 - val_accuracy50: 0.4894 - 67s/epoch - 27ms/step
Epoch 6/50
2440/2440 - 67s - loss: 2.9638 - accuracy50: 0.5012 - val_loss: 3.1212 - val_accuracy50: 0.4929 - 67s/epoch - 27ms/step
Epoch 7/50
2440/2440 - 67s - loss: 2.9562 - accuracy50: 0.5029 - val_loss: 3.1214 - val_accuracy50: 0.4941 - 67s/epoch - 27ms/step
Epoch 8/50
2440/2440 - 67s - loss: 2.9512 - accuracy50: 0.5043 - val_loss: 3.1379 - val_accuracy50: 0.4945 - 67s/epoch - 27ms/step
Epoch 9/50
2440/2440 - 67s - loss: 2.9460 - accuracy50: 0.5059 - val_loss: 3.1200 - val_accuracy50: 0.4964 - 67s/epoch - 27ms/step
Epoch 10/50
2440/2440 - 67s - loss: 2.9415 - accuracy50: 0.5071 - val_loss: 3.1311 - val_accuracy50: 0.4962 - 67s/epoch - 27ms/step
Epoch 11/50
2440/2440 - 66s - loss: 2.9382 - accuracy50: 0.5077 - val_loss: 3.1282 - val_accuracy50: 0.4975 - 66s/epoch - 27ms/step
Epoch 12/50
2440/2440 - 67s - loss: 2.9353 - accuracy50: 0.5084 - val_loss: 3.1506 - val_accuracy50: 0.4963 - 67s/epoch - 27ms/step
Epoch 13/50
2440/2440 - 66s - loss: 2.9315 - accuracy50: 0.5095 - val_loss: 3.1354 - val_accuracy50: 0.4966 - 66s/epoch - 27ms/step
Epoch 14/50
2440/2440 - 67s - loss: 2.9278 - accuracy50: 0.5111 - val_loss: 3.1343 - val_accuracy50: 0.4980 - 67s/epoch - 27ms/step
Epoch 15/50
2440/2440 - 67s - loss: 2.9244 - accuracy50: 0.5119 - val_loss: 3.1646 - val_accuracy50: 0.4962 - 67s/epoch - 27ms/step
Epoch 16/50
2440/2440 - 67s - loss: 2.9227 - accuracy50: 0.5123 - val_loss: 3.1650 - val_accuracy50: 0.4964 - 67s/epoch - 27ms/step
Epoch 17/50
2440/2440 - 67s - loss: 2.9189 - accuracy50: 0.5133 - val_loss: 3.1744 - val_accuracy50: 0.4972 - 67s/epoch - 28ms/step
Epoch 18/50
2440/2440 - 67s - loss: 2.9165 - accuracy50: 0.5137 - val_loss: 3.1876 - val_accuracy50: 0.4962 - 67s/epoch - 27ms/step
Epoch 19/50
2440/2440 - 67s - loss: 2.9137 - accuracy50: 0.5153 - val_loss: 3.1608 - val_accuracy50: 0.4975 - 67s/epoch - 27ms/step
testing model: results/ATVI/W3/deepOF_L2/h50
Evaluating performance on  test set...
6082/6082 - 76s - 76s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9977105
{'0': {'precision': 0.5156099145119104, 'recall': 0.2691340321427917, 'f1-score': 0.3536648505463411, 'support': 436552}, '1': {'precision': 0.5383508994878536, 'recall': 0.8635061457277774, 'f1-score': 0.6632192802431339, 'support': 684866}, '2': {'precision': 0.5335998055707454, 'recall': 0.2823979861363125, 'f1-score': 0.3693331330729949, 'support': 435382}, 'accuracy': 0.5343191161356629, 'macro avg': {'precision': 0.5291868731901698, 'recall': 0.4716793880022938, 'f1-score': 0.46207242128749, 'support': 1556800}, 'weighted avg': {'precision': 0.5306452447826658, 'recall': 0.5343191161356629, 'f1-score': 0.4942256112296295, 'support': 1556800}}
[[117491 259763  59298]
 [ 45311 591386  48169]
 [ 65066 247365 122951]]
Evaluating performance on  train set...
2440/2440 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0856743
{'0': {'precision': 0.5003272323496754, 'recall': 0.32511766814000714, 'f1-score': 0.3941273923722138, 'support': 209275}, '1': {'precision': 0.43660246068302694, 'recall': 0.7958084238472196, 'f1-score': 0.5638572661850748, 'support': 206414}, '2': {'precision': 0.5195400457462241, 'recall': 0.27944527420343135, 'f1-score': 0.3634184681950475, 'support': 208896}, 'accuracy': 0.4653970236236861, 'macro avg': {'precision': 0.4854899129263088, 'recall': 0.466790455396886, 'f1-score': 0.44046770891744536, 'support': 624585}, 'weighted avg': {'precision': 0.48569318710120785, 'recall': 0.4653970236236861, 'f1-score': 0.439949259289118, 'support': 624585}}
[[ 68039 106274  34962]
 [ 23126 164266  19022]
 [ 44824 105697  58375]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0406874
{'0': {'precision': 0.5171963677639047, 'recall': 0.2809749179089522, 'f1-score': 0.3641303804928726, 'support': 64867}, '1': {'precision': 0.4848805861701333, 'recall': 0.8518019253939662, 'f1-score': 0.617981028872118, 'support': 83827}, '2': {'precision': 0.5313612330234647, 'recall': 0.2450592885375494, 'f1-score': 0.3354239155332075, 'support': 62744}, 'accuracy': 0.4966278530822274, 'macro avg': {'precision': 0.5111460623191676, 'recall': 0.45927871061348924, 'f1-score': 0.4391784416327327, 'support': 211438}, 'weighted avg': {'precision': 0.5085878171825747, 'recall': 0.4966278530822274, 'f1-score': 0.4562537446197456, 'support': 211438}}
[[18226 38617  8024]
 [ 6886 71404  5537]
 [10128 37240 15376]]
training model: results/ATVI/W3/deepOF_L2/h100
Epoch 1/50
2440/2440 - 72s - loss: 3.2417 - accuracy100: 0.3983 - val_loss: 3.2977 - val_accuracy100: 0.3626 - 72s/epoch - 29ms/step
Epoch 2/50
2440/2440 - 67s - loss: 3.2051 - accuracy100: 0.4174 - val_loss: 3.3175 - val_accuracy100: 0.3629 - 67s/epoch - 27ms/step
Epoch 3/50
2440/2440 - 67s - loss: 3.1939 - accuracy100: 0.4228 - val_loss: 3.3106 - val_accuracy100: 0.3662 - 67s/epoch - 27ms/step
Epoch 4/50
2440/2440 - 67s - loss: 3.1872 - accuracy100: 0.4254 - val_loss: 3.3109 - val_accuracy100: 0.3714 - 67s/epoch - 27ms/step
Epoch 5/50
2440/2440 - 69s - loss: 3.1815 - accuracy100: 0.4278 - val_loss: 3.3039 - val_accuracy100: 0.3753 - 69s/epoch - 28ms/step
Epoch 6/50
2440/2440 - 67s - loss: 3.1765 - accuracy100: 0.4298 - val_loss: 3.3042 - val_accuracy100: 0.3810 - 67s/epoch - 27ms/step
Epoch 7/50
2440/2440 - 67s - loss: 3.1727 - accuracy100: 0.4310 - val_loss: 3.3132 - val_accuracy100: 0.3819 - 67s/epoch - 27ms/step
Epoch 8/50
2440/2440 - 67s - loss: 3.1683 - accuracy100: 0.4327 - val_loss: 3.3147 - val_accuracy100: 0.3855 - 67s/epoch - 28ms/step
Epoch 9/50
2440/2440 - 67s - loss: 3.1657 - accuracy100: 0.4335 - val_loss: 3.3207 - val_accuracy100: 0.3868 - 67s/epoch - 27ms/step
Epoch 10/50
2440/2440 - 67s - loss: 3.1626 - accuracy100: 0.4350 - val_loss: 3.3276 - val_accuracy100: 0.3894 - 67s/epoch - 28ms/step
Epoch 11/50
2440/2440 - 67s - loss: 3.1599 - accuracy100: 0.4361 - val_loss: 3.3225 - val_accuracy100: 0.3912 - 67s/epoch - 28ms/step
testing model: results/ATVI/W3/deepOF_L2/h100
Evaluating performance on  test set...
6082/6082 - 75s - 75s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0864538
{'0': {'precision': 0.42660286784010937, 'recall': 0.16277576344362224, 'f1-score': 0.2356400582378197, 'support': 506095}, '1': {'precision': 0.3713781199790013, 'recall': 0.8490244212899823, 'f1-score': 0.5167296571950308, 'support': 549930}, '2': {'precision': 0.4623895259831131, 'recall': 0.09831161699365983, 'f1-score': 0.16214791979553655, 'support': 500775}, 'accuracy': 0.38445272353545734, 'macro avg': {'precision': 0.42012350460074127, 'recall': 0.3700372672424215, 'f1-score': 0.3048392117427957, 'support': 1556800}, 'weighted avg': {'precision': 0.4186065408490402, 'recall': 0.38445272353545734, 'f1-score': 0.31129304996835977, 'support': 1556800}}
[[ 82380 396155  27560]
 [ 53345 466904  29681]
 [ 57382 394161  49232]]
Evaluating performance on  train set...
2440/2440 - 30s - 30s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1072241
{'0': {'precision': 0.38796082068635146, 'recall': 0.18216536733140945, 'f1-score': 0.24792064246774306, 'support': 208953}, '1': {'precision': 0.3379860521904683, 'recall': 0.7926320284973842, 'f1-score': 0.47389755166230463, 'support': 206054}, '2': {'precision': 0.412931871791314, 'recall': 0.08519978241991048, 'f1-score': 0.14125464757535003, 'support': 209578}, 'accuracy': 0.351025080653554, 'macro avg': {'precision': 0.37962624822271124, 'recall': 0.353332392749568, 'f1-score': 0.28769094723513255, 'support': 624585}, 'weighted avg': {'precision': 0.3798528481939367, 'recall': 0.351025080653554, 'f1-score': 0.28668013904485945, 'support': 624585}}
[[ 38064 159118  11771]
 [ 29114 163325  13615]
 [ 30935 160787  17856]]
Evaluating performance on  val set...
826/826 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.100462
{'0': {'precision': 0.41352979547983576, 'recall': 0.1497304657107925, 'f1-score': 0.21985576874037355, 'support': 71976}, '1': {'precision': 0.3494706046252438, 'recall': 0.8345670797637861, 'f1-score': 0.4926476003436849, 'support': 72138}, '2': {'precision': 0.43296451735978636, 'recall': 0.08427900897154061, 'f1-score': 0.14109338671374755, 'support': 67324}, 'accuracy': 0.36254126505169365, 'macro avg': {'precision': 0.39865497248828863, 'recall': 0.35619218481537307, 'f1-score': 0.28453225193260195, 'support': 211438}, 'weighted avg': {'precision': 0.3978624192559651, 'recall': 0.36254126505169365, 'f1-score': 0.2878476081478552, 'support': 211438}}
[[10777 57810  3389]
 [ 7892 60204  4042]
 [ 7392 54258  5674]]
training model: results/ATVI/W3/deepOF_L2/h200
Epoch 1/50
2440/2440 - 71s - loss: 3.2756 - accuracy200: 0.3739 - val_loss: 3.3030 - val_accuracy200: 0.3463 - 71s/epoch - 29ms/step
Epoch 2/50
2440/2440 - 67s - loss: 3.2501 - accuracy200: 0.3878 - val_loss: 3.3101 - val_accuracy200: 0.3447 - 67s/epoch - 27ms/step
Epoch 3/50
2440/2440 - 67s - loss: 3.2423 - accuracy200: 0.3926 - val_loss: 3.3111 - val_accuracy200: 0.3447 - 67s/epoch - 27ms/step
Epoch 4/50
2440/2440 - 67s - loss: 3.2379 - accuracy200: 0.3953 - val_loss: 3.3154 - val_accuracy200: 0.3453 - 67s/epoch - 28ms/step
Epoch 5/50
2440/2440 - 67s - loss: 3.2349 - accuracy200: 0.3974 - val_loss: 3.3203 - val_accuracy200: 0.3458 - 67s/epoch - 27ms/step
Epoch 6/50
2440/2440 - 66s - loss: 3.2322 - accuracy200: 0.3987 - val_loss: 3.3192 - val_accuracy200: 0.3468 - 66s/epoch - 27ms/step
Epoch 7/50
2440/2440 - 67s - loss: 3.2296 - accuracy200: 0.4002 - val_loss: 3.3242 - val_accuracy200: 0.3471 - 67s/epoch - 27ms/step
Epoch 8/50
2440/2440 - 67s - loss: 3.2273 - accuracy200: 0.4019 - val_loss: 3.3257 - val_accuracy200: 0.3482 - 67s/epoch - 27ms/step
Epoch 9/50
2440/2440 - 67s - loss: 3.2250 - accuracy200: 0.4031 - val_loss: 3.3326 - val_accuracy200: 0.3484 - 67s/epoch - 27ms/step
Epoch 10/50
2440/2440 - 66s - loss: 3.2223 - accuracy200: 0.4051 - val_loss: 3.3335 - val_accuracy200: 0.3513 - 66s/epoch - 27ms/step
Epoch 11/50
2440/2440 - 67s - loss: 3.2199 - accuracy200: 0.4061 - val_loss: 3.3289 - val_accuracy200: 0.3534 - 67s/epoch - 27ms/step
testing model: results/ATVI/W3/deepOF_L2/h200
Evaluating performance on  test set...
6082/6082 - 74s - 74s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1005795
{'0': {'precision': 0.41400534513943255, 'recall': 0.03005008347245409, 'f1-score': 0.05603307325111301, 'support': 510348}, '1': {'precision': 0.3495268439396969, 'recall': 0.9582793665278247, 'f1-score': 0.5122232329440688, 'support': 543544}, '2': {'precision': 0.38245744644851276, 'recall': 0.022473295314451153, 'f1-score': 0.042452094903081744, 'support': 502908}, 'accuracy': 0.3516861510791367, 'macro avg': {'precision': 0.3819965451758807, 'recall': 0.3369342484382433, 'f1-score': 0.2035694670327545, 'support': 1556800}, 'weighted avg': {'precision': 0.3813019836986809, 'recall': 0.3516861510791367, 'f1-score': 0.2109209467744277, 'support': 1556800}}
[[ 15336 486997   8015]
 [ 12443 520867  10234]
 [  9264 482342  11302]]
Evaluating performance on  train set...
2440/2440 - 30s - 30s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1099077
{'0': {'precision': 0.40715153355602796, 'recall': 0.02576767293361329, 'f1-score': 0.048467923778021796, 'support': 208129}, '1': {'precision': 0.3304467418035175, 'recall': 0.9636045834142551, 'f1-score': 0.4921288495610332, 'support': 205960}, '2': {'precision': 0.3927911275415896, 'recall': 0.020190407418668288, 'f1-score': 0.03840662220535344, 'support': 210496}, 'accuracy': 0.33314440788683686, 'macro avg': {'precision': 0.3767964676337117, 'recall': 0.3365208879221789, 'f1-score': 0.19300113184813614, 'support': 624585}, 'weighted avg': {'precision': 0.37701804182349796, 'recall': 0.33314440788683686, 'f1-score': 0.1913764799207864, 'support': 624585}}
[[  5363 199480   3286]
 [  4212 198464   3284]
 [  3597 202649   4250]]
Evaluating performance on  val set...
826/826 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1019316
{'0': {'precision': 0.4347900307272107, 'recall': 0.03527994016123224, 'f1-score': 0.06526418285245733, 'support': 72194}, '1': {'precision': 0.3428282379648136, 'recall': 0.96007352331463, 'f1-score': 0.5052419516133138, 'support': 72358}, '2': {'precision': 0.37860780984719866, 'recall': 0.016670155189426786, 'f1-score': 0.03193424123956409, 'support': 66886}, 'accuracy': 0.34587444073439966, 'macro avg': {'precision': 0.3854086928464076, 'recall': 0.33734120622176306, 'f1-score': 0.2008134585684451, 'support': 211438}, 'weighted avg': {'precision': 0.3855463970072454, 'recall': 0.34587444073439966, 'f1-score': 0.20528917796817953, 'support': 211438}}
[[ 2547 68742   905]
 [ 1964 69469   925]
 [ 1347 64424  1115]]
training model: results/ATVI/W3/deepOF_L2/h300
Epoch 1/50
2440/2440 - 69s - loss: 3.2679 - accuracy300: 0.3840 - val_loss: 3.2984 - val_accuracy300: 0.3430 - 69s/epoch - 28ms/step
Epoch 2/50
2440/2440 - 67s - loss: 3.2439 - accuracy300: 0.3936 - val_loss: 3.3043 - val_accuracy300: 0.3410 - 67s/epoch - 28ms/step
Epoch 3/50
2440/2440 - 67s - loss: 3.2387 - accuracy300: 0.3959 - val_loss: 3.3070 - val_accuracy300: 0.3410 - 67s/epoch - 28ms/step
Epoch 4/50
2440/2440 - 68s - loss: 3.2366 - accuracy300: 0.3964 - val_loss: 3.3057 - val_accuracy300: 0.3443 - 68s/epoch - 28ms/step
Epoch 5/50
2440/2440 - 67s - loss: 3.2348 - accuracy300: 0.3977 - val_loss: 3.3058 - val_accuracy300: 0.3446 - 67s/epoch - 28ms/step
Epoch 6/50
2440/2440 - 67s - loss: 3.2336 - accuracy300: 0.3985 - val_loss: 3.3055 - val_accuracy300: 0.3438 - 67s/epoch - 28ms/step
Epoch 7/50
2440/2440 - 67s - loss: 3.2322 - accuracy300: 0.4001 - val_loss: 3.3014 - val_accuracy300: 0.3490 - 67s/epoch - 28ms/step
Epoch 8/50
2440/2440 - 68s - loss: 3.2303 - accuracy300: 0.4011 - val_loss: 3.2980 - val_accuracy300: 0.3565 - 68s/epoch - 28ms/step
Epoch 9/50
2440/2440 - 67s - loss: 3.2291 - accuracy300: 0.4021 - val_loss: 3.2963 - val_accuracy300: 0.3587 - 67s/epoch - 28ms/step
Epoch 10/50
2440/2440 - 68s - loss: 3.2278 - accuracy300: 0.4030 - val_loss: 3.2909 - val_accuracy300: 0.3641 - 68s/epoch - 28ms/step
Epoch 11/50
2440/2440 - 68s - loss: 3.2266 - accuracy300: 0.4042 - val_loss: 3.2885 - val_accuracy300: 0.3663 - 68s/epoch - 28ms/step
Epoch 12/50
2440/2440 - 68s - loss: 3.2256 - accuracy300: 0.4052 - val_loss: 3.2879 - val_accuracy300: 0.3707 - 68s/epoch - 28ms/step
Epoch 13/50
2440/2440 - 67s - loss: 3.2244 - accuracy300: 0.4061 - val_loss: 3.2870 - val_accuracy300: 0.3699 - 67s/epoch - 28ms/step
Epoch 14/50
2440/2440 - 67s - loss: 3.2230 - accuracy300: 0.4076 - val_loss: 3.2872 - val_accuracy300: 0.3717 - 67s/epoch - 27ms/step
Epoch 15/50
2440/2440 - 67s - loss: 3.2212 - accuracy300: 0.4084 - val_loss: 3.2848 - val_accuracy300: 0.3733 - 67s/epoch - 27ms/step
Epoch 16/50
2440/2440 - 67s - loss: 3.2199 - accuracy300: 0.4092 - val_loss: 3.2841 - val_accuracy300: 0.3737 - 67s/epoch - 28ms/step
Epoch 17/50
2440/2440 - 67s - loss: 3.2193 - accuracy300: 0.4095 - val_loss: 3.2849 - val_accuracy300: 0.3757 - 67s/epoch - 27ms/step
Epoch 18/50
2440/2440 - 67s - loss: 3.2172 - accuracy300: 0.4118 - val_loss: 3.2869 - val_accuracy300: 0.3742 - 67s/epoch - 27ms/step
Epoch 19/50
2440/2440 - 67s - loss: 3.2158 - accuracy300: 0.4117 - val_loss: 3.2863 - val_accuracy300: 0.3755 - 67s/epoch - 27ms/step
Epoch 20/50
2440/2440 - 67s - loss: 3.2143 - accuracy300: 0.4131 - val_loss: 3.2862 - val_accuracy300: 0.3763 - 67s/epoch - 27ms/step
Epoch 21/50
2440/2440 - 67s - loss: 3.2129 - accuracy300: 0.4142 - val_loss: 3.2920 - val_accuracy300: 0.3747 - 67s/epoch - 27ms/step
Epoch 22/50
2440/2440 - 67s - loss: 3.2112 - accuracy300: 0.4147 - val_loss: 3.2948 - val_accuracy300: 0.3726 - 67s/epoch - 28ms/step
Epoch 23/50
2440/2440 - 67s - loss: 3.2089 - accuracy300: 0.4163 - val_loss: 3.2978 - val_accuracy300: 0.3723 - 67s/epoch - 27ms/step
Epoch 24/50
2440/2440 - 67s - loss: 3.2066 - accuracy300: 0.4181 - val_loss: 3.3037 - val_accuracy300: 0.3730 - 67s/epoch - 27ms/step
Epoch 25/50
2440/2440 - 67s - loss: 3.2047 - accuracy300: 0.4189 - val_loss: 3.3068 - val_accuracy300: 0.3714 - 67s/epoch - 27ms/step
Epoch 26/50
2440/2440 - 68s - loss: 3.2013 - accuracy300: 0.4215 - val_loss: 3.3090 - val_accuracy300: 0.3720 - 68s/epoch - 28ms/step
testing model: results/ATVI/W3/deepOF_L2/h300
Evaluating performance on  test set...
6082/6082 - 77s - 77s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1016335
{'0': {'precision': 0.39544186299947276, 'recall': 0.453267766147787, 'f1-score': 0.4223848622129633, 'support': 544378}, '1': {'precision': 0.32940116706518213, 'recall': 0.4167183388915889, 'f1-score': 0.3679504585323266, 'support': 477368}, '2': {'precision': 0.39521569795900996, 'recall': 0.2429474408190575, 'f1-score': 0.300915664212472, 'support': 535054}, 'accuracy': 0.3697758221993834, 'macro avg': {'precision': 0.3733529093412216, 'recall': 0.37097784861947786, 'f1-score': 0.36375032831925397, 'support': 1556800}, 'weighted avg': {'precision': 0.3751138019471088, 'recall': 0.3697758221993834, 'f1-score': 0.36394587025306285, 'support': 1556800}}
[[246749 197893  99736]
 [179257 198928  99183]
 [197977 207087 129990]]
Evaluating performance on  train set...
2440/2440 - 30s - 30s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0961341
{'0': {'precision': 0.3766357280663957, 'recall': 0.4663068501314468, 'f1-score': 0.4167017411247305, 'support': 208069}, '1': {'precision': 0.3608825468858153, 'recall': 0.4271227192523219, 'f1-score': 0.3912185397236979, 'support': 206292}, '2': {'precision': 0.3805619560172935, 'recall': 0.22233902884542203, 'f1-score': 0.28068879580837425, 'support': 210224}, 'accuracy': 0.37124970980731203, 'macro avg': {'precision': 0.3726934103231681, 'recall': 0.3719228660763969, 'f1-score': 0.3628696922189342, 'support': 624585}, 'weighted avg': {'precision': 0.3727541620547964, 'recall': 0.37124970980731203, 'f1-score': 0.36250548921408987, 'support': 624585}}
[[97024 75563 35482]
 [77582 88112 40598]
 [83001 80482 46741]]
Evaluating performance on  val set...
826/826 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.094821
{'0': {'precision': 0.38651175333722865, 'recall': 0.4738930372248092, 'f1-score': 0.42576524612890054, 'support': 72586}, '1': {'precision': 0.36014362207876693, 'recall': 0.4066247616357087, 'f1-score': 0.38197535942465516, 'support': 70795}, '2': {'precision': 0.37687602916960716, 'recall': 0.2354056158808058, 'f1-score': 0.2897971365778216, 'support': 68057}, 'accuracy': 0.3746062675583386, 'macro avg': {'precision': 0.3745104681952009, 'recall': 0.3719744715804412, 'f1-score': 0.3658459140437924, 'support': 211438}, 'weighted avg': {'precision': 0.3745814932509688, 'recall': 0.3746062675583386, 'f1-score': 0.36733825258495467, 'support': 211438}}
[[34398 25785 12403]
 [27922 28787 14086]
 [26676 25360 16021]]
training model: results/ATVI/W3/deepOF_L2/h500
Epoch 1/50
2440/2440 - 70s - loss: 3.2575 - accuracy500: 0.3908 - val_loss: 3.5935 - val_accuracy500: 0.2954 - 70s/epoch - 29ms/step
Epoch 2/50
2440/2440 - 67s - loss: 3.2315 - accuracy500: 0.4028 - val_loss: 3.6146 - val_accuracy500: 0.2947 - 67s/epoch - 27ms/step
Epoch 3/50
2440/2440 - 66s - loss: 3.2251 - accuracy500: 0.4055 - val_loss: 3.6259 - val_accuracy500: 0.2949 - 66s/epoch - 27ms/step
Epoch 4/50
2440/2440 - 67s - loss: 3.2223 - accuracy500: 0.4073 - val_loss: 3.6284 - val_accuracy500: 0.2949 - 67s/epoch - 27ms/step
Epoch 5/50
2440/2440 - 66s - loss: 3.2209 - accuracy500: 0.4076 - val_loss: 3.6327 - val_accuracy500: 0.2948 - 66s/epoch - 27ms/step
Epoch 6/50
2440/2440 - 67s - loss: 3.2202 - accuracy500: 0.4076 - val_loss: 3.6359 - val_accuracy500: 0.2950 - 67s/epoch - 27ms/step
Epoch 7/50
2440/2440 - 67s - loss: 3.2188 - accuracy500: 0.4084 - val_loss: 3.6478 - val_accuracy500: 0.2949 - 67s/epoch - 27ms/step
Epoch 8/50
2440/2440 - 67s - loss: 3.2179 - accuracy500: 0.4088 - val_loss: 3.6446 - val_accuracy500: 0.2950 - 67s/epoch - 27ms/step
Epoch 9/50
2440/2440 - 67s - loss: 3.2172 - accuracy500: 0.4088 - val_loss: 3.6549 - val_accuracy500: 0.2951 - 67s/epoch - 27ms/step
Epoch 10/50
2440/2440 - 67s - loss: 3.2162 - accuracy500: 0.4100 - val_loss: 3.6553 - val_accuracy500: 0.2952 - 67s/epoch - 27ms/step
Epoch 11/50
2440/2440 - 66s - loss: 3.2158 - accuracy500: 0.4095 - val_loss: 3.6523 - val_accuracy500: 0.2952 - 66s/epoch - 27ms/step
testing model: results/ATVI/W3/deepOF_L2/h500
Evaluating performance on  test set...
6082/6082 - 74s - 74s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2396114
{'0': {'precision': 0.3673913043478261, 'recall': 0.0008507125346703112, 'f1-score': 0.0016974944379435208, 'support': 595971}, '1': {'precision': 0.2447722907604559, 'recall': 0.9908770273636733, 'f1-score': 0.3925696980400916, 'support': 381345}, '2': {'precision': 0.37379014989293363, 'recall': 0.007530837779817907, 'f1-score': 0.014764217410206055, 'support': 579484}, 'accuracy': 0.24584853545734842, 'macro avg': {'precision': 0.32865124833373854, 'recall': 0.33308619255938715, 'f1-score': 0.1363438032960804, 'support': 1556800}, 'weighted avg': {'precision': 0.3397370654445537, 'recall': 0.24584853545734842, 'f1-score': 0.10230715359616535, 'support': 1556800}}
[[   507 591257   4207]
 [   375 377866   3104]
 [   498 574622   4364]]
Evaluating performance on  train set...
2440/2440 - 32s - 32s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1654994
{'0': {'precision': 0.3587385019710907, 'recall': 0.001316436651911003, 'f1-score': 0.0026232469647687363, 'support': 207378}, '1': {'precision': 0.33141628916099125, 'recall': 0.9918827082808961, 'f1-score': 0.49682813498216166, 'support': 206596}, '2': {'precision': 0.3797858827798948, 'recall': 0.00993775253904117, 'f1-score': 0.01936868990662681, 'support': 210611}, 'accuracy': 0.33187636590696223, 'macro avg': {'precision': 0.35664689130399224, 'recall': 0.3343789658239495, 'f1-score': 0.1729400239511857, 'support': 624585}, 'weighted avg': {'precision': 0.3567982537131398, 'recall': 0.33187636590696223, 'f1-score': 0.17173958425796176, 'support': 624585}}
[[   273 205171   1934]
 [   193 204919   1484]
 [   295 208223   2093]]
Evaluating performance on  val set...
826/826 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2001244
{'0': {'precision': 0.3858267716535433, 'recall': 0.0006313131313131314, 'f1-score': 0.0012605636520329805, 'support': 77616}, '1': {'precision': 0.2948126128443689, 'recall': 0.9933865194150601, 'f1-score': 0.45468572058337314, 'support': 62297}, '2': {'precision': 0.3583690987124464, 'recall': 0.007004543865781195, 'f1-score': 0.013740520823334202, 'support': 71525}, 'accuracy': 0.2952875074489921, 'macro avg': {'precision': 0.3463361610701195, 'recall': 0.3336741254707181, 'f1-score': 0.15656226835291345, 'support': 211438}, 'weighted avg': {'precision': 0.34972248052116833, 'recall': 0.2952875074489921, 'f1-score': 0.13907711478299817, 'support': 211438}}
[[   49 77051   516]
 [   31 61885   381]
 [   47 70977   501]]
training model: results/ATVI/W3/deepOF_L2/h1000
Epoch 1/50
2440/2440 - 70s - loss: 3.2796 - accuracy1000: 0.3767 - val_loss: 3.3571 - val_accuracy1000: 0.3504 - 70s/epoch - 29ms/step
Epoch 2/50
2440/2440 - 67s - loss: 3.2541 - accuracy1000: 0.3871 - val_loss: 3.3751 - val_accuracy1000: 0.3490 - 67s/epoch - 27ms/step
Epoch 3/50
2440/2440 - 67s - loss: 3.2480 - accuracy1000: 0.3897 - val_loss: 3.3757 - val_accuracy1000: 0.3497 - 67s/epoch - 28ms/step
Epoch 4/50
2440/2440 - 67s - loss: 3.2456 - accuracy1000: 0.3909 - val_loss: 3.3859 - val_accuracy1000: 0.3493 - 67s/epoch - 27ms/step
Epoch 5/50
2440/2440 - 67s - loss: 3.2437 - accuracy1000: 0.3919 - val_loss: 3.3876 - val_accuracy1000: 0.3498 - 67s/epoch - 27ms/step
Epoch 6/50
2440/2440 - 67s - loss: 3.2423 - accuracy1000: 0.3918 - val_loss: 3.3918 - val_accuracy1000: 0.3497 - 67s/epoch - 28ms/step
Epoch 7/50
2440/2440 - 67s - loss: 3.2410 - accuracy1000: 0.3926 - val_loss: 3.3934 - val_accuracy1000: 0.3503 - 67s/epoch - 28ms/step
Epoch 8/50
2440/2440 - 67s - loss: 3.2401 - accuracy1000: 0.3937 - val_loss: 3.3939 - val_accuracy1000: 0.3505 - 67s/epoch - 27ms/step
Epoch 9/50
2440/2440 - 68s - loss: 3.2389 - accuracy1000: 0.3940 - val_loss: 3.3971 - val_accuracy1000: 0.3499 - 68s/epoch - 28ms/step
Epoch 10/50
2440/2440 - 67s - loss: 3.2380 - accuracy1000: 0.3946 - val_loss: 3.3960 - val_accuracy1000: 0.3503 - 67s/epoch - 27ms/step
Epoch 11/50
2440/2440 - 67s - loss: 3.2371 - accuracy1000: 0.3950 - val_loss: 3.3961 - val_accuracy1000: 0.3509 - 67s/epoch - 27ms/step
testing model: results/ATVI/W3/deepOF_L2/h1000
Evaluating performance on  test set...
6082/6082 - 80s - 80s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.114311
{'0': {'precision': 0.353275617004781, 'recall': 0.005391590381118785, 'f1-score': 0.010621084834652553, 'support': 507086}, '1': {'precision': 0.3553297179360205, 'recall': 0.9652660340367746, 'f1-score': 0.5194439056692861, 'support': 549347}, '2': {'precision': 0.3555868875572788, 'recall': 0.040322403355936745, 'f1-score': 0.07243132827266575, 'support': 500367}, 'accuracy': 0.3553288797533402, 'macro avg': {'precision': 0.3547307408326934, 'recall': 0.3369933425912767, 'f1-score': 0.20083210625886813, 'support': 1556800}, 'weighted avg': {'precision': 0.3547433056589532, 'recall': 0.3553288797533402, 'f1-score': 0.2100353295901714, 'support': 1556800}}
[[  2734 484399  19953]
 [  2470 530266  16611]
 [  2535 477656  20176]]
Evaluating performance on  train set...
2440/2440 - 30s - 30s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1197597
{'0': {'precision': 0.36300801769422175, 'recall': 0.00640003899490629, 'f1-score': 0.012578315099726017, 'support': 205155}, '1': {'precision': 0.3344971889065025, 'recall': 0.9549985689962115, 'f1-score': 0.49545620414994157, 'support': 206149}, '2': {'precision': 0.38445397599284103, 'recall': 0.058415892648665375, 'f1-score': 0.10142131483833154, 'support': 213281}, 'accuracy': 0.3372543368796881, 'macro avg': {'precision': 0.36065306086452176, 'recall': 0.33993816687992773, 'f1-score': 0.2031519446959997, 'support': 624585}, 'weighted avg': {'precision': 0.36092109051558036, 'recall': 0.3372543368796881, 'f1-score': 0.20229359448854004, 'support': 624585}}
[[  1313 192154  11688]
 [  1017 196872   8260]
 [  1287 199535  12459]]
Evaluating performance on  val set...
826/826 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1182171
{'0': {'precision': 0.3628938156359393, 'recall': 0.004242490382779036, 'f1-score': 0.00838693148874776, 'support': 73306}, '1': {'precision': 0.35056468779564803, 'recall': 0.9658959773001887, 'f1-score': 0.5144233028803221, 'support': 73657}, '2': {'precision': 0.34922089825847846, 'recall': 0.04136487010469174, 'f1-score': 0.07396827157754604, 'support': 64475}, 'accuracy': 0.350566123402605, 'macro avg': {'precision': 0.35422646723002194, 'recall': 0.33716777926255315, 'f1-score': 0.198926168648872, 'support': 211438}, 'weighted avg': {'precision': 0.3544294529516342, 'recall': 0.350566123402605, 'f1-score': 0.20466895226937595, 'support': 211438}}
[[  311 70254  2741]
 [  283 71145  2229]
 [  263 61545  2667]]
training model: results/ATVI/W3/deepVOL_L2/h10
Epoch 1/50
2440/2440 - 69s - loss: 2.9796 - accuracy10: 0.4834 - val_loss: 2.6276 - val_accuracy10: 0.5532 - 69s/epoch - 28ms/step
Epoch 2/50
2440/2440 - 67s - loss: 2.8179 - accuracy10: 0.5334 - val_loss: 2.5318 - val_accuracy10: 0.5827 - 67s/epoch - 27ms/step
Epoch 3/50
2440/2440 - 66s - loss: 2.7512 - accuracy10: 0.5557 - val_loss: 2.5570 - val_accuracy10: 0.5995 - 66s/epoch - 27ms/step
Epoch 4/50
2440/2440 - 67s - loss: 2.7204 - accuracy10: 0.5636 - val_loss: 2.5398 - val_accuracy10: 0.6110 - 67s/epoch - 27ms/step
Epoch 5/50
2440/2440 - 66s - loss: 2.7030 - accuracy10: 0.5681 - val_loss: 2.5504 - val_accuracy10: 0.6036 - 66s/epoch - 27ms/step
Epoch 6/50
2440/2440 - 67s - loss: 2.6876 - accuracy10: 0.5718 - val_loss: 2.5135 - val_accuracy10: 0.6055 - 67s/epoch - 27ms/step
Epoch 7/50
2440/2440 - 67s - loss: 2.6762 - accuracy10: 0.5735 - val_loss: 2.4920 - val_accuracy10: 0.6218 - 67s/epoch - 28ms/step
Epoch 8/50
2440/2440 - 68s - loss: 2.6653 - accuracy10: 0.5757 - val_loss: 2.4929 - val_accuracy10: 0.6127 - 68s/epoch - 28ms/step
Epoch 9/50
2440/2440 - 67s - loss: 2.6557 - accuracy10: 0.5772 - val_loss: 2.4765 - val_accuracy10: 0.6166 - 67s/epoch - 27ms/step
Epoch 10/50
2440/2440 - 67s - loss: 2.6471 - accuracy10: 0.5781 - val_loss: 2.4602 - val_accuracy10: 0.6236 - 67s/epoch - 28ms/step
Epoch 11/50
2440/2440 - 68s - loss: 2.6409 - accuracy10: 0.5794 - val_loss: 2.4550 - val_accuracy10: 0.6264 - 68s/epoch - 28ms/step
Epoch 12/50
2440/2440 - 68s - loss: 2.6347 - accuracy10: 0.5797 - val_loss: 2.4110 - val_accuracy10: 0.6351 - 68s/epoch - 28ms/step
Epoch 13/50
2440/2440 - 68s - loss: 2.6296 - accuracy10: 0.5811 - val_loss: 2.4141 - val_accuracy10: 0.6313 - 68s/epoch - 28ms/step
Epoch 14/50
2440/2440 - 67s - loss: 2.6239 - accuracy10: 0.5822 - val_loss: 2.4247 - val_accuracy10: 0.6319 - 67s/epoch - 28ms/step
Epoch 15/50
2440/2440 - 67s - loss: 2.6191 - accuracy10: 0.5832 - val_loss: 2.4309 - val_accuracy10: 0.6338 - 67s/epoch - 28ms/step
Epoch 16/50
2440/2440 - 67s - loss: 2.6140 - accuracy10: 0.5838 - val_loss: 2.4036 - val_accuracy10: 0.6382 - 67s/epoch - 28ms/step
Epoch 17/50
2440/2440 - 68s - loss: 2.6102 - accuracy10: 0.5841 - val_loss: 2.4172 - val_accuracy10: 0.6333 - 68s/epoch - 28ms/step
Epoch 18/50
2440/2440 - 66s - loss: 2.6061 - accuracy10: 0.5848 - val_loss: 2.4009 - val_accuracy10: 0.6370 - 66s/epoch - 27ms/step
Epoch 19/50
2440/2440 - 67s - loss: 2.6022 - accuracy10: 0.5860 - val_loss: 2.3920 - val_accuracy10: 0.6398 - 67s/epoch - 27ms/step
Epoch 20/50
2440/2440 - 66s - loss: 2.5988 - accuracy10: 0.5860 - val_loss: 2.3877 - val_accuracy10: 0.6408 - 66s/epoch - 27ms/step
Epoch 21/50
2440/2440 - 66s - loss: 2.5947 - accuracy10: 0.5865 - val_loss: 2.3957 - val_accuracy10: 0.6399 - 66s/epoch - 27ms/step
Epoch 22/50
2440/2440 - 66s - loss: 2.5912 - accuracy10: 0.5873 - val_loss: 2.3915 - val_accuracy10: 0.6404 - 66s/epoch - 27ms/step
Epoch 23/50
2440/2440 - 67s - loss: 2.5863 - accuracy10: 0.5880 - val_loss: 2.3943 - val_accuracy10: 0.6381 - 67s/epoch - 27ms/step
Epoch 24/50
2440/2440 - 67s - loss: 2.5847 - accuracy10: 0.5883 - val_loss: 2.3843 - val_accuracy10: 0.6487 - 67s/epoch - 28ms/step
Epoch 25/50
2440/2440 - 67s - loss: 2.5813 - accuracy10: 0.5887 - val_loss: 2.3835 - val_accuracy10: 0.6446 - 67s/epoch - 28ms/step
Epoch 26/50
2440/2440 - 66s - loss: 2.5779 - accuracy10: 0.5895 - val_loss: 2.3903 - val_accuracy10: 0.6415 - 66s/epoch - 27ms/step
Epoch 27/50
2440/2440 - 66s - loss: 2.5756 - accuracy10: 0.5897 - val_loss: 2.3891 - val_accuracy10: 0.6394 - 66s/epoch - 27ms/step
Epoch 28/50
2440/2440 - 66s - loss: 2.5722 - accuracy10: 0.5904 - val_loss: 2.3832 - val_accuracy10: 0.6419 - 66s/epoch - 27ms/step
Epoch 29/50
2440/2440 - 67s - loss: 2.5690 - accuracy10: 0.5905 - val_loss: 2.3815 - val_accuracy10: 0.6369 - 67s/epoch - 27ms/step
Epoch 30/50
2440/2440 - 66s - loss: 2.5660 - accuracy10: 0.5912 - val_loss: 2.3739 - val_accuracy10: 0.6410 - 66s/epoch - 27ms/step
Epoch 31/50
2440/2440 - 67s - loss: 2.5635 - accuracy10: 0.5910 - val_loss: 2.3846 - val_accuracy10: 0.6393 - 67s/epoch - 27ms/step
Epoch 32/50
2440/2440 - 66s - loss: 2.5609 - accuracy10: 0.5925 - val_loss: 2.3759 - val_accuracy10: 0.6452 - 66s/epoch - 27ms/step
Epoch 33/50
2440/2440 - 67s - loss: 2.5584 - accuracy10: 0.5922 - val_loss: 2.3908 - val_accuracy10: 0.6387 - 67s/epoch - 27ms/step
Epoch 34/50
2440/2440 - 68s - loss: 2.5558 - accuracy10: 0.5920 - val_loss: 2.3894 - val_accuracy10: 0.6427 - 68s/epoch - 28ms/step
Epoch 35/50
2440/2440 - 68s - loss: 2.5536 - accuracy10: 0.5928 - val_loss: 2.3822 - val_accuracy10: 0.6457 - 68s/epoch - 28ms/step
Epoch 36/50
2440/2440 - 67s - loss: 2.5509 - accuracy10: 0.5930 - val_loss: 2.3965 - val_accuracy10: 0.6412 - 67s/epoch - 27ms/step
Epoch 37/50
2440/2440 - 67s - loss: 2.5480 - accuracy10: 0.5940 - val_loss: 2.4122 - val_accuracy10: 0.6418 - 67s/epoch - 28ms/step
Epoch 38/50
2440/2440 - 66s - loss: 2.5459 - accuracy10: 0.5942 - val_loss: 2.4082 - val_accuracy10: 0.6430 - 66s/epoch - 27ms/step
Epoch 39/50
2440/2440 - 66s - loss: 2.5433 - accuracy10: 0.5944 - val_loss: 2.4115 - val_accuracy10: 0.6484 - 66s/epoch - 27ms/step
Epoch 40/50
2440/2440 - 67s - loss: 2.5417 - accuracy10: 0.5947 - val_loss: 2.4199 - val_accuracy10: 0.6414 - 67s/epoch - 27ms/step
testing model: results/ATVI/W3/deepVOL_L2/h10
Evaluating performance on  test set...
6082/6082 - 82s - 82s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7790289
{'0': {'precision': 0.4673921815016774, 'recall': 0.44051559908151217, 'f1-score': 0.45355607968900036, 'support': 276106}, '1': {'precision': 0.8339211605632432, 'recall': 0.681235037262684, 'f1-score': 0.7498848154475344, 'support': 1005832}, '2': {'precision': 0.3913014181783725, 'recall': 0.6760785255360794, 'f1-score': 0.4957006872765152, 'support': 274866}, 'accuracy': 0.6376319690853827, 'macro avg': {'precision': 0.5642049200810977, 'recall': 0.5992763872934251, 'f1-score': 0.5663805274710166, 'support': 1556804}, 'weighted avg': {'precision': 0.6907676432270001, 'recall': 0.6376319690853827, 'f1-score': 0.6524514092581867, 'support': 1556804}}
[[121629  73182  81295]
 [112845 685208 207779]
 [ 25755  63280 185831]]
Evaluating performance on  train set...
2440/2440 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8902999
{'0': {'precision': 0.4752262425818912, 'recall': 0.42546367312787614, 'f1-score': 0.44897028202279426, 'support': 143420}, '1': {'precision': 0.7676471151086021, 'recall': 0.5937360311422271, 'f1-score': 0.669583361153769, 'support': 337805}, '2': {'precision': 0.41051466519092417, 'recall': 0.6726608166738746, 'f1-score': 0.5098659165891211, 'support': 143362}, 'accuracy': 0.5732123787398713, 'macro avg': {'precision': 0.5511293409604725, 'recall': 0.5639535069813258, 'f1-score': 0.5428065199218948, 'support': 624587}, 'weighted avg': {'precision': 0.6185274186966067, 'recall': 0.5732123787398713, 'f1-score': 0.5822652772092721, 'support': 624587}}
[[ 61020  30254  52146]
 [ 50908 200567  86330]
 [ 16474  30454  96434]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7841696
{'0': {'precision': 0.47748449220068, 'recall': 0.4606735945912107, 'f1-score': 0.46892842577487764, 'support': 39935}, '1': {'precision': 0.8010231718326813, 'recall': 0.7038872728646444, 'f1-score': 0.7493203571141317, 'support': 132355}, '2': {'precision': 0.4201116528867218, 'recall': 0.6074384387452744, 'f1-score': 0.49669980783691203, 'support': 39148}, 'accuracy': 0.6400930769303531, 'macro avg': {'precision': 0.5662064389733611, 'recall': 0.5906664354003764, 'f1-score': 0.5716495302419738, 'support': 211438}, 'weighted avg': {'precision': 0.6693891168624282, 'recall': 0.6400930769303531, 'f1-score': 0.6495887996782039, 'support': 211438}}
[[18397 11634  9904]
 [16272 93163 22920]
 [ 3860 11508 23780]]
training model: results/ATVI/W3/deepVOL_L2/h20
Epoch 1/50
2440/2440 - 70s - loss: 3.0415 - accuracy20: 0.4769 - val_loss: 2.8617 - val_accuracy20: 0.5272 - 70s/epoch - 29ms/step
Epoch 2/50
2440/2440 - 67s - loss: 2.8886 - accuracy20: 0.5273 - val_loss: 2.7287 - val_accuracy20: 0.5658 - 67s/epoch - 28ms/step
Epoch 3/50
2440/2440 - 67s - loss: 2.8416 - accuracy20: 0.5419 - val_loss: 2.6953 - val_accuracy20: 0.5737 - 67s/epoch - 28ms/step
Epoch 4/50
2440/2440 - 68s - loss: 2.8148 - accuracy20: 0.5488 - val_loss: 2.7181 - val_accuracy20: 0.5611 - 68s/epoch - 28ms/step
Epoch 5/50
2440/2440 - 67s - loss: 2.7978 - accuracy20: 0.5534 - val_loss: 2.7364 - val_accuracy20: 0.5562 - 67s/epoch - 28ms/step
Epoch 6/50
2440/2440 - 67s - loss: 2.7847 - accuracy20: 0.5563 - val_loss: 2.7307 - val_accuracy20: 0.5488 - 67s/epoch - 27ms/step
Epoch 7/50
2440/2440 - 66s - loss: 2.7762 - accuracy20: 0.5577 - val_loss: 2.7334 - val_accuracy20: 0.5574 - 66s/epoch - 27ms/step
Epoch 8/50
2440/2440 - 67s - loss: 2.7673 - accuracy20: 0.5600 - val_loss: 2.7228 - val_accuracy20: 0.5532 - 67s/epoch - 28ms/step
Epoch 9/50
2440/2440 - 66s - loss: 2.7595 - accuracy20: 0.5612 - val_loss: 2.6984 - val_accuracy20: 0.5734 - 66s/epoch - 27ms/step
Epoch 10/50
2440/2440 - 67s - loss: 2.7519 - accuracy20: 0.5624 - val_loss: 2.7133 - val_accuracy20: 0.5646 - 67s/epoch - 27ms/step
Epoch 11/50
2440/2440 - 66s - loss: 2.7462 - accuracy20: 0.5634 - val_loss: 2.6989 - val_accuracy20: 0.5708 - 66s/epoch - 27ms/step
Epoch 12/50
2440/2440 - 67s - loss: 2.7412 - accuracy20: 0.5643 - val_loss: 2.7036 - val_accuracy20: 0.5654 - 67s/epoch - 27ms/step
Epoch 13/50
2440/2440 - 67s - loss: 2.7368 - accuracy20: 0.5645 - val_loss: 2.6922 - val_accuracy20: 0.5709 - 67s/epoch - 28ms/step
Epoch 14/50
2440/2440 - 66s - loss: 2.7322 - accuracy20: 0.5658 - val_loss: 2.6937 - val_accuracy20: 0.5657 - 66s/epoch - 27ms/step
Epoch 15/50
2440/2440 - 66s - loss: 2.7282 - accuracy20: 0.5667 - val_loss: 2.6933 - val_accuracy20: 0.5682 - 66s/epoch - 27ms/step
Epoch 16/50
2440/2440 - 67s - loss: 2.7243 - accuracy20: 0.5670 - val_loss: 2.6599 - val_accuracy20: 0.5789 - 67s/epoch - 28ms/step
Epoch 17/50
2440/2440 - 66s - loss: 2.7204 - accuracy20: 0.5685 - val_loss: 2.6847 - val_accuracy20: 0.5708 - 66s/epoch - 27ms/step
Epoch 18/50
2440/2440 - 66s - loss: 2.7169 - accuracy20: 0.5690 - val_loss: 2.6538 - val_accuracy20: 0.5779 - 66s/epoch - 27ms/step
Epoch 19/50
2440/2440 - 67s - loss: 2.7136 - accuracy20: 0.5697 - val_loss: 2.6797 - val_accuracy20: 0.5690 - 67s/epoch - 27ms/step
Epoch 20/50
2440/2440 - 68s - loss: 2.7102 - accuracy20: 0.5701 - val_loss: 2.6637 - val_accuracy20: 0.5753 - 68s/epoch - 28ms/step
Epoch 21/50
2440/2440 - 67s - loss: 2.7067 - accuracy20: 0.5708 - val_loss: 2.6501 - val_accuracy20: 0.5760 - 67s/epoch - 27ms/step
Epoch 22/50
2440/2440 - 67s - loss: 2.7034 - accuracy20: 0.5713 - val_loss: 2.6683 - val_accuracy20: 0.5737 - 67s/epoch - 27ms/step
Epoch 23/50
2440/2440 - 66s - loss: 2.7003 - accuracy20: 0.5722 - val_loss: 2.6651 - val_accuracy20: 0.5741 - 66s/epoch - 27ms/step
Epoch 24/50
2440/2440 - 66s - loss: 2.6982 - accuracy20: 0.5727 - val_loss: 2.6564 - val_accuracy20: 0.5786 - 66s/epoch - 27ms/step
Epoch 25/50
2440/2440 - 66s - loss: 2.6952 - accuracy20: 0.5731 - val_loss: 2.6598 - val_accuracy20: 0.5791 - 66s/epoch - 27ms/step
Epoch 26/50
2440/2440 - 67s - loss: 2.6922 - accuracy20: 0.5742 - val_loss: 2.6521 - val_accuracy20: 0.5779 - 67s/epoch - 27ms/step
Epoch 27/50
2440/2440 - 66s - loss: 2.6895 - accuracy20: 0.5746 - val_loss: 2.6438 - val_accuracy20: 0.5839 - 66s/epoch - 27ms/step
Epoch 28/50
2440/2440 - 66s - loss: 2.6864 - accuracy20: 0.5752 - val_loss: 2.6656 - val_accuracy20: 0.5758 - 66s/epoch - 27ms/step
Epoch 29/50
2440/2440 - 66s - loss: 2.6847 - accuracy20: 0.5752 - val_loss: 2.6620 - val_accuracy20: 0.5819 - 66s/epoch - 27ms/step
Epoch 30/50
2440/2440 - 66s - loss: 2.6825 - accuracy20: 0.5754 - val_loss: 2.6419 - val_accuracy20: 0.5866 - 66s/epoch - 27ms/step
Epoch 31/50
2440/2440 - 66s - loss: 2.6793 - accuracy20: 0.5762 - val_loss: 2.6551 - val_accuracy20: 0.5843 - 66s/epoch - 27ms/step
Epoch 32/50
2440/2440 - 67s - loss: 2.6775 - accuracy20: 0.5763 - val_loss: 2.6482 - val_accuracy20: 0.5859 - 67s/epoch - 28ms/step
Epoch 33/50
2440/2440 - 67s - loss: 2.6750 - accuracy20: 0.5766 - val_loss: 2.6413 - val_accuracy20: 0.5876 - 67s/epoch - 28ms/step
Epoch 34/50
2440/2440 - 67s - loss: 2.6726 - accuracy20: 0.5773 - val_loss: 2.6523 - val_accuracy20: 0.5913 - 67s/epoch - 27ms/step
Epoch 35/50
2440/2440 - 68s - loss: 2.6699 - accuracy20: 0.5777 - val_loss: 2.6306 - val_accuracy20: 0.5896 - 68s/epoch - 28ms/step
Epoch 36/50
2440/2440 - 67s - loss: 2.6686 - accuracy20: 0.5781 - val_loss: 2.6520 - val_accuracy20: 0.5906 - 67s/epoch - 28ms/step
Epoch 37/50
2440/2440 - 67s - loss: 2.6666 - accuracy20: 0.5785 - val_loss: 2.6280 - val_accuracy20: 0.5986 - 67s/epoch - 28ms/step
Epoch 38/50
2440/2440 - 69s - loss: 2.6648 - accuracy20: 0.5784 - val_loss: 2.6595 - val_accuracy20: 0.5915 - 69s/epoch - 28ms/step
Epoch 39/50
2440/2440 - 69s - loss: 2.6620 - accuracy20: 0.5793 - val_loss: 2.6518 - val_accuracy20: 0.5938 - 69s/epoch - 28ms/step
Epoch 40/50
2440/2440 - 69s - loss: 2.6599 - accuracy20: 0.5797 - val_loss: 2.6423 - val_accuracy20: 0.5951 - 69s/epoch - 28ms/step
Epoch 41/50
2440/2440 - 67s - loss: 2.6580 - accuracy20: 0.5800 - val_loss: 2.6382 - val_accuracy20: 0.5974 - 67s/epoch - 28ms/step
Epoch 42/50
2440/2440 - 67s - loss: 2.6566 - accuracy20: 0.5798 - val_loss: 2.6401 - val_accuracy20: 0.5966 - 67s/epoch - 28ms/step
Epoch 43/50
2440/2440 - 67s - loss: 2.6548 - accuracy20: 0.5808 - val_loss: 2.6546 - val_accuracy20: 0.5963 - 67s/epoch - 27ms/step
Epoch 44/50
2440/2440 - 67s - loss: 2.6528 - accuracy20: 0.5815 - val_loss: 2.6405 - val_accuracy20: 0.5977 - 67s/epoch - 27ms/step
Epoch 45/50
2440/2440 - 67s - loss: 2.6507 - accuracy20: 0.5811 - val_loss: 2.6621 - val_accuracy20: 0.5884 - 67s/epoch - 27ms/step
Epoch 46/50
2440/2440 - 67s - loss: 2.6480 - accuracy20: 0.5815 - val_loss: 2.6588 - val_accuracy20: 0.5932 - 67s/epoch - 27ms/step
Epoch 47/50
2440/2440 - 67s - loss: 2.6462 - accuracy20: 0.5824 - val_loss: 2.6705 - val_accuracy20: 0.5913 - 67s/epoch - 27ms/step
testing model: results/ATVI/W3/deepVOL_L2/h20
Evaluating performance on  test set...
6082/6082 - 76s - 76s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8538789
{'0': {'precision': 0.5541789838973248, 'recall': 0.33818973293070315, 'f1-score': 0.4200452997192252, 'support': 356986}, '1': {'precision': 0.7463511453869163, 'recall': 0.6951253817714194, 'f1-score': 0.7198280583803487, 'support': 846056}, '2': {'precision': 0.4243064441479949, 'recall': 0.6608341201146534, 'f1-score': 0.5167923583578251, 'support': 353762}, 'accuracy': 0.6054853404795979, 'macro avg': {'precision': 0.574945524477412, 'recall': 0.5647164116055919, 'f1-score': 0.5522219054857996, 'support': 1556804}, 'weighted avg': {'precision': 0.6291045627463226, 'recall': 0.6054853404795979, 'f1-score': 0.6049487523182061, 'support': 1556804}}
[[120729 112845 123412]
 [ 64166 588115 193775]
 [ 32957  87027 233778]]
Evaluating performance on  train set...
2440/2440 - 30s - 30s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9550809
{'0': {'precision': 0.5453495998950545, 'recall': 0.347336407994118, 'f1-score': 0.42438162904888777, 'support': 179532}, '1': {'precision': 0.6631410065957574, 'recall': 0.5878877956089026, 'f1-score': 0.6232510456328747, 'support': 265765}, '2': {'precision': 0.44295358219607045, 'recall': 0.6785152546154275, 'f1-score': 0.5359948537867405, 'support': 179290}, 'accuracy': 0.5447583763350822, 'macro avg': {'precision': 0.5504813962289608, 'recall': 0.5379131527394827, 'f1-score': 0.5278758428228344, 'support': 624587}, 'weighted avg': {'precision': 0.5660772986600968, 'recall': 0.5447583763350822, 'f1-score': 0.541040582183828, 'support': 624587}}
[[ 62358  43576  73598]
 [ 30138 156240  79387]
 [ 21849  35790 121651]]
Evaluating performance on  val set...
826/826 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8725337
{'0': {'precision': 0.5705165409170052, 'recall': 0.34101027232254705, 'f1-score': 0.4268706046971689, 'support': 51887}, '1': {'precision': 0.6944911297852474, 'recall': 0.7190906747200942, 'f1-score': 0.7065768581806996, 'support': 108608}, '2': {'precision': 0.4518236254763201, 'recall': 0.602830614608484, 'f1-score': 0.5165164155005383, 'support': 50943}, 'accuracy': 0.5982983191290118, 'macro avg': {'precision': 0.5722770987261909, 'recall': 0.554310520550375, 'f1-score': 0.549987959459469, 'support': 211438}, 'weighted avg': {'precision': 0.605600390350443, 'recall': 0.5982983191290118, 'f1-score': 0.592144412234581, 'support': 211438}}
[[17694 18920 15273]
 [ 8523 78099 21986]
 [ 4797 15436 30710]]
training model: results/ATVI/W3/deepVOL_L2/h30
Epoch 1/50
2440/2440 - 71s - loss: 3.0476 - accuracy30: 0.4728 - val_loss: 2.8952 - val_accuracy30: 0.5249 - 71s/epoch - 29ms/step
Epoch 2/50
2440/2440 - 67s - loss: 2.9262 - accuracy30: 0.5118 - val_loss: 2.8716 - val_accuracy30: 0.5365 - 67s/epoch - 27ms/step
Epoch 3/50
2440/2440 - 67s - loss: 2.8907 - accuracy30: 0.5219 - val_loss: 2.9131 - val_accuracy30: 0.5369 - 67s/epoch - 27ms/step
Epoch 4/50
2440/2440 - 67s - loss: 2.8713 - accuracy30: 0.5267 - val_loss: 2.9352 - val_accuracy30: 0.5400 - 67s/epoch - 27ms/step
Epoch 5/50
2440/2440 - 67s - loss: 2.8587 - accuracy30: 0.5306 - val_loss: 2.9431 - val_accuracy30: 0.5406 - 67s/epoch - 27ms/step
Epoch 6/50
2440/2440 - 67s - loss: 2.8499 - accuracy30: 0.5326 - val_loss: 2.9445 - val_accuracy30: 0.5436 - 67s/epoch - 27ms/step
Epoch 7/50
2440/2440 - 67s - loss: 2.8423 - accuracy30: 0.5343 - val_loss: 2.9542 - val_accuracy30: 0.5421 - 67s/epoch - 28ms/step
Epoch 8/50
2440/2440 - 67s - loss: 2.8368 - accuracy30: 0.5358 - val_loss: 2.9369 - val_accuracy30: 0.5441 - 67s/epoch - 28ms/step
Epoch 9/50
2440/2440 - 67s - loss: 2.8314 - accuracy30: 0.5374 - val_loss: 2.9530 - val_accuracy30: 0.5390 - 67s/epoch - 27ms/step
Epoch 10/50
2440/2440 - 67s - loss: 2.8256 - accuracy30: 0.5380 - val_loss: 2.9280 - val_accuracy30: 0.5404 - 67s/epoch - 27ms/step
Epoch 11/50
2440/2440 - 67s - loss: 2.8204 - accuracy30: 0.5396 - val_loss: 2.9492 - val_accuracy30: 0.5382 - 67s/epoch - 27ms/step
Epoch 12/50
2440/2440 - 68s - loss: 2.8162 - accuracy30: 0.5410 - val_loss: 2.9313 - val_accuracy30: 0.5387 - 68s/epoch - 28ms/step
testing model: results/ATVI/W3/deepVOL_L2/h30
Evaluating performance on  test set...
6082/6082 - 79s - 79s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9304803
{'0': {'precision': 0.5010493667271049, 'recall': 0.36669348116139977, 'f1-score': 0.42347001065109185, 'support': 411469}, '1': {'precision': 0.6719641601217035, 'recall': 0.6501377857684956, 'f1-score': 0.6608708088439547, 'support': 739191}, '2': {'precision': 0.429111415773494, 'recall': 0.5710536164513079, 'f1-score': 0.4900103841721131, 'support': 406144}, 'accuracy': 0.554590687074288, 'macro avg': {'precision': 0.5340416475407674, 'recall': 0.5292949611270678, 'f1-score': 0.5247837345557199, 'support': 1556804}, 'weighted avg': {'precision': 0.5634345545169893, 'recall': 0.554590687074288, 'f1-score': 0.5535502949259923, 'support': 1556804}}
[[150883 126853 133733]
 [ 83789 480576 174826]
 [ 66462 107752 231930]]
Evaluating performance on  train set...
2440/2440 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.005092
{'0': {'precision': 0.49147061907924633, 'recall': 0.41813053908836767, 'f1-score': 0.4518439165483811, 'support': 201748}, '1': {'precision': 0.5683300463022082, 'recall': 0.5428802479342577, 'f1-score': 0.5553137116265313, 'support': 221349}, '2': {'precision': 0.45442387001672824, 'recall': 0.5446771551938061, 'f1-score': 0.49547402019873676, 'support': 201490}, 'accuracy': 0.503164491095716, 'macro avg': {'precision': 0.5047415117993942, 'recall': 0.5018959807388105, 'f1-score': 0.5008772161245497, 'support': 624587}, 'weighted avg': {'precision': 0.506757853504184, 'recall': 0.503164491095716, 'f1-score': 0.5025877925100384, 'support': 624587}}
[[ 84357  47029  70362]
 [ 39784 120166  61399]
 [ 47501  44242 109747]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9596722
{'0': {'precision': 0.49904376445472337, 'recall': 0.37403536843508844, 'f1-score': 0.4275901490973182, 'support': 59997}, '1': {'precision': 0.6029695070929576, 'recall': 0.6682193612387052, 'f1-score': 0.6339198036006546, 'support': 92742}, '2': {'precision': 0.45168938014193305, 'recall': 0.49011056406412373, 'f1-score': 0.4701162667189581, 'support': 58699}, 'accuracy': 0.5352963989443714, 'macro avg': {'precision': 0.517900883896538, 'recall': 0.5107884312459724, 'f1-score': 0.510542073138977, 'support': 211438}, 'weighted avg': {'precision': 0.5314817662281919, 'recall': 0.5352963989443714, 'f1-score': 0.5298975176697653, 'support': 211438}}
[[22441 21374 16182]
 [12029 61972 18741]
 [10498 19432 28769]]
training model: results/ATVI/W3/deepVOL_L2/h50
Epoch 1/50
2440/2440 - 70s - loss: 3.1311 - accuracy50: 0.4421 - val_loss: 3.0989 - val_accuracy50: 0.4759 - 70s/epoch - 29ms/step
Epoch 2/50
2440/2440 - 67s - loss: 3.0467 - accuracy50: 0.4737 - val_loss: 3.0906 - val_accuracy50: 0.4864 - 67s/epoch - 27ms/step
Epoch 3/50
2440/2440 - 67s - loss: 3.0221 - accuracy50: 0.4809 - val_loss: 3.0964 - val_accuracy50: 0.4882 - 67s/epoch - 28ms/step
Epoch 4/50
2440/2440 - 67s - loss: 3.0091 - accuracy50: 0.4855 - val_loss: 3.1078 - val_accuracy50: 0.4910 - 67s/epoch - 28ms/step
Epoch 5/50
2440/2440 - 67s - loss: 2.9994 - accuracy50: 0.4886 - val_loss: 3.1060 - val_accuracy50: 0.4924 - 67s/epoch - 27ms/step
Epoch 6/50
2440/2440 - 67s - loss: 2.9913 - accuracy50: 0.4916 - val_loss: 3.0941 - val_accuracy50: 0.4936 - 67s/epoch - 27ms/step
Epoch 7/50
2440/2440 - 67s - loss: 2.9847 - accuracy50: 0.4933 - val_loss: 3.1074 - val_accuracy50: 0.4936 - 67s/epoch - 28ms/step
Epoch 8/50
2440/2440 - 67s - loss: 2.9790 - accuracy50: 0.4948 - val_loss: 3.0899 - val_accuracy50: 0.4982 - 67s/epoch - 27ms/step
Epoch 9/50
2440/2440 - 67s - loss: 2.9751 - accuracy50: 0.4961 - val_loss: 3.0885 - val_accuracy50: 0.4984 - 67s/epoch - 28ms/step
Epoch 10/50
2440/2440 - 67s - loss: 2.9708 - accuracy50: 0.4979 - val_loss: 3.0809 - val_accuracy50: 0.4980 - 67s/epoch - 27ms/step
Epoch 11/50
2440/2440 - 67s - loss: 2.9670 - accuracy50: 0.4989 - val_loss: 3.0891 - val_accuracy50: 0.4992 - 67s/epoch - 28ms/step
Epoch 12/50
2440/2440 - 67s - loss: 2.9642 - accuracy50: 0.4997 - val_loss: 3.0900 - val_accuracy50: 0.4982 - 67s/epoch - 28ms/step
Epoch 13/50
2440/2440 - 67s - loss: 2.9608 - accuracy50: 0.5009 - val_loss: 3.1228 - val_accuracy50: 0.4946 - 67s/epoch - 27ms/step
Epoch 14/50
2440/2440 - 67s - loss: 2.9586 - accuracy50: 0.5012 - val_loss: 3.1080 - val_accuracy50: 0.4994 - 67s/epoch - 27ms/step
Epoch 15/50
2440/2440 - 67s - loss: 2.9556 - accuracy50: 0.5028 - val_loss: 3.1090 - val_accuracy50: 0.4975 - 67s/epoch - 27ms/step
Epoch 16/50
2440/2440 - 67s - loss: 2.9534 - accuracy50: 0.5031 - val_loss: 3.1175 - val_accuracy50: 0.4966 - 67s/epoch - 27ms/step
Epoch 17/50
2440/2440 - 67s - loss: 2.9512 - accuracy50: 0.5040 - val_loss: 3.1075 - val_accuracy50: 0.4990 - 67s/epoch - 28ms/step
Epoch 18/50
2440/2440 - 67s - loss: 2.9483 - accuracy50: 0.5044 - val_loss: 3.0980 - val_accuracy50: 0.4987 - 67s/epoch - 27ms/step
Epoch 19/50
2440/2440 - 67s - loss: 2.9460 - accuracy50: 0.5052 - val_loss: 3.1186 - val_accuracy50: 0.4965 - 67s/epoch - 27ms/step
Epoch 20/50
2440/2440 - 67s - loss: 2.9440 - accuracy50: 0.5058 - val_loss: 3.1223 - val_accuracy50: 0.4984 - 67s/epoch - 28ms/step
testing model: results/ATVI/W3/deepVOL_L2/h50
Evaluating performance on  test set...
6082/6082 - 77s - 77s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9728244
{'0': {'precision': 0.5360325629831377, 'recall': 0.2452508630109059, 'f1-score': 0.33652947009927875, 'support': 436553}, '1': {'precision': 0.5678737082121953, 'recall': 0.7549319794938287, 'f1-score': 0.648176866228304, 'support': 684867}, '2': {'precision': 0.4563876356064083, 'recall': 0.4681499549822685, 'f1-score': 0.46219397294070563, 'support': 435384}, 'accuracy': 0.5318061875483362, 'macro avg': {'precision': 0.5200979689339138, 'recall': 0.489444265829001, 'f1-score': 0.48230010308942944, 'support': 1556804}, 'weighted avg': {'precision': 0.5277661547188983, 'recall': 0.5318061875483362, 'f1-score': 0.5087729452893532, 'support': 1556804}}
[[107065 207751 121737]
 [ 46796 517028 121043]
 [ 45875 185684 203825]]
Evaluating performance on  train set...
2440/2440 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0595522
{'0': {'precision': 0.5176107217686583, 'recall': 0.27399761924112115, 'f1-score': 0.3583188759162877, 'support': 209177}, '1': {'precision': 0.4597335500345202, 'recall': 0.6739287288082244, 'f1-score': 0.5465960237850236, 'support': 206507}, '2': {'precision': 0.4650370847502581, 'recall': 0.4700123980986391, 'f1-score': 0.4675115048292905, 'support': 208903}, 'accuracy': 0.47178695682106736, 'macro avg': {'precision': 0.4807937855178122, 'recall': 0.47264624871599487, 'f1-score': 0.4574754681768673, 'support': 624587}, 'weighted avg': {'precision': 0.48089072664010696, 'recall': 0.47178695682106736, 'f1-score': 0.457090090707409, 'support': 624587}}
[[ 57314  83600  68263]
 [ 22648 139171  44688]
 [ 30766  79950  98187]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0279775
{'0': {'precision': 0.5483696020608773, 'recall': 0.24907240620140716, 'f1-score': 0.3425546556561325, 'support': 64953}, '1': {'precision': 0.4972039892324661, 'recall': 0.7702381379120814, 'f1-score': 0.6043123652385863, 'support': 83691}, '2': {'precision': 0.473655019412091, 'recall': 0.39440073892410105, 'f1-score': 0.4304098852112859, 'support': 62794}, 'accuracy': 0.4985196606097296, 'macro avg': {'precision': 0.5064095369018115, 'recall': 0.47123709434586325, 'f1-score': 0.45909230203533496, 'support': 211438}, 'weighted avg': {'precision': 0.5059281827981598, 'recall': 0.4985196606097296, 'f1-score': 0.4722548313925254, 'support': 211438}}
[[16178 34064 14711]
 [ 6419 64462 12810]
 [ 6905 31123 24766]]
training model: results/ATVI/W3/deepVOL_L2/h100
Epoch 1/50
2440/2440 - 70s - loss: 3.2578 - accuracy100: 0.3868 - val_loss: 3.3006 - val_accuracy100: 0.3717 - 70s/epoch - 28ms/step
Epoch 2/50
2440/2440 - 67s - loss: 3.2217 - accuracy100: 0.4057 - val_loss: 3.2754 - val_accuracy100: 0.3793 - 67s/epoch - 28ms/step
Epoch 3/50
2440/2440 - 67s - loss: 3.2133 - accuracy100: 0.4099 - val_loss: 3.2608 - val_accuracy100: 0.3877 - 67s/epoch - 28ms/step
Epoch 4/50
2440/2440 - 67s - loss: 3.2032 - accuracy100: 0.4150 - val_loss: 3.2658 - val_accuracy100: 0.3947 - 67s/epoch - 28ms/step
Epoch 5/50
2440/2440 - 67s - loss: 3.1957 - accuracy100: 0.4178 - val_loss: 3.3009 - val_accuracy100: 0.3956 - 67s/epoch - 28ms/step
Epoch 6/50
2440/2440 - 67s - loss: 3.1891 - accuracy100: 0.4208 - val_loss: 3.3120 - val_accuracy100: 0.4017 - 67s/epoch - 28ms/step
Epoch 7/50
2440/2440 - 67s - loss: 3.1840 - accuracy100: 0.4233 - val_loss: 3.3578 - val_accuracy100: 0.4005 - 67s/epoch - 27ms/step
Epoch 8/50
2440/2440 - 67s - loss: 3.1793 - accuracy100: 0.4260 - val_loss: 3.3642 - val_accuracy100: 0.3997 - 67s/epoch - 28ms/step
Epoch 9/50
2440/2440 - 67s - loss: 3.1761 - accuracy100: 0.4276 - val_loss: 3.3721 - val_accuracy100: 0.4014 - 67s/epoch - 27ms/step
Epoch 10/50
2440/2440 - 67s - loss: 3.1736 - accuracy100: 0.4289 - val_loss: 3.3723 - val_accuracy100: 0.3991 - 67s/epoch - 27ms/step
Epoch 11/50
2440/2440 - 67s - loss: 3.1715 - accuracy100: 0.4299 - val_loss: 3.3790 - val_accuracy100: 0.4046 - 67s/epoch - 28ms/step
Epoch 12/50
2440/2440 - 67s - loss: 3.1699 - accuracy100: 0.4304 - val_loss: 3.3732 - val_accuracy100: 0.4016 - 67s/epoch - 27ms/step
Epoch 13/50
2440/2440 - 67s - loss: 3.1668 - accuracy100: 0.4319 - val_loss: 3.3567 - val_accuracy100: 0.4023 - 67s/epoch - 28ms/step
testing model: results/ATVI/W3/deepVOL_L2/h100
Evaluating performance on  test set...
6082/6082 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0749121
{'0': {'precision': 0.4142723592773559, 'recall': 0.35549777117384845, 'f1-score': 0.38264124459001053, 'support': 506096}, '1': {'precision': 0.40097993365935847, 'recall': 0.47085094157095786, 'f1-score': 0.433115606888073, 'support': 549932}, '2': {'precision': 0.39658774373259054, 'recall': 0.3775620237391568, 'f1-score': 0.38684109304285913, 'support': 500776}, 'accuracy': 0.40334300271582035, 'macro avg': {'precision': 0.4039466788897683, 'recall': 0.40130357882798773, 'f1-score': 0.4008659815069809, 'support': 1556804}, 'weighted avg': {'precision': 0.403888289581362, 'recall': 0.40334300271582035, 'f1-score': 0.4018219830234433, 'support': 1556804}}
[[179916 197894 128286]
 [131604 258936 159392]
 [122774 188928 189074]]
Evaluating performance on  train set...
2440/2440 - 32s - 32s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0943058
{'0': {'precision': 0.3901847153346404, 'recall': 0.38838931246591984, 'f1-score': 0.38928494378790424, 'support': 209066}, '1': {'precision': 0.3564795157866209, 'recall': 0.38315629005321006, 'f1-score': 0.3693368213662295, 'support': 205976}, '2': {'precision': 0.38504713136811675, 'recall': 0.3584910162494929, 'f1-score': 0.37129483637226357, 'support': 209545}, 'accuracy': 0.3766328790064475, 'macro avg': {'precision': 0.37723712082979266, 'recall': 0.3766788729228743, 'f1-score': 0.37663886717546574, 'support': 624587}, 'weighted avg': {'precision': 0.3773458038389351, 'recall': 0.3766328790064475, 'f1-score': 0.3766708939880568, 'support': 624587}}
[[81199 71725 56142]
 [63224 78921 63831]
 [63681 70744 75120]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0868056
{'0': {'precision': 0.40486910843651686, 'recall': 0.38986395408624114, 'f1-score': 0.39722487699550457, 'support': 71961}, '1': {'precision': 0.37578126914875365, 'recall': 0.42516638935108153, 'f1-score': 0.3989513264549369, 'support': 72120}, '2': {'precision': 0.3841211640735969, 'recall': 0.34527962943717805, 'f1-score': 0.36366621580416414, 'support': 67357}, 'accuracy': 0.3877023051674723, 'macro avg': {'precision': 0.38825718055295577, 'recall': 0.38676999095816694, 'f1-score': 0.3866141397515352, 'support': 211438}, 'weighted avg': {'precision': 0.38833785928600145, 'recall': 0.3877023051674723, 'f1-score': 0.3871231015017388, 'support': 211438}}
[[28055 26561 17345]
 [21513 30663 19944]
 [19726 24374 23257]]
training model: results/ATVI/W3/deepVOL_L2/h200
Epoch 1/50
2440/2440 - 69s - loss: 3.2880 - accuracy200: 0.3652 - val_loss: 3.3273 - val_accuracy200: 0.3429 - 69s/epoch - 28ms/step
Epoch 2/50
2440/2440 - 68s - loss: 3.2660 - accuracy200: 0.3753 - val_loss: 3.3142 - val_accuracy200: 0.3441 - 68s/epoch - 28ms/step
Epoch 3/50
2440/2440 - 67s - loss: 3.2581 - accuracy200: 0.3824 - val_loss: 3.3181 - val_accuracy200: 0.3459 - 67s/epoch - 28ms/step
Epoch 4/50
2440/2440 - 67s - loss: 3.2533 - accuracy200: 0.3852 - val_loss: 3.3425 - val_accuracy200: 0.3498 - 67s/epoch - 28ms/step
Epoch 5/50
2440/2440 - 67s - loss: 3.2494 - accuracy200: 0.3892 - val_loss: 3.3564 - val_accuracy200: 0.3485 - 67s/epoch - 28ms/step
Epoch 6/50
2440/2440 - 67s - loss: 3.2446 - accuracy200: 0.3926 - val_loss: 3.3687 - val_accuracy200: 0.3502 - 67s/epoch - 28ms/step
Epoch 7/50
2440/2440 - 67s - loss: 3.2406 - accuracy200: 0.3947 - val_loss: 3.3908 - val_accuracy200: 0.3539 - 67s/epoch - 28ms/step
Epoch 8/50
2440/2440 - 67s - loss: 3.2378 - accuracy200: 0.3966 - val_loss: 3.3815 - val_accuracy200: 0.3528 - 67s/epoch - 27ms/step
Epoch 9/50
2440/2440 - 67s - loss: 3.2343 - accuracy200: 0.3988 - val_loss: 3.4013 - val_accuracy200: 0.3540 - 67s/epoch - 28ms/step
Epoch 10/50
2440/2440 - 67s - loss: 3.2312 - accuracy200: 0.4006 - val_loss: 3.4131 - val_accuracy200: 0.3577 - 67s/epoch - 28ms/step
Epoch 11/50
2440/2440 - 67s - loss: 3.2289 - accuracy200: 0.4026 - val_loss: 3.3884 - val_accuracy200: 0.3594 - 67s/epoch - 27ms/step
Epoch 12/50
2440/2440 - 67s - loss: 3.2260 - accuracy200: 0.4039 - val_loss: 3.4207 - val_accuracy200: 0.3570 - 67s/epoch - 27ms/step
testing model: results/ATVI/W3/deepVOL_L2/h200
Evaluating performance on  test set...
6082/6082 - 78s - 78s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1021556
{'0': {'precision': 0.41394441735738663, 'recall': 0.013308513765063193, 'f1-score': 0.02578793297871129, 'support': 510350}, '1': {'precision': 0.34932742477120304, 'recall': 0.9850370899136041, 'f1-score': 0.5157518296339287, 'support': 543544}, '2': {'precision': 0.4251784555483452, 'recall': 0.006514088007794635, 'f1-score': 0.01283158544108575, 'support': 502910}, 'accuracy': 0.35038386335081356, 'macro avg': {'precision': 0.396150099225645, 'recall': 0.3349532305621539, 'f1-score': 0.18479044935124192, 'support': 1556804}, 'weighted avg': {'precision': 0.3950130242779434, 'recall': 0.35038386335081356, 'f1-score': 0.19266896585338028, 'support': 1556804}}
[[  6792 501777   1781]
 [  5485 535411   2648]
 [  4131 495503   3276]]
Evaluating performance on  train set...
2440/2440 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1128832
{'0': {'precision': 0.4129678586336441, 'recall': 0.01425394889133285, 'f1-score': 0.02755675223991458, 'support': 208223}, '1': {'precision': 0.32974099395641726, 'recall': 0.9849434590715538, 'f1-score': 0.4940748092625631, 'support': 205957}, '2': {'precision': 0.43097184377838327, 'recall': 0.0045103062160479455, 'f1-score': 0.008927185584805913, 'support': 210407}, 'accuracy': 0.33105556151504917, 'macro avg': {'precision': 0.3912268987894816, 'recall': 0.33456923805964484, 'f1-score': 0.1768529156957612, 'support': 624587}, 'weighted avg': {'precision': 0.3915889460626516, 'recall': 0.33105556151504917, 'f1-score': 0.175114847811888, 'support': 624587}}
[[  2968 204750    505]
 [  2353 202856    748]
 [  1866 207592    949]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1055018
{'0': {'precision': 0.42512562814070354, 'recall': 0.023434578468442265, 'f1-score': 0.044420524802772345, 'support': 72201}, '1': {'precision': 0.34259689472257715, 'recall': 0.977626163577604, 'f1-score': 0.5073865143250353, 'support': 72406}, '2': {'precision': 0.4002375296912114, 'recall': 0.005042570064790292, 'f1-score': 0.009959658948177264, 'support': 66831}, 'accuracy': 0.344379912787673, 'macro avg': {'precision': 0.3893200175181641, 'recall': 0.3353677707036122, 'f1-score': 0.18725556602532833, 'support': 211438}, 'weighted avg': {'precision': 0.3889974393603004, 'recall': 0.344379912787673, 'f1-score': 0.19206882506772252, 'support': 211438}}
[[ 1692 70295   214]
 [ 1329 70786   291]
 [  959 65535   337]]
training model: results/ATVI/W3/deepVOL_L2/h300
Epoch 1/50
2440/2440 - 70s - loss: 3.2698 - accuracy300: 0.3785 - val_loss: 3.3099 - val_accuracy300: 0.3350 - 70s/epoch - 29ms/step
Epoch 2/50
2440/2440 - 68s - loss: 3.2561 - accuracy300: 0.3824 - val_loss: 3.3221 - val_accuracy300: 0.3345 - 68s/epoch - 28ms/step
Epoch 3/50
2440/2440 - 67s - loss: 3.2567 - accuracy300: 0.3807 - val_loss: 3.3743 - val_accuracy300: 0.3275 - 67s/epoch - 28ms/step
Epoch 4/50
2440/2440 - 67s - loss: 3.2522 - accuracy300: 0.3847 - val_loss: 3.3468 - val_accuracy300: 0.3341 - 67s/epoch - 28ms/step
Epoch 5/50
2440/2440 - 68s - loss: 3.2491 - accuracy300: 0.3885 - val_loss: 3.3588 - val_accuracy300: 0.3334 - 68s/epoch - 28ms/step
Epoch 6/50
2440/2440 - 68s - loss: 3.2455 - accuracy300: 0.3925 - val_loss: 3.3436 - val_accuracy300: 0.3368 - 68s/epoch - 28ms/step
Epoch 7/50
2440/2440 - 68s - loss: 3.2433 - accuracy300: 0.3933 - val_loss: 3.3257 - val_accuracy300: 0.3386 - 68s/epoch - 28ms/step
Epoch 8/50
2440/2440 - 68s - loss: 3.2424 - accuracy300: 0.3940 - val_loss: 3.3306 - val_accuracy300: 0.3384 - 68s/epoch - 28ms/step
Epoch 9/50
2440/2440 - 67s - loss: 3.2394 - accuracy300: 0.3971 - val_loss: 3.3402 - val_accuracy300: 0.3375 - 67s/epoch - 28ms/step
Epoch 10/50
2440/2440 - 67s - loss: 3.2375 - accuracy300: 0.3982 - val_loss: 3.3601 - val_accuracy300: 0.3378 - 67s/epoch - 28ms/step
Epoch 11/50
2440/2440 - 68s - loss: 3.2346 - accuracy300: 0.3991 - val_loss: 3.3509 - val_accuracy300: 0.3406 - 68s/epoch - 28ms/step
testing model: results/ATVI/W3/deepVOL_L2/h300
Evaluating performance on  test set...
6082/6082 - 82s - 82s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103787
{'0': {'precision': 0.3644022855930743, 'recall': 0.10098276938902973, 'f1-score': 0.15814152851253815, 'support': 544380}, '1': {'precision': 0.3128209586600482, 'recall': 0.5502400663638953, 'f1-score': 0.398874749438134, 'support': 477368}, '2': {'precision': 0.34368697838855394, 'recall': 0.36373949642654224, 'f1-score': 0.3534290358021664, 'support': 535056}, 'accuracy': 0.3290465594898266, 'macro avg': {'precision': 0.3403034075472255, 'recall': 0.33832077739315575, 'f1-score': 0.30348177125094616, 'support': 1556804}, 'weighted avg': {'precision': 0.3414661136106111, 'recall': 0.3290465594898266, 'f1-score': 0.29907647517709524, 'support': 1556804}}
[[ 54973 287763 201644]
 [ 44692 262667 170009]
 [ 51193 289242 194621]]
Evaluating performance on  train set...
2440/2440 - 33s - 33s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1030473
{'0': {'precision': 0.33679713829598534, 'recall': 0.10948642051242624, 'f1-score': 0.16525239338555267, 'support': 208108}, '1': {'precision': 0.335713210324696, 'recall': 0.4867971027851491, 'f1-score': 0.3973791344569763, 'support': 206129}, '2': {'precision': 0.339842660052705, 'recall': 0.4168908961255051, 'f1-score': 0.374444373278678, 'support': 210350}, 'accuracy': 0.3375366442144969, 'macro avg': {'precision': 0.33745100289112884, 'recall': 0.33772480647436015, 'f1-score': 0.312358633707069, 'support': 624587}, 'weighted avg': {'precision': 0.33746509410155295, 'recall': 0.3375366442144969, 'f1-score': 0.31231210801430803, 'support': 624587}}
[[ 22785  98293  87030]
 [ 22469 100343  83317]
 [ 22398 100259  87693]]
Evaluating performance on  val set...
826/826 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1028972
{'0': {'precision': 0.3513028266273824, 'recall': 0.10511164065620739, 'f1-score': 0.161809141124458, 'support': 72599}, '1': {'precision': 0.34244471744471744, 'recall': 0.5511849947741589, 'f1-score': 0.42243534926012927, 'support': 70802}, '2': {'precision': 0.3252019642008554, 'recall': 0.36209709422814057, 'f1-score': 0.34265923932319375, 'support': 68037}, 'accuracy': 0.3371768556267085, 'macro avg': {'precision': 0.33964983609098504, 'recall': 0.33946457655283563, 'f1-score': 0.30896790990259365, 'support': 211438}, 'weighted avg': {'precision': 0.339937810768054, 'recall': 0.3371768556267085, 'f1-score': 0.3072766300316988, 'support': 211438}}
[[ 7631 38607 26361]
 [ 7018 39025 24759]
 [ 7073 36328 24636]]
training model: results/ATVI/W3/deepVOL_L2/h500
Epoch 1/50
2440/2440 - 70s - loss: 3.2549 - accuracy500: 0.3936 - val_loss: 3.5411 - val_accuracy500: 0.2944 - 70s/epoch - 29ms/step
Epoch 2/50
2440/2440 - 68s - loss: 3.2402 - accuracy500: 0.3965 - val_loss: 3.4977 - val_accuracy500: 0.3004 - 68s/epoch - 28ms/step
Epoch 3/50
2440/2440 - 67s - loss: 3.2391 - accuracy500: 0.3963 - val_loss: 3.4893 - val_accuracy500: 0.2997 - 67s/epoch - 28ms/step
Epoch 4/50
2440/2440 - 68s - loss: 3.2381 - accuracy500: 0.3984 - val_loss: 3.5295 - val_accuracy500: 0.2990 - 68s/epoch - 28ms/step
Epoch 5/50
2440/2440 - 68s - loss: 3.2345 - accuracy500: 0.3999 - val_loss: 3.5832 - val_accuracy500: 0.2981 - 68s/epoch - 28ms/step
Epoch 6/50
2440/2440 - 69s - loss: 3.2332 - accuracy500: 0.4003 - val_loss: 3.6051 - val_accuracy500: 0.2962 - 69s/epoch - 28ms/step
Epoch 7/50
2440/2440 - 67s - loss: 3.2339 - accuracy500: 0.4013 - val_loss: 3.5814 - val_accuracy500: 0.2954 - 67s/epoch - 27ms/step
Epoch 8/50
2440/2440 - 67s - loss: 3.2357 - accuracy500: 0.3983 - val_loss: 3.6790 - val_accuracy500: 0.2946 - 67s/epoch - 28ms/step
Epoch 9/50
2440/2440 - 68s - loss: 3.2315 - accuracy500: 0.4021 - val_loss: 3.6293 - val_accuracy500: 0.2943 - 68s/epoch - 28ms/step
Epoch 10/50
2440/2440 - 67s - loss: 3.2312 - accuracy500: 0.4015 - val_loss: 3.6544 - val_accuracy500: 0.2977 - 67s/epoch - 27ms/step
Epoch 11/50
2440/2440 - 68s - loss: 3.2316 - accuracy500: 0.4015 - val_loss: 3.6753 - val_accuracy500: 0.2951 - 68s/epoch - 28ms/step
Epoch 12/50
2440/2440 - 67s - loss: 3.2303 - accuracy500: 0.4019 - val_loss: 3.6994 - val_accuracy500: 0.2945 - 67s/epoch - 28ms/step
Epoch 13/50
2440/2440 - 67s - loss: 3.2287 - accuracy500: 0.4026 - val_loss: 3.6699 - val_accuracy500: 0.2943 - 67s/epoch - 28ms/step
testing model: results/ATVI/W3/deepVOL_L2/h500
Evaluating performance on  test set...
6082/6082 - 79s - 79s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1916202
{'0': {'precision': 0.39766666666666667, 'recall': 0.002001765177675536, 'f1-score': 0.003983478414755899, 'support': 595974}, '1': {'precision': 0.24711816982955562, 'recall': 0.9528012691919391, 'f1-score': 0.3924505232551232, 'support': 381345}, '2': {'precision': 0.3889135148734291, 'recall': 0.05602043193525286, 'f1-score': 0.09793410120731995, 'support': 579485}, 'accuracy': 0.2550109069606707, 'macro avg': {'precision': 0.3445661171232171, 'recall': 0.3369411554349558, 'f1-score': 0.164789367625733, 'support': 1556804}, 'weighted avg': {'precision': 0.3575310833220373, 'recall': 0.2550109069606707, 'f1-score': 0.1341109330356323, 'support': 1556804}}
[[  1193 561160  33621]
 [   612 363346  17387]
 [  1195 545827  32463]]
Evaluating performance on  train set...
2440/2440 - 32s - 32s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1370802
{'0': {'precision': 0.39149888143176736, 'recall': 0.002531303790205542, 'f1-score': 0.005030084697045184, 'support': 207403}, '1': {'precision': 0.33492698176919156, 'recall': 0.9381731094876385, 'f1-score': 0.4936288829066194, 'support': 206690}, '2': {'precision': 0.3590478986472754, 'recall': 0.07553184413807519, 'f1-score': 0.12480816406633304, 'support': 210494}, 'accuracy': 0.33675853003664824, 'macro avg': {'precision': 0.36182458728274475, 'recall': 0.3387454191386397, 'f1-score': 0.20782237722333252, 'support': 624587}, 'weighted avg': {'precision': 0.36184155088935027, 'recall': 0.33675853003664824, 'f1-score': 0.20708528699984013, 'support': 624587}}
[[   525 190917  15961]
 [   358 193911  12421]
 [   458 194137  15899]]
Evaluating performance on  val set...
826/826 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1641532
{'0': {'precision': 0.31899641577060933, 'recall': 0.0011459916046457728, 'f1-score': 0.0022837787557254846, 'support': 77662}, '1': {'precision': 0.29637427717545867, 'recall': 0.9547244410871277, 'f1-score': 0.4523316377813652, 'support': 62219}, '2': {'precision': 0.3514445479962721, 'recall': 0.0526992467543357, 'f1-score': 0.09165481789347042, 'support': 71557}, 'accuracy': 0.29919881951210286, 'macro avg': {'precision': 0.32227174698078004, 'recall': 0.33618989314870307, 'f1-score': 0.18209007814352038, 'support': 211438}, 'weighted avg': {'precision': 0.32332091825559345, 'recall': 0.29919881951210286, 'f1-score': 0.1649633878529355, 'support': 211438}}
[[   89 73350  4223]
 [   81 59402  2736]
 [  109 67677  3771]]
training model: results/ATVI/W3/deepVOL_L2/h1000
Epoch 1/50
2440/2440 - 74s - loss: 3.2815 - accuracy1000: 0.3728 - val_loss: 3.3757 - val_accuracy1000: 0.3482 - 74s/epoch - 30ms/step
Epoch 2/50
2440/2440 - 70s - loss: 3.2634 - accuracy1000: 0.3831 - val_loss: 3.3306 - val_accuracy1000: 0.3510 - 70s/epoch - 29ms/step
Epoch 3/50
2440/2440 - 74s - loss: 3.2575 - accuracy1000: 0.3876 - val_loss: 3.3403 - val_accuracy1000: 0.3473 - 74s/epoch - 30ms/step
Epoch 4/50
2440/2440 - 70s - loss: 3.2523 - accuracy1000: 0.3913 - val_loss: 3.3297 - val_accuracy1000: 0.3577 - 70s/epoch - 29ms/step
Epoch 5/50
2440/2440 - 85s - loss: 3.2497 - accuracy1000: 0.3923 - val_loss: 3.3278 - val_accuracy1000: 0.3564 - 85s/epoch - 35ms/step
Epoch 6/50
2440/2440 - 80s - loss: 3.2483 - accuracy1000: 0.3938 - val_loss: 3.3359 - val_accuracy1000: 0.3527 - 80s/epoch - 33ms/step
Epoch 7/50
2440/2440 - 71s - loss: 3.2468 - accuracy1000: 0.3935 - val_loss: 3.3364 - val_accuracy1000: 0.3517 - 71s/epoch - 29ms/step
Epoch 8/50
2440/2440 - 67s - loss: 3.2465 - accuracy1000: 0.3928 - val_loss: 3.3658 - val_accuracy1000: 0.3538 - 67s/epoch - 27ms/step
Epoch 9/50
2440/2440 - 66s - loss: 3.2453 - accuracy1000: 0.3919 - val_loss: 3.3522 - val_accuracy1000: 0.3542 - 66s/epoch - 27ms/step
Epoch 10/50
2440/2440 - 67s - loss: 3.2424 - accuracy1000: 0.3940 - val_loss: 3.3421 - val_accuracy1000: 0.3529 - 67s/epoch - 27ms/step
Epoch 11/50
2440/2440 - 66s - loss: 3.2398 - accuracy1000: 0.3947 - val_loss: 3.3538 - val_accuracy1000: 0.3554 - 66s/epoch - 27ms/step
Epoch 12/50
2440/2440 - 66s - loss: 3.2373 - accuracy1000: 0.3962 - val_loss: 3.3688 - val_accuracy1000: 0.3483 - 66s/epoch - 27ms/step
Epoch 13/50
2440/2440 - 67s - loss: 3.2340 - accuracy1000: 0.3981 - val_loss: 3.3629 - val_accuracy1000: 0.3528 - 67s/epoch - 27ms/step
Epoch 14/50
2440/2440 - 68s - loss: 3.2319 - accuracy1000: 0.3974 - val_loss: 3.4177 - val_accuracy1000: 0.3546 - 68s/epoch - 28ms/step
Epoch 15/50
2440/2440 - 66s - loss: 3.2289 - accuracy1000: 0.4003 - val_loss: 3.3962 - val_accuracy1000: 0.3510 - 66s/epoch - 27ms/step
testing model: results/ATVI/W3/deepVOL_L2/h1000
Evaluating performance on  test set...
6082/6082 - 82s - 82s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1047221
{'0': {'precision': 0.37177804959412875, 'recall': 0.06593319910311603, 'f1-score': 0.11200313557859969, 'support': 507089}, '1': {'precision': 0.36504419274153066, 'recall': 0.9080562922888448, 'f1-score': 0.5207455029357558, 'support': 549347}, '2': {'precision': 0.34554603427660424, 'recall': 0.06930699005531929, 'f1-score': 0.11545657935038821, 'support': 500368}, 'accuracy': 0.3641762225688012, 'macro avg': {'precision': 0.36078942553742116, 'recall': 0.34776549381576, 'f1-score': 0.2494017392882479, 'support': 1556804}, 'weighted avg': {'precision': 0.36097072567872046, 'recall': 0.3641762225688012, 'f1-score': 0.2573453790683093, 'support': 1556804}}
[[ 33434 435523  38132]
 [ 22960 498838  27549]
 [ 33536 432153  34679]]
Evaluating performance on  train set...
2440/2440 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1133516
{'0': {'precision': 0.36702179083122255, 'recall': 0.09251704658995091, 'f1-score': 0.1477819472774551, 'support': 205173}, '1': {'precision': 0.3406477482675619, 'recall': 0.8506352694619493, 'f1-score': 0.4864788380706646, 'support': 206133}, '2': {'precision': 0.3577781218282844, 'recall': 0.0975145465371974, 'f1-score': 0.15325777784327885, 'support': 213281}, 'accuracy': 0.34442599669861845, 'macro avg': {'precision': 0.35514922030902296, 'recall': 0.34688895419636584, 'f1-score': 0.2625061877304662, 'support': 624587}, 'weighted avg': {'precision': 0.35516105808399806, 'recall': 0.34442599669861845, 'f1-score': 0.26143224228645484, 'support': 624587}}
[[ 18982 166383  19808]
 [ 13264 175344  17525]
 [ 19473 173010  20798]]
Evaluating performance on  val set...
826/826 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1081972
{'0': {'precision': 0.39843273835437526, 'recall': 0.06241305000136392, 'f1-score': 0.1079207103522281, 'support': 73318}, '1': {'precision': 0.3568793309949525, 'recall': 0.9066519961421954, 'f1-score': 0.5121604045411121, 'support': 73617}, '2': {'precision': 0.3317348596179132, 'recall': 0.06649303133187603, 'f1-score': 0.11078107242483727, 'support': 64503}, 'accuracy': 0.35759891788609427, 'macro avg': {'precision': 0.3623489763224137, 'recall': 0.3451860258251451, 'f1-score': 0.24362072910605914, 'support': 211438}, 'weighted avg': {'precision': 0.3636175657661147, 'recall': 0.35759891788609427, 'f1-score': 0.24953865746614606, 'support': 211438}}
[[ 4576 63896  4846]
 [ 3078 66745  3794]
 [ 3831 56383  4289]]
training model: results/ATVI/W3/deepVOL_L3/h10
Epoch 1/50
2440/2440 - 99s - loss: 3.2537 - accuracy10: 0.4263 - val_loss: 3.0229 - val_accuracy10: 0.6259 - 99s/epoch - 41ms/step
Epoch 2/50
2440/2440 - 98s - loss: 3.2554 - accuracy10: 0.4147 - val_loss: 2.9504 - val_accuracy10: 0.5849 - 98s/epoch - 40ms/step
Epoch 3/50
2440/2440 - 104s - loss: 3.1246 - accuracy10: 0.4583 - val_loss: 2.8763 - val_accuracy10: 0.5171 - 104s/epoch - 43ms/step
Epoch 4/50
2440/2440 - 102s - loss: 3.0295 - accuracy10: 0.4755 - val_loss: 2.7515 - val_accuracy10: 0.5379 - 102s/epoch - 42ms/step
Epoch 5/50
2440/2440 - 104s - loss: 2.8495 - accuracy10: 0.5192 - val_loss: 2.6547 - val_accuracy10: 0.5840 - 104s/epoch - 42ms/step
Epoch 6/50
2440/2440 - 104s - loss: 2.7877 - accuracy10: 0.5393 - val_loss: 2.6510 - val_accuracy10: 0.6136 - 104s/epoch - 42ms/step
Epoch 7/50
2440/2440 - 98s - loss: 2.7442 - accuracy10: 0.5543 - val_loss: 2.6462 - val_accuracy10: 0.5841 - 98s/epoch - 40ms/step
Epoch 8/50
2440/2440 - 97s - loss: 2.7107 - accuracy10: 0.5619 - val_loss: 2.5745 - val_accuracy10: 0.5913 - 97s/epoch - 40ms/step
Epoch 9/50
2440/2440 - 98s - loss: 2.6915 - accuracy10: 0.5670 - val_loss: 2.5428 - val_accuracy10: 0.5929 - 98s/epoch - 40ms/step
Epoch 10/50
2440/2440 - 97s - loss: 2.6772 - accuracy10: 0.5703 - val_loss: 2.5180 - val_accuracy10: 0.5980 - 97s/epoch - 40ms/step
Epoch 11/50
2440/2440 - 100s - loss: 2.6653 - accuracy10: 0.5721 - val_loss: 2.5120 - val_accuracy10: 0.5984 - 100s/epoch - 41ms/step
Epoch 12/50
2440/2440 - 98s - loss: 2.6552 - accuracy10: 0.5741 - val_loss: 2.5065 - val_accuracy10: 0.6093 - 98s/epoch - 40ms/step
Epoch 13/50
2440/2440 - 98s - loss: 2.6481 - accuracy10: 0.5760 - val_loss: 2.4874 - val_accuracy10: 0.6097 - 98s/epoch - 40ms/step
Epoch 14/50
2440/2440 - 97s - loss: 2.6403 - accuracy10: 0.5772 - val_loss: 2.4913 - val_accuracy10: 0.6066 - 97s/epoch - 40ms/step
Epoch 15/50
2440/2440 - 97s - loss: 2.6355 - accuracy10: 0.5775 - val_loss: 2.4697 - val_accuracy10: 0.6084 - 97s/epoch - 40ms/step
Epoch 16/50
2440/2440 - 96s - loss: 2.6287 - accuracy10: 0.5792 - val_loss: 2.4630 - val_accuracy10: 0.6106 - 96s/epoch - 39ms/step
Epoch 17/50
2440/2440 - 94s - loss: 2.6242 - accuracy10: 0.5799 - val_loss: 2.4505 - val_accuracy10: 0.6128 - 94s/epoch - 39ms/step
Epoch 18/50
2440/2440 - 95s - loss: 2.6189 - accuracy10: 0.5808 - val_loss: 2.4389 - val_accuracy10: 0.6213 - 95s/epoch - 39ms/step
Epoch 19/50
2440/2440 - 95s - loss: 2.6148 - accuracy10: 0.5815 - val_loss: 2.4576 - val_accuracy10: 0.6141 - 95s/epoch - 39ms/step
Epoch 20/50
2440/2440 - 95s - loss: 2.6100 - accuracy10: 0.5820 - val_loss: 2.4674 - val_accuracy10: 0.6195 - 95s/epoch - 39ms/step
Epoch 21/50
2440/2440 - 96s - loss: 2.6063 - accuracy10: 0.5828 - val_loss: 2.4628 - val_accuracy10: 0.6206 - 96s/epoch - 39ms/step
Epoch 22/50
2440/2440 - 95s - loss: 2.6021 - accuracy10: 0.5839 - val_loss: 2.4380 - val_accuracy10: 0.6265 - 95s/epoch - 39ms/step
Epoch 23/50
2440/2440 - 95s - loss: 2.5994 - accuracy10: 0.5845 - val_loss: 2.4463 - val_accuracy10: 0.6240 - 95s/epoch - 39ms/step
Epoch 24/50
2440/2440 - 95s - loss: 2.5955 - accuracy10: 0.5852 - val_loss: 2.4378 - val_accuracy10: 0.6266 - 95s/epoch - 39ms/step
Epoch 25/50
2440/2440 - 96s - loss: 2.5926 - accuracy10: 0.5853 - val_loss: 2.4603 - val_accuracy10: 0.6233 - 96s/epoch - 39ms/step
Epoch 26/50
2440/2440 - 96s - loss: 2.5887 - accuracy10: 0.5859 - val_loss: 2.4666 - val_accuracy10: 0.6241 - 96s/epoch - 39ms/step
Epoch 27/50
2440/2440 - 98s - loss: 2.5854 - accuracy10: 0.5865 - val_loss: 2.4582 - val_accuracy10: 0.6269 - 98s/epoch - 40ms/step
Epoch 28/50
2440/2440 - 97s - loss: 2.5829 - accuracy10: 0.5870 - val_loss: 2.4559 - val_accuracy10: 0.6290 - 97s/epoch - 40ms/step
Epoch 29/50
2440/2440 - 95s - loss: 2.5792 - accuracy10: 0.5879 - val_loss: 2.4602 - val_accuracy10: 0.6229 - 95s/epoch - 39ms/step
Epoch 30/50
2440/2440 - 94s - loss: 2.5768 - accuracy10: 0.5881 - val_loss: 2.4623 - val_accuracy10: 0.6206 - 94s/epoch - 39ms/step
Epoch 31/50
2440/2440 - 94s - loss: 2.5742 - accuracy10: 0.5883 - val_loss: 2.4712 - val_accuracy10: 0.6181 - 94s/epoch - 39ms/step
Epoch 32/50
2440/2440 - 94s - loss: 2.5712 - accuracy10: 0.5893 - val_loss: 2.4698 - val_accuracy10: 0.6205 - 94s/epoch - 39ms/step
Epoch 33/50
2440/2440 - 94s - loss: 2.5684 - accuracy10: 0.5893 - val_loss: 2.4696 - val_accuracy10: 0.6255 - 94s/epoch - 39ms/step
Epoch 34/50
2440/2440 - 94s - loss: 2.5656 - accuracy10: 0.5899 - val_loss: 2.4480 - val_accuracy10: 0.6237 - 94s/epoch - 39ms/step
testing model: results/ATVI/W3/deepVOL_L3/h10
Evaluating performance on  test set...
6082/6082 - 111s - 111s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7853656
{'0': {'precision': 0.4781219113918611, 'recall': 0.3223798106524306, 'f1-score': 0.3851006113257505, 'support': 276106}, '1': {'precision': 0.8309943739663241, 'recall': 0.6988532876265618, 'f1-score': 0.7592169662708367, 'support': 1005832}, '2': {'precision': 0.37874632918339696, 'recall': 0.7230650571551228, 'f1-score': 0.49710547477342165, 'support': 274866}, 'accuracy': 0.6363588479988489, 'macro avg': {'precision': 0.5626208715138608, 'recall': 0.5814327184780385, 'f1-score': 0.5471410174566697, 'support': 1556804}, 'weighted avg': {'precision': 0.6885629469987105, 'recall': 0.6363588479988489, 'f1-score': 0.6465879471262324, 'support': 1556804}}
[[ 89011  84495 102600]
 [ 79502 702929 223401]
 [ 17655  58465 198746]]
Evaluating performance on  train set...
2440/2440 - 44s - 44s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91622806
{'0': {'precision': 0.4796441850614204, 'recall': 0.28422814112397154, 'f1-score': 0.35694021225176004, 'support': 143420}, '1': {'precision': 0.774086469878196, 'recall': 0.5847130741108035, 'f1-score': 0.6662034608891865, 'support': 337805}, '2': {'precision': 0.3800587128869513, 'recall': 0.7540491901619676, 'f1-score': 0.5053892383537051, 'support': 143362}, 'accuracy': 0.5545824680949171, 'macro avg': {'precision': 0.5445964559421892, 'recall': 0.5409968017989142, 'f1-score': 0.5095109704982171, 'support': 624587}, 'weighted avg': {'precision': 0.6160339971462936, 'recall': 0.5545824680949171, 'f1-score': 0.5582774494757061, 'support': 624587}}
[[ 40764  32487  70169]
 [ 34122 197519 106164]
 [ 10102  25158 108102]]
Evaluating performance on  val set...
826/826 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8100915
{'0': {'precision': 0.494628808753644, 'recall': 0.3101540002504069, 'f1-score': 0.3812484609702044, 'support': 39935}, '1': {'precision': 0.8009662334978169, 'recall': 0.7027237354085603, 'f1-score': 0.7486356831243258, 'support': 132355}, '2': {'precision': 0.38532358130798566, 'recall': 0.6917083886788598, 'f1-score': 0.494937125310718, 'support': 39148}, 'accuracy': 0.6265382759958001, 'macro avg': {'precision': 0.5603062078531489, 'recall': 0.5681953747792756, 'f1-score': 0.5416070898017494, 'support': 211438}, 'weighted avg': {'precision': 0.6661505257958614, 'recall': 0.6265382759958001, 'f1-score': 0.6322734404904948, 'support': 211438}}
[[12386 13370 14179]
 [10328 93009 29018]
 [ 2327  9742 27079]]
training model: results/ATVI/W3/deepVOL_L3/h20
Epoch 1/50
2440/2440 - 99s - loss: 3.2165 - accuracy20: 0.4192 - val_loss: 3.0355 - val_accuracy20: 0.5185 - 99s/epoch - 41ms/step
Epoch 2/50
2440/2440 - 95s - loss: 3.1250 - accuracy20: 0.4597 - val_loss: 3.0373 - val_accuracy20: 0.5450 - 95s/epoch - 39ms/step
Epoch 3/50
2440/2440 - 96s - loss: 3.0623 - accuracy20: 0.4819 - val_loss: 2.9135 - val_accuracy20: 0.5624 - 96s/epoch - 39ms/step
Epoch 4/50
2440/2440 - 94s - loss: 2.9022 - accuracy20: 0.5237 - val_loss: 2.7780 - val_accuracy20: 0.5532 - 94s/epoch - 39ms/step
Epoch 5/50
2440/2440 - 94s - loss: 2.8450 - accuracy20: 0.5402 - val_loss: 2.7847 - val_accuracy20: 0.5555 - 94s/epoch - 39ms/step
Epoch 6/50
2440/2440 - 95s - loss: 2.8215 - accuracy20: 0.5463 - val_loss: 2.7694 - val_accuracy20: 0.5637 - 95s/epoch - 39ms/step
Epoch 7/50
2440/2440 - 96s - loss: 2.8035 - accuracy20: 0.5511 - val_loss: 2.7827 - val_accuracy20: 0.5612 - 96s/epoch - 39ms/step
Epoch 8/50
2440/2440 - 95s - loss: 2.7912 - accuracy20: 0.5537 - val_loss: 2.7368 - val_accuracy20: 0.5684 - 95s/epoch - 39ms/step
Epoch 9/50
2440/2440 - 95s - loss: 2.7809 - accuracy20: 0.5558 - val_loss: 2.7459 - val_accuracy20: 0.5726 - 95s/epoch - 39ms/step
Epoch 10/50
2440/2440 - 95s - loss: 2.7718 - accuracy20: 0.5574 - val_loss: 2.7352 - val_accuracy20: 0.5726 - 95s/epoch - 39ms/step
Epoch 11/50
2440/2440 - 95s - loss: 2.7639 - accuracy20: 0.5595 - val_loss: 2.7008 - val_accuracy20: 0.5896 - 95s/epoch - 39ms/step
Epoch 12/50
2440/2440 - 95s - loss: 2.7557 - accuracy20: 0.5613 - val_loss: 2.7325 - val_accuracy20: 0.5838 - 95s/epoch - 39ms/step
Epoch 13/50
2440/2440 - 101s - loss: 2.7469 - accuracy20: 0.5631 - val_loss: 2.7166 - val_accuracy20: 0.5841 - 101s/epoch - 42ms/step
Epoch 14/50
2440/2440 - 98s - loss: 2.7409 - accuracy20: 0.5640 - val_loss: 2.6938 - val_accuracy20: 0.5938 - 98s/epoch - 40ms/step
Epoch 15/50
2440/2440 - 95s - loss: 2.7355 - accuracy20: 0.5646 - val_loss: 2.6931 - val_accuracy20: 0.5960 - 95s/epoch - 39ms/step
Epoch 16/50
2440/2440 - 98s - loss: 2.7292 - accuracy20: 0.5658 - val_loss: 2.6845 - val_accuracy20: 0.5931 - 98s/epoch - 40ms/step
Epoch 17/50
2440/2440 - 95s - loss: 2.7248 - accuracy20: 0.5667 - val_loss: 2.6642 - val_accuracy20: 0.5994 - 95s/epoch - 39ms/step
Epoch 18/50
2440/2440 - 97s - loss: 2.7209 - accuracy20: 0.5683 - val_loss: 2.6789 - val_accuracy20: 0.5949 - 97s/epoch - 40ms/step
Epoch 19/50
2440/2440 - 95s - loss: 2.7169 - accuracy20: 0.5687 - val_loss: 2.6531 - val_accuracy20: 0.5996 - 95s/epoch - 39ms/step
Epoch 20/50
2440/2440 - 95s - loss: 2.7122 - accuracy20: 0.5701 - val_loss: 2.6577 - val_accuracy20: 0.5945 - 95s/epoch - 39ms/step
Epoch 21/50
2440/2440 - 95s - loss: 2.7077 - accuracy20: 0.5711 - val_loss: 2.6575 - val_accuracy20: 0.5958 - 95s/epoch - 39ms/step
Epoch 22/50
2440/2440 - 97s - loss: 2.7046 - accuracy20: 0.5711 - val_loss: 2.6463 - val_accuracy20: 0.6017 - 97s/epoch - 40ms/step
Epoch 23/50
2440/2440 - 95s - loss: 2.7020 - accuracy20: 0.5718 - val_loss: 2.6868 - val_accuracy20: 0.5948 - 95s/epoch - 39ms/step
Epoch 24/50
2440/2440 - 95s - loss: 2.6985 - accuracy20: 0.5730 - val_loss: 2.6352 - val_accuracy20: 0.5989 - 95s/epoch - 39ms/step
Epoch 25/50
2440/2440 - 95s - loss: 2.6952 - accuracy20: 0.5732 - val_loss: 2.6443 - val_accuracy20: 0.5996 - 95s/epoch - 39ms/step
Epoch 26/50
2440/2440 - 94s - loss: 2.6925 - accuracy20: 0.5738 - val_loss: 2.6449 - val_accuracy20: 0.5987 - 94s/epoch - 38ms/step
Epoch 27/50
2440/2440 - 94s - loss: 2.6903 - accuracy20: 0.5747 - val_loss: 2.6378 - val_accuracy20: 0.6016 - 94s/epoch - 39ms/step
Epoch 28/50
2440/2440 - 100s - loss: 2.6867 - accuracy20: 0.5747 - val_loss: 2.6405 - val_accuracy20: 0.6025 - 100s/epoch - 41ms/step
Epoch 29/50
2440/2440 - 101s - loss: 2.6841 - accuracy20: 0.5753 - val_loss: 2.6408 - val_accuracy20: 0.6017 - 101s/epoch - 41ms/step
Epoch 30/50
2440/2440 - 101s - loss: 2.6816 - accuracy20: 0.5758 - val_loss: 2.6368 - val_accuracy20: 0.6021 - 101s/epoch - 41ms/step
Epoch 31/50
2440/2440 - 101s - loss: 2.6801 - accuracy20: 0.5758 - val_loss: 2.6338 - val_accuracy20: 0.6030 - 101s/epoch - 41ms/step
Epoch 32/50
2440/2440 - 94s - loss: 2.6770 - accuracy20: 0.5768 - val_loss: 2.6516 - val_accuracy20: 0.6003 - 94s/epoch - 39ms/step
Epoch 33/50
2440/2440 - 96s - loss: 2.6746 - accuracy20: 0.5771 - val_loss: 2.6392 - val_accuracy20: 0.6016 - 96s/epoch - 39ms/step
Epoch 34/50
2440/2440 - 97s - loss: 2.6726 - accuracy20: 0.5773 - val_loss: 2.6732 - val_accuracy20: 0.5985 - 97s/epoch - 40ms/step
Epoch 35/50
2440/2440 - 101s - loss: 2.6697 - accuracy20: 0.5780 - val_loss: 2.6601 - val_accuracy20: 0.6010 - 101s/epoch - 41ms/step
Epoch 36/50
2440/2440 - 94s - loss: 2.6680 - accuracy20: 0.5779 - val_loss: 2.6593 - val_accuracy20: 0.6011 - 94s/epoch - 39ms/step
Epoch 37/50
2440/2440 - 95s - loss: 2.6652 - accuracy20: 0.5786 - val_loss: 2.6573 - val_accuracy20: 0.6008 - 95s/epoch - 39ms/step
Epoch 38/50
2440/2440 - 94s - loss: 2.6637 - accuracy20: 0.5787 - val_loss: 2.6485 - val_accuracy20: 0.6040 - 94s/epoch - 38ms/step
Epoch 39/50
2440/2440 - 95s - loss: 2.6612 - accuracy20: 0.5794 - val_loss: 2.6373 - val_accuracy20: 0.6021 - 95s/epoch - 39ms/step
Epoch 40/50
2440/2440 - 101s - loss: 2.6595 - accuracy20: 0.5798 - val_loss: 2.6592 - val_accuracy20: 0.6035 - 101s/epoch - 41ms/step
Epoch 41/50
2440/2440 - 97s - loss: 2.6618 - accuracy20: 0.5794 - val_loss: 2.6609 - val_accuracy20: 0.5974 - 97s/epoch - 40ms/step
testing model: results/ATVI/W3/deepVOL_L3/h20
Evaluating performance on  test set...
6082/6082 - 109s - 109s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.820103
{'0': {'precision': 0.5674607713664771, 'recall': 0.3057318774405719, 'f1-score': 0.39737129541979177, 'support': 356986}, '1': {'precision': 0.7206665842008521, 'recall': 0.7850095029170646, 'f1-score': 0.751463242157667, 'support': 846056}, '2': {'precision': 0.4662885322302405, 'recall': 0.583748395814135, 'f1-score': 0.5184487810021615, 'support': 353762}, 'accuracy': 0.6293740252465949, 'macro avg': {'precision': 0.5848052959325233, 'recall': 0.5581632587239238, 'f1-score': 0.5557611061932067, 'support': 1556804}, 'weighted avg': {'precision': 0.6277315591612711, 'recall': 0.6293740252465949, 'f1-score': 0.6173182055920743, 'support': 1556804}}
[[109142 138721 109123]
 [ 54649 664162 127245]
 [ 28543 118711 206508]]
Evaluating performance on  train set...
2440/2440 - 50s - 50s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93987846
{'0': {'precision': 0.5482343857938152, 'recall': 0.30059265200632757, 'f1-score': 0.3882892994877108, 'support': 179532}, '1': {'precision': 0.6428382323607812, 'recall': 0.6669538878332362, 'f1-score': 0.65467405355494, 'support': 265765}, '2': {'precision': 0.4542281643345473, 'recall': 0.634424675107368, 'f1-score': 0.5294131336309013, 'support': 179290}, 'accuracy': 0.5523089657645772, 'macro avg': {'precision': 0.5484335941630479, 'recall': 0.5339904049823105, 'f1-score': 0.5241254955578506, 'support': 624587}, 'weighted avg': {'precision': 0.5615039796813562, 'recall': 0.5523089657645772, 'f1-score': 0.542147507212511, 'support': 624587}}
[[ 53966  50598  74968]
 [ 26810 177253  61702]
 [ 17660  47884 113746]]
Evaluating performance on  val set...
826/826 - 18s - 18s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86522865
{'0': {'precision': 0.5794970986460348, 'recall': 0.2887042997282556, 'f1-score': 0.38540206079473094, 'support': 51887}, '1': {'precision': 0.6739419728590439, 'recall': 0.7787179581614614, 'f1-score': 0.7225513773969354, 'support': 108608}, '2': {'precision': 0.46486396538813546, 'recall': 0.5483775984924327, 'f1-score': 0.5031790918424323, 'support': 50943}, 'accuracy': 0.6029710837219421, 'macro avg': {'precision': 0.5727676789644047, 'recall': 0.5385999521273832, 'f1-score': 0.5370441766780328, 'support': 211438}, 'weighted avg': {'precision': 0.6003907563185881, 'recall': 0.6029710837219421, 'f1-score': 0.5869600979980495, 'support': 211438}}
[[14980 21665 15242]
 [ 7116 84575 16917]
 [ 3754 19253 27936]]
training model: results/ATVI/W3/deepVOL_L3/h30
Epoch 1/50
2440/2440 - 98s - loss: 3.2313 - accuracy30: 0.4004 - val_loss: 3.2432 - val_accuracy30: 0.4386 - 98s/epoch - 40ms/step
Epoch 2/50
2440/2440 - 95s - loss: 3.2379 - accuracy30: 0.3970 - val_loss: 3.1641 - val_accuracy30: 0.4377 - 95s/epoch - 39ms/step
Epoch 3/50
2440/2440 - 95s - loss: 3.1543 - accuracy30: 0.4289 - val_loss: 3.1035 - val_accuracy30: 0.4926 - 95s/epoch - 39ms/step
Epoch 4/50
2440/2440 - 94s - loss: 3.1170 - accuracy30: 0.4474 - val_loss: 3.1350 - val_accuracy30: 0.4520 - 94s/epoch - 39ms/step
Epoch 5/50
2440/2440 - 94s - loss: 3.0603 - accuracy30: 0.4686 - val_loss: 3.2013 - val_accuracy30: 0.5197 - 94s/epoch - 38ms/step
Epoch 6/50
2440/2440 - 94s - loss: 2.9812 - accuracy30: 0.4892 - val_loss: 2.9914 - val_accuracy30: 0.5268 - 94s/epoch - 39ms/step
Epoch 7/50
2440/2440 - 94s - loss: 2.9177 - accuracy30: 0.5114 - val_loss: 2.9161 - val_accuracy30: 0.5344 - 94s/epoch - 39ms/step
Epoch 8/50
2440/2440 - 94s - loss: 2.8850 - accuracy30: 0.5224 - val_loss: 2.8914 - val_accuracy30: 0.5458 - 94s/epoch - 39ms/step
Epoch 9/50
2440/2440 - 94s - loss: 2.8669 - accuracy30: 0.5274 - val_loss: 2.9146 - val_accuracy30: 0.5443 - 94s/epoch - 39ms/step
Epoch 10/50
2440/2440 - 94s - loss: 2.8555 - accuracy30: 0.5300 - val_loss: 2.8782 - val_accuracy30: 0.5493 - 94s/epoch - 39ms/step
Epoch 11/50
2440/2440 - 94s - loss: 2.8462 - accuracy30: 0.5325 - val_loss: 2.8766 - val_accuracy30: 0.5495 - 94s/epoch - 39ms/step
Epoch 12/50
2440/2440 - 94s - loss: 2.8356 - accuracy30: 0.5357 - val_loss: 2.8756 - val_accuracy30: 0.5525 - 94s/epoch - 39ms/step
Epoch 13/50
2440/2440 - 97s - loss: 2.8292 - accuracy30: 0.5370 - val_loss: 2.8657 - val_accuracy30: 0.5533 - 97s/epoch - 40ms/step
Epoch 14/50
2440/2440 - 94s - loss: 2.8222 - accuracy30: 0.5384 - val_loss: 2.8544 - val_accuracy30: 0.5554 - 94s/epoch - 38ms/step
Epoch 15/50
2440/2440 - 94s - loss: 2.8157 - accuracy30: 0.5405 - val_loss: 2.8650 - val_accuracy30: 0.5549 - 94s/epoch - 39ms/step
Epoch 16/50
2440/2440 - 95s - loss: 2.8105 - accuracy30: 0.5414 - val_loss: 2.8434 - val_accuracy30: 0.5571 - 95s/epoch - 39ms/step
Epoch 17/50
2440/2440 - 94s - loss: 2.8051 - accuracy30: 0.5426 - val_loss: 2.8365 - val_accuracy30: 0.5561 - 94s/epoch - 39ms/step
Epoch 18/50
2440/2440 - 94s - loss: 2.8008 - accuracy30: 0.5436 - val_loss: 2.8330 - val_accuracy30: 0.5579 - 94s/epoch - 39ms/step
Epoch 19/50
2440/2440 - 94s - loss: 2.7964 - accuracy30: 0.5449 - val_loss: 2.8288 - val_accuracy30: 0.5580 - 94s/epoch - 39ms/step
Epoch 20/50
2440/2440 - 95s - loss: 2.7929 - accuracy30: 0.5455 - val_loss: 2.8053 - val_accuracy30: 0.5605 - 95s/epoch - 39ms/step
Epoch 21/50
2440/2440 - 95s - loss: 2.7902 - accuracy30: 0.5456 - val_loss: 2.8240 - val_accuracy30: 0.5592 - 95s/epoch - 39ms/step
Epoch 22/50
2440/2440 - 94s - loss: 2.7867 - accuracy30: 0.5469 - val_loss: 2.8071 - val_accuracy30: 0.5616 - 94s/epoch - 38ms/step
Epoch 23/50
2440/2440 - 93s - loss: 2.7828 - accuracy30: 0.5476 - val_loss: 2.8095 - val_accuracy30: 0.5622 - 93s/epoch - 38ms/step
Epoch 24/50
2440/2440 - 94s - loss: 2.7807 - accuracy30: 0.5478 - val_loss: 2.8120 - val_accuracy30: 0.5606 - 94s/epoch - 39ms/step
Epoch 25/50
2440/2440 - 95s - loss: 2.7785 - accuracy30: 0.5483 - val_loss: 2.7894 - val_accuracy30: 0.5634 - 95s/epoch - 39ms/step
Epoch 26/50
2440/2440 - 94s - loss: 2.7756 - accuracy30: 0.5490 - val_loss: 2.7981 - val_accuracy30: 0.5634 - 94s/epoch - 39ms/step
Epoch 27/50
2440/2440 - 94s - loss: 2.7734 - accuracy30: 0.5494 - val_loss: 2.8083 - val_accuracy30: 0.5607 - 94s/epoch - 39ms/step
Epoch 28/50
2440/2440 - 95s - loss: 2.7701 - accuracy30: 0.5503 - val_loss: 2.8008 - val_accuracy30: 0.5620 - 95s/epoch - 39ms/step
Epoch 29/50
2440/2440 - 95s - loss: 2.7688 - accuracy30: 0.5504 - val_loss: 2.8069 - val_accuracy30: 0.5619 - 95s/epoch - 39ms/step
Epoch 30/50
2440/2440 - 96s - loss: 2.7658 - accuracy30: 0.5512 - val_loss: 2.7953 - val_accuracy30: 0.5641 - 96s/epoch - 39ms/step
Epoch 31/50
2440/2440 - 95s - loss: 2.7642 - accuracy30: 0.5510 - val_loss: 2.7992 - val_accuracy30: 0.5607 - 95s/epoch - 39ms/step
Epoch 32/50
2440/2440 - 95s - loss: 2.7647 - accuracy30: 0.5515 - val_loss: 2.7867 - val_accuracy30: 0.5623 - 95s/epoch - 39ms/step
Epoch 33/50
2440/2440 - 95s - loss: 2.7611 - accuracy30: 0.5522 - val_loss: 2.8004 - val_accuracy30: 0.5640 - 95s/epoch - 39ms/step
Epoch 34/50
2440/2440 - 94s - loss: 2.7586 - accuracy30: 0.5525 - val_loss: 2.7956 - val_accuracy30: 0.5645 - 94s/epoch - 38ms/step
Epoch 35/50
2440/2440 - 94s - loss: 2.7571 - accuracy30: 0.5530 - val_loss: 2.7988 - val_accuracy30: 0.5641 - 94s/epoch - 39ms/step
Epoch 36/50
2440/2440 - 95s - loss: 2.7553 - accuracy30: 0.5535 - val_loss: 2.7912 - val_accuracy30: 0.5641 - 95s/epoch - 39ms/step
Epoch 37/50
2440/2440 - 95s - loss: 2.7529 - accuracy30: 0.5542 - val_loss: 2.8013 - val_accuracy30: 0.5622 - 95s/epoch - 39ms/step
Epoch 38/50
2440/2440 - 94s - loss: 2.7518 - accuracy30: 0.5542 - val_loss: 2.7951 - val_accuracy30: 0.5620 - 94s/epoch - 39ms/step
Epoch 39/50
2440/2440 - 94s - loss: 2.7499 - accuracy30: 0.5546 - val_loss: 2.7831 - val_accuracy30: 0.5639 - 94s/epoch - 39ms/step
Epoch 40/50
2440/2440 - 95s - loss: 2.7480 - accuracy30: 0.5555 - val_loss: 2.8077 - val_accuracy30: 0.5632 - 95s/epoch - 39ms/step
Epoch 41/50
2440/2440 - 95s - loss: 2.7458 - accuracy30: 0.5561 - val_loss: 2.7961 - val_accuracy30: 0.5627 - 95s/epoch - 39ms/step
Epoch 42/50
2440/2440 - 94s - loss: 2.7446 - accuracy30: 0.5561 - val_loss: 2.7875 - val_accuracy30: 0.5622 - 94s/epoch - 39ms/step
Epoch 43/50
2440/2440 - 94s - loss: 2.7432 - accuracy30: 0.5564 - val_loss: 2.8099 - val_accuracy30: 0.5620 - 94s/epoch - 39ms/step
Epoch 44/50
2440/2440 - 94s - loss: 2.7420 - accuracy30: 0.5567 - val_loss: 2.8121 - val_accuracy30: 0.5630 - 94s/epoch - 39ms/step
Epoch 45/50
2440/2440 - 95s - loss: 2.7401 - accuracy30: 0.5573 - val_loss: 2.8027 - val_accuracy30: 0.5611 - 95s/epoch - 39ms/step
Epoch 46/50
2440/2440 - 94s - loss: 2.7387 - accuracy30: 0.5575 - val_loss: 2.7870 - val_accuracy30: 0.5623 - 94s/epoch - 39ms/step
Epoch 47/50
2440/2440 - 94s - loss: 2.7369 - accuracy30: 0.5576 - val_loss: 2.7944 - val_accuracy30: 0.5635 - 94s/epoch - 39ms/step
Epoch 48/50
2440/2440 - 94s - loss: 2.7342 - accuracy30: 0.5581 - val_loss: 2.8175 - val_accuracy30: 0.5629 - 94s/epoch - 39ms/step
Epoch 49/50
2440/2440 - 93s - loss: 2.7335 - accuracy30: 0.5587 - val_loss: 2.8130 - val_accuracy30: 0.5634 - 93s/epoch - 38ms/step
testing model: results/ATVI/W3/deepVOL_L3/h30
Evaluating performance on  test set...
6082/6082 - 111s - 111s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8776055
{'0': {'precision': 0.5566539755458967, 'recall': 0.3663410852336385, 'f1-score': 0.4418771674224858, 'support': 411469}, '1': {'precision': 0.6523114380427366, 'recall': 0.7669438616000466, 'f1-score': 0.7049982527939752, 'support': 739191}, '2': {'precision': 0.49814113019284273, 'recall': 0.5113580404979514, 'f1-score': 0.5046630638686663, 'support': 406144}, 'accuracy': 0.5943850349819245, 'macro avg': {'precision': 0.5690355145938253, 'recall': 0.5482143291105455, 'f1-score': 0.5505128280283759, 'support': 1556804}, 'weighted avg': {'precision': 0.5868083779609926, 'recall': 0.5943850349819245, 'f1-score': 0.5831903021157896, 'support': 1556804}}
[[150738 158672 102059]
 [ 65097 566918 107176]
 [ 54958 143501 207685]]
Evaluating performance on  train set...
2440/2440 - 43s - 43s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96614754
{'0': {'precision': 0.548366879421384, 'recall': 0.3773073339016991, 'f1-score': 0.44703167117881615, 'support': 201748}, '1': {'precision': 0.5604602429275486, 'recall': 0.6524764060375244, 'f1-score': 0.6029780456288527, 'support': 221349}, '2': {'precision': 0.4912159170126664, 'recall': 0.5560474465234007, 'f1-score': 0.5216249624627246, 'support': 201490}, 'accuracy': 0.5324862669251842, 'macro avg': {'precision': 0.5333476797871997, 'recall': 0.5286103954875414, 'f1-score': 0.5238782264234646, 'support': 624587}, 'weighted avg': {'precision': 0.534215938884667, 'recall': 0.5324862669251842, 'f1-score': 0.5263614944043008, 'support': 624587}}
[[ 76121  57998  67629]
 [ 28508 144425  48416]
 [ 34185  55267 112038]]
Evaluating performance on  val set...
826/826 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92567754
{'0': {'precision': 0.5635726699978275, 'recall': 0.34590062836475155, 'f1-score': 0.4286879912415695, 'support': 59997}, '1': {'precision': 0.5955384365738883, 'recall': 0.7518815639084773, 'f1-score': 0.6646396385662747, 'support': 92742}, '2': {'precision': 0.498948283355063, 'recall': 0.48896914768565053, 'f1-score': 0.4939083149779736, 'support': 58699}, 'accuracy': 0.5636924299321787, 'macro avg': {'precision': 0.5526864633089262, 'recall': 0.5289171133196265, 'f1-score': 0.5290786482619393, 'support': 211438}, 'weighted avg': {'precision': 0.5596527608625415, 'recall': 0.5636924299321787, 'f1-score': 0.5502886281147474, 'support': 211438}}
[[20753 24771 14473]
 [ 8661 69731 14350]
 [ 7410 22587 28702]]
training model: results/ATVI/W3/deepVOL_L3/h50
Epoch 1/50
2440/2440 - 100s - loss: 3.2334 - accuracy50: 0.3977 - val_loss: 3.3154 - val_accuracy50: 0.3958 - 100s/epoch - 41ms/step
Epoch 2/50
2440/2440 - 96s - loss: 3.2632 - accuracy50: 0.3770 - val_loss: 3.2561 - val_accuracy50: 0.3958 - 96s/epoch - 40ms/step
Epoch 3/50
2440/2440 - 96s - loss: 3.2196 - accuracy50: 0.3984 - val_loss: 3.1984 - val_accuracy50: 0.4246 - 96s/epoch - 39ms/step
Epoch 4/50
2440/2440 - 97s - loss: 3.1595 - accuracy50: 0.4255 - val_loss: 3.1878 - val_accuracy50: 0.4527 - 97s/epoch - 40ms/step
Epoch 5/50
2440/2440 - 96s - loss: 3.1206 - accuracy50: 0.4396 - val_loss: 3.1954 - val_accuracy50: 0.4651 - 96s/epoch - 39ms/step
Epoch 6/50
2440/2440 - 103s - loss: 3.0841 - accuracy50: 0.4540 - val_loss: 3.1254 - val_accuracy50: 0.4779 - 103s/epoch - 42ms/step
Epoch 7/50
2440/2440 - 95s - loss: 3.0417 - accuracy50: 0.4690 - val_loss: 3.1673 - val_accuracy50: 0.4801 - 95s/epoch - 39ms/step
Epoch 8/50
2440/2440 - 96s - loss: 3.0149 - accuracy50: 0.4804 - val_loss: 3.1203 - val_accuracy50: 0.4874 - 96s/epoch - 39ms/step
Epoch 9/50
2440/2440 - 96s - loss: 2.9998 - accuracy50: 0.4869 - val_loss: 3.1135 - val_accuracy50: 0.4874 - 96s/epoch - 39ms/step
Epoch 10/50
2440/2440 - 96s - loss: 2.9894 - accuracy50: 0.4904 - val_loss: 3.0737 - val_accuracy50: 0.4881 - 96s/epoch - 39ms/step
Epoch 11/50
2440/2440 - 96s - loss: 2.9812 - accuracy50: 0.4925 - val_loss: 3.0810 - val_accuracy50: 0.4914 - 96s/epoch - 39ms/step
Epoch 12/50
2440/2440 - 96s - loss: 2.9764 - accuracy50: 0.4940 - val_loss: 3.0882 - val_accuracy50: 0.4870 - 96s/epoch - 39ms/step
Epoch 13/50
2440/2440 - 95s - loss: 2.9710 - accuracy50: 0.4956 - val_loss: 3.0745 - val_accuracy50: 0.4939 - 95s/epoch - 39ms/step
Epoch 14/50
2440/2440 - 95s - loss: 2.9672 - accuracy50: 0.4970 - val_loss: 3.0686 - val_accuracy50: 0.4908 - 95s/epoch - 39ms/step
Epoch 15/50
2440/2440 - 96s - loss: 2.9640 - accuracy50: 0.4983 - val_loss: 3.0789 - val_accuracy50: 0.4957 - 96s/epoch - 39ms/step
Epoch 16/50
2440/2440 - 96s - loss: 2.9609 - accuracy50: 0.4998 - val_loss: 3.1005 - val_accuracy50: 0.4906 - 96s/epoch - 39ms/step
Epoch 17/50
2440/2440 - 96s - loss: 2.9582 - accuracy50: 0.5004 - val_loss: 3.0811 - val_accuracy50: 0.4926 - 96s/epoch - 39ms/step
Epoch 18/50
2440/2440 - 95s - loss: 2.9555 - accuracy50: 0.5013 - val_loss: 3.0697 - val_accuracy50: 0.4949 - 95s/epoch - 39ms/step
Epoch 19/50
2440/2440 - 95s - loss: 2.9524 - accuracy50: 0.5024 - val_loss: 3.0610 - val_accuracy50: 0.4963 - 95s/epoch - 39ms/step
Epoch 20/50
2440/2440 - 95s - loss: 2.9491 - accuracy50: 0.5032 - val_loss: 3.0528 - val_accuracy50: 0.4951 - 95s/epoch - 39ms/step
Epoch 21/50
2440/2440 - 95s - loss: 2.9469 - accuracy50: 0.5040 - val_loss: 3.1004 - val_accuracy50: 0.4937 - 95s/epoch - 39ms/step
Epoch 22/50
2440/2440 - 95s - loss: 2.9441 - accuracy50: 0.5046 - val_loss: 3.0668 - val_accuracy50: 0.4976 - 95s/epoch - 39ms/step
Epoch 23/50
2440/2440 - 94s - loss: 2.9425 - accuracy50: 0.5051 - val_loss: 3.0821 - val_accuracy50: 0.4948 - 94s/epoch - 39ms/step
Epoch 24/50
2440/2440 - 96s - loss: 2.9394 - accuracy50: 0.5061 - val_loss: 3.0719 - val_accuracy50: 0.4960 - 96s/epoch - 39ms/step
Epoch 25/50
2440/2440 - 95s - loss: 2.9374 - accuracy50: 0.5063 - val_loss: 3.0712 - val_accuracy50: 0.4971 - 95s/epoch - 39ms/step
Epoch 26/50
2440/2440 - 96s - loss: 2.9346 - accuracy50: 0.5074 - val_loss: 3.0377 - val_accuracy50: 0.4991 - 96s/epoch - 39ms/step
Epoch 27/50
2440/2440 - 95s - loss: 2.9324 - accuracy50: 0.5080 - val_loss: 3.0937 - val_accuracy50: 0.4914 - 95s/epoch - 39ms/step
Epoch 28/50
2440/2440 - 94s - loss: 2.9311 - accuracy50: 0.5082 - val_loss: 3.0756 - val_accuracy50: 0.4938 - 94s/epoch - 39ms/step
Epoch 29/50
2440/2440 - 97s - loss: 2.9281 - accuracy50: 0.5088 - val_loss: 3.0707 - val_accuracy50: 0.4969 - 97s/epoch - 40ms/step
Epoch 30/50
2440/2440 - 96s - loss: 2.9274 - accuracy50: 0.5092 - val_loss: 3.0826 - val_accuracy50: 0.4945 - 96s/epoch - 39ms/step
Epoch 31/50
2440/2440 - 97s - loss: 2.9240 - accuracy50: 0.5108 - val_loss: 3.0731 - val_accuracy50: 0.4940 - 97s/epoch - 40ms/step
Epoch 32/50
2440/2440 - 95s - loss: 2.9222 - accuracy50: 0.5115 - val_loss: 3.0787 - val_accuracy50: 0.4958 - 95s/epoch - 39ms/step
Epoch 33/50
2440/2440 - 96s - loss: 2.9198 - accuracy50: 0.5120 - val_loss: 3.0780 - val_accuracy50: 0.4976 - 96s/epoch - 39ms/step
Epoch 34/50
2440/2440 - 98s - loss: 2.9180 - accuracy50: 0.5122 - val_loss: 3.0664 - val_accuracy50: 0.4975 - 98s/epoch - 40ms/step
Epoch 35/50
2440/2440 - 99s - loss: 2.9158 - accuracy50: 0.5129 - val_loss: 3.0854 - val_accuracy50: 0.4978 - 99s/epoch - 40ms/step
Epoch 36/50
2440/2440 - 98s - loss: 2.9138 - accuracy50: 0.5138 - val_loss: 3.1035 - val_accuracy50: 0.4935 - 98s/epoch - 40ms/step
testing model: results/ATVI/W3/deepVOL_L3/h50
Evaluating performance on  test set...
6082/6082 - 110s - 110s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9615991
{'0': {'precision': 0.5454743449415864, 'recall': 0.22374602854636208, 'f1-score': 0.3173283562451574, 'support': 436553}, '1': {'precision': 0.5726533099250628, 'recall': 0.7629875581682283, 'f1-score': 0.6542587323498386, 'support': 684867}, '2': {'precision': 0.4579161633400539, 'recall': 0.4893151792440696, 'f1-score': 0.473095260830848, 'support': 435384}, 'accuracy': 0.5352388611540052, 'macro avg': {'precision': 0.5253479394022343, 'recall': 0.4920162553195533, 'f1-score': 0.481560783141948, 'support': 1556804}, 'weighted avg': {'precision': 0.5329438946555753, 'recall': 0.5352388611540052, 'f1-score': 0.50911288010161, 'support': 1556804}}
[[ 97677 208203 130673]
 [ 40797 522545 121525]
 [ 40594 181750 213040]]
Evaluating performance on  train set...
2440/2440 - 49s - 49s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0281924
{'0': {'precision': 0.5255317101337696, 'recall': 0.2610612065380037, 'f1-score': 0.34883594655798544, 'support': 209177}, '1': {'precision': 0.47402194739592407, 'recall': 0.6589026037858281, 'f1-score': 0.5513770445966727, 'support': 206507}, '2': {'precision': 0.4562015520466384, 'recall': 0.510193726274874, 'f1-score': 0.4816893769913904, 'support': 208903}, 'accuracy': 0.47592569169707344, 'macro avg': {'precision': 0.48525173652544407, 'recall': 0.47671917886623527, 'f1-score': 0.4606341227153495, 'support': 624587}, 'weighted avg': {'precision': 0.4853124859286865, 'recall': 0.47592569169707344, 'f1-score': 0.46023697589497903, 'support': 624587}}
[[ 54608  77707  76862]
 [ 20255 136068  50184]
 [ 29047  73275 106581]]
Evaluating performance on  val set...
826/826 - 16s - 16s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0131725
{'0': {'precision': 0.5602202859190525, 'recall': 0.2286576447585177, 'f1-score': 0.32476165485874225, 'support': 64953}, '1': {'precision': 0.5048375312131164, 'recall': 0.7512874741609014, 'f1-score': 0.6038859382053228, 'support': 83691}, '2': {'precision': 0.4606823451473998, 'recall': 0.44297225849603467, 'f1-score': 0.45165375809829994, 'support': 62794}, 'accuracy': 0.4991723342067178, 'macro avg': {'precision': 0.5085800540931896, 'recall': 0.4743057924718179, 'f1-score': 0.460100450387455, 'support': 211438}, 'weighted avg': {'precision': 0.5087374702619347, 'recall': 0.4991723342067178, 'f1-score': 0.4729292175881639, 'support': 211438}}
[[14852 32636 17465]
 [ 5716 62876 15099]
 [ 5943 29035 27816]]
training model: results/ATVI/W3/deepVOL_L3/h100
Epoch 1/50
2440/2440 - 106s - loss: 3.2828 - accuracy100: 0.3687 - val_loss: 3.3009 - val_accuracy100: 0.3384 - 106s/epoch - 43ms/step
Epoch 2/50
2440/2440 - 102s - loss: 3.2800 - accuracy100: 0.3610 - val_loss: 3.3010 - val_accuracy100: 0.3389 - 102s/epoch - 42ms/step
Epoch 3/50
2440/2440 - 104s - loss: 3.2752 - accuracy100: 0.3635 - val_loss: 3.3314 - val_accuracy100: 0.3411 - 104s/epoch - 43ms/step
Epoch 4/50
2440/2440 - 102s - loss: 3.2511 - accuracy100: 0.3883 - val_loss: 3.3174 - val_accuracy100: 0.3469 - 102s/epoch - 42ms/step
Epoch 5/50
2440/2440 - 102s - loss: 3.2336 - accuracy100: 0.3989 - val_loss: 3.3073 - val_accuracy100: 0.3543 - 102s/epoch - 42ms/step
Epoch 6/50
2440/2440 - 102s - loss: 3.2153 - accuracy100: 0.4075 - val_loss: 3.2888 - val_accuracy100: 0.3714 - 102s/epoch - 42ms/step
Epoch 7/50
2440/2440 - 107s - loss: 3.2052 - accuracy100: 0.4124 - val_loss: 3.2742 - val_accuracy100: 0.3777 - 107s/epoch - 44ms/step
Epoch 8/50
2440/2440 - 108s - loss: 3.1988 - accuracy100: 0.4159 - val_loss: 3.2624 - val_accuracy100: 0.3875 - 108s/epoch - 44ms/step
Epoch 9/50
2440/2440 - 101s - loss: 3.1946 - accuracy100: 0.4190 - val_loss: 3.2594 - val_accuracy100: 0.3904 - 101s/epoch - 42ms/step
Epoch 10/50
2440/2440 - 105s - loss: 3.1900 - accuracy100: 0.4215 - val_loss: 3.2598 - val_accuracy100: 0.3884 - 105s/epoch - 43ms/step
Epoch 11/50
2440/2440 - 109s - loss: 3.1868 - accuracy100: 0.4237 - val_loss: 3.2653 - val_accuracy100: 0.3889 - 109s/epoch - 45ms/step
Epoch 12/50
2440/2440 - 108s - loss: 3.1835 - accuracy100: 0.4248 - val_loss: 3.2769 - val_accuracy100: 0.3842 - 108s/epoch - 44ms/step
Epoch 13/50
2440/2440 - 102s - loss: 3.1802 - accuracy100: 0.4264 - val_loss: 3.3032 - val_accuracy100: 0.3814 - 102s/epoch - 42ms/step
Epoch 14/50
2440/2440 - 102s - loss: 3.1776 - accuracy100: 0.4282 - val_loss: 3.2960 - val_accuracy100: 0.3844 - 102s/epoch - 42ms/step
Epoch 15/50
2440/2440 - 107s - loss: 3.1742 - accuracy100: 0.4295 - val_loss: 3.3215 - val_accuracy100: 0.3830 - 107s/epoch - 44ms/step
Epoch 16/50
2440/2440 - 103s - loss: 3.1713 - accuracy100: 0.4309 - val_loss: 3.3286 - val_accuracy100: 0.3860 - 103s/epoch - 42ms/step
Epoch 17/50
2440/2440 - 102s - loss: 3.1691 - accuracy100: 0.4314 - val_loss: 3.3430 - val_accuracy100: 0.3858 - 102s/epoch - 42ms/step
Epoch 18/50
2440/2440 - 102s - loss: 3.1661 - accuracy100: 0.4330 - val_loss: 3.3348 - val_accuracy100: 0.3916 - 102s/epoch - 42ms/step
Epoch 19/50
2440/2440 - 102s - loss: 3.1649 - accuracy100: 0.4328 - val_loss: 3.3729 - val_accuracy100: 0.3886 - 102s/epoch - 42ms/step
testing model: results/ATVI/W3/deepVOL_L3/h100
Evaluating performance on  test set...
6082/6082 - 124s - 124s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0708264
{'0': {'precision': 0.43919472986136715, 'recall': 0.1576835224937561, 'f1-score': 0.2320532597459432, 'support': 506096}, '1': {'precision': 0.4393405664365225, 'recall': 0.4365739764189027, 'f1-score': 0.4379529022684219, 'support': 549932}, '2': {'precision': 0.382765811602738, 'recall': 0.6333610236912313, 'f1-score': 0.4771627671865974, 'support': 500776}, 'accuracy': 0.4092107933946727, 'macro avg': {'precision': 0.4204337026335425, 'recall': 0.4092061742012967, 'f1-score': 0.38238964306698753, 'support': 1556804}, 'weighted avg': {'precision': 0.42109479706929126, 'recall': 0.4092107933946727, 'f1-score': 0.383630311776753, 'support': 1556804}}
[[ 79803 165601 260692]
 [ 59078 240086 250768]
 [ 42822 140782 317172]]
Evaluating performance on  train set...
2440/2440 - 49s - 49s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0873055
{'0': {'precision': 0.4163407779322485, 'recall': 0.19910937215998775, 'f1-score': 0.2693877022737495, 'support': 209066}, '1': {'precision': 0.4243209236918067, 'recall': 0.22266671845263525, 'f1-score': 0.29206785878037594, 'support': 205976}, '2': {'precision': 0.36765934561937597, 'recall': 0.7308024529337374, 'f1-score': 0.48920472605704557, 'support': 209545}, 'accuracy': 0.385257778339927, 'macro avg': {'precision': 0.40277368241447703, 'recall': 0.3841928478487868, 'f1-score': 0.35022009570372364, 'support': 624587}, 'weighted avg': {'precision': 0.40264015298963823, 'recall': 0.385257778339927, 'f1-score': 0.3506143787259966, 'support': 624587}}
[[ 41627  33509 133930]
 [ 30662  45864 129450]
 [ 27694  28715 153136]]
Evaluating performance on  val set...
826/826 - 16s - 16s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0864987
{'0': {'precision': 0.4397102809219401, 'recall': 0.20837675963369048, 'f1-score': 0.2827564749252803, 'support': 71961}, '1': {'precision': 0.4060100278180334, 'recall': 0.3379645036051026, 'f1-score': 0.3688754700990518, 'support': 72120}, '2': {'precision': 0.3687458973768787, 'recall': 0.6421752750270945, 'f1-score': 0.46848261670096397, 'support': 67357}, 'accuracy': 0.3907717628808445, 'macro avg': {'precision': 0.40482206870561743, 'recall': 0.39617217942196253, 'f1-score': 0.3733715205750987, 'support': 211438}, 'weighted avg': {'precision': 0.40560851001842013, 'recall': 0.3907717628808445, 'f1-score': 0.3712971235481254, 'support': 211438}}
[[14995 19861 37105]
 [10803 24374 36943]
 [ 8304 15798 43255]]
training model: results/ATVI/W3/deepVOL_L3/h200
Epoch 1/50
2440/2440 - 109s - loss: 3.2906 - accuracy200: 0.3598 - val_loss: 3.3291 - val_accuracy200: 0.3423 - 109s/epoch - 45ms/step
Epoch 2/50
2440/2440 - 111s - loss: 3.2855 - accuracy200: 0.3558 - val_loss: 3.3165 - val_accuracy200: 0.3423 - 111s/epoch - 46ms/step
Epoch 3/50
2440/2440 - 106s - loss: 3.2850 - accuracy200: 0.3570 - val_loss: 3.3351 - val_accuracy200: 0.3423 - 106s/epoch - 43ms/step
Epoch 4/50
2440/2440 - 105s - loss: 3.2803 - accuracy200: 0.3646 - val_loss: 3.3307 - val_accuracy200: 0.3422 - 105s/epoch - 43ms/step
Epoch 5/50
2440/2440 - 106s - loss: 3.2727 - accuracy200: 0.3704 - val_loss: 3.3507 - val_accuracy200: 0.3413 - 106s/epoch - 44ms/step
Epoch 6/50
2440/2440 - 107s - loss: 3.2626 - accuracy200: 0.3799 - val_loss: 3.3340 - val_accuracy200: 0.3422 - 107s/epoch - 44ms/step
Epoch 7/50
2440/2440 - 112s - loss: 3.2502 - accuracy200: 0.3887 - val_loss: 3.3310 - val_accuracy200: 0.3432 - 112s/epoch - 46ms/step
Epoch 8/50
2440/2440 - 110s - loss: 3.2426 - accuracy200: 0.3933 - val_loss: 3.3260 - val_accuracy200: 0.3425 - 110s/epoch - 45ms/step
Epoch 9/50
2440/2440 - 107s - loss: 3.2375 - accuracy200: 0.3963 - val_loss: 3.3273 - val_accuracy200: 0.3454 - 107s/epoch - 44ms/step
Epoch 10/50
2440/2440 - 112s - loss: 3.2330 - accuracy200: 0.3991 - val_loss: 3.3182 - val_accuracy200: 0.3481 - 112s/epoch - 46ms/step
Epoch 11/50
2440/2440 - 111s - loss: 3.2289 - accuracy200: 0.4013 - val_loss: 3.3192 - val_accuracy200: 0.3477 - 111s/epoch - 46ms/step
Epoch 12/50
2440/2440 - 111s - loss: 3.2253 - accuracy200: 0.4037 - val_loss: 3.3182 - val_accuracy200: 0.3497 - 111s/epoch - 46ms/step
testing model: results/ATVI/W3/deepVOL_L3/h200
Evaluating performance on  test set...
6082/6082 - 124s - 124s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1029042
{'0': {'precision': 0.3063063063063063, 'recall': 0.00026648378563730774, 'f1-score': 0.0005325042972313692, 'support': 510350}, '1': {'precision': 0.34914551411030287, 'recall': 0.9960536773471881, 'f1-score': 0.5170500777391098, 'support': 543544}, '2': {'precision': 0.3041958041958042, 'recall': 0.0034598635938835973, 'f1-score': 0.006841908656587303, 'support': 502910}, 'accuracy': 0.34896814242512225, 'macro avg': {'precision': 0.3198825415374711, 'recall': 0.33326000824223634, 'f1-score': 0.1748081635643095, 'support': 1556804}, 'weighted avg': {'precision': 0.32058145060849397, 'recall': 0.34896814242512225, 'f1-score': 0.18290812157805547, 'support': 1556804}}
[[   136 508206   2008]
 [   173 541399   1972]
 [   135 501035   1740]]
Evaluating performance on  train set...
2440/2440 - 50s - 50s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1073811
{'0': {'precision': 0.3643410852713178, 'recall': 0.00022571954106895013, 'f1-score': 0.0004511595761019813, 'support': 208223}, '1': {'precision': 0.329624107504354, 'recall': 0.996139970964813, 'f1-score': 0.49533963728724756, 'support': 205957}, '2': {'precision': 0.3260019550342131, 'recall': 0.003170046623924109, 'f1-score': 0.0062790358338079486, 'support': 210407}, 'accuracy': 0.32961941250778515, 'macro avg': {'precision': 0.3399890492699616, 'recall': 0.3331785790432687, 'f1-score': 0.1673566108990525, 'support': 624587}, 'weighted avg': {'precision': 0.33997774443049167, 'recall': 0.32961941250778515, 'f1-score': 0.16560344767000973, 'support': 624587}}
[[    47 207543    633]
 [    49 205162    746]
 [    33 209707    667]]
Evaluating performance on  val set...
826/826 - 16s - 16s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1058868
{'0': {'precision': 0.40625, 'recall': 0.00018005290785446184, 'f1-score': 0.00035994628493901676, 'support': 72201}, '1': {'precision': 0.34243196189771397, 'recall': 0.9969477667596608, 'f1-score': 0.5097684732368903, 'support': 72406}, '2': {'precision': 0.2859504132231405, 'recall': 0.0025886190540318115, 'f1-score': 0.0051307906756035354, 'support': 66831}, 'accuracy': 0.34228000643214557, 'macro avg': {'precision': 0.3448774583736182, 'recall': 0.3332388129071824, 'f1-score': 0.17175307006581098, 'support': 211438}, 'weighted avg': {'precision': 0.34637168791457346, 'recall': 0.34228000643214557, 'f1-score': 0.1763125853751474, 'support': 211438}}
[[   13 71970   218]
 [    7 72185   214]
 [   12 66646   173]]
training model: results/ATVI/W3/deepVOL_L3/h300
Epoch 1/50
2440/2440 - 106s - loss: 3.2700 - accuracy300: 0.3814 - val_loss: 3.3055 - val_accuracy300: 0.3346 - 106s/epoch - 44ms/step
Epoch 2/50
2440/2440 - 104s - loss: 3.2671 - accuracy300: 0.3779 - val_loss: 3.3159 - val_accuracy300: 0.3337 - 104s/epoch - 43ms/step
Epoch 3/50
2440/2440 - 107s - loss: 3.2761 - accuracy300: 0.3687 - val_loss: 3.3141 - val_accuracy300: 0.3344 - 107s/epoch - 44ms/step
Epoch 4/50
2440/2440 - 104s - loss: 3.2641 - accuracy300: 0.3804 - val_loss: 3.3115 - val_accuracy300: 0.3237 - 104s/epoch - 43ms/step
Epoch 5/50
2440/2440 - 102s - loss: 3.2550 - accuracy300: 0.3862 - val_loss: 3.3199 - val_accuracy300: 0.3250 - 102s/epoch - 42ms/step
Epoch 6/50
2440/2440 - 107s - loss: 3.2405 - accuracy300: 0.3949 - val_loss: 3.3131 - val_accuracy300: 0.3323 - 107s/epoch - 44ms/step
Epoch 7/50
2440/2440 - 104s - loss: 3.2329 - accuracy300: 0.3995 - val_loss: 3.3160 - val_accuracy300: 0.3330 - 104s/epoch - 42ms/step
Epoch 8/50
2440/2440 - 102s - loss: 3.2275 - accuracy300: 0.4020 - val_loss: 3.3270 - val_accuracy300: 0.3346 - 102s/epoch - 42ms/step
Epoch 9/50
2440/2440 - 102s - loss: 3.2227 - accuracy300: 0.4056 - val_loss: 3.3283 - val_accuracy300: 0.3334 - 102s/epoch - 42ms/step
Epoch 10/50
2440/2440 - 103s - loss: 3.2182 - accuracy300: 0.4075 - val_loss: 3.3299 - val_accuracy300: 0.3336 - 103s/epoch - 42ms/step
Epoch 11/50
2440/2440 - 103s - loss: 3.2139 - accuracy300: 0.4107 - val_loss: 3.3277 - val_accuracy300: 0.3351 - 103s/epoch - 42ms/step
testing model: results/ATVI/W3/deepVOL_L3/h300
Evaluating performance on  test set...
6082/6082 - 124s - 124s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103914
{'0': {'precision': 0.36974876796360756, 'recall': 0.019708659392336236, 'f1-score': 0.03742258853813327, 'support': 544380}, '1': {'precision': 0.30750292761053544, 'recall': 0.8438165105327546, 'f1-score': 0.45074553379100435, 'support': 477368}, '2': {'precision': 0.33873166701094815, 'recall': 0.13791266708531444, 'f1-score': 0.19601780313746428, 'support': 535056}, 'accuracy': 0.3130329829573922, 'macro avg': {'precision': 0.33866112086169703, 'recall': 0.33381261233680176, 'f1-score': 0.22806197515553397, 'support': 1556804}, 'weighted avg': {'precision': 0.3400018902031499, 'recall': 0.3130329829573922, 'f1-score': 0.21866856996683737, 'support': 1556804}}
[[ 10729 455626  78025]
 [  8528 402811  66029]
 [  9760 451505  73791]]
Evaluating performance on  train set...
2440/2440 - 51s - 51s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1016358
{'0': {'precision': 0.32602739726027397, 'recall': 0.01772637284486901, 'f1-score': 0.03362455166504878, 'support': 208108}, '1': {'precision': 0.3284439236514018, 'recall': 0.8376356553420431, 'f1-score': 0.4718654647366919, 'support': 206129}, '2': {'precision': 0.3294434675375094, 'recall': 0.13716187306869504, 'f1-score': 0.1936843801186864, 'support': 210350}, 'accuracy': 0.32854029942986324, 'macro avg': {'precision': 0.3279715961497284, 'recall': 0.3308413004185357, 'f1-score': 0.23305813217347568, 'support': 624587}, 'weighted avg': {'precision': 0.327975382971301, 'recall': 0.32854029942986324, 'f1-score': 0.2321601377175401, 'support': 624587}}
[[  3689 175292  29127]
 [  3869 172661  29599]
 [  3757 177741  28852]]
Evaluating performance on  val set...
826/826 - 20s - 20s/epoch - 24ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.10197
{'0': {'precision': 0.34345728072665344, 'recall': 0.016666896238240195, 'f1-score': 0.031791072226163265, 'support': 72599}, '1': {'precision': 0.3344142034061217, 'recall': 0.855032343719104, 'f1-score': 0.4807865654868978, 'support': 70802}, '2': {'precision': 0.315493900624814, 'recall': 0.12468215823742963, 'f1-score': 0.1787305767711351, 'support': 68037}, 'accuracy': 0.3321588361600091, 'macro avg': {'precision': 0.3311217949191964, 'recall': 0.3321271327315913, 'f1-score': 0.23043607149473208, 'support': 211438}, 'weighted avg': {'precision': 0.33143100138028647, 'recall': 0.3321588361600091, 'f1-score': 0.22942395744345048, 'support': 211438}}
[[ 1210 62105  9284]
 [ 1143 60538  9121]
 [ 1170 58384  8483]]
training model: results/ATVI/W3/deepVOL_L3/h500
Epoch 1/50
2440/2440 - 107s - loss: 3.2571 - accuracy500: 0.3959 - val_loss: 3.4935 - val_accuracy500: 0.2943 - 107s/epoch - 44ms/step
Epoch 2/50
2440/2440 - 108s - loss: 3.2703 - accuracy500: 0.3800 - val_loss: 3.4779 - val_accuracy500: 0.2943 - 108s/epoch - 44ms/step
Epoch 3/50
2440/2440 - 108s - loss: 3.2700 - accuracy500: 0.3760 - val_loss: 3.4440 - val_accuracy500: 0.2943 - 108s/epoch - 44ms/step
Epoch 4/50
2440/2440 - 102s - loss: 3.2628 - accuracy500: 0.3800 - val_loss: 3.4768 - val_accuracy500: 0.2943 - 102s/epoch - 42ms/step
Epoch 5/50
2440/2440 - 109s - loss: 3.2620 - accuracy500: 0.3793 - val_loss: 3.4421 - val_accuracy500: 0.2943 - 109s/epoch - 45ms/step
Epoch 6/50
2440/2440 - 109s - loss: 3.2482 - accuracy500: 0.3895 - val_loss: 3.5781 - val_accuracy500: 0.2943 - 109s/epoch - 45ms/step
Epoch 7/50
2440/2440 - 109s - loss: 3.2363 - accuracy500: 0.4013 - val_loss: 3.6799 - val_accuracy500: 0.2942 - 109s/epoch - 45ms/step
Epoch 8/50
2440/2440 - 110s - loss: 3.2245 - accuracy500: 0.4081 - val_loss: 3.6304 - val_accuracy500: 0.2943 - 110s/epoch - 45ms/step
Epoch 9/50
2440/2440 - 105s - loss: 3.2204 - accuracy500: 0.4079 - val_loss: 3.6819 - val_accuracy500: 0.2943 - 105s/epoch - 43ms/step
Epoch 10/50
2440/2440 - 108s - loss: 3.2163 - accuracy500: 0.4104 - val_loss: 3.6988 - val_accuracy500: 0.2944 - 108s/epoch - 44ms/step
Epoch 11/50
2440/2440 - 109s - loss: 3.2077 - accuracy500: 0.4154 - val_loss: 3.6647 - val_accuracy500: 0.2943 - 109s/epoch - 45ms/step
Epoch 12/50
2440/2440 - 108s - loss: 3.2019 - accuracy500: 0.4176 - val_loss: 3.6865 - val_accuracy500: 0.2952 - 108s/epoch - 44ms/step
Epoch 13/50
2440/2440 - 108s - loss: 3.2017 - accuracy500: 0.4174 - val_loss: 3.6275 - val_accuracy500: 0.2951 - 108s/epoch - 44ms/step
Epoch 14/50
2440/2440 - 109s - loss: 3.1973 - accuracy500: 0.4196 - val_loss: 3.6287 - val_accuracy500: 0.2955 - 109s/epoch - 45ms/step
Epoch 15/50
2440/2440 - 110s - loss: 3.1872 - accuracy500: 0.4265 - val_loss: 3.6369 - val_accuracy500: 0.2976 - 110s/epoch - 45ms/step
testing model: results/ATVI/W3/deepVOL_L3/h500
Evaluating performance on  test set...
6082/6082 - 123s - 123s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1665404
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 595974}, '1': {'precision': 0.2449539215944471, 'recall': 1.0, 'f1-score': 0.39351483993998393, 'support': 381345}, '2': {'precision': 1.0, 'recall': 1.7256702071667084e-06, 'f1-score': 3.451334458468367e-06, 'support': 579485}, 'accuracy': 0.24495440659196663, 'macro avg': {'precision': 0.4149846405314824, 'recall': 0.3333339085567357, 'f1-score': 0.13117276375814746, 'support': 1556804}, 'weighted avg': {'precision': 0.4322297175690931, 'recall': 0.24495440659196663, 'f1-score': 0.09639422601269128, 'support': 1556804}}
[[     0 595974      0]
 [     0 381345      0]
 [     0 579484      1]]
Evaluating performance on  train set...
2440/2440 - 58s - 58s/epoch - 24ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1217048
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 207403}, '1': {'precision': 0.3309232035300183, 'recall': 1.0, 'f1-score': 0.49728369398370703, 'support': 206690}, '2': {'precision': 1.0, 'recall': 4.75072923693787e-06, 'f1-score': 9.501413335233617e-06, 'support': 210494}, 'accuracy': 0.3309242747607619, 'macro avg': {'precision': 0.4436410678433394, 'recall': 0.33333491690974565, 'f1-score': 0.16576439846568075, 'support': 624587}, 'weighted avg': {'precision': 0.4465230895577709, 'recall': 0.3309242747607619, 'f1-score': 0.16456565170263068, 'support': 624587}}
[[     0 207403      0]
 [     0 206690      0]
 [     0 210493      1]]
Evaluating performance on  val set...
826/826 - 20s - 20s/epoch - 24ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1485858
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 77662}, '1': {'precision': 0.294265931384141, 'recall': 1.0, 'f1-score': 0.4547225176041541, 'support': 62219}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 71557}, 'accuracy': 0.294265931384141, 'macro avg': {'precision': 0.09808864379471366, 'recall': 0.3333333333333333, 'f1-score': 0.15157417253471803, 'support': 211438}, 'weighted avg': {'precision': 0.08659243837337596, 'recall': 0.294265931384141, 'f1-score': 0.13380934516412785, 'support': 211438}}
[[    0 77662     0]
 [    0 62219     0]
 [    0 71557     0]]
training model: results/ATVI/W3/deepVOL_L3/h1000
Epoch 1/50
2440/2440 - 107s - loss: 3.2731 - accuracy1000: 0.3812 - val_loss: 3.3321 - val_accuracy1000: 0.3481 - 107s/epoch - 44ms/step
Epoch 2/50
2440/2440 - 102s - loss: 3.2829 - accuracy1000: 0.3687 - val_loss: 3.3236 - val_accuracy1000: 0.3446 - 102s/epoch - 42ms/step
Epoch 3/50
2440/2440 - 103s - loss: 3.2745 - accuracy1000: 0.3754 - val_loss: 3.3286 - val_accuracy1000: 0.3367 - 103s/epoch - 42ms/step
Epoch 4/50
2440/2440 - 104s - loss: 3.2785 - accuracy1000: 0.3730 - val_loss: 3.3253 - val_accuracy1000: 0.3442 - 104s/epoch - 43ms/step
Epoch 5/50
2440/2440 - 104s - loss: 3.2771 - accuracy1000: 0.3723 - val_loss: 3.3163 - val_accuracy1000: 0.3469 - 104s/epoch - 43ms/step
Epoch 6/50
2440/2440 - 102s - loss: 3.2557 - accuracy1000: 0.3888 - val_loss: 3.3348 - val_accuracy1000: 0.3305 - 102s/epoch - 42ms/step
Epoch 7/50
2440/2440 - 103s - loss: 3.2492 - accuracy1000: 0.3946 - val_loss: 3.3370 - val_accuracy1000: 0.3425 - 103s/epoch - 42ms/step
Epoch 8/50
2440/2440 - 105s - loss: 3.2445 - accuracy1000: 0.3956 - val_loss: 3.3457 - val_accuracy1000: 0.3304 - 105s/epoch - 43ms/step
Epoch 9/50
2440/2440 - 104s - loss: 3.2314 - accuracy1000: 0.4046 - val_loss: 3.3718 - val_accuracy1000: 0.3353 - 104s/epoch - 43ms/step
Epoch 10/50
2440/2440 - 103s - loss: 3.2081 - accuracy1000: 0.4146 - val_loss: 3.4328 - val_accuracy1000: 0.3479 - 103s/epoch - 42ms/step
Epoch 11/50
2440/2440 - 103s - loss: 3.1880 - accuracy1000: 0.4248 - val_loss: 3.4328 - val_accuracy1000: 0.3469 - 103s/epoch - 42ms/step
Epoch 12/50
2440/2440 - 103s - loss: 3.1772 - accuracy1000: 0.4294 - val_loss: 3.4196 - val_accuracy1000: 0.3477 - 103s/epoch - 42ms/step
Epoch 13/50
2440/2440 - 103s - loss: 3.1704 - accuracy1000: 0.4335 - val_loss: 3.4167 - val_accuracy1000: 0.3460 - 103s/epoch - 42ms/step
Epoch 14/50
2440/2440 - 103s - loss: 3.1644 - accuracy1000: 0.4356 - val_loss: 3.4259 - val_accuracy1000: 0.3444 - 103s/epoch - 42ms/step
Epoch 15/50
2440/2440 - 102s - loss: 3.1606 - accuracy1000: 0.4366 - val_loss: 3.4378 - val_accuracy1000: 0.3434 - 102s/epoch - 42ms/step
testing model: results/ATVI/W3/deepVOL_L3/h1000
Evaluating performance on  test set...
6082/6082 - 121s - 121s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1016815
{'0': {'precision': 0.41897685694403913, 'recall': 0.036808134272287504, 'f1-score': 0.06767119016456444, 'support': 507089}, '1': {'precision': 0.3527577406003397, 'recall': 0.7009485807695318, 'f1-score': 0.4693243888065845, 'support': 549347}, '2': {'precision': 0.32200783031000324, 'recall': 0.2707207495283471, 'f1-score': 0.2941454289222738, 'support': 500368}, 'accuracy': 0.3463435345746799, 'macro avg': {'precision': 0.36458080928479397, 'recall': 0.33615915485672215, 'f1-score': 0.2770470026311409, 'support': 1556804}, 'weighted avg': {'precision': 0.3644436781849394, 'recall': 0.3463435345746799, 'f1-score': 0.28219237691197474, 'support': 1556804}}
[[ 18665 353661 134763]
 [ 13833 385064 150450]
 [ 12051 352857 135460]]
Evaluating performance on  train set...
2440/2440 - 49s - 49s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1036797
{'0': {'precision': 0.3633470530827004, 'recall': 0.04173551100778367, 'f1-score': 0.07487103261344757, 'support': 205173}, '1': {'precision': 0.3276708811958398, 'recall': 0.7256819626163691, 'f1-score': 0.45148185540157765, 'support': 206133}, '2': {'precision': 0.3402189558766539, 'recall': 0.2305081090204941, 'f1-score': 0.27481867602051513, 'support': 213281}, 'accuracy': 0.3319201328237699, 'macro avg': {'precision': 0.34374563005173137, 'recall': 0.33264186088154896, 'f1-score': 0.2670571880118468, 'support': 624587}, 'weighted avg': {'precision': 0.3436751418201268, 'recall': 0.3319201328237699, 'f1-score': 0.26744140642412306, 'support': 624587}}
[[  8563 151213  45397]
 [  6602 149587  49944]
 [  8402 155716  49163]]
Evaluating performance on  val set...
826/826 - 16s - 16s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1035798
{'0': {'precision': 0.4558456677199401, 'recall': 0.03738508960964565, 'f1-score': 0.06910287277356897, 'support': 73318}, '1': {'precision': 0.3502021729427987, 'recall': 0.7141285300949509, 'f1-score': 0.4699467229234455, 'support': 73617}, '2': {'precision': 0.3287165949444906, 'recall': 0.28184735593693316, 'f1-score': 0.3034830438447863, 'support': 64503}, 'accuracy': 0.3475865265467891, 'macro avg': {'precision': 0.3782548118690765, 'recall': 0.34445365854717663, 'f1-score': 0.28084421318060027, 'support': 211438}, 'weighted avg': {'precision': 0.38028042525527606, 'recall': 0.3475865265467891, 'f1-score': 0.28016779909282186, 'support': 211438}}
[[ 2741 53030 17547]
 [ 1466 52572 19579]
 [ 1806 44517 18180]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        34 (peak)  15.55 (ave)

============================================
