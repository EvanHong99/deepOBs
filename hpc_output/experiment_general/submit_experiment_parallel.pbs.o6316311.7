This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/WBA_orderbooks/WBA_orderbooks_2019-02-06.csv
data/WBA_orderbooks/WBA_orderbooks_2019-01-29.csv
data/WBA_orderbooks/WBA_orderbooks_2019-01-16.csv
data/WBA_orderbooks/WBA_orderbooks_2019-01-17.csv
data/WBA_orderbooks/WBA_orderbooks_2019-01-25.csv
data/WBA_orderbooks/WBA_orderbooks_2019-01-23.csv
data/WBA_orderbooks/WBA_orderbooks_2019-01-18.csv
data/WBA_orderbooks/WBA_orderbooks_2019-02-08.csv
data/WBA_orderbooks/WBA_orderbooks_2019-01-22.csv
data/WBA_orderbooks/WBA_orderbooks_2019-02-04.csv
data/WBA_orderbooks/WBA_orderbooks_2019-01-24.csv
data/WBA_orderbooks/WBA_orderbooks_2019-01-15.csv
data/WBA_orderbooks/WBA_orderbooks_2019-01-31.csv
data/WBA_orderbooks/WBA_orderbooks_2019-01-30.csv
training model: results/WBA/W0/deepLOB_L1/h10
Epoch 1/50
1454/1454 - 156s - loss: 3.1382 - accuracy10: 0.4213 - val_loss: 3.1661 - val_accuracy10: 0.3722 - 156s/epoch - 107ms/step
Epoch 2/50
1454/1454 - 106s - loss: 3.0794 - accuracy10: 0.4352 - val_loss: 3.0825 - val_accuracy10: 0.4166 - 106s/epoch - 73ms/step
Epoch 3/50
1454/1454 - 100s - loss: 3.0471 - accuracy10: 0.4472 - val_loss: 3.0530 - val_accuracy10: 0.4398 - 100s/epoch - 69ms/step
Epoch 4/50
1454/1454 - 98s - loss: 3.0217 - accuracy10: 0.4582 - val_loss: 3.0575 - val_accuracy10: 0.4993 - 98s/epoch - 67ms/step
Epoch 5/50
1454/1454 - 99s - loss: 3.0033 - accuracy10: 0.4666 - val_loss: 3.0877 - val_accuracy10: 0.5172 - 99s/epoch - 68ms/step
Epoch 6/50
1454/1454 - 104s - loss: 2.9895 - accuracy10: 0.4726 - val_loss: 3.1020 - val_accuracy10: 0.5347 - 104s/epoch - 72ms/step
Epoch 7/50
1454/1454 - 98s - loss: 2.9780 - accuracy10: 0.4778 - val_loss: 3.1098 - val_accuracy10: 0.5445 - 98s/epoch - 67ms/step
Epoch 8/50
1454/1454 - 105s - loss: 2.9691 - accuracy10: 0.4809 - val_loss: 3.1312 - val_accuracy10: 0.5471 - 105s/epoch - 72ms/step
Epoch 9/50
1454/1454 - 98s - loss: 2.9607 - accuracy10: 0.4836 - val_loss: 3.1369 - val_accuracy10: 0.5499 - 98s/epoch - 67ms/step
Epoch 10/50
1454/1454 - 105s - loss: 2.9534 - accuracy10: 0.4865 - val_loss: 3.1495 - val_accuracy10: 0.5529 - 105s/epoch - 72ms/step
Epoch 11/50
1454/1454 - 104s - loss: 2.9480 - accuracy10: 0.4890 - val_loss: 3.1753 - val_accuracy10: 0.5510 - 104s/epoch - 71ms/step
Epoch 12/50
1454/1454 - 104s - loss: 2.9416 - accuracy10: 0.4916 - val_loss: 3.1573 - val_accuracy10: 0.5487 - 104s/epoch - 71ms/step
Epoch 13/50
1454/1454 - 105s - loss: 2.9362 - accuracy10: 0.4930 - val_loss: 3.2032 - val_accuracy10: 0.5534 - 105s/epoch - 72ms/step
testing model: results/WBA/W0/deepLOB_L1/h10
Evaluating performance on  test set...
5633/5633 - 158s - 158s/epoch - 28ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0393537
{'0': {'precision': 0.2705396825396825, 'recall': 0.6102915326623352, 'f1-score': 0.3748915221294856, 'support': 230403}, '1': {'precision': 0.7903797808762548, 'recall': 0.3358205529217689, 'f1-score': 0.47136511518678476, 'support': 980211}, '2': {'precision': 0.2728799245263614, 'recall': 0.5967044373324107, 'f1-score': 0.3744976772023827, 'support': 231220}, 'accuracy': 0.42151731752753785, 'macro avg': {'precision': 0.4445997959807662, 'recall': 0.5142721743055049, 'f1-score': 0.406918104839551, 'support': 1441834}, 'weighted avg': {'precision': 0.6243211118739538, 'recall': 0.42151731752753785, 'f1-score': 0.44041460751951217, 'support': 1441834}}
[[140613  40581  49209]
 [332608 329175 318428]
 [ 46529  46721 137970]]
Evaluating performance on  train set...
1454/1454 - 43s - 43s/epoch - 30ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0545777
{'0': {'precision': 0.3830309879946028, 'recall': 0.3878528137517079, 'f1-score': 0.3854268207770506, 'support': 85633}, '1': {'precision': 0.631091525657136, 'recall': 0.3650084875275658, 'f1-score': 0.4625113145719071, 'support': 200883}, '2': {'precision': 0.31843165994869915, 'recall': 0.629570338517627, 'f1-score': 0.4229424163091645, 'support': 85579}, 'accuracy': 0.4311130222120695, 'macro avg': {'precision': 0.44418472453347935, 'recall': 0.4608105465989669, 'f1-score': 0.42362685055270743, 'support': 372095}, 'weighted avg': {'precision': 0.5020941280325562, 'recall': 0.4311130222120695, 'f1-score': 0.4356707410582555, 'support': 372095}}
[[33213 22680 29740]
 [41979 73324 85580]
 [11519 20182 53878]]
Evaluating performance on  val set...
557/557 - 17s - 17s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0421164
{'0': {'precision': 0.4012100658984932, 'recall': 0.3356221792392005, 'f1-score': 0.36549702469764256, 'support': 31020}, '1': {'precision': 0.6552853133769878, 'recall': 0.38513538842169714, 'f1-score': 0.48513752803683147, 'support': 80029}, '2': {'precision': 0.30950940569815344, 'recall': 0.6851603851795166, 'f1-score': 0.4263999682501885, 'support': 31362}, 'accuracy': 0.4404224392778648, 'macro avg': {'precision': 0.45533492832454475, 'recall': 0.4686393176134714, 'f1-score': 0.4256781736615542, 'support': 142411}, 'weighted avg': {'precision': 0.5237952024065816, 'recall': 0.4404224392778648, 'f1-score': 0.4461421150166972, 'support': 142411}}
[[10411  8931 11678]
 [12947 30822 36260]
 [ 2591  7283 21488]]
training model: results/WBA/W0/deepLOB_L1/h20
Epoch 1/50
1454/1454 - 112s - loss: 3.1794 - accuracy20: 0.4284 - val_loss: 3.2165 - val_accuracy20: 0.3630 - 112s/epoch - 77ms/step
Epoch 2/50
1454/1454 - 101s - loss: 3.1419 - accuracy20: 0.4340 - val_loss: 3.2057 - val_accuracy20: 0.3565 - 101s/epoch - 70ms/step
Epoch 3/50
1454/1454 - 109s - loss: 3.1141 - accuracy20: 0.4482 - val_loss: 3.1306 - val_accuracy20: 0.4261 - 109s/epoch - 75ms/step
Epoch 4/50
1454/1454 - 108s - loss: 3.0907 - accuracy20: 0.4590 - val_loss: 3.1116 - val_accuracy20: 0.4498 - 108s/epoch - 74ms/step
Epoch 5/50
1454/1454 - 109s - loss: 3.0725 - accuracy20: 0.4678 - val_loss: 3.1279 - val_accuracy20: 0.4616 - 109s/epoch - 75ms/step
Epoch 6/50
1454/1454 - 103s - loss: 3.0596 - accuracy20: 0.4729 - val_loss: 3.1328 - val_accuracy20: 0.4610 - 103s/epoch - 71ms/step
Epoch 7/50
1454/1454 - 107s - loss: 3.0490 - accuracy20: 0.4766 - val_loss: 3.1165 - val_accuracy20: 0.4657 - 107s/epoch - 74ms/step
Epoch 8/50
1454/1454 - 103s - loss: 3.0405 - accuracy20: 0.4795 - val_loss: 3.0879 - val_accuracy20: 0.4703 - 103s/epoch - 71ms/step
Epoch 9/50
1454/1454 - 100s - loss: 3.0323 - accuracy20: 0.4819 - val_loss: 3.1010 - val_accuracy20: 0.4685 - 100s/epoch - 69ms/step
Epoch 10/50
1454/1454 - 105s - loss: 3.0248 - accuracy20: 0.4840 - val_loss: 3.0963 - val_accuracy20: 0.4672 - 105s/epoch - 72ms/step
Epoch 11/50
1454/1454 - 107s - loss: 3.0188 - accuracy20: 0.4861 - val_loss: 3.1201 - val_accuracy20: 0.4674 - 107s/epoch - 74ms/step
Epoch 12/50
1454/1454 - 107s - loss: 3.0123 - accuracy20: 0.4886 - val_loss: 3.1415 - val_accuracy20: 0.4663 - 107s/epoch - 74ms/step
Epoch 13/50
1454/1454 - 106s - loss: 3.0082 - accuracy20: 0.4892 - val_loss: 3.1404 - val_accuracy20: 0.4659 - 106s/epoch - 73ms/step
Epoch 14/50
1454/1454 - 109s - loss: 3.0031 - accuracy20: 0.4909 - val_loss: 3.1524 - val_accuracy20: 0.4596 - 109s/epoch - 75ms/step
Epoch 15/50
1454/1454 - 106s - loss: 2.9973 - accuracy20: 0.4928 - val_loss: 3.1994 - val_accuracy20: 0.4599 - 106s/epoch - 73ms/step
Epoch 16/50
1454/1454 - 104s - loss: 2.9937 - accuracy20: 0.4941 - val_loss: 3.1819 - val_accuracy20: 0.4640 - 104s/epoch - 72ms/step
Epoch 17/50
1454/1454 - 103s - loss: 2.9875 - accuracy20: 0.4969 - val_loss: 3.1876 - val_accuracy20: 0.4640 - 103s/epoch - 71ms/step
Epoch 18/50
1454/1454 - 106s - loss: 2.9841 - accuracy20: 0.4966 - val_loss: 3.1854 - val_accuracy20: 0.4672 - 106s/epoch - 73ms/step
testing model: results/WBA/W0/deepLOB_L1/h20
Evaluating performance on  test set...
5633/5633 - 163s - 163s/epoch - 29ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0401714
{'0': {'precision': 0.3124055197281742, 'recall': 0.6057452487075543, 'f1-score': 0.4122158707502133, 'support': 297498}, '1': {'precision': 0.7318121400998835, 'recall': 0.42125541023154606, 'f1-score': 0.5347125122055378, 'support': 845620}, '2': {'precision': 0.3684559801389113, 'recall': 0.4665300820846557, 'f1-score': 0.41173333648475574, 'support': 298716}, 'accuracy': 0.4687016674596382, 'macro avg': {'precision': 0.47089121332232303, 'recall': 0.497843580341252, 'f1-score': 0.45288723981350226, 'support': 1441834}, 'weighted avg': {'precision': 0.5699953640866638, 'recall': 0.4687016674596382, 'f1-score': 0.4839588517326365, 'support': 1441834}}
[[180208  62659  54631]
 [305162 356222 184236]
 [ 91470  67886 139360]]
Evaluating performance on  train set...
1454/1454 - 43s - 43s/epoch - 30ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0443298
{'0': {'precision': 0.42901312532207053, 'recall': 0.39602473580629216, 'f1-score': 0.41185942516805546, 'support': 107213}, '1': {'precision': 0.5241952897552549, 'recall': 0.4470813117585795, 'f1-score': 0.4825770895668178, 'support': 157468}, '2': {'precision': 0.40444306779136024, 'recall': 0.5227065373228815, 'f1-score': 0.4560321966235781, 'support': 107414}, 'accuracy': 0.45420121205606095, 'macro avg': {'precision': 0.4525504942895619, 'recall': 0.4552708616292511, 'f1-score': 0.45015623711948377, 'support': 372095}, 'weighted avg': {'precision': 0.4622008244563265, 'recall': 0.45420121205606095, 'f1-score': 0.4545381584234548, 'support': 372095}}
[[42459 32988 31766]
 [36156 70401 50911]
 [20354 30914 56146]]
Evaluating performance on  val set...
557/557 - 17s - 17s/epoch - 30ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0246654
{'0': {'precision': 0.4471965871495734, 'recall': 0.2639042309964806, 'f1-score': 0.3319278178968965, 'support': 38927}, '1': {'precision': 0.514520472277843, 'recall': 0.5870424931856497, 'f1-score': 0.5483942185982162, 'support': 63469}, '2': {'precision': 0.4124702279686968, 'recall': 0.48471823066350117, 'f1-score': 0.4456852675237537, 'support': 40015}, 'accuracy': 0.4699636966245585, 'macro avg': {'precision': 0.4580624291320377, 'recall': 0.4452216516152105, 'f1-score': 0.44200243467295547, 'support': 142411}, 'weighted avg': {'precision': 0.46744364954351325, 'recall': 0.4699636966245585, 'f1-score': 0.4603653004855361, 'support': 142411}}
[[10273 18290 10364]
 [ 8946 37259 17264]
 [ 3753 16866 19396]]
training model: results/WBA/W0/deepLOB_L1/h30
Epoch 1/50
1454/1454 - 111s - loss: 3.2075 - accuracy30: 0.4258 - val_loss: 3.2770 - val_accuracy30: 0.3668 - 111s/epoch - 76ms/step
Epoch 2/50
1454/1454 - 106s - loss: 3.1674 - accuracy30: 0.4408 - val_loss: 3.3188 - val_accuracy30: 0.3838 - 106s/epoch - 73ms/step
Epoch 3/50
1454/1454 - 103s - loss: 3.1495 - accuracy30: 0.4464 - val_loss: 3.2566 - val_accuracy30: 0.4061 - 103s/epoch - 71ms/step
Epoch 4/50
1454/1454 - 107s - loss: 3.1244 - accuracy30: 0.4568 - val_loss: 3.3143 - val_accuracy30: 0.4001 - 107s/epoch - 74ms/step
Epoch 5/50
1454/1454 - 82s - loss: 3.1057 - accuracy30: 0.4651 - val_loss: 3.3448 - val_accuracy30: 0.3981 - 82s/epoch - 56ms/step
Epoch 6/50
1454/1454 - 33s - loss: 3.0937 - accuracy30: 0.4682 - val_loss: 3.3564 - val_accuracy30: 0.3962 - 33s/epoch - 23ms/step
Epoch 7/50
1454/1454 - 32s - loss: 3.0851 - accuracy30: 0.4708 - val_loss: 3.3061 - val_accuracy30: 0.4032 - 32s/epoch - 22ms/step
Epoch 8/50
1454/1454 - 32s - loss: 3.0785 - accuracy30: 0.4731 - val_loss: 3.3126 - val_accuracy30: 0.4019 - 32s/epoch - 22ms/step
Epoch 9/50
1454/1454 - 33s - loss: 3.0713 - accuracy30: 0.4749 - val_loss: 3.3691 - val_accuracy30: 0.3976 - 33s/epoch - 22ms/step
Epoch 10/50
1454/1454 - 33s - loss: 3.0649 - accuracy30: 0.4774 - val_loss: 3.3204 - val_accuracy30: 0.4088 - 33s/epoch - 23ms/step
Epoch 11/50
1454/1454 - 33s - loss: 3.0604 - accuracy30: 0.4783 - val_loss: 3.3298 - val_accuracy30: 0.4065 - 33s/epoch - 23ms/step
Epoch 12/50
1454/1454 - 35s - loss: 3.0570 - accuracy30: 0.4797 - val_loss: 3.4209 - val_accuracy30: 0.3989 - 35s/epoch - 24ms/step
Epoch 13/50
1454/1454 - 35s - loss: 3.0523 - accuracy30: 0.4809 - val_loss: 3.5223 - val_accuracy30: 0.3932 - 35s/epoch - 24ms/step
testing model: results/WBA/W0/deepLOB_L1/h30
Evaluating performance on  test set...
5633/5633 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1195426
{'0': {'precision': 0.3020775109792962, 'recall': 0.6197739765902236, 'f1-score': 0.4061820862527956, 'support': 341823}, '1': {'precision': 0.6170539529914529, 'recall': 0.1468797393325695, 'f1-score': 0.2372790326704804, 'support': 754985}, '2': {'precision': 0.33626306610889406, 'recall': 0.5465588100606911, 'f1-score': 0.416363812997611, 'support': 345026}, 'accuracy': 0.3546330576196705, 'macro avg': {'precision': 0.41846484335988104, 'recall': 0.4377375086611614, 'f1-score': 0.35327497730696233, 'support': 1441834}, 'weighted avg': {'precision': 0.4751885587259111, 'recall': 0.3546330576196705, 'f1-score': 0.3201761303265325, 'support': 1441834}}
[[211853  34490  95480]
 [367348 110892 276745]
 [122119  34330 188577]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0869496
{'0': {'precision': 0.44707057732105904, 'recall': 0.25976912359848736, 'f1-score': 0.3286038741351909, 'support': 120584}, '1': {'precision': 0.4164045395007314, 'recall': 0.33436206883315295, 'f1-score': 0.3709005748350011, 'support': 130257}, '2': {'precision': 0.3852266799029564, 'recall': 0.6272617810546456, 'f1-score': 0.47731501674035354, 'support': 121254}, 'accuracy': 0.4056356575605692, 'macro avg': {'precision': 0.4162339322415823, 'recall': 0.40713099116209533, 'f1-score': 0.3922731552368485, 'support': 372095}, 'weighted avg': {'precision': 0.41618253521918447, 'recall': 0.4056356575605692, 'f1-score': 0.3918706802693813, 'support': 372095}}
[[31324 32740 56520]
 [21845 43553 64859]
 [16896 28300 76058]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0851918
{'0': {'precision': 0.47886191930557787, 'recall': 0.13526460371875496, 'f1-score': 0.21094372355679863, 'support': 44047}, '1': {'precision': 0.4155384709629993, 'recall': 0.5151313791008505, 'f1-score': 0.4600061033500611, 'support': 52672}, '2': {'precision': 0.3847973652065004, 'recall': 0.5446467652980829, 'f1-score': 0.4509763058940787, 'support': 45692}, 'accuracy': 0.407110405797305, 'macro avg': {'precision': 0.42639925182502586, 'recall': 0.39834758270589604, 'f1-score': 0.3739753776003128, 'support': 142411}, 'weighted avg': {'precision': 0.4252609314816363, 'recall': 0.407110405797305, 'f1-score': 0.38007519809616513, 'support': 142411}}
[[ 5958 19677 18412]
 [ 4164 27133 21375]
 [ 2320 18486 24886]]
training model: results/WBA/W0/deepLOB_L1/h50
Epoch 1/50
1454/1454 - 36s - loss: 3.2341 - accuracy50: 0.4136 - val_loss: 3.3893 - val_accuracy50: 0.3390 - 36s/epoch - 25ms/step
Epoch 2/50
1454/1454 - 33s - loss: 3.2019 - accuracy50: 0.4287 - val_loss: 3.2493 - val_accuracy50: 0.3993 - 33s/epoch - 23ms/step
Epoch 3/50
1454/1454 - 33s - loss: 3.1846 - accuracy50: 0.4349 - val_loss: 3.2696 - val_accuracy50: 0.3960 - 33s/epoch - 22ms/step
Epoch 4/50
1454/1454 - 32s - loss: 3.1638 - accuracy50: 0.4430 - val_loss: 3.3284 - val_accuracy50: 0.3915 - 32s/epoch - 22ms/step
Epoch 5/50
1454/1454 - 32s - loss: 3.1543 - accuracy50: 0.4466 - val_loss: 3.3850 - val_accuracy50: 0.3644 - 32s/epoch - 22ms/step
Epoch 6/50
1454/1454 - 32s - loss: 3.1464 - accuracy50: 0.4501 - val_loss: 3.3807 - val_accuracy50: 0.3886 - 32s/epoch - 22ms/step
Epoch 7/50
1454/1454 - 32s - loss: 3.1371 - accuracy50: 0.4526 - val_loss: 3.3919 - val_accuracy50: 0.3808 - 32s/epoch - 22ms/step
Epoch 8/50
1454/1454 - 32s - loss: 3.1321 - accuracy50: 0.4543 - val_loss: 3.3905 - val_accuracy50: 0.3768 - 32s/epoch - 22ms/step
Epoch 9/50
1454/1454 - 32s - loss: 3.1279 - accuracy50: 0.4564 - val_loss: 3.3959 - val_accuracy50: 0.3769 - 32s/epoch - 22ms/step
Epoch 10/50
1454/1454 - 33s - loss: 3.1245 - accuracy50: 0.4569 - val_loss: 3.3505 - val_accuracy50: 0.3754 - 33s/epoch - 23ms/step
Epoch 11/50
1454/1454 - 33s - loss: 3.1202 - accuracy50: 0.4583 - val_loss: 3.3771 - val_accuracy50: 0.3754 - 33s/epoch - 23ms/step
Epoch 12/50
1454/1454 - 33s - loss: 3.1162 - accuracy50: 0.4604 - val_loss: 3.3646 - val_accuracy50: 0.3826 - 33s/epoch - 23ms/step
testing model: results/WBA/W0/deepLOB_L1/h50
Evaluating performance on  test set...
5633/5633 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1026735
{'0': {'precision': 0.2805188031515149, 'recall': 0.7313849296362754, 'f1-score': 0.4055073984941001, 'support': 354444}, '1': {'precision': 0.5600600819564552, 'recall': 0.10691621671656833, 'f1-score': 0.17955512127158968, 'support': 718413}, '2': {'precision': 0.33956974046210725, 'recall': 0.3502305021722221, 'f1-score': 0.3448177410618274, 'support': 368977}, 'accuracy': 0.32269456816804154, 'macro avg': {'precision': 0.39338287519002574, 'recall': 0.39617721617502194, 'f1-score': 0.3099600869425057, 'support': 1441834}, 'weighted avg': {'precision': 0.4349155828266675, 'recall': 0.32269456816804154, 'f1-score': 0.2773926910682501, 'support': 1441834}}
[[259235  19057  76152]
 [466421  76810 175182]
 [198471  41279 129227]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0857787
{'0': {'precision': 0.3992166958473899, 'recall': 0.5297755901687121, 'f1-score': 0.45532188766546644, 'support': 123524}, '1': {'precision': 0.3941806203678287, 'recall': 0.04686722313334802, 'f1-score': 0.08377390961926917, 'support': 122559}, '2': {'precision': 0.3874340141114245, 'recall': 0.5952448973113672, 'f1-score': 0.46936617294611627, 'support': 126012}, 'accuracy': 0.39288891277765087, 'macro avg': {'precision': 0.39361044344221435, 'recall': 0.3906292368711424, 'f1-score': 0.3361539900769506, 'support': 372095}, 'weighted avg': {'precision': 0.3935676662565273, 'recall': 0.39288891277765087, 'f1-score': 0.33769923709349253, 'support': 372095}}
[[65440  4008 54076]
 [52297  5744 64518]
 [46184  4820 75008]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0820704
{'0': {'precision': 0.39835728952772076, 'recall': 0.47436905073792685, 'f1-score': 0.4330529756447563, 'support': 45804}, '1': {'precision': 0.5006327512022273, 'recall': 0.0411705936225127, 'f1-score': 0.07608423886912204, 'support': 48044}, '2': {'precision': 0.3922374755708089, 'recall': 0.6777793793628895, 'f1-score': 0.4969089440590584, 'support': 48563}, 'accuracy': 0.39758866941458176, 'macro avg': {'precision': 0.4304091721002523, 'recall': 0.3977730079077763, 'f1-score': 0.3353487195243123, 'support': 142411}, 'weighted avg': {'precision': 0.43077420785215137, 'recall': 0.39758866941458176, 'f1-score': 0.3344007044329481, 'support': 142411}}
[[21728  1004 23072]
 [18137  1978 27929]
 [14679   969 32915]]
training model: results/WBA/W0/deepLOB_L1/h100
Epoch 1/50
1454/1454 - 36s - loss: 3.2680 - accuracy100: 0.3929 - val_loss: 3.4040 - val_accuracy100: 0.3419 - 36s/epoch - 25ms/step
Epoch 2/50
1454/1454 - 34s - loss: 3.2367 - accuracy100: 0.4054 - val_loss: 3.3969 - val_accuracy100: 0.3554 - 34s/epoch - 23ms/step
Epoch 3/50
1454/1454 - 35s - loss: 3.2222 - accuracy100: 0.4136 - val_loss: 3.3533 - val_accuracy100: 0.3382 - 35s/epoch - 24ms/step
Epoch 4/50
1454/1454 - 32s - loss: 3.2148 - accuracy100: 0.4166 - val_loss: 3.3353 - val_accuracy100: 0.3511 - 32s/epoch - 22ms/step
Epoch 5/50
1454/1454 - 31s - loss: 3.2086 - accuracy100: 0.4195 - val_loss: 3.3231 - val_accuracy100: 0.3532 - 31s/epoch - 21ms/step
Epoch 6/50
1454/1454 - 32s - loss: 3.2040 - accuracy100: 0.4225 - val_loss: 3.3199 - val_accuracy100: 0.3555 - 32s/epoch - 22ms/step
Epoch 7/50
1454/1454 - 34s - loss: 3.2004 - accuracy100: 0.4241 - val_loss: 3.3436 - val_accuracy100: 0.3487 - 34s/epoch - 23ms/step
Epoch 8/50
1454/1454 - 33s - loss: 3.1978 - accuracy100: 0.4255 - val_loss: 3.3449 - val_accuracy100: 0.3542 - 33s/epoch - 23ms/step
Epoch 9/50
1454/1454 - 33s - loss: 3.1949 - accuracy100: 0.4260 - val_loss: 3.3446 - val_accuracy100: 0.3564 - 33s/epoch - 23ms/step
Epoch 10/50
1454/1454 - 32s - loss: 3.1913 - accuracy100: 0.4280 - val_loss: 3.3633 - val_accuracy100: 0.3619 - 32s/epoch - 22ms/step
Epoch 11/50
1454/1454 - 33s - loss: 3.1900 - accuracy100: 0.4284 - val_loss: 3.3741 - val_accuracy100: 0.3569 - 33s/epoch - 23ms/step
Epoch 12/50
1454/1454 - 33s - loss: 3.1870 - accuracy100: 0.4289 - val_loss: 3.3804 - val_accuracy100: 0.3618 - 33s/epoch - 23ms/step
Epoch 13/50
1454/1454 - 33s - loss: 3.1852 - accuracy100: 0.4297 - val_loss: 3.3648 - val_accuracy100: 0.3637 - 33s/epoch - 23ms/step
Epoch 14/50
1454/1454 - 33s - loss: 3.1839 - accuracy100: 0.4307 - val_loss: 3.3561 - val_accuracy100: 0.3600 - 33s/epoch - 23ms/step
Epoch 15/50
1454/1454 - 33s - loss: 3.1821 - accuracy100: 0.4317 - val_loss: 3.3488 - val_accuracy100: 0.3557 - 33s/epoch - 23ms/step
Epoch 16/50
1454/1454 - 33s - loss: 3.1799 - accuracy100: 0.4326 - val_loss: 3.3986 - val_accuracy100: 0.3535 - 33s/epoch - 22ms/step
testing model: results/WBA/W0/deepLOB_L1/h100
Evaluating performance on  test set...
5633/5633 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1019748
{'0': {'precision': 0.2662444023157249, 'recall': 0.7378948942793992, 'f1-score': 0.3913010590570639, 'support': 361046}, '1': {'precision': 0.5270701311165371, 'recall': 0.21331029509414023, 'f1-score': 0.30370734077668227, 'support': 700285}, '2': {'precision': 0.323573216718953, 'recall': 0.13417765431547188, 'f1-score': 0.18969399280682459, 'support': 380503}, 'accuracy': 0.3237869269277878, 'macro avg': {'precision': 0.3722959167170717, 'recall': 0.36179428122967044, 'f1-score': 0.29490079754685694, 'support': 1441834}, 'weighted avg': {'precision': 0.4080541608317179, 'recall': 0.3237869269277878, 'f1-score': 0.29555310157000797, 'support': 1441834}}
[[266414  49715  44917]
 [489094 149378  61813]
 [245129  84319  51055]]
Evaluating performance on  train set...
1454/1454 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1075134
{'0': {'precision': 0.34689302442971354, 'recall': 0.37901165478478793, 'f1-score': 0.36224177357466764, 'support': 123297}, '1': {'precision': 0.36748377339466887, 'recall': 0.23732897060858382, 'f1-score': 0.2884018120314138, 'support': 122859}, '2': {'precision': 0.35332232325341534, 'recall': 0.44337337917563263, 'f1-score': 0.39325858523255486, 'support': 125939}, 'accuracy': 0.3540144317983311, 'macro avg': {'precision': 0.3558997070259326, 'recall': 0.35323800152300144, 'f1-score': 0.34796739027954543, 'support': 372095}, 'weighted avg': {'precision': 0.3558677709101651, 'recall': 0.3540144317983311, 'f1-score': 0.34835908879830685, 'support': 372095}}
[[46731 23978 52588]
 [44090 29158 49611]
 [43892 26209 55838]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1072841
{'0': {'precision': 0.36791671840721885, 'recall': 0.36204227933689054, 'f1-score': 0.36495586121946205, 'support': 49102}, '1': {'precision': 0.32271262536659545, 'recall': 0.21139888999573075, 'f1-score': 0.25545635631475616, 'support': 42162}, '2': {'precision': 0.3602912416884797, 'recall': 0.46825815785872094, 'f1-score': 0.4072402037051207, 'support': 51147}, 'accuracy': 0.35559050916010704, 'macro avg': {'precision': 0.3503068618207646, 'recall': 0.3472331090637808, 'f1-score': 0.3425508070797796, 'support': 142411}, 'weighted avg': {'precision': 0.3517949635672689, 'recall': 0.35559050916010704, 'f1-score': 0.347724040217726, 'support': 142411}}
[[17777  8885 22440]
 [13165  8913 20084]
 [17376  9821 23950]]
training model: results/WBA/W0/deepLOB_L1/h200
Epoch 1/50
1454/1454 - 36s - loss: 3.3033 - accuracy200: 0.3640 - val_loss: 3.3598 - val_accuracy200: 0.3362 - 36s/epoch - 25ms/step
Epoch 2/50
1454/1454 - 33s - loss: 3.2789 - accuracy200: 0.3734 - val_loss: 3.3478 - val_accuracy200: 0.3354 - 33s/epoch - 23ms/step
Epoch 3/50
1454/1454 - 34s - loss: 3.2646 - accuracy200: 0.3847 - val_loss: 3.3656 - val_accuracy200: 0.3363 - 34s/epoch - 24ms/step
Epoch 4/50
1454/1454 - 36s - loss: 3.2566 - accuracy200: 0.3904 - val_loss: 3.3975 - val_accuracy200: 0.3424 - 36s/epoch - 25ms/step
Epoch 5/50
1454/1454 - 33s - loss: 3.2495 - accuracy200: 0.3974 - val_loss: 3.4556 - val_accuracy200: 0.3412 - 33s/epoch - 23ms/step
Epoch 6/50
1454/1454 - 33s - loss: 3.2452 - accuracy200: 0.3986 - val_loss: 3.4176 - val_accuracy200: 0.3433 - 33s/epoch - 23ms/step
Epoch 7/50
1454/1454 - 32s - loss: 3.2421 - accuracy200: 0.4002 - val_loss: 3.4617 - val_accuracy200: 0.3422 - 32s/epoch - 22ms/step
Epoch 8/50
1454/1454 - 32s - loss: 3.2385 - accuracy200: 0.4016 - val_loss: 3.5051 - val_accuracy200: 0.3423 - 32s/epoch - 22ms/step
Epoch 9/50
1454/1454 - 32s - loss: 3.2353 - accuracy200: 0.4034 - val_loss: 3.4651 - val_accuracy200: 0.3426 - 32s/epoch - 22ms/step
Epoch 10/50
1454/1454 - 33s - loss: 3.2325 - accuracy200: 0.4045 - val_loss: 3.4813 - val_accuracy200: 0.3424 - 33s/epoch - 23ms/step
Epoch 11/50
1454/1454 - 33s - loss: 3.2301 - accuracy200: 0.4060 - val_loss: 3.4926 - val_accuracy200: 0.3433 - 33s/epoch - 23ms/step
Epoch 12/50
1454/1454 - 34s - loss: 3.2279 - accuracy200: 0.4069 - val_loss: 3.4994 - val_accuracy200: 0.3434 - 34s/epoch - 23ms/step
testing model: results/WBA/W0/deepLOB_L1/h200
Evaluating performance on  test set...
5633/5633 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1011869
{'0': {'precision': 0.2997955825328406, 'recall': 0.6308277739437159, 'f1-score': 0.4064359198620985, 'support': 417312}, '1': {'precision': 0.41046935922572925, 'recall': 0.3228860169796704, 'f1-score': 0.36144772587164514, 'support': 569269}, '2': {'precision': 0.35467147428985485, 'recall': 0.09031461626831674, 'f1-score': 0.1439686263524633, 'support': 455253}, 'accuracy': 0.3385805855597801, 'macro avg': {'precision': 0.3549788053494749, 'recall': 0.34800946906390107, 'f1-score': 0.303950757362069, 'support': 1441834}, 'weighted avg': {'precision': 0.3608189489774105, 'recall': 0.3385805855597801, 'f1-score': 0.3058006130397505, 'support': 1441834}}
[[263252 122700  31360]
 [342009 183809  43451]
 [272844 141293  41116]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1098444
{'0': {'precision': 0.3502720881274246, 'recall': 0.21527207037130466, 'f1-score': 0.2666592748641756, 'support': 122891}, '1': {'precision': 0.3373481041454724, 'recall': 0.5367141114274095, 'f1-score': 0.41429427958852466, 'support': 122950}, '2': {'precision': 0.35699357152054834, 'recall': 0.2854642229157096, 'f1-score': 0.31724696427549726, 'support': 126254}, 'accuracy': 0.3453016030852336, 'macro avg': {'precision': 0.34820458793114845, 'recall': 0.34581680157147465, 'f1-score': 0.3327335062427325, 'support': 372095}, 'weighted avg': {'precision': 0.34828230147007744, 'recall': 0.3453016030852336, 'f1-score': 0.3326064710635218, 'support': 372095}}
[[26455 64193 32243]
 [24288 65989 32673]
 [24784 65429 36041]]
Evaluating performance on  val set...
557/557 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1163847
{'0': {'precision': 0.3673304845601871, 'recall': 0.09650497775894938, 'f1-score': 0.15285256571553185, 'support': 47210}, '1': {'precision': 0.3289765602392206, 'recall': 0.7287548879249557, 'f1-score': 0.453315965414803, 'support': 46799}, '2': {'precision': 0.3502543852988078, 'recall': 0.1905912978802529, 'f1-score': 0.24685576665774686, 'support': 48402}, 'accuracy': 0.3362521153562576, 'macro avg': {'precision': 0.3488538100327385, 'recall': 0.338617054521386, 'f1-score': 0.28434143259602723, 'support': 142411}, 'weighted avg': {'precision': 0.348922899045401, 'recall': 0.3362521153562576, 'f1-score': 0.2835400096245788, 'support': 142411}}
[[ 4556 34133  8521]
 [ 4102 34105  8592]
 [ 3745 35432  9225]]
training model: results/WBA/W0/deepLOB_L1/h300
Epoch 1/50
1454/1454 - 34s - loss: 3.2884 - accuracy300: 0.3790 - val_loss: 3.3281 - val_accuracy300: 0.3515 - 34s/epoch - 23ms/step
Epoch 2/50
1454/1454 - 33s - loss: 3.2608 - accuracy300: 0.3924 - val_loss: 3.3376 - val_accuracy300: 0.3413 - 33s/epoch - 23ms/step
Epoch 3/50
1454/1454 - 34s - loss: 3.2451 - accuracy300: 0.3997 - val_loss: 3.4168 - val_accuracy300: 0.3220 - 34s/epoch - 23ms/step
Epoch 4/50
1454/1454 - 34s - loss: 3.2359 - accuracy300: 0.4054 - val_loss: 3.4343 - val_accuracy300: 0.3301 - 34s/epoch - 23ms/step
Epoch 5/50
1454/1454 - 34s - loss: 3.2281 - accuracy300: 0.4116 - val_loss: 3.4825 - val_accuracy300: 0.3414 - 34s/epoch - 23ms/step
Epoch 6/50
1454/1454 - 34s - loss: 3.2220 - accuracy300: 0.4149 - val_loss: 3.4368 - val_accuracy300: 0.3401 - 34s/epoch - 23ms/step
Epoch 7/50
1454/1454 - 34s - loss: 3.2147 - accuracy300: 0.4187 - val_loss: 3.4863 - val_accuracy300: 0.3366 - 34s/epoch - 23ms/step
Epoch 8/50
1454/1454 - 36s - loss: 3.2107 - accuracy300: 0.4196 - val_loss: 3.4929 - val_accuracy300: 0.3269 - 36s/epoch - 24ms/step
Epoch 9/50
1454/1454 - 34s - loss: 3.2074 - accuracy300: 0.4216 - val_loss: 3.4539 - val_accuracy300: 0.3307 - 34s/epoch - 24ms/step
Epoch 10/50
1454/1454 - 35s - loss: 3.2031 - accuracy300: 0.4239 - val_loss: 3.4909 - val_accuracy300: 0.3254 - 35s/epoch - 24ms/step
Epoch 11/50
1454/1454 - 34s - loss: 3.1989 - accuracy300: 0.4265 - val_loss: 3.4981 - val_accuracy300: 0.3279 - 34s/epoch - 23ms/step
testing model: results/WBA/W0/deepLOB_L1/h300
Evaluating performance on  test set...
5633/5633 - 69s - 69s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1424801
{'0': {'precision': 0.24460736004615052, 'recall': 0.5716356078585572, 'f1-score': 0.3426094495015171, 'support': 356045}, '1': {'precision': 0.5072874173234584, 'recall': 0.03622246762997852, 'f1-score': 0.06761680904724889, 'support': 707213}, '2': {'precision': 0.28616282479491345, 'recall': 0.42275263091162674, 'f1-score': 0.34129905358201507, 'support': 378576}, 'accuracy': 0.26992635768056517, 'macro avg': {'precision': 0.3460192007215075, 'recall': 0.34353690213338745, 'f1-score': 0.250508437376927, 'support': 1441834}, 'weighted avg': {'precision': 0.3843617651787694, 'recall': 0.26992635768056517, 'f1-score': 0.20738274886940147, 'support': 1441834}}
[[203528  11732 140785]
 [423149  25617 258447]
 [205383  13149 160044]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1104002
{'0': {'precision': 0.33006672549657085, 'recall': 0.34621068186616, 'f1-score': 0.33794601106408606, 'support': 123162}, '1': {'precision': 0.33152927199524784, 'recall': 0.04087761130868578, 'f1-score': 0.07278127943200753, 'support': 122879}, '2': {'precision': 0.35105682347052575, 'recall': 0.6342995858917607, 'f1-score': 0.4519688422099873, 'support': 126054}, 'accuracy': 0.3429742404493476, 'macro avg': {'precision': 0.3375509403207815, 'recall': 0.3404626263555355, 'f1-score': 0.28756537756869366, 'support': 372095}, 'weighted avg': {'precision': 0.33766049069422155, 'recall': 0.3429742404493476, 'f1-score': 0.28900651147136713, 'support': 372095}}
[[42640  4976 75546]
 [45600  5023 72256]
 [40946  5152 79956]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1079363
{'0': {'precision': 0.3543574194710456, 'recall': 0.24244166940519224, 'f1-score': 0.28790595007256187, 'support': 48688}, '1': {'precision': 0.32987258140632375, 'recall': 0.03146310174870029, 'f1-score': 0.057446939656058016, 'support': 44433}, '2': {'precision': 0.35346455341305716, 'recall': 0.7519780888618381, 'f1-score': 0.4808889926825471, 'support': 49290}, 'accuracy': 0.35297132946190957, 'macro avg': {'precision': 0.3458981847634755, 'recall': 0.34196095333857696, 'f1-score': 0.2754139608037223, 'support': 142411}, 'weighted avg': {'precision': 0.3464089872731954, 'recall': 0.35297132946190957, 'f1-score': 0.28279503139640383, 'support': 142411}}
[[11804  1436 35448]
 [10686  1398 32349]
 [10821  1404 37065]]
training model: results/WBA/W0/deepLOB_L1/h500
Epoch 1/50
1454/1454 - 36s - loss: 3.2849 - accuracy500: 0.3847 - val_loss: 3.4136 - val_accuracy500: 0.3514 - 36s/epoch - 25ms/step
Epoch 2/50
1454/1454 - 34s - loss: 3.2548 - accuracy500: 0.3964 - val_loss: 3.4420 - val_accuracy500: 0.3548 - 34s/epoch - 23ms/step
Epoch 3/50
1454/1454 - 32s - loss: 3.2359 - accuracy500: 0.4052 - val_loss: 3.4555 - val_accuracy500: 0.3507 - 32s/epoch - 22ms/step
Epoch 4/50
1454/1454 - 33s - loss: 3.2159 - accuracy500: 0.4167 - val_loss: 3.3426 - val_accuracy500: 0.3486 - 33s/epoch - 22ms/step
Epoch 5/50
1454/1454 - 34s - loss: 3.2075 - accuracy500: 0.4212 - val_loss: 3.3576 - val_accuracy500: 0.3271 - 34s/epoch - 23ms/step
Epoch 6/50
1454/1454 - 32s - loss: 3.1983 - accuracy500: 0.4268 - val_loss: 3.3675 - val_accuracy500: 0.3273 - 32s/epoch - 22ms/step
Epoch 7/50
1454/1454 - 32s - loss: 3.1934 - accuracy500: 0.4297 - val_loss: 3.3859 - val_accuracy500: 0.3308 - 32s/epoch - 22ms/step
Epoch 8/50
1454/1454 - 33s - loss: 3.1865 - accuracy500: 0.4335 - val_loss: 3.3816 - val_accuracy500: 0.3425 - 33s/epoch - 23ms/step
Epoch 9/50
1454/1454 - 34s - loss: 3.1789 - accuracy500: 0.4378 - val_loss: 3.4370 - val_accuracy500: 0.3277 - 34s/epoch - 23ms/step
Epoch 10/50
1454/1454 - 32s - loss: 3.1740 - accuracy500: 0.4408 - val_loss: 3.5036 - val_accuracy500: 0.3113 - 32s/epoch - 22ms/step
Epoch 11/50
1454/1454 - 32s - loss: 3.1691 - accuracy500: 0.4414 - val_loss: 3.5353 - val_accuracy500: 0.3189 - 32s/epoch - 22ms/step
Epoch 12/50
1454/1454 - 33s - loss: 3.1629 - accuracy500: 0.4440 - val_loss: 3.6074 - val_accuracy500: 0.3245 - 33s/epoch - 23ms/step
Epoch 13/50
1454/1454 - 33s - loss: 3.1574 - accuracy500: 0.4461 - val_loss: 3.5140 - val_accuracy500: 0.3331 - 33s/epoch - 23ms/step
Epoch 14/50
1454/1454 - 33s - loss: 3.1539 - accuracy500: 0.4475 - val_loss: 3.5853 - val_accuracy500: 0.3133 - 33s/epoch - 23ms/step
testing model: results/WBA/W0/deepLOB_L1/h500
Evaluating performance on  test set...
5633/5633 - 69s - 69s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1530178
{'0': {'precision': 0.24879819671008788, 'recall': 0.750414303264762, 'f1-score': 0.3736977378534177, 'support': 382570}, '1': {'precision': 0.3302530626086219, 'recall': 0.0365374965413421, 'f1-score': 0.06579569638212343, 'support': 639699}, '2': {'precision': 0.3987797577934337, 'recall': 0.20641140228570068, 'f1-score': 0.27202211280988164, 'support': 419565}, 'accuracy': 0.2753867643570619, 'macro avg': {'precision': 0.32594367237071453, 'recall': 0.33112106736393493, 'f1-score': 0.2371718490151409, 'support': 1441834}, 'weighted avg': {'precision': 0.32858103574451225, 'recall': 0.2753867643570619, 'f1-score': 0.20750373656857032, 'support': 1441834}}
[[287086  20891  74593]
 [560352  23373  55974]
 [306453  26509  86603]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1282241
{'0': {'precision': 0.3440850465806832, 'recall': 0.24698589349343486, 'f1-score': 0.2875599083142321, 'support': 122922}, '1': {'precision': 0.3364487801078723, 'recall': 0.14079331193064223, 'f1-score': 0.19851450170321053, 'support': 122726}, '2': {'precision': 0.3448456800743213, 'recall': 0.6340838454055849, 'f1-score': 0.44673506968917764, 'support': 126447}, 'accuracy': 0.34350636262244855, 'macro avg': {'precision': 0.34179316892095896, 'recall': 0.34062101694322067, 'f1-score': 0.3109364932355401, 'support': 372095}, 'weighted avg': {'precision': 0.3418249016828154, 'recall': 0.34350636262244855, 'f1-score': 0.31228218369722166, 'support': 372095}}
[[30360 16826 75736]
 [28857 17279 76590]
 [29017 17252 80178]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1132082
{'0': {'precision': 0.3678573944902417, 'recall': 0.10475311490539917, 'f1-score': 0.16306961926476557, 'support': 49841}, '1': {'precision': 0.3058377294327942, 'recall': 0.16393634175410718, 'f1-score': 0.21345545277507302, 'support': 42791}, '2': {'precision': 0.3552112916860592, 'recall': 0.7512605717270335, 'f1-score': 0.4823552173352251, 'support': 49779}, 'accuracy': 0.3485194261679224, 'macro avg': {'precision': 0.3429688052030317, 'recall': 0.3399833427955133, 'f1-score': 0.28629342979168787, 'support': 142411}, 'weighted avg': {'precision': 0.34480163447898815, 'recall': 0.3485194261679224, 'f1-score': 0.2898138875311844, 'support': 142411}}
[[ 5221  7865 36755]
 [ 4647  7015 31129]
 [ 4325  8057 37397]]
training model: results/WBA/W0/deepLOB_L1/h1000
Epoch 1/50
1454/1454 - 35s - loss: 3.2741 - accuracy1000: 0.3946 - val_loss: 3.4922 - val_accuracy1000: 0.3391 - 35s/epoch - 24ms/step
Epoch 2/50
1454/1454 - 32s - loss: 3.2067 - accuracy1000: 0.4189 - val_loss: 3.5681 - val_accuracy1000: 0.3421 - 32s/epoch - 22ms/step
Epoch 3/50
1454/1454 - 31s - loss: 3.1754 - accuracy1000: 0.4343 - val_loss: 3.4519 - val_accuracy1000: 0.3389 - 31s/epoch - 21ms/step
Epoch 4/50
1454/1454 - 32s - loss: 3.1530 - accuracy1000: 0.4439 - val_loss: 3.6307 - val_accuracy1000: 0.3390 - 32s/epoch - 22ms/step
Epoch 5/50
1454/1454 - 34s - loss: 3.1368 - accuracy1000: 0.4500 - val_loss: 3.6911 - val_accuracy1000: 0.3377 - 34s/epoch - 23ms/step
Epoch 6/50
1454/1454 - 33s - loss: 3.1250 - accuracy1000: 0.4527 - val_loss: 3.6313 - val_accuracy1000: 0.3386 - 33s/epoch - 23ms/step
Epoch 7/50
1454/1454 - 32s - loss: 3.1171 - accuracy1000: 0.4555 - val_loss: 3.7660 - val_accuracy1000: 0.3403 - 32s/epoch - 22ms/step
Epoch 8/50
1454/1454 - 33s - loss: 3.1072 - accuracy1000: 0.4589 - val_loss: 3.8075 - val_accuracy1000: 0.3412 - 33s/epoch - 23ms/step
Epoch 9/50
1454/1454 - 32s - loss: 3.0990 - accuracy1000: 0.4611 - val_loss: 3.8112 - val_accuracy1000: 0.3413 - 32s/epoch - 22ms/step
Epoch 10/50
1454/1454 - 32s - loss: 3.0944 - accuracy1000: 0.4631 - val_loss: 3.9596 - val_accuracy1000: 0.3415 - 32s/epoch - 22ms/step
Epoch 11/50
1454/1454 - 32s - loss: 3.0882 - accuracy1000: 0.4653 - val_loss: 4.0045 - val_accuracy1000: 0.3425 - 32s/epoch - 22ms/step
Epoch 12/50
1454/1454 - 33s - loss: 3.0821 - accuracy1000: 0.4669 - val_loss: 4.0671 - val_accuracy1000: 0.3425 - 33s/epoch - 22ms/step
Epoch 13/50
1454/1454 - 34s - loss: 3.0776 - accuracy1000: 0.4685 - val_loss: 3.9567 - val_accuracy1000: 0.3431 - 34s/epoch - 23ms/step
testing model: results/WBA/W0/deepLOB_L1/h1000
Evaluating performance on  test set...
5633/5633 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2166401
{'0': {'precision': 0.27498429598789426, 'recall': 0.8326988564359045, 'f1-score': 0.4134379191484617, 'support': 398491}, '1': {'precision': 0.37857002649916577, 'recall': 0.05221381640730093, 'f1-score': 0.09177032141024974, 'support': 590993}, '2': {'precision': 0.34817476435973543, 'recall': 0.11824472200729523, 'f1-score': 0.17653562694108987, 'support': 452350}, 'accuracy': 0.28863863662529804, 'macro avg': {'precision': 0.33390969561559847, 'recall': 0.3343857982835002, 'f1-score': 0.2272479558332671, 'support': 1441834}, 'weighted avg': {'precision': 0.3404052459724627, 'recall': 0.28863863662529804, 'f1-score': 0.20726574504929096, 'support': 1441834}}
[[331823  22917  43751]
 [503750  30858  56385]
 [371125  27737  53488]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.168318
{'0': {'precision': 0.34225122877478803, 'recall': 0.3444518694787626, 'f1-score': 0.34334802298897255, 'support': 122708}, '1': {'precision': 0.3406743519690811, 'recall': 0.1665472195980063, 'f1-score': 0.22372221249781202, 'support': 122788}, '2': {'precision': 0.3469480829400223, 'recall': 0.5167813331858861, 'f1-score': 0.41516773540544916, 'support': 126599}, 'accuracy': 0.34437710799661375, 'macro avg': {'precision': 0.3432912212279638, 'recall': 0.34259347408755164, 'f1-score': 0.3274126569640779, 'support': 372095}, 'weighted avg': {'precision': 0.34332889843238984, 'recall': 0.34437710799661375, 'f1-score': 0.32830801910186014, 'support': 372095}}
[[42267 19416 61025]
 [40217 20450 62121]
 [41013 20162 65424]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1509356
{'0': {'precision': 0.35797940797940797, 'recall': 0.22793108393255895, 'f1-score': 0.27852252387568377, 'support': 48813}, '1': {'precision': 0.3238898116518851, 'recall': 0.22329530723360125, 'f1-score': 0.2643459133170488, 'support': 46284}, '2': {'precision': 0.33180982599279796, 'recall': 0.55698102041679, 'f1-score': 0.41587236460042926, 'support': 47314}, 'accuracy': 0.3357465364332811, 'macro avg': {'precision': 0.33789301520803033, 'recall': 0.33606913719431675, 'f1-score': 0.31958026726438726, 'support': 142411}, 'weighted avg': {'precision': 0.3382057214064779, 'recall': 0.3357465364332811, 'f1-score': 0.31954758599135424, 'support': 142411}}
[[11126 10481 27206]
 [10086 10335 25863]
 [ 9868 11093 26353]]
training model: results/WBA/W0/deepOF_L1/h10
Epoch 1/50
1454/1454 - 32s - loss: 3.2305 - accuracy10: 0.4039 - val_loss: 3.1627 - val_accuracy10: 0.3048 - 32s/epoch - 22ms/step
Epoch 2/50
1454/1454 - 31s - loss: 3.1936 - accuracy10: 0.4157 - val_loss: 3.1372 - val_accuracy10: 0.3442 - 31s/epoch - 21ms/step
Epoch 3/50
1454/1454 - 30s - loss: 3.1809 - accuracy10: 0.4241 - val_loss: 3.1229 - val_accuracy10: 0.3649 - 30s/epoch - 21ms/step
Epoch 4/50
1454/1454 - 31s - loss: 3.1709 - accuracy10: 0.4311 - val_loss: 3.1154 - val_accuracy10: 0.3758 - 31s/epoch - 21ms/step
Epoch 5/50
1454/1454 - 32s - loss: 3.1631 - accuracy10: 0.4341 - val_loss: 3.1109 - val_accuracy10: 0.3759 - 32s/epoch - 22ms/step
Epoch 6/50
1454/1454 - 32s - loss: 3.1560 - accuracy10: 0.4376 - val_loss: 3.1050 - val_accuracy10: 0.3872 - 32s/epoch - 22ms/step
Epoch 7/50
1454/1454 - 31s - loss: 3.1489 - accuracy10: 0.4402 - val_loss: 3.1034 - val_accuracy10: 0.3831 - 31s/epoch - 21ms/step
Epoch 8/50
1454/1454 - 32s - loss: 3.1437 - accuracy10: 0.4415 - val_loss: 3.0988 - val_accuracy10: 0.3871 - 32s/epoch - 22ms/step
Epoch 9/50
1454/1454 - 32s - loss: 3.1379 - accuracy10: 0.4435 - val_loss: 3.0966 - val_accuracy10: 0.3820 - 32s/epoch - 22ms/step
Epoch 10/50
1454/1454 - 32s - loss: 3.1323 - accuracy10: 0.4448 - val_loss: 3.0949 - val_accuracy10: 0.3895 - 32s/epoch - 22ms/step
Epoch 11/50
1454/1454 - 31s - loss: 3.1279 - accuracy10: 0.4464 - val_loss: 3.0923 - val_accuracy10: 0.3940 - 31s/epoch - 21ms/step
Epoch 12/50
1454/1454 - 32s - loss: 3.1223 - accuracy10: 0.4467 - val_loss: 3.0927 - val_accuracy10: 0.3868 - 32s/epoch - 22ms/step
Epoch 13/50
1454/1454 - 32s - loss: 3.1183 - accuracy10: 0.4473 - val_loss: 3.0879 - val_accuracy10: 0.3930 - 32s/epoch - 22ms/step
Epoch 14/50
1454/1454 - 29s - loss: 3.1147 - accuracy10: 0.4488 - val_loss: 3.0866 - val_accuracy10: 0.3966 - 29s/epoch - 20ms/step
Epoch 15/50
1454/1454 - 29s - loss: 3.1101 - accuracy10: 0.4503 - val_loss: 3.0805 - val_accuracy10: 0.3924 - 29s/epoch - 20ms/step
Epoch 16/50
1454/1454 - 31s - loss: 3.1057 - accuracy10: 0.4508 - val_loss: 3.0799 - val_accuracy10: 0.4001 - 31s/epoch - 21ms/step
Epoch 17/50
1454/1454 - 31s - loss: 3.1019 - accuracy10: 0.4522 - val_loss: 3.0761 - val_accuracy10: 0.4055 - 31s/epoch - 21ms/step
Epoch 18/50
1454/1454 - 31s - loss: 3.0989 - accuracy10: 0.4534 - val_loss: 3.0776 - val_accuracy10: 0.4047 - 31s/epoch - 21ms/step
Epoch 19/50
1454/1454 - 32s - loss: 3.0955 - accuracy10: 0.4542 - val_loss: 3.0762 - val_accuracy10: 0.4053 - 32s/epoch - 22ms/step
Epoch 20/50
1454/1454 - 31s - loss: 3.0909 - accuracy10: 0.4543 - val_loss: 3.0722 - val_accuracy10: 0.4060 - 31s/epoch - 21ms/step
Epoch 21/50
1454/1454 - 31s - loss: 3.0865 - accuracy10: 0.4563 - val_loss: 3.0739 - val_accuracy10: 0.4037 - 31s/epoch - 21ms/step
Epoch 22/50
1454/1454 - 30s - loss: 3.0838 - accuracy10: 0.4570 - val_loss: 3.0720 - val_accuracy10: 0.4038 - 30s/epoch - 21ms/step
Epoch 23/50
1454/1454 - 31s - loss: 3.0801 - accuracy10: 0.4586 - val_loss: 3.0705 - val_accuracy10: 0.4045 - 31s/epoch - 21ms/step
Epoch 24/50
1454/1454 - 31s - loss: 3.0773 - accuracy10: 0.4581 - val_loss: 3.0679 - val_accuracy10: 0.4095 - 31s/epoch - 22ms/step
Epoch 25/50
1454/1454 - 32s - loss: 3.0730 - accuracy10: 0.4607 - val_loss: 3.0651 - val_accuracy10: 0.4122 - 32s/epoch - 22ms/step
Epoch 26/50
1454/1454 - 31s - loss: 3.0697 - accuracy10: 0.4619 - val_loss: 3.0655 - val_accuracy10: 0.4068 - 31s/epoch - 21ms/step
Epoch 27/50
1454/1454 - 31s - loss: 3.0674 - accuracy10: 0.4620 - val_loss: 3.0650 - val_accuracy10: 0.4111 - 31s/epoch - 21ms/step
Epoch 28/50
1454/1454 - 31s - loss: 3.0622 - accuracy10: 0.4634 - val_loss: 3.0645 - val_accuracy10: 0.4061 - 31s/epoch - 22ms/step
Epoch 29/50
1454/1454 - 31s - loss: 3.0593 - accuracy10: 0.4637 - val_loss: 3.0667 - val_accuracy10: 0.4073 - 31s/epoch - 21ms/step
Epoch 30/50
1454/1454 - 31s - loss: 3.0559 - accuracy10: 0.4650 - val_loss: 3.0663 - val_accuracy10: 0.4024 - 31s/epoch - 21ms/step
Epoch 31/50
1454/1454 - 30s - loss: 3.0526 - accuracy10: 0.4660 - val_loss: 3.0669 - val_accuracy10: 0.4031 - 30s/epoch - 21ms/step
Epoch 32/50
1454/1454 - 31s - loss: 3.0498 - accuracy10: 0.4656 - val_loss: 3.0604 - val_accuracy10: 0.4105 - 31s/epoch - 21ms/step
Epoch 33/50
1454/1454 - 31s - loss: 3.0467 - accuracy10: 0.4679 - val_loss: 3.0592 - val_accuracy10: 0.4059 - 31s/epoch - 21ms/step
Epoch 34/50
1454/1454 - 32s - loss: 3.0438 - accuracy10: 0.4684 - val_loss: 3.0594 - val_accuracy10: 0.4091 - 32s/epoch - 22ms/step
Epoch 35/50
1454/1454 - 31s - loss: 3.0411 - accuracy10: 0.4694 - val_loss: 3.0627 - val_accuracy10: 0.4075 - 31s/epoch - 22ms/step
Epoch 36/50
1454/1454 - 32s - loss: 3.0376 - accuracy10: 0.4692 - val_loss: 3.0557 - val_accuracy10: 0.4164 - 32s/epoch - 22ms/step
Epoch 37/50
1454/1454 - 31s - loss: 3.0347 - accuracy10: 0.4710 - val_loss: 3.0605 - val_accuracy10: 0.4160 - 31s/epoch - 21ms/step
Epoch 38/50
1454/1454 - 32s - loss: 3.0307 - accuracy10: 0.4722 - val_loss: 3.0606 - val_accuracy10: 0.4195 - 32s/epoch - 22ms/step
Epoch 39/50
1454/1454 - 32s - loss: 3.0279 - accuracy10: 0.4724 - val_loss: 3.0574 - val_accuracy10: 0.4225 - 32s/epoch - 22ms/step
Epoch 40/50
1454/1454 - 31s - loss: 3.0241 - accuracy10: 0.4728 - val_loss: 3.0588 - val_accuracy10: 0.4131 - 31s/epoch - 22ms/step
Epoch 41/50
1454/1454 - 29s - loss: 3.0206 - accuracy10: 0.4738 - val_loss: 3.0587 - val_accuracy10: 0.4182 - 29s/epoch - 20ms/step
Epoch 42/50
1454/1454 - 29s - loss: 3.0196 - accuracy10: 0.4749 - val_loss: 3.0596 - val_accuracy10: 0.4237 - 29s/epoch - 20ms/step
Epoch 43/50
1454/1454 - 30s - loss: 3.0153 - accuracy10: 0.4758 - val_loss: 3.0592 - val_accuracy10: 0.4213 - 30s/epoch - 20ms/step
Epoch 44/50
1454/1454 - 31s - loss: 3.0142 - accuracy10: 0.4755 - val_loss: 3.0613 - val_accuracy10: 0.4228 - 31s/epoch - 22ms/step
Epoch 45/50
1454/1454 - 31s - loss: 3.0112 - accuracy10: 0.4760 - val_loss: 3.0588 - val_accuracy10: 0.4195 - 31s/epoch - 21ms/step
Epoch 46/50
1454/1454 - 32s - loss: 3.0056 - accuracy10: 0.4780 - val_loss: 3.0607 - val_accuracy10: 0.4226 - 32s/epoch - 22ms/step
testing model: results/WBA/W0/deepOF_L1/h10
Evaluating performance on  test set...
5633/5633 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0518001
{'0': {'precision': 0.25424118718936467, 'recall': 0.5468311907014696, 'f1-score': 0.3471022468211014, 'support': 230402}, '1': {'precision': 0.8003248929330107, 'recall': 0.3593709511227186, 'f1-score': 0.49601543276152793, 'support': 980210}, '2': {'precision': 0.2532289326591942, 'recall': 0.5543104529511238, 'f1-score': 0.3476423487544484, 'support': 231217}, 'accuracy': 0.42058801702559734, 'macro avg': {'precision': 0.4359316709271899, 'recall': 0.4868375315917706, 'f1-score': 0.3969200094456926, 'support': 1441829}, 'weighted avg': {'precision': 0.6253272582499945, 'recall': 0.42058801702559734, 'f1-score': 0.4484256872147876, 'support': 1441829}}
[[125991  44414  59997]
 [309987 352259 317964]
 [ 59579  43472 128166]]
Evaluating performance on  train set...
1454/1454 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0467763
{'0': {'precision': 0.3392965077233042, 'recall': 0.4722163804182732, 'f1-score': 0.3948707928288799, 'support': 85590}, '1': {'precision': 0.6621881979846891, 'recall': 0.3863343595660975, 'f1-score': 0.4879743435910806, 'support': 201059}, '2': {'precision': 0.32493311024463595, 'recall': 0.5159402649688685, 'f1-score': 0.39874273568052826, 'support': 85444}, 'accuracy': 0.43585071474066966, 'macro avg': {'precision': 0.4421392719842098, 'recall': 0.45816366831774635, 'f1-score': 0.4271959573668296, 'support': 372093}, 'weighted avg': {'precision': 0.5104714941328751, 'recall': 0.43585071474066966, 'f1-score': 0.44606805022881363, 'support': 372093}}
[[40417 19994 25179]
 [56975 77676 66408]
 [21728 19632 44084]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0595481
{'0': {'precision': 0.32908691012826374, 'recall': 0.48884000776347286, 'f1-score': 0.3933623999479404, 'support': 30914}, '1': {'precision': 0.6777683767915289, 'recall': 0.33002908900235955, 'f1-score': 0.44390522409363403, 'support': 80099}, '2': {'precision': 0.30918832411369723, 'recall': 0.5661050418829825, 'f1-score': 0.39994149612411817, 'support': 31397}, 'accuracy': 0.41655080401657185, 'macro avg': {'precision': 0.43868120367783, 'recall': 0.4616580462162716, 'f1-score': 0.4124030400552308, 'support': 142410}, 'weighted avg': {'precision': 0.5208169915351981, 'recall': 0.41655080401657185, 'f1-score': 0.4232408744503586, 'support': 142410}}
[[15112  6550  9252]
 [23204 26435 30460]
 [ 7605  6018 17774]]
training model: results/WBA/W0/deepOF_L1/h20
Epoch 1/50
1454/1454 - 33s - loss: 3.2572 - accuracy20: 0.3989 - val_loss: 3.2420 - val_accuracy20: 0.3372 - 33s/epoch - 22ms/step
Epoch 2/50
1454/1454 - 31s - loss: 3.2277 - accuracy20: 0.4074 - val_loss: 3.2105 - val_accuracy20: 0.3511 - 31s/epoch - 21ms/step
Epoch 3/50
1454/1454 - 31s - loss: 3.2148 - accuracy20: 0.4155 - val_loss: 3.1946 - val_accuracy20: 0.3725 - 31s/epoch - 21ms/step
Epoch 4/50
1454/1454 - 31s - loss: 3.2063 - accuracy20: 0.4208 - val_loss: 3.1904 - val_accuracy20: 0.3733 - 31s/epoch - 21ms/step
Epoch 5/50
1454/1454 - 31s - loss: 3.1989 - accuracy20: 0.4243 - val_loss: 3.1839 - val_accuracy20: 0.3736 - 31s/epoch - 21ms/step
Epoch 6/50
1454/1454 - 31s - loss: 3.1914 - accuracy20: 0.4278 - val_loss: 3.1787 - val_accuracy20: 0.3891 - 31s/epoch - 21ms/step
Epoch 7/50
1454/1454 - 31s - loss: 3.1838 - accuracy20: 0.4308 - val_loss: 3.1760 - val_accuracy20: 0.3915 - 31s/epoch - 21ms/step
Epoch 8/50
1454/1454 - 32s - loss: 3.1792 - accuracy20: 0.4327 - val_loss: 3.1736 - val_accuracy20: 0.3849 - 32s/epoch - 22ms/step
Epoch 9/50
1454/1454 - 31s - loss: 3.1740 - accuracy20: 0.4348 - val_loss: 3.1709 - val_accuracy20: 0.3876 - 31s/epoch - 21ms/step
Epoch 10/50
1454/1454 - 31s - loss: 3.1681 - accuracy20: 0.4364 - val_loss: 3.1673 - val_accuracy20: 0.3935 - 31s/epoch - 21ms/step
Epoch 11/50
1454/1454 - 32s - loss: 3.1628 - accuracy20: 0.4382 - val_loss: 3.1667 - val_accuracy20: 0.3875 - 32s/epoch - 22ms/step
Epoch 12/50
1454/1454 - 31s - loss: 3.1578 - accuracy20: 0.4399 - val_loss: 3.1625 - val_accuracy20: 0.3961 - 31s/epoch - 22ms/step
Epoch 13/50
1454/1454 - 31s - loss: 3.1531 - accuracy20: 0.4416 - val_loss: 3.1608 - val_accuracy20: 0.3953 - 31s/epoch - 22ms/step
Epoch 14/50
1454/1454 - 32s - loss: 3.1496 - accuracy20: 0.4427 - val_loss: 3.1630 - val_accuracy20: 0.3945 - 32s/epoch - 22ms/step
Epoch 15/50
1454/1454 - 32s - loss: 3.1456 - accuracy20: 0.4445 - val_loss: 3.1600 - val_accuracy20: 0.3941 - 32s/epoch - 22ms/step
Epoch 16/50
1454/1454 - 28s - loss: 3.1408 - accuracy20: 0.4467 - val_loss: 3.1552 - val_accuracy20: 0.3996 - 28s/epoch - 19ms/step
Epoch 17/50
1454/1454 - 30s - loss: 3.1369 - accuracy20: 0.4477 - val_loss: 3.1543 - val_accuracy20: 0.3988 - 30s/epoch - 21ms/step
Epoch 18/50
1454/1454 - 31s - loss: 3.1329 - accuracy20: 0.4487 - val_loss: 3.1550 - val_accuracy20: 0.3994 - 31s/epoch - 21ms/step
Epoch 19/50
1454/1454 - 30s - loss: 3.1300 - accuracy20: 0.4498 - val_loss: 3.1498 - val_accuracy20: 0.4031 - 30s/epoch - 21ms/step
Epoch 20/50
1454/1454 - 31s - loss: 3.1259 - accuracy20: 0.4510 - val_loss: 3.1476 - val_accuracy20: 0.4074 - 31s/epoch - 22ms/step
Epoch 21/50
1454/1454 - 31s - loss: 3.1222 - accuracy20: 0.4522 - val_loss: 3.1465 - val_accuracy20: 0.4067 - 31s/epoch - 21ms/step
Epoch 22/50
1454/1454 - 31s - loss: 3.1187 - accuracy20: 0.4539 - val_loss: 3.1415 - val_accuracy20: 0.4120 - 31s/epoch - 21ms/step
Epoch 23/50
1454/1454 - 30s - loss: 3.1157 - accuracy20: 0.4554 - val_loss: 3.1428 - val_accuracy20: 0.4113 - 30s/epoch - 20ms/step
Epoch 24/50
1454/1454 - 31s - loss: 3.1121 - accuracy20: 0.4563 - val_loss: 3.1398 - val_accuracy20: 0.4126 - 31s/epoch - 21ms/step
Epoch 25/50
1454/1454 - 30s - loss: 3.1090 - accuracy20: 0.4570 - val_loss: 3.1383 - val_accuracy20: 0.4147 - 30s/epoch - 21ms/step
Epoch 26/50
1454/1454 - 31s - loss: 3.1050 - accuracy20: 0.4589 - val_loss: 3.1398 - val_accuracy20: 0.4126 - 31s/epoch - 21ms/step
Epoch 27/50
1454/1454 - 31s - loss: 3.1030 - accuracy20: 0.4599 - val_loss: 3.1351 - val_accuracy20: 0.4185 - 31s/epoch - 21ms/step
Epoch 28/50
1454/1454 - 31s - loss: 3.0990 - accuracy20: 0.4614 - val_loss: 3.1342 - val_accuracy20: 0.4158 - 31s/epoch - 21ms/step
Epoch 29/50
1454/1454 - 31s - loss: 3.0964 - accuracy20: 0.4618 - val_loss: 3.1361 - val_accuracy20: 0.4183 - 31s/epoch - 21ms/step
Epoch 30/50
1454/1454 - 30s - loss: 3.0926 - accuracy20: 0.4634 - val_loss: 3.1386 - val_accuracy20: 0.4151 - 30s/epoch - 21ms/step
Epoch 31/50
1454/1454 - 31s - loss: 3.0913 - accuracy20: 0.4637 - val_loss: 3.1359 - val_accuracy20: 0.4179 - 31s/epoch - 21ms/step
Epoch 32/50
1454/1454 - 31s - loss: 3.0867 - accuracy20: 0.4649 - val_loss: 3.1364 - val_accuracy20: 0.4193 - 31s/epoch - 21ms/step
Epoch 33/50
1454/1454 - 30s - loss: 3.0841 - accuracy20: 0.4663 - val_loss: 3.1353 - val_accuracy20: 0.4173 - 30s/epoch - 21ms/step
Epoch 34/50
1454/1454 - 30s - loss: 3.0806 - accuracy20: 0.4671 - val_loss: 3.1314 - val_accuracy20: 0.4236 - 30s/epoch - 20ms/step
Epoch 35/50
1454/1454 - 30s - loss: 3.0786 - accuracy20: 0.4683 - val_loss: 3.1314 - val_accuracy20: 0.4211 - 30s/epoch - 21ms/step
Epoch 36/50
1454/1454 - 30s - loss: 3.0754 - accuracy20: 0.4701 - val_loss: 3.1330 - val_accuracy20: 0.4236 - 30s/epoch - 21ms/step
Epoch 37/50
1454/1454 - 31s - loss: 3.0723 - accuracy20: 0.4708 - val_loss: 3.1320 - val_accuracy20: 0.4222 - 31s/epoch - 21ms/step
Epoch 38/50
1454/1454 - 30s - loss: 3.0686 - accuracy20: 0.4714 - val_loss: 3.1331 - val_accuracy20: 0.4214 - 30s/epoch - 21ms/step
Epoch 39/50
1454/1454 - 30s - loss: 3.0660 - accuracy20: 0.4725 - val_loss: 3.1337 - val_accuracy20: 0.4223 - 30s/epoch - 21ms/step
Epoch 40/50
1454/1454 - 30s - loss: 3.0649 - accuracy20: 0.4727 - val_loss: 3.1348 - val_accuracy20: 0.4249 - 30s/epoch - 21ms/step
Epoch 41/50
1454/1454 - 31s - loss: 3.0622 - accuracy20: 0.4737 - val_loss: 3.1326 - val_accuracy20: 0.4255 - 31s/epoch - 21ms/step
Epoch 42/50
1454/1454 - 30s - loss: 3.0594 - accuracy20: 0.4750 - val_loss: 3.1351 - val_accuracy20: 0.4216 - 30s/epoch - 21ms/step
Epoch 43/50
1454/1454 - 30s - loss: 3.0569 - accuracy20: 0.4757 - val_loss: 3.1314 - val_accuracy20: 0.4264 - 30s/epoch - 21ms/step
Epoch 44/50
1454/1454 - 31s - loss: 3.0526 - accuracy20: 0.4770 - val_loss: 3.1374 - val_accuracy20: 0.4208 - 31s/epoch - 21ms/step
Epoch 45/50
1454/1454 - 30s - loss: 3.0509 - accuracy20: 0.4772 - val_loss: 3.1375 - val_accuracy20: 0.4178 - 30s/epoch - 20ms/step
testing model: results/WBA/W0/deepOF_L1/h20
Evaluating performance on  test set...
5633/5633 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0614095
{'0': {'precision': 0.31074096319293465, 'recall': 0.4938957162449243, 'f1-score': 0.38147311576706383, 'support': 297496}, '1': {'precision': 0.7244638285280534, 'recall': 0.33295372975299753, 'f1-score': 0.45623024110110244, 'support': 845619}, '2': {'precision': 0.29543034375807703, 'recall': 0.5739704198664943, 'f1-score': 0.3900808132286159, 'support': 298714}, 'accuracy': 0.41609441896369126, 'macro avg': {'precision': 0.44354504515968834, 'recall': 0.46693995528813875, 'f1-score': 0.40926139003226075, 'support': 1441829}, 'weighted avg': {'precision': 0.5502134798977267, 'recall': 0.41609441896369126, 'f1-score': 0.4271007770967877, 'support': 1441829}}
[[146932  56407  94157]
 [249327 281552 314740]
 [ 76585  50676 171453]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0590397
{'0': {'precision': 0.39608250706137743, 'recall': 0.4412171120198682, 'f1-score': 0.4174333199362239, 'support': 107106}, '1': {'precision': 0.5467987478855988, 'recall': 0.3565781882960042, 'f1-score': 0.43166146726680404, 'support': 157741}, '2': {'precision': 0.3742962725793111, 'recall': 0.5232176491430915, 'f1-score': 0.43640195674322024, 'support': 107246}, 'accuracy': 0.42897071431066963, 'macro avg': {'precision': 0.4390591758420958, 'recall': 0.4403376498196547, 'f1-score': 0.4284989146487494, 'support': 372093}, 'weighted avg': {'precision': 0.45369617902131704, 'recall': 0.42897071431066963, 'f1-score': 0.42893225329717444, 'support': 372093}}
[[47257 23514 36335]
 [44026 56247 57468]
 [28028 23105 56113]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0640547
{'0': {'precision': 0.3863920368854225, 'recall': 0.46104012956631274, 'f1-score': 0.4204283051820942, 'support': 38899}, '1': {'precision': 0.5675976644796243, 'recall': 0.2971559127077917, 'f1-score': 0.3900880123279313, 'support': 63465}, '2': {'precision': 0.3700971801816154, 'recall': 0.5801078759426659, 'f1-score': 0.45189464674758795, 'support': 40046}, 'accuracy': 0.42148725510848956, 'macro avg': {'precision': 0.4413622938488874, 'recall': 0.4461013060722568, 'f1-score': 0.4208036547525378, 'support': 142410}, 'weighted avg': {'precision': 0.46256415488068525, 'recall': 0.42148725510848956, 'f1-score': 0.4157555604896029, 'support': 142410}}
[[17934  7514 13451]
 [18518 18859 26088]
 [ 9962  6853 23231]]
training model: results/WBA/W0/deepOF_L1/h30
Epoch 1/50
1454/1454 - 32s - loss: 3.2698 - accuracy30: 0.3951 - val_loss: 3.2843 - val_accuracy30: 0.3731 - 32s/epoch - 22ms/step
Epoch 2/50
1454/1454 - 31s - loss: 3.2462 - accuracy30: 0.4030 - val_loss: 3.2520 - val_accuracy30: 0.3798 - 31s/epoch - 21ms/step
Epoch 3/50
1454/1454 - 31s - loss: 3.2378 - accuracy30: 0.4063 - val_loss: 3.2423 - val_accuracy30: 0.3871 - 31s/epoch - 21ms/step
Epoch 4/50
1454/1454 - 30s - loss: 3.2300 - accuracy30: 0.4101 - val_loss: 3.2345 - val_accuracy30: 0.3927 - 30s/epoch - 21ms/step
Epoch 5/50
1454/1454 - 30s - loss: 3.2227 - accuracy30: 0.4142 - val_loss: 3.2323 - val_accuracy30: 0.3914 - 30s/epoch - 21ms/step
Epoch 6/50
1454/1454 - 31s - loss: 3.2160 - accuracy30: 0.4168 - val_loss: 3.2267 - val_accuracy30: 0.3928 - 31s/epoch - 21ms/step
Epoch 7/50
1454/1454 - 30s - loss: 3.2099 - accuracy30: 0.4198 - val_loss: 3.2246 - val_accuracy30: 0.3955 - 30s/epoch - 21ms/step
Epoch 8/50
1454/1454 - 31s - loss: 3.2040 - accuracy30: 0.4226 - val_loss: 3.2216 - val_accuracy30: 0.3999 - 31s/epoch - 22ms/step
Epoch 9/50
1454/1454 - 31s - loss: 3.1981 - accuracy30: 0.4251 - val_loss: 3.2225 - val_accuracy30: 0.3987 - 31s/epoch - 21ms/step
Epoch 10/50
1454/1454 - 32s - loss: 3.1928 - accuracy30: 0.4277 - val_loss: 3.2224 - val_accuracy30: 0.3994 - 32s/epoch - 22ms/step
Epoch 11/50
1454/1454 - 31s - loss: 3.1870 - accuracy30: 0.4293 - val_loss: 3.2220 - val_accuracy30: 0.3995 - 31s/epoch - 21ms/step
Epoch 12/50
1454/1454 - 31s - loss: 3.1825 - accuracy30: 0.4318 - val_loss: 3.2195 - val_accuracy30: 0.4007 - 31s/epoch - 21ms/step
Epoch 13/50
1454/1454 - 32s - loss: 3.1783 - accuracy30: 0.4340 - val_loss: 3.2200 - val_accuracy30: 0.4022 - 32s/epoch - 22ms/step
Epoch 14/50
1454/1454 - 31s - loss: 3.1742 - accuracy30: 0.4350 - val_loss: 3.2216 - val_accuracy30: 0.4018 - 31s/epoch - 21ms/step
Epoch 15/50
1454/1454 - 32s - loss: 3.1691 - accuracy30: 0.4370 - val_loss: 3.2186 - val_accuracy30: 0.4042 - 32s/epoch - 22ms/step
Epoch 16/50
1454/1454 - 32s - loss: 3.1672 - accuracy30: 0.4384 - val_loss: 3.2150 - val_accuracy30: 0.4057 - 32s/epoch - 22ms/step
Epoch 17/50
1454/1454 - 32s - loss: 3.1617 - accuracy30: 0.4412 - val_loss: 3.2162 - val_accuracy30: 0.4049 - 32s/epoch - 22ms/step
Epoch 18/50
1454/1454 - 33s - loss: 3.1582 - accuracy30: 0.4422 - val_loss: 3.2135 - val_accuracy30: 0.4081 - 33s/epoch - 22ms/step
Epoch 19/50
1454/1454 - 32s - loss: 3.1554 - accuracy30: 0.4424 - val_loss: 3.2107 - val_accuracy30: 0.4078 - 32s/epoch - 22ms/step
Epoch 20/50
1454/1454 - 32s - loss: 3.1523 - accuracy30: 0.4439 - val_loss: 3.2107 - val_accuracy30: 0.4080 - 32s/epoch - 22ms/step
Epoch 21/50
1454/1454 - 32s - loss: 3.1497 - accuracy30: 0.4456 - val_loss: 3.2085 - val_accuracy30: 0.4103 - 32s/epoch - 22ms/step
Epoch 22/50
1454/1454 - 31s - loss: 3.1465 - accuracy30: 0.4449 - val_loss: 3.2092 - val_accuracy30: 0.4102 - 31s/epoch - 21ms/step
Epoch 23/50
1454/1454 - 29s - loss: 3.1428 - accuracy30: 0.4480 - val_loss: 3.2063 - val_accuracy30: 0.4117 - 29s/epoch - 20ms/step
Epoch 24/50
1454/1454 - 30s - loss: 3.1403 - accuracy30: 0.4490 - val_loss: 3.2061 - val_accuracy30: 0.4126 - 30s/epoch - 21ms/step
Epoch 25/50
1454/1454 - 31s - loss: 3.1369 - accuracy30: 0.4495 - val_loss: 3.2079 - val_accuracy30: 0.4107 - 31s/epoch - 21ms/step
Epoch 26/50
1454/1454 - 31s - loss: 3.1336 - accuracy30: 0.4510 - val_loss: 3.2043 - val_accuracy30: 0.4147 - 31s/epoch - 21ms/step
Epoch 27/50
1454/1454 - 31s - loss: 3.1299 - accuracy30: 0.4523 - val_loss: 3.2065 - val_accuracy30: 0.4127 - 31s/epoch - 21ms/step
Epoch 28/50
1454/1454 - 31s - loss: 3.1284 - accuracy30: 0.4527 - val_loss: 3.2054 - val_accuracy30: 0.4133 - 31s/epoch - 21ms/step
Epoch 29/50
1454/1454 - 31s - loss: 3.1253 - accuracy30: 0.4548 - val_loss: 3.2049 - val_accuracy30: 0.4129 - 31s/epoch - 21ms/step
Epoch 30/50
1454/1454 - 31s - loss: 3.1220 - accuracy30: 0.4553 - val_loss: 3.2057 - val_accuracy30: 0.4132 - 31s/epoch - 21ms/step
Epoch 31/50
1454/1454 - 31s - loss: 3.1195 - accuracy30: 0.4562 - val_loss: 3.2031 - val_accuracy30: 0.4154 - 31s/epoch - 21ms/step
Epoch 32/50
1454/1454 - 31s - loss: 3.1171 - accuracy30: 0.4565 - val_loss: 3.2022 - val_accuracy30: 0.4147 - 31s/epoch - 21ms/step
Epoch 33/50
1454/1454 - 31s - loss: 3.1135 - accuracy30: 0.4586 - val_loss: 3.2053 - val_accuracy30: 0.4140 - 31s/epoch - 21ms/step
Epoch 34/50
1454/1454 - 31s - loss: 3.1098 - accuracy30: 0.4598 - val_loss: 3.2029 - val_accuracy30: 0.4154 - 31s/epoch - 21ms/step
Epoch 35/50
1454/1454 - 31s - loss: 3.1084 - accuracy30: 0.4604 - val_loss: 3.2042 - val_accuracy30: 0.4139 - 31s/epoch - 21ms/step
Epoch 36/50
1454/1454 - 30s - loss: 3.1051 - accuracy30: 0.4621 - val_loss: 3.2026 - val_accuracy30: 0.4154 - 30s/epoch - 21ms/step
Epoch 37/50
1454/1454 - 30s - loss: 3.1021 - accuracy30: 0.4630 - val_loss: 3.2029 - val_accuracy30: 0.4156 - 30s/epoch - 21ms/step
Epoch 38/50
1454/1454 - 30s - loss: 3.0987 - accuracy30: 0.4643 - val_loss: 3.2067 - val_accuracy30: 0.4141 - 30s/epoch - 21ms/step
Epoch 39/50
1454/1454 - 30s - loss: 3.0971 - accuracy30: 0.4650 - val_loss: 3.2055 - val_accuracy30: 0.4160 - 30s/epoch - 21ms/step
Epoch 40/50
1454/1454 - 31s - loss: 3.0935 - accuracy30: 0.4651 - val_loss: 3.2024 - val_accuracy30: 0.4162 - 31s/epoch - 21ms/step
Epoch 41/50
1454/1454 - 30s - loss: 3.0900 - accuracy30: 0.4669 - val_loss: 3.2045 - val_accuracy30: 0.4169 - 30s/epoch - 21ms/step
Epoch 42/50
1454/1454 - 30s - loss: 3.0873 - accuracy30: 0.4684 - val_loss: 3.2041 - val_accuracy30: 0.4150 - 30s/epoch - 21ms/step
testing model: results/WBA/W0/deepOF_L1/h30
Evaluating performance on  test set...
5633/5633 - 69s - 69s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.078757
{'0': {'precision': 0.3367422622478684, 'recall': 0.47683144101737457, 'f1-score': 0.394725880432624, 'support': 341821}, '1': {'precision': 0.6520154675014642, 'recall': 0.25214673139201443, 'f1-score': 0.36365946098770524, 'support': 754985}, '2': {'precision': 0.3142201042594381, 'recall': 0.6063943563182744, 'f1-score': 0.4139437430628513, 'support': 345023}, 'accuracy': 0.39018357932875536, 'macro avg': {'precision': 0.43432594466959024, 'recall': 0.44512417624255446, 'f1-score': 0.3907763614943935, 'support': 1441829}, 'weighted avg': {'precision': 0.4964393403013296, 'recall': 0.39018357932875536, 'f1-score': 0.38305731497420065, 'support': 1441829}}
[[162991  53837 124993]
 [232992 190367 331626]
 [ 88040  47763 209220]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0687445
{'0': {'precision': 0.4225155254840298, 'recall': 0.44144271217941805, 'f1-score': 0.43177179492381673, 'support': 120523}, '1': {'precision': 0.46292185666416885, 'recall': 0.2509446254071661, 'f1-score': 0.32546072642691, 'support': 130475}, '2': {'precision': 0.396490008093843, 'recall': 0.5744332961724266, 'f1-score': 0.46915561970344344, 'support': 121095}, 'accuracy': 0.417925088620318, 'macro avg': {'precision': 0.42730913008068055, 'recall': 0.42227354458633687, 'f1-score': 0.4087960470180567, 'support': 372093}, 'weighted avg': {'precision': 0.42821425142717834, 'recall': 0.417925088620318, 'f1-score': 0.40665994815313034, 'support': 372093}}
[[53204 19477 47842]
 [39694 32742 58039]
 [33024 18510 69561]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0716252
{'0': {'precision': 0.4150278962218121, 'recall': 0.4447475505239946, 'f1-score': 0.42937406724607147, 'support': 43989}, '1': {'precision': 0.47886476026660935, 'recall': 0.2113413800956502, 'f1-score': 0.29325713984752527, 'support': 52692}, '2': {'precision': 0.3940929793379249, 'recall': 0.6206346082354742, 'f1-score': 0.48207567200305745, 'support': 45729}, 'accuracy': 0.4148655291061021, 'macro avg': {'precision': 0.4293285452754488, 'recall': 0.42557451295170634, 'f1-score': 0.40156895969888473, 'support': 142410}, 'weighted avg': {'precision': 0.4319252996770834, 'recall': 0.4148655291061021, 'f1-score': 0.3959334278629384, 'support': 142410}}
[[19564  6534 17891]
 [15812 11136 25744]
 [11763  5585 28381]]
training model: results/WBA/W0/deepOF_L1/h50
Epoch 1/50
1454/1454 - 32s - loss: 3.2842 - accuracy50: 0.3831 - val_loss: 3.2865 - val_accuracy50: 0.3808 - 32s/epoch - 22ms/step
Epoch 2/50
1454/1454 - 31s - loss: 3.2628 - accuracy50: 0.3902 - val_loss: 3.2700 - val_accuracy50: 0.3847 - 31s/epoch - 21ms/step
Epoch 3/50
1454/1454 - 30s - loss: 3.2574 - accuracy50: 0.3917 - val_loss: 3.2622 - val_accuracy50: 0.3882 - 30s/epoch - 21ms/step
Epoch 4/50
1454/1454 - 30s - loss: 3.2511 - accuracy50: 0.3974 - val_loss: 3.2587 - val_accuracy50: 0.3876 - 30s/epoch - 21ms/step
Epoch 5/50
1454/1454 - 30s - loss: 3.2459 - accuracy50: 0.3995 - val_loss: 3.2549 - val_accuracy50: 0.3902 - 30s/epoch - 20ms/step
Epoch 6/50
1454/1454 - 31s - loss: 3.2400 - accuracy50: 0.4036 - val_loss: 3.2540 - val_accuracy50: 0.3916 - 31s/epoch - 21ms/step
Epoch 7/50
1454/1454 - 32s - loss: 3.2354 - accuracy50: 0.4060 - val_loss: 3.2524 - val_accuracy50: 0.3921 - 32s/epoch - 22ms/step
Epoch 8/50
1454/1454 - 31s - loss: 3.2313 - accuracy50: 0.4082 - val_loss: 3.2522 - val_accuracy50: 0.3914 - 31s/epoch - 22ms/step
Epoch 9/50
1454/1454 - 32s - loss: 3.2270 - accuracy50: 0.4111 - val_loss: 3.2494 - val_accuracy50: 0.3937 - 32s/epoch - 22ms/step
Epoch 10/50
1454/1454 - 31s - loss: 3.2229 - accuracy50: 0.4133 - val_loss: 3.2491 - val_accuracy50: 0.3947 - 31s/epoch - 21ms/step
Epoch 11/50
1454/1454 - 32s - loss: 3.2200 - accuracy50: 0.4140 - val_loss: 3.2466 - val_accuracy50: 0.3948 - 32s/epoch - 22ms/step
Epoch 12/50
1454/1454 - 31s - loss: 3.2162 - accuracy50: 0.4166 - val_loss: 3.2480 - val_accuracy50: 0.3945 - 31s/epoch - 21ms/step
Epoch 13/50
1454/1454 - 31s - loss: 3.2122 - accuracy50: 0.4186 - val_loss: 3.2464 - val_accuracy50: 0.3957 - 31s/epoch - 21ms/step
Epoch 14/50
1454/1454 - 31s - loss: 3.2098 - accuracy50: 0.4195 - val_loss: 3.2428 - val_accuracy50: 0.3991 - 31s/epoch - 22ms/step
Epoch 15/50
1454/1454 - 32s - loss: 3.2057 - accuracy50: 0.4212 - val_loss: 3.2440 - val_accuracy50: 0.3971 - 32s/epoch - 22ms/step
Epoch 16/50
1454/1454 - 31s - loss: 3.2024 - accuracy50: 0.4231 - val_loss: 3.2427 - val_accuracy50: 0.3981 - 31s/epoch - 21ms/step
Epoch 17/50
1454/1454 - 31s - loss: 3.1994 - accuracy50: 0.4247 - val_loss: 3.2431 - val_accuracy50: 0.3988 - 31s/epoch - 21ms/step
Epoch 18/50
1454/1454 - 30s - loss: 3.1964 - accuracy50: 0.4254 - val_loss: 3.2423 - val_accuracy50: 0.3992 - 30s/epoch - 21ms/step
Epoch 19/50
1454/1454 - 31s - loss: 3.1929 - accuracy50: 0.4273 - val_loss: 3.2419 - val_accuracy50: 0.3997 - 31s/epoch - 21ms/step
Epoch 20/50
1454/1454 - 32s - loss: 3.1916 - accuracy50: 0.4275 - val_loss: 3.2408 - val_accuracy50: 0.4010 - 32s/epoch - 22ms/step
Epoch 21/50
1454/1454 - 32s - loss: 3.1888 - accuracy50: 0.4289 - val_loss: 3.2396 - val_accuracy50: 0.4005 - 32s/epoch - 22ms/step
Epoch 22/50
1454/1454 - 32s - loss: 3.1863 - accuracy50: 0.4291 - val_loss: 3.2422 - val_accuracy50: 0.4005 - 32s/epoch - 22ms/step
Epoch 23/50
1454/1454 - 32s - loss: 3.1839 - accuracy50: 0.4310 - val_loss: 3.2420 - val_accuracy50: 0.3998 - 32s/epoch - 22ms/step
Epoch 24/50
1454/1454 - 32s - loss: 3.1817 - accuracy50: 0.4322 - val_loss: 3.2449 - val_accuracy50: 0.3984 - 32s/epoch - 22ms/step
Epoch 25/50
1454/1454 - 31s - loss: 3.1799 - accuracy50: 0.4327 - val_loss: 3.2453 - val_accuracy50: 0.3984 - 31s/epoch - 22ms/step
Epoch 26/50
1454/1454 - 31s - loss: 3.1770 - accuracy50: 0.4348 - val_loss: 3.2409 - val_accuracy50: 0.4000 - 31s/epoch - 21ms/step
Epoch 27/50
1454/1454 - 31s - loss: 3.1756 - accuracy50: 0.4350 - val_loss: 3.2424 - val_accuracy50: 0.3997 - 31s/epoch - 21ms/step
Epoch 28/50
1454/1454 - 28s - loss: 3.1721 - accuracy50: 0.4365 - val_loss: 3.2412 - val_accuracy50: 0.4013 - 28s/epoch - 20ms/step
Epoch 29/50
1454/1454 - 29s - loss: 3.1701 - accuracy50: 0.4374 - val_loss: 3.2407 - val_accuracy50: 0.4027 - 29s/epoch - 20ms/step
Epoch 30/50
1454/1454 - 31s - loss: 3.1676 - accuracy50: 0.4383 - val_loss: 3.2410 - val_accuracy50: 0.4019 - 31s/epoch - 21ms/step
Epoch 31/50
1454/1454 - 30s - loss: 3.1655 - accuracy50: 0.4394 - val_loss: 3.2395 - val_accuracy50: 0.4021 - 30s/epoch - 21ms/step
Epoch 32/50
1454/1454 - 31s - loss: 3.1631 - accuracy50: 0.4411 - val_loss: 3.2388 - val_accuracy50: 0.4037 - 31s/epoch - 21ms/step
Epoch 33/50
1454/1454 - 30s - loss: 3.1604 - accuracy50: 0.4409 - val_loss: 3.2454 - val_accuracy50: 0.4007 - 30s/epoch - 21ms/step
Epoch 34/50
1454/1454 - 30s - loss: 3.1594 - accuracy50: 0.4424 - val_loss: 3.2433 - val_accuracy50: 0.4021 - 30s/epoch - 21ms/step
Epoch 35/50
1454/1454 - 31s - loss: 3.1567 - accuracy50: 0.4440 - val_loss: 3.2455 - val_accuracy50: 0.4014 - 31s/epoch - 21ms/step
Epoch 36/50
1454/1454 - 31s - loss: 3.1542 - accuracy50: 0.4447 - val_loss: 3.2470 - val_accuracy50: 0.4011 - 31s/epoch - 22ms/step
Epoch 37/50
1454/1454 - 32s - loss: 3.1516 - accuracy50: 0.4457 - val_loss: 3.2453 - val_accuracy50: 0.4016 - 32s/epoch - 22ms/step
Epoch 38/50
1454/1454 - 31s - loss: 3.1491 - accuracy50: 0.4469 - val_loss: 3.2434 - val_accuracy50: 0.4027 - 31s/epoch - 22ms/step
Epoch 39/50
1454/1454 - 31s - loss: 3.1466 - accuracy50: 0.4479 - val_loss: 3.2479 - val_accuracy50: 0.3994 - 31s/epoch - 22ms/step
Epoch 40/50
1454/1454 - 31s - loss: 3.1446 - accuracy50: 0.4491 - val_loss: 3.2459 - val_accuracy50: 0.4017 - 31s/epoch - 21ms/step
Epoch 41/50
1454/1454 - 30s - loss: 3.1417 - accuracy50: 0.4501 - val_loss: 3.2440 - val_accuracy50: 0.4033 - 30s/epoch - 21ms/step
Epoch 42/50
1454/1454 - 30s - loss: 3.1390 - accuracy50: 0.4505 - val_loss: 3.2491 - val_accuracy50: 0.4025 - 30s/epoch - 21ms/step
testing model: results/WBA/W0/deepOF_L1/h50
Evaluating performance on  test set...
5633/5633 - 71s - 71s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0837561
{'0': {'precision': 0.3343209124230325, 'recall': 0.41482950666117446, 'f1-score': 0.3702492200071012, 'support': 354442}, '1': {'precision': 0.5810992335882244, 'recall': 0.18606567531489548, 'f1-score': 0.28187582635173747, 'support': 718413}, '2': {'precision': 0.3107616580310881, 'recall': 0.6502029953330045, 'f1-score': 0.42053193149011286, 'support': 368974}, 'accuracy': 0.3610781861094485, 'macro avg': {'precision': 0.40872726801411496, 'recall': 0.41703272576969147, 'f1-score': 0.3575523259496505, 'support': 1441829}, 'weighted avg': {'precision': 0.45125294924101556, 'recall': 0.3610781861094485, 'f1-score': 0.339083539701463, 'support': 1441829}}
[[147033  53550 153859]
 [206508 133672 378233]
 [ 86255  42811 239908]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0784597
{'0': {'precision': 0.4175399511589049, 'recall': 0.3945699965181904, 'f1-score': 0.40573012939001846, 'support': 123499}, '1': {'precision': 0.38895336125267, 'recall': 0.18860353784548636, 'f1-score': 0.2540285817854279, 'support': 122617}, '2': {'precision': 0.39349056555624173, 'recall': 0.611992665327798, 'f1-score': 0.4790002112404786, 'support': 125977}, 'accuracy': 0.4003085250192828, 'macro avg': {'precision': 0.3999946259892722, 'recall': 0.3983887332304916, 'f1-score': 0.37958630747197497, 'support': 372093}, 'weighted avg': {'precision': 0.39997748332263955, 'recall': 0.4003085250192828, 'f1-score': 0.3805459857448635, 'support': 372093}}
[[48729 18983 55787]
 [36444 23126 63047]
 [31532 17348 77097]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0789056
{'0': {'precision': 0.4131018265599392, 'recall': 0.37964680971819, 'f1-score': 0.3956683956683957, 'support': 45811}, '1': {'precision': 0.40362135004725663, 'recall': 0.16870425815036594, 'f1-score': 0.23795070308948812, 'support': 48096}, '2': {'precision': 0.396616213250879, 'recall': 0.6558563387831681, 'f1-score': 0.49430886728977774, 'support': 48503}, 'accuracy': 0.40247875851414927, 'macro avg': {'precision': 0.40444646328602496, 'recall': 0.401402468883908, 'f1-score': 0.37597598868255383, 'support': 142410}, 'weighted avg': {'precision': 0.40428520763793, 'recall': 0.40247875851414927, 'f1-score': 0.37599820855215915, 'support': 142410}}
[[17392  6570 21849]
 [13436  8114 26546]
 [11273  5419 31811]]
training model: results/WBA/W0/deepOF_L1/h100
Epoch 1/50
1454/1454 - 34s - loss: 3.2963 - accuracy100: 0.3707 - val_loss: 3.2903 - val_accuracy100: 0.3519 - 34s/epoch - 23ms/step
Epoch 2/50
1454/1454 - 32s - loss: 3.2770 - accuracy100: 0.3790 - val_loss: 3.2900 - val_accuracy100: 0.3490 - 32s/epoch - 22ms/step
Epoch 3/50
1454/1454 - 31s - loss: 3.2746 - accuracy100: 0.3789 - val_loss: 3.2880 - val_accuracy100: 0.3510 - 31s/epoch - 21ms/step
Epoch 4/50
1454/1454 - 32s - loss: 3.2727 - accuracy100: 0.3792 - val_loss: 3.2868 - val_accuracy100: 0.3510 - 32s/epoch - 22ms/step
Epoch 5/50
1454/1454 - 31s - loss: 3.2704 - accuracy100: 0.3798 - val_loss: 3.2862 - val_accuracy100: 0.3567 - 31s/epoch - 22ms/step
Epoch 6/50
1454/1454 - 31s - loss: 3.2687 - accuracy100: 0.3819 - val_loss: 3.2858 - val_accuracy100: 0.3541 - 31s/epoch - 22ms/step
Epoch 7/50
1454/1454 - 32s - loss: 3.2667 - accuracy100: 0.3825 - val_loss: 3.2859 - val_accuracy100: 0.3552 - 32s/epoch - 22ms/step
Epoch 8/50
1454/1454 - 32s - loss: 3.2653 - accuracy100: 0.3831 - val_loss: 3.2867 - val_accuracy100: 0.3534 - 32s/epoch - 22ms/step
Epoch 9/50
1454/1454 - 32s - loss: 3.2632 - accuracy100: 0.3852 - val_loss: 3.2848 - val_accuracy100: 0.3568 - 32s/epoch - 22ms/step
Epoch 10/50
1454/1454 - 31s - loss: 3.2607 - accuracy100: 0.3875 - val_loss: 3.2866 - val_accuracy100: 0.3544 - 31s/epoch - 21ms/step
Epoch 11/50
1454/1454 - 31s - loss: 3.2595 - accuracy100: 0.3883 - val_loss: 3.2853 - val_accuracy100: 0.3549 - 31s/epoch - 21ms/step
Epoch 12/50
1454/1454 - 30s - loss: 3.2576 - accuracy100: 0.3894 - val_loss: 3.2856 - val_accuracy100: 0.3555 - 30s/epoch - 21ms/step
Epoch 13/50
1454/1454 - 31s - loss: 3.2552 - accuracy100: 0.3915 - val_loss: 3.2870 - val_accuracy100: 0.3551 - 31s/epoch - 22ms/step
Epoch 14/50
1454/1454 - 31s - loss: 3.2539 - accuracy100: 0.3927 - val_loss: 3.2867 - val_accuracy100: 0.3571 - 31s/epoch - 21ms/step
Epoch 15/50
1454/1454 - 31s - loss: 3.2513 - accuracy100: 0.3941 - val_loss: 3.2858 - val_accuracy100: 0.3573 - 31s/epoch - 21ms/step
Epoch 16/50
1454/1454 - 31s - loss: 3.2496 - accuracy100: 0.3958 - val_loss: 3.2854 - val_accuracy100: 0.3600 - 31s/epoch - 21ms/step
Epoch 17/50
1454/1454 - 31s - loss: 3.2478 - accuracy100: 0.3969 - val_loss: 3.2870 - val_accuracy100: 0.3589 - 31s/epoch - 21ms/step
Epoch 18/50
1454/1454 - 31s - loss: 3.2464 - accuracy100: 0.3978 - val_loss: 3.2879 - val_accuracy100: 0.3567 - 31s/epoch - 22ms/step
Epoch 19/50
1454/1454 - 31s - loss: 3.2447 - accuracy100: 0.3985 - val_loss: 3.2855 - val_accuracy100: 0.3621 - 31s/epoch - 22ms/step
testing model: results/WBA/W0/deepOF_L1/h100
Evaluating performance on  test set...
5633/5633 - 70s - 70s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.075144
{'0': {'precision': 0.3286158912990999, 'recall': 0.2111404704135784, 'f1-score': 0.25709419581127113, 'support': 361044}, '1': {'precision': 0.4883043476664386, 'recall': 0.5696996785585257, 'f1-score': 0.5258710231886197, 'support': 700283}, '2': {'precision': 0.32169585581916305, 'recall': 0.3321270321837993, 'f1-score': 0.3268282338215175, 'support': 380502}, 'accuracy': 0.4172179918700484, 'macro avg': {'precision': 0.3795386982615672, 'recall': 0.37098906038530116, 'f1-score': 0.3699311509404694, 'support': 1441829}, 'weighted avg': {'precision': 0.4043488831796226, 'recall': 0.4172179918700484, 'f1-score': 0.4060395866566949, 'support': 1441829}}
[[ 76231 207580  77233]
 [112100 398951 189232]
 [ 43645 210482 126375]]
Evaluating performance on  train set...
1454/1454 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0933982
{'0': {'precision': 0.40079742370802024, 'recall': 0.21203271028037382, 'f1-score': 0.27734329403525154, 'support': 123264}, '1': {'precision': 0.3351899951899952, 'recall': 0.5672169043432962, 'f1-score': 0.42137406426489615, 'support': 122856}, '2': {'precision': 0.3944010587676672, 'recall': 0.30989974042056634, 'f1-score': 0.3470812069915895, 'support': 125973}, 'accuracy': 0.362438960152435, 'macro avg': {'precision': 0.3767961592218942, 'recall': 0.36304978501474544, 'f1-score': 0.3485995217639124, 'support': 372093}, 'weighted avg': {'precision': 0.37696995176245396, 'recall': 0.362438960152435, 'f1-score': 0.3485086704765767, 'support': 372093}}
[[26136 68999 28129]
 [21355 69686 31815]
 [17719 69215 39039]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0955578
{'0': {'precision': 0.4252997601918465, 'recall': 0.21647848642050657, 'f1-score': 0.2869160768452983, 'support': 49155}, '1': {'precision': 0.30036514150881216, 'recall': 0.5407855701910526, 'f1-score': 0.3862164819146412, 'support': 42135}, '2': {'precision': 0.41883984685400566, 'recall': 0.3402582159624413, 'f1-score': 0.37548165657481464, 'support': 51120}, 'accuracy': 0.3568639842707675, 'macro avg': {'precision': 0.38150158285155483, 'recall': 0.36584075752466677, 'f1-score': 0.3495380717782514, 'support': 142410}, 'weighted avg': {'precision': 0.3860163466110581, 'recall': 0.3568639842707675, 'f1-score': 0.3480880100197217, 'support': 142410}}
[[10641 26321 12193]
 [ 7407 22786 11942]
 [ 6972 26754 17394]]
training model: results/WBA/W0/deepOF_L1/h200
Epoch 1/50
1454/1454 - 34s - loss: 3.3109 - accuracy200: 0.3528 - val_loss: 3.2964 - val_accuracy200: 0.3487 - 34s/epoch - 24ms/step
Epoch 2/50
1454/1454 - 32s - loss: 3.2926 - accuracy200: 0.3601 - val_loss: 3.2928 - val_accuracy200: 0.3516 - 32s/epoch - 22ms/step
Epoch 3/50
1454/1454 - 32s - loss: 3.2887 - accuracy200: 0.3612 - val_loss: 3.2909 - val_accuracy200: 0.3514 - 32s/epoch - 22ms/step
Epoch 4/50
1454/1454 - 32s - loss: 3.2868 - accuracy200: 0.3617 - val_loss: 3.2912 - val_accuracy200: 0.3511 - 32s/epoch - 22ms/step
Epoch 5/50
1454/1454 - 32s - loss: 3.2851 - accuracy200: 0.3628 - val_loss: 3.2905 - val_accuracy200: 0.3523 - 32s/epoch - 22ms/step
Epoch 6/50
1454/1454 - 32s - loss: 3.2838 - accuracy200: 0.3635 - val_loss: 3.2905 - val_accuracy200: 0.3530 - 32s/epoch - 22ms/step
Epoch 7/50
1454/1454 - 32s - loss: 3.2825 - accuracy200: 0.3650 - val_loss: 3.2903 - val_accuracy200: 0.3517 - 32s/epoch - 22ms/step
Epoch 8/50
1454/1454 - 31s - loss: 3.2814 - accuracy200: 0.3666 - val_loss: 3.2902 - val_accuracy200: 0.3519 - 31s/epoch - 21ms/step
Epoch 9/50
1454/1454 - 28s - loss: 3.2806 - accuracy200: 0.3673 - val_loss: 3.2908 - val_accuracy200: 0.3517 - 28s/epoch - 20ms/step
Epoch 10/50
1454/1454 - 31s - loss: 3.2793 - accuracy200: 0.3679 - val_loss: 3.2911 - val_accuracy200: 0.3514 - 31s/epoch - 21ms/step
Epoch 11/50
1454/1454 - 31s - loss: 3.2784 - accuracy200: 0.3691 - val_loss: 3.2905 - val_accuracy200: 0.3520 - 31s/epoch - 21ms/step
Epoch 12/50
1454/1454 - 31s - loss: 3.2776 - accuracy200: 0.3698 - val_loss: 3.2912 - val_accuracy200: 0.3523 - 31s/epoch - 21ms/step
Epoch 13/50
1454/1454 - 31s - loss: 3.2756 - accuracy200: 0.3720 - val_loss: 3.2920 - val_accuracy200: 0.3498 - 31s/epoch - 21ms/step
Epoch 14/50
1454/1454 - 31s - loss: 3.2754 - accuracy200: 0.3728 - val_loss: 3.2918 - val_accuracy200: 0.3541 - 31s/epoch - 21ms/step
Epoch 15/50
1454/1454 - 31s - loss: 3.2739 - accuracy200: 0.3743 - val_loss: 3.2922 - val_accuracy200: 0.3507 - 31s/epoch - 21ms/step
Epoch 16/50
1454/1454 - 30s - loss: 3.2728 - accuracy200: 0.3753 - val_loss: 3.2923 - val_accuracy200: 0.3508 - 30s/epoch - 21ms/step
Epoch 17/50
1454/1454 - 31s - loss: 3.2722 - accuracy200: 0.3759 - val_loss: 3.2939 - val_accuracy200: 0.3516 - 31s/epoch - 21ms/step
Epoch 18/50
1454/1454 - 31s - loss: 3.2716 - accuracy200: 0.3755 - val_loss: 3.2924 - val_accuracy200: 0.3516 - 31s/epoch - 21ms/step
testing model: results/WBA/W0/deepOF_L1/h200
Evaluating performance on  test set...
5633/5633 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0903476
{'0': {'precision': 0.34632930895434355, 'recall': 0.2068390405214349, 'f1-score': 0.2589968209007398, 'support': 417310}, '1': {'precision': 0.393867338351591, 'recall': 0.4760306217809538, 'f1-score': 0.431068751893956, 'support': 569268}, '2': {'precision': 0.3506778945532595, 'recall': 0.38867350099176057, 'f1-score': 0.3686993919743954, 'support': 455251}, 'accuracy': 0.3705356183014768, 'macro avg': {'precision': 0.36362484728639793, 'recall': 0.3571810544313831, 'f1-score': 0.35292165492303046, 'support': 1441829}, 'weighted avg': {'precision': 0.36647148729962886, 'recall': 0.3705356183014768, 'f1-score': 0.3615729580130458, 'support': 1441829}}
[[ 86316 202982 128012]
 [ 98658 270989 199621]
 [ 64257 214050 176944]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0956599
{'0': {'precision': 0.3783468834688347, 'recall': 0.22721317611828562, 'f1-score': 0.2839203005760363, 'support': 122889}, '1': {'precision': 0.33414838539334873, 'recall': 0.4736088512853889, 'f1-score': 0.3918395918449765, 'support': 122920}, '2': {'precision': 0.37195637981478347, 'recall': 0.3654382186183523, 'f1-score': 0.36866849074314473, 'support': 126284}, 'accuracy': 0.3555213347200834, 'macro avg': {'precision': 0.3614838828923223, 'recall': 0.35542008200734226, 'f1-score': 0.34814279438805257, 'support': 372093}, 'weighted avg': {'precision': 0.3615771572259681, 'recall': 0.3555213347200834, 'f1-score': 0.34833371262582297, 'support': 372093}}
[[27922 57475 37492]
 [24274 58216 40430]
 [21604 58531 46149]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0969516
{'0': {'precision': 0.3726324749946797, 'recall': 0.22256116936765175, 'f1-score': 0.2786774360402658, 'support': 47205}, '1': {'precision': 0.33126397598085977, 'recall': 0.45297865971004575, 'f1-score': 0.3826762407984465, 'support': 46766}, '2': {'precision': 0.36721905027154994, 'recall': 0.38107723115671255, 'f1-score': 0.3740198164245334, 'support': 48439}, 'accuracy': 0.35214521452145214, 'macro avg': {'precision': 0.35703850041569646, 'recall': 0.35220568674480335, 'f1-score': 0.3451244977544152, 'support': 142410}, 'weighted avg': {'precision': 0.35720616992450216, 'recall': 0.35214521452145214, 'f1-score': 0.34525912037953, 'support': 142410}}
[[10506 21218 15481]
 [ 9255 21184 16327]
 [ 8433 21547 18459]]
training model: results/WBA/W0/deepOF_L1/h300
Epoch 1/50
1454/1454 - 33s - loss: 3.3084 - accuracy300: 0.3580 - val_loss: 3.2978 - val_accuracy300: 0.3497 - 33s/epoch - 23ms/step
Epoch 2/50
1454/1454 - 30s - loss: 3.2942 - accuracy300: 0.3610 - val_loss: 3.2930 - val_accuracy300: 0.3540 - 30s/epoch - 21ms/step
Epoch 3/50
1454/1454 - 30s - loss: 3.2918 - accuracy300: 0.3594 - val_loss: 3.2924 - val_accuracy300: 0.3541 - 30s/epoch - 21ms/step
Epoch 4/50
1454/1454 - 31s - loss: 3.2906 - accuracy300: 0.3585 - val_loss: 3.2923 - val_accuracy300: 0.3561 - 31s/epoch - 21ms/step
Epoch 5/50
1454/1454 - 30s - loss: 3.2893 - accuracy300: 0.3588 - val_loss: 3.2926 - val_accuracy300: 0.3564 - 30s/epoch - 21ms/step
Epoch 6/50
1454/1454 - 30s - loss: 3.2882 - accuracy300: 0.3601 - val_loss: 3.2917 - val_accuracy300: 0.3572 - 30s/epoch - 21ms/step
Epoch 7/50
1454/1454 - 31s - loss: 3.2875 - accuracy300: 0.3609 - val_loss: 3.2919 - val_accuracy300: 0.3578 - 31s/epoch - 22ms/step
Epoch 8/50
1454/1454 - 31s - loss: 3.2862 - accuracy300: 0.3621 - val_loss: 3.2923 - val_accuracy300: 0.3556 - 31s/epoch - 21ms/step
Epoch 9/50
1454/1454 - 30s - loss: 3.2852 - accuracy300: 0.3637 - val_loss: 3.2924 - val_accuracy300: 0.3552 - 30s/epoch - 21ms/step
Epoch 10/50
1454/1454 - 30s - loss: 3.2843 - accuracy300: 0.3640 - val_loss: 3.2921 - val_accuracy300: 0.3566 - 30s/epoch - 21ms/step
Epoch 11/50
1454/1454 - 30s - loss: 3.2836 - accuracy300: 0.3655 - val_loss: 3.2923 - val_accuracy300: 0.3572 - 30s/epoch - 21ms/step
Epoch 12/50
1454/1454 - 30s - loss: 3.2827 - accuracy300: 0.3650 - val_loss: 3.2919 - val_accuracy300: 0.3556 - 30s/epoch - 21ms/step
Epoch 13/50
1454/1454 - 31s - loss: 3.2809 - accuracy300: 0.3674 - val_loss: 3.2916 - val_accuracy300: 0.3562 - 31s/epoch - 21ms/step
Epoch 14/50
1454/1454 - 31s - loss: 3.2804 - accuracy300: 0.3678 - val_loss: 3.2918 - val_accuracy300: 0.3554 - 31s/epoch - 21ms/step
Epoch 15/50
1454/1454 - 31s - loss: 3.2790 - accuracy300: 0.3692 - val_loss: 3.2930 - val_accuracy300: 0.3554 - 31s/epoch - 21ms/step
Epoch 16/50
1454/1454 - 32s - loss: 3.2775 - accuracy300: 0.3710 - val_loss: 3.2926 - val_accuracy300: 0.3554 - 32s/epoch - 22ms/step
Epoch 17/50
1454/1454 - 31s - loss: 3.2765 - accuracy300: 0.3711 - val_loss: 3.2923 - val_accuracy300: 0.3561 - 31s/epoch - 21ms/step
Epoch 18/50
1454/1454 - 31s - loss: 3.2758 - accuracy300: 0.3717 - val_loss: 3.2925 - val_accuracy300: 0.3562 - 31s/epoch - 21ms/step
Epoch 19/50
1454/1454 - 31s - loss: 3.2746 - accuracy300: 0.3729 - val_loss: 3.2927 - val_accuracy300: 0.3570 - 31s/epoch - 21ms/step
Epoch 20/50
1454/1454 - 31s - loss: 3.2730 - accuracy300: 0.3735 - val_loss: 3.2926 - val_accuracy300: 0.3581 - 31s/epoch - 21ms/step
Epoch 21/50
1454/1454 - 30s - loss: 3.2711 - accuracy300: 0.3746 - val_loss: 3.2922 - val_accuracy300: 0.3574 - 30s/epoch - 21ms/step
Epoch 22/50
1454/1454 - 31s - loss: 3.2708 - accuracy300: 0.3756 - val_loss: 3.2918 - val_accuracy300: 0.3582 - 31s/epoch - 21ms/step
Epoch 23/50
1454/1454 - 31s - loss: 3.2694 - accuracy300: 0.3763 - val_loss: 3.2928 - val_accuracy300: 0.3567 - 31s/epoch - 21ms/step
testing model: results/WBA/W0/deepOF_L1/h300
Evaluating performance on  test set...
5633/5633 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.100933
{'0': {'precision': 0.2802853969146529, 'recall': 0.34159453098229986, 'f1-score': 0.30791782916689875, 'support': 356042}, '1': {'precision': 0.49348565154042695, 'recall': 0.13218101502802554, 'f1-score': 0.20851177730192721, 'support': 707212}, '2': {'precision': 0.2791519391456592, 'recall': 0.6035263818265866, 'f1-score': 0.38173716473943536, 'support': 378575}, 'accuracy': 0.3076522944121668, 'macro avg': {'precision': 0.35097432920024635, 'recall': 0.359100642612304, 'f1-score': 0.2993889237360871, 'support': 1441829}, 'weighted avg': {'precision': 0.3845617568016479, 'recall': 0.3076522944121668, 'f1-score': 0.2785419477085863, 'support': 1441829}}
[[121622  45277 189143]
 [212876  93480 400856]
 [ 99424  50671 228480]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0961646
{'0': {'precision': 0.3617066649169141, 'recall': 0.35799813288955634, 'f1-score': 0.359842844145618, 'support': 123185}, '1': {'precision': 0.33916017076952487, 'recall': 0.1299532044760936, 'f1-score': 0.1879074584009979, 'support': 122875}, '2': {'precision': 0.3557388349992614, 'recall': 0.5732387549292646, 'f1-score': 0.4390273545148774, 'support': 126033}, 'accuracy': 0.35559658472478656, 'macro avg': {'precision': 0.3522018902285668, 'recall': 0.3537300307649715, 'f1-score': 0.32892588568716447, 'support': 372093}, 'weighted avg': {'precision': 0.3522398273887371, 'recall': 0.35559658472478656, 'f1-score': 0.3298860883668172, 'support': 372093}}
[[44100 15277 63808]
 [39872 15968 67035]
 [37950 15836 72247]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0973725
{'0': {'precision': 0.3694150358250454, 'recall': 0.35479961381237035, 'f1-score': 0.3619598474370258, 'support': 48681}, '1': {'precision': 0.3131745855124068, 'recall': 0.1264631214755903, 'f1-score': 0.18017124109786348, 'support': 44511}, '2': {'precision': 0.3581956977896783, 'recall': 0.56534194806778, 'f1-score': 0.4385377347339222, 'support': 49218}, 'accuracy': 0.3561968962853732, 'macro avg': {'precision': 0.3469284397090435, 'recall': 0.3488682277852469, 'f1-score': 0.3268896077562705, 'support': 142410}, 'weighted avg': {'precision': 0.3479592949129567, 'recall': 0.3561968962853732, 'f1-score': 0.33160676689644714, 'support': 142410}}
[[17272  6005 25404]
 [14430  5629 24452]
 [15053  6340 27825]]
training model: results/WBA/W0/deepOF_L1/h500
Epoch 1/50
1454/1454 - 34s - loss: 3.3147 - accuracy500: 0.3539 - val_loss: 3.3117 - val_accuracy500: 0.3143 - 34s/epoch - 23ms/step
Epoch 2/50
1454/1454 - 32s - loss: 3.2978 - accuracy500: 0.3534 - val_loss: 3.3128 - val_accuracy500: 0.3061 - 32s/epoch - 22ms/step
Epoch 3/50
1454/1454 - 30s - loss: 3.2947 - accuracy500: 0.3516 - val_loss: 3.3079 - val_accuracy500: 0.3070 - 30s/epoch - 21ms/step
Epoch 4/50
1454/1454 - 30s - loss: 3.2923 - accuracy500: 0.3541 - val_loss: 3.3053 - val_accuracy500: 0.3113 - 30s/epoch - 20ms/step
Epoch 5/50
1454/1454 - 31s - loss: 3.2912 - accuracy500: 0.3555 - val_loss: 3.3045 - val_accuracy500: 0.3150 - 31s/epoch - 22ms/step
Epoch 6/50
1454/1454 - 32s - loss: 3.2901 - accuracy500: 0.3569 - val_loss: 3.3048 - val_accuracy500: 0.3129 - 32s/epoch - 22ms/step
Epoch 7/50
1454/1454 - 31s - loss: 3.2888 - accuracy500: 0.3584 - val_loss: 3.3057 - val_accuracy500: 0.3115 - 31s/epoch - 21ms/step
Epoch 8/50
1454/1454 - 31s - loss: 3.2878 - accuracy500: 0.3599 - val_loss: 3.3067 - val_accuracy500: 0.3116 - 31s/epoch - 21ms/step
Epoch 9/50
1454/1454 - 31s - loss: 3.2870 - accuracy500: 0.3614 - val_loss: 3.3069 - val_accuracy500: 0.3103 - 31s/epoch - 21ms/step
Epoch 10/50
1454/1454 - 31s - loss: 3.2861 - accuracy500: 0.3630 - val_loss: 3.3090 - val_accuracy500: 0.3087 - 31s/epoch - 21ms/step
Epoch 11/50
1454/1454 - 31s - loss: 3.2852 - accuracy500: 0.3642 - val_loss: 3.3097 - val_accuracy500: 0.3086 - 31s/epoch - 21ms/step
Epoch 12/50
1454/1454 - 30s - loss: 3.2840 - accuracy500: 0.3652 - val_loss: 3.3096 - val_accuracy500: 0.3087 - 30s/epoch - 21ms/step
Epoch 13/50
1454/1454 - 30s - loss: 3.2829 - accuracy500: 0.3661 - val_loss: 3.3127 - val_accuracy500: 0.3072 - 30s/epoch - 21ms/step
Epoch 14/50
1454/1454 - 30s - loss: 3.2824 - accuracy500: 0.3673 - val_loss: 3.3147 - val_accuracy500: 0.3053 - 30s/epoch - 21ms/step
Epoch 15/50
1454/1454 - 31s - loss: 3.2809 - accuracy500: 0.3673 - val_loss: 3.3161 - val_accuracy500: 0.3046 - 31s/epoch - 21ms/step
testing model: results/WBA/W0/deepOF_L1/h500
Evaluating performance on  test set...
5633/5633 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0887392
{'0': {'precision': 0.2969701252940523, 'recall': 0.07688567784027937, 'f1-score': 0.12214735836716048, 'support': 382568}, '1': {'precision': 0.44276740703242, 'recall': 0.8203555745923461, 'f1-score': 0.5751248546513221, 'support': 639697}, '2': {'precision': 0.31649498276814103, 'recall': 0.11885195107301866, 'f1-score': 0.17280951481578385, 'support': 419564}, 'accuracy': 0.41895328780319996, 'macro avg': {'precision': 0.35207750503153773, 'recall': 0.33869773450188134, 'f1-score': 0.29002724261142215, 'support': 1441829}, 'weighted avg': {'precision': 0.367337700809212, 'recall': 0.41895328780319996, 'f1-score': 0.33786251075256785, 'support': 1441829}}
[[ 29414 315549  37605]
 [ 44832 524779  70086]
 [ 24801 344897  49866]]
Evaluating performance on  train set...
1454/1454 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984385
{'0': {'precision': 0.3710206140074387, 'recall': 0.0957996598058126, 'f1-score': 0.15227979844369555, 'support': 122871}, '1': {'precision': 0.3298312373143761, 'recall': 0.8035567358842554, 'f1-score': 0.46769176789659855, 'support': 122753}, '2': {'precision': 0.36353732933088023, 'recall': 0.11874056092797444, 'f1-score': 0.17901142588078223, 'support': 126469}, 'accuracy': 0.33708508356781774, 'macro avg': {'precision': 0.35479639355089826, 'recall': 0.33936565220601417, 'f1-score': 0.26632766407369207, 'support': 372093}, 'weighted avg': {'precision': 0.3548888322029887, 'recall': 0.33708508356781774, 'f1-score': 0.26541949114577035, 'support': 372093}}
[[ 11771  98465  12635]
 [ 10458  98639  13656]
 [  9497 101955  15017]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018898
{'0': {'precision': 0.3682578107269839, 'recall': 0.09769803520179822, 'f1-score': 0.15442692637122102, 'support': 49827}, '1': {'precision': 0.299819083955792, 'recall': 0.7820764414540697, 'f1-score': 0.43346411322171724, 'support': 42804}, '2': {'precision': 0.3695044762502138, 'recall': 0.13017537515819924, 'f1-score': 0.19252480836651018, 'support': 49779}, 'accuracy': 0.3147531774454041, 'macro avg': {'precision': 0.34586045697766327, 'recall': 0.3366499506046891, 'f1-score': 0.2601386159864828, 'support': 142410}, 'weighted avg': {'precision': 0.3481230343936279, 'recall': 0.3147531774454041, 'f1-score': 0.25161379677212076, 'support': 142410}}
[[ 4868 39031  5928]
 [ 4199 33476  5129]
 [ 4152 39147  6480]]
training model: results/WBA/W0/deepOF_L1/h1000
Epoch 1/50
1454/1454 - 34s - loss: 3.3238 - accuracy1000: 0.3451 - val_loss: 3.3012 - val_accuracy1000: 0.3369 - 34s/epoch - 23ms/step
Epoch 2/50
1454/1454 - 32s - loss: 3.3055 - accuracy1000: 0.3446 - val_loss: 3.3004 - val_accuracy1000: 0.3306 - 32s/epoch - 22ms/step
Epoch 3/50
1454/1454 - 32s - loss: 3.3000 - accuracy1000: 0.3446 - val_loss: 3.2999 - val_accuracy1000: 0.3270 - 32s/epoch - 22ms/step
Epoch 4/50
1454/1454 - 32s - loss: 3.2968 - accuracy1000: 0.3453 - val_loss: 3.2987 - val_accuracy1000: 0.3302 - 32s/epoch - 22ms/step
Epoch 5/50
1454/1454 - 31s - loss: 3.2954 - accuracy1000: 0.3472 - val_loss: 3.2991 - val_accuracy1000: 0.3287 - 31s/epoch - 21ms/step
Epoch 6/50
1454/1454 - 31s - loss: 3.2946 - accuracy1000: 0.3475 - val_loss: 3.2981 - val_accuracy1000: 0.3296 - 31s/epoch - 22ms/step
Epoch 7/50
1454/1454 - 31s - loss: 3.2934 - accuracy1000: 0.3494 - val_loss: 3.2988 - val_accuracy1000: 0.3289 - 31s/epoch - 21ms/step
Epoch 8/50
1454/1454 - 32s - loss: 3.2931 - accuracy1000: 0.3500 - val_loss: 3.2990 - val_accuracy1000: 0.3293 - 32s/epoch - 22ms/step
Epoch 9/50
1454/1454 - 31s - loss: 3.2922 - accuracy1000: 0.3510 - val_loss: 3.2989 - val_accuracy1000: 0.3298 - 31s/epoch - 21ms/step
Epoch 10/50
1454/1454 - 30s - loss: 3.2917 - accuracy1000: 0.3516 - val_loss: 3.2993 - val_accuracy1000: 0.3289 - 30s/epoch - 21ms/step
Epoch 11/50
1454/1454 - 31s - loss: 3.2910 - accuracy1000: 0.3530 - val_loss: 3.2993 - val_accuracy1000: 0.3293 - 31s/epoch - 21ms/step
Epoch 12/50
1454/1454 - 30s - loss: 3.2900 - accuracy1000: 0.3552 - val_loss: 3.2997 - val_accuracy1000: 0.3307 - 30s/epoch - 21ms/step
Epoch 13/50
1454/1454 - 30s - loss: 3.2895 - accuracy1000: 0.3559 - val_loss: 3.3001 - val_accuracy1000: 0.3299 - 30s/epoch - 21ms/step
Epoch 14/50
1454/1454 - 30s - loss: 3.2888 - accuracy1000: 0.3564 - val_loss: 3.3006 - val_accuracy1000: 0.3288 - 30s/epoch - 21ms/step
Epoch 15/50
1454/1454 - 30s - loss: 3.2884 - accuracy1000: 0.3565 - val_loss: 3.3008 - val_accuracy1000: 0.3301 - 30s/epoch - 20ms/step
Epoch 16/50
1454/1454 - 30s - loss: 3.2876 - accuracy1000: 0.3584 - val_loss: 3.3015 - val_accuracy1000: 0.3296 - 30s/epoch - 21ms/step
testing model: results/WBA/W0/deepOF_L1/h1000
Evaluating performance on  test set...
5633/5633 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0950106
{'0': {'precision': 0.286180121191609, 'recall': 0.11033930673117702, 'f1-score': 0.15927046166663647, 'support': 398489}, '1': {'precision': 0.4091234348642428, 'recall': 0.7768514633023798, 'f1-score': 0.5359778517014276, 'support': 590992}, '2': {'precision': 0.32539563014680634, 'recall': 0.11941248773068522, 'f1-score': 0.17471039817319992, 'support': 452348}, 'accuracy': 0.3863828512257695, 'macro avg': {'precision': 0.3402330620675527, 'recall': 0.3355344192547473, 'f1-score': 0.2899862371804213, 'support': 1441829}, 'weighted avg': {'precision': 0.3488765795641918, 'recall': 0.3863828512257695, 'f1-score': 0.318523242856578, 'support': 1441829}}
[[ 43969 310335  44185]
 [ 64079 459113  67800]
 [ 45593 352739  54016]]
Evaluating performance on  train set...
1454/1454 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985569
{'0': {'precision': 0.34902351361884554, 'recall': 0.13142125730684254, 'f1-score': 0.19094435725073294, 'support': 122659}, '1': {'precision': 0.3313226813564476, 'recall': 0.7627509075813568, 'f1-score': 0.46197381686596123, 'support': 122854}, '2': {'precision': 0.3583797585886722, 'recall': 0.12197029546531837, 'f1-score': 0.18199929270305318, 'support': 126580}, 'accuracy': 0.33665239604077474, 'macro avg': {'precision': 0.3462419845213218, 'recall': 0.33871415345117256, 'f1-score': 0.2783058222732491, 'support': 372093}, 'weighted avg': {'precision': 0.34636206995157964, 'recall': 0.33665239604077474, 'f1-score': 0.277387227611433, 'support': 372093}}
[[16120 92859 13680]
 [15186 93707 13961]
 [14880 96261 15439]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993141
{'0': {'precision': 0.34935541231384754, 'recall': 0.1288451685623527, 'f1-score': 0.18825889715680258, 'support': 48795}, '1': {'precision': 0.3233538001523258, 'recall': 0.7429515846782034, 'f1-score': 0.45059552667094693, 'support': 46287}, '2': {'precision': 0.3377069146874827, 'recall': 0.12888776200135227, 'f1-score': 0.18657001728066555, 'support': 47328}, 'accuracy': 0.32846008005055827, 'macro avg': {'precision': 0.3368053757178853, 'recall': 0.33356150508063614, 'f1-score': 0.27514148036947167, 'support': 142410}, 'weighted avg': {'precision': 0.3370329860953169, 'recall': 0.32846008005055827, 'f1-score': 0.27296393376619366, 'support': 142410}}
[[ 6287 36519  5989]
 [ 5924 34389  5974]
 [ 5785 35443  6100]]
training model: results/WBA/W0/deepLOB_L2/h10
Epoch 1/50
1454/1454 - 70s - loss: 3.1590 - accuracy10: 0.4198 - val_loss: 3.1062 - val_accuracy10: 0.3441 - 70s/epoch - 48ms/step
Epoch 2/50
1454/1454 - 66s - loss: 3.0548 - accuracy10: 0.4470 - val_loss: 3.1502 - val_accuracy10: 0.4317 - 66s/epoch - 46ms/step
Epoch 3/50
1454/1454 - 67s - loss: 3.0218 - accuracy10: 0.4598 - val_loss: 3.0652 - val_accuracy10: 0.5312 - 67s/epoch - 46ms/step
Epoch 4/50
1454/1454 - 67s - loss: 2.9964 - accuracy10: 0.4715 - val_loss: 3.2086 - val_accuracy10: 0.5578 - 67s/epoch - 46ms/step
Epoch 5/50
1454/1454 - 67s - loss: 2.9768 - accuracy10: 0.4803 - val_loss: 3.1930 - val_accuracy10: 0.5589 - 67s/epoch - 46ms/step
Epoch 6/50
1454/1454 - 67s - loss: 2.9599 - accuracy10: 0.4884 - val_loss: 3.2613 - val_accuracy10: 0.5620 - 67s/epoch - 46ms/step
Epoch 7/50
1454/1454 - 67s - loss: 2.9440 - accuracy10: 0.4939 - val_loss: 3.2748 - val_accuracy10: 0.5612 - 67s/epoch - 46ms/step
Epoch 8/50
1454/1454 - 67s - loss: 2.9291 - accuracy10: 0.5002 - val_loss: 3.1991 - val_accuracy10: 0.5586 - 67s/epoch - 46ms/step
Epoch 9/50
1454/1454 - 67s - loss: 2.9164 - accuracy10: 0.5047 - val_loss: 3.2656 - val_accuracy10: 0.5606 - 67s/epoch - 46ms/step
Epoch 10/50
1454/1454 - 67s - loss: 2.9045 - accuracy10: 0.5092 - val_loss: 3.2333 - val_accuracy10: 0.5599 - 67s/epoch - 46ms/step
Epoch 11/50
1454/1454 - 67s - loss: 2.8926 - accuracy10: 0.5121 - val_loss: 3.2736 - val_accuracy10: 0.5564 - 67s/epoch - 46ms/step
Epoch 12/50
1454/1454 - 67s - loss: 2.8825 - accuracy10: 0.5154 - val_loss: 3.3657 - val_accuracy10: 0.5599 - 67s/epoch - 46ms/step
Epoch 13/50
1454/1454 - 67s - loss: 2.8709 - accuracy10: 0.5184 - val_loss: 3.3372 - val_accuracy10: 0.5627 - 67s/epoch - 46ms/step
testing model: results/WBA/W0/deepLOB_L2/h10
Evaluating performance on  test set...
5633/5633 - 96s - 96s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0329009
{'0': {'precision': 0.25023316019183856, 'recall': 0.6544532840284197, 'f1-score': 0.362039056750777, 'support': 230403}, '1': {'precision': 0.7886128903701823, 'recall': 0.36136199246896844, 'f1-score': 0.49561904282172264, 'support': 980211}, '2': {'precision': 0.2954340954710103, 'recall': 0.49842141683245395, 'f1-score': 0.3709760231254436, 'support': 231220}, 'accuracy': 0.4301771216381359, 'macro avg': {'precision': 0.44476004867767704, 'recall': 0.5047455644432807, 'f1-score': 0.40954470756598105, 'support': 1441834}, 'weighted avg': {'precision': 0.6234918667787928, 'recall': 0.4301771216381359, 'f1-score': 0.45428475014664504, 'support': 1441834}}
[[150788  45048  34567]
 [385725 354211 240275]
 [ 66077  49898 115245]]
Evaluating performance on  train set...
1454/1454 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0011145
{'0': {'precision': 0.37345353675450765, 'recall': 0.31443485572150925, 'f1-score': 0.3414123867548326, 'support': 85633}, '1': {'precision': 0.6018172655045654, 'recall': 0.6063380176520661, 'f1-score': 0.6040691835596057, 'support': 200883}, '2': {'precision': 0.35506080755714475, 'recall': 0.40494747543205695, 'f1-score': 0.378366870107325, 'support': 85579}, 'accuracy': 0.49284188177750304, 'macro avg': {'precision': 0.44344386993873924, 'recall': 0.4419067829352108, 'f1-score': 0.4412828134739211, 'support': 372095}, 'weighted avg': {'precision': 0.4925101205584199, 'recall': 0.49284188177750304, 'f1-score': 0.4917122108410369, 'support': 372095}}
[[ 26926  40476  18231]
 [ 34363 121803  44717]
 [ 10811  40113  34655]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9679223
{'0': {'precision': 0.40677871461276455, 'recall': 0.23484848484848486, 'f1-score': 0.2977784136197347, 'support': 31020}, '1': {'precision': 0.6311045106030255, 'recall': 0.684989191418111, 'f1-score': 0.6569437537075097, 'support': 80029}, '2': {'precision': 0.36376195536663125, 'recall': 0.43657929978955423, 'f1-score': 0.39685806208515695, 'support': 31362}, 'accuracy': 0.5322341673044919, 'macro avg': {'precision': 0.46721506019414044, 'recall': 0.45213899201871666, 'f1-score': 0.4505267431374671, 'support': 142411}, 'weighted avg': {'precision': 0.5233671630038815, 'recall': 0.5322341673044919, 'f1-score': 0.5214337417689444, 'support': 142411}}
[[ 7285 16576  7159]
 [ 8421 54819 16789]
 [ 2203 15467 13692]]
training model: results/WBA/W0/deepLOB_L2/h20
Epoch 1/50
1454/1454 - 70s - loss: 3.1966 - accuracy20: 0.4276 - val_loss: 3.1864 - val_accuracy20: 0.3597 - 70s/epoch - 48ms/step
Epoch 2/50
1454/1454 - 67s - loss: 3.1021 - accuracy20: 0.4569 - val_loss: 3.1404 - val_accuracy20: 0.4672 - 67s/epoch - 46ms/step
Epoch 3/50
1454/1454 - 67s - loss: 3.0699 - accuracy20: 0.4697 - val_loss: 3.2053 - val_accuracy20: 0.4749 - 67s/epoch - 46ms/step
Epoch 4/50
1454/1454 - 67s - loss: 3.0480 - accuracy20: 0.4771 - val_loss: 3.2139 - val_accuracy20: 0.4756 - 67s/epoch - 46ms/step
Epoch 5/50
1454/1454 - 67s - loss: 3.0305 - accuracy20: 0.4837 - val_loss: 3.1927 - val_accuracy20: 0.4780 - 67s/epoch - 46ms/step
Epoch 6/50
1454/1454 - 66s - loss: 3.0167 - accuracy20: 0.4883 - val_loss: 3.2264 - val_accuracy20: 0.4807 - 66s/epoch - 46ms/step
Epoch 7/50
1454/1454 - 67s - loss: 3.0041 - accuracy20: 0.4928 - val_loss: 3.2213 - val_accuracy20: 0.4828 - 67s/epoch - 46ms/step
Epoch 8/50
1454/1454 - 66s - loss: 2.9936 - accuracy20: 0.4966 - val_loss: 3.1964 - val_accuracy20: 0.4844 - 66s/epoch - 46ms/step
Epoch 9/50
1454/1454 - 67s - loss: 2.9806 - accuracy20: 0.5000 - val_loss: 3.2147 - val_accuracy20: 0.4815 - 67s/epoch - 46ms/step
Epoch 10/50
1454/1454 - 67s - loss: 2.9705 - accuracy20: 0.5019 - val_loss: 3.2270 - val_accuracy20: 0.4871 - 67s/epoch - 46ms/step
Epoch 11/50
1454/1454 - 67s - loss: 2.9611 - accuracy20: 0.5042 - val_loss: 3.2292 - val_accuracy20: 0.4789 - 67s/epoch - 46ms/step
Epoch 12/50
1454/1454 - 67s - loss: 2.9537 - accuracy20: 0.5060 - val_loss: 3.1931 - val_accuracy20: 0.4858 - 67s/epoch - 46ms/step
testing model: results/WBA/W0/deepLOB_L2/h20
Evaluating performance on  test set...
5633/5633 - 95s - 95s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9826632
{'0': {'precision': 0.3785654671314252, 'recall': 0.38879252969767863, 'f1-score': 0.38361084716756794, 'support': 297498}, '1': {'precision': 0.687421095067845, 'recall': 0.6129999290461436, 'f1-score': 0.6480810055935767, 'support': 845620}, '2': {'precision': 0.34976597676249976, 'recall': 0.44754884237871423, 'f1-score': 0.3926613534466174, 'support': 298716}, 'accuracy': 0.5324607409729553, 'macro avg': {'precision': 0.4719175129872566, 'recall': 0.48311376704084547, 'f1-score': 0.47478440206925404, 'support': 1441834}, 'weighted avg': {'precision': 0.5537393273195962, 'recall': 0.5324607409729553, 'f1-score': 0.5405947901192906, 'support': 1441834}}
[[115665 123464  58369]
 [137087 518365 190168]
 [ 52783 112243 133690]]
Evaluating performance on  train set...
1454/1454 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0447648
{'0': {'precision': 0.42667082142228124, 'recall': 0.2937423633328048, 'f1-score': 0.34794281421248013, 'support': 107213}, '1': {'precision': 0.4881292409868186, 'recall': 0.5806322554423756, 'f1-score': 0.5303776063948581, 'support': 157468}, '2': {'precision': 0.4075963054742059, 'recall': 0.42110898020742177, 'f1-score': 0.4142424755825614, 'support': 107414}, 'accuracy': 0.4519195366774614, 'macro avg': {'precision': 0.4407987892944352, 'recall': 0.43182786632753406, 'f1-score': 0.43085429872996656, 'support': 372095}, 'weighted avg': {'precision': 0.44717328545953516, 'recall': 0.4519195366774614, 'f1-score': 0.4442869029042943, 'support': 372095}}
[[31493 50011 25709]
 [26004 91431 40033]
 [16314 45867 45233]]
Evaluating performance on  val set...
557/557 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.027543
{'0': {'precision': 0.41540368696764907, 'recall': 0.2668584786908829, 'f1-score': 0.3249601151187162, 'support': 38927}, '1': {'precision': 0.5092613036971615, 'recall': 0.6541146071310403, 'f1-score': 0.5726700277948286, 'support': 63469}, '2': {'precision': 0.4061089125466808, 'recall': 0.36416343871048357, 'f1-score': 0.38399409726339645, 'support': 40015}, 'accuracy': 0.4667897844969841, 'macro avg': {'precision': 0.4435913010704971, 'recall': 0.42837884151080224, 'f1-score': 0.42720808005898037, 'support': 142411}, 'weighted avg': {'precision': 0.454621996492548, 'recall': 0.4667897844969841, 'f1-score': 0.45194570782686067, 'support': 142411}}
[[10388 20240  8299]
 [ 8942 41516 13011]
 [ 5677 19766 14572]]
training model: results/WBA/W0/deepLOB_L2/h30
Epoch 1/50
1454/1454 - 69s - loss: 3.2214 - accuracy30: 0.4171 - val_loss: 3.3205 - val_accuracy30: 0.4070 - 69s/epoch - 48ms/step
Epoch 2/50
1454/1454 - 67s - loss: 3.1345 - accuracy30: 0.4534 - val_loss: 3.1836 - val_accuracy30: 0.4420 - 67s/epoch - 46ms/step
Epoch 3/50
1454/1454 - 66s - loss: 3.1022 - accuracy30: 0.4635 - val_loss: 3.2092 - val_accuracy30: 0.4362 - 66s/epoch - 46ms/step
Epoch 4/50
1454/1454 - 67s - loss: 3.0868 - accuracy30: 0.4704 - val_loss: 3.3244 - val_accuracy30: 0.4044 - 67s/epoch - 46ms/step
Epoch 5/50
1454/1454 - 67s - loss: 3.0747 - accuracy30: 0.4741 - val_loss: 3.4378 - val_accuracy30: 0.3971 - 67s/epoch - 46ms/step
Epoch 6/50
1454/1454 - 67s - loss: 3.0611 - accuracy30: 0.4789 - val_loss: 3.6859 - val_accuracy30: 0.3952 - 67s/epoch - 46ms/step
Epoch 7/50
1454/1454 - 67s - loss: 3.0506 - accuracy30: 0.4821 - val_loss: 3.7986 - val_accuracy30: 0.3946 - 67s/epoch - 46ms/step
Epoch 8/50
1454/1454 - 66s - loss: 3.0413 - accuracy30: 0.4846 - val_loss: 3.8465 - val_accuracy30: 0.3916 - 66s/epoch - 46ms/step
Epoch 9/50
1454/1454 - 67s - loss: 3.0335 - accuracy30: 0.4871 - val_loss: 3.9089 - val_accuracy30: 0.3945 - 67s/epoch - 46ms/step
Epoch 10/50
1454/1454 - 67s - loss: 3.0248 - accuracy30: 0.4897 - val_loss: 3.9165 - val_accuracy30: 0.3939 - 67s/epoch - 46ms/step
Epoch 11/50
1454/1454 - 67s - loss: 3.0178 - accuracy30: 0.4912 - val_loss: 3.8471 - val_accuracy30: 0.3957 - 67s/epoch - 46ms/step
Epoch 12/50
1454/1454 - 67s - loss: 3.0119 - accuracy30: 0.4926 - val_loss: 3.9087 - val_accuracy30: 0.3962 - 67s/epoch - 46ms/step
testing model: results/WBA/W0/deepLOB_L2/h30
Evaluating performance on  test set...
5633/5633 - 96s - 96s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.062273
{'0': {'precision': 0.2852699605699563, 'recall': 0.7035395511712202, 'f1-score': 0.40594006760435, 'support': 341823}, '1': {'precision': 0.6038244629692564, 'recall': 0.3600680808227978, 'f1-score': 0.4511248000318621, 'support': 754985}, '2': {'precision': 0.41536184099855333, 'recall': 0.1789111545216882, 'f1-score': 0.2500967302148728, 'support': 345026}, 'accuracy': 0.39814638855790613, 'macro avg': {'precision': 0.434818754845922, 'recall': 0.4141729288385687, 'f1-score': 0.36905386595036155, 'support': 1441834}, 'weighted avg': {'precision': 0.4832046410745725, 'recall': 0.39814638855790613, 'f1-score': 0.39230728594269093, 'support': 1441834}}
[[240486  67224  34113]
 [430366 271846  52773]
 [172160 111137  61729]]
Evaluating performance on  train set...
1454/1454 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1025958
{'0': {'precision': 0.4179592645819912, 'recall': 0.2797717773502289, 'f1-score': 0.3351813214108296, 'support': 120584}, '1': {'precision': 0.38455655521469756, 'recall': 0.687133896834719, 'f1-score': 0.4931309107638229, 'support': 130257}, '2': {'precision': 0.41734176999300737, 'recall': 0.2018077754135946, 'f1-score': 0.27205968191142216, 'support': 121254}, 'accuracy': 0.3969685161047582, 'macro avg': {'precision': 0.40661919659656537, 'recall': 0.38957114986618085, 'f1-score': 0.3667906380286916, 'support': 372095}, 'weighted avg': {'precision': 0.4060649623125487, 'recall': 0.3969685161047582, 'f1-score': 0.36990441197773244, 'support': 372095}}
[[33736 68575 18273]
 [24863 89504 15890]
 [22117 74667 24470]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0577742
{'0': {'precision': 0.4542701191506357, 'recall': 0.30987354416872886, 'f1-score': 0.3684288664246285, 'support': 44047}, '1': {'precision': 0.44181161556603776, 'recall': 0.6828485722964763, 'f1-score': 0.5365005966587113, 'support': 52672}, '2': {'precision': 0.4308234002002778, 'recall': 0.29188917097084827, 'f1-score': 0.3480019308797244, 'support': 45692}, 'accuracy': 0.4420515269185667, 'macro avg': {'precision': 0.44230171163898374, 'recall': 0.42820376247868447, 'f1-score': 0.4176437979876881, 'support': 142411}, 'weighted avg': {'precision': 0.4421394425660482, 'recall': 0.4420515269185667, 'f1-score': 0.42403781963731474, 'support': 142411}}
[[13649 20808  9590]
 [ 8675 35967  8030]
 [ 7722 24633 13337]]
training model: results/WBA/W0/deepLOB_L2/h50
Epoch 1/50
1454/1454 - 70s - loss: 3.2465 - accuracy50: 0.4038 - val_loss: 3.2917 - val_accuracy50: 0.3824 - 70s/epoch - 48ms/step
Epoch 2/50
1454/1454 - 67s - loss: 3.1820 - accuracy50: 0.4316 - val_loss: 3.1886 - val_accuracy50: 0.4253 - 67s/epoch - 46ms/step
Epoch 3/50
1454/1454 - 67s - loss: 3.1506 - accuracy50: 0.4458 - val_loss: 3.1861 - val_accuracy50: 0.4268 - 67s/epoch - 46ms/step
Epoch 4/50
1454/1454 - 67s - loss: 3.1386 - accuracy50: 0.4510 - val_loss: 3.2143 - val_accuracy50: 0.4232 - 67s/epoch - 46ms/step
Epoch 5/50
1454/1454 - 66s - loss: 3.1280 - accuracy50: 0.4549 - val_loss: 3.1982 - val_accuracy50: 0.4314 - 66s/epoch - 46ms/step
Epoch 6/50
1454/1454 - 66s - loss: 3.1196 - accuracy50: 0.4568 - val_loss: 3.1953 - val_accuracy50: 0.4337 - 66s/epoch - 46ms/step
Epoch 7/50
1454/1454 - 67s - loss: 3.1108 - accuracy50: 0.4605 - val_loss: 3.2224 - val_accuracy50: 0.4280 - 67s/epoch - 46ms/step
Epoch 8/50
1454/1454 - 67s - loss: 3.1035 - accuracy50: 0.4635 - val_loss: 3.2168 - val_accuracy50: 0.4303 - 67s/epoch - 46ms/step
Epoch 9/50
1454/1454 - 67s - loss: 3.0959 - accuracy50: 0.4661 - val_loss: 3.2531 - val_accuracy50: 0.4273 - 67s/epoch - 46ms/step
Epoch 10/50
1454/1454 - 66s - loss: 3.0896 - accuracy50: 0.4678 - val_loss: 3.2534 - val_accuracy50: 0.4279 - 66s/epoch - 46ms/step
Epoch 11/50
1454/1454 - 67s - loss: 3.0832 - accuracy50: 0.4696 - val_loss: 3.3571 - val_accuracy50: 0.4087 - 67s/epoch - 46ms/step
Epoch 12/50
1454/1454 - 67s - loss: 3.0768 - accuracy50: 0.4716 - val_loss: 3.3600 - val_accuracy50: 0.4070 - 67s/epoch - 46ms/step
Epoch 13/50
1454/1454 - 67s - loss: 3.0715 - accuracy50: 0.4731 - val_loss: 3.3884 - val_accuracy50: 0.4051 - 67s/epoch - 46ms/step
testing model: results/WBA/W0/deepLOB_L2/h50
Evaluating performance on  test set...
5633/5633 - 96s - 96s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0203446
{'0': {'precision': 0.37796267203988937, 'recall': 0.4995824446174854, 'f1-score': 0.4303448611077357, 'support': 354444}, '1': {'precision': 0.6011355311851311, 'recall': 0.61795095578727, 'f1-score': 0.6094272720159349, 'support': 718413}, '2': {'precision': 0.37187485361688716, 'recall': 0.23667328857896291, 'f1-score': 0.28925515811369873, 'support': 368977}, 'accuracy': 0.49128054963331425, 'macro avg': {'precision': 0.4503243522806359, 'recall': 0.45140222966123944, 'f1-score': 0.4430090970791231, 'support': 1441834}, 'weighted avg': {'precision': 0.487603600384516, 'recall': 0.49128054963331425, 'f1-score': 0.48346906037489223, 'support': 1441834}}
[[177074 118846  58524]
 [185491 443944  88978]
 [105931 175719  87327]]
Evaluating performance on  train set...
1454/1454 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0744288
{'0': {'precision': 0.43002668991844156, 'recall': 0.32739386677892557, 'f1-score': 0.37175674619772303, 'support': 123524}, '1': {'precision': 0.4002258405274469, 'recall': 0.4482494145676776, 'f1-score': 0.4228785639509822, 'support': 122559}, '2': {'precision': 0.40775781854858756, 'recall': 0.4555677237088531, 'f1-score': 0.4303389442988917, 'support': 126012}, 'accuracy': 0.4106075061476236, 'macro avg': {'precision': 0.41267011633149203, 'recall': 0.4104036683518188, 'f1-score': 0.40832475148253233, 'support': 372095}, 'weighted avg': {'precision': 0.41266954370693926, 'recall': 0.4106075061476236, 'f1-score': 0.40843420439830663, 'support': 372095}}
[[40441 39429 43654]
 [27896 54937 39726]
 [25706 42899 57407]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0614028
{'0': {'precision': 0.43838943331913083, 'recall': 0.22463103659069078, 'f1-score': 0.2970522851286197, 'support': 45804}, '1': {'precision': 0.4349404424276801, 'recall': 0.4788110898343185, 'f1-score': 0.45582261675946656, 'support': 48044}, '2': {'precision': 0.418101164251866, 'recall': 0.5686633857051665, 'f1-score': 0.4818957544453557, 'support': 48563}, 'accuracy': 0.427698703049624, 'macro avg': {'precision': 0.4304770133328923, 'recall': 0.42403517071005864, 'f1-score': 0.411590218777814, 'support': 142411}, 'weighted avg': {'precision': 0.43030745559899375, 'recall': 0.427698703049624, 'f1-score': 0.4136480201020491, 'support': 142411}}
[[10289 14556 20959]
 [ 7564 23004 17476]
 [ 5617 15330 27616]]
training model: results/WBA/W0/deepLOB_L2/h100
Epoch 1/50
1454/1454 - 69s - loss: 3.2817 - accuracy100: 0.3829 - val_loss: 3.3040 - val_accuracy100: 0.3532 - 69s/epoch - 48ms/step
Epoch 2/50
1454/1454 - 66s - loss: 3.2438 - accuracy100: 0.4009 - val_loss: 3.3077 - val_accuracy100: 0.3756 - 66s/epoch - 46ms/step
Epoch 3/50
1454/1454 - 67s - loss: 3.2188 - accuracy100: 0.4142 - val_loss: 3.3223 - val_accuracy100: 0.3767 - 67s/epoch - 46ms/step
Epoch 4/50
1454/1454 - 68s - loss: 3.2039 - accuracy100: 0.4215 - val_loss: 3.2989 - val_accuracy100: 0.3832 - 68s/epoch - 46ms/step
Epoch 5/50
1454/1454 - 68s - loss: 3.1964 - accuracy100: 0.4255 - val_loss: 3.2916 - val_accuracy100: 0.3825 - 68s/epoch - 47ms/step
Epoch 6/50
1454/1454 - 67s - loss: 3.1883 - accuracy100: 0.4288 - val_loss: 3.2863 - val_accuracy100: 0.3855 - 67s/epoch - 46ms/step
Epoch 7/50
1454/1454 - 66s - loss: 3.1819 - accuracy100: 0.4313 - val_loss: 3.2878 - val_accuracy100: 0.3853 - 66s/epoch - 45ms/step
Epoch 8/50
1454/1454 - 66s - loss: 3.1768 - accuracy100: 0.4340 - val_loss: 3.3093 - val_accuracy100: 0.3777 - 66s/epoch - 45ms/step
Epoch 9/50
1454/1454 - 66s - loss: 3.1717 - accuracy100: 0.4356 - val_loss: 3.3002 - val_accuracy100: 0.3767 - 66s/epoch - 45ms/step
Epoch 10/50
1454/1454 - 66s - loss: 3.1670 - accuracy100: 0.4382 - val_loss: 3.2935 - val_accuracy100: 0.3794 - 66s/epoch - 45ms/step
Epoch 11/50
1454/1454 - 66s - loss: 3.1618 - accuracy100: 0.4399 - val_loss: 3.3130 - val_accuracy100: 0.3737 - 66s/epoch - 45ms/step
Epoch 12/50
1454/1454 - 66s - loss: 3.1580 - accuracy100: 0.4405 - val_loss: 3.2948 - val_accuracy100: 0.3712 - 66s/epoch - 46ms/step
Epoch 13/50
1454/1454 - 66s - loss: 3.1534 - accuracy100: 0.4435 - val_loss: 3.3593 - val_accuracy100: 0.3561 - 66s/epoch - 45ms/step
Epoch 14/50
1454/1454 - 66s - loss: 3.1489 - accuracy100: 0.4450 - val_loss: 3.3968 - val_accuracy100: 0.3476 - 66s/epoch - 45ms/step
Epoch 15/50
1454/1454 - 66s - loss: 3.1438 - accuracy100: 0.4467 - val_loss: 3.4110 - val_accuracy100: 0.3441 - 66s/epoch - 45ms/step
Epoch 16/50
1454/1454 - 66s - loss: 3.1402 - accuracy100: 0.4484 - val_loss: 3.4306 - val_accuracy100: 0.3440 - 66s/epoch - 45ms/step
testing model: results/WBA/W0/deepLOB_L2/h100
Evaluating performance on  test set...
5633/5633 - 93s - 93s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0686086
{'0': {'precision': 0.35834627166296, 'recall': 0.09461121297563191, 'f1-score': 0.14969870938054647, 'support': 361046}, '1': {'precision': 0.5169437193349323, 'recall': 0.8359239452508621, 'f1-score': 0.6388291251996393, 'support': 700285}, '2': {'precision': 0.33441531146959097, 'recall': 0.18817985666341658, 'f1-score': 0.24083737935511432, 'support': 380503}, 'accuracy': 0.4793526855380023, 'macro avg': {'precision': 0.4032351008224944, 'recall': 0.37290500496330353, 'f1-score': 0.3431217379784334, 'support': 1441834}, 'weighted avg': {'precision': 0.42906010660963884, 'recall': 0.4793526855380023, 'f1-score': 0.41131636479941325, 'support': 1441834}}
[[ 34159 261963  64924]
 [ 37313 585385  77587]
 [ 23852 285048  71603]]
Evaluating performance on  train set...
1454/1454 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1081752
{'0': {'precision': 0.38521331513677093, 'recall': 0.05265334922990827, 'f1-score': 0.09264359614698536, 'support': 123297}, '1': {'precision': 0.3804034090909091, 'recall': 0.5449417625082411, 'f1-score': 0.4480440609116673, 'support': 122859}, '2': {'precision': 0.37266377299963177, 'recall': 0.5303916975678702, 'f1-score': 0.4377533332677984, 'support': 125939}, 'accuracy': 0.3768929977559494, 'macro avg': {'precision': 0.3794268324091039, 'recall': 0.37599560310200647, 'f1-score': 0.3261469967754837, 'support': 372095}, 'weighted avg': {'precision': 0.37937766285953606, 'recall': 0.3768929977559494, 'f1-score': 0.3267959520877589, 'support': 372095}}
[[ 6492 54706 62099]
 [ 5562 66951 50346]
 [ 4799 54343 66797]]
Evaluating performance on  val set...
557/557 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.095601
{'0': {'precision': 0.38922657723747645, 'recall': 0.037819233432446746, 'f1-score': 0.06893991424275611, 'support': 49102}, '1': {'precision': 0.37993927564519625, 'recall': 0.41551634172951946, 'f1-score': 0.3969322095341671, 'support': 42162}, '2': {'precision': 0.38743581339451544, 'recall': 0.693334897452441, 'f1-score': 0.4970948365889387, 'support': 51147}, 'accuracy': 0.3850685691414287, 'macro avg': {'precision': 0.3855338887590627, 'recall': 0.38222349087146906, 'f1-score': 0.32098898678862064, 'support': 142411}, 'weighted avg': {'precision': 0.3858338378563216, 'recall': 0.3850685691414287, 'f1-score': 0.31981696002795995, 'support': 142411}}
[[ 1857 14276 32969]
 [ 1544 17519 23099]
 [ 1370 14315 35462]]
training model: results/WBA/W0/deepLOB_L2/h200
Epoch 1/50
1454/1454 - 69s - loss: 3.3049 - accuracy200: 0.3636 - val_loss: 3.3043 - val_accuracy200: 0.3353 - 69s/epoch - 47ms/step
Epoch 2/50
1454/1454 - 66s - loss: 3.2773 - accuracy200: 0.3734 - val_loss: 3.3165 - val_accuracy200: 0.3595 - 66s/epoch - 45ms/step
Epoch 3/50
1454/1454 - 66s - loss: 3.2603 - accuracy200: 0.3858 - val_loss: 3.3504 - val_accuracy200: 0.3430 - 66s/epoch - 45ms/step
Epoch 4/50
1454/1454 - 66s - loss: 3.2485 - accuracy200: 0.3948 - val_loss: 3.4255 - val_accuracy200: 0.3437 - 66s/epoch - 45ms/step
Epoch 5/50
1454/1454 - 66s - loss: 3.2385 - accuracy200: 0.4009 - val_loss: 3.4388 - val_accuracy200: 0.3440 - 66s/epoch - 45ms/step
Epoch 6/50
1454/1454 - 66s - loss: 3.2313 - accuracy200: 0.4053 - val_loss: 3.4762 - val_accuracy200: 0.3452 - 66s/epoch - 45ms/step
Epoch 7/50
1454/1454 - 66s - loss: 3.2249 - accuracy200: 0.4086 - val_loss: 3.4712 - val_accuracy200: 0.3453 - 66s/epoch - 46ms/step
Epoch 8/50
1454/1454 - 66s - loss: 3.2179 - accuracy200: 0.4123 - val_loss: 3.4992 - val_accuracy200: 0.3450 - 66s/epoch - 45ms/step
Epoch 9/50
1454/1454 - 66s - loss: 3.2108 - accuracy200: 0.4161 - val_loss: 3.5313 - val_accuracy200: 0.3448 - 66s/epoch - 46ms/step
Epoch 10/50
1454/1454 - 66s - loss: 3.2060 - accuracy200: 0.4182 - val_loss: 3.5691 - val_accuracy200: 0.3454 - 66s/epoch - 45ms/step
Epoch 11/50
1454/1454 - 66s - loss: 3.2002 - accuracy200: 0.4206 - val_loss: 3.5699 - val_accuracy200: 0.3449 - 66s/epoch - 46ms/step
testing model: results/WBA/W0/deepLOB_L2/h200
Evaluating performance on  test set...
5633/5633 - 95s - 95s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1052339
{'0': {'precision': 0.2871470282152659, 'recall': 0.612261329652634, 'f1-score': 0.3909437126371533, 'support': 417312}, '1': {'precision': 0.38844079490792477, 'recall': 0.2527820766632295, 'f1-score': 0.3062612865225751, 'support': 569269}, '2': {'precision': 0.3261865685615782, 'recall': 0.13009689117919046, 'f1-score': 0.18600656065147989, 'support': 455253}, 'accuracy': 0.31808932234917475, 'macro avg': {'precision': 0.33392479722825624, 'recall': 0.33171343249835133, 'f1-score': 0.2944038532704028, 'support': 1441834}, 'weighted avg': {'precision': 0.3394666913197862, 'recall': 0.31808932234917475, 'f1-score': 0.29280111558038147, 'support': 1441834}}
[[255504 108698  53110]
 [356131 143901  69237]
 [278167 117859  59227]]
Evaluating performance on  train set...
1454/1454 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.102152
{'0': {'precision': 0.33359889086620037, 'recall': 0.26237071876703744, 'f1-score': 0.29372833567911516, 'support': 122891}, '1': {'precision': 0.3326014599021239, 'recall': 0.6566978446522976, 'f1-score': 0.4415623478969445, 'support': 122950}, '2': {'precision': 0.3511181815400618, 'recall': 0.09090405056473458, 'f1-score': 0.14441836908035055, 'support': 126254}, 'accuracy': 0.33448716053695965, 'macro avg': {'precision': 0.33910617743612875, 'recall': 0.3366575379946899, 'f1-score': 0.29323635088547007, 'support': 372095}, 'weighted avg': {'precision': 0.33921371070442585, 'recall': 0.33448716053695965, 'f1-score': 0.2919148506261628, 'support': 372095}}
[[32243 79890 10758]
 [31757 80741 10452]
 [32652 82125 11477]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1017872
{'0': {'precision': 0.34182799605543157, 'recall': 0.1395043423003601, 'f1-score': 0.19814371888021423, 'support': 47210}, '1': {'precision': 0.3298786462651692, 'recall': 0.7481356439240154, 'f1-score': 0.4578677215810638, 'support': 46799}, '2': {'precision': 0.3587723424270931, 'recall': 0.1260691706954258, 'f1-score': 0.18657697599755388, 'support': 48402}, 'accuracy': 0.33494603647190174, 'macro avg': {'precision': 0.343492994915898, 'recall': 0.33790305230660045, 'f1-score': 0.2808628054862773, 'support': 142411}, 'weighted avg': {'precision': 0.34366017638031293, 'recall': 0.33494603647190174, 'f1-score': 0.27956278140621665, 'support': 142411}}
[[ 6586 35131  5493]
 [ 6374 35012  5413]
 [ 6307 35993  6102]]
training model: results/WBA/W0/deepLOB_L2/h300
Epoch 1/50
1454/1454 - 69s - loss: 3.2885 - accuracy300: 0.3773 - val_loss: 3.3708 - val_accuracy300: 0.3497 - 69s/epoch - 47ms/step
Epoch 2/50
1454/1454 - 66s - loss: 3.2523 - accuracy300: 0.3964 - val_loss: 3.4921 - val_accuracy300: 0.3329 - 66s/epoch - 45ms/step
Epoch 3/50
1454/1454 - 66s - loss: 3.2339 - accuracy300: 0.4094 - val_loss: 3.5486 - val_accuracy300: 0.3320 - 66s/epoch - 45ms/step
Epoch 4/50
1454/1454 - 66s - loss: 3.2240 - accuracy300: 0.4131 - val_loss: 3.6526 - val_accuracy300: 0.3244 - 66s/epoch - 45ms/step
Epoch 5/50
1454/1454 - 66s - loss: 3.2161 - accuracy300: 0.4164 - val_loss: 3.7165 - val_accuracy300: 0.3229 - 66s/epoch - 45ms/step
Epoch 6/50
1454/1454 - 66s - loss: 3.2082 - accuracy300: 0.4204 - val_loss: 3.7559 - val_accuracy300: 0.3226 - 66s/epoch - 45ms/step
Epoch 7/50
1454/1454 - 66s - loss: 3.2017 - accuracy300: 0.4236 - val_loss: 3.7067 - val_accuracy300: 0.3232 - 66s/epoch - 45ms/step
Epoch 8/50
1454/1454 - 66s - loss: 3.1937 - accuracy300: 0.4273 - val_loss: 3.6979 - val_accuracy300: 0.3323 - 66s/epoch - 46ms/step
Epoch 9/50
1454/1454 - 66s - loss: 3.1889 - accuracy300: 0.4300 - val_loss: 3.6466 - val_accuracy300: 0.3371 - 66s/epoch - 45ms/step
Epoch 10/50
1454/1454 - 66s - loss: 3.1844 - accuracy300: 0.4309 - val_loss: 3.6917 - val_accuracy300: 0.3343 - 66s/epoch - 45ms/step
Epoch 11/50
1454/1454 - 66s - loss: 3.1772 - accuracy300: 0.4330 - val_loss: 3.7276 - val_accuracy300: 0.3399 - 66s/epoch - 45ms/step
testing model: results/WBA/W0/deepLOB_L2/h300
Evaluating performance on  test set...
5633/5633 - 94s - 94s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0852717
{'0': {'precision': 0.24720617702648137, 'recall': 0.36625145697875267, 'f1-score': 0.29517807747852975, 'support': 356045}, '1': {'precision': 0.5493266115795775, 'recall': 0.5229358057614891, 'f1-score': 0.5358064399290087, 'support': 707213}, '2': {'precision': 0.35106638904327775, 'recall': 0.22357465872110224, 'f1-score': 0.2731776590766053, 'support': 378576}, 'accuracy': 0.40564239711367606, 'macro avg': {'precision': 0.38253305921644554, 'recall': 0.37092064048711465, 'f1-score': 0.3680540588280479, 'support': 1441834}, 'weighted avg': {'precision': 0.4226649902505207, 'recall': 0.40564239711367606, 'f1-score': 0.4074286387059412, 'support': 1441834}}
[[130402 151626  74017]
 [254949 369827  82437]
 [142152 151784  84640]]
Evaluating performance on  train set...
1454/1454 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1123459
{'0': {'precision': 0.3306228948242326, 'recall': 0.28292817589841024, 'f1-score': 0.3049217481853542, 'support': 123162}, '1': {'precision': 0.38522958066186136, 'recall': 0.15744757037410786, 'f1-score': 0.2235342372372199, 'support': 122879}, '2': {'precision': 0.3554818503496891, 'recall': 0.6104843955764989, 'f1-score': 0.44932444267980803, 'support': 126054}, 'accuracy': 0.35245569007914646, 'macro avg': {'precision': 0.357111441945261, 'recall': 0.35028671394967237, 'f1-score': 0.3259268093674607, 'support': 372095}, 'weighted avg': {'precision': 0.35707739093100077, 'recall': 0.35245569007914646, 'f1-score': 0.3269637570648288, 'support': 372095}}
[[34846 15789 72527]
 [36535 19347 66997]
 [34014 15086 76954]]
Evaluating performance on  val set...
557/557 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1222473
{'0': {'precision': 0.34824056583051444, 'recall': 0.16281219191587248, 'f1-score': 0.22188632769310435, 'support': 48688}, '1': {'precision': 0.30928124123749884, 'recall': 0.07447167645668759, 'f1-score': 0.12003917869839657, 'support': 44433}, '2': {'precision': 0.3522382031959908, 'recall': 0.7785757760194766, 'f1-score': 0.48503845448972754, 'support': 49290}, 'accuracy': 0.34837196564872097, 'macro avg': {'precision': 0.33658667008800136, 'recall': 0.33861988146401223, 'f1-score': 0.27565465362707614, 'support': 142411}, 'weighted avg': {'precision': 0.33746867233986316, 'recall': 0.34837196564872097, 'f1-score': 0.28118928854952485, 'support': 142411}}
[[ 7927  3675 37086]
 [ 7637  3309 33487]
 [ 7199  3715 38376]]
training model: results/WBA/W0/deepLOB_L2/h500
Epoch 1/50
1454/1454 - 69s - loss: 3.2895 - accuracy500: 0.3804 - val_loss: 3.4093 - val_accuracy500: 0.3499 - 69s/epoch - 48ms/step
Epoch 2/50
1454/1454 - 66s - loss: 3.2507 - accuracy500: 0.3994 - val_loss: 3.4227 - val_accuracy500: 0.3547 - 66s/epoch - 45ms/step
Epoch 3/50
1454/1454 - 66s - loss: 3.2302 - accuracy500: 0.4112 - val_loss: 3.5167 - val_accuracy500: 0.3581 - 66s/epoch - 45ms/step
Epoch 4/50
1454/1454 - 66s - loss: 3.1998 - accuracy500: 0.4295 - val_loss: 3.5398 - val_accuracy500: 0.3656 - 66s/epoch - 45ms/step
Epoch 5/50
1454/1454 - 66s - loss: 3.1842 - accuracy500: 0.4358 - val_loss: 3.6412 - val_accuracy500: 0.3630 - 66s/epoch - 45ms/step
Epoch 6/50
1454/1454 - 66s - loss: 3.1734 - accuracy500: 0.4408 - val_loss: 3.5661 - val_accuracy500: 0.3645 - 66s/epoch - 45ms/step
Epoch 7/50
1454/1454 - 65s - loss: 3.1617 - accuracy500: 0.4453 - val_loss: 3.6348 - val_accuracy500: 0.3649 - 65s/epoch - 45ms/step
Epoch 8/50
1454/1454 - 65s - loss: 3.1519 - accuracy500: 0.4488 - val_loss: 3.6993 - val_accuracy500: 0.3621 - 65s/epoch - 45ms/step
Epoch 9/50
1454/1454 - 65s - loss: 3.1420 - accuracy500: 0.4521 - val_loss: 3.7754 - val_accuracy500: 0.3629 - 65s/epoch - 45ms/step
Epoch 10/50
1454/1454 - 66s - loss: 3.1325 - accuracy500: 0.4550 - val_loss: 3.8530 - val_accuracy500: 0.3641 - 66s/epoch - 45ms/step
Epoch 11/50
1454/1454 - 65s - loss: 3.1249 - accuracy500: 0.4573 - val_loss: 3.7674 - val_accuracy500: 0.3599 - 65s/epoch - 45ms/step
testing model: results/WBA/W0/deepLOB_L2/h500
Evaluating performance on  test set...
5633/5633 - 96s - 96s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1237452
{'0': {'precision': 0.24998134359096622, 'recall': 0.6742164832579659, 'f1-score': 0.36473044506206576, 'support': 382570}, '1': {'precision': 0.4878639230426196, 'recall': 0.10774129707878237, 'f1-score': 0.1765031268726664, 'support': 639699}, '2': {'precision': 0.3866542136754681, 'recall': 0.24766365163919773, 'f1-score': 0.3019312547126363, 'support': 419565}, 'accuracy': 0.29876393537674933, 'macro avg': {'precision': 0.374833160103018, 'recall': 0.343207143991982, 'f1-score': 0.28105494221578947, 'support': 1441834}, 'weighted avg': {'precision': 0.39529377271224314, 'recall': 0.29876393537674933, 'f1-score': 0.2629453785999079, 'support': 1441834}}
[[257935  35260  89375]
 [495319  68922  75458]
 [278563  37091 103911]]
Evaluating performance on  train set...
1454/1454 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1378769
{'0': {'precision': 0.3460375216725367, 'recall': 0.36207513707879796, 'f1-score': 0.3538747162490409, 'support': 122922}, '1': {'precision': 0.37355588230541775, 'recall': 0.18837899059693952, 'f1-score': 0.25045635511740655, 'support': 122726}, '2': {'precision': 0.34903379647221444, 'recall': 0.5012376727008153, 'f1-score': 0.4115130147970678, 'support': 126447}, 'accuracy': 0.35207675459224125, 'macro avg': {'precision': 0.356209066816723, 'recall': 0.350563933458851, 'f1-score': 0.3386146953878384, 'support': 372095}, 'weighted avg': {'precision': 0.35613195531616487, 'recall': 0.35207675459224125, 'f1-score': 0.3393517265508762, 'support': 372095}}
[[44507 19089 59326]
 [40726 23119 58881]
 [43386 19681 63380]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1347729
{'0': {'precision': 0.3436384015848604, 'recall': 0.2645011135410606, 'f1-score': 0.2989206838692123, 'support': 49841}, '1': {'precision': 0.3169659915934276, 'recall': 0.07753966955668248, 'f1-score': 0.12459865938151299, 'support': 42791}, '2': {'precision': 0.3533340457362684, 'recall': 0.6642359227786818, 'f1-score': 0.46128949002155434, 'support': 49779}, 'accuracy': 0.34804895689237486, 'macro avg': {'precision': 0.3379794796381855, 'recall': 0.335425568625475, 'f1-score': 0.29493627775742653, 'support': 142411}, 'weighted avg': {'precision': 0.3390130592606687, 'recall': 0.34804895689237486, 'f1-score': 0.30329635043713393, 'support': 142411}}
[[13183  3669 32989]
 [11947  3318 27526]
 [13233  3481 33065]]
training model: results/WBA/W0/deepLOB_L2/h1000
Epoch 1/50
1454/1454 - 69s - loss: 3.2698 - accuracy1000: 0.3961 - val_loss: 3.4767 - val_accuracy1000: 0.3460 - 69s/epoch - 48ms/step
Epoch 2/50
1454/1454 - 67s - loss: 3.2062 - accuracy1000: 0.4205 - val_loss: 3.4259 - val_accuracy1000: 0.3348 - 67s/epoch - 46ms/step
Epoch 3/50
1454/1454 - 65s - loss: 3.1819 - accuracy1000: 0.4284 - val_loss: 3.5561 - val_accuracy1000: 0.3403 - 65s/epoch - 45ms/step
Epoch 4/50
1454/1454 - 66s - loss: 3.1586 - accuracy1000: 0.4382 - val_loss: 3.6156 - val_accuracy1000: 0.3389 - 66s/epoch - 45ms/step
Epoch 5/50
1454/1454 - 66s - loss: 3.1441 - accuracy1000: 0.4456 - val_loss: 3.6439 - val_accuracy1000: 0.3424 - 66s/epoch - 45ms/step
Epoch 6/50
1454/1454 - 66s - loss: 3.1309 - accuracy1000: 0.4519 - val_loss: 3.7917 - val_accuracy1000: 0.3388 - 66s/epoch - 45ms/step
Epoch 7/50
1454/1454 - 66s - loss: 3.1203 - accuracy1000: 0.4544 - val_loss: 3.8581 - val_accuracy1000: 0.3365 - 66s/epoch - 45ms/step
Epoch 8/50
1454/1454 - 66s - loss: 3.1087 - accuracy1000: 0.4592 - val_loss: 3.7971 - val_accuracy1000: 0.3347 - 66s/epoch - 45ms/step
Epoch 9/50
1454/1454 - 66s - loss: 3.1016 - accuracy1000: 0.4620 - val_loss: 3.7395 - val_accuracy1000: 0.3359 - 66s/epoch - 45ms/step
Epoch 10/50
1454/1454 - 66s - loss: 3.0908 - accuracy1000: 0.4653 - val_loss: 4.0390 - val_accuracy1000: 0.3427 - 66s/epoch - 45ms/step
Epoch 11/50
1454/1454 - 66s - loss: 3.0868 - accuracy1000: 0.4668 - val_loss: 3.6477 - val_accuracy1000: 0.3357 - 66s/epoch - 45ms/step
Epoch 12/50
1454/1454 - 66s - loss: 3.0782 - accuracy1000: 0.4716 - val_loss: 3.6130 - val_accuracy1000: 0.3391 - 66s/epoch - 45ms/step
testing model: results/WBA/W0/deepLOB_L2/h1000
Evaluating performance on  test set...
5633/5633 - 93s - 93s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1697437
{'0': {'precision': 0.27397044431566914, 'recall': 0.7854129704309507, 'f1-score': 0.406236188871662, 'support': 398491}, '1': {'precision': 0.39703504544074736, 'recall': 0.10844290879925819, 'f1-score': 0.17035613467089838, 'support': 590993}, '2': {'precision': 0.36529280078824017, 'recall': 0.11146457389189787, 'f1-score': 0.17080892104902107, 'support': 452350}, 'accuracy': 0.2964904420342425, 'macro avg': {'precision': 0.34543276351488555, 'recall': 0.3351068177073689, 'f1-score': 0.2491337481971938, 'support': 1441834}, 'weighted avg': {'precision': 0.35306414425829835, 'recall': 0.2964904420342425, 'f1-score': 0.23569021376506613, 'support': 1441834}}
[[312980  46292  39219]
 [478515  64089  48389]
 [350891  51038  50421]]
Evaluating performance on  train set...
1454/1454 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1448313
{'0': {'precision': 0.34792622011136587, 'recall': 0.2770072040942726, 'f1-score': 0.308442677991325, 'support': 122708}, '1': {'precision': 0.3258662315756981, 'recall': 0.24073199335439946, 'f1-score': 0.27690318833519906, 'support': 122788}, '2': {'precision': 0.34261527573629486, 'recall': 0.49712083033831234, 'f1-score': 0.4056540837735144, 'support': 126599}, 'accuracy': 0.33992663163976944, 'macro avg': {'precision': 0.3388025758077862, 'recall': 0.3382866759289948, 'f1-score': 0.3303333167000128, 'support': 372095}, 'weighted avg': {'precision': 0.33883966393819187, 'recall': 0.33992663163976944, 'f1-score': 0.33110945906799366, 'support': 372095}}
[[33991 29514 59203]
 [31677 29559 61552]
 [32028 31636 62935]]
Evaluating performance on  val set...
557/557 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1394367
{'0': {'precision': 0.3900829685764683, 'recall': 0.12232397107327966, 'f1-score': 0.18624454148471617, 'support': 48813}, '1': {'precision': 0.32349368960236574, 'recall': 0.3970702618615504, 'f1-score': 0.3565255347010039, 'support': 46284}, '2': {'precision': 0.33084375400110966, 'recall': 0.4915247072748024, 'f1-score': 0.3954866632088226, 'support': 47314}, 'accuracy': 0.33427895317075224, 'macro avg': {'precision': 0.34814013739331456, 'recall': 0.3369729800698775, 'f1-score': 0.31275224646484756, 'support': 142411}, 'weighted avg': {'precision': 0.3487598798652319, 'recall': 0.33427895317075224, 'f1-score': 0.3111040483857072, 'support': 142411}}
[[ 5971 18814 24028]
 [ 4897 18378 23009]
 [ 4439 19619 23256]]
training model: results/WBA/W0/deepOF_L2/h10
Epoch 1/50
1454/1454 - 42s - loss: 3.1080 - accuracy10: 0.4496 - val_loss: 2.9917 - val_accuracy10: 0.3654 - 42s/epoch - 29ms/step
Epoch 2/50
1454/1454 - 39s - loss: 2.9580 - accuracy10: 0.5002 - val_loss: 2.8722 - val_accuracy10: 0.4851 - 39s/epoch - 27ms/step
Epoch 3/50
1454/1454 - 39s - loss: 2.9022 - accuracy10: 0.5130 - val_loss: 2.8342 - val_accuracy10: 0.5070 - 39s/epoch - 27ms/step
Epoch 4/50
1454/1454 - 39s - loss: 2.8738 - accuracy10: 0.5189 - val_loss: 2.8300 - val_accuracy10: 0.5012 - 39s/epoch - 27ms/step
Epoch 5/50
1454/1454 - 39s - loss: 2.8572 - accuracy10: 0.5224 - val_loss: 2.8072 - val_accuracy10: 0.5198 - 39s/epoch - 27ms/step
Epoch 6/50
1454/1454 - 39s - loss: 2.8424 - accuracy10: 0.5248 - val_loss: 2.7993 - val_accuracy10: 0.5169 - 39s/epoch - 27ms/step
Epoch 7/50
1454/1454 - 39s - loss: 2.8320 - accuracy10: 0.5272 - val_loss: 2.7955 - val_accuracy10: 0.5237 - 39s/epoch - 27ms/step
Epoch 8/50
1454/1454 - 39s - loss: 2.8241 - accuracy10: 0.5291 - val_loss: 2.7848 - val_accuracy10: 0.5231 - 39s/epoch - 27ms/step
Epoch 9/50
1454/1454 - 39s - loss: 2.8158 - accuracy10: 0.5303 - val_loss: 2.7836 - val_accuracy10: 0.5310 - 39s/epoch - 27ms/step
Epoch 10/50
1454/1454 - 39s - loss: 2.8088 - accuracy10: 0.5321 - val_loss: 2.7841 - val_accuracy10: 0.5287 - 39s/epoch - 27ms/step
Epoch 11/50
1454/1454 - 39s - loss: 2.8007 - accuracy10: 0.5334 - val_loss: 2.7793 - val_accuracy10: 0.5258 - 39s/epoch - 27ms/step
Epoch 12/50
1454/1454 - 39s - loss: 2.7951 - accuracy10: 0.5351 - val_loss: 2.7822 - val_accuracy10: 0.5300 - 39s/epoch - 27ms/step
Epoch 13/50
1454/1454 - 39s - loss: 2.7885 - accuracy10: 0.5354 - val_loss: 2.7763 - val_accuracy10: 0.5395 - 39s/epoch - 27ms/step
Epoch 14/50
1454/1454 - 40s - loss: 2.7828 - accuracy10: 0.5372 - val_loss: 2.7711 - val_accuracy10: 0.5289 - 40s/epoch - 27ms/step
Epoch 15/50
1454/1454 - 39s - loss: 2.7761 - accuracy10: 0.5381 - val_loss: 2.7786 - val_accuracy10: 0.5329 - 39s/epoch - 27ms/step
Epoch 16/50
1454/1454 - 39s - loss: 2.7720 - accuracy10: 0.5391 - val_loss: 2.7763 - val_accuracy10: 0.5383 - 39s/epoch - 27ms/step
Epoch 17/50
1454/1454 - 39s - loss: 2.7662 - accuracy10: 0.5405 - val_loss: 2.7746 - val_accuracy10: 0.5391 - 39s/epoch - 27ms/step
Epoch 18/50
1454/1454 - 39s - loss: 2.7630 - accuracy10: 0.5407 - val_loss: 2.7871 - val_accuracy10: 0.5275 - 39s/epoch - 27ms/step
Epoch 19/50
1454/1454 - 39s - loss: 2.7563 - accuracy10: 0.5419 - val_loss: 2.7950 - val_accuracy10: 0.5236 - 39s/epoch - 27ms/step
Epoch 20/50
1454/1454 - 39s - loss: 2.7533 - accuracy10: 0.5430 - val_loss: 2.7902 - val_accuracy10: 0.5304 - 39s/epoch - 27ms/step
Epoch 21/50
1454/1454 - 39s - loss: 2.7479 - accuracy10: 0.5435 - val_loss: 2.7975 - val_accuracy10: 0.5278 - 39s/epoch - 27ms/step
Epoch 22/50
1454/1454 - 40s - loss: 2.7441 - accuracy10: 0.5442 - val_loss: 2.7922 - val_accuracy10: 0.5402 - 40s/epoch - 27ms/step
Epoch 23/50
1454/1454 - 39s - loss: 2.7394 - accuracy10: 0.5450 - val_loss: 2.7929 - val_accuracy10: 0.5266 - 39s/epoch - 27ms/step
Epoch 24/50
1454/1454 - 39s - loss: 2.7360 - accuracy10: 0.5451 - val_loss: 2.7901 - val_accuracy10: 0.5301 - 39s/epoch - 27ms/step
testing model: results/WBA/W0/deepOF_L2/h10
Evaluating performance on  test set...
5633/5633 - 62s - 62s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82660055
{'0': {'precision': 0.3539465675405417, 'recall': 0.5653509952170555, 'f1-score': 0.435341182918963, 'support': 230402}, '1': {'precision': 0.827386161242832, 'recall': 0.6559125085440874, 'f1-score': 0.731737907691117, 'support': 980210}, '2': {'precision': 0.40748915750347936, 'recall': 0.5229805766877003, 'f1-score': 0.4580673755506983, 'support': 231217}, 'accuracy': 0.6201234681782652, 'macro avg': {'precision': 0.529607295428951, 'recall': 0.5814146934829477, 'f1-score': 0.5417154887202594, 'support': 1441829}, 'weighted avg': {'precision': 0.6843950334587487, 'recall': 0.6201234681782652, 'f1-score': 0.6404873657677231, 'support': 1441829}}
[[130258  65246  34898]
 [196349 642932 140929]
 [ 41409  68886 120922]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9591658
{'0': {'precision': 0.39168337100695183, 'recall': 0.5364995910737236, 'f1-score': 0.45279428078392703, 'support': 85590}, '1': {'precision': 0.7143376657381211, 'recall': 0.4884884536379869, 'f1-score': 0.5802097179146359, 'support': 201059}, '2': {'precision': 0.406570841889117, 'recall': 0.5584710453630448, 'f1-score': 0.4705661921690638, 'support': 85444}, 'accuracy': 0.5156022822251426, 'macro avg': {'precision': 0.5041972928780633, 'recall': 0.527819696691585, 'f1-score': 0.5011900636225423, 'support': 372093}, 'weighted avg': {'precision': 0.5694469809281539, 'recall': 0.5156022822251426, 'f1-score': 0.5257236924376126, 'support': 372093}}
[[45919 19976 19695]
 [52890 98215 49954]
 [18426 19300 47718]]
Evaluating performance on  val set...
557/557 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9384451
{'0': {'precision': 0.3791136363636364, 'recall': 0.5395937115869832, 'f1-score': 0.44533732012707905, 'support': 30914}, '1': {'precision': 0.7361833375174838, 'recall': 0.5125407308455786, 'f1-score': 0.6043351856622382, 'support': 80099}, '2': {'precision': 0.41307100647218836, 'recall': 0.561040863776794, 'f1-score': 0.4758174524925379, 'support': 31397}, 'accuracy': 0.5291061020995717, 'macro avg': {'precision': 0.5094559934511028, 'recall': 0.5377251020697852, 'f1-score': 0.5084966527606184, 'support': 142410}, 'weighted avg': {'precision': 0.5874352819083328, 'recall': 0.5291061020995717, 'f1-score': 0.5414861491937109, 'support': 142410}}
[[16681  7687  6546]
 [20562 41054 18483]
 [ 6757  7025 17615]]
training model: results/WBA/W0/deepOF_L2/h20
Epoch 1/50
1454/1454 - 42s - loss: 3.1586 - accuracy20: 0.4379 - val_loss: 3.1067 - val_accuracy20: 0.3733 - 42s/epoch - 29ms/step
Epoch 2/50
1454/1454 - 39s - loss: 3.0335 - accuracy20: 0.4857 - val_loss: 3.0043 - val_accuracy20: 0.4585 - 39s/epoch - 27ms/step
Epoch 3/50
1454/1454 - 39s - loss: 2.9795 - accuracy20: 0.5026 - val_loss: 2.9622 - val_accuracy20: 0.4804 - 39s/epoch - 27ms/step
Epoch 4/50
1454/1454 - 39s - loss: 2.9525 - accuracy20: 0.5089 - val_loss: 2.9603 - val_accuracy20: 0.4769 - 39s/epoch - 27ms/step
Epoch 5/50
1454/1454 - 39s - loss: 2.9381 - accuracy20: 0.5122 - val_loss: 2.9423 - val_accuracy20: 0.4890 - 39s/epoch - 27ms/step
Epoch 6/50
1454/1454 - 39s - loss: 2.9269 - accuracy20: 0.5149 - val_loss: 2.9392 - val_accuracy20: 0.4921 - 39s/epoch - 27ms/step
Epoch 7/50
1454/1454 - 40s - loss: 2.9162 - accuracy20: 0.5175 - val_loss: 2.9430 - val_accuracy20: 0.4861 - 40s/epoch - 27ms/step
Epoch 8/50
1454/1454 - 40s - loss: 2.9097 - accuracy20: 0.5181 - val_loss: 2.9394 - val_accuracy20: 0.4904 - 40s/epoch - 27ms/step
Epoch 9/50
1454/1454 - 40s - loss: 2.9016 - accuracy20: 0.5212 - val_loss: 2.9307 - val_accuracy20: 0.4956 - 40s/epoch - 27ms/step
Epoch 10/50
1454/1454 - 40s - loss: 2.8947 - accuracy20: 0.5221 - val_loss: 2.9280 - val_accuracy20: 0.5016 - 40s/epoch - 28ms/step
Epoch 11/50
1454/1454 - 40s - loss: 2.8880 - accuracy20: 0.5238 - val_loss: 2.9393 - val_accuracy20: 0.4929 - 40s/epoch - 28ms/step
Epoch 12/50
1454/1454 - 39s - loss: 2.8841 - accuracy20: 0.5249 - val_loss: 2.9281 - val_accuracy20: 0.4988 - 39s/epoch - 27ms/step
Epoch 13/50
1454/1454 - 40s - loss: 2.8782 - accuracy20: 0.5263 - val_loss: 2.9274 - val_accuracy20: 0.5022 - 40s/epoch - 27ms/step
Epoch 14/50
1454/1454 - 39s - loss: 2.8726 - accuracy20: 0.5282 - val_loss: 2.9336 - val_accuracy20: 0.4982 - 39s/epoch - 27ms/step
Epoch 15/50
1454/1454 - 39s - loss: 2.8674 - accuracy20: 0.5293 - val_loss: 2.9382 - val_accuracy20: 0.4931 - 39s/epoch - 27ms/step
Epoch 16/50
1454/1454 - 39s - loss: 2.8622 - accuracy20: 0.5301 - val_loss: 2.9329 - val_accuracy20: 0.4961 - 39s/epoch - 27ms/step
Epoch 17/50
1454/1454 - 39s - loss: 2.8589 - accuracy20: 0.5312 - val_loss: 2.9482 - val_accuracy20: 0.4902 - 39s/epoch - 27ms/step
Epoch 18/50
1454/1454 - 39s - loss: 2.8536 - accuracy20: 0.5322 - val_loss: 2.9437 - val_accuracy20: 0.4956 - 39s/epoch - 27ms/step
Epoch 19/50
1454/1454 - 40s - loss: 2.8490 - accuracy20: 0.5335 - val_loss: 2.9493 - val_accuracy20: 0.4915 - 40s/epoch - 27ms/step
Epoch 20/50
1454/1454 - 39s - loss: 2.8443 - accuracy20: 0.5343 - val_loss: 2.9583 - val_accuracy20: 0.4884 - 39s/epoch - 27ms/step
Epoch 21/50
1454/1454 - 39s - loss: 2.8391 - accuracy20: 0.5354 - val_loss: 2.9461 - val_accuracy20: 0.4955 - 39s/epoch - 27ms/step
Epoch 22/50
1454/1454 - 39s - loss: 2.8350 - accuracy20: 0.5371 - val_loss: 2.9510 - val_accuracy20: 0.4905 - 39s/epoch - 27ms/step
Epoch 23/50
1454/1454 - 39s - loss: 2.8311 - accuracy20: 0.5375 - val_loss: 2.9469 - val_accuracy20: 0.4948 - 39s/epoch - 27ms/step
testing model: results/WBA/W0/deepOF_L2/h20
Evaluating performance on  test set...
5633/5633 - 67s - 67s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86469233
{'0': {'precision': 0.4270939444469677, 'recall': 0.4425269583456584, 'f1-score': 0.4346735078630837, 'support': 297496}, '1': {'precision': 0.7436060151532633, 'recall': 0.6859294788787859, 'f1-score': 0.7136042282190067, 'support': 845619}, '2': {'precision': 0.44007546251905655, 'recall': 0.5208661127365976, 'f1-score': 0.47707457222272476, 'support': 298714}, 'accuracy': 0.6015103039264712, 'macro avg': {'precision': 0.5369251407064292, 'recall': 0.5497741833203472, 'f1-score': 0.5417841027682717, 'support': 1441829}, 'weighted avg': {'precision': 0.6154147383191765, 'recall': 0.6015103039264712, 'f1-score': 0.6070482543522868, 'support': 1441829}}
[[131650 105474  60372]
 [127993 580035 137591]
 [ 48603  94521 155590]]
Evaluating performance on  train set...
1454/1454 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9966687
{'0': {'precision': 0.4405018710103456, 'recall': 0.46710735159561556, 'f1-score': 0.4534146573560932, 'support': 107106}, '1': {'precision': 0.6038401220701055, 'recall': 0.45157568419117416, 'f1-score': 0.516724336793541, 'support': 157741}, '2': {'precision': 0.43239205139698195, 'recall': 0.566678477518975, 'f1-score': 0.49051045403734483, 'support': 107246}, 'accuracy': 0.4892217805763613, 'macro avg': {'precision': 0.4922446814924777, 'recall': 0.4951205044352549, 'f1-score': 0.48688314939565974, 'support': 372093}, 'weighted avg': {'precision': 0.5074082448098065, 'recall': 0.4892217805763613, 'f1-score': 0.4909453498308777, 'support': 372093}}
[[50030 24622 32454]
 [39184 71232 47325]
 [24361 22111 60774]]
Evaluating performance on  val set...
557/557 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97808695
{'0': {'precision': 0.4264232513333803, 'recall': 0.466567263939947, 'f1-score': 0.44559292904493003, 'support': 38899}, '1': {'precision': 0.61890255886168, 'recall': 0.496194753013472, 'f1-score': 0.5507971350363368, 'support': 63465}, '2': {'precision': 0.4476688381971532, 'recall': 0.5473954951805424, 'f1-score': 0.4925347982878906, 'support': 40046}, 'accuracy': 0.5024998244505302, 'macro avg': {'precision': 0.49766488279740456, 'recall': 0.5033858373779871, 'f1-score': 0.4963082874563858, 'support': 142410}, 'weighted avg': {'precision': 0.5181759374076039, 'recall': 0.5024998244505302, 'f1-score': 0.5056773264113243, 'support': 142410}}
[[18149 10217 10533]
 [15461 31491 16513]
 [ 8951  9174 21921]]
training model: results/WBA/W0/deepOF_L2/h30
Epoch 1/50
1454/1454 - 42s - loss: 3.1873 - accuracy30: 0.4277 - val_loss: 3.1702 - val_accuracy30: 0.4018 - 42s/epoch - 29ms/step
Epoch 2/50
1454/1454 - 39s - loss: 3.0734 - accuracy30: 0.4712 - val_loss: 3.0667 - val_accuracy30: 0.4671 - 39s/epoch - 27ms/step
Epoch 3/50
1454/1454 - 39s - loss: 3.0253 - accuracy30: 0.4876 - val_loss: 3.0331 - val_accuracy30: 0.4791 - 39s/epoch - 27ms/step
Epoch 4/50
1454/1454 - 40s - loss: 2.9998 - accuracy30: 0.4948 - val_loss: 3.0246 - val_accuracy30: 0.4804 - 40s/epoch - 27ms/step
Epoch 5/50
1454/1454 - 39s - loss: 2.9853 - accuracy30: 0.4995 - val_loss: 3.0098 - val_accuracy30: 0.4841 - 39s/epoch - 27ms/step
Epoch 6/50
1454/1454 - 40s - loss: 2.9739 - accuracy30: 0.5019 - val_loss: 3.0096 - val_accuracy30: 0.4838 - 40s/epoch - 27ms/step
Epoch 7/50
1454/1454 - 39s - loss: 2.9645 - accuracy30: 0.5049 - val_loss: 3.0097 - val_accuracy30: 0.4842 - 39s/epoch - 27ms/step
Epoch 8/50
1454/1454 - 39s - loss: 2.9574 - accuracy30: 0.5072 - val_loss: 3.0026 - val_accuracy30: 0.4864 - 39s/epoch - 27ms/step
Epoch 9/50
1454/1454 - 39s - loss: 2.9507 - accuracy30: 0.5080 - val_loss: 3.0049 - val_accuracy30: 0.4852 - 39s/epoch - 27ms/step
Epoch 10/50
1454/1454 - 39s - loss: 2.9441 - accuracy30: 0.5101 - val_loss: 3.0043 - val_accuracy30: 0.4845 - 39s/epoch - 27ms/step
Epoch 11/50
1454/1454 - 39s - loss: 2.9372 - accuracy30: 0.5122 - val_loss: 3.0076 - val_accuracy30: 0.4832 - 39s/epoch - 27ms/step
Epoch 12/50
1454/1454 - 39s - loss: 2.9338 - accuracy30: 0.5131 - val_loss: 3.0008 - val_accuracy30: 0.4877 - 39s/epoch - 27ms/step
Epoch 13/50
1454/1454 - 39s - loss: 2.9278 - accuracy30: 0.5146 - val_loss: 2.9996 - val_accuracy30: 0.4877 - 39s/epoch - 27ms/step
Epoch 14/50
1454/1454 - 39s - loss: 2.9221 - accuracy30: 0.5152 - val_loss: 3.0033 - val_accuracy30: 0.4879 - 39s/epoch - 27ms/step
Epoch 15/50
1454/1454 - 39s - loss: 2.9166 - accuracy30: 0.5178 - val_loss: 3.0045 - val_accuracy30: 0.4895 - 39s/epoch - 27ms/step
Epoch 16/50
1454/1454 - 39s - loss: 2.9125 - accuracy30: 0.5189 - val_loss: 3.0026 - val_accuracy30: 0.4887 - 39s/epoch - 27ms/step
Epoch 17/50
1454/1454 - 39s - loss: 2.9082 - accuracy30: 0.5197 - val_loss: 3.0133 - val_accuracy30: 0.4873 - 39s/epoch - 27ms/step
Epoch 18/50
1454/1454 - 39s - loss: 2.9037 - accuracy30: 0.5216 - val_loss: 3.0009 - val_accuracy30: 0.4917 - 39s/epoch - 27ms/step
Epoch 19/50
1454/1454 - 39s - loss: 2.8986 - accuracy30: 0.5230 - val_loss: 3.0120 - val_accuracy30: 0.4890 - 39s/epoch - 27ms/step
Epoch 20/50
1454/1454 - 39s - loss: 2.8941 - accuracy30: 0.5240 - val_loss: 3.0171 - val_accuracy30: 0.4879 - 39s/epoch - 27ms/step
Epoch 21/50
1454/1454 - 39s - loss: 2.8880 - accuracy30: 0.5260 - val_loss: 3.0413 - val_accuracy30: 0.4816 - 39s/epoch - 27ms/step
Epoch 22/50
1454/1454 - 39s - loss: 2.8854 - accuracy30: 0.5264 - val_loss: 3.0291 - val_accuracy30: 0.4828 - 39s/epoch - 27ms/step
Epoch 23/50
1454/1454 - 39s - loss: 2.8802 - accuracy30: 0.5278 - val_loss: 3.0237 - val_accuracy30: 0.4872 - 39s/epoch - 27ms/step
testing model: results/WBA/W0/deepOF_L2/h30
Evaluating performance on  test set...
5633/5633 - 65s - 65s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9038287
{'0': {'precision': 0.44837794975705697, 'recall': 0.44085647166206876, 'f1-score': 0.44458540096886306, 'support': 341821}, '1': {'precision': 0.6942166381221667, 'recall': 0.6598343013437353, 'f1-score': 0.6765889480896768, 'support': 754985}, '2': {'precision': 0.4556497633640689, 'recall': 0.5126035075922475, 'f1-score': 0.4824515938961117, 'support': 345023}, 'accuracy': 0.5726885781878434, 'macro avg': {'precision': 0.5327481170810975, 'recall': 0.5377647601993505, 'f1-score': 0.5345419809848839, 'support': 1441829}, 'weighted avg': {'precision': 0.5788465872178546, 'recall': 0.5726885781878434, 'f1-score': 0.5751306358790679, 'support': 1441829}}
[[150694 116303  74824]
 [120355 498165 136465]
 [ 65038 103125 176860]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0110996
{'0': {'precision': 0.4627710987738148, 'recall': 0.4806717390041735, 'f1-score': 0.47155159783157247, 'support': 120523}, '1': {'precision': 0.5343533431878827, 'recall': 0.4266717762023376, 'f1-score': 0.47447977260426916, 'support': 130475}, '2': {'precision': 0.45876014181018177, 'recall': 0.5407077088236508, 'f1-score': 0.4963744356969309, 'support': 121095}, 'accuracy': 0.4812748425796777, 'macro avg': {'precision': 0.48529486125729315, 'recall': 0.4826837413433873, 'f1-score': 0.4808019353775908, 'support': 372093}, 'weighted avg': {'precision': 0.4865661889969965, 'recall': 0.4812748425796777, 'f1-score': 0.48065678162909936, 'support': 372093}}
[[57932 25096 37495]
 [35051 55670 39754]
 [32202 23416 65477]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0011095
{'0': {'precision': 0.4490002585538223, 'recall': 0.4737320693809816, 'f1-score': 0.46103472306722276, 'support': 43989}, '1': {'precision': 0.5451073357039379, 'recall': 0.47130494192666816, 'f1-score': 0.505526717557252, 'support': 52692}, '2': {'precision': 0.4751982553528945, 'recall': 0.5241531632005948, 'f1-score': 0.49847664008152315, 'support': 45729}, 'accuracy': 0.4890246471455656, 'macro avg': {'precision': 0.48976861653688486, 'recall': 0.48973005816941484, 'f1-score': 0.48834602690199924, 'support': 142410}, 'weighted avg': {'precision': 0.4929724677021873, 'recall': 0.4890246471455656, 'f1-score': 0.48951975639926104, 'support': 142410}}
[[20839 10735 12415]
 [13802 24834 14056]
 [11771  9989 23969]]
training model: results/WBA/W0/deepOF_L2/h50
Epoch 1/50
1454/1454 - 43s - loss: 3.2298 - accuracy50: 0.4092 - val_loss: 3.2295 - val_accuracy50: 0.3998 - 43s/epoch - 29ms/step
Epoch 2/50
1454/1454 - 39s - loss: 3.1448 - accuracy50: 0.4456 - val_loss: 3.1648 - val_accuracy50: 0.4275 - 39s/epoch - 27ms/step
Epoch 3/50
1454/1454 - 40s - loss: 3.1123 - accuracy50: 0.4587 - val_loss: 3.1398 - val_accuracy50: 0.4410 - 40s/epoch - 27ms/step
Epoch 4/50
1454/1454 - 40s - loss: 3.0921 - accuracy50: 0.4653 - val_loss: 3.1259 - val_accuracy50: 0.4509 - 40s/epoch - 27ms/step
Epoch 5/50
1454/1454 - 39s - loss: 3.0777 - accuracy50: 0.4707 - val_loss: 3.1133 - val_accuracy50: 0.4556 - 39s/epoch - 27ms/step
Epoch 6/50
1454/1454 - 39s - loss: 3.0665 - accuracy50: 0.4749 - val_loss: 3.1093 - val_accuracy50: 0.4560 - 39s/epoch - 27ms/step
Epoch 7/50
1454/1454 - 39s - loss: 3.0580 - accuracy50: 0.4776 - val_loss: 3.1082 - val_accuracy50: 0.4567 - 39s/epoch - 27ms/step
Epoch 8/50
1454/1454 - 40s - loss: 3.0521 - accuracy50: 0.4790 - val_loss: 3.1057 - val_accuracy50: 0.4561 - 40s/epoch - 27ms/step
Epoch 9/50
1454/1454 - 39s - loss: 3.0455 - accuracy50: 0.4816 - val_loss: 3.1053 - val_accuracy50: 0.4582 - 39s/epoch - 27ms/step
Epoch 10/50
1454/1454 - 40s - loss: 3.0408 - accuracy50: 0.4829 - val_loss: 3.1063 - val_accuracy50: 0.4578 - 40s/epoch - 27ms/step
Epoch 11/50
1454/1454 - 39s - loss: 3.0344 - accuracy50: 0.4846 - val_loss: 3.1050 - val_accuracy50: 0.4599 - 39s/epoch - 27ms/step
Epoch 12/50
1454/1454 - 39s - loss: 3.0306 - accuracy50: 0.4862 - val_loss: 3.1031 - val_accuracy50: 0.4617 - 39s/epoch - 27ms/step
Epoch 13/50
1454/1454 - 39s - loss: 3.0255 - accuracy50: 0.4881 - val_loss: 3.1060 - val_accuracy50: 0.4604 - 39s/epoch - 27ms/step
Epoch 14/50
1454/1454 - 39s - loss: 3.0213 - accuracy50: 0.4895 - val_loss: 3.1093 - val_accuracy50: 0.4595 - 39s/epoch - 27ms/step
Epoch 15/50
1454/1454 - 39s - loss: 3.0168 - accuracy50: 0.4909 - val_loss: 3.1162 - val_accuracy50: 0.4558 - 39s/epoch - 27ms/step
Epoch 16/50
1454/1454 - 39s - loss: 3.0119 - accuracy50: 0.4932 - val_loss: 3.1257 - val_accuracy50: 0.4550 - 39s/epoch - 27ms/step
Epoch 17/50
1454/1454 - 39s - loss: 3.0083 - accuracy50: 0.4936 - val_loss: 3.1294 - val_accuracy50: 0.4552 - 39s/epoch - 27ms/step
Epoch 18/50
1454/1454 - 39s - loss: 3.0041 - accuracy50: 0.4955 - val_loss: 3.1334 - val_accuracy50: 0.4536 - 39s/epoch - 27ms/step
Epoch 19/50
1454/1454 - 39s - loss: 2.9990 - accuracy50: 0.4971 - val_loss: 3.1354 - val_accuracy50: 0.4541 - 39s/epoch - 27ms/step
Epoch 20/50
1454/1454 - 39s - loss: 2.9943 - accuracy50: 0.4992 - val_loss: 3.1423 - val_accuracy50: 0.4550 - 39s/epoch - 27ms/step
Epoch 21/50
1454/1454 - 40s - loss: 2.9890 - accuracy50: 0.5012 - val_loss: 3.1421 - val_accuracy50: 0.4537 - 40s/epoch - 27ms/step
Epoch 22/50
1454/1454 - 39s - loss: 2.9848 - accuracy50: 0.5024 - val_loss: 3.1514 - val_accuracy50: 0.4526 - 39s/epoch - 27ms/step
testing model: results/WBA/W0/deepOF_L2/h50
Evaluating performance on  test set...
5633/5633 - 67s - 67s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9453436
{'0': {'precision': 0.4556917787183569, 'recall': 0.3641978095146738, 'f1-score': 0.40483974916852095, 'support': 354442}, '1': {'precision': 0.6404290724763831, 'recall': 0.6964183554584897, 'f1-score': 0.6672512541401796, 'support': 718413}, '2': {'precision': 0.4484724327647801, 'recall': 0.45863123146888396, 'f1-score': 0.4534949471128465, 'support': 368974}, 'accuracy': 0.553897861674304, 'macro avg': {'precision': 0.5148644279865068, 'recall': 0.5064157988140159, 'f1-score': 0.5085286501405156, 'support': 1441829}, 'weighted avg': {'precision': 0.5458924352918548, 'recall': 0.553897861674304, 'f1-score': 0.5480414322582035, 'support': 1441829}}
[[129087 141390  83965]
 [ 93953 500316 124144]
 [ 60237 139514 169223]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0374212
{'0': {'precision': 0.4572118494243457, 'recall': 0.4292828282010381, 'f1-score': 0.4428073868049814, 'support': 123499}, '1': {'precision': 0.4800132906310281, 'recall': 0.4241499955144882, 'f1-score': 0.45035589962072015, 'support': 122617}, '2': {'precision': 0.44703669370935983, 'recall': 0.5244449383617644, 'f1-score': 0.48265684813418663, 'support': 125977}, 'accuracy': 0.4598097787381112, 'macro avg': {'precision': 0.46142061125491124, 'recall': 0.4592925873590969, 'f1-score': 0.45860671151996274, 'support': 372093}, 'weighted avg': {'precision': 0.4612807481269093, 'recall': 0.4598097787381112, 'f1-score': 0.4587864339405005, 'support': 372093}}
[[53016 28307 42176]
 [31062 52008 39547]
 [31877 28032 66068]]
Evaluating performance on  val set...
557/557 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0342464
{'0': {'precision': 0.442214849559547, 'recall': 0.4218855733339154, 'f1-score': 0.4318110728808258, 'support': 45811}, '1': {'precision': 0.4772564846344642, 'recall': 0.47207667997338654, 'f1-score': 0.4746524511341068, 'support': 48096}, '2': {'precision': 0.46425847333320297, 'recall': 0.48941302599839187, 'f1-score': 0.4765040046570448, 'support': 48503}, 'accuracy': 0.4618355452566533, 'macro avg': {'precision': 0.46124326917573805, 'recall': 0.4611250931018979, 'f1-score': 0.46098917622399244, 'support': 142410}, 'weighted avg': {'precision': 0.4615572016728596, 'recall': 0.4618355452566533, 'f1-score': 0.46150168588842183, 'support': 142410}}
[[19327 12417 14067]
 [12065 22705 13326]
 [12313 12452 23738]]
training model: results/WBA/W0/deepOF_L2/h100
Epoch 1/50
1454/1454 - 41s - loss: 3.2781 - accuracy100: 0.3816 - val_loss: 3.2690 - val_accuracy100: 0.3710 - 41s/epoch - 28ms/step
Epoch 2/50
1454/1454 - 39s - loss: 3.2374 - accuracy100: 0.4042 - val_loss: 3.2711 - val_accuracy100: 0.3673 - 39s/epoch - 27ms/step
Epoch 3/50
1454/1454 - 39s - loss: 3.2217 - accuracy100: 0.4118 - val_loss: 3.2782 - val_accuracy100: 0.3575 - 39s/epoch - 27ms/step
Epoch 4/50
1454/1454 - 39s - loss: 3.2121 - accuracy100: 0.4157 - val_loss: 3.2826 - val_accuracy100: 0.3525 - 39s/epoch - 27ms/step
Epoch 5/50
1454/1454 - 39s - loss: 3.2065 - accuracy100: 0.4194 - val_loss: 3.2858 - val_accuracy100: 0.3506 - 39s/epoch - 27ms/step
Epoch 6/50
1454/1454 - 40s - loss: 3.2027 - accuracy100: 0.4211 - val_loss: 3.2878 - val_accuracy100: 0.3508 - 40s/epoch - 27ms/step
Epoch 7/50
1454/1454 - 40s - loss: 3.1981 - accuracy100: 0.4231 - val_loss: 3.2886 - val_accuracy100: 0.3566 - 40s/epoch - 27ms/step
Epoch 8/50
1454/1454 - 41s - loss: 3.1942 - accuracy100: 0.4246 - val_loss: 3.2959 - val_accuracy100: 0.3547 - 41s/epoch - 28ms/step
Epoch 9/50
1454/1454 - 41s - loss: 3.1915 - accuracy100: 0.4259 - val_loss: 3.2949 - val_accuracy100: 0.3575 - 41s/epoch - 28ms/step
Epoch 10/50
1454/1454 - 40s - loss: 3.1878 - accuracy100: 0.4276 - val_loss: 3.2996 - val_accuracy100: 0.3575 - 40s/epoch - 28ms/step
Epoch 11/50
1454/1454 - 40s - loss: 3.1849 - accuracy100: 0.4297 - val_loss: 3.3035 - val_accuracy100: 0.3589 - 40s/epoch - 28ms/step
testing model: results/WBA/W0/deepOF_L2/h100
Evaluating performance on  test set...
5633/5633 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.074075
{'0': {'precision': 0.3190386064755733, 'recall': 0.4701587618129646, 'f1-score': 0.3801299959131345, 'support': 361044}, '1': {'precision': 0.501145250453569, 'recall': 0.40272861114720765, 'f1-score': 0.44657897362082966, 'support': 700283}, '2': {'precision': 0.33222769438256644, 'recall': 0.30298395277817197, 'f1-score': 0.3169326649356504, 'support': 380502}, 'accuracy': 0.3932907439092985, 'macro avg': {'precision': 0.38413718377056955, 'recall': 0.39195710857944804, 'f1-score': 0.38121387815653823, 'support': 1441829}, 'weighted avg': {'precision': 0.4109667486419671, 'recall': 0.3932907439092985, 'f1-score': 0.3957257278789108, 'support': 1441829}}
[[169748 124765  66531]
 [253067 282024 165192]
 [109246 155970 115286]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0904138
{'0': {'precision': 0.3869405489675282, 'recall': 0.43492828400830735, 'f1-score': 0.4095334491912228, 'support': 123264}, '1': {'precision': 0.3411820025686554, 'recall': 0.39569902975841637, 'f1-score': 0.36642383631752107, 'support': 122856}, '2': {'precision': 0.3899950579320191, 'recall': 0.28189373913457644, 'f1-score': 0.3272480970197394, 'support': 125973}, 'accuracy': 0.3701655231353452, 'macro avg': {'precision': 0.3727058698227342, 'recall': 0.37084035096710005, 'f1-score': 0.36773512750949444, 'support': 372093}, 'weighted avg': {'precision': 0.3728663086066612, 'recall': 0.3701655231353452, 'f1-score': 0.36744180202691235, 'support': 372093}}
[[53611 43480 26173]
 [44871 48614 29371]
 [40069 50393 35511]]
Evaluating performance on  val set...
557/557 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0904356
{'0': {'precision': 0.4098420436443199, 'recall': 0.4344217271895026, 'f1-score': 0.42177408204783823, 'support': 49155}, '1': {'precision': 0.3069243215415165, 'recall': 0.3961789486175389, 'f1-score': 0.3458864726541861, 'support': 42135}, '2': {'precision': 0.42119769481332997, 'recall': 0.29595070422535213, 'f1-score': 0.3476372660531486, 'support': 51120}, 'accuracy': 0.3734007443297521, 'macro avg': {'precision': 0.3793213533330555, 'recall': 0.37551712667746456, 'f1-score': 0.3717659402517243, 'support': 142410}, 'weighted avg': {'precision': 0.38346793134151935, 'recall': 0.3734007443297521, 'f1-score': 0.37270871827106644, 'support': 142410}}
[[21354 17201 10600]
 [15252 16693 10190]
 [15497 20494 15129]]
training model: results/WBA/W0/deepOF_L2/h200
Epoch 1/50
1454/1454 - 42s - loss: 3.3035 - accuracy200: 0.3589 - val_loss: 3.2858 - val_accuracy200: 0.3594 - 42s/epoch - 29ms/step
Epoch 2/50
1454/1454 - 40s - loss: 3.2774 - accuracy200: 0.3736 - val_loss: 3.2781 - val_accuracy200: 0.3655 - 40s/epoch - 27ms/step
Epoch 3/50
1454/1454 - 39s - loss: 3.2677 - accuracy200: 0.3800 - val_loss: 3.2750 - val_accuracy200: 0.3673 - 39s/epoch - 27ms/step
Epoch 4/50
1454/1454 - 40s - loss: 3.2611 - accuracy200: 0.3847 - val_loss: 3.2742 - val_accuracy200: 0.3673 - 40s/epoch - 27ms/step
Epoch 5/50
1454/1454 - 40s - loss: 3.2567 - accuracy200: 0.3874 - val_loss: 3.2735 - val_accuracy200: 0.3665 - 40s/epoch - 27ms/step
Epoch 6/50
1454/1454 - 39s - loss: 3.2529 - accuracy200: 0.3897 - val_loss: 3.2742 - val_accuracy200: 0.3656 - 39s/epoch - 27ms/step
Epoch 7/50
1454/1454 - 39s - loss: 3.2501 - accuracy200: 0.3917 - val_loss: 3.2742 - val_accuracy200: 0.3632 - 39s/epoch - 27ms/step
Epoch 8/50
1454/1454 - 39s - loss: 3.2482 - accuracy200: 0.3930 - val_loss: 3.2739 - val_accuracy200: 0.3657 - 39s/epoch - 27ms/step
Epoch 9/50
1454/1454 - 39s - loss: 3.2453 - accuracy200: 0.3947 - val_loss: 3.2736 - val_accuracy200: 0.3663 - 39s/epoch - 27ms/step
Epoch 10/50
1454/1454 - 39s - loss: 3.2433 - accuracy200: 0.3959 - val_loss: 3.2736 - val_accuracy200: 0.3670 - 39s/epoch - 27ms/step
Epoch 11/50
1454/1454 - 39s - loss: 3.2420 - accuracy200: 0.3961 - val_loss: 3.2732 - val_accuracy200: 0.3694 - 39s/epoch - 27ms/step
Epoch 12/50
1454/1454 - 39s - loss: 3.2397 - accuracy200: 0.3979 - val_loss: 3.2738 - val_accuracy200: 0.3678 - 39s/epoch - 27ms/step
Epoch 13/50
1454/1454 - 39s - loss: 3.2376 - accuracy200: 0.3999 - val_loss: 3.2745 - val_accuracy200: 0.3687 - 39s/epoch - 27ms/step
Epoch 14/50
1454/1454 - 39s - loss: 3.2352 - accuracy200: 0.4003 - val_loss: 3.2767 - val_accuracy200: 0.3685 - 39s/epoch - 27ms/step
Epoch 15/50
1454/1454 - 39s - loss: 3.2336 - accuracy200: 0.4024 - val_loss: 3.2765 - val_accuracy200: 0.3708 - 39s/epoch - 27ms/step
Epoch 16/50
1454/1454 - 39s - loss: 3.2316 - accuracy200: 0.4031 - val_loss: 3.2802 - val_accuracy200: 0.3723 - 39s/epoch - 27ms/step
Epoch 17/50
1454/1454 - 39s - loss: 3.2280 - accuracy200: 0.4062 - val_loss: 3.2800 - val_accuracy200: 0.3738 - 39s/epoch - 27ms/step
Epoch 18/50
1454/1454 - 39s - loss: 3.2255 - accuracy200: 0.4076 - val_loss: 3.2835 - val_accuracy200: 0.3765 - 39s/epoch - 27ms/step
Epoch 19/50
1454/1454 - 39s - loss: 3.2223 - accuracy200: 0.4097 - val_loss: 3.2967 - val_accuracy200: 0.3724 - 39s/epoch - 27ms/step
Epoch 20/50
1454/1454 - 39s - loss: 3.2190 - accuracy200: 0.4120 - val_loss: 3.3010 - val_accuracy200: 0.3718 - 39s/epoch - 27ms/step
Epoch 21/50
1454/1454 - 39s - loss: 3.2153 - accuracy200: 0.4139 - val_loss: 3.3216 - val_accuracy200: 0.3714 - 39s/epoch - 27ms/step
testing model: results/WBA/W0/deepOF_L2/h200
Evaluating performance on  test set...
5633/5633 - 67s - 67s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0735743
{'0': {'precision': 0.36795595115477053, 'recall': 0.3441350554743476, 'f1-score': 0.355647074556342, 'support': 417310}, '1': {'precision': 0.41385251214769253, 'recall': 0.5966644884307567, 'f1-score': 0.48872230215827345, 'support': 569268}, '2': {'precision': 0.40082234632998703, 'recall': 0.20320877933271975, 'f1-score': 0.26969014100930827, 'support': 455251}, 'accuracy': 0.3993427792061333, 'macro avg': {'precision': 0.39421026987748337, 'recall': 0.38133610774594134, 'f1-score': 0.37135317257464123, 'support': 1441829}, 'weighted avg': {'precision': 0.3964544088451285, 'recall': 0.3993427792061333, 'f1-score': 0.3810477903917675, 'support': 1441829}}
[[143611 219436  54263]
 [145577 339662  84029]
 [101106 261634  92511]]
Evaluating performance on  train set...
1454/1454 - 16s - 16s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0879298
{'0': {'precision': 0.39072517211631175, 'recall': 0.3759246148963699, 'f1-score': 0.3831820274299839, 'support': 122889}, '1': {'precision': 0.35682592212708325, 'recall': 0.5122681418808982, 'f1-score': 0.4206461870421896, 'support': 122920}, '2': {'precision': 0.40515815588174486, 'recall': 0.2482974882011973, 'f1-score': 0.3079007835974783, 'support': 126284}, 'accuracy': 0.3776502111031382, 'macro avg': {'precision': 0.38423641670838, 'recall': 0.37883008165948845, 'f1-score': 0.37057633268988394, 'support': 372093}, 'weighted avg': {'precision': 0.38442502433916464, 'recall': 0.3776502111031382, 'f1-score': 0.3700086484720035, 'support': 372093}}
[[46197 54204 22488]
 [36404 62968 23548]
 [35633 59295 31356]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0914897
{'0': {'precision': 0.38688931253876013, 'recall': 0.3568266073509162, 'f1-score': 0.37125035815829494, 'support': 47205}, '1': {'precision': 0.3494735037361947, 'recall': 0.5230295513834837, 'f1-score': 0.4189898678451827, 'support': 46766}, '2': {'precision': 0.39432864760058167, 'recall': 0.2351204607857305, 'f1-score': 0.29459008548777177, 'support': 48439}, 'accuracy': 0.37000912857243173, 'macro avg': {'precision': 0.37689715462517887, 'recall': 0.3716588731733768, 'f1-score': 0.3616101038304165, 'support': 142410}, 'weighted avg': {'precision': 0.37713273811701165, 'recall': 0.37000912857243173, 'f1-score': 0.3608524855519437, 'support': 142410}}
[[16844 21635  8726]
 [13539 24460  8767]
 [13154 23896 11389]]
training model: results/WBA/W0/deepOF_L2/h300
Epoch 1/50
1454/1454 - 42s - loss: 3.3032 - accuracy300: 0.3620 - val_loss: 3.2955 - val_accuracy300: 0.3519 - 42s/epoch - 29ms/step
Epoch 2/50
1454/1454 - 40s - loss: 3.2818 - accuracy300: 0.3716 - val_loss: 3.2865 - val_accuracy300: 0.3617 - 40s/epoch - 28ms/step
Epoch 3/50
1454/1454 - 40s - loss: 3.2737 - accuracy300: 0.3762 - val_loss: 3.2831 - val_accuracy300: 0.3643 - 40s/epoch - 28ms/step
Epoch 4/50
1454/1454 - 41s - loss: 3.2691 - accuracy300: 0.3784 - val_loss: 3.2817 - val_accuracy300: 0.3672 - 41s/epoch - 28ms/step
Epoch 5/50
1454/1454 - 41s - loss: 3.2662 - accuracy300: 0.3807 - val_loss: 3.2804 - val_accuracy300: 0.3675 - 41s/epoch - 28ms/step
Epoch 6/50
1454/1454 - 40s - loss: 3.2636 - accuracy300: 0.3826 - val_loss: 3.2794 - val_accuracy300: 0.3698 - 40s/epoch - 28ms/step
Epoch 7/50
1454/1454 - 40s - loss: 3.2607 - accuracy300: 0.3841 - val_loss: 3.2790 - val_accuracy300: 0.3690 - 40s/epoch - 27ms/step
Epoch 8/50
1454/1454 - 39s - loss: 3.2595 - accuracy300: 0.3851 - val_loss: 3.2795 - val_accuracy300: 0.3693 - 39s/epoch - 27ms/step
Epoch 9/50
1454/1454 - 39s - loss: 3.2573 - accuracy300: 0.3864 - val_loss: 3.2787 - val_accuracy300: 0.3703 - 39s/epoch - 27ms/step
Epoch 10/50
1454/1454 - 40s - loss: 3.2559 - accuracy300: 0.3870 - val_loss: 3.2783 - val_accuracy300: 0.3690 - 40s/epoch - 27ms/step
Epoch 11/50
1454/1454 - 40s - loss: 3.2549 - accuracy300: 0.3871 - val_loss: 3.2779 - val_accuracy300: 0.3732 - 40s/epoch - 27ms/step
Epoch 12/50
1454/1454 - 39s - loss: 3.2532 - accuracy300: 0.3884 - val_loss: 3.2782 - val_accuracy300: 0.3719 - 39s/epoch - 27ms/step
Epoch 13/50
1454/1454 - 39s - loss: 3.2510 - accuracy300: 0.3895 - val_loss: 3.2775 - val_accuracy300: 0.3723 - 39s/epoch - 27ms/step
Epoch 14/50
1454/1454 - 39s - loss: 3.2495 - accuracy300: 0.3911 - val_loss: 3.2786 - val_accuracy300: 0.3708 - 39s/epoch - 27ms/step
Epoch 15/50
1454/1454 - 39s - loss: 3.2483 - accuracy300: 0.3916 - val_loss: 3.2788 - val_accuracy300: 0.3706 - 39s/epoch - 27ms/step
Epoch 16/50
1454/1454 - 39s - loss: 3.2464 - accuracy300: 0.3934 - val_loss: 3.2794 - val_accuracy300: 0.3698 - 39s/epoch - 27ms/step
Epoch 17/50
1454/1454 - 39s - loss: 3.2452 - accuracy300: 0.3940 - val_loss: 3.2792 - val_accuracy300: 0.3721 - 39s/epoch - 27ms/step
Epoch 18/50
1454/1454 - 39s - loss: 3.2437 - accuracy300: 0.3945 - val_loss: 3.2794 - val_accuracy300: 0.3715 - 39s/epoch - 27ms/step
Epoch 19/50
1454/1454 - 39s - loss: 3.2426 - accuracy300: 0.3967 - val_loss: 3.2804 - val_accuracy300: 0.3699 - 39s/epoch - 27ms/step
Epoch 20/50
1454/1454 - 39s - loss: 3.2398 - accuracy300: 0.3982 - val_loss: 3.2820 - val_accuracy300: 0.3686 - 39s/epoch - 27ms/step
Epoch 21/50
1454/1454 - 39s - loss: 3.2380 - accuracy300: 0.3991 - val_loss: 3.2828 - val_accuracy300: 0.3694 - 39s/epoch - 27ms/step
Epoch 22/50
1454/1454 - 39s - loss: 3.2365 - accuracy300: 0.4002 - val_loss: 3.2833 - val_accuracy300: 0.3693 - 39s/epoch - 27ms/step
Epoch 23/50
1454/1454 - 39s - loss: 3.2345 - accuracy300: 0.4024 - val_loss: 3.2835 - val_accuracy300: 0.3699 - 39s/epoch - 27ms/step
testing model: results/WBA/W0/deepOF_L2/h300
Evaluating performance on  test set...
5633/5633 - 62s - 62s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0896175
{'0': {'precision': 0.2791949828197553, 'recall': 0.5143999865184444, 'f1-score': 0.36194255494907257, 'support': 356042}, '1': {'precision': 0.5025330676615228, 'recall': 0.20113487893304977, 'f1-score': 0.2872858660483829, 'support': 707212}, '2': {'precision': 0.3095266981843206, 'recall': 0.41108366902199034, 'f1-score': 0.3531488763981202, 'support': 378575}, 'accuracy': 0.3336172320018532, 'macro avg': {'precision': 0.36375158288853293, 'recall': 0.3755395114911615, 'f1-score': 0.33412576579852526, 'support': 1441829}, 'weighted avg': {'precision': 0.3967055910827715, 'recall': 0.3336172320018532, 'f1-score': 0.32301479504948577, 'support': 1441829}}
[[183148  64633 108261]
 [326067 142245 238900]
 [146771  76178 155626]]
Evaluating performance on  train set...
1454/1454 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0914878
{'0': {'precision': 0.3670332409815353, 'recall': 0.5258838332589195, 'f1-score': 0.43232871958462915, 'support': 123185}, '1': {'precision': 0.3714395830274556, 'recall': 0.1647121057985758, 'f1-score': 0.22822121863071781, 'support': 122875}, '2': {'precision': 0.37463325443283774, 'recall': 0.4194377662993026, 'f1-score': 0.3957714897487825, 'support': 126033}, 'accuracy': 0.3705605856600366, 'macro avg': {'precision': 0.3710353594806095, 'recall': 0.37001123511893264, 'f1-score': 0.3521071426547098, 'support': 372093}, 'weighted avg': {'precision': 0.37106256100153145, 'recall': 0.3705605856600366, 'f1-score': 0.352544562055159, 'support': 372093}}
[[64781 16191 42213]
 [56606 20239 46030]
 [55112 18058 52863]]
Evaluating performance on  val set...
557/557 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0930173
{'0': {'precision': 0.3725737406907875, 'recall': 0.5220517244921017, 'f1-score': 0.43482501090741105, 'support': 48681}, '1': {'precision': 0.3554022378488346, 'recall': 0.1805396418862753, 'f1-score': 0.23944459342689434, 'support': 44511}, '2': {'precision': 0.3801926842033846, 'recall': 0.39849242147181924, 'f1-score': 0.3891275234363375, 'support': 49218}, 'accuracy': 0.3726072607260726, 'macro avg': {'precision': 0.3693895542476689, 'recall': 0.3670279292833987, 'f1-score': 0.354465709256881, 'support': 142410}, 'weighted avg': {'precision': 0.3698398624435074, 'recall': 0.3726072607260726, 'f1-score': 0.3579644203531903, 'support': 142410}}
[[25414  6947 16320]
 [20821  8036 15654]
 [21977  7628 19613]]
training model: results/WBA/W0/deepOF_L2/h500
Epoch 1/50
1454/1454 - 42s - loss: 3.3032 - accuracy500: 0.3608 - val_loss: 3.3015 - val_accuracy500: 0.3443 - 42s/epoch - 29ms/step
Epoch 2/50
1454/1454 - 39s - loss: 3.2802 - accuracy500: 0.3707 - val_loss: 3.3013 - val_accuracy500: 0.3374 - 39s/epoch - 27ms/step
Epoch 3/50
1454/1454 - 39s - loss: 3.2671 - accuracy500: 0.3794 - val_loss: 3.3061 - val_accuracy500: 0.3333 - 39s/epoch - 27ms/step
Epoch 4/50
1454/1454 - 39s - loss: 3.2595 - accuracy500: 0.3847 - val_loss: 3.3098 - val_accuracy500: 0.3313 - 39s/epoch - 27ms/step
Epoch 5/50
1454/1454 - 39s - loss: 3.2555 - accuracy500: 0.3880 - val_loss: 3.3116 - val_accuracy500: 0.3289 - 39s/epoch - 27ms/step
Epoch 6/50
1454/1454 - 39s - loss: 3.2523 - accuracy500: 0.3905 - val_loss: 3.3146 - val_accuracy500: 0.3274 - 39s/epoch - 27ms/step
Epoch 7/50
1454/1454 - 39s - loss: 3.2499 - accuracy500: 0.3917 - val_loss: 3.3119 - val_accuracy500: 0.3288 - 39s/epoch - 27ms/step
Epoch 8/50
1454/1454 - 39s - loss: 3.2478 - accuracy500: 0.3936 - val_loss: 3.3126 - val_accuracy500: 0.3298 - 39s/epoch - 27ms/step
Epoch 9/50
1454/1454 - 39s - loss: 3.2462 - accuracy500: 0.3943 - val_loss: 3.3103 - val_accuracy500: 0.3318 - 39s/epoch - 27ms/step
Epoch 10/50
1454/1454 - 39s - loss: 3.2448 - accuracy500: 0.3951 - val_loss: 3.3105 - val_accuracy500: 0.3323 - 39s/epoch - 27ms/step
Epoch 11/50
1454/1454 - 39s - loss: 3.2429 - accuracy500: 0.3959 - val_loss: 3.3092 - val_accuracy500: 0.3337 - 39s/epoch - 27ms/step
Epoch 12/50
1454/1454 - 40s - loss: 3.2419 - accuracy500: 0.3966 - val_loss: 3.3106 - val_accuracy500: 0.3347 - 40s/epoch - 27ms/step
testing model: results/WBA/W0/deepOF_L2/h500
Evaluating performance on  test set...
5633/5633 - 69s - 69s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0861677
{'0': {'precision': 0.2958396808231651, 'recall': 0.2624370046632233, 'f1-score': 0.27813907230646273, 'support': 382568}, '1': {'precision': 0.45834717967618693, 'recall': 0.7115212358350906, 'f1-score': 0.5575392025302268, 'support': 639697}, '2': {'precision': 0.35371159083846676, 'recall': 0.09224099303086061, 'f1-score': 0.14632366563448768, 'support': 419564}, 'accuracy': 0.41215636528326177, 'macro avg': {'precision': 0.3692994837792729, 'recall': 0.35539974450972484, 'f1-score': 0.3273339801570591, 'support': 1441829}, 'weighted avg': {'precision': 0.38477985996191283, 'recall': 0.41215636528326177, 'f1-score': 0.3637431389598805, 'support': 1441829}}
[[100400 248246  33922]
 [147748 455158  36791]
 [ 91225 289638  38701]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975887
{'0': {'precision': 0.3593427684801521, 'recall': 0.32608182565454824, 'f1-score': 0.3419052861086577, 'support': 122871}, '1': {'precision': 0.34821003975575887, 'recall': 0.596506806350965, 'f1-score': 0.439728919008999, 'support': 122753}, '2': {'precision': 0.37445091530679175, 'recall': 0.1489614055618373, 'f1-score': 0.21313497001923298, 'support': 126469}, 'accuracy': 0.3550940221933764, 'macro avg': {'precision': 0.36066790784756764, 'recall': 0.35718334585578354, 'f1-score': 0.33158972504562995, 'support': 372093}, 'weighted avg': {'precision': 0.3608051350710658, 'recall': 0.3550940221933764, 'f1-score': 0.3304100182694405, 'support': 372093}}
[[40066 65607 17198]
 [35256 73223 14274]
 [36176 71454 18839]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1013043
{'0': {'precision': 0.3708651399491094, 'recall': 0.31591305918477935, 'f1-score': 0.3411906232727509, 'support': 49827}, '1': {'precision': 0.31109432695535416, 'recall': 0.6062283898701056, 'f1-score': 0.411184002028269, 'support': 42804}, '2': {'precision': 0.37900205388425756, 'recall': 0.1260370839108861, 'f1-score': 0.18916677973256146, 'support': 49779}, 'accuracy': 0.3368021908573836, 'macro avg': {'precision': 0.353653840262907, 'recall': 0.3493928443219237, 'f1-score': 0.3138471350111938, 'support': 142410}, 'weighted avg': {'precision': 0.35574413411660494, 'recall': 0.3368021908573836, 'f1-score': 0.309088956793319, 'support': 142410}}
[[15741 28010  6076]
 [12651 25949  4204]
 [14052 29453  6274]]
training model: results/WBA/W0/deepOF_L2/h1000
Epoch 1/50
1454/1454 - 43s - loss: 3.3167 - accuracy1000: 0.3515 - val_loss: 3.3020 - val_accuracy1000: 0.3456 - 43s/epoch - 30ms/step
Epoch 2/50
1454/1454 - 40s - loss: 3.2950 - accuracy1000: 0.3569 - val_loss: 3.2985 - val_accuracy1000: 0.3442 - 40s/epoch - 28ms/step
Epoch 3/50
1454/1454 - 40s - loss: 3.2830 - accuracy1000: 0.3674 - val_loss: 3.2983 - val_accuracy1000: 0.3422 - 40s/epoch - 27ms/step
Epoch 4/50
1454/1454 - 39s - loss: 3.2765 - accuracy1000: 0.3731 - val_loss: 3.3003 - val_accuracy1000: 0.3402 - 39s/epoch - 27ms/step
Epoch 5/50
1454/1454 - 39s - loss: 3.2729 - accuracy1000: 0.3770 - val_loss: 3.3021 - val_accuracy1000: 0.3416 - 39s/epoch - 27ms/step
Epoch 6/50
1454/1454 - 39s - loss: 3.2703 - accuracy1000: 0.3781 - val_loss: 3.3055 - val_accuracy1000: 0.3384 - 39s/epoch - 27ms/step
Epoch 7/50
1454/1454 - 39s - loss: 3.2686 - accuracy1000: 0.3799 - val_loss: 3.3061 - val_accuracy1000: 0.3389 - 39s/epoch - 27ms/step
Epoch 8/50
1454/1454 - 39s - loss: 3.2671 - accuracy1000: 0.3807 - val_loss: 3.3081 - val_accuracy1000: 0.3362 - 39s/epoch - 27ms/step
Epoch 9/50
1454/1454 - 39s - loss: 3.2655 - accuracy1000: 0.3815 - val_loss: 3.3077 - val_accuracy1000: 0.3372 - 39s/epoch - 27ms/step
Epoch 10/50
1454/1454 - 39s - loss: 3.2640 - accuracy1000: 0.3834 - val_loss: 3.3113 - val_accuracy1000: 0.3365 - 39s/epoch - 27ms/step
Epoch 11/50
1454/1454 - 39s - loss: 3.2631 - accuracy1000: 0.3834 - val_loss: 3.3135 - val_accuracy1000: 0.3349 - 39s/epoch - 27ms/step
Epoch 12/50
1454/1454 - 39s - loss: 3.2620 - accuracy1000: 0.3843 - val_loss: 3.3150 - val_accuracy1000: 0.3350 - 39s/epoch - 27ms/step
Epoch 13/50
1454/1454 - 39s - loss: 3.2602 - accuracy1000: 0.3852 - val_loss: 3.3151 - val_accuracy1000: 0.3373 - 39s/epoch - 27ms/step
testing model: results/WBA/W0/deepOF_L2/h1000
Evaluating performance on  test set...
5633/5633 - 62s - 62s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981177
{'0': {'precision': 0.2787090569403094, 'recall': 0.570153755812582, 'f1-score': 0.37439975743114307, 'support': 398489}, '1': {'precision': 0.4160333594842583, 'recall': 0.41275854833906384, 'f1-score': 0.4143894840198007, 'support': 590992}, '2': {'precision': 0.36844325343655404, 'recall': 0.032826496414265126, 'f1-score': 0.06028214756926825, 'support': 452348}, 'accuracy': 0.33706216201782596, 'macro avg': {'precision': 0.3543952232870406, 'recall': 0.338579600188637, 'f1-score': 0.28302379634007063, 'support': 1441829}, 'weighted avg': {'precision': 0.3631494784644546, 'recall': 0.33706216201782596, 'f1-score': 0.2922423975155668, 'support': 1441829}}
[[227200 157948  13341]
 [334943 243937  12112]
 [253044 184455  14849]]
Evaluating performance on  train set...
1454/1454 - 17s - 17s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000315
{'0': {'precision': 0.33388060123984487, 'recall': 0.5769654081640972, 'f1-score': 0.42298600506244377, 'support': 122659}, '1': {'precision': 0.34211454695993376, 'recall': 0.38678431308707895, 'f1-score': 0.36308066124416893, 'support': 122854}, '2': {'precision': 0.3990393671124506, 'recall': 0.06694580502449043, 'f1-score': 0.11465605888401796, 'support': 126580}, 'accuracy': 0.340672896292056, 'macro avg': {'precision': 0.3583448384374097, 'recall': 0.34356517542522225, 'f1-score': 0.3002409083968769, 'support': 372093}, 'weighted avg': {'precision': 0.3587651590026898, 'recall': 0.340672896292056, 'f1-score': 0.29831820508578344, 'support': 372093}}
[[70770 44739  7150]
 [69724 47518  5612]
 [71468 46638  8474]]
Evaluating performance on  val set...
557/557 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000836
{'0': {'precision': 0.3464537736198821, 'recall': 0.5745260784916487, 'f1-score': 0.43224990748735653, 'support': 48795}, '1': {'precision': 0.3326323104495081, 'recall': 0.3929613066303714, 'f1-score': 0.3602888015133358, 'support': 46287}, '2': {'precision': 0.37145793569226254, 'recall': 0.05345672751859364, 'f1-score': 0.09346312270267275, 'support': 47328}, 'accuracy': 0.342342532125553, 'macro avg': {'precision': 0.3501813399205509, 'recall': 0.3403147042135379, 'f1-score': 0.2953339439011217, 'support': 142410}, 'weighted avg': {'precision': 0.35027122265291716, 'recall': 0.342342532125553, 'f1-score': 0.29626953628793923, 'support': 142410}}
[[28034 18180  2581]
 [26398 18189  1700]
 [26485 18313  2530]]
training model: results/WBA/W0/deepVOL_L2/h10
Epoch 1/50
1454/1454 - 42s - loss: 3.1276 - accuracy10: 0.4398 - val_loss: 2.9854 - val_accuracy10: 0.3998 - 42s/epoch - 29ms/step
Epoch 2/50
1454/1454 - 38s - loss: 2.9989 - accuracy10: 0.4791 - val_loss: 2.8962 - val_accuracy10: 0.4838 - 38s/epoch - 26ms/step
Epoch 3/50
1454/1454 - 40s - loss: 2.9474 - accuracy10: 0.4974 - val_loss: 2.8739 - val_accuracy10: 0.5271 - 40s/epoch - 27ms/step
Epoch 4/50
1454/1454 - 38s - loss: 2.9201 - accuracy10: 0.5068 - val_loss: 2.8360 - val_accuracy10: 0.5625 - 38s/epoch - 26ms/step
Epoch 5/50
1454/1454 - 39s - loss: 2.9007 - accuracy10: 0.5121 - val_loss: 2.8180 - val_accuracy10: 0.5642 - 39s/epoch - 27ms/step
Epoch 6/50
1454/1454 - 39s - loss: 2.8883 - accuracy10: 0.5143 - val_loss: 2.8133 - val_accuracy10: 0.5679 - 39s/epoch - 26ms/step
Epoch 7/50
1454/1454 - 38s - loss: 2.8759 - accuracy10: 0.5172 - val_loss: 2.8017 - val_accuracy10: 0.5658 - 38s/epoch - 26ms/step
Epoch 8/50
1454/1454 - 39s - loss: 2.8663 - accuracy10: 0.5187 - val_loss: 2.7966 - val_accuracy10: 0.5673 - 39s/epoch - 27ms/step
Epoch 9/50
1454/1454 - 38s - loss: 2.8570 - accuracy10: 0.5210 - val_loss: 2.7878 - val_accuracy10: 0.5636 - 38s/epoch - 26ms/step
Epoch 10/50
1454/1454 - 38s - loss: 2.8505 - accuracy10: 0.5212 - val_loss: 2.7797 - val_accuracy10: 0.5691 - 38s/epoch - 26ms/step
Epoch 11/50
1454/1454 - 39s - loss: 2.8438 - accuracy10: 0.5223 - val_loss: 2.7779 - val_accuracy10: 0.5632 - 39s/epoch - 27ms/step
Epoch 12/50
1454/1454 - 38s - loss: 2.8361 - accuracy10: 0.5246 - val_loss: 2.7692 - val_accuracy10: 0.5631 - 38s/epoch - 26ms/step
Epoch 13/50
1454/1454 - 38s - loss: 2.8310 - accuracy10: 0.5254 - val_loss: 2.7645 - val_accuracy10: 0.5684 - 38s/epoch - 26ms/step
Epoch 14/50
1454/1454 - 39s - loss: 2.8252 - accuracy10: 0.5262 - val_loss: 2.7634 - val_accuracy10: 0.5609 - 39s/epoch - 27ms/step
Epoch 15/50
1454/1454 - 40s - loss: 2.8190 - accuracy10: 0.5280 - val_loss: 2.7655 - val_accuracy10: 0.5624 - 40s/epoch - 27ms/step
Epoch 16/50
1454/1454 - 40s - loss: 2.8140 - accuracy10: 0.5283 - val_loss: 2.7575 - val_accuracy10: 0.5655 - 40s/epoch - 28ms/step
Epoch 17/50
1454/1454 - 41s - loss: 2.8099 - accuracy10: 0.5300 - val_loss: 2.7510 - val_accuracy10: 0.5596 - 41s/epoch - 28ms/step
Epoch 18/50
1454/1454 - 43s - loss: 2.8043 - accuracy10: 0.5303 - val_loss: 2.7511 - val_accuracy10: 0.5612 - 43s/epoch - 30ms/step
Epoch 19/50
1454/1454 - 41s - loss: 2.8003 - accuracy10: 0.5304 - val_loss: 2.7514 - val_accuracy10: 0.5585 - 41s/epoch - 28ms/step
Epoch 20/50
1454/1454 - 42s - loss: 2.7951 - accuracy10: 0.5324 - val_loss: 2.7504 - val_accuracy10: 0.5598 - 42s/epoch - 29ms/step
Epoch 21/50
1454/1454 - 40s - loss: 2.7913 - accuracy10: 0.5328 - val_loss: 2.7489 - val_accuracy10: 0.5618 - 40s/epoch - 27ms/step
Epoch 22/50
1454/1454 - 38s - loss: 2.7875 - accuracy10: 0.5327 - val_loss: 2.7491 - val_accuracy10: 0.5623 - 38s/epoch - 26ms/step
Epoch 23/50
1454/1454 - 39s - loss: 2.7830 - accuracy10: 0.5336 - val_loss: 2.7575 - val_accuracy10: 0.5532 - 39s/epoch - 27ms/step
Epoch 24/50
1454/1454 - 39s - loss: 2.7787 - accuracy10: 0.5350 - val_loss: 2.7634 - val_accuracy10: 0.5566 - 39s/epoch - 27ms/step
Epoch 25/50
1454/1454 - 40s - loss: 2.7760 - accuracy10: 0.5350 - val_loss: 2.7605 - val_accuracy10: 0.5552 - 40s/epoch - 27ms/step
Epoch 26/50
1454/1454 - 38s - loss: 2.7716 - accuracy10: 0.5363 - val_loss: 2.7555 - val_accuracy10: 0.5564 - 38s/epoch - 26ms/step
Epoch 27/50
1454/1454 - 38s - loss: 2.7674 - accuracy10: 0.5368 - val_loss: 2.7628 - val_accuracy10: 0.5584 - 38s/epoch - 26ms/step
Epoch 28/50
1454/1454 - 38s - loss: 2.7642 - accuracy10: 0.5376 - val_loss: 2.7661 - val_accuracy10: 0.5604 - 38s/epoch - 26ms/step
Epoch 29/50
1454/1454 - 38s - loss: 2.7580 - accuracy10: 0.5388 - val_loss: 2.7581 - val_accuracy10: 0.5612 - 38s/epoch - 26ms/step
Epoch 30/50
1454/1454 - 38s - loss: 2.7565 - accuracy10: 0.5383 - val_loss: 2.7566 - val_accuracy10: 0.5568 - 38s/epoch - 26ms/step
Epoch 31/50
1454/1454 - 38s - loss: 2.7515 - accuracy10: 0.5407 - val_loss: 2.7567 - val_accuracy10: 0.5566 - 38s/epoch - 26ms/step
testing model: results/WBA/W0/deepVOL_L2/h10
Evaluating performance on  test set...
5633/5633 - 69s - 69s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.789102
{'0': {'precision': 0.4078750231469791, 'recall': 0.5257961050854373, 'f1-score': 0.4593889476657983, 'support': 230403}, '1': {'precision': 0.8244926548098023, 'recall': 0.7229361841481069, 'f1-score': 0.7703818860294018, 'support': 980211}, '2': {'precision': 0.40857207941264084, 'recall': 0.5042124383703832, 'f1-score': 0.45138172350043076, 'support': 231220}, 'accuracy': 0.6563578054061702, 'macro avg': {'precision': 0.5469799191231407, 'recall': 0.5843149092013091, 'f1-score': 0.560384185731877, 'support': 1441834}, 'weighted avg': {'precision': 0.6912185694217887, 'recall': 0.6563578054061702, 'f1-score': 0.6695291362969513, 'support': 1441834}}
[[121145  76196  33062]
 [135882 708630 135699]
 [ 39988  74648 116584]]
Evaluating performance on  train set...
1454/1454 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93660223
{'0': {'precision': 0.4164512991524246, 'recall': 0.525007882475214, 'f1-score': 0.46447093828129843, 'support': 85633}, '1': {'precision': 0.7030677755663561, 'recall': 0.5609583688017403, 'f1-score': 0.6240246759072106, 'support': 200883}, '2': {'precision': 0.4204273018746209, 'recall': 0.510241998621157, 'f1-score': 0.46100084459459456, 'support': 85579}, 'accuracy': 0.5410204383289213, 'macro avg': {'precision': 0.5133154588644673, 'recall': 0.5320694166327038, 'f1-score': 0.5164988195943678, 'support': 372095}, 'weighted avg': {'precision': 0.5721014421761756, 'recall': 0.5410204383289213, 'f1-score': 0.549811150667629, 'support': 372095}}
[[ 44958  23662  17013]
 [ 45014 112687  43182]
 [ 17983  23930  43666]]
Evaluating performance on  val set...
557/557 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9108536
{'0': {'precision': 0.40767156862745096, 'recall': 0.5362024500322373, 'f1-score': 0.46318574213311053, 'support': 31020}, '1': {'precision': 0.7294076249923506, 'recall': 0.595746541878569, 'f1-score': 0.6558362507135832, 'support': 80029}, '2': {'precision': 0.4380500455210086, 'recall': 0.5062814871500542, 'f1-score': 0.46970077948202155, 'support': 31362}, 'accuracy': 0.5630744816060557, 'macro avg': {'precision': 0.5250430797136033, 'recall': 0.5460768263536201, 'f1-score': 0.5295742574429051, 'support': 142411}, 'weighted avg': {'precision': 0.5951637191436492, 'recall': 0.5630744816060557, 'f1-score': 0.5728819885784217, 'support': 142411}}
[[16633  8957  5430]
 [17413 47677 14939]
 [ 6754  8730 15878]]
training model: results/WBA/W0/deepVOL_L2/h20
Epoch 1/50
1454/1454 - 42s - loss: 3.1672 - accuracy20: 0.4403 - val_loss: 3.1147 - val_accuracy20: 0.3890 - 42s/epoch - 29ms/step
Epoch 2/50
1454/1454 - 39s - loss: 3.0613 - accuracy20: 0.4793 - val_loss: 3.0576 - val_accuracy20: 0.4311 - 39s/epoch - 27ms/step
Epoch 3/50
1454/1454 - 38s - loss: 3.0159 - accuracy20: 0.4948 - val_loss: 2.9628 - val_accuracy20: 0.5098 - 38s/epoch - 26ms/step
Epoch 4/50
1454/1454 - 40s - loss: 2.9926 - accuracy20: 0.5016 - val_loss: 2.9505 - val_accuracy20: 0.5182 - 40s/epoch - 27ms/step
Epoch 5/50
1454/1454 - 38s - loss: 2.9820 - accuracy20: 0.5053 - val_loss: 2.9376 - val_accuracy20: 0.5293 - 38s/epoch - 26ms/step
Epoch 6/50
1454/1454 - 38s - loss: 2.9737 - accuracy20: 0.5075 - val_loss: 2.9360 - val_accuracy20: 0.5258 - 38s/epoch - 26ms/step
Epoch 7/50
1454/1454 - 38s - loss: 2.9642 - accuracy20: 0.5093 - val_loss: 2.9258 - val_accuracy20: 0.5273 - 38s/epoch - 26ms/step
Epoch 8/50
1454/1454 - 39s - loss: 2.9572 - accuracy20: 0.5118 - val_loss: 2.9315 - val_accuracy20: 0.5319 - 39s/epoch - 27ms/step
Epoch 9/50
1454/1454 - 39s - loss: 2.9502 - accuracy20: 0.5126 - val_loss: 2.9230 - val_accuracy20: 0.5308 - 39s/epoch - 27ms/step
Epoch 10/50
1454/1454 - 39s - loss: 2.9440 - accuracy20: 0.5142 - val_loss: 2.9180 - val_accuracy20: 0.5308 - 39s/epoch - 27ms/step
Epoch 11/50
1454/1454 - 38s - loss: 2.9367 - accuracy20: 0.5158 - val_loss: 2.9070 - val_accuracy20: 0.5289 - 38s/epoch - 26ms/step
Epoch 12/50
1454/1454 - 38s - loss: 2.9304 - accuracy20: 0.5177 - val_loss: 2.9067 - val_accuracy20: 0.5351 - 38s/epoch - 26ms/step
Epoch 13/50
1454/1454 - 38s - loss: 2.9236 - accuracy20: 0.5183 - val_loss: 2.9072 - val_accuracy20: 0.5350 - 38s/epoch - 26ms/step
Epoch 14/50
1454/1454 - 38s - loss: 2.9175 - accuracy20: 0.5195 - val_loss: 2.9072 - val_accuracy20: 0.5326 - 38s/epoch - 26ms/step
Epoch 15/50
1454/1454 - 40s - loss: 2.9130 - accuracy20: 0.5205 - val_loss: 2.9125 - val_accuracy20: 0.5322 - 40s/epoch - 27ms/step
Epoch 16/50
1454/1454 - 40s - loss: 2.9080 - accuracy20: 0.5213 - val_loss: 2.9133 - val_accuracy20: 0.5328 - 40s/epoch - 27ms/step
Epoch 17/50
1454/1454 - 39s - loss: 2.9034 - accuracy20: 0.5228 - val_loss: 2.8964 - val_accuracy20: 0.5349 - 39s/epoch - 27ms/step
Epoch 18/50
1454/1454 - 40s - loss: 2.9006 - accuracy20: 0.5228 - val_loss: 2.9070 - val_accuracy20: 0.5339 - 40s/epoch - 27ms/step
Epoch 19/50
1454/1454 - 43s - loss: 2.8960 - accuracy20: 0.5237 - val_loss: 2.9073 - val_accuracy20: 0.5293 - 43s/epoch - 29ms/step
Epoch 20/50
1454/1454 - 42s - loss: 2.8914 - accuracy20: 0.5246 - val_loss: 2.9076 - val_accuracy20: 0.5352 - 42s/epoch - 29ms/step
Epoch 21/50
1454/1454 - 40s - loss: 2.8870 - accuracy20: 0.5253 - val_loss: 2.9045 - val_accuracy20: 0.5337 - 40s/epoch - 27ms/step
Epoch 22/50
1454/1454 - 40s - loss: 2.8834 - accuracy20: 0.5261 - val_loss: 2.9026 - val_accuracy20: 0.5335 - 40s/epoch - 28ms/step
Epoch 23/50
1454/1454 - 39s - loss: 2.8793 - accuracy20: 0.5269 - val_loss: 2.9112 - val_accuracy20: 0.5305 - 39s/epoch - 27ms/step
Epoch 24/50
1454/1454 - 39s - loss: 2.8763 - accuracy20: 0.5279 - val_loss: 2.8928 - val_accuracy20: 0.5309 - 39s/epoch - 27ms/step
Epoch 25/50
1454/1454 - 39s - loss: 2.8731 - accuracy20: 0.5281 - val_loss: 2.8943 - val_accuracy20: 0.5328 - 39s/epoch - 27ms/step
Epoch 26/50
1454/1454 - 39s - loss: 2.8689 - accuracy20: 0.5294 - val_loss: 2.8988 - val_accuracy20: 0.5309 - 39s/epoch - 27ms/step
Epoch 27/50
1454/1454 - 40s - loss: 2.8658 - accuracy20: 0.5295 - val_loss: 2.9009 - val_accuracy20: 0.5318 - 40s/epoch - 28ms/step
Epoch 28/50
1454/1454 - 39s - loss: 2.8625 - accuracy20: 0.5305 - val_loss: 2.9022 - val_accuracy20: 0.5289 - 39s/epoch - 27ms/step
Epoch 29/50
1454/1454 - 40s - loss: 2.8595 - accuracy20: 0.5317 - val_loss: 2.8953 - val_accuracy20: 0.5332 - 40s/epoch - 27ms/step
Epoch 30/50
1454/1454 - 42s - loss: 2.8563 - accuracy20: 0.5321 - val_loss: 2.8966 - val_accuracy20: 0.5312 - 42s/epoch - 29ms/step
Epoch 31/50
1454/1454 - 40s - loss: 2.8535 - accuracy20: 0.5325 - val_loss: 2.9001 - val_accuracy20: 0.5302 - 40s/epoch - 28ms/step
Epoch 32/50
1454/1454 - 39s - loss: 2.8505 - accuracy20: 0.5334 - val_loss: 2.9008 - val_accuracy20: 0.5299 - 39s/epoch - 27ms/step
Epoch 33/50
1454/1454 - 42s - loss: 2.8475 - accuracy20: 0.5333 - val_loss: 2.9027 - val_accuracy20: 0.5282 - 42s/epoch - 29ms/step
Epoch 34/50
1454/1454 - 40s - loss: 2.8459 - accuracy20: 0.5342 - val_loss: 2.9076 - val_accuracy20: 0.5321 - 40s/epoch - 28ms/step
testing model: results/WBA/W0/deepVOL_L2/h20
Evaluating performance on  test set...
5633/5633 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84675455
{'0': {'precision': 0.4657904287152238, 'recall': 0.45731063738243616, 'f1-score': 0.46151158451779234, 'support': 297498}, '1': {'precision': 0.7437202449089809, 'recall': 0.7491071639743621, 'f1-score': 0.7464039850002799, 'support': 845620}, '2': {'precision': 0.45172428835564266, 'recall': 0.4506521244258761, 'f1-score': 0.45118756944176774, 'support': 298716}, 'accuracy': 0.6270666387392724, 'macro avg': {'precision': 0.5537449873266158, 'recall': 0.5523566419275582, 'f1-score': 0.5530343796532801, 'support': 1441834}, 'weighted avg': {'precision': 0.6258790588807714, 'recall': 0.6270666387392724, 'f1-score': 0.6264589801323717, 'support': 1441834}}
[[136049 110464  50985]
 [ 99755 633460 112405]
 [ 56278 107821 134617]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9808215
{'0': {'precision': 0.4638827890932691, 'recall': 0.48667605607528935, 'f1-score': 0.4750061449106484, 'support': 107213}, '1': {'precision': 0.5858696435946011, 'recall': 0.5675756344146112, 'f1-score': 0.5765775646008793, 'support': 157468}, '2': {'precision': 0.4648664804834537, 'recall': 0.4633474221237455, 'f1-score': 0.464105708304387, 'support': 107414}, 'accuracy': 0.5141778309302731, 'macro avg': {'precision': 0.5048729710571079, 'recall': 0.5058663708712153, 'f1-score': 0.5052298059386383, 'support': 372095}, 'weighted avg': {'precision': 0.5157907379547186, 'recall': 0.5141778309302731, 'f1-score': 0.5148437907219502, 'support': 372095}}
[[52178 31178 23857]
 [34657 89375 33436]
 [25646 31998 49770]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9592099
{'0': {'precision': 0.4554647055977551, 'recall': 0.4836745703496288, 'f1-score': 0.4691459540272846, 'support': 38927}, '1': {'precision': 0.612980884972796, 'recall': 0.6017583387165388, 'f1-score': 0.6073177712759191, 'support': 63469}, '2': {'precision': 0.4788732394366197, 'recall': 0.4639260277395976, 'f1-score': 0.47128114646932634, 'support': 40015}, 'accuracy': 0.5307525401829915, 'macro avg': {'precision': 0.5157729433357237, 'recall': 0.5164529789352551, 'f1-score': 0.51591495725751, 'support': 142411}, 'weighted avg': {'precision': 0.5322430925925563, 'recall': 0.5307525401829915, 'f1-score': 0.5313256086503255, 'support': 142411}}
[[18828 12123  7976]
 [13050 38193 12226]
 [ 9460 11991 18564]]
training model: results/WBA/W0/deepVOL_L2/h30
Epoch 1/50
1454/1454 - 43s - loss: 3.1981 - accuracy30: 0.4267 - val_loss: 3.1757 - val_accuracy30: 0.4204 - 43s/epoch - 30ms/step
Epoch 2/50
1454/1454 - 41s - loss: 3.1089 - accuracy30: 0.4657 - val_loss: 3.0965 - val_accuracy30: 0.4599 - 41s/epoch - 28ms/step
Epoch 3/50
1454/1454 - 41s - loss: 3.0606 - accuracy30: 0.4816 - val_loss: 3.0506 - val_accuracy30: 0.4861 - 41s/epoch - 28ms/step
Epoch 4/50
1454/1454 - 43s - loss: 3.0364 - accuracy30: 0.4890 - val_loss: 3.0367 - val_accuracy30: 0.4894 - 43s/epoch - 30ms/step
Epoch 5/50
1454/1454 - 40s - loss: 3.0223 - accuracy30: 0.4923 - val_loss: 3.0312 - val_accuracy30: 0.4901 - 40s/epoch - 28ms/step
Epoch 6/50
1454/1454 - 43s - loss: 3.0115 - accuracy30: 0.4954 - val_loss: 3.0256 - val_accuracy30: 0.4944 - 43s/epoch - 30ms/step
Epoch 7/50
1454/1454 - 42s - loss: 3.0044 - accuracy30: 0.4978 - val_loss: 3.0177 - val_accuracy30: 0.4941 - 42s/epoch - 29ms/step
Epoch 8/50
1454/1454 - 42s - loss: 2.9977 - accuracy30: 0.4998 - val_loss: 3.0143 - val_accuracy30: 0.4952 - 42s/epoch - 29ms/step
Epoch 9/50
1454/1454 - 40s - loss: 2.9911 - accuracy30: 0.5005 - val_loss: 3.0072 - val_accuracy30: 0.4996 - 40s/epoch - 27ms/step
Epoch 10/50
1454/1454 - 39s - loss: 2.9863 - accuracy30: 0.5019 - val_loss: 2.9986 - val_accuracy30: 0.4990 - 39s/epoch - 27ms/step
Epoch 11/50
1454/1454 - 39s - loss: 2.9801 - accuracy30: 0.5040 - val_loss: 3.0014 - val_accuracy30: 0.4999 - 39s/epoch - 27ms/step
Epoch 12/50
1454/1454 - 39s - loss: 2.9762 - accuracy30: 0.5043 - val_loss: 3.0003 - val_accuracy30: 0.5016 - 39s/epoch - 27ms/step
Epoch 13/50
1454/1454 - 40s - loss: 2.9718 - accuracy30: 0.5063 - val_loss: 2.9957 - val_accuracy30: 0.5021 - 40s/epoch - 27ms/step
Epoch 14/50
1454/1454 - 39s - loss: 2.9654 - accuracy30: 0.5067 - val_loss: 3.0024 - val_accuracy30: 0.4999 - 39s/epoch - 27ms/step
Epoch 15/50
1454/1454 - 39s - loss: 2.9625 - accuracy30: 0.5078 - val_loss: 2.9990 - val_accuracy30: 0.5011 - 39s/epoch - 27ms/step
Epoch 16/50
1454/1454 - 40s - loss: 2.9584 - accuracy30: 0.5093 - val_loss: 2.9972 - val_accuracy30: 0.4995 - 40s/epoch - 27ms/step
Epoch 17/50
1454/1454 - 39s - loss: 2.9548 - accuracy30: 0.5101 - val_loss: 3.0020 - val_accuracy30: 0.4985 - 39s/epoch - 27ms/step
Epoch 18/50
1454/1454 - 39s - loss: 2.9512 - accuracy30: 0.5104 - val_loss: 2.9921 - val_accuracy30: 0.5026 - 39s/epoch - 27ms/step
Epoch 19/50
1454/1454 - 40s - loss: 2.9475 - accuracy30: 0.5113 - val_loss: 2.9885 - val_accuracy30: 0.5021 - 40s/epoch - 27ms/step
Epoch 20/50
1454/1454 - 40s - loss: 2.9441 - accuracy30: 0.5121 - val_loss: 2.9876 - val_accuracy30: 0.5014 - 40s/epoch - 27ms/step
Epoch 21/50
1454/1454 - 40s - loss: 2.9398 - accuracy30: 0.5130 - val_loss: 2.9858 - val_accuracy30: 0.5014 - 40s/epoch - 28ms/step
Epoch 22/50
1454/1454 - 40s - loss: 2.9377 - accuracy30: 0.5135 - val_loss: 2.9923 - val_accuracy30: 0.5005 - 40s/epoch - 27ms/step
Epoch 23/50
1454/1454 - 39s - loss: 2.9339 - accuracy30: 0.5146 - val_loss: 2.9959 - val_accuracy30: 0.4993 - 39s/epoch - 27ms/step
Epoch 24/50
1454/1454 - 40s - loss: 2.9317 - accuracy30: 0.5154 - val_loss: 2.9949 - val_accuracy30: 0.5002 - 40s/epoch - 27ms/step
Epoch 25/50
1454/1454 - 39s - loss: 2.9272 - accuracy30: 0.5163 - val_loss: 2.9949 - val_accuracy30: 0.5002 - 39s/epoch - 27ms/step
Epoch 26/50
1454/1454 - 40s - loss: 2.9244 - accuracy30: 0.5171 - val_loss: 2.9889 - val_accuracy30: 0.5021 - 40s/epoch - 27ms/step
Epoch 27/50
1454/1454 - 41s - loss: 2.9219 - accuracy30: 0.5169 - val_loss: 2.9908 - val_accuracy30: 0.4991 - 41s/epoch - 28ms/step
Epoch 28/50
1454/1454 - 41s - loss: 2.9183 - accuracy30: 0.5180 - val_loss: 2.9874 - val_accuracy30: 0.5029 - 41s/epoch - 28ms/step
Epoch 29/50
1454/1454 - 43s - loss: 2.9153 - accuracy30: 0.5192 - val_loss: 2.9902 - val_accuracy30: 0.5003 - 43s/epoch - 29ms/step
Epoch 30/50
1454/1454 - 41s - loss: 2.9124 - accuracy30: 0.5194 - val_loss: 2.9945 - val_accuracy30: 0.4977 - 41s/epoch - 28ms/step
Epoch 31/50
1454/1454 - 41s - loss: 2.9094 - accuracy30: 0.5203 - val_loss: 2.9969 - val_accuracy30: 0.5022 - 41s/epoch - 28ms/step
testing model: results/WBA/W0/deepVOL_L2/h30
Evaluating performance on  test set...
5633/5633 - 90s - 90s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.907521
{'0': {'precision': 0.46727334007414895, 'recall': 0.4461490303461148, 'f1-score': 0.45646691898897473, 'support': 341823}, '1': {'precision': 0.6936215704411165, 'recall': 0.7141439896156877, 'f1-score': 0.7037331920214474, 'support': 754985}, '2': {'precision': 0.46309675549548857, 'recall': 0.453855651458151, 'f1-score': 0.458429637262924, 'support': 345026}, 'accuracy': 0.5883229276047035, 'macro avg': {'precision': 0.541330555336918, 'recall': 0.5380495571399845, 'f1-score': 0.5395432494244486, 'support': 1441834}, 'weighted avg': {'precision': 0.5847962230362431, 'recall': 0.5883229276047035, 'f1-score': 0.5864121942291265, 'support': 1441834}}
[[152504 115790  73529]
 [107797 539168 108020]
 [ 66069 122365 156592]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0096885
{'0': {'precision': 0.4805018680059146, 'recall': 0.45543355669077157, 'f1-score': 0.46763199461845983, 'support': 120584}, '1': {'precision': 0.503705091978548, 'recall': 0.5364625317641278, 'f1-score': 0.5195680056508727, 'support': 130257}, '2': {'precision': 0.4748307774997061, 'recall': 0.46629389545911887, 'f1-score': 0.470523617722446, 'support': 121254}, 'accuracy': 0.48733791101734775, 'macro avg': {'precision': 0.48634591249472287, 'recall': 0.4860633279713394, 'f1-score': 0.48590787266392615, 'support': 372095}, 'weighted avg': {'precision': 0.4867764482522589, 'recall': 0.48733791101734775, 'f1-score': 0.48675520201683864, 'support': 372095}}
[[54918 33185 32481]
 [30326 69878 30053]
 [29049 35665 56540]]
Evaluating performance on  val set...
557/557 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99476844
{'0': {'precision': 0.4672842028788085, 'recall': 0.4672735941153768, 'f1-score': 0.46727889843687925, 'support': 44047}, '1': {'precision': 0.5288718261931769, 'recall': 0.57539109963548, 'f1-score': 0.5511516044263801, 'support': 52672}, '2': {'precision': 0.497467121285923, 'recall': 0.4470366803816861, 'f1-score': 0.4709055699004058, 'support': 45692}, 'accuracy': 0.5007689012786933, 'macro avg': {'precision': 0.49787438345263607, 'recall': 0.49656712471084763, 'f1-score': 0.4964453575878884, 'support': 142411}, 'weighted avg': {'precision': 0.49974701265524624, 'recall': 0.5007689012786933, 'f1-score': 0.49946358250194756, 'support': 142411}}
[[20582 12999 10466]
 [12197 30307 10168]
 [11267 13999 20426]]
training model: results/WBA/W0/deepVOL_L2/h50
Epoch 1/50
1454/1454 - 42s - loss: 3.2283 - accuracy50: 0.4137 - val_loss: 3.2295 - val_accuracy50: 0.3935 - 42s/epoch - 29ms/step
Epoch 2/50
1454/1454 - 40s - loss: 3.1521 - accuracy50: 0.4474 - val_loss: 3.1774 - val_accuracy50: 0.4326 - 40s/epoch - 28ms/step
Epoch 3/50
1454/1454 - 39s - loss: 3.1248 - accuracy50: 0.4586 - val_loss: 3.1488 - val_accuracy50: 0.4467 - 39s/epoch - 27ms/step
Epoch 4/50
1454/1454 - 41s - loss: 3.1104 - accuracy50: 0.4631 - val_loss: 3.1347 - val_accuracy50: 0.4561 - 41s/epoch - 28ms/step
Epoch 5/50
1454/1454 - 40s - loss: 3.1001 - accuracy50: 0.4665 - val_loss: 3.1271 - val_accuracy50: 0.4555 - 40s/epoch - 28ms/step
Epoch 6/50
1454/1454 - 39s - loss: 3.0923 - accuracy50: 0.4691 - val_loss: 3.1175 - val_accuracy50: 0.4591 - 39s/epoch - 27ms/step
Epoch 7/50
1454/1454 - 39s - loss: 3.0858 - accuracy50: 0.4709 - val_loss: 3.1237 - val_accuracy50: 0.4538 - 39s/epoch - 27ms/step
Epoch 8/50
1454/1454 - 39s - loss: 3.0803 - accuracy50: 0.4724 - val_loss: 3.1216 - val_accuracy50: 0.4551 - 39s/epoch - 27ms/step
Epoch 9/50
1454/1454 - 39s - loss: 3.0765 - accuracy50: 0.4740 - val_loss: 3.1248 - val_accuracy50: 0.4518 - 39s/epoch - 27ms/step
Epoch 10/50
1454/1454 - 40s - loss: 3.0726 - accuracy50: 0.4754 - val_loss: 3.1281 - val_accuracy50: 0.4524 - 40s/epoch - 28ms/step
Epoch 11/50
1454/1454 - 39s - loss: 3.0682 - accuracy50: 0.4768 - val_loss: 3.1304 - val_accuracy50: 0.4530 - 39s/epoch - 27ms/step
Epoch 12/50
1454/1454 - 40s - loss: 3.0649 - accuracy50: 0.4783 - val_loss: 3.1367 - val_accuracy50: 0.4510 - 40s/epoch - 27ms/step
Epoch 13/50
1454/1454 - 40s - loss: 3.0611 - accuracy50: 0.4792 - val_loss: 3.1389 - val_accuracy50: 0.4525 - 40s/epoch - 27ms/step
Epoch 14/50
1454/1454 - 39s - loss: 3.0576 - accuracy50: 0.4799 - val_loss: 3.1330 - val_accuracy50: 0.4532 - 39s/epoch - 27ms/step
Epoch 15/50
1454/1454 - 39s - loss: 3.0535 - accuracy50: 0.4821 - val_loss: 3.1449 - val_accuracy50: 0.4486 - 39s/epoch - 27ms/step
Epoch 16/50
1454/1454 - 40s - loss: 3.0515 - accuracy50: 0.4824 - val_loss: 3.1358 - val_accuracy50: 0.4524 - 40s/epoch - 27ms/step
testing model: results/WBA/W0/deepVOL_L2/h50
Evaluating performance on  test set...
5633/5633 - 79s - 79s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9738573
{'0': {'precision': 0.473152438428771, 'recall': 0.3143176355080069, 'f1-score': 0.37771633641463087, 'support': 354444}, '1': {'precision': 0.6226519306378896, 'recall': 0.7814599680128282, 'f1-score': 0.6930751861970375, 'support': 718413}, '2': {'precision': 0.4488432382765071, 'recall': 0.3706897719912081, 'f1-score': 0.40604001442763693, 'support': 368977}, 'accuracy': 0.56150361275986, 'macro avg': {'precision': 0.5148825357810559, 'recall': 0.4888224585040144, 'f1-score': 0.49227717901310175, 'support': 1441834}, 'weighted avg': {'precision': 0.5414216309653929, 'recall': 0.56150361275986, 'f1-score': 0.5420963434687945, 'support': 1441834}}
[[111408 161696  81340]
 [ 70388 561411  86614]
 [ 53663 178538 136776]]
Evaluating performance on  train set...
1454/1454 - 23s - 23s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0490891
{'0': {'precision': 0.47282914377190327, 'recall': 0.3538907418801205, 'f1-score': 0.4048042375078713, 'support': 123524}, '1': {'precision': 0.43645759643169746, 'recall': 0.5940159433415743, 'f1-score': 0.5031915150970587, 'support': 122559}, '2': {'precision': 0.4440761779849523, 'recall': 0.3976605402660064, 'f1-score': 0.419588617266687, 'support': 126012}, 'accuracy': 0.4478049960359586, 'macro avg': {'precision': 0.4511209727295176, 'recall': 0.44852240849590036, 'f1-score': 0.442528123290539, 'support': 372095}, 'weighted avg': {'precision': 0.45111189630764403, 'recall': 0.4478049960359586, 'f1-score': 0.4422174132189695, 'support': 372095}}
[[43714 44570 35240]
 [22266 72802 27491]
 [26472 49430 50110]]
Evaluating performance on  val set...
557/557 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0395324
{'0': {'precision': 0.46378424657534245, 'recall': 0.3547943411055803, 'f1-score': 0.4020335460887635, 'support': 45804}, '1': {'precision': 0.4452006806125513, 'recall': 0.6480726001165599, 'f1-score': 0.5278138005272036, 'support': 48044}, '2': {'precision': 0.47764064753966984, 'recall': 0.3681815373844285, 'f1-score': 0.4158284591322953, 'support': 48563}, 'accuracy': 0.4583002717486711, 'macro avg': {'precision': 0.4622085249091879, 'recall': 0.4570161595355229, 'f1-score': 0.4485586019160875, 'support': 142411}, 'weighted avg': {'precision': 0.4622399807315123, 'recall': 0.4583002717486711, 'f1-score': 0.44917111907380997, 'support': 142411}}
[[16251 18352 11201]
 [ 8555 31136  8353]
 [10234 20449 17880]]
training model: results/WBA/W0/deepVOL_L2/h100
Epoch 1/50
1454/1454 - 45s - loss: 3.2795 - accuracy100: 0.3839 - val_loss: 3.2880 - val_accuracy100: 0.3460 - 45s/epoch - 31ms/step
Epoch 2/50
1454/1454 - 41s - loss: 3.2453 - accuracy100: 0.4003 - val_loss: 3.2944 - val_accuracy100: 0.3388 - 41s/epoch - 28ms/step
Epoch 3/50
1454/1454 - 38s - loss: 3.2298 - accuracy100: 0.4095 - val_loss: 3.3083 - val_accuracy100: 0.3244 - 38s/epoch - 26ms/step
Epoch 4/50
1454/1454 - 39s - loss: 3.2252 - accuracy100: 0.4114 - val_loss: 3.3171 - val_accuracy100: 0.3265 - 39s/epoch - 27ms/step
Epoch 5/50
1454/1454 - 39s - loss: 3.2208 - accuracy100: 0.4149 - val_loss: 3.3150 - val_accuracy100: 0.3314 - 39s/epoch - 27ms/step
Epoch 6/50
1454/1454 - 40s - loss: 3.2188 - accuracy100: 0.4153 - val_loss: 3.3168 - val_accuracy100: 0.3366 - 40s/epoch - 27ms/step
Epoch 7/50
1454/1454 - 40s - loss: 3.2165 - accuracy100: 0.4175 - val_loss: 3.3210 - val_accuracy100: 0.3399 - 40s/epoch - 27ms/step
Epoch 8/50
1454/1454 - 39s - loss: 3.2135 - accuracy100: 0.4182 - val_loss: 3.3344 - val_accuracy100: 0.3426 - 39s/epoch - 27ms/step
Epoch 9/50
1454/1454 - 39s - loss: 3.2109 - accuracy100: 0.4198 - val_loss: 3.3251 - val_accuracy100: 0.3451 - 39s/epoch - 27ms/step
Epoch 10/50
1454/1454 - 39s - loss: 3.2081 - accuracy100: 0.4211 - val_loss: 3.3240 - val_accuracy100: 0.3482 - 39s/epoch - 27ms/step
Epoch 11/50
1454/1454 - 39s - loss: 3.2053 - accuracy100: 0.4225 - val_loss: 3.3162 - val_accuracy100: 0.3509 - 39s/epoch - 27ms/step
testing model: results/WBA/W0/deepVOL_L2/h100
Evaluating performance on  test set...
5633/5633 - 75s - 75s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0735432
{'0': {'precision': 0.3252241000077371, 'recall': 0.3259861624280563, 'f1-score': 0.3256046853257126, 'support': 361046}, '1': {'precision': 0.49827187887489394, 'recall': 0.5451366229463719, 'f1-score': 0.520651784770549, 'support': 700285}, '2': {'precision': 0.3199890373240873, 'recall': 0.26388753833741124, 'f1-score': 0.28924304510330623, 'support': 380503}, 'accuracy': 0.41603749113975674, 'macro avg': {'precision': 0.3811616720689061, 'recall': 0.37833677457061315, 'f1-score': 0.3784998383998559, 'support': 1441834}, 'weighted avg': {'precision': 0.4078902091213175, 'recall': 0.41603749113975674, 'f1-score': 0.4107412855481938, 'support': 1441834}}
[[117696 178861  64489]
 [169641 381751 148893]
 [ 74555 205538 100410]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0930983
{'0': {'precision': 0.38149656376024216, 'recall': 0.3138032555536631, 'f1-score': 0.3443546520941989, 'support': 123297}, '1': {'precision': 0.337897445322551, 'recall': 0.508786495087865, 'f1-score': 0.4060964161466674, 'support': 122859}, '2': {'precision': 0.38651058565392965, 'recall': 0.2629606396747632, 'f1-score': 0.3129840611281489, 'support': 125939}, 'accuracy': 0.3609750198202072, 'macro avg': {'precision': 0.3686348649122409, 'recall': 0.36185013010543043, 'f1-score': 0.3544783764563384, 'support': 372095}, 'weighted avg': {'precision': 0.36879797015144017, 'recall': 0.3609750198202072, 'f1-score': 0.3541229922601481, 'support': 372095}}
[[38691 59161 25445]
 [33230 62509 27120]
 [29498 63324 33117]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0967382
{'0': {'precision': 0.3882027354649833, 'recall': 0.34566820088794753, 'f1-score': 0.36570283547358445, 'support': 49102}, '1': {'precision': 0.29667938432971147, 'recall': 0.48505763483705705, 'f1-score': 0.36817138485080336, 'support': 42162}, '2': {'precision': 0.4057332974862213, 'recall': 0.23604512483625628, 'f1-score': 0.2984561759143666, 'support': 51147}, 'accuracy': 0.3475644437578558, 'macro avg': {'precision': 0.36353847242697207, 'recall': 0.3555903201870869, 'f1-score': 0.34411013207958474, 'support': 142411}, 'weighted avg': {'precision': 0.3674025734349079, 'recall': 0.3475644437578558, 'f1-score': 0.34228199075208815, 'support': 142411}}
[[16973 23056  9073]
 [13101 20451  8610]
 [13648 25426 12073]]
training model: results/WBA/W0/deepVOL_L2/h200
Epoch 1/50
1454/1454 - 42s - loss: 3.3031 - accuracy200: 0.3624 - val_loss: 3.3098 - val_accuracy200: 0.3398 - 42s/epoch - 29ms/step
Epoch 2/50
1454/1454 - 39s - loss: 3.2813 - accuracy200: 0.3692 - val_loss: 3.2953 - val_accuracy200: 0.3477 - 39s/epoch - 27ms/step
Epoch 3/50
1454/1454 - 39s - loss: 3.2691 - accuracy200: 0.3808 - val_loss: 3.2957 - val_accuracy200: 0.3491 - 39s/epoch - 27ms/step
Epoch 4/50
1454/1454 - 40s - loss: 3.2634 - accuracy200: 0.3862 - val_loss: 3.2946 - val_accuracy200: 0.3565 - 40s/epoch - 27ms/step
Epoch 5/50
1454/1454 - 39s - loss: 3.2601 - accuracy200: 0.3897 - val_loss: 3.2943 - val_accuracy200: 0.3569 - 39s/epoch - 27ms/step
Epoch 6/50
1454/1454 - 40s - loss: 3.2561 - accuracy200: 0.3920 - val_loss: 3.2934 - val_accuracy200: 0.3561 - 40s/epoch - 28ms/step
Epoch 7/50
1454/1454 - 41s - loss: 3.2536 - accuracy200: 0.3935 - val_loss: 3.2999 - val_accuracy200: 0.3495 - 41s/epoch - 28ms/step
Epoch 8/50
1454/1454 - 41s - loss: 3.2517 - accuracy200: 0.3949 - val_loss: 3.3000 - val_accuracy200: 0.3516 - 41s/epoch - 28ms/step
Epoch 9/50
1454/1454 - 41s - loss: 3.2488 - accuracy200: 0.3971 - val_loss: 3.2996 - val_accuracy200: 0.3528 - 41s/epoch - 28ms/step
Epoch 10/50
1454/1454 - 42s - loss: 3.2462 - accuracy200: 0.3980 - val_loss: 3.3036 - val_accuracy200: 0.3500 - 42s/epoch - 29ms/step
Epoch 11/50
1454/1454 - 43s - loss: 3.2443 - accuracy200: 0.3993 - val_loss: 3.3032 - val_accuracy200: 0.3488 - 43s/epoch - 30ms/step
Epoch 12/50
1454/1454 - 39s - loss: 3.2415 - accuracy200: 0.4015 - val_loss: 3.3046 - val_accuracy200: 0.3503 - 39s/epoch - 27ms/step
Epoch 13/50
1454/1454 - 39s - loss: 3.2392 - accuracy200: 0.4018 - val_loss: 3.3040 - val_accuracy200: 0.3544 - 39s/epoch - 27ms/step
Epoch 14/50
1454/1454 - 40s - loss: 3.2369 - accuracy200: 0.4037 - val_loss: 3.3056 - val_accuracy200: 0.3541 - 40s/epoch - 27ms/step
Epoch 15/50
1454/1454 - 39s - loss: 3.2348 - accuracy200: 0.4056 - val_loss: 3.3060 - val_accuracy200: 0.3528 - 39s/epoch - 27ms/step
Epoch 16/50
1454/1454 - 40s - loss: 3.2333 - accuracy200: 0.4061 - val_loss: 3.3121 - val_accuracy200: 0.3504 - 40s/epoch - 27ms/step
testing model: results/WBA/W0/deepVOL_L2/h200
Evaluating performance on  test set...
5633/5633 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0881106
{'0': {'precision': 0.3276050279171501, 'recall': 0.38834013879303736, 'f1-score': 0.3553964407504468, 'support': 417312}, '1': {'precision': 0.40410360728952377, 'recall': 0.46411977465837767, 'f1-score': 0.43203737437494066, 'support': 569269}, '2': {'precision': 0.37367773342287647, 'recall': 0.24077820464664704, 'f1-score': 0.292855673435801, 'support': 455253}, 'accuracy': 0.37166761222165656, 'macro avg': {'precision': 0.3684621228765168, 'recall': 0.3644127060326874, 'f1-score': 0.3600964961870628, 'support': 1441834}, 'weighted avg': {'precision': 0.37235567686864535, 'recall': 0.37166761222165656, 'f1-score': 0.36590904879075353, 'support': 1441834}}
[[162059 184120  71133]
 [192467 264209 112593]
 [140152 205486 109615]]
Evaluating performance on  train set...
1454/1454 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0958462
{'0': {'precision': 0.3651780876819285, 'recall': 0.40037919782571546, 'f1-score': 0.3819693511574828, 'support': 122891}, '1': {'precision': 0.34899358548993586, 'recall': 0.44915006100040666, 'f1-score': 0.39278766648292046, 'support': 122950}, '2': {'precision': 0.38733364508423596, 'recall': 0.2427408240530993, 'f1-score': 0.2984462719778748, 'support': 126254}, 'accuracy': 0.3630067590265927, 'macro avg': {'precision': 0.3671684394187001, 'recall': 0.36409002762640713, 'f1-score': 0.3577344298727594, 'support': 372095}, 'weighted avg': {'precision': 0.36734781100464287, 'recall': 0.3630067590265927, 'f1-score': 0.35720414074218654, 'support': 372095}}
[[49203 49327 24361]
 [43612 55223 24115]
 [41922 53685 30647]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0984676
{'0': {'precision': 0.3590069905000896, 'recall': 0.42425333615759375, 'f1-score': 0.38891262135922333, 'support': 47210}, '1': {'precision': 0.34144344978926466, 'recall': 0.41891920767537766, 'f1-score': 0.3762342036328046, 'support': 46799}, '2': {'precision': 0.3747217751600863, 'recall': 0.2260856989380604, 'f1-score': 0.28201791121706077, 'support': 48402}, 'accuracy': 0.35514812760250264, 'macro avg': {'precision': 0.3583907384831469, 'recall': 0.35641941425701057, 'f1-score': 0.34905491206969624, 'support': 142411}, 'weighted avg': {'precision': 0.35857634164141483, 'recall': 0.35514812760250264, 'f1-score': 0.3484153632016398, 'support': 142411}}
[[20029 18105  9076]
 [18010 19605  9184]
 [17751 19708 10943]]
training model: results/WBA/W0/deepVOL_L2/h300
Epoch 1/50
1454/1454 - 43s - loss: 3.2984 - accuracy300: 0.3656 - val_loss: 3.2968 - val_accuracy300: 0.3455 - 43s/epoch - 30ms/step
Epoch 2/50
1454/1454 - 41s - loss: 3.2905 - accuracy300: 0.3581 - val_loss: 3.2940 - val_accuracy300: 0.3471 - 41s/epoch - 28ms/step
Epoch 3/50
1454/1454 - 40s - loss: 3.2928 - accuracy300: 0.3538 - val_loss: 3.2947 - val_accuracy300: 0.3503 - 40s/epoch - 27ms/step
Epoch 4/50
1454/1454 - 40s - loss: 3.2890 - accuracy300: 0.3593 - val_loss: 3.2944 - val_accuracy300: 0.3482 - 40s/epoch - 27ms/step
Epoch 5/50
1454/1454 - 40s - loss: 3.2850 - accuracy300: 0.3645 - val_loss: 3.3032 - val_accuracy300: 0.3321 - 40s/epoch - 28ms/step
Epoch 6/50
1454/1454 - 39s - loss: 3.2821 - accuracy300: 0.3683 - val_loss: 3.3130 - val_accuracy300: 0.3252 - 39s/epoch - 27ms/step
Epoch 7/50
1454/1454 - 40s - loss: 3.2801 - accuracy300: 0.3713 - val_loss: 3.3144 - val_accuracy300: 0.3286 - 40s/epoch - 27ms/step
Epoch 8/50
1454/1454 - 39s - loss: 3.2790 - accuracy300: 0.3721 - val_loss: 3.3147 - val_accuracy300: 0.3257 - 39s/epoch - 27ms/step
Epoch 9/50
1454/1454 - 39s - loss: 3.2754 - accuracy300: 0.3768 - val_loss: 3.3137 - val_accuracy300: 0.3313 - 39s/epoch - 27ms/step
Epoch 10/50
1454/1454 - 40s - loss: 3.2716 - accuracy300: 0.3782 - val_loss: 3.3168 - val_accuracy300: 0.3279 - 40s/epoch - 27ms/step
Epoch 11/50
1454/1454 - 41s - loss: 3.2684 - accuracy300: 0.3825 - val_loss: 3.3165 - val_accuracy300: 0.3330 - 41s/epoch - 28ms/step
Epoch 12/50
1454/1454 - 41s - loss: 3.2664 - accuracy300: 0.3835 - val_loss: 3.3179 - val_accuracy300: 0.3352 - 41s/epoch - 28ms/step
testing model: results/WBA/W0/deepVOL_L2/h300
Evaluating performance on  test set...
5633/5633 - 83s - 83s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0992012
{'0': {'precision': 0.26389546753777054, 'recall': 0.45379095339072306, 'f1-score': 0.3337206120035733, 'support': 356045}, '1': {'precision': 0.4975108131343761, 'recall': 0.21111320069059816, 'f1-score': 0.29643675091406724, 'support': 707213}, '2': {'precision': 0.27416588918309454, 'recall': 0.38345536959553694, 'f1-score': 0.31972926958731895, 'support': 378576}, 'accuracy': 0.31629091837201784, 'macro avg': {'precision': 0.3451907232850804, 'recall': 0.3494531745589527, 'f1-score': 0.31662887750165314, 'support': 1441834}, 'weighted avg': {'precision': 0.38117938825972075, 'recall': 0.31629091837201784, 'f1-score': 0.3117594030854393, 'support': 1441834}}
[[161570  69932 124543]
 [298135 149302 259776]
 [152545  80864 145167]]
Evaluating performance on  train set...
1454/1454 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0986747
{'0': {'precision': 0.3420076291999791, 'recall': 0.4782725191211575, 'f1-score': 0.398821916417001, 'support': 123162}, '1': {'precision': 0.33405038401425136, 'recall': 0.1617607565165732, 'f1-score': 0.2179710717066377, 'support': 122879}, '2': {'precision': 0.34680355374432703, 'recall': 0.38615989972551445, 'f1-score': 0.36542511063649297, 'support': 126054}, 'accuracy': 0.3425442427337105, 'macro avg': {'precision': 0.34095385565285247, 'recall': 0.3420643917877484, 'f1-score': 0.3274060329200439, 'support': 372095}, 'weighted avg': {'precision': 0.34100457122106564, 'recall': 0.3425442427337105, 'f1-score': 0.32778475681254277, 'support': 372095}}
[[58905 19059 45198]
 [56518 19877 46484]
 [56810 20567 48677]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0985513
{'0': {'precision': 0.3516502990474784, 'recall': 0.48907328294446273, 'f1-score': 0.40913034887416994, 'support': 48688}, '1': {'precision': 0.3187502596701151, 'recall': 0.17266446109873293, 'f1-score': 0.22399346004496218, 'support': 44433}, '2': {'precision': 0.3550477018191874, 'recall': 0.36467843375938325, 'f1-score': 0.35979863286527813, 'support': 49290}, 'accuracy': 0.347297610437396, 'macro avg': {'precision': 0.34181608684559367, 'recall': 0.342138725934193, 'f1-score': 0.33097414726147006, 'support': 142411}, 'weighted avg': {'precision': 0.342561187482804, 'recall': 0.347297610437396, 'f1-score': 0.334292396304309, 'support': 142411}}
[[23812  8007 16869]
 [20978  7672 15783]
 [22925  8390 17975]]
training model: results/WBA/W0/deepVOL_L2/h500
Epoch 1/50
1454/1454 - 42s - loss: 3.2928 - accuracy500: 0.3711 - val_loss: 3.3130 - val_accuracy500: 0.3168 - 42s/epoch - 29ms/step
Epoch 2/50
1454/1454 - 40s - loss: 3.2722 - accuracy500: 0.3761 - val_loss: 3.3400 - val_accuracy500: 0.3090 - 40s/epoch - 28ms/step
Epoch 3/50
1454/1454 - 40s - loss: 3.2662 - accuracy500: 0.3820 - val_loss: 3.3449 - val_accuracy500: 0.3063 - 40s/epoch - 28ms/step
Epoch 4/50
1454/1454 - 40s - loss: 3.2625 - accuracy500: 0.3807 - val_loss: 3.3336 - val_accuracy500: 0.3194 - 40s/epoch - 28ms/step
Epoch 5/50
1454/1454 - 39s - loss: 3.2592 - accuracy500: 0.3829 - val_loss: 3.3264 - val_accuracy500: 0.3231 - 39s/epoch - 27ms/step
Epoch 6/50
1454/1454 - 40s - loss: 3.2562 - accuracy500: 0.3850 - val_loss: 3.3315 - val_accuracy500: 0.3236 - 40s/epoch - 28ms/step
Epoch 7/50
1454/1454 - 42s - loss: 3.2536 - accuracy500: 0.3869 - val_loss: 3.3346 - val_accuracy500: 0.3303 - 42s/epoch - 29ms/step
Epoch 8/50
1454/1454 - 40s - loss: 3.2503 - accuracy500: 0.3894 - val_loss: 3.3585 - val_accuracy500: 0.3235 - 40s/epoch - 27ms/step
Epoch 9/50
1454/1454 - 40s - loss: 3.2474 - accuracy500: 0.3912 - val_loss: 3.3599 - val_accuracy500: 0.3280 - 40s/epoch - 27ms/step
Epoch 10/50
1454/1454 - 39s - loss: 3.2450 - accuracy500: 0.3931 - val_loss: 3.3487 - val_accuracy500: 0.3400 - 39s/epoch - 27ms/step
Epoch 11/50
1454/1454 - 39s - loss: 3.2408 - accuracy500: 0.3955 - val_loss: 3.3702 - val_accuracy500: 0.3322 - 39s/epoch - 27ms/step
testing model: results/WBA/W0/deepVOL_L2/h500
Evaluating performance on  test set...
5633/5633 - 89s - 89s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0878074
{'0': {'precision': 0.2601897076202073, 'recall': 0.15136053532686827, 'f1-score': 0.1913858835311168, 'support': 382570}, '1': {'precision': 0.4499565370309963, 'recall': 0.7719583741728532, 'f1-score': 0.5685301220077309, 'support': 639699}, '2': {'precision': 0.32306744940268484, 'recall': 0.0937828465196096, 'f1-score': 0.14536722328949314, 'support': 419565}, 'accuracy': 0.409946637407635, 'macro avg': {'precision': 0.3444045646846295, 'recall': 0.33903391867311033, 'f1-score': 0.3017610762761136, 'support': 1441834}, 'weighted avg': {'precision': 0.3626806675630423, 'recall': 0.409946637407635, 'f1-score': 0.34532244836796677, 'support': 1441834}}
[[ 57906 289701  34963]
 [ 98394 493821  47484]
 [ 66253 313964  39348]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.101117
{'0': {'precision': 0.3387160364030621, 'recall': 0.1677405183775077, 'f1-score': 0.2243683213998129, 'support': 122922}, '1': {'precision': 0.3349592604771822, 'recall': 0.7469892280364389, 'f1-score': 0.4625191717791412, 'support': 122726}, '2': {'precision': 0.35176254296448267, 'recall': 0.10440738016718468, 'f1-score': 0.1610216004585981, 'support': 126447}, 'accuracy': 0.3372687082599874, 'macro avg': {'precision': 0.3418126132815757, 'recall': 0.33971237552704375, 'f1-score': 0.2826363645458507, 'support': 372095}, 'weighted avg': {'precision': 0.341910482802214, 'recall': 0.3372687082599874, 'f1-score': 0.28138950803440804, 'support': 372095}}
[[20619 89278 13025]
 [19747 91675 11304]
 [20508 92737 13202]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.105359
{'0': {'precision': 0.35144347254732866, 'recall': 0.17170602516000882, 'f1-score': 0.23069872762562005, 'support': 49841}, '1': {'precision': 0.30419090402964155, 'recall': 0.7405762894066509, 'f1-score': 0.4312474059155332, 'support': 42791}, '2': {'precision': 0.3614032560149834, 'recall': 0.10078547178529099, 'f1-score': 0.15761612290099117, 'support': 49779}, 'accuracy': 0.31784763817401746, 'macro avg': {'precision': 0.3390125441973179, 'recall': 0.33768926211731687, 'f1-score': 0.2731874188140481, 'support': 142411}, 'weighted avg': {'precision': 0.34072662765329687, 'recall': 0.31784763817401746, 'f1-score': 0.2654130369986065, 'support': 142411}}
[[ 8558 36292  4991]
 [ 7227 31690  3874]
 [ 8566 36196  5017]]
training model: results/WBA/W0/deepVOL_L2/h1000
Epoch 1/50
1454/1454 - 44s - loss: 3.3136 - accuracy1000: 0.3584 - val_loss: 3.3085 - val_accuracy1000: 0.3467 - 44s/epoch - 30ms/step
Epoch 2/50
1454/1454 - 42s - loss: 3.2973 - accuracy1000: 0.3567 - val_loss: 3.3003 - val_accuracy1000: 0.3392 - 42s/epoch - 29ms/step
Epoch 3/50
1454/1454 - 44s - loss: 3.2877 - accuracy1000: 0.3672 - val_loss: 3.2983 - val_accuracy1000: 0.3449 - 44s/epoch - 30ms/step
Epoch 4/50
1454/1454 - 41s - loss: 3.2826 - accuracy1000: 0.3724 - val_loss: 3.2954 - val_accuracy1000: 0.3479 - 41s/epoch - 29ms/step
Epoch 5/50
1454/1454 - 42s - loss: 3.2794 - accuracy1000: 0.3711 - val_loss: 3.2982 - val_accuracy1000: 0.3380 - 42s/epoch - 29ms/step
Epoch 6/50
1454/1454 - 39s - loss: 3.2758 - accuracy1000: 0.3756 - val_loss: 3.2995 - val_accuracy1000: 0.3363 - 39s/epoch - 27ms/step
Epoch 7/50
1454/1454 - 39s - loss: 3.2749 - accuracy1000: 0.3768 - val_loss: 3.2984 - val_accuracy1000: 0.3380 - 39s/epoch - 27ms/step
Epoch 8/50
1454/1454 - 40s - loss: 3.2706 - accuracy1000: 0.3808 - val_loss: 3.2982 - val_accuracy1000: 0.3405 - 40s/epoch - 27ms/step
Epoch 9/50
1454/1454 - 39s - loss: 3.2675 - accuracy1000: 0.3835 - val_loss: 3.3009 - val_accuracy1000: 0.3384 - 39s/epoch - 27ms/step
Epoch 10/50
1454/1454 - 40s - loss: 3.2634 - accuracy1000: 0.3866 - val_loss: 3.3019 - val_accuracy1000: 0.3413 - 40s/epoch - 27ms/step
Epoch 11/50
1454/1454 - 39s - loss: 3.2627 - accuracy1000: 0.3870 - val_loss: 3.3016 - val_accuracy1000: 0.3479 - 39s/epoch - 27ms/step
Epoch 12/50
1454/1454 - 39s - loss: 3.2601 - accuracy1000: 0.3893 - val_loss: 3.3015 - val_accuracy1000: 0.3482 - 39s/epoch - 27ms/step
Epoch 13/50
1454/1454 - 40s - loss: 3.2561 - accuracy1000: 0.3918 - val_loss: 3.3043 - val_accuracy1000: 0.3477 - 40s/epoch - 27ms/step
Epoch 14/50
1454/1454 - 39s - loss: 3.2527 - accuracy1000: 0.3935 - val_loss: 3.3070 - val_accuracy1000: 0.3488 - 39s/epoch - 27ms/step
testing model: results/WBA/W0/deepVOL_L2/h1000
Evaluating performance on  test set...
5633/5633 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0936812
{'0': {'precision': 0.29767640323207883, 'recall': 0.2766085055873282, 'f1-score': 0.2867560118057335, 'support': 398491}, '1': {'precision': 0.42418123322238505, 'recall': 0.7489141157340273, 'f1-score': 0.541601862921571, 'support': 590993}, '2': {'precision': 0.3400789557918697, 'recall': 0.021138498949928152, 'f1-score': 0.039802941721283666, 'support': 452350}, 'accuracy': 0.39005253031902426, 'macro avg': {'precision': 0.35397886408211116, 'recall': 0.34888704009042787, 'f1-score': 0.28938693881619604, 'support': 1441834}, 'weighted avg': {'precision': 0.3628324916867015, 'recall': 0.39005253031902426, 'f1-score': 0.31373754562710354, 'support': 1441834}}
[[110226 279341   8924]
 [138759 442603   9631]
 [121303 321485   9562]]
Evaluating performance on  train set...
1454/1454 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992833
{'0': {'precision': 0.3393044372786801, 'recall': 0.27954982560224273, 'f1-score': 0.30654227321876987, 'support': 122708}, '1': {'precision': 0.3406418431786813, 'recall': 0.7195735739648825, 'f1-score': 0.4623906888629548, 'support': 122788}, '2': {'precision': 0.3689646269042086, 'recall': 0.03386282672059021, 'f1-score': 0.06203244150544791, 'support': 126599}, 'accuracy': 0.3411628750722262, 'macro avg': {'precision': 0.3496369691205234, 'recall': 0.34432874209590514, 'f1-score': 0.2769884678623909, 'support': 372095}, 'weighted avg': {'precision': 0.349837144630436, 'recall': 0.3411628750722262, 'f1-score': 0.2747805324671966, 'support': 372095}}
[[34303 84390  4015]
 [31116 88355  3317]
 [35679 86633  4287]]
Evaluating performance on  val set...
557/557 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990195
{'0': {'precision': 0.36158070678127985, 'recall': 0.31022473521397986, 'f1-score': 0.3339397748448061, 'support': 48813}, '1': {'precision': 0.3389291579068478, 'recall': 0.7001123498401175, 'f1-score': 0.4567449662064542, 'support': 46284}, '2': {'precision': 0.35012185215272135, 'recall': 0.036437418100350845, 'f1-score': 0.06600558980052836, 'support': 47314}, 'accuracy': 0.34597748769406855, 'macro avg': {'precision': 0.350210572280283, 'recall': 0.3489248343848161, 'f1-score': 0.2855634436172629, 'support': 142411}, 'weighted avg': {'precision': 0.3504118466791822, 'recall': 0.34597748769406855, 'f1-score': 0.2848345613837502, 'support': 142411}}
[[15143 31882  1788]
 [12468 32404  1412]
 [14269 31321  1724]]
training model: results/WBA/W0/deepVOL_L3/h10
Epoch 1/50
1454/1454 - 59s - loss: 3.2550 - accuracy10: 0.4022 - val_loss: 3.1130 - val_accuracy10: 0.2993 - 59s/epoch - 41ms/step
Epoch 2/50
1454/1454 - 56s - loss: 3.0918 - accuracy10: 0.4229 - val_loss: 2.9441 - val_accuracy10: 0.4488 - 56s/epoch - 38ms/step
Epoch 3/50
1454/1454 - 56s - loss: 2.9897 - accuracy10: 0.4667 - val_loss: 2.8655 - val_accuracy10: 0.5090 - 56s/epoch - 39ms/step
Epoch 4/50
1454/1454 - 56s - loss: 2.9290 - accuracy10: 0.4961 - val_loss: 2.8188 - val_accuracy10: 0.5587 - 56s/epoch - 39ms/step
Epoch 5/50
1454/1454 - 56s - loss: 2.8929 - accuracy10: 0.5082 - val_loss: 2.8008 - val_accuracy10: 0.5538 - 56s/epoch - 38ms/step
Epoch 6/50
1454/1454 - 56s - loss: 2.8752 - accuracy10: 0.5117 - val_loss: 2.7833 - val_accuracy10: 0.5652 - 56s/epoch - 38ms/step
Epoch 7/50
1454/1454 - 57s - loss: 2.8606 - accuracy10: 0.5158 - val_loss: 2.7747 - val_accuracy10: 0.5637 - 57s/epoch - 39ms/step
Epoch 8/50
1454/1454 - 56s - loss: 2.8485 - accuracy10: 0.5179 - val_loss: 2.7702 - val_accuracy10: 0.5678 - 56s/epoch - 39ms/step
Epoch 9/50
1454/1454 - 56s - loss: 2.8420 - accuracy10: 0.5207 - val_loss: 2.7599 - val_accuracy10: 0.5593 - 56s/epoch - 39ms/step
Epoch 10/50
1454/1454 - 56s - loss: 2.8314 - accuracy10: 0.5233 - val_loss: 2.7536 - val_accuracy10: 0.5545 - 56s/epoch - 39ms/step
Epoch 11/50
1454/1454 - 56s - loss: 2.8247 - accuracy10: 0.5256 - val_loss: 2.7488 - val_accuracy10: 0.5581 - 56s/epoch - 38ms/step
Epoch 12/50
1454/1454 - 57s - loss: 2.8175 - accuracy10: 0.5266 - val_loss: 2.7426 - val_accuracy10: 0.5398 - 57s/epoch - 39ms/step
Epoch 13/50
1454/1454 - 56s - loss: 2.8112 - accuracy10: 0.5289 - val_loss: 2.7543 - val_accuracy10: 0.5208 - 56s/epoch - 38ms/step
Epoch 14/50
1454/1454 - 56s - loss: 2.8059 - accuracy10: 0.5295 - val_loss: 2.7410 - val_accuracy10: 0.5431 - 56s/epoch - 38ms/step
Epoch 15/50
1454/1454 - 56s - loss: 2.8006 - accuracy10: 0.5302 - val_loss: 2.7444 - val_accuracy10: 0.5452 - 56s/epoch - 39ms/step
Epoch 16/50
1454/1454 - 57s - loss: 2.7950 - accuracy10: 0.5312 - val_loss: 2.7449 - val_accuracy10: 0.5540 - 57s/epoch - 39ms/step
Epoch 17/50
1454/1454 - 57s - loss: 2.7916 - accuracy10: 0.5330 - val_loss: 2.7597 - val_accuracy10: 0.5593 - 57s/epoch - 39ms/step
Epoch 18/50
1454/1454 - 56s - loss: 2.7864 - accuracy10: 0.5339 - val_loss: 2.7670 - val_accuracy10: 0.5602 - 56s/epoch - 39ms/step
Epoch 19/50
1454/1454 - 58s - loss: 2.7833 - accuracy10: 0.5338 - val_loss: 2.7551 - val_accuracy10: 0.5609 - 58s/epoch - 40ms/step
Epoch 20/50
1454/1454 - 57s - loss: 2.7787 - accuracy10: 0.5339 - val_loss: 2.7623 - val_accuracy10: 0.5524 - 57s/epoch - 39ms/step
Epoch 21/50
1454/1454 - 57s - loss: 2.7747 - accuracy10: 0.5353 - val_loss: 2.7722 - val_accuracy10: 0.5553 - 57s/epoch - 39ms/step
Epoch 22/50
1454/1454 - 56s - loss: 2.7713 - accuracy10: 0.5366 - val_loss: 2.7646 - val_accuracy10: 0.5448 - 56s/epoch - 38ms/step
Epoch 23/50
1454/1454 - 56s - loss: 2.7668 - accuracy10: 0.5370 - val_loss: 2.7601 - val_accuracy10: 0.5504 - 56s/epoch - 38ms/step
Epoch 24/50
1454/1454 - 56s - loss: 2.7631 - accuracy10: 0.5382 - val_loss: 2.7500 - val_accuracy10: 0.5452 - 56s/epoch - 38ms/step
testing model: results/WBA/W0/deepVOL_L3/h10
Evaluating performance on  test set...
5633/5633 - 97s - 97s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7927653
{'0': {'precision': 0.396758674546629, 'recall': 0.5358393770914441, 'f1-score': 0.4559282976224768, 'support': 230403}, '1': {'precision': 0.8395343150098692, 'recall': 0.6864593439575765, 'f1-score': 0.7553192265576021, 'support': 980211}, '2': {'precision': 0.38748826626242866, 'recall': 0.5516521062191851, 'f1-score': 0.4552220828374069, 'support': 231220}, 'accuracy': 0.6407720999782222, 'macro avg': {'precision': 0.5412604186063089, 'recall': 0.5913169424227352, 'f1-score': 0.5554898690058286, 'support': 1441834}, 'weighted avg': {'precision': 0.6962869486132971, 'recall': 0.6407720999782222, 'f1-score': 0.6593518476704187, 'support': 1441834}}
[[123459  64873  42071]
 [147781 672875 159555]
 [ 39929  63738 127553]]
Evaluating performance on  train set...
1454/1454 - 29s - 29s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96952456
{'0': {'precision': 0.4042774032045635, 'recall': 0.5412632980276295, 'f1-score': 0.4628473851868865, 'support': 85633}, '1': {'precision': 0.7397741712373936, 'recall': 0.45790335668025667, 'f1-score': 0.5656699208240449, 'support': 200883}, '2': {'precision': 0.3869230075730256, 'recall': 0.6017948328445063, 'f1-score': 0.47101054951688065, 'support': 85579}, 'accuracy': 0.5101815396605706, 'macro avg': {'precision': 0.5103248606716609, 'recall': 0.5336538291841308, 'f1-score': 0.49984261850927064, 'support': 372095}, 'weighted avg': {'precision': 0.5814107305241665, 'recall': 0.5101815396605706, 'f1-score': 0.5202356727655851, 'support': 372095}}
[[46350 16493 22790]
 [50085 91985 58813]
 [18214 15864 51501]]
Evaluating performance on  val set...
557/557 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9290737
{'0': {'precision': 0.40066177180948703, 'recall': 0.5347840103159253, 'f1-score': 0.45810780956588976, 'support': 31020}, '1': {'precision': 0.753912183404571, 'recall': 0.5333691536817904, 'f1-score': 0.6247484394095736, 'support': 80029}, '2': {'precision': 0.40730811687580254, 'recall': 0.5764938460557363, 'f1-score': 0.4773534342780953, 'support': 31362}, 'accuracy': 0.5431743334433435, 'macro avg': {'precision': 0.5206273573632869, 'recall': 0.5482156700178172, 'f1-score': 0.5200698944178529, 'support': 142411}, 'weighted avg': {'precision': 0.6006373345364728, 'recall': 0.5431743334433435, 'f1-score': 0.5559911489707416, 'support': 142411}}
[[16589  7283  7148]
 [18183 42685 19161]
 [ 6632  6650 18080]]
training model: results/WBA/W0/deepVOL_L3/h20
Epoch 1/50
1454/1454 - 60s - loss: 3.2704 - accuracy20: 0.4008 - val_loss: 3.1780 - val_accuracy20: 0.3976 - 60s/epoch - 41ms/step
Epoch 2/50
1454/1454 - 56s - loss: 3.1221 - accuracy20: 0.4527 - val_loss: 3.0505 - val_accuracy20: 0.4576 - 56s/epoch - 38ms/step
Epoch 3/50
1454/1454 - 56s - loss: 3.0220 - accuracy20: 0.4901 - val_loss: 2.9807 - val_accuracy20: 0.5195 - 56s/epoch - 38ms/step
Epoch 4/50
1454/1454 - 56s - loss: 2.9806 - accuracy20: 0.5043 - val_loss: 2.9596 - val_accuracy20: 0.5192 - 56s/epoch - 39ms/step
Epoch 5/50
1454/1454 - 58s - loss: 2.9595 - accuracy20: 0.5087 - val_loss: 2.9338 - val_accuracy20: 0.5207 - 58s/epoch - 40ms/step
Epoch 6/50
1454/1454 - 59s - loss: 2.9442 - accuracy20: 0.5125 - val_loss: 2.9121 - val_accuracy20: 0.5234 - 59s/epoch - 40ms/step
Epoch 7/50
1454/1454 - 58s - loss: 2.9326 - accuracy20: 0.5155 - val_loss: 2.9154 - val_accuracy20: 0.5136 - 58s/epoch - 40ms/step
Epoch 8/50
1454/1454 - 57s - loss: 2.9231 - accuracy20: 0.5174 - val_loss: 2.8920 - val_accuracy20: 0.5280 - 57s/epoch - 39ms/step
Epoch 9/50
1454/1454 - 56s - loss: 2.9163 - accuracy20: 0.5191 - val_loss: 2.8857 - val_accuracy20: 0.5336 - 56s/epoch - 38ms/step
Epoch 10/50
1454/1454 - 56s - loss: 2.9092 - accuracy20: 0.5215 - val_loss: 2.8871 - val_accuracy20: 0.5334 - 56s/epoch - 39ms/step
Epoch 11/50
1454/1454 - 56s - loss: 2.9030 - accuracy20: 0.5220 - val_loss: 2.8901 - val_accuracy20: 0.5320 - 56s/epoch - 38ms/step
Epoch 12/50
1454/1454 - 56s - loss: 2.8979 - accuracy20: 0.5241 - val_loss: 2.8783 - val_accuracy20: 0.5317 - 56s/epoch - 38ms/step
Epoch 13/50
1454/1454 - 56s - loss: 2.8922 - accuracy20: 0.5244 - val_loss: 2.8779 - val_accuracy20: 0.5251 - 56s/epoch - 38ms/step
Epoch 14/50
1454/1454 - 58s - loss: 2.8870 - accuracy20: 0.5261 - val_loss: 2.8766 - val_accuracy20: 0.5190 - 58s/epoch - 40ms/step
Epoch 15/50
1454/1454 - 57s - loss: 2.8825 - accuracy20: 0.5264 - val_loss: 2.8723 - val_accuracy20: 0.5228 - 57s/epoch - 39ms/step
Epoch 16/50
1454/1454 - 56s - loss: 2.8781 - accuracy20: 0.5278 - val_loss: 2.8662 - val_accuracy20: 0.5208 - 56s/epoch - 38ms/step
Epoch 17/50
1454/1454 - 56s - loss: 2.8736 - accuracy20: 0.5287 - val_loss: 2.8687 - val_accuracy20: 0.5183 - 56s/epoch - 38ms/step
Epoch 18/50
1454/1454 - 56s - loss: 2.8693 - accuracy20: 0.5297 - val_loss: 2.8689 - val_accuracy20: 0.5188 - 56s/epoch - 38ms/step
Epoch 19/50
1454/1454 - 56s - loss: 2.8661 - accuracy20: 0.5307 - val_loss: 2.8635 - val_accuracy20: 0.5252 - 56s/epoch - 39ms/step
Epoch 20/50
1454/1454 - 56s - loss: 2.8622 - accuracy20: 0.5316 - val_loss: 2.8699 - val_accuracy20: 0.5168 - 56s/epoch - 38ms/step
Epoch 21/50
1454/1454 - 57s - loss: 2.8577 - accuracy20: 0.5322 - val_loss: 2.8678 - val_accuracy20: 0.5161 - 57s/epoch - 39ms/step
Epoch 22/50
1454/1454 - 56s - loss: 2.8549 - accuracy20: 0.5331 - val_loss: 2.8639 - val_accuracy20: 0.5189 - 56s/epoch - 38ms/step
Epoch 23/50
1454/1454 - 56s - loss: 2.8508 - accuracy20: 0.5340 - val_loss: 2.8628 - val_accuracy20: 0.5206 - 56s/epoch - 38ms/step
Epoch 24/50
1454/1454 - 57s - loss: 2.8477 - accuracy20: 0.5349 - val_loss: 2.8576 - val_accuracy20: 0.5245 - 57s/epoch - 39ms/step
Epoch 25/50
1454/1454 - 57s - loss: 2.8441 - accuracy20: 0.5353 - val_loss: 2.8554 - val_accuracy20: 0.5301 - 57s/epoch - 39ms/step
Epoch 26/50
1454/1454 - 57s - loss: 2.8422 - accuracy20: 0.5357 - val_loss: 2.8612 - val_accuracy20: 0.5250 - 57s/epoch - 39ms/step
Epoch 27/50
1454/1454 - 57s - loss: 2.8374 - accuracy20: 0.5370 - val_loss: 2.8592 - val_accuracy20: 0.5260 - 57s/epoch - 39ms/step
Epoch 28/50
1454/1454 - 57s - loss: 2.8346 - accuracy20: 0.5374 - val_loss: 2.8669 - val_accuracy20: 0.5248 - 57s/epoch - 39ms/step
Epoch 29/50
1454/1454 - 57s - loss: 2.8315 - accuracy20: 0.5375 - val_loss: 2.8644 - val_accuracy20: 0.5269 - 57s/epoch - 39ms/step
Epoch 30/50
1454/1454 - 56s - loss: 2.8292 - accuracy20: 0.5383 - val_loss: 2.8570 - val_accuracy20: 0.5316 - 56s/epoch - 39ms/step
Epoch 31/50
1454/1454 - 56s - loss: 2.8263 - accuracy20: 0.5385 - val_loss: 2.8634 - val_accuracy20: 0.5250 - 56s/epoch - 39ms/step
Epoch 32/50
1454/1454 - 61s - loss: 2.8233 - accuracy20: 0.5389 - val_loss: 2.8678 - val_accuracy20: 0.5237 - 61s/epoch - 42ms/step
Epoch 33/50
1454/1454 - 57s - loss: 2.8209 - accuracy20: 0.5399 - val_loss: 2.8697 - val_accuracy20: 0.5229 - 57s/epoch - 39ms/step
Epoch 34/50
1454/1454 - 56s - loss: 2.8174 - accuracy20: 0.5398 - val_loss: 2.8795 - val_accuracy20: 0.5193 - 56s/epoch - 39ms/step
Epoch 35/50
1454/1454 - 57s - loss: 2.8148 - accuracy20: 0.5405 - val_loss: 2.8764 - val_accuracy20: 0.5228 - 57s/epoch - 39ms/step
testing model: results/WBA/W0/deepVOL_L3/h20
Evaluating performance on  test set...
5633/5633 - 97s - 97s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8141223
{'0': {'precision': 0.465809437236592, 'recall': 0.47368049533106105, 'f1-score': 0.469711994373549, 'support': 297498}, '1': {'precision': 0.7543341605498023, 'recall': 0.7667238239398312, 'f1-score': 0.7604785327092554, 'support': 845620}, '2': {'precision': 0.4789456754824875, 'recall': 0.4486167463410062, 'f1-score': 0.4632853715368287, 'support': 298716}, 'accuracy': 0.6403545761856081, 'macro avg': {'precision': 0.5663630910896272, 'recall': 0.5630070218706328, 'f1-score': 0.5644919662065444, 'support': 1441834}, 'weighted avg': {'precision': 0.6377475945223668, 'recall': 0.6403545761856081, 'f1-score': 0.638911961276914, 'support': 1441834}}
[[140919 107453  49126]
 [100598 648357  96665]
 [ 61008 103699 134009]]
Evaluating performance on  train set...
1454/1454 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98469764
{'0': {'precision': 0.4455259146341463, 'recall': 0.5452044061820861, 'f1-score': 0.4903507778518789, 'support': 107213}, '1': {'precision': 0.6374407582938388, 'recall': 0.47319455381410824, 'f1-score': 0.5431728883737544, 'support': 157468}, '2': {'precision': 0.4541737566632527, 'recall': 0.5243078183477015, 'f1-score': 0.48672730808288145, 'support': 107414}, 'accuracy': 0.5086980475416224, 'macro avg': {'precision': 0.5123801431970793, 'recall': 0.5142355927812986, 'f1-score': 0.5067503247695049, 'support': 372095}, 'weighted avg': {'precision': 0.5292393370265969, 'recall': 0.5086980475416224, 'f1-score': 0.5116587253327416, 'support': 372095}}
[[58453 21245 27515]
 [42787 74513 40168]
 [29960 21136 56318]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95950955
{'0': {'precision': 0.444544357933984, 'recall': 0.5206925784160095, 'f1-score': 0.47961477485151793, 'support': 38927}, '1': {'precision': 0.649766585452043, 'recall': 0.5504419480376247, 'f1-score': 0.5959944044491453, 'support': 63469}, '2': {'precision': 0.4723686961369602, 'recall': 0.5081844308384356, 'f1-score': 0.48962245979004143, 'support': 40015}, 'accuracy': 0.5304365533561312, 'macro avg': {'precision': 0.5222265465076624, 'recall': 0.5264396524306899, 'f1-score': 0.5217438796969015, 'support': 142411}, 'weighted avg': {'precision': 0.5438248942095228, 'recall': 0.5304365533561312, 'f1-score': 0.5342942323635558, 'support': 142411}}
[[20269  9655  9003]
 [14822 34936 13711]
 [10504  9176 20335]]
training model: results/WBA/W0/deepVOL_L3/h30
Epoch 1/50
1454/1454 - 60s - loss: 3.2844 - accuracy30: 0.3793 - val_loss: 3.3329 - val_accuracy30: 0.3219 - 60s/epoch - 41ms/step
Epoch 2/50
1454/1454 - 58s - loss: 3.2355 - accuracy30: 0.4001 - val_loss: 3.2211 - val_accuracy30: 0.4084 - 58s/epoch - 40ms/step
Epoch 3/50
1454/1454 - 57s - loss: 3.1445 - accuracy30: 0.4443 - val_loss: 3.1290 - val_accuracy30: 0.4408 - 57s/epoch - 39ms/step
Epoch 4/50
1454/1454 - 57s - loss: 3.0663 - accuracy30: 0.4764 - val_loss: 3.0703 - val_accuracy30: 0.4717 - 57s/epoch - 39ms/step
Epoch 5/50
1454/1454 - 57s - loss: 3.0250 - accuracy30: 0.4896 - val_loss: 3.0516 - val_accuracy30: 0.4729 - 57s/epoch - 39ms/step
Epoch 6/50
1454/1454 - 57s - loss: 3.0039 - accuracy30: 0.4940 - val_loss: 3.0533 - val_accuracy30: 0.4725 - 57s/epoch - 39ms/step
Epoch 7/50
1454/1454 - 56s - loss: 2.9922 - accuracy30: 0.4981 - val_loss: 3.0392 - val_accuracy30: 0.4812 - 56s/epoch - 39ms/step
Epoch 8/50
1454/1454 - 56s - loss: 2.9831 - accuracy30: 0.5020 - val_loss: 3.0093 - val_accuracy30: 0.4907 - 56s/epoch - 39ms/step
Epoch 9/50
1454/1454 - 56s - loss: 2.9756 - accuracy30: 0.5033 - val_loss: 3.0398 - val_accuracy30: 0.4776 - 56s/epoch - 39ms/step
Epoch 10/50
1454/1454 - 56s - loss: 2.9693 - accuracy30: 0.5049 - val_loss: 3.0254 - val_accuracy30: 0.4881 - 56s/epoch - 39ms/step
Epoch 11/50
1454/1454 - 56s - loss: 2.9622 - accuracy30: 0.5069 - val_loss: 3.0466 - val_accuracy30: 0.4789 - 56s/epoch - 39ms/step
Epoch 12/50
1454/1454 - 58s - loss: 2.9582 - accuracy30: 0.5071 - val_loss: 3.0207 - val_accuracy30: 0.4868 - 58s/epoch - 40ms/step
Epoch 13/50
1454/1454 - 57s - loss: 2.9529 - accuracy30: 0.5089 - val_loss: 3.0400 - val_accuracy30: 0.4810 - 57s/epoch - 39ms/step
Epoch 14/50
1454/1454 - 57s - loss: 2.9482 - accuracy30: 0.5107 - val_loss: 3.0097 - val_accuracy30: 0.4927 - 57s/epoch - 39ms/step
Epoch 15/50
1454/1454 - 57s - loss: 2.9450 - accuracy30: 0.5109 - val_loss: 3.0170 - val_accuracy30: 0.4896 - 57s/epoch - 39ms/step
Epoch 16/50
1454/1454 - 57s - loss: 2.9409 - accuracy30: 0.5120 - val_loss: 2.9971 - val_accuracy30: 0.4978 - 57s/epoch - 39ms/step
Epoch 17/50
1454/1454 - 56s - loss: 2.9371 - accuracy30: 0.5129 - val_loss: 2.9941 - val_accuracy30: 0.4972 - 56s/epoch - 39ms/step
Epoch 18/50
1454/1454 - 57s - loss: 2.9325 - accuracy30: 0.5134 - val_loss: 2.9830 - val_accuracy30: 0.4980 - 57s/epoch - 39ms/step
Epoch 19/50
1454/1454 - 56s - loss: 2.9296 - accuracy30: 0.5141 - val_loss: 2.9962 - val_accuracy30: 0.4960 - 56s/epoch - 38ms/step
Epoch 20/50
1454/1454 - 56s - loss: 2.9263 - accuracy30: 0.5150 - val_loss: 2.9924 - val_accuracy30: 0.4949 - 56s/epoch - 39ms/step
Epoch 21/50
1454/1454 - 58s - loss: 2.9217 - accuracy30: 0.5163 - val_loss: 2.9898 - val_accuracy30: 0.4992 - 58s/epoch - 40ms/step
Epoch 22/50
1454/1454 - 57s - loss: 2.9180 - accuracy30: 0.5177 - val_loss: 2.9807 - val_accuracy30: 0.4988 - 57s/epoch - 39ms/step
Epoch 23/50
1454/1454 - 56s - loss: 2.9159 - accuracy30: 0.5178 - val_loss: 2.9852 - val_accuracy30: 0.4987 - 56s/epoch - 39ms/step
Epoch 24/50
1454/1454 - 57s - loss: 2.9118 - accuracy30: 0.5189 - val_loss: 2.9693 - val_accuracy30: 0.5043 - 57s/epoch - 39ms/step
Epoch 25/50
1454/1454 - 58s - loss: 2.9091 - accuracy30: 0.5204 - val_loss: 2.9737 - val_accuracy30: 0.5007 - 58s/epoch - 40ms/step
Epoch 26/50
1454/1454 - 57s - loss: 2.9064 - accuracy30: 0.5210 - val_loss: 2.9673 - val_accuracy30: 0.5045 - 57s/epoch - 39ms/step
Epoch 27/50
1454/1454 - 56s - loss: 2.9021 - accuracy30: 0.5223 - val_loss: 2.9678 - val_accuracy30: 0.5040 - 56s/epoch - 39ms/step
Epoch 28/50
1454/1454 - 56s - loss: 2.8993 - accuracy30: 0.5232 - val_loss: 2.9672 - val_accuracy30: 0.5040 - 56s/epoch - 38ms/step
Epoch 29/50
1454/1454 - 56s - loss: 2.8970 - accuracy30: 0.5232 - val_loss: 2.9735 - val_accuracy30: 0.5039 - 56s/epoch - 38ms/step
Epoch 30/50
1454/1454 - 57s - loss: 2.8938 - accuracy30: 0.5239 - val_loss: 2.9836 - val_accuracy30: 0.5005 - 57s/epoch - 39ms/step
Epoch 31/50
1454/1454 - 56s - loss: 2.8920 - accuracy30: 0.5254 - val_loss: 2.9779 - val_accuracy30: 0.5027 - 56s/epoch - 39ms/step
Epoch 32/50
1454/1454 - 56s - loss: 2.8884 - accuracy30: 0.5250 - val_loss: 2.9813 - val_accuracy30: 0.5021 - 56s/epoch - 39ms/step
Epoch 33/50
1454/1454 - 57s - loss: 2.8859 - accuracy30: 0.5260 - val_loss: 2.9869 - val_accuracy30: 0.5025 - 57s/epoch - 39ms/step
Epoch 34/50
1454/1454 - 57s - loss: 2.8835 - accuracy30: 0.5267 - val_loss: 2.9913 - val_accuracy30: 0.5010 - 57s/epoch - 39ms/step
Epoch 35/50
1454/1454 - 58s - loss: 2.8805 - accuracy30: 0.5279 - val_loss: 2.9917 - val_accuracy30: 0.5012 - 58s/epoch - 40ms/step
Epoch 36/50
1454/1454 - 57s - loss: 2.8775 - accuracy30: 0.5279 - val_loss: 2.9892 - val_accuracy30: 0.4992 - 57s/epoch - 40ms/step
Epoch 37/50
1454/1454 - 59s - loss: 2.8745 - accuracy30: 0.5288 - val_loss: 2.9845 - val_accuracy30: 0.5015 - 59s/epoch - 40ms/step
Epoch 38/50
1454/1454 - 57s - loss: 2.8710 - accuracy30: 0.5304 - val_loss: 2.9880 - val_accuracy30: 0.5022 - 57s/epoch - 39ms/step
testing model: results/WBA/W0/deepVOL_L3/h30
Evaluating performance on  test set...
5633/5633 - 97s - 97s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86255085
{'0': {'precision': 0.4828199892663488, 'recall': 0.4579475342501821, 'f1-score': 0.47005496691625237, 'support': 341823}, '1': {'precision': 0.6776428658515344, 'recall': 0.8245183679145943, 'f1-score': 0.7439001582806977, 'support': 754985}, '2': {'precision': 0.536287161550986, 'recall': 0.30930712468045884, 'f1-score': 0.3923333982816871, 'support': 345026}, 'accuracy': 0.6143252274533684, 'macro avg': {'precision': 0.5655833388896231, 'recall': 0.5305910089484117, 'f1-score': 0.5354295078262123, 'support': 1441834}, 'weighted avg': {'precision': 0.59762926277727, 'recall': 0.6143252274533684, 'f1-score': 0.5948495340179966, 'support': 1441834}}
[[156537 143798  41488]
 [ 81697 622499  50789]
 [ 85980 152327 106719]]
Evaluating performance on  train set...
1454/1454 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9941857
{'0': {'precision': 0.4584575336183758, 'recall': 0.5637646785643203, 'f1-score': 0.5056868477234013, 'support': 120584}, '1': {'precision': 0.546286629353722, 'recall': 0.5342668724137666, 'f1-score': 0.5402098987766254, 'support': 130257}, '2': {'precision': 0.49448258696148184, 'recall': 0.3932158939086546, 'f1-score': 0.43807309946893547, 'support': 121254}, 'accuracy': 0.4978621051075666, 'macro avg': {'precision': 0.4997422499778598, 'recall': 0.49708248162891383, 'f1-score': 0.4946566153229874, 'support': 372095}, 'weighted avg': {'precision': 0.5009427493328141, 'recall': 0.4978621051075666, 'f1-score': 0.4957389355778277, 'support': 372095}}
[[67981 27958 24645]
 [36567 69592 24098]
 [43734 29841 47679]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9884272
{'0': {'precision': 0.4521489507944851, 'recall': 0.5077757849569777, 'f1-score': 0.4783506036593842, 'support': 44047}, '1': {'precision': 0.5449074694917527, 'recall': 0.6171590218712029, 'f1-score': 0.5787871234242576, 'support': 52672}, '2': {'precision': 0.5063834900417555, 'recall': 0.36892672677930494, 'f1-score': 0.42686215672123673, 'support': 45692}, 'accuracy': 0.5036830020152938, 'macro avg': {'precision': 0.5011466367759977, 'recall': 0.4979538445358285, 'f1-score': 0.49466662793495947, 'support': 142411}, 'weighted avg': {'precision': 0.5038574653341538, 'recall': 0.5036830020152938, 'f1-score': 0.49897809908851243, 'support': 142411}}
[[22366 13315  8366]
 [12099 32507  8066]
 [15001 13834 16857]]
training model: results/WBA/W0/deepVOL_L3/h50
Epoch 1/50
1454/1454 - 60s - loss: 3.2847 - accuracy50: 0.3755 - val_loss: 3.3132 - val_accuracy50: 0.3375 - 60s/epoch - 41ms/step
Epoch 2/50
1454/1454 - 56s - loss: 3.2392 - accuracy50: 0.4004 - val_loss: 3.2674 - val_accuracy50: 0.3753 - 56s/epoch - 39ms/step
Epoch 3/50
1454/1454 - 56s - loss: 3.1637 - accuracy50: 0.4379 - val_loss: 3.1699 - val_accuracy50: 0.4326 - 56s/epoch - 38ms/step
Epoch 4/50
1454/1454 - 57s - loss: 3.1259 - accuracy50: 0.4554 - val_loss: 3.1466 - val_accuracy50: 0.4443 - 57s/epoch - 39ms/step
Epoch 5/50
1454/1454 - 61s - loss: 3.1051 - accuracy50: 0.4652 - val_loss: 3.1289 - val_accuracy50: 0.4518 - 61s/epoch - 42ms/step
Epoch 6/50
1454/1454 - 56s - loss: 3.0905 - accuracy50: 0.4688 - val_loss: 3.1080 - val_accuracy50: 0.4629 - 56s/epoch - 39ms/step
Epoch 7/50
1454/1454 - 56s - loss: 3.0802 - accuracy50: 0.4719 - val_loss: 3.1125 - val_accuracy50: 0.4566 - 56s/epoch - 38ms/step
Epoch 8/50
1454/1454 - 56s - loss: 3.0702 - accuracy50: 0.4750 - val_loss: 3.1048 - val_accuracy50: 0.4581 - 56s/epoch - 38ms/step
Epoch 9/50
1454/1454 - 56s - loss: 3.0640 - accuracy50: 0.4763 - val_loss: 3.0883 - val_accuracy50: 0.4678 - 56s/epoch - 38ms/step
Epoch 10/50
1454/1454 - 56s - loss: 3.0601 - accuracy50: 0.4779 - val_loss: 3.1018 - val_accuracy50: 0.4608 - 56s/epoch - 38ms/step
Epoch 11/50
1454/1454 - 56s - loss: 3.0560 - accuracy50: 0.4790 - val_loss: 3.1043 - val_accuracy50: 0.4620 - 56s/epoch - 39ms/step
Epoch 12/50
1454/1454 - 56s - loss: 3.0519 - accuracy50: 0.4805 - val_loss: 3.0986 - val_accuracy50: 0.4636 - 56s/epoch - 39ms/step
Epoch 13/50
1454/1454 - 57s - loss: 3.0486 - accuracy50: 0.4814 - val_loss: 3.0961 - val_accuracy50: 0.4638 - 57s/epoch - 39ms/step
Epoch 14/50
1454/1454 - 56s - loss: 3.0453 - accuracy50: 0.4822 - val_loss: 3.0965 - val_accuracy50: 0.4644 - 56s/epoch - 38ms/step
Epoch 15/50
1454/1454 - 56s - loss: 3.0421 - accuracy50: 0.4829 - val_loss: 3.0929 - val_accuracy50: 0.4651 - 56s/epoch - 38ms/step
Epoch 16/50
1454/1454 - 57s - loss: 3.0397 - accuracy50: 0.4843 - val_loss: 3.0941 - val_accuracy50: 0.4657 - 57s/epoch - 39ms/step
Epoch 17/50
1454/1454 - 56s - loss: 3.0370 - accuracy50: 0.4848 - val_loss: 3.0887 - val_accuracy50: 0.4662 - 56s/epoch - 39ms/step
Epoch 18/50
1454/1454 - 56s - loss: 3.0324 - accuracy50: 0.4865 - val_loss: 3.0867 - val_accuracy50: 0.4677 - 56s/epoch - 39ms/step
Epoch 19/50
1454/1454 - 56s - loss: 3.0309 - accuracy50: 0.4868 - val_loss: 3.0905 - val_accuracy50: 0.4658 - 56s/epoch - 38ms/step
Epoch 20/50
1454/1454 - 56s - loss: 3.0278 - accuracy50: 0.4871 - val_loss: 3.0979 - val_accuracy50: 0.4643 - 56s/epoch - 39ms/step
Epoch 21/50
1454/1454 - 56s - loss: 3.0252 - accuracy50: 0.4885 - val_loss: 3.0959 - val_accuracy50: 0.4662 - 56s/epoch - 39ms/step
Epoch 22/50
1454/1454 - 56s - loss: 3.0205 - accuracy50: 0.4906 - val_loss: 3.0996 - val_accuracy50: 0.4647 - 56s/epoch - 38ms/step
Epoch 23/50
1454/1454 - 57s - loss: 3.0173 - accuracy50: 0.4905 - val_loss: 3.0947 - val_accuracy50: 0.4652 - 57s/epoch - 40ms/step
Epoch 24/50
1454/1454 - 61s - loss: 3.0152 - accuracy50: 0.4918 - val_loss: 3.1039 - val_accuracy50: 0.4625 - 61s/epoch - 42ms/step
Epoch 25/50
1454/1454 - 57s - loss: 3.0122 - accuracy50: 0.4924 - val_loss: 3.1026 - val_accuracy50: 0.4619 - 57s/epoch - 39ms/step
Epoch 26/50
1454/1454 - 57s - loss: 3.0080 - accuracy50: 0.4940 - val_loss: 3.1079 - val_accuracy50: 0.4630 - 57s/epoch - 39ms/step
Epoch 27/50
1454/1454 - 58s - loss: 3.0057 - accuracy50: 0.4946 - val_loss: 3.1130 - val_accuracy50: 0.4596 - 58s/epoch - 40ms/step
Epoch 28/50
1454/1454 - 56s - loss: 3.0019 - accuracy50: 0.4963 - val_loss: 3.1143 - val_accuracy50: 0.4592 - 56s/epoch - 39ms/step
testing model: results/WBA/W0/deepVOL_L3/h50
Evaluating performance on  test set...
5633/5633 - 97s - 97s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9299492
{'0': {'precision': 0.46497625010795407, 'recall': 0.3797468711559513, 'f1-score': 0.41806189908979235, 'support': 354444}, '1': {'precision': 0.6421504088437958, 'recall': 0.767164569683455, 'f1-score': 0.6991127598565853, 'support': 718413}, '2': {'precision': 0.45526973494057843, 'recall': 0.3628627258609615, 'f1-score': 0.40384760399479996, 'support': 368977}, 'accuracy': 0.568462111449723, 'macro avg': {'precision': 0.5207987979641094, 'recall': 0.5032580555667893, 'f1-score': 0.5070074209803925, 'support': 1441834}, 'weighted avg': {'precision': 0.550771659324951, 'recall': 0.568462111449723, 'f1-score': 0.5544616816408967, 'support': 1441834}}
[[134599 147512  72333]
 [ 79408 551141  87864]
 [ 75468 159621 133888]]
Evaluating performance on  train set...
1454/1454 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0328014
{'0': {'precision': 0.4546564025535111, 'recall': 0.4704834687995855, 'f1-score': 0.46243455289081276, 'support': 123524}, '1': {'precision': 0.5026855232906354, 'recall': 0.42458734160689954, 'f1-score': 0.46034758069153425, 'support': 122559}, '2': {'precision': 0.4389320298679247, 'recall': 0.49027870361552867, 'f1-score': 0.46318669990441025, 'support': 126012}, 'accuracy': 0.4620701702522205, 'macro avg': {'precision': 0.4654246519040237, 'recall': 0.46178317134067126, 'f1-score': 0.4619896111622524, 'support': 372095}, 'weighted avg': {'precision': 0.46515087670007343, 'recall': 0.4620701702522205, 'f1-score': 0.46200187393437975, 'support': 372095}}
[[58116 25049 40359]
 [31909 52037 38613]
 [37799 26432 61781]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0287333
{'0': {'precision': 0.4497393721765319, 'recall': 0.4238276133088813, 'f1-score': 0.4363991952253032, 'support': 45804}, '1': {'precision': 0.4925487933852514, 'recall': 0.5331571059861794, 'f1-score': 0.512049095942988, 'support': 48044}, '2': {'precision': 0.4603628204314049, 'recall': 0.44783065296625, 'f1-score': 0.4540102709698969, 'support': 48563}, 'accuracy': 0.46889636334271934, 'macro avg': {'precision': 0.4675503286643961, 'recall': 0.4682717907537703, 'f1-score': 0.46748618737939607, 'support': 142411}, 'weighted avg': {'precision': 0.467804285351449, 'recall': 0.46889636334271934, 'f1-score': 0.4679260470939449, 'support': 142411}}
[[19413 12878 13513]
 [10449 25615 11980]
 [13303 13512 21748]]
training model: results/WBA/W0/deepVOL_L3/h100
Epoch 1/50
1454/1454 - 60s - loss: 3.2913 - accuracy100: 0.3689 - val_loss: 3.3038 - val_accuracy100: 0.3177 - 60s/epoch - 41ms/step
Epoch 2/50
1454/1454 - 57s - loss: 3.2769 - accuracy100: 0.3694 - val_loss: 3.2954 - val_accuracy100: 0.3398 - 57s/epoch - 39ms/step
Epoch 3/50
1454/1454 - 56s - loss: 3.2548 - accuracy100: 0.3881 - val_loss: 3.2957 - val_accuracy100: 0.3475 - 56s/epoch - 39ms/step
Epoch 4/50
1454/1454 - 57s - loss: 3.2381 - accuracy100: 0.4019 - val_loss: 3.3163 - val_accuracy100: 0.3316 - 57s/epoch - 39ms/step
Epoch 5/50
1454/1454 - 56s - loss: 3.2277 - accuracy100: 0.4080 - val_loss: 3.3323 - val_accuracy100: 0.3262 - 56s/epoch - 39ms/step
Epoch 6/50
1454/1454 - 56s - loss: 3.2218 - accuracy100: 0.4122 - val_loss: 3.3311 - val_accuracy100: 0.3284 - 56s/epoch - 39ms/step
Epoch 7/50
1454/1454 - 56s - loss: 3.2168 - accuracy100: 0.4151 - val_loss: 3.3335 - val_accuracy100: 0.3241 - 56s/epoch - 38ms/step
Epoch 8/50
1454/1454 - 56s - loss: 3.2109 - accuracy100: 0.4176 - val_loss: 3.3398 - val_accuracy100: 0.3210 - 56s/epoch - 39ms/step
Epoch 9/50
1454/1454 - 56s - loss: 3.2073 - accuracy100: 0.4191 - val_loss: 3.3295 - val_accuracy100: 0.3308 - 56s/epoch - 39ms/step
Epoch 10/50
1454/1454 - 56s - loss: 3.2023 - accuracy100: 0.4227 - val_loss: 3.3388 - val_accuracy100: 0.3401 - 56s/epoch - 39ms/step
Epoch 11/50
1454/1454 - 56s - loss: 3.1985 - accuracy100: 0.4243 - val_loss: 3.3182 - val_accuracy100: 0.3452 - 56s/epoch - 38ms/step
Epoch 12/50
1454/1454 - 56s - loss: 3.1935 - accuracy100: 0.4274 - val_loss: 3.3139 - val_accuracy100: 0.3446 - 56s/epoch - 39ms/step
testing model: results/WBA/W0/deepVOL_L3/h100
Evaluating performance on  test set...
5633/5633 - 101s - 101s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0760784
{'0': {'precision': 0.33002088102845356, 'recall': 0.14533328163170345, 'f1-score': 0.2017990854584822, 'support': 361046}, '1': {'precision': 0.5039290992235964, 'recall': 0.8253553910193707, 'f1-score': 0.6257811654143479, 'support': 700285}, '2': {'precision': 0.29079428626097453, 'recall': 0.10384675022273149, 'f1-score': 0.15304055493371238, 'support': 380503}, 'accuracy': 0.4646651417569568, 'macro avg': {'precision': 0.3749147555043415, 'recall': 0.3581784742912686, 'f1-score': 0.3268736019355142, 'support': 1441834}, 'weighted avg': {'precision': 0.4041344610868899, 'recall': 0.4646651417569568, 'f1-score': 0.3948556534972626, 'support': 1441834}}
[[ 52472 272241  36333]
 [ 62265 577984  60036]
 [ 44259 296730  39514]]
Evaluating performance on  train set...
1454/1454 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.095834
{'0': {'precision': 0.36562696912413356, 'recall': 0.2635425030617128, 'f1-score': 0.3063029943111388, 'support': 123297}, '1': {'precision': 0.35353968083967013, 'recall': 0.6717049625994026, 'f1-score': 0.4632540332992781, 'support': 122859}, '2': {'precision': 0.3626049238925258, 'recall': 0.1433789374220853, 'f1-score': 0.20550026459994197, 'support': 125939}, 'accuracy': 0.3576398500382967, 'macro avg': {'precision': 0.36059052461877644, 'recall': 0.3595421343610669, 'f1-score': 0.325019097403453, 'support': 372095}, 'weighted avg': {'precision': 0.3606131272134271, 'recall': 0.3576398500382967, 'f1-score': 0.3240077544448288, 'support': 372095}}
[[32494 73716 17087]
 [25680 82525 14654]
 [30698 77184 18057]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0991676
{'0': {'precision': 0.37348798674399336, 'recall': 0.2295222190542137, 'f1-score': 0.28431953782307606, 'support': 49102}, '1': {'precision': 0.3171667829727844, 'recall': 0.6899103458090223, 'f1-score': 0.4345578678458849, 'support': 42162}, '2': {'precision': 0.3860845839017735, 'recall': 0.15492599761471837, 'f1-score': 0.22112151358289966, 'support': 51147}, 'accuracy': 0.3390327994326281, 'macro avg': {'precision': 0.3589131178728504, 'recall': 0.3581195208259848, 'f1-score': 0.3133329730839535, 'support': 142411}, 'weighted avg': {'precision': 0.3613376862856528, 'recall': 0.3390327994326281, 'f1-score': 0.3061012760638676, 'support': 142411}}
[[11270 30503  7329]
 [ 7803 29088  5271]
 [11102 32121  7924]]
training model: results/WBA/W0/deepVOL_L3/h200
Epoch 1/50
1454/1454 - 61s - loss: 3.3065 - accuracy200: 0.3541 - val_loss: 3.2995 - val_accuracy200: 0.3325 - 61s/epoch - 42ms/step
Epoch 2/50
1454/1454 - 58s - loss: 3.2899 - accuracy200: 0.3562 - val_loss: 3.2996 - val_accuracy200: 0.3370 - 58s/epoch - 40ms/step
Epoch 3/50
1454/1454 - 58s - loss: 3.2824 - accuracy200: 0.3645 - val_loss: 3.3014 - val_accuracy200: 0.3362 - 58s/epoch - 40ms/step
Epoch 4/50
1454/1454 - 58s - loss: 3.2778 - accuracy200: 0.3695 - val_loss: 3.2959 - val_accuracy200: 0.3440 - 58s/epoch - 40ms/step
Epoch 5/50
1454/1454 - 57s - loss: 3.2722 - accuracy200: 0.3750 - val_loss: 3.2943 - val_accuracy200: 0.3459 - 57s/epoch - 39ms/step
Epoch 6/50
1454/1454 - 58s - loss: 3.2660 - accuracy200: 0.3808 - val_loss: 3.2879 - val_accuracy200: 0.3531 - 58s/epoch - 40ms/step
Epoch 7/50
1454/1454 - 59s - loss: 3.2599 - accuracy200: 0.3861 - val_loss: 3.2921 - val_accuracy200: 0.3554 - 59s/epoch - 40ms/step
Epoch 8/50
1454/1454 - 58s - loss: 3.2540 - accuracy200: 0.3905 - val_loss: 3.2970 - val_accuracy200: 0.3587 - 58s/epoch - 40ms/step
Epoch 9/50
1454/1454 - 59s - loss: 3.2498 - accuracy200: 0.3926 - val_loss: 3.3072 - val_accuracy200: 0.3566 - 59s/epoch - 40ms/step
Epoch 10/50
1454/1454 - 58s - loss: 3.2458 - accuracy200: 0.3960 - val_loss: 3.3210 - val_accuracy200: 0.3496 - 58s/epoch - 40ms/step
Epoch 11/50
1454/1454 - 59s - loss: 3.2422 - accuracy200: 0.3987 - val_loss: 3.3227 - val_accuracy200: 0.3511 - 59s/epoch - 41ms/step
Epoch 12/50
1454/1454 - 58s - loss: 3.2389 - accuracy200: 0.4001 - val_loss: 3.3357 - val_accuracy200: 0.3525 - 58s/epoch - 40ms/step
Epoch 13/50
1454/1454 - 60s - loss: 3.2354 - accuracy200: 0.4019 - val_loss: 3.3236 - val_accuracy200: 0.3556 - 60s/epoch - 42ms/step
Epoch 14/50
1454/1454 - 58s - loss: 3.2306 - accuracy200: 0.4056 - val_loss: 3.3385 - val_accuracy200: 0.3544 - 58s/epoch - 40ms/step
Epoch 15/50
1454/1454 - 58s - loss: 3.2273 - accuracy200: 0.4081 - val_loss: 3.3505 - val_accuracy200: 0.3548 - 58s/epoch - 40ms/step
Epoch 16/50
1454/1454 - 59s - loss: 3.2230 - accuracy200: 0.4101 - val_loss: 3.3342 - val_accuracy200: 0.3576 - 59s/epoch - 41ms/step
testing model: results/WBA/W0/deepVOL_L3/h200
Evaluating performance on  test set...
5633/5633 - 99s - 99s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0853527
{'0': {'precision': 0.34578367883920247, 'recall': 0.25948690667893565, 'f1-score': 0.2964833889135303, 'support': 417312}, '1': {'precision': 0.4048254536275354, 'recall': 0.7662704275131792, 'f1-score': 0.5297700699232757, 'support': 569269}, '2': {'precision': 0.35751163609340164, 'recall': 0.04015569364726866, 'f1-score': 0.07220169554115725, 'support': 455253}, 'accuracy': 0.3903237127158882, 'macro avg': {'precision': 0.3693735895200465, 'recall': 0.3553043426131279, 'f1-score': 0.2994850514593211, 'support': 1441834}, 'weighted avg': {'precision': 0.3727977732604919, 'recall': 0.3903237127158882, 'f1-score': 0.3177743016391865, 'support': 1441834}}
[[108287 293596  15429]
 [115631 436214  17424]
 [ 89246 347726  18281]]
Evaluating performance on  train set...
1454/1454 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0951985
{'0': {'precision': 0.37554573504174704, 'recall': 0.343678544401136, 'f1-score': 0.35890615838269163, 'support': 122891}, '1': {'precision': 0.34830477642452484, 'recall': 0.6540707604717365, 'f1-score': 0.45455213461679767, 'support': 122950}, '2': {'precision': 0.37199109503269795, 'recall': 0.08470226685887179, 'f1-score': 0.1379853163184991, 'support': 126254}, 'accuracy': 0.35836815866915706, 'macro avg': {'precision': 0.3652805354996566, 'recall': 0.3608171905772481, 'f1-score': 0.3171478697726628, 'support': 372095}, 'weighted avg': {'precision': 0.36533849392942364, 'recall': 0.35836815866915706, 'f1-score': 0.31555038306727695, 'support': 372095}}
[[42235 71187  9469]
 [33947 80418  8585]
 [36281 79279 10694]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0966562
{'0': {'precision': 0.37340726490890574, 'recall': 0.3494810421520864, 'f1-score': 0.3610481973849773, 'support': 47210}, '1': {'precision': 0.3424206550538362, 'recall': 0.6489668582662023, 'f1-score': 0.4483002937399442, 'support': 46799}, '2': {'precision': 0.36564893505403423, 'recall': 0.07200115697698442, 'f1-score': 0.12031139419674451, 'support': 48402}, 'accuracy': 0.3535892592566586, 'macro avg': {'precision': 0.36049228500559205, 'recall': 0.3568163524650911, 'f1-score': 0.3098866284405553, 'support': 142411}, 'weighted avg': {'precision': 0.36058760184746463, 'recall': 0.3535892592566586, 'f1-score': 0.3079003935594249, 'support': 142411}}
[[16499 27575  3136]
 [13518 30371  2910]
 [14168 30749  3485]]
training model: results/WBA/W0/deepVOL_L3/h300
Epoch 1/50
1454/1454 - 60s - loss: 3.2965 - accuracy300: 0.3598 - val_loss: 3.2937 - val_accuracy300: 0.3467 - 60s/epoch - 41ms/step
Epoch 2/50
1454/1454 - 56s - loss: 3.2958 - accuracy300: 0.3505 - val_loss: 3.2925 - val_accuracy300: 0.3458 - 56s/epoch - 39ms/step
Epoch 3/50
1454/1454 - 56s - loss: 3.2942 - accuracy300: 0.3554 - val_loss: 3.2918 - val_accuracy300: 0.3500 - 56s/epoch - 39ms/step
Epoch 4/50
1454/1454 - 56s - loss: 3.2929 - accuracy300: 0.3572 - val_loss: 3.2928 - val_accuracy300: 0.3481 - 56s/epoch - 39ms/step
Epoch 5/50
1454/1454 - 56s - loss: 3.2918 - accuracy300: 0.3590 - val_loss: 3.2934 - val_accuracy300: 0.3499 - 56s/epoch - 39ms/step
Epoch 6/50
1454/1454 - 56s - loss: 3.2889 - accuracy300: 0.3624 - val_loss: 3.2945 - val_accuracy300: 0.3477 - 56s/epoch - 38ms/step
Epoch 7/50
1454/1454 - 56s - loss: 3.2903 - accuracy300: 0.3625 - val_loss: 3.2967 - val_accuracy300: 0.3511 - 56s/epoch - 39ms/step
Epoch 8/50
1454/1454 - 57s - loss: 3.2874 - accuracy300: 0.3642 - val_loss: 3.2965 - val_accuracy300: 0.3496 - 57s/epoch - 39ms/step
Epoch 9/50
1454/1454 - 56s - loss: 3.2833 - accuracy300: 0.3696 - val_loss: 3.2977 - val_accuracy300: 0.3540 - 56s/epoch - 39ms/step
Epoch 10/50
1454/1454 - 56s - loss: 3.2792 - accuracy300: 0.3739 - val_loss: 3.2969 - val_accuracy300: 0.3578 - 56s/epoch - 39ms/step
Epoch 11/50
1454/1454 - 56s - loss: 3.2738 - accuracy300: 0.3800 - val_loss: 3.3015 - val_accuracy300: 0.3577 - 56s/epoch - 39ms/step
Epoch 12/50
1454/1454 - 57s - loss: 3.2666 - accuracy300: 0.3856 - val_loss: 3.3000 - val_accuracy300: 0.3584 - 57s/epoch - 39ms/step
Epoch 13/50
1454/1454 - 57s - loss: 3.2638 - accuracy300: 0.3878 - val_loss: 3.3041 - val_accuracy300: 0.3580 - 57s/epoch - 39ms/step
testing model: results/WBA/W0/deepVOL_L3/h300
Evaluating performance on  test set...
5633/5633 - 97s - 97s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1063088
{'0': {'precision': 0.23428110709381575, 'recall': 0.36562513165470656, 'f1-score': 0.28557482850680815, 'support': 356045}, '1': {'precision': 0.5275686527568653, 'recall': 0.05202110255326189, 'f1-score': 0.09470389266720552, 'support': 707213}, '2': {'precision': 0.27661229279095007, 'recall': 0.596548645450319, 'f1-score': 0.37796626338259887, 'support': 378576}, 'accuracy': 0.272436355364071, 'macro avg': {'precision': 0.34615401754721037, 'recall': 0.3380649598860958, 'f1-score': 0.25274832818553755, 'support': 1441834}, 'weighted avg': {'precision': 0.3892520232932399, 'recall': 0.272436355364071, 'f1-score': 0.21621231708150151, 'support': 1441834}}
[[130179  16560 209306]
 [289122  36790 381301]
 [136352  16385 225839]]
Evaluating performance on  train set...
1454/1454 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.097904
{'0': {'precision': 0.33100128246846466, 'recall': 0.2808090157678505, 'f1-score': 0.3038462890075907, 'support': 123162}, '1': {'precision': 0.36439895336309064, 'recall': 0.03853384223504423, 'f1-score': 0.06969743804876613, 'support': 122879}, '2': {'precision': 0.34977515071775034, 'recall': 0.7065067352087201, 'f1-score': 0.467902561017577, 'support': 126054}, 'accuracy': 0.34501404211290126, 'macro avg': {'precision': 0.34839179551643523, 'recall': 0.34194986440387165, 'f1-score': 0.28048209602464463, 'support': 372095}, 'weighted avg': {'precision': 0.34839037286246677, 'recall': 0.34501404211290126, 'f1-score': 0.28209908104988474, 'support': 372095}}
[[34585  4240 84337]
 [36924  4735 81220]
 [32977  4019 89058]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971979
{'0': {'precision': 0.34265445278600454, 'recall': 0.30654370686822213, 'f1-score': 0.3235947747845412, 'support': 48688}, '1': {'precision': 0.3424574209245742, 'recall': 0.03801228816420228, 'f1-score': 0.06842904892130051, 'support': 44433}, '2': {'precision': 0.3543152828943166, 'recall': 0.6751470886589572, 'f1-score': 0.4647375918219144, 'support': 49290}, 'accuracy': 0.3503381059047405, 'macro avg': {'precision': 0.3464757188682985, 'recall': 0.33990102789712723, 'f1-score': 0.28558713850925205, 'support': 142411}, 'weighted avg': {'precision': 0.34662891823698627, 'recall': 0.3503381059047405, 'f1-score': 0.29283276029472477, 'support': 142411}}
[[14925  1628 32135]
 [14235  1689 28509]
 [14397  1615 33278]]
training model: results/WBA/W0/deepVOL_L3/h500
Epoch 1/50
1454/1454 - 61s - loss: 3.2971 - accuracy500: 0.3636 - val_loss: 3.3072 - val_accuracy500: 0.3080 - 61s/epoch - 42ms/step
Epoch 2/50
1454/1454 - 58s - loss: 3.2976 - accuracy500: 0.3460 - val_loss: 3.3066 - val_accuracy500: 0.3118 - 58s/epoch - 40ms/step
Epoch 3/50
1454/1454 - 58s - loss: 3.2935 - accuracy500: 0.3498 - val_loss: 3.3040 - val_accuracy500: 0.3378 - 58s/epoch - 40ms/step
Epoch 4/50
1454/1454 - 57s - loss: 3.2847 - accuracy500: 0.3634 - val_loss: 3.2990 - val_accuracy500: 0.3483 - 57s/epoch - 39ms/step
Epoch 5/50
1454/1454 - 59s - loss: 3.2713 - accuracy500: 0.3793 - val_loss: 3.3103 - val_accuracy500: 0.3365 - 59s/epoch - 40ms/step
Epoch 6/50
1454/1454 - 56s - loss: 3.2651 - accuracy500: 0.3813 - val_loss: 3.3037 - val_accuracy500: 0.3434 - 56s/epoch - 39ms/step
Epoch 7/50
1454/1454 - 56s - loss: 3.2626 - accuracy500: 0.3820 - val_loss: 3.3182 - val_accuracy500: 0.3283 - 56s/epoch - 39ms/step
Epoch 8/50
1454/1454 - 56s - loss: 3.2574 - accuracy500: 0.3843 - val_loss: 3.3405 - val_accuracy500: 0.3171 - 56s/epoch - 39ms/step
Epoch 9/50
1454/1454 - 57s - loss: 3.2528 - accuracy500: 0.3869 - val_loss: 3.3435 - val_accuracy500: 0.3252 - 57s/epoch - 39ms/step
Epoch 10/50
1454/1454 - 61s - loss: 3.2498 - accuracy500: 0.3899 - val_loss: 3.3307 - val_accuracy500: 0.3329 - 61s/epoch - 42ms/step
Epoch 11/50
1454/1454 - 60s - loss: 3.2479 - accuracy500: 0.3912 - val_loss: 3.3432 - val_accuracy500: 0.3299 - 60s/epoch - 41ms/step
Epoch 12/50
1454/1454 - 56s - loss: 3.2440 - accuracy500: 0.3950 - val_loss: 3.3742 - val_accuracy500: 0.3107 - 56s/epoch - 39ms/step
Epoch 13/50
1454/1454 - 56s - loss: 3.2426 - accuracy500: 0.3947 - val_loss: 3.3863 - val_accuracy500: 0.3170 - 56s/epoch - 39ms/step
Epoch 14/50
1454/1454 - 57s - loss: 3.2382 - accuracy500: 0.3979 - val_loss: 3.3875 - val_accuracy500: 0.3190 - 57s/epoch - 39ms/step
testing model: results/WBA/W0/deepVOL_L3/h500
Evaluating performance on  test set...
5633/5633 - 99s - 99s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.091126
{'0': {'precision': 0.25702554776192443, 'recall': 0.19357503202028387, 'f1-score': 0.22083295437432998, 'support': 382570}, '1': {'precision': 0.4712039153755169, 'recall': 0.5648437780893827, 'f1-score': 0.5137921767309719, 'support': 639699}, '2': {'precision': 0.3135539334787688, 'recall': 0.2891304088758595, 'f1-score': 0.30084729474523497, 'support': 419565}, 'accuracy': 0.3861020061948879, 'macro avg': {'precision': 0.3472611322054034, 'recall': 0.3491830729951753, 'f1-score': 0.34515747528351226, 'support': 1441834}, 'weighted avg': {'precision': 0.36849955915112415, 'recall': 0.3861020061948879, 'f1-score': 0.3740939665990661, 'support': 1441834}}
[[ 74056 189550 118964]
 [131758 361330 146611]
 [ 82313 215943 121309]]
Evaluating performance on  train set...
1454/1454 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0968484
{'0': {'precision': 0.339065239952761, 'recall': 0.15415466718732204, 'f1-score': 0.21194801127466334, 'support': 122922}, '1': {'precision': 0.36632895689031325, 'recall': 0.46197219823020386, 'f1-score': 0.4086286550339827, 'support': 122726}, '2': {'precision': 0.36133324248487064, 'recall': 0.46133162510775266, 'f1-score': 0.40525482131940194, 'support': 126447}, 'accuracy': 0.3600666496459238, 'macro avg': {'precision': 0.35557581310931496, 'recall': 0.35915283017509286, 'f1-score': 0.3419438292093493, 'support': 372095}, 'weighted avg': {'precision': 0.35562469127851304, 'recall': 0.3600666496459238, 'f1-score': 0.34250847270449525, 'support': 372095}}
[[18949 48404 55569]
 [18492 56696 47538]
 [18445 49668 58334]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1002797
{'0': {'precision': 0.3554567225453301, 'recall': 0.16677032964828153, 'f1-score': 0.22702628883578013, 'support': 49841}, '1': {'precision': 0.3306677912767027, 'recall': 0.4764085905914795, 'f1-score': 0.3903793493039199, 'support': 42791}, '2': {'precision': 0.36734871723368656, 'recall': 0.4234114787360132, 'f1-score': 0.3933927488218002, 'support': 49779}, 'accuracy': 0.34951654015490374, 'macro avg': {'precision': 0.3511577436852398, 'recall': 0.35553013299192476, 'f1-score': 0.33693279565383333, 'support': 142411}, 'weighted avg': {'precision': 0.3521650417459246, 'recall': 0.34951654015490374, 'f1-score': 0.3342623648561456, 'support': 142411}}
[[ 8312 20805 20724]
 [ 6830 20386 15575]
 [ 8242 20460 21077]]
training model: results/WBA/W0/deepVOL_L3/h1000
Epoch 1/50
1454/1454 - 59s - loss: 3.3078 - accuracy1000: 0.3586 - val_loss: 3.2987 - val_accuracy1000: 0.3317 - 59s/epoch - 41ms/step
Epoch 2/50
1454/1454 - 57s - loss: 3.2944 - accuracy1000: 0.3521 - val_loss: 3.2974 - val_accuracy1000: 0.3444 - 57s/epoch - 39ms/step
Epoch 3/50
1454/1454 - 56s - loss: 3.2884 - accuracy1000: 0.3610 - val_loss: 3.2954 - val_accuracy1000: 0.3486 - 56s/epoch - 39ms/step
Epoch 4/50
1454/1454 - 56s - loss: 3.2802 - accuracy1000: 0.3730 - val_loss: 3.3002 - val_accuracy1000: 0.3460 - 56s/epoch - 39ms/step
Epoch 5/50
1454/1454 - 56s - loss: 3.2722 - accuracy1000: 0.3782 - val_loss: 3.3004 - val_accuracy1000: 0.3532 - 56s/epoch - 39ms/step
Epoch 6/50
1454/1454 - 56s - loss: 3.2657 - accuracy1000: 0.3843 - val_loss: 3.3017 - val_accuracy1000: 0.3571 - 56s/epoch - 39ms/step
Epoch 7/50
1454/1454 - 56s - loss: 3.2647 - accuracy1000: 0.3844 - val_loss: 3.3054 - val_accuracy1000: 0.3577 - 56s/epoch - 39ms/step
Epoch 8/50
1454/1454 - 57s - loss: 3.2577 - accuracy1000: 0.3890 - val_loss: 3.3295 - val_accuracy1000: 0.3506 - 57s/epoch - 39ms/step
Epoch 9/50
1454/1454 - 57s - loss: 3.2509 - accuracy1000: 0.3933 - val_loss: 3.3392 - val_accuracy1000: 0.3508 - 57s/epoch - 39ms/step
Epoch 10/50
1454/1454 - 58s - loss: 3.2432 - accuracy1000: 0.3983 - val_loss: 3.3568 - val_accuracy1000: 0.3556 - 58s/epoch - 40ms/step
Epoch 11/50
1454/1454 - 58s - loss: 3.2352 - accuracy1000: 0.4030 - val_loss: 3.3687 - val_accuracy1000: 0.3555 - 58s/epoch - 40ms/step
Epoch 12/50
1454/1454 - 58s - loss: 3.2298 - accuracy1000: 0.4068 - val_loss: 3.3797 - val_accuracy1000: 0.3538 - 58s/epoch - 40ms/step
Epoch 13/50
1454/1454 - 62s - loss: 3.2256 - accuracy1000: 0.4094 - val_loss: 3.4249 - val_accuracy1000: 0.3563 - 62s/epoch - 43ms/step
testing model: results/WBA/W0/deepVOL_L3/h1000
Evaluating performance on  test set...
5633/5633 - 99s - 99s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0978373
{'0': {'precision': 0.2717792337187887, 'recall': 0.22589217824241953, 'f1-score': 0.24672023198542967, 'support': 398491}, '1': {'precision': 0.4199124631750668, 'recall': 0.623696050545438, 'f1-score': 0.5019080266476943, 'support': 590993}, '2': {'precision': 0.32290333387738274, 'recall': 0.1661965292362109, 'f1-score': 0.21944562825100847, 'support': 452350}, 'accuracy': 0.37021945660873584, 'macro avg': {'precision': 0.3381983435904128, 'recall': 0.33859491934135616, 'f1-score': 0.32269129562804416, 'support': 1441834}, 'weighted avg': {'precision': 0.34853681356695027, 'recall': 0.37021945660873584, 'f1-score': 0.34276217116259594, 'support': 1441834}}
[[ 90016 236713  71762]
 [136512 368600  85881]
 [104682 272489  75179]]
Evaluating performance on  train set...
1454/1454 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0978584
{'0': {'precision': 0.3397268527816831, 'recall': 0.22055611696058935, 'f1-score': 0.2674678315181942, 'support': 122708}, '1': {'precision': 0.34740730276822945, 'recall': 0.5407776004169789, 'f1-score': 0.4230427400524336, 'support': 122788}, '2': {'precision': 0.37312681395486585, 'recall': 0.2985568606387096, 'f1-score': 0.3317024796289552, 'support': 126599}, 'accuracy': 0.3527647509372606, 'macro avg': {'precision': 0.3534203231682595, 'recall': 0.3532968593387593, 'f1-score': 0.34073768373319435, 'support': 372095}, 'weighted avg': {'precision': 0.3536251012868009, 'recall': 0.3527647509372606, 'f1-score': 0.3406608980342087, 'support': 372095}}
[[27064 62410 33234]
 [26120 66401 30267]
 [26480 62322 37797]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987433
{'0': {'precision': 0.35393204657840166, 'recall': 0.22727552086534325, 'f1-score': 0.27680331345592457, 'support': 48813}, '1': {'precision': 0.34133617043094827, 'recall': 0.575339210094201, 'f1-score': 0.4284702891438317, 'support': 46284}, '2': {'precision': 0.3659687764734358, 'recall': 0.2556537177156867, 'f1-score': 0.30102282059577434, 'support': 47314}, 'accuracy': 0.3498255050522783, 'macro avg': {'precision': 0.35374566449426187, 'recall': 0.3527561495584102, 'f1-score': 0.3354321410651768, 'support': 142411}, 'weighted avg': {'precision': 0.35383737907831325, 'recall': 0.3498255050522783, 'f1-score': 0.3341421149779555, 'support': 142411}}
[[11094 26639 11080]
 [ 9779 26629  9876]
 [10472 24746 12096]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        26 (peak)  13.87 (ave)

============================================
