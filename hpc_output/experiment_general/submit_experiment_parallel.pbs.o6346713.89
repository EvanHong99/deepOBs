This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAPL_orderbooks/AAPL_orderbooks_2019-11-13.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-11-05.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-10-23.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-10-24.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-11-01.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-10-28.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-10-30.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-10-25.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-11-15.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-10-29.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-11-11.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-10-31.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-10-22.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-11-07.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-11-06.csv
training model: results/AAPL/W8/deepLOB_L1/h10
Epoch 1/50
3903/3903 - 69s - loss: 3.1837 - accuracy10: 0.4260 - val_loss: 3.3712 - val_accuracy10: 0.3441 - 69s/epoch - 18ms/step
Epoch 2/50
3903/3903 - 58s - loss: 3.1493 - accuracy10: 0.4432 - val_loss: 3.3631 - val_accuracy10: 0.3549 - 58s/epoch - 15ms/step
Epoch 3/50
3903/3903 - 59s - loss: 3.1288 - accuracy10: 0.4518 - val_loss: 3.3896 - val_accuracy10: 0.3496 - 59s/epoch - 15ms/step
Epoch 4/50
3903/3903 - 57s - loss: 3.1176 - accuracy10: 0.4561 - val_loss: 3.3877 - val_accuracy10: 0.3565 - 57s/epoch - 15ms/step
Epoch 5/50
3903/3903 - 57s - loss: 3.1100 - accuracy10: 0.4587 - val_loss: 3.3923 - val_accuracy10: 0.3574 - 57s/epoch - 15ms/step
Epoch 6/50
3903/3903 - 58s - loss: 3.1036 - accuracy10: 0.4604 - val_loss: 3.3883 - val_accuracy10: 0.3580 - 58s/epoch - 15ms/step
Epoch 7/50
3903/3903 - 57s - loss: 3.0988 - accuracy10: 0.4621 - val_loss: 3.3746 - val_accuracy10: 0.3629 - 57s/epoch - 15ms/step
Epoch 8/50
3903/3903 - 58s - loss: 3.0946 - accuracy10: 0.4631 - val_loss: 3.3998 - val_accuracy10: 0.3590 - 58s/epoch - 15ms/step
Epoch 9/50
3903/3903 - 59s - loss: 3.0912 - accuracy10: 0.4641 - val_loss: 3.3932 - val_accuracy10: 0.3681 - 59s/epoch - 15ms/step
Epoch 10/50
3903/3903 - 58s - loss: 3.0880 - accuracy10: 0.4649 - val_loss: 3.3923 - val_accuracy10: 0.3714 - 58s/epoch - 15ms/step
Epoch 11/50
3903/3903 - 57s - loss: 3.0854 - accuracy10: 0.4657 - val_loss: 3.3968 - val_accuracy10: 0.3727 - 57s/epoch - 15ms/step
Epoch 12/50
3903/3903 - 60s - loss: 3.0829 - accuracy10: 0.4666 - val_loss: 3.4093 - val_accuracy10: 0.3708 - 60s/epoch - 15ms/step
testing model: results/AAPL/W8/deepLOB_L1/h10
Evaluating performance on  test set...
10609/10609 - 67s - 67s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1055213
{'0': {'precision': 0.4653663269222568, 'recall': 0.09989781240738177, 'f1-score': 0.164486210226336, 'support': 873883}, '1': {'precision': 0.3679795391078315, 'recall': 0.5994295409750321, 'f1-score': 0.45601764704693004, 'support': 940646}, '2': {'precision': 0.3929771108886213, 'recall': 0.43425145341579063, 'f1-score': 0.41258459614729714, 'support': 901153}, 'accuracy': 0.3838730013307891, 'macro avg': {'precision': 0.4087743256395699, 'recall': 0.37785960226606813, 'f1-score': 0.34436281780685435, 'support': 2715682}, 'weighted avg': {'precision': 0.40761278596759176, 'recall': 0.3838730013307891, 'f1-score': 0.34779282885376606, 'support': 2715682}}
[[ 87299 502538 284046]
 [ 56367 563851 320428]
 [ 43926 465900 391327]]
Evaluating performance on  train set...
3903/3903 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1364135
{'0': {'precision': 0.4635622870822208, 'recall': 0.11976058586885743, 'f1-score': 0.19034566845223047, 'support': 336321}, '1': {'precision': 0.3333585817682217, 'recall': 0.8784954888003096, 'f1-score': 0.4833156356835306, 'support': 325634}, '2': {'precision': 0.47087127100451553, 'recall': 0.07547729511017241, 'f1-score': 0.13010042337348904, 'support': 337108}, 'accuracy': 0.3521199363803884, 'macro avg': {'precision': 0.4225973799516527, 'recall': 0.3579111232597798, 'f1-score': 0.2679205758364167, 'support': 999063}, 'weighted avg': {'precision': 0.42358999662191765, 'recall': 0.3521199363803884, 'f1-score': 0.2655079237168062, 'support': 999063}}
[[ 40278 281609  14434]
 [ 25408 286068  14158]
 [ 21202 290462  25444]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1245044
{'0': {'precision': 0.4673769481377124, 'recall': 0.16017864687066208, 'f1-score': 0.23858860546128782, 'support': 99414}, '1': {'precision': 0.3306185114182618, 'recall': 0.8565427319521844, 'f1-score': 0.4770857953552568, 'support': 94028}, '2': {'precision': 0.5042443686919323, 'recall': 0.07605528727404703, 'f1-score': 0.1321746443338706, 'support': 99191}, 'accuracy': 0.355417878366418, 'macro avg': {'precision': 0.4340799427493021, 'recall': 0.36425888869896444, 'f1-score': 0.28261634838347177, 'support': 292633}, 'weighted avg': {'precision': 0.4359307135173419, 'recall': 0.355417878366418, 'f1-score': 0.2791517222429238, 'support': 292633}}
[[15924 80141  3349]
 [ 9421 80539  4068]
 [ 8726 82921  7544]]
training model: results/AAPL/W8/deepLOB_L1/h20
Epoch 1/50
3903/3903 - 61s - loss: 3.2223 - accuracy20: 0.4061 - val_loss: 3.4233 - val_accuracy20: 0.3345 - 61s/epoch - 16ms/step
Epoch 2/50
3903/3903 - 57s - loss: 3.1979 - accuracy20: 0.4201 - val_loss: 3.4086 - val_accuracy20: 0.3579 - 57s/epoch - 15ms/step
Epoch 3/50
3903/3903 - 57s - loss: 3.1854 - accuracy20: 0.4260 - val_loss: 3.3807 - val_accuracy20: 0.3535 - 57s/epoch - 15ms/step
Epoch 4/50
3903/3903 - 58s - loss: 3.1755 - accuracy20: 0.4305 - val_loss: 3.3620 - val_accuracy20: 0.3486 - 58s/epoch - 15ms/step
Epoch 5/50
3903/3903 - 58s - loss: 3.1686 - accuracy20: 0.4332 - val_loss: 3.3744 - val_accuracy20: 0.3466 - 58s/epoch - 15ms/step
Epoch 6/50
3903/3903 - 59s - loss: 3.1647 - accuracy20: 0.4346 - val_loss: 3.3553 - val_accuracy20: 0.3521 - 59s/epoch - 15ms/step
Epoch 7/50
3903/3903 - 59s - loss: 3.1614 - accuracy20: 0.4355 - val_loss: 3.3643 - val_accuracy20: 0.3491 - 59s/epoch - 15ms/step
Epoch 8/50
3903/3903 - 57s - loss: 3.1576 - accuracy20: 0.4368 - val_loss: 3.3721 - val_accuracy20: 0.3497 - 57s/epoch - 15ms/step
Epoch 9/50
3903/3903 - 58s - loss: 3.1553 - accuracy20: 0.4381 - val_loss: 3.3827 - val_accuracy20: 0.3418 - 58s/epoch - 15ms/step
Epoch 10/50
3903/3903 - 57s - loss: 3.1534 - accuracy20: 0.4389 - val_loss: 3.3713 - val_accuracy20: 0.3488 - 57s/epoch - 15ms/step
Epoch 11/50
3903/3903 - 58s - loss: 3.1510 - accuracy20: 0.4397 - val_loss: 3.3819 - val_accuracy20: 0.3499 - 58s/epoch - 15ms/step
Epoch 12/50
3903/3903 - 58s - loss: 3.1492 - accuracy20: 0.4399 - val_loss: 3.4017 - val_accuracy20: 0.3468 - 58s/epoch - 15ms/step
Epoch 13/50
3903/3903 - 58s - loss: 3.1480 - accuracy20: 0.4403 - val_loss: 3.4104 - val_accuracy20: 0.3482 - 58s/epoch - 15ms/step
Epoch 14/50
3903/3903 - 57s - loss: 3.1464 - accuracy20: 0.4412 - val_loss: 3.4210 - val_accuracy20: 0.3448 - 57s/epoch - 15ms/step
Epoch 15/50
3903/3903 - 59s - loss: 3.1445 - accuracy20: 0.4420 - val_loss: 3.4595 - val_accuracy20: 0.3454 - 59s/epoch - 15ms/step
Epoch 16/50
3903/3903 - 59s - loss: 3.1434 - accuracy20: 0.4422 - val_loss: 3.4506 - val_accuracy20: 0.3465 - 59s/epoch - 15ms/step
testing model: results/AAPL/W8/deepLOB_L1/h20
Evaluating performance on  test set...
10609/10609 - 54s - 54s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1221665
{'0': {'precision': 0.34058275877429606, 'recall': 0.23057951766991072, 'f1-score': 0.2749880777622959, 'support': 895279}, '1': {'precision': 0.33578121351132606, 'recall': 0.5870783060425928, 'f1-score': 0.4272153276902682, 'support': 893954}, '2': {'precision': 0.39672143144644884, 'recall': 0.23405497766201916, 'f1-score': 0.294413755601553, 'support': 926449}, 'accuracy': 0.34911819572394703, 'macro avg': {'precision': 0.35769513457735697, 'recall': 0.35057093379150756, 'f1-score': 0.33220572035137236, 'support': 2715682}, 'weighted avg': {'precision': 0.3581537617725964, 'recall': 0.34911819572394703, 'f1-score': 0.33172559665832735, 'support': 2715682}}
[[206433 513907 174939]
 [214332 524821 154801]
 [185352 524257 216840]]
Evaluating performance on  train set...
3903/3903 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1324902
{'0': {'precision': 0.35543072459747793, 'recall': 0.46020077700821904, 'f1-score': 0.4010867537860952, 'support': 334102}, '1': {'precision': 0.32227564164499184, 'recall': 0.506728446638815, 'f1-score': 0.3939817368533574, 'support': 329125}, '2': {'precision': 0.362209064924459, 'recall': 0.05282637954239569, 'f1-score': 0.09220510581680594, 'support': 335836}, 'accuracy': 0.3385892581348724, 'macro avg': {'precision': 0.34663847705564294, 'recall': 0.33991853439647657, 'f1-score': 0.29575786548541955, 'support': 999063}, 'weighted avg': {'precision': 0.3467868693304077, 'recall': 0.3385892581348724, 'f1-score': 0.29491525526658086, 'support': 999063}}
[[153754 165677  14671]
 [145780 166777  16568]
 [133051 185044  17741]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1190664
{'0': {'precision': 0.3633382026575273, 'recall': 0.5232099514563107, 'f1-score': 0.4288591939254273, 'support': 98880}, '1': {'precision': 0.3348445197044335, 'recall': 0.45566239316239315, 'f1-score': 0.38602079931852057, 'support': 95472}, '2': {'precision': 0.37756457564575646, 'recall': 0.07808223359550676, 'f1-score': 0.1294032342377283, 'support': 98281}, 'accuracy': 0.35167599006263817, 'macro avg': {'precision': 0.35858243266923906, 'recall': 0.35231819273807014, 'f1-score': 0.3147610758272254, 'support': 292633}, 'weighted avg': {'precision': 0.35882002892031506, 'recall': 0.35167599006263817, 'f1-score': 0.3143106010327004, 'support': 292633}}
[[51735 40875  6270]
 [45588 43503  6381]
 [45065 45542  7674]]
training model: results/AAPL/W8/deepLOB_L1/h30
Epoch 1/50
3903/3903 - 61s - loss: 3.2354 - accuracy30: 0.3976 - val_loss: 3.3848 - val_accuracy30: 0.3405 - 61s/epoch - 16ms/step
Epoch 2/50
3903/3903 - 58s - loss: 3.2154 - accuracy30: 0.4097 - val_loss: 3.4042 - val_accuracy30: 0.3466 - 58s/epoch - 15ms/step
Epoch 3/50
3903/3903 - 59s - loss: 3.2055 - accuracy30: 0.4154 - val_loss: 3.4995 - val_accuracy30: 0.3427 - 59s/epoch - 15ms/step
Epoch 4/50
3903/3903 - 58s - loss: 3.2009 - accuracy30: 0.4177 - val_loss: 3.5241 - val_accuracy30: 0.3429 - 58s/epoch - 15ms/step
Epoch 5/50
3903/3903 - 58s - loss: 3.1967 - accuracy30: 0.4197 - val_loss: 3.4954 - val_accuracy30: 0.3450 - 58s/epoch - 15ms/step
Epoch 6/50
3903/3903 - 57s - loss: 3.1940 - accuracy30: 0.4203 - val_loss: 3.4496 - val_accuracy30: 0.3464 - 57s/epoch - 15ms/step
Epoch 7/50
3903/3903 - 58s - loss: 3.1907 - accuracy30: 0.4216 - val_loss: 3.4543 - val_accuracy30: 0.3475 - 58s/epoch - 15ms/step
Epoch 8/50
3903/3903 - 59s - loss: 3.1888 - accuracy30: 0.4232 - val_loss: 3.4755 - val_accuracy30: 0.3474 - 59s/epoch - 15ms/step
Epoch 9/50
3903/3903 - 58s - loss: 3.1870 - accuracy30: 0.4238 - val_loss: 3.4861 - val_accuracy30: 0.3468 - 58s/epoch - 15ms/step
Epoch 10/50
3903/3903 - 58s - loss: 3.1852 - accuracy30: 0.4245 - val_loss: 3.4976 - val_accuracy30: 0.3472 - 58s/epoch - 15ms/step
Epoch 11/50
3903/3903 - 58s - loss: 3.1833 - accuracy30: 0.4255 - val_loss: 3.4825 - val_accuracy30: 0.3455 - 58s/epoch - 15ms/step
testing model: results/AAPL/W8/deepLOB_L1/h30
Evaluating performance on  test set...
10609/10609 - 56s - 56s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1503413
{'0': {'precision': 0.3388820566051573, 'recall': 0.2604475468385027, 'f1-score': 0.29453242357215487, 'support': 922585}, '1': {'precision': 0.29620178274395537, 'recall': 0.6890754990494011, 'f1-score': 0.41431056015441675, 'support': 832633}, '2': {'precision': 0.34382900482647666, 'recall': 0.024921288044112012, 'f1-score': 0.04647406026716371, 'support': 960464}, 'accuracy': 0.308566319620633, 'macro avg': {'precision': 0.3263042813918631, 'recall': 0.3248147779773386, 'f1-score': 0.25177234799791176, 'support': 2715682}, 'weighted avg': {'precision': 0.32754581075993944, 'recall': 0.308566319620633, 'f1-score': 0.2435250159830238, 'support': 2715682}}
[[240285 661673  20627]
 [233833 573747  25053]
 [234934 701594  23936]]
Evaluating performance on  train set...
3903/3903 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1389463
{'0': {'precision': 0.33938131645661235, 'recall': 0.5045685916423317, 'f1-score': 0.4058088074444276, 'support': 334567}, '1': {'precision': 0.31134158670474094, 'recall': 0.4278206827217475, 'f1-score': 0.3604035965933224, 'support': 328245}, '2': {'precision': 0.33048770848154296, 'recall': 0.04973665505827492, 'f1-score': 0.08646133564255341, 'support': 336251}, 'accuracy': 0.3262717165984528, 'macro avg': {'precision': 0.3270702038809654, 'recall': 0.3273753098074514, 'f1-score': 0.28422457989343447, 'support': 999063}, 'weighted avg': {'precision': 0.3271754939332799, 'recall': 0.3262717165984528, 'f1-score': 0.28340917881572947, 'support': 999063}}
[[168812 150387  15368]
 [169303 140430  18512]
 [159296 160231  16724]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1296697
{'0': {'precision': 0.3532460817579577, 'recall': 0.5462104253277902, 'f1-score': 0.4290295106931618, 'support': 100064}, '1': {'precision': 0.32337847233718503, 'recall': 0.41578510461676, 'f1-score': 0.3638056748023504, 'support': 93962}, '2': {'precision': 0.3421853065044455, 'recall': 0.059326416988651924, 'f1-score': 0.1011209735270477, 'support': 98607}, 'accuracy': 0.3402692109228966, 'macro avg': {'precision': 0.33960328686652946, 'recall': 0.340440648977734, 'f1-score': 0.2979853863408533, 'support': 292633}, 'weighted avg': {'precision': 0.3399287519222327, 'recall': 0.3402692109228966, 'f1-score': 0.29759307258703077, 'support': 292633}}
[[54656 39969  5439]
 [49087 39068  5807]
 [50982 41775  5850]]
training model: results/AAPL/W8/deepLOB_L1/h50
Epoch 1/50
3903/3903 - 61s - loss: 3.2332 - accuracy50: 0.3979 - val_loss: 3.4359 - val_accuracy50: 0.3397 - 61s/epoch - 16ms/step
Epoch 2/50
3903/3903 - 57s - loss: 3.2194 - accuracy50: 0.4065 - val_loss: 3.4526 - val_accuracy50: 0.3380 - 57s/epoch - 15ms/step
Epoch 3/50
3903/3903 - 57s - loss: 3.2118 - accuracy50: 0.4114 - val_loss: 3.4874 - val_accuracy50: 0.3368 - 57s/epoch - 15ms/step
Epoch 4/50
3903/3903 - 57s - loss: 3.2059 - accuracy50: 0.4145 - val_loss: 3.4423 - val_accuracy50: 0.3374 - 57s/epoch - 15ms/step
Epoch 5/50
3903/3903 - 57s - loss: 3.2014 - accuracy50: 0.4172 - val_loss: 3.4116 - val_accuracy50: 0.3405 - 57s/epoch - 15ms/step
Epoch 6/50
3903/3903 - 57s - loss: 3.1987 - accuracy50: 0.4185 - val_loss: 3.4298 - val_accuracy50: 0.3360 - 57s/epoch - 15ms/step
Epoch 7/50
3903/3903 - 59s - loss: 3.1962 - accuracy50: 0.4195 - val_loss: 3.4430 - val_accuracy50: 0.3364 - 59s/epoch - 15ms/step
Epoch 8/50
3903/3903 - 57s - loss: 3.1931 - accuracy50: 0.4213 - val_loss: 3.4263 - val_accuracy50: 0.3384 - 57s/epoch - 15ms/step
Epoch 9/50
3903/3903 - 59s - loss: 3.1912 - accuracy50: 0.4218 - val_loss: 3.4103 - val_accuracy50: 0.3387 - 59s/epoch - 15ms/step
Epoch 10/50
3903/3903 - 58s - loss: 3.1895 - accuracy50: 0.4226 - val_loss: 3.4083 - val_accuracy50: 0.3387 - 58s/epoch - 15ms/step
Epoch 11/50
3903/3903 - 57s - loss: 3.1880 - accuracy50: 0.4235 - val_loss: 3.4258 - val_accuracy50: 0.3387 - 57s/epoch - 15ms/step
Epoch 12/50
3903/3903 - 58s - loss: 3.1873 - accuracy50: 0.4238 - val_loss: 3.4339 - val_accuracy50: 0.3371 - 58s/epoch - 15ms/step
Epoch 13/50
3903/3903 - 57s - loss: 3.1857 - accuracy50: 0.4242 - val_loss: 3.4642 - val_accuracy50: 0.3369 - 57s/epoch - 15ms/step
Epoch 14/50
3903/3903 - 58s - loss: 3.1847 - accuracy50: 0.4250 - val_loss: 3.4729 - val_accuracy50: 0.3377 - 58s/epoch - 15ms/step
Epoch 15/50
3903/3903 - 58s - loss: 3.1840 - accuracy50: 0.4252 - val_loss: 3.5131 - val_accuracy50: 0.3383 - 58s/epoch - 15ms/step
Epoch 16/50
3903/3903 - 59s - loss: 3.1828 - accuracy50: 0.4256 - val_loss: 3.5190 - val_accuracy50: 0.3383 - 59s/epoch - 15ms/step
Epoch 17/50
3903/3903 - 57s - loss: 3.1822 - accuracy50: 0.4261 - val_loss: 3.5276 - val_accuracy50: 0.3380 - 57s/epoch - 15ms/step
Epoch 18/50
3903/3903 - 58s - loss: 3.1813 - accuracy50: 0.4266 - val_loss: 3.6064 - val_accuracy50: 0.3404 - 58s/epoch - 15ms/step
Epoch 19/50
3903/3903 - 58s - loss: 3.1801 - accuracy50: 0.4268 - val_loss: 3.6140 - val_accuracy50: 0.3389 - 58s/epoch - 15ms/step
Epoch 20/50
3903/3903 - 59s - loss: 3.1794 - accuracy50: 0.4271 - val_loss: 3.6433 - val_accuracy50: 0.3378 - 59s/epoch - 15ms/step
testing model: results/AAPL/W8/deepLOB_L1/h50
Evaluating performance on  test set...
10609/10609 - 64s - 64s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1766316
{'0': {'precision': 0.2858612132230966, 'recall': 0.04806167995546477, 'f1-score': 0.08228827925411265, 'support': 896369}, '1': {'precision': 0.3303823357618792, 'recall': 0.8044781409740536, 'f1-score': 0.46840183922666817, 'support': 897158}, '2': {'precision': 0.3664656523064952, 'recall': 0.15117306743443348, 'f1-score': 0.21404788573876501, 'support': 922155}, 'accuracy': 0.3329660836578068, 'macro avg': {'precision': 0.32756973376382365, 'recall': 0.334570962787984, 'f1-score': 0.25491266807318197, 'support': 2715682}, 'weighted avg': {'precision': 0.3279398762541881, 'recall': 0.3329660836578068, 'f1-score': 0.25458667396885193, 'support': 2715682}}
[[ 43081 728634 124654]
 [ 59069 721744 116345]
 [ 48556 734194 139405]]
Evaluating performance on  train set...
3903/3903 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1615105
{'0': {'precision': 0.3167449546960606, 'recall': 0.1150348285771728, 'f1-score': 0.16877446780822664, 'support': 338228}, '1': {'precision': 0.31994728030657243, 'recall': 0.8564303394131001, 'f1-score': 0.4658581619948746, 'support': 321997}, '2': {'precision': 0.4105807533720036, 'recall': 0.017338669216557766, 'f1-score': 0.03327226339173206, 'support': 338838}, 'accuracy': 0.32085163798479177, 'macro avg': {'precision': 0.3490909961248789, 'recall': 0.3296012790689436, 'f1-score': 0.2226349643982778, 'support': 999063}, 'weighted avg': {'precision': 0.3496020153532635, 'recall': 0.32085163798479177, 'f1-score': 0.21856788657855633, 'support': 999063}}
[[ 38908 294088   5232]
 [ 43027 275768   3202]
 [ 40902 292061   5875]]
Evaluating performance on  val set...
1144/1144 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1409605
{'0': {'precision': 0.32841265439341255, 'recall': 0.15729728625143044, 'f1-score': 0.21271304119544868, 'support': 97872}, '1': {'precision': 0.3408939483741748, 'recall': 0.8463536909618624, 'f1-score': 0.4860264057368809, 'support': 98538}, '2': {'precision': 0.3708370837083708, 'recall': 0.00428172058655415, 'f1-score': 0.008465695440442188, 'support': 96223}, 'accuracy': 0.33900824582326666, 'macro avg': {'precision': 0.3467145621586527, 'recall': 0.3359775659332824, 'f1-score': 0.23573504745759058, 'support': 292633}, 'weighted avg': {'precision': 0.34656538360799044, 'recall': 0.33900824582326666, 'f1-score': 0.23758535554345342, 'support': 292633}}
[[15395 82126   351]
 [14792 83398   348]
 [16690 79121   412]]
training model: results/AAPL/W8/deepLOB_L1/h100
Epoch 1/50
3903/3903 - 63s - loss: 3.2495 - accuracy100: 0.3922 - val_loss: 3.5094 - val_accuracy100: 0.3221 - 63s/epoch - 16ms/step
Epoch 2/50
3903/3903 - 59s - loss: 3.2329 - accuracy100: 0.4005 - val_loss: 3.4801 - val_accuracy100: 0.3194 - 59s/epoch - 15ms/step
Epoch 3/50
3903/3903 - 57s - loss: 3.2248 - accuracy100: 0.4054 - val_loss: 3.5808 - val_accuracy100: 0.3206 - 57s/epoch - 15ms/step
Epoch 4/50
3903/3903 - 59s - loss: 3.2215 - accuracy100: 0.4077 - val_loss: 3.6038 - val_accuracy100: 0.3229 - 59s/epoch - 15ms/step
Epoch 5/50
3903/3903 - 57s - loss: 3.2191 - accuracy100: 0.4090 - val_loss: 3.5578 - val_accuracy100: 0.3217 - 57s/epoch - 15ms/step
Epoch 6/50
3903/3903 - 58s - loss: 3.2169 - accuracy100: 0.4103 - val_loss: 3.5448 - val_accuracy100: 0.3220 - 58s/epoch - 15ms/step
Epoch 7/50
3903/3903 - 58s - loss: 3.2154 - accuracy100: 0.4116 - val_loss: 3.5282 - val_accuracy100: 0.3224 - 58s/epoch - 15ms/step
Epoch 8/50
3903/3903 - 58s - loss: 3.2141 - accuracy100: 0.4124 - val_loss: 3.5339 - val_accuracy100: 0.3222 - 58s/epoch - 15ms/step
Epoch 9/50
3903/3903 - 59s - loss: 3.2130 - accuracy100: 0.4128 - val_loss: 3.5853 - val_accuracy100: 0.3238 - 59s/epoch - 15ms/step
Epoch 10/50
3903/3903 - 59s - loss: 3.2114 - accuracy100: 0.4133 - val_loss: 3.6037 - val_accuracy100: 0.3252 - 59s/epoch - 15ms/step
Epoch 11/50
3903/3903 - 58s - loss: 3.2101 - accuracy100: 0.4142 - val_loss: 3.6086 - val_accuracy100: 0.3261 - 58s/epoch - 15ms/step
Epoch 12/50
3903/3903 - 59s - loss: 3.2094 - accuracy100: 0.4147 - val_loss: 3.6011 - val_accuracy100: 0.3287 - 59s/epoch - 15ms/step
testing model: results/AAPL/W8/deepLOB_L1/h100
Evaluating performance on  test set...
10609/10609 - 59s - 59s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1748611
{'0': {'precision': 0.3513908684326928, 'recall': 0.028925686705653653, 'f1-score': 0.053451379037729396, 'support': 988706}, '1': {'precision': 0.2632217871681485, 'recall': 0.9169993215089973, 'f1-score': 0.40903216942141085, 'support': 720717}, '2': {'precision': 0.3614640268836795, 'recall': 0.04436134235818015, 'f1-score': 0.0790242831625292, 'support': 1006259}, 'accuracy': 0.2703317251430764, 'macro avg': {'precision': 0.32535889416150693, 'recall': 0.3300954501909437, 'f1-score': 0.1805026105405565, 'support': 2715682}, 'weighted avg': {'precision': 0.33172407777310625, 'recall': 0.2703317251430764, 'f1-score': 0.15729493856887947, 'support': 2715682}}
[[ 28599 916832  43275]
 [ 24239 660897  35581]
 [ 28550 933070  44639]]
Evaluating performance on  train set...
3903/3903 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1519499
{'0': {'precision': 0.31487363623808867, 'recall': 0.054632860587363156, 'f1-score': 0.0931103924776604, 'support': 333865}, '1': {'precision': 0.3267076535690361, 'recall': 0.8835194513564363, 'f1-score': 0.4770221484223642, 'support': 329540}, '2': {'precision': 0.32318440227400114, 'recall': 0.048099553712409655, 'f1-score': 0.0837365863272599, 'support': 335658}, 'accuracy': 0.3258453170620872, 'macro avg': {'precision': 0.32158856402704195, 'recall': 0.32875062188540305, 'f1-score': 0.21795637574242818, 'support': 999063}, 'weighted avg': {'precision': 0.321569267221643, 'recall': 0.3258453170620872, 'f1-score': 0.21659398363175836, 'support': 999063}}
[[ 18240 299422  16203]
 [ 20777 291155  17608]
 [ 18911 300602  16145]]
Evaluating performance on  val set...
1144/1144 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1620029
{'0': {'precision': 0.34232050893668586, 'recall': 0.0671506531837135, 'f1-score': 0.11227675059822974, 'support': 100967}, '1': {'precision': 0.31640181943616186, 'recall': 0.8749501503573007, 'f1-score': 0.4647422869279961, 'support': 92779}, '2': {'precision': 0.3369404820462371, 'recall': 0.05541678886001193, 'f1-score': 0.09517937317087997, 'support': 98887}, 'accuracy': 0.31929755017376715, 'macro avg': {'precision': 0.33188760347302826, 'recall': 0.3325058641336754, 'f1-score': 0.2240661368990353, 'support': 292633}, 'weighted avg': {'precision': 0.3322849872686412, 'recall': 0.31929755017376715, 'f1-score': 0.21824802394566853, 'support': 292633}}
[[ 6780 88529  5658]
 [ 6476 81177  5126]
 [ 6550 86857  5480]]
training model: results/AAPL/W8/deepLOB_L1/h200
Epoch 1/50
3903/3903 - 60s - loss: 3.2312 - accuracy200: 0.3997 - val_loss: 3.5185 - val_accuracy200: 0.3196 - 60s/epoch - 15ms/step
Epoch 2/50
3903/3903 - 56s - loss: 3.2128 - accuracy200: 0.4114 - val_loss: 3.5407 - val_accuracy200: 0.3196 - 56s/epoch - 14ms/step
Epoch 3/50
3903/3903 - 57s - loss: 3.2028 - accuracy200: 0.4167 - val_loss: 3.6066 - val_accuracy200: 0.3183 - 57s/epoch - 15ms/step
Epoch 4/50
3903/3903 - 58s - loss: 3.1980 - accuracy200: 0.4197 - val_loss: 3.6315 - val_accuracy200: 0.3171 - 58s/epoch - 15ms/step
Epoch 5/50
3903/3903 - 58s - loss: 3.1937 - accuracy200: 0.4222 - val_loss: 3.6370 - val_accuracy200: 0.3182 - 58s/epoch - 15ms/step
Epoch 6/50
3903/3903 - 57s - loss: 3.1906 - accuracy200: 0.4240 - val_loss: 3.6941 - val_accuracy200: 0.3165 - 57s/epoch - 15ms/step
Epoch 7/50
3903/3903 - 58s - loss: 3.1874 - accuracy200: 0.4255 - val_loss: 3.7192 - val_accuracy200: 0.3164 - 58s/epoch - 15ms/step
Epoch 8/50
3903/3903 - 58s - loss: 3.1864 - accuracy200: 0.4262 - val_loss: 3.6993 - val_accuracy200: 0.3161 - 58s/epoch - 15ms/step
Epoch 9/50
3903/3903 - 58s - loss: 3.1842 - accuracy200: 0.4272 - val_loss: 3.7541 - val_accuracy200: 0.3167 - 58s/epoch - 15ms/step
Epoch 10/50
3903/3903 - 58s - loss: 3.1819 - accuracy200: 0.4283 - val_loss: 3.8009 - val_accuracy200: 0.3169 - 58s/epoch - 15ms/step
Epoch 11/50
3903/3903 - 57s - loss: 3.1793 - accuracy200: 0.4295 - val_loss: 3.8527 - val_accuracy200: 0.3168 - 57s/epoch - 15ms/step
testing model: results/AAPL/W8/deepLOB_L1/h200
Evaluating performance on  test set...
10609/10609 - 57s - 57s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1962725
{'0': {'precision': 0.3415137953081198, 'recall': 0.05491905785818443, 'f1-score': 0.09462190499144518, 'support': 1011525}, '1': {'precision': 0.2529337704581058, 'recall': 0.9049830498735922, 'f1-score': 0.39536652544633133, 'support': 696160}, '2': {'precision': 0.3722908225609364, 'recall': 0.022971298525690055, 'f1-score': 0.043272568592767846, 'support': 1007997}, 'accuracy': 0.2609731183548, 'macro avg': {'precision': 0.32224612944238734, 'recall': 0.3276244687524889, 'f1-score': 0.17775366634351478, 'support': 2715682}, 'weighted avg': {'precision': 0.3302301770642207, 'recall': 0.2609731183548, 'f1-score': 0.15265756525432425, 'support': 2715682}}
[[ 55552 933051  22922]
 [ 50028 630013  16119]
 [ 57084 927758  23155]]
Evaluating performance on  train set...
3903/3903 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1751955
{'0': {'precision': 0.3148705356693603, 'recall': 0.09352926582111994, 'f1-score': 0.14421951197027943, 'support': 334537}, '1': {'precision': 0.32118616769736524, 'recall': 0.8627926885772059, 'f1-score': 0.4681115303585356, 'support': 325901}, '2': {'precision': 0.3223982834034827, 'recall': 0.023072720561092653, 'f1-score': 0.043063559123516296, 'support': 338625}, 'accuracy': 0.32058739038479056, 'macro avg': {'precision': 0.3194849955900694, 'recall': 0.3264648916531395, 'f1-score': 0.21846486715077715, 'support': 999063}, 'weighted avg': {'precision': 0.31948221117933917, 'recall': 0.32058739038479056, 'f1-score': 0.2155891835045229, 'support': 999063}}
[[ 31289 295674   7574]
 [ 35869 281185   8847]
 [ 32213 298599   7813]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1771028
{'0': {'precision': 0.3399050474762619, 'recall': 0.134858083256501, 'f1-score': 0.1931023713703696, 'support': 100869}, '1': {'precision': 0.31520863805939486, 'recall': 0.83011069152447, 'f1-score': 0.4569172173301927, 'support': 92419}, '2': {'precision': 0.3459078590785908, 'recall': 0.03212038854496955, 'f1-score': 0.05878235239937367, 'support': 99345}, 'accuracy': 0.3195538438932041, 'macro avg': {'precision': 0.3336738482047492, 'recall': 0.33236305444198017, 'f1-score': 0.23626731369997866, 'support': 292633}, 'weighted avg': {'precision': 0.3341433318007774, 'recall': 0.3195538438932041, 'f1-score': 0.23082020211429563, 'support': 292633}}
[[13603 84121  3145]
 [12812 76718  2889]
 [13605 82549  3191]]
training model: results/AAPL/W8/deepLOB_L1/h300
Epoch 1/50
3903/3903 - 66s - loss: 3.2408 - accuracy300: 0.3994 - val_loss: 3.4880 - val_accuracy300: 0.3294 - 66s/epoch - 17ms/step
Epoch 2/50
3903/3903 - 59s - loss: 3.2152 - accuracy300: 0.4119 - val_loss: 3.5342 - val_accuracy300: 0.3277 - 59s/epoch - 15ms/step
Epoch 3/50
3903/3903 - 58s - loss: 3.2030 - accuracy300: 0.4193 - val_loss: 3.5045 - val_accuracy300: 0.3298 - 58s/epoch - 15ms/step
Epoch 4/50
3903/3903 - 61s - loss: 3.1946 - accuracy300: 0.4236 - val_loss: 3.5564 - val_accuracy300: 0.3328 - 61s/epoch - 16ms/step
Epoch 5/50
3903/3903 - 58s - loss: 3.1895 - accuracy300: 0.4260 - val_loss: 3.6089 - val_accuracy300: 0.3382 - 58s/epoch - 15ms/step
Epoch 6/50
3903/3903 - 58s - loss: 3.1861 - accuracy300: 0.4275 - val_loss: 3.6488 - val_accuracy300: 0.3415 - 58s/epoch - 15ms/step
Epoch 7/50
3903/3903 - 59s - loss: 3.1818 - accuracy300: 0.4291 - val_loss: 3.7804 - val_accuracy300: 0.3390 - 59s/epoch - 15ms/step
Epoch 8/50
3903/3903 - 58s - loss: 3.1788 - accuracy300: 0.4299 - val_loss: 3.7984 - val_accuracy300: 0.3438 - 58s/epoch - 15ms/step
Epoch 9/50
3903/3903 - 60s - loss: 3.1756 - accuracy300: 0.4313 - val_loss: 3.8958 - val_accuracy300: 0.3419 - 60s/epoch - 15ms/step
Epoch 10/50
3903/3903 - 59s - loss: 3.1732 - accuracy300: 0.4322 - val_loss: 4.0463 - val_accuracy300: 0.3393 - 59s/epoch - 15ms/step
Epoch 11/50
3903/3903 - 59s - loss: 3.1712 - accuracy300: 0.4331 - val_loss: 3.8741 - val_accuracy300: 0.3434 - 59s/epoch - 15ms/step
testing model: results/AAPL/W8/deepLOB_L1/h300
Evaluating performance on  test set...
10609/10609 - 66s - 66s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1493205
{'0': {'precision': 0.3533401013840322, 'recall': 0.20056422634246288, 'f1-score': 0.2558831210463063, 'support': 1030792}, '1': {'precision': 0.230969893008211, 'recall': 0.6957216477846764, 'f1-score': 0.34680526902152187, 'support': 667126}, '2': {'precision': 0.3622976544433432, 'recall': 0.04310134766016483, 'f1-score': 0.07703776812276308, 'support': 1017764}, 'accuracy': 0.26319024097814103, 'macro avg': {'precision': 0.31553588294519547, 'recall': 0.31312907392910133, 'f1-score': 0.22657538606353042, 'support': 2715682}, 'weighted avg': {'precision': 0.32663606438666964, 'recall': 0.26319024097814103, 'f1-score': 0.21119238299863966, 'support': 2715682}}
[[206740 779350  44702]
 [170481 464134  32511]
 [207881 766016  43867]]
Evaluating performance on  train set...
3903/3903 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1603136
{'0': {'precision': 0.3119542868675656, 'recall': 0.3722780027396848, 'f1-score': 0.33945699618414915, 'support': 332155}, '1': {'precision': 0.30069686411149826, 'recall': 0.47610617859513726, 'f1-score': 0.36859699825283343, 'support': 329897}, '2': {'precision': 0.3366153003559959, 'recall': 0.08024367157155107, 'f1-score': 0.12959417657643843, 'support': 337011}, 'accuracy': 0.3080516443907942, 'macro avg': {'precision': 0.3164221504450199, 'recall': 0.3095426176354577, 'f1-score': 0.27921605700447366, 'support': 999063}, 'weighted avg': {'precision': 0.3165558413459028, 'recall': 0.3080516443907942, 'f1-score': 0.2782868002742201, 'support': 999063}}
[[123654 182415  26086]
 [145622 157066  27209]
 [127109 182859  27043]]
Evaluating performance on  val set...
1144/1144 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1652917
{'0': {'precision': 0.3425013014465776, 'recall': 0.429462961131441, 'f1-score': 0.38108402225615645, 'support': 101110}, '1': {'precision': 0.3111619415962536, 'recall': 0.4704720758463435, 'f1-score': 0.37458196885070744, 'support': 91659}, '2': {'precision': 0.35721097417840375, 'recall': 0.09752263077785789, 'f1-score': 0.1532156566610031, 'support': 99864}, 'accuracy': 0.32902987701318714, 'macro avg': {'precision': 0.33695807240707837, 'recall': 0.3324858892518808, 'f1-score': 0.30296054925595567, 'support': 292633}, 'weighted avg': {'precision': 0.33770496054575727, 'recall': 0.32902987701318714, 'f1-score': 0.3012850311140623, 'support': 292633}}
[[43423 48088  9599]
 [40610 43123  7926]
 [42749 47376  9739]]
training model: results/AAPL/W8/deepLOB_L1/h500
Epoch 1/50
3903/3903 - 62s - loss: 3.2275 - accuracy500: 0.4094 - val_loss: 3.6085 - val_accuracy500: 0.3173 - 62s/epoch - 16ms/step
Epoch 2/50
3903/3903 - 58s - loss: 3.1940 - accuracy500: 0.4239 - val_loss: 3.5642 - val_accuracy500: 0.3236 - 58s/epoch - 15ms/step
Epoch 3/50
3903/3903 - 58s - loss: 3.1765 - accuracy500: 0.4326 - val_loss: 3.6104 - val_accuracy500: 0.3242 - 58s/epoch - 15ms/step
Epoch 4/50
3903/3903 - 61s - loss: 3.1663 - accuracy500: 0.4381 - val_loss: 3.5411 - val_accuracy500: 0.3303 - 61s/epoch - 16ms/step
Epoch 5/50
3903/3903 - 61s - loss: 3.1597 - accuracy500: 0.4403 - val_loss: 3.5234 - val_accuracy500: 0.3304 - 61s/epoch - 16ms/step
Epoch 6/50
3903/3903 - 61s - loss: 3.1553 - accuracy500: 0.4428 - val_loss: 3.5460 - val_accuracy500: 0.3292 - 61s/epoch - 16ms/step
Epoch 7/50
3903/3903 - 59s - loss: 3.1507 - accuracy500: 0.4437 - val_loss: 3.5507 - val_accuracy500: 0.3293 - 59s/epoch - 15ms/step
Epoch 8/50
3903/3903 - 59s - loss: 3.1459 - accuracy500: 0.4457 - val_loss: 3.7243 - val_accuracy500: 0.3356 - 59s/epoch - 15ms/step
Epoch 9/50
3903/3903 - 60s - loss: 3.1423 - accuracy500: 0.4467 - val_loss: 3.8906 - val_accuracy500: 0.3381 - 60s/epoch - 15ms/step
Epoch 10/50
3903/3903 - 62s - loss: 3.1386 - accuracy500: 0.4477 - val_loss: 3.9112 - val_accuracy500: 0.3379 - 62s/epoch - 16ms/step
Epoch 11/50
3903/3903 - 62s - loss: 3.1359 - accuracy500: 0.4483 - val_loss: 3.9569 - val_accuracy500: 0.3379 - 62s/epoch - 16ms/step
Epoch 12/50
3903/3903 - 63s - loss: 3.1324 - accuracy500: 0.4503 - val_loss: 3.9615 - val_accuracy500: 0.3384 - 63s/epoch - 16ms/step
Epoch 13/50
3903/3903 - 62s - loss: 3.1290 - accuracy500: 0.4508 - val_loss: 3.8480 - val_accuracy500: 0.3378 - 62s/epoch - 16ms/step
Epoch 14/50
3903/3903 - 60s - loss: 3.1274 - accuracy500: 0.4516 - val_loss: 4.1367 - val_accuracy500: 0.3381 - 60s/epoch - 16ms/step
Epoch 15/50
3903/3903 - 61s - loss: 3.1233 - accuracy500: 0.4531 - val_loss: 4.1494 - val_accuracy500: 0.3393 - 61s/epoch - 16ms/step
testing model: results/AAPL/W8/deepLOB_L1/h500
Evaluating performance on  test set...
10609/10609 - 66s - 66s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1374975
{'0': {'precision': 0.37119364643123415, 'recall': 0.27293203473652017, 'f1-score': 0.31456791791960903, 'support': 1023361}, '1': {'precision': 0.2701501596761944, 'recall': 0.3926969455574095, 'f1-score': 0.32009536349804296, 'support': 676621}, '2': {'precision': 0.3795563812304143, 'recall': 0.366092350103377, 'f1-score': 0.37270280699820085, 'support': 1015700}, 'accuracy': 0.3376150079427562, 'macro avg': {'precision': 0.3403000624459476, 'recall': 0.3439071101324356, 'f1-score': 0.3357886961386176, 'support': 2715682}, 'weighted avg': {'precision': 0.34914610356128306, 'recall': 0.3376150079427562, 'f1-score': 0.33768829526565003, 'support': 2715682}}
[[279308 360229 383824]
 [186908 265707 224006]
 [286243 357617 371840]]
Evaluating performance on  train set...
3903/3903 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1695594
{'0': {'precision': 0.33530017083098884, 'recall': 0.40038740333832723, 'f1-score': 0.36496461120606055, 'support': 330405}, '1': {'precision': 0.34982177785279545, 'recall': 0.5349291275461248, 'f1-score': 0.42301139740355787, 'support': 329324}, '2': {'precision': 0.3682036141713561, 'recall': 0.10952336046491068, 'f1-score': 0.16882821904740272, 'support': 339334}, 'accuracy': 0.34594414966823916, 'macro avg': {'precision': 0.35110852095171347, 'recall': 0.34827996378312087, 'f1-score': 0.3189347425523404, 'support': 999063}, 'weighted avg': {'precision': 0.35126269847269875, 'recall': 0.34594414966823916, 'f1-score': 0.3174805719822465, 'support': 999063}}
[[132290 161252  36863]
 [126251 176165  26908]
 [136001 166168  37165]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1786895
{'0': {'precision': 0.3449005910800645, 'recall': 0.3207087109894173, 'f1-score': 0.3323650184601204, 'support': 100069}, '1': {'precision': 0.31874135001631543, 'recall': 0.6100068909083078, 'f1-score': 0.41870210108564715, 'support': 92876}, '2': {'precision': 0.348078948573522, 'recall': 0.07624789342749379, 'f1-score': 0.12509360213947748, 'support': 99688}, 'accuracy': 0.32924858098710674, 'macro avg': {'precision': 0.33724029655663396, 'recall': 0.3356544984417396, 'f1-score': 0.2920535738950817, 'support': 292633}, 'weighted avg': {'precision': 0.3376808941517312, 'recall': 0.32924858098710674, 'f1-score': 0.28915789532553265, 'support': 292633}}
[[32093 60314  7662]
 [29647 56655  6574]
 [31310 60777  7601]]
training model: results/AAPL/W8/deepLOB_L1/h1000
Epoch 1/50
3903/3903 - 66s - loss: 3.1915 - accuracy1000: 0.4274 - val_loss: 3.6229 - val_accuracy1000: 0.3291 - 66s/epoch - 17ms/step
Epoch 2/50
3903/3903 - 59s - loss: 3.1335 - accuracy1000: 0.4485 - val_loss: 3.7312 - val_accuracy1000: 0.3353 - 59s/epoch - 15ms/step
Epoch 3/50
3903/3903 - 59s - loss: 3.1038 - accuracy1000: 0.4624 - val_loss: 3.9046 - val_accuracy1000: 0.3376 - 59s/epoch - 15ms/step
Epoch 4/50
3903/3903 - 58s - loss: 3.0882 - accuracy1000: 0.4675 - val_loss: 4.0203 - val_accuracy1000: 0.3391 - 58s/epoch - 15ms/step
Epoch 5/50
3903/3903 - 58s - loss: 3.0767 - accuracy1000: 0.4714 - val_loss: 4.0792 - val_accuracy1000: 0.3401 - 58s/epoch - 15ms/step
Epoch 6/50
3903/3903 - 59s - loss: 3.0674 - accuracy1000: 0.4737 - val_loss: 4.1160 - val_accuracy1000: 0.3425 - 59s/epoch - 15ms/step
Epoch 7/50
3903/3903 - 59s - loss: 3.0605 - accuracy1000: 0.4766 - val_loss: 4.1026 - val_accuracy1000: 0.3429 - 59s/epoch - 15ms/step
Epoch 8/50
3903/3903 - 59s - loss: 3.0538 - accuracy1000: 0.4785 - val_loss: 4.2154 - val_accuracy1000: 0.3434 - 59s/epoch - 15ms/step
Epoch 9/50
3903/3903 - 58s - loss: 3.0469 - accuracy1000: 0.4806 - val_loss: 4.2068 - val_accuracy1000: 0.3440 - 58s/epoch - 15ms/step
Epoch 10/50
3903/3903 - 58s - loss: 3.0404 - accuracy1000: 0.4821 - val_loss: 4.1215 - val_accuracy1000: 0.3430 - 58s/epoch - 15ms/step
Epoch 11/50
3903/3903 - 58s - loss: 3.0361 - accuracy1000: 0.4835 - val_loss: 4.2085 - val_accuracy1000: 0.3445 - 58s/epoch - 15ms/step
testing model: results/AAPL/W8/deepLOB_L1/h1000
Evaluating performance on  test set...
10609/10609 - 54s - 54s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2096617
{'0': {'precision': 0.33979918980043244, 'recall': 0.24509301095775543, 'f1-score': 0.2847786530278091, 'support': 1004129}, '1': {'precision': 0.24764118097184712, 'recall': 0.6846272313615681, 'f1-score': 0.3637190617142351, 'support': 714250}, '2': {'precision': 0.36542695626301697, 'recall': 0.006157607066257697, 'f1-score': 0.01211113609201387, 'support': 997303}, 'accuracy': 0.2729483790812032, 'macro avg': {'precision': 0.31762244234509884, 'recall': 0.3119592831285271, 'f1-score': 0.22020295027801937, 'support': 2715682}, 'weighted avg': {'precision': 0.3249722662396539, 'recall': 0.2729483790812032, 'f1-score': 0.20540671414161416, 'support': 2715682}}
[[246105 751759   6265]
 [220856 488995   4399]
 [257305 733857   6141]]
Evaluating performance on  train set...
3903/3903 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2224762
{'0': {'precision': 0.31505631510650045, 'recall': 0.541189582608535, 'f1-score': 0.39826221912578524, 'support': 324803}, '1': {'precision': 0.3103424427215122, 'recall': 0.39327506588332006, 'f1-score': 0.346921283552764, 'support': 330888}, '2': {'precision': 0.36636113657195235, 'recall': 0.023280873222044897, 'f1-score': 0.04377971039891345, 'support': 343372}, 'accuracy': 0.31419840390445847, 'macro avg': {'precision': 0.330586631466655, 'recall': 0.31924850723796666, 'f1-score': 0.26298773769248757, 'support': 999063}, 'weighted avg': {'precision': 0.3311282498598755, 'recall': 0.31419840390445847, 'f1-score': 0.25942466085723836, 'support': 999063}}
[[175780 142103   6920]
 [193852 130130   6906]
 [188300 147078   7994]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2168722
{'0': {'precision': 0.33930285974972546, 'recall': 0.645634399919249, 'f1-score': 0.44483157905717646, 'support': 99070}, '1': {'precision': 0.3054154790616093, 'recall': 0.3138531854172478, 'f1-score': 0.3095768492012678, 'support': 93206}, '2': {'precision': 0.37270655953951315, 'recall': 0.030969439102404416, 'f1-score': 0.0571870170015456, 'support': 100357}, 'accuracy': 0.3291631497472944, 'macro avg': {'precision': 0.33914163278361603, 'recall': 0.33015234147963374, 'f1-score': 0.2705318150866633, 'support': 292633}, 'weighted avg': {'precision': 0.3399650813562673, 'recall': 0.3291631497472944, 'f1-score': 0.26881111087632614, 'support': 292633}}
[[63963 32172  2935]
 [61657 29253  2296]
 [62893 34356  3108]]
training model: results/AAPL/W8/deepOF_L1/h10
Epoch 1/50
3903/3903 - 57s - loss: 3.2210 - accuracy10: 0.4131 - val_loss: 3.4451 - val_accuracy10: 0.3424 - 57s/epoch - 14ms/step
Epoch 2/50
3903/3903 - 52s - loss: 3.2129 - accuracy10: 0.4173 - val_loss: 3.4198 - val_accuracy10: 0.3436 - 52s/epoch - 13ms/step
Epoch 3/50
3903/3903 - 52s - loss: 3.2095 - accuracy10: 0.4189 - val_loss: 3.4097 - val_accuracy10: 0.3433 - 52s/epoch - 13ms/step
Epoch 4/50
3903/3903 - 51s - loss: 3.2054 - accuracy10: 0.4207 - val_loss: 3.4106 - val_accuracy10: 0.3446 - 51s/epoch - 13ms/step
Epoch 5/50
3903/3903 - 53s - loss: 3.2028 - accuracy10: 0.4214 - val_loss: 3.4154 - val_accuracy10: 0.3439 - 53s/epoch - 14ms/step
Epoch 6/50
3903/3903 - 53s - loss: 3.1998 - accuracy10: 0.4231 - val_loss: 3.4199 - val_accuracy10: 0.3439 - 53s/epoch - 14ms/step
Epoch 7/50
3903/3903 - 52s - loss: 3.1963 - accuracy10: 0.4246 - val_loss: 3.4291 - val_accuracy10: 0.3446 - 52s/epoch - 13ms/step
Epoch 8/50
3903/3903 - 52s - loss: 3.1935 - accuracy10: 0.4258 - val_loss: 3.4318 - val_accuracy10: 0.3454 - 52s/epoch - 13ms/step
Epoch 9/50
3903/3903 - 52s - loss: 3.1911 - accuracy10: 0.4271 - val_loss: 3.4417 - val_accuracy10: 0.3456 - 52s/epoch - 13ms/step
Epoch 10/50
3903/3903 - 52s - loss: 3.1890 - accuracy10: 0.4281 - val_loss: 3.4404 - val_accuracy10: 0.3475 - 52s/epoch - 13ms/step
Epoch 11/50
3903/3903 - 54s - loss: 3.1861 - accuracy10: 0.4289 - val_loss: 3.4486 - val_accuracy10: 0.3470 - 54s/epoch - 14ms/step
Epoch 12/50
3903/3903 - 55s - loss: 3.1838 - accuracy10: 0.4299 - val_loss: 3.4493 - val_accuracy10: 0.3484 - 55s/epoch - 14ms/step
Epoch 13/50
3903/3903 - 53s - loss: 3.1821 - accuracy10: 0.4305 - val_loss: 3.4585 - val_accuracy10: 0.3486 - 53s/epoch - 13ms/step
testing model: results/AAPL/W8/deepOF_L1/h10
Evaluating performance on  test set...
10609/10609 - 58s - 58s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1078829
{'0': {'precision': 0.5825637949135475, 'recall': 0.09334233533208221, 'f1-score': 0.16090360085176136, 'support': 873880}, '1': {'precision': 0.35844033983286683, 'recall': 0.9364723817461617, 'f1-score': 0.5184434026532228, 'support': 940646}, '2': {'precision': 0.5237558955773643, 'recall': 0.06863888515909099, 'f1-score': 0.12137183492143228, 'support': 901151}, 'accuracy': 0.37718513652396807, 'macro avg': {'precision': 0.48825334344125954, 'recall': 0.3661512007457783, 'f1-score': 0.26690627947547213, 'support': 2715677}, 'weighted avg': {'precision': 0.4854183579479132, 'recall': 0.37718513652396807, 'f1-score': 0.27162895368475864, 'support': 2715677}}
[[ 81570 764446  27864]
 [ 31378 880889  28379]
 [ 27071 812226  61854]]
Evaluating performance on  train set...
3903/3903 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1297127
{'0': {'precision': 0.48121515027879774, 'recall': 0.0843753446461732, 'f1-score': 0.14357629598821242, 'support': 335489}, '1': {'precision': 0.3358990188955108, 'recall': 0.9229537361099629, 'f1-score': 0.4925425205014302, 'support': 326583}, '2': {'precision': 0.5020055034746513, 'recall': 0.06388023383483189, 'f1-score': 0.113338177070171, 'support': 336990}, 'accuracy': 0.35158478652976494, 'macro avg': {'precision': 0.43970655754965327, 'recall': 0.35706977153032265, 'f1-score': 0.24981899785327122, 'support': 999062}, 'weighted avg': {'precision': 0.44072553400665715, 'recall': 0.35158478652976494, 'f1-score': 0.2474502225373249, 'support': 999062}}
[[ 28307 296055  11127]
 [ 14934 301421  10228]
 [ 15583 299880  21527]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1405901
{'0': {'precision': 0.5036769621607167, 'recall': 0.07577113777393368, 'f1-score': 0.13172595267027423, 'support': 99431}, '1': {'precision': 0.32792830993007416, 'recall': 0.9209782030834662, 'f1-score': 0.48364681018574096, 'support': 94050}, '2': {'precision': 0.4705274043433299, 'recall': 0.06424479586896886, 'f1-score': 0.11305350962818353, 'support': 99152}, 'accuracy': 0.34350876353657994, 'macro avg': {'precision': 0.4340442254780403, 'recall': 0.353664712242123, 'f1-score': 0.24280875749473288, 'support': 292633}, 'weighted avg': {'precision': 0.4359607247609652, 'recall': 0.34350876353657994, 'f1-score': 0.23850388467664493, 'support': 292633}}
[[ 7534 88459  3438]
 [ 3702 86618  3730]
 [ 3722 89060  6370]]
training model: results/AAPL/W8/deepOF_L1/h20
Epoch 1/50
3903/3903 - 55s - loss: 3.2437 - accuracy20: 0.4016 - val_loss: 3.3937 - val_accuracy20: 0.3401 - 55s/epoch - 14ms/step
Epoch 2/50
3903/3903 - 53s - loss: 3.2341 - accuracy20: 0.4060 - val_loss: 3.3674 - val_accuracy20: 0.3411 - 53s/epoch - 14ms/step
Epoch 3/50
3903/3903 - 52s - loss: 3.2318 - accuracy20: 0.4074 - val_loss: 3.3630 - val_accuracy20: 0.3425 - 52s/epoch - 13ms/step
Epoch 4/50
3903/3903 - 52s - loss: 3.2292 - accuracy20: 0.4090 - val_loss: 3.3609 - val_accuracy20: 0.3420 - 52s/epoch - 13ms/step
Epoch 5/50
3903/3903 - 52s - loss: 3.2281 - accuracy20: 0.4093 - val_loss: 3.3552 - val_accuracy20: 0.3422 - 52s/epoch - 13ms/step
Epoch 6/50
3903/3903 - 54s - loss: 3.2261 - accuracy20: 0.4100 - val_loss: 3.3527 - val_accuracy20: 0.3428 - 54s/epoch - 14ms/step
Epoch 7/50
3903/3903 - 53s - loss: 3.2251 - accuracy20: 0.4104 - val_loss: 3.3572 - val_accuracy20: 0.3420 - 53s/epoch - 14ms/step
Epoch 8/50
3903/3903 - 53s - loss: 3.2234 - accuracy20: 0.4112 - val_loss: 3.3563 - val_accuracy20: 0.3426 - 53s/epoch - 14ms/step
Epoch 9/50
3903/3903 - 51s - loss: 3.2218 - accuracy20: 0.4122 - val_loss: 3.3530 - val_accuracy20: 0.3431 - 51s/epoch - 13ms/step
Epoch 10/50
3903/3903 - 52s - loss: 3.2209 - accuracy20: 0.4124 - val_loss: 3.3528 - val_accuracy20: 0.3435 - 52s/epoch - 13ms/step
Epoch 11/50
3903/3903 - 53s - loss: 3.2193 - accuracy20: 0.4132 - val_loss: 3.3585 - val_accuracy20: 0.3436 - 53s/epoch - 13ms/step
Epoch 12/50
3903/3903 - 51s - loss: 3.2182 - accuracy20: 0.4137 - val_loss: 3.3582 - val_accuracy20: 0.3443 - 51s/epoch - 13ms/step
Epoch 13/50
3903/3903 - 51s - loss: 3.2164 - accuracy20: 0.4146 - val_loss: 3.3565 - val_accuracy20: 0.3449 - 51s/epoch - 13ms/step
Epoch 14/50
3903/3903 - 52s - loss: 3.2155 - accuracy20: 0.4150 - val_loss: 3.3646 - val_accuracy20: 0.3448 - 52s/epoch - 13ms/step
Epoch 15/50
3903/3903 - 51s - loss: 3.2142 - accuracy20: 0.4159 - val_loss: 3.3610 - val_accuracy20: 0.3458 - 51s/epoch - 13ms/step
Epoch 16/50
3903/3903 - 51s - loss: 3.2126 - accuracy20: 0.4161 - val_loss: 3.3666 - val_accuracy20: 0.3457 - 51s/epoch - 13ms/step
testing model: results/AAPL/W8/deepOF_L1/h20
Evaluating performance on  test set...
10609/10609 - 53s - 53s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1033641
{'0': {'precision': 0.582031708749266, 'recall': 0.08303593867805982, 'f1-score': 0.14533724340175955, 'support': 895275}, '1': {'precision': 0.33663478037394406, 'recall': 0.924584402088253, 'f1-score': 0.4935657044583249, 'support': 893953}, '2': {'precision': 0.515154712998907, 'recall': 0.07376876654840148, 'f1-score': 0.12905692871588892, 'support': 926449}, 'accuracy': 0.3568973777072899, 'macro avg': {'precision': 0.4779404007073724, 'recall': 0.36046303577157146, 'f1-score': 0.2559866255253245, 'support': 2715677}, 'weighted avg': {'precision': 0.4784363820046537, 'recall': 0.3568973777072899, 'f1-score': 0.2544139105409258, 'support': 2715677}}
[[ 74340 792885  28050]
 [ 31146 826535  36272]
 [ 22239 835867  68343]]
Evaluating performance on  train set...
3903/3903 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1150323
{'0': {'precision': 0.4661327672713238, 'recall': 0.07230433975705981, 'f1-score': 0.12518981896582998, 'support': 334074}, '1': {'precision': 0.334294155160199, 'recall': 0.9193655753500856, 'f1-score': 0.4903061505691489, 'support': 328991}, '2': {'precision': 0.4872471208874026, 'recall': 0.06157495453828457, 'f1-score': 0.10933313604151583, 'support': 335997}, 'accuracy': 0.3476330798288795, 'macro avg': {'precision': 0.42922468110630846, 'recall': 0.3510816232151433, 'f1-score': 0.24160970185883157, 'support': 999062}, 'weighted avg': {'precision': 0.4298193479188618, 'recall': 0.3476330798288795, 'f1-score': 0.24008978429129196, 'support': 999062}}
[[ 24155 299810  10109]
 [ 14865 302463  11663]
 [ 12800 302508  20689]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1190016
{'0': {'precision': 0.4811868415394539, 'recall': 0.06787234257639935, 'f1-score': 0.11896450909864097, 'support': 98921}, '1': {'precision': 0.3294313371913173, 'recall': 0.9157595587155771, 'f1-score': 0.48455204252627376, 'support': 95358}, '2': {'precision': 0.4658873695044846, 'recall': 0.06443052646562418, 'f1-score': 0.11320518775233128, 'support': 98354}, 'accuracy': 0.34300984509607596, 'macro avg': {'precision': 0.4255018494117519, 'recall': 0.3493541425858669, 'f1-score': 0.23890724645908198, 'support': 292633}, 'weighted avg': {'precision': 0.4265933211362288, 'recall': 0.34300984509607596, 'f1-score': 0.23615991672832476, 'support': 292633}}
[[ 6714 88945  3262]
 [ 4030 87325  4003]
 [ 3209 88808  6337]]
training model: results/AAPL/W8/deepOF_L1/h30
Epoch 1/50
3903/3903 - 53s - loss: 3.2527 - accuracy30: 0.3958 - val_loss: 3.3735 - val_accuracy30: 0.3322 - 53s/epoch - 14ms/step
Epoch 2/50
3903/3903 - 51s - loss: 3.2436 - accuracy30: 0.4007 - val_loss: 3.3417 - val_accuracy30: 0.3350 - 51s/epoch - 13ms/step
Epoch 3/50
3903/3903 - 51s - loss: 3.2413 - accuracy30: 0.4013 - val_loss: 3.3305 - val_accuracy30: 0.3364 - 51s/epoch - 13ms/step
Epoch 4/50
3903/3903 - 51s - loss: 3.2396 - accuracy30: 0.4022 - val_loss: 3.3268 - val_accuracy30: 0.3371 - 51s/epoch - 13ms/step
Epoch 5/50
3903/3903 - 52s - loss: 3.2379 - accuracy30: 0.4034 - val_loss: 3.3258 - val_accuracy30: 0.3375 - 52s/epoch - 13ms/step
Epoch 6/50
3903/3903 - 52s - loss: 3.2363 - accuracy30: 0.4040 - val_loss: 3.3264 - val_accuracy30: 0.3374 - 52s/epoch - 13ms/step
Epoch 7/50
3903/3903 - 51s - loss: 3.2353 - accuracy30: 0.4045 - val_loss: 3.3377 - val_accuracy30: 0.3359 - 51s/epoch - 13ms/step
Epoch 8/50
3903/3903 - 52s - loss: 3.2343 - accuracy30: 0.4048 - val_loss: 3.3330 - val_accuracy30: 0.3376 - 52s/epoch - 13ms/step
Epoch 9/50
3903/3903 - 52s - loss: 3.2330 - accuracy30: 0.4055 - val_loss: 3.3281 - val_accuracy30: 0.3384 - 52s/epoch - 13ms/step
Epoch 10/50
3903/3903 - 58s - loss: 3.2318 - accuracy30: 0.4060 - val_loss: 3.3347 - val_accuracy30: 0.3382 - 58s/epoch - 15ms/step
Epoch 11/50
3903/3903 - 51s - loss: 3.2307 - accuracy30: 0.4067 - val_loss: 3.3296 - val_accuracy30: 0.3384 - 51s/epoch - 13ms/step
Epoch 12/50
3903/3903 - 52s - loss: 3.2296 - accuracy30: 0.4071 - val_loss: 3.3220 - val_accuracy30: 0.3392 - 52s/epoch - 13ms/step
Epoch 13/50
3903/3903 - 51s - loss: 3.2287 - accuracy30: 0.4076 - val_loss: 3.3238 - val_accuracy30: 0.3390 - 51s/epoch - 13ms/step
Epoch 14/50
3903/3903 - 54s - loss: 3.2278 - accuracy30: 0.4078 - val_loss: 3.3213 - val_accuracy30: 0.3388 - 54s/epoch - 14ms/step
Epoch 15/50
3903/3903 - 55s - loss: 3.2267 - accuracy30: 0.4086 - val_loss: 3.3249 - val_accuracy30: 0.3393 - 55s/epoch - 14ms/step
Epoch 16/50
3903/3903 - 54s - loss: 3.2258 - accuracy30: 0.4091 - val_loss: 3.3238 - val_accuracy30: 0.3390 - 54s/epoch - 14ms/step
Epoch 17/50
3903/3903 - 53s - loss: 3.2249 - accuracy30: 0.4095 - val_loss: 3.3236 - val_accuracy30: 0.3400 - 53s/epoch - 14ms/step
Epoch 18/50
3903/3903 - 52s - loss: 3.2240 - accuracy30: 0.4107 - val_loss: 3.3249 - val_accuracy30: 0.3401 - 52s/epoch - 13ms/step
Epoch 19/50
3903/3903 - 54s - loss: 3.2230 - accuracy30: 0.4106 - val_loss: 3.3258 - val_accuracy30: 0.3398 - 54s/epoch - 14ms/step
Epoch 20/50
3903/3903 - 54s - loss: 3.2222 - accuracy30: 0.4106 - val_loss: 3.3287 - val_accuracy30: 0.3406 - 54s/epoch - 14ms/step
Epoch 21/50
3903/3903 - 53s - loss: 3.2217 - accuracy30: 0.4109 - val_loss: 3.3307 - val_accuracy30: 0.3403 - 53s/epoch - 14ms/step
Epoch 22/50
3903/3903 - 56s - loss: 3.2205 - accuracy30: 0.4119 - val_loss: 3.3314 - val_accuracy30: 0.3406 - 56s/epoch - 14ms/step
Epoch 23/50
3903/3903 - 55s - loss: 3.2196 - accuracy30: 0.4124 - val_loss: 3.3354 - val_accuracy30: 0.3402 - 55s/epoch - 14ms/step
Epoch 24/50
3903/3903 - 51s - loss: 3.2185 - accuracy30: 0.4131 - val_loss: 3.3376 - val_accuracy30: 0.3387 - 51s/epoch - 13ms/step
testing model: results/AAPL/W8/deepOF_L1/h30
Evaluating performance on  test set...
10609/10609 - 53s - 53s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1014508
{'0': {'precision': 0.565510058736589, 'recall': 0.08004292310693924, 'f1-score': 0.1402366015517066, 'support': 922580}, '1': {'precision': 0.3117541802153485, 'recall': 0.8987176823402387, 'f1-score': 0.4629252491858773, 'support': 832633}, '2': {'precision': 0.5084659549023534, 'recall': 0.09783188125739226, 'f1-score': 0.16409156674056524, 'support': 960464}, 'accuracy': 0.33734203294427134, 'macro avg': {'precision': 0.46191006461809697, 'recall': 0.35886416223485673, 'f1-score': 0.255751139159383, 'support': 2715677}, 'weighted avg': {'precision': 0.46753289630312533, 'recall': 0.33734203294427134, 'f1-score': 0.2476105830784988, 'support': 2715677}}
[[ 73846 809415  39319]
 [ 32815 748302  51516]
 [ 23922 842578  93964]]
Evaluating performance on  train set...
3903/3903 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1052748
{'0': {'precision': 0.4649057880601434, 'recall': 0.06574457586315176, 'f1-score': 0.11519839024083507, 'support': 334385}, '1': {'precision': 0.3322506766138317, 'recall': 0.9046052431171141, 'f1-score': 0.4859995401234138, 'support': 328278}, '2': {'precision': 0.46938916290139, 'recall': 0.08090987190806156, 'f1-score': 0.1380275619001737, 'support': 336399}, 'accuracy': 0.3464890066882736, 'macro avg': {'precision': 0.422181875858455, 'recall': 0.3504198969627758, 'f1-score': 0.2464084974214742, 'support': 999062}, 'weighted avg': {'precision': 0.42282676607536984, 'recall': 0.3464890066882736, 'f1-score': 0.24472545702766416, 'support': 999062}}
[[ 21984 298777  13624]
 [ 14172 296962  17144]
 [ 11131 298050  27218]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1089562
{'0': {'precision': 0.47373371924746743, 'recall': 0.0655315997037215, 'f1-score': 0.11513638042312224, 'support': 99906}, '1': {'precision': 0.3240920092208674, 'recall': 0.8979468213989671, 'f1-score': 0.4762817387285062, 'support': 94098}, '2': {'precision': 0.4517127071823204, 'recall': 0.08289651116811486, 'f1-score': 0.14008515450316547, 'support': 98629}, 'accuracy': 0.3390526700679691, 'macro avg': {'precision': 0.4165128118835517, 'recall': 0.3487916440902678, 'f1-score': 0.24383442455159798, 'support': 292633}, 'weighted avg': {'precision': 0.4181935169153436, 'recall': 0.3390526700679691, 'f1-score': 0.239673697009292, 'support': 292633}}
[[ 6547 88953  4406]
 [ 4085 84495  5518]
 [ 3188 87265  8176]]
training model: results/AAPL/W8/deepOF_L1/h50
Epoch 1/50
3903/3903 - 57s - loss: 3.2440 - accuracy50: 0.3968 - val_loss: 3.5129 - val_accuracy50: 0.3397 - 57s/epoch - 15ms/step
Epoch 2/50
3903/3903 - 55s - loss: 3.2399 - accuracy50: 0.3995 - val_loss: 3.4595 - val_accuracy50: 0.3396 - 55s/epoch - 14ms/step
Epoch 3/50
3903/3903 - 56s - loss: 3.2395 - accuracy50: 0.4003 - val_loss: 3.4609 - val_accuracy50: 0.3397 - 56s/epoch - 14ms/step
Epoch 4/50
3903/3903 - 55s - loss: 3.2381 - accuracy50: 0.4011 - val_loss: 3.4415 - val_accuracy50: 0.3395 - 55s/epoch - 14ms/step
Epoch 5/50
3903/3903 - 53s - loss: 3.2369 - accuracy50: 0.4020 - val_loss: 3.4434 - val_accuracy50: 0.3391 - 53s/epoch - 14ms/step
Epoch 6/50
3903/3903 - 54s - loss: 3.2362 - accuracy50: 0.4023 - val_loss: 3.4256 - val_accuracy50: 0.3395 - 54s/epoch - 14ms/step
Epoch 7/50
3903/3903 - 56s - loss: 3.2346 - accuracy50: 0.4033 - val_loss: 3.4505 - val_accuracy50: 0.3394 - 56s/epoch - 14ms/step
Epoch 8/50
3903/3903 - 56s - loss: 3.2333 - accuracy50: 0.4036 - val_loss: 3.4608 - val_accuracy50: 0.3396 - 56s/epoch - 14ms/step
Epoch 9/50
3903/3903 - 53s - loss: 3.2321 - accuracy50: 0.4047 - val_loss: 3.4732 - val_accuracy50: 0.3394 - 53s/epoch - 14ms/step
Epoch 10/50
3903/3903 - 55s - loss: 3.2310 - accuracy50: 0.4051 - val_loss: 3.4793 - val_accuracy50: 0.3396 - 55s/epoch - 14ms/step
Epoch 11/50
3903/3903 - 54s - loss: 3.2294 - accuracy50: 0.4062 - val_loss: 3.5242 - val_accuracy50: 0.3391 - 54s/epoch - 14ms/step
Epoch 12/50
3903/3903 - 56s - loss: 3.2286 - accuracy50: 0.4068 - val_loss: 3.5223 - val_accuracy50: 0.3393 - 56s/epoch - 14ms/step
Epoch 13/50
3903/3903 - 53s - loss: 3.2277 - accuracy50: 0.4073 - val_loss: 3.4848 - val_accuracy50: 0.3393 - 53s/epoch - 14ms/step
Epoch 14/50
3903/3903 - 53s - loss: 3.2267 - accuracy50: 0.4079 - val_loss: 3.5267 - val_accuracy50: 0.3390 - 53s/epoch - 13ms/step
Epoch 15/50
3903/3903 - 53s - loss: 3.2256 - accuracy50: 0.4082 - val_loss: 3.5370 - val_accuracy50: 0.3392 - 53s/epoch - 14ms/step
Epoch 16/50
3903/3903 - 57s - loss: 3.2239 - accuracy50: 0.4097 - val_loss: 3.5425 - val_accuracy50: 0.3394 - 57s/epoch - 15ms/step
testing model: results/AAPL/W8/deepOF_L1/h50
Evaluating performance on  test set...
10609/10609 - 56s - 56s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1439902
{'0': {'precision': 0.5713413889906017, 'recall': 0.010444406017637905, 'f1-score': 0.02051380935216724, 'support': 896365}, '1': {'precision': 0.33097471446545296, 'recall': 0.9878427075751512, 'f1-score': 0.4958244448584474, 'support': 897157}, '2': {'precision': 0.5153283319440586, 'recall': 0.012067385634736026, 'f1-score': 0.023582541544414887, 'support': 922155}, 'accuracy': 0.3338909597864547, 'macro avg': {'precision': 0.4725481451333711, 'recall': 0.33678483307584167, 'f1-score': 0.17997359858500983, 'support': 2715677}, 'weighted avg': {'precision': 0.47291312773651517, 'recall': 0.3338909597864547, 'f1-score': 0.1785805126286062, 'support': 2715677}}
[[  9362 883006   3997]
 [  4438 886250   6469]
 [  2586 908441  11128]]
Evaluating performance on  train set...
3903/3903 - 27s - 27s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.157811
{'0': {'precision': 0.5029045643153527, 'recall': 0.00896773391579209, 'f1-score': 0.017621247851865203, 'support': 337878}, '1': {'precision': 0.32321300865789887, 'recall': 0.9886067819433628, 'f1-score': 0.4871562003574645, 'support': 322297}, '2': {'precision': 0.5055309734513275, 'recall': 0.010788256852579179, 'f1-score': 0.02112568220756445, 'support': 338887}, 'accuracy': 0.32561642820966064, 'macro avg': {'precision': 0.44388284880819295, 'recall': 0.3361209242372447, 'f1-score': 0.17530104347229805, 'support': 999062}, 'weighted avg': {'precision': 0.44582703218935116, 'recall': 0.32561642820966064, 'f1-score': 0.17028175724287098, 'support': 999062}}
[[  3030 333304   1544]
 [  1640 318625   2032]
 [  1355 333876   3656]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1486596
{'0': {'precision': 0.45604113110539846, 'recall': 0.009070735373822697, 'f1-score': 0.01778767095816789, 'support': 97787}, '1': {'precision': 0.33782117020981733, 'recall': 0.987102652358777, 'f1-score': 0.5033710881438881, 'support': 98780}, '2': {'precision': 0.4722762645914397, 'recall': 0.010107634334728208, 'f1-score': 0.019791687898738305, 'support': 96066}, 'accuracy': 0.33955158850847306, 'macro avg': {'precision': 0.4220461886355518, 'recall': 0.33542700735577596, 'f1-score': 0.18031681566693145, 'support': 292633}, 'weighted avg': {'precision': 0.4214649780269846, 'recall': 0.33955158850847306, 'f1-score': 0.18235710721798232, 'support': 292633}}
[[  887 96425   475]
 [  664 97506   610]
 [  394 94701   971]]
training model: results/AAPL/W8/deepOF_L1/h100
Epoch 1/50
3903/3903 - 58s - loss: 3.2583 - accuracy100: 0.3907 - val_loss: 3.3727 - val_accuracy100: 0.3197 - 58s/epoch - 15ms/step
Epoch 2/50
3903/3903 - 57s - loss: 3.2526 - accuracy100: 0.3936 - val_loss: 3.3373 - val_accuracy100: 0.3211 - 57s/epoch - 15ms/step
Epoch 3/50
3903/3903 - 58s - loss: 3.2515 - accuracy100: 0.3944 - val_loss: 3.3344 - val_accuracy100: 0.3207 - 58s/epoch - 15ms/step
Epoch 4/50
3903/3903 - 58s - loss: 3.2495 - accuracy100: 0.3954 - val_loss: 3.3352 - val_accuracy100: 0.3202 - 58s/epoch - 15ms/step
Epoch 5/50
3903/3903 - 60s - loss: 3.2484 - accuracy100: 0.3962 - val_loss: 3.3371 - val_accuracy100: 0.3204 - 60s/epoch - 15ms/step
Epoch 6/50
3903/3903 - 58s - loss: 3.2472 - accuracy100: 0.3965 - val_loss: 3.3357 - val_accuracy100: 0.3199 - 58s/epoch - 15ms/step
Epoch 7/50
3903/3903 - 59s - loss: 3.2459 - accuracy100: 0.3976 - val_loss: 3.3379 - val_accuracy100: 0.3200 - 59s/epoch - 15ms/step
Epoch 8/50
3903/3903 - 57s - loss: 3.2449 - accuracy100: 0.3980 - val_loss: 3.3433 - val_accuracy100: 0.3205 - 57s/epoch - 15ms/step
Epoch 9/50
3903/3903 - 59s - loss: 3.2442 - accuracy100: 0.3985 - val_loss: 3.3433 - val_accuracy100: 0.3201 - 59s/epoch - 15ms/step
Epoch 10/50
3903/3903 - 57s - loss: 3.2435 - accuracy100: 0.3992 - val_loss: 3.3395 - val_accuracy100: 0.3201 - 57s/epoch - 15ms/step
Epoch 11/50
3903/3903 - 56s - loss: 3.2424 - accuracy100: 0.3998 - val_loss: 3.3410 - val_accuracy100: 0.3207 - 56s/epoch - 14ms/step
Epoch 12/50
3903/3903 - 55s - loss: 3.2412 - accuracy100: 0.4003 - val_loss: 3.3451 - val_accuracy100: 0.3206 - 55s/epoch - 14ms/step
Epoch 13/50
3903/3903 - 55s - loss: 3.2402 - accuracy100: 0.4008 - val_loss: 3.3459 - val_accuracy100: 0.3203 - 55s/epoch - 14ms/step
testing model: results/AAPL/W8/deepOF_L1/h100
Evaluating performance on  test set...
10609/10609 - 63s - 63s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1215155
{'0': {'precision': 0.5140820833452835, 'recall': 0.036258650230301954, 'f1-score': 0.06773957046056636, 'support': 988702}, '1': {'precision': 0.2661594797675938, 'recall': 0.9489008153003402, 'f1-score': 0.41571426270210504, 'support': 720716}, '2': {'precision': 0.4762147601862022, 'recall': 0.03619247132199563, 'f1-score': 0.06727223189423082, 'support': 1006259}, 'accuracy': 0.2784410664449417, 'macro avg': {'precision': 0.4188187744330265, 'recall': 0.34045064561754596, 'f1-score': 0.1835753550189674, 'support': 2715677}, 'weighted avg': {'precision': 0.4342544300953453, 'recall': 0.2784410664449417, 'f1-score': 0.15991572567163548, 'support': 2715677}}
[[ 35849 932549  20304]
 [ 17075 683888  19753]
 [ 16810 953030  36419]]
Evaluating performance on  train set...
3903/3903 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1079923
{'0': {'precision': 0.41072624817748354, 'recall': 0.031215839425458445, 'f1-score': 0.05802192174305134, 'support': 333901}, '1': {'precision': 0.3301702179873405, 'recall': 0.947445583383164, 'f1-score': 0.4896907418665306, 'support': 329449}, '2': {'precision': 0.40382917093503834, 'recall': 0.03405299780764465, 'f1-score': 0.06280956318454155, 'support': 335712}, 'accuracy': 0.33430357675499617, 'macro avg': {'precision': 0.3815752123666208, 'recall': 0.33757147353875566, 'f1-score': 0.2035074089313745, 'support': 999062}, 'weighted avg': {'precision': 0.381844622026826, 'recall': 0.33430357675499617, 'f1-score': 0.20197708148735719, 'support': 999062}}
[[ 10423 315857   7621]
 [  8058 312135   9256]
 [  6896 317384  11432]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1128483
{'0': {'precision': 0.4007547169811321, 'recall': 0.03153300276136465, 'f1-score': 0.05846568856836137, 'support': 101037}, '1': {'precision': 0.31596412782255595, 'recall': 0.9454668952356309, 'f1-score': 0.473642422736651, 'support': 92751}, '2': {'precision': 0.39610753290394846, 'recall': 0.02862056755526329, 'f1-score': 0.05338390557332503, 'support': 98845}, 'accuracy': 0.3202236248133327, 'macro avg': {'precision': 0.37094212590254555, 'recall': 0.3352068218507529, 'f1-score': 0.19516400562611247, 'support': 292633}, 'weighted avg': {'precision': 0.3723103417905134, 'recall': 0.3202236248133327, 'f1-score': 0.18834081690555735, 'support': 292633}}
[[ 3186 95966  1885]
 [ 2630 87693  2428]
 [ 2134 93882  2829]]
training model: results/AAPL/W8/deepOF_L1/h200
Epoch 1/50
3903/3903 - 54s - loss: 3.2481 - accuracy200: 0.3896 - val_loss: 3.4776 - val_accuracy200: 0.3162 - 54s/epoch - 14ms/step
Epoch 2/50
3903/3903 - 52s - loss: 3.2446 - accuracy200: 0.3917 - val_loss: 3.4180 - val_accuracy200: 0.3161 - 52s/epoch - 13ms/step
Epoch 3/50
3903/3903 - 53s - loss: 3.2435 - accuracy200: 0.3932 - val_loss: 3.4189 - val_accuracy200: 0.3163 - 53s/epoch - 14ms/step
Epoch 4/50
3903/3903 - 52s - loss: 3.2436 - accuracy200: 0.3942 - val_loss: 3.4212 - val_accuracy200: 0.3161 - 52s/epoch - 13ms/step
Epoch 5/50
3903/3903 - 51s - loss: 3.2431 - accuracy200: 0.3943 - val_loss: 3.4053 - val_accuracy200: 0.3160 - 51s/epoch - 13ms/step
Epoch 6/50
3903/3903 - 52s - loss: 3.2422 - accuracy200: 0.3952 - val_loss: 3.4049 - val_accuracy200: 0.3160 - 52s/epoch - 13ms/step
Epoch 7/50
3903/3903 - 52s - loss: 3.2417 - accuracy200: 0.3955 - val_loss: 3.4035 - val_accuracy200: 0.3160 - 52s/epoch - 13ms/step
Epoch 8/50
3903/3903 - 51s - loss: 3.2410 - accuracy200: 0.3955 - val_loss: 3.4092 - val_accuracy200: 0.3161 - 51s/epoch - 13ms/step
Epoch 9/50
3903/3903 - 51s - loss: 3.2398 - accuracy200: 0.3960 - val_loss: 3.4136 - val_accuracy200: 0.3159 - 51s/epoch - 13ms/step
Epoch 10/50
3903/3903 - 51s - loss: 3.2385 - accuracy200: 0.3968 - val_loss: 3.4190 - val_accuracy200: 0.3159 - 51s/epoch - 13ms/step
Epoch 11/50
3903/3903 - 51s - loss: 3.2377 - accuracy200: 0.3966 - val_loss: 3.4114 - val_accuracy200: 0.3161 - 51s/epoch - 13ms/step
Epoch 12/50
3903/3903 - 51s - loss: 3.2365 - accuracy200: 0.3971 - val_loss: 3.4174 - val_accuracy200: 0.3160 - 51s/epoch - 13ms/step
Epoch 13/50
3903/3903 - 53s - loss: 3.2358 - accuracy200: 0.3977 - val_loss: 3.4224 - val_accuracy200: 0.3161 - 53s/epoch - 14ms/step
Epoch 14/50
3903/3903 - 53s - loss: 3.2347 - accuracy200: 0.3983 - val_loss: 3.4214 - val_accuracy200: 0.3161 - 53s/epoch - 14ms/step
Epoch 15/50
3903/3903 - 52s - loss: 3.2338 - accuracy200: 0.3982 - val_loss: 3.4212 - val_accuracy200: 0.3161 - 52s/epoch - 13ms/step
Epoch 16/50
3903/3903 - 53s - loss: 3.2332 - accuracy200: 0.3987 - val_loss: 3.4148 - val_accuracy200: 0.3160 - 53s/epoch - 13ms/step
Epoch 17/50
3903/3903 - 54s - loss: 3.2326 - accuracy200: 0.3993 - val_loss: 3.4171 - val_accuracy200: 0.3161 - 54s/epoch - 14ms/step
testing model: results/AAPL/W8/deepOF_L1/h200
Evaluating performance on  test set...
10609/10609 - 54s - 54s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1664224
{'0': {'precision': 0.5047929101103273, 'recall': 0.0027592084008059145, 'f1-score': 0.005488417001703947, 'support': 1011522}, '1': {'precision': 0.2564150500726936, 'recall': 0.9969058748157745, 'f1-score': 0.40791095837069313, 'support': 696158}, '2': {'precision': 0.46581077309517166, 'recall': 0.0016557588961078258, 'f1-score': 0.0032997884497518734, 'support': 1007997}, 'accuracy': 0.25719700833346526, 'macro avg': {'precision': 0.4090062444260642, 'recall': 0.3337736140375627, 'f1-score': 0.13889972127404965, 'support': 2715677}, 'weighted avg': {'precision': 0.4266525011246693, 'recall': 0.25719700833346526, 'f1-score': 0.1078362074568541, 'support': 2715677}}
[[   2791 1007629    1102]
 [   1342  694004     812]
 [   1396 1004932    1669]]
Evaluating performance on  train set...
3903/3903 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1326034
{'0': {'precision': 0.4308537194208687, 'recall': 0.0025810349262176922, 'f1-score': 0.005131330548659939, 'support': 334362}, '1': {'precision': 0.3266978887434805, 'recall': 0.9971979950643021, 'f1-score': 0.49215725138403676, 'support': 326195}, '2': {'precision': 0.4577363896848137, 'recall': 0.0018877121460539727, 'f1-score': 0.0037599183291605496, 'support': 338505}, 'accuracy': 0.327089810242007, 'macro avg': {'precision': 0.4050959992830543, 'recall': 0.33388891404552457, 'f1-score': 0.1670161667539524, 'support': 999062}, 'weighted avg': {'precision': 0.40595517169298606, 'recall': 0.327089810242007, 'f1-score': 0.16368124071793283, 'support': 999062}}
[[   863 333095    404]
 [   561 325281    353]
 [   579 337287    639]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1381792
{'0': {'precision': 0.4041958041958042, 'recall': 0.002863370652927772, 'f1-score': 0.0056864577696886225, 'support': 100930}, '1': {'precision': 0.3156475560556577, 'recall': 0.9961781232744714, 'f1-score': 0.4793947777699624, 'support': 92363}, '2': {'precision': 0.44786729857819907, 'recall': 0.0019025568753774915, 'f1-score': 0.0037890178625127804, 'support': 99340}, 'accuracy': 0.3160545803104913, 'macro avg': {'precision': 0.3892368862765537, 'recall': 0.3336480169342589, 'f1-score': 0.1629567511340546, 'support': 292633}, 'weighted avg': {'precision': 0.39107269234231795, 'recall': 0.3160545803104913, 'f1-score': 0.15455767147356494, 'support': 292633}}
[[   289 100532    109]
 [   229  92010    124]
 [   197  98954    189]]
training model: results/AAPL/W8/deepOF_L1/h300
Epoch 1/50
3903/3903 - 56s - loss: 3.2612 - accuracy300: 0.3848 - val_loss: 3.3889 - val_accuracy300: 0.3136 - 56s/epoch - 14ms/step
Epoch 2/50
3903/3903 - 52s - loss: 3.2557 - accuracy300: 0.3871 - val_loss: 3.3655 - val_accuracy300: 0.3135 - 52s/epoch - 13ms/step
Epoch 3/50
3903/3903 - 52s - loss: 3.2546 - accuracy300: 0.3875 - val_loss: 3.3525 - val_accuracy300: 0.3136 - 52s/epoch - 13ms/step
Epoch 4/50
3903/3903 - 55s - loss: 3.2538 - accuracy300: 0.3883 - val_loss: 3.3575 - val_accuracy300: 0.3134 - 55s/epoch - 14ms/step
Epoch 5/50
3903/3903 - 54s - loss: 3.2527 - accuracy300: 0.3886 - val_loss: 3.3525 - val_accuracy300: 0.3136 - 54s/epoch - 14ms/step
Epoch 6/50
3903/3903 - 53s - loss: 3.2517 - accuracy300: 0.3897 - val_loss: 3.3463 - val_accuracy300: 0.3139 - 53s/epoch - 14ms/step
Epoch 7/50
3903/3903 - 54s - loss: 3.2513 - accuracy300: 0.3894 - val_loss: 3.3489 - val_accuracy300: 0.3138 - 54s/epoch - 14ms/step
Epoch 8/50
3903/3903 - 54s - loss: 3.2503 - accuracy300: 0.3902 - val_loss: 3.3522 - val_accuracy300: 0.3136 - 54s/epoch - 14ms/step
Epoch 9/50
3903/3903 - 54s - loss: 3.2496 - accuracy300: 0.3910 - val_loss: 3.3505 - val_accuracy300: 0.3134 - 54s/epoch - 14ms/step
Epoch 10/50
3903/3903 - 55s - loss: 3.2486 - accuracy300: 0.3918 - val_loss: 3.3534 - val_accuracy300: 0.3138 - 55s/epoch - 14ms/step
Epoch 11/50
3903/3903 - 55s - loss: 3.2478 - accuracy300: 0.3924 - val_loss: 3.3493 - val_accuracy300: 0.3136 - 55s/epoch - 14ms/step
Epoch 12/50
3903/3903 - 53s - loss: 3.2471 - accuracy300: 0.3926 - val_loss: 3.3496 - val_accuracy300: 0.3137 - 53s/epoch - 14ms/step
Epoch 13/50
3903/3903 - 55s - loss: 3.2463 - accuracy300: 0.3932 - val_loss: 3.3541 - val_accuracy300: 0.3135 - 55s/epoch - 14ms/step
Epoch 14/50
3903/3903 - 54s - loss: 3.2451 - accuracy300: 0.3941 - val_loss: 3.3546 - val_accuracy300: 0.3137 - 54s/epoch - 14ms/step
Epoch 15/50
3903/3903 - 55s - loss: 3.2446 - accuracy300: 0.3944 - val_loss: 3.3529 - val_accuracy300: 0.3136 - 55s/epoch - 14ms/step
Epoch 16/50
3903/3903 - 55s - loss: 3.2438 - accuracy300: 0.3953 - val_loss: 3.3566 - val_accuracy300: 0.3136 - 55s/epoch - 14ms/step
testing model: results/AAPL/W8/deepOF_L1/h300
Evaluating performance on  test set...
10609/10609 - 75s - 75s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1367836
{'0': {'precision': 0.47580645161290325, 'recall': 0.00457902109842179, 'f1-score': 0.009070747990790884, 'support': 1030788}, '1': {'precision': 0.24572974788744456, 'recall': 0.9934480143181348, 'f1-score': 0.3940027614168536, 'support': 667126}, '2': {'precision': 0.42270419935394554, 'recall': 0.003600052271501322, 'f1-score': 0.00713930113178577, 'support': 1017763}, 'accuracy': 0.2471350606128785, 'macro avg': {'precision': 0.3814134662847644, 'recall': 0.33387569589601934, 'f1-score': 0.13673760351314343, 'support': 2715677}, 'weighted avg': {'precision': 0.3993851177740911, 'recall': 0.2471350606128785, 'f1-score': 0.10290826962510671, 'support': 2715677}}
[[   4720 1023123    2945]
 [   2312  662755    2059]
 [   2888 1011211    3664]]
Evaluating performance on  train set...
3903/3903 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.110742
{'0': {'precision': 0.38642765685019204, 'recall': 0.004544482624657056, 'f1-score': 0.008983319244186739, 'support': 332051}, '1': {'precision': 0.3303934604377249, 'recall': 0.9936756065172178, 'f1-score': 0.49590150602158983, 'support': 329834}, '2': {'precision': 0.4004424778761062, 'recall': 0.0037576703037277156, 'f1-score': 0.007445473804214008, 'support': 337177}, 'accuracy': 0.3308343225945937, 'macro avg': {'precision': 0.3724211983880077, 'recall': 0.3339925864818675, 'f1-score': 0.17077676635666353, 'support': 999062}, 'weighted avg': {'precision': 0.37265823330044734, 'recall': 0.3308343225945937, 'f1-score': 0.16921726579167254, 'support': 999062}}
[[  1509 329566    976]
 [  1165 327748    921]
 [  1231 334679   1267]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.116508
{'0': {'precision': 0.3818722139673105, 'recall': 0.0050809592534746244, 'f1-score': 0.010028485581613142, 'support': 101162}, '1': {'precision': 0.3130204494892793, 'recall': 0.9920109140518417, 'f1-score': 0.4758808269131594, 'support': 91625}, '2': {'precision': 0.3888280394304491, 'recall': 0.003555475432165535, 'f1-score': 0.007046516936452326, 'support': 99846}, 'accuracy': 0.3135736571063414, 'macro avg': {'precision': 0.3612402342956796, 'recall': 0.3335491162458273, 'f1-score': 0.16431860981040827, 'support': 292633}, 'weighted avg': {'precision': 0.36268766686870213, 'recall': 0.3135736571063414, 'f1-score': 0.15487196917081258, 'support': 292633}}
[[   514 100373    275]
 [   449  90893    283]
 [   383  99108    355]]
training model: results/AAPL/W8/deepOF_L1/h500
Epoch 1/50
3903/3903 - 57s - loss: 3.2608 - accuracy500: 0.3862 - val_loss: 3.4050 - val_accuracy500: 0.3168 - 57s/epoch - 14ms/step
Epoch 2/50
3903/3903 - 54s - loss: 3.2560 - accuracy500: 0.3854 - val_loss: 3.3730 - val_accuracy500: 0.3168 - 54s/epoch - 14ms/step
Epoch 3/50
3903/3903 - 54s - loss: 3.2541 - accuracy500: 0.3862 - val_loss: 3.3659 - val_accuracy500: 0.3170 - 54s/epoch - 14ms/step
Epoch 4/50
3903/3903 - 54s - loss: 3.2527 - accuracy500: 0.3871 - val_loss: 3.3622 - val_accuracy500: 0.3170 - 54s/epoch - 14ms/step
Epoch 5/50
3903/3903 - 54s - loss: 3.2518 - accuracy500: 0.3877 - val_loss: 3.3696 - val_accuracy500: 0.3170 - 54s/epoch - 14ms/step
Epoch 6/50
3903/3903 - 56s - loss: 3.2513 - accuracy500: 0.3880 - val_loss: 3.3665 - val_accuracy500: 0.3171 - 56s/epoch - 14ms/step
Epoch 7/50
3903/3903 - 54s - loss: 3.2508 - accuracy500: 0.3888 - val_loss: 3.3675 - val_accuracy500: 0.3170 - 54s/epoch - 14ms/step
Epoch 8/50
3903/3903 - 54s - loss: 3.2500 - accuracy500: 0.3899 - val_loss: 3.3723 - val_accuracy500: 0.3171 - 54s/epoch - 14ms/step
Epoch 9/50
3903/3903 - 53s - loss: 3.2491 - accuracy500: 0.3900 - val_loss: 3.3719 - val_accuracy500: 0.3171 - 53s/epoch - 14ms/step
Epoch 10/50
3903/3903 - 54s - loss: 3.2479 - accuracy500: 0.3913 - val_loss: 3.3841 - val_accuracy500: 0.3170 - 54s/epoch - 14ms/step
Epoch 11/50
3903/3903 - 52s - loss: 3.2469 - accuracy500: 0.3919 - val_loss: 3.3850 - val_accuracy500: 0.3170 - 52s/epoch - 13ms/step
Epoch 12/50
3903/3903 - 54s - loss: 3.2463 - accuracy500: 0.3920 - val_loss: 3.3879 - val_accuracy500: 0.3171 - 54s/epoch - 14ms/step
Epoch 13/50
3903/3903 - 52s - loss: 3.2457 - accuracy500: 0.3928 - val_loss: 3.3936 - val_accuracy500: 0.3172 - 52s/epoch - 13ms/step
Epoch 14/50
3903/3903 - 51s - loss: 3.2447 - accuracy500: 0.3933 - val_loss: 3.3975 - val_accuracy500: 0.3173 - 51s/epoch - 13ms/step
testing model: results/AAPL/W8/deepOF_L1/h500
Evaluating performance on  test set...
10609/10609 - 58s - 58s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1468894
{'0': {'precision': 0.4345984412063707, 'recall': 0.002506456691066754, 'f1-score': 0.004984168221992716, 'support': 1023357}, '1': {'precision': 0.24923882765577426, 'recall': 0.9950932576630901, 'f1-score': 0.39863293709823283, 'support': 676620}, '2': {'precision': 0.4227544910179641, 'recall': 0.003475435660135867, 'f1-score': 0.00689419461940335, 'support': 1015700}, 'accuracy': 0.25017518651886805, 'macro avg': {'precision': 0.36886391996003637, 'recall': 0.3336917166714309, 'f1-score': 0.13683709997987628, 'support': 2715677}, 'weighted avg': {'precision': 0.3839856761658415, 'recall': 0.25017518651886805, 'f1-score': 0.10377745026874996, 'support': 2715677}}
[[   2565 1017916    2876]
 [   1376  673300    1944]
 [   1961 1010209    3530]]
Evaluating performance on  train set...
3903/3903 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1166207
{'0': {'precision': 0.3753698224852071, 'recall': 0.0030728709394205445, 'f1-score': 0.006095839814542332, 'support': 330310}, '1': {'precision': 0.32986731321853546, 'recall': 0.9947078541153038, 'f1-score': 0.49543674887827954, 'support': 329356}, '2': {'precision': 0.41228070175438597, 'recall': 0.003877476458178647, 'f1-score': 0.007682697584270319, 'support': 339396}, 'accuracy': 0.33025377804380507, 'macro avg': {'precision': 0.3725059458193762, 'recall': 0.33388606717096764, 'f1-score': 0.16973842875903075, 'support': 999062}, 'weighted avg': {'precision': 0.37290839400369974, 'recall': 0.33025377804380507, 'f1-score': 0.16795360001882476, 'support': 999062}}
[[  1015 328317    978]
 [   845 327613    898]
 [   844 337236   1316]]
Evaluating performance on  val set...
1144/1144 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1219143
{'0': {'precision': 0.336734693877551, 'recall': 0.0032960447463044346, 'f1-score': 0.006528189910979228, 'support': 100120}, '1': {'precision': 0.3167851871729505, 'recall': 0.9924017071908949, 'f1-score': 0.4802647535147907, 'support': 92784}, '2': {'precision': 0.3509127789046653, 'recall': 0.003469402079635813, 'f1-score': 0.006870873256218041, 'support': 99729}, 'accuracy': 0.31696698595168693, 'macro avg': {'precision': 0.3348108866517223, 'recall': 0.33305571800561173, 'f1-score': 0.16455460556066268, 'support': 292633}, 'weighted avg': {'precision': 0.3352412574284473, 'recall': 0.31696698595168693, 'f1-score': 0.1568507741197095, 'support': 292633}}
[[  330 99511   279]
 [  344 92079   361]
 [  306 99077   346]]
training model: results/AAPL/W8/deepOF_L1/h1000
Epoch 1/50
3903/3903 - 56s - loss: 3.2598 - accuracy1000: 0.3861 - val_loss: 3.4219 - val_accuracy1000: 0.3182 - 56s/epoch - 14ms/step
Epoch 2/50
3903/3903 - 52s - loss: 3.2533 - accuracy1000: 0.3843 - val_loss: 3.3899 - val_accuracy1000: 0.3182 - 52s/epoch - 13ms/step
Epoch 3/50
3903/3903 - 51s - loss: 3.2513 - accuracy1000: 0.3840 - val_loss: 3.3851 - val_accuracy1000: 0.3183 - 51s/epoch - 13ms/step
Epoch 4/50
3903/3903 - 52s - loss: 3.2496 - accuracy1000: 0.3857 - val_loss: 3.3897 - val_accuracy1000: 0.3184 - 52s/epoch - 13ms/step
Epoch 5/50
3903/3903 - 51s - loss: 3.2481 - accuracy1000: 0.3871 - val_loss: 3.3906 - val_accuracy1000: 0.3184 - 51s/epoch - 13ms/step
Epoch 6/50
3903/3903 - 51s - loss: 3.2468 - accuracy1000: 0.3888 - val_loss: 3.3907 - val_accuracy1000: 0.3185 - 51s/epoch - 13ms/step
Epoch 7/50
3903/3903 - 52s - loss: 3.2462 - accuracy1000: 0.3895 - val_loss: 3.3922 - val_accuracy1000: 0.3184 - 52s/epoch - 13ms/step
Epoch 8/50
3903/3903 - 52s - loss: 3.2454 - accuracy1000: 0.3903 - val_loss: 3.3926 - val_accuracy1000: 0.3185 - 52s/epoch - 13ms/step
Epoch 9/50
3903/3903 - 52s - loss: 3.2447 - accuracy1000: 0.3912 - val_loss: 3.3946 - val_accuracy1000: 0.3184 - 52s/epoch - 13ms/step
Epoch 10/50
3903/3903 - 52s - loss: 3.2440 - accuracy1000: 0.3921 - val_loss: 3.3957 - val_accuracy1000: 0.3185 - 52s/epoch - 13ms/step
Epoch 11/50
3903/3903 - 51s - loss: 3.2434 - accuracy1000: 0.3927 - val_loss: 3.4026 - val_accuracy1000: 0.3183 - 51s/epoch - 13ms/step
Epoch 12/50
3903/3903 - 53s - loss: 3.2424 - accuracy1000: 0.3935 - val_loss: 3.4101 - val_accuracy1000: 0.3183 - 53s/epoch - 14ms/step
Epoch 13/50
3903/3903 - 56s - loss: 3.2417 - accuracy1000: 0.3940 - val_loss: 3.4142 - val_accuracy1000: 0.3183 - 56s/epoch - 14ms/step
testing model: results/AAPL/W8/deepOF_L1/h1000
Evaluating performance on  test set...
10609/10609 - 56s - 56s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1524327
{'0': {'precision': 0.38834667187195004, 'recall': 0.003962654052035354, 'f1-score': 0.007845255828488787, 'support': 1004125}, '1': {'precision': 0.26299403157004797, 'recall': 0.9947371368568428, 'f1-score': 0.4160029369418215, 'support': 714250}, '2': {'precision': 0.39711563224311097, 'recall': 0.0015461715708982836, 'f1-score': 0.0030803497855041778, 'support': 997302}, 'accuracy': 0.2636587488129111, 'macro avg': {'precision': 0.3494854452283696, 'recall': 0.33341532082659214, 'f1-score': 0.1423095141852715, 'support': 2715677}, 'weighted avg': {'precision': 0.35859798614107924, 'recall': 0.2636587488129111, 'f1-score': 0.11344491786808969, 'support': 2715677}}
[[  3979 998873   1273]
 [  2691 710491   1068]
 [  3576 992184   1542]]
Evaluating performance on  train set...
3903/3903 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.122267
{'0': {'precision': 0.34001503382610876, 'recall': 0.0041778141750125454, 'f1-score': 0.008254207699466547, 'support': 324811}, '1': {'precision': 0.3312552087317468, 'recall': 0.9945394162282385, 'f1-score': 0.49697948039965545, 'support': 330917}, '2': {'precision': 0.3645765998707175, 'recall': 0.001642715256863579, 'f1-score': 0.003270693369597049, 'support': 343334}, 'accuracy': 0.33134179860709345, 'macro avg': {'precision': 0.3452822808095244, 'recall': 0.33345331522003824, 'f1-score': 0.169501460489573, 'support': 999062}, 'weighted avg': {'precision': 0.3455542753102296, 'recall': 0.33134179860709345, 'f1-score': 0.16842093524710325, 'support': 999062}}
[[  1357 322977    477]
 [  1301 329110    506]
 [  1333 341437    564]]
Evaluating performance on  val set...
1144/1144 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1285242
{'0': {'precision': 0.3377777777777778, 'recall': 0.0046032242759511816, 'f1-score': 0.009082670225373716, 'support': 99061}, '1': {'precision': 0.3183303072817804, 'recall': 0.9933471398066378, 'f1-score': 0.4821497860682654, 'support': 93193}, '2': {'precision': 0.3642105263157895, 'recall': 0.001723468056067504, 'f1-score': 0.003430701806571876, 'support': 100379}, 'accuracy': 0.31849449651953127, 'macro avg': {'precision': 0.3401062037917826, 'recall': 0.3332246107128855, 'f1-score': 0.16488771936673702, 'support': 292633}, 'weighted avg': {'precision': 0.3406514275287068, 'recall': 0.31849449651953127, 'f1-score': 0.15779865505564128, 'support': 292633}}
[[  456 98462   143]
 [  461 92573   159]
 [  433 99773   173]]
training model: results/AAPL/W8/deepLOB_L2/h10
Epoch 1/50
3903/3903 - 162s - loss: 3.1994 - accuracy10: 0.4151 - val_loss: 3.5010 - val_accuracy10: 0.3291 - 162s/epoch - 41ms/step
Epoch 2/50
3903/3903 - 158s - loss: 3.1374 - accuracy10: 0.4471 - val_loss: 3.3125 - val_accuracy10: 0.3991 - 158s/epoch - 41ms/step
Epoch 3/50
3903/3903 - 157s - loss: 3.1049 - accuracy10: 0.4596 - val_loss: 3.2539 - val_accuracy10: 0.4213 - 157s/epoch - 40ms/step
Epoch 4/50
3903/3903 - 157s - loss: 3.0847 - accuracy10: 0.4658 - val_loss: 3.2134 - val_accuracy10: 0.4307 - 157s/epoch - 40ms/step
Epoch 5/50
3903/3903 - 159s - loss: 3.0711 - accuracy10: 0.4696 - val_loss: 3.2208 - val_accuracy10: 0.4335 - 159s/epoch - 41ms/step
Epoch 6/50
3903/3903 - 158s - loss: 3.0619 - accuracy10: 0.4723 - val_loss: 3.1965 - val_accuracy10: 0.4384 - 158s/epoch - 41ms/step
Epoch 7/50
3903/3903 - 157s - loss: 3.0540 - accuracy10: 0.4745 - val_loss: 3.1931 - val_accuracy10: 0.4403 - 157s/epoch - 40ms/step
Epoch 8/50
3903/3903 - 159s - loss: 3.0479 - accuracy10: 0.4762 - val_loss: 3.2103 - val_accuracy10: 0.4402 - 159s/epoch - 41ms/step
Epoch 9/50
3903/3903 - 157s - loss: 3.0428 - accuracy10: 0.4777 - val_loss: 3.2070 - val_accuracy10: 0.4413 - 157s/epoch - 40ms/step
Epoch 10/50
3903/3903 - 158s - loss: 3.0382 - accuracy10: 0.4793 - val_loss: 3.2445 - val_accuracy10: 0.4367 - 158s/epoch - 40ms/step
Epoch 11/50
3903/3903 - 159s - loss: 3.0336 - accuracy10: 0.4810 - val_loss: 3.2468 - val_accuracy10: 0.4364 - 159s/epoch - 41ms/step
Epoch 12/50
3903/3903 - 158s - loss: 3.0299 - accuracy10: 0.4818 - val_loss: 3.2583 - val_accuracy10: 0.4385 - 158s/epoch - 41ms/step
Epoch 13/50
3903/3903 - 155s - loss: 3.0266 - accuracy10: 0.4825 - val_loss: 3.2268 - val_accuracy10: 0.4423 - 155s/epoch - 40ms/step
Epoch 14/50
3903/3903 - 154s - loss: 3.0233 - accuracy10: 0.4838 - val_loss: 3.2583 - val_accuracy10: 0.4363 - 154s/epoch - 40ms/step
Epoch 15/50
3903/3903 - 153s - loss: 3.0202 - accuracy10: 0.4846 - val_loss: 3.2398 - val_accuracy10: 0.4409 - 153s/epoch - 39ms/step
Epoch 16/50
3903/3903 - 153s - loss: 3.0175 - accuracy10: 0.4857 - val_loss: 3.2140 - val_accuracy10: 0.4456 - 153s/epoch - 39ms/step
Epoch 17/50
3903/3903 - 154s - loss: 3.0148 - accuracy10: 0.4864 - val_loss: 3.2423 - val_accuracy10: 0.4407 - 154s/epoch - 39ms/step
testing model: results/AAPL/W8/deepLOB_L2/h10
Evaluating performance on  test set...
10609/10609 - 143s - 143s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0556985
{'0': {'precision': 0.432428722985956, 'recall': 0.4001965938232006, 'f1-score': 0.4156887822568136, 'support': 873883}, '1': {'precision': 0.47512498007991644, 'recall': 0.3423136865515826, 'f1-score': 0.3979302427033888, 'support': 940646}, '2': {'precision': 0.41714881209995214, 'recall': 0.5690165820898339, 'f1-score': 0.4813890097592872, 'support': 901153}, 'accuracy': 0.4361674157725389, 'macro avg': {'precision': 0.4415675050552748, 'recall': 0.437175620821539, 'f1-score': 0.43166934490649655, 'support': 2715682}, 'weighted avg': {'precision': 0.442147285732165, 'recall': 0.4361674157725389, 'f1-score': 0.4313391632357963, 'support': 2715682}}
[[349725 169548 354610]
 [256803 321996 361847]
 [202218 186164 512771]]
Evaluating performance on  train set...
3903/3903 - 55s - 55s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0813162
{'0': {'precision': 0.4541665534574107, 'recall': 0.4970132700604482, 'f1-score': 0.4746248780827149, 'support': 336321}, '1': {'precision': 0.40972284230439376, 'recall': 0.6059226002198788, 'f1-score': 0.4888720405450439, 'support': 325634}, '2': {'precision': 0.4788485473013664, 'recall': 0.21228211730365343, 'f1-score': 0.2941585106689083, 'support': 337108}, 'accuracy': 0.43643594047622625, 'macro avg': {'precision': 0.44757931435439025, 'recall': 0.43840599586132684, 'f1-score': 0.41921847643222243, 'support': 999063}, 'weighted avg': {'precision': 0.44800889787727877, 'recall': 0.43643594047622625, 'f1-score': 0.41837487614602475, 'support': 999063}}
[[167156 127080  42085]
 [ 92526 197309  35799]
 [108368 157178  71562]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0655384
{'0': {'precision': 0.4484550223205008, 'recall': 0.5426398696360674, 'f1-score': 0.4910722007036644, 'support': 99414}, '1': {'precision': 0.41072345008034594, 'recall': 0.519196409580125, 'f1-score': 0.4586333723207869, 'support': 94028}, '2': {'precision': 0.4895005516183923, 'recall': 0.2639150729400853, 'f1-score': 0.34293574376105335, 'support': 99191}, 'accuracy': 0.44063041420482313, 'macro avg': {'precision': 0.44955967467307967, 'recall': 0.44191711738542594, 'f1-score': 0.43088043892850153, 'support': 292633}, 'weighted avg': {'precision': 0.4502440304706065, 'recall': 0.44063041420482313, 'f1-score': 0.4304366556496898, 'support': 292633}}
[[53946 31538 13930]
 [31838 48819 13371]
 [34509 38504 26178]]
training model: results/AAPL/W8/deepLOB_L2/h20
Epoch 1/50
3903/3903 - 157s - loss: 3.2362 - accuracy20: 0.3964 - val_loss: 3.4737 - val_accuracy20: 0.3322 - 157s/epoch - 40ms/step
Epoch 2/50
3903/3903 - 153s - loss: 3.1909 - accuracy20: 0.4227 - val_loss: 3.4643 - val_accuracy20: 0.3582 - 153s/epoch - 39ms/step
Epoch 3/50
3903/3903 - 154s - loss: 3.1714 - accuracy20: 0.4316 - val_loss: 3.4257 - val_accuracy20: 0.3666 - 154s/epoch - 39ms/step
Epoch 4/50
3903/3903 - 154s - loss: 3.1591 - accuracy20: 0.4359 - val_loss: 3.4144 - val_accuracy20: 0.3690 - 154s/epoch - 39ms/step
Epoch 5/50
3903/3903 - 154s - loss: 3.1488 - accuracy20: 0.4401 - val_loss: 3.3681 - val_accuracy20: 0.3712 - 154s/epoch - 39ms/step
Epoch 6/50
3903/3903 - 156s - loss: 3.1413 - accuracy20: 0.4424 - val_loss: 3.3362 - val_accuracy20: 0.3752 - 156s/epoch - 40ms/step
Epoch 7/50
3903/3903 - 159s - loss: 3.1357 - accuracy20: 0.4444 - val_loss: 3.3231 - val_accuracy20: 0.3798 - 159s/epoch - 41ms/step
Epoch 8/50
3903/3903 - 156s - loss: 3.1307 - accuracy20: 0.4465 - val_loss: 3.3574 - val_accuracy20: 0.3812 - 156s/epoch - 40ms/step
Epoch 9/50
3903/3903 - 154s - loss: 3.1265 - accuracy20: 0.4477 - val_loss: 3.3469 - val_accuracy20: 0.3856 - 154s/epoch - 40ms/step
Epoch 10/50
3903/3903 - 154s - loss: 3.1234 - accuracy20: 0.4489 - val_loss: 3.3603 - val_accuracy20: 0.3857 - 154s/epoch - 39ms/step
Epoch 11/50
3903/3903 - 154s - loss: 3.1201 - accuracy20: 0.4503 - val_loss: 3.3472 - val_accuracy20: 0.3886 - 154s/epoch - 39ms/step
Epoch 12/50
3903/3903 - 154s - loss: 3.1174 - accuracy20: 0.4514 - val_loss: 3.3479 - val_accuracy20: 0.3915 - 154s/epoch - 40ms/step
Epoch 13/50
3903/3903 - 154s - loss: 3.1150 - accuracy20: 0.4517 - val_loss: 3.3458 - val_accuracy20: 0.3889 - 154s/epoch - 39ms/step
Epoch 14/50
3903/3903 - 154s - loss: 3.1124 - accuracy20: 0.4530 - val_loss: 3.3672 - val_accuracy20: 0.3889 - 154s/epoch - 40ms/step
Epoch 15/50
3903/3903 - 154s - loss: 3.1100 - accuracy20: 0.4536 - val_loss: 3.3479 - val_accuracy20: 0.3905 - 154s/epoch - 39ms/step
Epoch 16/50
3903/3903 - 154s - loss: 3.1074 - accuracy20: 0.4541 - val_loss: 3.3506 - val_accuracy20: 0.3908 - 154s/epoch - 39ms/step
Epoch 17/50
3903/3903 - 154s - loss: 3.1059 - accuracy20: 0.4548 - val_loss: 3.3504 - val_accuracy20: 0.3914 - 154s/epoch - 39ms/step
testing model: results/AAPL/W8/deepLOB_L2/h20
Evaluating performance on  test set...
10609/10609 - 142s - 142s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.093216
{'0': {'precision': 0.42971715221266965, 'recall': 0.18792130721261194, 'f1-score': 0.2614895745016502, 'support': 895279}, '1': {'precision': 0.3810155253083794, 'recall': 0.4008114511484931, 'f1-score': 0.39066287096165736, 'support': 893954}, '2': {'precision': 0.375257630636438, 'recall': 0.5604928064038064, 'f1-score': 0.4495412327781032, 'support': 926449}, 'accuracy': 0.38510289496340144, 'macro avg': {'precision': 0.3953301027191623, 'recall': 0.3830751882549705, 'f1-score': 0.36723122608047026, 'support': 2715682}, 'weighted avg': {'precision': 0.3951066994857392, 'recall': 0.38510289496340144, 'f1-score': 0.3681645297512601, 'support': 2715682}}
[[168242 281715 445322]
 [116473 358307 419174]
 [106803 300378 519268]]
Evaluating performance on  train set...
3903/3903 - 52s - 52s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1203103
{'0': {'precision': 0.4194492878855679, 'recall': 0.32544851572274336, 'f1-score': 0.3665177894257833, 'support': 334102}, '1': {'precision': 0.36458555639627754, 'recall': 0.6851560957083175, 'f1-score': 0.4759228441994384, 'support': 329125}, '2': {'precision': 0.4389996620479892, 'recall': 0.15858633380578616, 'f1-score': 0.233001935886078, 'support': 335836}, 'accuracy': 0.3878574224047933, 'macro avg': {'precision': 0.40767816877661156, 'recall': 0.389730315078949, 'f1-score': 0.35848085650376654, 'support': 999063}, 'weighted avg': {'precision': 0.4079472042640127, 'recall': 0.3878574224047933, 'f1-score': 0.35767801502018404, 'support': 999063}}
[[108733 184229  41140]
 [ 76703 225502  26920]
 [ 73792 208785  53259]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1091645
{'0': {'precision': 0.42623686572680713, 'recall': 0.3265574433656958, 'f1-score': 0.36979775075013177, 'support': 98880}, '1': {'precision': 0.350923326453963, 'recall': 0.6821266968325792, 'f1-score': 0.46343190381816823, 'support': 95472}, '2': {'precision': 0.43676912262764395, 'recall': 0.13909097384031502, 'f1-score': 0.21099097847645065, 'support': 98281}, 'accuracy': 0.3796017537324909, 'macro avg': {'precision': 0.40464310493613803, 'recall': 0.38259170467952996, 'f1-score': 0.34807354434825016, 'support': 292633}, 'weighted avg': {'precision': 0.40520296496720093, 'recall': 0.3796017537324909, 'f1-score': 0.3470106811984473, 'support': 292633}}
[[32290 57269  9321]
 [22041 65124  8307]
 [21425 63186 13670]]
training model: results/AAPL/W8/deepLOB_L2/h30
Epoch 1/50
3903/3903 - 156s - loss: 3.2408 - accuracy30: 0.3956 - val_loss: 3.4120 - val_accuracy30: 0.3455 - 156s/epoch - 40ms/step
Epoch 2/50
3903/3903 - 154s - loss: 3.2131 - accuracy30: 0.4116 - val_loss: 3.3880 - val_accuracy30: 0.3746 - 154s/epoch - 39ms/step
Epoch 3/50
3903/3903 - 153s - loss: 3.2016 - accuracy30: 0.4177 - val_loss: 3.3868 - val_accuracy30: 0.3751 - 153s/epoch - 39ms/step
Epoch 4/50
3903/3903 - 154s - loss: 3.1943 - accuracy30: 0.4208 - val_loss: 3.3756 - val_accuracy30: 0.3754 - 154s/epoch - 40ms/step
Epoch 5/50
3903/3903 - 154s - loss: 3.1889 - accuracy30: 0.4228 - val_loss: 3.3484 - val_accuracy30: 0.3785 - 154s/epoch - 40ms/step
Epoch 6/50
3903/3903 - 154s - loss: 3.1837 - accuracy30: 0.4248 - val_loss: 3.3571 - val_accuracy30: 0.3794 - 154s/epoch - 39ms/step
Epoch 7/50
3903/3903 - 153s - loss: 3.1791 - accuracy30: 0.4269 - val_loss: 3.3514 - val_accuracy30: 0.3801 - 153s/epoch - 39ms/step
Epoch 8/50
3903/3903 - 153s - loss: 3.1746 - accuracy30: 0.4286 - val_loss: 3.3601 - val_accuracy30: 0.3781 - 153s/epoch - 39ms/step
Epoch 9/50
3903/3903 - 154s - loss: 3.1706 - accuracy30: 0.4300 - val_loss: 3.3691 - val_accuracy30: 0.3808 - 154s/epoch - 39ms/step
Epoch 10/50
3903/3903 - 156s - loss: 3.1670 - accuracy30: 0.4317 - val_loss: 3.3665 - val_accuracy30: 0.3834 - 156s/epoch - 40ms/step
Epoch 11/50
3903/3903 - 155s - loss: 3.1638 - accuracy30: 0.4333 - val_loss: 3.3571 - val_accuracy30: 0.3839 - 155s/epoch - 40ms/step
Epoch 12/50
3903/3903 - 154s - loss: 3.1609 - accuracy30: 0.4343 - val_loss: 3.3697 - val_accuracy30: 0.3812 - 154s/epoch - 40ms/step
Epoch 13/50
3903/3903 - 154s - loss: 3.1585 - accuracy30: 0.4351 - val_loss: 3.3629 - val_accuracy30: 0.3822 - 154s/epoch - 39ms/step
Epoch 14/50
3903/3903 - 154s - loss: 3.1562 - accuracy30: 0.4363 - val_loss: 3.3275 - val_accuracy30: 0.3868 - 154s/epoch - 39ms/step
Epoch 15/50
3903/3903 - 154s - loss: 3.1539 - accuracy30: 0.4368 - val_loss: 3.3255 - val_accuracy30: 0.3860 - 154s/epoch - 39ms/step
Epoch 16/50
3903/3903 - 154s - loss: 3.1519 - accuracy30: 0.4381 - val_loss: 3.3165 - val_accuracy30: 0.3866 - 154s/epoch - 39ms/step
Epoch 17/50
3903/3903 - 153s - loss: 3.1500 - accuracy30: 0.4383 - val_loss: 3.3308 - val_accuracy30: 0.3857 - 153s/epoch - 39ms/step
Epoch 18/50
3903/3903 - 152s - loss: 3.1482 - accuracy30: 0.4393 - val_loss: 3.3304 - val_accuracy30: 0.3844 - 152s/epoch - 39ms/step
Epoch 19/50
3903/3903 - 154s - loss: 3.1462 - accuracy30: 0.4400 - val_loss: 3.3166 - val_accuracy30: 0.3823 - 154s/epoch - 39ms/step
Epoch 20/50
3903/3903 - 154s - loss: 3.1445 - accuracy30: 0.4408 - val_loss: 3.3134 - val_accuracy30: 0.3806 - 154s/epoch - 39ms/step
Epoch 21/50
3903/3903 - 154s - loss: 3.1432 - accuracy30: 0.4414 - val_loss: 3.3055 - val_accuracy30: 0.3867 - 154s/epoch - 39ms/step
Epoch 22/50
3903/3903 - 154s - loss: 3.1410 - accuracy30: 0.4424 - val_loss: 3.3112 - val_accuracy30: 0.3851 - 154s/epoch - 39ms/step
Epoch 23/50
3903/3903 - 154s - loss: 3.1395 - accuracy30: 0.4432 - val_loss: 3.2953 - val_accuracy30: 0.3882 - 154s/epoch - 39ms/step
Epoch 24/50
3903/3903 - 154s - loss: 3.1380 - accuracy30: 0.4436 - val_loss: 3.3014 - val_accuracy30: 0.3872 - 154s/epoch - 39ms/step
Epoch 25/50
3903/3903 - 154s - loss: 3.1366 - accuracy30: 0.4440 - val_loss: 3.3071 - val_accuracy30: 0.3854 - 154s/epoch - 39ms/step
Epoch 26/50
3903/3903 - 154s - loss: 3.1352 - accuracy30: 0.4449 - val_loss: 3.2915 - val_accuracy30: 0.3872 - 154s/epoch - 39ms/step
Epoch 27/50
3903/3903 - 153s - loss: 3.1335 - accuracy30: 0.4453 - val_loss: 3.3264 - val_accuracy30: 0.3810 - 153s/epoch - 39ms/step
Epoch 28/50
3903/3903 - 154s - loss: 3.1319 - accuracy30: 0.4461 - val_loss: 3.3390 - val_accuracy30: 0.3819 - 154s/epoch - 39ms/step
Epoch 29/50
3903/3903 - 154s - loss: 3.1306 - accuracy30: 0.4469 - val_loss: 3.3403 - val_accuracy30: 0.3817 - 154s/epoch - 39ms/step
Epoch 30/50
3903/3903 - 154s - loss: 3.1289 - accuracy30: 0.4470 - val_loss: 3.4042 - val_accuracy30: 0.3748 - 154s/epoch - 39ms/step
Epoch 31/50
3903/3903 - 154s - loss: 3.1274 - accuracy30: 0.4480 - val_loss: 3.3684 - val_accuracy30: 0.3801 - 154s/epoch - 39ms/step
Epoch 32/50
3903/3903 - 154s - loss: 3.1262 - accuracy30: 0.4485 - val_loss: 3.4350 - val_accuracy30: 0.3777 - 154s/epoch - 40ms/step
Epoch 33/50
3903/3903 - 154s - loss: 3.1249 - accuracy30: 0.4489 - val_loss: 3.4467 - val_accuracy30: 0.3758 - 154s/epoch - 39ms/step
Epoch 34/50
3903/3903 - 155s - loss: 3.1228 - accuracy30: 0.4498 - val_loss: 3.4482 - val_accuracy30: 0.3751 - 155s/epoch - 40ms/step
Epoch 35/50
3903/3903 - 154s - loss: 3.1217 - accuracy30: 0.4506 - val_loss: 3.4207 - val_accuracy30: 0.3794 - 154s/epoch - 39ms/step
Epoch 36/50
3903/3903 - 154s - loss: 3.1202 - accuracy30: 0.4510 - val_loss: 3.4709 - val_accuracy30: 0.3747 - 154s/epoch - 39ms/step
testing model: results/AAPL/W8/deepLOB_L2/h30
Evaluating performance on  test set...
10609/10609 - 140s - 140s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1450555
{'0': {'precision': 0.4017469793360631, 'recall': 0.246621178536395, 'f1-score': 0.3056267101160965, 'support': 922585}, '1': {'precision': 0.3770588916200813, 'recall': 0.19952127768176375, 'f1-score': 0.26095684805949, 'support': 832633}, '2': {'precision': 0.3805894856104835, 'recall': 0.6770998184210965, 'f1-score': 0.4872831191874144, 'support': 960464}, 'accuracy': 0.3844290310868504, 'macro avg': {'precision': 0.38646511885554263, 'recall': 0.3744140915464184, 'f1-score': 0.35128889245433365, 'support': 2715682}, 'weighted avg': {'precision': 0.3866947281546412, 'recall': 0.3844290310868504, 'f1-score': 0.356177857131283, 'support': 2715682}}
[[227529 128679 566377]
 [174468 166128 492037]
 [164352 145782 650330]]
Evaluating performance on  train set...
3903/3903 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.093839
{'0': {'precision': 0.38319587159371726, 'recall': 0.4778474864526388, 'f1-score': 0.425319311388795, 'support': 334567}, '1': {'precision': 0.38443085846308067, 'recall': 0.4369601974135173, 'f1-score': 0.40901585816905306, 'support': 328245}, '2': {'precision': 0.4289060591399652, 'recall': 0.26628322294952284, 'f1-score': 0.32857378763692413, 'support': 336251}, 'accuracy': 0.3932084363048176, 'macro avg': {'precision': 0.39884426306558773, 'recall': 0.39369696893855965, 'f1-score': 0.3876363190649241, 'support': 999063}, 'weighted avg': {'precision': 0.3989861416142741, 'recall': 0.3932084363048176, 'f1-score': 0.3874014762680823, 'support': 999063}}
[[159872 107248  67447]
 [133041 143430  51774]
 [124294 122419  89538]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0975863
{'0': {'precision': 0.3899975767251579, 'recall': 0.5468400223856732, 'f1-score': 0.4552897616175064, 'support': 100064}, '1': {'precision': 0.3652975871313673, 'recall': 0.3625295332155552, 'f1-score': 0.36390829647672157, 'support': 93962}, '2': {'precision': 0.4194695058990809, 'recall': 0.25131075887107407, 'f1-score': 0.31431216864107964, 'support': 98607}, 'accuracy': 0.3880765327218735, 'macro avg': {'precision': 0.39158822325186865, 'recall': 0.3868934381574342, 'f1-score': 0.37783674224510255, 'support': 292633}, 'weighted avg': {'precision': 0.391997618066501, 'recall': 0.3880765327218735, 'f1-score': 0.378443463564365, 'support': 292633}}
[[54719 27623 17722]
 [43324 34064 16574]
 [42263 31563 24781]]
training model: results/AAPL/W8/deepLOB_L2/h50
Epoch 1/50
3903/3903 - 159s - loss: 3.2432 - accuracy50: 0.3912 - val_loss: 3.4974 - val_accuracy50: 0.3368 - 159s/epoch - 41ms/step
Epoch 2/50
3903/3903 - 155s - loss: 3.2249 - accuracy50: 0.4008 - val_loss: 3.3877 - val_accuracy50: 0.3375 - 155s/epoch - 40ms/step
Epoch 3/50
3903/3903 - 153s - loss: 3.2068 - accuracy50: 0.4112 - val_loss: 3.4328 - val_accuracy50: 0.3376 - 153s/epoch - 39ms/step
Epoch 4/50
3903/3903 - 154s - loss: 3.1941 - accuracy50: 0.4189 - val_loss: 3.4447 - val_accuracy50: 0.3371 - 154s/epoch - 39ms/step
Epoch 5/50
3903/3903 - 154s - loss: 3.1865 - accuracy50: 0.4228 - val_loss: 3.4453 - val_accuracy50: 0.3391 - 154s/epoch - 39ms/step
Epoch 6/50
3903/3903 - 154s - loss: 3.1820 - accuracy50: 0.4251 - val_loss: 3.4192 - val_accuracy50: 0.3439 - 154s/epoch - 40ms/step
Epoch 7/50
3903/3903 - 153s - loss: 3.1786 - accuracy50: 0.4265 - val_loss: 3.4114 - val_accuracy50: 0.3454 - 153s/epoch - 39ms/step
Epoch 8/50
3903/3903 - 155s - loss: 3.1752 - accuracy50: 0.4279 - val_loss: 3.4036 - val_accuracy50: 0.3468 - 155s/epoch - 40ms/step
Epoch 9/50
3903/3903 - 154s - loss: 3.1736 - accuracy50: 0.4287 - val_loss: 3.4279 - val_accuracy50: 0.3467 - 154s/epoch - 39ms/step
Epoch 10/50
3903/3903 - 155s - loss: 3.1714 - accuracy50: 0.4296 - val_loss: 3.4289 - val_accuracy50: 0.3463 - 155s/epoch - 40ms/step
Epoch 11/50
3903/3903 - 155s - loss: 3.1688 - accuracy50: 0.4311 - val_loss: 3.4001 - val_accuracy50: 0.3474 - 155s/epoch - 40ms/step
Epoch 12/50
3903/3903 - 154s - loss: 3.1665 - accuracy50: 0.4319 - val_loss: 3.4080 - val_accuracy50: 0.3468 - 154s/epoch - 40ms/step
testing model: results/AAPL/W8/deepLOB_L2/h50
Evaluating performance on  test set...
10609/10609 - 141s - 141s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1454034
{'0': {'precision': 0.3215248363496342, 'recall': 0.004657680040251281, 'f1-score': 0.009182342630042865, 'support': 896369}, '1': {'precision': 0.32991781041841023, 'recall': 0.9895246991053973, 'f1-score': 0.4948481191523992, 'support': 897158}, '2': {'precision': 0.2969185310257493, 'recall': 0.0038138924584261865, 'f1-score': 0.007531049250535332, 'support': 922155}, 'accuracy': 0.32973374644012077, 'macro avg': {'precision': 0.31612039259793123, 'recall': 0.33266542386802495, 'f1-score': 0.17052050367765914, 'support': 2715682}, 'weighted avg': {'precision': 0.31594207531341856, 'recall': 0.32973374644012077, 'f1-score': 0.1690671112763219, 'support': 2715682}}
[[  4175 888426   3768]
 [  4838 887760   4560]
 [  3972 914666   3517]]
Evaluating performance on  train set...
3903/3903 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1410788
{'0': {'precision': 0.3505037374065648, 'recall': 0.012754709840699173, 'f1-score': 0.024613734395326017, 'support': 338228}, '1': {'precision': 0.32185883404248344, 'recall': 0.9753972863101209, 'f1-score': 0.484006555643995, 'support': 321997}, '2': {'precision': 0.31968187220038397, 'recall': 0.010320566170264256, 'f1-score': 0.019995597194784102, 'support': 338838}, 'accuracy': 0.32218789005297965, 'macro avg': {'precision': 0.3306814812164774, 'recall': 0.3328241874403614, 'f1-score': 0.17620529574470167, 'support': 999063}, 'weighted avg': {'precision': 0.33081809985292104, 'recall': 0.32218789005297965, 'f1-score': 0.17110931064111876, 'support': 999063}}
[[  4314 330289   3625]
 [  4105 314075   3817]
 [  3889 331452   3497]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1339667
{'0': {'precision': 0.353441802252816, 'recall': 0.014427006702632009, 'f1-score': 0.027722422374272335, 'support': 97872}, '1': {'precision': 0.3371556243622673, 'recall': 0.9724471777385374, 'f1-score': 0.5007106503495772, 'support': 98538}, '2': {'precision': 0.3349141824751581, 'recall': 0.015412115606455837, 'f1-score': 0.029468162263663552, 'support': 96223}, 'accuracy': 0.3373440452717226, 'macro avg': {'precision': 0.34183720303008047, 'recall': 0.3340954333492084, 'f1-score': 0.18596707832917103, 'support': 292633}, 'weighted avg': {'precision': 0.3418655598097407, 'recall': 0.3373440452717226, 'f1-score': 0.18756527788820096, 'support': 292633}}
[[ 1412 94935  1525]
 [ 1295 95823  1420]
 [ 1288 93452  1483]]
training model: results/AAPL/W8/deepLOB_L2/h100
Epoch 1/50
3903/3903 - 159s - loss: 3.2539 - accuracy100: 0.3875 - val_loss: 3.3944 - val_accuracy100: 0.3165 - 159s/epoch - 41ms/step
Epoch 2/50
3903/3903 - 155s - loss: 3.2404 - accuracy100: 0.3959 - val_loss: 3.3388 - val_accuracy100: 0.3340 - 155s/epoch - 40ms/step
Epoch 3/50
3903/3903 - 157s - loss: 3.2294 - accuracy100: 0.4034 - val_loss: 3.3349 - val_accuracy100: 0.3430 - 157s/epoch - 40ms/step
Epoch 4/50
3903/3903 - 156s - loss: 3.2229 - accuracy100: 0.4070 - val_loss: 3.3569 - val_accuracy100: 0.3439 - 156s/epoch - 40ms/step
Epoch 5/50
3903/3903 - 156s - loss: 3.2181 - accuracy100: 0.4098 - val_loss: 3.3757 - val_accuracy100: 0.3483 - 156s/epoch - 40ms/step
Epoch 6/50
3903/3903 - 160s - loss: 3.2150 - accuracy100: 0.4121 - val_loss: 3.3932 - val_accuracy100: 0.3444 - 160s/epoch - 41ms/step
Epoch 7/50
3903/3903 - 159s - loss: 3.2103 - accuracy100: 0.4139 - val_loss: 3.4108 - val_accuracy100: 0.3446 - 159s/epoch - 41ms/step
Epoch 8/50
3903/3903 - 158s - loss: 3.2069 - accuracy100: 0.4162 - val_loss: 3.4281 - val_accuracy100: 0.3450 - 158s/epoch - 41ms/step
Epoch 9/50
3903/3903 - 160s - loss: 3.2039 - accuracy100: 0.4173 - val_loss: 3.4454 - val_accuracy100: 0.3443 - 160s/epoch - 41ms/step
Epoch 10/50
3903/3903 - 161s - loss: 3.2022 - accuracy100: 0.4187 - val_loss: 3.4444 - val_accuracy100: 0.3460 - 161s/epoch - 41ms/step
Epoch 11/50
3903/3903 - 159s - loss: 3.1998 - accuracy100: 0.4194 - val_loss: 3.4521 - val_accuracy100: 0.3450 - 159s/epoch - 41ms/step
Epoch 12/50
3903/3903 - 161s - loss: 3.1978 - accuracy100: 0.4204 - val_loss: 3.4695 - val_accuracy100: 0.3450 - 161s/epoch - 41ms/step
Epoch 13/50
3903/3903 - 161s - loss: 3.1960 - accuracy100: 0.4217 - val_loss: 3.4684 - val_accuracy100: 0.3458 - 161s/epoch - 41ms/step
testing model: results/AAPL/W8/deepLOB_L2/h100
Evaluating performance on  test set...
10609/10609 - 149s - 149s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1320578
{'0': {'precision': 0.35044370976161476, 'recall': 0.2709217907042134, 'f1-score': 0.30559417064020167, 'support': 988706}, '1': {'precision': 0.2560375911467452, 'recall': 0.6239578086821873, 'f1-score': 0.36308520327093746, 'support': 720717}, '2': {'precision': 0.38566372589249076, 'recall': 0.07472131926273455, 'f1-score': 0.12518783002932854, 'support': 1006259}, 'accuracy': 0.2919148854689172, 'macro avg': {'precision': 0.3307150089336169, 'recall': 0.3232003062163784, 'f1-score': 0.26462240131348924, 'support': 2715682}, 'weighted avg': {'precision': 0.3384394926338679, 'recall': 0.2919148854689172, 'f1-score': 0.25400464751774826, 'support': 2715682}}
[[267862 647332  73512]
 [224761 449697  46259]
 [271728 659342  75189]]
Evaluating performance on  train set...
3903/3903 - 57s - 57s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.117155
{'0': {'precision': 0.3300372626580924, 'recall': 0.5775328351279709, 'f1-score': 0.4200388630382879, 'support': 333865}, '1': {'precision': 0.32483097175571934, 'recall': 0.3853249984827335, 'f1-score': 0.3525014192498866, 'support': 329540}, '2': {'precision': 0.3890723631955186, 'recall': 0.027727627525636213, 'f1-score': 0.051766093125571844, 'support': 335658}, 'accuracy': 0.32941366059998217, 'macro avg': {'precision': 0.34798019920311013, 'recall': 0.33019515371211355, 'f1-score': 0.2747687918045821, 'support': 999063}, 'weighted avg': {'precision': 0.34815416086393464, 'recall': 0.32941366059998217, 'f1-score': 0.2740320640382326, 'support': 999063}}
[[192818 131493   9554]
 [197500 126980   5060]
 [193913 132438   9307]]
Evaluating performance on  val set...
1144/1144 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1125034
{'0': {'precision': 0.35003587790473034, 'recall': 0.6280864044687868, 'f1-score': 0.44954047147307863, 'support': 100967}, '1': {'precision': 0.32834191390051887, 'recall': 0.3533234891516399, 'f1-score': 0.3403749409449841, 'support': 92779}, '2': {'precision': 0.3715268817204301, 'recall': 0.04367611516175028, 'f1-score': 0.07816345736209641, 'support': 98887}, 'accuracy': 0.343488260039025, 'macro avg': {'precision': 0.34996822450855974, 'recall': 0.3416953362607256, 'f1-score': 0.28935962326005304, 'support': 292633}, 'weighted avg': {'precision': 0.3504201018575189, 'recall': 0.343488260039025, 'f1-score': 0.2894333490663139, 'support': 292633}}
[[63416 33142  4409]
 [57101 32781  2897]
 [60653 33915  4319]]
training model: results/AAPL/W8/deepLOB_L2/h200
Epoch 1/50
3903/3903 - 164s - loss: 3.2319 - accuracy200: 0.3997 - val_loss: 3.4462 - val_accuracy200: 0.3178 - 164s/epoch - 42ms/step
Epoch 2/50
3903/3903 - 161s - loss: 3.2098 - accuracy200: 0.4116 - val_loss: 3.4921 - val_accuracy200: 0.3174 - 161s/epoch - 41ms/step
Epoch 3/50
3903/3903 - 158s - loss: 3.2003 - accuracy200: 0.4184 - val_loss: 3.5344 - val_accuracy200: 0.3223 - 158s/epoch - 40ms/step
Epoch 4/50
3903/3903 - 158s - loss: 3.1941 - accuracy200: 0.4227 - val_loss: 3.5850 - val_accuracy200: 0.3203 - 158s/epoch - 40ms/step
Epoch 5/50
3903/3903 - 157s - loss: 3.1893 - accuracy200: 0.4244 - val_loss: 3.5832 - val_accuracy200: 0.3208 - 157s/epoch - 40ms/step
Epoch 6/50
3903/3903 - 156s - loss: 3.1849 - accuracy200: 0.4267 - val_loss: 3.5998 - val_accuracy200: 0.3219 - 156s/epoch - 40ms/step
Epoch 7/50
3903/3903 - 157s - loss: 3.1819 - accuracy200: 0.4284 - val_loss: 3.6118 - val_accuracy200: 0.3244 - 157s/epoch - 40ms/step
Epoch 8/50
3903/3903 - 157s - loss: 3.1788 - accuracy200: 0.4297 - val_loss: 3.6210 - val_accuracy200: 0.3278 - 157s/epoch - 40ms/step
Epoch 9/50
3903/3903 - 158s - loss: 3.1769 - accuracy200: 0.4304 - val_loss: 3.6163 - val_accuracy200: 0.3298 - 158s/epoch - 41ms/step
Epoch 10/50
3903/3903 - 159s - loss: 3.1742 - accuracy200: 0.4314 - val_loss: 3.6389 - val_accuracy200: 0.3343 - 159s/epoch - 41ms/step
Epoch 11/50
3903/3903 - 161s - loss: 3.1718 - accuracy200: 0.4326 - val_loss: 3.6591 - val_accuracy200: 0.3379 - 161s/epoch - 41ms/step
testing model: results/AAPL/W8/deepLOB_L2/h200
Evaluating performance on  test set...
10609/10609 - 145s - 145s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1841297
{'0': {'precision': 0.33440771271285546, 'recall': 0.02318084080966857, 'f1-score': 0.04335626449762074, 'support': 1011525}, '1': {'precision': 0.25387725774671804, 'recall': 0.9470811307745346, 'f1-score': 0.4004174709845823, 'support': 696160}, '2': {'precision': 0.36179238483556764, 'recall': 0.01742961536591875, 'f1-score': 0.03325704788568162, 'support': 1007997}, 'accuracy': 0.2578862326295936, 'macro avg': {'precision': 0.31669245176504707, 'recall': 0.32923052898337396, 'f1-score': 0.15901026112262823, 'support': 2715682}, 'weighted avg': {'precision': 0.32392842456956444, 'recall': 0.2578862326295936, 'f1-score': 0.1311396461530496, 'support': 2715682}}
[[ 23448 970220  17857]
 [ 23705 659320  13135]
 [ 22965 967463  17569]]
Evaluating performance on  train set...
3903/3903 - 55s - 55s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1485567
{'0': {'precision': 0.3093138686131387, 'recall': 0.06333529624525837, 'f1-score': 0.10514171155501852, 'support': 334537}, '1': {'precision': 0.3221302936397668, 'recall': 0.8985213300971767, 'f1-score': 0.47424004405072306, 'support': 325901}, '2': {'precision': 0.3287028433376696, 'recall': 0.02089331856773717, 'f1-score': 0.03928929415325323, 'support': 338625}, 'accuracy': 0.32139314537721847, 'macro avg': {'precision': 0.320049001863525, 'recall': 0.3275833149700574, 'f1-score': 0.20622368325299825, 'support': 999063}, 'weighted avg': {'precision': 0.3200664210534727, 'recall': 0.32139314537721847, 'f1-score': 0.20322385533975462, 'support': 999063}}
[[ 21188 306437   6912]
 [ 25535 292829   7537]
 [ 21777 309773   7075]]
Evaluating performance on  val set...
1144/1144 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1531322
{'0': {'precision': 0.33893925099470856, 'recall': 0.08191813143780546, 'f1-score': 0.13194621870209505, 'support': 100869}, '1': {'precision': 0.31488136100234326, 'recall': 0.8883995715166795, 'f1-score': 0.4649628505413854, 'support': 92419}, '2': {'precision': 0.32218520986009325, 'recall': 0.024339423222104785, 'f1-score': 0.04525970987365465, 'support': 99345}, 'accuracy': 0.3170729206890542, 'macro avg': {'precision': 0.32533527395238165, 'recall': 0.33155237539219656, 'f1-score': 0.2140562597057117, 'support': 292633}, 'weighted avg': {'precision': 0.3256535438061045, 'recall': 0.3170729206890542, 'f1-score': 0.20769021503331528, 'support': 292633}}
[[ 8263 90024  2582]
 [ 7809 82105  2505]
 [ 8307 88620  2418]]
training model: results/AAPL/W8/deepLOB_L2/h300
Epoch 1/50
3903/3903 - 160s - loss: 3.2400 - accuracy300: 0.3988 - val_loss: 3.4441 - val_accuracy300: 0.3146 - 160s/epoch - 41ms/step
Epoch 2/50
3903/3903 - 157s - loss: 3.2144 - accuracy300: 0.4115 - val_loss: 3.5813 - val_accuracy300: 0.3147 - 157s/epoch - 40ms/step
Epoch 3/50
3903/3903 - 157s - loss: 3.2014 - accuracy300: 0.4189 - val_loss: 3.6007 - val_accuracy300: 0.3274 - 157s/epoch - 40ms/step
Epoch 4/50
3903/3903 - 157s - loss: 3.1953 - accuracy300: 0.4228 - val_loss: 3.6623 - val_accuracy300: 0.3227 - 157s/epoch - 40ms/step
Epoch 5/50
3903/3903 - 156s - loss: 3.1907 - accuracy300: 0.4257 - val_loss: 3.7126 - val_accuracy300: 0.3209 - 156s/epoch - 40ms/step
Epoch 6/50
3903/3903 - 157s - loss: 3.1865 - accuracy300: 0.4273 - val_loss: 3.7145 - val_accuracy300: 0.3205 - 157s/epoch - 40ms/step
Epoch 7/50
3903/3903 - 156s - loss: 3.1820 - accuracy300: 0.4297 - val_loss: 3.7688 - val_accuracy300: 0.3169 - 156s/epoch - 40ms/step
Epoch 8/50
3903/3903 - 157s - loss: 3.1779 - accuracy300: 0.4316 - val_loss: 3.7532 - val_accuracy300: 0.3201 - 157s/epoch - 40ms/step
Epoch 9/50
3903/3903 - 157s - loss: 3.1744 - accuracy300: 0.4330 - val_loss: 3.7354 - val_accuracy300: 0.3228 - 157s/epoch - 40ms/step
Epoch 10/50
3903/3903 - 157s - loss: 3.1715 - accuracy300: 0.4334 - val_loss: 3.6599 - val_accuracy300: 0.3211 - 157s/epoch - 40ms/step
Epoch 11/50
3903/3903 - 157s - loss: 3.1673 - accuracy300: 0.4358 - val_loss: 3.5672 - val_accuracy300: 0.3208 - 157s/epoch - 40ms/step
testing model: results/AAPL/W8/deepLOB_L2/h300
Evaluating performance on  test set...
10609/10609 - 146s - 146s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1786737
{'0': {'precision': 0.3466733892145123, 'recall': 0.016009049352342666, 'f1-score': 0.030604798065269345, 'support': 1030792}, '1': {'precision': 0.2444432314244948, 'recall': 0.9666120043290173, 'f1-score': 0.39020806796624685, 'support': 667126}, '2': {'precision': 0.358591071012418, 'recall': 0.010583003525375235, 'f1-score': 0.02055924741434681, 'support': 1017764}, 'accuracy': 0.247497681981911, 'macro avg': {'precision': 0.31656923055047503, 'recall': 0.33106801906891176, 'f1-score': 0.14712403781528768, 'support': 2715682}, 'weighted avg': {'precision': 0.32602627046185295, 'recall': 0.247497681981911, 'f1-score': 0.11517901965059264, 'support': 2715682}}
[[  16502 1002995   11295]
 [  14303  644852    7971]
 [  16796  990197   10771]]
Evaluating performance on  train set...
3903/3903 - 55s - 55s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1422589
{'0': {'precision': 0.30741242172956507, 'recall': 0.03281299393355512, 'f1-score': 0.05929669839421777, 'support': 332155}, '1': {'precision': 0.32852127899098016, 'recall': 0.9420819225394593, 'f1-score': 0.487160677281719, 'support': 329897}, '2': {'precision': 0.33397793197588443, 'recall': 0.017423763616024403, 'f1-score': 0.03311966113262248, 'support': 337011}, 'accuracy': 0.32786821251512666, 'macro avg': {'precision': 0.32330387756547657, 'recall': 0.3307728933630129, 'f1-score': 0.19319234560285306, 'support': 999063}, 'weighted avg': {'precision': 0.32334396744549226, 'recall': 0.32786821251512666, 'f1-score': 0.19174990058315133, 'support': 999063}}
[[ 10899 315508   5748]
 [ 13145 310790   5962]
 [ 11410 319729   5872]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.150815
{'0': {'precision': 0.33601518026565463, 'recall': 0.04378399762634754, 'f1-score': 0.07747298420615129, 'support': 101110}, '1': {'precision': 0.3123676959933669, 'recall': 0.9289104179622296, 'f1-score': 0.467520701091612, 'support': 91659}, '2': {'precision': 0.35076252723311546, 'recall': 0.02418288872867099, 'f1-score': 0.04524632549251047, 'support': 99864}, 'accuracy': 0.3143357037654673, 'macro avg': {'precision': 0.33304846783071235, 'recall': 0.33229243477241605, 'f1-score': 0.1967466702634246, 'support': 292633}, 'weighted avg': {'precision': 0.3336409582764903, 'recall': 0.3143357037654673, 'f1-score': 0.18864670909782588, 'support': 292633}}
[[ 4427 94346  2337]
 [ 4383 85143  2133]
 [ 4365 93084  2415]]
training model: results/AAPL/W8/deepLOB_L2/h500
Epoch 1/50
3903/3903 - 159s - loss: 3.2251 - accuracy500: 0.4094 - val_loss: 3.4680 - val_accuracy500: 0.3352 - 159s/epoch - 41ms/step
Epoch 2/50
3903/3903 - 156s - loss: 3.1855 - accuracy500: 0.4271 - val_loss: 3.5225 - val_accuracy500: 0.3384 - 156s/epoch - 40ms/step
Epoch 3/50
3903/3903 - 156s - loss: 3.1711 - accuracy500: 0.4347 - val_loss: 3.5059 - val_accuracy500: 0.3399 - 156s/epoch - 40ms/step
Epoch 4/50
3903/3903 - 156s - loss: 3.1640 - accuracy500: 0.4383 - val_loss: 3.5402 - val_accuracy500: 0.3395 - 156s/epoch - 40ms/step
Epoch 5/50
3903/3903 - 156s - loss: 3.1575 - accuracy500: 0.4412 - val_loss: 3.5264 - val_accuracy500: 0.3370 - 156s/epoch - 40ms/step
Epoch 6/50
3903/3903 - 156s - loss: 3.1506 - accuracy500: 0.4441 - val_loss: 3.5723 - val_accuracy500: 0.3358 - 156s/epoch - 40ms/step
Epoch 7/50
3903/3903 - 157s - loss: 3.1450 - accuracy500: 0.4465 - val_loss: 3.5823 - val_accuracy500: 0.3346 - 157s/epoch - 40ms/step
Epoch 8/50
3903/3903 - 156s - loss: 3.1399 - accuracy500: 0.4485 - val_loss: 3.6073 - val_accuracy500: 0.3335 - 156s/epoch - 40ms/step
Epoch 9/50
3903/3903 - 156s - loss: 3.1342 - accuracy500: 0.4509 - val_loss: 3.5908 - val_accuracy500: 0.3325 - 156s/epoch - 40ms/step
Epoch 10/50
3903/3903 - 156s - loss: 3.1308 - accuracy500: 0.4517 - val_loss: 3.5983 - val_accuracy500: 0.3379 - 156s/epoch - 40ms/step
Epoch 11/50
3903/3903 - 156s - loss: 3.1266 - accuracy500: 0.4530 - val_loss: 3.5771 - val_accuracy500: 0.3371 - 156s/epoch - 40ms/step
testing model: results/AAPL/W8/deepLOB_L2/h500
Evaluating performance on  test set...
10609/10609 - 147s - 147s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1525207
{'0': {'precision': 0.35383347381639774, 'recall': 0.2219177787701505, 'f1-score': 0.2727634137523916, 'support': 1023361}, '1': {'precision': 0.2380592182962582, 'recall': 0.6330486343167002, 'f1-score': 0.3460032246911825, 'support': 676621}, '2': {'precision': 0.36371979866993964, 'recall': 0.09832430835876735, 'f1-score': 0.1548012282662442, 'support': 1015700}, 'accuracy': 0.2781268204451037, 'macro avg': {'precision': 0.31853749692753186, 'recall': 0.31776357381520604, 'f1-score': 0.25785595556993945, 'support': 2715682}, 'weighted avg': {'precision': 0.32868555429174434, 'recall': 0.2781268204451037, 'f1-score': 0.24689197605053098, 'support': 2715682}}
[[227102 691956 104303]
 [177884 428334  70403]
 [236847 678985  99868]]
Evaluating performance on  train set...
3903/3903 - 55s - 55s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1558082
{'0': {'precision': 0.3229264151724709, 'recall': 0.472047941163118, 'f1-score': 0.38350104808915825, 'support': 330405}, '1': {'precision': 0.3159454106839993, 'recall': 0.36428259100460336, 'f1-score': 0.3383965744846495, 'support': 329324}, '2': {'precision': 0.34039963336388634, 'recall': 0.13680326757707745, 'f1-score': 0.19516973612019112, 'support': 339334}, 'accuracy': 0.3226583308560121, 'macro avg': {'precision': 0.32642381974011886, 'recall': 0.3243779332482663, 'f1-score': 0.30568911956466627, 'support': 999063}, 'weighted avg': {'precision': 0.3265600646015903, 'recall': 0.3226583308560121, 'f1-score': 0.3046659765461137, 'support': 999063}}
[[155967 129284  45154]
 [164558 119967  44799]
 [162455 130457  46422]]
Evaluating performance on  val set...
1144/1144 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1588457
{'0': {'precision': 0.34031576545113795, 'recall': 0.4917606851272622, 'f1-score': 0.4022561000531328, 'support': 100069}, '1': {'precision': 0.3161740504245935, 'recall': 0.3619987940910461, 'f1-score': 0.33753821286763414, 'support': 92876}, '2': {'precision': 0.35917975776472, 'recall': 0.15022871358638953, 'f1-score': 0.21185008098569133, 'support': 99688}, 'accuracy': 0.33423093089296146, 'macro avg': {'precision': 0.3385565245468172, 'recall': 0.3346627309348993, 'f1-score': 0.3172147979688194, 'support': 292633}, 'weighted avg': {'precision': 0.3390798410712868, 'recall': 0.33423093089296146, 'f1-score': 0.31685242473614705, 'support': 292633}}
[[49210 36419 14440]
 [46976 33621 12279]
 [48415 36297 14976]]
training model: results/AAPL/W8/deepLOB_L2/h1000
Epoch 1/50
3903/3903 - 160s - loss: 3.1985 - accuracy1000: 0.4252 - val_loss: 3.8688 - val_accuracy1000: 0.3376 - 160s/epoch - 41ms/step
Epoch 2/50
3903/3903 - 157s - loss: 3.1313 - accuracy1000: 0.4510 - val_loss: 3.9564 - val_accuracy1000: 0.3331 - 157s/epoch - 40ms/step
Epoch 3/50
3903/3903 - 157s - loss: 3.1075 - accuracy1000: 0.4609 - val_loss: 4.0463 - val_accuracy1000: 0.3335 - 157s/epoch - 40ms/step
Epoch 4/50
3903/3903 - 157s - loss: 3.0931 - accuracy1000: 0.4665 - val_loss: 3.8743 - val_accuracy1000: 0.3373 - 157s/epoch - 40ms/step
Epoch 5/50
3903/3903 - 157s - loss: 3.0831 - accuracy1000: 0.4696 - val_loss: 3.8599 - val_accuracy1000: 0.3377 - 157s/epoch - 40ms/step
Epoch 6/50
3903/3903 - 157s - loss: 3.0724 - accuracy1000: 0.4732 - val_loss: 3.9015 - val_accuracy1000: 0.3370 - 157s/epoch - 40ms/step
Epoch 7/50
3903/3903 - 157s - loss: 3.0647 - accuracy1000: 0.4757 - val_loss: 3.8362 - val_accuracy1000: 0.3353 - 157s/epoch - 40ms/step
Epoch 8/50
3903/3903 - 158s - loss: 3.0589 - accuracy1000: 0.4771 - val_loss: 3.9017 - val_accuracy1000: 0.3339 - 158s/epoch - 41ms/step
Epoch 9/50
3903/3903 - 157s - loss: 3.0518 - accuracy1000: 0.4791 - val_loss: 3.7727 - val_accuracy1000: 0.3338 - 157s/epoch - 40ms/step
Epoch 10/50
3903/3903 - 157s - loss: 3.0448 - accuracy1000: 0.4819 - val_loss: 3.8500 - val_accuracy1000: 0.3345 - 157s/epoch - 40ms/step
Epoch 11/50
3903/3903 - 157s - loss: 3.0403 - accuracy1000: 0.4829 - val_loss: 3.9213 - val_accuracy1000: 0.3350 - 157s/epoch - 40ms/step
Epoch 12/50
3903/3903 - 157s - loss: 3.0348 - accuracy1000: 0.4847 - val_loss: 3.9168 - val_accuracy1000: 0.3358 - 157s/epoch - 40ms/step
Epoch 13/50
3903/3903 - 157s - loss: 3.0307 - accuracy1000: 0.4866 - val_loss: 3.9741 - val_accuracy1000: 0.3376 - 157s/epoch - 40ms/step
Epoch 14/50
3903/3903 - 157s - loss: 3.0264 - accuracy1000: 0.4877 - val_loss: 4.0728 - val_accuracy1000: 0.3374 - 157s/epoch - 40ms/step
Epoch 15/50
3903/3903 - 156s - loss: 3.0212 - accuracy1000: 0.4891 - val_loss: 4.1535 - val_accuracy1000: 0.3371 - 156s/epoch - 40ms/step
Epoch 16/50
3903/3903 - 157s - loss: 3.0176 - accuracy1000: 0.4899 - val_loss: 4.1184 - val_accuracy1000: 0.3384 - 157s/epoch - 40ms/step
Epoch 17/50
3903/3903 - 157s - loss: 3.0139 - accuracy1000: 0.4917 - val_loss: 4.2738 - val_accuracy1000: 0.3372 - 157s/epoch - 40ms/step
Epoch 18/50
3903/3903 - 156s - loss: 3.0108 - accuracy1000: 0.4918 - val_loss: 4.2363 - val_accuracy1000: 0.3390 - 156s/epoch - 40ms/step
Epoch 19/50
3903/3903 - 157s - loss: 3.0070 - accuracy1000: 0.4926 - val_loss: 4.2257 - val_accuracy1000: 0.3387 - 157s/epoch - 40ms/step
testing model: results/AAPL/W8/deepLOB_L2/h1000
Evaluating performance on  test set...
10609/10609 - 150s - 150s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2285314
{'0': {'precision': 0.34187002132471034, 'recall': 0.31691943963375224, 'f1-score': 0.3289222490844838, 'support': 1004129}, '1': {'precision': 0.24306320211994178, 'recall': 0.5145817290864543, 'f1-score': 0.33017018308302265, 'support': 714250}, '2': {'precision': 0.37087855676151366, 'recall': 0.10141952846827895, 'f1-score': 0.15928215473263083, 'support': 997303}, 'accuracy': 0.2897666221597374, 'macro avg': {'precision': 0.3186039267353886, 'recall': 0.31097356572949514, 'f1-score': 0.27279152896671244, 'support': 2715682}, 'weighted avg': {'precision': 0.3265359464218772, 'recall': 0.2897666221597374, 'f1-score': 0.26695209272636466, 'support': 2715682}}
[[318228 581879 104022]
 [279158 367540  67552]
 [333459 562698 101146]]
Evaluating performance on  train set...
3903/3903 - 57s - 57s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2492766
{'0': {'precision': 0.3176161284826995, 'recall': 0.6773120937922371, 'f1-score': 0.4324437485809988, 'support': 324803}, '1': {'precision': 0.2982125018597632, 'recall': 0.2120143371775344, 'f1-score': 0.2478322231701738, 'support': 330888}, '2': {'precision': 0.36017139645967966, 'recall': 0.07466246519809419, 'f1-score': 0.12368532777552636, 'support': 343372}, 'accuracy': 0.31607916617870946, 'macro avg': {'precision': 0.3253333422673808, 'recall': 0.3213296320559552, 'f1-score': 0.26798709984223296, 'support': 999063}, 'weighted avg': {'precision': 0.32581567172449855, 'recall': 0.31607916617870946, 'f1-score': 0.26518228970507834, 'support': 999063}}
[[219993  81549  23261]
 [238453  70153  22282]
 [234192  83543  25637]]
Evaluating performance on  val set...
1144/1144 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2676526
{'0': {'precision': 0.33931107397734045, 'recall': 0.7645099424649238, 'f1-score': 0.4700158554332009, 'support': 99070}, '1': {'precision': 0.2953172657137731, 'recall': 0.1589382657768813, 'f1-score': 0.20665555315305262, 'support': 93206}, '2': {'precision': 0.3673193787981094, 'recall': 0.07046842771306436, 'f1-score': 0.11825098235933448, 'support': 100357}, 'accuracy': 0.33361240871672027, 'macro avg': {'precision': 0.333982572829741, 'recall': 0.3313055453182898, 'f1-score': 0.264974130315196, 'support': 292633}, 'weighted avg': {'precision': 0.33490399259514453, 'recall': 0.33361240871672027, 'f1-score': 0.2654974733594173, 'support': 292633}}
[[75740 16697  6633]
 [72844 14814  5548]
 [74633 18652  7072]]
training model: results/AAPL/W8/deepOF_L2/h10
Epoch 1/50
3903/3903 - 124s - loss: 3.1619 - accuracy10: 0.4364 - val_loss: 3.2798 - val_accuracy10: 0.3883 - 124s/epoch - 32ms/step
Epoch 2/50
3903/3903 - 103s - loss: 3.0936 - accuracy10: 0.4643 - val_loss: 3.2690 - val_accuracy10: 0.4012 - 103s/epoch - 26ms/step
Epoch 3/50
3903/3903 - 103s - loss: 3.0580 - accuracy10: 0.4760 - val_loss: 3.2647 - val_accuracy10: 0.4086 - 103s/epoch - 26ms/step
Epoch 4/50
3903/3903 - 103s - loss: 3.0386 - accuracy10: 0.4815 - val_loss: 3.2466 - val_accuracy10: 0.4175 - 103s/epoch - 26ms/step
Epoch 5/50
3903/3903 - 105s - loss: 3.0265 - accuracy10: 0.4848 - val_loss: 3.2436 - val_accuracy10: 0.4208 - 105s/epoch - 27ms/step
Epoch 6/50
3903/3903 - 103s - loss: 3.0175 - accuracy10: 0.4880 - val_loss: 3.2335 - val_accuracy10: 0.4252 - 103s/epoch - 26ms/step
Epoch 7/50
3903/3903 - 102s - loss: 3.0104 - accuracy10: 0.4900 - val_loss: 3.2223 - val_accuracy10: 0.4278 - 102s/epoch - 26ms/step
Epoch 8/50
3903/3903 - 102s - loss: 3.0044 - accuracy10: 0.4916 - val_loss: 3.2285 - val_accuracy10: 0.4289 - 102s/epoch - 26ms/step
Epoch 9/50
3903/3903 - 104s - loss: 2.9992 - accuracy10: 0.4930 - val_loss: 3.2192 - val_accuracy10: 0.4315 - 104s/epoch - 27ms/step
Epoch 10/50
3903/3903 - 103s - loss: 2.9948 - accuracy10: 0.4946 - val_loss: 3.2190 - val_accuracy10: 0.4336 - 103s/epoch - 26ms/step
Epoch 11/50
3903/3903 - 103s - loss: 2.9910 - accuracy10: 0.4957 - val_loss: 3.2178 - val_accuracy10: 0.4333 - 103s/epoch - 26ms/step
Epoch 12/50
3903/3903 - 104s - loss: 2.9869 - accuracy10: 0.4968 - val_loss: 3.2092 - val_accuracy10: 0.4340 - 104s/epoch - 27ms/step
Epoch 13/50
3903/3903 - 105s - loss: 2.9835 - accuracy10: 0.4982 - val_loss: 3.2086 - val_accuracy10: 0.4364 - 105s/epoch - 27ms/step
Epoch 14/50
3903/3903 - 103s - loss: 2.9803 - accuracy10: 0.4992 - val_loss: 3.1951 - val_accuracy10: 0.4389 - 103s/epoch - 26ms/step
Epoch 15/50
3903/3903 - 103s - loss: 2.9772 - accuracy10: 0.4993 - val_loss: 3.2012 - val_accuracy10: 0.4386 - 103s/epoch - 26ms/step
Epoch 16/50
3903/3903 - 105s - loss: 2.9749 - accuracy10: 0.5006 - val_loss: 3.2017 - val_accuracy10: 0.4390 - 105s/epoch - 27ms/step
Epoch 17/50
3903/3903 - 103s - loss: 2.9721 - accuracy10: 0.5012 - val_loss: 3.2003 - val_accuracy10: 0.4393 - 103s/epoch - 26ms/step
Epoch 18/50
3903/3903 - 102s - loss: 2.9699 - accuracy10: 0.5020 - val_loss: 3.1974 - val_accuracy10: 0.4398 - 102s/epoch - 26ms/step
Epoch 19/50
3903/3903 - 103s - loss: 2.9672 - accuracy10: 0.5027 - val_loss: 3.1965 - val_accuracy10: 0.4420 - 103s/epoch - 26ms/step
Epoch 20/50
3903/3903 - 104s - loss: 2.9655 - accuracy10: 0.5031 - val_loss: 3.1927 - val_accuracy10: 0.4420 - 104s/epoch - 27ms/step
Epoch 21/50
3903/3903 - 102s - loss: 2.9631 - accuracy10: 0.5037 - val_loss: 3.1917 - val_accuracy10: 0.4422 - 102s/epoch - 26ms/step
Epoch 22/50
3903/3903 - 103s - loss: 2.9607 - accuracy10: 0.5044 - val_loss: 3.1936 - val_accuracy10: 0.4425 - 103s/epoch - 26ms/step
Epoch 23/50
3903/3903 - 102s - loss: 2.9587 - accuracy10: 0.5049 - val_loss: 3.1896 - val_accuracy10: 0.4429 - 102s/epoch - 26ms/step
Epoch 24/50
3903/3903 - 108s - loss: 2.9570 - accuracy10: 0.5053 - val_loss: 3.1940 - val_accuracy10: 0.4425 - 108s/epoch - 28ms/step
Epoch 25/50
3903/3903 - 106s - loss: 2.9555 - accuracy10: 0.5063 - val_loss: 3.1979 - val_accuracy10: 0.4435 - 106s/epoch - 27ms/step
Epoch 26/50
3903/3903 - 103s - loss: 2.9534 - accuracy10: 0.5065 - val_loss: 3.1943 - val_accuracy10: 0.4446 - 103s/epoch - 26ms/step
Epoch 27/50
3903/3903 - 103s - loss: 2.9514 - accuracy10: 0.5070 - val_loss: 3.1920 - val_accuracy10: 0.4452 - 103s/epoch - 26ms/step
Epoch 28/50
3903/3903 - 103s - loss: 2.9495 - accuracy10: 0.5075 - val_loss: 3.1890 - val_accuracy10: 0.4468 - 103s/epoch - 26ms/step
Epoch 29/50
3903/3903 - 102s - loss: 2.9478 - accuracy10: 0.5083 - val_loss: 3.1893 - val_accuracy10: 0.4469 - 102s/epoch - 26ms/step
Epoch 30/50
3903/3903 - 103s - loss: 2.9464 - accuracy10: 0.5086 - val_loss: 3.1957 - val_accuracy10: 0.4461 - 103s/epoch - 26ms/step
Epoch 31/50
3903/3903 - 107s - loss: 2.9444 - accuracy10: 0.5087 - val_loss: 3.1909 - val_accuracy10: 0.4463 - 107s/epoch - 27ms/step
Epoch 32/50
3903/3903 - 104s - loss: 2.9431 - accuracy10: 0.5096 - val_loss: 3.1924 - val_accuracy10: 0.4462 - 104s/epoch - 27ms/step
Epoch 33/50
3903/3903 - 103s - loss: 2.9418 - accuracy10: 0.5099 - val_loss: 3.1957 - val_accuracy10: 0.4459 - 103s/epoch - 26ms/step
Epoch 34/50
3903/3903 - 103s - loss: 2.9400 - accuracy10: 0.5104 - val_loss: 3.1908 - val_accuracy10: 0.4480 - 103s/epoch - 26ms/step
Epoch 35/50
3903/3903 - 103s - loss: 2.9385 - accuracy10: 0.5108 - val_loss: 3.2068 - val_accuracy10: 0.4459 - 103s/epoch - 26ms/step
Epoch 36/50
3903/3903 - 103s - loss: 2.9366 - accuracy10: 0.5113 - val_loss: 3.1931 - val_accuracy10: 0.4474 - 103s/epoch - 26ms/step
Epoch 37/50
3903/3903 - 102s - loss: 2.9349 - accuracy10: 0.5119 - val_loss: 3.2029 - val_accuracy10: 0.4477 - 102s/epoch - 26ms/step
Epoch 38/50
3903/3903 - 103s - loss: 2.9334 - accuracy10: 0.5121 - val_loss: 3.1870 - val_accuracy10: 0.4500 - 103s/epoch - 26ms/step
Epoch 39/50
3903/3903 - 106s - loss: 2.9321 - accuracy10: 0.5121 - val_loss: 3.1865 - val_accuracy10: 0.4499 - 106s/epoch - 27ms/step
Epoch 40/50
3903/3903 - 103s - loss: 2.9310 - accuracy10: 0.5126 - val_loss: 3.1853 - val_accuracy10: 0.4490 - 103s/epoch - 26ms/step
Epoch 41/50
3903/3903 - 103s - loss: 2.9298 - accuracy10: 0.5130 - val_loss: 3.1883 - val_accuracy10: 0.4487 - 103s/epoch - 26ms/step
Epoch 42/50
3903/3903 - 105s - loss: 2.9277 - accuracy10: 0.5137 - val_loss: 3.2010 - val_accuracy10: 0.4481 - 105s/epoch - 27ms/step
Epoch 43/50
3903/3903 - 103s - loss: 2.9271 - accuracy10: 0.5139 - val_loss: 3.1971 - val_accuracy10: 0.4476 - 103s/epoch - 26ms/step
Epoch 44/50
3903/3903 - 103s - loss: 2.9258 - accuracy10: 0.5140 - val_loss: 3.1936 - val_accuracy10: 0.4490 - 103s/epoch - 26ms/step
Epoch 45/50
3903/3903 - 104s - loss: 2.9237 - accuracy10: 0.5147 - val_loss: 3.2076 - val_accuracy10: 0.4473 - 104s/epoch - 27ms/step
Epoch 46/50
3903/3903 - 105s - loss: 2.9227 - accuracy10: 0.5154 - val_loss: 3.1923 - val_accuracy10: 0.4488 - 105s/epoch - 27ms/step
Epoch 47/50
3903/3903 - 104s - loss: 2.9212 - accuracy10: 0.5157 - val_loss: 3.1946 - val_accuracy10: 0.4488 - 104s/epoch - 27ms/step
Epoch 48/50
3903/3903 - 103s - loss: 2.9207 - accuracy10: 0.5155 - val_loss: 3.1956 - val_accuracy10: 0.4489 - 103s/epoch - 26ms/step
Epoch 49/50
3903/3903 - 104s - loss: 2.9189 - accuracy10: 0.5161 - val_loss: 3.2145 - val_accuracy10: 0.4473 - 104s/epoch - 27ms/step
Epoch 50/50
3903/3903 - 103s - loss: 2.9174 - accuracy10: 0.5165 - val_loss: 3.2109 - val_accuracy10: 0.4462 - 103s/epoch - 26ms/step
testing model: results/AAPL/W8/deepOF_L2/h10
Evaluating performance on  test set...
10609/10609 - 128s - 128s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0850099
{'0': {'precision': 0.47779651979354354, 'recall': 0.3137673364764041, 'f1-score': 0.37878672757940923, 'support': 873880}, '1': {'precision': 0.41658700703267176, 'recall': 0.6981893294608174, 'f1-score': 0.5218205546363042, 'support': 940646}, '2': {'precision': 0.4840492902933643, 'recall': 0.30365055356982346, 'f1-score': 0.37319249482595784, 'support': 901151}, 'accuracy': 0.44356490112778507, 'macro avg': {'precision': 0.45947760570652657, 'recall': 0.43853573983568167, 'f1-score': 0.4245999256805571, 'support': 2715677}, 'weighted avg': {'precision': 0.4586698736748118, 'recall': 0.44356490112778507, 'f1-score': 0.42647389687301607, 'support': 2715677}}
[[274195 448225 151460]
 [143688 656749 140209]
 [155991 471525 273635]]
Evaluating performance on  train set...
3903/3903 - 48s - 48s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0347571
{'0': {'precision': 0.530447629482368, 'recall': 0.31892252801135057, 'f1-score': 0.3983462274477099, 'support': 335489}, '1': {'precision': 0.42572509909422307, 'recall': 0.6551137076945217, 'f1-score': 0.5160775989434773, 'support': 326583}, '2': {'precision': 0.5050627028897263, 'recall': 0.4418350692898899, 'f1-score': 0.47133792238913697, 'support': 336990}, 'accuracy': 0.47027912181626363, 'macro avg': {'precision': 0.4870784771554391, 'recall': 0.471957101665254, 'f1-score': 0.46192058292677474, 'support': 999062}, 'weighted avg': {'precision': 0.4876524230245047, 'recall': 0.4702791218162636, 'f1-score': 0.461451956396978, 'support': 999062}}
[[106995 152997  75497]
 [ 42222 213949  70412]
 [ 52490 135606 148894]]
Evaluating performance on  val set...
1144/1144 - 14s - 14s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0647677
{'0': {'precision': 0.5096760265840157, 'recall': 0.3324214782110207, 'f1-score': 0.4023934454170268, 'support': 99431}, '1': {'precision': 0.4006987514557322, 'recall': 0.6292397660818714, 'f1-score': 0.4896128930843627, 'support': 94050}, '2': {'precision': 0.48942439755275313, 'recall': 0.39533241891237697, 'f1-score': 0.43737516876624905, 'support': 99152}, 'accuracy': 0.44913253119094565, 'macro avg': {'precision': 0.4665997251975003, 'recall': 0.452331221068423, 'f1-score': 0.44312716908921285, 'support': 292633}, 'weighted avg': {'precision': 0.46778976547360507, 'recall': 0.44913253119094565, 'f1-score': 0.4422778633966634, 'support': 292633}}
[[33053 45633 20745]
 [14723 59180 20147]
 [17075 42879 39198]]
training model: results/AAPL/W8/deepOF_L2/h20
Epoch 1/50
3903/3903 - 105s - loss: 3.2152 - accuracy20: 0.4126 - val_loss: 3.3323 - val_accuracy20: 0.3557 - 105s/epoch - 27ms/step
Epoch 2/50
3903/3903 - 103s - loss: 3.1684 - accuracy20: 0.4328 - val_loss: 3.3252 - val_accuracy20: 0.3616 - 103s/epoch - 26ms/step
Epoch 3/50
3903/3903 - 103s - loss: 3.1423 - accuracy20: 0.4428 - val_loss: 3.3307 - val_accuracy20: 0.3641 - 103s/epoch - 26ms/step
Epoch 4/50
3903/3903 - 103s - loss: 3.1277 - accuracy20: 0.4486 - val_loss: 3.3444 - val_accuracy20: 0.3635 - 103s/epoch - 26ms/step
Epoch 5/50
3903/3903 - 103s - loss: 3.1186 - accuracy20: 0.4519 - val_loss: 3.3380 - val_accuracy20: 0.3657 - 103s/epoch - 26ms/step
Epoch 6/50
3903/3903 - 102s - loss: 3.1127 - accuracy20: 0.4536 - val_loss: 3.3319 - val_accuracy20: 0.3694 - 102s/epoch - 26ms/step
Epoch 7/50
3903/3903 - 103s - loss: 3.1075 - accuracy20: 0.4554 - val_loss: 3.3389 - val_accuracy20: 0.3723 - 103s/epoch - 26ms/step
Epoch 8/50
3903/3903 - 102s - loss: 3.1032 - accuracy20: 0.4572 - val_loss: 3.3371 - val_accuracy20: 0.3733 - 102s/epoch - 26ms/step
Epoch 9/50
3903/3903 - 103s - loss: 3.0999 - accuracy20: 0.4583 - val_loss: 3.3407 - val_accuracy20: 0.3755 - 103s/epoch - 26ms/step
Epoch 10/50
3903/3903 - 104s - loss: 3.0966 - accuracy20: 0.4596 - val_loss: 3.3245 - val_accuracy20: 0.3790 - 104s/epoch - 27ms/step
Epoch 11/50
3903/3903 - 103s - loss: 3.0937 - accuracy20: 0.4606 - val_loss: 3.3356 - val_accuracy20: 0.3805 - 103s/epoch - 26ms/step
Epoch 12/50
3903/3903 - 102s - loss: 3.0910 - accuracy20: 0.4615 - val_loss: 3.3425 - val_accuracy20: 0.3806 - 102s/epoch - 26ms/step
Epoch 13/50
3903/3903 - 102s - loss: 3.0884 - accuracy20: 0.4621 - val_loss: 3.3187 - val_accuracy20: 0.3834 - 102s/epoch - 26ms/step
Epoch 14/50
3903/3903 - 106s - loss: 3.0857 - accuracy20: 0.4632 - val_loss: 3.3267 - val_accuracy20: 0.3863 - 106s/epoch - 27ms/step
Epoch 15/50
3903/3903 - 103s - loss: 3.0836 - accuracy20: 0.4638 - val_loss: 3.3385 - val_accuracy20: 0.3859 - 103s/epoch - 26ms/step
Epoch 16/50
3903/3903 - 103s - loss: 3.0818 - accuracy20: 0.4649 - val_loss: 3.3471 - val_accuracy20: 0.3865 - 103s/epoch - 26ms/step
Epoch 17/50
3903/3903 - 103s - loss: 3.0797 - accuracy20: 0.4656 - val_loss: 3.3283 - val_accuracy20: 0.3898 - 103s/epoch - 26ms/step
Epoch 18/50
3903/3903 - 103s - loss: 3.0772 - accuracy20: 0.4663 - val_loss: 3.3299 - val_accuracy20: 0.3901 - 103s/epoch - 26ms/step
Epoch 19/50
3903/3903 - 104s - loss: 3.0759 - accuracy20: 0.4669 - val_loss: 3.3253 - val_accuracy20: 0.3897 - 104s/epoch - 27ms/step
Epoch 20/50
3903/3903 - 104s - loss: 3.0736 - accuracy20: 0.4677 - val_loss: 3.3412 - val_accuracy20: 0.3907 - 104s/epoch - 27ms/step
Epoch 21/50
3903/3903 - 105s - loss: 3.0718 - accuracy20: 0.4684 - val_loss: 3.3425 - val_accuracy20: 0.3900 - 105s/epoch - 27ms/step
Epoch 22/50
3903/3903 - 106s - loss: 3.0703 - accuracy20: 0.4689 - val_loss: 3.3297 - val_accuracy20: 0.3914 - 106s/epoch - 27ms/step
Epoch 23/50
3903/3903 - 104s - loss: 3.0683 - accuracy20: 0.4699 - val_loss: 3.3283 - val_accuracy20: 0.3932 - 104s/epoch - 27ms/step
testing model: results/AAPL/W8/deepOF_L2/h20
Evaluating performance on  test set...
10609/10609 - 130s - 130s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1319319
{'0': {'precision': 0.4675477863168099, 'recall': 0.23111334506157327, 'f1-score': 0.3093245867524581, 'support': 895275}, '1': {'precision': 0.3463499515035961, 'recall': 0.7465694505192108, 'f1-score': 0.4731808997128576, 'support': 893953}, '2': {'precision': 0.4618342109900141, 'recall': 0.17257398950185063, 'f1-score': 0.2512595903306209, 'support': 926449}, 'accuracy': 0.380821798763255, 'macro avg': {'precision': 0.42524398293680665, 'recall': 0.3834189283608782, 'f1-score': 0.34458835893197887, 'support': 2715677}, 'weighted avg': {'precision': 0.42570241804484255, 'recall': 0.380821798763255, 'f1-score': 0.3434544131897971, 'support': 2715677}}
[[206910 598880  89485]
 [129734 667398  96821]
 [105899 660669 159881]]
Evaluating performance on  train set...
3903/3903 - 48s - 48s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.091941
{'0': {'precision': 0.49934709526852444, 'recall': 0.21519783042080498, 'f1-score': 0.3007744024633613, 'support': 334074}, '1': {'precision': 0.3517933059834918, 'recall': 0.7613582134465684, 'f1-score': 0.48122958693563883, 'support': 328991}, '2': {'precision': 0.5023727818508398, 'recall': 0.21393048152215643, 'f1-score': 0.30007639674541514, 'support': 335997}, 'accuracy': 0.39462215558193586, 'macro avg': {'precision': 0.45117106103428534, 'recall': 0.39682884179650996, 'f1-score': 0.3606934620481384, 'support': 999062}, 'weighted avg': {'precision': 0.4517752257788692, 'recall': 0.39462215558193586, 'f1-score': 0.3599635256283964, 'support': 999062}}
[[ 71892 230150  32032]
 [ 39342 250480  39169]
 [ 32738 231379  71880]]
Evaluating performance on  val set...
1144/1144 - 14s - 14s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1079409
{'0': {'precision': 0.4888402332491789, 'recall': 0.22118660345123886, 'f1-score': 0.30456570155902, 'support': 98921}, '1': {'precision': 0.3415625419857584, 'recall': 0.7464816795654271, 'f1-score': 0.46867613460538193, 'support': 95358}, '2': {'precision': 0.48256903977704585, 'recall': 0.19365760416454847, 'f1-score': 0.2763959832830276, 'support': 98354}, 'accuracy': 0.38310785181438867, 'macro avg': {'precision': 0.43765727167066104, 'recall': 0.38710862906040483, 'f1-score': 0.3498792731491432, 'support': 292633}, 'weighted avg': {'precision': 0.43874026828878343, 'recall': 0.38310785181438867, 'f1-score': 0.34857522271048974, 'support': 292633}}
[[21880 67944  9097]
 [12849 71183 11326]
 [10030 69277 19047]]
training model: results/AAPL/W8/deepOF_L2/h30
Epoch 1/50
3903/3903 - 109s - loss: 3.2341 - accuracy30: 0.4017 - val_loss: 3.3396 - val_accuracy30: 0.3367 - 109s/epoch - 28ms/step
Epoch 2/50
3903/3903 - 105s - loss: 3.2002 - accuracy30: 0.4177 - val_loss: 3.3308 - val_accuracy30: 0.3427 - 105s/epoch - 27ms/step
Epoch 3/50
3903/3903 - 103s - loss: 3.1807 - accuracy30: 0.4261 - val_loss: 3.3428 - val_accuracy30: 0.3444 - 103s/epoch - 26ms/step
Epoch 4/50
3903/3903 - 102s - loss: 3.1693 - accuracy30: 0.4310 - val_loss: 3.3404 - val_accuracy30: 0.3465 - 102s/epoch - 26ms/step
Epoch 5/50
3903/3903 - 103s - loss: 3.1618 - accuracy30: 0.4340 - val_loss: 3.3414 - val_accuracy30: 0.3482 - 103s/epoch - 26ms/step
Epoch 6/50
3903/3903 - 103s - loss: 3.1565 - accuracy30: 0.4363 - val_loss: 3.3405 - val_accuracy30: 0.3510 - 103s/epoch - 26ms/step
Epoch 7/50
3903/3903 - 103s - loss: 3.1523 - accuracy30: 0.4383 - val_loss: 3.3477 - val_accuracy30: 0.3513 - 103s/epoch - 26ms/step
Epoch 8/50
3903/3903 - 103s - loss: 3.1485 - accuracy30: 0.4397 - val_loss: 3.3545 - val_accuracy30: 0.3511 - 103s/epoch - 26ms/step
Epoch 9/50
3903/3903 - 105s - loss: 3.1454 - accuracy30: 0.4409 - val_loss: 3.3528 - val_accuracy30: 0.3531 - 105s/epoch - 27ms/step
Epoch 10/50
3903/3903 - 102s - loss: 3.1426 - accuracy30: 0.4423 - val_loss: 3.3513 - val_accuracy30: 0.3553 - 102s/epoch - 26ms/step
Epoch 11/50
3903/3903 - 102s - loss: 3.1403 - accuracy30: 0.4432 - val_loss: 3.3606 - val_accuracy30: 0.3545 - 102s/epoch - 26ms/step
Epoch 12/50
3903/3903 - 103s - loss: 3.1377 - accuracy30: 0.4446 - val_loss: 3.3610 - val_accuracy30: 0.3564 - 103s/epoch - 26ms/step
testing model: results/AAPL/W8/deepOF_L2/h30
Evaluating performance on  test set...
10609/10609 - 133s - 133s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1216929
{'0': {'precision': 0.4380050444548025, 'recall': 0.10898567061935008, 'f1-score': 0.17454143987834803, 'support': 922580}, '1': {'precision': 0.31084306782992077, 'recall': 0.8711377041265479, 'f1-score': 0.4581920837930226, 'support': 832633}, '2': {'precision': 0.480611015039564, 'recall': 0.07639224374885473, 'f1-score': 0.13183030163646947, 'support': 960464}, 'accuracy': 0.33113584568415166, 'macro avg': {'precision': 0.40981970910809573, 'recall': 0.3521718728315842, 'f1-score': 0.2548546084359467, 'support': 2715677}, 'weighted avg': {'precision': 0.414085499843502, 'recall': 0.33113584568415166, 'f1-score': 0.24640358545540286, 'support': 2715677}}
[[100548 784991  37041]
 [ 65044 725338  42251]
 [ 63967 823125  73372]]
Evaluating performance on  train set...
3903/3903 - 51s - 51s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1087985
{'0': {'precision': 0.4376763077499327, 'recall': 0.11182319781090659, 'f1-score': 0.17813433440205043, 'support': 334385}, '1': {'precision': 0.3333780770109339, 'recall': 0.8624763158055063, 'f1-score': 0.48087910594789224, 'support': 328278}, '2': {'precision': 0.4838920229381323, 'recall': 0.09255972817992919, 'f1-score': 0.1553951879744277, 'support': 336399}, 'accuracy': 0.35199116771531697, 'macro avg': {'precision': 0.4183154692329996, 'recall': 0.3556197472654474, 'f1-score': 0.27146954277479013, 'support': 999062}, 'weighted avg': {'precision': 0.4189668640748236, 'recall': 0.35199116771531697, 'f1-score': 0.26995548463538926, 'support': 999062}}
[[ 37392 283741  13252]
 [ 25188 283132  19958]
 [ 22853 282409  31137]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1123136
{'0': {'precision': 0.4364454883538853, 'recall': 0.11159489920525294, 'f1-score': 0.17774270432280334, 'support': 99906}, '1': {'precision': 0.3248722643787531, 'recall': 0.863557142553508, 'f1-score': 0.47212861392581573, 'support': 94098}, '2': {'precision': 0.4693432378257281, 'recall': 0.08071662492775958, 'f1-score': 0.13774428805010772, 'support': 98629}, 'accuracy': 0.3429859243489285, 'macro avg': {'precision': 0.4102203301861222, 'recall': 0.35195622222884015, 'f1-score': 0.26253853543290895, 'support': 292633}, 'weighted avg': {'precision': 0.4116562639774356, 'recall': 0.3429859243489285, 'f1-score': 0.258923300917393, 'support': 292633}}
[[11149 85027  3730]
 [ 7568 81259  5271]
 [ 6828 83840  7961]]
training model: results/AAPL/W8/deepOF_L2/h50
Epoch 1/50
3903/3903 - 106s - loss: 3.2355 - accuracy50: 0.4011 - val_loss: 3.4868 - val_accuracy50: 0.3387 - 106s/epoch - 27ms/step
Epoch 2/50
3903/3903 - 104s - loss: 3.2114 - accuracy50: 0.4128 - val_loss: 3.5230 - val_accuracy50: 0.3384 - 104s/epoch - 27ms/step
Epoch 3/50
3903/3903 - 103s - loss: 3.1945 - accuracy50: 0.4215 - val_loss: 3.5279 - val_accuracy50: 0.3388 - 103s/epoch - 26ms/step
Epoch 4/50
3903/3903 - 104s - loss: 3.1833 - accuracy50: 0.4260 - val_loss: 3.5380 - val_accuracy50: 0.3391 - 104s/epoch - 27ms/step
Epoch 5/50
3903/3903 - 103s - loss: 3.1759 - accuracy50: 0.4291 - val_loss: 3.5435 - val_accuracy50: 0.3388 - 103s/epoch - 26ms/step
Epoch 6/50
3903/3903 - 102s - loss: 3.1712 - accuracy50: 0.4317 - val_loss: 3.5521 - val_accuracy50: 0.3389 - 102s/epoch - 26ms/step
Epoch 7/50
3903/3903 - 103s - loss: 3.1674 - accuracy50: 0.4331 - val_loss: 3.5490 - val_accuracy50: 0.3391 - 103s/epoch - 26ms/step
Epoch 8/50
3903/3903 - 104s - loss: 3.1645 - accuracy50: 0.4346 - val_loss: 3.5478 - val_accuracy50: 0.3392 - 104s/epoch - 27ms/step
Epoch 9/50
3903/3903 - 103s - loss: 3.1618 - accuracy50: 0.4359 - val_loss: 3.5421 - val_accuracy50: 0.3393 - 103s/epoch - 26ms/step
Epoch 10/50
3903/3903 - 104s - loss: 3.1592 - accuracy50: 0.4372 - val_loss: 3.5413 - val_accuracy50: 0.3395 - 104s/epoch - 27ms/step
Epoch 11/50
3903/3903 - 103s - loss: 3.1568 - accuracy50: 0.4382 - val_loss: 3.5364 - val_accuracy50: 0.3397 - 103s/epoch - 26ms/step
testing model: results/AAPL/W8/deepOF_L2/h50
Evaluating performance on  test set...
10609/10609 - 131s - 131s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1717055
{'0': {'precision': 0.38919033190050034, 'recall': 0.006161552492567202, 'f1-score': 0.012131049600463894, 'support': 896365}, '1': {'precision': 0.33067413788737154, 'recall': 0.9896918822458054, 'f1-score': 0.495719376211685, 'support': 897157}, '2': {'precision': 0.44993267229771083, 'recall': 0.007971544913816008, 'f1-score': 0.015665540392949123, 'support': 922155}, 'accuracy': 0.3316973999485211, 'macro avg': {'precision': 0.38993238069519426, 'recall': 0.33460832655072953, 'f1-score': 0.174505322068366, 'support': 2715677}, 'weighted avg': {'precision': 0.3904849040593959, 'recall': 0.3316973999485211, 'f1-score': 0.1730905454073244, 'support': 2715677}}
[[  5523 886733   4109]
 [  4370 887909   4878]
 [  4298 910506   7351]]
Evaluating performance on  train set...
3903/3903 - 51s - 51s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1837813
{'0': {'precision': 0.39339513325608344, 'recall': 0.008038404394485584, 'f1-score': 0.015754882795505566, 'support': 337878}, '1': {'precision': 0.32291966379924747, 'recall': 0.9854792318885996, 'f1-score': 0.4864428169290193, 'support': 322297}, '2': {'precision': 0.43816295605548433, 'recall': 0.011092192972878865, 'f1-score': 0.021636649341230507, 'support': 338887}, 'accuracy': 0.3243962837141238, 'macro avg': {'precision': 0.3848259177036051, 'recall': 0.3348699430853213, 'f1-score': 0.17461144968858514, 'support': 999062}, 'weighted avg': {'precision': 0.38584525225319344, 'recall': 0.3243962837141238, 'f1-score': 0.16959374697691787, 'support': 999062}}
[[  2716 332945   2217]
 [  2077 317617   2603]
 [  2111 333017   3759]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1704261
{'0': {'precision': 0.3824091778202677, 'recall': 0.010226308200476547, 'f1-score': 0.0199199219139061, 'support': 97787}, '1': {'precision': 0.33771151960272916, 'recall': 0.9831241141931565, 'f1-score': 0.5027307411567989, 'support': 98780}, '2': {'precision': 0.3986156351791531, 'recall': 0.010190910415755835, 'f1-score': 0.01987373378534744, 'support': 96066}, 'accuracy': 0.33862209661931497, 'macro avg': {'precision': 0.37291211086738335, 'recall': 0.33451377760312967, 'f1-score': 0.18084146561868417, 'support': 292633}, 'weighted avg': {'precision': 0.3726414990345881, 'recall': 0.33862209661931497, 'f1-score': 0.18288040694483168, 'support': 292633}}
[[ 1000 96114   673]
 [  863 97113   804]
 [  752 94335   979]]
training model: results/AAPL/W8/deepOF_L2/h100
Epoch 1/50
3903/3903 - 105s - loss: 3.2549 - accuracy100: 0.3917 - val_loss: 3.3877 - val_accuracy100: 0.3195 - 105s/epoch - 27ms/step
Epoch 2/50
3903/3903 - 105s - loss: 3.2360 - accuracy100: 0.4020 - val_loss: 3.3611 - val_accuracy100: 0.3190 - 105s/epoch - 27ms/step
Epoch 3/50
3903/3903 - 103s - loss: 3.2223 - accuracy100: 0.4090 - val_loss: 3.3841 - val_accuracy100: 0.3191 - 103s/epoch - 26ms/step
Epoch 4/50
3903/3903 - 104s - loss: 3.2137 - accuracy100: 0.4125 - val_loss: 3.3952 - val_accuracy100: 0.3196 - 104s/epoch - 27ms/step
Epoch 5/50
3903/3903 - 105s - loss: 3.2095 - accuracy100: 0.4146 - val_loss: 3.3988 - val_accuracy100: 0.3193 - 105s/epoch - 27ms/step
Epoch 6/50
3903/3903 - 103s - loss: 3.2066 - accuracy100: 0.4160 - val_loss: 3.4063 - val_accuracy100: 0.3193 - 103s/epoch - 26ms/step
Epoch 7/50
3903/3903 - 103s - loss: 3.2049 - accuracy100: 0.4170 - val_loss: 3.4129 - val_accuracy100: 0.3189 - 103s/epoch - 26ms/step
Epoch 8/50
3903/3903 - 104s - loss: 3.2024 - accuracy100: 0.4177 - val_loss: 3.4167 - val_accuracy100: 0.3190 - 104s/epoch - 27ms/step
Epoch 9/50
3903/3903 - 102s - loss: 3.2005 - accuracy100: 0.4186 - val_loss: 3.4190 - val_accuracy100: 0.3193 - 102s/epoch - 26ms/step
Epoch 10/50
3903/3903 - 103s - loss: 3.1991 - accuracy100: 0.4191 - val_loss: 3.4179 - val_accuracy100: 0.3191 - 103s/epoch - 26ms/step
Epoch 11/50
3903/3903 - 106s - loss: 3.1971 - accuracy100: 0.4203 - val_loss: 3.4214 - val_accuracy100: 0.3190 - 106s/epoch - 27ms/step
Epoch 12/50
3903/3903 - 105s - loss: 3.1954 - accuracy100: 0.4211 - val_loss: 3.4209 - val_accuracy100: 0.3191 - 105s/epoch - 27ms/step
testing model: results/AAPL/W8/deepOF_L2/h100
Evaluating performance on  test set...
10609/10609 - 134s - 134s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1422274
{'0': {'precision': 0.44071363015691806, 'recall': 0.019912976812022226, 'f1-score': 0.038104269989113336, 'support': 988702}, '1': {'precision': 0.26579256955491004, 'recall': 0.9721069048002264, 'f1-score': 0.4174471311469305, 'support': 720716}, '2': {'precision': 0.46467988022244405, 'recall': 0.016192650202383283, 'f1-score': 0.031294774729094886, 'support': 1006259}, 'accuracy': 0.27123807433652825, 'macro avg': {'precision': 0.3903953599780907, 'recall': 0.3360708439382107, 'f1-score': 0.16228205862171288, 'support': 2715677}, 'weighted avg': {'precision': 0.40317155417065365, 'recall': 0.27123807433652825, 'f1-score': 0.13625524804407585, 'support': 2715677}}
[[ 19688 959124   9890]
 [ 11222 700613   8881]
 [ 13763 976202  16294]]
Evaluating performance on  train set...
3903/3903 - 50s - 50s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1152508
{'0': {'precision': 0.3873640600725013, 'recall': 0.026882219580055166, 'f1-score': 0.05027543387486593, 'support': 333901}, '1': {'precision': 0.330238812842731, 'recall': 0.9578508357894545, 'f1-score': 0.49114519820483754, 'support': 329449}, '2': {'precision': 0.4144613871126414, 'recall': 0.025098894290344103, 'f1-score': 0.0473314945989518, 'support': 335712}, 'accuracy': 0.33327761440230935, 'macro avg': {'precision': 0.3773547533426245, 'recall': 0.33661064988661793, 'f1-score': 0.1962507088928851, 'support': 999062}, 'weighted avg': {'precision': 0.37763197365614165, 'recall': 0.33327761440230935, 'f1-score': 0.19466666009160638, 'support': 999062}}
[[  8976 319682   5243]
 [  7225 315563   6661]
 [  6971 320315   8426]]
Evaluating performance on  val set...
1144/1144 - 14s - 14s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1220329
{'0': {'precision': 0.38162698992259386, 'recall': 0.025861812999198312, 'f1-score': 0.0484409180230618, 'support': 101037}, '1': {'precision': 0.31659236258492746, 'recall': 0.9585664844583885, 'f1-score': 0.47597964553682093, 'support': 92751}, '2': {'precision': 0.3947156111335216, 'recall': 0.019798674692700694, 'f1-score': 0.03770603932448966, 'support': 98845}, 'accuracy': 0.31943765740705937, 'macro avg': {'precision': 0.36431165454701436, 'recall': 0.3347423240500959, 'f1-score': 0.1873755342947908, 'support': 292633}, 'weighted avg': {'precision': 0.36543509783727973, 'recall': 0.31943765740705937, 'f1-score': 0.18032472959136855, 'support': 292633}}
[[ 2613 97021  1403]
 [ 2245 88908  1598]
 [ 1989 94899  1957]]
training model: results/AAPL/W8/deepOF_L2/h200
Epoch 1/50
3903/3903 - 106s - loss: 3.2489 - accuracy200: 0.3895 - val_loss: 3.4565 - val_accuracy200: 0.3158 - 106s/epoch - 27ms/step
Epoch 2/50
3903/3903 - 104s - loss: 3.2332 - accuracy200: 0.3971 - val_loss: 3.4993 - val_accuracy200: 0.3157 - 104s/epoch - 27ms/step
Epoch 3/50
3903/3903 - 103s - loss: 3.2200 - accuracy200: 0.4029 - val_loss: 3.5218 - val_accuracy200: 0.3160 - 103s/epoch - 26ms/step
Epoch 4/50
3903/3903 - 103s - loss: 3.2108 - accuracy200: 0.4070 - val_loss: 3.5239 - val_accuracy200: 0.3159 - 103s/epoch - 26ms/step
Epoch 5/50
3903/3903 - 103s - loss: 3.2068 - accuracy200: 0.4093 - val_loss: 3.5410 - val_accuracy200: 0.3158 - 103s/epoch - 26ms/step
Epoch 6/50
3903/3903 - 105s - loss: 3.2043 - accuracy200: 0.4109 - val_loss: 3.5557 - val_accuracy200: 0.3158 - 105s/epoch - 27ms/step
Epoch 7/50
3903/3903 - 103s - loss: 3.2024 - accuracy200: 0.4121 - val_loss: 3.5512 - val_accuracy200: 0.3158 - 103s/epoch - 27ms/step
Epoch 8/50
3903/3903 - 103s - loss: 3.2004 - accuracy200: 0.4135 - val_loss: 3.5533 - val_accuracy200: 0.3158 - 103s/epoch - 26ms/step
Epoch 9/50
3903/3903 - 103s - loss: 3.1992 - accuracy200: 0.4146 - val_loss: 3.5614 - val_accuracy200: 0.3156 - 103s/epoch - 26ms/step
Epoch 10/50
3903/3903 - 104s - loss: 3.1979 - accuracy200: 0.4153 - val_loss: 3.5573 - val_accuracy200: 0.3158 - 104s/epoch - 27ms/step
Epoch 11/50
3903/3903 - 104s - loss: 3.1963 - accuracy200: 0.4159 - val_loss: 3.5685 - val_accuracy200: 0.3157 - 104s/epoch - 27ms/step
testing model: results/AAPL/W8/deepOF_L2/h200
Evaluating performance on  test set...
10609/10609 - 138s - 138s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1931137
{'0': {'precision': 0.39292791917621916, 'recall': 0.009996816678233395, 'f1-score': 0.019497578710001476, 'support': 1011522}, '1': {'precision': 0.25639528574952625, 'recall': 0.9809051968087704, 'f1-score': 0.406529330222144, 'support': 696158}, '2': {'precision': 0.3933415999699395, 'recall': 0.01038495154251451, 'f1-score': 0.020235644349078395, 'support': 1007997}, 'accuracy': 0.25903117344220244, 'macro avg': {'precision': 0.34755493496522827, 'recall': 0.33376232167650616, 'f1-score': 0.1487541844270746, 'support': 2715677}, 'weighted avg': {'precision': 0.35808161896377416, 'recall': 0.25903117344220244, 'f1-score': 0.11898629479044207, 'support': 2715677}}
[[ 10112 991882   9528]
 [  6676 682865   6617]
 [  8947 988582  10468]]
Evaluating performance on  train set...
3903/3903 - 48s - 48s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1497976
{'0': {'precision': 0.353395913859746, 'recall': 0.013398651760666583, 'f1-score': 0.025818423865905563, 'support': 334362}, '1': {'precision': 0.32659587156529285, 'recall': 0.9737672251260749, 'f1-score': 0.489137774519987, 'support': 326195}, '2': {'precision': 0.3513356982552668, 'recall': 0.014336568145226805, 'f1-score': 0.027548975641324032, 'support': 338505}, 'accuracy': 0.327277986751573, 'macro avg': {'precision': 0.34377582789343525, 'recall': 0.33383414834398945, 'f1-score': 0.1808350580090722, 'support': 999062}, 'weighted avg': {'precision': 0.34394761827905795, 'recall': 0.327277986751573, 'f1-score': 0.17767912521912102, 'support': 999062}}
[[  4480 325490   4392]
 [  3989 317638   4568]
 [  4208 329444   4853]]
Evaluating performance on  val set...
1144/1144 - 14s - 14s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1565217
{'0': {'precision': 0.3662256111235703, 'recall': 0.01617953036758149, 'f1-score': 0.030989951512966248, 'support': 100930}, '1': {'precision': 0.3150795021554231, 'recall': 0.9678009592585776, 'f1-score': 0.47538995814564466, 'support': 92363}, '2': {'precision': 0.3305748154775218, 'recall': 0.014878196094221864, 'f1-score': 0.02847482444056988, 'support': 99340}, 'accuracy': 0.3160955873056012, 'macro avg': {'precision': 0.3372933095855051, 'recall': 0.332952895240127, 'f1-score': 0.1782849113663936, 'support': 292633}, 'weighted avg': {'precision': 0.33798013606743027, 'recall': 0.3160955873056012, 'f1-score': 0.17040097176441507, 'support': 292633}}
[[ 1633 97839  1458]
 [ 1439 89389  1535]
 [ 1387 96475  1478]]
training model: results/AAPL/W8/deepOF_L2/h300
Epoch 1/50
3903/3903 - 105s - loss: 3.2618 - accuracy300: 0.3836 - val_loss: 3.3839 - val_accuracy300: 0.3131 - 105s/epoch - 27ms/step
Epoch 2/50
3903/3903 - 104s - loss: 3.2469 - accuracy300: 0.3903 - val_loss: 3.3824 - val_accuracy300: 0.3131 - 104s/epoch - 27ms/step
Epoch 3/50
3903/3903 - 102s - loss: 3.2329 - accuracy300: 0.3977 - val_loss: 3.4061 - val_accuracy300: 0.3134 - 102s/epoch - 26ms/step
Epoch 4/50
3903/3903 - 103s - loss: 3.2253 - accuracy300: 0.4016 - val_loss: 3.4327 - val_accuracy300: 0.3130 - 103s/epoch - 26ms/step
Epoch 5/50
3903/3903 - 103s - loss: 3.2220 - accuracy300: 0.4036 - val_loss: 3.4435 - val_accuracy300: 0.3135 - 103s/epoch - 26ms/step
Epoch 6/50
3903/3903 - 103s - loss: 3.2200 - accuracy300: 0.4051 - val_loss: 3.4503 - val_accuracy300: 0.3132 - 103s/epoch - 27ms/step
Epoch 7/50
3903/3903 - 102s - loss: 3.2184 - accuracy300: 0.4060 - val_loss: 3.4642 - val_accuracy300: 0.3131 - 102s/epoch - 26ms/step
Epoch 8/50
3903/3903 - 102s - loss: 3.2173 - accuracy300: 0.4069 - val_loss: 3.4684 - val_accuracy300: 0.3131 - 102s/epoch - 26ms/step
Epoch 9/50
3903/3903 - 104s - loss: 3.2165 - accuracy300: 0.4077 - val_loss: 3.4682 - val_accuracy300: 0.3131 - 104s/epoch - 27ms/step
Epoch 10/50
3903/3903 - 104s - loss: 3.2155 - accuracy300: 0.4086 - val_loss: 3.4619 - val_accuracy300: 0.3131 - 104s/epoch - 27ms/step
Epoch 11/50
3903/3903 - 103s - loss: 3.2145 - accuracy300: 0.4091 - val_loss: 3.4681 - val_accuracy300: 0.3132 - 103s/epoch - 27ms/step
Epoch 12/50
3903/3903 - 104s - loss: 3.2138 - accuracy300: 0.4094 - val_loss: 3.4511 - val_accuracy300: 0.3132 - 104s/epoch - 27ms/step
testing model: results/AAPL/W8/deepOF_L2/h300
Evaluating performance on  test set...
10609/10609 - 135s - 135s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1555597
{'0': {'precision': 0.4131353091055384, 'recall': 0.011954931566917737, 'f1-score': 0.02323743937485386, 'support': 1030788}, '1': {'precision': 0.245989670109338, 'recall': 0.9824111187391887, 'f1-score': 0.39345951126737355, 'support': 667126}, '2': {'precision': 0.3912357255593724, 'recall': 0.008280906262066906, 'f1-score': 0.01621853065269579, 'support': 1017763}, 'accuracy': 0.24897769506461925, 'macro avg': {'precision': 0.35012023492474964, 'recall': 0.33421565218939114, 'f1-score': 0.14430516043164107, 'support': 2715677}, 'weighted avg': {'precision': 0.3638673779746728, 'recall': 0.24897769506461925, 'f1-score': 0.11155471139784456, 'support': 2715677}}
[[  12323 1010323    8142]
 [   6762  655392    4972]
 [  10743  998592    8428]]
Evaluating performance on  train set...
3903/3903 - 49s - 49s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1209103
{'0': {'precision': 0.3570696371215745, 'recall': 0.0157355346016124, 'f1-score': 0.030142723633049113, 'support': 332051}, '1': {'precision': 0.33067815872272127, 'recall': 0.9756847383835505, 'f1-score': 0.49394794279171284, 'support': 329834}, '2': {'precision': 0.3548731642189586, 'recall': 0.011824649961296292, 'f1-score': 0.022886697358299946, 'support': 337177}, 'accuracy': 0.3313367939126901, 'macro avg': {'precision': 0.34754032002108476, 'recall': 0.33441497431548645, 'f1-score': 0.1823257879276873, 'support': 999062}, 'weighted avg': {'precision': 0.34761536198140036, 'recall': 0.3313367939126901, 'f1-score': 0.1808162208581839, 'support': 999062}}
[[  5225 323214   3612]
 [  4384 321814   3636]
 [  5024 328166   3987]]
Evaluating performance on  val set...
1144/1144 - 14s - 14s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1290641
{'0': {'precision': 0.36981725289840833, 'recall': 0.01860382357011526, 'f1-score': 0.035425548936010014, 'support': 101162}, '1': {'precision': 0.31208755607828775, 'recall': 0.967268758526603, 'f1-score': 0.47191316363287833, 'support': 91625}, '2': {'precision': 0.3323051037577117, 'recall': 0.011868277146806081, 'f1-score': 0.022918036591498086, 'support': 99846}, 'accuracy': 0.31333786688445936, 'macro avg': {'precision': 0.33806997091146923, 'recall': 0.3325802864145081, 'f1-score': 0.1767522497201288, 'support': 292633}, 'weighted avg': {'precision': 0.3389426710356466, 'recall': 0.31333786688445936, 'f1-score': 0.16782467213486466, 'support': 292633}}
[[ 1882 98182  1098]
 [ 1716 88626  1283]
 [ 1491 97170  1185]]
training model: results/AAPL/W8/deepOF_L2/h500
Epoch 1/50
3903/3903 - 106s - loss: 3.2626 - accuracy500: 0.3838 - val_loss: 3.3888 - val_accuracy500: 0.3163 - 106s/epoch - 27ms/step
Epoch 2/50
3903/3903 - 102s - loss: 3.2480 - accuracy500: 0.3892 - val_loss: 3.3817 - val_accuracy500: 0.3166 - 102s/epoch - 26ms/step
Epoch 3/50
3903/3903 - 103s - loss: 3.2355 - accuracy500: 0.3956 - val_loss: 3.4047 - val_accuracy500: 0.3167 - 103s/epoch - 26ms/step
Epoch 4/50
3903/3903 - 105s - loss: 3.2257 - accuracy500: 0.4007 - val_loss: 3.4378 - val_accuracy500: 0.3164 - 105s/epoch - 27ms/step
Epoch 5/50
3903/3903 - 105s - loss: 3.2210 - accuracy500: 0.4026 - val_loss: 3.4698 - val_accuracy500: 0.3164 - 105s/epoch - 27ms/step
Epoch 6/50
3903/3903 - 102s - loss: 3.2187 - accuracy500: 0.4041 - val_loss: 3.4753 - val_accuracy500: 0.3165 - 102s/epoch - 26ms/step
Epoch 7/50
3903/3903 - 103s - loss: 3.2172 - accuracy500: 0.4048 - val_loss: 3.4728 - val_accuracy500: 0.3166 - 103s/epoch - 26ms/step
Epoch 8/50
3903/3903 - 105s - loss: 3.2158 - accuracy500: 0.4065 - val_loss: 3.4718 - val_accuracy500: 0.3165 - 105s/epoch - 27ms/step
Epoch 9/50
3903/3903 - 104s - loss: 3.2146 - accuracy500: 0.4075 - val_loss: 3.4711 - val_accuracy500: 0.3167 - 104s/epoch - 27ms/step
Epoch 10/50
3903/3903 - 104s - loss: 3.2136 - accuracy500: 0.4082 - val_loss: 3.4730 - val_accuracy500: 0.3164 - 104s/epoch - 27ms/step
Epoch 11/50
3903/3903 - 104s - loss: 3.2126 - accuracy500: 0.4087 - val_loss: 3.4746 - val_accuracy500: 0.3165 - 104s/epoch - 27ms/step
Epoch 12/50
3903/3903 - 105s - loss: 3.2119 - accuracy500: 0.4093 - val_loss: 3.4759 - val_accuracy500: 0.3165 - 105s/epoch - 27ms/step
testing model: results/AAPL/W8/deepOF_L2/h500
Evaluating performance on  test set...
10609/10609 - 129s - 129s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1563201
{'0': {'precision': 0.3986680155117181, 'recall': 0.00924213153376583, 'f1-score': 0.01806546007424449, 'support': 1023357}, '1': {'precision': 0.2493517495285791, 'recall': 0.9857660134196448, 'f1-score': 0.39802274316785974, 'support': 676620}, '2': {'precision': 0.3715491471777739, 'recall': 0.006241016048045683, 'f1-score': 0.012275831484728801, 'support': 1015700}, 'accuracy': 0.251423862263443, 'macro avg': {'precision': 0.33985630407269035, 'recall': 0.3337497203338187, 'f1-score': 0.14278801157561102, 'support': 2715677}, 'weighted avg': {'precision': 0.351322544582628, 'recall': 0.251423862263443, 'f1-score': 0.11056768737463067, 'support': 2715677}}
[[   9458 1007215    6684]
 [   5593  666989    4038]
 [   8673 1000688    6339]]
Evaluating performance on  train set...
3903/3903 - 49s - 49s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1225238
{'0': {'precision': 0.35692861427714456, 'recall': 0.012609366958311889, 'f1-score': 0.024358220826425015, 'support': 330310}, '1': {'precision': 0.33011437572768987, 'recall': 0.9805195593825526, 'f1-score': 0.49393441381805, 'support': 329356}, '2': {'precision': 0.36478194170501865, 'recall': 0.009808601162064372, 'f1-score': 0.01910352861512329, 'support': 339396}, 'accuracy': 0.33074423809533343, 'macro avg': {'precision': 0.35060831056995106, 'recall': 0.33431250916764294, 'f1-score': 0.1791320544198661, 'support': 999062}, 'weighted avg': {'precision': 0.3507567826631071, 'recall': 0.33074423809533343, 'f1-score': 0.17737606666702618, 'support': 999062}}
[[  4165 323141   3004]
 [  3623 322940   2793]
 [  3881 332186   3329]]
Evaluating performance on  val set...
1144/1144 - 14s - 14s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1288527
{'0': {'precision': 0.3586140053307487, 'recall': 0.014782261286456252, 'f1-score': 0.028394102468176544, 'support': 100120}, '1': {'precision': 0.3163888586775381, 'recall': 0.9719348163476461, 'f1-score': 0.4773790208383512, 'support': 92784}, '2': {'precision': 0.30629853321829165, 'recall': 0.01067893992720272, 'f1-score': 0.02063833498052439, 'support': 99729}, 'accuracy': 0.31686446846391214, 'macro avg': {'precision': 0.3271004657421928, 'recall': 0.3324653391871017, 'f1-score': 0.17547048609568405, 'support': 292633}, 'weighted avg': {'precision': 0.327396788798865, 'recall': 0.31686446846391214, 'f1-score': 0.16810883638500146, 'support': 292633}}
[[ 1480 97444  1196]
 [ 1388 90180  1216]
 [ 1259 97405  1065]]
training model: results/AAPL/W8/deepOF_L2/h1000
Epoch 1/50
3903/3903 - 106s - loss: 3.2631 - accuracy1000: 0.3842 - val_loss: 3.4028 - val_accuracy1000: 0.3178 - 106s/epoch - 27ms/step
Epoch 2/50
3903/3903 - 103s - loss: 3.2490 - accuracy1000: 0.3876 - val_loss: 3.4218 - val_accuracy1000: 0.3180 - 103s/epoch - 26ms/step
Epoch 3/50
3903/3903 - 104s - loss: 3.2346 - accuracy1000: 0.3958 - val_loss: 3.4298 - val_accuracy1000: 0.3179 - 104s/epoch - 27ms/step
Epoch 4/50
3903/3903 - 103s - loss: 3.2227 - accuracy1000: 0.4011 - val_loss: 3.4696 - val_accuracy1000: 0.3184 - 103s/epoch - 26ms/step
Epoch 5/50
3903/3903 - 103s - loss: 3.2181 - accuracy1000: 0.4034 - val_loss: 3.4923 - val_accuracy1000: 0.3183 - 103s/epoch - 26ms/step
Epoch 6/50
3903/3903 - 103s - loss: 3.2160 - accuracy1000: 0.4051 - val_loss: 3.4960 - val_accuracy1000: 0.3183 - 103s/epoch - 26ms/step
Epoch 7/50
3903/3903 - 103s - loss: 3.2146 - accuracy1000: 0.4057 - val_loss: 3.4929 - val_accuracy1000: 0.3185 - 103s/epoch - 26ms/step
Epoch 8/50
3903/3903 - 104s - loss: 3.2134 - accuracy1000: 0.4062 - val_loss: 3.4995 - val_accuracy1000: 0.3183 - 104s/epoch - 27ms/step
Epoch 9/50
3903/3903 - 104s - loss: 3.2122 - accuracy1000: 0.4076 - val_loss: 3.5011 - val_accuracy1000: 0.3184 - 104s/epoch - 27ms/step
Epoch 10/50
3903/3903 - 107s - loss: 3.2111 - accuracy1000: 0.4079 - val_loss: 3.5034 - val_accuracy1000: 0.3185 - 107s/epoch - 28ms/step
Epoch 11/50
3903/3903 - 103s - loss: 3.2102 - accuracy1000: 0.4087 - val_loss: 3.4958 - val_accuracy1000: 0.3184 - 103s/epoch - 26ms/step
testing model: results/AAPL/W8/deepOF_L2/h1000
Evaluating performance on  test set...
10609/10609 - 134s - 134s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1582935
{'0': {'precision': 0.3798871088237736, 'recall': 0.009115398979210756, 'f1-score': 0.017803600205792736, 'support': 1004125}, '1': {'precision': 0.2631584275426004, 'recall': 0.9826713335666784, 'f1-score': 0.41514218235137196, 'support': 714250}, '2': {'precision': 0.36492174410526745, 'recall': 0.008954158319145053, 'f1-score': 0.01747942057580304, 'support': 997302}, 'accuracy': 0.26511105702187704, 'macro avg': {'precision': 0.3359890934905471, 'recall': 0.3335802969550114, 'f1-score': 0.1501417343776559, 'support': 2715677}, 'weighted avg': {'precision': 0.34369044450413117, 'recall': 0.26511105702187704, 'f1-score': 0.12218853895371157, 'support': 2715677}}
[[  9153 985573   9399]
 [  6235 701873   6142]
 [  8706 979666   8930]]
Evaluating performance on  train set...
3903/3903 - 49s - 49s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1279123
{'0': {'precision': 0.3331926388654398, 'recall': 0.012151682055102813, 'f1-score': 0.02344819801756684, 'support': 324811}, '1': {'precision': 0.3316145738221915, 'recall': 0.9767887415877697, 'f1-score': 0.4951338451086853, 'support': 330917}, '2': {'precision': 0.36476526197724723, 'recall': 0.013261139298758643, 'f1-score': 0.025591878948670096, 'support': 343334}, 'accuracy': 0.33204746051796585, 'macro avg': {'precision': 0.34319082488829283, 'recall': 0.3340671876472104, 'f1-score': 0.1813913073583074, 'support': 999062}, 'weighted avg': {'precision': 0.3435200724316776, 'recall': 0.33204746051796585, 'f1-score': 0.18042023561608528, 'support': 999062}}
[[  3947 316767   4097]
 [  3849 323236   3832]
 [  4050 334731   4553]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.134926
{'0': {'precision': 0.34331476323119775, 'recall': 0.01493019452660482, 'f1-score': 0.02861592934051795, 'support': 99061}, '1': {'precision': 0.31732178078331924, 'recall': 0.9667464294528559, 'f1-score': 0.4778090386701069, 'support': 93193}, '2': {'precision': 0.3080590238365494, 'recall': 0.01351876388487632, 'f1-score': 0.0259009009009009, 'support': 100379}, 'accuracy': 0.3175650046303732, 'macro avg': {'precision': 0.3228985226170221, 'recall': 0.33173179595477903, 'f1-score': 0.17744195630384194, 'support': 292633}, 'weighted avg': {'precision': 0.32294351365250856, 'recall': 0.3175650046303732, 'f1-score': 0.17073633817346592, 'support': 292633}}
[[ 1479 96058  1524]
 [ 1575 90094  1524]
 [ 1254 97768  1357]]
training model: results/AAPL/W8/deepVOL_L2/h10
Epoch 1/50
3903/3903 - 109s - loss: 3.2101 - accuracy10: 0.4128 - val_loss: 3.4055 - val_accuracy10: 0.3246 - 109s/epoch - 28ms/step
Epoch 2/50
3903/3903 - 106s - loss: 3.1413 - accuracy10: 0.4447 - val_loss: 3.2805 - val_accuracy10: 0.3954 - 106s/epoch - 27ms/step
Epoch 3/50
3903/3903 - 105s - loss: 3.1064 - accuracy10: 0.4598 - val_loss: 3.2488 - val_accuracy10: 0.4054 - 105s/epoch - 27ms/step
Epoch 4/50
3903/3903 - 102s - loss: 3.0856 - accuracy10: 0.4662 - val_loss: 3.2274 - val_accuracy10: 0.4147 - 102s/epoch - 26ms/step
Epoch 5/50
3903/3903 - 102s - loss: 3.0688 - accuracy10: 0.4715 - val_loss: 3.2104 - val_accuracy10: 0.4228 - 102s/epoch - 26ms/step
Epoch 6/50
3903/3903 - 106s - loss: 3.0563 - accuracy10: 0.4754 - val_loss: 3.1991 - val_accuracy10: 0.4274 - 106s/epoch - 27ms/step
Epoch 7/50
3903/3903 - 103s - loss: 3.0478 - accuracy10: 0.4780 - val_loss: 3.1880 - val_accuracy10: 0.4303 - 103s/epoch - 26ms/step
Epoch 8/50
3903/3903 - 103s - loss: 3.0405 - accuracy10: 0.4798 - val_loss: 3.1821 - val_accuracy10: 0.4326 - 103s/epoch - 26ms/step
Epoch 9/50
3903/3903 - 103s - loss: 3.0340 - accuracy10: 0.4818 - val_loss: 3.1781 - val_accuracy10: 0.4347 - 103s/epoch - 26ms/step
Epoch 10/50
3903/3903 - 105s - loss: 3.0293 - accuracy10: 0.4835 - val_loss: 3.1717 - val_accuracy10: 0.4360 - 105s/epoch - 27ms/step
Epoch 11/50
3903/3903 - 106s - loss: 3.0251 - accuracy10: 0.4844 - val_loss: 3.1662 - val_accuracy10: 0.4392 - 106s/epoch - 27ms/step
Epoch 12/50
3903/3903 - 105s - loss: 3.0214 - accuracy10: 0.4856 - val_loss: 3.1648 - val_accuracy10: 0.4417 - 105s/epoch - 27ms/step
Epoch 13/50
3903/3903 - 104s - loss: 3.0178 - accuracy10: 0.4864 - val_loss: 3.1555 - val_accuracy10: 0.4453 - 104s/epoch - 27ms/step
Epoch 14/50
3903/3903 - 106s - loss: 3.0149 - accuracy10: 0.4876 - val_loss: 3.1632 - val_accuracy10: 0.4419 - 106s/epoch - 27ms/step
Epoch 15/50
3903/3903 - 103s - loss: 3.0115 - accuracy10: 0.4883 - val_loss: 3.1648 - val_accuracy10: 0.4409 - 103s/epoch - 26ms/step
Epoch 16/50
3903/3903 - 103s - loss: 3.0090 - accuracy10: 0.4895 - val_loss: 3.1588 - val_accuracy10: 0.4430 - 103s/epoch - 26ms/step
Epoch 17/50
3903/3903 - 106s - loss: 3.0060 - accuracy10: 0.4898 - val_loss: 3.1542 - val_accuracy10: 0.4450 - 106s/epoch - 27ms/step
Epoch 18/50
3903/3903 - 103s - loss: 3.0035 - accuracy10: 0.4911 - val_loss: 3.1538 - val_accuracy10: 0.4446 - 103s/epoch - 26ms/step
Epoch 19/50
3903/3903 - 104s - loss: 3.0015 - accuracy10: 0.4920 - val_loss: 3.1474 - val_accuracy10: 0.4454 - 104s/epoch - 27ms/step
Epoch 20/50
3903/3903 - 103s - loss: 2.9987 - accuracy10: 0.4923 - val_loss: 3.1550 - val_accuracy10: 0.4431 - 103s/epoch - 26ms/step
Epoch 21/50
3903/3903 - 105s - loss: 2.9962 - accuracy10: 0.4929 - val_loss: 3.1482 - val_accuracy10: 0.4475 - 105s/epoch - 27ms/step
Epoch 22/50
3903/3903 - 103s - loss: 2.9947 - accuracy10: 0.4938 - val_loss: 3.1406 - val_accuracy10: 0.4493 - 103s/epoch - 26ms/step
Epoch 23/50
3903/3903 - 105s - loss: 2.9921 - accuracy10: 0.4944 - val_loss: 3.1478 - val_accuracy10: 0.4471 - 105s/epoch - 27ms/step
Epoch 24/50
3903/3903 - 103s - loss: 2.9907 - accuracy10: 0.4948 - val_loss: 3.1430 - val_accuracy10: 0.4484 - 103s/epoch - 26ms/step
Epoch 25/50
3903/3903 - 104s - loss: 2.9880 - accuracy10: 0.4955 - val_loss: 3.1460 - val_accuracy10: 0.4475 - 104s/epoch - 27ms/step
Epoch 26/50
3903/3903 - 103s - loss: 2.9861 - accuracy10: 0.4961 - val_loss: 3.1445 - val_accuracy10: 0.4501 - 103s/epoch - 26ms/step
Epoch 27/50
3903/3903 - 103s - loss: 2.9842 - accuracy10: 0.4968 - val_loss: 3.1392 - val_accuracy10: 0.4509 - 103s/epoch - 26ms/step
Epoch 28/50
3903/3903 - 106s - loss: 2.9822 - accuracy10: 0.4970 - val_loss: 3.1385 - val_accuracy10: 0.4517 - 106s/epoch - 27ms/step
Epoch 29/50
3903/3903 - 103s - loss: 2.9807 - accuracy10: 0.4974 - val_loss: 3.1393 - val_accuracy10: 0.4512 - 103s/epoch - 26ms/step
Epoch 30/50
3903/3903 - 103s - loss: 2.9789 - accuracy10: 0.4980 - val_loss: 3.1324 - val_accuracy10: 0.4544 - 103s/epoch - 26ms/step
Epoch 31/50
3903/3903 - 104s - loss: 2.9774 - accuracy10: 0.4993 - val_loss: 3.1332 - val_accuracy10: 0.4551 - 104s/epoch - 27ms/step
Epoch 32/50
3903/3903 - 105s - loss: 2.9754 - accuracy10: 0.4990 - val_loss: 3.1357 - val_accuracy10: 0.4534 - 105s/epoch - 27ms/step
Epoch 33/50
3903/3903 - 103s - loss: 2.9735 - accuracy10: 0.4998 - val_loss: 3.1305 - val_accuracy10: 0.4549 - 103s/epoch - 27ms/step
Epoch 34/50
3903/3903 - 103s - loss: 2.9725 - accuracy10: 0.5000 - val_loss: 3.1317 - val_accuracy10: 0.4569 - 103s/epoch - 26ms/step
Epoch 35/50
3903/3903 - 104s - loss: 2.9709 - accuracy10: 0.5002 - val_loss: 3.1312 - val_accuracy10: 0.4559 - 104s/epoch - 27ms/step
Epoch 36/50
3903/3903 - 105s - loss: 2.9690 - accuracy10: 0.5006 - val_loss: 3.1273 - val_accuracy10: 0.4575 - 105s/epoch - 27ms/step
Epoch 37/50
3903/3903 - 103s - loss: 2.9678 - accuracy10: 0.5018 - val_loss: 3.1305 - val_accuracy10: 0.4579 - 103s/epoch - 26ms/step
Epoch 38/50
3903/3903 - 104s - loss: 2.9658 - accuracy10: 0.5022 - val_loss: 3.1309 - val_accuracy10: 0.4567 - 104s/epoch - 27ms/step
Epoch 39/50
3903/3903 - 105s - loss: 2.9640 - accuracy10: 0.5023 - val_loss: 3.1253 - val_accuracy10: 0.4593 - 105s/epoch - 27ms/step
Epoch 40/50
3903/3903 - 104s - loss: 2.9631 - accuracy10: 0.5029 - val_loss: 3.1257 - val_accuracy10: 0.4579 - 104s/epoch - 27ms/step
Epoch 41/50
3903/3903 - 103s - loss: 2.9615 - accuracy10: 0.5036 - val_loss: 3.1302 - val_accuracy10: 0.4571 - 103s/epoch - 26ms/step
Epoch 42/50
3903/3903 - 103s - loss: 2.9598 - accuracy10: 0.5037 - val_loss: 3.1327 - val_accuracy10: 0.4559 - 103s/epoch - 26ms/step
Epoch 43/50
3903/3903 - 104s - loss: 2.9588 - accuracy10: 0.5039 - val_loss: 3.1322 - val_accuracy10: 0.4559 - 104s/epoch - 27ms/step
Epoch 44/50
3903/3903 - 105s - loss: 2.9569 - accuracy10: 0.5040 - val_loss: 3.1289 - val_accuracy10: 0.4567 - 105s/epoch - 27ms/step
Epoch 45/50
3903/3903 - 106s - loss: 2.9562 - accuracy10: 0.5045 - val_loss: 3.1330 - val_accuracy10: 0.4549 - 106s/epoch - 27ms/step
Epoch 46/50
3903/3903 - 105s - loss: 2.9548 - accuracy10: 0.5048 - val_loss: 3.1216 - val_accuracy10: 0.4588 - 105s/epoch - 27ms/step
Epoch 47/50
3903/3903 - 106s - loss: 2.9537 - accuracy10: 0.5058 - val_loss: 3.1333 - val_accuracy10: 0.4554 - 106s/epoch - 27ms/step
Epoch 48/50
3903/3903 - 104s - loss: 2.9523 - accuracy10: 0.5059 - val_loss: 3.1272 - val_accuracy10: 0.4589 - 104s/epoch - 27ms/step
Epoch 49/50
3903/3903 - 103s - loss: 2.9512 - accuracy10: 0.5061 - val_loss: 3.1321 - val_accuracy10: 0.4560 - 103s/epoch - 26ms/step
Epoch 50/50
3903/3903 - 103s - loss: 2.9496 - accuracy10: 0.5065 - val_loss: 3.1384 - val_accuracy10: 0.4556 - 103s/epoch - 26ms/step
testing model: results/AAPL/W8/deepVOL_L2/h10
Evaluating performance on  test set...
10609/10609 - 139s - 139s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0296851
{'0': {'precision': 0.4774186826185821, 'recall': 0.44567865492291303, 'f1-score': 0.4610029899364846, 'support': 873883}, '1': {'precision': 0.45433795659243087, 'recall': 0.5605679501108812, 'f1-score': 0.50189341751272, 'support': 940646}, '2': {'precision': 0.4887044240892933, 'recall': 0.40093857535845745, 'f1-score': 0.440492322622372, 'support': 901153}, 'accuracy': 0.4706272678465299, 'macro avg': {'precision': 0.4734870211001021, 'recall': 0.46906172679741714, 'f1-score': 0.4677962433571922, 'support': 2715682}, 'weighted avg': {'precision': 0.4731690639850163, 'recall': 0.4706272678465299, 'f1-score': 0.4683603196075437, 'support': 2715682}}
[[389471 303923 180489]
 [215830 527296 197520]
 [210484 329362 361307]]
Evaluating performance on  train set...
3903/3903 - 51s - 51s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.021058
{'0': {'precision': 0.5007536767202162, 'recall': 0.4385691051108911, 'f1-score': 0.4676030351399718, 'support': 336321}, '1': {'precision': 0.43709142950014446, 'recall': 0.5946399945951589, 'f1-score': 0.5038366365616241, 'support': 325634}, '2': {'precision': 0.5155277840450633, 'recall': 0.3999015152414063, 'f1-score': 0.4504123740617801, 'support': 337108}, 'accuracy': 0.4763913787218624, 'macro avg': {'precision': 0.48445763008847464, 'recall': 0.47770353831581874, 'f1-score': 0.4739506819211254, 'support': 999063}, 'weighted avg': {'precision': 0.484988782575206, 'recall': 0.4763913787218624, 'f1-score': 0.4736124491514919, 'support': 999063}}
[[147500 124000  64821]
 [ 70131 193635  61868]
 [ 76925 125373 134810]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.041871
{'0': {'precision': 0.4844088543411736, 'recall': 0.4362866397086929, 'f1-score': 0.45909013929463566, 'support': 99414}, '1': {'precision': 0.4166486899092312, 'recall': 0.5340643212660059, 'f1-score': 0.46810593137391987, 'support': 94028}, '2': {'precision': 0.4919279632791968, 'recall': 0.40949279672550937, 'f1-score': 0.44694102112676054, 'support': 99191}, 'accuracy': 0.4586222333092987, 'macro avg': {'precision': 0.4643285025098672, 'recall': 0.45994791923340267, 'f1-score': 0.4580456972651054, 'support': 292633}, 'weighted avg': {'precision': 0.4651850319884819, 'recall': 0.4586222333092987, 'f1-score': 0.4578689978561828, 'support': 292633}}
[[43373 35070 20971]
 [22831 50217 20980]
 [23334 35239 40618]]
training model: results/AAPL/W8/deepVOL_L2/h20
Epoch 1/50
3903/3903 - 107s - loss: 3.2386 - accuracy20: 0.3979 - val_loss: 3.4257 - val_accuracy20: 0.3316 - 107s/epoch - 27ms/step
Epoch 2/50
3903/3903 - 103s - loss: 3.2020 - accuracy20: 0.4188 - val_loss: 3.3336 - val_accuracy20: 0.3493 - 103s/epoch - 26ms/step
Epoch 3/50
3903/3903 - 104s - loss: 3.1797 - accuracy20: 0.4286 - val_loss: 3.3023 - val_accuracy20: 0.3682 - 104s/epoch - 27ms/step
Epoch 4/50
3903/3903 - 104s - loss: 3.1626 - accuracy20: 0.4363 - val_loss: 3.2894 - val_accuracy20: 0.3761 - 104s/epoch - 27ms/step
Epoch 5/50
3903/3903 - 103s - loss: 3.1507 - accuracy20: 0.4412 - val_loss: 3.2731 - val_accuracy20: 0.3811 - 103s/epoch - 26ms/step
Epoch 6/50
3903/3903 - 106s - loss: 3.1419 - accuracy20: 0.4446 - val_loss: 3.2892 - val_accuracy20: 0.3881 - 106s/epoch - 27ms/step
Epoch 7/50
3903/3903 - 105s - loss: 3.1353 - accuracy20: 0.4461 - val_loss: 3.2732 - val_accuracy20: 0.3904 - 105s/epoch - 27ms/step
Epoch 8/50
3903/3903 - 103s - loss: 3.1295 - accuracy20: 0.4483 - val_loss: 3.2667 - val_accuracy20: 0.3888 - 103s/epoch - 27ms/step
Epoch 9/50
3903/3903 - 104s - loss: 3.1245 - accuracy20: 0.4499 - val_loss: 3.2615 - val_accuracy20: 0.3914 - 104s/epoch - 27ms/step
Epoch 10/50
3903/3903 - 103s - loss: 3.1210 - accuracy20: 0.4510 - val_loss: 3.2581 - val_accuracy20: 0.3926 - 103s/epoch - 26ms/step
Epoch 11/50
3903/3903 - 104s - loss: 3.1177 - accuracy20: 0.4519 - val_loss: 3.2516 - val_accuracy20: 0.3950 - 104s/epoch - 27ms/step
Epoch 12/50
3903/3903 - 104s - loss: 3.1145 - accuracy20: 0.4531 - val_loss: 3.2497 - val_accuracy20: 0.3967 - 104s/epoch - 27ms/step
Epoch 13/50
3903/3903 - 104s - loss: 3.1115 - accuracy20: 0.4540 - val_loss: 3.2546 - val_accuracy20: 0.3927 - 104s/epoch - 27ms/step
Epoch 14/50
3903/3903 - 103s - loss: 3.1094 - accuracy20: 0.4549 - val_loss: 3.2465 - val_accuracy20: 0.3979 - 103s/epoch - 26ms/step
Epoch 15/50
3903/3903 - 106s - loss: 3.1069 - accuracy20: 0.4556 - val_loss: 3.2510 - val_accuracy20: 0.3961 - 106s/epoch - 27ms/step
Epoch 16/50
3903/3903 - 103s - loss: 3.1044 - accuracy20: 0.4565 - val_loss: 3.2460 - val_accuracy20: 0.3988 - 103s/epoch - 27ms/step
Epoch 17/50
3903/3903 - 104s - loss: 3.1022 - accuracy20: 0.4572 - val_loss: 3.2401 - val_accuracy20: 0.4020 - 104s/epoch - 27ms/step
Epoch 18/50
3903/3903 - 104s - loss: 3.1007 - accuracy20: 0.4577 - val_loss: 3.2415 - val_accuracy20: 0.4018 - 104s/epoch - 27ms/step
Epoch 19/50
3903/3903 - 105s - loss: 3.0990 - accuracy20: 0.4584 - val_loss: 3.2411 - val_accuracy20: 0.4021 - 105s/epoch - 27ms/step
Epoch 20/50
3903/3903 - 103s - loss: 3.0970 - accuracy20: 0.4589 - val_loss: 3.2410 - val_accuracy20: 0.4018 - 103s/epoch - 26ms/step
Epoch 21/50
3903/3903 - 103s - loss: 3.0957 - accuracy20: 0.4593 - val_loss: 3.2352 - val_accuracy20: 0.4065 - 103s/epoch - 26ms/step
Epoch 22/50
3903/3903 - 103s - loss: 3.0938 - accuracy20: 0.4600 - val_loss: 3.2357 - val_accuracy20: 0.4067 - 103s/epoch - 26ms/step
Epoch 23/50
3903/3903 - 104s - loss: 3.0925 - accuracy20: 0.4601 - val_loss: 3.2374 - val_accuracy20: 0.4042 - 104s/epoch - 27ms/step
Epoch 24/50
3903/3903 - 103s - loss: 3.0905 - accuracy20: 0.4610 - val_loss: 3.2415 - val_accuracy20: 0.4048 - 103s/epoch - 26ms/step
Epoch 25/50
3903/3903 - 103s - loss: 3.0891 - accuracy20: 0.4615 - val_loss: 3.2356 - val_accuracy20: 0.4058 - 103s/epoch - 26ms/step
Epoch 26/50
3903/3903 - 105s - loss: 3.0875 - accuracy20: 0.4621 - val_loss: 3.2382 - val_accuracy20: 0.4082 - 105s/epoch - 27ms/step
Epoch 27/50
3903/3903 - 105s - loss: 3.0856 - accuracy20: 0.4624 - val_loss: 3.2374 - val_accuracy20: 0.4071 - 105s/epoch - 27ms/step
Epoch 28/50
3903/3903 - 104s - loss: 3.0849 - accuracy20: 0.4633 - val_loss: 3.2391 - val_accuracy20: 0.4065 - 104s/epoch - 27ms/step
Epoch 29/50
3903/3903 - 103s - loss: 3.0828 - accuracy20: 0.4636 - val_loss: 3.2386 - val_accuracy20: 0.4089 - 103s/epoch - 26ms/step
Epoch 30/50
3903/3903 - 104s - loss: 3.0813 - accuracy20: 0.4644 - val_loss: 3.2342 - val_accuracy20: 0.4081 - 104s/epoch - 27ms/step
Epoch 31/50
3903/3903 - 103s - loss: 3.0805 - accuracy20: 0.4648 - val_loss: 3.2371 - val_accuracy20: 0.4080 - 103s/epoch - 27ms/step
Epoch 32/50
3903/3903 - 103s - loss: 3.0789 - accuracy20: 0.4654 - val_loss: 3.2337 - val_accuracy20: 0.4121 - 103s/epoch - 26ms/step
Epoch 33/50
3903/3903 - 103s - loss: 3.0774 - accuracy20: 0.4655 - val_loss: 3.2421 - val_accuracy20: 0.4076 - 103s/epoch - 26ms/step
Epoch 34/50
3903/3903 - 105s - loss: 3.0762 - accuracy20: 0.4662 - val_loss: 3.2333 - val_accuracy20: 0.4090 - 105s/epoch - 27ms/step
Epoch 35/50
3903/3903 - 103s - loss: 3.0750 - accuracy20: 0.4665 - val_loss: 3.2346 - val_accuracy20: 0.4092 - 103s/epoch - 26ms/step
Epoch 36/50
3903/3903 - 103s - loss: 3.0737 - accuracy20: 0.4668 - val_loss: 3.2338 - val_accuracy20: 0.4122 - 103s/epoch - 26ms/step
Epoch 37/50
3903/3903 - 105s - loss: 3.0719 - accuracy20: 0.4674 - val_loss: 3.2345 - val_accuracy20: 0.4123 - 105s/epoch - 27ms/step
Epoch 38/50
3903/3903 - 104s - loss: 3.0708 - accuracy20: 0.4677 - val_loss: 3.2350 - val_accuracy20: 0.4122 - 104s/epoch - 27ms/step
Epoch 39/50
3903/3903 - 105s - loss: 3.0696 - accuracy20: 0.4682 - val_loss: 3.2343 - val_accuracy20: 0.4102 - 105s/epoch - 27ms/step
Epoch 40/50
3903/3903 - 107s - loss: 3.0681 - accuracy20: 0.4690 - val_loss: 3.2365 - val_accuracy20: 0.4109 - 107s/epoch - 27ms/step
Epoch 41/50
3903/3903 - 108s - loss: 3.0669 - accuracy20: 0.4695 - val_loss: 3.2396 - val_accuracy20: 0.4092 - 108s/epoch - 28ms/step
Epoch 42/50
3903/3903 - 106s - loss: 3.0659 - accuracy20: 0.4697 - val_loss: 3.2359 - val_accuracy20: 0.4106 - 106s/epoch - 27ms/step
Epoch 43/50
3903/3903 - 104s - loss: 3.0646 - accuracy20: 0.4704 - val_loss: 3.2381 - val_accuracy20: 0.4121 - 104s/epoch - 27ms/step
Epoch 44/50
3903/3903 - 104s - loss: 3.0630 - accuracy20: 0.4703 - val_loss: 3.2390 - val_accuracy20: 0.4114 - 104s/epoch - 27ms/step
testing model: results/AAPL/W8/deepVOL_L2/h20
Evaluating performance on  test set...
10609/10609 - 139s - 139s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0701597
{'0': {'precision': 0.4993916111691363, 'recall': 0.26543010614568197, 'f1-score': 0.346626057707315, 'support': 895279}, '1': {'precision': 0.3697442104843108, 'recall': 0.6529832631209213, 'f1-score': 0.4721429458250917, 'support': 893954}, '2': {'precision': 0.482646473325306, 'recall': 0.3443967234030152, 'f1-score': 0.40196658320341416, 'support': 926449}, 'accuracy': 0.4199449714657313, 'macro avg': {'precision': 0.450594098326251, 'recall': 0.42093669755653945, 'f1-score': 0.4069118622452736, 'support': 2715682}, 'weighted avg': {'precision': 0.45100143564708284, 'recall': 0.4199449714657313, 'f1-score': 0.40682327472527746, 'support': 2715682}}
[[237634 498851 158794]
 [127001 583737 183216]
 [111212 496171 319066]]
Evaluating performance on  train set...
3903/3903 - 52s - 52s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0682697
{'0': {'precision': 0.5063258237473781, 'recall': 0.25071086075509874, 'f1-score': 0.3353638884162271, 'support': 334102}, '1': {'precision': 0.3723837594919098, 'recall': 0.6994060007595898, 'f1-score': 0.4860047103136022, 'support': 329125}, '2': {'precision': 0.4951780277715898, 'recall': 0.31770566586071775, 'f1-score': 0.38706857147003126, 'support': 335836}, 'accuracy': 0.42104652058979264, 'macro avg': {'precision': 0.45796253700362594, 'recall': 0.4226075091251354, 'f1-score': 0.40281239006662023, 'support': 999063}, 'weighted avg': {'precision': 0.4584534542297342, 'recall': 0.42104652058979264, 'f1-score': 0.40237062817641334, 'support': 999063}}
[[ 83763 197714  52625]
 [ 42783 230192  56150]
 [ 38887 190252 106697]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0790209
{'0': {'precision': 0.5003368988461214, 'recall': 0.24031148867313915, 'f1-score': 0.32467958352690407, 'support': 98880}, '1': {'precision': 0.3598329224869899, 'recall': 0.660507792860734, 'f1-score': 0.4658687943262411, 'support': 95472}, '2': {'precision': 0.4725365916472322, 'recall': 0.3360466417720617, 'f1-score': 0.3927717720931892, 'support': 98281}, 'accuracy': 0.40955394641069187, 'macro avg': {'precision': 0.4442354709934478, 'recall': 0.4122886411019783, 'f1-score': 0.39444004998211146, 'support': 292633}, 'weighted avg': {'precision': 0.4451604914594869, 'recall': 0.40955394641069187, 'f1-score': 0.39361160663406347, 'support': 292633}}
[[23762 57888 17230]
 [12776 63060 19636]
 [10954 54300 33027]]
training model: results/AAPL/W8/deepVOL_L2/h30
Epoch 1/50
3903/3903 - 106s - loss: 3.2577 - accuracy30: 0.3858 - val_loss: 3.3875 - val_accuracy30: 0.3269 - 106s/epoch - 27ms/step
Epoch 2/50
3903/3903 - 104s - loss: 3.2257 - accuracy30: 0.4059 - val_loss: 3.3515 - val_accuracy30: 0.3359 - 104s/epoch - 27ms/step
Epoch 3/50
3903/3903 - 104s - loss: 3.2156 - accuracy30: 0.4121 - val_loss: 3.3574 - val_accuracy30: 0.3422 - 104s/epoch - 27ms/step
Epoch 4/50
3903/3903 - 103s - loss: 3.2039 - accuracy30: 0.4177 - val_loss: 3.3521 - val_accuracy30: 0.3473 - 103s/epoch - 26ms/step
Epoch 5/50
3903/3903 - 104s - loss: 3.1941 - accuracy30: 0.4214 - val_loss: 3.3349 - val_accuracy30: 0.3552 - 104s/epoch - 27ms/step
Epoch 6/50
3903/3903 - 104s - loss: 3.1865 - accuracy30: 0.4248 - val_loss: 3.3244 - val_accuracy30: 0.3582 - 104s/epoch - 27ms/step
Epoch 7/50
3903/3903 - 106s - loss: 3.1801 - accuracy30: 0.4276 - val_loss: 3.3112 - val_accuracy30: 0.3593 - 106s/epoch - 27ms/step
Epoch 8/50
3903/3903 - 103s - loss: 3.1746 - accuracy30: 0.4304 - val_loss: 3.3012 - val_accuracy30: 0.3637 - 103s/epoch - 26ms/step
Epoch 9/50
3903/3903 - 105s - loss: 3.1713 - accuracy30: 0.4313 - val_loss: 3.2991 - val_accuracy30: 0.3624 - 105s/epoch - 27ms/step
Epoch 10/50
3903/3903 - 104s - loss: 3.1674 - accuracy30: 0.4326 - val_loss: 3.2945 - val_accuracy30: 0.3623 - 104s/epoch - 27ms/step
Epoch 11/50
3903/3903 - 103s - loss: 3.1643 - accuracy30: 0.4344 - val_loss: 3.2957 - val_accuracy30: 0.3633 - 103s/epoch - 26ms/step
Epoch 12/50
3903/3903 - 103s - loss: 3.1625 - accuracy30: 0.4350 - val_loss: 3.2971 - val_accuracy30: 0.3641 - 103s/epoch - 26ms/step
Epoch 13/50
3903/3903 - 103s - loss: 3.1599 - accuracy30: 0.4356 - val_loss: 3.2932 - val_accuracy30: 0.3658 - 103s/epoch - 26ms/step
Epoch 14/50
3903/3903 - 105s - loss: 3.1581 - accuracy30: 0.4363 - val_loss: 3.2901 - val_accuracy30: 0.3675 - 105s/epoch - 27ms/step
Epoch 15/50
3903/3903 - 104s - loss: 3.1561 - accuracy30: 0.4374 - val_loss: 3.2899 - val_accuracy30: 0.3685 - 104s/epoch - 27ms/step
Epoch 16/50
3903/3903 - 104s - loss: 3.1545 - accuracy30: 0.4377 - val_loss: 3.2888 - val_accuracy30: 0.3699 - 104s/epoch - 27ms/step
Epoch 17/50
3903/3903 - 104s - loss: 3.1527 - accuracy30: 0.4387 - val_loss: 3.2887 - val_accuracy30: 0.3720 - 104s/epoch - 27ms/step
Epoch 18/50
3903/3903 - 104s - loss: 3.1512 - accuracy30: 0.4393 - val_loss: 3.2908 - val_accuracy30: 0.3703 - 104s/epoch - 27ms/step
Epoch 19/50
3903/3903 - 103s - loss: 3.1497 - accuracy30: 0.4396 - val_loss: 3.2857 - val_accuracy30: 0.3731 - 103s/epoch - 26ms/step
Epoch 20/50
3903/3903 - 103s - loss: 3.1485 - accuracy30: 0.4400 - val_loss: 3.2903 - val_accuracy30: 0.3736 - 103s/epoch - 26ms/step
Epoch 21/50
3903/3903 - 104s - loss: 3.1468 - accuracy30: 0.4404 - val_loss: 3.2851 - val_accuracy30: 0.3765 - 104s/epoch - 27ms/step
Epoch 22/50
3903/3903 - 104s - loss: 3.1451 - accuracy30: 0.4415 - val_loss: 3.2842 - val_accuracy30: 0.3761 - 104s/epoch - 27ms/step
Epoch 23/50
3903/3903 - 102s - loss: 3.1439 - accuracy30: 0.4419 - val_loss: 3.2904 - val_accuracy30: 0.3752 - 102s/epoch - 26ms/step
Epoch 24/50
3903/3903 - 103s - loss: 3.1426 - accuracy30: 0.4425 - val_loss: 3.2866 - val_accuracy30: 0.3769 - 103s/epoch - 26ms/step
Epoch 25/50
3903/3903 - 105s - loss: 3.1409 - accuracy30: 0.4429 - val_loss: 3.2799 - val_accuracy30: 0.3791 - 105s/epoch - 27ms/step
Epoch 26/50
3903/3903 - 105s - loss: 3.1399 - accuracy30: 0.4434 - val_loss: 3.2837 - val_accuracy30: 0.3783 - 105s/epoch - 27ms/step
Epoch 27/50
3903/3903 - 103s - loss: 3.1388 - accuracy30: 0.4440 - val_loss: 3.2867 - val_accuracy30: 0.3801 - 103s/epoch - 26ms/step
Epoch 28/50
3903/3903 - 103s - loss: 3.1371 - accuracy30: 0.4444 - val_loss: 3.2809 - val_accuracy30: 0.3822 - 103s/epoch - 26ms/step
Epoch 29/50
3903/3903 - 104s - loss: 3.1361 - accuracy30: 0.4448 - val_loss: 3.2808 - val_accuracy30: 0.3811 - 104s/epoch - 27ms/step
Epoch 30/50
3903/3903 - 103s - loss: 3.1350 - accuracy30: 0.4455 - val_loss: 3.2834 - val_accuracy30: 0.3801 - 103s/epoch - 26ms/step
Epoch 31/50
3903/3903 - 103s - loss: 3.1338 - accuracy30: 0.4460 - val_loss: 3.2811 - val_accuracy30: 0.3815 - 103s/epoch - 27ms/step
Epoch 32/50
3903/3903 - 103s - loss: 3.1327 - accuracy30: 0.4465 - val_loss: 3.2852 - val_accuracy30: 0.3792 - 103s/epoch - 26ms/step
Epoch 33/50
3903/3903 - 104s - loss: 3.1312 - accuracy30: 0.4470 - val_loss: 3.2833 - val_accuracy30: 0.3818 - 104s/epoch - 27ms/step
Epoch 34/50
3903/3903 - 105s - loss: 3.1305 - accuracy30: 0.4474 - val_loss: 3.2858 - val_accuracy30: 0.3811 - 105s/epoch - 27ms/step
Epoch 35/50
3903/3903 - 106s - loss: 3.1290 - accuracy30: 0.4475 - val_loss: 3.2884 - val_accuracy30: 0.3803 - 106s/epoch - 27ms/step
testing model: results/AAPL/W8/deepVOL_L2/h30
Evaluating performance on  test set...
10609/10609 - 142s - 142s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0916065
{'0': {'precision': 0.5075458555839332, 'recall': 0.17059891500512148, 'f1-score': 0.2553636805390492, 'support': 922585}, '1': {'precision': 0.3242984579303407, 'recall': 0.7154388548135854, 'f1-score': 0.4462967992313211, 'support': 832633}, '2': {'precision': 0.4879214905678957, 'recall': 0.28890098952173116, 'f1-score': 0.3629168955504983, 'support': 960464}, 'accuracy': 0.37948809912206216, 'macro avg': {'precision': 0.43992193469405655, 'recall': 0.3916462531134794, 'f1-score': 0.35485912510695616, 'support': 2715682}, 'weighted avg': {'precision': 0.44442126052042163, 'recall': 0.37948809912206216, 'f1-score': 0.3519428111290295, 'support': 2715682}}
[[157392 627788 137405]
 [ 83123 595698 153812]
 [ 69589 613396 277479]]
Evaluating performance on  train set...
3903/3903 - 53s - 53s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0871469
{'0': {'precision': 0.4969301798943865, 'recall': 0.15216683056009708, 'f1-score': 0.23298918117414466, 'support': 334567}, '1': {'precision': 0.34860324685782207, 'recall': 0.7451811908787643, 'f1-score': 0.4749977667908201, 'support': 328245}, '2': {'precision': 0.47328303009474176, 'recall': 0.2743991839429474, 'f1-score': 0.3473895053105975, 'support': 336251}, 'accuracy': 0.3881426897002491, 'macro avg': {'precision': 0.4396054856156501, 'recall': 0.3905824017939363, 'f1-score': 0.3517921510918541, 'support': 999063}, 'weighted avg': {'precision': 0.4402381075207049, 'recall': 0.3881426897002491, 'f1-score': 0.35100509366109695, 'support': 999063}}
[[ 50910 235863  47794]
 [ 28753 244602  54890]
 [ 22786 221198  92267]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0949945
{'0': {'precision': 0.5004426888238098, 'recall': 0.14686600575631595, 'f1-score': 0.22708800123618944, 'support': 100064}, '1': {'precision': 0.33677558182211254, 'recall': 0.712894574402418, 'f1-score': 0.45744938759761394, 'support': 93962}, '2': {'precision': 0.4546033620234285, 'recall': 0.296743638889734, 'f1-score': 0.3590901560381167, 'support': 98607}, 'accuracy': 0.37911650429035687, 'macro avg': {'precision': 0.4306072108897836, 'recall': 0.38550140634948926, 'f1-score': 0.34787584829064006, 'support': 292633}, 'weighted avg': {'precision': 0.43244431814825823, 'recall': 0.37911650429035687, 'f1-score': 0.3455351793187905, 'support': 292633}}
[[14696 69072 16296]
 [ 8168 66985 18809]
 [ 6502 62844 29261]]
training model: results/AAPL/W8/deepVOL_L2/h50
Epoch 1/50
3903/3903 - 108s - loss: 3.2446 - accuracy50: 0.3926 - val_loss: 3.5161 - val_accuracy50: 0.3380 - 108s/epoch - 28ms/step
Epoch 2/50
3903/3903 - 104s - loss: 3.2322 - accuracy50: 0.4011 - val_loss: 3.5197 - val_accuracy50: 0.3375 - 104s/epoch - 27ms/step
Epoch 3/50
3903/3903 - 104s - loss: 3.2237 - accuracy50: 0.4053 - val_loss: 3.5011 - val_accuracy50: 0.3367 - 104s/epoch - 27ms/step
Epoch 4/50
3903/3903 - 105s - loss: 3.2157 - accuracy50: 0.4094 - val_loss: 3.4850 - val_accuracy50: 0.3377 - 105s/epoch - 27ms/step
Epoch 5/50
3903/3903 - 106s - loss: 3.2058 - accuracy50: 0.4151 - val_loss: 3.4956 - val_accuracy50: 0.3404 - 106s/epoch - 27ms/step
Epoch 6/50
3903/3903 - 104s - loss: 3.1958 - accuracy50: 0.4209 - val_loss: 3.4957 - val_accuracy50: 0.3419 - 104s/epoch - 27ms/step
Epoch 7/50
3903/3903 - 104s - loss: 3.1880 - accuracy50: 0.4244 - val_loss: 3.5002 - val_accuracy50: 0.3424 - 104s/epoch - 27ms/step
Epoch 8/50
3903/3903 - 103s - loss: 3.1823 - accuracy50: 0.4270 - val_loss: 3.5066 - val_accuracy50: 0.3434 - 103s/epoch - 26ms/step
Epoch 9/50
3903/3903 - 106s - loss: 3.1778 - accuracy50: 0.4294 - val_loss: 3.5154 - val_accuracy50: 0.3424 - 106s/epoch - 27ms/step
Epoch 10/50
3903/3903 - 104s - loss: 3.1745 - accuracy50: 0.4307 - val_loss: 3.5133 - val_accuracy50: 0.3431 - 104s/epoch - 27ms/step
Epoch 11/50
3903/3903 - 104s - loss: 3.1717 - accuracy50: 0.4319 - val_loss: 3.5118 - val_accuracy50: 0.3428 - 104s/epoch - 27ms/step
Epoch 12/50
3903/3903 - 104s - loss: 3.1690 - accuracy50: 0.4329 - val_loss: 3.5214 - val_accuracy50: 0.3430 - 104s/epoch - 27ms/step
Epoch 13/50
3903/3903 - 104s - loss: 3.1668 - accuracy50: 0.4339 - val_loss: 3.5125 - val_accuracy50: 0.3436 - 104s/epoch - 27ms/step
Epoch 14/50
3903/3903 - 105s - loss: 3.1644 - accuracy50: 0.4350 - val_loss: 3.5223 - val_accuracy50: 0.3440 - 105s/epoch - 27ms/step
testing model: results/AAPL/W8/deepVOL_L2/h50
Evaluating performance on  test set...
10609/10609 - 143s - 143s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1711237
{'0': {'precision': 0.530938123752495, 'recall': 0.00029675278819325525, 'f1-score': 0.000593174038600912, 'support': 896369}, '1': {'precision': 0.33062655180691075, 'recall': 0.996386366726931, 'f1-score': 0.4965012534502165, 'support': 897158}, '2': {'precision': 0.5042690364174943, 'recall': 0.006276602089670392, 'f1-score': 0.012398876217957164, 'support': 922155}, 'accuracy': 0.3313974169287862, 'macro avg': {'precision': 0.4552779039923, 'recall': 0.33431990720159827, 'f1-score': 0.16983110123559153, 'support': 2715682}, 'weighted avg': {'precision': 0.45570687005822447, 'recall': 0.3313974169287862, 'f1-score': 0.16843115654243254, 'support': 2715682}}
[[   266 893501   2602]
 [   154 893916   3088]
 [    81 916286   5788]]
Evaluating performance on  train set...
3903/3903 - 52s - 52s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1800988
{'0': {'precision': 0.5523255813953488, 'recall': 0.00028087562236124743, 'f1-score': 0.0005614657210401892, 'support': 338228}, '1': {'precision': 0.3224729075826597, 'recall': 0.9961210818734336, 'f1-score': 0.48721905930818254, 'support': 321997}, '2': {'precision': 0.47783018867924526, 'recall': 0.005979258524722729, 'f1-score': 0.011810725257813091, 'support': 338838}, 'accuracy': 0.3231718119878326, 'macro avg': {'precision': 0.45087622588575127, 'recall': 0.3341270720068392, 'f1-score': 0.16653041676234528, 'support': 999063}, 'weighted avg': {'precision': 0.45297875212952315, 'recall': 0.3231718119878326, 'f1-score': 0.16122597012686857, 'support': 999063}}
[[    95 337118   1015]
 [    50 320748   1199]
 [    27 336785   2026]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1697503
{'0': {'precision': 0.6190476190476191, 'recall': 0.0002656530979238189, 'f1-score': 0.00053107829319607, 'support': 97872}, '1': {'precision': 0.3369945116691468, 'recall': 0.9951389311737604, 'f1-score': 0.5034876347495244, 'support': 98538}, '2': {'precision': 0.48509316770186334, 'recall': 0.00811656256820095, 'f1-score': 0.015965982848323165, 'support': 96223}, 'accuracy': 0.3378497982114116, 'macro avg': {'precision': 0.48037843280620973, 'recall': 0.3345070489466284, 'f1-score': 0.17332823196368122, 'support': 292633}, 'weighted avg': {'precision': 0.4800255392866128, 'recall': 0.3378497982114116, 'f1-score': 0.1749663811507059, 'support': 292633}}
[[   26 97488   358]
 [    8 98059   471]
 [    8 95434   781]]
training model: results/AAPL/W8/deepVOL_L2/h100
Epoch 1/50
3903/3903 - 109s - loss: 3.2619 - accuracy100: 0.3828 - val_loss: 3.3148 - val_accuracy100: 0.3176 - 109s/epoch - 28ms/step
Epoch 2/50
3903/3903 - 103s - loss: 3.2559 - accuracy100: 0.3847 - val_loss: 3.3534 - val_accuracy100: 0.3180 - 103s/epoch - 26ms/step
Epoch 3/50
3903/3903 - 103s - loss: 3.2480 - accuracy100: 0.3907 - val_loss: 3.3456 - val_accuracy100: 0.3191 - 103s/epoch - 26ms/step
Epoch 4/50
3903/3903 - 103s - loss: 3.2397 - accuracy100: 0.3958 - val_loss: 3.3616 - val_accuracy100: 0.3197 - 103s/epoch - 26ms/step
Epoch 5/50
3903/3903 - 104s - loss: 3.2321 - accuracy100: 0.4009 - val_loss: 3.3683 - val_accuracy100: 0.3204 - 104s/epoch - 27ms/step
Epoch 6/50
3903/3903 - 103s - loss: 3.2254 - accuracy100: 0.4050 - val_loss: 3.3759 - val_accuracy100: 0.3235 - 103s/epoch - 26ms/step
Epoch 7/50
3903/3903 - 103s - loss: 3.2210 - accuracy100: 0.4076 - val_loss: 3.3942 - val_accuracy100: 0.3233 - 103s/epoch - 26ms/step
Epoch 8/50
3903/3903 - 104s - loss: 3.2174 - accuracy100: 0.4094 - val_loss: 3.4033 - val_accuracy100: 0.3240 - 104s/epoch - 27ms/step
Epoch 9/50
3903/3903 - 105s - loss: 3.2144 - accuracy100: 0.4112 - val_loss: 3.4058 - val_accuracy100: 0.3230 - 105s/epoch - 27ms/step
Epoch 10/50
3903/3903 - 103s - loss: 3.2125 - accuracy100: 0.4118 - val_loss: 3.4269 - val_accuracy100: 0.3236 - 103s/epoch - 26ms/step
Epoch 11/50
3903/3903 - 105s - loss: 3.2106 - accuracy100: 0.4126 - val_loss: 3.4257 - val_accuracy100: 0.3241 - 105s/epoch - 27ms/step
testing model: results/AAPL/W8/deepVOL_L2/h100
Evaluating performance on  test set...
10609/10609 - 144s - 144s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1153051
{'0': {'precision': 0.3870192307692308, 'recall': 0.0003256782097003558, 'f1-score': 0.0006508087612603052, 'support': 988706}, '1': {'precision': 0.26552473153722367, 'recall': 0.9947621604596534, 'f1-score': 0.41916480648454224, 'support': 720717}, '2': {'precision': 0.40033886818027786, 'recall': 0.005870258054834789, 'f1-score': 0.011570850154846067, 'support': 1006259}, 'accuracy': 0.2662944335897944, 'macro avg': {'precision': 0.3509609434955774, 'recall': 0.3336526989080628, 'f1-score': 0.14379548846688286, 'support': 2715682}, 'weighted avg': {'precision': 0.3597111195907527, 'recall': 0.2662944335897944, 'f1-score': 0.11576684327111778, 'support': 2715682}}
[[    322  983057    5327]
 [    254  716942    3521]
 [    256 1000096    5907]]
Evaluating performance on  train set...
3903/3903 - 52s - 52s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1027273
{'0': {'precision': 0.3449367088607595, 'recall': 0.0003264792655714136, 'f1-score': 0.0006523410965913682, 'support': 333865}, '1': {'precision': 0.330010505850672, 'recall': 0.9951508162893731, 'f1-score': 0.49565319903995547, 'support': 329540}, '2': {'precision': 0.3665004985044865, 'recall': 0.005475811689278969, 'f1-score': 0.010790406049202608, 'support': 335658}, 'accuracy': 0.33019839589695543, 'macro avg': {'precision': 0.34714923773863937, 'recall': 0.3336510357480745, 'f1-score': 0.16903198206191647, 'support': 999063}, 'weighted avg': {'precision': 0.3472581616262907, 'recall': 0.33019839589695543, 'f1-score': 0.16733402716896098, 'support': 999063}}
[[   109 332075   1681]
 [   102 327942   1496]
 [   105 333715   1838]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1058474
{'0': {'precision': 0.39705882352941174, 'recall': 0.00026741410559885903, 'f1-score': 0.0005344682535754936, 'support': 100967}, '1': {'precision': 0.3172491342936627, 'recall': 0.9943737268131797, 'f1-score': 0.48102882825575755, 'support': 92779}, '2': {'precision': 0.3569807037457435, 'recall': 0.006360795655647355, 'f1-score': 0.012498882254170434, 'support': 98887}, 'accuracy': 0.3175069113873008, 'macro avg': {'precision': 0.3570962205229393, 'recall': 0.3336673121914753, 'f1-score': 0.16468739292116782, 'support': 292633}, 'weighted avg': {'precision': 0.3582119805942296, 'recall': 0.3175069113873008, 'f1-score': 0.15691775801897884, 'support': 292633}}
[[    27 100305    635]
 [    24  92257    498]
 [    17  98241    629]]
training model: results/AAPL/W8/deepVOL_L2/h200
Epoch 1/50
3903/3903 - 107s - loss: 3.2508 - accuracy200: 0.3864 - val_loss: 3.3419 - val_accuracy200: 0.3158 - 107s/epoch - 27ms/step
Epoch 2/50
3903/3903 - 104s - loss: 3.2475 - accuracy200: 0.3860 - val_loss: 3.3515 - val_accuracy200: 0.3159 - 104s/epoch - 27ms/step
Epoch 3/50
3903/3903 - 104s - loss: 3.2442 - accuracy200: 0.3885 - val_loss: 3.3484 - val_accuracy200: 0.3158 - 104s/epoch - 27ms/step
Epoch 4/50
3903/3903 - 105s - loss: 3.2387 - accuracy200: 0.3938 - val_loss: 3.3671 - val_accuracy200: 0.3160 - 105s/epoch - 27ms/step
Epoch 5/50
3903/3903 - 103s - loss: 3.2274 - accuracy200: 0.3994 - val_loss: 3.4199 - val_accuracy200: 0.3160 - 103s/epoch - 26ms/step
Epoch 6/50
3903/3903 - 104s - loss: 3.2209 - accuracy200: 0.4032 - val_loss: 3.4382 - val_accuracy200: 0.3167 - 104s/epoch - 27ms/step
Epoch 7/50
3903/3903 - 104s - loss: 3.2157 - accuracy200: 0.4063 - val_loss: 3.4427 - val_accuracy200: 0.3182 - 104s/epoch - 27ms/step
Epoch 8/50
3903/3903 - 105s - loss: 3.2109 - accuracy200: 0.4081 - val_loss: 3.4653 - val_accuracy200: 0.3162 - 105s/epoch - 27ms/step
Epoch 9/50
3903/3903 - 104s - loss: 3.2070 - accuracy200: 0.4103 - val_loss: 3.5059 - val_accuracy200: 0.3159 - 104s/epoch - 27ms/step
Epoch 10/50
3903/3903 - 102s - loss: 3.2044 - accuracy200: 0.4116 - val_loss: 3.4976 - val_accuracy200: 0.3162 - 102s/epoch - 26ms/step
Epoch 11/50
3903/3903 - 103s - loss: 3.2021 - accuracy200: 0.4121 - val_loss: 3.5116 - val_accuracy200: 0.3168 - 103s/epoch - 26ms/step
testing model: results/AAPL/W8/deepVOL_L2/h200
Evaluating performance on  test set...
10609/10609 - 137s - 137s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1340493
{'0': {'precision': 0.33519553072625696, 'recall': 5.9316378735078224e-05, 'f1-score': 0.00011861176786886282, 'support': 1011525}, '1': {'precision': 0.2563563153906763, 'recall': 0.9996854171454838, 'f1-score': 0.408068718499892, 'support': 696160}, '2': {'precision': 0.410761154855643, 'recall': 0.00031051679717300745, 'f1-score': 0.0006205644757568457, 'support': 1007997}, 'accuracy': 0.2564048367960608, 'macro avg': {'precision': 0.3341043336575254, 'recall': 0.33335175010713064, 'f1-score': 0.13626929824783926, 'support': 2715682}, 'weighted avg': {'precision': 0.34303341980072555, 'recall': 0.2564048367960608, 'f1-score': 0.1048821713916607, 'support': 2715682}}
[[     60 1011178     287]
 [     57  695941     162]
 [     62 1007622     313]]
Evaluating performance on  train set...
3903/3903 - 51s - 51s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1123114
{'0': {'precision': 0.32142857142857145, 'recall': 5.38057075898929e-05, 'f1-score': 0.00010759340452430267, 'support': 334537}, '1': {'precision': 0.326224454343475, 'recall': 0.9997422530154862, 'f1-score': 0.4919284461126394, 'support': 325901}, '2': {'precision': 0.3671875, 'recall': 0.00027759320782576595, 'f1-score': 0.0005547670126091459, 'support': 338625}, 'accuracy': 0.32623468189693744, 'macro avg': {'precision': 0.3382801752573488, 'recall': 0.3333578839769673, 'f1-score': 0.16419693550992429, 'support': 999063}, 'weighted avg': {'precision': 0.3385026700843619, 'recall': 0.32623468189693744, 'f1-score': 0.1606943951191961, 'support': 999063}}
[[    18 334423     96]
 [    18 325817     66]
 [    20 338511     94]]
Evaluating performance on  val set...
1144/1144 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1162151
{'0': {'precision': 0.3076923076923077, 'recall': 3.965539462074572e-05, 'f1-score': 7.930056898158245e-05, 'support': 100869}, '1': {'precision': 0.31583031380324056, 'recall': 0.9997186725673293, 'f1-score': 0.4800147548180455, 'support': 92419}, '2': {'precision': 0.4, 'recall': 0.0003221098193165232, 'f1-score': 0.0006437012823736484, 'support': 99345}, 'accuracy': 0.3158529625845342, 'macro avg': {'precision': 0.3411742071651827, 'recall': 0.3333601459270888, 'f1-score': 0.16024591888980025, 'support': 292633}, 'weighted avg': {'precision': 0.34159967316057, 'recall': 0.3158529625845342, 'f1-score': 0.1518435415640716, 'support': 292633}}
[[     4 100837     28]
 [     6  92393     20]
 [     3  99310     32]]
training model: results/AAPL/W8/deepVOL_L2/h300
Epoch 1/50
3903/3903 - 108s - loss: 3.2592 - accuracy300: 0.3848 - val_loss: 3.3765 - val_accuracy300: 0.3132 - 108s/epoch - 28ms/step
Epoch 2/50
3903/3903 - 104s - loss: 3.2595 - accuracy300: 0.3784 - val_loss: 3.3153 - val_accuracy300: 0.3124 - 104s/epoch - 27ms/step
Epoch 3/50
3903/3903 - 103s - loss: 3.2550 - accuracy300: 0.3821 - val_loss: 3.3532 - val_accuracy300: 0.3132 - 103s/epoch - 27ms/step
Epoch 4/50
3903/3903 - 103s - loss: 3.2417 - accuracy300: 0.3932 - val_loss: 3.3831 - val_accuracy300: 0.3132 - 103s/epoch - 26ms/step
Epoch 5/50
3903/3903 - 104s - loss: 3.2333 - accuracy300: 0.3978 - val_loss: 3.4238 - val_accuracy300: 0.3139 - 104s/epoch - 27ms/step
Epoch 6/50
3903/3903 - 103s - loss: 3.2278 - accuracy300: 0.3998 - val_loss: 3.4365 - val_accuracy300: 0.3136 - 103s/epoch - 26ms/step
Epoch 7/50
3903/3903 - 107s - loss: 3.2237 - accuracy300: 0.4023 - val_loss: 3.4486 - val_accuracy300: 0.3143 - 107s/epoch - 27ms/step
Epoch 8/50
3903/3903 - 104s - loss: 3.2199 - accuracy300: 0.4047 - val_loss: 3.4523 - val_accuracy300: 0.3140 - 104s/epoch - 27ms/step
Epoch 9/50
3903/3903 - 103s - loss: 3.2163 - accuracy300: 0.4064 - val_loss: 3.4496 - val_accuracy300: 0.3142 - 103s/epoch - 26ms/step
Epoch 10/50
3903/3903 - 104s - loss: 3.2139 - accuracy300: 0.4081 - val_loss: 3.4743 - val_accuracy300: 0.3164 - 104s/epoch - 27ms/step
Epoch 11/50
3903/3903 - 104s - loss: 3.2120 - accuracy300: 0.4091 - val_loss: 3.4506 - val_accuracy300: 0.3184 - 104s/epoch - 27ms/step
Epoch 12/50
3903/3903 - 104s - loss: 3.2098 - accuracy300: 0.4102 - val_loss: 3.4882 - val_accuracy300: 0.3222 - 104s/epoch - 27ms/step
testing model: results/AAPL/W8/deepVOL_L2/h300
Evaluating performance on  test set...
10609/10609 - 136s - 136s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.117278
{'0': {'precision': 0.41327124563445866, 'recall': 0.000344395377534944, 'f1-score': 0.0006882172362552841, 'support': 1030792}, '1': {'precision': 0.24583290448649076, 'recall': 0.9953217233326238, 'f1-score': 0.39428258922951587, 'support': 667126}, '2': {'precision': 0.37297728756984255, 'recall': 0.0050502867069379545, 'f1-score': 0.009965634073162102, 'support': 1017764}, 'accuracy': 0.24653107396226803, 'macro avg': {'precision': 0.3440271458969306, 'recall': 0.3335721351390322, 'f1-score': 0.13497881351297775, 'support': 2715682}, 'weighted avg': {'precision': 0.35703777989275726, 'recall': 0.24653107396226803, 'f1-score': 0.10085431174952071, 'support': 2715682}}
[[    355 1024721    5716]
 [    196  664005    2925]
 [    308 1012316    5140]]
Evaluating performance on  train set...
3903/3903 - 50s - 50s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1023004
{'0': {'precision': 0.3062200956937799, 'recall': 0.0005780433833601782, 'f1-score': 0.0011539085647661231, 'support': 332155}, '1': {'precision': 0.3303453783794972, 'recall': 0.9917671273154954, 'f1-score': 0.49560939107093893, 'support': 329897}, '2': {'precision': 0.36568933250155955, 'recall': 0.008697045497031253, 'f1-score': 0.016990023940224794, 'support': 337011}, 'accuracy': 0.3306137851166543, 'macro avg': {'precision': 0.33408493552494556, 'recall': 0.3336807387319623, 'f1-score': 0.17125110785864328, 'support': 999063}, 'weighted avg': {'precision': 0.33424700225322285, 'recall': 0.3306137851166543, 'f1-score': 0.1697682255709385, 'support': 999063}}
[[   192 329367   2596]
 [   228 327181   2488]
 [   207 333873   2931]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.105769
{'0': {'precision': 0.35390946502057613, 'recall': 0.0008505587973494215, 'f1-score': 0.001697039061497933, 'support': 101110}, '1': {'precision': 0.3127544449086847, 'recall': 0.9881626463304204, 'f1-score': 0.475129832660127, 'support': 91659}, '2': {'precision': 0.30297597705270707, 'recall': 0.00846150765040455, 'f1-score': 0.016463230494968485, 'support': 99864}, 'accuracy': 0.3126954239610707, 'macro avg': {'precision': 0.323213295660656, 'recall': 0.33249157092605813, 'f1-score': 0.1644300340721978, 'support': 292633}, 'weighted avg': {'precision': 0.32363724749603473, 'recall': 0.3126954239610707, 'f1-score': 0.15502556786641344, 'support': 292633}}
[[    86 100062    962]
 [   103  90574    982]
 [    54  98965    845]]
training model: results/AAPL/W8/deepVOL_L2/h500
Epoch 1/50
3903/3903 - 109s - loss: 3.2648 - accuracy500: 0.3835 - val_loss: 3.3486 - val_accuracy500: 0.3174 - 109s/epoch - 28ms/step
Epoch 2/50
3903/3903 - 106s - loss: 3.2573 - accuracy500: 0.3825 - val_loss: 3.3242 - val_accuracy500: 0.3184 - 106s/epoch - 27ms/step
Epoch 3/50
3903/3903 - 105s - loss: 3.2580 - accuracy500: 0.3819 - val_loss: 3.3527 - val_accuracy500: 0.3174 - 105s/epoch - 27ms/step
Epoch 4/50
3903/3903 - 104s - loss: 3.2552 - accuracy500: 0.3841 - val_loss: 3.3535 - val_accuracy500: 0.3174 - 104s/epoch - 27ms/step
Epoch 5/50
3903/3903 - 106s - loss: 3.2470 - accuracy500: 0.3883 - val_loss: 3.3986 - val_accuracy500: 0.3174 - 106s/epoch - 27ms/step
Epoch 6/50
3903/3903 - 106s - loss: 3.2379 - accuracy500: 0.3943 - val_loss: 3.4215 - val_accuracy500: 0.3174 - 106s/epoch - 27ms/step
Epoch 7/50
3903/3903 - 105s - loss: 3.2304 - accuracy500: 0.3982 - val_loss: 3.4626 - val_accuracy500: 0.3175 - 105s/epoch - 27ms/step
Epoch 8/50
3903/3903 - 105s - loss: 3.2259 - accuracy500: 0.4007 - val_loss: 3.4743 - val_accuracy500: 0.3177 - 105s/epoch - 27ms/step
Epoch 9/50
3903/3903 - 105s - loss: 3.2214 - accuracy500: 0.4036 - val_loss: 3.4780 - val_accuracy500: 0.3178 - 105s/epoch - 27ms/step
Epoch 10/50
3903/3903 - 104s - loss: 3.2180 - accuracy500: 0.4048 - val_loss: 3.4640 - val_accuracy500: 0.3177 - 104s/epoch - 27ms/step
Epoch 11/50
3903/3903 - 105s - loss: 3.2152 - accuracy500: 0.4064 - val_loss: 3.4565 - val_accuracy500: 0.3185 - 105s/epoch - 27ms/step
Epoch 12/50
3903/3903 - 105s - loss: 3.2113 - accuracy500: 0.4083 - val_loss: 3.4669 - val_accuracy500: 0.3181 - 105s/epoch - 27ms/step
testing model: results/AAPL/W8/deepVOL_L2/h500
Evaluating performance on  test set...
10609/10609 - 140s - 140s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1257237
{'0': {'precision': 0.3951965065502183, 'recall': 0.00035373636478232024, 'f1-score': 0.0007068400442458437, 'support': 1023361}, '1': {'precision': 0.24929154060484418, 'recall': 0.9919999527061678, 'f1-score': 0.3984514480646514, 'support': 676621}, '2': {'precision': 0.39046807747489237, 'recall': 0.008574382199468347, 'f1-score': 0.016780282156908837, 'support': 1015700}, 'accuracy': 0.2505002426646419, 'macro avg': {'precision': 0.3449853748766516, 'recall': 0.33364269042347283, 'f1-score': 0.13864619008860204, 'support': 2715682}, 'weighted avg': {'precision': 0.3570753165969272, 'recall': 0.2505002426646419, 'f1-score': 0.10581787645322399, 'support': 2715682}}
[[    362 1014612    8387]
 [    205  671208    5208]
 [    349 1006642    8709]]
Evaluating performance on  train set...
3903/3903 - 51s - 51s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1059446
{'0': {'precision': 0.3625, 'recall': 0.0003510842753590291, 'f1-score': 0.0007014891526192457, 'support': 330405}, '1': {'precision': 0.3299001229535502, 'recall': 0.9923509978015571, 'f1-score': 0.49518084885547997, 'support': 329324}, '2': {'precision': 0.3713230769230769, 'recall': 0.008890945204429854, 'f1-score': 0.01736607772427826, 'support': 339334}, 'accuracy': 0.3302474418530163, 'macro avg': {'precision': 0.3545743999588757, 'recall': 0.3338643424271153, 'f1-score': 0.1710828052441258, 'support': 999063}, 'weighted avg': {'precision': 0.354750787063649, 'recall': 0.3302474418530163, 'f1-score': 0.16935830274011096, 'support': 999063}}
[[   116 327594   2695]
 [   106 326805   2413]
 [    98 336219   3017]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1089927
{'0': {'precision': 0.36666666666666664, 'recall': 0.00021984830466977785, 'f1-score': 0.0004394331312606737, 'support': 100069}, '1': {'precision': 0.3176646727243875, 'recall': 0.9914725009690339, 'f1-score': 0.4811654483036101, 'support': 92876}, '2': {'precision': 0.3525046382189239, 'recall': 0.009529732766230639, 'f1-score': 0.01855776837951613, 'support': 99688}, 'accuracy': 0.31799557807902734, 'macro avg': {'precision': 0.34561199253665936, 'recall': 0.33374069401331147, 'f1-score': 0.16672088327146228, 'support': 292633}, 'weighted avg': {'precision': 0.3462899713476777, 'recall': 0.31799557807902734, 'f1-score': 0.1591846532170856, 'support': 292633}}
[[   22 99077   970]
 [   17 92084   775]
 [   21 98717   950]]
training model: results/AAPL/W8/deepVOL_L2/h1000
Epoch 1/50
3903/3903 - 108s - loss: 3.2619 - accuracy1000: 0.3870 - val_loss: 3.3271 - val_accuracy1000: 0.3185 - 108s/epoch - 28ms/step
Epoch 2/50
3903/3903 - 105s - loss: 3.2658 - accuracy1000: 0.3754 - val_loss: 3.3162 - val_accuracy1000: 0.3186 - 105s/epoch - 27ms/step
Epoch 3/50
3903/3903 - 106s - loss: 3.2622 - accuracy1000: 0.3781 - val_loss: 3.3201 - val_accuracy1000: 0.3185 - 106s/epoch - 27ms/step
Epoch 4/50
3903/3903 - 104s - loss: 3.2631 - accuracy1000: 0.3768 - val_loss: 3.3175 - val_accuracy1000: 0.3185 - 104s/epoch - 27ms/step
Epoch 5/50
3903/3903 - 104s - loss: 3.2587 - accuracy1000: 0.3822 - val_loss: 3.3174 - val_accuracy1000: 0.3274 - 104s/epoch - 27ms/step
Epoch 6/50
3903/3903 - 103s - loss: 3.2467 - accuracy1000: 0.3905 - val_loss: 3.4034 - val_accuracy1000: 0.3263 - 103s/epoch - 26ms/step
Epoch 7/50
3903/3903 - 104s - loss: 3.2392 - accuracy1000: 0.3957 - val_loss: 3.4771 - val_accuracy1000: 0.3240 - 104s/epoch - 27ms/step
Epoch 8/50
3903/3903 - 103s - loss: 3.2298 - accuracy1000: 0.4014 - val_loss: 3.5147 - val_accuracy1000: 0.3201 - 103s/epoch - 26ms/step
Epoch 9/50
3903/3903 - 103s - loss: 3.2234 - accuracy1000: 0.4048 - val_loss: 3.5488 - val_accuracy1000: 0.3211 - 103s/epoch - 26ms/step
Epoch 10/50
3903/3903 - 103s - loss: 3.2175 - accuracy1000: 0.4073 - val_loss: 3.5652 - val_accuracy1000: 0.3194 - 103s/epoch - 26ms/step
Epoch 11/50
3903/3903 - 104s - loss: 3.2120 - accuracy1000: 0.4107 - val_loss: 3.5652 - val_accuracy1000: 0.3193 - 104s/epoch - 27ms/step
Epoch 12/50
3903/3903 - 104s - loss: 3.2088 - accuracy1000: 0.4124 - val_loss: 3.6126 - val_accuracy1000: 0.3200 - 104s/epoch - 27ms/step
testing model: results/AAPL/W8/deepVOL_L2/h1000
Evaluating performance on  test set...
10609/10609 - 138s - 138s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1169152
{'0': {'precision': 0.32558139534883723, 'recall': 0.00032067592908879237, 'f1-score': 0.0006407207909917044, 'support': 1004129}, '1': {'precision': 0.26302853790309527, 'recall': 0.9986419320966048, 'f1-score': 0.41638658197041667, 'support': 714250}, '2': {'precision': 0.35773480662983426, 'recall': 0.0010388016480447767, 'f1-score': 0.0020715877540369468, 'support': 997303}, 'accuracy': 0.2631523131206084, 'macro avg': {'precision': 0.3154482466272556, 'recall': 0.33333380322457945, 'f1-score': 0.1396996301718151, 'support': 2715682}, 'weighted avg': {'precision': 0.32093737410487383, 'recall': 0.2631523131206084, 'f1-score': 0.11051127605565457, 'support': 2715682}}
[[    322 1002562    1245]
 [    355  713280     615]
 [    312  995955    1036]]
Evaluating performance on  train set...
3903/3903 - 51s - 51s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030291
{'0': {'precision': 0.3149171270718232, 'recall': 0.00035098197984624526, 'f1-score': 0.0007011824765888087, 'support': 324803}, '1': {'precision': 0.33121163399583814, 'recall': 0.9986037571625445, 'f1-score': 0.49743623712473173, 'support': 330888}, '2': {'precision': 0.4016775396085741, 'recall': 0.0012551984436704215, 'f1-score': 0.002502576608747405, 'support': 343372}, 'accuracy': 0.33128141068180883, 'macro avg': {'precision': 0.3492687668920785, 'recall': 0.33340331252868705, 'f1-score': 0.16687999873668932, 'support': 999063}, 'weighted avg': {'precision': 0.3501328774105332, 'recall': 0.33128141068180883, 'f1-score': 0.16583813286746732, 'support': 999063}}
[[   114 324366    323]
 [   143 330426    319]
 [   105 342836    431]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1051736
{'0': {'precision': 0.32941176470588235, 'recall': 0.00028262844453416777, 'f1-score': 0.0005647723261560183, 'support': 99070}, '1': {'precision': 0.31855363132315695, 'recall': 0.9985945110829775, 'f1-score': 0.48302221668664663, 'support': 93206}, '2': {'precision': 0.3451086956521739, 'recall': 0.0012654822284444533, 'f1-score': 0.0025217175477786047, 'support': 100357}, 'accuracy': 0.3185901795081211, 'macro avg': {'precision': 0.331024697227071, 'recall': 0.33338087391865207, 'f1-score': 0.16203623552019375, 'support': 292633}, 'weighted avg': {'precision': 0.33133654324728634, 'recall': 0.3185901795081211, 'f1-score': 0.1549025322871661, 'support': 292633}}
[[    28  98904    138]
 [    28  93075    103]
 [    29 100201    127]]
training model: results/AAPL/W8/deepVOL_L3/h10
Epoch 1/50
3903/3903 - 155s - loss: 3.2570 - accuracy10: 0.3822 - val_loss: 3.4273 - val_accuracy10: 0.3213 - 155s/epoch - 40ms/step
Epoch 2/50
3903/3903 - 149s - loss: 3.2552 - accuracy10: 0.3789 - val_loss: 3.3894 - val_accuracy10: 0.3213 - 149s/epoch - 38ms/step
Epoch 3/50
3903/3903 - 149s - loss: 3.2441 - accuracy10: 0.3859 - val_loss: 3.3815 - val_accuracy10: 0.3214 - 149s/epoch - 38ms/step
Epoch 4/50
3903/3903 - 149s - loss: 3.2069 - accuracy10: 0.4116 - val_loss: 3.3916 - val_accuracy10: 0.3295 - 149s/epoch - 38ms/step
Epoch 5/50
3903/3903 - 148s - loss: 3.1351 - accuracy10: 0.4449 - val_loss: 3.2307 - val_accuracy10: 0.3905 - 148s/epoch - 38ms/step
Epoch 6/50
3903/3903 - 149s - loss: 3.1034 - accuracy10: 0.4591 - val_loss: 3.2198 - val_accuracy10: 0.4026 - 149s/epoch - 38ms/step
Epoch 7/50
3903/3903 - 151s - loss: 3.0864 - accuracy10: 0.4653 - val_loss: 3.2052 - val_accuracy10: 0.4218 - 151s/epoch - 39ms/step
Epoch 8/50
3903/3903 - 148s - loss: 3.0702 - accuracy10: 0.4706 - val_loss: 3.1757 - val_accuracy10: 0.4407 - 148s/epoch - 38ms/step
Epoch 9/50
3903/3903 - 150s - loss: 3.0583 - accuracy10: 0.4745 - val_loss: 3.1823 - val_accuracy10: 0.4366 - 150s/epoch - 38ms/step
Epoch 10/50
3903/3903 - 153s - loss: 3.0508 - accuracy10: 0.4768 - val_loss: 3.2067 - val_accuracy10: 0.4398 - 153s/epoch - 39ms/step
Epoch 11/50
3903/3903 - 153s - loss: 3.0438 - accuracy10: 0.4790 - val_loss: 3.1594 - val_accuracy10: 0.4462 - 153s/epoch - 39ms/step
Epoch 12/50
3903/3903 - 153s - loss: 3.0384 - accuracy10: 0.4805 - val_loss: 3.1560 - val_accuracy10: 0.4504 - 153s/epoch - 39ms/step
Epoch 13/50
3903/3903 - 151s - loss: 3.0335 - accuracy10: 0.4823 - val_loss: 3.1694 - val_accuracy10: 0.4468 - 151s/epoch - 39ms/step
Epoch 14/50
3903/3903 - 154s - loss: 3.0292 - accuracy10: 0.4839 - val_loss: 3.1368 - val_accuracy10: 0.4556 - 154s/epoch - 40ms/step
Epoch 15/50
3903/3903 - 148s - loss: 3.0251 - accuracy10: 0.4849 - val_loss: 3.1357 - val_accuracy10: 0.4558 - 148s/epoch - 38ms/step
Epoch 16/50
3903/3903 - 147s - loss: 3.0220 - accuracy10: 0.4857 - val_loss: 3.1304 - val_accuracy10: 0.4566 - 147s/epoch - 38ms/step
Epoch 17/50
3903/3903 - 149s - loss: 3.0187 - accuracy10: 0.4868 - val_loss: 3.1248 - val_accuracy10: 0.4610 - 149s/epoch - 38ms/step
Epoch 18/50
3903/3903 - 148s - loss: 3.0154 - accuracy10: 0.4875 - val_loss: 3.1352 - val_accuracy10: 0.4547 - 148s/epoch - 38ms/step
Epoch 19/50
3903/3903 - 149s - loss: 3.0127 - accuracy10: 0.4884 - val_loss: 3.1383 - val_accuracy10: 0.4534 - 149s/epoch - 38ms/step
Epoch 20/50
3903/3903 - 148s - loss: 3.0102 - accuracy10: 0.4888 - val_loss: 3.1375 - val_accuracy10: 0.4559 - 148s/epoch - 38ms/step
Epoch 21/50
3903/3903 - 147s - loss: 3.0078 - accuracy10: 0.4899 - val_loss: 3.1394 - val_accuracy10: 0.4541 - 147s/epoch - 38ms/step
Epoch 22/50
3903/3903 - 149s - loss: 3.0054 - accuracy10: 0.4905 - val_loss: 3.1239 - val_accuracy10: 0.4603 - 149s/epoch - 38ms/step
Epoch 23/50
3903/3903 - 148s - loss: 3.0028 - accuracy10: 0.4914 - val_loss: 3.1271 - val_accuracy10: 0.4581 - 148s/epoch - 38ms/step
Epoch 24/50
3903/3903 - 150s - loss: 3.0007 - accuracy10: 0.4921 - val_loss: 3.1267 - val_accuracy10: 0.4559 - 150s/epoch - 38ms/step
Epoch 25/50
3903/3903 - 150s - loss: 2.9989 - accuracy10: 0.4925 - val_loss: 3.1310 - val_accuracy10: 0.4561 - 150s/epoch - 38ms/step
Epoch 26/50
3903/3903 - 147s - loss: 2.9965 - accuracy10: 0.4935 - val_loss: 3.1316 - val_accuracy10: 0.4568 - 147s/epoch - 38ms/step
Epoch 27/50
3903/3903 - 149s - loss: 2.9951 - accuracy10: 0.4941 - val_loss: 3.1208 - val_accuracy10: 0.4597 - 149s/epoch - 38ms/step
Epoch 28/50
3903/3903 - 148s - loss: 2.9924 - accuracy10: 0.4949 - val_loss: 3.1283 - val_accuracy10: 0.4583 - 148s/epoch - 38ms/step
Epoch 29/50
3903/3903 - 150s - loss: 2.9908 - accuracy10: 0.4951 - val_loss: 3.1359 - val_accuracy10: 0.4520 - 150s/epoch - 39ms/step
Epoch 30/50
3903/3903 - 150s - loss: 2.9892 - accuracy10: 0.4952 - val_loss: 3.1316 - val_accuracy10: 0.4558 - 150s/epoch - 38ms/step
Epoch 31/50
3903/3903 - 149s - loss: 2.9867 - accuracy10: 0.4958 - val_loss: 3.1159 - val_accuracy10: 0.4609 - 149s/epoch - 38ms/step
Epoch 32/50
3903/3903 - 151s - loss: 2.9854 - accuracy10: 0.4966 - val_loss: 3.1114 - val_accuracy10: 0.4633 - 151s/epoch - 39ms/step
Epoch 33/50
3903/3903 - 152s - loss: 2.9841 - accuracy10: 0.4972 - val_loss: 3.1145 - val_accuracy10: 0.4616 - 152s/epoch - 39ms/step
Epoch 34/50
3903/3903 - 150s - loss: 2.9819 - accuracy10: 0.4975 - val_loss: 3.1279 - val_accuracy10: 0.4582 - 150s/epoch - 38ms/step
Epoch 35/50
3903/3903 - 151s - loss: 2.9799 - accuracy10: 0.4981 - val_loss: 3.1170 - val_accuracy10: 0.4610 - 151s/epoch - 39ms/step
Epoch 36/50
3903/3903 - 149s - loss: 2.9784 - accuracy10: 0.4983 - val_loss: 3.1129 - val_accuracy10: 0.4630 - 149s/epoch - 38ms/step
Epoch 37/50
3903/3903 - 147s - loss: 2.9769 - accuracy10: 0.4988 - val_loss: 3.1164 - val_accuracy10: 0.4614 - 147s/epoch - 38ms/step
Epoch 38/50
3903/3903 - 152s - loss: 2.9751 - accuracy10: 0.4996 - val_loss: 3.1239 - val_accuracy10: 0.4583 - 152s/epoch - 39ms/step
Epoch 39/50
3903/3903 - 152s - loss: 2.9737 - accuracy10: 0.4998 - val_loss: 3.1209 - val_accuracy10: 0.4595 - 152s/epoch - 39ms/step
Epoch 40/50
3903/3903 - 152s - loss: 2.9720 - accuracy10: 0.5006 - val_loss: 3.1238 - val_accuracy10: 0.4595 - 152s/epoch - 39ms/step
Epoch 41/50
3903/3903 - 150s - loss: 2.9707 - accuracy10: 0.5007 - val_loss: 3.1159 - val_accuracy10: 0.4623 - 150s/epoch - 38ms/step
Epoch 42/50
3903/3903 - 150s - loss: 2.9695 - accuracy10: 0.5011 - val_loss: 3.1150 - val_accuracy10: 0.4632 - 150s/epoch - 38ms/step
testing model: results/AAPL/W8/deepVOL_L3/h10
Evaluating performance on  test set...
10609/10609 - 192s - 192s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0297688
{'0': {'precision': 0.46827106912886846, 'recall': 0.47225887218311835, 'f1-score': 0.47025651660657886, 'support': 873883}, '1': {'precision': 0.4615757267607236, 'recall': 0.5520344529185262, 'f1-score': 0.5027686361308225, 'support': 940646}, '2': {'precision': 0.4893785286841048, 'recall': 0.3852264820735214, 'f1-score': 0.43110104947600714, 'support': 901153}, 'accuracy': 0.4710109652013748, 'macro avg': {'precision': 0.4730751081912323, 'recall': 0.4698399357250553, 'f1-score': 0.46804206740446946, 'support': 2715682}, 'weighted avg': {'precision': 0.4729561182190616, 'recall': 0.4710109652013748, 'f1-score': 0.468524844235103, 'support': 2715682}}
[[412699 284774 176410]
 [235570 519269 185807]
 [233056 320949 347148]]
Evaluating performance on  train set...
3903/3903 - 82s - 82s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.027341
{'0': {'precision': 0.4932965579534824, 'recall': 0.45467574133045513, 'f1-score': 0.47319943494695277, 'support': 336321}, '1': {'precision': 0.4373240139790315, 'recall': 0.605253136957443, 'f1-score': 0.5077643051929065, 'support': 325634}, '2': {'precision': 0.5173155815065562, 'recall': 0.36583824768323503, 'f1-score': 0.4285863222972479, 'support': 337108}, 'accuracy': 0.47377893085821415, 'macro avg': {'precision': 0.48264538447969, 'recall': 0.47525570865704436, 'f1-score': 0.46985002081236904, 'support': 999063}, 'weighted avg': {'precision': 0.48315749926284246, 'recall': 0.47377893085821415, 'f1-score': 0.4694119458482215, 'support': 999063}}
[[152917 123293  60111]
 [ 73583 197091  54960]
 [ 83490 130291 123327]]
Evaluating performance on  val set...
1144/1144 - 25s - 25s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0389621
{'0': {'precision': 0.4855339958984067, 'recall': 0.464391333212626, 'f1-score': 0.47472737649036756, 'support': 99414}, '1': {'precision': 0.4221199727334697, 'recall': 0.5532075551963245, 'f1-score': 0.47885443900283536, 'support': 94028}, '2': {'precision': 0.5034983853606028, 'recall': 0.37725196842455466, 'f1-score': 0.4313271204707483, 'support': 99191}, 'accuracy': 0.4633927137404189, 'macro avg': {'precision': 0.470384117997493, 'recall': 0.4649502856111683, 'f1-score': 0.46163631198798377, 'support': 292633}, 'weighted avg': {'precision': 0.47124719975782103, 'recall': 0.4633927137404189, 'f1-score': 0.46134250410441063, 'support': 292633}}
[[46167 34445 18802]
 [23913 52017 18098]
 [25005 36766 37420]]
training model: results/AAPL/W8/deepVOL_L3/h20
Epoch 1/50
3903/3903 - 152s - loss: 3.2678 - accuracy20: 0.3767 - val_loss: 3.4509 - val_accuracy20: 0.3263 - 152s/epoch - 39ms/step
Epoch 2/50
3903/3903 - 149s - loss: 3.2636 - accuracy20: 0.3764 - val_loss: 3.4251 - val_accuracy20: 0.3262 - 149s/epoch - 38ms/step
Epoch 3/50
3903/3903 - 152s - loss: 3.2516 - accuracy20: 0.3859 - val_loss: 3.4364 - val_accuracy20: 0.3273 - 152s/epoch - 39ms/step
Epoch 4/50
3903/3903 - 149s - loss: 3.2164 - accuracy20: 0.4081 - val_loss: 3.3759 - val_accuracy20: 0.3312 - 149s/epoch - 38ms/step
Epoch 5/50
3903/3903 - 155s - loss: 3.1926 - accuracy20: 0.4212 - val_loss: 3.3772 - val_accuracy20: 0.3348 - 155s/epoch - 40ms/step
Epoch 6/50
3903/3903 - 154s - loss: 3.1755 - accuracy20: 0.4292 - val_loss: 3.3545 - val_accuracy20: 0.3420 - 154s/epoch - 40ms/step
Epoch 7/50
3903/3903 - 153s - loss: 3.1622 - accuracy20: 0.4354 - val_loss: 3.3161 - val_accuracy20: 0.3565 - 153s/epoch - 39ms/step
Epoch 8/50
3903/3903 - 151s - loss: 3.1513 - accuracy20: 0.4400 - val_loss: 3.2846 - val_accuracy20: 0.3712 - 151s/epoch - 39ms/step
Epoch 9/50
3903/3903 - 148s - loss: 3.1408 - accuracy20: 0.4445 - val_loss: 3.2831 - val_accuracy20: 0.3742 - 148s/epoch - 38ms/step
Epoch 10/50
3903/3903 - 151s - loss: 3.1342 - accuracy20: 0.4465 - val_loss: 3.2802 - val_accuracy20: 0.3757 - 151s/epoch - 39ms/step
Epoch 11/50
3903/3903 - 151s - loss: 3.1285 - accuracy20: 0.4483 - val_loss: 3.2844 - val_accuracy20: 0.3757 - 151s/epoch - 39ms/step
Epoch 12/50
3903/3903 - 151s - loss: 3.1244 - accuracy20: 0.4498 - val_loss: 3.2717 - val_accuracy20: 0.3778 - 151s/epoch - 39ms/step
Epoch 13/50
3903/3903 - 151s - loss: 3.1209 - accuracy20: 0.4511 - val_loss: 3.2666 - val_accuracy20: 0.3841 - 151s/epoch - 39ms/step
Epoch 14/50
3903/3903 - 150s - loss: 3.1177 - accuracy20: 0.4519 - val_loss: 3.2661 - val_accuracy20: 0.3848 - 150s/epoch - 38ms/step
Epoch 15/50
3903/3903 - 156s - loss: 3.1152 - accuracy20: 0.4526 - val_loss: 3.2580 - val_accuracy20: 0.3889 - 156s/epoch - 40ms/step
Epoch 16/50
3903/3903 - 149s - loss: 3.1125 - accuracy20: 0.4540 - val_loss: 3.2539 - val_accuracy20: 0.3896 - 149s/epoch - 38ms/step
Epoch 17/50
3903/3903 - 147s - loss: 3.1106 - accuracy20: 0.4546 - val_loss: 3.2485 - val_accuracy20: 0.3949 - 147s/epoch - 38ms/step
Epoch 18/50
3903/3903 - 149s - loss: 3.1089 - accuracy20: 0.4551 - val_loss: 3.2388 - val_accuracy20: 0.4009 - 149s/epoch - 38ms/step
Epoch 19/50
3903/3903 - 149s - loss: 3.1061 - accuracy20: 0.4556 - val_loss: 3.2394 - val_accuracy20: 0.4034 - 149s/epoch - 38ms/step
Epoch 20/50
3903/3903 - 149s - loss: 3.1045 - accuracy20: 0.4565 - val_loss: 3.2373 - val_accuracy20: 0.4049 - 149s/epoch - 38ms/step
Epoch 21/50
3903/3903 - 149s - loss: 3.1031 - accuracy20: 0.4570 - val_loss: 3.2358 - val_accuracy20: 0.4073 - 149s/epoch - 38ms/step
Epoch 22/50
3903/3903 - 150s - loss: 3.1014 - accuracy20: 0.4571 - val_loss: 3.2330 - val_accuracy20: 0.4072 - 150s/epoch - 38ms/step
Epoch 23/50
3903/3903 - 149s - loss: 3.0999 - accuracy20: 0.4582 - val_loss: 3.2302 - val_accuracy20: 0.4106 - 149s/epoch - 38ms/step
Epoch 24/50
3903/3903 - 149s - loss: 3.0981 - accuracy20: 0.4581 - val_loss: 3.2281 - val_accuracy20: 0.4121 - 149s/epoch - 38ms/step
Epoch 25/50
3903/3903 - 150s - loss: 3.0970 - accuracy20: 0.4592 - val_loss: 3.2203 - val_accuracy20: 0.4146 - 150s/epoch - 38ms/step
Epoch 26/50
3903/3903 - 148s - loss: 3.0955 - accuracy20: 0.4594 - val_loss: 3.2239 - val_accuracy20: 0.4138 - 148s/epoch - 38ms/step
Epoch 27/50
3903/3903 - 150s - loss: 3.0943 - accuracy20: 0.4596 - val_loss: 3.2203 - val_accuracy20: 0.4166 - 150s/epoch - 38ms/step
Epoch 28/50
3903/3903 - 149s - loss: 3.0929 - accuracy20: 0.4605 - val_loss: 3.2104 - val_accuracy20: 0.4214 - 149s/epoch - 38ms/step
Epoch 29/50
3903/3903 - 150s - loss: 3.0916 - accuracy20: 0.4606 - val_loss: 3.2269 - val_accuracy20: 0.4155 - 150s/epoch - 39ms/step
Epoch 30/50
3903/3903 - 149s - loss: 3.0903 - accuracy20: 0.4610 - val_loss: 3.2134 - val_accuracy20: 0.4182 - 149s/epoch - 38ms/step
Epoch 31/50
3903/3903 - 149s - loss: 3.0892 - accuracy20: 0.4613 - val_loss: 3.2246 - val_accuracy20: 0.4147 - 149s/epoch - 38ms/step
Epoch 32/50
3903/3903 - 149s - loss: 3.0879 - accuracy20: 0.4620 - val_loss: 3.2172 - val_accuracy20: 0.4181 - 149s/epoch - 38ms/step
Epoch 33/50
3903/3903 - 149s - loss: 3.0868 - accuracy20: 0.4623 - val_loss: 3.2135 - val_accuracy20: 0.4199 - 149s/epoch - 38ms/step
Epoch 34/50
3903/3903 - 150s - loss: 3.0855 - accuracy20: 0.4626 - val_loss: 3.2191 - val_accuracy20: 0.4189 - 150s/epoch - 38ms/step
Epoch 35/50
3903/3903 - 150s - loss: 3.0841 - accuracy20: 0.4630 - val_loss: 3.2219 - val_accuracy20: 0.4161 - 150s/epoch - 38ms/step
Epoch 36/50
3903/3903 - 149s - loss: 3.0833 - accuracy20: 0.4635 - val_loss: 3.2109 - val_accuracy20: 0.4212 - 149s/epoch - 38ms/step
Epoch 37/50
3903/3903 - 150s - loss: 3.0822 - accuracy20: 0.4638 - val_loss: 3.2147 - val_accuracy20: 0.4188 - 150s/epoch - 39ms/step
Epoch 38/50
3903/3903 - 149s - loss: 3.0811 - accuracy20: 0.4642 - val_loss: 3.2146 - val_accuracy20: 0.4216 - 149s/epoch - 38ms/step
testing model: results/AAPL/W8/deepVOL_L3/h20
Evaluating performance on  test set...
10609/10609 - 193s - 193s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0604569
{'0': {'precision': 0.4634490653436104, 'recall': 0.38979915758104455, 'f1-score': 0.42344548842644136, 'support': 895279}, '1': {'precision': 0.3921077116830636, 'recall': 0.5440112131049248, 'f1-score': 0.4557348137124993, 'support': 893954}, '2': {'precision': 0.4823533645993101, 'recall': 0.37611784350784555, 'f1-score': 0.42266229918616155, 'support': 926449}, 'accuracy': 0.4358956608321593, 'macro avg': {'precision': 0.4459700472086614, 'recall': 0.43664273806460496, 'f1-score': 0.43394753377503403, 'support': 2715682}, 'weighted avg': {'precision': 0.4464139267194575, 'recall': 0.4358956608321593, 'f1-score': 0.4338073741731174, 'support': 2715682}}
[[348979 374744 171556]
 [205239 486321 202394]
 [198786 379209 348454]]
Evaluating performance on  train set...
3903/3903 - 71s - 71s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0642779
{'0': {'precision': 0.4670003758102197, 'recall': 0.3607790435256299, 'f1-score': 0.40707450553941077, 'support': 334102}, '1': {'precision': 0.3867397001162493, 'recall': 0.5963752373718192, 'f1-score': 0.4692065427207152, 'support': 329125}, '2': {'precision': 0.4850872232503941, 'recall': 0.3371615907764504, 'f1-score': 0.397818220145452, 'support': 335836}, 'accuracy': 0.4304533347746839, 'macro avg': {'precision': 0.44627576639228766, 'recall': 0.4314386238912999, 'f1-score': 0.4246997561351926, 'support': 999063}, 'weighted avg': {'precision': 0.446639717482507, 'recall': 0.4304533347746839, 'f1-score': 0.42443138180820594, 'support': 999063}}
[[120537 156866  56699]
 [ 69349 196282  63494]
 [ 68223 154382 113231]]
Evaluating performance on  val set...
1144/1144 - 21s - 21s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0713845
{'0': {'precision': 0.4634055311578607, 'recall': 0.376709142394822, 'f1-score': 0.415583980899359, 'support': 98880}, '1': {'precision': 0.3731378043011535, 'recall': 0.5370265627618569, 'f1-score': 0.4403268678315162, 'support': 95472}, '2': {'precision': 0.46611086616698066, 'recall': 0.3549719681321924, 'f1-score': 0.4030197310660321, 'support': 98281}, 'accuracy': 0.42171252046078195, 'macro avg': {'precision': 0.4342180672086649, 'recall': 0.4229025577629571, 'f1-score': 0.4196435265989691, 'support': 292633}, 'weighted avg': {'precision': 0.4348641247258034, 'recall': 0.42171252046078195, 'f1-score': 0.4194366764713475, 'support': 292633}}
[[37249 43097 18534]
 [22775 51271 21426]
 [20357 43037 34887]]
training model: results/AAPL/W8/deepVOL_L3/h30
Epoch 1/50
3903/3903 - 153s - loss: 3.2725 - accuracy30: 0.3735 - val_loss: 3.4160 - val_accuracy30: 0.3212 - 153s/epoch - 39ms/step
Epoch 2/50
3903/3903 - 149s - loss: 3.2653 - accuracy30: 0.3754 - val_loss: 3.3949 - val_accuracy30: 0.3275 - 149s/epoch - 38ms/step
Epoch 3/50
3903/3903 - 149s - loss: 3.2499 - accuracy30: 0.3887 - val_loss: 3.3483 - val_accuracy30: 0.3312 - 149s/epoch - 38ms/step
Epoch 4/50
3903/3903 - 150s - loss: 3.2313 - accuracy30: 0.4009 - val_loss: 3.3256 - val_accuracy30: 0.3361 - 150s/epoch - 38ms/step
Epoch 5/50
3903/3903 - 150s - loss: 3.2179 - accuracy30: 0.4083 - val_loss: 3.3466 - val_accuracy30: 0.3423 - 150s/epoch - 38ms/step
Epoch 6/50
3903/3903 - 149s - loss: 3.2097 - accuracy30: 0.4144 - val_loss: 3.3469 - val_accuracy30: 0.3455 - 149s/epoch - 38ms/step
Epoch 7/50
3903/3903 - 149s - loss: 3.2022 - accuracy30: 0.4183 - val_loss: 3.3564 - val_accuracy30: 0.3443 - 149s/epoch - 38ms/step
Epoch 8/50
3903/3903 - 150s - loss: 3.1927 - accuracy30: 0.4220 - val_loss: 3.3486 - val_accuracy30: 0.3520 - 150s/epoch - 38ms/step
Epoch 9/50
3903/3903 - 151s - loss: 3.1862 - accuracy30: 0.4248 - val_loss: 3.3388 - val_accuracy30: 0.3563 - 151s/epoch - 39ms/step
Epoch 10/50
3903/3903 - 150s - loss: 3.1804 - accuracy30: 0.4273 - val_loss: 3.3197 - val_accuracy30: 0.3591 - 150s/epoch - 38ms/step
Epoch 11/50
3903/3903 - 150s - loss: 3.1764 - accuracy30: 0.4290 - val_loss: 3.3166 - val_accuracy30: 0.3638 - 150s/epoch - 38ms/step
Epoch 12/50
3903/3903 - 149s - loss: 3.1724 - accuracy30: 0.4302 - val_loss: 3.3132 - val_accuracy30: 0.3610 - 149s/epoch - 38ms/step
Epoch 13/50
3903/3903 - 150s - loss: 3.1691 - accuracy30: 0.4319 - val_loss: 3.2983 - val_accuracy30: 0.3674 - 150s/epoch - 38ms/step
Epoch 14/50
3903/3903 - 150s - loss: 3.1657 - accuracy30: 0.4335 - val_loss: 3.2932 - val_accuracy30: 0.3683 - 150s/epoch - 38ms/step
Epoch 15/50
3903/3903 - 151s - loss: 3.1634 - accuracy30: 0.4341 - val_loss: 3.2971 - val_accuracy30: 0.3660 - 151s/epoch - 39ms/step
Epoch 16/50
3903/3903 - 149s - loss: 3.1606 - accuracy30: 0.4347 - val_loss: 3.2961 - val_accuracy30: 0.3683 - 149s/epoch - 38ms/step
Epoch 17/50
3903/3903 - 149s - loss: 3.1589 - accuracy30: 0.4355 - val_loss: 3.2940 - val_accuracy30: 0.3683 - 149s/epoch - 38ms/step
Epoch 18/50
3903/3903 - 149s - loss: 3.1567 - accuracy30: 0.4364 - val_loss: 3.2943 - val_accuracy30: 0.3707 - 149s/epoch - 38ms/step
Epoch 19/50
3903/3903 - 149s - loss: 3.1546 - accuracy30: 0.4374 - val_loss: 3.2952 - val_accuracy30: 0.3705 - 149s/epoch - 38ms/step
Epoch 20/50
3903/3903 - 151s - loss: 3.1527 - accuracy30: 0.4382 - val_loss: 3.2968 - val_accuracy30: 0.3701 - 151s/epoch - 39ms/step
Epoch 21/50
3903/3903 - 149s - loss: 3.1516 - accuracy30: 0.4383 - val_loss: 3.2867 - val_accuracy30: 0.3746 - 149s/epoch - 38ms/step
Epoch 22/50
3903/3903 - 151s - loss: 3.1499 - accuracy30: 0.4390 - val_loss: 3.2966 - val_accuracy30: 0.3689 - 151s/epoch - 39ms/step
Epoch 23/50
3903/3903 - 150s - loss: 3.1482 - accuracy30: 0.4400 - val_loss: 3.2929 - val_accuracy30: 0.3728 - 150s/epoch - 38ms/step
Epoch 24/50
3903/3903 - 149s - loss: 3.1468 - accuracy30: 0.4408 - val_loss: 3.2930 - val_accuracy30: 0.3740 - 149s/epoch - 38ms/step
Epoch 25/50
3903/3903 - 150s - loss: 3.1454 - accuracy30: 0.4408 - val_loss: 3.2884 - val_accuracy30: 0.3763 - 150s/epoch - 38ms/step
Epoch 26/50
3903/3903 - 149s - loss: 3.1439 - accuracy30: 0.4417 - val_loss: 3.2874 - val_accuracy30: 0.3758 - 149s/epoch - 38ms/step
Epoch 27/50
3903/3903 - 149s - loss: 3.1427 - accuracy30: 0.4422 - val_loss: 3.2860 - val_accuracy30: 0.3806 - 149s/epoch - 38ms/step
Epoch 28/50
3903/3903 - 150s - loss: 3.1412 - accuracy30: 0.4425 - val_loss: 3.2839 - val_accuracy30: 0.3792 - 150s/epoch - 38ms/step
Epoch 29/50
3903/3903 - 149s - loss: 3.1402 - accuracy30: 0.4431 - val_loss: 3.2777 - val_accuracy30: 0.3833 - 149s/epoch - 38ms/step
Epoch 30/50
3903/3903 - 149s - loss: 3.1389 - accuracy30: 0.4437 - val_loss: 3.2773 - val_accuracy30: 0.3832 - 149s/epoch - 38ms/step
Epoch 31/50
3903/3903 - 148s - loss: 3.1372 - accuracy30: 0.4441 - val_loss: 3.2828 - val_accuracy30: 0.3833 - 148s/epoch - 38ms/step
Epoch 32/50
3903/3903 - 150s - loss: 3.1364 - accuracy30: 0.4449 - val_loss: 3.2830 - val_accuracy30: 0.3835 - 150s/epoch - 38ms/step
Epoch 33/50
3903/3903 - 149s - loss: 3.1349 - accuracy30: 0.4454 - val_loss: 3.2831 - val_accuracy30: 0.3822 - 149s/epoch - 38ms/step
Epoch 34/50
3903/3903 - 150s - loss: 3.1338 - accuracy30: 0.4456 - val_loss: 3.2791 - val_accuracy30: 0.3875 - 150s/epoch - 39ms/step
Epoch 35/50
3903/3903 - 149s - loss: 3.1321 - accuracy30: 0.4466 - val_loss: 3.2863 - val_accuracy30: 0.3821 - 149s/epoch - 38ms/step
Epoch 36/50
3903/3903 - 150s - loss: 3.1312 - accuracy30: 0.4469 - val_loss: 3.2794 - val_accuracy30: 0.3882 - 150s/epoch - 38ms/step
Epoch 37/50
3903/3903 - 148s - loss: 3.1298 - accuracy30: 0.4472 - val_loss: 3.2751 - val_accuracy30: 0.3896 - 148s/epoch - 38ms/step
Epoch 38/50
3903/3903 - 150s - loss: 3.1286 - accuracy30: 0.4476 - val_loss: 3.2829 - val_accuracy30: 0.3867 - 150s/epoch - 38ms/step
Epoch 39/50
3903/3903 - 149s - loss: 3.1274 - accuracy30: 0.4482 - val_loss: 3.2758 - val_accuracy30: 0.3913 - 149s/epoch - 38ms/step
Epoch 40/50
3903/3903 - 150s - loss: 3.1263 - accuracy30: 0.4485 - val_loss: 3.2794 - val_accuracy30: 0.3870 - 150s/epoch - 38ms/step
Epoch 41/50
3903/3903 - 149s - loss: 3.1248 - accuracy30: 0.4493 - val_loss: 3.2785 - val_accuracy30: 0.3897 - 149s/epoch - 38ms/step
Epoch 42/50
3903/3903 - 149s - loss: 3.1239 - accuracy30: 0.4490 - val_loss: 3.2799 - val_accuracy30: 0.3886 - 149s/epoch - 38ms/step
Epoch 43/50
3903/3903 - 149s - loss: 3.1224 - accuracy30: 0.4503 - val_loss: 3.2967 - val_accuracy30: 0.3831 - 149s/epoch - 38ms/step
Epoch 44/50
3903/3903 - 148s - loss: 3.1207 - accuracy30: 0.4505 - val_loss: 3.2815 - val_accuracy30: 0.3899 - 148s/epoch - 38ms/step
Epoch 45/50
3903/3903 - 150s - loss: 3.1197 - accuracy30: 0.4507 - val_loss: 3.2792 - val_accuracy30: 0.3912 - 150s/epoch - 38ms/step
Epoch 46/50
3903/3903 - 154s - loss: 3.1186 - accuracy30: 0.4507 - val_loss: 3.2858 - val_accuracy30: 0.3890 - 154s/epoch - 39ms/step
Epoch 47/50
3903/3903 - 150s - loss: 3.1173 - accuracy30: 0.4519 - val_loss: 3.2917 - val_accuracy30: 0.3864 - 150s/epoch - 38ms/step
testing model: results/AAPL/W8/deepVOL_L3/h30
Evaluating performance on  test set...
10609/10609 - 195s - 195s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0907525
{'0': {'precision': 0.48698387847188884, 'recall': 0.21442577106716454, 'f1-score': 0.29774866572547504, 'support': 922585}, '1': {'precision': 0.3351881436418692, 'recall': 0.6770858229255866, 'f1-score': 0.44839865010502805, 'support': 832633}, '2': {'precision': 0.4859590580091216, 'recall': 0.317502790318013, 'f1-score': 0.3840713960954316, 'support': 960464}, 'accuracy': 0.39273375895999607, 'macro avg': {'precision': 0.4360436933742932, 'recall': 0.4030047947702547, 'f1-score': 0.37673957064197827, 'support': 2715682}, 'weighted avg': {'precision': 0.440080580795771, 'recall': 0.39273375895999607, 'f1-score': 0.37446826078334644, 'support': 2715682}}
[[197826 566729 158030]
 [104327 563764 164542]
 [104074 551440 304950]]
Evaluating performance on  train set...
3903/3903 - 72s - 72s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0847028
{'0': {'precision': 0.4885442631759631, 'recall': 0.19566185547289483, 'f1-score': 0.2794171943460937, 'support': 334567}, '1': {'precision': 0.3584556509288149, 'recall': 0.7199591768343767, 'f1-score': 0.47861625921747886, 'support': 328245}, '2': {'precision': 0.4748624798336152, 'recall': 0.2906192100543939, 'f1-score': 0.36056815100020484, 'support': 336251}, 'accuracy': 0.39988068820484796, 'macro avg': {'precision': 0.44062079797946435, 'recall': 0.4020800807872218, 'f1-score': 0.37286720152125913, 'support': 999063}, 'weighted avg': {'precision': 0.4411984502915774, 'recall': 0.39988068820484796, 'f1-score': 0.37217729793776844, 'support': 999063}}
[[ 65462 217260  51845]
 [ 35700 236323  56222]
 [ 32832 205698  97721]]
Evaluating performance on  val set...
1144/1144 - 21s - 21s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0934588
{'0': {'precision': 0.492693741811952, 'recall': 0.1954349216501439, 'f1-score': 0.2798591831477718, 'support': 100064}, '1': {'precision': 0.344442498261705, 'recall': 0.6906408973840489, 'f1-score': 0.45964620261009687, 'support': 93962}, '2': {'precision': 0.4595742043447271, 'recall': 0.3007900047663959, 'f1-score': 0.3636029299089767, 'support': 98607}, 'accuracy': 0.38994235099937463, 'macro avg': {'precision': 0.432236814806128, 'recall': 0.3956219412668629, 'f1-score': 0.36770277188894845, 'support': 292633}, 'weighted avg': {'precision': 0.4339313958786535, 'recall': 0.38994235099937463, 'f1-score': 0.36580597506666385, 'support': 292633}}
[[19556 63869 16639]
 [10829 64894 18239]
 [ 9307 59640 29660]]
training model: results/AAPL/W8/deepVOL_L3/h50
Epoch 1/50
3903/3903 - 153s - loss: 3.2536 - accuracy50: 0.3817 - val_loss: 3.5290 - val_accuracy50: 0.3367 - 153s/epoch - 39ms/step
Epoch 2/50
3903/3903 - 152s - loss: 3.2547 - accuracy50: 0.3780 - val_loss: 3.5338 - val_accuracy50: 0.3369 - 152s/epoch - 39ms/step
Epoch 3/50
3903/3903 - 151s - loss: 3.2426 - accuracy50: 0.3859 - val_loss: 3.5031 - val_accuracy50: 0.3380 - 151s/epoch - 39ms/step
Epoch 4/50
3903/3903 - 152s - loss: 3.2322 - accuracy50: 0.3927 - val_loss: 3.5234 - val_accuracy50: 0.3371 - 152s/epoch - 39ms/step
Epoch 5/50
3903/3903 - 151s - loss: 3.2255 - accuracy50: 0.3978 - val_loss: 3.5170 - val_accuracy50: 0.3372 - 151s/epoch - 39ms/step
Epoch 6/50
3903/3903 - 152s - loss: 3.2219 - accuracy50: 0.4018 - val_loss: 3.5019 - val_accuracy50: 0.3370 - 152s/epoch - 39ms/step
Epoch 7/50
3903/3903 - 151s - loss: 3.2138 - accuracy50: 0.4084 - val_loss: 3.4773 - val_accuracy50: 0.3380 - 151s/epoch - 39ms/step
Epoch 8/50
3903/3903 - 151s - loss: 3.2059 - accuracy50: 0.4134 - val_loss: 3.5084 - val_accuracy50: 0.3369 - 151s/epoch - 39ms/step
Epoch 9/50
3903/3903 - 152s - loss: 3.1969 - accuracy50: 0.4196 - val_loss: 3.4726 - val_accuracy50: 0.3379 - 152s/epoch - 39ms/step
Epoch 10/50
3903/3903 - 150s - loss: 3.1900 - accuracy50: 0.4235 - val_loss: 3.4637 - val_accuracy50: 0.3382 - 150s/epoch - 38ms/step
Epoch 11/50
3903/3903 - 152s - loss: 3.1847 - accuracy50: 0.4256 - val_loss: 3.4452 - val_accuracy50: 0.3390 - 152s/epoch - 39ms/step
Epoch 12/50
3903/3903 - 151s - loss: 3.1799 - accuracy50: 0.4286 - val_loss: 3.4380 - val_accuracy50: 0.3391 - 151s/epoch - 39ms/step
Epoch 13/50
3903/3903 - 164s - loss: 3.1761 - accuracy50: 0.4305 - val_loss: 3.4511 - val_accuracy50: 0.3395 - 164s/epoch - 42ms/step
Epoch 14/50
3903/3903 - 152s - loss: 3.1734 - accuracy50: 0.4313 - val_loss: 3.4474 - val_accuracy50: 0.3405 - 152s/epoch - 39ms/step
Epoch 15/50
3903/3903 - 153s - loss: 3.1711 - accuracy50: 0.4328 - val_loss: 3.4421 - val_accuracy50: 0.3408 - 153s/epoch - 39ms/step
Epoch 16/50
3903/3903 - 159s - loss: 3.1691 - accuracy50: 0.4336 - val_loss: 3.4470 - val_accuracy50: 0.3411 - 159s/epoch - 41ms/step
Epoch 17/50
3903/3903 - 153s - loss: 3.1671 - accuracy50: 0.4347 - val_loss: 3.4563 - val_accuracy50: 0.3408 - 153s/epoch - 39ms/step
Epoch 18/50
3903/3903 - 153s - loss: 3.1653 - accuracy50: 0.4355 - val_loss: 3.4548 - val_accuracy50: 0.3406 - 153s/epoch - 39ms/step
Epoch 19/50
3903/3903 - 153s - loss: 3.1634 - accuracy50: 0.4360 - val_loss: 3.4636 - val_accuracy50: 0.3409 - 153s/epoch - 39ms/step
Epoch 20/50
3903/3903 - 156s - loss: 3.1625 - accuracy50: 0.4366 - val_loss: 3.4697 - val_accuracy50: 0.3411 - 156s/epoch - 40ms/step
Epoch 21/50
3903/3903 - 153s - loss: 3.1608 - accuracy50: 0.4372 - val_loss: 3.4591 - val_accuracy50: 0.3427 - 153s/epoch - 39ms/step
Epoch 22/50
3903/3903 - 154s - loss: 3.1592 - accuracy50: 0.4376 - val_loss: 3.4571 - val_accuracy50: 0.3423 - 154s/epoch - 39ms/step
testing model: results/AAPL/W8/deepVOL_L3/h50
Evaluating performance on  test set...
10609/10609 - 197s - 197s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1486744
{'0': {'precision': 0.5331161780673181, 'recall': 0.00492988936475938, 'f1-score': 0.009769437732270098, 'support': 896369}, '1': {'precision': 0.3308690920224285, 'recall': 0.9901466631295713, 'f1-score': 0.49599548850350084, 'support': 897158}, '2': {'precision': 0.5052011863131336, 'recall': 0.012376444307085035, 'f1-score': 0.024160991419916043, 'support': 922155}, 'accuracy': 0.3329366251276843, 'macro avg': {'precision': 0.4563954854676267, 'recall': 0.3358176656004719, 'f1-score': 0.17664197255189565, 'support': 2715682}, 'weighted avg': {'precision': 0.4568224365898767, 'recall': 0.3329366251276843, 'f1-score': 0.17528691527516613, 'support': 2715682}}
[[  4419 887199   4751]
 [  2413 888318   6427]
 [  1457 909285  11413]]
Evaluating performance on  train set...
3903/3903 - 71s - 71s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1654031
{'0': {'precision': 0.5048342541436464, 'recall': 0.004322527998864671, 'f1-score': 0.00857166309025457, 'support': 338228}, '1': {'precision': 0.3226938352406769, 'recall': 0.9919129681332435, 'f1-score': 0.4869656829561325, 'support': 321997}, '2': {'precision': 0.49218261413383363, 'recall': 0.00929057543722959, 'f1-score': 0.018236905982608895, 'support': 338838}, 'accuracy': 0.3243068755423832, 'macro avg': {'precision': 0.43990356783938567, 'recall': 0.33517535718977925, 'f1-score': 0.17125808400966533, 'support': 999063}, 'weighted avg': {'precision': 0.44183970338644246, 'recall': 0.3243068755423832, 'f1-score': 0.16603559758278674, 'support': 999063}}
[[  1462 335308   1458]
 [   814 319393   1790]
 [   620 335070   3148]]
Evaluating performance on  val set...
1144/1144 - 21s - 21s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1536245
{'0': {'precision': 0.5017462165308498, 'recall': 0.0044037109694294585, 'f1-score': 0.008730793772979103, 'support': 97872}, '1': {'precision': 0.33725563377117956, 'recall': 0.9903996427774057, 'f1-score': 0.5031695578086613, 'support': 98538}, '2': {'precision': 0.4848106533499792, 'recall': 0.012107292435280546, 'f1-score': 0.023624602031918563, 'support': 96223}, 'accuracy': 0.3389501525801943, 'macro avg': {'precision': 0.4412708345506695, 'recall': 0.33563688206070524, 'f1-score': 0.17850831787118634, 'support': 292633}, 'weighted avg': {'precision': 0.4407887587597669, 'recall': 0.3389501525801943, 'f1-score': 0.1801199872086066, 'support': 292633}}
[[  431 96908   533]
 [  241 97592   705]
 [  187 94871  1165]]
training model: results/AAPL/W8/deepVOL_L3/h100
Epoch 1/50
3903/3903 - 154s - loss: 3.2609 - accuracy100: 0.3831 - val_loss: 3.4167 - val_accuracy100: 0.3171 - 154s/epoch - 39ms/step
Epoch 2/50
3903/3903 - 149s - loss: 3.2587 - accuracy100: 0.3806 - val_loss: 3.4390 - val_accuracy100: 0.3171 - 149s/epoch - 38ms/step
Epoch 3/50
3903/3903 - 149s - loss: 3.2458 - accuracy100: 0.3881 - val_loss: 3.3908 - val_accuracy100: 0.3177 - 149s/epoch - 38ms/step
Epoch 4/50
3903/3903 - 149s - loss: 3.2367 - accuracy100: 0.3930 - val_loss: 3.3942 - val_accuracy100: 0.3171 - 149s/epoch - 38ms/step
Epoch 5/50
3903/3903 - 149s - loss: 3.2334 - accuracy100: 0.3953 - val_loss: 3.3982 - val_accuracy100: 0.3170 - 149s/epoch - 38ms/step
Epoch 6/50
3903/3903 - 149s - loss: 3.2313 - accuracy100: 0.3971 - val_loss: 3.3886 - val_accuracy100: 0.3171 - 149s/epoch - 38ms/step
Epoch 7/50
3903/3903 - 148s - loss: 3.2294 - accuracy100: 0.3994 - val_loss: 3.3844 - val_accuracy100: 0.3171 - 148s/epoch - 38ms/step
Epoch 8/50
3903/3903 - 149s - loss: 3.2278 - accuracy100: 0.4011 - val_loss: 3.3848 - val_accuracy100: 0.3172 - 149s/epoch - 38ms/step
Epoch 9/50
3903/3903 - 150s - loss: 3.2240 - accuracy100: 0.4028 - val_loss: 3.3674 - val_accuracy100: 0.3181 - 150s/epoch - 38ms/step
Epoch 10/50
3903/3903 - 149s - loss: 3.2201 - accuracy100: 0.4056 - val_loss: 3.3636 - val_accuracy100: 0.3200 - 149s/epoch - 38ms/step
Epoch 11/50
3903/3903 - 152s - loss: 3.2173 - accuracy100: 0.4073 - val_loss: 3.3941 - val_accuracy100: 0.3184 - 152s/epoch - 39ms/step
Epoch 12/50
3903/3903 - 151s - loss: 3.2144 - accuracy100: 0.4091 - val_loss: 3.3734 - val_accuracy100: 0.3219 - 151s/epoch - 39ms/step
Epoch 13/50
3903/3903 - 149s - loss: 3.2120 - accuracy100: 0.4102 - val_loss: 3.3728 - val_accuracy100: 0.3240 - 149s/epoch - 38ms/step
Epoch 14/50
3903/3903 - 151s - loss: 3.2096 - accuracy100: 0.4120 - val_loss: 3.3878 - val_accuracy100: 0.3306 - 151s/epoch - 39ms/step
Epoch 15/50
3903/3903 - 155s - loss: 3.2078 - accuracy100: 0.4125 - val_loss: 3.3868 - val_accuracy100: 0.3283 - 155s/epoch - 40ms/step
Epoch 16/50
3903/3903 - 153s - loss: 3.2052 - accuracy100: 0.4145 - val_loss: 3.3793 - val_accuracy100: 0.3320 - 153s/epoch - 39ms/step
Epoch 17/50
3903/3903 - 150s - loss: 3.2032 - accuracy100: 0.4152 - val_loss: 3.3948 - val_accuracy100: 0.3316 - 150s/epoch - 38ms/step
Epoch 18/50
3903/3903 - 149s - loss: 3.2018 - accuracy100: 0.4160 - val_loss: 3.3988 - val_accuracy100: 0.3309 - 149s/epoch - 38ms/step
Epoch 19/50
3903/3903 - 149s - loss: 3.2003 - accuracy100: 0.4171 - val_loss: 3.4090 - val_accuracy100: 0.3331 - 149s/epoch - 38ms/step
Epoch 20/50
3903/3903 - 148s - loss: 3.1986 - accuracy100: 0.4184 - val_loss: 3.4027 - val_accuracy100: 0.3321 - 148s/epoch - 38ms/step
testing model: results/AAPL/W8/deepVOL_L3/h100
Evaluating performance on  test set...
10609/10609 - 194s - 194s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1419533
{'0': {'precision': 0.400206310247928, 'recall': 0.01137952030229411, 'f1-score': 0.022129798912097435, 'support': 988706}, '1': {'precision': 0.2662475678656032, 'recall': 0.9741937542752565, 'f1-score': 0.4182007049845673, 'support': 720717}, '2': {'precision': 0.4112951150905273, 'recall': 0.020633852715851487, 'f1-score': 0.03929628925157631, 'support': 1006259}, 'accuracy': 0.2703306204481968, 'macro avg': {'precision': 0.3592496644013528, 'recall': 0.3354023757644673, 'f1-score': 0.15987559771608034, 'support': 2715682}, 'weighted avg': {'precision': 0.3687636990506476, 'recall': 0.2703306204481968, 'f1-score': 0.13360418015936643, 'support': 2715682}}
[[ 11251 959994  17461]
 [  6341 702118  12258]
 [ 10521 974975  20763]]
Evaluating performance on  train set...
3903/3903 - 83s - 83s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1169096
{'0': {'precision': 0.38841770474423537, 'recall': 0.008778997498989112, 'f1-score': 0.017169921297204835, 'support': 333865}, '1': {'precision': 0.3308932594793849, 'recall': 0.9808945803240882, 'f1-score': 0.49485350456934696, 'support': 329540}, '2': {'precision': 0.3921689216892169, 'recall': 0.01709776022022416, 'f1-score': 0.03276694871707034, 'support': 335658}, 'accuracy': 0.3322252951015101, 'macro avg': {'precision': 0.37049329530427905, 'recall': 0.33559044601443383, 'f1-score': 0.18159679152787403, 'support': 999063}, 'weighted avg': {'precision': 0.37070362693807074, 'recall': 0.3322252951015101, 'f1-score': 0.1799735833897845, 'support': 999063}}
[[  2931 326282   4652]
 [  2053 323244   4243]
 [  2562 327357   5739]]
Evaluating performance on  val set...
1144/1144 - 24s - 24s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1231416
{'0': {'precision': 0.3886675520141656, 'recall': 0.008695910545029564, 'f1-score': 0.017011218103966056, 'support': 100967}, '1': {'precision': 0.31826191345370813, 'recall': 0.977257784627987, 'f1-score': 0.48015315079157034, 'support': 92779}, '2': {'precision': 0.3851622311337951, 'recall': 0.021367823879781974, 'f1-score': 0.0404893985992546, 'support': 98887}, 'accuracy': 0.3200595968328931, 'macro avg': {'precision': 0.36403056553388957, 'recall': 0.33577383968426616, 'f1-score': 0.17921792249826365, 'support': 292633}, 'weighted avg': {'precision': 0.36516099121651846, 'recall': 0.3200595968328931, 'f1-score': 0.17178368808329456, 'support': 292633}}
[[  878 98253  1836]
 [  573 90669  1537]
 [  808 95966  2113]]
training model: results/AAPL/W8/deepVOL_L3/h200
Epoch 1/50
3903/3903 - 155s - loss: 3.2486 - accuracy200: 0.3857 - val_loss: 3.3819 - val_accuracy200: 0.3158 - 155s/epoch - 40ms/step
Epoch 2/50
3903/3903 - 149s - loss: 3.2550 - accuracy200: 0.3780 - val_loss: 3.3366 - val_accuracy200: 0.3158 - 149s/epoch - 38ms/step
Epoch 3/50
3903/3903 - 149s - loss: 3.2551 - accuracy200: 0.3775 - val_loss: 3.3599 - val_accuracy200: 0.3158 - 149s/epoch - 38ms/step
Epoch 4/50
3903/3903 - 149s - loss: 3.2460 - accuracy200: 0.3848 - val_loss: 3.4223 - val_accuracy200: 0.3164 - 149s/epoch - 38ms/step
Epoch 5/50
3903/3903 - 149s - loss: 3.2253 - accuracy200: 0.3954 - val_loss: 3.4174 - val_accuracy200: 0.3160 - 149s/epoch - 38ms/step
Epoch 6/50
3903/3903 - 150s - loss: 3.2180 - accuracy200: 0.3990 - val_loss: 3.4755 - val_accuracy200: 0.3158 - 150s/epoch - 39ms/step
Epoch 7/50
3903/3903 - 149s - loss: 3.2154 - accuracy200: 0.4013 - val_loss: 3.5012 - val_accuracy200: 0.3158 - 149s/epoch - 38ms/step
Epoch 8/50
3903/3903 - 151s - loss: 3.2132 - accuracy200: 0.4020 - val_loss: 3.4867 - val_accuracy200: 0.3158 - 151s/epoch - 39ms/step
Epoch 9/50
3903/3903 - 150s - loss: 3.2099 - accuracy200: 0.4036 - val_loss: 3.4890 - val_accuracy200: 0.3158 - 150s/epoch - 38ms/step
Epoch 10/50
3903/3903 - 151s - loss: 3.2074 - accuracy200: 0.4065 - val_loss: 3.5128 - val_accuracy200: 0.3158 - 151s/epoch - 39ms/step
Epoch 11/50
3903/3903 - 150s - loss: 3.2049 - accuracy200: 0.4084 - val_loss: 3.5004 - val_accuracy200: 0.3158 - 150s/epoch - 38ms/step
Epoch 12/50
3903/3903 - 149s - loss: 3.2032 - accuracy200: 0.4102 - val_loss: 3.5164 - val_accuracy200: 0.3158 - 149s/epoch - 38ms/step
testing model: results/AAPL/W8/deepVOL_L3/h200
Evaluating performance on  test set...
10609/10609 - 192s - 192s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1327385
{'0': {'precision': 0.2222222222222222, 'recall': 1.9772126245026073e-06, 'f1-score': 3.9543900649904e-06, 'support': 1011525}, '1': {'precision': 0.256348157176682, 'recall': 0.9999956906458285, 'f1-score': 0.4080842245950121, 'support': 696160}, '2': {'precision': 0.6666666666666666, 'recall': 1.9841328892843925e-06, 'f1-score': 3.968253968253968e-06, 'support': 1007997}, 'accuracy': 0.2563484973572016, 'macro avg': {'precision': 0.38174568202185694, 'recall': 0.33333321733044746, 'f1-score': 0.13603071574634845, 'support': 2715682}, 'weighted avg': {'precision': 0.39593761951268674, 'recall': 0.2563484973572016, 'f1-score': 0.10461457333611571, 'support': 2715682}}
[[      2 1011523       0]
 [      2  696157       1]
 [      5 1007990       2]]
Evaluating performance on  train set...
3903/3903 - 72s - 72s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1114402
{'0': {'precision': 1.0, 'recall': 5.978411954432544e-06, 'f1-score': 1.1956752426473446e-05, 'support': 334537}, '1': {'precision': 0.3262073086628344, 'recall': 1.0, 'f1-score': 0.4919401462079667, 'support': 325901}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 338625}, 'accuracy': 0.32620865751208883, 'macro avg': {'precision': 0.44206910288761153, 'recall': 0.33333532613731814, 'f1-score': 0.16398403432013106, 'support': 999063}, 'weighted avg': {'precision': 0.4412617503606143, 'recall': 0.32620865751208883, 'f1-score': 0.16047815359532788, 'support': 999063}}
[[     2 334535      0]
 [     0 325901      0]
 [     0 338625      0]]
Evaluating performance on  val set...
1144/1144 - 25s - 25s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1146064
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 100869}, '1': {'precision': 0.3158187900886093, 'recall': 1.0, 'f1-score': 0.48003386555582106, 'support': 92419}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 99345}, 'accuracy': 0.3158187900886093, 'macro avg': {'precision': 0.10527293002953643, 'recall': 0.3333333333333333, 'f1-score': 0.16001128851860702, 'support': 292633}, 'weighted avg': {'precision': 0.09974150817303305, 'recall': 0.3158187900886093, 'f1-score': 0.15160371462139752, 'support': 292633}}
[[     0 100869      0]
 [     0  92419      0]
 [     0  99345      0]]
training model: results/AAPL/W8/deepVOL_L3/h300
Epoch 1/50
3903/3903 - 154s - loss: 3.2590 - accuracy300: 0.3855 - val_loss: 3.3454 - val_accuracy300: 0.3132 - 154s/epoch - 39ms/step
Epoch 2/50
3903/3903 - 152s - loss: 3.2604 - accuracy300: 0.3772 - val_loss: 3.3565 - val_accuracy300: 0.3132 - 152s/epoch - 39ms/step
Epoch 3/50
3903/3903 - 149s - loss: 3.2650 - accuracy300: 0.3732 - val_loss: 3.3082 - val_accuracy300: 0.3133 - 149s/epoch - 38ms/step
Epoch 4/50
3903/3903 - 148s - loss: 3.2634 - accuracy300: 0.3719 - val_loss: 3.3269 - val_accuracy300: 0.3133 - 148s/epoch - 38ms/step
Epoch 5/50
3903/3903 - 149s - loss: 3.2471 - accuracy300: 0.3857 - val_loss: 3.4087 - val_accuracy300: 0.3137 - 149s/epoch - 38ms/step
Epoch 6/50
3903/3903 - 149s - loss: 3.2334 - accuracy300: 0.3934 - val_loss: 3.4354 - val_accuracy300: 0.3135 - 149s/epoch - 38ms/step
Epoch 7/50
3903/3903 - 149s - loss: 3.2272 - accuracy300: 0.3973 - val_loss: 3.4477 - val_accuracy300: 0.3134 - 149s/epoch - 38ms/step
Epoch 8/50
3903/3903 - 149s - loss: 3.2241 - accuracy300: 0.3998 - val_loss: 3.4499 - val_accuracy300: 0.3149 - 149s/epoch - 38ms/step
Epoch 9/50
3903/3903 - 149s - loss: 3.2222 - accuracy300: 0.4011 - val_loss: 3.4564 - val_accuracy300: 0.3166 - 149s/epoch - 38ms/step
Epoch 10/50
3903/3903 - 149s - loss: 3.2198 - accuracy300: 0.4026 - val_loss: 3.4576 - val_accuracy300: 0.3170 - 149s/epoch - 38ms/step
Epoch 11/50
3903/3903 - 150s - loss: 3.2171 - accuracy300: 0.4049 - val_loss: 3.4693 - val_accuracy300: 0.3175 - 150s/epoch - 38ms/step
Epoch 12/50
3903/3903 - 149s - loss: 3.2144 - accuracy300: 0.4067 - val_loss: 3.4762 - val_accuracy300: 0.3177 - 149s/epoch - 38ms/step
Epoch 13/50
3903/3903 - 152s - loss: 3.2120 - accuracy300: 0.4088 - val_loss: 3.4702 - val_accuracy300: 0.3213 - 152s/epoch - 39ms/step
testing model: results/AAPL/W8/deepVOL_L3/h300
Evaluating performance on  test set...
10609/10609 - 195s - 195s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1123487
{'0': {'precision': 0.3526608419380461, 'recall': 0.0004307367538746905, 'f1-score': 0.000860422595394995, 'support': 1030792}, '1': {'precision': 0.24564361089948292, 'recall': 0.9994753614759431, 'f1-score': 0.3943634981798181, 'support': 667126}, '2': {'precision': 0.3157894736842105, 'recall': 5.8952763116007245e-06, 'f1-score': 1.1790332516852807e-05, 'support': 1017764}, 'accuracy': 0.24569371524353736, 'macro avg': {'precision': 0.3046979755072465, 'recall': 0.33330399783537645, 'f1-score': 0.13174523703590998, 'support': 2715682}, 'weighted avg': {'precision': 0.31255293220733044, 'recall': 0.24569371524353736, 'f1-score': 0.09720912079935921, 'support': 2715682}}
[[    444 1030339       9]
 [    346  666776       4]
 [    469 1017289       6]]
Evaluating performance on  train set...
3903/3903 - 73s - 73s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.101174
{'0': {'precision': 0.3565459610027855, 'recall': 0.00038536225557345215, 'f1-score': 0.000769892395508159, 'support': 332155}, '1': {'precision': 0.33020625875515797, 'recall': 0.9996332188531571, 'f1-score': 0.4964285552998131, 'support': 329897}, '2': {'precision': 0.2857142857142857, 'recall': 5.934524392378884e-06, 'f1-score': 1.186880225981995e-05, 'support': 337011}, 'accuracy': 0.3302154118408949, 'macro avg': {'precision': 0.3241555018240764, 'recall': 0.33334150521104094, 'f1-score': 0.16573677216586039, 'support': 999063}, 'weighted avg': {'precision': 0.3239549807812797, 'recall': 0.3302154118408949, 'f1-score': 0.16418385490533713, 'support': 999063}}
[[   128 332024      3]
 [   119 329776      2]
 [   112 336897      2]]
Evaluating performance on  val set...
1144/1144 - 21s - 21s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033456
{'0': {'precision': 0.2972972972972973, 'recall': 0.0002175848086242706, 'f1-score': 0.00043485135989879825, 'support': 101110}, '1': {'precision': 0.313229126432617, 'recall': 0.9997708899289759, 'f1-score': 0.47701044719404095, 'support': 91659}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 99864}, 'accuracy': 0.3132250976479071, 'macro avg': {'precision': 0.20350880790997147, 'recall': 0.33332949157920005, 'f1-score': 0.15914843285131325, 'support': 292633}, 'weighted avg': {'precision': 0.20083175250028867, 'recall': 0.3132250976479071, 'f1-score': 0.14956026285606192, 'support': 292633}}
[[    22 101088      0]
 [    21  91638      0]
 [    31  99833      0]]
training model: results/AAPL/W8/deepVOL_L3/h500
Epoch 1/50
3903/3903 - 159s - loss: 3.2548 - accuracy500: 0.3887 - val_loss: 3.4723 - val_accuracy500: 0.3173 - 159s/epoch - 41ms/step
Epoch 2/50
3903/3903 - 151s - loss: 3.2541 - accuracy500: 0.3868 - val_loss: 3.4626 - val_accuracy500: 0.3174 - 151s/epoch - 39ms/step
Epoch 3/50
3903/3903 - 157s - loss: 3.2544 - accuracy500: 0.3869 - val_loss: 3.4439 - val_accuracy500: 0.3174 - 157s/epoch - 40ms/step
Epoch 4/50
3903/3903 - 151s - loss: 3.2573 - accuracy500: 0.3846 - val_loss: 3.3125 - val_accuracy500: 0.3174 - 151s/epoch - 39ms/step
Epoch 5/50
3903/3903 - 150s - loss: 3.2727 - accuracy500: 0.3690 - val_loss: 3.3200 - val_accuracy500: 0.3174 - 150s/epoch - 38ms/step
Epoch 6/50
3903/3903 - 150s - loss: 3.2747 - accuracy500: 0.3674 - val_loss: 3.3084 - val_accuracy500: 0.3174 - 150s/epoch - 38ms/step
Epoch 7/50
3903/3903 - 149s - loss: 3.2695 - accuracy500: 0.3715 - val_loss: 3.3210 - val_accuracy500: 0.3174 - 149s/epoch - 38ms/step
Epoch 8/50
3903/3903 - 149s - loss: 3.2642 - accuracy500: 0.3719 - val_loss: 3.3052 - val_accuracy500: 0.3174 - 149s/epoch - 38ms/step
Epoch 9/50
3903/3903 - 149s - loss: 3.2705 - accuracy500: 0.3675 - val_loss: 3.3051 - val_accuracy500: 0.3174 - 149s/epoch - 38ms/step
Epoch 10/50
3903/3903 - 150s - loss: 3.2634 - accuracy500: 0.3755 - val_loss: 3.3284 - val_accuracy500: 0.3174 - 150s/epoch - 38ms/step
Epoch 11/50
3903/3903 - 148s - loss: 3.2635 - accuracy500: 0.3766 - val_loss: 3.3232 - val_accuracy500: 0.3174 - 148s/epoch - 38ms/step
Epoch 12/50
3903/3903 - 149s - loss: 3.2626 - accuracy500: 0.3759 - val_loss: 3.3068 - val_accuracy500: 0.3382 - 149s/epoch - 38ms/step
Epoch 13/50
3903/3903 - 150s - loss: 3.2539 - accuracy500: 0.3823 - val_loss: 3.4063 - val_accuracy500: 0.3174 - 150s/epoch - 38ms/step
Epoch 14/50
3903/3903 - 149s - loss: 3.2508 - accuracy500: 0.3856 - val_loss: 3.3081 - val_accuracy500: 0.3384 - 149s/epoch - 38ms/step
Epoch 15/50
3903/3903 - 148s - loss: 3.2403 - accuracy500: 0.3908 - val_loss: 3.3335 - val_accuracy500: 0.3215 - 148s/epoch - 38ms/step
Epoch 16/50
3903/3903 - 149s - loss: 3.2309 - accuracy500: 0.3957 - val_loss: 3.3890 - val_accuracy500: 0.3176 - 149s/epoch - 38ms/step
Epoch 17/50
3903/3903 - 149s - loss: 3.2276 - accuracy500: 0.3970 - val_loss: 3.4690 - val_accuracy500: 0.3178 - 149s/epoch - 38ms/step
Epoch 18/50
3903/3903 - 149s - loss: 3.2279 - accuracy500: 0.3967 - val_loss: 3.3987 - val_accuracy500: 0.3174 - 149s/epoch - 38ms/step
Epoch 19/50
3903/3903 - 149s - loss: 3.2222 - accuracy500: 0.3995 - val_loss: 3.4340 - val_accuracy500: 0.3174 - 149s/epoch - 38ms/step
testing model: results/AAPL/W8/deepVOL_L3/h500
Evaluating performance on  test set...
10609/10609 - 196s - 196s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.110908
{'0': {'precision': 0.38636363636363635, 'recall': 0.00011628350113009974, 'f1-score': 0.0002324970278478688, 'support': 1023361}, '1': {'precision': 0.2491528894572305, 'recall': 0.9997886556876006, 'f1-score': 0.3988981443999277, 'support': 676621}, '2': {'precision': 0.4083969465648855, 'recall': 0.0001053460667519937, 'f1-score': 0.00021063779944525482, 'support': 1015700}, 'accuracy': 0.24918381459979483, 'macro avg': {'precision': 0.3479711574619175, 'recall': 0.3333367617518275, 'f1-score': 0.13311375974240694, 'support': 2715682}, 'weighted avg': {'precision': 0.360417874079558, 'recall': 0.24918381459979483, 'f1-score': 0.09955316364943889, 'support': 2715682}}
[[    119 1023148      94]
 [     82  676478      61]
 [    107 1015486     107]]
Evaluating performance on  train set...
3903/3903 - 72s - 72s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.10084
{'0': {'precision': 0.3113207547169811, 'recall': 9.987742316248241e-05, 'f1-score': 0.0001996907818499233, 'support': 330405}, '1': {'precision': 0.329636785935967, 'recall': 0.9998086990319563, 'f1-score': 0.49580630394583886, 'support': 329324}, '2': {'precision': 0.3917525773195876, 'recall': 0.00011198406289967996, 'f1-score': 0.00022390412189811774, 'support': 339334}, 'accuracy': 0.32964087349846805, 'macro avg': {'precision': 0.34423670599084527, 'recall': 0.3333401868393395, 'f1-score': 0.16540996628319563, 'support': 999063}, 'weighted avg': {'precision': 0.3446771704347028, 'recall': 0.32964087349846805, 'f1-score': 0.16357614320091599, 'support': 999063}}
[[    33 330340     32]
 [    36 329261     27]
 [    37 339259     38]]
Evaluating performance on  val set...
1144/1144 - 21s - 21s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1022791
{'0': {'precision': 0.3333333333333333, 'recall': 8.993794281945458e-05, 'f1-score': 0.00017982736572890026, 'support': 100069}, '1': {'precision': 0.3173778560076559, 'recall': 0.9998277272923037, 'f1-score': 0.48181268662718146, 'support': 92876}, '2': {'precision': 0.2857142857142857, 'recall': 6.0187785891982986e-05, 'f1-score': 0.00012035021913769066, 'support': 99688}, 'accuracy': 0.3173770559027861, 'macro avg': {'precision': 0.31214182501842497, 'recall': 0.3333259510070051, 'f1-score': 0.16070428807068268, 'support': 292633}, 'weighted avg': {'precision': 0.3120475298486025, 'recall': 0.3173770559027861, 'f1-score': 0.15302043071182203, 'support': 292633}}
[[     9 100053      7]
 [     8  92860      8]
 [    10  99672      6]]
training model: results/AAPL/W8/deepVOL_L3/h1000
Epoch 1/50
3903/3903 - 156s - loss: 3.2643 - accuracy1000: 0.3809 - val_loss: 3.3087 - val_accuracy1000: 0.3185 - 156s/epoch - 40ms/step
Epoch 2/50
3903/3903 - 156s - loss: 3.2619 - accuracy1000: 0.3764 - val_loss: 3.3153 - val_accuracy1000: 0.3185 - 156s/epoch - 40ms/step
Epoch 3/50
3903/3903 - 157s - loss: 3.2813 - accuracy1000: 0.3628 - val_loss: 3.3072 - val_accuracy1000: 0.3185 - 157s/epoch - 40ms/step
Epoch 4/50
3903/3903 - 150s - loss: 3.2634 - accuracy1000: 0.3767 - val_loss: 3.3458 - val_accuracy1000: 0.3185 - 150s/epoch - 38ms/step
Epoch 5/50
3903/3903 - 152s - loss: 3.2646 - accuracy1000: 0.3794 - val_loss: 3.4147 - val_accuracy1000: 0.3185 - 152s/epoch - 39ms/step
Epoch 6/50
3903/3903 - 151s - loss: 3.2672 - accuracy1000: 0.3761 - val_loss: 3.3407 - val_accuracy1000: 0.3185 - 151s/epoch - 39ms/step
Epoch 7/50
3903/3903 - 151s - loss: 3.2603 - accuracy1000: 0.3786 - val_loss: 3.3397 - val_accuracy1000: 0.3185 - 151s/epoch - 39ms/step
Epoch 8/50
3903/3903 - 151s - loss: 3.2497 - accuracy1000: 0.3861 - val_loss: 3.3695 - val_accuracy1000: 0.3179 - 151s/epoch - 39ms/step
Epoch 9/50
3903/3903 - 152s - loss: 3.2331 - accuracy1000: 0.3980 - val_loss: 3.4102 - val_accuracy1000: 0.3184 - 152s/epoch - 39ms/step
Epoch 10/50
3903/3903 - 150s - loss: 3.2210 - accuracy1000: 0.4027 - val_loss: 3.4162 - val_accuracy1000: 0.3185 - 150s/epoch - 39ms/step
Epoch 11/50
3903/3903 - 149s - loss: 3.2165 - accuracy1000: 0.4035 - val_loss: 3.4479 - val_accuracy1000: 0.3185 - 149s/epoch - 38ms/step
Epoch 12/50
3903/3903 - 153s - loss: 3.2140 - accuracy1000: 0.4039 - val_loss: 3.4911 - val_accuracy1000: 0.3185 - 153s/epoch - 39ms/step
Epoch 13/50
3903/3903 - 150s - loss: 3.2114 - accuracy1000: 0.4047 - val_loss: 3.5291 - val_accuracy1000: 0.3185 - 150s/epoch - 38ms/step
testing model: results/AAPL/W8/deepVOL_L3/h1000
Evaluating performance on  test set...
10609/10609 - 195s - 195s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1099812
{'0': {'precision': 0.3596330275229358, 'recall': 0.00019519404379317798, 'f1-score': 0.0003901763158994858, 'support': 1004129}, '1': {'precision': 0.26301345644931684, 'recall': 0.999784389219461, 'f1-score': 0.4164668934375915, 'support': 714250}, '2': {'precision': 0.3048780487804878, 'recall': 2.5067607336987856e-05, 'f1-score': 5.013109280769212e-05, 'support': 997303}, 'accuracy': 0.26303411076849204, 'macro avg': {'precision': 0.30917484425091346, 'recall': 0.33333488362353036, 'f1-score': 0.13896906694876623, 'support': 2715682}, 'weighted avg': {'precision': 0.3141130317339915, 'recall': 0.26303411076849204, 'f1-score': 0.10969740267121038, 'support': 2715682}}
[[    196 1003899      34]
 [    131  714096      23]
 [    218  997060      25]]
Evaluating performance on  train set...
3903/3903 - 72s - 72s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1014212
{'0': {'precision': 0.29797979797979796, 'recall': 0.0001816485685169164, 'f1-score': 0.0003630758059205971, 'support': 324803}, '1': {'precision': 0.3312021753429759, 'recall': 0.9997793815429994, 'f1-score': 0.49757129137810313, 'support': 330888}, '2': {'precision': 0.5294117647058824, 'recall': 5.2421280710133616e-05, 'f1-score': 0.00010483218115000902, 'support': 343372}, 'accuracy': 0.33120233658938425, 'macro avg': {'precision': 0.3861979126762187, 'recall': 0.3333378171307421, 'f1-score': 0.1660130664550579, 'support': 999063}, 'weighted avg': {'precision': 0.38852478190935624, 'recall': 0.33120233658938425, 'f1-score': 0.1649488510816776, 'support': 999063}}
[[    59 324736      8]
 [    65 330815      8]
 [    74 343280     18]]
Evaluating performance on  val set...
1144/1144 - 25s - 25s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1027703
{'0': {'precision': 0.3698630136986301, 'recall': 0.00027253457151509036, 'f1-score': 0.0005446678030723299, 'support': 99070}, '1': {'precision': 0.3185155561024631, 'recall': 0.9997532347702938, 'f1-score': 0.48311385317295724, 'support': 93206}, '2': {'precision': 0.3333333333333333, 'recall': 1.9928853991251233e-05, 'f1-score': 3.9855325169634224e-05, 'support': 100357}, 'accuracy': 0.31852866901545623, 'macro avg': {'precision': 0.3405706343781422, 'recall': 0.3333485660652667, 'f1-score': 0.16123279210039973, 'support': 292633}, 'weighted avg': {'precision': 0.3409807609618286, 'recall': 0.31852866901545623, 'f1-score': 0.15407377089718888, 'support': 292633}}
[[    27  99042      1]
 [    20  93183      3]
 [    26 100329      2]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :       106 (peak)  24.36 (ave)

============================================
