This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/LILAK_orderbooks/LILAK_orderbooks_2019-11-13.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-11-05.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-10-23.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-10-24.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-11-01.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-10-28.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-10-30.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-10-25.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-11-15.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-10-29.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-11-11.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-10-31.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-10-22.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-11-07.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-11-06.csv
training model: results/LILAK/W8/deepLOB_L1/h10
Epoch 1/50
224/224 - 30s - loss: 3.3219 - accuracy10: 0.3698 - val_loss: 3.4702 - val_accuracy10: 0.3311 - 30s/epoch - 135ms/step
Epoch 2/50
224/224 - 6s - loss: 3.2671 - accuracy10: 0.3964 - val_loss: 3.3753 - val_accuracy10: 0.3465 - 6s/epoch - 25ms/step
Epoch 3/50
224/224 - 6s - loss: 3.2364 - accuracy10: 0.4089 - val_loss: 3.3490 - val_accuracy10: 0.3414 - 6s/epoch - 25ms/step
Epoch 4/50
224/224 - 6s - loss: 3.2087 - accuracy10: 0.4208 - val_loss: 3.3371 - val_accuracy10: 0.3540 - 6s/epoch - 25ms/step
Epoch 5/50
224/224 - 6s - loss: 3.1992 - accuracy10: 0.4223 - val_loss: 3.3240 - val_accuracy10: 0.3478 - 6s/epoch - 25ms/step
Epoch 6/50
224/224 - 6s - loss: 3.1682 - accuracy10: 0.4356 - val_loss: 3.2619 - val_accuracy10: 0.3813 - 6s/epoch - 25ms/step
Epoch 7/50
224/224 - 6s - loss: 3.1326 - accuracy10: 0.4514 - val_loss: 3.2378 - val_accuracy10: 0.4010 - 6s/epoch - 26ms/step
Epoch 8/50
224/224 - 6s - loss: 3.1108 - accuracy10: 0.4606 - val_loss: 3.2222 - val_accuracy10: 0.4114 - 6s/epoch - 25ms/step
Epoch 9/50
224/224 - 5s - loss: 3.0914 - accuracy10: 0.4674 - val_loss: 3.2258 - val_accuracy10: 0.4039 - 5s/epoch - 24ms/step
Epoch 10/50
224/224 - 6s - loss: 3.0735 - accuracy10: 0.4753 - val_loss: 3.2031 - val_accuracy10: 0.4308 - 6s/epoch - 25ms/step
Epoch 11/50
224/224 - 6s - loss: 3.0679 - accuracy10: 0.4781 - val_loss: 3.2055 - val_accuracy10: 0.4234 - 6s/epoch - 25ms/step
Epoch 12/50
224/224 - 5s - loss: 3.0510 - accuracy10: 0.4817 - val_loss: 3.2080 - val_accuracy10: 0.4334 - 5s/epoch - 24ms/step
Epoch 13/50
224/224 - 5s - loss: 3.0363 - accuracy10: 0.4861 - val_loss: 3.2022 - val_accuracy10: 0.4314 - 5s/epoch - 24ms/step
Epoch 14/50
224/224 - 5s - loss: 3.0226 - accuracy10: 0.4888 - val_loss: 3.1909 - val_accuracy10: 0.4376 - 5s/epoch - 24ms/step
Epoch 15/50
224/224 - 5s - loss: 3.0193 - accuracy10: 0.4901 - val_loss: 3.1776 - val_accuracy10: 0.4256 - 5s/epoch - 24ms/step
Epoch 16/50
224/224 - 5s - loss: 3.0112 - accuracy10: 0.4905 - val_loss: 3.1953 - val_accuracy10: 0.4342 - 5s/epoch - 24ms/step
Epoch 17/50
224/224 - 5s - loss: 3.0058 - accuracy10: 0.4947 - val_loss: 3.2077 - val_accuracy10: 0.4320 - 5s/epoch - 24ms/step
Epoch 18/50
224/224 - 5s - loss: 2.9954 - accuracy10: 0.4959 - val_loss: 3.2022 - val_accuracy10: 0.4323 - 5s/epoch - 24ms/step
Epoch 19/50
224/224 - 5s - loss: 2.9903 - accuracy10: 0.4990 - val_loss: 3.2040 - val_accuracy10: 0.4385 - 5s/epoch - 24ms/step
Epoch 20/50
224/224 - 5s - loss: 2.9804 - accuracy10: 0.5014 - val_loss: 3.1978 - val_accuracy10: 0.4322 - 5s/epoch - 24ms/step
Epoch 21/50
224/224 - 5s - loss: 2.9792 - accuracy10: 0.5019 - val_loss: 3.1975 - val_accuracy10: 0.4373 - 5s/epoch - 24ms/step
Epoch 22/50
224/224 - 5s - loss: 2.9713 - accuracy10: 0.5042 - val_loss: 3.1893 - val_accuracy10: 0.4412 - 5s/epoch - 24ms/step
Epoch 23/50
224/224 - 5s - loss: 2.9600 - accuracy10: 0.5066 - val_loss: 3.1911 - val_accuracy10: 0.4304 - 5s/epoch - 24ms/step
Epoch 24/50
224/224 - 5s - loss: 2.9534 - accuracy10: 0.5088 - val_loss: 3.1823 - val_accuracy10: 0.4363 - 5s/epoch - 24ms/step
Epoch 25/50
224/224 - 5s - loss: 2.9428 - accuracy10: 0.5125 - val_loss: 3.1827 - val_accuracy10: 0.4284 - 5s/epoch - 24ms/step
testing model: results/LILAK/W8/deepLOB_L1/h10
Evaluating performance on  test set...
645/645 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0539347
{'0': {'precision': 0.40595532539805224, 'recall': 0.43808908165818666, 'f1-score': 0.42141051871464674, 'support': 47956}, '1': {'precision': 0.5765008048908423, 'recall': 0.45443268984002966, 'f1-score': 0.5082399840542157, 'support': 70138}, '2': {'precision': 0.38015029800466443, 'recall': 0.46989109545163354, 'f1-score': 0.4202836269875375, 'support': 46830}, 'accuracy': 0.4540697533409328, 'macro avg': {'precision': 0.4542021427645197, 'recall': 0.45413762231661664, 'f1-score': 0.44997804325213336, 'support': 164924}, 'weighted avg': {'precision': 0.4711566872849393, 'recall': 0.4540697533409328, 'f1-score': 0.45801691135856853, 'support': 164924}}
[[21009 11325 15622]
 [18007 31873 20258]
 [12736 12089 22005]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0674864
{'0': {'precision': 0.3948987854251012, 'recall': 0.570209283292412, 'f1-score': 0.4666315839831603, 'support': 17106}, '1': {'precision': 0.6038228535617297, 'recall': 0.2537306882022472, 'f1-score': 0.3573150380122381, 'support': 22784}, '2': {'precision': 0.3996503496503496, 'recall': 0.5296570898980537, 'f1-score': 0.4555599840573934, 'support': 17264}, 'accuracy': 0.43179829933163033, 'macro avg': {'precision': 0.46612399621239353, 'recall': 0.4511990204642376, 'f1-score': 0.42650220201759725, 'support': 57154}, 'weighted avg': {'precision': 0.4796200118171233, 'recall': 0.43179829933163033, 'f1-score': 0.41970908889060454, 'support': 57154}}
[[9754 1734 5618]
 [8885 5781 8118]
 [6061 2059 9144]]
Evaluating performance on  val set...
68/68 - 1s - 946ms/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0687448
{'0': {'precision': 0.40714391581443604, 'recall': 0.5190854119425548, 'f1-score': 0.45635019519893677, 'support': 5292}, '1': {'precision': 0.5249226538329322, 'recall': 0.2329164124466138, 'f1-score': 0.322662440570523, 'support': 6556}, '2': {'precision': 0.406410763751484, 'recall': 0.5717201707181295, 'f1-score': 0.4750963762528913, 'support': 5389}, 'accuracy': 0.4266983813888728, 'macro avg': {'precision': 0.44615911113295076, 'recall': 0.44124066503576603, 'f1-score': 0.41803633734078366, 'support': 17237}, 'weighted avg': {'precision': 0.45171121000611747, 'recall': 0.4266983813888728, 'f1-score': 0.41136361112722364, 'support': 17237}}
[[2747  737 1808]
 [2337 1527 2692]
 [1663  645 3081]]
training model: results/LILAK/W8/deepLOB_L1/h20
Epoch 1/50
224/224 - 8s - loss: 3.3248 - accuracy20: 0.3673 - val_loss: 3.4347 - val_accuracy20: 0.3607 - 8s/epoch - 34ms/step
Epoch 2/50
224/224 - 6s - loss: 3.2820 - accuracy20: 0.3882 - val_loss: 3.4186 - val_accuracy20: 0.3393 - 6s/epoch - 25ms/step
Epoch 3/50
224/224 - 6s - loss: 3.2569 - accuracy20: 0.4034 - val_loss: 3.3431 - val_accuracy20: 0.3655 - 6s/epoch - 25ms/step
Epoch 4/50
224/224 - 5s - loss: 3.2317 - accuracy20: 0.4167 - val_loss: 3.3457 - val_accuracy20: 0.3645 - 5s/epoch - 24ms/step
Epoch 5/50
224/224 - 5s - loss: 3.2192 - accuracy20: 0.4217 - val_loss: 3.3068 - val_accuracy20: 0.3899 - 5s/epoch - 24ms/step
Epoch 6/50
224/224 - 5s - loss: 3.2042 - accuracy20: 0.4292 - val_loss: 3.2791 - val_accuracy20: 0.4064 - 5s/epoch - 24ms/step
Epoch 7/50
224/224 - 5s - loss: 3.1766 - accuracy20: 0.4400 - val_loss: 3.2675 - val_accuracy20: 0.3979 - 5s/epoch - 24ms/step
Epoch 8/50
224/224 - 5s - loss: 3.1548 - accuracy20: 0.4479 - val_loss: 3.2835 - val_accuracy20: 0.3961 - 5s/epoch - 24ms/step
Epoch 9/50
224/224 - 5s - loss: 3.1468 - accuracy20: 0.4511 - val_loss: 3.2658 - val_accuracy20: 0.4006 - 5s/epoch - 24ms/step
Epoch 10/50
224/224 - 5s - loss: 3.1329 - accuracy20: 0.4544 - val_loss: 3.2918 - val_accuracy20: 0.3857 - 5s/epoch - 24ms/step
Epoch 11/50
224/224 - 5s - loss: 3.1170 - accuracy20: 0.4590 - val_loss: 3.2595 - val_accuracy20: 0.4047 - 5s/epoch - 24ms/step
Epoch 12/50
224/224 - 5s - loss: 3.1060 - accuracy20: 0.4646 - val_loss: 3.2560 - val_accuracy20: 0.3953 - 5s/epoch - 24ms/step
Epoch 13/50
224/224 - 5s - loss: 3.0917 - accuracy20: 0.4664 - val_loss: 3.2464 - val_accuracy20: 0.4131 - 5s/epoch - 24ms/step
Epoch 14/50
224/224 - 5s - loss: 3.0782 - accuracy20: 0.4701 - val_loss: 3.2621 - val_accuracy20: 0.4012 - 5s/epoch - 24ms/step
Epoch 15/50
224/224 - 5s - loss: 3.0691 - accuracy20: 0.4736 - val_loss: 3.3117 - val_accuracy20: 0.4022 - 5s/epoch - 24ms/step
Epoch 16/50
224/224 - 5s - loss: 3.0705 - accuracy20: 0.4744 - val_loss: 3.2511 - val_accuracy20: 0.3998 - 5s/epoch - 24ms/step
Epoch 17/50
224/224 - 5s - loss: 3.0519 - accuracy20: 0.4776 - val_loss: 3.2474 - val_accuracy20: 0.4089 - 5s/epoch - 24ms/step
Epoch 18/50
224/224 - 5s - loss: 3.0437 - accuracy20: 0.4829 - val_loss: 3.2498 - val_accuracy20: 0.4093 - 5s/epoch - 24ms/step
Epoch 19/50
224/224 - 5s - loss: 3.0331 - accuracy20: 0.4820 - val_loss: 3.2496 - val_accuracy20: 0.4036 - 5s/epoch - 24ms/step
Epoch 20/50
224/224 - 5s - loss: 3.0223 - accuracy20: 0.4866 - val_loss: 3.2440 - val_accuracy20: 0.4113 - 5s/epoch - 24ms/step
Epoch 21/50
224/224 - 5s - loss: 3.0146 - accuracy20: 0.4893 - val_loss: 3.2538 - val_accuracy20: 0.4060 - 5s/epoch - 24ms/step
Epoch 22/50
224/224 - 5s - loss: 3.0058 - accuracy20: 0.4919 - val_loss: 3.2834 - val_accuracy20: 0.3954 - 5s/epoch - 24ms/step
Epoch 23/50
224/224 - 5s - loss: 3.0017 - accuracy20: 0.4920 - val_loss: 3.2740 - val_accuracy20: 0.4016 - 5s/epoch - 24ms/step
Epoch 24/50
224/224 - 5s - loss: 2.9990 - accuracy20: 0.4912 - val_loss: 3.2797 - val_accuracy20: 0.4035 - 5s/epoch - 24ms/step
Epoch 25/50
224/224 - 5s - loss: 2.9939 - accuracy20: 0.4927 - val_loss: 3.2792 - val_accuracy20: 0.4002 - 5s/epoch - 24ms/step
Epoch 26/50
224/224 - 5s - loss: 2.9865 - accuracy20: 0.4954 - val_loss: 3.3286 - val_accuracy20: 0.3888 - 5s/epoch - 24ms/step
Epoch 27/50
224/224 - 5s - loss: 2.9787 - accuracy20: 0.4975 - val_loss: 3.3487 - val_accuracy20: 0.3886 - 5s/epoch - 24ms/step
Epoch 28/50
224/224 - 5s - loss: 2.9798 - accuracy20: 0.4968 - val_loss: 3.3546 - val_accuracy20: 0.3777 - 5s/epoch - 24ms/step
Epoch 29/50
224/224 - 5s - loss: 2.9752 - accuracy20: 0.4990 - val_loss: 3.3080 - val_accuracy20: 0.3987 - 5s/epoch - 24ms/step
Epoch 30/50
224/224 - 5s - loss: 2.9652 - accuracy20: 0.5007 - val_loss: 3.3727 - val_accuracy20: 0.3776 - 5s/epoch - 24ms/step
testing model: results/LILAK/W8/deepLOB_L1/h20
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.057682
{'0': {'precision': 0.4714708431718325, 'recall': 0.2886103741652182, 'f1-score': 0.35804430724532416, 'support': 54655}, '1': {'precision': 0.4422708093594169, 'recall': 0.6681593088188811, 'f1-score': 0.5322394511005266, 'support': 56946}, '2': {'precision': 0.4156615899286909, 'recall': 0.3541811225925023, 'f1-score': 0.3824664081248292, 'support': 53323}, 'accuracy': 0.4408636705391574, 'macro avg': {'precision': 0.4431344141533134, 'recall': 0.43698360185886714, 'f1-score': 0.42425005549022665, 'support': 164924}, 'weighted avg': {'precision': 0.44334430042386463, 'recall': 0.4408636705391574, 'f1-score': 0.42608762627212565, 'support': 164924}}
[[15774 23566 15315]
 [ 7662 38049 11235]
 [10021 24416 18886]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0651115
{'0': {'precision': 0.4362131905573132, 'recall': 0.4741548066239881, 'f1-score': 0.45439334786797136, 'support': 18901}, '1': {'precision': 0.47231745568604566, 'recall': 0.34271952575027786, 'f1-score': 0.39721489479173056, 'support': 18893}, '2': {'precision': 0.4234061135371179, 'recall': 0.5008264462809917, 'f1-score': 0.45887363937529574, 'support': 19360}, 'accuracy': 0.4397417503586801, 'macro avg': {'precision': 0.4439789199268256, 'recall': 0.4392335928850859, 'f1-score': 0.4368272940116659, 'support': 57154}, 'weighted avg': {'precision': 0.44380973445566085, 'recall': 0.4397417503586801, 'f1-score': 0.4370098914101973, 'support': 57154}}
[[8962 3459 6480]
 [5694 6475 6724]
 [5889 3775 9696]]
Evaluating performance on  val set...
68/68 - 1s - 921ms/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0811057
{'0': {'precision': 0.45085510242435634, 'recall': 0.40103644266131727, 'f1-score': 0.4244890736972485, 'support': 5982}, '1': {'precision': 0.36612842658655653, 'recall': 0.37058152793614596, 'f1-score': 0.3683415187004156, 'support': 5262}, '2': {'precision': 0.41638846737481033, 'recall': 0.457867512097447, 'f1-score': 0.4361440038146706, 'support': 5993}, 'accuracy': 0.4114985206242386, 'macro avg': {'precision': 0.4111239987952411, 'recall': 0.40982849423163675, 'f1-score': 0.40965819873744486, 'support': 17237}, 'weighted avg': {'precision': 0.41300685086605543, 'recall': 0.4114985206242386, 'f1-score': 0.4114009238916197, 'support': 17237}}
[[2399 1663 1920]
 [1386 1950 1926]
 [1536 1713 2744]]
training model: results/LILAK/W8/deepLOB_L1/h30
Epoch 1/50
224/224 - 8s - loss: 3.3410 - accuracy30: 0.3592 - val_loss: 3.3451 - val_accuracy30: 0.3643 - 8s/epoch - 34ms/step
Epoch 2/50
224/224 - 5s - loss: 3.2954 - accuracy30: 0.3806 - val_loss: 3.3486 - val_accuracy30: 0.3544 - 5s/epoch - 25ms/step
Epoch 3/50
224/224 - 5s - loss: 3.2705 - accuracy30: 0.3917 - val_loss: 3.3378 - val_accuracy30: 0.3609 - 5s/epoch - 24ms/step
Epoch 4/50
224/224 - 5s - loss: 3.2688 - accuracy30: 0.3948 - val_loss: 3.4028 - val_accuracy30: 0.3595 - 5s/epoch - 24ms/step
Epoch 5/50
224/224 - 5s - loss: 3.2595 - accuracy30: 0.3990 - val_loss: 3.3580 - val_accuracy30: 0.3642 - 5s/epoch - 24ms/step
Epoch 6/50
224/224 - 5s - loss: 3.2307 - accuracy30: 0.4147 - val_loss: 3.3207 - val_accuracy30: 0.3680 - 5s/epoch - 24ms/step
Epoch 7/50
224/224 - 5s - loss: 3.2293 - accuracy30: 0.4141 - val_loss: 3.3458 - val_accuracy30: 0.3719 - 5s/epoch - 24ms/step
Epoch 8/50
224/224 - 5s - loss: 3.2073 - accuracy30: 0.4236 - val_loss: 3.3592 - val_accuracy30: 0.3679 - 5s/epoch - 24ms/step
Epoch 9/50
224/224 - 5s - loss: 3.1933 - accuracy30: 0.4295 - val_loss: 3.3402 - val_accuracy30: 0.3737 - 5s/epoch - 24ms/step
Epoch 10/50
224/224 - 5s - loss: 3.1871 - accuracy30: 0.4316 - val_loss: 3.3502 - val_accuracy30: 0.3710 - 5s/epoch - 24ms/step
Epoch 11/50
224/224 - 5s - loss: 3.1639 - accuracy30: 0.4405 - val_loss: 3.3193 - val_accuracy30: 0.3729 - 5s/epoch - 24ms/step
Epoch 12/50
224/224 - 5s - loss: 3.1552 - accuracy30: 0.4427 - val_loss: 3.3385 - val_accuracy30: 0.3669 - 5s/epoch - 24ms/step
Epoch 13/50
224/224 - 5s - loss: 3.1487 - accuracy30: 0.4439 - val_loss: 3.3458 - val_accuracy30: 0.3748 - 5s/epoch - 24ms/step
Epoch 14/50
224/224 - 5s - loss: 3.1385 - accuracy30: 0.4473 - val_loss: 3.3596 - val_accuracy30: 0.3719 - 5s/epoch - 24ms/step
Epoch 15/50
224/224 - 5s - loss: 3.1281 - accuracy30: 0.4482 - val_loss: 3.3423 - val_accuracy30: 0.3665 - 5s/epoch - 24ms/step
Epoch 16/50
224/224 - 5s - loss: 3.1217 - accuracy30: 0.4497 - val_loss: 3.3215 - val_accuracy30: 0.3743 - 5s/epoch - 24ms/step
Epoch 17/50
224/224 - 5s - loss: 3.1121 - accuracy30: 0.4570 - val_loss: 3.3458 - val_accuracy30: 0.3699 - 5s/epoch - 23ms/step
Epoch 18/50
224/224 - 5s - loss: 3.1077 - accuracy30: 0.4550 - val_loss: 3.4035 - val_accuracy30: 0.3584 - 5s/epoch - 23ms/step
Epoch 19/50
224/224 - 5s - loss: 3.0986 - accuracy30: 0.4609 - val_loss: 3.3480 - val_accuracy30: 0.3675 - 5s/epoch - 24ms/step
Epoch 20/50
224/224 - 5s - loss: 3.0911 - accuracy30: 0.4628 - val_loss: 3.3847 - val_accuracy30: 0.3583 - 5s/epoch - 24ms/step
Epoch 21/50
224/224 - 5s - loss: 3.0845 - accuracy30: 0.4663 - val_loss: 3.3375 - val_accuracy30: 0.3653 - 5s/epoch - 24ms/step
testing model: results/LILAK/W8/deepLOB_L1/h30
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1022911
{'0': {'precision': 0.3790216821122574, 'recall': 0.31929075141315755, 'f1-score': 0.3466016409661913, 'support': 54311}, '1': {'precision': 0.38850569597721607, 'recall': 0.3022450710564124, 'f1-score': 0.3399892907559753, 'support': 57771}, '2': {'precision': 0.35975642614646763, 'recall': 0.5053555883577457, 'f1-score': 0.4203037695758243, 'support': 52842}, 'accuracy': 0.3729354126749291, 'macro avg': {'precision': 0.37576126807864707, 'recall': 0.37563047027577195, 'f1-score': 0.3689649004326636, 'support': 164924}, 'weighted avg': {'precision': 0.3761711952774017, 'recall': 0.3729354126749291, 'f1-score': 0.36789972854589975, 'support': 164924}}
[[17341 13961 23009]
 [15795 17461 24515]
 [12616 13522 26704]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0935849
{'0': {'precision': 0.3973673592898931, 'recall': 0.4152524507220407, 'f1-score': 0.4061130869542807, 'support': 18974}, '1': {'precision': 0.4454557992001103, 'recall': 0.17163504968383017, 'f1-score': 0.24779439969313388, 'support': 18819}, '2': {'precision': 0.38739817123857023, 'recall': 0.6017767677289396, 'f1-score': 0.47135690589853546, 'support': 19361}, 'accuracy': 0.39822234664240475, 'macro avg': {'precision': 0.4100737765761912, 'recall': 0.3962214227116035, 'f1-score': 0.37508813084865, 'support': 57154}, 'weighted avg': {'precision': 0.40982428095432105, 'recall': 0.39822234664240475, 'f1-score': 0.37608520094476594, 'support': 57154}}
[[ 7879  1945  9150]
 [ 6315  3230  9274]
 [ 5634  2076 11651]]
Evaluating performance on  val set...
68/68 - 1s - 976ms/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1076282
{'0': {'precision': 0.3933451213631249, 'recall': 0.40912890820932957, 'f1-score': 0.4010817898705131, 'support': 5981}, '1': {'precision': 0.3182377553531873, 'recall': 0.2393557941503147, 'f1-score': 0.27321711568938195, 'support': 5402}, '2': {'precision': 0.38113044728894, 'recall': 0.45268192688759823, 'f1-score': 0.4138361833372375, 'support': 5854}, 'accuracy': 0.3707141613969948, 'macro avg': {'precision': 0.3642377746684174, 'recall': 0.3670555430824141, 'f1-score': 0.3627116962990442, 'support': 17237}, 'weighted avg': {'precision': 0.36565847674886715, 'recall': 0.3707141613969948, 'f1-score': 0.36534118822450357, 'support': 17237}}
[[2447 1462 2072]
 [1878 1293 2231]
 [1896 1308 2650]]
training model: results/LILAK/W8/deepLOB_L1/h50
Epoch 1/50
224/224 - 8s - loss: 3.3422 - accuracy50: 0.3639 - val_loss: 3.4039 - val_accuracy50: 0.3389 - 8s/epoch - 35ms/step
Epoch 2/50
224/224 - 5s - loss: 3.3129 - accuracy50: 0.3707 - val_loss: 3.3848 - val_accuracy50: 0.3345 - 5s/epoch - 24ms/step
Epoch 3/50
224/224 - 5s - loss: 3.2938 - accuracy50: 0.3782 - val_loss: 3.3854 - val_accuracy50: 0.3375 - 5s/epoch - 24ms/step
Epoch 4/50
224/224 - 5s - loss: 3.2749 - accuracy50: 0.3930 - val_loss: 3.3615 - val_accuracy50: 0.3516 - 5s/epoch - 24ms/step
Epoch 5/50
224/224 - 5s - loss: 3.2773 - accuracy50: 0.3841 - val_loss: 3.3610 - val_accuracy50: 0.3455 - 5s/epoch - 24ms/step
Epoch 6/50
224/224 - 5s - loss: 3.2674 - accuracy50: 0.3928 - val_loss: 3.3669 - val_accuracy50: 0.3615 - 5s/epoch - 24ms/step
Epoch 7/50
224/224 - 5s - loss: 3.2744 - accuracy50: 0.3851 - val_loss: 3.3275 - val_accuracy50: 0.3644 - 5s/epoch - 24ms/step
Epoch 8/50
224/224 - 5s - loss: 3.2778 - accuracy50: 0.3861 - val_loss: 3.3180 - val_accuracy50: 0.3589 - 5s/epoch - 24ms/step
Epoch 9/50
224/224 - 5s - loss: 3.2606 - accuracy50: 0.3909 - val_loss: 3.3314 - val_accuracy50: 0.3623 - 5s/epoch - 24ms/step
Epoch 10/50
224/224 - 5s - loss: 3.2636 - accuracy50: 0.3913 - val_loss: 3.3142 - val_accuracy50: 0.3665 - 5s/epoch - 24ms/step
Epoch 11/50
224/224 - 6s - loss: 3.2543 - accuracy50: 0.3989 - val_loss: 3.3001 - val_accuracy50: 0.3741 - 6s/epoch - 25ms/step
Epoch 12/50
224/224 - 6s - loss: 3.2461 - accuracy50: 0.3991 - val_loss: 3.3122 - val_accuracy50: 0.3694 - 6s/epoch - 25ms/step
Epoch 13/50
224/224 - 5s - loss: 3.2358 - accuracy50: 0.4036 - val_loss: 3.3130 - val_accuracy50: 0.3673 - 5s/epoch - 24ms/step
Epoch 14/50
224/224 - 5s - loss: 3.2256 - accuracy50: 0.4079 - val_loss: 3.3014 - val_accuracy50: 0.3686 - 5s/epoch - 24ms/step
Epoch 15/50
224/224 - 5s - loss: 3.2145 - accuracy50: 0.4163 - val_loss: 3.3073 - val_accuracy50: 0.3656 - 5s/epoch - 24ms/step
Epoch 16/50
224/224 - 5s - loss: 3.2036 - accuracy50: 0.4176 - val_loss: 3.3161 - val_accuracy50: 0.3658 - 5s/epoch - 24ms/step
Epoch 17/50
224/224 - 5s - loss: 3.1953 - accuracy50: 0.4225 - val_loss: 3.3152 - val_accuracy50: 0.3606 - 5s/epoch - 24ms/step
Epoch 18/50
224/224 - 5s - loss: 3.1934 - accuracy50: 0.4187 - val_loss: 3.3112 - val_accuracy50: 0.3535 - 5s/epoch - 24ms/step
Epoch 19/50
224/224 - 5s - loss: 3.1775 - accuracy50: 0.4263 - val_loss: 3.3254 - val_accuracy50: 0.3650 - 5s/epoch - 24ms/step
Epoch 20/50
224/224 - 5s - loss: 3.1655 - accuracy50: 0.4267 - val_loss: 3.3151 - val_accuracy50: 0.3641 - 5s/epoch - 24ms/step
Epoch 21/50
224/224 - 5s - loss: 3.1577 - accuracy50: 0.4301 - val_loss: 3.3365 - val_accuracy50: 0.3493 - 5s/epoch - 24ms/step
testing model: results/LILAK/W8/deepLOB_L1/h50
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.10748
{'0': {'precision': 0.3719979926876479, 'recall': 0.3702791900811703, 'f1-score': 0.3711366013714674, 'support': 56055}, '1': {'precision': 0.38028169014084506, 'recall': 0.00395040052672007, 'f1-score': 0.007819570647648698, 'support': 54678}, '2': {'precision': 0.340659543109801, 'recall': 0.6824380432175084, 'f1-score': 0.4544611093019397, 'support': 54191}, 'accuracy': 0.35139821978608327, 'macro avg': {'precision': 0.36431307531276463, 'recall': 0.3522225446084663, 'f1-score': 0.27780576044035193, 'support': 164924}, 'weighted avg': {'precision': 0.3644470849257261, 'recall': 0.35139821978608327, 'f1-score': 0.2780633664471584, 'support': 164924}}
[[20756   178 35121]
 [18005   216 36457]
 [17035   174 36982]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1042213
{'0': {'precision': 0.36509715994020925, 'recall': 0.5190182745431364, 'f1-score': 0.42865917865917863, 'support': 18824}, '1': {'precision': 0.6052631578947368, 'recall': 0.004838031131678587, 'f1-score': 0.009599332220367279, 'support': 19016}, '2': {'precision': 0.364327756100787, 'recall': 0.5704670187428809, 'f1-score': 0.44466865768020025, 'support': 19314}, 'accuracy': 0.36532876089162614, 'macro avg': {'precision': 0.4448960246452443, 'recall': 0.3647744414725653, 'f1-score': 0.29430905618658204, 'support': 57154}, 'weighted avg': {'precision': 0.4447440149520841, 'recall': 0.36532876089162614, 'f1-score': 0.2946417002312746, 'support': 57154}}
[[ 9770    34  9020]
 [ 8720    92 10204]
 [ 8270    26 11018]]
Evaluating performance on  val set...
68/68 - 1s - 938ms/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0999781
{'0': {'precision': 0.37601257405392335, 'recall': 0.5109249219648431, 'f1-score': 0.4332079676835214, 'support': 6087}, '1': {'precision': 0.38571428571428573, 'recall': 0.005130153904617138, 'f1-score': 0.010125632852053253, 'support': 5263}, '2': {'precision': 0.364658273381295, 'recall': 0.5510446747069815, 'f1-score': 0.4388825001691132, 'support': 5887}, 'accuracy': 0.37019202877530893, 'macro avg': {'precision': 0.37546171104983467, 'recall': 0.3556999168588139, 'f1-score': 0.29407203356822925, 'support': 17237}, 'weighted avg': {'precision': 0.3750969472284157, 'recall': 0.37019202877530893, 'f1-score': 0.30596561950951556, 'support': 17237}}
[[3110   21 2956]
 [2540   27 2696]
 [2621   22 3244]]
training model: results/LILAK/W8/deepLOB_L1/h100
Epoch 1/50
224/224 - 8s - loss: 3.3446 - accuracy100: 0.3610 - val_loss: 3.3869 - val_accuracy100: 0.3410 - 8s/epoch - 35ms/step
Epoch 2/50
224/224 - 6s - loss: 3.3186 - accuracy100: 0.3687 - val_loss: 3.3382 - val_accuracy100: 0.3509 - 6s/epoch - 25ms/step
Epoch 3/50
224/224 - 6s - loss: 3.3000 - accuracy100: 0.3743 - val_loss: 3.3290 - val_accuracy100: 0.3538 - 6s/epoch - 25ms/step
Epoch 4/50
224/224 - 6s - loss: 3.2922 - accuracy100: 0.3779 - val_loss: 3.3205 - val_accuracy100: 0.3591 - 6s/epoch - 25ms/step
Epoch 5/50
224/224 - 5s - loss: 3.2773 - accuracy100: 0.3844 - val_loss: 3.3277 - val_accuracy100: 0.3440 - 5s/epoch - 24ms/step
Epoch 6/50
224/224 - 5s - loss: 3.2765 - accuracy100: 0.3833 - val_loss: 3.3388 - val_accuracy100: 0.3410 - 5s/epoch - 24ms/step
Epoch 7/50
224/224 - 5s - loss: 3.2833 - accuracy100: 0.3770 - val_loss: 3.3167 - val_accuracy100: 0.3475 - 5s/epoch - 24ms/step
Epoch 8/50
224/224 - 5s - loss: 3.2708 - accuracy100: 0.3878 - val_loss: 3.3116 - val_accuracy100: 0.3499 - 5s/epoch - 24ms/step
Epoch 9/50
224/224 - 5s - loss: 3.2714 - accuracy100: 0.3790 - val_loss: 3.3096 - val_accuracy100: 0.3614 - 5s/epoch - 24ms/step
Epoch 10/50
224/224 - 5s - loss: 3.2529 - accuracy100: 0.3950 - val_loss: 3.3185 - val_accuracy100: 0.3457 - 5s/epoch - 24ms/step
Epoch 11/50
224/224 - 5s - loss: 3.2426 - accuracy100: 0.4043 - val_loss: 3.3208 - val_accuracy100: 0.3549 - 5s/epoch - 24ms/step
Epoch 12/50
224/224 - 5s - loss: 3.2459 - accuracy100: 0.4032 - val_loss: 3.3197 - val_accuracy100: 0.3530 - 5s/epoch - 24ms/step
Epoch 13/50
224/224 - 5s - loss: 3.2372 - accuracy100: 0.4041 - val_loss: 3.3410 - val_accuracy100: 0.3468 - 5s/epoch - 24ms/step
Epoch 14/50
224/224 - 5s - loss: 3.2250 - accuracy100: 0.4096 - val_loss: 3.3170 - val_accuracy100: 0.3578 - 5s/epoch - 24ms/step
Epoch 15/50
224/224 - 5s - loss: 3.2103 - accuracy100: 0.4165 - val_loss: 3.3286 - val_accuracy100: 0.3568 - 5s/epoch - 24ms/step
Epoch 16/50
224/224 - 5s - loss: 3.2004 - accuracy100: 0.4171 - val_loss: 3.3327 - val_accuracy100: 0.3505 - 5s/epoch - 24ms/step
Epoch 17/50
224/224 - 5s - loss: 3.1916 - accuracy100: 0.4211 - val_loss: 3.3464 - val_accuracy100: 0.3546 - 5s/epoch - 24ms/step
Epoch 18/50
224/224 - 5s - loss: 3.1869 - accuracy100: 0.4219 - val_loss: 3.3491 - val_accuracy100: 0.3548 - 5s/epoch - 24ms/step
Epoch 19/50
224/224 - 5s - loss: 3.1799 - accuracy100: 0.4272 - val_loss: 3.3639 - val_accuracy100: 0.3525 - 5s/epoch - 24ms/step
testing model: results/LILAK/W8/deepLOB_L1/h100
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1030484
{'0': {'precision': 0.350717776420281, 'recall': 0.4881755859063613, 'f1-score': 0.4081850296607345, 'support': 56451}, '1': {'precision': 0.32201296696511267, 'recall': 0.01954830849967201, 'f1-score': 0.03685903099268474, 'support': 53355}, '2': {'precision': 0.35927516875428656, 'recall': 0.5417286548858812, 'f1-score': 0.43202847489998336, 'support': 55118}, 'accuracy': 0.35446629962892, 'macro avg': {'precision': 0.34400197071322675, 'recall': 0.34981751643063813, 'f1-score': 0.2923575118511342, 'support': 164924}, 'weighted avg': {'precision': 0.3442913087271933, 'recall': 0.35446629962892, 'f1-score': 0.2960249095797465, 'support': 164924}}
[[27558  1254 27639]
 [26701  1043 25611]
 [24317   942 29859]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1075116
{'0': {'precision': 0.35868692159944127, 'recall': 0.5379458440266066, 'f1-score': 0.4303972510895072, 'support': 19093}, '1': {'precision': 0.3123680878007598, 'recall': 0.03909965127338053, 'f1-score': 0.06949988260154964, 'support': 18926}, '2': {'precision': 0.35923518164435947, 'recall': 0.4909328455709433, 'f1-score': 0.414883515512863, 'support': 19135}, 'accuracy': 0.35701788151310493, 'macro avg': {'precision': 0.3434300636815202, 'recall': 0.3559927802903102, 'f1-score': 0.3049268830679733, 'support': 57154}, 'weighted avg': {'precision': 0.3435324391045269, 'recall': 0.35701788151310493, 'f1-score': 0.30569558670447433, 'support': 57154}}
[[10271   879  7943]
 [ 9373   740  8813]
 [ 8991   750  9394]]
Evaluating performance on  val set...
68/68 - 1s - 934ms/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1028565
{'0': {'precision': 0.3594787015807892, 'recall': 0.49199009083402145, 'f1-score': 0.4154232324640915, 'support': 6055}, '1': {'precision': 0.3543046357615894, 'recall': 0.1995151967182547, 'f1-score': 0.25527853990218297, 'support': 5363}, '2': {'precision': 0.36222596964586845, 'recall': 0.369135590307613, 'f1-score': 0.3656481402672567, 'support': 5819}, 'accuracy': 0.35951731739861925, 'macro avg': {'precision': 0.3586697689960823, 'recall': 0.35354695928662966, 'f1-score': 0.34544997087784374, 'support': 17237}, 'weighted avg': {'precision': 0.3587963228537675, 'recall': 0.35951731739861925, 'f1-score': 0.3487934681371844, 'support': 17237}}
[[2979  995 2081]
 [2592 1070 1701]
 [2716  955 2148]]
training model: results/LILAK/W8/deepLOB_L1/h200
Epoch 1/50
224/224 - 8s - loss: 3.3412 - accuracy200: 0.3628 - val_loss: 3.4540 - val_accuracy200: 0.3376 - 8s/epoch - 34ms/step
Epoch 2/50
224/224 - 5s - loss: 3.3190 - accuracy200: 0.3703 - val_loss: 3.4026 - val_accuracy200: 0.3418 - 5s/epoch - 24ms/step
Epoch 3/50
224/224 - 5s - loss: 3.3025 - accuracy200: 0.3718 - val_loss: 3.3716 - val_accuracy200: 0.3397 - 5s/epoch - 24ms/step
Epoch 4/50
224/224 - 5s - loss: 3.2950 - accuracy200: 0.3749 - val_loss: 3.3690 - val_accuracy200: 0.3403 - 5s/epoch - 24ms/step
Epoch 5/50
224/224 - 5s - loss: 3.2849 - accuracy200: 0.3774 - val_loss: 3.3343 - val_accuracy200: 0.3438 - 5s/epoch - 24ms/step
Epoch 6/50
224/224 - 5s - loss: 3.2925 - accuracy200: 0.3713 - val_loss: 3.3613 - val_accuracy200: 0.3425 - 5s/epoch - 24ms/step
Epoch 7/50
224/224 - 5s - loss: 3.2856 - accuracy200: 0.3728 - val_loss: 3.3528 - val_accuracy200: 0.3470 - 5s/epoch - 24ms/step
Epoch 8/50
224/224 - 5s - loss: 3.2801 - accuracy200: 0.3797 - val_loss: 3.3434 - val_accuracy200: 0.3371 - 5s/epoch - 24ms/step
Epoch 9/50
224/224 - 5s - loss: 3.2725 - accuracy200: 0.3822 - val_loss: 3.3732 - val_accuracy200: 0.3467 - 5s/epoch - 24ms/step
Epoch 10/50
224/224 - 5s - loss: 3.2596 - accuracy200: 0.3941 - val_loss: 3.3651 - val_accuracy200: 0.3405 - 5s/epoch - 24ms/step
Epoch 11/50
224/224 - 5s - loss: 3.2540 - accuracy200: 0.3943 - val_loss: 3.3776 - val_accuracy200: 0.3409 - 5s/epoch - 24ms/step
Epoch 12/50
224/224 - 6s - loss: 3.2442 - accuracy200: 0.4042 - val_loss: 3.3923 - val_accuracy200: 0.3369 - 6s/epoch - 25ms/step
Epoch 13/50
224/224 - 5s - loss: 3.2367 - accuracy200: 0.4101 - val_loss: 3.4880 - val_accuracy200: 0.3393 - 5s/epoch - 24ms/step
Epoch 14/50
224/224 - 5s - loss: 3.2280 - accuracy200: 0.4120 - val_loss: 3.4624 - val_accuracy200: 0.3345 - 5s/epoch - 24ms/step
Epoch 15/50
224/224 - 5s - loss: 3.2247 - accuracy200: 0.4113 - val_loss: 3.5933 - val_accuracy200: 0.3367 - 5s/epoch - 24ms/step
testing model: results/LILAK/W8/deepLOB_L1/h200
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1026399
{'0': {'precision': 0.35033577141879463, 'recall': 0.29770104497955474, 'f1-score': 0.3218808641914661, 'support': 55025}, '1': {'precision': 0.3828341215624453, 'recall': 0.20015385178944284, 'f1-score': 0.26287240056288563, 'support': 54598}, '2': {'precision': 0.35939121411276376, 'recall': 0.5824306974557422, 'f1-score': 0.44450117994507393, 'support': 55301}, 'accuracy': 0.3608813756639422, 'macro avg': {'precision': 0.36418703569800126, 'recall': 0.36009519807491325, 'f1-score': 0.3430848148998085, 'support': 164924}, 'weighted avg': {'precision': 0.36413073126431267, 'recall': 0.3608813756639422, 'f1-score': 0.34346221065588023, 'support': 164924}}
[[16381  8531 30113]
 [16371 10928 27299]
 [14006  9086 32209]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.119288
{'0': {'precision': 0.34474662492662883, 'recall': 0.1842710729972809, 'f1-score': 0.24016901792407824, 'support': 19124}, '1': {'precision': 0.3196641007697691, 'recall': 0.12123142250530786, 'f1-score': 0.175793727150279, 'support': 18840}, '2': {'precision': 0.33488325332395, 'recall': 0.6943199583116206, 'f1-score': 0.45183715685775805, 'support': 19190}, 'accuracy': 0.3347447247786682, 'macro avg': {'precision': 0.3330979930067826, 'recall': 0.33327415127140314, 'f1-score': 0.2892666339773718, 'support': 57154}, 'weighted avg': {'precision': 0.33316680800794174, 'recall': 0.3347447247786682, 'f1-score': 0.2900182167195945, 'support': 57154}}
[[ 3524  2500 13100]
 [ 3193  2284 13363]
 [ 3505  2361 13324]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1119453
{'0': {'precision': 0.3687222778652168, 'recall': 0.4201173785458102, 'f1-score': 0.3927455612283777, 'support': 6134}, '1': {'precision': 0.2977422389463782, 'recall': 0.12061737804878049, 'f1-score': 0.17168429617575265, 'support': 5248}, '2': {'precision': 0.34338832799803004, 'recall': 0.4763450042698548, 'f1-score': 0.3990842097731988, 'support': 5855}, 'accuracy': 0.34803039972152927, 'macro avg': {'precision': 0.3366176149365417, 'recall': 0.3390265869548152, 'f1-score': 0.32117135572577643, 'support': 17237}, 'weighted avg': {'precision': 0.33850625879470314, 'recall': 0.34803039972152927, 'f1-score': 0.32759404230012756, 'support': 17237}}
[[2577  724 2833]
 [2115  633 2500]
 [2297  769 2789]]
training model: results/LILAK/W8/deepLOB_L1/h300
Epoch 1/50
224/224 - 7s - loss: 3.3439 - accuracy300: 0.3657 - val_loss: 3.3713 - val_accuracy300: 0.3429 - 7s/epoch - 33ms/step
Epoch 2/50
224/224 - 5s - loss: 3.3139 - accuracy300: 0.3767 - val_loss: 3.3583 - val_accuracy300: 0.3404 - 5s/epoch - 24ms/step
Epoch 3/50
224/224 - 5s - loss: 3.2965 - accuracy300: 0.3739 - val_loss: 3.3523 - val_accuracy300: 0.3432 - 5s/epoch - 24ms/step
Epoch 4/50
224/224 - 5s - loss: 3.2887 - accuracy300: 0.3775 - val_loss: 3.3866 - val_accuracy300: 0.3283 - 5s/epoch - 24ms/step
Epoch 5/50
224/224 - 5s - loss: 3.2858 - accuracy300: 0.3759 - val_loss: 3.3650 - val_accuracy300: 0.3419 - 5s/epoch - 24ms/step
Epoch 6/50
224/224 - 5s - loss: 3.2941 - accuracy300: 0.3697 - val_loss: 3.3553 - val_accuracy300: 0.3376 - 5s/epoch - 24ms/step
Epoch 7/50
224/224 - 5s - loss: 3.2949 - accuracy300: 0.3734 - val_loss: 3.3585 - val_accuracy300: 0.3354 - 5s/epoch - 24ms/step
Epoch 8/50
224/224 - 5s - loss: 3.2813 - accuracy300: 0.3780 - val_loss: 3.3567 - val_accuracy300: 0.3330 - 5s/epoch - 24ms/step
Epoch 9/50
224/224 - 5s - loss: 3.2756 - accuracy300: 0.3866 - val_loss: 3.3443 - val_accuracy300: 0.3367 - 5s/epoch - 24ms/step
Epoch 10/50
224/224 - 5s - loss: 3.2682 - accuracy300: 0.3860 - val_loss: 3.3730 - val_accuracy300: 0.3365 - 5s/epoch - 24ms/step
Epoch 11/50
224/224 - 5s - loss: 3.2676 - accuracy300: 0.3847 - val_loss: 3.3626 - val_accuracy300: 0.3349 - 5s/epoch - 24ms/step
Epoch 12/50
224/224 - 5s - loss: 3.2490 - accuracy300: 0.3969 - val_loss: 3.3629 - val_accuracy300: 0.3351 - 5s/epoch - 24ms/step
Epoch 13/50
224/224 - 5s - loss: 3.2449 - accuracy300: 0.4035 - val_loss: 3.3876 - val_accuracy300: 0.3325 - 5s/epoch - 23ms/step
Epoch 14/50
224/224 - 5s - loss: 3.2316 - accuracy300: 0.4119 - val_loss: 3.3893 - val_accuracy300: 0.3357 - 5s/epoch - 24ms/step
Epoch 15/50
224/224 - 5s - loss: 3.2252 - accuracy300: 0.4110 - val_loss: 3.4315 - val_accuracy300: 0.3361 - 5s/epoch - 24ms/step
Epoch 16/50
224/224 - 5s - loss: 3.2186 - accuracy300: 0.4155 - val_loss: 3.4712 - val_accuracy300: 0.3383 - 5s/epoch - 24ms/step
Epoch 17/50
224/224 - 5s - loss: 3.2049 - accuracy300: 0.4227 - val_loss: 3.4737 - val_accuracy300: 0.3389 - 5s/epoch - 24ms/step
Epoch 18/50
224/224 - 5s - loss: 3.1884 - accuracy300: 0.4287 - val_loss: 3.4818 - val_accuracy300: 0.3359 - 5s/epoch - 24ms/step
Epoch 19/50
224/224 - 5s - loss: 3.1842 - accuracy300: 0.4305 - val_loss: 3.5121 - val_accuracy300: 0.3379 - 5s/epoch - 24ms/step
testing model: results/LILAK/W8/deepLOB_L1/h300
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1146891
{'0': {'precision': 0.33152349789651575, 'recall': 0.1628917706088124, 'f1-score': 0.21844976484664685, 'support': 56602}, '1': {'precision': 0.34036363636363637, 'recall': 0.009227857086521019, 'f1-score': 0.017968555028699776, 'support': 50716}, '2': {'precision': 0.35365925533012127, 'recall': 0.8333333333333334, 'f1-score': 0.4965760509764978, 'support': 57606}, 'accuracy': 0.34981567267347385, 'macro avg': {'precision': 0.34184879653009115, 'recall': 0.33515098700955565, 'f1-score': 0.24433145695061484, 'support': 164924}, 'weighted avg': {'precision': 0.3419736986266628, 'recall': 0.34981567267347385, 'f1-score': 0.25394573754721916, 'support': 164924}}
[[ 9220   467 46915]
 [ 9430   468 40818]
 [ 9161   440 48005]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1147805
{'0': {'precision': 0.3558462359850507, 'recall': 0.27971881229671597, 'f1-score': 0.31322328614227807, 'support': 19062}, '1': {'precision': 0.28212290502793297, 'recall': 0.00536663124335813, 'f1-score': 0.01053290228386693, 'support': 18820}, '2': {'precision': 0.3424614943078542, 'recall': 0.7429950186799502, 'f1-score': 0.46882980813306263, 'support': 19272}, 'accuracy': 0.345592609441159, 'macro avg': {'precision': 0.32681021177361264, 'recall': 0.34269348740667477, 'f1-score': 0.26419533218640257, 'support': 57154}, 'weighted avg': {'precision': 0.32705693287038007, 'recall': 0.345592609441159, 'f1-score': 0.2660212682186175, 'support': 57154}}
[[ 5332   133 13597]
 [ 4823   101 13896]
 [ 4829   124 14319]]
Evaluating performance on  val set...
68/68 - 1s - 925ms/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1139402
{'0': {'precision': 0.34199253834461796, 'recall': 0.4015249837767683, 'f1-score': 0.36937541974479515, 'support': 6164}, '1': {'precision': 0.31886792452830187, 'recall': 0.03178484107579462, 'f1-score': 0.05780742260988541, 'support': 5317}, '2': {'precision': 0.3333685322069694, 'recall': 0.5484711605281446, 'f1-score': 0.41468540654144226, 'support': 5756}, 'accuracy': 0.3365434820444393, 'macro avg': {'precision': 0.3314096650266297, 'recall': 0.32726032846023584, 'f1-score': 0.280622749632041, 'support': 17237}, 'weighted avg': {'precision': 0.331979580695975, 'recall': 0.3365434820444393, 'f1-score': 0.2883982916619029, 'support': 17237}}
[[2475  183 3506]
 [2341  169 2807]
 [2421  178 3157]]
training model: results/LILAK/W8/deepLOB_L1/h500
Epoch 1/50
224/224 - 8s - loss: 3.3492 - accuracy500: 0.3641 - val_loss: 3.5663 - val_accuracy500: 0.3334 - 8s/epoch - 35ms/step
Epoch 2/50
224/224 - 5s - loss: 3.3005 - accuracy500: 0.3879 - val_loss: 3.3754 - val_accuracy500: 0.3414 - 5s/epoch - 24ms/step
Epoch 3/50
224/224 - 5s - loss: 3.2932 - accuracy500: 0.3852 - val_loss: 3.3764 - val_accuracy500: 0.3487 - 5s/epoch - 24ms/step
Epoch 4/50
224/224 - 6s - loss: 3.2676 - accuracy500: 0.3909 - val_loss: 3.3704 - val_accuracy500: 0.3400 - 6s/epoch - 25ms/step
Epoch 5/50
224/224 - 6s - loss: 3.2796 - accuracy500: 0.3964 - val_loss: 3.4386 - val_accuracy500: 0.3446 - 6s/epoch - 25ms/step
Epoch 6/50
224/224 - 5s - loss: 3.2656 - accuracy500: 0.3926 - val_loss: 3.3839 - val_accuracy500: 0.3422 - 5s/epoch - 24ms/step
Epoch 7/50
224/224 - 5s - loss: 3.2736 - accuracy500: 0.3924 - val_loss: 3.4175 - val_accuracy500: 0.3414 - 5s/epoch - 24ms/step
Epoch 8/50
224/224 - 5s - loss: 3.2603 - accuracy500: 0.4021 - val_loss: 3.4066 - val_accuracy500: 0.3387 - 5s/epoch - 24ms/step
Epoch 9/50
224/224 - 5s - loss: 3.2384 - accuracy500: 0.4153 - val_loss: 3.4206 - val_accuracy500: 0.3377 - 5s/epoch - 24ms/step
Epoch 10/50
224/224 - 5s - loss: 3.2359 - accuracy500: 0.4157 - val_loss: 3.4073 - val_accuracy500: 0.3456 - 5s/epoch - 24ms/step
Epoch 11/50
224/224 - 5s - loss: 3.2200 - accuracy500: 0.4231 - val_loss: 3.4826 - val_accuracy500: 0.3472 - 5s/epoch - 24ms/step
Epoch 12/50
224/224 - 5s - loss: 3.2138 - accuracy500: 0.4248 - val_loss: 3.5104 - val_accuracy500: 0.3478 - 5s/epoch - 24ms/step
Epoch 13/50
224/224 - 5s - loss: 3.2008 - accuracy500: 0.4237 - val_loss: 3.4799 - val_accuracy500: 0.3499 - 5s/epoch - 24ms/step
Epoch 14/50
224/224 - 5s - loss: 3.1994 - accuracy500: 0.4252 - val_loss: 3.5379 - val_accuracy500: 0.3492 - 5s/epoch - 24ms/step
testing model: results/LILAK/W8/deepLOB_L1/h500
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0890738
{'0': {'precision': 0.3922511231293101, 'recall': 0.21598285750299365, 'f1-score': 0.2785754204135549, 'support': 63468}, '1': {'precision': 0.25517928286852587, 'recall': 0.033525255168803975, 'f1-score': 0.05926439972241498, 'support': 38210}, '2': {'precision': 0.39275910913354195, 'recall': 0.7759858330961642, 'f1-score': 0.5215432272599269, 'support': 63246}, 'accuracy': 0.38846377725497805, 'macro avg': {'precision': 0.34672983837712595, 'recall': 0.34183131525598726, 'f1-score': 0.28646101579863226, 'support': 164924}, 'weighted avg': {'precision': 0.3606887857281985, 'recall': 0.38846377725497805, 'f1-score': 0.3209395870066352, 'support': 164924}}
[[13708  2147 47613]
 [ 8663  1281 28266]
 [12576  1592 49078]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1303059
{'0': {'precision': 0.35268505079825835, 'recall': 0.1799904766943548, 'f1-score': 0.23834378393526465, 'support': 18901}, '1': {'precision': 0.29404088734232275, 'recall': 0.0358183648598527, 'f1-score': 0.06385792556206311, 'support': 18873}, '2': {'precision': 0.33679134685571455, 'recall': 0.785655314757482, 'f1-score': 0.4714734707148276, 'support': 19380}, 'accuracy': 0.3377541379431011, 'macro avg': {'precision': 0.32783909499876523, 'recall': 0.33382138543722983, 'f1-score': 0.2578917267373851, 'support': 57154}, 'weighted avg': {'precision': 0.3279306805125326, 'recall': 0.3377541379431011, 'f1-score': 0.2597767846825526, 'support': 57154}}
[[ 3402   825 14674]
 [ 2888   676 15309]
 [ 3356   798 15226]]
Evaluating performance on  val set...
68/68 - 1s - 949ms/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1232591
{'0': {'precision': 0.3842682140554481, 'recall': 0.27021308750188905, 'f1-score': 0.31730257320319427, 'support': 6617}, '1': {'precision': 0.2972408026755853, 'recall': 0.1424278846153846, 'f1-score': 0.19257854821235104, 'support': 4992}, '2': {'precision': 0.3226059654631083, 'recall': 0.5842217484008528, 'f1-score': 0.4156763590391909, 'support': 5628}, 'accuracy': 0.335731275744039, 'macro avg': {'precision': 0.33470499406471393, 'recall': 0.33228757350604216, 'f1-score': 0.3085191601515787, 'support': 17237}, 'weighted avg': {'precision': 0.3389310920106628, 'recall': 0.335731275744039, 'f1-score': 0.3133010261782306, 'support': 17237}}
[[1788  893 3936]
 [1313  711 2968]
 [1552  788 3288]]
training model: results/LILAK/W8/deepLOB_L1/h1000
Epoch 1/50
224/224 - 8s - loss: 3.3444 - accuracy1000: 0.3655 - val_loss: 3.4631 - val_accuracy1000: 0.3461 - 8s/epoch - 34ms/step
Epoch 2/50
224/224 - 6s - loss: 3.3047 - accuracy1000: 0.3854 - val_loss: 3.4291 - val_accuracy1000: 0.3425 - 6s/epoch - 25ms/step
Epoch 3/50
224/224 - 5s - loss: 3.2861 - accuracy1000: 0.3950 - val_loss: 3.5489 - val_accuracy1000: 0.3273 - 5s/epoch - 24ms/step
Epoch 4/50
224/224 - 5s - loss: 3.2736 - accuracy1000: 0.3948 - val_loss: 3.5300 - val_accuracy1000: 0.3290 - 5s/epoch - 24ms/step
Epoch 5/50
224/224 - 5s - loss: 3.2700 - accuracy1000: 0.3978 - val_loss: 3.4560 - val_accuracy1000: 0.3425 - 5s/epoch - 24ms/step
Epoch 6/50
224/224 - 5s - loss: 3.2602 - accuracy1000: 0.4045 - val_loss: 3.4810 - val_accuracy1000: 0.3339 - 5s/epoch - 24ms/step
Epoch 7/50
224/224 - 5s - loss: 3.2492 - accuracy1000: 0.4048 - val_loss: 3.4285 - val_accuracy1000: 0.3400 - 5s/epoch - 24ms/step
Epoch 8/50
224/224 - 5s - loss: 3.2416 - accuracy1000: 0.4014 - val_loss: 3.4544 - val_accuracy1000: 0.3397 - 5s/epoch - 24ms/step
Epoch 9/50
224/224 - 5s - loss: 3.2341 - accuracy1000: 0.4076 - val_loss: 3.4906 - val_accuracy1000: 0.3330 - 5s/epoch - 24ms/step
Epoch 10/50
224/224 - 5s - loss: 3.2362 - accuracy1000: 0.4077 - val_loss: 3.4277 - val_accuracy1000: 0.3494 - 5s/epoch - 24ms/step
Epoch 11/50
224/224 - 5s - loss: 3.2237 - accuracy1000: 0.4104 - val_loss: 3.4652 - val_accuracy1000: 0.3437 - 5s/epoch - 24ms/step
Epoch 12/50
224/224 - 5s - loss: 3.2020 - accuracy1000: 0.4232 - val_loss: 3.5573 - val_accuracy1000: 0.3274 - 5s/epoch - 24ms/step
Epoch 13/50
224/224 - 5s - loss: 3.1929 - accuracy1000: 0.4357 - val_loss: 3.5934 - val_accuracy1000: 0.3381 - 5s/epoch - 24ms/step
Epoch 14/50
224/224 - 5s - loss: 3.1848 - accuracy1000: 0.4381 - val_loss: 3.5017 - val_accuracy1000: 0.3471 - 5s/epoch - 24ms/step
Epoch 15/50
224/224 - 5s - loss: 3.1743 - accuracy1000: 0.4340 - val_loss: 3.4414 - val_accuracy1000: 0.3459 - 5s/epoch - 24ms/step
Epoch 16/50
224/224 - 5s - loss: 3.1548 - accuracy1000: 0.4456 - val_loss: 3.4393 - val_accuracy1000: 0.3478 - 5s/epoch - 24ms/step
Epoch 17/50
224/224 - 5s - loss: 3.1431 - accuracy1000: 0.4499 - val_loss: 3.5024 - val_accuracy1000: 0.3453 - 5s/epoch - 24ms/step
Epoch 18/50
224/224 - 5s - loss: 3.1421 - accuracy1000: 0.4517 - val_loss: 3.4439 - val_accuracy1000: 0.3459 - 5s/epoch - 24ms/step
Epoch 19/50
224/224 - 5s - loss: 3.1309 - accuracy1000: 0.4519 - val_loss: 3.4810 - val_accuracy1000: 0.3462 - 5s/epoch - 24ms/step
Epoch 20/50
224/224 - 5s - loss: 3.1479 - accuracy1000: 0.4503 - val_loss: 3.4575 - val_accuracy1000: 0.3486 - 5s/epoch - 24ms/step
testing model: results/LILAK/W8/deepLOB_L1/h1000
Evaluating performance on  test set...
645/645 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1235992
{'0': {'precision': 0.35893241945115145, 'recall': 0.22827468916665292, 'f1-score': 0.27906742026645137, 'support': 60563}, '1': {'precision': 0.29360306178239476, 'recall': 0.0912160010191732, 'f1-score': 0.13918903594744772, 'support': 47097}, '2': {'precision': 0.3469648848132409, 'recall': 0.6772492316289467, 'f1-score': 0.4588526907991647, 'support': 57264}, 'accuracy': 0.34502558754335333, 'macro avg': {'precision': 0.3331667886822624, 'recall': 0.33224664060492426, 'f1-score': 0.29236971567102127, 'support': 164924}, 'weighted avg': {'precision': 0.33612115085694594, 'recall': 0.34502558754335333, 'f1-score': 0.3015466923282082, 'support': 164924}}
[[13825  4855 41883]
 [11691  4296 31110]
 [13001  5481 38782]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1315554
{'0': {'precision': 0.3387848412907764, 'recall': 0.20887997397809824, 'f1-score': 0.2584258358764546, 'support': 18446}, '1': {'precision': 0.37255232950708983, 'recall': 0.11512780386019823, 'f1-score': 0.17589862118434688, 'support': 19170}, '2': {'precision': 0.3480442582231478, 'recall': 0.7100010236462279, 'f1-score': 0.46711002609647273, 'support': 19538}, 'accuracy': 0.3487419953109144, 'macro avg': {'precision': 0.35312714300700465, 'recall': 0.34466960049484147, 'f1-score': 0.30047816105242475, 'support': 57154}, 'weighted avg': {'precision': 0.3532760971456842, 'recall': 0.3487419953109144, 'f1-score': 0.3020837601314676, 'support': 57154}}
[[ 3853  1892 12701]
 [ 3679  2207 13284]
 [ 3841  1825 13872]]
Evaluating performance on  val set...
68/68 - 1s - 927ms/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1373744
{'0': {'precision': 0.390105858924641, 'recall': 0.5349238286864041, 'f1-score': 0.4511788593248075, 'support': 6958}, '1': {'precision': 0.1900990099009901, 'recall': 0.02052597819114817, 'f1-score': 0.037051331532226936, 'support': 4677}, '2': {'precision': 0.311361424002225, 'recall': 0.3996786861835059, 'f1-score': 0.35003517548659424, 'support': 5602}, 'accuracy': 0.3513952543946162, 'macro avg': {'precision': 0.29718876427595203, 'recall': 0.31837616435368604, 'f1-score': 0.27942178878120955, 'support': 17237}, 'weighted avg': {'precision': 0.31024518959012864, 'recall': 0.3513952543946162, 'f1-score': 0.3059400495349618, 'support': 17237}}
[[3722  274 2962]
 [2591   96 1990]
 [3228  135 2239]]
training model: results/LILAK/W8/deepOF_L1/h10
Epoch 1/50
224/224 - 7s - loss: 3.2833 - accuracy10: 0.3875 - val_loss: 3.3316 - val_accuracy10: 0.3317 - 7s/epoch - 32ms/step
Epoch 2/50
224/224 - 5s - loss: 3.2416 - accuracy10: 0.4073 - val_loss: 3.3400 - val_accuracy10: 0.3225 - 5s/epoch - 22ms/step
Epoch 3/50
224/224 - 5s - loss: 3.2184 - accuracy10: 0.4201 - val_loss: 3.3487 - val_accuracy10: 0.3228 - 5s/epoch - 22ms/step
Epoch 4/50
224/224 - 5s - loss: 3.2006 - accuracy10: 0.4286 - val_loss: 3.3547 - val_accuracy10: 0.3267 - 5s/epoch - 22ms/step
Epoch 5/50
224/224 - 5s - loss: 3.1902 - accuracy10: 0.4303 - val_loss: 3.3159 - val_accuracy10: 0.3355 - 5s/epoch - 22ms/step
Epoch 6/50
224/224 - 5s - loss: 3.1710 - accuracy10: 0.4324 - val_loss: 3.3005 - val_accuracy10: 0.3380 - 5s/epoch - 22ms/step
Epoch 7/50
224/224 - 5s - loss: 3.1631 - accuracy10: 0.4384 - val_loss: 3.3054 - val_accuracy10: 0.3339 - 5s/epoch - 22ms/step
Epoch 8/50
224/224 - 5s - loss: 3.1525 - accuracy10: 0.4419 - val_loss: 3.2905 - val_accuracy10: 0.3410 - 5s/epoch - 22ms/step
Epoch 9/50
224/224 - 5s - loss: 3.1394 - accuracy10: 0.4412 - val_loss: 3.2910 - val_accuracy10: 0.3397 - 5s/epoch - 22ms/step
Epoch 10/50
224/224 - 5s - loss: 3.1268 - accuracy10: 0.4490 - val_loss: 3.2696 - val_accuracy10: 0.3499 - 5s/epoch - 22ms/step
Epoch 11/50
224/224 - 5s - loss: 3.1193 - accuracy10: 0.4505 - val_loss: 3.2793 - val_accuracy10: 0.3454 - 5s/epoch - 22ms/step
Epoch 12/50
224/224 - 5s - loss: 3.1159 - accuracy10: 0.4515 - val_loss: 3.2750 - val_accuracy10: 0.3430 - 5s/epoch - 23ms/step
Epoch 13/50
224/224 - 5s - loss: 3.1057 - accuracy10: 0.4577 - val_loss: 3.2671 - val_accuracy10: 0.3447 - 5s/epoch - 23ms/step
Epoch 14/50
224/224 - 5s - loss: 3.0964 - accuracy10: 0.4612 - val_loss: 3.2691 - val_accuracy10: 0.3491 - 5s/epoch - 22ms/step
Epoch 15/50
224/224 - 5s - loss: 3.0864 - accuracy10: 0.4639 - val_loss: 3.2770 - val_accuracy10: 0.3521 - 5s/epoch - 23ms/step
Epoch 16/50
224/224 - 5s - loss: 3.0794 - accuracy10: 0.4656 - val_loss: 3.2687 - val_accuracy10: 0.3502 - 5s/epoch - 22ms/step
Epoch 17/50
224/224 - 5s - loss: 3.0730 - accuracy10: 0.4667 - val_loss: 3.2623 - val_accuracy10: 0.3611 - 5s/epoch - 23ms/step
Epoch 18/50
224/224 - 5s - loss: 3.0652 - accuracy10: 0.4679 - val_loss: 3.2618 - val_accuracy10: 0.3576 - 5s/epoch - 23ms/step
Epoch 19/50
224/224 - 5s - loss: 3.0579 - accuracy10: 0.4704 - val_loss: 3.2646 - val_accuracy10: 0.3488 - 5s/epoch - 22ms/step
Epoch 20/50
224/224 - 5s - loss: 3.0532 - accuracy10: 0.4740 - val_loss: 3.2566 - val_accuracy10: 0.3569 - 5s/epoch - 23ms/step
Epoch 21/50
224/224 - 5s - loss: 3.0447 - accuracy10: 0.4783 - val_loss: 3.2666 - val_accuracy10: 0.3574 - 5s/epoch - 22ms/step
Epoch 22/50
224/224 - 5s - loss: 3.0394 - accuracy10: 0.4777 - val_loss: 3.2629 - val_accuracy10: 0.3581 - 5s/epoch - 22ms/step
Epoch 23/50
224/224 - 5s - loss: 3.0321 - accuracy10: 0.4844 - val_loss: 3.2466 - val_accuracy10: 0.3748 - 5s/epoch - 22ms/step
Epoch 24/50
224/224 - 5s - loss: 3.0272 - accuracy10: 0.4837 - val_loss: 3.2547 - val_accuracy10: 0.3686 - 5s/epoch - 22ms/step
Epoch 25/50
224/224 - 5s - loss: 3.0220 - accuracy10: 0.4828 - val_loss: 3.2656 - val_accuracy10: 0.3670 - 5s/epoch - 22ms/step
Epoch 26/50
224/224 - 5s - loss: 3.0168 - accuracy10: 0.4845 - val_loss: 3.2545 - val_accuracy10: 0.3690 - 5s/epoch - 22ms/step
Epoch 27/50
224/224 - 5s - loss: 3.0117 - accuracy10: 0.4879 - val_loss: 3.2501 - val_accuracy10: 0.3782 - 5s/epoch - 22ms/step
Epoch 28/50
224/224 - 5s - loss: 3.0067 - accuracy10: 0.4880 - val_loss: 3.2592 - val_accuracy10: 0.3715 - 5s/epoch - 22ms/step
Epoch 29/50
224/224 - 5s - loss: 2.9991 - accuracy10: 0.4920 - val_loss: 3.2579 - val_accuracy10: 0.3815 - 5s/epoch - 22ms/step
Epoch 30/50
224/224 - 5s - loss: 2.9925 - accuracy10: 0.4922 - val_loss: 3.2596 - val_accuracy10: 0.3717 - 5s/epoch - 22ms/step
Epoch 31/50
224/224 - 5s - loss: 2.9863 - accuracy10: 0.4947 - val_loss: 3.2551 - val_accuracy10: 0.3873 - 5s/epoch - 22ms/step
Epoch 32/50
224/224 - 5s - loss: 2.9861 - accuracy10: 0.4955 - val_loss: 3.3080 - val_accuracy10: 0.3549 - 5s/epoch - 23ms/step
Epoch 33/50
224/224 - 5s - loss: 2.9802 - accuracy10: 0.4967 - val_loss: 3.2759 - val_accuracy10: 0.3739 - 5s/epoch - 23ms/step
testing model: results/LILAK/W8/deepOF_L1/h10
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.129665
{'0': {'precision': 0.32431211363210616, 'recall': 0.6137211969554791, 'f1-score': 0.42437132310531783, 'support': 47955}, '1': {'precision': 0.59030745898249, 'recall': 0.12208788388605321, 'f1-score': 0.20232975757289354, 'support': 70138}, '2': {'precision': 0.32051153124161974, 'recall': 0.40838423098278737, 'f1-score': 0.3591510939994366, 'support': 46826}, 'accuracy': 0.3463336547032179, 'macro avg': {'precision': 0.411710367952072, 'recall': 0.3813977706081066, 'f1-score': 0.32861739155921604, 'support': 164919}, 'weighted avg': {'precision': 0.4363575144723266, 'recall': 0.3463336547032179, 'f1-score': 0.3114216097828676, 'support': 164919}}
[[29431  2868 15656]
 [36690  8563 24885]
 [24628  3075 19123]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0934193
{'0': {'precision': 0.3404083825900054, 'recall': 0.5947658725501702, 'f1-score': 0.4329958562945876, 'support': 17042}, '1': {'precision': 0.6273638786648051, 'recall': 0.21614412523503432, 'f1-score': 0.3215168466241707, 'support': 22869}, '2': {'precision': 0.3649417918867634, 'recall': 0.41268920721452185, 'f1-score': 0.38734962712971527, 'support': 17243}, 'accuracy': 0.3883367743290058, 'macro avg': {'precision': 0.444238017713858, 'recall': 0.40786640166657545, 'f1-score': 0.3806207766828245, 'support': 57154}, 'weighted avg': {'precision': 0.46262930879357106, 'recall': 0.3883367743290058, 'f1-score': 0.3746186403229556, 'support': 57154}}
[[10136  1458  5448]
 [10991  4943  6935]
 [ 8649  1478  7116]]
Evaluating performance on  val set...
68/68 - 1s - 969ms/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1001607
{'0': {'precision': 0.34227330779054915, 'recall': 0.6116394066184861, 'f1-score': 0.438924525726764, 'support': 5258}, '1': {'precision': 0.5569321533923304, 'recall': 0.14361783051878899, 'f1-score': 0.22835026608611517, 'support': 6573}, '2': {'precision': 0.3782552083333333, 'recall': 0.43005181347150256, 'f1-score': 0.402493938344302, 'support': 5404}, 'accuracy': 0.37621119814331305, 'macro avg': {'precision': 0.4258202231720709, 'recall': 0.3951030168695926, 'f1-score': 0.3565895767190604, 'support': 17235}, 'weighted avg': {'precision': 0.4354209017954063, 'recall': 0.37621119814331305, 'f1-score': 0.34719400627026215, 'support': 17235}}
[[3216  370 1672]
 [3481  944 2148]
 [2699  381 2324]]
training model: results/LILAK/W8/deepOF_L1/h20
Epoch 1/50
224/224 - 7s - loss: 3.2959 - accuracy20: 0.3749 - val_loss: 3.3942 - val_accuracy20: 0.3528 - 7s/epoch - 33ms/step
Epoch 2/50
224/224 - 5s - loss: 3.2672 - accuracy20: 0.3903 - val_loss: 3.3578 - val_accuracy20: 0.3532 - 5s/epoch - 23ms/step
Epoch 3/50
224/224 - 5s - loss: 3.2534 - accuracy20: 0.3938 - val_loss: 3.3239 - val_accuracy20: 0.3561 - 5s/epoch - 22ms/step
Epoch 4/50
224/224 - 5s - loss: 3.2394 - accuracy20: 0.4008 - val_loss: 3.3277 - val_accuracy20: 0.3529 - 5s/epoch - 22ms/step
Epoch 5/50
224/224 - 5s - loss: 3.2270 - accuracy20: 0.4042 - val_loss: 3.3181 - val_accuracy20: 0.3596 - 5s/epoch - 23ms/step
Epoch 6/50
224/224 - 5s - loss: 3.2205 - accuracy20: 0.4094 - val_loss: 3.3163 - val_accuracy20: 0.3528 - 5s/epoch - 23ms/step
Epoch 7/50
224/224 - 5s - loss: 3.2050 - accuracy20: 0.4142 - val_loss: 3.3086 - val_accuracy20: 0.3614 - 5s/epoch - 23ms/step
Epoch 8/50
224/224 - 5s - loss: 3.1930 - accuracy20: 0.4167 - val_loss: 3.3060 - val_accuracy20: 0.3605 - 5s/epoch - 23ms/step
Epoch 9/50
224/224 - 5s - loss: 3.1802 - accuracy20: 0.4201 - val_loss: 3.2939 - val_accuracy20: 0.3612 - 5s/epoch - 23ms/step
Epoch 10/50
224/224 - 5s - loss: 3.1718 - accuracy20: 0.4230 - val_loss: 3.2847 - val_accuracy20: 0.3628 - 5s/epoch - 22ms/step
Epoch 11/50
224/224 - 5s - loss: 3.1620 - accuracy20: 0.4253 - val_loss: 3.2883 - val_accuracy20: 0.3616 - 5s/epoch - 22ms/step
Epoch 12/50
224/224 - 5s - loss: 3.1518 - accuracy20: 0.4283 - val_loss: 3.2761 - val_accuracy20: 0.3702 - 5s/epoch - 23ms/step
Epoch 13/50
224/224 - 5s - loss: 3.1451 - accuracy20: 0.4313 - val_loss: 3.2816 - val_accuracy20: 0.3690 - 5s/epoch - 23ms/step
Epoch 14/50
224/224 - 5s - loss: 3.1415 - accuracy20: 0.4345 - val_loss: 3.2806 - val_accuracy20: 0.3657 - 5s/epoch - 22ms/step
Epoch 15/50
224/224 - 5s - loss: 3.1390 - accuracy20: 0.4333 - val_loss: 3.2762 - val_accuracy20: 0.3705 - 5s/epoch - 22ms/step
Epoch 16/50
224/224 - 5s - loss: 3.1325 - accuracy20: 0.4359 - val_loss: 3.2678 - val_accuracy20: 0.3741 - 5s/epoch - 23ms/step
Epoch 17/50
224/224 - 5s - loss: 3.1223 - accuracy20: 0.4407 - val_loss: 3.2793 - val_accuracy20: 0.3655 - 5s/epoch - 22ms/step
Epoch 18/50
224/224 - 5s - loss: 3.1171 - accuracy20: 0.4405 - val_loss: 3.2834 - val_accuracy20: 0.3698 - 5s/epoch - 22ms/step
Epoch 19/50
224/224 - 5s - loss: 3.1140 - accuracy20: 0.4465 - val_loss: 3.2761 - val_accuracy20: 0.3705 - 5s/epoch - 22ms/step
Epoch 20/50
224/224 - 5s - loss: 3.1046 - accuracy20: 0.4483 - val_loss: 3.2771 - val_accuracy20: 0.3656 - 5s/epoch - 22ms/step
Epoch 21/50
224/224 - 5s - loss: 3.1008 - accuracy20: 0.4507 - val_loss: 3.2735 - val_accuracy20: 0.3695 - 5s/epoch - 22ms/step
Epoch 22/50
224/224 - 5s - loss: 3.0940 - accuracy20: 0.4542 - val_loss: 3.2739 - val_accuracy20: 0.3722 - 5s/epoch - 22ms/step
Epoch 23/50
224/224 - 5s - loss: 3.0944 - accuracy20: 0.4518 - val_loss: 3.2782 - val_accuracy20: 0.3724 - 5s/epoch - 22ms/step
Epoch 24/50
224/224 - 5s - loss: 3.0869 - accuracy20: 0.4544 - val_loss: 3.2781 - val_accuracy20: 0.3727 - 5s/epoch - 22ms/step
Epoch 25/50
224/224 - 5s - loss: 3.0820 - accuracy20: 0.4574 - val_loss: 3.2792 - val_accuracy20: 0.3694 - 5s/epoch - 22ms/step
Epoch 26/50
224/224 - 5s - loss: 3.0765 - accuracy20: 0.4592 - val_loss: 3.2804 - val_accuracy20: 0.3685 - 5s/epoch - 23ms/step
testing model: results/LILAK/W8/deepOF_L1/h20
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.103345
{'0': {'precision': 0.3500280787869964, 'recall': 0.30792454211113757, 'f1-score': 0.3276291710469961, 'support': 54653}, '1': {'precision': 0.4557396928051738, 'recall': 0.03959891827345204, 'f1-score': 0.07286651371700004, 'support': 56946}, '2': {'precision': 0.33596682515282594, 'recall': 0.7050262565641411, 'f1-score': 0.4550759024768177, 'support': 53320}, 'accuracy': 0.34365961471995343, 'macro avg': {'precision': 0.3805781989149987, 'recall': 0.35084990564957685, 'f1-score': 0.28519052908027126, 'support': 164919}, 'weighted avg': {'precision': 0.38198381177170504, 'recall': 0.34365961471995343, 'f1-score': 0.28086527747211465, 'support': 164919}}
[[16829  1326 36498]
 [16889  2255 37802]
 [14361  1367 37592]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0921504
{'0': {'precision': 0.34563106796116505, 'recall': 0.33003125496636115, 'f1-score': 0.33765107582244863, 'support': 18877}, '1': {'precision': 0.49640287769784175, 'recall': 0.06535810135241804, 'f1-score': 0.11550802139037433, 'support': 19003}, '2': {'precision': 0.35951620389330274, 'recall': 0.6832001660267718, 'f1-score': 0.47111858464070405, 'support': 19274}, 'accuracy': 0.36112957973195225, 'macro avg': {'precision': 0.40051671651743653, 'recall': 0.35952984078185035, 'f1-score': 0.30809256061784235, 'support': 57154}, 'weighted avg': {'precision': 0.4004433087558966, 'recall': 0.36112957973195225, 'f1-score': 0.3088003969826535, 'support': 57154}}
[[ 6230   616 12031]
 [ 6333  1242 11428]
 [ 5462   644 13168]]
Evaluating performance on  val set...
68/68 - 1s - 932ms/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0883589
{'0': {'precision': 0.3757396449704142, 'recall': 0.318561872909699, 'f1-score': 0.34479638009049773, 'support': 5980}, '1': {'precision': 0.4206773618538324, 'recall': 0.04490106544901065, 'f1-score': 0.08114148186350352, 'support': 5256}, '2': {'precision': 0.3671147880041365, 'recall': 0.7101183530588432, 'f1-score': 0.48400840765778563, 'support': 5999}, 'accuracy': 0.3713954163040325, 'macro avg': {'precision': 0.38784393160946107, 'recall': 0.35786043047251764, 'f1-score': 0.30331542320392896, 'support': 17235}, 'weighted avg': {'precision': 0.38644182791201825, 'recall': 0.3713954163040325, 'f1-score': 0.31284760192369054, 'support': 17235}}
[[1905  171 3904]
 [1580  236 3440]
 [1585  154 4260]]
training model: results/LILAK/W8/deepOF_L1/h30
Epoch 1/50
224/224 - 7s - loss: 3.3085 - accuracy30: 0.3650 - val_loss: 3.3962 - val_accuracy30: 0.3488 - 7s/epoch - 32ms/step
Epoch 2/50
224/224 - 5s - loss: 3.2747 - accuracy30: 0.3824 - val_loss: 3.3800 - val_accuracy30: 0.3441 - 5s/epoch - 24ms/step
Epoch 3/50
224/224 - 5s - loss: 3.2619 - accuracy30: 0.3887 - val_loss: 3.3864 - val_accuracy30: 0.3441 - 5s/epoch - 23ms/step
Epoch 4/50
224/224 - 5s - loss: 3.2633 - accuracy30: 0.3853 - val_loss: 3.3912 - val_accuracy30: 0.3459 - 5s/epoch - 23ms/step
Epoch 5/50
224/224 - 5s - loss: 3.2492 - accuracy30: 0.3941 - val_loss: 3.3741 - val_accuracy30: 0.3490 - 5s/epoch - 23ms/step
Epoch 6/50
224/224 - 5s - loss: 3.2342 - accuracy30: 0.3945 - val_loss: 3.3584 - val_accuracy30: 0.3465 - 5s/epoch - 23ms/step
Epoch 7/50
224/224 - 5s - loss: 3.2188 - accuracy30: 0.4013 - val_loss: 3.3545 - val_accuracy30: 0.3525 - 5s/epoch - 23ms/step
Epoch 8/50
224/224 - 5s - loss: 3.2106 - accuracy30: 0.4059 - val_loss: 3.3532 - val_accuracy30: 0.3491 - 5s/epoch - 23ms/step
Epoch 9/50
224/224 - 5s - loss: 3.2087 - accuracy30: 0.4045 - val_loss: 3.3583 - val_accuracy30: 0.3509 - 5s/epoch - 22ms/step
Epoch 10/50
224/224 - 5s - loss: 3.2027 - accuracy30: 0.4080 - val_loss: 3.3463 - val_accuracy30: 0.3514 - 5s/epoch - 23ms/step
Epoch 11/50
224/224 - 5s - loss: 3.1977 - accuracy30: 0.4066 - val_loss: 3.3360 - val_accuracy30: 0.3488 - 5s/epoch - 23ms/step
Epoch 12/50
224/224 - 5s - loss: 3.1879 - accuracy30: 0.4098 - val_loss: 3.3321 - val_accuracy30: 0.3493 - 5s/epoch - 23ms/step
Epoch 13/50
224/224 - 5s - loss: 3.1878 - accuracy30: 0.4114 - val_loss: 3.3322 - val_accuracy30: 0.3536 - 5s/epoch - 23ms/step
Epoch 14/50
224/224 - 5s - loss: 3.1862 - accuracy30: 0.4135 - val_loss: 3.3305 - val_accuracy30: 0.3487 - 5s/epoch - 23ms/step
Epoch 15/50
224/224 - 5s - loss: 3.1724 - accuracy30: 0.4165 - val_loss: 3.3250 - val_accuracy30: 0.3500 - 5s/epoch - 23ms/step
Epoch 16/50
224/224 - 5s - loss: 3.1699 - accuracy30: 0.4187 - val_loss: 3.3244 - val_accuracy30: 0.3500 - 5s/epoch - 23ms/step
Epoch 17/50
224/224 - 5s - loss: 3.1639 - accuracy30: 0.4204 - val_loss: 3.3228 - val_accuracy30: 0.3518 - 5s/epoch - 23ms/step
Epoch 18/50
224/224 - 5s - loss: 3.1605 - accuracy30: 0.4233 - val_loss: 3.3185 - val_accuracy30: 0.3545 - 5s/epoch - 23ms/step
Epoch 19/50
224/224 - 5s - loss: 3.1591 - accuracy30: 0.4242 - val_loss: 3.3168 - val_accuracy30: 0.3554 - 5s/epoch - 23ms/step
Epoch 20/50
224/224 - 5s - loss: 3.1548 - accuracy30: 0.4256 - val_loss: 3.3121 - val_accuracy30: 0.3551 - 5s/epoch - 23ms/step
Epoch 21/50
224/224 - 5s - loss: 3.1471 - accuracy30: 0.4294 - val_loss: 3.3115 - val_accuracy30: 0.3558 - 5s/epoch - 23ms/step
Epoch 22/50
224/224 - 5s - loss: 3.1419 - accuracy30: 0.4327 - val_loss: 3.3143 - val_accuracy30: 0.3539 - 5s/epoch - 22ms/step
Epoch 23/50
224/224 - 5s - loss: 3.1388 - accuracy30: 0.4322 - val_loss: 3.3181 - val_accuracy30: 0.3509 - 5s/epoch - 22ms/step
Epoch 24/50
224/224 - 5s - loss: 3.1431 - accuracy30: 0.4306 - val_loss: 3.3183 - val_accuracy30: 0.3574 - 5s/epoch - 22ms/step
Epoch 25/50
224/224 - 5s - loss: 3.1369 - accuracy30: 0.4340 - val_loss: 3.3160 - val_accuracy30: 0.3568 - 5s/epoch - 22ms/step
Epoch 26/50
224/224 - 5s - loss: 3.1306 - accuracy30: 0.4370 - val_loss: 3.3113 - val_accuracy30: 0.3547 - 5s/epoch - 23ms/step
Epoch 27/50
224/224 - 5s - loss: 3.1256 - accuracy30: 0.4389 - val_loss: 3.3131 - val_accuracy30: 0.3557 - 5s/epoch - 22ms/step
Epoch 28/50
224/224 - 5s - loss: 3.1217 - accuracy30: 0.4412 - val_loss: 3.3128 - val_accuracy30: 0.3574 - 5s/epoch - 22ms/step
Epoch 29/50
224/224 - 5s - loss: 3.1202 - accuracy30: 0.4402 - val_loss: 3.3164 - val_accuracy30: 0.3534 - 5s/epoch - 22ms/step
Epoch 30/50
224/224 - 5s - loss: 3.1163 - accuracy30: 0.4417 - val_loss: 3.3257 - val_accuracy30: 0.3547 - 5s/epoch - 22ms/step
Epoch 31/50
224/224 - 5s - loss: 3.1128 - accuracy30: 0.4442 - val_loss: 3.3200 - val_accuracy30: 0.3571 - 5s/epoch - 22ms/step
Epoch 32/50
224/224 - 5s - loss: 3.1080 - accuracy30: 0.4466 - val_loss: 3.3196 - val_accuracy30: 0.3560 - 5s/epoch - 22ms/step
Epoch 33/50
224/224 - 5s - loss: 3.1043 - accuracy30: 0.4489 - val_loss: 3.3258 - val_accuracy30: 0.3585 - 5s/epoch - 22ms/step
Epoch 34/50
224/224 - 5s - loss: 3.0991 - accuracy30: 0.4499 - val_loss: 3.3208 - val_accuracy30: 0.3589 - 5s/epoch - 22ms/step
Epoch 35/50
224/224 - 5s - loss: 3.0933 - accuracy30: 0.4521 - val_loss: 3.3206 - val_accuracy30: 0.3595 - 5s/epoch - 23ms/step
Epoch 36/50
224/224 - 5s - loss: 3.0935 - accuracy30: 0.4531 - val_loss: 3.3277 - val_accuracy30: 0.3579 - 5s/epoch - 23ms/step
testing model: results/LILAK/W8/deepOF_L1/h30
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.114119
{'0': {'precision': 0.36701884637350085, 'recall': 0.2366642729566002, 'f1-score': 0.28776769022377946, 'support': 54309}, '1': {'precision': 0.4397433326649288, 'recall': 0.03796022225684167, 'f1-score': 0.06988750438191146, 'support': 57771}, '2': {'precision': 0.3251889330088382, 'recall': 0.7687503548515301, 'f1-score': 0.45704384222873573, 'support': 52839}, 'accuracy': 0.33753539616417755, 'macro avg': {'precision': 0.3773170373490893, 'recall': 0.347791616688324, 'f1-score': 0.2715663456114756, 'support': 164919}, 'weighted avg': {'precision': 0.3790921399616664, 'recall': 0.33753539616417755, 'f1-score': 0.2656794310148304, 'support': 164919}}
[[12853  1392 40064]
 [11350  2193 44228]
 [10817  1402 40620]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.090857
{'0': {'precision': 0.38352295650770596, 'recall': 0.25126876718122226, 'f1-score': 0.30361876776645697, 'support': 18916}, '1': {'precision': 0.6343264578558696, 'recall': 0.1320504664970314, 'f1-score': 0.21859505945329297, 'support': 18864}, '2': {'precision': 0.36006759073321254, 'recall': 0.758903685351502, 'f1-score': 0.48840685623173, 'support': 19374}, 'accuracy': 0.38399762046400954, 'macro avg': {'precision': 0.459305668365596, 'recall': 0.38074097300991855, 'f1-score': 0.33687356115049333, 'support': 57154}, 'weighted avg': {'precision': 0.458351192377754, 'recall': 0.38399762046400954, 'f1-score': 0.33819547617368434, 'support': 57154}}
[[ 4753   749 13414]
 [ 3656  2491 12717]
 [ 3984   687 14703]]
Evaluating performance on  val set...
68/68 - 1s - 922ms/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1022925
{'0': {'precision': 0.38673602080624186, 'recall': 0.24791597199066356, 'f1-score': 0.302143655389617, 'support': 5998}, '1': {'precision': 0.4206081081081081, 'recall': 0.04618809126321647, 'f1-score': 0.08323583486545211, 'support': 5391}, '2': {'precision': 0.34778871698702923, 'recall': 0.7613752993499829, 'f1-score': 0.477472645355074, 'support': 5846}, 'accuracy': 0.35897882216420074, 'macro avg': {'precision': 0.3850442819671264, 'recall': 0.35182645420128766, 'f1-score': 0.2876173785367144, 'support': 17235}, 'weighted avg': {'precision': 0.384120325100831, 'recall': 0.35897882216420074, 'f1-score': 0.2931411149133935, 'support': 17235}}
[[1487  186 4325]
 [1120  249 4022]
 [1238  157 4451]]
training model: results/LILAK/W8/deepOF_L1/h50
Epoch 1/50
224/224 - 7s - loss: 3.3126 - accuracy50: 0.3609 - val_loss: 3.3465 - val_accuracy50: 0.3495 - 7s/epoch - 31ms/step
Epoch 2/50
224/224 - 5s - loss: 3.2753 - accuracy50: 0.3796 - val_loss: 3.3588 - val_accuracy50: 0.3534 - 5s/epoch - 22ms/step
Epoch 3/50
224/224 - 5s - loss: 3.2740 - accuracy50: 0.3798 - val_loss: 3.3637 - val_accuracy50: 0.3511 - 5s/epoch - 23ms/step
Epoch 4/50
224/224 - 5s - loss: 3.2692 - accuracy50: 0.3825 - val_loss: 3.3653 - val_accuracy50: 0.3496 - 5s/epoch - 23ms/step
Epoch 5/50
224/224 - 5s - loss: 3.2576 - accuracy50: 0.3867 - val_loss: 3.3452 - val_accuracy50: 0.3545 - 5s/epoch - 23ms/step
Epoch 6/50
224/224 - 5s - loss: 3.2466 - accuracy50: 0.3927 - val_loss: 3.3492 - val_accuracy50: 0.3494 - 5s/epoch - 23ms/step
Epoch 7/50
224/224 - 5s - loss: 3.2352 - accuracy50: 0.3944 - val_loss: 3.3303 - val_accuracy50: 0.3556 - 5s/epoch - 23ms/step
Epoch 8/50
224/224 - 5s - loss: 3.2300 - accuracy50: 0.3959 - val_loss: 3.3343 - val_accuracy50: 0.3544 - 5s/epoch - 22ms/step
Epoch 9/50
224/224 - 5s - loss: 3.2225 - accuracy50: 0.3980 - val_loss: 3.3116 - val_accuracy50: 0.3593 - 5s/epoch - 23ms/step
Epoch 10/50
224/224 - 5s - loss: 3.2152 - accuracy50: 0.3997 - val_loss: 3.3124 - val_accuracy50: 0.3592 - 5s/epoch - 22ms/step
Epoch 11/50
224/224 - 5s - loss: 3.2171 - accuracy50: 0.4014 - val_loss: 3.3105 - val_accuracy50: 0.3584 - 5s/epoch - 23ms/step
Epoch 12/50
224/224 - 5s - loss: 3.2016 - accuracy50: 0.4048 - val_loss: 3.3151 - val_accuracy50: 0.3558 - 5s/epoch - 23ms/step
Epoch 13/50
224/224 - 5s - loss: 3.1956 - accuracy50: 0.4034 - val_loss: 3.3084 - val_accuracy50: 0.3625 - 5s/epoch - 23ms/step
Epoch 14/50
224/224 - 5s - loss: 3.1924 - accuracy50: 0.4097 - val_loss: 3.3090 - val_accuracy50: 0.3565 - 5s/epoch - 22ms/step
Epoch 15/50
224/224 - 5s - loss: 3.1876 - accuracy50: 0.4084 - val_loss: 3.3067 - val_accuracy50: 0.3612 - 5s/epoch - 22ms/step
Epoch 16/50
224/224 - 5s - loss: 3.1834 - accuracy50: 0.4098 - val_loss: 3.3097 - val_accuracy50: 0.3620 - 5s/epoch - 22ms/step
Epoch 17/50
224/224 - 5s - loss: 3.1807 - accuracy50: 0.4116 - val_loss: 3.3095 - val_accuracy50: 0.3601 - 5s/epoch - 23ms/step
Epoch 18/50
224/224 - 5s - loss: 3.1753 - accuracy50: 0.4159 - val_loss: 3.3038 - val_accuracy50: 0.3589 - 5s/epoch - 22ms/step
Epoch 19/50
224/224 - 5s - loss: 3.1735 - accuracy50: 0.4171 - val_loss: 3.3027 - val_accuracy50: 0.3619 - 5s/epoch - 23ms/step
Epoch 20/50
224/224 - 5s - loss: 3.1695 - accuracy50: 0.4160 - val_loss: 3.3090 - val_accuracy50: 0.3558 - 5s/epoch - 22ms/step
Epoch 21/50
224/224 - 5s - loss: 3.1669 - accuracy50: 0.4180 - val_loss: 3.3087 - val_accuracy50: 0.3614 - 5s/epoch - 23ms/step
Epoch 22/50
224/224 - 5s - loss: 3.1618 - accuracy50: 0.4193 - val_loss: 3.3028 - val_accuracy50: 0.3616 - 5s/epoch - 22ms/step
Epoch 23/50
224/224 - 5s - loss: 3.1575 - accuracy50: 0.4216 - val_loss: 3.3033 - val_accuracy50: 0.3628 - 5s/epoch - 22ms/step
Epoch 24/50
224/224 - 5s - loss: 3.1547 - accuracy50: 0.4220 - val_loss: 3.3009 - val_accuracy50: 0.3639 - 5s/epoch - 23ms/step
Epoch 25/50
224/224 - 5s - loss: 3.1523 - accuracy50: 0.4246 - val_loss: 3.3092 - val_accuracy50: 0.3554 - 5s/epoch - 22ms/step
Epoch 26/50
224/224 - 5s - loss: 3.1477 - accuracy50: 0.4261 - val_loss: 3.3094 - val_accuracy50: 0.3579 - 5s/epoch - 22ms/step
Epoch 27/50
224/224 - 5s - loss: 3.1455 - accuracy50: 0.4267 - val_loss: 3.3002 - val_accuracy50: 0.3650 - 5s/epoch - 22ms/step
Epoch 28/50
224/224 - 5s - loss: 3.1418 - accuracy50: 0.4281 - val_loss: 3.3081 - val_accuracy50: 0.3611 - 5s/epoch - 22ms/step
Epoch 29/50
224/224 - 5s - loss: 3.1389 - accuracy50: 0.4329 - val_loss: 3.3097 - val_accuracy50: 0.3601 - 5s/epoch - 22ms/step
Epoch 30/50
224/224 - 5s - loss: 3.1364 - accuracy50: 0.4337 - val_loss: 3.3150 - val_accuracy50: 0.3590 - 5s/epoch - 22ms/step
Epoch 31/50
224/224 - 5s - loss: 3.1325 - accuracy50: 0.4307 - val_loss: 3.3135 - val_accuracy50: 0.3640 - 5s/epoch - 22ms/step
Epoch 32/50
224/224 - 5s - loss: 3.1306 - accuracy50: 0.4352 - val_loss: 3.3172 - val_accuracy50: 0.3589 - 5s/epoch - 22ms/step
Epoch 33/50
224/224 - 5s - loss: 3.1272 - accuracy50: 0.4379 - val_loss: 3.3164 - val_accuracy50: 0.3604 - 5s/epoch - 23ms/step
Epoch 34/50
224/224 - 5s - loss: 3.1236 - accuracy50: 0.4381 - val_loss: 3.3145 - val_accuracy50: 0.3613 - 5s/epoch - 22ms/step
Epoch 35/50
224/224 - 5s - loss: 3.1187 - accuracy50: 0.4390 - val_loss: 3.3192 - val_accuracy50: 0.3588 - 5s/epoch - 23ms/step
Epoch 36/50
224/224 - 5s - loss: 3.1167 - accuracy50: 0.4441 - val_loss: 3.3198 - val_accuracy50: 0.3600 - 5s/epoch - 22ms/step
Epoch 37/50
224/224 - 5s - loss: 3.1132 - accuracy50: 0.4451 - val_loss: 3.3170 - val_accuracy50: 0.3636 - 5s/epoch - 22ms/step
testing model: results/LILAK/W8/deepOF_L1/h50
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1100386
{'0': {'precision': 0.3748214758000529, 'recall': 0.2528276304991615, 'f1-score': 0.30196880593198666, 'support': 56054}, '1': {'precision': 0.34974358974358977, 'recall': 0.031182559713230185, 'f1-score': 0.05725991973536178, 'support': 54678}, '2': {'precision': 0.3377129113012746, 'recall': 0.7618063373133778, 'f1-score': 0.4679714999914977, 'support': 54187}, 'accuracy': 0.34657619801235756, 'macro avg': {'precision': 0.35409265894830577, 'recall': 0.3486055091752565, 'f1-score': 0.2757334085529487, 'support': 164919}, 'weighted avg': {'precision': 0.354314375718858, 'recall': 0.34657619801235756, 'f1-score': 0.2753799684029189, 'support': 164919}}
[[14172  1581 40301]
 [12320  1705 40653]
 [11318  1589 41280]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0996648
{'0': {'precision': 0.364960314570742, 'recall': 0.2659309173873826, 'f1-score': 0.30767341927562925, 'support': 18847}, '1': {'precision': 0.44988558352402747, 'recall': 0.05174773636555064, 'f1-score': 0.09281903592842641, 'support': 18996}, '2': {'precision': 0.35323503734600836, 'recall': 0.7542851224690591, 'f1-score': 0.48114687763225267, 'support': 19311}, 'accuracy': 0.35974734926689295, 'macro avg': {'precision': 0.38936031181359265, 'recall': 0.35732125874066406, 'f1-score': 0.29387977761210277, 'support': 57154}, 'weighted avg': {'precision': 0.38922482065167735, 'recall': 0.35974734926689295, 'f1-score': 0.2948759263313259, 'support': 57154}}
[[ 5012   619 13216]
 [ 4559   983 13454]
 [ 4162   583 14566]]
Evaluating performance on  val set...
68/68 - 1s - 914ms/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0999558
{'0': {'precision': 0.3926014319809069, 'recall': 0.2703368940016434, 'f1-score': 0.32019464720194646, 'support': 6085}, '1': {'precision': 0.2796610169491525, 'recall': 0.03136882129277566, 'f1-score': 0.056410256410256404, 'support': 5260}, '2': {'precision': 0.3555198715375351, 'recall': 0.7517826825127334, 'f1-score': 0.48274734260016355, 'support': 5890}, 'accuracy': 0.36193791702930084, 'macro avg': {'precision': 0.34259410682253155, 'recall': 0.35116279926905086, 'f1-score': 0.28645074873745546, 'support': 17235}, 'weighted avg': {'precision': 0.3454603252748734, 'recall': 0.36193791702930084, 'f1-score': 0.2952413243316946, 'support': 17235}}
[[1645  205 4235]
 [1303  165 3792]
 [1242  220 4428]]
training model: results/LILAK/W8/deepOF_L1/h100
Epoch 1/50
224/224 - 7s - loss: 3.3274 - accuracy100: 0.3544 - val_loss: 3.3373 - val_accuracy100: 0.3438 - 7s/epoch - 33ms/step
Epoch 2/50
224/224 - 5s - loss: 3.2932 - accuracy100: 0.3699 - val_loss: 3.3128 - val_accuracy100: 0.3449 - 5s/epoch - 24ms/step
Epoch 3/50
224/224 - 5s - loss: 3.2923 - accuracy100: 0.3679 - val_loss: 3.3275 - val_accuracy100: 0.3455 - 5s/epoch - 22ms/step
Epoch 4/50
224/224 - 5s - loss: 3.2760 - accuracy100: 0.3759 - val_loss: 3.3166 - val_accuracy100: 0.3419 - 5s/epoch - 23ms/step
Epoch 5/50
224/224 - 5s - loss: 3.2643 - accuracy100: 0.3798 - val_loss: 3.3156 - val_accuracy100: 0.3413 - 5s/epoch - 23ms/step
Epoch 6/50
224/224 - 5s - loss: 3.2578 - accuracy100: 0.3819 - val_loss: 3.3113 - val_accuracy100: 0.3484 - 5s/epoch - 23ms/step
Epoch 7/50
224/224 - 5s - loss: 3.2443 - accuracy100: 0.3818 - val_loss: 3.3136 - val_accuracy100: 0.3431 - 5s/epoch - 23ms/step
Epoch 8/50
224/224 - 5s - loss: 3.2382 - accuracy100: 0.3856 - val_loss: 3.3122 - val_accuracy100: 0.3430 - 5s/epoch - 22ms/step
Epoch 9/50
224/224 - 5s - loss: 3.2321 - accuracy100: 0.3852 - val_loss: 3.3061 - val_accuracy100: 0.3456 - 5s/epoch - 22ms/step
Epoch 10/50
224/224 - 5s - loss: 3.2249 - accuracy100: 0.3883 - val_loss: 3.3040 - val_accuracy100: 0.3445 - 5s/epoch - 23ms/step
Epoch 11/50
224/224 - 5s - loss: 3.2195 - accuracy100: 0.3925 - val_loss: 3.3072 - val_accuracy100: 0.3433 - 5s/epoch - 23ms/step
Epoch 12/50
224/224 - 5s - loss: 3.2164 - accuracy100: 0.3945 - val_loss: 3.3108 - val_accuracy100: 0.3383 - 5s/epoch - 23ms/step
Epoch 13/50
224/224 - 5s - loss: 3.2113 - accuracy100: 0.3940 - val_loss: 3.3096 - val_accuracy100: 0.3386 - 5s/epoch - 22ms/step
Epoch 14/50
224/224 - 5s - loss: 3.2083 - accuracy100: 0.3975 - val_loss: 3.3131 - val_accuracy100: 0.3411 - 5s/epoch - 23ms/step
Epoch 15/50
224/224 - 5s - loss: 3.2059 - accuracy100: 0.3978 - val_loss: 3.3127 - val_accuracy100: 0.3349 - 5s/epoch - 22ms/step
Epoch 16/50
224/224 - 5s - loss: 3.2047 - accuracy100: 0.3948 - val_loss: 3.3115 - val_accuracy100: 0.3340 - 5s/epoch - 23ms/step
Epoch 17/50
224/224 - 5s - loss: 3.2011 - accuracy100: 0.3988 - val_loss: 3.3092 - val_accuracy100: 0.3349 - 5s/epoch - 22ms/step
Epoch 18/50
224/224 - 5s - loss: 3.1987 - accuracy100: 0.4003 - val_loss: 3.3099 - val_accuracy100: 0.3371 - 5s/epoch - 22ms/step
Epoch 19/50
224/224 - 5s - loss: 3.1966 - accuracy100: 0.4021 - val_loss: 3.3159 - val_accuracy100: 0.3325 - 5s/epoch - 22ms/step
Epoch 20/50
224/224 - 5s - loss: 3.1935 - accuracy100: 0.4041 - val_loss: 3.3121 - val_accuracy100: 0.3377 - 5s/epoch - 22ms/step
testing model: results/LILAK/W8/deepOF_L1/h100
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1044486
{'0': {'precision': 0.3725334330870663, 'recall': 0.1411312465678199, 'f1-score': 0.20470984236288653, 'support': 56451}, '1': {'precision': 0.31029777670760095, 'recall': 0.07246213825161194, 'f1-score': 0.11748795794016197, 'support': 53352}, '2': {'precision': 0.3372522391931275, 'recall': 0.8020357065099064, 'f1-score': 0.4748375315537891, 'support': 55116}, 'accuracy': 0.3397910489391762, 'macro avg': {'precision': 0.34002781632926493, 'recall': 0.33854303044311274, 'f1-score': 0.2656784439522792, 'support': 164919}, 'weighted avg': {'precision': 0.34060894275050374, 'recall': 0.3397910489391762, 'f1-score': 0.2667699793981862, 'support': 164919}}
[[ 7967  4469 44015]
 [ 6632  3866 42854]
 [ 6787  4124 44205]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1015798
{'0': {'precision': 0.35917486854523395, 'recall': 0.13941074886179286, 'f1-score': 0.20085953404207194, 'support': 19109}, '1': {'precision': 0.3424108085286046, 'recall': 0.08582464680670936, 'f1-score': 0.13724826535792858, 'support': 18899}, '2': {'precision': 0.34124444444444446, 'recall': 0.8020474250496187, 'f1-score': 0.47878277679044684, 'support': 19146}, 'accuracy': 0.3436679847429751, 'macro avg': {'precision': 0.3476100405060943, 'recall': 0.3424276069060403, 'f1-score': 0.27229685873014914, 'support': 57154}, 'weighted avg': {'precision': 0.34762502303856785, 'recall': 0.3436679847429751, 'f1-score': 0.2729267391160608, 'support': 57154}}
[[ 2664  1608 14837]
 [ 2470  1622 14807]
 [ 2283  1507 15356]]
Evaluating performance on  val set...
68/68 - 1s - 921ms/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1020194
{'0': {'precision': 0.37543859649122807, 'recall': 0.14125412541254126, 'f1-score': 0.2052757793764988, 'support': 6060}, '1': {'precision': 0.31890660592255127, 'recall': 0.0782851817334576, 'f1-score': 0.1257108650104759, 'support': 5365}, '2': {'precision': 0.3446253116292712, 'recall': 0.8089500860585198, 'f1-score': 0.4833401892225422, 'support': 5810}, 'accuracy': 0.3467362924281984, 'macro avg': {'precision': 0.34632350468101686, 'recall': 0.34282979773483957, 'f1-score': 0.27144227786983893, 'support': 17235}, 'weighted avg': {'precision': 0.3474537218495733, 'recall': 0.3467362924281984, 'f1-score': 0.2742452284993186, 'support': 17235}}
[[ 856  496 4708]
 [ 715  420 4230]
 [ 709  401 4700]]
training model: results/LILAK/W8/deepOF_L1/h200
Epoch 1/50
224/224 - 7s - loss: 3.3187 - accuracy200: 0.3605 - val_loss: 3.3459 - val_accuracy200: 0.3457 - 7s/epoch - 33ms/step
Epoch 2/50
224/224 - 5s - loss: 3.2904 - accuracy200: 0.3678 - val_loss: 3.3623 - val_accuracy200: 0.3415 - 5s/epoch - 22ms/step
Epoch 3/50
224/224 - 5s - loss: 3.2753 - accuracy200: 0.3709 - val_loss: 3.3586 - val_accuracy200: 0.3471 - 5s/epoch - 22ms/step
Epoch 4/50
224/224 - 5s - loss: 3.2735 - accuracy200: 0.3751 - val_loss: 3.3875 - val_accuracy200: 0.3399 - 5s/epoch - 22ms/step
Epoch 5/50
224/224 - 5s - loss: 3.2707 - accuracy200: 0.3786 - val_loss: 3.3909 - val_accuracy200: 0.3449 - 5s/epoch - 22ms/step
Epoch 6/50
224/224 - 5s - loss: 3.2623 - accuracy200: 0.3815 - val_loss: 3.3664 - val_accuracy200: 0.3453 - 5s/epoch - 22ms/step
Epoch 7/50
224/224 - 5s - loss: 3.2580 - accuracy200: 0.3852 - val_loss: 3.3847 - val_accuracy200: 0.3433 - 5s/epoch - 23ms/step
Epoch 8/50
224/224 - 5s - loss: 3.2487 - accuracy200: 0.3820 - val_loss: 3.3916 - val_accuracy200: 0.3448 - 5s/epoch - 22ms/step
Epoch 9/50
224/224 - 5s - loss: 3.2502 - accuracy200: 0.3848 - val_loss: 3.3728 - val_accuracy200: 0.3430 - 5s/epoch - 22ms/step
Epoch 10/50
224/224 - 5s - loss: 3.2447 - accuracy200: 0.3876 - val_loss: 3.3945 - val_accuracy200: 0.3440 - 5s/epoch - 22ms/step
Epoch 11/50
224/224 - 5s - loss: 3.2329 - accuracy200: 0.3915 - val_loss: 3.3798 - val_accuracy200: 0.3443 - 5s/epoch - 22ms/step
testing model: results/LILAK/W8/deepOF_L1/h200
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1227804
{'0': {'precision': 0.3254307747921436, 'recall': 0.19633607764025954, 'f1-score': 0.24491322730930976, 'support': 55023}, '1': {'precision': 0.34447539461467036, 'recall': 0.006795120700391955, 'f1-score': 0.013327346205657837, 'support': 54598}, '2': {'precision': 0.33407069485479846, 'recall': 0.7892690513219285, 'f1-score': 0.46944241276943593, 'support': 55298}, 'accuracy': 0.3323995415931457, 'macro avg': {'precision': 0.3346589547538708, 'recall': 0.33080008322086, 'f1-score': 0.2425609954281345, 'support': 164919}, 'weighted avg': {'precision': 0.3346326766512078, 'recall': 0.3323995415931457, 'f1-score': 0.24353005715351736, 'support': 164919}}
[[10803   341 43879]
 [11105   371 43122]
 [11288   365 43645]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1220398
{'0': {'precision': 0.34140604582280687, 'recall': 0.20501150868382506, 'f1-score': 0.2561856512502043, 'support': 19116}, '1': {'precision': 0.3118466898954704, 'recall': 0.009511158342189161, 'f1-score': 0.01845931731463339, 'support': 18820}, '2': {'precision': 0.3368883173322099, 'recall': 0.7906129670100948, 'f1-score': 0.47245759417901395, 'support': 19218}, 'accuracy': 0.3375441788851174, 'macro avg': {'precision': 0.3300470176834957, 'recall': 0.3350452113453697, 'f1-score': 0.2490341875812839, 'support': 57154}, 'weighted avg': {'precision': 0.3301534863399227, 'recall': 0.3375441788851174, 'f1-score': 0.2506270655788326, 'support': 57154}}
[[ 3919   214 14983]
 [ 3717   179 14924]
 [ 3843   181 15194]]
Evaluating performance on  val set...
68/68 - 1s - 966ms/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1125492
{'0': {'precision': 0.35823039356506753, 'recall': 0.20306139065298812, 'f1-score': 0.2591976720016629, 'support': 6141}, '1': {'precision': 0.2638888888888889, 'recall': 0.007261609019682782, 'f1-score': 0.014134275618374558, 'support': 5233}, '2': {'precision': 0.3435709037472447, 'recall': 0.7978160723426037, 'f1-score': 0.48030404190847936, 'support': 5861}, 'accuracy': 0.34586597040905137, 'macro avg': {'precision': 0.3218967287337337, 'recall': 0.33604635733842486, 'f1-score': 0.2512119965095056, 'support': 17235}, 'weighted avg': {'precision': 0.324600665465694, 'recall': 0.34586597040905137, 'f1-score': 0.2599802470379323, 'support': 17235}}
[[1247   58 4836]
 [1097   38 4098]
 [1137   48 4676]]
training model: results/LILAK/W8/deepOF_L1/h300
Epoch 1/50
224/224 - 7s - loss: 3.3225 - accuracy300: 0.3597 - val_loss: 3.3490 - val_accuracy300: 0.3380 - 7s/epoch - 32ms/step
Epoch 2/50
224/224 - 5s - loss: 3.2982 - accuracy300: 0.3683 - val_loss: 3.3527 - val_accuracy300: 0.3364 - 5s/epoch - 23ms/step
Epoch 3/50
224/224 - 5s - loss: 3.2814 - accuracy300: 0.3724 - val_loss: 3.3359 - val_accuracy300: 0.3351 - 5s/epoch - 23ms/step
Epoch 4/50
224/224 - 5s - loss: 3.2764 - accuracy300: 0.3755 - val_loss: 3.3568 - val_accuracy300: 0.3369 - 5s/epoch - 24ms/step
Epoch 5/50
224/224 - 5s - loss: 3.2731 - accuracy300: 0.3773 - val_loss: 3.3431 - val_accuracy300: 0.3374 - 5s/epoch - 23ms/step
Epoch 6/50
224/224 - 5s - loss: 3.2625 - accuracy300: 0.3790 - val_loss: 3.3367 - val_accuracy300: 0.3387 - 5s/epoch - 23ms/step
Epoch 7/50
224/224 - 5s - loss: 3.2542 - accuracy300: 0.3817 - val_loss: 3.3467 - val_accuracy300: 0.3347 - 5s/epoch - 22ms/step
Epoch 8/50
224/224 - 5s - loss: 3.2440 - accuracy300: 0.3834 - val_loss: 3.3330 - val_accuracy300: 0.3357 - 5s/epoch - 23ms/step
Epoch 9/50
224/224 - 5s - loss: 3.2381 - accuracy300: 0.3841 - val_loss: 3.3354 - val_accuracy300: 0.3374 - 5s/epoch - 22ms/step
Epoch 10/50
224/224 - 5s - loss: 3.2288 - accuracy300: 0.3853 - val_loss: 3.3380 - val_accuracy300: 0.3340 - 5s/epoch - 22ms/step
Epoch 11/50
224/224 - 5s - loss: 3.2196 - accuracy300: 0.3904 - val_loss: 3.3395 - val_accuracy300: 0.3345 - 5s/epoch - 23ms/step
Epoch 12/50
224/224 - 5s - loss: 3.2177 - accuracy300: 0.3892 - val_loss: 3.3391 - val_accuracy300: 0.3364 - 5s/epoch - 22ms/step
Epoch 13/50
224/224 - 5s - loss: 3.2134 - accuracy300: 0.3909 - val_loss: 3.3396 - val_accuracy300: 0.3365 - 5s/epoch - 22ms/step
Epoch 14/50
224/224 - 5s - loss: 3.2113 - accuracy300: 0.3936 - val_loss: 3.3387 - val_accuracy300: 0.3350 - 5s/epoch - 22ms/step
Epoch 15/50
224/224 - 5s - loss: 3.2084 - accuracy300: 0.3918 - val_loss: 3.3392 - val_accuracy300: 0.3351 - 5s/epoch - 22ms/step
Epoch 16/50
224/224 - 5s - loss: 3.2072 - accuracy300: 0.3935 - val_loss: 3.3350 - val_accuracy300: 0.3340 - 5s/epoch - 23ms/step
Epoch 17/50
224/224 - 5s - loss: 3.2027 - accuracy300: 0.3933 - val_loss: 3.3342 - val_accuracy300: 0.3344 - 5s/epoch - 23ms/step
Epoch 18/50
224/224 - 5s - loss: 3.2002 - accuracy300: 0.3957 - val_loss: 3.3427 - val_accuracy300: 0.3312 - 5s/epoch - 22ms/step
testing model: results/LILAK/W8/deepOF_L1/h300
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1069093
{'0': {'precision': 0.34348756792359625, 'recall': 0.03685447253582092, 'f1-score': 0.0665666783674251, 'support': 56601}, '1': {'precision': 0.3157684630738523, 'recall': 0.015596655887688304, 'f1-score': 0.029725108509798762, 'support': 50716}, '2': {'precision': 0.3490575089068127, 'recall': 0.947397659803479, 'f1-score': 0.5101545738818284, 'support': 57602}, 'accuracy': 0.34834676416907695, 'macro avg': {'precision': 0.33610451330142044, 'recall': 0.33328292940899606, 'f1-score': 0.20214878691968408, 'support': 164919}, 'weighted avg': {'precision': 0.3369088087688331, 'recall': 0.34834676416907695, 'f1-score': 0.21017107143627273, 'support': 164919}}
[[ 2086   833 53682]
 [ 1838   791 48087]
 [ 2149   881 54572]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1087848
{'0': {'precision': 0.3616951379763469, 'recall': 0.05765303450803791, 'f1-score': 0.09945350255182692, 'support': 19097}, '1': {'precision': 0.40869565217391307, 'recall': 0.02253236030469291, 'f1-score': 0.042710016155088855, 'support': 18773}, '2': {'precision': 0.33997173810645315, 'recall': 0.9356979879693009, 'f1-score': 0.498735471745049, 'support': 19284}, 'accuracy': 0.34237323721874235, 'macro avg': {'precision': 0.3701208427522377, 'recall': 0.33862779426067724, 'f1-score': 0.2136329968173216, 'support': 57154}, 'weighted avg': {'precision': 0.36980352251530973, 'recall': 0.34237323721874235, 'f1-score': 0.2155347571236177, 'support': 57154}}
[[ 1101   325 17671]
 [  990   423 17360]
 [  953   287 18044]]
Evaluating performance on  val set...
68/68 - 1s - 943ms/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.109297
{'0': {'precision': 0.39666238767650835, 'recall': 0.05019493177387914, 'f1-score': 0.08911319394376352, 'support': 6156}, '1': {'precision': 0.3347457627118644, 'recall': 0.014810648668916385, 'f1-score': 0.02836624775583483, 'support': 5334}, '2': {'precision': 0.3323057953144266, 'recall': 0.938207136640557, 'f1-score': 0.4907807876166629, 'support': 5745}, 'accuracy': 0.3352480417754569, 'macro avg': {'precision': 0.35457131523426644, 'recall': 0.33440423902778416, 'f1-score': 0.20275340977208708, 'support': 17235}, 'weighted avg': {'precision': 0.35604783005065566, 'recall': 0.3352480417754569, 'f1-score': 0.2042020314653414, 'support': 17235}}
[[ 309   79 5768]
 [ 193   79 5062]
 [ 277   78 5390]]
training model: results/LILAK/W8/deepOF_L1/h500
Epoch 1/50
224/224 - 7s - loss: 3.3096 - accuracy500: 0.3713 - val_loss: 3.4474 - val_accuracy500: 0.3289 - 7s/epoch - 32ms/step
Epoch 2/50
224/224 - 5s - loss: 3.2824 - accuracy500: 0.3729 - val_loss: 3.4128 - val_accuracy500: 0.3313 - 5s/epoch - 22ms/step
Epoch 3/50
224/224 - 5s - loss: 3.2731 - accuracy500: 0.3799 - val_loss: 3.4055 - val_accuracy500: 0.3293 - 5s/epoch - 22ms/step
Epoch 4/50
224/224 - 5s - loss: 3.2682 - accuracy500: 0.3793 - val_loss: 3.4242 - val_accuracy500: 0.3289 - 5s/epoch - 22ms/step
Epoch 5/50
224/224 - 5s - loss: 3.2673 - accuracy500: 0.3822 - val_loss: 3.4559 - val_accuracy500: 0.3280 - 5s/epoch - 23ms/step
Epoch 6/50
224/224 - 5s - loss: 3.2638 - accuracy500: 0.3822 - val_loss: 3.4048 - val_accuracy500: 0.3283 - 5s/epoch - 23ms/step
Epoch 7/50
224/224 - 5s - loss: 3.2502 - accuracy500: 0.3862 - val_loss: 3.4226 - val_accuracy500: 0.3275 - 5s/epoch - 23ms/step
Epoch 8/50
224/224 - 5s - loss: 3.2460 - accuracy500: 0.3847 - val_loss: 3.4215 - val_accuracy500: 0.3282 - 5s/epoch - 22ms/step
Epoch 9/50
224/224 - 5s - loss: 3.2332 - accuracy500: 0.3873 - val_loss: 3.4185 - val_accuracy500: 0.3283 - 5s/epoch - 22ms/step
Epoch 10/50
224/224 - 5s - loss: 3.2325 - accuracy500: 0.3884 - val_loss: 3.3958 - val_accuracy500: 0.3284 - 5s/epoch - 22ms/step
Epoch 11/50
224/224 - 5s - loss: 3.2484 - accuracy500: 0.3841 - val_loss: 3.4080 - val_accuracy500: 0.3286 - 5s/epoch - 22ms/step
Epoch 12/50
224/224 - 5s - loss: 3.2384 - accuracy500: 0.3844 - val_loss: 3.3775 - val_accuracy500: 0.3293 - 5s/epoch - 22ms/step
Epoch 13/50
224/224 - 5s - loss: 3.2315 - accuracy500: 0.3857 - val_loss: 3.3820 - val_accuracy500: 0.3300 - 5s/epoch - 22ms/step
Epoch 14/50
224/224 - 5s - loss: 3.2219 - accuracy500: 0.3889 - val_loss: 3.3817 - val_accuracy500: 0.3287 - 5s/epoch - 22ms/step
Epoch 15/50
224/224 - 5s - loss: 3.2189 - accuracy500: 0.3880 - val_loss: 3.3879 - val_accuracy500: 0.3290 - 5s/epoch - 22ms/step
Epoch 16/50
224/224 - 5s - loss: 3.2146 - accuracy500: 0.3909 - val_loss: 3.3944 - val_accuracy500: 0.3295 - 5s/epoch - 22ms/step
Epoch 17/50
224/224 - 5s - loss: 3.2073 - accuracy500: 0.3911 - val_loss: 3.3942 - val_accuracy500: 0.3289 - 5s/epoch - 22ms/step
Epoch 18/50
224/224 - 5s - loss: 3.2040 - accuracy500: 0.3913 - val_loss: 3.3999 - val_accuracy500: 0.3281 - 5s/epoch - 22ms/step
Epoch 19/50
224/224 - 5s - loss: 3.1970 - accuracy500: 0.3937 - val_loss: 3.4023 - val_accuracy500: 0.3282 - 5s/epoch - 23ms/step
Epoch 20/50
224/224 - 5s - loss: 3.1999 - accuracy500: 0.3937 - val_loss: 3.4006 - val_accuracy500: 0.3282 - 5s/epoch - 22ms/step
Epoch 21/50
224/224 - 5s - loss: 3.1951 - accuracy500: 0.3966 - val_loss: 3.4008 - val_accuracy500: 0.3275 - 5s/epoch - 23ms/step
Epoch 22/50
224/224 - 5s - loss: 3.1901 - accuracy500: 0.3956 - val_loss: 3.4033 - val_accuracy500: 0.3279 - 5s/epoch - 22ms/step
testing model: results/LILAK/W8/deepOF_L1/h500
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0903599
{'0': {'precision': 0.40290955091714103, 'recall': 0.010036711992058866, 'f1-score': 0.01958553683433772, 'support': 63467}, '1': {'precision': 0.24279835390946503, 'recall': 0.0030882776309246514, 'f1-score': 0.00609897919627859, 'support': 38209}, '2': {'precision': 0.3834831626261882, 'recall': 0.9874768749110574, 'f1-score': 0.552431500033172, 'support': 63243}, 'accuracy': 0.3832548099369994, 'macro avg': {'precision': 0.3430636891509315, 'recall': 0.3335339548446803, 'f1-score': 0.1927053386879294, 'support': 164919}, 'weighted avg': {'precision': 0.3583648241048816, 'recall': 0.3832548099369994, 'f1-score': 0.22079624857641275, 'support': 164919}}
[[  637   136 62694]
 [  384   118 37707]
 [  560   232 62451]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1277465
{'0': {'precision': 0.38557993730407525, 'recall': 0.026055181909654185, 'f1-score': 0.0488119450369562, 'support': 18883}, '1': {'precision': 0.44755244755244755, 'recall': 0.013555732062483453, 'f1-score': 0.026314436963560676, 'support': 18885}, '2': {'precision': 0.34007160163454236, 'recall': 0.9701846693490147, 'f1-score': 0.5036148449633161, 'support': 19386}, 'accuracy': 0.34216327816075864, 'macro avg': {'precision': 0.39106799549702176, 'recall': 0.3365985277737174, 'f1-score': 0.19291374232127767, 'support': 57154}, 'weighted avg': {'precision': 0.3906211638280446, 'recall': 0.34216327816075864, 'f1-score': 0.1956423257278324, 'support': 57154}}
[[  492   162 18229]
 [  360   256 18269]
 [  424   154 18808]]
Evaluating performance on  val set...
68/68 - 1s - 926ms/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1234663
{'0': {'precision': 0.3765432098765432, 'recall': 0.018462469733656173, 'f1-score': 0.03519907674552798, 'support': 6608}, '1': {'precision': 0.2087912087912088, 'recall': 0.0038099057549629035, 'f1-score': 0.007483261126427728, 'support': 4987}, '2': {'precision': 0.32717003567181924, 'recall': 0.9757092198581561, 'f1-score': 0.49002671415850396, 'support': 5640}, 'accuracy': 0.3274731650710763, 'macro avg': {'precision': 0.30416815144652376, 'recall': 0.33266053178225835, 'f1-score': 0.17756968401015324, 'support': 17235}, 'weighted avg': {'precision': 0.3118467241250372, 'recall': 0.3274731650710763, 'f1-score': 0.17601770758490898, 'support': 17235}}
[[ 122   39 6447]
 [  98   19 4870]
 [ 104   33 5503]]
training model: results/LILAK/W8/deepOF_L1/h1000
Epoch 1/50
224/224 - 7s - loss: 3.3113 - accuracy1000: 0.3749 - val_loss: 3.3947 - val_accuracy1000: 0.3294 - 7s/epoch - 33ms/step
Epoch 2/50
224/224 - 5s - loss: 3.2909 - accuracy1000: 0.3783 - val_loss: 3.4393 - val_accuracy1000: 0.3249 - 5s/epoch - 22ms/step
Epoch 3/50
224/224 - 5s - loss: 3.2836 - accuracy1000: 0.3821 - val_loss: 3.3819 - val_accuracy1000: 0.3279 - 5s/epoch - 22ms/step
Epoch 4/50
224/224 - 5s - loss: 3.2705 - accuracy1000: 0.3823 - val_loss: 3.4021 - val_accuracy1000: 0.3259 - 5s/epoch - 22ms/step
Epoch 5/50
224/224 - 5s - loss: 3.2642 - accuracy1000: 0.3844 - val_loss: 3.3940 - val_accuracy1000: 0.3268 - 5s/epoch - 22ms/step
Epoch 6/50
224/224 - 5s - loss: 3.2577 - accuracy1000: 0.3821 - val_loss: 3.4119 - val_accuracy1000: 0.3251 - 5s/epoch - 22ms/step
Epoch 7/50
224/224 - 5s - loss: 3.2632 - accuracy1000: 0.3813 - val_loss: 3.3773 - val_accuracy1000: 0.3261 - 5s/epoch - 23ms/step
Epoch 8/50
224/224 - 5s - loss: 3.2528 - accuracy1000: 0.3864 - val_loss: 3.3834 - val_accuracy1000: 0.3250 - 5s/epoch - 22ms/step
Epoch 9/50
224/224 - 5s - loss: 3.2450 - accuracy1000: 0.3834 - val_loss: 3.3829 - val_accuracy1000: 0.3253 - 5s/epoch - 22ms/step
Epoch 10/50
224/224 - 5s - loss: 3.2425 - accuracy1000: 0.3841 - val_loss: 3.3778 - val_accuracy1000: 0.3235 - 5s/epoch - 22ms/step
Epoch 11/50
224/224 - 5s - loss: 3.2378 - accuracy1000: 0.3852 - val_loss: 3.3731 - val_accuracy1000: 0.3235 - 5s/epoch - 22ms/step
Epoch 12/50
224/224 - 5s - loss: 3.2326 - accuracy1000: 0.3852 - val_loss: 3.3970 - val_accuracy1000: 0.3233 - 5s/epoch - 23ms/step
Epoch 13/50
224/224 - 5s - loss: 3.2297 - accuracy1000: 0.3874 - val_loss: 3.3815 - val_accuracy1000: 0.3247 - 5s/epoch - 23ms/step
Epoch 14/50
224/224 - 5s - loss: 3.2264 - accuracy1000: 0.3891 - val_loss: 3.3870 - val_accuracy1000: 0.3238 - 5s/epoch - 22ms/step
Epoch 15/50
224/224 - 5s - loss: 3.2246 - accuracy1000: 0.3906 - val_loss: 3.3882 - val_accuracy1000: 0.3238 - 5s/epoch - 22ms/step
Epoch 16/50
224/224 - 5s - loss: 3.2199 - accuracy1000: 0.3904 - val_loss: 3.3922 - val_accuracy1000: 0.3239 - 5s/epoch - 23ms/step
Epoch 17/50
224/224 - 5s - loss: 3.2188 - accuracy1000: 0.3902 - val_loss: 3.3988 - val_accuracy1000: 0.3238 - 5s/epoch - 23ms/step
Epoch 18/50
224/224 - 5s - loss: 3.2154 - accuracy1000: 0.3929 - val_loss: 3.4164 - val_accuracy1000: 0.3234 - 5s/epoch - 22ms/step
Epoch 19/50
224/224 - 5s - loss: 3.2126 - accuracy1000: 0.3949 - val_loss: 3.4240 - val_accuracy1000: 0.3231 - 5s/epoch - 22ms/step
Epoch 20/50
224/224 - 5s - loss: 3.2114 - accuracy1000: 0.3971 - val_loss: 3.4327 - val_accuracy1000: 0.3224 - 5s/epoch - 22ms/step
Epoch 21/50
224/224 - 5s - loss: 3.2072 - accuracy1000: 0.3973 - val_loss: 3.4345 - val_accuracy1000: 0.3224 - 5s/epoch - 23ms/step
testing model: results/LILAK/W8/deepOF_L1/h1000
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1131282
{'0': {'precision': 0.39922265408106605, 'recall': 0.011872523117569353, 'f1-score': 0.02305928384727634, 'support': 60560}, '1': {'precision': 0.2460881934566145, 'recall': 0.007346540119328195, 'f1-score': 0.014267158732449539, 'support': 47097}, '2': {'precision': 0.34676461858118135, 'recall': 0.9792881841360763, 'f1-score': 0.5121703946587266, 'support': 57262}, 'accuracy': 0.3464791806887017, 'macro avg': {'precision': 0.3306918220396206, 'recall': 0.3328357491243246, 'f1-score': 0.18316561241281748, 'support': 164919}, 'weighted avg': {'precision': 0.3372769369664571, 'recall': 0.3464791806887017, 'f1-score': 0.19037413362657568, 'support': 164919}}
[[  719   501 59340]
 [  455   346 46296]
 [  627   559 56076]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1268007
{'0': {'precision': 0.3483348334833483, 'recall': 0.021002930641484858, 'f1-score': 0.039617136714951116, 'support': 18426}, '1': {'precision': 0.347789824854045, 'recall': 0.02171875, 'f1-score': 0.04088435707632727, 'support': 19200}, '2': {'precision': 0.3422069870906571, 'recall': 0.9610815239655879, 'f1-score': 0.5047060721777012, 'support': 19528}, 'accuracy': 0.34244322357140355, 'macro avg': {'precision': 0.3461105484760168, 'recall': 0.33460106820235763, 'f1-score': 0.19506918865632653, 'support': 57154}, 'weighted avg': {'precision': 0.346058024335448, 'recall': 0.34244322357140355, 'f1-score': 0.19895134539072196, 'support': 57154}}
[[  387   393 17646]
 [  353   417 18430]
 [  371   389 18768]]
Evaluating performance on  val set...
68/68 - 1s - 942ms/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1172229
{'0': {'precision': 0.3916083916083916, 'recall': 0.016066561468942763, 'f1-score': 0.030866749345459556, 'support': 6971}, '1': {'precision': 0.259927797833935, 'recall': 0.015437392795883362, 'f1-score': 0.029143897996357013, 'support': 4664}, '2': {'precision': 0.32437619961612285, 'recall': 0.9657142857142857, 'f1-score': 0.485632183908046, 'support': 5600}, 'accuracy': 0.3244560487380331, 'macro avg': {'precision': 0.3253041296861498, 'recall': 0.3324060799930373, 'f1-score': 0.1818809437499542, 'support': 17235}, 'weighted avg': {'precision': 0.33412892746445366, 'recall': 0.3244560487380331, 'f1-score': 0.17816301014373456, 'support': 17235}}
[[ 112  112 6747]
 [  75   72 4517]
 [  99   93 5408]]
training model: results/LILAK/W8/deepLOB_L2/h10
Epoch 1/50
224/224 - 13s - loss: 3.3458 - accuracy10: 0.3621 - val_loss: 3.4598 - val_accuracy10: 0.3147 - 13s/epoch - 60ms/step
Epoch 2/50
224/224 - 11s - loss: 3.2926 - accuracy10: 0.3807 - val_loss: 3.4176 - val_accuracy10: 0.3258 - 11s/epoch - 47ms/step
Epoch 3/50
224/224 - 11s - loss: 3.2482 - accuracy10: 0.4047 - val_loss: 3.4112 - val_accuracy10: 0.3266 - 11s/epoch - 47ms/step
Epoch 4/50
224/224 - 11s - loss: 3.2231 - accuracy10: 0.4175 - val_loss: 3.4316 - val_accuracy10: 0.3260 - 11s/epoch - 48ms/step
Epoch 5/50
224/224 - 11s - loss: 3.1844 - accuracy10: 0.4293 - val_loss: 3.4688 - val_accuracy10: 0.3143 - 11s/epoch - 48ms/step
Epoch 6/50
224/224 - 11s - loss: 3.1473 - accuracy10: 0.4443 - val_loss: 3.4387 - val_accuracy10: 0.3242 - 11s/epoch - 48ms/step
Epoch 7/50
224/224 - 11s - loss: 3.0979 - accuracy10: 0.4601 - val_loss: 3.4243 - val_accuracy10: 0.3384 - 11s/epoch - 48ms/step
Epoch 8/50
224/224 - 11s - loss: 3.0707 - accuracy10: 0.4715 - val_loss: 3.3611 - val_accuracy10: 0.3535 - 11s/epoch - 48ms/step
Epoch 9/50
224/224 - 11s - loss: 3.0338 - accuracy10: 0.4835 - val_loss: 3.3271 - val_accuracy10: 0.3657 - 11s/epoch - 48ms/step
Epoch 10/50
224/224 - 11s - loss: 3.0076 - accuracy10: 0.4895 - val_loss: 3.2943 - val_accuracy10: 0.3881 - 11s/epoch - 48ms/step
Epoch 11/50
224/224 - 11s - loss: 2.9792 - accuracy10: 0.4994 - val_loss: 3.3042 - val_accuracy10: 0.3875 - 11s/epoch - 48ms/step
Epoch 12/50
224/224 - 11s - loss: 2.9567 - accuracy10: 0.5069 - val_loss: 3.3104 - val_accuracy10: 0.3881 - 11s/epoch - 48ms/step
Epoch 13/50
224/224 - 11s - loss: 2.9358 - accuracy10: 0.5134 - val_loss: 3.3630 - val_accuracy10: 0.4022 - 11s/epoch - 48ms/step
Epoch 14/50
224/224 - 11s - loss: 2.9204 - accuracy10: 0.5189 - val_loss: 3.3665 - val_accuracy10: 0.4082 - 11s/epoch - 48ms/step
Epoch 15/50
224/224 - 11s - loss: 2.9048 - accuracy10: 0.5239 - val_loss: 3.3785 - val_accuracy10: 0.3987 - 11s/epoch - 48ms/step
Epoch 16/50
224/224 - 11s - loss: 2.8764 - accuracy10: 0.5292 - val_loss: 3.3446 - val_accuracy10: 0.4008 - 11s/epoch - 48ms/step
Epoch 17/50
224/224 - 11s - loss: 2.8562 - accuracy10: 0.5340 - val_loss: 3.4155 - val_accuracy10: 0.3932 - 11s/epoch - 48ms/step
Epoch 18/50
224/224 - 11s - loss: 2.8407 - accuracy10: 0.5387 - val_loss: 3.3804 - val_accuracy10: 0.4102 - 11s/epoch - 48ms/step
Epoch 19/50
224/224 - 11s - loss: 2.8258 - accuracy10: 0.5427 - val_loss: 3.3870 - val_accuracy10: 0.4018 - 11s/epoch - 48ms/step
Epoch 20/50
224/224 - 11s - loss: 2.8090 - accuracy10: 0.5494 - val_loss: 3.4925 - val_accuracy10: 0.3974 - 11s/epoch - 48ms/step
testing model: results/LILAK/W8/deepLOB_L2/h10
Evaluating performance on  test set...
645/645 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1065089
{'0': {'precision': 0.3511152706286071, 'recall': 0.5632663274668446, 'f1-score': 0.4325795913138172, 'support': 47956}, '1': {'precision': 0.5324436601595529, 'recall': 0.2064929139696028, 'f1-score': 0.29757856563145296, 'support': 70138}, '2': {'precision': 0.3397213403299831, 'recall': 0.4409993593850096, 'f1-score': 0.38379126750355413, 'support': 46830}, 'accuracy': 0.37682205136911545, 'macro avg': {'precision': 0.4077600903727143, 'recall': 0.40358620027381903, 'f1-score': 0.3713164748162748, 'support': 164924}, 'weighted avg': {'precision': 0.4249943472277492, 'recall': 0.37682205136911545, 'f1-score': 0.36131368008595294, 'support': 164924}}
[[27012  6259 14685]
 [30201 14483 25454]
 [19719  6459 20652]]
Evaluating performance on  train set...
224/224 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0601994
{'0': {'precision': 0.38155870511603546, 'recall': 0.6814567987840524, 'f1-score': 0.48920410432884986, 'support': 17106}, '1': {'precision': 0.6597409259971784, 'recall': 0.22577247191011235, 'f1-score': 0.33641803734344855, 'support': 22784}, '2': {'precision': 0.42385408912049344, 'recall': 0.46171223354958296, 'f1-score': 0.4419739395619628, 'support': 17264}, 'accuracy': 0.43342548203100395, 'macro avg': {'precision': 0.48838457341123576, 'recall': 0.45631383474791587, 'f1-score': 0.42253202707808707, 'support': 57154}, 'weighted avg': {'precision': 0.5052296857999583, 'recall': 0.43342548203100395, 'f1-score': 0.41403072513000255, 'support': 57154}}
[[11657  1194  4255]
 [11060  5144  6580]
 [ 7834  1459  7971]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1053349
{'0': {'precision': 0.3534214618973561, 'recall': 0.6870748299319728, 'f1-score': 0.46675224646983315, 'support': 5292}, '1': {'precision': 0.45803266236232437, 'recall': 0.1839536302623551, 'f1-score': 0.2624877571008815, 'support': 6556}, '2': {'precision': 0.40755329008341057, 'recall': 0.3264056411208016, 'f1-score': 0.3624935600206079, 'support': 5389}, 'accuracy': 0.38295527063874224, 'macro avg': {'precision': 0.4063358047810303, 'recall': 0.3991447004383765, 'f1-score': 0.3639111878637742, 'support': 17237}, 'weighted avg': {'precision': 0.4101336190211584, 'recall': 0.38295527063874224, 'f1-score': 0.35646576659643747, 'support': 17237}}
[[3636  697  959]
 [3752 1206 1598]
 [2900  730 1759]]
training model: results/LILAK/W8/deepLOB_L2/h20
Epoch 1/50
224/224 - 13s - loss: 3.3360 - accuracy20: 0.3660 - val_loss: 3.4003 - val_accuracy20: 0.3415 - 13s/epoch - 58ms/step
Epoch 2/50
224/224 - 11s - loss: 3.2815 - accuracy20: 0.3834 - val_loss: 3.3907 - val_accuracy20: 0.3484 - 11s/epoch - 49ms/step
Epoch 3/50
224/224 - 11s - loss: 3.2689 - accuracy20: 0.3864 - val_loss: 3.4104 - val_accuracy20: 0.3454 - 11s/epoch - 49ms/step
Epoch 4/50
224/224 - 11s - loss: 3.2499 - accuracy20: 0.3951 - val_loss: 3.3440 - val_accuracy20: 0.3487 - 11s/epoch - 49ms/step
Epoch 5/50
224/224 - 11s - loss: 3.2203 - accuracy20: 0.4092 - val_loss: 3.3669 - val_accuracy20: 0.3285 - 11s/epoch - 48ms/step
Epoch 6/50
224/224 - 11s - loss: 3.2188 - accuracy20: 0.4091 - val_loss: 3.4172 - val_accuracy20: 0.3326 - 11s/epoch - 49ms/step
Epoch 7/50
224/224 - 11s - loss: 3.1736 - accuracy20: 0.4270 - val_loss: 3.3669 - val_accuracy20: 0.3560 - 11s/epoch - 48ms/step
Epoch 8/50
224/224 - 11s - loss: 3.1395 - accuracy20: 0.4411 - val_loss: 3.3646 - val_accuracy20: 0.3556 - 11s/epoch - 48ms/step
Epoch 9/50
224/224 - 11s - loss: 3.1072 - accuracy20: 0.4531 - val_loss: 3.3416 - val_accuracy20: 0.3627 - 11s/epoch - 48ms/step
Epoch 10/50
224/224 - 11s - loss: 3.0717 - accuracy20: 0.4674 - val_loss: 3.3677 - val_accuracy20: 0.3589 - 11s/epoch - 49ms/step
Epoch 11/50
224/224 - 11s - loss: 3.0398 - accuracy20: 0.4783 - val_loss: 3.4003 - val_accuracy20: 0.3563 - 11s/epoch - 48ms/step
Epoch 12/50
224/224 - 11s - loss: 3.0112 - accuracy20: 0.4871 - val_loss: 3.4526 - val_accuracy20: 0.3520 - 11s/epoch - 48ms/step
Epoch 13/50
224/224 - 11s - loss: 2.9880 - accuracy20: 0.4919 - val_loss: 3.4318 - val_accuracy20: 0.3574 - 11s/epoch - 48ms/step
Epoch 14/50
224/224 - 11s - loss: 2.9675 - accuracy20: 0.5005 - val_loss: 3.4522 - val_accuracy20: 0.3562 - 11s/epoch - 48ms/step
Epoch 15/50
224/224 - 11s - loss: 2.9477 - accuracy20: 0.5069 - val_loss: 3.4173 - val_accuracy20: 0.3628 - 11s/epoch - 48ms/step
Epoch 16/50
224/224 - 11s - loss: 2.9288 - accuracy20: 0.5108 - val_loss: 3.4172 - val_accuracy20: 0.3660 - 11s/epoch - 48ms/step
Epoch 17/50
224/224 - 11s - loss: 2.9065 - accuracy20: 0.5181 - val_loss: 3.4501 - val_accuracy20: 0.3657 - 11s/epoch - 48ms/step
Epoch 18/50
224/224 - 11s - loss: 2.8912 - accuracy20: 0.5234 - val_loss: 3.4672 - val_accuracy20: 0.3572 - 11s/epoch - 48ms/step
Epoch 19/50
224/224 - 11s - loss: 2.8734 - accuracy20: 0.5290 - val_loss: 3.5117 - val_accuracy20: 0.3597 - 11s/epoch - 48ms/step
testing model: results/LILAK/W8/deepLOB_L2/h20
Evaluating performance on  test set...
645/645 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0896314
{'0': {'precision': 0.3728621427458093, 'recall': 0.48145640837983716, 'f1-score': 0.42025745041045137, 'support': 54655}, '1': {'precision': 0.43148595109066895, 'recall': 0.3327713974642644, 'f1-score': 0.37575348984771567, 'support': 56946}, '2': {'precision': 0.3698966946245514, 'recall': 0.34984903325019223, 'f1-score': 0.35959366205327886, 'support': 53323}, 'accuracy': 0.3875663942179428, 'macro avg': {'precision': 0.3914149294870099, 'recall': 0.38802561303143124, 'f1-score': 0.3852015341038153, 'support': 164924}, 'weighted avg': {'precision': 0.39214535683130647, 'recall': 0.3875663942179428, 'f1-score': 0.38527710961848016, 'support': 164924}}
[[26314 12258 16083]
 [22301 18950 15695]
 [21958 12710 18655]]
Evaluating performance on  train set...
224/224 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0564455
{'0': {'precision': 0.4022485720482973, 'recall': 0.5886990106343579, 'f1-score': 0.47793312286579465, 'support': 18901}, '1': {'precision': 0.5007902298850575, 'recall': 0.36897263536759645, 'f1-score': 0.4248925730655533, 'support': 18893}, '2': {'precision': 0.44644233239147185, 'recall': 0.35909090909090907, 'f1-score': 0.3980304591778312, 'support': 19360}, 'accuracy': 0.4382895335409595, 'macro avg': {'precision': 0.44982704477494223, 'recall': 0.43892085169762113, 'f1-score': 0.4336187183697264, 'support': 57154}, 'weighted avg': {'precision': 0.4497927289183986, 'recall': 0.4382895335409595, 'f1-score': 0.43333413283228983, 'support': 57154}}
[[11127  3217  4557]
 [ 7859  6971  4063]
 [ 8676  3732  6952]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1150743
{'0': {'precision': 0.3751716247139588, 'recall': 0.5481444332998997, 'f1-score': 0.4454557804646108, 'support': 5982}, '1': {'precision': 0.33471745802491426, 'recall': 0.3523375142531357, 'f1-score': 0.343301546153134, 'support': 5262}, '2': {'precision': 0.3918187964841109, 'recall': 0.19339229100617386, 'f1-score': 0.25896547871746173, 'support': 5993}, 'accuracy': 0.36502871729419273, 'macro avg': {'precision': 0.36723595974099466, 'recall': 0.3646247461864031, 'f1-score': 0.34924093511173554, 'support': 17237}, 'weighted avg': {'precision': 0.36860996521989187, 'recall': 0.36502871729419273, 'f1-score': 0.3494314166357742, 'support': 17237}}
[[3279 1772  931]
 [2540 1854  868]
 [2921 1913 1159]]
training model: results/LILAK/W8/deepLOB_L2/h30
Epoch 1/50
224/224 - 13s - loss: 3.3425 - accuracy30: 0.3626 - val_loss: 3.4197 - val_accuracy30: 0.3376 - 13s/epoch - 60ms/step
Epoch 2/50
224/224 - 11s - loss: 3.2911 - accuracy30: 0.3771 - val_loss: 3.4309 - val_accuracy30: 0.3402 - 11s/epoch - 48ms/step
Epoch 3/50
224/224 - 11s - loss: 3.2650 - accuracy30: 0.3864 - val_loss: 3.4212 - val_accuracy30: 0.3353 - 11s/epoch - 48ms/step
Epoch 4/50
224/224 - 11s - loss: 3.2334 - accuracy30: 0.4008 - val_loss: 3.5000 - val_accuracy30: 0.3332 - 11s/epoch - 48ms/step
Epoch 5/50
224/224 - 11s - loss: 3.2158 - accuracy30: 0.4082 - val_loss: 3.3838 - val_accuracy30: 0.3343 - 11s/epoch - 49ms/step
Epoch 6/50
224/224 - 11s - loss: 3.1935 - accuracy30: 0.4136 - val_loss: 3.3736 - val_accuracy30: 0.3492 - 11s/epoch - 49ms/step
Epoch 7/50
224/224 - 11s - loss: 3.1709 - accuracy30: 0.4226 - val_loss: 3.3869 - val_accuracy30: 0.3411 - 11s/epoch - 48ms/step
Epoch 8/50
224/224 - 11s - loss: 3.1515 - accuracy30: 0.4324 - val_loss: 3.3893 - val_accuracy30: 0.3414 - 11s/epoch - 49ms/step
Epoch 9/50
224/224 - 11s - loss: 3.1243 - accuracy30: 0.4445 - val_loss: 3.3838 - val_accuracy30: 0.3473 - 11s/epoch - 48ms/step
Epoch 10/50
224/224 - 11s - loss: 3.0995 - accuracy30: 0.4539 - val_loss: 3.3764 - val_accuracy30: 0.3508 - 11s/epoch - 48ms/step
Epoch 11/50
224/224 - 11s - loss: 3.0738 - accuracy30: 0.4612 - val_loss: 3.3773 - val_accuracy30: 0.3546 - 11s/epoch - 48ms/step
Epoch 12/50
224/224 - 11s - loss: 3.0630 - accuracy30: 0.4665 - val_loss: 3.3943 - val_accuracy30: 0.3500 - 11s/epoch - 48ms/step
Epoch 13/50
224/224 - 11s - loss: 3.0499 - accuracy30: 0.4688 - val_loss: 3.3815 - val_accuracy30: 0.3539 - 11s/epoch - 48ms/step
Epoch 14/50
224/224 - 11s - loss: 3.0302 - accuracy30: 0.4758 - val_loss: 3.4257 - val_accuracy30: 0.3572 - 11s/epoch - 48ms/step
Epoch 15/50
224/224 - 11s - loss: 3.0129 - accuracy30: 0.4835 - val_loss: 3.3963 - val_accuracy30: 0.3520 - 11s/epoch - 48ms/step
Epoch 16/50
224/224 - 11s - loss: 2.9960 - accuracy30: 0.4893 - val_loss: 3.4522 - val_accuracy30: 0.3494 - 11s/epoch - 48ms/step
testing model: results/LILAK/W8/deepLOB_L2/h30
Evaluating performance on  test set...
645/645 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1406478
{'0': {'precision': 0.32491079880579626, 'recall': 0.49293881534127526, 'f1-score': 0.39166404552736106, 'support': 54311}, '1': {'precision': 0.335090711738254, 'recall': 0.11221893337487666, 'f1-score': 0.16813195362950284, 'support': 57771}, '2': {'precision': 0.3379920543218474, 'recall': 0.40411036675371864, 'f1-score': 0.3681057739547151, 'support': 52842}, 'accuracy': 0.3311161504693071, 'macro avg': {'precision': 0.33266452162196586, 'recall': 0.33642270515662354, 'f1-score': 0.30930059103719304, 'support': 164924}, 'weighted avg': {'precision': 0.33266796849607905, 'recall': 0.3311161504693071, 'f1-score': 0.30581517776116013, 'support': 164924}}
[[26772  6889 20650]
 [30113  6483 21175]
 [25513  5975 21354]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1023217
{'0': {'precision': 0.36101771921853704, 'recall': 0.6281753979129335, 'f1-score': 0.4585200715535979, 'support': 18974}, '1': {'precision': 0.5102414045354792, 'recall': 0.1482544237207078, 'f1-score': 0.22975254251245522, 'support': 18819}, '2': {'precision': 0.3798403941942049, 'recall': 0.36630339341976137, 'f1-score': 0.37294909549852756, 'support': 19361}, 'accuracy': 0.3814431185918746, 'macro avg': {'precision': 0.41703317264940704, 'recall': 0.38091107168446764, 'f1-score': 0.3537405698548602, 'support': 57154}, 'weighted avg': {'precision': 0.41652855562864727, 'recall': 0.3814431185918746, 'f1-score': 0.3542068861872634, 'support': 57154}}
[[11919  1367  5688]
 [10138  2790  5891]
 [10958  1311  7092]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1235327
{'0': {'precision': 0.35434158784142844, 'recall': 0.5574318675806721, 'f1-score': 0.4332683560753737, 'support': 5981}, '1': {'precision': 0.32202052091554856, 'recall': 0.22658274713069235, 'f1-score': 0.266000217320439, 'support': 5402}, '2': {'precision': 0.37298236900918796, 'recall': 0.25657669969251795, 'f1-score': 0.304017811962352, 'support': 5854}, 'accuracy': 0.3515692986018449, 'macro avg': {'precision': 0.34978149258872165, 'recall': 0.3468637714679608, 'f1-score': 0.3344287951193882, 'support': 17237}, 'weighted avg': {'precision': 0.350543057321179, 'recall': 0.3515692986018449, 'f1-score': 0.33695141166556997, 'support': 17237}}
[[3334 1243 1404]
 [3057 1224 1121]
 [3018 1334 1502]]
training model: results/LILAK/W8/deepLOB_L2/h50
Epoch 1/50
224/224 - 13s - loss: 3.3527 - accuracy50: 0.3538 - val_loss: 3.4295 - val_accuracy50: 0.3352 - 13s/epoch - 59ms/step
Epoch 2/50
224/224 - 11s - loss: 3.3006 - accuracy50: 0.3720 - val_loss: 3.4005 - val_accuracy50: 0.3412 - 11s/epoch - 50ms/step
Epoch 3/50
224/224 - 11s - loss: 3.2873 - accuracy50: 0.3784 - val_loss: 3.3977 - val_accuracy50: 0.3296 - 11s/epoch - 50ms/step
Epoch 4/50
224/224 - 11s - loss: 3.2613 - accuracy50: 0.3864 - val_loss: 3.3982 - val_accuracy50: 0.3332 - 11s/epoch - 49ms/step
Epoch 5/50
224/224 - 11s - loss: 3.2309 - accuracy50: 0.3967 - val_loss: 3.4557 - val_accuracy50: 0.3311 - 11s/epoch - 49ms/step
Epoch 6/50
224/224 - 11s - loss: 3.2038 - accuracy50: 0.4080 - val_loss: 3.4384 - val_accuracy50: 0.3345 - 11s/epoch - 49ms/step
Epoch 7/50
224/224 - 11s - loss: 3.1828 - accuracy50: 0.4167 - val_loss: 3.4245 - val_accuracy50: 0.3358 - 11s/epoch - 49ms/step
Epoch 8/50
224/224 - 11s - loss: 3.1646 - accuracy50: 0.4225 - val_loss: 3.4725 - val_accuracy50: 0.3349 - 11s/epoch - 49ms/step
Epoch 9/50
224/224 - 11s - loss: 3.1417 - accuracy50: 0.4325 - val_loss: 3.5452 - val_accuracy50: 0.3317 - 11s/epoch - 49ms/step
Epoch 10/50
224/224 - 11s - loss: 3.1296 - accuracy50: 0.4370 - val_loss: 3.4963 - val_accuracy50: 0.3305 - 11s/epoch - 49ms/step
Epoch 11/50
224/224 - 11s - loss: 3.1131 - accuracy50: 0.4451 - val_loss: 3.5881 - val_accuracy50: 0.3258 - 11s/epoch - 49ms/step
Epoch 12/50
224/224 - 11s - loss: 3.0934 - accuracy50: 0.4519 - val_loss: 3.6254 - val_accuracy50: 0.3250 - 11s/epoch - 48ms/step
Epoch 13/50
224/224 - 11s - loss: 3.0786 - accuracy50: 0.4575 - val_loss: 3.5681 - val_accuracy50: 0.3393 - 11s/epoch - 48ms/step
testing model: results/LILAK/W8/deepLOB_L2/h50
Evaluating performance on  test set...
645/645 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1368079
{'0': {'precision': 0.3363960796846703, 'recall': 0.45066452591205064, 'f1-score': 0.3852353394179228, 'support': 56055}, '1': {'precision': 0.2959028831562974, 'recall': 0.04992867332382311, 'f1-score': 0.08544066099148723, 'support': 54678}, '2': {'precision': 0.3411577876479492, 'recall': 0.5074274325995092, 'f1-score': 0.4080033829649907, 'support': 54191}, 'accuracy': 0.33645800489922634, 'macro avg': {'precision': 0.32448558349630563, 'recall': 0.33600687727846096, 'f1-score': 0.2928931277914669, 'support': 164924}, 'weighted avg': {'precision': 0.32453579686627926, 'recall': 0.33645800489922634, 'f1-score': 0.29332421442009665, 'support': 164924}}
[[25262  3365 27428]
 [26272  2730 25676]
 [23562  3131 27498]]
Evaluating performance on  train set...
224/224 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1325761
{'0': {'precision': 0.33756843733021275, 'recall': 0.4290798980025499, 'f1-score': 0.3778625061402073, 'support': 18824}, '1': {'precision': 0.3755506607929515, 'recall': 0.053796802692469496, 'f1-score': 0.09411223551057957, 'support': 19016}, '2': {'precision': 0.34924433662262727, 'recall': 0.5515688101894999, 'f1-score': 0.42768532830158373, 'support': 19314}, 'accuracy': 0.3456101060293243, 'macro avg': {'precision': 0.35412114491526386, 'recall': 0.3448151702948398, 'f1-score': 0.29988668998412354, 'support': 57154}, 'weighted avg': {'precision': 0.3541513235726653, 'recall': 0.3456101060293243, 'f1-score': 0.3002910822841662, 'support': 57154}}
[[ 8077   809  9938]
 [ 8081  1023  9912]
 [ 7769   892 10653]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1301618
{'0': {'precision': 0.35572543916720883, 'recall': 0.3592902907836373, 'f1-score': 0.3574989783408255, 'support': 6087}, '1': {'precision': 0.31046734080349825, 'recall': 0.21584647539426183, 'f1-score': 0.25465142344765745, 'support': 5263}, '2': {'precision': 0.3380888290713324, 'recall': 0.4267029047052828, 'f1-score': 0.377262146129008, 'support': 5887}, 'accuracy': 0.33851598305969716, 'macro avg': {'precision': 0.3347605363473465, 'recall': 0.3339465569610606, 'f1-score': 0.3298041826391636, 'support': 17237}, 'weighted avg': {'precision': 0.3358832337183121, 'recall': 0.33851598305969716, 'f1-score': 0.33284614358804293, 'support': 17237}}
[[2187 1221 2679]
 [1888 1136 2239]
 [2073 1302 2512]]
training model: results/LILAK/W8/deepLOB_L2/h100
Epoch 1/50
224/224 - 13s - loss: 3.3603 - accuracy100: 0.3529 - val_loss: 3.3982 - val_accuracy100: 0.3400 - 13s/epoch - 59ms/step
Epoch 2/50
224/224 - 11s - loss: 3.3069 - accuracy100: 0.3696 - val_loss: 3.4089 - val_accuracy100: 0.3268 - 11s/epoch - 49ms/step
Epoch 3/50
224/224 - 11s - loss: 3.2969 - accuracy100: 0.3712 - val_loss: 3.3701 - val_accuracy100: 0.3458 - 11s/epoch - 49ms/step
Epoch 4/50
224/224 - 11s - loss: 3.2930 - accuracy100: 0.3711 - val_loss: 3.3429 - val_accuracy100: 0.3525 - 11s/epoch - 50ms/step
Epoch 5/50
224/224 - 11s - loss: 3.2706 - accuracy100: 0.3830 - val_loss: 3.3469 - val_accuracy100: 0.3479 - 11s/epoch - 49ms/step
Epoch 6/50
224/224 - 11s - loss: 3.2449 - accuracy100: 0.3951 - val_loss: 3.3422 - val_accuracy100: 0.3502 - 11s/epoch - 49ms/step
Epoch 7/50
224/224 - 11s - loss: 3.2088 - accuracy100: 0.4134 - val_loss: 3.3634 - val_accuracy100: 0.3486 - 11s/epoch - 48ms/step
Epoch 8/50
224/224 - 11s - loss: 3.1908 - accuracy100: 0.4191 - val_loss: 3.3589 - val_accuracy100: 0.3629 - 11s/epoch - 48ms/step
Epoch 9/50
224/224 - 11s - loss: 3.1674 - accuracy100: 0.4285 - val_loss: 3.3922 - val_accuracy100: 0.3512 - 11s/epoch - 49ms/step
Epoch 10/50
224/224 - 11s - loss: 3.1490 - accuracy100: 0.4336 - val_loss: 3.4165 - val_accuracy100: 0.3497 - 11s/epoch - 48ms/step
Epoch 11/50
224/224 - 11s - loss: 3.1336 - accuracy100: 0.4374 - val_loss: 3.4157 - val_accuracy100: 0.3491 - 11s/epoch - 48ms/step
Epoch 12/50
224/224 - 11s - loss: 3.1153 - accuracy100: 0.4467 - val_loss: 3.4342 - val_accuracy100: 0.3497 - 11s/epoch - 48ms/step
Epoch 13/50
224/224 - 11s - loss: 3.0988 - accuracy100: 0.4531 - val_loss: 3.4440 - val_accuracy100: 0.3474 - 11s/epoch - 48ms/step
Epoch 14/50
224/224 - 11s - loss: 3.0836 - accuracy100: 0.4606 - val_loss: 3.4516 - val_accuracy100: 0.3464 - 11s/epoch - 48ms/step
Epoch 15/50
224/224 - 11s - loss: 3.0716 - accuracy100: 0.4630 - val_loss: 3.4873 - val_accuracy100: 0.3492 - 11s/epoch - 48ms/step
Epoch 16/50
224/224 - 11s - loss: 3.0546 - accuracy100: 0.4693 - val_loss: 3.4545 - val_accuracy100: 0.3519 - 11s/epoch - 48ms/step
testing model: results/LILAK/W8/deepLOB_L2/h100
Evaluating performance on  test set...
645/645 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1251472
{'0': {'precision': 0.3553933113518606, 'recall': 0.16038688420045705, 'f1-score': 0.221026035372954, 'support': 56451}, '1': {'precision': 0.323668402082499, 'recall': 0.07573798144503795, 'f1-score': 0.12275212636695015, 'support': 53355}, '2': {'precision': 0.3385001929696053, 'recall': 0.7797271308828332, 'f1-score': 0.4720646305765016, 'support': 55118}, 'accuracy': 0.3399869030583784, 'macro avg': {'precision': 0.339187302134655, 'recall': 0.3386173321761094, 'f1-score': 0.2719475974388019, 'support': 164924}, 'weighted avg': {'precision': 0.3394841808853431, 'recall': 0.3399869030583784, 'f1-score': 0.2731308889746966, 'support': 164924}}
[[ 9054  4364 43033]
 [ 8361  4041 40953]
 [ 8061  4080 42977]]
Evaluating performance on  train set...
224/224 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1036285
{'0': {'precision': 0.3661511005353956, 'recall': 0.3223694547740009, 'f1-score': 0.34286828398741054, 'support': 19093}, '1': {'precision': 0.42189922480620157, 'recall': 0.11502694705695868, 'f1-score': 0.18076891140081375, 'support': 18926}, '2': {'precision': 0.3509549795361528, 'recall': 0.6453096420172458, 'f1-score': 0.45464754505789867, 'support': 19135}, 'accuracy': 0.3618294432585646, 'macro avg': {'precision': 0.37966843495925, 'recall': 0.36090201461606847, 'f1-score': 0.326094913482041, 'support': 57154}, 'weighted avg': {'precision': 0.3795239392628471, 'recall': 0.3618294432585646, 'f1-score': 0.32661401368279247, 'support': 57154}}
[[ 6155  1484 11454]
 [ 5367  2177 11382]
 [ 5288  1499 12348]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1138548
{'0': {'precision': 0.35846062289228325, 'recall': 0.29843104872006604, 'f1-score': 0.32570295602018745, 'support': 6055}, '1': {'precision': 0.35506958250497017, 'recall': 0.33302256199888125, 'f1-score': 0.3436928702010969, 'support': 5363}, '2': {'precision': 0.3407758861289422, 'recall': 0.41965973534971646, 'f1-score': 0.3761262995764343, 'support': 5819}, 'accuracy': 0.3501189302082729, 'macro avg': {'precision': 0.35143536384206525, 'recall': 0.35037111535622123, 'f1-score': 0.3485073752659062, 'support': 17237}, 'weighted avg': {'precision': 0.3514354077839093, 'recall': 0.3501189302082729, 'f1-score': 0.3483225154508318, 'support': 17237}}
[[1807 1572 2676]
 [1529 1786 2048]
 [1705 1672 2442]]
training model: results/LILAK/W8/deepLOB_L2/h200
Epoch 1/50
224/224 - 14s - loss: 3.3484 - accuracy200: 0.3633 - val_loss: 3.4038 - val_accuracy200: 0.3437 - 14s/epoch - 61ms/step
Epoch 2/50
224/224 - 11s - loss: 3.2970 - accuracy200: 0.3800 - val_loss: 3.4340 - val_accuracy200: 0.3276 - 11s/epoch - 50ms/step
Epoch 3/50
224/224 - 11s - loss: 3.2872 - accuracy200: 0.3817 - val_loss: 3.4102 - val_accuracy200: 0.3392 - 11s/epoch - 50ms/step
Epoch 4/50
224/224 - 11s - loss: 3.2725 - accuracy200: 0.3917 - val_loss: 3.4488 - val_accuracy200: 0.3231 - 11s/epoch - 50ms/step
Epoch 5/50
224/224 - 11s - loss: 3.2614 - accuracy200: 0.3939 - val_loss: 3.4031 - val_accuracy200: 0.3345 - 11s/epoch - 50ms/step
Epoch 6/50
224/224 - 11s - loss: 3.2354 - accuracy200: 0.4047 - val_loss: 3.4269 - val_accuracy200: 0.3306 - 11s/epoch - 50ms/step
Epoch 7/50
224/224 - 11s - loss: 3.2045 - accuracy200: 0.4143 - val_loss: 3.4160 - val_accuracy200: 0.3356 - 11s/epoch - 50ms/step
Epoch 8/50
224/224 - 11s - loss: 3.1891 - accuracy200: 0.4155 - val_loss: 3.4398 - val_accuracy200: 0.3353 - 11s/epoch - 50ms/step
Epoch 9/50
224/224 - 11s - loss: 3.1693 - accuracy200: 0.4237 - val_loss: 3.4277 - val_accuracy200: 0.3383 - 11s/epoch - 49ms/step
Epoch 10/50
224/224 - 11s - loss: 3.1553 - accuracy200: 0.4287 - val_loss: 3.4177 - val_accuracy200: 0.3388 - 11s/epoch - 49ms/step
Epoch 11/50
224/224 - 11s - loss: 3.1309 - accuracy200: 0.4383 - val_loss: 3.4844 - val_accuracy200: 0.3400 - 11s/epoch - 50ms/step
Epoch 12/50
224/224 - 11s - loss: 3.1112 - accuracy200: 0.4444 - val_loss: 3.4728 - val_accuracy200: 0.3392 - 11s/epoch - 50ms/step
Epoch 13/50
224/224 - 11s - loss: 3.0907 - accuracy200: 0.4550 - val_loss: 3.4717 - val_accuracy200: 0.3425 - 11s/epoch - 50ms/step
Epoch 14/50
224/224 - 11s - loss: 3.0706 - accuracy200: 0.4628 - val_loss: 3.5210 - val_accuracy200: 0.3375 - 11s/epoch - 49ms/step
Epoch 15/50
224/224 - 11s - loss: 3.0571 - accuracy200: 0.4649 - val_loss: 3.5285 - val_accuracy200: 0.3378 - 11s/epoch - 50ms/step
testing model: results/LILAK/W8/deepLOB_L2/h200
Evaluating performance on  test set...
645/645 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.148309
{'0': {'precision': 0.3083173996175908, 'recall': 0.08205361199454793, 'f1-score': 0.12961288377901217, 'support': 55025}, '1': {'precision': 0.3183705140640155, 'recall': 0.15029854573427598, 'f1-score': 0.20419792716459506, 'support': 54598}, '2': {'precision': 0.3440986305770853, 'recall': 0.7747057015243848, 'f1-score': 0.47653582194142585, 'support': 55301}, 'accuracy': 0.33690063301884504, 'macro avg': {'precision': 0.3235955147528972, 'recall': 0.3356859530844029, 'f1-score': 0.270115544295011, 'support': 164924}, 'weighted avg': {'precision': 0.3236433545776748, 'recall': 0.33690063301884504, 'f1-score': 0.2706316536492899, 'support': 164924}}
[[ 4515  9162 41348]
 [ 6077  8206 40315]
 [ 4052  8407 42842]]
Evaluating performance on  train set...
224/224 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1385379
{'0': {'precision': 0.3606623996748959, 'recall': 0.1856306212089521, 'f1-score': 0.2451065005005696, 'support': 19124}, '1': {'precision': 0.32363150867823764, 'recall': 0.1286624203821656, 'f1-score': 0.1841245727307254, 'support': 18840}, '2': {'precision': 0.33720901032118733, 'recall': 0.6997394476289734, 'f1-score': 0.45510159122875404, 'support': 19190}, 'accuracy': 0.3394688035833013, 'macro avg': {'precision': 0.3405009728914403, 'recall': 0.3380108297400304, 'f1-score': 0.2947775548200164, 'support': 57154}, 'weighted avg': {'precision': 0.34058099630724514, 'recall': 0.3394688035833013, 'f1-score': 0.295512531082681, 'support': 57154}}
[[ 3550  2528 13046]
 [ 3069  2424 13347]
 [ 3224  2538 13428]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1361984
{'0': {'precision': 0.3545715195922268, 'recall': 0.1814476687316596, 'f1-score': 0.2400517631834358, 'support': 6134}, '1': {'precision': 0.30736877523553163, 'recall': 0.3481326219512195, 'f1-score': 0.3264832022873481, 'support': 5248}, '2': {'precision': 0.340691685062546, 'recall': 0.47446626814688303, 'f1-score': 0.39660218431008637, 'support': 5855}, 'accuracy': 0.33172825897778035, 'macro avg': {'precision': 0.33421065996343485, 'recall': 0.3346821862765874, 'f1-score': 0.3210457165936234, 'support': 17237}, 'weighted avg': {'precision': 0.3354854585865288, 'recall': 0.33172825897778035, 'f1-score': 0.3195432586939, 'support': 17237}}
[[1113 2137 2884]
 [ 929 1827 2492]
 [1097 1980 2778]]
training model: results/LILAK/W8/deepLOB_L2/h300
Epoch 1/50
224/224 - 13s - loss: 3.3546 - accuracy300: 0.3609 - val_loss: 3.4078 - val_accuracy300: 0.3470 - 13s/epoch - 58ms/step
Epoch 2/50
224/224 - 11s - loss: 3.2990 - accuracy300: 0.3769 - val_loss: 3.4102 - val_accuracy300: 0.3489 - 11s/epoch - 48ms/step
Epoch 3/50
224/224 - 11s - loss: 3.3068 - accuracy300: 0.3794 - val_loss: 3.4326 - val_accuracy300: 0.3405 - 11s/epoch - 48ms/step
Epoch 4/50
224/224 - 11s - loss: 3.2853 - accuracy300: 0.3783 - val_loss: 3.3988 - val_accuracy300: 0.3238 - 11s/epoch - 50ms/step
Epoch 5/50
224/224 - 11s - loss: 3.2658 - accuracy300: 0.3883 - val_loss: 3.3561 - val_accuracy300: 0.3367 - 11s/epoch - 49ms/step
Epoch 6/50
224/224 - 11s - loss: 3.2450 - accuracy300: 0.4014 - val_loss: 3.4150 - val_accuracy300: 0.3363 - 11s/epoch - 48ms/step
Epoch 7/50
224/224 - 11s - loss: 3.2253 - accuracy300: 0.4054 - val_loss: 3.3624 - val_accuracy300: 0.3396 - 11s/epoch - 48ms/step
Epoch 8/50
224/224 - 11s - loss: 3.1972 - accuracy300: 0.4147 - val_loss: 3.3814 - val_accuracy300: 0.3245 - 11s/epoch - 48ms/step
Epoch 9/50
224/224 - 11s - loss: 3.1641 - accuracy300: 0.4302 - val_loss: 3.3923 - val_accuracy300: 0.3314 - 11s/epoch - 48ms/step
Epoch 10/50
224/224 - 11s - loss: 3.1375 - accuracy300: 0.4383 - val_loss: 3.4080 - val_accuracy300: 0.3362 - 11s/epoch - 48ms/step
Epoch 11/50
224/224 - 11s - loss: 3.1162 - accuracy300: 0.4454 - val_loss: 3.4103 - val_accuracy300: 0.3357 - 11s/epoch - 48ms/step
Epoch 12/50
224/224 - 11s - loss: 3.1013 - accuracy300: 0.4517 - val_loss: 3.4278 - val_accuracy300: 0.3369 - 11s/epoch - 48ms/step
Epoch 13/50
224/224 - 11s - loss: 3.0868 - accuracy300: 0.4540 - val_loss: 3.4235 - val_accuracy300: 0.3410 - 11s/epoch - 48ms/step
Epoch 14/50
224/224 - 11s - loss: 3.0619 - accuracy300: 0.4657 - val_loss: 3.4306 - val_accuracy300: 0.3523 - 11s/epoch - 48ms/step
Epoch 15/50
224/224 - 11s - loss: 3.0310 - accuracy300: 0.4776 - val_loss: 3.4672 - val_accuracy300: 0.3471 - 11s/epoch - 48ms/step
testing model: results/LILAK/W8/deepLOB_L2/h300
Evaluating performance on  test set...
645/645 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1075478
{'0': {'precision': 0.3359596114128356, 'recall': 0.155188862584361, 'f1-score': 0.2123072460965824, 'support': 56602}, '1': {'precision': 0.3665510597302505, 'recall': 0.09377711175960249, 'f1-score': 0.14934606145295257, 'support': 50716}, '2': {'precision': 0.36140632576329657, 'recall': 0.789258063396174, 'f1-score': 0.49578810200153756, 'support': 57606}, 'accuracy': 0.35777691542771217, 'macro avg': {'precision': 0.3546389989687942, 'recall': 0.3460746792467125, 'f1-score': 0.2858138031836908, 'support': 164924}, 'weighted avg': {'precision': 0.3542550645896847, 'recall': 0.35777691542771217, 'f1-score': 0.2919624736248652, 'support': 164924}}
[[ 8784  4389 43429]
 [ 9052  4756 36908]
 [ 8310  3830 45466]]
Evaluating performance on  train set...
224/224 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1110289
{'0': {'precision': 0.3445545788915903, 'recall': 0.28994858881544433, 'f1-score': 0.3149018602398655, 'support': 19062}, '1': {'precision': 0.32088285229202035, 'recall': 0.07029755579171094, 'f1-score': 0.11532929433814235, 'support': 18820}, '2': {'precision': 0.34701270613679375, 'recall': 0.66604400166044, 'f1-score': 0.4562937684405105, 'support': 19272}, 'accuracy': 0.34443783462224864, 'macro avg': {'precision': 0.3374833791068015, 'recall': 0.3420967154225318, 'f1-score': 0.2955083076728395, 'support': 57154}, 'weighted avg': {'precision': 0.3375886820806173, 'recall': 0.34443783462224864, 'f1-score': 0.29686198839489225, 'support': 57154}}
[[ 5527  1413 12122]
 [ 5465  1323 12032]
 [ 5049  1387 12836]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1206903
{'0': {'precision': 0.34562951082598237, 'recall': 0.27968851395197925, 'f1-score': 0.30918220946915353, 'support': 6164}, '1': {'precision': 0.3314374353671148, 'recall': 0.12055670490878315, 'f1-score': 0.17680319955868157, 'support': 5317}, '2': {'precision': 0.3326223945710131, 'recall': 0.5960736622654621, 'f1-score': 0.4269802750295563, 'support': 5756}, 'accuracy': 0.33625340836572487, 'macro avg': {'precision': 0.33656311358803676, 'recall': 0.3321062937087415, 'f1-score': 0.3043218946857971, 'support': 17237}, 'weighted avg': {'precision': 0.3369082584979437, 'recall': 0.33625340836572487, 'f1-score': 0.30768464432856635, 'support': 17237}}
[[1724  659 3781]
 [1573  641 3103]
 [1691  634 3431]]
training model: results/LILAK/W8/deepLOB_L2/h500
Epoch 1/50
224/224 - 13s - loss: 3.3468 - accuracy500: 0.3704 - val_loss: 3.5175 - val_accuracy500: 0.3406 - 13s/epoch - 60ms/step
Epoch 2/50
224/224 - 11s - loss: 3.2970 - accuracy500: 0.3837 - val_loss: 3.4784 - val_accuracy500: 0.3408 - 11s/epoch - 50ms/step
Epoch 3/50
224/224 - 11s - loss: 3.2712 - accuracy500: 0.3902 - val_loss: 3.4147 - val_accuracy500: 0.3467 - 11s/epoch - 50ms/step
Epoch 4/50
224/224 - 11s - loss: 3.2377 - accuracy500: 0.4039 - val_loss: 3.4217 - val_accuracy500: 0.3316 - 11s/epoch - 50ms/step
Epoch 5/50
224/224 - 11s - loss: 3.2211 - accuracy500: 0.4118 - val_loss: 3.4172 - val_accuracy500: 0.3331 - 11s/epoch - 50ms/step
Epoch 6/50
224/224 - 11s - loss: 3.1946 - accuracy500: 0.4203 - val_loss: 3.4002 - val_accuracy500: 0.3438 - 11s/epoch - 50ms/step
Epoch 7/50
224/224 - 11s - loss: 3.2022 - accuracy500: 0.4229 - val_loss: 3.3764 - val_accuracy500: 0.3429 - 11s/epoch - 49ms/step
Epoch 8/50
224/224 - 11s - loss: 3.1646 - accuracy500: 0.4335 - val_loss: 3.3980 - val_accuracy500: 0.3466 - 11s/epoch - 49ms/step
Epoch 9/50
224/224 - 11s - loss: 3.1282 - accuracy500: 0.4482 - val_loss: 3.4031 - val_accuracy500: 0.3513 - 11s/epoch - 48ms/step
Epoch 10/50
224/224 - 11s - loss: 3.0948 - accuracy500: 0.4600 - val_loss: 3.4385 - val_accuracy500: 0.3458 - 11s/epoch - 49ms/step
Epoch 11/50
224/224 - 11s - loss: 3.0658 - accuracy500: 0.4722 - val_loss: 3.4394 - val_accuracy500: 0.3538 - 11s/epoch - 49ms/step
Epoch 12/50
224/224 - 11s - loss: 3.0421 - accuracy500: 0.4810 - val_loss: 3.4377 - val_accuracy500: 0.3575 - 11s/epoch - 49ms/step
Epoch 13/50
224/224 - 11s - loss: 3.0195 - accuracy500: 0.4885 - val_loss: 3.4728 - val_accuracy500: 0.3618 - 11s/epoch - 49ms/step
Epoch 14/50
224/224 - 11s - loss: 3.0078 - accuracy500: 0.4899 - val_loss: 3.5159 - val_accuracy500: 0.3550 - 11s/epoch - 49ms/step
Epoch 15/50
224/224 - 11s - loss: 2.9864 - accuracy500: 0.4987 - val_loss: 3.5568 - val_accuracy500: 0.3465 - 11s/epoch - 48ms/step
Epoch 16/50
224/224 - 11s - loss: 2.9472 - accuracy500: 0.5068 - val_loss: 3.6506 - val_accuracy500: 0.3626 - 11s/epoch - 48ms/step
Epoch 17/50
224/224 - 11s - loss: 2.9171 - accuracy500: 0.5186 - val_loss: 3.6373 - val_accuracy500: 0.3679 - 11s/epoch - 49ms/step
testing model: results/LILAK/W8/deepLOB_L2/h500
Evaluating performance on  test set...
645/645 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1060039
{'0': {'precision': 0.36643743055347006, 'recall': 0.19225436440410915, 'f1-score': 0.2521934130437029, 'support': 63468}, '1': {'precision': 0.19461622408148418, 'recall': 0.014001570269562941, 'f1-score': 0.026123684660270024, 'support': 38210}, '2': {'precision': 0.3964663707750085, 'recall': 0.807877178003352, 'f1-score': 0.5319016041890049, 'support': 63246}, 'accuracy': 0.38703887851373964, 'macro avg': {'precision': 0.3191733418033209, 'recall': 0.33804437089234135, 'f1-score': 0.2700729006309926, 'support': 164924}, 'weighted avg': {'precision': 0.33814513867331214, 'recall': 0.38703887851373964, 'f1-score': 0.30708111850588427, 'support': 164924}}
[[12202  1182 50084]
 [ 9978   535 27697]
 [11119  1032 51095]]
Evaluating performance on  train set...
224/224 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1397579
{'0': {'precision': 0.36000827129859386, 'recall': 0.3684461139622242, 'f1-score': 0.36417832396391686, 'support': 18901}, '1': {'precision': 0.4270231213872832, 'recall': 0.03131457637895406, 'f1-score': 0.05835019993088808, 'support': 18873}, '2': {'precision': 0.35222094108603746, 'recall': 0.6620227038183695, 'f1-score': 0.4598071891911264, 'support': 19380}, 'accuracy': 0.35666794974979876, 'macro avg': {'precision': 0.3797507779239715, 'recall': 0.3539277980531826, 'f1-score': 0.2941119043619771, 'support': 57154}, 'weighted avg': {'precision': 0.3794968951255262, 'recall': 0.35666794974979876, 'f1-score': 0.29561607500895254, 'support': 57154}}
[[ 6964   412 11525]
 [ 6211   591 12071]
 [ 6169   381 12830]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1220807
{'0': {'precision': 0.37300710339384374, 'recall': 0.35711047302402904, 'f1-score': 0.36488573193329216, 'support': 6617}, '1': {'precision': 0.2897822445561139, 'recall': 0.06931089743589744, 'f1-score': 0.11186550274814096, 'support': 4992}, '2': {'precision': 0.3348784507622579, 'recall': 0.5776474769012082, 'f1-score': 0.42396974439227963, 'support': 5628}, 'accuracy': 0.345767825027557, 'macro avg': {'precision': 0.33255593290407187, 'recall': 0.3346896157870449, 'f1-score': 0.30024032635790426, 'support': 17237}, 'weighted avg': {'precision': 0.33645511915479326, 'recall': 0.345767825027557, 'f1-score': 0.31089999416145875, 'support': 17237}}
[[2363  464 3790]
 [1979  346 2667]
 [1993  384 3251]]
training model: results/LILAK/W8/deepLOB_L2/h1000
Epoch 1/50
224/224 - 13s - loss: 3.3420 - accuracy1000: 0.3759 - val_loss: 3.4527 - val_accuracy1000: 0.3324 - 13s/epoch - 60ms/step
Epoch 2/50
224/224 - 11s - loss: 3.3173 - accuracy1000: 0.3794 - val_loss: 3.4689 - val_accuracy1000: 0.3088 - 11s/epoch - 50ms/step
Epoch 3/50
224/224 - 11s - loss: 3.2860 - accuracy1000: 0.3948 - val_loss: 3.5254 - val_accuracy1000: 0.3318 - 11s/epoch - 50ms/step
Epoch 4/50
224/224 - 11s - loss: 3.2656 - accuracy1000: 0.4008 - val_loss: 3.4568 - val_accuracy1000: 0.3224 - 11s/epoch - 49ms/step
Epoch 5/50
224/224 - 11s - loss: 3.2431 - accuracy1000: 0.4102 - val_loss: 3.4956 - val_accuracy1000: 0.3185 - 11s/epoch - 48ms/step
Epoch 6/50
224/224 - 11s - loss: 3.2265 - accuracy1000: 0.4165 - val_loss: 3.4334 - val_accuracy1000: 0.3357 - 11s/epoch - 48ms/step
Epoch 7/50
224/224 - 11s - loss: 3.2169 - accuracy1000: 0.4252 - val_loss: 3.4418 - val_accuracy1000: 0.3441 - 11s/epoch - 48ms/step
Epoch 8/50
224/224 - 11s - loss: 3.1907 - accuracy1000: 0.4348 - val_loss: 3.4380 - val_accuracy1000: 0.3508 - 11s/epoch - 48ms/step
Epoch 9/50
224/224 - 11s - loss: 3.1798 - accuracy1000: 0.4408 - val_loss: 3.4760 - val_accuracy1000: 0.3410 - 11s/epoch - 48ms/step
Epoch 10/50
224/224 - 11s - loss: 3.1419 - accuracy1000: 0.4513 - val_loss: 3.4975 - val_accuracy1000: 0.3465 - 11s/epoch - 48ms/step
Epoch 11/50
224/224 - 11s - loss: 3.1099 - accuracy1000: 0.4605 - val_loss: 3.5560 - val_accuracy1000: 0.3521 - 11s/epoch - 48ms/step
Epoch 12/50
224/224 - 11s - loss: 3.0653 - accuracy1000: 0.4767 - val_loss: 3.6310 - val_accuracy1000: 0.3508 - 11s/epoch - 48ms/step
Epoch 13/50
224/224 - 11s - loss: 3.0327 - accuracy1000: 0.4856 - val_loss: 3.7074 - val_accuracy1000: 0.3529 - 11s/epoch - 48ms/step
Epoch 14/50
224/224 - 11s - loss: 3.0050 - accuracy1000: 0.4922 - val_loss: 3.7313 - val_accuracy1000: 0.3527 - 11s/epoch - 48ms/step
Epoch 15/50
224/224 - 11s - loss: 2.9874 - accuracy1000: 0.4991 - val_loss: 3.7600 - val_accuracy1000: 0.3526 - 11s/epoch - 48ms/step
Epoch 16/50
224/224 - 11s - loss: 2.9354 - accuracy1000: 0.5125 - val_loss: 3.7300 - val_accuracy1000: 0.3638 - 11s/epoch - 48ms/step
testing model: results/LILAK/W8/deepLOB_L2/h1000
Evaluating performance on  test set...
645/645 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.129891
{'0': {'precision': 0.3512158353542636, 'recall': 0.1769562273995674, 'f1-score': 0.2353393282607025, 'support': 60563}, '1': {'precision': 0.2946395563770795, 'recall': 0.03384504320869695, 'f1-score': 0.06071571409526349, 'support': 47097}, '2': {'precision': 0.35690697674418603, 'recall': 0.8040129924559933, 'f1-score': 0.4943628398402267, 'support': 57264}, 'accuracy': 0.35381145254784024, 'macro avg': {'precision': 0.33425412282517636, 'recall': 0.3382714210214192, 'f1-score': 0.2634726273987309, 'support': 164924}, 'weighted avg': {'precision': 0.33703551296070094, 'recall': 0.35381145254784024, 'f1-score': 0.27540914230074637, 'support': 164924}}
[[10717  2191 47655]
 [10199  1594 35304]
 [ 9598  1625 46041]]
Evaluating performance on  train set...
224/224 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.125683
{'0': {'precision': 0.3609421220070324, 'recall': 0.3505909140192996, 'f1-score': 0.35569122459643043, 'support': 18446}, '1': {'precision': 0.4152803450400493, 'recall': 0.03515910276473657, 'f1-score': 0.06482950993122687, 'support': 19170}, '2': {'precision': 0.34827457861434574, 'recall': 0.670488279250691, 'f1-score': 0.45842665173572233, 'support': 19538}, 'accuracy': 0.35414844105399446, 'macro avg': {'precision': 0.37483234855380915, 'recall': 0.3520794320115757, 'f1-score': 0.2929824620877932, 'support': 57154}, 'weighted avg': {'precision': 0.3748373047192944, 'recall': 0.35414844105399446, 'f1-score': 0.2932533498250327, 'support': 57154}}
[[ 6467   455 11524]
 [ 5506   674 12990]
 [ 5944   494 13100]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1368674
{'0': {'precision': 0.36724386724386726, 'recall': 0.36576602471974706, 'f1-score': 0.3665034562211981, 'support': 6958}, '1': {'precision': 0.27879269261318507, 'recall': 0.0750481077613855, 'f1-score': 0.11826145552560648, 'support': 4677}, '2': {'precision': 0.3135499557913351, 'recall': 0.5064262763298821, 'f1-score': 0.3873037542662116, 'support': 5602}, 'accuracy': 0.33259848001392356, 'macro avg': {'precision': 0.3198621718827958, 'recall': 0.3157468029370049, 'f1-score': 0.29068955533767205, 'support': 17237}, 'weighted avg': {'precision': 0.325793531587733, 'recall': 0.33259848001392356, 'f1-score': 0.3059067997493575, 'support': 17237}}
[[2545  489 3924]
 [2039  351 2287]
 [2346  419 2837]]
training model: results/LILAK/W8/deepOF_L2/h10
Epoch 1/50
224/224 - 9s - loss: 3.2770 - accuracy10: 0.3974 - val_loss: 3.2859 - val_accuracy10: 0.3576 - 9s/epoch - 40ms/step
Epoch 2/50
224/224 - 7s - loss: 3.1897 - accuracy10: 0.4444 - val_loss: 3.2710 - val_accuracy10: 0.3630 - 7s/epoch - 31ms/step
Epoch 3/50
224/224 - 7s - loss: 3.1297 - accuracy10: 0.4679 - val_loss: 3.2476 - val_accuracy10: 0.3807 - 7s/epoch - 30ms/step
Epoch 4/50
224/224 - 7s - loss: 3.0857 - accuracy10: 0.4822 - val_loss: 3.2146 - val_accuracy10: 0.3954 - 7s/epoch - 30ms/step
Epoch 5/50
224/224 - 7s - loss: 3.0443 - accuracy10: 0.4932 - val_loss: 3.2146 - val_accuracy10: 0.3963 - 7s/epoch - 30ms/step
Epoch 6/50
224/224 - 7s - loss: 3.0137 - accuracy10: 0.5032 - val_loss: 3.1929 - val_accuracy10: 0.4066 - 7s/epoch - 31ms/step
Epoch 7/50
224/224 - 7s - loss: 2.9818 - accuracy10: 0.5107 - val_loss: 3.1631 - val_accuracy10: 0.4153 - 7s/epoch - 31ms/step
Epoch 8/50
224/224 - 7s - loss: 2.9546 - accuracy10: 0.5187 - val_loss: 3.1513 - val_accuracy10: 0.4222 - 7s/epoch - 31ms/step
Epoch 9/50
224/224 - 7s - loss: 2.9289 - accuracy10: 0.5238 - val_loss: 3.1375 - val_accuracy10: 0.4276 - 7s/epoch - 30ms/step
Epoch 10/50
224/224 - 7s - loss: 2.9052 - accuracy10: 0.5296 - val_loss: 3.1166 - val_accuracy10: 0.4410 - 7s/epoch - 30ms/step
Epoch 11/50
224/224 - 7s - loss: 2.8831 - accuracy10: 0.5362 - val_loss: 3.1102 - val_accuracy10: 0.4447 - 7s/epoch - 31ms/step
Epoch 12/50
224/224 - 7s - loss: 2.8646 - accuracy10: 0.5388 - val_loss: 3.1115 - val_accuracy10: 0.4411 - 7s/epoch - 30ms/step
Epoch 13/50
224/224 - 7s - loss: 2.8442 - accuracy10: 0.5445 - val_loss: 3.1003 - val_accuracy10: 0.4453 - 7s/epoch - 31ms/step
Epoch 14/50
224/224 - 7s - loss: 2.8296 - accuracy10: 0.5496 - val_loss: 3.0895 - val_accuracy10: 0.4551 - 7s/epoch - 31ms/step
Epoch 15/50
224/224 - 7s - loss: 2.8091 - accuracy10: 0.5525 - val_loss: 3.0956 - val_accuracy10: 0.4560 - 7s/epoch - 30ms/step
Epoch 16/50
224/224 - 7s - loss: 2.7920 - accuracy10: 0.5567 - val_loss: 3.1126 - val_accuracy10: 0.4478 - 7s/epoch - 30ms/step
Epoch 17/50
224/224 - 7s - loss: 2.7741 - accuracy10: 0.5602 - val_loss: 3.0923 - val_accuracy10: 0.4598 - 7s/epoch - 30ms/step
Epoch 18/50
224/224 - 7s - loss: 2.7599 - accuracy10: 0.5641 - val_loss: 3.0728 - val_accuracy10: 0.4693 - 7s/epoch - 30ms/step
Epoch 19/50
224/224 - 7s - loss: 2.7422 - accuracy10: 0.5679 - val_loss: 3.0936 - val_accuracy10: 0.4547 - 7s/epoch - 30ms/step
Epoch 20/50
224/224 - 7s - loss: 2.7237 - accuracy10: 0.5724 - val_loss: 3.0880 - val_accuracy10: 0.4603 - 7s/epoch - 30ms/step
Epoch 21/50
224/224 - 7s - loss: 2.7122 - accuracy10: 0.5754 - val_loss: 3.1023 - val_accuracy10: 0.4579 - 7s/epoch - 30ms/step
Epoch 22/50
224/224 - 7s - loss: 2.6985 - accuracy10: 0.5800 - val_loss: 3.0998 - val_accuracy10: 0.4597 - 7s/epoch - 30ms/step
Epoch 23/50
224/224 - 7s - loss: 2.6785 - accuracy10: 0.5831 - val_loss: 3.1138 - val_accuracy10: 0.4550 - 7s/epoch - 30ms/step
Epoch 24/50
224/224 - 7s - loss: 2.6646 - accuracy10: 0.5873 - val_loss: 3.1202 - val_accuracy10: 0.4553 - 7s/epoch - 30ms/step
Epoch 25/50
224/224 - 7s - loss: 2.6495 - accuracy10: 0.5900 - val_loss: 3.1141 - val_accuracy10: 0.4592 - 7s/epoch - 30ms/step
Epoch 26/50
224/224 - 7s - loss: 2.6300 - accuracy10: 0.5961 - val_loss: 3.1385 - val_accuracy10: 0.4566 - 7s/epoch - 30ms/step
Epoch 27/50
224/224 - 7s - loss: 2.6160 - accuracy10: 0.5983 - val_loss: 3.1520 - val_accuracy10: 0.4457 - 7s/epoch - 30ms/step
Epoch 28/50
224/224 - 7s - loss: 2.6048 - accuracy10: 0.5999 - val_loss: 3.1336 - val_accuracy10: 0.4565 - 7s/epoch - 30ms/step
testing model: results/LILAK/W8/deepOF_L2/h10
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0448067
{'0': {'precision': 0.4177595384661135, 'recall': 0.5858825982692107, 'f1-score': 0.48773967311581556, 'support': 47955}, '1': {'precision': 0.6523182163668609, 'recall': 0.3670905928312755, 'f1-score': 0.4698014743449384, 'support': 70138}, '2': {'precision': 0.39836755735028784, 'recall': 0.49508819886387906, 'f1-score': 0.4414926538501823, 'support': 46826}, 'accuracy': 0.4670535232447444, 'macro avg': {'precision': 0.4894817707277541, 'recall': 0.48268712998812174, 'f1-score': 0.46634460043697884, 'support': 164919}, 'weighted avg': {'precision': 0.5120083978629869, 'recall': 0.4670535232447444, 'f1-score': 0.466979710288462, 'support': 164919}}
[[28096  7221 12638]
 [22017 25747 22374]
 [17141  6502 23183]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9815414
{'0': {'precision': 0.46496069576852317, 'recall': 0.6525055744630912, 'f1-score': 0.5429952634405978, 'support': 17042}, '1': {'precision': 0.7153664687220369, 'recall': 0.3845380209016573, 'f1-score': 0.5001990785507081, 'support': 22869}, '2': {'precision': 0.48412508952017186, 'recall': 0.5880647219161399, 'f1-score': 0.5310568765057085, 'support': 17243}, 'accuracy': 0.5258424607201596, 'macro avg': {'precision': 0.5548174180035773, 'recall': 0.5417027724269629, 'f1-score': 0.5247504061656715, 'support': 57154}, 'weighted avg': {'precision': 0.570937202454557, 'recall': 0.5258424607201596, 'f1-score': 0.5222695126941027, 'support': 57154}}
[[11120  1860  4062]
 [ 7332  8794  6743]
 [ 5464  1639 10140]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0451126
{'0': {'precision': 0.42901822137612183, 'recall': 0.600038037276531, 'f1-score': 0.5003171582619728, 'support': 5258}, '1': {'precision': 0.6002372479240806, 'recall': 0.30792636543435264, 'f1-score': 0.40703871292106586, 'support': 6573}, '2': {'precision': 0.4424642802273775, 'recall': 0.532938564026647, 'f1-score': 0.4835054142533367, 'support': 5404}, 'accuracy': 0.4675950101537569, 'macro avg': {'precision': 0.49057324984252665, 'recall': 0.4803009889125103, 'f1-score': 0.46362042847879176, 'support': 17235}, 'weighted avg': {'precision': 0.4985328812851395, 'recall': 0.4675950101537569, 'f1-score': 0.45947179209728173, 'support': 17235}}
[[3155  726 1377]
 [2297 2024 2252]
 [1902  622 2880]]
training model: results/LILAK/W8/deepOF_L2/h20
Epoch 1/50
224/224 - 9s - loss: 3.2976 - accuracy20: 0.3800 - val_loss: 3.2953 - val_accuracy20: 0.3714 - 9s/epoch - 41ms/step
Epoch 2/50
224/224 - 7s - loss: 3.2232 - accuracy20: 0.4194 - val_loss: 3.2870 - val_accuracy20: 0.3767 - 7s/epoch - 32ms/step
Epoch 3/50
224/224 - 7s - loss: 3.1812 - accuracy20: 0.4376 - val_loss: 3.2668 - val_accuracy20: 0.3874 - 7s/epoch - 32ms/step
Epoch 4/50
224/224 - 7s - loss: 3.1471 - accuracy20: 0.4538 - val_loss: 3.2605 - val_accuracy20: 0.3949 - 7s/epoch - 32ms/step
Epoch 5/50
224/224 - 7s - loss: 3.1199 - accuracy20: 0.4612 - val_loss: 3.2573 - val_accuracy20: 0.3983 - 7s/epoch - 32ms/step
Epoch 6/50
224/224 - 7s - loss: 3.0951 - accuracy20: 0.4689 - val_loss: 3.2606 - val_accuracy20: 0.3950 - 7s/epoch - 31ms/step
Epoch 7/50
224/224 - 7s - loss: 3.0707 - accuracy20: 0.4783 - val_loss: 3.2564 - val_accuracy20: 0.4026 - 7s/epoch - 31ms/step
Epoch 8/50
224/224 - 7s - loss: 3.0527 - accuracy20: 0.4812 - val_loss: 3.2467 - val_accuracy20: 0.4071 - 7s/epoch - 31ms/step
Epoch 9/50
224/224 - 7s - loss: 3.0337 - accuracy20: 0.4862 - val_loss: 3.2428 - val_accuracy20: 0.4075 - 7s/epoch - 31ms/step
Epoch 10/50
224/224 - 7s - loss: 3.0135 - accuracy20: 0.4937 - val_loss: 3.2276 - val_accuracy20: 0.4147 - 7s/epoch - 31ms/step
Epoch 11/50
224/224 - 7s - loss: 2.9978 - accuracy20: 0.4969 - val_loss: 3.2260 - val_accuracy20: 0.4194 - 7s/epoch - 31ms/step
Epoch 12/50
224/224 - 7s - loss: 2.9826 - accuracy20: 0.5031 - val_loss: 3.2201 - val_accuracy20: 0.4233 - 7s/epoch - 31ms/step
Epoch 13/50
224/224 - 7s - loss: 2.9645 - accuracy20: 0.5065 - val_loss: 3.2076 - val_accuracy20: 0.4273 - 7s/epoch - 31ms/step
Epoch 14/50
224/224 - 7s - loss: 2.9470 - accuracy20: 0.5125 - val_loss: 3.2071 - val_accuracy20: 0.4299 - 7s/epoch - 31ms/step
Epoch 15/50
224/224 - 7s - loss: 2.9297 - accuracy20: 0.5164 - val_loss: 3.2018 - val_accuracy20: 0.4332 - 7s/epoch - 31ms/step
Epoch 16/50
224/224 - 7s - loss: 2.9108 - accuracy20: 0.5219 - val_loss: 3.2009 - val_accuracy20: 0.4331 - 7s/epoch - 30ms/step
Epoch 17/50
224/224 - 7s - loss: 2.8961 - accuracy20: 0.5250 - val_loss: 3.2093 - val_accuracy20: 0.4334 - 7s/epoch - 30ms/step
Epoch 18/50
224/224 - 7s - loss: 2.8824 - accuracy20: 0.5285 - val_loss: 3.1997 - val_accuracy20: 0.4295 - 7s/epoch - 31ms/step
Epoch 19/50
224/224 - 7s - loss: 2.8640 - accuracy20: 0.5345 - val_loss: 3.2059 - val_accuracy20: 0.4360 - 7s/epoch - 30ms/step
Epoch 20/50
224/224 - 7s - loss: 2.8502 - accuracy20: 0.5381 - val_loss: 3.1968 - val_accuracy20: 0.4411 - 7s/epoch - 30ms/step
Epoch 21/50
224/224 - 7s - loss: 2.8293 - accuracy20: 0.5451 - val_loss: 3.1859 - val_accuracy20: 0.4408 - 7s/epoch - 31ms/step
Epoch 22/50
224/224 - 7s - loss: 2.8157 - accuracy20: 0.5465 - val_loss: 3.2200 - val_accuracy20: 0.4332 - 7s/epoch - 30ms/step
Epoch 23/50
224/224 - 7s - loss: 2.7933 - accuracy20: 0.5535 - val_loss: 3.2049 - val_accuracy20: 0.4414 - 7s/epoch - 30ms/step
Epoch 24/50
224/224 - 7s - loss: 2.7843 - accuracy20: 0.5555 - val_loss: 3.2231 - val_accuracy20: 0.4314 - 7s/epoch - 31ms/step
Epoch 25/50
224/224 - 7s - loss: 2.7645 - accuracy20: 0.5593 - val_loss: 3.2378 - val_accuracy20: 0.4284 - 7s/epoch - 31ms/step
Epoch 26/50
224/224 - 7s - loss: 2.7492 - accuracy20: 0.5646 - val_loss: 3.2203 - val_accuracy20: 0.4384 - 7s/epoch - 30ms/step
Epoch 27/50
224/224 - 7s - loss: 2.7316 - accuracy20: 0.5690 - val_loss: 3.2269 - val_accuracy20: 0.4381 - 7s/epoch - 30ms/step
Epoch 28/50
224/224 - 7s - loss: 2.7186 - accuracy20: 0.5712 - val_loss: 3.2452 - val_accuracy20: 0.4327 - 7s/epoch - 30ms/step
Epoch 29/50
224/224 - 7s - loss: 2.6991 - accuracy20: 0.5771 - val_loss: 3.2427 - val_accuracy20: 0.4400 - 7s/epoch - 30ms/step
Epoch 30/50
224/224 - 7s - loss: 2.6780 - accuracy20: 0.5823 - val_loss: 3.2785 - val_accuracy20: 0.4248 - 7s/epoch - 31ms/step
Epoch 31/50
224/224 - 7s - loss: 2.6629 - accuracy20: 0.5856 - val_loss: 3.2699 - val_accuracy20: 0.4321 - 7s/epoch - 30ms/step
testing model: results/LILAK/W8/deepOF_L2/h20
Evaluating performance on  test set...
645/645 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0716506
{'0': {'precision': 0.44292836041358935, 'recall': 0.43893290395769674, 'f1-score': 0.4409215810610865, 'support': 54653}, '1': {'precision': 0.536519292883687, 'recall': 0.271274540793032, 'f1-score': 0.36034943258027274, 'support': 56946}, '2': {'precision': 0.3816704487226411, 'recall': 0.586721680420105, 'f1-score': 0.46248687964756147, 'support': 53320}, 'accuracy': 0.4288226341416089, 'macro avg': {'precision': 0.4537060340066392, 'recall': 0.4323097083902779, 'f1-score': 0.4212526310963069, 'support': 164919}, 'weighted avg': {'precision': 0.455439698640724, 'recall': 0.4288226341416089, 'f1-score': 0.42007255913664127, 'support': 164919}}
[[23989  6980 23684]
 [14500 15448 26998]
 [15671  6365 31284]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9962062
{'0': {'precision': 0.5013388571717273, 'recall': 0.5256661545796472, 'f1-score': 0.5132143780708559, 'support': 18877}, '1': {'precision': 0.645404868355688, 'recall': 0.3418407619849497, 'f1-score': 0.44695197468006054, 'support': 19003}, '2': {'precision': 0.4591881594372802, 'recall': 0.6503061118605376, 'f1-score': 0.5382864505046168, 'support': 19274}, 'accuracy': 0.5065787171501557, 'macro avg': {'precision': 0.5353106283215652, 'recall': 0.5059376761417115, 'f1-score': 0.49948426775184435, 'support': 57154}, 'weighted avg': {'precision': 0.5350245810474853, 'recall': 0.5065787171501557, 'f1-score': 0.49963798223597156, 'support': 57154}}
[[ 9923  1878  7076]
 [ 4821  6496  7686]
 [ 5049  1691 12534]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.059826
{'0': {'precision': 0.4586974443528442, 'recall': 0.4652173913043478, 'f1-score': 0.46193441261934415, 'support': 5980}, '1': {'precision': 0.47420333839150225, 'recall': 0.2378234398782344, 'f1-score': 0.31677648251393814, 'support': 5256}, '2': {'precision': 0.4212561518631357, 'recall': 0.5992665444240707, 'f1-score': 0.494736117800867, 'support': 5999}, 'accuracy': 0.4425297360023209, 'macro avg': {'precision': 0.4513856448691607, 'recall': 0.4341024585355509, 'f1-score': 0.42448233764471643, 'support': 17235}, 'weighted avg': {'precision': 0.4503939146412936, 'recall': 0.4425297360023209, 'f1-score': 0.42908424428455694, 'support': 17235}}
[[2782  723 2475]
 [1542 1250 2464]
 [1741  663 3595]]
training model: results/LILAK/W8/deepOF_L2/h30
Epoch 1/50
224/224 - 9s - loss: 3.3096 - accuracy30: 0.3682 - val_loss: 3.3456 - val_accuracy30: 0.3554 - 9s/epoch - 41ms/step
Epoch 2/50
224/224 - 7s - loss: 3.2542 - accuracy30: 0.4004 - val_loss: 3.3363 - val_accuracy30: 0.3615 - 7s/epoch - 30ms/step
Epoch 3/50
224/224 - 7s - loss: 3.2215 - accuracy30: 0.4157 - val_loss: 3.3465 - val_accuracy30: 0.3659 - 7s/epoch - 30ms/step
Epoch 4/50
224/224 - 7s - loss: 3.1992 - accuracy30: 0.4289 - val_loss: 3.3254 - val_accuracy30: 0.3710 - 7s/epoch - 30ms/step
Epoch 5/50
224/224 - 7s - loss: 3.1742 - accuracy30: 0.4398 - val_loss: 3.3544 - val_accuracy30: 0.3739 - 7s/epoch - 30ms/step
Epoch 6/50
224/224 - 7s - loss: 3.1641 - accuracy30: 0.4415 - val_loss: 3.3400 - val_accuracy30: 0.3785 - 7s/epoch - 31ms/step
Epoch 7/50
224/224 - 7s - loss: 3.1448 - accuracy30: 0.4487 - val_loss: 3.3357 - val_accuracy30: 0.3793 - 7s/epoch - 32ms/step
Epoch 8/50
224/224 - 7s - loss: 3.1258 - accuracy30: 0.4548 - val_loss: 3.3232 - val_accuracy30: 0.3852 - 7s/epoch - 31ms/step
Epoch 9/50
224/224 - 7s - loss: 3.1081 - accuracy30: 0.4604 - val_loss: 3.3256 - val_accuracy30: 0.3909 - 7s/epoch - 30ms/step
Epoch 10/50
224/224 - 7s - loss: 3.0931 - accuracy30: 0.4656 - val_loss: 3.3309 - val_accuracy30: 0.3870 - 7s/epoch - 30ms/step
Epoch 11/50
224/224 - 7s - loss: 3.0813 - accuracy30: 0.4685 - val_loss: 3.3347 - val_accuracy30: 0.3895 - 7s/epoch - 30ms/step
Epoch 12/50
224/224 - 7s - loss: 3.0663 - accuracy30: 0.4744 - val_loss: 3.3320 - val_accuracy30: 0.3937 - 7s/epoch - 30ms/step
Epoch 13/50
224/224 - 7s - loss: 3.0533 - accuracy30: 0.4755 - val_loss: 3.3285 - val_accuracy30: 0.3904 - 7s/epoch - 30ms/step
Epoch 14/50
224/224 - 7s - loss: 3.0369 - accuracy30: 0.4792 - val_loss: 3.3311 - val_accuracy30: 0.3923 - 7s/epoch - 30ms/step
Epoch 15/50
224/224 - 7s - loss: 3.0235 - accuracy30: 0.4852 - val_loss: 3.3236 - val_accuracy30: 0.3980 - 7s/epoch - 30ms/step
Epoch 16/50
224/224 - 7s - loss: 3.0100 - accuracy30: 0.4880 - val_loss: 3.3246 - val_accuracy30: 0.4024 - 7s/epoch - 30ms/step
Epoch 17/50
224/224 - 7s - loss: 2.9914 - accuracy30: 0.4947 - val_loss: 3.3337 - val_accuracy30: 0.3956 - 7s/epoch - 30ms/step
Epoch 18/50
224/224 - 7s - loss: 2.9791 - accuracy30: 0.4989 - val_loss: 3.3207 - val_accuracy30: 0.3998 - 7s/epoch - 31ms/step
Epoch 19/50
224/224 - 7s - loss: 2.9666 - accuracy30: 0.5029 - val_loss: 3.3154 - val_accuracy30: 0.4032 - 7s/epoch - 31ms/step
Epoch 20/50
224/224 - 7s - loss: 2.9494 - accuracy30: 0.5064 - val_loss: 3.3201 - val_accuracy30: 0.4016 - 7s/epoch - 30ms/step
Epoch 21/50
224/224 - 7s - loss: 2.9373 - accuracy30: 0.5098 - val_loss: 3.3304 - val_accuracy30: 0.3999 - 7s/epoch - 30ms/step
Epoch 22/50
224/224 - 7s - loss: 2.9253 - accuracy30: 0.5156 - val_loss: 3.3234 - val_accuracy30: 0.4013 - 7s/epoch - 30ms/step
Epoch 23/50
224/224 - 7s - loss: 2.9067 - accuracy30: 0.5194 - val_loss: 3.3256 - val_accuracy30: 0.4035 - 7s/epoch - 30ms/step
Epoch 24/50
224/224 - 7s - loss: 2.8929 - accuracy30: 0.5260 - val_loss: 3.3185 - val_accuracy30: 0.4039 - 7s/epoch - 30ms/step
Epoch 25/50
224/224 - 7s - loss: 2.8738 - accuracy30: 0.5306 - val_loss: 3.3249 - val_accuracy30: 0.4038 - 7s/epoch - 30ms/step
Epoch 26/50
224/224 - 7s - loss: 2.8564 - accuracy30: 0.5328 - val_loss: 3.3313 - val_accuracy30: 0.3999 - 7s/epoch - 30ms/step
Epoch 27/50
224/224 - 7s - loss: 2.8431 - accuracy30: 0.5367 - val_loss: 3.3337 - val_accuracy30: 0.4050 - 7s/epoch - 30ms/step
Epoch 28/50
224/224 - 7s - loss: 2.8300 - accuracy30: 0.5401 - val_loss: 3.3486 - val_accuracy30: 0.4043 - 7s/epoch - 30ms/step
Epoch 29/50
224/224 - 7s - loss: 2.8107 - accuracy30: 0.5450 - val_loss: 3.3559 - val_accuracy30: 0.4013 - 7s/epoch - 30ms/step
testing model: results/LILAK/W8/deepOF_L2/h30
Evaluating performance on  test set...
645/645 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.110225
{'0': {'precision': 0.3932616170857125, 'recall': 0.4590767644405163, 'f1-score': 0.4236281614517403, 'support': 54309}, '1': {'precision': 0.5240459385093911, 'recall': 0.15165048207578197, 'f1-score': 0.23522936272469763, 'support': 57771}, '2': {'precision': 0.36385505229767817, 'recall': 0.5839626033800791, 'f1-score': 0.4483515206114413, 'support': 52839}, 'accuracy': 0.39139820154136273, 'macro avg': {'precision': 0.42705420263092725, 'recall': 0.39822994996545913, 'f1-score': 0.36906968159595976, 'support': 164919}, 'weighted avg': {'precision': 0.4296535886361851, 'recall': 0.39139820154136273, 'f1-score': 0.36555341308059724, 'support': 164919}}
[[24932  4112 25265]
 [20328  8761 28682]
 [18138  3845 30856]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0508608
{'0': {'precision': 0.4384711779448622, 'recall': 0.5549270458870798, 'f1-score': 0.48987306328168756, 'support': 18916}, '1': {'precision': 0.6701319472211116, 'recall': 0.17769296013570823, 'f1-score': 0.28090170116483704, 'support': 18864}, '2': {'precision': 0.43307812278463065, 'recall': 0.6306390007226179, 'f1-score': 0.5135123775900475, 'support': 19374}, 'accuracy': 0.4560835637050775, 'macro avg': {'precision': 0.5138937493168682, 'recall': 0.45441966891513524, 'f1-score': 0.42809571401219076, 'support': 57154}, 'weighted avg': {'precision': 0.5131039893133201, 'recall': 0.4560835637050775, 'f1-score': 0.4289141155341616, 'support': 57154}}
[[10497   840  7579]
 [ 7097  3352  8415]
 [ 6346   810 12218]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1019564
{'0': {'precision': 0.4175550325349578, 'recall': 0.5028342780926975, 'f1-score': 0.456243854473943, 'support': 5998}, '1': {'precision': 0.42744063324538256, 'recall': 0.09015025041736227, 'f1-score': 0.14889705882352938, 'support': 5391}, '2': {'precision': 0.3855774647887324, 'recall': 0.5853575094081424, 'f1-score': 0.4649140683377488, 'support': 5846}, 'accuracy': 0.4017406440382942, 'macro avg': {'precision': 0.41019104352302427, 'recall': 0.39278067930606736, 'f1-score': 0.3566849938784071, 'support': 17235}, 'weighted avg': {'precision': 0.40980060331450324, 'recall': 0.4017406440382942, 'f1-score': 0.36304858292746367, 'support': 17235}}
[[3016  347 2635]
 [2087  486 2818]
 [2120  304 3422]]
training model: results/LILAK/W8/deepOF_L2/h50
Epoch 1/50
224/224 - 9s - loss: 3.3320 - accuracy50: 0.3563 - val_loss: 3.3470 - val_accuracy50: 0.3516 - 9s/epoch - 41ms/step
Epoch 2/50
224/224 - 7s - loss: 3.2832 - accuracy50: 0.3819 - val_loss: 3.3579 - val_accuracy50: 0.3514 - 7s/epoch - 30ms/step
Epoch 3/50
224/224 - 7s - loss: 3.2605 - accuracy50: 0.3911 - val_loss: 3.3468 - val_accuracy50: 0.3566 - 7s/epoch - 31ms/step
Epoch 4/50
224/224 - 7s - loss: 3.2438 - accuracy50: 0.3993 - val_loss: 3.3347 - val_accuracy50: 0.3581 - 7s/epoch - 31ms/step
Epoch 5/50
224/224 - 7s - loss: 3.2302 - accuracy50: 0.4064 - val_loss: 3.3559 - val_accuracy50: 0.3592 - 7s/epoch - 31ms/step
Epoch 6/50
224/224 - 7s - loss: 3.2184 - accuracy50: 0.4099 - val_loss: 3.3365 - val_accuracy50: 0.3659 - 7s/epoch - 31ms/step
Epoch 7/50
224/224 - 7s - loss: 3.2049 - accuracy50: 0.4176 - val_loss: 3.3578 - val_accuracy50: 0.3704 - 7s/epoch - 30ms/step
Epoch 8/50
224/224 - 7s - loss: 3.1846 - accuracy50: 0.4265 - val_loss: 3.3508 - val_accuracy50: 0.3686 - 7s/epoch - 30ms/step
Epoch 9/50
224/224 - 7s - loss: 3.1736 - accuracy50: 0.4339 - val_loss: 3.3479 - val_accuracy50: 0.3699 - 7s/epoch - 30ms/step
Epoch 10/50
224/224 - 7s - loss: 3.1637 - accuracy50: 0.4369 - val_loss: 3.3586 - val_accuracy50: 0.3735 - 7s/epoch - 30ms/step
Epoch 11/50
224/224 - 7s - loss: 3.1508 - accuracy50: 0.4409 - val_loss: 3.3647 - val_accuracy50: 0.3696 - 7s/epoch - 30ms/step
Epoch 12/50
224/224 - 7s - loss: 3.1352 - accuracy50: 0.4456 - val_loss: 3.3576 - val_accuracy50: 0.3730 - 7s/epoch - 30ms/step
Epoch 13/50
224/224 - 7s - loss: 3.1246 - accuracy50: 0.4508 - val_loss: 3.3611 - val_accuracy50: 0.3705 - 7s/epoch - 30ms/step
Epoch 14/50
224/224 - 7s - loss: 3.1114 - accuracy50: 0.4562 - val_loss: 3.3573 - val_accuracy50: 0.3683 - 7s/epoch - 30ms/step
testing model: results/LILAK/W8/deepOF_L2/h50
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1219906
{'0': {'precision': 0.3653119725667747, 'recall': 0.24326542262817996, 'f1-score': 0.29205084546106813, 'support': 56054}, '1': {'precision': 0.33657587548638135, 'recall': 0.009491934598924614, 'f1-score': 0.018463180362860192, 'support': 54678}, '2': {'precision': 0.33298690995636654, 'recall': 0.7745953826563567, 'f1-score': 0.46575342465753433, 'support': 54187}, 'accuracy': 0.3403367713847404, 'macro avg': {'precision': 0.34495825266984087, 'recall': 0.34245091329448707, 'f1-score': 0.2587558168271542, 'support': 164919}, 'weighted avg': {'precision': 0.3451637150353081, 'recall': 0.3403367713847404, 'f1-score': 0.25841733632433495, 'support': 164919}}
[[13636   523 41895]
 [11977   519 42182]
 [11714   500 41973]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1133218
{'0': {'precision': 0.36956993133357424, 'recall': 0.2712898604552449, 'f1-score': 0.3128939477388165, 'support': 18847}, '1': {'precision': 0.4633333333333333, 'recall': 0.01463465992840598, 'f1-score': 0.028373137374974485, 'support': 18996}, '2': {'precision': 0.34825253400126405, 'recall': 0.7703899331986951, 'f1-score': 0.47967112687409313, 'support': 19311}, 'accuracy': 0.3546208489344578, 'macro avg': {'precision': 0.3937185995560572, 'recall': 0.35210481786078196, 'f1-score': 0.273646070662628, 'support': 57154}, 'weighted avg': {'precision': 0.3935309721094286, 'recall': 0.3546208489344578, 'f1-score': 0.2746792434768188, 'support': 57154}}
[[ 5113   160 13574]
 [ 4450   278 14268]
 [ 4272   162 14877]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1110333
{'0': {'precision': 0.3738964447625865, 'recall': 0.257518488085456, 'f1-score': 0.3049824834565979, 'support': 6085}, '1': {'precision': 0.32231404958677684, 'recall': 0.007414448669201521, 'f1-score': 0.014495446942947406, 'support': 5260}, '2': {'precision': 0.35123423353710437, 'recall': 0.7706281833616299, 'f1-score': 0.48253867006856954, 'support': 5890}, 'accuracy': 0.3565419205105889, 'macro avg': {'precision': 0.34914824262882255, 'recall': 0.3451870400387625, 'f1-score': 0.26733886682270497, 'support': 17235}, 'weighted avg': {'precision': 0.3504091327380522, 'recall': 0.3565419205105889, 'f1-score': 0.2770070919325312, 'support': 17235}}
[[1567   43 4475]
 [1312   39 3909]
 [1312   39 4539]]
training model: results/LILAK/W8/deepOF_L2/h100
Epoch 1/50
224/224 - 9s - loss: 3.3473 - accuracy100: 0.3481 - val_loss: 3.3512 - val_accuracy100: 0.3403 - 9s/epoch - 39ms/step
Epoch 2/50
224/224 - 7s - loss: 3.3076 - accuracy100: 0.3643 - val_loss: 3.3564 - val_accuracy100: 0.3455 - 7s/epoch - 30ms/step
Epoch 3/50
224/224 - 7s - loss: 3.2898 - accuracy100: 0.3726 - val_loss: 3.3409 - val_accuracy100: 0.3460 - 7s/epoch - 30ms/step
Epoch 4/50
224/224 - 7s - loss: 3.2754 - accuracy100: 0.3831 - val_loss: 3.3371 - val_accuracy100: 0.3438 - 7s/epoch - 30ms/step
Epoch 5/50
224/224 - 7s - loss: 3.2646 - accuracy100: 0.3886 - val_loss: 3.3338 - val_accuracy100: 0.3477 - 7s/epoch - 30ms/step
Epoch 6/50
224/224 - 7s - loss: 3.2539 - accuracy100: 0.3972 - val_loss: 3.3310 - val_accuracy100: 0.3465 - 7s/epoch - 30ms/step
Epoch 7/50
224/224 - 7s - loss: 3.2433 - accuracy100: 0.4000 - val_loss: 3.3300 - val_accuracy100: 0.3504 - 7s/epoch - 30ms/step
Epoch 8/50
224/224 - 7s - loss: 3.2340 - accuracy100: 0.4058 - val_loss: 3.3256 - val_accuracy100: 0.3490 - 7s/epoch - 30ms/step
Epoch 9/50
224/224 - 7s - loss: 3.2225 - accuracy100: 0.4132 - val_loss: 3.3276 - val_accuracy100: 0.3483 - 7s/epoch - 30ms/step
Epoch 10/50
224/224 - 7s - loss: 3.2149 - accuracy100: 0.4122 - val_loss: 3.3286 - val_accuracy100: 0.3483 - 7s/epoch - 30ms/step
Epoch 11/50
224/224 - 7s - loss: 3.2051 - accuracy100: 0.4168 - val_loss: 3.3258 - val_accuracy100: 0.3556 - 7s/epoch - 30ms/step
Epoch 12/50
224/224 - 7s - loss: 3.1963 - accuracy100: 0.4248 - val_loss: 3.3314 - val_accuracy100: 0.3560 - 7s/epoch - 30ms/step
Epoch 13/50
224/224 - 7s - loss: 3.1869 - accuracy100: 0.4261 - val_loss: 3.3344 - val_accuracy100: 0.3535 - 7s/epoch - 30ms/step
Epoch 14/50
224/224 - 7s - loss: 3.1729 - accuracy100: 0.4288 - val_loss: 3.3345 - val_accuracy100: 0.3541 - 7s/epoch - 30ms/step
Epoch 15/50
224/224 - 7s - loss: 3.1657 - accuracy100: 0.4324 - val_loss: 3.3320 - val_accuracy100: 0.3601 - 7s/epoch - 30ms/step
Epoch 16/50
224/224 - 7s - loss: 3.1560 - accuracy100: 0.4365 - val_loss: 3.3339 - val_accuracy100: 0.3563 - 7s/epoch - 30ms/step
Epoch 17/50
224/224 - 7s - loss: 3.1464 - accuracy100: 0.4410 - val_loss: 3.3352 - val_accuracy100: 0.3590 - 7s/epoch - 30ms/step
Epoch 18/50
224/224 - 7s - loss: 3.1322 - accuracy100: 0.4479 - val_loss: 3.3371 - val_accuracy100: 0.3605 - 7s/epoch - 30ms/step
testing model: results/LILAK/W8/deepOF_L2/h100
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1128566
{'0': {'precision': 0.3591774172946737, 'recall': 0.2988786735398841, 'f1-score': 0.3262654097171863, 'support': 56451}, '1': {'precision': 0.3684627575277338, 'recall': 0.02614709851551957, 'f1-score': 0.048829150477790614, 'support': 53352}, '2': {'precision': 0.33987683844462546, 'recall': 0.7039698091298353, 'f1-score': 0.4584256387535076, 'support': 55116}, 'accuracy': 0.3460304755667934, 'macro avg': {'precision': 0.3558390044223443, 'recall': 0.34299852706174633, 'f1-score': 0.27784006631616154, 'support': 164919}, 'weighted avg': {'precision': 0.355731002801589, 'recall': 0.3460304755667934, 'f1-score': 0.28068160118466823, 'support': 164919}}
[[16872  1196 38383]
 [14981  1395 36976]
 [15121  1195 38800]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1046231
{'0': {'precision': 0.36877172653534185, 'recall': 0.33308912030980165, 'f1-score': 0.35002337155269597, 'support': 19109}, '1': {'precision': 0.42480983031012287, 'recall': 0.038414730938144875, 'f1-score': 0.0704580745341615, 'support': 18899}, '2': {'precision': 0.35299201257038104, 'recall': 0.7040112817298653, 'f1-score': 0.470216811149291, 'support': 19146}, 'accuracy': 0.3599048185603807, 'macro avg': {'precision': 0.3821911898052819, 'recall': 0.3585050443259372, 'f1-score': 0.29689941907871614, 'support': 57154}, 'weighted avg': {'precision': 0.38201569405583813, 'recall': 0.3599048185603807, 'f1-score': 0.297843629910171, 'support': 57154}}
[[ 6365   497 12247]
 [ 5714   726 12459]
 [ 5181   486 13479]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1082197
{'0': {'precision': 0.3582443653618031, 'recall': 0.299009900990099, 'f1-score': 0.3259579060982191, 'support': 6060}, '1': {'precision': 0.3316582914572864, 'recall': 0.024603914259086673, 'f1-score': 0.045809474232170744, 'support': 5365}, '2': {'precision': 0.34561507768061805, 'recall': 0.7006884681583476, 'f1-score': 0.4629029507078288, 'support': 5810}, 'accuracy': 0.34899912967798086, 'macro avg': {'precision': 0.34517257816656927, 'recall': 0.3414340944691778, 'f1-score': 0.2782234436794062, 'support': 17235}, 'weighted avg': {'precision': 0.3457111220821154, 'recall': 0.34899912967798086, 'f1-score': 0.2849166744312903, 'support': 17235}}
[[1812  146 4102]
 [1627  132 3606]
 [1619  120 4071]]
training model: results/LILAK/W8/deepOF_L2/h200
Epoch 1/50
224/224 - 9s - loss: 3.3422 - accuracy200: 0.3542 - val_loss: 3.3793 - val_accuracy200: 0.3449 - 9s/epoch - 42ms/step
Epoch 2/50
224/224 - 7s - loss: 3.3061 - accuracy200: 0.3654 - val_loss: 3.3931 - val_accuracy200: 0.3449 - 7s/epoch - 31ms/step
Epoch 3/50
224/224 - 7s - loss: 3.2926 - accuracy200: 0.3724 - val_loss: 3.3622 - val_accuracy200: 0.3469 - 7s/epoch - 31ms/step
Epoch 4/50
224/224 - 7s - loss: 3.2802 - accuracy200: 0.3780 - val_loss: 3.3518 - val_accuracy200: 0.3429 - 7s/epoch - 31ms/step
Epoch 5/50
224/224 - 7s - loss: 3.2714 - accuracy200: 0.3862 - val_loss: 3.3492 - val_accuracy200: 0.3467 - 7s/epoch - 30ms/step
Epoch 6/50
224/224 - 7s - loss: 3.2654 - accuracy200: 0.3880 - val_loss: 3.3534 - val_accuracy200: 0.3457 - 7s/epoch - 30ms/step
Epoch 7/50
224/224 - 7s - loss: 3.2552 - accuracy200: 0.3900 - val_loss: 3.3582 - val_accuracy200: 0.3429 - 7s/epoch - 30ms/step
Epoch 8/50
224/224 - 7s - loss: 3.2477 - accuracy200: 0.3958 - val_loss: 3.3558 - val_accuracy200: 0.3438 - 7s/epoch - 30ms/step
Epoch 9/50
224/224 - 7s - loss: 3.2424 - accuracy200: 0.3995 - val_loss: 3.3453 - val_accuracy200: 0.3509 - 7s/epoch - 31ms/step
Epoch 10/50
224/224 - 7s - loss: 3.2348 - accuracy200: 0.4035 - val_loss: 3.3677 - val_accuracy200: 0.3493 - 7s/epoch - 30ms/step
Epoch 11/50
224/224 - 7s - loss: 3.2276 - accuracy200: 0.4047 - val_loss: 3.3548 - val_accuracy200: 0.3442 - 7s/epoch - 31ms/step
Epoch 12/50
224/224 - 7s - loss: 3.2161 - accuracy200: 0.4115 - val_loss: 3.3747 - val_accuracy200: 0.3496 - 7s/epoch - 30ms/step
Epoch 13/50
224/224 - 7s - loss: 3.2056 - accuracy200: 0.4168 - val_loss: 3.3624 - val_accuracy200: 0.3504 - 7s/epoch - 30ms/step
Epoch 14/50
224/224 - 7s - loss: 3.1983 - accuracy200: 0.4201 - val_loss: 3.3711 - val_accuracy200: 0.3500 - 7s/epoch - 30ms/step
Epoch 15/50
224/224 - 7s - loss: 3.1894 - accuracy200: 0.4238 - val_loss: 3.3748 - val_accuracy200: 0.3472 - 7s/epoch - 30ms/step
Epoch 16/50
224/224 - 7s - loss: 3.1789 - accuracy200: 0.4291 - val_loss: 3.3834 - val_accuracy200: 0.3520 - 7s/epoch - 30ms/step
Epoch 17/50
224/224 - 7s - loss: 3.1669 - accuracy200: 0.4315 - val_loss: 3.3844 - val_accuracy200: 0.3510 - 7s/epoch - 30ms/step
Epoch 18/50
224/224 - 7s - loss: 3.1532 - accuracy200: 0.4360 - val_loss: 3.3992 - val_accuracy200: 0.3485 - 7s/epoch - 30ms/step
Epoch 19/50
224/224 - 7s - loss: 3.1427 - accuracy200: 0.4414 - val_loss: 3.3951 - val_accuracy200: 0.3520 - 7s/epoch - 30ms/step
testing model: results/LILAK/W8/deepOF_L2/h200
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1253012
{'0': {'precision': 0.3334297281665703, 'recall': 0.23050360758228378, 'f1-score': 0.2725739031388014, 'support': 55023}, '1': {'precision': 0.3474264705882353, 'recall': 0.01038499578739148, 'f1-score': 0.02016717054952872, 'support': 54598}, '2': {'precision': 0.3364418079186261, 'recall': 0.762034793301747, 'f1-score': 0.46679258032534465, 'support': 55298}, 'accuracy': 0.3358557837483856, 'macro avg': {'precision': 0.33909933555781063, 'recall': 0.3343077988904741, 'f1-score': 0.25317788467122493, 'support': 164919}, 'weighted avg': {'precision': 0.3390734449540069, 'recall': 0.3358557837483856, 'f1-score': 0.2541345579157062, 'support': 164919}}
[[12683   550 41790]
 [12711   567 41320]
 [12644   515 42139]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1140146
{'0': {'precision': 0.36932890711449584, 'recall': 0.29681941828834485, 'f1-score': 0.3291278749383683, 'support': 19116}, '1': {'precision': 0.41875, 'recall': 0.010680127523910734, 'f1-score': 0.02082901554404145, 'support': 18820}, '2': {'precision': 0.34390356079494566, 'recall': 0.7392548652305131, 'f1-score': 0.46942787754630017, 'support': 19218}, 'accuracy': 0.35136648353571054, 'macro avg': {'precision': 0.37732748930314713, 'recall': 0.3489181370142562, 'f1-score': 0.27312825600956997, 'support': 57154}, 'weighted avg': {'precision': 0.3770533124498367, 'recall': 0.35136648353571054, 'f1-score': 0.27478523778817765, 'support': 57154}}
[[ 5674   141 13301]
 [ 4816   201 13803]
 [ 4873   138 14207]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1131309
{'0': {'precision': 0.37023756163155536, 'recall': 0.26901156163491285, 'f1-score': 0.3116099217202678, 'support': 6141}, '1': {'precision': 0.3082706766917293, 'recall': 0.007834893942289319, 'f1-score': 0.015281401416325013, 'support': 5233}, '2': {'precision': 0.34240506329113923, 'recall': 0.7384405391571405, 'f1-score': 0.4678666018053078, 'support': 5861}, 'accuracy': 0.3493472584856397, 'macro avg': {'precision': 0.34030443387147463, 'recall': 0.33842899824478084, 'f1-score': 0.2649193083139669, 'support': 17235}, 'weighted avg': {'precision': 0.3419579572414603, 'recall': 0.3493472584856397, 'f1-score': 0.27477402124030764, 'support': 17235}}
[[1652   62 4427]
 [1307   41 3885]
 [1503   30 4328]]
training model: results/LILAK/W8/deepOF_L2/h300
Epoch 1/50
224/224 - 9s - loss: 3.3449 - accuracy300: 0.3527 - val_loss: 3.3451 - val_accuracy300: 0.3413 - 9s/epoch - 40ms/step
Epoch 2/50
224/224 - 7s - loss: 3.3080 - accuracy300: 0.3667 - val_loss: 3.3404 - val_accuracy300: 0.3449 - 7s/epoch - 30ms/step
Epoch 3/50
224/224 - 7s - loss: 3.2921 - accuracy300: 0.3755 - val_loss: 3.3274 - val_accuracy300: 0.3457 - 7s/epoch - 30ms/step
Epoch 4/50
224/224 - 7s - loss: 3.2821 - accuracy300: 0.3780 - val_loss: 3.3328 - val_accuracy300: 0.3408 - 7s/epoch - 30ms/step
Epoch 5/50
224/224 - 7s - loss: 3.2705 - accuracy300: 0.3857 - val_loss: 3.3289 - val_accuracy300: 0.3466 - 7s/epoch - 30ms/step
Epoch 6/50
224/224 - 7s - loss: 3.2609 - accuracy300: 0.3902 - val_loss: 3.3260 - val_accuracy300: 0.3448 - 7s/epoch - 30ms/step
Epoch 7/50
224/224 - 7s - loss: 3.2545 - accuracy300: 0.3931 - val_loss: 3.3287 - val_accuracy300: 0.3409 - 7s/epoch - 30ms/step
Epoch 8/50
224/224 - 7s - loss: 3.2432 - accuracy300: 0.3988 - val_loss: 3.3322 - val_accuracy300: 0.3413 - 7s/epoch - 30ms/step
Epoch 9/50
224/224 - 7s - loss: 3.2447 - accuracy300: 0.3949 - val_loss: 3.3422 - val_accuracy300: 0.3419 - 7s/epoch - 30ms/step
Epoch 10/50
224/224 - 7s - loss: 3.2383 - accuracy300: 0.3971 - val_loss: 3.3281 - val_accuracy300: 0.3417 - 7s/epoch - 30ms/step
Epoch 11/50
224/224 - 7s - loss: 3.2265 - accuracy300: 0.4021 - val_loss: 3.3316 - val_accuracy300: 0.3395 - 7s/epoch - 30ms/step
Epoch 12/50
224/224 - 7s - loss: 3.2208 - accuracy300: 0.4078 - val_loss: 3.3388 - val_accuracy300: 0.3391 - 7s/epoch - 30ms/step
Epoch 13/50
224/224 - 7s - loss: 3.2156 - accuracy300: 0.4084 - val_loss: 3.3292 - val_accuracy300: 0.3447 - 7s/epoch - 30ms/step
Epoch 14/50
224/224 - 7s - loss: 3.2076 - accuracy300: 0.4144 - val_loss: 3.3408 - val_accuracy300: 0.3411 - 7s/epoch - 30ms/step
Epoch 15/50
224/224 - 7s - loss: 3.1982 - accuracy300: 0.4169 - val_loss: 3.3268 - val_accuracy300: 0.3490 - 7s/epoch - 30ms/step
Epoch 16/50
224/224 - 7s - loss: 3.1868 - accuracy300: 0.4230 - val_loss: 3.3464 - val_accuracy300: 0.3357 - 7s/epoch - 30ms/step
testing model: results/LILAK/W8/deepOF_L2/h300
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1075208
{'0': {'precision': 0.3455838412812239, 'recall': 0.4086853589159202, 'f1-score': 0.37449509053967645, 'support': 56601}, '1': {'precision': 0.37726586102719034, 'recall': 0.01969792570391987, 'f1-score': 0.03744097144142119, 'support': 50716}, '2': {'precision': 0.3456862642261499, 'recall': 0.5721329120516648, 'f1-score': 0.43097484585155976, 'support': 57602}, 'accuracy': 0.3461517472213632, 'macro avg': {'precision': 0.3561786555115214, 'recall': 0.3335053988905017, 'f1-score': 0.2809703026108858, 'support': 164919}, 'weighted avg': {'precision': 0.3553624906782616, 'recall': 0.3461517472213632, 'f1-score': 0.290570922683262, 'support': 164919}}
[[23132   857 32612]
 [19950   999 29767]
 [23854   792 32956]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1016976
{'0': {'precision': 0.3551164492660037, 'recall': 0.4319526627218935, 'f1-score': 0.3897840570807542, 'support': 19097}, '1': {'precision': 0.45588235294117646, 'recall': 0.029723539125339583, 'f1-score': 0.05580837125568835, 'support': 18773}, '2': {'precision': 0.35090670010091435, 'recall': 0.5950528935905414, 'f1-score': 0.4414735019717226, 'support': 19284}, 'accuracy': 0.3548658011687721, 'macro avg': {'precision': 0.38730183410269814, 'recall': 0.3522430318125915, 'f1-score': 0.29568864343605505, 'support': 57154}, 'weighted avg': {'precision': 0.38679397851670244, 'recall': 0.3548658011687721, 'f1-score': 0.2975254873443136, 'support': 57154}}
[[ 8249   316 10532]
 [ 7521   558 10694]
 [ 7459   350 11475]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1067196
{'0': {'precision': 0.35817978782802906, 'recall': 0.41682910981156596, 'f1-score': 0.38528528528528533, 'support': 6156}, '1': {'precision': 0.3125, 'recall': 0.017810273715785526, 'f1-score': 0.033699893579283435, 'support': 5334}, '2': {'precision': 0.3386915122350773, 'recall': 0.575805047867711, 'f1-score': 0.4265085095410005, 'support': 5745}, 'accuracy': 0.34633014215259644, 'macro avg': {'precision': 0.33645710002103546, 'recall': 0.3368148104650208, 'f1-score': 0.28183122946852307, 'support': 17235}, 'weighted avg': {'precision': 0.337546417850877, 'recall': 0.34633014215259644, 'f1-score': 0.29021542418805696, 'support': 17235}}
[[2566  124 3466]
 [2246   95 2993]
 [2352   85 3308]]
training model: results/LILAK/W8/deepOF_L2/h500
Epoch 1/50
224/224 - 9s - loss: 3.3319 - accuracy500: 0.3592 - val_loss: 3.3589 - val_accuracy500: 0.3516 - 9s/epoch - 40ms/step
Epoch 2/50
224/224 - 7s - loss: 3.3009 - accuracy500: 0.3677 - val_loss: 3.3870 - val_accuracy500: 0.3422 - 7s/epoch - 31ms/step
Epoch 3/50
224/224 - 7s - loss: 3.2912 - accuracy500: 0.3748 - val_loss: 3.3668 - val_accuracy500: 0.3453 - 7s/epoch - 30ms/step
Epoch 4/50
224/224 - 7s - loss: 3.2751 - accuracy500: 0.3812 - val_loss: 3.3648 - val_accuracy500: 0.3365 - 7s/epoch - 30ms/step
Epoch 5/50
224/224 - 7s - loss: 3.2653 - accuracy500: 0.3879 - val_loss: 3.3591 - val_accuracy500: 0.3438 - 7s/epoch - 30ms/step
Epoch 6/50
224/224 - 7s - loss: 3.2550 - accuracy500: 0.3888 - val_loss: 3.3648 - val_accuracy500: 0.3384 - 7s/epoch - 30ms/step
Epoch 7/50
224/224 - 7s - loss: 3.2477 - accuracy500: 0.3923 - val_loss: 3.3626 - val_accuracy500: 0.3396 - 7s/epoch - 30ms/step
Epoch 8/50
224/224 - 7s - loss: 3.2401 - accuracy500: 0.3969 - val_loss: 3.3707 - val_accuracy500: 0.3396 - 7s/epoch - 30ms/step
Epoch 9/50
224/224 - 7s - loss: 3.2317 - accuracy500: 0.3989 - val_loss: 3.3944 - val_accuracy500: 0.3388 - 7s/epoch - 30ms/step
Epoch 10/50
224/224 - 7s - loss: 3.2264 - accuracy500: 0.4056 - val_loss: 3.3815 - val_accuracy500: 0.3332 - 7s/epoch - 30ms/step
Epoch 11/50
224/224 - 7s - loss: 3.2129 - accuracy500: 0.4071 - val_loss: 3.3977 - val_accuracy500: 0.3357 - 7s/epoch - 30ms/step
testing model: results/LILAK/W8/deepOF_L2/h500
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0859215
{'0': {'precision': 0.3876536791241055, 'recall': 0.3994359273323144, 'f1-score': 0.3934566167169785, 'support': 63467}, '1': {'precision': 0.2517114270668773, 'recall': 0.012510141589677825, 'f1-score': 0.023835643761843023, 'support': 38209}, '2': {'precision': 0.38615504384167826, 'recall': 0.5960817798017172, 'f1-score': 0.4686853114684802, 'support': 63243}, 'accuracy': 0.38520121999284496, 'macro avg': {'precision': 0.3418400500108871, 'recall': 0.3360092829079031, 'f1-score': 0.29532585731576727, 'support': 164919}, 'weighted avg': {'precision': 0.35558341614639416, 'recall': 0.38520121999284496, 'f1-score': 0.3366701978478758, 'support': 164919}}
[[25351   801 37315]
 [15120   478 22611]
 [24925   620 37698]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1282865
{'0': {'precision': 0.3404103160059, 'recall': 0.40332574273155747, 'f1-score': 0.36920690323831684, 'support': 18883}, '1': {'precision': 0.326271186440678, 'recall': 0.008154620068837702, 'f1-score': 0.015911556542852714, 'support': 18885}, '2': {'precision': 0.34396222565507595, 'recall': 0.6087382647271227, 'f1-score': 0.43955675575006986, 'support': 19386}, 'accuracy': 0.34242572698323825, 'macro avg': {'precision': 0.33688124270055136, 'recall': 0.34007287584250595, 'f1-score': 0.2748917385104131, 'support': 57154}, 'weighted avg': {'precision': 0.33694318962138986, 'recall': 0.34242572698323825, 'f1-score': 0.27633185719515285, 'support': 57154}}
[[ 7616   146 11121]
 [ 7344   154 11387]
 [ 7413   172 11801]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1182119
{'0': {'precision': 0.3815924032140248, 'recall': 0.39527845036319614, 'f1-score': 0.38831487400579795, 'support': 6608}, '1': {'precision': 0.20567375886524822, 'recall': 0.005815119310206537, 'f1-score': 0.011310452418096726, 'support': 4987}, '2': {'precision': 0.3274465801541614, 'recall': 0.5950354609929078, 'f1-score': 0.42243061237334006, 'support': 5640}, 'accuracy': 0.34795474325500436, 'macro avg': {'precision': 0.3049042474111448, 'recall': 0.33204301022210353, 'f1-score': 0.27401864626574496, 'support': 17235}, 'weighted avg': {'precision': 0.3129710674771534, 'recall': 0.34795474325500436, 'f1-score': 0.2903915617885117, 'support': 17235}}
[[2612   67 3929]
 [1994   29 2964]
 [2239   45 3356]]
training model: results/LILAK/W8/deepOF_L2/h1000
Epoch 1/50
224/224 - 9s - loss: 3.3375 - accuracy1000: 0.3602 - val_loss: 3.3280 - val_accuracy1000: 0.3584 - 9s/epoch - 40ms/step
Epoch 2/50
224/224 - 7s - loss: 3.3067 - accuracy1000: 0.3730 - val_loss: 3.3134 - val_accuracy1000: 0.3626 - 7s/epoch - 33ms/step
Epoch 3/50
224/224 - 7s - loss: 3.2856 - accuracy1000: 0.3800 - val_loss: 3.3095 - val_accuracy1000: 0.3621 - 7s/epoch - 31ms/step
Epoch 4/50
224/224 - 7s - loss: 3.2743 - accuracy1000: 0.3833 - val_loss: 3.3023 - val_accuracy1000: 0.3647 - 7s/epoch - 31ms/step
Epoch 5/50
224/224 - 7s - loss: 3.2638 - accuracy1000: 0.3872 - val_loss: 3.3016 - val_accuracy1000: 0.3656 - 7s/epoch - 31ms/step
Epoch 6/50
224/224 - 7s - loss: 3.2576 - accuracy1000: 0.3900 - val_loss: 3.2997 - val_accuracy1000: 0.3701 - 7s/epoch - 31ms/step
Epoch 7/50
224/224 - 7s - loss: 3.2479 - accuracy1000: 0.3919 - val_loss: 3.3007 - val_accuracy1000: 0.3634 - 7s/epoch - 31ms/step
Epoch 8/50
224/224 - 7s - loss: 3.2386 - accuracy1000: 0.3957 - val_loss: 3.2954 - val_accuracy1000: 0.3748 - 7s/epoch - 31ms/step
Epoch 9/50
224/224 - 7s - loss: 3.2329 - accuracy1000: 0.4000 - val_loss: 3.2981 - val_accuracy1000: 0.3679 - 7s/epoch - 31ms/step
Epoch 10/50
224/224 - 7s - loss: 3.2234 - accuracy1000: 0.4031 - val_loss: 3.2991 - val_accuracy1000: 0.3675 - 7s/epoch - 31ms/step
Epoch 11/50
224/224 - 7s - loss: 3.2168 - accuracy1000: 0.4064 - val_loss: 3.3034 - val_accuracy1000: 0.3648 - 7s/epoch - 31ms/step
Epoch 12/50
224/224 - 7s - loss: 3.2090 - accuracy1000: 0.4091 - val_loss: 3.3024 - val_accuracy1000: 0.3638 - 7s/epoch - 31ms/step
Epoch 13/50
224/224 - 7s - loss: 3.2010 - accuracy1000: 0.4142 - val_loss: 3.3076 - val_accuracy1000: 0.3613 - 7s/epoch - 30ms/step
Epoch 14/50
224/224 - 7s - loss: 3.1926 - accuracy1000: 0.4173 - val_loss: 3.3043 - val_accuracy1000: 0.3683 - 7s/epoch - 30ms/step
Epoch 15/50
224/224 - 7s - loss: 3.1825 - accuracy1000: 0.4214 - val_loss: 3.3014 - val_accuracy1000: 0.3669 - 7s/epoch - 30ms/step
Epoch 16/50
224/224 - 7s - loss: 3.1725 - accuracy1000: 0.4242 - val_loss: 3.3139 - val_accuracy1000: 0.3606 - 7s/epoch - 30ms/step
Epoch 17/50
224/224 - 7s - loss: 3.1668 - accuracy1000: 0.4273 - val_loss: 3.3131 - val_accuracy1000: 0.3572 - 7s/epoch - 30ms/step
Epoch 18/50
224/224 - 7s - loss: 3.1608 - accuracy1000: 0.4309 - val_loss: 3.3209 - val_accuracy1000: 0.3500 - 7s/epoch - 30ms/step
testing model: results/LILAK/W8/deepOF_L2/h1000
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1047963
{'0': {'precision': 0.36788738039176394, 'recall': 0.6062912813738441, 'f1-score': 0.457917874848003, 'support': 60560}, '1': {'precision': 0.23873570948217887, 'recall': 0.0075376350935303735, 'f1-score': 0.014613864646797299, 'support': 47097}, '2': {'precision': 0.34886133245320383, 'recall': 0.3876392721176347, 'f1-score': 0.36722944188470413, 'support': 57262}, 'accuracy': 0.3593824847349305, 'macro avg': {'precision': 0.31849480744238223, 'recall': 0.3338227295283364, 'f1-score': 0.2799203937931682, 'support': 164919}, 'weighted avg': {'precision': 0.32439860225288025, 'recall': 0.3593824847349305, 'f1-score': 0.29983245099271283, 'support': 164919}}
[[36717   719 23124]
 [28436   355 18306]
 [34652   413 22197]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1146079
{'0': {'precision': 0.3412656208455198, 'recall': 0.5572560512319549, 'f1-score': 0.42330049058003877, 'support': 18426}, '1': {'precision': 0.5441441441441441, 'recall': 0.015729166666666666, 'f1-score': 0.03057453809162237, 'support': 19200}, '2': {'precision': 0.36596129908339936, 'recall': 0.4968250716919295, 'f1-score': 0.4214687547514064, 'support': 19528}, 'accuracy': 0.35469083528711903, 'macro avg': {'precision': 0.41712368802435446, 'recall': 0.356603429863517, 'f1-score': 0.2917812611410225, 'support': 57154}, 'weighted avg': {'precision': 0.41785737036371445, 'recall': 0.35469083528711903, 'f1-score': 0.2907444415714107, 'support': 57154}}
[[10268   125  8033]
 [10122   302  8776]
 [ 9698   128  9702]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0960933
{'0': {'precision': 0.4050233882448648, 'recall': 0.571367092239277, 'f1-score': 0.4740255876227314, 'support': 6971}, '1': {'precision': 0.1937984496124031, 'recall': 0.005360205831903945, 'f1-score': 0.010431879824744418, 'support': 4664}, '2': {'precision': 0.3303080308030803, 'recall': 0.42892857142857144, 'f1-score': 0.3732131758856433, 'support': 5600}, 'accuracy': 0.3719176095155207, 'macro avg': {'precision': 0.30970995622011604, 'recall': 0.33521862316658413, 'f1-score': 0.28589021444437307, 'support': 17235}, 'weighted avg': {'precision': 0.3235868280211459, 'recall': 0.3719176095155207, 'f1-score': 0.31581551748072356, 'support': 17235}}
[[3983   52 2936]
 [2705   25 1934]
 [3146   52 2402]]
training model: results/LILAK/W8/deepVOL_L2/h10
Epoch 1/50
224/224 - 9s - loss: 3.3106 - accuracy10: 0.3823 - val_loss: 3.3822 - val_accuracy10: 0.3264 - 9s/epoch - 39ms/step
Epoch 2/50
224/224 - 6s - loss: 3.2333 - accuracy10: 0.4102 - val_loss: 3.3363 - val_accuracy10: 0.3452 - 6s/epoch - 27ms/step
Epoch 3/50
224/224 - 6s - loss: 3.1895 - accuracy10: 0.4258 - val_loss: 3.3311 - val_accuracy10: 0.3590 - 6s/epoch - 27ms/step
Epoch 4/50
224/224 - 6s - loss: 3.1554 - accuracy10: 0.4399 - val_loss: 3.3002 - val_accuracy10: 0.3632 - 6s/epoch - 27ms/step
Epoch 5/50
224/224 - 6s - loss: 3.1327 - accuracy10: 0.4477 - val_loss: 3.2652 - val_accuracy10: 0.3865 - 6s/epoch - 27ms/step
Epoch 6/50
224/224 - 6s - loss: 3.1053 - accuracy10: 0.4582 - val_loss: 3.2681 - val_accuracy10: 0.3781 - 6s/epoch - 27ms/step
Epoch 7/50
224/224 - 6s - loss: 3.0950 - accuracy10: 0.4634 - val_loss: 3.2327 - val_accuracy10: 0.4080 - 6s/epoch - 27ms/step
Epoch 8/50
224/224 - 6s - loss: 3.0768 - accuracy10: 0.4722 - val_loss: 3.2474 - val_accuracy10: 0.3913 - 6s/epoch - 27ms/step
Epoch 9/50
224/224 - 6s - loss: 3.0693 - accuracy10: 0.4752 - val_loss: 3.2367 - val_accuracy10: 0.3993 - 6s/epoch - 27ms/step
Epoch 10/50
224/224 - 6s - loss: 3.0469 - accuracy10: 0.4819 - val_loss: 3.2273 - val_accuracy10: 0.4062 - 6s/epoch - 27ms/step
Epoch 11/50
224/224 - 6s - loss: 3.0258 - accuracy10: 0.4875 - val_loss: 3.2058 - val_accuracy10: 0.4178 - 6s/epoch - 27ms/step
Epoch 12/50
224/224 - 6s - loss: 3.0157 - accuracy10: 0.4888 - val_loss: 3.1962 - val_accuracy10: 0.4198 - 6s/epoch - 27ms/step
Epoch 13/50
224/224 - 6s - loss: 2.9955 - accuracy10: 0.4969 - val_loss: 3.1781 - val_accuracy10: 0.4344 - 6s/epoch - 27ms/step
Epoch 14/50
224/224 - 6s - loss: 2.9781 - accuracy10: 0.5023 - val_loss: 3.1729 - val_accuracy10: 0.4346 - 6s/epoch - 27ms/step
Epoch 15/50
224/224 - 6s - loss: 2.9557 - accuracy10: 0.5082 - val_loss: 3.1591 - val_accuracy10: 0.4480 - 6s/epoch - 28ms/step
Epoch 16/50
224/224 - 6s - loss: 2.9401 - accuracy10: 0.5142 - val_loss: 3.1551 - val_accuracy10: 0.4473 - 6s/epoch - 27ms/step
Epoch 17/50
224/224 - 6s - loss: 2.9239 - accuracy10: 0.5167 - val_loss: 3.1465 - val_accuracy10: 0.4496 - 6s/epoch - 28ms/step
Epoch 18/50
224/224 - 6s - loss: 2.9115 - accuracy10: 0.5195 - val_loss: 3.1393 - val_accuracy10: 0.4485 - 6s/epoch - 27ms/step
Epoch 19/50
224/224 - 6s - loss: 2.8939 - accuracy10: 0.5243 - val_loss: 3.1417 - val_accuracy10: 0.4485 - 6s/epoch - 27ms/step
Epoch 20/50
224/224 - 6s - loss: 2.8831 - accuracy10: 0.5288 - val_loss: 3.1303 - val_accuracy10: 0.4534 - 6s/epoch - 27ms/step
Epoch 21/50
224/224 - 6s - loss: 2.8668 - accuracy10: 0.5319 - val_loss: 3.1269 - val_accuracy10: 0.4579 - 6s/epoch - 27ms/step
Epoch 22/50
224/224 - 6s - loss: 2.8567 - accuracy10: 0.5345 - val_loss: 3.1368 - val_accuracy10: 0.4570 - 6s/epoch - 27ms/step
Epoch 23/50
224/224 - 6s - loss: 2.8412 - accuracy10: 0.5398 - val_loss: 3.1179 - val_accuracy10: 0.4679 - 6s/epoch - 27ms/step
Epoch 24/50
224/224 - 6s - loss: 2.8301 - accuracy10: 0.5408 - val_loss: 3.1346 - val_accuracy10: 0.4591 - 6s/epoch - 27ms/step
Epoch 25/50
224/224 - 6s - loss: 2.8178 - accuracy10: 0.5433 - val_loss: 3.1256 - val_accuracy10: 0.4667 - 6s/epoch - 27ms/step
Epoch 26/50
224/224 - 6s - loss: 2.8013 - accuracy10: 0.5490 - val_loss: 3.1341 - val_accuracy10: 0.4635 - 6s/epoch - 27ms/step
Epoch 27/50
224/224 - 6s - loss: 2.7956 - accuracy10: 0.5495 - val_loss: 3.1376 - val_accuracy10: 0.4632 - 6s/epoch - 27ms/step
Epoch 28/50
224/224 - 6s - loss: 2.7849 - accuracy10: 0.5522 - val_loss: 3.1327 - val_accuracy10: 0.4649 - 6s/epoch - 27ms/step
Epoch 29/50
224/224 - 6s - loss: 2.7723 - accuracy10: 0.5569 - val_loss: 3.1399 - val_accuracy10: 0.4624 - 6s/epoch - 27ms/step
Epoch 30/50
224/224 - 6s - loss: 2.7626 - accuracy10: 0.5589 - val_loss: 3.1611 - val_accuracy10: 0.4600 - 6s/epoch - 27ms/step
Epoch 31/50
224/224 - 6s - loss: 2.7573 - accuracy10: 0.5613 - val_loss: 3.1673 - val_accuracy10: 0.4579 - 6s/epoch - 27ms/step
Epoch 32/50
224/224 - 6s - loss: 2.7466 - accuracy10: 0.5615 - val_loss: 3.1567 - val_accuracy10: 0.4555 - 6s/epoch - 27ms/step
Epoch 33/50
224/224 - 6s - loss: 2.7382 - accuracy10: 0.5641 - val_loss: 3.1760 - val_accuracy10: 0.4487 - 6s/epoch - 27ms/step
testing model: results/LILAK/W8/deepVOL_L2/h10
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0110896
{'0': {'precision': 0.4024656300862278, 'recall': 0.4846943031111853, 'f1-score': 0.4397691798316148, 'support': 47956}, '1': {'precision': 0.666593424154049, 'recall': 0.4757905842767116, 'f1-score': 0.5552579034941764, 'support': 70138}, '2': {'precision': 0.4006619037612944, 'recall': 0.4885970531710442, 'f1-score': 0.4402817064018934, 'support': 46830}, 'accuracy': 0.4820159588659019, 'macro avg': {'precision': 0.4899069860005238, 'recall': 0.483027313519647, 'f1-score': 0.47843626324256155, 'support': 164924}, 'weighted avg': {'precision': 0.5142803248337007, 'recall': 0.4820159588659019, 'f1-score': 0.4890291402954096, 'support': 164924}}
[[23244  8174 16538]
 [19078 33371 17689]
 [15432  8517 22881]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9810553
{'0': {'precision': 0.4465156006632166, 'recall': 0.5195253127557582, 'f1-score': 0.48026155799940556, 'support': 17106}, '1': {'precision': 0.6594935968656803, 'recall': 0.49499648876404495, 'f1-score': 0.5655258869249091, 'support': 22784}, '2': {'precision': 0.44674937965260547, 'recall': 0.5214318813716404, 'f1-score': 0.4812102421553429, 'support': 17264}, 'accuracy': 0.5103229870175315, 'macro avg': {'precision': 0.5175861923938342, 'recall': 0.5119845609638145, 'f1-score': 0.5089992290265526, 'support': 57154}, 'weighted avg': {'precision': 0.5314882469513109, 'recall': 0.5103229870175315, 'f1-score': 0.5145380837632502, 'support': 57154}}
[[ 8887  2738  5481]
 [ 5839 11278  5667]
 [ 5177  3085  9002]]
Evaluating performance on  val set...
68/68 - 1s - 973ms/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0437477
{'0': {'precision': 0.40918319537716696, 'recall': 0.4950869236583522, 'f1-score': 0.44805472424112874, 'support': 5292}, '1': {'precision': 0.5849637282919323, 'recall': 0.4058877364246492, 'f1-score': 0.47924358397118416, 'support': 6556}, '2': {'precision': 0.4211614956245028, 'recall': 0.4911857487474485, 'f1-score': 0.4534863799897207, 'support': 5389}, 'accuracy': 0.45994082496954225, 'macro avg': {'precision': 0.4717694730978674, 'recall': 0.46405346961015, 'f1-score': 0.4602615627340112, 'support': 17237}, 'weighted avg': {'precision': 0.4797852858698336, 'recall': 0.45994082496954225, 'f1-score': 0.46161539937133733, 'support': 17237}}
[[2620  936 1736]
 [1993 2661 1902]
 [1790  952 2647]]
training model: results/LILAK/W8/deepVOL_L2/h20
Epoch 1/50
224/224 - 8s - loss: 3.3072 - accuracy20: 0.3824 - val_loss: 3.3674 - val_accuracy20: 0.3591 - 8s/epoch - 37ms/step
Epoch 2/50
224/224 - 6s - loss: 3.2463 - accuracy20: 0.3987 - val_loss: 3.3340 - val_accuracy20: 0.3559 - 6s/epoch - 27ms/step
Epoch 3/50
224/224 - 6s - loss: 3.1871 - accuracy20: 0.4197 - val_loss: 3.3142 - val_accuracy20: 0.3734 - 6s/epoch - 27ms/step
Epoch 4/50
224/224 - 6s - loss: 3.1403 - accuracy20: 0.4378 - val_loss: 3.2705 - val_accuracy20: 0.3868 - 6s/epoch - 28ms/step
Epoch 5/50
224/224 - 6s - loss: 3.1039 - accuracy20: 0.4525 - val_loss: 3.2251 - val_accuracy20: 0.4071 - 6s/epoch - 27ms/step
Epoch 6/50
224/224 - 6s - loss: 3.0740 - accuracy20: 0.4603 - val_loss: 3.2256 - val_accuracy20: 0.4081 - 6s/epoch - 27ms/step
Epoch 7/50
224/224 - 6s - loss: 3.0586 - accuracy20: 0.4656 - val_loss: 3.2307 - val_accuracy20: 0.4132 - 6s/epoch - 27ms/step
Epoch 8/50
224/224 - 6s - loss: 3.0417 - accuracy20: 0.4713 - val_loss: 3.1991 - val_accuracy20: 0.4197 - 6s/epoch - 27ms/step
Epoch 9/50
224/224 - 6s - loss: 3.0320 - accuracy20: 0.4731 - val_loss: 3.2011 - val_accuracy20: 0.4220 - 6s/epoch - 27ms/step
Epoch 10/50
224/224 - 6s - loss: 3.0117 - accuracy20: 0.4800 - val_loss: 3.1895 - val_accuracy20: 0.4270 - 6s/epoch - 27ms/step
Epoch 11/50
224/224 - 6s - loss: 2.9898 - accuracy20: 0.4875 - val_loss: 3.2046 - val_accuracy20: 0.4210 - 6s/epoch - 27ms/step
Epoch 12/50
224/224 - 6s - loss: 2.9835 - accuracy20: 0.4856 - val_loss: 3.2007 - val_accuracy20: 0.4254 - 6s/epoch - 27ms/step
Epoch 13/50
224/224 - 6s - loss: 2.9733 - accuracy20: 0.4911 - val_loss: 3.2162 - val_accuracy20: 0.4225 - 6s/epoch - 27ms/step
Epoch 14/50
224/224 - 6s - loss: 2.9619 - accuracy20: 0.4963 - val_loss: 3.2221 - val_accuracy20: 0.4239 - 6s/epoch - 27ms/step
Epoch 15/50
224/224 - 6s - loss: 2.9503 - accuracy20: 0.4993 - val_loss: 3.2274 - val_accuracy20: 0.4228 - 6s/epoch - 27ms/step
Epoch 16/50
224/224 - 6s - loss: 2.9296 - accuracy20: 0.5046 - val_loss: 3.2194 - val_accuracy20: 0.4202 - 6s/epoch - 27ms/step
Epoch 17/50
224/224 - 6s - loss: 2.9247 - accuracy20: 0.5081 - val_loss: 3.2447 - val_accuracy20: 0.4231 - 6s/epoch - 27ms/step
Epoch 18/50
224/224 - 6s - loss: 2.9151 - accuracy20: 0.5118 - val_loss: 3.2430 - val_accuracy20: 0.4262 - 6s/epoch - 27ms/step
Epoch 19/50
224/224 - 6s - loss: 2.9086 - accuracy20: 0.5128 - val_loss: 3.2463 - val_accuracy20: 0.4250 - 6s/epoch - 27ms/step
Epoch 20/50
224/224 - 6s - loss: 2.8936 - accuracy20: 0.5162 - val_loss: 3.2419 - val_accuracy20: 0.4317 - 6s/epoch - 27ms/step
testing model: results/LILAK/W8/deepVOL_L2/h20
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.035906
{'0': {'precision': 0.4031028759188374, 'recall': 0.4354587869362364, 'f1-score': 0.4186566048356597, 'support': 54655}, '1': {'precision': 0.5921278269816612, 'recall': 0.5154005549116707, 'f1-score': 0.5511064377118287, 'support': 56946}, '2': {'precision': 0.4054159637751931, 'recall': 0.42816420681507045, 'f1-score': 0.41647968769952026, 'support': 53323}, 'accuracy': 0.4607031117363149, 'macro avg': {'precision': 0.4668822222252306, 'recall': 0.45967451622099254, 'f1-score': 0.4620809100823362, 'support': 164924}, 'weighted avg': {'precision': 0.4691184688403529, 'recall': 0.4607031117363149, 'f1-score': 0.4636858815359335, 'support': 164924}}
[[23800 10715 20140]
 [14252 29350 13344]
 [20990  9502 22831]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0207464
{'0': {'precision': 0.4154710498212379, 'recall': 0.4734141050738056, 'f1-score': 0.44255403333498194, 'support': 18901}, '1': {'precision': 0.582281660074088, 'recall': 0.49086963425607366, 'f1-score': 0.5326823664560597, 'support': 18893}, '2': {'precision': 0.4337227018791265, 'recall': 0.44111570247933884, 'f1-score': 0.4373879641485275, 'support': 19360}, 'accuracy': 0.4682436924799664, 'macro avg': {'precision': 0.47715847059148414, 'recall': 0.4684664806030727, 'f1-score': 0.4708747879798563, 'support': 57154}, 'weighted avg': {'precision': 0.47679492642388727, 'recall': 0.4682436924799664, 'f1-score': 0.47059720613490436, 'support': 57154}}
[[8948 3230 6723]
 [5192 9274 4427]
 [7397 3423 8540]]
Evaluating performance on  val set...
68/68 - 1s - 949ms/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0651175
{'0': {'precision': 0.4006296733569461, 'recall': 0.5105315947843531, 'f1-score': 0.44895259095920614, 'support': 5982}, '1': {'precision': 0.49489795918367346, 'recall': 0.36868110984416574, 'f1-score': 0.4225658897843607, 'support': 5262}, '2': {'precision': 0.4171057253249034, 'recall': 0.3962956782913399, 'f1-score': 0.40643449987165226, 'support': 5993}, 'accuracy': 0.4275105876892731, 'macro avg': {'precision': 0.437544452621841, 'recall': 0.4251694609732862, 'f1-score': 0.42598432687173976, 'support': 17237}, 'weighted avg': {'precision': 0.43513571846132665, 'recall': 0.4275105876892731, 'f1-score': 0.4261146411147003, 'support': 17237}}
[[3054  964 1964]
 [1967 1940 1355]
 [2602 1016 2375]]
training model: results/LILAK/W8/deepVOL_L2/h30
Epoch 1/50
224/224 - 9s - loss: 3.3049 - accuracy30: 0.3819 - val_loss: 3.4076 - val_accuracy30: 0.3537 - 9s/epoch - 39ms/step
Epoch 2/50
224/224 - 6s - loss: 3.2584 - accuracy30: 0.3941 - val_loss: 3.3767 - val_accuracy30: 0.3548 - 6s/epoch - 27ms/step
Epoch 3/50
224/224 - 6s - loss: 3.2337 - accuracy30: 0.3985 - val_loss: 3.3829 - val_accuracy30: 0.3448 - 6s/epoch - 27ms/step
Epoch 4/50
224/224 - 6s - loss: 3.1835 - accuracy30: 0.4195 - val_loss: 3.3260 - val_accuracy30: 0.3727 - 6s/epoch - 27ms/step
Epoch 5/50
224/224 - 6s - loss: 3.1593 - accuracy30: 0.4270 - val_loss: 3.3063 - val_accuracy30: 0.3748 - 6s/epoch - 28ms/step
Epoch 6/50
224/224 - 6s - loss: 3.1344 - accuracy30: 0.4400 - val_loss: 3.3055 - val_accuracy30: 0.3786 - 6s/epoch - 27ms/step
Epoch 7/50
224/224 - 6s - loss: 3.1233 - accuracy30: 0.4425 - val_loss: 3.3157 - val_accuracy30: 0.3809 - 6s/epoch - 27ms/step
Epoch 8/50
224/224 - 6s - loss: 3.1006 - accuracy30: 0.4509 - val_loss: 3.2905 - val_accuracy30: 0.3822 - 6s/epoch - 27ms/step
Epoch 9/50
224/224 - 6s - loss: 3.0888 - accuracy30: 0.4555 - val_loss: 3.2796 - val_accuracy30: 0.3897 - 6s/epoch - 27ms/step
Epoch 10/50
224/224 - 6s - loss: 3.0720 - accuracy30: 0.4601 - val_loss: 3.3023 - val_accuracy30: 0.3852 - 6s/epoch - 27ms/step
Epoch 11/50
224/224 - 6s - loss: 3.0562 - accuracy30: 0.4655 - val_loss: 3.2783 - val_accuracy30: 0.3875 - 6s/epoch - 27ms/step
Epoch 12/50
224/224 - 6s - loss: 3.0433 - accuracy30: 0.4685 - val_loss: 3.2862 - val_accuracy30: 0.3902 - 6s/epoch - 27ms/step
Epoch 13/50
224/224 - 6s - loss: 3.0306 - accuracy30: 0.4715 - val_loss: 3.2994 - val_accuracy30: 0.3946 - 6s/epoch - 27ms/step
Epoch 14/50
224/224 - 6s - loss: 3.0233 - accuracy30: 0.4731 - val_loss: 3.3111 - val_accuracy30: 0.3897 - 6s/epoch - 27ms/step
Epoch 15/50
224/224 - 6s - loss: 3.0092 - accuracy30: 0.4788 - val_loss: 3.2984 - val_accuracy30: 0.3993 - 6s/epoch - 27ms/step
Epoch 16/50
224/224 - 6s - loss: 2.9966 - accuracy30: 0.4837 - val_loss: 3.2942 - val_accuracy30: 0.3951 - 6s/epoch - 27ms/step
Epoch 17/50
224/224 - 6s - loss: 2.9862 - accuracy30: 0.4839 - val_loss: 3.3054 - val_accuracy30: 0.3956 - 6s/epoch - 27ms/step
Epoch 18/50
224/224 - 6s - loss: 2.9711 - accuracy30: 0.4884 - val_loss: 3.3156 - val_accuracy30: 0.4018 - 6s/epoch - 27ms/step
Epoch 19/50
224/224 - 6s - loss: 2.9591 - accuracy30: 0.4944 - val_loss: 3.2911 - val_accuracy30: 0.4061 - 6s/epoch - 27ms/step
Epoch 20/50
224/224 - 6s - loss: 2.9550 - accuracy30: 0.4956 - val_loss: 3.2979 - val_accuracy30: 0.4001 - 6s/epoch - 27ms/step
Epoch 21/50
224/224 - 6s - loss: 2.9401 - accuracy30: 0.5005 - val_loss: 3.3038 - val_accuracy30: 0.4033 - 6s/epoch - 27ms/step
testing model: results/LILAK/W8/deepVOL_L2/h30
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0639269
{'0': {'precision': 0.3772008657899067, 'recall': 0.5486917935593157, 'f1-score': 0.4470648243995379, 'support': 54311}, '1': {'precision': 0.5721555058009363, 'recall': 0.3892610479306226, 'f1-score': 0.4633118722637137, 'support': 57771}, '2': {'precision': 0.3908230902889504, 'recall': 0.34478255932780744, 'f1-score': 0.3663620185201943, 'support': 52842}, 'accuracy': 0.42751206616380877, 'macro avg': {'precision': 0.44672648729326453, 'recall': 0.4275784669392486, 'f1-score': 0.4255795717278153, 'support': 164924}, 'weighted avg': {'precision': 0.44985584684212265, 'recall': 0.42751206616380877, 'f1-score': 0.4268986298728773, 'support': 164924}}
[[29800  8615 15896]
 [22781 22488 12502]
 [26422  8201 18219]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.049901
{'0': {'precision': 0.3854024317600477, 'recall': 0.5796879940971856, 'f1-score': 0.4629890766737525, 'support': 18974}, '1': {'precision': 0.554930693069307, 'recall': 0.37228333067644404, 'f1-score': 0.44561760590255695, 'support': 18819}, '2': {'precision': 0.4241400875547217, 'recall': 0.3502918237694334, 'f1-score': 0.38369494498034007, 'support': 19361}, 'accuracy': 0.43368793085348356, 'macro avg': {'precision': 0.45482440412802544, 'recall': 0.43408771618102104, 'f1-score': 0.43076720918554984, 'support': 57154}, 'weighted avg': {'precision': 0.4543451497398852, 'recall': 0.43368793085348356, 'f1-score': 0.43040820058180296, 'support': 57154}}
[[10999  2808  5167]
 [ 7772  7006  4041]
 [ 9768  2811  6782]]
Evaluating performance on  val set...
68/68 - 1s - 947ms/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0916432
{'0': {'precision': 0.3764765784114053, 'recall': 0.6181240595218191, 'f1-score': 0.46794506676792613, 'support': 5981}, '1': {'precision': 0.462787550744249, 'recall': 0.2532395409107738, 'f1-score': 0.3273510409188801, 'support': 5402}, '2': {'precision': 0.38354629006949115, 'recall': 0.2922787837376153, 'f1-score': 0.3317498788172564, 'support': 5854}, 'accuracy': 0.393107849393746, 'macro avg': {'precision': 0.40760347307504846, 'recall': 0.3878807947234027, 'f1-score': 0.3756819955013542, 'support': 17237}, 'weighted avg': {'precision': 0.4059270607800574, 'recall': 0.393107849393746, 'f1-score': 0.3776291441653986, 'support': 17237}}
[[3697  792 1492]
 [2776 1368 1258]
 [3347  796 1711]]
training model: results/LILAK/W8/deepVOL_L2/h50
Epoch 1/50
224/224 - 8s - loss: 3.3227 - accuracy50: 0.3724 - val_loss: 3.3693 - val_accuracy50: 0.3466 - 8s/epoch - 34ms/step
Epoch 2/50
224/224 - 6s - loss: 3.2898 - accuracy50: 0.3809 - val_loss: 3.3523 - val_accuracy50: 0.3572 - 6s/epoch - 27ms/step
Epoch 3/50
224/224 - 6s - loss: 3.2626 - accuracy50: 0.3874 - val_loss: 3.3770 - val_accuracy50: 0.3504 - 6s/epoch - 27ms/step
Epoch 4/50
224/224 - 6s - loss: 3.2482 - accuracy50: 0.3954 - val_loss: 3.3507 - val_accuracy50: 0.3529 - 6s/epoch - 28ms/step
Epoch 5/50
224/224 - 6s - loss: 3.2131 - accuracy50: 0.4077 - val_loss: 3.3282 - val_accuracy50: 0.3617 - 6s/epoch - 28ms/step
Epoch 6/50
224/224 - 6s - loss: 3.1973 - accuracy50: 0.4158 - val_loss: 3.3217 - val_accuracy50: 0.3530 - 6s/epoch - 27ms/step
Epoch 7/50
224/224 - 6s - loss: 3.1812 - accuracy50: 0.4198 - val_loss: 3.3081 - val_accuracy50: 0.3632 - 6s/epoch - 27ms/step
Epoch 8/50
224/224 - 6s - loss: 3.1608 - accuracy50: 0.4288 - val_loss: 3.3054 - val_accuracy50: 0.3661 - 6s/epoch - 28ms/step
Epoch 9/50
224/224 - 6s - loss: 3.1451 - accuracy50: 0.4344 - val_loss: 3.3072 - val_accuracy50: 0.3632 - 6s/epoch - 27ms/step
Epoch 10/50
224/224 - 6s - loss: 3.1358 - accuracy50: 0.4363 - val_loss: 3.3092 - val_accuracy50: 0.3702 - 6s/epoch - 27ms/step
Epoch 11/50
224/224 - 6s - loss: 3.1206 - accuracy50: 0.4410 - val_loss: 3.3085 - val_accuracy50: 0.3731 - 6s/epoch - 27ms/step
Epoch 12/50
224/224 - 6s - loss: 3.1112 - accuracy50: 0.4444 - val_loss: 3.3261 - val_accuracy50: 0.3713 - 6s/epoch - 27ms/step
Epoch 13/50
224/224 - 6s - loss: 3.0947 - accuracy50: 0.4494 - val_loss: 3.3214 - val_accuracy50: 0.3762 - 6s/epoch - 27ms/step
Epoch 14/50
224/224 - 6s - loss: 3.0848 - accuracy50: 0.4546 - val_loss: 3.3254 - val_accuracy50: 0.3711 - 6s/epoch - 27ms/step
Epoch 15/50
224/224 - 6s - loss: 3.0749 - accuracy50: 0.4566 - val_loss: 3.3268 - val_accuracy50: 0.3810 - 6s/epoch - 27ms/step
Epoch 16/50
224/224 - 6s - loss: 3.0635 - accuracy50: 0.4639 - val_loss: 3.3201 - val_accuracy50: 0.3819 - 6s/epoch - 27ms/step
Epoch 17/50
224/224 - 6s - loss: 3.0521 - accuracy50: 0.4647 - val_loss: 3.3249 - val_accuracy50: 0.3799 - 6s/epoch - 27ms/step
Epoch 18/50
224/224 - 6s - loss: 3.0446 - accuracy50: 0.4672 - val_loss: 3.3291 - val_accuracy50: 0.3723 - 6s/epoch - 28ms/step
testing model: results/LILAK/W8/deepVOL_L2/h50
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0818881
{'0': {'precision': 0.36282801995228803, 'recall': 0.5670680581571671, 'f1-score': 0.4425186546386012, 'support': 56055}, '1': {'precision': 0.5523321421854429, 'recall': 0.21483960642305863, 'f1-score': 0.30935138124456846, 'support': 54678}, '2': {'precision': 0.37614858957660535, 'recall': 0.38903138897602924, 'f1-score': 0.38248153994085526, 'support': 54191}, 'accuracy': 0.3917925832504669, 'macro avg': {'precision': 0.43043625057144547, 'recall': 0.390313017852085, 'f1-score': 0.3781171919413416, 'support': 164924}, 'weighted avg': {'precision': 0.4300320738436309, 'recall': 0.3917925832504669, 'f1-score': 0.3786420117168647, 'support': 164924}}
[[31787  4859 19409]
 [27375 11747 15556]
 [28447  4662 21082]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0715857
{'0': {'precision': 0.36284352499746475, 'recall': 0.5702294942626435, 'f1-score': 0.4434895779536017, 'support': 18824}, '1': {'precision': 0.555139550714772, 'recall': 0.25730963399242746, 'f1-score': 0.3516349263384837, 'support': 19016}, '2': {'precision': 0.40299621474649466, 'recall': 0.39137413275344307, 'f1-score': 0.39710015497360196, 'support': 19314}, 'accuracy': 0.40567589320082587, 'macro avg': {'precision': 0.44032643015291045, 'recall': 0.40630442033617137, 'f1-score': 0.3974082197552291, 'support': 57154}, 'weighted avg': {'precision': 0.44039208283861453, 'recall': 0.40567589320082587, 'f1-score': 0.39725181033368356, 'support': 57154}}
[[10734  1934  6156]
 [ 9081  4893  5042]
 [ 9768  1987  7559]]
Evaluating performance on  val set...
68/68 - 1s - 957ms/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1017109
{'0': {'precision': 0.36198141228322317, 'recall': 0.6206669952357483, 'f1-score': 0.45727426773178415, 'support': 6087}, '1': {'precision': 0.38317107093184977, 'recall': 0.10469314079422383, 'f1-score': 0.16445306670646173, 'support': 5263}, '2': {'precision': 0.37486012681835135, 'recall': 0.34143027008663157, 'f1-score': 0.3573650991199217, 'support': 5887}, 'accuracy': 0.36775540987410804, 'macro avg': {'precision': 0.37333753667780806, 'recall': 0.35559680203886795, 'f1-score': 0.3263641445193892, 'support': 17237}, 'weighted avg': {'precision': 0.372849786474557, 'recall': 0.36775540987410804, 'f1-score': 0.33374446227756904, 'support': 17237}}
[[3778  447 1862]
 [3222  551 1490]
 [3437  440 2010]]
training model: results/LILAK/W8/deepVOL_L2/h100
Epoch 1/50
224/224 - 8s - loss: 3.3531 - accuracy100: 0.3570 - val_loss: 3.3534 - val_accuracy100: 0.3347 - 8s/epoch - 37ms/step
Epoch 2/50
224/224 - 6s - loss: 3.2983 - accuracy100: 0.3677 - val_loss: 3.3450 - val_accuracy100: 0.3481 - 6s/epoch - 27ms/step
Epoch 3/50
224/224 - 6s - loss: 3.2820 - accuracy100: 0.3775 - val_loss: 3.3501 - val_accuracy100: 0.3400 - 6s/epoch - 27ms/step
Epoch 4/50
224/224 - 6s - loss: 3.2780 - accuracy100: 0.3767 - val_loss: 3.3192 - val_accuracy100: 0.3469 - 6s/epoch - 27ms/step
Epoch 5/50
224/224 - 6s - loss: 3.2602 - accuracy100: 0.3847 - val_loss: 3.3088 - val_accuracy100: 0.3466 - 6s/epoch - 27ms/step
Epoch 6/50
224/224 - 6s - loss: 3.2415 - accuracy100: 0.3944 - val_loss: 3.3227 - val_accuracy100: 0.3454 - 6s/epoch - 27ms/step
Epoch 7/50
224/224 - 6s - loss: 3.2204 - accuracy100: 0.4013 - val_loss: 3.3216 - val_accuracy100: 0.3402 - 6s/epoch - 27ms/step
Epoch 8/50
224/224 - 6s - loss: 3.1977 - accuracy100: 0.4101 - val_loss: 3.3223 - val_accuracy100: 0.3399 - 6s/epoch - 27ms/step
Epoch 9/50
224/224 - 6s - loss: 3.1855 - accuracy100: 0.4114 - val_loss: 3.3251 - val_accuracy100: 0.3405 - 6s/epoch - 27ms/step
Epoch 10/50
224/224 - 6s - loss: 3.1692 - accuracy100: 0.4181 - val_loss: 3.3396 - val_accuracy100: 0.3379 - 6s/epoch - 27ms/step
Epoch 11/50
224/224 - 6s - loss: 3.1524 - accuracy100: 0.4253 - val_loss: 3.3424 - val_accuracy100: 0.3393 - 6s/epoch - 27ms/step
Epoch 12/50
224/224 - 6s - loss: 3.1401 - accuracy100: 0.4294 - val_loss: 3.3462 - val_accuracy100: 0.3370 - 6s/epoch - 27ms/step
Epoch 13/50
224/224 - 6s - loss: 3.1300 - accuracy100: 0.4339 - val_loss: 3.3417 - val_accuracy100: 0.3415 - 6s/epoch - 27ms/step
Epoch 14/50
224/224 - 6s - loss: 3.1191 - accuracy100: 0.4359 - val_loss: 3.3411 - val_accuracy100: 0.3452 - 6s/epoch - 27ms/step
Epoch 15/50
224/224 - 6s - loss: 3.1053 - accuracy100: 0.4422 - val_loss: 3.3394 - val_accuracy100: 0.3473 - 6s/epoch - 27ms/step
testing model: results/LILAK/W8/deepVOL_L2/h100
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0985011
{'0': {'precision': 0.3575171147741615, 'recall': 0.3311898814901419, 'f1-score': 0.3438502919674468, 'support': 56451}, '1': {'precision': 0.37917562724014336, 'recall': 0.19827570049667323, 'f1-score': 0.2603901298381638, 'support': 53355}, '2': {'precision': 0.35846807506196154, 'recall': 0.5510541021082043, 'f1-score': 0.43437160345517994, 'support': 55118}, 'accuracy': 0.36166961752079746, 'macro avg': {'precision': 0.3650536056920888, 'recall': 0.3601732280316732, 'f1-score': 0.3462040084202635, 'support': 164924}, 'weighted avg': {'precision': 0.36484173072917975, 'recall': 0.36166961752079746, 'f1-score': 0.3471023153004546, 'support': 164924}}
[[18696  8993 28762]
 [17181 10579 25595]
 [16417  8328 30373]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0925283
{'0': {'precision': 0.36468560685189055, 'recall': 0.36573613366155133, 'f1-score': 0.36521011479825316, 'support': 19093}, '1': {'precision': 0.40455986971800806, 'recall': 0.24939237028426503, 'f1-score': 0.30856731932141346, 'support': 18926}, '2': {'precision': 0.3691863776149436, 'recall': 0.5081787300757774, 'f1-score': 0.4276729559748428, 'support': 19135}, 'accuracy': 0.3748993946180495, 'macro avg': {'precision': 0.37947728472828074, 'recall': 0.3744357446738646, 'f1-score': 0.36715013003150315, 'support': 57154}, 'weighted avg': {'precision': 0.3793964328230415, 'recall': 0.3748993946180495, 'f1-score': 0.3673657805210263, 'support': 57154}}
[[6983 3533 8577]
 [6168 4720 8038]
 [5997 3414 9724]]
Evaluating performance on  val set...
68/68 - 1s - 975ms/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1033213
{'0': {'precision': 0.3512908777969019, 'recall': 0.3370767960363336, 'f1-score': 0.3440370838600927, 'support': 6055}, '1': {'precision': 0.3427495291902072, 'recall': 0.237553608055193, 'f1-score': 0.2806167400881058, 'support': 5363}, '2': {'precision': 0.34682230869001296, 'recall': 0.45952912871627427, 'f1-score': 0.3952989873604849, 'support': 5819}, 'accuracy': 0.3474502523641005, 'macro avg': {'precision': 0.34695423855904073, 'recall': 0.34471984426926694, 'f1-score': 0.33998427043622775, 'support': 17237}, 'weighted avg': {'precision': 0.34712484796510457, 'recall': 0.3474502523641005, 'f1-score': 0.341610310803274, 'support': 17237}}
[[2041 1269 2745]
 [1798 1274 2291]
 [1971 1174 2674]]
training model: results/LILAK/W8/deepVOL_L2/h200
Epoch 1/50
224/224 - 8s - loss: 3.3408 - accuracy200: 0.3572 - val_loss: 3.3594 - val_accuracy200: 0.3403 - 8s/epoch - 37ms/step
Epoch 2/50
224/224 - 6s - loss: 3.2972 - accuracy200: 0.3733 - val_loss: 3.3702 - val_accuracy200: 0.3410 - 6s/epoch - 27ms/step
Epoch 3/50
224/224 - 6s - loss: 3.2704 - accuracy200: 0.3825 - val_loss: 3.3390 - val_accuracy200: 0.3520 - 6s/epoch - 27ms/step
Epoch 4/50
224/224 - 6s - loss: 3.2652 - accuracy200: 0.3831 - val_loss: 3.3320 - val_accuracy200: 0.3526 - 6s/epoch - 28ms/step
Epoch 5/50
224/224 - 6s - loss: 3.2484 - accuracy200: 0.3935 - val_loss: 3.3101 - val_accuracy200: 0.3522 - 6s/epoch - 27ms/step
Epoch 6/50
224/224 - 6s - loss: 3.2413 - accuracy200: 0.3951 - val_loss: 3.3221 - val_accuracy200: 0.3550 - 6s/epoch - 27ms/step
Epoch 7/50
224/224 - 6s - loss: 3.2260 - accuracy200: 0.4020 - val_loss: 3.3238 - val_accuracy200: 0.3572 - 6s/epoch - 27ms/step
Epoch 8/50
224/224 - 6s - loss: 3.2168 - accuracy200: 0.4096 - val_loss: 3.3239 - val_accuracy200: 0.3581 - 6s/epoch - 27ms/step
Epoch 9/50
224/224 - 6s - loss: 3.2042 - accuracy200: 0.4126 - val_loss: 3.3245 - val_accuracy200: 0.3584 - 6s/epoch - 27ms/step
Epoch 10/50
224/224 - 6s - loss: 3.2014 - accuracy200: 0.4119 - val_loss: 3.3203 - val_accuracy200: 0.3617 - 6s/epoch - 27ms/step
Epoch 11/50
224/224 - 6s - loss: 3.1925 - accuracy200: 0.4181 - val_loss: 3.3262 - val_accuracy200: 0.3619 - 6s/epoch - 27ms/step
Epoch 12/50
224/224 - 6s - loss: 3.1795 - accuracy200: 0.4222 - val_loss: 3.3390 - val_accuracy200: 0.3606 - 6s/epoch - 27ms/step
Epoch 13/50
224/224 - 6s - loss: 3.1689 - accuracy200: 0.4263 - val_loss: 3.3415 - val_accuracy200: 0.3571 - 6s/epoch - 27ms/step
Epoch 14/50
224/224 - 6s - loss: 3.1550 - accuracy200: 0.4296 - val_loss: 3.3511 - val_accuracy200: 0.3562 - 6s/epoch - 27ms/step
Epoch 15/50
224/224 - 6s - loss: 3.1401 - accuracy200: 0.4352 - val_loss: 3.3451 - val_accuracy200: 0.3609 - 6s/epoch - 27ms/step
testing model: results/LILAK/W8/deepVOL_L2/h200
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.121353
{'0': {'precision': 0.3422450487212861, 'recall': 0.3536210813266697, 'f1-score': 0.34784007722628907, 'support': 55025}, '1': {'precision': 0.37180249851279, 'recall': 0.05723652881057914, 'f1-score': 0.09920162531942922, 'support': 54598}, '2': {'precision': 0.33687854311945015, 'recall': 0.6071318782662158, 'f1-score': 0.43332085747841464, 'support': 55301}, 'accuracy': 0.3405083553636827, 'macro avg': {'precision': 0.35030869678450877, 'recall': 0.3393298294678216, 'f1-score': 0.29345418667471096, 'support': 164924}, 'weighted avg': {'precision': 0.35023057246209643, 'recall': 0.3405083553636827, 'f1-score': 0.29419118701935776, 'support': 164924}}
[[19458  2473 33094]
 [18477  3125 32996]
 [18919  2807 33575]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1011503
{'0': {'precision': 0.3474113794903431, 'recall': 0.3828174022171094, 'f1-score': 0.3642560390078862, 'support': 19124}, '1': {'precision': 0.4747666781887314, 'recall': 0.1458067940552017, 'f1-score': 0.2230975391862259, 'support': 18840}, '2': {'precision': 0.3566265060240964, 'recall': 0.5630015633142261, 'f1-score': 0.43665757300191976, 'support': 19190}, 'accuracy': 0.3651887881863037, 'macro avg': {'precision': 0.3929348545677236, 'recall': 0.36387525319551245, 'f1-score': 0.3413370503986773, 'support': 57154}, 'weighted avg': {'precision': 0.3924863017295628, 'recall': 0.3651887881863037, 'f1-score': 0.34203465993914955, 'support': 57154}}
[[ 7321  1577 10226]
 [ 6828  2747  9265]
 [ 6924  1462 10804]]
Evaluating performance on  val set...
68/68 - 1s - 972ms/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1035506
{'0': {'precision': 0.3588817339406314, 'recall': 0.3725138571894359, 'f1-score': 0.36557075433965275, 'support': 6134}, '1': {'precision': 0.32436194895591647, 'recall': 0.1331935975609756, 'f1-score': 0.18884236120491693, 'support': 5248}, '2': {'precision': 0.3496270797475617, 'recall': 0.5204099060631938, 'f1-score': 0.4182566918325326, 'support': 5855}, 'accuracy': 0.3498868712653014, 'macro avg': {'precision': 0.3442902542147032, 'recall': 0.3420391202712018, 'f1-score': 0.32422326912570076, 'support': 17237}, 'weighted avg': {'precision': 0.34522820769475293, 'recall': 0.3498868712653014, 'f1-score': 0.3296599552939788, 'support': 17237}}
[[2285  721 3128]
 [2009  699 2540]
 [2073  735 3047]]
training model: results/LILAK/W8/deepVOL_L2/h300
Epoch 1/50
224/224 - 9s - loss: 3.3436 - accuracy300: 0.3614 - val_loss: 3.3532 - val_accuracy300: 0.3504 - 9s/epoch - 38ms/step
Epoch 2/50
224/224 - 6s - loss: 3.2994 - accuracy300: 0.3780 - val_loss: 3.3346 - val_accuracy300: 0.3487 - 6s/epoch - 28ms/step
Epoch 3/50
224/224 - 6s - loss: 3.2805 - accuracy300: 0.3837 - val_loss: 3.3524 - val_accuracy300: 0.3485 - 6s/epoch - 28ms/step
Epoch 4/50
224/224 - 6s - loss: 3.2556 - accuracy300: 0.3926 - val_loss: 3.3620 - val_accuracy300: 0.3426 - 6s/epoch - 28ms/step
Epoch 5/50
224/224 - 6s - loss: 3.2556 - accuracy300: 0.3871 - val_loss: 3.3519 - val_accuracy300: 0.3375 - 6s/epoch - 28ms/step
Epoch 6/50
224/224 - 6s - loss: 3.2434 - accuracy300: 0.3896 - val_loss: 3.3369 - val_accuracy300: 0.3385 - 6s/epoch - 28ms/step
Epoch 7/50
224/224 - 6s - loss: 3.2281 - accuracy300: 0.4001 - val_loss: 3.3270 - val_accuracy300: 0.3462 - 6s/epoch - 28ms/step
Epoch 8/50
224/224 - 6s - loss: 3.2116 - accuracy300: 0.4085 - val_loss: 3.3307 - val_accuracy300: 0.3491 - 6s/epoch - 28ms/step
Epoch 9/50
224/224 - 6s - loss: 3.1933 - accuracy300: 0.4119 - val_loss: 3.3300 - val_accuracy300: 0.3486 - 6s/epoch - 28ms/step
Epoch 10/50
224/224 - 6s - loss: 3.1765 - accuracy300: 0.4201 - val_loss: 3.3312 - val_accuracy300: 0.3520 - 6s/epoch - 27ms/step
Epoch 11/50
224/224 - 6s - loss: 3.1600 - accuracy300: 0.4256 - val_loss: 3.3448 - val_accuracy300: 0.3491 - 6s/epoch - 27ms/step
Epoch 12/50
224/224 - 6s - loss: 3.1449 - accuracy300: 0.4314 - val_loss: 3.3682 - val_accuracy300: 0.3425 - 6s/epoch - 27ms/step
Epoch 13/50
224/224 - 6s - loss: 3.1232 - accuracy300: 0.4398 - val_loss: 3.3775 - val_accuracy300: 0.3405 - 6s/epoch - 27ms/step
Epoch 14/50
224/224 - 6s - loss: 3.1072 - accuracy300: 0.4461 - val_loss: 3.3937 - val_accuracy300: 0.3450 - 6s/epoch - 27ms/step
Epoch 15/50
224/224 - 6s - loss: 3.0879 - accuracy300: 0.4539 - val_loss: 3.4346 - val_accuracy300: 0.3387 - 6s/epoch - 27ms/step
Epoch 16/50
224/224 - 6s - loss: 3.0742 - accuracy300: 0.4587 - val_loss: 3.4569 - val_accuracy300: 0.3367 - 6s/epoch - 28ms/step
Epoch 17/50
224/224 - 6s - loss: 3.0628 - accuracy300: 0.4620 - val_loss: 3.4762 - val_accuracy300: 0.3351 - 6s/epoch - 27ms/step
testing model: results/LILAK/W8/deepVOL_L2/h300
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1073959
{'0': {'precision': 0.35628752671393193, 'recall': 0.37111762835235507, 'f1-score': 0.3635514018691589, 'support': 56602}, '1': {'precision': 0.309539610120282, 'recall': 0.14715277230065463, 'f1-score': 0.1994761179269238, 'support': 50716}, '2': {'precision': 0.34625439796716184, 'recall': 0.49201472068881713, 'f1-score': 0.40646197530510103, 'support': 57606}, 'accuracy': 0.3444738182435546, 'macro avg': {'precision': 0.3373605116004586, 'recall': 0.3367617071139423, 'f1-score': 0.3231631650337279, 'support': 164924}, 'weighted avg': {'precision': 0.33840755925892246, 'recall': 0.3444738182435546, 'f1-score': 0.3280845467900709, 'support': 164924}}
[[21006  8419 27177]
 [16917  7463 26336]
 [21035  8228 28343]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0804904
{'0': {'precision': 0.38075037188033717, 'recall': 0.36255377190221383, 'f1-score': 0.37142933920941607, 'support': 19062}, '1': {'precision': 0.45427215189873416, 'recall': 0.3051009564293305, 'f1-score': 0.3650349650349651, 'support': 18820}, '2': {'precision': 0.37260554565110193, 'recall': 0.509703196347032, 'f1-score': 0.43050290347321135, 'support': 19272}, 'accuracy': 0.39325331560345733, 'macro avg': {'precision': 0.40254268981005775, 'recall': 0.3924526415595255, 'f1-score': 0.3889890692391975, 'support': 57154}, 'weighted avg': {'precision': 0.4022136606940057, 'recall': 0.39325331560345733, 'f1-score': 0.3892430286892196, 'support': 57154}}
[[6911 3422 8729]
 [5267 5742 7811]
 [5973 3476 9823]]
Evaluating performance on  val set...
68/68 - 1s - 981ms/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1085589
{'0': {'precision': 0.358797096439682, 'recall': 0.33679428942245293, 'f1-score': 0.34744769874476983, 'support': 6164}, '1': {'precision': 0.3382507903055848, 'recall': 0.24148956178296033, 'f1-score': 0.2817952375726983, 'support': 5317}, '2': {'precision': 0.3316786414108426, 'recall': 0.4411049339819319, 'f1-score': 0.37864439639102226, 'support': 5756}, 'accuracy': 0.3422289261472414, 'macro avg': {'precision': 0.3429088427187031, 'recall': 0.33979626172911503, 'f1-score': 0.33596244423616345, 'support': 17237}, 'weighted avg': {'precision': 0.3434035513412893, 'recall': 0.3422289261472414, 'f1-score': 0.3376138561735524, 'support': 17237}}
[[2076 1253 2835]
 [1752 1284 2281]
 [1958 1259 2539]]
training model: results/LILAK/W8/deepVOL_L2/h500
Epoch 1/50
224/224 - 8s - loss: 3.3267 - accuracy500: 0.3687 - val_loss: 3.3929 - val_accuracy500: 0.3421 - 8s/epoch - 37ms/step
Epoch 2/50
224/224 - 6s - loss: 3.2783 - accuracy500: 0.3896 - val_loss: 3.3986 - val_accuracy500: 0.3372 - 6s/epoch - 27ms/step
Epoch 3/50
224/224 - 6s - loss: 3.2693 - accuracy500: 0.3953 - val_loss: 3.3690 - val_accuracy500: 0.3399 - 6s/epoch - 27ms/step
Epoch 4/50
224/224 - 6s - loss: 3.2442 - accuracy500: 0.4026 - val_loss: 3.3650 - val_accuracy500: 0.3423 - 6s/epoch - 27ms/step
Epoch 5/50
224/224 - 6s - loss: 3.2400 - accuracy500: 0.4020 - val_loss: 3.4202 - val_accuracy500: 0.3270 - 6s/epoch - 27ms/step
Epoch 6/50
224/224 - 6s - loss: 3.2253 - accuracy500: 0.4054 - val_loss: 3.3735 - val_accuracy500: 0.3411 - 6s/epoch - 27ms/step
Epoch 7/50
224/224 - 6s - loss: 3.2123 - accuracy500: 0.4164 - val_loss: 3.4040 - val_accuracy500: 0.3429 - 6s/epoch - 27ms/step
Epoch 8/50
224/224 - 6s - loss: 3.1870 - accuracy500: 0.4245 - val_loss: 3.4099 - val_accuracy500: 0.3421 - 6s/epoch - 27ms/step
Epoch 9/50
224/224 - 6s - loss: 3.1707 - accuracy500: 0.4271 - val_loss: 3.3901 - val_accuracy500: 0.3492 - 6s/epoch - 27ms/step
Epoch 10/50
224/224 - 6s - loss: 3.1566 - accuracy500: 0.4307 - val_loss: 3.3783 - val_accuracy500: 0.3421 - 6s/epoch - 27ms/step
Epoch 11/50
224/224 - 6s - loss: 3.1479 - accuracy500: 0.4327 - val_loss: 3.3785 - val_accuracy500: 0.3463 - 6s/epoch - 27ms/step
Epoch 12/50
224/224 - 6s - loss: 3.1295 - accuracy500: 0.4386 - val_loss: 3.4017 - val_accuracy500: 0.3363 - 6s/epoch - 27ms/step
Epoch 13/50
224/224 - 6s - loss: 3.1247 - accuracy500: 0.4406 - val_loss: 3.3964 - val_accuracy500: 0.3436 - 6s/epoch - 27ms/step
Epoch 14/50
224/224 - 6s - loss: 3.1189 - accuracy500: 0.4414 - val_loss: 3.4027 - val_accuracy500: 0.3405 - 6s/epoch - 27ms/step
testing model: results/LILAK/W8/deepVOL_L2/h500
Evaluating performance on  test set...
645/645 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1061416
{'0': {'precision': 0.42250201575389196, 'recall': 0.10732967794794226, 'f1-score': 0.1711751328667814, 'support': 63468}, '1': {'precision': 0.17685611879160265, 'recall': 0.045197592253336825, 'f1-score': 0.07199583116206358, 'support': 38210}, '2': {'precision': 0.38679191000891855, 'recall': 0.8502988331277868, 'f1-score': 0.5317131529251243, 'support': 63246}, 'accuracy': 0.3778528291819262, 'macro avg': {'precision': 0.3287166815181377, 'recall': 0.3342753677763553, 'f1-score': 0.2582947056513231, 'support': 164924}, 'weighted avg': {'precision': 0.3518958512728239, 'recall': 0.3778528291819262, 'f1-score': 0.2864582117302136, 'support': 164924}}
[[ 6812  4556 52100]
 [ 3325  1727 33158]
 [ 5986  3482 53778]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1004305
{'0': {'precision': 0.36882212061833225, 'recall': 0.17924977514417226, 'f1-score': 0.24125040054117566, 'support': 18901}, '1': {'precision': 0.49780621572212064, 'recall': 0.14428018862925873, 'f1-score': 0.2237193443700448, 'support': 18873}, '2': {'precision': 0.35968751470657445, 'recall': 0.7887512899896801, 'f1-score': 0.4940689744335629, 'support': 19380}, 'accuracy': 0.3743744969730902, 'macro avg': {'precision': 0.4087719503490091, 'recall': 0.3707604179210371, 'f1-score': 0.3196795731149278, 'support': 57154}, 'weighted avg': {'precision': 0.40831696199993167, 'recall': 0.3743744969730902, 'f1-score': 0.32118811861719326, 'support': 57154}}
[[ 3388  1332 14181]
 [ 3119  2723 13031]
 [ 2679  1415 15286]]
Evaluating performance on  val set...
68/68 - 1s - 988ms/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.118891
{'0': {'precision': 0.3822800495662949, 'recall': 0.18648934562490554, 'f1-score': 0.25068562722194004, 'support': 6617}, '1': {'precision': 0.3554817275747508, 'recall': 0.12860576923076922, 'f1-score': 0.18887908208296555, 'support': 4992}, '2': {'precision': 0.33032860771941325, 'recall': 0.7162402274342573, 'f1-score': 0.4521339240648309, 'support': 5628}, 'accuracy': 0.3426930440331844, 'macro avg': {'precision': 0.3560301282868197, 'recall': 0.3437784474299774, 'f1-score': 0.2972328777899122, 'support': 17237}, 'weighted avg': {'precision': 0.3575564933734517, 'recall': 0.3426930440331844, 'f1-score': 0.29856012634000173, 'support': 17237}}
[[1234  589 4794]
 [ 972  642 3378]
 [1022  575 4031]]
training model: results/LILAK/W8/deepVOL_L2/h1000
Epoch 1/50
224/224 - 8s - loss: 3.3266 - accuracy1000: 0.3777 - val_loss: 3.4281 - val_accuracy1000: 0.3414 - 8s/epoch - 37ms/step
Epoch 2/50
224/224 - 6s - loss: 3.3159 - accuracy1000: 0.3826 - val_loss: 3.4354 - val_accuracy1000: 0.3392 - 6s/epoch - 27ms/step
Epoch 3/50
224/224 - 6s - loss: 3.2816 - accuracy1000: 0.3887 - val_loss: 3.4028 - val_accuracy1000: 0.3397 - 6s/epoch - 27ms/step
Epoch 4/50
224/224 - 6s - loss: 3.2636 - accuracy1000: 0.3895 - val_loss: 3.4020 - val_accuracy1000: 0.3332 - 6s/epoch - 28ms/step
Epoch 5/50
224/224 - 6s - loss: 3.2580 - accuracy1000: 0.3913 - val_loss: 3.3459 - val_accuracy1000: 0.3462 - 6s/epoch - 28ms/step
Epoch 6/50
224/224 - 6s - loss: 3.2369 - accuracy1000: 0.3978 - val_loss: 3.3243 - val_accuracy1000: 0.3430 - 6s/epoch - 28ms/step
Epoch 7/50
224/224 - 6s - loss: 3.2210 - accuracy1000: 0.4005 - val_loss: 3.3560 - val_accuracy1000: 0.3469 - 6s/epoch - 27ms/step
Epoch 8/50
224/224 - 6s - loss: 3.2014 - accuracy1000: 0.4117 - val_loss: 3.3974 - val_accuracy1000: 0.3423 - 6s/epoch - 27ms/step
Epoch 9/50
224/224 - 6s - loss: 3.1854 - accuracy1000: 0.4189 - val_loss: 3.4267 - val_accuracy1000: 0.3363 - 6s/epoch - 27ms/step
Epoch 10/50
224/224 - 6s - loss: 3.1745 - accuracy1000: 0.4263 - val_loss: 3.4342 - val_accuracy1000: 0.3282 - 6s/epoch - 27ms/step
Epoch 11/50
224/224 - 6s - loss: 3.1684 - accuracy1000: 0.4326 - val_loss: 3.4088 - val_accuracy1000: 0.3394 - 6s/epoch - 27ms/step
Epoch 12/50
224/224 - 6s - loss: 3.1524 - accuracy1000: 0.4358 - val_loss: 3.4309 - val_accuracy1000: 0.3339 - 6s/epoch - 27ms/step
Epoch 13/50
224/224 - 6s - loss: 3.1296 - accuracy1000: 0.4455 - val_loss: 3.4669 - val_accuracy1000: 0.3259 - 6s/epoch - 27ms/step
Epoch 14/50
224/224 - 6s - loss: 3.1211 - accuracy1000: 0.4461 - val_loss: 3.4887 - val_accuracy1000: 0.3253 - 6s/epoch - 27ms/step
Epoch 15/50
224/224 - 6s - loss: 3.0960 - accuracy1000: 0.4523 - val_loss: 3.5013 - val_accuracy1000: 0.3234 - 6s/epoch - 27ms/step
Epoch 16/50
224/224 - 6s - loss: 3.0911 - accuracy1000: 0.4570 - val_loss: 3.5618 - val_accuracy1000: 0.3200 - 6s/epoch - 27ms/step
testing model: results/LILAK/W8/deepVOL_L2/h1000
Evaluating performance on  test set...
645/645 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1034057
{'0': {'precision': 0.39076889542804205, 'recall': 0.11840562719812427, 'f1-score': 0.1817421496819322, 'support': 60563}, '1': {'precision': 0.3387867208024839, 'recall': 0.06023738242350893, 'f1-score': 0.10228768185177842, 'support': 47097}, '2': {'precision': 0.35167403526798313, 'recall': 0.8487182173791562, 'f1-score': 0.49729104741050734, 'support': 57264}, 'accuracy': 0.3553697460648541, 'macro avg': {'precision': 0.3604098838328363, 'recall': 0.3424537423335965, 'f1-score': 0.260440292981406, 'support': 164924}, 'weighted avg': {'precision': 0.36235015376190777, 'recall': 0.3553697460648541, 'f1-score': 0.26861564904001456, 'support': 164924}}
[[ 7171  2910 50482]
 [ 5144  2837 39116]
 [ 6036  2627 48601]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986031
{'0': {'precision': 0.34242336331109174, 'recall': 0.1919657378293397, 'f1-score': 0.2460138256852051, 'support': 18446}, '1': {'precision': 0.5358989086731764, 'recall': 0.09733959311424101, 'f1-score': 0.16475366413561718, 'support': 19170}, '2': {'precision': 0.35999630749348044, 'recall': 0.7983928754222541, 'f1-score': 0.4962382096104599, 'support': 19538}, 'accuracy': 0.36753333100045493, 'macro avg': {'precision': 0.41277285982591616, 'recall': 0.3625660687886116, 'f1-score': 0.3023352331437607, 'support': 57154}, 'weighted avg': {'precision': 0.4133241994385136, 'recall': 0.36753333100045493, 'f1-score': 0.3042971779654659, 'support': 57154}}
[[ 3541   840 14065]
 [ 3637  1866 13667]
 [ 3163   776 15599]]
Evaluating performance on  val set...
68/68 - 1s - 989ms/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1024923
{'0': {'precision': 0.4172126265634306, 'recall': 0.2013509629203794, 'f1-score': 0.2716169057774331, 'support': 6958}, '1': {'precision': 0.32954545454545453, 'recall': 0.07440667094291212, 'f1-score': 0.12140240711669283, 'support': 4677}, '2': {'precision': 0.3284722763783826, 'recall': 0.7518743305962157, 'f1-score': 0.4572048846675713, 'support': 5602}, 'accuracy': 0.3458258397632999, 'macro avg': {'precision': 0.35841011916242255, 'recall': 0.3425439881531691, 'f1-score': 0.28340806585389905, 'support': 17237}, 'weighted avg': {'precision': 0.36458497643494464, 'recall': 0.3458258397632999, 'f1-score': 0.2911742909086202, 'support': 17237}}
[[1401  377 5180]
 [ 898  348 3431]
 [1059  331 4212]]
training model: results/LILAK/W8/deepVOL_L3/h10
Epoch 1/50
224/224 - 12s - loss: 3.3372 - accuracy10: 0.3642 - val_loss: 3.3890 - val_accuracy10: 0.3048 - 12s/epoch - 53ms/step
Epoch 2/50
224/224 - 9s - loss: 3.2870 - accuracy10: 0.3806 - val_loss: 3.3762 - val_accuracy10: 0.3140 - 9s/epoch - 42ms/step
Epoch 3/50
224/224 - 9s - loss: 3.2504 - accuracy10: 0.3970 - val_loss: 3.3833 - val_accuracy10: 0.3194 - 9s/epoch - 41ms/step
Epoch 4/50
224/224 - 9s - loss: 3.2113 - accuracy10: 0.4132 - val_loss: 3.3528 - val_accuracy10: 0.3443 - 9s/epoch - 39ms/step
Epoch 5/50
224/224 - 9s - loss: 3.1685 - accuracy10: 0.4276 - val_loss: 3.3599 - val_accuracy10: 0.3433 - 9s/epoch - 39ms/step
Epoch 6/50
224/224 - 9s - loss: 3.1447 - accuracy10: 0.4367 - val_loss: 3.3312 - val_accuracy10: 0.3447 - 9s/epoch - 39ms/step
Epoch 7/50
224/224 - 9s - loss: 3.1319 - accuracy10: 0.4398 - val_loss: 3.3357 - val_accuracy10: 0.3560 - 9s/epoch - 39ms/step
Epoch 8/50
224/224 - 9s - loss: 3.1135 - accuracy10: 0.4439 - val_loss: 3.3006 - val_accuracy10: 0.3712 - 9s/epoch - 39ms/step
Epoch 9/50
224/224 - 9s - loss: 3.1019 - accuracy10: 0.4513 - val_loss: 3.3060 - val_accuracy10: 0.3727 - 9s/epoch - 39ms/step
Epoch 10/50
224/224 - 9s - loss: 3.0849 - accuracy10: 0.4575 - val_loss: 3.2794 - val_accuracy10: 0.3853 - 9s/epoch - 39ms/step
Epoch 11/50
224/224 - 9s - loss: 3.0711 - accuracy10: 0.4611 - val_loss: 3.2629 - val_accuracy10: 0.3879 - 9s/epoch - 39ms/step
Epoch 12/50
224/224 - 9s - loss: 3.0665 - accuracy10: 0.4660 - val_loss: 3.2957 - val_accuracy10: 0.3800 - 9s/epoch - 39ms/step
Epoch 13/50
224/224 - 9s - loss: 3.0583 - accuracy10: 0.4637 - val_loss: 3.2780 - val_accuracy10: 0.3835 - 9s/epoch - 38ms/step
Epoch 14/50
224/224 - 9s - loss: 3.0421 - accuracy10: 0.4707 - val_loss: 3.2733 - val_accuracy10: 0.3860 - 9s/epoch - 38ms/step
Epoch 15/50
224/224 - 9s - loss: 3.0264 - accuracy10: 0.4732 - val_loss: 3.2471 - val_accuracy10: 0.4003 - 9s/epoch - 38ms/step
Epoch 16/50
224/224 - 9s - loss: 3.0168 - accuracy10: 0.4797 - val_loss: 3.2440 - val_accuracy10: 0.4011 - 9s/epoch - 39ms/step
Epoch 17/50
224/224 - 9s - loss: 3.0003 - accuracy10: 0.4848 - val_loss: 3.2468 - val_accuracy10: 0.4021 - 9s/epoch - 39ms/step
Epoch 18/50
224/224 - 9s - loss: 2.9903 - accuracy10: 0.4873 - val_loss: 3.2376 - val_accuracy10: 0.4056 - 9s/epoch - 39ms/step
Epoch 19/50
224/224 - 9s - loss: 2.9786 - accuracy10: 0.4889 - val_loss: 3.2352 - val_accuracy10: 0.4075 - 9s/epoch - 39ms/step
Epoch 20/50
224/224 - 9s - loss: 2.9645 - accuracy10: 0.4939 - val_loss: 3.2164 - val_accuracy10: 0.4161 - 9s/epoch - 39ms/step
Epoch 21/50
224/224 - 9s - loss: 2.9516 - accuracy10: 0.4984 - val_loss: 3.2151 - val_accuracy10: 0.4124 - 9s/epoch - 39ms/step
Epoch 22/50
224/224 - 9s - loss: 2.9390 - accuracy10: 0.5023 - val_loss: 3.2121 - val_accuracy10: 0.4179 - 9s/epoch - 39ms/step
Epoch 23/50
224/224 - 9s - loss: 2.9275 - accuracy10: 0.5027 - val_loss: 3.1952 - val_accuracy10: 0.4204 - 9s/epoch - 40ms/step
Epoch 24/50
224/224 - 9s - loss: 2.9126 - accuracy10: 0.5090 - val_loss: 3.1996 - val_accuracy10: 0.4191 - 9s/epoch - 39ms/step
Epoch 25/50
224/224 - 9s - loss: 2.8980 - accuracy10: 0.5135 - val_loss: 3.1913 - val_accuracy10: 0.4251 - 9s/epoch - 39ms/step
Epoch 26/50
224/224 - 9s - loss: 2.8792 - accuracy10: 0.5220 - val_loss: 3.1784 - val_accuracy10: 0.4260 - 9s/epoch - 39ms/step
Epoch 27/50
224/224 - 9s - loss: 2.8709 - accuracy10: 0.5228 - val_loss: 3.1863 - val_accuracy10: 0.4261 - 9s/epoch - 39ms/step
Epoch 28/50
224/224 - 9s - loss: 2.8561 - accuracy10: 0.5265 - val_loss: 3.1869 - val_accuracy10: 0.4326 - 9s/epoch - 39ms/step
Epoch 29/50
224/224 - 9s - loss: 2.8462 - accuracy10: 0.5310 - val_loss: 3.1765 - val_accuracy10: 0.4361 - 9s/epoch - 39ms/step
Epoch 30/50
224/224 - 9s - loss: 2.8324 - accuracy10: 0.5351 - val_loss: 3.1799 - val_accuracy10: 0.4357 - 9s/epoch - 40ms/step
Epoch 31/50
224/224 - 9s - loss: 2.8223 - accuracy10: 0.5380 - val_loss: 3.1854 - val_accuracy10: 0.4320 - 9s/epoch - 40ms/step
Epoch 32/50
224/224 - 9s - loss: 2.8135 - accuracy10: 0.5405 - val_loss: 3.1986 - val_accuracy10: 0.4309 - 9s/epoch - 38ms/step
Epoch 33/50
224/224 - 9s - loss: 2.8002 - accuracy10: 0.5450 - val_loss: 3.1810 - val_accuracy10: 0.4366 - 9s/epoch - 39ms/step
Epoch 34/50
224/224 - 9s - loss: 2.7866 - accuracy10: 0.5468 - val_loss: 3.1744 - val_accuracy10: 0.4417 - 9s/epoch - 39ms/step
Epoch 35/50
224/224 - 9s - loss: 2.7764 - accuracy10: 0.5492 - val_loss: 3.1941 - val_accuracy10: 0.4456 - 9s/epoch - 40ms/step
Epoch 36/50
224/224 - 9s - loss: 2.7658 - accuracy10: 0.5514 - val_loss: 3.1920 - val_accuracy10: 0.4425 - 9s/epoch - 39ms/step
Epoch 37/50
224/224 - 9s - loss: 2.7558 - accuracy10: 0.5535 - val_loss: 3.1974 - val_accuracy10: 0.4426 - 9s/epoch - 39ms/step
Epoch 38/50
224/224 - 9s - loss: 2.7474 - accuracy10: 0.5559 - val_loss: 3.2320 - val_accuracy10: 0.4391 - 9s/epoch - 38ms/step
Epoch 39/50
224/224 - 9s - loss: 2.7377 - accuracy10: 0.5604 - val_loss: 3.2187 - val_accuracy10: 0.4403 - 9s/epoch - 39ms/step
Epoch 40/50
224/224 - 9s - loss: 2.7263 - accuracy10: 0.5626 - val_loss: 3.2053 - val_accuracy10: 0.4460 - 9s/epoch - 39ms/step
Epoch 41/50
224/224 - 9s - loss: 2.7157 - accuracy10: 0.5636 - val_loss: 3.2239 - val_accuracy10: 0.4462 - 9s/epoch - 39ms/step
Epoch 42/50
224/224 - 9s - loss: 2.7063 - accuracy10: 0.5672 - val_loss: 3.2208 - val_accuracy10: 0.4496 - 9s/epoch - 38ms/step
Epoch 43/50
224/224 - 9s - loss: 2.6976 - accuracy10: 0.5690 - val_loss: 3.2246 - val_accuracy10: 0.4507 - 9s/epoch - 38ms/step
Epoch 44/50
224/224 - 9s - loss: 2.6798 - accuracy10: 0.5726 - val_loss: 3.2363 - val_accuracy10: 0.4508 - 9s/epoch - 38ms/step
testing model: results/LILAK/W8/deepVOL_L3/h10
Evaluating performance on  test set...
645/645 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0137182
{'0': {'precision': 0.3851264809478066, 'recall': 0.5016056385019602, 'f1-score': 0.4357158382843066, 'support': 47956}, '1': {'precision': 0.6691427993118105, 'recall': 0.4713422110696056, 'f1-score': 0.5530896832102256, 'support': 70138}, '2': {'precision': 0.39271377146195746, 'recall': 0.4449498184924194, 'f1-score': 0.4172030954359339, 'support': 46830}, 'accuracy': 0.47264800756712183, 'macro avg': {'precision': 0.48232768390719155, 'recall': 0.4726325560213284, 'f1-score': 0.46866953897682206, 'support': 164924}, 'weighted avg': {'precision': 0.5080658309041027, 'recall': 0.47264800756712183, 'f1-score': 0.4803752874113277, 'support': 164924}}
[[24055  8151 15750]
 [20607 33059 16472]
 [17798  8195 20837]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97564864
{'0': {'precision': 0.43867901886430183, 'recall': 0.5342569858529171, 'f1-score': 0.48177337304620577, 'support': 17106}, '1': {'precision': 0.6815545590433483, 'recall': 0.5003072331460674, 'f1-score': 0.577033081070136, 'support': 22784}, '2': {'precision': 0.44595835884874463, 'recall': 0.5061978683966636, 'f1-score': 0.47417254476397175, 'support': 17264}, 'accuracy': 0.5122476117157154, 'macro avg': {'precision': 0.5220639789187982, 'recall': 0.513587362465216, 'f1-score': 0.5109929996267711, 'support': 57154}, 'weighted avg': {'precision': 0.537698279684731, 'recall': 0.5122476117157154, 'f1-score': 0.5174520042557927, 'support': 57154}}
[[ 9139  2545  5422]
 [ 5950 11399  5435]
 [ 5744  2781  8739]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0591723
{'0': {'precision': 0.38705035971223023, 'recall': 0.5083144368858654, 'f1-score': 0.43947067472635193, 'support': 5292}, '1': {'precision': 0.5763779527559055, 'recall': 0.3907870652837096, 'f1-score': 0.4657758385601309, 'support': 6556}, '2': {'precision': 0.4049982882574461, 'recall': 0.43904249396919653, 'f1-score': 0.42133380820942035, 'support': 5389}, 'accuracy': 0.4419562568892499, 'macro avg': {'precision': 0.45614220024186064, 'recall': 0.44604799871292383, 'f1-score': 0.44219344049863435, 'support': 17237}, 'weighted avg': {'precision': 0.4646713544865242, 'recall': 0.4419562568892499, 'f1-score': 0.4438053664032395, 'support': 17237}}
[[2690  938 1664]
 [2182 2562 1812]
 [2078  945 2366]]
training model: results/LILAK/W8/deepVOL_L3/h20
Epoch 1/50
224/224 - 11s - loss: 3.3166 - accuracy20: 0.3715 - val_loss: 3.3422 - val_accuracy20: 0.3526 - 11s/epoch - 50ms/step
Epoch 2/50
224/224 - 9s - loss: 3.2784 - accuracy20: 0.3836 - val_loss: 3.3416 - val_accuracy20: 0.3503 - 9s/epoch - 38ms/step
Epoch 3/50
224/224 - 9s - loss: 3.2601 - accuracy20: 0.3873 - val_loss: 3.3692 - val_accuracy20: 0.3531 - 9s/epoch - 38ms/step
Epoch 4/50
224/224 - 9s - loss: 3.2251 - accuracy20: 0.3997 - val_loss: 3.2634 - val_accuracy20: 0.3715 - 9s/epoch - 39ms/step
Epoch 5/50
224/224 - 9s - loss: 3.1910 - accuracy20: 0.4136 - val_loss: 3.3852 - val_accuracy20: 0.3580 - 9s/epoch - 38ms/step
Epoch 6/50
224/224 - 9s - loss: 3.1702 - accuracy20: 0.4229 - val_loss: 3.3622 - val_accuracy20: 0.3651 - 9s/epoch - 39ms/step
Epoch 7/50
224/224 - 9s - loss: 3.1489 - accuracy20: 0.4306 - val_loss: 3.3321 - val_accuracy20: 0.3777 - 9s/epoch - 38ms/step
Epoch 8/50
224/224 - 9s - loss: 3.1436 - accuracy20: 0.4328 - val_loss: 3.2897 - val_accuracy20: 0.3866 - 9s/epoch - 39ms/step
Epoch 9/50
224/224 - 9s - loss: 3.1271 - accuracy20: 0.4400 - val_loss: 3.2809 - val_accuracy20: 0.3878 - 9s/epoch - 41ms/step
Epoch 10/50
224/224 - 9s - loss: 3.1203 - accuracy20: 0.4407 - val_loss: 3.2777 - val_accuracy20: 0.3867 - 9s/epoch - 38ms/step
Epoch 11/50
224/224 - 9s - loss: 3.1069 - accuracy20: 0.4450 - val_loss: 3.2685 - val_accuracy20: 0.3941 - 9s/epoch - 39ms/step
Epoch 12/50
224/224 - 9s - loss: 3.0899 - accuracy20: 0.4517 - val_loss: 3.2473 - val_accuracy20: 0.3892 - 9s/epoch - 39ms/step
Epoch 13/50
224/224 - 9s - loss: 3.0768 - accuracy20: 0.4527 - val_loss: 3.2419 - val_accuracy20: 0.3988 - 9s/epoch - 39ms/step
Epoch 14/50
224/224 - 9s - loss: 3.0660 - accuracy20: 0.4539 - val_loss: 3.2237 - val_accuracy20: 0.4032 - 9s/epoch - 41ms/step
Epoch 15/50
224/224 - 9s - loss: 3.0547 - accuracy20: 0.4600 - val_loss: 3.2233 - val_accuracy20: 0.4062 - 9s/epoch - 39ms/step
Epoch 16/50
224/224 - 9s - loss: 3.0394 - accuracy20: 0.4629 - val_loss: 3.2153 - val_accuracy20: 0.4104 - 9s/epoch - 39ms/step
Epoch 17/50
224/224 - 9s - loss: 3.0277 - accuracy20: 0.4671 - val_loss: 3.2141 - val_accuracy20: 0.4145 - 9s/epoch - 39ms/step
Epoch 18/50
224/224 - 9s - loss: 3.0136 - accuracy20: 0.4704 - val_loss: 3.2136 - val_accuracy20: 0.4159 - 9s/epoch - 39ms/step
Epoch 19/50
224/224 - 9s - loss: 3.0065 - accuracy20: 0.4725 - val_loss: 3.2167 - val_accuracy20: 0.4169 - 9s/epoch - 38ms/step
Epoch 20/50
224/224 - 9s - loss: 2.9924 - accuracy20: 0.4762 - val_loss: 3.2121 - val_accuracy20: 0.4185 - 9s/epoch - 41ms/step
Epoch 21/50
224/224 - 9s - loss: 2.9844 - accuracy20: 0.4790 - val_loss: 3.2025 - val_accuracy20: 0.4146 - 9s/epoch - 39ms/step
Epoch 22/50
224/224 - 8s - loss: 2.9740 - accuracy20: 0.4817 - val_loss: 3.2065 - val_accuracy20: 0.4214 - 8s/epoch - 38ms/step
Epoch 23/50
224/224 - 9s - loss: 2.9606 - accuracy20: 0.4862 - val_loss: 3.2067 - val_accuracy20: 0.4167 - 9s/epoch - 41ms/step
Epoch 24/50
224/224 - 9s - loss: 2.9566 - accuracy20: 0.4897 - val_loss: 3.2073 - val_accuracy20: 0.4179 - 9s/epoch - 41ms/step
Epoch 25/50
224/224 - 9s - loss: 2.9401 - accuracy20: 0.4925 - val_loss: 3.1990 - val_accuracy20: 0.4229 - 9s/epoch - 39ms/step
Epoch 26/50
224/224 - 9s - loss: 2.9358 - accuracy20: 0.4936 - val_loss: 3.2124 - val_accuracy20: 0.4209 - 9s/epoch - 41ms/step
Epoch 27/50
224/224 - 9s - loss: 2.9217 - accuracy20: 0.4981 - val_loss: 3.2120 - val_accuracy20: 0.4206 - 9s/epoch - 41ms/step
Epoch 28/50
224/224 - 9s - loss: 2.9140 - accuracy20: 0.5006 - val_loss: 3.2160 - val_accuracy20: 0.4160 - 9s/epoch - 38ms/step
Epoch 29/50
224/224 - 9s - loss: 2.9042 - accuracy20: 0.5054 - val_loss: 3.2140 - val_accuracy20: 0.4268 - 9s/epoch - 38ms/step
Epoch 30/50
224/224 - 9s - loss: 2.8939 - accuracy20: 0.5070 - val_loss: 3.2192 - val_accuracy20: 0.4228 - 9s/epoch - 38ms/step
Epoch 31/50
224/224 - 9s - loss: 2.8828 - accuracy20: 0.5076 - val_loss: 3.2143 - val_accuracy20: 0.4283 - 9s/epoch - 38ms/step
Epoch 32/50
224/224 - 9s - loss: 2.8788 - accuracy20: 0.5095 - val_loss: 3.2252 - val_accuracy20: 0.4251 - 9s/epoch - 38ms/step
Epoch 33/50
224/224 - 9s - loss: 2.8664 - accuracy20: 0.5140 - val_loss: 3.2178 - val_accuracy20: 0.4241 - 9s/epoch - 41ms/step
Epoch 34/50
224/224 - 9s - loss: 2.8514 - accuracy20: 0.5190 - val_loss: 3.2321 - val_accuracy20: 0.4279 - 9s/epoch - 41ms/step
Epoch 35/50
224/224 - 9s - loss: 2.8411 - accuracy20: 0.5224 - val_loss: 3.2200 - val_accuracy20: 0.4323 - 9s/epoch - 40ms/step
testing model: results/LILAK/W8/deepVOL_L3/h20
Evaluating performance on  test set...
645/645 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.030968
{'0': {'precision': 0.40218813551306104, 'recall': 0.46678254505534716, 'f1-score': 0.432084547117404, 'support': 54655}, '1': {'precision': 0.5859227367477743, 'recall': 0.5281494749411724, 'f1-score': 0.555538110586736, 'support': 56946}, '2': {'precision': 0.4015151515151515, 'recall': 0.37769817902218555, 'f1-score': 0.3892426775412387, 'support': 53323}, 'accuracy': 0.4591690718148966, 'macro avg': {'precision': 0.4632086745919956, 'recall': 0.4575433996729017, 'f1-score': 0.4589551117484596, 'support': 164924}, 'weighted avg': {'precision': 0.46541159041466085, 'recall': 0.4591690718148966, 'f1-score': 0.4608597988328288, 'support': 164924}}
[[25512 10751 18392]
 [15242 30076 11628]
 [22679 10504 20140]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0106411
{'0': {'precision': 0.41756295624379075, 'recall': 0.511454420401037, 'f1-score': 0.45976410158850944, 'support': 18901}, '1': {'precision': 0.5886293369975953, 'recall': 0.5441697983380088, 'f1-score': 0.56552710470585, 'support': 18893}, '2': {'precision': 0.43786660216484247, 'recall': 0.3740185950413223, 'f1-score': 0.4034320416747918, 'support': 19360}, 'accuracy': 0.4757147356265528, 'macro avg': {'precision': 0.48135296513540954, 'recall': 0.4765476045934561, 'f1-score': 0.4762410826563838, 'support': 57154}, 'weighted avg': {'precision': 0.48098871326190307, 'recall': 0.4757147356265528, 'f1-score': 0.47564386044994245, 'support': 57154}}
[[ 9667  3473  5761]
 [ 5077 10281  3535]
 [ 8407  3712  7241]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0672252
{'0': {'precision': 0.3931234989255467, 'recall': 0.5198930123704447, 'f1-score': 0.44770747858633847, 'support': 5982}, '1': {'precision': 0.4866496401207337, 'recall': 0.3983276320790574, 'f1-score': 0.4380813042115164, 'support': 5262}, '2': {'precision': 0.4050607690775055, 'recall': 0.3392291006173869, 'f1-score': 0.36923356338539776, 'support': 5993}, 'accuracy': 0.41996867204269883, 'macro avg': {'precision': 0.4282779693745953, 'recall': 0.41914991502229637, 'f1-score': 0.4183407820610842, 'support': 17237}, 'weighted avg': {'precision': 0.4258249327591467, 'recall': 0.41996867204269883, 'f1-score': 0.41748487004891605, 'support': 17237}}
[[3110 1083 1789]
 [1969 2096 1197]
 [2832 1128 2033]]
training model: results/LILAK/W8/deepVOL_L3/h30
Epoch 1/50
224/224 - 11s - loss: 3.3143 - accuracy30: 0.3701 - val_loss: 3.3579 - val_accuracy30: 0.3382 - 11s/epoch - 50ms/step
Epoch 2/50
224/224 - 9s - loss: 3.2906 - accuracy30: 0.3760 - val_loss: 3.3889 - val_accuracy30: 0.3396 - 9s/epoch - 41ms/step
Epoch 3/50
224/224 - 9s - loss: 3.2784 - accuracy30: 0.3794 - val_loss: 3.3238 - val_accuracy30: 0.3433 - 9s/epoch - 42ms/step
Epoch 4/50
224/224 - 9s - loss: 3.2713 - accuracy30: 0.3809 - val_loss: 3.3547 - val_accuracy30: 0.3390 - 9s/epoch - 39ms/step
Epoch 5/50
224/224 - 9s - loss: 3.2569 - accuracy30: 0.3891 - val_loss: 3.3717 - val_accuracy30: 0.3403 - 9s/epoch - 39ms/step
Epoch 6/50
224/224 - 9s - loss: 3.2386 - accuracy30: 0.3950 - val_loss: 3.3891 - val_accuracy30: 0.3450 - 9s/epoch - 41ms/step
Epoch 7/50
224/224 - 9s - loss: 3.2285 - accuracy30: 0.3958 - val_loss: 3.3991 - val_accuracy30: 0.3460 - 9s/epoch - 41ms/step
Epoch 8/50
224/224 - 9s - loss: 3.2031 - accuracy30: 0.4096 - val_loss: 3.3356 - val_accuracy30: 0.3620 - 9s/epoch - 42ms/step
Epoch 9/50
224/224 - 9s - loss: 3.2050 - accuracy30: 0.4054 - val_loss: 3.3949 - val_accuracy30: 0.3512 - 9s/epoch - 41ms/step
Epoch 10/50
224/224 - 9s - loss: 3.1820 - accuracy30: 0.4173 - val_loss: 3.3590 - val_accuracy30: 0.3538 - 9s/epoch - 42ms/step
Epoch 11/50
224/224 - 9s - loss: 3.1656 - accuracy30: 0.4231 - val_loss: 3.3686 - val_accuracy30: 0.3563 - 9s/epoch - 41ms/step
Epoch 12/50
224/224 - 9s - loss: 3.1567 - accuracy30: 0.4196 - val_loss: 3.4193 - val_accuracy30: 0.3502 - 9s/epoch - 42ms/step
Epoch 13/50
224/224 - 9s - loss: 3.1585 - accuracy30: 0.4248 - val_loss: 3.3841 - val_accuracy30: 0.3508 - 9s/epoch - 41ms/step
testing model: results/LILAK/W8/deepVOL_L3/h30
Evaluating performance on  test set...
645/645 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1096995
{'0': {'precision': 0.32699521994312336, 'recall': 0.3980225000460312, 'f1-score': 0.359029721223395, 'support': 54311}, '1': {'precision': 0.3742228898068177, 'recall': 0.15525090443302003, 'f1-score': 0.21945729036678166, 'support': 57771}, '2': {'precision': 0.32430626995684647, 'recall': 0.459369440974982, 'f1-score': 0.3801990743278697, 'support': 52842}, 'accuracy': 0.33263806359292764, 'macro avg': {'precision': 0.3418414599022625, 'recall': 0.3375476151513444, 'f1-score': 0.3195620286393488, 'support': 164924}, 'weighted avg': {'precision': 0.34267698985241885, 'recall': 0.33263806359292764, 'f1-score': 0.31692179304877666, 'support': 164924}}
[[21617  7571 25123]
 [23350  8969 25452]
 [21141  7427 24274]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1033156
{'0': {'precision': 0.3352895901481624, 'recall': 0.3673447876040898, 'f1-score': 0.3505859866203913, 'support': 18974}, '1': {'precision': 0.37455061494796593, 'recall': 0.21037249588182155, 'f1-score': 0.26942053149137435, 'support': 18819}, '2': {'precision': 0.3469142502713599, 'recall': 0.4622178606476938, 'f1-score': 0.39635051044134906, 'support': 19361}, 'accuracy': 0.34779717954998773, 'macro avg': {'precision': 0.3522514851224961, 'recall': 0.34664504804453505, 'f1-score': 0.33878567618437155, 'support': 57154}, 'weighted avg': {'precision': 0.35215487114953986, 'recall': 0.34779717954998773, 'f1-score': 0.33936357428922626, 'support': 57154}}
[[6970 3297 8707]
 [6720 3959 8140]
 [7098 3314 8949]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1056949
{'0': {'precision': 0.3496199782844734, 'recall': 0.37686005684668117, 'f1-score': 0.36272932088831666, 'support': 5981}, '1': {'precision': 0.3204062788550323, 'recall': 0.19270640503517217, 'f1-score': 0.24066581898046469, 'support': 5402}, '2': {'precision': 0.34610794324360167, 'recall': 0.44584899214212503, 'f1-score': 0.3896976483762598, 'support': 5854}, 'accuracy': 0.34257701456169865, 'macro avg': {'precision': 0.33871140012770246, 'recall': 0.3384718180079928, 'f1-score': 0.3310309294150137, 'support': 17237}, 'weighted avg': {'precision': 0.33927178211071324, 'recall': 0.34257701456169865, 'f1-score': 0.333634092705234, 'support': 17237}}
[[2254 1118 2609]
 [2039 1041 2322]
 [2154 1090 2610]]
training model: results/LILAK/W8/deepVOL_L3/h50
Epoch 1/50
224/224 - 11s - loss: 3.3274 - accuracy50: 0.3649 - val_loss: 3.3749 - val_accuracy50: 0.3412 - 11s/epoch - 48ms/step
Epoch 2/50
224/224 - 9s - loss: 3.2826 - accuracy50: 0.3755 - val_loss: 3.3861 - val_accuracy50: 0.3421 - 9s/epoch - 40ms/step
Epoch 3/50
224/224 - 9s - loss: 3.2732 - accuracy50: 0.3797 - val_loss: 3.3420 - val_accuracy50: 0.3445 - 9s/epoch - 39ms/step
Epoch 4/50
224/224 - 9s - loss: 3.2634 - accuracy50: 0.3820 - val_loss: 3.3487 - val_accuracy50: 0.3512 - 9s/epoch - 39ms/step
Epoch 5/50
224/224 - 9s - loss: 3.2517 - accuracy50: 0.3914 - val_loss: 3.3518 - val_accuracy50: 0.3490 - 9s/epoch - 38ms/step
Epoch 6/50
224/224 - 9s - loss: 3.2528 - accuracy50: 0.3876 - val_loss: 3.3412 - val_accuracy50: 0.3501 - 9s/epoch - 40ms/step
Epoch 7/50
224/224 - 9s - loss: 3.2433 - accuracy50: 0.3936 - val_loss: 3.3310 - val_accuracy50: 0.3537 - 9s/epoch - 39ms/step
Epoch 8/50
224/224 - 9s - loss: 3.2132 - accuracy50: 0.4065 - val_loss: 3.3300 - val_accuracy50: 0.3484 - 9s/epoch - 39ms/step
Epoch 9/50
224/224 - 9s - loss: 3.2028 - accuracy50: 0.4089 - val_loss: 3.3110 - val_accuracy50: 0.3551 - 9s/epoch - 38ms/step
Epoch 10/50
224/224 - 9s - loss: 3.2050 - accuracy50: 0.4064 - val_loss: 3.3241 - val_accuracy50: 0.3556 - 9s/epoch - 39ms/step
Epoch 11/50
224/224 - 9s - loss: 3.1860 - accuracy50: 0.4152 - val_loss: 3.3033 - val_accuracy50: 0.3609 - 9s/epoch - 40ms/step
Epoch 12/50
224/224 - 9s - loss: 3.1699 - accuracy50: 0.4200 - val_loss: 3.2940 - val_accuracy50: 0.3649 - 9s/epoch - 40ms/step
Epoch 13/50
224/224 - 9s - loss: 3.1568 - accuracy50: 0.4270 - val_loss: 3.2979 - val_accuracy50: 0.3662 - 9s/epoch - 39ms/step
Epoch 14/50
224/224 - 9s - loss: 3.1446 - accuracy50: 0.4284 - val_loss: 3.2903 - val_accuracy50: 0.3723 - 9s/epoch - 39ms/step
Epoch 15/50
224/224 - 9s - loss: 3.1310 - accuracy50: 0.4315 - val_loss: 3.2889 - val_accuracy50: 0.3683 - 9s/epoch - 39ms/step
Epoch 16/50
224/224 - 9s - loss: 3.1220 - accuracy50: 0.4352 - val_loss: 3.2967 - val_accuracy50: 0.3627 - 9s/epoch - 39ms/step
Epoch 17/50
224/224 - 9s - loss: 3.1111 - accuracy50: 0.4381 - val_loss: 3.3051 - val_accuracy50: 0.3663 - 9s/epoch - 39ms/step
Epoch 18/50
224/224 - 9s - loss: 3.1036 - accuracy50: 0.4405 - val_loss: 3.3052 - val_accuracy50: 0.3689 - 9s/epoch - 38ms/step
Epoch 19/50
224/224 - 9s - loss: 3.0895 - accuracy50: 0.4434 - val_loss: 3.3109 - val_accuracy50: 0.3628 - 9s/epoch - 39ms/step
Epoch 20/50
224/224 - 9s - loss: 3.0810 - accuracy50: 0.4461 - val_loss: 3.3058 - val_accuracy50: 0.3688 - 9s/epoch - 39ms/step
Epoch 21/50
224/224 - 9s - loss: 3.0662 - accuracy50: 0.4537 - val_loss: 3.3217 - val_accuracy50: 0.3642 - 9s/epoch - 39ms/step
Epoch 22/50
224/224 - 9s - loss: 3.0608 - accuracy50: 0.4563 - val_loss: 3.3210 - val_accuracy50: 0.3684 - 9s/epoch - 39ms/step
Epoch 23/50
224/224 - 9s - loss: 3.0491 - accuracy50: 0.4599 - val_loss: 3.3192 - val_accuracy50: 0.3683 - 9s/epoch - 39ms/step
Epoch 24/50
224/224 - 9s - loss: 3.0435 - accuracy50: 0.4616 - val_loss: 3.3250 - val_accuracy50: 0.3637 - 9s/epoch - 41ms/step
Epoch 25/50
224/224 - 9s - loss: 3.0297 - accuracy50: 0.4653 - val_loss: 3.3205 - val_accuracy50: 0.3654 - 9s/epoch - 39ms/step
testing model: results/LILAK/W8/deepVOL_L3/h50
Evaluating performance on  test set...
645/645 - 12s - 12s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0781343
{'0': {'precision': 0.37454061325530114, 'recall': 0.4817946659530818, 'f1-score': 0.42145097610836285, 'support': 56055}, '1': {'precision': 0.5335247531000537, 'recall': 0.30924686345513736, 'f1-score': 0.39154345787359185, 'support': 54678}, '2': {'precision': 0.3441365093907467, 'recall': 0.3881640862873909, 'f1-score': 0.36482677882322334, 'support': 54191}, 'accuracy': 0.3938238218815939, 'macro avg': {'precision': 0.41740062524870053, 'recall': 0.39306853856520335, 'f1-score': 0.39260707093505937, 'support': 164924}, 'weighted avg': {'precision': 0.41725911393383974, 'recall': 0.3938238218815939, 'f1-score': 0.39292992909810476, 'support': 164924}}
[[27007  7606 21442]
 [19122 16909 18647]
 [25978  7178 21035]]
Evaluating performance on  train set...
224/224 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0570008
{'0': {'precision': 0.38654827130171926, 'recall': 0.4347641308967276, 'f1-score': 0.40924092409240925, 'support': 18824}, '1': {'precision': 0.5187033955752758, 'recall': 0.4426272612536811, 'f1-score': 0.47765513719036407, 'support': 19016}, '2': {'precision': 0.3927613262465199, 'recall': 0.401729315522419, 'f1-score': 0.39719470680078833, 'support': 19314}, 'accuracy': 0.42621688770689714, 'macro avg': {'precision': 0.4326709977078383, 'recall': 0.4263735692242759, 'f1-score': 0.4280302560278539, 'support': 57154}, 'weighted avg': {'precision': 0.43261785149540344, 'recall': 0.42621688770689714, 'f1-score': 0.4279325998368951, 'support': 57154}}
[[8184 3881 6759]
 [5362 8417 5237]
 [7626 3929 7759]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0966208
{'0': {'precision': 0.3712351478308925, 'recall': 0.44143256119599145, 'f1-score': 0.4033020637898687, 'support': 6087}, '1': {'precision': 0.3824203821656051, 'recall': 0.2851985559566787, 'f1-score': 0.32673051806704395, 'support': 5263}, '2': {'precision': 0.35857754362858085, 'recall': 0.36996772549685747, 'f1-score': 0.36418359668924, 'support': 5887}, 'accuracy': 0.36932180773916573, 'macro avg': {'precision': 0.3707443578750261, 'recall': 0.36553294754984256, 'f1-score': 0.3647387261820509, 'support': 17237}, 'weighted avg': {'precision': 0.37032736645156794, 'recall': 0.36932180773916573, 'f1-score': 0.36656211710769504, 'support': 17237}}
[[2687 1256 2144]
 [2010 1501 1752]
 [2541 1168 2178]]
training model: results/LILAK/W8/deepVOL_L3/h100
Epoch 1/50
224/224 - 12s - loss: 3.3381 - accuracy100: 0.3572 - val_loss: 3.4450 - val_accuracy100: 0.3287 - 12s/epoch - 53ms/step
Epoch 2/50
224/224 - 9s - loss: 3.3191 - accuracy100: 0.3642 - val_loss: 3.3420 - val_accuracy100: 0.3393 - 9s/epoch - 39ms/step
Epoch 3/50
224/224 - 9s - loss: 3.2959 - accuracy100: 0.3679 - val_loss: 3.3484 - val_accuracy100: 0.3394 - 9s/epoch - 38ms/step
Epoch 4/50
224/224 - 9s - loss: 3.2866 - accuracy100: 0.3695 - val_loss: 3.3312 - val_accuracy100: 0.3451 - 9s/epoch - 39ms/step
Epoch 5/50
224/224 - 9s - loss: 3.2957 - accuracy100: 0.3643 - val_loss: 3.3438 - val_accuracy100: 0.3378 - 9s/epoch - 38ms/step
Epoch 6/50
224/224 - 9s - loss: 3.2792 - accuracy100: 0.3670 - val_loss: 3.3252 - val_accuracy100: 0.3450 - 9s/epoch - 39ms/step
Epoch 7/50
224/224 - 9s - loss: 3.2783 - accuracy100: 0.3701 - val_loss: 3.3156 - val_accuracy100: 0.3488 - 9s/epoch - 39ms/step
Epoch 8/50
224/224 - 9s - loss: 3.2797 - accuracy100: 0.3709 - val_loss: 3.3136 - val_accuracy100: 0.3423 - 9s/epoch - 39ms/step
Epoch 9/50
224/224 - 9s - loss: 3.2632 - accuracy100: 0.3818 - val_loss: 3.3206 - val_accuracy100: 0.3517 - 9s/epoch - 39ms/step
Epoch 10/50
224/224 - 9s - loss: 3.2650 - accuracy100: 0.3811 - val_loss: 3.3145 - val_accuracy100: 0.3415 - 9s/epoch - 41ms/step
Epoch 11/50
224/224 - 9s - loss: 3.2493 - accuracy100: 0.3897 - val_loss: 3.3132 - val_accuracy100: 0.3447 - 9s/epoch - 39ms/step
Epoch 12/50
224/224 - 9s - loss: 3.2447 - accuracy100: 0.3911 - val_loss: 3.3136 - val_accuracy100: 0.3477 - 9s/epoch - 39ms/step
Epoch 13/50
224/224 - 9s - loss: 3.2287 - accuracy100: 0.4003 - val_loss: 3.3118 - val_accuracy100: 0.3436 - 9s/epoch - 39ms/step
Epoch 14/50
224/224 - 9s - loss: 3.2211 - accuracy100: 0.4019 - val_loss: 3.3062 - val_accuracy100: 0.3446 - 9s/epoch - 41ms/step
Epoch 15/50
224/224 - 9s - loss: 3.2003 - accuracy100: 0.4076 - val_loss: 3.3083 - val_accuracy100: 0.3425 - 9s/epoch - 39ms/step
Epoch 16/50
224/224 - 9s - loss: 3.1809 - accuracy100: 0.4155 - val_loss: 3.3093 - val_accuracy100: 0.3390 - 9s/epoch - 38ms/step
Epoch 17/50
224/224 - 9s - loss: 3.1645 - accuracy100: 0.4207 - val_loss: 3.3100 - val_accuracy100: 0.3354 - 9s/epoch - 39ms/step
Epoch 18/50
224/224 - 9s - loss: 3.1519 - accuracy100: 0.4230 - val_loss: 3.3125 - val_accuracy100: 0.3427 - 9s/epoch - 39ms/step
Epoch 19/50
224/224 - 9s - loss: 3.1372 - accuracy100: 0.4269 - val_loss: 3.3131 - val_accuracy100: 0.3402 - 9s/epoch - 39ms/step
Epoch 20/50
224/224 - 9s - loss: 3.1241 - accuracy100: 0.4363 - val_loss: 3.3152 - val_accuracy100: 0.3434 - 9s/epoch - 39ms/step
Epoch 21/50
224/224 - 9s - loss: 3.1067 - accuracy100: 0.4465 - val_loss: 3.3262 - val_accuracy100: 0.3408 - 9s/epoch - 39ms/step
Epoch 22/50
224/224 - 9s - loss: 3.0968 - accuracy100: 0.4480 - val_loss: 3.3310 - val_accuracy100: 0.3354 - 9s/epoch - 39ms/step
Epoch 23/50
224/224 - 9s - loss: 3.0841 - accuracy100: 0.4513 - val_loss: 3.3350 - val_accuracy100: 0.3347 - 9s/epoch - 38ms/step
Epoch 24/50
224/224 - 9s - loss: 3.0720 - accuracy100: 0.4570 - val_loss: 3.3367 - val_accuracy100: 0.3393 - 9s/epoch - 38ms/step
testing model: results/LILAK/W8/deepVOL_L3/h100
Evaluating performance on  test set...
645/645 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.095064
{'0': {'precision': 0.34744281365841895, 'recall': 0.40844272023524825, 'f1-score': 0.375481422976395, 'support': 56451}, '1': {'precision': 0.40769965786148016, 'recall': 0.24790553837503515, 'f1-score': 0.3083288654747197, 'support': 53355}, '2': {'precision': 0.3435169920900195, 'recall': 0.41207953844479117, 'f1-score': 0.3746875953710501, 'support': 55118}, 'accuracy': 0.35772234483762216, 'macro avg': {'precision': 0.36621982120330615, 'recall': 0.3561425990183582, 'f1-score': 0.3528326279407216, 'support': 164924}, 'weighted avg': {'precision': 0.36562464583110027, 'recall': 0.35772234483762216, 'f1-score': 0.3534914221550877, 'support': 164924}}
[[23057  9836 23558]
 [20280 13227 19848]
 [23025  9380 22713]]
Evaluating performance on  train set...
224/224 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0886439
{'0': {'precision': 0.3785070140280561, 'recall': 0.3165558057926989, 'f1-score': 0.34477054276831803, 'support': 19093}, '1': {'precision': 0.4017029423619508, 'recall': 0.42127232378738244, 'f1-score': 0.4112549646670449, 'support': 18926}, '2': {'precision': 0.3623113693879464, 'recall': 0.4040240397177946, 'f1-score': 0.3820324660885034, 'support': 19135}, 'accuracy': 0.3805157994191133, 'macro avg': {'precision': 0.3808404419259845, 'recall': 0.3806173897659586, 'f1-score': 0.37935265784128874, 'support': 57154}, 'weighted avg': {'precision': 0.3807658669422667, 'recall': 0.3805157994191133, 'f1-score': 0.3792614108018249, 'support': 57154}}
[[6044 5937 7112]
 [4458 7973 6495]
 [5466 5938 7731]]
Evaluating performance on  val set...
68/68 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1021991
{'0': {'precision': 0.36107732406602955, 'recall': 0.3431874483897605, 'f1-score': 0.3519051651143099, 'support': 6055}, '1': {'precision': 0.32617606870974036, 'recall': 0.3115793399216856, 'f1-score': 0.3187106618348274, 'support': 5363}, '2': {'precision': 0.3445510300361692, 'recall': 0.3765251761471043, 'f1-score': 0.3598292001970767, 'support': 5819}, 'accuracy': 0.3446075303126994, 'macro avg': {'precision': 0.3439348076039797, 'recall': 0.3437639881528501, 'f1-score': 0.34348167571540467, 'support': 17237}, 'weighted avg': {'precision': 0.3446393164408317, 'recall': 0.3446075303126994, 'f1-score': 0.34425231595603156, 'support': 17237}}
[[2078 1754 2223]
 [1747 1671 1945]
 [1930 1698 2191]]
training model: results/LILAK/W8/deepVOL_L3/h200
Epoch 1/50
224/224 - 10s - loss: 3.3311 - accuracy200: 0.3609 - val_loss: 3.4090 - val_accuracy200: 0.3411 - 10s/epoch - 46ms/step
Epoch 2/50
224/224 - 9s - loss: 3.2975 - accuracy200: 0.3728 - val_loss: 3.3307 - val_accuracy200: 0.3486 - 9s/epoch - 39ms/step
Epoch 3/50
224/224 - 9s - loss: 3.2912 - accuracy200: 0.3734 - val_loss: 3.3346 - val_accuracy200: 0.3473 - 9s/epoch - 39ms/step
Epoch 4/50
224/224 - 9s - loss: 3.2885 - accuracy200: 0.3726 - val_loss: 3.3451 - val_accuracy200: 0.3467 - 9s/epoch - 40ms/step
Epoch 5/50
224/224 - 9s - loss: 3.2837 - accuracy200: 0.3719 - val_loss: 3.3192 - val_accuracy200: 0.3486 - 9s/epoch - 39ms/step
Epoch 6/50
224/224 - 9s - loss: 3.2692 - accuracy200: 0.3778 - val_loss: 3.3365 - val_accuracy200: 0.3464 - 9s/epoch - 39ms/step
Epoch 7/50
224/224 - 9s - loss: 3.2674 - accuracy200: 0.3759 - val_loss: 3.3164 - val_accuracy200: 0.3530 - 9s/epoch - 39ms/step
Epoch 8/50
224/224 - 9s - loss: 3.2572 - accuracy200: 0.3823 - val_loss: 3.3139 - val_accuracy200: 0.3469 - 9s/epoch - 39ms/step
Epoch 9/50
224/224 - 9s - loss: 3.2527 - accuracy200: 0.3886 - val_loss: 3.3332 - val_accuracy200: 0.3510 - 9s/epoch - 40ms/step
Epoch 10/50
224/224 - 9s - loss: 3.2459 - accuracy200: 0.3926 - val_loss: 3.3176 - val_accuracy200: 0.3517 - 9s/epoch - 39ms/step
Epoch 11/50
224/224 - 9s - loss: 3.2464 - accuracy200: 0.3951 - val_loss: 3.3034 - val_accuracy200: 0.3506 - 9s/epoch - 39ms/step
Epoch 12/50
224/224 - 9s - loss: 3.2360 - accuracy200: 0.3999 - val_loss: 3.3183 - val_accuracy200: 0.3585 - 9s/epoch - 39ms/step
Epoch 13/50
224/224 - 9s - loss: 3.2324 - accuracy200: 0.3994 - val_loss: 3.3238 - val_accuracy200: 0.3557 - 9s/epoch - 38ms/step
Epoch 14/50
224/224 - 9s - loss: 3.2277 - accuracy200: 0.4082 - val_loss: 3.3371 - val_accuracy200: 0.3512 - 9s/epoch - 38ms/step
Epoch 15/50
224/224 - 9s - loss: 3.2085 - accuracy200: 0.4167 - val_loss: 3.3331 - val_accuracy200: 0.3466 - 9s/epoch - 39ms/step
Epoch 16/50
224/224 - 9s - loss: 3.2026 - accuracy200: 0.4220 - val_loss: 3.3344 - val_accuracy200: 0.3536 - 9s/epoch - 39ms/step
Epoch 17/50
224/224 - 9s - loss: 3.1833 - accuracy200: 0.4242 - val_loss: 3.3355 - val_accuracy200: 0.3603 - 9s/epoch - 38ms/step
Epoch 18/50
224/224 - 9s - loss: 3.1701 - accuracy200: 0.4308 - val_loss: 3.3395 - val_accuracy200: 0.3568 - 9s/epoch - 39ms/step
Epoch 19/50
224/224 - 9s - loss: 3.1534 - accuracy200: 0.4430 - val_loss: 3.3559 - val_accuracy200: 0.3563 - 9s/epoch - 39ms/step
Epoch 20/50
224/224 - 9s - loss: 3.1364 - accuracy200: 0.4463 - val_loss: 3.3640 - val_accuracy200: 0.3558 - 9s/epoch - 38ms/step
Epoch 21/50
224/224 - 9s - loss: 3.1241 - accuracy200: 0.4499 - val_loss: 3.3576 - val_accuracy200: 0.3600 - 9s/epoch - 39ms/step
testing model: results/LILAK/W8/deepVOL_L3/h200
Evaluating performance on  test set...
645/645 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1098709
{'0': {'precision': 0.33719220532673233, 'recall': 0.3292503407542026, 'f1-score': 0.33317395222244706, 'support': 55025}, '1': {'precision': 0.3953464143080396, 'recall': 0.20850580607348254, 'f1-score': 0.2730205173096063, 'support': 54598}, '2': {'precision': 0.3312621359223301, 'recall': 0.4935896276740023, 'f1-score': 0.3964531847989485, 'support': 55301}, 'accuracy': 0.3443828672600713, 'macro avg': {'precision': 0.35460025185236727, 'recall': 0.3437819248338958, 'f1-score': 0.33421588477700065, 'support': 164924}, 'weighted avg': {'precision': 0.3544557008387777, 'recall': 0.3443828672600713, 'f1-score': 0.3344784779515212, 'support': 164924}}
[[18117  8200 28708]
 [16818 11384 26396]
 [18794  9211 27296]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0869098
{'0': {'precision': 0.3623727262326965, 'recall': 0.33125915080527085, 'f1-score': 0.34611812271212367, 'support': 19124}, '1': {'precision': 0.4300602409638554, 'recall': 0.37892781316348195, 'f1-score': 0.40287810383747186, 'support': 18840}, '2': {'precision': 0.3716626213592233, 'recall': 0.44684731631057845, 'f1-score': 0.4058019024182481, 'support': 19190}, 'accuracy': 0.3857822724568709, 'macro avg': {'precision': 0.3880318628519251, 'recall': 0.3856780934264437, 'f1-score': 0.38493270965594784, 'support': 57154}, 'weighted avg': {'precision': 0.38780411974868984, 'recall': 0.3857822724568709, 'f1-score': 0.38486763765354665, 'support': 57154}}
[[6335 4769 8020]
 [5224 7139 6477]
 [5923 4692 8575]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1010331
{'0': {'precision': 0.3617956064947469, 'recall': 0.3087707857841539, 'f1-score': 0.33318673586067377, 'support': 6134}, '1': {'precision': 0.34232792133546763, 'recall': 0.2852515243902439, 'f1-score': 0.3111942625506704, 'support': 5248}, '2': {'precision': 0.35260191375016386, 'recall': 0.4594363791631085, 'f1-score': 0.39899139721150995, 'support': 5855}, 'accuracy': 0.3527876080524453, 'macro avg': {'precision': 0.35224181386012615, 'recall': 0.3511528964458354, 'f1-score': 0.3477907985409514, 'support': 17237}, 'weighted avg': {'precision': 0.352745569786768, 'recall': 0.3527876080524453, 'f1-score': 0.3488431605446819, 'support': 17237}}
[[1894 1509 2731]
 [1543 1497 2208]
 [1798 1367 2690]]
training model: results/LILAK/W8/deepVOL_L3/h300
Epoch 1/50
224/224 - 11s - loss: 3.3306 - accuracy300: 0.3624 - val_loss: 3.3510 - val_accuracy300: 0.3486 - 11s/epoch - 50ms/step
Epoch 2/50
224/224 - 9s - loss: 3.2895 - accuracy300: 0.3749 - val_loss: 3.3443 - val_accuracy300: 0.3392 - 9s/epoch - 40ms/step
Epoch 3/50
224/224 - 9s - loss: 3.2759 - accuracy300: 0.3779 - val_loss: 3.3469 - val_accuracy300: 0.3468 - 9s/epoch - 42ms/step
Epoch 4/50
224/224 - 9s - loss: 3.2771 - accuracy300: 0.3804 - val_loss: 3.3279 - val_accuracy300: 0.3473 - 9s/epoch - 41ms/step
Epoch 5/50
224/224 - 9s - loss: 3.2829 - accuracy300: 0.3750 - val_loss: 3.3164 - val_accuracy300: 0.3430 - 9s/epoch - 39ms/step
Epoch 6/50
224/224 - 9s - loss: 3.2577 - accuracy300: 0.3858 - val_loss: 3.3332 - val_accuracy300: 0.3506 - 9s/epoch - 42ms/step
Epoch 7/50
224/224 - 9s - loss: 3.2560 - accuracy300: 0.3864 - val_loss: 3.3295 - val_accuracy300: 0.3487 - 9s/epoch - 39ms/step
Epoch 8/50
224/224 - 9s - loss: 3.2358 - accuracy300: 0.3977 - val_loss: 3.3321 - val_accuracy300: 0.3518 - 9s/epoch - 39ms/step
Epoch 9/50
224/224 - 9s - loss: 3.2253 - accuracy300: 0.4043 - val_loss: 3.3353 - val_accuracy300: 0.3514 - 9s/epoch - 39ms/step
Epoch 10/50
224/224 - 9s - loss: 3.2157 - accuracy300: 0.4108 - val_loss: 3.3324 - val_accuracy300: 0.3526 - 9s/epoch - 40ms/step
Epoch 11/50
224/224 - 9s - loss: 3.1952 - accuracy300: 0.4162 - val_loss: 3.3438 - val_accuracy300: 0.3490 - 9s/epoch - 39ms/step
Epoch 12/50
224/224 - 9s - loss: 3.1740 - accuracy300: 0.4256 - val_loss: 3.3508 - val_accuracy300: 0.3476 - 9s/epoch - 39ms/step
Epoch 13/50
224/224 - 9s - loss: 3.1585 - accuracy300: 0.4328 - val_loss: 3.3483 - val_accuracy300: 0.3537 - 9s/epoch - 41ms/step
Epoch 14/50
224/224 - 9s - loss: 3.1351 - accuracy300: 0.4411 - val_loss: 3.3561 - val_accuracy300: 0.3457 - 9s/epoch - 41ms/step
Epoch 15/50
224/224 - 9s - loss: 3.1173 - accuracy300: 0.4470 - val_loss: 3.3804 - val_accuracy300: 0.3499 - 9s/epoch - 39ms/step
testing model: results/LILAK/W8/deepVOL_L3/h300
Evaluating performance on  test set...
645/645 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1089633
{'0': {'precision': 0.3357915025559373, 'recall': 0.212377654499841, 'f1-score': 0.26019198926418546, 'support': 56602}, '1': {'precision': 0.3158978583196046, 'recall': 0.045370297342061675, 'f1-score': 0.0793448275862069, 'support': 50716}, '2': {'precision': 0.34808479904137357, 'recall': 0.7362253931882096, 'f1-score': 0.4726855283175533, 'support': 57606}, 'accuracy': 0.34399480973054253, 'macro avg': {'precision': 0.33325805330563846, 'recall': 0.33132444834337077, 'f1-score': 0.27074078172264854, 'support': 164924}, 'weighted avg': {'precision': 0.3339678842605418, 'recall': 0.34399480973054253, 'f1-score': 0.27880091312637617, 'support': 164924}}
[[12021  2168 42413]
 [11398  2301 37017]
 [12380  2815 42411]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0922356
{'0': {'precision': 0.3575622595667139, 'recall': 0.277935158954989, 'f1-score': 0.3127601168865669, 'support': 19062}, '1': {'precision': 0.49367299367299367, 'recall': 0.1575451647183847, 'f1-score': 0.23886248288085074, 'support': 18820}, '2': {'precision': 0.36104153477746276, 'recall': 0.6806247405562474, 'f1-score': 0.4718090750499073, 'support': 19272}, 'accuracy': 0.37407705497428, 'macro avg': {'precision': 0.4040922626723901, 'recall': 0.3720350214098737, 'f1-score': 0.341143891605775, 'support': 57154}, 'weighted avg': {'precision': 0.40355478166038605, 'recall': 0.37407705497428, 'f1-score': 0.3420570698511244, 'support': 57154}}
[[ 5298  1532 12232]
 [ 4873  2965 10982]
 [ 4646  1509 13117]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1035062
{'0': {'precision': 0.36649931538110453, 'recall': 0.26054510058403635, 'f1-score': 0.30457045325241794, 'support': 6164}, '1': {'precision': 0.3492940454266421, 'recall': 0.10701523415459846, 'f1-score': 0.16383530089260007, 'support': 5317}, '2': {'precision': 0.34197398895421344, 'recall': 0.6669562195969423, 'f1-score': 0.45212578023789896, 'support': 5756}, 'accuracy': 0.3489006207576725, 'macro avg': {'precision': 0.35258911658732006, 'recall': 0.34483885144519233, 'f1-score': 0.30684384479430565, 'support': 17237}, 'weighted avg': {'precision': 0.3530022915799174, 'recall': 0.3489006207576725, 'f1-score': 0.31043224225463856, 'support': 17237}}
[[1606  601 3957]
 [1318  569 3430]
 [1458  459 3839]]
training model: results/LILAK/W8/deepVOL_L3/h500
Epoch 1/50
224/224 - 12s - loss: 3.3184 - accuracy500: 0.3739 - val_loss: 3.5027 - val_accuracy500: 0.3316 - 12s/epoch - 52ms/step
Epoch 2/50
224/224 - 9s - loss: 3.2980 - accuracy500: 0.3774 - val_loss: 3.4329 - val_accuracy500: 0.3295 - 9s/epoch - 39ms/step
Epoch 3/50
224/224 - 9s - loss: 3.2796 - accuracy500: 0.3831 - val_loss: 3.4610 - val_accuracy500: 0.3302 - 9s/epoch - 39ms/step
Epoch 4/50
224/224 - 9s - loss: 3.2736 - accuracy500: 0.3866 - val_loss: 3.3503 - val_accuracy500: 0.3369 - 9s/epoch - 38ms/step
Epoch 5/50
224/224 - 9s - loss: 3.2656 - accuracy500: 0.3883 - val_loss: 3.3454 - val_accuracy500: 0.3326 - 9s/epoch - 39ms/step
Epoch 6/50
224/224 - 9s - loss: 3.2652 - accuracy500: 0.3884 - val_loss: 3.3445 - val_accuracy500: 0.3305 - 9s/epoch - 41ms/step
Epoch 7/50
224/224 - 9s - loss: 3.2541 - accuracy500: 0.3954 - val_loss: 3.3633 - val_accuracy500: 0.3290 - 9s/epoch - 40ms/step
Epoch 8/50
224/224 - 9s - loss: 3.2497 - accuracy500: 0.3978 - val_loss: 3.3476 - val_accuracy500: 0.3349 - 9s/epoch - 39ms/step
Epoch 9/50
224/224 - 9s - loss: 3.2422 - accuracy500: 0.4036 - val_loss: 3.3534 - val_accuracy500: 0.3344 - 9s/epoch - 41ms/step
Epoch 10/50
224/224 - 9s - loss: 3.2286 - accuracy500: 0.4040 - val_loss: 3.3532 - val_accuracy500: 0.3321 - 9s/epoch - 39ms/step
Epoch 11/50
224/224 - 9s - loss: 3.2217 - accuracy500: 0.4086 - val_loss: 3.3604 - val_accuracy500: 0.3330 - 9s/epoch - 39ms/step
Epoch 12/50
224/224 - 9s - loss: 3.2108 - accuracy500: 0.4114 - val_loss: 3.3616 - val_accuracy500: 0.3183 - 9s/epoch - 39ms/step
Epoch 13/50
224/224 - 9s - loss: 3.1982 - accuracy500: 0.4175 - val_loss: 3.3628 - val_accuracy500: 0.3262 - 9s/epoch - 42ms/step
Epoch 14/50
224/224 - 9s - loss: 3.1790 - accuracy500: 0.4247 - val_loss: 3.3865 - val_accuracy500: 0.3248 - 9s/epoch - 42ms/step
Epoch 15/50
224/224 - 9s - loss: 3.1603 - accuracy500: 0.4323 - val_loss: 3.3975 - val_accuracy500: 0.3213 - 9s/epoch - 40ms/step
Epoch 16/50
224/224 - 9s - loss: 3.1494 - accuracy500: 0.4315 - val_loss: 3.4351 - val_accuracy500: 0.3162 - 9s/epoch - 40ms/step
testing model: results/LILAK/W8/deepVOL_L3/h500
Evaluating performance on  test set...
645/645 - 12s - 12s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0927823
{'0': {'precision': 0.37728429331482766, 'recall': 0.05139597907606983, 'f1-score': 0.09046787031644342, 'support': 63468}, '1': {'precision': 0.2288714445917015, 'recall': 0.05875425281339963, 'f1-score': 0.09350465440763031, 'support': 38210}, '2': {'precision': 0.38002580750875614, 'recall': 0.8800872782468456, 'f1-score': 0.5308347042414706, 'support': 63246}, 'accuracy': 0.3708920472460042, 'macro avg': {'precision': 0.32872718180509514, 'recall': 0.33007917004543835, 'f1-score': 0.2382690763218481, 'support': 164924}, 'weighted avg': {'precision': 0.34395096922008433, 'recall': 0.3708920472460042, 'f1-score': 0.26004583530969194, 'support': 164924}}
[[ 3262  3486 56720]
 [ 1878  2245 34087]
 [ 3506  4078 55662]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1003374
{'0': {'precision': 0.3154984840378099, 'recall': 0.09359293159092112, 'f1-score': 0.1443610249714379, 'support': 18901}, '1': {'precision': 0.4439124487004104, 'recall': 0.17193874847665977, 'f1-score': 0.24787075583393806, 'support': 18873}, '2': {'precision': 0.3585008024956484, 'recall': 0.8183178534571723, 'f1-score': 0.49857742427338597, 'support': 19380}, 'accuracy': 0.365206284774469, 'macro avg': {'precision': 0.37263724507795626, 'recall': 0.36128317784158437, 'f1-score': 0.2969364016929206, 'support': 57154}, 'weighted avg': {'precision': 0.3724838514100003, 'recall': 0.365206284774469, 'f1-score': 0.2986503655082283, 'support': 57154}}
[[ 1769  2045 15087]
 [ 2337  3245 13291]
 [ 1501  2020 15859]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1114051
{'0': {'precision': 0.3764861294583884, 'recall': 0.08614175608281699, 'f1-score': 0.1402041569302669, 'support': 6617}, '1': {'precision': 0.3299952312827849, 'recall': 0.13862179487179488, 'f1-score': 0.19523204965439414, 'support': 4992}, '2': {'precision': 0.33237927491560254, 'recall': 0.804726368159204, 'f1-score': 0.4704476991793913, 'support': 5628}, 'accuracy': 0.3359633346870105, 'macro avg': {'precision': 0.3462868785522586, 'recall': 0.34316330637127196, 'f1-score': 0.26862796858801746, 'support': 17237}, 'weighted avg': {'precision': 0.34862072706473457, 'recall': 0.3359633346870105, 'f1-score': 0.26396756681927974, 'support': 17237}}
[[ 570  776 5271]
 [ 474  692 3826]
 [ 470  629 4529]]
training model: results/LILAK/W8/deepVOL_L3/h1000
Epoch 1/50
224/224 - 11s - loss: 3.3343 - accuracy1000: 0.3771 - val_loss: 3.4422 - val_accuracy1000: 0.3317 - 11s/epoch - 51ms/step
Epoch 2/50
224/224 - 9s - loss: 3.2881 - accuracy1000: 0.3937 - val_loss: 3.5007 - val_accuracy1000: 0.3250 - 9s/epoch - 41ms/step
Epoch 3/50
224/224 - 9s - loss: 3.2959 - accuracy1000: 0.3803 - val_loss: 3.4007 - val_accuracy1000: 0.3265 - 9s/epoch - 42ms/step
Epoch 4/50
224/224 - 9s - loss: 3.2790 - accuracy1000: 0.3911 - val_loss: 3.3489 - val_accuracy1000: 0.3281 - 9s/epoch - 42ms/step
Epoch 5/50
224/224 - 9s - loss: 3.2802 - accuracy1000: 0.3855 - val_loss: 3.3227 - val_accuracy1000: 0.3363 - 9s/epoch - 42ms/step
Epoch 6/50
224/224 - 9s - loss: 3.2791 - accuracy1000: 0.3809 - val_loss: 3.3020 - val_accuracy1000: 0.3466 - 9s/epoch - 41ms/step
Epoch 7/50
224/224 - 9s - loss: 3.2711 - accuracy1000: 0.3862 - val_loss: 3.2880 - val_accuracy1000: 0.3698 - 9s/epoch - 42ms/step
Epoch 8/50
224/224 - 9s - loss: 3.2690 - accuracy1000: 0.3791 - val_loss: 3.2828 - val_accuracy1000: 0.3728 - 9s/epoch - 42ms/step
Epoch 9/50
224/224 - 9s - loss: 3.2612 - accuracy1000: 0.3827 - val_loss: 3.2940 - val_accuracy1000: 0.3682 - 9s/epoch - 42ms/step
Epoch 10/50
224/224 - 9s - loss: 3.2406 - accuracy1000: 0.4080 - val_loss: 3.3379 - val_accuracy1000: 0.3440 - 9s/epoch - 41ms/step
Epoch 11/50
224/224 - 9s - loss: 3.2453 - accuracy1000: 0.4007 - val_loss: 3.3119 - val_accuracy1000: 0.3488 - 9s/epoch - 42ms/step
Epoch 12/50
224/224 - 9s - loss: 3.2253 - accuracy1000: 0.4159 - val_loss: 3.3337 - val_accuracy1000: 0.3357 - 9s/epoch - 41ms/step
Epoch 13/50
224/224 - 9s - loss: 3.2241 - accuracy1000: 0.4080 - val_loss: 3.3270 - val_accuracy1000: 0.3520 - 9s/epoch - 39ms/step
Epoch 14/50
224/224 - 9s - loss: 3.2018 - accuracy1000: 0.4184 - val_loss: 3.3454 - val_accuracy1000: 0.3311 - 9s/epoch - 39ms/step
Epoch 15/50
224/224 - 9s - loss: 3.1949 - accuracy1000: 0.4205 - val_loss: 3.3801 - val_accuracy1000: 0.3407 - 9s/epoch - 39ms/step
Epoch 16/50
224/224 - 9s - loss: 3.1772 - accuracy1000: 0.4295 - val_loss: 3.3479 - val_accuracy1000: 0.3385 - 9s/epoch - 39ms/step
Epoch 17/50
224/224 - 9s - loss: 3.1575 - accuracy1000: 0.4397 - val_loss: 3.4098 - val_accuracy1000: 0.3364 - 9s/epoch - 39ms/step
Epoch 18/50
224/224 - 9s - loss: 3.1523 - accuracy1000: 0.4399 - val_loss: 3.4277 - val_accuracy1000: 0.3365 - 9s/epoch - 40ms/step
testing model: results/LILAK/W8/deepVOL_L3/h1000
Evaluating performance on  test set...
645/645 - 12s - 12s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1039683
{'0': {'precision': 0.35286305646995664, 'recall': 0.41239700807423674, 'f1-score': 0.3803142891947862, 'support': 60563}, '1': {'precision': 0.1917910447761194, 'recall': 0.005456823152217763, 'f1-score': 0.010611722443586514, 'support': 47097}, '2': {'precision': 0.345161255562859, 'recall': 0.5593741268510757, 'f1-score': 0.4269026501495999, 'support': 57264}, 'accuracy': 0.34722053794475033, 'macro avg': {'precision': 0.2966051189363117, 'recall': 0.32574265269251007, 'f1-score': 0.27260955392932423, 'support': 164924}, 'weighted avg': {'precision': 0.30419188391842567, 'recall': 0.34722053794475033, 'f1-score': 0.29091525761318016, 'support': 164924}}
[[24976   458 35129]
 [21198   257 25642]
 [24607   625 32032]]
Evaluating performance on  train set...
224/224 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1080655
{'0': {'precision': 0.3186843903348034, 'recall': 0.5562723625718313, 'f1-score': 0.40522075665429275, 'support': 18446}, '1': {'precision': 0.45794392523364486, 'recall': 0.017892540427751697, 'f1-score': 0.03443947989356896, 'support': 19170}, '2': {'precision': 0.39009377452802907, 'recall': 0.4833145664858225, 'f1-score': 0.43172934049605666, 'support': 19538}, 'accuracy': 0.35075410294992476, 'macro avg': {'precision': 0.3889073633654925, 'recall': 0.3524931564951352, 'f1-score': 0.2904631923479728, 'support': 57154}, 'weighted avg': {'precision': 0.3898045539695102, 'recall': 0.35075410294992476, 'f1-score': 0.2899190741053427, 'support': 57154}}
[[10261   216  7969]
 [12032   343  6795]
 [ 9905   190  9443]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0910821
{'0': {'precision': 0.4001410011078658, 'recall': 0.570997413049727, 'f1-score': 0.4705394682299994, 'support': 6958}, '1': {'precision': 0.40540540540540543, 'recall': 0.01924310455420141, 'f1-score': 0.03674219228413962, 'support': 4677}, '2': {'precision': 0.33954276037256564, 'recall': 0.429489468047126, 'f1-score': 0.3792559899117276, 'support': 5602}, 'accuracy': 0.37529732552068223, 'macro avg': {'precision': 0.38169638896194563, 'recall': 0.33990999521701815, 'f1-score': 0.29551255014195554, 'support': 17237}, 'weighted avg': {'precision': 0.38187507747268806, 'recall': 0.37529732552068223, 'f1-score': 0.3231681214099179, 'support': 17237}}
[[3973   65 2920]
 [2827   90 1760]
 [3129   67 2406]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        16 (peak)  10.95 (ave)

============================================
