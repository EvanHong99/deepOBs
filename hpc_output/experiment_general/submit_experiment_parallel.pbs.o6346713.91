This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-12-18.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-12-10.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-11-27.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-12-06.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-12-02.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-12-04.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-11-29.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-12-20.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-12-03.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-12-16.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-12-05.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-11-26.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-12-12.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-12-11.csv
training model: results/QRTEA/W9/deepLOB_L1/h10
Epoch 1/50
505/505 - 18s - loss: 2.9562 - accuracy10: 0.4176 - val_loss: 3.2053 - val_accuracy10: 0.6753 - 18s/epoch - 36ms/step
Epoch 2/50
505/505 - 8s - loss: 2.7920 - accuracy10: 0.4881 - val_loss: 2.9869 - val_accuracy10: 0.6340 - 8s/epoch - 17ms/step
Epoch 3/50
505/505 - 8s - loss: 2.6957 - accuracy10: 0.5224 - val_loss: 2.8942 - val_accuracy10: 0.5768 - 8s/epoch - 16ms/step
Epoch 4/50
505/505 - 8s - loss: 2.6182 - accuracy10: 0.5503 - val_loss: 2.8923 - val_accuracy10: 0.6217 - 8s/epoch - 16ms/step
Epoch 5/50
505/505 - 8s - loss: 2.5525 - accuracy10: 0.5738 - val_loss: 2.8168 - val_accuracy10: 0.6356 - 8s/epoch - 16ms/step
Epoch 6/50
505/505 - 8s - loss: 2.4882 - accuracy10: 0.5993 - val_loss: 2.8188 - val_accuracy10: 0.6396 - 8s/epoch - 16ms/step
Epoch 7/50
505/505 - 8s - loss: 2.4581 - accuracy10: 0.6107 - val_loss: 2.8479 - val_accuracy10: 0.6136 - 8s/epoch - 16ms/step
Epoch 8/50
505/505 - 8s - loss: 2.4259 - accuracy10: 0.6221 - val_loss: 2.8460 - val_accuracy10: 0.6466 - 8s/epoch - 16ms/step
Epoch 9/50
505/505 - 8s - loss: 2.3952 - accuracy10: 0.6364 - val_loss: 2.8746 - val_accuracy10: 0.6475 - 8s/epoch - 16ms/step
Epoch 10/50
505/505 - 8s - loss: 2.3701 - accuracy10: 0.6441 - val_loss: 2.8412 - val_accuracy10: 0.6199 - 8s/epoch - 16ms/step
Epoch 11/50
505/505 - 8s - loss: 2.3327 - accuracy10: 0.6545 - val_loss: 2.9182 - val_accuracy10: 0.6584 - 8s/epoch - 16ms/step
Epoch 12/50
505/505 - 8s - loss: 2.3117 - accuracy10: 0.6647 - val_loss: 2.9082 - val_accuracy10: 0.6773 - 8s/epoch - 16ms/step
Epoch 13/50
505/505 - 8s - loss: 2.2852 - accuracy10: 0.6708 - val_loss: 2.8576 - val_accuracy10: 0.6906 - 8s/epoch - 16ms/step
Epoch 14/50
505/505 - 8s - loss: 2.2645 - accuracy10: 0.6778 - val_loss: 2.9783 - val_accuracy10: 0.7013 - 8s/epoch - 16ms/step
Epoch 15/50
505/505 - 8s - loss: 2.2451 - accuracy10: 0.6770 - val_loss: 2.8762 - val_accuracy10: 0.7072 - 8s/epoch - 16ms/step
testing model: results/QRTEA/W9/deepLOB_L1/h10
Evaluating performance on  test set...
1118/1118 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2588336
{'0': {'precision': 0.10986690328305235, 'recall': 0.7020070302755415, 'f1-score': 0.18999831208089735, 'support': 17638}, '1': {'precision': 0.9207473280574365, 'recall': 0.22547930535687172, 'f1-score': 0.3622485499593956, 'support': 250258}, '2': {'precision': 0.1137984523767072, 'recall': 0.6990307212091342, 'f1-score': 0.19573267501322517, 'support': 18261}, 'accuracy': 0.2850707828220173, 'macro avg': {'precision': 0.38147089457239874, 'recall': 0.5421723522805159, 'f1-score': 0.24932651235117267, 'support': 286157}, 'weighted avg': {'precision': 0.8192715565369901, 'recall': 0.2850707828220173, 'f1-score': 0.34100533002036576, 'support': 286157}}
[[12382  1965  3291]
 [97714 56428 96116]
 [ 2604  2892 12765]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7425787
{'0': {'precision': 0.19137713564958148, 'recall': 0.5341939613784275, 'f1-score': 0.2817987393066187, 'support': 9373}, '1': {'precision': 0.901564305395076, 'recall': 0.733541242937853, 'f1-score': 0.8089197689313323, 'support': 110625}, '2': {'precision': 0.23999693392610763, 'recall': 0.33962468814405034, 'f1-score': 0.2812485964518302, 'support': 9219}, 'accuracy': 0.6909771934033447, 'macro avg': {'precision': 0.44431279165692167, 'recall': 0.5357866308201102, 'f1-score': 0.45732236822992717, 'support': 129217}, 'weighted avg': {'precision': 0.8028499416534868, 'recall': 0.6909771934033447, 'f1-score': 0.733037292556235, 'support': 129217}}
[[ 5007  3820   546]
 [20108 81148  9369]
 [ 1048  5040  3131]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81979275
{'0': {'precision': 0.1634920634920635, 'recall': 0.6206688761675203, 'f1-score': 0.2588102267730385, 'support': 3319}, '1': {'precision': 0.9078111876364858, 'recall': 0.6591291620929381, 'f1-score': 0.763736574335783, 'support': 40995}, '2': {'precision': 0.24926578560939794, 'recall': 0.3881108888253787, 'f1-score': 0.30356544092992066, 'support': 3499}, 'accuracy': 0.6366260222115324, 'macro avg': {'precision': 0.4401896789126491, 'recall': 0.5559696423619457, 'f1-score': 0.442037414012914, 'support': 47813}, 'weighted avg': {'precision': 0.8079503645396686, 'recall': 0.6366260222115324, 'f1-score': 0.6950107185361498, 'support': 47813}}
[[ 2060  1070   189]
 [10073 27021  3901]
 [  467  1674  1358]]
training model: results/QRTEA/W9/deepLOB_L1/h20
Epoch 1/50
505/505 - 10s - loss: 2.9399 - accuracy20: 0.4114 - val_loss: 3.0057 - val_accuracy20: 0.5563 - 10s/epoch - 20ms/step
Epoch 2/50
505/505 - 8s - loss: 2.7896 - accuracy20: 0.4623 - val_loss: 2.9353 - val_accuracy20: 0.5209 - 8s/epoch - 16ms/step
Epoch 3/50
505/505 - 8s - loss: 2.7202 - accuracy20: 0.4947 - val_loss: 2.8731 - val_accuracy20: 0.5569 - 8s/epoch - 16ms/step
Epoch 4/50
505/505 - 8s - loss: 2.6607 - accuracy20: 0.5223 - val_loss: 2.8493 - val_accuracy20: 0.5382 - 8s/epoch - 16ms/step
Epoch 5/50
505/505 - 8s - loss: 2.6001 - accuracy20: 0.5435 - val_loss: 2.7501 - val_accuracy20: 0.5396 - 8s/epoch - 16ms/step
Epoch 6/50
505/505 - 8s - loss: 2.5543 - accuracy20: 0.5667 - val_loss: 2.8125 - val_accuracy20: 0.5991 - 8s/epoch - 16ms/step
Epoch 7/50
505/505 - 8s - loss: 2.5120 - accuracy20: 0.5804 - val_loss: 2.7596 - val_accuracy20: 0.5836 - 8s/epoch - 16ms/step
Epoch 8/50
505/505 - 8s - loss: 2.4820 - accuracy20: 0.5927 - val_loss: 2.7990 - val_accuracy20: 0.6282 - 8s/epoch - 16ms/step
Epoch 9/50
505/505 - 8s - loss: 2.4409 - accuracy20: 0.6064 - val_loss: 2.7839 - val_accuracy20: 0.6441 - 8s/epoch - 16ms/step
Epoch 10/50
505/505 - 8s - loss: 2.4074 - accuracy20: 0.6171 - val_loss: 2.8897 - val_accuracy20: 0.6739 - 8s/epoch - 16ms/step
Epoch 11/50
505/505 - 8s - loss: 2.3786 - accuracy20: 0.6303 - val_loss: 2.7953 - val_accuracy20: 0.6694 - 8s/epoch - 16ms/step
Epoch 12/50
505/505 - 8s - loss: 2.3581 - accuracy20: 0.6355 - val_loss: 2.7370 - val_accuracy20: 0.6618 - 8s/epoch - 16ms/step
Epoch 13/50
505/505 - 8s - loss: 2.3325 - accuracy20: 0.6450 - val_loss: 2.6640 - val_accuracy20: 0.6885 - 8s/epoch - 16ms/step
Epoch 14/50
505/505 - 8s - loss: 2.3177 - accuracy20: 0.6511 - val_loss: 2.6972 - val_accuracy20: 0.6874 - 8s/epoch - 16ms/step
Epoch 15/50
505/505 - 8s - loss: 2.2918 - accuracy20: 0.6572 - val_loss: 2.7945 - val_accuracy20: 0.6916 - 8s/epoch - 16ms/step
Epoch 16/50
505/505 - 8s - loss: 2.2697 - accuracy20: 0.6624 - val_loss: 2.6341 - val_accuracy20: 0.6845 - 8s/epoch - 16ms/step
Epoch 17/50
505/505 - 8s - loss: 2.2568 - accuracy20: 0.6633 - val_loss: 2.6945 - val_accuracy20: 0.6831 - 8s/epoch - 16ms/step
Epoch 18/50
505/505 - 8s - loss: 2.2431 - accuracy20: 0.6665 - val_loss: 2.6404 - val_accuracy20: 0.7035 - 8s/epoch - 16ms/step
Epoch 19/50
505/505 - 8s - loss: 2.2293 - accuracy20: 0.6705 - val_loss: 2.6770 - val_accuracy20: 0.7161 - 8s/epoch - 16ms/step
Epoch 20/50
505/505 - 8s - loss: 2.2128 - accuracy20: 0.6699 - val_loss: 2.6487 - val_accuracy20: 0.6999 - 8s/epoch - 16ms/step
Epoch 21/50
505/505 - 8s - loss: 2.2089 - accuracy20: 0.6700 - val_loss: 2.7094 - val_accuracy20: 0.7207 - 8s/epoch - 16ms/step
Epoch 22/50
505/505 - 8s - loss: 2.2018 - accuracy20: 0.6716 - val_loss: 2.6895 - val_accuracy20: 0.7001 - 8s/epoch - 16ms/step
Epoch 23/50
505/505 - 8s - loss: 2.1951 - accuracy20: 0.6731 - val_loss: 2.7654 - val_accuracy20: 0.7078 - 8s/epoch - 16ms/step
Epoch 24/50
505/505 - 8s - loss: 2.1843 - accuracy20: 0.6742 - val_loss: 2.6951 - val_accuracy20: 0.7179 - 8s/epoch - 16ms/step
Epoch 25/50
505/505 - 8s - loss: 2.1639 - accuracy20: 0.6795 - val_loss: 2.7779 - val_accuracy20: 0.6972 - 8s/epoch - 16ms/step
Epoch 26/50
505/505 - 8s - loss: 2.1580 - accuracy20: 0.6756 - val_loss: 2.6917 - val_accuracy20: 0.6780 - 8s/epoch - 16ms/step
testing model: results/QRTEA/W9/deepLOB_L1/h20
Evaluating performance on  test set...
1118/1118 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82091415
{'0': {'precision': 0.2049928936147813, 'recall': 0.6420592720827666, 'f1-score': 0.31076619218146817, 'support': 24261}, '1': {'precision': 0.8984488495243451, 'recall': 0.6478942254889537, 'f1-score': 0.7528728015275793, 'support': 236730}, '2': {'precision': 0.31484907620954455, 'recall': 0.4936422156878328, 'f1-score': 0.3844761153149807, 'support': 25166}, 'accuracy': 0.6338338744115992, 'macro avg': {'precision': 0.472763606449557, 'recall': 0.594531904419851, 'f1-score': 0.48270503634134276, 'support': 286157}, 'weighted avg': {'precision': 0.7883316521761684, 'recall': 0.6338338744115992, 'f1-score': 0.6829915144908398, 'support': 286157}}
[[ 15577   7581   1103]
 [ 57423 153376  25931]
 [  2988   9755  12423]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.75191575
{'0': {'precision': 0.26202636482849057, 'recall': 0.5907110627042166, 'f1-score': 0.3630235226620769, 'support': 12854}, '1': {'precision': 0.8777634672874006, 'recall': 0.7161407872285045, 'f1-score': 0.7887578173941665, 'support': 103731}, '2': {'precision': 0.33175294720656073, 'recall': 0.4099113362887904, 'f1-score': 0.36671388101983005, 'support': 12632}, 'accuracy': 0.6737271411656361, 'macro avg': {'precision': 0.4905142597741507, 'recall': 0.5722543954071705, 'f1-score': 0.5061650736920245, 'support': 129217}, 'weighted avg': {'precision': 0.7631354415271059, 'recall': 0.6737271411656361, 'f1-score': 0.7051492548306733, 'support': 129217}}
[[ 7593  4327   934]
 [19949 74286  9496]
 [ 1436  6018  5178]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7549602
{'0': {'precision': 0.2589261864482237, 'recall': 0.6294372294372295, 'f1-score': 0.3669169137593843, 'support': 4620}, '1': {'precision': 0.8886536425753055, 'recall': 0.72140625, 'f1-score': 0.7963434090811091, 'support': 38400}, '2': {'precision': 0.4052505084119061, 'recall': 0.4573336115167953, 'f1-score': 0.42971966281121343, 'support': 4793}, 'accuracy': 0.686047727605463, 'macro avg': {'precision': 0.5176101124784784, 'recall': 0.6027256969846749, 'f1-score': 0.5309933285505689, 'support': 47813}, 'weighted avg': {'precision': 0.7793467162299121, 'recall': 0.686047727605463, 'f1-score': 0.7180973667023004, 'support': 47813}}
[[ 2908  1476   236]
 [ 7717 27702  2981]
 [  606  1995  2192]]
training model: results/QRTEA/W9/deepLOB_L1/h30
Epoch 1/50
505/505 - 10s - loss: 2.9600 - accuracy30: 0.4253 - val_loss: 3.3518 - val_accuracy30: 0.6344 - 10s/epoch - 20ms/step
Epoch 2/50
505/505 - 8s - loss: 2.8459 - accuracy30: 0.4498 - val_loss: 3.0176 - val_accuracy30: 0.6026 - 8s/epoch - 16ms/step
Epoch 3/50
505/505 - 8s - loss: 2.8067 - accuracy30: 0.4541 - val_loss: 2.9451 - val_accuracy30: 0.5985 - 8s/epoch - 16ms/step
Epoch 4/50
505/505 - 8s - loss: 2.7519 - accuracy30: 0.4855 - val_loss: 2.9100 - val_accuracy30: 0.5383 - 8s/epoch - 16ms/step
Epoch 5/50
505/505 - 8s - loss: 2.6904 - accuracy30: 0.5117 - val_loss: 2.8458 - val_accuracy30: 0.5337 - 8s/epoch - 16ms/step
Epoch 6/50
505/505 - 8s - loss: 2.6480 - accuracy30: 0.5297 - val_loss: 2.8378 - val_accuracy30: 0.5717 - 8s/epoch - 16ms/step
Epoch 7/50
505/505 - 8s - loss: 2.6060 - accuracy30: 0.5496 - val_loss: 2.8150 - val_accuracy30: 0.6044 - 8s/epoch - 16ms/step
Epoch 8/50
505/505 - 8s - loss: 2.5723 - accuracy30: 0.5665 - val_loss: 2.8159 - val_accuracy30: 0.6410 - 8s/epoch - 16ms/step
Epoch 9/50
505/505 - 8s - loss: 2.5316 - accuracy30: 0.5848 - val_loss: 2.8137 - val_accuracy30: 0.6384 - 8s/epoch - 16ms/step
Epoch 10/50
505/505 - 8s - loss: 2.5066 - accuracy30: 0.5955 - val_loss: 2.8967 - val_accuracy30: 0.6669 - 8s/epoch - 16ms/step
Epoch 11/50
505/505 - 8s - loss: 2.4802 - accuracy30: 0.6049 - val_loss: 2.8719 - val_accuracy30: 0.6618 - 8s/epoch - 16ms/step
Epoch 12/50
505/505 - 8s - loss: 2.4506 - accuracy30: 0.6144 - val_loss: 2.8348 - val_accuracy30: 0.6688 - 8s/epoch - 16ms/step
Epoch 13/50
505/505 - 8s - loss: 2.4250 - accuracy30: 0.6241 - val_loss: 2.8274 - val_accuracy30: 0.6634 - 8s/epoch - 16ms/step
Epoch 14/50
505/505 - 8s - loss: 2.4058 - accuracy30: 0.6300 - val_loss: 2.7623 - val_accuracy30: 0.6617 - 8s/epoch - 16ms/step
Epoch 15/50
505/505 - 8s - loss: 2.3859 - accuracy30: 0.6363 - val_loss: 2.9288 - val_accuracy30: 0.6916 - 8s/epoch - 16ms/step
Epoch 16/50
505/505 - 8s - loss: 2.3729 - accuracy30: 0.6371 - val_loss: 2.7764 - val_accuracy30: 0.6880 - 8s/epoch - 16ms/step
Epoch 17/50
505/505 - 8s - loss: 2.3500 - accuracy30: 0.6436 - val_loss: 2.7188 - val_accuracy30: 0.6611 - 8s/epoch - 16ms/step
Epoch 18/50
505/505 - 8s - loss: 2.3327 - accuracy30: 0.6456 - val_loss: 2.8569 - val_accuracy30: 0.6949 - 8s/epoch - 16ms/step
Epoch 19/50
505/505 - 8s - loss: 2.3284 - accuracy30: 0.6433 - val_loss: 2.8086 - val_accuracy30: 0.6751 - 8s/epoch - 16ms/step
Epoch 20/50
505/505 - 8s - loss: 2.3074 - accuracy30: 0.6466 - val_loss: 2.8269 - val_accuracy30: 0.6838 - 8s/epoch - 16ms/step
Epoch 21/50
505/505 - 8s - loss: 2.2945 - accuracy30: 0.6474 - val_loss: 2.8394 - val_accuracy30: 0.6928 - 8s/epoch - 16ms/step
Epoch 22/50
505/505 - 8s - loss: 2.2983 - accuracy30: 0.6477 - val_loss: 2.8695 - val_accuracy30: 0.6830 - 8s/epoch - 16ms/step
Epoch 23/50
505/505 - 8s - loss: 2.2795 - accuracy30: 0.6500 - val_loss: 2.8146 - val_accuracy30: 0.7024 - 8s/epoch - 16ms/step
Epoch 24/50
505/505 - 8s - loss: 2.2662 - accuracy30: 0.6507 - val_loss: 2.8500 - val_accuracy30: 0.6959 - 8s/epoch - 16ms/step
Epoch 25/50
505/505 - 8s - loss: 2.2558 - accuracy30: 0.6530 - val_loss: 2.8327 - val_accuracy30: 0.6739 - 8s/epoch - 16ms/step
Epoch 26/50
505/505 - 8s - loss: 2.2635 - accuracy30: 0.6511 - val_loss: 2.8142 - val_accuracy30: 0.6877 - 8s/epoch - 16ms/step
Epoch 27/50
505/505 - 8s - loss: 2.2436 - accuracy30: 0.6503 - val_loss: 2.8385 - val_accuracy30: 0.7057 - 8s/epoch - 16ms/step
testing model: results/QRTEA/W9/deepLOB_L1/h30
Evaluating performance on  test set...
1118/1118 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78836626
{'0': {'precision': 0.2475713906322072, 'recall': 0.5964841382097393, 'f1-score': 0.3499115935873248, 'support': 29694}, '1': {'precision': 0.85414396494566, 'recall': 0.6568342740094082, 'f1-score': 0.7426063680474795, 'support': 225547}, '2': {'precision': 0.3079501566712818, 'recall': 0.4100789235347393, 'f1-score': 0.3517514045918013, 'support': 30916}, 'accuracy': 0.6239127471982163, 'macro avg': {'precision': 0.4698885040830496, 'recall': 0.5544657785846289, 'f1-score': 0.48142312207553517, 'support': 286157}, 'weighted avg': {'precision': 0.7321910027665962, 'recall': 0.6239127471982163, 'f1-score': 0.6596297129839459, 'support': 286157}}
[[ 17712   9962   2020]
 [ 50929 148147  26471]
 [  2902  15336  12678]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.749707
{'0': {'precision': 0.3454295475377052, 'recall': 0.5330804346428342, 'f1-score': 0.4192137530021489, 'support': 15553}, '1': {'precision': 0.8445890778454289, 'recall': 0.7364727420667209, 'f1-score': 0.78683429862975, 'support': 98320}, '2': {'precision': 0.3376110055951953, 'recall': 0.42863660062565173, 'f1-score': 0.37771715721464466, 'support': 15344}, 'accuracy': 0.6754374424417839, 'macro avg': {'precision': 0.5092098769927765, 'recall': 0.5660632591117356, 'f1-score': 0.5279217362821812, 'support': 129217}, 'weighted avg': {'precision': 0.724306919031313, 'recall': 0.6754374424417839, 'f1-score': 0.6940052144998022, 'support': 129217}}
[[ 8291  6187  1075]
 [14081 72410 11829]
 [ 1630  7137  6577]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7911473
{'0': {'precision': 0.304903445664521, 'recall': 0.5678772919605077, 'f1-score': 0.39677260408967724, 'support': 5672}, '1': {'precision': 0.8562468556095925, 'recall': 0.7019825666125883, 'f1-score': 0.7714786497839291, 'support': 36367}, '2': {'precision': 0.3851224105461394, 'recall': 0.49584343609282994, 'f1-score': 0.4335251362810418, 'support': 5774}, 'accuracy': 0.6611800138037772, 'macro avg': {'precision': 0.5154242372734176, 'recall': 0.5885677648886419, 'f1-score': 0.5339254633848827, 'support': 47813}, 'weighted avg': {'precision': 0.733947640605204, 'recall': 0.6611800138037772, 'f1-score': 0.6862157238402847, 'support': 47813}}
[[ 3221  2071   380]
 [ 6647 25529  4191]
 [  696  2215  2863]]
training model: results/QRTEA/W9/deepLOB_L1/h50
Epoch 1/50
505/505 - 10s - loss: 3.0365 - accuracy50: 0.4171 - val_loss: 3.3254 - val_accuracy50: 0.5765 - 10s/epoch - 21ms/step
Epoch 2/50
505/505 - 8s - loss: 2.9345 - accuracy50: 0.4389 - val_loss: 3.0085 - val_accuracy50: 0.5216 - 8s/epoch - 16ms/step
Epoch 3/50
505/505 - 8s - loss: 2.8882 - accuracy50: 0.4599 - val_loss: 3.0907 - val_accuracy50: 0.4723 - 8s/epoch - 16ms/step
Epoch 4/50
505/505 - 8s - loss: 2.8250 - accuracy50: 0.5041 - val_loss: 3.0622 - val_accuracy50: 0.5101 - 8s/epoch - 16ms/step
Epoch 5/50
505/505 - 8s - loss: 2.7822 - accuracy50: 0.5210 - val_loss: 3.0856 - val_accuracy50: 0.5327 - 8s/epoch - 16ms/step
Epoch 6/50
505/505 - 8s - loss: 2.7446 - accuracy50: 0.5304 - val_loss: 3.0103 - val_accuracy50: 0.5374 - 8s/epoch - 16ms/step
Epoch 7/50
505/505 - 8s - loss: 2.7172 - accuracy50: 0.5428 - val_loss: 3.0504 - val_accuracy50: 0.5804 - 8s/epoch - 16ms/step
Epoch 8/50
505/505 - 8s - loss: 2.6953 - accuracy50: 0.5533 - val_loss: 3.0498 - val_accuracy50: 0.5807 - 8s/epoch - 16ms/step
Epoch 9/50
505/505 - 8s - loss: 2.6689 - accuracy50: 0.5589 - val_loss: 3.1048 - val_accuracy50: 0.6077 - 8s/epoch - 16ms/step
Epoch 10/50
505/505 - 8s - loss: 2.6486 - accuracy50: 0.5633 - val_loss: 3.1069 - val_accuracy50: 0.6086 - 8s/epoch - 16ms/step
Epoch 11/50
505/505 - 8s - loss: 2.6306 - accuracy50: 0.5698 - val_loss: 3.1695 - val_accuracy50: 0.6232 - 8s/epoch - 16ms/step
Epoch 12/50
505/505 - 8s - loss: 2.6181 - accuracy50: 0.5717 - val_loss: 3.1227 - val_accuracy50: 0.6107 - 8s/epoch - 16ms/step
testing model: results/QRTEA/W9/deepLOB_L1/h50
Evaluating performance on  test set...
1118/1118 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0360993
{'0': {'precision': 0.19890058944300948, 'recall': 0.755350989713021, 'f1-score': 0.3148850059502278, 'support': 39759}, '1': {'precision': 0.7466411281367977, 'recall': 0.2626185698872762, 'f1-score': 0.3885656499990971, 'support': 204837}, '2': {'precision': 0.30513791409876584, 'recall': 0.4634152210004572, 'f1-score': 0.3679786014520444, 'support': 41561}, 'accuracy': 0.3602428037755498, 'macro avg': {'precision': 0.4168932105595244, 'recall': 0.4937949268669181, 'f1-score': 0.35714308580045645, 'support': 286157}, 'weighted avg': {'precision': 0.6064141507902328, 'recall': 0.3602428037755498, 'f1-score': 0.37533834103442715, 'support': 286157}}
[[ 30032   6791   2936]
 [110120  53794  40923]
 [ 10838  11463  19260]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91356784
{'0': {'precision': 0.2859406898033738, 'recall': 0.5208690120859226, 'f1-score': 0.3692014220064164, 'support': 20437}, '1': {'precision': 0.7465021962138116, 'recall': 0.59898882983515, 'f1-score': 0.6646591739708997, 'support': 88808}, '2': {'precision': 0.3359382537385432, 'recall': 0.3486881634288003, 'f1-score': 0.34219448675740755, 'support': 19972}, 'accuracy': 0.5479464776306523, 'macro avg': {'precision': 0.4561270465852429, 'recall': 0.4895153351166243, 'f1-score': 0.45868502757824126, 'support': 129217}, 'weighted avg': {'precision': 0.6102021848714482, 'recall': 0.5479464776306523, 'f1-score': 0.5680887938357316, 'support': 129217}}
[[10645  8311  1481]
 [23328 53195 12285]
 [ 3255  9753  6964]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9284645
{'0': {'precision': 0.2635143380109823, 'recall': 0.5792650214592274, 'f1-score': 0.3622410467164304, 'support': 7456}, '1': {'precision': 0.7514971331492886, 'recall': 0.5392210641799232, 'f1-score': 0.6279032630103445, 'support': 32814}, '2': {'precision': 0.3775069814673775, 'recall': 0.3942728357417473, 'f1-score': 0.3857078010505155, 'support': 7543}, 'accuracy': 0.5225984564867295, 'macro avg': {'precision': 0.46417281754254947, 'recall': 0.5042529737936327, 'f1-score': 0.4586173702590968, 'support': 47813}, 'weighted avg': {'precision': 0.6163998283433181, 'recall': 0.5225984564867295, 'f1-score': 0.5482668073549701, 'support': 47813}}
[[ 4319  2437   700]
 [10916 17694  4204]
 [ 1155  3414  2974]]
training model: results/QRTEA/W9/deepLOB_L1/h100
Epoch 1/50
505/505 - 10s - loss: 3.1707 - accuracy100: 0.4095 - val_loss: 3.4253 - val_accuracy100: 0.5076 - 10s/epoch - 20ms/step
Epoch 2/50
505/505 - 8s - loss: 3.0956 - accuracy100: 0.4347 - val_loss: 3.2758 - val_accuracy100: 0.4967 - 8s/epoch - 16ms/step
Epoch 3/50
505/505 - 8s - loss: 3.0474 - accuracy100: 0.4620 - val_loss: 3.2469 - val_accuracy100: 0.5187 - 8s/epoch - 17ms/step
Epoch 4/50
505/505 - 8s - loss: 3.0060 - accuracy100: 0.4813 - val_loss: 3.2027 - val_accuracy100: 0.5108 - 8s/epoch - 16ms/step
Epoch 5/50
505/505 - 8s - loss: 2.9733 - accuracy100: 0.4966 - val_loss: 3.1841 - val_accuracy100: 0.5159 - 8s/epoch - 16ms/step
Epoch 6/50
505/505 - 8s - loss: 2.9566 - accuracy100: 0.4998 - val_loss: 3.2155 - val_accuracy100: 0.5121 - 8s/epoch - 16ms/step
Epoch 7/50
505/505 - 8s - loss: 2.9376 - accuracy100: 0.5052 - val_loss: 3.2198 - val_accuracy100: 0.5182 - 8s/epoch - 16ms/step
Epoch 8/50
505/505 - 8s - loss: 2.9277 - accuracy100: 0.5062 - val_loss: 3.2226 - val_accuracy100: 0.5216 - 8s/epoch - 16ms/step
Epoch 9/50
505/505 - 8s - loss: 2.9128 - accuracy100: 0.5120 - val_loss: 3.2102 - val_accuracy100: 0.5201 - 8s/epoch - 16ms/step
Epoch 10/50
505/505 - 8s - loss: 2.9040 - accuracy100: 0.5107 - val_loss: 3.1804 - val_accuracy100: 0.5154 - 8s/epoch - 17ms/step
Epoch 11/50
505/505 - 8s - loss: 2.8921 - accuracy100: 0.5145 - val_loss: 3.1740 - val_accuracy100: 0.4925 - 8s/epoch - 16ms/step
Epoch 12/50
505/505 - 8s - loss: 2.8861 - accuracy100: 0.5164 - val_loss: 3.1591 - val_accuracy100: 0.5163 - 8s/epoch - 16ms/step
Epoch 13/50
505/505 - 8s - loss: 2.8686 - accuracy100: 0.5224 - val_loss: 3.1919 - val_accuracy100: 0.5178 - 8s/epoch - 16ms/step
Epoch 14/50
505/505 - 8s - loss: 2.8618 - accuracy100: 0.5239 - val_loss: 3.2435 - val_accuracy100: 0.5205 - 8s/epoch - 16ms/step
Epoch 15/50
505/505 - 8s - loss: 2.8495 - accuracy100: 0.5264 - val_loss: 3.2287 - val_accuracy100: 0.5226 - 8s/epoch - 16ms/step
Epoch 16/50
505/505 - 8s - loss: 2.8417 - accuracy100: 0.5295 - val_loss: 3.2315 - val_accuracy100: 0.5183 - 8s/epoch - 16ms/step
Epoch 17/50
505/505 - 8s - loss: 2.8361 - accuracy100: 0.5279 - val_loss: 3.1993 - val_accuracy100: 0.5215 - 8s/epoch - 16ms/step
Epoch 18/50
505/505 - 8s - loss: 2.8292 - accuracy100: 0.5313 - val_loss: 3.2071 - val_accuracy100: 0.5427 - 8s/epoch - 16ms/step
Epoch 19/50
505/505 - 8s - loss: 2.8261 - accuracy100: 0.5320 - val_loss: 3.2282 - val_accuracy100: 0.5404 - 8s/epoch - 16ms/step
Epoch 20/50
505/505 - 8s - loss: 2.8141 - accuracy100: 0.5356 - val_loss: 3.2323 - val_accuracy100: 0.5365 - 8s/epoch - 16ms/step
Epoch 21/50
505/505 - 8s - loss: 2.8014 - accuracy100: 0.5370 - val_loss: 3.1901 - val_accuracy100: 0.5388 - 8s/epoch - 16ms/step
Epoch 22/50
505/505 - 8s - loss: 2.7973 - accuracy100: 0.5376 - val_loss: 3.2097 - val_accuracy100: 0.5292 - 8s/epoch - 16ms/step
testing model: results/QRTEA/W9/deepLOB_L1/h100
Evaluating performance on  test set...
1118/1118 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0639719
{'0': {'precision': 0.3002405143165461, 'recall': 0.548170039404261, 'f1-score': 0.38797927216218286, 'support': 59892}, '1': {'precision': 0.5856093023255814, 'recall': 0.3844998076065646, 'f1-score': 0.46420894674940183, 'support': 163727}, '2': {'precision': 0.3159231257574883, 'recall': 0.35012312513991495, 'f1-score': 0.33214507834898294, 'support': 62538}, 'accuracy': 0.4112427793134538, 'macro avg': {'precision': 0.40059098079987193, 'recall': 0.4275976573835802, 'f1-score': 0.3947777657535225, 'support': 286157}, 'weighted avg': {'precision': 0.46694387893334377, 'recall': 0.4112427793134538, 'f1-score': 0.419392437377263, 'support': 286157}}
[[32831 17409  9652]
 [63014 62953 37760]
 [13504 27138 21896]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98081166
{'0': {'precision': 0.38542227003765467, 'recall': 0.43921127911728647, 'f1-score': 0.4105625059688664, 'support': 29364}, '1': {'precision': 0.6217593086525125, 'recall': 0.6503187289896919, 'f1-score': 0.6357184250894835, 'support': 71691}, '2': {'precision': 0.36719464638197485, 'recall': 0.27082593565797886, 'f1-score': 0.3117323687491059, 'support': 28162}, 'accuracy': 0.5196375089964943, 'macro avg': {'precision': 0.4581254083573807, 'recall': 0.4534519812549857, 'f1-score': 0.4526710999358186, 'support': 129217}, 'weighted avg': {'precision': 0.5125720436583587, 'recall': 0.5196375089964943, 'f1-score': 0.5139420819789368, 'support': 129217}}
[[12897 12869  3598]
 [15523 46622  9546]
 [ 5042 15493  7627]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.96983236
{'0': {'precision': 0.36357158127271433, 'recall': 0.47372330547818015, 'f1-score': 0.41140184655082046, 'support': 10770}, '1': {'precision': 0.6157247070960136, 'recall': 0.6344722854973425, 'f1-score': 0.624957929770764, 'support': 26340}, '2': {'precision': 0.44154865923470926, 'recall': 0.27384845370456884, 'f1-score': 0.3380427887665071, 'support': 10703}, 'accuracy': 0.517537071507749, 'macro avg': {'precision': 0.4736149825344791, 'recall': 0.46068134822669715, 'f1-score': 0.4581341883626972, 'support': 47813}, 'weighted avg': {'precision': 0.5199370467238036, 'recall': 0.517537071507749, 'f1-score': 0.5126275641704596, 'support': 47813}}
[[ 5102  4562  1106]
 [ 7027 16712  2601]
 [ 1904  5868  2931]]
training model: results/QRTEA/W9/deepLOB_L1/h200
Epoch 1/50
505/505 - 10s - loss: 3.2379 - accuracy200: 0.4120 - val_loss: 3.4680 - val_accuracy200: 0.4249 - 10s/epoch - 20ms/step
Epoch 2/50
505/505 - 8s - loss: 3.1786 - accuracy200: 0.4346 - val_loss: 3.4966 - val_accuracy200: 0.4302 - 8s/epoch - 16ms/step
Epoch 3/50
505/505 - 8s - loss: 3.1689 - accuracy200: 0.4369 - val_loss: 3.4677 - val_accuracy200: 0.4288 - 8s/epoch - 16ms/step
Epoch 4/50
505/505 - 8s - loss: 3.1388 - accuracy200: 0.4490 - val_loss: 3.4611 - val_accuracy200: 0.4307 - 8s/epoch - 16ms/step
Epoch 5/50
505/505 - 8s - loss: 3.1253 - accuracy200: 0.4521 - val_loss: 3.3818 - val_accuracy200: 0.4327 - 8s/epoch - 16ms/step
Epoch 6/50
505/505 - 8s - loss: 3.1035 - accuracy200: 0.4600 - val_loss: 3.4943 - val_accuracy200: 0.4375 - 8s/epoch - 16ms/step
Epoch 7/50
505/505 - 8s - loss: 3.0883 - accuracy200: 0.4688 - val_loss: 3.5362 - val_accuracy200: 0.4360 - 8s/epoch - 16ms/step
Epoch 8/50
505/505 - 8s - loss: 3.0778 - accuracy200: 0.4734 - val_loss: 3.5403 - val_accuracy200: 0.4289 - 8s/epoch - 16ms/step
Epoch 9/50
505/505 - 8s - loss: 3.0613 - accuracy200: 0.4826 - val_loss: 3.5756 - val_accuracy200: 0.4326 - 8s/epoch - 16ms/step
Epoch 10/50
505/505 - 8s - loss: 3.0492 - accuracy200: 0.4846 - val_loss: 3.5608 - val_accuracy200: 0.4260 - 8s/epoch - 16ms/step
Epoch 11/50
505/505 - 8s - loss: 3.0371 - accuracy200: 0.4890 - val_loss: 3.6423 - val_accuracy200: 0.4261 - 8s/epoch - 16ms/step
Epoch 12/50
505/505 - 8s - loss: 3.0287 - accuracy200: 0.4907 - val_loss: 3.6185 - val_accuracy200: 0.4307 - 8s/epoch - 16ms/step
Epoch 13/50
505/505 - 8s - loss: 3.0134 - accuracy200: 0.4933 - val_loss: 3.6650 - val_accuracy200: 0.4326 - 8s/epoch - 16ms/step
Epoch 14/50
505/505 - 8s - loss: 3.0135 - accuracy200: 0.4947 - val_loss: 3.6212 - val_accuracy200: 0.4284 - 8s/epoch - 16ms/step
Epoch 15/50
505/505 - 8s - loss: 3.0070 - accuracy200: 0.4965 - val_loss: 3.6793 - val_accuracy200: 0.4217 - 8s/epoch - 16ms/step
testing model: results/QRTEA/W9/deepLOB_L1/h200
Evaluating performance on  test set...
1118/1118 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1208253
{'0': {'precision': 0.2931494661921708, 'recall': 0.26830199241710984, 'f1-score': 0.2801759071040429, 'support': 78598}, '1': {'precision': 0.4198376373901714, 'recall': 0.694534142856015, 'f1-score': 0.5233290698712038, 'support': 126659}, '2': {'precision': 0.4484008528784648, 'recall': 0.02599505562422744, 'f1-score': 0.04914125481948826, 'support': 80900}, 'accuracy': 0.3884580841985344, 'macro avg': {'precision': 0.38712931882026896, 'recall': 0.3296103969657841, 'f1-score': 0.284215410598245, 'support': 286157}, 'weighted avg': {'precision': 0.39311568843621425, 'recall': 0.3884580841985344, 'f1-score': 0.32248426605771296, 'support': 286157}}
[[21088 57004   506]
 [36609 87969  2081]
 [14239 64558  2103]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1114674
{'0': {'precision': 0.3953278524162823, 'recall': 0.10164990977055942, 'f1-score': 0.1617176605692724, 'support': 38790}, '1': {'precision': 0.43987406174805166, 'recall': 0.6762118591041261, 'f1-score': 0.5330199969536741, 'support': 54338}, '2': {'precision': 0.33354802576309156, 'recall': 0.3300451661170994, 'f1-score': 0.3317873507987576, 'support': 36089}, 'accuracy': 0.4070517037231943, 'macro avg': {'precision': 0.3895833133091418, 'recall': 0.3693023116639283, 'f1-score': 0.3421750027739014, 'support': 129217}, 'weighted avg': {'precision': 0.39680582945167764, 'recall': 0.4070517037231943, 'f1-score': 0.36535550547472223, 'support': 129217}}
[[ 3943 24131 10716]
 [ 4511 36744 13083]
 [ 1520 22658 11911]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0800695
{'0': {'precision': 0.39959758551307845, 'recall': 0.14106115491157042, 'f1-score': 0.20851488267100635, 'support': 14079}, '1': {'precision': 0.43214766909188895, 'recall': 0.7953677528145613, 'f1-score': 0.5600195554624343, 'support': 20163}, '2': {'precision': 0.46991104133961276, 'recall': 0.198511531943114, 'f1-score': 0.2791131371736428, 'support': 13571}, 'accuracy': 0.4332922008658733, 'macro avg': {'precision': 0.4338854319815267, 'recall': 0.37831347988974856, 'f1-score': 0.3492158584356945, 'support': 47813}, 'weighted avg': {'precision': 0.4332815468671339, 'recall': 0.4332922008658733, 'f1-score': 0.37678455053014176, 'support': 47813}}
[[ 1986 10866  1227]
 [ 2314 16037  1812]
 [  670 10207  2694]]
training model: results/QRTEA/W9/deepLOB_L1/h300
Epoch 1/50
505/505 - 10s - loss: 3.2630 - accuracy300: 0.4058 - val_loss: 3.5061 - val_accuracy300: 0.3821 - 10s/epoch - 20ms/step
Epoch 2/50
505/505 - 8s - loss: 3.2474 - accuracy300: 0.4053 - val_loss: 3.4092 - val_accuracy300: 0.3744 - 8s/epoch - 16ms/step
Epoch 3/50
505/505 - 8s - loss: 3.2139 - accuracy300: 0.4204 - val_loss: 3.3944 - val_accuracy300: 0.3737 - 8s/epoch - 16ms/step
Epoch 4/50
505/505 - 8s - loss: 3.1958 - accuracy300: 0.4295 - val_loss: 3.4140 - val_accuracy300: 0.3885 - 8s/epoch - 16ms/step
Epoch 5/50
505/505 - 8s - loss: 3.1902 - accuracy300: 0.4297 - val_loss: 3.4081 - val_accuracy300: 0.3813 - 8s/epoch - 16ms/step
Epoch 6/50
505/505 - 8s - loss: 3.1639 - accuracy300: 0.4383 - val_loss: 3.4138 - val_accuracy300: 0.3796 - 8s/epoch - 16ms/step
Epoch 7/50
505/505 - 8s - loss: 3.1429 - accuracy300: 0.4503 - val_loss: 3.4056 - val_accuracy300: 0.3819 - 8s/epoch - 16ms/step
Epoch 8/50
505/505 - 8s - loss: 3.1344 - accuracy300: 0.4496 - val_loss: 3.3961 - val_accuracy300: 0.3846 - 8s/epoch - 16ms/step
Epoch 9/50
505/505 - 8s - loss: 3.1165 - accuracy300: 0.4602 - val_loss: 3.3962 - val_accuracy300: 0.3876 - 8s/epoch - 16ms/step
Epoch 10/50
505/505 - 8s - loss: 3.1072 - accuracy300: 0.4649 - val_loss: 3.3891 - val_accuracy300: 0.3935 - 8s/epoch - 16ms/step
Epoch 11/50
505/505 - 8s - loss: 3.0934 - accuracy300: 0.4704 - val_loss: 3.3969 - val_accuracy300: 0.3985 - 8s/epoch - 16ms/step
Epoch 12/50
505/505 - 8s - loss: 3.0852 - accuracy300: 0.4728 - val_loss: 3.4262 - val_accuracy300: 0.3994 - 8s/epoch - 16ms/step
Epoch 13/50
505/505 - 8s - loss: 3.0729 - accuracy300: 0.4763 - val_loss: 3.4439 - val_accuracy300: 0.3983 - 8s/epoch - 16ms/step
Epoch 14/50
505/505 - 8s - loss: 3.0592 - accuracy300: 0.4800 - val_loss: 3.4216 - val_accuracy300: 0.4076 - 8s/epoch - 16ms/step
Epoch 15/50
505/505 - 8s - loss: 3.0540 - accuracy300: 0.4819 - val_loss: 3.4232 - val_accuracy300: 0.4090 - 8s/epoch - 17ms/step
Epoch 16/50
505/505 - 8s - loss: 3.0479 - accuracy300: 0.4826 - val_loss: 3.3660 - val_accuracy300: 0.4201 - 8s/epoch - 16ms/step
Epoch 17/50
505/505 - 8s - loss: 3.0446 - accuracy300: 0.4832 - val_loss: 3.4155 - val_accuracy300: 0.4062 - 8s/epoch - 16ms/step
Epoch 18/50
505/505 - 8s - loss: 3.0350 - accuracy300: 0.4882 - val_loss: 3.3891 - val_accuracy300: 0.4098 - 8s/epoch - 16ms/step
Epoch 19/50
505/505 - 8s - loss: 3.0293 - accuracy300: 0.4882 - val_loss: 3.4073 - val_accuracy300: 0.4096 - 8s/epoch - 16ms/step
Epoch 20/50
505/505 - 8s - loss: 3.0208 - accuracy300: 0.4909 - val_loss: 3.4089 - val_accuracy300: 0.4059 - 8s/epoch - 16ms/step
Epoch 21/50
505/505 - 8s - loss: 3.0176 - accuracy300: 0.4921 - val_loss: 3.4304 - val_accuracy300: 0.4034 - 8s/epoch - 16ms/step
Epoch 22/50
505/505 - 8s - loss: 3.0115 - accuracy300: 0.4949 - val_loss: 3.4644 - val_accuracy300: 0.4014 - 8s/epoch - 16ms/step
Epoch 23/50
505/505 - 8s - loss: 3.0008 - accuracy300: 0.4982 - val_loss: 3.4401 - val_accuracy300: 0.4074 - 8s/epoch - 16ms/step
Epoch 24/50
505/505 - 8s - loss: 2.9935 - accuracy300: 0.4993 - val_loss: 3.4236 - val_accuracy300: 0.4132 - 8s/epoch - 16ms/step
Epoch 25/50
505/505 - 8s - loss: 2.9897 - accuracy300: 0.5022 - val_loss: 3.4285 - val_accuracy300: 0.4046 - 8s/epoch - 16ms/step
Epoch 26/50
505/505 - 8s - loss: 2.9899 - accuracy300: 0.5007 - val_loss: 3.4396 - val_accuracy300: 0.3984 - 8s/epoch - 16ms/step
testing model: results/QRTEA/W9/deepLOB_L1/h300
Evaluating performance on  test set...
1118/1118 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1473783
{'0': {'precision': 0.31759246690697757, 'recall': 0.7282830495382806, 'f1-score': 0.4423035182916156, 'support': 86741}, '1': {'precision': 0.39249549788917426, 'recall': 0.2396229475695258, 'f1-score': 0.297573749944044, 'support': 110966}, '2': {'precision': 0.45656855707106964, 'recall': 0.10066704352741662, 'f1-score': 0.1649622054246332, 'support': 88450}, 'accuracy': 0.344796737455313, 'macro avg': {'precision': 0.3888855072890738, 'recall': 0.3561910135450743, 'f1-score': 0.30161315788676424, 'support': 286157}, 'weighted avg': {'precision': 0.38959533565030513, 'recall': 0.344796737455313, 'f1-score': 0.3004550833501631, 'support': 286157}}
[[63172 18704  4865]
 [78643 26590  5733]
 [57094 22452  8904]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1514577
{'0': {'precision': 0.3764000953256392, 'recall': 0.2557424070690014, 'f1-score': 0.30455622279764205, 'support': 43231}, '1': {'precision': 0.4450821750455247, 'recall': 0.4119253333333333, 'f1-score': 0.42786235015178714, 'support': 46875}, '2': {'precision': 0.3455482545473867, 'recall': 0.4988366444222853, 'f1-score': 0.40827857531494577, 'support': 39111}, 'accuracy': 0.38597862510350806, 'macro avg': {'precision': 0.38901017497285023, 'recall': 0.38883479494154005, 'f1-score': 0.3802323827547917, 'support': 129217}, 'weighted avg': {'precision': 0.39197719541457016, 'recall': 0.38597862510350806, 'f1-score': 0.3806813429368638, 'support': 129217}}
[[11056 13008 19167]
 [ 9782 19309 17784]
 [ 8535 11066 19510]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1147436
{'0': {'precision': 0.436096537250787, 'recall': 0.2682674928995611, 'f1-score': 0.33218767484613543, 'support': 15492}, '1': {'precision': 0.43901388224030635, 'recall': 0.5287402709714615, 'f1-score': 0.47971753628874064, 'support': 17345}, '2': {'precision': 0.390099465302133, 'recall': 0.45305822649572647, 'f1-score': 0.4192282739658315, 'support': 14976}, 'accuracy': 0.42063873841842175, 'macro avg': {'precision': 0.4217366282644088, 'recall': 0.41668866345558303, 'f1-score': 0.41037782836690256, 'support': 47813}, 'weighted avg': {'precision': 0.42274764049342334, 'recall': 0.42063873841842175, 'f1-score': 0.41296958476892953, 'support': 47813}}
[[4156 6086 5250]
 [2816 9171 5358]
 [2558 5633 6785]]
training model: results/QRTEA/W9/deepLOB_L1/h500
Epoch 1/50
505/505 - 11s - loss: 3.2979 - accuracy500: 0.3892 - val_loss: 3.3582 - val_accuracy500: 0.3440 - 11s/epoch - 21ms/step
Epoch 2/50
505/505 - 8s - loss: 3.2677 - accuracy500: 0.4002 - val_loss: 3.3949 - val_accuracy500: 0.3346 - 8s/epoch - 16ms/step
Epoch 3/50
505/505 - 8s - loss: 3.2481 - accuracy500: 0.4020 - val_loss: 3.3871 - val_accuracy500: 0.3356 - 8s/epoch - 16ms/step
Epoch 4/50
505/505 - 8s - loss: 3.2392 - accuracy500: 0.4047 - val_loss: 3.4094 - val_accuracy500: 0.3343 - 8s/epoch - 17ms/step
Epoch 5/50
505/505 - 8s - loss: 3.2214 - accuracy500: 0.4132 - val_loss: 3.4324 - val_accuracy500: 0.3355 - 8s/epoch - 17ms/step
Epoch 6/50
505/505 - 8s - loss: 3.2010 - accuracy500: 0.4266 - val_loss: 3.3879 - val_accuracy500: 0.3457 - 8s/epoch - 16ms/step
Epoch 7/50
505/505 - 8s - loss: 3.1966 - accuracy500: 0.4307 - val_loss: 3.4161 - val_accuracy500: 0.3429 - 8s/epoch - 16ms/step
Epoch 8/50
505/505 - 8s - loss: 3.1888 - accuracy500: 0.4348 - val_loss: 3.4242 - val_accuracy500: 0.3541 - 8s/epoch - 16ms/step
Epoch 9/50
505/505 - 8s - loss: 3.1755 - accuracy500: 0.4391 - val_loss: 3.4663 - val_accuracy500: 0.3629 - 8s/epoch - 16ms/step
Epoch 10/50
505/505 - 8s - loss: 3.1575 - accuracy500: 0.4502 - val_loss: 3.5126 - val_accuracy500: 0.3457 - 8s/epoch - 16ms/step
Epoch 11/50
505/505 - 8s - loss: 3.1452 - accuracy500: 0.4539 - val_loss: 3.5419 - val_accuracy500: 0.3486 - 8s/epoch - 16ms/step
testing model: results/QRTEA/W9/deepLOB_L1/h500
Evaluating performance on  test set...
1118/1118 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1388324
{'0': {'precision': 0.3161336874587408, 'recall': 0.45848130294900197, 'f1-score': 0.3742281952376409, 'support': 89827}, '1': {'precision': 0.3423672503441763, 'recall': 0.30079269085056826, 'f1-score': 0.32023625818123763, 'support': 100039}, '2': {'precision': 0.34864395811271914, 'recall': 0.24618084763892784, 'f1-score': 0.2885873766610057, 'support': 96291}, 'accuracy': 0.3319156966280748, 'macro avg': {'precision': 0.3357149653052121, 'recall': 0.3351516138128327, 'f1-score': 0.3276839433599614, 'support': 286157}, 'weighted avg': {'precision': 0.3362444164258404, 'recall': 0.3319156966280748, 'f1-score': 0.32653500774703853, 'support': 286157}}
[[41184 27715 20928]
 [46589 30091 23359]
 [42501 30085 23705]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1403805
{'0': {'precision': 0.3654573781437792, 'recall': 0.1402519752295537, 'f1-score': 0.2027097929076263, 'support': 46830}, '1': {'precision': 0.32058875392865666, 'recall': 0.7583423299636863, 'f1-score': 0.4506608925147453, 'support': 40756}, '2': {'precision': 0.36116727321741476, 'recall': 0.12872618961831328, 'f1-score': 0.18980325488321026, 'support': 41631}, 'accuracy': 0.3314888907806248, 'macro avg': {'precision': 0.34907113509661686, 'recall': 0.34244016493718443, 'f1-score': 0.2810579801018606, 'support': 129217}, 'weighted avg': {'precision': 0.3499232997585744, 'recall': 0.3314888907806248, 'f1-score': 0.27675719325814735, 'support': 129217}}
[[ 6568 35157  5105]
 [ 5475 30907  4374]
 [ 5929 30343  5359]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1210189
{'0': {'precision': 0.41565891472868216, 'recall': 0.16258338386901153, 'f1-score': 0.23374019180470793, 'support': 16490}, '1': {'precision': 0.3322576234103651, 'recall': 0.8021789369428854, 'f1-score': 0.4698897698704313, 'support': 15145}, '2': {'precision': 0.35556481867444767, 'recall': 0.10545184818889851, 'f1-score': 0.16266209000762774, 'support': 16178}, 'accuracy': 0.34584736368769997, 'macro avg': {'precision': 0.36782711893783165, 'recall': 0.35673805633359845, 'f1-score': 0.288764017227589, 'support': 47813}, 'weighted avg': {'precision': 0.36890772063959937, 'recall': 0.34584736368769997, 'f1-score': 0.28449174115179376, 'support': 47813}}
[[ 2681 11978  1831]
 [ 1735 12149  1261]
 [ 2034 12438  1706]]
training model: results/QRTEA/W9/deepLOB_L1/h1000
Epoch 1/50
505/505 - 10s - loss: 3.2823 - accuracy1000: 0.3993 - val_loss: 3.3647 - val_accuracy1000: 0.3626 - 10s/epoch - 21ms/step
Epoch 2/50
505/505 - 8s - loss: 3.2479 - accuracy1000: 0.4156 - val_loss: 3.3253 - val_accuracy1000: 0.3547 - 8s/epoch - 16ms/step
Epoch 3/50
505/505 - 8s - loss: 3.2315 - accuracy1000: 0.4186 - val_loss: 3.3461 - val_accuracy1000: 0.3689 - 8s/epoch - 16ms/step
Epoch 4/50
505/505 - 8s - loss: 3.2111 - accuracy1000: 0.4278 - val_loss: 3.4252 - val_accuracy1000: 0.3731 - 8s/epoch - 16ms/step
Epoch 5/50
505/505 - 8s - loss: 3.2083 - accuracy1000: 0.4264 - val_loss: 3.4155 - val_accuracy1000: 0.3720 - 8s/epoch - 16ms/step
Epoch 6/50
505/505 - 8s - loss: 3.2045 - accuracy1000: 0.4276 - val_loss: 3.4667 - val_accuracy1000: 0.3707 - 8s/epoch - 16ms/step
Epoch 7/50
505/505 - 8s - loss: 3.1745 - accuracy1000: 0.4392 - val_loss: 3.4750 - val_accuracy1000: 0.3676 - 8s/epoch - 16ms/step
Epoch 8/50
505/505 - 8s - loss: 3.1721 - accuracy1000: 0.4444 - val_loss: 3.4737 - val_accuracy1000: 0.3711 - 8s/epoch - 16ms/step
Epoch 9/50
505/505 - 8s - loss: 3.1618 - accuracy1000: 0.4500 - val_loss: 3.5266 - val_accuracy1000: 0.3761 - 8s/epoch - 16ms/step
Epoch 10/50
505/505 - 8s - loss: 3.1435 - accuracy1000: 0.4588 - val_loss: 3.5010 - val_accuracy1000: 0.3743 - 8s/epoch - 16ms/step
Epoch 11/50
505/505 - 8s - loss: 3.1378 - accuracy1000: 0.4601 - val_loss: 3.5236 - val_accuracy1000: 0.3663 - 8s/epoch - 16ms/step
Epoch 12/50
505/505 - 8s - loss: 3.1216 - accuracy1000: 0.4690 - val_loss: 3.5572 - val_accuracy1000: 0.3713 - 8s/epoch - 16ms/step
testing model: results/QRTEA/W9/deepLOB_L1/h1000
Evaluating performance on  test set...
1118/1118 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1342275
{'0': {'precision': 0.3068789275240888, 'recall': 0.2002887360143493, 'f1-score': 0.24238293141329378, 'support': 91433}, '1': {'precision': 0.33169309024562177, 'recall': 0.2522919382648555, 'f1-score': 0.286594650758675, 'support': 95116}, '2': {'precision': 0.32980179712589613, 'recall': 0.5103405348967954, 'f1-score': 0.4006731220171591, 'support': 99608}, 'accuracy': 0.325499638310438, 'macro avg': {'precision': 0.3227912716318689, 'recall': 0.32097373639200005, 'f1-score': 0.3098835680630426, 'support': 286157}, 'weighted avg': {'precision': 0.3231061213258066, 'recall': 0.325499638310438, 'f1-score': 0.31217752390246967, 'support': 286157}}
[[18313 22595 50525]
 [18343 23997 52776]
 [23019 25755 50834]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1227535
{'0': {'precision': 0.3245061224489796, 'recall': 0.2154579945799458, 'f1-score': 0.25897068403908796, 'support': 46125}, '1': {'precision': 0.39669559412550065, 'recall': 0.1681165570408091, 'f1-score': 0.23615319656251552, 'support': 42417}, '2': {'precision': 0.32659769772749825, 'recall': 0.6473017824216349, 'f1-score': 0.4341459795038379, 'support': 40675}, 'accuracy': 0.3358536415487126, 'macro avg': {'precision': 0.3492664714339928, 'recall': 0.34362544468079664, 'f1-score': 0.30975662003514715, 'support': 129217}, 'weighted avg': {'precision': 0.34886155280687947, 'recall': 0.3358536415487126, 'f1-score': 0.3066223535309886, 'support': 129217}}
[[ 9938  5688 30499]
 [11498  7131 23788]
 [ 9189  5157 26329]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1092708
{'0': {'precision': 0.34933786559025565, 'recall': 0.30059106696727805, 'f1-score': 0.3231363815013756, 'support': 16411}, '1': {'precision': 0.3543730065469196, 'recall': 0.13489679851747716, 'f1-score': 0.19540868277330373, 'support': 15649}, '2': {'precision': 0.35745447989904455, 'recall': 0.6293404430902051, 'f1-score': 0.45594186902133926, 'support': 15753}, 'accuracy': 0.354673415179972, 'macro avg': {'precision': 0.3537217840120732, 'recall': 0.35494276952498677, 'f1-score': 0.32482897776533953, 'support': 47813}, 'weighted avg': {'precision': 0.35366003625591536, 'recall': 0.354673415179972, 'f1-score': 0.32508719168911515, 'support': 47813}}
[[4933 2118 9360]
 [5077 2111 8461]
 [4111 1728 9914]]
training model: results/QRTEA/W9/deepOF_L1/h10
Epoch 1/50
505/505 - 10s - loss: 2.9455 - accuracy10: 0.4770 - val_loss: 2.8646 - val_accuracy10: 0.6595 - 10s/epoch - 19ms/step
Epoch 2/50
505/505 - 8s - loss: 2.7967 - accuracy10: 0.5416 - val_loss: 2.7796 - val_accuracy10: 0.6780 - 8s/epoch - 15ms/step
Epoch 3/50
505/505 - 7s - loss: 2.7331 - accuracy10: 0.5721 - val_loss: 2.7163 - val_accuracy10: 0.6789 - 7s/epoch - 14ms/step
Epoch 4/50
505/505 - 7s - loss: 2.6820 - accuracy10: 0.5906 - val_loss: 2.6625 - val_accuracy10: 0.6781 - 7s/epoch - 14ms/step
Epoch 5/50
505/505 - 7s - loss: 2.6465 - accuracy10: 0.6058 - val_loss: 2.6621 - val_accuracy10: 0.7058 - 7s/epoch - 15ms/step
Epoch 6/50
505/505 - 7s - loss: 2.6125 - accuracy10: 0.6115 - val_loss: 2.6376 - val_accuracy10: 0.6788 - 7s/epoch - 15ms/step
Epoch 7/50
505/505 - 7s - loss: 2.5872 - accuracy10: 0.6200 - val_loss: 2.6101 - val_accuracy10: 0.6911 - 7s/epoch - 15ms/step
Epoch 8/50
505/505 - 7s - loss: 2.5822 - accuracy10: 0.6187 - val_loss: 2.6184 - val_accuracy10: 0.6918 - 7s/epoch - 14ms/step
Epoch 9/50
505/505 - 7s - loss: 2.5500 - accuracy10: 0.6307 - val_loss: 2.5992 - val_accuracy10: 0.7082 - 7s/epoch - 14ms/step
Epoch 10/50
505/505 - 7s - loss: 2.5257 - accuracy10: 0.6339 - val_loss: 2.5915 - val_accuracy10: 0.6999 - 7s/epoch - 14ms/step
Epoch 11/50
505/505 - 7s - loss: 2.5154 - accuracy10: 0.6361 - val_loss: 2.5909 - val_accuracy10: 0.7134 - 7s/epoch - 14ms/step
Epoch 12/50
505/505 - 7s - loss: 2.4964 - accuracy10: 0.6393 - val_loss: 2.5913 - val_accuracy10: 0.7129 - 7s/epoch - 14ms/step
Epoch 13/50
505/505 - 7s - loss: 2.4850 - accuracy10: 0.6413 - val_loss: 2.5757 - val_accuracy10: 0.7002 - 7s/epoch - 14ms/step
Epoch 14/50
505/505 - 7s - loss: 2.4679 - accuracy10: 0.6439 - val_loss: 2.5648 - val_accuracy10: 0.7105 - 7s/epoch - 14ms/step
Epoch 15/50
505/505 - 7s - loss: 2.4538 - accuracy10: 0.6440 - val_loss: 2.5785 - val_accuracy10: 0.7005 - 7s/epoch - 14ms/step
Epoch 16/50
505/505 - 7s - loss: 2.4397 - accuracy10: 0.6473 - val_loss: 2.5696 - val_accuracy10: 0.7168 - 7s/epoch - 15ms/step
Epoch 17/50
505/505 - 7s - loss: 2.4227 - accuracy10: 0.6519 - val_loss: 2.5791 - val_accuracy10: 0.7195 - 7s/epoch - 14ms/step
Epoch 18/50
505/505 - 7s - loss: 2.4135 - accuracy10: 0.6497 - val_loss: 2.5938 - val_accuracy10: 0.7314 - 7s/epoch - 14ms/step
Epoch 19/50
505/505 - 7s - loss: 2.4028 - accuracy10: 0.6505 - val_loss: 2.5915 - val_accuracy10: 0.7249 - 7s/epoch - 14ms/step
Epoch 20/50
505/505 - 7s - loss: 2.3855 - accuracy10: 0.6531 - val_loss: 2.5772 - val_accuracy10: 0.7153 - 7s/epoch - 14ms/step
Epoch 21/50
505/505 - 7s - loss: 2.3782 - accuracy10: 0.6541 - val_loss: 2.5839 - val_accuracy10: 0.7180 - 7s/epoch - 14ms/step
Epoch 22/50
505/505 - 7s - loss: 2.3632 - accuracy10: 0.6570 - val_loss: 2.5872 - val_accuracy10: 0.7080 - 7s/epoch - 14ms/step
Epoch 23/50
505/505 - 7s - loss: 2.3533 - accuracy10: 0.6548 - val_loss: 2.6145 - val_accuracy10: 0.7319 - 7s/epoch - 14ms/step
Epoch 24/50
505/505 - 7s - loss: 2.3392 - accuracy10: 0.6557 - val_loss: 2.6386 - val_accuracy10: 0.7340 - 7s/epoch - 14ms/step
testing model: results/QRTEA/W9/deepOF_L1/h10
Evaluating performance on  test set...
1118/1118 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74663264
{'0': {'precision': 0.19531842304776345, 'recall': 0.5842499149563443, 'f1-score': 0.29276399897724364, 'support': 17638}, '1': {'precision': 0.9383645681773762, 'recall': 0.6906702789965395, 'f1-score': 0.795686500172632, 'support': 250254}, '2': {'precision': 0.21172022684310018, 'recall': 0.5703959257433876, 'f1-score': 0.3088143733878858, 'support': 18261}, 'accuracy': 0.6764353335453411, 'macro avg': {'precision': 0.4484677393560799, 'recall': 0.6151053732320905, 'f1-score': 0.46575495751258716, 'support': 286153}, 'weighted avg': {'precision': 0.8461932464547267, 'recall': 0.6764353335453411, 'f1-score': 0.7336171911550765, 'support': 286153}}
[[ 10305   5606   1727]
 [ 40357 172843  37054]
 [  2098   5747  10416]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6800672
{'0': {'precision': 0.2440445425926796, 'recall': 0.5584345769272121, 'f1-score': 0.3396547214229662, 'support': 9301}, '1': {'precision': 0.9341881298992162, 'recall': 0.7535816877743853, 'f1-score': 0.8342216577834222, 'support': 110702}, '2': {'precision': 0.27546420521627135, 'recall': 0.5570870414586498, 'f1-score': 0.3686440677966102, 'support': 9214}, 'accuracy': 0.7255237313975715, 'macro avg': {'precision': 0.48456562590272245, 'recall': 0.6230344353867491, 'f1-score': 0.5141734823343329, 'support': 129217}, 'weighted avg': {'precision': 0.8375405699994604, 'recall': 0.7255237313975715, 'f1-score': 0.7654242163536793, 'support': 129217}}
[[ 5194  2860  1247]
 [15025 83423 12254]
 [ 1064  3017  5133]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7063172
{'0': {'precision': 0.2383108935128519, 'recall': 0.5805008944543828, 'f1-score': 0.33790350572717803, 'support': 3354}, '1': {'precision': 0.9384957972650859, 'recall': 0.7308274716686206, 'f1-score': 0.8217443840281211, 'support': 40944}, '2': {'precision': 0.27446177645997166, 'recall': 0.6060347281525762, 'f1-score': 0.3778172138420586, 'support': 3513}, 'accuracy': 0.7111125054903683, 'macro avg': {'precision': 0.4837561557459698, 'recall': 0.6391210314251933, 'f1-score': 0.5124883678657859, 'support': 47811}, 'weighted avg': {'precision': 0.8405858668667809, 'recall': 0.7111125054903683, 'f1-score': 0.755184001382182, 'support': 47811}}
[[ 1947  1058   349]
 [ 5742 29923  5279]
 [  481   903  2129]]
training model: results/QRTEA/W9/deepOF_L1/h20
Epoch 1/50
505/505 - 10s - loss: 2.9475 - accuracy20: 0.4639 - val_loss: 2.9006 - val_accuracy20: 0.6385 - 10s/epoch - 19ms/step
Epoch 2/50
505/505 - 8s - loss: 2.8088 - accuracy20: 0.5095 - val_loss: 2.8212 - val_accuracy20: 0.6616 - 8s/epoch - 15ms/step
Epoch 3/50
505/505 - 7s - loss: 2.7455 - accuracy20: 0.5475 - val_loss: 2.7871 - val_accuracy20: 0.6721 - 7s/epoch - 15ms/step
Epoch 4/50
505/505 - 8s - loss: 2.7019 - accuracy20: 0.5668 - val_loss: 2.7237 - val_accuracy20: 0.6807 - 8s/epoch - 15ms/step
Epoch 5/50
505/505 - 7s - loss: 2.6660 - accuracy20: 0.5830 - val_loss: 2.6788 - val_accuracy20: 0.6828 - 7s/epoch - 15ms/step
Epoch 6/50
505/505 - 7s - loss: 2.6369 - accuracy20: 0.5887 - val_loss: 2.6781 - val_accuracy20: 0.6866 - 7s/epoch - 15ms/step
Epoch 7/50
505/505 - 7s - loss: 2.6116 - accuracy20: 0.6007 - val_loss: 2.6688 - val_accuracy20: 0.6922 - 7s/epoch - 15ms/step
Epoch 8/50
505/505 - 7s - loss: 2.5865 - accuracy20: 0.6063 - val_loss: 2.6796 - val_accuracy20: 0.7023 - 7s/epoch - 14ms/step
Epoch 9/50
505/505 - 7s - loss: 2.5641 - accuracy20: 0.6096 - val_loss: 2.6813 - val_accuracy20: 0.7037 - 7s/epoch - 14ms/step
Epoch 10/50
505/505 - 7s - loss: 2.5559 - accuracy20: 0.6108 - val_loss: 2.6553 - val_accuracy20: 0.7009 - 7s/epoch - 14ms/step
Epoch 11/50
505/505 - 7s - loss: 2.5347 - accuracy20: 0.6182 - val_loss: 2.6677 - val_accuracy20: 0.7072 - 7s/epoch - 15ms/step
Epoch 12/50
505/505 - 7s - loss: 2.5206 - accuracy20: 0.6192 - val_loss: 2.6930 - val_accuracy20: 0.7101 - 7s/epoch - 14ms/step
Epoch 13/50
505/505 - 7s - loss: 2.5028 - accuracy20: 0.6227 - val_loss: 2.6719 - val_accuracy20: 0.7092 - 7s/epoch - 14ms/step
Epoch 14/50
505/505 - 7s - loss: 2.4922 - accuracy20: 0.6232 - val_loss: 2.6803 - val_accuracy20: 0.7178 - 7s/epoch - 14ms/step
Epoch 15/50
505/505 - 7s - loss: 2.4745 - accuracy20: 0.6243 - val_loss: 2.6918 - val_accuracy20: 0.7157 - 7s/epoch - 14ms/step
Epoch 16/50
505/505 - 7s - loss: 2.4612 - accuracy20: 0.6287 - val_loss: 2.6730 - val_accuracy20: 0.7059 - 7s/epoch - 14ms/step
Epoch 17/50
505/505 - 7s - loss: 2.4516 - accuracy20: 0.6305 - val_loss: 2.7012 - val_accuracy20: 0.7200 - 7s/epoch - 14ms/step
Epoch 18/50
505/505 - 7s - loss: 2.4385 - accuracy20: 0.6289 - val_loss: 2.7055 - val_accuracy20: 0.7266 - 7s/epoch - 14ms/step
Epoch 19/50
505/505 - 7s - loss: 2.4257 - accuracy20: 0.6297 - val_loss: 2.6705 - val_accuracy20: 0.7062 - 7s/epoch - 14ms/step
Epoch 20/50
505/505 - 7s - loss: 2.4118 - accuracy20: 0.6330 - val_loss: 2.7007 - val_accuracy20: 0.7130 - 7s/epoch - 15ms/step
testing model: results/QRTEA/W9/deepOF_L1/h20
Evaluating performance on  test set...
1118/1118 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74700403
{'0': {'precision': 0.2595847138476735, 'recall': 0.5199291043238119, 'f1-score': 0.3462816043044994, 'support': 24261}, '1': {'precision': 0.8974990075426756, 'recall': 0.7162711320260554, 'f1-score': 0.7967090409748832, 'support': 236726}, '2': {'precision': 0.2767143004009458, 'recall': 0.5347691329571644, 'f1-score': 0.3647105052777062, 'support': 25166}, 'accuracy': 0.683662236635646, 'macro avg': {'precision': 0.47793267393043165, 'recall': 0.5903231231023439, 'f1-score': 0.5025670501856963, 'support': 286153}, 'weighted avg': {'precision': 0.7888190125076306, 'recall': 0.683662236635646, 'f1-score': 0.7205277841283174, 'support': 286153}}
[[ 12614   9982   1665]
 [ 33654 169560  33512]
 [  2325   9383  13458]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71568644
{'0': {'precision': 0.3173613555231535, 'recall': 0.4940513462742642, 'f1-score': 0.3864686973825195, 'support': 12776}, '1': {'precision': 0.8858060358238143, 'recall': 0.7679761858887905, 'f1-score': 0.8226934984520123, 'support': 103804}, '2': {'precision': 0.34269604800331055, 'recall': 0.5242541742502176, 'f1-score': 0.41446401201163624, 'support': 12637}, 'accuracy': 0.7170573531346495, 'macro avg': {'precision': 0.5152878131167594, 'recall': 0.5954272354710908, 'f1-score': 0.5412087359487227, 'support': 129217}, 'weighted avg': {'precision': 0.7764881430418357, 'recall': 0.7170573531346495, 'f1-score': 0.7396393795774767, 'support': 129217}}
[[ 6312  5240  1224]
 [12602 79719 11483]
 [  975  5037  6625]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7428344
{'0': {'precision': 0.30040396621373483, 'recall': 0.5284237726098191, 'f1-score': 0.3830484664013111, 'support': 4644}, '1': {'precision': 0.8950090427388394, 'recall': 0.7353301530199943, 'f1-score': 0.8073499527748361, 'support': 38361}, '2': {'precision': 0.3457230769230769, 'recall': 0.5844777361631294, 'f1-score': 0.4344598252262006, 'support': 4806}, 'accuracy': 0.700069021773232, 'macro avg': {'precision': 0.5137120286252171, 'recall': 0.6160772205976476, 'f1-score': 0.5416194148007826, 'support': 47811}, 'weighted avg': {'precision': 0.7820389244168393, 'recall': 0.700069021773232, 'f1-score': 0.7286532918449792, 'support': 47811}}
[[ 2454  1834   356]
 [ 5193 28208  4960]
 [  522  1475  2809]]
training model: results/QRTEA/W9/deepOF_L1/h30
Epoch 1/50
505/505 - 9s - loss: 2.9750 - accuracy30: 0.4572 - val_loss: 2.9598 - val_accuracy30: 0.6356 - 9s/epoch - 18ms/step
Epoch 2/50
505/505 - 8s - loss: 2.8455 - accuracy30: 0.5062 - val_loss: 2.8850 - val_accuracy30: 0.6626 - 8s/epoch - 15ms/step
Epoch 3/50
505/505 - 7s - loss: 2.7943 - accuracy30: 0.5317 - val_loss: 2.8167 - val_accuracy30: 0.6571 - 7s/epoch - 15ms/step
Epoch 4/50
505/505 - 7s - loss: 2.7540 - accuracy30: 0.5502 - val_loss: 2.7895 - val_accuracy30: 0.6664 - 7s/epoch - 14ms/step
Epoch 5/50
505/505 - 7s - loss: 2.7194 - accuracy30: 0.5615 - val_loss: 2.7772 - val_accuracy30: 0.6771 - 7s/epoch - 15ms/step
Epoch 6/50
505/505 - 8s - loss: 2.6943 - accuracy30: 0.5685 - val_loss: 2.7606 - val_accuracy30: 0.6849 - 8s/epoch - 15ms/step
Epoch 7/50
505/505 - 7s - loss: 2.6678 - accuracy30: 0.5809 - val_loss: 2.7455 - val_accuracy30: 0.6799 - 7s/epoch - 15ms/step
Epoch 8/50
505/505 - 7s - loss: 2.6502 - accuracy30: 0.5842 - val_loss: 2.7396 - val_accuracy30: 0.6848 - 7s/epoch - 14ms/step
Epoch 9/50
505/505 - 7s - loss: 2.6308 - accuracy30: 0.5840 - val_loss: 2.7435 - val_accuracy30: 0.6908 - 7s/epoch - 14ms/step
Epoch 10/50
505/505 - 7s - loss: 2.6156 - accuracy30: 0.5888 - val_loss: 2.7217 - val_accuracy30: 0.6879 - 7s/epoch - 15ms/step
Epoch 11/50
505/505 - 7s - loss: 2.5918 - accuracy30: 0.5945 - val_loss: 2.7477 - val_accuracy30: 0.6943 - 7s/epoch - 14ms/step
Epoch 12/50
505/505 - 7s - loss: 2.5821 - accuracy30: 0.5954 - val_loss: 2.7417 - val_accuracy30: 0.6982 - 7s/epoch - 14ms/step
Epoch 13/50
505/505 - 7s - loss: 2.5634 - accuracy30: 0.5967 - val_loss: 2.7415 - val_accuracy30: 0.7051 - 7s/epoch - 14ms/step
Epoch 14/50
505/505 - 7s - loss: 2.5451 - accuracy30: 0.5978 - val_loss: 2.7697 - val_accuracy30: 0.7060 - 7s/epoch - 14ms/step
Epoch 15/50
505/505 - 7s - loss: 2.5344 - accuracy30: 0.5945 - val_loss: 2.7499 - val_accuracy30: 0.6970 - 7s/epoch - 14ms/step
Epoch 16/50
505/505 - 7s - loss: 2.5240 - accuracy30: 0.5974 - val_loss: 2.7763 - val_accuracy30: 0.7006 - 7s/epoch - 14ms/step
Epoch 17/50
505/505 - 7s - loss: 2.5087 - accuracy30: 0.5999 - val_loss: 2.7663 - val_accuracy30: 0.7035 - 7s/epoch - 14ms/step
Epoch 18/50
505/505 - 7s - loss: 2.4951 - accuracy30: 0.6004 - val_loss: 2.7609 - val_accuracy30: 0.6980 - 7s/epoch - 15ms/step
Epoch 19/50
505/505 - 7s - loss: 2.4871 - accuracy30: 0.5974 - val_loss: 2.7755 - val_accuracy30: 0.6983 - 7s/epoch - 14ms/step
Epoch 20/50
505/505 - 7s - loss: 2.4726 - accuracy30: 0.6011 - val_loss: 2.8045 - val_accuracy30: 0.6979 - 7s/epoch - 14ms/step
testing model: results/QRTEA/W9/deepOF_L1/h30
Evaluating performance on  test set...
1118/1118 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77095944
{'0': {'precision': 0.2871143305378552, 'recall': 0.49922543274735637, 'f1-score': 0.36456194282201043, 'support': 29694}, '1': {'precision': 0.8613739576034105, 'recall': 0.7139791525341066, 'f1-score': 0.780781203029392, 'support': 225543}, '2': {'precision': 0.3290732137977424, 'recall': 0.5063721050588692, 'f1-score': 0.39890940131738206, 'support': 30916}, 'accuracy': 0.6692643445988684, 'macro avg': {'precision': 0.492520500646336, 'recall': 0.5731922301134441, 'f1-score': 0.5147508490562616, 'support': 286153}, 'weighted avg': {'precision': 0.7442734024403311, 'recall': 0.6692643445988684, 'f1-score': 0.6963328018792154, 'support': 286153}}
[[ 14824  13158   1712]
 [ 34304 161033  30206]
 [  2503  12758  15655]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74356604
{'0': {'precision': 0.35885426937487674, 'recall': 0.4699464135838337, 'f1-score': 0.40695496603583714, 'support': 15489}, '1': {'precision': 0.8473497681883024, 'recall': 0.772869123252859, 'f1-score': 0.8083975268868652, 'support': 98375}, '2': {'precision': 0.3975527206456652, 'recall': 0.4972969452224321, 'f1-score': 0.44186584871809714, 'support': 15353}, 'accuracy': 0.7038160613541562, 'macro avg': {'precision': 0.5345855860696148, 'recall': 0.5800374940197083, 'f1-score': 0.5524061138802665, 'support': 129217}, 'weighted avg': {'precision': 0.7353518046692357, 'recall': 0.7038160613541562, 'f1-score': 0.7167276639435476, 'support': 129217}}
[[ 7279  6992  1218]
 [11992 76031 10352]
 [ 1013  6705  7635]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7648521
{'0': {'precision': 0.33766233766233766, 'recall': 0.4972802246008072, 'f1-score': 0.4022140221402214, 'support': 5699}, '1': {'precision': 0.8575085597260887, 'recall': 0.7375258015687354, 'f1-score': 0.7930044683810257, 'support': 36335}, '2': {'precision': 0.39671850128566183, 'recall': 0.5608447290981479, 'f1-score': 0.4647160068846816, 'support': 5777}, 'accuracy': 0.6875405241471628, 'macro avg': {'precision': 0.5306297995580294, 'recall': 0.5985502517558968, 'f1-score': 0.5533114991353095, 'support': 47811}, 'weighted avg': {'precision': 0.7398664316143223, 'recall': 0.6875405241471628, 'f1-score': 0.7067557558422644, 'support': 47811}}
[[ 2834  2451   414]
 [ 5024 26798  4513]
 [  535  2002  3240]]
training model: results/QRTEA/W9/deepOF_L1/h50
Epoch 1/50
505/505 - 9s - loss: 3.0616 - accuracy50: 0.4355 - val_loss: 3.1184 - val_accuracy50: 0.6212 - 9s/epoch - 18ms/step
Epoch 2/50
505/505 - 7s - loss: 2.9677 - accuracy50: 0.4667 - val_loss: 3.0476 - val_accuracy50: 0.6328 - 7s/epoch - 15ms/step
Epoch 3/50
505/505 - 7s - loss: 2.9195 - accuracy50: 0.4959 - val_loss: 2.9832 - val_accuracy50: 0.6409 - 7s/epoch - 15ms/step
Epoch 4/50
505/505 - 7s - loss: 2.8802 - accuracy50: 0.5188 - val_loss: 2.9776 - val_accuracy50: 0.6509 - 7s/epoch - 15ms/step
Epoch 5/50
505/505 - 7s - loss: 2.8486 - accuracy50: 0.5315 - val_loss: 2.9608 - val_accuracy50: 0.6524 - 7s/epoch - 14ms/step
Epoch 6/50
505/505 - 7s - loss: 2.8208 - accuracy50: 0.5423 - val_loss: 2.9439 - val_accuracy50: 0.6559 - 7s/epoch - 14ms/step
Epoch 7/50
505/505 - 7s - loss: 2.7986 - accuracy50: 0.5476 - val_loss: 2.9825 - val_accuracy50: 0.6682 - 7s/epoch - 14ms/step
Epoch 8/50
505/505 - 7s - loss: 2.7774 - accuracy50: 0.5501 - val_loss: 2.9504 - val_accuracy50: 0.6648 - 7s/epoch - 14ms/step
Epoch 9/50
505/505 - 7s - loss: 2.7599 - accuracy50: 0.5530 - val_loss: 2.9685 - val_accuracy50: 0.6673 - 7s/epoch - 15ms/step
Epoch 10/50
505/505 - 7s - loss: 2.7461 - accuracy50: 0.5550 - val_loss: 2.9609 - val_accuracy50: 0.6723 - 7s/epoch - 15ms/step
Epoch 11/50
505/505 - 7s - loss: 2.7258 - accuracy50: 0.5568 - val_loss: 2.9751 - val_accuracy50: 0.6758 - 7s/epoch - 14ms/step
Epoch 12/50
505/505 - 7s - loss: 2.7142 - accuracy50: 0.5560 - val_loss: 2.9917 - val_accuracy50: 0.6774 - 7s/epoch - 14ms/step
Epoch 13/50
505/505 - 7s - loss: 2.6979 - accuracy50: 0.5593 - val_loss: 2.9951 - val_accuracy50: 0.6784 - 7s/epoch - 14ms/step
Epoch 14/50
505/505 - 7s - loss: 2.6866 - accuracy50: 0.5574 - val_loss: 3.0081 - val_accuracy50: 0.6802 - 7s/epoch - 14ms/step
Epoch 15/50
505/505 - 7s - loss: 2.6714 - accuracy50: 0.5612 - val_loss: 3.0129 - val_accuracy50: 0.6827 - 7s/epoch - 14ms/step
Epoch 16/50
505/505 - 7s - loss: 2.6563 - accuracy50: 0.5632 - val_loss: 3.0004 - val_accuracy50: 0.6782 - 7s/epoch - 14ms/step
testing model: results/QRTEA/W9/deepOF_L1/h50
Evaluating performance on  test set...
1118/1118 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82862914
{'0': {'precision': 0.3287712567622907, 'recall': 0.3836615609044493, 'f1-score': 0.3541018617391708, 'support': 39759}, '1': {'precision': 0.7742850939768005, 'recall': 0.7312604352792993, 'f1-score': 0.7521579970172189, 'support': 204834}, '2': {'precision': 0.37221406357982034, 'recall': 0.4147016361886429, 'f1-score': 0.39231084403168537, 'support': 41560}, 'accuracy': 0.6369879050717623, 'macro avg': {'precision': 0.4917568047729705, 'recall': 0.5098745441241305, 'f1-score': 0.499523567596025, 'support': 286153}, 'weighted avg': {'precision': 0.6539884111633748, 'recall': 0.6369879050717623, 'f1-score': 0.6445877057373838, 'support': 286153}}
[[ 15254  22201   2304]
 [ 28282 149787  26765]
 [  2861  21464  17235]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.80966634
{'0': {'precision': 0.40361706735975744, 'recall': 0.36542798313560154, 'f1-score': 0.38357433232130916, 'support': 20398}, '1': {'precision': 0.7605296125102596, 'recall': 0.7926388654398109, 'f1-score': 0.7762523354699323, 'support': 88845}, '2': {'precision': 0.44989808847022533, 'recall': 0.40888154600981275, 'f1-score': 0.4284103129016183, 'support': 19974}, 'accuracy': 0.66587987648684, 'macro avg': {'precision': 0.5380149227800808, 'recall': 0.5223161315284084, 'f1-score': 0.52941232689762, 'support': 129217}, 'weighted avg': {'precision': 0.6561713921742698, 'recall': 0.66587987648684, 'f1-score': 0.6604963399971607, 'support': 129217}}
[[ 7454 11478  1466]
 [ 9903 70422  8520]
 [ 1111 10696  8167]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8169689
{'0': {'precision': 0.3797857934260741, 'recall': 0.4127642493979128, 'f1-score': 0.39558889530037833, 'support': 7474}, '1': {'precision': 0.7740422204847537, 'recall': 0.7548953821753187, 'f1-score': 0.7643489136980589, 'support': 32786}, '2': {'precision': 0.4653182937897057, 'recall': 0.4753012845980665, 'f1-score': 0.4702568134171907, 'support': 7551}, 'accuracy': 0.657254606680471, 'macro avg': {'precision': 0.5397154359001779, 'recall': 0.5476536387237659, 'f1-score': 0.5433982074718761, 'support': 47811}, 'weighted avg': {'precision': 0.6636524167510757, 'recall': 0.657254606680471, 'f1-score': 0.6602556751812929, 'support': 47811}}
[[ 3085  3883   506]
 [ 4418 24750  3618]
 [  620  3342  3589]]
training model: results/QRTEA/W9/deepOF_L1/h100
Epoch 1/50
505/505 - 10s - loss: 3.1923 - accuracy100: 0.4117 - val_loss: 3.3393 - val_accuracy100: 0.5445 - 10s/epoch - 19ms/step
Epoch 2/50
505/505 - 8s - loss: 3.1369 - accuracy100: 0.4449 - val_loss: 3.2465 - val_accuracy100: 0.5537 - 8s/epoch - 15ms/step
Epoch 3/50
505/505 - 8s - loss: 3.1051 - accuracy100: 0.4554 - val_loss: 3.2297 - val_accuracy100: 0.5624 - 8s/epoch - 15ms/step
Epoch 4/50
505/505 - 8s - loss: 3.0809 - accuracy100: 0.4706 - val_loss: 3.2102 - val_accuracy100: 0.5671 - 8s/epoch - 15ms/step
Epoch 5/50
505/505 - 7s - loss: 3.0631 - accuracy100: 0.4797 - val_loss: 3.2120 - val_accuracy100: 0.5700 - 7s/epoch - 15ms/step
Epoch 6/50
505/505 - 7s - loss: 3.0448 - accuracy100: 0.4846 - val_loss: 3.2028 - val_accuracy100: 0.5725 - 7s/epoch - 14ms/step
Epoch 7/50
505/505 - 7s - loss: 3.0331 - accuracy100: 0.4905 - val_loss: 3.2018 - val_accuracy100: 0.5715 - 7s/epoch - 15ms/step
Epoch 8/50
505/505 - 7s - loss: 3.0167 - accuracy100: 0.4958 - val_loss: 3.2031 - val_accuracy100: 0.5711 - 7s/epoch - 15ms/step
Epoch 9/50
505/505 - 7s - loss: 3.0029 - accuracy100: 0.4970 - val_loss: 3.2160 - val_accuracy100: 0.5762 - 7s/epoch - 14ms/step
Epoch 10/50
505/505 - 7s - loss: 2.9891 - accuracy100: 0.5003 - val_loss: 3.2185 - val_accuracy100: 0.5770 - 7s/epoch - 14ms/step
Epoch 11/50
505/505 - 7s - loss: 2.9787 - accuracy100: 0.4976 - val_loss: 3.2377 - val_accuracy100: 0.5806 - 7s/epoch - 14ms/step
Epoch 12/50
505/505 - 7s - loss: 2.9668 - accuracy100: 0.4990 - val_loss: 3.2220 - val_accuracy100: 0.5789 - 7s/epoch - 14ms/step
Epoch 13/50
505/505 - 7s - loss: 2.9538 - accuracy100: 0.5014 - val_loss: 3.2412 - val_accuracy100: 0.5792 - 7s/epoch - 15ms/step
Epoch 14/50
505/505 - 7s - loss: 2.9433 - accuracy100: 0.5028 - val_loss: 3.2558 - val_accuracy100: 0.5792 - 7s/epoch - 14ms/step
Epoch 15/50
505/505 - 7s - loss: 2.9307 - accuracy100: 0.5030 - val_loss: 3.2623 - val_accuracy100: 0.5798 - 7s/epoch - 15ms/step
Epoch 16/50
505/505 - 7s - loss: 2.9200 - accuracy100: 0.5055 - val_loss: 3.2851 - val_accuracy100: 0.5801 - 7s/epoch - 14ms/step
Epoch 17/50
505/505 - 7s - loss: 2.9092 - accuracy100: 0.5074 - val_loss: 3.2844 - val_accuracy100: 0.5772 - 7s/epoch - 14ms/step
testing model: results/QRTEA/W9/deepOF_L1/h100
Evaluating performance on  test set...
1118/1118 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9519798
{'0': {'precision': 0.3805757206999287, 'recall': 0.3028618179389568, 'f1-score': 0.3373003328560537, 'support': 59892}, '1': {'precision': 0.6205582916134027, 'recall': 0.7442067845058207, 'f1-score': 0.6767812261334445, 'support': 163726}, '2': {'precision': 0.43892079160932085, 'recall': 0.2957863596386024, 'f1-score': 0.3534109689807694, 'support': 62535}, 'accuracy': 0.5538365839253826, 'macro avg': {'precision': 0.4800182679742175, 'recall': 0.44761832069445995, 'f1-score': 0.4558308426567559, 'support': 286153}, 'weighted avg': {'precision': 0.5306352881854987, 'recall': 0.5538365839253826, 'f1-score': 0.5350593197015286, 'support': 286153}}
[[ 18139  36990   4763]
 [ 22998 121846  18882]
 [  6525  37513  18497]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.94217557
{'0': {'precision': 0.4470871191876002, 'recall': 0.2849114441416894, 'f1-score': 0.3480341169128354, 'support': 29360}, '1': {'precision': 0.6125386067261496, 'recall': 0.7966581586398315, 'f1-score': 0.6925702506896239, 'support': 71697}, '2': {'precision': 0.4923228460513355, 'recall': 0.30174005681818183, 'f1-score': 0.37416059358418285, 'support': 28160}, 'accuracy': 0.5725252869204517, 'macro avg': {'precision': 0.5173161906550284, 'recall': 0.4611032198665676, 'f1-score': 0.4715883203955474, 'support': 129217}, 'weighted avg': {'precision': 0.5487472209585295, 'recall': 0.5725252869204517, 'f1-score': 0.5448962075546205, 'support': 129217}}
[[ 8365 18739  2256]
 [ 8073 57118  6506]
 [ 2272 17391  8497]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9420347
{'0': {'precision': 0.42547816672681343, 'recall': 0.3273484497917631, 'f1-score': 0.37001778428705934, 'support': 10805}, '1': {'precision': 0.6237995432790064, 'recall': 0.7579247434435575, 'f1-score': 0.6843523173807848, 'support': 26310}, '2': {'precision': 0.5156021776656486, 'recall': 0.36303290949887806, 'f1-score': 0.4260712130356065, 'support': 10696}, 'accuracy': 0.5722741628495535, 'macro avg': {'precision': 0.5216266292238229, 'recall': 0.4827687009113995, 'f1-score': 0.49348043823448356, 'support': 47811}, 'weighted avg': {'precision': 0.5547748105554299, 'recall': 0.5722741628495535, 'f1-score': 0.5555334405082297, 'support': 47811}}
[[ 3537  6300   968]
 [ 3689 19941  2680]
 [ 1087  5726  3883]]
training model: results/QRTEA/W9/deepOF_L1/h200
Epoch 1/50
505/505 - 9s - loss: 3.2618 - accuracy200: 0.3957 - val_loss: 3.4161 - val_accuracy200: 0.4379 - 9s/epoch - 18ms/step
Epoch 2/50
505/505 - 8s - loss: 3.2342 - accuracy200: 0.4127 - val_loss: 3.3577 - val_accuracy200: 0.4475 - 8s/epoch - 15ms/step
Epoch 3/50
505/505 - 7s - loss: 3.2126 - accuracy200: 0.4217 - val_loss: 3.3477 - val_accuracy200: 0.4513 - 7s/epoch - 14ms/step
Epoch 4/50
505/505 - 7s - loss: 3.2002 - accuracy200: 0.4274 - val_loss: 3.3354 - val_accuracy200: 0.4532 - 7s/epoch - 14ms/step
Epoch 5/50
505/505 - 7s - loss: 3.1870 - accuracy200: 0.4331 - val_loss: 3.3289 - val_accuracy200: 0.4587 - 7s/epoch - 15ms/step
Epoch 6/50
505/505 - 7s - loss: 3.1795 - accuracy200: 0.4368 - val_loss: 3.3228 - val_accuracy200: 0.4604 - 7s/epoch - 14ms/step
Epoch 7/50
505/505 - 7s - loss: 3.1750 - accuracy200: 0.4416 - val_loss: 3.3147 - val_accuracy200: 0.4626 - 7s/epoch - 15ms/step
Epoch 8/50
505/505 - 7s - loss: 3.1672 - accuracy200: 0.4450 - val_loss: 3.3147 - val_accuracy200: 0.4637 - 7s/epoch - 14ms/step
Epoch 9/50
505/505 - 7s - loss: 3.1595 - accuracy200: 0.4486 - val_loss: 3.3111 - val_accuracy200: 0.4678 - 7s/epoch - 15ms/step
Epoch 10/50
505/505 - 7s - loss: 3.1528 - accuracy200: 0.4523 - val_loss: 3.3243 - val_accuracy200: 0.4677 - 7s/epoch - 14ms/step
Epoch 11/50
505/505 - 7s - loss: 3.1470 - accuracy200: 0.4533 - val_loss: 3.3335 - val_accuracy200: 0.4690 - 7s/epoch - 14ms/step
Epoch 12/50
505/505 - 7s - loss: 3.1409 - accuracy200: 0.4569 - val_loss: 3.3406 - val_accuracy200: 0.4696 - 7s/epoch - 15ms/step
Epoch 13/50
505/505 - 7s - loss: 3.1345 - accuracy200: 0.4589 - val_loss: 3.3332 - val_accuracy200: 0.4727 - 7s/epoch - 15ms/step
Epoch 14/50
505/505 - 7s - loss: 3.1285 - accuracy200: 0.4621 - val_loss: 3.3379 - val_accuracy200: 0.4734 - 7s/epoch - 14ms/step
Epoch 15/50
505/505 - 7s - loss: 3.1219 - accuracy200: 0.4620 - val_loss: 3.3655 - val_accuracy200: 0.4728 - 7s/epoch - 15ms/step
Epoch 16/50
505/505 - 7s - loss: 3.1184 - accuracy200: 0.4628 - val_loss: 3.3677 - val_accuracy200: 0.4739 - 7s/epoch - 15ms/step
Epoch 17/50
505/505 - 7s - loss: 3.1125 - accuracy200: 0.4646 - val_loss: 3.3649 - val_accuracy200: 0.4719 - 7s/epoch - 15ms/step
Epoch 18/50
505/505 - 7s - loss: 3.1059 - accuracy200: 0.4657 - val_loss: 3.3689 - val_accuracy200: 0.4746 - 7s/epoch - 14ms/step
Epoch 19/50
505/505 - 7s - loss: 3.1008 - accuracy200: 0.4680 - val_loss: 3.3888 - val_accuracy200: 0.4741 - 7s/epoch - 15ms/step
testing model: results/QRTEA/W9/deepOF_L1/h200
Evaluating performance on  test set...
1118/1118 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0630345
{'0': {'precision': 0.3974506243746989, 'recall': 0.13646831303993792, 'f1-score': 0.20317472344294593, 'support': 78597}, '1': {'precision': 0.4651194720221948, 'recall': 0.7756495787902952, 'f1-score': 0.5815259855570024, 'support': 126659}, '2': {'precision': 0.4185420794660549, 'recall': 0.24805617019172527, 'f1-score': 0.31149780351127737, 'support': 80897}, 'accuracy': 0.4509335914702974, 'macro avg': {'precision': 0.42703739195431617, 'recall': 0.38672468734065274, 'f1-score': 0.36539950417040856, 'support': 286153}, 'weighted avg': {'precision': 0.4333653413852128, 'recall': 0.4509335914702974, 'f1-score': 0.401266669766738, 'support': 286153}}
[[10726 57854 10017]
 [10555 98243 17861]
 [ 5706 55124 20067]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0571942
{'0': {'precision': 0.48514851485148514, 'recall': 0.13522993990353616, 'f1-score': 0.21150510306991005, 'support': 38771}, '1': {'precision': 0.4509782544056138, 'recall': 0.8372311259131139, 'f1-score': 0.5861982337140317, 'support': 54347}, '2': {'precision': 0.5035967115779858, 'recall': 0.24435579932962131, 'f1-score': 0.3290497062389257, 'support': 36099}, 'accuracy': 0.46096875798076103, 'macro avg': {'precision': 0.47990782694502826, 'recall': 0.4056056217154238, 'f1-score': 0.3755843476742891, 'support': 129217}, 'weighted avg': {'precision': 0.47593076725773337, 'recall': 0.46096875798076103, 'f1-score': 0.4019343051169656, 'support': 129217}}
[[ 5243 30060  3468]
 [ 3619 45501  5227]
 [ 1945 25333  8821]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0553825
{'0': {'precision': 0.44941176470588234, 'recall': 0.17587476979742173, 'f1-score': 0.25281270681667767, 'support': 14118}, '1': {'precision': 0.46129682997118154, 'recall': 0.7942738053887759, 'f1-score': 0.5836326180883452, 'support': 20153}, '2': {'precision': 0.5018455048774058, 'recall': 0.2811669128508124, 'f1-score': 0.36040897472309, 'support': 13540}, 'accuracy': 0.46635711447156514, 'macro avg': {'precision': 0.47085136651815657, 'recall': 0.41710516267900327, 'f1-score': 0.39895143320937093, 'support': 47811}, 'weighted avg': {'precision': 0.4692706373965603, 'recall': 0.46635711447156514, 'f1-score': 0.42272898422795835, 'support': 47811}}
[[ 2483 10052  1583]
 [ 1950 16007  2196]
 [ 1092  8641  3807]]
training model: results/QRTEA/W9/deepOF_L1/h300
Epoch 1/50
505/505 - 9s - loss: 3.2834 - accuracy300: 0.3857 - val_loss: 3.4400 - val_accuracy300: 0.3857 - 9s/epoch - 18ms/step
Epoch 2/50
505/505 - 7s - loss: 3.2641 - accuracy300: 0.3975 - val_loss: 3.3952 - val_accuracy300: 0.3929 - 7s/epoch - 14ms/step
Epoch 3/50
505/505 - 7s - loss: 3.2484 - accuracy300: 0.4032 - val_loss: 3.3658 - val_accuracy300: 0.3986 - 7s/epoch - 14ms/step
Epoch 4/50
505/505 - 7s - loss: 3.2373 - accuracy300: 0.4085 - val_loss: 3.3494 - val_accuracy300: 0.4015 - 7s/epoch - 15ms/step
Epoch 5/50
505/505 - 7s - loss: 3.2295 - accuracy300: 0.4125 - val_loss: 3.3380 - val_accuracy300: 0.4070 - 7s/epoch - 14ms/step
Epoch 6/50
505/505 - 7s - loss: 3.2238 - accuracy300: 0.4165 - val_loss: 3.3333 - val_accuracy300: 0.4098 - 7s/epoch - 15ms/step
Epoch 7/50
505/505 - 7s - loss: 3.2175 - accuracy300: 0.4176 - val_loss: 3.3391 - val_accuracy300: 0.4112 - 7s/epoch - 14ms/step
Epoch 8/50
505/505 - 7s - loss: 3.2125 - accuracy300: 0.4202 - val_loss: 3.3409 - val_accuracy300: 0.4102 - 7s/epoch - 14ms/step
Epoch 9/50
505/505 - 7s - loss: 3.2092 - accuracy300: 0.4230 - val_loss: 3.3393 - val_accuracy300: 0.4103 - 7s/epoch - 14ms/step
Epoch 10/50
505/505 - 7s - loss: 3.2051 - accuracy300: 0.4260 - val_loss: 3.3541 - val_accuracy300: 0.4077 - 7s/epoch - 14ms/step
Epoch 11/50
505/505 - 7s - loss: 3.2000 - accuracy300: 0.4275 - val_loss: 3.3508 - val_accuracy300: 0.4086 - 7s/epoch - 14ms/step
Epoch 12/50
505/505 - 7s - loss: 3.1962 - accuracy300: 0.4308 - val_loss: 3.3591 - val_accuracy300: 0.4119 - 7s/epoch - 14ms/step
Epoch 13/50
505/505 - 7s - loss: 3.1920 - accuracy300: 0.4323 - val_loss: 3.3668 - val_accuracy300: 0.4117 - 7s/epoch - 14ms/step
Epoch 14/50
505/505 - 7s - loss: 3.1864 - accuracy300: 0.4363 - val_loss: 3.3832 - val_accuracy300: 0.4112 - 7s/epoch - 14ms/step
Epoch 15/50
505/505 - 7s - loss: 3.1822 - accuracy300: 0.4361 - val_loss: 3.3869 - val_accuracy300: 0.4133 - 7s/epoch - 15ms/step
Epoch 16/50
505/505 - 7s - loss: 3.1782 - accuracy300: 0.4392 - val_loss: 3.3921 - val_accuracy300: 0.4112 - 7s/epoch - 14ms/step
testing model: results/QRTEA/W9/deepOF_L1/h300
Evaluating performance on  test set...
1118/1118 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979952
{'0': {'precision': 0.4057455418686352, 'recall': 0.10518913061022146, 'f1-score': 0.1670664493801842, 'support': 86739}, '1': {'precision': 0.403949032650958, 'recall': 0.777093884613305, 'f1-score': 0.5315747944124574, 'support': 110966}, '2': {'precision': 0.4088174356522432, 'recall': 0.23201202966714907, 'f1-score': 0.29602435013415657, 'support': 88448}, 'accuracy': 0.40494420816835747, 'macro avg': {'precision': 0.40617067005727875, 'recall': 0.37143168163022516, 'f1-score': 0.33155519797559935, 'support': 286153}, 'weighted avg': {'precision': 0.4059983835984923, 'recall': 0.40494420816835747, 'f1-score': 0.3482775547005497, 'support': 286153}}
[[ 9124 64831 12784]
 [ 7844 86231 16891]
 [ 5519 62408 20521]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1002533
{'0': {'precision': 0.47346740974073176, 'recall': 0.09041482544015918, 'f1-score': 0.15183480000777044, 'support': 43223}, '1': {'precision': 0.3821092831962397, 'recall': 0.8327500106705366, 'f1-score': 0.5238491589362188, 'support': 46858}, '2': {'precision': 0.4789577031258292, 'recall': 0.23060609157808667, 'f1-score': 0.3113196157229342, 'support': 39136}, 'accuracy': 0.4020678393709806, 'macro avg': {'precision': 0.44484479868760024, 'recall': 0.38459030922959414, 'f1-score': 0.3290011915556411, 'support': 129217}, 'weighted avg': {'precision': 0.4420010316968007, 'recall': 0.4020678393709806, 'f1-score': 0.3350417045056142, 'support': 129217}}
[[ 3908 34787  4528]
 [ 2547 39021  5290]
 [ 1799 28312  9025]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0961334
{'0': {'precision': 0.43721872187218724, 'recall': 0.1254276676780066, 'f1-score': 0.19493353398545274, 'support': 15491}, '1': {'precision': 0.38884161561152714, 'recall': 0.7900985533974987, 'f1-score': 0.5211853935788013, 'support': 17351}, '2': {'precision': 0.4840340278633954, 'recall': 0.262275369096132, 'f1-score': 0.340207972270364, 'support': 14969}, 'accuracy': 0.4094873564660852, 'macro avg': {'precision': 0.43669812178236994, 'recall': 0.39260053005721246, 'f1-score': 0.35210896661153934, 'support': 47811}, 'weighted avg': {'precision': 0.4343195385180152, 'recall': 0.4094873564660852, 'f1-score': 0.3588165124316477, 'support': 47811}}
[[ 1943 11579  1969]
 [ 1426 13709  2216]
 [ 1075  9968  3926]]
training model: results/QRTEA/W9/deepOF_L1/h500
Epoch 1/50
505/505 - 10s - loss: 3.3068 - accuracy500: 0.3721 - val_loss: 3.4005 - val_accuracy500: 0.3377 - 10s/epoch - 19ms/step
Epoch 2/50
505/505 - 7s - loss: 3.2882 - accuracy500: 0.3797 - val_loss: 3.3766 - val_accuracy500: 0.3444 - 7s/epoch - 15ms/step
Epoch 3/50
505/505 - 7s - loss: 3.2745 - accuracy500: 0.3869 - val_loss: 3.3633 - val_accuracy500: 0.3460 - 7s/epoch - 14ms/step
Epoch 4/50
505/505 - 7s - loss: 3.2695 - accuracy500: 0.3885 - val_loss: 3.3526 - val_accuracy500: 0.3471 - 7s/epoch - 14ms/step
Epoch 5/50
505/505 - 7s - loss: 3.2646 - accuracy500: 0.3925 - val_loss: 3.3482 - val_accuracy500: 0.3511 - 7s/epoch - 15ms/step
Epoch 6/50
505/505 - 7s - loss: 3.2602 - accuracy500: 0.3943 - val_loss: 3.3522 - val_accuracy500: 0.3529 - 7s/epoch - 14ms/step
Epoch 7/50
505/505 - 7s - loss: 3.2576 - accuracy500: 0.3944 - val_loss: 3.3444 - val_accuracy500: 0.3537 - 7s/epoch - 14ms/step
Epoch 8/50
505/505 - 7s - loss: 3.2545 - accuracy500: 0.3948 - val_loss: 3.3349 - val_accuracy500: 0.3539 - 7s/epoch - 15ms/step
Epoch 9/50
505/505 - 7s - loss: 3.2521 - accuracy500: 0.3996 - val_loss: 3.3287 - val_accuracy500: 0.3566 - 7s/epoch - 14ms/step
Epoch 10/50
505/505 - 7s - loss: 3.2495 - accuracy500: 0.3983 - val_loss: 3.3271 - val_accuracy500: 0.3560 - 7s/epoch - 15ms/step
Epoch 11/50
505/505 - 7s - loss: 3.2461 - accuracy500: 0.4018 - val_loss: 3.3339 - val_accuracy500: 0.3551 - 7s/epoch - 15ms/step
Epoch 12/50
505/505 - 7s - loss: 3.2447 - accuracy500: 0.4032 - val_loss: 3.3312 - val_accuracy500: 0.3572 - 7s/epoch - 14ms/step
Epoch 13/50
505/505 - 7s - loss: 3.2397 - accuracy500: 0.4052 - val_loss: 3.3397 - val_accuracy500: 0.3565 - 7s/epoch - 14ms/step
Epoch 14/50
505/505 - 7s - loss: 3.2390 - accuracy500: 0.4055 - val_loss: 3.3388 - val_accuracy500: 0.3576 - 7s/epoch - 14ms/step
Epoch 15/50
505/505 - 7s - loss: 3.2346 - accuracy500: 0.4094 - val_loss: 3.3509 - val_accuracy500: 0.3567 - 7s/epoch - 14ms/step
Epoch 16/50
505/505 - 7s - loss: 3.2351 - accuracy500: 0.4073 - val_loss: 3.3542 - val_accuracy500: 0.3570 - 7s/epoch - 14ms/step
Epoch 17/50
505/505 - 7s - loss: 3.2335 - accuracy500: 0.4092 - val_loss: 3.3449 - val_accuracy500: 0.3570 - 7s/epoch - 14ms/step
Epoch 18/50
505/505 - 7s - loss: 3.2306 - accuracy500: 0.4088 - val_loss: 3.3479 - val_accuracy500: 0.3557 - 7s/epoch - 14ms/step
Epoch 19/50
505/505 - 7s - loss: 3.2274 - accuracy500: 0.4121 - val_loss: 3.3586 - val_accuracy500: 0.3552 - 7s/epoch - 14ms/step
Epoch 20/50
505/505 - 7s - loss: 3.2244 - accuracy500: 0.4123 - val_loss: 3.3595 - val_accuracy500: 0.3563 - 7s/epoch - 14ms/step
testing model: results/QRTEA/W9/deepOF_L1/h500
Evaluating performance on  test set...
1118/1118 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1055617
{'0': {'precision': 0.39855239855239855, 'recall': 0.05762251463941398, 'f1-score': 0.10068765623024326, 'support': 89826}, '1': {'precision': 0.364675562789697, 'recall': 0.7793838341430257, 'f1-score': 0.49686622758803084, 'support': 100038}, '2': {'precision': 0.4103596395182347, 'recall': 0.2529987849079334, 'f1-score': 0.31301476351394764, 'support': 96289}, 'accuracy': 0.37569062704217676, 'macro avg': {'precision': 0.39119586695344344, 'recall': 0.3633350445634577, 'f1-score': 0.30352288244407394, 'support': 286153}, 'weighted avg': {'precision': 0.39068226100126424, 'recall': 0.37569062704217676, 'f1-score': 0.31063714742806736, 'support': 286153}}
[[ 5176 67735 16915]
 [ 3981 77968 18089]
 [ 3830 68098 24361]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1130756
{'0': {'precision': 0.48949240219851275, 'recall': 0.03231866114502839, 'f1-score': 0.06063397344760609, 'support': 46846}, '1': {'precision': 0.3239284657175866, 'recall': 0.8333374272309695, 'f1-score': 0.4665163224333764, 'support': 40711}, '2': {'precision': 0.45748211864802957, 'recall': 0.23490158425348057, 'f1-score': 0.31041537802731123, 'support': 41660}, 'accuracy': 0.35000038694599006, 'macro avg': {'precision': 0.4236343288547097, 'recall': 0.36685255754315943, 'f1-score': 0.27918855796943126, 'support': 129217}, 'weighted avg': {'precision': 0.4270097425578454, 'recall': 0.35000038694599006, 'f1-score': 0.2690413008453185, 'support': 129217}}
[[ 1514 39639  5693]
 [  873 33926  5912]
 [  706 31168  9786]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.115384
{'0': {'precision': 0.4011299435028249, 'recall': 0.04302248076107375, 'f1-score': 0.07771028293110054, 'support': 16503}, '1': {'precision': 0.3294760179527389, 'recall': 0.8045157456922163, 'f1-score': 0.4674965952467727, 'support': 15147}, '2': {'precision': 0.45643290999447816, 'recall': 0.2557391250541427, 'f1-score': 0.32780774111675126, 'support': 16161}, 'accuracy': 0.3561732655665014, 'macro avg': {'precision': 0.39567962381668065, 'recall': 0.3677591171691443, 'f1-score': 0.29100487309820816, 'support': 47811}, 'weighted avg': {'precision': 0.397122690593755, 'recall': 0.3561732655665014, 'f1-score': 0.28573601538563587, 'support': 47811}}
[[  710 13278  2515]
 [  554 12186  2407]
 [  506 11522  4133]]
training model: results/QRTEA/W9/deepOF_L1/h1000
Epoch 1/50
505/505 - 9s - loss: 3.3267 - accuracy1000: 0.3646 - val_loss: 3.3150 - val_accuracy1000: 0.3583 - 9s/epoch - 19ms/step
Epoch 2/50
505/505 - 7s - loss: 3.3114 - accuracy1000: 0.3633 - val_loss: 3.3081 - val_accuracy1000: 0.3629 - 7s/epoch - 14ms/step
Epoch 3/50
505/505 - 7s - loss: 3.2996 - accuracy1000: 0.3671 - val_loss: 3.3020 - val_accuracy1000: 0.3657 - 7s/epoch - 14ms/step
Epoch 4/50
505/505 - 7s - loss: 3.2953 - accuracy1000: 0.3688 - val_loss: 3.2959 - val_accuracy1000: 0.3661 - 7s/epoch - 15ms/step
Epoch 5/50
505/505 - 8s - loss: 3.2917 - accuracy1000: 0.3660 - val_loss: 3.2938 - val_accuracy1000: 0.3651 - 8s/epoch - 16ms/step
Epoch 6/50
505/505 - 7s - loss: 3.2895 - accuracy1000: 0.3644 - val_loss: 3.2924 - val_accuracy1000: 0.3642 - 7s/epoch - 15ms/step
Epoch 7/50
505/505 - 7s - loss: 3.2874 - accuracy1000: 0.3650 - val_loss: 3.2907 - val_accuracy1000: 0.3630 - 7s/epoch - 15ms/step
Epoch 8/50
505/505 - 7s - loss: 3.2861 - accuracy1000: 0.3657 - val_loss: 3.2915 - val_accuracy1000: 0.3592 - 7s/epoch - 14ms/step
Epoch 9/50
505/505 - 7s - loss: 3.2852 - accuracy1000: 0.3670 - val_loss: 3.2902 - val_accuracy1000: 0.3619 - 7s/epoch - 14ms/step
Epoch 10/50
505/505 - 7s - loss: 3.2820 - accuracy1000: 0.3688 - val_loss: 3.2908 - val_accuracy1000: 0.3608 - 7s/epoch - 14ms/step
Epoch 11/50
505/505 - 7s - loss: 3.2805 - accuracy1000: 0.3708 - val_loss: 3.2890 - val_accuracy1000: 0.3586 - 7s/epoch - 14ms/step
Epoch 12/50
505/505 - 7s - loss: 3.2783 - accuracy1000: 0.3728 - val_loss: 3.2889 - val_accuracy1000: 0.3587 - 7s/epoch - 14ms/step
Epoch 13/50
505/505 - 7s - loss: 3.2762 - accuracy1000: 0.3745 - val_loss: 3.2895 - val_accuracy1000: 0.3585 - 7s/epoch - 14ms/step
Epoch 14/50
505/505 - 7s - loss: 3.2754 - accuracy1000: 0.3736 - val_loss: 3.2905 - val_accuracy1000: 0.3529 - 7s/epoch - 14ms/step
Epoch 15/50
505/505 - 7s - loss: 3.2726 - accuracy1000: 0.3766 - val_loss: 3.2909 - val_accuracy1000: 0.3539 - 7s/epoch - 14ms/step
Epoch 16/50
505/505 - 7s - loss: 3.2714 - accuracy1000: 0.3778 - val_loss: 3.2906 - val_accuracy1000: 0.3525 - 7s/epoch - 14ms/step
Epoch 17/50
505/505 - 7s - loss: 3.2699 - accuracy1000: 0.3768 - val_loss: 3.2898 - val_accuracy1000: 0.3531 - 7s/epoch - 14ms/step
Epoch 18/50
505/505 - 7s - loss: 3.2676 - accuracy1000: 0.3814 - val_loss: 3.2900 - val_accuracy1000: 0.3526 - 7s/epoch - 14ms/step
Epoch 19/50
505/505 - 7s - loss: 3.2666 - accuracy1000: 0.3818 - val_loss: 3.2896 - val_accuracy1000: 0.3547 - 7s/epoch - 14ms/step
Epoch 20/50
505/505 - 7s - loss: 3.2645 - accuracy1000: 0.3818 - val_loss: 3.2911 - val_accuracy1000: 0.3502 - 7s/epoch - 14ms/step
Epoch 21/50
505/505 - 7s - loss: 3.2648 - accuracy1000: 0.3828 - val_loss: 3.2910 - val_accuracy1000: 0.3527 - 7s/epoch - 14ms/step
Epoch 22/50
505/505 - 7s - loss: 3.2619 - accuracy1000: 0.3837 - val_loss: 3.2912 - val_accuracy1000: 0.3554 - 7s/epoch - 15ms/step
testing model: results/QRTEA/W9/deepOF_L1/h1000
Evaluating performance on  test set...
1118/1118 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0967653
{'0': {'precision': 0.35033592000416647, 'recall': 0.3678580803219879, 'f1-score': 0.3588832514391502, 'support': 91432}, '1': {'precision': 0.330566255381383, 'recall': 0.33744414655942806, 'f1-score': 0.33396979329792054, 'support': 95115}, '2': {'precision': 0.3852601715133149, 'recall': 0.3599180772242636, 'f1-score': 0.37215820616630335, 'support': 99606}, 'accuracy': 0.3549849206543353, 'macro avg': {'precision': 0.3553874489662881, 'recall': 0.3550734347018932, 'f1-score': 0.3550037503011247, 'support': 286153}, 'weighted avg': {'precision': 0.3559213003609133, 'recall': 0.3549849206543353, 'f1-score': 0.35522304717587067, 'support': 286153}}
[[33634 31268 26530]
 [32345 32096 30674]
 [30026 33730 35850]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0934844
{'0': {'precision': 0.38781276962899053, 'recall': 0.3900592280823552, 'f1-score': 0.38893275502147034, 'support': 46093}, '1': {'precision': 0.33639915350805794, 'recall': 0.2921398614579897, 'f1-score': 0.3127112232030264, 'support': 42442}, '2': {'precision': 0.35733385508380616, 'recall': 0.40403618307851136, 'f1-score': 0.37925266205973623, 'support': 40682}, 'accuracy': 0.3622975305106913, 'macro avg': {'precision': 0.36051525940695156, 'recall': 0.3620784242062854, 'f1-score': 0.36029888009474437, 'support': 129217}, 'weighted avg': {'precision': 0.36132987730884836, 'recall': 0.3622975305106913, 'f1-score': 0.3608497644296158, 'support': 129217}}
[[17979 13333 14781]
 [15262 12399 14781]
 [13119 11126 16437]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0954381
{'0': {'precision': 0.37296266327592187, 'recall': 0.3930921052631579, 'f1-score': 0.3827629159499378, 'support': 16416}, '1': {'precision': 0.3257631617755493, 'recall': 0.28249888100262166, 'f1-score': 0.30259237697339136, 'support': 15639}, '2': {'precision': 0.36702661237977224, 'recall': 0.39477024625539475, 'f1-score': 0.3803932360945479, 'support': 15756}, 'accuracy': 0.3574700382757106, 'macro avg': {'precision': 0.3552508124770812, 'recall': 0.3567870775070581, 'f1-score': 0.35524950967262564, 'support': 47811}, 'weighted avg': {'precision': 0.3555674734266391, 'recall': 0.3574700382757106, 'f1-score': 0.355758173634242, 'support': 47811}}
[[6453 4764 5199]
 [5693 4418 5528]
 [5156 4380 6220]]
training model: results/QRTEA/W9/deepLOB_L2/h10
Epoch 1/50
505/505 - 24s - loss: 3.1604 - accuracy10: 0.3719 - val_loss: 3.2341 - val_accuracy10: 0.6282 - 24s/epoch - 47ms/step
Epoch 2/50
505/505 - 21s - loss: 2.8412 - accuracy10: 0.4294 - val_loss: 3.0933 - val_accuracy10: 0.6733 - 21s/epoch - 41ms/step
Epoch 3/50
505/505 - 21s - loss: 2.6942 - accuracy10: 0.5005 - val_loss: 3.0141 - val_accuracy10: 0.6604 - 21s/epoch - 41ms/step
Epoch 4/50
505/505 - 21s - loss: 2.5865 - accuracy10: 0.5427 - val_loss: 2.9054 - val_accuracy10: 0.6498 - 21s/epoch - 41ms/step
Epoch 5/50
505/505 - 21s - loss: 2.5118 - accuracy10: 0.5756 - val_loss: 2.9082 - val_accuracy10: 0.6620 - 21s/epoch - 41ms/step
Epoch 6/50
505/505 - 21s - loss: 2.4160 - accuracy10: 0.6109 - val_loss: 2.8874 - val_accuracy10: 0.6891 - 21s/epoch - 42ms/step
Epoch 7/50
505/505 - 21s - loss: 2.3438 - accuracy10: 0.6381 - val_loss: 2.8225 - val_accuracy10: 0.6979 - 21s/epoch - 41ms/step
Epoch 8/50
505/505 - 21s - loss: 2.2814 - accuracy10: 0.6593 - val_loss: 2.7466 - val_accuracy10: 0.6894 - 21s/epoch - 41ms/step
Epoch 9/50
505/505 - 21s - loss: 2.2270 - accuracy10: 0.6808 - val_loss: 2.7512 - val_accuracy10: 0.7221 - 21s/epoch - 41ms/step
Epoch 10/50
505/505 - 21s - loss: 2.1860 - accuracy10: 0.6939 - val_loss: 2.7119 - val_accuracy10: 0.6908 - 21s/epoch - 42ms/step
Epoch 11/50
505/505 - 21s - loss: 2.1410 - accuracy10: 0.7021 - val_loss: 2.7633 - val_accuracy10: 0.7157 - 21s/epoch - 41ms/step
Epoch 12/50
505/505 - 21s - loss: 2.1089 - accuracy10: 0.7074 - val_loss: 2.7056 - val_accuracy10: 0.7032 - 21s/epoch - 41ms/step
Epoch 13/50
505/505 - 21s - loss: 2.0715 - accuracy10: 0.7092 - val_loss: 2.6771 - val_accuracy10: 0.7179 - 21s/epoch - 42ms/step
Epoch 14/50
505/505 - 21s - loss: 2.0441 - accuracy10: 0.7118 - val_loss: 2.7706 - val_accuracy10: 0.7313 - 21s/epoch - 41ms/step
Epoch 15/50
505/505 - 21s - loss: 2.0278 - accuracy10: 0.7121 - val_loss: 2.7835 - val_accuracy10: 0.7287 - 21s/epoch - 41ms/step
Epoch 16/50
505/505 - 21s - loss: 1.9999 - accuracy10: 0.7159 - val_loss: 2.7140 - val_accuracy10: 0.6937 - 21s/epoch - 41ms/step
Epoch 17/50
505/505 - 21s - loss: 1.9684 - accuracy10: 0.7194 - val_loss: 2.8414 - val_accuracy10: 0.7040 - 21s/epoch - 41ms/step
Epoch 18/50
505/505 - 21s - loss: 1.9426 - accuracy10: 0.7197 - val_loss: 2.9543 - val_accuracy10: 0.7112 - 21s/epoch - 41ms/step
Epoch 19/50
505/505 - 21s - loss: 1.9118 - accuracy10: 0.7188 - val_loss: 2.9898 - val_accuracy10: 0.7131 - 21s/epoch - 41ms/step
Epoch 20/50
505/505 - 21s - loss: 1.8875 - accuracy10: 0.7224 - val_loss: 2.9171 - val_accuracy10: 0.6836 - 21s/epoch - 41ms/step
Epoch 21/50
505/505 - 21s - loss: 1.8636 - accuracy10: 0.7244 - val_loss: 3.1246 - val_accuracy10: 0.7271 - 21s/epoch - 41ms/step
Epoch 22/50
505/505 - 21s - loss: 1.8508 - accuracy10: 0.7217 - val_loss: 3.0601 - val_accuracy10: 0.7060 - 21s/epoch - 41ms/step
Epoch 23/50
505/505 - 21s - loss: 1.8207 - accuracy10: 0.7205 - val_loss: 3.1159 - val_accuracy10: 0.6956 - 21s/epoch - 41ms/step
testing model: results/QRTEA/W9/deepLOB_L2/h10
Evaluating performance on  test set...
1118/1118 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70938617
{'0': {'precision': 0.16362398771292935, 'recall': 0.5315228483955097, 'f1-score': 0.2502201937705181, 'support': 17638}, '1': {'precision': 0.9142167674303951, 'recall': 0.7039335405861151, 'f1-score': 0.795411702821744, 'support': 250258}, '2': {'precision': 0.206381684455013, 'recall': 0.4087399375718745, 'f1-score': 0.27427563525456117, 'support': 18261}, 'accuracy': 0.6744689104232992, 'macro avg': {'precision': 0.42807414653277914, 'recall': 0.5480654421844998, 'f1-score': 0.4399691772822744, 'support': 286157}, 'weighted avg': {'precision': 0.8227818841360143, 'recall': 0.6744689104232992, 'f1-score': 0.7285513654318153, 'support': 286157}}
[[  9375   7541    722]
 [ 46113 176165  27980]
 [  1808   8989   7464]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.57939976
{'0': {'precision': 0.274753609901444, 'recall': 0.5115758028379388, 'f1-score': 0.35750232991612313, 'support': 9373}, '1': {'precision': 0.9228614995166387, 'recall': 0.8370531073446328, 'f1-score': 0.8778654177964014, 'support': 110625}, '2': {'precision': 0.3352004200945213, 'recall': 0.4154463607766569, 'f1-score': 0.3710341487042868, 'support': 9219}, 'accuracy': 0.7833644179945364, 'macro avg': {'precision': 0.5109385098375346, 'recall': 0.5880250903197429, 'f1-score': 0.5354672988056037, 'support': 129217}, 'weighted avg': {'precision': 0.8339230259368797, 'recall': 0.7833644179945364, 'f1-score': 0.8039599665596286, 'support': 129217}}
[[ 4795  3340  1238]
 [11668 92599  6358]
 [  989  4400  3830]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67833424
{'0': {'precision': 0.19901125486483642, 'recall': 0.5700512202470623, 'f1-score': 0.2950257289879931, 'support': 3319}, '1': {'precision': 0.9273396044380126, 'recall': 0.7502866203195512, 'f1-score': 0.8294702209996899, 'support': 40995}, '2': {'precision': 0.3164655507979759, 'recall': 0.46470420120034295, 'f1-score': 0.37651962486974644, 'support': 3499}, 'accuracy': 0.7168761633865267, 'macro avg': {'precision': 0.48093880336694167, 'recall': 0.5950140139223188, 'f1-score': 0.5003385249524764, 'support': 47813}, 'weighted avg': {'precision': 0.8320774350296956, 'recall': 0.7168761633865267, 'f1-score': 0.759223731449871, 'support': 47813}}
[[ 1892  1068   359]
 [ 7084 30758  3153]
 [  531  1342  1626]]
training model: results/QRTEA/W9/deepLOB_L2/h20
Epoch 1/50
505/505 - 23s - loss: 3.0653 - accuracy20: 0.3665 - val_loss: 3.1918 - val_accuracy20: 0.6889 - 23s/epoch - 45ms/step
Epoch 2/50
505/505 - 21s - loss: 2.8525 - accuracy20: 0.4077 - val_loss: 3.0145 - val_accuracy20: 0.6788 - 21s/epoch - 41ms/step
Epoch 3/50
505/505 - 21s - loss: 2.7666 - accuracy20: 0.4643 - val_loss: 3.1064 - val_accuracy20: 0.6617 - 21s/epoch - 41ms/step
Epoch 4/50
505/505 - 21s - loss: 2.7003 - accuracy20: 0.4785 - val_loss: 2.9452 - val_accuracy20: 0.5880 - 21s/epoch - 41ms/step
Epoch 5/50
505/505 - 21s - loss: 2.6311 - accuracy20: 0.5225 - val_loss: 2.9814 - val_accuracy20: 0.6112 - 21s/epoch - 42ms/step
Epoch 6/50
505/505 - 21s - loss: 2.5639 - accuracy20: 0.5491 - val_loss: 3.0025 - val_accuracy20: 0.6632 - 21s/epoch - 41ms/step
Epoch 7/50
505/505 - 21s - loss: 2.5089 - accuracy20: 0.5727 - val_loss: 3.0150 - val_accuracy20: 0.6481 - 21s/epoch - 41ms/step
Epoch 8/50
505/505 - 21s - loss: 2.4554 - accuracy20: 0.5942 - val_loss: 3.0360 - val_accuracy20: 0.6727 - 21s/epoch - 41ms/step
Epoch 9/50
505/505 - 21s - loss: 2.4218 - accuracy20: 0.6106 - val_loss: 2.8893 - val_accuracy20: 0.6633 - 21s/epoch - 42ms/step
Epoch 10/50
505/505 - 21s - loss: 2.3696 - accuracy20: 0.6221 - val_loss: 2.9076 - val_accuracy20: 0.6652 - 21s/epoch - 42ms/step
Epoch 11/50
505/505 - 21s - loss: 2.3361 - accuracy20: 0.6328 - val_loss: 2.8493 - val_accuracy20: 0.6714 - 21s/epoch - 42ms/step
Epoch 12/50
505/505 - 21s - loss: 2.3015 - accuracy20: 0.6420 - val_loss: 2.9235 - val_accuracy20: 0.6943 - 21s/epoch - 41ms/step
Epoch 13/50
505/505 - 21s - loss: 2.2668 - accuracy20: 0.6498 - val_loss: 2.9133 - val_accuracy20: 0.6670 - 21s/epoch - 41ms/step
Epoch 14/50
505/505 - 21s - loss: 2.2424 - accuracy20: 0.6554 - val_loss: 2.9238 - val_accuracy20: 0.6900 - 21s/epoch - 41ms/step
Epoch 15/50
505/505 - 21s - loss: 2.2060 - accuracy20: 0.6613 - val_loss: 2.8677 - val_accuracy20: 0.6851 - 21s/epoch - 41ms/step
Epoch 16/50
505/505 - 21s - loss: 2.1775 - accuracy20: 0.6664 - val_loss: 2.8561 - val_accuracy20: 0.6719 - 21s/epoch - 41ms/step
Epoch 17/50
505/505 - 21s - loss: 2.1481 - accuracy20: 0.6723 - val_loss: 2.9550 - val_accuracy20: 0.7105 - 21s/epoch - 41ms/step
Epoch 18/50
505/505 - 21s - loss: 2.1225 - accuracy20: 0.6765 - val_loss: 2.9650 - val_accuracy20: 0.6929 - 21s/epoch - 41ms/step
Epoch 19/50
505/505 - 21s - loss: 2.0941 - accuracy20: 0.6817 - val_loss: 2.9628 - val_accuracy20: 0.6801 - 21s/epoch - 41ms/step
Epoch 20/50
505/505 - 21s - loss: 2.0668 - accuracy20: 0.6863 - val_loss: 3.0064 - val_accuracy20: 0.6856 - 21s/epoch - 41ms/step
Epoch 21/50
505/505 - 21s - loss: 2.0419 - accuracy20: 0.6877 - val_loss: 2.9842 - val_accuracy20: 0.6682 - 21s/epoch - 42ms/step
testing model: results/QRTEA/W9/deepLOB_L2/h20
Evaluating performance on  test set...
1118/1118 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6703626
{'0': {'precision': 0.2801912082943057, 'recall': 0.35756976216973746, 'f1-score': 0.3141863749954728, 'support': 24261}, '1': {'precision': 0.8659008565716833, 'recall': 0.8288514341232628, 'f1-score': 0.846971171797268, 'support': 236730}, '2': {'precision': 0.2979192166462668, 'recall': 0.3385122784709529, 'f1-score': 0.3169211882219453, 'support': 25166}, 'accuracy': 0.7457724256264917, 'macro avg': {'precision': 0.4813370938374186, 'recall': 0.508311158254651, 'f1-score': 0.4926929116715621, 'support': 286157}, 'weighted avg': {'precision': 0.7662921532122671, 'recall': 0.7457724256264917, 'f1-score': 0.7551854393431784, 'support': 286157}}
[[  8675  14968    618]
 [ 21058 196214  19458]
 [  1228  15419   8519]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7070533
{'0': {'precision': 0.3095883534136546, 'recall': 0.47977283335926557, 'f1-score': 0.37633489961554883, 'support': 12854}, '1': {'precision': 0.8686588720039929, 'recall': 0.7885685089317562, 'f1-score': 0.8266783898776138, 'support': 103731}, '2': {'precision': 0.32068737607402514, 'recall': 0.38410386320455986, 'f1-score': 0.3495425401628125, 'support': 12632}, 'accuracy': 0.7183110581425045, 'macro avg': {'precision': 0.4996448671638909, 'recall': 0.5508150684985272, 'f1-score': 0.517518609885325, 'support': 129217}, 'weighted avg': {'precision': 0.759476114452374, 'recall': 0.7183110581425045, 'f1-score': 0.7352361239418161, 'support': 129217}}
[[ 6167  5714   973]
 [12627 81799  9305]
 [ 1126  6654  4852]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.79086936
{'0': {'precision': 0.2394556509989383, 'recall': 0.537012987012987, 'f1-score': 0.33121954475669185, 'support': 4620}, '1': {'precision': 0.8735661402561088, 'recall': 0.7159375, 'f1-score': 0.7869359247756581, 'support': 38400}, '2': {'precision': 0.35144624644708244, 'recall': 0.4385562278322554, 'f1-score': 0.39019862632262853, 'support': 4793}, 'accuracy': 0.6708426578545584, 'macro avg': {'precision': 0.4881560125673765, 'recall': 0.5638355716150808, 'f1-score': 0.5027846986183261, 'support': 47813}, 'weighted avg': {'precision': 0.7599545469364094, 'recall': 0.6708426578545584, 'f1-score': 0.7031308603125833, 'support': 47813}}
[[ 2481  1828   311]
 [ 7340 27492  3568]
 [  540  2151  2102]]
training model: results/QRTEA/W9/deepLOB_L2/h30
Epoch 1/50
505/505 - 23s - loss: 3.0841 - accuracy30: 0.3926 - val_loss: 3.3655 - val_accuracy30: 0.7064 - 23s/epoch - 46ms/step
Epoch 2/50
505/505 - 21s - loss: 2.8470 - accuracy30: 0.4326 - val_loss: 3.1064 - val_accuracy30: 0.6314 - 21s/epoch - 42ms/step
Epoch 3/50
505/505 - 21s - loss: 2.7623 - accuracy30: 0.4815 - val_loss: 2.9398 - val_accuracy30: 0.6408 - 21s/epoch - 42ms/step
Epoch 4/50
505/505 - 21s - loss: 2.7044 - accuracy30: 0.5156 - val_loss: 3.0787 - val_accuracy30: 0.6229 - 21s/epoch - 41ms/step
Epoch 5/50
505/505 - 21s - loss: 2.6616 - accuracy30: 0.5284 - val_loss: 2.9778 - val_accuracy30: 0.5938 - 21s/epoch - 42ms/step
Epoch 6/50
505/505 - 21s - loss: 2.6156 - accuracy30: 0.5454 - val_loss: 2.9670 - val_accuracy30: 0.5848 - 21s/epoch - 42ms/step
Epoch 7/50
505/505 - 21s - loss: 2.5796 - accuracy30: 0.5553 - val_loss: 2.9960 - val_accuracy30: 0.5811 - 21s/epoch - 41ms/step
Epoch 8/50
505/505 - 21s - loss: 2.5418 - accuracy30: 0.5704 - val_loss: 2.9396 - val_accuracy30: 0.5739 - 21s/epoch - 41ms/step
Epoch 9/50
505/505 - 21s - loss: 2.4995 - accuracy30: 0.5805 - val_loss: 2.9897 - val_accuracy30: 0.5612 - 21s/epoch - 41ms/step
Epoch 10/50
505/505 - 21s - loss: 2.4647 - accuracy30: 0.5856 - val_loss: 3.0486 - val_accuracy30: 0.6163 - 21s/epoch - 41ms/step
Epoch 11/50
505/505 - 21s - loss: 2.4222 - accuracy30: 0.5996 - val_loss: 3.0660 - val_accuracy30: 0.6011 - 21s/epoch - 41ms/step
Epoch 12/50
505/505 - 21s - loss: 2.3868 - accuracy30: 0.6037 - val_loss: 3.0510 - val_accuracy30: 0.5968 - 21s/epoch - 41ms/step
Epoch 13/50
505/505 - 21s - loss: 2.3616 - accuracy30: 0.6112 - val_loss: 3.0455 - val_accuracy30: 0.6370 - 21s/epoch - 41ms/step
Epoch 14/50
505/505 - 21s - loss: 2.3141 - accuracy30: 0.6177 - val_loss: 3.0996 - val_accuracy30: 0.6114 - 21s/epoch - 41ms/step
Epoch 15/50
505/505 - 21s - loss: 2.2831 - accuracy30: 0.6238 - val_loss: 3.0780 - val_accuracy30: 0.5852 - 21s/epoch - 41ms/step
Epoch 16/50
505/505 - 21s - loss: 2.2464 - accuracy30: 0.6315 - val_loss: 3.1635 - val_accuracy30: 0.6035 - 21s/epoch - 41ms/step
Epoch 17/50
505/505 - 21s - loss: 2.2245 - accuracy30: 0.6322 - val_loss: 3.0375 - val_accuracy30: 0.6310 - 21s/epoch - 42ms/step
Epoch 18/50
505/505 - 21s - loss: 2.1959 - accuracy30: 0.6361 - val_loss: 3.1045 - val_accuracy30: 0.6063 - 21s/epoch - 41ms/step
testing model: results/QRTEA/W9/deepLOB_L2/h30
Evaluating performance on  test set...
1118/1118 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0003169
{'0': {'precision': 0.1947170557973882, 'recall': 0.66282750724052, 'f1-score': 0.30100784559621946, 'support': 29694}, '1': {'precision': 0.8397033656588705, 'recall': 0.3981077114747702, 'f1-score': 0.5401347449470645, 'support': 225547}, '2': {'precision': 0.21230036855036855, 'recall': 0.5366153448052788, 'f1-score': 0.3042362002567394, 'support': 30916}, 'accuracy': 0.4405413811299392, 'macro avg': {'precision': 0.4155735966688758, 'recall': 0.5325168545068563, 'f1-score': 0.38179293026667444, 'support': 286157}, 'weighted avg': {'precision': 0.7049905522605148, 'recall': 0.4405413811299392, 'f1-score': 0.48983482722018695, 'support': 286157}}
[[19682  6633  3379]
 [77580 89792 58175]
 [ 3818 10508 16590]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81625795
{'0': {'precision': 0.2760390097524381, 'recall': 0.5914614543817913, 'f1-score': 0.37640656328000327, 'support': 15553}, '1': {'precision': 0.8477140415531699, 'recall': 0.6457180634662327, 'f1-score': 0.7330554465048611, 'support': 98320}, '2': {'precision': 0.3254761904761905, 'recall': 0.4454509906152242, 'f1-score': 0.3761281091789566, 'support': 15344}, 'accuracy': 0.6154066415409737, 'macro avg': {'precision': 0.48307641392726614, 'recall': 0.5608768361544161, 'f1-score': 0.49519670632127366, 'support': 129217}, 'weighted avg': {'precision': 0.7168916315256816, 'recall': 0.6154066415409737, 'f1-score': 0.647744278897465, 'support': 129217}}
[[ 9199  4835  1519]
 [22187 63487 12646]
 [ 1939  6570  6835]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88678604
{'0': {'precision': 0.2331958762886598, 'recall': 0.5982016925246827, 'f1-score': 0.33557511621006825, 'support': 5672}, '1': {'precision': 0.8398498592430403, 'recall': 0.5906453653037094, 'f1-score': 0.6935408359298064, 'support': 36367}, '2': {'precision': 0.3364121243658124, 'recall': 0.44786976099757536, 'f1-score': 0.38422108312903946, 'support': 5774}, 'accuracy': 0.5742998766025976, 'macro avg': {'precision': 0.46981928663250416, 'recall': 0.5455722729419891, 'f1-score': 0.4711123450896381, 'support': 47813}, 'weighted avg': {'precision': 0.7070869940704229, 'recall': 0.5742998766025976, 'f1-score': 0.6137216692822005, 'support': 47813}}
[[ 3393  1728   551]
 [10337 21480  4550]
 [  820  2368  2586]]
training model: results/QRTEA/W9/deepLOB_L2/h50
Epoch 1/50
505/505 - 23s - loss: 3.1778 - accuracy50: 0.3793 - val_loss: 3.4085 - val_accuracy50: 0.5927 - 23s/epoch - 46ms/step
Epoch 2/50
505/505 - 21s - loss: 2.9235 - accuracy50: 0.4347 - val_loss: 3.3041 - val_accuracy50: 0.5500 - 21s/epoch - 42ms/step
Epoch 3/50
505/505 - 21s - loss: 2.8458 - accuracy50: 0.4754 - val_loss: 3.1484 - val_accuracy50: 0.5559 - 21s/epoch - 41ms/step
Epoch 4/50
505/505 - 21s - loss: 2.7824 - accuracy50: 0.5046 - val_loss: 3.1598 - val_accuracy50: 0.5559 - 21s/epoch - 41ms/step
Epoch 5/50
505/505 - 21s - loss: 2.7405 - accuracy50: 0.5223 - val_loss: 3.2311 - val_accuracy50: 0.5620 - 21s/epoch - 41ms/step
Epoch 6/50
505/505 - 21s - loss: 2.7000 - accuracy50: 0.5326 - val_loss: 3.1879 - val_accuracy50: 0.5813 - 21s/epoch - 41ms/step
Epoch 7/50
505/505 - 21s - loss: 2.6542 - accuracy50: 0.5451 - val_loss: 3.1769 - val_accuracy50: 0.5560 - 21s/epoch - 41ms/step
Epoch 8/50
505/505 - 21s - loss: 2.6167 - accuracy50: 0.5555 - val_loss: 3.1925 - val_accuracy50: 0.5441 - 21s/epoch - 41ms/step
Epoch 9/50
505/505 - 21s - loss: 2.5764 - accuracy50: 0.5666 - val_loss: 3.2742 - val_accuracy50: 0.5683 - 21s/epoch - 42ms/step
Epoch 10/50
505/505 - 21s - loss: 2.5358 - accuracy50: 0.5777 - val_loss: 3.3409 - val_accuracy50: 0.6082 - 21s/epoch - 41ms/step
Epoch 11/50
505/505 - 21s - loss: 2.5031 - accuracy50: 0.5824 - val_loss: 3.2822 - val_accuracy50: 0.5794 - 21s/epoch - 42ms/step
Epoch 12/50
505/505 - 21s - loss: 2.4632 - accuracy50: 0.5887 - val_loss: 3.2959 - val_accuracy50: 0.5756 - 21s/epoch - 41ms/step
Epoch 13/50
505/505 - 21s - loss: 2.4352 - accuracy50: 0.5927 - val_loss: 3.2497 - val_accuracy50: 0.5617 - 21s/epoch - 42ms/step
testing model: results/QRTEA/W9/deepLOB_L2/h50
Evaluating performance on  test set...
1118/1118 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1055083
{'0': {'precision': 0.17955680956417006, 'recall': 0.8099046756709173, 'f1-score': 0.2939455487345672, 'support': 39759}, '1': {'precision': 0.7101024168402371, 'recall': 0.2812821902293043, 'f1-score': 0.4029498978935296, 'support': 204837}, '2': {'precision': 0.38653531656413054, 'recall': 0.23885373306705807, 'f1-score': 0.29525749892182085, 'support': 41561}, 'accuracy': 0.3485673948217237, 'macro avg': {'precision': 0.4253981809895126, 'recall': 0.44334686632242654, 'f1-score': 0.3307176485166392, 'support': 286157}, 'weighted avg': {'precision': 0.5893933827985592, 'recall': 0.3485673948217237, 'f1-score': 0.37216362423300625, 'support': 286157}}
[[ 32201   6440   1118]
 [132583  57617  14637]
 [ 14552  17082   9927]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88063717
{'0': {'precision': 0.293203714955299, 'recall': 0.4958653422713706, 'f1-score': 0.3685090909090909, 'support': 20437}, '1': {'precision': 0.7273793307669529, 'recall': 0.6914804972524998, 'f1-score': 0.7089757725144746, 'support': 88808}, '2': {'precision': 0.3888943200703881, 'recall': 0.19917885039054675, 'f1-score': 0.2634349855965034, 'support': 19972}, 'accuracy': 0.5844509623346773, 'macro avg': {'precision': 0.4698257885975467, 'recall': 0.4621748966381391, 'f1-score': 0.4469732830066897, 'support': 129217}, 'weighted avg': {'precision': 0.6063931625849447, 'recall': 0.5844509623346773, 'f1-score': 0.5862639144130255, 'support': 129217}}
[[10134  9815   488]
 [21636 61409  5763]
 [ 2793 13201  3978]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89801514
{'0': {'precision': 0.2616033755274262, 'recall': 0.5155579399141631, 'f1-score': 0.3470880361173815, 'support': 7456}, '1': {'precision': 0.7197096785237427, 'recall': 0.6406411897360883, 'f1-score': 0.6778775615497477, 'support': 32814}, '2': {'precision': 0.4542199488491049, 'recall': 0.23545008617261037, 'f1-score': 0.3101370819872522, 'support': 7543}, 'accuracy': 0.5572124735950473, 'macro avg': {'precision': 0.4785110009667579, 'recall': 0.4638830719409539, 'f1-score': 0.4450342265514604, 'support': 47813}, 'weighted avg': {'precision': 0.6063884138870053, 'recall': 0.5572124735950473, 'f1-score': 0.5682790603269918, 'support': 47813}}
[[ 3844  3418   194]
 [ 9852 21022  1940]
 [  998  4769  1776]]
training model: results/QRTEA/W9/deepLOB_L2/h100
Epoch 1/50
505/505 - 23s - loss: 3.2420 - accuracy100: 0.3972 - val_loss: 3.5162 - val_accuracy100: 0.5267 - 23s/epoch - 46ms/step
Epoch 2/50
505/505 - 21s - loss: 3.1189 - accuracy100: 0.4201 - val_loss: 3.3626 - val_accuracy100: 0.5001 - 21s/epoch - 42ms/step
Epoch 3/50
505/505 - 21s - loss: 3.0268 - accuracy100: 0.4593 - val_loss: 3.3283 - val_accuracy100: 0.5075 - 21s/epoch - 41ms/step
Epoch 4/50
505/505 - 21s - loss: 2.9819 - accuracy100: 0.4862 - val_loss: 3.3869 - val_accuracy100: 0.5120 - 21s/epoch - 41ms/step
Epoch 5/50
505/505 - 21s - loss: 2.9343 - accuracy100: 0.5021 - val_loss: 3.3846 - val_accuracy100: 0.5230 - 21s/epoch - 41ms/step
Epoch 6/50
505/505 - 21s - loss: 2.9033 - accuracy100: 0.5133 - val_loss: 3.3779 - val_accuracy100: 0.5170 - 21s/epoch - 42ms/step
Epoch 7/50
505/505 - 21s - loss: 2.8613 - accuracy100: 0.5198 - val_loss: 3.4475 - val_accuracy100: 0.5191 - 21s/epoch - 41ms/step
Epoch 8/50
505/505 - 21s - loss: 2.8334 - accuracy100: 0.5248 - val_loss: 3.4314 - val_accuracy100: 0.5133 - 21s/epoch - 42ms/step
Epoch 9/50
505/505 - 21s - loss: 2.8015 - accuracy100: 0.5342 - val_loss: 3.5578 - val_accuracy100: 0.5081 - 21s/epoch - 42ms/step
Epoch 10/50
505/505 - 21s - loss: 2.7615 - accuracy100: 0.5436 - val_loss: 3.6860 - val_accuracy100: 0.5053 - 21s/epoch - 42ms/step
Epoch 11/50
505/505 - 21s - loss: 2.7402 - accuracy100: 0.5478 - val_loss: 3.6682 - val_accuracy100: 0.5012 - 21s/epoch - 42ms/step
Epoch 12/50
505/505 - 21s - loss: 2.7014 - accuracy100: 0.5552 - val_loss: 3.7403 - val_accuracy100: 0.4956 - 21s/epoch - 41ms/step
Epoch 13/50
505/505 - 21s - loss: 2.6794 - accuracy100: 0.5581 - val_loss: 3.8333 - val_accuracy100: 0.5027 - 21s/epoch - 41ms/step
testing model: results/QRTEA/W9/deepLOB_L2/h100
Evaluating performance on  test set...
1118/1118 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9582466
{'0': {'precision': 0.3280779125321573, 'recall': 0.14905162626060242, 'f1-score': 0.2049780716860692, 'support': 59892}, '1': {'precision': 0.5844155310102065, 'recall': 0.8680119955780049, 'f1-score': 0.6985266831324265, 'support': 163727}, '2': {'precision': 0.5052317838797641, 'recall': 0.12739454411717677, 'f1-score': 0.2034811702657489, 'support': 62538}, 'accuracy': 0.5556774777482291, 'macro avg': {'precision': 0.4725750758073759, 'recall': 0.38148605531859464, 'f1-score': 0.36899530836141486, 'support': 286157}, 'weighted avg': {'precision': 0.5134594970011453, 'recall': 0.5556774777482291, 'f1-score': 0.4870386897567568, 'support': 286157}}
[[  8927  49466   1499]
 [ 15307 142117   6303]
 [  2976  51595   7967]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9570989
{'0': {'precision': 0.3885661166627934, 'recall': 0.22776188530173, 'f1-score': 0.2871865338371693, 'support': 29364}, '1': {'precision': 0.5793370565624358, 'recall': 0.8262124952922961, 'f1-score': 0.6810937607800751, 'support': 71691}, '2': {'precision': 0.44264645637034, 'recall': 0.15346921383424472, 'f1-score': 0.22791752359858675, 'support': 28162}, 'accuracy': 0.5435972047021677, 'macro avg': {'precision': 0.47018320986518974, 'recall': 0.4024811981427569, 'f1-score': 0.3987326060719438, 'support': 129217}, 'weighted avg': {'precision': 0.5061943697501518, 'recall': 0.5435972047021677, 'f1-score': 0.49281326360511696, 'support': 129217}}
[[ 6688 21587  1089]
 [ 8106 59232  4353]
 [ 2418 21422  4322]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98392665
{'0': {'precision': 0.3230611674890606, 'recall': 0.32219127205199627, 'f1-score': 0.32262563339686673, 'support': 10770}, '1': {'precision': 0.5708334591119026, 'recall': 0.7179195140470767, 'f1-score': 0.6359829821581717, 'support': 26340}, '2': {'precision': 0.49632446134347274, 'recall': 0.1829393627954779, 'f1-score': 0.2673402512288367, 'support': 10703}, 'accuracy': 0.5090247422249179, 'macro avg': {'precision': 0.46340636264814533, 'recall': 0.40768338296485024, 'f1-score': 0.4086496222612917, 'support': 47813}, 'weighted avg': {'precision': 0.49834318692874086, 'recall': 0.5090247422249179, 'f1-score': 0.4828773038845657, 'support': 47813}}
[[ 3470  6701   599]
 [ 6042 18910  1388]
 [ 1229  7516  1958]]
training model: results/QRTEA/W9/deepLOB_L2/h200
Epoch 1/50
505/505 - 24s - loss: 3.2949 - accuracy200: 0.3863 - val_loss: 3.6249 - val_accuracy200: 0.4194 - 24s/epoch - 47ms/step
Epoch 2/50
505/505 - 21s - loss: 3.2333 - accuracy200: 0.3958 - val_loss: 3.5955 - val_accuracy200: 0.4226 - 21s/epoch - 42ms/step
Epoch 3/50
505/505 - 21s - loss: 3.1834 - accuracy200: 0.4132 - val_loss: 3.6014 - val_accuracy200: 0.4239 - 21s/epoch - 41ms/step
Epoch 4/50
505/505 - 21s - loss: 3.1470 - accuracy200: 0.4399 - val_loss: 3.4817 - val_accuracy200: 0.4320 - 21s/epoch - 42ms/step
Epoch 5/50
505/505 - 21s - loss: 3.1076 - accuracy200: 0.4581 - val_loss: 3.4782 - val_accuracy200: 0.4280 - 21s/epoch - 42ms/step
Epoch 6/50
505/505 - 21s - loss: 3.0768 - accuracy200: 0.4693 - val_loss: 3.4131 - val_accuracy200: 0.4343 - 21s/epoch - 42ms/step
Epoch 7/50
505/505 - 21s - loss: 3.0259 - accuracy200: 0.4889 - val_loss: 3.3381 - val_accuracy200: 0.4360 - 21s/epoch - 41ms/step
Epoch 8/50
505/505 - 21s - loss: 2.9796 - accuracy200: 0.5042 - val_loss: 3.3916 - val_accuracy200: 0.4331 - 21s/epoch - 41ms/step
Epoch 9/50
505/505 - 21s - loss: 2.9455 - accuracy200: 0.5114 - val_loss: 3.4113 - val_accuracy200: 0.4361 - 21s/epoch - 41ms/step
Epoch 10/50
505/505 - 21s - loss: 2.9084 - accuracy200: 0.5206 - val_loss: 3.3418 - val_accuracy200: 0.4379 - 21s/epoch - 41ms/step
Epoch 11/50
505/505 - 21s - loss: 2.8671 - accuracy200: 0.5328 - val_loss: 3.5438 - val_accuracy200: 0.4212 - 21s/epoch - 41ms/step
Epoch 12/50
505/505 - 21s - loss: 2.8379 - accuracy200: 0.5377 - val_loss: 3.5344 - val_accuracy200: 0.4237 - 21s/epoch - 41ms/step
Epoch 13/50
505/505 - 21s - loss: 2.8065 - accuracy200: 0.5438 - val_loss: 3.5656 - val_accuracy200: 0.4287 - 21s/epoch - 41ms/step
Epoch 14/50
505/505 - 21s - loss: 2.7737 - accuracy200: 0.5508 - val_loss: 3.6786 - val_accuracy200: 0.4210 - 21s/epoch - 41ms/step
Epoch 15/50
505/505 - 21s - loss: 2.7300 - accuracy200: 0.5612 - val_loss: 3.7448 - val_accuracy200: 0.4268 - 21s/epoch - 41ms/step
Epoch 16/50
505/505 - 21s - loss: 2.6917 - accuracy200: 0.5674 - val_loss: 3.7431 - val_accuracy200: 0.4234 - 21s/epoch - 42ms/step
Epoch 17/50
505/505 - 21s - loss: 2.6537 - accuracy200: 0.5751 - val_loss: 3.9100 - val_accuracy200: 0.4133 - 21s/epoch - 42ms/step
testing model: results/QRTEA/W9/deepLOB_L2/h200
Evaluating performance on  test set...
1118/1118 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0815203
{'0': {'precision': 0.3403361344537815, 'recall': 0.18550090333087355, 'f1-score': 0.24012253166224737, 'support': 78598}, '1': {'precision': 0.4535456804203495, 'recall': 0.527479294799422, 'f1-score': 0.4877265344113299, 'support': 126659}, '2': {'precision': 0.37144702169543076, 'recall': 0.44082818294190357, 'f1-score': 0.40317447756216407, 'support': 80900}, 'accuracy': 0.40905167443046997, 'macro avg': {'precision': 0.38844294552318726, 'recall': 0.384602793690733, 'f1-score': 0.3770078478785804, 'support': 286157}, 'weighted avg': {'precision': 0.3992404375476389, 'recall': 0.40905167443046997, 'f1-score': 0.39581391019745465, 'support': 286157}}
[[14580 42189 21829]
 [21330 66810 38519]
 [ 6930 38307 35663]]
Evaluating performance on  train set...
505/505 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.054751
{'0': {'precision': 0.43775933609958506, 'recall': 0.1305491105955143, 'f1-score': 0.2011199809364947, 'support': 38790}, '1': {'precision': 0.4575651138200513, 'recall': 0.6928484670028341, 'f1-score': 0.5511466362165762, 'support': 54338}, '2': {'precision': 0.3817076618603336, 'recall': 0.3741029122447283, 'f1-score': 0.3778670286457969, 'support': 36089}, 'accuracy': 0.43502789880588466, 'macro avg': {'precision': 0.4256773705933233, 'recall': 0.39916682994769226, 'f1-score': 0.3767112152662893, 'support': 129217}, 'weighted avg': {'precision': 0.4304333455422617, 'recall': 0.43502789880588466, 'f1-score': 0.3976759495736715, 'support': 129217}}
[[ 5064 24081  9645]
 [ 4466 37648 12224]
 [ 2038 20550 13501]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0652719
{'0': {'precision': 0.3707426856714179, 'recall': 0.17550962426308686, 'f1-score': 0.23823756266872353, 'support': 14079}, '1': {'precision': 0.44074217701279716, 'recall': 0.7327778604374349, 'f1-score': 0.5504228290429534, 'support': 20163}, '2': {'precision': 0.4616393442622951, 'recall': 0.25937661189300715, 'f1-score': 0.33213813927156066, 'support': 13571}, 'accuracy': 0.4343170267500471, 'macro avg': {'precision': 0.4243747356488367, 'recall': 0.3892213655311763, 'f1-score': 0.37359951032774585, 'support': 47813}, 'weighted avg': {'precision': 0.42606149640600943, 'recall': 0.4343170267500471, 'f1-score': 0.3965400379574672, 'support': 47813}}
[[ 2471  9795  1813]
 [ 3096 14775  2292]
 [ 1098  8953  3520]]
training model: results/QRTEA/W9/deepLOB_L2/h300
Epoch 1/50
505/505 - 23s - loss: 3.2936 - accuracy300: 0.3917 - val_loss: 3.5198 - val_accuracy300: 0.3655 - 23s/epoch - 46ms/step
Epoch 2/50
505/505 - 21s - loss: 3.2477 - accuracy300: 0.4017 - val_loss: 3.4875 - val_accuracy300: 0.3694 - 21s/epoch - 42ms/step
Epoch 3/50
505/505 - 21s - loss: 3.2247 - accuracy300: 0.4074 - val_loss: 3.4946 - val_accuracy300: 0.3716 - 21s/epoch - 41ms/step
Epoch 4/50
505/505 - 21s - loss: 3.1834 - accuracy300: 0.4292 - val_loss: 3.4552 - val_accuracy300: 0.3849 - 21s/epoch - 42ms/step
Epoch 5/50
505/505 - 21s - loss: 3.1495 - accuracy300: 0.4466 - val_loss: 3.5165 - val_accuracy300: 0.3856 - 21s/epoch - 41ms/step
Epoch 6/50
505/505 - 21s - loss: 3.1157 - accuracy300: 0.4597 - val_loss: 3.4348 - val_accuracy300: 0.3911 - 21s/epoch - 41ms/step
Epoch 7/50
505/505 - 21s - loss: 3.0937 - accuracy300: 0.4668 - val_loss: 3.4618 - val_accuracy300: 0.3831 - 21s/epoch - 41ms/step
Epoch 8/50
505/505 - 21s - loss: 3.0496 - accuracy300: 0.4831 - val_loss: 3.5048 - val_accuracy300: 0.3996 - 21s/epoch - 42ms/step
Epoch 9/50
505/505 - 21s - loss: 2.9951 - accuracy300: 0.4995 - val_loss: 3.5400 - val_accuracy300: 0.3847 - 21s/epoch - 42ms/step
Epoch 10/50
505/505 - 21s - loss: 2.9531 - accuracy300: 0.5133 - val_loss: 3.5234 - val_accuracy300: 0.3832 - 21s/epoch - 42ms/step
Epoch 11/50
505/505 - 21s - loss: 2.9049 - accuracy300: 0.5252 - val_loss: 3.6328 - val_accuracy300: 0.3808 - 21s/epoch - 41ms/step
Epoch 12/50
505/505 - 21s - loss: 2.8588 - accuracy300: 0.5377 - val_loss: 3.6984 - val_accuracy300: 0.3704 - 21s/epoch - 41ms/step
Epoch 13/50
505/505 - 21s - loss: 2.8168 - accuracy300: 0.5466 - val_loss: 3.8099 - val_accuracy300: 0.3681 - 21s/epoch - 41ms/step
Epoch 14/50
505/505 - 21s - loss: 2.7787 - accuracy300: 0.5570 - val_loss: 3.9402 - val_accuracy300: 0.3601 - 21s/epoch - 41ms/step
Epoch 15/50
505/505 - 21s - loss: 2.7229 - accuracy300: 0.5694 - val_loss: 3.9582 - val_accuracy300: 0.3672 - 21s/epoch - 42ms/step
Epoch 16/50
505/505 - 21s - loss: 2.6799 - accuracy300: 0.5764 - val_loss: 4.1243 - val_accuracy300: 0.3661 - 21s/epoch - 42ms/step
testing model: results/QRTEA/W9/deepLOB_L2/h300
Evaluating performance on  test set...
1118/1118 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1464344
{'0': {'precision': 0.3129271569601028, 'recall': 0.308792843061528, 'f1-score': 0.310846253829728, 'support': 86741}, '1': {'precision': 0.37049737458475573, 'recall': 0.43620568462411907, 'f1-score': 0.40067546313924796, 'support': 110966}, '2': {'precision': 0.30216259511413696, 'recall': 0.23884680610514414, 'f1-score': 0.26679969185304925, 'support': 88450}, 'accuracy': 0.33658096779040875, 'macro avg': {'precision': 0.32852904221966517, 'recall': 0.32794844459693034, 'f1-score': 0.32610713627400845, 'support': 286157}, 'weighted avg': {'precision': 0.33192446009670806, 'recall': 0.33658096779040875, 'f1-score': 0.33206561814163704, 'support': 286157}}
[[26785 38413 21543]
 [35315 48404 27247]
 [23495 43829 21126]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1167332
{'0': {'precision': 0.380312640463467, 'recall': 0.1761467465476163, 'f1-score': 0.24077528693837547, 'support': 43231}, '1': {'precision': 0.38722226199852033, 'recall': 0.6922666666666667, 'f1-score': 0.4966443980195444, 'support': 46875}, '2': {'precision': 0.4018982356647763, 'recall': 0.2609240367160134, 'f1-score': 0.3164193913461389, 'support': 39111}, 'accuracy': 0.3890354984251298, 'macro avg': {'precision': 0.3898110460422545, 'recall': 0.37644581664343213, 'f1-score': 0.35127969210135296, 'support': 129217}, 'weighted avg': {'precision': 0.3893526485380549, 'recall': 0.3890354984251298, 'f1-score': 0.3564905654963193, 'support': 129217}}
[[ 7615 27851  7765]
 [ 7003 32450  7422]
 [ 5405 23501 10205]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1250763
{'0': {'precision': 0.3792832853779754, 'recall': 0.18719339013684483, 'f1-score': 0.2506698936813899, 'support': 15492}, '1': {'precision': 0.38586683231283464, 'recall': 0.7520899394638224, 'f1-score': 0.5100484829527683, 'support': 17345}, '2': {'precision': 0.43144654088050316, 'recall': 0.18322649572649571, 'f1-score': 0.25721784776902884, 'support': 14976}, 'accuracy': 0.3908769581494573, 'macro avg': {'precision': 0.39886555285710434, 'recall': 0.374169941775721, 'f1-score': 0.33931207480106235, 'support': 47813}, 'weighted avg': {'precision': 0.398010170032588, 'recall': 0.3908769581494573, 'f1-score': 0.3468149544667106, 'support': 47813}}
[[ 2900 10858  1734]
 [ 2418 13045  1882]
 [ 2328  9904  2744]]
training model: results/QRTEA/W9/deepLOB_L2/h500
Epoch 1/50
505/505 - 23s - loss: 3.3012 - accuracy500: 0.3853 - val_loss: 3.4733 - val_accuracy500: 0.3333 - 23s/epoch - 46ms/step
Epoch 2/50
505/505 - 21s - loss: 3.2766 - accuracy500: 0.3905 - val_loss: 3.4675 - val_accuracy500: 0.3202 - 21s/epoch - 42ms/step
Epoch 3/50
505/505 - 21s - loss: 3.2350 - accuracy500: 0.4094 - val_loss: 3.3676 - val_accuracy500: 0.3457 - 21s/epoch - 42ms/step
Epoch 4/50
505/505 - 21s - loss: 3.1860 - accuracy500: 0.4360 - val_loss: 3.3864 - val_accuracy500: 0.3281 - 21s/epoch - 41ms/step
Epoch 5/50
505/505 - 21s - loss: 3.1432 - accuracy500: 0.4538 - val_loss: 3.3986 - val_accuracy500: 0.3379 - 21s/epoch - 41ms/step
Epoch 6/50
505/505 - 21s - loss: 3.1212 - accuracy500: 0.4642 - val_loss: 3.3684 - val_accuracy500: 0.3547 - 21s/epoch - 41ms/step
Epoch 7/50
505/505 - 21s - loss: 3.0778 - accuracy500: 0.4799 - val_loss: 3.3996 - val_accuracy500: 0.3604 - 21s/epoch - 42ms/step
Epoch 8/50
505/505 - 21s - loss: 3.0293 - accuracy500: 0.4939 - val_loss: 3.4662 - val_accuracy500: 0.3469 - 21s/epoch - 41ms/step
Epoch 9/50
505/505 - 21s - loss: 3.0052 - accuracy500: 0.5006 - val_loss: 3.4966 - val_accuracy500: 0.3402 - 21s/epoch - 41ms/step
Epoch 10/50
505/505 - 21s - loss: 2.9626 - accuracy500: 0.5168 - val_loss: 3.5704 - val_accuracy500: 0.3545 - 21s/epoch - 41ms/step
Epoch 11/50
505/505 - 21s - loss: 2.9106 - accuracy500: 0.5298 - val_loss: 3.6397 - val_accuracy500: 0.3728 - 21s/epoch - 42ms/step
Epoch 12/50
505/505 - 21s - loss: 2.8760 - accuracy500: 0.5391 - val_loss: 3.6942 - val_accuracy500: 0.3798 - 21s/epoch - 42ms/step
Epoch 13/50
505/505 - 21s - loss: 2.8191 - accuracy500: 0.5531 - val_loss: 3.7333 - val_accuracy500: 0.3843 - 21s/epoch - 42ms/step
testing model: results/QRTEA/W9/deepLOB_L2/h500
Evaluating performance on  test set...
1118/1118 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1309812
{'0': {'precision': 0.31670223502854455, 'recall': 0.4576240996582319, 'f1-score': 0.374339780716133, 'support': 89827}, '1': {'precision': 0.3450728781644466, 'recall': 0.4946071032297404, 'f1-score': 0.4065251058830295, 'support': 100039}, '2': {'precision': 0.3451811873554356, 'recall': 0.046494480273338114, 'f1-score': 0.08195055875380969, 'support': 96291}, 'accuracy': 0.3322092417798621, 'macro avg': {'precision': 0.33565210018280894, 'recall': 0.33290856105377015, 'f1-score': 0.2876051484509907, 'support': 286157}, 'weighted avg': {'precision': 0.33620354922732765, 'recall': 0.3322092417798621, 'f1-score': 0.287203478519776, 'support': 286157}}
[[41107 44603  4117]
 [46183 49480  4376]
 [42507 49307  4477]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1236794
{'0': {'precision': 0.37151898734177213, 'recall': 0.16295109972240018, 'f1-score': 0.22654000296868043, 'support': 46830}, '1': {'precision': 0.34116553992102594, 'recall': 0.684733536166454, 'f1-score': 0.45542001550324346, 'support': 40756}, '2': {'precision': 0.3583227918743954, 'recall': 0.2313420287766328, 'f1-score': 0.2811601395437096, 'support': 41631}, 'accuracy': 0.34955926851730035, 'macro avg': {'precision': 0.3570024397123978, 'recall': 0.3596755548884956, 'f1-score': 0.3210400526718778, 'support': 129217}, 'weighted avg': {'precision': 0.35769374827429423, 'recall': 0.34955926851730035, 'f1-score': 0.316327915523636, 'support': 129217}}
[[ 7631 29070 10129]
 [ 5731 27907  7118]
 [ 7178 24822  9631]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.126674
{'0': {'precision': 0.39475600873998545, 'recall': 0.1643420254699818, 'f1-score': 0.23207022050952686, 'support': 16490}, '1': {'precision': 0.3264522481128979, 'recall': 0.6567844172994387, 'f1-score': 0.43612846651320836, 'support': 15145}, '2': {'precision': 0.36762740981103265, 'recall': 0.2381011249845469, 'f1-score': 0.289015606242497, 'support': 16178}, 'accuracy': 0.3452826637107063, 'macro avg': {'precision': 0.3629452222213054, 'recall': 0.3530758559179891, 'f1-score': 0.31907143108841074, 'support': 47813}, 'weighted avg': {'precision': 0.3639412318347539, 'recall': 0.3452826637107063, 'f1-score': 0.3159746938978051, 'support': 47813}}
[[ 2710 10433  3347]
 [ 1919  9947  3279]
 [ 2236 10090  3852]]
training model: results/QRTEA/W9/deepLOB_L2/h1000
Epoch 1/50
505/505 - 24s - loss: 3.2672 - accuracy1000: 0.4100 - val_loss: 3.3480 - val_accuracy1000: 0.3580 - 24s/epoch - 47ms/step
Epoch 2/50
505/505 - 21s - loss: 3.2314 - accuracy1000: 0.4228 - val_loss: 3.3575 - val_accuracy1000: 0.3594 - 21s/epoch - 41ms/step
Epoch 3/50
505/505 - 21s - loss: 3.2256 - accuracy1000: 0.4168 - val_loss: 3.4060 - val_accuracy1000: 0.3653 - 21s/epoch - 41ms/step
Epoch 4/50
505/505 - 21s - loss: 3.2080 - accuracy1000: 0.4276 - val_loss: 3.3721 - val_accuracy1000: 0.3498 - 21s/epoch - 42ms/step
Epoch 5/50
505/505 - 21s - loss: 3.1842 - accuracy1000: 0.4487 - val_loss: 3.4727 - val_accuracy1000: 0.3250 - 21s/epoch - 42ms/step
Epoch 6/50
505/505 - 21s - loss: 3.1260 - accuracy1000: 0.4686 - val_loss: 3.5383 - val_accuracy1000: 0.3407 - 21s/epoch - 42ms/step
Epoch 7/50
505/505 - 21s - loss: 3.0874 - accuracy1000: 0.4812 - val_loss: 3.5465 - val_accuracy1000: 0.3496 - 21s/epoch - 42ms/step
Epoch 8/50
505/505 - 21s - loss: 3.0548 - accuracy1000: 0.4909 - val_loss: 3.5855 - val_accuracy1000: 0.3488 - 21s/epoch - 42ms/step
Epoch 9/50
505/505 - 21s - loss: 3.0145 - accuracy1000: 0.5049 - val_loss: 3.6424 - val_accuracy1000: 0.3583 - 21s/epoch - 42ms/step
Epoch 10/50
505/505 - 21s - loss: 2.9627 - accuracy1000: 0.5165 - val_loss: 3.6495 - val_accuracy1000: 0.3734 - 21s/epoch - 41ms/step
Epoch 11/50
505/505 - 21s - loss: 2.9308 - accuracy1000: 0.5262 - val_loss: 3.7263 - val_accuracy1000: 0.3497 - 21s/epoch - 42ms/step
testing model: results/QRTEA/W9/deepLOB_L2/h1000
Evaluating performance on  test set...
1118/1118 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.13735
{'0': {'precision': 0.3298762484411141, 'recall': 0.33847735500311704, 'f1-score': 0.33412145748987854, 'support': 91433}, '1': {'precision': 0.33082287929766707, 'recall': 0.3121872240211952, 'f1-score': 0.32123500329954463, 'support': 95116}, '2': {'precision': 0.3561541011093564, 'recall': 0.366787808208176, 'f1-score': 0.36139274939413424, 'support': 99608}, 'accuracy': 0.33959330018136896, 'macro avg': {'precision': 0.33895107628271254, 'recall': 0.3391507957441628, 'f1-score': 0.3389164033945191, 'support': 286157}, 'weighted avg': {'precision': 0.33933792189006057, 'recall': 0.33959330018136896, 'f1-score': 0.3393309434267289, 'support': 286157}}
[[30948 28544 31941]
 [31316 29694 34106]
 [31553 31520 36535]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1324158
{'0': {'precision': 0.35051670997763945, 'recall': 0.25149051490514907, 'f1-score': 0.2928590363422916, 'support': 46125}, '1': {'precision': 0.3855303402182532, 'recall': 0.24070537756088362, 'f1-score': 0.2963715529753265, 'support': 42417}, '2': {'precision': 0.3319213095921884, 'recall': 0.5682851874615857, 'f1-score': 0.4190726555772107, 'support': 40675}, 'accuracy': 0.3476709720857163, 'macro avg': {'precision': 0.3559894532626937, 'recall': 0.35349369330920616, 'f1-score': 0.3361010816316096, 'support': 129217}, 'weighted avg': {'precision': 0.3561568753060242, 'recall': 0.3476709720857163, 'f1-score': 0.3337416553506556, 'support': 129217}}
[[11600  8380 26145]
 [11827 10210 20380]
 [ 9667  7893 23115]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1138978
{'0': {'precision': 0.3534730282851732, 'recall': 0.35256839924440925, 'f1-score': 0.3530201342281879, 'support': 16411}, '1': {'precision': 0.3524317121918721, 'recall': 0.270432615502588, 'f1-score': 0.30603463860867053, 'support': 15649}, '2': {'precision': 0.3674109899156205, 'recall': 0.45331048054338857, 'f1-score': 0.40586546932279977, 'support': 15753}, 'accuracy': 0.3588772927864807, 'macro avg': {'precision': 0.35777191013088866, 'recall': 0.3587704984301286, 'f1-score': 0.3549734140532194, 'support': 47813}, 'weighted avg': {'precision': 0.35772436482587067, 'recall': 0.3588772927864807, 'f1-score': 0.35505298183857825, 'support': 47813}}
[[5786 4220 6405]
 [5527 4232 5890]
 [5056 3556 7141]]
training model: results/QRTEA/W9/deepOF_L2/h10
Epoch 1/50
505/505 - 14s - loss: 2.8511 - accuracy10: 0.5141 - val_loss: 2.6653 - val_accuracy10: 0.7279 - 14s/epoch - 27ms/step
Epoch 2/50
505/505 - 12s - loss: 2.5210 - accuracy10: 0.6136 - val_loss: 2.5080 - val_accuracy10: 0.7675 - 12s/epoch - 23ms/step
Epoch 3/50
505/505 - 12s - loss: 2.3587 - accuracy10: 0.6516 - val_loss: 2.4431 - val_accuracy10: 0.8003 - 12s/epoch - 23ms/step
Epoch 4/50
505/505 - 12s - loss: 2.2573 - accuracy10: 0.6763 - val_loss: 2.3812 - val_accuracy10: 0.8114 - 12s/epoch - 23ms/step
Epoch 5/50
505/505 - 12s - loss: 2.2040 - accuracy10: 0.6854 - val_loss: 2.3283 - val_accuracy10: 0.7944 - 12s/epoch - 23ms/step
Epoch 6/50
505/505 - 12s - loss: 2.1507 - accuracy10: 0.6948 - val_loss: 2.3321 - val_accuracy10: 0.7926 - 12s/epoch - 23ms/step
Epoch 7/50
505/505 - 12s - loss: 2.1062 - accuracy10: 0.7007 - val_loss: 2.3520 - val_accuracy10: 0.7945 - 12s/epoch - 23ms/step
Epoch 8/50
505/505 - 12s - loss: 2.0751 - accuracy10: 0.7021 - val_loss: 2.3415 - val_accuracy10: 0.8024 - 12s/epoch - 23ms/step
Epoch 9/50
505/505 - 12s - loss: 2.0437 - accuracy10: 0.7035 - val_loss: 2.3760 - val_accuracy10: 0.8026 - 12s/epoch - 23ms/step
Epoch 10/50
505/505 - 12s - loss: 2.0281 - accuracy10: 0.7021 - val_loss: 2.3383 - val_accuracy10: 0.7925 - 12s/epoch - 23ms/step
Epoch 11/50
505/505 - 12s - loss: 1.9953 - accuracy10: 0.7090 - val_loss: 2.4369 - val_accuracy10: 0.7992 - 12s/epoch - 23ms/step
Epoch 12/50
505/505 - 12s - loss: 1.9790 - accuracy10: 0.7081 - val_loss: 2.3743 - val_accuracy10: 0.8026 - 12s/epoch - 23ms/step
Epoch 13/50
505/505 - 12s - loss: 1.9605 - accuracy10: 0.7066 - val_loss: 2.3528 - val_accuracy10: 0.7969 - 12s/epoch - 23ms/step
Epoch 14/50
505/505 - 12s - loss: 1.9352 - accuracy10: 0.7090 - val_loss: 2.3930 - val_accuracy10: 0.8132 - 12s/epoch - 23ms/step
Epoch 15/50
505/505 - 12s - loss: 1.9220 - accuracy10: 0.7093 - val_loss: 2.3516 - val_accuracy10: 0.8092 - 12s/epoch - 23ms/step
testing model: results/QRTEA/W9/deepOF_L2/h10
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53829163
{'0': {'precision': 0.23716234652114598, 'recall': 0.4927996371470688, 'f1-score': 0.32021809608016505, 'support': 17638}, '1': {'precision': 0.9440671721559406, 'recall': 0.8293813485498733, 'f1-score': 0.8830159942311007, 'support': 250254}, '2': {'precision': 0.35376053962900506, 'recall': 0.5743935162367888, 'f1-score': 0.43785352006846023, 'support': 18261}, 'accuracy': 0.7923628268793268, 'macro avg': {'precision': 0.5116633527686972, 'recall': 0.632191500644577, 'f1-score': 0.5470292034599087, 'support': 286153}, 'weighted avg': {'precision': 0.8628240024840487, 'recall': 0.7923628268793268, 'f1-score': 0.8199177870892214, 'support': 286153}}
[[  8692   6263   2683]
 [ 26220 207556  16478]
 [  1738   6034  10489]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5190865
{'0': {'precision': 0.3166948674562888, 'recall': 0.4829588216320826, 'f1-score': 0.3825420481158186, 'support': 9301}, '1': {'precision': 0.937578151360578, 'recall': 0.8534263156943868, 'f1-score': 0.8935252615052869, 'support': 110702}, '2': {'precision': 0.3716969229690895, 'recall': 0.575537225960495, 'f1-score': 0.4516843405306418, 'support': 9214}, 'accuracy': 0.8069449066299326, 'macro avg': {'precision': 0.5419899805953188, 'recall': 0.6373074544289881, 'f1-score': 0.5759172167172492, 'support': 129217}, 'weighted avg': {'precision': 0.852536205935495, 'recall': 0.8069449066299326, 'f1-score': 0.8252387580762037, 'support': 129217}}
[[ 4492  3183  1626]
 [ 8888 94476  7338]
 [  804  3107  5303]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.54035354
{'0': {'precision': 0.29959169785641376, 'recall': 0.5250447227191414, 'f1-score': 0.3814991334488735, 'support': 3354}, '1': {'precision': 0.9426254462926573, 'recall': 0.8318190699491989, 'f1-score': 0.8837625689263704, 'support': 40944}, '2': {'precision': 0.37366425370561873, 'recall': 0.6171363506974096, 'f1-score': 0.46548577563070315, 'support': 3513}, 'accuracy': 0.7945242726569199, 'macro avg': {'precision': 0.5386271326182299, 'recall': 0.6580000477885832, 'f1-score': 0.5769158260019823, 'support': 47811}, 'weighted avg': {'precision': 0.8557103877953778, 'recall': 0.7945242726569199, 'f1-score': 0.8177945294074479, 'support': 47811}}
[[ 1761  1134   459]
 [ 3711 34058  3175]
 [  406   939  2168]]
training model: results/QRTEA/W9/deepOF_L2/h20
Epoch 1/50
505/505 - 14s - loss: 2.8746 - accuracy20: 0.4883 - val_loss: 2.7340 - val_accuracy20: 0.7132 - 14s/epoch - 28ms/step
Epoch 2/50
505/505 - 12s - loss: 2.5735 - accuracy20: 0.5857 - val_loss: 2.6055 - val_accuracy20: 0.7572 - 12s/epoch - 24ms/step
Epoch 3/50
505/505 - 12s - loss: 2.4298 - accuracy20: 0.6217 - val_loss: 2.5284 - val_accuracy20: 0.7755 - 12s/epoch - 24ms/step
Epoch 4/50
505/505 - 12s - loss: 2.3317 - accuracy20: 0.6403 - val_loss: 2.4797 - val_accuracy20: 0.7926 - 12s/epoch - 24ms/step
Epoch 5/50
505/505 - 12s - loss: 2.2705 - accuracy20: 0.6528 - val_loss: 2.4853 - val_accuracy20: 0.7967 - 12s/epoch - 23ms/step
Epoch 6/50
505/505 - 12s - loss: 2.2262 - accuracy20: 0.6646 - val_loss: 2.4629 - val_accuracy20: 0.7970 - 12s/epoch - 23ms/step
Epoch 7/50
505/505 - 12s - loss: 2.1892 - accuracy20: 0.6676 - val_loss: 2.4800 - val_accuracy20: 0.8049 - 12s/epoch - 23ms/step
Epoch 8/50
505/505 - 12s - loss: 2.1558 - accuracy20: 0.6707 - val_loss: 2.4907 - val_accuracy20: 0.7967 - 12s/epoch - 23ms/step
Epoch 9/50
505/505 - 12s - loss: 2.1267 - accuracy20: 0.6756 - val_loss: 2.4867 - val_accuracy20: 0.8018 - 12s/epoch - 23ms/step
Epoch 10/50
505/505 - 12s - loss: 2.0965 - accuracy20: 0.6785 - val_loss: 2.4970 - val_accuracy20: 0.8035 - 12s/epoch - 23ms/step
Epoch 11/50
505/505 - 12s - loss: 2.0735 - accuracy20: 0.6835 - val_loss: 2.5047 - val_accuracy20: 0.8052 - 12s/epoch - 23ms/step
Epoch 12/50
505/505 - 12s - loss: 2.0582 - accuracy20: 0.6826 - val_loss: 2.5056 - val_accuracy20: 0.8110 - 12s/epoch - 23ms/step
Epoch 13/50
505/505 - 12s - loss: 2.0258 - accuracy20: 0.6834 - val_loss: 2.4690 - val_accuracy20: 0.8041 - 12s/epoch - 23ms/step
Epoch 14/50
505/505 - 12s - loss: 2.0089 - accuracy20: 0.6852 - val_loss: 2.4723 - val_accuracy20: 0.7969 - 12s/epoch - 23ms/step
Epoch 15/50
505/505 - 12s - loss: 1.9895 - accuracy20: 0.6858 - val_loss: 2.5349 - val_accuracy20: 0.7992 - 12s/epoch - 24ms/step
Epoch 16/50
505/505 - 12s - loss: 1.9696 - accuracy20: 0.6841 - val_loss: 2.5084 - val_accuracy20: 0.7853 - 12s/epoch - 23ms/step
testing model: results/QRTEA/W9/deepOF_L2/h20
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5414847
{'0': {'precision': 0.36109169473215985, 'recall': 0.46844730225464737, 'f1-score': 0.40782273257378665, 'support': 24261}, '1': {'precision': 0.9055103900276862, 'recall': 0.8690300178265168, 'f1-score': 0.8868952286518006, 'support': 236726}, '2': {'precision': 0.464496180429247, 'recall': 0.5073909242628943, 'f1-score': 0.4849969614099058, 'support': 25166}, 'accuracy': 0.8032625902926057, 'macro avg': {'precision': 0.5770327550630311, 'recall': 0.6149560814480194, 'f1-score': 0.5932383075451644, 'support': 286153}, 'weighted avg': {'precision': 0.820567350586132, 'recall': 0.8032625902926057, 'f1-score': 0.8109325456788518, 'support': 286153}}
[[ 11365  11030   1866]
 [ 18149 205722  12855]
 [  1960  10437  12769]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5419025
{'0': {'precision': 0.4533416420003116, 'recall': 0.45554164057608015, 'f1-score': 0.45443897868353245, 'support': 12776}, '1': {'precision': 0.8943940223769659, 'recall': 0.8809872451928634, 'f1-score': 0.8876400132005514, 'support': 103804}, '2': {'precision': 0.47201188875521904, 'recall': 0.5278151459998417, 'f1-score': 0.49835624626419606, 'support': 12637}, 'accuracy': 0.8043833241756115, 'macro avg': {'precision': 0.606582517710832, 'recall': 0.6214480105895951, 'f1-score': 0.6134784127160934, 'support': 129217}, 'weighted avg': {'precision': 0.8094785063514417, 'recall': 0.8043833241756115, 'f1-score': 0.8067376909073225, 'support': 129217}}
[[ 5820  5668  1288]
 [ 6181 91450  6173]
 [  837  5130  6670]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.55007976
{'0': {'precision': 0.41492537313432837, 'recall': 0.4788975021533161, 'f1-score': 0.4446221511395442, 'support': 4644}, '1': {'precision': 0.8997907779257126, 'recall': 0.863246526420062, 'f1-score': 0.8811399074024799, 'support': 38361}, '2': {'precision': 0.4911473087818697, 'recall': 0.5771951727007907, 'f1-score': 0.5307059498756458, 'support': 4806}, 'accuracy': 0.7971596494530547, 'macro avg': {'precision': 0.6019544866139702, 'recall': 0.6397797337580563, 'f1-score': 0.6188226694725567, 'support': 47811}, 'weighted avg': {'precision': 0.8116174401466136, 'recall': 0.7971596494530547, 'f1-score': 0.8035139623279356, 'support': 47811}}
[[ 2224  2083   337]
 [ 2709 33115  2537]
 [  427  1605  2774]]
training model: results/QRTEA/W9/deepOF_L2/h30
Epoch 1/50
505/505 - 14s - loss: 2.9237 - accuracy30: 0.4642 - val_loss: 2.8306 - val_accuracy30: 0.6974 - 14s/epoch - 27ms/step
Epoch 2/50
505/505 - 12s - loss: 2.6384 - accuracy30: 0.5551 - val_loss: 2.7374 - val_accuracy30: 0.7361 - 12s/epoch - 23ms/step
Epoch 3/50
505/505 - 12s - loss: 2.5181 - accuracy30: 0.5927 - val_loss: 2.6958 - val_accuracy30: 0.7604 - 12s/epoch - 24ms/step
Epoch 4/50
505/505 - 12s - loss: 2.4341 - accuracy30: 0.6123 - val_loss: 2.6560 - val_accuracy30: 0.7768 - 12s/epoch - 23ms/step
Epoch 5/50
505/505 - 12s - loss: 2.3774 - accuracy30: 0.6199 - val_loss: 2.6381 - val_accuracy30: 0.7890 - 12s/epoch - 23ms/step
Epoch 6/50
505/505 - 12s - loss: 2.3338 - accuracy30: 0.6323 - val_loss: 2.6468 - val_accuracy30: 0.7803 - 12s/epoch - 23ms/step
Epoch 7/50
505/505 - 12s - loss: 2.2942 - accuracy30: 0.6357 - val_loss: 2.5938 - val_accuracy30: 0.7802 - 12s/epoch - 23ms/step
Epoch 8/50
505/505 - 12s - loss: 2.2583 - accuracy30: 0.6413 - val_loss: 2.5671 - val_accuracy30: 0.7648 - 12s/epoch - 23ms/step
Epoch 9/50
505/505 - 12s - loss: 2.2357 - accuracy30: 0.6455 - val_loss: 2.5554 - val_accuracy30: 0.7693 - 12s/epoch - 23ms/step
Epoch 10/50
505/505 - 12s - loss: 2.2066 - accuracy30: 0.6484 - val_loss: 2.5647 - val_accuracy30: 0.7651 - 12s/epoch - 23ms/step
Epoch 11/50
505/505 - 12s - loss: 2.1860 - accuracy30: 0.6533 - val_loss: 2.5950 - val_accuracy30: 0.7683 - 12s/epoch - 23ms/step
Epoch 12/50
505/505 - 12s - loss: 2.1608 - accuracy30: 0.6543 - val_loss: 2.5669 - val_accuracy30: 0.7551 - 12s/epoch - 23ms/step
Epoch 13/50
505/505 - 12s - loss: 2.1416 - accuracy30: 0.6572 - val_loss: 2.6127 - val_accuracy30: 0.7481 - 12s/epoch - 23ms/step
Epoch 14/50
505/505 - 12s - loss: 2.1144 - accuracy30: 0.6597 - val_loss: 2.6756 - val_accuracy30: 0.7459 - 12s/epoch - 23ms/step
Epoch 15/50
505/505 - 12s - loss: 2.0893 - accuracy30: 0.6617 - val_loss: 2.6191 - val_accuracy30: 0.7421 - 12s/epoch - 23ms/step
Epoch 16/50
505/505 - 12s - loss: 2.0767 - accuracy30: 0.6641 - val_loss: 2.6472 - val_accuracy30: 0.7442 - 12s/epoch - 23ms/step
Epoch 17/50
505/505 - 12s - loss: 2.0528 - accuracy30: 0.6654 - val_loss: 2.6253 - val_accuracy30: 0.7239 - 12s/epoch - 23ms/step
Epoch 18/50
505/505 - 12s - loss: 2.0301 - accuracy30: 0.6641 - val_loss: 2.6500 - val_accuracy30: 0.7283 - 12s/epoch - 23ms/step
Epoch 19/50
505/505 - 12s - loss: 2.0205 - accuracy30: 0.6635 - val_loss: 2.7146 - val_accuracy30: 0.7268 - 12s/epoch - 23ms/step
testing model: results/QRTEA/W9/deepOF_L2/h30
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.5944567
{'0': {'precision': 0.3768744354110208, 'recall': 0.49174917491749176, 'f1-score': 0.4267157614810269, 'support': 29694}, '1': {'precision': 0.8698583617824196, 'recall': 0.8574551194229039, 'f1-score': 0.863612208899904, 'support': 225543}, '2': {'precision': 0.5504963916909215, 'recall': 0.44659723120714195, 'f1-score': 0.4931335607264676, 'support': 30916}, 'accuracy': 0.7751168081410993, 'macro avg': {'precision': 0.5990763962947873, 'recall': 0.5986005085158459, 'f1-score': 0.5944871770357995, 'support': 286153}, 'weighted avg': {'precision': 0.7841976859306162, 'recall': 0.7751168081410993, 'f1-score': 0.7782490605261805, 'support': 286153}}
[[ 14602  13908   1184]
 [ 22060 193393  10090]
 [  2083  15026  13807]]
Evaluating performance on  train set...
505/505 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.5984531
{'0': {'precision': 0.46531953139527676, 'recall': 0.4846665375427723, 'f1-score': 0.4747960280817152, 'support': 15489}, '1': {'precision': 0.8613388739674657, 'recall': 0.8638780177890725, 'f1-score': 0.8626065773447017, 'support': 98375}, '2': {'precision': 0.5252097926347181, 'recall': 0.4932586465185957, 'f1-score': 0.5087330377535939, 'support': 15353}, 'accuracy': 0.7743872710247104, 'macro avg': {'precision': 0.6172893993324868, 'recall': 0.6139344006168135, 'f1-score': 0.6153785477266703, 'support': 129217}, 'weighted avg': {'precision': 0.7739313859217571, 'recall': 0.7743872710247104, 'f1-score': 0.7740747429043675, 'support': 129217}}
[[ 7507  6908  1074]
 [ 7619 84984  5772]
 [ 1007  6773  7573]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.60514045
{'0': {'precision': 0.44597373833254234, 'recall': 0.49464818389191084, 'f1-score': 0.4690515806988353, 'support': 5699}, '1': {'precision': 0.8655429243433947, 'recall': 0.8507499655979084, 'f1-score': 0.8580826937223279, 'support': 36335}, '2': {'precision': 0.5373961218836565, 'recall': 0.537303098494028, 'f1-score': 0.5373496061629014, 'support': 5777}, 'accuracy': 0.770429399092259, 'macro avg': {'precision': 0.6163042615198645, 'recall': 0.6275670826612824, 'f1-score': 0.6214946268613549, 'support': 47811}, 'weighted avg': {'precision': 0.7758809455333772, 'recall': 0.770429399092259, 'f1-score': 0.772956606421253, 'support': 47811}}
[[ 2819  2577   303]
 [ 3054 30912  2369]
 [  448  2225  3104]]
training model: results/QRTEA/W9/deepOF_L2/h50
Epoch 1/50
505/505 - 14s - loss: 3.0228 - accuracy50: 0.4382 - val_loss: 3.0083 - val_accuracy50: 0.6607 - 14s/epoch - 27ms/step
Epoch 2/50
505/505 - 12s - loss: 2.7906 - accuracy50: 0.5074 - val_loss: 2.9465 - val_accuracy50: 0.7068 - 12s/epoch - 23ms/step
Epoch 3/50
505/505 - 12s - loss: 2.6862 - accuracy50: 0.5374 - val_loss: 2.8993 - val_accuracy50: 0.7208 - 12s/epoch - 23ms/step
Epoch 4/50
505/505 - 12s - loss: 2.6150 - accuracy50: 0.5567 - val_loss: 2.8991 - val_accuracy50: 0.7260 - 12s/epoch - 23ms/step
Epoch 5/50
505/505 - 11s - loss: 2.5606 - accuracy50: 0.5693 - val_loss: 2.8629 - val_accuracy50: 0.7240 - 11s/epoch - 23ms/step
Epoch 6/50
505/505 - 12s - loss: 2.5197 - accuracy50: 0.5834 - val_loss: 2.8462 - val_accuracy50: 0.7204 - 12s/epoch - 23ms/step
Epoch 7/50
505/505 - 12s - loss: 2.4888 - accuracy50: 0.5896 - val_loss: 2.8376 - val_accuracy50: 0.7227 - 12s/epoch - 23ms/step
Epoch 8/50
505/505 - 12s - loss: 2.4548 - accuracy50: 0.5966 - val_loss: 2.8558 - val_accuracy50: 0.7213 - 12s/epoch - 23ms/step
Epoch 9/50
505/505 - 12s - loss: 2.4255 - accuracy50: 0.6015 - val_loss: 2.8662 - val_accuracy50: 0.7222 - 12s/epoch - 23ms/step
Epoch 10/50
505/505 - 12s - loss: 2.4012 - accuracy50: 0.6029 - val_loss: 2.8393 - val_accuracy50: 0.7097 - 12s/epoch - 23ms/step
Epoch 11/50
505/505 - 12s - loss: 2.3807 - accuracy50: 0.6098 - val_loss: 2.8423 - val_accuracy50: 0.7124 - 12s/epoch - 23ms/step
Epoch 12/50
505/505 - 11s - loss: 2.3544 - accuracy50: 0.6096 - val_loss: 2.8408 - val_accuracy50: 0.7050 - 11s/epoch - 23ms/step
Epoch 13/50
505/505 - 11s - loss: 2.3384 - accuracy50: 0.6143 - val_loss: 2.8469 - val_accuracy50: 0.7092 - 11s/epoch - 23ms/step
Epoch 14/50
505/505 - 11s - loss: 2.3130 - accuracy50: 0.6176 - val_loss: 2.8951 - val_accuracy50: 0.7029 - 11s/epoch - 23ms/step
Epoch 15/50
505/505 - 11s - loss: 2.2848 - accuracy50: 0.6222 - val_loss: 2.9014 - val_accuracy50: 0.6990 - 11s/epoch - 23ms/step
Epoch 16/50
505/505 - 11s - loss: 2.2628 - accuracy50: 0.6228 - val_loss: 2.9442 - val_accuracy50: 0.6992 - 11s/epoch - 23ms/step
Epoch 17/50
505/505 - 11s - loss: 2.2443 - accuracy50: 0.6221 - val_loss: 2.9914 - val_accuracy50: 0.6866 - 11s/epoch - 23ms/step
testing model: results/QRTEA/W9/deepOF_L2/h50
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.6872248
{'0': {'precision': 0.44384722577709523, 'recall': 0.39254005382429136, 'f1-score': 0.4166199514161395, 'support': 39759}, '1': {'precision': 0.7911295086328567, 'recall': 0.8565374888934454, 'f1-score': 0.8225352376799976, 'support': 204834}, '2': {'precision': 0.558947332397933, 'recall': 0.3929980750721848, 'f1-score': 0.46150803181644795, 'support': 41560}, 'accuracy': 0.7247451538163151, 'macro avg': {'precision': 0.5979746889359617, 'recall': 0.5473585392633072, 'f1-score': 0.5668877403041951, 'support': 286153}, 'weighted avg': {'precision': 0.70915557326127, 'recall': 0.7247451538163151, 'f1-score': 0.7137015838575534, 'support': 286153}}
[[ 15607  23016   1136]
 [ 17634 175448  11752]
 [  1922  23305  16333]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.69857824
{'0': {'precision': 0.5268498385715227, 'recall': 0.39199921560937345, 'f1-score': 0.44952916373858043, 'support': 20398}, '1': {'precision': 0.7797389002160616, 'recall': 0.865203444200574, 'f1-score': 0.820250976374928, 'support': 88845}, '2': {'precision': 0.5534709193245778, 'recall': 0.42830679883849004, 'f1-score': 0.48291044565493496, 'support': 19974}, 'accuracy': 0.722969887863052, 'macro avg': {'precision': 0.6200198860373874, 'recall': 0.5618364862161459, 'f1-score': 0.5842301952561478, 'support': 129217}, 'weighted avg': {'precision': 0.7048423484484783, 'recall': 0.722969887863052, 'f1-score': 0.7095842429361595, 'support': 129217}}
[[ 7996 11262  1140]
 [ 6214 76869  5762]
 [  967 10452  8555]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.6987536
{'0': {'precision': 0.5040705563093623, 'recall': 0.3976451699223976, 'f1-score': 0.4445774121166791, 'support': 7474}, '1': {'precision': 0.7856543624161074, 'recall': 0.8569206368571951, 'f1-score': 0.8197414874682695, 'support': 32786}, '2': {'precision': 0.5754670999187652, 'recall': 0.4690769434511985, 'f1-score': 0.5168539325842696, 'support': 7551}, 'accuracy': 0.723871075693878, 'macro avg': {'precision': 0.6217306728814116, 'recall': 0.5745475834102638, 'f1-score': 0.5937242773897394, 'support': 47811}, 'weighted avg': {'precision': 0.708440303183729, 'recall': 0.723871075693878, 'f1-score': 0.7132580375068198, 'support': 47811}}
[[ 2972  4154   348]
 [ 2426 28095  2265]
 [  498  3511  3542]]
training model: results/QRTEA/W9/deepOF_L2/h100
Epoch 1/50
505/505 - 14s - loss: 3.1635 - accuracy100: 0.4122 - val_loss: 3.3410 - val_accuracy100: 0.5746 - 14s/epoch - 28ms/step
Epoch 2/50
505/505 - 12s - loss: 3.0319 - accuracy100: 0.4588 - val_loss: 3.2548 - val_accuracy100: 0.5871 - 12s/epoch - 24ms/step
Epoch 3/50
505/505 - 12s - loss: 2.9602 - accuracy100: 0.4858 - val_loss: 3.2357 - val_accuracy100: 0.5948 - 12s/epoch - 24ms/step
Epoch 4/50
505/505 - 12s - loss: 2.9021 - accuracy100: 0.5024 - val_loss: 3.2457 - val_accuracy100: 0.6039 - 12s/epoch - 24ms/step
Epoch 5/50
505/505 - 12s - loss: 2.8619 - accuracy100: 0.5132 - val_loss: 3.2175 - val_accuracy100: 0.6053 - 12s/epoch - 24ms/step
Epoch 6/50
505/505 - 12s - loss: 2.8283 - accuracy100: 0.5225 - val_loss: 3.2311 - val_accuracy100: 0.6064 - 12s/epoch - 24ms/step
Epoch 7/50
505/505 - 12s - loss: 2.8029 - accuracy100: 0.5295 - val_loss: 3.2328 - val_accuracy100: 0.6063 - 12s/epoch - 23ms/step
Epoch 8/50
505/505 - 12s - loss: 2.7816 - accuracy100: 0.5387 - val_loss: 3.1970 - val_accuracy100: 0.6109 - 12s/epoch - 24ms/step
Epoch 9/50
505/505 - 12s - loss: 2.7579 - accuracy100: 0.5439 - val_loss: 3.2020 - val_accuracy100: 0.6118 - 12s/epoch - 23ms/step
Epoch 10/50
505/505 - 12s - loss: 2.7392 - accuracy100: 0.5454 - val_loss: 3.1896 - val_accuracy100: 0.6093 - 12s/epoch - 24ms/step
Epoch 11/50
505/505 - 12s - loss: 2.7241 - accuracy100: 0.5502 - val_loss: 3.2226 - val_accuracy100: 0.6058 - 12s/epoch - 23ms/step
Epoch 12/50
505/505 - 12s - loss: 2.6986 - accuracy100: 0.5539 - val_loss: 3.2128 - val_accuracy100: 0.6049 - 12s/epoch - 23ms/step
Epoch 13/50
505/505 - 12s - loss: 2.6770 - accuracy100: 0.5566 - val_loss: 3.2254 - val_accuracy100: 0.6084 - 12s/epoch - 24ms/step
Epoch 14/50
505/505 - 12s - loss: 2.6534 - accuracy100: 0.5609 - val_loss: 3.2509 - val_accuracy100: 0.6038 - 12s/epoch - 24ms/step
Epoch 15/50
505/505 - 12s - loss: 2.6333 - accuracy100: 0.5647 - val_loss: 3.2750 - val_accuracy100: 0.6029 - 12s/epoch - 23ms/step
Epoch 16/50
505/505 - 12s - loss: 2.6038 - accuracy100: 0.5693 - val_loss: 3.2966 - val_accuracy100: 0.5956 - 12s/epoch - 23ms/step
Epoch 17/50
505/505 - 12s - loss: 2.5808 - accuracy100: 0.5722 - val_loss: 3.3480 - val_accuracy100: 0.5949 - 12s/epoch - 24ms/step
Epoch 18/50
505/505 - 12s - loss: 2.5505 - accuracy100: 0.5778 - val_loss: 3.3511 - val_accuracy100: 0.5928 - 12s/epoch - 23ms/step
Epoch 19/50
505/505 - 12s - loss: 2.5306 - accuracy100: 0.5788 - val_loss: 3.4876 - val_accuracy100: 0.5887 - 12s/epoch - 23ms/step
Epoch 20/50
505/505 - 12s - loss: 2.5037 - accuracy100: 0.5830 - val_loss: 3.4149 - val_accuracy100: 0.5752 - 12s/epoch - 23ms/step
testing model: results/QRTEA/W9/deepOF_L2/h100
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.8798831
{'0': {'precision': 0.48187873701877687, 'recall': 0.3068022440392707, 'f1-score': 0.3749081857504285, 'support': 59892}, '1': {'precision': 0.6357871737058646, 'recall': 0.8353041056399105, 'f1-score': 0.7220158857115706, 'support': 163726}, '2': {'precision': 0.5783205735812371, 'recall': 0.3044055329015751, 'f1-score': 0.3988643387706781, 'support': 62535}, 'accuracy': 0.6086673912207805, 'macro avg': {'precision': 0.5653288281019595, 'recall': 0.4821706275269188, 'f1-score': 0.4985961367442257, 'support': 286153}, 'weighted avg': {'precision': 0.5910154679091173, 'recall': 0.6086673912207805, 'f1-score': 0.578745480180189, 'support': 286153}}
[[ 18375  38599   2918]
 [ 16003 136761  10962]
 [  3754  39745  19036]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.8758809
{'0': {'precision': 0.5676766295055058, 'recall': 0.2826975476839237, 'f1-score': 0.37743571087515054, 'support': 29360}, '1': {'precision': 0.6336239282810296, 'recall': 0.8586272786866954, 'f1-score': 0.7291624717211318, 'support': 71697}, '2': {'precision': 0.5530133608578474, 'recall': 0.3424715909090909, 'f1-score': 0.42299173227483056, 'support': 28160}, 'accuracy': 0.6152828188241485, 'macro avg': {'precision': 0.5847713062147942, 'recall': 0.49459880575990334, 'f1-score': 0.5098633049570376, 'support': 129217}, 'weighted avg': {'precision': 0.6010724352833111, 'recall': 0.6152828188241485, 'f1-score': 0.5825218151415342, 'support': 129217}}
[[ 8300 18676  2384]
 [ 4725 61561  5411]
 [ 1596 16920  9644]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.8941818
{'0': {'precision': 0.5178224238496435, 'recall': 0.2957889865802869, 'f1-score': 0.37650939506391, 'support': 10805}, '1': {'precision': 0.6339344971865531, 'recall': 0.835005701254276, 'f1-score': 0.7207086032969737, 'support': 26310}, '2': {'precision': 0.5695876288659794, 'recall': 0.37191473448017953, 'f1-score': 0.45, 'support': 10696}, 'accuracy': 0.6095459203948882, 'macro avg': {'precision': 0.5737815166340586, 'recall': 0.5009031407715808, 'f1-score': 0.5157393327869613, 'support': 47811}, 'weighted avg': {'precision': 0.593298554496332, 'recall': 0.6095459203948882, 'f1-score': 0.5823602804042778, 'support': 47811}}
[[ 3196  6677   932]
 [ 2267 21969  2074]
 [  709  6009  3978]]
training model: results/QRTEA/W9/deepOF_L2/h200
Epoch 1/50
505/505 - 14s - loss: 3.2499 - accuracy200: 0.3932 - val_loss: 3.4607 - val_accuracy200: 0.4522 - 14s/epoch - 28ms/step
Epoch 2/50
505/505 - 12s - loss: 3.1721 - accuracy200: 0.4225 - val_loss: 3.4419 - val_accuracy200: 0.4593 - 12s/epoch - 24ms/step
Epoch 3/50
505/505 - 12s - loss: 3.1232 - accuracy200: 0.4418 - val_loss: 3.4298 - val_accuracy200: 0.4675 - 12s/epoch - 24ms/step
Epoch 4/50
505/505 - 12s - loss: 3.0890 - accuracy200: 0.4547 - val_loss: 3.4026 - val_accuracy200: 0.4715 - 12s/epoch - 24ms/step
Epoch 5/50
505/505 - 12s - loss: 3.0620 - accuracy200: 0.4647 - val_loss: 3.3764 - val_accuracy200: 0.4759 - 12s/epoch - 24ms/step
Epoch 6/50
505/505 - 12s - loss: 3.0394 - accuracy200: 0.4706 - val_loss: 3.3488 - val_accuracy200: 0.4800 - 12s/epoch - 24ms/step
Epoch 7/50
505/505 - 12s - loss: 3.0216 - accuracy200: 0.4741 - val_loss: 3.3292 - val_accuracy200: 0.4825 - 12s/epoch - 24ms/step
Epoch 8/50
505/505 - 12s - loss: 3.0049 - accuracy200: 0.4802 - val_loss: 3.3072 - val_accuracy200: 0.4853 - 12s/epoch - 24ms/step
Epoch 9/50
505/505 - 12s - loss: 2.9936 - accuracy200: 0.4814 - val_loss: 3.3122 - val_accuracy200: 0.4842 - 12s/epoch - 23ms/step
Epoch 10/50
505/505 - 12s - loss: 2.9770 - accuracy200: 0.4853 - val_loss: 3.3076 - val_accuracy200: 0.4854 - 12s/epoch - 23ms/step
Epoch 11/50
505/505 - 12s - loss: 2.9614 - accuracy200: 0.4909 - val_loss: 3.3072 - val_accuracy200: 0.4853 - 12s/epoch - 23ms/step
Epoch 12/50
505/505 - 12s - loss: 2.9520 - accuracy200: 0.4942 - val_loss: 3.3099 - val_accuracy200: 0.4849 - 12s/epoch - 23ms/step
Epoch 13/50
505/505 - 12s - loss: 2.9353 - accuracy200: 0.4964 - val_loss: 3.2937 - val_accuracy200: 0.4861 - 12s/epoch - 23ms/step
Epoch 14/50
505/505 - 12s - loss: 2.9233 - accuracy200: 0.4988 - val_loss: 3.3176 - val_accuracy200: 0.4856 - 12s/epoch - 23ms/step
Epoch 15/50
505/505 - 12s - loss: 2.9072 - accuracy200: 0.5053 - val_loss: 3.3498 - val_accuracy200: 0.4801 - 12s/epoch - 23ms/step
Epoch 16/50
505/505 - 12s - loss: 2.9048 - accuracy200: 0.5042 - val_loss: 3.3405 - val_accuracy200: 0.4824 - 12s/epoch - 23ms/step
Epoch 17/50
505/505 - 12s - loss: 2.8828 - accuracy200: 0.5106 - val_loss: 3.4124 - val_accuracy200: 0.4828 - 12s/epoch - 23ms/step
Epoch 18/50
505/505 - 12s - loss: 2.8638 - accuracy200: 0.5137 - val_loss: 3.4111 - val_accuracy200: 0.4792 - 12s/epoch - 23ms/step
Epoch 19/50
505/505 - 12s - loss: 2.8481 - accuracy200: 0.5163 - val_loss: 3.4297 - val_accuracy200: 0.4818 - 12s/epoch - 23ms/step
Epoch 20/50
505/505 - 12s - loss: 2.8292 - accuracy200: 0.5233 - val_loss: 3.4766 - val_accuracy200: 0.4834 - 12s/epoch - 23ms/step
Epoch 21/50
505/505 - 12s - loss: 2.8165 - accuracy200: 0.5252 - val_loss: 3.4981 - val_accuracy200: 0.4837 - 12s/epoch - 23ms/step
Epoch 22/50
505/505 - 12s - loss: 2.7973 - accuracy200: 0.5293 - val_loss: 3.5407 - val_accuracy200: 0.4835 - 12s/epoch - 23ms/step
Epoch 23/50
505/505 - 12s - loss: 2.7742 - accuracy200: 0.5365 - val_loss: 3.5215 - val_accuracy200: 0.4803 - 12s/epoch - 23ms/step
testing model: results/QRTEA/W9/deepOF_L2/h200
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0436679
{'0': {'precision': 0.5140974466197807, 'recall': 0.1032354924488212, 'f1-score': 0.17194320830684465, 'support': 78597}, '1': {'precision': 0.4766040441458897, 'recall': 0.8816981027799051, 'f1-score': 0.618744338219202, 'support': 126659}, '2': {'precision': 0.4931218105169736, 'recall': 0.21978565336168213, 'f1-score': 0.304053765187725, 'support': 80897}, 'accuracy': 0.4807533033027786, 'macro avg': {'precision': 0.49460776709421467, 'recall': 0.40157308286346954, 'f1-score': 0.36491377057125723, 'support': 286153}, 'weighted avg': {'precision': 0.4915719344016689, 'recall': 0.4807533033027786, 'f1-score': 0.4070577520424052, 'support': 286153}}
[[  8114  63311   7172]
 [  3880 111675  11104]
 [  3789  59328  17780]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.025867
{'0': {'precision': 0.5994074074074074, 'recall': 0.10435634881741508, 'f1-score': 0.17776410887282795, 'support': 38771}, '1': {'precision': 0.4695415985986183, 'recall': 0.8779141442949933, 'f1-score': 0.61184526900956, 'support': 54347}, '2': {'precision': 0.5253440751930178, 'recall': 0.303471010277293, 'f1-score': 0.38470993117010815, 'support': 36099}, 'accuracy': 0.4853308775161163, 'macro avg': {'precision': 0.5314310270663479, 'recall': 0.4285805011299004, 'f1-score': 0.3914397696841654, 'support': 129217}, 'weighted avg': {'precision': 0.5240966561831992, 'recall': 0.4853308775161163, 'f1-score': 0.41814692265940784, 'support': 129217}}
[[ 4046 30177  4548]
 [ 1285 47712  5350]
 [ 1419 23725 10955]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.038087
{'0': {'precision': 0.5438365194462755, 'recall': 0.11687207819804504, 'f1-score': 0.1923973880597015, 'support': 14118}, '1': {'precision': 0.4735630293561385, 'recall': 0.8572917183545874, 'f1-score': 0.6101066459495728, 'support': 20153}, '2': {'precision': 0.5142271521581866, 'recall': 0.31499261447562776, 'f1-score': 0.3906750938902629, 'support': 13540}, 'accuracy': 0.4850766559996654, 'macro avg': {'precision': 0.5105422336535335, 'recall': 0.42971880367608667, 'f1-score': 0.3977263759665124, 'support': 47811}, 'weighted avg': {'precision': 0.5058299419041355, 'recall': 0.4850766559996654, 'f1-score': 0.4246195714735681, 'support': 47811}}
[[ 1650 10639  1829]
 [  676 17277  2200]
 [  708  8567  4265]]
training model: results/QRTEA/W9/deepOF_L2/h300
Epoch 1/50
505/505 - 14s - loss: 3.2738 - accuracy300: 0.3805 - val_loss: 3.5034 - val_accuracy300: 0.3913 - 14s/epoch - 28ms/step
Epoch 2/50
505/505 - 12s - loss: 3.2170 - accuracy300: 0.4053 - val_loss: 3.4555 - val_accuracy300: 0.3995 - 12s/epoch - 24ms/step
Epoch 3/50
505/505 - 12s - loss: 3.1858 - accuracy300: 0.4173 - val_loss: 3.4388 - val_accuracy300: 0.4040 - 12s/epoch - 24ms/step
Epoch 4/50
505/505 - 12s - loss: 3.1631 - accuracy300: 0.4272 - val_loss: 3.4397 - val_accuracy300: 0.4074 - 12s/epoch - 24ms/step
Epoch 5/50
505/505 - 12s - loss: 3.1408 - accuracy300: 0.4367 - val_loss: 3.4257 - val_accuracy300: 0.4107 - 12s/epoch - 23ms/step
Epoch 6/50
505/505 - 12s - loss: 3.1241 - accuracy300: 0.4428 - val_loss: 3.3942 - val_accuracy300: 0.4158 - 12s/epoch - 24ms/step
Epoch 7/50
505/505 - 12s - loss: 3.1095 - accuracy300: 0.4478 - val_loss: 3.4067 - val_accuracy300: 0.4157 - 12s/epoch - 23ms/step
Epoch 8/50
505/505 - 12s - loss: 3.0971 - accuracy300: 0.4523 - val_loss: 3.3837 - val_accuracy300: 0.4202 - 12s/epoch - 24ms/step
Epoch 9/50
505/505 - 12s - loss: 3.0866 - accuracy300: 0.4555 - val_loss: 3.3747 - val_accuracy300: 0.4206 - 12s/epoch - 23ms/step
Epoch 10/50
505/505 - 12s - loss: 3.0751 - accuracy300: 0.4587 - val_loss: 3.3353 - val_accuracy300: 0.4250 - 12s/epoch - 23ms/step
Epoch 11/50
505/505 - 12s - loss: 3.0669 - accuracy300: 0.4618 - val_loss: 3.3482 - val_accuracy300: 0.4238 - 12s/epoch - 23ms/step
Epoch 12/50
505/505 - 12s - loss: 3.0584 - accuracy300: 0.4638 - val_loss: 3.3390 - val_accuracy300: 0.4257 - 12s/epoch - 24ms/step
Epoch 13/50
505/505 - 12s - loss: 3.0482 - accuracy300: 0.4674 - val_loss: 3.3584 - val_accuracy300: 0.4256 - 12s/epoch - 24ms/step
Epoch 14/50
505/505 - 12s - loss: 3.0412 - accuracy300: 0.4707 - val_loss: 3.3734 - val_accuracy300: 0.4270 - 12s/epoch - 23ms/step
Epoch 15/50
505/505 - 12s - loss: 3.0341 - accuracy300: 0.4724 - val_loss: 3.3725 - val_accuracy300: 0.4294 - 12s/epoch - 23ms/step
Epoch 16/50
505/505 - 12s - loss: 3.0250 - accuracy300: 0.4748 - val_loss: 3.3597 - val_accuracy300: 0.4271 - 12s/epoch - 23ms/step
Epoch 17/50
505/505 - 12s - loss: 3.0130 - accuracy300: 0.4795 - val_loss: 3.3926 - val_accuracy300: 0.4304 - 12s/epoch - 23ms/step
Epoch 18/50
505/505 - 12s - loss: 3.0050 - accuracy300: 0.4815 - val_loss: 3.3676 - val_accuracy300: 0.4314 - 12s/epoch - 23ms/step
Epoch 19/50
505/505 - 12s - loss: 2.9891 - accuracy300: 0.4860 - val_loss: 3.4708 - val_accuracy300: 0.4283 - 12s/epoch - 23ms/step
Epoch 20/50
505/505 - 11s - loss: 2.9799 - accuracy300: 0.4888 - val_loss: 3.4378 - val_accuracy300: 0.4317 - 11s/epoch - 23ms/step
testing model: results/QRTEA/W9/deepOF_L2/h300
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1053648
{'0': {'precision': 0.5124901652242329, 'recall': 0.06007678207034898, 'f1-score': 0.10754641047602341, 'support': 86739}, '1': {'precision': 0.41333648813007723, 'recall': 0.8973379233278662, 'f1-score': 0.5659719952595994, 'support': 110966}, '2': {'precision': 0.4622028390627672, 'recall': 0.18332805716353112, 'f1-score': 0.26252732129847, 'support': 88448}, 'accuracy': 0.42285071273060215, 'macro avg': {'precision': 0.4626764974723591, 'recall': 0.38024758752058213, 'f1-score': 0.31201524234469763, 'support': 286153}, 'weighted avg': {'precision': 0.4584963215225789, 'recall': 0.42285071273060215, 'f1-score': 0.3332208050884093, 'support': 286153}}
[[ 5211 71977  9551]
 [ 2076 99574  9316]
 [ 2881 69352 16215]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0996304
{'0': {'precision': 0.5505384470054789, 'recall': 0.06741780996228859, 'f1-score': 0.12012531948223266, 'support': 43223}, '1': {'precision': 0.3955545517851429, 'recall': 0.8970506637073712, 'f1-score': 0.5490190956349104, 'support': 46858}, '2': {'precision': 0.5041341035224828, 'recall': 0.2274632052330335, 'f1-score': 0.3134838187132443, 'support': 39136}, 'accuracy': 0.4167408313147651, 'macro avg': {'precision': 0.4834090341043682, 'recall': 0.39731055963423106, 'f1-score': 0.3275427446101291, 'support': 129217}, 'weighted avg': {'precision': 0.48028208949226436, 'recall': 0.4167408313147651, 'f1-score': 0.33421775924532143, 'support': 129217}}
[[ 2914 35470  4839]
 [  907 42034  3917]
 [ 1472 28762  8902]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0921488
{'0': {'precision': 0.5069868995633188, 'recall': 0.07494674327028597, 'f1-score': 0.13058883077442215, 'support': 15491}, '1': {'precision': 0.40215486806663353, 'recall': 0.8862889746988646, 'f1-score': 0.5532649757150567, 'support': 17351}, '2': {'precision': 0.5230705850041197, 'recall': 0.25445921571247243, 'f1-score': 0.3423666352074064, 'support': 14969}, 'accuracy': 0.4255924368869089, 'macro avg': {'precision': 0.47740411754469064, 'recall': 0.405231644560541, 'f1-score': 0.3420734805656284, 'support': 47811}, 'weighted avg': {'precision': 0.47397809633528265, 'recall': 0.4255924368869089, 'f1-score': 0.3502863009261088, 'support': 47811}}
[[ 1161 12410  1920]
 [  420 15378  1553]
 [  709 10451  3809]]
training model: results/QRTEA/W9/deepOF_L2/h500
Epoch 1/50
505/505 - 14s - loss: 3.3000 - accuracy500: 0.3724 - val_loss: 3.4446 - val_accuracy500: 0.3415 - 14s/epoch - 28ms/step
Epoch 2/50
505/505 - 12s - loss: 3.2682 - accuracy500: 0.3858 - val_loss: 3.4091 - val_accuracy500: 0.3445 - 12s/epoch - 24ms/step
Epoch 3/50
505/505 - 12s - loss: 3.2514 - accuracy500: 0.3960 - val_loss: 3.4074 - val_accuracy500: 0.3464 - 12s/epoch - 24ms/step
Epoch 4/50
505/505 - 12s - loss: 3.2377 - accuracy500: 0.4039 - val_loss: 3.3994 - val_accuracy500: 0.3508 - 12s/epoch - 24ms/step
Epoch 5/50
505/505 - 12s - loss: 3.2280 - accuracy500: 0.4106 - val_loss: 3.4099 - val_accuracy500: 0.3504 - 12s/epoch - 24ms/step
Epoch 6/50
505/505 - 12s - loss: 3.2197 - accuracy500: 0.4158 - val_loss: 3.4030 - val_accuracy500: 0.3525 - 12s/epoch - 24ms/step
Epoch 7/50
505/505 - 12s - loss: 3.2135 - accuracy500: 0.4189 - val_loss: 3.4077 - val_accuracy500: 0.3549 - 12s/epoch - 24ms/step
Epoch 8/50
505/505 - 12s - loss: 3.2064 - accuracy500: 0.4228 - val_loss: 3.4036 - val_accuracy500: 0.3546 - 12s/epoch - 24ms/step
Epoch 9/50
505/505 - 12s - loss: 3.2007 - accuracy500: 0.4255 - val_loss: 3.4153 - val_accuracy500: 0.3534 - 12s/epoch - 23ms/step
Epoch 10/50
505/505 - 12s - loss: 3.1936 - accuracy500: 0.4292 - val_loss: 3.4116 - val_accuracy500: 0.3550 - 12s/epoch - 23ms/step
Epoch 11/50
505/505 - 12s - loss: 3.1875 - accuracy500: 0.4305 - val_loss: 3.4240 - val_accuracy500: 0.3557 - 12s/epoch - 23ms/step
Epoch 12/50
505/505 - 12s - loss: 3.1839 - accuracy500: 0.4325 - val_loss: 3.3955 - val_accuracy500: 0.3585 - 12s/epoch - 23ms/step
Epoch 13/50
505/505 - 12s - loss: 3.1779 - accuracy500: 0.4348 - val_loss: 3.3988 - val_accuracy500: 0.3567 - 12s/epoch - 23ms/step
Epoch 14/50
505/505 - 12s - loss: 3.1741 - accuracy500: 0.4359 - val_loss: 3.3877 - val_accuracy500: 0.3604 - 12s/epoch - 23ms/step
Epoch 15/50
505/505 - 12s - loss: 3.1671 - accuracy500: 0.4381 - val_loss: 3.3870 - val_accuracy500: 0.3612 - 12s/epoch - 23ms/step
Epoch 16/50
505/505 - 12s - loss: 3.1617 - accuracy500: 0.4416 - val_loss: 3.3703 - val_accuracy500: 0.3622 - 12s/epoch - 23ms/step
Epoch 17/50
505/505 - 12s - loss: 3.1560 - accuracy500: 0.4442 - val_loss: 3.3514 - val_accuracy500: 0.3642 - 12s/epoch - 23ms/step
Epoch 18/50
505/505 - 12s - loss: 3.1504 - accuracy500: 0.4449 - val_loss: 3.3548 - val_accuracy500: 0.3667 - 12s/epoch - 23ms/step
Epoch 19/50
505/505 - 12s - loss: 3.1451 - accuracy500: 0.4471 - val_loss: 3.3652 - val_accuracy500: 0.3628 - 12s/epoch - 23ms/step
Epoch 20/50
505/505 - 12s - loss: 3.1392 - accuracy500: 0.4497 - val_loss: 3.3701 - val_accuracy500: 0.3629 - 12s/epoch - 23ms/step
Epoch 21/50
505/505 - 12s - loss: 3.1314 - accuracy500: 0.4535 - val_loss: 3.3825 - val_accuracy500: 0.3659 - 12s/epoch - 23ms/step
Epoch 22/50
505/505 - 12s - loss: 3.1249 - accuracy500: 0.4568 - val_loss: 3.4143 - val_accuracy500: 0.3612 - 12s/epoch - 23ms/step
Epoch 23/50
505/505 - 12s - loss: 3.1128 - accuracy500: 0.4615 - val_loss: 3.4260 - val_accuracy500: 0.3645 - 12s/epoch - 23ms/step
Epoch 24/50
505/505 - 12s - loss: 3.1170 - accuracy500: 0.4607 - val_loss: 3.3890 - val_accuracy500: 0.3686 - 12s/epoch - 23ms/step
Epoch 25/50
505/505 - 12s - loss: 3.1003 - accuracy500: 0.4658 - val_loss: 3.4186 - val_accuracy500: 0.3640 - 12s/epoch - 23ms/step
Epoch 26/50
505/505 - 12s - loss: 3.0997 - accuracy500: 0.4664 - val_loss: 3.4278 - val_accuracy500: 0.3693 - 12s/epoch - 23ms/step
Epoch 27/50
505/505 - 12s - loss: 3.0916 - accuracy500: 0.4696 - val_loss: 3.4648 - val_accuracy500: 0.3672 - 12s/epoch - 23ms/step
testing model: results/QRTEA/W9/deepOF_L2/h500
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.11902
{'0': {'precision': 0.47735249874644825, 'recall': 0.06358960657270724, 'f1-score': 0.11222885884941844, 'support': 89826}, '1': {'precision': 0.3692089968420345, 'recall': 0.8788560347068114, 'f1-score': 0.5199753966986628, 'support': 100038}, '2': {'precision': 0.4389750131728556, 'recall': 0.16439053266728287, 'f1-score': 0.23920270801221025, 'support': 96289}, 'accuracy': 0.38252263649166707, 'macro avg': {'precision': 0.4285121695871128, 'recall': 0.36894539131560045, 'f1-score': 0.2904689878534305, 'support': 286153}, 'weighted avg': {'precision': 0.42663211716069027, 'recall': 0.38252263649166707, 'f1-score': 0.2975015385536283, 'support': 286153}}
[[ 5712 73346 10768]
 [ 2657 87919  9462]
 [ 3597 76863 15829]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1203749
{'0': {'precision': 0.53597621407334, 'recall': 0.0577210434188618, 'f1-score': 0.1042184579214122, 'support': 46846}, '1': {'precision': 0.3325906078127204, 'recall': 0.868954336665766, 'f1-score': 0.48105741249422074, 'support': 40711}, '2': {'precision': 0.4769472679283428, 'recall': 0.20386461833893424, 'f1-score': 0.2856374123463433, 'support': 41660}, 'accuracy': 0.3604247119187104, 'macro avg': {'precision': 0.448504696604801, 'recall': 0.37684666614118734, 'f1-score': 0.2903044275873254, 'support': 129217}, 'weighted avg': {'precision': 0.45286658211410336, 'recall': 0.3604247119187104, 'f1-score': 0.28143511146511185, 'support': 129217}}
[[ 2704 39087  5055]
 [ 1076 35376  4259]
 [ 1265 31902  8493]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1262219
{'0': {'precision': 0.46880570409982175, 'recall': 0.06374598557837968, 'f1-score': 0.1122312903397877, 'support': 16503}, '1': {'precision': 0.33725684226973257, 'recall': 0.8550207961972668, 'f1-score': 0.4837155449316502, 'support': 15147}, '2': {'precision': 0.46943901758303097, 'recall': 0.20815543592599467, 'f1-score': 0.2884211428816392, 'support': 16161}, 'accuracy': 0.3632427684005773, 'macro avg': {'precision': 0.4251671879841951, 'recall': 0.37564073923388036, 'f1-score': 0.2947893260510257, 'support': 47811}, 'weighted avg': {'precision': 0.42734378883056956, 'recall': 0.3632427684005773, 'f1-score': 0.28947661487246434, 'support': 47811}}
[[ 1052 13324  2127]
 [  521 12951  1675]
 [  671 12126  3364]]
training model: results/QRTEA/W9/deepOF_L2/h1000
Epoch 1/50
505/505 - 14s - loss: 3.3174 - accuracy1000: 0.3689 - val_loss: 3.3171 - val_accuracy1000: 0.3594 - 14s/epoch - 28ms/step
Epoch 2/50
505/505 - 12s - loss: 3.2964 - accuracy1000: 0.3732 - val_loss: 3.3051 - val_accuracy1000: 0.3647 - 12s/epoch - 23ms/step
Epoch 3/50
505/505 - 12s - loss: 3.2869 - accuracy1000: 0.3740 - val_loss: 3.2977 - val_accuracy1000: 0.3670 - 12s/epoch - 24ms/step
Epoch 4/50
505/505 - 12s - loss: 3.2776 - accuracy1000: 0.3759 - val_loss: 3.2917 - val_accuracy1000: 0.3683 - 12s/epoch - 23ms/step
Epoch 5/50
505/505 - 12s - loss: 3.2712 - accuracy1000: 0.3796 - val_loss: 3.2924 - val_accuracy1000: 0.3650 - 12s/epoch - 23ms/step
Epoch 6/50
505/505 - 12s - loss: 3.2641 - accuracy1000: 0.3840 - val_loss: 3.2904 - val_accuracy1000: 0.3619 - 12s/epoch - 23ms/step
Epoch 7/50
505/505 - 12s - loss: 3.2576 - accuracy1000: 0.3889 - val_loss: 3.2884 - val_accuracy1000: 0.3620 - 12s/epoch - 23ms/step
Epoch 8/50
505/505 - 12s - loss: 3.2517 - accuracy1000: 0.3934 - val_loss: 3.2912 - val_accuracy1000: 0.3551 - 12s/epoch - 23ms/step
Epoch 9/50
505/505 - 12s - loss: 3.2445 - accuracy1000: 0.3977 - val_loss: 3.2886 - val_accuracy1000: 0.3581 - 12s/epoch - 23ms/step
Epoch 10/50
505/505 - 12s - loss: 3.2412 - accuracy1000: 0.4003 - val_loss: 3.2891 - val_accuracy1000: 0.3580 - 12s/epoch - 23ms/step
Epoch 11/50
505/505 - 12s - loss: 3.2346 - accuracy1000: 0.4037 - val_loss: 3.2865 - val_accuracy1000: 0.3589 - 12s/epoch - 23ms/step
Epoch 12/50
505/505 - 12s - loss: 3.2306 - accuracy1000: 0.4061 - val_loss: 3.2871 - val_accuracy1000: 0.3632 - 12s/epoch - 23ms/step
Epoch 13/50
505/505 - 12s - loss: 3.2271 - accuracy1000: 0.4072 - val_loss: 3.2867 - val_accuracy1000: 0.3618 - 12s/epoch - 23ms/step
Epoch 14/50
505/505 - 12s - loss: 3.2221 - accuracy1000: 0.4098 - val_loss: 3.2862 - val_accuracy1000: 0.3642 - 12s/epoch - 23ms/step
Epoch 15/50
505/505 - 12s - loss: 3.2172 - accuracy1000: 0.4119 - val_loss: 3.2898 - val_accuracy1000: 0.3663 - 12s/epoch - 23ms/step
Epoch 16/50
505/505 - 12s - loss: 3.2119 - accuracy1000: 0.4161 - val_loss: 3.2885 - val_accuracy1000: 0.3646 - 12s/epoch - 23ms/step
Epoch 17/50
505/505 - 12s - loss: 3.2082 - accuracy1000: 0.4178 - val_loss: 3.2847 - val_accuracy1000: 0.3654 - 12s/epoch - 23ms/step
Epoch 18/50
505/505 - 12s - loss: 3.2032 - accuracy1000: 0.4206 - val_loss: 3.2893 - val_accuracy1000: 0.3646 - 12s/epoch - 23ms/step
Epoch 19/50
505/505 - 12s - loss: 3.1970 - accuracy1000: 0.4236 - val_loss: 3.2882 - val_accuracy1000: 0.3682 - 12s/epoch - 23ms/step
Epoch 20/50
505/505 - 12s - loss: 3.1957 - accuracy1000: 0.4243 - val_loss: 3.2878 - val_accuracy1000: 0.3637 - 12s/epoch - 23ms/step
Epoch 21/50
505/505 - 11s - loss: 3.1902 - accuracy1000: 0.4253 - val_loss: 3.2902 - val_accuracy1000: 0.3679 - 11s/epoch - 23ms/step
Epoch 22/50
505/505 - 12s - loss: 3.1852 - accuracy1000: 0.4300 - val_loss: 3.2897 - val_accuracy1000: 0.3671 - 12s/epoch - 23ms/step
Epoch 23/50
505/505 - 12s - loss: 3.1819 - accuracy1000: 0.4319 - val_loss: 3.2932 - val_accuracy1000: 0.3657 - 12s/epoch - 23ms/step
Epoch 24/50
505/505 - 12s - loss: 3.1787 - accuracy1000: 0.4334 - val_loss: 3.2964 - val_accuracy1000: 0.3658 - 12s/epoch - 23ms/step
Epoch 25/50
505/505 - 11s - loss: 3.1729 - accuracy1000: 0.4360 - val_loss: 3.2963 - val_accuracy1000: 0.3651 - 11s/epoch - 23ms/step
Epoch 26/50
505/505 - 12s - loss: 3.1664 - accuracy1000: 0.4392 - val_loss: 3.2968 - val_accuracy1000: 0.3665 - 12s/epoch - 23ms/step
Epoch 27/50
505/505 - 12s - loss: 3.1627 - accuracy1000: 0.4413 - val_loss: 3.2979 - val_accuracy1000: 0.3639 - 12s/epoch - 23ms/step
testing model: results/QRTEA/W9/deepOF_L2/h1000
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0960885
{'0': {'precision': 0.3468670323727111, 'recall': 0.39281651938052325, 'f1-score': 0.3684145741014279, 'support': 91432}, '1': {'precision': 0.33738682762293626, 'recall': 0.27973505756189876, 'f1-score': 0.3058680170367347, 'support': 95115}, '2': {'precision': 0.3889751028945415, 'recall': 0.40514627632873523, 'f1-score': 0.39689603792420075, 'support': 99606}, 'accuracy': 0.35952095557271807, 'macro avg': {'precision': 0.3577429876300629, 'recall': 0.3592326177570524, 'f1-score': 0.35705954302078785, 'support': 286153}, 'weighted avg': {'precision': 0.3583731385383728, 'recall': 0.35952095557271807, 'f1-score': 0.35753860533759463, 'support': 286153}}
[[35916 26107 29409]
 [34525 26607 33983]
 [33103 26148 40355]]
Evaluating performance on  train set...
505/505 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0890801
{'0': {'precision': 0.4099208560918515, 'recall': 0.398910897533248, 'f1-score': 0.4043409420767911, 'support': 46093}, '1': {'precision': 0.36627203959393717, 'recall': 0.30688940200744547, 'f1-score': 0.333961514300732, 'support': 42442}, '2': {'precision': 0.36239011495666074, 'recall': 0.4347131409468561, 'f1-score': 0.3952706100600114, 'support': 40682}, 'accuracy': 0.3799577454978834, 'macro avg': {'precision': 0.37952767021414974, 'recall': 0.3801711468291831, 'f1-score': 0.3778576888125115, 'support': 129217}, 'weighted avg': {'precision': 0.38061984553854733, 'recall': 0.3799577454978834, 'f1-score': 0.3783687950622487, 'support': 129217}}
[[18387 12189 15517]
 [13818 13025 15599]
 [12650 10347 17685]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0949459
{'0': {'precision': 0.37139582579321995, 'recall': 0.37506091617933723, 'f1-score': 0.37321937321937326, 'support': 16416}, '1': {'precision': 0.35264393993310084, 'recall': 0.31683611484110236, 'f1-score': 0.33378241832266753, 'support': 15639}, '2': {'precision': 0.3656733791176813, 'recall': 0.39876872302614874, 'f1-score': 0.38150464509077653, 'support': 15756}, 'accuracy': 0.36382840768860725, 'macro avg': {'precision': 0.36323771494800067, 'recall': 0.36355525134886274, 'f1-score': 0.36283547887760575, 'support': 47811}, 'weighted avg': {'precision': 0.3633762568072923, 'recall': 0.36382840768860725, 'f1-score': 0.3630499186163792, 'support': 47811}}
[[6157 4670 5589]
 [5374 4955 5310]
 [5047 4426 6283]]
training model: results/QRTEA/W9/deepVOL_L2/h10
Epoch 1/50
505/505 - 14s - loss: 2.7574 - accuracy10: 0.5187 - val_loss: 2.5606 - val_accuracy10: 0.7302 - 14s/epoch - 27ms/step
Epoch 2/50
505/505 - 11s - loss: 2.4014 - accuracy10: 0.6532 - val_loss: 2.5223 - val_accuracy10: 0.6917 - 11s/epoch - 22ms/step
Epoch 3/50
505/505 - 11s - loss: 2.2858 - accuracy10: 0.6977 - val_loss: 2.4391 - val_accuracy10: 0.7330 - 11s/epoch - 22ms/step
Epoch 4/50
505/505 - 11s - loss: 2.2262 - accuracy10: 0.7125 - val_loss: 2.3391 - val_accuracy10: 0.7629 - 11s/epoch - 22ms/step
Epoch 5/50
505/505 - 11s - loss: 2.1904 - accuracy10: 0.7202 - val_loss: 2.4609 - val_accuracy10: 0.7472 - 11s/epoch - 22ms/step
Epoch 6/50
505/505 - 11s - loss: 2.1647 - accuracy10: 0.7238 - val_loss: 2.3593 - val_accuracy10: 0.7472 - 11s/epoch - 22ms/step
Epoch 7/50
505/505 - 11s - loss: 2.1453 - accuracy10: 0.7282 - val_loss: 2.3466 - val_accuracy10: 0.7836 - 11s/epoch - 22ms/step
Epoch 8/50
505/505 - 11s - loss: 2.1151 - accuracy10: 0.7340 - val_loss: 2.3483 - val_accuracy10: 0.7985 - 11s/epoch - 22ms/step
Epoch 9/50
505/505 - 12s - loss: 2.1028 - accuracy10: 0.7333 - val_loss: 2.3626 - val_accuracy10: 0.8052 - 12s/epoch - 24ms/step
Epoch 10/50
505/505 - 12s - loss: 2.0998 - accuracy10: 0.7335 - val_loss: 2.3722 - val_accuracy10: 0.7952 - 12s/epoch - 23ms/step
Epoch 11/50
505/505 - 11s - loss: 2.0936 - accuracy10: 0.7293 - val_loss: 2.3972 - val_accuracy10: 0.8051 - 11s/epoch - 22ms/step
Epoch 12/50
505/505 - 11s - loss: 2.0750 - accuracy10: 0.7313 - val_loss: 2.4307 - val_accuracy10: 0.8111 - 11s/epoch - 22ms/step
Epoch 13/50
505/505 - 11s - loss: 2.0594 - accuracy10: 0.7347 - val_loss: 2.4016 - val_accuracy10: 0.7716 - 11s/epoch - 22ms/step
Epoch 14/50
505/505 - 11s - loss: 2.0506 - accuracy10: 0.7379 - val_loss: 2.3730 - val_accuracy10: 0.7837 - 11s/epoch - 22ms/step
testing model: results/QRTEA/W9/deepVOL_L2/h10
Evaluating performance on  test set...
1118/1118 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7559573
{'0': {'precision': 0.17305546296430485, 'recall': 0.6770041954870166, 'f1-score': 0.275649534274403, 'support': 17638}, '1': {'precision': 0.9575854886791711, 'recall': 0.6815686211829393, 'f1-score': 0.7963378394466608, 'support': 250258}, '2': {'precision': 0.28916557784438807, 'recall': 0.6180932040961612, 'f1-score': 0.39400286242887556, 'support': 18261}, 'accuracy': 0.6772366218544366, 'macro avg': {'precision': 0.47326884316262136, 'recall': 0.6588886735887057, 'f1-score': 0.4886634120499798, 'support': 286157}, 'weighted avg': {'precision': 0.866574062834922, 'recall': 0.6772366218544366, 'f1-score': 0.7385690644666671, 'support': 286157}}
[[ 11941   3408   2289]
 [ 54233 170568  25457]
 [  2827   4147  11287]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60938567
{'0': {'precision': 0.288494623655914, 'recall': 0.5724954656993492, 'f1-score': 0.38365566796553824, 'support': 9373}, '1': {'precision': 0.9455709823340751, 'recall': 0.8181785310734463, 'f1-score': 0.8772740930282147, 'support': 110625}, '2': {'precision': 0.3426423200859291, 'recall': 0.5536392233430958, 'f1-score': 0.42330499688990253, 'support': 9219}, 'accuracy': 0.7814838604827539, 'macro avg': {'precision': 0.5255693086919727, 'recall': 0.6481044067052971, 'f1-score': 0.5614115859612184, 'support': 129217}, 'weighted avg': {'precision': 0.8548926966042093, 'recall': 0.7814838604827539, 'f1-score': 0.8090800737009468, 'support': 129217}}
[[ 5366  2483  1524]
 [11846 90511  8268]
 [ 1388  2727  5104]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6289228
{'0': {'precision': 0.23386552732178997, 'recall': 0.6266947875866224, 'f1-score': 0.34062065012691395, 'support': 3319}, '1': {'precision': 0.943681517245367, 'recall': 0.7962190511037931, 'f1-score': 0.8637013124470786, 'support': 40995}, '2': {'precision': 0.4124711316397229, 'recall': 0.5104315518719634, 'f1-score': 0.4562523949418828, 'support': 3499}, 'accuracy': 0.7635371133373768, 'macro avg': {'precision': 0.5300060587356267, 'recall': 0.644448463520793, 'f1-score': 0.5535247858386251, 'support': 47813}, 'weighted avg': {'precision': 0.8555342683843772, 'recall': 0.7635371133373768, 'f1-score': 0.7975735128822886, 'support': 47813}}
[[ 2080   866   373]
 [ 6183 32641  2171]
 [  631  1082  1786]]
training model: results/QRTEA/W9/deepVOL_L2/h20
Epoch 1/50
505/505 - 14s - loss: 2.8578 - accuracy20: 0.4725 - val_loss: 2.7004 - val_accuracy20: 0.5923 - 14s/epoch - 27ms/step
Epoch 2/50
505/505 - 11s - loss: 2.4898 - accuracy20: 0.6323 - val_loss: 2.5839 - val_accuracy20: 0.6478 - 11s/epoch - 23ms/step
Epoch 3/50
505/505 - 11s - loss: 2.3905 - accuracy20: 0.6541 - val_loss: 2.5313 - val_accuracy20: 0.6898 - 11s/epoch - 22ms/step
Epoch 4/50
505/505 - 11s - loss: 2.3409 - accuracy20: 0.6771 - val_loss: 2.4995 - val_accuracy20: 0.7202 - 11s/epoch - 23ms/step
Epoch 5/50
505/505 - 11s - loss: 2.2899 - accuracy20: 0.6885 - val_loss: 2.5182 - val_accuracy20: 0.7098 - 11s/epoch - 23ms/step
Epoch 6/50
505/505 - 11s - loss: 2.2680 - accuracy20: 0.6889 - val_loss: 2.5414 - val_accuracy20: 0.7420 - 11s/epoch - 22ms/step
Epoch 7/50
505/505 - 11s - loss: 2.2399 - accuracy20: 0.6957 - val_loss: 2.5031 - val_accuracy20: 0.7472 - 11s/epoch - 22ms/step
Epoch 8/50
505/505 - 11s - loss: 2.2134 - accuracy20: 0.6952 - val_loss: 2.5444 - val_accuracy20: 0.7766 - 11s/epoch - 23ms/step
Epoch 9/50
505/505 - 11s - loss: 2.2000 - accuracy20: 0.7018 - val_loss: 2.5548 - val_accuracy20: 0.7700 - 11s/epoch - 23ms/step
Epoch 10/50
505/505 - 11s - loss: 2.1889 - accuracy20: 0.6995 - val_loss: 2.5609 - val_accuracy20: 0.7583 - 11s/epoch - 22ms/step
Epoch 11/50
505/505 - 11s - loss: 2.1759 - accuracy20: 0.6978 - val_loss: 2.5760 - val_accuracy20: 0.7603 - 11s/epoch - 22ms/step
Epoch 12/50
505/505 - 11s - loss: 2.1548 - accuracy20: 0.7011 - val_loss: 2.5619 - val_accuracy20: 0.7671 - 11s/epoch - 23ms/step
Epoch 13/50
505/505 - 11s - loss: 2.1434 - accuracy20: 0.7003 - val_loss: 2.5827 - val_accuracy20: 0.7763 - 11s/epoch - 22ms/step
Epoch 14/50
505/505 - 11s - loss: 2.1340 - accuracy20: 0.7012 - val_loss: 2.6177 - val_accuracy20: 0.7780 - 11s/epoch - 22ms/step
testing model: results/QRTEA/W9/deepVOL_L2/h20
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8913813
{'0': {'precision': 0.1991952679829898, 'recall': 0.6815465149828943, 'f1-score': 0.3082874988347162, 'support': 24261}, '1': {'precision': 0.9255441819716168, 'recall': 0.6069150509018714, 'f1-score': 0.7331049104124624, 'support': 236730}, '2': {'precision': 0.3076907022852969, 'recall': 0.5858300882142573, 'f1-score': 0.4034701221931829, 'support': 25166}, 'accuracy': 0.6113881540552913, 'macro avg': {'precision': 0.47747671741330117, 'recall': 0.6247638846996743, 'f1-score': 0.48162084381345377, 'support': 286157}, 'weighted avg': {'precision': 0.8096258166264949, 'recall': 0.6113881540552913, 'f1-score': 0.668098343029473, 'support': 286157}}
[[ 16535   4750   2976]
 [ 62859 143675  30196]
 [  3615   6808  14743]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6602642
{'0': {'precision': 0.334725920484804, 'recall': 0.5672164306830558, 'f1-score': 0.4210070446933826, 'support': 12854}, '1': {'precision': 0.9075854700854701, 'recall': 0.8025662530969527, 'f1-score': 0.8518512833893553, 'support': 103731}, '2': {'precision': 0.41777551410199276, 'recall': 0.5194743508549715, 'f1-score': 0.4631073785242952, 'support': 12632}, 'accuracy': 0.7514800684120511, 'macro avg': {'precision': 0.5533623015574223, 'recall': 0.6297523448783267, 'f1-score': 0.5786552355356777, 'support': 129217}, 'weighted avg': {'precision': 0.8027167917029798, 'recall': 0.7514800684120511, 'f1-score': 0.7709897492997737, 'support': 129217}}
[[ 7291  3935  1628]
 [12963 83251  7517]
 [ 1528  4542  6562]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6981082
{'0': {'precision': 0.26764427625354775, 'recall': 0.6123376623376623, 'f1-score': 0.3724818959842001, 'support': 4620}, '1': {'precision': 0.9015673017824216, 'recall': 0.763984375, 'f1-score': 0.8270933182971525, 'support': 38400}, '2': {'precision': 0.48692324048479696, 'recall': 0.4777800959732944, 'f1-score': 0.4823083403538332, 'support': 4793}, 'accuracy': 0.720640829899818, 'macro avg': {'precision': 0.5520449395069221, 'recall': 0.6180340444369855, 'f1-score': 0.5606278515450619, 'support': 47813}, 'weighted avg': {'precision': 0.7987477053600488, 'recall': 0.720640829899818, 'f1-score': 0.7486029669205777, 'support': 47813}}
[[ 2829  1404   387]
 [ 7037 29337  2026]
 [  704  1799  2290]]
training model: results/QRTEA/W9/deepVOL_L2/h30
Epoch 1/50
505/505 - 14s - loss: 2.9181 - accuracy30: 0.4491 - val_loss: 2.7871 - val_accuracy30: 0.5904 - 14s/epoch - 28ms/step
Epoch 2/50
505/505 - 11s - loss: 2.6275 - accuracy30: 0.5795 - val_loss: 2.7261 - val_accuracy30: 0.6370 - 11s/epoch - 22ms/step
Epoch 3/50
505/505 - 11s - loss: 2.5192 - accuracy30: 0.6200 - val_loss: 2.6934 - val_accuracy30: 0.6692 - 11s/epoch - 22ms/step
Epoch 4/50
505/505 - 11s - loss: 2.4612 - accuracy30: 0.6417 - val_loss: 2.5886 - val_accuracy30: 0.6468 - 11s/epoch - 22ms/step
Epoch 5/50
505/505 - 11s - loss: 2.4226 - accuracy30: 0.6487 - val_loss: 2.6246 - val_accuracy30: 0.6968 - 11s/epoch - 22ms/step
Epoch 6/50
505/505 - 11s - loss: 2.3849 - accuracy30: 0.6600 - val_loss: 2.5919 - val_accuracy30: 0.7149 - 11s/epoch - 22ms/step
Epoch 7/50
505/505 - 11s - loss: 2.3615 - accuracy30: 0.6575 - val_loss: 2.6162 - val_accuracy30: 0.6843 - 11s/epoch - 22ms/step
Epoch 8/50
505/505 - 11s - loss: 2.3379 - accuracy30: 0.6614 - val_loss: 2.5749 - val_accuracy30: 0.6796 - 11s/epoch - 22ms/step
Epoch 9/50
505/505 - 11s - loss: 2.3178 - accuracy30: 0.6640 - val_loss: 2.5994 - val_accuracy30: 0.7043 - 11s/epoch - 22ms/step
Epoch 10/50
505/505 - 11s - loss: 2.2953 - accuracy30: 0.6677 - val_loss: 2.6203 - val_accuracy30: 0.7325 - 11s/epoch - 22ms/step
Epoch 11/50
505/505 - 11s - loss: 2.2779 - accuracy30: 0.6698 - val_loss: 2.5960 - val_accuracy30: 0.6979 - 11s/epoch - 22ms/step
Epoch 12/50
505/505 - 11s - loss: 2.2594 - accuracy30: 0.6728 - val_loss: 2.5957 - val_accuracy30: 0.7098 - 11s/epoch - 22ms/step
Epoch 13/50
505/505 - 11s - loss: 2.2380 - accuracy30: 0.6721 - val_loss: 2.6074 - val_accuracy30: 0.7220 - 11s/epoch - 22ms/step
Epoch 14/50
505/505 - 12s - loss: 2.2245 - accuracy30: 0.6732 - val_loss: 2.6166 - val_accuracy30: 0.7005 - 12s/epoch - 23ms/step
Epoch 15/50
505/505 - 11s - loss: 2.2102 - accuracy30: 0.6743 - val_loss: 2.6488 - val_accuracy30: 0.6623 - 11s/epoch - 22ms/step
Epoch 16/50
505/505 - 11s - loss: 2.1958 - accuracy30: 0.6750 - val_loss: 2.6938 - val_accuracy30: 0.6672 - 11s/epoch - 22ms/step
Epoch 17/50
505/505 - 11s - loss: 2.1829 - accuracy30: 0.6733 - val_loss: 2.6698 - val_accuracy30: 0.6617 - 11s/epoch - 22ms/step
Epoch 18/50
505/505 - 11s - loss: 2.1706 - accuracy30: 0.6744 - val_loss: 2.6696 - val_accuracy30: 0.6470 - 11s/epoch - 22ms/step
testing model: results/QRTEA/W9/deepVOL_L2/h30
Evaluating performance on  test set...
1118/1118 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9099311
{'0': {'precision': 0.2534771730650238, 'recall': 0.6346063177746346, 'f1-score': 0.3622592179630128, 'support': 29694}, '1': {'precision': 0.8939664218258132, 'recall': 0.6043618403259631, 'f1-score': 0.7211760006560378, 'support': 225547}, '2': {'precision': 0.3141147720569647, 'recall': 0.6028593608487515, 'f1-score': 0.413025894449923, 'support': 30916}, 'accuracy': 0.6073379298776546, 'macro avg': {'precision': 0.4871861223159339, 'recall': 0.6139425063164498, 'f1-score': 0.4988203710229912, 'support': 286157}, 'weighted avg': {'precision': 0.7648576411321499, 'recall': 0.6073379298776546, 'f1-score': 0.6506397438852619, 'support': 286157}}
[[ 18844   7145   3705]
 [ 52243 136312  36992]
 [  3255   9023  18638]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72515726
{'0': {'precision': 0.37290417861176267, 'recall': 0.5519835401530251, 'f1-score': 0.44510693454309785, 'support': 15553}, '1': {'precision': 0.8772692999245983, 'recall': 0.7691720911310008, 'f1-score': 0.819672131147541, 'support': 98320}, '2': {'precision': 0.41875937968984495, 'recall': 0.5455552659019812, 'f1-score': 0.4738212486556858, 'support': 15344}, 'accuracy': 0.7164769341495314, 'macro avg': {'precision': 0.5563109527420687, 'recall': 0.622236965728669, 'f1-score': 0.5795334381154416, 'support': 129217}, 'weighted avg': {'precision': 0.7621159768489922, 'recall': 0.7164769341495314, 'f1-score': 0.7335197793382285, 'support': 129217}}
[[ 8585  5042  1926]
 [13002 75625  9693]
 [ 1435  5538  8371]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76585245
{'0': {'precision': 0.29329173166926675, 'recall': 0.5966149506346967, 'f1-score': 0.39325973271353865, 'support': 5672}, '1': {'precision': 0.8659482192140886, 'recall': 0.7247229631259109, 'f1-score': 0.7890663592952413, 'support': 36367}, '2': {'precision': 0.47987669121424903, 'recall': 0.485278836162106, 'f1-score': 0.48256264531128906, 'support': 5774}, 'accuracy': 0.6806098759751532, 'macro avg': {'precision': 0.5463722140325348, 'recall': 0.6022055833075712, 'f1-score': 0.5549629124400229, 'support': 47813}, 'weighted avg': {'precision': 0.7513918307836344, 'recall': 0.6806098759751532, 'f1-score': 0.7050982411994355, 'support': 47813}}
[[ 3384  1825   463]
 [ 7437 26356  2574]
 [  717  2255  2802]]
training model: results/QRTEA/W9/deepVOL_L2/h50
Epoch 1/50
505/505 - 13s - loss: 3.0125 - accuracy50: 0.4455 - val_loss: 2.9782 - val_accuracy50: 0.5449 - 13s/epoch - 26ms/step
Epoch 2/50
505/505 - 11s - loss: 2.7621 - accuracy50: 0.5467 - val_loss: 2.9065 - val_accuracy50: 0.5852 - 11s/epoch - 22ms/step
Epoch 3/50
505/505 - 11s - loss: 2.6811 - accuracy50: 0.5847 - val_loss: 2.8379 - val_accuracy50: 0.6257 - 11s/epoch - 22ms/step
Epoch 4/50
505/505 - 11s - loss: 2.6344 - accuracy50: 0.5934 - val_loss: 2.8534 - val_accuracy50: 0.6541 - 11s/epoch - 22ms/step
Epoch 5/50
505/505 - 11s - loss: 2.5980 - accuracy50: 0.6018 - val_loss: 2.8470 - val_accuracy50: 0.6500 - 11s/epoch - 21ms/step
Epoch 6/50
505/505 - 11s - loss: 2.5661 - accuracy50: 0.5966 - val_loss: 2.8415 - val_accuracy50: 0.6574 - 11s/epoch - 23ms/step
Epoch 7/50
505/505 - 11s - loss: 2.5329 - accuracy50: 0.6045 - val_loss: 2.8913 - val_accuracy50: 0.6549 - 11s/epoch - 21ms/step
Epoch 8/50
505/505 - 11s - loss: 2.5171 - accuracy50: 0.6089 - val_loss: 2.8618 - val_accuracy50: 0.6533 - 11s/epoch - 22ms/step
Epoch 9/50
505/505 - 11s - loss: 2.4931 - accuracy50: 0.6141 - val_loss: 2.8490 - val_accuracy50: 0.6466 - 11s/epoch - 21ms/step
Epoch 10/50
505/505 - 11s - loss: 2.4769 - accuracy50: 0.6183 - val_loss: 2.9119 - val_accuracy50: 0.6629 - 11s/epoch - 21ms/step
Epoch 11/50
505/505 - 11s - loss: 2.4654 - accuracy50: 0.6215 - val_loss: 2.9149 - val_accuracy50: 0.6724 - 11s/epoch - 21ms/step
Epoch 12/50
505/505 - 11s - loss: 2.4476 - accuracy50: 0.6201 - val_loss: 2.9032 - val_accuracy50: 0.6747 - 11s/epoch - 22ms/step
Epoch 13/50
505/505 - 11s - loss: 2.4259 - accuracy50: 0.6234 - val_loss: 2.9143 - val_accuracy50: 0.6628 - 11s/epoch - 22ms/step
testing model: results/QRTEA/W9/deepVOL_L2/h50
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0090917
{'0': {'precision': 0.2764104220499569, 'recall': 0.6457154354988808, 'f1-score': 0.3871108799071163, 'support': 39759}, '1': {'precision': 0.812132639983501, 'recall': 0.5382816580988786, 'f1-score': 0.6474399814446732, 'support': 204837}, '2': {'precision': 0.34718575576846167, 'recall': 0.4804263612521354, 'f1-score': 0.40308058785529716, 'support': 41561}, 'accuracy': 0.5448058233766778, 'macro avg': {'precision': 0.4785762726006399, 'recall': 0.5548078182832983, 'f1-score': 0.4792104830690289, 'support': 286157}, 'weighted avg': {'precision': 0.6701705802831232, 'recall': 0.5448058233766778, 'f1-score': 0.5757791606190433, 'support': 286157}}
[[ 25673  10132   3954]
 [ 60987 110260  33590]
 [  6220  15374  19967]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8216174
{'0': {'precision': 0.3916971552303442, 'recall': 0.5133825903997651, 'f1-score': 0.4443597399572242, 'support': 20437}, '1': {'precision': 0.8000770601550835, 'recall': 0.7482208810017116, 'f1-score': 0.7732805772140116, 'support': 88808}, '2': {'precision': 0.44506940502605913, 'recall': 0.431854596435009, 'f1-score': 0.4383624304337882, 'support': 19972}, 'accuracy': 0.6621806728216876, 'macro avg': {'precision': 0.5456145401371623, 'recall': 0.5644860226121619, 'f1-score': 0.5520009158683413, 'support': 129217}, 'weighted avg': {'precision': 0.680616981332763, 'recall': 0.6621806728216876, 'f1-score': 0.6694928373770583, 'support': 129217}}
[[10492  7912  2033]
 [13639 66448  8721]
 [ 2655  8692  8625]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8697043
{'0': {'precision': 0.31692018190371646, 'recall': 0.5421137339055794, 'f1-score': 0.39999999999999997, 'support': 7456}, '1': {'precision': 0.7830971487109442, 'recall': 0.6988785274577924, 'f1-score': 0.7385948243933075, 'support': 32814}, '2': {'precision': 0.5076203671631452, 'recall': 0.3885721861328384, 'f1-score': 0.44018923180896596, 'support': 7543}, 'accuracy': 0.6254784263693974, 'macro avg': {'precision': 0.535879232592602, 'recall': 0.5431881491654034, 'f1-score': 0.5262613520674245, 'support': 47813}, 'weighted avg': {'precision': 0.6669417761610156, 'recall': 0.6254784263693974, 'f1-score': 0.6387174605897354, 'support': 47813}}
[[ 4042  2871   543]
 [ 7581 22933  2300]
 [ 1131  3481  2931]]
training model: results/QRTEA/W9/deepVOL_L2/h100
Epoch 1/50
505/505 - 13s - loss: 3.2035 - accuracy100: 0.3983 - val_loss: 3.3721 - val_accuracy100: 0.5114 - 13s/epoch - 26ms/step
Epoch 2/50
505/505 - 11s - loss: 3.0560 - accuracy100: 0.4630 - val_loss: 3.1751 - val_accuracy100: 0.5177 - 11s/epoch - 22ms/step
Epoch 3/50
505/505 - 11s - loss: 2.9510 - accuracy100: 0.5116 - val_loss: 3.2017 - val_accuracy100: 0.5348 - 11s/epoch - 21ms/step
Epoch 4/50
505/505 - 11s - loss: 2.8923 - accuracy100: 0.5257 - val_loss: 3.2595 - val_accuracy100: 0.5619 - 11s/epoch - 21ms/step
Epoch 5/50
505/505 - 11s - loss: 2.8623 - accuracy100: 0.5319 - val_loss: 3.2117 - val_accuracy100: 0.5442 - 11s/epoch - 22ms/step
Epoch 6/50
505/505 - 11s - loss: 2.8326 - accuracy100: 0.5431 - val_loss: 3.2551 - val_accuracy100: 0.5653 - 11s/epoch - 21ms/step
Epoch 7/50
505/505 - 11s - loss: 2.8104 - accuracy100: 0.5483 - val_loss: 3.2675 - val_accuracy100: 0.5737 - 11s/epoch - 21ms/step
Epoch 8/50
505/505 - 11s - loss: 2.7854 - accuracy100: 0.5508 - val_loss: 3.2823 - val_accuracy100: 0.5798 - 11s/epoch - 22ms/step
Epoch 9/50
505/505 - 11s - loss: 2.7656 - accuracy100: 0.5549 - val_loss: 3.2641 - val_accuracy100: 0.5740 - 11s/epoch - 22ms/step
Epoch 10/50
505/505 - 11s - loss: 2.7445 - accuracy100: 0.5570 - val_loss: 3.2852 - val_accuracy100: 0.5665 - 11s/epoch - 21ms/step
Epoch 11/50
505/505 - 11s - loss: 2.7239 - accuracy100: 0.5627 - val_loss: 3.3122 - val_accuracy100: 0.5657 - 11s/epoch - 21ms/step
Epoch 12/50
505/505 - 11s - loss: 2.7014 - accuracy100: 0.5682 - val_loss: 3.3312 - val_accuracy100: 0.5751 - 11s/epoch - 22ms/step
testing model: results/QRTEA/W9/deepVOL_L2/h100
Evaluating performance on  test set...
1118/1118 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0040386
{'0': {'precision': 0.3269410984891774, 'recall': 0.4776597876177119, 'f1-score': 0.38818405091116326, 'support': 59892}, '1': {'precision': 0.6539336969803455, 'recall': 0.5001068852418966, 'f1-score': 0.5667681871668859, 'support': 163727}, '2': {'precision': 0.37014242531521474, 'recall': 0.4346797147334421, 'f1-score': 0.39982350345639067, 'support': 62538}, 'accuracy': 0.48111002002397285, 'macro avg': {'precision': 0.4503390735949126, 'recall': 0.47081546253101686, 'f1-score': 0.4515919138448133, 'support': 286157}, 'weighted avg': {'precision': 0.523473917012611, 'recall': 0.48111002002397285, 'f1-score': 0.4929061194260489, 'support': 286157}}
[[28608 20133 11151]
 [46739 81881 35107]
 [12155 23199 27184]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.94082874
{'0': {'precision': 0.4042605203422385, 'recall': 0.3942242201334968, 'f1-score': 0.39917929619476195, 'support': 29364}, '1': {'precision': 0.6459340745278469, 'recall': 0.6912722656958336, 'f1-score': 0.6678345708625871, 'support': 71691}, '2': {'precision': 0.42026069826899703, 'recall': 0.3560471557417797, 'f1-score': 0.38549816420291805, 'support': 28162}, 'accuracy': 0.5507092719998142, 'macro avg': {'precision': 0.4901517643796942, 'recall': 0.48051454719037, 'f1-score': 0.4841706770867557, 'support': 129217}, 'weighted avg': {'precision': 0.5418307764532287, 'recall': 0.5507092719998142, 'f1-score': 0.545250457551679, 'support': 129217}}
[[11576 13394  4394]
 [12695 49558  9438]
 [ 4364 13771 10027]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.971967
{'0': {'precision': 0.3439776322566404, 'recall': 0.4340761374187558, 'f1-score': 0.38381018841591064, 'support': 10770}, '1': {'precision': 0.6175060836221518, 'recall': 0.6358390280941534, 'f1-score': 0.6265384759268267, 'support': 26340}, '2': {'precision': 0.4563380281690141, 'recall': 0.302718863869943, 'f1-score': 0.3639835982699545, 'support': 10703}, 'accuracy': 0.5158220567628051, 'macro avg': {'precision': 0.4726072480159354, 'recall': 0.4575446764609507, 'f1-score': 0.45811075420423064, 'support': 47813}, 'weighted avg': {'precision': 0.5198154321524366, 'recall': 0.5158220567628051, 'f1-score': 0.5130900725207641, 'support': 47813}}
[[ 4675  4934  1161]
 [ 6893 16748  2699]
 [ 2023  5440  3240]]
training model: results/QRTEA/W9/deepVOL_L2/h200
Epoch 1/50
505/505 - 14s - loss: 3.2606 - accuracy200: 0.4054 - val_loss: 3.3720 - val_accuracy200: 0.4372 - 14s/epoch - 28ms/step
Epoch 2/50
505/505 - 11s - loss: 3.1812 - accuracy200: 0.4322 - val_loss: 3.3165 - val_accuracy200: 0.4522 - 11s/epoch - 22ms/step
Epoch 3/50
505/505 - 11s - loss: 3.1179 - accuracy200: 0.4569 - val_loss: 3.3304 - val_accuracy200: 0.4575 - 11s/epoch - 22ms/step
Epoch 4/50
505/505 - 11s - loss: 3.0830 - accuracy200: 0.4692 - val_loss: 3.2838 - val_accuracy200: 0.4681 - 11s/epoch - 22ms/step
Epoch 5/50
505/505 - 11s - loss: 3.0546 - accuracy200: 0.4742 - val_loss: 3.2750 - val_accuracy200: 0.4589 - 11s/epoch - 22ms/step
Epoch 6/50
505/505 - 11s - loss: 3.0258 - accuracy200: 0.4849 - val_loss: 3.2830 - val_accuracy200: 0.4569 - 11s/epoch - 22ms/step
Epoch 7/50
505/505 - 11s - loss: 3.0042 - accuracy200: 0.4913 - val_loss: 3.3337 - val_accuracy200: 0.4581 - 11s/epoch - 22ms/step
Epoch 8/50
505/505 - 11s - loss: 2.9859 - accuracy200: 0.4984 - val_loss: 3.2951 - val_accuracy200: 0.4491 - 11s/epoch - 22ms/step
Epoch 9/50
505/505 - 11s - loss: 2.9647 - accuracy200: 0.5012 - val_loss: 3.3320 - val_accuracy200: 0.4363 - 11s/epoch - 22ms/step
Epoch 10/50
505/505 - 11s - loss: 2.9414 - accuracy200: 0.5070 - val_loss: 3.4218 - val_accuracy200: 0.4397 - 11s/epoch - 22ms/step
Epoch 11/50
505/505 - 11s - loss: 2.9186 - accuracy200: 0.5123 - val_loss: 3.4042 - val_accuracy200: 0.4277 - 11s/epoch - 22ms/step
Epoch 12/50
505/505 - 11s - loss: 2.8989 - accuracy200: 0.5186 - val_loss: 3.4939 - val_accuracy200: 0.4277 - 11s/epoch - 22ms/step
Epoch 13/50
505/505 - 11s - loss: 2.8671 - accuracy200: 0.5258 - val_loss: 3.5592 - val_accuracy200: 0.4278 - 11s/epoch - 22ms/step
Epoch 14/50
505/505 - 11s - loss: 2.8357 - accuracy200: 0.5349 - val_loss: 3.5938 - val_accuracy200: 0.4261 - 11s/epoch - 22ms/step
Epoch 15/50
505/505 - 11s - loss: 2.8230 - accuracy200: 0.5362 - val_loss: 3.5235 - val_accuracy200: 0.4226 - 11s/epoch - 22ms/step
testing model: results/QRTEA/W9/deepVOL_L2/h200
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0680664
{'0': {'precision': 0.3682585702397251, 'recall': 0.34906740629532557, 'f1-score': 0.35840627041149575, 'support': 78598}, '1': {'precision': 0.49431927904731254, 'recall': 0.4850346205165049, 'f1-score': 0.4896329386823092, 'support': 126659}, '2': {'precision': 0.38016595135908443, 'recall': 0.4105933250927071, 'f1-score': 0.39479423562620714, 'support': 80900}, 'accuracy': 0.4266434160268664, 'macro avg': {'precision': 0.4142479335487073, 'recall': 0.4148984506348459, 'f1-score': 0.41427781490667065, 'support': 286157}, 'weighted avg': {'precision': 0.42742200307350653, 'recall': 0.4266434160268664, 'f1-score': 0.4267772169981007, 'support': 286157}}
[[27436 31829 19333]
 [30400 61434 34825]
 [16666 31017 33217]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0217383
{'0': {'precision': 0.4656135531135531, 'recall': 0.26215519463779324, 'f1-score': 0.335444499422728, 'support': 38790}, '1': {'precision': 0.495479439119966, 'recall': 0.772553277632596, 'f1-score': 0.6037450921171851, 'support': 54338}, '2': {'precision': 0.47044541561824044, 'recall': 0.29529773615229016, 'f1-score': 0.3628408974839127, 'support': 36089}, 'accuracy': 0.48604285813786113, 'macro avg': {'precision': 0.4771794692839199, 'recall': 0.4433354028075598, 'f1-score': 0.4340101630079419, 'support': 129217}, 'weighted avg': {'precision': 0.479522168851019, 'recall': 0.48604285813786113, 'f1-score': 0.4559211102050671, 'support': 129217}}
[[10169 22802  5819]
 [ 6182 41979  6177]
 [ 5489 19943 10657]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.047362
{'0': {'precision': 0.42444323737099404, 'recall': 0.27750550465231905, 'f1-score': 0.3355952585466415, 'support': 14079}, '1': {'precision': 0.47846193648535024, 'recall': 0.7337697763229678, 'f1-score': 0.5792306939414701, 'support': 20163}, '2': {'precision': 0.44912828519385894, 'recall': 0.25436592734507407, 'f1-score': 0.32478712894575906, 'support': 13571}, 'accuracy': 0.463346788530316, 'macro avg': {'precision': 0.4506778196834011, 'recall': 0.4218804027734537, 'f1-score': 0.4132043604779569, 'support': 47813}, 'weighted avg': {'precision': 0.4542296932354423, 'recall': 0.463346788530316, 'f1-score': 0.43526991098535806, 'support': 47813}}
[[ 3907  8132  2040]
 [ 3174 14795  2194]
 [ 2124  7995  3452]]
training model: results/QRTEA/W9/deepVOL_L2/h300
Epoch 1/50
505/505 - 13s - loss: 3.2897 - accuracy300: 0.3897 - val_loss: 3.5458 - val_accuracy300: 0.3628 - 13s/epoch - 26ms/step
Epoch 2/50
505/505 - 11s - loss: 3.2500 - accuracy300: 0.4035 - val_loss: 3.4595 - val_accuracy300: 0.3710 - 11s/epoch - 22ms/step
Epoch 3/50
505/505 - 11s - loss: 3.2268 - accuracy300: 0.4106 - val_loss: 3.4318 - val_accuracy300: 0.3799 - 11s/epoch - 22ms/step
Epoch 4/50
505/505 - 11s - loss: 3.2000 - accuracy300: 0.4190 - val_loss: 3.4184 - val_accuracy300: 0.3849 - 11s/epoch - 22ms/step
Epoch 5/50
505/505 - 11s - loss: 3.1758 - accuracy300: 0.4312 - val_loss: 3.4484 - val_accuracy300: 0.3843 - 11s/epoch - 21ms/step
Epoch 6/50
505/505 - 11s - loss: 3.1490 - accuracy300: 0.4437 - val_loss: 3.4250 - val_accuracy300: 0.3902 - 11s/epoch - 22ms/step
Epoch 7/50
505/505 - 11s - loss: 3.1137 - accuracy300: 0.4563 - val_loss: 3.3918 - val_accuracy300: 0.4036 - 11s/epoch - 22ms/step
Epoch 8/50
505/505 - 11s - loss: 3.0805 - accuracy300: 0.4687 - val_loss: 3.4025 - val_accuracy300: 0.4103 - 11s/epoch - 21ms/step
Epoch 9/50
505/505 - 11s - loss: 3.0624 - accuracy300: 0.4736 - val_loss: 3.3877 - val_accuracy300: 0.4114 - 11s/epoch - 22ms/step
Epoch 10/50
505/505 - 11s - loss: 3.0420 - accuracy300: 0.4789 - val_loss: 3.4414 - val_accuracy300: 0.4087 - 11s/epoch - 21ms/step
Epoch 11/50
505/505 - 11s - loss: 3.0179 - accuracy300: 0.4863 - val_loss: 3.4196 - val_accuracy300: 0.4059 - 11s/epoch - 22ms/step
Epoch 12/50
505/505 - 11s - loss: 2.9998 - accuracy300: 0.4925 - val_loss: 3.4661 - val_accuracy300: 0.3989 - 11s/epoch - 22ms/step
Epoch 13/50
505/505 - 11s - loss: 2.9789 - accuracy300: 0.4973 - val_loss: 3.5089 - val_accuracy300: 0.3924 - 11s/epoch - 21ms/step
Epoch 14/50
505/505 - 11s - loss: 2.9566 - accuracy300: 0.5038 - val_loss: 3.5534 - val_accuracy300: 0.3844 - 11s/epoch - 21ms/step
Epoch 15/50
505/505 - 11s - loss: 2.9440 - accuracy300: 0.5064 - val_loss: 3.5800 - val_accuracy300: 0.3834 - 11s/epoch - 21ms/step
Epoch 16/50
505/505 - 11s - loss: 2.9188 - accuracy300: 0.5150 - val_loss: 3.6328 - val_accuracy300: 0.3793 - 11s/epoch - 21ms/step
Epoch 17/50
505/505 - 11s - loss: 2.8985 - accuracy300: 0.5179 - val_loss: 3.7055 - val_accuracy300: 0.3768 - 11s/epoch - 22ms/step
Epoch 18/50
505/505 - 11s - loss: 2.8672 - accuracy300: 0.5249 - val_loss: 3.8327 - val_accuracy300: 0.3746 - 11s/epoch - 21ms/step
Epoch 19/50
505/505 - 11s - loss: 2.8459 - accuracy300: 0.5300 - val_loss: 3.8381 - val_accuracy300: 0.3732 - 11s/epoch - 22ms/step
testing model: results/QRTEA/W9/deepVOL_L2/h300
Evaluating performance on  test set...
1118/1118 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1338466
{'0': {'precision': 0.3443243521008547, 'recall': 0.2317473858959431, 'f1-score': 0.2770358732652527, 'support': 86741}, '1': {'precision': 0.43439490445859874, 'recall': 0.4087107762738136, 'f1-score': 0.42116162343119545, 'support': 110966}, '2': {'precision': 0.37372640247708133, 'recall': 0.5212775579423403, 'f1-score': 0.4353392723101109, 'support': 88450}, 'accuracy': 0.38986290742494506, 'macro avg': {'precision': 0.38414855301217826, 'recall': 0.38724524003736566, 'f1-score': 0.377845589668853, 'support': 286157}, 'weighted avg': {'precision': 0.38833998082462057, 'recall': 0.38986290742494506, 'f1-score': 0.38185593231826104, 'support': 286157}}
[[20102 31897 34742]
 [23091 45353 42522]
 [15188 27155 46107]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0976863
{'0': {'precision': 0.42674492938920205, 'recall': 0.16985496518701856, 'f1-score': 0.24299281908732914, 'support': 43231}, '1': {'precision': 0.4316574594184733, 'recall': 0.5950933333333334, 'f1-score': 0.5003677196003515, 'support': 46875}, '2': {'precision': 0.41154747082533183, 'recall': 0.49863209838664313, 'f1-score': 0.4509237207796712, 'support': 39111}, 'accuracy': 0.42362846993816605, 'macro avg': {'precision': 0.423316619877669, 'recall': 0.421193465635665, 'f1-score': 0.39809475315578396, 'support': 129217}, 'weighted avg': {'precision': 0.4239270884180493, 'recall': 0.42362846993816605, 'f1-score': 0.3992944973311911, 'support': 129217}}
[[ 7343 21349 14539]
 [ 5634 27895 13346]
 [ 4230 15379 19502]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1210388
{'0': {'precision': 0.42073000835887436, 'recall': 0.19493932352181773, 'f1-score': 0.266431407146008, 'support': 15492}, '1': {'precision': 0.41624619651041866, 'recall': 0.6230614009801095, 'f1-score': 0.4990763831162834, 'support': 17345}, '2': {'precision': 0.40383042529989094, 'recall': 0.39563301282051283, 'f1-score': 0.3996896923907178, 'support': 14976}, 'accuracy': 0.41310940539183905, 'macro avg': {'precision': 0.4136022100563947, 'recall': 0.40454457910748004, 'f1-score': 0.3883991608843364, 'support': 47813}, 'weighted avg': {'precision': 0.41381013567983727, 'recall': 0.41310940539183905, 'f1-score': 0.39256662535087283, 'support': 47813}}
[[ 3020  7889  4583]
 [ 2374 10807  4164]
 [ 1784  7267  5925]]
training model: results/QRTEA/W9/deepVOL_L2/h500
Epoch 1/50
505/505 - 13s - loss: 3.3087 - accuracy500: 0.3812 - val_loss: 3.5101 - val_accuracy500: 0.3239 - 13s/epoch - 26ms/step
Epoch 2/50
505/505 - 11s - loss: 3.2674 - accuracy500: 0.3945 - val_loss: 3.4132 - val_accuracy500: 0.3287 - 11s/epoch - 22ms/step
Epoch 3/50
505/505 - 11s - loss: 3.2633 - accuracy500: 0.3897 - val_loss: 3.3557 - val_accuracy500: 0.3390 - 11s/epoch - 22ms/step
Epoch 4/50
505/505 - 11s - loss: 3.2390 - accuracy500: 0.4053 - val_loss: 3.3520 - val_accuracy500: 0.3489 - 11s/epoch - 23ms/step
Epoch 5/50
505/505 - 11s - loss: 3.2187 - accuracy500: 0.4147 - val_loss: 3.3455 - val_accuracy500: 0.3530 - 11s/epoch - 22ms/step
Epoch 6/50
505/505 - 11s - loss: 3.1883 - accuracy500: 0.4290 - val_loss: 3.3936 - val_accuracy500: 0.3526 - 11s/epoch - 21ms/step
Epoch 7/50
505/505 - 11s - loss: 3.1580 - accuracy500: 0.4408 - val_loss: 3.3963 - val_accuracy500: 0.3642 - 11s/epoch - 22ms/step
Epoch 8/50
505/505 - 11s - loss: 3.1272 - accuracy500: 0.4568 - val_loss: 3.4603 - val_accuracy500: 0.3519 - 11s/epoch - 22ms/step
Epoch 9/50
505/505 - 11s - loss: 3.1045 - accuracy500: 0.4650 - val_loss: 3.5195 - val_accuracy500: 0.3600 - 11s/epoch - 23ms/step
Epoch 10/50
505/505 - 11s - loss: 3.0785 - accuracy500: 0.4734 - val_loss: 3.5620 - val_accuracy500: 0.3618 - 11s/epoch - 22ms/step
Epoch 11/50
505/505 - 11s - loss: 3.0589 - accuracy500: 0.4795 - val_loss: 3.6099 - val_accuracy500: 0.3563 - 11s/epoch - 21ms/step
Epoch 12/50
505/505 - 11s - loss: 3.0387 - accuracy500: 0.4862 - val_loss: 3.6034 - val_accuracy500: 0.3544 - 11s/epoch - 21ms/step
Epoch 13/50
505/505 - 11s - loss: 3.0116 - accuracy500: 0.4922 - val_loss: 3.5976 - val_accuracy500: 0.3558 - 11s/epoch - 22ms/step
Epoch 14/50
505/505 - 11s - loss: 2.9877 - accuracy500: 0.4997 - val_loss: 3.7286 - val_accuracy500: 0.3545 - 11s/epoch - 22ms/step
Epoch 15/50
505/505 - 11s - loss: 2.9595 - accuracy500: 0.5064 - val_loss: 3.8180 - val_accuracy500: 0.3474 - 11s/epoch - 22ms/step
testing model: results/QRTEA/W9/deepVOL_L2/h500
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1143074
{'0': {'precision': 0.31879386416112293, 'recall': 0.1552428557115344, 'f1-score': 0.20880437223927528, 'support': 89827}, '1': {'precision': 0.3561646772925452, 'recall': 0.49811573486340327, 'f1-score': 0.4153465944846614, 'support': 100039}, '2': {'precision': 0.36710762506829003, 'recall': 0.39079457062446127, 'f1-score': 0.37858095022510624, 'support': 96291}, 'accuracy': 0.3543719007398037, 'macro avg': {'precision': 0.3473553888406527, 'recall': 0.348051053733133, 'f1-score': 0.33424397231634767, 'support': 286157}, 'weighted avg': {'precision': 0.3481159465367642, 'recall': 0.3543719007398037, 'f1-score': 0.3381397854636236, 'support': 286157}}
[[13945 44031 31851]
 [17185 49831 33023]
 [12613 46048 37630]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0913043
{'0': {'precision': 0.4297930003270875, 'recall': 0.19641255605381167, 'f1-score': 0.2696135187817854, 'support': 46830}, '1': {'precision': 0.3565322547016388, 'recall': 0.6293551869663363, 'f1-score': 0.455194810956619, 'support': 40756}, '2': {'precision': 0.41613469740473336, 'recall': 0.3585789435757008, 'f1-score': 0.38521882741535923, 'support': 41631}, 'accuracy': 0.38521247204315223, 'macro avg': {'precision': 0.40081998414448655, 'recall': 0.3947822288652829, 'f1-score': 0.37000905238458787, 'support': 129217}, 'weighted avg': {'precision': 0.4022855999256596, 'recall': 0.38521247204315223, 'f1-score': 0.36539283379143456, 'support': 129217}}
[[ 9198 25555 12077]
 [ 6238 25650  8868]
 [ 5965 20738 14928]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1161928
{'0': {'precision': 0.37775993576876754, 'recall': 0.22825955124317768, 'f1-score': 0.28456944129432227, 'support': 16490}, '1': {'precision': 0.330736747160838, 'recall': 0.5326510399471773, 'f1-score': 0.40808377175232696, 'support': 15145}, '2': {'precision': 0.37323525040867883, 'recall': 0.3104833724811472, 'f1-score': 0.3389796193818329, 'support': 16178}, 'accuracy': 0.3524982745278481, 'macro avg': {'precision': 0.3605773111127615, 'recall': 0.35713132122383406, 'f1-score': 0.343877610809494, 'support': 47813}, 'weighted avg': {'precision': 0.361334140457396, 'recall': 0.3524982745278481, 'f1-score': 0.34210342568949154, 'support': 47813}}
[[3764 8175 4551]
 [3194 8067 3884]
 [3006 8149 5023]]
training model: results/QRTEA/W9/deepVOL_L2/h1000
Epoch 1/50
505/505 - 14s - loss: 3.2952 - accuracy1000: 0.4008 - val_loss: 3.3509 - val_accuracy1000: 0.3210 - 14s/epoch - 27ms/step
Epoch 2/50
505/505 - 11s - loss: 3.3005 - accuracy1000: 0.3718 - val_loss: 3.3170 - val_accuracy1000: 0.3374 - 11s/epoch - 22ms/step
Epoch 3/50
505/505 - 11s - loss: 3.2950 - accuracy1000: 0.3649 - val_loss: 3.3169 - val_accuracy1000: 0.3289 - 11s/epoch - 21ms/step
Epoch 4/50
505/505 - 11s - loss: 3.2792 - accuracy1000: 0.3791 - val_loss: 3.3304 - val_accuracy1000: 0.3195 - 11s/epoch - 22ms/step
Epoch 5/50
505/505 - 11s - loss: 3.2809 - accuracy1000: 0.3793 - val_loss: 3.3066 - val_accuracy1000: 0.3392 - 11s/epoch - 22ms/step
Epoch 6/50
505/505 - 11s - loss: 3.2676 - accuracy1000: 0.3885 - val_loss: 3.3196 - val_accuracy1000: 0.3288 - 11s/epoch - 22ms/step
Epoch 7/50
505/505 - 12s - loss: 3.2650 - accuracy1000: 0.3909 - val_loss: 3.3278 - val_accuracy1000: 0.3260 - 12s/epoch - 23ms/step
Epoch 8/50
505/505 - 11s - loss: 3.2629 - accuracy1000: 0.3936 - val_loss: 3.3572 - val_accuracy1000: 0.3247 - 11s/epoch - 22ms/step
Epoch 9/50
505/505 - 11s - loss: 3.2430 - accuracy1000: 0.4071 - val_loss: 3.3702 - val_accuracy1000: 0.3242 - 11s/epoch - 22ms/step
Epoch 10/50
505/505 - 11s - loss: 3.2505 - accuracy1000: 0.4055 - val_loss: 3.3608 - val_accuracy1000: 0.3193 - 11s/epoch - 22ms/step
Epoch 11/50
505/505 - 11s - loss: 3.2420 - accuracy1000: 0.4077 - val_loss: 3.3658 - val_accuracy1000: 0.3290 - 11s/epoch - 22ms/step
Epoch 12/50
505/505 - 11s - loss: 3.2117 - accuracy1000: 0.4195 - val_loss: 3.4294 - val_accuracy1000: 0.3277 - 11s/epoch - 21ms/step
Epoch 13/50
505/505 - 11s - loss: 3.1967 - accuracy1000: 0.4299 - val_loss: 3.4425 - val_accuracy1000: 0.3321 - 11s/epoch - 22ms/step
Epoch 14/50
505/505 - 11s - loss: 3.1811 - accuracy1000: 0.4365 - val_loss: 3.4884 - val_accuracy1000: 0.3319 - 11s/epoch - 22ms/step
Epoch 15/50
505/505 - 11s - loss: 3.1574 - accuracy1000: 0.4477 - val_loss: 3.5913 - val_accuracy1000: 0.3316 - 11s/epoch - 22ms/step
testing model: results/QRTEA/W9/deepVOL_L2/h1000
Evaluating performance on  test set...
1118/1118 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007389
{'0': {'precision': 0.3094011221802359, 'recall': 0.44327540384762615, 'f1-score': 0.3644325354721528, 'support': 91433}, '1': {'precision': 0.38649414843352475, 'recall': 0.11180032802052231, 'f1-score': 0.17343227595205088, 'support': 95116}, '2': {'precision': 0.33085516420155425, 'recall': 0.42399204883141917, 'f1-score': 0.3716777554828035, 'support': 99608}, 'accuracy': 0.32638376835094024, 'macro avg': {'precision': 0.3422501449384383, 'recall': 0.3263559268998559, 'f1-score': 0.30318085563566904, 'support': 286157}, 'weighted avg': {'precision': 0.34249405543983574, 'recall': 0.32638376835094024, 'f1-score': 0.3034677545662406, 'support': 286157}}
[[40530  9006 41897]
 [40964 10634 43518]
 [49501  7874 42233]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0945834
{'0': {'precision': 0.37552630343251575, 'recall': 0.5201517615176152, 'f1-score': 0.43616267020561017, 'support': 46125}, '1': {'precision': 0.39482276119402987, 'recall': 0.19956621166041918, 'f1-score': 0.26512363562334595, 'support': 42417}, '2': {'precision': 0.32437112650382793, 'recall': 0.3499938537185003, 'f1-score': 0.3366957179854073, 'support': 40675}, 'accuracy': 0.3613533822948993, 'macro avg': {'precision': 0.36490673037679117, 'recall': 0.35657060896551157, 'f1-score': 0.34599400793812113, 'support': 129217}, 'weighted avg': {'precision': 0.36575793725233646, 'recall': 0.3613533822948993, 'f1-score': 0.3487068322629815, 'support': 129217}}
[[23992  7001 15132]
 [19432  8465 14520]
 [20465  5974 14236]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0994158
{'0': {'precision': 0.34372728007108816, 'recall': 0.518554627993419, 'f1-score': 0.41341786295513616, 'support': 16411}, '1': {'precision': 0.3565659587197128, 'recall': 0.15234200268387757, 'f1-score': 0.21347660622341616, 'support': 15649}, '2': {'precision': 0.32439367096340643, 'recall': 0.33707865168539325, 'f1-score': 0.3306145320963825, 'support': 15753}, 'accuracy': 0.3389036454520737, 'macro avg': {'precision': 0.3415623032514025, 'recall': 0.33599176078756327, 'f1-score': 0.3191696670916449, 'support': 47813}, 'weighted avg': {'precision': 0.34155946248798347, 'recall': 0.3389036454520737, 'f1-score': 0.32069660309667436, 'support': 47813}}
[[8510 1943 5958]
 [8164 2384 5101]
 [8084 2359 5310]]
training model: results/QRTEA/W9/deepVOL_L3/h10
Epoch 1/50
505/505 - 20s - loss: 3.2223 - accuracy10: 0.4180 - val_loss: 3.2350 - val_accuracy10: 0.7299 - 20s/epoch - 40ms/step
Epoch 2/50
505/505 - 17s - loss: 2.7818 - accuracy10: 0.4980 - val_loss: 2.5693 - val_accuracy10: 0.6360 - 17s/epoch - 35ms/step
Epoch 3/50
505/505 - 17s - loss: 2.4302 - accuracy10: 0.6359 - val_loss: 2.3883 - val_accuracy10: 0.7292 - 17s/epoch - 34ms/step
Epoch 4/50
505/505 - 17s - loss: 2.3035 - accuracy10: 0.6679 - val_loss: 2.3698 - val_accuracy10: 0.7660 - 17s/epoch - 34ms/step
Epoch 5/50
505/505 - 17s - loss: 2.2219 - accuracy10: 0.6860 - val_loss: 2.2748 - val_accuracy10: 0.7245 - 17s/epoch - 33ms/step
Epoch 6/50
505/505 - 17s - loss: 2.1744 - accuracy10: 0.7032 - val_loss: 2.2914 - val_accuracy10: 0.7686 - 17s/epoch - 33ms/step
Epoch 7/50
505/505 - 17s - loss: 2.1525 - accuracy10: 0.7058 - val_loss: 2.2558 - val_accuracy10: 0.7138 - 17s/epoch - 34ms/step
Epoch 8/50
505/505 - 17s - loss: 2.1240 - accuracy10: 0.7177 - val_loss: 2.2583 - val_accuracy10: 0.7278 - 17s/epoch - 33ms/step
Epoch 9/50
505/505 - 17s - loss: 2.0945 - accuracy10: 0.7173 - val_loss: 2.2491 - val_accuracy10: 0.7500 - 17s/epoch - 34ms/step
Epoch 10/50
505/505 - 17s - loss: 2.0832 - accuracy10: 0.7212 - val_loss: 2.3255 - val_accuracy10: 0.7641 - 17s/epoch - 34ms/step
Epoch 11/50
505/505 - 17s - loss: 2.0724 - accuracy10: 0.7232 - val_loss: 2.2797 - val_accuracy10: 0.7489 - 17s/epoch - 34ms/step
Epoch 12/50
505/505 - 17s - loss: 2.0547 - accuracy10: 0.7279 - val_loss: 2.2866 - val_accuracy10: 0.7688 - 17s/epoch - 34ms/step
Epoch 13/50
505/505 - 17s - loss: 2.0326 - accuracy10: 0.7296 - val_loss: 2.3140 - val_accuracy10: 0.7729 - 17s/epoch - 34ms/step
Epoch 14/50
505/505 - 17s - loss: 2.0178 - accuracy10: 0.7309 - val_loss: 2.2506 - val_accuracy10: 0.7803 - 17s/epoch - 34ms/step
Epoch 15/50
505/505 - 17s - loss: 2.0021 - accuracy10: 0.7312 - val_loss: 2.2660 - val_accuracy10: 0.7959 - 17s/epoch - 33ms/step
Epoch 16/50
505/505 - 17s - loss: 1.9887 - accuracy10: 0.7278 - val_loss: 2.2705 - val_accuracy10: 0.7984 - 17s/epoch - 33ms/step
Epoch 17/50
505/505 - 17s - loss: 1.9823 - accuracy10: 0.7281 - val_loss: 2.2660 - val_accuracy10: 0.7514 - 17s/epoch - 34ms/step
Epoch 18/50
505/505 - 17s - loss: 1.9744 - accuracy10: 0.7305 - val_loss: 2.2440 - val_accuracy10: 0.7639 - 17s/epoch - 34ms/step
Epoch 19/50
505/505 - 17s - loss: 1.9627 - accuracy10: 0.7312 - val_loss: 2.2660 - val_accuracy10: 0.7987 - 17s/epoch - 34ms/step
Epoch 20/50
505/505 - 17s - loss: 1.9542 - accuracy10: 0.7303 - val_loss: 2.3135 - val_accuracy10: 0.7896 - 17s/epoch - 34ms/step
Epoch 21/50
505/505 - 17s - loss: 1.9376 - accuracy10: 0.7325 - val_loss: 2.3193 - val_accuracy10: 0.8006 - 17s/epoch - 34ms/step
Epoch 22/50
505/505 - 17s - loss: 1.9353 - accuracy10: 0.7339 - val_loss: 2.2835 - val_accuracy10: 0.8095 - 17s/epoch - 34ms/step
Epoch 23/50
505/505 - 17s - loss: 1.9269 - accuracy10: 0.7321 - val_loss: 2.3420 - val_accuracy10: 0.7875 - 17s/epoch - 34ms/step
Epoch 24/50
505/505 - 17s - loss: 1.9135 - accuracy10: 0.7317 - val_loss: 2.3381 - val_accuracy10: 0.8041 - 17s/epoch - 34ms/step
Epoch 25/50
505/505 - 17s - loss: 1.9047 - accuracy10: 0.7279 - val_loss: 2.3467 - val_accuracy10: 0.7814 - 17s/epoch - 34ms/step
Epoch 26/50
505/505 - 17s - loss: 1.9036 - accuracy10: 0.7315 - val_loss: 2.3984 - val_accuracy10: 0.8081 - 17s/epoch - 33ms/step
Epoch 27/50
505/505 - 17s - loss: 1.8914 - accuracy10: 0.7324 - val_loss: 2.3684 - val_accuracy10: 0.7833 - 17s/epoch - 33ms/step
Epoch 28/50
505/505 - 17s - loss: 1.8861 - accuracy10: 0.7319 - val_loss: 2.3430 - val_accuracy10: 0.8033 - 17s/epoch - 33ms/step
testing model: results/QRTEA/W9/deepVOL_L3/h10
Evaluating performance on  test set...
1118/1118 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7241209
{'0': {'precision': 0.15834030850173383, 'recall': 0.7507653929016895, 'f1-score': 0.2615238772366394, 'support': 17638}, '1': {'precision': 0.9541936387838027, 'recall': 0.6803059242861367, 'f1-score': 0.7943025499028419, 'support': 250258}, '2': {'precision': 0.3659862252095262, 'recall': 0.4830513115382509, 'f1-score': 0.41644831574723223, 'support': 18261}, 'accuracy': 0.6720611412616151, 'macro avg': {'precision': 0.49284005749835424, 'recall': 0.6380408762420257, 'f1-score': 0.4907582476289045, 'support': 286157}, 'weighted avg': {'precision': 0.867603002808464, 'recall': 0.6720611412616151, 'f1-score': 0.7373507842692839, 'support': 286157}}
[[ 13242   2576   1820]
 [ 66545 170252  13461]
 [  3843   5597   8821]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5889993
{'0': {'precision': 0.2709668621300968, 'recall': 0.6359756748106262, 'f1-score': 0.3800204003570062, 'support': 9373}, '1': {'precision': 0.9504831303866108, 'recall': 0.8064994350282486, 'f1-score': 0.8725915928251471, 'support': 110625}, '2': {'precision': 0.37435398097520783, 'recall': 0.5421412300683371, 'f1-score': 0.4428887904297741, 'support': 9219}, 'accuracy': 0.7752695078820898, 'macro avg': {'precision': 0.5319346578306385, 'recall': 0.6615387799690707, 'f1-score': 0.5651669278706425, 'support': 129217}, 'weighted avg': {'precision': 0.860089137252642, 'recall': 0.7752695078820898, 'f1-score': 0.80620481769272, 'support': 129217}}
[[ 5961  1924  1488]
 [14541 89219  6865]
 [ 1497  2724  4998]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6033833
{'0': {'precision': 0.23632455668995164, 'recall': 0.6625489605302802, 'f1-score': 0.34838403041825095, 'support': 3319}, '1': {'precision': 0.9488027633042562, 'recall': 0.7906573972435663, 'f1-score': 0.8625410806711284, 'support': 40995}, '2': {'precision': 0.42360791532443626, 'recall': 0.526150328665333, 'f1-score': 0.46934353091140857, 'support': 3499}, 'accuracy': 0.7624077133833894, 'macro avg': {'precision': 0.536245078439548, 'recall': 0.6597855621463932, 'f1-score': 0.560089547333596, 'support': 47813}, 'weighted avg': {'precision': 0.8609109359595117, 'recall': 0.7624077133833894, 'f1-score': 0.7980756533522285, 'support': 47813}}
[[ 2199   710   410]
 [ 6487 32413  2095]
 [  619  1039  1841]]
training model: results/QRTEA/W9/deepVOL_L3/h20
Epoch 1/50
505/505 - 20s - loss: 3.0965 - accuracy20: 0.3674 - val_loss: 3.2613 - val_accuracy20: 0.7118 - 20s/epoch - 39ms/step
Epoch 2/50
505/505 - 18s - loss: 2.7734 - accuracy20: 0.4521 - val_loss: 2.6442 - val_accuracy20: 0.5968 - 18s/epoch - 36ms/step
Epoch 3/50
505/505 - 17s - loss: 2.5006 - accuracy20: 0.6105 - val_loss: 2.5766 - val_accuracy20: 0.6848 - 17s/epoch - 34ms/step
Epoch 4/50
505/505 - 18s - loss: 2.3715 - accuracy20: 0.6547 - val_loss: 2.4763 - val_accuracy20: 0.7106 - 18s/epoch - 35ms/step
Epoch 5/50
505/505 - 17s - loss: 2.3040 - accuracy20: 0.6690 - val_loss: 2.4032 - val_accuracy20: 0.7137 - 17s/epoch - 34ms/step
Epoch 6/50
505/505 - 17s - loss: 2.2577 - accuracy20: 0.6769 - val_loss: 2.3959 - val_accuracy20: 0.7325 - 17s/epoch - 34ms/step
Epoch 7/50
505/505 - 17s - loss: 2.2173 - accuracy20: 0.6879 - val_loss: 2.3987 - val_accuracy20: 0.7298 - 17s/epoch - 34ms/step
Epoch 8/50
505/505 - 17s - loss: 2.1949 - accuracy20: 0.6887 - val_loss: 2.4290 - val_accuracy20: 0.7406 - 17s/epoch - 34ms/step
Epoch 9/50
505/505 - 17s - loss: 2.1812 - accuracy20: 0.6896 - val_loss: 2.4067 - val_accuracy20: 0.7720 - 17s/epoch - 33ms/step
Epoch 10/50
505/505 - 17s - loss: 2.1517 - accuracy20: 0.6957 - val_loss: 2.4334 - val_accuracy20: 0.7880 - 17s/epoch - 34ms/step
Epoch 11/50
505/505 - 17s - loss: 2.1354 - accuracy20: 0.6968 - val_loss: 2.4197 - val_accuracy20: 0.7747 - 17s/epoch - 35ms/step
Epoch 12/50
505/505 - 17s - loss: 2.1187 - accuracy20: 0.6971 - val_loss: 2.4048 - val_accuracy20: 0.7770 - 17s/epoch - 34ms/step
Epoch 13/50
505/505 - 17s - loss: 2.1026 - accuracy20: 0.6994 - val_loss: 2.3804 - val_accuracy20: 0.7714 - 17s/epoch - 34ms/step
Epoch 14/50
505/505 - 17s - loss: 2.0913 - accuracy20: 0.6989 - val_loss: 2.3888 - val_accuracy20: 0.7726 - 17s/epoch - 34ms/step
Epoch 15/50
505/505 - 17s - loss: 2.0780 - accuracy20: 0.6972 - val_loss: 2.3768 - val_accuracy20: 0.7605 - 17s/epoch - 34ms/step
Epoch 16/50
505/505 - 17s - loss: 2.0686 - accuracy20: 0.6984 - val_loss: 2.3757 - val_accuracy20: 0.7585 - 17s/epoch - 34ms/step
Epoch 17/50
505/505 - 17s - loss: 2.0503 - accuracy20: 0.7037 - val_loss: 2.3851 - val_accuracy20: 0.7621 - 17s/epoch - 34ms/step
Epoch 18/50
505/505 - 17s - loss: 2.0385 - accuracy20: 0.7029 - val_loss: 2.3725 - val_accuracy20: 0.7665 - 17s/epoch - 34ms/step
Epoch 19/50
505/505 - 17s - loss: 2.0239 - accuracy20: 0.7042 - val_loss: 2.3972 - val_accuracy20: 0.7658 - 17s/epoch - 34ms/step
Epoch 20/50
505/505 - 17s - loss: 2.0143 - accuracy20: 0.7038 - val_loss: 2.4058 - val_accuracy20: 0.7567 - 17s/epoch - 33ms/step
Epoch 21/50
505/505 - 17s - loss: 2.0099 - accuracy20: 0.7063 - val_loss: 2.3858 - val_accuracy20: 0.7559 - 17s/epoch - 34ms/step
Epoch 22/50
505/505 - 17s - loss: 1.9956 - accuracy20: 0.7048 - val_loss: 2.4304 - val_accuracy20: 0.7344 - 17s/epoch - 33ms/step
Epoch 23/50
505/505 - 17s - loss: 1.9778 - accuracy20: 0.7095 - val_loss: 2.4227 - val_accuracy20: 0.7219 - 17s/epoch - 34ms/step
Epoch 24/50
505/505 - 17s - loss: 1.9792 - accuracy20: 0.7079 - val_loss: 2.4057 - val_accuracy20: 0.7389 - 17s/epoch - 34ms/step
Epoch 25/50
505/505 - 19s - loss: 1.9583 - accuracy20: 0.7066 - val_loss: 2.4166 - val_accuracy20: 0.7520 - 19s/epoch - 37ms/step
Epoch 26/50
505/505 - 18s - loss: 1.9532 - accuracy20: 0.7050 - val_loss: 2.4585 - val_accuracy20: 0.7404 - 18s/epoch - 36ms/step
Epoch 27/50
505/505 - 17s - loss: 1.9420 - accuracy20: 0.7068 - val_loss: 2.4498 - val_accuracy20: 0.7517 - 17s/epoch - 34ms/step
Epoch 28/50
505/505 - 17s - loss: 1.9349 - accuracy20: 0.7070 - val_loss: 2.4539 - val_accuracy20: 0.7466 - 17s/epoch - 34ms/step
testing model: results/QRTEA/W9/deepVOL_L3/h20
Evaluating performance on  test set...
1118/1118 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7172922
{'0': {'precision': 0.23452324643165187, 'recall': 0.6948600634763612, 'f1-score': 0.35068595737599195, 'support': 24261}, '1': {'precision': 0.9240798177476464, 'recall': 0.7110843577070924, 'f1-score': 0.8037097602024373, 'support': 236730}, '2': {'precision': 0.4161943319838057, 'recall': 0.5310339346737661, 'f1-score': 0.46665269921083874, 'support': 25166}, 'accuracy': 0.6938743417075242, 'macro avg': {'precision': 0.5249324653877013, 'recall': 0.6456594519524067, 'f1-score': 0.5403494722630894, 'support': 286157}, 'weighted avg': {'precision': 0.8209518910800123, 'recall': 0.6938743417075242, 'f1-score': 0.735659045114961, 'support': 286157}}
[[ 16858   5337   2066]
 [ 51715 168335  16680]
 [  3309   8493  13364]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6280806
{'0': {'precision': 0.3779019115461487, 'recall': 0.5736735646491364, 'f1-score': 0.4556492724070813, 'support': 12854}, '1': {'precision': 0.9156738746835305, 'recall': 0.8054197877201608, 'f1-score': 0.8570153663090084, 'support': 103731}, '2': {'precision': 0.3977685099929589, 'recall': 0.5813806206459785, 'f1-score': 0.47235890014471776, 'support': 12632}, 'accuracy': 0.7604649543016786, 'macro avg': {'precision': 0.5637814320742127, 'recall': 0.6534913243384253, 'f1-score': 0.5950078462869358, 'support': 129217}, 'weighted avg': {'precision': 0.8115490197423137, 'recall': 0.7604649543016786, 'f1-score': 0.7794857823409339, 'support': 129217}}
[[ 7374  3785  1695]
 [10760 83547  9424]
 [ 1379  3909  7344]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61301595
{'0': {'precision': 0.3353931903550224, 'recall': 0.5991341991341992, 'f1-score': 0.430047386001709, 'support': 4620}, '1': {'precision': 0.9100596884553792, 'recall': 0.8139583333333333, 'f1-score': 0.8593305381813183, 'support': 38400}, '2': {'precision': 0.49165867689357623, 'recall': 0.5349467974128937, 'f1-score': 0.5123900879296561, 'support': 4793}, 'accuracy': 0.765231213268358, 'macro avg': {'precision': 0.5790371852346593, 'recall': 0.6493464432934754, 'f1-score': 0.6005893373708945, 'support': 47813}, 'weighted avg': {'precision': 0.8125892249906443, 'recall': 0.765231213268358, 'f1-score': 0.7830714927098773, 'support': 47813}}
[[ 2768  1461   391]
 [ 4884 31256  2260]
 [  601  1628  2564]]
training model: results/QRTEA/W9/deepVOL_L3/h30
Epoch 1/50
505/505 - 20s - loss: 3.1439 - accuracy30: 0.3796 - val_loss: 3.4278 - val_accuracy30: 0.7222 - 20s/epoch - 40ms/step
Epoch 2/50
505/505 - 17s - loss: 2.8734 - accuracy30: 0.3992 - val_loss: 2.8300 - val_accuracy30: 0.6569 - 17s/epoch - 34ms/step
Epoch 3/50
505/505 - 17s - loss: 2.6547 - accuracy30: 0.5391 - val_loss: 2.6809 - val_accuracy30: 0.6056 - 17s/epoch - 34ms/step
Epoch 4/50
505/505 - 17s - loss: 2.5142 - accuracy30: 0.6077 - val_loss: 2.6262 - val_accuracy30: 0.6290 - 17s/epoch - 35ms/step
Epoch 5/50
505/505 - 17s - loss: 2.4349 - accuracy30: 0.6394 - val_loss: 2.6192 - val_accuracy30: 0.6432 - 17s/epoch - 34ms/step
Epoch 6/50
505/505 - 17s - loss: 2.3706 - accuracy30: 0.6497 - val_loss: 2.5740 - val_accuracy30: 0.6514 - 17s/epoch - 34ms/step
Epoch 7/50
505/505 - 17s - loss: 2.3333 - accuracy30: 0.6567 - val_loss: 2.5445 - val_accuracy30: 0.6834 - 17s/epoch - 34ms/step
Epoch 8/50
505/505 - 17s - loss: 2.3062 - accuracy30: 0.6564 - val_loss: 2.5112 - val_accuracy30: 0.7143 - 17s/epoch - 35ms/step
Epoch 9/50
505/505 - 17s - loss: 2.2715 - accuracy30: 0.6647 - val_loss: 2.4881 - val_accuracy30: 0.7045 - 17s/epoch - 34ms/step
Epoch 10/50
505/505 - 17s - loss: 2.2515 - accuracy30: 0.6652 - val_loss: 2.4707 - val_accuracy30: 0.7239 - 17s/epoch - 34ms/step
Epoch 11/50
505/505 - 17s - loss: 2.2363 - accuracy30: 0.6687 - val_loss: 2.4381 - val_accuracy30: 0.7226 - 17s/epoch - 34ms/step
Epoch 12/50
505/505 - 18s - loss: 2.2282 - accuracy30: 0.6715 - val_loss: 2.4414 - val_accuracy30: 0.6977 - 18s/epoch - 35ms/step
Epoch 13/50
505/505 - 17s - loss: 2.2108 - accuracy30: 0.6711 - val_loss: 2.4551 - val_accuracy30: 0.6903 - 17s/epoch - 34ms/step
Epoch 14/50
505/505 - 17s - loss: 2.1907 - accuracy30: 0.6766 - val_loss: 2.4911 - val_accuracy30: 0.7152 - 17s/epoch - 34ms/step
Epoch 15/50
505/505 - 17s - loss: 2.1748 - accuracy30: 0.6774 - val_loss: 2.4719 - val_accuracy30: 0.7057 - 17s/epoch - 33ms/step
Epoch 16/50
505/505 - 17s - loss: 2.1626 - accuracy30: 0.6784 - val_loss: 2.4969 - val_accuracy30: 0.7122 - 17s/epoch - 34ms/step
Epoch 17/50
505/505 - 17s - loss: 2.1590 - accuracy30: 0.6756 - val_loss: 2.4921 - val_accuracy30: 0.7046 - 17s/epoch - 34ms/step
Epoch 18/50
505/505 - 17s - loss: 2.1401 - accuracy30: 0.6785 - val_loss: 2.5101 - val_accuracy30: 0.6900 - 17s/epoch - 34ms/step
Epoch 19/50
505/505 - 17s - loss: 2.1311 - accuracy30: 0.6785 - val_loss: 2.5226 - val_accuracy30: 0.7037 - 17s/epoch - 34ms/step
Epoch 20/50
505/505 - 17s - loss: 2.1129 - accuracy30: 0.6785 - val_loss: 2.5220 - val_accuracy30: 0.7033 - 17s/epoch - 34ms/step
Epoch 21/50
505/505 - 17s - loss: 2.0991 - accuracy30: 0.6788 - val_loss: 2.5305 - val_accuracy30: 0.6918 - 17s/epoch - 34ms/step
testing model: results/QRTEA/W9/deepVOL_L3/h30
Evaluating performance on  test set...
1118/1118 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7926008
{'0': {'precision': 0.26750444242741905, 'recall': 0.7046878157203476, 'f1-score': 0.387798029967475, 'support': 29694}, '1': {'precision': 0.8949516711307791, 'recall': 0.681449986033953, 'f1-score': 0.7737429112958643, 'support': 225547}, '2': {'precision': 0.4344919047355915, 'recall': 0.5086686505369388, 'f1-score': 0.4686633884666965, 'support': 30916}, 'accuracy': 0.6651942814608763, 'macro avg': {'precision': 0.5323160060979298, 'recall': 0.6316021507637464, 'f1-score': 0.5434014432433453, 'support': 286157}, 'weighted avg': {'precision': 0.780095168766723, 'recall': 0.6651942814608763, 'f1-score': 0.7007337385901408, 'support': 286157}}
[[ 20925   7091   1678]
 [ 53058 153699  18790]
 [  4240  10950  15726]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.692274
{'0': {'precision': 0.4024466470220555, 'recall': 0.579566643091365, 'f1-score': 0.4750335959526758, 'support': 15553}, '1': {'precision': 0.8822061392563014, 'recall': 0.7909886086248983, 'f1-score': 0.834110921629825, 'support': 98320}, '2': {'precision': 0.4450575944280739, 'recall': 0.5413842544316997, 'f1-score': 0.48851774530271397, 'support': 15344}, 'accuracy': 0.7359016228514824, 'macro avg': {'precision': 0.5765701269021436, 'recall': 0.6373131687159876, 'f1-score': 0.5992207542950716, 'support': 129217}, 'weighted avg': {'precision': 0.7725510114127239, 'recall': 0.7359016228514824, 'f1-score': 0.7498533445012746, 'support': 129217}}
[[ 9014  5036  1503]
 [11695 77770  8855]
 [ 1689  5348  8307]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70699424
{'0': {'precision': 0.35329218106995885, 'recall': 0.6054301833568406, 'f1-score': 0.4462058212058212, 'support': 5672}, '1': {'precision': 0.874463287307324, 'recall': 0.7784254956416532, 'f1-score': 0.8236543497235962, 'support': 36367}, '2': {'precision': 0.4993006993006993, 'recall': 0.49463110495323864, 'f1-score': 0.49695493300852617, 'support': 5774}, 'accuracy': 0.7236316482964884, 'macro avg': {'precision': 0.5756853892259941, 'recall': 0.6261622613172442, 'f1-score': 0.5889383679793144, 'support': 47813}, 'weighted avg': {'precision': 0.7673319360487002, 'recall': 0.7236316482964884, 'f1-score': 0.7394251550304032, 'support': 47813}}
[[ 3434  1890   348]
 [ 5542 28309  2516]
 [  744  2174  2856]]
training model: results/QRTEA/W9/deepVOL_L3/h50
Epoch 1/50
505/505 - 21s - loss: 3.1450 - accuracy50: 0.3788 - val_loss: 3.5839 - val_accuracy50: 0.6748 - 21s/epoch - 41ms/step
Epoch 2/50
505/505 - 18s - loss: 2.9794 - accuracy50: 0.3686 - val_loss: 3.2767 - val_accuracy50: 0.6179 - 18s/epoch - 35ms/step
Epoch 3/50
505/505 - 18s - loss: 2.9093 - accuracy50: 0.3946 - val_loss: 2.9869 - val_accuracy50: 0.6034 - 18s/epoch - 35ms/step
Epoch 4/50
505/505 - 18s - loss: 2.7442 - accuracy50: 0.5263 - val_loss: 2.8591 - val_accuracy50: 0.5998 - 18s/epoch - 35ms/step
Epoch 5/50
505/505 - 18s - loss: 2.6554 - accuracy50: 0.5759 - val_loss: 2.8460 - val_accuracy50: 0.6147 - 18s/epoch - 35ms/step
Epoch 6/50
505/505 - 17s - loss: 2.5910 - accuracy50: 0.5917 - val_loss: 2.8061 - val_accuracy50: 0.6468 - 17s/epoch - 34ms/step
Epoch 7/50
505/505 - 17s - loss: 2.5467 - accuracy50: 0.6031 - val_loss: 2.7828 - val_accuracy50: 0.6685 - 17s/epoch - 34ms/step
Epoch 8/50
505/505 - 17s - loss: 2.5147 - accuracy50: 0.6093 - val_loss: 2.7906 - val_accuracy50: 0.6547 - 17s/epoch - 34ms/step
Epoch 9/50
505/505 - 18s - loss: 2.4806 - accuracy50: 0.6145 - val_loss: 2.7568 - val_accuracy50: 0.6749 - 18s/epoch - 36ms/step
Epoch 10/50
505/505 - 17s - loss: 2.4594 - accuracy50: 0.6177 - val_loss: 2.7736 - val_accuracy50: 0.6763 - 17s/epoch - 34ms/step
Epoch 11/50
505/505 - 17s - loss: 2.4361 - accuracy50: 0.6186 - val_loss: 2.7727 - val_accuracy50: 0.6746 - 17s/epoch - 34ms/step
Epoch 12/50
505/505 - 17s - loss: 2.4088 - accuracy50: 0.6234 - val_loss: 2.7968 - val_accuracy50: 0.6793 - 17s/epoch - 34ms/step
Epoch 13/50
505/505 - 17s - loss: 2.3895 - accuracy50: 0.6288 - val_loss: 2.7994 - val_accuracy50: 0.6897 - 17s/epoch - 34ms/step
Epoch 14/50
505/505 - 17s - loss: 2.3691 - accuracy50: 0.6298 - val_loss: 2.8315 - val_accuracy50: 0.6882 - 17s/epoch - 34ms/step
Epoch 15/50
505/505 - 17s - loss: 2.3558 - accuracy50: 0.6323 - val_loss: 2.8787 - val_accuracy50: 0.7020 - 17s/epoch - 34ms/step
Epoch 16/50
505/505 - 17s - loss: 2.3457 - accuracy50: 0.6295 - val_loss: 2.8346 - val_accuracy50: 0.6964 - 17s/epoch - 34ms/step
Epoch 17/50
505/505 - 17s - loss: 2.3273 - accuracy50: 0.6345 - val_loss: 2.8481 - val_accuracy50: 0.6786 - 17s/epoch - 34ms/step
Epoch 18/50
505/505 - 17s - loss: 2.3103 - accuracy50: 0.6349 - val_loss: 2.8530 - val_accuracy50: 0.6758 - 17s/epoch - 34ms/step
Epoch 19/50
505/505 - 17s - loss: 2.2942 - accuracy50: 0.6375 - val_loss: 2.8816 - val_accuracy50: 0.6729 - 17s/epoch - 34ms/step
testing model: results/QRTEA/W9/deepVOL_L3/h50
Evaluating performance on  test set...
1118/1118 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8285401
{'0': {'precision': 0.32262716819333465, 'recall': 0.6245378404889459, 'f1-score': 0.4254651999588774, 'support': 39759}, '1': {'precision': 0.8156491228070175, 'recall': 0.6809121398966007, 'f1-score': 0.7422153752823698, 'support': 204837}, '2': {'precision': 0.47145999162128194, 'recall': 0.43324270349606603, 'f1-score': 0.4515441425400925, 'support': 41561}, 'accuracy': 0.6371083006880838, 'macro avg': {'precision': 0.536578760873878, 'recall': 0.5795642279605375, 'f1-score': 0.5397415725937799, 'support': 286157}, 'weighted avg': {'precision': 0.6971585586247827, 'recall': 0.6371083006880838, 'f1-score': 0.6559890822869564, 'support': 286157}}
[[ 24831  12364   2564]
 [ 47739 139476  17622]
 [  4395  19160  18006]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7373581
{'0': {'precision': 0.4559599391934186, 'recall': 0.4989969173557763, 'f1-score': 0.47650865593533165, 'support': 20437}, '1': {'precision': 0.8027808186712111, 'recall': 0.8009638771281866, 'f1-score': 0.8018713186596398, 'support': 88808}, '2': {'precision': 0.4894759921069941, 'recall': 0.4471259763669137, 'f1-score': 0.46734352103830856, 'support': 19972}, 'accuracy': 0.698514901290078, 'macro avg': {'precision': 0.5827389166572079, 'recall': 0.5823622569502922, 'f1-score': 0.5819078318777601, 'support': 129217}, 'weighted avg': {'precision': 0.6995025943661415, 'recall': 0.698514901290078, 'f1-score': 0.6987066738204165, 'support': 129217}}
[[10198  8237  2002]
 [10364 71132  7312]
 [ 1804  9238  8930]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7654302
{'0': {'precision': 0.3815073815073815, 'recall': 0.526824034334764, 'f1-score': 0.44254168544389366, 'support': 7456}, '1': {'precision': 0.7902095714732562, 'recall': 0.769884805266045, 'f1-score': 0.7799147937762411, 'support': 32814}, '2': {'precision': 0.5597620335316387, 'recall': 0.4116399310619117, 'f1-score': 0.4744079449961803, 'support': 7543}, 'accuracy': 0.6754648317403217, 'macro avg': {'precision': 0.5771596621707588, 'recall': 0.5694495902209069, 'f1-score': 0.5656214747387717, 'support': 47813}, 'weighted avg': {'precision': 0.6901206980062246, 'recall': 0.6754648317403217, 'f1-score': 0.6791076481030145, 'support': 47813}}
[[ 3928  3061   467]
 [ 5576 25263  1975]
 [  792  3646  3105]]
training model: results/QRTEA/W9/deepVOL_L3/h100
Epoch 1/50
505/505 - 20s - loss: 3.2601 - accuracy100: 0.3916 - val_loss: 3.5356 - val_accuracy100: 0.5426 - 20s/epoch - 40ms/step
Epoch 2/50
505/505 - 18s - loss: 3.1213 - accuracy100: 0.3962 - val_loss: 3.2922 - val_accuracy100: 0.5330 - 18s/epoch - 35ms/step
Epoch 3/50
505/505 - 17s - loss: 3.0291 - accuracy100: 0.4479 - val_loss: 3.1531 - val_accuracy100: 0.5179 - 17s/epoch - 34ms/step
Epoch 4/50
505/505 - 18s - loss: 2.9751 - accuracy100: 0.4854 - val_loss: 3.0997 - val_accuracy100: 0.5184 - 18s/epoch - 35ms/step
Epoch 5/50
505/505 - 17s - loss: 2.9236 - accuracy100: 0.5082 - val_loss: 3.0667 - val_accuracy100: 0.5229 - 17s/epoch - 34ms/step
Epoch 6/50
505/505 - 17s - loss: 2.8834 - accuracy100: 0.5252 - val_loss: 3.0758 - val_accuracy100: 0.5459 - 17s/epoch - 35ms/step
Epoch 7/50
505/505 - 18s - loss: 2.8576 - accuracy100: 0.5311 - val_loss: 3.0891 - val_accuracy100: 0.5362 - 18s/epoch - 35ms/step
Epoch 8/50
505/505 - 17s - loss: 2.8265 - accuracy100: 0.5401 - val_loss: 3.1022 - val_accuracy100: 0.5465 - 17s/epoch - 34ms/step
Epoch 9/50
505/505 - 17s - loss: 2.8072 - accuracy100: 0.5449 - val_loss: 3.1045 - val_accuracy100: 0.5330 - 17s/epoch - 34ms/step
Epoch 10/50
505/505 - 17s - loss: 2.7874 - accuracy100: 0.5440 - val_loss: 3.1205 - val_accuracy100: 0.5368 - 17s/epoch - 34ms/step
Epoch 11/50
505/505 - 17s - loss: 2.7713 - accuracy100: 0.5508 - val_loss: 3.0870 - val_accuracy100: 0.5580 - 17s/epoch - 34ms/step
Epoch 12/50
505/505 - 19s - loss: 2.7491 - accuracy100: 0.5557 - val_loss: 3.0760 - val_accuracy100: 0.5595 - 19s/epoch - 37ms/step
Epoch 13/50
505/505 - 17s - loss: 2.7325 - accuracy100: 0.5584 - val_loss: 3.0503 - val_accuracy100: 0.5570 - 17s/epoch - 34ms/step
Epoch 14/50
505/505 - 17s - loss: 2.7169 - accuracy100: 0.5630 - val_loss: 3.0571 - val_accuracy100: 0.5533 - 17s/epoch - 35ms/step
Epoch 15/50
505/505 - 17s - loss: 2.6971 - accuracy100: 0.5673 - val_loss: 3.1105 - val_accuracy100: 0.5625 - 17s/epoch - 34ms/step
Epoch 16/50
505/505 - 17s - loss: 2.6869 - accuracy100: 0.5682 - val_loss: 3.0898 - val_accuracy100: 0.5722 - 17s/epoch - 35ms/step
Epoch 17/50
505/505 - 17s - loss: 2.6660 - accuracy100: 0.5717 - val_loss: 3.1099 - val_accuracy100: 0.5566 - 17s/epoch - 34ms/step
Epoch 18/50
505/505 - 17s - loss: 2.6446 - accuracy100: 0.5760 - val_loss: 3.1303 - val_accuracy100: 0.5596 - 17s/epoch - 34ms/step
Epoch 19/50
505/505 - 17s - loss: 2.6267 - accuracy100: 0.5761 - val_loss: 3.1473 - val_accuracy100: 0.5537 - 17s/epoch - 34ms/step
Epoch 20/50
505/505 - 17s - loss: 2.6036 - accuracy100: 0.5818 - val_loss: 3.1753 - val_accuracy100: 0.5614 - 17s/epoch - 35ms/step
Epoch 21/50
505/505 - 17s - loss: 2.5924 - accuracy100: 0.5822 - val_loss: 3.2069 - val_accuracy100: 0.5539 - 17s/epoch - 34ms/step
Epoch 22/50
505/505 - 17s - loss: 2.5759 - accuracy100: 0.5837 - val_loss: 3.2377 - val_accuracy100: 0.5521 - 17s/epoch - 34ms/step
Epoch 23/50
505/505 - 17s - loss: 2.5576 - accuracy100: 0.5868 - val_loss: 3.2798 - val_accuracy100: 0.5505 - 17s/epoch - 34ms/step
testing model: results/QRTEA/W9/deepVOL_L3/h100
Evaluating performance on  test set...
1118/1118 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9690118
{'0': {'precision': 0.38680765357502517, 'recall': 0.4489247311827957, 'f1-score': 0.4155577193551877, 'support': 59892}, '1': {'precision': 0.6588376888913914, 'recall': 0.571726105040708, 'f1-score': 0.6121985834156295, 'support': 163727}, '2': {'precision': 0.3868147194507027, 'recall': 0.46122357606575204, 'f1-score': 0.4207547445042522, 'support': 62538}, 'accuracy': 0.5218743556858647, 'macro avg': {'precision': 0.4774866873057064, 'recall': 0.49395813742975186, 'f1-score': 0.4828370157583565, 'support': 286157}, 'weighted avg': {'precision': 0.54245334275256, 'recall': 0.5218743556858647, 'f1-score': 0.5292031318692836, 'support': 286157}}
[[26887 22967 10038]
 [34434 93607 35686]
 [ 8189 25505 28844]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9214134
{'0': {'precision': 0.46755869729866195, 'recall': 0.37842255823457294, 'f1-score': 0.4182947487295313, 'support': 29364}, '1': {'precision': 0.6751839219776193, 'recall': 0.6682428756747709, 'f1-score': 0.671695467769638, 'support': 71691}, '2': {'precision': 0.396730150447865, 'recall': 0.48597400752787445, 'f1-score': 0.4368406773169058, 'support': 28162}, 'accuracy': 0.5626581641734447, 'macro avg': {'precision': 0.5131575899080488, 'recall': 0.5108798138124061, 'f1-score': 0.508943631272025, 'support': 129217}, 'weighted avg': {'precision': 0.5673148164319569, 'recall': 0.5626581641734447, 'f1-score': 0.5629261934278444, 'support': 129217}}
[[11112 12474  5778]
 [ 8751 47907 15033]
 [ 3903 10573 13686]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.93623286
{'0': {'precision': 0.41108691707494105, 'recall': 0.4207056638811513, 'f1-score': 0.4158406754772393, 'support': 10770}, '1': {'precision': 0.6620366875518986, 'recall': 0.665907365223994, 'f1-score': 0.6639663852822046, 'support': 26340}, '2': {'precision': 0.4417791589783432, 'recall': 0.4250210221433243, 'f1-score': 0.43323809523809526, 'support': 10703}, 'accuracy': 0.5567523476878673, 'macro avg': {'precision': 0.5049675878683942, 'recall': 0.5038780170828232, 'f1-score': 0.504348385332513, 'support': 47813}, 'weighted avg': {'precision': 0.5562046887992667, 'recall': 0.5567523476878673, 'f1-score': 0.556426620303191, 'support': 47813}}
[[ 4531  4565  1674]
 [ 4726 17540  4074]
 [ 1765  4389  4549]]
training model: results/QRTEA/W9/deepVOL_L3/h200
Epoch 1/50
505/505 - 20s - loss: 3.2852 - accuracy200: 0.3867 - val_loss: 3.5978 - val_accuracy200: 0.4215 - 20s/epoch - 40ms/step
Epoch 2/50
505/505 - 18s - loss: 3.2222 - accuracy200: 0.3907 - val_loss: 3.5715 - val_accuracy200: 0.4214 - 18s/epoch - 35ms/step
Epoch 3/50
505/505 - 18s - loss: 3.1797 - accuracy200: 0.4106 - val_loss: 3.4140 - val_accuracy200: 0.4357 - 18s/epoch - 35ms/step
Epoch 4/50
505/505 - 18s - loss: 3.1329 - accuracy200: 0.4397 - val_loss: 3.3333 - val_accuracy200: 0.4285 - 18s/epoch - 35ms/step
Epoch 5/50
505/505 - 19s - loss: 3.1048 - accuracy200: 0.4533 - val_loss: 3.3350 - val_accuracy200: 0.4377 - 19s/epoch - 38ms/step
Epoch 6/50
505/505 - 18s - loss: 3.0743 - accuracy200: 0.4657 - val_loss: 3.3284 - val_accuracy200: 0.4409 - 18s/epoch - 35ms/step
Epoch 7/50
505/505 - 19s - loss: 3.0471 - accuracy200: 0.4774 - val_loss: 3.3424 - val_accuracy200: 0.4450 - 19s/epoch - 37ms/step
Epoch 8/50
505/505 - 18s - loss: 3.0200 - accuracy200: 0.4855 - val_loss: 3.3407 - val_accuracy200: 0.4468 - 18s/epoch - 36ms/step
Epoch 9/50
505/505 - 19s - loss: 2.9977 - accuracy200: 0.4937 - val_loss: 3.3955 - val_accuracy200: 0.4538 - 19s/epoch - 38ms/step
Epoch 10/50
505/505 - 19s - loss: 2.9740 - accuracy200: 0.5007 - val_loss: 3.4107 - val_accuracy200: 0.4431 - 19s/epoch - 38ms/step
Epoch 11/50
505/505 - 19s - loss: 2.9472 - accuracy200: 0.5066 - val_loss: 3.4626 - val_accuracy200: 0.4427 - 19s/epoch - 38ms/step
Epoch 12/50
505/505 - 19s - loss: 2.9197 - accuracy200: 0.5155 - val_loss: 3.4346 - val_accuracy200: 0.4430 - 19s/epoch - 38ms/step
Epoch 13/50
505/505 - 17s - loss: 2.8877 - accuracy200: 0.5219 - val_loss: 3.4679 - val_accuracy200: 0.4463 - 17s/epoch - 35ms/step
Epoch 14/50
505/505 - 18s - loss: 2.8633 - accuracy200: 0.5282 - val_loss: 3.4753 - val_accuracy200: 0.4367 - 18s/epoch - 35ms/step
Epoch 15/50
505/505 - 17s - loss: 2.8340 - accuracy200: 0.5330 - val_loss: 3.5266 - val_accuracy200: 0.4308 - 17s/epoch - 34ms/step
Epoch 16/50
505/505 - 18s - loss: 2.8073 - accuracy200: 0.5395 - val_loss: 3.6429 - val_accuracy200: 0.4222 - 18s/epoch - 36ms/step
testing model: results/QRTEA/W9/deepVOL_L3/h200
Evaluating performance on  test set...
1118/1118 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0647628
{'0': {'precision': 0.3324916191388393, 'recall': 0.09716532227283137, 'f1-score': 0.1503834907007197, 'support': 78598}, '1': {'precision': 0.47609087086374763, 'recall': 0.6972422015016698, 'f1-score': 0.5658250921823593, 'support': 126659}, '2': {'precision': 0.3702731227636626, 'recall': 0.35559950556242276, 'f1-score': 0.3627879995460106, 'support': 80900}, 'accuracy': 0.4358341749459213, 'macro avg': {'precision': 0.39295187092208317, 'recall': 0.3833356764456413, 'f1-score': 0.3596655274763632, 'support': 286157}, 'weighted avg': {'precision': 0.40673289671539126, 'recall': 0.4358341749459213, 'f1-score': 0.39431581654858305, 'support': 286157}}
[[ 7637 50468 20493]
 [ 9914 88312 28433]
 [ 5418 46714 28768]]
Evaluating performance on  train set...
505/505 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0442047
{'0': {'precision': 0.4711644422676625, 'recall': 0.09920082495488527, 'f1-score': 0.16389462699916946, 'support': 38790}, '1': {'precision': 0.47770376538070125, 'recall': 0.760204644999816, 'f1-score': 0.5867196932036077, 'support': 54338}, '2': {'precision': 0.39987853548499047, 'recall': 0.38313613566460697, 'f1-score': 0.3913283427908359, 'support': 36089}, 'accuracy': 0.45646470665624495, 'macro avg': {'precision': 0.44958224771111804, 'recall': 0.41418053520643605, 'f1-score': 0.3806475543312044, 'support': 129217}, 'weighted avg': {'precision': 0.45400490946188965, 'recall': 0.45646470665624495, 'f1-score': 0.4052198691625242, 'support': 129217}}
[[ 3848 25025  9917]
 [ 2196 41308 10834]
 [ 2123 20139 13827]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0595766
{'0': {'precision': 0.42547770700636944, 'recall': 0.11861637900419064, 'f1-score': 0.18551433014885582, 'support': 14079}, '1': {'precision': 0.45753547423450336, 'recall': 0.7596091851411, 'f1-score': 0.5710876617323539, 'support': 20163}, '2': {'precision': 0.3787573225775473, 'recall': 0.29061970378011936, 'f1-score': 0.32888592394929955, 'support': 13571}, 'accuracy': 0.43774705623993476, 'macro avg': {'precision': 0.4205901679394734, 'recall': 0.38961508930847, 'f1-score': 0.36182930527683643, 'support': 47813}, 'weighted avg': {'precision': 0.42573576283924586, 'recall': 0.43774705623993476, 'f1-score': 0.3888065515987522, 'support': 47813}}
[[ 1670  9456  2953]
 [ 1331 15316  3516]
 [  924  8703  3944]]
training model: results/QRTEA/W9/deepVOL_L3/h300
Epoch 1/50
505/505 - 21s - loss: 3.2936 - accuracy300: 0.3854 - val_loss: 3.6335 - val_accuracy300: 0.3640 - 21s/epoch - 41ms/step
Epoch 2/50
505/505 - 18s - loss: 3.2550 - accuracy300: 0.4003 - val_loss: 3.4739 - val_accuracy300: 0.3657 - 18s/epoch - 35ms/step
Epoch 3/50
505/505 - 18s - loss: 3.2231 - accuracy300: 0.4122 - val_loss: 3.4392 - val_accuracy300: 0.3782 - 18s/epoch - 35ms/step
Epoch 4/50
505/505 - 18s - loss: 3.2064 - accuracy300: 0.4181 - val_loss: 3.3642 - val_accuracy300: 0.3809 - 18s/epoch - 36ms/step
Epoch 5/50
505/505 - 18s - loss: 3.1683 - accuracy300: 0.4401 - val_loss: 3.4336 - val_accuracy300: 0.3739 - 18s/epoch - 37ms/step
Epoch 6/50
505/505 - 18s - loss: 3.1461 - accuracy300: 0.4465 - val_loss: 3.3582 - val_accuracy300: 0.3725 - 18s/epoch - 35ms/step
Epoch 7/50
505/505 - 18s - loss: 3.1185 - accuracy300: 0.4551 - val_loss: 3.3326 - val_accuracy300: 0.3922 - 18s/epoch - 35ms/step
Epoch 8/50
505/505 - 17s - loss: 3.0969 - accuracy300: 0.4654 - val_loss: 3.3913 - val_accuracy300: 0.3869 - 17s/epoch - 34ms/step
Epoch 9/50
505/505 - 17s - loss: 3.0965 - accuracy300: 0.4646 - val_loss: 3.3369 - val_accuracy300: 0.3922 - 17s/epoch - 34ms/step
Epoch 10/50
505/505 - 18s - loss: 3.0582 - accuracy300: 0.4763 - val_loss: 3.4297 - val_accuracy300: 0.3898 - 18s/epoch - 35ms/step
Epoch 11/50
505/505 - 17s - loss: 3.0338 - accuracy300: 0.4839 - val_loss: 3.4637 - val_accuracy300: 0.3846 - 17s/epoch - 34ms/step
Epoch 12/50
505/505 - 17s - loss: 3.0009 - accuracy300: 0.4936 - val_loss: 3.5496 - val_accuracy300: 0.3796 - 17s/epoch - 34ms/step
Epoch 13/50
505/505 - 17s - loss: 2.9793 - accuracy300: 0.5014 - val_loss: 3.6007 - val_accuracy300: 0.3745 - 17s/epoch - 34ms/step
Epoch 14/50
505/505 - 17s - loss: 2.9561 - accuracy300: 0.5099 - val_loss: 3.5873 - val_accuracy300: 0.3812 - 17s/epoch - 33ms/step
Epoch 15/50
505/505 - 17s - loss: 2.9072 - accuracy300: 0.5206 - val_loss: 3.6595 - val_accuracy300: 0.3774 - 17s/epoch - 34ms/step
Epoch 16/50
505/505 - 17s - loss: 2.8861 - accuracy300: 0.5255 - val_loss: 3.6729 - val_accuracy300: 0.3807 - 17s/epoch - 34ms/step
Epoch 17/50
505/505 - 17s - loss: 2.8637 - accuracy300: 0.5311 - val_loss: 3.7432 - val_accuracy300: 0.3811 - 17s/epoch - 34ms/step
testing model: results/QRTEA/W9/deepVOL_L3/h300
Evaluating performance on  test set...
1118/1118 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979843
{'0': {'precision': 0.32372458080627897, 'recall': 0.10461027657047993, 'f1-score': 0.15812356780022827, 'support': 86741}, '1': {'precision': 0.4212282551043016, 'recall': 0.5653893985545122, 'f1-score': 0.48277666414014136, 'support': 110966}, '2': {'precision': 0.36482451641266117, 'recall': 0.4503448275862069, 'f1-score': 0.4030986571136545, 'support': 88450}, 'accuracy': 0.39015645257673237, 'macro avg': {'precision': 0.36992578410774724, 'recall': 0.3734481675703997, 'f1-score': 0.34799962968467474, 'support': 286157}, 'weighted avg': {'precision': 0.3742383967413736, 'recall': 0.39015645257673237, 'f1-score': 0.35973842306579, 'support': 286157}}
[[ 9074 45565 32102]
 [10978 62739 37249]
 [ 7978 40639 39833]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0717833
{'0': {'precision': 0.4703873778405746, 'recall': 0.092410538733779, 'f1-score': 0.15447374526332067, 'support': 43231}, '1': {'precision': 0.43026680145927654, 'recall': 0.626496, 'f1-score': 0.5101626016260162, 'support': 46875}, '2': {'precision': 0.3978769224905186, 'recall': 0.5337884482626372, 'f1-score': 0.45591928544910576, 'support': 39111}, 'accuracy': 0.41975127111757743, 'macro avg': {'precision': 0.43284370059678995, 'recall': 0.41756499566547206, 'f1-score': 0.3735185441128142, 'support': 129217}, 'weighted avg': {'precision': 0.43388592341066684, 'recall': 0.41975127111757743, 'f1-score': 0.3747446977247429, 'support': 129217}}
[[ 3995 22708 16528]
 [ 2442 29367 15066]
 [ 2056 16178 20877]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1015507
{'0': {'precision': 0.42105263157894735, 'recall': 0.10276271624064033, 'f1-score': 0.1652052093602449, 'support': 15492}, '1': {'precision': 0.40288662993714597, 'recall': 0.5986739694436437, 'f1-score': 0.48164382290869456, 'support': 17345}, '2': {'precision': 0.3637857377587907, 'recall': 0.44350961538461536, 'f1-score': 0.3997111391948005, 'support': 14976}, 'accuracy': 0.38939200635810345, 'macro avg': {'precision': 0.395908333091628, 'recall': 0.38164876702296646, 'f1-score': 0.34885339048791336, 'support': 47813}, 'weighted avg': {'precision': 0.39652544649690463, 'recall': 0.38939200635810345, 'f1-score': 0.35345084458916093, 'support': 47813}}
[[ 1592  8116  5784]
 [ 1129 10384  5832]
 [ 1060  7274  6642]]
training model: results/QRTEA/W9/deepVOL_L3/h500
Epoch 1/50
505/505 - 20s - loss: 3.3097 - accuracy500: 0.3717 - val_loss: 3.5826 - val_accuracy500: 0.3164 - 20s/epoch - 40ms/step
Epoch 2/50
505/505 - 18s - loss: 3.2919 - accuracy500: 0.3724 - val_loss: 3.3958 - val_accuracy500: 0.3191 - 18s/epoch - 35ms/step
Epoch 3/50
505/505 - 18s - loss: 3.2725 - accuracy500: 0.3745 - val_loss: 3.3214 - val_accuracy500: 0.3428 - 18s/epoch - 35ms/step
Epoch 4/50
505/505 - 17s - loss: 3.2532 - accuracy500: 0.3903 - val_loss: 3.3861 - val_accuracy500: 0.3354 - 17s/epoch - 34ms/step
Epoch 5/50
505/505 - 17s - loss: 3.2349 - accuracy500: 0.4068 - val_loss: 3.3183 - val_accuracy500: 0.3620 - 17s/epoch - 35ms/step
Epoch 6/50
505/505 - 18s - loss: 3.2100 - accuracy500: 0.4251 - val_loss: 3.3461 - val_accuracy500: 0.3585 - 18s/epoch - 35ms/step
Epoch 7/50
505/505 - 17s - loss: 3.2020 - accuracy500: 0.4272 - val_loss: 3.3647 - val_accuracy500: 0.3538 - 17s/epoch - 35ms/step
Epoch 8/50
505/505 - 17s - loss: 3.2027 - accuracy500: 0.4248 - val_loss: 3.3462 - val_accuracy500: 0.3633 - 17s/epoch - 34ms/step
Epoch 9/50
505/505 - 18s - loss: 3.1604 - accuracy500: 0.4448 - val_loss: 3.3851 - val_accuracy500: 0.3576 - 18s/epoch - 35ms/step
Epoch 10/50
505/505 - 17s - loss: 3.1353 - accuracy500: 0.4572 - val_loss: 3.4196 - val_accuracy500: 0.3566 - 17s/epoch - 34ms/step
Epoch 11/50
505/505 - 17s - loss: 3.1203 - accuracy500: 0.4613 - val_loss: 3.4304 - val_accuracy500: 0.3591 - 17s/epoch - 34ms/step
Epoch 12/50
505/505 - 17s - loss: 3.0943 - accuracy500: 0.4708 - val_loss: 3.4640 - val_accuracy500: 0.3475 - 17s/epoch - 34ms/step
Epoch 13/50
505/505 - 17s - loss: 3.0870 - accuracy500: 0.4762 - val_loss: 3.4846 - val_accuracy500: 0.3496 - 17s/epoch - 34ms/step
Epoch 14/50
505/505 - 18s - loss: 3.0723 - accuracy500: 0.4811 - val_loss: 3.5287 - val_accuracy500: 0.3509 - 18s/epoch - 35ms/step
Epoch 15/50
505/505 - 17s - loss: 3.0404 - accuracy500: 0.4895 - val_loss: 3.5181 - val_accuracy500: 0.3527 - 17s/epoch - 34ms/step
testing model: results/QRTEA/W9/deepVOL_L3/h500
Evaluating performance on  test set...
1118/1118 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1070622
{'0': {'precision': 0.2625245825139162, 'recall': 0.08767965088447795, 'f1-score': 0.13145508562272593, 'support': 89827}, '1': {'precision': 0.36779489557208794, 'recall': 0.34889393136676694, 'f1-score': 0.3580951794682384, 'support': 100039}, '2': {'precision': 0.3628843220181324, 'recall': 0.6077203476960463, 'f1-score': 0.45442226527767526, 'support': 96291}, 'accuracy': 0.35399099095950826, 'macro avg': {'precision': 0.3310679333680455, 'recall': 0.3480979766490971, 'f1-score': 0.31465751012287985, 'support': 286157}, 'weighted avg': {'precision': 0.333097297927577, 'recall': 0.35399099095950826, 'f1-score': 0.31936480317066623, 'support': 286157}}
[[ 7876 32546 49405]
 [11801 34903 53335]
 [10324 27449 58518]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0971305
{'0': {'precision': 0.46592420212765956, 'recall': 0.11970958787102284, 'f1-score': 0.19047942645509836, 'support': 46830}, '1': {'precision': 0.37018766756032173, 'recall': 0.42349592698007654, 'f1-score': 0.39505155583021484, 'support': 40756}, '2': {'precision': 0.3780753968253968, 'recall': 0.6407965218226802, 'f1-score': 0.4755639935467194, 'support': 41631}, 'accuracy': 0.3834093037293855, 'macro avg': {'precision': 0.4047290888377926, 'recall': 0.39466734555792654, 'f1-score': 0.35369832527734424, 'support': 129217}, 'weighted avg': {'precision': 0.4074251515664724, 'recall': 0.3834093037293855, 'f1-score': 0.3468512453133254, 'support': 129217}}
[[ 5606 17760 23464]
 [ 3077 17260 20419]
 [ 3349 11605 26677]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1120617
{'0': {'precision': 0.37363138686131386, 'recall': 0.09933292904790782, 'f1-score': 0.15694164989939635, 'support': 16490}, '1': {'precision': 0.3465952956920068, 'recall': 0.4446351931330472, 'f1-score': 0.38954127378955283, 'support': 15145}, '2': {'precision': 0.3752083333333333, 'recall': 0.5566201013722339, 'f1-score': 0.4482552640748669, 'support': 16178}, 'accuracy': 0.3634367222303558, 'macro avg': {'precision': 0.36514500529555133, 'recall': 0.3668627411843963, 'f1-score': 0.33157939592127206, 'support': 47813}, 'weighted avg': {'precision': 0.3656011490445104, 'recall': 0.3634367222303558, 'f1-score': 0.3291875444039701, 'support': 47813}}
[[1638 6874 7978]
 [1394 6734 7017]
 [1352 5821 9005]]
training model: results/QRTEA/W9/deepVOL_L3/h1000
Epoch 1/50
505/505 - 20s - loss: 3.2846 - accuracy1000: 0.3974 - val_loss: 3.3187 - val_accuracy1000: 0.3334 - 20s/epoch - 40ms/step
Epoch 2/50
505/505 - 18s - loss: 3.2931 - accuracy1000: 0.3617 - val_loss: 3.3036 - val_accuracy1000: 0.3536 - 18s/epoch - 35ms/step
Epoch 3/50
505/505 - 18s - loss: 3.2845 - accuracy1000: 0.3681 - val_loss: 3.3273 - val_accuracy1000: 0.3502 - 18s/epoch - 35ms/step
Epoch 4/50
505/505 - 17s - loss: 3.2846 - accuracy1000: 0.3805 - val_loss: 3.3015 - val_accuracy1000: 0.3601 - 17s/epoch - 34ms/step
Epoch 5/50
505/505 - 17s - loss: 3.2782 - accuracy1000: 0.3860 - val_loss: 3.3097 - val_accuracy1000: 0.3559 - 17s/epoch - 34ms/step
Epoch 6/50
505/505 - 17s - loss: 3.2746 - accuracy1000: 0.3782 - val_loss: 3.3315 - val_accuracy1000: 0.3416 - 17s/epoch - 34ms/step
Epoch 7/50
505/505 - 17s - loss: 3.2565 - accuracy1000: 0.3943 - val_loss: 3.3287 - val_accuracy1000: 0.3498 - 17s/epoch - 34ms/step
Epoch 8/50
505/505 - 17s - loss: 3.2414 - accuracy1000: 0.4002 - val_loss: 3.3508 - val_accuracy1000: 0.3531 - 17s/epoch - 35ms/step
Epoch 9/50
505/505 - 17s - loss: 3.2253 - accuracy1000: 0.4129 - val_loss: 3.3849 - val_accuracy1000: 0.3388 - 17s/epoch - 34ms/step
Epoch 10/50
505/505 - 17s - loss: 3.2036 - accuracy1000: 0.4210 - val_loss: 3.4154 - val_accuracy1000: 0.3496 - 17s/epoch - 34ms/step
Epoch 11/50
505/505 - 17s - loss: 3.1926 - accuracy1000: 0.4301 - val_loss: 3.4154 - val_accuracy1000: 0.3607 - 17s/epoch - 34ms/step
Epoch 12/50
505/505 - 17s - loss: 3.1559 - accuracy1000: 0.4422 - val_loss: 3.4962 - val_accuracy1000: 0.3480 - 17s/epoch - 34ms/step
Epoch 13/50
505/505 - 17s - loss: 3.1497 - accuracy1000: 0.4477 - val_loss: 3.5673 - val_accuracy1000: 0.3520 - 17s/epoch - 34ms/step
Epoch 14/50
505/505 - 17s - loss: 3.1218 - accuracy1000: 0.4610 - val_loss: 3.6033 - val_accuracy1000: 0.3335 - 17s/epoch - 34ms/step
testing model: results/QRTEA/W9/deepVOL_L3/h1000
Evaluating performance on  test set...
1118/1118 - 19s - 19s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1077995
{'0': {'precision': 0.29968196376178635, 'recall': 0.2926842606061269, 'f1-score': 0.29614177977214756, 'support': 91433}, '1': {'precision': 0.393173198482933, 'recall': 0.0065393834896337105, 'f1-score': 0.012864795549028935, 'support': 95116}, '2': {'precision': 0.3270380024273212, 'recall': 0.6411432816641234, 'f1-score': 0.43313834206555096, 'support': 99608}, 'accuracy': 0.318866915714101, 'macro avg': {'precision': 0.33996438822401354, 'recall': 0.31345564191996134, 'f1-score': 0.24738163912890912, 'support': 286157}, 'weighted avg': {'precision': 0.340279931245137, 'recall': 0.318866915714101, 'f1-score': 0.2496700175771119, 'support': 286157}}
[[26761   442 64230]
 [27310   622 67184]
 [35227   518 63863]]
Evaluating performance on  train set...
505/505 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0932463
{'0': {'precision': 0.40324802671031945, 'recall': 0.5394037940379404, 'f1-score': 0.4614928030865113, 'support': 46125}, '1': {'precision': 0.35479951397326853, 'recall': 0.006884032345521843, 'f1-score': 0.013506012950971324, 'support': 42417}, '2': {'precision': 0.34146487742709347, 'recall': 0.5599016594960049, 'f1-score': 0.42421533016671326, 'support': 40675}, 'accuracy': 0.37105024880627163, 'macro avg': {'precision': 0.36650413937022713, 'recall': 0.368729828626489, 'f1-score': 0.2997380487347319, 'support': 129217}, 'weighted avg': {'precision': 0.36789609807970036, 'recall': 0.37105024880627163, 'f1-score': 0.30270164644154984, 'support': 129217}}
[[24880   275 20970]
 [19174   292 22951]
 [17645   256 22774]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981977
{'0': {'precision': 0.3686589871767007, 'recall': 0.5167875205654744, 'f1-score': 0.4303328597523848, 'support': 16411}, '1': {'precision': 0.32081911262798635, 'recall': 0.006006773595756918, 'f1-score': 0.011792748714088572, 'support': 15649}, '2': {'precision': 0.3459922496430757, 'recall': 0.5384371230876659, 'f1-score': 0.42127744114433296, 'support': 15753}, 'accuracy': 0.3567439817622822, 'macro avg': {'precision': 0.3451567831492542, 'recall': 0.35374380574963243, 'f1-score': 0.2878010165369354, 'support': 47813}, 'weighted avg': {'precision': 0.34553315710579896, 'recall': 0.3567439817622822, 'f1-score': 0.2903628890964766, 'support': 47813}}
[[8481   96 7834]
 [7356   94 8199]
 [7168  103 8482]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        16 (peak)  11.08 (ave)

============================================
