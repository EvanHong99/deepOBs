This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/WBA_orderbooks/WBA_orderbooks_2019-11-13.csv
data/WBA_orderbooks/WBA_orderbooks_2019-11-05.csv
data/WBA_orderbooks/WBA_orderbooks_2019-10-23.csv
data/WBA_orderbooks/WBA_orderbooks_2019-10-24.csv
data/WBA_orderbooks/WBA_orderbooks_2019-11-01.csv
data/WBA_orderbooks/WBA_orderbooks_2019-10-28.csv
data/WBA_orderbooks/WBA_orderbooks_2019-10-30.csv
data/WBA_orderbooks/WBA_orderbooks_2019-10-25.csv
data/WBA_orderbooks/WBA_orderbooks_2019-11-15.csv
data/WBA_orderbooks/WBA_orderbooks_2019-10-29.csv
data/WBA_orderbooks/WBA_orderbooks_2019-11-11.csv
data/WBA_orderbooks/WBA_orderbooks_2019-10-31.csv
data/WBA_orderbooks/WBA_orderbooks_2019-10-22.csv
data/WBA_orderbooks/WBA_orderbooks_2019-11-07.csv
data/WBA_orderbooks/WBA_orderbooks_2019-11-06.csv
training model: results/WBA/W8/deepLOB_L1/h10
Epoch 1/50
1532/1532 - 47s - loss: 3.0691 - accuracy10: 0.4566 - val_loss: 3.6201 - val_accuracy10: 0.4747 - 47s/epoch - 31ms/step
Epoch 2/50
1532/1532 - 22s - loss: 3.0502 - accuracy10: 0.4520 - val_loss: 3.1759 - val_accuracy10: 0.4783 - 22s/epoch - 15ms/step
Epoch 3/50
1532/1532 - 22s - loss: 3.0044 - accuracy10: 0.4698 - val_loss: 3.2051 - val_accuracy10: 0.4885 - 22s/epoch - 15ms/step
Epoch 4/50
1532/1532 - 22s - loss: 2.9592 - accuracy10: 0.4880 - val_loss: 3.3090 - val_accuracy10: 0.4857 - 22s/epoch - 15ms/step
Epoch 5/50
1532/1532 - 22s - loss: 2.9247 - accuracy10: 0.5024 - val_loss: 3.2761 - val_accuracy10: 0.4888 - 22s/epoch - 15ms/step
Epoch 6/50
1532/1532 - 22s - loss: 2.8906 - accuracy10: 0.5145 - val_loss: 3.2544 - val_accuracy10: 0.4860 - 22s/epoch - 14ms/step
Epoch 7/50
1532/1532 - 22s - loss: 2.8675 - accuracy10: 0.5238 - val_loss: 3.3503 - val_accuracy10: 0.4931 - 22s/epoch - 15ms/step
Epoch 8/50
1532/1532 - 23s - loss: 2.8504 - accuracy10: 0.5279 - val_loss: 3.3796 - val_accuracy10: 0.4943 - 23s/epoch - 15ms/step
Epoch 9/50
1532/1532 - 22s - loss: 2.8386 - accuracy10: 0.5307 - val_loss: 3.3713 - val_accuracy10: 0.4965 - 22s/epoch - 15ms/step
Epoch 10/50
1532/1532 - 22s - loss: 2.8277 - accuracy10: 0.5332 - val_loss: 3.3670 - val_accuracy10: 0.4996 - 22s/epoch - 15ms/step
Epoch 11/50
1532/1532 - 22s - loss: 2.8179 - accuracy10: 0.5352 - val_loss: 3.4936 - val_accuracy10: 0.5045 - 22s/epoch - 14ms/step
Epoch 12/50
1532/1532 - 23s - loss: 2.8105 - accuracy10: 0.5372 - val_loss: 3.4719 - val_accuracy10: 0.5064 - 23s/epoch - 15ms/step
testing model: results/WBA/W8/deepLOB_L1/h10
Evaluating performance on  test set...
3755/3755 - 25s - 25s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96388024
{'0': {'precision': 0.4133779694843237, 'recall': 0.08404193589201028, 'f1-score': 0.13968514100490925, 'support': 229207}, '1': {'precision': 0.5406184584768753, 'recall': 0.9015910972132806, 'f1-score': 0.6759306055473605, 'support': 511031}, '2': {'precision': 0.4513447589704089, 'recall': 0.12731017313567952, 'f1-score': 0.1986011912117243, 'support': 220925}, 'accuracy': 0.528661631793983, 'macro avg': {'precision': 0.46844706231053596, 'recall': 0.3709810687469901, 'f1-score': 0.338072312587998, 'support': 961163}, 'weighted avg': {'precision': 0.4897559067307283, 'recall': 0.528661631793983, 'f1-score': 0.43833800673375445, 'support': 961163}}
[[ 19263 204051   5893]
 [ 21993 460741  28297]
 [  5343 187456  28126]]
Evaluating performance on  train set...
1532/1532 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0053563
{'0': {'precision': 0.4306920526887083, 'recall': 0.14318177385062517, 'f1-score': 0.21491571573916163, 'support': 102534}, '1': {'precision': 0.4939277088593699, 'recall': 0.7666510468806578, 'f1-score': 0.600787841864114, 'support': 187796}, '2': {'precision': 0.38825331051256645, 'recall': 0.2539003053480084, 'f1-score': 0.3070219699982785, 'support': 101851}, 'accuracy': 0.47048429169184636, 'macro avg': {'precision': 0.43762435735354827, 'recall': 0.38791104202643045, 'f1-score': 0.3742418425338514, 'support': 392181}, 'weighted avg': {'precision': 0.44995095344331737, 'recall': 0.47048429169184636, 'f1-score': 0.4236110780853917, 'support': 392181}}
[[ 14681  77395  10458]
 [ 13534 143974  30288]
 [  5872  70119  25860]]
Evaluating performance on  val set...
467/467 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.000997
{'0': {'precision': 0.4185150228095013, 'recall': 0.17460213289581625, 'f1-score': 0.2464053346917039, 'support': 30475}, '1': {'precision': 0.5089570409878833, 'recall': 0.7518713280005481, 'f1-score': 0.6070139532310925, 'support': 58381}, '2': {'precision': 0.3841069330199765, 'recall': 0.2569856192878435, 'f1-score': 0.3079429255559263, 'support': 30527}, 'accuracy': 0.47796587453825085, 'macro avg': {'precision': 0.43719299893912034, 'recall': 0.39448636006140264, 'f1-score': 0.3871207378262409, 'support': 119383}, 'weighted avg': {'precision': 0.4539448554177227, 'recall': 0.47796587453825085, 'f1-score': 0.43848670134575146, 'support': 119383}}
[[ 5321 21408  3746]
 [ 5653 43895  8833]
 [ 1740 20942  7845]]
training model: results/WBA/W8/deepLOB_L1/h20
Epoch 1/50
1532/1532 - 24s - loss: 3.0932 - accuracy20: 0.4557 - val_loss: 3.6750 - val_accuracy20: 0.3860 - 24s/epoch - 16ms/step
Epoch 2/50
1532/1532 - 22s - loss: 3.0663 - accuracy20: 0.4647 - val_loss: 3.7509 - val_accuracy20: 0.3777 - 22s/epoch - 15ms/step
Epoch 3/50
1532/1532 - 22s - loss: 3.0318 - accuracy20: 0.4802 - val_loss: 3.5400 - val_accuracy20: 0.4022 - 22s/epoch - 14ms/step
Epoch 4/50
1532/1532 - 22s - loss: 2.9844 - accuracy20: 0.4956 - val_loss: 3.6225 - val_accuracy20: 0.3968 - 22s/epoch - 14ms/step
Epoch 5/50
1532/1532 - 22s - loss: 2.9581 - accuracy20: 0.5031 - val_loss: 3.5171 - val_accuracy20: 0.4054 - 22s/epoch - 15ms/step
Epoch 6/50
1532/1532 - 22s - loss: 2.9384 - accuracy20: 0.5083 - val_loss: 3.4678 - val_accuracy20: 0.4083 - 22s/epoch - 14ms/step
Epoch 7/50
1532/1532 - 22s - loss: 2.9243 - accuracy20: 0.5115 - val_loss: 3.5264 - val_accuracy20: 0.4017 - 22s/epoch - 15ms/step
Epoch 8/50
1532/1532 - 22s - loss: 2.9104 - accuracy20: 0.5148 - val_loss: 3.4626 - val_accuracy20: 0.4045 - 22s/epoch - 15ms/step
Epoch 9/50
1532/1532 - 22s - loss: 2.8997 - accuracy20: 0.5165 - val_loss: 3.4937 - val_accuracy20: 0.4020 - 22s/epoch - 15ms/step
Epoch 10/50
1532/1532 - 22s - loss: 2.8889 - accuracy20: 0.5183 - val_loss: 3.4602 - val_accuracy20: 0.4018 - 22s/epoch - 15ms/step
Epoch 11/50
1532/1532 - 22s - loss: 2.8798 - accuracy20: 0.5202 - val_loss: 3.4765 - val_accuracy20: 0.4036 - 22s/epoch - 14ms/step
Epoch 12/50
1532/1532 - 23s - loss: 2.8735 - accuracy20: 0.5212 - val_loss: 3.4462 - val_accuracy20: 0.4067 - 23s/epoch - 15ms/step
Epoch 13/50
1532/1532 - 22s - loss: 2.8658 - accuracy20: 0.5232 - val_loss: 3.5141 - val_accuracy20: 0.4008 - 22s/epoch - 15ms/step
Epoch 14/50
1532/1532 - 22s - loss: 2.8604 - accuracy20: 0.5234 - val_loss: 3.5097 - val_accuracy20: 0.4054 - 22s/epoch - 15ms/step
Epoch 15/50
1532/1532 - 22s - loss: 2.8548 - accuracy20: 0.5247 - val_loss: 3.5469 - val_accuracy20: 0.4044 - 22s/epoch - 15ms/step
Epoch 16/50
1532/1532 - 22s - loss: 2.8496 - accuracy20: 0.5254 - val_loss: 3.5211 - val_accuracy20: 0.4031 - 22s/epoch - 15ms/step
Epoch 17/50
1532/1532 - 22s - loss: 2.8453 - accuracy20: 0.5267 - val_loss: 3.4638 - val_accuracy20: 0.4065 - 22s/epoch - 15ms/step
Epoch 18/50
1532/1532 - 22s - loss: 2.8409 - accuracy20: 0.5267 - val_loss: 3.4211 - val_accuracy20: 0.4134 - 22s/epoch - 15ms/step
Epoch 19/50
1532/1532 - 22s - loss: 2.8370 - accuracy20: 0.5279 - val_loss: 3.4017 - val_accuracy20: 0.4129 - 22s/epoch - 15ms/step
Epoch 20/50
1532/1532 - 23s - loss: 2.8328 - accuracy20: 0.5286 - val_loss: 3.3911 - val_accuracy20: 0.4144 - 23s/epoch - 15ms/step
Epoch 21/50
1532/1532 - 22s - loss: 2.8283 - accuracy20: 0.5298 - val_loss: 3.4638 - val_accuracy20: 0.4068 - 22s/epoch - 15ms/step
Epoch 22/50
1532/1532 - 22s - loss: 2.8262 - accuracy20: 0.5297 - val_loss: 3.4518 - val_accuracy20: 0.4093 - 22s/epoch - 15ms/step
Epoch 23/50
1532/1532 - 22s - loss: 2.8225 - accuracy20: 0.5310 - val_loss: 3.4861 - val_accuracy20: 0.4058 - 22s/epoch - 14ms/step
Epoch 24/50
1532/1532 - 22s - loss: 2.8187 - accuracy20: 0.5321 - val_loss: 3.4616 - val_accuracy20: 0.4081 - 22s/epoch - 15ms/step
Epoch 25/50
1532/1532 - 22s - loss: 2.8156 - accuracy20: 0.5327 - val_loss: 3.5394 - val_accuracy20: 0.4034 - 22s/epoch - 15ms/step
Epoch 26/50
1532/1532 - 22s - loss: 2.8127 - accuracy20: 0.5328 - val_loss: 3.4892 - val_accuracy20: 0.4035 - 22s/epoch - 15ms/step
Epoch 27/50
1532/1532 - 22s - loss: 2.8104 - accuracy20: 0.5335 - val_loss: 3.4411 - val_accuracy20: 0.4094 - 22s/epoch - 15ms/step
Epoch 28/50
1532/1532 - 22s - loss: 2.8065 - accuracy20: 0.5352 - val_loss: 3.5009 - val_accuracy20: 0.4026 - 22s/epoch - 15ms/step
Epoch 29/50
1532/1532 - 22s - loss: 2.8036 - accuracy20: 0.5359 - val_loss: 3.5018 - val_accuracy20: 0.4040 - 22s/epoch - 15ms/step
Epoch 30/50
1532/1532 - 23s - loss: 2.8008 - accuracy20: 0.5362 - val_loss: 3.5072 - val_accuracy20: 0.4085 - 23s/epoch - 15ms/step
testing model: results/WBA/W8/deepLOB_L1/h20
Evaluating performance on  test set...
3755/3755 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0655128
{'0': {'precision': 0.4229200443723867, 'recall': 0.08619178463357796, 'f1-score': 0.14319931812600226, 'support': 287510}, '1': {'precision': 0.4875109640950967, 'recall': 0.6387031357576516, 'f1-score': 0.5529584144337852, 'support': 399425}, '2': {'precision': 0.3719919107546359, 'recall': 0.51448065113701, 'f1-score': 0.4317846906718776, 'support': 274228}, 'accuracy': 0.4379902264236139, 'macro avg': {'precision': 0.4274743064073731, 'recall': 0.41312519050941326, 'f1-score': 0.37598080774388837, 'support': 961163}, 'weighted avg': {'precision': 0.4352314919463308, 'recall': 0.4379902264236139, 'f1-score': 0.395816425302669, 'support': 961163}}
[[ 24781 147911 114818]
 [ 20945 255114 123366]
 [ 12869 120274 141085]]
Evaluating performance on  train set...
1532/1532 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1025409
{'0': {'precision': 0.5056713322965267, 'recall': 0.1957551334949508, 'f1-score': 0.28224700374423467, 'support': 124574}, '1': {'precision': 0.4093319061561593, 'recall': 0.6824500736049773, 'f1-score': 0.5117296212312523, 'support': 144012}, '2': {'precision': 0.41009099224880846, 'recall': 0.3445932278813868, 'f1-score': 0.3744998900857331, 'support': 123595}, 'accuracy': 0.4213794140970623, 'macro avg': {'precision': 0.44169807690049817, 'recall': 0.407599478327105, 'f1-score': 0.38949217168707334, 'support': 392181}, 'weighted avg': {'precision': 0.44017278553999256, 'recall': 0.4213794140970623, 'f1-score': 0.39558815539849096, 'support': 392181}}
[[24386 71998 28190]
 [12656 98281 33075]
 [11183 69822 42590]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1112543
{'0': {'precision': 0.4755532345453359, 'recall': 0.19286262674397056, 'f1-score': 0.2744292925487833, 'support': 37773}, '1': {'precision': 0.40153761949009076, 'recall': 0.7144054170346718, 'f1-score': 0.5141134289439374, 'support': 44157}, '2': {'precision': 0.4086898552997922, 'recall': 0.27826876351694124, 'f1-score': 0.33109889760777717, 'support': 37453}, 'accuracy': 0.4125629277200271, 'macro avg': {'precision': 0.4285935697784063, 'recall': 0.39517893576519453, 'f1-score': 0.3732138730334993, 'support': 119383}, 'weighted avg': {'precision': 0.4272001050639373, 'recall': 0.4125629277200271, 'f1-score': 0.3808613568215467, 'support': 119383}}
[[ 7285 23259  7229]
 [ 4761 31546  7850]
 [ 3273 23758 10422]]
training model: results/WBA/W8/deepLOB_L1/h30
Epoch 1/50
1532/1532 - 25s - loss: 3.1248 - accuracy30: 0.4452 - val_loss: 3.4493 - val_accuracy30: 0.3733 - 25s/epoch - 16ms/step
Epoch 2/50
1532/1532 - 23s - loss: 3.0931 - accuracy30: 0.4563 - val_loss: 3.6995 - val_accuracy30: 0.3551 - 23s/epoch - 15ms/step
Epoch 3/50
1532/1532 - 23s - loss: 3.0595 - accuracy30: 0.4727 - val_loss: 3.6735 - val_accuracy30: 0.3522 - 23s/epoch - 15ms/step
Epoch 4/50
1532/1532 - 23s - loss: 3.0380 - accuracy30: 0.4790 - val_loss: 3.5748 - val_accuracy30: 0.3506 - 23s/epoch - 15ms/step
Epoch 5/50
1532/1532 - 23s - loss: 3.0183 - accuracy30: 0.4845 - val_loss: 3.5924 - val_accuracy30: 0.3569 - 23s/epoch - 15ms/step
Epoch 6/50
1532/1532 - 22s - loss: 2.9974 - accuracy30: 0.4900 - val_loss: 3.4773 - val_accuracy30: 0.3704 - 22s/epoch - 15ms/step
Epoch 7/50
1532/1532 - 22s - loss: 2.9837 - accuracy30: 0.4931 - val_loss: 3.4879 - val_accuracy30: 0.3724 - 22s/epoch - 15ms/step
Epoch 8/50
1532/1532 - 22s - loss: 2.9735 - accuracy30: 0.4953 - val_loss: 3.5110 - val_accuracy30: 0.3681 - 22s/epoch - 15ms/step
Epoch 9/50
1532/1532 - 23s - loss: 2.9651 - accuracy30: 0.4980 - val_loss: 3.4286 - val_accuracy30: 0.3761 - 23s/epoch - 15ms/step
Epoch 10/50
1532/1532 - 23s - loss: 2.9585 - accuracy30: 0.4991 - val_loss: 3.4825 - val_accuracy30: 0.3710 - 23s/epoch - 15ms/step
Epoch 11/50
1532/1532 - 22s - loss: 2.9509 - accuracy30: 0.5003 - val_loss: 3.5517 - val_accuracy30: 0.3733 - 22s/epoch - 15ms/step
Epoch 12/50
1532/1532 - 22s - loss: 2.9455 - accuracy30: 0.5019 - val_loss: 3.5696 - val_accuracy30: 0.3815 - 22s/epoch - 15ms/step
Epoch 13/50
1532/1532 - 23s - loss: 2.9409 - accuracy30: 0.5030 - val_loss: 3.6367 - val_accuracy30: 0.3722 - 23s/epoch - 15ms/step
Epoch 14/50
1532/1532 - 22s - loss: 2.9354 - accuracy30: 0.5043 - val_loss: 3.6688 - val_accuracy30: 0.3609 - 22s/epoch - 15ms/step
Epoch 15/50
1532/1532 - 22s - loss: 2.9315 - accuracy30: 0.5049 - val_loss: 3.6680 - val_accuracy30: 0.3737 - 22s/epoch - 15ms/step
Epoch 16/50
1532/1532 - 22s - loss: 2.9255 - accuracy30: 0.5063 - val_loss: 3.7045 - val_accuracy30: 0.3720 - 22s/epoch - 15ms/step
Epoch 17/50
1532/1532 - 22s - loss: 2.9219 - accuracy30: 0.5072 - val_loss: 3.6928 - val_accuracy30: 0.3730 - 22s/epoch - 15ms/step
Epoch 18/50
1532/1532 - 22s - loss: 2.9198 - accuracy30: 0.5077 - val_loss: 3.6351 - val_accuracy30: 0.3859 - 22s/epoch - 14ms/step
Epoch 19/50
1532/1532 - 22s - loss: 2.9157 - accuracy30: 0.5088 - val_loss: 3.6887 - val_accuracy30: 0.3826 - 22s/epoch - 15ms/step
testing model: results/WBA/W8/deepLOB_L1/h30
Evaluating performance on  test set...
3755/3755 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1687701
{'0': {'precision': 0.5060853868665044, 'recall': 0.060550927046996994, 'f1-score': 0.10816087351712811, 'support': 305594}, '1': {'precision': 0.3852701174769804, 'recall': 0.9589759390801499, 'f1-score': 0.5496981313871605, 'support': 363494}, '2': {'precision': 0.4506985423916881, 'recall': 0.030594881451681932, 'f1-score': 0.05730004937448301, 'support': 292075}, 'accuracy': 0.3912156418838428, 'macro avg': {'precision': 0.4473513489117243, 'recall': 0.35004058252627623, 'f1-score': 0.2383863514262572, 'support': 961163}, 'weighted avg': {'precision': 0.4435645260640624, 'recall': 0.3912156418838428, 'f1-score': 0.25968664885465825, 'support': 961163}}
[[ 18504 281840   5250]
 [  9271 348582   5641]
 [  8788 274351   8936]]
Evaluating performance on  train set...
1532/1532 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1466286
{'0': {'precision': 0.5033040111115787, 'recall': 0.18235051923692758, 'f1-score': 0.2677084266141309, 'support': 131154}, '1': {'precision': 0.3485025414515235, 'recall': 0.859461771738051, 'f1-score': 0.4959163254421961, 'support': 130911}, '2': {'precision': 0.49972497249724973, 'recall': 0.08378677487780134, 'f1-score': 0.14351157096595846, 'support': 130116}, 'accuracy': 0.37567092745441516, 'macro avg': {'precision': 0.45051050835345063, 'recall': 0.3751996886175933, 'f1-score': 0.3023787743407618, 'support': 392181}, 'weighted avg': {'precision': 0.4504434559520746, 'recall': 0.37567092745441516, 'f1-score': 0.30267933589827073, 'support': 392181}}
[[ 23916 102779   4459]
 [ 11943 112513   6455]
 [ 11659 107555  10902]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.143035
{'0': {'precision': 0.4895897880778287, 'recall': 0.19841289771728485, 'f1-score': 0.2823853178219768, 'support': 39821}, '1': {'precision': 0.34822361822309034, 'recall': 0.8267201403684672, 'f1-score': 0.490037887229775, 'support': 39895}, '2': {'precision': 0.48534583821805394, 'recall': 0.1043688708498248, 'f1-score': 0.1717949249953317, 'support': 39667}, 'accuracy': 0.37713074725882245, 'macro avg': {'precision': 0.44105308150632433, 'recall': 0.37650063631185887, 'f1-score': 0.3147393766823611, 'support': 119383}, 'weighted avg': {'precision': 0.44093840466945, 'recall': 0.37713074725882245, 'f1-score': 0.31503242959056676, 'support': 119383}}
[[ 7901 30217  1703]
 [ 4226 32982  2687]
 [ 4011 31516  4140]]
training model: results/WBA/W8/deepLOB_L1/h50
Epoch 1/50
1532/1532 - 25s - loss: 3.1985 - accuracy50: 0.4146 - val_loss: 3.6067 - val_accuracy50: 0.3324 - 25s/epoch - 16ms/step
Epoch 2/50
1532/1532 - 23s - loss: 3.1672 - accuracy50: 0.4312 - val_loss: 3.4976 - val_accuracy50: 0.3336 - 23s/epoch - 15ms/step
Epoch 3/50
1532/1532 - 22s - loss: 3.1428 - accuracy50: 0.4415 - val_loss: 3.5638 - val_accuracy50: 0.3349 - 22s/epoch - 15ms/step
Epoch 4/50
1532/1532 - 22s - loss: 3.1302 - accuracy50: 0.4465 - val_loss: 3.5552 - val_accuracy50: 0.3367 - 22s/epoch - 15ms/step
Epoch 5/50
1532/1532 - 22s - loss: 3.1183 - accuracy50: 0.4520 - val_loss: 3.5988 - val_accuracy50: 0.3368 - 22s/epoch - 15ms/step
Epoch 6/50
1532/1532 - 23s - loss: 3.1099 - accuracy50: 0.4535 - val_loss: 3.5834 - val_accuracy50: 0.3414 - 23s/epoch - 15ms/step
Epoch 7/50
1532/1532 - 22s - loss: 3.1033 - accuracy50: 0.4553 - val_loss: 3.6116 - val_accuracy50: 0.3388 - 22s/epoch - 15ms/step
Epoch 8/50
1532/1532 - 22s - loss: 3.0977 - accuracy50: 0.4586 - val_loss: 3.5881 - val_accuracy50: 0.3351 - 22s/epoch - 15ms/step
Epoch 9/50
1532/1532 - 23s - loss: 3.0922 - accuracy50: 0.4599 - val_loss: 3.5706 - val_accuracy50: 0.3356 - 23s/epoch - 15ms/step
Epoch 10/50
1532/1532 - 23s - loss: 3.0878 - accuracy50: 0.4607 - val_loss: 3.5501 - val_accuracy50: 0.3378 - 23s/epoch - 15ms/step
Epoch 11/50
1532/1532 - 22s - loss: 3.0840 - accuracy50: 0.4622 - val_loss: 3.5483 - val_accuracy50: 0.3372 - 22s/epoch - 15ms/step
Epoch 12/50
1532/1532 - 23s - loss: 3.0792 - accuracy50: 0.4629 - val_loss: 3.5387 - val_accuracy50: 0.3423 - 23s/epoch - 15ms/step
testing model: results/WBA/W8/deepLOB_L1/h50
Evaluating performance on  test set...
3755/3755 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1489239
{'0': {'precision': 0.49048152295632697, 'recall': 0.0028172909624779295, 'f1-score': 0.005602402125842998, 'support': 310937}, '1': {'precision': 0.3712694686625907, 'recall': 0.9377987202123232, 'f1-score': 0.5319448375946385, 'support': 355684}, '2': {'precision': 0.3238112427394743, 'recall': 0.06700232903966158, 'f1-score': 0.11103047078945, 'support': 294542}, 'accuracy': 0.36848172474387797, 'macro avg': {'precision': 0.39518741145279734, 'recall': 0.3358727800714876, 'f1-score': 0.21619257016997717, 'support': 961163}, 'weighted avg': {'precision': 0.39529140640476856, 'recall': 0.36848172474387797, 'f1-score': 0.23268623391878465, 'support': 961163}}
[[   876 290372  19689]
 [   602 333560  21522]
 [   308 274499  19735]]
Evaluating performance on  train set...
1532/1532 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1765743
{'0': {'precision': 0.45860087867522814, 'recall': 0.010297621757804793, 'f1-score': 0.020142945144986157, 'support': 131778}, '1': {'precision': 0.33012083359233324, 'recall': 0.944416954027432, 'f1-score': 0.48923102186638256, 'support': 129338}, '2': {'precision': 0.38653756051850696, 'recall': 0.056651279899286616, 'f1-score': 0.09881948973208937, 'support': 131065}, 'accuracy': 0.33385350131699393, 'macro avg': {'precision': 0.3917530909286895, 'recall': 0.3371219518948411, 'f1-score': 0.20273115224781937, 'support': 392181}, 'weighted avg': {'precision': 0.39214602526534315, 'recall': 0.33385350131699393, 'f1-score': 0.20113757513292704, 'support': 392181}}
[[  1357 124839   5582]
 [   987 122149   6202]
 [   615 123025   7425]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.168101
{'0': {'precision': 0.37524177949709864, 'recall': 0.014615036914268496, 'f1-score': 0.028134290479298094, 'support': 39822}, '1': {'precision': 0.3303911697452739, 'recall': 0.889674395033574, 'f1-score': 0.4818438820881594, 'support': 39465}, '2': {'precision': 0.34720179915232247, 'recall': 0.100109736632083, 'f1-score': 0.15540972181892096, 'support': 40096}, 'accuracy': 0.33260179422530844, 'macro avg': {'precision': 0.350944916131565, 'recall': 0.3347997228599751, 'f1-score': 0.2217959647954595, 'support': 119383}, 'weighted avg': {'precision': 0.35099778859588227, 'recall': 0.33260179422530844, 'f1-score': 0.22086595853787622, 'support': 119383}}
[[  582 35503  3737]
 [  544 35111  3810]
 [  425 35657  4014]]
training model: results/WBA/W8/deepLOB_L1/h100
Epoch 1/50
1532/1532 - 25s - loss: 3.2584 - accuracy100: 0.3904 - val_loss: 3.3553 - val_accuracy100: 0.3585 - 25s/epoch - 16ms/step
Epoch 2/50
1532/1532 - 23s - loss: 3.2428 - accuracy100: 0.3931 - val_loss: 3.3324 - val_accuracy100: 0.3566 - 23s/epoch - 15ms/step
Epoch 3/50
1532/1532 - 23s - loss: 3.2203 - accuracy100: 0.4058 - val_loss: 3.3882 - val_accuracy100: 0.3498 - 23s/epoch - 15ms/step
Epoch 4/50
1532/1532 - 22s - loss: 3.2048 - accuracy100: 0.4134 - val_loss: 3.3877 - val_accuracy100: 0.3501 - 22s/epoch - 14ms/step
Epoch 5/50
1532/1532 - 22s - loss: 3.1963 - accuracy100: 0.4175 - val_loss: 3.3512 - val_accuracy100: 0.3491 - 22s/epoch - 15ms/step
Epoch 6/50
1532/1532 - 22s - loss: 3.1911 - accuracy100: 0.4190 - val_loss: 3.3300 - val_accuracy100: 0.3534 - 22s/epoch - 15ms/step
Epoch 7/50
1532/1532 - 23s - loss: 3.1853 - accuracy100: 0.4203 - val_loss: 3.3490 - val_accuracy100: 0.3563 - 23s/epoch - 15ms/step
Epoch 8/50
1532/1532 - 22s - loss: 3.1823 - accuracy100: 0.4218 - val_loss: 3.3473 - val_accuracy100: 0.3580 - 22s/epoch - 15ms/step
Epoch 9/50
1532/1532 - 23s - loss: 3.1787 - accuracy100: 0.4229 - val_loss: 3.3993 - val_accuracy100: 0.3655 - 23s/epoch - 15ms/step
Epoch 10/50
1532/1532 - 22s - loss: 3.1746 - accuracy100: 0.4244 - val_loss: 3.3959 - val_accuracy100: 0.3611 - 22s/epoch - 15ms/step
Epoch 11/50
1532/1532 - 22s - loss: 3.1722 - accuracy100: 0.4267 - val_loss: 3.4026 - val_accuracy100: 0.3627 - 22s/epoch - 15ms/step
Epoch 12/50
1532/1532 - 22s - loss: 3.1701 - accuracy100: 0.4270 - val_loss: 3.4432 - val_accuracy100: 0.3602 - 22s/epoch - 15ms/step
Epoch 13/50
1532/1532 - 22s - loss: 3.1666 - accuracy100: 0.4283 - val_loss: 3.4180 - val_accuracy100: 0.3638 - 22s/epoch - 15ms/step
Epoch 14/50
1532/1532 - 22s - loss: 3.1639 - accuracy100: 0.4292 - val_loss: 3.4537 - val_accuracy100: 0.3613 - 22s/epoch - 15ms/step
Epoch 15/50
1532/1532 - 22s - loss: 3.1611 - accuracy100: 0.4294 - val_loss: 3.4538 - val_accuracy100: 0.3627 - 22s/epoch - 15ms/step
Epoch 16/50
1532/1532 - 22s - loss: 3.1602 - accuracy100: 0.4305 - val_loss: 3.4304 - val_accuracy100: 0.3631 - 22s/epoch - 15ms/step
testing model: results/WBA/W8/deepLOB_L1/h100
Evaluating performance on  test set...
3755/3755 - 25s - 25s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1285645
{'0': {'precision': 0.3447488584474886, 'recall': 0.0009549920470033171, 'f1-score': 0.0019047078449365988, 'support': 316233}, '1': {'precision': 0.36551223546627615, 'recall': 0.9081006878215132, 'f1-score': 0.5212288700357388, 'support': 346020}, '2': {'precision': 0.36421372771184923, 'recall': 0.12259543006256064, 'f1-score': 0.18344329752405364, 'support': 298910}, 'accuracy': 0.3653573847515978, 'macro avg': {'precision': 0.3581582738752047, 'recall': 0.34388370331035906, 'f1-score': 0.23552562513490968, 'support': 961163}, 'weighted avg': {'precision': 0.35827704023127643, 'recall': 0.3653573847515978, 'f1-score': 0.24531841232819934, 'support': 961163}}
[[   302 283405  32526]
 [   356 314221  31443]
 [   218 262047  36645]]
Evaluating performance on  train set...
1532/1532 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1212863
{'0': {'precision': 0.3687420802817809, 'recall': 0.13166411042944784, 'f1-score': 0.19404275518334546, 'support': 130400}, '1': {'precision': 0.33628238745332684, 'recall': 0.8836876720709698, 'f1-score': 0.48717359546179906, 'support': 130760}, '2': {'precision': 0.41654210264075736, 'recall': 0.006380656535975149, 'f1-score': 0.012568782511952372, 'support': 131021}, 'accuracy': 0.3405468393420385, 'macro avg': {'precision': 0.37385552345862166, 'recall': 0.34057747967879765, 'f1-score': 0.23126171105236562, 'support': 392181}, 'weighted avg': {'precision': 0.37388862561479497, 'recall': 0.3405468393420385, 'f1-score': 0.2311503338305313, 'support': 392181}}
[[ 17169 112597    634]
 [ 14672 115551    537]
 [ 14720 115465    836]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1105992
{'0': {'precision': 0.35295006421394576, 'recall': 0.12142634369477076, 'f1-score': 0.1806895751551834, 'support': 38476}, '1': {'precision': 0.35257337987267895, 'recall': 0.8934298521057552, 'f1-score': 0.50561599609322, 'support': 41719}, '2': {'precision': 0.3706293706293706, 'recall': 0.004057364499336531, 'f1-score': 0.008026857157280964, 'support': 39188}, 'accuracy': 0.35268002981999114, 'macro avg': {'precision': 0.3587176049053318, 'recall': 0.3396378534332875, 'f1-score': 0.23144414280189482, 'support': 119383}, 'weighted avg': {'precision': 0.35862174079917447, 'recall': 0.35268002981999114, 'f1-score': 0.23755947088750837, 'support': 119383}}
[[ 4672 33689   115]
 [ 4291 37273   155]
 [ 4274 34755   159]]
training model: results/WBA/W8/deepLOB_L1/h200
Epoch 1/50
1532/1532 - 25s - loss: 3.2487 - accuracy200: 0.3978 - val_loss: 3.3540 - val_accuracy200: 0.3488 - 25s/epoch - 16ms/step
Epoch 2/50
1532/1532 - 24s - loss: 3.2275 - accuracy200: 0.4030 - val_loss: 3.3983 - val_accuracy200: 0.3175 - 24s/epoch - 15ms/step
Epoch 3/50
1532/1532 - 23s - loss: 3.2182 - accuracy200: 0.4081 - val_loss: 3.4338 - val_accuracy200: 0.3370 - 23s/epoch - 15ms/step
Epoch 4/50
1532/1532 - 23s - loss: 3.2155 - accuracy200: 0.4070 - val_loss: 3.4362 - val_accuracy200: 0.3462 - 23s/epoch - 15ms/step
Epoch 5/50
1532/1532 - 23s - loss: 3.2121 - accuracy200: 0.4111 - val_loss: 3.4702 - val_accuracy200: 0.3222 - 23s/epoch - 15ms/step
Epoch 6/50
1532/1532 - 23s - loss: 3.2070 - accuracy200: 0.4146 - val_loss: 3.4676 - val_accuracy200: 0.3170 - 23s/epoch - 15ms/step
Epoch 7/50
1532/1532 - 22s - loss: 3.2028 - accuracy200: 0.4171 - val_loss: 3.4663 - val_accuracy200: 0.3131 - 22s/epoch - 15ms/step
Epoch 8/50
1532/1532 - 22s - loss: 3.1997 - accuracy200: 0.4190 - val_loss: 3.4748 - val_accuracy200: 0.3538 - 22s/epoch - 15ms/step
Epoch 9/50
1532/1532 - 23s - loss: 3.1963 - accuracy200: 0.4210 - val_loss: 3.4469 - val_accuracy200: 0.3194 - 23s/epoch - 15ms/step
Epoch 10/50
1532/1532 - 22s - loss: 3.1931 - accuracy200: 0.4228 - val_loss: 3.5021 - val_accuracy200: 0.3481 - 22s/epoch - 15ms/step
Epoch 11/50
1532/1532 - 22s - loss: 3.1885 - accuracy200: 0.4248 - val_loss: 3.5262 - val_accuracy200: 0.3485 - 22s/epoch - 15ms/step
testing model: results/WBA/W8/deepLOB_L1/h200
Evaluating performance on  test set...
3755/3755 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0952488
{'0': {'precision': 0.3062195088713853, 'recall': 0.1545753151386954, 'f1-score': 0.2054449165617164, 'support': 290745}, '1': {'precision': 0.40816335798133613, 'recall': 0.6884369893790849, 'f1-score': 0.5124834293913895, 'support': 391680}, '2': {'precision': 0.29989464373975705, 'recall': 0.16543492455280587, 'f1-score': 0.21323832028522413, 'support': 278738}, 'accuracy': 0.375276618013802, 'macro avg': {'precision': 0.33809250353082615, 'recall': 0.33614907635686203, 'f1-score': 0.31038888874611, 'support': 961163}, 'weighted avg': {'precision': 0.34592805628980006, 'recall': 0.375276618013802, 'f1-score': 0.3328251449644009, 'support': 961163}}
[[ 44942 198116  47687]
 [ 62069 269647  59964]
 [ 39753 192872  46113]]
Evaluating performance on  train set...
1532/1532 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.134001
{'0': {'precision': 0.3355180918274266, 'recall': 0.15274584144024977, 'f1-score': 0.20992332123172205, 'support': 130033}, '1': {'precision': 0.33475291256715345, 'recall': 0.8287998402654052, 'f1-score': 0.47688969801949577, 'support': 130216}, '2': {'precision': 0.3304996694058751, 'recall': 0.0265212382136252, 'f1-score': 0.04910222496649569, 'support': 131932}, 'accuracy': 0.3347535959161714, 'macro avg': {'precision': 0.3335902246001517, 'recall': 0.33602230663976007, 'f1-score': 0.24530508140590448, 'support': 392181}, 'weighted avg': {'precision': 0.33357580219718985, 'recall': 0.3347535959161714, 'f1-score': 0.24446309966905816, 'support': 392181}}
[[ 19862 106700   3471]
 [ 18676 107923   3617]
 [ 20660 107773   3499]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.119793
{'0': {'precision': 0.2765827612509535, 'recall': 0.09728743527139062, 'f1-score': 0.14394315317282308, 'support': 37271}, '1': {'precision': 0.3568194599334687, 'recall': 0.8561659500503156, 'f1-score': 0.5037103816680908, 'support': 43724}, '2': {'precision': 0.33676470588235297, 'recall': 0.011930811711993332, 'f1-score': 0.023045184663379292, 'support': 38388}, 'accuracy': 0.34777983464982454, 'macro avg': {'precision': 0.32338897568892505, 'recall': 0.3217947323445665, 'f1-score': 0.22356623983476434, 'support': 119383}, 'weighted avg': {'precision': 0.3253211402806684, 'recall': 0.34777983464982454, 'f1-score': 0.23683268588339795, 'support': 119383}}
[[ 3626 33178   467]
 [ 5854 37435   435]
 [ 3630 34300   458]]
training model: results/WBA/W8/deepLOB_L1/h300
Epoch 1/50
1532/1532 - 26s - loss: 3.2382 - accuracy300: 0.4077 - val_loss: 3.6945 - val_accuracy300: 0.3564 - 26s/epoch - 17ms/step
Epoch 2/50
1532/1532 - 23s - loss: 3.2117 - accuracy300: 0.4187 - val_loss: 3.6493 - val_accuracy300: 0.3326 - 23s/epoch - 15ms/step
Epoch 3/50
1532/1532 - 23s - loss: 3.2100 - accuracy300: 0.4204 - val_loss: 3.6170 - val_accuracy300: 0.3372 - 23s/epoch - 15ms/step
Epoch 4/50
1532/1532 - 23s - loss: 3.2042 - accuracy300: 0.4256 - val_loss: 3.5120 - val_accuracy300: 0.3600 - 23s/epoch - 15ms/step
Epoch 5/50
1532/1532 - 22s - loss: 3.1965 - accuracy300: 0.4275 - val_loss: 3.5650 - val_accuracy300: 0.3501 - 22s/epoch - 15ms/step
Epoch 6/50
1532/1532 - 23s - loss: 3.1959 - accuracy300: 0.4271 - val_loss: 3.5374 - val_accuracy300: 0.3594 - 23s/epoch - 15ms/step
Epoch 7/50
1532/1532 - 23s - loss: 3.1912 - accuracy300: 0.4291 - val_loss: 3.5096 - val_accuracy300: 0.3298 - 23s/epoch - 15ms/step
Epoch 8/50
1532/1532 - 23s - loss: 3.1916 - accuracy300: 0.4307 - val_loss: 3.5270 - val_accuracy300: 0.3313 - 23s/epoch - 15ms/step
Epoch 9/50
1532/1532 - 22s - loss: 3.1865 - accuracy300: 0.4335 - val_loss: 3.5642 - val_accuracy300: 0.3360 - 22s/epoch - 15ms/step
Epoch 10/50
1532/1532 - 23s - loss: 3.1845 - accuracy300: 0.4336 - val_loss: 3.5588 - val_accuracy300: 0.3313 - 23s/epoch - 15ms/step
Epoch 11/50
1532/1532 - 22s - loss: 3.1763 - accuracy300: 0.4362 - val_loss: 3.5783 - val_accuracy300: 0.3292 - 22s/epoch - 15ms/step
Epoch 12/50
1532/1532 - 22s - loss: 3.1751 - accuracy300: 0.4385 - val_loss: 3.5994 - val_accuracy300: 0.3317 - 22s/epoch - 15ms/step
Epoch 13/50
1532/1532 - 22s - loss: 3.1677 - accuracy300: 0.4410 - val_loss: 3.6352 - val_accuracy300: 0.3222 - 22s/epoch - 15ms/step
Epoch 14/50
1532/1532 - 23s - loss: 3.1632 - accuracy300: 0.4429 - val_loss: 3.6732 - val_accuracy300: 0.3259 - 23s/epoch - 15ms/step
Epoch 15/50
1532/1532 - 23s - loss: 3.1627 - accuracy300: 0.4424 - val_loss: 3.6698 - val_accuracy300: 0.3276 - 23s/epoch - 15ms/step
Epoch 16/50
1532/1532 - 23s - loss: 3.1605 - accuracy300: 0.4430 - val_loss: 3.6953 - val_accuracy300: 0.3244 - 23s/epoch - 15ms/step
Epoch 17/50
1532/1532 - 23s - loss: 3.1623 - accuracy300: 0.4413 - val_loss: 3.6378 - val_accuracy300: 0.3357 - 23s/epoch - 15ms/step
testing model: results/WBA/W8/deepLOB_L1/h300
Evaluating performance on  test set...
3755/3755 - 25s - 25s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1255704
{'0': {'precision': 0.2916666666666667, 'recall': 0.00012487868927327738, 'f1-score': 0.000249650489314959, 'support': 280272}, '1': {'precision': 0.4255607217038762, 'recall': 0.9683271637236732, 'f1-score': 0.5912699449472801, 'support': 408994}, '2': {'precision': 0.26755885834539, 'recall': 0.02992677374152712, 'f1-score': 0.053832337112027756, 'support': 271897}, 'accuracy': 0.42054469429222724, 'macro avg': {'precision': 0.32826208223864434, 'recall': 0.33279293871815785, 'f1-score': 0.21511731084954092, 'support': 961163}, 'weighted avg': {'precision': 0.34182155651028145, 'recall': 0.42054469429222724, 'f1-score': 0.26689820651591684, 'support': 961163}}
[[    35 270864   9373]
 [    52 396040  12902]
 [    33 263727   8137]]
Evaluating performance on  train set...
1532/1532 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1885486
{'0': {'precision': 0.33271449302385914, 'recall': 0.3162737648445989, 'f1-score': 0.32428588360791755, 'support': 129761}, '1': {'precision': 0.3351931477581302, 'recall': 0.6785342574532223, 'f1-score': 0.4487203018252269, 'support': 129709}, '2': {'precision': 0.3571314486503753, 'recall': 0.01684864103201694, 'f1-score': 0.03217914400023026, 'support': 132711}, 'accuracy': 0.3347637952884, 'macro avg': {'precision': 0.3416796964774549, 'recall': 0.3372188877766127, 'f1-score': 0.2683951098111249, 'support': 392181}, 'weighted avg': {'precision': 0.34179678519272544, 'recall': 0.3347637952884, 'f1-score': 0.26659437492308374, 'support': 392181}}
[[41040 86495  2226]
 [39898 88012  1799]
 [42411 88064  2236]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1697829
{'0': {'precision': 0.2952816199528405, 'recall': 0.32377322280566145, 'f1-score': 0.3088717674879854, 'support': 37517}, '1': {'precision': 0.3504821404318892, 'recall': 0.5979562990940056, 'f1-score': 0.4419327493642272, 'support': 43157}, '2': {'precision': 0.33232235701906415, 'recall': 0.03962902684130305, 'f1-score': 0.07081361800346221, 'support': 38709}, 'accuracy': 0.3307589857852458, 'macro avg': {'precision': 0.3260287058012646, 'recall': 0.3204528495803234, 'f1-score': 0.27387271161855825, 'support': 119383}, 'weighted avg': {'precision': 0.3272467971841947, 'recall': 0.3307589857852458, 'f1-score': 0.27978487811878344, 'support': 119383}}
[[12147 23831  1539]
 [15808 25806  1543]
 [13182 23993  1534]]
training model: results/WBA/W8/deepLOB_L1/h500
Epoch 1/50
1532/1532 - 25s - loss: 3.2446 - accuracy500: 0.4048 - val_loss: 3.4899 - val_accuracy500: 0.3238 - 25s/epoch - 16ms/step
Epoch 2/50
1532/1532 - 23s - loss: 3.2191 - accuracy500: 0.4153 - val_loss: 3.4088 - val_accuracy500: 0.3256 - 23s/epoch - 15ms/step
Epoch 3/50
1532/1532 - 23s - loss: 3.2063 - accuracy500: 0.4194 - val_loss: 3.4323 - val_accuracy500: 0.3282 - 23s/epoch - 15ms/step
Epoch 4/50
1532/1532 - 23s - loss: 3.1925 - accuracy500: 0.4276 - val_loss: 3.5526 - val_accuracy500: 0.3271 - 23s/epoch - 15ms/step
Epoch 5/50
1532/1532 - 22s - loss: 3.1767 - accuracy500: 0.4352 - val_loss: 3.6246 - val_accuracy500: 0.3275 - 22s/epoch - 15ms/step
Epoch 6/50
1532/1532 - 23s - loss: 3.1689 - accuracy500: 0.4401 - val_loss: 3.5828 - val_accuracy500: 0.3285 - 23s/epoch - 15ms/step
Epoch 7/50
1532/1532 - 22s - loss: 3.1686 - accuracy500: 0.4399 - val_loss: 3.6584 - val_accuracy500: 0.3255 - 22s/epoch - 15ms/step
Epoch 8/50
1532/1532 - 22s - loss: 3.1615 - accuracy500: 0.4416 - val_loss: 3.6253 - val_accuracy500: 0.3259 - 22s/epoch - 15ms/step
Epoch 9/50
1532/1532 - 23s - loss: 3.1596 - accuracy500: 0.4452 - val_loss: 3.5758 - val_accuracy500: 0.3250 - 23s/epoch - 15ms/step
Epoch 10/50
1532/1532 - 22s - loss: 3.1525 - accuracy500: 0.4466 - val_loss: 3.7017 - val_accuracy500: 0.3253 - 22s/epoch - 15ms/step
Epoch 11/50
1532/1532 - 23s - loss: 3.1447 - accuracy500: 0.4518 - val_loss: 3.6453 - val_accuracy500: 0.3258 - 23s/epoch - 15ms/step
Epoch 12/50
1532/1532 - 23s - loss: 3.1416 - accuracy500: 0.4517 - val_loss: 3.6040 - val_accuracy500: 0.3300 - 23s/epoch - 15ms/step
testing model: results/WBA/W8/deepLOB_L1/h500
Evaluating performance on  test set...
3755/3755 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.11215
{'0': {'precision': 0.2585812356979405, 'recall': 0.0003646867082990431, 'f1-score': 0.0007283462029314323, 'support': 309855}, '1': {'precision': 0.3699435428064667, 'recall': 0.9350843428053889, 'f1-score': 0.5301471614732515, 'support': 353320}, '2': {'precision': 0.3556163168785102, 'recall': 0.08074486220921648, 'f1-score': 0.1316074475998775, 'support': 297988}, 'accuracy': 0.3688843619656603, 'macro avg': {'precision': 0.32804703179430583, 'recall': 0.3387312972409681, 'f1-score': 0.2208276517586868, 'support': 961163}, 'weighted avg': {'precision': 0.32960126052039007, 'recall': 0.3688843619656603, 'f1-score': 0.2359170264563147, 'support': 961163}}
[[   113 288876  20866]
 [   203 330384  22733]
 [   121 273806  24061]]
Evaluating performance on  train set...
1532/1532 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.123714
{'0': {'precision': 0.3337028709968192, 'recall': 0.24753867791842477, 'f1-score': 0.284234214358205, 'support': 130113}, '1': {'precision': 0.3456971042501877, 'recall': 0.6681200802592993, 'f1-score': 0.45563870994905475, 'support': 129580}, '2': {'precision': 0.3643539400371451, 'recall': 0.12438107602197936, 'f1-score': 0.18545319498525736, 'support': 132488}, 'accuracy': 0.34489687159755317, 'macro avg': {'precision': 0.347917971761384, 'recall': 0.3466799447332345, 'f1-score': 0.30844203976417234, 'support': 392181}, 'weighted avg': {'precision': 0.34802052427422475, 'recall': 0.34489687159755317, 'f1-score': 0.30749718437454754, 'support': 392181}}
[[32208 81615 16290]
 [30546 86575 12459]
 [33763 82246 16479]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.137971
{'0': {'precision': 0.30129130914960495, 'recall': 0.1802862008489439, 'f1-score': 0.22558638785083882, 'support': 39343}, '1': {'precision': 0.3206309748905843, 'recall': 0.6318628345102535, 'f1-score': 0.42539866322825115, 'support': 38377}, '2': {'precision': 0.3659707104690283, 'recall': 0.17754362383889782, 'f1-score': 0.2390949494949495, 'support': 41663}, 'accuracy': 0.3244934370890328, 'macro avg': {'precision': 0.3292976648364058, 'recall': 0.32989755306603175, 'f1-score': 0.2966933335246798, 'support': 119383}, 'weighted avg': {'precision': 0.33008046882319925, 'recall': 0.3244934370890328, 'f1-score': 0.2945325769727199, 'support': 119383}}
[[ 7093 25456  6794]
 [ 8107 24249  6021]
 [ 8342 25924  7397]]
training model: results/WBA/W8/deepLOB_L1/h1000
Epoch 1/50
1532/1532 - 25s - loss: 3.2505 - accuracy1000: 0.4048 - val_loss: 3.4094 - val_accuracy1000: 0.3247 - 25s/epoch - 16ms/step
Epoch 2/50
1532/1532 - 23s - loss: 3.1995 - accuracy1000: 0.4242 - val_loss: 3.3899 - val_accuracy1000: 0.3131 - 23s/epoch - 15ms/step
Epoch 3/50
1532/1532 - 22s - loss: 3.1812 - accuracy1000: 0.4329 - val_loss: 3.4642 - val_accuracy1000: 0.3202 - 22s/epoch - 15ms/step
Epoch 4/50
1532/1532 - 23s - loss: 3.1567 - accuracy1000: 0.4461 - val_loss: 3.5058 - val_accuracy1000: 0.3182 - 23s/epoch - 15ms/step
Epoch 5/50
1532/1532 - 23s - loss: 3.1464 - accuracy1000: 0.4499 - val_loss: 3.4665 - val_accuracy1000: 0.3330 - 23s/epoch - 15ms/step
Epoch 6/50
1532/1532 - 22s - loss: 3.1374 - accuracy1000: 0.4547 - val_loss: 3.5337 - val_accuracy1000: 0.3250 - 22s/epoch - 15ms/step
Epoch 7/50
1532/1532 - 22s - loss: 3.1254 - accuracy1000: 0.4590 - val_loss: 3.5598 - val_accuracy1000: 0.3187 - 22s/epoch - 15ms/step
Epoch 8/50
1532/1532 - 22s - loss: 3.1223 - accuracy1000: 0.4599 - val_loss: 3.4925 - val_accuracy1000: 0.3275 - 22s/epoch - 15ms/step
Epoch 9/50
1532/1532 - 22s - loss: 3.1127 - accuracy1000: 0.4627 - val_loss: 3.4961 - val_accuracy1000: 0.3416 - 22s/epoch - 15ms/step
Epoch 10/50
1532/1532 - 22s - loss: 3.1066 - accuracy1000: 0.4651 - val_loss: 3.5544 - val_accuracy1000: 0.3312 - 22s/epoch - 15ms/step
Epoch 11/50
1532/1532 - 23s - loss: 3.1001 - accuracy1000: 0.4668 - val_loss: 3.5700 - val_accuracy1000: 0.3218 - 23s/epoch - 15ms/step
Epoch 12/50
1532/1532 - 22s - loss: 3.0918 - accuracy1000: 0.4704 - val_loss: 3.6043 - val_accuracy1000: 0.3190 - 22s/epoch - 15ms/step
testing model: results/WBA/W8/deepLOB_L1/h1000
Evaluating performance on  test set...
3755/3755 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1057543
{'0': {'precision': 0.2647812971342383, 'recall': 0.010891921488821123, 'f1-score': 0.02092315760304402, 'support': 322349}, '1': {'precision': 0.3589520186952487, 'recall': 0.9001013948326404, 'f1-score': 0.5132319395414253, 'support': 344199}, '2': {'precision': 0.3093306288032454, 'recall': 0.08903144782173344, 'f1-score': 0.13826694534423092, 'support': 294615}, 'accuracy': 0.35327514687935346, 'macro avg': {'precision': 0.3110213148775775, 'recall': 0.3333415880477317, 'f1-score': 0.22414068082956673, 'support': 961163}, 'weighted avg': {'precision': 0.3121597017755351, 'recall': 0.35327514687935346, 'f1-score': 0.23319041139847593, 'support': 961163}}
[[  3511 290597  28241]
 [  4060 309814  30325]
 [  5689 262696  26230]]
Evaluating performance on  train set...
1532/1532 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1374322
{'0': {'precision': 0.3337171256385405, 'recall': 0.350857703240042, 'f1-score': 0.34207282913165266, 'support': 130523}, '1': {'precision': 0.3290602520093553, 'recall': 0.4909422964833884, 'f1-score': 0.3940221798086399, 'support': 128675}, '2': {'precision': 0.3297235498674119, 'recall': 0.15614777828745027, 'f1-score': 0.211931006327822, 'support': 132983}, 'accuracy': 0.3307962394914593, 'macro avg': {'precision': 0.33083364250510255, 'recall': 0.33264925933696027, 'f1-score': 0.3160086717560382, 'support': 392181}, 'weighted avg': {'precision': 0.3308350357336053, 'recall': 0.3307962394914593, 'f1-score': 0.3149882245139876, 'support': 392181}}
[[45795 63902 20826]
 [44117 63172 21386]
 [47315 64903 20765]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1315624
{'0': {'precision': 0.2914649532024763, 'recall': 0.260502438768553, 'f1-score': 0.275115277566224, 'support': 38134}, '1': {'precision': 0.3199772372433718, 'recall': 0.5416841637230443, 'f1-score': 0.4023079181037646, 'support': 40483}, '2': {'precision': 0.32432754816007636, 'recall': 0.13339547662267576, 'f1-score': 0.18903933394747363, 'support': 40766}, 'accuracy': 0.31244817101262323, 'macro avg': {'precision': 0.3119232462019748, 'recall': 0.311860693038091, 'f1-score': 0.28882084320582074, 'support': 119383}, 'weighted avg': {'precision': 0.31235519168592113, 'recall': 0.31244817101262323, 'f1-score': 0.2888539819824246, 'support': 119383}}
[[ 9934 22731  5469]
 [12694 21929  5860]
 [11455 23873  5438]]
training model: results/WBA/W8/deepOF_L1/h10
Epoch 1/50
1532/1532 - 23s - loss: 3.1805 - accuracy10: 0.4334 - val_loss: 3.4262 - val_accuracy10: 0.4949 - 23s/epoch - 15ms/step
Epoch 2/50
1532/1532 - 20s - loss: 3.1731 - accuracy10: 0.4318 - val_loss: 3.2613 - val_accuracy10: 0.5020 - 20s/epoch - 13ms/step
Epoch 3/50
1532/1532 - 20s - loss: 3.1617 - accuracy10: 0.4427 - val_loss: 3.2201 - val_accuracy10: 0.5018 - 20s/epoch - 13ms/step
Epoch 4/50
1532/1532 - 20s - loss: 3.1477 - accuracy10: 0.4529 - val_loss: 3.2249 - val_accuracy10: 0.5031 - 20s/epoch - 13ms/step
Epoch 5/50
1532/1532 - 20s - loss: 3.1389 - accuracy10: 0.4583 - val_loss: 3.2169 - val_accuracy10: 0.5033 - 20s/epoch - 13ms/step
Epoch 6/50
1532/1532 - 20s - loss: 3.1312 - accuracy10: 0.4626 - val_loss: 3.2367 - val_accuracy10: 0.5032 - 20s/epoch - 13ms/step
Epoch 7/50
1532/1532 - 20s - loss: 3.1247 - accuracy10: 0.4653 - val_loss: 3.2232 - val_accuracy10: 0.5058 - 20s/epoch - 13ms/step
Epoch 8/50
1532/1532 - 20s - loss: 3.1167 - accuracy10: 0.4687 - val_loss: 3.2609 - val_accuracy10: 0.5041 - 20s/epoch - 13ms/step
Epoch 9/50
1532/1532 - 20s - loss: 3.1091 - accuracy10: 0.4712 - val_loss: 3.2476 - val_accuracy10: 0.5059 - 20s/epoch - 13ms/step
Epoch 10/50
1532/1532 - 20s - loss: 3.1017 - accuracy10: 0.4743 - val_loss: 3.2616 - val_accuracy10: 0.5065 - 20s/epoch - 13ms/step
Epoch 11/50
1532/1532 - 20s - loss: 3.0969 - accuracy10: 0.4767 - val_loss: 3.2666 - val_accuracy10: 0.5064 - 20s/epoch - 13ms/step
Epoch 12/50
1532/1532 - 20s - loss: 3.0914 - accuracy10: 0.4789 - val_loss: 3.2700 - val_accuracy10: 0.5077 - 20s/epoch - 13ms/step
Epoch 13/50
1532/1532 - 20s - loss: 3.0851 - accuracy10: 0.4801 - val_loss: 3.2877 - val_accuracy10: 0.5066 - 20s/epoch - 13ms/step
Epoch 14/50
1532/1532 - 20s - loss: 3.0784 - accuracy10: 0.4812 - val_loss: 3.3021 - val_accuracy10: 0.5068 - 20s/epoch - 13ms/step
Epoch 15/50
1532/1532 - 20s - loss: 3.0707 - accuracy10: 0.4835 - val_loss: 3.2908 - val_accuracy10: 0.5067 - 20s/epoch - 13ms/step
testing model: results/WBA/W8/deepOF_L1/h10
Evaluating performance on  test set...
3755/3755 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0031556
{'0': {'precision': 0.38215269517310463, 'recall': 0.2130528869226809, 'f1-score': 0.2735818930502255, 'support': 229206}, '1': {'precision': 0.5559714522676678, 'recall': 0.7975594340047238, 'f1-score': 0.6552052580263753, 'support': 511029}, '2': {'precision': 0.444628362882157, 'recall': 0.2018350284940907, 'f1-score': 0.2776385468651252, 'support': 220923}, 'accuracy': 0.52124520630323, 'macro avg': {'precision': 0.4609175034409765, 'recall': 0.4041491164738318, 'f1-score': 0.4021418993139087, 'support': 961158}, 'weighted avg': {'precision': 0.4889288314135192, 'recall': 0.52124520630323, 'f1-score': 0.4774160334424877, 'support': 961158}}
[[ 48833 166052  14321]
 [ 62078 407576  41375]
 [ 16873 159460  44590]]
Evaluating performance on  train set...
1532/1532 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0281855
{'0': {'precision': 0.4127296157962563, 'recall': 0.18435121951219513, 'f1-score': 0.2548640100348658, 'support': 102500}, '1': {'precision': 0.5002197503894106, 'recall': 0.8242664678630385, 'f1-score': 0.622602728706117, 'support': 187790}, '2': {'precision': 0.45909669039049605, 'recall': 0.16650635992462312, 'f1-score': 0.24438026231444604, 'support': 101888}, 'accuracy': 0.4861312975230635, 'macro avg': {'precision': 0.45734868552538765, 'recall': 0.3917080157666189, 'f1-score': 0.3739490003518096, 'support': 392178}, 'weighted avg': {'precision': 0.4666694616609054, 'recall': 0.4861312975230635, 'f1-score': 0.42822785474705294, 'support': 392178}}
[[ 18896  77476   6128]
 [ 19141 154789  13860]
 [  7746  77177  16965]]
Evaluating performance on  val set...
467/467 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0186775
{'0': {'precision': 0.42851516345017726, 'recall': 0.17846012531574976, 'f1-score': 0.2519801750891658, 'support': 30483}, '1': {'precision': 0.5165466428006493, 'recall': 0.8507910388920313, 'f1-score': 0.6428159784502018, 'support': 58341}, '2': {'precision': 0.4900906002265006, 'recall': 0.16993357112470958, 'f1-score': 0.25236301785931237, 'support': 30559}, 'accuracy': 0.5048373721551644, 'macro avg': {'precision': 0.47838413549244235, 'recall': 0.3997282451108302, 'f1-score': 0.38238639046622663, 'support': 119383}, 'weighted avg': {'precision': 0.48729680161669636, 'recall': 0.5048373721551644, 'f1-score': 0.4430748108086494, 'support': 119383}}
[[ 5440 23447  1596]
 [ 4898 49636  3807]
 [ 2357 23009  5193]]
training model: results/WBA/W8/deepOF_L1/h20
Epoch 1/50
1532/1532 - 22s - loss: 3.2074 - accuracy20: 0.4208 - val_loss: 3.4961 - val_accuracy20: 0.3820 - 22s/epoch - 15ms/step
Epoch 2/50
1532/1532 - 20s - loss: 3.2038 - accuracy20: 0.4203 - val_loss: 3.2694 - val_accuracy20: 0.4014 - 20s/epoch - 13ms/step
Epoch 3/50
1532/1532 - 20s - loss: 3.1908 - accuracy20: 0.4261 - val_loss: 3.2928 - val_accuracy20: 0.3961 - 20s/epoch - 13ms/step
Epoch 4/50
1532/1532 - 20s - loss: 3.1773 - accuracy20: 0.4341 - val_loss: 3.3121 - val_accuracy20: 0.3972 - 20s/epoch - 13ms/step
Epoch 5/50
1532/1532 - 20s - loss: 3.1682 - accuracy20: 0.4379 - val_loss: 3.3203 - val_accuracy20: 0.3977 - 20s/epoch - 13ms/step
Epoch 6/50
1532/1532 - 20s - loss: 3.1623 - accuracy20: 0.4399 - val_loss: 3.3093 - val_accuracy20: 0.3949 - 20s/epoch - 13ms/step
Epoch 7/50
1532/1532 - 20s - loss: 3.1553 - accuracy20: 0.4442 - val_loss: 3.3198 - val_accuracy20: 0.3977 - 20s/epoch - 13ms/step
Epoch 8/50
1532/1532 - 20s - loss: 3.1468 - accuracy20: 0.4461 - val_loss: 3.3349 - val_accuracy20: 0.3950 - 20s/epoch - 13ms/step
Epoch 9/50
1532/1532 - 20s - loss: 3.1382 - accuracy20: 0.4502 - val_loss: 3.3319 - val_accuracy20: 0.4014 - 20s/epoch - 13ms/step
Epoch 10/50
1532/1532 - 20s - loss: 3.1328 - accuracy20: 0.4519 - val_loss: 3.3557 - val_accuracy20: 0.4001 - 20s/epoch - 13ms/step
Epoch 11/50
1532/1532 - 20s - loss: 3.1246 - accuracy20: 0.4543 - val_loss: 3.3862 - val_accuracy20: 0.3960 - 20s/epoch - 13ms/step
Epoch 12/50
1532/1532 - 20s - loss: 3.1185 - accuracy20: 0.4558 - val_loss: 3.4087 - val_accuracy20: 0.3964 - 20s/epoch - 13ms/step
testing model: results/WBA/W8/deepOF_L1/h20
Evaluating performance on  test set...
3755/3755 - 21s - 21s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0573835
{'0': {'precision': 0.47074242311415593, 'recall': 0.10993742804573074, 'f1-score': 0.17824696746688323, 'support': 287509}, '1': {'precision': 0.42936400698442445, 'recall': 0.8329494472039737, 'f1-score': 0.5666397851980471, 'support': 399424}, '2': {'precision': 0.46499253017306497, 'recall': 0.2020311787765521, 'f1-score': 0.28167811048602975, 'support': 274225}, 'accuracy': 0.43667118205331484, 'macro avg': {'precision': 0.45503298675721515, 'recall': 0.3816393513420855, 'f1-score': 0.34218828771698667, 'support': 961158}, 'weighted avg': {'precision': 0.4519065013656271, 'recall': 0.43667118205331484, 'f1-score': 0.36915919836323724, 'support': 961158}}
[[ 31608 232884  23017]
 [ 25997 332700  40727]
 [  9540 209283  55402]]
Evaluating performance on  train set...
1532/1532 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.081417
{'0': {'precision': 0.4887238352464551, 'recall': 0.08723214500928002, 'f1-score': 0.1480405792358668, 'support': 124461}, '1': {'precision': 0.3760211920206799, 'recall': 0.8559344967560628, 'f1-score': 0.5225017631622978, 'support': 144115}, '2': {'precision': 0.4792079207920792, 'recall': 0.1625054610766816, 'f1-score': 0.2427061872798564, 'support': 123602}, 'accuracy': 0.39343359392928723, 'macro avg': {'precision': 0.44798431601973804, 'recall': 0.36855736761400815, 'f1-score': 0.30441617655934033, 'support': 392178}, 'weighted avg': {'precision': 0.44430949408791903, 'recall': 0.39343359392928723, 'f1-score': 0.31548070083119034, 'support': 392178}}
[[ 10857 105048   8556]
 [  7489 123353  13273]
 [  3869  99647  20086]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0774249
{'0': {'precision': 0.5159672295602742, 'recall': 0.08181553063442827, 'f1-score': 0.14123569794050342, 'support': 37719}, '1': {'precision': 0.38332076875630267, 'recall': 0.8853712037267362, 'f1-score': 0.5350095654550423, 'support': 44221}, '2': {'precision': 0.5033294859273728, 'recall': 0.15140346660256923, 'f1-score': 0.23278446187328053, 'support': 37443}, 'accuracy': 0.4012882906276438, 'macro avg': {'precision': 0.46753916141464985, 'recall': 0.37286340032124454, 'f1-score': 0.30300990842294206, 'support': 119383}, 'weighted avg': {'precision': 0.4628696011034658, 'recall': 0.4012882906276438, 'f1-score': 0.31580774390429556, 'support': 119383}}
[[ 3086 32403  2230]
 [ 1705 39152  3364]
 [ 1190 30584  5669]]
training model: results/WBA/W8/deepOF_L1/h30
Epoch 1/50
1532/1532 - 23s - loss: 3.2261 - accuracy30: 0.4114 - val_loss: 3.6428 - val_accuracy30: 0.3407 - 23s/epoch - 15ms/step
Epoch 2/50
1532/1532 - 20s - loss: 3.2186 - accuracy30: 0.4139 - val_loss: 3.2873 - val_accuracy30: 0.3701 - 20s/epoch - 13ms/step
Epoch 3/50
1532/1532 - 20s - loss: 3.2106 - accuracy30: 0.4176 - val_loss: 3.2715 - val_accuracy30: 0.3755 - 20s/epoch - 13ms/step
Epoch 4/50
1532/1532 - 20s - loss: 3.2020 - accuracy30: 0.4213 - val_loss: 3.2726 - val_accuracy30: 0.3747 - 20s/epoch - 13ms/step
Epoch 5/50
1532/1532 - 20s - loss: 3.1938 - accuracy30: 0.4259 - val_loss: 3.2738 - val_accuracy30: 0.3742 - 20s/epoch - 13ms/step
Epoch 6/50
1532/1532 - 20s - loss: 3.1893 - accuracy30: 0.4284 - val_loss: 3.2693 - val_accuracy30: 0.3745 - 20s/epoch - 13ms/step
Epoch 7/50
1532/1532 - 20s - loss: 3.1785 - accuracy30: 0.4333 - val_loss: 3.2855 - val_accuracy30: 0.3703 - 20s/epoch - 13ms/step
Epoch 8/50
1532/1532 - 20s - loss: 3.1705 - accuracy30: 0.4357 - val_loss: 3.2955 - val_accuracy30: 0.3663 - 20s/epoch - 13ms/step
Epoch 9/50
1532/1532 - 20s - loss: 3.1645 - accuracy30: 0.4375 - val_loss: 3.3861 - val_accuracy30: 0.3523 - 20s/epoch - 13ms/step
Epoch 10/50
1532/1532 - 20s - loss: 3.1583 - accuracy30: 0.4391 - val_loss: 3.4048 - val_accuracy30: 0.3531 - 20s/epoch - 13ms/step
Epoch 11/50
1532/1532 - 20s - loss: 3.1509 - accuracy30: 0.4413 - val_loss: 3.4704 - val_accuracy30: 0.3474 - 20s/epoch - 13ms/step
Epoch 12/50
1532/1532 - 20s - loss: 3.1467 - accuracy30: 0.4428 - val_loss: 3.5299 - val_accuracy30: 0.3449 - 20s/epoch - 13ms/step
Epoch 13/50
1532/1532 - 20s - loss: 3.1428 - accuracy30: 0.4442 - val_loss: 3.5499 - val_accuracy30: 0.3448 - 20s/epoch - 13ms/step
Epoch 14/50
1532/1532 - 21s - loss: 3.1386 - accuracy30: 0.4464 - val_loss: 3.5443 - val_accuracy30: 0.3448 - 21s/epoch - 13ms/step
Epoch 15/50
1532/1532 - 20s - loss: 3.1343 - accuracy30: 0.4474 - val_loss: 3.5100 - val_accuracy30: 0.3459 - 20s/epoch - 13ms/step
Epoch 16/50
1532/1532 - 20s - loss: 3.1291 - accuracy30: 0.4491 - val_loss: 3.5410 - val_accuracy30: 0.3457 - 20s/epoch - 13ms/step
testing model: results/WBA/W8/deepOF_L1/h30
Evaluating performance on  test set...
3755/3755 - 21s - 21s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0700419
{'0': {'precision': 0.4823966732186075, 'recall': 0.11805610094505092, 'f1-score': 0.18968975679519637, 'support': 305592}, '1': {'precision': 0.39050859952135475, 'recall': 0.8277715725706614, 'f1-score': 0.5306692580789099, 'support': 363494}, '2': {'precision': 0.4891725572443317, 'recall': 0.1940514667616204, 'f1-score': 0.27787270030764705, 'support': 292072}, 'accuracy': 0.4095518114607588, 'macro avg': {'precision': 0.454025943328098, 'recall': 0.37995971342577756, 'f1-score': 0.33274390506058443, 'support': 961158}, 'weighted avg': {'precision': 0.4497051516775624, 'recall': 0.4095518114607588, 'f1-score': 0.3454391460914314, 'support': 961158}}
[[ 36077 246981  22534]
 [ 25952 300890  36652]
 [ 12758 222637  56677]]
Evaluating performance on  train set...
1532/1532 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0909065
{'0': {'precision': 0.5098627491551141, 'recall': 0.1127618844238352, 'f1-score': 0.18467976142147832, 'support': 131117}, '1': {'precision': 0.3438392261927223, 'recall': 0.834924101279741, 'f1-score': 0.4870861694166281, 'support': 130964}, '2': {'precision': 0.4865834218916047, 'recall': 0.16893548659846114, 'f1-score': 0.25079736399166974, 'support': 130097}, 'accuracy': 0.37255531926829144, 'macro avg': {'precision': 0.44676179907981367, 'recall': 0.37220715743401245, 'f1-score': 0.3075210982765921, 'support': 392178}, 'weighted avg': {'precision': 0.4466983816988889, 'recall': 0.37255531926829144, 'f1-score': 0.3075985752209545, 'support': 392178}}
[[ 14785 106467   9865]
 [  8294 109345  13325]
 [  5919 102200  21978]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0891613
{'0': {'precision': 0.5113664751436423, 'recall': 0.10280491173442483, 'f1-score': 0.17119320914089775, 'support': 39823}, '1': {'precision': 0.3453989785661343, 'recall': 0.851898226985876, 'f1-score': 0.49151501578517703, 'support': 39932}, '2': {'precision': 0.5049658597144631, 'recall': 0.16422731402038962, 'f1-score': 0.24784827481148602, 'support': 39628}, 'accuracy': 0.3737550572527077, 'macro avg': {'precision': 0.4539104378080799, 'recall': 0.37297681758023016, 'f1-score': 0.3035188332458536, 'support': 119383}, 'weighted avg': {'precision': 0.4537279699832713, 'recall': 0.3737550572527077, 'f1-score': 0.3037814111907158, 'support': 119383}}
[[ 4094 33030  2699]
 [ 2233 34018  3681]
 [ 1679 31441  6508]]
training model: results/WBA/W8/deepOF_L1/h50
Epoch 1/50
1532/1532 - 22s - loss: 3.2515 - accuracy50: 0.3972 - val_loss: 3.3711 - val_accuracy50: 0.3415 - 22s/epoch - 14ms/step
Epoch 2/50
1532/1532 - 20s - loss: 3.2370 - accuracy50: 0.4039 - val_loss: 3.2862 - val_accuracy50: 0.3559 - 20s/epoch - 13ms/step
Epoch 3/50
1532/1532 - 20s - loss: 3.2308 - accuracy50: 0.4048 - val_loss: 3.2730 - val_accuracy50: 0.3662 - 20s/epoch - 13ms/step
Epoch 4/50
1532/1532 - 20s - loss: 3.2257 - accuracy50: 0.4077 - val_loss: 3.2751 - val_accuracy50: 0.3634 - 20s/epoch - 13ms/step
Epoch 5/50
1532/1532 - 20s - loss: 3.2222 - accuracy50: 0.4101 - val_loss: 3.2746 - val_accuracy50: 0.3636 - 20s/epoch - 13ms/step
Epoch 6/50
1532/1532 - 20s - loss: 3.2172 - accuracy50: 0.4129 - val_loss: 3.2814 - val_accuracy50: 0.3632 - 20s/epoch - 13ms/step
Epoch 7/50
1532/1532 - 20s - loss: 3.2130 - accuracy50: 0.4162 - val_loss: 3.3063 - val_accuracy50: 0.3540 - 20s/epoch - 13ms/step
Epoch 8/50
1532/1532 - 20s - loss: 3.2088 - accuracy50: 0.4184 - val_loss: 3.3042 - val_accuracy50: 0.3530 - 20s/epoch - 13ms/step
Epoch 9/50
1532/1532 - 20s - loss: 3.2050 - accuracy50: 0.4198 - val_loss: 3.3210 - val_accuracy50: 0.3491 - 20s/epoch - 13ms/step
Epoch 10/50
1532/1532 - 20s - loss: 3.1999 - accuracy50: 0.4227 - val_loss: 3.3449 - val_accuracy50: 0.3490 - 20s/epoch - 13ms/step
Epoch 11/50
1532/1532 - 20s - loss: 3.1966 - accuracy50: 0.4236 - val_loss: 3.3752 - val_accuracy50: 0.3452 - 20s/epoch - 13ms/step
Epoch 12/50
1532/1532 - 20s - loss: 3.1926 - accuracy50: 0.4255 - val_loss: 3.4141 - val_accuracy50: 0.3453 - 20s/epoch - 13ms/step
Epoch 13/50
1532/1532 - 20s - loss: 3.1896 - accuracy50: 0.4268 - val_loss: 3.4143 - val_accuracy50: 0.3451 - 20s/epoch - 13ms/step
testing model: results/WBA/W8/deepOF_L1/h50
Evaluating performance on  test set...
3755/3755 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0782415
{'0': {'precision': 0.420637474329734, 'recall': 0.2858957659961085, 'f1-score': 0.34041844336922167, 'support': 310935}, '1': {'precision': 0.3727101716393804, 'recall': 0.7169192792458453, 'f1-score': 0.4904476607202961, 'support': 355683}, '2': {'precision': 0.48645232039234204, 'recall': 0.10843688463366606, 'f1-score': 0.17734184349120066, 'support': 294540}, 'accuracy': 0.3910179179697823, 'macro avg': {'precision': 0.42659998878715216, 'recall': 0.37041730995853994, 'f1-score': 0.33606931586023947, 'support': 961158}, 'weighted avg': {'precision': 0.4230701419623891, 'recall': 0.3910179179697823, 'f1-score': 0.3459641084804832, 'support': 961158}}
[[ 88895 209496  12544]
 [ 79513 254996  21174]
 [ 42926 219675  31939]]
Evaluating performance on  train set...
1532/1532 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0940279
{'0': {'precision': 0.42868174030549455, 'recall': 0.26968970123876607, 'f1-score': 0.3310875662780837, 'support': 131744}, '1': {'precision': 0.3304361096520492, 'recall': 0.7191352303271851, 'f1-score': 0.45281009259979765, 'support': 129468}, '2': {'precision': 0.482420456196426, 'recall': 0.10141563459218424, 'f1-score': 0.16759832931645827, 'support': 130966}, 'accuracy': 0.36186884526924, 'macro avg': {'precision': 0.4138461020513233, 'recall': 0.36341352205271177, 'f1-score': 0.3171653293981132, 'support': 392178}, 'weighted avg': {'precision': 0.4141941335451242, 'recall': 0.36186884526924, 'f1-score': 0.316674826730999, 'support': 392178}}
[[35530 90418  5796]
 [27909 93105  8454]
 [19443 98241 13282]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0916429
{'0': {'precision': 0.4429394432472844, 'recall': 0.2528620204860414, 'f1-score': 0.32193827811606013, 'support': 39832}, '1': {'precision': 0.3347179934124891, 'recall': 0.7497971602434077, 'f1-score': 0.46282543880928717, 'support': 39440}, '2': {'precision': 0.49403254972875227, 'recall': 0.10216648799581163, 'f1-score': 0.16931785315869935, 'support': 40111}, 'accuracy': 0.3664005762964576, 'macro avg': {'precision': 0.4238966621295086, 'recall': 0.3682752229084203, 'f1-score': 0.31802719002801555, 'support': 119383}, 'weighted avg': {'precision': 0.4243533934126667, 'recall': 0.3664005762964576, 'f1-score': 0.31720420167532887, 'support': 119383}}
[[10072 28111  1649]
 [ 7320 29572  2548]
 [ 5347 30666  4098]]
training model: results/WBA/W8/deepOF_L1/h100
Epoch 1/50
1532/1532 - 22s - loss: 3.2793 - accuracy100: 0.3765 - val_loss: 3.3091 - val_accuracy100: 0.3537 - 22s/epoch - 14ms/step
Epoch 2/50
1532/1532 - 20s - loss: 3.2643 - accuracy100: 0.3811 - val_loss: 3.2764 - val_accuracy100: 0.3649 - 20s/epoch - 13ms/step
Epoch 3/50
1532/1532 - 20s - loss: 3.2620 - accuracy100: 0.3823 - val_loss: 3.2672 - val_accuracy100: 0.3671 - 20s/epoch - 13ms/step
Epoch 4/50
1532/1532 - 20s - loss: 3.2594 - accuracy100: 0.3832 - val_loss: 3.2618 - val_accuracy100: 0.3755 - 20s/epoch - 13ms/step
Epoch 5/50
1532/1532 - 20s - loss: 3.2575 - accuracy100: 0.3847 - val_loss: 3.2611 - val_accuracy100: 0.3758 - 20s/epoch - 13ms/step
Epoch 6/50
1532/1532 - 20s - loss: 3.2550 - accuracy100: 0.3868 - val_loss: 3.2601 - val_accuracy100: 0.3786 - 20s/epoch - 13ms/step
Epoch 7/50
1532/1532 - 20s - loss: 3.2525 - accuracy100: 0.3887 - val_loss: 3.2585 - val_accuracy100: 0.3793 - 20s/epoch - 13ms/step
Epoch 8/50
1532/1532 - 20s - loss: 3.2499 - accuracy100: 0.3904 - val_loss: 3.2596 - val_accuracy100: 0.3783 - 20s/epoch - 13ms/step
Epoch 9/50
1532/1532 - 20s - loss: 3.2479 - accuracy100: 0.3912 - val_loss: 3.2598 - val_accuracy100: 0.3777 - 20s/epoch - 13ms/step
Epoch 10/50
1532/1532 - 20s - loss: 3.2451 - accuracy100: 0.3936 - val_loss: 3.2572 - val_accuracy100: 0.3814 - 20s/epoch - 13ms/step
Epoch 11/50
1532/1532 - 20s - loss: 3.2434 - accuracy100: 0.3937 - val_loss: 3.2584 - val_accuracy100: 0.3780 - 20s/epoch - 13ms/step
Epoch 12/50
1532/1532 - 20s - loss: 3.2415 - accuracy100: 0.3950 - val_loss: 3.2616 - val_accuracy100: 0.3762 - 20s/epoch - 13ms/step
Epoch 13/50
1532/1532 - 20s - loss: 3.2382 - accuracy100: 0.3975 - val_loss: 3.2616 - val_accuracy100: 0.3745 - 20s/epoch - 13ms/step
Epoch 14/50
1532/1532 - 20s - loss: 3.2365 - accuracy100: 0.3983 - val_loss: 3.2641 - val_accuracy100: 0.3742 - 20s/epoch - 13ms/step
Epoch 15/50
1532/1532 - 20s - loss: 3.2347 - accuracy100: 0.3999 - val_loss: 3.2664 - val_accuracy100: 0.3699 - 20s/epoch - 13ms/step
Epoch 16/50
1532/1532 - 20s - loss: 3.2328 - accuracy100: 0.4007 - val_loss: 3.2675 - val_accuracy100: 0.3714 - 20s/epoch - 13ms/step
Epoch 17/50
1532/1532 - 20s - loss: 3.2302 - accuracy100: 0.4026 - val_loss: 3.2728 - val_accuracy100: 0.3702 - 20s/epoch - 13ms/step
Epoch 18/50
1532/1532 - 20s - loss: 3.2290 - accuracy100: 0.4036 - val_loss: 3.2743 - val_accuracy100: 0.3689 - 20s/epoch - 13ms/step
Epoch 19/50
1532/1532 - 20s - loss: 3.2270 - accuracy100: 0.4045 - val_loss: 3.2829 - val_accuracy100: 0.3670 - 20s/epoch - 13ms/step
Epoch 20/50
1532/1532 - 20s - loss: 3.2249 - accuracy100: 0.4057 - val_loss: 3.2891 - val_accuracy100: 0.3661 - 20s/epoch - 13ms/step
testing model: results/WBA/W8/deepOF_L1/h100
Evaluating performance on  test set...
3755/3755 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0856966
{'0': {'precision': 0.3830677775076794, 'recall': 0.5481481949960788, 'f1-score': 0.45097574999154466, 'support': 316232}, '1': {'precision': 0.3698902544780359, 'recall': 0.28598512216127486, 'f1-score': 0.3225707607905519, 'support': 346018}, '2': {'precision': 0.3815734903782349, 'recall': 0.30780373894308616, 'f1-score': 0.3407415911767538, 'support': 298908}, 'accuracy': 0.37902509264865925, 'macro avg': {'precision': 0.37817717412131674, 'recall': 0.38064568536681326, 'f1-score': 0.3714293673196168, 'support': 961158}, 'weighted avg': {'precision': 0.3778591494351261, 'recall': 0.37902509264865925, 'f1-score': 0.37046837295638435, 'support': 961158}}
[[173342  77370  65520]
 [163467  98956  83595]
 [115701  91202  92005]]
Evaluating performance on  train set...
1532/1532 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0905588
{'0': {'precision': 0.3863261313836705, 'recall': 0.5418994841607456, 'f1-score': 0.45107553122597477, 'support': 130467}, '1': {'precision': 0.34380107740069826, 'recall': 0.2721586341538108, 'f1-score': 0.3038134796506162, 'support': 130615}, '2': {'precision': 0.3916899078232096, 'recall': 0.31603557698175383, 'f1-score': 0.34981909984759635, 'support': 131096}, 'accuracy': 0.3765611533538342, 'macro avg': {'precision': 0.3739390388691928, 'recall': 0.37669789843210344, 'f1-score': 0.36823603690806245, 'support': 392178}, 'weighted avg': {'precision': 0.37395613538729106, 'recall': 0.3765611533538342, 'f1-score': 0.3681821868912713, 'support': 392178}}
[[70700 30150 29617]
 [60340 35548 34727]
 [51966 37699 41431]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0859525
{'0': {'precision': 0.38362713428703277, 'recall': 0.5397060351095876, 'f1-score': 0.448474909098756, 'support': 38508}, '1': {'precision': 0.3586450582679305, 'recall': 0.25346972098160686, 'f1-score': 0.29702162382700936, 'support': 41646}, '2': {'precision': 0.39502445842068484, 'recall': 0.3602436972647786, 'f1-score': 0.37683323556077014, 'support': 39229}, 'accuracy': 0.38088337535495004, 'macro avg': {'precision': 0.3790988836585494, 'recall': 0.3844731511186577, 'f1-score': 0.37410992282884514, 'support': 119383}, 'weighted avg': {'precision': 0.3786574324915301, 'recall': 0.38088337535495004, 'f1-score': 0.3721000925030195, 'support': 119383}}
[[20783  8368  9357]
 [18804 10556 12286]
 [14588 10509 14132]]
training model: results/WBA/W8/deepOF_L1/h200
Epoch 1/50
1532/1532 - 23s - loss: 3.2824 - accuracy200: 0.3764 - val_loss: 3.2947 - val_accuracy200: 0.3581 - 23s/epoch - 15ms/step
Epoch 2/50
1532/1532 - 20s - loss: 3.2668 - accuracy200: 0.3816 - val_loss: 3.2959 - val_accuracy200: 0.3317 - 20s/epoch - 13ms/step
Epoch 3/50
1532/1532 - 20s - loss: 3.2678 - accuracy200: 0.3817 - val_loss: 3.3019 - val_accuracy200: 0.3403 - 20s/epoch - 13ms/step
Epoch 4/50
1532/1532 - 20s - loss: 3.2735 - accuracy200: 0.3787 - val_loss: 3.3070 - val_accuracy200: 0.3465 - 20s/epoch - 13ms/step
Epoch 5/50
1532/1532 - 20s - loss: 3.2727 - accuracy200: 0.3792 - val_loss: 3.3105 - val_accuracy200: 0.3460 - 20s/epoch - 13ms/step
Epoch 6/50
1532/1532 - 20s - loss: 3.2735 - accuracy200: 0.3789 - val_loss: 3.3133 - val_accuracy200: 0.3453 - 20s/epoch - 13ms/step
Epoch 7/50
1532/1532 - 20s - loss: 3.2721 - accuracy200: 0.3796 - val_loss: 3.3138 - val_accuracy200: 0.3457 - 20s/epoch - 13ms/step
Epoch 8/50
1532/1532 - 20s - loss: 3.2709 - accuracy200: 0.3809 - val_loss: 3.3167 - val_accuracy200: 0.3462 - 20s/epoch - 13ms/step
Epoch 9/50
1532/1532 - 21s - loss: 3.2691 - accuracy200: 0.3816 - val_loss: 3.3186 - val_accuracy200: 0.3458 - 21s/epoch - 13ms/step
Epoch 10/50
1532/1532 - 20s - loss: 3.2678 - accuracy200: 0.3829 - val_loss: 3.3215 - val_accuracy200: 0.3437 - 20s/epoch - 13ms/step
Epoch 11/50
1532/1532 - 20s - loss: 3.2666 - accuracy200: 0.3842 - val_loss: 3.3258 - val_accuracy200: 0.3428 - 20s/epoch - 13ms/step
testing model: results/WBA/W8/deepOF_L1/h200
Evaluating performance on  test set...
3755/3755 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.093777
{'0': {'precision': 0.3214052707945296, 'recall': 0.5371309859978469, 'f1-score': 0.40216526358890897, 'support': 290741}, '1': {'precision': 0.41035130592007685, 'recall': 0.4450072636010611, 'f1-score': 0.4269772193077972, 'support': 391679}, '2': {'precision': 0.33590022765515193, 'recall': 0.060874369479582975, 'f1-score': 0.10306967590272526, 'support': 278738}, 'accuracy': 0.36147438818591743, 'macro avg': {'precision': 0.3558856014565861, 'recall': 0.3476708730261637, 'f1-score': 0.3107373862664771, 'support': 961158}, 'weighted avg': {'precision': 0.3618550088993525, 'recall': 0.36147438818591743, 'f1-score': 0.3255379204086482, 'support': 961158}}
[[156166 121777  12798]
 [196630 174300  20749]
 [133089 128681  16968]]
Evaluating performance on  train set...
1532/1532 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1028687
{'0': {'precision': 0.35073361082206034, 'recall': 0.5183268617123524, 'f1-score': 0.41837054506524335, 'support': 130055}, '1': {'precision': 0.3342608542025529, 'recall': 0.4652899993083361, 'f1-score': 0.389039000928517, 'support': 130121}, '2': {'precision': 0.39411140583554377, 'recall': 0.05627945031135892, 'f1-score': 0.0984938880492138, 'support': 132002}, 'accuracy': 0.34521059314902924, 'macro avg': {'precision': 0.3597019569533857, 'recall': 0.34663210377734915, 'f1-score': 0.30196781134765804, 'support': 392178}, 'weighted avg': {'precision': 0.35986850399119, 'recall': 0.34521059314902924, 'f1-score': 0.30097230157875277, 'support': 392178}}
[[67411 57533  5111]
 [63267 60544  6310]
 [61522 63051  7429]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0984421
{'0': {'precision': 0.3364099414782169, 'recall': 0.49911566084253406, 'f1-score': 0.4019205869659042, 'support': 37316}, '1': {'precision': 0.3728647295605994, 'recall': 0.5048432526506217, 'f1-score': 0.42893136825721095, 'support': 43669}, '2': {'precision': 0.3995503780911506, 'recall': 0.05091411010990156, 'f1-score': 0.0903190039500127, 'support': 38398}, 'accuracy': 0.35705251166413976, 'macro avg': {'precision': 0.36960834970998896, 'recall': 0.3516243412010191, 'f1-score': 0.3070569863910426, 'support': 119383}, 'weighted avg': {'precision': 0.3700530114784094, 'recall': 0.35705251166413976, 'f1-score': 0.31157821178322215, 'support': 119383}}
[[18625 17378  1313]
 [19998 22046  1625]
 [16741 19702  1955]]
training model: results/WBA/W8/deepOF_L1/h300
Epoch 1/50
1532/1532 - 22s - loss: 3.2896 - accuracy300: 0.3763 - val_loss: 3.4583 - val_accuracy300: 0.3624 - 22s/epoch - 15ms/step
Epoch 2/50
1532/1532 - 20s - loss: 3.2893 - accuracy300: 0.3691 - val_loss: 3.3035 - val_accuracy300: 0.3627 - 20s/epoch - 13ms/step
Epoch 3/50
1532/1532 - 20s - loss: 3.2877 - accuracy300: 0.3667 - val_loss: 3.2871 - val_accuracy300: 0.3635 - 20s/epoch - 13ms/step
Epoch 4/50
1532/1532 - 20s - loss: 3.2863 - accuracy300: 0.3648 - val_loss: 3.2853 - val_accuracy300: 0.3643 - 20s/epoch - 13ms/step
Epoch 5/50
1532/1532 - 20s - loss: 3.2860 - accuracy300: 0.3632 - val_loss: 3.2836 - val_accuracy300: 0.3647 - 20s/epoch - 13ms/step
Epoch 6/50
1532/1532 - 20s - loss: 3.2845 - accuracy300: 0.3651 - val_loss: 3.2845 - val_accuracy300: 0.3647 - 20s/epoch - 13ms/step
Epoch 7/50
1532/1532 - 20s - loss: 3.2835 - accuracy300: 0.3662 - val_loss: 3.2840 - val_accuracy300: 0.3642 - 20s/epoch - 13ms/step
Epoch 8/50
1532/1532 - 20s - loss: 3.2816 - accuracy300: 0.3670 - val_loss: 3.2857 - val_accuracy300: 0.3639 - 20s/epoch - 13ms/step
Epoch 9/50
1532/1532 - 20s - loss: 3.2806 - accuracy300: 0.3688 - val_loss: 3.2867 - val_accuracy300: 0.3648 - 20s/epoch - 13ms/step
Epoch 10/50
1532/1532 - 20s - loss: 3.2795 - accuracy300: 0.3697 - val_loss: 3.2875 - val_accuracy300: 0.3636 - 20s/epoch - 13ms/step
Epoch 11/50
1532/1532 - 20s - loss: 3.2791 - accuracy300: 0.3711 - val_loss: 3.2861 - val_accuracy300: 0.3641 - 20s/epoch - 13ms/step
Epoch 12/50
1532/1532 - 21s - loss: 3.2768 - accuracy300: 0.3742 - val_loss: 3.2884 - val_accuracy300: 0.3641 - 21s/epoch - 13ms/step
Epoch 13/50
1532/1532 - 20s - loss: 3.2760 - accuracy300: 0.3752 - val_loss: 3.2877 - val_accuracy300: 0.3649 - 20s/epoch - 13ms/step
Epoch 14/50
1532/1532 - 20s - loss: 3.2746 - accuracy300: 0.3769 - val_loss: 3.2928 - val_accuracy300: 0.3641 - 20s/epoch - 13ms/step
Epoch 15/50
1532/1532 - 20s - loss: 3.2731 - accuracy300: 0.3780 - val_loss: 3.2936 - val_accuracy300: 0.3639 - 20s/epoch - 13ms/step
testing model: results/WBA/W8/deepOF_L1/h300
Evaluating performance on  test set...
3755/3755 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0827594
{'0': {'precision': 0.331181654103408, 'recall': 0.055650107575222374, 'f1-score': 0.09528842511699515, 'support': 280269}, '1': {'precision': 0.42448804480230445, 'recall': 0.9483194088896387, 'f1-score': 0.5864628002201564, 'support': 408993}, '2': {'precision': 0.3333333333333333, 'recall': 0.0004413452202312649, 'f1-score': 0.0008815232722143866, 'support': 271896}, 'accuracy': 0.4198820589330786, 'macro avg': {'precision': 0.3630010107463486, 'recall': 0.3348036205616975, 'f1-score': 0.22754424953645533, 'support': 961158}, 'weighted avg': {'precision': 0.37149416633034005, 'recall': 0.4198820589330786, 'f1-score': 0.27758730023698447, 'support': 961158}}
[[ 15597 264591     81]
 [ 20978 387856    159]
 [ 10520 261256    120]]
Evaluating performance on  train set...
1532/1532 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1021991
{'0': {'precision': 0.37784126195503664, 'recall': 0.0468583927663704, 'f1-score': 0.08337673016308073, 'support': 129838}, '1': {'precision': 0.3301429551875123, 'recall': 0.9570474560064159, 'f1-score': 0.49093354430379743, 'support': 129678}, '2': {'precision': 0.4090909090909091, 'recall': 0.00047489107657053265, 'f1-score': 0.0009486808818214673, 'support': 132662}, 'accuracy': 0.3321323480664392, 'macro avg': {'precision': 0.37235837541115274, 'recall': 0.33479357994978565, 'f1-score': 0.1917529851162332, 'support': 392178}, 'weighted avg': {'precision': 0.37264010243905177, 'recall': 0.3321323480664392, 'f1-score': 0.19025698012710074, 'support': 392178}}
[[  6084 123717     37]
 [  5516 124108     54]
 [  4502 128097     63]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0950515
{'0': {'precision': 0.3962920046349942, 'recall': 0.045646254871603224, 'f1-score': 0.08186322617708308, 'support': 37462}, '1': {'precision': 0.3631542340462528, 'recall': 0.9663389242336611, 'f1-score': 0.5279155739517836, 'support': 43225}, '2': {'precision': 0.5, 'recall': 0.0006202191440975812, 'f1-score': 0.0012389015073301672, 'support': 38696}, 'accuracy': 0.36440699262038984, 'macro avg': {'precision': 0.419815412893749, 'recall': 0.3375351327497873, 'f1-score': 0.2036725672120656, 'support': 119383}, 'weighted avg': {'precision': 0.4179090225935471, 'recall': 0.36440699262038984, 'f1-score': 0.21723236470719764, 'support': 119383}}
[[ 1710 35741    11]
 [ 1442 41770    13]
 [ 1163 37509    24]]
training model: results/WBA/W8/deepOF_L1/h500
Epoch 1/50
1532/1532 - 23s - loss: 3.2957 - accuracy500: 0.3699 - val_loss: 3.3867 - val_accuracy500: 0.3216 - 23s/epoch - 15ms/step
Epoch 2/50
1532/1532 - 20s - loss: 3.2908 - accuracy500: 0.3646 - val_loss: 3.3138 - val_accuracy500: 0.3272 - 20s/epoch - 13ms/step
Epoch 3/50
1532/1532 - 20s - loss: 3.2888 - accuracy500: 0.3625 - val_loss: 3.3050 - val_accuracy500: 0.3285 - 20s/epoch - 13ms/step
Epoch 4/50
1532/1532 - 20s - loss: 3.2868 - accuracy500: 0.3619 - val_loss: 3.3009 - val_accuracy500: 0.3313 - 20s/epoch - 13ms/step
Epoch 5/50
1532/1532 - 20s - loss: 3.2844 - accuracy500: 0.3644 - val_loss: 3.2995 - val_accuracy500: 0.3287 - 20s/epoch - 13ms/step
Epoch 6/50
1532/1532 - 20s - loss: 3.2819 - accuracy500: 0.3660 - val_loss: 3.3027 - val_accuracy500: 0.3270 - 20s/epoch - 13ms/step
Epoch 7/50
1532/1532 - 20s - loss: 3.2786 - accuracy500: 0.3685 - val_loss: 3.3016 - val_accuracy500: 0.3262 - 20s/epoch - 13ms/step
Epoch 8/50
1532/1532 - 21s - loss: 3.2767 - accuracy500: 0.3706 - val_loss: 3.3030 - val_accuracy500: 0.3244 - 21s/epoch - 13ms/step
Epoch 9/50
1532/1532 - 20s - loss: 3.2743 - accuracy500: 0.3724 - val_loss: 3.3049 - val_accuracy500: 0.3250 - 20s/epoch - 13ms/step
Epoch 10/50
1532/1532 - 20s - loss: 3.2720 - accuracy500: 0.3746 - val_loss: 3.3084 - val_accuracy500: 0.3240 - 20s/epoch - 13ms/step
Epoch 11/50
1532/1532 - 20s - loss: 3.2696 - accuracy500: 0.3752 - val_loss: 3.3102 - val_accuracy500: 0.3236 - 20s/epoch - 13ms/step
Epoch 12/50
1532/1532 - 20s - loss: 3.2677 - accuracy500: 0.3765 - val_loss: 3.3171 - val_accuracy500: 0.3227 - 20s/epoch - 13ms/step
Epoch 13/50
1532/1532 - 20s - loss: 3.2652 - accuracy500: 0.3776 - val_loss: 3.3235 - val_accuracy500: 0.3221 - 20s/epoch - 13ms/step
Epoch 14/50
1532/1532 - 20s - loss: 3.2630 - accuracy500: 0.3798 - val_loss: 3.3316 - val_accuracy500: 0.3218 - 20s/epoch - 13ms/step
Epoch 15/50
1532/1532 - 20s - loss: 3.2616 - accuracy500: 0.3810 - val_loss: 3.3382 - val_accuracy500: 0.3218 - 20s/epoch - 13ms/step
testing model: results/WBA/W8/deepOF_L1/h500
Evaluating performance on  test set...
3755/3755 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0959845
{'0': {'precision': 0.33601456331230684, 'recall': 0.23053984011670126, 'f1-score': 0.27345915320419567, 'support': 309851}, '1': {'precision': 0.3674858352105946, 'recall': 0.7618164836408922, 'f1-score': 0.4958048205421038, 'support': 353320}, '2': {'precision': 0.3442521248216391, 'recall': 0.018621617721578457, 'f1-score': 0.03533202167421189, 'support': 297987}, 'accuracy': 0.36013537836651205, 'macro avg': {'precision': 0.3492508411148468, 'recall': 0.336992647159724, 'f1-score': 0.26819866514017043, 'support': 961158}, 'weighted avg': {'precision': 0.3501372320395966, 'recall': 0.36013537836651205, 'f1-score': 0.2813666789602154, 'support': 961158}}
[[ 71433 233934   4484]
 [ 78069 269165   6086]
 [ 63087 229351   5549]]
Evaluating performance on  train set...
1532/1532 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995488
{'0': {'precision': 0.34303944315545243, 'recall': 0.22725700715509886, 'f1-score': 0.27339506372592076, 'support': 130117}, '1': {'precision': 0.3284733273600171, 'recall': 0.7581467848847528, 'f1-score': 0.45835889516887146, 'support': 129591}, '2': {'precision': 0.37394468704512374, 'recall': 0.01939307012908583, 'f1-score': 0.036873833787857045, 'support': 132470}, 'accuracy': 0.33247147978723945, 'macro avg': {'precision': 0.34848581918686444, 'recall': 0.33493228738964587, 'f1-score': 0.25620926422754975, 'support': 392178}, 'weighted avg': {'precision': 0.34866540928822504, 'recall': 0.33247147978723945, 'f1-score': 0.25462216098947993, 'support': 392178}}
[[ 29570  98616   1931]
 [ 28972  98249   2370]
 [ 27658 102243   2569]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1006799
{'0': {'precision': 0.3445024944023255, 'recall': 0.22271319010615065, 'f1-score': 0.2705328911853166, 'support': 39378}, '1': {'precision': 0.3208990082231661, 'recall': 0.7708425749549879, 'f1-score': 0.4531523239760699, 'support': 38323}, '2': {'precision': 0.3857677902621723, 'recall': 0.017297634470514852, 'f1-score': 0.033110605956235224, 'support': 41682}, 'accuracy': 0.3269477228751162, 'macro avg': {'precision': 0.350389764295888, 'recall': 0.33695113317721775, 'f1-score': 0.2522652737058739, 'support': 119383}, 'weighted avg': {'precision': 0.35133314584504527, 'recall': 0.3269477228751162, 'f1-score': 0.2462604975440232, 'support': 119383}}
[[ 8770 30056   552]
 [ 8186 29541   596]
 [ 8501 32460   721]]
training model: results/WBA/W8/deepOF_L1/h1000
Epoch 1/50
1532/1532 - 23s - loss: 3.3073 - accuracy1000: 0.3612 - val_loss: 3.3304 - val_accuracy1000: 0.3334 - 23s/epoch - 15ms/step
Epoch 2/50
1532/1532 - 21s - loss: 3.2974 - accuracy1000: 0.3533 - val_loss: 3.3035 - val_accuracy1000: 0.3209 - 21s/epoch - 14ms/step
Epoch 3/50
1532/1532 - 20s - loss: 3.2955 - accuracy1000: 0.3477 - val_loss: 3.3046 - val_accuracy1000: 0.3201 - 20s/epoch - 13ms/step
Epoch 4/50
1532/1532 - 20s - loss: 3.2942 - accuracy1000: 0.3469 - val_loss: 3.3059 - val_accuracy1000: 0.3202 - 20s/epoch - 13ms/step
Epoch 5/50
1532/1532 - 20s - loss: 3.2934 - accuracy1000: 0.3481 - val_loss: 3.3073 - val_accuracy1000: 0.3208 - 20s/epoch - 13ms/step
Epoch 6/50
1532/1532 - 20s - loss: 3.2928 - accuracy1000: 0.3482 - val_loss: 3.3085 - val_accuracy1000: 0.3207 - 20s/epoch - 13ms/step
Epoch 7/50
1532/1532 - 20s - loss: 3.2917 - accuracy1000: 0.3497 - val_loss: 3.3099 - val_accuracy1000: 0.3207 - 20s/epoch - 13ms/step
Epoch 8/50
1532/1532 - 20s - loss: 3.2904 - accuracy1000: 0.3523 - val_loss: 3.3118 - val_accuracy1000: 0.3206 - 20s/epoch - 13ms/step
Epoch 9/50
1532/1532 - 20s - loss: 3.2893 - accuracy1000: 0.3528 - val_loss: 3.3117 - val_accuracy1000: 0.3206 - 20s/epoch - 13ms/step
Epoch 10/50
1532/1532 - 20s - loss: 3.2880 - accuracy1000: 0.3539 - val_loss: 3.3118 - val_accuracy1000: 0.3207 - 20s/epoch - 13ms/step
Epoch 11/50
1532/1532 - 20s - loss: 3.2866 - accuracy1000: 0.3565 - val_loss: 3.3149 - val_accuracy1000: 0.3204 - 20s/epoch - 13ms/step
Epoch 12/50
1532/1532 - 20s - loss: 3.2853 - accuracy1000: 0.3582 - val_loss: 3.3158 - val_accuracy1000: 0.3201 - 20s/epoch - 13ms/step
testing model: results/WBA/W8/deepOF_L1/h1000
Evaluating performance on  test set...
3755/3755 - 25s - 25s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098274
{'0': {'precision': 0.33605360874673745, 'recall': 0.9298706052794039, 'f1-score': 0.4936889098247455, 'support': 322347}, '1': {'precision': 0.365311280595956, 'recall': 0.04787070232831103, 'f1-score': 0.08464893578764045, 'support': 344198}, '2': {'precision': 0.30771464122770636, 'recall': 0.02518218815870311, 'f1-score': 0.04655453167797743, 'support': 294613}, 'accuracy': 0.3367157116727947, 'macro avg': {'precision': 0.33635984352346665, 'recall': 0.33430783192213936, 'f1-score': 0.2082974590967878, 'support': 961158}, 'weighted avg': {'precision': 0.33784457745060614, 'recall': 0.3367157116727947, 'f1-score': 0.2101534853341027, 'support': 961158}}
[[299741  14927   7679]
 [318709  16477   9012]
 [273494  13700   7419]]
Evaluating performance on  train set...
1532/1532 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1002971
{'0': {'precision': 0.33436919559937134, 'recall': 0.9320563095493398, 'f1-score': 0.4921741029540233, 'support': 130564}, '1': {'precision': 0.3326254313777542, 'recall': 0.04870710431794505, 'f1-score': 0.08497161961467779, 'support': 128626}, '2': {'precision': 0.3588078765300692, 'recall': 0.025348151712936504, 'f1-score': 0.04735115849504505, 'support': 132988}, 'accuracy': 0.3348709004584653, 'macro avg': {'precision': 0.34193416783573155, 'recall': 0.33537052186007377, 'f1-score': 0.20816562702124872, 'support': 392178}, 'weighted avg': {'precision': 0.3420844623477405, 'recall': 0.3348709004584653, 'f1-score': 0.2077804338555087, 'support': 392178}}
[[121693   6079   2792]
 [119129   6265   3232]
 [123126   6491   3371]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013495
{'0': {'precision': 0.3192078460279933, 'recall': 0.9309684861832102, 'f1-score': 0.47540884839640396, 'support': 38142}, '1': {'precision': 0.33131697200138266, 'recall': 0.047380128521997036, 'f1-score': 0.08290446741339792, 'support': 40460}, '2': {'precision': 0.38412563667232597, 'recall': 0.022191706922341285, 'f1-score': 0.04195933885063866, 'support': 40781}, 'accuracy': 0.3210758650729166, 'macro avg': {'precision': 0.3448834849005673, 'recall': 0.33351344054251614, 'f1-score': 0.2000908848868135, 'support': 119383}, 'weighted avg': {'precision': 0.3454875312189322, 'recall': 0.3210758650729166, 'f1-score': 0.19431998563237324, 'support': 119383}}
[[35509  1899   734]
 [37826  1917   717]
 [37906  1970   905]]
training model: results/WBA/W8/deepLOB_L2/h10
Epoch 1/50
1532/1532 - 64s - loss: 3.1259 - accuracy10: 0.4525 - val_loss: 3.4066 - val_accuracy10: 0.4571 - 64s/epoch - 42ms/step
Epoch 2/50
1532/1532 - 61s - loss: 2.9752 - accuracy10: 0.4883 - val_loss: 3.3881 - val_accuracy10: 0.4698 - 61s/epoch - 40ms/step
Epoch 3/50
1532/1532 - 61s - loss: 2.8984 - accuracy10: 0.5078 - val_loss: 3.1656 - val_accuracy10: 0.4767 - 61s/epoch - 40ms/step
Epoch 4/50
1532/1532 - 61s - loss: 2.8599 - accuracy10: 0.5229 - val_loss: 3.1883 - val_accuracy10: 0.4948 - 61s/epoch - 40ms/step
Epoch 5/50
1532/1532 - 61s - loss: 2.8296 - accuracy10: 0.5352 - val_loss: 3.2234 - val_accuracy10: 0.5031 - 61s/epoch - 40ms/step
Epoch 6/50
1532/1532 - 61s - loss: 2.8056 - accuracy10: 0.5425 - val_loss: 3.1929 - val_accuracy10: 0.5130 - 61s/epoch - 40ms/step
Epoch 7/50
1532/1532 - 61s - loss: 2.7838 - accuracy10: 0.5492 - val_loss: 3.1581 - val_accuracy10: 0.5178 - 61s/epoch - 40ms/step
Epoch 8/50
1532/1532 - 62s - loss: 2.7668 - accuracy10: 0.5536 - val_loss: 3.1303 - val_accuracy10: 0.5198 - 62s/epoch - 40ms/step
Epoch 9/50
1532/1532 - 62s - loss: 2.7533 - accuracy10: 0.5568 - val_loss: 3.0511 - val_accuracy10: 0.5214 - 62s/epoch - 40ms/step
Epoch 10/50
1532/1532 - 61s - loss: 2.7417 - accuracy10: 0.5590 - val_loss: 3.1077 - val_accuracy10: 0.5197 - 61s/epoch - 40ms/step
Epoch 11/50
1532/1532 - 61s - loss: 2.7301 - accuracy10: 0.5610 - val_loss: 3.0685 - val_accuracy10: 0.5248 - 61s/epoch - 40ms/step
Epoch 12/50
1532/1532 - 61s - loss: 2.7192 - accuracy10: 0.5629 - val_loss: 3.0368 - val_accuracy10: 0.5213 - 61s/epoch - 40ms/step
Epoch 13/50
1532/1532 - 61s - loss: 2.7094 - accuracy10: 0.5641 - val_loss: 3.0246 - val_accuracy10: 0.5162 - 61s/epoch - 40ms/step
Epoch 14/50
1532/1532 - 61s - loss: 2.7021 - accuracy10: 0.5652 - val_loss: 3.0180 - val_accuracy10: 0.5174 - 61s/epoch - 40ms/step
Epoch 15/50
1532/1532 - 61s - loss: 2.6944 - accuracy10: 0.5670 - val_loss: 3.0201 - val_accuracy10: 0.5252 - 61s/epoch - 40ms/step
Epoch 16/50
1532/1532 - 61s - loss: 2.6863 - accuracy10: 0.5684 - val_loss: 3.0248 - val_accuracy10: 0.5195 - 61s/epoch - 40ms/step
Epoch 17/50
1532/1532 - 61s - loss: 2.6810 - accuracy10: 0.5691 - val_loss: 3.0116 - val_accuracy10: 0.5282 - 61s/epoch - 40ms/step
Epoch 18/50
1532/1532 - 61s - loss: 2.6745 - accuracy10: 0.5697 - val_loss: 2.9941 - val_accuracy10: 0.5165 - 61s/epoch - 40ms/step
Epoch 19/50
1532/1532 - 62s - loss: 2.6675 - accuracy10: 0.5712 - val_loss: 2.9951 - val_accuracy10: 0.5233 - 62s/epoch - 40ms/step
Epoch 20/50
1532/1532 - 61s - loss: 2.6615 - accuracy10: 0.5727 - val_loss: 2.9879 - val_accuracy10: 0.5302 - 61s/epoch - 40ms/step
Epoch 21/50
1532/1532 - 61s - loss: 2.6569 - accuracy10: 0.5733 - val_loss: 2.9760 - val_accuracy10: 0.5222 - 61s/epoch - 40ms/step
Epoch 22/50
1532/1532 - 61s - loss: 2.6503 - accuracy10: 0.5746 - val_loss: 2.9765 - val_accuracy10: 0.5194 - 61s/epoch - 40ms/step
Epoch 23/50
1532/1532 - 61s - loss: 2.6455 - accuracy10: 0.5743 - val_loss: 2.9857 - val_accuracy10: 0.5264 - 61s/epoch - 40ms/step
Epoch 24/50
1532/1532 - 61s - loss: 2.6408 - accuracy10: 0.5763 - val_loss: 2.9868 - val_accuracy10: 0.5235 - 61s/epoch - 40ms/step
Epoch 25/50
1532/1532 - 61s - loss: 2.6364 - accuracy10: 0.5764 - val_loss: 2.9835 - val_accuracy10: 0.5259 - 61s/epoch - 40ms/step
Epoch 26/50
1532/1532 - 61s - loss: 2.6320 - accuracy10: 0.5767 - val_loss: 2.9823 - val_accuracy10: 0.5236 - 61s/epoch - 40ms/step
Epoch 27/50
1532/1532 - 61s - loss: 2.6268 - accuracy10: 0.5778 - val_loss: 2.9852 - val_accuracy10: 0.5191 - 61s/epoch - 40ms/step
Epoch 28/50
1532/1532 - 61s - loss: 2.6226 - accuracy10: 0.5785 - val_loss: 3.0045 - val_accuracy10: 0.5301 - 61s/epoch - 40ms/step
Epoch 29/50
1532/1532 - 61s - loss: 2.6178 - accuracy10: 0.5798 - val_loss: 3.0058 - val_accuracy10: 0.5107 - 61s/epoch - 40ms/step
Epoch 30/50
1532/1532 - 61s - loss: 2.6128 - accuracy10: 0.5809 - val_loss: 3.0136 - val_accuracy10: 0.5160 - 61s/epoch - 40ms/step
Epoch 31/50
1532/1532 - 61s - loss: 2.6094 - accuracy10: 0.5811 - val_loss: 3.0026 - val_accuracy10: 0.5207 - 61s/epoch - 40ms/step
testing model: results/WBA/W8/deepLOB_L2/h10
Evaluating performance on  test set...
3755/3755 - 50s - 50s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.038686
{'0': {'precision': 0.3719876648852867, 'recall': 0.5025980881910238, 'f1-score': 0.42754021213898147, 'support': 229207}, '1': {'precision': 0.6774042266318844, 'recall': 0.40701836092135313, 'f1-score': 0.5085027943340781, 'support': 511031}, '2': {'precision': 0.36239819989838135, 'recall': 0.5649835917166459, 'f1-score': 0.44156363314760766, 'support': 220925}, 'accuracy': 0.4661196904167139, 'macro avg': {'precision': 0.47059669713851754, 'recall': 0.49153334694300765, 'f1-score': 0.4592022132068891, 'support': 961163}, 'weighted avg': {'precision': 0.5321673413956116, 'recall': 0.4661196904167139, 'f1-score': 0.473809693619306, 'support': 961163}}
[[115199  52660  61348]
 [144774 207999 158258]
 [ 49712  46394 124819]]
Evaluating performance on  train set...
1532/1532 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9754876
{'0': {'precision': 0.4567170918943328, 'recall': 0.4932022548618019, 'f1-score': 0.47425899962018014, 'support': 102534}, '1': {'precision': 0.6792872134655747, 'recall': 0.5273594751751901, 'f1-score': 0.5937588057195958, 'support': 187796}, '2': {'precision': 0.4175155902168625, 'recall': 0.5561162875180411, 'f1-score': 0.47695073532817156, 'support': 101851}, 'accuracy': 0.5258974810100439, 'macro avg': {'precision': 0.5178399651922567, 'recall': 0.5255593391850111, 'f1-score': 0.5149895135559825, 'support': 392181}, 'weighted avg': {'precision': 0.5531140779881031, 'recall': 0.5258974810100439, 'f1-score': 0.5321805755247766, 'support': 392181}}
[[50570 23944 28020]
 [37759 99036 51001]
 [22396 22814 56641]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98362255
{'0': {'precision': 0.45735733648432614, 'recall': 0.4318293683347006, 'f1-score': 0.44422690678323684, 'support': 30475}, '1': {'precision': 0.6350189198486412, 'recall': 0.5691577739333002, 'f1-score': 0.6002872447090066, 'support': 58381}, '2': {'precision': 0.4165034088237599, 'recall': 0.5223244996232843, 'f1-score': 0.46345007993024273, 'support': 30527}, 'accuracy': 0.5221262658837523, 'macro avg': {'precision': 0.5029598883855758, 'recall': 0.507770547297095, 'f1-score': 0.5026547438074954, 'support': 119383}, 'weighted avg': {'precision': 0.5337912763978647, 'recall': 0.5221262658837523, 'f1-score': 0.5254594473887084, 'support': 119383}}
[[13160  9832  7483]
 [10298 33228 14855]
 [ 5316  9266 15945]]
training model: results/WBA/W8/deepLOB_L2/h20
Epoch 1/50
1532/1532 - 63s - loss: 3.1525 - accuracy20: 0.4374 - val_loss: 3.5544 - val_accuracy20: 0.3814 - 63s/epoch - 41ms/step
Epoch 2/50
1532/1532 - 61s - loss: 3.0357 - accuracy20: 0.4787 - val_loss: 3.3911 - val_accuracy20: 0.4200 - 61s/epoch - 40ms/step
Epoch 3/50
1532/1532 - 61s - loss: 2.9662 - accuracy20: 0.4962 - val_loss: 3.4280 - val_accuracy20: 0.4060 - 61s/epoch - 40ms/step
Epoch 4/50
1532/1532 - 61s - loss: 2.9272 - accuracy20: 0.5054 - val_loss: 3.3310 - val_accuracy20: 0.4298 - 61s/epoch - 40ms/step
Epoch 5/50
1532/1532 - 61s - loss: 2.9027 - accuracy20: 0.5118 - val_loss: 3.2965 - val_accuracy20: 0.4354 - 61s/epoch - 40ms/step
Epoch 6/50
1532/1532 - 61s - loss: 2.8821 - accuracy20: 0.5179 - val_loss: 3.2591 - val_accuracy20: 0.4437 - 61s/epoch - 40ms/step
Epoch 7/50
1532/1532 - 61s - loss: 2.8669 - accuracy20: 0.5221 - val_loss: 3.2869 - val_accuracy20: 0.4426 - 61s/epoch - 40ms/step
Epoch 8/50
1532/1532 - 61s - loss: 2.8535 - accuracy20: 0.5250 - val_loss: 3.2433 - val_accuracy20: 0.4483 - 61s/epoch - 40ms/step
Epoch 9/50
1532/1532 - 61s - loss: 2.8447 - accuracy20: 0.5271 - val_loss: 3.2601 - val_accuracy20: 0.4442 - 61s/epoch - 40ms/step
Epoch 10/50
1532/1532 - 61s - loss: 2.8330 - accuracy20: 0.5304 - val_loss: 3.2468 - val_accuracy20: 0.4501 - 61s/epoch - 40ms/step
Epoch 11/50
1532/1532 - 61s - loss: 2.8221 - accuracy20: 0.5326 - val_loss: 3.2027 - val_accuracy20: 0.4581 - 61s/epoch - 40ms/step
Epoch 12/50
1532/1532 - 61s - loss: 2.8134 - accuracy20: 0.5343 - val_loss: 3.2175 - val_accuracy20: 0.4572 - 61s/epoch - 40ms/step
Epoch 13/50
1532/1532 - 61s - loss: 2.8050 - accuracy20: 0.5365 - val_loss: 3.1805 - val_accuracy20: 0.4612 - 61s/epoch - 40ms/step
Epoch 14/50
1532/1532 - 61s - loss: 2.7988 - accuracy20: 0.5376 - val_loss: 3.2050 - val_accuracy20: 0.4618 - 61s/epoch - 40ms/step
Epoch 15/50
1532/1532 - 61s - loss: 2.7901 - accuracy20: 0.5398 - val_loss: 3.1758 - val_accuracy20: 0.4667 - 61s/epoch - 40ms/step
Epoch 16/50
1532/1532 - 62s - loss: 2.7831 - accuracy20: 0.5413 - val_loss: 3.1728 - val_accuracy20: 0.4688 - 62s/epoch - 41ms/step
Epoch 17/50
1532/1532 - 61s - loss: 2.7766 - accuracy20: 0.5422 - val_loss: 3.1352 - val_accuracy20: 0.4771 - 61s/epoch - 40ms/step
Epoch 18/50
1532/1532 - 61s - loss: 2.7692 - accuracy20: 0.5442 - val_loss: 3.1574 - val_accuracy20: 0.4726 - 61s/epoch - 40ms/step
Epoch 19/50
1532/1532 - 61s - loss: 2.7627 - accuracy20: 0.5455 - val_loss: 3.1476 - val_accuracy20: 0.4718 - 61s/epoch - 40ms/step
Epoch 20/50
1532/1532 - 61s - loss: 2.7569 - accuracy20: 0.5467 - val_loss: 3.1209 - val_accuracy20: 0.4766 - 61s/epoch - 40ms/step
Epoch 21/50
1532/1532 - 61s - loss: 2.7515 - accuracy20: 0.5482 - val_loss: 3.1310 - val_accuracy20: 0.4744 - 61s/epoch - 40ms/step
Epoch 22/50
1532/1532 - 61s - loss: 2.7466 - accuracy20: 0.5490 - val_loss: 3.1015 - val_accuracy20: 0.4794 - 61s/epoch - 40ms/step
Epoch 23/50
1532/1532 - 61s - loss: 2.7405 - accuracy20: 0.5501 - val_loss: 3.1122 - val_accuracy20: 0.4785 - 61s/epoch - 40ms/step
Epoch 24/50
1532/1532 - 61s - loss: 2.7345 - accuracy20: 0.5515 - val_loss: 3.1483 - val_accuracy20: 0.4729 - 61s/epoch - 40ms/step
Epoch 25/50
1532/1532 - 61s - loss: 2.7306 - accuracy20: 0.5528 - val_loss: 3.1395 - val_accuracy20: 0.4776 - 61s/epoch - 40ms/step
Epoch 26/50
1532/1532 - 61s - loss: 2.7252 - accuracy20: 0.5532 - val_loss: 3.1759 - val_accuracy20: 0.4735 - 61s/epoch - 40ms/step
Epoch 27/50
1532/1532 - 61s - loss: 2.7211 - accuracy20: 0.5547 - val_loss: 3.1826 - val_accuracy20: 0.4726 - 61s/epoch - 40ms/step
Epoch 28/50
1532/1532 - 61s - loss: 2.7155 - accuracy20: 0.5557 - val_loss: 3.1955 - val_accuracy20: 0.4720 - 61s/epoch - 40ms/step
Epoch 29/50
1532/1532 - 61s - loss: 2.7120 - accuracy20: 0.5563 - val_loss: 3.2200 - val_accuracy20: 0.4695 - 61s/epoch - 40ms/step
Epoch 30/50
1532/1532 - 61s - loss: 2.7075 - accuracy20: 0.5574 - val_loss: 3.2173 - val_accuracy20: 0.4696 - 61s/epoch - 40ms/step
Epoch 31/50
1532/1532 - 61s - loss: 2.7032 - accuracy20: 0.5587 - val_loss: 3.2161 - val_accuracy20: 0.4670 - 61s/epoch - 40ms/step
Epoch 32/50
1532/1532 - 61s - loss: 2.6976 - accuracy20: 0.5599 - val_loss: 3.2062 - val_accuracy20: 0.4711 - 61s/epoch - 40ms/step
testing model: results/WBA/W8/deepLOB_L2/h20
Evaluating performance on  test set...
3755/3755 - 50s - 50s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0496402
{'0': {'precision': 0.5846061153788221, 'recall': 0.13499356544120206, 'f1-score': 0.2193387962701328, 'support': 287510}, '1': {'precision': 0.47499745290708206, 'recall': 0.8403955686299055, 'f1-score': 0.6069452216907314, 'support': 399425}, '2': {'precision': 0.48842278756944996, 'recall': 0.33499496769111836, 'f1-score': 0.39741473849967446, 'support': 274228}, 'accuracy': 0.4851955391541289, 'macro avg': {'precision': 0.5160087852851181, 'recall': 0.43679470058740866, 'f1-score': 0.4078995854868462, 'support': 961163}, 'weighted avg': {'precision': 0.5116147480183606, 'recall': 0.4851955391541289, 'f1-score': 0.43122076213788396, 'support': 961163}}
[[ 38812 204993  43705]
 [ 11235 335675  52515]
 [ 16343 166020  91865]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9862235
{'0': {'precision': 0.5129381167908229, 'recall': 0.4084720728241848, 'f1-score': 0.45478310997108723, 'support': 124574}, '1': {'precision': 0.5316318335366713, 'recall': 0.6021373218898425, 'f1-score': 0.5646923219687225, 'support': 144012}, '2': {'precision': 0.47145926216821826, 'recall': 0.4953841174804806, 'f1-score': 0.48312567564368625, 'support': 123595}, 'accuracy': 0.5069776455259178, 'macro avg': {'precision': 0.5053430708319041, 'recall': 0.5019978373981693, 'f1-score': 0.5008670358611654, 'support': 392181}, 'weighted avg': {'precision': 0.5067306271340631, 'recall': 0.5069776455259178, 'f1-score': 0.5040747504190138, 'support': 392181}}
[[50885 39866 33823]
 [22480 86715 34817]
 [25838 36530 61227]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0241205
{'0': {'precision': 0.520181790171006, 'recall': 0.3575569851481217, 'f1-score': 0.4238040698495379, 'support': 37773}, '1': {'precision': 0.4728151015793621, 'recall': 0.6250877550558236, 'f1-score': 0.5383917686643586, 'support': 44157}, '2': {'precision': 0.46160212322707683, 'recall': 0.4318746161856193, 'f1-score': 0.44624382707534416, 'support': 37453}, 'accuracy': 0.47982543578231407, 'macro avg': {'precision': 0.48486633832581494, 'recall': 0.47150645212985487, 'f1-score': 0.46947988852974687, 'support': 119383}, 'weighted avg': {'precision': 0.4842842575726277, 'recall': 0.47982543578231407, 'f1-score': 0.47322723096916264, 'support': 119383}}
[[13506 15394  8873]
 [ 6562 27602  9993]
 [ 5896 15382 16175]]
training model: results/WBA/W8/deepLOB_L2/h30
Epoch 1/50
1532/1532 - 64s - loss: 3.1618 - accuracy30: 0.4292 - val_loss: 3.4547 - val_accuracy30: 0.3505 - 64s/epoch - 41ms/step
Epoch 2/50
1532/1532 - 61s - loss: 3.0687 - accuracy30: 0.4610 - val_loss: 3.4445 - val_accuracy30: 0.3550 - 61s/epoch - 40ms/step
Epoch 3/50
1532/1532 - 61s - loss: 3.0226 - accuracy30: 0.4753 - val_loss: 3.4248 - val_accuracy30: 0.3624 - 61s/epoch - 40ms/step
Epoch 4/50
1532/1532 - 61s - loss: 2.9939 - accuracy30: 0.4847 - val_loss: 3.4144 - val_accuracy30: 0.3725 - 61s/epoch - 40ms/step
Epoch 5/50
1532/1532 - 61s - loss: 2.9736 - accuracy30: 0.4907 - val_loss: 3.3601 - val_accuracy30: 0.3913 - 61s/epoch - 40ms/step
Epoch 6/50
1532/1532 - 61s - loss: 2.9591 - accuracy30: 0.4948 - val_loss: 3.3442 - val_accuracy30: 0.3991 - 61s/epoch - 40ms/step
Epoch 7/50
1532/1532 - 61s - loss: 2.9458 - accuracy30: 0.4988 - val_loss: 3.3120 - val_accuracy30: 0.4142 - 61s/epoch - 40ms/step
Epoch 8/50
1532/1532 - 61s - loss: 2.9352 - accuracy30: 0.5018 - val_loss: 3.3077 - val_accuracy30: 0.4201 - 61s/epoch - 40ms/step
Epoch 9/50
1532/1532 - 61s - loss: 2.9260 - accuracy30: 0.5043 - val_loss: 3.3056 - val_accuracy30: 0.4265 - 61s/epoch - 40ms/step
Epoch 10/50
1532/1532 - 61s - loss: 2.9182 - accuracy30: 0.5068 - val_loss: 3.2704 - val_accuracy30: 0.4253 - 61s/epoch - 40ms/step
Epoch 11/50
1532/1532 - 61s - loss: 2.9096 - accuracy30: 0.5096 - val_loss: 3.2481 - val_accuracy30: 0.4315 - 61s/epoch - 40ms/step
Epoch 12/50
1532/1532 - 61s - loss: 2.9034 - accuracy30: 0.5104 - val_loss: 3.2552 - val_accuracy30: 0.4307 - 61s/epoch - 40ms/step
Epoch 13/50
1532/1532 - 61s - loss: 2.8967 - accuracy30: 0.5124 - val_loss: 3.2428 - val_accuracy30: 0.4308 - 61s/epoch - 40ms/step
Epoch 14/50
1532/1532 - 60s - loss: 2.8902 - accuracy30: 0.5144 - val_loss: 3.2365 - val_accuracy30: 0.4293 - 60s/epoch - 39ms/step
Epoch 15/50
1532/1532 - 61s - loss: 2.8850 - accuracy30: 0.5154 - val_loss: 3.2365 - val_accuracy30: 0.4300 - 61s/epoch - 40ms/step
Epoch 16/50
1532/1532 - 61s - loss: 2.8771 - accuracy30: 0.5173 - val_loss: 3.2342 - val_accuracy30: 0.4308 - 61s/epoch - 40ms/step
Epoch 17/50
1532/1532 - 61s - loss: 2.8719 - accuracy30: 0.5192 - val_loss: 3.2555 - val_accuracy30: 0.4321 - 61s/epoch - 40ms/step
Epoch 18/50
1532/1532 - 61s - loss: 2.8661 - accuracy30: 0.5204 - val_loss: 3.2460 - val_accuracy30: 0.4334 - 61s/epoch - 40ms/step
Epoch 19/50
1532/1532 - 61s - loss: 2.8616 - accuracy30: 0.5213 - val_loss: 3.2616 - val_accuracy30: 0.4341 - 61s/epoch - 40ms/step
Epoch 20/50
1532/1532 - 61s - loss: 2.8562 - accuracy30: 0.5227 - val_loss: 3.2299 - val_accuracy30: 0.4380 - 61s/epoch - 40ms/step
Epoch 21/50
1532/1532 - 61s - loss: 2.8511 - accuracy30: 0.5246 - val_loss: 3.2638 - val_accuracy30: 0.4323 - 61s/epoch - 40ms/step
Epoch 22/50
1532/1532 - 61s - loss: 2.8459 - accuracy30: 0.5259 - val_loss: 3.2590 - val_accuracy30: 0.4336 - 61s/epoch - 40ms/step
Epoch 23/50
1532/1532 - 61s - loss: 2.8393 - accuracy30: 0.5273 - val_loss: 3.2782 - val_accuracy30: 0.4327 - 61s/epoch - 40ms/step
Epoch 24/50
1532/1532 - 61s - loss: 2.8347 - accuracy30: 0.5284 - val_loss: 3.3228 - val_accuracy30: 0.4261 - 61s/epoch - 40ms/step
Epoch 25/50
1532/1532 - 61s - loss: 2.8304 - accuracy30: 0.5299 - val_loss: 3.2815 - val_accuracy30: 0.4328 - 61s/epoch - 40ms/step
Epoch 26/50
1532/1532 - 61s - loss: 2.8265 - accuracy30: 0.5302 - val_loss: 3.3264 - val_accuracy30: 0.4272 - 61s/epoch - 40ms/step
Epoch 27/50
1532/1532 - 61s - loss: 2.8213 - accuracy30: 0.5313 - val_loss: 3.3160 - val_accuracy30: 0.4302 - 61s/epoch - 40ms/step
Epoch 28/50
1532/1532 - 61s - loss: 2.8184 - accuracy30: 0.5327 - val_loss: 3.3467 - val_accuracy30: 0.4259 - 61s/epoch - 40ms/step
Epoch 29/50
1532/1532 - 61s - loss: 2.8117 - accuracy30: 0.5340 - val_loss: 3.3630 - val_accuracy30: 0.4237 - 61s/epoch - 40ms/step
Epoch 30/50
1532/1532 - 61s - loss: 2.8075 - accuracy30: 0.5355 - val_loss: 3.4068 - val_accuracy30: 0.4185 - 61s/epoch - 40ms/step
testing model: results/WBA/W8/deepLOB_L2/h30
Evaluating performance on  test set...
3755/3755 - 50s - 50s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0648499
{'0': {'precision': 0.49707172495554236, 'recall': 0.20580246994378162, 'f1-score': 0.29108648312154756, 'support': 305594}, '1': {'precision': 0.42625822811456554, 'recall': 0.8467457509615014, 'f1-score': 0.5670561120010759, 'support': 363494}, '2': {'precision': 0.45519716445620984, 'recall': 0.17544123940768638, 'f1-score': 0.25326828882529423, 'support': 292075}, 'accuracy': 0.43896924871223714, 'macro avg': {'precision': 0.4595090391754392, 'recall': 0.4093298201043231, 'f1-score': 0.37047029464930586, 'support': 961163}, 'weighted avg': {'precision': 0.45756667380547045, 'recall': 0.43896924871223714, 'f1-score': 0.38396100615339235, 'support': 961163}}
[[ 62892 209522  33180]
 [ 27558 307787  28149]
 [ 36075 204758  51242]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0497868
{'0': {'precision': 0.44721829726608076, 'recall': 0.5815911066379981, 'f1-score': 0.5056294847786819, 'support': 131154}, '1': {'precision': 0.48297150716619, 'recall': 0.4720917264401005, 'f1-score': 0.47746964727878144, 'support': 130911}, '2': {'precision': 0.4540455700527451, 'recall': 0.32682375726275015, 'f1-score': 0.3800709644552093, 'support': 130116}, 'accuracy': 0.4605144053383514, 'macro avg': {'precision': 0.4614117914950053, 'recall': 0.46016886344694957, 'f1-score': 0.4543900321708909, 'support': 392181}, 'weighted avg': {'precision': 0.4614179292909438, 'recall': 0.4605144053383514, 'f1-score': 0.454572434800844, 'support': 392181}}
[[76278 32242 22634]
 [40610 61802 28499]
 [53673 33918 42525]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0769714
{'0': {'precision': 0.4418077124411098, 'recall': 0.5086763265613621, 'f1-score': 0.4728898434672986, 'support': 39821}, '1': {'precision': 0.43535119692641117, 'recall': 0.4430881062789823, 'f1-score': 0.43918557994509244, 'support': 39895}, '2': {'precision': 0.4368831799823874, 'recall': 0.3626944311392341, 'f1-score': 0.3963470068045951, 'support': 39667}, 'accuracy': 0.4382533526549006, 'macro avg': {'precision': 0.4380140297833028, 'recall': 0.4381529546598595, 'f1-score': 0.43614081007232874, 'support': 119383}, 'weighted avg': {'precision': 0.43801383797406634, 'recall': 0.4382533526549006, 'f1-score': 0.436194030033913, 'support': 119383}}
[[20256 11096  8469]
 [12143 17677 10075]
 [13449 11831 14387]]
training model: results/WBA/W8/deepLOB_L2/h50
Epoch 1/50
1532/1532 - 65s - loss: 3.2124 - accuracy50: 0.4122 - val_loss: 3.5096 - val_accuracy50: 0.3484 - 65s/epoch - 42ms/step
Epoch 2/50
1532/1532 - 63s - loss: 3.1301 - accuracy50: 0.4421 - val_loss: 3.4291 - val_accuracy50: 0.3719 - 63s/epoch - 41ms/step
Epoch 3/50
1532/1532 - 61s - loss: 3.1063 - accuracy50: 0.4514 - val_loss: 3.3668 - val_accuracy50: 0.3768 - 61s/epoch - 40ms/step
Epoch 4/50
1532/1532 - 62s - loss: 3.0942 - accuracy50: 0.4557 - val_loss: 3.2826 - val_accuracy50: 0.3960 - 62s/epoch - 40ms/step
Epoch 5/50
1532/1532 - 61s - loss: 3.0843 - accuracy50: 0.4593 - val_loss: 3.2780 - val_accuracy50: 0.4064 - 61s/epoch - 40ms/step
Epoch 6/50
1532/1532 - 61s - loss: 3.0746 - accuracy50: 0.4630 - val_loss: 3.2915 - val_accuracy50: 0.4024 - 61s/epoch - 40ms/step
Epoch 7/50
1532/1532 - 61s - loss: 3.0667 - accuracy50: 0.4657 - val_loss: 3.2875 - val_accuracy50: 0.4034 - 61s/epoch - 40ms/step
Epoch 8/50
1532/1532 - 61s - loss: 3.0600 - accuracy50: 0.4676 - val_loss: 3.2934 - val_accuracy50: 0.4064 - 61s/epoch - 40ms/step
Epoch 9/50
1532/1532 - 61s - loss: 3.0536 - accuracy50: 0.4697 - val_loss: 3.2651 - val_accuracy50: 0.4086 - 61s/epoch - 40ms/step
Epoch 10/50
1532/1532 - 60s - loss: 3.0467 - accuracy50: 0.4733 - val_loss: 3.2861 - val_accuracy50: 0.4044 - 60s/epoch - 39ms/step
Epoch 11/50
1532/1532 - 61s - loss: 3.0419 - accuracy50: 0.4752 - val_loss: 3.3090 - val_accuracy50: 0.3992 - 61s/epoch - 40ms/step
Epoch 12/50
1532/1532 - 60s - loss: 3.0360 - accuracy50: 0.4767 - val_loss: 3.3173 - val_accuracy50: 0.3950 - 60s/epoch - 39ms/step
Epoch 13/50
1532/1532 - 61s - loss: 3.0302 - accuracy50: 0.4787 - val_loss: 3.3169 - val_accuracy50: 0.3943 - 61s/epoch - 40ms/step
Epoch 14/50
1532/1532 - 61s - loss: 3.0251 - accuracy50: 0.4801 - val_loss: 3.3326 - val_accuracy50: 0.3905 - 61s/epoch - 40ms/step
Epoch 15/50
1532/1532 - 61s - loss: 3.0202 - accuracy50: 0.4822 - val_loss: 3.3604 - val_accuracy50: 0.3869 - 61s/epoch - 40ms/step
Epoch 16/50
1532/1532 - 61s - loss: 3.0155 - accuracy50: 0.4830 - val_loss: 3.3693 - val_accuracy50: 0.3864 - 61s/epoch - 40ms/step
Epoch 17/50
1532/1532 - 61s - loss: 3.0112 - accuracy50: 0.4850 - val_loss: 3.3805 - val_accuracy50: 0.3877 - 61s/epoch - 40ms/step
Epoch 18/50
1532/1532 - 61s - loss: 3.0068 - accuracy50: 0.4865 - val_loss: 3.4084 - val_accuracy50: 0.3822 - 61s/epoch - 40ms/step
Epoch 19/50
1532/1532 - 61s - loss: 3.0021 - accuracy50: 0.4874 - val_loss: 3.4140 - val_accuracy50: 0.3840 - 61s/epoch - 40ms/step
testing model: results/WBA/W8/deepLOB_L2/h50
Evaluating performance on  test set...
3755/3755 - 50s - 50s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1073643
{'0': {'precision': 0.4573911004585244, 'recall': 0.11292641274599034, 'f1-score': 0.18113256212842238, 'support': 310937}, '1': {'precision': 0.42883052667842014, 'recall': 0.3569713565974292, 'f1-score': 0.3896152913775803, 'support': 355684}, '2': {'precision': 0.3493259540414711, 'recall': 0.6977375043287545, 'f1-score': 0.46556456043178096, 'support': 294542}, 'accuracy': 0.38244813834906255, 'macro avg': {'precision': 0.41184919372613854, 'recall': 0.38921175789072465, 'f1-score': 0.34543747131259456, 'support': 961163}, 'weighted avg': {'precision': 0.41370624837789466, 'recall': 0.38244813834906255, 'f1-score': 0.34544510923492283, 'support': 961163}}
[[ 35113 102896 172928]
 [ 18843 126969 209872]
 [ 22812  66217 205513]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0841584
{'0': {'precision': 0.41853379457158063, 'recall': 0.47742415274173233, 'f1-score': 0.44604357350991497, 'support': 131778}, '1': {'precision': 0.4237564514922582, 'recall': 0.438015123165659, 'f1-score': 0.43076782699940697, 'support': 129338}, '2': {'precision': 0.420380693531538, 'recall': 0.3469499866478465, 'f1-score': 0.3801518166162283, 'support': 131065}, 'accuracy': 0.4208235483106015, 'macro avg': {'precision': 0.42089031319845893, 'recall': 0.4207964208517459, 'f1-score': 0.4189877390418501, 'support': 392181}, 'weighted avg': {'precision': 0.4208734076915263, 'recall': 0.4208235483106015, 'f1-score': 0.41898505303226025, 'support': 392181}}
[[62914 39574 29290]
 [39278 56652 33408]
 [48128 37464 45473]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.088417
{'0': {'precision': 0.4170093104589064, 'recall': 0.4431470041685501, 'f1-score': 0.42968103238373506, 'support': 39822}, '1': {'precision': 0.3954013875123885, 'recall': 0.5054605346509565, 'f1-score': 0.4437079463938164, 'support': 39465}, '2': {'precision': 0.42472290061995116, 'recall': 0.28192338387869115, 'f1-score': 0.33889463506768003, 'support': 40096}, 'accuracy': 0.4095976814119263, 'macro avg': {'precision': 0.412377866197082, 'recall': 0.4101769742327326, 'f1-score': 0.4040945379484105, 'support': 119383}, 'weighted avg': {'precision': 0.41245696575331947, 'recall': 0.4095976814119263, 'f1-score': 0.40382643645821226, 'support': 119383}}
[[17647 14948  7227]
 [11433 19948  8084]
 [13238 15554 11304]]
training model: results/WBA/W8/deepLOB_L2/h100
Epoch 1/50
1532/1532 - 65s - loss: 3.2604 - accuracy100: 0.3890 - val_loss: 3.4129 - val_accuracy100: 0.3544 - 65s/epoch - 42ms/step
Epoch 2/50
1532/1532 - 61s - loss: 3.2209 - accuracy100: 0.4056 - val_loss: 3.4157 - val_accuracy100: 0.3545 - 61s/epoch - 40ms/step
Epoch 3/50
1532/1532 - 61s - loss: 3.1998 - accuracy100: 0.4177 - val_loss: 3.3874 - val_accuracy100: 0.3577 - 61s/epoch - 40ms/step
Epoch 4/50
1532/1532 - 61s - loss: 3.1882 - accuracy100: 0.4213 - val_loss: 3.3477 - val_accuracy100: 0.3555 - 61s/epoch - 40ms/step
Epoch 5/50
1532/1532 - 61s - loss: 3.1750 - accuracy100: 0.4279 - val_loss: 3.3469 - val_accuracy100: 0.3566 - 61s/epoch - 40ms/step
Epoch 6/50
1532/1532 - 61s - loss: 3.1664 - accuracy100: 0.4319 - val_loss: 3.3580 - val_accuracy100: 0.3580 - 61s/epoch - 40ms/step
Epoch 7/50
1532/1532 - 61s - loss: 3.1620 - accuracy100: 0.4333 - val_loss: 3.3748 - val_accuracy100: 0.3567 - 61s/epoch - 40ms/step
Epoch 8/50
1532/1532 - 61s - loss: 3.1560 - accuracy100: 0.4351 - val_loss: 3.3704 - val_accuracy100: 0.3573 - 61s/epoch - 40ms/step
Epoch 9/50
1532/1532 - 61s - loss: 3.1505 - accuracy100: 0.4373 - val_loss: 3.3733 - val_accuracy100: 0.3564 - 61s/epoch - 40ms/step
Epoch 10/50
1532/1532 - 61s - loss: 3.1458 - accuracy100: 0.4384 - val_loss: 3.3663 - val_accuracy100: 0.3544 - 61s/epoch - 40ms/step
Epoch 11/50
1532/1532 - 61s - loss: 3.1403 - accuracy100: 0.4410 - val_loss: 3.3686 - val_accuracy100: 0.3571 - 61s/epoch - 40ms/step
Epoch 12/50
1532/1532 - 61s - loss: 3.1351 - accuracy100: 0.4431 - val_loss: 3.3709 - val_accuracy100: 0.3571 - 61s/epoch - 40ms/step
Epoch 13/50
1532/1532 - 61s - loss: 3.1292 - accuracy100: 0.4449 - val_loss: 3.3541 - val_accuracy100: 0.3594 - 61s/epoch - 40ms/step
Epoch 14/50
1532/1532 - 61s - loss: 3.1230 - accuracy100: 0.4481 - val_loss: 3.3475 - val_accuracy100: 0.3576 - 61s/epoch - 40ms/step
Epoch 15/50
1532/1532 - 61s - loss: 3.1187 - accuracy100: 0.4494 - val_loss: 3.3646 - val_accuracy100: 0.3561 - 61s/epoch - 40ms/step
testing model: results/WBA/W8/deepLOB_L2/h100
Evaluating performance on  test set...
3755/3755 - 50s - 50s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1266687
{'0': {'precision': 0.3795811518324607, 'recall': 0.0022926133578722017, 'f1-score': 0.004557698896408219, 'support': 316233}, '1': {'precision': 0.3649352122197292, 'recall': 0.9485636668400671, 'f1-score': 0.5270872911745293, 'support': 346020}, '2': {'precision': 0.3594854231058391, 'recall': 0.07198487839148908, 'f1-score': 0.11995038534974148, 'support': 298910}, 'accuracy': 0.3646249387460816, 'macro avg': {'precision': 0.368000595719343, 'recall': 0.3409470528631428, 'f1-score': 0.21719845847355967, 'support': 961163}, 'weighted avg': {'precision': 0.3680590662980905, 'recall': 0.3646249387460816, 'f1-score': 0.22855479140604634, 'support': 961163}}
[[   725 294400  21108]
 [   568 328222  17230]
 [   617 276776  21517]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.108676
{'0': {'precision': 0.35003939951104196, 'recall': 0.5314263803680982, 'f1-score': 0.4220700912379862, 'support': 130400}, '1': {'precision': 0.38037826685006876, 'recall': 0.42296573875802995, 'f1-score': 0.4005431633835458, 'support': 130760}, '2': {'precision': 0.3936978835870434, 'recall': 0.14666351195609864, 'f1-score': 0.2137129511205027, 'support': 131021}, 'accuracy': 0.3667209783237842, 'macro avg': {'precision': 0.37470518331605135, 'recall': 0.3670185436940756, 'f1-score': 0.3454420685806783, 'support': 392181}, 'weighted avg': {'precision': 0.3747404649256667, 'recall': 0.3667209783237842, 'f1-score': 0.34528406146709106, 'support': 392181}}
[[69298 45044 16058]
 [61918 55307 13535]
 [66756 45049 19216]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.116073
{'0': {'precision': 0.33416779789503376, 'recall': 0.4926447655681464, 'f1-score': 0.39821846868139366, 'support': 38476}, '1': {'precision': 0.38297535698746094, 'recall': 0.46415302380210455, 'f1-score': 0.41967468926431223, 'support': 41719}, '2': {'precision': 0.35361216730038025, 'recall': 0.10916607124629989, 'f1-score': 0.16682915415513005, 'support': 39188}, 'accuracy': 0.35680959600613155, 'macro avg': {'precision': 0.35691844072762496, 'recall': 0.3553212868721836, 'f1-score': 0.32824077070027863, 'support': 119383}, 'weighted avg': {'precision': 0.35760654969414823, 'recall': 0.35680959600613155, 'f1-score': 0.3297618844846786, 'support': 119383}}
[[18955 15384  4137]
 [18672 19364  3683]
 [19096 15814  4278]]
training model: results/WBA/W8/deepLOB_L2/h200
Epoch 1/50
1532/1532 - 65s - loss: 3.2555 - accuracy200: 0.3918 - val_loss: 3.3048 - val_accuracy200: 0.3759 - 65s/epoch - 42ms/step
Epoch 2/50
1532/1532 - 62s - loss: 3.2343 - accuracy200: 0.3972 - val_loss: 3.3461 - val_accuracy200: 0.3671 - 62s/epoch - 41ms/step
Epoch 3/50
1532/1532 - 62s - loss: 3.2271 - accuracy200: 0.4058 - val_loss: 3.3334 - val_accuracy200: 0.3600 - 62s/epoch - 40ms/step
Epoch 4/50
1532/1532 - 63s - loss: 3.2108 - accuracy200: 0.4150 - val_loss: 3.4324 - val_accuracy200: 0.3471 - 63s/epoch - 41ms/step
Epoch 5/50
1532/1532 - 63s - loss: 3.2018 - accuracy200: 0.4187 - val_loss: 3.4517 - val_accuracy200: 0.3418 - 63s/epoch - 41ms/step
Epoch 6/50
1532/1532 - 63s - loss: 3.1905 - accuracy200: 0.4228 - val_loss: 3.4538 - val_accuracy200: 0.3422 - 63s/epoch - 41ms/step
Epoch 7/50
1532/1532 - 61s - loss: 3.1820 - accuracy200: 0.4262 - val_loss: 3.4250 - val_accuracy200: 0.3450 - 61s/epoch - 40ms/step
Epoch 8/50
1532/1532 - 61s - loss: 3.1756 - accuracy200: 0.4292 - val_loss: 3.4245 - val_accuracy200: 0.3461 - 61s/epoch - 40ms/step
Epoch 9/50
1532/1532 - 61s - loss: 3.1697 - accuracy200: 0.4324 - val_loss: 3.4263 - val_accuracy200: 0.3497 - 61s/epoch - 40ms/step
Epoch 10/50
1532/1532 - 61s - loss: 3.1600 - accuracy200: 0.4365 - val_loss: 3.4633 - val_accuracy200: 0.3461 - 61s/epoch - 40ms/step
Epoch 11/50
1532/1532 - 61s - loss: 3.1526 - accuracy200: 0.4391 - val_loss: 3.4238 - val_accuracy200: 0.3505 - 61s/epoch - 40ms/step
testing model: results/WBA/W8/deepLOB_L2/h200
Evaluating performance on  test set...
3755/3755 - 50s - 50s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0931883
{'0': {'precision': 0.300770114453474, 'recall': 0.04862680355638102, 'f1-score': 0.0837184789978416, 'support': 290745}, '1': {'precision': 0.41313411876208755, 'recall': 0.8502527573529411, 'f1-score': 0.5560742006664001, 'support': 391680}, '2': {'precision': 0.31705195358048455, 'recall': 0.12291112083748897, 'f1-score': 0.1771476437191698, 'support': 278738}, 'accuracy': 0.3968369568949283, 'macro avg': {'precision': 0.3436520622653487, 'recall': 0.3405968939156037, 'f1-score': 0.2723134411278038, 'support': 961163}, 'weighted avg': {'precision': 0.351280902407424, 'recall': 0.3968369568949283, 'f1-score': 0.3033009510439301, 'support': 961163}}
[[ 14138 243298  33309]
 [ 18164 333027  40489]
 [ 14704 229774  34260]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1077478
{'0': {'precision': 0.3553125867890606, 'recall': 0.1869371621050041, 'f1-score': 0.24498352196567327, 'support': 130033}, '1': {'precision': 0.35574604875435306, 'recall': 0.6832954475640475, 'f1-score': 0.46789210337420173, 'support': 130216}, '2': {'precision': 0.3624638527227555, 'recall': 0.20236182275717793, 'f1-score': 0.2597220668420976, 'support': 131932}, 'accuracy': 0.3569321308273476, 'macro avg': {'precision': 0.35784082942205636, 'recall': 0.35753147747540986, 'f1-score': 0.3241992307273242, 'support': 392181}, 'weighted avg': {'precision': 0.35786223733418326, 'recall': 0.3569321308273476, 'f1-score': 0.3239540726535683, 'support': 392181}}
[[24308 80005 25720]
 [20001 88976 21239]
 [24104 81130 26698]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1008162
{'0': {'precision': 0.3442769019876628, 'recall': 0.1347696600574173, 'f1-score': 0.1937101097163572, 'support': 37271}, '1': {'precision': 0.3885682615034278, 'recall': 0.7375811911078584, 'f1-score': 0.5089921954530031, 'support': 43724}, '2': {'precision': 0.3572215085336759, 'recall': 0.20282379910388662, 'f1-score': 0.25873986441579155, 'support': 38388}, 'accuracy': 0.3774322977308327, 'macro avg': {'precision': 0.3633555573415888, 'recall': 0.3583915500897208, 'f1-score': 0.3204807231950506, 'support': 119383}, 'weighted avg': {'precision': 0.3646609848098038, 'recall': 0.3774322977308327, 'f1-score': 0.3300926444168672, 'support': 119383}}
[[ 5023 24728  7520]
 [ 4984 32250  6490]
 [ 4583 26019  7786]]
training model: results/WBA/W8/deepLOB_L2/h300
Epoch 1/50
1532/1532 - 65s - loss: 3.2338 - accuracy300: 0.4093 - val_loss: 3.6293 - val_accuracy300: 0.3452 - 65s/epoch - 42ms/step
Epoch 2/50
1532/1532 - 63s - loss: 3.2066 - accuracy300: 0.4210 - val_loss: 3.7826 - val_accuracy300: 0.3396 - 63s/epoch - 41ms/step
Epoch 3/50
1532/1532 - 62s - loss: 3.1819 - accuracy300: 0.4330 - val_loss: 3.7231 - val_accuracy300: 0.3316 - 62s/epoch - 40ms/step
Epoch 4/50
1532/1532 - 61s - loss: 3.1749 - accuracy300: 0.4362 - val_loss: 3.7173 - val_accuracy300: 0.3353 - 61s/epoch - 40ms/step
Epoch 5/50
1532/1532 - 61s - loss: 3.1585 - accuracy300: 0.4424 - val_loss: 3.5495 - val_accuracy300: 0.3299 - 61s/epoch - 40ms/step
Epoch 6/50
1532/1532 - 61s - loss: 3.1495 - accuracy300: 0.4456 - val_loss: 3.6997 - val_accuracy300: 0.3295 - 61s/epoch - 40ms/step
Epoch 7/50
1532/1532 - 61s - loss: 3.1391 - accuracy300: 0.4493 - val_loss: 3.7135 - val_accuracy300: 0.3299 - 61s/epoch - 40ms/step
Epoch 8/50
1532/1532 - 61s - loss: 3.1309 - accuracy300: 0.4513 - val_loss: 3.7621 - val_accuracy300: 0.3329 - 61s/epoch - 40ms/step
Epoch 9/50
1532/1532 - 61s - loss: 3.1233 - accuracy300: 0.4554 - val_loss: 3.7314 - val_accuracy300: 0.3269 - 61s/epoch - 40ms/step
Epoch 10/50
1532/1532 - 61s - loss: 3.1169 - accuracy300: 0.4573 - val_loss: 3.7791 - val_accuracy300: 0.3237 - 61s/epoch - 40ms/step
Epoch 11/50
1532/1532 - 61s - loss: 3.1109 - accuracy300: 0.4599 - val_loss: 3.7061 - val_accuracy300: 0.3253 - 61s/epoch - 40ms/step
Epoch 12/50
1532/1532 - 61s - loss: 3.1027 - accuracy300: 0.4632 - val_loss: 3.8168 - val_accuracy300: 0.3241 - 61s/epoch - 40ms/step
Epoch 13/50
1532/1532 - 61s - loss: 3.0964 - accuracy300: 0.4647 - val_loss: 3.9992 - val_accuracy300: 0.3250 - 61s/epoch - 40ms/step
Epoch 14/50
1532/1532 - 61s - loss: 3.0883 - accuracy300: 0.4672 - val_loss: 4.0640 - val_accuracy300: 0.3254 - 61s/epoch - 40ms/step
Epoch 15/50
1532/1532 - 60s - loss: 3.0804 - accuracy300: 0.4699 - val_loss: 4.0744 - val_accuracy300: 0.3239 - 60s/epoch - 39ms/step
testing model: results/WBA/W8/deepLOB_L2/h300
Evaluating performance on  test set...
3755/3755 - 51s - 51s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1322063
{'0': {'precision': 0.373134328358209, 'recall': 8.91990637666267e-05, 'f1-score': 0.00017835549103050233, 'support': 280272}, '1': {'precision': 0.42781848921563215, 'recall': 0.7956473689100574, 'f1-score': 0.5564399742825092, 'support': 408994}, '2': {'precision': 0.2898861606920153, 'recall': 0.21372063685881051, 'f1-score': 0.2460437594605752, 'support': 271897}, 'accuracy': 0.3990478201928289, 'macro avg': {'precision': 0.3636129927552855, 'recall': 0.33648573494421147, 'f1-score': 0.267554029744705, 'support': 961163}, 'weighted avg': {'precision': 0.37285400820625336, 'recall': 0.3990478201928289, 'f1-score': 0.30642998009487954, 'support': 961163}}
[[    25 221452  58795]
 [    26 325415  83553]
 [    16 213771  58110]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.181514
{'0': {'precision': 0.3276636245711259, 'recall': 0.32898174335894453, 'f1-score': 0.32832136100044607, 'support': 129761}, '1': {'precision': 0.3293791131779492, 'recall': 0.5471478463329453, 'f1-score': 0.41121170420801045, 'support': 129709}, '2': {'precision': 0.3491342177808408, 'recall': 0.1221526474821228, 'f1-score': 0.18098390671139816, 'support': 132711}, 'accuracy': 0.33114811783334736, 'macro avg': {'precision': 0.3353923185099719, 'recall': 0.3327607457246709, 'f1-score': 0.30683899063995157, 'support': 392181}, 'weighted avg': {'precision': 0.33549648288694667, 'recall': 0.33114811783334736, 'f1-score': 0.30587846506962874, 'support': 392181}}
[[42689 71630 15442]
 [43960 70970 14779]
 [43634 72866 16211]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1860211
{'0': {'precision': 0.2967094126104399, 'recall': 0.3410453927552843, 'f1-score': 0.3173363095238095, 'support': 37517}, '1': {'precision': 0.3517293722216199, 'recall': 0.5261718840512547, 'f1-score': 0.4216194136541711, 'support': 43157}, '2': {'precision': 0.3237883579793145, 'recall': 0.09785837918830247, 'f1-score': 0.15029360418981114, 'support': 38709}, 'accuracy': 0.32911721099318997, 'macro avg': {'precision': 0.3240757142704581, 'recall': 0.3216918853316138, 'f1-score': 0.2964164424559306, 'support': 119383}, 'weighted avg': {'precision': 0.32537928431096225, 'recall': 0.32911721099318997, 'f1-score': 0.3008724063230211, 'support': 119383}}
[[12795 20661  4061]
 [16599 22708  3850]
 [13729 21192  3788]]
training model: results/WBA/W8/deepLOB_L2/h500
Epoch 1/50
1532/1532 - 64s - loss: 3.2298 - accuracy500: 0.4137 - val_loss: 3.5018 - val_accuracy500: 0.3319 - 64s/epoch - 42ms/step
Epoch 2/50
1532/1532 - 61s - loss: 3.1920 - accuracy500: 0.4320 - val_loss: 3.5212 - val_accuracy500: 0.3267 - 61s/epoch - 40ms/step
Epoch 3/50
1532/1532 - 61s - loss: 3.1631 - accuracy500: 0.4431 - val_loss: 3.4595 - val_accuracy500: 0.3255 - 61s/epoch - 40ms/step
Epoch 4/50
1532/1532 - 61s - loss: 3.1415 - accuracy500: 0.4507 - val_loss: 3.4880 - val_accuracy500: 0.3248 - 61s/epoch - 40ms/step
Epoch 5/50
1532/1532 - 61s - loss: 3.1292 - accuracy500: 0.4547 - val_loss: 3.5637 - val_accuracy500: 0.3345 - 61s/epoch - 40ms/step
Epoch 6/50
1532/1532 - 61s - loss: 3.1173 - accuracy500: 0.4604 - val_loss: 3.5978 - val_accuracy500: 0.3280 - 61s/epoch - 40ms/step
Epoch 7/50
1532/1532 - 61s - loss: 3.1082 - accuracy500: 0.4634 - val_loss: 3.5924 - val_accuracy500: 0.3223 - 61s/epoch - 40ms/step
Epoch 8/50
1532/1532 - 61s - loss: 3.0955 - accuracy500: 0.4684 - val_loss: 3.6549 - val_accuracy500: 0.3227 - 61s/epoch - 40ms/step
Epoch 9/50
1532/1532 - 61s - loss: 3.0827 - accuracy500: 0.4720 - val_loss: 3.6636 - val_accuracy500: 0.3264 - 61s/epoch - 40ms/step
Epoch 10/50
1532/1532 - 61s - loss: 3.0735 - accuracy500: 0.4764 - val_loss: 3.6541 - val_accuracy500: 0.3276 - 61s/epoch - 40ms/step
Epoch 11/50
1532/1532 - 61s - loss: 3.0634 - accuracy500: 0.4798 - val_loss: 3.6440 - val_accuracy500: 0.3293 - 61s/epoch - 40ms/step
Epoch 12/50
1532/1532 - 61s - loss: 3.0564 - accuracy500: 0.4822 - val_loss: 3.6534 - val_accuracy500: 0.3286 - 61s/epoch - 40ms/step
Epoch 13/50
1532/1532 - 61s - loss: 3.0469 - accuracy500: 0.4848 - val_loss: 3.7589 - val_accuracy500: 0.3333 - 61s/epoch - 40ms/step
testing model: results/WBA/W8/deepLOB_L2/h500
Evaluating performance on  test set...
3755/3755 - 50s - 50s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1541141
{'0': {'precision': 0.36666666666666664, 'recall': 0.00028400380823288314, 'f1-score': 0.000567568003353811, 'support': 309855}, '1': {'precision': 0.3678110968050426, 'recall': 0.836015510019246, 'f1-score': 0.5108639067172375, 'support': 353320}, '2': {'precision': 0.3044885805695461, 'recall': 0.16128837402848437, 'f1-score': 0.21087547413197377, 'support': 297988}, 'accuracy': 0.3574118021605076, 'macro avg': {'precision': 0.34632211468041846, 'recall': 0.33252929595198777, 'f1-score': 0.24076898295085503, 'support': 961163}, 'weighted avg': {'precision': 0.34781037125848113, 'recall': 0.3574118021605076, 'f1-score': 0.253352095420498, 'support': 961163}}
[[    88 257844  51923]
 [    79 295381  57860]
 [    73 249853  48062]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1535199
{'0': {'precision': 0.33308066606352543, 'recall': 0.10469361247530992, 'f1-score': 0.15931232091690545, 'support': 130113}, '1': {'precision': 0.32947910168434186, 'recall': 0.8151798116993363, 'f1-score': 0.4692833977520102, 'support': 129580}, '2': {'precision': 0.3376678399165689, 'recall': 0.0782033089789264, 'f1-score': 0.12699482754394137, 'support': 132488}, 'accuracy': 0.33049535801071445, 'macro avg': {'precision': 0.3334092025548121, 'recall': 0.3326922443845242, 'f1-score': 0.2518635154042857, 'support': 392181}, 'weighted avg': {'precision': 0.333440333607816, 'recall': 0.33049535801071445, 'f1-score': 0.25081183791108824, 'support': 392181}}
[[ 13622 106478  10013]
 [ 13639 105631  10310]
 [ 13636 108491  10361]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1545489
{'0': {'precision': 0.31896978702327883, 'recall': 0.08184429250438452, 'f1-score': 0.1302641692625106, 'support': 39343}, '1': {'precision': 0.3219776434856123, 'recall': 0.8038408421710921, 'f1-score': 0.45978776045548037, 'support': 38377}, '2': {'precision': 0.3586109668323811, 'recall': 0.1160022081943211, 'f1-score': 0.1752992383025027, 'support': 41663}, 'accuracy': 0.3258587906150792, 'macro avg': {'precision': 0.3331861324470908, 'recall': 0.3338957809565992, 'f1-score': 0.2551170560068312, 'support': 119383}, 'weighted avg': {'precision': 0.333770914334886, 'recall': 0.3258587906150792, 'f1-score': 0.25190982183135036, 'support': 119383}}
[[ 3220 31690  4433]
 [ 3317 30849  4211]
 [ 3558 33272  4833]]
training model: results/WBA/W8/deepLOB_L2/h1000
Epoch 1/50
1532/1532 - 65s - loss: 3.2327 - accuracy1000: 0.4164 - val_loss: 3.4169 - val_accuracy1000: 0.3301 - 65s/epoch - 42ms/step
Epoch 2/50
1532/1532 - 62s - loss: 3.1779 - accuracy1000: 0.4376 - val_loss: 3.3558 - val_accuracy1000: 0.3354 - 62s/epoch - 41ms/step
Epoch 3/50
1532/1532 - 62s - loss: 3.1558 - accuracy1000: 0.4488 - val_loss: 3.3799 - val_accuracy1000: 0.3396 - 62s/epoch - 40ms/step
Epoch 4/50
1532/1532 - 62s - loss: 3.1364 - accuracy1000: 0.4553 - val_loss: 3.4375 - val_accuracy1000: 0.3351 - 62s/epoch - 40ms/step
Epoch 5/50
1532/1532 - 62s - loss: 3.1245 - accuracy1000: 0.4604 - val_loss: 3.4658 - val_accuracy1000: 0.3442 - 62s/epoch - 41ms/step
Epoch 6/50
1532/1532 - 62s - loss: 3.1066 - accuracy1000: 0.4674 - val_loss: 3.4873 - val_accuracy1000: 0.3413 - 62s/epoch - 40ms/step
Epoch 7/50
1532/1532 - 60s - loss: 3.0964 - accuracy1000: 0.4709 - val_loss: 3.4711 - val_accuracy1000: 0.3340 - 60s/epoch - 39ms/step
Epoch 8/50
1532/1532 - 60s - loss: 3.0817 - accuracy1000: 0.4748 - val_loss: 3.5210 - val_accuracy1000: 0.3299 - 60s/epoch - 39ms/step
Epoch 9/50
1532/1532 - 61s - loss: 3.0685 - accuracy1000: 0.4798 - val_loss: 3.5239 - val_accuracy1000: 0.3278 - 61s/epoch - 40ms/step
Epoch 10/50
1532/1532 - 61s - loss: 3.0589 - accuracy1000: 0.4822 - val_loss: 3.4745 - val_accuracy1000: 0.3313 - 61s/epoch - 40ms/step
Epoch 11/50
1532/1532 - 61s - loss: 3.0508 - accuracy1000: 0.4844 - val_loss: 3.4649 - val_accuracy1000: 0.3381 - 61s/epoch - 40ms/step
Epoch 12/50
1532/1532 - 61s - loss: 3.0390 - accuracy1000: 0.4876 - val_loss: 3.4676 - val_accuracy1000: 0.3380 - 61s/epoch - 40ms/step
testing model: results/WBA/W8/deepLOB_L2/h1000
Evaluating performance on  test set...
3755/3755 - 50s - 50s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1256915
{'0': {'precision': 0.3236779165559394, 'recall': 0.011335540051310846, 'f1-score': 0.02190397976249708, 'support': 322349}, '1': {'precision': 0.3563165887804859, 'recall': 0.5303211223739756, 'f1-score': 0.42624447596863924, 'support': 344199}, '2': {'precision': 0.3084362459665256, 'recall': 0.4581165249562989, 'f1-score': 0.3686627888713922, 'support': 294615}, 'accuracy': 0.33413479295395265, 'macro avg': {'precision': 0.32947691710098365, 'recall': 0.33325772912719515, 'f1-score': 0.2722704148675095, 'support': 961163}, 'weighted avg': {'precision': 0.3306941807695187, 'recall': 0.33413479295395265, 'f1-score': 0.2729893222062606, 'support': 961163}}
[[  3654 173697 144998]
 [  4041 182536 157622]
 [  3594 156053 134968]]
Evaluating performance on  train set...
1532/1532 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1281765
{'0': {'precision': 0.336000495119536, 'recall': 0.2911594125173341, 'f1-score': 0.31197691553070883, 'support': 130523}, '1': {'precision': 0.33088988990652857, 'recall': 0.4641150184573538, 'f1-score': 0.38633967097729965, 'support': 128675}, '2': {'precision': 0.341937643264296, 'recall': 0.2535136070023988, 'f1-score': 0.29116017566511354, 'support': 132983}, 'accuracy': 0.33514117206085964, 'macro avg': {'precision': 0.3362760094301202, 'recall': 0.3362626793256956, 'f1-score': 0.3298255873910407, 'support': 392181}, 'weighted avg': {'precision': 0.33633690266082655, 'recall': 0.33514117206085964, 'f1-score': 0.329316753614511, 'support': 392181}}
[[38003 60208 32312]
 [36386 59720 32569]
 [38715 60555 33713]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1191361
{'0': {'precision': 0.3107329015953246, 'recall': 0.2063512875649027, 'f1-score': 0.2480065555170349, 'support': 38134}, '1': {'precision': 0.3408905485126145, 'recall': 0.5366944149396042, 'f1-score': 0.41694892486015017, 'support': 40483}, '2': {'precision': 0.34828348118589847, 'recall': 0.2590639258205367, 'f1-score': 0.2971205109088607, 'support': 40766}, 'accuracy': 0.33637117512543663, 'macro avg': {'precision': 0.33330231043127917, 'recall': 0.33403654277501454, 'f1-score': 0.3206919970953486, 'support': 119383}, 'weighted avg': {'precision': 0.3337819031092921, 'recall': 0.33637117512543663, 'f1-score': 0.32206629135564263, 'support': 119383}}
[[ 7869 20602  9663]
 [ 8657 21727 10099]
 [ 8798 21407 10561]]
training model: results/WBA/W8/deepOF_L2/h10
Epoch 1/50
1532/1532 - 36s - loss: 3.0254 - accuracy10: 0.4831 - val_loss: 3.2907 - val_accuracy10: 0.5375 - 36s/epoch - 24ms/step
Epoch 2/50
1532/1532 - 33s - loss: 2.8444 - accuracy10: 0.5371 - val_loss: 3.1598 - val_accuracy10: 0.5507 - 33s/epoch - 22ms/step
Epoch 3/50
1532/1532 - 33s - loss: 2.7821 - accuracy10: 0.5496 - val_loss: 3.0914 - val_accuracy10: 0.5572 - 33s/epoch - 22ms/step
Epoch 4/50
1532/1532 - 33s - loss: 2.7473 - accuracy10: 0.5563 - val_loss: 3.0701 - val_accuracy10: 0.5593 - 33s/epoch - 21ms/step
Epoch 5/50
1532/1532 - 33s - loss: 2.7271 - accuracy10: 0.5605 - val_loss: 3.0595 - val_accuracy10: 0.5608 - 33s/epoch - 21ms/step
Epoch 6/50
1532/1532 - 33s - loss: 2.7104 - accuracy10: 0.5631 - val_loss: 3.0358 - val_accuracy10: 0.5626 - 33s/epoch - 21ms/step
Epoch 7/50
1532/1532 - 33s - loss: 2.6983 - accuracy10: 0.5660 - val_loss: 3.0228 - val_accuracy10: 0.5635 - 33s/epoch - 21ms/step
Epoch 8/50
1532/1532 - 33s - loss: 2.6881 - accuracy10: 0.5676 - val_loss: 3.0139 - val_accuracy10: 0.5628 - 33s/epoch - 21ms/step
Epoch 9/50
1532/1532 - 33s - loss: 2.6794 - accuracy10: 0.5696 - val_loss: 3.0228 - val_accuracy10: 0.5634 - 33s/epoch - 21ms/step
Epoch 10/50
1532/1532 - 33s - loss: 2.6727 - accuracy10: 0.5704 - val_loss: 3.0059 - val_accuracy10: 0.5612 - 33s/epoch - 22ms/step
Epoch 11/50
1532/1532 - 33s - loss: 2.6640 - accuracy10: 0.5720 - val_loss: 3.0089 - val_accuracy10: 0.5621 - 33s/epoch - 21ms/step
Epoch 12/50
1532/1532 - 33s - loss: 2.6584 - accuracy10: 0.5737 - val_loss: 3.0016 - val_accuracy10: 0.5607 - 33s/epoch - 21ms/step
Epoch 13/50
1532/1532 - 33s - loss: 2.6522 - accuracy10: 0.5740 - val_loss: 3.0109 - val_accuracy10: 0.5602 - 33s/epoch - 21ms/step
Epoch 14/50
1532/1532 - 34s - loss: 2.6476 - accuracy10: 0.5748 - val_loss: 3.0202 - val_accuracy10: 0.5577 - 34s/epoch - 22ms/step
Epoch 15/50
1532/1532 - 34s - loss: 2.6411 - accuracy10: 0.5767 - val_loss: 2.9851 - val_accuracy10: 0.5561 - 34s/epoch - 22ms/step
Epoch 16/50
1532/1532 - 33s - loss: 2.6371 - accuracy10: 0.5777 - val_loss: 3.0059 - val_accuracy10: 0.5568 - 33s/epoch - 21ms/step
Epoch 17/50
1532/1532 - 33s - loss: 2.6315 - accuracy10: 0.5788 - val_loss: 3.0107 - val_accuracy10: 0.5567 - 33s/epoch - 22ms/step
Epoch 18/50
1532/1532 - 33s - loss: 2.6264 - accuracy10: 0.5794 - val_loss: 2.9948 - val_accuracy10: 0.5568 - 33s/epoch - 22ms/step
Epoch 19/50
1532/1532 - 33s - loss: 2.6225 - accuracy10: 0.5800 - val_loss: 3.0032 - val_accuracy10: 0.5563 - 33s/epoch - 22ms/step
Epoch 20/50
1532/1532 - 33s - loss: 2.6188 - accuracy10: 0.5806 - val_loss: 2.9950 - val_accuracy10: 0.5579 - 33s/epoch - 21ms/step
Epoch 21/50
1532/1532 - 33s - loss: 2.6142 - accuracy10: 0.5815 - val_loss: 2.9843 - val_accuracy10: 0.5554 - 33s/epoch - 21ms/step
Epoch 22/50
1532/1532 - 33s - loss: 2.6099 - accuracy10: 0.5827 - val_loss: 2.9757 - val_accuracy10: 0.5561 - 33s/epoch - 21ms/step
Epoch 23/50
1532/1532 - 33s - loss: 2.6058 - accuracy10: 0.5833 - val_loss: 2.9960 - val_accuracy10: 0.5560 - 33s/epoch - 21ms/step
Epoch 24/50
1532/1532 - 33s - loss: 2.6028 - accuracy10: 0.5840 - val_loss: 2.9917 - val_accuracy10: 0.5548 - 33s/epoch - 21ms/step
Epoch 25/50
1532/1532 - 33s - loss: 2.5987 - accuracy10: 0.5845 - val_loss: 2.9735 - val_accuracy10: 0.5544 - 33s/epoch - 21ms/step
Epoch 26/50
1532/1532 - 33s - loss: 2.5945 - accuracy10: 0.5854 - val_loss: 2.9772 - val_accuracy10: 0.5546 - 33s/epoch - 21ms/step
Epoch 27/50
1532/1532 - 33s - loss: 2.5917 - accuracy10: 0.5857 - val_loss: 2.9629 - val_accuracy10: 0.5560 - 33s/epoch - 21ms/step
Epoch 28/50
1532/1532 - 33s - loss: 2.5882 - accuracy10: 0.5861 - val_loss: 2.9705 - val_accuracy10: 0.5500 - 33s/epoch - 21ms/step
Epoch 29/50
1532/1532 - 33s - loss: 2.5843 - accuracy10: 0.5867 - val_loss: 2.9657 - val_accuracy10: 0.5527 - 33s/epoch - 21ms/step
Epoch 30/50
1532/1532 - 33s - loss: 2.5820 - accuracy10: 0.5880 - val_loss: 2.9788 - val_accuracy10: 0.5563 - 33s/epoch - 21ms/step
Epoch 31/50
1532/1532 - 33s - loss: 2.5769 - accuracy10: 0.5887 - val_loss: 2.9725 - val_accuracy10: 0.5512 - 33s/epoch - 21ms/step
Epoch 32/50
1532/1532 - 33s - loss: 2.5735 - accuracy10: 0.5888 - val_loss: 2.9727 - val_accuracy10: 0.5565 - 33s/epoch - 21ms/step
Epoch 33/50
1532/1532 - 33s - loss: 2.5705 - accuracy10: 0.5904 - val_loss: 2.9719 - val_accuracy10: 0.5509 - 33s/epoch - 21ms/step
Epoch 34/50
1532/1532 - 33s - loss: 2.5671 - accuracy10: 0.5900 - val_loss: 2.9817 - val_accuracy10: 0.5503 - 33s/epoch - 21ms/step
Epoch 35/50
1532/1532 - 33s - loss: 2.5645 - accuracy10: 0.5906 - val_loss: 2.9649 - val_accuracy10: 0.5478 - 33s/epoch - 22ms/step
Epoch 36/50
1532/1532 - 33s - loss: 2.5601 - accuracy10: 0.5918 - val_loss: 2.9802 - val_accuracy10: 0.5508 - 33s/epoch - 21ms/step
Epoch 37/50
1532/1532 - 33s - loss: 2.5581 - accuracy10: 0.5917 - val_loss: 2.9727 - val_accuracy10: 0.5524 - 33s/epoch - 21ms/step
testing model: results/WBA/W8/deepOF_L2/h10
Evaluating performance on  test set...
3755/3755 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8957371
{'0': {'precision': 0.5042688331855959, 'recall': 0.3301004336710208, 'f1-score': 0.39900645225934545, 'support': 229206}, '1': {'precision': 0.6776298014747998, 'recall': 0.7361930536231799, 'f1-score': 0.7056985264808582, 'support': 511029}, '2': {'precision': 0.4356583816225974, 'recall': 0.504678100514659, 'f1-score': 0.46763525331029304, 'support': 220923}, 'accuracy': 0.58613880340173, 'macro avg': {'precision': 0.539185672094331, 'recall': 0.5236571959362866, 'f1-score': 0.5241134106834989, 'support': 961158}, 'weighted avg': {'precision': 0.5806713138112696, 'recall': 0.58613880340173, 'f1-score': 0.5778430479199173, 'support': 961158}}
[[ 75661  97335  56210]
 [ 46595 376216  88218]
 [ 27785  81643 111495]]
Evaluating performance on  train set...
1532/1532 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90092
{'0': {'precision': 0.5037655032830481, 'recall': 0.4176682926829268, 'f1-score': 0.45669450933956324, 'support': 102500}, '1': {'precision': 0.6625147289866458, 'recall': 0.7185739389743863, 'f1-score': 0.689406595652285, 'support': 187790}, '2': {'precision': 0.47856370029753853, 'recall': 0.4862103486180904, 'f1-score': 0.4823567213880937, 'support': 101888}, 'accuracy': 0.5795608116722508, 'macro avg': {'precision': 0.5482813108557442, 'recall': 0.5408175267584678, 'f1-score': 0.5428192754599807, 'support': 392178}, 'weighted avg': {'precision': 0.5732333362371939, 'recall': 0.5795608116722508, 'f1-score': 0.574793112906991, 'support': 392178}}
[[ 42811  35545  24144]
 [ 23016 134941  29833]
 [ 19155  33194  49539]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94394773
{'0': {'precision': 0.48746389853919886, 'recall': 0.38204901092412163, 'f1-score': 0.4283664986942288, 'support': 30483}, '1': {'precision': 0.6390399793405104, 'recall': 0.6786479491266862, 'f1-score': 0.6582486824386108, 'support': 58341}, '2': {'precision': 0.44947070225137914, 'recall': 0.49324257992735365, 'f1-score': 0.4703404374824477, 'support': 30559}, 'accuracy': 0.5554559694428856, 'macro avg': {'precision': 0.525324860043696, 'recall': 0.5179798466593871, 'f1-score': 0.5189852062050958, 'support': 119383}, 'weighted avg': {'precision': 0.5518119719220912, 'recall': 0.5554559694428856, 'f1-score': 0.5514513439172519, 'support': 119383}}
[[11646 11620  7217]
 [ 7503 39593 11245]
 [ 4742 10744 15073]]
training model: results/WBA/W8/deepOF_L2/h20
Epoch 1/50
1532/1532 - 36s - loss: 3.0806 - accuracy20: 0.4632 - val_loss: 3.4174 - val_accuracy20: 0.4418 - 36s/epoch - 23ms/step
Epoch 2/50
1532/1532 - 33s - loss: 2.9147 - accuracy20: 0.5109 - val_loss: 3.3363 - val_accuracy20: 0.4575 - 33s/epoch - 21ms/step
Epoch 3/50
1532/1532 - 33s - loss: 2.8561 - accuracy20: 0.5250 - val_loss: 3.2556 - val_accuracy20: 0.4681 - 33s/epoch - 22ms/step
Epoch 4/50
1532/1532 - 33s - loss: 2.8197 - accuracy20: 0.5336 - val_loss: 3.2205 - val_accuracy20: 0.4746 - 33s/epoch - 22ms/step
Epoch 5/50
1532/1532 - 33s - loss: 2.8000 - accuracy20: 0.5385 - val_loss: 3.2214 - val_accuracy20: 0.4751 - 33s/epoch - 21ms/step
Epoch 6/50
1532/1532 - 33s - loss: 2.7848 - accuracy20: 0.5418 - val_loss: 3.2005 - val_accuracy20: 0.4797 - 33s/epoch - 21ms/step
Epoch 7/50
1532/1532 - 32s - loss: 2.7732 - accuracy20: 0.5443 - val_loss: 3.2160 - val_accuracy20: 0.4796 - 32s/epoch - 21ms/step
Epoch 8/50
1532/1532 - 33s - loss: 2.7640 - accuracy20: 0.5459 - val_loss: 3.2126 - val_accuracy20: 0.4808 - 33s/epoch - 21ms/step
Epoch 9/50
1532/1532 - 33s - loss: 2.7551 - accuracy20: 0.5479 - val_loss: 3.1979 - val_accuracy20: 0.4848 - 33s/epoch - 21ms/step
Epoch 10/50
1532/1532 - 33s - loss: 2.7478 - accuracy20: 0.5498 - val_loss: 3.1849 - val_accuracy20: 0.4870 - 33s/epoch - 21ms/step
Epoch 11/50
1532/1532 - 33s - loss: 2.7405 - accuracy20: 0.5511 - val_loss: 3.1842 - val_accuracy20: 0.4878 - 33s/epoch - 22ms/step
Epoch 12/50
1532/1532 - 33s - loss: 2.7344 - accuracy20: 0.5520 - val_loss: 3.1658 - val_accuracy20: 0.4908 - 33s/epoch - 21ms/step
Epoch 13/50
1532/1532 - 33s - loss: 2.7291 - accuracy20: 0.5533 - val_loss: 3.1512 - val_accuracy20: 0.4924 - 33s/epoch - 21ms/step
Epoch 14/50
1532/1532 - 33s - loss: 2.7239 - accuracy20: 0.5548 - val_loss: 3.1601 - val_accuracy20: 0.4939 - 33s/epoch - 21ms/step
Epoch 15/50
1532/1532 - 33s - loss: 2.7196 - accuracy20: 0.5558 - val_loss: 3.1386 - val_accuracy20: 0.4961 - 33s/epoch - 21ms/step
Epoch 16/50
1532/1532 - 33s - loss: 2.7141 - accuracy20: 0.5567 - val_loss: 3.1375 - val_accuracy20: 0.4958 - 33s/epoch - 22ms/step
Epoch 17/50
1532/1532 - 33s - loss: 2.7096 - accuracy20: 0.5578 - val_loss: 3.1283 - val_accuracy20: 0.4982 - 33s/epoch - 22ms/step
Epoch 18/50
1532/1532 - 33s - loss: 2.7056 - accuracy20: 0.5585 - val_loss: 3.1211 - val_accuracy20: 0.4975 - 33s/epoch - 22ms/step
Epoch 19/50
1532/1532 - 33s - loss: 2.6995 - accuracy20: 0.5597 - val_loss: 3.1194 - val_accuracy20: 0.4982 - 33s/epoch - 21ms/step
Epoch 20/50
1532/1532 - 33s - loss: 2.6975 - accuracy20: 0.5605 - val_loss: 3.1212 - val_accuracy20: 0.4989 - 33s/epoch - 21ms/step
Epoch 21/50
1532/1532 - 33s - loss: 2.6930 - accuracy20: 0.5616 - val_loss: 3.1242 - val_accuracy20: 0.4974 - 33s/epoch - 21ms/step
Epoch 22/50
1532/1532 - 33s - loss: 2.6889 - accuracy20: 0.5624 - val_loss: 3.1197 - val_accuracy20: 0.5009 - 33s/epoch - 22ms/step
Epoch 23/50
1532/1532 - 33s - loss: 2.6852 - accuracy20: 0.5630 - val_loss: 3.1037 - val_accuracy20: 0.5012 - 33s/epoch - 21ms/step
Epoch 24/50
1532/1532 - 33s - loss: 2.6811 - accuracy20: 0.5639 - val_loss: 3.1210 - val_accuracy20: 0.4999 - 33s/epoch - 21ms/step
Epoch 25/50
1532/1532 - 33s - loss: 2.6769 - accuracy20: 0.5650 - val_loss: 3.1090 - val_accuracy20: 0.4990 - 33s/epoch - 21ms/step
Epoch 26/50
1532/1532 - 33s - loss: 2.6735 - accuracy20: 0.5652 - val_loss: 3.1046 - val_accuracy20: 0.5023 - 33s/epoch - 22ms/step
Epoch 27/50
1532/1532 - 34s - loss: 2.6701 - accuracy20: 0.5663 - val_loss: 3.0963 - val_accuracy20: 0.4996 - 34s/epoch - 22ms/step
Epoch 28/50
1532/1532 - 33s - loss: 2.6666 - accuracy20: 0.5672 - val_loss: 3.1200 - val_accuracy20: 0.5026 - 33s/epoch - 22ms/step
Epoch 29/50
1532/1532 - 34s - loss: 2.6620 - accuracy20: 0.5678 - val_loss: 3.0998 - val_accuracy20: 0.4994 - 34s/epoch - 22ms/step
Epoch 30/50
1532/1532 - 35s - loss: 2.6593 - accuracy20: 0.5687 - val_loss: 3.1047 - val_accuracy20: 0.4988 - 35s/epoch - 23ms/step
Epoch 31/50
1532/1532 - 34s - loss: 2.6551 - accuracy20: 0.5699 - val_loss: 3.0982 - val_accuracy20: 0.4992 - 34s/epoch - 22ms/step
Epoch 32/50
1532/1532 - 33s - loss: 2.6516 - accuracy20: 0.5713 - val_loss: 3.1029 - val_accuracy20: 0.5005 - 33s/epoch - 22ms/step
Epoch 33/50
1532/1532 - 33s - loss: 2.6466 - accuracy20: 0.5722 - val_loss: 3.1178 - val_accuracy20: 0.4988 - 33s/epoch - 22ms/step
Epoch 34/50
1532/1532 - 33s - loss: 2.6437 - accuracy20: 0.5724 - val_loss: 3.1107 - val_accuracy20: 0.4990 - 33s/epoch - 22ms/step
Epoch 35/50
1532/1532 - 34s - loss: 2.6410 - accuracy20: 0.5734 - val_loss: 3.1018 - val_accuracy20: 0.5006 - 34s/epoch - 22ms/step
Epoch 36/50
1532/1532 - 34s - loss: 2.6361 - accuracy20: 0.5742 - val_loss: 3.1085 - val_accuracy20: 0.4949 - 34s/epoch - 22ms/step
Epoch 37/50
1532/1532 - 34s - loss: 2.6341 - accuracy20: 0.5747 - val_loss: 3.1165 - val_accuracy20: 0.4989 - 34s/epoch - 22ms/step
testing model: results/WBA/W8/deepOF_L2/h20
Evaluating performance on  test set...
3755/3755 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9631432
{'0': {'precision': 0.5078566825738015, 'recall': 0.39198772907978535, 'f1-score': 0.4424622415207824, 'support': 287509}, '1': {'precision': 0.5594043355325165, 'recall': 0.742979891043102, 'f1-score': 0.6382543089542801, 'support': 399424}, '2': {'precision': 0.5088840451268294, 'recall': 0.38737168383626586, 'f1-score': 0.4398906764395304, 'support': 274225}, 'accuracy': 0.5365309345601867, 'macro avg': {'precision': 0.5253816877443825, 'recall': 0.5074464346530511, 'f1-score': 0.5068690756381976, 'support': 961158}, 'weighted avg': {'precision': 0.5295712167414262, 'recall': 0.5365309345601867, 'f1-score': 0.5230929633252631, 'support': 961158}}
[[112700 121981  52828]
 [ 52970 296764  49690]
 [ 56243 111755 106227]]
Evaluating performance on  train set...
1532/1532 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9734234
{'0': {'precision': 0.5102111395862338, 'recall': 0.46228135721229946, 'f1-score': 0.48506512667032, 'support': 124461}, '1': {'precision': 0.5320461521318517, 'recall': 0.7288901224716372, 'f1-score': 0.615103542976264, 'support': 144115}, '2': {'precision': 0.5427020433058859, 'recall': 0.3599294509797576, 'f1-score': 0.432811063494457, 'support': 123602}, 'accuracy': 0.5279949410726762, 'macro avg': {'precision': 0.5283197783413237, 'recall': 0.5170336435545648, 'f1-score': 0.510993244380347, 'support': 392178}, 'weighted avg': {'precision': 0.5284750236250328, 'recall': 0.5279949410726762, 'f1-score': 0.5163819767977318, 'support': 392178}}
[[ 57536  45896  21029]
 [ 22613 105044  16458]
 [ 32620  46494  44488]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0220213
{'0': {'precision': 0.4862439485181249, 'recall': 0.43670298788409023, 'f1-score': 0.46014386479502756, 'support': 37719}, '1': {'precision': 0.4985425722321657, 'recall': 0.6613826010266616, 'f1-score': 0.5685321618101589, 'support': 44221}, '2': {'precision': 0.5169137918187915, 'recall': 0.370563256149347, 'f1-score': 0.43167146301625575, 'support': 37443}, 'accuracy': 0.49918330080497225, 'macro avg': {'precision': 0.5005667708563607, 'recall': 0.48954961502003297, 'f1-score': 0.4867824965404807, 'support': 119383}, 'weighted avg': {'precision': 0.500418733721759, 'recall': 0.49918330080497225, 'f1-score': 0.49136226894388935, 'support': 119383}}
[[16472 14704  6543]
 [ 8550 29247  6424]
 [ 8854 14714 13875]]
training model: results/WBA/W8/deepOF_L2/h30
Epoch 1/50
1532/1532 - 37s - loss: 3.1319 - accuracy30: 0.4437 - val_loss: 3.4787 - val_accuracy30: 0.3905 - 37s/epoch - 24ms/step
Epoch 2/50
1532/1532 - 34s - loss: 2.9938 - accuracy30: 0.4878 - val_loss: 3.4041 - val_accuracy30: 0.4145 - 34s/epoch - 22ms/step
Epoch 3/50
1532/1532 - 33s - loss: 2.9413 - accuracy30: 0.5016 - val_loss: 3.3265 - val_accuracy30: 0.4279 - 33s/epoch - 22ms/step
Epoch 4/50
1532/1532 - 34s - loss: 2.9104 - accuracy30: 0.5102 - val_loss: 3.2817 - val_accuracy30: 0.4355 - 34s/epoch - 22ms/step
Epoch 5/50
1532/1532 - 34s - loss: 2.8906 - accuracy30: 0.5154 - val_loss: 3.2652 - val_accuracy30: 0.4410 - 34s/epoch - 22ms/step
Epoch 6/50
1532/1532 - 33s - loss: 2.8779 - accuracy30: 0.5190 - val_loss: 3.2523 - val_accuracy30: 0.4437 - 33s/epoch - 22ms/step
Epoch 7/50
1532/1532 - 33s - loss: 2.8676 - accuracy30: 0.5216 - val_loss: 3.2386 - val_accuracy30: 0.4483 - 33s/epoch - 22ms/step
Epoch 8/50
1532/1532 - 33s - loss: 2.8589 - accuracy30: 0.5239 - val_loss: 3.2152 - val_accuracy30: 0.4522 - 33s/epoch - 21ms/step
Epoch 9/50
1532/1532 - 33s - loss: 2.8501 - accuracy30: 0.5262 - val_loss: 3.2067 - val_accuracy30: 0.4572 - 33s/epoch - 22ms/step
Epoch 10/50
1532/1532 - 33s - loss: 2.8433 - accuracy30: 0.5282 - val_loss: 3.2029 - val_accuracy30: 0.4572 - 33s/epoch - 21ms/step
Epoch 11/50
1532/1532 - 33s - loss: 2.8380 - accuracy30: 0.5298 - val_loss: 3.2031 - val_accuracy30: 0.4586 - 33s/epoch - 21ms/step
Epoch 12/50
1532/1532 - 33s - loss: 2.8323 - accuracy30: 0.5308 - val_loss: 3.1856 - val_accuracy30: 0.4624 - 33s/epoch - 21ms/step
Epoch 13/50
1532/1532 - 33s - loss: 2.8271 - accuracy30: 0.5328 - val_loss: 3.1916 - val_accuracy30: 0.4630 - 33s/epoch - 22ms/step
Epoch 14/50
1532/1532 - 33s - loss: 2.8214 - accuracy30: 0.5333 - val_loss: 3.1814 - val_accuracy30: 0.4640 - 33s/epoch - 21ms/step
Epoch 15/50
1532/1532 - 33s - loss: 2.8177 - accuracy30: 0.5347 - val_loss: 3.1942 - val_accuracy30: 0.4638 - 33s/epoch - 22ms/step
Epoch 16/50
1532/1532 - 33s - loss: 2.8126 - accuracy30: 0.5356 - val_loss: 3.1898 - val_accuracy30: 0.4635 - 33s/epoch - 22ms/step
Epoch 17/50
1532/1532 - 34s - loss: 2.8092 - accuracy30: 0.5363 - val_loss: 3.1953 - val_accuracy30: 0.4658 - 34s/epoch - 22ms/step
Epoch 18/50
1532/1532 - 34s - loss: 2.8046 - accuracy30: 0.5380 - val_loss: 3.1913 - val_accuracy30: 0.4654 - 34s/epoch - 23ms/step
Epoch 19/50
1532/1532 - 33s - loss: 2.8010 - accuracy30: 0.5382 - val_loss: 3.1869 - val_accuracy30: 0.4664 - 33s/epoch - 22ms/step
Epoch 20/50
1532/1532 - 33s - loss: 2.7969 - accuracy30: 0.5393 - val_loss: 3.1941 - val_accuracy30: 0.4654 - 33s/epoch - 22ms/step
Epoch 21/50
1532/1532 - 33s - loss: 2.7930 - accuracy30: 0.5411 - val_loss: 3.2089 - val_accuracy30: 0.4646 - 33s/epoch - 22ms/step
Epoch 22/50
1532/1532 - 33s - loss: 2.7899 - accuracy30: 0.5419 - val_loss: 3.1960 - val_accuracy30: 0.4657 - 33s/epoch - 21ms/step
Epoch 23/50
1532/1532 - 33s - loss: 2.7860 - accuracy30: 0.5423 - val_loss: 3.1865 - val_accuracy30: 0.4676 - 33s/epoch - 22ms/step
Epoch 24/50
1532/1532 - 34s - loss: 2.7818 - accuracy30: 0.5436 - val_loss: 3.2053 - val_accuracy30: 0.4683 - 34s/epoch - 23ms/step
testing model: results/WBA/W8/deepOF_L2/h30
Evaluating performance on  test set...
3755/3755 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0109118
{'0': {'precision': 0.5139272656920475, 'recall': 0.3390108379800518, 'f1-score': 0.408533543648642, 'support': 305592}, '1': {'precision': 0.4873712083475343, 'recall': 0.7671295812310519, 'f1-score': 0.5960568125099531, 'support': 363494}, '2': {'precision': 0.5060876060395881, 'recall': 0.32476923498315485, 'f1-score': 0.3956438137901406, 'support': 292072}, 'accuracy': 0.4965905709571163, 'macro avg': {'precision': 0.5024620266930566, 'recall': 0.4769698847314195, 'f1-score': 0.4667447233162452, 'support': 961158}, 'weighted avg': {'precision': 0.5015019281487928, 'recall': 0.4965905709571163, 'f1-score': 0.4755348627993344, 'support': 961158}}
[[103599 149664  52329]
 [ 44402 278847  40245]
 [ 53582 143634  94856]]
Evaluating performance on  train set...
1532/1532 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0285352
{'0': {'precision': 0.5168472845042352, 'recall': 0.3797448080721798, 'f1-score': 0.4378135263109302, 'support': 131117}, '1': {'precision': 0.4584466620397291, 'recall': 0.7464723130020464, 'f1-score': 0.5680344442894993, 'support': 130964}, '2': {'precision': 0.5205573984842248, 'recall': 0.33049955033551887, 'f1-score': 0.4043066362631937, 'support': 130097}, 'accuracy': 0.4858737614042603, 'macro avg': {'precision': 0.49861711500939637, 'recall': 0.4855722238032483, 'f1-score': 0.47005153562120777, 'support': 392178}, 'weighted avg': {'precision': 0.49857572306533027, 'recall': 0.4858737614042603, 'f1-score': 0.4701843029164638, 'support': 392178}}
[[49791 57258 24068]
 [17670 97761 15533]
 [28875 58225 42997]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0605272
{'0': {'precision': 0.5064109394423726, 'recall': 0.3580343017854004, 'f1-score': 0.4194886580952661, 'support': 39823}, '1': {'precision': 0.43092115510420237, 'recall': 0.692827807272363, 'f1-score': 0.5313538325618914, 'support': 39932}, '2': {'precision': 0.49951898172130543, 'recall': 0.3406682143938629, 'f1-score': 0.4050769646232784, 'support': 39628}, 'accuracy': 0.4642537044637846, 'macro avg': {'precision': 0.4789503587559601, 'recall': 0.4638434411505421, 'f1-score': 0.4519731517601453, 'support': 119383}, 'weighted avg': {'precision': 0.47887291000131094, 'recall': 0.4642537044637846, 'f1-score': 0.4521222286865006, 'support': 119383}}
[[14258 18108  7457]
 [ 6197 27666  6069]
 [ 7700 18428 13500]]
training model: results/WBA/W8/deepOF_L2/h50
Epoch 1/50
1532/1532 - 36s - loss: 3.1998 - accuracy50: 0.4187 - val_loss: 3.4625 - val_accuracy50: 0.3589 - 36s/epoch - 23ms/step
Epoch 2/50
1532/1532 - 33s - loss: 3.1174 - accuracy50: 0.4528 - val_loss: 3.4623 - val_accuracy50: 0.3692 - 33s/epoch - 22ms/step
Epoch 3/50
1532/1532 - 33s - loss: 3.0874 - accuracy50: 0.4621 - val_loss: 3.4474 - val_accuracy50: 0.3747 - 33s/epoch - 21ms/step
Epoch 4/50
1532/1532 - 33s - loss: 3.0685 - accuracy50: 0.4676 - val_loss: 3.4284 - val_accuracy50: 0.3783 - 33s/epoch - 22ms/step
Epoch 5/50
1532/1532 - 33s - loss: 3.0559 - accuracy50: 0.4716 - val_loss: 3.4146 - val_accuracy50: 0.3836 - 33s/epoch - 21ms/step
Epoch 6/50
1532/1532 - 33s - loss: 3.0459 - accuracy50: 0.4742 - val_loss: 3.3844 - val_accuracy50: 0.3877 - 33s/epoch - 21ms/step
Epoch 7/50
1532/1532 - 33s - loss: 3.0364 - accuracy50: 0.4772 - val_loss: 3.3775 - val_accuracy50: 0.3890 - 33s/epoch - 21ms/step
Epoch 8/50
1532/1532 - 33s - loss: 3.0287 - accuracy50: 0.4798 - val_loss: 3.3529 - val_accuracy50: 0.3959 - 33s/epoch - 22ms/step
Epoch 9/50
1532/1532 - 33s - loss: 3.0216 - accuracy50: 0.4820 - val_loss: 3.3215 - val_accuracy50: 0.4029 - 33s/epoch - 21ms/step
Epoch 10/50
1532/1532 - 33s - loss: 3.0147 - accuracy50: 0.4836 - val_loss: 3.3195 - val_accuracy50: 0.4039 - 33s/epoch - 21ms/step
Epoch 11/50
1532/1532 - 33s - loss: 3.0092 - accuracy50: 0.4853 - val_loss: 3.3109 - val_accuracy50: 0.4092 - 33s/epoch - 21ms/step
Epoch 12/50
1532/1532 - 33s - loss: 3.0030 - accuracy50: 0.4873 - val_loss: 3.3026 - val_accuracy50: 0.4114 - 33s/epoch - 21ms/step
Epoch 13/50
1532/1532 - 33s - loss: 2.9986 - accuracy50: 0.4885 - val_loss: 3.2875 - val_accuracy50: 0.4138 - 33s/epoch - 21ms/step
Epoch 14/50
1532/1532 - 33s - loss: 2.9934 - accuracy50: 0.4912 - val_loss: 3.2830 - val_accuracy50: 0.4175 - 33s/epoch - 21ms/step
Epoch 15/50
1532/1532 - 33s - loss: 2.9887 - accuracy50: 0.4923 - val_loss: 3.2745 - val_accuracy50: 0.4188 - 33s/epoch - 21ms/step
Epoch 16/50
1532/1532 - 32s - loss: 2.9843 - accuracy50: 0.4937 - val_loss: 3.2977 - val_accuracy50: 0.4154 - 32s/epoch - 21ms/step
Epoch 17/50
1532/1532 - 32s - loss: 2.9807 - accuracy50: 0.4952 - val_loss: 3.3113 - val_accuracy50: 0.4177 - 32s/epoch - 21ms/step
Epoch 18/50
1532/1532 - 33s - loss: 2.9757 - accuracy50: 0.4971 - val_loss: 3.3115 - val_accuracy50: 0.4164 - 33s/epoch - 21ms/step
Epoch 19/50
1532/1532 - 33s - loss: 2.9719 - accuracy50: 0.4974 - val_loss: 3.3068 - val_accuracy50: 0.4179 - 33s/epoch - 21ms/step
Epoch 20/50
1532/1532 - 33s - loss: 2.9679 - accuracy50: 0.4987 - val_loss: 3.2922 - val_accuracy50: 0.4205 - 33s/epoch - 21ms/step
Epoch 21/50
1532/1532 - 33s - loss: 2.9633 - accuracy50: 0.5000 - val_loss: 3.3335 - val_accuracy50: 0.4182 - 33s/epoch - 21ms/step
Epoch 22/50
1532/1532 - 33s - loss: 2.9603 - accuracy50: 0.5012 - val_loss: 3.3224 - val_accuracy50: 0.4197 - 33s/epoch - 21ms/step
Epoch 23/50
1532/1532 - 33s - loss: 2.9551 - accuracy50: 0.5030 - val_loss: 3.3299 - val_accuracy50: 0.4195 - 33s/epoch - 21ms/step
Epoch 24/50
1532/1532 - 34s - loss: 2.9507 - accuracy50: 0.5038 - val_loss: 3.3351 - val_accuracy50: 0.4173 - 34s/epoch - 22ms/step
Epoch 25/50
1532/1532 - 33s - loss: 2.9470 - accuracy50: 0.5044 - val_loss: 3.3562 - val_accuracy50: 0.4174 - 33s/epoch - 21ms/step
testing model: results/WBA/W8/deepOF_L2/h50
Evaluating performance on  test set...
3755/3755 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0521519
{'0': {'precision': 0.4648982086245751, 'recall': 0.31315869876340713, 'f1-score': 0.37423205600490406, 'support': 310935}, '1': {'precision': 0.440872323153955, 'recall': 0.6901735534169471, 'f1-score': 0.5380478797144094, 'support': 355683}, '2': {'precision': 0.45765477326601606, 'recall': 0.3028315339172948, 'f1-score': 0.3644833462052395, 'support': 294540}, 'accuracy': 0.44951090247389086, 'macro avg': {'precision': 0.4544751016815154, 'recall': 0.43538792869921633, 'f1-score': 0.42558776064151765, 'support': 961158}, 'weighted avg': {'precision': 0.45378756867530917, 'recall': 0.44951090247389086, 'f1-score': 0.43186578390403696, 'support': 961158}}
[[ 97372 161103  52460]
 [ 56958 245483  53242]
 [ 55118 150226  89196]]
Evaluating performance on  train set...
1532/1532 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0703295
{'0': {'precision': 0.4637574412269196, 'recall': 0.34888116346854503, 'f1-score': 0.3981997279665936, 'support': 131744}, '1': {'precision': 0.41003031269183365, 'recall': 0.6655312509654896, 'f1-score': 0.5074335048040257, 'support': 129468}, '2': {'precision': 0.48762134458848355, 'recall': 0.30875188980346047, 'f1-score': 0.3780991252553871, 'support': 130966}, 'accuracy': 0.4400144832193545, 'macro avg': {'precision': 0.45380303283574563, 'recall': 0.44105476807916505, 'f1-score': 0.42791078600866883, 'support': 392178}, 'weighted avg': {'precision': 0.45398997872384717, 'recall': 0.4400144832193545, 'f1-score': 0.42754809295624824, 'support': 392178}}
[[45963 62953 22828]
 [23642 86165 19661]
 [29505 61025 40436]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0917212
{'0': {'precision': 0.446290546343397, 'recall': 0.3391996384816228, 'f1-score': 0.3854448977263002, 'support': 39832}, '1': {'precision': 0.38791004154132647, 'recall': 0.6179513184584179, 'f1-score': 0.4766253703468304, 'support': 39440}, '2': {'precision': 0.46487823439878234, 'recall': 0.3045797910797537, 'f1-score': 0.3680318115407209, 'support': 40111}, 'accuracy': 0.4196577402142684, 'macro avg': {'precision': 0.4330262740945019, 'recall': 0.42057691600659813, 'f1-score': 0.4100340265379505, 'support': 119383}, 'weighted avg': {'precision': 0.4332488540270361, 'recall': 0.4196577402142684, 'f1-score': 0.40971721070355777, 'support': 119383}}
[[13511 19360  6961]
 [ 7966 24372  7102]
 [ 8797 19097 12217]]
training model: results/WBA/W8/deepOF_L2/h100
Epoch 1/50
1532/1532 - 36s - loss: 3.2562 - accuracy100: 0.3902 - val_loss: 3.3303 - val_accuracy100: 0.3570 - 36s/epoch - 24ms/step
Epoch 2/50
1532/1532 - 34s - loss: 3.2027 - accuracy100: 0.4143 - val_loss: 3.3747 - val_accuracy100: 0.3522 - 34s/epoch - 22ms/step
Epoch 3/50
1532/1532 - 33s - loss: 3.1837 - accuracy100: 0.4222 - val_loss: 3.3808 - val_accuracy100: 0.3516 - 33s/epoch - 21ms/step
Epoch 4/50
1532/1532 - 34s - loss: 3.1755 - accuracy100: 0.4253 - val_loss: 3.3805 - val_accuracy100: 0.3531 - 34s/epoch - 22ms/step
Epoch 5/50
1532/1532 - 33s - loss: 3.1690 - accuracy100: 0.4279 - val_loss: 3.3727 - val_accuracy100: 0.3555 - 33s/epoch - 22ms/step
Epoch 6/50
1532/1532 - 33s - loss: 3.1633 - accuracy100: 0.4304 - val_loss: 3.3741 - val_accuracy100: 0.3552 - 33s/epoch - 21ms/step
Epoch 7/50
1532/1532 - 33s - loss: 3.1592 - accuracy100: 0.4321 - val_loss: 3.3777 - val_accuracy100: 0.3557 - 33s/epoch - 21ms/step
Epoch 8/50
1532/1532 - 33s - loss: 3.1545 - accuracy100: 0.4339 - val_loss: 3.3614 - val_accuracy100: 0.3579 - 33s/epoch - 22ms/step
Epoch 9/50
1532/1532 - 33s - loss: 3.1505 - accuracy100: 0.4355 - val_loss: 3.3728 - val_accuracy100: 0.3592 - 33s/epoch - 21ms/step
Epoch 10/50
1532/1532 - 33s - loss: 3.1461 - accuracy100: 0.4375 - val_loss: 3.3693 - val_accuracy100: 0.3614 - 33s/epoch - 22ms/step
Epoch 11/50
1532/1532 - 33s - loss: 3.1421 - accuracy100: 0.4383 - val_loss: 3.3710 - val_accuracy100: 0.3595 - 33s/epoch - 21ms/step
testing model: results/WBA/W8/deepOF_L2/h100
Evaluating performance on  test set...
3755/3755 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1017805
{'0': {'precision': 0.43555724965571513, 'recall': 0.11201586177236965, 'f1-score': 0.17820203239762553, 'support': 316232}, '1': {'precision': 0.36123751818753524, 'recall': 0.899762440104272, 'f1-score': 0.5155082657765061, 'support': 346018}, '2': {'precision': 0.39574988874054295, 'recall': 0.023799965206685668, 'f1-score': 0.04489971093523182, 'support': 298908}, 'accuracy': 0.3681715181062843, 'macro avg': {'precision': 0.3975148855279311, 'recall': 0.34519275569444235, 'f1-score': 0.24620333636978783, 'support': 961158}, 'weighted avg': {'precision': 0.3964224731885901, 'recall': 0.3681715181062843, 'f1-score': 0.2581773308996536, 'support': 961158}}
[[ 35423 275847   4962]
 [ 28784 311334   5900]
 [ 17121 274673   7114]]
Evaluating performance on  train set...
1532/1532 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1143224
{'0': {'precision': 0.4286905476619305, 'recall': 0.09851533337932197, 'f1-score': 0.16021290254224085, 'support': 130467}, '1': {'precision': 0.335223097706282, 'recall': 0.9081192818588983, 'f1-score': 0.4896841992275793, 'support': 130615}, '2': {'precision': 0.4200956937799043, 'recall': 0.026789528284615855, 'f1-score': 0.05036714089031666, 'support': 131096}, 'accuracy': 0.34417789881125405, 'macro avg': {'precision': 0.39466977971603895, 'recall': 0.3444747145076121, 'f1-score': 0.2334214142200456, 'support': 392178}, 'weighted avg': {'precision': 0.3946881254442764, 'recall': 0.34417789881125405, 'f1-score': 0.23322452850554026, 'support': 392178}}
[[ 12853 114912   2702]
 [  9855 118614   2146]
 [  7274 120310   3512]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1102763
{'0': {'precision': 0.42737364194615024, 'recall': 0.0939804715903189, 'f1-score': 0.15407867847411447, 'support': 38508}, '1': {'precision': 0.35008975008054494, 'recall': 0.9132209575949671, 'f1-score': 0.5061451547434472, 'support': 41646}, '2': {'precision': 0.41096491228070176, 'recall': 0.023885390909786128, 'f1-score': 0.04514683562600882, 'support': 39229}, 'accuracy': 0.35673420838812897, 'macro avg': {'precision': 0.3961427681024656, 'recall': 0.34369560669835736, 'f1-score': 0.2351235562811902, 'support': 119383}, 'weighted avg': {'precision': 0.3950217742875986, 'recall': 0.35673420838812897, 'f1-score': 0.24110005679116375, 'support': 119383}}
[[ 3619 34253   636]
 [ 2907 38032   707]
 [ 1942 36350   937]]
training model: results/WBA/W8/deepOF_L2/h200
Epoch 1/50
1532/1532 - 35s - loss: 3.2658 - accuracy200: 0.3853 - val_loss: 3.2871 - val_accuracy200: 0.3723 - 35s/epoch - 23ms/step
Epoch 2/50
1532/1532 - 33s - loss: 3.2323 - accuracy200: 0.4010 - val_loss: 3.2779 - val_accuracy200: 0.3695 - 33s/epoch - 21ms/step
Epoch 3/50
1532/1532 - 33s - loss: 3.2154 - accuracy200: 0.4086 - val_loss: 3.2818 - val_accuracy200: 0.3708 - 33s/epoch - 21ms/step
Epoch 4/50
1532/1532 - 33s - loss: 3.2070 - accuracy200: 0.4122 - val_loss: 3.2851 - val_accuracy200: 0.3717 - 33s/epoch - 21ms/step
Epoch 5/50
1532/1532 - 33s - loss: 3.2028 - accuracy200: 0.4138 - val_loss: 3.2845 - val_accuracy200: 0.3730 - 33s/epoch - 21ms/step
Epoch 6/50
1532/1532 - 33s - loss: 3.1989 - accuracy200: 0.4159 - val_loss: 3.2891 - val_accuracy200: 0.3723 - 33s/epoch - 21ms/step
Epoch 7/50
1532/1532 - 33s - loss: 3.1963 - accuracy200: 0.4172 - val_loss: 3.2873 - val_accuracy200: 0.3722 - 33s/epoch - 21ms/step
Epoch 8/50
1532/1532 - 33s - loss: 3.1945 - accuracy200: 0.4170 - val_loss: 3.2925 - val_accuracy200: 0.3712 - 33s/epoch - 21ms/step
Epoch 9/50
1532/1532 - 33s - loss: 3.1914 - accuracy200: 0.4190 - val_loss: 3.2988 - val_accuracy200: 0.3707 - 33s/epoch - 21ms/step
Epoch 10/50
1532/1532 - 33s - loss: 3.1889 - accuracy200: 0.4203 - val_loss: 3.2957 - val_accuracy200: 0.3722 - 33s/epoch - 21ms/step
Epoch 11/50
1532/1532 - 34s - loss: 3.1876 - accuracy200: 0.4211 - val_loss: 3.3047 - val_accuracy200: 0.3704 - 34s/epoch - 22ms/step
Epoch 12/50
1532/1532 - 34s - loss: 3.1855 - accuracy200: 0.4217 - val_loss: 3.2997 - val_accuracy200: 0.3727 - 34s/epoch - 22ms/step
testing model: results/WBA/W8/deepOF_L2/h200
Evaluating performance on  test set...
3755/3755 - 28s - 28s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0851201
{'0': {'precision': 0.34357886112799296, 'recall': 0.35194554603581885, 'f1-score': 0.3477118808213918, 'support': 290741}, '1': {'precision': 0.4099635927625062, 'recall': 0.6477217313156948, 'f1-score': 0.5021197175293317, 'support': 391679}, '2': {'precision': 0.34360956318533165, 'recall': 0.054861554578134304, 'f1-score': 0.09461641742100346, 'support': 278738}, 'accuracy': 0.3863214996909977, 'macro avg': {'precision': 0.365717339025277, 'recall': 0.351509610643216, 'f1-score': 0.31481600525724235, 'support': 961158}, 'weighted avg': {'precision': 0.3706400343502239, 'recall': 0.3863214996909977, 'f1-score': 0.33723595885708596, 'support': 961158}}
[[102325 176194  12222]
 [120990 253699  16990]
 [ 74506 188940  15292]]
Evaluating performance on  train set...
1532/1532 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0979865
{'0': {'precision': 0.38099024683143734, 'recall': 0.3610318711314444, 'f1-score': 0.3707426459847531, 'support': 130055}, '1': {'precision': 0.33957920317196394, 'recall': 0.6529307337017084, 'f1-score': 0.44678988096646716, 'support': 130121}, '2': {'precision': 0.3974605206999573, 'recall': 0.05643853881001803, 'f1-score': 0.09884176031204807, 'support': 132002}, 'accuracy': 0.35535904614741265, 'macro avg': {'precision': 0.3726766569011195, 'recall': 0.3568003812143902, 'f1-score': 0.3054580957544228, 'support': 392178}, 'weighted avg': {'precision': 0.37279412843412296, 'recall': 0.35535904614741265, 'f1-score': 0.3044561167875192, 'support': 392178}}
[[46954 77192  5909]
 [39776 84960  5385]
 [36512 88040  7450]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0931854
{'0': {'precision': 0.3613288961588358, 'recall': 0.34333797834708973, 'f1-score': 0.3521037733256383, 'support': 37316}, '1': {'precision': 0.37198135138911825, 'recall': 0.6705443220591266, 'f1-score': 0.47851096512730007, 'support': 43669}, '2': {'precision': 0.39204763734152903, 'recall': 0.05315381009427574, 'f1-score': 0.09361526465461885, 'support': 38398}, 'accuracy': 0.36969250228256956, 'macro avg': {'precision': 0.37511929496316104, 'recall': 0.355678703500164, 'f1-score': 0.30807666770251907, 'support': 119383}, 'weighted avg': {'precision': 0.3751057344974959, 'recall': 0.36969250228256956, 'f1-score': 0.315202655937375, 'support': 119383}}
[[12812 23015  1489]
 [12711 29282  1676]
 [ 9935 26422  2041]]
training model: results/WBA/W8/deepOF_L2/h300
Epoch 1/50
1532/1532 - 36s - loss: 3.2668 - accuracy300: 0.3876 - val_loss: 3.5414 - val_accuracy300: 0.3627 - 36s/epoch - 23ms/step
Epoch 2/50
1532/1532 - 33s - loss: 3.2273 - accuracy300: 0.4045 - val_loss: 3.6906 - val_accuracy300: 0.3619 - 33s/epoch - 21ms/step
Epoch 3/50
1532/1532 - 32s - loss: 3.2095 - accuracy300: 0.4127 - val_loss: 3.7648 - val_accuracy300: 0.3625 - 32s/epoch - 21ms/step
Epoch 4/50
1532/1532 - 32s - loss: 3.2027 - accuracy300: 0.4151 - val_loss: 3.8381 - val_accuracy300: 0.3621 - 32s/epoch - 21ms/step
Epoch 5/50
1532/1532 - 33s - loss: 3.2000 - accuracy300: 0.4162 - val_loss: 3.8073 - val_accuracy300: 0.3621 - 33s/epoch - 21ms/step
Epoch 6/50
1532/1532 - 33s - loss: 3.1969 - accuracy300: 0.4171 - val_loss: 3.8110 - val_accuracy300: 0.3623 - 33s/epoch - 21ms/step
Epoch 7/50
1532/1532 - 33s - loss: 3.1939 - accuracy300: 0.4179 - val_loss: 3.8388 - val_accuracy300: 0.3621 - 33s/epoch - 21ms/step
Epoch 8/50
1532/1532 - 33s - loss: 3.1910 - accuracy300: 0.4199 - val_loss: 3.8394 - val_accuracy300: 0.3621 - 33s/epoch - 21ms/step
Epoch 9/50
1532/1532 - 33s - loss: 3.1893 - accuracy300: 0.4213 - val_loss: 3.8377 - val_accuracy300: 0.3622 - 33s/epoch - 21ms/step
Epoch 10/50
1532/1532 - 33s - loss: 3.1874 - accuracy300: 0.4214 - val_loss: 3.8377 - val_accuracy300: 0.3623 - 33s/epoch - 21ms/step
Epoch 11/50
1532/1532 - 33s - loss: 3.1854 - accuracy300: 0.4224 - val_loss: 3.8631 - val_accuracy300: 0.3620 - 33s/epoch - 21ms/step
testing model: results/WBA/W8/deepOF_L2/h300
Evaluating performance on  test set...
3755/3755 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1253084
{'0': {'precision': 0.3120725750174459, 'recall': 0.01595609931886866, 'f1-score': 0.030359912966439126, 'support': 280269}, '1': {'precision': 0.42610351382384076, 'recall': 0.9772221040457905, 'f1-score': 0.5934442684120109, 'support': 408993}, '2': {'precision': 0.2863117440940432, 'recall': 0.00931606202371495, 'f1-score': 0.01804497351670389, 'support': 271896}, 'accuracy': 0.42311669881538727, 'macro avg': {'precision': 0.34149594431177666, 'recall': 0.33416475512945804, 'f1-score': 0.21394971829838463, 'support': 961158}, 'weighted avg': {'precision': 0.3533078234058423, 'recall': 0.42311669881538727, 'f1-score': 0.26648048524500884, 'support': 961158}}
[[  4472 272947   2850]
 [  5852 399677   3464]
 [  4006 265357   2533]]
Evaluating performance on  train set...
1532/1532 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2026055
{'0': {'precision': 0.3608912010857272, 'recall': 0.02457678029544509, 'f1-score': 0.046019613498702046, 'support': 129838}, '1': {'precision': 0.33267247267305733, 'recall': 0.9652909514335508, 'f1-score': 0.4948147562530264, 'support': 129678}, '2': {'precision': 0.37710723898569204, 'recall': 0.020066032473504095, 'f1-score': 0.03810450827005247, 'support': 132662}, 'accuracy': 0.3341084915523053, 'macro avg': {'precision': 0.3568903042481588, 'recall': 0.3366445880675, 'f1-score': 0.19297962600726035, 'support': 392178}, 'weighted avg': {'precision': 0.3570457629346502, 'recall': 0.3341084915523053, 'f1-score': 0.19174125732434283, 'support': 392178}}
[[  3191 124202   2445]
 [  2549 125177   1952]
 [  3102 126898   2662]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1831343
{'0': {'precision': 0.3271948608137045, 'recall': 0.020393999252575942, 'f1-score': 0.03839485388345855, 'support': 37462}, '1': {'precision': 0.3633303839414285, 'recall': 0.9689762868710237, 'f1-score': 0.5284947288063948, 'support': 43225}, '2': {'precision': 0.3480225988700565, 'recall': 0.015918958031837915, 'f1-score': 0.030445312113873375, 'support': 38696}, 'accuracy': 0.36239665614032146, 'macro avg': {'precision': 0.3461826145417299, 'recall': 0.3350964147184792, 'f1-score': 0.19911163160124223, 'support': 119383}, 'weighted avg': {'precision': 0.3470294112859197, 'recall': 0.36239665614032146, 'f1-score': 0.21326859323686778, 'support': 119383}}
[[  764 36126   572]
 [  759 41884   582]
 [  812 37268   616]]
training model: results/WBA/W8/deepOF_L2/h500
Epoch 1/50
1532/1532 - 36s - loss: 3.2698 - accuracy500: 0.3848 - val_loss: 3.4952 - val_accuracy500: 0.3349 - 36s/epoch - 23ms/step
Epoch 2/50
1532/1532 - 33s - loss: 3.2178 - accuracy500: 0.4042 - val_loss: 3.5030 - val_accuracy500: 0.3277 - 33s/epoch - 21ms/step
Epoch 3/50
1532/1532 - 33s - loss: 3.2022 - accuracy500: 0.4102 - val_loss: 3.4881 - val_accuracy500: 0.3259 - 33s/epoch - 21ms/step
Epoch 4/50
1532/1532 - 33s - loss: 3.1963 - accuracy500: 0.4112 - val_loss: 3.4676 - val_accuracy500: 0.3277 - 33s/epoch - 21ms/step
Epoch 5/50
1532/1532 - 33s - loss: 3.1933 - accuracy500: 0.4124 - val_loss: 3.4489 - val_accuracy500: 0.3287 - 33s/epoch - 22ms/step
Epoch 6/50
1532/1532 - 33s - loss: 3.1900 - accuracy500: 0.4140 - val_loss: 3.4317 - val_accuracy500: 0.3308 - 33s/epoch - 21ms/step
Epoch 7/50
1532/1532 - 33s - loss: 3.1876 - accuracy500: 0.4141 - val_loss: 3.4323 - val_accuracy500: 0.3319 - 33s/epoch - 21ms/step
Epoch 8/50
1532/1532 - 33s - loss: 3.1853 - accuracy500: 0.4158 - val_loss: 3.4207 - val_accuracy500: 0.3332 - 33s/epoch - 21ms/step
Epoch 9/50
1532/1532 - 33s - loss: 3.1830 - accuracy500: 0.4166 - val_loss: 3.4039 - val_accuracy500: 0.3356 - 33s/epoch - 21ms/step
Epoch 10/50
1532/1532 - 33s - loss: 3.1808 - accuracy500: 0.4177 - val_loss: 3.4016 - val_accuracy500: 0.3363 - 33s/epoch - 22ms/step
Epoch 11/50
1532/1532 - 33s - loss: 3.1794 - accuracy500: 0.4191 - val_loss: 3.3931 - val_accuracy500: 0.3369 - 33s/epoch - 22ms/step
Epoch 12/50
1532/1532 - 33s - loss: 3.1773 - accuracy500: 0.4205 - val_loss: 3.3845 - val_accuracy500: 0.3377 - 33s/epoch - 21ms/step
Epoch 13/50
1532/1532 - 33s - loss: 3.1751 - accuracy500: 0.4213 - val_loss: 3.3830 - val_accuracy500: 0.3401 - 33s/epoch - 21ms/step
Epoch 14/50
1532/1532 - 33s - loss: 3.1732 - accuracy500: 0.4224 - val_loss: 3.3862 - val_accuracy500: 0.3400 - 33s/epoch - 21ms/step
Epoch 15/50
1532/1532 - 33s - loss: 3.1712 - accuracy500: 0.4241 - val_loss: 3.3824 - val_accuracy500: 0.3422 - 33s/epoch - 21ms/step
Epoch 16/50
1532/1532 - 33s - loss: 3.1692 - accuracy500: 0.4248 - val_loss: 3.3796 - val_accuracy500: 0.3406 - 33s/epoch - 21ms/step
Epoch 17/50
1532/1532 - 33s - loss: 3.1672 - accuracy500: 0.4252 - val_loss: 3.3787 - val_accuracy500: 0.3429 - 33s/epoch - 21ms/step
Epoch 18/50
1532/1532 - 33s - loss: 3.1652 - accuracy500: 0.4278 - val_loss: 3.3667 - val_accuracy500: 0.3433 - 33s/epoch - 21ms/step
Epoch 19/50
1532/1532 - 32s - loss: 3.1631 - accuracy500: 0.4291 - val_loss: 3.3740 - val_accuracy500: 0.3429 - 32s/epoch - 21ms/step
Epoch 20/50
1532/1532 - 33s - loss: 3.1609 - accuracy500: 0.4296 - val_loss: 3.3825 - val_accuracy500: 0.3437 - 33s/epoch - 21ms/step
Epoch 21/50
1532/1532 - 33s - loss: 3.1593 - accuracy500: 0.4305 - val_loss: 3.3790 - val_accuracy500: 0.3432 - 33s/epoch - 21ms/step
Epoch 22/50
1532/1532 - 33s - loss: 3.1574 - accuracy500: 0.4315 - val_loss: 3.3862 - val_accuracy500: 0.3441 - 33s/epoch - 21ms/step
Epoch 23/50
1532/1532 - 33s - loss: 3.1545 - accuracy500: 0.4332 - val_loss: 3.3920 - val_accuracy500: 0.3420 - 33s/epoch - 21ms/step
Epoch 24/50
1532/1532 - 33s - loss: 3.1527 - accuracy500: 0.4342 - val_loss: 3.3952 - val_accuracy500: 0.3447 - 33s/epoch - 21ms/step
Epoch 25/50
1532/1532 - 33s - loss: 3.1502 - accuracy500: 0.4355 - val_loss: 3.3953 - val_accuracy500: 0.3428 - 33s/epoch - 21ms/step
Epoch 26/50
1532/1532 - 33s - loss: 3.1474 - accuracy500: 0.4368 - val_loss: 3.3875 - val_accuracy500: 0.3457 - 33s/epoch - 21ms/step
Epoch 27/50
1532/1532 - 33s - loss: 3.1456 - accuracy500: 0.4378 - val_loss: 3.3971 - val_accuracy500: 0.3458 - 33s/epoch - 22ms/step
Epoch 28/50
1532/1532 - 33s - loss: 3.1430 - accuracy500: 0.4385 - val_loss: 3.4236 - val_accuracy500: 0.3441 - 33s/epoch - 22ms/step
testing model: results/WBA/W8/deepOF_L2/h500
Evaluating performance on  test set...
3755/3755 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1063238
{'0': {'precision': 0.37725177525850256, 'recall': 0.14659626723812413, 'f1-score': 0.2111440630694284, 'support': 309851}, '1': {'precision': 0.3816584401559478, 'recall': 0.8852343484659798, 'f1-score': 0.5333634600217423, 'support': 353320}, '2': {'precision': 0.3565041415662651, 'recall': 0.025420572038377512, 'f1-score': 0.04745720237442636, 'support': 297987}, 'accuracy': 0.3805503361570106, 'macro avg': {'precision': 0.3718047856602385, 'recall': 0.35241706258082717, 'f1-score': 0.2639882418218657, 'support': 961158}, 'weighted avg': {'precision': 0.3724392862822017, 'recall': 0.3805503361570106, 'f1-score': 0.27884365124667915, 'support': 961158}}
[[ 45423 256702   7726]
 [ 34602 312771   5947]
 [ 40380 250032   7575]]
Evaluating performance on  train set...
1532/1532 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1098894
{'0': {'precision': 0.40304620504287725, 'recall': 0.19361036605516574, 'f1-score': 0.26157064909848876, 'support': 130117}, '1': {'precision': 0.3580620836998869, 'recall': 0.8794129221936708, 'f1-score': 0.5089143972259869, 'support': 129591}, '2': {'precision': 0.42794453220993506, 'recall': 0.036808333962406584, 'f1-score': 0.06778624256242007, 'support': 132470}, 'accuracy': 0.36726180458873264, 'macro avg': {'precision': 0.3963509403175664, 'recall': 0.3699438740704144, 'f1-score': 0.2794237629622986, 'support': 392178}, 'weighted avg': {'precision': 0.39659185046628365, 'recall': 0.36726180458873264, 'f1-score': 0.27784617533850625, 'support': 392178}}
[[ 25192 100642   4283]
 [ 13392 113964   2235]
 [ 23920 103674   4876]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1246822
{'0': {'precision': 0.3739005461339465, 'recall': 0.1651683681243334, 'f1-score': 0.2291229986084935, 'support': 39378}, '1': {'precision': 0.3364271730420052, 'recall': 0.8654332907131488, 'f1-score': 0.4845076183658861, 'support': 38323}, '2': {'precision': 0.4185022026431718, 'recall': 0.034187419029797037, 'f1-score': 0.06321112515802782, 'support': 41682}, 'accuracy': 0.3442282402017038, 'macro avg': {'precision': 0.3762766406063745, 'recall': 0.3549296926224264, 'f1-score': 0.25894724737746916, 'support': 119383}, 'weighted avg': {'precision': 0.3774437153424189, 'recall': 0.3442282402017038, 'f1-score': 0.25317639041302387, 'support': 119383}}
[[ 6504 31690  1184]
 [ 4361 33166   796]
 [ 6530 33727  1425]]
training model: results/WBA/W8/deepOF_L2/h1000
Epoch 1/50
1532/1532 - 36s - loss: 3.2896 - accuracy1000: 0.3755 - val_loss: 3.3316 - val_accuracy1000: 0.3515 - 36s/epoch - 23ms/step
Epoch 2/50
1532/1532 - 33s - loss: 3.2538 - accuracy1000: 0.3882 - val_loss: 3.3245 - val_accuracy1000: 0.3472 - 33s/epoch - 22ms/step
Epoch 3/50
1532/1532 - 33s - loss: 3.2372 - accuracy1000: 0.3956 - val_loss: 3.3142 - val_accuracy1000: 0.3475 - 33s/epoch - 21ms/step
Epoch 4/50
1532/1532 - 33s - loss: 3.2315 - accuracy1000: 0.3986 - val_loss: 3.3101 - val_accuracy1000: 0.3457 - 33s/epoch - 22ms/step
Epoch 5/50
1532/1532 - 33s - loss: 3.2282 - accuracy1000: 0.3997 - val_loss: 3.3077 - val_accuracy1000: 0.3472 - 33s/epoch - 22ms/step
Epoch 6/50
1532/1532 - 33s - loss: 3.2263 - accuracy1000: 0.4002 - val_loss: 3.3071 - val_accuracy1000: 0.3481 - 33s/epoch - 21ms/step
Epoch 7/50
1532/1532 - 33s - loss: 3.2247 - accuracy1000: 0.4013 - val_loss: 3.3047 - val_accuracy1000: 0.3502 - 33s/epoch - 22ms/step
Epoch 8/50
1532/1532 - 33s - loss: 3.2231 - accuracy1000: 0.4024 - val_loss: 3.3029 - val_accuracy1000: 0.3511 - 33s/epoch - 21ms/step
Epoch 9/50
1532/1532 - 33s - loss: 3.2218 - accuracy1000: 0.4022 - val_loss: 3.3052 - val_accuracy1000: 0.3509 - 33s/epoch - 22ms/step
Epoch 10/50
1532/1532 - 33s - loss: 3.2197 - accuracy1000: 0.4030 - val_loss: 3.3062 - val_accuracy1000: 0.3515 - 33s/epoch - 22ms/step
Epoch 11/50
1532/1532 - 33s - loss: 3.2188 - accuracy1000: 0.4038 - val_loss: 3.3049 - val_accuracy1000: 0.3517 - 33s/epoch - 21ms/step
Epoch 12/50
1532/1532 - 33s - loss: 3.2174 - accuracy1000: 0.4042 - val_loss: 3.3063 - val_accuracy1000: 0.3538 - 33s/epoch - 21ms/step
Epoch 13/50
1532/1532 - 33s - loss: 3.2161 - accuracy1000: 0.4048 - val_loss: 3.3051 - val_accuracy1000: 0.3542 - 33s/epoch - 21ms/step
Epoch 14/50
1532/1532 - 33s - loss: 3.2148 - accuracy1000: 0.4057 - val_loss: 3.3055 - val_accuracy1000: 0.3546 - 33s/epoch - 21ms/step
Epoch 15/50
1532/1532 - 33s - loss: 3.2135 - accuracy1000: 0.4069 - val_loss: 3.3062 - val_accuracy1000: 0.3557 - 33s/epoch - 21ms/step
Epoch 16/50
1532/1532 - 33s - loss: 3.2122 - accuracy1000: 0.4074 - val_loss: 3.3049 - val_accuracy1000: 0.3559 - 33s/epoch - 21ms/step
Epoch 17/50
1532/1532 - 33s - loss: 3.2111 - accuracy1000: 0.4082 - val_loss: 3.3060 - val_accuracy1000: 0.3566 - 33s/epoch - 21ms/step
Epoch 18/50
1532/1532 - 33s - loss: 3.2096 - accuracy1000: 0.4088 - val_loss: 3.3085 - val_accuracy1000: 0.3578 - 33s/epoch - 21ms/step
testing model: results/WBA/W8/deepOF_L2/h1000
Evaluating performance on  test set...
3755/3755 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0974228
{'0': {'precision': 0.37287120084244163, 'recall': 0.12742169153117602, 'f1-score': 0.1899362547774235, 'support': 322347}, '1': {'precision': 0.366088505385991, 'recall': 0.8903160390240501, 'f1-score': 0.5188368181214059, 'support': 344198}, '2': {'precision': 0.3220570279393809, 'recall': 0.015219966532366189, 'f1-score': 0.029066300204838334, 'support': 294613}, 'accuracy': 0.3662280291065569, 'macro avg': {'precision': 0.35367224472260456, 'recall': 0.3443192323625308, 'f1-score': 0.2459464577012226, 'support': 961158}, 'weighted avg': {'precision': 0.35486676647035215, 'recall': 0.3662280291065569, 'f1-score': 0.2584083854524832, 'support': 961158}}
[[ 41074 275895   5378]
 [ 33692 306445   4061]
 [ 35390 254739   4484]]
Evaluating performance on  train set...
1532/1532 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1012529
{'0': {'precision': 0.38539994822676676, 'recall': 0.17104255384332587, 'f1-score': 0.23693298463203347, 'support': 130564}, '1': {'precision': 0.34593262875335923, 'recall': 0.8776763640321552, 'f1-score': 0.49626456424312093, 'support': 128626}, '2': {'precision': 0.40940192600101366, 'recall': 0.024295425151141456, 'f1-score': 0.04586882453151619, 'support': 132988}, 'accuracy': 0.35304122107818386, 'macro avg': {'precision': 0.38024483432704653, 'recall': 0.35767144767554077, 'f1-score': 0.2596887911355569, 'support': 392178}, 'weighted avg': {'precision': 0.3805946087779834, 'recall': 0.35304122107818386, 'f1-score': 0.25719812759162874, 'support': 392178}}
[[ 22332 105311   2921]
 [ 13994 112892   1740]
 [ 21619 108138   3231]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.102686
{'0': {'precision': 0.3531912345826847, 'recall': 0.15465890619264852, 'f1-score': 0.21511924731967036, 'support': 38142}, '1': {'precision': 0.34973258842475696, 'recall': 0.8695254572417203, 'f1-score': 0.4988302352290612, 'support': 40460}, '2': {'precision': 0.3996166746526114, 'recall': 0.020450700080920037, 'f1-score': 0.038910142763833165, 'support': 40781}, 'accuracy': 0.351088513439937, 'macro avg': {'precision': 0.3675134992200177, 'recall': 0.3482116878384296, 'f1-score': 0.2509532084375216, 'support': 119383}, 'weighted avg': {'precision': 0.36787790729104286, 'recall': 0.351088513439937, 'f1-score': 0.251078831832728, 'support': 119383}}
[[ 5899 31534   709]
 [ 4735 35181   544]
 [ 6068 33879   834]]
training model: results/WBA/W8/deepVOL_L2/h10
Epoch 1/50
1532/1532 - 36s - loss: 3.0946 - accuracy10: 0.4563 - val_loss: 3.1801 - val_accuracy10: 0.5045 - 36s/epoch - 23ms/step
Epoch 2/50
1532/1532 - 34s - loss: 2.9310 - accuracy10: 0.4972 - val_loss: 3.0655 - val_accuracy10: 0.5100 - 34s/epoch - 22ms/step
Epoch 3/50
1532/1532 - 34s - loss: 2.8546 - accuracy10: 0.5247 - val_loss: 3.0415 - val_accuracy10: 0.5196 - 34s/epoch - 22ms/step
Epoch 4/50
1532/1532 - 34s - loss: 2.8079 - accuracy10: 0.5383 - val_loss: 3.0600 - val_accuracy10: 0.5211 - 34s/epoch - 22ms/step
Epoch 5/50
1532/1532 - 32s - loss: 2.7788 - accuracy10: 0.5465 - val_loss: 3.0494 - val_accuracy10: 0.5275 - 32s/epoch - 21ms/step
Epoch 6/50
1532/1532 - 34s - loss: 2.7586 - accuracy10: 0.5514 - val_loss: 3.0111 - val_accuracy10: 0.5321 - 34s/epoch - 22ms/step
Epoch 7/50
1532/1532 - 35s - loss: 2.7452 - accuracy10: 0.5543 - val_loss: 3.0172 - val_accuracy10: 0.5335 - 35s/epoch - 23ms/step
Epoch 8/50
1532/1532 - 35s - loss: 2.7325 - accuracy10: 0.5573 - val_loss: 3.0261 - val_accuracy10: 0.5330 - 35s/epoch - 23ms/step
Epoch 9/50
1532/1532 - 35s - loss: 2.7225 - accuracy10: 0.5596 - val_loss: 3.0180 - val_accuracy10: 0.5362 - 35s/epoch - 23ms/step
Epoch 10/50
1532/1532 - 34s - loss: 2.7144 - accuracy10: 0.5609 - val_loss: 3.0230 - val_accuracy10: 0.5373 - 34s/epoch - 22ms/step
Epoch 11/50
1532/1532 - 33s - loss: 2.7065 - accuracy10: 0.5625 - val_loss: 3.0068 - val_accuracy10: 0.5362 - 33s/epoch - 21ms/step
Epoch 12/50
1532/1532 - 33s - loss: 2.7002 - accuracy10: 0.5642 - val_loss: 3.0308 - val_accuracy10: 0.5346 - 33s/epoch - 21ms/step
Epoch 13/50
1532/1532 - 35s - loss: 2.6946 - accuracy10: 0.5648 - val_loss: 3.0255 - val_accuracy10: 0.5354 - 35s/epoch - 23ms/step
Epoch 14/50
1532/1532 - 36s - loss: 2.6896 - accuracy10: 0.5671 - val_loss: 3.0330 - val_accuracy10: 0.5353 - 36s/epoch - 24ms/step
Epoch 15/50
1532/1532 - 33s - loss: 2.6845 - accuracy10: 0.5672 - val_loss: 3.0309 - val_accuracy10: 0.5362 - 33s/epoch - 22ms/step
Epoch 16/50
1532/1532 - 32s - loss: 2.6787 - accuracy10: 0.5678 - val_loss: 3.0120 - val_accuracy10: 0.5391 - 32s/epoch - 21ms/step
Epoch 17/50
1532/1532 - 34s - loss: 2.6744 - accuracy10: 0.5693 - val_loss: 3.0249 - val_accuracy10: 0.5376 - 34s/epoch - 22ms/step
Epoch 18/50
1532/1532 - 33s - loss: 2.6703 - accuracy10: 0.5700 - val_loss: 3.0090 - val_accuracy10: 0.5397 - 33s/epoch - 21ms/step
Epoch 19/50
1532/1532 - 33s - loss: 2.6663 - accuracy10: 0.5704 - val_loss: 3.0158 - val_accuracy10: 0.5362 - 33s/epoch - 21ms/step
Epoch 20/50
1532/1532 - 33s - loss: 2.6625 - accuracy10: 0.5717 - val_loss: 3.0167 - val_accuracy10: 0.5365 - 33s/epoch - 21ms/step
Epoch 21/50
1532/1532 - 34s - loss: 2.6583 - accuracy10: 0.5724 - val_loss: 3.0230 - val_accuracy10: 0.5365 - 34s/epoch - 22ms/step
testing model: results/WBA/W8/deepVOL_L2/h10
Evaluating performance on  test set...
3755/3755 - 38s - 38s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.912129
{'0': {'precision': 0.44044581864152493, 'recall': 0.5046486363854507, 'f1-score': 0.47036649214659687, 'support': 229207}, '1': {'precision': 0.6933233995541594, 'recall': 0.6901636104267647, 'f1-score': 0.6917398966199976, 'support': 511031}, '2': {'precision': 0.47278540688885023, 'recall': 0.4062690958470069, 'f1-score': 0.4370106726911541, 'support': 220925}, 'accuracy': 0.5806705002169247, 'macro avg': {'precision': 0.5355182083615115, 'recall': 0.5336937808864074, 'f1-score': 0.5330390204859162, 'support': 961163}, 'weighted avg': {'precision': 0.5823290440516841, 'recall': 0.5806705002169247, 'f1-score': 0.5803993771497158, 'support': 961163}}
[[115669  77988  35550]
 [ 93798 352695  64538]
 [ 53151  78019  89755]]
Evaluating performance on  train set...
1532/1532 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93806654
{'0': {'precision': 0.4541278620841803, 'recall': 0.5621257339029005, 'f1-score': 0.5023882990778028, 'support': 102534}, '1': {'precision': 0.6679960873959025, 'recall': 0.6582035826109183, 'f1-score': 0.6630636816427466, 'support': 187796}, '2': {'precision': 0.481326352530541, 'recall': 0.3791028070416589, 'f1-score': 0.42414223022886677, 'support': 101851}, 'accuracy': 0.5606008450179891, 'macro avg': {'precision': 0.5344834340035413, 'recall': 0.5331440411851592, 'f1-score': 0.5298647369831387, 'support': 392181}, 'weighted avg': {'precision': 0.5636022901954159, 'recall': 0.5606008450179892, 'f1-score': 0.5590069363545531, 'support': 392181}}
[[ 57637  28670  16227]
 [ 38807 123608  25381]
 [ 30474  32765  38612]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9783829
{'0': {'precision': 0.4327094359106751, 'recall': 0.5499917965545529, 'f1-score': 0.4843519722583442, 'support': 30475}, '1': {'precision': 0.6459301481266337, 'recall': 0.6094962402151385, 'f1-score': 0.6271845173571636, 'support': 58381}, '2': {'precision': 0.46236306729264476, 'recall': 0.3871327021980542, 'f1-score': 0.4214167275839321, 'support': 30527}, 'accuracy': 0.5374467051422732, 'macro avg': {'precision': 0.5136675504433179, 'recall': 0.5155402463225819, 'f1-score': 0.5109844057331466, 'support': 119383}, 'weighted avg': {'precision': 0.5445618336982769, 'recall': 0.5374467051422732, 'f1-score': 0.5381073863561504, 'support': 119383}}
[[16761  9072  4642]
 [13698 35583  9100]
 [ 8276 10433 11818]]
training model: results/WBA/W8/deepVOL_L2/h20
Epoch 1/50
1532/1532 - 38s - loss: 3.1680 - accuracy20: 0.4277 - val_loss: 3.4173 - val_accuracy20: 0.3992 - 38s/epoch - 25ms/step
Epoch 2/50
1532/1532 - 32s - loss: 2.9979 - accuracy20: 0.4839 - val_loss: 3.1980 - val_accuracy20: 0.4720 - 32s/epoch - 21ms/step
Epoch 3/50
1532/1532 - 34s - loss: 2.9285 - accuracy20: 0.5091 - val_loss: 3.2268 - val_accuracy20: 0.4808 - 34s/epoch - 22ms/step
Epoch 4/50
1532/1532 - 34s - loss: 2.8863 - accuracy20: 0.5207 - val_loss: 3.2872 - val_accuracy20: 0.4827 - 34s/epoch - 22ms/step
Epoch 5/50
1532/1532 - 35s - loss: 2.8578 - accuracy20: 0.5255 - val_loss: 3.2562 - val_accuracy20: 0.4886 - 35s/epoch - 23ms/step
Epoch 6/50
1532/1532 - 33s - loss: 2.8382 - accuracy20: 0.5287 - val_loss: 3.2559 - val_accuracy20: 0.4885 - 33s/epoch - 22ms/step
Epoch 7/50
1532/1532 - 33s - loss: 2.8241 - accuracy20: 0.5333 - val_loss: 3.2333 - val_accuracy20: 0.4938 - 33s/epoch - 22ms/step
Epoch 8/50
1532/1532 - 34s - loss: 2.8125 - accuracy20: 0.5358 - val_loss: 3.2150 - val_accuracy20: 0.4981 - 34s/epoch - 22ms/step
Epoch 9/50
1532/1532 - 35s - loss: 2.8052 - accuracy20: 0.5380 - val_loss: 3.2048 - val_accuracy20: 0.4972 - 35s/epoch - 23ms/step
Epoch 10/50
1532/1532 - 33s - loss: 2.7966 - accuracy20: 0.5397 - val_loss: 3.2067 - val_accuracy20: 0.4984 - 33s/epoch - 21ms/step
Epoch 11/50
1532/1532 - 34s - loss: 2.7899 - accuracy20: 0.5407 - val_loss: 3.2105 - val_accuracy20: 0.4993 - 34s/epoch - 22ms/step
Epoch 12/50
1532/1532 - 35s - loss: 2.7851 - accuracy20: 0.5423 - val_loss: 3.2101 - val_accuracy20: 0.4987 - 35s/epoch - 23ms/step
testing model: results/WBA/W8/deepVOL_L2/h20
Evaluating performance on  test set...
3755/3755 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0039781
{'0': {'precision': 0.5074342662036362, 'recall': 0.241915063823867, 'f1-score': 0.32763355614280537, 'support': 287510}, '1': {'precision': 0.5544581202400953, 'recall': 0.7502234462039181, 'f1-score': 0.6376536504244704, 'support': 399425}, '2': {'precision': 0.43704233843246615, 'recall': 0.45204720159866973, 'f1-score': 0.44441815401768514, 'support': 274228}, 'accuracy': 0.5131023562080521, 'macro avg': {'precision': 0.4996449082920659, 'recall': 0.4813952372088182, 'f1-score': 0.46990178686165357, 'support': 961163}, 'weighted avg': {'precision': 0.506892282512712, 'recall': 0.5131023562080521, 'f1-score': 0.4897864717923743, 'support': 961163}}
[[ 69553 125637  92320]
 [ 32408 299658  67359]
 [ 35107 115157 123964]]
Evaluating performance on  train set...
1532/1532 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0266328
{'0': {'precision': 0.4966397546344324, 'recall': 0.2651676914926068, 'f1-score': 0.34573780529287707, 'support': 124574}, '1': {'precision': 0.5190557887319629, 'recall': 0.7058786767769353, 'f1-score': 0.5982204332397648, 'support': 144012}, '2': {'precision': 0.4482368165642187, 'recall': 0.4708200169909786, 'f1-score': 0.45925095790732273, 'support': 123595}, 'accuracy': 0.4918111790219312, 'macro avg': {'precision': 0.48797745331020465, 'recall': 0.48062212842017354, 'f1-score': 0.4677363988133216, 'support': 392181}, 'weighted avg': {'precision': 0.48961701965151766, 'recall': 0.4918111790219312, 'f1-score': 0.4742248720127579, 'support': 392181}}
[[ 33033  47314  44227]
 [ 14953 101655  27404]
 [ 18527  46877  58191]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0534216
{'0': {'precision': 0.48969023632426323, 'recall': 0.27538188653270856, 'f1-score': 0.3525205456239939, 'support': 37773}, '1': {'precision': 0.4969071802621868, 'recall': 0.6403741196186336, 'f1-score': 0.559591541909502, 'support': 44157}, '2': {'precision': 0.42868922032254153, 'recall': 0.4719782126932422, 'f1-score': 0.4492934119560797, 'support': 37453}, 'accuracy': 0.47206051112805003, 'macro avg': {'precision': 0.47176221230299714, 'recall': 0.46257807294819475, 'f1-score': 0.45380183316319184, 'support': 119383}, 'weighted avg': {'precision': 0.4732222931594442, 'recall': 0.47206051112805003, 'f1-score': 0.45947101717953187, 'support': 119383}}
[[10402 14295 13076]
 [ 5398 28277 10482]
 [ 5442 14334 17677]]
training model: results/WBA/W8/deepVOL_L2/h30
Epoch 1/50
1532/1532 - 35s - loss: 3.1479 - accuracy30: 0.4368 - val_loss: 3.3062 - val_accuracy30: 0.4214 - 35s/epoch - 23ms/step
Epoch 2/50
1532/1532 - 32s - loss: 3.0272 - accuracy30: 0.4802 - val_loss: 3.1905 - val_accuracy30: 0.4573 - 32s/epoch - 21ms/step
Epoch 3/50
1532/1532 - 32s - loss: 2.9816 - accuracy30: 0.4937 - val_loss: 3.2159 - val_accuracy30: 0.4596 - 32s/epoch - 21ms/step
Epoch 4/50
1532/1532 - 34s - loss: 2.9581 - accuracy30: 0.4992 - val_loss: 3.2163 - val_accuracy30: 0.4642 - 34s/epoch - 22ms/step
Epoch 5/50
1532/1532 - 34s - loss: 2.9370 - accuracy30: 0.5043 - val_loss: 3.2216 - val_accuracy30: 0.4672 - 34s/epoch - 22ms/step
Epoch 6/50
1532/1532 - 32s - loss: 2.9234 - accuracy30: 0.5085 - val_loss: 3.2326 - val_accuracy30: 0.4651 - 32s/epoch - 21ms/step
Epoch 7/50
1532/1532 - 33s - loss: 2.9121 - accuracy30: 0.5098 - val_loss: 3.2270 - val_accuracy30: 0.4687 - 33s/epoch - 22ms/step
Epoch 8/50
1532/1532 - 31s - loss: 2.9032 - accuracy30: 0.5129 - val_loss: 3.2281 - val_accuracy30: 0.4698 - 31s/epoch - 20ms/step
Epoch 9/50
1532/1532 - 32s - loss: 2.8946 - accuracy30: 0.5146 - val_loss: 3.2154 - val_accuracy30: 0.4690 - 32s/epoch - 21ms/step
Epoch 10/50
1532/1532 - 35s - loss: 2.8874 - accuracy30: 0.5166 - val_loss: 3.2280 - val_accuracy30: 0.4704 - 35s/epoch - 23ms/step
Epoch 11/50
1532/1532 - 33s - loss: 2.8816 - accuracy30: 0.5183 - val_loss: 3.2215 - val_accuracy30: 0.4700 - 33s/epoch - 21ms/step
Epoch 12/50
1532/1532 - 33s - loss: 2.8737 - accuracy30: 0.5212 - val_loss: 3.2324 - val_accuracy30: 0.4693 - 33s/epoch - 22ms/step
testing model: results/WBA/W8/deepVOL_L2/h30
Evaluating performance on  test set...
3755/3755 - 40s - 40s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0214508
{'0': {'precision': 0.48069122866317393, 'recall': 0.3722913407985759, 'f1-score': 0.41960337394011143, 'support': 305594}, '1': {'precision': 0.514506011227634, 'recall': 0.6784981320186854, 'f1-score': 0.5852307714211475, 'support': 363494}, '2': {'precision': 0.45765104230408354, 'recall': 0.3840931267653856, 'f1-score': 0.4176580634953137, 'support': 292075}, 'accuracy': 0.4916793509529601, 'macro avg': {'precision': 0.48428276073163046, 'recall': 0.4782941998608823, 'f1-score': 0.4741640696188576, 'support': 961163}, 'weighted avg': {'precision': 0.48647797674092397, 'recall': 0.4916793509529601, 'f1-score': 0.4816494459089736, 'support': 961163}}
[[113770 120446  71378]
 [ 55296 246630  61568]
 [ 67614 112277 112184]]
Evaluating performance on  train set...
1532/1532 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.043952
{'0': {'precision': 0.4742516203963883, 'recall': 0.3860576116626256, 'f1-score': 0.4256340419808505, 'support': 131154}, '1': {'precision': 0.47394214678460433, 'recall': 0.6360428077090542, 'f1-score': 0.5431559995694674, 'support': 130911}, '2': {'precision': 0.4694571269741459, 'recall': 0.39590826646991917, 'f1-score': 0.42955717603305443, 'support': 130116}, 'accuracy': 0.47277150091411874, 'macro avg': {'precision': 0.47255029805171284, 'recall': 0.47266956194719967, 'f1-score': 0.4661157391944575, 'support': 392181}, 'weighted avg': {'precision': 0.47255762245635363, 'recall': 0.47277150091411874, 'f1-score': 0.46616476504040716, 'support': 392181}}
[[50633 45815 34706]
 [24135 83265 23511]
 [31996 46606 51514]]
Evaluating performance on  val set...
467/467 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0631312
{'0': {'precision': 0.46788990825688076, 'recall': 0.4059918133648075, 'f1-score': 0.434748702503563, 'support': 39821}, '1': {'precision': 0.4521180286117909, 'recall': 0.5695701215691189, 'f1-score': 0.5040929964283337, 'support': 39895}, '2': {'precision': 0.4565387174221168, 'recall': 0.39788741271081757, 'f1-score': 0.42520003232845716, 'support': 39667}, 'accuracy': 0.45796302656157073, 'macro avg': {'precision': 0.45884888476359614, 'recall': 0.45781644921491466, 'f1-score': 0.4546805770867846, 'support': 119383}, 'weighted avg': {'precision': 0.4588476926542955, 'recall': 0.45796302656157073, 'f1-score': 0.4547492344578011, 'support': 119383}}
[[16167 13486 10168]
 [ 8552 22723  8620]
 [ 9834 14050 15783]]
training model: results/WBA/W8/deepVOL_L2/h50
Epoch 1/50
1532/1532 - 39s - loss: 3.2114 - accuracy50: 0.4102 - val_loss: 3.3590 - val_accuracy50: 0.3648 - 39s/epoch - 25ms/step
Epoch 2/50
1532/1532 - 36s - loss: 3.1418 - accuracy50: 0.4394 - val_loss: 3.3085 - val_accuracy50: 0.3956 - 36s/epoch - 24ms/step
Epoch 3/50
1532/1532 - 32s - loss: 3.1234 - accuracy50: 0.4466 - val_loss: 3.2973 - val_accuracy50: 0.4067 - 32s/epoch - 21ms/step
Epoch 4/50
1532/1532 - 34s - loss: 3.1066 - accuracy50: 0.4551 - val_loss: 3.3126 - val_accuracy50: 0.4106 - 34s/epoch - 22ms/step
Epoch 5/50
1532/1532 - 31s - loss: 3.0937 - accuracy50: 0.4586 - val_loss: 3.2938 - val_accuracy50: 0.4235 - 31s/epoch - 20ms/step
Epoch 6/50
1532/1532 - 36s - loss: 3.0837 - accuracy50: 0.4626 - val_loss: 3.3078 - val_accuracy50: 0.4267 - 36s/epoch - 23ms/step
Epoch 7/50
1532/1532 - 32s - loss: 3.0761 - accuracy50: 0.4649 - val_loss: 3.3396 - val_accuracy50: 0.4242 - 32s/epoch - 21ms/step
Epoch 8/50
1532/1532 - 34s - loss: 3.0686 - accuracy50: 0.4666 - val_loss: 3.3308 - val_accuracy50: 0.4287 - 34s/epoch - 22ms/step
Epoch 9/50
1532/1532 - 33s - loss: 3.0631 - accuracy50: 0.4683 - val_loss: 3.3461 - val_accuracy50: 0.4270 - 33s/epoch - 22ms/step
Epoch 10/50
1532/1532 - 33s - loss: 3.0590 - accuracy50: 0.4697 - val_loss: 3.3463 - val_accuracy50: 0.4279 - 33s/epoch - 22ms/step
Epoch 11/50
1532/1532 - 35s - loss: 3.0542 - accuracy50: 0.4715 - val_loss: 3.3439 - val_accuracy50: 0.4234 - 35s/epoch - 23ms/step
Epoch 12/50
1532/1532 - 35s - loss: 3.0490 - accuracy50: 0.4729 - val_loss: 3.3478 - val_accuracy50: 0.4245 - 35s/epoch - 23ms/step
Epoch 13/50
1532/1532 - 34s - loss: 3.0442 - accuracy50: 0.4748 - val_loss: 3.3499 - val_accuracy50: 0.4304 - 34s/epoch - 22ms/step
Epoch 14/50
1532/1532 - 33s - loss: 3.0415 - accuracy50: 0.4751 - val_loss: 3.3516 - val_accuracy50: 0.4277 - 33s/epoch - 21ms/step
Epoch 15/50
1532/1532 - 32s - loss: 3.0365 - accuracy50: 0.4769 - val_loss: 3.3610 - val_accuracy50: 0.4280 - 32s/epoch - 21ms/step
testing model: results/WBA/W8/deepVOL_L2/h50
Evaluating performance on  test set...
3755/3755 - 41s - 41s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0708218
{'0': {'precision': 0.47439514121668713, 'recall': 0.2758243631346543, 'f1-score': 0.34883054077193865, 'support': 310937}, '1': {'precision': 0.4703219974993504, 'recall': 0.5954105329449736, 'f1-score': 0.5255252386263953, 'support': 355684}, '2': {'precision': 0.4177022302738008, 'recall': 0.4681199964690944, 'f1-score': 0.4414763158063257, 'support': 294542}, 'accuracy': 0.4530168140055329, 'macro avg': {'precision': 0.45413978966327945, 'recall': 0.44645163084957407, 'f1-score': 0.4386106984015532, 'support': 961163}, 'weighted avg': {'precision': 0.4555146855344596, 'recall': 0.4530168140055329, 'f1-score': 0.44260812977801045, 'support': 961163}}
[[ 85764 127019  98154]
 [ 49847 211778  94059]
 [ 45175 111486 137881]]
Evaluating performance on  train set...
1532/1532 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0887764
{'0': {'precision': 0.4692079267923156, 'recall': 0.2937667896006921, 'f1-score': 0.3613165766766379, 'support': 131778}, '1': {'precision': 0.41112824958623717, 'recall': 0.5646600380398645, 'f1-score': 0.475815698947149, 'support': 129338}, '2': {'precision': 0.43523834047774124, 'recall': 0.4384694617174684, 'f1-score': 0.43684792647746323, 'support': 131065}, 'accuracy': 0.43146404338812944, 'macro avg': {'precision': 0.438524838952098, 'recall': 0.43229876311934173, 'f1-score': 0.42466006736708334, 'support': 392181}, 'weighted avg': {'precision': 0.4387012650193091, 'recall': 0.43146404338812944, 'f1-score': 0.42431963862473976, 'support': 392181}}
[[38712 53304 39762]
 [21498 73032 34808]
 [22295 51302 57468]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0987443
{'0': {'precision': 0.46531935176358435, 'recall': 0.30643865200140624, 'f1-score': 0.36952473238754213, 'support': 39822}, '1': {'precision': 0.39985660582102855, 'recall': 0.5228683643734955, 'f1-score': 0.45316291684509885, 'support': 39465}, '2': {'precision': 0.42590007701193683, 'recall': 0.44136572226656023, 'f1-score': 0.4334950029394473, 'support': 40096}, 'accuracy': 0.42330147508439225, 'macro avg': {'precision': 0.43035867819884993, 'recall': 0.423557579547154, 'f1-score': 0.4187275507240294, 'support': 119383}, 'weighted avg': {'precision': 0.4304396577613812, 'recall': 0.42330147508439225, 'f1-score': 0.41865846933222156, 'support': 119383}}
[[12203 15497 12122]
 [ 7097 20635 11733]
 [ 6925 15474 17697]]
training model: results/WBA/W8/deepVOL_L2/h100
Epoch 1/50
1532/1532 - 35s - loss: 3.2713 - accuracy100: 0.3839 - val_loss: 3.4289 - val_accuracy100: 0.3489 - 35s/epoch - 23ms/step
Epoch 2/50
1532/1532 - 33s - loss: 3.2356 - accuracy100: 0.3963 - val_loss: 3.4364 - val_accuracy100: 0.3546 - 33s/epoch - 22ms/step
Epoch 3/50
1532/1532 - 33s - loss: 3.2207 - accuracy100: 0.4063 - val_loss: 3.4144 - val_accuracy100: 0.3573 - 33s/epoch - 21ms/step
Epoch 4/50
1532/1532 - 35s - loss: 3.2125 - accuracy100: 0.4103 - val_loss: 3.3993 - val_accuracy100: 0.3606 - 35s/epoch - 23ms/step
Epoch 5/50
1532/1532 - 33s - loss: 3.2060 - accuracy100: 0.4130 - val_loss: 3.4831 - val_accuracy100: 0.3595 - 33s/epoch - 21ms/step
Epoch 6/50
1532/1532 - 32s - loss: 3.1981 - accuracy100: 0.4159 - val_loss: 3.5184 - val_accuracy100: 0.3588 - 32s/epoch - 21ms/step
Epoch 7/50
1532/1532 - 36s - loss: 3.1929 - accuracy100: 0.4176 - val_loss: 3.5222 - val_accuracy100: 0.3623 - 36s/epoch - 23ms/step
Epoch 8/50
1532/1532 - 34s - loss: 3.1869 - accuracy100: 0.4197 - val_loss: 3.5557 - val_accuracy100: 0.3610 - 34s/epoch - 22ms/step
Epoch 9/50
1532/1532 - 34s - loss: 3.1828 - accuracy100: 0.4218 - val_loss: 3.5896 - val_accuracy100: 0.3610 - 34s/epoch - 22ms/step
Epoch 10/50
1532/1532 - 34s - loss: 3.1785 - accuracy100: 0.4238 - val_loss: 3.5914 - val_accuracy100: 0.3632 - 34s/epoch - 22ms/step
Epoch 11/50
1532/1532 - 33s - loss: 3.1745 - accuracy100: 0.4257 - val_loss: 3.6035 - val_accuracy100: 0.3623 - 33s/epoch - 21ms/step
Epoch 12/50
1532/1532 - 34s - loss: 3.1712 - accuracy100: 0.4268 - val_loss: 3.6056 - val_accuracy100: 0.3619 - 34s/epoch - 22ms/step
Epoch 13/50
1532/1532 - 32s - loss: 3.1683 - accuracy100: 0.4281 - val_loss: 3.6106 - val_accuracy100: 0.3610 - 32s/epoch - 21ms/step
Epoch 14/50
1532/1532 - 33s - loss: 3.1655 - accuracy100: 0.4300 - val_loss: 3.6393 - val_accuracy100: 0.3612 - 33s/epoch - 22ms/step
testing model: results/WBA/W8/deepVOL_L2/h100
Evaluating performance on  test set...
3755/3755 - 39s - 39s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1228421
{'0': {'precision': 0.425777956233688, 'recall': 0.10059671191811101, 'f1-score': 0.16274287117468308, 'support': 316233}, '1': {'precision': 0.36461991452664877, 'recall': 0.9100861221894688, 'f1-score': 0.5206463522201308, 'support': 346020}, '2': {'precision': 0.4183086847764076, 'recall': 0.03188919741728279, 'f1-score': 0.05926073292570337, 'support': 298910}, 'accuracy': 0.3706468101664338, 'macro avg': {'precision': 0.4029021851789148, 'recall': 0.3475240105082875, 'f1-score': 0.2475499854401724, 'support': 961163}, 'weighted avg': {'precision': 0.40143812467258405, 'recall': 0.3706468101664338, 'f1-score': 0.25940692978632673, 'support': 961163}}
[[ 31812 278137   6284]
 [ 24141 314908   6971]
 [ 18762 270616   9532]]
Evaluating performance on  train set...
1532/1532 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1465889
{'0': {'precision': 0.41314285714285715, 'recall': 0.10534509202453987, 'f1-score': 0.16788267644362967, 'support': 130400}, '1': {'precision': 0.33546508471282793, 'recall': 0.8977898439889874, 'f1-score': 0.4884264219160528, 'support': 130760}, '2': {'precision': 0.42620213713268035, 'recall': 0.02922432281847948, 'f1-score': 0.05469804649833934, 'support': 131021}, 'accuracy': 0.34412936883734807, 'macro avg': {'precision': 0.3916033596627884, 'recall': 0.34411975294400227, 'f1-score': 0.2370023816193406, 'support': 392181}, 'weighted avg': {'precision': 0.3916066134201781, 'recall': 0.34412936883734807, 'f1-score': 0.2369445044207937, 'support': 392181}}
[[ 13737 114023   2640]
 [ 10850 117395   2515]
 [  8663 118529   3829]]
Evaluating performance on  val set...
467/467 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1337912
{'0': {'precision': 0.4158882913482404, 'recall': 0.11456492358873063, 'f1-score': 0.17964340295466122, 'support': 38476}, '1': {'precision': 0.3537525775137232, 'recall': 0.9005728804621396, 'f1-score': 0.5079702013168746, 'support': 41719}, '2': {'precision': 0.41443538998835855, 'recall': 0.027253240787996326, 'f1-score': 0.05114330180773374, 'support': 39188}, 'accuracy': 0.3605789769062597, 'macro avg': {'precision': 0.3946920862834407, 'recall': 0.34746368161295554, 'f1-score': 0.2462523020264232, 'support': 119383}, 'weighted avg': {'precision': 0.39369772699692346, 'recall': 0.3605789769062597, 'f1-score': 0.2521981531044094, 'support': 119383}}
[[ 4408 33283   785]
 [ 3424 37571   724]
 [ 2767 35353  1068]]
training model: results/WBA/W8/deepVOL_L2/h200
Epoch 1/50
1532/1532 - 37s - loss: 3.2675 - accuracy200: 0.3832 - val_loss: 3.2938 - val_accuracy200: 0.3403 - 37s/epoch - 24ms/step
Epoch 2/50
1532/1532 - 36s - loss: 3.2528 - accuracy200: 0.3866 - val_loss: 3.2856 - val_accuracy200: 0.3643 - 36s/epoch - 23ms/step
Epoch 3/50
1532/1532 - 34s - loss: 3.2389 - accuracy200: 0.3922 - val_loss: 3.3221 - val_accuracy200: 0.3635 - 34s/epoch - 22ms/step
Epoch 4/50
1532/1532 - 35s - loss: 3.2331 - accuracy200: 0.3951 - val_loss: 3.3282 - val_accuracy200: 0.3644 - 35s/epoch - 23ms/step
Epoch 5/50
1532/1532 - 32s - loss: 3.2290 - accuracy200: 0.3987 - val_loss: 3.3315 - val_accuracy200: 0.3641 - 32s/epoch - 21ms/step
Epoch 6/50
1532/1532 - 35s - loss: 3.2265 - accuracy200: 0.4002 - val_loss: 3.3262 - val_accuracy200: 0.3658 - 35s/epoch - 23ms/step
Epoch 7/50
1532/1532 - 32s - loss: 3.2221 - accuracy200: 0.4041 - val_loss: 3.3442 - val_accuracy200: 0.3614 - 32s/epoch - 21ms/step
Epoch 8/50
1532/1532 - 33s - loss: 3.2202 - accuracy200: 0.4046 - val_loss: 3.3939 - val_accuracy200: 0.3589 - 33s/epoch - 22ms/step
Epoch 9/50
1532/1532 - 34s - loss: 3.2227 - accuracy200: 0.4023 - val_loss: 3.4307 - val_accuracy200: 0.3617 - 34s/epoch - 22ms/step
Epoch 10/50
1532/1532 - 33s - loss: 3.2191 - accuracy200: 0.4039 - val_loss: 3.4166 - val_accuracy200: 0.3618 - 33s/epoch - 21ms/step
Epoch 11/50
1532/1532 - 36s - loss: 3.2231 - accuracy200: 0.4021 - val_loss: 3.4254 - val_accuracy200: 0.3600 - 36s/epoch - 24ms/step
Epoch 12/50
1532/1532 - 36s - loss: 3.2234 - accuracy200: 0.4028 - val_loss: 3.5016 - val_accuracy200: 0.3618 - 36s/epoch - 24ms/step
testing model: results/WBA/W8/deepVOL_L2/h200
Evaluating performance on  test set...
3755/3755 - 39s - 39s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0851628
{'0': {'precision': 0.33021356011756425, 'recall': 0.20326058917608214, 'f1-score': 0.25163132223856804, 'support': 290745}, '1': {'precision': 0.4168467252769838, 'recall': 0.787094056372549, 'f1-score': 0.545039398755717, 'support': 391680}, '2': {'precision': 0.3320976937334303, 'recall': 0.0507824552088341, 'f1-score': 0.08809407488774307, 'support': 278738}, 'accuracy': 0.3969576440208373, 'macro avg': {'precision': 0.3597193263759928, 'recall': 0.34704570025248843, 'f1-score': 0.29492159862734274, 'support': 961163}, 'weighted avg': {'precision': 0.36606352288710564, 'recall': 0.3969576440208373, 'f1-score': 0.3237710427211112, 'support': 961163}}
[[ 59097 218958  12690]
 [ 67613 308289  15778]
 [ 52256 212327  14155]]
Evaluating performance on  train set...
1532/1532 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1012319
{'0': {'precision': 0.3614962007659647, 'recall': 0.22720386363461584, 'f1-score': 0.2790328673970533, 'support': 130033}, '1': {'precision': 0.33889263156454863, 'recall': 0.7610431897769859, 'f1-score': 0.4689581415818227, 'support': 130216}, '2': {'precision': 0.36930841328822583, 'recall': 0.050472970924415606, 'f1-score': 0.08880857278128605, 'support': 131932}, 'accuracy': 0.34500141516289673, 'macro avg': {'precision': 0.35656574853957973, 'recall': 0.3462400081120058, 'f1-score': 0.278933193920054, 'support': 392181}, 'weighted avg': {'precision': 0.3566192038062837, 'recall': 0.34500141516289673, 'f1-score': 0.27810125129631547, 'support': 392181}}
[[29544 94451  6038]
 [25782 99100  5334]
 [26401 98872  6659]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0946174
{'0': {'precision': 0.33740407319952775, 'recall': 0.24536502911110514, 'f1-score': 0.2841165048543689, 'support': 37271}, '1': {'precision': 0.37139778218097125, 'recall': 0.7330527856554753, 'f1-score': 0.4930128821380504, 'support': 43724}, '2': {'precision': 0.3511207761793242, 'recall': 0.054678545378764196, 'f1-score': 0.09462200784384438, 'support': 38388}, 'accuracy': 0.3626647010043306, 'macro avg': {'precision': 0.3533075438532744, 'recall': 0.34436545338178154, 'f1-score': 0.2905837982787545, 'support': 119383}, 'weighted avg': {'precision': 0.3542649137337166, 'recall': 0.3626647010043306, 'f1-score': 0.29969217684377836, 'support': 119383}}
[[ 9145 26340  1786]
 [ 9579 32052  2093]
 [ 8380 27909  2099]]
training model: results/WBA/W8/deepVOL_L2/h300
Epoch 1/50
1532/1532 - 36s - loss: 3.2618 - accuracy300: 0.3945 - val_loss: 3.6704 - val_accuracy300: 0.3614 - 36s/epoch - 23ms/step
Epoch 2/50
1532/1532 - 33s - loss: 3.2499 - accuracy300: 0.3924 - val_loss: 3.9055 - val_accuracy300: 0.3620 - 33s/epoch - 22ms/step
Epoch 3/50
1532/1532 - 36s - loss: 3.2416 - accuracy300: 0.3908 - val_loss: 3.4900 - val_accuracy300: 0.3614 - 36s/epoch - 24ms/step
Epoch 4/50
1532/1532 - 35s - loss: 3.2407 - accuracy300: 0.3896 - val_loss: 3.7706 - val_accuracy300: 0.3615 - 35s/epoch - 23ms/step
Epoch 5/50
1532/1532 - 33s - loss: 3.2338 - accuracy300: 0.3923 - val_loss: 3.7755 - val_accuracy300: 0.3615 - 33s/epoch - 22ms/step
Epoch 6/50
1532/1532 - 35s - loss: 3.2323 - accuracy300: 0.3959 - val_loss: 3.5377 - val_accuracy300: 0.3615 - 35s/epoch - 23ms/step
Epoch 7/50
1532/1532 - 31s - loss: 3.2394 - accuracy300: 0.3926 - val_loss: 3.6028 - val_accuracy300: 0.3615 - 31s/epoch - 20ms/step
Epoch 8/50
1532/1532 - 33s - loss: 3.2356 - accuracy300: 0.3924 - val_loss: 3.6475 - val_accuracy300: 0.3615 - 33s/epoch - 21ms/step
Epoch 9/50
1532/1532 - 32s - loss: 3.2371 - accuracy300: 0.3934 - val_loss: 3.4650 - val_accuracy300: 0.3613 - 32s/epoch - 21ms/step
Epoch 10/50
1532/1532 - 35s - loss: 3.2384 - accuracy300: 0.3893 - val_loss: 3.5993 - val_accuracy300: 0.3615 - 35s/epoch - 23ms/step
Epoch 11/50
1532/1532 - 32s - loss: 3.2345 - accuracy300: 0.3924 - val_loss: 3.6815 - val_accuracy300: 0.3617 - 32s/epoch - 21ms/step
Epoch 12/50
1532/1532 - 35s - loss: 3.2345 - accuracy300: 0.3919 - val_loss: 3.6431 - val_accuracy300: 0.3616 - 35s/epoch - 23ms/step
Epoch 13/50
1532/1532 - 32s - loss: 3.2230 - accuracy300: 0.3980 - val_loss: 3.4869 - val_accuracy300: 0.3619 - 32s/epoch - 21ms/step
Epoch 14/50
1532/1532 - 35s - loss: 3.2192 - accuracy300: 0.3979 - val_loss: 3.5627 - val_accuracy300: 0.3622 - 35s/epoch - 23ms/step
Epoch 15/50
1532/1532 - 34s - loss: 3.2139 - accuracy300: 0.4018 - val_loss: 3.5198 - val_accuracy300: 0.3628 - 34s/epoch - 22ms/step
Epoch 16/50
1532/1532 - 33s - loss: 3.2081 - accuracy300: 0.4046 - val_loss: 3.6095 - val_accuracy300: 0.3621 - 33s/epoch - 21ms/step
Epoch 17/50
1532/1532 - 35s - loss: 3.2042 - accuracy300: 0.4093 - val_loss: 3.5697 - val_accuracy300: 0.3647 - 35s/epoch - 23ms/step
Epoch 18/50
1532/1532 - 32s - loss: 3.1989 - accuracy300: 0.4131 - val_loss: 3.6190 - val_accuracy300: 0.3627 - 32s/epoch - 21ms/step
Epoch 19/50
1532/1532 - 34s - loss: 3.1982 - accuracy300: 0.4157 - val_loss: 3.6914 - val_accuracy300: 0.3627 - 34s/epoch - 22ms/step
testing model: results/WBA/W8/deepVOL_L2/h300
Evaluating performance on  test set...
3755/3755 - 38s - 38s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1021568
{'0': {'precision': 0.3313883078278102, 'recall': 0.010739567277501855, 'f1-score': 0.020804893642757165, 'support': 280272}, '1': {'precision': 0.4265503523205175, 'recall': 0.9912101400020539, 'f1-score': 0.5964350632297759, 'support': 408994}, '2': {'precision': 0.34013197360527897, 'recall': 0.0020853484959378, 'f1-score': 0.0041452822739834186, 'support': 271897}, 'accuracy': 0.42550118970455586, 'macro avg': {'precision': 0.3660235445845356, 'recall': 0.33467835192516454, 'f1-score': 0.2071284130488388, 'support': 961163}, 'weighted avg': {'precision': 0.3743550904850148, 'recall': 0.42550118970455586, 'f1-score': 0.2610342691261431, 'support': 961163}}
[[  3010 276710    552]
 [  3047 405399    548]
 [  3026 268304    567]]
Evaluating performance on  train set...
1532/1532 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1857461
{'0': {'precision': 0.35051305970149255, 'recall': 0.011582833054615794, 'f1-score': 0.02242463576751785, 'support': 129761}, '1': {'precision': 0.3312944262701427, 'recall': 0.9892143182045965, 'f1-score': 0.4963559558072603, 'support': 129709}, '2': {'precision': 0.335016835016835, 'recall': 0.0014994989111678761, 'f1-score': 0.002985634447320056, 'support': 132711}, 'accuracy': 0.331510195547464, 'macro avg': {'precision': 0.3389414403294901, 'recall': 0.33409888339012667, 'f1-score': 0.17392207534069937, 'support': 392181}, 'weighted avg': {'precision': 0.33891293323470156, 'recall': 0.331510195547464, 'f1-score': 0.17259353300330998, 'support': 392181}}
[[  1503 128042    216]
 [  1220 128310    179]
 [  1565 130947    199]]
Evaluating performance on  val set...
467/467 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.157327
{'0': {'precision': 0.34959893048128343, 'recall': 0.013940347042673988, 'f1-score': 0.026811575628636612, 'support': 37517}, '1': {'precision': 0.3619986403806934, 'recall': 0.9870936348680399, 'f1-score': 0.5297288559224557, 'support': 43157}, '2': {'precision': 0.2753623188405797, 'recall': 0.001472525769200961, 'f1-score': 0.002929386370644465, 'support': 38709}, 'accuracy': 0.36169303837229755, 'macro avg': {'precision': 0.3289866299008522, 'recall': 0.334168835893305, 'f1-score': 0.18648993930724556, 'support': 119383}, 'weighted avg': {'precision': 0.3300107921377072, 'recall': 0.36169303837229755, 'f1-score': 0.2008727518568494, 'support': 119383}}
[[  523 36922    72]
 [  479 42600    78]
 [  494 38158    57]]
training model: results/WBA/W8/deepVOL_L2/h500
Epoch 1/50
1532/1532 - 37s - loss: 3.2515 - accuracy500: 0.3982 - val_loss: 3.4280 - val_accuracy500: 0.3247 - 37s/epoch - 24ms/step
Epoch 2/50
1532/1532 - 37s - loss: 3.2141 - accuracy500: 0.4114 - val_loss: 3.4284 - val_accuracy500: 0.3267 - 37s/epoch - 24ms/step
Epoch 3/50
1532/1532 - 37s - loss: 3.2083 - accuracy500: 0.4137 - val_loss: 3.3851 - val_accuracy500: 0.3294 - 37s/epoch - 24ms/step
Epoch 4/50
1532/1532 - 37s - loss: 3.2036 - accuracy500: 0.4138 - val_loss: 3.3842 - val_accuracy500: 0.3352 - 37s/epoch - 24ms/step
Epoch 5/50
1532/1532 - 37s - loss: 3.1948 - accuracy500: 0.4171 - val_loss: 3.3713 - val_accuracy500: 0.3429 - 37s/epoch - 24ms/step
Epoch 6/50
1532/1532 - 37s - loss: 3.1870 - accuracy500: 0.4215 - val_loss: 3.3794 - val_accuracy500: 0.3441 - 37s/epoch - 24ms/step
Epoch 7/50
1532/1532 - 35s - loss: 3.1817 - accuracy500: 0.4233 - val_loss: 3.3803 - val_accuracy500: 0.3411 - 35s/epoch - 23ms/step
Epoch 8/50
1532/1532 - 33s - loss: 3.1778 - accuracy500: 0.4251 - val_loss: 3.3692 - val_accuracy500: 0.3447 - 33s/epoch - 22ms/step
Epoch 9/50
1532/1532 - 36s - loss: 3.1736 - accuracy500: 0.4268 - val_loss: 3.3771 - val_accuracy500: 0.3413 - 36s/epoch - 24ms/step
Epoch 10/50
1532/1532 - 33s - loss: 3.1683 - accuracy500: 0.4293 - val_loss: 3.3749 - val_accuracy500: 0.3481 - 33s/epoch - 22ms/step
Epoch 11/50
1532/1532 - 35s - loss: 3.1648 - accuracy500: 0.4318 - val_loss: 3.3867 - val_accuracy500: 0.3490 - 35s/epoch - 23ms/step
Epoch 12/50
1532/1532 - 35s - loss: 3.1604 - accuracy500: 0.4342 - val_loss: 3.4036 - val_accuracy500: 0.3471 - 35s/epoch - 23ms/step
Epoch 13/50
1532/1532 - 36s - loss: 3.1586 - accuracy500: 0.4345 - val_loss: 3.4138 - val_accuracy500: 0.3491 - 36s/epoch - 24ms/step
Epoch 14/50
1532/1532 - 32s - loss: 3.1554 - accuracy500: 0.4365 - val_loss: 3.4187 - val_accuracy500: 0.3439 - 32s/epoch - 21ms/step
Epoch 15/50
1532/1532 - 35s - loss: 3.1512 - accuracy500: 0.4380 - val_loss: 3.4350 - val_accuracy500: 0.3416 - 35s/epoch - 23ms/step
Epoch 16/50
1532/1532 - 35s - loss: 3.1478 - accuracy500: 0.4402 - val_loss: 3.4291 - val_accuracy500: 0.3465 - 35s/epoch - 23ms/step
Epoch 17/50
1532/1532 - 34s - loss: 3.1436 - accuracy500: 0.4414 - val_loss: 3.4367 - val_accuracy500: 0.3378 - 34s/epoch - 22ms/step
Epoch 18/50
1532/1532 - 36s - loss: 3.1398 - accuracy500: 0.4427 - val_loss: 3.4384 - val_accuracy500: 0.3421 - 36s/epoch - 23ms/step
testing model: results/WBA/W8/deepVOL_L2/h500
Evaluating performance on  test set...
3755/3755 - 39s - 39s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1122373
{'0': {'precision': 0.3314370350422459, 'recall': 0.15888076681028224, 'f1-score': 0.21479526167673815, 'support': 309855}, '1': {'precision': 0.38478167115178696, 'recall': 0.8105909656968188, 'f1-score': 0.5218465552693842, 'support': 353320}, '2': {'precision': 0.3368367122886628, 'recall': 0.07722123038511618, 'f1-score': 0.12563915665446365, 'support': 297988}, 'accuracy': 0.37313025990388726, 'macro avg': {'precision': 0.3510184728275652, 'recall': 0.34889765429740566, 'f1-score': 0.2874269912001953, 'support': 961163}, 'weighted avg': {'precision': 0.35272038225133356, 'recall': 0.37313025990388726, 'f1-score': 0.3000252524574654, 'support': 961163}}
[[ 49230 234961  25664]
 [ 47282 286398  19640]
 [ 52023 222954  23011]]
Evaluating performance on  train set...
1532/1532 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1122323
{'0': {'precision': 0.3592842673869007, 'recall': 0.16358088738250598, 'f1-score': 0.22480763441825583, 'support': 130113}, '1': {'precision': 0.3591866613600182, 'recall': 0.7800432165457633, 'f1-score': 0.49187810836326123, 'support': 129580}, '2': {'precision': 0.3866454504880368, 'recall': 0.15039097880562768, 'f1-score': 0.21655137185429926, 'support': 132488}, 'accuracy': 0.362809519074101, 'macro avg': {'precision': 0.3683721264116519, 'recall': 0.36467169424463225, 'f1-score': 0.3110790382119388, 'support': 392181}, 'weighted avg': {'precision': 0.3684952710758604, 'recall': 0.362809519074101, 'f1-score': 0.31026087233447386, 'support': 392181}}
[[ 21284  89257  19572]
 [ 16466 101078  12036]
 [ 21490  91073  19925]]
Evaluating performance on  val set...
467/467 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1249448
{'0': {'precision': 0.3589479366014034, 'recall': 0.18592888188496048, 'f1-score': 0.24496835337061715, 'support': 39343}, '1': {'precision': 0.33968761385405527, 'recall': 0.7531333871850328, 'f1-score': 0.4682012570465885, 'support': 38377}, '2': {'precision': 0.36617087015879857, 'recall': 0.12231476369920553, 'f1-score': 0.18337531486146094, 'support': 41663}, 'accuracy': 0.3460626722397661, 'macro avg': {'precision': 0.3549354735380857, 'recall': 0.35379234425639955, 'f1-score': 0.2988483084262222, 'support': 119383}, 'weighted avg': {'precision': 0.3552771934866113, 'recall': 0.3460626722397661, 'f1-score': 0.29523395551636467, 'support': 119383}}
[[ 7315 27027  5001]
 [ 5654 28903  3820]
 [ 7410 29157  5096]]
training model: results/WBA/W8/deepVOL_L2/h1000
Epoch 1/50
1532/1532 - 35s - loss: 3.2915 - accuracy1000: 0.3718 - val_loss: 3.3197 - val_accuracy1000: 0.3340 - 35s/epoch - 23ms/step
Epoch 2/50
1532/1532 - 34s - loss: 3.2786 - accuracy1000: 0.3661 - val_loss: 3.2990 - val_accuracy1000: 0.3456 - 34s/epoch - 22ms/step
Epoch 3/50
1532/1532 - 33s - loss: 3.2490 - accuracy1000: 0.3893 - val_loss: 3.3025 - val_accuracy1000: 0.3424 - 33s/epoch - 22ms/step
Epoch 4/50
1532/1532 - 36s - loss: 3.2460 - accuracy1000: 0.3914 - val_loss: 3.2991 - val_accuracy1000: 0.3532 - 36s/epoch - 23ms/step
Epoch 5/50
1532/1532 - 35s - loss: 3.2401 - accuracy1000: 0.3956 - val_loss: 3.3006 - val_accuracy1000: 0.3520 - 35s/epoch - 23ms/step
Epoch 6/50
1532/1532 - 36s - loss: 3.2358 - accuracy1000: 0.3975 - val_loss: 3.3104 - val_accuracy1000: 0.3483 - 36s/epoch - 24ms/step
Epoch 7/50
1532/1532 - 34s - loss: 3.2331 - accuracy1000: 0.4014 - val_loss: 3.3177 - val_accuracy1000: 0.3471 - 34s/epoch - 22ms/step
Epoch 8/50
1532/1532 - 34s - loss: 3.2281 - accuracy1000: 0.4053 - val_loss: 3.3097 - val_accuracy1000: 0.3493 - 34s/epoch - 22ms/step
Epoch 9/50
1532/1532 - 36s - loss: 3.2243 - accuracy1000: 0.4070 - val_loss: 3.3192 - val_accuracy1000: 0.3470 - 36s/epoch - 23ms/step
Epoch 10/50
1532/1532 - 33s - loss: 3.2189 - accuracy1000: 0.4089 - val_loss: 3.3235 - val_accuracy1000: 0.3412 - 33s/epoch - 21ms/step
Epoch 11/50
1532/1532 - 32s - loss: 3.2169 - accuracy1000: 0.4104 - val_loss: 3.3249 - val_accuracy1000: 0.3466 - 32s/epoch - 21ms/step
Epoch 12/50
1532/1532 - 33s - loss: 3.2142 - accuracy1000: 0.4135 - val_loss: 3.3111 - val_accuracy1000: 0.3494 - 33s/epoch - 21ms/step
testing model: results/WBA/W8/deepVOL_L2/h1000
Evaluating performance on  test set...
3755/3755 - 34s - 34s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0971433
{'0': {'precision': 0.35552268244575935, 'recall': 0.07604801007603561, 'f1-score': 0.1252948497448256, 'support': 322349}, '1': {'precision': 0.3612907825980667, 'recall': 0.9274315149085267, 'f1-score': 0.5200072327074761, 'support': 344199}, '2': {'precision': 0.314652183961174, 'recall': 0.00924257081275563, 'f1-score': 0.01795765475534921, 'support': 294615}, 'accuracy': 0.36045707127719234, 'macro avg': {'precision': 0.34382188300166666, 'recall': 0.33757403193243934, 'f1-score': 0.22108657906921694, 'support': 961163}, 'weighted avg': {'precision': 0.34506068213289665, 'recall': 0.36045707127719234, 'f1-score': 0.23374311481696916, 'support': 961163}}
[[ 24514 294907   2928]
 [ 21975 319221   3003]
 [ 22463 269429   2723]]
Evaluating performance on  train set...
1532/1532 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1012759
{'0': {'precision': 0.36937291729778854, 'recall': 0.09341648598331329, 'f1-score': 0.14911974953067578, 'support': 130523}, '1': {'precision': 0.33324422658626424, 'recall': 0.9203652613172721, 'f1-score': 0.489317307573122, 'support': 128675}, '2': {'precision': 0.36260548523206754, 'recall': 0.010339667476293963, 'f1-score': 0.020106013525863647, 'support': 132983}, 'accuracy': 0.3365690841728692, 'macro avg': {'precision': 0.3550742097053734, 'recall': 0.34137380492562647, 'f1-score': 0.21951435687655377, 'support': 392181}, 'weighted avg': {'precision': 0.3552243157701746, 'recall': 0.3365690841728692, 'f1-score': 0.21699220415235262, 'support': 392181}}
[[ 12193 117009   1321]
 [  9151 118428   1096]
 [ 11666 119942   1375]]
Evaluating performance on  val set...
467/467 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1008047
{'0': {'precision': 0.3436571531466643, 'recall': 0.100094403943987, 'f1-score': 0.15503340712008287, 'support': 38134}, '1': {'precision': 0.34483823281749965, 'recall': 0.9104315391645876, 'f1-score': 0.5002137549621687, 'support': 40483}, '2': {'precision': 0.3500717360114778, 'recall': 0.011970759947014669, 'f1-score': 0.02314990512333966, 'support': 40766}, 'accuracy': 0.34478945913572284, 'macro avg': {'precision': 0.3461890406585472, 'recall': 0.3408322343518631, 'f1-score': 0.22613235573519708, 'support': 119383}, 'weighted avg': {'precision': 0.34624806251718954, 'recall': 0.34478945913572284, 'f1-score': 0.22705013629669868, 'support': 119383}}
[[ 3817 33851   466]
 [ 3186 36857   440]
 [ 4104 36174   488]]
training model: results/WBA/W8/deepVOL_L3/h10
Epoch 1/50
1532/1532 - 54s - loss: 3.2364 - accuracy10: 0.4216 - val_loss: 3.4072 - val_accuracy10: 0.4794 - 54s/epoch - 35ms/step
Epoch 2/50
1532/1532 - 50s - loss: 3.1733 - accuracy10: 0.4283 - val_loss: 3.5616 - val_accuracy10: 0.4873 - 50s/epoch - 33ms/step
Epoch 3/50
1532/1532 - 53s - loss: 3.0415 - accuracy10: 0.4513 - val_loss: 3.1381 - val_accuracy10: 0.4906 - 53s/epoch - 35ms/step
Epoch 4/50
1532/1532 - 52s - loss: 2.9235 - accuracy10: 0.4933 - val_loss: 3.0230 - val_accuracy10: 0.5018 - 52s/epoch - 34ms/step
Epoch 5/50
1532/1532 - 51s - loss: 2.8615 - accuracy10: 0.5185 - val_loss: 3.0153 - val_accuracy10: 0.5026 - 51s/epoch - 33ms/step
Epoch 6/50
1532/1532 - 51s - loss: 2.8106 - accuracy10: 0.5346 - val_loss: 3.0307 - val_accuracy10: 0.4991 - 51s/epoch - 33ms/step
Epoch 7/50
1532/1532 - 51s - loss: 2.7774 - accuracy10: 0.5440 - val_loss: 3.0064 - val_accuracy10: 0.5111 - 51s/epoch - 33ms/step
Epoch 8/50
1532/1532 - 51s - loss: 2.7539 - accuracy10: 0.5500 - val_loss: 2.9997 - val_accuracy10: 0.5185 - 51s/epoch - 34ms/step
Epoch 9/50
1532/1532 - 51s - loss: 2.7378 - accuracy10: 0.5533 - val_loss: 3.0236 - val_accuracy10: 0.5170 - 51s/epoch - 33ms/step
Epoch 10/50
1532/1532 - 51s - loss: 2.7228 - accuracy10: 0.5565 - val_loss: 3.0171 - val_accuracy10: 0.5218 - 51s/epoch - 33ms/step
Epoch 11/50
1532/1532 - 52s - loss: 2.7116 - accuracy10: 0.5587 - val_loss: 2.9922 - val_accuracy10: 0.5327 - 52s/epoch - 34ms/step
Epoch 12/50
1532/1532 - 52s - loss: 2.7043 - accuracy10: 0.5606 - val_loss: 2.9787 - val_accuracy10: 0.5314 - 52s/epoch - 34ms/step
Epoch 13/50
1532/1532 - 53s - loss: 2.6946 - accuracy10: 0.5627 - val_loss: 2.9609 - val_accuracy10: 0.5355 - 53s/epoch - 34ms/step
Epoch 14/50
1532/1532 - 53s - loss: 2.6877 - accuracy10: 0.5639 - val_loss: 2.9470 - val_accuracy10: 0.5330 - 53s/epoch - 35ms/step
Epoch 15/50
1532/1532 - 53s - loss: 2.6811 - accuracy10: 0.5655 - val_loss: 2.9434 - val_accuracy10: 0.5355 - 53s/epoch - 34ms/step
Epoch 16/50
1532/1532 - 52s - loss: 2.6766 - accuracy10: 0.5673 - val_loss: 2.9335 - val_accuracy10: 0.5389 - 52s/epoch - 34ms/step
Epoch 17/50
1532/1532 - 51s - loss: 2.6711 - accuracy10: 0.5680 - val_loss: 2.9371 - val_accuracy10: 0.5400 - 51s/epoch - 33ms/step
Epoch 18/50
1532/1532 - 51s - loss: 2.6646 - accuracy10: 0.5689 - val_loss: 2.9357 - val_accuracy10: 0.5375 - 51s/epoch - 33ms/step
Epoch 19/50
1532/1532 - 51s - loss: 2.6615 - accuracy10: 0.5694 - val_loss: 2.9355 - val_accuracy10: 0.5395 - 51s/epoch - 33ms/step
Epoch 20/50
1532/1532 - 52s - loss: 2.6559 - accuracy10: 0.5715 - val_loss: 2.9218 - val_accuracy10: 0.5375 - 52s/epoch - 34ms/step
Epoch 21/50
1532/1532 - 51s - loss: 2.6528 - accuracy10: 0.5717 - val_loss: 2.9307 - val_accuracy10: 0.5375 - 51s/epoch - 33ms/step
Epoch 22/50
1532/1532 - 52s - loss: 2.6475 - accuracy10: 0.5725 - val_loss: 2.9179 - val_accuracy10: 0.5393 - 52s/epoch - 34ms/step
Epoch 23/50
1532/1532 - 52s - loss: 2.6442 - accuracy10: 0.5734 - val_loss: 2.9188 - val_accuracy10: 0.5413 - 52s/epoch - 34ms/step
Epoch 24/50
1532/1532 - 53s - loss: 2.6406 - accuracy10: 0.5744 - val_loss: 2.9165 - val_accuracy10: 0.5426 - 53s/epoch - 34ms/step
Epoch 25/50
1532/1532 - 51s - loss: 2.6368 - accuracy10: 0.5747 - val_loss: 2.8988 - val_accuracy10: 0.5426 - 51s/epoch - 33ms/step
Epoch 26/50
1532/1532 - 50s - loss: 2.6347 - accuracy10: 0.5752 - val_loss: 2.8961 - val_accuracy10: 0.5442 - 50s/epoch - 33ms/step
Epoch 27/50
1532/1532 - 53s - loss: 2.6289 - accuracy10: 0.5763 - val_loss: 2.9063 - val_accuracy10: 0.5427 - 53s/epoch - 35ms/step
Epoch 28/50
1532/1532 - 56s - loss: 2.6269 - accuracy10: 0.5764 - val_loss: 2.9092 - val_accuracy10: 0.5393 - 56s/epoch - 36ms/step
Epoch 29/50
1532/1532 - 51s - loss: 2.6232 - accuracy10: 0.5776 - val_loss: 2.9220 - val_accuracy10: 0.5457 - 51s/epoch - 33ms/step
Epoch 30/50
1532/1532 - 50s - loss: 2.6203 - accuracy10: 0.5777 - val_loss: 2.8932 - val_accuracy10: 0.5436 - 50s/epoch - 33ms/step
Epoch 31/50
1532/1532 - 50s - loss: 2.6158 - accuracy10: 0.5788 - val_loss: 2.8868 - val_accuracy10: 0.5424 - 50s/epoch - 32ms/step
Epoch 32/50
1532/1532 - 50s - loss: 2.6124 - accuracy10: 0.5797 - val_loss: 2.8911 - val_accuracy10: 0.5434 - 50s/epoch - 32ms/step
Epoch 33/50
1532/1532 - 50s - loss: 2.6091 - accuracy10: 0.5800 - val_loss: 2.8912 - val_accuracy10: 0.5447 - 50s/epoch - 33ms/step
Epoch 34/50
1532/1532 - 50s - loss: 2.6063 - accuracy10: 0.5811 - val_loss: 2.8907 - val_accuracy10: 0.5437 - 50s/epoch - 33ms/step
Epoch 35/50
1532/1532 - 49s - loss: 2.6051 - accuracy10: 0.5813 - val_loss: 2.9035 - val_accuracy10: 0.5422 - 49s/epoch - 32ms/step
Epoch 36/50
1532/1532 - 50s - loss: 2.6003 - accuracy10: 0.5819 - val_loss: 2.9062 - val_accuracy10: 0.5418 - 50s/epoch - 32ms/step
Epoch 37/50
1532/1532 - 49s - loss: 2.5974 - accuracy10: 0.5823 - val_loss: 2.9068 - val_accuracy10: 0.5453 - 49s/epoch - 32ms/step
Epoch 38/50
1532/1532 - 49s - loss: 2.5948 - accuracy10: 0.5829 - val_loss: 2.8861 - val_accuracy10: 0.5449 - 49s/epoch - 32ms/step
Epoch 39/50
1532/1532 - 49s - loss: 2.5914 - accuracy10: 0.5837 - val_loss: 2.8970 - val_accuracy10: 0.5447 - 49s/epoch - 32ms/step
Epoch 40/50
1532/1532 - 50s - loss: 2.5904 - accuracy10: 0.5841 - val_loss: 2.8855 - val_accuracy10: 0.5461 - 50s/epoch - 32ms/step
Epoch 41/50
1532/1532 - 49s - loss: 2.5868 - accuracy10: 0.5853 - val_loss: 2.8830 - val_accuracy10: 0.5448 - 49s/epoch - 32ms/step
Epoch 42/50
1532/1532 - 49s - loss: 2.5841 - accuracy10: 0.5860 - val_loss: 2.8935 - val_accuracy10: 0.5449 - 49s/epoch - 32ms/step
Epoch 43/50
1532/1532 - 49s - loss: 2.5798 - accuracy10: 0.5860 - val_loss: 2.8897 - val_accuracy10: 0.5428 - 49s/epoch - 32ms/step
Epoch 44/50
1532/1532 - 49s - loss: 2.5775 - accuracy10: 0.5869 - val_loss: 2.9035 - val_accuracy10: 0.5425 - 49s/epoch - 32ms/step
Epoch 45/50
1532/1532 - 50s - loss: 2.5740 - accuracy10: 0.5875 - val_loss: 2.8902 - val_accuracy10: 0.5415 - 50s/epoch - 33ms/step
Epoch 46/50
1532/1532 - 49s - loss: 2.5733 - accuracy10: 0.5878 - val_loss: 2.8844 - val_accuracy10: 0.5455 - 49s/epoch - 32ms/step
Epoch 47/50
1532/1532 - 49s - loss: 2.5676 - accuracy10: 0.5889 - val_loss: 2.8886 - val_accuracy10: 0.5425 - 49s/epoch - 32ms/step
Epoch 48/50
1532/1532 - 50s - loss: 2.5661 - accuracy10: 0.5891 - val_loss: 2.8875 - val_accuracy10: 0.5431 - 50s/epoch - 33ms/step
Epoch 49/50
1532/1532 - 49s - loss: 2.5648 - accuracy10: 0.5892 - val_loss: 2.8959 - val_accuracy10: 0.5435 - 49s/epoch - 32ms/step
Epoch 50/50
1532/1532 - 51s - loss: 2.5620 - accuracy10: 0.5907 - val_loss: 2.8764 - val_accuracy10: 0.5456 - 51s/epoch - 33ms/step
testing model: results/WBA/W8/deepVOL_L3/h10
Evaluating performance on  test set...
3755/3755 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8762552
{'0': {'precision': 0.4612136412322421, 'recall': 0.4565131082384046, 'f1-score': 0.4588513368327347, 'support': 229207}, '1': {'precision': 0.7081069652242202, 'recall': 0.6881245951811142, 'f1-score': 0.6979727899122803, 'support': 511031}, '2': {'precision': 0.4555246085105309, 'recall': 0.49007581758515334, 'f1-score': 0.4721689812846293, 'support': 220925}, 'accuracy': 0.5873707165173857, 'macro avg': {'precision': 0.5416150716556644, 'recall': 0.5449045070015573, 'f1-score': 0.5429977026765481, 'support': 961163}, 'weighted avg': {'precision': 0.5911742126430231, 'recall': 0.5873707165173857, 'f1-score': 0.5890484791376591, 'support': 961163}}
[[104636  74202  50369]
 [ 80335 351653  79043]
 [ 41900  70755 108270]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8833807
{'0': {'precision': 0.4875421786926297, 'recall': 0.4917978426668227, 'f1-score': 0.48966076431203664, 'support': 102534}, '1': {'precision': 0.6943390909859393, 'recall': 0.6560682868644699, 'f1-score': 0.6746613879602782, 'support': 187796}, '2': {'precision': 0.47365394808951816, 'recall': 0.5176286928945224, 'f1-score': 0.49466592856003533, 'support': 101851}, 'accuracy': 0.5771671753603566, 'macro avg': {'precision': 0.5518450725893623, 'recall': 0.555164940808605, 'f1-score': 0.5529960269441166, 'support': 392181}, 'weighted avg': {'precision': 0.5829601177714653, 'recall': 0.5771671753603566, 'f1-score': 0.5795482348995156, 'support': 392181}}
[[ 50426  26284  25824]
 [ 31827 123207  32762]
 [ 21176  27954  52721]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93500787
{'0': {'precision': 0.45737116969735103, 'recall': 0.4770467596390484, 'f1-score': 0.4670018149403318, 'support': 30475}, '1': {'precision': 0.6637552134961752, 'recall': 0.6078861273359484, 'f1-score': 0.634593376725556, 'support': 58381}, '2': {'precision': 0.4398183416349253, 'recall': 0.4917286336685557, 'f1-score': 0.4643271416861283, 'support': 30527}, 'accuracy': 0.5447844332945226, 'macro avg': {'precision': 0.5203149082761505, 'recall': 0.5255538402145175, 'f1-score': 0.5219741111173387, 'support': 119383}, 'weighted avg': {'precision': 0.5538092863367174, 'recall': 0.5447844332945226, 'f1-score': 0.5482739660686509, 'support': 119383}}
[[14538  8661  7276]
 [11049 35489 11843]
 [ 6199  9317 15011]]
training model: results/WBA/W8/deepVOL_L3/h20
Epoch 1/50
1532/1532 - 54s - loss: 3.2509 - accuracy20: 0.3925 - val_loss: 3.8186 - val_accuracy20: 0.3697 - 54s/epoch - 35ms/step
Epoch 2/50
1532/1532 - 50s - loss: 3.2525 - accuracy20: 0.3924 - val_loss: 3.2824 - val_accuracy20: 0.4170 - 50s/epoch - 32ms/step
Epoch 3/50
1532/1532 - 49s - loss: 3.1620 - accuracy20: 0.4349 - val_loss: 3.3465 - val_accuracy20: 0.4020 - 49s/epoch - 32ms/step
Epoch 4/50
1532/1532 - 49s - loss: 3.0473 - accuracy20: 0.4696 - val_loss: 3.1790 - val_accuracy20: 0.4396 - 49s/epoch - 32ms/step
Epoch 5/50
1532/1532 - 56s - loss: 2.9517 - accuracy20: 0.4988 - val_loss: 3.1052 - val_accuracy20: 0.4676 - 56s/epoch - 36ms/step
Epoch 6/50
1532/1532 - 50s - loss: 2.8908 - accuracy20: 0.5165 - val_loss: 3.1536 - val_accuracy20: 0.4772 - 50s/epoch - 32ms/step
Epoch 7/50
1532/1532 - 50s - loss: 2.8536 - accuracy20: 0.5247 - val_loss: 3.1451 - val_accuracy20: 0.4849 - 50s/epoch - 33ms/step
Epoch 8/50
1532/1532 - 49s - loss: 2.8309 - accuracy20: 0.5298 - val_loss: 3.1906 - val_accuracy20: 0.4843 - 49s/epoch - 32ms/step
Epoch 9/50
1532/1532 - 49s - loss: 2.8141 - accuracy20: 0.5336 - val_loss: 3.1902 - val_accuracy20: 0.4832 - 49s/epoch - 32ms/step
Epoch 10/50
1532/1532 - 54s - loss: 2.8028 - accuracy20: 0.5363 - val_loss: 3.1080 - val_accuracy20: 0.4895 - 54s/epoch - 35ms/step
Epoch 11/50
1532/1532 - 50s - loss: 2.7931 - accuracy20: 0.5393 - val_loss: 3.1302 - val_accuracy20: 0.4878 - 50s/epoch - 32ms/step
Epoch 12/50
1532/1532 - 50s - loss: 2.7869 - accuracy20: 0.5402 - val_loss: 3.0976 - val_accuracy20: 0.4974 - 50s/epoch - 33ms/step
Epoch 13/50
1532/1532 - 49s - loss: 2.7785 - accuracy20: 0.5423 - val_loss: 3.0886 - val_accuracy20: 0.4960 - 49s/epoch - 32ms/step
Epoch 14/50
1532/1532 - 54s - loss: 2.7721 - accuracy20: 0.5435 - val_loss: 3.0997 - val_accuracy20: 0.4973 - 54s/epoch - 35ms/step
Epoch 15/50
1532/1532 - 51s - loss: 2.7652 - accuracy20: 0.5454 - val_loss: 3.0972 - val_accuracy20: 0.4981 - 51s/epoch - 33ms/step
Epoch 16/50
1532/1532 - 50s - loss: 2.7585 - accuracy20: 0.5468 - val_loss: 3.1295 - val_accuracy20: 0.4927 - 50s/epoch - 33ms/step
Epoch 17/50
1532/1532 - 50s - loss: 2.7531 - accuracy20: 0.5474 - val_loss: 3.1200 - val_accuracy20: 0.4977 - 50s/epoch - 33ms/step
Epoch 18/50
1532/1532 - 51s - loss: 2.7497 - accuracy20: 0.5487 - val_loss: 3.0976 - val_accuracy20: 0.4930 - 51s/epoch - 33ms/step
Epoch 19/50
1532/1532 - 52s - loss: 2.7447 - accuracy20: 0.5499 - val_loss: 3.1428 - val_accuracy20: 0.4912 - 52s/epoch - 34ms/step
Epoch 20/50
1532/1532 - 51s - loss: 2.7406 - accuracy20: 0.5506 - val_loss: 3.0722 - val_accuracy20: 0.5014 - 51s/epoch - 33ms/step
Epoch 21/50
1532/1532 - 49s - loss: 2.7342 - accuracy20: 0.5514 - val_loss: 3.1878 - val_accuracy20: 0.4869 - 49s/epoch - 32ms/step
Epoch 22/50
1532/1532 - 50s - loss: 2.7316 - accuracy20: 0.5519 - val_loss: 3.0931 - val_accuracy20: 0.4995 - 50s/epoch - 33ms/step
Epoch 23/50
1532/1532 - 52s - loss: 2.7281 - accuracy20: 0.5533 - val_loss: 3.1319 - val_accuracy20: 0.4944 - 52s/epoch - 34ms/step
Epoch 24/50
1532/1532 - 50s - loss: 2.7239 - accuracy20: 0.5539 - val_loss: 3.1006 - val_accuracy20: 0.4956 - 50s/epoch - 32ms/step
Epoch 25/50
1532/1532 - 49s - loss: 2.7200 - accuracy20: 0.5548 - val_loss: 3.0960 - val_accuracy20: 0.4950 - 49s/epoch - 32ms/step
Epoch 26/50
1532/1532 - 54s - loss: 2.7171 - accuracy20: 0.5551 - val_loss: 3.0648 - val_accuracy20: 0.4982 - 54s/epoch - 35ms/step
Epoch 27/50
1532/1532 - 54s - loss: 2.7133 - accuracy20: 0.5566 - val_loss: 3.1133 - val_accuracy20: 0.4967 - 54s/epoch - 36ms/step
Epoch 28/50
1532/1532 - 49s - loss: 2.7087 - accuracy20: 0.5568 - val_loss: 3.1469 - val_accuracy20: 0.4934 - 49s/epoch - 32ms/step
Epoch 29/50
1532/1532 - 50s - loss: 2.7080 - accuracy20: 0.5578 - val_loss: 3.1395 - val_accuracy20: 0.4938 - 50s/epoch - 33ms/step
Epoch 30/50
1532/1532 - 49s - loss: 2.7044 - accuracy20: 0.5585 - val_loss: 3.0875 - val_accuracy20: 0.5006 - 49s/epoch - 32ms/step
Epoch 31/50
1532/1532 - 50s - loss: 2.7010 - accuracy20: 0.5595 - val_loss: 3.1101 - val_accuracy20: 0.5004 - 50s/epoch - 33ms/step
Epoch 32/50
1532/1532 - 50s - loss: 2.6983 - accuracy20: 0.5596 - val_loss: 3.1017 - val_accuracy20: 0.5021 - 50s/epoch - 33ms/step
Epoch 33/50
1532/1532 - 54s - loss: 2.6957 - accuracy20: 0.5601 - val_loss: 3.1378 - val_accuracy20: 0.4973 - 54s/epoch - 36ms/step
Epoch 34/50
1532/1532 - 56s - loss: 2.6919 - accuracy20: 0.5610 - val_loss: 3.1263 - val_accuracy20: 0.4994 - 56s/epoch - 36ms/step
Epoch 35/50
1532/1532 - 56s - loss: 2.6906 - accuracy20: 0.5616 - val_loss: 3.0951 - val_accuracy20: 0.5005 - 56s/epoch - 37ms/step
Epoch 36/50
1532/1532 - 57s - loss: 2.6886 - accuracy20: 0.5611 - val_loss: 3.1245 - val_accuracy20: 0.5004 - 57s/epoch - 37ms/step
testing model: results/WBA/W8/deepVOL_L3/h20
Evaluating performance on  test set...
3755/3755 - 50s - 50s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9615002
{'0': {'precision': 0.5298462073160135, 'recall': 0.3181454558102327, 'f1-score': 0.3975703310912864, 'support': 287510}, '1': {'precision': 0.5707021684301121, 'recall': 0.7404218564186017, 'f1-score': 0.6445772497531695, 'support': 399425}, '2': {'precision': 0.4779908182554685, 'recall': 0.47117726855025743, 'f1-score': 0.47455958806126924, 'support': 274228}, 'accuracy': 0.5372897208902132, 'macro avg': {'precision': 0.5261797313338646, 'recall': 0.5099148602596973, 'f1-score': 0.5055690563019084, 'support': 961163}, 'weighted avg': {'precision': 0.5320297002685135, 'recall': 0.5372897208902132, 'f1-score': 0.5221832723373467, 'support': 961163}}
[[ 91470 115502  80538]
 [ 43111 295743  60571]
 [ 38054 106964 129210]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9722968
{'0': {'precision': 0.5390131920114339, 'recall': 0.3420938558607735, 'f1-score': 0.41854869203533746, 'support': 124574}, '1': {'precision': 0.5389207258834766, 'recall': 0.7052537288559286, 'f1-score': 0.6109687432325127, 'support': 144012}, '2': {'precision': 0.48515137415970094, 'recall': 0.4893240017800073, 'f1-score': 0.48722875453670245, 'support': 123595}, 'accuracy': 0.521848330235274, 'macro avg': {'precision': 0.5210284306848705, 'recall': 0.5122238621655698, 'f1-score': 0.5055820632681842, 'support': 392181}, 'weighted avg': {'precision': 0.5220048014738905, 'recall': 0.521848330235274, 'f1-score': 0.5108512480945647, 'support': 392181}}
[[ 42616  43213  38745]
 [ 17012 101565  25435]
 [ 19435  43682  60478]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0135055
{'0': {'precision': 0.5204516836589625, 'recall': 0.3392105472162656, 'f1-score': 0.4107257340684703, 'support': 37773}, '1': {'precision': 0.5137464095199015, 'recall': 0.652127635482483, 'f1-score': 0.5747245728883921, 'support': 44157}, '2': {'precision': 0.46384935293054014, 'recall': 0.4794542493258217, 'f1-score': 0.47152272667594464, 'support': 37453}, 'accuracy': 0.4989487615489643, 'macro avg': {'precision': 0.49934914870313474, 'recall': 0.4902641440081901, 'f1-score': 0.4856576778776023, 'support': 119383}, 'weighted avg': {'precision': 0.5002141968900747, 'recall': 0.4989487615489643, 'f1-score': 0.4904584136786244, 'support': 119383}}
[[12813 13454 11506]
 [ 6111 28796  9250]
 [ 5695 13801 17957]]
training model: results/WBA/W8/deepVOL_L3/h30
Epoch 1/50
1532/1532 - 55s - loss: 3.2504 - accuracy30: 0.3858 - val_loss: 3.6377 - val_accuracy30: 0.3348 - 55s/epoch - 36ms/step
Epoch 2/50
1532/1532 - 55s - loss: 3.2074 - accuracy30: 0.4036 - val_loss: 3.3232 - val_accuracy30: 0.3689 - 55s/epoch - 36ms/step
Epoch 3/50
1532/1532 - 55s - loss: 3.1429 - accuracy30: 0.4312 - val_loss: 3.2546 - val_accuracy30: 0.4064 - 55s/epoch - 36ms/step
Epoch 4/50
1532/1532 - 49s - loss: 3.1162 - accuracy30: 0.4398 - val_loss: 3.2535 - val_accuracy30: 0.4101 - 49s/epoch - 32ms/step
Epoch 5/50
1532/1532 - 50s - loss: 3.0808 - accuracy30: 0.4487 - val_loss: 3.2764 - val_accuracy30: 0.4165 - 50s/epoch - 33ms/step
Epoch 6/50
1532/1532 - 50s - loss: 3.0376 - accuracy30: 0.4630 - val_loss: 3.2604 - val_accuracy30: 0.4325 - 50s/epoch - 33ms/step
Epoch 7/50
1532/1532 - 50s - loss: 2.9731 - accuracy30: 0.4864 - val_loss: 3.2293 - val_accuracy30: 0.4518 - 50s/epoch - 33ms/step
Epoch 8/50
1532/1532 - 50s - loss: 2.9387 - accuracy30: 0.4990 - val_loss: 3.1927 - val_accuracy30: 0.4682 - 50s/epoch - 32ms/step
Epoch 9/50
1532/1532 - 51s - loss: 2.9221 - accuracy30: 0.5035 - val_loss: 3.1538 - val_accuracy30: 0.4731 - 51s/epoch - 33ms/step
Epoch 10/50
1532/1532 - 49s - loss: 2.9098 - accuracy30: 0.5075 - val_loss: 3.1551 - val_accuracy30: 0.4740 - 49s/epoch - 32ms/step
Epoch 11/50
1532/1532 - 50s - loss: 2.9012 - accuracy30: 0.5096 - val_loss: 3.1702 - val_accuracy30: 0.4752 - 50s/epoch - 33ms/step
Epoch 12/50
1532/1532 - 50s - loss: 2.8939 - accuracy30: 0.5119 - val_loss: 3.1574 - val_accuracy30: 0.4726 - 50s/epoch - 32ms/step
Epoch 13/50
1532/1532 - 50s - loss: 2.8880 - accuracy30: 0.5137 - val_loss: 3.1606 - val_accuracy30: 0.4762 - 50s/epoch - 33ms/step
Epoch 14/50
1532/1532 - 51s - loss: 2.8846 - accuracy30: 0.5142 - val_loss: 3.1423 - val_accuracy30: 0.4721 - 51s/epoch - 33ms/step
Epoch 15/50
1532/1532 - 50s - loss: 2.8817 - accuracy30: 0.5153 - val_loss: 3.1418 - val_accuracy30: 0.4764 - 50s/epoch - 33ms/step
Epoch 16/50
1532/1532 - 50s - loss: 2.8757 - accuracy30: 0.5177 - val_loss: 3.1407 - val_accuracy30: 0.4757 - 50s/epoch - 33ms/step
Epoch 17/50
1532/1532 - 50s - loss: 2.8711 - accuracy30: 0.5185 - val_loss: 3.1335 - val_accuracy30: 0.4755 - 50s/epoch - 33ms/step
Epoch 18/50
1532/1532 - 49s - loss: 2.8666 - accuracy30: 0.5201 - val_loss: 3.1415 - val_accuracy30: 0.4754 - 49s/epoch - 32ms/step
Epoch 19/50
1532/1532 - 51s - loss: 2.8624 - accuracy30: 0.5207 - val_loss: 3.1161 - val_accuracy30: 0.4749 - 51s/epoch - 33ms/step
Epoch 20/50
1532/1532 - 49s - loss: 2.8586 - accuracy30: 0.5225 - val_loss: 3.1265 - val_accuracy30: 0.4693 - 49s/epoch - 32ms/step
Epoch 21/50
1532/1532 - 54s - loss: 2.8543 - accuracy30: 0.5233 - val_loss: 3.1318 - val_accuracy30: 0.4696 - 54s/epoch - 35ms/step
Epoch 22/50
1532/1532 - 54s - loss: 2.8501 - accuracy30: 0.5252 - val_loss: 3.1089 - val_accuracy30: 0.4748 - 54s/epoch - 36ms/step
Epoch 23/50
1532/1532 - 50s - loss: 2.8475 - accuracy30: 0.5251 - val_loss: 3.0933 - val_accuracy30: 0.4795 - 50s/epoch - 32ms/step
Epoch 24/50
1532/1532 - 50s - loss: 2.8443 - accuracy30: 0.5262 - val_loss: 3.1011 - val_accuracy30: 0.4741 - 50s/epoch - 32ms/step
Epoch 25/50
1532/1532 - 49s - loss: 2.8408 - accuracy30: 0.5268 - val_loss: 3.1078 - val_accuracy30: 0.4755 - 49s/epoch - 32ms/step
Epoch 26/50
1532/1532 - 49s - loss: 2.8379 - accuracy30: 0.5271 - val_loss: 3.1174 - val_accuracy30: 0.4754 - 49s/epoch - 32ms/step
Epoch 27/50
1532/1532 - 51s - loss: 2.8348 - accuracy30: 0.5285 - val_loss: 3.1150 - val_accuracy30: 0.4752 - 51s/epoch - 33ms/step
Epoch 28/50
1532/1532 - 50s - loss: 2.8304 - accuracy30: 0.5291 - val_loss: 3.1213 - val_accuracy30: 0.4759 - 50s/epoch - 33ms/step
Epoch 29/50
1532/1532 - 50s - loss: 2.8283 - accuracy30: 0.5299 - val_loss: 3.1245 - val_accuracy30: 0.4750 - 50s/epoch - 32ms/step
Epoch 30/50
1532/1532 - 50s - loss: 2.8243 - accuracy30: 0.5311 - val_loss: 3.1323 - val_accuracy30: 0.4707 - 50s/epoch - 33ms/step
Epoch 31/50
1532/1532 - 54s - loss: 2.8208 - accuracy30: 0.5322 - val_loss: 3.1650 - val_accuracy30: 0.4658 - 54s/epoch - 35ms/step
Epoch 32/50
1532/1532 - 49s - loss: 2.8182 - accuracy30: 0.5322 - val_loss: 3.1479 - val_accuracy30: 0.4700 - 49s/epoch - 32ms/step
Epoch 33/50
1532/1532 - 50s - loss: 2.8147 - accuracy30: 0.5334 - val_loss: 3.1380 - val_accuracy30: 0.4678 - 50s/epoch - 33ms/step
testing model: results/WBA/W8/deepVOL_L3/h30
Evaluating performance on  test set...
3755/3755 - 51s - 51s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.988663
{'0': {'precision': 0.49609965789462473, 'recall': 0.38104805722625446, 'f1-score': 0.43102845181624866, 'support': 305594}, '1': {'precision': 0.5507993799773607, 'recall': 0.6813675053783557, 'f1-score': 0.6091655342462384, 'support': 363494}, '2': {'precision': 0.4735547133272394, 'recall': 0.4487546007018745, 'f1-score': 0.46082123005199926, 'support': 292075}, 'accuracy': 0.515197734411333, 'macro avg': {'precision': 0.5068179170664083, 'recall': 0.5037233877688282, 'f1-score': 0.5003384053714955, 'support': 961163}, 'weighted avg': {'precision': 0.5099351947330413, 'recall': 0.515197734411333, 'f1-score': 0.5074499186683992, 'support': 961163}}
[[116446 104741  84407]
 [ 54519 247673  61302]
 [ 63758  97247 131070]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9945276
{'0': {'precision': 0.48893268912106885, 'recall': 0.4274516980038733, 'f1-score': 0.4561297881342142, 'support': 131154}, '1': {'precision': 0.5292210562238717, 'recall': 0.6159833780201817, 'f1-score': 0.5693155984806767, 'support': 130911}, '2': {'precision': 0.4792722100586515, 'recall': 0.46096559992621966, 'f1-score': 0.4699406883907515, 'support': 130116}, 'accuracy': 0.5015031324821957, 'macro avg': {'precision': 0.4991419851345307, 'recall': 0.5014668919834249, 'f1-score': 0.4984620250018808, 'support': 392181}, 'weighted avg': {'precision': 0.4991759378559885, 'recall': 0.5015031324821957, 'f1-score': 0.4984936117667853, 'support': 392181}}
[[56062 35967 39125]
 [24230 80639 26042]
 [34370 35767 59979]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0317901
{'0': {'precision': 0.4745762711864407, 'recall': 0.4303257075412471, 'f1-score': 0.45136904213146495, 'support': 39821}, '1': {'precision': 0.49574156325839097, 'recall': 0.5427497180097757, 'f1-score': 0.5181817094037549, 'support': 39895}, '2': {'precision': 0.4648079399954542, 'recall': 0.46398769758237324, 'f1-score': 0.4643974566007267, 'support': 39667}, 'accuracy': 0.4790799360042887, 'macro avg': {'precision': 0.47837525814676196, 'recall': 0.47902104104446536, 'f1-score': 0.4779827360453155, 'support': 119383}, 'weighted avg': {'precision': 0.4784035240939534, 'recall': 0.4790799360042887, 'f1-score': 0.47802517807695305, 'support': 119383}}
[[17136 11011 11674]
 [ 8724 21653  9518]
 [10248 11014 18405]]
training model: results/WBA/W8/deepVOL_L3/h50
Epoch 1/50
1532/1532 - 54s - loss: 3.2668 - accuracy50: 0.3835 - val_loss: 3.5936 - val_accuracy50: 0.3306 - 54s/epoch - 35ms/step
Epoch 2/50
1532/1532 - 54s - loss: 3.2123 - accuracy50: 0.4055 - val_loss: 3.6630 - val_accuracy50: 0.3327 - 54s/epoch - 36ms/step
Epoch 3/50
1532/1532 - 55s - loss: 3.1515 - accuracy50: 0.4315 - val_loss: 3.5278 - val_accuracy50: 0.3396 - 55s/epoch - 36ms/step
Epoch 4/50
1532/1532 - 50s - loss: 3.1206 - accuracy50: 0.4454 - val_loss: 3.2501 - val_accuracy50: 0.3930 - 50s/epoch - 32ms/step
Epoch 5/50
1532/1532 - 55s - loss: 3.1031 - accuracy50: 0.4542 - val_loss: 3.2095 - val_accuracy50: 0.4239 - 55s/epoch - 36ms/step
Epoch 6/50
1532/1532 - 50s - loss: 3.0869 - accuracy50: 0.4596 - val_loss: 3.1941 - val_accuracy50: 0.4313 - 50s/epoch - 33ms/step
Epoch 7/50
1532/1532 - 50s - loss: 3.0715 - accuracy50: 0.4646 - val_loss: 3.2209 - val_accuracy50: 0.4239 - 50s/epoch - 33ms/step
Epoch 8/50
1532/1532 - 51s - loss: 3.0590 - accuracy50: 0.4685 - val_loss: 3.2542 - val_accuracy50: 0.4165 - 51s/epoch - 33ms/step
Epoch 9/50
1532/1532 - 50s - loss: 3.0502 - accuracy50: 0.4709 - val_loss: 3.2880 - val_accuracy50: 0.4113 - 50s/epoch - 33ms/step
Epoch 10/50
1532/1532 - 50s - loss: 3.0429 - accuracy50: 0.4736 - val_loss: 3.2581 - val_accuracy50: 0.4099 - 50s/epoch - 33ms/step
Epoch 11/50
1532/1532 - 50s - loss: 3.0362 - accuracy50: 0.4751 - val_loss: 3.2570 - val_accuracy50: 0.4144 - 50s/epoch - 32ms/step
Epoch 12/50
1532/1532 - 50s - loss: 3.0307 - accuracy50: 0.4780 - val_loss: 3.2736 - val_accuracy50: 0.4074 - 50s/epoch - 33ms/step
Epoch 13/50
1532/1532 - 50s - loss: 3.0269 - accuracy50: 0.4790 - val_loss: 3.2486 - val_accuracy50: 0.4152 - 50s/epoch - 32ms/step
Epoch 14/50
1532/1532 - 50s - loss: 3.0219 - accuracy50: 0.4805 - val_loss: 3.2379 - val_accuracy50: 0.4167 - 50s/epoch - 32ms/step
Epoch 15/50
1532/1532 - 49s - loss: 3.0172 - accuracy50: 0.4824 - val_loss: 3.2527 - val_accuracy50: 0.4176 - 49s/epoch - 32ms/step
Epoch 16/50
1532/1532 - 51s - loss: 3.0138 - accuracy50: 0.4835 - val_loss: 3.2304 - val_accuracy50: 0.4220 - 51s/epoch - 33ms/step
testing model: results/WBA/W8/deepVOL_L3/h50
Evaluating performance on  test set...
3755/3755 - 51s - 51s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.044374
{'0': {'precision': 0.43227899186182706, 'recall': 0.45816676690133373, 'f1-score': 0.44484656398566735, 'support': 310937}, '1': {'precision': 0.5064785478547855, 'recall': 0.43145882300019117, 'f1-score': 0.46596850690164027, 'support': 355684}, '2': {'precision': 0.4132316915445596, 'recall': 0.4610208391332985, 'f1-score': 0.4358201194902647, 'support': 294542}, 'accuracy': 0.4491579471952208, 'macro avg': {'precision': 0.4506630770870574, 'recall': 0.45021547634494113, 'f1-score': 0.4488783967925241, 'support': 961163}, 'weighted avg': {'precision': 0.4539000539956699, 'recall': 0.4491579471952208, 'f1-score': 0.44989676892443425, 'support': 961163}}
[[142461  79292  89184]
 [ 98590 153463 103631]
 [ 88507  70245 135790]]
Evaluating performance on  train set...
1532/1532 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0527573
{'0': {'precision': 0.43518032696343756, 'recall': 0.47834236367223665, 'f1-score': 0.45574168733235493, 'support': 131778}, '1': {'precision': 0.4717884063890048, 'recall': 0.41084600040204733, 'f1-score': 0.4392132876525505, 'support': 129338}, '2': {'precision': 0.42993422517854224, 'recall': 0.4418647236104223, 'f1-score': 0.43581784043918165, 'support': 131065}, 'accuracy': 0.44389197844872647, 'macro avg': {'precision': 0.4456343195103282, 'recall': 0.44368436256156873, 'f1-score': 0.4435909384746957, 'support': 392181}, 'weighted avg': {'precision': 0.4455001421668939, 'recall': 0.44389197844872647, 'f1-score': 0.4436323063301128, 'support': 392181}}
[[63035 29906 38837]
 [38248 53138 37952]
 [43565 29587 57913]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0641412
{'0': {'precision': 0.4300379477505539, 'recall': 0.49231580533373515, 'f1-score': 0.4590743581037572, 'support': 39822}, '1': {'precision': 0.4472901306428664, 'recall': 0.3504877739769416, 'f1-score': 0.39301595419738883, 'support': 39465}, '2': {'precision': 0.4218567763004432, 'recall': 0.4510424980047885, 'f1-score': 0.4359617192584915, 'support': 40096}, 'accuracy': 0.43156898385867337, 'macro avg': {'precision': 0.43306161823128786, 'recall': 0.43128202577182173, 'f1-score': 0.42935067718654585, 'support': 119383}, 'weighted avg': {'precision': 0.43299335302083086, 'recall': 0.43156898385867337, 'f1-score': 0.429474504880898, 'support': 119383}}
[[19605  8437 11780]
 [12628 13832 13005]
 [13356  8655 18085]]
training model: results/WBA/W8/deepVOL_L3/h100
Epoch 1/50
1532/1532 - 55s - loss: 3.2792 - accuracy100: 0.3739 - val_loss: 3.3576 - val_accuracy100: 0.3500 - 55s/epoch - 36ms/step
Epoch 2/50
1532/1532 - 49s - loss: 3.2734 - accuracy100: 0.3705 - val_loss: 3.4986 - val_accuracy100: 0.3497 - 49s/epoch - 32ms/step
Epoch 3/50
1532/1532 - 50s - loss: 3.2593 - accuracy100: 0.3824 - val_loss: 3.4786 - val_accuracy100: 0.3516 - 50s/epoch - 33ms/step
Epoch 4/50
1532/1532 - 49s - loss: 3.2416 - accuracy100: 0.3920 - val_loss: 3.4652 - val_accuracy100: 0.3518 - 49s/epoch - 32ms/step
Epoch 5/50
1532/1532 - 49s - loss: 3.2245 - accuracy100: 0.4023 - val_loss: 3.4424 - val_accuracy100: 0.3526 - 49s/epoch - 32ms/step
Epoch 6/50
1532/1532 - 49s - loss: 3.2136 - accuracy100: 0.4092 - val_loss: 3.4002 - val_accuracy100: 0.3545 - 49s/epoch - 32ms/step
Epoch 7/50
1532/1532 - 50s - loss: 3.2038 - accuracy100: 0.4131 - val_loss: 3.3652 - val_accuracy100: 0.3613 - 50s/epoch - 33ms/step
Epoch 8/50
1532/1532 - 49s - loss: 3.1980 - accuracy100: 0.4150 - val_loss: 3.3374 - val_accuracy100: 0.3727 - 49s/epoch - 32ms/step
Epoch 9/50
1532/1532 - 50s - loss: 3.1940 - accuracy100: 0.4173 - val_loss: 3.3236 - val_accuracy100: 0.3728 - 50s/epoch - 32ms/step
Epoch 10/50
1532/1532 - 50s - loss: 3.1884 - accuracy100: 0.4191 - val_loss: 3.2834 - val_accuracy100: 0.3852 - 50s/epoch - 32ms/step
Epoch 11/50
1532/1532 - 49s - loss: 3.1821 - accuracy100: 0.4226 - val_loss: 3.2890 - val_accuracy100: 0.3895 - 49s/epoch - 32ms/step
Epoch 12/50
1532/1532 - 49s - loss: 3.1772 - accuracy100: 0.4234 - val_loss: 3.2943 - val_accuracy100: 0.3898 - 49s/epoch - 32ms/step
Epoch 13/50
1532/1532 - 49s - loss: 3.1711 - accuracy100: 0.4258 - val_loss: 3.3216 - val_accuracy100: 0.3803 - 49s/epoch - 32ms/step
Epoch 14/50
1532/1532 - 49s - loss: 3.1670 - accuracy100: 0.4274 - val_loss: 3.2946 - val_accuracy100: 0.3929 - 49s/epoch - 32ms/step
Epoch 15/50
1532/1532 - 49s - loss: 3.1610 - accuracy100: 0.4292 - val_loss: 3.3099 - val_accuracy100: 0.3870 - 49s/epoch - 32ms/step
Epoch 16/50
1532/1532 - 49s - loss: 3.1586 - accuracy100: 0.4296 - val_loss: 3.3062 - val_accuracy100: 0.3928 - 49s/epoch - 32ms/step
Epoch 17/50
1532/1532 - 50s - loss: 3.1550 - accuracy100: 0.4315 - val_loss: 3.2976 - val_accuracy100: 0.3941 - 50s/epoch - 32ms/step
Epoch 18/50
1532/1532 - 49s - loss: 3.1512 - accuracy100: 0.4328 - val_loss: 3.2963 - val_accuracy100: 0.3973 - 49s/epoch - 32ms/step
Epoch 19/50
1532/1532 - 50s - loss: 3.1486 - accuracy100: 0.4349 - val_loss: 3.3189 - val_accuracy100: 0.3956 - 50s/epoch - 32ms/step
Epoch 20/50
1532/1532 - 49s - loss: 3.1470 - accuracy100: 0.4353 - val_loss: 3.3111 - val_accuracy100: 0.3945 - 49s/epoch - 32ms/step
testing model: results/WBA/W8/deepVOL_L3/h100
Evaluating performance on  test set...
3755/3755 - 51s - 51s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0930082
{'0': {'precision': 0.42250155569383946, 'recall': 0.26837806301050177, 'f1-score': 0.3282486443837651, 'support': 316233}, '1': {'precision': 0.38240372075049855, 'recall': 0.8007745217039477, 'f1-score': 0.5176213449404776, 'support': 346020}, '2': {'precision': 0.4104136907262695, 'recall': 0.0490214445819812, 'f1-score': 0.08758177357125993, 'support': 298910}, 'accuracy': 0.3918242795446766, 'macro avg': {'precision': 0.4051063223902025, 'recall': 0.3727246764321435, 'f1-score': 0.31115058763183423, 'support': 961163}, 'weighted avg': {'precision': 0.4043071010960749, 'recall': 0.3918242795446766, 'f1-score': 0.32157860765957547, 'support': 961163}}
[[ 84870 219942  11421]
 [ 59307 277084   9629]
 [ 56698 227559  14653]]
Evaluating performance on  train set...
1532/1532 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1016425
{'0': {'precision': 0.4069671635888253, 'recall': 0.28408742331288345, 'f1-score': 0.33460237459749714, 'support': 130400}, '1': {'precision': 0.3561299971562683, 'recall': 0.7757647598654023, 'f1-score': 0.4881604053927241, 'support': 130760}, '2': {'precision': 0.4344548630262916, 'recall': 0.054105830363071566, 'f1-score': 0.09622772129389567, 'support': 131021}, 'accuracy': 0.3711883033599282, 'macro avg': {'precision': 0.3991840079237951, 'recall': 0.37131933784711907, 'f1-score': 0.3063301670947057, 'support': 392181}, 'weighted avg': {'precision': 0.39920033649948417, 'recall': 0.3711883033599282, 'f1-score': 0.3061643897290122, 'support': 392181}}
[[ 37045  88057   5298]
 [ 25391 101439   3930]
 [ 28591  95341   7089]]
Evaluating performance on  val set...
467/467 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0949733
{'0': {'precision': 0.40479220448678327, 'recall': 0.2893492046990332, 'f1-score': 0.33747101350429687, 'support': 38476}, '1': {'precision': 0.3762790110129882, 'recall': 0.7853975406888948, 'f1-score': 0.5087967204459697, 'support': 41719}, '2': {'precision': 0.4309518850239533, 'recall': 0.0527967745228131, 'f1-score': 0.09406897178840164, 'support': 39188}, 'accuracy': 0.3850464471490916, 'macro avg': {'precision': 0.40400770017457494, 'recall': 0.375847839970247, 'f1-score': 0.3134455685795561, 'support': 119383}, 'weighted avg': {'precision': 0.403415154507786, 'recall': 0.3850464471490916, 'f1-score': 0.31744385684997545, 'support': 119383}}
[[11133 25796  1547]
 [ 7768 32766  1185]
 [ 8602 28517  2069]]
training model: results/WBA/W8/deepVOL_L3/h200
Epoch 1/50
1532/1532 - 54s - loss: 3.2671 - accuracy200: 0.3832 - val_loss: 3.3407 - val_accuracy200: 0.3569 - 54s/epoch - 35ms/step
Epoch 2/50
1532/1532 - 51s - loss: 3.2663 - accuracy200: 0.3720 - val_loss: 3.2885 - val_accuracy200: 0.3638 - 51s/epoch - 33ms/step
Epoch 3/50
1532/1532 - 49s - loss: 3.2755 - accuracy200: 0.3664 - val_loss: 3.2999 - val_accuracy200: 0.3461 - 49s/epoch - 32ms/step
Epoch 4/50
1532/1532 - 50s - loss: 3.2775 - accuracy200: 0.3696 - val_loss: 3.2908 - val_accuracy200: 0.3616 - 50s/epoch - 33ms/step
Epoch 5/50
1532/1532 - 50s - loss: 3.2641 - accuracy200: 0.3762 - val_loss: 3.2954 - val_accuracy200: 0.3667 - 50s/epoch - 33ms/step
Epoch 6/50
1532/1532 - 50s - loss: 3.2514 - accuracy200: 0.3825 - val_loss: 3.2854 - val_accuracy200: 0.3700 - 50s/epoch - 33ms/step
Epoch 7/50
1532/1532 - 50s - loss: 3.2491 - accuracy200: 0.3849 - val_loss: 3.2860 - val_accuracy200: 0.3736 - 50s/epoch - 32ms/step
Epoch 8/50
1532/1532 - 49s - loss: 3.2502 - accuracy200: 0.3839 - val_loss: 3.2805 - val_accuracy200: 0.3713 - 49s/epoch - 32ms/step
Epoch 9/50
1532/1532 - 50s - loss: 3.2455 - accuracy200: 0.3840 - val_loss: 3.2648 - val_accuracy200: 0.3800 - 50s/epoch - 33ms/step
Epoch 10/50
1532/1532 - 50s - loss: 3.2437 - accuracy200: 0.3832 - val_loss: 3.2930 - val_accuracy200: 0.3465 - 50s/epoch - 32ms/step
Epoch 11/50
1532/1532 - 49s - loss: 3.2392 - accuracy200: 0.3881 - val_loss: 3.3176 - val_accuracy200: 0.3487 - 49s/epoch - 32ms/step
Epoch 12/50
1532/1532 - 51s - loss: 3.2407 - accuracy200: 0.3868 - val_loss: 3.3057 - val_accuracy200: 0.3533 - 51s/epoch - 33ms/step
Epoch 13/50
1532/1532 - 49s - loss: 3.2433 - accuracy200: 0.3843 - val_loss: 3.2985 - val_accuracy200: 0.3501 - 49s/epoch - 32ms/step
Epoch 14/50
1532/1532 - 49s - loss: 3.2432 - accuracy200: 0.3845 - val_loss: 3.2982 - val_accuracy200: 0.3538 - 49s/epoch - 32ms/step
Epoch 15/50
1532/1532 - 49s - loss: 3.2402 - accuracy200: 0.3873 - val_loss: 3.3081 - val_accuracy200: 0.3606 - 49s/epoch - 32ms/step
Epoch 16/50
1532/1532 - 50s - loss: 3.2364 - accuracy200: 0.3879 - val_loss: 3.3106 - val_accuracy200: 0.3617 - 50s/epoch - 33ms/step
Epoch 17/50
1532/1532 - 49s - loss: 3.2338 - accuracy200: 0.3881 - val_loss: 3.3181 - val_accuracy200: 0.3614 - 49s/epoch - 32ms/step
Epoch 18/50
1532/1532 - 50s - loss: 3.2333 - accuracy200: 0.3890 - val_loss: 3.3047 - val_accuracy200: 0.3638 - 50s/epoch - 33ms/step
Epoch 19/50
1532/1532 - 49s - loss: 3.2287 - accuracy200: 0.3919 - val_loss: 3.3085 - val_accuracy200: 0.3661 - 49s/epoch - 32ms/step
testing model: results/WBA/W8/deepVOL_L3/h200
Evaluating performance on  test set...
3755/3755 - 52s - 52s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.079317
{'0': {'precision': 0.3380719706014245, 'recall': 0.19965949543414332, 'f1-score': 0.2510519965228974, 'support': 290745}, '1': {'precision': 0.45964220761299546, 'recall': 0.6633220996732027, 'f1-score': 0.5430107302147298, 'support': 391680}, '2': {'precision': 0.3262432540921458, 'recall': 0.2624220594249797, 'f1-score': 0.29087301271702043, 'support': 278738}, 'accuracy': 0.4068061296575087, 'macro avg': {'precision': 0.37465247743552194, 'recall': 0.3751345515107752, 'f1-score': 0.36164524648488255, 'support': 961163}, 'weighted avg': {'precision': 0.3841822741090801, 'recall': 0.4068061296575087, 'f1-score': 0.38157515151776755, 'support': 961163}}
[[ 58050 156911  75784]
 [ 56591 259810  75279]
 [ 57068 148523  73147]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0940633
{'0': {'precision': 0.35914434423655045, 'recall': 0.24622211284827697, 'f1-score': 0.2921512357366743, 'support': 130033}, '1': {'precision': 0.38340254210493036, 'recall': 0.5587331817902562, 'f1-score': 0.4547534220888806, 'support': 130216}, '2': {'precision': 0.3593392719985168, 'recall': 0.30850741290968076, 'f1-score': 0.33198885812048073, 'support': 131932}, 'accuracy': 0.3709384187403265, 'macro avg': {'precision': 0.3672953861133325, 'recall': 0.37115423584940466, 'f1-score': 0.35963117198201183, 'support': 392181}, 'weighted avg': {'precision': 0.36726437734147066, 'recall': 0.3709384187403265, 'f1-score': 0.359541709763665, 'support': 392181}}
[[32017 57768 40248]
 [25141 72756 32319]
 [31990 59240 40702]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0878907
{'0': {'precision': 0.33252875195229303, 'recall': 0.25134823321080735, 'f1-score': 0.2862949436914567, 'support': 37271}, '1': {'precision': 0.42473993089200507, 'recall': 0.5313329064129539, 'f1-score': 0.47209437010394123, 'support': 43724}, '2': {'precision': 0.35057786054663964, 'recall': 0.3334635823694905, 'f1-score': 0.3418066273263731, 'support': 38388}, 'accuracy': 0.3802970272149301, 'macro avg': {'precision': 0.3692821811303126, 'recall': 0.3720482406644172, 'f1-score': 0.3667319803739237, 'support': 119383}, 'weighted avg': {'precision': 0.37210482868582917, 'recall': 0.3802970272149301, 'f1-score': 0.37219391282304704, 'support': 119383}}
[[ 9368 15715 12188]
 [ 8967 23232 11525]
 [ 9837 15750 12801]]
training model: results/WBA/W8/deepVOL_L3/h300
Epoch 1/50
1532/1532 - 53s - loss: 3.2658 - accuracy300: 0.3871 - val_loss: 3.7242 - val_accuracy300: 0.3615 - 53s/epoch - 35ms/step
Epoch 2/50
1532/1532 - 56s - loss: 3.2658 - accuracy300: 0.3845 - val_loss: 3.9523 - val_accuracy300: 0.3615 - 56s/epoch - 36ms/step
Epoch 3/50
1532/1532 - 51s - loss: 3.2956 - accuracy300: 0.3613 - val_loss: 3.2927 - val_accuracy300: 0.3615 - 51s/epoch - 33ms/step
Epoch 4/50
1532/1532 - 49s - loss: 3.2977 - accuracy300: 0.3442 - val_loss: 3.2899 - val_accuracy300: 0.3614 - 49s/epoch - 32ms/step
Epoch 5/50
1532/1532 - 50s - loss: 3.2931 - accuracy300: 0.3545 - val_loss: 3.2756 - val_accuracy300: 0.3634 - 50s/epoch - 32ms/step
Epoch 6/50
1532/1532 - 50s - loss: 3.2622 - accuracy300: 0.3795 - val_loss: 3.7966 - val_accuracy300: 0.3616 - 50s/epoch - 32ms/step
Epoch 7/50
1532/1532 - 49s - loss: 3.2742 - accuracy300: 0.3740 - val_loss: 3.5195 - val_accuracy300: 0.3626 - 49s/epoch - 32ms/step
Epoch 8/50
1532/1532 - 50s - loss: 3.2437 - accuracy300: 0.3870 - val_loss: 3.5506 - val_accuracy300: 0.3641 - 50s/epoch - 33ms/step
Epoch 9/50
1532/1532 - 50s - loss: 3.2409 - accuracy300: 0.3862 - val_loss: 3.6936 - val_accuracy300: 0.3617 - 50s/epoch - 33ms/step
Epoch 10/50
1532/1532 - 49s - loss: 3.2266 - accuracy300: 0.3980 - val_loss: 3.4932 - val_accuracy300: 0.3707 - 49s/epoch - 32ms/step
Epoch 11/50
1532/1532 - 49s - loss: 3.2344 - accuracy300: 0.3943 - val_loss: 3.5909 - val_accuracy300: 0.3615 - 49s/epoch - 32ms/step
Epoch 12/50
1532/1532 - 49s - loss: 3.2334 - accuracy300: 0.3933 - val_loss: 3.6852 - val_accuracy300: 0.3624 - 49s/epoch - 32ms/step
Epoch 13/50
1532/1532 - 49s - loss: 3.2264 - accuracy300: 0.3961 - val_loss: 3.5301 - val_accuracy300: 0.3617 - 49s/epoch - 32ms/step
Epoch 14/50
1532/1532 - 49s - loss: 3.2211 - accuracy300: 0.3991 - val_loss: 3.5235 - val_accuracy300: 0.3622 - 49s/epoch - 32ms/step
Epoch 15/50
1532/1532 - 49s - loss: 3.2288 - accuracy300: 0.3955 - val_loss: 3.3655 - val_accuracy300: 0.3629 - 49s/epoch - 32ms/step
testing model: results/WBA/W8/deepVOL_L3/h300
Evaluating performance on  test set...
3755/3755 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0821022
{'0': {'precision': 0.3357995006011283, 'recall': 0.012955272021464863, 'f1-score': 0.024948039232526583, 'support': 280272}, '1': {'precision': 0.42812384853340646, 'recall': 0.9772588350929353, 'f1-score': 0.5954076684845515, 'support': 408994}, '2': {'precision': 0.3296932808211004, 'recall': 0.02032019477964082, 'f1-score': 0.03828099288077463, 'support': 271897}, 'accuracy': 0.42536905810981074, 'macro avg': {'precision': 0.3645388766518784, 'recall': 0.33684476729801366, 'f1-score': 0.21954556686595086, 'support': 961163}, 'weighted avg': {'precision': 0.373358001624039, 'recall': 0.42536905810981074, 'f1-score': 0.2714616437974135, 'support': 961163}}
[[  3631 270988   5653]
 [  3721 399693   5580]
 [  3461 262911   5525]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971956
{'0': {'precision': 0.3457370680842364, 'recall': 0.013031650495911715, 'f1-score': 0.025116596857083447, 'support': 129761}, '1': {'precision': 0.3324179003966876, 'recall': 0.9742423424743079, 'f1-score': 0.4956997746426939, 'support': 129709}, '2': {'precision': 0.3577429291514982, 'recall': 0.01925236039213027, 'f1-score': 0.03653836528354772, 'support': 132711}, 'accuracy': 0.3330452010678743, 'macro avg': {'precision': 0.34529929921080743, 'recall': 0.33550878445411664, 'f1-score': 0.18578491226110835, 'support': 392181}, 'weighted avg': {'precision': 0.3453946086242246, 'recall': 0.3330452010678743, 'f1-score': 0.1846211820283137, 'support': 392181}}
[[  1691 125400   2670]
 [  1424 126368   1917]
 [  1776 128380   2555]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0919082
{'0': {'precision': 0.33929754804506296, 'recall': 0.01364714662686249, 'f1-score': 0.026238917644647156, 'support': 37517}, '1': {'precision': 0.3634586609235666, 'recall': 0.9737006742822717, 'f1-score': 0.5293309987781374, 'support': 43157}, '2': {'precision': 0.3531236154186974, 'recall': 0.020589526983388878, 'f1-score': 0.038910315871698485, 'support': 38709}, 'accuracy': 0.3629578750743406, 'macro avg': {'precision': 0.3519599414624423, 'recall': 0.33597911596417435, 'f1-score': 0.19816007743149433, 'support': 119383}, 'weighted avg': {'precision': 0.3525147933016204, 'recall': 0.3629578750743406, 'f1-score': 0.21221549805767886, 'support': 119383}}
[[  512 36220   785]
 [  460 42022   675]
 [  537 37375   797]]
training model: results/WBA/W8/deepVOL_L3/h500
Epoch 1/50
1532/1532 - 55s - loss: 3.2766 - accuracy500: 0.3807 - val_loss: 3.3081 - val_accuracy500: 0.3210 - 55s/epoch - 36ms/step
Epoch 2/50
1532/1532 - 51s - loss: 3.2856 - accuracy500: 0.3621 - val_loss: 3.3734 - val_accuracy500: 0.3215 - 51s/epoch - 33ms/step
Epoch 3/50
1532/1532 - 51s - loss: 3.2451 - accuracy500: 0.3890 - val_loss: 3.2897 - val_accuracy500: 0.3725 - 51s/epoch - 33ms/step
Epoch 4/50
1532/1532 - 50s - loss: 3.2173 - accuracy500: 0.4076 - val_loss: 3.3347 - val_accuracy500: 0.3441 - 50s/epoch - 33ms/step
Epoch 5/50
1532/1532 - 49s - loss: 3.2042 - accuracy500: 0.4126 - val_loss: 3.3471 - val_accuracy500: 0.3358 - 49s/epoch - 32ms/step
Epoch 6/50
1532/1532 - 49s - loss: 3.1956 - accuracy500: 0.4148 - val_loss: 3.3286 - val_accuracy500: 0.3423 - 49s/epoch - 32ms/step
Epoch 7/50
1532/1532 - 49s - loss: 3.1913 - accuracy500: 0.4167 - val_loss: 3.3401 - val_accuracy500: 0.3442 - 49s/epoch - 32ms/step
Epoch 8/50
1532/1532 - 51s - loss: 3.1882 - accuracy500: 0.4175 - val_loss: 3.2887 - val_accuracy500: 0.3628 - 51s/epoch - 33ms/step
Epoch 9/50
1532/1532 - 50s - loss: 3.1844 - accuracy500: 0.4189 - val_loss: 3.2734 - val_accuracy500: 0.3698 - 50s/epoch - 33ms/step
Epoch 10/50
1532/1532 - 49s - loss: 3.1787 - accuracy500: 0.4212 - val_loss: 3.2677 - val_accuracy500: 0.3704 - 49s/epoch - 32ms/step
Epoch 11/50
1532/1532 - 50s - loss: 3.1767 - accuracy500: 0.4220 - val_loss: 3.2521 - val_accuracy500: 0.3827 - 50s/epoch - 33ms/step
Epoch 12/50
1532/1532 - 49s - loss: 3.1726 - accuracy500: 0.4241 - val_loss: 3.2715 - val_accuracy500: 0.3726 - 49s/epoch - 32ms/step
Epoch 13/50
1532/1532 - 50s - loss: 3.1709 - accuracy500: 0.4253 - val_loss: 3.2686 - val_accuracy500: 0.3733 - 50s/epoch - 33ms/step
Epoch 14/50
1532/1532 - 49s - loss: 3.1673 - accuracy500: 0.4254 - val_loss: 3.2843 - val_accuracy500: 0.3602 - 49s/epoch - 32ms/step
Epoch 15/50
1532/1532 - 49s - loss: 3.1654 - accuracy500: 0.4270 - val_loss: 3.2708 - val_accuracy500: 0.3718 - 49s/epoch - 32ms/step
Epoch 16/50
1532/1532 - 49s - loss: 3.1628 - accuracy500: 0.4277 - val_loss: 3.2708 - val_accuracy500: 0.3685 - 49s/epoch - 32ms/step
Epoch 17/50
1532/1532 - 50s - loss: 3.1607 - accuracy500: 0.4290 - val_loss: 3.2898 - val_accuracy500: 0.3639 - 50s/epoch - 32ms/step
Epoch 18/50
1532/1532 - 50s - loss: 3.1563 - accuracy500: 0.4308 - val_loss: 3.3022 - val_accuracy500: 0.3601 - 50s/epoch - 32ms/step
Epoch 19/50
1532/1532 - 49s - loss: 3.1525 - accuracy500: 0.4317 - val_loss: 3.3127 - val_accuracy500: 0.3597 - 49s/epoch - 32ms/step
Epoch 20/50
1532/1532 - 50s - loss: 3.1495 - accuracy500: 0.4339 - val_loss: 3.3253 - val_accuracy500: 0.3582 - 50s/epoch - 32ms/step
Epoch 21/50
1532/1532 - 49s - loss: 3.1459 - accuracy500: 0.4363 - val_loss: 3.3299 - val_accuracy500: 0.3572 - 49s/epoch - 32ms/step
testing model: results/WBA/W8/deepVOL_L3/h500
Evaluating performance on  test set...
3755/3755 - 58s - 58s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0807322
{'0': {'precision': 0.357187831798316, 'recall': 0.1867421858611286, 'f1-score': 0.24525962644987506, 'support': 309855}, '1': {'precision': 0.43187816873326623, 'recall': 0.6437224046190422, 'f1-score': 0.5169384624126371, 'support': 353320}, '2': {'precision': 0.35089914396944266, 'recall': 0.3209290306992228, 'f1-score': 0.3352456071162526, 'support': 297988}, 'accuracy': 0.3963281982348467, 'macro avg': {'precision': 0.3799883815003416, 'recall': 0.3837978737264645, 'f1-score': 0.36581456532625495, 'support': 961163}, 'weighted avg': {'precision': 0.3826940532582622, 'recall': 0.3963281982348467, 'f1-score': 0.3730259977408794, 'support': 961163}}
[[ 57863 151764 100228]
 [ 49204 227440  76676]
 [ 54929 147426  95633]]
Evaluating performance on  train set...
1532/1532 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0785792
{'0': {'precision': 0.37364860220544194, 'recall': 0.29245348274192434, 'f1-score': 0.32810236600676007, 'support': 130113}, '1': {'precision': 0.421385630457987, 'recall': 0.5879919740700725, 'f1-score': 0.4909389064830714, 'support': 129580}, '2': {'precision': 0.37999981739995803, 'recall': 0.3141492059658233, 'f1-score': 0.34395104476131844, 'support': 132488}, 'accuracy': 0.3974312881042172, 'macro avg': {'precision': 0.3916780166877956, 'recall': 0.39819822092594004, 'f1-score': 0.3876641057503833, 'support': 392181}, 'weighted avg': {'precision': 0.3915669203280839, 'recall': 0.3974312881042172, 'f1-score': 0.38725902751191804, 'support': 392181}}
[[38052 51314 40747]
 [26227 76192 27161]
 [37560 53307 41621]]
Evaluating performance on  val set...
467/467 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0850999
{'0': {'precision': 0.34829665851670744, 'recall': 0.2715603792288336, 'f1-score': 0.30517866834242624, 'support': 39343}, '1': {'precision': 0.397427323866095, 'recall': 0.5265132761810459, 'f1-score': 0.45295284636680533, 'support': 38377}, '2': {'precision': 0.38216341837004175, 'recall': 0.3473345654417589, 'f1-score': 0.3639175646619472, 'support': 41663}, 'accuracy': 0.3799619711349187, 'macro avg': {'precision': 0.3759624669176147, 'recall': 0.3818027402838795, 'f1-score': 0.37401635979039294, 'support': 119383}, 'weighted avg': {'precision': 0.37590928644432625, 'recall': 0.3799619711349187, 'f1-score': 0.37318138453653926, 'support': 119383}}
[[10684 14826 13833]
 [ 8609 20206  9562]
 [11382 15810 14471]]
training model: results/WBA/W8/deepVOL_L3/h1000
Epoch 1/50
1532/1532 - 54s - loss: 3.2852 - accuracy1000: 0.3757 - val_loss: 3.3041 - val_accuracy1000: 0.3330 - 54s/epoch - 35ms/step
Epoch 2/50
1532/1532 - 50s - loss: 3.2922 - accuracy1000: 0.3508 - val_loss: 3.2954 - val_accuracy1000: 0.3515 - 50s/epoch - 33ms/step
Epoch 3/50
1532/1532 - 50s - loss: 3.2662 - accuracy1000: 0.3788 - val_loss: 3.3073 - val_accuracy1000: 0.3391 - 50s/epoch - 33ms/step
Epoch 4/50
1532/1532 - 49s - loss: 3.2463 - accuracy1000: 0.3919 - val_loss: 3.3278 - val_accuracy1000: 0.3410 - 49s/epoch - 32ms/step
Epoch 5/50
1532/1532 - 50s - loss: 3.2407 - accuracy1000: 0.3940 - val_loss: 3.3245 - val_accuracy1000: 0.3407 - 50s/epoch - 32ms/step
Epoch 6/50
1532/1532 - 51s - loss: 3.2376 - accuracy1000: 0.3969 - val_loss: 3.3222 - val_accuracy1000: 0.3403 - 51s/epoch - 33ms/step
Epoch 7/50
1532/1532 - 52s - loss: 3.2323 - accuracy1000: 0.4012 - val_loss: 3.3194 - val_accuracy1000: 0.3409 - 52s/epoch - 34ms/step
Epoch 8/50
1532/1532 - 51s - loss: 3.2284 - accuracy1000: 0.4036 - val_loss: 3.3280 - val_accuracy1000: 0.3408 - 51s/epoch - 33ms/step
Epoch 9/50
1532/1532 - 51s - loss: 3.2240 - accuracy1000: 0.4053 - val_loss: 3.3097 - val_accuracy1000: 0.3489 - 51s/epoch - 33ms/step
Epoch 10/50
1532/1532 - 51s - loss: 3.2167 - accuracy1000: 0.4098 - val_loss: 3.3048 - val_accuracy1000: 0.3600 - 51s/epoch - 33ms/step
Epoch 11/50
1532/1532 - 50s - loss: 3.2152 - accuracy1000: 0.4086 - val_loss: 3.2974 - val_accuracy1000: 0.3626 - 50s/epoch - 33ms/step
Epoch 12/50
1532/1532 - 51s - loss: 3.2109 - accuracy1000: 0.4104 - val_loss: 3.2955 - val_accuracy1000: 0.3571 - 51s/epoch - 33ms/step
testing model: results/WBA/W8/deepVOL_L3/h1000
Evaluating performance on  test set...
3755/3755 - 52s - 52s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0964004
{'0': {'precision': 0.3503951509911309, 'recall': 0.4928167917381472, 'f1-score': 0.40957819831898107, 'support': 322349}, '1': {'precision': 0.387094071483715, 'recall': 0.5637610800728649, 'f1-score': 0.45901538519766105, 'support': 344199}, '2': {'precision': 0.29263416884514837, 'recall': 0.00645927736198089, 'f1-score': 0.012639563227704754, 'support': 294615}, 'accuracy': 0.36914446353011926, 'macro avg': {'precision': 0.3433744637733314, 'recall': 0.3543457163909977, 'f1-score': 0.2937443822481156, 'support': 961163}, 'weighted avg': {'precision': 0.3458324285181355, 'recall': 0.36914446353011926, 'f1-score': 0.30561264233007845, 'support': 961163}}
[[158859 161394   2096]
 [147649 194046   2504]
 [146863 145849   1903]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0976946
{'0': {'precision': 0.35652502997943614, 'recall': 0.5990668311332102, 'f1-score': 0.44701577864166475, 'support': 130523}, '1': {'precision': 0.37514233058258695, 'recall': 0.4967243054206334, 'f1-score': 0.42745600278211554, 'support': 128675}, '2': {'precision': 0.3242156074014481, 'recall': 0.006060925080649406, 'f1-score': 0.011899401339051738, 'support': 132983}, 'accuracy': 0.3644082706709402, 'macro avg': {'precision': 0.35196098932115705, 'recall': 0.36728402054483095, 'f1-score': 0.29545706092094404, 'support': 392181}, 'weighted avg': {'precision': 0.3516777202230274, 'recall': 0.3644082706709402, 'f1-score': 0.2930564196682293, 'support': 392181}}
[[78192 51547   784]
 [63863 63916   896]
 [77262 54915   806]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988187
{'0': {'precision': 0.33144341051720405, 'recall': 0.6024545025436618, 'f1-score': 0.42762612960567337, 'support': 38134}, '1': {'precision': 0.37938273349347007, 'recall': 0.4642689523997727, 'f1-score': 0.4175553185817115, 'support': 40483}, '2': {'precision': 0.3396584440227704, 'recall': 0.004390913996958249, 'f1-score': 0.00866975032087763, 'support': 40766}, 'accuracy': 0.3513733111079467, 'macro avg': {'precision': 0.3501615293444815, 'recall': 0.35703812298013093, 'f1-score': 0.28461706616942084, 'support': 119383}, 'weighted avg': {'precision': 0.35050493240839536, 'recall': 0.3513733111079467, 'f1-score': 0.2811490566505036, 'support': 119383}}
[[22974 14994   166]
 [21506 18795   182]
 [24835 15752   179]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        23 (peak)  15.36 (ave)

============================================
