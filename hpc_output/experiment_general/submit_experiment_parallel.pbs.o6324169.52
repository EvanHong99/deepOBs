This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/XRAY_orderbooks/XRAY_orderbooks_2019-07-31.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-07-23.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-07-10.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-07-11.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-07-19.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-07-15.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-07-17.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-07-12.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-08-02.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-07-16.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-07-29.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-07-18.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-07-09.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-07-25.csv
data/XRAY_orderbooks/XRAY_orderbooks_2019-07-24.csv
training model: results/XRAY/W5/deepLOB_L1/h10
Epoch 1/50
483/483 - 17s - loss: 3.2455 - accuracy10: 0.3915 - val_loss: 3.3484 - val_accuracy10: 0.3621 - 17s/epoch - 35ms/step
Epoch 2/50
483/483 - 8s - loss: 3.1619 - accuracy10: 0.4219 - val_loss: 3.2562 - val_accuracy10: 0.3994 - 8s/epoch - 17ms/step
Epoch 3/50
483/483 - 8s - loss: 3.1155 - accuracy10: 0.4457 - val_loss: 3.2713 - val_accuracy10: 0.3825 - 8s/epoch - 17ms/step
Epoch 4/50
483/483 - 8s - loss: 3.0868 - accuracy10: 0.4591 - val_loss: 3.2197 - val_accuracy10: 0.4030 - 8s/epoch - 17ms/step
Epoch 5/50
483/483 - 8s - loss: 3.0639 - accuracy10: 0.4701 - val_loss: 3.2413 - val_accuracy10: 0.4109 - 8s/epoch - 16ms/step
Epoch 6/50
483/483 - 8s - loss: 3.0493 - accuracy10: 0.4786 - val_loss: 3.2316 - val_accuracy10: 0.4107 - 8s/epoch - 17ms/step
Epoch 7/50
483/483 - 8s - loss: 3.0424 - accuracy10: 0.4822 - val_loss: 3.2059 - val_accuracy10: 0.4205 - 8s/epoch - 16ms/step
Epoch 8/50
483/483 - 8s - loss: 3.0328 - accuracy10: 0.4870 - val_loss: 3.2090 - val_accuracy10: 0.4228 - 8s/epoch - 17ms/step
Epoch 9/50
483/483 - 8s - loss: 3.0210 - accuracy10: 0.4900 - val_loss: 3.2115 - val_accuracy10: 0.4307 - 8s/epoch - 16ms/step
Epoch 10/50
483/483 - 8s - loss: 3.0139 - accuracy10: 0.4917 - val_loss: 3.2065 - val_accuracy10: 0.4368 - 8s/epoch - 17ms/step
Epoch 11/50
483/483 - 8s - loss: 3.0076 - accuracy10: 0.4937 - val_loss: 3.2115 - val_accuracy10: 0.4409 - 8s/epoch - 16ms/step
Epoch 12/50
483/483 - 8s - loss: 3.0011 - accuracy10: 0.4945 - val_loss: 3.2118 - val_accuracy10: 0.4459 - 8s/epoch - 17ms/step
Epoch 13/50
483/483 - 8s - loss: 2.9951 - accuracy10: 0.4969 - val_loss: 3.2116 - val_accuracy10: 0.4398 - 8s/epoch - 17ms/step
Epoch 14/50
483/483 - 8s - loss: 2.9900 - accuracy10: 0.4976 - val_loss: 3.1990 - val_accuracy10: 0.4489 - 8s/epoch - 16ms/step
Epoch 15/50
483/483 - 8s - loss: 2.9865 - accuracy10: 0.4974 - val_loss: 3.2040 - val_accuracy10: 0.4494 - 8s/epoch - 17ms/step
Epoch 16/50
483/483 - 8s - loss: 2.9861 - accuracy10: 0.4970 - val_loss: 3.1880 - val_accuracy10: 0.4378 - 8s/epoch - 17ms/step
Epoch 17/50
483/483 - 8s - loss: 2.9805 - accuracy10: 0.4987 - val_loss: 3.1907 - val_accuracy10: 0.4480 - 8s/epoch - 17ms/step
Epoch 18/50
483/483 - 8s - loss: 2.9739 - accuracy10: 0.4997 - val_loss: 3.1941 - val_accuracy10: 0.4424 - 8s/epoch - 17ms/step
Epoch 19/50
483/483 - 8s - loss: 2.9671 - accuracy10: 0.5022 - val_loss: 3.1940 - val_accuracy10: 0.4476 - 8s/epoch - 17ms/step
Epoch 20/50
483/483 - 8s - loss: 2.9652 - accuracy10: 0.5027 - val_loss: 3.2017 - val_accuracy10: 0.4450 - 8s/epoch - 17ms/step
Epoch 21/50
483/483 - 9s - loss: 2.9607 - accuracy10: 0.5024 - val_loss: 3.1972 - val_accuracy10: 0.4436 - 9s/epoch - 18ms/step
Epoch 22/50
483/483 - 8s - loss: 2.9542 - accuracy10: 0.5052 - val_loss: 3.2150 - val_accuracy10: 0.4497 - 8s/epoch - 17ms/step
Epoch 23/50
483/483 - 8s - loss: 2.9540 - accuracy10: 0.5055 - val_loss: 3.1987 - val_accuracy10: 0.4467 - 8s/epoch - 17ms/step
Epoch 24/50
483/483 - 8s - loss: 2.9506 - accuracy10: 0.5066 - val_loss: 3.2081 - val_accuracy10: 0.4417 - 8s/epoch - 17ms/step
Epoch 25/50
483/483 - 8s - loss: 2.9486 - accuracy10: 0.5067 - val_loss: 3.2112 - val_accuracy10: 0.4492 - 8s/epoch - 17ms/step
Epoch 26/50
483/483 - 8s - loss: 2.9402 - accuracy10: 0.5108 - val_loss: 3.2125 - val_accuracy10: 0.4460 - 8s/epoch - 17ms/step
testing model: results/XRAY/W5/deepLOB_L1/h10
Evaluating performance on  test set...
2341/2341 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0448372
{'0': {'precision': 0.41417886447795205, 'recall': 0.5228296864216576, 'f1-score': 0.46220497268586047, 'support': 172429}, '1': {'precision': 0.5598254730739239, 'recall': 0.3701812943297305, 'f1-score': 0.4456675488498053, 'support': 254062}, '2': {'precision': 0.41253323596599634, 'recall': 0.5100178248993009, 'f1-score': 0.45612500517576915, 'support': 172792}, 'accuracy': 0.45442136686673906, 'macro avg': {'precision': 0.4621791911726241, 'recall': 0.46767626855022976, 'f1-score': 0.45466584223714496, 'support': 599283}, 'weighted avg': {'precision': 0.475450279204003, 'recall': 0.45442136686673906, 'f1-score': 0.4534409985356851, 'support': 599283}}
[[90151 38843 43435]
 [77951 94049 82062]
 [49560 35105 88127]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9989003
{'0': {'precision': 0.43467072495849474, 'recall': 0.4742912351680203, 'f1-score': 0.4536174759244019, 'support': 33121}, '1': {'precision': 0.6064365945713833, 'recall': 0.47504647251482696, 'f1-score': 0.5327601953698924, 'support': 56485}, '2': {'precision': 0.41974248927038627, 'recall': 0.5339373192468866, 'f1-score': 0.4700029873621592, 'support': 33886}, 'accuracy': 0.4910034658115505, 'macro avg': {'precision': 0.4869499362667548, 'recall': 0.494425008976578, 'f1-score': 0.48546021955215113, 'support': 123492}, 'weighted avg': {'precision': 0.5091398156733328, 'recall': 0.4910034658115505, 'f1-score': 0.4943133586411639, 'support': 123492}}
[[15709  8975  8437]
 [13077 26833 16575]
 [ 7354  8439 18093]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0562893
{'0': {'precision': 0.39783013417217694, 'recall': 0.5333505465186332, 'f1-score': 0.4557287836446536, 'support': 11619}, '1': {'precision': 0.5850993813347374, 'recall': 0.25962268559079493, 'f1-score': 0.35965693017234407, 'support': 17121}, '2': {'precision': 0.4112623285029478, 'recall': 0.5931812763252007, 'f1-score': 0.4857477547832878, 'support': 12583}, 'accuracy': 0.4381579265784188, 'macro avg': {'precision': 0.4647306146699541, 'recall': 0.462051502811543, 'f1-score': 0.4337111562000951, 'support': 41323}, 'weighted avg': {'precision': 0.47950992707042456, 'recall': 0.4381579265784188, 'f1-score': 0.42506504941766193, 'support': 41323}}
[[6197 1639 3783]
 [5774 4445 6902]
 [3606 1513 7464]]
training model: results/XRAY/W5/deepLOB_L1/h20
Epoch 1/50
483/483 - 10s - loss: 3.2778 - accuracy20: 0.3915 - val_loss: 3.2967 - val_accuracy20: 0.3879 - 10s/epoch - 21ms/step
Epoch 2/50
483/483 - 8s - loss: 3.2139 - accuracy20: 0.4165 - val_loss: 3.2636 - val_accuracy20: 0.4096 - 8s/epoch - 17ms/step
Epoch 3/50
483/483 - 8s - loss: 3.1761 - accuracy20: 0.4363 - val_loss: 3.2678 - val_accuracy20: 0.3924 - 8s/epoch - 16ms/step
Epoch 4/50
483/483 - 8s - loss: 3.1501 - accuracy20: 0.4506 - val_loss: 3.2435 - val_accuracy20: 0.4282 - 8s/epoch - 16ms/step
Epoch 5/50
483/483 - 8s - loss: 3.1341 - accuracy20: 0.4583 - val_loss: 3.2070 - val_accuracy20: 0.4376 - 8s/epoch - 17ms/step
Epoch 6/50
483/483 - 8s - loss: 3.1232 - accuracy20: 0.4620 - val_loss: 3.2056 - val_accuracy20: 0.4393 - 8s/epoch - 17ms/step
Epoch 7/50
483/483 - 8s - loss: 3.1119 - accuracy20: 0.4649 - val_loss: 3.2007 - val_accuracy20: 0.4450 - 8s/epoch - 17ms/step
Epoch 8/50
483/483 - 8s - loss: 3.1073 - accuracy20: 0.4679 - val_loss: 3.2004 - val_accuracy20: 0.4450 - 8s/epoch - 17ms/step
Epoch 9/50
483/483 - 8s - loss: 3.1009 - accuracy20: 0.4694 - val_loss: 3.2041 - val_accuracy20: 0.4425 - 8s/epoch - 17ms/step
Epoch 10/50
483/483 - 8s - loss: 3.0934 - accuracy20: 0.4718 - val_loss: 3.2002 - val_accuracy20: 0.4469 - 8s/epoch - 17ms/step
Epoch 11/50
483/483 - 8s - loss: 3.0909 - accuracy20: 0.4731 - val_loss: 3.1876 - val_accuracy20: 0.4448 - 8s/epoch - 17ms/step
Epoch 12/50
483/483 - 8s - loss: 3.0840 - accuracy20: 0.4749 - val_loss: 3.2048 - val_accuracy20: 0.4444 - 8s/epoch - 16ms/step
Epoch 13/50
483/483 - 8s - loss: 3.0802 - accuracy20: 0.4747 - val_loss: 3.2181 - val_accuracy20: 0.4421 - 8s/epoch - 16ms/step
Epoch 14/50
483/483 - 8s - loss: 3.0766 - accuracy20: 0.4755 - val_loss: 3.2075 - val_accuracy20: 0.4432 - 8s/epoch - 17ms/step
Epoch 15/50
483/483 - 8s - loss: 3.0728 - accuracy20: 0.4775 - val_loss: 3.2057 - val_accuracy20: 0.4456 - 8s/epoch - 17ms/step
Epoch 16/50
483/483 - 8s - loss: 3.0669 - accuracy20: 0.4793 - val_loss: 3.2134 - val_accuracy20: 0.4450 - 8s/epoch - 16ms/step
Epoch 17/50
483/483 - 8s - loss: 3.0667 - accuracy20: 0.4791 - val_loss: 3.2078 - val_accuracy20: 0.4461 - 8s/epoch - 16ms/step
Epoch 18/50
483/483 - 8s - loss: 3.0606 - accuracy20: 0.4819 - val_loss: 3.2258 - val_accuracy20: 0.4433 - 8s/epoch - 17ms/step
Epoch 19/50
483/483 - 8s - loss: 3.0549 - accuracy20: 0.4823 - val_loss: 3.2141 - val_accuracy20: 0.4428 - 8s/epoch - 17ms/step
Epoch 20/50
483/483 - 8s - loss: 3.0522 - accuracy20: 0.4836 - val_loss: 3.2119 - val_accuracy20: 0.4441 - 8s/epoch - 16ms/step
Epoch 21/50
483/483 - 8s - loss: 3.0495 - accuracy20: 0.4844 - val_loss: 3.2137 - val_accuracy20: 0.4420 - 8s/epoch - 17ms/step
testing model: results/XRAY/W5/deepLOB_L1/h20
Evaluating performance on  test set...
2341/2341 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0619273
{'0': {'precision': 0.46031828607912223, 'recall': 0.471368796249661, 'f1-score': 0.46577800747966774, 'support': 206488}, '1': {'precision': 0.4449130519983982, 'recall': 0.2798835850654432, 'f1-score': 0.34361047959650326, 'support': 186574}, '2': {'precision': 0.4341384779771434, 'recall': 0.5693939996411617, 'f1-score': 0.4926514086723028, 'support': 206221}, 'accuracy': 0.4454856887313673, 'macro avg': {'precision': 0.4464566053515546, 'recall': 0.4402154603187553, 'f1-score': 0.4340132985828246, 'support': 599283}, 'weighted avg': {'precision': 0.4465133853060731, 'recall': 0.4454856887313673, 'f1-score': 0.4369912328174011, 'support': 599283}}
[[ 97332  33454  75702]
 [ 57009  52219  77346]
 [ 57104  31696 117421]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0358484
{'0': {'precision': 0.47571093437088746, 'recall': 0.41640789341881196, 'f1-score': 0.44408834762171834, 'support': 39932}, '1': {'precision': 0.5032433106717396, 'recall': 0.37776529250649626, 'f1-score': 0.4315686720243906, 'support': 42717}, '2': {'precision': 0.4380577985550361, 'recall': 0.6056851847317778, 'f1-score': 0.5084108308071725, 'support': 40843}, 'accuracy': 0.4656414990444725, 'macro avg': {'precision': 0.47233734786588766, 'recall': 0.46661945688569534, 'f1-score': 0.4613559501510938, 'support': 123492}, 'weighted avg': {'precision': 0.47278146114441677, 'recall': 0.4656414990444725, 'f1-score': 0.46103130909495105, 'support': 123492}}
[[16628  8400 14904]
 [ 9750 16137 16830]
 [ 8576  7529 24738]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0619186
{'0': {'precision': 0.4494091580502216, 'recall': 0.4347981421936406, 'f1-score': 0.44198293081532597, 'support': 13995}, '1': {'precision': 0.45517105780574124, 'recall': 0.186859310678828, 'f1-score': 0.2649499284692418, 'support': 12389}, '2': {'precision': 0.4418205049125435, 'recall': 0.6712631367561417, 'f1-score': 0.5328940376235519, 'support': 14939}, 'accuracy': 0.445950197226726, 'macro avg': {'precision': 0.44880024025616877, 'recall': 0.4309735298762034, 'f1-score': 0.41327563230270653, 'support': 41323}, 'weighted avg': {'precision': 0.44839319325694327, 'recall': 0.445950197226726, 'f1-score': 0.42177285793926306, 'support': 41323}}
[[ 6085  1411  6499]
 [ 3904  2315  6170]
 [ 3551  1360 10028]]
training model: results/XRAY/W5/deepLOB_L1/h30
Epoch 1/50
483/483 - 10s - loss: 3.2960 - accuracy30: 0.3786 - val_loss: 3.2892 - val_accuracy30: 0.3806 - 10s/epoch - 21ms/step
Epoch 2/50
483/483 - 8s - loss: 3.2305 - accuracy30: 0.4055 - val_loss: 3.2693 - val_accuracy30: 0.4027 - 8s/epoch - 17ms/step
Epoch 3/50
483/483 - 8s - loss: 3.2152 - accuracy30: 0.4152 - val_loss: 3.2621 - val_accuracy30: 0.3948 - 8s/epoch - 16ms/step
Epoch 4/50
483/483 - 8s - loss: 3.1972 - accuracy30: 0.4241 - val_loss: 3.2618 - val_accuracy30: 0.4053 - 8s/epoch - 17ms/step
Epoch 5/50
483/483 - 8s - loss: 3.1880 - accuracy30: 0.4293 - val_loss: 3.2488 - val_accuracy30: 0.4150 - 8s/epoch - 17ms/step
Epoch 6/50
483/483 - 8s - loss: 3.1739 - accuracy30: 0.4354 - val_loss: 3.2382 - val_accuracy30: 0.4223 - 8s/epoch - 17ms/step
Epoch 7/50
483/483 - 8s - loss: 3.1674 - accuracy30: 0.4405 - val_loss: 3.2246 - val_accuracy30: 0.4258 - 8s/epoch - 16ms/step
Epoch 8/50
483/483 - 8s - loss: 3.1552 - accuracy30: 0.4456 - val_loss: 3.2345 - val_accuracy30: 0.4247 - 8s/epoch - 17ms/step
Epoch 9/50
483/483 - 8s - loss: 3.1479 - accuracy30: 0.4481 - val_loss: 3.2248 - val_accuracy30: 0.4301 - 8s/epoch - 16ms/step
Epoch 10/50
483/483 - 8s - loss: 3.1414 - accuracy30: 0.4500 - val_loss: 3.2366 - val_accuracy30: 0.4246 - 8s/epoch - 17ms/step
Epoch 11/50
483/483 - 8s - loss: 3.1359 - accuracy30: 0.4510 - val_loss: 3.2374 - val_accuracy30: 0.4299 - 8s/epoch - 17ms/step
Epoch 12/50
483/483 - 8s - loss: 3.1279 - accuracy30: 0.4544 - val_loss: 3.2370 - val_accuracy30: 0.4287 - 8s/epoch - 16ms/step
Epoch 13/50
483/483 - 8s - loss: 3.1233 - accuracy30: 0.4565 - val_loss: 3.2304 - val_accuracy30: 0.4308 - 8s/epoch - 17ms/step
Epoch 14/50
483/483 - 8s - loss: 3.1188 - accuracy30: 0.4576 - val_loss: 3.2247 - val_accuracy30: 0.4275 - 8s/epoch - 17ms/step
Epoch 15/50
483/483 - 8s - loss: 3.1138 - accuracy30: 0.4594 - val_loss: 3.2281 - val_accuracy30: 0.4288 - 8s/epoch - 16ms/step
Epoch 16/50
483/483 - 8s - loss: 3.1082 - accuracy30: 0.4606 - val_loss: 3.2271 - val_accuracy30: 0.4294 - 8s/epoch - 16ms/step
Epoch 17/50
483/483 - 8s - loss: 3.1017 - accuracy30: 0.4626 - val_loss: 3.2307 - val_accuracy30: 0.4278 - 8s/epoch - 17ms/step
testing model: results/XRAY/W5/deepLOB_L1/h30
Evaluating performance on  test set...
2341/2341 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0733777
{'0': {'precision': 0.44343788126519873, 'recall': 0.49915217421768804, 'f1-score': 0.46964845698614005, 'support': 214077}, '1': {'precision': 0.36904530849022016, 'recall': 0.2993964134713515, 'f1-score': 0.33059229590325445, 'support': 171475}, '2': {'precision': 0.44258106899760946, 'recall': 0.4538976563998671, 'f1-score': 0.44816793593377174, 'support': 213731}, 'accuracy': 0.4258555640657252, 'macro avg': {'precision': 0.4183547529176761, 'recall': 0.4174820813629689, 'f1-score': 0.41613622960772206, 'support': 599283}, 'weighted avg': {'precision': 0.42184608947508695, 'recall': 0.4258555640657252, 'f1-score': 0.42219890732974813, 'support': 599283}}
[[106857  42977  64243]
 [ 62195  51339  57941]
 [ 71922  44797  97012]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0601063
{'0': {'precision': 0.4231497436552003, 'recall': 0.48652284512278643, 'f1-score': 0.45262882433923834, 'support': 40884}, '1': {'precision': 0.4591263051297273, 'recall': 0.3174695158758904, 'f1-score': 0.3753782904128362, 'support': 41415}, '2': {'precision': 0.4314286908543722, 'recall': 0.5011288325686403, 'f1-score': 0.4636740378028099, 'support': 41193}, 'accuracy': 0.43470022349625886, 'macro avg': {'precision': 0.4379015798797666, 'recall': 0.43504039785577236, 'f1-score': 0.43056038418496145, 'support': 123492}, 'weighted avg': {'precision': 0.4379766471424143, 'recall': 0.43470022349625886, 'f1-score': 0.4304059646855196, 'support': 123492}}
[[19891  7918 13075]
 [14137 13148 14130]
 [12979  7571 20643]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0742434
{'0': {'precision': 0.4159214957612356, 'recall': 0.49989531718891755, 'f1-score': 0.4540585084466419, 'support': 14329}, '1': {'precision': 0.39955703211517163, 'recall': 0.1513803809683645, 'f1-score': 0.21957156767283348, 'support': 11917}, '2': {'precision': 0.43868069028898193, 'recall': 0.5698746434967169, 'f1-score': 0.4957447422323515, 'support': 15077}, 'accuracy': 0.42492074631561116, 'macro avg': {'precision': 0.41805307272179637, 'recall': 0.40705011388466633, 'f1-score': 0.38979160611727565, 'support': 41323}, 'weighted avg': {'precision': 0.4195060627729406, 'recall': 0.42492074631561116, 'f1-score': 0.401645142369292, 'support': 41323}}
[[7163 1381 5785]
 [4904 1804 5209]
 [5155 1330 8592]]
training model: results/XRAY/W5/deepLOB_L1/h50
Epoch 1/50
483/483 - 11s - loss: 3.3047 - accuracy50: 0.3692 - val_loss: 3.3208 - val_accuracy50: 0.3737 - 11s/epoch - 22ms/step
Epoch 2/50
483/483 - 8s - loss: 3.2575 - accuracy50: 0.3932 - val_loss: 3.3397 - val_accuracy50: 0.3828 - 8s/epoch - 17ms/step
Epoch 3/50
483/483 - 8s - loss: 3.2479 - accuracy50: 0.3978 - val_loss: 3.2903 - val_accuracy50: 0.3894 - 8s/epoch - 17ms/step
Epoch 4/50
483/483 - 8s - loss: 3.2330 - accuracy50: 0.4050 - val_loss: 3.2948 - val_accuracy50: 0.3911 - 8s/epoch - 16ms/step
Epoch 5/50
483/483 - 8s - loss: 3.2259 - accuracy50: 0.4083 - val_loss: 3.2886 - val_accuracy50: 0.3927 - 8s/epoch - 17ms/step
Epoch 6/50
483/483 - 8s - loss: 3.2172 - accuracy50: 0.4135 - val_loss: 3.2753 - val_accuracy50: 0.3893 - 8s/epoch - 17ms/step
Epoch 7/50
483/483 - 8s - loss: 3.2133 - accuracy50: 0.4123 - val_loss: 3.3083 - val_accuracy50: 0.3898 - 8s/epoch - 16ms/step
Epoch 8/50
483/483 - 8s - loss: 3.2070 - accuracy50: 0.4181 - val_loss: 3.2977 - val_accuracy50: 0.3896 - 8s/epoch - 16ms/step
Epoch 9/50
483/483 - 8s - loss: 3.1992 - accuracy50: 0.4201 - val_loss: 3.2911 - val_accuracy50: 0.3890 - 8s/epoch - 17ms/step
Epoch 10/50
483/483 - 8s - loss: 3.1987 - accuracy50: 0.4204 - val_loss: 3.3015 - val_accuracy50: 0.3905 - 8s/epoch - 16ms/step
Epoch 11/50
483/483 - 8s - loss: 3.1936 - accuracy50: 0.4234 - val_loss: 3.3029 - val_accuracy50: 0.3915 - 8s/epoch - 16ms/step
Epoch 12/50
483/483 - 8s - loss: 3.1871 - accuracy50: 0.4256 - val_loss: 3.3166 - val_accuracy50: 0.3886 - 8s/epoch - 16ms/step
Epoch 13/50
483/483 - 8s - loss: 3.1838 - accuracy50: 0.4286 - val_loss: 3.3006 - val_accuracy50: 0.3893 - 8s/epoch - 17ms/step
Epoch 14/50
483/483 - 8s - loss: 3.1819 - accuracy50: 0.4261 - val_loss: 3.2800 - val_accuracy50: 0.3977 - 8s/epoch - 16ms/step
Epoch 15/50
483/483 - 8s - loss: 3.1778 - accuracy50: 0.4280 - val_loss: 3.2826 - val_accuracy50: 0.3985 - 8s/epoch - 17ms/step
Epoch 16/50
483/483 - 8s - loss: 3.1747 - accuracy50: 0.4304 - val_loss: 3.2773 - val_accuracy50: 0.4018 - 8s/epoch - 17ms/step
testing model: results/XRAY/W5/deepLOB_L1/h50
Evaluating performance on  test set...
2341/2341 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0894065
{'0': {'precision': 0.4255269057696115, 'recall': 0.37832463572315433, 'f1-score': 0.4005399089407309, 'support': 210211}, '1': {'precision': 0.32430899761713916, 'recall': 0.33285763055243084, 'f1-score': 0.32852771241396833, 'support': 178683}, '2': {'precision': 0.40825425660598175, 'recall': 0.44436258549639, 'f1-score': 0.42554382706777183, 'support': 210389}, 'accuracy': 0.38795193589672994, 'macro avg': {'precision': 0.38603005333091084, 'recall': 0.385181617257325, 'f1-score': 0.3848704828074903, 'support': 599283}, 'weighted avg': {'precision': 0.38928377044407236, 'recall': 0.38795193589672994, 'f1-score': 0.38784673062403996, 'support': 599283}}
[[79528 60685 69998]
 [53697 59476 65510]
 [53668 63232 93489]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0837033
{'0': {'precision': 0.4282661557733402, 'recall': 0.2801031350153016, 'f1-score': 0.33868970440407337, 'support': 41499}, '1': {'precision': 0.38421893366285903, 'recall': 0.3135113865525552, 'f1-score': 0.3452824311696754, 'support': 40662}, '2': {'precision': 0.3836570578271675, 'recall': 0.5863879412547482, 'f1-score': 0.463838012669614, 'support': 41331}, 'accuracy': 0.3936125417031063, 'macro avg': {'precision': 0.39871404908778896, 'recall': 0.3933341542742017, 'f1-score': 0.38260338274778755, 'support': 123492}, 'weighted avg': {'precision': 0.3988327773142526, 'recall': 0.3936125417031063, 'f1-score': 0.38274582289487413, 'support': 123492}}
[[11624 10295 19580]
 [ 8559 12748 19355]
 [ 6959 10136 24236]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0927792
{'0': {'precision': 0.4160510069830989, 'recall': 0.2845573475462034, 'f1-score': 0.3379644853666557, 'support': 14447}, '1': {'precision': 0.3346122225267196, 'recall': 0.20314449713002247, 'f1-score': 0.2528081163621305, 'support': 12021}, '2': {'precision': 0.3937624254473161, 'recall': 0.6399865365196903, 'f1-score': 0.4875509628452012, 'support': 14855}, 'accuracy': 0.38864554848389515, 'macro avg': {'precision': 0.3814752183190449, 'recall': 0.3758961270653054, 'f1-score': 0.35944118819132914, 'support': 41323}, 'weighted avg': {'precision': 0.38434777859541674, 'recall': 0.38864554848389515, 'f1-score': 0.3669663102859596, 'support': 41323}}
[[4111 2381 7955]
 [2897 2442 6682]
 [2873 2475 9507]]
training model: results/XRAY/W5/deepLOB_L1/h100
Epoch 1/50
483/483 - 10s - loss: 3.3203 - accuracy100: 0.3625 - val_loss: 3.4172 - val_accuracy100: 0.3138 - 10s/epoch - 21ms/step
Epoch 2/50
483/483 - 8s - loss: 3.2834 - accuracy100: 0.3711 - val_loss: 3.3300 - val_accuracy100: 0.3431 - 8s/epoch - 17ms/step
Epoch 3/50
483/483 - 8s - loss: 3.2722 - accuracy100: 0.3765 - val_loss: 3.3224 - val_accuracy100: 0.3326 - 8s/epoch - 17ms/step
Epoch 4/50
483/483 - 8s - loss: 3.2607 - accuracy100: 0.3859 - val_loss: 3.3123 - val_accuracy100: 0.3482 - 8s/epoch - 17ms/step
Epoch 5/50
483/483 - 8s - loss: 3.2548 - accuracy100: 0.3877 - val_loss: 3.3099 - val_accuracy100: 0.3512 - 8s/epoch - 17ms/step
Epoch 6/50
483/483 - 8s - loss: 3.2509 - accuracy100: 0.3892 - val_loss: 3.3042 - val_accuracy100: 0.3515 - 8s/epoch - 16ms/step
Epoch 7/50
483/483 - 8s - loss: 3.2420 - accuracy100: 0.3935 - val_loss: 3.3030 - val_accuracy100: 0.3565 - 8s/epoch - 17ms/step
Epoch 8/50
483/483 - 8s - loss: 3.2336 - accuracy100: 0.3962 - val_loss: 3.2990 - val_accuracy100: 0.3584 - 8s/epoch - 17ms/step
Epoch 9/50
483/483 - 8s - loss: 3.2304 - accuracy100: 0.3988 - val_loss: 3.3173 - val_accuracy100: 0.3559 - 8s/epoch - 17ms/step
Epoch 10/50
483/483 - 8s - loss: 3.2266 - accuracy100: 0.4007 - val_loss: 3.2999 - val_accuracy100: 0.3506 - 8s/epoch - 16ms/step
Epoch 11/50
483/483 - 8s - loss: 3.2246 - accuracy100: 0.4002 - val_loss: 3.3212 - val_accuracy100: 0.3567 - 8s/epoch - 17ms/step
Epoch 12/50
483/483 - 8s - loss: 3.2186 - accuracy100: 0.4046 - val_loss: 3.3240 - val_accuracy100: 0.3552 - 8s/epoch - 17ms/step
Epoch 13/50
483/483 - 8s - loss: 3.2139 - accuracy100: 0.4067 - val_loss: 3.3397 - val_accuracy100: 0.3515 - 8s/epoch - 17ms/step
Epoch 14/50
483/483 - 8s - loss: 3.2128 - accuracy100: 0.4076 - val_loss: 3.3328 - val_accuracy100: 0.3536 - 8s/epoch - 17ms/step
Epoch 15/50
483/483 - 8s - loss: 3.2098 - accuracy100: 0.4097 - val_loss: 3.3350 - val_accuracy100: 0.3485 - 8s/epoch - 17ms/step
Epoch 16/50
483/483 - 8s - loss: 3.2085 - accuracy100: 0.4101 - val_loss: 3.3352 - val_accuracy100: 0.3510 - 8s/epoch - 16ms/step
Epoch 17/50
483/483 - 8s - loss: 3.2030 - accuracy100: 0.4124 - val_loss: 3.3559 - val_accuracy100: 0.3490 - 8s/epoch - 17ms/step
Epoch 18/50
483/483 - 8s - loss: 3.2038 - accuracy100: 0.4126 - val_loss: 3.3651 - val_accuracy100: 0.3477 - 8s/epoch - 16ms/step
testing model: results/XRAY/W5/deepLOB_L1/h100
Evaluating performance on  test set...
2341/2341 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1029457
{'0': {'precision': 0.36513155431062244, 'recall': 0.2338449731389102, 'f1-score': 0.2851002488311369, 'support': 208480}, '1': {'precision': 0.3153863955609853, 'recall': 0.32726653337949985, 'f1-score': 0.3212166558408634, 'support': 179062}, '2': {'precision': 0.374168175827002, 'recall': 0.49471288035855127, 'f1-score': 0.4260786092276153, 'support': 211741}, 'accuracy': 0.3539296125536683, 'macro avg': {'precision': 0.3515620418995366, 'recall': 0.35194146229232043, 'f1-score': 0.3441318379665385, 'support': 599283}, 'weighted avg': {'precision': 0.3534608672737337, 'recall': 0.3539296125536683, 'f1-score': 0.34570262714102784, 'support': 599283}}
[[ 48752  63508  96220]
 [ 41475  58601  78986]
 [ 43292  63698 104751]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0938053
{'0': {'precision': 0.3656939702207047, 'recall': 0.2514157107594018, 'f1-score': 0.29797364156544437, 'support': 41322}, '1': {'precision': 0.3707758533030539, 'recall': 0.2656128593628594, 'f1-score': 0.30950528385700343, 'support': 41184}, '2': {'precision': 0.35442207990240926, 'recall': 0.5670960815888352, 'f1-score': 0.43621793067207176, 'support': 40986}, 'accuracy': 0.3609221649985424, 'macro avg': {'precision': 0.36363063447538924, 'recall': 0.36137488390369876, 'f1-score': 0.3478989520315065, 'support': 123492}, 'weighted avg': {'precision': 0.36364770468348623, 'recall': 0.3609221649985424, 'f1-score': 0.34770155583891793, 'support': 123492}}
[[10389  9769 21164]
 [ 9072 10939 21173]
 [ 8948  8795 23243]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1001467
{'0': {'precision': 0.3696527702187874, 'recall': 0.23124063734168596, 'f1-score': 0.2845055083148326, 'support': 14686}, '1': {'precision': 0.31704225352112675, 'recall': 0.1866346074123207, 'f1-score': 0.23495642189864832, 'support': 12061}, '2': {'precision': 0.36591308515737336, 'recall': 0.6284989023051591, 'f1-score': 0.4625366050691709, 'support': 14576}, 'accuracy': 0.3583476514289863, 'macro avg': {'precision': 0.35086936963242915, 'recall': 0.3487913823530553, 'f1-score': 0.3273328450942173, 'support': 41323}, 'weighted avg': {'precision': 0.3529781558068218, 'recall': 0.3583476514289863, 'f1-score': 0.3328410535324024, 'support': 41323}}
[[3396 2583 8707]
 [2642 2251 7168]
 [3149 2266 9161]]
training model: results/XRAY/W5/deepLOB_L1/h200
Epoch 1/50
483/483 - 10s - loss: 3.3148 - accuracy200: 0.3714 - val_loss: 3.3713 - val_accuracy200: 0.3404 - 10s/epoch - 21ms/step
Epoch 2/50
483/483 - 8s - loss: 3.2827 - accuracy200: 0.3817 - val_loss: 3.3389 - val_accuracy200: 0.3290 - 8s/epoch - 16ms/step
Epoch 3/50
483/483 - 8s - loss: 3.2816 - accuracy200: 0.3795 - val_loss: 3.3654 - val_accuracy200: 0.3399 - 8s/epoch - 16ms/step
Epoch 4/50
483/483 - 8s - loss: 3.2698 - accuracy200: 0.3881 - val_loss: 3.3280 - val_accuracy200: 0.3517 - 8s/epoch - 16ms/step
Epoch 5/50
483/483 - 8s - loss: 3.2613 - accuracy200: 0.3907 - val_loss: 3.3413 - val_accuracy200: 0.3509 - 8s/epoch - 16ms/step
Epoch 6/50
483/483 - 8s - loss: 3.2529 - accuracy200: 0.3928 - val_loss: 3.3137 - val_accuracy200: 0.3554 - 8s/epoch - 16ms/step
Epoch 7/50
483/483 - 8s - loss: 3.2465 - accuracy200: 0.3967 - val_loss: 3.3323 - val_accuracy200: 0.3557 - 8s/epoch - 16ms/step
Epoch 8/50
483/483 - 8s - loss: 3.2402 - accuracy200: 0.4021 - val_loss: 3.3197 - val_accuracy200: 0.3548 - 8s/epoch - 16ms/step
Epoch 9/50
483/483 - 8s - loss: 3.2284 - accuracy200: 0.4067 - val_loss: 3.3326 - val_accuracy200: 0.3569 - 8s/epoch - 16ms/step
Epoch 10/50
483/483 - 8s - loss: 3.2224 - accuracy200: 0.4086 - val_loss: 3.3314 - val_accuracy200: 0.3561 - 8s/epoch - 16ms/step
Epoch 11/50
483/483 - 8s - loss: 3.2106 - accuracy200: 0.4147 - val_loss: 3.3652 - val_accuracy200: 0.3555 - 8s/epoch - 16ms/step
Epoch 12/50
483/483 - 8s - loss: 3.2123 - accuracy200: 0.4127 - val_loss: 3.3595 - val_accuracy200: 0.3557 - 8s/epoch - 16ms/step
Epoch 13/50
483/483 - 8s - loss: 3.2080 - accuracy200: 0.4137 - val_loss: 3.3762 - val_accuracy200: 0.3556 - 8s/epoch - 17ms/step
Epoch 14/50
483/483 - 8s - loss: 3.2006 - accuracy200: 0.4176 - val_loss: 3.3735 - val_accuracy200: 0.3549 - 8s/epoch - 16ms/step
Epoch 15/50
483/483 - 8s - loss: 3.1964 - accuracy200: 0.4190 - val_loss: 3.3879 - val_accuracy200: 0.3553 - 8s/epoch - 17ms/step
Epoch 16/50
483/483 - 8s - loss: 3.1923 - accuracy200: 0.4200 - val_loss: 3.3991 - val_accuracy200: 0.3532 - 8s/epoch - 16ms/step
testing model: results/XRAY/W5/deepLOB_L1/h200
Evaluating performance on  test set...
2341/2341 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.09474
{'0': {'precision': 0.34277794362232933, 'recall': 0.18492410054894237, 'f1-score': 0.2402412634649642, 'support': 217327}, '1': {'precision': 0.29368657631274264, 'recall': 0.14142719395485823, 'f1-score': 0.19091681867285318, 'support': 152453}, '2': {'precision': 0.38549469804685493, 'recall': 0.6863613983259478, 'f1-score': 0.4937018707904081, 'support': 229503}, 'accuracy': 0.36589057256755153, 'macro avg': {'precision': 0.3406530726606423, 'recall': 0.3375708976099161, 'f1-score': 0.30828665097607516, 'support': 599283}, 'weighted avg': {'precision': 0.3466483972648379, 'recall': 0.36589057256755153, 'f1-score': 0.32475944632868575, 'support': 599283}}
[[ 40189  24587 152551]
 [ 32342  21561  98550]
 [ 44714  27267 157522]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1154724
{'0': {'precision': 0.3446262715612561, 'recall': 0.09414721376443864, 'f1-score': 0.1478922694402794, 'support': 41382}, '1': {'precision': 0.3821029082774049, 'recall': 0.06289586095153925, 'f1-score': 0.10801239486498448, 'support': 40734}, '2': {'precision': 0.33970724863009805, 'recall': 0.8660334493426141, 'f1-score': 0.48799520625366, 'support': 41376}, 'accuracy': 0.34245943057040135, 'macro avg': {'precision': 0.3554788094895864, 'recall': 0.34102550801953063, 'f1-score': 0.2479666235196413, 'support': 123492}, 'weighted avg': {'precision': 0.3553398710429716, 'recall': 0.34245943057040135, 'f1-score': 0.2486893437660687, 'support': 123492}}
[[ 3896  2196 35290]
 [ 3813  2562 34359]
 [ 3596  1947 35833]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1042567
{'0': {'precision': 0.36578272027373826, 'recall': 0.14133668275269387, 'f1-score': 0.20389090215525466, 'support': 15127}, '1': {'precision': 0.29557428872497366, 'recall': 0.04937511001584228, 'f1-score': 0.08461538461538462, 'support': 11362}, '2': {'precision': 0.3601548540798094, 'recall': 0.8152892004853715, 'f1-score': 0.49960755153468, 'support': 14834}, 'accuracy': 0.3579846574546863, 'macro avg': {'precision': 0.34050395435950714, 'recall': 0.3353336644179692, 'f1-score': 0.26270461276843976, 'support': 41323}, 'weighted avg': {'precision': 0.344458228673956, 'recall': 0.3579846574546863, 'f1-score': 0.27725083116830773, 'support': 41323}}
[[ 2138   664 12325]
 [ 1640   561  9161]
 [ 2067   673 12094]]
training model: results/XRAY/W5/deepLOB_L1/h300
Epoch 1/50
483/483 - 10s - loss: 3.3078 - accuracy300: 0.3691 - val_loss: 3.3727 - val_accuracy300: 0.3336 - 10s/epoch - 21ms/step
Epoch 2/50
483/483 - 8s - loss: 3.2803 - accuracy300: 0.3786 - val_loss: 3.3593 - val_accuracy300: 0.3485 - 8s/epoch - 17ms/step
Epoch 3/50
483/483 - 8s - loss: 3.2607 - accuracy300: 0.3833 - val_loss: 3.4554 - val_accuracy300: 0.3511 - 8s/epoch - 17ms/step
Epoch 4/50
483/483 - 8s - loss: 3.2555 - accuracy300: 0.3892 - val_loss: 3.3446 - val_accuracy300: 0.3518 - 8s/epoch - 17ms/step
Epoch 5/50
483/483 - 8s - loss: 3.2486 - accuracy300: 0.3961 - val_loss: 3.4183 - val_accuracy300: 0.3456 - 8s/epoch - 16ms/step
Epoch 6/50
483/483 - 8s - loss: 3.2329 - accuracy300: 0.4021 - val_loss: 3.5029 - val_accuracy300: 0.3482 - 8s/epoch - 16ms/step
Epoch 7/50
483/483 - 8s - loss: 3.2349 - accuracy300: 0.4017 - val_loss: 3.4358 - val_accuracy300: 0.3469 - 8s/epoch - 16ms/step
Epoch 8/50
483/483 - 8s - loss: 3.2245 - accuracy300: 0.4061 - val_loss: 3.4804 - val_accuracy300: 0.3423 - 8s/epoch - 17ms/step
Epoch 9/50
483/483 - 8s - loss: 3.2102 - accuracy300: 0.4135 - val_loss: 3.4746 - val_accuracy300: 0.3458 - 8s/epoch - 17ms/step
Epoch 10/50
483/483 - 8s - loss: 3.2082 - accuracy300: 0.4141 - val_loss: 3.4728 - val_accuracy300: 0.3381 - 8s/epoch - 16ms/step
Epoch 11/50
483/483 - 8s - loss: 3.1989 - accuracy300: 0.4207 - val_loss: 3.4681 - val_accuracy300: 0.3477 - 8s/epoch - 16ms/step
Epoch 12/50
483/483 - 8s - loss: 3.1905 - accuracy300: 0.4229 - val_loss: 3.4598 - val_accuracy300: 0.3481 - 8s/epoch - 16ms/step
Epoch 13/50
483/483 - 8s - loss: 3.1867 - accuracy300: 0.4254 - val_loss: 3.4360 - val_accuracy300: 0.3482 - 8s/epoch - 17ms/step
Epoch 14/50
483/483 - 8s - loss: 3.1747 - accuracy300: 0.4297 - val_loss: 3.4361 - val_accuracy300: 0.3472 - 8s/epoch - 17ms/step
testing model: results/XRAY/W5/deepLOB_L1/h300
Evaluating performance on  test set...
2341/2341 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1083409
{'0': {'precision': 0.3738569240866331, 'recall': 0.14891531198668484, 'f1-score': 0.2129914966675287, 'support': 229513}, '1': {'precision': 0.21619186947341112, 'recall': 0.24443883121750892, 'f1-score': 0.2294492651642338, 'support': 122726}, '2': {'precision': 0.41238194320269195, 'recall': 0.6161291106037791, 'f1-score': 0.4940744563788453, 'support': 247044}, 'accuracy': 0.3610781550619657, 'macro avg': {'precision': 0.334143578920912, 'recall': 0.33649441793599094, 'f1-score': 0.31217173940353593, 'support': 599283}, 'weighted avg': {'precision': 0.3574502736894841, 'recall': 0.3610781550619657, 'f1-score': 0.33223341541951923, 'support': 599283}}
[[ 34178  52258 143077]
 [ 18913  29999  73814]
 [ 38329  56504 152211]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1099278
{'0': {'precision': 0.36064782908339077, 'recall': 0.12658748397397132, 'f1-score': 0.1873981629035435, 'support': 41339}, '1': {'precision': 0.3952153549453577, 'recall': 0.20892297982862829, 'f1-score': 0.27334656609765784, 'support': 41197}, '2': {'precision': 0.33871152699417456, 'recall': 0.7211885926359997, 'f1-score': 0.46093945068664166, 'support': 40956}, 'accuracy': 0.35125352249538433, 'macro avg': {'precision': 0.364858237007641, 'recall': 0.3522330188128664, 'f1-score': 0.30722805989594765, 'support': 123492}, 'weighted avg': {'precision': 0.36490442201709916, 'recall': 0.35125352249538433, 'f1-score': 0.3067902963926156, 'support': 123492}}
[[ 5233  6813 29293]
 [ 4216  8607 28374]
 [ 5061  6358 29537]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1146709
{'0': {'precision': 0.3588423701670098, 'recall': 0.20787224173348354, 'f1-score': 0.26324843704107753, 'support': 15091}, '1': {'precision': 0.33133218982275586, 'recall': 0.09886547811993517, 'f1-score': 0.15228959989488206, 'support': 11723}, '2': {'precision': 0.35494962692982157, 'recall': 0.7114894203597767, 'f1-score': 0.4736190126628739, 'support': 14509}, 'accuracy': 0.35377392735280594, 'macro avg': {'precision': 0.34837472897319577, 'recall': 0.33940904673773176, 'f1-score': 0.29638568319961117, 'support': 41323}, 'weighted avg': {'precision': 0.34967116633853523, 'recall': 0.35377392735280594, 'f1-score': 0.3056339423004196, 'support': 41323}}
[[ 3137  1148 10806]
 [ 2610  1159  7954]
 [ 2995  1191 10323]]
training model: results/XRAY/W5/deepLOB_L1/h500
Epoch 1/50
483/483 - 10s - loss: 3.3196 - accuracy500: 0.3652 - val_loss: 3.4640 - val_accuracy500: 0.3139 - 10s/epoch - 21ms/step
Epoch 2/50
483/483 - 8s - loss: 3.2880 - accuracy500: 0.3784 - val_loss: 3.5264 - val_accuracy500: 0.3306 - 8s/epoch - 16ms/step
Epoch 3/50
483/483 - 8s - loss: 3.2642 - accuracy500: 0.3914 - val_loss: 3.4796 - val_accuracy500: 0.3266 - 8s/epoch - 16ms/step
Epoch 4/50
483/483 - 8s - loss: 3.2489 - accuracy500: 0.4026 - val_loss: 3.4753 - val_accuracy500: 0.3354 - 8s/epoch - 17ms/step
Epoch 5/50
483/483 - 8s - loss: 3.2215 - accuracy500: 0.4141 - val_loss: 3.4912 - val_accuracy500: 0.3410 - 8s/epoch - 16ms/step
Epoch 6/50
483/483 - 8s - loss: 3.2088 - accuracy500: 0.4230 - val_loss: 3.6317 - val_accuracy500: 0.3427 - 8s/epoch - 17ms/step
Epoch 7/50
483/483 - 8s - loss: 3.2053 - accuracy500: 0.4235 - val_loss: 3.7416 - val_accuracy500: 0.3429 - 8s/epoch - 17ms/step
Epoch 8/50
483/483 - 8s - loss: 3.1978 - accuracy500: 0.4255 - val_loss: 3.6590 - val_accuracy500: 0.3391 - 8s/epoch - 17ms/step
Epoch 9/50
483/483 - 8s - loss: 3.1892 - accuracy500: 0.4321 - val_loss: 3.7095 - val_accuracy500: 0.3410 - 8s/epoch - 17ms/step
Epoch 10/50
483/483 - 8s - loss: 3.1820 - accuracy500: 0.4313 - val_loss: 3.7121 - val_accuracy500: 0.3413 - 8s/epoch - 16ms/step
Epoch 11/50
483/483 - 8s - loss: 3.1725 - accuracy500: 0.4348 - val_loss: 3.6544 - val_accuracy500: 0.3406 - 8s/epoch - 17ms/step
testing model: results/XRAY/W5/deepLOB_L1/h500
Evaluating performance on  test set...
2341/2341 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1666433
{'0': {'precision': 0.3435552640209905, 'recall': 0.00971251871804025, 'f1-score': 0.018890977867348367, 'support': 215701}, '1': {'precision': 0.2624590085770745, 'recall': 0.647499738603095, 'f1-score': 0.3735161400982392, 'support': 153024}, '2': {'precision': 0.38124516036296696, 'recall': 0.35662176111867727, 'f1-score': 0.3685226063084766, 'support': 230558}, 'accuracy': 0.30603237535521616, 'macro avg': {'precision': 0.3290864776536773, 'recall': 0.33794467281327084, 'f1-score': 0.2536432414246881, 'support': 599283}, 'weighted avg': {'precision': 0.33734790243683677, 'recall': 0.30603237535521616, 'f1-score': 0.24395414471064192, 'support': 599283}}
[[  2095 132506  81100]
 [  1596  99083  52345]
 [  2407 145929  82222]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1429634
{'0': {'precision': 0.38045977011494253, 'recall': 0.02356598713719534, 'f1-score': 0.044382863655664066, 'support': 42137}, '1': {'precision': 0.335514233241506, 'recall': 0.5917902515564104, 'f1-score': 0.42823917223697466, 'support': 39514}, '2': {'precision': 0.3532411206189192, 'recall': 0.43213594321359433, 'f1-score': 0.38872585378438523, 'support': 41841}, 'accuracy': 0.34381174489035726, 'macro avg': {'precision': 0.3564050413251226, 'recall': 0.34916406063573335, 'f1-score': 0.2871159632256746, 'support': 123492}, 'weighted avg': {'precision': 0.3568563508037314, 'recall': 0.34381174489035726, 'f1-score': 0.2838749216615084, 'support': 123492}}
[[  993 23451 17693]
 [  718 23384 15412]
 [  899 22861 18081]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1587259
{'0': {'precision': 0.3698224852071006, 'recall': 0.024677546722821794, 'f1-score': 0.04626773596545342, 'support': 15196}, '1': {'precision': 0.2846366236071393, 'recall': 0.4969013599586848, 'f1-score': 0.3619435736677116, 'support': 11618}, '2': {'precision': 0.3415888550456883, 'recall': 0.47150044799779445, 'f1-score': 0.3961663192031503, 'support': 14509}, 'accuracy': 0.3143285821455364, 'macro avg': {'precision': 0.3320159879533094, 'recall': 0.331026451559767, 'f1-score': 0.26812587627877177, 'support': 41323}, 'weighted avg': {'precision': 0.3359592351991079, 'recall': 0.3143285821455364, 'f1-score': 0.2578738736277863, 'support': 41323}}
[[ 375 7224 7597]
 [ 256 5773 5589]
 [ 383 7285 6841]]
training model: results/XRAY/W5/deepLOB_L1/h1000
Epoch 1/50
483/483 - 10s - loss: 3.2985 - accuracy1000: 0.3914 - val_loss: 3.4892 - val_accuracy1000: 0.3414 - 10s/epoch - 20ms/step
Epoch 2/50
483/483 - 8s - loss: 3.2610 - accuracy1000: 0.4012 - val_loss: 3.3691 - val_accuracy1000: 0.3519 - 8s/epoch - 17ms/step
Epoch 3/50
483/483 - 8s - loss: 3.2597 - accuracy1000: 0.4029 - val_loss: 3.5301 - val_accuracy1000: 0.3441 - 8s/epoch - 17ms/step
Epoch 4/50
483/483 - 8s - loss: 3.2265 - accuracy1000: 0.4179 - val_loss: 3.4215 - val_accuracy1000: 0.3459 - 8s/epoch - 17ms/step
Epoch 5/50
483/483 - 8s - loss: 3.2051 - accuracy1000: 0.4256 - val_loss: 3.5370 - val_accuracy1000: 0.3452 - 8s/epoch - 16ms/step
Epoch 6/50
483/483 - 8s - loss: 3.1830 - accuracy1000: 0.4381 - val_loss: 3.6330 - val_accuracy1000: 0.3450 - 8s/epoch - 17ms/step
Epoch 7/50
483/483 - 8s - loss: 3.1717 - accuracy1000: 0.4392 - val_loss: 3.6469 - val_accuracy1000: 0.3446 - 8s/epoch - 16ms/step
Epoch 8/50
483/483 - 8s - loss: 3.1480 - accuracy1000: 0.4508 - val_loss: 3.6938 - val_accuracy1000: 0.3449 - 8s/epoch - 16ms/step
Epoch 9/50
483/483 - 8s - loss: 3.1389 - accuracy1000: 0.4536 - val_loss: 3.7061 - val_accuracy1000: 0.3444 - 8s/epoch - 16ms/step
Epoch 10/50
483/483 - 8s - loss: 3.1293 - accuracy1000: 0.4566 - val_loss: 3.6797 - val_accuracy1000: 0.3450 - 8s/epoch - 16ms/step
Epoch 11/50
483/483 - 8s - loss: 3.1165 - accuracy1000: 0.4615 - val_loss: 3.7288 - val_accuracy1000: 0.3445 - 8s/epoch - 16ms/step
Epoch 12/50
483/483 - 8s - loss: 3.1147 - accuracy1000: 0.4621 - val_loss: 3.7679 - val_accuracy1000: 0.3441 - 8s/epoch - 17ms/step
testing model: results/XRAY/W5/deepLOB_L1/h1000
Evaluating performance on  test set...
2341/2341 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1336218
{'0': {'precision': 0.3523179068315961, 'recall': 0.3282945079703807, 'f1-score': 0.3398822335795493, 'support': 218371}, '1': {'precision': 0.26639719878739454, 'recall': 0.14848871860366114, 'f1-score': 0.1906884617163812, 'support': 152685}, '2': {'precision': 0.36440765249633084, 'recall': 0.49608503814185, 'f1-score': 0.4201713417315646, 'support': 228227}, 'accuracy': 0.3463839287949099, 'macro avg': {'precision': 0.32770758603844047, 'recall': 0.32428942157196394, 'f1-score': 0.31691401234249833, 'support': 599283}, 'weighted avg': {'precision': 0.33503125440877835, 'recall': 0.3463839287949099, 'f1-score': 0.3324475011230674, 'support': 599283}}
[[ 71690  27620 119061]
 [ 51598  22672  78415]
 [ 80193  34814 113220]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1195596
{'0': {'precision': 0.3546890086274021, 'recall': 0.27704658800632526, 'f1-score': 0.31109654155056543, 'support': 41105}, '1': {'precision': 0.38472820173156075, 'recall': 0.19857394022269975, 'f1-score': 0.2619465605823898, 'support': 40952}, '2': {'precision': 0.33899897505978815, 'recall': 0.5747315071799204, 'f1-score': 0.42645702568877986, 'support': 41435}, 'accuracy': 0.350905321802222, 'macro avg': {'precision': 0.35947206180625035, 'recall': 0.3501173451363151, 'f1-score': 0.3331667092739117, 'support': 123492}, 'weighted avg': {'precision': 0.3593860618383585, 'recall': 0.350905321802222, 'f1-score': 0.3335042411558693, 'support': 123492}}
[[11388  6482 23235]
 [ 9621  8132 23199]
 [11098  6523 23814]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1226236
{'0': {'precision': 0.37325786622847057, 'recall': 0.3859903077600856, 'f1-score': 0.37951732673267324, 'support': 15889}, '1': {'precision': 0.2295839753466872, 'recall': 0.05586278001687131, 'f1-score': 0.08986053524312099, 'support': 10669}, '2': {'precision': 0.35113921779691426, 'recall': 0.5302404334575008, 'f1-score': 0.42249264725722463, 'support': 14765}, 'accuracy': 0.35229775185731915, 'macro avg': {'precision': 0.3179936864573573, 'recall': 0.3240311737448192, 'f1-score': 0.2972901697443396, 'support': 41323}, 'weighted avg': {'precision': 0.3282601994107256, 'recall': 0.35229775185731915, 'f1-score': 0.3200875249066434, 'support': 41323}}
[[6133  967 8789]
 [4395  596 5678]
 [5903 1033 7829]]
training model: results/XRAY/W5/deepOF_L1/h10
Epoch 1/50
483/483 - 10s - loss: 3.2497 - accuracy10: 0.4232 - val_loss: 3.3065 - val_accuracy10: 0.4211 - 10s/epoch - 20ms/step
Epoch 2/50
483/483 - 7s - loss: 3.2042 - accuracy10: 0.4412 - val_loss: 3.2995 - val_accuracy10: 0.4260 - 7s/epoch - 15ms/step
Epoch 3/50
483/483 - 7s - loss: 3.1887 - accuracy10: 0.4428 - val_loss: 3.2938 - val_accuracy10: 0.4294 - 7s/epoch - 15ms/step
Epoch 4/50
483/483 - 7s - loss: 3.1819 - accuracy10: 0.4463 - val_loss: 3.2934 - val_accuracy10: 0.4287 - 7s/epoch - 15ms/step
Epoch 5/50
483/483 - 7s - loss: 3.1741 - accuracy10: 0.4458 - val_loss: 3.2918 - val_accuracy10: 0.4310 - 7s/epoch - 15ms/step
Epoch 6/50
483/483 - 7s - loss: 3.1677 - accuracy10: 0.4492 - val_loss: 3.2904 - val_accuracy10: 0.4310 - 7s/epoch - 15ms/step
Epoch 7/50
483/483 - 7s - loss: 3.1638 - accuracy10: 0.4510 - val_loss: 3.2921 - val_accuracy10: 0.4311 - 7s/epoch - 15ms/step
Epoch 8/50
483/483 - 8s - loss: 3.1591 - accuracy10: 0.4528 - val_loss: 3.2855 - val_accuracy10: 0.4324 - 8s/epoch - 16ms/step
Epoch 9/50
483/483 - 7s - loss: 3.1561 - accuracy10: 0.4545 - val_loss: 3.2885 - val_accuracy10: 0.4315 - 7s/epoch - 15ms/step
Epoch 10/50
483/483 - 7s - loss: 3.1517 - accuracy10: 0.4555 - val_loss: 3.2877 - val_accuracy10: 0.4345 - 7s/epoch - 15ms/step
Epoch 11/50
483/483 - 7s - loss: 3.1485 - accuracy10: 0.4565 - val_loss: 3.2851 - val_accuracy10: 0.4327 - 7s/epoch - 15ms/step
Epoch 12/50
483/483 - 8s - loss: 3.1440 - accuracy10: 0.4587 - val_loss: 3.2835 - val_accuracy10: 0.4332 - 8s/epoch - 16ms/step
Epoch 13/50
483/483 - 7s - loss: 3.1398 - accuracy10: 0.4588 - val_loss: 3.2841 - val_accuracy10: 0.4297 - 7s/epoch - 15ms/step
Epoch 14/50
483/483 - 7s - loss: 3.1378 - accuracy10: 0.4608 - val_loss: 3.2818 - val_accuracy10: 0.4305 - 7s/epoch - 15ms/step
Epoch 15/50
483/483 - 7s - loss: 3.1354 - accuracy10: 0.4612 - val_loss: 3.2876 - val_accuracy10: 0.4323 - 7s/epoch - 15ms/step
Epoch 16/50
483/483 - 7s - loss: 3.1335 - accuracy10: 0.4615 - val_loss: 3.2853 - val_accuracy10: 0.4357 - 7s/epoch - 15ms/step
Epoch 17/50
483/483 - 7s - loss: 3.1317 - accuracy10: 0.4619 - val_loss: 3.2860 - val_accuracy10: 0.4310 - 7s/epoch - 15ms/step
Epoch 18/50
483/483 - 7s - loss: 3.1284 - accuracy10: 0.4630 - val_loss: 3.2864 - val_accuracy10: 0.4299 - 7s/epoch - 15ms/step
Epoch 19/50
483/483 - 7s - loss: 3.1254 - accuracy10: 0.4638 - val_loss: 3.2805 - val_accuracy10: 0.4331 - 7s/epoch - 15ms/step
Epoch 20/50
483/483 - 7s - loss: 3.1212 - accuracy10: 0.4666 - val_loss: 3.2878 - val_accuracy10: 0.4317 - 7s/epoch - 15ms/step
Epoch 21/50
483/483 - 7s - loss: 3.1209 - accuracy10: 0.4653 - val_loss: 3.2884 - val_accuracy10: 0.4322 - 7s/epoch - 15ms/step
Epoch 22/50
483/483 - 7s - loss: 3.1170 - accuracy10: 0.4671 - val_loss: 3.2856 - val_accuracy10: 0.4299 - 7s/epoch - 15ms/step
Epoch 23/50
483/483 - 7s - loss: 3.1142 - accuracy10: 0.4677 - val_loss: 3.2867 - val_accuracy10: 0.4313 - 7s/epoch - 15ms/step
Epoch 24/50
483/483 - 7s - loss: 3.1136 - accuracy10: 0.4674 - val_loss: 3.2901 - val_accuracy10: 0.4325 - 7s/epoch - 15ms/step
Epoch 25/50
483/483 - 7s - loss: 3.1098 - accuracy10: 0.4688 - val_loss: 3.2881 - val_accuracy10: 0.4306 - 7s/epoch - 15ms/step
Epoch 26/50
483/483 - 7s - loss: 3.1064 - accuracy10: 0.4685 - val_loss: 3.2868 - val_accuracy10: 0.4284 - 7s/epoch - 15ms/step
Epoch 27/50
483/483 - 7s - loss: 3.1058 - accuracy10: 0.4698 - val_loss: 3.2877 - val_accuracy10: 0.4316 - 7s/epoch - 15ms/step
Epoch 28/50
483/483 - 7s - loss: 3.1021 - accuracy10: 0.4708 - val_loss: 3.2898 - val_accuracy10: 0.4289 - 7s/epoch - 15ms/step
Epoch 29/50
483/483 - 7s - loss: 3.1004 - accuracy10: 0.4712 - val_loss: 3.2882 - val_accuracy10: 0.4281 - 7s/epoch - 15ms/step
testing model: results/XRAY/W5/deepOF_L1/h10
Evaluating performance on  test set...
2341/2341 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0660114
{'0': {'precision': 0.3717392043715351, 'recall': 0.38033707213529283, 'f1-score': 0.3759889920880633, 'support': 172426}, '1': {'precision': 0.5093842442043428, 'recall': 0.4778321826955625, 'f1-score': 0.4931040015272539, 'support': 254062}, '2': {'precision': 0.38397845441884915, 'recall': 0.4100873893165114, 'f1-score': 0.3966036901566904, 'support': 172790}, 'accuracy': 0.430247731436829, 'macro avg': {'precision': 0.4217006343315757, 'recall': 0.4227522147157889, 'f1-score': 0.4218988945906692, 'support': 599278}, 'weighted avg': {'precision': 0.43362232727222255, 'recall': 0.430247731436829, 'f1-score': 0.43158336933437924, 'support': 599278}}
[[ 65580  60915  45931]
 [ 64914 121399  67749]
 [ 45920  56011  70859]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.039282
{'0': {'precision': 0.3972856261566934, 'recall': 0.3892767552210838, 'f1-score': 0.3932404170546659, 'support': 33087}, '1': {'precision': 0.5589933842611207, 'recall': 0.5403586255631128, 'f1-score': 0.5495180690423362, 'support': 56605}, '2': {'precision': 0.3943720085822743, 'recall': 0.4241715976331361, 'f1-score': 0.408729366821564, 'support': 33800}, 'accuracy': 0.46807890389660867, 'macro avg': {'precision': 0.45021700633336276, 'recall': 0.4512689928057776, 'f1-score': 0.4504959509728554, 'support': 123492}, 'weighted avg': {'precision': 0.47061011173863987, 'recall': 0.46807890389660867, 'f1-score': 0.46911272451493247, 'support': 123492}}
[[12880 11986  8221]
 [12222 30587 13796]
 [ 7318 12145 14337]]
Evaluating performance on  val set...
162/162 - 1s - 974ms/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0654045
{'0': {'precision': 0.37470967741935485, 'recall': 0.37551724137931036, 'f1-score': 0.37511302475780406, 'support': 11600}, '1': {'precision': 0.5008861455723278, 'recall': 0.4791301297790249, 'f1-score': 0.4897666497355762, 'support': 17106}, '2': {'precision': 0.39962504686914135, 'recall': 0.42236664817309977, 'f1-score': 0.41068125770653513, 'support': 12617}, 'accuracy': 0.4327130169639184, 'macro avg': {'precision': 0.42507362328694137, 'recall': 0.425671339777145, 'f1-score': 0.42518697739997174, 'support': 41323}, 'weighted avg': {'precision': 0.4345487955998526, 'recall': 0.4327130169639184, 'f1-score': 0.43343476577331386, 'support': 41323}}
[[4356 3970 3274]
 [4178 8196 4732]
 [3091 4197 5329]]
training model: results/XRAY/W5/deepOF_L1/h20
Epoch 1/50
483/483 - 9s - loss: 3.2772 - accuracy20: 0.3973 - val_loss: 3.2702 - val_accuracy20: 0.3935 - 9s/epoch - 19ms/step
Epoch 2/50
483/483 - 7s - loss: 3.2382 - accuracy20: 0.4169 - val_loss: 3.2619 - val_accuracy20: 0.3948 - 7s/epoch - 15ms/step
Epoch 3/50
483/483 - 7s - loss: 3.2247 - accuracy20: 0.4213 - val_loss: 3.2621 - val_accuracy20: 0.3971 - 7s/epoch - 15ms/step
Epoch 4/50
483/483 - 8s - loss: 3.2168 - accuracy20: 0.4244 - val_loss: 3.2601 - val_accuracy20: 0.3977 - 8s/epoch - 16ms/step
Epoch 5/50
483/483 - 7s - loss: 3.2105 - accuracy20: 0.4255 - val_loss: 3.2560 - val_accuracy20: 0.4007 - 7s/epoch - 15ms/step
Epoch 6/50
483/483 - 7s - loss: 3.2048 - accuracy20: 0.4276 - val_loss: 3.2537 - val_accuracy20: 0.4021 - 7s/epoch - 15ms/step
Epoch 7/50
483/483 - 7s - loss: 3.2014 - accuracy20: 0.4298 - val_loss: 3.2572 - val_accuracy20: 0.3999 - 7s/epoch - 15ms/step
Epoch 8/50
483/483 - 7s - loss: 3.1979 - accuracy20: 0.4311 - val_loss: 3.2518 - val_accuracy20: 0.4038 - 7s/epoch - 15ms/step
Epoch 9/50
483/483 - 7s - loss: 3.1939 - accuracy20: 0.4335 - val_loss: 3.2549 - val_accuracy20: 0.4004 - 7s/epoch - 15ms/step
Epoch 10/50
483/483 - 7s - loss: 3.1914 - accuracy20: 0.4336 - val_loss: 3.2538 - val_accuracy20: 0.4020 - 7s/epoch - 15ms/step
Epoch 11/50
483/483 - 7s - loss: 3.1872 - accuracy20: 0.4354 - val_loss: 3.2555 - val_accuracy20: 0.4008 - 7s/epoch - 15ms/step
Epoch 12/50
483/483 - 8s - loss: 3.1838 - accuracy20: 0.4365 - val_loss: 3.2498 - val_accuracy20: 0.4035 - 8s/epoch - 16ms/step
Epoch 13/50
483/483 - 7s - loss: 3.1808 - accuracy20: 0.4383 - val_loss: 3.2553 - val_accuracy20: 0.3987 - 7s/epoch - 15ms/step
Epoch 14/50
483/483 - 7s - loss: 3.1790 - accuracy20: 0.4385 - val_loss: 3.2528 - val_accuracy20: 0.4017 - 7s/epoch - 15ms/step
Epoch 15/50
483/483 - 7s - loss: 3.1763 - accuracy20: 0.4386 - val_loss: 3.2568 - val_accuracy20: 0.4028 - 7s/epoch - 15ms/step
Epoch 16/50
483/483 - 7s - loss: 3.1739 - accuracy20: 0.4402 - val_loss: 3.2578 - val_accuracy20: 0.3990 - 7s/epoch - 15ms/step
Epoch 17/50
483/483 - 7s - loss: 3.1725 - accuracy20: 0.4405 - val_loss: 3.2537 - val_accuracy20: 0.4038 - 7s/epoch - 15ms/step
Epoch 18/50
483/483 - 7s - loss: 3.1699 - accuracy20: 0.4412 - val_loss: 3.2563 - val_accuracy20: 0.4018 - 7s/epoch - 15ms/step
Epoch 19/50
483/483 - 7s - loss: 3.1672 - accuracy20: 0.4424 - val_loss: 3.2538 - val_accuracy20: 0.4024 - 7s/epoch - 15ms/step
Epoch 20/50
483/483 - 7s - loss: 3.1642 - accuracy20: 0.4442 - val_loss: 3.2564 - val_accuracy20: 0.4003 - 7s/epoch - 15ms/step
Epoch 21/50
483/483 - 7s - loss: 3.1636 - accuracy20: 0.4436 - val_loss: 3.2507 - val_accuracy20: 0.4049 - 7s/epoch - 15ms/step
Epoch 22/50
483/483 - 7s - loss: 3.1615 - accuracy20: 0.4457 - val_loss: 3.2572 - val_accuracy20: 0.3992 - 7s/epoch - 15ms/step
testing model: results/XRAY/W5/deepOF_L1/h20
Evaluating performance on  test set...
2341/2341 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0808556
{'0': {'precision': 0.4230824108533584, 'recall': 0.3446497324260842, 'f1-score': 0.3798596710356, 'support': 206485}, '1': {'precision': 0.36727824581201235, 'recall': 0.5058850643712415, 'f1-score': 0.42558036247714504, 'support': 186574}, '2': {'precision': 0.43489174952753507, 'recall': 0.36712912001318987, 'f1-score': 0.3981478072920227, 'support': 206219}, 'accuracy': 0.4025827746054419, 'macro avg': {'precision': 0.40841746873096857, 'recall': 0.4058879722701718, 'f1-score': 0.4011959469349226, 'support': 599278}, 'weighted avg': {'precision': 0.40977256754795743, 'recall': 0.4025827746054419, 'f1-score': 0.40038712816848, 'support': 599278}}
[[71165 84082 51238]
 [45049 94385 47140]
 [51992 78518 75709]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0642716
{'0': {'precision': 0.44513279959334096, 'recall': 0.35011744714878307, 'f1-score': 0.3919489747391389, 'support': 40018}, '1': {'precision': 0.42012326016203866, 'recall': 0.5682440817664551, 'f1-score': 0.4830846711986544, 'support': 42707}, '2': {'precision': 0.44447039588929116, 'recall': 0.3734393013957367, 'f1-score': 0.4058705128034231, 'support': 40767}, 'accuracy': 0.433250736889839, 'macro avg': {'precision': 0.43657548521489026, 'recall': 0.430600276770325, 'f1-score': 0.4269680529137388, 'support': 123492}, 'weighted avg': {'precision': 0.43626512709394316, 'recall': 0.433250736889839, 'f1-score': 0.4280620147009438, 'support': 123492}}
[[14011 16802  9205]
 [ 8616 24268  9823]
 [ 8849 16694 15224]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0810261
{'0': {'precision': 0.4178238706275268, 'recall': 0.3402519324363012, 'f1-score': 0.375069033530572, 'support': 13972}, '1': {'precision': 0.358977352323138, 'recall': 0.49600774255988384, 'f1-score': 0.41651146253089977, 'support': 12399}, '2': {'precision': 0.4473581518769999, 'recall': 0.38336008560727663, 'f1-score': 0.4128939312083559, 'support': 14952}, 'accuracy': 0.4025845170970162, 'macro avg': {'precision': 0.4080531249425549, 'recall': 0.4065399202011539, 'f1-score': 0.40149147575660926, 'support': 41323}, 'weighted avg': {'precision': 0.41085338428302143, 'recall': 0.4025845170970162, 'f1-score': 0.40119014156370825, 'support': 41323}}
[[4754 5378 3840]
 [3008 6150 3241]
 [3616 5604 5732]]
training model: results/XRAY/W5/deepOF_L1/h30
Epoch 1/50
483/483 - 9s - loss: 3.2901 - accuracy30: 0.3867 - val_loss: 3.2764 - val_accuracy30: 0.3784 - 9s/epoch - 19ms/step
Epoch 2/50
483/483 - 8s - loss: 3.2538 - accuracy30: 0.4049 - val_loss: 3.2605 - val_accuracy30: 0.3895 - 8s/epoch - 16ms/step
Epoch 3/50
483/483 - 7s - loss: 3.2414 - accuracy30: 0.4086 - val_loss: 3.2616 - val_accuracy30: 0.3892 - 7s/epoch - 15ms/step
Epoch 4/50
483/483 - 8s - loss: 3.2340 - accuracy30: 0.4127 - val_loss: 3.2585 - val_accuracy30: 0.3924 - 8s/epoch - 16ms/step
Epoch 5/50
483/483 - 7s - loss: 3.2297 - accuracy30: 0.4142 - val_loss: 3.2567 - val_accuracy30: 0.3955 - 7s/epoch - 15ms/step
Epoch 6/50
483/483 - 7s - loss: 3.2255 - accuracy30: 0.4154 - val_loss: 3.2563 - val_accuracy30: 0.3978 - 7s/epoch - 15ms/step
Epoch 7/50
483/483 - 7s - loss: 3.2237 - accuracy30: 0.4167 - val_loss: 3.2568 - val_accuracy30: 0.3957 - 7s/epoch - 15ms/step
Epoch 8/50
483/483 - 7s - loss: 3.2202 - accuracy30: 0.4194 - val_loss: 3.2548 - val_accuracy30: 0.3948 - 7s/epoch - 15ms/step
Epoch 9/50
483/483 - 7s - loss: 3.2168 - accuracy30: 0.4193 - val_loss: 3.2556 - val_accuracy30: 0.3949 - 7s/epoch - 15ms/step
Epoch 10/50
483/483 - 7s - loss: 3.2139 - accuracy30: 0.4209 - val_loss: 3.2559 - val_accuracy30: 0.3947 - 7s/epoch - 15ms/step
Epoch 11/50
483/483 - 7s - loss: 3.2106 - accuracy30: 0.4223 - val_loss: 3.2581 - val_accuracy30: 0.3938 - 7s/epoch - 15ms/step
Epoch 12/50
483/483 - 7s - loss: 3.2081 - accuracy30: 0.4232 - val_loss: 3.2561 - val_accuracy30: 0.3913 - 7s/epoch - 15ms/step
Epoch 13/50
483/483 - 7s - loss: 3.2059 - accuracy30: 0.4253 - val_loss: 3.2563 - val_accuracy30: 0.3935 - 7s/epoch - 15ms/step
Epoch 14/50
483/483 - 7s - loss: 3.2029 - accuracy30: 0.4249 - val_loss: 3.2558 - val_accuracy30: 0.3944 - 7s/epoch - 15ms/step
Epoch 15/50
483/483 - 7s - loss: 3.2004 - accuracy30: 0.4275 - val_loss: 3.2603 - val_accuracy30: 0.3922 - 7s/epoch - 15ms/step
Epoch 16/50
483/483 - 7s - loss: 3.1991 - accuracy30: 0.4267 - val_loss: 3.2582 - val_accuracy30: 0.3929 - 7s/epoch - 15ms/step
Epoch 17/50
483/483 - 7s - loss: 3.1955 - accuracy30: 0.4274 - val_loss: 3.2631 - val_accuracy30: 0.3913 - 7s/epoch - 15ms/step
Epoch 18/50
483/483 - 7s - loss: 3.1927 - accuracy30: 0.4304 - val_loss: 3.2602 - val_accuracy30: 0.3927 - 7s/epoch - 15ms/step
testing model: results/XRAY/W5/deepOF_L1/h30
Evaluating performance on  test set...
2341/2341 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.086648
{'0': {'precision': 0.42715192276400715, 'recall': 0.36788213421527133, 'f1-score': 0.39530774713636047, 'support': 214074}, '1': {'precision': 0.32774164385625676, 'recall': 0.45666132089225836, 'f1-score': 0.3816072572922581, 'support': 171475}, '2': {'precision': 0.43968133104522056, 'recall': 0.36202855017335034, 'f1-score': 0.3970942570263606, 'support': 213729}, 'accuracy': 0.39119740754708165, 'macro avg': {'precision': 0.3981916325551615, 'recall': 0.3955240017602934, 'f1-score': 0.3913364204849931, 'support': 599278}, 'weighted avg': {'precision': 0.4031756051398477, 'recall': 0.39119740754708165, 'f1-score': 0.3920246923208364, 'support': 599278}}
[[78754 82070 53250]
 [47813 78306 45356]
 [57803 78550 77376]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0747596
{'0': {'precision': 0.43015151942665275, 'recall': 0.37244698524381903, 'f1-score': 0.3992248569520642, 'support': 40932}, '1': {'precision': 0.39572924904997975, 'recall': 0.49643073200241983, 'f1-score': 0.4403967112465921, 'support': 41325}, '2': {'precision': 0.43747583540458435, 'recall': 0.3841639384018431, 'f1-score': 0.4090903221641165, 'support': 41235}, 'accuracy': 0.41784892948531077, 'macro avg': {'precision': 0.42111886796040565, 'recall': 0.417680551882694, 'f1-score': 0.4162372967875909, 'support': 123492}, 'weighted avg': {'precision': 0.4210782016897467, 'recall': 0.41784892948531077, 'f1-score': 0.4162966457055085, 'support': 123492}}
[[15245 15920  9767]
 [10208 20515 10602]
 [ 9988 15406 15841]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.084737
{'0': {'precision': 0.4164707726061746, 'recall': 0.37128885784142507, 'f1-score': 0.39258411197695464, 'support': 14315}, '1': {'precision': 0.32952876785475904, 'recall': 0.4148042345824231, 'f1-score': 0.36728165451569705, 'support': 11902}, '2': {'precision': 0.44627734001031005, 'recall': 0.40116509996028066, 'f1-score': 0.42252048108767654, 'support': 15106}, 'accuracy': 0.3947438472521356, 'macro avg': {'precision': 0.3974256268237479, 'recall': 0.3957527307947096, 'f1-score': 0.3941287491934427, 'support': 41323}, 'weighted avg': {'precision': 0.40232548467101803, 'recall': 0.3947438472521356, 'f1-score': 0.396239919713147, 'support': 41323}}
[[5315 5003 3997]
 [3443 4937 3522]
 [4004 5042 6060]]
training model: results/XRAY/W5/deepOF_L1/h50
Epoch 1/50
483/483 - 9s - loss: 3.3051 - accuracy50: 0.3695 - val_loss: 3.2747 - val_accuracy50: 0.3788 - 9s/epoch - 19ms/step
Epoch 2/50
483/483 - 7s - loss: 3.2734 - accuracy50: 0.3857 - val_loss: 3.2659 - val_accuracy50: 0.3845 - 7s/epoch - 15ms/step
Epoch 3/50
483/483 - 7s - loss: 3.2620 - accuracy50: 0.3921 - val_loss: 3.2623 - val_accuracy50: 0.3889 - 7s/epoch - 15ms/step
Epoch 4/50
483/483 - 7s - loss: 3.2555 - accuracy50: 0.3958 - val_loss: 3.2614 - val_accuracy50: 0.3879 - 7s/epoch - 15ms/step
Epoch 5/50
483/483 - 7s - loss: 3.2512 - accuracy50: 0.3979 - val_loss: 3.2634 - val_accuracy50: 0.3875 - 7s/epoch - 15ms/step
Epoch 6/50
483/483 - 7s - loss: 3.2479 - accuracy50: 0.3987 - val_loss: 3.2607 - val_accuracy50: 0.3878 - 7s/epoch - 15ms/step
Epoch 7/50
483/483 - 7s - loss: 3.2459 - accuracy50: 0.4017 - val_loss: 3.2627 - val_accuracy50: 0.3875 - 7s/epoch - 15ms/step
Epoch 8/50
483/483 - 7s - loss: 3.2414 - accuracy50: 0.4022 - val_loss: 3.2606 - val_accuracy50: 0.3869 - 7s/epoch - 15ms/step
Epoch 9/50
483/483 - 7s - loss: 3.2395 - accuracy50: 0.4029 - val_loss: 3.2583 - val_accuracy50: 0.3913 - 7s/epoch - 15ms/step
Epoch 10/50
483/483 - 7s - loss: 3.2371 - accuracy50: 0.4045 - val_loss: 3.2590 - val_accuracy50: 0.3905 - 7s/epoch - 15ms/step
Epoch 11/50
483/483 - 7s - loss: 3.2338 - accuracy50: 0.4072 - val_loss: 3.2611 - val_accuracy50: 0.3887 - 7s/epoch - 15ms/step
Epoch 12/50
483/483 - 7s - loss: 3.2320 - accuracy50: 0.4074 - val_loss: 3.2586 - val_accuracy50: 0.3911 - 7s/epoch - 15ms/step
Epoch 13/50
483/483 - 7s - loss: 3.2297 - accuracy50: 0.4094 - val_loss: 3.2612 - val_accuracy50: 0.3867 - 7s/epoch - 15ms/step
Epoch 14/50
483/483 - 7s - loss: 3.2271 - accuracy50: 0.4093 - val_loss: 3.2609 - val_accuracy50: 0.3878 - 7s/epoch - 15ms/step
Epoch 15/50
483/483 - 7s - loss: 3.2252 - accuracy50: 0.4109 - val_loss: 3.2603 - val_accuracy50: 0.3894 - 7s/epoch - 15ms/step
Epoch 16/50
483/483 - 7s - loss: 3.2234 - accuracy50: 0.4123 - val_loss: 3.2621 - val_accuracy50: 0.3887 - 7s/epoch - 15ms/step
Epoch 17/50
483/483 - 7s - loss: 3.2211 - accuracy50: 0.4131 - val_loss: 3.2644 - val_accuracy50: 0.3863 - 7s/epoch - 15ms/step
Epoch 18/50
483/483 - 7s - loss: 3.2185 - accuracy50: 0.4158 - val_loss: 3.2639 - val_accuracy50: 0.3841 - 7s/epoch - 15ms/step
Epoch 19/50
483/483 - 8s - loss: 3.2173 - accuracy50: 0.4156 - val_loss: 3.2631 - val_accuracy50: 0.3888 - 8s/epoch - 16ms/step
testing model: results/XRAY/W5/deepOF_L1/h50
Evaluating performance on  test set...
2341/2341 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0879025
{'0': {'precision': 0.41903375070653265, 'recall': 0.416159232759933, 'f1-score': 0.4175915450600753, 'support': 210208}, '1': {'precision': 0.3242042349055305, 'recall': 0.3691453579803339, 'f1-score': 0.34521831289989136, 'support': 178683}, '2': {'precision': 0.4260771944830536, 'recall': 0.3788351941897551, 'f1-score': 0.4010698281783483, 'support': 210387}, 'accuracy': 0.3890381425648864, 'macro avg': {'precision': 0.38977172669837223, 'recall': 0.388046594976674, 'f1-score': 0.3879598953794383, 'support': 599278}, 'weighted avg': {'precision': 0.3932317466849274, 'recall': 0.3890381425648864, 'f1-score': 0.39021223079912454, 'support': 599278}}
[[87480 68448 54280]
 [59645 65960 53078]
 [61641 69044 79702]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0813307
{'0': {'precision': 0.4148860759493671, 'recall': 0.3951962959390373, 'f1-score': 0.40480189704574643, 'support': 41468}, '1': {'precision': 0.3669775952869767, 'recall': 0.4045809038797451, 'f1-score': 0.38486291672029865, 'support': 40647}, '2': {'precision': 0.42348136804492087, 'recall': 0.4009957222611596, 'f1-score': 0.4119319239792942, 'support': 41377}, 'accuracy': 0.40022835487319014, 'macro avg': {'precision': 0.4017816797604216, 'recall': 0.400257640693314, 'f1-score': 0.4005322459151131, 'support': 123492}, 'weighted avg': {'precision': 0.4019970741318692, 'recall': 0.40022835487319014, 'f1-score': 0.40062801850414803, 'support': 123492}}
[[16388 14511 10569]
 [12183 16445 12019]
 [10929 13856 16592]]
Evaluating performance on  val set...
162/162 - 1s - 948ms/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.087179
{'0': {'precision': 0.41269953884356153, 'recall': 0.40415479747099287, 'f1-score': 0.40838247683235046, 'support': 14393}, '1': {'precision': 0.31311245916938873, 'recall': 0.3330851327872921, 'f1-score': 0.3227901383042694, 'support': 12087}, '2': {'precision': 0.43082811412665273, 'recall': 0.4170989692110759, 'f1-score': 0.42385239448190876, 'support': 14843}, 'accuracy': 0.3880163589284418, 'macro avg': {'precision': 0.38554670404653435, 'recall': 0.38477963315645364, 'f1-score': 0.38500833653950955, 'support': 41323}, 'weighted avg': {'precision': 0.39008195083942815, 'recall': 0.3880163589284418, 'f1-score': 0.3889033826688938, 'support': 41323}}
[[5817 4417 4159]
 [4041 4026 4020]
 [4237 4415 6191]]
training model: results/XRAY/W5/deepOF_L1/h100
Epoch 1/50
483/483 - 9s - loss: 3.3212 - accuracy100: 0.3555 - val_loss: 3.3082 - val_accuracy100: 0.3462 - 9s/epoch - 19ms/step
Epoch 2/50
483/483 - 7s - loss: 3.2946 - accuracy100: 0.3671 - val_loss: 3.2989 - val_accuracy100: 0.3468 - 7s/epoch - 15ms/step
Epoch 3/50
483/483 - 7s - loss: 3.2849 - accuracy100: 0.3719 - val_loss: 3.2967 - val_accuracy100: 0.3506 - 7s/epoch - 15ms/step
Epoch 4/50
483/483 - 7s - loss: 3.2786 - accuracy100: 0.3739 - val_loss: 3.2914 - val_accuracy100: 0.3500 - 7s/epoch - 15ms/step
Epoch 5/50
483/483 - 7s - loss: 3.2741 - accuracy100: 0.3773 - val_loss: 3.2872 - val_accuracy100: 0.3607 - 7s/epoch - 15ms/step
Epoch 6/50
483/483 - 7s - loss: 3.2714 - accuracy100: 0.3778 - val_loss: 3.2879 - val_accuracy100: 0.3585 - 7s/epoch - 15ms/step
Epoch 7/50
483/483 - 7s - loss: 3.2676 - accuracy100: 0.3810 - val_loss: 3.2880 - val_accuracy100: 0.3577 - 7s/epoch - 15ms/step
Epoch 8/50
483/483 - 7s - loss: 3.2645 - accuracy100: 0.3813 - val_loss: 3.2870 - val_accuracy100: 0.3566 - 7s/epoch - 15ms/step
Epoch 9/50
483/483 - 7s - loss: 3.2631 - accuracy100: 0.3827 - val_loss: 3.2872 - val_accuracy100: 0.3558 - 7s/epoch - 15ms/step
Epoch 10/50
483/483 - 7s - loss: 3.2607 - accuracy100: 0.3846 - val_loss: 3.2899 - val_accuracy100: 0.3541 - 7s/epoch - 15ms/step
Epoch 11/50
483/483 - 7s - loss: 3.2583 - accuracy100: 0.3886 - val_loss: 3.2918 - val_accuracy100: 0.3510 - 7s/epoch - 15ms/step
Epoch 12/50
483/483 - 7s - loss: 3.2570 - accuracy100: 0.3876 - val_loss: 3.2966 - val_accuracy100: 0.3475 - 7s/epoch - 15ms/step
Epoch 13/50
483/483 - 7s - loss: 3.2541 - accuracy100: 0.3895 - val_loss: 3.2957 - val_accuracy100: 0.3498 - 7s/epoch - 15ms/step
Epoch 14/50
483/483 - 7s - loss: 3.2527 - accuracy100: 0.3910 - val_loss: 3.2973 - val_accuracy100: 0.3481 - 7s/epoch - 15ms/step
Epoch 15/50
483/483 - 7s - loss: 3.2511 - accuracy100: 0.3918 - val_loss: 3.2963 - val_accuracy100: 0.3476 - 7s/epoch - 15ms/step
Epoch 16/50
483/483 - 7s - loss: 3.2483 - accuracy100: 0.3935 - val_loss: 3.2976 - val_accuracy100: 0.3490 - 7s/epoch - 15ms/step
Epoch 17/50
483/483 - 7s - loss: 3.2468 - accuracy100: 0.3951 - val_loss: 3.3004 - val_accuracy100: 0.3461 - 7s/epoch - 15ms/step
Epoch 18/50
483/483 - 7s - loss: 3.2454 - accuracy100: 0.3952 - val_loss: 3.2992 - val_accuracy100: 0.3474 - 7s/epoch - 15ms/step
testing model: results/XRAY/W5/deepOF_L1/h100
Evaluating performance on  test set...
2341/2341 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0957446
{'0': {'precision': 0.41212761841596196, 'recall': 0.28613570736480587, 'f1-score': 0.3377649183799424, 'support': 208478}, '1': {'precision': 0.3080102414045355, 'recall': 0.5173153282959438, 'f1-score': 0.38612257998628596, 'support': 179061}, '2': {'precision': 0.4134491592649908, 'recall': 0.300303675751751, 'f1-score': 0.34790839677949736, 'support': 211739}, 'accuracy': 0.3602167942090315, 'macro avg': {'precision': 0.37786233969516275, 'recall': 0.36791823713750027, 'f1-score': 0.3572652983819086, 'support': 599278}, 'weighted avg': {'precision': 0.38148484510005426, 'recall': 0.3602167942090315, 'f1-score': 0.355797853374614, 'support': 599278}}
[[ 59653 102786  46039]
 [ 42261  92631  44169]
 [ 42830 105323  63586]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0904461
{'0': {'precision': 0.4035068885310431, 'recall': 0.2731456809263117, 'f1-score': 0.3257688474150259, 'support': 41282}, '1': {'precision': 0.35083177525288844, 'recall': 0.532877011577951, 'f1-score': 0.4231036077705828, 'support': 41199}, '2': {'precision': 0.39290263876251136, 'recall': 0.31586647484821145, 'f1-score': 0.350198023816926, 'support': 41011}, 'accuracy': 0.37398373983739835, 'macro avg': {'precision': 0.382413767515481, 'recall': 0.373963055784158, 'f1-score': 0.36635682633417826, 'support': 123492}, 'weighted avg': {'precision': 0.3824119764784085, 'recall': 0.37398373983739835, 'f1-score': 0.3663541464247343, 'support': 123492}}
[[11276 20497  9509]
 [ 8738 21954 10507]
 [ 7931 20126 12954]]
Evaluating performance on  val set...
162/162 - 1s - 982ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0965114
{'0': {'precision': 0.40886748921657134, 'recall': 0.27710925283839827, 'f1-score': 0.33033471107869355, 'support': 14709}, '1': {'precision': 0.2956422965716646, 'recall': 0.4759371623306458, 'f1-score': 0.3647249912417593, 'support': 12031}, '2': {'precision': 0.40538962122476224, 'recall': 0.3331961873414249, 'f1-score': 0.3657646128947269, 'support': 14583}, 'accuracy': 0.354790310480846, 'macro avg': {'precision': 0.3699664690043327, 'recall': 0.36208086750348967, 'f1-score': 0.3536081050717266, 'support': 41323}, 'weighted avg': {'precision': 0.37467514980182837, 'recall': 0.354790310480846, 'f1-score': 0.3528505913106481, 'support': 41323}}
[[4076 6833 3800]
 [2978 5726 3327]
 [2915 6809 4859]]
training model: results/XRAY/W5/deepOF_L1/h200
Epoch 1/50
483/483 - 10s - loss: 3.3270 - accuracy200: 0.3563 - val_loss: 3.2901 - val_accuracy200: 0.3706 - 10s/epoch - 20ms/step
Epoch 2/50
483/483 - 7s - loss: 3.3043 - accuracy200: 0.3635 - val_loss: 3.2773 - val_accuracy200: 0.3790 - 7s/epoch - 15ms/step
Epoch 3/50
483/483 - 7s - loss: 3.2927 - accuracy200: 0.3682 - val_loss: 3.2775 - val_accuracy200: 0.3775 - 7s/epoch - 15ms/step
Epoch 4/50
483/483 - 7s - loss: 3.2906 - accuracy200: 0.3668 - val_loss: 3.2743 - val_accuracy200: 0.3777 - 7s/epoch - 15ms/step
Epoch 5/50
483/483 - 7s - loss: 3.2864 - accuracy200: 0.3686 - val_loss: 3.2735 - val_accuracy200: 0.3788 - 7s/epoch - 15ms/step
Epoch 6/50
483/483 - 7s - loss: 3.2833 - accuracy200: 0.3689 - val_loss: 3.2718 - val_accuracy200: 0.3819 - 7s/epoch - 15ms/step
Epoch 7/50
483/483 - 7s - loss: 3.2789 - accuracy200: 0.3723 - val_loss: 3.2724 - val_accuracy200: 0.3815 - 7s/epoch - 15ms/step
Epoch 8/50
483/483 - 7s - loss: 3.2766 - accuracy200: 0.3747 - val_loss: 3.2712 - val_accuracy200: 0.3823 - 7s/epoch - 15ms/step
Epoch 9/50
483/483 - 7s - loss: 3.2744 - accuracy200: 0.3769 - val_loss: 3.2697 - val_accuracy200: 0.3843 - 7s/epoch - 15ms/step
Epoch 10/50
483/483 - 7s - loss: 3.2732 - accuracy200: 0.3783 - val_loss: 3.2695 - val_accuracy200: 0.3845 - 7s/epoch - 15ms/step
Epoch 11/50
483/483 - 7s - loss: 3.2697 - accuracy200: 0.3800 - val_loss: 3.2698 - val_accuracy200: 0.3825 - 7s/epoch - 15ms/step
Epoch 12/50
483/483 - 7s - loss: 3.2679 - accuracy200: 0.3824 - val_loss: 3.2695 - val_accuracy200: 0.3820 - 7s/epoch - 15ms/step
Epoch 13/50
483/483 - 7s - loss: 3.2662 - accuracy200: 0.3831 - val_loss: 3.2686 - val_accuracy200: 0.3846 - 7s/epoch - 15ms/step
Epoch 14/50
483/483 - 7s - loss: 3.2638 - accuracy200: 0.3871 - val_loss: 3.2699 - val_accuracy200: 0.3828 - 7s/epoch - 15ms/step
Epoch 15/50
483/483 - 7s - loss: 3.2624 - accuracy200: 0.3865 - val_loss: 3.2686 - val_accuracy200: 0.3837 - 7s/epoch - 15ms/step
Epoch 16/50
483/483 - 7s - loss: 3.2601 - accuracy200: 0.3897 - val_loss: 3.2690 - val_accuracy200: 0.3829 - 7s/epoch - 15ms/step
Epoch 17/50
483/483 - 7s - loss: 3.2592 - accuracy200: 0.3900 - val_loss: 3.2705 - val_accuracy200: 0.3814 - 7s/epoch - 15ms/step
Epoch 18/50
483/483 - 7s - loss: 3.2579 - accuracy200: 0.3909 - val_loss: 3.2708 - val_accuracy200: 0.3818 - 7s/epoch - 15ms/step
Epoch 19/50
483/483 - 7s - loss: 3.2561 - accuracy200: 0.3922 - val_loss: 3.2701 - val_accuracy200: 0.3819 - 7s/epoch - 15ms/step
Epoch 20/50
483/483 - 7s - loss: 3.2542 - accuracy200: 0.3935 - val_loss: 3.2711 - val_accuracy200: 0.3813 - 7s/epoch - 15ms/step
Epoch 21/50
483/483 - 7s - loss: 3.2513 - accuracy200: 0.3964 - val_loss: 3.2708 - val_accuracy200: 0.3825 - 7s/epoch - 15ms/step
Epoch 22/50
483/483 - 7s - loss: 3.2507 - accuracy200: 0.3974 - val_loss: 3.2733 - val_accuracy200: 0.3790 - 7s/epoch - 14ms/step
Epoch 23/50
483/483 - 7s - loss: 3.2498 - accuracy200: 0.3963 - val_loss: 3.2722 - val_accuracy200: 0.3820 - 7s/epoch - 15ms/step
testing model: results/XRAY/W5/deepOF_L1/h200
Evaluating performance on  test set...
2341/2341 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0852892
{'0': {'precision': 0.39477535353984433, 'recall': 0.490302542275394, 'f1-score': 0.437383783695032, 'support': 217325}, '1': {'precision': 0.2724237365305813, 'recall': 0.011774120548628102, 'f1-score': 0.022572653764414433, 'support': 152453}, '2': {'precision': 0.40998091555753835, 'recall': 0.5766100217864923, 'f1-score': 0.47922415603792307, 'support': 229500}, 'accuracy': 0.401619949339038, 'macro avg': {'precision': 0.359060001875988, 'recall': 0.35956222820350475, 'f1-score': 0.3130601978324565, 'support': 599278}, 'weighted avg': {'precision': 0.369472915297739, 'recall': 0.401619949339038, 'f1-score': 0.347881356209593, 'support': 599278}}
[[106555   2435 108335]
 [ 68549   1795  82109]
 [ 94809   2359 132332]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0974061
{'0': {'precision': 0.3632119880746901, 'recall': 0.4480847871851332, 'f1-score': 0.4012089566790523, 'support': 41327}, '1': {'precision': 0.38217338217338215, 'recall': 0.007684941933266223, 'f1-score': 0.015066910561278521, 'support': 40729}, '2': {'precision': 0.3576141388497538, 'recall': 0.6187131962544647, 'f1-score': 0.4532508287292818, 'support': 41436}, 'accuracy': 0.3600881028730606, 'macro avg': {'precision': 0.36766650303260867, 'recall': 0.3581609751242881, 'f1-score': 0.28984223198987086, 'support': 123492}, 'weighted avg': {'precision': 0.3675873819444239, 'recall': 0.3600881028730606, 'f1-score': 0.29131704152618815, 'support': 123492}}
[[18518   248 22561]
 [16925   313 23491]
 [15541   258 25637]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0903928
{'0': {'precision': 0.3889513884777074, 'recall': 0.43374050841862, 'f1-score': 0.4101267403383904, 'support': 15145}, '1': {'precision': 0.26557377049180325, 'recall': 0.007149792567746492, 'f1-score': 0.013924703455389376, 'support': 11329}, '2': {'precision': 0.37896307348004477, 'recall': 0.615799043706647, 'f1-score': 0.469187746934168, 'support': 14849}, 'accuracy': 0.3822084553396414, 'macro avg': {'precision': 0.3444960774831851, 'recall': 0.3522297815643378, 'f1-score': 0.2977463969093159, 'support': 41323}, 'weighted avg': {'precision': 0.3515373206810179, 'recall': 0.3822084553396414, 'f1-score': 0.3227280522250681, 'support': 41323}}
[[6569  119 8457]
 [4720   81 6528]
 [5600  105 9144]]
training model: results/XRAY/W5/deepOF_L1/h300
Epoch 1/50
483/483 - 9s - loss: 3.3291 - accuracy300: 0.3525 - val_loss: 3.3384 - val_accuracy300: 0.3293 - 9s/epoch - 18ms/step
Epoch 2/50
483/483 - 7s - loss: 3.3087 - accuracy300: 0.3557 - val_loss: 3.3203 - val_accuracy300: 0.3268 - 7s/epoch - 15ms/step
Epoch 3/50
483/483 - 7s - loss: 3.2990 - accuracy300: 0.3585 - val_loss: 3.3123 - val_accuracy300: 0.3329 - 7s/epoch - 15ms/step
Epoch 4/50
483/483 - 7s - loss: 3.2943 - accuracy300: 0.3621 - val_loss: 3.3029 - val_accuracy300: 0.3412 - 7s/epoch - 15ms/step
Epoch 5/50
483/483 - 8s - loss: 3.2900 - accuracy300: 0.3633 - val_loss: 3.3011 - val_accuracy300: 0.3408 - 8s/epoch - 16ms/step
Epoch 6/50
483/483 - 7s - loss: 3.2872 - accuracy300: 0.3637 - val_loss: 3.2975 - val_accuracy300: 0.3455 - 7s/epoch - 15ms/step
Epoch 7/50
483/483 - 7s - loss: 3.2852 - accuracy300: 0.3651 - val_loss: 3.2994 - val_accuracy300: 0.3401 - 7s/epoch - 15ms/step
Epoch 8/50
483/483 - 7s - loss: 3.2831 - accuracy300: 0.3679 - val_loss: 3.2975 - val_accuracy300: 0.3415 - 7s/epoch - 15ms/step
Epoch 9/50
483/483 - 7s - loss: 3.2805 - accuracy300: 0.3700 - val_loss: 3.2964 - val_accuracy300: 0.3433 - 7s/epoch - 15ms/step
Epoch 10/50
483/483 - 7s - loss: 3.2770 - accuracy300: 0.3728 - val_loss: 3.2982 - val_accuracy300: 0.3426 - 7s/epoch - 15ms/step
Epoch 11/50
483/483 - 7s - loss: 3.2749 - accuracy300: 0.3754 - val_loss: 3.2980 - val_accuracy300: 0.3397 - 7s/epoch - 15ms/step
Epoch 12/50
483/483 - 7s - loss: 3.2727 - accuracy300: 0.3768 - val_loss: 3.2983 - val_accuracy300: 0.3402 - 7s/epoch - 15ms/step
Epoch 13/50
483/483 - 7s - loss: 3.2708 - accuracy300: 0.3769 - val_loss: 3.2993 - val_accuracy300: 0.3390 - 7s/epoch - 15ms/step
Epoch 14/50
483/483 - 7s - loss: 3.2681 - accuracy300: 0.3791 - val_loss: 3.2998 - val_accuracy300: 0.3384 - 7s/epoch - 15ms/step
Epoch 15/50
483/483 - 8s - loss: 3.2659 - accuracy300: 0.3806 - val_loss: 3.3034 - val_accuracy300: 0.3337 - 8s/epoch - 16ms/step
Epoch 16/50
483/483 - 8s - loss: 3.2641 - accuracy300: 0.3812 - val_loss: 3.3018 - val_accuracy300: 0.3348 - 8s/epoch - 16ms/step
Epoch 17/50
483/483 - 7s - loss: 3.2628 - accuracy300: 0.3832 - val_loss: 3.3020 - val_accuracy300: 0.3335 - 7s/epoch - 15ms/step
Epoch 18/50
483/483 - 7s - loss: 3.2616 - accuracy300: 0.3840 - val_loss: 3.3024 - val_accuracy300: 0.3344 - 7s/epoch - 15ms/step
Epoch 19/50
483/483 - 8s - loss: 3.2602 - accuracy300: 0.3833 - val_loss: 3.3033 - val_accuracy300: 0.3319 - 8s/epoch - 16ms/step
testing model: results/XRAY/W5/deepOF_L1/h300
Evaluating performance on  test set...
2341/2341 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0994066
{'0': {'precision': 0.4132408398901252, 'recall': 0.2707146934133876, 'f1-score': 0.3271276035633806, 'support': 229511}, '1': {'precision': 0.20555345442651102, 'recall': 0.32771376888352916, 'f1-score': 0.25264143120971894, 'support': 122726}, '2': {'precision': 0.4310025546566218, 'recall': 0.4418578292672067, 'f1-score': 0.43636269148357804, 'support': 247041}, 'accuracy': 0.35293803543597463, 'macro avg': {'precision': 0.34993228299108603, 'recall': 0.34676209718804113, 'f1-score': 0.33871057541889255, 'support': 599278}, 'weighted avg': {'precision': 0.3780305196534781, 'recall': 0.35293803543597463, 'f1-score': 0.3569036930687821, 'support': 599278}}
[[ 62132  75331  92048]
 [ 30449  40219  52058]
 [ 57772  80112 109157]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965391
{'0': {'precision': 0.37162657670871224, 'recall': 0.2448599937184412, 'f1-score': 0.29520993839476867, 'support': 41391}, '1': {'precision': 0.3421297577419436, 'recall': 0.33152942323631224, 'f1-score': 0.3367461899397076, 'support': 41022}, '2': {'precision': 0.35173280915192406, 'recall': 0.4835073882032182, 'f1-score': 0.4072251609464059, 'support': 41079}, 'accuracy': 0.3530350144138892, 'macro avg': {'precision': 0.35516304786752667, 'recall': 0.3532989350526572, 'f1-score': 0.3463937630936274, 'support': 123492}, 'weighted avg': {'precision': 0.3552106583891443, 'recall': 0.3530350144138892, 'f1-score': 0.346268901226978, 'support': 123492}}
[[10135 13318 17938]
 [ 8753 13600 18669]
 [ 8384 12833 19862]]
Evaluating performance on  val set...
162/162 - 1s - 988ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988988
{'0': {'precision': 0.39010703522809936, 'recall': 0.24832969504531321, 'f1-score': 0.3034761519805982, 'support': 15117}, '1': {'precision': 0.28514177693761816, 'recall': 0.3225006414093902, 'f1-score': 0.302672766674693, 'support': 11693}, '2': {'precision': 0.3688227334235453, 'recall': 0.4695100943981258, 'f1-score': 0.4131199223960228, 'support': 14513}, 'accuracy': 0.3469980398325388, 'macro avg': {'precision': 0.34802384852975426, 'recall': 0.3467801436176097, 'f1-score': 0.339756280350438, 'support': 41323}, 'weighted avg': {'precision': 0.35293021270117514, 'recall': 0.3469980398325388, 'f1-score': 0.3417566750708169, 'support': 41323}}
[[3754 4860 6503]
 [2764 3771 5158]
 [3105 4594 6814]]
training model: results/XRAY/W5/deepOF_L1/h500
Epoch 1/50
483/483 - 9s - loss: 3.3340 - accuracy500: 0.3463 - val_loss: 3.3236 - val_accuracy500: 0.3265 - 9s/epoch - 19ms/step
Epoch 2/50
483/483 - 7s - loss: 3.3138 - accuracy500: 0.3502 - val_loss: 3.3101 - val_accuracy500: 0.3344 - 7s/epoch - 15ms/step
Epoch 3/50
483/483 - 7s - loss: 3.3043 - accuracy500: 0.3509 - val_loss: 3.3031 - val_accuracy500: 0.3320 - 7s/epoch - 15ms/step
Epoch 4/50
483/483 - 8s - loss: 3.2988 - accuracy500: 0.3512 - val_loss: 3.2969 - val_accuracy500: 0.3408 - 8s/epoch - 16ms/step
Epoch 5/50
483/483 - 7s - loss: 3.2946 - accuracy500: 0.3547 - val_loss: 3.2939 - val_accuracy500: 0.3426 - 7s/epoch - 15ms/step
Epoch 6/50
483/483 - 7s - loss: 3.2927 - accuracy500: 0.3574 - val_loss: 3.2925 - val_accuracy500: 0.3418 - 7s/epoch - 15ms/step
Epoch 7/50
483/483 - 7s - loss: 3.2907 - accuracy500: 0.3585 - val_loss: 3.2894 - val_accuracy500: 0.3468 - 7s/epoch - 15ms/step
Epoch 8/50
483/483 - 7s - loss: 3.2887 - accuracy500: 0.3604 - val_loss: 3.2893 - val_accuracy500: 0.3458 - 7s/epoch - 15ms/step
Epoch 9/50
483/483 - 7s - loss: 3.2856 - accuracy500: 0.3619 - val_loss: 3.2893 - val_accuracy500: 0.3462 - 7s/epoch - 15ms/step
Epoch 10/50
483/483 - 8s - loss: 3.2838 - accuracy500: 0.3640 - val_loss: 3.2863 - val_accuracy500: 0.3492 - 8s/epoch - 16ms/step
Epoch 11/50
483/483 - 7s - loss: 3.2822 - accuracy500: 0.3654 - val_loss: 3.2876 - val_accuracy500: 0.3440 - 7s/epoch - 15ms/step
Epoch 12/50
483/483 - 7s - loss: 3.2797 - accuracy500: 0.3690 - val_loss: 3.2887 - val_accuracy500: 0.3434 - 7s/epoch - 15ms/step
Epoch 13/50
483/483 - 7s - loss: 3.2781 - accuracy500: 0.3692 - val_loss: 3.2895 - val_accuracy500: 0.3408 - 7s/epoch - 15ms/step
Epoch 14/50
483/483 - 7s - loss: 3.2759 - accuracy500: 0.3707 - val_loss: 3.2889 - val_accuracy500: 0.3415 - 7s/epoch - 15ms/step
Epoch 15/50
483/483 - 7s - loss: 3.2747 - accuracy500: 0.3697 - val_loss: 3.2903 - val_accuracy500: 0.3414 - 7s/epoch - 15ms/step
Epoch 16/50
483/483 - 7s - loss: 3.2734 - accuracy500: 0.3713 - val_loss: 3.2897 - val_accuracy500: 0.3404 - 7s/epoch - 15ms/step
Epoch 17/50
483/483 - 7s - loss: 3.2708 - accuracy500: 0.3741 - val_loss: 3.2907 - val_accuracy500: 0.3370 - 7s/epoch - 15ms/step
Epoch 18/50
483/483 - 7s - loss: 3.2678 - accuracy500: 0.3740 - val_loss: 3.2913 - val_accuracy500: 0.3361 - 7s/epoch - 15ms/step
Epoch 19/50
483/483 - 7s - loss: 3.2661 - accuracy500: 0.3782 - val_loss: 3.2926 - val_accuracy500: 0.3359 - 7s/epoch - 15ms/step
Epoch 20/50
483/483 - 7s - loss: 3.2655 - accuracy500: 0.3771 - val_loss: 3.2942 - val_accuracy500: 0.3296 - 7s/epoch - 15ms/step
testing model: results/XRAY/W5/deepOF_L1/h500
Evaluating performance on  test set...
2341/2341 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0982387
{'0': {'precision': 0.3802635153490899, 'recall': 0.2076597480748636, 'f1-score': 0.2686249404031893, 'support': 215699}, '1': {'precision': 0.2587738331310046, 'recall': 0.30785367001254704, 'f1-score': 0.2811881660901719, 'support': 153024}, '2': {'precision': 0.3982781134054014, 'recall': 0.517273535598881, 'f1-score': 0.4500428306735548, 'support': 230555}, 'accuracy': 0.3523590053364215, 'macro avg': {'precision': 0.3457718206284987, 'recall': 0.3442623178954305, 'f1-score': 0.33328531238897197, 'support': 599278}, 'weighted avg': {'precision': 0.3561720561650929, 'recall': 0.3523590053364215, 'f1-score': 0.3416282489491545, 'support': 599278}}
[[ 44792  66604 104303]
 [ 30039  47109  75876]
 [ 42961  68334 119260]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0966244
{'0': {'precision': 0.3755516695811475, 'recall': 0.21434342474217005, 'f1-score': 0.2729198184568835, 'support': 42082}, '1': {'precision': 0.3368145437234074, 'recall': 0.28611146215089095, 'f1-score': 0.30939951348839756, 'support': 39565}, '2': {'precision': 0.35370834282243985, 'recall': 0.5567451308400048, 'f1-score': 0.43258750348157093, 'support': 41845}, 'accuracy': 0.3533589220354355, 'macro avg': {'precision': 0.35535818537566494, 'recall': 0.3524000059110219, 'f1-score': 0.33830227847561734, 'support': 123492}, 'weighted avg': {'precision': 0.35573930608570153, 'recall': 0.3533589220354355, 'f1-score': 0.3387104236279059, 'support': 123492}}
[[ 9020 11399 21663]
 [ 7340 11320 20905]
 [ 7658 10890 23297]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0982975
{'0': {'precision': 0.3821600349803236, 'recall': 0.22992436698454455, 'f1-score': 0.28711041760768696, 'support': 15205}, '1': {'precision': 0.2906888720666162, 'recall': 0.2640763345654603, 'f1-score': 0.2767442907977118, 'support': 11633}, '2': {'precision': 0.3620123108251955, 'recall': 0.540006903693476, 'f1-score': 0.43344785548043885, 'support': 14485}, 'accuracy': 0.34823221934515886, 'macro avg': {'precision': 0.34495373929071177, 'recall': 0.344669201747827, 'f1-score': 0.33243418796194585, 'support': 41323}, 'weighted avg': {'precision': 0.3493472231669948, 'recall': 0.34823221934515886, 'f1-score': 0.33548804349173145, 'support': 41323}}
[[3496 3852 7857]
 [2633 3072 5928]
 [3019 3644 7822]]
training model: results/XRAY/W5/deepOF_L1/h1000
Epoch 1/50
483/483 - 10s - loss: 3.3329 - accuracy1000: 0.3562 - val_loss: 3.3067 - val_accuracy1000: 0.3512 - 10s/epoch - 20ms/step
Epoch 2/50
483/483 - 7s - loss: 3.3107 - accuracy1000: 0.3573 - val_loss: 3.2951 - val_accuracy1000: 0.3564 - 7s/epoch - 15ms/step
Epoch 3/50
483/483 - 8s - loss: 3.3019 - accuracy1000: 0.3580 - val_loss: 3.2869 - val_accuracy1000: 0.3598 - 8s/epoch - 16ms/step
Epoch 4/50
483/483 - 8s - loss: 3.2955 - accuracy1000: 0.3592 - val_loss: 3.2812 - val_accuracy1000: 0.3654 - 8s/epoch - 16ms/step
Epoch 5/50
483/483 - 7s - loss: 3.2910 - accuracy1000: 0.3603 - val_loss: 3.2803 - val_accuracy1000: 0.3687 - 7s/epoch - 15ms/step
Epoch 6/50
483/483 - 7s - loss: 3.2906 - accuracy1000: 0.3604 - val_loss: 3.2795 - val_accuracy1000: 0.3722 - 7s/epoch - 15ms/step
Epoch 7/50
483/483 - 7s - loss: 3.2895 - accuracy1000: 0.3599 - val_loss: 3.2815 - val_accuracy1000: 0.3714 - 7s/epoch - 15ms/step
Epoch 8/50
483/483 - 7s - loss: 3.2877 - accuracy1000: 0.3642 - val_loss: 3.2820 - val_accuracy1000: 0.3701 - 7s/epoch - 15ms/step
Epoch 9/50
483/483 - 7s - loss: 3.2874 - accuracy1000: 0.3604 - val_loss: 3.2801 - val_accuracy1000: 0.3723 - 7s/epoch - 15ms/step
Epoch 10/50
483/483 - 7s - loss: 3.2861 - accuracy1000: 0.3639 - val_loss: 3.2815 - val_accuracy1000: 0.3685 - 7s/epoch - 15ms/step
Epoch 11/50
483/483 - 7s - loss: 3.2839 - accuracy1000: 0.3645 - val_loss: 3.2800 - val_accuracy1000: 0.3721 - 7s/epoch - 15ms/step
Epoch 12/50
483/483 - 7s - loss: 3.2818 - accuracy1000: 0.3672 - val_loss: 3.2801 - val_accuracy1000: 0.3701 - 7s/epoch - 15ms/step
Epoch 13/50
483/483 - 7s - loss: 3.2804 - accuracy1000: 0.3671 - val_loss: 3.2820 - val_accuracy1000: 0.3676 - 7s/epoch - 15ms/step
Epoch 14/50
483/483 - 7s - loss: 3.2790 - accuracy1000: 0.3683 - val_loss: 3.2810 - val_accuracy1000: 0.3687 - 7s/epoch - 15ms/step
Epoch 15/50
483/483 - 7s - loss: 3.2758 - accuracy1000: 0.3743 - val_loss: 3.2806 - val_accuracy1000: 0.3653 - 7s/epoch - 15ms/step
Epoch 16/50
483/483 - 7s - loss: 3.2749 - accuracy1000: 0.3744 - val_loss: 3.2804 - val_accuracy1000: 0.3661 - 7s/epoch - 15ms/step
testing model: results/XRAY/W5/deepOF_L1/h1000
Evaluating performance on  test set...
2341/2341 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0932672
{'0': {'precision': 0.3696808510638298, 'recall': 0.45066836409929983, 'f1-score': 0.4061769336968119, 'support': 218369}, '1': {'precision': 0.28886618998978547, 'recall': 0.03704382908490739, 'f1-score': 0.06566665118655086, 'support': 152684}, '2': {'precision': 0.38948610800982486, 'recall': 0.5349983568846532, 'f1-score': 0.4507905448436908, 'support': 228225}, 'accuracy': 0.37740080563611544, 'macro avg': {'precision': 0.3493443830211467, 'recall': 0.34090351668962016, 'f1-score': 0.30754470990901783, 'support': 599278}, 'weighted avg': {'precision': 0.3566333990550298, 'recall': 0.37740080563611544, 'f1-score': 0.33641209906113323, 'support': 599278}}
[[ 98412   7797 112160]
 [ 67798   5656  79230]
 [ 99998   6127 122100]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984395
{'0': {'precision': 0.3451226787978224, 'recall': 0.45038929440389297, 'f1-score': 0.390791251477791, 'support': 41100}, '1': {'precision': 0.37832550860719877, 'recall': 0.023617047258517522, 'f1-score': 0.044458748074756894, 'support': 40945}, '2': {'precision': 0.342332838038633, 'recall': 0.5558665283373947, 'f1-score': 0.4237174358832887, 'support': 41447}, 'accuracy': 0.34428950863213814, 'macro avg': {'precision': 0.3552603418145514, 'recall': 0.34329095666660175, 'f1-score': 0.2863224784786122, 'support': 123492}, 'weighted avg': {'precision': 0.3551950667792203, 'recall': 0.34428950863213814, 'f1-score': 0.2870121177138017, 'support': 123492}}
[[18511   782 21807]
 [17524   967 22454]
 [17601   807 23039]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0932441
{'0': {'precision': 0.38825596252129474, 'recall': 0.45980707395498394, 'f1-score': 0.4210131332082552, 'support': 15861}, '1': {'precision': 0.23643807574206754, 'recall': 0.02157668597048384, 'f1-score': 0.039544637507489516, 'support': 10706}, '2': {'precision': 0.36374176792505336, 'recall': 0.5315126050420168, 'f1-score': 0.431907043339391, 'support': 14756}, 'accuracy': 0.3718752268712339, 'macro avg': {'precision': 0.32947860206280527, 'recall': 0.33763212165582823, 'f1-score': 0.2974882713517119, 'support': 41323}, 'weighted avg': {'precision': 0.34016909198138856, 'recall': 0.3718752268712339, 'f1-score': 0.326072030745284, 'support': 41323}}
[[7293  359 8209]
 [4965  231 5510]
 [6526  387 7843]]
training model: results/XRAY/W5/deepLOB_L2/h10
Epoch 1/50
483/483 - 23s - loss: 3.3014 - accuracy10: 0.3791 - val_loss: 3.3923 - val_accuracy10: 0.3684 - 23s/epoch - 47ms/step
Epoch 2/50
483/483 - 20s - loss: 3.1951 - accuracy10: 0.3955 - val_loss: 3.3403 - val_accuracy10: 0.3919 - 20s/epoch - 41ms/step
Epoch 3/50
483/483 - 20s - loss: 3.1531 - accuracy10: 0.4149 - val_loss: 3.2873 - val_accuracy10: 0.3932 - 20s/epoch - 41ms/step
Epoch 4/50
483/483 - 20s - loss: 3.1245 - accuracy10: 0.4316 - val_loss: 3.2672 - val_accuracy10: 0.3950 - 20s/epoch - 41ms/step
Epoch 5/50
483/483 - 20s - loss: 3.0965 - accuracy10: 0.4468 - val_loss: 3.2351 - val_accuracy10: 0.4057 - 20s/epoch - 41ms/step
Epoch 6/50
483/483 - 20s - loss: 3.0679 - accuracy10: 0.4629 - val_loss: 3.2307 - val_accuracy10: 0.4221 - 20s/epoch - 41ms/step
Epoch 7/50
483/483 - 20s - loss: 3.0433 - accuracy10: 0.4731 - val_loss: 3.1919 - val_accuracy10: 0.4350 - 20s/epoch - 41ms/step
Epoch 8/50
483/483 - 20s - loss: 3.0211 - accuracy10: 0.4832 - val_loss: 3.1846 - val_accuracy10: 0.4316 - 20s/epoch - 41ms/step
Epoch 9/50
483/483 - 20s - loss: 3.0081 - accuracy10: 0.4894 - val_loss: 3.1802 - val_accuracy10: 0.4310 - 20s/epoch - 42ms/step
Epoch 10/50
483/483 - 20s - loss: 2.9938 - accuracy10: 0.4948 - val_loss: 3.1652 - val_accuracy10: 0.4369 - 20s/epoch - 42ms/step
Epoch 11/50
483/483 - 20s - loss: 2.9839 - accuracy10: 0.4970 - val_loss: 3.1726 - val_accuracy10: 0.4272 - 20s/epoch - 42ms/step
Epoch 12/50
483/483 - 20s - loss: 2.9730 - accuracy10: 0.5014 - val_loss: 3.1716 - val_accuracy10: 0.4308 - 20s/epoch - 42ms/step
Epoch 13/50
483/483 - 20s - loss: 2.9633 - accuracy10: 0.5039 - val_loss: 3.1673 - val_accuracy10: 0.4305 - 20s/epoch - 42ms/step
Epoch 14/50
483/483 - 20s - loss: 2.9533 - accuracy10: 0.5068 - val_loss: 3.1694 - val_accuracy10: 0.4278 - 20s/epoch - 41ms/step
Epoch 15/50
483/483 - 20s - loss: 2.9438 - accuracy10: 0.5090 - val_loss: 3.1719 - val_accuracy10: 0.4289 - 20s/epoch - 42ms/step
Epoch 16/50
483/483 - 20s - loss: 2.9353 - accuracy10: 0.5111 - val_loss: 3.1812 - val_accuracy10: 0.4255 - 20s/epoch - 41ms/step
Epoch 17/50
483/483 - 20s - loss: 2.9263 - accuracy10: 0.5132 - val_loss: 3.1807 - val_accuracy10: 0.4314 - 20s/epoch - 41ms/step
Epoch 18/50
483/483 - 20s - loss: 2.9174 - accuracy10: 0.5142 - val_loss: 3.1689 - val_accuracy10: 0.4332 - 20s/epoch - 42ms/step
Epoch 19/50
483/483 - 20s - loss: 2.9094 - accuracy10: 0.5177 - val_loss: 3.1714 - val_accuracy10: 0.4365 - 20s/epoch - 42ms/step
Epoch 20/50
483/483 - 20s - loss: 2.9019 - accuracy10: 0.5197 - val_loss: 3.1687 - val_accuracy10: 0.4385 - 20s/epoch - 42ms/step
testing model: results/XRAY/W5/deepLOB_L2/h10
Evaluating performance on  test set...
2341/2341 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0304325
{'0': {'precision': 0.42079510703363915, 'recall': 0.4628455770201068, 'f1-score': 0.44081979844734304, 'support': 172429}, '1': {'precision': 0.563905759528099, 'recall': 0.44475757885870376, 'f1-score': 0.4972944901780861, 'support': 254062}, '2': {'precision': 0.41640779575802184, 'recall': 0.5042478818463818, 'f1-score': 0.45613741185339524, 'support': 172792}, 'accuracy': 0.46711486893504406, 'macro avg': {'precision': 0.4670362207732533, 'recall': 0.4706170125750641, 'f1-score': 0.4647505668262748, 'support': 599283}, 'weighted avg': {'precision': 0.48020090747201466, 'recall': 0.46711486893504406, 'f1-score': 0.4691784106324954, 'support': 599283}}
[[ 79808  44866  47755]
 [ 66709 112996  74357]
 [ 43143  42519  87130]]
Evaluating performance on  train set...
483/483 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0057995
{'0': {'precision': 0.442360746190226, 'recall': 0.40666042691947707, 'f1-score': 0.4237600088093253, 'support': 33121}, '1': {'precision': 0.6216513849321299, 'recall': 0.4597149685757281, 'f1-score': 0.528558052434457, 'support': 56485}, '2': {'precision': 0.39646597624480723, 'recall': 0.5998937614354011, 'f1-score': 0.4774128395119718, 'support': 33886}, 'accuracy': 0.4839503773523791, 'macro avg': {'precision': 0.48682603578905437, 'recall': 0.48875638564353546, 'f1-score': 0.4765769669185847, 'support': 123492}, 'weighted avg': {'precision': 0.5117744859868605, 'recall': 0.4839503773523791, 'f1-score': 0.48641667738182753, 'support': 123492}}
[[13469  8223 11429]
 [11002 25967 19516]
 [ 5977  7581 20328]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0546448
{'0': {'precision': 0.41176963701902924, 'recall': 0.42275583096652036, 'f1-score': 0.41719041956854086, 'support': 11619}, '1': {'precision': 0.5976149495942955, 'recall': 0.28392033175632264, 'f1-score': 0.38495347455949314, 'support': 17121}, '2': {'precision': 0.39266227657572905, 'recall': 0.6634347929746484, 'f1-score': 0.49333687911828145, 'support': 12583}, 'accuracy': 0.43852092055271885, 'macro avg': {'precision': 0.4673489543963513, 'recall': 0.4567036518991638, 'f1-score': 0.43182692441543846, 'support': 41323}, 'weighted avg': {'precision': 0.48295105366697566, 'recall': 0.43852092055271885, 'f1-score': 0.427020832777032, 'support': 41323}}
[[4912 1639 5068]
 [4416 4861 7844]
 [2601 1634 8348]]
training model: results/XRAY/W5/deepLOB_L2/h20
Epoch 1/50
483/483 - 22s - loss: 3.3255 - accuracy20: 0.3603 - val_loss: 3.4376 - val_accuracy20: 0.3132 - 22s/epoch - 46ms/step
Epoch 2/50
483/483 - 20s - loss: 3.2603 - accuracy20: 0.3857 - val_loss: 3.2720 - val_accuracy20: 0.3963 - 20s/epoch - 42ms/step
Epoch 3/50
483/483 - 20s - loss: 3.2155 - accuracy20: 0.4126 - val_loss: 3.3181 - val_accuracy20: 0.3866 - 20s/epoch - 42ms/step
Epoch 4/50
483/483 - 20s - loss: 3.1771 - accuracy20: 0.4311 - val_loss: 3.2746 - val_accuracy20: 0.4090 - 20s/epoch - 41ms/step
Epoch 5/50
483/483 - 21s - loss: 3.1543 - accuracy20: 0.4402 - val_loss: 3.2152 - val_accuracy20: 0.4250 - 21s/epoch - 43ms/step
Epoch 6/50
483/483 - 20s - loss: 3.1332 - accuracy20: 0.4468 - val_loss: 3.2765 - val_accuracy20: 0.4159 - 20s/epoch - 42ms/step
Epoch 7/50
483/483 - 20s - loss: 3.1105 - accuracy20: 0.4555 - val_loss: 3.2418 - val_accuracy20: 0.4302 - 20s/epoch - 42ms/step
Epoch 8/50
483/483 - 20s - loss: 3.0892 - accuracy20: 0.4656 - val_loss: 3.2330 - val_accuracy20: 0.4300 - 20s/epoch - 41ms/step
Epoch 9/50
483/483 - 20s - loss: 3.0752 - accuracy20: 0.4698 - val_loss: 3.2402 - val_accuracy20: 0.4323 - 20s/epoch - 42ms/step
Epoch 10/50
483/483 - 20s - loss: 3.0642 - accuracy20: 0.4754 - val_loss: 3.2869 - val_accuracy20: 0.4231 - 20s/epoch - 42ms/step
Epoch 11/50
483/483 - 20s - loss: 3.0524 - accuracy20: 0.4783 - val_loss: 3.2671 - val_accuracy20: 0.4332 - 20s/epoch - 41ms/step
Epoch 12/50
483/483 - 20s - loss: 3.0412 - accuracy20: 0.4816 - val_loss: 3.2735 - val_accuracy20: 0.4319 - 20s/epoch - 41ms/step
Epoch 13/50
483/483 - 20s - loss: 3.0345 - accuracy20: 0.4839 - val_loss: 3.2849 - val_accuracy20: 0.4324 - 20s/epoch - 42ms/step
Epoch 14/50
483/483 - 20s - loss: 3.0258 - accuracy20: 0.4869 - val_loss: 3.2914 - val_accuracy20: 0.4294 - 20s/epoch - 41ms/step
Epoch 15/50
483/483 - 20s - loss: 3.0167 - accuracy20: 0.4881 - val_loss: 3.2939 - val_accuracy20: 0.4244 - 20s/epoch - 41ms/step
testing model: results/XRAY/W5/deepLOB_L2/h20
Evaluating performance on  test set...
2341/2341 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0828125
{'0': {'precision': 0.4466857919371886, 'recall': 0.3581806206656077, 'f1-score': 0.39756707869366215, 'support': 206488}, '1': {'precision': 0.3641396728847406, 'recall': 0.4466485147984178, 'f1-score': 0.4011958894909526, 'support': 186574}, '2': {'precision': 0.4361878169863174, 'recall': 0.4333069861944225, 'f1-score': 0.43474262917193734, 'support': 206221}, 'accuracy': 0.4115751656562926, 'macro avg': {'precision': 0.4156710939360822, 'recall': 0.41271204055281596, 'f1-score': 0.41116853245218404, 'support': 599283}, 'weighted avg': {'precision': 0.4173743272227965, 'recall': 0.4115751656562926, 'f1-score': 0.41148941745660733, 'support': 599283}}
[[73960 74760 57768]
 [45507 83333 57734]
 [46108 70756 89357]]
Evaluating performance on  train set...
483/483 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0559088
{'0': {'precision': 0.4512167606768735, 'recall': 0.3505709706501052, 'f1-score': 0.394576997336415, 'support': 39932}, '1': {'precision': 0.447005444646098, 'recall': 0.4036098040592738, 'f1-score': 0.42420067169412085, 'support': 42717}, '2': {'precision': 0.42043156390893743, 'recall': 0.5548074333423108, 'f1-score': 0.478361832383365, 'support': 40843}, 'accuracy': 0.4364655200336864, 'macro avg': {'precision': 0.4395512564106363, 'recall': 0.4363294026838966, 'f1-score': 0.43237983380463363, 'support': 123492}, 'weighted avg': {'precision': 0.43957831787507695, 'recall': 0.4364655200336864, 'f1-score': 0.4325345858066049, 'support': 123492}}
[[13999 10932 15001]
 [ 9240 17241 16236]
 [ 7786 10397 22660]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0689948
{'0': {'precision': 0.43335761107064824, 'recall': 0.3401214719542694, 'f1-score': 0.38112014091837143, 'support': 13995}, '1': {'precision': 0.4085631349782293, 'recall': 0.27266123173783197, 'f1-score': 0.3270562037081861, 'support': 12389}, '2': {'precision': 0.4306103031126818, 'recall': 0.6361871611218957, 'f1-score': 0.513590921372602, 'support': 14939}, 'accuracy': 0.42692931297340464, 'macro avg': {'precision': 0.42417701638718647, 'recall': 0.41632328827133236, 'f1-score': 0.40725575533305314, 'support': 41323}, 'weighted avg': {'precision': 0.42493080764657354, 'recall': 0.42692931297340464, 'f1-score': 0.41280184048299073, 'support': 41323}}
[[4760 2421 6814]
 [3258 3378 5753]
 [2966 2469 9504]]
training model: results/XRAY/W5/deepLOB_L2/h30
Epoch 1/50
483/483 - 22s - loss: 3.3223 - accuracy30: 0.3589 - val_loss: 3.2959 - val_accuracy30: 0.3679 - 22s/epoch - 45ms/step
Epoch 2/50
483/483 - 20s - loss: 3.2533 - accuracy30: 0.3903 - val_loss: 3.2713 - val_accuracy30: 0.3908 - 20s/epoch - 41ms/step
Epoch 3/50
483/483 - 20s - loss: 3.2053 - accuracy30: 0.4126 - val_loss: 3.2257 - val_accuracy30: 0.4148 - 20s/epoch - 42ms/step
Epoch 4/50
483/483 - 20s - loss: 3.1860 - accuracy30: 0.4262 - val_loss: 3.2172 - val_accuracy30: 0.4136 - 20s/epoch - 41ms/step
Epoch 5/50
483/483 - 20s - loss: 3.1709 - accuracy30: 0.4301 - val_loss: 3.2197 - val_accuracy30: 0.4163 - 20s/epoch - 41ms/step
Epoch 6/50
483/483 - 20s - loss: 3.1521 - accuracy30: 0.4377 - val_loss: 3.2068 - val_accuracy30: 0.4143 - 20s/epoch - 42ms/step
Epoch 7/50
483/483 - 20s - loss: 3.1374 - accuracy30: 0.4424 - val_loss: 3.2013 - val_accuracy30: 0.4193 - 20s/epoch - 42ms/step
Epoch 8/50
483/483 - 20s - loss: 3.1235 - accuracy30: 0.4482 - val_loss: 3.2146 - val_accuracy30: 0.4187 - 20s/epoch - 42ms/step
Epoch 9/50
483/483 - 20s - loss: 3.1113 - accuracy30: 0.4514 - val_loss: 3.2206 - val_accuracy30: 0.4151 - 20s/epoch - 41ms/step
Epoch 10/50
483/483 - 20s - loss: 3.1026 - accuracy30: 0.4547 - val_loss: 3.2247 - val_accuracy30: 0.4156 - 20s/epoch - 42ms/step
Epoch 11/50
483/483 - 20s - loss: 3.0896 - accuracy30: 0.4605 - val_loss: 3.2295 - val_accuracy30: 0.4161 - 20s/epoch - 42ms/step
Epoch 12/50
483/483 - 20s - loss: 3.0798 - accuracy30: 0.4643 - val_loss: 3.2358 - val_accuracy30: 0.4123 - 20s/epoch - 42ms/step
Epoch 13/50
483/483 - 20s - loss: 3.0703 - accuracy30: 0.4678 - val_loss: 3.2279 - val_accuracy30: 0.4191 - 20s/epoch - 42ms/step
Epoch 14/50
483/483 - 21s - loss: 3.0614 - accuracy30: 0.4727 - val_loss: 3.2295 - val_accuracy30: 0.4165 - 21s/epoch - 43ms/step
Epoch 15/50
483/483 - 21s - loss: 3.0503 - accuracy30: 0.4737 - val_loss: 3.2330 - val_accuracy30: 0.4159 - 21s/epoch - 43ms/step
Epoch 16/50
483/483 - 21s - loss: 3.0426 - accuracy30: 0.4759 - val_loss: 3.2393 - val_accuracy30: 0.4180 - 21s/epoch - 42ms/step
Epoch 17/50
483/483 - 21s - loss: 3.0317 - accuracy30: 0.4824 - val_loss: 3.2587 - val_accuracy30: 0.4142 - 21s/epoch - 43ms/step
testing model: results/XRAY/W5/deepLOB_L2/h30
Evaluating performance on  test set...
2341/2341 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.081981
{'0': {'precision': 0.4397718426253069, 'recall': 0.41165094802337476, 'f1-score': 0.4252470051753465, 'support': 214077}, '1': {'precision': 0.3578699407523735, 'recall': 0.4385537250328036, 'f1-score': 0.3941248919053484, 'support': 171475}, '2': {'precision': 0.44648230557321467, 'recall': 0.39431809143268876, 'f1-score': 0.41878203487779847, 'support': 213731}, 'accuracy': 0.4131670679795689, 'macro avg': {'precision': 0.4147080296502983, 'recall': 0.414840921496289, 'f1-score': 0.4127179773194978, 'support': 599283}, 'weighted avg': {'precision': 0.4187302067582091, 'recall': 0.4131670679795689, 'f1-score': 0.41403622672903956, 'support': 599283}}
[[88125 67613 58339]
 [50131 75201 46143]
 [62132 67321 84278]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0528282
{'0': {'precision': 0.44603092626910107, 'recall': 0.3591135896683299, 'f1-score': 0.39788078752320427, 'support': 40884}, '1': {'precision': 0.44609272206599415, 'recall': 0.41750573463720875, 'f1-score': 0.43132608261823985, 'support': 41415}, '2': {'precision': 0.4197321187323889, 'recall': 0.5279537785546088, 'f1-score': 0.4676637242358102, 'support': 41193}, 'accuracy': 0.4350160334272665, 'macro avg': {'precision': 0.4372852556891614, 'recall': 0.4348577009533825, 'f1-score': 0.4322901981257514, 'support': 123492}, 'weighted avg': {'precision': 0.4372792054618305, 'recall': 0.4350160334272665, 'f1-score': 0.4323745637059795, 'support': 123492}}
[[14682 10733 15469]
 [ 9527 17291 14597]
 [ 8708 10737 21748]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0671562
{'0': {'precision': 0.4203798392987582, 'recall': 0.4016330518528858, 'f1-score': 0.4107926763981584, 'support': 14329}, '1': {'precision': 0.39042995839112343, 'recall': 0.18897373500041956, 'f1-score': 0.25467910658750353, 'support': 11917}, '2': {'precision': 0.42913331808826893, 'recall': 0.6223386615374411, 'f1-score': 0.507985490769314, 'support': 15077}, 'accuracy': 0.42083101420516417, 'macro avg': {'precision': 0.41331437192605014, 'recall': 0.40431514946358216, 'f1-score': 0.391152424584992, 'support': 41323}, 'weighted avg': {'precision': 0.41493646560694425, 'recall': 0.42083101420516417, 'f1-score': 0.40123312483705054, 'support': 41323}}
[[5755 1693 6881]
 [4064 2252 5601]
 [3871 1823 9383]]
training model: results/XRAY/W5/deepLOB_L2/h50
Epoch 1/50
483/483 - 22s - loss: 3.3332 - accuracy50: 0.3503 - val_loss: 3.3281 - val_accuracy50: 0.3663 - 22s/epoch - 45ms/step
Epoch 2/50
483/483 - 20s - loss: 3.2713 - accuracy50: 0.3788 - val_loss: 3.2874 - val_accuracy50: 0.3822 - 20s/epoch - 42ms/step
Epoch 3/50
483/483 - 20s - loss: 3.2484 - accuracy50: 0.3937 - val_loss: 3.2683 - val_accuracy50: 0.3876 - 20s/epoch - 41ms/step
Epoch 4/50
483/483 - 20s - loss: 3.2250 - accuracy50: 0.4063 - val_loss: 3.2620 - val_accuracy50: 0.3940 - 20s/epoch - 42ms/step
Epoch 5/50
483/483 - 20s - loss: 3.2100 - accuracy50: 0.4125 - val_loss: 3.2623 - val_accuracy50: 0.3942 - 20s/epoch - 41ms/step
Epoch 6/50
483/483 - 20s - loss: 3.1961 - accuracy50: 0.4177 - val_loss: 3.2637 - val_accuracy50: 0.3929 - 20s/epoch - 41ms/step
Epoch 7/50
483/483 - 20s - loss: 3.1844 - accuracy50: 0.4238 - val_loss: 3.2664 - val_accuracy50: 0.3882 - 20s/epoch - 42ms/step
Epoch 8/50
483/483 - 20s - loss: 3.1747 - accuracy50: 0.4296 - val_loss: 3.2762 - val_accuracy50: 0.3893 - 20s/epoch - 41ms/step
Epoch 9/50
483/483 - 20s - loss: 3.1652 - accuracy50: 0.4315 - val_loss: 3.2732 - val_accuracy50: 0.3943 - 20s/epoch - 41ms/step
Epoch 10/50
483/483 - 20s - loss: 3.1534 - accuracy50: 0.4378 - val_loss: 3.2887 - val_accuracy50: 0.3896 - 20s/epoch - 41ms/step
Epoch 11/50
483/483 - 20s - loss: 3.1456 - accuracy50: 0.4426 - val_loss: 3.2756 - val_accuracy50: 0.3961 - 20s/epoch - 41ms/step
Epoch 12/50
483/483 - 20s - loss: 3.1385 - accuracy50: 0.4444 - val_loss: 3.2865 - val_accuracy50: 0.3923 - 20s/epoch - 41ms/step
Epoch 13/50
483/483 - 20s - loss: 3.1301 - accuracy50: 0.4481 - val_loss: 3.2942 - val_accuracy50: 0.3935 - 20s/epoch - 41ms/step
Epoch 14/50
483/483 - 20s - loss: 3.1152 - accuracy50: 0.4541 - val_loss: 3.3013 - val_accuracy50: 0.3912 - 20s/epoch - 42ms/step
testing model: results/XRAY/W5/deepLOB_L2/h50
Evaluating performance on  test set...
2341/2341 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1046413
{'0': {'precision': 0.39271036500417944, 'recall': 0.321833776538811, 'f1-score': 0.3537568989994327, 'support': 210211}, '1': {'precision': 0.33028544399366894, 'recall': 0.5080169909840332, 'f1-score': 0.40031046176777985, 'support': 178683}, '2': {'precision': 0.41473688360845334, 'recall': 0.29998241352922445, 'f1-score': 0.34814722877277177, 'support': 210389}, 'accuracy': 0.3696750950719443, 'macro avg': {'precision': 0.3792442308687672, 'recall': 0.37661106035068953, 'f1-score': 0.3674048631799948, 'support': 599283}, 'weighted avg': {'precision': 0.3818304719681907, 'recall': 0.3696750950719443, 'f1-score': 0.3656679950038574, 'support': 599283}}
[[67653 92489 50069]
 [48915 90774 38994]
 [55704 91572 63113]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0796583
{'0': {'precision': 0.41731059969763146, 'recall': 0.23945155304947108, 'f1-score': 0.3042978977507617, 'support': 41499}, '1': {'precision': 0.3971533620553538, 'recall': 0.43300870591707247, 'f1-score': 0.41430672392493684, 'support': 40662}, '2': {'precision': 0.39485428297830055, 'recall': 0.5287556555612011, 'f1-score': 0.4520987194604771, 'support': 41331}, 'accuracy': 0.40000971722864637, 'macro avg': {'precision': 0.40310608157709527, 'recall': 0.4004053048425815, 'f1-score': 0.39023444704539184, 'support': 123492}, 'weighted avg': {'precision': 0.40315765356883804, 'recall': 0.40000971722864637, 'f1-score': 0.38998712986278966, 'support': 123492}}
[[ 9937 13967 17595]
 [ 7157 17607 15898]
 [ 6718 12759 21854]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0878805
{'0': {'precision': 0.38200685629574727, 'recall': 0.285387969820724, 'f1-score': 0.3267036450079239, 'support': 14447}, '1': {'precision': 0.37149590672289756, 'recall': 0.24914732551368438, 'f1-score': 0.2982622118209431, 'support': 12021}, '2': {'precision': 0.40430834965283957, 'recall': 0.6115112756647594, 'f1-score': 0.48677759022586603, 'support': 14855}, 'accuracy': 0.39208189144060207, 'macro avg': {'precision': 0.3859370375571614, 'recall': 0.3820155236663892, 'f1-score': 0.3705811490182443, 'support': 41323}, 'weighted avg': {'precision': 0.3869662386979054, 'recall': 0.39208189144060207, 'f1-score': 0.3759741236244773, 'support': 41323}}
[[4123 2622 7702]
 [3344 2995 5682]
 [3326 2445 9084]]
training model: results/XRAY/W5/deepLOB_L2/h100
Epoch 1/50
483/483 - 23s - loss: 3.3239 - accuracy100: 0.3575 - val_loss: 3.3847 - val_accuracy100: 0.3262 - 23s/epoch - 47ms/step
Epoch 2/50
483/483 - 20s - loss: 3.2882 - accuracy100: 0.3701 - val_loss: 3.3603 - val_accuracy100: 0.3312 - 20s/epoch - 42ms/step
Epoch 3/50
483/483 - 20s - loss: 3.2637 - accuracy100: 0.3798 - val_loss: 3.3811 - val_accuracy100: 0.3382 - 20s/epoch - 42ms/step
Epoch 4/50
483/483 - 20s - loss: 3.2561 - accuracy100: 0.3870 - val_loss: 3.4030 - val_accuracy100: 0.3483 - 20s/epoch - 42ms/step
Epoch 5/50
483/483 - 20s - loss: 3.2432 - accuracy100: 0.3931 - val_loss: 3.3793 - val_accuracy100: 0.3544 - 20s/epoch - 41ms/step
Epoch 6/50
483/483 - 20s - loss: 3.2296 - accuracy100: 0.3985 - val_loss: 3.4492 - val_accuracy100: 0.3434 - 20s/epoch - 41ms/step
Epoch 7/50
483/483 - 20s - loss: 3.2167 - accuracy100: 0.4042 - val_loss: 3.3901 - val_accuracy100: 0.3563 - 20s/epoch - 41ms/step
Epoch 8/50
483/483 - 20s - loss: 3.2082 - accuracy100: 0.4096 - val_loss: 3.4336 - val_accuracy100: 0.3451 - 20s/epoch - 41ms/step
Epoch 9/50
483/483 - 20s - loss: 3.1991 - accuracy100: 0.4150 - val_loss: 3.4220 - val_accuracy100: 0.3566 - 20s/epoch - 41ms/step
Epoch 10/50
483/483 - 20s - loss: 3.1895 - accuracy100: 0.4198 - val_loss: 3.4404 - val_accuracy100: 0.3544 - 20s/epoch - 42ms/step
Epoch 11/50
483/483 - 20s - loss: 3.1798 - accuracy100: 0.4247 - val_loss: 3.5125 - val_accuracy100: 0.3488 - 20s/epoch - 42ms/step
Epoch 12/50
483/483 - 20s - loss: 3.1727 - accuracy100: 0.4284 - val_loss: 3.4956 - val_accuracy100: 0.3547 - 20s/epoch - 42ms/step
testing model: results/XRAY/W5/deepLOB_L2/h100
Evaluating performance on  test set...
2341/2341 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1096802
{'0': {'precision': 0.34647267252031455, 'recall': 0.20308902532617037, 'f1-score': 0.25607606075909556, 'support': 208480}, '1': {'precision': 0.31598016781083144, 'recall': 0.4811964570930739, 'f1-score': 0.38146762589928057, 'support': 179062}, '2': {'precision': 0.36748013620885356, 'recall': 0.35472582069603903, 'f1-score': 0.3609903564485393, 'support': 211741}, 'accuracy': 0.33976268307293883, 'macro avg': {'precision': 0.3433109921799999, 'recall': 0.34633710103842774, 'f1-score': 0.33284468103563847, 'support': 599283}, 'weighted avg': {'precision': 0.3447841422109039, 'recall': 0.33976268307293883, 'f1-score': 0.3306110005466589, 'support': 599283}}
[[42340 92043 74097]
 [37713 86164 55185]
 [42150 94481 75110]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.108181
{'0': {'precision': 0.35271800679501697, 'recall': 0.1507429456463869, 'f1-score': 0.21121698145196838, 'support': 41322}, '1': {'precision': 0.3396681379761321, 'recall': 0.4036033411033411, 'f1-score': 0.3688859298712827, 'support': 41184}, '2': {'precision': 0.3471948818897638, 'recall': 0.4819694529839457, 'f1-score': 0.40362885923867514, 'support': 40986}, 'accuracy': 0.34500210539954007, 'macro avg': {'precision': 0.3465270088869709, 'recall': 0.34543857991122456, 'f1-score': 0.3279105901873087, 'support': 123492}, 'weighted avg': {'precision': 0.3465328563820051, 'recall': 0.34500210539954007, 'f1-score': 0.3276587849264202, 'support': 123492}}
[[ 6229 16428 18665]
 [ 6085 16622 18477]
 [ 5346 15886 19754]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1186504
{'0': {'precision': 0.36410748560460654, 'recall': 0.12917063870352716, 'f1-score': 0.19069159630076396, 'support': 14686}, '1': {'precision': 0.29767494484358203, 'recall': 0.4362822319873974, 'f1-score': 0.3538906449660368, 'support': 12061}, '2': {'precision': 0.3658060316771534, 'recall': 0.4626783754116356, 'f1-score': 0.40857869865503454, 'support': 14576}, 'accuracy': 0.3364470149795513, 'macro avg': {'precision': 0.34252948737511396, 'recall': 0.34271041536752006, 'f1-score': 0.3177203133072784, 'support': 41323}, 'weighted avg': {'precision': 0.34531686375804954, 'recall': 0.3364470149795513, 'f1-score': 0.3151807701232769, 'support': 41323}}
[[1897 6257 6532]
 [1639 5262 5160]
 [1674 6158 6744]]
training model: results/XRAY/W5/deepLOB_L2/h200
Epoch 1/50
483/483 - 22s - loss: 3.3365 - accuracy200: 0.3632 - val_loss: 3.3636 - val_accuracy200: 0.3404 - 22s/epoch - 45ms/step
Epoch 2/50
483/483 - 20s - loss: 3.2769 - accuracy200: 0.3783 - val_loss: 3.3254 - val_accuracy200: 0.3443 - 20s/epoch - 42ms/step
Epoch 3/50
483/483 - 20s - loss: 3.2687 - accuracy200: 0.3789 - val_loss: 3.2980 - val_accuracy200: 0.3556 - 20s/epoch - 42ms/step
Epoch 4/50
483/483 - 20s - loss: 3.2528 - accuracy200: 0.3894 - val_loss: 3.3143 - val_accuracy200: 0.3552 - 20s/epoch - 42ms/step
Epoch 5/50
483/483 - 20s - loss: 3.2334 - accuracy200: 0.4015 - val_loss: 3.3385 - val_accuracy200: 0.3581 - 20s/epoch - 41ms/step
Epoch 6/50
483/483 - 20s - loss: 3.2125 - accuracy200: 0.4123 - val_loss: 3.3540 - val_accuracy200: 0.3578 - 20s/epoch - 42ms/step
Epoch 7/50
483/483 - 20s - loss: 3.1962 - accuracy200: 0.4212 - val_loss: 3.4027 - val_accuracy200: 0.3573 - 20s/epoch - 41ms/step
Epoch 8/50
483/483 - 20s - loss: 3.1820 - accuracy200: 0.4268 - val_loss: 3.4341 - val_accuracy200: 0.3568 - 20s/epoch - 42ms/step
Epoch 9/50
483/483 - 20s - loss: 3.1680 - accuracy200: 0.4342 - val_loss: 3.4256 - val_accuracy200: 0.3579 - 20s/epoch - 41ms/step
Epoch 10/50
483/483 - 20s - loss: 3.1550 - accuracy200: 0.4397 - val_loss: 3.4433 - val_accuracy200: 0.3598 - 20s/epoch - 41ms/step
Epoch 11/50
483/483 - 20s - loss: 3.1410 - accuracy200: 0.4444 - val_loss: 3.4775 - val_accuracy200: 0.3587 - 20s/epoch - 42ms/step
Epoch 12/50
483/483 - 20s - loss: 3.1269 - accuracy200: 0.4502 - val_loss: 3.5096 - val_accuracy200: 0.3603 - 20s/epoch - 41ms/step
Epoch 13/50
483/483 - 20s - loss: 3.1084 - accuracy200: 0.4572 - val_loss: 3.4932 - val_accuracy200: 0.3603 - 20s/epoch - 41ms/step
testing model: results/XRAY/W5/deepLOB_L2/h200
Evaluating performance on  test set...
2341/2341 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1038294
{'0': {'precision': 0.3359404282965591, 'recall': 0.12372139678917024, 'f1-score': 0.18084172649773847, 'support': 217327}, '1': {'precision': 0.2754204906617148, 'recall': 0.25295008953579134, 'f1-score': 0.263707482528003, 'support': 152453}, '2': {'precision': 0.3839411438968436, 'recall': 0.6344230794368702, 'f1-score': 0.4783772195691707, 'support': 229503}, 'accuracy': 0.3521758501409184, 'macro avg': {'precision': 0.3317673542850392, 'recall': 0.3370315219206106, 'f1-score': 0.3076421428649707, 'support': 599283}, 'weighted avg': {'precision': 0.3389271010040565, 'recall': 0.3521758501409184, 'f1-score': 0.31586711745735996, 'support': 599283}}
[[ 26888  48094 142345]
 [ 22607  38563  91283]
 [ 30543  53358 145602]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0980508
{'0': {'precision': 0.38011920784464526, 'recall': 0.09554878932869364, 'f1-score': 0.15271126216592, 'support': 41382}, '1': {'precision': 0.40474900241391204, 'recall': 0.2016988265331173, 'f1-score': 0.2692313994068783, 'support': 40734}, '2': {'precision': 0.3436540181698656, 'recall': 0.7706883217324053, 'f1-score': 0.47534788733444144, 'support': 41376}, 'accuracy': 0.35676804975221066, 'macro avg': {'precision': 0.3761740761428077, 'recall': 0.35597864586473876, 'f1-score': 0.29909684963574656, 'support': 123492}, 'weighted avg': {'precision': 0.37602571485725206, 'recall': 0.35676804975221066, 'f1-score': 0.29924499935817483, 'support': 123492}}
[[ 3954  5991 31437]
 [ 3052  8216 29466]
 [ 3396  6092 31888]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0994382
{'0': {'precision': 0.35770825480588014, 'recall': 0.1254710120975739, 'f1-score': 0.18577790828561644, 'support': 15127}, '1': {'precision': 0.32193158953722334, 'recall': 0.0985741946840345, 'f1-score': 0.15093322552388655, 'support': 11362}, '2': {'precision': 0.35782777060667526, 'recall': 0.7848860725360658, 'f1-score': 0.4915561935320442, 'support': 14834}, 'accuracy': 0.354790310480846, 'macro avg': {'precision': 0.34582253831659293, 'recall': 0.3363104264392247, 'f1-score': 0.2760891091138491, 'support': 41323}, 'weighted avg': {'precision': 0.3479141553118094, 'recall': 0.354790310480846, 'f1-score': 0.2859644822954108, 'support': 41323}}
[[ 1898  1127 12102]
 [ 1449  1120  8793]
 [ 1959  1232 11643]]
training model: results/XRAY/W5/deepLOB_L2/h300
Epoch 1/50
483/483 - 22s - loss: 3.3079 - accuracy300: 0.3716 - val_loss: 3.4168 - val_accuracy300: 0.3133 - 22s/epoch - 45ms/step
Epoch 2/50
483/483 - 20s - loss: 3.2551 - accuracy300: 0.3928 - val_loss: 3.4126 - val_accuracy300: 0.3336 - 20s/epoch - 41ms/step
Epoch 3/50
483/483 - 20s - loss: 3.2324 - accuracy300: 0.4030 - val_loss: 3.5042 - val_accuracy300: 0.3452 - 20s/epoch - 42ms/step
Epoch 4/50
483/483 - 20s - loss: 3.2249 - accuracy300: 0.4073 - val_loss: 3.3709 - val_accuracy300: 0.3517 - 20s/epoch - 42ms/step
Epoch 5/50
483/483 - 20s - loss: 3.2111 - accuracy300: 0.4109 - val_loss: 3.6448 - val_accuracy300: 0.3450 - 20s/epoch - 42ms/step
Epoch 6/50
483/483 - 20s - loss: 3.1924 - accuracy300: 0.4197 - val_loss: 3.6599 - val_accuracy300: 0.3532 - 20s/epoch - 41ms/step
Epoch 7/50
483/483 - 20s - loss: 3.1745 - accuracy300: 0.4281 - val_loss: 3.6805 - val_accuracy300: 0.3522 - 20s/epoch - 42ms/step
Epoch 8/50
483/483 - 20s - loss: 3.1583 - accuracy300: 0.4349 - val_loss: 3.6500 - val_accuracy300: 0.3550 - 20s/epoch - 42ms/step
Epoch 9/50
483/483 - 20s - loss: 3.1457 - accuracy300: 0.4392 - val_loss: 3.7317 - val_accuracy300: 0.3563 - 20s/epoch - 42ms/step
Epoch 10/50
483/483 - 20s - loss: 3.1266 - accuracy300: 0.4484 - val_loss: 3.7550 - val_accuracy300: 0.3545 - 20s/epoch - 42ms/step
Epoch 11/50
483/483 - 20s - loss: 3.1127 - accuracy300: 0.4548 - val_loss: 3.7789 - val_accuracy300: 0.3530 - 20s/epoch - 42ms/step
Epoch 12/50
483/483 - 20s - loss: 3.0904 - accuracy300: 0.4610 - val_loss: 3.8435 - val_accuracy300: 0.3537 - 20s/epoch - 42ms/step
Epoch 13/50
483/483 - 21s - loss: 3.0746 - accuracy300: 0.4684 - val_loss: 3.9050 - val_accuracy300: 0.3532 - 21s/epoch - 43ms/step
Epoch 14/50
483/483 - 20s - loss: 3.0535 - accuracy300: 0.4748 - val_loss: 3.8944 - val_accuracy300: 0.3528 - 20s/epoch - 42ms/step
testing model: results/XRAY/W5/deepLOB_L2/h300
Evaluating performance on  test set...
2341/2341 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1213971
{'0': {'precision': 0.3828728723672913, 'recall': 0.13211452074610153, 'f1-score': 0.19644390024262331, 'support': 229513}, '1': {'precision': 0.22581470217012972, 'recall': 0.33092417254697454, 'f1-score': 0.2684473704214134, 'support': 122726}, '2': {'precision': 0.4029644129369026, 'recall': 0.5549740127264778, 'f1-score': 0.4669084593379648, 'support': 247044}, 'accuracy': 0.3471448380815074, 'macro avg': {'precision': 0.3372173291581078, 'recall': 0.3393375686731846, 'f1-score': 0.31059991000066717, 'support': 599283}, 'weighted avg': {'precision': 0.35899162352970077, 'recall': 0.3471448380815074, 'f1-score': 0.3226836641243148, 'support': 599283}}
[[ 30322  62664 136527]
 [ 15507  40613  66606]
 [ 33367  76574 137103]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1038423
{'0': {'precision': 0.3744366017518497, 'recall': 0.10650959142698178, 'f1-score': 0.16584428792044897, 'support': 41339}, '1': {'precision': 0.4064878424218238, 'recall': 0.34614170934776806, 'f1-score': 0.37389548755866703, 'support': 41197}, '2': {'precision': 0.354302562229296, 'recall': 0.6631018654165446, 'f1-score': 0.46183933065777844, 'support': 40956}, 'accuracy': 0.37104427817186536, 'macro avg': {'precision': 0.37840900213432316, 'recall': 0.37191772206376483, 'f1-score': 0.3338597020456315, 'support': 123492}, 'weighted avg': {'precision': 0.378451479146298, 'recall': 0.37104427817186536, 'f1-score': 0.3334167480137808, 'support': 123492}}
[[ 4403 10365 26571]
 [ 4014 14260 22923]
 [ 3342 10456 27158]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1260902
{'0': {'precision': 0.3414569536423841, 'recall': 0.08541514810151746, 'f1-score': 0.13664793808968514, 'support': 15091}, '1': {'precision': 0.3314903846153846, 'recall': 0.11763200545935341, 'f1-score': 0.1736447774349934, 'support': 11723}, '2': {'precision': 0.3535102432011501, 'recall': 0.8134950720242609, 'f1-score': 0.49284923899200367, 'support': 14509}, 'accuracy': 0.35019238680637904, 'macro avg': {'precision': 0.3421525271529729, 'recall': 0.33884740852837725, 'f1-score': 0.2677139848388941, 'support': 41323}, 'weighted avg': {'precision': 0.34286157309171306, 'recall': 0.35019238680637904, 'f1-score': 0.27221018241939954, 'support': 41323}}
[[ 1289  1383 12419]
 [ 1178  1379  9166]
 [ 1308  1398 11803]]
training model: results/XRAY/W5/deepLOB_L2/h500
Epoch 1/50
483/483 - 22s - loss: 3.3294 - accuracy500: 0.3605 - val_loss: 3.5467 - val_accuracy500: 0.2979 - 22s/epoch - 46ms/step
Epoch 2/50
483/483 - 20s - loss: 3.2950 - accuracy500: 0.3677 - val_loss: 3.3636 - val_accuracy500: 0.3460 - 20s/epoch - 41ms/step
Epoch 3/50
483/483 - 20s - loss: 3.2648 - accuracy500: 0.3856 - val_loss: 3.3533 - val_accuracy500: 0.3432 - 20s/epoch - 41ms/step
Epoch 4/50
483/483 - 20s - loss: 3.2442 - accuracy500: 0.3984 - val_loss: 3.3908 - val_accuracy500: 0.3412 - 20s/epoch - 42ms/step
Epoch 5/50
483/483 - 20s - loss: 3.2282 - accuracy500: 0.4120 - val_loss: 3.3802 - val_accuracy500: 0.3415 - 20s/epoch - 42ms/step
Epoch 6/50
483/483 - 20s - loss: 3.2062 - accuracy500: 0.4231 - val_loss: 3.4254 - val_accuracy500: 0.3391 - 20s/epoch - 42ms/step
Epoch 7/50
483/483 - 20s - loss: 3.1963 - accuracy500: 0.4263 - val_loss: 3.4094 - val_accuracy500: 0.3431 - 20s/epoch - 41ms/step
Epoch 8/50
483/483 - 20s - loss: 3.1838 - accuracy500: 0.4312 - val_loss: 3.4392 - val_accuracy500: 0.3424 - 20s/epoch - 42ms/step
Epoch 9/50
483/483 - 20s - loss: 3.1656 - accuracy500: 0.4387 - val_loss: 3.4504 - val_accuracy500: 0.3415 - 20s/epoch - 41ms/step
Epoch 10/50
483/483 - 20s - loss: 3.1489 - accuracy500: 0.4459 - val_loss: 3.5000 - val_accuracy500: 0.3419 - 20s/epoch - 41ms/step
Epoch 11/50
483/483 - 20s - loss: 3.1376 - accuracy500: 0.4485 - val_loss: 3.5249 - val_accuracy500: 0.3416 - 20s/epoch - 42ms/step
Epoch 12/50
483/483 - 20s - loss: 3.1195 - accuracy500: 0.4563 - val_loss: 3.5368 - val_accuracy500: 0.3413 - 20s/epoch - 41ms/step
Epoch 13/50
483/483 - 20s - loss: 3.1012 - accuracy500: 0.4629 - val_loss: 3.5623 - val_accuracy500: 0.3421 - 20s/epoch - 41ms/step
testing model: results/XRAY/W5/deepLOB_L2/h500
Evaluating performance on  test set...
2341/2341 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1373768
{'0': {'precision': 0.32391459825772945, 'recall': 0.25616014761174033, 'f1-score': 0.28608041254727756, 'support': 215701}, '1': {'precision': 0.29624624299954594, 'recall': 0.17906341488916772, 'f1-score': 0.22320970356552272, 'support': 153024}, '2': {'precision': 0.3826065489415747, 'recall': 0.5579290243669706, 'f1-score': 0.4539271126480993, 'support': 230558}, 'accuracy': 0.35257132273066316, 'macro avg': {'precision': 0.33425579673295003, 'recall': 0.33105086228929287, 'f1-score': 0.32107240958696653, 'support': 599283}, 'weighted avg': {'precision': 0.339429766167945, 'recall': 0.35257132273066316, 'f1-score': 0.33460118171747133, 'support': 599283}}
[[ 55254  31330 129117]
 [ 47168  27401  78455]
 [ 68160  33763 128635]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1042955
{'0': {'precision': 0.36292470341376803, 'recall': 0.10672330730711727, 'f1-score': 0.16494278169014084, 'support': 42137}, '1': {'precision': 0.3876468815908406, 'recall': 0.1628030571443033, 'f1-score': 0.22930367677199737, 'support': 39514}, '2': {'precision': 0.34972382705859945, 'recall': 0.7899189789918979, 'f1-score': 0.48480714647186957, 'support': 41841}, 'accuracy': 0.35614452758073395, 'macro avg': {'precision': 0.3667651373544027, 'recall': 0.3531484478144395, 'f1-score': 0.29301786831133597, 'support': 123492}, 'weighted avg': {'precision': 0.3663624506436472, 'recall': 0.35614452758073395, 'f1-score': 0.2939114703104303, 'support': 123492}}
[[ 4497  4925 32715]
 [ 4341  6433 28740]
 [ 3553  5237 33051]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1194355
{'0': {'precision': 0.31294642857142857, 'recall': 0.13839168202158464, 'f1-score': 0.19191458295309363, 'support': 15196}, '1': {'precision': 0.3273350471293916, 'recall': 0.06576002754346703, 'f1-score': 0.10951834862385322, 'support': 11618}, '2': {'precision': 0.35129691034739224, 'recall': 0.7813081535598594, 'f1-score': 0.4846722818418915, 'support': 14509}, 'accuracy': 0.34370689446555186, 'macro avg': {'precision': 0.33052612868273745, 'recall': 0.328486621041637, 'f1-score': 0.2620350711396128, 'support': 41323}, 'weighted avg': {'precision': 0.33045711536797945, 'recall': 0.34370689446555186, 'f1-score': 0.2715395376451647, 'support': 41323}}
[[ 2103   807 12286]
 [ 2207   764  8647]
 [ 2410   763 11336]]
training model: results/XRAY/W5/deepLOB_L2/h1000
Epoch 1/50
483/483 - 22s - loss: 3.3168 - accuracy1000: 0.3840 - val_loss: 3.4966 - val_accuracy1000: 0.3439 - 22s/epoch - 46ms/step
Epoch 2/50
483/483 - 20s - loss: 3.2701 - accuracy1000: 0.3941 - val_loss: 3.3933 - val_accuracy1000: 0.3359 - 20s/epoch - 41ms/step
Epoch 3/50
483/483 - 20s - loss: 3.2379 - accuracy1000: 0.4054 - val_loss: 3.4404 - val_accuracy1000: 0.3435 - 20s/epoch - 41ms/step
Epoch 4/50
483/483 - 20s - loss: 3.2038 - accuracy1000: 0.4210 - val_loss: 3.4636 - val_accuracy1000: 0.3429 - 20s/epoch - 41ms/step
Epoch 5/50
483/483 - 20s - loss: 3.2007 - accuracy1000: 0.4299 - val_loss: 3.5765 - val_accuracy1000: 0.3425 - 20s/epoch - 41ms/step
Epoch 6/50
483/483 - 20s - loss: 3.1638 - accuracy1000: 0.4418 - val_loss: 3.6541 - val_accuracy1000: 0.3423 - 20s/epoch - 41ms/step
Epoch 7/50
483/483 - 20s - loss: 3.1332 - accuracy1000: 0.4566 - val_loss: 3.6694 - val_accuracy1000: 0.3435 - 20s/epoch - 41ms/step
Epoch 8/50
483/483 - 20s - loss: 3.1062 - accuracy1000: 0.4639 - val_loss: 3.7712 - val_accuracy1000: 0.3447 - 20s/epoch - 41ms/step
Epoch 9/50
483/483 - 20s - loss: 3.0842 - accuracy1000: 0.4714 - val_loss: 3.7732 - val_accuracy1000: 0.3454 - 20s/epoch - 41ms/step
Epoch 10/50
483/483 - 20s - loss: 3.0589 - accuracy1000: 0.4791 - val_loss: 3.8161 - val_accuracy1000: 0.3444 - 20s/epoch - 41ms/step
Epoch 11/50
483/483 - 20s - loss: 3.0395 - accuracy1000: 0.4846 - val_loss: 3.9114 - val_accuracy1000: 0.3454 - 20s/epoch - 41ms/step
Epoch 12/50
483/483 - 20s - loss: 3.0201 - accuracy1000: 0.4892 - val_loss: 3.7449 - val_accuracy1000: 0.3449 - 20s/epoch - 41ms/step
testing model: results/XRAY/W5/deepLOB_L2/h1000
Evaluating performance on  test set...
2341/2341 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1240128
{'0': {'precision': 0.34049217002237137, 'recall': 0.23348796314528944, 'f1-score': 0.2770159406274109, 'support': 218371}, '1': {'precision': 0.27227164515724844, 'recall': 0.19924681533876937, 'f1-score': 0.23010449324745952, 'support': 152685}, '2': {'precision': 0.37030941019052466, 'recall': 0.5481034233460546, 'f1-score': 0.4419969930975512, 'support': 228227}, 'accuracy': 0.34458010656067334, 'macro avg': {'precision': 0.32769107512338147, 'recall': 0.32694606727670444, 'f1-score': 0.3163724756574739, 'support': 599283}, 'weighted avg': {'precision': 0.3344663832619023, 'recall': 0.34458010656067334, 'f1-score': 0.3278941673064504, 'support': 599283}}
[[ 50987  38249 129135]
 [ 38686  30422  83577]
 [ 60072  43063 125092]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1089646
{'0': {'precision': 0.3527859237536657, 'recall': 0.08779953776912784, 'f1-score': 0.14060582448621797, 'support': 41105}, '1': {'precision': 0.39348840768230164, 'recall': 0.25114768509474505, 'f1-score': 0.30660307050231034, 'support': 40952}, '2': {'precision': 0.3523024654515403, 'recall': 0.7407747073729939, 'f1-score': 0.47750838136575424, 'support': 41435}, 'accuracy': 0.3610598257376996, 'macro avg': {'precision': 0.3661922656291692, 'recall': 0.3599073100789556, 'f1-score': 0.3082390921180942, 'support': 123492}, 'weighted avg': {'precision': 0.3661213303151995, 'recall': 0.3610598257376996, 'f1-score': 0.308693446867867, 'support': 123492}}
[[ 3609  8039 29457]
 [ 3694 10285 26973]
 [ 2927  7814 30694]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1302434
{'0': {'precision': 0.32669826224328596, 'recall': 0.1301529359934546, 'f1-score': 0.18614699131374046, 'support': 15889}, '1': {'precision': 0.2132401862940785, 'recall': 0.06008060736713844, 'f1-score': 0.09374771480804386, 'support': 10669}, '2': {'precision': 0.34926688967393005, 'recall': 0.7566542499153404, 'f1-score': 0.47792607802874754, 'support': 14765}, 'accuracy': 0.33591462381724463, 'macro avg': {'precision': 0.29640177940376483, 'recall': 0.31562926442531114, 'f1-score': 0.2526069280501773, 'support': 41323}, 'weighted avg': {'precision': 0.3054689606851069, 'recall': 0.33591462381724463, 'f1-score': 0.2665455667876364, 'support': 41323}}
[[ 2068  1247 12574]
 [ 1787   641  8241]
 [ 2475  1118 11172]]
training model: results/XRAY/W5/deepOF_L2/h10
Epoch 1/50
483/483 - 13s - loss: 3.2179 - accuracy10: 0.4294 - val_loss: 3.2388 - val_accuracy10: 0.4415 - 13s/epoch - 27ms/step
Epoch 2/50
483/483 - 11s - loss: 3.1097 - accuracy10: 0.4670 - val_loss: 3.2065 - val_accuracy10: 0.4527 - 11s/epoch - 23ms/step
Epoch 3/50
483/483 - 11s - loss: 3.0644 - accuracy10: 0.4800 - val_loss: 3.1873 - val_accuracy10: 0.4617 - 11s/epoch - 23ms/step
Epoch 4/50
483/483 - 11s - loss: 3.0344 - accuracy10: 0.4883 - val_loss: 3.1753 - val_accuracy10: 0.4672 - 11s/epoch - 23ms/step
Epoch 5/50
483/483 - 11s - loss: 3.0081 - accuracy10: 0.4970 - val_loss: 3.1673 - val_accuracy10: 0.4737 - 11s/epoch - 24ms/step
Epoch 6/50
483/483 - 11s - loss: 2.9887 - accuracy10: 0.5020 - val_loss: 3.1575 - val_accuracy10: 0.4781 - 11s/epoch - 23ms/step
Epoch 7/50
483/483 - 11s - loss: 2.9748 - accuracy10: 0.5047 - val_loss: 3.1627 - val_accuracy10: 0.4770 - 11s/epoch - 23ms/step
Epoch 8/50
483/483 - 11s - loss: 2.9586 - accuracy10: 0.5097 - val_loss: 3.1607 - val_accuracy10: 0.4851 - 11s/epoch - 23ms/step
Epoch 9/50
483/483 - 11s - loss: 2.9462 - accuracy10: 0.5128 - val_loss: 3.1553 - val_accuracy10: 0.4836 - 11s/epoch - 23ms/step
Epoch 10/50
483/483 - 11s - loss: 2.9323 - accuracy10: 0.5169 - val_loss: 3.1606 - val_accuracy10: 0.4832 - 11s/epoch - 23ms/step
Epoch 11/50
483/483 - 11s - loss: 2.9228 - accuracy10: 0.5193 - val_loss: 3.1514 - val_accuracy10: 0.4854 - 11s/epoch - 23ms/step
Epoch 12/50
483/483 - 11s - loss: 2.9153 - accuracy10: 0.5209 - val_loss: 3.1536 - val_accuracy10: 0.4840 - 11s/epoch - 23ms/step
Epoch 13/50
483/483 - 11s - loss: 2.9012 - accuracy10: 0.5253 - val_loss: 3.1552 - val_accuracy10: 0.4864 - 11s/epoch - 23ms/step
Epoch 14/50
483/483 - 11s - loss: 2.8948 - accuracy10: 0.5263 - val_loss: 3.1511 - val_accuracy10: 0.4849 - 11s/epoch - 23ms/step
Epoch 15/50
483/483 - 11s - loss: 2.8864 - accuracy10: 0.5270 - val_loss: 3.1456 - val_accuracy10: 0.4862 - 11s/epoch - 23ms/step
Epoch 16/50
483/483 - 11s - loss: 2.8788 - accuracy10: 0.5289 - val_loss: 3.1559 - val_accuracy10: 0.4878 - 11s/epoch - 23ms/step
Epoch 17/50
483/483 - 11s - loss: 2.8716 - accuracy10: 0.5307 - val_loss: 3.1597 - val_accuracy10: 0.4863 - 11s/epoch - 23ms/step
Epoch 18/50
483/483 - 11s - loss: 2.8650 - accuracy10: 0.5323 - val_loss: 3.1534 - val_accuracy10: 0.4860 - 11s/epoch - 23ms/step
Epoch 19/50
483/483 - 11s - loss: 2.8543 - accuracy10: 0.5342 - val_loss: 3.1657 - val_accuracy10: 0.4851 - 11s/epoch - 23ms/step
Epoch 20/50
483/483 - 11s - loss: 2.8456 - accuracy10: 0.5369 - val_loss: 3.1555 - val_accuracy10: 0.4873 - 11s/epoch - 23ms/step
Epoch 21/50
483/483 - 11s - loss: 2.8404 - accuracy10: 0.5367 - val_loss: 3.1574 - val_accuracy10: 0.4845 - 11s/epoch - 23ms/step
Epoch 22/50
483/483 - 11s - loss: 2.8313 - accuracy10: 0.5397 - val_loss: 3.1603 - val_accuracy10: 0.4872 - 11s/epoch - 23ms/step
Epoch 23/50
483/483 - 11s - loss: 2.8246 - accuracy10: 0.5412 - val_loss: 3.1755 - val_accuracy10: 0.4863 - 11s/epoch - 23ms/step
Epoch 24/50
483/483 - 11s - loss: 2.8188 - accuracy10: 0.5413 - val_loss: 3.1843 - val_accuracy10: 0.4860 - 11s/epoch - 23ms/step
Epoch 25/50
483/483 - 11s - loss: 2.8096 - accuracy10: 0.5437 - val_loss: 3.1982 - val_accuracy10: 0.4853 - 11s/epoch - 23ms/step
testing model: results/XRAY/W5/deepOF_L2/h10
Evaluating performance on  test set...
2341/2341 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0128485
{'0': {'precision': 0.4444131254021263, 'recall': 0.42062102003178176, 'f1-score': 0.43218988084774196, 'support': 172426}, '1': {'precision': 0.5603495268190518, 'recall': 0.5381284883217482, 'f1-score': 0.5490142536176159, 'support': 254062}, '2': {'precision': 0.4310396884890888, 'recall': 0.4792001851959025, 'f1-score': 0.45384585870655497, 'support': 172790}, 'accuracy': 0.48732808479537043, 'macro avg': {'precision': 0.4786007802367556, 'recall': 0.4793165645164775, 'f1-score': 0.47834999772397097, 'support': 599278}, 'weighted avg': {'precision': 0.4897080266876451, 'recall': 0.48732808479537043, 'f1-score': 0.48796127610817874, 'support': 599278}}
[[ 72526  56107  43793]
 [ 51842 136718  65502]
 [ 38827  51162  82801]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95639306
{'0': {'precision': 0.4808028210789968, 'recall': 0.440928461329223, 'f1-score': 0.4600031530821378, 'support': 33087}, '1': {'precision': 0.6148817048943471, 'recall': 0.6014663015634661, 'f1-score': 0.6081000223264121, 'support': 56605}, '2': {'precision': 0.4595939543132428, 'recall': 0.513698224852071, 'f1-score': 0.4851422903365512, 'support': 33800}, 'accuracy': 0.5344313801703754, 'macro avg': {'precision': 0.5184261600955289, 'recall': 0.5186976625815867, 'f1-score': 0.5177484885817004, 'support': 123492}, 'weighted avg': {'precision': 0.5364556206262178, 'recall': 0.5344313801703754, 'f1-score': 0.5347669120525272, 'support': 123492}}
[[14589 11138  7360]
 [ 9503 34046 13056]
 [ 6251 10186 17363]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0091977
{'0': {'precision': 0.441684767211257, 'recall': 0.4031896551724138, 'f1-score': 0.42156023254765873, 'support': 11600}, '1': {'precision': 0.553564899451554, 'recall': 0.531041739740442, 'f1-score': 0.5420694593626925, 'support': 17106}, '2': {'precision': 0.4393325886623848, 'recall': 0.4987714987714988, 'f1-score': 0.4671689989235738, 'support': 12617}, 'accuracy': 0.48529874404084894, 'macro avg': {'precision': 0.4781940851083986, 'recall': 0.47766763122811823, 'f1-score': 0.47693289694464164, 'support': 41323}, 'weighted avg': {'precision': 0.4872802976749552, 'recall': 0.48529874404084894, 'f1-score': 0.4853715879493209, 'support': 41323}}
[[4677 3605 3318]
 [3309 9084 4713]
 [2603 3721 6293]]
training model: results/XRAY/W5/deepOF_L2/h20
Epoch 1/50
483/483 - 13s - loss: 3.2534 - accuracy20: 0.4006 - val_loss: 3.2261 - val_accuracy20: 0.4168 - 13s/epoch - 27ms/step
Epoch 2/50
483/483 - 11s - loss: 3.1667 - accuracy20: 0.4387 - val_loss: 3.1946 - val_accuracy20: 0.4305 - 11s/epoch - 24ms/step
Epoch 3/50
483/483 - 11s - loss: 3.1278 - accuracy20: 0.4546 - val_loss: 3.1817 - val_accuracy20: 0.4357 - 11s/epoch - 24ms/step
Epoch 4/50
483/483 - 11s - loss: 3.0992 - accuracy20: 0.4653 - val_loss: 3.1809 - val_accuracy20: 0.4398 - 11s/epoch - 23ms/step
Epoch 5/50
483/483 - 11s - loss: 3.0754 - accuracy20: 0.4744 - val_loss: 3.1764 - val_accuracy20: 0.4446 - 11s/epoch - 23ms/step
Epoch 6/50
483/483 - 11s - loss: 3.0576 - accuracy20: 0.4793 - val_loss: 3.1658 - val_accuracy20: 0.4446 - 11s/epoch - 24ms/step
Epoch 7/50
483/483 - 11s - loss: 3.0435 - accuracy20: 0.4842 - val_loss: 3.1616 - val_accuracy20: 0.4456 - 11s/epoch - 23ms/step
Epoch 8/50
483/483 - 11s - loss: 3.0296 - accuracy20: 0.4871 - val_loss: 3.1642 - val_accuracy20: 0.4480 - 11s/epoch - 24ms/step
Epoch 9/50
483/483 - 11s - loss: 3.0193 - accuracy20: 0.4920 - val_loss: 3.1572 - val_accuracy20: 0.4506 - 11s/epoch - 24ms/step
Epoch 10/50
483/483 - 11s - loss: 3.0082 - accuracy20: 0.4938 - val_loss: 3.1545 - val_accuracy20: 0.4497 - 11s/epoch - 23ms/step
Epoch 11/50
483/483 - 11s - loss: 2.9994 - accuracy20: 0.4967 - val_loss: 3.1514 - val_accuracy20: 0.4501 - 11s/epoch - 23ms/step
Epoch 12/50
483/483 - 11s - loss: 2.9917 - accuracy20: 0.4981 - val_loss: 3.1417 - val_accuracy20: 0.4540 - 11s/epoch - 24ms/step
Epoch 13/50
483/483 - 12s - loss: 2.9790 - accuracy20: 0.5027 - val_loss: 3.1489 - val_accuracy20: 0.4550 - 12s/epoch - 24ms/step
Epoch 14/50
483/483 - 11s - loss: 2.9726 - accuracy20: 0.5034 - val_loss: 3.1529 - val_accuracy20: 0.4543 - 11s/epoch - 23ms/step
Epoch 15/50
483/483 - 11s - loss: 2.9639 - accuracy20: 0.5068 - val_loss: 3.1511 - val_accuracy20: 0.4535 - 11s/epoch - 23ms/step
Epoch 16/50
483/483 - 11s - loss: 2.9573 - accuracy20: 0.5089 - val_loss: 3.1584 - val_accuracy20: 0.4545 - 11s/epoch - 23ms/step
Epoch 17/50
483/483 - 11s - loss: 2.9500 - accuracy20: 0.5101 - val_loss: 3.1628 - val_accuracy20: 0.4513 - 11s/epoch - 23ms/step
Epoch 18/50
483/483 - 11s - loss: 2.9442 - accuracy20: 0.5128 - val_loss: 3.1639 - val_accuracy20: 0.4523 - 11s/epoch - 23ms/step
Epoch 19/50
483/483 - 11s - loss: 2.9354 - accuracy20: 0.5145 - val_loss: 3.1624 - val_accuracy20: 0.4534 - 11s/epoch - 23ms/step
Epoch 20/50
483/483 - 11s - loss: 2.9283 - accuracy20: 0.5156 - val_loss: 3.1712 - val_accuracy20: 0.4516 - 11s/epoch - 23ms/step
Epoch 21/50
483/483 - 11s - loss: 2.9226 - accuracy20: 0.5177 - val_loss: 3.1769 - val_accuracy20: 0.4521 - 11s/epoch - 23ms/step
Epoch 22/50
483/483 - 11s - loss: 2.9148 - accuracy20: 0.5203 - val_loss: 3.1695 - val_accuracy20: 0.4556 - 11s/epoch - 23ms/step
testing model: results/XRAY/W5/deepOF_L2/h20
Evaluating performance on  test set...
2341/2341 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0461171
{'0': {'precision': 0.4695677807256122, 'recall': 0.40886747221347797, 'f1-score': 0.4371204158662932, 'support': 206485}, '1': {'precision': 0.43068435475382466, 'recall': 0.5087954377351613, 'f1-score': 0.4664927049087684, 'support': 186574}, '2': {'precision': 0.46275989209988294, 'recall': 0.446724113684966, 'f1-score': 0.45460063361724384, 'support': 206219}, 'accuracy': 0.45300511615644157, 'macro avg': {'precision': 0.4543373425264399, 'recall': 0.4547956745445351, 'f1-score': 0.45273791813076847, 'support': 599278}, 'weighted avg': {'precision': 0.45511947409368253, 'recall': 0.45300511615644157, 'f1-score': 0.45228008880638787, 'support': 599278}}
[[84425 63698 58362]
 [43058 94928 48588]
 [52310 61786 92123]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0051258
{'0': {'precision': 0.5025876940770557, 'recall': 0.4149632665300615, 'f1-score': 0.45459149454550424, 'support': 40018}, '1': {'precision': 0.4910062366899909, 'recall': 0.6046549745943288, 'f1-score': 0.5419364316519587, 'support': 42707}, '2': {'precision': 0.49483610237988324, 'recall': 0.45953835209851107, 'f1-score': 0.4765344796886526, 'support': 40767}, 'accuracy': 0.49527904641596215, 'macro avg': {'precision': 0.49614334438230995, 'recall': 0.49305219774096715, 'f1-score': 0.4910208019620385, 'support': 123492}, 'weighted avg': {'precision': 0.49602355681028537, 'recall': 0.49527904641596215, 'f1-score': 0.4920416119971293, 'support': 123492}}
[[16606 13582  9830]
 [ 7589 25823  9295]
 [ 8846 13187 18734]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0428098
{'0': {'precision': 0.471450885109337, 'recall': 0.3888491268250787, 'f1-score': 0.4261844995293379, 'support': 13972}, '1': {'precision': 0.42538446307174443, 'recall': 0.5197999838696669, 'f1-score': 0.46787658802177856, 'support': 12399}, '2': {'precision': 0.4716684871654833, 'recall': 0.46207865168539325, 'f1-score': 0.4668243243243243, 'support': 14952}, 'accuracy': 0.45463785301164, 'macro avg': {'precision': 0.4561679451155216, 'recall': 0.45690925412671296, 'f1-score': 0.45362847062514694, 'support': 41323}, 'weighted avg': {'precision': 0.45770735291417664, 'recall': 0.45463785301164, 'f1-score': 0.4533990499141698, 'support': 41323}}
[[5433 4176 4363]
 [2578 6445 3376]
 [3513 4530 6909]]
training model: results/XRAY/W5/deepOF_L2/h30
Epoch 1/50
483/483 - 13s - loss: 3.2790 - accuracy30: 0.3854 - val_loss: 3.2440 - val_accuracy30: 0.4029 - 13s/epoch - 27ms/step
Epoch 2/50
483/483 - 11s - loss: 3.2083 - accuracy30: 0.4196 - val_loss: 3.2155 - val_accuracy30: 0.4157 - 11s/epoch - 23ms/step
Epoch 3/50
483/483 - 11s - loss: 3.1776 - accuracy30: 0.4323 - val_loss: 3.2068 - val_accuracy30: 0.4177 - 11s/epoch - 23ms/step
Epoch 4/50
483/483 - 11s - loss: 3.1510 - accuracy30: 0.4427 - val_loss: 3.1984 - val_accuracy30: 0.4225 - 11s/epoch - 23ms/step
Epoch 5/50
483/483 - 11s - loss: 3.1296 - accuracy30: 0.4507 - val_loss: 3.1940 - val_accuracy30: 0.4264 - 11s/epoch - 23ms/step
Epoch 6/50
483/483 - 11s - loss: 3.1154 - accuracy30: 0.4564 - val_loss: 3.1916 - val_accuracy30: 0.4277 - 11s/epoch - 23ms/step
Epoch 7/50
483/483 - 11s - loss: 3.1040 - accuracy30: 0.4599 - val_loss: 3.1914 - val_accuracy30: 0.4242 - 11s/epoch - 23ms/step
Epoch 8/50
483/483 - 11s - loss: 3.0942 - accuracy30: 0.4641 - val_loss: 3.1889 - val_accuracy30: 0.4288 - 11s/epoch - 23ms/step
Epoch 9/50
483/483 - 11s - loss: 3.0807 - accuracy30: 0.4676 - val_loss: 3.1878 - val_accuracy30: 0.4290 - 11s/epoch - 23ms/step
Epoch 10/50
483/483 - 11s - loss: 3.0715 - accuracy30: 0.4707 - val_loss: 3.1848 - val_accuracy30: 0.4303 - 11s/epoch - 23ms/step
Epoch 11/50
483/483 - 11s - loss: 3.0629 - accuracy30: 0.4737 - val_loss: 3.1887 - val_accuracy30: 0.4277 - 11s/epoch - 23ms/step
Epoch 12/50
483/483 - 11s - loss: 3.0560 - accuracy30: 0.4761 - val_loss: 3.1849 - val_accuracy30: 0.4343 - 11s/epoch - 23ms/step
Epoch 13/50
483/483 - 11s - loss: 3.0486 - accuracy30: 0.4797 - val_loss: 3.1836 - val_accuracy30: 0.4348 - 11s/epoch - 23ms/step
Epoch 14/50
483/483 - 11s - loss: 3.0392 - accuracy30: 0.4823 - val_loss: 3.1855 - val_accuracy30: 0.4329 - 11s/epoch - 23ms/step
Epoch 15/50
483/483 - 11s - loss: 3.0314 - accuracy30: 0.4857 - val_loss: 3.1849 - val_accuracy30: 0.4342 - 11s/epoch - 23ms/step
Epoch 16/50
483/483 - 11s - loss: 3.0269 - accuracy30: 0.4868 - val_loss: 3.1871 - val_accuracy30: 0.4344 - 11s/epoch - 23ms/step
Epoch 17/50
483/483 - 11s - loss: 3.0177 - accuracy30: 0.4897 - val_loss: 3.1912 - val_accuracy30: 0.4361 - 11s/epoch - 23ms/step
Epoch 18/50
483/483 - 11s - loss: 3.0122 - accuracy30: 0.4908 - val_loss: 3.1956 - val_accuracy30: 0.4318 - 11s/epoch - 23ms/step
Epoch 19/50
483/483 - 11s - loss: 3.0059 - accuracy30: 0.4929 - val_loss: 3.1891 - val_accuracy30: 0.4381 - 11s/epoch - 24ms/step
Epoch 20/50
483/483 - 11s - loss: 2.9987 - accuracy30: 0.4963 - val_loss: 3.2000 - val_accuracy30: 0.4369 - 11s/epoch - 23ms/step
Epoch 21/50
483/483 - 11s - loss: 2.9911 - accuracy30: 0.4977 - val_loss: 3.2077 - val_accuracy30: 0.4361 - 11s/epoch - 24ms/step
Epoch 22/50
483/483 - 11s - loss: 2.9821 - accuracy30: 0.5016 - val_loss: 3.2001 - val_accuracy30: 0.4384 - 11s/epoch - 23ms/step
Epoch 23/50
483/483 - 11s - loss: 2.9752 - accuracy30: 0.5037 - val_loss: 3.2164 - val_accuracy30: 0.4358 - 11s/epoch - 23ms/step
testing model: results/XRAY/W5/deepOF_L2/h30
Evaluating performance on  test set...
2341/2341 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.070349
{'0': {'precision': 0.4655673030484647, 'recall': 0.373753935554995, 'f1-score': 0.4146388862257761, 'support': 214074}, '1': {'precision': 0.36853519781829364, 'recall': 0.5311678087184721, 'f1-score': 0.43515256043055656, 'support': 171475}, '2': {'precision': 0.4626376369435585, 'recall': 0.3902231330329529, 'f1-score': 0.42335610805981666, 'support': 213729}, 'accuracy': 0.42466935212038487, 'macro avg': {'precision': 0.432246712603439, 'recall': 0.43171495910214003, 'f1-score': 0.4243825182387164, 'support': 599278}, 'weighted avg': {'precision': 0.4367580778620252, 'recall': 0.42466935212038487, 'f1-score': 0.42361753284659714, 'support': 599278}}
[[80011 79492 54571]
 [38091 91082 42302]
 [53755 76572 83402]]
Evaluating performance on  train set...
483/483 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0310951
{'0': {'precision': 0.4909657118759529, 'recall': 0.3697596012899443, 'f1-score': 0.42182862080017836, 'support': 40932}, '1': {'precision': 0.4461715499690183, 'recall': 0.609848759830611, 'f1-score': 0.5153256313260404, 'support': 41325}, '2': {'precision': 0.4882808181315644, 'recall': 0.42842245665090334, 'f1-score': 0.4563973390169863, 'support': 41235}, 'accuracy': 0.4696903443138017, 'macro avg': {'precision': 0.4751393599921785, 'recall': 0.4693436059238196, 'f1-score': 0.46451719704773503, 'support': 123492}, 'weighted avg': {'precision': 0.47507941693900213, 'recall': 0.4696903443138017, 'f1-score': 0.46465896653635014, 'support': 123492}}
[[15135 16249  9548]
 [ 7157 25202  8966]
 [ 8535 15034 17666]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0610435
{'0': {'precision': 0.4575649059982095, 'recall': 0.35703807195249737, 'f1-score': 0.40109868550127525, 'support': 14315}, '1': {'precision': 0.3859314419348883, 'recall': 0.5268862376071248, 'f1-score': 0.4455259138218891, 'support': 11902}, '2': {'precision': 0.4664844649021864, 'recall': 0.4293658149079836, 'f1-score': 0.44715615305067224, 'support': 15106}, 'accuracy': 0.43239842218619173, 'macro avg': {'precision': 0.4366602709450948, 'recall': 0.4377633748225353, 'f1-score': 0.43126025079127883, 'support': 41323}, 'weighted avg': {'precision': 0.44019340265919304, 'recall': 0.43239842218619173, 'f1-score': 0.4307315044222911, 'support': 41323}}
[[5111 4944 4260]
 [2473 6271 3158]
 [3586 5034 6486]]
training model: results/XRAY/W5/deepOF_L2/h50
Epoch 1/50
483/483 - 14s - loss: 3.3025 - accuracy50: 0.3664 - val_loss: 3.2785 - val_accuracy50: 0.3798 - 14s/epoch - 28ms/step
Epoch 2/50
483/483 - 11s - loss: 3.2508 - accuracy50: 0.3945 - val_loss: 3.2598 - val_accuracy50: 0.3899 - 11s/epoch - 23ms/step
Epoch 3/50
483/483 - 11s - loss: 3.2301 - accuracy50: 0.4054 - val_loss: 3.2527 - val_accuracy50: 0.3935 - 11s/epoch - 23ms/step
Epoch 4/50
483/483 - 11s - loss: 3.2135 - accuracy50: 0.4131 - val_loss: 3.2479 - val_accuracy50: 0.3960 - 11s/epoch - 23ms/step
Epoch 5/50
483/483 - 11s - loss: 3.2014 - accuracy50: 0.4197 - val_loss: 3.2498 - val_accuracy50: 0.3955 - 11s/epoch - 23ms/step
Epoch 6/50
483/483 - 11s - loss: 3.1911 - accuracy50: 0.4242 - val_loss: 3.2488 - val_accuracy50: 0.3995 - 11s/epoch - 24ms/step
Epoch 7/50
483/483 - 11s - loss: 3.1857 - accuracy50: 0.4264 - val_loss: 3.2490 - val_accuracy50: 0.3966 - 11s/epoch - 23ms/step
Epoch 8/50
483/483 - 11s - loss: 3.1765 - accuracy50: 0.4300 - val_loss: 3.2462 - val_accuracy50: 0.3990 - 11s/epoch - 23ms/step
Epoch 9/50
483/483 - 11s - loss: 3.1690 - accuracy50: 0.4330 - val_loss: 3.2493 - val_accuracy50: 0.3977 - 11s/epoch - 23ms/step
Epoch 10/50
483/483 - 11s - loss: 3.1636 - accuracy50: 0.4374 - val_loss: 3.2438 - val_accuracy50: 0.4017 - 11s/epoch - 23ms/step
Epoch 11/50
483/483 - 11s - loss: 3.1572 - accuracy50: 0.4404 - val_loss: 3.2469 - val_accuracy50: 0.4002 - 11s/epoch - 23ms/step
Epoch 12/50
483/483 - 11s - loss: 3.1519 - accuracy50: 0.4411 - val_loss: 3.2498 - val_accuracy50: 0.4010 - 11s/epoch - 23ms/step
Epoch 13/50
483/483 - 11s - loss: 3.1449 - accuracy50: 0.4449 - val_loss: 3.2524 - val_accuracy50: 0.3988 - 11s/epoch - 23ms/step
Epoch 14/50
483/483 - 11s - loss: 3.1372 - accuracy50: 0.4485 - val_loss: 3.2563 - val_accuracy50: 0.3992 - 11s/epoch - 23ms/step
Epoch 15/50
483/483 - 11s - loss: 3.1298 - accuracy50: 0.4514 - val_loss: 3.2512 - val_accuracy50: 0.4026 - 11s/epoch - 23ms/step
Epoch 16/50
483/483 - 11s - loss: 3.1244 - accuracy50: 0.4533 - val_loss: 3.2531 - val_accuracy50: 0.4029 - 11s/epoch - 23ms/step
Epoch 17/50
483/483 - 11s - loss: 3.1155 - accuracy50: 0.4588 - val_loss: 3.2608 - val_accuracy50: 0.4004 - 11s/epoch - 24ms/step
Epoch 18/50
483/483 - 11s - loss: 3.1105 - accuracy50: 0.4583 - val_loss: 3.2607 - val_accuracy50: 0.4009 - 11s/epoch - 23ms/step
Epoch 19/50
483/483 - 11s - loss: 3.1008 - accuracy50: 0.4616 - val_loss: 3.2778 - val_accuracy50: 0.3989 - 11s/epoch - 23ms/step
Epoch 20/50
483/483 - 11s - loss: 3.0940 - accuracy50: 0.4658 - val_loss: 3.2770 - val_accuracy50: 0.3988 - 11s/epoch - 23ms/step
testing model: results/XRAY/W5/deepOF_L2/h50
Evaluating performance on  test set...
2341/2341 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0859563
{'0': {'precision': 0.4330192832614247, 'recall': 0.35092384685644695, 'f1-score': 0.3876730002653963, 'support': 210208}, '1': {'precision': 0.33820402889528395, 'recall': 0.48342035895972196, 'f1-score': 0.3979792115884337, 'support': 178683}, '2': {'precision': 0.4390726034186655, 'recall': 0.36212788812997, 'f1-score': 0.39690548442974166, 'support': 210387}, 'accuracy': 0.39436288333628133, 'macro avg': {'precision': 0.403431971858458, 'recall': 0.39882403131537963, 'f1-score': 0.3941858987611906, 'support': 599278}, 'weighted avg': {'precision': 0.4068739313079345, 'recall': 0.39436288333628133, 'f1-score': 0.39398716398193256, 'support': 599278}}
[[73767 86870 49571]
 [44544 86379 47760]
 [52044 82156 76187]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0660058
{'0': {'precision': 0.45515828431696514, 'recall': 0.33215973762901513, 'f1-score': 0.3840513034992332, 'support': 41468}, '1': {'precision': 0.388474309382809, 'recall': 0.5583929933328413, 'f1-score': 0.4581873971717825, 'support': 40647}, '2': {'precision': 0.4545167222158373, 'recall': 0.38231384585639366, 'f1-score': 0.4153004029876216, 'support': 41377}, 'accuracy': 0.42342823826644643, 'macro avg': {'precision': 0.43271643863853715, 'recall': 0.4242888589394167, 'f1-score': 0.41917970121954573, 'support': 123492}, 'weighted avg': {'precision': 0.4329945049287699, 'recall': 0.42342823826644643, 'f1-score': 0.4189232287173782, 'support': 123492}}
[[13774 18763  8931]
 [ 7896 22697 10054]
 [ 8592 16966 15819]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0828651
{'0': {'precision': 0.4309693294665612, 'recall': 0.3407211839088446, 'f1-score': 0.38056805835790786, 'support': 14393}, '1': {'precision': 0.3437790697674419, 'recall': 0.4892032762472077, 'f1-score': 0.4037969064772766, 'support': 12087}, '2': {'precision': 0.4460138104205901, 'recall': 0.3829414538839857, 'f1-score': 0.41207815275310833, 'support': 14843}, 'accuracy': 0.39931757132831597, 'macro avg': {'precision': 0.40692073655153105, 'recall': 0.40428863801334597, 'f1-score': 0.3988143725294309, 'support': 41323}, 'weighted avg': {'precision': 0.410870027910948, 'recall': 0.39931757132831597, 'f1-score': 0.3986807660104687, 'support': 41323}}
[[4904 5710 3779]
 [2893 5913 3281]
 [3582 5577 5684]]
training model: results/XRAY/W5/deepOF_L2/h100
Epoch 1/50
483/483 - 13s - loss: 3.3219 - accuracy100: 0.3493 - val_loss: 3.3247 - val_accuracy100: 0.3401 - 13s/epoch - 27ms/step
Epoch 2/50
483/483 - 11s - loss: 3.2874 - accuracy100: 0.3698 - val_loss: 3.3081 - val_accuracy100: 0.3547 - 11s/epoch - 23ms/step
Epoch 3/50
483/483 - 11s - loss: 3.2700 - accuracy100: 0.3809 - val_loss: 3.3091 - val_accuracy100: 0.3500 - 11s/epoch - 23ms/step
Epoch 4/50
483/483 - 11s - loss: 3.2574 - accuracy100: 0.3874 - val_loss: 3.3092 - val_accuracy100: 0.3546 - 11s/epoch - 23ms/step
Epoch 5/50
483/483 - 11s - loss: 3.2468 - accuracy100: 0.3946 - val_loss: 3.3144 - val_accuracy100: 0.3464 - 11s/epoch - 23ms/step
Epoch 6/50
483/483 - 11s - loss: 3.2389 - accuracy100: 0.3993 - val_loss: 3.3286 - val_accuracy100: 0.3401 - 11s/epoch - 23ms/step
Epoch 7/50
483/483 - 11s - loss: 3.2318 - accuracy100: 0.4024 - val_loss: 3.3213 - val_accuracy100: 0.3396 - 11s/epoch - 23ms/step
Epoch 8/50
483/483 - 11s - loss: 3.2239 - accuracy100: 0.4071 - val_loss: 3.3291 - val_accuracy100: 0.3409 - 11s/epoch - 23ms/step
Epoch 9/50
483/483 - 11s - loss: 3.2193 - accuracy100: 0.4082 - val_loss: 3.3300 - val_accuracy100: 0.3400 - 11s/epoch - 23ms/step
Epoch 10/50
483/483 - 11s - loss: 3.2146 - accuracy100: 0.4125 - val_loss: 3.3359 - val_accuracy100: 0.3368 - 11s/epoch - 23ms/step
Epoch 11/50
483/483 - 11s - loss: 3.2100 - accuracy100: 0.4139 - val_loss: 3.3337 - val_accuracy100: 0.3371 - 11s/epoch - 23ms/step
Epoch 12/50
483/483 - 11s - loss: 3.2047 - accuracy100: 0.4182 - val_loss: 3.3360 - val_accuracy100: 0.3370 - 11s/epoch - 23ms/step
testing model: results/XRAY/W5/deepOF_L2/h100
Evaluating performance on  test set...
2341/2341 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1011734
{'0': {'precision': 0.4038431533566003, 'recall': 0.23589059756904807, 'f1-score': 0.29782015606217055, 'support': 208478}, '1': {'precision': 0.3127294193409896, 'recall': 0.488163251629333, 'f1-score': 0.38123213199264666, 'support': 179061}, '2': {'precision': 0.39016025819094613, 'recall': 0.3648312309021956, 'f1-score': 0.37707086583425264, 'support': 211739}, 'accuracy': 0.3568260473436368, 'macro avg': {'precision': 0.368910943629512, 'recall': 0.3629616933668589, 'f1-score': 0.3520410512963566, 'support': 599278}, 'weighted avg': {'precision': 0.37178437785332846, 'recall': 0.3568260473436368, 'f1-score': 0.35074433792520887, 'support': 599278}}
[[49178 96201 63099]
 [34005 87411 57645]
 [38592 95898 77249]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0946822
{'0': {'precision': 0.398642254680107, 'recall': 0.2347027760282932, 'f1-score': 0.2954548919755439, 'support': 41282}, '1': {'precision': 0.3542280115120361, 'recall': 0.5168329328381757, 'f1-score': 0.4203533708419702, 'support': 41199}, '2': {'precision': 0.3785187839082813, 'recall': 0.36065933530028527, 'f1-score': 0.36937330652914957, 'support': 41011}, 'accuracy': 0.37065558902600976, 'macro avg': {'precision': 0.37712968336680813, 'recall': 0.37073168138891804, 'f1-score': 0.36172718978222124, 'support': 123492}, 'weighted avg': {'precision': 0.37714202742567193, 'recall': 0.37065558902600976, 'f1-score': 0.36167100743302955, 'support': 123492}}
[[ 9689 19797 11796]
 [ 7417 21293 12489]
 [ 7199 19021 14791]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1029526
{'0': {'precision': 0.40344710284612767, 'recall': 0.24189271874362636, 'f1-score': 0.3024481468888134, 'support': 14709}, '1': {'precision': 0.30749437118044387, 'recall': 0.4767683484332142, 'f1-score': 0.37386345119765363, 'support': 12031}, '2': {'precision': 0.3915523465703971, 'recall': 0.37187135705958996, 'f1-score': 0.3814581648084972, 'support': 14583}, 'accuracy': 0.3561454879848995, 'macro avg': {'precision': 0.36749794019898957, 'recall': 0.36351080807881014, 'f1-score': 0.3525899209649881, 'support': 41323}, 'weighted avg': {'precision': 0.3713132174690055, 'recall': 0.3561454879848995, 'f1-score': 0.35112323382496047, 'support': 41323}}
[[3558 6540 4611]
 [2479 5736 3816]
 [2782 6378 5423]]
training model: results/XRAY/W5/deepOF_L2/h200
Epoch 1/50
483/483 - 13s - loss: 3.3277 - accuracy200: 0.3537 - val_loss: 3.3011 - val_accuracy200: 0.3628 - 13s/epoch - 27ms/step
Epoch 2/50
483/483 - 11s - loss: 3.2991 - accuracy200: 0.3652 - val_loss: 3.2887 - val_accuracy200: 0.3682 - 11s/epoch - 23ms/step
Epoch 3/50
483/483 - 11s - loss: 3.2840 - accuracy200: 0.3735 - val_loss: 3.2844 - val_accuracy200: 0.3688 - 11s/epoch - 23ms/step
Epoch 4/50
483/483 - 11s - loss: 3.2747 - accuracy200: 0.3788 - val_loss: 3.2811 - val_accuracy200: 0.3720 - 11s/epoch - 23ms/step
Epoch 5/50
483/483 - 11s - loss: 3.2661 - accuracy200: 0.3832 - val_loss: 3.2776 - val_accuracy200: 0.3723 - 11s/epoch - 23ms/step
Epoch 6/50
483/483 - 11s - loss: 3.2590 - accuracy200: 0.3881 - val_loss: 3.2754 - val_accuracy200: 0.3740 - 11s/epoch - 23ms/step
Epoch 7/50
483/483 - 11s - loss: 3.2549 - accuracy200: 0.3910 - val_loss: 3.2748 - val_accuracy200: 0.3765 - 11s/epoch - 23ms/step
Epoch 8/50
483/483 - 11s - loss: 3.2481 - accuracy200: 0.3960 - val_loss: 3.2735 - val_accuracy200: 0.3748 - 11s/epoch - 23ms/step
Epoch 9/50
483/483 - 11s - loss: 3.2407 - accuracy200: 0.3991 - val_loss: 3.2733 - val_accuracy200: 0.3746 - 11s/epoch - 23ms/step
Epoch 10/50
483/483 - 11s - loss: 3.2368 - accuracy200: 0.4010 - val_loss: 3.2751 - val_accuracy200: 0.3711 - 11s/epoch - 23ms/step
Epoch 11/50
483/483 - 11s - loss: 3.2332 - accuracy200: 0.4009 - val_loss: 3.2744 - val_accuracy200: 0.3720 - 11s/epoch - 23ms/step
Epoch 12/50
483/483 - 11s - loss: 3.2295 - accuracy200: 0.4051 - val_loss: 3.2746 - val_accuracy200: 0.3743 - 11s/epoch - 23ms/step
Epoch 13/50
483/483 - 11s - loss: 3.2257 - accuracy200: 0.4066 - val_loss: 3.2771 - val_accuracy200: 0.3742 - 11s/epoch - 23ms/step
Epoch 14/50
483/483 - 11s - loss: 3.2215 - accuracy200: 0.4084 - val_loss: 3.2746 - val_accuracy200: 0.3784 - 11s/epoch - 23ms/step
Epoch 15/50
483/483 - 11s - loss: 3.2195 - accuracy200: 0.4091 - val_loss: 3.2782 - val_accuracy200: 0.3744 - 11s/epoch - 23ms/step
Epoch 16/50
483/483 - 11s - loss: 3.2159 - accuracy200: 0.4104 - val_loss: 3.2857 - val_accuracy200: 0.3695 - 11s/epoch - 23ms/step
Epoch 17/50
483/483 - 11s - loss: 3.2117 - accuracy200: 0.4125 - val_loss: 3.2812 - val_accuracy200: 0.3717 - 11s/epoch - 23ms/step
Epoch 18/50
483/483 - 11s - loss: 3.2079 - accuracy200: 0.4147 - val_loss: 3.2828 - val_accuracy200: 0.3696 - 11s/epoch - 23ms/step
Epoch 19/50
483/483 - 11s - loss: 3.2045 - accuracy200: 0.4174 - val_loss: 3.2847 - val_accuracy200: 0.3722 - 11s/epoch - 23ms/step
testing model: results/XRAY/W5/deepOF_L2/h200
Evaluating performance on  test set...
2341/2341 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0907742
{'0': {'precision': 0.40601685776535573, 'recall': 0.3395651673760497, 'f1-score': 0.36982968369829683, 'support': 217325}, '1': {'precision': 0.26707270285823903, 'recall': 0.14611716397840646, 'f1-score': 0.1888909145640865, 'support': 152453}, '2': {'precision': 0.40566393506407994, 'recall': 0.5905795206971678, 'f1-score': 0.4809603735890166, 'support': 229500}, 'accuracy': 0.38648173301873257, 'macro avg': {'precision': 0.35958449856255825, 'recall': 0.35875395068387467, 'f1-score': 0.34656032395046665, 'support': 599278}, 'weighted avg': {'precision': 0.3705350796790628, 'recall': 0.38648173301873257, 'f1-score': 0.36635856538442985, 'support': 599278}}
[[ 73796  30154 113375]
 [ 44976  22276  85201]
 [ 62984  30978 135538]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0879759
{'0': {'precision': 0.3933111093042795, 'recall': 0.35115057952428197, 'f1-score': 0.37103702188586624, 'support': 41327}, '1': {'precision': 0.39125231204439126, 'recall': 0.17658179675415553, 'f1-score': 0.24333880326842722, 'support': 40729}, '2': {'precision': 0.3662205151510709, 'recall': 0.6028815522733855, 'f1-score': 0.4556539503324244, 'support': 41436}, 'accuracy': 0.3780406827972662, 'macro avg': {'precision': 0.3835946454999139, 'recall': 0.37687130951727427, 'f1-score': 0.35667659182890593, 'support': 123492}, 'weighted avg': {'precision': 0.38354222862431364, 'recall': 0.3780406827972662, 'f1-score': 0.3573127830772139, 'support': 123492}}
[[14512  5691 21124]
 [11429  7192 22108]
 [10956  5499 24981]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0918276
{'0': {'precision': 0.3990772779700115, 'recall': 0.34268735556289204, 'f1-score': 0.3687388987566607, 'support': 15145}, '1': {'precision': 0.30877001455604075, 'recall': 0.1497925677464913, 'f1-score': 0.20172362555720652, 'support': 11329}, '2': {'precision': 0.3763035667338533, 'recall': 0.5783554448110984, 'f1-score': 0.4559475458575562, 'support': 14849}, 'accuracy': 0.37448878348619413, 'macro avg': {'precision': 0.36138361975330185, 'recall': 0.3569451227068272, 'f1-score': 0.34213669005714115, 'support': 41323}, 'weighted avg': {'precision': 0.366135385431653, 'recall': 0.37448878348619413, 'f1-score': 0.3542879917732515, 'support': 41323}}
[[5190 1865 8090]
 [3488 1697 6144]
 [4327 1934 8588]]
training model: results/XRAY/W5/deepOF_L2/h300
Epoch 1/50
483/483 - 13s - loss: 3.3219 - accuracy300: 0.3557 - val_loss: 3.3301 - val_accuracy300: 0.3333 - 13s/epoch - 28ms/step
Epoch 2/50
483/483 - 12s - loss: 3.2931 - accuracy300: 0.3696 - val_loss: 3.3208 - val_accuracy300: 0.3362 - 12s/epoch - 24ms/step
Epoch 3/50
483/483 - 11s - loss: 3.2769 - accuracy300: 0.3776 - val_loss: 3.3198 - val_accuracy300: 0.3322 - 11s/epoch - 24ms/step
Epoch 4/50
483/483 - 11s - loss: 3.2625 - accuracy300: 0.3842 - val_loss: 3.3301 - val_accuracy300: 0.3305 - 11s/epoch - 24ms/step
Epoch 5/50
483/483 - 12s - loss: 3.2504 - accuracy300: 0.3910 - val_loss: 3.3353 - val_accuracy300: 0.3253 - 12s/epoch - 24ms/step
Epoch 6/50
483/483 - 11s - loss: 3.2406 - accuracy300: 0.3952 - val_loss: 3.3277 - val_accuracy300: 0.3323 - 11s/epoch - 23ms/step
Epoch 7/50
483/483 - 11s - loss: 3.2327 - accuracy300: 0.4001 - val_loss: 3.3337 - val_accuracy300: 0.3293 - 11s/epoch - 23ms/step
Epoch 8/50
483/483 - 11s - loss: 3.2271 - accuracy300: 0.4017 - val_loss: 3.3343 - val_accuracy300: 0.3269 - 11s/epoch - 23ms/step
Epoch 9/50
483/483 - 11s - loss: 3.2214 - accuracy300: 0.4049 - val_loss: 3.3315 - val_accuracy300: 0.3294 - 11s/epoch - 23ms/step
Epoch 10/50
483/483 - 11s - loss: 3.2167 - accuracy300: 0.4078 - val_loss: 3.3324 - val_accuracy300: 0.3306 - 11s/epoch - 23ms/step
Epoch 11/50
483/483 - 11s - loss: 3.2134 - accuracy300: 0.4097 - val_loss: 3.3378 - val_accuracy300: 0.3287 - 11s/epoch - 23ms/step
Epoch 12/50
483/483 - 11s - loss: 3.2103 - accuracy300: 0.4105 - val_loss: 3.3367 - val_accuracy300: 0.3311 - 11s/epoch - 23ms/step
Epoch 13/50
483/483 - 11s - loss: 3.2065 - accuracy300: 0.4119 - val_loss: 3.3382 - val_accuracy300: 0.3288 - 11s/epoch - 23ms/step
testing model: results/XRAY/W5/deepOF_L2/h300
Evaluating performance on  test set...
2341/2341 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1185156
{'0': {'precision': 0.4066165213339546, 'recall': 0.13307858882580792, 'f1-score': 0.20052786039274392, 'support': 229511}, '1': {'precision': 0.21062651803612528, 'recall': 0.6472467121881263, 'f1-score': 0.31782626265859504, 'support': 122726}, '2': {'precision': 0.41541579666872974, 'recall': 0.2472423605798228, 'f1-score': 0.30998903753628776, 'support': 247041}, 'accuracy': 0.28543680896011536, 'macro avg': {'precision': 0.34421961201293655, 'recall': 0.3425225538645857, 'f1-score': 0.27611438686254225, 'support': 599278}, 'weighted avg': {'precision': 0.3701071093970051, 'recall': 0.28543680896011536, 'f1-score': 0.26967266861062783, 'support': 599278}}
[[ 30543 141621  57347]
 [ 14687  79434  28605]
 [ 29885 156077  61079]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.097089
{'0': {'precision': 0.3895500316879093, 'recall': 0.13365224324128433, 'f1-score': 0.19902144193409124, 'support': 41391}, '1': {'precision': 0.3588516746411483, 'recall': 0.7422846277607138, 'f1-score': 0.4838094632813245, 'support': 41022}, '2': {'precision': 0.37713303597004544, 'recall': 0.2243482071131235, 'f1-score': 0.28133585688992, 'support': 41079}, 'accuracy': 0.36599941696628124, 'macro avg': {'precision': 0.37517824743303435, 'recall': 0.36676169270504055, 'f1-score': 0.3213889207017786, 'support': 123492}, 'weighted avg': {'precision': 0.37522209328002576, 'recall': 0.36599941696628124, 'f1-score': 0.3210047935979779, 'support': 123492}}
[[ 5532 27223  8636]
 [ 3987 30450  6585]
 [ 4682 27181  9216]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1076821
{'0': {'precision': 0.3984640114306126, 'recall': 0.14758219223390884, 'f1-score': 0.2153890712492759, 'support': 15117}, '1': {'precision': 0.3042140879729314, 'recall': 0.6766441460702984, 'f1-score': 0.4197236147582292, 'support': 11693}, '2': {'precision': 0.3750514615067929, 'recall': 0.2510852339282023, 'f1-score': 0.30079656609847705, 'support': 14513}, 'accuracy': 0.3336398615782978, 'macro avg': {'precision': 0.3592431869701123, 'recall': 0.35843719074413655, 'f1-score': 0.31196975070199406, 'support': 41323}, 'weighted avg': {'precision': 0.3635718038940093, 'recall': 0.3336398615782978, 'f1-score': 0.30320464102873645, 'support': 41323}}
[[2231 9156 3730]
 [1439 7912 2342]
 [1929 8940 3644]]
training model: results/XRAY/W5/deepOF_L2/h500
Epoch 1/50
483/483 - 13s - loss: 3.3269 - accuracy500: 0.3490 - val_loss: 3.3232 - val_accuracy500: 0.3354 - 13s/epoch - 28ms/step
Epoch 2/50
483/483 - 11s - loss: 3.3001 - accuracy500: 0.3601 - val_loss: 3.3068 - val_accuracy500: 0.3410 - 11s/epoch - 23ms/step
Epoch 3/50
483/483 - 11s - loss: 3.2853 - accuracy500: 0.3649 - val_loss: 3.3043 - val_accuracy500: 0.3372 - 11s/epoch - 23ms/step
Epoch 4/50
483/483 - 11s - loss: 3.2734 - accuracy500: 0.3708 - val_loss: 3.3042 - val_accuracy500: 0.3359 - 11s/epoch - 23ms/step
Epoch 5/50
483/483 - 11s - loss: 3.2649 - accuracy500: 0.3747 - val_loss: 3.3065 - val_accuracy500: 0.3324 - 11s/epoch - 23ms/step
Epoch 6/50
483/483 - 11s - loss: 3.2585 - accuracy500: 0.3773 - val_loss: 3.3021 - val_accuracy500: 0.3325 - 11s/epoch - 23ms/step
Epoch 7/50
483/483 - 11s - loss: 3.2528 - accuracy500: 0.3798 - val_loss: 3.3077 - val_accuracy500: 0.3329 - 11s/epoch - 23ms/step
Epoch 8/50
483/483 - 11s - loss: 3.2480 - accuracy500: 0.3827 - val_loss: 3.3093 - val_accuracy500: 0.3308 - 11s/epoch - 23ms/step
Epoch 9/50
483/483 - 11s - loss: 3.2441 - accuracy500: 0.3862 - val_loss: 3.3072 - val_accuracy500: 0.3328 - 11s/epoch - 23ms/step
Epoch 10/50
483/483 - 11s - loss: 3.2398 - accuracy500: 0.3891 - val_loss: 3.3058 - val_accuracy500: 0.3355 - 11s/epoch - 23ms/step
Epoch 11/50
483/483 - 11s - loss: 3.2369 - accuracy500: 0.3897 - val_loss: 3.3120 - val_accuracy500: 0.3332 - 11s/epoch - 23ms/step
Epoch 12/50
483/483 - 11s - loss: 3.2339 - accuracy500: 0.3928 - val_loss: 3.3127 - val_accuracy500: 0.3340 - 11s/epoch - 23ms/step
Epoch 13/50
483/483 - 11s - loss: 3.2305 - accuracy500: 0.3944 - val_loss: 3.3137 - val_accuracy500: 0.3328 - 11s/epoch - 23ms/step
Epoch 14/50
483/483 - 11s - loss: 3.2255 - accuracy500: 0.3979 - val_loss: 3.3172 - val_accuracy500: 0.3330 - 11s/epoch - 23ms/step
Epoch 15/50
483/483 - 11s - loss: 3.2228 - accuracy500: 0.3976 - val_loss: 3.3181 - val_accuracy500: 0.3312 - 11s/epoch - 23ms/step
Epoch 16/50
483/483 - 11s - loss: 3.2205 - accuracy500: 0.4005 - val_loss: 3.3153 - val_accuracy500: 0.3348 - 11s/epoch - 23ms/step
testing model: results/XRAY/W5/deepOF_L2/h500
Evaluating performance on  test set...
2341/2341 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1113185
{'0': {'precision': 0.38666995687477235, 'recall': 0.15255518106249913, 'f1-score': 0.21878989361702128, 'support': 215699}, '1': {'precision': 0.2701423172114138, 'recall': 0.6712019029694688, 'f1-score': 0.38523641723755747, 'support': 153024}, '2': {'precision': 0.39057998059267, 'recall': 0.22695669146190714, 'f1-score': 0.28709142034154034, 'support': 230555}, 'accuracy': 0.3136140489055163, 'macro avg': {'precision': 0.3491307515596187, 'recall': 0.35023792516462504, 'f1-score': 0.29703924373203966, 'support': 599278}, 'weighted avg': {'precision': 0.35841921178890923, 'recall': 0.3136140489055163, 'f1-score': 0.28756860954598984, 'support': 599278}}
[[ 32906 132134  50659]
 [ 19329 102710  30985]
 [ 32866 145363  52326]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0963557
{'0': {'precision': 0.4047089601046436, 'recall': 0.14704624304928474, 'f1-score': 0.21571498291849683, 'support': 42082}, '1': {'precision': 0.3474620496109288, 'recall': 0.7572854795905472, 'f1-score': 0.47635854876148687, 'support': 39565}, '2': {'precision': 0.3910154294297028, 'recall': 0.2053052933444856, 'f1-score': 0.2692428231164598, 'support': 41845}, 'accuracy': 0.3622987723901143, 'macro avg': {'precision': 0.38106214638175845, 'recall': 0.3698790053281058, 'f1-score': 0.3204387849321479, 'support': 123492}, 'weighted avg': {'precision': 0.38172787789059953, 'recall': 0.3622987723901143, 'f1-score': 0.3173590987775133, 'support': 123492}}
[[ 6188 28141  7753]
 [ 3976 29962  5627]
 [ 5126 28128  8591]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1048777
{'0': {'precision': 0.40716289816801454, 'recall': 0.16224926011180532, 'f1-score': 0.23203536493604215, 'support': 15205}, '1': {'precision': 0.304929020597206, 'recall': 0.6961230980830396, 'f1-score': 0.4240900759361089, 'support': 11633}, '2': {'precision': 0.37957964855863097, 'recall': 0.22816706938211945, 'f1-score': 0.28501207312866506, 'support': 14485}, 'accuracy': 0.33564842823609126, 'macro avg': {'precision': 0.36389052244128384, 'recall': 0.36217980919232146, 'f1-score': 0.31371250466693873, 'support': 41323}, 'weighted avg': {'precision': 0.36871384876760466, 'recall': 0.33564842823609126, 'f1-score': 0.3046714289012412, 'support': 41323}}
[[2467 9432 3306]
 [1439 8098 2096]
 [2153 9027 3305]]
training model: results/XRAY/W5/deepOF_L2/h1000
Epoch 1/50
483/483 - 13s - loss: 3.3287 - accuracy1000: 0.3584 - val_loss: 3.3236 - val_accuracy1000: 0.3444 - 13s/epoch - 27ms/step
Epoch 2/50
483/483 - 11s - loss: 3.3025 - accuracy1000: 0.3652 - val_loss: 3.3017 - val_accuracy1000: 0.3474 - 11s/epoch - 23ms/step
Epoch 3/50
483/483 - 11s - loss: 3.2880 - accuracy1000: 0.3688 - val_loss: 3.2894 - val_accuracy1000: 0.3495 - 11s/epoch - 23ms/step
Epoch 4/50
483/483 - 11s - loss: 3.2789 - accuracy1000: 0.3708 - val_loss: 3.2845 - val_accuracy1000: 0.3529 - 11s/epoch - 23ms/step
Epoch 5/50
483/483 - 11s - loss: 3.2707 - accuracy1000: 0.3754 - val_loss: 3.2801 - val_accuracy1000: 0.3562 - 11s/epoch - 23ms/step
Epoch 6/50
483/483 - 11s - loss: 3.2640 - accuracy1000: 0.3774 - val_loss: 3.2840 - val_accuracy1000: 0.3481 - 11s/epoch - 23ms/step
Epoch 7/50
483/483 - 11s - loss: 3.2577 - accuracy1000: 0.3808 - val_loss: 3.2832 - val_accuracy1000: 0.3435 - 11s/epoch - 23ms/step
Epoch 8/50
483/483 - 11s - loss: 3.2523 - accuracy1000: 0.3845 - val_loss: 3.2844 - val_accuracy1000: 0.3438 - 11s/epoch - 23ms/step
Epoch 9/50
483/483 - 11s - loss: 3.2460 - accuracy1000: 0.3867 - val_loss: 3.2894 - val_accuracy1000: 0.3405 - 11s/epoch - 23ms/step
Epoch 10/50
483/483 - 11s - loss: 3.2410 - accuracy1000: 0.3901 - val_loss: 3.2894 - val_accuracy1000: 0.3385 - 11s/epoch - 23ms/step
Epoch 11/50
483/483 - 11s - loss: 3.2383 - accuracy1000: 0.3918 - val_loss: 3.2887 - val_accuracy1000: 0.3384 - 11s/epoch - 23ms/step
Epoch 12/50
483/483 - 11s - loss: 3.2339 - accuracy1000: 0.3935 - val_loss: 3.2924 - val_accuracy1000: 0.3362 - 11s/epoch - 23ms/step
Epoch 13/50
483/483 - 11s - loss: 3.2298 - accuracy1000: 0.3950 - val_loss: 3.2938 - val_accuracy1000: 0.3322 - 11s/epoch - 23ms/step
Epoch 14/50
483/483 - 11s - loss: 3.2278 - accuracy1000: 0.3970 - val_loss: 3.2967 - val_accuracy1000: 0.3315 - 11s/epoch - 23ms/step
Epoch 15/50
483/483 - 11s - loss: 3.2234 - accuracy1000: 0.3988 - val_loss: 3.2958 - val_accuracy1000: 0.3319 - 11s/epoch - 23ms/step
testing model: results/XRAY/W5/deepOF_L2/h1000
Evaluating performance on  test set...
2341/2341 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0960859
{'0': {'precision': 0.36469653904029425, 'recall': 0.31964244008993953, 'f1-score': 0.3406864001210462, 'support': 218369}, '1': {'precision': 0.27392008309403065, 'recall': 0.23490346074244844, 'f1-score': 0.2529158733516677, 'support': 152684}, '2': {'precision': 0.38351688030330383, 'recall': 0.46539599079855404, 'f1-score': 0.4205077448408967, 'support': 228225}, 'accuracy': 0.35356045107612827, 'macro avg': {'precision': 0.3407111674792096, 'recall': 0.3399806305436473, 'f1-score': 0.3380366727712036, 'support': 599278}, 'weighted avg': {'precision': 0.3487359330862146, 'recall': 0.35356045107612827, 'f1-score': 0.3487228561388411, 'support': 599278}}
[[ 69800  46204 102365]
 [ 48448  35866  68370]
 [ 73144  48866 106215]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0943369
{'0': {'precision': 0.34523377597174854, 'recall': 0.3472749391727494, 'f1-score': 0.346251349417173, 'support': 41100}, '1': {'precision': 0.37421895709470976, 'recall': 0.24134814995725973, 'f1-score': 0.29344340182919587, 'support': 40945}, '2': {'precision': 0.35352158157224356, 'recall': 0.4754505754336864, 'f1-score': 0.40551914311290377, 'support': 41447}, 'accuracy': 0.35517280471609497, 'macro avg': {'precision': 0.3576581048795673, 'recall': 0.35469122152123184, 'f1-score': 0.34840463145309086, 'support': 123492}, 'weighted avg': {'precision': 0.35762569544672146, 'recall': 0.35517280471609497, 'f1-score': 0.3486341015899229, 'support': 123492}}
[[14273  8134 18693]
 [13720  9882 17343]
 [13350  8391 19706]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0938662
{'0': {'precision': 0.3834367292024815, 'recall': 0.32343484017401175, 'f1-score': 0.35088919288645687, 'support': 15861}, '1': {'precision': 0.28014059753954307, 'recall': 0.2233327106295535, 'f1-score': 0.2485317810924588, 'support': 10706}, '2': {'precision': 0.3636972538513061, 'recall': 0.4783816752507455, 'f1-score': 0.4132299136543246, 'support': 14756}, 'accuracy': 0.3528301430196259, 'macro avg': {'precision': 0.3424248601977769, 'recall': 0.3417164086847702, 'f1-score': 0.33755029587774676, 'support': 41323}, 'weighted avg': {'precision': 0.34962591963237855, 'recall': 0.3528301430196259, 'f1-score': 0.34663154520802386, 'support': 41323}}
[[5130 3132 7599]
 [3564 2391 4751]
 [4685 3012 7059]]
training model: results/XRAY/W5/deepVOL_L2/h10
Epoch 1/50
483/483 - 14s - loss: 3.2829 - accuracy10: 0.3856 - val_loss: 3.3255 - val_accuracy10: 0.4132 - 14s/epoch - 29ms/step
Epoch 2/50
483/483 - 12s - loss: 3.1539 - accuracy10: 0.4250 - val_loss: 3.2651 - val_accuracy10: 0.4345 - 12s/epoch - 25ms/step
Epoch 3/50
483/483 - 12s - loss: 3.1031 - accuracy10: 0.4405 - val_loss: 3.2346 - val_accuracy10: 0.4460 - 12s/epoch - 25ms/step
Epoch 4/50
483/483 - 12s - loss: 3.0766 - accuracy10: 0.4499 - val_loss: 3.2314 - val_accuracy10: 0.4597 - 12s/epoch - 24ms/step
Epoch 5/50
483/483 - 12s - loss: 3.0586 - accuracy10: 0.4564 - val_loss: 3.2256 - val_accuracy10: 0.4611 - 12s/epoch - 24ms/step
Epoch 6/50
483/483 - 12s - loss: 3.0390 - accuracy10: 0.4694 - val_loss: 3.2090 - val_accuracy10: 0.4722 - 12s/epoch - 24ms/step
Epoch 7/50
483/483 - 12s - loss: 3.0200 - accuracy10: 0.4786 - val_loss: 3.1731 - val_accuracy10: 0.4690 - 12s/epoch - 24ms/step
Epoch 8/50
483/483 - 12s - loss: 3.0015 - accuracy10: 0.4880 - val_loss: 3.1550 - val_accuracy10: 0.4780 - 12s/epoch - 26ms/step
Epoch 9/50
483/483 - 12s - loss: 2.9829 - accuracy10: 0.4951 - val_loss: 3.1542 - val_accuracy10: 0.4831 - 12s/epoch - 24ms/step
Epoch 10/50
483/483 - 12s - loss: 2.9716 - accuracy10: 0.4985 - val_loss: 3.1417 - val_accuracy10: 0.4817 - 12s/epoch - 24ms/step
Epoch 11/50
483/483 - 12s - loss: 2.9592 - accuracy10: 0.5033 - val_loss: 3.1381 - val_accuracy10: 0.4836 - 12s/epoch - 25ms/step
Epoch 12/50
483/483 - 12s - loss: 2.9516 - accuracy10: 0.5055 - val_loss: 3.1281 - val_accuracy10: 0.4859 - 12s/epoch - 24ms/step
Epoch 13/50
483/483 - 12s - loss: 2.9423 - accuracy10: 0.5083 - val_loss: 3.1270 - val_accuracy10: 0.4886 - 12s/epoch - 25ms/step
Epoch 14/50
483/483 - 11s - loss: 2.9366 - accuracy10: 0.5102 - val_loss: 3.1188 - val_accuracy10: 0.4891 - 11s/epoch - 24ms/step
Epoch 15/50
483/483 - 12s - loss: 2.9303 - accuracy10: 0.5122 - val_loss: 3.1250 - val_accuracy10: 0.4892 - 12s/epoch - 24ms/step
Epoch 16/50
483/483 - 12s - loss: 2.9207 - accuracy10: 0.5157 - val_loss: 3.1278 - val_accuracy10: 0.4852 - 12s/epoch - 24ms/step
Epoch 17/50
483/483 - 12s - loss: 2.9168 - accuracy10: 0.5165 - val_loss: 3.1146 - val_accuracy10: 0.4933 - 12s/epoch - 24ms/step
Epoch 18/50
483/483 - 12s - loss: 2.9096 - accuracy10: 0.5179 - val_loss: 3.1223 - val_accuracy10: 0.4889 - 12s/epoch - 24ms/step
Epoch 19/50
483/483 - 11s - loss: 2.9041 - accuracy10: 0.5204 - val_loss: 3.1103 - val_accuracy10: 0.4897 - 11s/epoch - 24ms/step
Epoch 20/50
483/483 - 12s - loss: 2.9016 - accuracy10: 0.5205 - val_loss: 3.1134 - val_accuracy10: 0.4876 - 12s/epoch - 24ms/step
Epoch 21/50
483/483 - 12s - loss: 2.8946 - accuracy10: 0.5228 - val_loss: 3.1199 - val_accuracy10: 0.4817 - 12s/epoch - 25ms/step
Epoch 22/50
483/483 - 12s - loss: 2.8898 - accuracy10: 0.5230 - val_loss: 3.1177 - val_accuracy10: 0.4842 - 12s/epoch - 25ms/step
Epoch 23/50
483/483 - 12s - loss: 2.8871 - accuracy10: 0.5236 - val_loss: 3.1271 - val_accuracy10: 0.4818 - 12s/epoch - 25ms/step
Epoch 24/50
483/483 - 12s - loss: 2.8797 - accuracy10: 0.5264 - val_loss: 3.1139 - val_accuracy10: 0.4868 - 12s/epoch - 25ms/step
Epoch 25/50
483/483 - 12s - loss: 2.8762 - accuracy10: 0.5262 - val_loss: 3.1118 - val_accuracy10: 0.4845 - 12s/epoch - 24ms/step
Epoch 26/50
483/483 - 12s - loss: 2.8707 - accuracy10: 0.5287 - val_loss: 3.1170 - val_accuracy10: 0.4830 - 12s/epoch - 24ms/step
Epoch 27/50
483/483 - 12s - loss: 2.8640 - accuracy10: 0.5299 - val_loss: 3.1282 - val_accuracy10: 0.4822 - 12s/epoch - 24ms/step
Epoch 28/50
483/483 - 12s - loss: 2.8596 - accuracy10: 0.5308 - val_loss: 3.1169 - val_accuracy10: 0.4846 - 12s/epoch - 24ms/step
Epoch 29/50
483/483 - 12s - loss: 2.8556 - accuracy10: 0.5312 - val_loss: 3.1253 - val_accuracy10: 0.4851 - 12s/epoch - 25ms/step
testing model: results/XRAY/W5/deepVOL_L2/h10
Evaluating performance on  test set...
2341/2341 - 25s - 25s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0113059
{'0': {'precision': 0.4441642281818456, 'recall': 0.4269467432972412, 'f1-score': 0.4353853341770804, 'support': 172429}, '1': {'precision': 0.5673862783892747, 'recall': 0.509064716486527, 'f1-score': 0.5366455813065731, 'support': 254062}, '2': {'precision': 0.4260205942867149, 'recall': 0.5068868929117089, 'f1-score': 0.4629489168382301, 'support': 172792}, 'accuracy': 0.484809347169868, 'macro avg': {'precision': 0.4791903669526117, 'recall': 0.48096611756515895, 'f1-score': 0.4783266107739612, 'support': 599283}, 'weighted avg': {'precision': 0.4911720120365393, 'recall': 0.484809347169868, 'f1-score': 0.48626137685040605, 'support': 599283}}
[[ 73618  53307  45504]
 [ 52227 129334  72501]
 [ 39900  45306  87586]]
Evaluating performance on  train set...
483/483 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9653609
{'0': {'precision': 0.49006017213801506, 'recall': 0.38851483952779203, 'f1-score': 0.43341922228397245, 'support': 33121}, '1': {'precision': 0.6132629655185275, 'recall': 0.5821899619367974, 'f1-score': 0.5973226286918298, 'support': 56485}, '2': {'precision': 0.4291119213042581, 'recall': 0.5522634716402054, 'f1-score': 0.48296063073409295, 'support': 33886}, 'accuracy': 0.5220338159556894, 'macro avg': {'precision': 0.5108116863202669, 'recall': 0.5076560910349316, 'f1-score': 0.5045674939032984, 'support': 123492}, 'weighted avg': {'precision': 0.5296887906424166, 'recall': 0.5220338159556894, 'f1-score': 0.5219824010946534, 'support': 123492}}
[[12868 11169  9084]
 [ 7787 32885 15813]
 [ 5603  9569 18714]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0047544
{'0': {'precision': 0.45437654830718416, 'recall': 0.378862208451674, 'f1-score': 0.41319754071431924, 'support': 11619}, '1': {'precision': 0.5716248037676609, 'recall': 0.5104257928859296, 'f1-score': 0.5392946403776728, 'support': 17121}, '2': {'precision': 0.4301706735180767, 'recall': 0.5588492410394977, 'f1-score': 0.48613895610093333, 'support': 12583}, 'accuracy': 0.48817849623696247, 'macro avg': {'precision': 0.4853906751976405, 'recall': 0.4827124141257005, 'f1-score': 0.4795437123976418, 'support': 41323}, 'weighted avg': {'precision': 0.49558422585400996, 'recall': 0.48817849623696247, 'f1-score': 0.48765317736088515, 'support': 41323}}
[[4402 3373 3844]
 [2911 8739 5471]
 [2375 3176 7032]]
training model: results/XRAY/W5/deepVOL_L2/h20
Epoch 1/50
483/483 - 14s - loss: 3.2932 - accuracy20: 0.3820 - val_loss: 3.2785 - val_accuracy20: 0.3857 - 14s/epoch - 29ms/step
Epoch 2/50
483/483 - 12s - loss: 3.1971 - accuracy20: 0.4179 - val_loss: 3.2218 - val_accuracy20: 0.4205 - 12s/epoch - 24ms/step
Epoch 3/50
483/483 - 12s - loss: 3.1555 - accuracy20: 0.4351 - val_loss: 3.2001 - val_accuracy20: 0.4311 - 12s/epoch - 24ms/step
Epoch 4/50
483/483 - 12s - loss: 3.1351 - accuracy20: 0.4465 - val_loss: 3.2012 - val_accuracy20: 0.4343 - 12s/epoch - 24ms/step
Epoch 5/50
483/483 - 12s - loss: 3.1130 - accuracy20: 0.4549 - val_loss: 3.1905 - val_accuracy20: 0.4370 - 12s/epoch - 25ms/step
Epoch 6/50
483/483 - 12s - loss: 3.0947 - accuracy20: 0.4620 - val_loss: 3.1916 - val_accuracy20: 0.4322 - 12s/epoch - 25ms/step
Epoch 7/50
483/483 - 12s - loss: 3.0827 - accuracy20: 0.4647 - val_loss: 3.1661 - val_accuracy20: 0.4408 - 12s/epoch - 25ms/step
Epoch 8/50
483/483 - 12s - loss: 3.0690 - accuracy20: 0.4719 - val_loss: 3.1660 - val_accuracy20: 0.4442 - 12s/epoch - 25ms/step
Epoch 9/50
483/483 - 12s - loss: 3.0566 - accuracy20: 0.4761 - val_loss: 3.1582 - val_accuracy20: 0.4490 - 12s/epoch - 24ms/step
Epoch 10/50
483/483 - 12s - loss: 3.0443 - accuracy20: 0.4794 - val_loss: 3.1435 - val_accuracy20: 0.4551 - 12s/epoch - 25ms/step
Epoch 11/50
483/483 - 12s - loss: 3.0326 - accuracy20: 0.4840 - val_loss: 3.1472 - val_accuracy20: 0.4520 - 12s/epoch - 24ms/step
Epoch 12/50
483/483 - 12s - loss: 3.0243 - accuracy20: 0.4866 - val_loss: 3.1554 - val_accuracy20: 0.4490 - 12s/epoch - 25ms/step
Epoch 13/50
483/483 - 12s - loss: 3.0157 - accuracy20: 0.4892 - val_loss: 3.1442 - val_accuracy20: 0.4584 - 12s/epoch - 24ms/step
Epoch 14/50
483/483 - 12s - loss: 3.0103 - accuracy20: 0.4916 - val_loss: 3.1502 - val_accuracy20: 0.4532 - 12s/epoch - 24ms/step
Epoch 15/50
483/483 - 12s - loss: 3.0049 - accuracy20: 0.4919 - val_loss: 3.1407 - val_accuracy20: 0.4557 - 12s/epoch - 24ms/step
Epoch 16/50
483/483 - 12s - loss: 2.9985 - accuracy20: 0.4937 - val_loss: 3.1382 - val_accuracy20: 0.4573 - 12s/epoch - 24ms/step
Epoch 17/50
483/483 - 12s - loss: 2.9938 - accuracy20: 0.4952 - val_loss: 3.1336 - val_accuracy20: 0.4563 - 12s/epoch - 24ms/step
Epoch 18/50
483/483 - 12s - loss: 2.9867 - accuracy20: 0.4975 - val_loss: 3.1374 - val_accuracy20: 0.4578 - 12s/epoch - 24ms/step
Epoch 19/50
483/483 - 12s - loss: 2.9838 - accuracy20: 0.4981 - val_loss: 3.1487 - val_accuracy20: 0.4548 - 12s/epoch - 24ms/step
Epoch 20/50
483/483 - 12s - loss: 2.9784 - accuracy20: 0.5004 - val_loss: 3.1413 - val_accuracy20: 0.4570 - 12s/epoch - 25ms/step
Epoch 21/50
483/483 - 12s - loss: 2.9699 - accuracy20: 0.5017 - val_loss: 3.1331 - val_accuracy20: 0.4594 - 12s/epoch - 24ms/step
Epoch 22/50
483/483 - 12s - loss: 2.9677 - accuracy20: 0.5028 - val_loss: 3.1462 - val_accuracy20: 0.4568 - 12s/epoch - 25ms/step
Epoch 23/50
483/483 - 12s - loss: 2.9607 - accuracy20: 0.5047 - val_loss: 3.1388 - val_accuracy20: 0.4589 - 12s/epoch - 24ms/step
Epoch 24/50
483/483 - 11s - loss: 2.9539 - accuracy20: 0.5078 - val_loss: 3.1395 - val_accuracy20: 0.4607 - 11s/epoch - 24ms/step
Epoch 25/50
483/483 - 12s - loss: 2.9497 - accuracy20: 0.5078 - val_loss: 3.1354 - val_accuracy20: 0.4611 - 12s/epoch - 24ms/step
Epoch 26/50
483/483 - 12s - loss: 2.9455 - accuracy20: 0.5089 - val_loss: 3.1412 - val_accuracy20: 0.4620 - 12s/epoch - 24ms/step
Epoch 27/50
483/483 - 11s - loss: 2.9421 - accuracy20: 0.5094 - val_loss: 3.1512 - val_accuracy20: 0.4556 - 11s/epoch - 24ms/step
Epoch 28/50
483/483 - 12s - loss: 2.9362 - accuracy20: 0.5119 - val_loss: 3.1491 - val_accuracy20: 0.4590 - 12s/epoch - 24ms/step
Epoch 29/50
483/483 - 12s - loss: 2.9310 - accuracy20: 0.5128 - val_loss: 3.1437 - val_accuracy20: 0.4621 - 12s/epoch - 24ms/step
Epoch 30/50
483/483 - 11s - loss: 2.9282 - accuracy20: 0.5146 - val_loss: 3.1530 - val_accuracy20: 0.4565 - 11s/epoch - 24ms/step
Epoch 31/50
483/483 - 12s - loss: 2.9241 - accuracy20: 0.5157 - val_loss: 3.1519 - val_accuracy20: 0.4568 - 12s/epoch - 24ms/step
testing model: results/XRAY/W5/deepVOL_L2/h20
Evaluating performance on  test set...
2341/2341 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0524089
{'0': {'precision': 0.4831682167408006, 'recall': 0.3240527294564333, 'f1-score': 0.38792843560131723, 'support': 206488}, '1': {'precision': 0.42998990634022677, 'recall': 0.49090441326229806, 'f1-score': 0.45843250020646736, 'support': 186574}, '2': {'precision': 0.4460591630009282, 'recall': 0.5359735429466446, 'f1-score': 0.4869000971342104, 'support': 206221}, 'accuracy': 0.4489231298067858, 'macro avg': {'precision': 0.4530724286939852, 'recall': 0.4503102285551253, 'f1-score': 0.4444203443139983, 'support': 599283}, 'weighted avg': {'precision': 0.4538425788435686, 'recall': 0.4489231298067858, 'f1-score': 0.4439357983374803, 'support': 599283}}
[[ 66913  65686  73889]
 [ 31612  91590  63372]
 [ 39963  55729 110529]]
Evaluating performance on  train set...
483/483 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.013862
{'0': {'precision': 0.5296574378226185, 'recall': 0.28265551437443653, 'f1-score': 0.3686032461382711, 'support': 39932}, '1': {'precision': 0.4948664040333939, 'recall': 0.5675492192803802, 'f1-score': 0.528721594626423, 'support': 42717}, '2': {'precision': 0.4525201631855013, 'recall': 0.5893298729280415, 'f1-score': 0.5119424888869983, 'support': 40843}, 'accuracy': 0.4826304537945778, 'macro avg': {'precision': 0.4923480016805046, 'recall': 0.47984486886095273, 'f1-score': 0.46975577655056416, 'support': 123492}, 'weighted avg': {'precision': 0.49211098705351536, 'recall': 0.4826304537945778, 'f1-score': 0.4713967889099053, 'support': 123492}}
[[11287 13406 15239]
 [ 4591 24244 13882]
 [ 5432 11341 24070]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0400189
{'0': {'precision': 0.5007198010731579, 'recall': 0.27338335119685603, 'f1-score': 0.3536698095766316, 'support': 13995}, '1': {'precision': 0.44532920445329205, 'recall': 0.48752925982726614, 'f1-score': 0.4654747225647349, 'support': 12389}, '2': {'precision': 0.453054326755803, 'recall': 0.610147934935404, 'f1-score': 0.5199954361344059, 'support': 14939}, 'accuracy': 0.4593325750792537, 'macro avg': {'precision': 0.4663677774274177, 'recall': 0.45702018198650873, 'f1-score': 0.4463799894252574, 'support': 41323}, 'weighted avg': {'precision': 0.4668812941314915, 'recall': 0.4593325750792537, 'f1-score': 0.44731958336256683, 'support': 41323}}
[[3826 3854 6315]
 [1660 6040 4689]
 [2155 3669 9115]]
training model: results/XRAY/W5/deepVOL_L2/h30
Epoch 1/50
483/483 - 14s - loss: 3.2993 - accuracy30: 0.3768 - val_loss: 3.2727 - val_accuracy30: 0.3884 - 14s/epoch - 29ms/step
Epoch 2/50
483/483 - 12s - loss: 3.2298 - accuracy30: 0.4013 - val_loss: 3.2374 - val_accuracy30: 0.4074 - 12s/epoch - 24ms/step
Epoch 3/50
483/483 - 12s - loss: 3.1909 - accuracy30: 0.4207 - val_loss: 3.2412 - val_accuracy30: 0.4105 - 12s/epoch - 24ms/step
Epoch 4/50
483/483 - 12s - loss: 3.1694 - accuracy30: 0.4313 - val_loss: 3.2110 - val_accuracy30: 0.4232 - 12s/epoch - 25ms/step
Epoch 5/50
483/483 - 11s - loss: 3.1547 - accuracy30: 0.4371 - val_loss: 3.2275 - val_accuracy30: 0.4194 - 11s/epoch - 24ms/step
Epoch 6/50
483/483 - 12s - loss: 3.1454 - accuracy30: 0.4434 - val_loss: 3.2375 - val_accuracy30: 0.4203 - 12s/epoch - 25ms/step
Epoch 7/50
483/483 - 12s - loss: 3.1332 - accuracy30: 0.4469 - val_loss: 3.2162 - val_accuracy30: 0.4274 - 12s/epoch - 24ms/step
Epoch 8/50
483/483 - 12s - loss: 3.1213 - accuracy30: 0.4518 - val_loss: 3.2246 - val_accuracy30: 0.4223 - 12s/epoch - 24ms/step
Epoch 9/50
483/483 - 11s - loss: 3.1132 - accuracy30: 0.4522 - val_loss: 3.2247 - val_accuracy30: 0.4263 - 11s/epoch - 24ms/step
Epoch 10/50
483/483 - 12s - loss: 3.1065 - accuracy30: 0.4565 - val_loss: 3.2325 - val_accuracy30: 0.4186 - 12s/epoch - 24ms/step
Epoch 11/50
483/483 - 12s - loss: 3.0995 - accuracy30: 0.4590 - val_loss: 3.2270 - val_accuracy30: 0.4261 - 12s/epoch - 24ms/step
Epoch 12/50
483/483 - 11s - loss: 3.0909 - accuracy30: 0.4622 - val_loss: 3.2342 - val_accuracy30: 0.4208 - 11s/epoch - 24ms/step
Epoch 13/50
483/483 - 12s - loss: 3.0834 - accuracy30: 0.4644 - val_loss: 3.2326 - val_accuracy30: 0.4250 - 12s/epoch - 24ms/step
Epoch 14/50
483/483 - 12s - loss: 3.0774 - accuracy30: 0.4673 - val_loss: 3.2385 - val_accuracy30: 0.4208 - 12s/epoch - 24ms/step
testing model: results/XRAY/W5/deepVOL_L2/h30
Evaluating performance on  test set...
2341/2341 - 25s - 25s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0790184
{'0': {'precision': 0.454168021755226, 'recall': 0.3065952904795938, 'f1-score': 0.3660685901046866, 'support': 214077}, '1': {'precision': 0.3644707561431348, 'recall': 0.45273655051756817, 'f1-score': 0.40383690051680593, 'support': 171475}, '2': {'precision': 0.42711487235485845, 'recall': 0.4831353430246431, 'f1-score': 0.45340124479961363, 'support': 213731}, 'accuracy': 0.4113732577096297, 'macro avg': {'precision': 0.4152512167510731, 'recall': 0.4141557280072683, 'f1-score': 0.4077689118070354, 'support': 599283}, 'weighted avg': {'precision': 0.4188542629879603, 'recall': 0.4113732577096297, 'f1-score': 0.40802208561268466, 'support': 599283}}
[[ 65635  70517  77925]
 [ 33264  77633  60578]
 [ 45618  64852 103261]]
Evaluating performance on  train set...
483/483 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0646135
{'0': {'precision': 0.46875439501195443, 'recall': 0.24457000293513353, 'f1-score': 0.32143373784457124, 'support': 40884}, '1': {'precision': 0.4357739314411758, 'recall': 0.4674876252565496, 'f1-score': 0.45107404128419, 'support': 41415}, '2': {'precision': 0.40383149726321627, 'recall': 0.565969946350108, 'f1-score': 0.4713469800353804, 'support': 41193}, 'accuracy': 0.4265377514332912, 'macro avg': {'precision': 0.43611994123878217, 'recall': 0.42600919151393035, 'f1-score': 0.41461825305471384, 'support': 123492}, 'weighted avg': {'precision': 0.4360376617357295, 'recall': 0.4265377514332912, 'f1-score': 0.4149169541866648, 'support': 123492}}
[[ 9999 13146 17739]
 [ 5375 19361 16679]
 [ 5957 11922 23314]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0697342
{'0': {'precision': 0.4532274331820474, 'recall': 0.25088980389420057, 'f1-score': 0.32298638875162844, 'support': 14329}, '1': {'precision': 0.399508108523557, 'recall': 0.436183603255853, 'f1-score': 0.41704107830551984, 'support': 11917}, '2': {'precision': 0.4259077526987242, 'recall': 0.5757113484114877, 'f1-score': 0.4896071297628113, 'support': 15077}, 'accuracy': 0.4228395808629577, 'macro avg': {'precision': 0.42621443146810956, 'recall': 0.4209282518538471, 'f1-score': 0.4098781989399865, 'support': 41323}, 'weighted avg': {'precision': 0.427767713060026, 'recall': 0.4228395808629577, 'f1-score': 0.4109033030037236, 'support': 41323}}
[[3595 3894 6840]
 [1859 5198 4860]
 [2478 3919 8680]]
training model: results/XRAY/W5/deepVOL_L2/h50
Epoch 1/50
483/483 - 14s - loss: 3.3167 - accuracy50: 0.3626 - val_loss: 3.3026 - val_accuracy50: 0.3562 - 14s/epoch - 28ms/step
Epoch 2/50
483/483 - 12s - loss: 3.2560 - accuracy50: 0.3861 - val_loss: 3.2676 - val_accuracy50: 0.3843 - 12s/epoch - 24ms/step
Epoch 3/50
483/483 - 11s - loss: 3.2300 - accuracy50: 0.4001 - val_loss: 3.2696 - val_accuracy50: 0.3858 - 11s/epoch - 24ms/step
Epoch 4/50
483/483 - 12s - loss: 3.2146 - accuracy50: 0.4074 - val_loss: 3.2742 - val_accuracy50: 0.3867 - 12s/epoch - 24ms/step
Epoch 5/50
483/483 - 12s - loss: 3.2042 - accuracy50: 0.4133 - val_loss: 3.2815 - val_accuracy50: 0.3838 - 12s/epoch - 25ms/step
Epoch 6/50
483/483 - 12s - loss: 3.1943 - accuracy50: 0.4194 - val_loss: 3.2844 - val_accuracy50: 0.3897 - 12s/epoch - 24ms/step
Epoch 7/50
483/483 - 12s - loss: 3.1881 - accuracy50: 0.4223 - val_loss: 3.2824 - val_accuracy50: 0.3913 - 12s/epoch - 24ms/step
Epoch 8/50
483/483 - 12s - loss: 3.1821 - accuracy50: 0.4234 - val_loss: 3.2721 - val_accuracy50: 0.3964 - 12s/epoch - 24ms/step
Epoch 9/50
483/483 - 11s - loss: 3.1747 - accuracy50: 0.4265 - val_loss: 3.2937 - val_accuracy50: 0.3933 - 11s/epoch - 24ms/step
Epoch 10/50
483/483 - 12s - loss: 3.1691 - accuracy50: 0.4313 - val_loss: 3.3010 - val_accuracy50: 0.3887 - 12s/epoch - 25ms/step
Epoch 11/50
483/483 - 12s - loss: 3.1659 - accuracy50: 0.4304 - val_loss: 3.2864 - val_accuracy50: 0.3939 - 12s/epoch - 24ms/step
Epoch 12/50
483/483 - 12s - loss: 3.1630 - accuracy50: 0.4347 - val_loss: 3.2785 - val_accuracy50: 0.3952 - 12s/epoch - 24ms/step
testing model: results/XRAY/W5/deepVOL_L2/h50
Evaluating performance on  test set...
2341/2341 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.093423
{'0': {'precision': 0.4276353222319159, 'recall': 0.2145225511509864, 'f1-score': 0.2857160959630999, 'support': 210211}, '1': {'precision': 0.328907681465821, 'recall': 0.4571000039175523, 'f1-score': 0.38255020983213434, 'support': 178683}, '2': {'precision': 0.39775402637817403, 'recall': 0.464144988568794, 'f1-score': 0.4283925026596036, 'support': 210389}, 'accuracy': 0.37448417525609773, 'macro avg': {'precision': 0.3847656766919703, 'recall': 0.3785891812124442, 'f1-score': 0.3655529361516126, 'support': 599283}, 'weighted avg': {'precision': 0.3877081976707636, 'recall': 0.37448417525609773, 'f1-score': 0.36467738219503276, 'support': 599283}}
[[45095 85181 79935]
 [29087 81676 67920]
 [31270 81468 97651]]
Evaluating performance on  train set...
483/483 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0831977
{'0': {'precision': 0.42661179698216734, 'recall': 0.18735391214246128, 'f1-score': 0.26036434264282365, 'support': 41499}, '1': {'precision': 0.3860425692220757, 'recall': 0.5040332497171807, 'f1-score': 0.4372173393634269, 'support': 40662}, '2': {'precision': 0.3892711347911915, 'recall': 0.4914229029058092, 'f1-score': 0.43442272318945974, 'support': 41331}, 'accuracy': 0.3933939040585625, 'macro avg': {'precision': 0.4006418336651449, 'recall': 0.39427002158848373, 'f1-score': 0.3773348017319034, 'support': 123492}, 'weighted avg': {'precision': 0.40075625291294775, 'recall': 0.3933939040585625, 'f1-score': 0.3768512687516095, 'support': 123492}}
[[ 7775 16629 17095]
 [ 5396 20495 14771]
 [ 5054 15966 20311]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0903617
{'0': {'precision': 0.42716139645403034, 'recall': 0.16176368796289886, 'f1-score': 0.23466211467014764, 'support': 14447}, '1': {'precision': 0.349288403854745, 'recall': 0.4552865818151568, 'f1-score': 0.39530516431924884, 'support': 12021}, '2': {'precision': 0.404102462468414, 'recall': 0.5490407270279367, 'f1-score': 0.46555168674011077, 'support': 14855}, 'accuracy': 0.38637078624494836, 'macro avg': {'precision': 0.3935174209257298, 'recall': 0.38869699893533083, 'f1-score': 0.36517298857650243, 'support': 41323}, 'weighted avg': {'precision': 0.3962185387623734, 'recall': 0.38637078624494836, 'f1-score': 0.3643950646721114, 'support': 41323}}
[[2337 5066 7044]
 [1565 5473 4983]
 [1569 5130 8156]]
training model: results/XRAY/W5/deepVOL_L2/h100
Epoch 1/50
483/483 - 14s - loss: 3.3382 - accuracy100: 0.3475 - val_loss: 3.3598 - val_accuracy100: 0.3077 - 14s/epoch - 29ms/step
Epoch 2/50
483/483 - 11s - loss: 3.2999 - accuracy100: 0.3582 - val_loss: 3.3179 - val_accuracy100: 0.3313 - 11s/epoch - 24ms/step
Epoch 3/50
483/483 - 12s - loss: 3.2793 - accuracy100: 0.3705 - val_loss: 3.3124 - val_accuracy100: 0.3417 - 12s/epoch - 24ms/step
Epoch 4/50
483/483 - 12s - loss: 3.2670 - accuracy100: 0.3790 - val_loss: 3.3093 - val_accuracy100: 0.3536 - 12s/epoch - 24ms/step
Epoch 5/50
483/483 - 12s - loss: 3.2591 - accuracy100: 0.3839 - val_loss: 3.3196 - val_accuracy100: 0.3350 - 12s/epoch - 24ms/step
Epoch 6/50
483/483 - 11s - loss: 3.2503 - accuracy100: 0.3889 - val_loss: 3.3281 - val_accuracy100: 0.3365 - 11s/epoch - 24ms/step
Epoch 7/50
483/483 - 12s - loss: 3.2445 - accuracy100: 0.3904 - val_loss: 3.3279 - val_accuracy100: 0.3344 - 12s/epoch - 24ms/step
Epoch 8/50
483/483 - 12s - loss: 3.2435 - accuracy100: 0.3916 - val_loss: 3.3196 - val_accuracy100: 0.3437 - 12s/epoch - 24ms/step
Epoch 9/50
483/483 - 12s - loss: 3.2371 - accuracy100: 0.3946 - val_loss: 3.3166 - val_accuracy100: 0.3484 - 12s/epoch - 24ms/step
Epoch 10/50
483/483 - 12s - loss: 3.2322 - accuracy100: 0.3984 - val_loss: 3.3252 - val_accuracy100: 0.3510 - 12s/epoch - 24ms/step
Epoch 11/50
483/483 - 11s - loss: 3.2271 - accuracy100: 0.4015 - val_loss: 3.3353 - val_accuracy100: 0.3436 - 11s/epoch - 24ms/step
Epoch 12/50
483/483 - 11s - loss: 3.2224 - accuracy100: 0.4041 - val_loss: 3.3456 - val_accuracy100: 0.3465 - 11s/epoch - 24ms/step
Epoch 13/50
483/483 - 12s - loss: 3.2167 - accuracy100: 0.4090 - val_loss: 3.3554 - val_accuracy100: 0.3488 - 12s/epoch - 24ms/step
Epoch 14/50
483/483 - 12s - loss: 3.2120 - accuracy100: 0.4116 - val_loss: 3.3646 - val_accuracy100: 0.3478 - 12s/epoch - 24ms/step
testing model: results/XRAY/W5/deepVOL_L2/h100
Evaluating performance on  test set...
2341/2341 - 23s - 23s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.100694
{'0': {'precision': 0.4084964200477327, 'recall': 0.14367325402916348, 'f1-score': 0.21257962065967598, 'support': 208480}, '1': {'precision': 0.3126428725822193, 'recall': 0.5331281902357843, 'f1-score': 0.39414620853667603, 'support': 179062}, '2': {'precision': 0.380969648620227, 'recall': 0.39693776831128597, 'f1-score': 0.3887898195241432, 'support': 211741}, 'accuracy': 0.34952434826284073, 'macro avg': {'precision': 0.367369647083393, 'recall': 0.3579130708587446, 'f1-score': 0.3318385495734984, 'support': 599283}, 'weighted avg': {'precision': 0.370130115605422, 'recall': 0.34952434826284073, 'f1-score': 0.32908985051133627, 'support': 599283}}
[[ 29953 104648  73879]
 [ 20910  95463  62689]
 [ 22462 105231  84048]]
Evaluating performance on  train set...
483/483 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0954368
{'0': {'precision': 0.4040413997042878, 'recall': 0.09919655389380959, 'f1-score': 0.1592865331183088, 'support': 41322}, '1': {'precision': 0.3549800150440259, 'recall': 0.5844017094017094, 'f1-score': 0.4416754599256778, 'support': 41184}, '2': {'precision': 0.3638080182672463, 'recall': 0.40428438979163617, 'f1-score': 0.38297970692922845, 'support': 40986}, 'accuracy': 0.3622663816279597, 'macro avg': {'precision': 0.3742764776718533, 'recall': 0.3626275510290517, 'f1-score': 0.32798056665773834, 'support': 123492}, 'weighted avg': {'precision': 0.3743265239436976, 'recall': 0.3622663816279597, 'f1-score': 0.3277038717592656, 'support': 123492}}
[[ 4099 22201 15022]
 [ 3162 24068 13954]
 [ 2884 21532 16570]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1029563
{'0': {'precision': 0.41902488919195363, 'recall': 0.08368514231240637, 'f1-score': 0.139508485158068, 'support': 14686}, '1': {'precision': 0.32487236297081207, 'recall': 0.5592405273194594, 'f1-score': 0.41099229199037257, 'support': 12061}, '2': {'precision': 0.38387792148854094, 'recall': 0.46425631174533477, 'f1-score': 0.4202583529996273, 'support': 14576}, 'accuracy': 0.3567262783437795, 'macro avg': {'precision': 0.3759250578837689, 'recall': 0.3690606604590669, 'f1-score': 0.32358637671602264, 'support': 41323}, 'weighted avg': {'precision': 0.3791469563216845, 'recall': 0.3567262783437795, 'f1-score': 0.31777667158845774, 'support': 41323}}
[[1229 7087 6370]
 [ 825 6745 4491]
 [ 879 6930 6767]]
training model: results/XRAY/W5/deepVOL_L2/h200
Epoch 1/50
483/483 - 14s - loss: 3.3251 - accuracy200: 0.3675 - val_loss: 3.3245 - val_accuracy200: 0.3471 - 14s/epoch - 30ms/step
Epoch 2/50
483/483 - 12s - loss: 3.3017 - accuracy200: 0.3635 - val_loss: 3.2880 - val_accuracy200: 0.3574 - 12s/epoch - 24ms/step
Epoch 3/50
483/483 - 12s - loss: 3.2935 - accuracy200: 0.3596 - val_loss: 3.2789 - val_accuracy200: 0.3617 - 12s/epoch - 24ms/step
Epoch 4/50
483/483 - 11s - loss: 3.2836 - accuracy200: 0.3617 - val_loss: 3.2798 - val_accuracy200: 0.3594 - 11s/epoch - 24ms/step
Epoch 5/50
483/483 - 12s - loss: 3.2770 - accuracy200: 0.3731 - val_loss: 3.2832 - val_accuracy200: 0.3566 - 12s/epoch - 24ms/step
Epoch 6/50
483/483 - 12s - loss: 3.2863 - accuracy200: 0.3639 - val_loss: 3.2781 - val_accuracy200: 0.3572 - 12s/epoch - 24ms/step
Epoch 7/50
483/483 - 12s - loss: 3.2769 - accuracy200: 0.3717 - val_loss: 3.2740 - val_accuracy200: 0.3622 - 12s/epoch - 24ms/step
Epoch 8/50
483/483 - 12s - loss: 3.2721 - accuracy200: 0.3733 - val_loss: 3.2721 - val_accuracy200: 0.3677 - 12s/epoch - 24ms/step
Epoch 9/50
483/483 - 12s - loss: 3.2683 - accuracy200: 0.3754 - val_loss: 3.2730 - val_accuracy200: 0.3632 - 12s/epoch - 24ms/step
Epoch 10/50
483/483 - 12s - loss: 3.2638 - accuracy200: 0.3798 - val_loss: 3.2714 - val_accuracy200: 0.3671 - 12s/epoch - 25ms/step
Epoch 11/50
483/483 - 12s - loss: 3.2560 - accuracy200: 0.3809 - val_loss: 3.2749 - val_accuracy200: 0.3615 - 12s/epoch - 24ms/step
Epoch 12/50
483/483 - 11s - loss: 3.2490 - accuracy200: 0.3863 - val_loss: 3.2774 - val_accuracy200: 0.3607 - 11s/epoch - 24ms/step
Epoch 13/50
483/483 - 11s - loss: 3.2421 - accuracy200: 0.3898 - val_loss: 3.2849 - val_accuracy200: 0.3576 - 11s/epoch - 24ms/step
Epoch 14/50
483/483 - 12s - loss: 3.2406 - accuracy200: 0.3903 - val_loss: 3.2837 - val_accuracy200: 0.3580 - 12s/epoch - 24ms/step
Epoch 15/50
483/483 - 12s - loss: 3.2329 - accuracy200: 0.3941 - val_loss: 3.2860 - val_accuracy200: 0.3608 - 12s/epoch - 24ms/step
Epoch 16/50
483/483 - 11s - loss: 3.2297 - accuracy200: 0.3952 - val_loss: 3.2877 - val_accuracy200: 0.3601 - 11s/epoch - 24ms/step
Epoch 17/50
483/483 - 12s - loss: 3.2259 - accuracy200: 0.3980 - val_loss: 3.2915 - val_accuracy200: 0.3566 - 12s/epoch - 25ms/step
Epoch 18/50
483/483 - 11s - loss: 3.2188 - accuracy200: 0.4003 - val_loss: 3.3031 - val_accuracy200: 0.3510 - 11s/epoch - 23ms/step
Epoch 19/50
483/483 - 12s - loss: 3.2139 - accuracy200: 0.4068 - val_loss: 3.3092 - val_accuracy200: 0.3545 - 12s/epoch - 24ms/step
Epoch 20/50
483/483 - 12s - loss: 3.2098 - accuracy200: 0.4073 - val_loss: 3.3180 - val_accuracy200: 0.3535 - 12s/epoch - 24ms/step
testing model: results/XRAY/W5/deepVOL_L2/h200
Evaluating performance on  test set...
2341/2341 - 26s - 26s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0866187
{'0': {'precision': 0.3820949172992811, 'recall': 0.5595439130894919, 'f1-score': 0.454099551330046, 'support': 217327}, '1': {'precision': 0.2774558896783158, 'recall': 0.0694181157471483, 'f1-score': 0.11105164851308527, 'support': 152453}, '2': {'precision': 0.3960656115676619, 'recall': 0.4191579195043202, 'f1-score': 0.40728470512524684, 'support': 229503}, 'accuracy': 0.3810970776744877, 'macro avg': {'precision': 0.3518721395150863, 'recall': 0.34937331611365346, 'f1-score': 0.32414530165612604, 'support': 599283}, 'weighted avg': {'precision': 0.36082580499136846, 'recall': 0.3810970776744877, 'f1-score': 0.3489024581759032, 'support': 599283}}
[[121604  12611  83112]
 [ 78296  10583  63574]
 [118356  14949  96198]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0906559
{'0': {'precision': 0.3748899109501908, 'recall': 0.4628824126431782, 'f1-score': 0.4142651686365259, 'support': 41382}, '1': {'precision': 0.4364673820473514, 'recall': 0.12581627141945304, 'f1-score': 0.1953273877582133, 'support': 40734}, '2': {'precision': 0.34940235759624105, 'recall': 0.5122051430781129, 'f1-score': 0.4154227636698651, 'support': 41376}, 'accuracy': 0.36822628186441225, 'macro avg': {'precision': 0.3869198835312611, 'recall': 0.36696794238024805, 'f1-score': 0.34167177335486815, 'support': 123492}, 'weighted avg': {'precision': 0.3866617156023036, 'recall': 0.36822628186441225, 'f1-score': 0.34243610348090653, 'support': 123492}}
[[19155  3280 18947]
 [15094  5125 20515]
 [16846  3337 21193]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0909299
{'0': {'precision': 0.3866830934647477, 'recall': 0.4564685661400145, 'f1-score': 0.4186878486538928, 'support': 15127}, '1': {'precision': 0.30366789877736705, 'recall': 0.0939975356451329, 'f1-score': 0.14355803481416762, 'support': 11362}, '2': {'precision': 0.36212341470750414, 'recall': 0.4869893487933127, 'f1-score': 0.4153753270275709, 'support': 14834}, 'accuracy': 0.3677612951625003, 'macro avg': {'precision': 0.3508248023165396, 'recall': 0.34581848352615335, 'f1-score': 0.3258737368318771, 'support': 41323}, 'weighted avg': {'precision': 0.35504122533506277, 'recall': 0.3677612951625003, 'f1-score': 0.34185018220538194, 'support': 41323}}
[[6905 1214 7008]
 [4577 1068 5717]
 [6375 1235 7224]]
training model: results/XRAY/W5/deepVOL_L2/h300
Epoch 1/50
483/483 - 14s - loss: 3.3148 - accuracy300: 0.3661 - val_loss: 3.3555 - val_accuracy300: 0.3203 - 14s/epoch - 29ms/step
Epoch 2/50
483/483 - 11s - loss: 3.2778 - accuracy300: 0.3777 - val_loss: 3.3768 - val_accuracy300: 0.2954 - 11s/epoch - 24ms/step
Epoch 3/50
483/483 - 11s - loss: 3.2708 - accuracy300: 0.3767 - val_loss: 3.3122 - val_accuracy300: 0.3259 - 11s/epoch - 24ms/step
Epoch 4/50
483/483 - 11s - loss: 3.2576 - accuracy300: 0.3868 - val_loss: 3.3262 - val_accuracy300: 0.3223 - 11s/epoch - 23ms/step
Epoch 5/50
483/483 - 12s - loss: 3.2659 - accuracy300: 0.3805 - val_loss: 3.2972 - val_accuracy300: 0.3377 - 12s/epoch - 25ms/step
Epoch 6/50
483/483 - 12s - loss: 3.2597 - accuracy300: 0.3853 - val_loss: 3.2817 - val_accuracy300: 0.3586 - 12s/epoch - 24ms/step
Epoch 7/50
483/483 - 11s - loss: 3.2566 - accuracy300: 0.3869 - val_loss: 3.2993 - val_accuracy300: 0.3375 - 11s/epoch - 23ms/step
Epoch 8/50
483/483 - 12s - loss: 3.2445 - accuracy300: 0.3931 - val_loss: 3.2997 - val_accuracy300: 0.3416 - 12s/epoch - 24ms/step
Epoch 9/50
483/483 - 12s - loss: 3.2349 - accuracy300: 0.3965 - val_loss: 3.2958 - val_accuracy300: 0.3525 - 12s/epoch - 24ms/step
Epoch 10/50
483/483 - 12s - loss: 3.2277 - accuracy300: 0.4005 - val_loss: 3.3018 - val_accuracy300: 0.3560 - 12s/epoch - 24ms/step
Epoch 11/50
483/483 - 12s - loss: 3.2233 - accuracy300: 0.4026 - val_loss: 3.3019 - val_accuracy300: 0.3566 - 12s/epoch - 24ms/step
Epoch 12/50
483/483 - 11s - loss: 3.2161 - accuracy300: 0.4071 - val_loss: 3.3056 - val_accuracy300: 0.3537 - 11s/epoch - 24ms/step
Epoch 13/50
483/483 - 12s - loss: 3.2072 - accuracy300: 0.4113 - val_loss: 3.3154 - val_accuracy300: 0.3510 - 12s/epoch - 24ms/step
Epoch 14/50
483/483 - 12s - loss: 3.2019 - accuracy300: 0.4143 - val_loss: 3.3213 - val_accuracy300: 0.3557 - 12s/epoch - 24ms/step
Epoch 15/50
483/483 - 12s - loss: 3.1954 - accuracy300: 0.4161 - val_loss: 3.3266 - val_accuracy300: 0.3469 - 12s/epoch - 24ms/step
Epoch 16/50
483/483 - 12s - loss: 3.1820 - accuracy300: 0.4228 - val_loss: 3.3423 - val_accuracy300: 0.3472 - 12s/epoch - 24ms/step
testing model: results/XRAY/W5/deepVOL_L2/h300
Evaluating performance on  test set...
2341/2341 - 25s - 25s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1038829
{'0': {'precision': 0.3867330063868613, 'recall': 0.23638748131914097, 'f1-score': 0.29342267868394084, 'support': 229513}, '1': {'precision': 0.21463114630138092, 'recall': 0.5203868780861431, 'f1-score': 0.30391426729132515, 'support': 122726}, '2': {'precision': 0.4069426033523706, 'recall': 0.2659283366525801, 'f1-score': 0.3216592163179773, 'support': 247044}, 'accuracy': 0.3067248695524485, 'macro avg': {'precision': 0.33610225201353766, 'recall': 0.34090089868595475, 'f1-score': 0.3063320540977477, 'support': 599283}, 'weighted avg': {'precision': 0.3598196562532794, 'recall': 0.3067248695524485, 'f1-score': 0.3072112525408544, 'support': 599283}}
[[ 54254 110483  64776]
 [ 27895  63865  30966]
 [ 58139 123209  65696]]
Evaluating performance on  train set...
483/483 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0910934
{'0': {'precision': 0.37728585178055823, 'recall': 0.23706427344638234, 'f1-score': 0.2911727129571857, 'support': 41339}, '1': {'precision': 0.37731866352451315, 'recall': 0.6334927300531592, 'f1-score': 0.4729440759668008, 'support': 41197}, '2': {'precision': 0.37156966490299825, 'recall': 0.2572028518410001, 'f1-score': 0.3039852249444493, 'support': 40956}, 'accuracy': 0.37599196709098565, 'macro avg': {'precision': 0.37539139340268984, 'recall': 0.37591995178018056, 'f1-score': 0.35603400462281193, 'support': 123492}, 'weighted avg': {'precision': 0.3754010300565467, 'recall': 0.37599196709098565, 'f1-score': 0.35606099788946866, 'support': 123492}}
[[ 9800 21353 10186]
 [ 7469 26098  7630]
 [ 8706 21716 10534]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0942274
{'0': {'precision': 0.3982448344812264, 'recall': 0.23755880988668743, 'f1-score': 0.2975968123521355, 'support': 15091}, '1': {'precision': 0.3313468992248062, 'recall': 0.5833830930649151, 'f1-score': 0.42264314185953095, 'support': 11723}, '2': {'precision': 0.37445424193134147, 'recall': 0.30146805431111723, 'f1-score': 0.334020618556701, 'support': 14509}, 'accuracy': 0.3581056554461196, 'macro avg': {'precision': 0.36801532521245806, 'recall': 0.3741366524209066, 'f1-score': 0.35142019092278914, 'support': 41323}, 'weighted avg': {'precision': 0.3709132708891035, 'recall': 0.3581056554461196, 'f1-score': 0.3458602764045334, 'support': 41323}}
[[3585 6917 4589]
 [2166 6839 2718]
 [3251 6884 4374]]
training model: results/XRAY/W5/deepVOL_L2/h500
Epoch 1/50
483/483 - 14s - loss: 3.3311 - accuracy500: 0.3588 - val_loss: 3.3921 - val_accuracy500: 0.3154 - 14s/epoch - 29ms/step
Epoch 2/50
483/483 - 12s - loss: 3.2922 - accuracy500: 0.3654 - val_loss: 3.3183 - val_accuracy500: 0.3162 - 12s/epoch - 24ms/step
Epoch 3/50
483/483 - 12s - loss: 3.2748 - accuracy500: 0.3699 - val_loss: 3.3043 - val_accuracy500: 0.3241 - 12s/epoch - 24ms/step
Epoch 4/50
483/483 - 12s - loss: 3.2638 - accuracy500: 0.3735 - val_loss: 3.2858 - val_accuracy500: 0.3386 - 12s/epoch - 25ms/step
Epoch 5/50
483/483 - 12s - loss: 3.2600 - accuracy500: 0.3758 - val_loss: 3.2938 - val_accuracy500: 0.3327 - 12s/epoch - 24ms/step
Epoch 6/50
483/483 - 12s - loss: 3.2578 - accuracy500: 0.3786 - val_loss: 3.2887 - val_accuracy500: 0.3351 - 12s/epoch - 25ms/step
Epoch 7/50
483/483 - 12s - loss: 3.2491 - accuracy500: 0.3839 - val_loss: 3.2933 - val_accuracy500: 0.3327 - 12s/epoch - 24ms/step
Epoch 8/50
483/483 - 12s - loss: 3.2443 - accuracy500: 0.3845 - val_loss: 3.2927 - val_accuracy500: 0.3371 - 12s/epoch - 24ms/step
Epoch 9/50
483/483 - 12s - loss: 3.2393 - accuracy500: 0.3886 - val_loss: 3.2879 - val_accuracy500: 0.3449 - 12s/epoch - 25ms/step
Epoch 10/50
483/483 - 12s - loss: 3.2339 - accuracy500: 0.3936 - val_loss: 3.2880 - val_accuracy500: 0.3504 - 12s/epoch - 25ms/step
Epoch 11/50
483/483 - 12s - loss: 3.2277 - accuracy500: 0.3967 - val_loss: 3.3005 - val_accuracy500: 0.3507 - 12s/epoch - 24ms/step
Epoch 12/50
483/483 - 12s - loss: 3.2206 - accuracy500: 0.4014 - val_loss: 3.2951 - val_accuracy500: 0.3540 - 12s/epoch - 25ms/step
Epoch 13/50
483/483 - 12s - loss: 3.2120 - accuracy500: 0.4059 - val_loss: 3.3110 - val_accuracy500: 0.3519 - 12s/epoch - 24ms/step
Epoch 14/50
483/483 - 12s - loss: 3.2061 - accuracy500: 0.4108 - val_loss: 3.3120 - val_accuracy500: 0.3531 - 12s/epoch - 24ms/step
testing model: results/XRAY/W5/deepVOL_L2/h500
Evaluating performance on  test set...
2341/2341 - 23s - 23s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1059253
{'0': {'precision': 0.3824938549347998, 'recall': 0.17025419446363252, 'f1-score': 0.23562700304446715, 'support': 215701}, '1': {'precision': 0.2696349965757486, 'recall': 0.7281276139690506, 'f1-score': 0.39353787088103725, 'support': 153024}, '2': {'precision': 0.3841540614379956, 'recall': 0.15002732501149385, 'f1-score': 0.21578290704928257, 'support': 230558}, 'accuracy': 0.30492271597892817, 'macro avg': {'precision': 0.3454276376495146, 'recall': 0.34946971114805897, 'f1-score': 0.28164926032492904, 'support': 599283}, 'weighted avg': {'precision': 0.3543146139909191, 'recall': 0.30492271597892817, 'f1-score': 0.2683142936156423, 'support': 599283}}
[[ 36724 143929  35048]
 [ 21199 111421  20404]
 [ 38089 157879  34590]]
Evaluating performance on  train set...
483/483 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0967156
{'0': {'precision': 0.40548801195408546, 'recall': 0.14168070816621972, 'f1-score': 0.2099894477664439, 'support': 42137}, '1': {'precision': 0.3431198924616468, 'recall': 0.8139393632636533, 'f1-score': 0.4827389529298752, 'support': 39514}, '2': {'precision': 0.37598935816428336, 'recall': 0.13510671351067136, 'f1-score': 0.198783318095506, 'support': 41841}, 'accuracy': 0.3545573802351569, 'macro avg': {'precision': 0.3748657541933385, 'recall': 0.3635755949801815, 'f1-score': 0.29717057293060833, 'support': 123492}, 'weighted avg': {'precision': 0.3755373508032147, 'recall': 0.3545573802351569, 'f1-score': 0.293464881603989, 'support': 123492}}
[[ 5970 30624  5543]
 [ 3513 32162  3839]
 [ 5240 30948  5653]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995322
{'0': {'precision': 0.41603224361845054, 'recall': 0.18340352724401157, 'f1-score': 0.2545786709294359, 'support': 15196}, '1': {'precision': 0.3107408720311946, 'recall': 0.7545188500602513, 'f1-score': 0.4401928291654113, 'support': 11618}, '2': {'precision': 0.37620829435609604, 'recall': 0.16631056585567577, 'f1-score': 0.2306552597619844, 'support': 14509}, 'accuracy': 0.33797158967161145, 'macro avg': {'precision': 0.3676604700019137, 'recall': 0.3680776477199796, 'f1-score': 0.30847558661894386, 'support': 41323}, 'weighted avg': {'precision': 0.3724468109308857, 'recall': 0.33797158967161145, 'f1-score': 0.29836446861491395, 'support': 41323}}
[[2787 9844 2565]
 [1416 8766 1436]
 [2496 9600 2413]]
training model: results/XRAY/W5/deepVOL_L2/h1000
Epoch 1/50
483/483 - 15s - loss: 3.3331 - accuracy1000: 0.3691 - val_loss: 3.3179 - val_accuracy1000: 0.3454 - 15s/epoch - 31ms/step
Epoch 2/50
483/483 - 12s - loss: 3.2912 - accuracy1000: 0.3707 - val_loss: 3.2954 - val_accuracy1000: 0.3515 - 12s/epoch - 24ms/step
Epoch 3/50
483/483 - 12s - loss: 3.2859 - accuracy1000: 0.3666 - val_loss: 3.2919 - val_accuracy1000: 0.3589 - 12s/epoch - 24ms/step
Epoch 4/50
483/483 - 12s - loss: 3.2885 - accuracy1000: 0.3625 - val_loss: 3.2674 - val_accuracy1000: 0.3598 - 12s/epoch - 24ms/step
Epoch 5/50
483/483 - 12s - loss: 3.2785 - accuracy1000: 0.3687 - val_loss: 3.2698 - val_accuracy1000: 0.3587 - 12s/epoch - 24ms/step
Epoch 6/50
483/483 - 11s - loss: 3.2750 - accuracy1000: 0.3746 - val_loss: 3.2720 - val_accuracy1000: 0.3628 - 11s/epoch - 24ms/step
Epoch 7/50
483/483 - 12s - loss: 3.2732 - accuracy1000: 0.3736 - val_loss: 3.2794 - val_accuracy1000: 0.3443 - 12s/epoch - 24ms/step
Epoch 8/50
483/483 - 11s - loss: 3.2597 - accuracy1000: 0.3803 - val_loss: 3.2742 - val_accuracy1000: 0.3496 - 11s/epoch - 24ms/step
Epoch 9/50
483/483 - 12s - loss: 3.2557 - accuracy1000: 0.3820 - val_loss: 3.2762 - val_accuracy1000: 0.3517 - 12s/epoch - 24ms/step
Epoch 10/50
483/483 - 12s - loss: 3.2509 - accuracy1000: 0.3882 - val_loss: 3.2768 - val_accuracy1000: 0.3484 - 12s/epoch - 24ms/step
Epoch 11/50
483/483 - 12s - loss: 3.2430 - accuracy1000: 0.3946 - val_loss: 3.2839 - val_accuracy1000: 0.3513 - 12s/epoch - 24ms/step
Epoch 12/50
483/483 - 12s - loss: 3.2345 - accuracy1000: 0.4015 - val_loss: 3.2879 - val_accuracy1000: 0.3457 - 12s/epoch - 24ms/step
Epoch 13/50
483/483 - 12s - loss: 3.2236 - accuracy1000: 0.4058 - val_loss: 3.2951 - val_accuracy1000: 0.3453 - 12s/epoch - 24ms/step
Epoch 14/50
483/483 - 12s - loss: 3.2121 - accuracy1000: 0.4130 - val_loss: 3.3086 - val_accuracy1000: 0.3450 - 12s/epoch - 24ms/step
testing model: results/XRAY/W5/deepVOL_L2/h1000
Evaluating performance on  test set...
2341/2341 - 25s - 25s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0942454
{'0': {'precision': 0.36224592473334677, 'recall': 0.3709283741888804, 'f1-score': 0.3665357394971673, 'support': 218371}, '1': {'precision': 0.2749751479061508, 'recall': 0.18659986246193142, 'f1-score': 0.22232713481962402, 'support': 152685}, '2': {'precision': 0.37199933839339866, 'recall': 0.44345322858382225, 'f1-score': 0.4045957161017965, 'support': 228227}, 'accuracy': 0.35158514424737564, 'macro avg': {'precision': 0.33640680367763204, 'recall': 0.33366048841154466, 'f1-score': 0.3311528634728626, 'support': 599283}, 'weighted avg': {'precision': 0.34372554918378545, 'recall': 0.35158514424737564, 'f1-score': 0.344288860268746, 'support': 599283}}
[[ 81000  35049 102322]
 [ 55659  28491  68535]
 [ 86946  40073 101208]]
Evaluating performance on  train set...
483/483 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0946819
{'0': {'precision': 0.35077857775013754, 'recall': 0.35676924948303124, 'f1-score': 0.353748552682362, 'support': 41105}, '1': {'precision': 0.38007647679324896, 'recall': 0.2815491306895878, 'f1-score': 0.3234766019526428, 'support': 40952}, '2': {'precision': 0.3530351126604218, 'recall': 0.43750452515988897, 'f1-score': 0.39075702707363336, 'support': 41435}, 'accuracy': 0.3589139377449551, 'macro avg': {'precision': 0.3612967224012695, 'recall': 0.35860763511083604, 'f1-score': 0.355994060569546, 'support': 123492}, 'weighted avg': {'precision': 0.3612513783009516, 'recall': 0.3589139377449551, 'f1-score': 0.3561272428818799, 'support': 123492}}
[[14665  9434 17006]
 [13207 11530 16215]
 [13935  9372 18128]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0898005
{'0': {'precision': 0.392736009044658, 'recall': 0.34980174963811445, 'f1-score': 0.3700276289071603, 'support': 15889}, '1': {'precision': 0.3082047685834502, 'recall': 0.24716468272565376, 'f1-score': 0.2743302990897269, 'support': 10669}, '2': {'precision': 0.3604082728982004, 'recall': 0.45438537080934643, 'f1-score': 0.4019772318753745, 'support': 14765}, 'accuracy': 0.3606708128645065, 'macro avg': {'precision': 0.35378301684210284, 'recall': 0.35045060105770487, 'f1-score': 0.3487783866240872, 'support': 41323}, 'weighted avg': {'precision': 0.35936033862665656, 'recall': 0.3606708128645065, 'f1-score': 0.35673578359107694, 'support': 41323}}
[[5558 2982 7349]
 [3475 2637 4557]
 [5119 2937 6709]]
training model: results/XRAY/W5/deepVOL_L3/h10
Epoch 1/50
483/483 - 21s - loss: 3.3212 - accuracy10: 0.3691 - val_loss: 3.4255 - val_accuracy10: 0.4006 - 21s/epoch - 43ms/step
Epoch 2/50
483/483 - 18s - loss: 3.2805 - accuracy10: 0.3929 - val_loss: 3.3891 - val_accuracy10: 0.4061 - 18s/epoch - 37ms/step
Epoch 3/50
483/483 - 18s - loss: 3.2262 - accuracy10: 0.4073 - val_loss: 3.3120 - val_accuracy10: 0.4029 - 18s/epoch - 38ms/step
Epoch 4/50
483/483 - 18s - loss: 3.1641 - accuracy10: 0.4124 - val_loss: 3.2931 - val_accuracy10: 0.4078 - 18s/epoch - 37ms/step
Epoch 5/50
483/483 - 18s - loss: 3.1203 - accuracy10: 0.4287 - val_loss: 3.2461 - val_accuracy10: 0.4232 - 18s/epoch - 37ms/step
Epoch 6/50
483/483 - 18s - loss: 3.0887 - accuracy10: 0.4409 - val_loss: 3.1990 - val_accuracy10: 0.4392 - 18s/epoch - 37ms/step
Epoch 7/50
483/483 - 18s - loss: 3.0578 - accuracy10: 0.4531 - val_loss: 3.1828 - val_accuracy10: 0.4496 - 18s/epoch - 37ms/step
Epoch 8/50
483/483 - 18s - loss: 3.0333 - accuracy10: 0.4672 - val_loss: 3.1520 - val_accuracy10: 0.4545 - 18s/epoch - 37ms/step
Epoch 9/50
483/483 - 18s - loss: 3.0097 - accuracy10: 0.4810 - val_loss: 3.1401 - val_accuracy10: 0.4666 - 18s/epoch - 37ms/step
Epoch 10/50
483/483 - 18s - loss: 2.9889 - accuracy10: 0.4913 - val_loss: 3.1431 - val_accuracy10: 0.4694 - 18s/epoch - 37ms/step
Epoch 11/50
483/483 - 18s - loss: 2.9730 - accuracy10: 0.4986 - val_loss: 3.1222 - val_accuracy10: 0.4664 - 18s/epoch - 37ms/step
Epoch 12/50
483/483 - 18s - loss: 2.9571 - accuracy10: 0.5034 - val_loss: 3.1166 - val_accuracy10: 0.4715 - 18s/epoch - 37ms/step
Epoch 13/50
483/483 - 18s - loss: 2.9464 - accuracy10: 0.5071 - val_loss: 3.1359 - val_accuracy10: 0.4754 - 18s/epoch - 37ms/step
Epoch 14/50
483/483 - 18s - loss: 2.9358 - accuracy10: 0.5104 - val_loss: 3.1236 - val_accuracy10: 0.4733 - 18s/epoch - 37ms/step
Epoch 15/50
483/483 - 18s - loss: 2.9306 - accuracy10: 0.5118 - val_loss: 3.1294 - val_accuracy10: 0.4745 - 18s/epoch - 37ms/step
Epoch 16/50
483/483 - 18s - loss: 2.9221 - accuracy10: 0.5155 - val_loss: 3.1125 - val_accuracy10: 0.4759 - 18s/epoch - 37ms/step
Epoch 17/50
483/483 - 18s - loss: 2.9140 - accuracy10: 0.5170 - val_loss: 3.1210 - val_accuracy10: 0.4761 - 18s/epoch - 37ms/step
Epoch 18/50
483/483 - 18s - loss: 2.9084 - accuracy10: 0.5194 - val_loss: 3.1333 - val_accuracy10: 0.4776 - 18s/epoch - 38ms/step
Epoch 19/50
483/483 - 18s - loss: 2.9001 - accuracy10: 0.5216 - val_loss: 3.1278 - val_accuracy10: 0.4740 - 18s/epoch - 37ms/step
Epoch 20/50
483/483 - 18s - loss: 2.8958 - accuracy10: 0.5221 - val_loss: 3.1174 - val_accuracy10: 0.4763 - 18s/epoch - 37ms/step
Epoch 21/50
483/483 - 18s - loss: 2.8882 - accuracy10: 0.5250 - val_loss: 3.1158 - val_accuracy10: 0.4782 - 18s/epoch - 37ms/step
Epoch 22/50
483/483 - 18s - loss: 2.8812 - accuracy10: 0.5272 - val_loss: 3.1066 - val_accuracy10: 0.4772 - 18s/epoch - 37ms/step
Epoch 23/50
483/483 - 18s - loss: 2.8770 - accuracy10: 0.5278 - val_loss: 3.1144 - val_accuracy10: 0.4841 - 18s/epoch - 37ms/step
Epoch 24/50
483/483 - 18s - loss: 2.8733 - accuracy10: 0.5287 - val_loss: 3.1281 - val_accuracy10: 0.4780 - 18s/epoch - 37ms/step
Epoch 25/50
483/483 - 18s - loss: 2.8693 - accuracy10: 0.5303 - val_loss: 3.1256 - val_accuracy10: 0.4790 - 18s/epoch - 37ms/step
Epoch 26/50
483/483 - 18s - loss: 2.8622 - accuracy10: 0.5311 - val_loss: 3.1190 - val_accuracy10: 0.4772 - 18s/epoch - 37ms/step
Epoch 27/50
483/483 - 18s - loss: 2.8561 - accuracy10: 0.5330 - val_loss: 3.1249 - val_accuracy10: 0.4741 - 18s/epoch - 37ms/step
Epoch 28/50
483/483 - 18s - loss: 2.8496 - accuracy10: 0.5341 - val_loss: 3.1277 - val_accuracy10: 0.4735 - 18s/epoch - 37ms/step
Epoch 29/50
483/483 - 18s - loss: 2.8444 - accuracy10: 0.5364 - val_loss: 3.1394 - val_accuracy10: 0.4710 - 18s/epoch - 37ms/step
Epoch 30/50
483/483 - 18s - loss: 2.8419 - accuracy10: 0.5353 - val_loss: 3.1360 - val_accuracy10: 0.4759 - 18s/epoch - 37ms/step
Epoch 31/50
483/483 - 18s - loss: 2.8351 - accuracy10: 0.5381 - val_loss: 3.1224 - val_accuracy10: 0.4760 - 18s/epoch - 37ms/step
Epoch 32/50
483/483 - 18s - loss: 2.8304 - accuracy10: 0.5391 - val_loss: 3.1425 - val_accuracy10: 0.4733 - 18s/epoch - 37ms/step
testing model: results/XRAY/W5/deepVOL_L3/h10
Evaluating performance on  test set...
2341/2341 - 38s - 38s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0117384
{'0': {'precision': 0.44855128346369944, 'recall': 0.42502711260866793, 'f1-score': 0.43647246251656424, 'support': 172429}, '1': {'precision': 0.5969571078492786, 'recall': 0.4688658673867009, 'f1-score': 0.5252144468033042, 'support': 254062}, '2': {'precision': 0.4179775756293632, 'recall': 0.5717220704662253, 'f1-score': 0.48290813458408083, 'support': 172792}, 'accuracy': 0.48590899458185866, 'macro avg': {'precision': 0.4878286556474471, 'recall': 0.4885383501538647, 'f1-score': 0.4815316813013164, 'support': 599283}, 'weighted avg': {'precision': 0.5026515807037987, 'recall': 0.48590899458185866, 'f1-score': 0.48748288440363274, 'support': 599283}}
[[ 73287  43580  55562]
 [ 52942 119121  81999]
 [ 37157  36846  98789]]
Evaluating performance on  train set...
483/483 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96803766
{'0': {'precision': 0.48960845102767253, 'recall': 0.3862202228193593, 'f1-score': 0.43181204428841485, 'support': 33121}, '1': {'precision': 0.6459628665476216, 'recall': 0.5315570505443923, 'f1-score': 0.5832022220927296, 'support': 56485}, '2': {'precision': 0.4180685480701203, 'recall': 0.6277813846426252, 'f1-score': 0.5018992568125515, 'support': 33886}, 'accuracy': 0.5189809866226153, 'macro avg': {'precision': 0.5178799552151382, 'recall': 0.5151862193354589, 'f1-score': 0.5056378410645653, 'support': 123492}, 'weighted avg': {'precision': 0.5414942250780135, 'recall': 0.5189809866226153, 'f1-score': 0.520289431300283, 'support': 123492}}
[[12792  9079 11250]
 [ 8099 30025 18361]
 [ 5236  7377 21273]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0157156
{'0': {'precision': 0.46247464503042596, 'recall': 0.35321456235476373, 'f1-score': 0.4005270092226614, 'support': 11619}, '1': {'precision': 0.6023710349247037, 'recall': 0.43922668068453946, 'f1-score': 0.5080222935314982, 'support': 17121}, '2': {'precision': 0.4104182319058352, 'recall': 0.6511960581737265, 'f1-score': 0.503502519356028, 'support': 12583}, 'accuracy': 0.4795876388451952, 'macro avg': {'precision': 0.49175463728698826, 'recall': 0.4812124337376766, 'f1-score': 0.4706839407033958, 'support': 41323}, 'weighted avg': {'precision': 0.5045853399226943, 'recall': 0.4795876388451952, 'f1-score': 0.47642100546348964, 'support': 41323}}
[[4104 2588 4927]
 [2757 7520 6844]
 [2013 2376 8194]]
training model: results/XRAY/W5/deepVOL_L3/h20
Epoch 1/50
483/483 - 20s - loss: 3.3347 - accuracy20: 0.3571 - val_loss: 3.3218 - val_accuracy20: 0.3346 - 20s/epoch - 42ms/step
Epoch 2/50
483/483 - 18s - loss: 3.2943 - accuracy20: 0.3585 - val_loss: 3.2915 - val_accuracy20: 0.3737 - 18s/epoch - 37ms/step
Epoch 3/50
483/483 - 18s - loss: 3.2740 - accuracy20: 0.3771 - val_loss: 3.2716 - val_accuracy20: 0.3874 - 18s/epoch - 38ms/step
Epoch 4/50
483/483 - 19s - loss: 3.2521 - accuracy20: 0.3930 - val_loss: 3.2586 - val_accuracy20: 0.4006 - 19s/epoch - 38ms/step
Epoch 5/50
483/483 - 18s - loss: 3.2100 - accuracy20: 0.4119 - val_loss: 3.2272 - val_accuracy20: 0.4172 - 18s/epoch - 38ms/step
Epoch 6/50
483/483 - 18s - loss: 3.1628 - accuracy20: 0.4322 - val_loss: 3.2378 - val_accuracy20: 0.4227 - 18s/epoch - 37ms/step
Epoch 7/50
483/483 - 18s - loss: 3.1321 - accuracy20: 0.4447 - val_loss: 3.1768 - val_accuracy20: 0.4413 - 18s/epoch - 37ms/step
Epoch 8/50
483/483 - 18s - loss: 3.1138 - accuracy20: 0.4529 - val_loss: 3.1830 - val_accuracy20: 0.4382 - 18s/epoch - 37ms/step
Epoch 9/50
483/483 - 18s - loss: 3.0959 - accuracy20: 0.4595 - val_loss: 3.1660 - val_accuracy20: 0.4465 - 18s/epoch - 38ms/step
Epoch 10/50
483/483 - 18s - loss: 3.0835 - accuracy20: 0.4646 - val_loss: 3.1533 - val_accuracy20: 0.4523 - 18s/epoch - 38ms/step
Epoch 11/50
483/483 - 18s - loss: 3.0685 - accuracy20: 0.4709 - val_loss: 3.1448 - val_accuracy20: 0.4527 - 18s/epoch - 37ms/step
Epoch 12/50
483/483 - 18s - loss: 3.0531 - accuracy20: 0.4769 - val_loss: 3.1460 - val_accuracy20: 0.4541 - 18s/epoch - 38ms/step
Epoch 13/50
483/483 - 18s - loss: 3.0434 - accuracy20: 0.4799 - val_loss: 3.1265 - val_accuracy20: 0.4580 - 18s/epoch - 38ms/step
Epoch 14/50
483/483 - 18s - loss: 3.0310 - accuracy20: 0.4831 - val_loss: 3.1215 - val_accuracy20: 0.4623 - 18s/epoch - 37ms/step
Epoch 15/50
483/483 - 18s - loss: 3.0227 - accuracy20: 0.4858 - val_loss: 3.1210 - val_accuracy20: 0.4623 - 18s/epoch - 38ms/step
Epoch 16/50
483/483 - 18s - loss: 3.0168 - accuracy20: 0.4875 - val_loss: 3.1218 - val_accuracy20: 0.4627 - 18s/epoch - 37ms/step
Epoch 17/50
483/483 - 18s - loss: 3.0077 - accuracy20: 0.4892 - val_loss: 3.1232 - val_accuracy20: 0.4603 - 18s/epoch - 38ms/step
Epoch 18/50
483/483 - 18s - loss: 3.0008 - accuracy20: 0.4908 - val_loss: 3.1379 - val_accuracy20: 0.4569 - 18s/epoch - 37ms/step
Epoch 19/50
483/483 - 18s - loss: 2.9939 - accuracy20: 0.4945 - val_loss: 3.1231 - val_accuracy20: 0.4622 - 18s/epoch - 37ms/step
Epoch 20/50
483/483 - 18s - loss: 2.9883 - accuracy20: 0.4951 - val_loss: 3.1268 - val_accuracy20: 0.4618 - 18s/epoch - 37ms/step
Epoch 21/50
483/483 - 18s - loss: 2.9833 - accuracy20: 0.4976 - val_loss: 3.1381 - val_accuracy20: 0.4589 - 18s/epoch - 37ms/step
Epoch 22/50
483/483 - 18s - loss: 2.9756 - accuracy20: 0.4999 - val_loss: 3.1404 - val_accuracy20: 0.4586 - 18s/epoch - 37ms/step
Epoch 23/50
483/483 - 18s - loss: 2.9692 - accuracy20: 0.5027 - val_loss: 3.1343 - val_accuracy20: 0.4581 - 18s/epoch - 37ms/step
Epoch 24/50
483/483 - 18s - loss: 2.9643 - accuracy20: 0.5030 - val_loss: 3.1237 - val_accuracy20: 0.4619 - 18s/epoch - 37ms/step
Epoch 25/50
483/483 - 18s - loss: 2.9564 - accuracy20: 0.5050 - val_loss: 3.1318 - val_accuracy20: 0.4610 - 18s/epoch - 38ms/step
testing model: results/XRAY/W5/deepVOL_L3/h20
Evaluating performance on  test set...
2341/2341 - 39s - 39s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0459456
{'0': {'precision': 0.490405874921036, 'recall': 0.3609217000503661, 'f1-score': 0.41581672506527995, 'support': 206488}, '1': {'precision': 0.4505942293665027, 'recall': 0.4403614651559167, 'f1-score': 0.44541908481991593, 'support': 186574}, '2': {'precision': 0.44005162692751854, 'recall': 0.5654322304711935, 'f1-score': 0.4949246496703092, 'support': 206221}, 'accuracy': 0.45602828713646143, 'macro avg': {'precision': 0.46035057707168575, 'recall': 0.45557179855915875, 'f1-score': 0.4520534865185017, 'support': 599283}, 'weighted avg': {'precision': 0.46068382151194104, 'recall': 0.45602828713646143, 'f1-score': 0.4522548452669796, 'support': 599283}}
[[ 74526  52171  79791]
 [ 35831  82160  68583]
 [ 41611  48006 116604]]
Evaluating performance on  train set...
483/483 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0146298
{'0': {'precision': 0.5159437428728302, 'recall': 0.30592006410898526, 'f1-score': 0.38409659010517383, 'support': 39932}, '1': {'precision': 0.5121221055496338, 'recall': 0.5286185827656437, 'f1-score': 0.520239603732289, 'support': 42717}, '2': {'precision': 0.4417644736369836, 'recall': 0.6026981367676224, 'f1-score': 0.5098327551390255, 'support': 40843}, 'accuracy': 0.48110808797331, 'macro avg': {'precision': 0.4899434406864826, 'recall': 0.4790789278807505, 'f1-score': 0.4713896496588294, 'support': 123492}, 'weighted avg': {'precision': 0.4900881993968588, 'recall': 0.48110808797331, 'f1-score': 0.4727749117906844, 'support': 123492}}
[[12216 11292 16424]
 [ 5454 22581 14682]
 [ 6007 10220 24616]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.037229
{'0': {'precision': 0.49129216904152967, 'recall': 0.28824580207216866, 'f1-score': 0.3633252274160137, 'support': 13995}, '1': {'precision': 0.4626678902143989, 'recall': 0.44765517798046656, 'f1-score': 0.4550377420413521, 'support': 12389}, '2': {'precision': 0.4454437869822485, 'recall': 0.6298949059508668, 'f1-score': 0.5218500443655724, 'support': 14939}, 'accuracy': 0.4595503714638337, 'macro avg': {'precision': 0.466467948746059, 'recall': 0.45526529533450066, 'f1-score': 0.44673767127431274, 'support': 41323}, 'weighted avg': {'precision': 0.46613535153135555, 'recall': 0.4595503714638337, 'f1-score': 0.44813099137561907, 'support': 41323}}
[[4034 3211 6750]
 [1878 5546 4965]
 [2299 3230 9410]]
training model: results/XRAY/W5/deepVOL_L3/h30
Epoch 1/50
483/483 - 20s - loss: 3.3281 - accuracy30: 0.3547 - val_loss: 3.3294 - val_accuracy30: 0.3361 - 20s/epoch - 42ms/step
Epoch 2/50
483/483 - 18s - loss: 3.2977 - accuracy30: 0.3586 - val_loss: 3.2954 - val_accuracy30: 0.3530 - 18s/epoch - 38ms/step
Epoch 3/50
483/483 - 18s - loss: 3.2805 - accuracy30: 0.3698 - val_loss: 3.2680 - val_accuracy30: 0.3837 - 18s/epoch - 37ms/step
Epoch 4/50
483/483 - 18s - loss: 3.2551 - accuracy30: 0.3875 - val_loss: 3.2359 - val_accuracy30: 0.4116 - 18s/epoch - 37ms/step
Epoch 5/50
483/483 - 18s - loss: 3.2222 - accuracy30: 0.4066 - val_loss: 3.2204 - val_accuracy30: 0.4187 - 18s/epoch - 38ms/step
Epoch 6/50
483/483 - 18s - loss: 3.1901 - accuracy30: 0.4219 - val_loss: 3.2031 - val_accuracy30: 0.4256 - 18s/epoch - 38ms/step
Epoch 7/50
483/483 - 18s - loss: 3.1678 - accuracy30: 0.4317 - val_loss: 3.2009 - val_accuracy30: 0.4257 - 18s/epoch - 37ms/step
Epoch 8/50
483/483 - 18s - loss: 3.1478 - accuracy30: 0.4398 - val_loss: 3.1960 - val_accuracy30: 0.4310 - 18s/epoch - 37ms/step
Epoch 9/50
483/483 - 18s - loss: 3.1371 - accuracy30: 0.4439 - val_loss: 3.1878 - val_accuracy30: 0.4335 - 18s/epoch - 37ms/step
Epoch 10/50
483/483 - 18s - loss: 3.1244 - accuracy30: 0.4497 - val_loss: 3.1935 - val_accuracy30: 0.4338 - 18s/epoch - 37ms/step
Epoch 11/50
483/483 - 18s - loss: 3.1156 - accuracy30: 0.4527 - val_loss: 3.1749 - val_accuracy30: 0.4395 - 18s/epoch - 38ms/step
Epoch 12/50
483/483 - 18s - loss: 3.1068 - accuracy30: 0.4561 - val_loss: 3.1728 - val_accuracy30: 0.4397 - 18s/epoch - 37ms/step
Epoch 13/50
483/483 - 18s - loss: 3.0973 - accuracy30: 0.4589 - val_loss: 3.1791 - val_accuracy30: 0.4373 - 18s/epoch - 38ms/step
Epoch 14/50
483/483 - 18s - loss: 3.0877 - accuracy30: 0.4631 - val_loss: 3.1795 - val_accuracy30: 0.4351 - 18s/epoch - 37ms/step
Epoch 15/50
483/483 - 18s - loss: 3.0812 - accuracy30: 0.4649 - val_loss: 3.1727 - val_accuracy30: 0.4401 - 18s/epoch - 38ms/step
Epoch 16/50
483/483 - 18s - loss: 3.0761 - accuracy30: 0.4669 - val_loss: 3.1858 - val_accuracy30: 0.4354 - 18s/epoch - 37ms/step
Epoch 17/50
483/483 - 19s - loss: 3.0672 - accuracy30: 0.4703 - val_loss: 3.1618 - val_accuracy30: 0.4466 - 19s/epoch - 39ms/step
Epoch 18/50
483/483 - 18s - loss: 3.0618 - accuracy30: 0.4715 - val_loss: 3.1749 - val_accuracy30: 0.4414 - 18s/epoch - 37ms/step
Epoch 19/50
483/483 - 18s - loss: 3.0573 - accuracy30: 0.4737 - val_loss: 3.1631 - val_accuracy30: 0.4452 - 18s/epoch - 37ms/step
Epoch 20/50
483/483 - 18s - loss: 3.0479 - accuracy30: 0.4768 - val_loss: 3.1704 - val_accuracy30: 0.4445 - 18s/epoch - 38ms/step
Epoch 21/50
483/483 - 18s - loss: 3.0439 - accuracy30: 0.4781 - val_loss: 3.1769 - val_accuracy30: 0.4448 - 18s/epoch - 37ms/step
Epoch 22/50
483/483 - 18s - loss: 3.0370 - accuracy30: 0.4796 - val_loss: 3.1614 - val_accuracy30: 0.4454 - 18s/epoch - 37ms/step
Epoch 23/50
483/483 - 18s - loss: 3.0290 - accuracy30: 0.4836 - val_loss: 3.1817 - val_accuracy30: 0.4417 - 18s/epoch - 37ms/step
Epoch 24/50
483/483 - 18s - loss: 3.0275 - accuracy30: 0.4838 - val_loss: 3.1861 - val_accuracy30: 0.4430 - 18s/epoch - 37ms/step
Epoch 25/50
483/483 - 18s - loss: 3.0215 - accuracy30: 0.4857 - val_loss: 3.1799 - val_accuracy30: 0.4455 - 18s/epoch - 37ms/step
Epoch 26/50
483/483 - 18s - loss: 3.0163 - accuracy30: 0.4874 - val_loss: 3.1822 - val_accuracy30: 0.4430 - 18s/epoch - 37ms/step
Epoch 27/50
483/483 - 18s - loss: 3.0125 - accuracy30: 0.4887 - val_loss: 3.1834 - val_accuracy30: 0.4427 - 18s/epoch - 38ms/step
Epoch 28/50
483/483 - 18s - loss: 3.0077 - accuracy30: 0.4895 - val_loss: 3.1839 - val_accuracy30: 0.4424 - 18s/epoch - 37ms/step
Epoch 29/50
483/483 - 18s - loss: 3.0037 - accuracy30: 0.4932 - val_loss: 3.1955 - val_accuracy30: 0.4383 - 18s/epoch - 37ms/step
Epoch 30/50
483/483 - 18s - loss: 2.9968 - accuracy30: 0.4932 - val_loss: 3.1878 - val_accuracy30: 0.4461 - 18s/epoch - 37ms/step
Epoch 31/50
483/483 - 18s - loss: 2.9921 - accuracy30: 0.4957 - val_loss: 3.1875 - val_accuracy30: 0.4424 - 18s/epoch - 37ms/step
Epoch 32/50
483/483 - 18s - loss: 2.9895 - accuracy30: 0.4964 - val_loss: 3.2015 - val_accuracy30: 0.4395 - 18s/epoch - 37ms/step
testing model: results/XRAY/W5/deepVOL_L3/h30
Evaluating performance on  test set...
2341/2341 - 40s - 40s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0681766
{'0': {'precision': 0.4678974825308701, 'recall': 0.3653358371053406, 'f1-score': 0.4103045675958545, 'support': 214077}, '1': {'precision': 0.3947675612259862, 'recall': 0.39246537396121883, 'f1-score': 0.3936131013306039, 'support': 171475}, '2': {'precision': 0.43841532393677196, 'recall': 0.5367213927787733, 'f1-score': 0.48261311310574334, 'support': 213731}, 'accuracy': 0.43422222889686507, 'macro avg': {'precision': 0.43369345589787606, 'recall': 0.43150753461511093, 'f1-score': 0.42884359401073396, 'support': 599283}, 'weighted avg': {'precision': 0.43645790474503243, 'recall': 0.43422222889686507, 'f1-score': 0.4313170250867899, 'support': 599283}}
[[ 78210  54742  81125]
 [ 38360  67298  65817]
 [ 50582  48435 114714]]
Evaluating performance on  train set...
483/483 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0321934
{'0': {'precision': 0.4944957317779752, 'recall': 0.31312983074063205, 'f1-score': 0.3834483998023153, 'support': 40884}, '1': {'precision': 0.4899812222195812, 'recall': 0.49774236387782206, 'f1-score': 0.4938313010564646, 'support': 41415}, '2': {'precision': 0.42971619966865954, 'recall': 0.5792974534508291, 'f1-score': 0.49341948823985526, 'support': 41193}, 'accuracy': 0.46382761636381303, 'macro avg': {'precision': 0.4713977178887387, 'recall': 0.46338988268976106, 'f1-score': 0.456899729699545, 'support': 123492}, 'weighted avg': {'precision': 0.47137332968277934, 'recall': 0.46382761636381303, 'f1-score': 0.4571499100333276, 'support': 123492}}
[[12802 11393 16689]
 [ 5821 20614 14980]
 [ 7266 10064 23863]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0543493
{'0': {'precision': 0.4817094017094017, 'recall': 0.2949961616302603, 'f1-score': 0.3659106648199446, 'support': 14329}, '1': {'precision': 0.4332618945563652, 'recall': 0.424100025174121, 'f1-score': 0.4286320074633195, 'support': 11917}, '2': {'precision': 0.43892161087966286, 'recall': 0.6079458778271539, 'f1-score': 0.5097886540600667, 'support': 15077}, 'accuracy': 0.4464099895941727, 'macro avg': {'precision': 0.45129763571514325, 'recall': 0.4423473548771784, 'f1-score': 0.43477710878111026, 'support': 41323}, 'weighted avg': {'precision': 0.45212634953306624, 'recall': 0.4464099895941727, 'f1-score': 0.43649360129731607, 'support': 41323}}
[[4227 3343 6759]
 [1905 5054 4958]
 [2643 3268 9166]]
training model: results/XRAY/W5/deepVOL_L3/h50
Epoch 1/50
483/483 - 20s - loss: 3.3267 - accuracy50: 0.3541 - val_loss: 3.3794 - val_accuracy50: 0.3138 - 20s/epoch - 42ms/step
Epoch 2/50
483/483 - 18s - loss: 3.3031 - accuracy50: 0.3555 - val_loss: 3.2953 - val_accuracy50: 0.3516 - 18s/epoch - 38ms/step
Epoch 3/50
483/483 - 18s - loss: 3.2825 - accuracy50: 0.3656 - val_loss: 3.2830 - val_accuracy50: 0.3704 - 18s/epoch - 37ms/step
Epoch 4/50
483/483 - 18s - loss: 3.2662 - accuracy50: 0.3798 - val_loss: 3.2742 - val_accuracy50: 0.3801 - 18s/epoch - 37ms/step
Epoch 5/50
483/483 - 18s - loss: 3.2489 - accuracy50: 0.3899 - val_loss: 3.2770 - val_accuracy50: 0.3787 - 18s/epoch - 37ms/step
Epoch 6/50
483/483 - 18s - loss: 3.2302 - accuracy50: 0.4010 - val_loss: 3.2679 - val_accuracy50: 0.3944 - 18s/epoch - 37ms/step
Epoch 7/50
483/483 - 18s - loss: 3.2150 - accuracy50: 0.4087 - val_loss: 3.2819 - val_accuracy50: 0.3870 - 18s/epoch - 37ms/step
Epoch 8/50
483/483 - 18s - loss: 3.2025 - accuracy50: 0.4149 - val_loss: 3.2749 - val_accuracy50: 0.3906 - 18s/epoch - 37ms/step
Epoch 9/50
483/483 - 18s - loss: 3.1936 - accuracy50: 0.4203 - val_loss: 3.2727 - val_accuracy50: 0.3884 - 18s/epoch - 37ms/step
Epoch 10/50
483/483 - 18s - loss: 3.1858 - accuracy50: 0.4228 - val_loss: 3.2819 - val_accuracy50: 0.3947 - 18s/epoch - 37ms/step
Epoch 11/50
483/483 - 18s - loss: 3.1778 - accuracy50: 0.4262 - val_loss: 3.2603 - val_accuracy50: 0.3977 - 18s/epoch - 37ms/step
Epoch 12/50
483/483 - 18s - loss: 3.1729 - accuracy50: 0.4287 - val_loss: 3.2628 - val_accuracy50: 0.4003 - 18s/epoch - 38ms/step
Epoch 13/50
483/483 - 18s - loss: 3.1683 - accuracy50: 0.4317 - val_loss: 3.2533 - val_accuracy50: 0.4017 - 18s/epoch - 37ms/step
Epoch 14/50
483/483 - 18s - loss: 3.1639 - accuracy50: 0.4339 - val_loss: 3.2572 - val_accuracy50: 0.4032 - 18s/epoch - 38ms/step
Epoch 15/50
483/483 - 18s - loss: 3.1565 - accuracy50: 0.4372 - val_loss: 3.2602 - val_accuracy50: 0.4045 - 18s/epoch - 37ms/step
Epoch 16/50
483/483 - 18s - loss: 3.1506 - accuracy50: 0.4388 - val_loss: 3.2647 - val_accuracy50: 0.3998 - 18s/epoch - 37ms/step
Epoch 17/50
483/483 - 18s - loss: 3.1463 - accuracy50: 0.4406 - val_loss: 3.2408 - val_accuracy50: 0.4093 - 18s/epoch - 38ms/step
Epoch 18/50
483/483 - 18s - loss: 3.1413 - accuracy50: 0.4430 - val_loss: 3.2405 - val_accuracy50: 0.4090 - 18s/epoch - 37ms/step
Epoch 19/50
483/483 - 18s - loss: 3.1378 - accuracy50: 0.4451 - val_loss: 3.2365 - val_accuracy50: 0.4136 - 18s/epoch - 38ms/step
Epoch 20/50
483/483 - 18s - loss: 3.1287 - accuracy50: 0.4479 - val_loss: 3.2418 - val_accuracy50: 0.4132 - 18s/epoch - 37ms/step
Epoch 21/50
483/483 - 18s - loss: 3.1261 - accuracy50: 0.4494 - val_loss: 3.2358 - val_accuracy50: 0.4135 - 18s/epoch - 37ms/step
Epoch 22/50
483/483 - 18s - loss: 3.1175 - accuracy50: 0.4526 - val_loss: 3.2429 - val_accuracy50: 0.4151 - 18s/epoch - 37ms/step
Epoch 23/50
483/483 - 18s - loss: 3.1128 - accuracy50: 0.4521 - val_loss: 3.2497 - val_accuracy50: 0.4093 - 18s/epoch - 37ms/step
Epoch 24/50
483/483 - 18s - loss: 3.1073 - accuracy50: 0.4566 - val_loss: 3.2559 - val_accuracy50: 0.4090 - 18s/epoch - 37ms/step
Epoch 25/50
483/483 - 18s - loss: 3.1024 - accuracy50: 0.4574 - val_loss: 3.2602 - val_accuracy50: 0.4083 - 18s/epoch - 37ms/step
Epoch 26/50
483/483 - 18s - loss: 3.0947 - accuracy50: 0.4610 - val_loss: 3.2613 - val_accuracy50: 0.4069 - 18s/epoch - 37ms/step
Epoch 27/50
483/483 - 18s - loss: 3.0895 - accuracy50: 0.4626 - val_loss: 3.2742 - val_accuracy50: 0.4022 - 18s/epoch - 38ms/step
Epoch 28/50
483/483 - 18s - loss: 3.0825 - accuracy50: 0.4653 - val_loss: 3.2783 - val_accuracy50: 0.4036 - 18s/epoch - 38ms/step
Epoch 29/50
483/483 - 18s - loss: 3.0767 - accuracy50: 0.4679 - val_loss: 3.2802 - val_accuracy50: 0.4016 - 18s/epoch - 38ms/step
Epoch 30/50
483/483 - 18s - loss: 3.0703 - accuracy50: 0.4695 - val_loss: 3.2865 - val_accuracy50: 0.4004 - 18s/epoch - 37ms/step
Epoch 31/50
483/483 - 18s - loss: 3.0641 - accuracy50: 0.4709 - val_loss: 3.2833 - val_accuracy50: 0.4066 - 18s/epoch - 37ms/step
testing model: results/XRAY/W5/deepVOL_L3/h50
Evaluating performance on  test set...
2341/2341 - 39s - 39s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0868107
{'0': {'precision': 0.4261401214715935, 'recall': 0.40152989139483664, 'f1-score': 0.41346912183245893, 'support': 210211}, '1': {'precision': 0.3586175677537444, 'recall': 0.3059216601467403, 'f1-score': 0.3301803026184652, 'support': 178683}, '2': {'precision': 0.41176115923387663, 'recall': 0.4869075854726245, 'f1-score': 0.44619251090000744, 'support': 210389}, 'accuracy': 0.40299658091419244, 'macro avg': {'precision': 0.39883961615307156, 'recall': 0.39811971233806714, 'f1-score': 0.3966139784503106, 'support': 599283}, 'weighted avg': {'precision': 0.4009595173960609, 'recall': 0.40299658091419244, 'f1-score': 0.4001237491436265, 'support': 599283}}
[[ 84406  49967  75838]
 [ 53513  54663  70507]
 [ 60152  47797 102440]]
Evaluating performance on  train set...
483/483 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0563962
{'0': {'precision': 0.45253937248199244, 'recall': 0.35728571772813805, 'f1-score': 0.3993105584207479, 'support': 41499}, '1': {'precision': 0.4515386343216532, 'recall': 0.3955044021445084, 'f1-score': 0.4216681087600619, 'support': 40662}, '2': {'precision': 0.4161344171868196, 'recall': 0.5548861629285524, 'f1-score': 0.4755969847474675, 'support': 41331}, 'accuracy': 0.4360039516729829, 'macro avg': {'precision': 0.4400708079968217, 'recall': 0.43589209426706627, 'f1-score': 0.4321918839760925, 'support': 123492}, 'weighted avg': {'precision': 0.44002564509576086, 'recall': 0.4360039516729829, 'f1-score': 0.4322041628518595, 'support': 123492}}
[[14827 10295 16377]
 [ 8779 16082 15801]
 [ 9158  9239 22934]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.079301
{'0': {'precision': 0.4375906410132457, 'recall': 0.3132830345400429, 'f1-score': 0.36514723678902783, 'support': 14447}, '1': {'precision': 0.39048392005681243, 'recall': 0.3201896680808585, 'f1-score': 0.35186031629947895, 'support': 12021}, '2': {'precision': 0.4134355915352933, 'recall': 0.5878828677213059, 'f1-score': 0.48546333870698755, 'support': 14855}, 'accuracy': 0.4140067274883237, 'macro avg': {'precision': 0.41383671753511714, 'recall': 0.40711852344740246, 'f1-score': 0.40082363059849807, 'support': 41323}, 'weighted avg': {'precision': 0.4152037583422812, 'recall': 0.4140067274883237, 'f1-score': 0.40453386464243696, 'support': 41323}}
[[4526 3055 6866]
 [2648 3849 5524]
 [3169 2953 8733]]
training model: results/XRAY/W5/deepVOL_L3/h100
Epoch 1/50
483/483 - 21s - loss: 3.3280 - accuracy100: 0.3522 - val_loss: 3.3636 - val_accuracy100: 0.3092 - 21s/epoch - 43ms/step
Epoch 2/50
483/483 - 18s - loss: 3.3055 - accuracy100: 0.3499 - val_loss: 3.2997 - val_accuracy100: 0.3358 - 18s/epoch - 38ms/step
Epoch 3/50
483/483 - 18s - loss: 3.2966 - accuracy100: 0.3500 - val_loss: 3.2968 - val_accuracy100: 0.3437 - 18s/epoch - 38ms/step
Epoch 4/50
483/483 - 19s - loss: 3.2939 - accuracy100: 0.3519 - val_loss: 3.2883 - val_accuracy100: 0.3561 - 19s/epoch - 39ms/step
Epoch 5/50
483/483 - 19s - loss: 3.2862 - accuracy100: 0.3608 - val_loss: 3.2781 - val_accuracy100: 0.3654 - 19s/epoch - 39ms/step
Epoch 6/50
483/483 - 19s - loss: 3.2818 - accuracy100: 0.3687 - val_loss: 3.2777 - val_accuracy100: 0.3651 - 19s/epoch - 39ms/step
Epoch 7/50
483/483 - 19s - loss: 3.2766 - accuracy100: 0.3743 - val_loss: 3.2814 - val_accuracy100: 0.3683 - 19s/epoch - 39ms/step
Epoch 8/50
483/483 - 19s - loss: 3.2694 - accuracy100: 0.3820 - val_loss: 3.2834 - val_accuracy100: 0.3687 - 19s/epoch - 38ms/step
Epoch 9/50
483/483 - 19s - loss: 3.2633 - accuracy100: 0.3846 - val_loss: 3.2862 - val_accuracy100: 0.3715 - 19s/epoch - 39ms/step
Epoch 10/50
483/483 - 19s - loss: 3.2560 - accuracy100: 0.3924 - val_loss: 3.2888 - val_accuracy100: 0.3765 - 19s/epoch - 39ms/step
Epoch 11/50
483/483 - 19s - loss: 3.2495 - accuracy100: 0.3942 - val_loss: 3.2931 - val_accuracy100: 0.3711 - 19s/epoch - 38ms/step
Epoch 12/50
483/483 - 18s - loss: 3.2378 - accuracy100: 0.4009 - val_loss: 3.3074 - val_accuracy100: 0.3618 - 18s/epoch - 38ms/step
Epoch 13/50
483/483 - 18s - loss: 3.2315 - accuracy100: 0.4047 - val_loss: 3.3122 - val_accuracy100: 0.3628 - 18s/epoch - 37ms/step
Epoch 14/50
483/483 - 18s - loss: 3.2228 - accuracy100: 0.4098 - val_loss: 3.3231 - val_accuracy100: 0.3620 - 18s/epoch - 37ms/step
Epoch 15/50
483/483 - 18s - loss: 3.2165 - accuracy100: 0.4139 - val_loss: 3.3225 - val_accuracy100: 0.3560 - 18s/epoch - 36ms/step
Epoch 16/50
483/483 - 18s - loss: 3.2091 - accuracy100: 0.4152 - val_loss: 3.3146 - val_accuracy100: 0.3594 - 18s/epoch - 38ms/step
testing model: results/XRAY/W5/deepVOL_L3/h100
Evaluating performance on  test set...
2341/2341 - 38s - 38s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0951723
{'0': {'precision': 0.36476321216488183, 'recall': 0.5633394090560245, 'f1-score': 0.44280769752816446, 'support': 208480}, '1': {'precision': 0.33753194047797985, 'recall': 0.25081815237180416, 'f1-score': 0.2877849046206291, 'support': 179062}, '2': {'precision': 0.3757998433242979, 'recall': 0.2560108812180919, 'f1-score': 0.30454959155926603, 'support': 211741}, 'accuracy': 0.36137350800873713, 'macro avg': {'precision': 0.35936499865571986, 'recall': 0.3567228142153069, 'f1-score': 0.3450473979026865, 'support': 599283}, 'weighted avg': {'precision': 0.36052618449602736, 'recall': 0.36137350800873713, 'f1-score': 0.34763796810221775, 'support': 599283}}
[[117445  43354  47681]
 [ 91792  44912  42358]
 [112739  44794  54208]]
Evaluating performance on  train set...
483/483 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0913056
{'0': {'precision': 0.3664331243744403, 'recall': 0.5050094380717294, 'f1-score': 0.42470311689104623, 'support': 41322}, '1': {'precision': 0.40587715979316435, 'recall': 0.39070998445998445, 'f1-score': 0.3981491791312524, 'support': 41184}, '2': {'precision': 0.367945572161499, 'recall': 0.24147269799443713, 'f1-score': 0.2915856461021743, 'support': 40986}, 'accuracy': 0.3794253878793768, 'macro avg': {'precision': 0.38008528544303455, 'recall': 0.3790640401753836, 'f1-score': 0.3714793140414909, 'support': 123492}, 'weighted avg': {'precision': 0.38008949352940674, 'recall': 0.3794253878793768, 'f1-score': 0.37166688757698496, 'support': 123492}}
[[20868 11430  9024]
 [17116 16091  7977]
 [18965 12124  9897]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0927202
{'0': {'precision': 0.37167909272288147, 'recall': 0.4820236960370421, 'f1-score': 0.41972014704138505, 'support': 14686}, '1': {'precision': 0.35408317748686435, 'recall': 0.3296575739988392, 'f1-score': 0.3414340918849291, 'support': 12061}, '2': {'precision': 0.374275887038378, 'recall': 0.283685510428101, 'f1-score': 0.3227443022166719, 'support': 14576}, 'accuracy': 0.3675918979744936, 'macro avg': {'precision': 0.36667938574937464, 'recall': 0.3651222601546607, 'f1-score': 0.36129951371432867, 'support': 41323}, 'weighted avg': {'precision': 0.36745932504582696, 'recall': 0.3675918979744936, 'f1-score': 0.3626640759573148, 'support': 41323}}
[[7079 3543 4064]
 [5236 3976 2849]
 [6731 3710 4135]]
training model: results/XRAY/W5/deepVOL_L3/h200
Epoch 1/50
483/483 - 21s - loss: 3.3198 - accuracy200: 0.3665 - val_loss: 3.3183 - val_accuracy200: 0.3516 - 21s/epoch - 44ms/step
Epoch 2/50
483/483 - 18s - loss: 3.3024 - accuracy200: 0.3546 - val_loss: 3.2832 - val_accuracy200: 0.3586 - 18s/epoch - 38ms/step
Epoch 3/50
483/483 - 18s - loss: 3.2979 - accuracy200: 0.3512 - val_loss: 3.2765 - val_accuracy200: 0.3572 - 18s/epoch - 37ms/step
Epoch 4/50
483/483 - 18s - loss: 3.2939 - accuracy200: 0.3511 - val_loss: 3.2721 - val_accuracy200: 0.3569 - 18s/epoch - 38ms/step
Epoch 5/50
483/483 - 18s - loss: 3.2907 - accuracy200: 0.3522 - val_loss: 3.2723 - val_accuracy200: 0.3550 - 18s/epoch - 37ms/step
Epoch 6/50
483/483 - 18s - loss: 3.2871 - accuracy200: 0.3565 - val_loss: 3.2698 - val_accuracy200: 0.3584 - 18s/epoch - 38ms/step
Epoch 7/50
483/483 - 18s - loss: 3.2849 - accuracy200: 0.3582 - val_loss: 3.2685 - val_accuracy200: 0.3612 - 18s/epoch - 37ms/step
Epoch 8/50
483/483 - 18s - loss: 3.2810 - accuracy200: 0.3636 - val_loss: 3.2636 - val_accuracy200: 0.3587 - 18s/epoch - 38ms/step
Epoch 9/50
483/483 - 18s - loss: 3.2755 - accuracy200: 0.3707 - val_loss: 3.2660 - val_accuracy200: 0.3591 - 18s/epoch - 37ms/step
Epoch 10/50
483/483 - 18s - loss: 3.2725 - accuracy200: 0.3763 - val_loss: 3.2656 - val_accuracy200: 0.3610 - 18s/epoch - 38ms/step
Epoch 11/50
483/483 - 18s - loss: 3.2684 - accuracy200: 0.3797 - val_loss: 3.2674 - val_accuracy200: 0.3613 - 18s/epoch - 38ms/step
Epoch 12/50
483/483 - 18s - loss: 3.2651 - accuracy200: 0.3832 - val_loss: 3.2633 - val_accuracy200: 0.3645 - 18s/epoch - 38ms/step
Epoch 13/50
483/483 - 18s - loss: 3.2597 - accuracy200: 0.3882 - val_loss: 3.2657 - val_accuracy200: 0.3646 - 18s/epoch - 37ms/step
Epoch 14/50
483/483 - 18s - loss: 3.2573 - accuracy200: 0.3896 - val_loss: 3.2695 - val_accuracy200: 0.3677 - 18s/epoch - 38ms/step
Epoch 15/50
483/483 - 18s - loss: 3.2540 - accuracy200: 0.3941 - val_loss: 3.2774 - val_accuracy200: 0.3605 - 18s/epoch - 37ms/step
Epoch 16/50
483/483 - 18s - loss: 3.2495 - accuracy200: 0.3972 - val_loss: 3.2747 - val_accuracy200: 0.3658 - 18s/epoch - 37ms/step
Epoch 17/50
483/483 - 18s - loss: 3.2445 - accuracy200: 0.3991 - val_loss: 3.2799 - val_accuracy200: 0.3614 - 18s/epoch - 37ms/step
Epoch 18/50
483/483 - 18s - loss: 3.2470 - accuracy200: 0.3994 - val_loss: 3.2809 - val_accuracy200: 0.3632 - 18s/epoch - 38ms/step
Epoch 19/50
483/483 - 18s - loss: 3.2436 - accuracy200: 0.4008 - val_loss: 3.2848 - val_accuracy200: 0.3640 - 18s/epoch - 37ms/step
Epoch 20/50
483/483 - 18s - loss: 3.2370 - accuracy200: 0.4041 - val_loss: 3.2881 - val_accuracy200: 0.3623 - 18s/epoch - 38ms/step
Epoch 21/50
483/483 - 18s - loss: 3.2287 - accuracy200: 0.4105 - val_loss: 3.2859 - val_accuracy200: 0.3667 - 18s/epoch - 37ms/step
Epoch 22/50
483/483 - 18s - loss: 3.2256 - accuracy200: 0.4108 - val_loss: 3.2840 - val_accuracy200: 0.3703 - 18s/epoch - 38ms/step
testing model: results/XRAY/W5/deepVOL_L3/h200
Evaluating performance on  test set...
2341/2341 - 39s - 39s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.088527
{'0': {'precision': 0.36679264792398336, 'recall': 0.3786828143764926, 'f1-score': 0.3726429084059506, 'support': 217327}, '1': {'precision': 0.277717550728889, 'recall': 0.14283090526260553, 'f1-score': 0.18864246729619685, 'support': 152453}, '2': {'precision': 0.3919103958125354, 'recall': 0.5063245360627094, 'f1-score': 0.44183062202594264, 'support': 229503}, 'accuracy': 0.367565907926639, 'macro avg': {'precision': 0.3454735314884692, 'recall': 0.34261275190060253, 'f1-score': 0.3343719992426967, 'support': 599283}, 'weighted avg': {'precision': 0.353751785261406, 'recall': 0.367565907926639, 'f1-score': 0.3523309165597339, 'support': 599283}}
[[ 82298  28117 106912]
 [ 57289  21775  73389]
 [ 84785  28515 116203]]
Evaluating performance on  train set...
483/483 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0920912
{'0': {'precision': 0.36388566116662796, 'recall': 0.37837707215697647, 'f1-score': 0.3709899066483438, 'support': 41382}, '1': {'precision': 0.42736906371287775, 'recall': 0.24058526047036874, 'f1-score': 0.3078614623419461, 'support': 40734}, '2': {'precision': 0.3575811301732979, 'recall': 0.49719644238205724, 'f1-score': 0.41598673501369976, 'support': 41376}, 'accuracy': 0.372736695494445, 'macro avg': {'precision': 0.38294528501760117, 'recall': 0.37205292500313414, 'f1-score': 0.3649460346679965, 'support': 123492}, 'weighted avg': {'precision': 0.3827134123160053, 'recall': 0.372736695494445, 'f1-score': 0.3652430948716147, 'support': 123492}}
[[15658  6715 19009]
 [12984  9800 17950]
 [14388  6416 20572]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0876554
{'0': {'precision': 0.3893491124260355, 'recall': 0.41323461360481256, 'f1-score': 0.4009364376884099, 'support': 15127}, '1': {'precision': 0.3185595567867036, 'recall': 0.18218623481781376, 'f1-score': 0.23180291153415455, 'support': 11362}, '2': {'precision': 0.36233351092168353, 'recall': 0.45847377645948495, 'f1-score': 0.4047732412807999, 'support': 14834}, 'accuracy': 0.3659463252910002, 'macro avg': {'precision': 0.3567473933781409, 'recall': 0.3512982082940371, 'f1-score': 0.3458375301677881, 'support': 41323}, 'weighted avg': {'precision': 0.3601871357087196, 'recall': 0.3659463252910002, 'f1-score': 0.35580951128724986, 'support': 41323}}
[[6251 2175 6701]
 [4024 2070 5268]
 [5780 2253 6801]]
training model: results/XRAY/W5/deepVOL_L3/h300
Epoch 1/50
483/483 - 20s - loss: 3.3025 - accuracy300: 0.3664 - val_loss: 3.4196 - val_accuracy300: 0.2969 - 20s/epoch - 42ms/step
Epoch 2/50
483/483 - 18s - loss: 3.2995 - accuracy300: 0.3632 - val_loss: 3.3814 - val_accuracy300: 0.3025 - 18s/epoch - 38ms/step
Epoch 3/50
483/483 - 18s - loss: 3.2996 - accuracy300: 0.3522 - val_loss: 3.2977 - val_accuracy300: 0.3461 - 18s/epoch - 38ms/step
Epoch 4/50
483/483 - 18s - loss: 3.2956 - accuracy300: 0.3515 - val_loss: 3.2850 - val_accuracy300: 0.3617 - 18s/epoch - 37ms/step
Epoch 5/50
483/483 - 18s - loss: 3.2952 - accuracy300: 0.3529 - val_loss: 3.2730 - val_accuracy300: 0.3637 - 18s/epoch - 37ms/step
Epoch 6/50
483/483 - 18s - loss: 3.2883 - accuracy300: 0.3588 - val_loss: 3.2734 - val_accuracy300: 0.3678 - 18s/epoch - 37ms/step
Epoch 7/50
483/483 - 18s - loss: 3.2836 - accuracy300: 0.3638 - val_loss: 3.2788 - val_accuracy300: 0.3643 - 18s/epoch - 37ms/step
Epoch 8/50
483/483 - 18s - loss: 3.2787 - accuracy300: 0.3698 - val_loss: 3.2709 - val_accuracy300: 0.3697 - 18s/epoch - 37ms/step
Epoch 9/50
483/483 - 19s - loss: 3.2739 - accuracy300: 0.3752 - val_loss: 3.2672 - val_accuracy300: 0.3707 - 19s/epoch - 38ms/step
Epoch 10/50
483/483 - 18s - loss: 3.2732 - accuracy300: 0.3760 - val_loss: 3.2784 - val_accuracy300: 0.3665 - 18s/epoch - 38ms/step
Epoch 11/50
483/483 - 18s - loss: 3.2684 - accuracy300: 0.3815 - val_loss: 3.2654 - val_accuracy300: 0.3698 - 18s/epoch - 38ms/step
Epoch 12/50
483/483 - 18s - loss: 3.2618 - accuracy300: 0.3881 - val_loss: 3.2682 - val_accuracy300: 0.3688 - 18s/epoch - 37ms/step
Epoch 13/50
483/483 - 18s - loss: 3.2528 - accuracy300: 0.3952 - val_loss: 3.2697 - val_accuracy300: 0.3723 - 18s/epoch - 38ms/step
Epoch 14/50
483/483 - 18s - loss: 3.2448 - accuracy300: 0.3968 - val_loss: 3.2711 - val_accuracy300: 0.3687 - 18s/epoch - 37ms/step
Epoch 15/50
483/483 - 18s - loss: 3.2400 - accuracy300: 0.4009 - val_loss: 3.2821 - val_accuracy300: 0.3718 - 18s/epoch - 37ms/step
Epoch 16/50
483/483 - 18s - loss: 3.2324 - accuracy300: 0.4067 - val_loss: 3.2858 - val_accuracy300: 0.3685 - 18s/epoch - 37ms/step
Epoch 17/50
483/483 - 18s - loss: 3.2239 - accuracy300: 0.4125 - val_loss: 3.2981 - val_accuracy300: 0.3649 - 18s/epoch - 37ms/step
Epoch 18/50
483/483 - 18s - loss: 3.2146 - accuracy300: 0.4171 - val_loss: 3.2980 - val_accuracy300: 0.3614 - 18s/epoch - 37ms/step
Epoch 19/50
483/483 - 18s - loss: 3.2083 - accuracy300: 0.4207 - val_loss: 3.2963 - val_accuracy300: 0.3615 - 18s/epoch - 37ms/step
Epoch 20/50
483/483 - 18s - loss: 3.1983 - accuracy300: 0.4249 - val_loss: 3.3124 - val_accuracy300: 0.3645 - 18s/epoch - 37ms/step
Epoch 21/50
483/483 - 18s - loss: 3.1932 - accuracy300: 0.4283 - val_loss: 3.3188 - val_accuracy300: 0.3595 - 18s/epoch - 37ms/step
testing model: results/XRAY/W5/deepVOL_L3/h300
Evaluating performance on  test set...
2341/2341 - 39s - 39s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0850394
{'0': {'precision': 0.3889135412414136, 'recall': 0.19093471829482425, 'f1-score': 0.2561259647389908, 'support': 229513}, '1': {'precision': 0.21919697297790136, 'recall': 0.15671495852549583, 'f1-score': 0.18276325729679904, 'support': 122726}, '2': {'precision': 0.4195410944136067, 'recall': 0.677365165719467, 'f1-score': 0.5181527962273148, 'support': 247044}, 'accuracy': 0.38444941705337876, 'macro avg': {'precision': 0.3425505362109739, 'recall': 0.34167161417992903, 'f1-score': 0.31901400608770153, 'support': 599283}, 'weighted avg': {'precision': 0.3667832917418674, 'recall': 0.38444941705337876, 'f1-score': 0.34911816529307144, 'support': 599283}}
[[ 43822  33983 151708]
 [ 23678  19233  79815]
 [ 45178  34527 167339]]
Evaluating performance on  train set...
483/483 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0871243
{'0': {'precision': 0.36368676368676367, 'recall': 0.19042550618060428, 'f1-score': 0.24996824590372155, 'support': 41339}, '1': {'precision': 0.45610600813130553, 'recall': 0.2940990848848217, 'f1-score': 0.3576098345656056, 'support': 41197}, '2': {'precision': 0.36469056759162094, 'recall': 0.670353550151382, 'f1-score': 0.47238878517537136, 'support': 40956}, 'accuracy': 0.38417873222556925, 'macro avg': {'precision': 0.39482777980323003, 'recall': 0.3849593804056027, 'f1-score': 0.35998895521489954, 'support': 123492}, 'weighted avg': {'precision': 0.3948507856971702, 'recall': 0.38417873222556925, 'f1-score': 0.3596430923270795, 'support': 123492}}
[[ 7872  7258 26209]
 [ 7462 12116 21619]
 [ 6311  7190 27455]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0886912
{'0': {'precision': 0.3741094700260643, 'recall': 0.14266781525412497, 'f1-score': 0.20656241005468676, 'support': 15091}, '1': {'precision': 0.38239738101233944, 'recall': 0.25906337968096904, 'f1-score': 0.3088736333587592, 'support': 11723}, '2': {'precision': 0.3663215811192355, 'recall': 0.6974981046247157, 'f1-score': 0.48036074522368577, 'support': 14509}, 'accuracy': 0.3704958497688938, 'macro avg': {'precision': 0.3742761440525464, 'recall': 0.36640976651993656, 'f1-score': 0.3319322628790439, 'support': 41323}, 'weighted avg': {'precision': 0.37372626213561405, 'recall': 0.3704958497688938, 'f1-score': 0.3317211477010495, 'support': 41323}}
[[ 2153  2452 10486]
 [ 1666  3037  7020]
 [ 1936  2453 10120]]
training model: results/XRAY/W5/deepVOL_L3/h500
Epoch 1/50
483/483 - 20s - loss: 3.3130 - accuracy500: 0.3679 - val_loss: 3.5626 - val_accuracy500: 0.2902 - 20s/epoch - 42ms/step
Epoch 2/50
483/483 - 18s - loss: 3.3042 - accuracy500: 0.3513 - val_loss: 3.3198 - val_accuracy500: 0.3176 - 18s/epoch - 38ms/step
Epoch 3/50
483/483 - 18s - loss: 3.2988 - accuracy500: 0.3452 - val_loss: 3.2929 - val_accuracy500: 0.3365 - 18s/epoch - 38ms/step
Epoch 4/50
483/483 - 18s - loss: 3.2958 - accuracy500: 0.3485 - val_loss: 3.2892 - val_accuracy500: 0.3482 - 18s/epoch - 38ms/step
Epoch 5/50
483/483 - 18s - loss: 3.2923 - accuracy500: 0.3551 - val_loss: 3.2827 - val_accuracy500: 0.3552 - 18s/epoch - 38ms/step
Epoch 6/50
483/483 - 18s - loss: 3.2874 - accuracy500: 0.3614 - val_loss: 3.2818 - val_accuracy500: 0.3549 - 18s/epoch - 38ms/step
Epoch 7/50
483/483 - 18s - loss: 3.2822 - accuracy500: 0.3683 - val_loss: 3.2886 - val_accuracy500: 0.3535 - 18s/epoch - 38ms/step
Epoch 8/50
483/483 - 18s - loss: 3.2740 - accuracy500: 0.3769 - val_loss: 3.3215 - val_accuracy500: 0.3389 - 18s/epoch - 38ms/step
Epoch 9/50
483/483 - 18s - loss: 3.2653 - accuracy500: 0.3850 - val_loss: 3.3259 - val_accuracy500: 0.3287 - 18s/epoch - 37ms/step
Epoch 10/50
483/483 - 18s - loss: 3.2571 - accuracy500: 0.3902 - val_loss: 3.2982 - val_accuracy500: 0.3542 - 18s/epoch - 38ms/step
Epoch 11/50
483/483 - 18s - loss: 3.2467 - accuracy500: 0.3993 - val_loss: 3.3031 - val_accuracy500: 0.3493 - 18s/epoch - 38ms/step
Epoch 12/50
483/483 - 18s - loss: 3.2344 - accuracy500: 0.4053 - val_loss: 3.3094 - val_accuracy500: 0.3495 - 18s/epoch - 38ms/step
Epoch 13/50
483/483 - 18s - loss: 3.2253 - accuracy500: 0.4099 - val_loss: 3.3161 - val_accuracy500: 0.3495 - 18s/epoch - 37ms/step
Epoch 14/50
483/483 - 18s - loss: 3.2212 - accuracy500: 0.4131 - val_loss: 3.3127 - val_accuracy500: 0.3542 - 18s/epoch - 37ms/step
Epoch 15/50
483/483 - 18s - loss: 3.2157 - accuracy500: 0.4141 - val_loss: 3.3181 - val_accuracy500: 0.3514 - 18s/epoch - 38ms/step
Epoch 16/50
483/483 - 18s - loss: 3.1992 - accuracy500: 0.4224 - val_loss: 3.3317 - val_accuracy500: 0.3555 - 18s/epoch - 38ms/step
testing model: results/XRAY/W5/deepVOL_L3/h500
Evaluating performance on  test set...
2341/2341 - 38s - 38s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0958836
{'0': {'precision': 0.3549531061547047, 'recall': 0.18282715425519586, 'f1-score': 0.24134417370709574, 'support': 215701}, '1': {'precision': 0.2825478609272903, 'recall': 0.2659060016729402, 'f1-score': 0.2739744474556871, 'support': 153024}, '2': {'precision': 0.3888950228084958, 'recall': 0.5805307124454584, 'f1-score': 0.465771634581924, 'support': 230558}, 'accuracy': 0.35704667077157204, 'macro avg': {'precision': 0.34213199663016364, 'recall': 0.34308795612453147, 'f1-score': 0.32703008524823557, 'support': 599283}, 'weighted avg': {'precision': 0.34952301748905745, 'recall': 0.35704667077157204, 'f1-score': 0.3360185788453745, 'support': 599283}}
[[ 39436  49766 126499]
 [ 28509  40690  83825]
 [ 43157  53555 133846]]
Evaluating performance on  train set...
483/483 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0943283
{'0': {'precision': 0.3876978336513638, 'recall': 0.16394142914777987, 'f1-score': 0.23043949628888336, 'support': 42137}, '1': {'precision': 0.3749714024250744, 'recall': 0.37331072531254744, 'f1-score': 0.374139221082267, 'support': 39514}, '2': {'precision': 0.3520313559960805, 'recall': 0.5581128558112856, 'f1-score': 0.43174086673568995, 'support': 41841}, 'accuracy': 0.3644851488355521, 'macro avg': {'precision': 0.3715668640241729, 'recall': 0.3651216700905376, 'f1-score': 0.3454398613689467, 'support': 123492}, 'weighted avg': {'precision': 0.37154137578324026, 'recall': 0.3644851488355521, 'f1-score': 0.34462342372021976, 'support': 123492}}
[[ 6908 11871 23358]
 [ 5138 14751 19625]
 [ 5772 12717 23352]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.096242
{'0': {'precision': 0.3906418346929352, 'recall': 0.1670176362200579, 'f1-score': 0.23399253215322918, 'support': 15196}, '1': {'precision': 0.33086053412462907, 'recall': 0.3263040110173868, 'f1-score': 0.32856647599237304, 'support': 11618}, '2': {'precision': 0.36314618281410477, 'recall': 0.5848783513681164, 'f1-score': 0.44808194946801494, 'support': 14509}, 'accuracy': 0.35851704861699296, 'macro avg': {'precision': 0.36154951721055634, 'recall': 0.35939999953518703, 'f1-score': 0.3368803192045391, 'support': 41323}, 'weighted avg': {'precision': 0.3641802137285199, 'recall': 0.35851704861699296, 'f1-score': 0.3357514420906345, 'support': 41323}}
[[2538 3953 8705]
 [1650 3791 6177]
 [2309 3714 8486]]
training model: results/XRAY/W5/deepVOL_L3/h1000
Epoch 1/50
483/483 - 20s - loss: 3.3017 - accuracy1000: 0.3828 - val_loss: 3.3993 - val_accuracy1000: 0.2997 - 20s/epoch - 42ms/step
Epoch 2/50
483/483 - 18s - loss: 3.2996 - accuracy1000: 0.3533 - val_loss: 3.2772 - val_accuracy1000: 0.3693 - 18s/epoch - 38ms/step
Epoch 3/50
483/483 - 18s - loss: 3.2939 - accuracy1000: 0.3509 - val_loss: 3.2780 - val_accuracy1000: 0.3583 - 18s/epoch - 37ms/step
Epoch 4/50
483/483 - 18s - loss: 3.2922 - accuracy1000: 0.3497 - val_loss: 3.2782 - val_accuracy1000: 0.3527 - 18s/epoch - 38ms/step
Epoch 5/50
483/483 - 18s - loss: 3.2890 - accuracy1000: 0.3543 - val_loss: 3.2772 - val_accuracy1000: 0.3468 - 18s/epoch - 38ms/step
Epoch 6/50
483/483 - 18s - loss: 3.2845 - accuracy1000: 0.3621 - val_loss: 3.2794 - val_accuracy1000: 0.3470 - 18s/epoch - 38ms/step
Epoch 7/50
483/483 - 18s - loss: 3.2925 - accuracy1000: 0.3568 - val_loss: 3.2889 - val_accuracy1000: 0.3518 - 18s/epoch - 38ms/step
Epoch 8/50
483/483 - 18s - loss: 3.2867 - accuracy1000: 0.3544 - val_loss: 3.2772 - val_accuracy1000: 0.3512 - 18s/epoch - 38ms/step
Epoch 9/50
483/483 - 18s - loss: 3.2825 - accuracy1000: 0.3546 - val_loss: 3.2755 - val_accuracy1000: 0.3484 - 18s/epoch - 38ms/step
Epoch 10/50
483/483 - 18s - loss: 3.2755 - accuracy1000: 0.3609 - val_loss: 3.2809 - val_accuracy1000: 0.3487 - 18s/epoch - 38ms/step
Epoch 11/50
483/483 - 18s - loss: 3.2723 - accuracy1000: 0.3646 - val_loss: 3.2774 - val_accuracy1000: 0.3492 - 18s/epoch - 38ms/step
Epoch 12/50
483/483 - 18s - loss: 3.2673 - accuracy1000: 0.3735 - val_loss: 3.2799 - val_accuracy1000: 0.3474 - 18s/epoch - 37ms/step
Epoch 13/50
483/483 - 18s - loss: 3.2615 - accuracy1000: 0.3783 - val_loss: 3.2754 - val_accuracy1000: 0.3511 - 18s/epoch - 38ms/step
Epoch 14/50
483/483 - 18s - loss: 3.2562 - accuracy1000: 0.3830 - val_loss: 3.2759 - val_accuracy1000: 0.3551 - 18s/epoch - 37ms/step
Epoch 15/50
483/483 - 19s - loss: 3.2524 - accuracy1000: 0.3887 - val_loss: 3.2744 - val_accuracy1000: 0.3581 - 19s/epoch - 38ms/step
Epoch 16/50
483/483 - 18s - loss: 3.2495 - accuracy1000: 0.3929 - val_loss: 3.2779 - val_accuracy1000: 0.3573 - 18s/epoch - 37ms/step
Epoch 17/50
483/483 - 18s - loss: 3.2423 - accuracy1000: 0.4016 - val_loss: 3.2683 - val_accuracy1000: 0.3664 - 18s/epoch - 37ms/step
Epoch 18/50
483/483 - 18s - loss: 3.2438 - accuracy1000: 0.4018 - val_loss: 3.2860 - val_accuracy1000: 0.3584 - 18s/epoch - 37ms/step
Epoch 19/50
483/483 - 18s - loss: 3.2331 - accuracy1000: 0.4088 - val_loss: 3.2869 - val_accuracy1000: 0.3624 - 18s/epoch - 37ms/step
Epoch 20/50
483/483 - 18s - loss: 3.2274 - accuracy1000: 0.4123 - val_loss: 3.2961 - val_accuracy1000: 0.3606 - 18s/epoch - 37ms/step
Epoch 21/50
483/483 - 18s - loss: 3.2206 - accuracy1000: 0.4175 - val_loss: 3.2986 - val_accuracy1000: 0.3618 - 18s/epoch - 37ms/step
Epoch 22/50
483/483 - 18s - loss: 3.2016 - accuracy1000: 0.4271 - val_loss: 3.3073 - val_accuracy1000: 0.3581 - 18s/epoch - 37ms/step
Epoch 23/50
483/483 - 18s - loss: 3.1912 - accuracy1000: 0.4340 - val_loss: 3.3077 - val_accuracy1000: 0.3638 - 18s/epoch - 37ms/step
Epoch 24/50
483/483 - 18s - loss: 3.1817 - accuracy1000: 0.4375 - val_loss: 3.3143 - val_accuracy1000: 0.3602 - 18s/epoch - 37ms/step
Epoch 25/50
483/483 - 18s - loss: 3.1686 - accuracy1000: 0.4440 - val_loss: 3.3226 - val_accuracy1000: 0.3603 - 18s/epoch - 37ms/step
Epoch 26/50
483/483 - 18s - loss: 3.1676 - accuracy1000: 0.4444 - val_loss: 3.3175 - val_accuracy1000: 0.3585 - 18s/epoch - 37ms/step
Epoch 27/50
483/483 - 18s - loss: 3.1604 - accuracy1000: 0.4481 - val_loss: 3.3369 - val_accuracy1000: 0.3500 - 18s/epoch - 37ms/step
testing model: results/XRAY/W5/deepVOL_L3/h1000
Evaluating performance on  test set...
2341/2341 - 39s - 39s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0909314
{'0': {'precision': 0.34735162497248917, 'recall': 0.3469141964821336, 'f1-score': 0.3471327729244135, 'support': 218371}, '1': {'precision': 0.27980631846324816, 'recall': 0.09234698889871304, 'f1-score': 0.13886358376379404, 'support': 152685}, '2': {'precision': 0.36790459347934523, 'recall': 0.533245409175952, 'f1-score': 0.43540683550915704, 'support': 228227}, 'accuracy': 0.35301685514189457, 'macro avg': {'precision': 0.3316875123050275, 'recall': 0.3241688648522662, 'f1-score': 0.3071343973991216, 'support': 599283}, 'weighted avg': {'precision': 0.3379697256345316, 'recall': 0.35301685514189457, 'f1-score': 0.3276877750428435, 'support': 599283}}
[[ 75756  17581 125034]
 [ 54525  14100  84060]
 [ 87815  18711 121701]]
Evaluating performance on  train set...
483/483 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0939013
{'0': {'precision': 0.35130786458220087, 'recall': 0.3930665369176499, 'f1-score': 0.3710158905116194, 'support': 41105}, '1': {'precision': 0.45561809181528445, 'recall': 0.16407013088493846, 'f1-score': 0.24126106393292518, 'support': 40952}, '2': {'precision': 0.3572202568760557, 'recall': 0.5410160492337396, 'f1-score': 0.43031414064824497, 'support': 41435}, 'accuracy': 0.3667686975674538, 'macro avg': {'precision': 0.388048737757847, 'recall': 0.36605090567877596, 'f1-score': 0.3475303650309298, 'support': 123492}, 'weighted avg': {'precision': 0.38788264189850574, 'recall': 0.3667686975674538, 'f1-score': 0.34788324496664796, 'support': 123492}}
[[16157  4129 20819]
 [14715  6719 19518]
 [15119  3899 22417]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0899152
{'0': {'precision': 0.3929217775990348, 'recall': 0.3689344829756435, 'f1-score': 0.3805505063619839, 'support': 15889}, '1': {'precision': 0.2916972814107274, 'recall': 0.11163183053707001, 'f1-score': 0.16146963123644253, 'support': 10669}, '2': {'precision': 0.36082612786165497, 'recall': 0.545479173721639, 'f1-score': 0.4343418001402146, 'support': 14765}, 'accuracy': 0.3655833313167001, 'macro avg': {'precision': 0.3484817289571391, 'recall': 0.34201516241145086, 'f1-score': 0.32545397924621366, 'support': 41323}, 'weighted avg': {'precision': 0.3553190764833011, 'recall': 0.3655833313167001, 'f1-score': 0.3432070074853577, 'support': 41323}}
[[5862 1422 8605]
 [3816 1191 5662]
 [5241 1470 8054]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        12 (peak)  11.31 (ave)

============================================
