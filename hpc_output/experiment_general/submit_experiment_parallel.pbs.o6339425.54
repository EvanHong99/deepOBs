This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/PCAR_orderbooks/PCAR_orderbooks_2019-07-31.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-07-23.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-07-10.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-07-11.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-07-19.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-07-15.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-07-17.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-07-12.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-08-02.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-07-16.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-07-29.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-07-18.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-07-09.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-07-25.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-07-24.csv
training model: results/PCAR/W5/deepLOB_L1/h10
Epoch 1/50
694/694 - 27s - loss: 3.2545 - accuracy10: 0.3950 - val_loss: 3.4115 - val_accuracy10: 0.3530 - 27s/epoch - 38ms/step
Epoch 2/50
694/694 - 15s - loss: 3.1908 - accuracy10: 0.4268 - val_loss: 3.4097 - val_accuracy10: 0.3467 - 15s/epoch - 22ms/step
Epoch 3/50
694/694 - 15s - loss: 3.1595 - accuracy10: 0.4431 - val_loss: 3.3717 - val_accuracy10: 0.3491 - 15s/epoch - 21ms/step
Epoch 4/50
694/694 - 15s - loss: 3.1389 - accuracy10: 0.4518 - val_loss: 3.2645 - val_accuracy10: 0.3858 - 15s/epoch - 21ms/step
Epoch 5/50
694/694 - 16s - loss: 3.1257 - accuracy10: 0.4581 - val_loss: 3.3351 - val_accuracy10: 0.3640 - 16s/epoch - 23ms/step
Epoch 6/50
694/694 - 16s - loss: 3.1192 - accuracy10: 0.4606 - val_loss: 3.2549 - val_accuracy10: 0.3792 - 16s/epoch - 23ms/step
Epoch 7/50
694/694 - 16s - loss: 3.1129 - accuracy10: 0.4614 - val_loss: 3.2367 - val_accuracy10: 0.3901 - 16s/epoch - 23ms/step
Epoch 8/50
694/694 - 16s - loss: 3.1032 - accuracy10: 0.4658 - val_loss: 3.3244 - val_accuracy10: 0.3667 - 16s/epoch - 23ms/step
Epoch 9/50
694/694 - 16s - loss: 3.0995 - accuracy10: 0.4660 - val_loss: 3.3535 - val_accuracy10: 0.3573 - 16s/epoch - 23ms/step
Epoch 10/50
694/694 - 16s - loss: 3.0927 - accuracy10: 0.4692 - val_loss: 3.3947 - val_accuracy10: 0.3541 - 16s/epoch - 23ms/step
Epoch 11/50
694/694 - 16s - loss: 3.0880 - accuracy10: 0.4699 - val_loss: 3.4114 - val_accuracy10: 0.3537 - 16s/epoch - 23ms/step
Epoch 12/50
694/694 - 16s - loss: 3.0828 - accuracy10: 0.4711 - val_loss: 3.4607 - val_accuracy10: 0.3529 - 16s/epoch - 23ms/step
Epoch 13/50
694/694 - 17s - loss: 3.0793 - accuracy10: 0.4740 - val_loss: 3.4882 - val_accuracy10: 0.3547 - 17s/epoch - 25ms/step
Epoch 14/50
694/694 - 19s - loss: 3.0734 - accuracy10: 0.4754 - val_loss: 3.5012 - val_accuracy10: 0.3560 - 19s/epoch - 27ms/step
Epoch 15/50
694/694 - 19s - loss: 3.0700 - accuracy10: 0.4758 - val_loss: 3.5319 - val_accuracy10: 0.3554 - 19s/epoch - 27ms/step
Epoch 16/50
694/694 - 19s - loss: 3.0681 - accuracy10: 0.4768 - val_loss: 3.6122 - val_accuracy10: 0.3537 - 19s/epoch - 27ms/step
Epoch 17/50
694/694 - 19s - loss: 3.0636 - accuracy10: 0.4778 - val_loss: 3.6136 - val_accuracy10: 0.3523 - 19s/epoch - 28ms/step
testing model: results/PCAR/W5/deepLOB_L1/h10
Evaluating performance on  test set...
2900/2900 - 49s - 49s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0957626
{'0': {'precision': 0.5302649744673065, 'recall': 0.12186115496500395, 'f1-score': 0.19817854034564217, 'support': 261601}, '1': {'precision': 0.3257841068990535, 'recall': 0.7195561220248815, 'f1-score': 0.4485045960948665, 'support': 216546}, '2': {'precision': 0.44572358744042834, 'recall': 0.34407348672084054, 'f1-score': 0.38835714606112776, 'support': 264211}, 'accuracy': 0.3752960162078135, 'macro avg': {'precision': 0.4339242229355961, 'recall': 0.3951635879035753, 'f1-score': 0.3450134275005455, 'support': 742358}, 'weighted avg': {'precision': 0.44052891941544015, 'recall': 0.3752960162078135, 'f1-score': 0.33888475710758953, 'support': 742358}}
[[ 31879 164596  65126]
 [ 12807 155817  47922]
 [ 15433 157870  90908]]
Evaluating performance on  train set...
694/694 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0804008
{'0': {'precision': 0.5015972550875533, 'recall': 0.14086355556293922, 'f1-score': 0.21995667795115245, 'support': 60193}, '1': {'precision': 0.3593318546014214, 'recall': 0.6883574116790093, 'f1-score': 0.47217959241942975, 'support': 57659}, '2': {'precision': 0.4329956411838465, 'recall': 0.3641004184100418, 'f1-score': 0.39557062722173225, 'support': 59750}, 'accuracy': 0.3937117825249716, 'macro avg': {'precision': 0.4313082502909404, 'recall': 0.39777379521733014, 'f1-score': 0.36256896586410486, 'support': 177602}, 'weighted avg': {'precision': 0.4323309903080105, 'recall': 0.3937117825249716, 'f1-score': 0.36092273967480165, 'support': 177602}}
[[ 8479 36689 15025]
 [ 4506 39690 13463]
 [ 3919 34076 21755]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0814887
{'0': {'precision': 0.5079946702198535, 'recall': 0.07678751258811682, 'f1-score': 0.13340915055550698, 'support': 19860}, '1': {'precision': 0.3694238584747789, 'recall': 0.7345629129628749, 'f1-score': 0.4916092703644202, 'support': 21037}, '2': {'precision': 0.41396944184596196, 'recall': 0.3323985978968453, 'f1-score': 0.3687265657547563, 'support': 19970}, 'accuracy': 0.3879934940115333, 'macro avg': {'precision': 0.4304626568468648, 'recall': 0.3812496744826123, 'f1-score': 0.33124832889156114, 'support': 60867}, 'weighted avg': {'precision': 0.429252527888085, 'recall': 0.3879934940115333, 'f1-score': 0.33441699884684906, 'support': 60867}}
[[ 1525 13754  4581]
 [  768 15453  4816]
 [  709 12623  6638]]
training model: results/PCAR/W5/deepLOB_L1/h20
Epoch 1/50
694/694 - 21s - loss: 3.2688 - accuracy20: 0.3873 - val_loss: 3.2938 - val_accuracy20: 0.3694 - 21s/epoch - 31ms/step
Epoch 2/50
694/694 - 26s - loss: 3.2200 - accuracy20: 0.4075 - val_loss: 3.2645 - val_accuracy20: 0.3739 - 26s/epoch - 38ms/step
Epoch 3/50
694/694 - 20s - loss: 3.1993 - accuracy20: 0.4186 - val_loss: 3.2623 - val_accuracy20: 0.3846 - 20s/epoch - 29ms/step
Epoch 4/50
694/694 - 19s - loss: 3.1861 - accuracy20: 0.4255 - val_loss: 3.2212 - val_accuracy20: 0.4009 - 19s/epoch - 28ms/step
Epoch 5/50
694/694 - 20s - loss: 3.1796 - accuracy20: 0.4283 - val_loss: 3.2267 - val_accuracy20: 0.3916 - 20s/epoch - 29ms/step
Epoch 6/50
694/694 - 19s - loss: 3.1755 - accuracy20: 0.4308 - val_loss: 3.2230 - val_accuracy20: 0.3990 - 19s/epoch - 27ms/step
Epoch 7/50
694/694 - 20s - loss: 3.1677 - accuracy20: 0.4342 - val_loss: 3.2434 - val_accuracy20: 0.3894 - 20s/epoch - 28ms/step
Epoch 8/50
694/694 - 19s - loss: 3.1619 - accuracy20: 0.4367 - val_loss: 3.2571 - val_accuracy20: 0.3882 - 19s/epoch - 28ms/step
Epoch 9/50
694/694 - 19s - loss: 3.1599 - accuracy20: 0.4378 - val_loss: 3.2634 - val_accuracy20: 0.3826 - 19s/epoch - 28ms/step
Epoch 10/50
694/694 - 20s - loss: 3.1560 - accuracy20: 0.4391 - val_loss: 3.2488 - val_accuracy20: 0.3847 - 20s/epoch - 28ms/step
Epoch 11/50
694/694 - 20s - loss: 3.1523 - accuracy20: 0.4407 - val_loss: 3.2468 - val_accuracy20: 0.3913 - 20s/epoch - 28ms/step
Epoch 12/50
694/694 - 20s - loss: 3.1481 - accuracy20: 0.4433 - val_loss: 3.2330 - val_accuracy20: 0.3916 - 20s/epoch - 28ms/step
Epoch 13/50
694/694 - 20s - loss: 3.1439 - accuracy20: 0.4447 - val_loss: 3.2424 - val_accuracy20: 0.3935 - 20s/epoch - 28ms/step
Epoch 14/50
694/694 - 20s - loss: 3.1430 - accuracy20: 0.4450 - val_loss: 3.2583 - val_accuracy20: 0.3845 - 20s/epoch - 29ms/step
testing model: results/PCAR/W5/deepLOB_L1/h20
Evaluating performance on  test set...
2900/2900 - 48s - 48s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0944539
{'0': {'precision': 0.4526020271748378, 'recall': 0.2845376578228564, 'f1-score': 0.3494109009708465, 'support': 261765}, '1': {'precision': 0.30991476484984387, 'recall': 0.47598459458959025, 'f1-score': 0.3754034201264658, 'support': 216028}, '2': {'precision': 0.42637984439403914, 'recall': 0.3964696766390112, 'f1-score': 0.41088115071165415, 'support': 264565}, 'accuracy': 0.38014004025012194, 'macro avg': {'precision': 0.39629887880624026, 'recall': 0.38566397635048594, 'f1-score': 0.3785651572696555, 'support': 742358}, 'weighted avg': {'precision': 0.40173450006130795, 'recall': 0.38014004025012194, 'f1-score': 0.37888184160976585, 'support': 742358}}
[[ 74482 111269  76014]
 [ 48102 102826  65100]
 [ 41980 117693 104892]]
Evaluating performance on  train set...
694/694 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0773335
{'0': {'precision': 0.42625248872455407, 'recall': 0.3573119433232855, 'f1-score': 0.38874940939957936, 'support': 58719}, '1': {'precision': 0.36889081455805894, 'recall': 0.422475106685633, 'f1-score': 0.3938688337522553, 'support': 60458}, '2': {'precision': 0.4063577950625634, 'recall': 0.41133076593923834, 'f1-score': 0.40882915833794076, 'support': 58425}, 'accuracy': 0.3972646704429004, 'macro avg': {'precision': 0.4005003661150588, 'recall': 0.39703927198271893, 'f1-score': 0.3971491338299251, 'support': 177602}, 'weighted avg': {'precision': 0.4001811630978169, 'recall': 0.3972646704429004, 'f1-score': 0.3970976796287314, 'support': 177602}}
[[20981 21228 16510]
 [16318 25542 18598]
 [11923 22470 24032]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0736812
{'0': {'precision': 0.4192569659442724, 'recall': 0.34493122771268464, 'f1-score': 0.37847959754052546, 'support': 19630}, '1': {'precision': 0.3892473925114429, 'recall': 0.4759392632689573, 'f1-score': 0.4282500567560316, 'support': 21799}, '2': {'precision': 0.3901345291479821, 'recall': 0.3625372980759337, 'f1-score': 0.37582997786725686, 'support': 19438}, 'accuracy': 0.39747317922683884, 'macro avg': {'precision': 0.3995462958678992, 'recall': 0.3944692630191919, 'f1-score': 0.3941865440546046, 'support': 60867}, 'weighted avg': {'precision': 0.39920898234546615, 'recall': 0.39747317922683884, 'f1-score': 0.39545830411764976, 'support': 60867}}
[[ 6771  7959  4900]
 [ 5308 10375  6116]
 [ 4071  8320  7047]]
training model: results/PCAR/W5/deepLOB_L1/h30
Epoch 1/50
694/694 - 22s - loss: 3.2746 - accuracy30: 0.3832 - val_loss: 3.3606 - val_accuracy30: 0.3551 - 22s/epoch - 32ms/step
Epoch 2/50
694/694 - 21s - loss: 3.2327 - accuracy30: 0.4024 - val_loss: 3.2846 - val_accuracy30: 0.3688 - 21s/epoch - 30ms/step
Epoch 3/50
694/694 - 20s - loss: 3.2197 - accuracy30: 0.4083 - val_loss: 3.2661 - val_accuracy30: 0.3739 - 20s/epoch - 29ms/step
Epoch 4/50
694/694 - 20s - loss: 3.2110 - accuracy30: 0.4130 - val_loss: 3.2634 - val_accuracy30: 0.3768 - 20s/epoch - 29ms/step
Epoch 5/50
694/694 - 20s - loss: 3.2083 - accuracy30: 0.4151 - val_loss: 3.2580 - val_accuracy30: 0.3732 - 20s/epoch - 29ms/step
Epoch 6/50
694/694 - 20s - loss: 3.2001 - accuracy30: 0.4198 - val_loss: 3.2424 - val_accuracy30: 0.3861 - 20s/epoch - 29ms/step
Epoch 7/50
694/694 - 20s - loss: 3.1949 - accuracy30: 0.4223 - val_loss: 3.2307 - val_accuracy30: 0.3949 - 20s/epoch - 29ms/step
Epoch 8/50
694/694 - 20s - loss: 3.1931 - accuracy30: 0.4236 - val_loss: 3.2607 - val_accuracy30: 0.3794 - 20s/epoch - 29ms/step
Epoch 9/50
694/694 - 20s - loss: 3.1884 - accuracy30: 0.4261 - val_loss: 3.2606 - val_accuracy30: 0.3769 - 20s/epoch - 30ms/step
Epoch 10/50
694/694 - 19s - loss: 3.1851 - accuracy30: 0.4271 - val_loss: 3.2672 - val_accuracy30: 0.3804 - 19s/epoch - 27ms/step
Epoch 11/50
694/694 - 18s - loss: 3.1820 - accuracy30: 0.4291 - val_loss: 3.2639 - val_accuracy30: 0.3792 - 18s/epoch - 26ms/step
Epoch 12/50
694/694 - 18s - loss: 3.1780 - accuracy30: 0.4302 - val_loss: 3.2830 - val_accuracy30: 0.3765 - 18s/epoch - 26ms/step
Epoch 13/50
694/694 - 19s - loss: 3.1771 - accuracy30: 0.4310 - val_loss: 3.2953 - val_accuracy30: 0.3713 - 19s/epoch - 27ms/step
Epoch 14/50
694/694 - 18s - loss: 3.1731 - accuracy30: 0.4318 - val_loss: 3.3209 - val_accuracy30: 0.3689 - 18s/epoch - 25ms/step
Epoch 15/50
694/694 - 19s - loss: 3.1723 - accuracy30: 0.4320 - val_loss: 3.3379 - val_accuracy30: 0.3686 - 19s/epoch - 28ms/step
Epoch 16/50
694/694 - 18s - loss: 3.1704 - accuracy30: 0.4338 - val_loss: 3.3573 - val_accuracy30: 0.3628 - 18s/epoch - 26ms/step
Epoch 17/50
694/694 - 19s - loss: 3.1687 - accuracy30: 0.4353 - val_loss: 3.4010 - val_accuracy30: 0.3648 - 19s/epoch - 27ms/step
testing model: results/PCAR/W5/deepLOB_L1/h30
Evaluating performance on  test set...
2900/2900 - 47s - 47s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0930346
{'0': {'precision': 0.46380905466356737, 'recall': 0.22983915569134064, 'f1-score': 0.30736468409924994, 'support': 262179}, '1': {'precision': 0.31872637796010045, 'recall': 0.3952894359354033, 'f1-score': 0.352903024582088, 'support': 216110}, '2': {'precision': 0.4156811734748688, 'recall': 0.5421537552685094, 'f1-score': 0.47056774070555907, 'support': 264069}, 'accuracy': 0.3890993294340466, 'macro avg': {'precision': 0.3994055353661789, 'recall': 0.3890941156317511, 'f1-score': 0.3769451497956324, 'support': 742358}, 'weighted avg': {'precision': 0.40445373186782096, 'recall': 0.3890993294340466, 'f1-score': 0.3786755054505624, 'support': 742358}}
[[ 60259  95716 106204]
 [ 35641  85426  95043]
 [ 34022  86881 143166]]
Evaluating performance on  train set...
694/694 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0785774
{'0': {'precision': 0.4329367626005825, 'recall': 0.29396976502530753, 'f1-score': 0.35016969454981034, 'support': 59666}, '1': {'precision': 0.36156002898276784, 'recall': 0.3891167994575352, 'f1-score': 0.37483262026846076, 'support': 58990}, '2': {'precision': 0.4053014863726529, 'recall': 0.5060733552743188, 'f1-score': 0.45011618432567824, 'support': 58946}, 'accuracy': 0.39596963998153173, 'macro avg': {'precision': 0.39993275931866773, 'recall': 0.3963866399190539, 'f1-score': 0.39170616638131645, 'support': 177602}, 'weighted avg': {'precision': 0.4000570511747741, 'recall': 0.39596963998153173, 'f1-score': 0.3915335968396016, 'support': 177602}}
[[17540 21640 20486]
 [12751 22954 23285]
 [10223 18892 29831]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0763613
{'0': {'precision': 0.44656104038831396, 'recall': 0.24537037037037038, 'f1-score': 0.31671592348413496, 'support': 19872}, '1': {'precision': 0.37974570200573066, 'recall': 0.3984778727802311, 'f1-score': 0.38888634175416076, 'support': 21286}, '2': {'precision': 0.3906272635086194, 'recall': 0.5472626718757928, 'f1-score': 0.45586526066651173, 'support': 19709}, 'accuracy': 0.3966681453004091, 'macro avg': {'precision': 0.4056446686342214, 'recall': 0.39703697167546476, 'f1-score': 0.3871558419682692, 'support': 60867}, 'weighted avg': {'precision': 0.4050832264442462, 'recall': 0.3966681453004091, 'f1-score': 0.3870120414104864, 'support': 60867}}
[[ 4876  7524  7472]
 [ 3450  8482  9354]
 [ 2593  6330 10786]]
training model: results/PCAR/W5/deepLOB_L1/h50
Epoch 1/50
694/694 - 22s - loss: 3.2926 - accuracy50: 0.3759 - val_loss: 3.3912 - val_accuracy50: 0.3364 - 22s/epoch - 31ms/step
Epoch 2/50
694/694 - 20s - loss: 3.2484 - accuracy50: 0.3930 - val_loss: 3.3196 - val_accuracy50: 0.3514 - 20s/epoch - 29ms/step
Epoch 3/50
694/694 - 20s - loss: 3.2370 - accuracy50: 0.3987 - val_loss: 3.3069 - val_accuracy50: 0.3496 - 20s/epoch - 29ms/step
Epoch 4/50
694/694 - 20s - loss: 3.2334 - accuracy50: 0.4015 - val_loss: 3.3068 - val_accuracy50: 0.3535 - 20s/epoch - 29ms/step
Epoch 5/50
694/694 - 20s - loss: 3.2287 - accuracy50: 0.4061 - val_loss: 3.2939 - val_accuracy50: 0.3606 - 20s/epoch - 29ms/step
Epoch 6/50
694/694 - 20s - loss: 3.2218 - accuracy50: 0.4085 - val_loss: 3.2998 - val_accuracy50: 0.3565 - 20s/epoch - 29ms/step
Epoch 7/50
694/694 - 20s - loss: 3.2160 - accuracy50: 0.4117 - val_loss: 3.3103 - val_accuracy50: 0.3498 - 20s/epoch - 28ms/step
Epoch 8/50
694/694 - 20s - loss: 3.2130 - accuracy50: 0.4116 - val_loss: 3.3109 - val_accuracy50: 0.3562 - 20s/epoch - 28ms/step
Epoch 9/50
694/694 - 20s - loss: 3.2094 - accuracy50: 0.4133 - val_loss: 3.3103 - val_accuracy50: 0.3548 - 20s/epoch - 28ms/step
Epoch 10/50
694/694 - 20s - loss: 3.2070 - accuracy50: 0.4147 - val_loss: 3.2972 - val_accuracy50: 0.3699 - 20s/epoch - 28ms/step
Epoch 11/50
694/694 - 20s - loss: 3.2037 - accuracy50: 0.4173 - val_loss: 3.3171 - val_accuracy50: 0.3610 - 20s/epoch - 29ms/step
Epoch 12/50
694/694 - 20s - loss: 3.2021 - accuracy50: 0.4180 - val_loss: 3.3084 - val_accuracy50: 0.3581 - 20s/epoch - 29ms/step
Epoch 13/50
694/694 - 18s - loss: 3.1998 - accuracy50: 0.4196 - val_loss: 3.3870 - val_accuracy50: 0.3584 - 18s/epoch - 27ms/step
Epoch 14/50
694/694 - 19s - loss: 3.1961 - accuracy50: 0.4205 - val_loss: 3.3556 - val_accuracy50: 0.3686 - 19s/epoch - 27ms/step
Epoch 15/50
694/694 - 19s - loss: 3.1942 - accuracy50: 0.4228 - val_loss: 3.3866 - val_accuracy50: 0.3679 - 19s/epoch - 28ms/step
testing model: results/PCAR/W5/deepLOB_L1/h50
Evaluating performance on  test set...
2900/2900 - 47s - 47s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0963275
{'0': {'precision': 0.4395747133985712, 'recall': 0.21129319658215592, 'f1-score': 0.28540090825316433, 'support': 285092}, '1': {'precision': 0.2460817607359326, 'recall': 0.16687947107900583, 'f1-score': 0.1988854687076579, 'support': 171519}, '2': {'precision': 0.4075164721905253, 'recall': 0.6973931484844985, 'f1-score': 0.5144297601945395, 'support': 285747}, 'accuracy': 0.3881402234501413, 'macro avg': {'precision': 0.36439098210834303, 'recall': 0.3585219387152201, 'f1-score': 0.33290537905178724, 'support': 742358}, 'weighted avg': {'precision': 0.3825291046784946, 'recall': 0.3881402234501413, 'f1-score': 0.35356918512266183, 'support': 742358}}
[[ 60238  45797 179057]
 [ 32225  28623 110671]
 [ 44574  41895 199278]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.098244
{'0': {'precision': 0.39578822559026705, 'recall': 0.25847992593216057, 'f1-score': 0.3127259396543824, 'support': 59405}, '1': {'precision': 0.3628919151246437, 'recall': 0.13380822100627252, 'f1-score': 0.1955220788084878, 'support': 59944}, '2': {'precision': 0.35356417572813037, 'recall': 0.7083240348136577, 'f1-score': 0.47168430919774107, 'support': 58253}, 'accuracy': 0.36394860418238534, 'macro avg': {'precision': 0.3707481054810137, 'recall': 0.36687072725069686, 'f1-score': 0.32664410922020376, 'support': 177602}, 'weighted avg': {'precision': 0.37083572499246764, 'recall': 0.36394860418238534, 'f1-score': 0.3253053794493338, 'support': 177602}}
[[15355  7113 36937]
 [13419  8021 38504]
 [10022  6969 41262]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0993723
{'0': {'precision': 0.3850587291165098, 'recall': 0.2669566536846897, 'f1-score': 0.3153115478821913, 'support': 19771}, '1': {'precision': 0.38696109358569925, 'recall': 0.13743522711358014, 'f1-score': 0.20283165110751317, 'support': 21421}, '2': {'precision': 0.3470873786407767, 'recall': 0.6977382465057179, 'f1-score': 0.4635723572019518, 'support': 19675}, 'accuracy': 0.36062234051292164, 'macro avg': {'precision': 0.37303573378099525, 'recall': 0.3673767091013292, 'f1-score': 0.3272385187305521, 'support': 60867}, 'weighted avg': {'precision': 0.3734541523948784, 'recall': 0.36062234051292164, 'f1-score': 0.32365103487113284, 'support': 60867}}
[[ 5278  2378 12115]
 [ 4768  2944 13709]
 [ 3661  2286 13728]]
training model: results/PCAR/W5/deepLOB_L1/h100
Epoch 1/50
694/694 - 22s - loss: 3.3163 - accuracy100: 0.3616 - val_loss: 3.3839 - val_accuracy100: 0.3374 - 22s/epoch - 32ms/step
Epoch 2/50
694/694 - 19s - loss: 3.2890 - accuracy100: 0.3692 - val_loss: 3.3469 - val_accuracy100: 0.3351 - 19s/epoch - 27ms/step
Epoch 3/50
694/694 - 19s - loss: 3.2780 - accuracy100: 0.3711 - val_loss: 3.3531 - val_accuracy100: 0.3355 - 19s/epoch - 27ms/step
Epoch 4/50
694/694 - 19s - loss: 3.2727 - accuracy100: 0.3758 - val_loss: 3.3759 - val_accuracy100: 0.3372 - 19s/epoch - 27ms/step
Epoch 5/50
694/694 - 19s - loss: 3.2658 - accuracy100: 0.3797 - val_loss: 3.3677 - val_accuracy100: 0.3305 - 19s/epoch - 28ms/step
Epoch 6/50
694/694 - 18s - loss: 3.2602 - accuracy100: 0.3850 - val_loss: 3.4031 - val_accuracy100: 0.3270 - 18s/epoch - 27ms/step
Epoch 7/50
694/694 - 18s - loss: 3.2567 - accuracy100: 0.3889 - val_loss: 3.4156 - val_accuracy100: 0.3264 - 18s/epoch - 26ms/step
Epoch 8/50
694/694 - 18s - loss: 3.2522 - accuracy100: 0.3919 - val_loss: 3.4023 - val_accuracy100: 0.3272 - 18s/epoch - 26ms/step
Epoch 9/50
694/694 - 18s - loss: 3.2508 - accuracy100: 0.3932 - val_loss: 3.4304 - val_accuracy100: 0.3279 - 18s/epoch - 26ms/step
Epoch 10/50
694/694 - 19s - loss: 3.2482 - accuracy100: 0.3958 - val_loss: 3.4240 - val_accuracy100: 0.3276 - 19s/epoch - 27ms/step
Epoch 11/50
694/694 - 19s - loss: 3.2461 - accuracy100: 0.3960 - val_loss: 3.4328 - val_accuracy100: 0.3245 - 19s/epoch - 28ms/step
Epoch 12/50
694/694 - 18s - loss: 3.2447 - accuracy100: 0.3976 - val_loss: 3.4287 - val_accuracy100: 0.3237 - 18s/epoch - 27ms/step
testing model: results/PCAR/W5/deepLOB_L1/h100
Evaluating performance on  test set...
2900/2900 - 46s - 46s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1085197
{'0': {'precision': 0.35470846821793006, 'recall': 0.372820138080123, 'f1-score': 0.36353886006516883, 'support': 262746}, '1': {'precision': 0.29667974580969847, 'recall': 0.12747330276111984, 'f1-score': 0.1783259471463042, 'support': 218281}, '2': {'precision': 0.35102897896930246, 'recall': 0.5002315071690691, 'f1-score': 0.4125546952294241, 'support': 261331}, 'accuracy': 0.3455314012915601, 'macro avg': {'precision': 0.33413906433231033, 'recall': 0.33350831600343733, 'f1-score': 0.3181398341469657, 'support': 742358}, 'weighted avg': {'precision': 0.3363505705986894, 'recall': 0.3455314012915601, 'f1-score': 0.3263343002361743, 'support': 742358}}
[[ 97957  33011 131778]
 [ 80552  27825 109904]
 [ 97653  32952 130726]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.112605
{'0': {'precision': 0.3458607213978768, 'recall': 0.3809955796001847, 'f1-score': 0.3625789742181062, 'support': 60628}, '1': {'precision': 0.3191377334530926, 'recall': 0.17958102408588658, 'f1-score': 0.229833268276362, 'support': 57378}, '2': {'precision': 0.3393439282803586, 'recall': 0.4471441036311162, 'f1-score': 0.38585618719411546, 'support': 59596}, 'accuracy': 0.3381211923289152, 'macro avg': {'precision': 0.33478079437710934, 'recall': 0.33590690243906246, 'f1-score': 0.32608947656286125, 'support': 177602}, 'weighted avg': {'precision': 0.3350405369127503, 'recall': 0.3381211923289152, 'f1-score': 0.3275036128426309, 'support': 177602}}
[[23099 10917 26612]
 [21806 10304 25268]
 [21882 11066 26648]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1134138
{'0': {'precision': 0.3373992788140498, 'recall': 0.3699419143847318, 'f1-score': 0.3529220023282887, 'support': 20487}, '1': {'precision': 0.331373725254949, 'recall': 0.13741977212796658, 'f1-score': 0.19427446015333755, 'support': 20099}, '2': {'precision': 0.3322358575276863, 'recall': 0.4925792613776441, 'f1-score': 0.3968222442899702, 'support': 20281}, 'accuracy': 0.33402336241313024, 'macro avg': {'precision': 0.3336696205322283, 'recall': 0.3333136492967808, 'f1-score': 0.3146729022571988, 'support': 60867}, 'weighted avg': {'precision': 0.33368910830962045, 'recall': 0.33402336241313024, 'f1-score': 0.31516236010919657, 'support': 60867}}
[[ 7579  2805 10103]
 [ 7361  2762  9976]
 [ 7523  2768  9990]]
training model: results/PCAR/W5/deepLOB_L1/h200
Epoch 1/50
694/694 - 21s - loss: 3.3217 - accuracy200: 0.3580 - val_loss: 3.3631 - val_accuracy200: 0.3447 - 21s/epoch - 30ms/step
Epoch 2/50
694/694 - 19s - loss: 3.2975 - accuracy200: 0.3594 - val_loss: 3.3143 - val_accuracy200: 0.3291 - 19s/epoch - 27ms/step
Epoch 3/50
694/694 - 18s - loss: 3.2896 - accuracy200: 0.3615 - val_loss: 3.3062 - val_accuracy200: 0.3306 - 18s/epoch - 26ms/step
Epoch 4/50
694/694 - 18s - loss: 3.2827 - accuracy200: 0.3665 - val_loss: 3.3016 - val_accuracy200: 0.3356 - 18s/epoch - 26ms/step
Epoch 5/50
694/694 - 18s - loss: 3.2777 - accuracy200: 0.3706 - val_loss: 3.3119 - val_accuracy200: 0.3283 - 18s/epoch - 26ms/step
Epoch 6/50
694/694 - 18s - loss: 3.2720 - accuracy200: 0.3769 - val_loss: 3.3175 - val_accuracy200: 0.3366 - 18s/epoch - 26ms/step
Epoch 7/50
694/694 - 18s - loss: 3.2693 - accuracy200: 0.3802 - val_loss: 3.3469 - val_accuracy200: 0.3435 - 18s/epoch - 26ms/step
Epoch 8/50
694/694 - 19s - loss: 3.2636 - accuracy200: 0.3841 - val_loss: 3.3854 - val_accuracy200: 0.3469 - 19s/epoch - 27ms/step
Epoch 9/50
694/694 - 18s - loss: 3.2623 - accuracy200: 0.3870 - val_loss: 3.3308 - val_accuracy200: 0.3402 - 18s/epoch - 26ms/step
Epoch 10/50
694/694 - 18s - loss: 3.2606 - accuracy200: 0.3884 - val_loss: 3.3352 - val_accuracy200: 0.3418 - 18s/epoch - 26ms/step
Epoch 11/50
694/694 - 18s - loss: 3.2588 - accuracy200: 0.3915 - val_loss: 3.3749 - val_accuracy200: 0.3390 - 18s/epoch - 26ms/step
Epoch 12/50
694/694 - 18s - loss: 3.2535 - accuracy200: 0.3953 - val_loss: 3.3647 - val_accuracy200: 0.3444 - 18s/epoch - 27ms/step
Epoch 13/50
694/694 - 19s - loss: 3.2509 - accuracy200: 0.3977 - val_loss: 3.3696 - val_accuracy200: 0.3377 - 19s/epoch - 27ms/step
Epoch 14/50
694/694 - 19s - loss: 3.2471 - accuracy200: 0.3991 - val_loss: 3.3646 - val_accuracy200: 0.3415 - 19s/epoch - 27ms/step
testing model: results/PCAR/W5/deepLOB_L1/h200
Evaluating performance on  test set...
2900/2900 - 47s - 47s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1034477
{'0': {'precision': 0.3650449333746514, 'recall': 0.03578521277848027, 'f1-score': 0.0651807791399374, 'support': 263349}, '1': {'precision': 0.297267348675228, 'recall': 0.20524065193928712, 'f1-score': 0.24282735545605894, 'support': 219591}, '2': {'precision': 0.3486585087382353, 'recall': 0.7592688248309678, 'f1-score': 0.47787526884850956, 'support': 259418}, 'accuracy': 0.33873279468935474, 'macro avg': {'precision': 0.33699026359603823, 'recall': 0.3334315631829117, 'f1-score': 0.261961134481502, 'support': 742358}, 'weighted avg': {'precision': 0.3392699284470277, 'recall': 0.33873279468935474, 'f1-score': 0.26194563985545716, 'support': 742358}}
[[  9424  52644 201281]
 [  7840  45069 166682]
 [  8552  53898 196968]]
Evaluating performance on  train set...
694/694 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1014339
{'0': {'precision': 0.35706784289014915, 'recall': 0.05675747863247863, 'f1-score': 0.09794601446144095, 'support': 59904}, '1': {'precision': 0.34501415539477825, 'recall': 0.18706827446231516, 'f1-score': 0.2425985114077482, 'support': 58631}, '2': {'precision': 0.3369873064788319, 'recall': 0.7775576887263616, 'f1-score': 0.4701955906366294, 'support': 59067}, 'accuracy': 0.33950068129863403, 'macro avg': {'precision': 0.34635643492125306, 'recall': 0.34046114727371846, 'f1-score': 0.2702467055019395, 'support': 177602}, 'weighted avg': {'precision': 0.34641021068021705, 'recall': 0.33950068129863403, 'f1-score': 0.26950256373678017, 'support': 177602}}
[[ 3400 10636 45868]
 [ 3169 10968 44494]
 [ 2953 10186 45928]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1000994
{'0': {'precision': 0.3584392014519056, 'recall': 0.039752427917274694, 'f1-score': 0.07156769488608054, 'support': 19873}, '1': {'precision': 0.3566005388194955, 'recall': 0.20794058840331334, 'f1-score': 0.2626973387460533, 'support': 21006}, '2': {'precision': 0.328758564226311, 'recall': 0.7634080448268962, 'f1-score': 0.4595945905243818, 'support': 19988}, 'accuracy': 0.3354362791003335, 'macro avg': {'precision': 0.34793276816590407, 'recall': 0.3370336870491614, 'f1-score': 0.2646198747188386, 'support': 60867}, 'weighted avg': {'precision': 0.3480578860573307, 'recall': 0.3354362791003335, 'f1-score': 0.26495246641976794, 'support': 60867}}
[[  790  3870 15213]
 [  696  4368 15942]
 [  718  4011 15259]]
training model: results/PCAR/W5/deepLOB_L1/h300
Epoch 1/50
694/694 - 22s - loss: 3.3152 - accuracy300: 0.3639 - val_loss: 3.3826 - val_accuracy300: 0.3382 - 22s/epoch - 31ms/step
Epoch 2/50
694/694 - 19s - loss: 3.2911 - accuracy300: 0.3703 - val_loss: 3.3476 - val_accuracy300: 0.3393 - 19s/epoch - 27ms/step
Epoch 3/50
694/694 - 19s - loss: 3.2865 - accuracy300: 0.3706 - val_loss: 3.3284 - val_accuracy300: 0.3482 - 19s/epoch - 28ms/step
Epoch 4/50
694/694 - 19s - loss: 3.2747 - accuracy300: 0.3766 - val_loss: 3.3218 - val_accuracy300: 0.3417 - 19s/epoch - 27ms/step
Epoch 5/50
694/694 - 19s - loss: 3.2696 - accuracy300: 0.3845 - val_loss: 3.3192 - val_accuracy300: 0.3395 - 19s/epoch - 28ms/step
Epoch 6/50
694/694 - 19s - loss: 3.2605 - accuracy300: 0.3910 - val_loss: 3.3306 - val_accuracy300: 0.3307 - 19s/epoch - 27ms/step
Epoch 7/50
694/694 - 20s - loss: 3.2516 - accuracy300: 0.3986 - val_loss: 3.3613 - val_accuracy300: 0.3290 - 20s/epoch - 29ms/step
Epoch 8/50
694/694 - 19s - loss: 3.2479 - accuracy300: 0.4005 - val_loss: 3.3482 - val_accuracy300: 0.3302 - 19s/epoch - 27ms/step
Epoch 9/50
694/694 - 18s - loss: 3.2424 - accuracy300: 0.4048 - val_loss: 3.3463 - val_accuracy300: 0.3313 - 18s/epoch - 26ms/step
Epoch 10/50
694/694 - 19s - loss: 3.2349 - accuracy300: 0.4067 - val_loss: 3.3300 - val_accuracy300: 0.3370 - 19s/epoch - 27ms/step
Epoch 11/50
694/694 - 18s - loss: 3.2305 - accuracy300: 0.4119 - val_loss: 3.3345 - val_accuracy300: 0.3372 - 18s/epoch - 26ms/step
Epoch 12/50
694/694 - 18s - loss: 3.2240 - accuracy300: 0.4148 - val_loss: 3.3414 - val_accuracy300: 0.3317 - 18s/epoch - 26ms/step
Epoch 13/50
694/694 - 18s - loss: 3.2184 - accuracy300: 0.4168 - val_loss: 3.3458 - val_accuracy300: 0.3279 - 18s/epoch - 26ms/step
Epoch 14/50
694/694 - 19s - loss: 3.2141 - accuracy300: 0.4187 - val_loss: 3.3502 - val_accuracy300: 0.3294 - 19s/epoch - 27ms/step
Epoch 15/50
694/694 - 18s - loss: 3.2140 - accuracy300: 0.4192 - val_loss: 3.3387 - val_accuracy300: 0.3300 - 18s/epoch - 26ms/step
testing model: results/PCAR/W5/deepLOB_L1/h300
Evaluating performance on  test set...
2900/2900 - 43s - 43s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1133932
{'0': {'precision': 0.37173291251602725, 'recall': 0.014028466359968437, 'f1-score': 0.027036623901121562, 'support': 268668}, '1': {'precision': 0.2863779354744312, 'recall': 0.2985817462398398, 'f1-score': 0.2923525389234693, 'support': 209765}, '2': {'precision': 0.3557714964509313, 'recall': 0.6922193805058255, 'f1-score': 0.4699886807985182, 'support': 263925}, 'accuracy': 0.3355456531754221, 'macro avg': {'precision': 0.33796078148046327, 'recall': 0.33494319770187797, 'f1-score': 0.26312594787436966, 'support': 742358}, 'weighted avg': {'precision': 0.3419398699488146, 'recall': 0.3355456531754221, 'f1-score': 0.2594852733819761, 'support': 742358}}
[[  3769  78343 186556]
 [  2868  62632 144265]
 [  3502  77729 182694]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1102617
{'0': {'precision': 0.3202802452145627, 'recall': 0.04305415405314497, 'f1-score': 0.07590470401612974, 'support': 59460}, '1': {'precision': 0.3445077101469341, 'recall': 0.33369654501869145, 'f1-score': 0.33901595789975647, 'support': 59653}, '2': {'precision': 0.334969775011625, 'recall': 0.6404452119201901, 'f1-score': 0.43987388223136853, 'support': 58489}, 'accuracy': 0.3374117408587741, 'macro avg': {'precision': 0.3332525767910406, 'recall': 0.33906530366400883, 'f1-score': 0.28493151471575157, 'support': 177602}, 'weighted avg': {'precision': 0.33325541933372316, 'recall': 0.3374117408587741, 'f1-score': 0.2841431748247416, 'support': 177602}}
[[ 2560 19476 37424]
 [ 2802 19906 36945]
 [ 2631 18399 37459]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1068703
{'0': {'precision': 0.4110824742268041, 'recall': 0.016331336712230585, 'f1-score': 0.031414643754000694, 'support': 19533}, '1': {'precision': 0.37660591574544366, 'recall': 0.3450745996258612, 'f1-score': 0.3601514321769566, 'support': 21917}, '2': {'precision': 0.3212527181384189, 'recall': 0.6619457176700829, 'f1-score': 0.4325716016558409, 'support': 19417}, 'accuracy': 0.34066078499022456, 'macro avg': {'precision': 0.36964703603688887, 'recall': 0.3411172180027249, 'f1-score': 0.2747125591955994, 'support': 60867}, 'weighted avg': {'precision': 0.37001182664758786, 'recall': 0.34066078499022456, 'f1-score': 0.2777581278002976, 'support': 60867}}
[[  319  6207 13007]
 [  205  7563 14149]
 [  252  6312 12853]]
training model: results/PCAR/W5/deepLOB_L1/h500
Epoch 1/50
694/694 - 22s - loss: 3.3208 - accuracy500: 0.3659 - val_loss: 3.4131 - val_accuracy500: 0.3394 - 22s/epoch - 32ms/step
Epoch 2/50
694/694 - 18s - loss: 3.2898 - accuracy500: 0.3758 - val_loss: 3.3674 - val_accuracy500: 0.3251 - 18s/epoch - 26ms/step
Epoch 3/50
694/694 - 18s - loss: 3.2872 - accuracy500: 0.3686 - val_loss: 3.3430 - val_accuracy500: 0.3337 - 18s/epoch - 26ms/step
Epoch 4/50
694/694 - 18s - loss: 3.2737 - accuracy500: 0.3796 - val_loss: 3.3550 - val_accuracy500: 0.3381 - 18s/epoch - 26ms/step
Epoch 5/50
694/694 - 18s - loss: 3.2570 - accuracy500: 0.3934 - val_loss: 3.3432 - val_accuracy500: 0.3241 - 18s/epoch - 26ms/step
Epoch 6/50
694/694 - 19s - loss: 3.2501 - accuracy500: 0.3993 - val_loss: 3.3138 - val_accuracy500: 0.3470 - 19s/epoch - 27ms/step
Epoch 7/50
694/694 - 19s - loss: 3.2371 - accuracy500: 0.4066 - val_loss: 3.3076 - val_accuracy500: 0.3469 - 19s/epoch - 27ms/step
Epoch 8/50
694/694 - 18s - loss: 3.2302 - accuracy500: 0.4113 - val_loss: 3.3119 - val_accuracy500: 0.3442 - 18s/epoch - 26ms/step
Epoch 9/50
694/694 - 18s - loss: 3.2239 - accuracy500: 0.4143 - val_loss: 3.3111 - val_accuracy500: 0.3369 - 18s/epoch - 26ms/step
Epoch 10/50
694/694 - 18s - loss: 3.2169 - accuracy500: 0.4192 - val_loss: 3.3040 - val_accuracy500: 0.3523 - 18s/epoch - 26ms/step
Epoch 11/50
694/694 - 18s - loss: 3.2152 - accuracy500: 0.4204 - val_loss: 3.3073 - val_accuracy500: 0.3401 - 18s/epoch - 26ms/step
Epoch 12/50
694/694 - 20s - loss: 3.2065 - accuracy500: 0.4237 - val_loss: 3.3024 - val_accuracy500: 0.3514 - 20s/epoch - 29ms/step
Epoch 13/50
694/694 - 19s - loss: 3.2034 - accuracy500: 0.4270 - val_loss: 3.3132 - val_accuracy500: 0.3262 - 19s/epoch - 27ms/step
Epoch 14/50
694/694 - 18s - loss: 3.1994 - accuracy500: 0.4278 - val_loss: 3.3117 - val_accuracy500: 0.3271 - 18s/epoch - 26ms/step
Epoch 15/50
694/694 - 18s - loss: 3.1940 - accuracy500: 0.4306 - val_loss: 3.3186 - val_accuracy500: 0.3263 - 18s/epoch - 26ms/step
Epoch 16/50
694/694 - 19s - loss: 3.1902 - accuracy500: 0.4327 - val_loss: 3.3136 - val_accuracy500: 0.3281 - 19s/epoch - 27ms/step
Epoch 17/50
694/694 - 19s - loss: 3.1871 - accuracy500: 0.4342 - val_loss: 3.3178 - val_accuracy500: 0.3254 - 19s/epoch - 27ms/step
Epoch 18/50
694/694 - 20s - loss: 3.1825 - accuracy500: 0.4358 - val_loss: 3.3157 - val_accuracy500: 0.3221 - 20s/epoch - 29ms/step
Epoch 19/50
694/694 - 19s - loss: 3.1786 - accuracy500: 0.4371 - val_loss: 3.3223 - val_accuracy500: 0.3254 - 19s/epoch - 28ms/step
Epoch 20/50
694/694 - 19s - loss: 3.1720 - accuracy500: 0.4394 - val_loss: 3.3177 - val_accuracy500: 0.3272 - 19s/epoch - 28ms/step
Epoch 21/50
694/694 - 19s - loss: 3.1682 - accuracy500: 0.4416 - val_loss: 3.3706 - val_accuracy500: 0.3295 - 19s/epoch - 27ms/step
Epoch 22/50
694/694 - 19s - loss: 3.1649 - accuracy500: 0.4414 - val_loss: 3.3655 - val_accuracy500: 0.3354 - 19s/epoch - 27ms/step
testing model: results/PCAR/W5/deepLOB_L1/h500
Evaluating performance on  test set...
2900/2900 - 47s - 47s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1066344
{'0': {'precision': 0.3691432698384039, 'recall': 0.030928653820698523, 'f1-score': 0.057075259361619717, 'support': 264415}, '1': {'precision': 0.29377995454320865, 'recall': 0.43737701601780166, 'f1-score': 0.3514774666932677, 'support': 217508}, '2': {'precision': 0.349384429083203, 'recall': 0.5317603240731853, 'f1-score': 0.4216986518273791, 'support': 260435}, 'accuracy': 0.32571885801729084, 'macro avg': {'precision': 0.33743588448827183, 'recall': 0.3333553313038952, 'f1-score': 0.2767504592940888, 'support': 742358}, 'weighted avg': {'precision': 0.34013029001558515, 'recall': 0.32571885801729084, 'f1-score': 0.27125161164597866, 'support': 742358}}
[[  8178 114493 141744]
 [  6228  95133 116147]
 [  7748 114198 138489]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1060376
{'0': {'precision': 0.3339280404400833, 'recall': 0.07479561083637211, 'f1-score': 0.12221632725244527, 'support': 60057}, '1': {'precision': 0.3435823269939981, 'recall': 0.40729311320269507, 'f1-score': 0.37273483220107634, 'support': 58329}, '2': {'precision': 0.35043418767433293, 'recall': 0.5622298027560119, 'f1-score': 0.4317570240109972, 'support': 59216}, 'accuracy': 0.3465163680589183, 'macro avg': {'precision': 0.3426481850361381, 'recall': 0.34810617559835966, 'f1-score': 0.30890272782150624, 'support': 177602}, 'weighted avg': {'precision': 0.342602227076645, 'recall': 0.3465163680589183, 'f1-score': 0.3076999128787508, 'support': 177602}}
[[ 4492 23388 32177]
 [ 5037 23757 29535]
 [ 3923 22000 33293]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1012526
{'0': {'precision': 0.3418332184700207, 'recall': 0.024660667230149654, 'f1-score': 0.04600259692079392, 'support': 20113}, '1': {'precision': 0.37819725623662326, 'recall': 0.5144370734501026, 'f1-score': 0.4359202491203947, 'support': 20953}, '2': {'precision': 0.3350477114669254, 'recall': 0.5231048936922378, 'f1-score': 0.4084706995819859, 'support': 19801}, 'accuracy': 0.3554142638868352, 'macro avg': {'precision': 0.3516927287245231, 'recall': 0.3540675447908301, 'f1-score': 0.2967978485410582, 'support': 60867}, 'weighted avg': {'precision': 0.35214382781753795, 'recall': 0.3554142638868352, 'f1-score': 0.2981453913304493, 'support': 60867}}
[[  496  8779 10838]
 [  455 10779  9719]
 [  500  8943 10358]]
training model: results/PCAR/W5/deepLOB_L1/h1000
Epoch 1/50
694/694 - 21s - loss: 3.3135 - accuracy1000: 0.3717 - val_loss: 3.4650 - val_accuracy1000: 0.3289 - 21s/epoch - 31ms/step
Epoch 2/50
694/694 - 19s - loss: 3.2854 - accuracy1000: 0.3778 - val_loss: 3.4192 - val_accuracy1000: 0.3184 - 19s/epoch - 27ms/step
Epoch 3/50
694/694 - 19s - loss: 3.2861 - accuracy1000: 0.3686 - val_loss: 3.3635 - val_accuracy1000: 0.3214 - 19s/epoch - 27ms/step
Epoch 4/50
694/694 - 18s - loss: 3.2737 - accuracy1000: 0.3746 - val_loss: 3.3498 - val_accuracy1000: 0.3206 - 18s/epoch - 26ms/step
Epoch 5/50
694/694 - 19s - loss: 3.2613 - accuracy1000: 0.3873 - val_loss: 3.3756 - val_accuracy1000: 0.3214 - 19s/epoch - 27ms/step
Epoch 6/50
694/694 - 19s - loss: 3.2354 - accuracy1000: 0.4055 - val_loss: 3.3209 - val_accuracy1000: 0.3256 - 19s/epoch - 27ms/step
Epoch 7/50
694/694 - 18s - loss: 3.2362 - accuracy1000: 0.4070 - val_loss: 3.3399 - val_accuracy1000: 0.3266 - 18s/epoch - 26ms/step
Epoch 8/50
694/694 - 18s - loss: 3.2287 - accuracy1000: 0.4133 - val_loss: 3.3201 - val_accuracy1000: 0.3221 - 18s/epoch - 27ms/step
Epoch 9/50
694/694 - 18s - loss: 3.2161 - accuracy1000: 0.4173 - val_loss: 3.3244 - val_accuracy1000: 0.3242 - 18s/epoch - 27ms/step
Epoch 10/50
694/694 - 18s - loss: 3.2058 - accuracy1000: 0.4245 - val_loss: 3.3368 - val_accuracy1000: 0.3265 - 18s/epoch - 26ms/step
Epoch 11/50
694/694 - 20s - loss: 3.1962 - accuracy1000: 0.4299 - val_loss: 3.3374 - val_accuracy1000: 0.3329 - 20s/epoch - 28ms/step
Epoch 12/50
694/694 - 19s - loss: 3.1952 - accuracy1000: 0.4302 - val_loss: 3.3651 - val_accuracy1000: 0.3201 - 19s/epoch - 28ms/step
Epoch 13/50
694/694 - 19s - loss: 3.1942 - accuracy1000: 0.4293 - val_loss: 3.4193 - val_accuracy1000: 0.3209 - 19s/epoch - 27ms/step
Epoch 14/50
694/694 - 19s - loss: 3.1841 - accuracy1000: 0.4351 - val_loss: 3.3754 - val_accuracy1000: 0.3204 - 19s/epoch - 27ms/step
Epoch 15/50
694/694 - 19s - loss: 3.1703 - accuracy1000: 0.4395 - val_loss: 3.3600 - val_accuracy1000: 0.3207 - 19s/epoch - 28ms/step
Epoch 16/50
694/694 - 19s - loss: 3.1602 - accuracy1000: 0.4441 - val_loss: 3.3659 - val_accuracy1000: 0.3209 - 19s/epoch - 27ms/step
Epoch 17/50
694/694 - 20s - loss: 3.1505 - accuracy1000: 0.4490 - val_loss: 3.3705 - val_accuracy1000: 0.3200 - 20s/epoch - 28ms/step
Epoch 18/50
694/694 - 18s - loss: 3.1403 - accuracy1000: 0.4530 - val_loss: 3.3753 - val_accuracy1000: 0.3215 - 18s/epoch - 26ms/step
testing model: results/PCAR/W5/deepLOB_L1/h1000
Evaluating performance on  test set...
2900/2900 - 42s - 42s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1079175
{'0': {'precision': 0.36451169188445665, 'recall': 0.00402870260573444, 'f1-score': 0.007969325614615443, 'support': 263112}, '1': {'precision': 0.3020283762480294, 'recall': 0.06382988174880283, 'f1-score': 0.10538745603966425, 'support': 225114}, '2': {'precision': 0.34220198735320684, 'recall': 0.9316457588969512, 'f1-score': 0.5005480931959277, 'support': 254132}, 'accuracy': 0.33971480067568477, 'macro avg': {'precision': 0.33624735182856424, 'recall': 0.3331681144171628, 'f1-score': 0.20463495828340247, 'support': 742358}, 'weighted avg': {'precision': 0.33792683801595347, 'recall': 0.33971480067568477, 'f1-score': 0.2061354562085856, 'support': 742358}}
[[  1060  16799 245253]
 [   884  14369 209861]
 [   964  16407 236761]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1128278
{'0': {'precision': 0.31335471889245314, 'recall': 0.06175961666444829, 'f1-score': 0.10318276580959, 'support': 60104}, '1': {'precision': 0.34217454900048755, 'recall': 0.05909795203449205, 'f1-score': 0.10078844192960033, 'support': 59376}, '2': {'precision': 0.33120687326769604, 'recall': 0.8861188534461993, 'f1-score': 0.48218590694822183, 'support': 58122}, 'accuracy': 0.33064942962354027, 'macro avg': {'precision': 0.3289120470535456, 'recall': 0.3356588073817132, 'f1-score': 0.2287190382291374, 'support': 177602}, 'weighted avg': {'precision': 0.3288320735905563, 'recall': 0.33064942962354027, 'f1-score': 0.22641479694978714, 'support': 177602}}
[[ 3712  3383 53009]
 [ 4878  3509 50989]
 [ 3256  3363 51503]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1081027
{'0': {'precision': 0.41338582677165353, 'recall': 0.005225960581325901, 'f1-score': 0.01032143910350929, 'support': 20092}, '1': {'precision': 0.34672874295515804, 'recall': 0.06666666666666667, 'f1-score': 0.11183118627993362, 'support': 21225}, '2': {'precision': 0.32135781504280764, 'recall': 0.9292583120204604, 'f1-score': 0.4775636812912384, 'support': 19550}, 'accuracy': 0.32344291652291063, 'macro avg': {'precision': 0.3604907949232064, 'recall': 0.333716979756151, 'f1-score': 0.19990543555822712, 'support': 60867}, 'weighted avg': {'precision': 0.36058308910914255, 'recall': 0.32344291652291063, 'f1-score': 0.19579353759020504, 'support': 60867}}
[[  105  1355 18632]
 [   77  1415 19733]
 [   72  1311 18167]]
training model: results/PCAR/W5/deepOF_L1/h10
Epoch 1/50
694/694 - 20s - loss: 3.2475 - accuracy10: 0.4103 - val_loss: 3.2817 - val_accuracy10: 0.3937 - 20s/epoch - 28ms/step
Epoch 2/50
694/694 - 18s - loss: 3.2157 - accuracy10: 0.4271 - val_loss: 3.2761 - val_accuracy10: 0.3921 - 18s/epoch - 26ms/step
Epoch 3/50
694/694 - 18s - loss: 3.2051 - accuracy10: 0.4297 - val_loss: 3.2681 - val_accuracy10: 0.3947 - 18s/epoch - 26ms/step
Epoch 4/50
694/694 - 19s - loss: 3.2000 - accuracy10: 0.4304 - val_loss: 3.2672 - val_accuracy10: 0.3922 - 19s/epoch - 27ms/step
Epoch 5/50
694/694 - 18s - loss: 3.1961 - accuracy10: 0.4334 - val_loss: 3.2588 - val_accuracy10: 0.3949 - 18s/epoch - 26ms/step
Epoch 6/50
694/694 - 18s - loss: 3.1916 - accuracy10: 0.4344 - val_loss: 3.2598 - val_accuracy10: 0.3931 - 18s/epoch - 25ms/step
Epoch 7/50
694/694 - 18s - loss: 3.1876 - accuracy10: 0.4356 - val_loss: 3.2529 - val_accuracy10: 0.3972 - 18s/epoch - 25ms/step
Epoch 8/50
694/694 - 18s - loss: 3.1853 - accuracy10: 0.4366 - val_loss: 3.2512 - val_accuracy10: 0.3988 - 18s/epoch - 26ms/step
Epoch 9/50
694/694 - 18s - loss: 3.1823 - accuracy10: 0.4372 - val_loss: 3.2492 - val_accuracy10: 0.4010 - 18s/epoch - 26ms/step
Epoch 10/50
694/694 - 18s - loss: 3.1806 - accuracy10: 0.4386 - val_loss: 3.2422 - val_accuracy10: 0.4022 - 18s/epoch - 26ms/step
Epoch 11/50
694/694 - 18s - loss: 3.1784 - accuracy10: 0.4389 - val_loss: 3.2464 - val_accuracy10: 0.4003 - 18s/epoch - 26ms/step
Epoch 12/50
694/694 - 18s - loss: 3.1762 - accuracy10: 0.4399 - val_loss: 3.2494 - val_accuracy10: 0.3984 - 18s/epoch - 26ms/step
Epoch 13/50
694/694 - 18s - loss: 3.1728 - accuracy10: 0.4413 - val_loss: 3.2494 - val_accuracy10: 0.3964 - 18s/epoch - 27ms/step
Epoch 14/50
694/694 - 18s - loss: 3.1716 - accuracy10: 0.4416 - val_loss: 3.2416 - val_accuracy10: 0.4044 - 18s/epoch - 26ms/step
Epoch 15/50
694/694 - 18s - loss: 3.1687 - accuracy10: 0.4427 - val_loss: 3.2384 - val_accuracy10: 0.4089 - 18s/epoch - 27ms/step
Epoch 16/50
694/694 - 18s - loss: 3.1666 - accuracy10: 0.4424 - val_loss: 3.2430 - val_accuracy10: 0.4022 - 18s/epoch - 27ms/step
Epoch 17/50
694/694 - 18s - loss: 3.1645 - accuracy10: 0.4430 - val_loss: 3.2493 - val_accuracy10: 0.3969 - 18s/epoch - 26ms/step
Epoch 18/50
694/694 - 18s - loss: 3.1631 - accuracy10: 0.4442 - val_loss: 3.2458 - val_accuracy10: 0.4012 - 18s/epoch - 26ms/step
Epoch 19/50
694/694 - 18s - loss: 3.1612 - accuracy10: 0.4451 - val_loss: 3.2441 - val_accuracy10: 0.4007 - 18s/epoch - 26ms/step
Epoch 20/50
694/694 - 18s - loss: 3.1594 - accuracy10: 0.4452 - val_loss: 3.2434 - val_accuracy10: 0.4023 - 18s/epoch - 26ms/step
Epoch 21/50
694/694 - 18s - loss: 3.1578 - accuracy10: 0.4446 - val_loss: 3.2374 - val_accuracy10: 0.4109 - 18s/epoch - 26ms/step
Epoch 22/50
694/694 - 17s - loss: 3.1553 - accuracy10: 0.4469 - val_loss: 3.2261 - val_accuracy10: 0.4229 - 17s/epoch - 25ms/step
Epoch 23/50
694/694 - 18s - loss: 3.1524 - accuracy10: 0.4478 - val_loss: 3.2420 - val_accuracy10: 0.4031 - 18s/epoch - 26ms/step
Epoch 24/50
694/694 - 17s - loss: 3.1516 - accuracy10: 0.4478 - val_loss: 3.2345 - val_accuracy10: 0.4156 - 17s/epoch - 24ms/step
Epoch 25/50
694/694 - 17s - loss: 3.1499 - accuracy10: 0.4488 - val_loss: 3.2228 - val_accuracy10: 0.4242 - 17s/epoch - 24ms/step
Epoch 26/50
694/694 - 17s - loss: 3.1482 - accuracy10: 0.4493 - val_loss: 3.2220 - val_accuracy10: 0.4247 - 17s/epoch - 24ms/step
Epoch 27/50
694/694 - 16s - loss: 3.1469 - accuracy10: 0.4498 - val_loss: 3.2232 - val_accuracy10: 0.4252 - 16s/epoch - 24ms/step
Epoch 28/50
694/694 - 17s - loss: 3.1434 - accuracy10: 0.4500 - val_loss: 3.2347 - val_accuracy10: 0.4141 - 17s/epoch - 24ms/step
Epoch 29/50
694/694 - 17s - loss: 3.1422 - accuracy10: 0.4502 - val_loss: 3.2343 - val_accuracy10: 0.4167 - 17s/epoch - 25ms/step
Epoch 30/50
694/694 - 18s - loss: 3.1401 - accuracy10: 0.4511 - val_loss: 3.2184 - val_accuracy10: 0.4269 - 18s/epoch - 26ms/step
Epoch 31/50
694/694 - 17s - loss: 3.1386 - accuracy10: 0.4529 - val_loss: 3.2290 - val_accuracy10: 0.4202 - 17s/epoch - 25ms/step
Epoch 32/50
694/694 - 18s - loss: 3.1359 - accuracy10: 0.4539 - val_loss: 3.2320 - val_accuracy10: 0.4193 - 18s/epoch - 26ms/step
Epoch 33/50
694/694 - 18s - loss: 3.1346 - accuracy10: 0.4537 - val_loss: 3.2223 - val_accuracy10: 0.4262 - 18s/epoch - 25ms/step
Epoch 34/50
694/694 - 17s - loss: 3.1330 - accuracy10: 0.4545 - val_loss: 3.2264 - val_accuracy10: 0.4218 - 17s/epoch - 25ms/step
Epoch 35/50
694/694 - 17s - loss: 3.1317 - accuracy10: 0.4552 - val_loss: 3.2222 - val_accuracy10: 0.4238 - 17s/epoch - 25ms/step
Epoch 36/50
694/694 - 17s - loss: 3.1287 - accuracy10: 0.4555 - val_loss: 3.2256 - val_accuracy10: 0.4229 - 17s/epoch - 25ms/step
Epoch 37/50
694/694 - 18s - loss: 3.1262 - accuracy10: 0.4561 - val_loss: 3.2275 - val_accuracy10: 0.4212 - 18s/epoch - 25ms/step
Epoch 38/50
694/694 - 18s - loss: 3.1248 - accuracy10: 0.4568 - val_loss: 3.2183 - val_accuracy10: 0.4224 - 18s/epoch - 25ms/step
Epoch 39/50
694/694 - 18s - loss: 3.1235 - accuracy10: 0.4566 - val_loss: 3.2219 - val_accuracy10: 0.4237 - 18s/epoch - 26ms/step
Epoch 40/50
694/694 - 18s - loss: 3.1212 - accuracy10: 0.4580 - val_loss: 3.2200 - val_accuracy10: 0.4256 - 18s/epoch - 25ms/step
Epoch 41/50
694/694 - 17s - loss: 3.1176 - accuracy10: 0.4595 - val_loss: 3.2218 - val_accuracy10: 0.4258 - 17s/epoch - 25ms/step
Epoch 42/50
694/694 - 17s - loss: 3.1163 - accuracy10: 0.4590 - val_loss: 3.2327 - val_accuracy10: 0.4175 - 17s/epoch - 25ms/step
Epoch 43/50
694/694 - 18s - loss: 3.1156 - accuracy10: 0.4600 - val_loss: 3.2234 - val_accuracy10: 0.4249 - 18s/epoch - 26ms/step
Epoch 44/50
694/694 - 18s - loss: 3.1133 - accuracy10: 0.4622 - val_loss: 3.2252 - val_accuracy10: 0.4236 - 18s/epoch - 26ms/step
Epoch 45/50
694/694 - 17s - loss: 3.1124 - accuracy10: 0.4613 - val_loss: 3.2286 - val_accuracy10: 0.4204 - 17s/epoch - 25ms/step
Epoch 46/50
694/694 - 17s - loss: 3.1087 - accuracy10: 0.4624 - val_loss: 3.2238 - val_accuracy10: 0.4227 - 17s/epoch - 24ms/step
Epoch 47/50
694/694 - 17s - loss: 3.1069 - accuracy10: 0.4639 - val_loss: 3.2289 - val_accuracy10: 0.4210 - 17s/epoch - 25ms/step
Epoch 48/50
694/694 - 17s - loss: 3.1033 - accuracy10: 0.4644 - val_loss: 3.2269 - val_accuracy10: 0.4226 - 17s/epoch - 24ms/step
testing model: results/PCAR/W5/deepOF_L1/h10
Evaluating performance on  test set...
2900/2900 - 42s - 42s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0771064
{'0': {'precision': 0.44452681107954545, 'recall': 0.3828081696935409, 'f1-score': 0.41136540550976525, 'support': 261601}, '1': {'precision': 0.3843233131447834, 'recall': 0.38329569646675254, 'f1-score': 0.3838088169671242, 'support': 216543}, '2': {'precision': 0.4250288101650897, 'recall': 0.48438925244787273, 'f1-score': 0.45277171432715746, 'support': 264209}, 'accuracy': 0.4191038495163352, 'macro avg': {'precision': 0.41795964479647285, 'recall': 0.41683103953605544, 'f1-score': 0.4159819789346823, 'support': 742353}, 'weighted avg': {'precision': 0.42002607709329554, 'recall': 0.4191038495163352, 'f1-score': 0.418064015326854, 'support': 742353}}
[[100143  68364  93094]
 [ 53508  83000  80035]
 [ 71629  64600 127980]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0682888
{'0': {'precision': 0.4497337614422751, 'recall': 0.37481924707055597, 'f1-score': 0.40887333647604884, 'support': 60165}, '1': {'precision': 0.40776058748039357, 'recall': 0.3968463233125748, 'f1-score': 0.40222943095005764, 'support': 57647}, '2': {'precision': 0.42795879756148836, 'recall': 0.5107375815353739, 'f1-score': 0.4656982729040376, 'support': 59790}, 'accuracy': 0.42772603912118107, 'macro avg': {'precision': 0.42848438216138574, 'recall': 0.4274677173061682, 'f1-score': 0.42560034677671466, 'support': 177602}, 'weighted avg': {'precision': 0.42877930907229717, 'recall': 0.42772603912118107, 'f1-score': 0.4258470289298086, 'support': 177602}}
[[22551 17628 19986]
 [13938 22877 20832]
 [13654 15599 30537]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0719776
{'0': {'precision': 0.43108030040439055, 'recall': 0.3766404199475066, 'f1-score': 0.4020257529227951, 'support': 19812}, '1': {'precision': 0.4295874822190612, 'recall': 0.3870508378031993, 'f1-score': 0.40721134638433887, 'support': 21067}, '2': {'precision': 0.4164225260416667, 'recall': 0.5120072043225935, 'f1-score': 0.4592944978009156, 'support': 19988}, 'accuracy': 0.42469646935120836, 'macro avg': {'precision': 0.4256967695550395, 'recall': 0.4252328206910998, 'f1-score': 0.4228438657026832, 'support': 60867}, 'weighted avg': {'precision': 0.42575017415087946, 'recall': 0.42469646935120836, 'f1-score': 0.4226269419099017, 'support': 60867}}
[[ 7462  5682  6668]
 [ 5239  8154  7674]
 [ 4609  5145 10234]]
training model: results/PCAR/W5/deepOF_L1/h20
Epoch 1/50
694/694 - 19s - loss: 3.2685 - accuracy20: 0.3929 - val_loss: 3.3000 - val_accuracy20: 0.3742 - 19s/epoch - 28ms/step
Epoch 2/50
694/694 - 18s - loss: 3.2386 - accuracy20: 0.4083 - val_loss: 3.2878 - val_accuracy20: 0.3812 - 18s/epoch - 25ms/step
Epoch 3/50
694/694 - 18s - loss: 3.2309 - accuracy20: 0.4110 - val_loss: 3.2859 - val_accuracy20: 0.3804 - 18s/epoch - 26ms/step
Epoch 4/50
694/694 - 17s - loss: 3.2255 - accuracy20: 0.4125 - val_loss: 3.2802 - val_accuracy20: 0.3809 - 17s/epoch - 25ms/step
Epoch 5/50
694/694 - 18s - loss: 3.2223 - accuracy20: 0.4145 - val_loss: 3.2743 - val_accuracy20: 0.3835 - 18s/epoch - 25ms/step
Epoch 6/50
694/694 - 19s - loss: 3.2192 - accuracy20: 0.4143 - val_loss: 3.2737 - val_accuracy20: 0.3820 - 19s/epoch - 27ms/step
Epoch 7/50
694/694 - 18s - loss: 3.2170 - accuracy20: 0.4154 - val_loss: 3.2637 - val_accuracy20: 0.3847 - 18s/epoch - 26ms/step
Epoch 8/50
694/694 - 18s - loss: 3.2158 - accuracy20: 0.4153 - val_loss: 3.2642 - val_accuracy20: 0.3863 - 18s/epoch - 26ms/step
Epoch 9/50
694/694 - 17s - loss: 3.2111 - accuracy20: 0.4179 - val_loss: 3.2625 - val_accuracy20: 0.3840 - 17s/epoch - 25ms/step
Epoch 10/50
694/694 - 17s - loss: 3.2092 - accuracy20: 0.4185 - val_loss: 3.2601 - val_accuracy20: 0.3856 - 17s/epoch - 25ms/step
Epoch 11/50
694/694 - 18s - loss: 3.2080 - accuracy20: 0.4201 - val_loss: 3.2625 - val_accuracy20: 0.3853 - 18s/epoch - 25ms/step
Epoch 12/50
694/694 - 18s - loss: 3.2059 - accuracy20: 0.4209 - val_loss: 3.2602 - val_accuracy20: 0.3857 - 18s/epoch - 25ms/step
Epoch 13/50
694/694 - 17s - loss: 3.2035 - accuracy20: 0.4222 - val_loss: 3.2607 - val_accuracy20: 0.3854 - 17s/epoch - 25ms/step
Epoch 14/50
694/694 - 17s - loss: 3.2027 - accuracy20: 0.4215 - val_loss: 3.2541 - val_accuracy20: 0.3909 - 17s/epoch - 25ms/step
Epoch 15/50
694/694 - 17s - loss: 3.2000 - accuracy20: 0.4228 - val_loss: 3.2566 - val_accuracy20: 0.3893 - 17s/epoch - 24ms/step
Epoch 16/50
694/694 - 16s - loss: 3.1973 - accuracy20: 0.4241 - val_loss: 3.2574 - val_accuracy20: 0.3882 - 16s/epoch - 24ms/step
Epoch 17/50
694/694 - 17s - loss: 3.1969 - accuracy20: 0.4254 - val_loss: 3.2581 - val_accuracy20: 0.3883 - 17s/epoch - 24ms/step
Epoch 18/50
694/694 - 17s - loss: 3.1946 - accuracy20: 0.4260 - val_loss: 3.2584 - val_accuracy20: 0.3859 - 17s/epoch - 25ms/step
Epoch 19/50
694/694 - 17s - loss: 3.1929 - accuracy20: 0.4261 - val_loss: 3.2601 - val_accuracy20: 0.3858 - 17s/epoch - 25ms/step
Epoch 20/50
694/694 - 17s - loss: 3.1907 - accuracy20: 0.4265 - val_loss: 3.2575 - val_accuracy20: 0.3877 - 17s/epoch - 24ms/step
Epoch 21/50
694/694 - 16s - loss: 3.1894 - accuracy20: 0.4274 - val_loss: 3.2553 - val_accuracy20: 0.3902 - 16s/epoch - 24ms/step
Epoch 22/50
694/694 - 16s - loss: 3.1878 - accuracy20: 0.4286 - val_loss: 3.2565 - val_accuracy20: 0.3898 - 16s/epoch - 24ms/step
Epoch 23/50
694/694 - 17s - loss: 3.1859 - accuracy20: 0.4287 - val_loss: 3.2539 - val_accuracy20: 0.3933 - 17s/epoch - 24ms/step
Epoch 24/50
694/694 - 18s - loss: 3.1842 - accuracy20: 0.4295 - val_loss: 3.2567 - val_accuracy20: 0.3914 - 18s/epoch - 25ms/step
Epoch 25/50
694/694 - 17s - loss: 3.1826 - accuracy20: 0.4304 - val_loss: 3.2618 - val_accuracy20: 0.3882 - 17s/epoch - 24ms/step
Epoch 26/50
694/694 - 17s - loss: 3.1799 - accuracy20: 0.4315 - val_loss: 3.2575 - val_accuracy20: 0.3912 - 17s/epoch - 24ms/step
Epoch 27/50
694/694 - 17s - loss: 3.1786 - accuracy20: 0.4307 - val_loss: 3.2529 - val_accuracy20: 0.3959 - 17s/epoch - 25ms/step
Epoch 28/50
694/694 - 17s - loss: 3.1771 - accuracy20: 0.4328 - val_loss: 3.2546 - val_accuracy20: 0.3914 - 17s/epoch - 25ms/step
Epoch 29/50
694/694 - 17s - loss: 3.1754 - accuracy20: 0.4343 - val_loss: 3.2547 - val_accuracy20: 0.3930 - 17s/epoch - 25ms/step
Epoch 30/50
694/694 - 18s - loss: 3.1730 - accuracy20: 0.4346 - val_loss: 3.2540 - val_accuracy20: 0.3970 - 18s/epoch - 25ms/step
Epoch 31/50
694/694 - 17s - loss: 3.1716 - accuracy20: 0.4355 - val_loss: 3.2504 - val_accuracy20: 0.3988 - 17s/epoch - 25ms/step
Epoch 32/50
694/694 - 17s - loss: 3.1689 - accuracy20: 0.4350 - val_loss: 3.2577 - val_accuracy20: 0.3933 - 17s/epoch - 25ms/step
Epoch 33/50
694/694 - 17s - loss: 3.1664 - accuracy20: 0.4376 - val_loss: 3.2546 - val_accuracy20: 0.3978 - 17s/epoch - 25ms/step
Epoch 34/50
694/694 - 17s - loss: 3.1647 - accuracy20: 0.4383 - val_loss: 3.2580 - val_accuracy20: 0.3951 - 17s/epoch - 25ms/step
Epoch 35/50
694/694 - 17s - loss: 3.1641 - accuracy20: 0.4384 - val_loss: 3.2539 - val_accuracy20: 0.3947 - 17s/epoch - 25ms/step
Epoch 36/50
694/694 - 18s - loss: 3.1612 - accuracy20: 0.4396 - val_loss: 3.2581 - val_accuracy20: 0.3948 - 18s/epoch - 26ms/step
Epoch 37/50
694/694 - 18s - loss: 3.1604 - accuracy20: 0.4399 - val_loss: 3.2507 - val_accuracy20: 0.4015 - 18s/epoch - 26ms/step
Epoch 38/50
694/694 - 18s - loss: 3.1587 - accuracy20: 0.4405 - val_loss: 3.2529 - val_accuracy20: 0.3991 - 18s/epoch - 25ms/step
Epoch 39/50
694/694 - 18s - loss: 3.1559 - accuracy20: 0.4429 - val_loss: 3.2602 - val_accuracy20: 0.3963 - 18s/epoch - 26ms/step
Epoch 40/50
694/694 - 18s - loss: 3.1541 - accuracy20: 0.4417 - val_loss: 3.2607 - val_accuracy20: 0.3966 - 18s/epoch - 26ms/step
Epoch 41/50
694/694 - 18s - loss: 3.1524 - accuracy20: 0.4429 - val_loss: 3.2613 - val_accuracy20: 0.3953 - 18s/epoch - 26ms/step
testing model: results/PCAR/W5/deepOF_L1/h20
Evaluating performance on  test set...
2900/2900 - 47s - 47s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.084139
{'0': {'precision': 0.4214037631898712, 'recall': 0.486226195251466, 'f1-score': 0.45150018801126646, 'support': 261765}, '1': {'precision': 0.3831531131190441, 'recall': 0.14368707325541025, 'f1-score': 0.20899753229395665, 'support': 216025}, '2': {'precision': 0.4090061506776878, 'recall': 0.5554820590936752, 'f1-score': 0.4711215263362896, 'support': 264563}, 'accuracy': 0.4112288897599929, 'macro avg': {'precision': 0.4045210089955344, 'recall': 0.39513177586685044, 'f1-score': 0.3772064155471709, 'support': 742353}, 'weighted avg': {'precision': 0.40585449452575695, 'recall': 0.4112288897599929, 'f1-score': 0.38792456284365917, 'support': 742353}}
[[127277  25721 108767]
 [ 81402  31040 103583]
 [ 93352  24251 146960]]
Evaluating performance on  train set...
694/694 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0807092
{'0': {'precision': 0.4171894228171804, 'recall': 0.47384389861421244, 'f1-score': 0.44371553299654437, 'support': 58667}, '1': {'precision': 0.42610824873743813, 'recall': 0.13795210569777044, 'f1-score': 0.2084263845395681, 'support': 60550}, '2': {'precision': 0.39588463853773326, 'recall': 0.6195084353858011, 'f1-score': 0.4830717863105175, 'support': 58385}, 'accuracy': 0.40721388272654585, 'macro avg': {'precision': 0.41306077003078395, 'recall': 0.41043481323259473, 'f1-score': 0.3784045679488767, 'support': 177602}, 'weighted avg': {'precision': 0.4132263766764618, 'recall': 0.40721388272654585, 'f1-score': 0.37643620568416275, 'support': 177602}}
[[27799  6121 24747]
 [21749  8353 30448]
 [17086  5129 36170]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0842605
{'0': {'precision': 0.4099813230248013, 'recall': 0.4816062043981836, 'f1-score': 0.4429168035286941, 'support': 19599}, '1': {'precision': 0.44657933042212516, 'recall': 0.14068876966111798, 'f1-score': 0.21396938312933708, 'support': 21807}, '2': {'precision': 0.3861303028346355, 'recall': 0.614562458249833, 'f1-score': 0.4742738177852682, 'support': 19461}, 'accuracy': 0.40197479750932363, 'macro avg': {'precision': 0.4142303187605207, 'recall': 0.41228581076971155, 'f1-score': 0.37705333481443315, 'support': 60867}, 'weighted avg': {'precision': 0.4154675149414823, 'recall': 0.40197479750932363, 'f1-score': 0.3709169096255678, 'support': 60867}}
[[ 9439  1988  8172]
 [ 7897  3068 10842]
 [ 5687  1814 11960]]
training model: results/PCAR/W5/deepOF_L1/h30
Epoch 1/50
694/694 - 20s - loss: 3.2788 - accuracy30: 0.3856 - val_loss: 3.2989 - val_accuracy30: 0.3749 - 20s/epoch - 29ms/step
Epoch 2/50
694/694 - 18s - loss: 3.2523 - accuracy30: 0.3975 - val_loss: 3.2912 - val_accuracy30: 0.3806 - 18s/epoch - 26ms/step
Epoch 3/50
694/694 - 18s - loss: 3.2434 - accuracy30: 0.4008 - val_loss: 3.2836 - val_accuracy30: 0.3854 - 18s/epoch - 26ms/step
Epoch 4/50
694/694 - 19s - loss: 3.2392 - accuracy30: 0.4024 - val_loss: 3.2791 - val_accuracy30: 0.3846 - 19s/epoch - 27ms/step
Epoch 5/50
694/694 - 19s - loss: 3.2359 - accuracy30: 0.4032 - val_loss: 3.2742 - val_accuracy30: 0.3860 - 19s/epoch - 27ms/step
Epoch 6/50
694/694 - 19s - loss: 3.2333 - accuracy30: 0.4056 - val_loss: 3.2724 - val_accuracy30: 0.3867 - 19s/epoch - 27ms/step
Epoch 7/50
694/694 - 17s - loss: 3.2307 - accuracy30: 0.4077 - val_loss: 3.2685 - val_accuracy30: 0.3861 - 17s/epoch - 25ms/step
Epoch 8/50
694/694 - 16s - loss: 3.2290 - accuracy30: 0.4077 - val_loss: 3.2662 - val_accuracy30: 0.3888 - 16s/epoch - 24ms/step
Epoch 9/50
694/694 - 17s - loss: 3.2256 - accuracy30: 0.4092 - val_loss: 3.2656 - val_accuracy30: 0.3851 - 17s/epoch - 24ms/step
Epoch 10/50
694/694 - 17s - loss: 3.2252 - accuracy30: 0.4096 - val_loss: 3.2633 - val_accuracy30: 0.3870 - 17s/epoch - 24ms/step
Epoch 11/50
694/694 - 17s - loss: 3.2238 - accuracy30: 0.4096 - val_loss: 3.2626 - val_accuracy30: 0.3875 - 17s/epoch - 25ms/step
Epoch 12/50
694/694 - 18s - loss: 3.2219 - accuracy30: 0.4110 - val_loss: 3.2625 - val_accuracy30: 0.3864 - 18s/epoch - 25ms/step
Epoch 13/50
694/694 - 18s - loss: 3.2200 - accuracy30: 0.4124 - val_loss: 3.2584 - val_accuracy30: 0.3891 - 18s/epoch - 26ms/step
Epoch 14/50
694/694 - 18s - loss: 3.2181 - accuracy30: 0.4121 - val_loss: 3.2606 - val_accuracy30: 0.3874 - 18s/epoch - 26ms/step
Epoch 15/50
694/694 - 18s - loss: 3.2162 - accuracy30: 0.4141 - val_loss: 3.2639 - val_accuracy30: 0.3860 - 18s/epoch - 25ms/step
Epoch 16/50
694/694 - 18s - loss: 3.2144 - accuracy30: 0.4149 - val_loss: 3.2622 - val_accuracy30: 0.3878 - 18s/epoch - 26ms/step
Epoch 17/50
694/694 - 17s - loss: 3.2131 - accuracy30: 0.4150 - val_loss: 3.2646 - val_accuracy30: 0.3856 - 17s/epoch - 25ms/step
Epoch 18/50
694/694 - 17s - loss: 3.2114 - accuracy30: 0.4157 - val_loss: 3.2632 - val_accuracy30: 0.3871 - 17s/epoch - 25ms/step
Epoch 19/50
694/694 - 18s - loss: 3.2093 - accuracy30: 0.4162 - val_loss: 3.2607 - val_accuracy30: 0.3897 - 18s/epoch - 26ms/step
Epoch 20/50
694/694 - 18s - loss: 3.2083 - accuracy30: 0.4169 - val_loss: 3.2631 - val_accuracy30: 0.3879 - 18s/epoch - 25ms/step
Epoch 21/50
694/694 - 17s - loss: 3.2062 - accuracy30: 0.4180 - val_loss: 3.2613 - val_accuracy30: 0.3903 - 17s/epoch - 25ms/step
Epoch 22/50
694/694 - 17s - loss: 3.2052 - accuracy30: 0.4180 - val_loss: 3.2649 - val_accuracy30: 0.3886 - 17s/epoch - 25ms/step
Epoch 23/50
694/694 - 17s - loss: 3.2030 - accuracy30: 0.4195 - val_loss: 3.2627 - val_accuracy30: 0.3919 - 17s/epoch - 25ms/step
testing model: results/PCAR/W5/deepOF_L1/h30
Evaluating performance on  test set...
2900/2900 - 43s - 43s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0844816
{'0': {'precision': 0.4175508586354097, 'recall': 0.49022995739551983, 'f1-score': 0.4509809769593661, 'support': 262179}, '1': {'precision': 0.4019435369020692, 'recall': 0.02220196476745316, 'f1-score': 0.042079598673940115, 'support': 216107}, '2': {'precision': 0.39642973767279854, 'recall': 0.6344298984727361, 'f1-score': 0.487955623451765, 'support': 264067}, 'accuracy': 0.40527619609538856, 'macro avg': {'precision': 0.4053080444034258, 'recall': 0.38228727354523634, 'f1-score': 0.32700539969502374, 'support': 742353}, 'weighted avg': {'precision': 0.40549427298537416, 'recall': 0.40527619609538856, 'f1-score': 0.3450978375609664, 'support': 742353}}
[[128528   3578 130073]
 [ 86312   4798 124997]
 [ 92974   3561 167532]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0825703
{'0': {'precision': 0.41381188388432005, 'recall': 0.5097703752159547, 'f1-score': 0.45680617451883704, 'support': 59619}, '1': {'precision': 0.40916530278232405, 'recall': 0.021133428011090822, 'f1-score': 0.04019098757294664, 'support': 59148}, '2': {'precision': 0.38492428513496135, 'recall': 0.661460015297017, 'f1-score': 0.4866510772924508, 'support': 58835}, 'accuracy': 0.3972871927117938, 'macro avg': {'precision': 0.4026338239338685, 'recall': 0.39745460617468753, 'f1-score': 0.3278827464614115, 'support': 177602}, 'weighted avg': {'precision': 0.4026946788334795, 'recall': 0.3972871927117938, 'f1-score': 0.3279448428739797, 'support': 177602}}
[[30392   951 28276]
 [23988  1250 33910]
 [19064   854 38917]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0861577
{'0': {'precision': 0.39950970701039895, 'recall': 0.509197198004334, 'f1-score': 0.4477334160499845, 'support': 19843}, '1': {'precision': 0.44963369963369965, 'recall': 0.02306680447242319, 'f1-score': 0.043882384484761824, 'support': 21286}, '2': {'precision': 0.37979932722421994, 'recall': 0.66354240551221, 'f1-score': 0.48308804544280914, 'support': 19738}, 'accuracy': 0.3892421180606897, 'macro avg': {'precision': 0.4096475779561062, 'recall': 0.3986021359963224, 'f1-score': 0.3249012819925185, 'support': 60867}, 'weighted avg': {'precision': 0.4106470364460533, 'recall': 0.3892421180606897, 'f1-score': 0.3179661631388544, 'support': 60867}}
[[10104   314  9425]
 [ 8833   491 11962]
 [ 6354   287 13097]]
training model: results/PCAR/W5/deepOF_L1/h50
Epoch 1/50
694/694 - 20s - loss: 3.2885 - accuracy50: 0.3798 - val_loss: 3.3190 - val_accuracy50: 0.3592 - 20s/epoch - 29ms/step
Epoch 2/50
694/694 - 17s - loss: 3.2622 - accuracy50: 0.3912 - val_loss: 3.3107 - val_accuracy50: 0.3656 - 17s/epoch - 25ms/step
Epoch 3/50
694/694 - 18s - loss: 3.2551 - accuracy50: 0.3933 - val_loss: 3.3107 - val_accuracy50: 0.3674 - 18s/epoch - 25ms/step
Epoch 4/50
694/694 - 18s - loss: 3.2521 - accuracy50: 0.3934 - val_loss: 3.3000 - val_accuracy50: 0.3703 - 18s/epoch - 26ms/step
Epoch 5/50
694/694 - 18s - loss: 3.2508 - accuracy50: 0.3940 - val_loss: 3.2911 - val_accuracy50: 0.3717 - 18s/epoch - 26ms/step
Epoch 6/50
694/694 - 18s - loss: 3.2496 - accuracy50: 0.3940 - val_loss: 3.2887 - val_accuracy50: 0.3704 - 18s/epoch - 26ms/step
Epoch 7/50
694/694 - 18s - loss: 3.2480 - accuracy50: 0.3951 - val_loss: 3.2835 - val_accuracy50: 0.3726 - 18s/epoch - 26ms/step
Epoch 8/50
694/694 - 18s - loss: 3.2471 - accuracy50: 0.3957 - val_loss: 3.2827 - val_accuracy50: 0.3707 - 18s/epoch - 26ms/step
Epoch 9/50
694/694 - 18s - loss: 3.2456 - accuracy50: 0.3954 - val_loss: 3.2835 - val_accuracy50: 0.3701 - 18s/epoch - 26ms/step
Epoch 10/50
694/694 - 18s - loss: 3.2436 - accuracy50: 0.3963 - val_loss: 3.2793 - val_accuracy50: 0.3723 - 18s/epoch - 26ms/step
Epoch 11/50
694/694 - 18s - loss: 3.2426 - accuracy50: 0.3977 - val_loss: 3.2797 - val_accuracy50: 0.3711 - 18s/epoch - 26ms/step
Epoch 12/50
694/694 - 18s - loss: 3.2422 - accuracy50: 0.3972 - val_loss: 3.2800 - val_accuracy50: 0.3709 - 18s/epoch - 26ms/step
Epoch 13/50
694/694 - 18s - loss: 3.2394 - accuracy50: 0.3993 - val_loss: 3.2791 - val_accuracy50: 0.3721 - 18s/epoch - 26ms/step
Epoch 14/50
694/694 - 18s - loss: 3.2387 - accuracy50: 0.3993 - val_loss: 3.2801 - val_accuracy50: 0.3701 - 18s/epoch - 26ms/step
Epoch 15/50
694/694 - 18s - loss: 3.2364 - accuracy50: 0.4016 - val_loss: 3.2807 - val_accuracy50: 0.3706 - 18s/epoch - 26ms/step
Epoch 16/50
694/694 - 18s - loss: 3.2344 - accuracy50: 0.4021 - val_loss: 3.2799 - val_accuracy50: 0.3716 - 18s/epoch - 26ms/step
Epoch 17/50
694/694 - 18s - loss: 3.2337 - accuracy50: 0.4041 - val_loss: 3.2823 - val_accuracy50: 0.3693 - 18s/epoch - 26ms/step
Epoch 18/50
694/694 - 18s - loss: 3.2326 - accuracy50: 0.4025 - val_loss: 3.2799 - val_accuracy50: 0.3711 - 18s/epoch - 26ms/step
Epoch 19/50
694/694 - 18s - loss: 3.2309 - accuracy50: 0.4052 - val_loss: 3.2807 - val_accuracy50: 0.3715 - 18s/epoch - 26ms/step
Epoch 20/50
694/694 - 17s - loss: 3.2288 - accuracy50: 0.4055 - val_loss: 3.2821 - val_accuracy50: 0.3706 - 17s/epoch - 25ms/step
Epoch 21/50
694/694 - 17s - loss: 3.2264 - accuracy50: 0.4060 - val_loss: 3.2847 - val_accuracy50: 0.3691 - 17s/epoch - 25ms/step
Epoch 22/50
694/694 - 18s - loss: 3.2250 - accuracy50: 0.4080 - val_loss: 3.2848 - val_accuracy50: 0.3704 - 18s/epoch - 25ms/step
Epoch 23/50
694/694 - 18s - loss: 3.2227 - accuracy50: 0.4080 - val_loss: 3.2863 - val_accuracy50: 0.3702 - 18s/epoch - 26ms/step
testing model: results/PCAR/W5/deepOF_L1/h50
Evaluating performance on  test set...
2900/2900 - 45s - 45s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0806589
{'0': {'precision': 0.43922633562403013, 'recall': 0.4169917079398931, 'f1-score': 0.42782032273388126, 'support': 285092}, '1': {'precision': 0.30902972518227706, 'recall': 0.0032125282772452715, 'f1-score': 0.006358951869312575, 'support': 171516}, '2': {'precision': 0.41390053414483624, 'recall': 0.6806628287459098, 'f1-score': 0.514774599519622, 'support': 285745}, 'accuracy': 0.42288237536589734, 'macro avg': {'precision': 0.38738553165038114, 'recall': 0.36695568832101605, 'f1-score': 0.3163179580409386, 'support': 742353}, 'weighted avg': {'precision': 0.3993968704232429, 'recall': 0.42288237536589734, 'f1-score': 0.36391458157695744, 'support': 742353}}
[[118881    602 165609]
 [ 61160    551 109805]
 [ 90619    630 194496]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0910304
{'0': {'precision': 0.4072320559560534, 'recall': 0.41589729766156747, 'f1-score': 0.4115190664721817, 'support': 59356}, '1': {'precision': 0.4186046511627907, 'recall': 0.0024005601306971627, 'f1-score': 0.004773744405768274, 'support': 59986}, '2': {'precision': 0.3648350894640729, 'recall': 0.7304153793340199, 'f1-score': 0.48661227336920154, 'support': 58260}, 'accuracy': 0.3794101417776827, 'macro avg': {'precision': 0.39689059886097233, 'recall': 0.38290441237542816, 'f1-score': 0.3009683614157172, 'support': 177602}, 'weighted avg': {'precision': 0.3971654420004029, 'recall': 0.3794101417776827, 'f1-score': 0.29877205542694857, 'support': 177602}}
[[24686   108 34562]
 [20319   144 39523]
 [15614    92 42554]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0949488
{'0': {'precision': 0.39400539798285905, 'recall': 0.4212311430596335, 'f1-score': 0.4071636532674382, 'support': 19754}, '1': {'precision': 0.5, 'recall': 0.002010661180211353, 'f1-score': 0.00400521609538003, 'support': 21386}, '2': {'precision': 0.36059704503050777, 'recall': 0.7249961981041213, 'f1-score': 0.48163801377359433, 'support': 19727}, 'accuracy': 0.3723856933970789, 'macro avg': {'precision': 0.41820081433778894, 'recall': 0.3827460007813221, 'f1-score': 0.2976022943788042, 'support': 60867}, 'weighted avg': {'precision': 0.42041961225409874, 'recall': 0.3723856933970789, 'f1-score': 0.28964856910596, 'support': 60867}}
[[ 8321    21 11412]
 [ 7395    43 13948]
 [ 5403    22 14302]]
training model: results/PCAR/W5/deepOF_L1/h100
Epoch 1/50
694/694 - 20s - loss: 3.3111 - accuracy100: 0.3595 - val_loss: 3.3201 - val_accuracy100: 0.3559 - 20s/epoch - 28ms/step
Epoch 2/50
694/694 - 17s - loss: 3.2847 - accuracy100: 0.3712 - val_loss: 3.3150 - val_accuracy100: 0.3631 - 17s/epoch - 24ms/step
Epoch 3/50
694/694 - 17s - loss: 3.2766 - accuracy100: 0.3731 - val_loss: 3.3112 - val_accuracy100: 0.3613 - 17s/epoch - 25ms/step
Epoch 4/50
694/694 - 17s - loss: 3.2725 - accuracy100: 0.3771 - val_loss: 3.3082 - val_accuracy100: 0.3640 - 17s/epoch - 25ms/step
Epoch 5/50
694/694 - 18s - loss: 3.2703 - accuracy100: 0.3776 - val_loss: 3.3040 - val_accuracy100: 0.3656 - 18s/epoch - 26ms/step
Epoch 6/50
694/694 - 18s - loss: 3.2688 - accuracy100: 0.3788 - val_loss: 3.3035 - val_accuracy100: 0.3635 - 18s/epoch - 26ms/step
Epoch 7/50
694/694 - 18s - loss: 3.2671 - accuracy100: 0.3803 - val_loss: 3.3017 - val_accuracy100: 0.3648 - 18s/epoch - 26ms/step
Epoch 8/50
694/694 - 18s - loss: 3.2661 - accuracy100: 0.3795 - val_loss: 3.3011 - val_accuracy100: 0.3644 - 18s/epoch - 26ms/step
Epoch 9/50
694/694 - 18s - loss: 3.2646 - accuracy100: 0.3819 - val_loss: 3.3003 - val_accuracy100: 0.3649 - 18s/epoch - 26ms/step
Epoch 10/50
694/694 - 18s - loss: 3.2640 - accuracy100: 0.3832 - val_loss: 3.2998 - val_accuracy100: 0.3640 - 18s/epoch - 26ms/step
Epoch 11/50
694/694 - 18s - loss: 3.2631 - accuracy100: 0.3825 - val_loss: 3.2974 - val_accuracy100: 0.3666 - 18s/epoch - 26ms/step
Epoch 12/50
694/694 - 18s - loss: 3.2623 - accuracy100: 0.3830 - val_loss: 3.2968 - val_accuracy100: 0.3636 - 18s/epoch - 26ms/step
Epoch 13/50
694/694 - 18s - loss: 3.2610 - accuracy100: 0.3848 - val_loss: 3.2968 - val_accuracy100: 0.3676 - 18s/epoch - 26ms/step
Epoch 14/50
694/694 - 17s - loss: 3.2600 - accuracy100: 0.3850 - val_loss: 3.2988 - val_accuracy100: 0.3667 - 17s/epoch - 25ms/step
Epoch 15/50
694/694 - 18s - loss: 3.2586 - accuracy100: 0.3866 - val_loss: 3.2973 - val_accuracy100: 0.3671 - 18s/epoch - 26ms/step
Epoch 16/50
694/694 - 18s - loss: 3.2573 - accuracy100: 0.3875 - val_loss: 3.2997 - val_accuracy100: 0.3668 - 18s/epoch - 25ms/step
Epoch 17/50
694/694 - 18s - loss: 3.2566 - accuracy100: 0.3874 - val_loss: 3.2994 - val_accuracy100: 0.3657 - 18s/epoch - 26ms/step
Epoch 18/50
694/694 - 18s - loss: 3.2557 - accuracy100: 0.3876 - val_loss: 3.2997 - val_accuracy100: 0.3669 - 18s/epoch - 26ms/step
Epoch 19/50
694/694 - 18s - loss: 3.2542 - accuracy100: 0.3875 - val_loss: 3.2991 - val_accuracy100: 0.3684 - 18s/epoch - 25ms/step
Epoch 20/50
694/694 - 17s - loss: 3.2530 - accuracy100: 0.3886 - val_loss: 3.3008 - val_accuracy100: 0.3680 - 17s/epoch - 24ms/step
Epoch 21/50
694/694 - 17s - loss: 3.2521 - accuracy100: 0.3901 - val_loss: 3.3026 - val_accuracy100: 0.3670 - 17s/epoch - 25ms/step
Epoch 22/50
694/694 - 17s - loss: 3.2504 - accuracy100: 0.3916 - val_loss: 3.3039 - val_accuracy100: 0.3693 - 17s/epoch - 25ms/step
testing model: results/PCAR/W5/deepOF_L1/h100
Evaluating performance on  test set...
2900/2900 - 44s - 44s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0953325
{'0': {'precision': 0.39386232934247817, 'recall': 0.32478381999208356, 'f1-score': 0.35600305377905156, 'support': 262744}, '1': {'precision': 0.3857608189855747, 'recall': 0.003797874289902877, 'f1-score': 0.007521696328523017, 'support': 218280}, '2': {'precision': 0.3679704780132253, 'recall': 0.7371856931301157, 'f1-score': 0.49090360071909905, 'support': 261329}, 'accuracy': 0.37557873410628095, 'macro avg': {'precision': 0.38253120878042607, 'recall': 0.35525579580403405, 'f1-score': 0.2848094502755579, 'support': 742353}, 'weighted avg': {'precision': 0.38236552216755304, 'recall': 0.37557873410628095, 'f1-score': 0.30102505049354494, 'support': 742353}}
[[ 85335    639 176770]
 [ 63327    829 154124]
 [ 68000    681 192648]]
Evaluating performance on  train set...
694/694 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0947021
{'0': {'precision': 0.4046927968448807, 'recall': 0.3008515754970269, 'f1-score': 0.345130569517403, 'support': 60711}, '1': {'precision': 0.3949579831932773, 'recall': 0.0024612484289903646, 'f1-score': 0.0048920114493884986, 'support': 57288}, '2': {'precision': 0.3561220782366477, 'recall': 0.789356240457695, 'f1-score': 0.4908118822210052, 'support': 59603}, 'accuracy': 0.3685431470366325, 'macro avg': {'precision': 0.38525761942493525, 'recall': 0.3642230214612374, 'f1-score': 0.28027815439593223, 'support': 177602}, 'weighted avg': {'precision': 0.38525242710985763, 'recall': 0.3685431470366325, 'f1-score': 0.2842723402546266, 'support': 177602}}
[[18265    99 42347]
 [14430   141 42717]
 [12438   117 47048]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0973967
{'0': {'precision': 0.3961788259032726, 'recall': 0.3067571526218143, 'f1-score': 0.3457802482045073, 'support': 20482}, '1': {'precision': 0.4260869565217391, 'recall': 0.002440846824408468, 'f1-score': 0.004853888063397722, 'support': 20075}, '2': {'precision': 0.3557570222529125, 'recall': 0.7863613983259478, 'f1-score': 0.4898854347192615, 'support': 20310}, 'accuracy': 0.3664218706359768, 'macro avg': {'precision': 0.39267426822597473, 'recall': 0.36518646592405685, 'f1-score': 0.28017319032905547, 'support': 60867}, 'weighted avg': {'precision': 0.3925551692424696, 'recall': 0.3664218706359768, 'f1-score': 0.2814215589029463, 'support': 60867}}
[[ 6283    30 14169]
 [ 5273    49 14753]
 [ 4303    36 15971]]
training model: results/PCAR/W5/deepOF_L1/h200
Epoch 1/50
694/694 - 20s - loss: 3.3202 - accuracy200: 0.3527 - val_loss: 3.3236 - val_accuracy200: 0.3395 - 20s/epoch - 29ms/step
Epoch 2/50
694/694 - 18s - loss: 3.2976 - accuracy200: 0.3604 - val_loss: 3.3186 - val_accuracy200: 0.3402 - 18s/epoch - 26ms/step
Epoch 3/50
694/694 - 18s - loss: 3.2895 - accuracy200: 0.3623 - val_loss: 3.3143 - val_accuracy200: 0.3421 - 18s/epoch - 26ms/step
Epoch 4/50
694/694 - 18s - loss: 3.2871 - accuracy200: 0.3637 - val_loss: 3.3108 - val_accuracy200: 0.3440 - 18s/epoch - 26ms/step
Epoch 5/50
694/694 - 18s - loss: 3.2844 - accuracy200: 0.3643 - val_loss: 3.3063 - val_accuracy200: 0.3449 - 18s/epoch - 27ms/step
Epoch 6/50
694/694 - 18s - loss: 3.2824 - accuracy200: 0.3648 - val_loss: 3.3046 - val_accuracy200: 0.3464 - 18s/epoch - 26ms/step
Epoch 7/50
694/694 - 18s - loss: 3.2817 - accuracy200: 0.3658 - val_loss: 3.3041 - val_accuracy200: 0.3439 - 18s/epoch - 26ms/step
Epoch 8/50
694/694 - 18s - loss: 3.2806 - accuracy200: 0.3663 - val_loss: 3.3008 - val_accuracy200: 0.3464 - 18s/epoch - 26ms/step
Epoch 9/50
694/694 - 18s - loss: 3.2802 - accuracy200: 0.3677 - val_loss: 3.3006 - val_accuracy200: 0.3457 - 18s/epoch - 26ms/step
Epoch 10/50
694/694 - 18s - loss: 3.2794 - accuracy200: 0.3681 - val_loss: 3.2980 - val_accuracy200: 0.3492 - 18s/epoch - 26ms/step
Epoch 11/50
694/694 - 18s - loss: 3.2781 - accuracy200: 0.3684 - val_loss: 3.2988 - val_accuracy200: 0.3465 - 18s/epoch - 26ms/step
Epoch 12/50
694/694 - 18s - loss: 3.2768 - accuracy200: 0.3695 - val_loss: 3.2985 - val_accuracy200: 0.3479 - 18s/epoch - 26ms/step
Epoch 13/50
694/694 - 18s - loss: 3.2759 - accuracy200: 0.3700 - val_loss: 3.2975 - val_accuracy200: 0.3471 - 18s/epoch - 26ms/step
Epoch 14/50
694/694 - 17s - loss: 3.2753 - accuracy200: 0.3717 - val_loss: 3.2992 - val_accuracy200: 0.3466 - 17s/epoch - 25ms/step
Epoch 15/50
694/694 - 17s - loss: 3.2742 - accuracy200: 0.3718 - val_loss: 3.2985 - val_accuracy200: 0.3479 - 17s/epoch - 24ms/step
Epoch 16/50
694/694 - 17s - loss: 3.2736 - accuracy200: 0.3715 - val_loss: 3.2991 - val_accuracy200: 0.3475 - 17s/epoch - 24ms/step
Epoch 17/50
694/694 - 17s - loss: 3.2725 - accuracy200: 0.3720 - val_loss: 3.2987 - val_accuracy200: 0.3468 - 17s/epoch - 25ms/step
Epoch 18/50
694/694 - 18s - loss: 3.2713 - accuracy200: 0.3729 - val_loss: 3.2985 - val_accuracy200: 0.3484 - 18s/epoch - 26ms/step
Epoch 19/50
694/694 - 18s - loss: 3.2705 - accuracy200: 0.3743 - val_loss: 3.2994 - val_accuracy200: 0.3474 - 18s/epoch - 26ms/step
Epoch 20/50
694/694 - 18s - loss: 3.2689 - accuracy200: 0.3761 - val_loss: 3.3001 - val_accuracy200: 0.3472 - 18s/epoch - 26ms/step
Epoch 21/50
694/694 - 18s - loss: 3.2686 - accuracy200: 0.3756 - val_loss: 3.3012 - val_accuracy200: 0.3468 - 18s/epoch - 26ms/step
Epoch 22/50
694/694 - 19s - loss: 3.2664 - accuracy200: 0.3779 - val_loss: 3.3002 - val_accuracy200: 0.3485 - 19s/epoch - 27ms/step
Epoch 23/50
694/694 - 19s - loss: 3.2661 - accuracy200: 0.3772 - val_loss: 3.3001 - val_accuracy200: 0.3475 - 19s/epoch - 27ms/step
testing model: results/PCAR/W5/deepOF_L1/h200
Evaluating performance on  test set...
2900/2900 - 45s - 45s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0968996
{'0': {'precision': 0.37735253198589974, 'recall': 0.3357635961814495, 'f1-score': 0.3553453306220211, 'support': 263346}, '1': {'precision': 0.4032392026578073, 'recall': 0.008843713995564481, 'f1-score': 0.017307837990793513, 'support': 219591}, '2': {'precision': 0.3596812495652951, 'recall': 0.6977094705029759, 'f1-score': 0.4746646805597989, 'support': 259416}, 'accuracy': 0.365541730147248, 'macro avg': {'precision': 0.38009099473633406, 'recall': 0.34743892689333, 'f1-score': 0.2824392830575378, 'support': 742353}, 'weighted avg': {'precision': 0.3788346658212736, 'recall': 0.365541730147248, 'f1-score': 0.2970487485903928, 'support': 742353}}
[[ 88422   1518 173406]
 [ 68837   1942 148812]
 [ 77063   1356 180997]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0959762
{'0': {'precision': 0.3793804699132077, 'recall': 0.34900696544005877, 'f1-score': 0.3635604353537902, 'support': 59867}, '1': {'precision': 0.4201954397394137, 'recall': 0.006596890767762171, 'f1-score': 0.01298984643786188, 'support': 58664}, '2': {'precision': 0.3484914519723371, 'recall': 0.7174247938920959, 'f1-score': 0.46911079378784354, 'support': 59071}, 'accuracy': 0.3584419094379568, 'macro avg': {'precision': 0.3826891205416529, 'recall': 0.3576762166999723, 'f1-score': 0.28188702519316516, 'support': 177602}, 'weighted avg': {'precision': 0.3825883403825682, 'recall': 0.3584419094379568, 'f1-score': 0.28286929558562285, 'support': 177602}}
[[20894   247 38726]
 [17775   387 40502]
 [16405   287 42379]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0993629
{'0': {'precision': 0.3508051948051948, 'recall': 0.3402015113350126, 'f1-score': 0.34542199488491043, 'support': 19850}, '1': {'precision': 0.41914191419141916, 'recall': 0.0060372694428598595, 'f1-score': 0.011903088242185668, 'support': 21036}, '2': {'precision': 0.34402381759209955, 'recall': 0.7113257594714979, 'f1-score': 0.46375723957908477, 'support': 19981}, 'accuracy': 0.3465424614323032, 'macro avg': {'precision': 0.3713236421962378, 'recall': 0.35252151341645677, 'f1-score': 0.273694107568727, 'support': 60867}, 'weighted avg': {'precision': 0.3721966307378637, 'recall': 0.3465424614323032, 'f1-score': 0.269002141829855, 'support': 60867}}
[[ 6753   101 12996]
 [ 6804   127 14105]
 [ 5693    75 14213]]
training model: results/PCAR/W5/deepOF_L1/h300
Epoch 1/50
694/694 - 19s - loss: 3.3243 - accuracy300: 0.3528 - val_loss: 3.3309 - val_accuracy300: 0.3280 - 19s/epoch - 28ms/step
Epoch 2/50
694/694 - 17s - loss: 3.3015 - accuracy300: 0.3584 - val_loss: 3.3298 - val_accuracy300: 0.3262 - 17s/epoch - 25ms/step
Epoch 3/50
694/694 - 17s - loss: 3.2937 - accuracy300: 0.3601 - val_loss: 3.3257 - val_accuracy300: 0.3273 - 17s/epoch - 25ms/step
Epoch 4/50
694/694 - 17s - loss: 3.2907 - accuracy300: 0.3608 - val_loss: 3.3202 - val_accuracy300: 0.3257 - 17s/epoch - 25ms/step
Epoch 5/50
694/694 - 17s - loss: 3.2884 - accuracy300: 0.3603 - val_loss: 3.3149 - val_accuracy300: 0.3277 - 17s/epoch - 25ms/step
Epoch 6/50
694/694 - 17s - loss: 3.2867 - accuracy300: 0.3613 - val_loss: 3.3131 - val_accuracy300: 0.3278 - 17s/epoch - 25ms/step
Epoch 7/50
694/694 - 17s - loss: 3.2855 - accuracy300: 0.3625 - val_loss: 3.3108 - val_accuracy300: 0.3276 - 17s/epoch - 25ms/step
Epoch 8/50
694/694 - 17s - loss: 3.2843 - accuracy300: 0.3628 - val_loss: 3.3092 - val_accuracy300: 0.3283 - 17s/epoch - 25ms/step
Epoch 9/50
694/694 - 17s - loss: 3.2837 - accuracy300: 0.3641 - val_loss: 3.3086 - val_accuracy300: 0.3280 - 17s/epoch - 25ms/step
Epoch 10/50
694/694 - 17s - loss: 3.2828 - accuracy300: 0.3637 - val_loss: 3.3084 - val_accuracy300: 0.3279 - 17s/epoch - 25ms/step
Epoch 11/50
694/694 - 17s - loss: 3.2810 - accuracy300: 0.3653 - val_loss: 3.3092 - val_accuracy300: 0.3275 - 17s/epoch - 25ms/step
Epoch 12/50
694/694 - 17s - loss: 3.2801 - accuracy300: 0.3658 - val_loss: 3.3100 - val_accuracy300: 0.3275 - 17s/epoch - 25ms/step
Epoch 13/50
694/694 - 17s - loss: 3.2796 - accuracy300: 0.3668 - val_loss: 3.3098 - val_accuracy300: 0.3282 - 17s/epoch - 24ms/step
Epoch 14/50
694/694 - 17s - loss: 3.2783 - accuracy300: 0.3678 - val_loss: 3.3109 - val_accuracy300: 0.3276 - 17s/epoch - 24ms/step
Epoch 15/50
694/694 - 17s - loss: 3.2771 - accuracy300: 0.3687 - val_loss: 3.3108 - val_accuracy300: 0.3284 - 17s/epoch - 24ms/step
Epoch 16/50
694/694 - 17s - loss: 3.2763 - accuracy300: 0.3692 - val_loss: 3.3117 - val_accuracy300: 0.3280 - 17s/epoch - 25ms/step
Epoch 17/50
694/694 - 17s - loss: 3.2756 - accuracy300: 0.3718 - val_loss: 3.3127 - val_accuracy300: 0.3261 - 17s/epoch - 25ms/step
Epoch 18/50
694/694 - 18s - loss: 3.2744 - accuracy300: 0.3703 - val_loss: 3.3126 - val_accuracy300: 0.3282 - 18s/epoch - 25ms/step
Epoch 19/50
694/694 - 17s - loss: 3.2733 - accuracy300: 0.3719 - val_loss: 3.3140 - val_accuracy300: 0.3266 - 17s/epoch - 25ms/step
Epoch 20/50
694/694 - 17s - loss: 3.2724 - accuracy300: 0.3719 - val_loss: 3.3155 - val_accuracy300: 0.3271 - 17s/epoch - 25ms/step
testing model: results/PCAR/W5/deepOF_L1/h300
Evaluating performance on  test set...
2900/2900 - 46s - 46s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096073
{'0': {'precision': 0.37866246349623844, 'recall': 0.1457545484322425, 'f1-score': 0.2104881234579846, 'support': 268664}, '1': {'precision': 0.3207489257213014, 'recall': 0.00498176530879794, 'f1-score': 0.00981114715312431, 'support': 209765}, '2': {'precision': 0.3589080057450199, 'recall': 0.8644571922220033, 'f1-score': 0.5072248375675991, 'support': 263924}, 'accuracy': 0.3614924436218349, 'macro avg': {'precision': 0.3527731316541866, 'recall': 0.3383978353210146, 'f1-score': 0.2425080360595693, 'support': 742353}, 'weighted avg': {'precision': 0.355274791110066, 'recall': 0.3614924436218349, 'f1-score': 0.2592801868026156, 'support': 742353}}
[[ 39159   1157 228348]
 [ 29538   1045 179182]
 [ 34717   1056 228151]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1004955
{'0': {'precision': 0.37259171597633134, 'recall': 0.13240588096760084, 'f1-score': 0.1953804718819426, 'support': 59446}, '1': {'precision': 0.4166666666666667, 'recall': 0.004773469558663429, 'f1-score': 0.009438805080395437, 'support': 59705}, '2': {'precision': 0.33390460418632417, 'recall': 0.889976219397444, 'f1-score': 0.4856145329624167, 'support': 58451}, 'accuracy': 0.33882501323183295, 'macro avg': {'precision': 0.37438766227644066, 'recall': 0.3423851899745694, 'f1-score': 0.23014460330825157, 'support': 177602}, 'weighted avg': {'precision': 0.3746761213305997, 'recall': 0.33882501323183295, 'f1-score': 0.22839149590097627, 'support': 177602}}
[[ 7871   197 51378]
 [ 7025   285 52395]
 [ 6229   202 52020]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.104487
{'0': {'precision': 0.34373243395165826, 'recall': 0.12537160430548436, 'f1-score': 0.1837301885375197, 'support': 19510}, '1': {'precision': 0.36585365853658536, 'recall': 0.0034215328467153286, 'f1-score': 0.006779661016949152, 'support': 21920}, '2': {'precision': 0.3237963620064991, 'recall': 0.892010083860678, 'f1-score': 0.47512434402532094, 'support': 19437}, 'accuracy': 0.3262687498973171, 'macro avg': {'precision': 0.34446081816491425, 'recall': 0.3402677403376259, 'f1-score': 0.2218780645265966, 'support': 60867}, 'weighted avg': {'precision': 0.3453326411658062, 'recall': 0.3262687498973171, 'f1-score': 0.21305761780075735, 'support': 60867}}
[[ 2446    70 16994]
 [ 2631    75 19214]
 [ 2039    60 17338]]
training model: results/PCAR/W5/deepOF_L1/h500
Epoch 1/50
694/694 - 20s - loss: 3.3338 - accuracy500: 0.3454 - val_loss: 3.3344 - val_accuracy500: 0.3303 - 20s/epoch - 29ms/step
Epoch 2/50
694/694 - 17s - loss: 3.3086 - accuracy500: 0.3488 - val_loss: 3.3343 - val_accuracy500: 0.3309 - 17s/epoch - 25ms/step
Epoch 3/50
694/694 - 17s - loss: 3.3010 - accuracy500: 0.3473 - val_loss: 3.3228 - val_accuracy500: 0.3285 - 17s/epoch - 24ms/step
Epoch 4/50
694/694 - 17s - loss: 3.2973 - accuracy500: 0.3482 - val_loss: 3.3135 - val_accuracy500: 0.3301 - 17s/epoch - 24ms/step
Epoch 5/50
694/694 - 17s - loss: 3.2950 - accuracy500: 0.3493 - val_loss: 3.3088 - val_accuracy500: 0.3294 - 17s/epoch - 25ms/step
Epoch 6/50
694/694 - 18s - loss: 3.2940 - accuracy500: 0.3494 - val_loss: 3.3049 - val_accuracy500: 0.3300 - 18s/epoch - 26ms/step
Epoch 7/50
694/694 - 18s - loss: 3.2924 - accuracy500: 0.3520 - val_loss: 3.3035 - val_accuracy500: 0.3293 - 18s/epoch - 26ms/step
Epoch 8/50
694/694 - 18s - loss: 3.2911 - accuracy500: 0.3530 - val_loss: 3.3030 - val_accuracy500: 0.3298 - 18s/epoch - 25ms/step
Epoch 9/50
694/694 - 17s - loss: 3.2905 - accuracy500: 0.3534 - val_loss: 3.3018 - val_accuracy500: 0.3295 - 17s/epoch - 24ms/step
Epoch 10/50
694/694 - 17s - loss: 3.2896 - accuracy500: 0.3544 - val_loss: 3.3007 - val_accuracy500: 0.3314 - 17s/epoch - 24ms/step
Epoch 11/50
694/694 - 17s - loss: 3.2889 - accuracy500: 0.3552 - val_loss: 3.3017 - val_accuracy500: 0.3290 - 17s/epoch - 25ms/step
Epoch 12/50
694/694 - 17s - loss: 3.2876 - accuracy500: 0.3567 - val_loss: 3.3009 - val_accuracy500: 0.3296 - 17s/epoch - 25ms/step
Epoch 13/50
694/694 - 18s - loss: 3.2873 - accuracy500: 0.3576 - val_loss: 3.3015 - val_accuracy500: 0.3317 - 18s/epoch - 26ms/step
Epoch 14/50
694/694 - 18s - loss: 3.2864 - accuracy500: 0.3575 - val_loss: 3.3014 - val_accuracy500: 0.3316 - 18s/epoch - 26ms/step
Epoch 15/50
694/694 - 18s - loss: 3.2860 - accuracy500: 0.3575 - val_loss: 3.3021 - val_accuracy500: 0.3302 - 18s/epoch - 25ms/step
Epoch 16/50
694/694 - 18s - loss: 3.2848 - accuracy500: 0.3595 - val_loss: 3.3026 - val_accuracy500: 0.3308 - 18s/epoch - 25ms/step
Epoch 17/50
694/694 - 18s - loss: 3.2839 - accuracy500: 0.3596 - val_loss: 3.3031 - val_accuracy500: 0.3304 - 18s/epoch - 26ms/step
Epoch 18/50
694/694 - 18s - loss: 3.2830 - accuracy500: 0.3619 - val_loss: 3.3035 - val_accuracy500: 0.3305 - 18s/epoch - 26ms/step
Epoch 19/50
694/694 - 18s - loss: 3.2822 - accuracy500: 0.3628 - val_loss: 3.3036 - val_accuracy500: 0.3320 - 18s/epoch - 26ms/step
Epoch 20/50
694/694 - 18s - loss: 3.2815 - accuracy500: 0.3628 - val_loss: 3.3044 - val_accuracy500: 0.3307 - 18s/epoch - 26ms/step
testing model: results/PCAR/W5/deepOF_L1/h500
Evaluating performance on  test set...
2900/2900 - 45s - 45s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0993218
{'0': {'precision': 0.36762148805710626, 'recall': 0.10634580255738225, 'f1-score': 0.16496919917864478, 'support': 264411}, '1': {'precision': 0.2982237556705642, 'recall': 0.04291796163819262, 'f1-score': 0.07503717696234075, 'support': 217508}, '2': {'precision': 0.3529568426725836, 'recall': 0.8599990784613376, 'f1-score': 0.5005005608963615, 'support': 260434}, 'accuracy': 0.35215995624723007, 'macro avg': {'precision': 0.33960069546675137, 'recall': 0.3364209475523042, 'f1-score': 0.24683564567911567, 'support': 742353}, 'weighted avg': {'precision': 0.34214340117390546, 'recall': 0.35215995624723007, 'f1-score': 0.2563311797584606, 'support': 742353}}
[[ 28119  11322 224970]
 [ 22554   9335 185619]
 [ 25816  10645 223973]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0992738
{'0': {'precision': 0.3659095247184577, 'recall': 0.09573352421220847, 'f1-score': 0.15176144610106873, 'support': 60073}, '1': {'precision': 0.34616954687712614, 'recall': 0.043609434997257265, 'f1-score': 0.07746060744462206, 'support': 58336}, '2': {'precision': 0.3363488119273179, 'recall': 0.8781105874005373, 'f1-score': 0.486391645494996, 'support': 59193}, 'accuracy': 0.33937117825249713, 'macro avg': {'precision': 0.3494759611743006, 'recall': 0.33915118220333434, 'f1-score': 0.23853789968022895, 'support': 177602}, 'weighted avg': {'precision': 0.34957334258313344, 'recall': 0.33937117825249713, 'f1-score': 0.23888519284301007, 'support': 177602}}
[[ 5751  2433 51889]
 [ 5123  2544 50669]
 [ 4843  2372 51978]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1003202
{'0': {'precision': 0.34949075820445114, 'recall': 0.09206538480647886, 'f1-score': 0.14573911675645917, 'support': 20127}, '1': {'precision': 0.3481363996827914, 'recall': 0.04195536866249343, 'f1-score': 0.07488592264062433, 'support': 20927}, '2': {'precision': 0.32816771298757613, 'recall': 0.8785645788118912, 'f1-score': 0.4778467113209619, 'support': 19813}, 'accuracy': 0.3308525144988253, 'macro avg': {'precision': 0.3419316236249396, 'recall': 0.3375284440936212, 'f1-score': 0.23282391690601512, 'support': 60867}, 'weighted avg': {'precision': 0.3420841806556198, 'recall': 0.3308525144988253, 'f1-score': 0.22948405207189146, 'support': 60867}}
[[ 1853   847 17427]
 [ 1840   878 18209]
 [ 1609   797 17407]]
training model: results/PCAR/W5/deepOF_L1/h1000
Epoch 1/50
694/694 - 20s - loss: 3.3383 - accuracy1000: 0.3465 - val_loss: 3.3509 - val_accuracy1000: 0.3231 - 20s/epoch - 29ms/step
Epoch 2/50
694/694 - 17s - loss: 3.3134 - accuracy1000: 0.3469 - val_loss: 3.3405 - val_accuracy1000: 0.3219 - 17s/epoch - 25ms/step
Epoch 3/50
694/694 - 18s - loss: 3.3043 - accuracy1000: 0.3461 - val_loss: 3.3242 - val_accuracy1000: 0.3213 - 18s/epoch - 26ms/step
Epoch 4/50
694/694 - 17s - loss: 3.3003 - accuracy1000: 0.3456 - val_loss: 3.3125 - val_accuracy1000: 0.3216 - 17s/epoch - 24ms/step
Epoch 5/50
694/694 - 18s - loss: 3.2977 - accuracy1000: 0.3475 - val_loss: 3.3088 - val_accuracy1000: 0.3217 - 18s/epoch - 25ms/step
Epoch 6/50
694/694 - 17s - loss: 3.2953 - accuracy1000: 0.3497 - val_loss: 3.3060 - val_accuracy1000: 0.3224 - 17s/epoch - 24ms/step
Epoch 7/50
694/694 - 16s - loss: 3.2943 - accuracy1000: 0.3518 - val_loss: 3.3055 - val_accuracy1000: 0.3213 - 16s/epoch - 24ms/step
Epoch 8/50
694/694 - 17s - loss: 3.2925 - accuracy1000: 0.3527 - val_loss: 3.3048 - val_accuracy1000: 0.3225 - 17s/epoch - 25ms/step
Epoch 9/50
694/694 - 18s - loss: 3.2922 - accuracy1000: 0.3536 - val_loss: 3.3040 - val_accuracy1000: 0.3216 - 18s/epoch - 25ms/step
Epoch 10/50
694/694 - 17s - loss: 3.2916 - accuracy1000: 0.3541 - val_loss: 3.3034 - val_accuracy1000: 0.3222 - 17s/epoch - 25ms/step
Epoch 11/50
694/694 - 17s - loss: 3.2905 - accuracy1000: 0.3557 - val_loss: 3.3046 - val_accuracy1000: 0.3220 - 17s/epoch - 25ms/step
Epoch 12/50
694/694 - 17s - loss: 3.2896 - accuracy1000: 0.3559 - val_loss: 3.3052 - val_accuracy1000: 0.3217 - 17s/epoch - 25ms/step
Epoch 13/50
694/694 - 17s - loss: 3.2885 - accuracy1000: 0.3570 - val_loss: 3.3062 - val_accuracy1000: 0.3222 - 17s/epoch - 24ms/step
Epoch 14/50
694/694 - 17s - loss: 3.2876 - accuracy1000: 0.3579 - val_loss: 3.3063 - val_accuracy1000: 0.3213 - 17s/epoch - 25ms/step
Epoch 15/50
694/694 - 18s - loss: 3.2867 - accuracy1000: 0.3596 - val_loss: 3.3074 - val_accuracy1000: 0.3228 - 18s/epoch - 26ms/step
Epoch 16/50
694/694 - 17s - loss: 3.2858 - accuracy1000: 0.3585 - val_loss: 3.3069 - val_accuracy1000: 0.3225 - 17s/epoch - 25ms/step
Epoch 17/50
694/694 - 17s - loss: 3.2846 - accuracy1000: 0.3610 - val_loss: 3.3084 - val_accuracy1000: 0.3223 - 17s/epoch - 25ms/step
Epoch 18/50
694/694 - 17s - loss: 3.2836 - accuracy1000: 0.3616 - val_loss: 3.3106 - val_accuracy1000: 0.3225 - 17s/epoch - 25ms/step
Epoch 19/50
694/694 - 17s - loss: 3.2828 - accuracy1000: 0.3631 - val_loss: 3.3110 - val_accuracy1000: 0.3216 - 17s/epoch - 25ms/step
Epoch 20/50
694/694 - 17s - loss: 3.2818 - accuracy1000: 0.3636 - val_loss: 3.3112 - val_accuracy1000: 0.3221 - 17s/epoch - 25ms/step
testing model: results/PCAR/W5/deepOF_L1/h1000
Evaluating performance on  test set...
2900/2900 - 45s - 45s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017293
{'0': {'precision': 0.36498855835240274, 'recall': 0.01091186889034161, 'f1-score': 0.021190224892425103, 'support': 263108}, '1': {'precision': 0.30657808104387385, 'recall': 0.022752916300185683, 'f1-score': 0.04236191232357819, 'support': 225114}, '2': {'precision': 0.3432012594388253, 'recall': 0.9693543880911814, 'f1-score': 0.5069250167968055, 'support': 254131}, 'accuracy': 0.34260789678225856, 'macro avg': {'precision': 0.3382559662783673, 'recall': 0.3343397244272362, 'f1-score': 0.1901590513376029, 'support': 742353}, 'weighted avg': {'precision': 0.33981745478167763, 'recall': 0.34260789678225856, 'f1-score': 0.19389284971623358, 'support': 742353}}
[[  2871   6336 253901]
 [  2456   5122 217536]
 [  2539   5249 246343]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1016432
{'0': {'precision': 0.36209239130434784, 'recall': 0.008871357001381468, 'f1-score': 0.017318408525985735, 'support': 60081}, '1': {'precision': 0.37927350427350426, 'recall': 0.023881601076353853, 'f1-score': 0.04493386494525663, 'support': 59460}, '2': {'precision': 0.32771222721102644, 'recall': 0.9729939201873892, 'f1-score': 0.49029060912053535, 'support': 58061}, 'accuracy': 0.32908413193545116, 'macro avg': {'precision': 0.35635937426295955, 'recall': 0.3352489594217081, 'f1-score': 0.1841809608639259, 'support': 177602}, 'weighted avg': {'precision': 0.35660507849099954, 'recall': 0.32908413193545116, 'f1-score': 0.18118623646379045, 'support': 177602}}
[[  533  1175 58373]
 [  520  1420 57520]
 [  419  1149 56493]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1022416
{'0': {'precision': 0.34328358208955223, 'recall': 0.008019925280199253, 'f1-score': 0.01567367601246106, 'support': 20075}, '1': {'precision': 0.3823038397328882, 'recall': 0.021545843722068025, 'f1-score': 0.04079269650411935, 'support': 21257}, '2': {'precision': 0.3211993243243243, 'recall': 0.9733811108267213, 'f1-score': 0.4830126373277449, 'support': 19535}, 'accuracy': 0.3225721655412621, 'macro avg': {'precision': 0.34892891538225496, 'recall': 0.3343156266096629, 'f1-score': 0.1798263366147751, 'support': 60867}, 'weighted avg': {'precision': 0.3498230475023484, 'recall': 0.3225721655412621, 'f1-score': 0.17443657919292418, 'support': 60867}}
[[  161   354 19560]
 [  174   458 20625]
 [  134   386 19015]]
training model: results/PCAR/W5/deepLOB_L2/h10
Epoch 1/50
694/694 - 37s - loss: 3.2835 - accuracy10: 0.3772 - val_loss: 3.3524 - val_accuracy10: 0.3507 - 37s/epoch - 54ms/step
Epoch 2/50
694/694 - 35s - loss: 3.1877 - accuracy10: 0.4243 - val_loss: 3.2620 - val_accuracy10: 0.3870 - 35s/epoch - 50ms/step
Epoch 3/50
694/694 - 35s - loss: 3.1494 - accuracy10: 0.4426 - val_loss: 3.2223 - val_accuracy10: 0.4025 - 35s/epoch - 51ms/step
Epoch 4/50
694/694 - 35s - loss: 3.1299 - accuracy10: 0.4507 - val_loss: 3.2419 - val_accuracy10: 0.4048 - 35s/epoch - 50ms/step
Epoch 5/50
694/694 - 35s - loss: 3.1092 - accuracy10: 0.4595 - val_loss: 3.2020 - val_accuracy10: 0.4278 - 35s/epoch - 51ms/step
Epoch 6/50
694/694 - 35s - loss: 3.0922 - accuracy10: 0.4664 - val_loss: 3.1746 - val_accuracy10: 0.4360 - 35s/epoch - 51ms/step
Epoch 7/50
694/694 - 36s - loss: 3.0773 - accuracy10: 0.4711 - val_loss: 3.1423 - val_accuracy10: 0.4501 - 36s/epoch - 51ms/step
Epoch 8/50
694/694 - 36s - loss: 3.0683 - accuracy10: 0.4746 - val_loss: 3.1403 - val_accuracy10: 0.4533 - 36s/epoch - 51ms/step
Epoch 9/50
694/694 - 35s - loss: 3.0586 - accuracy10: 0.4780 - val_loss: 3.1328 - val_accuracy10: 0.4510 - 35s/epoch - 51ms/step
Epoch 10/50
694/694 - 35s - loss: 3.0510 - accuracy10: 0.4801 - val_loss: 3.1188 - val_accuracy10: 0.4561 - 35s/epoch - 51ms/step
Epoch 11/50
694/694 - 35s - loss: 3.0442 - accuracy10: 0.4832 - val_loss: 3.1262 - val_accuracy10: 0.4523 - 35s/epoch - 51ms/step
Epoch 12/50
694/694 - 35s - loss: 3.0380 - accuracy10: 0.4847 - val_loss: 3.1423 - val_accuracy10: 0.4442 - 35s/epoch - 50ms/step
Epoch 13/50
694/694 - 34s - loss: 3.0299 - accuracy10: 0.4886 - val_loss: 3.1467 - val_accuracy10: 0.4448 - 34s/epoch - 49ms/step
Epoch 14/50
694/694 - 33s - loss: 3.0234 - accuracy10: 0.4897 - val_loss: 3.1282 - val_accuracy10: 0.4490 - 33s/epoch - 48ms/step
Epoch 15/50
694/694 - 33s - loss: 3.0173 - accuracy10: 0.4917 - val_loss: 3.1718 - val_accuracy10: 0.4394 - 33s/epoch - 48ms/step
Epoch 16/50
694/694 - 34s - loss: 3.0121 - accuracy10: 0.4937 - val_loss: 3.2109 - val_accuracy10: 0.4310 - 34s/epoch - 49ms/step
Epoch 17/50
694/694 - 34s - loss: 3.0061 - accuracy10: 0.4957 - val_loss: 3.2135 - val_accuracy10: 0.4266 - 34s/epoch - 49ms/step
Epoch 18/50
694/694 - 34s - loss: 3.0008 - accuracy10: 0.4976 - val_loss: 3.2408 - val_accuracy10: 0.4220 - 34s/epoch - 49ms/step
Epoch 19/50
694/694 - 34s - loss: 2.9955 - accuracy10: 0.4994 - val_loss: 3.3173 - val_accuracy10: 0.3984 - 34s/epoch - 49ms/step
Epoch 20/50
694/694 - 34s - loss: 2.9898 - accuracy10: 0.4997 - val_loss: 3.3165 - val_accuracy10: 0.4069 - 34s/epoch - 49ms/step
testing model: results/PCAR/W5/deepLOB_L2/h10
Evaluating performance on  test set...
2900/2900 - 56s - 56s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0626861
{'0': {'precision': 0.45880410941351163, 'recall': 0.4653651935581286, 'f1-score': 0.4620613614755296, 'support': 261601}, '1': {'precision': 0.4015395583470955, 'recall': 0.20547597277252871, 'f1-score': 0.27184388908744894, 'support': 216546}, '2': {'precision': 0.43097172348821017, 'recall': 0.5973407617396702, 'f1-score': 0.5006979518286337, 'support': 264211}, 'accuracy': 0.43652658151457924, 'macro avg': {'precision': 0.43043846374960576, 'recall': 0.4227273093567758, 'f1-score': 0.4115344007972041, 'support': 742358}, 'weighted avg': {'precision': 0.43219426349962914, 'recall': 0.43652658151457924, 'f1-score': 0.42032594459854394, 'support': 742358}}
[[121740  31863 107998]
 [ 71668  44495 100383]
 [ 71934  34453 157824]]
Evaluating performance on  train set...
694/694 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0391746
{'0': {'precision': 0.46510560146923785, 'recall': 0.4543883840313658, 'f1-score': 0.459684535164161, 'support': 60193}, '1': {'precision': 0.47635135135135137, 'recall': 0.3448030663036126, 'f1-score': 0.40004024347301176, 'support': 57659}, '2': {'precision': 0.4414611990656631, 'recall': 0.5693556485355649, 'f1-score': 0.49731744755500323, 'support': 59750}, 'accuracy': 0.4574892174637673, 'macro avg': {'precision': 0.46097271729541744, 'recall': 0.4561823662901811, 'f1-score': 0.4523474087307253, 'support': 177602}, 'weighted avg': {'precision': 0.4608019655239174, 'recall': 0.4574892174637673, 'f1-score': 0.4529815492784888, 'support': 177602}}
[[27351 10876 21966]
 [16703 19881 21075]
 [14752 10979 34019]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0388075
{'0': {'precision': 0.4629496203513828, 'recall': 0.42059415911379655, 'f1-score': 0.44075666833759863, 'support': 19860}, '1': {'precision': 0.46278256816592866, 'recall': 0.47197794362314016, 'f1-score': 0.46733502776993313, 'support': 21037}, '2': {'precision': 0.4468622771304226, 'recall': 0.47816725087631445, 'f1-score': 0.4619850504366337, 'support': 19970}, 'accuracy': 0.4572428409482971, 'macro avg': {'precision': 0.4575314885492447, 'recall': 0.4569131178710837, 'f1-score': 0.45669224884805515, 'support': 60867}, 'weighted avg': {'precision': 0.45761374835263186, 'recall': 0.4572428409482971, 'f1-score': 0.4569076161072562, 'support': 60867}}
[[8353 5739 5768]
 [5056 9929 6052]
 [4634 5787 9549]]
training model: results/PCAR/W5/deepLOB_L2/h20
Epoch 1/50
694/694 - 36s - loss: 3.2990 - accuracy20: 0.3695 - val_loss: 3.3846 - val_accuracy20: 0.3536 - 36s/epoch - 52ms/step
Epoch 2/50
694/694 - 34s - loss: 3.2233 - accuracy20: 0.4059 - val_loss: 3.3928 - val_accuracy20: 0.3758 - 34s/epoch - 49ms/step
Epoch 3/50
694/694 - 34s - loss: 3.1911 - accuracy20: 0.4229 - val_loss: 3.4098 - val_accuracy20: 0.3733 - 34s/epoch - 49ms/step
Epoch 4/50
694/694 - 34s - loss: 3.1718 - accuracy20: 0.4318 - val_loss: 3.3855 - val_accuracy20: 0.3811 - 34s/epoch - 49ms/step
Epoch 5/50
694/694 - 34s - loss: 3.1602 - accuracy20: 0.4365 - val_loss: 3.3762 - val_accuracy20: 0.3674 - 34s/epoch - 50ms/step
Epoch 6/50
694/694 - 34s - loss: 3.1495 - accuracy20: 0.4404 - val_loss: 3.3710 - val_accuracy20: 0.3714 - 34s/epoch - 49ms/step
Epoch 7/50
694/694 - 34s - loss: 3.1400 - accuracy20: 0.4455 - val_loss: 3.3386 - val_accuracy20: 0.3699 - 34s/epoch - 49ms/step
Epoch 8/50
694/694 - 34s - loss: 3.1311 - accuracy20: 0.4480 - val_loss: 3.3661 - val_accuracy20: 0.3692 - 34s/epoch - 49ms/step
Epoch 9/50
694/694 - 34s - loss: 3.1235 - accuracy20: 0.4509 - val_loss: 3.3512 - val_accuracy20: 0.3716 - 34s/epoch - 50ms/step
Epoch 10/50
694/694 - 34s - loss: 3.1182 - accuracy20: 0.4526 - val_loss: 3.3583 - val_accuracy20: 0.3695 - 34s/epoch - 49ms/step
Epoch 11/50
694/694 - 34s - loss: 3.1128 - accuracy20: 0.4539 - val_loss: 3.4012 - val_accuracy20: 0.3682 - 34s/epoch - 50ms/step
Epoch 12/50
694/694 - 34s - loss: 3.1066 - accuracy20: 0.4561 - val_loss: 3.3532 - val_accuracy20: 0.3739 - 34s/epoch - 49ms/step
Epoch 13/50
694/694 - 34s - loss: 3.1016 - accuracy20: 0.4583 - val_loss: 3.3646 - val_accuracy20: 0.3755 - 34s/epoch - 48ms/step
Epoch 14/50
694/694 - 34s - loss: 3.0953 - accuracy20: 0.4605 - val_loss: 3.4059 - val_accuracy20: 0.3650 - 34s/epoch - 48ms/step
Epoch 15/50
694/694 - 34s - loss: 3.0922 - accuracy20: 0.4613 - val_loss: 3.4015 - val_accuracy20: 0.3727 - 34s/epoch - 49ms/step
Epoch 16/50
694/694 - 34s - loss: 3.0868 - accuracy20: 0.4636 - val_loss: 3.4136 - val_accuracy20: 0.3729 - 34s/epoch - 49ms/step
Epoch 17/50
694/694 - 34s - loss: 3.0838 - accuracy20: 0.4650 - val_loss: 3.3785 - val_accuracy20: 0.3762 - 34s/epoch - 48ms/step
testing model: results/PCAR/W5/deepLOB_L2/h20
Evaluating performance on  test set...
2900/2900 - 55s - 55s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1498051
{'0': {'precision': 0.5146537097022983, 'recall': 0.025492330907493362, 'f1-score': 0.048578427625568285, 'support': 261765}, '1': {'precision': 0.2938960285712861, 'recall': 0.8186161053196808, 'f1-score': 0.43251307549608614, 'support': 216028}, '2': {'precision': 0.41952235859919007, 'recall': 0.2024455237843252, 'f1-score': 0.2731022807813703, 'support': 264565}, 'accuracy': 0.319356698520121, 'macro avg': {'precision': 0.4093573656242582, 'recall': 0.34885132000383307, 'f1-score': 0.2513979279676749, 'support': 742358}, 'weighted avg': {'precision': 0.41650932889955333, 'recall': 0.319356698520121, 'f1-score': 0.24032120849455194, 'support': 742358}}
[[  6673 217002  38090]
 [  3165 176844  36019]
 [  3128 207877  53560]]
Evaluating performance on  train set...
694/694 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1015851
{'0': {'precision': 0.4324261591133291, 'recall': 0.12690951821386603, 'f1-score': 0.19622919738782388, 'support': 58719}, '1': {'precision': 0.365537664260596, 'recall': 0.6860134308114725, 'f1-score': 0.47694067996389167, 'support': 60458}, '2': {'precision': 0.40559843090436193, 'recall': 0.3256311510483526, 'f1-score': 0.3612421794153668, 'support': 58425}, 'accuracy': 0.38260830396054096, 'macro avg': {'precision': 0.4011874180927623, 'recall': 0.3795180333578971, 'f1-score': 0.34480401892236073, 'support': 177602}, 'weighted avg': {'precision': 0.4008310495851963, 'recall': 0.38260830396054096, 'f1-score': 0.34607063097834145, 'support': 177602}}
[[ 7452 36908 14359]
 [ 5461 41475 13522]
 [ 4320 35080 19025]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1101123
{'0': {'precision': 0.4859154929577465, 'recall': 0.024605196128374935, 'f1-score': 0.04683863460046547, 'support': 19630}, '1': {'precision': 0.3682038939270211, 'recall': 0.785999357768705, 'f1-score': 0.5014853730993809, 'support': 21799}, '2': {'precision': 0.36981782742334507, 'recall': 0.2537812532153514, 'f1-score': 0.30100375263141843, 'support': 19438}, 'accuracy': 0.37047989879573495, 'macro avg': {'precision': 0.40797907143603757, 'recall': 0.3547952690374771, 'f1-score': 0.2831092534437549, 'support': 60867}, 'weighted avg': {'precision': 0.40668205661410417, 'recall': 0.37047989879573495, 'f1-score': 0.29083465570917005, 'support': 60867}}
[[  483 15116  4031]
 [  290 17134  4375]
 [  221 14284  4933]]
training model: results/PCAR/W5/deepLOB_L2/h30
Epoch 1/50
694/694 - 36s - loss: 3.3107 - accuracy30: 0.3608 - val_loss: 3.3747 - val_accuracy30: 0.3459 - 36s/epoch - 52ms/step
Epoch 2/50
694/694 - 34s - loss: 3.2516 - accuracy30: 0.3919 - val_loss: 3.4308 - val_accuracy30: 0.3473 - 34s/epoch - 49ms/step
Epoch 3/50
694/694 - 34s - loss: 3.2163 - accuracy30: 0.4122 - val_loss: 3.5079 - val_accuracy30: 0.3555 - 34s/epoch - 49ms/step
Epoch 4/50
694/694 - 34s - loss: 3.1982 - accuracy30: 0.4205 - val_loss: 3.5380 - val_accuracy30: 0.3607 - 34s/epoch - 49ms/step
Epoch 5/50
694/694 - 34s - loss: 3.1857 - accuracy30: 0.4271 - val_loss: 3.6290 - val_accuracy30: 0.3626 - 34s/epoch - 49ms/step
Epoch 6/50
694/694 - 34s - loss: 3.1775 - accuracy30: 0.4301 - val_loss: 3.6117 - val_accuracy30: 0.3618 - 34s/epoch - 49ms/step
Epoch 7/50
694/694 - 34s - loss: 3.1713 - accuracy30: 0.4330 - val_loss: 3.5783 - val_accuracy30: 0.3582 - 34s/epoch - 49ms/step
Epoch 8/50
694/694 - 34s - loss: 3.1644 - accuracy30: 0.4344 - val_loss: 3.6215 - val_accuracy30: 0.3582 - 34s/epoch - 49ms/step
Epoch 9/50
694/694 - 34s - loss: 3.1588 - accuracy30: 0.4373 - val_loss: 3.6191 - val_accuracy30: 0.3617 - 34s/epoch - 49ms/step
Epoch 10/50
694/694 - 34s - loss: 3.1544 - accuracy30: 0.4393 - val_loss: 3.6240 - val_accuracy30: 0.3598 - 34s/epoch - 49ms/step
Epoch 11/50
694/694 - 34s - loss: 3.1491 - accuracy30: 0.4412 - val_loss: 3.5788 - val_accuracy30: 0.3597 - 34s/epoch - 49ms/step
testing model: results/PCAR/W5/deepLOB_L2/h30
Evaluating performance on  test set...
2900/2900 - 57s - 57s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1456814
{'0': {'precision': 0.3657203523120478, 'recall': 0.03547576274224862, 'f1-score': 0.06467763750343346, 'support': 262179}, '1': {'precision': 0.2908050511147337, 'recall': 0.8494007681273426, 'f1-score': 0.43327271203783146, 'support': 216110}, '2': {'precision': 0.36761222417997874, 'recall': 0.11930215208903734, 'f1-score': 0.18014226573042705, 'support': 264069}, 'accuracy': 0.3022382731781701, 'macro avg': {'precision': 0.34137920920225345, 'recall': 0.3347262276528762, 'f1-score': 0.22603087175723066, 'support': 742358}, 'weighted avg': {'precision': 0.34458451080504054, 'recall': 0.3022382731781701, 'f1-score': 0.21305309849247472, 'support': 742358}}
[[  9301 223527  29351]
 [  7702 183564  24844]
 [  8429 224136  31504]]
Evaluating performance on  train set...
694/694 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1208481
{'0': {'precision': 0.36637747982770125, 'recall': 0.10121342137900982, 'f1-score': 0.15861009336957804, 'support': 59666}, '1': {'precision': 0.33849583224419855, 'recall': 0.7902864892354636, 'f1-score': 0.4739774494952062, 'support': 58990}, '2': {'precision': 0.35028852318871556, 'recall': 0.13902554880738302, 'f1-score': 0.19905029086360382, 'support': 58946}, 'accuracy': 0.34263690724203555, 'macro avg': {'precision': 0.35172061175353847, 'recall': 0.34350848647395216, 'f1-score': 0.277212611242796, 'support': 177602}, 'weighted avg': {'precision': 0.3517767544473988, 'recall': 0.34263690724203555, 'f1-score': 0.2767805431355359, 'support': 177602}}
[[ 6039 45789  7838]
 [ 5009 46619  7362]
 [ 5435 45316  8195]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1251078
{'0': {'precision': 0.33849557522123896, 'recall': 0.030797101449275364, 'f1-score': 0.05645756457564576, 'support': 19872}, '1': {'precision': 0.34878978463884125, 'recall': 0.8597669829935168, 'f1-score': 0.49625793155811054, 'support': 21286}, '2': {'precision': 0.32964030960692065, 'recall': 0.11020346034806433, 'f1-score': 0.1651836641569701, 'support': 19709}, 'accuracy': 0.3464110273218657, 'macro avg': {'precision': 0.3389752231556669, 'recall': 0.3335891815969522, 'f1-score': 0.23929972009690878, 'support': 60867}, 'weighted avg': {'precision': 0.3392282236460091, 'recall': 0.3464110273218657, 'f1-score': 0.2454675914906747, 'support': 60867}}
[[  612 17160  2100]
 [  668 18301  2317]
 [  528 17009  2172]]
training model: results/PCAR/W5/deepLOB_L2/h50
Epoch 1/50
694/694 - 38s - loss: 3.2970 - accuracy50: 0.3740 - val_loss: 3.4163 - val_accuracy50: 0.3483 - 38s/epoch - 54ms/step
Epoch 2/50
694/694 - 35s - loss: 3.2530 - accuracy50: 0.3902 - val_loss: 3.4070 - val_accuracy50: 0.3496 - 35s/epoch - 50ms/step
Epoch 3/50
694/694 - 34s - loss: 3.2262 - accuracy50: 0.4061 - val_loss: 3.3070 - val_accuracy50: 0.3573 - 34s/epoch - 50ms/step
Epoch 4/50
694/694 - 34s - loss: 3.2089 - accuracy50: 0.4144 - val_loss: 3.3848 - val_accuracy50: 0.3564 - 34s/epoch - 49ms/step
Epoch 5/50
694/694 - 33s - loss: 3.2032 - accuracy50: 0.4173 - val_loss: 3.3243 - val_accuracy50: 0.3734 - 33s/epoch - 48ms/step
Epoch 6/50
694/694 - 34s - loss: 3.1934 - accuracy50: 0.4223 - val_loss: 3.3527 - val_accuracy50: 0.3666 - 34s/epoch - 49ms/step
Epoch 7/50
694/694 - 34s - loss: 3.1885 - accuracy50: 0.4253 - val_loss: 3.3539 - val_accuracy50: 0.3689 - 34s/epoch - 49ms/step
Epoch 8/50
694/694 - 34s - loss: 3.1828 - accuracy50: 0.4271 - val_loss: 3.3831 - val_accuracy50: 0.3619 - 34s/epoch - 49ms/step
Epoch 9/50
694/694 - 34s - loss: 3.1787 - accuracy50: 0.4295 - val_loss: 3.3866 - val_accuracy50: 0.3587 - 34s/epoch - 49ms/step
Epoch 10/50
694/694 - 34s - loss: 3.1739 - accuracy50: 0.4304 - val_loss: 3.3395 - val_accuracy50: 0.3598 - 34s/epoch - 49ms/step
Epoch 11/50
694/694 - 34s - loss: 3.1709 - accuracy50: 0.4329 - val_loss: 3.3415 - val_accuracy50: 0.3620 - 34s/epoch - 49ms/step
Epoch 12/50
694/694 - 34s - loss: 3.1658 - accuracy50: 0.4342 - val_loss: 3.3314 - val_accuracy50: 0.3640 - 34s/epoch - 49ms/step
Epoch 13/50
694/694 - 34s - loss: 3.1606 - accuracy50: 0.4357 - val_loss: 3.3638 - val_accuracy50: 0.3613 - 34s/epoch - 49ms/step
testing model: results/PCAR/W5/deepLOB_L2/h50
Evaluating performance on  test set...
2900/2900 - 56s - 56s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1268687
{'0': {'precision': 0.41133195663397004, 'recall': 0.10060962776928149, 'f1-score': 0.16167452032556984, 'support': 285092}, '1': {'precision': 0.23531931972353612, 'recall': 0.557197744856255, 'f1-score': 0.3308935545522533, 'support': 171519}, '2': {'precision': 0.3921920321804748, 'recall': 0.3657711192068508, 'f1-score': 0.37852108850435673, 'support': 285747}, 'accuracy': 0.30816802674720284, 'macro avg': {'precision': 0.3462811028459936, 'recall': 0.3411928306107958, 'f1-score': 0.2903630544607266, 'support': 742358}, 'weighted avg': {'precision': 0.36329760196539557, 'recall': 0.30816802674720284, 'f1-score': 0.28424009629957475, 'support': 742358}}
[[ 28683 154151 102258]
 [ 16228  95570  59721]
 [ 24821 156408 104518]]
Evaluating performance on  train set...
694/694 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.10089
{'0': {'precision': 0.36856263051711324, 'recall': 0.1752882753976938, 'f1-score': 0.2375824225969107, 'support': 59405}, '1': {'precision': 0.36048787025867846, 'recall': 0.44868543974376085, 'f1-score': 0.39978001397208557, 'support': 59944}, '2': {'precision': 0.3546341267611287, 'recall': 0.4549980258527458, 'f1-score': 0.39859540423484113, 'support': 58253}, 'accuracy': 0.3593090167903515, 'macro avg': {'precision': 0.3612282091789735, 'recall': 0.3596572469980668, 'f1-score': 0.34531928026794584, 'support': 177602}, 'weighted avg': {'precision': 0.3612687342871779, 'recall': 0.3593090167903515, 'f1-score': 0.34513899086048794, 'support': 177602}}
[[10413 23868 25124]
 [ 9938 26896 23110]
 [ 7902 23846 26505]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1012824
{'0': {'precision': 0.35132498780686067, 'recall': 0.1093015022001922, 'f1-score': 0.1667309621171206, 'support': 19771}, '1': {'precision': 0.3733499821619693, 'recall': 0.5862471406563653, 'f1-score': 0.45618177525110337, 'support': 21421}, '2': {'precision': 0.3509013282732448, 'recall': 0.37595933926302416, 'f1-score': 0.36299840510366826, 'support': 19675}, 'accuracy': 0.3633495983045, 'macro avg': {'precision': 0.3585254327473582, 'recall': 0.3571693273731939, 'f1-score': 0.3286370474906308, 'support': 60867}, 'weighted avg': {'precision': 0.35893932567067666, 'recall': 0.3633495983045, 'f1-score': 0.33204037130277736, 'support': 60867}}
[[ 2161 10620  6990]
 [ 2170 12558  6693]
 [ 1820 10458  7397]]
training model: results/PCAR/W5/deepLOB_L2/h100
Epoch 1/50
694/694 - 37s - loss: 3.3230 - accuracy100: 0.3555 - val_loss: 3.3305 - val_accuracy100: 0.3316 - 37s/epoch - 53ms/step
Epoch 2/50
694/694 - 34s - loss: 3.2919 - accuracy100: 0.3620 - val_loss: 3.3280 - val_accuracy100: 0.3272 - 34s/epoch - 49ms/step
Epoch 3/50
694/694 - 34s - loss: 3.2808 - accuracy100: 0.3667 - val_loss: 3.3112 - val_accuracy100: 0.3337 - 34s/epoch - 49ms/step
Epoch 4/50
694/694 - 34s - loss: 3.2689 - accuracy100: 0.3795 - val_loss: 3.3319 - val_accuracy100: 0.3424 - 34s/epoch - 49ms/step
Epoch 5/50
694/694 - 34s - loss: 3.2551 - accuracy100: 0.3890 - val_loss: 3.3541 - val_accuracy100: 0.3354 - 34s/epoch - 49ms/step
Epoch 6/50
694/694 - 34s - loss: 3.2477 - accuracy100: 0.3953 - val_loss: 3.3255 - val_accuracy100: 0.3288 - 34s/epoch - 49ms/step
Epoch 7/50
694/694 - 34s - loss: 3.2390 - accuracy100: 0.3990 - val_loss: 3.3306 - val_accuracy100: 0.3349 - 34s/epoch - 49ms/step
Epoch 8/50
694/694 - 34s - loss: 3.2312 - accuracy100: 0.4047 - val_loss: 3.3245 - val_accuracy100: 0.3360 - 34s/epoch - 49ms/step
Epoch 9/50
694/694 - 34s - loss: 3.2262 - accuracy100: 0.4071 - val_loss: 3.3317 - val_accuracy100: 0.3352 - 34s/epoch - 49ms/step
Epoch 10/50
694/694 - 34s - loss: 3.2190 - accuracy100: 0.4104 - val_loss: 3.3270 - val_accuracy100: 0.3377 - 34s/epoch - 49ms/step
Epoch 11/50
694/694 - 34s - loss: 3.2114 - accuracy100: 0.4150 - val_loss: 3.3327 - val_accuracy100: 0.3361 - 34s/epoch - 49ms/step
Epoch 12/50
694/694 - 34s - loss: 3.2063 - accuracy100: 0.4177 - val_loss: 3.3305 - val_accuracy100: 0.3341 - 34s/epoch - 49ms/step
Epoch 13/50
694/694 - 34s - loss: 3.2000 - accuracy100: 0.4201 - val_loss: 3.3305 - val_accuracy100: 0.3363 - 34s/epoch - 49ms/step
testing model: results/PCAR/W5/deepLOB_L2/h100
Evaluating performance on  test set...
2900/2900 - 55s - 55s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1015813
{'0': {'precision': 0.35950871598908446, 'recall': 0.32440836397128786, 'f1-score': 0.3410578206182391, 'support': 262746}, '1': {'precision': 0.28982038316927466, 'recall': 0.2662622949317623, 'f1-score': 0.2775423273538211, 'support': 218281}, '2': {'precision': 0.35443199978997597, 'recall': 0.4132881288480892, 'f1-score': 0.381604005243279, 'support': 261331}, 'accuracy': 0.338599435851705, 'macro avg': {'precision': 0.3345870329827784, 'recall': 0.33465292925037976, 'f1-score': 0.3334013844051131, 'support': 742358}, 'weighted avg': {'precision': 0.33723059371213704, 'recall': 0.338599435851705, 'f1-score': 0.33665529459844257, 'support': 742358}}
[[ 85237  71897 105612]
 [ 69051  58120  91110]
 [ 82805  70521 108005]]
Evaluating performance on  train set...
694/694 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1010448
{'0': {'precision': 0.3500474533375514, 'recall': 0.3650128653427459, 'f1-score': 0.35737355467993026, 'support': 60628}, '1': {'precision': 0.32133366898828003, 'recall': 0.2002161107044512, 'f1-score': 0.24671155064480454, 'support': 57378}, '2': {'precision': 0.34422810341977084, 'recall': 0.45417477683065977, 'f1-score': 0.3916311574439147, 'support': 59596}, 'accuracy': 0.3416909719485141, 'macro avg': {'precision': 0.3385364085818674, 'recall': 0.33980125095928565, 'f1-score': 0.33190542092288317, 'support': 177602}, 'weighted avg': {'precision': 0.3388181344329639, 'recall': 0.3416909719485141, 'f1-score': 0.33311736176991213, 'support': 177602}}
[[22130 12211 26287]
 [20613 11488 25277]
 [20477 12052 27067]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1031001
{'0': {'precision': 0.3451773773093052, 'recall': 0.2973104895787573, 'f1-score': 0.31946083444785356, 'support': 20487}, '1': {'precision': 0.32518630794492864, 'recall': 0.2561818995969949, 'f1-score': 0.2865889293963766, 'support': 20099}, '2': {'precision': 0.33362544272830175, 'recall': 0.4505201913120655, 'f1-score': 0.38335990601661496, 'support': 20281}, 'accuracy': 0.33477910854814596, 'macro avg': {'precision': 0.3346630426608452, 'recall': 0.3346708601626059, 'f1-score': 0.3298032232869484, 'support': 60867}, 'weighted avg': {'precision': 0.3347269643040325, 'recall': 0.33477910854814596, 'f1-score': 0.3298974363972911, 'support': 60867}}
[[6091 5312 9084]
 [5784 5149 9166]
 [5771 5373 9137]]
training model: results/PCAR/W5/deepLOB_L2/h200
Epoch 1/50
694/694 - 37s - loss: 3.3194 - accuracy200: 0.3582 - val_loss: 3.4305 - val_accuracy200: 0.3369 - 37s/epoch - 53ms/step
Epoch 2/50
694/694 - 34s - loss: 3.2881 - accuracy200: 0.3666 - val_loss: 3.3386 - val_accuracy200: 0.3360 - 34s/epoch - 49ms/step
Epoch 3/50
694/694 - 34s - loss: 3.2830 - accuracy200: 0.3689 - val_loss: 3.3342 - val_accuracy200: 0.3424 - 34s/epoch - 49ms/step
Epoch 4/50
694/694 - 34s - loss: 3.2647 - accuracy200: 0.3845 - val_loss: 3.3484 - val_accuracy200: 0.3457 - 34s/epoch - 49ms/step
Epoch 5/50
694/694 - 34s - loss: 3.2510 - accuracy200: 0.3946 - val_loss: 3.3365 - val_accuracy200: 0.3413 - 34s/epoch - 49ms/step
Epoch 6/50
694/694 - 34s - loss: 3.2403 - accuracy200: 0.4008 - val_loss: 3.3561 - val_accuracy200: 0.3440 - 34s/epoch - 49ms/step
Epoch 7/50
694/694 - 34s - loss: 3.2324 - accuracy200: 0.4088 - val_loss: 3.3825 - val_accuracy200: 0.3421 - 34s/epoch - 49ms/step
Epoch 8/50
694/694 - 34s - loss: 3.2247 - accuracy200: 0.4115 - val_loss: 3.3758 - val_accuracy200: 0.3405 - 34s/epoch - 49ms/step
Epoch 9/50
694/694 - 34s - loss: 3.2163 - accuracy200: 0.4175 - val_loss: 3.3831 - val_accuracy200: 0.3390 - 34s/epoch - 49ms/step
Epoch 10/50
694/694 - 34s - loss: 3.2080 - accuracy200: 0.4210 - val_loss: 3.3736 - val_accuracy200: 0.3434 - 34s/epoch - 49ms/step
Epoch 11/50
694/694 - 34s - loss: 3.2013 - accuracy200: 0.4237 - val_loss: 3.3370 - val_accuracy200: 0.3440 - 34s/epoch - 49ms/step
Epoch 12/50
694/694 - 34s - loss: 3.1937 - accuracy200: 0.4265 - val_loss: 3.3477 - val_accuracy200: 0.3422 - 34s/epoch - 48ms/step
Epoch 13/50
694/694 - 34s - loss: 3.1860 - accuracy200: 0.4304 - val_loss: 3.3534 - val_accuracy200: 0.3441 - 34s/epoch - 49ms/step
testing model: results/PCAR/W5/deepLOB_L2/h200
Evaluating performance on  test set...
2900/2900 - 56s - 56s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1241143
{'0': {'precision': 0.3462195642887655, 'recall': 0.006155329999354469, 'f1-score': 0.012095615805634424, 'support': 263349}, '1': {'precision': 0.2953203905285602, 'recall': 0.7190458625353499, 'f1-score': 0.41868290529280033, 'support': 219591}, '2': {'precision': 0.35046498798124287, 'recall': 0.274267784039658, 'f1-score': 0.3077195880925711, 'support': 259418}, 'accuracy': 0.31072205054704066, 'macro avg': {'precision': 0.33066831426618953, 'recall': 0.3331563255247874, 'f1-score': 0.24616603639700196, 'support': 742358}, 'weighted avg': {'precision': 0.332647054607827, 'recall': 0.31072205054704066, 'f1-score': 0.23567115365732969, 'support': 742358}}
[[  1621 190049  71679]
 [  1508 157896  60187]
 [  1553 186715  71150]]
Evaluating performance on  train set...
694/694 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1111748
{'0': {'precision': 0.35223160434258144, 'recall': 0.06336805555555555, 'f1-score': 0.10741217583226044, 'support': 59904}, '1': {'precision': 0.3387323163299228, 'recall': 0.6256417253671266, 'f1-score': 0.43950803663964816, 'support': 58631}, '2': {'precision': 0.3456170023747288, 'recall': 0.34249242385765316, 'f1-score': 0.3440476190476191, 'support': 59067}, 'accuracy': 0.34182047499465096, 'macro avg': {'precision': 0.3455269743490777, 'recall': 0.34383406826011176, 'f1-score': 0.2969892771731759, 'support': 177602}, 'weighted avg': {'precision': 0.3455752522187014, 'recall': 0.34182047499465096, 'f1-score': 0.2957459679032931, 'support': 177602}}
[[ 3796 36150 19958]
 [ 3604 36682 18345]
 [ 3377 35460 20230]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1118011
{'0': {'precision': 0.3173277661795407, 'recall': 0.007648568409399688, 'f1-score': 0.014937106918238994, 'support': 19873}, '1': {'precision': 0.34684226704182725, 'recall': 0.6983242882985814, 'f1-score': 0.4634828354318394, 'support': 21006}, '2': {'precision': 0.33412544901906605, 'recall': 0.302481488893336, 'f1-score': 0.3175170023370008, 'support': 19988}, 'accuracy': 0.3428294478124435, 'macro avg': {'precision': 0.33276516074681134, 'recall': 0.3361514485337724, 'f1-score': 0.26531231489569307, 'support': 60867}, 'weighted avg': {'precision': 0.3330297670948088, 'recall': 0.3428294478124435, 'f1-score': 0.2690997652189093, 'support': 60867}}
[[  152 13827  5894]
 [  182 14669  6155]
 [  145 13797  6046]]
training model: results/PCAR/W5/deepLOB_L2/h300
Epoch 1/50
694/694 - 36s - loss: 3.3135 - accuracy300: 0.3672 - val_loss: 3.4285 - val_accuracy300: 0.3236 - 36s/epoch - 52ms/step
Epoch 2/50
694/694 - 34s - loss: 3.2894 - accuracy300: 0.3691 - val_loss: 3.3447 - val_accuracy300: 0.3300 - 34s/epoch - 49ms/step
Epoch 3/50
694/694 - 34s - loss: 3.2807 - accuracy300: 0.3747 - val_loss: 3.3096 - val_accuracy300: 0.3499 - 34s/epoch - 49ms/step
Epoch 4/50
694/694 - 34s - loss: 3.2769 - accuracy300: 0.3821 - val_loss: 3.3019 - val_accuracy300: 0.3476 - 34s/epoch - 49ms/step
Epoch 5/50
694/694 - 34s - loss: 3.2665 - accuracy300: 0.3897 - val_loss: 3.3048 - val_accuracy300: 0.3437 - 34s/epoch - 49ms/step
Epoch 6/50
694/694 - 34s - loss: 3.2541 - accuracy300: 0.3978 - val_loss: 3.3088 - val_accuracy300: 0.3399 - 34s/epoch - 49ms/step
Epoch 7/50
694/694 - 34s - loss: 3.2427 - accuracy300: 0.4042 - val_loss: 3.3120 - val_accuracy300: 0.3439 - 34s/epoch - 49ms/step
Epoch 8/50
694/694 - 34s - loss: 3.2336 - accuracy300: 0.4091 - val_loss: 3.3068 - val_accuracy300: 0.3507 - 34s/epoch - 49ms/step
Epoch 9/50
694/694 - 34s - loss: 3.2236 - accuracy300: 0.4169 - val_loss: 3.3053 - val_accuracy300: 0.3530 - 34s/epoch - 49ms/step
Epoch 10/50
694/694 - 34s - loss: 3.2135 - accuracy300: 0.4201 - val_loss: 3.3120 - val_accuracy300: 0.3486 - 34s/epoch - 49ms/step
Epoch 11/50
694/694 - 34s - loss: 3.2044 - accuracy300: 0.4241 - val_loss: 3.3087 - val_accuracy300: 0.3574 - 34s/epoch - 49ms/step
Epoch 12/50
694/694 - 34s - loss: 3.1937 - accuracy300: 0.4288 - val_loss: 3.3250 - val_accuracy300: 0.3540 - 34s/epoch - 49ms/step
Epoch 13/50
694/694 - 35s - loss: 3.1818 - accuracy300: 0.4326 - val_loss: 3.3498 - val_accuracy300: 0.3537 - 35s/epoch - 50ms/step
Epoch 14/50
694/694 - 35s - loss: 3.1782 - accuracy300: 0.4353 - val_loss: 3.3398 - val_accuracy300: 0.3570 - 35s/epoch - 51ms/step
testing model: results/PCAR/W5/deepLOB_L2/h300
Evaluating performance on  test set...
2900/2900 - 57s - 57s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1093429
{'0': {'precision': 0.36247735822767174, 'recall': 0.2517568151026546, 'f1-score': 0.2971379620884311, 'support': 268668}, '1': {'precision': 0.28292599839278854, 'recall': 0.6176530879794055, 'f1-score': 0.3880838878480039, 'support': 209765}, '2': {'precision': 0.35310774892659985, 'recall': 0.1308743014113858, 'f1-score': 0.19096877634797993, 'support': 263925}, 'accuracy': 0.31217013893566176, 'macro avg': {'precision': 0.33283703518235336, 'recall': 0.33342806816448195, 'f1-score': 0.29206354209480495, 'support': 742358}, 'weighted avg': {'precision': 0.33666775540726745, 'recall': 0.31217013893566176, 'f1-score': 0.28509063420944036, 'support': 742358}}
[[ 67639 165124  35905]
 [ 52829 129562  27374]
 [ 66134 163250  34541]]
Evaluating performance on  train set...
694/694 - 15s - 15s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1012272
{'0': {'precision': 0.3380440690722081, 'recall': 0.27194752774974773, 'f1-score': 0.3014148041828993, 'support': 59460}, '1': {'precision': 0.343510596087129, 'recall': 0.5660067389737314, 'f1-score': 0.42754393962417053, 'support': 59653}, '2': {'precision': 0.35953235695904945, 'recall': 0.193489374070338, 'f1-score': 0.25158393170753396, 'support': 58489}, 'accuracy': 0.3448778729969257, 'macro avg': {'precision': 0.3470290073727955, 'recall': 0.3438145469312724, 'f1-score': 0.32684755850486796, 'support': 177602}, 'weighted avg': {'precision': 0.34695682459429983, 'recall': 0.3448778729969257, 'f1-score': 0.32736847258903495, 'support': 177602}}
[[16170 32679 10611]
 [16340 33764  9549]
 [15324 31848 11317]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.101455
{'0': {'precision': 0.31684528716680405, 'recall': 0.2361132442533149, 'f1-score': 0.2705858194725571, 'support': 19533}, '1': {'precision': 0.3592761127674042, 'recall': 0.6268193639640461, 'f1-score': 0.456753387083368, 'support': 21917}, '2': {'precision': 0.3162393162393162, 'recall': 0.1314827213266725, 'f1-score': 0.1857402691887959, 'support': 19417}, 'accuracy': 0.34342090130941233, 'macro avg': {'precision': 0.3307869053911748, 'recall': 0.33147177651467785, 'f1-score': 0.30435982524824035, 'support': 60867}, 'weighted avg': {'precision': 0.33193047728935515, 'recall': 0.34342090130941233, 'f1-score': 0.310554744004181, 'support': 60867}}
[[ 4612 12208  2713]
 [ 5372 13738  2807]
 [ 4572 12292  2553]]
training model: results/PCAR/W5/deepLOB_L2/h500
Epoch 1/50
694/694 - 37s - loss: 3.3181 - accuracy500: 0.3641 - val_loss: 3.3687 - val_accuracy500: 0.3330 - 37s/epoch - 53ms/step
Epoch 2/50
694/694 - 35s - loss: 3.2885 - accuracy500: 0.3719 - val_loss: 3.3131 - val_accuracy500: 0.3477 - 35s/epoch - 50ms/step
Epoch 3/50
694/694 - 35s - loss: 3.2792 - accuracy500: 0.3706 - val_loss: 3.3129 - val_accuracy500: 0.3449 - 35s/epoch - 50ms/step
Epoch 4/50
694/694 - 35s - loss: 3.2650 - accuracy500: 0.3850 - val_loss: 3.3348 - val_accuracy500: 0.3448 - 35s/epoch - 50ms/step
Epoch 5/50
694/694 - 35s - loss: 3.2479 - accuracy500: 0.4005 - val_loss: 3.3373 - val_accuracy500: 0.3414 - 35s/epoch - 50ms/step
Epoch 6/50
694/694 - 35s - loss: 3.2331 - accuracy500: 0.4081 - val_loss: 3.3370 - val_accuracy500: 0.3412 - 35s/epoch - 50ms/step
Epoch 7/50
694/694 - 35s - loss: 3.2275 - accuracy500: 0.4106 - val_loss: 3.3141 - val_accuracy500: 0.3415 - 35s/epoch - 50ms/step
Epoch 8/50
694/694 - 34s - loss: 3.2125 - accuracy500: 0.4206 - val_loss: 3.3279 - val_accuracy500: 0.3422 - 34s/epoch - 49ms/step
Epoch 9/50
694/694 - 35s - loss: 3.2014 - accuracy500: 0.4251 - val_loss: 3.3355 - val_accuracy500: 0.3434 - 35s/epoch - 50ms/step
Epoch 10/50
694/694 - 35s - loss: 3.1939 - accuracy500: 0.4301 - val_loss: 3.3149 - val_accuracy500: 0.3502 - 35s/epoch - 50ms/step
Epoch 11/50
694/694 - 35s - loss: 3.1804 - accuracy500: 0.4366 - val_loss: 3.3169 - val_accuracy500: 0.3513 - 35s/epoch - 50ms/step
Epoch 12/50
694/694 - 35s - loss: 3.1684 - accuracy500: 0.4412 - val_loss: 3.3417 - val_accuracy500: 0.3470 - 35s/epoch - 50ms/step
Epoch 13/50
694/694 - 35s - loss: 3.1618 - accuracy500: 0.4435 - val_loss: 3.3363 - val_accuracy500: 0.3532 - 35s/epoch - 50ms/step
testing model: results/PCAR/W5/deepLOB_L2/h500
Evaluating performance on  test set...
2900/2900 - 58s - 58s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1207222
{'0': {'precision': 0.35245958751393536, 'recall': 0.038261823270238075, 'f1-score': 0.06902998440906254, 'support': 264415}, '1': {'precision': 0.2932360825384951, 'recall': 0.8650348492928995, 'f1-score': 0.43799671302266896, 'support': 217508}, '2': {'precision': 0.3500847057516594, 'recall': 0.09680342503887726, 'f1-score': 0.15166837620206408, 'support': 260435}, 'accuracy': 0.3010407377572546, 'macro avg': {'precision': 0.3319267919346966, 'recall': 0.33336669920067163, 'f1-score': 0.2195650245445985, 'support': 742358}, 'weighted avg': {'precision': 0.3342741723207854, 'recall': 0.3010407377572546, 'f1-score': 0.2061271057088918, 'support': 742358}}
[[ 10117 228525  25773]
 [  8326 188152  21030]
 [ 10261 224963  25211]]
Evaluating performance on  train set...
694/694 - 15s - 15s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.109637
{'0': {'precision': 0.3350170476070211, 'recall': 0.08834940140200143, 'f1-score': 0.139824757889189, 'support': 60057}, '1': {'precision': 0.32610213093025264, 'recall': 0.7128358106602205, 'f1-score': 0.44749020620775753, 'support': 58329}, '2': {'precision': 0.3488514637634628, 'recall': 0.20183734125911915, 'f1-score': 0.25572065855772, 'support': 59216}, 'accuracy': 0.33128568371977796, 'macro avg': {'precision': 0.3366568807669122, 'recall': 0.3343408511071137, 'f1-score': 0.28101187421822216, 'support': 177602}, 'weighted avg': {'precision': 0.3367018293790767, 'recall': 0.33128568371977796, 'f1-score': 0.2795118649542081, 'support': 177602}}
[[ 5306 43587 11164]
 [ 5605 41579 11145]
 [ 4927 42337 11952]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1045123
{'0': {'precision': 0.3437321121923297, 'recall': 0.0597126236762293, 'f1-score': 0.10174948108611852, 'support': 20113}, '1': {'precision': 0.3492082509634777, 'recall': 0.8346298859351883, 'f1-score': 0.49239779254420546, 'support': 20953}, '2': {'precision': 0.3327392377296408, 'recall': 0.12256956719357608, 'f1-score': 0.1791474441778926, 'support': 19801}, 'accuracy': 0.3469203344998111, 'macro avg': {'precision': 0.34189320029514936, 'recall': 0.33897069226833126, 'f1-score': 0.2577649059360722, 'support': 60867}, 'weighted avg': {'precision': 0.34204107482292034, 'recall': 0.3469203344998111, 'f1-score': 0.261405963862689, 'support': 60867}}
[[ 1201 16362  2550]
 [ 1148 17488  2317]
 [ 1145 16229  2427]]
training model: results/PCAR/W5/deepLOB_L2/h1000
Epoch 1/50
694/694 - 37s - loss: 3.3143 - accuracy1000: 0.3717 - val_loss: 3.5051 - val_accuracy1000: 0.3207 - 37s/epoch - 53ms/step
Epoch 2/50
694/694 - 35s - loss: 3.2891 - accuracy1000: 0.3688 - val_loss: 3.4530 - val_accuracy1000: 0.3317 - 35s/epoch - 50ms/step
Epoch 3/50
694/694 - 34s - loss: 3.2826 - accuracy1000: 0.3733 - val_loss: 3.4090 - val_accuracy1000: 0.3349 - 34s/epoch - 50ms/step
Epoch 4/50
694/694 - 35s - loss: 3.2692 - accuracy1000: 0.3770 - val_loss: 3.4002 - val_accuracy1000: 0.3241 - 35s/epoch - 50ms/step
Epoch 5/50
694/694 - 35s - loss: 3.2530 - accuracy1000: 0.3928 - val_loss: 3.3818 - val_accuracy1000: 0.3144 - 35s/epoch - 50ms/step
Epoch 6/50
694/694 - 35s - loss: 3.2509 - accuracy1000: 0.3969 - val_loss: 3.3933 - val_accuracy1000: 0.3066 - 35s/epoch - 50ms/step
Epoch 7/50
694/694 - 35s - loss: 3.2347 - accuracy1000: 0.4086 - val_loss: 3.3998 - val_accuracy1000: 0.3193 - 35s/epoch - 50ms/step
Epoch 8/50
694/694 - 35s - loss: 3.2131 - accuracy1000: 0.4172 - val_loss: 3.4036 - val_accuracy1000: 0.3139 - 35s/epoch - 50ms/step
Epoch 9/50
694/694 - 35s - loss: 3.1999 - accuracy1000: 0.4186 - val_loss: 3.4091 - val_accuracy1000: 0.3203 - 35s/epoch - 50ms/step
Epoch 10/50
694/694 - 35s - loss: 3.1985 - accuracy1000: 0.4268 - val_loss: 3.4196 - val_accuracy1000: 0.3257 - 35s/epoch - 50ms/step
Epoch 11/50
694/694 - 35s - loss: 3.1789 - accuracy1000: 0.4345 - val_loss: 3.3869 - val_accuracy1000: 0.3171 - 35s/epoch - 50ms/step
Epoch 12/50
694/694 - 34s - loss: 3.1667 - accuracy1000: 0.4413 - val_loss: 3.4044 - val_accuracy1000: 0.3320 - 34s/epoch - 50ms/step
Epoch 13/50
694/694 - 35s - loss: 3.1539 - accuracy1000: 0.4454 - val_loss: 3.4603 - val_accuracy1000: 0.3321 - 35s/epoch - 50ms/step
Epoch 14/50
694/694 - 35s - loss: 3.1423 - accuracy1000: 0.4509 - val_loss: 3.4081 - val_accuracy1000: 0.3395 - 35s/epoch - 50ms/step
Epoch 15/50
694/694 - 35s - loss: 3.1291 - accuracy1000: 0.4545 - val_loss: 3.4009 - val_accuracy1000: 0.3434 - 35s/epoch - 50ms/step
testing model: results/PCAR/W5/deepLOB_L2/h1000
Evaluating performance on  test set...
2900/2900 - 56s - 56s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1444738
{'0': {'precision': 0.36268201828648833, 'recall': 0.016282039587704095, 'f1-score': 0.031164976502597082, 'support': 263112}, '1': {'precision': 0.28582601171459, 'recall': 0.07630356175093508, 'f1-score': 0.12045159706882647, 'support': 225114}, '2': {'precision': 0.34093370124543215, 'recall': 0.8994498921820157, 'f1-score': 0.49444830204351803, 'support': 254132}, 'accuracy': 0.3368186238984425, 'macro avg': {'precision': 0.3298139104155035, 'recall': 0.33067849784021824, 'f1-score': 0.21535495853831388, 'support': 742358}, 'weighted avg': {'precision': 0.33193094350894975, 'recall': 0.3368186238984425, 'f1-score': 0.21683656135587742, 'support': 742358}}
[[  4284  21493 237335]
 [  3401  17177 204536]
 [  4127  21426 228579]]
Evaluating performance on  train set...
694/694 - 15s - 15s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1366657
{'0': {'precision': 0.3350535731839182, 'recall': 0.11342007187541595, 'f1-score': 0.16947172156619017, 'support': 60104}, '1': {'precision': 0.31155799145643587, 'recall': 0.13020412287793048, 'f1-score': 0.1836560161539375, 'support': 59376}, '2': {'precision': 0.32907234865073015, 'recall': 0.7498537558927773, 'f1-score': 0.4574106336978653, 'support': 58122}, 'accuracy': 0.3273105032600984, 'macro avg': {'precision': 0.32522797109702806, 'recall': 0.3311593168820412, 'f1-score': 0.270179457139331, 'support': 177602}, 'weighted avg': {'precision': 0.3252411026432207, 'recall': 0.3273105032600984, 'f1-score': 0.2684446617715894, 'support': 177602}}
[[ 6817  8480 44807]
 [ 7593  7731 44052]
 [ 5936  8603 43583]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1295607
{'0': {'precision': 0.40206851971557855, 'recall': 0.061915190125423056, 'f1-score': 0.10730613301129993, 'support': 20092}, '1': {'precision': 0.26013006503251623, 'recall': 0.09799764428739693, 'f1-score': 0.14236336881010234, 'support': 21225}, '2': {'precision': 0.317556301102919, 'recall': 0.808542199488491, 'f1-score': 0.45601280886234796, 'support': 19550}, 'accuracy': 0.31430824584750355, 'macro avg': {'precision': 0.3265849619503379, 'recall': 0.32281834463377035, 'f1-score': 0.2352274368945834, 'support': 60867}, 'weighted avg': {'precision': 0.32542834401239795, 'recall': 0.31430824584750355, 'f1-score': 0.2315328131946106, 'support': 60867}}
[[ 1244  3230 15618]
 [  793  2080 18352]
 [ 1057  2686 15807]]
training model: results/PCAR/W5/deepOF_L2/h10
Epoch 1/50
694/694 - 25s - loss: 3.2213 - accuracy10: 0.4146 - val_loss: 3.1715 - val_accuracy10: 0.4405 - 25s/epoch - 36ms/step
Epoch 2/50
694/694 - 22s - loss: 3.1348 - accuracy10: 0.4491 - val_loss: 3.1261 - val_accuracy10: 0.4597 - 22s/epoch - 32ms/step
Epoch 3/50
694/694 - 23s - loss: 3.1004 - accuracy10: 0.4635 - val_loss: 3.0987 - val_accuracy10: 0.4694 - 23s/epoch - 33ms/step
Epoch 4/50
694/694 - 23s - loss: 3.0767 - accuracy10: 0.4716 - val_loss: 3.0810 - val_accuracy10: 0.4761 - 23s/epoch - 33ms/step
Epoch 5/50
694/694 - 23s - loss: 3.0591 - accuracy10: 0.4788 - val_loss: 3.0644 - val_accuracy10: 0.4803 - 23s/epoch - 33ms/step
Epoch 6/50
694/694 - 23s - loss: 3.0414 - accuracy10: 0.4845 - val_loss: 3.0486 - val_accuracy10: 0.4844 - 23s/epoch - 32ms/step
Epoch 7/50
694/694 - 23s - loss: 3.0272 - accuracy10: 0.4892 - val_loss: 3.0415 - val_accuracy10: 0.4873 - 23s/epoch - 33ms/step
Epoch 8/50
694/694 - 23s - loss: 3.0174 - accuracy10: 0.4919 - val_loss: 3.0325 - val_accuracy10: 0.4906 - 23s/epoch - 33ms/step
Epoch 9/50
694/694 - 23s - loss: 3.0064 - accuracy10: 0.4958 - val_loss: 3.0329 - val_accuracy10: 0.4883 - 23s/epoch - 32ms/step
Epoch 10/50
694/694 - 23s - loss: 2.9978 - accuracy10: 0.4978 - val_loss: 3.0338 - val_accuracy10: 0.4900 - 23s/epoch - 32ms/step
Epoch 11/50
694/694 - 22s - loss: 2.9890 - accuracy10: 0.5015 - val_loss: 3.0244 - val_accuracy10: 0.4907 - 22s/epoch - 32ms/step
Epoch 12/50
694/694 - 23s - loss: 2.9816 - accuracy10: 0.5028 - val_loss: 3.0196 - val_accuracy10: 0.4924 - 23s/epoch - 33ms/step
Epoch 13/50
694/694 - 22s - loss: 2.9745 - accuracy10: 0.5054 - val_loss: 3.0204 - val_accuracy10: 0.4928 - 22s/epoch - 32ms/step
Epoch 14/50
694/694 - 22s - loss: 2.9692 - accuracy10: 0.5073 - val_loss: 3.0167 - val_accuracy10: 0.4929 - 22s/epoch - 32ms/step
Epoch 15/50
694/694 - 22s - loss: 2.9633 - accuracy10: 0.5087 - val_loss: 3.0212 - val_accuracy10: 0.4914 - 22s/epoch - 32ms/step
Epoch 16/50
694/694 - 22s - loss: 2.9566 - accuracy10: 0.5108 - val_loss: 3.0149 - val_accuracy10: 0.4918 - 22s/epoch - 32ms/step
Epoch 17/50
694/694 - 22s - loss: 2.9520 - accuracy10: 0.5127 - val_loss: 3.0183 - val_accuracy10: 0.4908 - 22s/epoch - 32ms/step
Epoch 18/50
694/694 - 22s - loss: 2.9458 - accuracy10: 0.5148 - val_loss: 3.0165 - val_accuracy10: 0.4927 - 22s/epoch - 32ms/step
Epoch 19/50
694/694 - 22s - loss: 2.9397 - accuracy10: 0.5154 - val_loss: 3.0251 - val_accuracy10: 0.4895 - 22s/epoch - 32ms/step
Epoch 20/50
694/694 - 22s - loss: 2.9350 - accuracy10: 0.5168 - val_loss: 3.0265 - val_accuracy10: 0.4901 - 22s/epoch - 32ms/step
Epoch 21/50
694/694 - 22s - loss: 2.9290 - accuracy10: 0.5190 - val_loss: 3.0235 - val_accuracy10: 0.4903 - 22s/epoch - 32ms/step
Epoch 22/50
694/694 - 22s - loss: 2.9241 - accuracy10: 0.5199 - val_loss: 3.0177 - val_accuracy10: 0.4902 - 22s/epoch - 32ms/step
Epoch 23/50
694/694 - 22s - loss: 2.9181 - accuracy10: 0.5216 - val_loss: 3.0263 - val_accuracy10: 0.4881 - 22s/epoch - 32ms/step
Epoch 24/50
694/694 - 23s - loss: 2.9131 - accuracy10: 0.5236 - val_loss: 3.0309 - val_accuracy10: 0.4894 - 23s/epoch - 33ms/step
Epoch 25/50
694/694 - 22s - loss: 2.9089 - accuracy10: 0.5251 - val_loss: 3.0323 - val_accuracy10: 0.4880 - 22s/epoch - 32ms/step
Epoch 26/50
694/694 - 23s - loss: 2.9042 - accuracy10: 0.5265 - val_loss: 3.0328 - val_accuracy10: 0.4891 - 23s/epoch - 32ms/step
testing model: results/PCAR/W5/deepOF_L2/h10
Evaluating performance on  test set...
2900/2900 - 47s - 47s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0485384
{'0': {'precision': 0.46797735354023545, 'recall': 0.5181899151761652, 'f1-score': 0.49180530084114704, 'support': 261601}, '1': {'precision': 0.4684121060942859, 'recall': 0.2150612118609237, 'f1-score': 0.29478041802230637, 'support': 216543}, '2': {'precision': 0.43762986112290597, 'recall': 0.5851352527733726, 'f1-score': 0.5007457840125286, 'support': 264209}, 'accuracy': 0.45359417958841686, 'macro avg': {'precision': 0.4580064402524758, 'recall': 0.4394621266034872, 'f1-score': 0.42911050095866066, 'support': 742353}, 'weighted avg': {'precision': 0.45730326991455, 'recall': 0.45359417958841686, 'f1-score': 0.43751549116567906, 'support': 742353}}
[[135559  25656 100386]
 [ 71695  46570  98278]
 [ 82416  27195 154598]]
Evaluating performance on  train set...
694/694 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9953098
{'0': {'precision': 0.5013133327004019, 'recall': 0.5265852239674229, 'f1-score': 0.513638611252969, 'support': 60165}, '1': {'precision': 0.5338822483684592, 'recall': 0.39592693461932105, 'f1-score': 0.4546704117611905, 'support': 57647}, '2': {'precision': 0.48422257267665, 'recall': 0.580297708646931, 'f1-score': 0.5279246517501882, 'support': 59790}, 'accuracy': 0.5022578574565602, 'macro avg': {'precision': 0.5064727179151703, 'recall': 0.5009366224112249, 'f1-score': 0.49874455825478253, 'support': 177602}, 'weighted avg': {'precision': 0.5061310922959941, 'recall': 0.5022578574565602, 'f1-score': 0.4993078186111417, 'support': 177602}}
[[31682 10192 18291]
 [16157 22824 18666]
 [15359  9735 34696]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.002884
{'0': {'precision': 0.4776182831239966, 'recall': 0.5105491621239653, 'f1-score': 0.493535008538668, 'support': 19812}, '1': {'precision': 0.5418974235492415, 'recall': 0.4273033654530783, 'f1-score': 0.4778258446349426, 'support': 21067}, '2': {'precision': 0.4732850890497032, 'recall': 0.5464278567140284, 'f1-score': 0.5072332520608382, 'support': 19988}, 'accuracy': 0.4935186554290502, 'macro avg': {'precision': 0.4976002652409804, 'recall': 0.49476012809702397, 'f1-score': 0.4928647017448163, 'support': 60867}, 'weighted avg': {'precision': 0.498443307655872, 'recall': 0.4935186554290502, 'f1-score': 0.4925961670574279, 'support': 60867}}
[[10115  3813  5884]
 [ 5794  9002  6271]
 [ 5269  3797 10922]]
training model: results/PCAR/W5/deepOF_L2/h20
Epoch 1/50
694/694 - 25s - loss: 3.2635 - accuracy20: 0.3931 - val_loss: 3.2435 - val_accuracy20: 0.3890 - 25s/epoch - 36ms/step
Epoch 2/50
694/694 - 22s - loss: 3.1954 - accuracy20: 0.4242 - val_loss: 3.2077 - val_accuracy20: 0.4090 - 22s/epoch - 32ms/step
Epoch 3/50
694/694 - 22s - loss: 3.1709 - accuracy20: 0.4343 - val_loss: 3.1901 - val_accuracy20: 0.4166 - 22s/epoch - 32ms/step
Epoch 4/50
694/694 - 22s - loss: 3.1535 - accuracy20: 0.4426 - val_loss: 3.1715 - val_accuracy20: 0.4298 - 22s/epoch - 32ms/step
Epoch 5/50
694/694 - 23s - loss: 3.1415 - accuracy20: 0.4471 - val_loss: 3.1594 - val_accuracy20: 0.4364 - 23s/epoch - 33ms/step
Epoch 6/50
694/694 - 23s - loss: 3.1294 - accuracy20: 0.4520 - val_loss: 3.1443 - val_accuracy20: 0.4439 - 23s/epoch - 33ms/step
Epoch 7/50
694/694 - 22s - loss: 3.1192 - accuracy20: 0.4563 - val_loss: 3.1321 - val_accuracy20: 0.4502 - 22s/epoch - 32ms/step
Epoch 8/50
694/694 - 22s - loss: 3.1124 - accuracy20: 0.4587 - val_loss: 3.1277 - val_accuracy20: 0.4510 - 22s/epoch - 32ms/step
Epoch 9/50
694/694 - 22s - loss: 3.1029 - accuracy20: 0.4625 - val_loss: 3.1212 - val_accuracy20: 0.4549 - 22s/epoch - 32ms/step
Epoch 10/50
694/694 - 23s - loss: 3.0979 - accuracy20: 0.4639 - val_loss: 3.1153 - val_accuracy20: 0.4551 - 23s/epoch - 33ms/step
Epoch 11/50
694/694 - 22s - loss: 3.0898 - accuracy20: 0.4678 - val_loss: 3.1132 - val_accuracy20: 0.4591 - 22s/epoch - 32ms/step
Epoch 12/50
694/694 - 23s - loss: 3.0831 - accuracy20: 0.4708 - val_loss: 3.1130 - val_accuracy20: 0.4571 - 23s/epoch - 33ms/step
Epoch 13/50
694/694 - 22s - loss: 3.0782 - accuracy20: 0.4714 - val_loss: 3.1102 - val_accuracy20: 0.4574 - 22s/epoch - 32ms/step
Epoch 14/50
694/694 - 23s - loss: 3.0727 - accuracy20: 0.4732 - val_loss: 3.1091 - val_accuracy20: 0.4582 - 23s/epoch - 33ms/step
Epoch 15/50
694/694 - 22s - loss: 3.0671 - accuracy20: 0.4760 - val_loss: 3.1054 - val_accuracy20: 0.4611 - 22s/epoch - 32ms/step
Epoch 16/50
694/694 - 22s - loss: 3.0615 - accuracy20: 0.4776 - val_loss: 3.1023 - val_accuracy20: 0.4616 - 22s/epoch - 32ms/step
Epoch 17/50
694/694 - 22s - loss: 3.0575 - accuracy20: 0.4778 - val_loss: 3.1070 - val_accuracy20: 0.4597 - 22s/epoch - 31ms/step
Epoch 18/50
694/694 - 22s - loss: 3.0521 - accuracy20: 0.4795 - val_loss: 3.1049 - val_accuracy20: 0.4606 - 22s/epoch - 32ms/step
Epoch 19/50
694/694 - 22s - loss: 3.0452 - accuracy20: 0.4826 - val_loss: 3.1068 - val_accuracy20: 0.4600 - 22s/epoch - 32ms/step
Epoch 20/50
694/694 - 22s - loss: 3.0390 - accuracy20: 0.4838 - val_loss: 3.1077 - val_accuracy20: 0.4610 - 22s/epoch - 32ms/step
Epoch 21/50
694/694 - 22s - loss: 3.0348 - accuracy20: 0.4853 - val_loss: 3.1094 - val_accuracy20: 0.4582 - 22s/epoch - 32ms/step
Epoch 22/50
694/694 - 23s - loss: 3.0310 - accuracy20: 0.4863 - val_loss: 3.1082 - val_accuracy20: 0.4610 - 23s/epoch - 32ms/step
Epoch 23/50
694/694 - 22s - loss: 3.0233 - accuracy20: 0.4883 - val_loss: 3.1109 - val_accuracy20: 0.4570 - 22s/epoch - 32ms/step
Epoch 24/50
694/694 - 22s - loss: 3.0182 - accuracy20: 0.4906 - val_loss: 3.1140 - val_accuracy20: 0.4569 - 22s/epoch - 32ms/step
Epoch 25/50
694/694 - 22s - loss: 3.0151 - accuracy20: 0.4909 - val_loss: 3.1132 - val_accuracy20: 0.4573 - 22s/epoch - 32ms/step
Epoch 26/50
694/694 - 22s - loss: 3.0080 - accuracy20: 0.4933 - val_loss: 3.1138 - val_accuracy20: 0.4578 - 22s/epoch - 32ms/step
testing model: results/PCAR/W5/deepOF_L2/h20
Evaluating performance on  test set...
2900/2900 - 47s - 47s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0751331
{'0': {'precision': 0.44286946346071954, 'recall': 0.472771378908563, 'f1-score': 0.45733217049393576, 'support': 261765}, '1': {'precision': 0.3747731883780577, 'recall': 0.22659877329012845, 'f1-score': 0.2824313408723748, 'support': 216025}, '2': {'precision': 0.42137653137686243, 'recall': 0.5292614613532505, 'f1-score': 0.4691972348717124, 'support': 264563}, 'accuracy': 0.4212672407870649, 'macro avg': {'precision': 0.4130063944052132, 'recall': 0.40954387118398067, 'f1-score': 0.40298691541267434, 'support': 742353}, 'weighted avg': {'precision': 0.415393677122369, 'recall': 0.4212672407870649, 'f1-score': 0.41066448720576965, 'support': 742353}}
[[123755  38826  99184]
 [ 73982  48951  93092]
 [ 81702  42838 140023]]
Evaluating performance on  train set...
694/694 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0296082
{'0': {'precision': 0.46849413768258336, 'recall': 0.48766768370634256, 'f1-score': 0.47788867081471587, 'support': 58667}, '1': {'precision': 0.477278216068266, 'recall': 0.3916597853014038, 'f1-score': 0.43025091166385454, 'support': 60550}, '2': {'precision': 0.4594291356251683, 'recall': 0.5260083925665839, 'f1-score': 0.49046961215673435, 'support': 58385}, 'accuracy': 0.4675397799574329, 'macro avg': {'precision': 0.46840049645867254, 'recall': 0.46844528719144346, 'f1-score': 0.46620306487843494, 'support': 177602}, 'weighted avg': {'precision': 0.46850886612669385, 'recall': 0.4675397799574329, 'f1-score': 0.4657833563681955, 'support': 177602}}
[[28610 12833 17224]
 [17924 23715 18911]
 [14534 13140 30711]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0352154
{'0': {'precision': 0.4565291015530505, 'recall': 0.4814531353640492, 'f1-score': 0.468659978146419, 'support': 19599}, '1': {'precision': 0.4870879697669536, 'recall': 0.42555142844040905, 'f1-score': 0.45424508676179054, 'support': 21807}, '2': {'precision': 0.44145464863331124, 'recall': 0.4796773033245979, 'f1-score': 0.45977294555125964, 'support': 19461}, 'accuracy': 0.4608572789853287, 'macro avg': {'precision': 0.4616905733177718, 'recall': 0.46222728904301874, 'f1-score': 0.4608926701531564, 'support': 60867}, 'weighted avg': {'precision': 0.46265776422526267, 'recall': 0.4608572789853287, 'f1-score': 0.46065406233392636, 'support': 60867}}
[[9436 4719 5444]
 [6160 9280 6367]
 [5073 5053 9335]]
training model: results/PCAR/W5/deepOF_L2/h30
Epoch 1/50
694/694 - 25s - loss: 3.2797 - accuracy30: 0.3815 - val_loss: 3.2615 - val_accuracy30: 0.3887 - 25s/epoch - 36ms/step
Epoch 2/50
694/694 - 23s - loss: 3.2232 - accuracy30: 0.4114 - val_loss: 3.2354 - val_accuracy30: 0.3980 - 23s/epoch - 33ms/step
Epoch 3/50
694/694 - 23s - loss: 3.2008 - accuracy30: 0.4215 - val_loss: 3.2249 - val_accuracy30: 0.4041 - 23s/epoch - 33ms/step
Epoch 4/50
694/694 - 23s - loss: 3.1892 - accuracy30: 0.4267 - val_loss: 3.2117 - val_accuracy30: 0.4107 - 23s/epoch - 33ms/step
Epoch 5/50
694/694 - 22s - loss: 3.1792 - accuracy30: 0.4309 - val_loss: 3.2023 - val_accuracy30: 0.4161 - 22s/epoch - 32ms/step
Epoch 6/50
694/694 - 23s - loss: 3.1714 - accuracy30: 0.4348 - val_loss: 3.1982 - val_accuracy30: 0.4223 - 23s/epoch - 33ms/step
Epoch 7/50
694/694 - 22s - loss: 3.1623 - accuracy30: 0.4384 - val_loss: 3.1904 - val_accuracy30: 0.4246 - 22s/epoch - 32ms/step
Epoch 8/50
694/694 - 23s - loss: 3.1563 - accuracy30: 0.4411 - val_loss: 3.1846 - val_accuracy30: 0.4270 - 23s/epoch - 33ms/step
Epoch 9/50
694/694 - 23s - loss: 3.1487 - accuracy30: 0.4436 - val_loss: 3.1827 - val_accuracy30: 0.4284 - 23s/epoch - 33ms/step
Epoch 10/50
694/694 - 23s - loss: 3.1452 - accuracy30: 0.4449 - val_loss: 3.1796 - val_accuracy30: 0.4283 - 23s/epoch - 32ms/step
Epoch 11/50
694/694 - 22s - loss: 3.1377 - accuracy30: 0.4478 - val_loss: 3.1782 - val_accuracy30: 0.4295 - 22s/epoch - 32ms/step
Epoch 12/50
694/694 - 22s - loss: 3.1332 - accuracy30: 0.4503 - val_loss: 3.1750 - val_accuracy30: 0.4284 - 22s/epoch - 31ms/step
Epoch 13/50
694/694 - 22s - loss: 3.1280 - accuracy30: 0.4521 - val_loss: 3.1740 - val_accuracy30: 0.4323 - 22s/epoch - 32ms/step
Epoch 14/50
694/694 - 22s - loss: 3.1232 - accuracy30: 0.4539 - val_loss: 3.1716 - val_accuracy30: 0.4328 - 22s/epoch - 32ms/step
Epoch 15/50
694/694 - 23s - loss: 3.1182 - accuracy30: 0.4554 - val_loss: 3.1717 - val_accuracy30: 0.4328 - 23s/epoch - 32ms/step
Epoch 16/50
694/694 - 22s - loss: 3.1128 - accuracy30: 0.4570 - val_loss: 3.1689 - val_accuracy30: 0.4336 - 22s/epoch - 31ms/step
Epoch 17/50
694/694 - 21s - loss: 3.1082 - accuracy30: 0.4603 - val_loss: 3.1677 - val_accuracy30: 0.4332 - 21s/epoch - 31ms/step
Epoch 18/50
694/694 - 22s - loss: 3.1021 - accuracy30: 0.4622 - val_loss: 3.1683 - val_accuracy30: 0.4342 - 22s/epoch - 32ms/step
Epoch 19/50
694/694 - 22s - loss: 3.0974 - accuracy30: 0.4640 - val_loss: 3.1694 - val_accuracy30: 0.4331 - 22s/epoch - 32ms/step
Epoch 20/50
694/694 - 22s - loss: 3.0917 - accuracy30: 0.4665 - val_loss: 3.1708 - val_accuracy30: 0.4317 - 22s/epoch - 32ms/step
Epoch 21/50
694/694 - 22s - loss: 3.0850 - accuracy30: 0.4687 - val_loss: 3.1720 - val_accuracy30: 0.4333 - 22s/epoch - 32ms/step
Epoch 22/50
694/694 - 22s - loss: 3.0812 - accuracy30: 0.4698 - val_loss: 3.1729 - val_accuracy30: 0.4341 - 22s/epoch - 32ms/step
Epoch 23/50
694/694 - 22s - loss: 3.0749 - accuracy30: 0.4715 - val_loss: 3.1731 - val_accuracy30: 0.4338 - 22s/epoch - 32ms/step
Epoch 24/50
694/694 - 22s - loss: 3.0698 - accuracy30: 0.4742 - val_loss: 3.1732 - val_accuracy30: 0.4333 - 22s/epoch - 32ms/step
Epoch 25/50
694/694 - 22s - loss: 3.0627 - accuracy30: 0.4771 - val_loss: 3.1823 - val_accuracy30: 0.4331 - 22s/epoch - 31ms/step
Epoch 26/50
694/694 - 22s - loss: 3.0566 - accuracy30: 0.4777 - val_loss: 3.1845 - val_accuracy30: 0.4319 - 22s/epoch - 31ms/step
Epoch 27/50
694/694 - 22s - loss: 3.0492 - accuracy30: 0.4811 - val_loss: 3.1884 - val_accuracy30: 0.4320 - 22s/epoch - 31ms/step
testing model: results/PCAR/W5/deepOF_L2/h30
Evaluating performance on  test set...
2900/2900 - 45s - 45s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0868593
{'0': {'precision': 0.4446006683257643, 'recall': 0.3618291320052331, 'f1-score': 0.3989670863929614, 'support': 262179}, '1': {'precision': 0.3315549119363833, 'recall': 0.24155163877153446, 'f1-score': 0.27948601258198363, 'support': 216107}, '2': {'precision': 0.408350626175846, 'recall': 0.5745473686602264, 'f1-score': 0.47739801890473377, 'support': 264067}, 'accuracy': 0.402482376982379, 'macro avg': {'precision': 0.3948354021459979, 'recall': 0.3926427131456647, 'f1-score': 0.385283705959893, 'support': 742353}, 'weighted avg': {'precision': 0.39879709622941334, 'recall': 0.402482376982379, 'f1-score': 0.3920840060221906, 'support': 742353}}
[[ 94864  53148 114167]
 [ 58251  52201 105655]
 [ 60254  52094 151719]]
Evaluating performance on  train set...
694/694 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0475677
{'0': {'precision': 0.4806666528299537, 'recall': 0.388449990774753, 'f1-score': 0.42966604823747684, 'support': 59619}, '1': {'precision': 0.4192742285962625, 'recall': 0.39145871373503754, 'f1-score': 0.40488930857202815, 'support': 59148}, '2': {'precision': 0.4433737213094869, 'recall': 0.5591399677062973, 'f1-score': 0.49457273437969806, 'support': 58835}, 'accuracy': 0.4459972297609261, 'macro avg': {'precision': 0.44777153424523436, 'recall': 0.4463495574053626, 'f1-score': 0.4430426970630677, 'support': 177602}, 'weighted avg': {'precision': 0.44786652256914006, 'recall': 0.4459972297609261, 'f1-score': 0.44291640736319404, 'support': 177602}}
[[23159 16936 19524]
 [14218 23154 21776]
 [10804 15134 32897]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0565618
{'0': {'precision': 0.4537622748358335, 'recall': 0.3795797006501033, 'f1-score': 0.4133691893968498, 'support': 19843}, '1': {'precision': 0.42811751478711446, 'recall': 0.4114441416893733, 'f1-score': 0.4196152648348226, 'support': 21286}, '2': {'precision': 0.4228297845533577, 'recall': 0.5100820751849224, 'f1-score': 0.4623757147121632, 'support': 19738}, 'accuracy': 0.43304253536399034, 'macro avg': {'precision': 0.43490319139210193, 'recall': 0.433701972508133, 'f1-score': 0.43178672298127857, 'support': 60867}, 'weighted avg': {'precision': 0.4347631479593233, 'recall': 0.43304253536399034, 'f1-score': 0.431445400783091, 'support': 60867}}
[[ 7532  5957  6354]
 [ 5139  8758  7389]
 [ 3928  5742 10068]]
training model: results/PCAR/W5/deepOF_L2/h50
Epoch 1/50
694/694 - 24s - loss: 3.2923 - accuracy50: 0.3748 - val_loss: 3.2897 - val_accuracy50: 0.3729 - 24s/epoch - 35ms/step
Epoch 2/50
694/694 - 22s - loss: 3.2465 - accuracy50: 0.3980 - val_loss: 3.2699 - val_accuracy50: 0.3793 - 22s/epoch - 32ms/step
Epoch 3/50
694/694 - 23s - loss: 3.2296 - accuracy50: 0.4058 - val_loss: 3.2638 - val_accuracy50: 0.3841 - 23s/epoch - 33ms/step
Epoch 4/50
694/694 - 22s - loss: 3.2196 - accuracy50: 0.4117 - val_loss: 3.2544 - val_accuracy50: 0.3878 - 22s/epoch - 32ms/step
Epoch 5/50
694/694 - 22s - loss: 3.2114 - accuracy50: 0.4162 - val_loss: 3.2439 - val_accuracy50: 0.3904 - 22s/epoch - 32ms/step
Epoch 6/50
694/694 - 22s - loss: 3.2042 - accuracy50: 0.4197 - val_loss: 3.2374 - val_accuracy50: 0.3941 - 22s/epoch - 32ms/step
Epoch 7/50
694/694 - 23s - loss: 3.1945 - accuracy50: 0.4236 - val_loss: 3.2301 - val_accuracy50: 0.3970 - 23s/epoch - 33ms/step
Epoch 8/50
694/694 - 22s - loss: 3.1898 - accuracy50: 0.4257 - val_loss: 3.2254 - val_accuracy50: 0.4018 - 22s/epoch - 32ms/step
Epoch 9/50
694/694 - 22s - loss: 3.1823 - accuracy50: 0.4304 - val_loss: 3.2216 - val_accuracy50: 0.4026 - 22s/epoch - 32ms/step
Epoch 10/50
694/694 - 23s - loss: 3.1768 - accuracy50: 0.4328 - val_loss: 3.2190 - val_accuracy50: 0.4047 - 23s/epoch - 32ms/step
Epoch 11/50
694/694 - 23s - loss: 3.1719 - accuracy50: 0.4357 - val_loss: 3.2167 - val_accuracy50: 0.4062 - 23s/epoch - 33ms/step
Epoch 12/50
694/694 - 22s - loss: 3.1672 - accuracy50: 0.4361 - val_loss: 3.2179 - val_accuracy50: 0.4074 - 22s/epoch - 32ms/step
Epoch 13/50
694/694 - 22s - loss: 3.1627 - accuracy50: 0.4386 - val_loss: 3.2189 - val_accuracy50: 0.4052 - 22s/epoch - 32ms/step
Epoch 14/50
694/694 - 23s - loss: 3.1577 - accuracy50: 0.4414 - val_loss: 3.2172 - val_accuracy50: 0.4072 - 23s/epoch - 32ms/step
Epoch 15/50
694/694 - 22s - loss: 3.1530 - accuracy50: 0.4426 - val_loss: 3.2199 - val_accuracy50: 0.4056 - 22s/epoch - 32ms/step
Epoch 16/50
694/694 - 22s - loss: 3.1482 - accuracy50: 0.4445 - val_loss: 3.2190 - val_accuracy50: 0.4058 - 22s/epoch - 32ms/step
Epoch 17/50
694/694 - 22s - loss: 3.1435 - accuracy50: 0.4462 - val_loss: 3.2236 - val_accuracy50: 0.4039 - 22s/epoch - 32ms/step
Epoch 18/50
694/694 - 22s - loss: 3.1388 - accuracy50: 0.4493 - val_loss: 3.2193 - val_accuracy50: 0.4068 - 22s/epoch - 32ms/step
Epoch 19/50
694/694 - 22s - loss: 3.1324 - accuracy50: 0.4504 - val_loss: 3.2241 - val_accuracy50: 0.4047 - 22s/epoch - 32ms/step
Epoch 20/50
694/694 - 22s - loss: 3.1268 - accuracy50: 0.4538 - val_loss: 3.2285 - val_accuracy50: 0.4047 - 22s/epoch - 32ms/step
Epoch 21/50
694/694 - 22s - loss: 3.1207 - accuracy50: 0.4560 - val_loss: 3.2324 - val_accuracy50: 0.4036 - 22s/epoch - 32ms/step
testing model: results/PCAR/W5/deepOF_L2/h50
Evaluating performance on  test set...
2900/2900 - 46s - 46s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0900887
{'0': {'precision': 0.44657433250829426, 'recall': 0.3866821938181359, 'f1-score': 0.4144758238101773, 'support': 285092}, '1': {'precision': 0.24008829200635973, 'recall': 0.1655180857762541, 'f1-score': 0.19594837106570956, 'support': 171516}, '2': {'precision': 0.4244351255924422, 'recall': 0.560356261701867, 'f1-score': 0.4830157602523088, 'support': 285745}, 'accuracy': 0.40243388253297285, 'macro avg': {'precision': 0.3703659167023654, 'recall': 0.3708521804320857, 'f1-score': 0.3644799850427319, 'support': 742353}, 'weighted avg': {'precision': 0.3903452509219062, 'recall': 0.40243388253297285, 'f1-score': 0.3903686801113396, 'support': 742353}}
[[110240  43898 130954]
 [ 56948  28389  86179]
 [ 79669  45957 160119]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.069613
{'0': {'precision': 0.4348477197137235, 'recall': 0.42071568164970685, 'f1-score': 0.42766498548590115, 'support': 59356}, '1': {'precision': 0.40997842502696874, 'recall': 0.25342579935318243, 'f1-score': 0.3132301732841572, 'support': 59986}, '2': {'precision': 0.39786990793669896, 'recall': 0.5674733951253004, 'f1-score': 0.4677726291959959, 'support': 58260}, 'accuracy': 0.4123545906014572, 'macro avg': {'precision': 0.41423201755913036, 'recall': 0.41387162537606326, 'f1-score': 0.40288926265535135, 'support': 177602}, 'weighted avg': {'precision': 0.41431790121388046, 'recall': 0.4123545906014572, 'f1-score': 0.4021708169394676, 'support': 177602}}
[[24972 11110 23274]
 [18024 15202 26760]
 [14431 10768 33061]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0729439
{'0': {'precision': 0.4096433354829109, 'recall': 0.4180419155614053, 'f1-score': 0.4138000150326961, 'support': 19754}, '1': {'precision': 0.4275964391691395, 'recall': 0.2695221172729823, 'f1-score': 0.3306372970802501, 'support': 21386}, '2': {'precision': 0.3898560305567798, 'recall': 0.5380949967050236, 'f1-score': 0.45213502289426044, 'support': 19727}, 'accuracy': 0.4047677723561207, 'macro avg': {'precision': 0.40903193506961005, 'recall': 0.4085530098464704, 'f1-score': 0.3988574450024022, 'support': 60867}, 'weighted avg': {'precision': 0.40953820316418144, 'recall': 0.4047677723561207, 'f1-score': 0.39700465488604963, 'support': 60867}}
[[ 8258  3885  7611]
 [ 6620  5764  9002]
 [ 5281  3831 10615]]
training model: results/PCAR/W5/deepOF_L2/h100
Epoch 1/50
694/694 - 24s - loss: 3.3129 - accuracy100: 0.3556 - val_loss: 3.3047 - val_accuracy100: 0.3609 - 24s/epoch - 35ms/step
Epoch 2/50
694/694 - 22s - loss: 3.2787 - accuracy100: 0.3742 - val_loss: 3.2910 - val_accuracy100: 0.3680 - 22s/epoch - 32ms/step
Epoch 3/50
694/694 - 22s - loss: 3.2640 - accuracy100: 0.3820 - val_loss: 3.2851 - val_accuracy100: 0.3706 - 22s/epoch - 32ms/step
Epoch 4/50
694/694 - 22s - loss: 3.2553 - accuracy100: 0.3875 - val_loss: 3.2800 - val_accuracy100: 0.3734 - 22s/epoch - 31ms/step
Epoch 5/50
694/694 - 23s - loss: 3.2496 - accuracy100: 0.3926 - val_loss: 3.2771 - val_accuracy100: 0.3727 - 23s/epoch - 34ms/step
Epoch 6/50
694/694 - 24s - loss: 3.2435 - accuracy100: 0.3970 - val_loss: 3.2733 - val_accuracy100: 0.3775 - 24s/epoch - 35ms/step
Epoch 7/50
694/694 - 22s - loss: 3.2382 - accuracy100: 0.3995 - val_loss: 3.2718 - val_accuracy100: 0.3775 - 22s/epoch - 32ms/step
Epoch 8/50
694/694 - 22s - loss: 3.2353 - accuracy100: 0.4007 - val_loss: 3.2696 - val_accuracy100: 0.3781 - 22s/epoch - 32ms/step
Epoch 9/50
694/694 - 22s - loss: 3.2303 - accuracy100: 0.4045 - val_loss: 3.2675 - val_accuracy100: 0.3804 - 22s/epoch - 32ms/step
Epoch 10/50
694/694 - 22s - loss: 3.2274 - accuracy100: 0.4054 - val_loss: 3.2664 - val_accuracy100: 0.3818 - 22s/epoch - 32ms/step
Epoch 11/50
694/694 - 22s - loss: 3.2233 - accuracy100: 0.4089 - val_loss: 3.2667 - val_accuracy100: 0.3805 - 22s/epoch - 32ms/step
Epoch 12/50
694/694 - 22s - loss: 3.2203 - accuracy100: 0.4105 - val_loss: 3.2677 - val_accuracy100: 0.3830 - 22s/epoch - 32ms/step
Epoch 13/50
694/694 - 22s - loss: 3.2165 - accuracy100: 0.4122 - val_loss: 3.2681 - val_accuracy100: 0.3834 - 22s/epoch - 32ms/step
Epoch 14/50
694/694 - 22s - loss: 3.2136 - accuracy100: 0.4146 - val_loss: 3.2671 - val_accuracy100: 0.3815 - 22s/epoch - 32ms/step
Epoch 15/50
694/694 - 22s - loss: 3.2098 - accuracy100: 0.4160 - val_loss: 3.2681 - val_accuracy100: 0.3811 - 22s/epoch - 32ms/step
Epoch 16/50
694/694 - 22s - loss: 3.2056 - accuracy100: 0.4185 - val_loss: 3.2684 - val_accuracy100: 0.3836 - 22s/epoch - 32ms/step
Epoch 17/50
694/694 - 22s - loss: 3.2032 - accuracy100: 0.4208 - val_loss: 3.2720 - val_accuracy100: 0.3828 - 22s/epoch - 32ms/step
Epoch 18/50
694/694 - 22s - loss: 3.1993 - accuracy100: 0.4223 - val_loss: 3.2725 - val_accuracy100: 0.3859 - 22s/epoch - 32ms/step
Epoch 19/50
694/694 - 22s - loss: 3.1961 - accuracy100: 0.4238 - val_loss: 3.2737 - val_accuracy100: 0.3815 - 22s/epoch - 32ms/step
Epoch 20/50
694/694 - 22s - loss: 3.1909 - accuracy100: 0.4267 - val_loss: 3.2778 - val_accuracy100: 0.3836 - 22s/epoch - 32ms/step
testing model: results/PCAR/W5/deepOF_L2/h100
Evaluating performance on  test set...
2900/2900 - 46s - 46s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0978643
{'0': {'precision': 0.394218327564986, 'recall': 0.28525104284017905, 'f1-score': 0.33099708078840795, 'support': 262744}, '1': {'precision': 0.31072999892690256, 'recall': 0.14592266813267363, 'f1-score': 0.19858660107797385, 'support': 218280}, '2': {'precision': 0.3722739077842607, 'recall': 0.640656031286233, 'f1-score': 0.47091020832366465, 'support': 261329}, 'accuracy': 0.3693956918069975, 'macro avg': {'precision': 0.3590740780920498, 'recall': 0.35727658075302854, 'f1-score': 0.33349796339668214, 'support': 742353}, 'weighted avg': {'precision': 0.3619445364548295, 'recall': 0.3693956918069975, 'f1-score': 0.3413166971898606, 'support': 742353}}
[[ 74948  34977 152819]
 [ 56941  31852 129487]
 [ 58229  35678 167422]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0825007
{'0': {'precision': 0.4181243830207305, 'recall': 0.34883299566800086, 'f1-score': 0.380348596007579, 'support': 60711}, '1': {'precision': 0.37682104805392475, 'recall': 0.24200530652143556, 'f1-score': 0.2947278911564626, 'support': 57288}, '2': {'precision': 0.38315217391304346, 'recall': 0.5795849202221365, 'f1-score': 0.4613288996614651, 'support': 59603}, 'accuracy': 0.3918142813707053, 'macro avg': {'precision': 0.3926992016625663, 'recall': 0.39014107413719096, 'f1-score': 0.3788017956085022, 'support': 177602}, 'weighted avg': {'precision': 0.3930647889112957, 'recall': 0.3918142813707053, 'f1-score': 0.37990732901267926, 'support': 177602}}
[[21178 11515 28018]
 [15827 13864 27597]
 [13645 11413 34545]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0886431
{'0': {'precision': 0.39005264926627087, 'recall': 0.3400058588028513, 'f1-score': 0.3633138564273789, 'support': 20482}, '1': {'precision': 0.3800149700598802, 'recall': 0.2529016189290162, 'f1-score': 0.30369373411096157, 'support': 20075}, '2': {'precision': 0.37368900279904227, 'recall': 0.5455933037912358, 'f1-score': 0.4435682404979685, 'support': 20310}, 'accuracy': 0.37987743769201704, 'macro avg': {'precision': 0.38125220737506443, 'recall': 0.3795002605077011, 'f1-score': 0.3701919436787697, 'support': 60867}, 'weighted avg': {'precision': 0.38128185277855653, 'recall': 0.37987743769201704, 'f1-score': 0.3704292487577319, 'support': 60867}}
[[ 6964  4185  9333]
 [ 5759  5077  9239]
 [ 5131  4098 11081]]
training model: results/PCAR/W5/deepOF_L2/h200
Epoch 1/50
694/694 - 25s - loss: 3.3192 - accuracy200: 0.3533 - val_loss: 3.3060 - val_accuracy200: 0.3456 - 25s/epoch - 36ms/step
Epoch 2/50
694/694 - 22s - loss: 3.2887 - accuracy200: 0.3681 - val_loss: 3.2906 - val_accuracy200: 0.3532 - 22s/epoch - 32ms/step
Epoch 3/50
694/694 - 22s - loss: 3.2731 - accuracy200: 0.3772 - val_loss: 3.2831 - val_accuracy200: 0.3591 - 22s/epoch - 32ms/step
Epoch 4/50
694/694 - 23s - loss: 3.2657 - accuracy200: 0.3821 - val_loss: 3.2747 - val_accuracy200: 0.3677 - 23s/epoch - 33ms/step
Epoch 5/50
694/694 - 23s - loss: 3.2574 - accuracy200: 0.3868 - val_loss: 3.2688 - val_accuracy200: 0.3753 - 23s/epoch - 33ms/step
Epoch 6/50
694/694 - 23s - loss: 3.2514 - accuracy200: 0.3913 - val_loss: 3.2663 - val_accuracy200: 0.3804 - 23s/epoch - 32ms/step
Epoch 7/50
694/694 - 22s - loss: 3.2459 - accuracy200: 0.3943 - val_loss: 3.2667 - val_accuracy200: 0.3816 - 22s/epoch - 31ms/step
Epoch 8/50
694/694 - 23s - loss: 3.2428 - accuracy200: 0.3969 - val_loss: 3.2625 - val_accuracy200: 0.3834 - 23s/epoch - 33ms/step
Epoch 9/50
694/694 - 22s - loss: 3.2392 - accuracy200: 0.3990 - val_loss: 3.2631 - val_accuracy200: 0.3837 - 22s/epoch - 32ms/step
Epoch 10/50
694/694 - 22s - loss: 3.2355 - accuracy200: 0.4002 - val_loss: 3.2611 - val_accuracy200: 0.3875 - 22s/epoch - 32ms/step
Epoch 11/50
694/694 - 21s - loss: 3.2331 - accuracy200: 0.4018 - val_loss: 3.2596 - val_accuracy200: 0.3879 - 21s/epoch - 31ms/step
Epoch 12/50
694/694 - 21s - loss: 3.2307 - accuracy200: 0.4034 - val_loss: 3.2599 - val_accuracy200: 0.3870 - 21s/epoch - 31ms/step
Epoch 13/50
694/694 - 21s - loss: 3.2273 - accuracy200: 0.4060 - val_loss: 3.2591 - val_accuracy200: 0.3874 - 21s/epoch - 30ms/step
Epoch 14/50
694/694 - 21s - loss: 3.2243 - accuracy200: 0.4076 - val_loss: 3.2619 - val_accuracy200: 0.3858 - 21s/epoch - 31ms/step
Epoch 15/50
694/694 - 21s - loss: 3.2213 - accuracy200: 0.4104 - val_loss: 3.2572 - val_accuracy200: 0.3908 - 21s/epoch - 31ms/step
Epoch 16/50
694/694 - 21s - loss: 3.2189 - accuracy200: 0.4096 - val_loss: 3.2619 - val_accuracy200: 0.3906 - 21s/epoch - 30ms/step
Epoch 17/50
694/694 - 22s - loss: 3.2160 - accuracy200: 0.4102 - val_loss: 3.2600 - val_accuracy200: 0.3884 - 22s/epoch - 31ms/step
Epoch 18/50
694/694 - 21s - loss: 3.2122 - accuracy200: 0.4136 - val_loss: 3.2598 - val_accuracy200: 0.3891 - 21s/epoch - 31ms/step
Epoch 19/50
694/694 - 21s - loss: 3.2099 - accuracy200: 0.4147 - val_loss: 3.2605 - val_accuracy200: 0.3913 - 21s/epoch - 31ms/step
Epoch 20/50
694/694 - 21s - loss: 3.2057 - accuracy200: 0.4176 - val_loss: 3.2588 - val_accuracy200: 0.3929 - 21s/epoch - 31ms/step
Epoch 21/50
694/694 - 21s - loss: 3.2026 - accuracy200: 0.4186 - val_loss: 3.2594 - val_accuracy200: 0.3909 - 21s/epoch - 31ms/step
Epoch 22/50
694/694 - 21s - loss: 3.1987 - accuracy200: 0.4208 - val_loss: 3.2609 - val_accuracy200: 0.3907 - 21s/epoch - 31ms/step
Epoch 23/50
694/694 - 22s - loss: 3.1943 - accuracy200: 0.4237 - val_loss: 3.2639 - val_accuracy200: 0.3894 - 22s/epoch - 31ms/step
Epoch 24/50
694/694 - 22s - loss: 3.1907 - accuracy200: 0.4246 - val_loss: 3.2642 - val_accuracy200: 0.3895 - 22s/epoch - 31ms/step
Epoch 25/50
694/694 - 22s - loss: 3.1856 - accuracy200: 0.4273 - val_loss: 3.2704 - val_accuracy200: 0.3843 - 22s/epoch - 32ms/step
testing model: results/PCAR/W5/deepOF_L2/h200
Evaluating performance on  test set...
2900/2900 - 44s - 44s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1015023
{'0': {'precision': 0.3793500853031912, 'recall': 0.28623180150828187, 'f1-score': 0.32627708316650395, 'support': 263346}, '1': {'precision': 0.3208882912456248, 'recall': 0.2955858846674044, 'f1-score': 0.3077178352419127, 'support': 219591}, '2': {'precision': 0.36345181531106646, 'recall': 0.47827813242051376, 'f1-score': 0.41303284009387636, 'support': 259416}, 'accuracy': 0.35610955973775277, 'macro avg': {'precision': 0.3545633972866275, 'recall': 0.35336527286540004, 'f1-score': 0.3490092528340976, 'support': 742353}, 'weighted avg': {'precision': 0.35650118534970265, 'recall': 0.35610955973775277, 'f1-score': 0.3511040692877459, 'support': 742353}}
[[ 75378  68188 119780]
 [ 57162  64908  97521]
 [ 66163  69180 124073]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0839863
{'0': {'precision': 0.4178687496436513, 'recall': 0.2448427347286485, 'f1-score': 0.3087682342408763, 'support': 59867}, '1': {'precision': 0.3811468733272825, 'recall': 0.5583492431474157, 'f1-score': 0.45303661083525815, 'support': 58664}, '2': {'precision': 0.38389354257236774, 'recall': 0.36774390140678165, 'f1-score': 0.37564522683451934, 'support': 59071}, 'accuracy': 0.389274895552978, 'macro avg': {'precision': 0.3943030551811005, 'recall': 0.3903119597609486, 'f1-score': 0.3791500239702179, 'support': 177602}, 'weighted avg': {'precision': 0.3944388242535586, 'recall': 0.389274895552978, 'f1-score': 0.3786652560876568, 'support': 177602}}
[[14658 26490 18719]
 [ 9765 32755 16144]
 [10655 26693 21723]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0864369
{'0': {'precision': 0.38554630503819415, 'recall': 0.22629722921914358, 'f1-score': 0.285197295323958, 'support': 19850}, '1': {'precision': 0.4004589056375283, 'recall': 0.5973569119604487, 'f1-score': 0.4794810645807498, 'support': 21036}, '2': {'precision': 0.3738296798789034, 'recall': 0.33371703117962065, 'f1-score': 0.35263631075149404, 'support': 19981}, 'accuracy': 0.38980071303004915, 'macro avg': {'precision': 0.38661163018487527, 'recall': 0.38579039078640437, 'f1-score': 0.3724382235520673, 'support': 60867}, 'weighted avg': {'precision': 0.38685393608457075, 'recall': 0.38980071303004915, 'f1-score': 0.3744813464081821, 'support': 60867}}
[[ 4492  9328  6030]
 [ 3331 12566  5139]
 [ 3828  9485  6668]]
training model: results/PCAR/W5/deepOF_L2/h300
Epoch 1/50
694/694 - 25s - loss: 3.3242 - accuracy300: 0.3527 - val_loss: 3.3187 - val_accuracy300: 0.3318 - 25s/epoch - 36ms/step
Epoch 2/50
694/694 - 22s - loss: 3.2929 - accuracy300: 0.3651 - val_loss: 3.3052 - val_accuracy300: 0.3336 - 22s/epoch - 32ms/step
Epoch 3/50
694/694 - 22s - loss: 3.2790 - accuracy300: 0.3725 - val_loss: 3.2930 - val_accuracy300: 0.3374 - 22s/epoch - 32ms/step
Epoch 4/50
694/694 - 22s - loss: 3.2693 - accuracy300: 0.3793 - val_loss: 3.2843 - val_accuracy300: 0.3460 - 22s/epoch - 32ms/step
Epoch 5/50
694/694 - 22s - loss: 3.2612 - accuracy300: 0.3847 - val_loss: 3.2770 - val_accuracy300: 0.3567 - 22s/epoch - 32ms/step
Epoch 6/50
694/694 - 22s - loss: 3.2548 - accuracy300: 0.3870 - val_loss: 3.2747 - val_accuracy300: 0.3635 - 22s/epoch - 31ms/step
Epoch 7/50
694/694 - 21s - loss: 3.2486 - accuracy300: 0.3924 - val_loss: 3.2723 - val_accuracy300: 0.3697 - 21s/epoch - 30ms/step
Epoch 8/50
694/694 - 21s - loss: 3.2438 - accuracy300: 0.3947 - val_loss: 3.2689 - val_accuracy300: 0.3787 - 21s/epoch - 30ms/step
Epoch 9/50
694/694 - 21s - loss: 3.2408 - accuracy300: 0.3961 - val_loss: 3.2685 - val_accuracy300: 0.3766 - 21s/epoch - 30ms/step
Epoch 10/50
694/694 - 22s - loss: 3.2380 - accuracy300: 0.3984 - val_loss: 3.2667 - val_accuracy300: 0.3804 - 22s/epoch - 31ms/step
Epoch 11/50
694/694 - 22s - loss: 3.2339 - accuracy300: 0.4004 - val_loss: 3.2669 - val_accuracy300: 0.3848 - 22s/epoch - 31ms/step
Epoch 12/50
694/694 - 21s - loss: 3.2310 - accuracy300: 0.4040 - val_loss: 3.2666 - val_accuracy300: 0.3804 - 21s/epoch - 31ms/step
Epoch 13/50
694/694 - 21s - loss: 3.2285 - accuracy300: 0.4029 - val_loss: 3.2667 - val_accuracy300: 0.3792 - 21s/epoch - 30ms/step
Epoch 14/50
694/694 - 22s - loss: 3.2246 - accuracy300: 0.4062 - val_loss: 3.2658 - val_accuracy300: 0.3832 - 22s/epoch - 31ms/step
Epoch 15/50
694/694 - 21s - loss: 3.2235 - accuracy300: 0.4051 - val_loss: 3.2652 - val_accuracy300: 0.3845 - 21s/epoch - 31ms/step
Epoch 16/50
694/694 - 21s - loss: 3.2202 - accuracy300: 0.4090 - val_loss: 3.2653 - val_accuracy300: 0.3857 - 21s/epoch - 31ms/step
Epoch 17/50
694/694 - 21s - loss: 3.2160 - accuracy300: 0.4107 - val_loss: 3.2648 - val_accuracy300: 0.3852 - 21s/epoch - 30ms/step
Epoch 18/50
694/694 - 21s - loss: 3.2127 - accuracy300: 0.4132 - val_loss: 3.2656 - val_accuracy300: 0.3864 - 21s/epoch - 30ms/step
Epoch 19/50
694/694 - 21s - loss: 3.2087 - accuracy300: 0.4152 - val_loss: 3.2652 - val_accuracy300: 0.3889 - 21s/epoch - 30ms/step
Epoch 20/50
694/694 - 21s - loss: 3.2058 - accuracy300: 0.4187 - val_loss: 3.2696 - val_accuracy300: 0.3836 - 21s/epoch - 30ms/step
Epoch 21/50
694/694 - 21s - loss: 3.2018 - accuracy300: 0.4207 - val_loss: 3.2724 - val_accuracy300: 0.3811 - 21s/epoch - 30ms/step
Epoch 22/50
694/694 - 21s - loss: 3.1983 - accuracy300: 0.4216 - val_loss: 3.2732 - val_accuracy300: 0.3809 - 21s/epoch - 31ms/step
Epoch 23/50
694/694 - 21s - loss: 3.1942 - accuracy300: 0.4253 - val_loss: 3.2763 - val_accuracy300: 0.3787 - 21s/epoch - 30ms/step
Epoch 24/50
694/694 - 21s - loss: 3.1889 - accuracy300: 0.4282 - val_loss: 3.2808 - val_accuracy300: 0.3797 - 21s/epoch - 31ms/step
Epoch 25/50
694/694 - 21s - loss: 3.1850 - accuracy300: 0.4294 - val_loss: 3.2903 - val_accuracy300: 0.3720 - 21s/epoch - 30ms/step
Epoch 26/50
694/694 - 21s - loss: 3.1802 - accuracy300: 0.4331 - val_loss: 3.2897 - val_accuracy300: 0.3748 - 21s/epoch - 31ms/step
Epoch 27/50
694/694 - 21s - loss: 3.1755 - accuracy300: 0.4348 - val_loss: 3.3007 - val_accuracy300: 0.3686 - 21s/epoch - 31ms/step
testing model: results/PCAR/W5/deepOF_L2/h300
Evaluating performance on  test set...
2900/2900 - 41s - 41s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1028657
{'0': {'precision': 0.3770186272830763, 'recall': 0.2785933359140041, 'f1-score': 0.32041781716218243, 'support': 268664}, '1': {'precision': 0.30191425867967103, 'recall': 0.29661764355350034, 'f1-score': 0.29924251533004687, 'support': 209765}, '2': {'precision': 0.361269845029638, 'recall': 0.46231490883739257, 'f1-score': 0.4055938012119681, 'support': 263924}, 'accuracy': 0.3490037758317135, 'macro avg': {'precision': 0.34673424366412836, 'recall': 0.345841962768299, 'f1-score': 0.34175137790139914, 'support': 742353}, 'weighted avg': {'precision': 0.350197493014676, 'recall': 0.3490037758317135, 'f1-score': 0.3447164314676917, 'support': 742353}}
[[ 74848  70877 122939]
 [ 54758  62220  92787]
 [ 68920  72988 122016]]
Evaluating performance on  train set...
694/694 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0836558
{'0': {'precision': 0.4124773342443434, 'recall': 0.26403795040877437, 'f1-score': 0.32197253305162105, 'support': 59446}, '1': {'precision': 0.39533479278327166, 'recall': 0.5262875806046394, 'f1-score': 0.4515076839072614, 'support': 59705}, '2': {'precision': 0.3665906404514958, 'recall': 0.3767258045200253, 'f1-score': 0.37158912570242497, 'support': 58451}, 'accuracy': 0.38928615668742467, 'macro avg': {'precision': 0.39146758915970364, 'recall': 0.3890171118444797, 'f1-score': 0.3816897808871025, 'support': 177602}, 'weighted avg': {'precision': 0.39161259974349877, 'recall': 0.38928615668742467, 'f1-score': 0.3818481855716836, 'support': 177602}}
[[15696 23505 20245]
 [10481 31422 17802]
 [11876 24555 22020]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0885361
{'0': {'precision': 0.36774083836408467, 'recall': 0.22168118913377755, 'f1-score': 0.27661411531450864, 'support': 19510}, '1': {'precision': 0.41658254256679456, 'recall': 0.5647810218978102, 'f1-score': 0.47949184708935283, 'support': 21920}, '2': {'precision': 0.3570249638951929, 'recall': 0.35612491639656324, 'f1-score': 0.3565743721828718, 'support': 19437}, 'accuracy': 0.3881742159133849, 'macro avg': {'precision': 0.3804494482753573, 'recall': 0.38086237580938365, 'f1-score': 0.37089344486224446, 'support': 60867}, 'weighted avg': {'precision': 0.38190821484184034, 'recall': 0.3881742159133849, 'f1-score': 0.3752105204807722, 'support': 60867}}
[[ 4325  8602  6583]
 [ 3657 12380  5883]
 [ 3779  8736  6922]]
training model: results/PCAR/W5/deepOF_L2/h500
Epoch 1/50
694/694 - 23s - loss: 3.3311 - accuracy500: 0.3472 - val_loss: 3.3199 - val_accuracy500: 0.3344 - 23s/epoch - 34ms/step
Epoch 2/50
694/694 - 21s - loss: 3.3016 - accuracy500: 0.3552 - val_loss: 3.3090 - val_accuracy500: 0.3357 - 21s/epoch - 31ms/step
Epoch 3/50
694/694 - 21s - loss: 3.2897 - accuracy500: 0.3602 - val_loss: 3.2979 - val_accuracy500: 0.3389 - 21s/epoch - 30ms/step
Epoch 4/50
694/694 - 21s - loss: 3.2818 - accuracy500: 0.3649 - val_loss: 3.2919 - val_accuracy500: 0.3472 - 21s/epoch - 31ms/step
Epoch 5/50
694/694 - 22s - loss: 3.2744 - accuracy500: 0.3718 - val_loss: 3.2878 - val_accuracy500: 0.3566 - 22s/epoch - 32ms/step
Epoch 6/50
694/694 - 21s - loss: 3.2685 - accuracy500: 0.3764 - val_loss: 3.2853 - val_accuracy500: 0.3604 - 21s/epoch - 31ms/step
Epoch 7/50
694/694 - 21s - loss: 3.2643 - accuracy500: 0.3797 - val_loss: 3.2846 - val_accuracy500: 0.3666 - 21s/epoch - 30ms/step
Epoch 8/50
694/694 - 28s - loss: 3.2591 - accuracy500: 0.3844 - val_loss: 3.2840 - val_accuracy500: 0.3692 - 28s/epoch - 40ms/step
Epoch 9/50
694/694 - 22s - loss: 3.2564 - accuracy500: 0.3868 - val_loss: 3.2829 - val_accuracy500: 0.3701 - 22s/epoch - 32ms/step
Epoch 10/50
694/694 - 21s - loss: 3.2529 - accuracy500: 0.3894 - val_loss: 3.2813 - val_accuracy500: 0.3714 - 21s/epoch - 30ms/step
Epoch 11/50
694/694 - 21s - loss: 3.2496 - accuracy500: 0.3915 - val_loss: 3.2823 - val_accuracy500: 0.3716 - 21s/epoch - 31ms/step
Epoch 12/50
694/694 - 21s - loss: 3.2468 - accuracy500: 0.3933 - val_loss: 3.2814 - val_accuracy500: 0.3724 - 21s/epoch - 30ms/step
Epoch 13/50
694/694 - 21s - loss: 3.2453 - accuracy500: 0.3953 - val_loss: 3.2819 - val_accuracy500: 0.3717 - 21s/epoch - 31ms/step
Epoch 14/50
694/694 - 21s - loss: 3.2411 - accuracy500: 0.3966 - val_loss: 3.2837 - val_accuracy500: 0.3745 - 21s/epoch - 30ms/step
Epoch 15/50
694/694 - 20s - loss: 3.2389 - accuracy500: 0.3990 - val_loss: 3.2841 - val_accuracy500: 0.3737 - 20s/epoch - 29ms/step
Epoch 16/50
694/694 - 21s - loss: 3.2358 - accuracy500: 0.3987 - val_loss: 3.2856 - val_accuracy500: 0.3726 - 21s/epoch - 30ms/step
Epoch 17/50
694/694 - 21s - loss: 3.2339 - accuracy500: 0.4017 - val_loss: 3.2901 - val_accuracy500: 0.3722 - 21s/epoch - 30ms/step
Epoch 18/50
694/694 - 21s - loss: 3.2308 - accuracy500: 0.4027 - val_loss: 3.2906 - val_accuracy500: 0.3714 - 21s/epoch - 30ms/step
Epoch 19/50
694/694 - 21s - loss: 3.2273 - accuracy500: 0.4055 - val_loss: 3.2901 - val_accuracy500: 0.3728 - 21s/epoch - 30ms/step
Epoch 20/50
694/694 - 21s - loss: 3.2248 - accuracy500: 0.4064 - val_loss: 3.2913 - val_accuracy500: 0.3735 - 21s/epoch - 30ms/step
testing model: results/PCAR/W5/deepOF_L2/h500
Evaluating performance on  test set...
2900/2900 - 43s - 43s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1021928
{'0': {'precision': 0.37191567621272253, 'recall': 0.2661576106894191, 'f1-score': 0.3102721577306815, 'support': 264411}, '1': {'precision': 0.3094457991814285, 'recall': 0.397309524247384, 'f1-score': 0.347916058577827, 'support': 217508}, '2': {'precision': 0.3553565103719743, 'recall': 0.3736800878533525, 'f1-score': 0.36428802707108593, 'support': 260434}, 'accuracy': 0.34230615354150923, 'macro avg': {'precision': 0.3455726619220418, 'recall': 0.3457157409300519, 'f1-score': 0.3408254144598648, 'support': 742353}, 'weighted avg': {'precision': 0.34780279755540977, 'recall': 0.34230615354150923, 'f1-score': 0.34025172068962395, 'support': 742353}}
[[70375 95440 98596]
 [53142 86418 77948]
 [65706 97409 97319]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.092926
{'0': {'precision': 0.39651782316377016, 'recall': 0.20813010836815207, 'f1-score': 0.2729763659188909, 'support': 60073}, '1': {'precision': 0.36427064085865163, 'recall': 0.6184345858475041, 'f1-score': 0.458484511517077, 'support': 58336}, '2': {'precision': 0.3626118942824945, 'recall': 0.2881083911949048, 'f1-score': 0.3210950444344028, 'support': 59193}, 'accuracy': 0.36955664913683406, 'macro avg': {'precision': 0.3744667861016388, 'recall': 0.3715576951368536, 'f1-score': 0.3508519739567902, 'support': 177602}, 'weighted avg': {'precision': 0.37462524720617546, 'recall': 0.36955664913683406, 'f1-score': 0.3499467385441118, 'support': 177602}}
[[12503 31194 16376]
 [ 8658 36077 13601]
 [10371 31768 17054]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0941613
{'0': {'precision': 0.36721754495374703, 'recall': 0.17553535052417152, 'f1-score': 0.23752857334946886, 'support': 20127}, '1': {'precision': 0.3797489539748954, 'recall': 0.650547140058298, 'f1-score': 0.4795603853673142, 'support': 20927}, '2': {'precision': 0.3532086256170434, 'recall': 0.27446625952657344, 'f1-score': 0.3088982930500724, 'support': 19813}, 'accuracy': 0.3710549230288991, 'macro avg': {'precision': 0.3667250415152286, 'recall': 0.366849583369681, 'f1-score': 0.34199575058895176, 'support': 60867}, 'weighted avg': {'precision': 0.3669659484855042, 'recall': 0.3710549230288991, 'f1-score': 0.3439745619233349, 'support': 60867}}
[[ 3533 11137  5457]
 [ 2812 13614  4501]
 [ 3276 11099  5438]]
training model: results/PCAR/W5/deepOF_L2/h1000
Epoch 1/50
694/694 - 24s - loss: 3.3318 - accuracy1000: 0.3490 - val_loss: 3.3201 - val_accuracy1000: 0.3321 - 24s/epoch - 34ms/step
Epoch 2/50
694/694 - 21s - loss: 3.3042 - accuracy1000: 0.3564 - val_loss: 3.3064 - val_accuracy1000: 0.3322 - 21s/epoch - 31ms/step
Epoch 3/50
694/694 - 21s - loss: 3.2915 - accuracy1000: 0.3630 - val_loss: 3.2948 - val_accuracy1000: 0.3353 - 21s/epoch - 31ms/step
Epoch 4/50
694/694 - 21s - loss: 3.2832 - accuracy1000: 0.3687 - val_loss: 3.2832 - val_accuracy1000: 0.3471 - 21s/epoch - 31ms/step
Epoch 5/50
694/694 - 21s - loss: 3.2769 - accuracy1000: 0.3728 - val_loss: 3.2787 - val_accuracy1000: 0.3572 - 21s/epoch - 31ms/step
Epoch 6/50
694/694 - 21s - loss: 3.2711 - accuracy1000: 0.3773 - val_loss: 3.2771 - val_accuracy1000: 0.3628 - 21s/epoch - 31ms/step
Epoch 7/50
694/694 - 22s - loss: 3.2672 - accuracy1000: 0.3804 - val_loss: 3.2764 - val_accuracy1000: 0.3674 - 22s/epoch - 31ms/step
Epoch 8/50
694/694 - 22s - loss: 3.2623 - accuracy1000: 0.3840 - val_loss: 3.2764 - val_accuracy1000: 0.3709 - 22s/epoch - 31ms/step
Epoch 9/50
694/694 - 21s - loss: 3.2593 - accuracy1000: 0.3860 - val_loss: 3.2768 - val_accuracy1000: 0.3765 - 21s/epoch - 31ms/step
Epoch 10/50
694/694 - 21s - loss: 3.2562 - accuracy1000: 0.3877 - val_loss: 3.2752 - val_accuracy1000: 0.3766 - 21s/epoch - 31ms/step
Epoch 11/50
694/694 - 21s - loss: 3.2538 - accuracy1000: 0.3899 - val_loss: 3.2783 - val_accuracy1000: 0.3746 - 21s/epoch - 31ms/step
Epoch 12/50
694/694 - 22s - loss: 3.2499 - accuracy1000: 0.3914 - val_loss: 3.2734 - val_accuracy1000: 0.3789 - 22s/epoch - 31ms/step
Epoch 13/50
694/694 - 22s - loss: 3.2478 - accuracy1000: 0.3928 - val_loss: 3.2763 - val_accuracy1000: 0.3783 - 22s/epoch - 31ms/step
Epoch 14/50
694/694 - 21s - loss: 3.2454 - accuracy1000: 0.3956 - val_loss: 3.2726 - val_accuracy1000: 0.3818 - 21s/epoch - 31ms/step
Epoch 15/50
694/694 - 21s - loss: 3.2427 - accuracy1000: 0.3983 - val_loss: 3.2744 - val_accuracy1000: 0.3801 - 21s/epoch - 30ms/step
Epoch 16/50
694/694 - 22s - loss: 3.2398 - accuracy1000: 0.3991 - val_loss: 3.2732 - val_accuracy1000: 0.3818 - 22s/epoch - 32ms/step
Epoch 17/50
694/694 - 22s - loss: 3.2371 - accuracy1000: 0.3999 - val_loss: 3.2720 - val_accuracy1000: 0.3842 - 22s/epoch - 32ms/step
Epoch 18/50
694/694 - 22s - loss: 3.2347 - accuracy1000: 0.4022 - val_loss: 3.2743 - val_accuracy1000: 0.3800 - 22s/epoch - 32ms/step
Epoch 19/50
694/694 - 22s - loss: 3.2312 - accuracy1000: 0.4049 - val_loss: 3.2747 - val_accuracy1000: 0.3822 - 22s/epoch - 32ms/step
Epoch 20/50
694/694 - 23s - loss: 3.2283 - accuracy1000: 0.4047 - val_loss: 3.2800 - val_accuracy1000: 0.3796 - 23s/epoch - 33ms/step
Epoch 21/50
694/694 - 22s - loss: 3.2245 - accuracy1000: 0.4087 - val_loss: 3.2761 - val_accuracy1000: 0.3817 - 22s/epoch - 31ms/step
Epoch 22/50
694/694 - 22s - loss: 3.2209 - accuracy1000: 0.4102 - val_loss: 3.2806 - val_accuracy1000: 0.3775 - 22s/epoch - 31ms/step
Epoch 23/50
694/694 - 22s - loss: 3.2194 - accuracy1000: 0.4115 - val_loss: 3.2803 - val_accuracy1000: 0.3777 - 22s/epoch - 31ms/step
Epoch 24/50
694/694 - 21s - loss: 3.2144 - accuracy1000: 0.4135 - val_loss: 3.2795 - val_accuracy1000: 0.3767 - 21s/epoch - 30ms/step
Epoch 25/50
694/694 - 22s - loss: 3.2111 - accuracy1000: 0.4162 - val_loss: 3.2806 - val_accuracy1000: 0.3778 - 22s/epoch - 31ms/step
Epoch 26/50
694/694 - 22s - loss: 3.2076 - accuracy1000: 0.4179 - val_loss: 3.2894 - val_accuracy1000: 0.3737 - 22s/epoch - 31ms/step
Epoch 27/50
694/694 - 22s - loss: 3.2020 - accuracy1000: 0.4214 - val_loss: 3.2925 - val_accuracy1000: 0.3766 - 22s/epoch - 32ms/step
testing model: results/PCAR/W5/deepOF_L2/h1000
Evaluating performance on  test set...
2900/2900 - 43s - 43s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1094838
{'0': {'precision': 0.36872245312450924, 'recall': 0.13386138011767032, 'f1-score': 0.19641577460704296, 'support': 263108}, '1': {'precision': 0.3194462912289787, 'recall': 0.40553675026875274, 'f1-score': 0.35737997557232787, 'support': 225114}, '2': {'precision': 0.3410505965899649, 'recall': 0.4845414372902165, 'f1-score': 0.4003264069390734, 'support': 254131}, 'accuracy': 0.3362941888831863, 'macro avg': {'precision': 0.3430731136478176, 'recall': 0.3413131892255465, 'f1-score': 0.31804071903948145, 'support': 742353}, 'weighted avg': {'precision': 0.34430680385531953, 'recall': 0.3362941888831863, 'f1-score': 0.31503226573898474, 'support': 742353}}
[[ 35220  96403 131485]
 [ 27392  91292 106430]
 [ 32907  98087 123137]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0926423
{'0': {'precision': 0.4070801672851505, 'recall': 0.1150280454719462, 'f1-score': 0.1793713825949285, 'support': 60081}, '1': {'precision': 0.37704448482932995, 'recall': 0.6420282542885973, 'f1-score': 0.47508524777857974, 'support': 59460}, '2': {'precision': 0.34892298364686664, 'recall': 0.35683160813627046, 'f1-score': 0.35283298421294634, 'support': 58061}, 'accuracy': 0.3705138455648022, 'macro avg': {'precision': 0.37768254525378236, 'recall': 0.371295969298938, 'f1-score': 0.3357632048621515, 'support': 177602}, 'weighted avg': {'precision': 0.37801188022731624, 'recall': 0.3705138455648022, 'f1-score': 0.33508190654940895, 'support': 177602}}
[[ 6911 31255 21915]
 [ 4541 38175 16744]
 [ 5525 31818 20718]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0912057
{'0': {'precision': 0.36653543307086617, 'recall': 0.09275217932752179, 'f1-score': 0.14804213873981314, 'support': 20075}, '1': {'precision': 0.4041182238408741, 'recall': 0.6785999905913346, 'f1-score': 0.5065669335580839, 'support': 21257}, '2': {'precision': 0.35476806689229545, 'recall': 0.3648835423598669, 'f1-score': 0.3597547126958892, 'support': 19535}, 'accuracy': 0.38469121198679085, 'macro avg': {'precision': 0.3751405746013452, 'recall': 0.37874523742624105, 'f1-score': 0.33812126166459544, 'support': 60867}, 'weighted avg': {'precision': 0.3758840437318102, 'recall': 0.38469121198679085, 'f1-score': 0.3412004461261461, 'support': 60867}}
[[ 1862 10614  7599]
 [ 1467 14425  5365]
 [ 1751 10656  7128]]
training model: results/PCAR/W5/deepVOL_L2/h10
Epoch 1/50
694/694 - 24s - loss: 3.2830 - accuracy10: 0.3811 - val_loss: 3.2673 - val_accuracy10: 0.3873 - 24s/epoch - 35ms/step
Epoch 2/50
694/694 - 21s - loss: 3.2038 - accuracy10: 0.4182 - val_loss: 3.2014 - val_accuracy10: 0.4171 - 21s/epoch - 30ms/step
Epoch 3/50
694/694 - 21s - loss: 3.1500 - accuracy10: 0.4428 - val_loss: 3.1960 - val_accuracy10: 0.4326 - 21s/epoch - 30ms/step
Epoch 4/50
694/694 - 21s - loss: 3.1249 - accuracy10: 0.4546 - val_loss: 3.1644 - val_accuracy10: 0.4466 - 21s/epoch - 31ms/step
Epoch 5/50
694/694 - 21s - loss: 3.1100 - accuracy10: 0.4611 - val_loss: 3.1610 - val_accuracy10: 0.4553 - 21s/epoch - 31ms/step
Epoch 6/50
694/694 - 22s - loss: 3.0925 - accuracy10: 0.4681 - val_loss: 3.1365 - val_accuracy10: 0.4592 - 22s/epoch - 31ms/step
Epoch 7/50
694/694 - 22s - loss: 3.0752 - accuracy10: 0.4734 - val_loss: 3.1463 - val_accuracy10: 0.4608 - 22s/epoch - 31ms/step
Epoch 8/50
694/694 - 22s - loss: 3.0622 - accuracy10: 0.4784 - val_loss: 3.1191 - val_accuracy10: 0.4653 - 22s/epoch - 31ms/step
Epoch 9/50
694/694 - 21s - loss: 3.0526 - accuracy10: 0.4821 - val_loss: 3.1331 - val_accuracy10: 0.4630 - 21s/epoch - 31ms/step
Epoch 10/50
694/694 - 21s - loss: 3.0420 - accuracy10: 0.4858 - val_loss: 3.1270 - val_accuracy10: 0.4643 - 21s/epoch - 31ms/step
Epoch 11/50
694/694 - 22s - loss: 3.0350 - accuracy10: 0.4877 - val_loss: 3.1176 - val_accuracy10: 0.4646 - 22s/epoch - 31ms/step
Epoch 12/50
694/694 - 21s - loss: 3.0296 - accuracy10: 0.4893 - val_loss: 3.1201 - val_accuracy10: 0.4671 - 21s/epoch - 31ms/step
Epoch 13/50
694/694 - 21s - loss: 3.0238 - accuracy10: 0.4914 - val_loss: 3.1239 - val_accuracy10: 0.4653 - 21s/epoch - 31ms/step
Epoch 14/50
694/694 - 21s - loss: 3.0199 - accuracy10: 0.4916 - val_loss: 3.1182 - val_accuracy10: 0.4698 - 21s/epoch - 30ms/step
Epoch 15/50
694/694 - 21s - loss: 3.0133 - accuracy10: 0.4945 - val_loss: 3.1207 - val_accuracy10: 0.4710 - 21s/epoch - 30ms/step
Epoch 16/50
694/694 - 21s - loss: 3.0097 - accuracy10: 0.4951 - val_loss: 3.1198 - val_accuracy10: 0.4680 - 21s/epoch - 30ms/step
Epoch 17/50
694/694 - 21s - loss: 3.0060 - accuracy10: 0.4983 - val_loss: 3.1170 - val_accuracy10: 0.4698 - 21s/epoch - 30ms/step
Epoch 18/50
694/694 - 21s - loss: 3.0012 - accuracy10: 0.4984 - val_loss: 3.1211 - val_accuracy10: 0.4683 - 21s/epoch - 30ms/step
Epoch 19/50
694/694 - 21s - loss: 2.9969 - accuracy10: 0.5007 - val_loss: 3.1110 - val_accuracy10: 0.4704 - 21s/epoch - 31ms/step
Epoch 20/50
694/694 - 21s - loss: 2.9926 - accuracy10: 0.5006 - val_loss: 3.1175 - val_accuracy10: 0.4697 - 21s/epoch - 30ms/step
Epoch 21/50
694/694 - 21s - loss: 2.9870 - accuracy10: 0.5028 - val_loss: 3.1205 - val_accuracy10: 0.4685 - 21s/epoch - 30ms/step
Epoch 22/50
694/694 - 21s - loss: 2.9834 - accuracy10: 0.5033 - val_loss: 3.1195 - val_accuracy10: 0.4691 - 21s/epoch - 30ms/step
Epoch 23/50
694/694 - 21s - loss: 2.9797 - accuracy10: 0.5044 - val_loss: 3.1222 - val_accuracy10: 0.4671 - 21s/epoch - 30ms/step
Epoch 24/50
694/694 - 21s - loss: 2.9772 - accuracy10: 0.5058 - val_loss: 3.1245 - val_accuracy10: 0.4663 - 21s/epoch - 30ms/step
Epoch 25/50
694/694 - 21s - loss: 2.9735 - accuracy10: 0.5061 - val_loss: 3.1224 - val_accuracy10: 0.4669 - 21s/epoch - 30ms/step
Epoch 26/50
694/694 - 20s - loss: 2.9701 - accuracy10: 0.5082 - val_loss: 3.1208 - val_accuracy10: 0.4697 - 20s/epoch - 30ms/step
Epoch 27/50
694/694 - 20s - loss: 2.9644 - accuracy10: 0.5088 - val_loss: 3.1232 - val_accuracy10: 0.4679 - 20s/epoch - 29ms/step
Epoch 28/50
694/694 - 21s - loss: 2.9621 - accuracy10: 0.5093 - val_loss: 3.1177 - val_accuracy10: 0.4714 - 21s/epoch - 30ms/step
Epoch 29/50
694/694 - 21s - loss: 2.9576 - accuracy10: 0.5108 - val_loss: 3.1240 - val_accuracy10: 0.4696 - 21s/epoch - 30ms/step
testing model: results/PCAR/W5/deepVOL_L2/h10
Evaluating performance on  test set...
2900/2900 - 45s - 45s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0760096
{'0': {'precision': 0.45584631086363353, 'recall': 0.5019552677550927, 'f1-score': 0.4777909373561619, 'support': 261601}, '1': {'precision': 0.4050260453329579, 'recall': 0.13285398945258745, 'f1-score': 0.20007928338943445, 'support': 216546}, '2': {'precision': 0.43840309341292993, 'recall': 0.6359500550696224, 'f1-score': 0.5190145750350977, 'support': 264211}, 'accuracy': 0.44197812915062545, 'macro avg': {'precision': 0.43309181653650713, 'recall': 0.42358643742576757, 'f1-score': 0.39896159859356467, 'support': 742358}, 'weighted avg': {'precision': 0.43481385058776456, 'recall': 0.44197812915062545, 'f1-score': 0.4114541978247099, 'support': 742358}}
[[131312  21915 108374]
 [ 80910  28769 106867]
 [ 75840  20346 168025]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0274138
{'0': {'precision': 0.4722846326675079, 'recall': 0.5098599504925821, 'f1-score': 0.49035350509286996, 'support': 60193}, '1': {'precision': 0.4975856845294452, 'recall': 0.36459182434658943, 'f1-score': 0.42083137317705466, 'support': 57659}, '2': {'precision': 0.46980333087023246, 'recall': 0.5533221757322175, 'f1-score': 0.5081538863528072, 'support': 59750}, 'accuracy': 0.4773200752243781, 'macro avg': {'precision': 0.4798912160223952, 'recall': 0.47592465019046304, 'f1-score': 0.4731129215409106, 'support': 177602}, 'weighted avg': {'precision': 0.4796639164983219, 'recall': 0.4773200752243781, 'f1-score': 0.47377146308966767, 'support': 177602}}
[[30690 11238 18265]
 [17591 21022 19046]
 [16701  9988 33061]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0335649
{'0': {'precision': 0.45942945407153546, 'recall': 0.4792547834843907, 'f1-score': 0.4691327599378958, 'support': 19860}, '1': {'precision': 0.5277312098351494, 'recall': 0.35912915339639684, 'f1-score': 0.4274036149690267, 'support': 21037}, '2': {'precision': 0.4449949678717969, 'recall': 0.5756634952428643, 'f1-score': 0.5019648938957297, 'support': 19970}, 'accuracy': 0.4693676376361575, 'macro avg': {'precision': 0.4773852105928273, 'recall': 0.47134914404121725, 'f1-score': 0.46616708960088404, 'support': 60867}, 'weighted avg': {'precision': 0.4783002271766723, 'recall': 0.4693676376361575, 'f1-score': 0.46548220532583745, 'support': 60867}}
[[ 9518  3612  6730]
 [ 5874  7555  7608]
 [ 5325  3149 11496]]
training model: results/PCAR/W5/deepVOL_L2/h20
Epoch 1/50
694/694 - 24s - loss: 3.2837 - accuracy20: 0.3793 - val_loss: 3.2487 - val_accuracy20: 0.3884 - 24s/epoch - 35ms/step
Epoch 2/50
694/694 - 21s - loss: 3.2164 - accuracy20: 0.4095 - val_loss: 3.2071 - val_accuracy20: 0.4106 - 21s/epoch - 30ms/step
Epoch 3/50
694/694 - 21s - loss: 3.1930 - accuracy20: 0.4228 - val_loss: 3.1892 - val_accuracy20: 0.4217 - 21s/epoch - 30ms/step
Epoch 4/50
694/694 - 21s - loss: 3.1767 - accuracy20: 0.4298 - val_loss: 3.1721 - val_accuracy20: 0.4309 - 21s/epoch - 31ms/step
Epoch 5/50
694/694 - 21s - loss: 3.1684 - accuracy20: 0.4355 - val_loss: 3.1731 - val_accuracy20: 0.4332 - 21s/epoch - 30ms/step
Epoch 6/50
694/694 - 21s - loss: 3.1614 - accuracy20: 0.4379 - val_loss: 3.1678 - val_accuracy20: 0.4352 - 21s/epoch - 31ms/step
Epoch 7/50
694/694 - 21s - loss: 3.1576 - accuracy20: 0.4408 - val_loss: 3.1669 - val_accuracy20: 0.4350 - 21s/epoch - 31ms/step
Epoch 8/50
694/694 - 21s - loss: 3.1508 - accuracy20: 0.4436 - val_loss: 3.1661 - val_accuracy20: 0.4374 - 21s/epoch - 31ms/step
Epoch 9/50
694/694 - 21s - loss: 3.1445 - accuracy20: 0.4467 - val_loss: 3.1574 - val_accuracy20: 0.4396 - 21s/epoch - 31ms/step
Epoch 10/50
694/694 - 21s - loss: 3.1409 - accuracy20: 0.4488 - val_loss: 3.1607 - val_accuracy20: 0.4399 - 21s/epoch - 30ms/step
Epoch 11/50
694/694 - 21s - loss: 3.1363 - accuracy20: 0.4503 - val_loss: 3.1648 - val_accuracy20: 0.4402 - 21s/epoch - 30ms/step
Epoch 12/50
694/694 - 21s - loss: 3.1306 - accuracy20: 0.4530 - val_loss: 3.1603 - val_accuracy20: 0.4413 - 21s/epoch - 30ms/step
Epoch 13/50
694/694 - 21s - loss: 3.1277 - accuracy20: 0.4538 - val_loss: 3.1597 - val_accuracy20: 0.4430 - 21s/epoch - 30ms/step
Epoch 14/50
694/694 - 21s - loss: 3.1231 - accuracy20: 0.4549 - val_loss: 3.1569 - val_accuracy20: 0.4439 - 21s/epoch - 30ms/step
Epoch 15/50
694/694 - 20s - loss: 3.1198 - accuracy20: 0.4579 - val_loss: 3.1613 - val_accuracy20: 0.4443 - 20s/epoch - 29ms/step
Epoch 16/50
694/694 - 21s - loss: 3.1153 - accuracy20: 0.4591 - val_loss: 3.1664 - val_accuracy20: 0.4418 - 21s/epoch - 30ms/step
Epoch 17/50
694/694 - 21s - loss: 3.1117 - accuracy20: 0.4611 - val_loss: 3.1591 - val_accuracy20: 0.4442 - 21s/epoch - 30ms/step
Epoch 18/50
694/694 - 21s - loss: 3.1084 - accuracy20: 0.4620 - val_loss: 3.1536 - val_accuracy20: 0.4459 - 21s/epoch - 30ms/step
Epoch 19/50
694/694 - 21s - loss: 3.1040 - accuracy20: 0.4632 - val_loss: 3.1509 - val_accuracy20: 0.4450 - 21s/epoch - 30ms/step
Epoch 20/50
694/694 - 21s - loss: 3.1005 - accuracy20: 0.4644 - val_loss: 3.1538 - val_accuracy20: 0.4467 - 21s/epoch - 30ms/step
Epoch 21/50
694/694 - 21s - loss: 3.0964 - accuracy20: 0.4653 - val_loss: 3.1535 - val_accuracy20: 0.4464 - 21s/epoch - 31ms/step
Epoch 22/50
694/694 - 21s - loss: 3.0936 - accuracy20: 0.4669 - val_loss: 3.1480 - val_accuracy20: 0.4468 - 21s/epoch - 31ms/step
Epoch 23/50
694/694 - 21s - loss: 3.0888 - accuracy20: 0.4685 - val_loss: 3.1479 - val_accuracy20: 0.4477 - 21s/epoch - 30ms/step
Epoch 24/50
694/694 - 21s - loss: 3.0868 - accuracy20: 0.4688 - val_loss: 3.1492 - val_accuracy20: 0.4489 - 21s/epoch - 31ms/step
Epoch 25/50
694/694 - 22s - loss: 3.0824 - accuracy20: 0.4702 - val_loss: 3.1578 - val_accuracy20: 0.4449 - 22s/epoch - 31ms/step
Epoch 26/50
694/694 - 21s - loss: 3.0778 - accuracy20: 0.4728 - val_loss: 3.1595 - val_accuracy20: 0.4435 - 21s/epoch - 30ms/step
Epoch 27/50
694/694 - 21s - loss: 3.0766 - accuracy20: 0.4724 - val_loss: 3.1583 - val_accuracy20: 0.4436 - 21s/epoch - 30ms/step
Epoch 28/50
694/694 - 21s - loss: 3.0730 - accuracy20: 0.4736 - val_loss: 3.1601 - val_accuracy20: 0.4446 - 21s/epoch - 31ms/step
Epoch 29/50
694/694 - 22s - loss: 3.0692 - accuracy20: 0.4749 - val_loss: 3.1558 - val_accuracy20: 0.4461 - 22s/epoch - 31ms/step
Epoch 30/50
694/694 - 21s - loss: 3.0657 - accuracy20: 0.4761 - val_loss: 3.1617 - val_accuracy20: 0.4447 - 21s/epoch - 31ms/step
Epoch 31/50
694/694 - 21s - loss: 3.0618 - accuracy20: 0.4778 - val_loss: 3.1620 - val_accuracy20: 0.4449 - 21s/epoch - 30ms/step
Epoch 32/50
694/694 - 21s - loss: 3.0592 - accuracy20: 0.4779 - val_loss: 3.1605 - val_accuracy20: 0.4439 - 21s/epoch - 31ms/step
Epoch 33/50
694/694 - 21s - loss: 3.0557 - accuracy20: 0.4799 - val_loss: 3.1582 - val_accuracy20: 0.4447 - 21s/epoch - 30ms/step
testing model: results/PCAR/W5/deepVOL_L2/h20
Evaluating performance on  test set...
2900/2900 - 47s - 47s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0775311
{'0': {'precision': 0.4347142234912646, 'recall': 0.5490420797280003, 'f1-score': 0.4852348098242155, 'support': 261765}, '1': {'precision': 0.35231952622443075, 'recall': 0.09583479919269725, 'f1-score': 0.15068233924087487, 'support': 216028}, '2': {'precision': 0.437162169818804, 'recall': 0.5832706518246934, 'f1-score': 0.4997562962207292, 'support': 264565}, 'accuracy': 0.42935618663771385, 'macro avg': {'precision': 0.4080653065114998, 'recall': 0.40938251024846367, 'f1-score': 0.37855781509527314, 'support': 742358}, 'weighted avg': {'precision': 0.4116095748702298, 'recall': 0.42935618663771385, 'f1-score': 0.39305445470352673, 'support': 742358}}
[[143720  18812  99233]
 [ 95883  20703  99442]
 [ 91005  19247 154313]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0472233
{'0': {'precision': 0.43632768663495963, 'recall': 0.5562083822953389, 'f1-score': 0.48902830704269645, 'support': 58719}, '1': {'precision': 0.4794694906193519, 'recall': 0.3115385887723709, 'f1-score': 0.3776781865030429, 'support': 60458}, '2': {'precision': 0.4518726267193975, 'recall': 0.4908686350021395, 'f1-score': 0.47056410592983955, 'support': 58425}, 'accuracy': 0.45142509656422786, 'macro avg': {'precision': 0.455889934657903, 'recall': 0.4528718686899498, 'f1-score': 0.44575686649185964, 'support': 177602}, 'weighted avg': {'precision': 0.4561274654084063, 'recall': 0.45142509656422786, 'f1-score': 0.4450492046812082, 'support': 177602}}
[[32660  9908 16151]
 [22986 18835 18637]
 [19206 10540 28679]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0504931
{'0': {'precision': 0.43144492368944926, 'recall': 0.5299541518084564, 'f1-score': 0.4756526907777422, 'support': 19630}, '1': {'precision': 0.5089777005502462, 'recall': 0.32249185742465253, 'f1-score': 0.39482182471708177, 'support': 21799}, '2': {'precision': 0.42823519156169637, 'recall': 0.5054532359296224, 'f1-score': 0.46365116443689386, 'support': 19438}, 'accuracy': 0.4478288727882104, 'macro avg': {'precision': 0.45621927193379724, 'recall': 0.4526330817209105, 'f1-score': 0.4447085599772393, 'support': 60867}, 'weighted avg': {'precision': 0.45818759590410174, 'recall': 0.4478288727882104, 'f1-score': 0.44287108961011856, 'support': 60867}}
[[10403  3311  5916]
 [ 7567  7030  7202]
 [ 6142  3471  9825]]
training model: results/PCAR/W5/deepVOL_L2/h30
Epoch 1/50
694/694 - 23s - loss: 3.2878 - accuracy30: 0.3780 - val_loss: 3.2682 - val_accuracy30: 0.3814 - 23s/epoch - 34ms/step
Epoch 2/50
694/694 - 21s - loss: 3.2330 - accuracy30: 0.4054 - val_loss: 3.2431 - val_accuracy30: 0.3963 - 21s/epoch - 30ms/step
Epoch 3/50
694/694 - 21s - loss: 3.2130 - accuracy30: 0.4147 - val_loss: 3.2280 - val_accuracy30: 0.4053 - 21s/epoch - 30ms/step
Epoch 4/50
694/694 - 21s - loss: 3.2011 - accuracy30: 0.4202 - val_loss: 3.2325 - val_accuracy30: 0.4024 - 21s/epoch - 30ms/step
Epoch 5/50
694/694 - 21s - loss: 3.1945 - accuracy30: 0.4236 - val_loss: 3.2208 - val_accuracy30: 0.4103 - 21s/epoch - 30ms/step
Epoch 6/50
694/694 - 21s - loss: 3.1895 - accuracy30: 0.4270 - val_loss: 3.2211 - val_accuracy30: 0.4130 - 21s/epoch - 30ms/step
Epoch 7/50
694/694 - 21s - loss: 3.1864 - accuracy30: 0.4289 - val_loss: 3.2167 - val_accuracy30: 0.4121 - 21s/epoch - 30ms/step
Epoch 8/50
694/694 - 21s - loss: 3.1823 - accuracy30: 0.4303 - val_loss: 3.2140 - val_accuracy30: 0.4125 - 21s/epoch - 30ms/step
Epoch 9/50
694/694 - 21s - loss: 3.1799 - accuracy30: 0.4308 - val_loss: 3.2135 - val_accuracy30: 0.4122 - 21s/epoch - 30ms/step
Epoch 10/50
694/694 - 21s - loss: 3.1773 - accuracy30: 0.4323 - val_loss: 3.2090 - val_accuracy30: 0.4166 - 21s/epoch - 30ms/step
Epoch 11/50
694/694 - 21s - loss: 3.1725 - accuracy30: 0.4350 - val_loss: 3.2059 - val_accuracy30: 0.4158 - 21s/epoch - 31ms/step
Epoch 12/50
694/694 - 21s - loss: 3.1702 - accuracy30: 0.4357 - val_loss: 3.2085 - val_accuracy30: 0.4194 - 21s/epoch - 30ms/step
Epoch 13/50
694/694 - 21s - loss: 3.1666 - accuracy30: 0.4368 - val_loss: 3.2006 - val_accuracy30: 0.4214 - 21s/epoch - 30ms/step
Epoch 14/50
694/694 - 21s - loss: 3.1626 - accuracy30: 0.4382 - val_loss: 3.1983 - val_accuracy30: 0.4199 - 21s/epoch - 30ms/step
Epoch 15/50
694/694 - 21s - loss: 3.1606 - accuracy30: 0.4402 - val_loss: 3.2008 - val_accuracy30: 0.4216 - 21s/epoch - 30ms/step
Epoch 16/50
694/694 - 21s - loss: 3.1582 - accuracy30: 0.4412 - val_loss: 3.2030 - val_accuracy30: 0.4205 - 21s/epoch - 30ms/step
Epoch 17/50
694/694 - 21s - loss: 3.1537 - accuracy30: 0.4432 - val_loss: 3.1993 - val_accuracy30: 0.4218 - 21s/epoch - 30ms/step
Epoch 18/50
694/694 - 21s - loss: 3.1514 - accuracy30: 0.4439 - val_loss: 3.1994 - val_accuracy30: 0.4224 - 21s/epoch - 30ms/step
Epoch 19/50
694/694 - 21s - loss: 3.1477 - accuracy30: 0.4450 - val_loss: 3.2023 - val_accuracy30: 0.4218 - 21s/epoch - 31ms/step
Epoch 20/50
694/694 - 22s - loss: 3.1456 - accuracy30: 0.4453 - val_loss: 3.2083 - val_accuracy30: 0.4198 - 22s/epoch - 31ms/step
Epoch 21/50
694/694 - 21s - loss: 3.1427 - accuracy30: 0.4465 - val_loss: 3.2081 - val_accuracy30: 0.4210 - 21s/epoch - 31ms/step
Epoch 22/50
694/694 - 21s - loss: 3.1392 - accuracy30: 0.4480 - val_loss: 3.2083 - val_accuracy30: 0.4190 - 21s/epoch - 31ms/step
Epoch 23/50
694/694 - 21s - loss: 3.1366 - accuracy30: 0.4496 - val_loss: 3.2066 - val_accuracy30: 0.4216 - 21s/epoch - 31ms/step
Epoch 24/50
694/694 - 21s - loss: 3.1335 - accuracy30: 0.4500 - val_loss: 3.2119 - val_accuracy30: 0.4191 - 21s/epoch - 31ms/step
testing model: results/PCAR/W5/deepVOL_L2/h30
Evaluating performance on  test set...
2900/2900 - 44s - 44s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0815517
{'0': {'precision': 0.42311045398585084, 'recall': 0.5479348078984205, 'f1-score': 0.47749977148270334, 'support': 262179}, '1': {'precision': 0.3286803254961243, 'recall': 0.14185831289621026, 'f1-score': 0.198181541972248, 'support': 216110}, '2': {'precision': 0.43199842356384405, 'recall': 0.5064168834660638, 'f1-score': 0.4662568772793517, 'support': 264069}, 'accuracy': 0.4149520851125737, 'macro avg': {'precision': 0.3945964010152731, 'recall': 0.3987366680868982, 'f1-score': 0.38064606357810105, 'support': 742358}, 'weighted avg': {'precision': 0.398782221745579, 'recall': 0.4149520851125737, 'f1-score': 0.392187344851766, 'support': 742358}}
[[143657  29694  88828]
 [ 98451  30657  87002]
 [ 97418  32922 133729]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0651003
{'0': {'precision': 0.43149962965073213, 'recall': 0.5077095833473, 'f1-score': 0.46651266651266654, 'support': 59666}, '1': {'precision': 0.4062731486380664, 'recall': 0.3254110866248517, 'f1-score': 0.36137388341381227, 'support': 58990}, '2': {'precision': 0.4334735407072437, 'recall': 0.44232008957350794, 'f1-score': 0.4378521348503296, 'support': 58946}, 'accuracy': 0.4254569205301742, 'macro avg': {'precision': 0.4237487729986807, 'recall': 0.4251469198485532, 'f1-score': 0.4219128949256028, 'support': 177602}, 'weighted avg': {'precision': 0.42377586553884133, 'recall': 0.4254569205301742, 'f1-score': 0.4220787045394369, 'support': 177602}}
[[30293 13395 15978]
 [21696 19196 18098]
 [18215 14658 26073]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0658606
{'0': {'precision': 0.42076127537226965, 'recall': 0.49340780998389694, 'f1-score': 0.454198031268095, 'support': 19872}, '1': {'precision': 0.4309233653620811, 'recall': 0.3455322747345673, 'f1-score': 0.38353235646868644, 'support': 21286}, '2': {'precision': 0.4158372365339578, 'recall': 0.43244203155918615, 'f1-score': 0.4239771172739709, 'support': 19709}, 'accuracy': 0.42195278229582533, 'macro avg': {'precision': 0.4225072924227695, 'recall': 0.4237940387592168, 'f1-score': 0.42056916833691743, 'support': 60867}, 'weighted avg': {'precision': 0.42272066824622173, 'recall': 0.42195278229582533, 'f1-score': 0.4196996405524297, 'support': 60867}}
[[9805 4586 5481]
 [7439 7355 6492]
 [6059 5127 8523]]
training model: results/PCAR/W5/deepVOL_L2/h50
Epoch 1/50
694/694 - 24s - loss: 3.2864 - accuracy50: 0.3828 - val_loss: 3.2884 - val_accuracy50: 0.3639 - 24s/epoch - 34ms/step
Epoch 2/50
694/694 - 22s - loss: 3.2441 - accuracy50: 0.3990 - val_loss: 3.2776 - val_accuracy50: 0.3685 - 22s/epoch - 32ms/step
Epoch 3/50
694/694 - 21s - loss: 3.2288 - accuracy50: 0.4082 - val_loss: 3.2612 - val_accuracy50: 0.3830 - 21s/epoch - 30ms/step
Epoch 4/50
694/694 - 21s - loss: 3.2212 - accuracy50: 0.4114 - val_loss: 3.2558 - val_accuracy50: 0.3863 - 21s/epoch - 31ms/step
Epoch 5/50
694/694 - 21s - loss: 3.2165 - accuracy50: 0.4156 - val_loss: 3.2502 - val_accuracy50: 0.3923 - 21s/epoch - 31ms/step
Epoch 6/50
694/694 - 22s - loss: 3.2161 - accuracy50: 0.4143 - val_loss: 3.2510 - val_accuracy50: 0.3911 - 22s/epoch - 31ms/step
Epoch 7/50
694/694 - 21s - loss: 3.2101 - accuracy50: 0.4187 - val_loss: 3.2536 - val_accuracy50: 0.3923 - 21s/epoch - 30ms/step
Epoch 8/50
694/694 - 21s - loss: 3.2075 - accuracy50: 0.4214 - val_loss: 3.2550 - val_accuracy50: 0.3915 - 21s/epoch - 30ms/step
Epoch 9/50
694/694 - 20s - loss: 3.2036 - accuracy50: 0.4232 - val_loss: 3.2515 - val_accuracy50: 0.3922 - 20s/epoch - 29ms/step
Epoch 10/50
694/694 - 21s - loss: 3.2010 - accuracy50: 0.4249 - val_loss: 3.2507 - val_accuracy50: 0.3941 - 21s/epoch - 31ms/step
Epoch 11/50
694/694 - 21s - loss: 3.1979 - accuracy50: 0.4267 - val_loss: 3.2525 - val_accuracy50: 0.3915 - 21s/epoch - 30ms/step
Epoch 12/50
694/694 - 21s - loss: 3.1954 - accuracy50: 0.4272 - val_loss: 3.2519 - val_accuracy50: 0.3921 - 21s/epoch - 30ms/step
Epoch 13/50
694/694 - 21s - loss: 3.1941 - accuracy50: 0.4290 - val_loss: 3.2525 - val_accuracy50: 0.3926 - 21s/epoch - 30ms/step
Epoch 14/50
694/694 - 21s - loss: 3.1906 - accuracy50: 0.4293 - val_loss: 3.2536 - val_accuracy50: 0.3921 - 21s/epoch - 30ms/step
Epoch 15/50
694/694 - 21s - loss: 3.1866 - accuracy50: 0.4304 - val_loss: 3.2559 - val_accuracy50: 0.3897 - 21s/epoch - 30ms/step
testing model: results/PCAR/W5/deepVOL_L2/h50
Evaluating performance on  test set...
2900/2900 - 44s - 44s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0880295
{'0': {'precision': 0.44158594059258044, 'recall': 0.41476786440868213, 'f1-score': 0.42775697722791983, 'support': 285092}, '1': {'precision': 0.24471263694416778, 'recall': 0.14611792279572525, 'f1-score': 0.1829790496216228, 'support': 171519}, '2': {'precision': 0.4217365369216962, 'recall': 0.5492831070842389, 'f1-score': 0.47713299478806465, 'support': 285747}, 'accuracy': 0.4044746604737876, 'macro avg': {'precision': 0.3693450381528149, 'recall': 0.37005629809621543, 'f1-score': 0.36262300721253576, 'support': 742358}, 'weighted avg': {'precision': 0.38845871663969483, 'recall': 0.4044746604737876, 'f1-score': 0.3902076863529703, 'support': 742358}}
[[118247  36328 130517]
 [ 61764  25062  84693]
 [ 87767  41024 156956]]
Evaluating performance on  train set...
694/694 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0804973
{'0': {'precision': 0.3996159371426896, 'recall': 0.45890076592879386, 'f1-score': 0.42721139606497255, 'support': 59405}, '1': {'precision': 0.3951097287022637, 'recall': 0.3051514747097291, 'f1-score': 0.3443524096385542, 'support': 59944}, '2': {'precision': 0.3995213035759574, 'recall': 0.4326815786311435, 'f1-score': 0.41544078258791345, 'support': 58253}, 'accuracy': 0.39840767558923884, 'macro avg': {'precision': 0.3980823231403036, 'recall': 0.3989112730898888, 'f1-score': 0.3956681960971467, 'support': 177602}, 'weighted avg': {'precision': 0.39806396786353876, 'recall': 0.39840767558923884, 'f1-score': 0.3953842058913014, 'support': 177602}}
[[27261 13318 18826]
 [22595 18292 19057]
 [18362 14686 25205]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0836785
{'0': {'precision': 0.3887248569846835, 'recall': 0.4261797582317536, 'f1-score': 0.4065915506550534, 'support': 19771}, '1': {'precision': 0.4054261279858449, 'recall': 0.32090005135147753, 'f1-score': 0.35824473629351683, 'support': 21421}, '2': {'precision': 0.375562151466091, 'recall': 0.42444726810673444, 'f1-score': 0.39851113072940275, 'support': 19675}, 'accuracy': 0.38856851824469746, 'macro avg': {'precision': 0.38990437881220646, 'recall': 0.3905090258966552, 'f1-score': 0.38778247255932435, 'support': 60867}, 'weighted avg': {'precision': 0.3903477675115301, 'recall': 0.38856851824469746, 'f1-score': 0.386964833838459, 'support': 60867}}
[[8426 4630 6715]
 [7377 6874 7170]
 [5873 5451 8351]]
training model: results/PCAR/W5/deepVOL_L2/h100
Epoch 1/50
694/694 - 24s - loss: 3.3120 - accuracy100: 0.3610 - val_loss: 3.2988 - val_accuracy100: 0.3566 - 24s/epoch - 34ms/step
Epoch 2/50
694/694 - 22s - loss: 3.2772 - accuracy100: 0.3736 - val_loss: 3.2869 - val_accuracy100: 0.3676 - 22s/epoch - 31ms/step
Epoch 3/50
694/694 - 22s - loss: 3.2659 - accuracy100: 0.3824 - val_loss: 3.2816 - val_accuracy100: 0.3685 - 22s/epoch - 31ms/step
Epoch 4/50
694/694 - 21s - loss: 3.2589 - accuracy100: 0.3860 - val_loss: 3.2806 - val_accuracy100: 0.3710 - 21s/epoch - 31ms/step
Epoch 5/50
694/694 - 21s - loss: 3.2556 - accuracy100: 0.3909 - val_loss: 3.2801 - val_accuracy100: 0.3691 - 21s/epoch - 31ms/step
Epoch 6/50
694/694 - 22s - loss: 3.2515 - accuracy100: 0.3925 - val_loss: 3.2805 - val_accuracy100: 0.3700 - 22s/epoch - 31ms/step
Epoch 7/50
694/694 - 22s - loss: 3.2493 - accuracy100: 0.3955 - val_loss: 3.2801 - val_accuracy100: 0.3718 - 22s/epoch - 31ms/step
Epoch 8/50
694/694 - 22s - loss: 3.2467 - accuracy100: 0.3965 - val_loss: 3.2810 - val_accuracy100: 0.3707 - 22s/epoch - 31ms/step
Epoch 9/50
694/694 - 22s - loss: 3.2426 - accuracy100: 0.3990 - val_loss: 3.2801 - val_accuracy100: 0.3720 - 22s/epoch - 31ms/step
Epoch 10/50
694/694 - 21s - loss: 3.2406 - accuracy100: 0.3994 - val_loss: 3.2811 - val_accuracy100: 0.3678 - 21s/epoch - 31ms/step
Epoch 11/50
694/694 - 22s - loss: 3.2370 - accuracy100: 0.4006 - val_loss: 3.2830 - val_accuracy100: 0.3710 - 22s/epoch - 31ms/step
Epoch 12/50
694/694 - 21s - loss: 3.2351 - accuracy100: 0.4030 - val_loss: 3.2870 - val_accuracy100: 0.3720 - 21s/epoch - 31ms/step
Epoch 13/50
694/694 - 21s - loss: 3.2316 - accuracy100: 0.4052 - val_loss: 3.2867 - val_accuracy100: 0.3690 - 21s/epoch - 31ms/step
Epoch 14/50
694/694 - 21s - loss: 3.2289 - accuracy100: 0.4065 - val_loss: 3.2892 - val_accuracy100: 0.3677 - 21s/epoch - 30ms/step
Epoch 15/50
694/694 - 20s - loss: 3.2271 - accuracy100: 0.4078 - val_loss: 3.2878 - val_accuracy100: 0.3692 - 20s/epoch - 29ms/step
testing model: results/PCAR/W5/deepVOL_L2/h100
Evaluating performance on  test set...
2900/2900 - 42s - 42s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0940163
{'0': {'precision': 0.3877802831015909, 'recall': 0.47127644188684126, 'f1-score': 0.4254706510945494, 'support': 262746}, '1': {'precision': 0.3152919604185767, 'recall': 0.22844406979993678, 'f1-score': 0.2649321531415699, 'support': 218281}, '2': {'precision': 0.37707969178845, 'recall': 0.3822049431563802, 'f1-score': 0.3796250194787672, 'support': 261331}, 'accuracy': 0.36851896254906663, 'macro avg': {'precision': 0.3600506451028725, 'recall': 0.36064181828105274, 'f1-score': 0.35667594123829555, 'support': 742358}, 'weighted avg': {'precision': 0.36269909613785445, 'recall': 0.36851896254906663, 'f1-score': 0.3621273738247439, 'support': 742358}}
[[123826  50360  88560]
 [ 91975  49865  76441]
 [103519  57930  99882]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0888383
{'0': {'precision': 0.3939270429997962, 'recall': 0.4463614171669856, 'f1-score': 0.41850826593260443, 'support': 60628}, '1': {'precision': 0.3590375171267146, 'recall': 0.4064624071943951, 'f1-score': 0.3812809089794417, 'support': 57378}, '2': {'precision': 0.3882858898218308, 'recall': 0.28632794147258206, 'f1-score': 0.32960219425745824, 'support': 59596}, 'accuracy': 0.3797704980799766, 'macro avg': {'precision': 0.3804168166494472, 'recall': 0.37971725527798755, 'f1-score': 0.37646378972316813, 'support': 177602}, 'weighted avg': {'precision': 0.3807623186141491, 'recall': 0.3797704980799766, 'f1-score': 0.3766479404024269, 'support': 177602}}
[[27062 19788 13778]
 [20951 23322 13105]
 [20685 21847 17064]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0933816
{'0': {'precision': 0.3813569963584613, 'recall': 0.4447210426123883, 'f1-score': 0.41060886024606785, 'support': 20487}, '1': {'precision': 0.35745135580390935, 'recall': 0.39942285685855017, 'f1-score': 0.3772733681094037, 'support': 20099}, '2': {'precision': 0.36763794172349656, 'recall': 0.26315270450175043, 'f1-score': 0.3067417667682051, 'support': 20281}, 'accuracy': 0.369264133274188, 'macro avg': {'precision': 0.3688154312952891, 'recall': 0.36909886799089636, 'f1-score': 0.36487466504122557, 'support': 60867}, 'weighted avg': {'precision': 0.3688918573412983, 'recall': 0.369264133274188, 'f1-score': 0.3649923754631913, 'support': 60867}}
[[9111 6702 4674]
 [7565 8028 4506]
 [7215 7729 5337]]
training model: results/PCAR/W5/deepVOL_L2/h200
Epoch 1/50
694/694 - 24s - loss: 3.3122 - accuracy200: 0.3618 - val_loss: 3.3054 - val_accuracy200: 0.3496 - 24s/epoch - 34ms/step
Epoch 2/50
694/694 - 21s - loss: 3.2786 - accuracy200: 0.3726 - val_loss: 3.2964 - val_accuracy200: 0.3556 - 21s/epoch - 30ms/step
Epoch 3/50
694/694 - 21s - loss: 3.2716 - accuracy200: 0.3783 - val_loss: 3.2972 - val_accuracy200: 0.3686 - 21s/epoch - 30ms/step
Epoch 4/50
694/694 - 21s - loss: 3.2612 - accuracy200: 0.3868 - val_loss: 3.2888 - val_accuracy200: 0.3737 - 21s/epoch - 31ms/step
Epoch 5/50
694/694 - 21s - loss: 3.2561 - accuracy200: 0.3909 - val_loss: 3.2807 - val_accuracy200: 0.3767 - 21s/epoch - 30ms/step
Epoch 6/50
694/694 - 21s - loss: 3.2533 - accuracy200: 0.3915 - val_loss: 3.2783 - val_accuracy200: 0.3777 - 21s/epoch - 30ms/step
Epoch 7/50
694/694 - 21s - loss: 3.2491 - accuracy200: 0.3955 - val_loss: 3.2762 - val_accuracy200: 0.3794 - 21s/epoch - 30ms/step
Epoch 8/50
694/694 - 21s - loss: 3.2451 - accuracy200: 0.3974 - val_loss: 3.2739 - val_accuracy200: 0.3812 - 21s/epoch - 31ms/step
Epoch 9/50
694/694 - 21s - loss: 3.2415 - accuracy200: 0.3999 - val_loss: 3.2782 - val_accuracy200: 0.3827 - 21s/epoch - 30ms/step
Epoch 10/50
694/694 - 21s - loss: 3.2379 - accuracy200: 0.4017 - val_loss: 3.2772 - val_accuracy200: 0.3819 - 21s/epoch - 31ms/step
Epoch 11/50
694/694 - 21s - loss: 3.2342 - accuracy200: 0.4032 - val_loss: 3.2783 - val_accuracy200: 0.3815 - 21s/epoch - 31ms/step
Epoch 12/50
694/694 - 22s - loss: 3.2319 - accuracy200: 0.4036 - val_loss: 3.2778 - val_accuracy200: 0.3829 - 22s/epoch - 31ms/step
Epoch 13/50
694/694 - 21s - loss: 3.2283 - accuracy200: 0.4074 - val_loss: 3.2826 - val_accuracy200: 0.3806 - 21s/epoch - 30ms/step
Epoch 14/50
694/694 - 22s - loss: 3.2247 - accuracy200: 0.4078 - val_loss: 3.2851 - val_accuracy200: 0.3796 - 22s/epoch - 32ms/step
Epoch 15/50
694/694 - 23s - loss: 3.2224 - accuracy200: 0.4097 - val_loss: 3.2865 - val_accuracy200: 0.3791 - 23s/epoch - 32ms/step
Epoch 16/50
694/694 - 22s - loss: 3.2177 - accuracy200: 0.4124 - val_loss: 3.2855 - val_accuracy200: 0.3793 - 22s/epoch - 32ms/step
Epoch 17/50
694/694 - 22s - loss: 3.2140 - accuracy200: 0.4147 - val_loss: 3.2908 - val_accuracy200: 0.3751 - 22s/epoch - 32ms/step
Epoch 18/50
694/694 - 22s - loss: 3.2083 - accuracy200: 0.4176 - val_loss: 3.2945 - val_accuracy200: 0.3782 - 22s/epoch - 31ms/step
testing model: results/PCAR/W5/deepVOL_L2/h200
Evaluating performance on  test set...
2900/2900 - 46s - 46s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1011189
{'0': {'precision': 0.36529789571830146, 'recall': 0.4001951782615465, 'f1-score': 0.38195108868980315, 'support': 263349}, '1': {'precision': 0.3389318892423027, 'recall': 0.17129572705620905, 'f1-score': 0.2275752332320947, 'support': 219591}, '2': {'precision': 0.3617522676232975, 'recall': 0.4781241085815171, 'f1-score': 0.41187604601121064, 'support': 259418}, 'accuracy': 0.35971862632314866, 'macro avg': {'precision': 0.3553273508613006, 'recall': 0.34987167129975755, 'f1-score': 0.34046745597770284, 'support': 742358}, 'weighted avg': {'precision': 0.35625975310083013, 'recall': 0.35971862632314866, 'f1-score': 0.34674371448839525, 'support': 742358}}
[[105391  36571 121387]
 [ 84527  37615  97449]
 [ 98589  36795 124034]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0894631
{'0': {'precision': 0.3751845128013709, 'recall': 0.369140625, 'f1-score': 0.3721380308474205, 'support': 59904}, '1': {'precision': 0.3928162076763421, 'recall': 0.4325527451348263, 'f1-score': 0.4117279390874482, 'support': 58631}, '2': {'precision': 0.37570470046764387, 'recall': 0.3441176968527266, 'f1-score': 0.3592181535416372, 'support': 59067}, 'accuracy': 0.381752457742593, 'macro avg': {'precision': 0.381235140315119, 'recall': 0.3819370223291843, 'f1-score': 0.3810280411588353, 'support': 177602}, 'weighted avg': {'precision': 0.38117819433141104, 'recall': 0.381752457742593, 'f1-score': 0.3809107784358506, 'support': 177602}}
[[22113 19240 18551]
 [18046 25361 15224]
 [18780 19961 20326]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.091541
{'0': {'precision': 0.35612551463224656, 'recall': 0.32209530518794344, 'f1-score': 0.33825666499326235, 'support': 19873}, '1': {'precision': 0.4202740917989993, 'recall': 0.45986860896886605, 'f1-score': 0.43918074151530995, 'support': 21006}, '2': {'precision': 0.35940325497287523, 'recall': 0.35796477886732037, 'f1-score': 0.35868257469420495, 'support': 19988}, 'accuracy': 0.3814217884896578, 'macro avg': {'precision': 0.3786009538013737, 'recall': 0.3799762310080433, 'f1-score': 0.3787066604009257, 'support': 60867}, 'weighted avg': {'precision': 0.37934040095641725, 'recall': 0.3814217884896578, 'f1-score': 0.3797945136555025, 'support': 60867}}
[[6401 6403 7069]
 [5662 9660 5684]
 [5911 6922 7155]]
training model: results/PCAR/W5/deepVOL_L2/h300
Epoch 1/50
694/694 - 25s - loss: 3.3142 - accuracy300: 0.3615 - val_loss: 3.3074 - val_accuracy300: 0.3343 - 25s/epoch - 36ms/step
Epoch 2/50
694/694 - 21s - loss: 3.2799 - accuracy300: 0.3704 - val_loss: 3.2989 - val_accuracy300: 0.3504 - 21s/epoch - 30ms/step
Epoch 3/50
694/694 - 21s - loss: 3.2691 - accuracy300: 0.3785 - val_loss: 3.2924 - val_accuracy300: 0.3589 - 21s/epoch - 31ms/step
Epoch 4/50
694/694 - 21s - loss: 3.2639 - accuracy300: 0.3816 - val_loss: 3.2900 - val_accuracy300: 0.3592 - 21s/epoch - 30ms/step
Epoch 5/50
694/694 - 21s - loss: 3.2606 - accuracy300: 0.3858 - val_loss: 3.2840 - val_accuracy300: 0.3621 - 21s/epoch - 30ms/step
Epoch 6/50
694/694 - 21s - loss: 3.2582 - accuracy300: 0.3870 - val_loss: 3.2849 - val_accuracy300: 0.3651 - 21s/epoch - 30ms/step
Epoch 7/50
694/694 - 21s - loss: 3.2547 - accuracy300: 0.3899 - val_loss: 3.2822 - val_accuracy300: 0.3683 - 21s/epoch - 30ms/step
Epoch 8/50
694/694 - 21s - loss: 3.2515 - accuracy300: 0.3914 - val_loss: 3.2784 - val_accuracy300: 0.3694 - 21s/epoch - 31ms/step
Epoch 9/50
694/694 - 21s - loss: 3.2481 - accuracy300: 0.3940 - val_loss: 3.2797 - val_accuracy300: 0.3710 - 21s/epoch - 30ms/step
Epoch 10/50
694/694 - 21s - loss: 3.2467 - accuracy300: 0.3959 - val_loss: 3.2779 - val_accuracy300: 0.3732 - 21s/epoch - 30ms/step
Epoch 11/50
694/694 - 21s - loss: 3.2462 - accuracy300: 0.3961 - val_loss: 3.2780 - val_accuracy300: 0.3703 - 21s/epoch - 30ms/step
Epoch 12/50
694/694 - 21s - loss: 3.2432 - accuracy300: 0.3986 - val_loss: 3.2805 - val_accuracy300: 0.3694 - 21s/epoch - 31ms/step
Epoch 13/50
694/694 - 21s - loss: 3.2415 - accuracy300: 0.3991 - val_loss: 3.2837 - val_accuracy300: 0.3659 - 21s/epoch - 30ms/step
Epoch 14/50
694/694 - 21s - loss: 3.2374 - accuracy300: 0.4014 - val_loss: 3.2860 - val_accuracy300: 0.3638 - 21s/epoch - 30ms/step
Epoch 15/50
694/694 - 21s - loss: 3.2339 - accuracy300: 0.4034 - val_loss: 3.2897 - val_accuracy300: 0.3616 - 21s/epoch - 30ms/step
Epoch 16/50
694/694 - 21s - loss: 3.2308 - accuracy300: 0.4043 - val_loss: 3.2891 - val_accuracy300: 0.3629 - 21s/epoch - 30ms/step
Epoch 17/50
694/694 - 21s - loss: 3.2263 - accuracy300: 0.4084 - val_loss: 3.2903 - val_accuracy300: 0.3635 - 21s/epoch - 30ms/step
Epoch 18/50
694/694 - 21s - loss: 3.2244 - accuracy300: 0.4087 - val_loss: 3.2928 - val_accuracy300: 0.3620 - 21s/epoch - 30ms/step
Epoch 19/50
694/694 - 21s - loss: 3.2213 - accuracy300: 0.4102 - val_loss: 3.2995 - val_accuracy300: 0.3571 - 21s/epoch - 30ms/step
Epoch 20/50
694/694 - 21s - loss: 3.2178 - accuracy300: 0.4117 - val_loss: 3.3015 - val_accuracy300: 0.3595 - 21s/epoch - 30ms/step
testing model: results/PCAR/W5/deepVOL_L2/h300
Evaluating performance on  test set...
2900/2900 - 43s - 43s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0945953
{'0': {'precision': 0.36740342403884896, 'recall': 0.5192765792725594, 'f1-score': 0.4303333616082789, 'support': 268668}, '1': {'precision': 0.3149432688461576, 'recall': 0.1538960265058518, 'f1-score': 0.20675962160465758, 'support': 209765}, '2': {'precision': 0.36511359704763, 'recall': 0.3598635976129582, 'f1-score': 0.36246958811575114, 'support': 263925}, 'accuracy': 0.359357614520218, 'macro avg': {'precision': 0.34915342997754556, 'recall': 0.3443454011304565, 'f1-score': 0.33318752377622923, 'support': 742358}, 'weighted avg': {'precision': 0.3517658919550668, 'recall': 0.359357614520218, 'f1-score': 0.3430319625651286, 'support': 742358}}
[[139513  34267  94888]
 [107218  32282  70265]
 [132996  35952  94977]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0899545
{'0': {'precision': 0.36598998511300584, 'recall': 0.4548099562731248, 'f1-score': 0.405594300712411, 'support': 59460}, '1': {'precision': 0.40030147189217946, 'recall': 0.37840510955023215, 'f1-score': 0.38904544005239433, 'support': 59653}, '2': {'precision': 0.3627488271839736, 'recall': 0.29349108379353384, 'f1-score': 0.3244653202408067, 'support': 58489}, 'accuracy': 0.37602054030923077, 'macro avg': {'precision': 0.3763467613963863, 'recall': 0.3755687165389636, 'f1-score': 0.373035020335204, 'support': 177602}, 'weighted avg': {'precision': 0.37644713669196816, 'recall': 0.37602054030923077, 'f1-score': 0.3733179630374094, 'support': 177602}}
[[27043 16383 16034]
 [22958 22573 14122]
 [23889 17434 17166]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0929111
{'0': {'precision': 0.350480450629556, 'recall': 0.43321558388368403, 'f1-score': 0.3874808251482474, 'support': 19533}, '1': {'precision': 0.43227272727272725, 'recall': 0.39051877537984214, 'f1-score': 0.41033631373301055, 'support': 21917}, '2': {'precision': 0.3329787862672103, 'recall': 0.2902096101354483, 'f1-score': 0.310126582278481, 'support': 19417}, 'accuracy': 0.372221400759032, 'macro avg': {'precision': 0.37191065472316454, 'recall': 0.37131465646632483, 'f1-score': 0.369314573719913, 'support': 60867}, 'weighted avg': {'precision': 0.37434907419018354, 'recall': 0.372221400759032, 'f1-score': 0.37103408733481813, 'support': 60867}}
[[8462 5451 5620]
 [7690 8559 5668]
 [7992 5790 5635]]
training model: results/PCAR/W5/deepVOL_L2/h500
Epoch 1/50
694/694 - 24s - loss: 3.3283 - accuracy500: 0.3560 - val_loss: 3.3219 - val_accuracy500: 0.3365 - 24s/epoch - 34ms/step
Epoch 2/50
694/694 - 20s - loss: 3.2941 - accuracy500: 0.3626 - val_loss: 3.3176 - val_accuracy500: 0.3360 - 20s/epoch - 29ms/step
Epoch 3/50
694/694 - 21s - loss: 3.2814 - accuracy500: 0.3683 - val_loss: 3.3026 - val_accuracy500: 0.3437 - 21s/epoch - 30ms/step
Epoch 4/50
694/694 - 21s - loss: 3.2729 - accuracy500: 0.3769 - val_loss: 3.2962 - val_accuracy500: 0.3521 - 21s/epoch - 30ms/step
Epoch 5/50
694/694 - 21s - loss: 3.2674 - accuracy500: 0.3798 - val_loss: 3.2984 - val_accuracy500: 0.3540 - 21s/epoch - 30ms/step
Epoch 6/50
694/694 - 21s - loss: 3.2626 - accuracy500: 0.3830 - val_loss: 3.2952 - val_accuracy500: 0.3589 - 21s/epoch - 30ms/step
Epoch 7/50
694/694 - 21s - loss: 3.2592 - accuracy500: 0.3843 - val_loss: 3.2921 - val_accuracy500: 0.3631 - 21s/epoch - 30ms/step
Epoch 8/50
694/694 - 21s - loss: 3.2571 - accuracy500: 0.3862 - val_loss: 3.2922 - val_accuracy500: 0.3631 - 21s/epoch - 30ms/step
Epoch 9/50
694/694 - 21s - loss: 3.2544 - accuracy500: 0.3890 - val_loss: 3.2939 - val_accuracy500: 0.3650 - 21s/epoch - 30ms/step
Epoch 10/50
694/694 - 21s - loss: 3.2505 - accuracy500: 0.3921 - val_loss: 3.2925 - val_accuracy500: 0.3626 - 21s/epoch - 30ms/step
Epoch 11/50
694/694 - 21s - loss: 3.2473 - accuracy500: 0.3949 - val_loss: 3.2910 - val_accuracy500: 0.3671 - 21s/epoch - 31ms/step
Epoch 12/50
694/694 - 21s - loss: 3.2436 - accuracy500: 0.3957 - val_loss: 3.2957 - val_accuracy500: 0.3619 - 21s/epoch - 30ms/step
Epoch 13/50
694/694 - 21s - loss: 3.2404 - accuracy500: 0.3981 - val_loss: 3.2976 - val_accuracy500: 0.3635 - 21s/epoch - 30ms/step
Epoch 14/50
694/694 - 21s - loss: 3.2382 - accuracy500: 0.3996 - val_loss: 3.2937 - val_accuracy500: 0.3628 - 21s/epoch - 30ms/step
Epoch 15/50
694/694 - 21s - loss: 3.2359 - accuracy500: 0.4003 - val_loss: 3.3050 - val_accuracy500: 0.3558 - 21s/epoch - 30ms/step
Epoch 16/50
694/694 - 21s - loss: 3.2325 - accuracy500: 0.4041 - val_loss: 3.3028 - val_accuracy500: 0.3607 - 21s/epoch - 31ms/step
Epoch 17/50
694/694 - 21s - loss: 3.2319 - accuracy500: 0.4046 - val_loss: 3.2992 - val_accuracy500: 0.3635 - 21s/epoch - 30ms/step
Epoch 18/50
694/694 - 21s - loss: 3.2259 - accuracy500: 0.4079 - val_loss: 3.3033 - val_accuracy500: 0.3597 - 21s/epoch - 30ms/step
Epoch 19/50
694/694 - 21s - loss: 3.2236 - accuracy500: 0.4098 - val_loss: 3.3035 - val_accuracy500: 0.3598 - 21s/epoch - 30ms/step
Epoch 20/50
694/694 - 21s - loss: 3.2211 - accuracy500: 0.4114 - val_loss: 3.3084 - val_accuracy500: 0.3566 - 21s/epoch - 30ms/step
Epoch 21/50
694/694 - 20s - loss: 3.2188 - accuracy500: 0.4131 - val_loss: 3.3119 - val_accuracy500: 0.3548 - 20s/epoch - 29ms/step
testing model: results/PCAR/W5/deepVOL_L2/h500
Evaluating performance on  test set...
2900/2900 - 44s - 44s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.101372
{'0': {'precision': 0.3622734060820297, 'recall': 0.4899154737817446, 'f1-score': 0.41653523431935735, 'support': 264415}, '1': {'precision': 0.3094012208891034, 'recall': 0.3036302113025728, 'f1-score': 0.3064885522752745, 'support': 217508}, '2': {'precision': 0.35789621138277816, 'recall': 0.23544454470405282, 'f1-score': 0.28403479678713367, 'support': 260435}, 'accuracy': 0.3460607954652607, 'macro avg': {'precision': 0.34319027945130376, 'recall': 0.34299674326279006, 'f1-score': 0.3356861944605885, 'support': 742358}, 'weighted avg': {'precision': 0.34524644879397914, 'recall': 0.3460607954652607, 'f1-score': 0.33780800949420686, 'support': 742358}}
[[129541  74733  60141]
 [101596  66042  49870]
 [126441  72676  61318]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.095668
{'0': {'precision': 0.3706907640854129, 'recall': 0.3838686581081306, 'f1-score': 0.3771646393835532, 'support': 60057}, '1': {'precision': 0.36598420429841216, 'recall': 0.4560167326715699, 'f1-score': 0.40606990466158294, 'support': 58329}, '2': {'precision': 0.34421510811569783, 'recall': 0.2483957038638206, 'f1-score': 0.2885588731510182, 'support': 59216}, 'accuracy': 0.3623945676287429, 'macro avg': {'precision': 0.3602966921665076, 'recall': 0.3627603648811737, 'f1-score': 0.3572644723987181, 'support': 177602}, 'weighted avg': {'precision': 0.36031750607188484, 'recall': 0.3623945676287429, 'f1-score': 0.35711495618841127, 'support': 177602}}
[[23054 22758 14245]
 [17952 26599 13778]
 [21186 23321 14709]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975921
{'0': {'precision': 0.36610766146775536, 'recall': 0.3722965246358077, 'f1-score': 0.36917615737316967, 'support': 20113}, '1': {'precision': 0.3818617597031081, 'recall': 0.47143607120698705, 'f1-score': 0.4219474167574379, 'support': 20953}, '2': {'precision': 0.32675649663137635, 'recall': 0.24003838189990404, 'f1-score': 0.27676361836550495, 'support': 19801}, 'accuracy': 0.36339888609591403, 'macro avg': {'precision': 0.3582419726007466, 'recall': 0.36125699258089966, 'f1-score': 0.3559623974987041, 'support': 60867}, 'weighted avg': {'precision': 0.35872933175543514, 'recall': 0.36339888609591403, 'f1-score': 0.35727899656333517, 'support': 60867}}
[[7488 7817 4808]
 [6090 9878 4985]
 [6875 8173 4753]]
training model: results/PCAR/W5/deepVOL_L2/h1000
Epoch 1/50
694/694 - 24s - loss: 3.3260 - accuracy1000: 0.3654 - val_loss: 3.3189 - val_accuracy1000: 0.3282 - 24s/epoch - 34ms/step
Epoch 2/50
694/694 - 21s - loss: 3.2939 - accuracy1000: 0.3588 - val_loss: 3.2944 - val_accuracy1000: 0.3421 - 21s/epoch - 31ms/step
Epoch 3/50
694/694 - 21s - loss: 3.2862 - accuracy1000: 0.3639 - val_loss: 3.2941 - val_accuracy1000: 0.3428 - 21s/epoch - 30ms/step
Epoch 4/50
694/694 - 22s - loss: 3.2817 - accuracy1000: 0.3682 - val_loss: 3.2959 - val_accuracy1000: 0.3453 - 22s/epoch - 32ms/step
Epoch 5/50
694/694 - 22s - loss: 3.2756 - accuracy1000: 0.3727 - val_loss: 3.2933 - val_accuracy1000: 0.3484 - 22s/epoch - 31ms/step
Epoch 6/50
694/694 - 21s - loss: 3.2714 - accuracy1000: 0.3773 - val_loss: 3.2867 - val_accuracy1000: 0.3616 - 21s/epoch - 30ms/step
Epoch 7/50
694/694 - 21s - loss: 3.2688 - accuracy1000: 0.3798 - val_loss: 3.2929 - val_accuracy1000: 0.3597 - 21s/epoch - 30ms/step
Epoch 8/50
694/694 - 21s - loss: 3.2654 - accuracy1000: 0.3832 - val_loss: 3.2934 - val_accuracy1000: 0.3583 - 21s/epoch - 31ms/step
Epoch 9/50
694/694 - 21s - loss: 3.2602 - accuracy1000: 0.3874 - val_loss: 3.2956 - val_accuracy1000: 0.3586 - 21s/epoch - 30ms/step
Epoch 10/50
694/694 - 20s - loss: 3.2573 - accuracy1000: 0.3887 - val_loss: 3.2956 - val_accuracy1000: 0.3652 - 20s/epoch - 29ms/step
Epoch 11/50
694/694 - 20s - loss: 3.2542 - accuracy1000: 0.3911 - val_loss: 3.2950 - val_accuracy1000: 0.3551 - 20s/epoch - 29ms/step
Epoch 12/50
694/694 - 21s - loss: 3.2500 - accuracy1000: 0.3933 - val_loss: 3.2994 - val_accuracy1000: 0.3613 - 21s/epoch - 30ms/step
Epoch 13/50
694/694 - 21s - loss: 3.2464 - accuracy1000: 0.3949 - val_loss: 3.3048 - val_accuracy1000: 0.3514 - 21s/epoch - 30ms/step
Epoch 14/50
694/694 - 21s - loss: 3.2436 - accuracy1000: 0.3972 - val_loss: 3.3084 - val_accuracy1000: 0.3538 - 21s/epoch - 30ms/step
Epoch 15/50
694/694 - 21s - loss: 3.2421 - accuracy1000: 0.3989 - val_loss: 3.3167 - val_accuracy1000: 0.3463 - 21s/epoch - 30ms/step
Epoch 16/50
694/694 - 21s - loss: 3.2402 - accuracy1000: 0.4002 - val_loss: 3.3279 - val_accuracy1000: 0.3367 - 21s/epoch - 30ms/step
testing model: results/PCAR/W5/deepVOL_L2/h1000
Evaluating performance on  test set...
2900/2900 - 45s - 45s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0970505
{'0': {'precision': 0.3927123956468302, 'recall': 0.3509608075648393, 'f1-score': 0.37066458471734126, 'support': 263112}, '1': {'precision': 0.33320673546685264, 'recall': 0.42870279058610306, 'f1-score': 0.3749701308414846, 'support': 225114}, '2': {'precision': 0.3453499273857014, 'recall': 0.29568885461098954, 'f1-score': 0.31859577715593995, 'support': 254132}, 'accuracy': 0.3556141376532616, 'macro avg': {'precision': 0.3570896861664614, 'recall': 0.3584508175873106, 'f1-score': 0.35474349757158863, 'support': 742358}, 'weighted avg': {'precision': 0.358454159095338, 'recall': 0.3556141376532616, 'f1-score': 0.354145450427681, 'support': 742358}}
[[92342 94774 75996]
 [62159 96507 66448]
 [80638 98350 75144]]
Evaluating performance on  train set...
694/694 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.09535
{'0': {'precision': 0.3985933199687404, 'recall': 0.195178357513643, 'f1-score': 0.2620427765678226, 'support': 60104}, '1': {'precision': 0.3663048180114116, 'recall': 0.598996227431959, 'f1-score': 0.45460471655908485, 'support': 59376}, '2': {'precision': 0.33639407169567515, 'recall': 0.29561955885895186, 'f1-score': 0.3146915264791802, 'support': 58122}, 'accuracy': 0.36305334399387396, 'macro avg': {'precision': 0.3670974032252758, 'recall': 0.363264714601518, 'f1-score': 0.34377967320202923, 'support': 177602}, 'weighted avg': {'precision': 0.3674432946292428, 'recall': 0.36305334399387396, 'f1-score': 0.34365001292365815, 'support': 177602}}
[[11731 30956 17417]
 [ 7332 35566 16478]
 [10368 30572 17182]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0954895
{'0': {'precision': 0.3806547129462083, 'recall': 0.2303404340035835, 'f1-score': 0.28700775193798445, 'support': 20092}, '1': {'precision': 0.3831051243765289, 'recall': 0.5681507656065959, 'f1-score': 0.45762969147280935, 'support': 21225}, '2': {'precision': 0.313602599814299, 'recall': 0.27641943734015345, 'f1-score': 0.29383937795660925, 'support': 19550}, 'accuracy': 0.36293886670938275, 'macro avg': {'precision': 0.3591208123790121, 'recall': 0.35830354565011097, 'f1-score': 0.34615894045580103, 'support': 60867}, 'weighted avg': {'precision': 0.3599725891497295, 'recall': 0.36293886670938275, 'f1-score': 0.3486997846534259, 'support': 60867}}
[[ 4628  9696  5768]
 [ 3106 12059  6060]
 [ 4424  9722  5404]]
training model: results/PCAR/W5/deepVOL_L3/h10
Epoch 1/50
694/694 - 32s - loss: 3.3061 - accuracy10: 0.3586 - val_loss: 3.3054 - val_accuracy10: 0.3565 - 32s/epoch - 47ms/step
Epoch 2/50
694/694 - 30s - loss: 3.2600 - accuracy10: 0.3810 - val_loss: 3.2741 - val_accuracy10: 0.3996 - 30s/epoch - 43ms/step
Epoch 3/50
694/694 - 29s - loss: 3.2135 - accuracy10: 0.4130 - val_loss: 3.2149 - val_accuracy10: 0.4243 - 29s/epoch - 42ms/step
Epoch 4/50
694/694 - 30s - loss: 3.1776 - accuracy10: 0.4284 - val_loss: 3.1946 - val_accuracy10: 0.4316 - 30s/epoch - 43ms/step
Epoch 5/50
694/694 - 30s - loss: 3.1421 - accuracy10: 0.4469 - val_loss: 3.1675 - val_accuracy10: 0.4475 - 30s/epoch - 43ms/step
Epoch 6/50
694/694 - 30s - loss: 3.1227 - accuracy10: 0.4558 - val_loss: 3.1726 - val_accuracy10: 0.4526 - 30s/epoch - 43ms/step
Epoch 7/50
694/694 - 29s - loss: 3.1029 - accuracy10: 0.4638 - val_loss: 3.1664 - val_accuracy10: 0.4608 - 29s/epoch - 42ms/step
Epoch 8/50
694/694 - 30s - loss: 3.0870 - accuracy10: 0.4704 - val_loss: 3.1600 - val_accuracy10: 0.4635 - 30s/epoch - 43ms/step
Epoch 9/50
694/694 - 29s - loss: 3.0728 - accuracy10: 0.4760 - val_loss: 3.1531 - val_accuracy10: 0.4629 - 29s/epoch - 42ms/step
Epoch 10/50
694/694 - 28s - loss: 3.0608 - accuracy10: 0.4794 - val_loss: 3.1410 - val_accuracy10: 0.4668 - 28s/epoch - 41ms/step
Epoch 11/50
694/694 - 29s - loss: 3.0525 - accuracy10: 0.4824 - val_loss: 3.1385 - val_accuracy10: 0.4680 - 29s/epoch - 42ms/step
Epoch 12/50
694/694 - 29s - loss: 3.0438 - accuracy10: 0.4853 - val_loss: 3.1388 - val_accuracy10: 0.4671 - 29s/epoch - 41ms/step
Epoch 13/50
694/694 - 29s - loss: 3.0350 - accuracy10: 0.4878 - val_loss: 3.1335 - val_accuracy10: 0.4687 - 29s/epoch - 41ms/step
Epoch 14/50
694/694 - 28s - loss: 3.0299 - accuracy10: 0.4893 - val_loss: 3.1331 - val_accuracy10: 0.4711 - 28s/epoch - 41ms/step
Epoch 15/50
694/694 - 29s - loss: 3.0228 - accuracy10: 0.4914 - val_loss: 3.1408 - val_accuracy10: 0.4676 - 29s/epoch - 42ms/step
Epoch 16/50
694/694 - 29s - loss: 3.0189 - accuracy10: 0.4944 - val_loss: 3.1371 - val_accuracy10: 0.4703 - 29s/epoch - 41ms/step
Epoch 17/50
694/694 - 29s - loss: 3.0129 - accuracy10: 0.4951 - val_loss: 3.1334 - val_accuracy10: 0.4712 - 29s/epoch - 41ms/step
Epoch 18/50
694/694 - 29s - loss: 3.0081 - accuracy10: 0.4962 - val_loss: 3.1478 - val_accuracy10: 0.4699 - 29s/epoch - 42ms/step
Epoch 19/50
694/694 - 29s - loss: 3.0042 - accuracy10: 0.4969 - val_loss: 3.1396 - val_accuracy10: 0.4721 - 29s/epoch - 41ms/step
Epoch 20/50
694/694 - 29s - loss: 2.9982 - accuracy10: 0.4993 - val_loss: 3.1425 - val_accuracy10: 0.4682 - 29s/epoch - 41ms/step
Epoch 21/50
694/694 - 30s - loss: 2.9938 - accuracy10: 0.5002 - val_loss: 3.1405 - val_accuracy10: 0.4692 - 30s/epoch - 44ms/step
Epoch 22/50
694/694 - 29s - loss: 2.9905 - accuracy10: 0.5009 - val_loss: 3.1480 - val_accuracy10: 0.4698 - 29s/epoch - 42ms/step
Epoch 23/50
694/694 - 29s - loss: 2.9846 - accuracy10: 0.5025 - val_loss: 3.1502 - val_accuracy10: 0.4694 - 29s/epoch - 42ms/step
Epoch 24/50
694/694 - 29s - loss: 2.9806 - accuracy10: 0.5040 - val_loss: 3.1474 - val_accuracy10: 0.4691 - 29s/epoch - 42ms/step
testing model: results/PCAR/W5/deepVOL_L3/h10
Evaluating performance on  test set...
2900/2900 - 59s - 59s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0841928
{'0': {'precision': 0.45873135564850726, 'recall': 0.5185836445579336, 'f1-score': 0.48682477652538697, 'support': 261601}, '1': {'precision': 0.4678835836105866, 'recall': 0.07208630037036011, 'f1-score': 0.12492547287212545, 'support': 216546}, '2': {'precision': 0.4277697925287106, 'recall': 0.6690902346987824, 'f1-score': 0.5218835289376845, 'support': 264211}, 'accuracy': 0.441906735025419, 'macro avg': {'precision': 0.45146157726260155, 'recall': 0.41992005987569203, 'f1-score': 0.37787792611173227, 'support': 742358}, 'weighted avg': {'precision': 0.45038160095175966, 'recall': 0.441906735025419, 'f1-score': 0.39373634941165797, 'support': 742358}}
[[135662   8984 116955]
 [ 81410  15610 119526]
 [ 78661   8769 176781]]
Evaluating performance on  train set...
694/694 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0363348
{'0': {'precision': 0.4711684029078918, 'recall': 0.5222201917166448, 'f1-score': 0.4953824817978378, 'support': 60193}, '1': {'precision': 0.5470336467868412, 'recall': 0.3036819924036144, 'f1-score': 0.39055181335593525, 'support': 57659}, '2': {'precision': 0.4484647176652552, 'recall': 0.5920334728033473, 'f1-score': 0.5103442306027641, 'support': 59750}, 'accuracy': 0.4747581671377575, 'macro avg': {'precision': 0.48888892245332943, 'recall': 0.47264521897453554, 'f1-score': 0.46542617525217905, 'support': 177602}, 'weighted avg': {'precision': 0.48816015358394726, 'recall': 0.4747581671377575, 'f1-score': 0.4663824310067582, 'support': 177602}}
[[31434  7216 21543]
 [18188 17510 21961]
 [17093  7283 35374]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.040699
{'0': {'precision': 0.4628006188176832, 'recall': 0.49707955689828803, 'f1-score': 0.4793280085455561, 'support': 19860}, '1': {'precision': 0.5619162640901771, 'recall': 0.33174882350144985, 'f1-score': 0.4171922168753923, 'support': 21037}, '2': {'precision': 0.4347248856763534, 'recall': 0.5902854281422133, 'f1-score': 0.5007008452618613, 'support': 19970}, 'accuracy': 0.47051768610248573, 'macro avg': {'precision': 0.48648058952807127, 'recall': 0.4730379361806503, 'f1-score': 0.4657403568942699, 'support': 60867}, 'weighted avg': {'precision': 0.487845773643206, 'recall': 0.47051768610248573, 'f1-score': 0.4648647509488186, 'support': 60867}}
[[ 9872  2711  7277]
 [ 6007  6979  8051]
 [ 5452  2730 11788]]
training model: results/PCAR/W5/deepVOL_L3/h20
Epoch 1/50
694/694 - 32s - loss: 3.3050 - accuracy20: 0.3621 - val_loss: 3.3013 - val_accuracy20: 0.3455 - 32s/epoch - 46ms/step
Epoch 2/50
694/694 - 36s - loss: 3.2620 - accuracy20: 0.3835 - val_loss: 3.2635 - val_accuracy20: 0.3797 - 36s/epoch - 52ms/step
Epoch 3/50
694/694 - 30s - loss: 3.2247 - accuracy20: 0.4066 - val_loss: 3.2440 - val_accuracy20: 0.3968 - 30s/epoch - 43ms/step
Epoch 4/50
694/694 - 30s - loss: 3.1975 - accuracy20: 0.4212 - val_loss: 3.1943 - val_accuracy20: 0.4219 - 30s/epoch - 43ms/step
Epoch 5/50
694/694 - 30s - loss: 3.1758 - accuracy20: 0.4307 - val_loss: 3.1881 - val_accuracy20: 0.4217 - 30s/epoch - 43ms/step
Epoch 6/50
694/694 - 30s - loss: 3.1585 - accuracy20: 0.4378 - val_loss: 3.1572 - val_accuracy20: 0.4329 - 30s/epoch - 43ms/step
Epoch 7/50
694/694 - 30s - loss: 3.1483 - accuracy20: 0.4426 - val_loss: 3.1566 - val_accuracy20: 0.4361 - 30s/epoch - 43ms/step
Epoch 8/50
694/694 - 29s - loss: 3.1408 - accuracy20: 0.4454 - val_loss: 3.1588 - val_accuracy20: 0.4382 - 29s/epoch - 42ms/step
Epoch 9/50
694/694 - 29s - loss: 3.1346 - accuracy20: 0.4476 - val_loss: 3.1541 - val_accuracy20: 0.4404 - 29s/epoch - 42ms/step
Epoch 10/50
694/694 - 30s - loss: 3.1306 - accuracy20: 0.4498 - val_loss: 3.1598 - val_accuracy20: 0.4358 - 30s/epoch - 43ms/step
Epoch 11/50
694/694 - 30s - loss: 3.1252 - accuracy20: 0.4526 - val_loss: 3.1541 - val_accuracy20: 0.4432 - 30s/epoch - 43ms/step
Epoch 12/50
694/694 - 30s - loss: 3.1223 - accuracy20: 0.4542 - val_loss: 3.1676 - val_accuracy20: 0.4415 - 30s/epoch - 43ms/step
Epoch 13/50
694/694 - 29s - loss: 3.1186 - accuracy20: 0.4545 - val_loss: 3.1608 - val_accuracy20: 0.4418 - 29s/epoch - 42ms/step
Epoch 14/50
694/694 - 30s - loss: 3.1131 - accuracy20: 0.4575 - val_loss: 3.1537 - val_accuracy20: 0.4471 - 30s/epoch - 43ms/step
Epoch 15/50
694/694 - 30s - loss: 3.1091 - accuracy20: 0.4586 - val_loss: 3.1520 - val_accuracy20: 0.4463 - 30s/epoch - 43ms/step
Epoch 16/50
694/694 - 28s - loss: 3.1048 - accuracy20: 0.4596 - val_loss: 3.1598 - val_accuracy20: 0.4466 - 28s/epoch - 41ms/step
Epoch 17/50
694/694 - 28s - loss: 3.0991 - accuracy20: 0.4625 - val_loss: 3.1580 - val_accuracy20: 0.4456 - 28s/epoch - 41ms/step
Epoch 18/50
694/694 - 29s - loss: 3.0957 - accuracy20: 0.4628 - val_loss: 3.1648 - val_accuracy20: 0.4462 - 29s/epoch - 42ms/step
Epoch 19/50
694/694 - 29s - loss: 3.0917 - accuracy20: 0.4654 - val_loss: 3.1653 - val_accuracy20: 0.4474 - 29s/epoch - 41ms/step
Epoch 20/50
694/694 - 29s - loss: 3.0885 - accuracy20: 0.4665 - val_loss: 3.1646 - val_accuracy20: 0.4457 - 29s/epoch - 41ms/step
Epoch 21/50
694/694 - 29s - loss: 3.0832 - accuracy20: 0.4684 - val_loss: 3.1767 - val_accuracy20: 0.4464 - 29s/epoch - 41ms/step
Epoch 22/50
694/694 - 29s - loss: 3.0807 - accuracy20: 0.4697 - val_loss: 3.1690 - val_accuracy20: 0.4463 - 29s/epoch - 41ms/step
Epoch 23/50
694/694 - 29s - loss: 3.0768 - accuracy20: 0.4704 - val_loss: 3.1603 - val_accuracy20: 0.4498 - 29s/epoch - 41ms/step
Epoch 24/50
694/694 - 29s - loss: 3.0729 - accuracy20: 0.4716 - val_loss: 3.1639 - val_accuracy20: 0.4485 - 29s/epoch - 42ms/step
Epoch 25/50
694/694 - 29s - loss: 3.0698 - accuracy20: 0.4730 - val_loss: 3.1581 - val_accuracy20: 0.4500 - 29s/epoch - 42ms/step
testing model: results/PCAR/W5/deepVOL_L3/h20
Evaluating performance on  test set...
2900/2900 - 58s - 58s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0820494
{'0': {'precision': 0.41583531078008723, 'recall': 0.6393329895134949, 'f1-score': 0.5039143657222005, 'support': 261765}, '1': {'precision': 0.3842537134643028, 'recall': 0.05939507841576092, 'f1-score': 0.10288669713735868, 'support': 216028}, '2': {'precision': 0.44949120912463175, 'recall': 0.5207567138510385, 'f1-score': 0.48250670663799566, 'support': 264565}, 'accuracy': 0.4283108688799743, 'macro avg': {'precision': 0.4165267444563406, 'recall': 0.4064949272600981, 'f1-score': 0.36310258983251825, 'support': 742358}, 'weighted avg': {'precision': 0.41863943418226, 'recall': 0.4283108688799743, 'f1-score': 0.3795849686999297, 'support': 742358}}
[[167355  10047  84363]
 [118823  12831  84374]
 [116277  10514 137774]]
Evaluating performance on  train set...
694/694 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0502111
{'0': {'precision': 0.42376139539820507, 'recall': 0.6119314021015344, 'f1-score': 0.5007525503093818, 'support': 58719}, '1': {'precision': 0.5009865418028683, 'recall': 0.28138542459227894, 'f1-score': 0.36036646719271304, 'support': 60458}, '2': {'precision': 0.45512471963569634, 'recall': 0.4584510055626872, 'f1-score': 0.45678180717446726, 'support': 58425}, 'accuracy': 0.44891949414984067, 'macro avg': {'precision': 0.4599575522789232, 'recall': 0.45058927741883353, 'f1-score': 0.4393002748921873, 'support': 177602}, 'weighted avg': {'precision': 0.4603672901511276, 'recall': 0.44891949414984067, 'f1-score': 0.43849845136497273, 'support': 177602}}
[[35932  7969 14818]
 [26197 17012 17249]
 [22664  8976 26785]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0522056
{'0': {'precision': 0.41677269257333965, 'recall': 0.5840550178298523, 'f1-score': 0.4864337385179999, 'support': 19630}, '1': {'precision': 0.5188914969334444, 'recall': 0.31437221890912426, 'f1-score': 0.391532880077701, 'support': 21799}, '2': {'precision': 0.4376457744032554, 'recall': 0.45369894022018725, 'f1-score': 0.445527798125742, 'support': 19438}, 'accuracy': 0.445840931867843, 'macro avg': {'precision': 0.45776998797001317, 'recall': 0.4507087256530546, 'f1-score': 0.44116480557381427, 'support': 60867}, 'weighted avg': {'precision': 0.4600115376101548, 'recall': 0.445840931867843, 'f1-score': 0.43938240557100433, 'support': 60867}}
[[11465  3013  5152]
 [ 8766  6853  6180]
 [ 7278  3341  8819]]
training model: results/PCAR/W5/deepVOL_L3/h30
Epoch 1/50
694/694 - 32s - loss: 3.3081 - accuracy30: 0.3611 - val_loss: 3.2847 - val_accuracy30: 0.3669 - 32s/epoch - 47ms/step
Epoch 2/50
694/694 - 29s - loss: 3.2680 - accuracy30: 0.3817 - val_loss: 3.2804 - val_accuracy30: 0.3683 - 29s/epoch - 42ms/step
Epoch 3/50
694/694 - 29s - loss: 3.2497 - accuracy30: 0.3907 - val_loss: 3.2602 - val_accuracy30: 0.3804 - 29s/epoch - 42ms/step
Epoch 4/50
694/694 - 29s - loss: 3.2287 - accuracy30: 0.4035 - val_loss: 3.2329 - val_accuracy30: 0.4002 - 29s/epoch - 42ms/step
Epoch 5/50
694/694 - 29s - loss: 3.2117 - accuracy30: 0.4127 - val_loss: 3.2200 - val_accuracy30: 0.4060 - 29s/epoch - 42ms/step
Epoch 6/50
694/694 - 29s - loss: 3.2017 - accuracy30: 0.4189 - val_loss: 3.2090 - val_accuracy30: 0.4111 - 29s/epoch - 42ms/step
Epoch 7/50
694/694 - 29s - loss: 3.1914 - accuracy30: 0.4253 - val_loss: 3.2075 - val_accuracy30: 0.4133 - 29s/epoch - 41ms/step
Epoch 8/50
694/694 - 29s - loss: 3.1844 - accuracy30: 0.4293 - val_loss: 3.2035 - val_accuracy30: 0.4161 - 29s/epoch - 42ms/step
Epoch 9/50
694/694 - 29s - loss: 3.1803 - accuracy30: 0.4318 - val_loss: 3.1949 - val_accuracy30: 0.4214 - 29s/epoch - 42ms/step
Epoch 10/50
694/694 - 29s - loss: 3.1733 - accuracy30: 0.4347 - val_loss: 3.1952 - val_accuracy30: 0.4189 - 29s/epoch - 42ms/step
Epoch 11/50
694/694 - 31s - loss: 3.1689 - accuracy30: 0.4366 - val_loss: 3.1914 - val_accuracy30: 0.4202 - 31s/epoch - 44ms/step
Epoch 12/50
694/694 - 30s - loss: 3.1660 - accuracy30: 0.4375 - val_loss: 3.1880 - val_accuracy30: 0.4212 - 30s/epoch - 43ms/step
Epoch 13/50
694/694 - 31s - loss: 3.1623 - accuracy30: 0.4396 - val_loss: 3.1872 - val_accuracy30: 0.4228 - 31s/epoch - 45ms/step
Epoch 14/50
694/694 - 31s - loss: 3.1583 - accuracy30: 0.4408 - val_loss: 3.1881 - val_accuracy30: 0.4257 - 31s/epoch - 44ms/step
Epoch 15/50
694/694 - 29s - loss: 3.1562 - accuracy30: 0.4415 - val_loss: 3.1829 - val_accuracy30: 0.4255 - 29s/epoch - 42ms/step
Epoch 16/50
694/694 - 32s - loss: 3.1537 - accuracy30: 0.4449 - val_loss: 3.1817 - val_accuracy30: 0.4272 - 32s/epoch - 45ms/step
Epoch 17/50
694/694 - 30s - loss: 3.1502 - accuracy30: 0.4455 - val_loss: 3.1815 - val_accuracy30: 0.4269 - 30s/epoch - 43ms/step
Epoch 18/50
694/694 - 30s - loss: 3.1458 - accuracy30: 0.4467 - val_loss: 3.1829 - val_accuracy30: 0.4252 - 30s/epoch - 43ms/step
Epoch 19/50
694/694 - 30s - loss: 3.1435 - accuracy30: 0.4479 - val_loss: 3.1872 - val_accuracy30: 0.4275 - 30s/epoch - 43ms/step
Epoch 20/50
694/694 - 30s - loss: 3.1398 - accuracy30: 0.4493 - val_loss: 3.1884 - val_accuracy30: 0.4282 - 30s/epoch - 43ms/step
Epoch 21/50
694/694 - 29s - loss: 3.1366 - accuracy30: 0.4505 - val_loss: 3.1882 - val_accuracy30: 0.4273 - 29s/epoch - 42ms/step
Epoch 22/50
694/694 - 30s - loss: 3.1332 - accuracy30: 0.4511 - val_loss: 3.1942 - val_accuracy30: 0.4274 - 30s/epoch - 43ms/step
Epoch 23/50
694/694 - 30s - loss: 3.1308 - accuracy30: 0.4512 - val_loss: 3.1934 - val_accuracy30: 0.4270 - 30s/epoch - 43ms/step
Epoch 24/50
694/694 - 29s - loss: 3.1273 - accuracy30: 0.4541 - val_loss: 3.1895 - val_accuracy30: 0.4290 - 29s/epoch - 42ms/step
Epoch 25/50
694/694 - 31s - loss: 3.1257 - accuracy30: 0.4539 - val_loss: 3.1982 - val_accuracy30: 0.4255 - 31s/epoch - 45ms/step
Epoch 26/50
694/694 - 31s - loss: 3.1223 - accuracy30: 0.4552 - val_loss: 3.1918 - val_accuracy30: 0.4285 - 31s/epoch - 45ms/step
Epoch 27/50
694/694 - 30s - loss: 3.1195 - accuracy30: 0.4566 - val_loss: 3.1945 - val_accuracy30: 0.4267 - 30s/epoch - 44ms/step
testing model: results/PCAR/W5/deepVOL_L3/h30
Evaluating performance on  test set...
2900/2900 - 57s - 57s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0784065
{'0': {'precision': 0.4239170723269663, 'recall': 0.5234744201480668, 'f1-score': 0.46846471683525875, 'support': 262179}, '1': {'precision': 0.3398893299651149, 'recall': 0.05229744111794919, 'f1-score': 0.09064733199124166, 'support': 216110}, '2': {'precision': 0.41860211649548207, 'recall': 0.6108630698794634, 'f1-score': 0.496779448833811, 'support': 264069}, 'accuracy': 0.41739430301822034, 'macro avg': {'precision': 0.39413617292918773, 'recall': 0.3955449770484931, 'f1-score': 0.35196383255343716, 'support': 742358}, 'weighted avg': {'precision': 0.3975648938991943, 'recall': 0.41739430301822034, 'f1-score': 0.36854921504971205, 'support': 742358}}
[[137244  10760 114175]
 [ 94939  11302 109869]
 [ 91569  11190 161310]]
Evaluating performance on  train set...
694/694 - 15s - 15s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0564933
{'0': {'precision': 0.435614071669, 'recall': 0.4901954211778903, 'f1-score': 0.46129581729859315, 'support': 59666}, '1': {'precision': 0.4458961995126251, 'recall': 0.29157484319376165, 'f1-score': 0.35258906973883813, 'support': 58990}, '2': {'precision': 0.42656428233592075, 'recall': 0.5202049333288095, 'f1-score': 0.46875382169499813, 'support': 58946}, 'accuracy': 0.4341842997263544, 'macro avg': {'precision': 0.4360248511725153, 'recall': 0.4339917325668205, 'f1-score': 0.4275462362441432, 'support': 177602}, 'weighted avg': {'precision': 0.43602563144573536, 'recall': 0.4341842997263544, 'f1-score': 0.42766448706920684, 'support': 177602}}
[[29248 10509 19909]
 [20477 17200 21313]
 [17417 10865 30664]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.060137
{'0': {'precision': 0.4291742591349381, 'recall': 0.45038244766505636, 'f1-score': 0.43952266365466774, 'support': 19872}, '1': {'precision': 0.4559786409001335, 'recall': 0.33698205393216196, 'f1-score': 0.387551665451009, 'support': 21286}, '2': {'precision': 0.40709167284408204, 'recall': 0.5015475163630828, 'f1-score': 0.44941010661271624, 'support': 19709}, 'accuracy': 0.4272922930323492, 'macro avg': {'precision': 0.4307481909597179, 'recall': 0.42963733932010034, 'f1-score': 0.42549481190613103, 'support': 60867}, 'weighted avg': {'precision': 0.4313976704587666, 'recall': 0.4272922930323492, 'f1-score': 0.4245493110251164, 'support': 60867}}
[[8950 4239 6683]
 [6399 7173 7714]
 [5505 4319 9885]]
training model: results/PCAR/W5/deepVOL_L3/h50
Epoch 1/50
694/694 - 33s - loss: 3.3001 - accuracy50: 0.3694 - val_loss: 3.3060 - val_accuracy50: 0.3400 - 33s/epoch - 47ms/step
Epoch 2/50
694/694 - 33s - loss: 3.2721 - accuracy50: 0.3822 - val_loss: 3.2888 - val_accuracy50: 0.3518 - 33s/epoch - 47ms/step
Epoch 3/50
694/694 - 31s - loss: 3.2624 - accuracy50: 0.3902 - val_loss: 3.2929 - val_accuracy50: 0.3515 - 31s/epoch - 44ms/step
Epoch 4/50
694/694 - 30s - loss: 3.2502 - accuracy50: 0.3962 - val_loss: 3.2819 - val_accuracy50: 0.3609 - 30s/epoch - 43ms/step
Epoch 5/50
694/694 - 30s - loss: 3.2381 - accuracy50: 0.4034 - val_loss: 3.2780 - val_accuracy50: 0.3621 - 30s/epoch - 43ms/step
Epoch 6/50
694/694 - 30s - loss: 3.2269 - accuracy50: 0.4109 - val_loss: 3.2592 - val_accuracy50: 0.3795 - 30s/epoch - 43ms/step
Epoch 7/50
694/694 - 32s - loss: 3.2134 - accuracy50: 0.4175 - val_loss: 3.2491 - val_accuracy50: 0.3929 - 32s/epoch - 46ms/step
Epoch 8/50
694/694 - 31s - loss: 3.2065 - accuracy50: 0.4217 - val_loss: 3.2396 - val_accuracy50: 0.3982 - 31s/epoch - 45ms/step
Epoch 9/50
694/694 - 31s - loss: 3.1996 - accuracy50: 0.4246 - val_loss: 3.2384 - val_accuracy50: 0.3968 - 31s/epoch - 45ms/step
Epoch 10/50
694/694 - 31s - loss: 3.1950 - accuracy50: 0.4269 - val_loss: 3.2300 - val_accuracy50: 0.4036 - 31s/epoch - 45ms/step
Epoch 11/50
694/694 - 31s - loss: 3.1946 - accuracy50: 0.4261 - val_loss: 3.2357 - val_accuracy50: 0.4028 - 31s/epoch - 45ms/step
Epoch 12/50
694/694 - 31s - loss: 3.1939 - accuracy50: 0.4268 - val_loss: 3.2401 - val_accuracy50: 0.4015 - 31s/epoch - 45ms/step
Epoch 13/50
694/694 - 31s - loss: 3.1892 - accuracy50: 0.4306 - val_loss: 3.2354 - val_accuracy50: 0.4027 - 31s/epoch - 45ms/step
Epoch 14/50
694/694 - 31s - loss: 3.1873 - accuracy50: 0.4301 - val_loss: 3.2373 - val_accuracy50: 0.4025 - 31s/epoch - 44ms/step
Epoch 15/50
694/694 - 31s - loss: 3.1839 - accuracy50: 0.4324 - val_loss: 3.2391 - val_accuracy50: 0.4007 - 31s/epoch - 45ms/step
Epoch 16/50
694/694 - 30s - loss: 3.1810 - accuracy50: 0.4339 - val_loss: 3.2329 - val_accuracy50: 0.4032 - 30s/epoch - 43ms/step
Epoch 17/50
694/694 - 31s - loss: 3.1779 - accuracy50: 0.4339 - val_loss: 3.2385 - val_accuracy50: 0.4018 - 31s/epoch - 45ms/step
Epoch 18/50
694/694 - 29s - loss: 3.1745 - accuracy50: 0.4356 - val_loss: 3.2361 - val_accuracy50: 0.4000 - 29s/epoch - 41ms/step
Epoch 19/50
694/694 - 29s - loss: 3.1713 - accuracy50: 0.4370 - val_loss: 3.2349 - val_accuracy50: 0.4033 - 29s/epoch - 42ms/step
Epoch 20/50
694/694 - 29s - loss: 3.1693 - accuracy50: 0.4390 - val_loss: 3.2337 - val_accuracy50: 0.4023 - 29s/epoch - 42ms/step
testing model: results/PCAR/W5/deepVOL_L3/h50
Evaluating performance on  test set...
2900/2900 - 58s - 58s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0762028
{'0': {'precision': 0.433792613133708, 'recall': 0.47298415949938966, 'f1-score': 0.4525414428609543, 'support': 285092}, '1': {'precision': 0.2607621223133631, 'recall': 0.07321054810254257, 'f1-score': 0.11432395276637199, 'support': 171519}, '2': {'precision': 0.424432769711546, 'recall': 0.5694128022341441, 'f1-score': 0.4863480999131671, 'support': 285747}, 'accuracy': 0.4177351089366586, 'macro avg': {'precision': 0.37299583505287237, 'recall': 0.37186916994535874, 'f1-score': 0.3510711651801645, 'support': 742358}, 'weighted avg': {'precision': 0.3902118018090274, 'recall': 0.4177351089366586, 'f1-score': 0.38741036748918756, 'support': 742358}}
[[134844  16933 133315]
 [ 71631  12557  87331]
 [104374  18665 162708]]
Evaluating performance on  train set...
694/694 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0727999
{'0': {'precision': 0.4116634682750008, 'recall': 0.45499537076003704, 'f1-score': 0.43224614794143756, 'support': 59405}, '1': {'precision': 0.435600335852225, 'recall': 0.30291605498465235, 'f1-score': 0.3573389485284712, 'support': 59944}, '2': {'precision': 0.3966039937943893, 'recall': 0.4783444629461144, 'f1-score': 0.4336560009960159, 'support': 58253}, 'accuracy': 0.4113241967995856, 'macro avg': {'precision': 0.414622599307205, 'recall': 0.4120852962302679, 'f1-score': 0.4077470324886416, 'support': 177602}, 'weighted avg': {'precision': 0.41480314025577847, 'recall': 0.4113241967995856, 'f1-score': 0.4074259939362884, 'support': 177602}}
[[27029 11257 21119]
 [20511 18158 21275]
 [18118 12270 27865]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0774055
{'0': {'precision': 0.39766330826356366, 'recall': 0.42521875474179355, 'f1-score': 0.4109796636683613, 'support': 19771}, '1': {'precision': 0.4414263565891473, 'recall': 0.3322907427290976, 'f1-score': 0.37916156181750377, 'support': 21421}, '2': {'precision': 0.38244142197364517, 'recall': 0.45875476493011436, 'f1-score': 0.4171365190867918, 'support': 19675}, 'accuracy': 0.4033548556689175, 'macro avg': {'precision': 0.40717702894211866, 'recall': 0.4054214208003352, 'f1-score': 0.40242591485755225, 'support': 60867}, 'weighted avg': {'precision': 0.4081444827165215, 'recall': 0.4033548556689175, 'f1-score': 0.4017720564363702, 'support': 60867}}
[[8407 4330 7034]
 [6762 7118 7541]
 [5972 4677 9026]]
training model: results/PCAR/W5/deepVOL_L3/h100
Epoch 1/50
694/694 - 32s - loss: 3.3218 - accuracy100: 0.3514 - val_loss: 3.3093 - val_accuracy100: 0.3404 - 32s/epoch - 46ms/step
Epoch 2/50
694/694 - 30s - loss: 3.2928 - accuracy100: 0.3546 - val_loss: 3.3088 - val_accuracy100: 0.3436 - 30s/epoch - 43ms/step
Epoch 3/50
694/694 - 29s - loss: 3.2920 - accuracy100: 0.3549 - val_loss: 3.3034 - val_accuracy100: 0.3472 - 29s/epoch - 42ms/step
Epoch 4/50
694/694 - 30s - loss: 3.2829 - accuracy100: 0.3659 - val_loss: 3.2974 - val_accuracy100: 0.3573 - 30s/epoch - 43ms/step
Epoch 5/50
694/694 - 29s - loss: 3.2763 - accuracy100: 0.3712 - val_loss: 3.2894 - val_accuracy100: 0.3638 - 29s/epoch - 42ms/step
Epoch 6/50
694/694 - 30s - loss: 3.2706 - accuracy100: 0.3763 - val_loss: 3.2849 - val_accuracy100: 0.3687 - 30s/epoch - 43ms/step
Epoch 7/50
694/694 - 29s - loss: 3.2639 - accuracy100: 0.3847 - val_loss: 3.2825 - val_accuracy100: 0.3749 - 29s/epoch - 42ms/step
Epoch 8/50
694/694 - 29s - loss: 3.2580 - accuracy100: 0.3890 - val_loss: 3.2796 - val_accuracy100: 0.3737 - 29s/epoch - 42ms/step
Epoch 9/50
694/694 - 29s - loss: 3.2517 - accuracy100: 0.3926 - val_loss: 3.2774 - val_accuracy100: 0.3748 - 29s/epoch - 42ms/step
Epoch 10/50
694/694 - 29s - loss: 3.2452 - accuracy100: 0.3965 - val_loss: 3.2776 - val_accuracy100: 0.3754 - 29s/epoch - 42ms/step
Epoch 11/50
694/694 - 29s - loss: 3.2404 - accuracy100: 0.4010 - val_loss: 3.2792 - val_accuracy100: 0.3733 - 29s/epoch - 42ms/step
Epoch 12/50
694/694 - 29s - loss: 3.2362 - accuracy100: 0.4032 - val_loss: 3.2797 - val_accuracy100: 0.3757 - 29s/epoch - 42ms/step
Epoch 13/50
694/694 - 29s - loss: 3.2324 - accuracy100: 0.4061 - val_loss: 3.2804 - val_accuracy100: 0.3737 - 29s/epoch - 42ms/step
Epoch 14/50
694/694 - 30s - loss: 3.2286 - accuracy100: 0.4078 - val_loss: 3.2905 - val_accuracy100: 0.3729 - 30s/epoch - 43ms/step
Epoch 15/50
694/694 - 29s - loss: 3.2245 - accuracy100: 0.4099 - val_loss: 3.2839 - val_accuracy100: 0.3686 - 29s/epoch - 42ms/step
Epoch 16/50
694/694 - 29s - loss: 3.2210 - accuracy100: 0.4119 - val_loss: 3.2899 - val_accuracy100: 0.3708 - 29s/epoch - 42ms/step
Epoch 17/50
694/694 - 29s - loss: 3.2175 - accuracy100: 0.4142 - val_loss: 3.2904 - val_accuracy100: 0.3735 - 29s/epoch - 42ms/step
Epoch 18/50
694/694 - 29s - loss: 3.2144 - accuracy100: 0.4161 - val_loss: 3.2990 - val_accuracy100: 0.3713 - 29s/epoch - 42ms/step
Epoch 19/50
694/694 - 30s - loss: 3.2126 - accuracy100: 0.4160 - val_loss: 3.3021 - val_accuracy100: 0.3704 - 30s/epoch - 43ms/step
testing model: results/PCAR/W5/deepVOL_L3/h100
Evaluating performance on  test set...
2900/2900 - 59s - 59s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0929352
{'0': {'precision': 0.3724200554099853, 'recall': 0.6415587677833344, 'f1-score': 0.4712708912286195, 'support': 262746}, '1': {'precision': 0.3410276164513453, 'recall': 0.05272561514744756, 'f1-score': 0.09133075955544799, 'support': 218281}, '2': {'precision': 0.376863397712357, 'recall': 0.3691525306986159, 'f1-score': 0.37296811420507814, 'support': 261331}, 'accuracy': 0.37252511591442405, 'macro avg': {'precision': 0.36343702319122917, 'recall': 0.3544789712097993, 'f1-score': 0.3118565883297152, 'support': 742358}, 'weighted avg': {'precision': 0.36475368705252187, 'recall': 0.37252511591442405, 'f1-score': 0.32494893483549026, 'support': 742358}}
[[168567  10422  83757]
 [131016  11509  75756]
 [153043  11817  96471]]
Evaluating performance on  train set...
694/694 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0863893
{'0': {'precision': 0.3811099848995718, 'recall': 0.6077719865408722, 'f1-score': 0.4684643451949604, 'support': 60628}, '1': {'precision': 0.39237616982424106, 'recall': 0.20971452473073304, 'f1-score': 0.2733374978704072, 'support': 57378}, '2': {'precision': 0.38691317240144085, 'recall': 0.32622994831867913, 'f1-score': 0.353989712777095, 'support': 59596}, 'accuracy': 0.3846972444004009, 'macro avg': {'precision': 0.3867997757084179, 'recall': 0.38123881986342817, 'f1-score': 0.3652638519474875, 'support': 177602}, 'weighted avg': {'precision': 0.3866970724378262, 'recall': 0.3846972444004009, 'f1-score': 0.3670115550272634, 'support': 177602}}
[[36848  8564 15216]
 [29754 12033 15591]
 [30084 10070 19442]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0908175
{'0': {'precision': 0.36548950303178035, 'recall': 0.5854932396153658, 'f1-score': 0.4500431471128953, 'support': 20487}, '1': {'precision': 0.39286005379411526, 'recall': 0.2398129260162197, 'f1-score': 0.29782501235788433, 'support': 20099}, '2': {'precision': 0.3810127384498384, 'recall': 0.2964350870272669, 'f1-score': 0.3334442595673877, 'support': 20281}, 'accuracy': 0.3750308048696338, 'macro avg': {'precision': 0.37978743175857793, 'recall': 0.37391375088628415, 'f1-score': 0.36043747301272244, 'support': 60867}, 'weighted avg': {'precision': 0.37969995265613843, 'recall': 0.3750308048696338, 'f1-score': 0.3609279561432171, 'support': 60867}}
[[11995  3496  4996]
 [10508  4820  4771]
 [10316  3953  6012]]
training model: results/PCAR/W5/deepVOL_L3/h200
Epoch 1/50
694/694 - 32s - loss: 3.3152 - accuracy200: 0.3630 - val_loss: 3.3071 - val_accuracy200: 0.3508 - 32s/epoch - 46ms/step
Epoch 2/50
694/694 - 29s - loss: 3.2799 - accuracy200: 0.3715 - val_loss: 3.2879 - val_accuracy200: 0.3600 - 29s/epoch - 42ms/step
Epoch 3/50
694/694 - 30s - loss: 3.2655 - accuracy200: 0.3798 - val_loss: 3.2650 - val_accuracy200: 0.3801 - 30s/epoch - 43ms/step
Epoch 4/50
694/694 - 30s - loss: 3.2567 - accuracy200: 0.3877 - val_loss: 3.2607 - val_accuracy200: 0.3810 - 30s/epoch - 44ms/step
Epoch 5/50
694/694 - 30s - loss: 3.2509 - accuracy200: 0.3915 - val_loss: 3.2587 - val_accuracy200: 0.3849 - 30s/epoch - 43ms/step
Epoch 6/50
694/694 - 30s - loss: 3.2469 - accuracy200: 0.3958 - val_loss: 3.2584 - val_accuracy200: 0.3825 - 30s/epoch - 44ms/step
Epoch 7/50
694/694 - 30s - loss: 3.2418 - accuracy200: 0.3987 - val_loss: 3.2568 - val_accuracy200: 0.3853 - 30s/epoch - 43ms/step
Epoch 8/50
694/694 - 30s - loss: 3.2398 - accuracy200: 0.4007 - val_loss: 3.2555 - val_accuracy200: 0.3889 - 30s/epoch - 43ms/step
Epoch 9/50
694/694 - 30s - loss: 3.2337 - accuracy200: 0.4027 - val_loss: 3.2549 - val_accuracy200: 0.3844 - 30s/epoch - 43ms/step
Epoch 10/50
694/694 - 28s - loss: 3.2317 - accuracy200: 0.4052 - val_loss: 3.2573 - val_accuracy200: 0.3839 - 28s/epoch - 41ms/step
Epoch 11/50
694/694 - 29s - loss: 3.2283 - accuracy200: 0.4079 - val_loss: 3.2605 - val_accuracy200: 0.3817 - 29s/epoch - 42ms/step
Epoch 12/50
694/694 - 29s - loss: 3.2242 - accuracy200: 0.4104 - val_loss: 3.2603 - val_accuracy200: 0.3830 - 29s/epoch - 42ms/step
Epoch 13/50
694/694 - 29s - loss: 3.2216 - accuracy200: 0.4115 - val_loss: 3.2651 - val_accuracy200: 0.3794 - 29s/epoch - 42ms/step
Epoch 14/50
694/694 - 30s - loss: 3.2167 - accuracy200: 0.4137 - val_loss: 3.2700 - val_accuracy200: 0.3789 - 30s/epoch - 43ms/step
Epoch 15/50
694/694 - 30s - loss: 3.2130 - accuracy200: 0.4155 - val_loss: 3.2691 - val_accuracy200: 0.3805 - 30s/epoch - 43ms/step
Epoch 16/50
694/694 - 30s - loss: 3.2088 - accuracy200: 0.4171 - val_loss: 3.2684 - val_accuracy200: 0.3822 - 30s/epoch - 43ms/step
Epoch 17/50
694/694 - 30s - loss: 3.2058 - accuracy200: 0.4189 - val_loss: 3.2741 - val_accuracy200: 0.3776 - 30s/epoch - 43ms/step
Epoch 18/50
694/694 - 30s - loss: 3.2012 - accuracy200: 0.4205 - val_loss: 3.2828 - val_accuracy200: 0.3787 - 30s/epoch - 43ms/step
Epoch 19/50
694/694 - 30s - loss: 3.1976 - accuracy200: 0.4219 - val_loss: 3.2780 - val_accuracy200: 0.3809 - 30s/epoch - 43ms/step
testing model: results/PCAR/W5/deepVOL_L3/h200
Evaluating performance on  test set...
2900/2900 - 59s - 59s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0960786
{'0': {'precision': 0.36121919912676115, 'recall': 0.5428499823428227, 'f1-score': 0.43378944861079294, 'support': 263349}, '1': {'precision': 0.3386077079687109, 'recall': 0.12951350465182998, 'f1-score': 0.1873628871276953, 'support': 219591}, '2': {'precision': 0.3574956492598982, 'recall': 0.36187928362719624, 'f1-score': 0.35967411023012663, 'support': 259418}, 'accuracy': 0.35734376136581003, 'macro avg': {'precision': 0.35244085211845677, 'recall': 0.34474759020728296, 'f1-score': 0.32694214865620497, 'support': 742358}, 'weighted avg': {'precision': 0.3532294747427722, 'recall': 0.35734376136581003, 'f1-score': 0.334996268077047, 'support': 742358}}
[[142959  28107  92283]
 [114713  28440  76438]
 [138096  27444  93878]]
Evaluating performance on  train set...
694/694 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0865955
{'0': {'precision': 0.3714613103262335, 'recall': 0.4599859775641026, 'f1-score': 0.41101100802482027, 'support': 59904}, '1': {'precision': 0.40334638661445354, 'recall': 0.40580921355596866, 'f1-score': 0.4045740520319674, 'support': 58631}, '2': {'precision': 0.3686899376589472, 'recall': 0.2773460646384614, 'f1-score': 0.31656038647342993, 'support': 59067}, 'accuracy': 0.381358318036959, 'macro avg': {'precision': 0.38116587819987807, 'recall': 0.3810470852528442, 'f1-score': 0.37738181551007255, 'support': 177602}, 'weighted avg': {'precision': 0.3810656911244003, 'recall': 0.381358318036959, 'f1-score': 0.37747354769220615, 'support': 177602}}
[[27555 16950 15399]
 [22186 23793 12652]
 [24439 18246 16382]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0849606
{'0': {'precision': 0.3581304851796655, 'recall': 0.4353142454586625, 'f1-score': 0.3929682709123532, 'support': 19873}, '1': {'precision': 0.4288142416245471, 'recall': 0.4563934114062649, 'f1-score': 0.4421742038143118, 'support': 21006}, '2': {'precision': 0.35390831823881846, 'recall': 0.25415249149489694, 'f1-score': 0.2958476501077398, 'support': 19988}, 'accuracy': 0.38309757339773604, 'macro avg': {'precision': 0.38028434834767705, 'recall': 0.3819533827866081, 'f1-score': 0.3769967082781349, 'support': 60867}, 'weighted avg': {'precision': 0.38113786709544145, 'recall': 0.38309757339773604, 'f1-score': 0.3780566251584295, 'support': 60867}}
[[8651 6104 5118]
 [7263 9587 4156]
 [8242 6666 5080]]
training model: results/PCAR/W5/deepVOL_L3/h300
Epoch 1/50
694/694 - 31s - loss: 3.3206 - accuracy300: 0.3603 - val_loss: 3.3252 - val_accuracy300: 0.3198 - 31s/epoch - 45ms/step
Epoch 2/50
694/694 - 29s - loss: 3.2932 - accuracy300: 0.3588 - val_loss: 3.3053 - val_accuracy300: 0.3284 - 29s/epoch - 42ms/step
Epoch 3/50
694/694 - 29s - loss: 3.2911 - accuracy300: 0.3539 - val_loss: 3.2984 - val_accuracy300: 0.3381 - 29s/epoch - 42ms/step
Epoch 4/50
694/694 - 29s - loss: 3.2879 - accuracy300: 0.3590 - val_loss: 3.2949 - val_accuracy300: 0.3486 - 29s/epoch - 42ms/step
Epoch 5/50
694/694 - 29s - loss: 3.2791 - accuracy300: 0.3705 - val_loss: 3.2924 - val_accuracy300: 0.3556 - 29s/epoch - 41ms/step
Epoch 6/50
694/694 - 30s - loss: 3.2690 - accuracy300: 0.3796 - val_loss: 3.2809 - val_accuracy300: 0.3659 - 30s/epoch - 43ms/step
Epoch 7/50
694/694 - 29s - loss: 3.2588 - accuracy300: 0.3877 - val_loss: 3.2889 - val_accuracy300: 0.3578 - 29s/epoch - 42ms/step
Epoch 8/50
694/694 - 34s - loss: 3.2512 - accuracy300: 0.3909 - val_loss: 3.2796 - val_accuracy300: 0.3695 - 34s/epoch - 49ms/step
Epoch 9/50
694/694 - 29s - loss: 3.2470 - accuracy300: 0.3932 - val_loss: 3.2803 - val_accuracy300: 0.3697 - 29s/epoch - 42ms/step
Epoch 10/50
694/694 - 30s - loss: 3.2392 - accuracy300: 0.3984 - val_loss: 3.2827 - val_accuracy300: 0.3682 - 30s/epoch - 44ms/step
Epoch 11/50
694/694 - 30s - loss: 3.2345 - accuracy300: 0.3998 - val_loss: 3.2851 - val_accuracy300: 0.3647 - 30s/epoch - 43ms/step
Epoch 12/50
694/694 - 29s - loss: 3.2313 - accuracy300: 0.4012 - val_loss: 3.2876 - val_accuracy300: 0.3647 - 29s/epoch - 42ms/step
Epoch 13/50
694/694 - 29s - loss: 3.2252 - accuracy300: 0.4045 - val_loss: 3.2976 - val_accuracy300: 0.3618 - 29s/epoch - 42ms/step
Epoch 14/50
694/694 - 29s - loss: 3.2220 - accuracy300: 0.4065 - val_loss: 3.2987 - val_accuracy300: 0.3612 - 29s/epoch - 42ms/step
Epoch 15/50
694/694 - 29s - loss: 3.2200 - accuracy300: 0.4087 - val_loss: 3.2894 - val_accuracy300: 0.3664 - 29s/epoch - 42ms/step
Epoch 16/50
694/694 - 29s - loss: 3.2132 - accuracy300: 0.4114 - val_loss: 3.2945 - val_accuracy300: 0.3633 - 29s/epoch - 42ms/step
Epoch 17/50
694/694 - 29s - loss: 3.2101 - accuracy300: 0.4124 - val_loss: 3.2957 - val_accuracy300: 0.3624 - 29s/epoch - 42ms/step
Epoch 18/50
694/694 - 29s - loss: 3.2023 - accuracy300: 0.4180 - val_loss: 3.2959 - val_accuracy300: 0.3656 - 29s/epoch - 42ms/step
testing model: results/PCAR/W5/deepVOL_L3/h300
Evaluating performance on  test set...
2900/2900 - 58s - 58s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.093395
{'0': {'precision': 0.3643046384490965, 'recall': 0.4677892417407358, 'f1-score': 0.40961193115338607, 'support': 268668}, '1': {'precision': 0.34777982006384833, 'recall': 0.06855290444068363, 'f1-score': 0.11453011194163584, 'support': 209765}, '2': {'precision': 0.3607228726153293, 'recall': 0.4866003599507436, 'f1-score': 0.41431149981692045, 'support': 263925}, 'accuracy': 0.36166647358821485, 'macro avg': {'precision': 0.35760244370942473, 'recall': 0.3409808353773876, 'f1-score': 0.3128178476373141, 'support': 742358}, 'weighted avg': {'precision': 0.3583618910465514, 'recall': 0.36166647358821485, 'f1-score': 0.3279026963267533, 'support': 742358}}
[[125680  12852 130136]
 [ 97923  14380  97462]
 [121383  14116 128426]]
Evaluating performance on  train set...
694/694 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0913401
{'0': {'precision': 0.35747255326361904, 'recall': 0.4610830810628994, 'f1-score': 0.40272044890344755, 'support': 59460}, '1': {'precision': 0.41651069711192373, 'recall': 0.2424857090171492, 'f1-score': 0.30652031107626454, 'support': 59653}, '2': {'precision': 0.3560343915743665, 'recall': 0.4028449793978355, 'f1-score': 0.3779959572624892, 'support': 58489}, 'accuracy': 0.3684812107971757, 'macro avg': {'precision': 0.3766725473166364, 'recall': 0.3688045898259613, 'f1-score': 0.3624122390807338, 'support': 177602}, 'weighted avg': {'precision': 0.376828674005166, 'recall': 0.3684812107971757, 'f1-score': 0.36226630078916416, 'support': 177602}}
[[27416  9698 22346]
 [24917 14465 20271]
 [24361 10566 23562]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0939481
{'0': {'precision': 0.3425283465899475, 'recall': 0.4144780627655762, 'f1-score': 0.37508397229493384, 'support': 19533}, '1': {'precision': 0.4603252488434039, 'recall': 0.29963042387188027, 'f1-score': 0.3629881436033497, 'support': 21917}, '2': {'precision': 0.33376877857609405, 'recall': 0.394757171550703, 'f1-score': 0.3617101599735737, 'support': 19417}, 'accuracy': 0.36683260223109404, 'macro avg': {'precision': 0.3788741246698151, 'recall': 0.36962188606271984, 'f1-score': 0.3665940919572857, 'support': 60867}, 'weighted avg': {'precision': 0.38215031209775985, 'recall': 0.36683260223109404, 'f1-score': 0.366462164233467, 'support': 60867}}
[[8096 3713 7724]
 [7774 6567 7576]
 [7766 3986 7665]]
training model: results/PCAR/W5/deepVOL_L3/h500
Epoch 1/50
694/694 - 32s - loss: 3.3251 - accuracy500: 0.3591 - val_loss: 3.3231 - val_accuracy500: 0.3259 - 32s/epoch - 46ms/step
Epoch 2/50
694/694 - 31s - loss: 3.2994 - accuracy500: 0.3426 - val_loss: 3.3051 - val_accuracy500: 0.3277 - 31s/epoch - 45ms/step
Epoch 3/50
694/694 - 31s - loss: 3.2949 - accuracy500: 0.3463 - val_loss: 3.3063 - val_accuracy500: 0.3328 - 31s/epoch - 44ms/step
Epoch 4/50
694/694 - 30s - loss: 3.2898 - accuracy500: 0.3516 - val_loss: 3.3170 - val_accuracy500: 0.3318 - 30s/epoch - 44ms/step
Epoch 5/50
694/694 - 31s - loss: 3.2879 - accuracy500: 0.3529 - val_loss: 3.3033 - val_accuracy500: 0.3421 - 31s/epoch - 45ms/step
Epoch 6/50
694/694 - 31s - loss: 3.2740 - accuracy500: 0.3681 - val_loss: 3.2948 - val_accuracy500: 0.3543 - 31s/epoch - 45ms/step
Epoch 7/50
694/694 - 31s - loss: 3.2695 - accuracy500: 0.3756 - val_loss: 3.3075 - val_accuracy500: 0.3472 - 31s/epoch - 45ms/step
Epoch 8/50
694/694 - 32s - loss: 3.2634 - accuracy500: 0.3799 - val_loss: 3.2947 - val_accuracy500: 0.3577 - 32s/epoch - 46ms/step
Epoch 9/50
694/694 - 31s - loss: 3.2602 - accuracy500: 0.3837 - val_loss: 3.2899 - val_accuracy500: 0.3633 - 31s/epoch - 45ms/step
Epoch 10/50
694/694 - 32s - loss: 3.2564 - accuracy500: 0.3875 - val_loss: 3.3003 - val_accuracy500: 0.3606 - 32s/epoch - 46ms/step
Epoch 11/50
694/694 - 31s - loss: 3.2546 - accuracy500: 0.3872 - val_loss: 3.3030 - val_accuracy500: 0.3620 - 31s/epoch - 45ms/step
Epoch 12/50
694/694 - 31s - loss: 3.2496 - accuracy500: 0.3932 - val_loss: 3.3040 - val_accuracy500: 0.3573 - 31s/epoch - 45ms/step
Epoch 13/50
694/694 - 31s - loss: 3.2511 - accuracy500: 0.3926 - val_loss: 3.3038 - val_accuracy500: 0.3544 - 31s/epoch - 44ms/step
Epoch 14/50
694/694 - 31s - loss: 3.2464 - accuracy500: 0.3947 - val_loss: 3.3007 - val_accuracy500: 0.3599 - 31s/epoch - 45ms/step
Epoch 15/50
694/694 - 31s - loss: 3.2433 - accuracy500: 0.3978 - val_loss: 3.2975 - val_accuracy500: 0.3554 - 31s/epoch - 45ms/step
Epoch 16/50
694/694 - 30s - loss: 3.2402 - accuracy500: 0.3979 - val_loss: 3.2897 - val_accuracy500: 0.3591 - 30s/epoch - 44ms/step
Epoch 17/50
694/694 - 30s - loss: 3.2369 - accuracy500: 0.4011 - val_loss: 3.2938 - val_accuracy500: 0.3620 - 30s/epoch - 44ms/step
Epoch 18/50
694/694 - 31s - loss: 3.2315 - accuracy500: 0.4033 - val_loss: 3.2938 - val_accuracy500: 0.3561 - 31s/epoch - 44ms/step
Epoch 19/50
694/694 - 31s - loss: 3.2268 - accuracy500: 0.4057 - val_loss: 3.2960 - val_accuracy500: 0.3579 - 31s/epoch - 44ms/step
Epoch 20/50
694/694 - 31s - loss: 3.2266 - accuracy500: 0.4076 - val_loss: 3.3003 - val_accuracy500: 0.3496 - 31s/epoch - 45ms/step
Epoch 21/50
694/694 - 31s - loss: 3.2214 - accuracy500: 0.4089 - val_loss: 3.3078 - val_accuracy500: 0.3503 - 31s/epoch - 44ms/step
Epoch 22/50
694/694 - 31s - loss: 3.2186 - accuracy500: 0.4141 - val_loss: 3.3082 - val_accuracy500: 0.3471 - 31s/epoch - 45ms/step
Epoch 23/50
694/694 - 30s - loss: 3.2249 - accuracy500: 0.4088 - val_loss: 3.3114 - val_accuracy500: 0.3437 - 30s/epoch - 44ms/step
Epoch 24/50
694/694 - 32s - loss: 3.2104 - accuracy500: 0.4162 - val_loss: 3.3185 - val_accuracy500: 0.3473 - 32s/epoch - 46ms/step
Epoch 25/50
694/694 - 32s - loss: 3.2059 - accuracy500: 0.4183 - val_loss: 3.3184 - val_accuracy500: 0.3432 - 32s/epoch - 45ms/step
Epoch 26/50
694/694 - 30s - loss: 3.2017 - accuracy500: 0.4189 - val_loss: 3.3251 - val_accuracy500: 0.3417 - 30s/epoch - 44ms/step
testing model: results/PCAR/W5/deepVOL_L3/h500
Evaluating performance on  test set...
2900/2900 - 57s - 57s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0967604
{'0': {'precision': 0.36318638959946736, 'recall': 0.31357525102584954, 'f1-score': 0.3365624067658323, 'support': 264415}, '1': {'precision': 0.331937420004225, 'recall': 0.12280927598065358, 'f1-score': 0.17928659880999123, 'support': 217508}, '2': {'precision': 0.350562398953848, 'recall': 0.5836389118206078, 'f1-score': 0.4380251979758625, 'support': 260435}, 'accuracy': 0.35242564908036283, 'macro avg': {'precision': 0.3485620695191802, 'recall': 0.34000781294237026, 'f1-score': 0.317958067850562, 'support': 742358}, 'weighted avg': {'precision': 0.34960179849583023, 'recall': 0.35242564908036283, 'f1-score': 0.3260765166588019, 'support': 742358}}
[[ 82914  26374 155127]
 [ 64334  26712 126462]
 [ 81048  27387 152000]]
Evaluating performance on  train set...
694/694 - 17s - 17s/epoch - 24ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0910473
{'0': {'precision': 0.37237178227549617, 'recall': 0.28398021879214747, 'f1-score': 0.3222241115456555, 'support': 60057}, '1': {'precision': 0.40389965521341104, 'recall': 0.2912102041865967, 'f1-score': 0.3384204654128148, 'support': 58329}, '2': {'precision': 0.354556191919417, 'recall': 0.5373547689813564, 'f1-score': 0.4272230501738698, 'support': 59216}, 'accuracy': 0.3708347878965327, 'macro avg': {'precision': 0.37694254313610803, 'recall': 0.37084839732003355, 'f1-score': 0.36262254237744673, 'support': 177602}, 'weighted avg': {'precision': 0.3767862669213338, 'recall': 0.3708347878965327, 'f1-score': 0.36255211615442046, 'support': 177602}}
[[17055 12612 30390]
 [13807 16986 27536]
 [14939 12457 31820]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0953168
{'0': {'precision': 0.3526128186159123, 'recall': 0.26067717396708595, 'f1-score': 0.29975415928191645, 'support': 20113}, '1': {'precision': 0.41848358647721706, 'recall': 0.32611081945306164, 'f1-score': 0.3665674204018133, 'support': 20953}, '2': {'precision': 0.33201887428378835, 'recall': 0.4975001262562497, 'f1-score': 0.39825352226556976, 'support': 19801}, 'accuracy': 0.3602444674454138, 'macro avg': {'precision': 0.3677050931256392, 'recall': 0.3614293732254658, 'f1-score': 0.35485836731643317, 'support': 60867}, 'weighted avg': {'precision': 0.3685887909371624, 'recall': 0.3602444674454138, 'f1-score': 0.3547975185190157, 'support': 60867}}
[[ 5243  4619 10251]
 [ 4552  6833  9568]
 [ 5074  4876  9851]]
training model: results/PCAR/W5/deepVOL_L3/h1000
Epoch 1/50
694/694 - 32s - loss: 3.3314 - accuracy1000: 0.3620 - val_loss: 3.3167 - val_accuracy1000: 0.3227 - 32s/epoch - 46ms/step
Epoch 2/50
694/694 - 29s - loss: 3.3019 - accuracy1000: 0.3512 - val_loss: 3.3174 - val_accuracy1000: 0.3210 - 29s/epoch - 42ms/step
Epoch 3/50
694/694 - 30s - loss: 3.3028 - accuracy1000: 0.3418 - val_loss: 3.3074 - val_accuracy1000: 0.3213 - 30s/epoch - 43ms/step
Epoch 4/50
694/694 - 29s - loss: 3.2962 - accuracy1000: 0.3492 - val_loss: 3.3027 - val_accuracy1000: 0.3259 - 29s/epoch - 41ms/step
Epoch 5/50
694/694 - 29s - loss: 3.2878 - accuracy1000: 0.3634 - val_loss: 3.2992 - val_accuracy1000: 0.3435 - 29s/epoch - 42ms/step
Epoch 6/50
694/694 - 28s - loss: 3.2825 - accuracy1000: 0.3663 - val_loss: 3.2754 - val_accuracy1000: 0.3622 - 28s/epoch - 41ms/step
Epoch 7/50
694/694 - 29s - loss: 3.2782 - accuracy1000: 0.3692 - val_loss: 3.2756 - val_accuracy1000: 0.3717 - 29s/epoch - 41ms/step
Epoch 8/50
694/694 - 29s - loss: 3.2745 - accuracy1000: 0.3766 - val_loss: 3.2661 - val_accuracy1000: 0.3832 - 29s/epoch - 42ms/step
Epoch 9/50
694/694 - 28s - loss: 3.2683 - accuracy1000: 0.3829 - val_loss: 3.2735 - val_accuracy1000: 0.3725 - 28s/epoch - 41ms/step
Epoch 10/50
694/694 - 29s - loss: 3.2583 - accuracy1000: 0.3901 - val_loss: 3.2899 - val_accuracy1000: 0.3634 - 29s/epoch - 42ms/step
Epoch 11/50
694/694 - 29s - loss: 3.2546 - accuracy1000: 0.3920 - val_loss: 3.2818 - val_accuracy1000: 0.3704 - 29s/epoch - 42ms/step
Epoch 12/50
694/694 - 29s - loss: 3.2495 - accuracy1000: 0.3975 - val_loss: 3.2815 - val_accuracy1000: 0.3726 - 29s/epoch - 41ms/step
Epoch 13/50
694/694 - 30s - loss: 3.2434 - accuracy1000: 0.4017 - val_loss: 3.2927 - val_accuracy1000: 0.3695 - 30s/epoch - 43ms/step
Epoch 14/50
694/694 - 29s - loss: 3.2394 - accuracy1000: 0.4039 - val_loss: 3.2974 - val_accuracy1000: 0.3693 - 29s/epoch - 42ms/step
Epoch 15/50
694/694 - 30s - loss: 3.2330 - accuracy1000: 0.4065 - val_loss: 3.2927 - val_accuracy1000: 0.3689 - 30s/epoch - 43ms/step
Epoch 16/50
694/694 - 31s - loss: 3.2265 - accuracy1000: 0.4113 - val_loss: 3.2978 - val_accuracy1000: 0.3653 - 31s/epoch - 44ms/step
Epoch 17/50
694/694 - 30s - loss: 3.2208 - accuracy1000: 0.4150 - val_loss: 3.2958 - val_accuracy1000: 0.3650 - 30s/epoch - 43ms/step
Epoch 18/50
694/694 - 29s - loss: 3.2130 - accuracy1000: 0.4180 - val_loss: 3.3066 - val_accuracy1000: 0.3558 - 29s/epoch - 41ms/step
testing model: results/PCAR/W5/deepVOL_L3/h1000
Evaluating performance on  test set...
2900/2900 - 57s - 57s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.104246
{'0': {'precision': 0.36741031052155565, 'recall': 0.09263735595487853, 'f1-score': 0.14796692689678617, 'support': 263112}, '1': {'precision': 0.3401645474943904, 'recall': 0.18182787387723554, 'f1-score': 0.23698197102858928, 'support': 225114}, '2': {'precision': 0.3437072601891709, 'recall': 0.7515543103583964, 'f1-score': 0.47169494455558025, 'support': 254132}, 'accuracy': 0.345251213026599, 'macro avg': {'precision': 0.35042737273503893, 'recall': 0.3420065133968368, 'f1-score': 0.2855479474936519, 'support': 742358}, 'weighted avg': {'precision': 0.35103397149757143, 'recall': 0.345251213026599, 'f1-score': 0.2857820797318757, 'support': 742358}}
[[ 24374  38780 199958]
 [ 19446  40932 164736]
 [ 22520  40618 190994]]
Evaluating performance on  train set...
694/694 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0942007
{'0': {'precision': 0.3728298611111111, 'recall': 0.08575136430187674, 'f1-score': 0.1394329618006709, 'support': 60104}, '1': {'precision': 0.3931665967510957, 'recall': 0.45776071139854485, 'f1-score': 0.4230119760013073, 'support': 59376}, '2': {'precision': 0.3425993428212199, 'recall': 0.5578954612711193, 'f1-score': 0.42451020822287244, 'support': 58122}, 'accuracy': 0.3646355333836331, 'macro avg': {'precision': 0.3695319335611422, 'recall': 0.3671358456571803, 'f1-score': 0.3289850486749502, 'support': 177602}, 'weighted avg': {'precision': 0.36973561572713265, 'recall': 0.3646355333836331, 'f1-score': 0.32753358715245856, 'support': 177602}}
[[ 5154 20547 34403]
 [ 4378 27180 27818]
 [ 4292 21404 32426]]
Evaluating performance on  val set...
238/238 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.089645
{'0': {'precision': 0.3529801324503311, 'recall': 0.07958391399562015, 'f1-score': 0.12988384371700104, 'support': 20092}, '1': {'precision': 0.43044546607482564, 'recall': 0.5117078916372203, 'f1-score': 0.46757216350603786, 'support': 21225}, '2': {'precision': 0.3451535122970584, 'recall': 0.549156010230179, 'f1-score': 0.42388707926167213, 'support': 19550}, 'accuracy': 0.381093203213564, 'macro avg': {'precision': 0.3761930369407384, 'recall': 0.3801492719543398, 'f1-score': 0.34044769549490367, 'support': 60867}, 'weighted avg': {'precision': 0.37747930740857477, 'recall': 0.381093203213564, 'f1-score': 0.34207103615987855, 'support': 60867}}
[[ 1599  7025 11468]
 [ 1463 10861  8901]
 [ 1468  7346 10736]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        19 (peak)  13.32 (ave)

============================================
