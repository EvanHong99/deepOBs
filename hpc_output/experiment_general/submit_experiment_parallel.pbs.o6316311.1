This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-02-06.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-01-29.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-01-16.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-01-17.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-01-25.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-01-23.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-01-18.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-02-08.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-01-22.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-02-04.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-01-24.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-01-15.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-01-31.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-01-30.csv
training model: results/QRTEA/W0/deepLOB_L1/h10
Epoch 1/50
589/589 - 28s - loss: 3.0529 - accuracy10: 0.3839 - val_loss: 3.2516 - val_accuracy10: 0.3622 - 28s/epoch - 48ms/step
Epoch 2/50
589/589 - 15s - loss: 2.9461 - accuracy10: 0.4148 - val_loss: 3.1169 - val_accuracy10: 0.4526 - 15s/epoch - 26ms/step
Epoch 3/50
589/589 - 15s - loss: 2.8742 - accuracy10: 0.4414 - val_loss: 3.2000 - val_accuracy10: 0.5333 - 15s/epoch - 25ms/step
Epoch 4/50
589/589 - 15s - loss: 2.8165 - accuracy10: 0.4737 - val_loss: 3.2385 - val_accuracy10: 0.5599 - 15s/epoch - 25ms/step
Epoch 5/50
589/589 - 15s - loss: 2.7557 - accuracy10: 0.5024 - val_loss: 3.0804 - val_accuracy10: 0.5527 - 15s/epoch - 25ms/step
Epoch 6/50
589/589 - 15s - loss: 2.6923 - accuracy10: 0.5323 - val_loss: 3.0032 - val_accuracy10: 0.5991 - 15s/epoch - 25ms/step
Epoch 7/50
589/589 - 15s - loss: 2.6497 - accuracy10: 0.5458 - val_loss: 2.9121 - val_accuracy10: 0.5960 - 15s/epoch - 26ms/step
Epoch 8/50
589/589 - 15s - loss: 2.6061 - accuracy10: 0.5645 - val_loss: 2.9207 - val_accuracy10: 0.5953 - 15s/epoch - 26ms/step
Epoch 9/50
589/589 - 15s - loss: 2.5758 - accuracy10: 0.5707 - val_loss: 2.9512 - val_accuracy10: 0.6020 - 15s/epoch - 25ms/step
Epoch 10/50
589/589 - 15s - loss: 2.5429 - accuracy10: 0.5816 - val_loss: 2.9357 - val_accuracy10: 0.5916 - 15s/epoch - 25ms/step
Epoch 11/50
589/589 - 15s - loss: 2.5226 - accuracy10: 0.5848 - val_loss: 2.9286 - val_accuracy10: 0.5857 - 15s/epoch - 25ms/step
Epoch 12/50
589/589 - 15s - loss: 2.5046 - accuracy10: 0.5892 - val_loss: 3.0118 - val_accuracy10: 0.6058 - 15s/epoch - 25ms/step
Epoch 13/50
589/589 - 15s - loss: 2.4831 - accuracy10: 0.5939 - val_loss: 3.0089 - val_accuracy10: 0.6064 - 15s/epoch - 25ms/step
Epoch 14/50
589/589 - 16s - loss: 2.4690 - accuracy10: 0.5962 - val_loss: 2.8944 - val_accuracy10: 0.6121 - 16s/epoch - 26ms/step
Epoch 15/50
589/589 - 15s - loss: 2.4525 - accuracy10: 0.5981 - val_loss: 2.9206 - val_accuracy10: 0.6127 - 15s/epoch - 26ms/step
Epoch 16/50
589/589 - 15s - loss: 2.4426 - accuracy10: 0.6005 - val_loss: 2.9519 - val_accuracy10: 0.5955 - 15s/epoch - 26ms/step
Epoch 17/50
589/589 - 15s - loss: 2.4305 - accuracy10: 0.6022 - val_loss: 3.0249 - val_accuracy10: 0.6123 - 15s/epoch - 26ms/step
Epoch 18/50
589/589 - 14s - loss: 2.4196 - accuracy10: 0.6034 - val_loss: 2.9548 - val_accuracy10: 0.6103 - 14s/epoch - 25ms/step
Epoch 19/50
589/589 - 15s - loss: 2.4102 - accuracy10: 0.6062 - val_loss: 3.0006 - val_accuracy10: 0.6170 - 15s/epoch - 25ms/step
Epoch 20/50
589/589 - 15s - loss: 2.3998 - accuracy10: 0.6065 - val_loss: 2.9780 - val_accuracy10: 0.6047 - 15s/epoch - 25ms/step
Epoch 21/50
589/589 - 15s - loss: 2.3895 - accuracy10: 0.6098 - val_loss: 2.9927 - val_accuracy10: 0.5975 - 15s/epoch - 25ms/step
Epoch 22/50
589/589 - 15s - loss: 2.3845 - accuracy10: 0.6102 - val_loss: 2.9744 - val_accuracy10: 0.6141 - 15s/epoch - 26ms/step
Epoch 23/50
589/589 - 15s - loss: 2.3784 - accuracy10: 0.6100 - val_loss: 3.0257 - val_accuracy10: 0.5962 - 15s/epoch - 25ms/step
Epoch 24/50
589/589 - 15s - loss: 2.3679 - accuracy10: 0.6136 - val_loss: 3.0592 - val_accuracy10: 0.5961 - 15s/epoch - 25ms/step
testing model: results/QRTEA/W0/deepLOB_L1/h10
Evaluating performance on  test set...
2359/2359 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80253094
{'0': {'precision': 0.33658536585365856, 'recall': 0.4969584894642075, 'f1-score': 0.40134410186877323, 'support': 82196}, '1': {'precision': 0.8454289917129083, 'recall': 0.6622598155876575, 'f1-score': 0.7427177882240947, 'support': 438257}, '2': {'precision': 0.31817887768377623, 'recall': 0.5311813763724725, 'f1-score': 0.3979717519711586, 'support': 83335}, 'accuracy': 0.6216652202428667, 'macro avg': {'precision': 0.5000644117501144, 'recall': 0.5634665604747792, 'f1-score': 0.5140112140213422, 'support': 603788}, 'weighted avg': {'precision': 0.7033869191249394, 'recall': 0.6216652202428667, 'f1-score': 0.6486633147088867, 'support': 603788}}
[[ 40848  27377  13971]
 [ 67131 290240  80886]
 [ 13381  25688  44266]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.825651
{'0': {'precision': 0.3780606566499722, 'recall': 0.46502673796791444, 'f1-score': 0.4170583382891784, 'support': 23375}, '1': {'precision': 0.8281699930493496, 'recall': 0.6401488986107913, 'f1-score': 0.722121212121212, 'support': 104232}, '2': {'precision': 0.34862873021626195, 'recall': 0.6246428262187202, 'f1-score': 0.4474977901152242, 'support': 23098}, 'accuracy': 0.6106101323778242, 'macro avg': {'precision': 0.5182864599718613, 'recall': 0.5766061542658086, 'f1-score': 0.5288924468418715, 'support': 150705}, 'weighted avg': {'precision': 0.6848585579459747, 'recall': 0.6106101323778242, 'f1-score': 0.6327141156259525, 'support': 150705}}
[[10870  8004  4501]
 [15052 66724 22456]
 [ 2830  5840 14428]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82758707
{'0': {'precision': 0.3911627402019325, 'recall': 0.3811891663140076, 'f1-score': 0.38611155762739113, 'support': 9452}, '1': {'precision': 0.7864826050001466, 'recall': 0.6713031296124884, 'f1-score': 0.7243427090644063, 'support': 39973}, '2': {'precision': 0.3590703679793415, 'recall': 0.5920170303352847, 'f1-score': 0.4470162748643761, 'support': 9395}, 'accuracy': 0.612019721183271, 'macro avg': {'precision': 0.5122385710604734, 'recall': 0.5481697754205935, 'f1-score': 0.5191568471853912, 'support': 58820}, 'weighted avg': {'precision': 0.6546889747913199, 'recall': 0.612019721183271, 'f1-score': 0.6256952644419658, 'support': 58820}}
[[ 3603  4324  1525]
 [ 4736 26834  8403]
 [  872  2961  5562]]
training model: results/QRTEA/W0/deepLOB_L1/h20
Epoch 1/50
589/589 - 18s - loss: 3.1090 - accuracy20: 0.4011 - val_loss: 3.4188 - val_accuracy20: 0.3820 - 18s/epoch - 30ms/step
Epoch 2/50
589/589 - 16s - loss: 3.0311 - accuracy20: 0.4210 - val_loss: 3.1632 - val_accuracy20: 0.3947 - 16s/epoch - 26ms/step
Epoch 3/50
589/589 - 15s - loss: 2.9779 - accuracy20: 0.4406 - val_loss: 3.2362 - val_accuracy20: 0.4246 - 15s/epoch - 26ms/step
Epoch 4/50
589/589 - 15s - loss: 2.9356 - accuracy20: 0.4580 - val_loss: 3.1505 - val_accuracy20: 0.4633 - 15s/epoch - 25ms/step
Epoch 5/50
589/589 - 15s - loss: 2.8811 - accuracy20: 0.4877 - val_loss: 3.1915 - val_accuracy20: 0.5113 - 15s/epoch - 25ms/step
Epoch 6/50
589/589 - 15s - loss: 2.8327 - accuracy20: 0.5093 - val_loss: 3.1207 - val_accuracy20: 0.4915 - 15s/epoch - 26ms/step
Epoch 7/50
589/589 - 15s - loss: 2.7839 - accuracy20: 0.5294 - val_loss: 3.1380 - val_accuracy20: 0.5095 - 15s/epoch - 25ms/step
Epoch 8/50
589/589 - 15s - loss: 2.7462 - accuracy20: 0.5425 - val_loss: 3.1637 - val_accuracy20: 0.5285 - 15s/epoch - 26ms/step
Epoch 9/50
589/589 - 15s - loss: 2.7136 - accuracy20: 0.5548 - val_loss: 3.1548 - val_accuracy20: 0.5395 - 15s/epoch - 25ms/step
Epoch 10/50
589/589 - 15s - loss: 2.6833 - accuracy20: 0.5602 - val_loss: 3.0991 - val_accuracy20: 0.5535 - 15s/epoch - 26ms/step
Epoch 11/50
589/589 - 15s - loss: 2.6537 - accuracy20: 0.5680 - val_loss: 3.1442 - val_accuracy20: 0.5525 - 15s/epoch - 26ms/step
Epoch 12/50
589/589 - 15s - loss: 2.6266 - accuracy20: 0.5755 - val_loss: 3.0754 - val_accuracy20: 0.5488 - 15s/epoch - 26ms/step
Epoch 13/50
589/589 - 15s - loss: 2.6101 - accuracy20: 0.5777 - val_loss: 3.1548 - val_accuracy20: 0.5477 - 15s/epoch - 26ms/step
Epoch 14/50
589/589 - 15s - loss: 2.5914 - accuracy20: 0.5819 - val_loss: 3.1158 - val_accuracy20: 0.5522 - 15s/epoch - 25ms/step
Epoch 15/50
589/589 - 15s - loss: 2.5754 - accuracy20: 0.5858 - val_loss: 3.1146 - val_accuracy20: 0.5576 - 15s/epoch - 26ms/step
Epoch 16/50
589/589 - 15s - loss: 2.5631 - accuracy20: 0.5889 - val_loss: 3.0368 - val_accuracy20: 0.5385 - 15s/epoch - 25ms/step
Epoch 17/50
589/589 - 15s - loss: 2.5473 - accuracy20: 0.5912 - val_loss: 3.0178 - val_accuracy20: 0.5514 - 15s/epoch - 25ms/step
Epoch 18/50
589/589 - 15s - loss: 2.5343 - accuracy20: 0.5947 - val_loss: 3.1213 - val_accuracy20: 0.5481 - 15s/epoch - 26ms/step
Epoch 19/50
589/589 - 15s - loss: 2.5247 - accuracy20: 0.5966 - val_loss: 3.0572 - val_accuracy20: 0.5474 - 15s/epoch - 26ms/step
Epoch 20/50
589/589 - 15s - loss: 2.5140 - accuracy20: 0.5986 - val_loss: 3.0900 - val_accuracy20: 0.5386 - 15s/epoch - 26ms/step
Epoch 21/50
589/589 - 15s - loss: 2.5053 - accuracy20: 0.6012 - val_loss: 3.1379 - val_accuracy20: 0.5382 - 15s/epoch - 25ms/step
Epoch 22/50
589/589 - 14s - loss: 2.4972 - accuracy20: 0.6015 - val_loss: 3.1326 - val_accuracy20: 0.5230 - 14s/epoch - 24ms/step
Epoch 23/50
589/589 - 15s - loss: 2.4875 - accuracy20: 0.6032 - val_loss: 3.0913 - val_accuracy20: 0.5440 - 15s/epoch - 25ms/step
Epoch 24/50
589/589 - 15s - loss: 2.4807 - accuracy20: 0.6044 - val_loss: 3.1359 - val_accuracy20: 0.5428 - 15s/epoch - 25ms/step
Epoch 25/50
589/589 - 15s - loss: 2.4753 - accuracy20: 0.6051 - val_loss: 3.1430 - val_accuracy20: 0.5314 - 15s/epoch - 25ms/step
Epoch 26/50
589/589 - 15s - loss: 2.4671 - accuracy20: 0.6059 - val_loss: 3.1841 - val_accuracy20: 0.5383 - 15s/epoch - 26ms/step
Epoch 27/50
589/589 - 15s - loss: 2.4577 - accuracy20: 0.6089 - val_loss: 3.2033 - val_accuracy20: 0.5405 - 15s/epoch - 25ms/step
testing model: results/QRTEA/W0/deepLOB_L1/h20
Evaluating performance on  test set...
2359/2359 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8699914
{'0': {'precision': 0.37012947582195893, 'recall': 0.5167726437756112, 'f1-score': 0.4313278399798717, 'support': 106155}, '1': {'precision': 0.7962998256988506, 'recall': 0.5906436506263784, 'f1-score': 0.6782243747814115, 'support': 389062}, '2': {'precision': 0.3590248751452148, 'recall': 0.5522192850761253, 'f1-score': 0.4351423439115998, 'support': 108571}, 'accuracy': 0.5707466859228736, 'macro avg': {'precision': 0.5084847255553414, 'recall': 0.5532118598260384, 'f1-score': 0.5148981862242944, 'support': 603788}, 'weighted avg': {'precision': 0.6427434579874348, 'recall': 0.5707466859228736, 'f1-score': 0.5911061133627947, 'support': 603788}}
[[ 54858  28866  22431]
 [ 74657 229797  84608]
 [ 18698  29918  59955]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.884818
{'0': {'precision': 0.4288986386218466, 'recall': 0.4363737814684741, 'f1-score': 0.43260392093061095, 'support': 30467}, '1': {'precision': 0.7574367111225467, 'recall': 0.5869165503644137, 'f1-score': 0.6613620903774986, 'support': 90282}, '2': {'precision': 0.3856683417085427, 'recall': 0.6405060755775137, 'f1-score': 0.4814443078312799, 'support': 29956}, 'accuracy': 0.5671344680003981, 'macro avg': {'precision': 0.524001230484312, 'recall': 0.5545988024701338, 'f1-score': 0.5251367730464631, 'support': 150705}, 'weighted avg': {'precision': 0.617121109589454, 'recall': 0.5671344680003981, 'f1-score': 0.579352918535205, 'support': 150705}}
[[13295  9635  7537]
 [14268 52988 23026]
 [ 3435  7334 19187]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.917296
{'0': {'precision': 0.427639046538025, 'recall': 0.36957410283658954, 'f1-score': 0.39649199736899804, 'support': 12233}, '1': {'precision': 0.711414113016587, 'recall': 0.5898429532939017, 'f1-score': 0.6449495834461665, 'support': 34321}, '2': {'precision': 0.38778294260307195, 'recall': 0.6257133539866298, 'f1-score': 0.4788196394035811, 'support': 12266}, 'accuracy': 0.5515130907854471, 'macro avg': {'precision': 0.5089453673858946, 'recall': 0.5283768033723737, 'f1-score': 0.5067537400729152, 'support': 58820}, 'weighted avg': {'precision': 0.5849081571423193, 'recall': 0.5515130907854471, 'f1-score': 0.5586331682114104, 'support': 58820}}
[[ 4521  4790  2922]
 [ 4882 20244  9195]
 [ 1169  3422  7675]]
training model: results/QRTEA/W0/deepLOB_L1/h30
Epoch 1/50
589/589 - 18s - loss: 3.1441 - accuracy30: 0.4207 - val_loss: 3.2694 - val_accuracy30: 0.3862 - 18s/epoch - 30ms/step
Epoch 2/50
589/589 - 15s - loss: 3.0742 - accuracy30: 0.4258 - val_loss: 3.2891 - val_accuracy30: 0.3938 - 15s/epoch - 26ms/step
Epoch 3/50
589/589 - 16s - loss: 3.0330 - accuracy30: 0.4314 - val_loss: 3.2369 - val_accuracy30: 0.4175 - 16s/epoch - 27ms/step
Epoch 4/50
589/589 - 15s - loss: 3.0025 - accuracy30: 0.4563 - val_loss: 3.4358 - val_accuracy30: 0.4282 - 15s/epoch - 26ms/step
Epoch 5/50
589/589 - 15s - loss: 2.9679 - accuracy30: 0.4746 - val_loss: 3.3487 - val_accuracy30: 0.4325 - 15s/epoch - 26ms/step
Epoch 6/50
589/589 - 15s - loss: 2.9333 - accuracy30: 0.4858 - val_loss: 3.3389 - val_accuracy30: 0.4225 - 15s/epoch - 25ms/step
Epoch 7/50
589/589 - 15s - loss: 2.8926 - accuracy30: 0.5030 - val_loss: 3.3686 - val_accuracy30: 0.4217 - 15s/epoch - 26ms/step
Epoch 8/50
589/589 - 14s - loss: 2.8576 - accuracy30: 0.5167 - val_loss: 3.3050 - val_accuracy30: 0.4527 - 14s/epoch - 24ms/step
Epoch 9/50
589/589 - 15s - loss: 2.8297 - accuracy30: 0.5274 - val_loss: 3.2605 - val_accuracy30: 0.4760 - 15s/epoch - 25ms/step
Epoch 10/50
589/589 - 15s - loss: 2.8075 - accuracy30: 0.5360 - val_loss: 3.2026 - val_accuracy30: 0.4748 - 15s/epoch - 25ms/step
Epoch 11/50
589/589 - 14s - loss: 2.7831 - accuracy30: 0.5434 - val_loss: 3.2540 - val_accuracy30: 0.4829 - 14s/epoch - 24ms/step
Epoch 12/50
589/589 - 15s - loss: 2.7606 - accuracy30: 0.5503 - val_loss: 3.2223 - val_accuracy30: 0.4917 - 15s/epoch - 25ms/step
Epoch 13/50
589/589 - 15s - loss: 2.7396 - accuracy30: 0.5548 - val_loss: 3.2193 - val_accuracy30: 0.5118 - 15s/epoch - 26ms/step
Epoch 14/50
589/589 - 15s - loss: 2.7253 - accuracy30: 0.5593 - val_loss: 3.2326 - val_accuracy30: 0.5060 - 15s/epoch - 26ms/step
Epoch 15/50
589/589 - 15s - loss: 2.7087 - accuracy30: 0.5619 - val_loss: 3.1523 - val_accuracy30: 0.4982 - 15s/epoch - 26ms/step
Epoch 16/50
589/589 - 14s - loss: 2.6937 - accuracy30: 0.5658 - val_loss: 3.2112 - val_accuracy30: 0.4987 - 14s/epoch - 24ms/step
Epoch 17/50
589/589 - 15s - loss: 2.6815 - accuracy30: 0.5672 - val_loss: 3.2352 - val_accuracy30: 0.4987 - 15s/epoch - 25ms/step
Epoch 18/50
589/589 - 15s - loss: 2.6693 - accuracy30: 0.5709 - val_loss: 3.1618 - val_accuracy30: 0.4939 - 15s/epoch - 25ms/step
Epoch 19/50
589/589 - 15s - loss: 2.6604 - accuracy30: 0.5731 - val_loss: 3.1229 - val_accuracy30: 0.5023 - 15s/epoch - 25ms/step
Epoch 20/50
589/589 - 15s - loss: 2.6480 - accuracy30: 0.5751 - val_loss: 3.0737 - val_accuracy30: 0.4945 - 15s/epoch - 25ms/step
Epoch 21/50
589/589 - 15s - loss: 2.6415 - accuracy30: 0.5776 - val_loss: 3.1482 - val_accuracy30: 0.5084 - 15s/epoch - 25ms/step
Epoch 22/50
589/589 - 15s - loss: 2.6324 - accuracy30: 0.5788 - val_loss: 3.1042 - val_accuracy30: 0.5106 - 15s/epoch - 25ms/step
Epoch 23/50
589/589 - 15s - loss: 2.6211 - accuracy30: 0.5821 - val_loss: 3.1199 - val_accuracy30: 0.5038 - 15s/epoch - 26ms/step
Epoch 24/50
589/589 - 15s - loss: 2.6152 - accuracy30: 0.5816 - val_loss: 3.1719 - val_accuracy30: 0.5026 - 15s/epoch - 26ms/step
Epoch 25/50
589/589 - 15s - loss: 2.6059 - accuracy30: 0.5839 - val_loss: 3.2198 - val_accuracy30: 0.4917 - 15s/epoch - 25ms/step
Epoch 26/50
589/589 - 15s - loss: 2.5964 - accuracy30: 0.5855 - val_loss: 3.1517 - val_accuracy30: 0.5003 - 15s/epoch - 25ms/step
Epoch 27/50
589/589 - 14s - loss: 2.5876 - accuracy30: 0.5879 - val_loss: 3.1573 - val_accuracy30: 0.4926 - 14s/epoch - 25ms/step
Epoch 28/50
589/589 - 15s - loss: 2.5812 - accuracy30: 0.5889 - val_loss: 3.1710 - val_accuracy30: 0.4902 - 15s/epoch - 26ms/step
Epoch 29/50
589/589 - 15s - loss: 2.5743 - accuracy30: 0.5905 - val_loss: 3.2045 - val_accuracy30: 0.4904 - 15s/epoch - 25ms/step
Epoch 30/50
589/589 - 15s - loss: 2.5675 - accuracy30: 0.5937 - val_loss: 3.1361 - val_accuracy30: 0.5010 - 15s/epoch - 25ms/step
testing model: results/QRTEA/W0/deepLOB_L1/h30
Evaluating performance on  test set...
2359/2359 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96154237
{'0': {'precision': 0.36521406828574066, 'recall': 0.4560826099477517, 'f1-score': 0.4056214760582345, 'support': 121535}, '1': {'precision': 0.73976262028352, 'recall': 0.5472469235605857, 'f1-score': 0.629106163278477, 'support': 356256}, '2': {'precision': 0.3611503157001114, 'recall': 0.5402192115685294, 'f1-score': 0.4328975695382981, 'support': 125997}, 'accuracy': 0.5274301576049871, 'macro avg': {'precision': 0.48870900142312407, 'recall': 0.5145162483589556, 'f1-score': 0.48920840295833656, 'support': 603788}, 'weighted avg': {'precision': 0.5853627766171241, 'recall': 0.5274301576049871, 'f1-score': 0.543177152356111, 'support': 603788}}
[[ 55430  35637  30468]
 [ 71360 194960  89936]
 [ 24984  32947  68066]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9939638
{'0': {'precision': 0.38914743714045635, 'recall': 0.3445108866699093, 'f1-score': 0.3654712943711775, 'support': 34951}, '1': {'precision': 0.6612100325483439, 'recall': 0.5087342409251052, 'f1-score': 0.5750362502341522, 'support': 81461}, '2': {'precision': 0.3745861579694151, 'recall': 0.6235674919079696, 'f1-score': 0.4680236375574524, 'support': 34293}, 'accuracy': 0.4967784745031684, 'macro avg': {'precision': 0.4749812092194052, 'recall': 0.49227087316766144, 'f1-score': 0.4695103940542607, 'support': 150705}, 'weighted avg': {'precision': 0.532892774972044, 'recall': 0.4967784745031684, 'f1-score': 0.5020838710902028, 'support': 150705}}
[[12041 12982  9928]
 [14244 41442 25775]
 [ 4657  8252 21384]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99894387
{'0': {'precision': 0.42827575226874703, 'recall': 0.38280916465063325, 'f1-score': 0.4042681094078749, 'support': 14054}, '1': {'precision': 0.6673052362707536, 'recall': 0.4783546952654983, 'f1-score': 0.5572484192884893, 'support': 30584}, '2': {'precision': 0.3770033697706912, 'recall': 0.6468763220984346, 'f1-score': 0.4763734551874546, 'support': 14182}, 'accuracy': 0.49615776946616796, 'macro avg': {'precision': 0.4908614527700639, 'recall': 0.502680060671522, 'f1-score': 0.4792966612946063, 'support': 58820}, 'weighted avg': {'precision': 0.5401991254433465, 'recall': 0.49615776946616796, 'f1-score': 0.501196837922576, 'support': 58820}}
[[ 5380  4243  4431]
 [ 5225 14630 10729]
 [ 1957  3051  9174]]
training model: results/QRTEA/W0/deepLOB_L1/h50
Epoch 1/50
589/589 - 17s - loss: 3.1944 - accuracy50: 0.4153 - val_loss: 3.3870 - val_accuracy50: 0.4047 - 17s/epoch - 29ms/step
Epoch 2/50
589/589 - 15s - loss: 3.1217 - accuracy50: 0.4386 - val_loss: 3.4121 - val_accuracy50: 0.3902 - 15s/epoch - 26ms/step
Epoch 3/50
589/589 - 15s - loss: 3.0855 - accuracy50: 0.4494 - val_loss: 3.4994 - val_accuracy50: 0.3713 - 15s/epoch - 26ms/step
Epoch 4/50
589/589 - 15s - loss: 3.0569 - accuracy50: 0.4567 - val_loss: 3.4335 - val_accuracy50: 0.3753 - 15s/epoch - 25ms/step
Epoch 5/50
589/589 - 15s - loss: 3.0452 - accuracy50: 0.4614 - val_loss: 3.3480 - val_accuracy50: 0.3906 - 15s/epoch - 26ms/step
Epoch 6/50
589/589 - 15s - loss: 3.0266 - accuracy50: 0.4680 - val_loss: 3.3390 - val_accuracy50: 0.4193 - 15s/epoch - 26ms/step
Epoch 7/50
589/589 - 15s - loss: 3.0001 - accuracy50: 0.4766 - val_loss: 3.3313 - val_accuracy50: 0.4327 - 15s/epoch - 26ms/step
Epoch 8/50
589/589 - 15s - loss: 2.9861 - accuracy50: 0.4830 - val_loss: 3.3525 - val_accuracy50: 0.4279 - 15s/epoch - 25ms/step
Epoch 9/50
589/589 - 14s - loss: 2.9689 - accuracy50: 0.4901 - val_loss: 3.3717 - val_accuracy50: 0.4377 - 14s/epoch - 24ms/step
Epoch 10/50
589/589 - 15s - loss: 2.9586 - accuracy50: 0.4946 - val_loss: 3.3462 - val_accuracy50: 0.4376 - 15s/epoch - 26ms/step
Epoch 11/50
589/589 - 15s - loss: 2.9509 - accuracy50: 0.4953 - val_loss: 3.2786 - val_accuracy50: 0.4450 - 15s/epoch - 25ms/step
Epoch 12/50
589/589 - 15s - loss: 2.9346 - accuracy50: 0.5034 - val_loss: 3.2895 - val_accuracy50: 0.4494 - 15s/epoch - 25ms/step
Epoch 13/50
589/589 - 15s - loss: 2.9226 - accuracy50: 0.5051 - val_loss: 3.3596 - val_accuracy50: 0.4526 - 15s/epoch - 26ms/step
Epoch 14/50
589/589 - 15s - loss: 2.9115 - accuracy50: 0.5103 - val_loss: 3.3188 - val_accuracy50: 0.4376 - 15s/epoch - 26ms/step
Epoch 15/50
589/589 - 15s - loss: 2.8989 - accuracy50: 0.5136 - val_loss: 3.3472 - val_accuracy50: 0.4261 - 15s/epoch - 25ms/step
Epoch 16/50
589/589 - 15s - loss: 2.8901 - accuracy50: 0.5173 - val_loss: 3.3470 - val_accuracy50: 0.4384 - 15s/epoch - 26ms/step
Epoch 17/50
589/589 - 15s - loss: 2.8796 - accuracy50: 0.5189 - val_loss: 3.3621 - val_accuracy50: 0.4460 - 15s/epoch - 26ms/step
Epoch 18/50
589/589 - 16s - loss: 2.8708 - accuracy50: 0.5219 - val_loss: 3.3695 - val_accuracy50: 0.4410 - 16s/epoch - 27ms/step
Epoch 19/50
589/589 - 15s - loss: 2.8629 - accuracy50: 0.5230 - val_loss: 3.3902 - val_accuracy50: 0.4472 - 15s/epoch - 26ms/step
Epoch 20/50
589/589 - 14s - loss: 2.8534 - accuracy50: 0.5277 - val_loss: 3.3719 - val_accuracy50: 0.4533 - 14s/epoch - 24ms/step
Epoch 21/50
589/589 - 16s - loss: 2.8427 - accuracy50: 0.5291 - val_loss: 3.3614 - val_accuracy50: 0.4479 - 16s/epoch - 27ms/step
testing model: results/QRTEA/W0/deepLOB_L1/h50
Evaluating performance on  test set...
2359/2359 - 37s - 37s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0819868
{'0': {'precision': 0.3198322268078234, 'recall': 0.4998632854949416, 'f1-score': 0.39007749902202965, 'support': 142633}, '1': {'precision': 0.6211974273695985, 'recall': 0.3380036840520688, 'f1-score': 0.4377956123578545, 'support': 308899}, '2': {'precision': 0.36926373765807763, 'recall': 0.516078184110971, 'f1-score': 0.4304979906696946, 'support': 152256}, 'accuracy': 0.42114450767487926, 'macro avg': {'precision': 0.4367644639451665, 'recall': 0.45131505121932713, 'f1-score': 0.41945703401652623, 'support': 603788}, 'weighted avg': {'precision': 0.4864762363017982, 'recall': 0.42114450767487926, 'f1-score': 0.4246829232232887, 'support': 603788}}
[[ 71297  31936  39400]
 [109675 104409  94815]
 [ 41948  31732  78576]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0652612
{'0': {'precision': 0.3543778172380822, 'recall': 0.31745876364348297, 'f1-score': 0.3349038945615552, 'support': 40862}, '1': {'precision': 0.5201540903379406, 'recall': 0.45135790425089306, 'f1-score': 0.4833201471729128, 'support': 69703}, '2': {'precision': 0.3797560429722471, 'recall': 0.5072496263079223, 'f1-score': 0.43434020222705744, 'support': 40140}, 'accuracy': 0.4299392853588136, 'macro avg': {'precision': 0.41809598351608995, 'recall': 0.4253554314007661, 'f1-score': 0.4175214146538418, 'support': 150705}, 'weighted avg': {'precision': 0.437810918627212, 'recall': 0.4299392853588136, 'f1-score': 0.4300329974145642, 'support': 150705}}
[[12972 16562 11328]
 [16315 31461 21927]
 [ 7318 12461 20361]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0603747
{'0': {'precision': 0.3930640023168259, 'recall': 0.3289106991397068, 'f1-score': 0.35813708028234054, 'support': 16506}, '1': {'precision': 0.5096311217424147, 'recall': 0.47534053546265853, 'f1-score': 0.4918889361443587, 'support': 25548}, '2': {'precision': 0.4045044619670428, 'recall': 0.5109745914350471, 'f1-score': 0.45154829358281723, 'support': 16766}, 'accuracy': 0.444406664399864, 'macro avg': {'precision': 0.4357331953420944, 'recall': 0.4384086086791375, 'f1-score': 0.4338581033365055, 'support': 58820}, 'weighted avg': {'precision': 0.44695498350656543, 'recall': 0.444406664399864, 'f1-score': 0.44285698534454104, 'support': 58820}}
[[ 5429  6399  4678]
 [ 5470 12144  7934]
 [ 2913  5286  8567]]
training model: results/QRTEA/W0/deepLOB_L1/h100
Epoch 1/50
589/589 - 19s - loss: 3.2564 - accuracy100: 0.4055 - val_loss: 3.3011 - val_accuracy100: 0.3870 - 19s/epoch - 32ms/step
Epoch 2/50
589/589 - 15s - loss: 3.2149 - accuracy100: 0.4200 - val_loss: 3.3756 - val_accuracy100: 0.3603 - 15s/epoch - 26ms/step
Epoch 3/50
589/589 - 15s - loss: 3.2043 - accuracy100: 0.4189 - val_loss: 3.3369 - val_accuracy100: 0.4167 - 15s/epoch - 26ms/step
Epoch 4/50
589/589 - 15s - loss: 3.1907 - accuracy100: 0.4212 - val_loss: 3.3971 - val_accuracy100: 0.4093 - 15s/epoch - 25ms/step
Epoch 5/50
589/589 - 15s - loss: 3.1696 - accuracy100: 0.4345 - val_loss: 3.2997 - val_accuracy100: 0.3922 - 15s/epoch - 25ms/step
Epoch 6/50
589/589 - 14s - loss: 3.1596 - accuracy100: 0.4411 - val_loss: 3.2822 - val_accuracy100: 0.3934 - 14s/epoch - 25ms/step
Epoch 7/50
589/589 - 15s - loss: 3.1517 - accuracy100: 0.4453 - val_loss: 3.2940 - val_accuracy100: 0.4154 - 15s/epoch - 26ms/step
Epoch 8/50
589/589 - 15s - loss: 3.1419 - accuracy100: 0.4495 - val_loss: 3.3331 - val_accuracy100: 0.4083 - 15s/epoch - 26ms/step
Epoch 9/50
589/589 - 15s - loss: 3.1328 - accuracy100: 0.4521 - val_loss: 3.2856 - val_accuracy100: 0.4089 - 15s/epoch - 26ms/step
Epoch 10/50
589/589 - 14s - loss: 3.1244 - accuracy100: 0.4579 - val_loss: 3.2883 - val_accuracy100: 0.4113 - 14s/epoch - 24ms/step
Epoch 11/50
589/589 - 15s - loss: 3.1187 - accuracy100: 0.4589 - val_loss: 3.3241 - val_accuracy100: 0.4028 - 15s/epoch - 25ms/step
Epoch 12/50
589/589 - 15s - loss: 3.1082 - accuracy100: 0.4620 - val_loss: 3.3455 - val_accuracy100: 0.3884 - 15s/epoch - 26ms/step
Epoch 13/50
589/589 - 15s - loss: 3.0989 - accuracy100: 0.4655 - val_loss: 3.3741 - val_accuracy100: 0.3823 - 15s/epoch - 26ms/step
Epoch 14/50
589/589 - 15s - loss: 3.0876 - accuracy100: 0.4681 - val_loss: 3.3246 - val_accuracy100: 0.3964 - 15s/epoch - 25ms/step
Epoch 15/50
589/589 - 15s - loss: 3.0841 - accuracy100: 0.4681 - val_loss: 3.3782 - val_accuracy100: 0.3963 - 15s/epoch - 25ms/step
Epoch 16/50
589/589 - 15s - loss: 3.0838 - accuracy100: 0.4686 - val_loss: 3.3972 - val_accuracy100: 0.3856 - 15s/epoch - 25ms/step
testing model: results/QRTEA/W0/deepLOB_L1/h100
Evaluating performance on  test set...
2359/2359 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0598848
{'0': {'precision': 0.3837509266123054, 'recall': 0.44598622733512144, 'f1-score': 0.41253456514982884, 'support': 174113}, '1': {'precision': 0.45246427771742287, 'recall': 0.4635806324161048, 'f1-score': 0.4579550056762263, 'support': 235383}, '2': {'precision': 0.44883697713886395, 'recall': 0.37024684495501614, 'f1-score': 0.405771595537054, 'support': 194292}, 'accuracy': 0.42847323895142003, 'macro avg': {'precision': 0.42835072715619743, 'recall': 0.4266045682354142, 'f1-score': 0.42542038878770305, 'support': 603788}, 'weighted avg': {'precision': 0.4314823383861101, 'recall': 0.42847323895142003, 'f1-score': 0.42806519619983274, 'support': 603788}}
[[ 77652  61341  35120]
 [ 73048 109119  53216]
 [ 51650  70706  71936]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0926049
{'0': {'precision': 0.4058894437747546, 'recall': 0.2833727407526149, 'f1-score': 0.3337423892009251, 'support': 49906}, '1': {'precision': 0.3629812531032354, 'recall': 0.5238298119565428, 'f1-score': 0.42881828846824566, 'support': 51637}, '2': {'precision': 0.4405234133126935, 'recall': 0.3704690614702412, 'f1-score': 0.4024705544383798, 'support': 49162}, 'accuracy': 0.39417404863806776, 'macro avg': {'precision': 0.4031313700635612, 'recall': 0.3925572047264663, 'f1-score': 0.38834374403585015, 'support': 150705}, 'weighted avg': {'precision': 0.40248560825980095, 'recall': 0.39417404863806776, 'f1-score': 0.38873889409373147, 'support': 150705}}
[[14142 25137 10627]
 [12084 27049 12504]
 [ 8616 22333 18213]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0912551
{'0': {'precision': 0.4419592932229926, 'recall': 0.300167097068206, 'f1-score': 0.3575176406730595, 'support': 19749}, '1': {'precision': 0.3307362534948742, 'recall': 0.4838568935427574, 'f1-score': 0.3929053829631762, 'support': 18336}, '2': {'precision': 0.4500053815520396, 'recall': 0.4032794791415481, 'f1-score': 0.4253630744970369, 'support': 20735}, 'accuracy': 0.39377762665759947, 'macro avg': {'precision': 0.4075669760899688, 'recall': 0.3957678232508372, 'f1-score': 0.39192869937775754, 'support': 58820}, 'weighted avg': {'precision': 0.4101240328531866, 'recall': 0.39377762665759947, 'f1-score': 0.3924656976769995, 'support': 58820}}
[[5928 9151 4670]
 [3914 8872 5550]
 [3571 8802 8362]]
training model: results/QRTEA/W0/deepLOB_L1/h200
Epoch 1/50
589/589 - 19s - loss: 3.2952 - accuracy200: 0.3783 - val_loss: 3.3512 - val_accuracy200: 0.3317 - 19s/epoch - 32ms/step
Epoch 2/50
589/589 - 16s - loss: 3.2507 - accuracy200: 0.3979 - val_loss: 3.3341 - val_accuracy200: 0.3490 - 16s/epoch - 27ms/step
Epoch 3/50
589/589 - 15s - loss: 3.2353 - accuracy200: 0.4063 - val_loss: 3.3646 - val_accuracy200: 0.3803 - 15s/epoch - 26ms/step
Epoch 4/50
589/589 - 16s - loss: 3.2289 - accuracy200: 0.4070 - val_loss: 3.3781 - val_accuracy200: 0.3778 - 16s/epoch - 27ms/step
Epoch 5/50
589/589 - 16s - loss: 3.2171 - accuracy200: 0.4157 - val_loss: 3.4533 - val_accuracy200: 0.3737 - 16s/epoch - 27ms/step
Epoch 6/50
589/589 - 15s - loss: 3.2126 - accuracy200: 0.4172 - val_loss: 3.4920 - val_accuracy200: 0.3570 - 15s/epoch - 26ms/step
Epoch 7/50
589/589 - 16s - loss: 3.2069 - accuracy200: 0.4239 - val_loss: 3.5101 - val_accuracy200: 0.3628 - 16s/epoch - 26ms/step
Epoch 8/50
589/589 - 17s - loss: 3.2016 - accuracy200: 0.4232 - val_loss: 3.4981 - val_accuracy200: 0.3772 - 17s/epoch - 28ms/step
Epoch 9/50
589/589 - 17s - loss: 3.1940 - accuracy200: 0.4270 - val_loss: 3.4690 - val_accuracy200: 0.3802 - 17s/epoch - 29ms/step
Epoch 10/50
589/589 - 16s - loss: 3.1943 - accuracy200: 0.4264 - val_loss: 3.4375 - val_accuracy200: 0.3809 - 16s/epoch - 28ms/step
Epoch 11/50
589/589 - 16s - loss: 3.1894 - accuracy200: 0.4265 - val_loss: 3.4834 - val_accuracy200: 0.3806 - 16s/epoch - 28ms/step
Epoch 12/50
589/589 - 17s - loss: 3.1827 - accuracy200: 0.4308 - val_loss: 3.4945 - val_accuracy200: 0.3762 - 17s/epoch - 28ms/step
testing model: results/QRTEA/W0/deepLOB_L1/h200
Evaluating performance on  test set...
2359/2359 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.101969
{'0': {'precision': 0.3111093038386467, 'recall': 0.21912896037760707, 'f1-score': 0.25714122467087686, 'support': 174573}, '1': {'precision': 0.3523633162619929, 'recall': 0.6438245073392264, 'f1-score': 0.45545655773364935, 'support': 221958}, '2': {'precision': 0.43604118233145134, 'recall': 0.15836859551185242, 'f1-score': 0.2323489020712698, 'support': 207257}, 'accuracy': 0.3543942575871001, 'macro avg': {'precision': 0.36650460081069697, 'recall': 0.3404406877428953, 'f1-score': 0.31498222815859866, 'support': 603788}, 'weighted avg': {'precision': 0.3691589246165427, 'recall': 0.3543942575871001, 'f1-score': 0.3215335151617778, 'support': 603788}}
[[ 38254 118629  17690]
 [ 54294 142902  24762]
 [ 30412 144022  32823]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1105064
{'0': {'precision': 0.3763956661979985, 'recall': 0.17930735589614277, 'f1-score': 0.24290136635354398, 'support': 50762}, '1': {'precision': 0.33089268317694714, 'recall': 0.6459342595187573, 'f1-score': 0.437610616468546, 'support': 49954}, '2': {'precision': 0.40805984555984554, 'recall': 0.23679209426073736, 'f1-score': 0.2996822664151803, 'support': 49989}, 'accuracy': 0.3530473441491656, 'macro avg': {'precision': 0.3717827316449304, 'recall': 0.35401123655854577, 'f1-score': 0.3267314164124235, 'support': 150705}, 'weighted avg': {'precision': 0.3718158888069748, 'recall': 0.3530473441491656, 'f1-score': 0.3262756823578301, 'support': 150705}}
[[ 9102 33602  8058]
 [ 8574 32267  9113]
 [ 6506 31646 11837]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.11273
{'0': {'precision': 0.41686909581646425, 'recall': 0.15693745872072346, 'f1-score': 0.22802938028272982, 'support': 19683}, '1': {'precision': 0.2976854198344315, 'recall': 0.6072023433461605, 'f1-score': 0.3995087387812943, 'support': 17411}, '2': {'precision': 0.44124308002013085, 'recall': 0.32283899475283073, 'f1-score': 0.3728669395566424, 'support': 21726}, 'accuracy': 0.35149608976538593, 'macro avg': {'precision': 0.3852658652236755, 'recall': 0.36232626560657155, 'f1-score': 0.33346835287355553, 'support': 58820}, 'weighted avg': {'precision': 0.3905930366237694, 'recall': 0.35149608976538593, 'f1-score': 0.3322858903745953, 'support': 58820}}
[[ 3089 12168  4426]
 [ 2383 10572  4456]
 [ 1938 12774  7014]]
training model: results/QRTEA/W0/deepLOB_L1/h300
Epoch 1/50
589/589 - 18s - loss: 3.3019 - accuracy300: 0.3740 - val_loss: 3.3366 - val_accuracy300: 0.3648 - 18s/epoch - 31ms/step
Epoch 2/50
589/589 - 16s - loss: 3.2676 - accuracy300: 0.3865 - val_loss: 3.3501 - val_accuracy300: 0.3667 - 16s/epoch - 28ms/step
Epoch 3/50
589/589 - 16s - loss: 3.2618 - accuracy300: 0.3827 - val_loss: 3.3978 - val_accuracy300: 0.3703 - 16s/epoch - 27ms/step
Epoch 4/50
589/589 - 15s - loss: 3.2483 - accuracy300: 0.3922 - val_loss: 3.4030 - val_accuracy300: 0.3765 - 15s/epoch - 25ms/step
Epoch 5/50
589/589 - 16s - loss: 3.2407 - accuracy300: 0.3949 - val_loss: 3.4593 - val_accuracy300: 0.3709 - 16s/epoch - 27ms/step
Epoch 6/50
589/589 - 16s - loss: 3.2338 - accuracy300: 0.4008 - val_loss: 3.4612 - val_accuracy300: 0.3742 - 16s/epoch - 27ms/step
Epoch 7/50
589/589 - 16s - loss: 3.2267 - accuracy300: 0.4051 - val_loss: 3.4724 - val_accuracy300: 0.3746 - 16s/epoch - 27ms/step
Epoch 8/50
589/589 - 16s - loss: 3.2207 - accuracy300: 0.4095 - val_loss: 3.4547 - val_accuracy300: 0.3741 - 16s/epoch - 28ms/step
Epoch 9/50
589/589 - 16s - loss: 3.2179 - accuracy300: 0.4116 - val_loss: 3.5290 - val_accuracy300: 0.3732 - 16s/epoch - 28ms/step
Epoch 10/50
589/589 - 15s - loss: 3.2108 - accuracy300: 0.4142 - val_loss: 3.5795 - val_accuracy300: 0.3739 - 15s/epoch - 26ms/step
Epoch 11/50
589/589 - 15s - loss: 3.2071 - accuracy300: 0.4161 - val_loss: 3.5782 - val_accuracy300: 0.3739 - 15s/epoch - 26ms/step
testing model: results/QRTEA/W0/deepLOB_L1/h300
Evaluating performance on  test set...
2359/2359 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1150515
{'0': {'precision': 0.3168283696461301, 'recall': 0.5401671208186467, 'f1-score': 0.39939595979110937, 'support': 187529}, '1': {'precision': 0.34182862892548854, 'recall': 0.13475751059521077, 'f1-score': 0.19330807702674374, 'support': 191596}, '2': {'precision': 0.41310289928740634, 'recall': 0.3834454271508882, 'f1-score': 0.39772205255345716, 'support': 224663}, 'accuracy': 0.3532067546887318, 'macro avg': {'precision': 0.3572532992863417, 'recall': 0.3527900195215819, 'f1-score': 0.3301420297904368, 'support': 603788}, 'weighted avg': {'precision': 0.3605842480830749, 'recall': 0.3532067546887318, 'f1-score': 0.3333766301458464, 'support': 603788}}
[[101297  23886  62346]
 [105735  25819  60042]
 [112690  25827  86146]]
Evaluating performance on  train set...
589/589 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1120569
{'0': {'precision': 0.3494501294324085, 'recall': 0.3958357932853151, 'f1-score': 0.3711994685023023, 'support': 50814}, '1': {'precision': 0.3527185521040207, 'recall': 0.18574134733020245, 'f1-score': 0.24334001163316746, 'support': 50678}, '2': {'precision': 0.3566108427752449, 'recall': 0.4815800703066263, 'f1-score': 0.40977937616709315, 'support': 49213}, 'accuracy': 0.35318668922729834, 'macro avg': {'precision': 0.3529265081038913, 'recall': 0.35438573697404796, 'f1-score': 0.341439618767521, 'support': 150705}, 'weighted avg': {'precision': 0.35288755559539564, 'recall': 0.35318668922729834, 'f1-score': 0.3408021455249182, 'support': 150705}}
[[20114  9061 21639]
 [20145  9413 21120]
 [17300  8213 23700]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1116052
{'0': {'precision': 0.35471730760911885, 'recall': 0.41656083312166625, 'f1-score': 0.38315966543619456, 'support': 19685}, '1': {'precision': 0.3082293393838904, 'recall': 0.20212887718896647, 'f1-score': 0.24415027822901186, 'support': 17474}, '2': {'precision': 0.4029450585711929, 'recall': 0.45099487558284473, 'f1-score': 0.4256181243873216, 'support': 21661}, 'accuracy': 0.36553893233594015, 'macro avg': {'precision': 0.3552972351880674, 'recall': 0.35656152863115914, 'f1-score': 0.35097602268417605, 'support': 58820}, 'weighted avg': {'precision': 0.35866716406647764, 'recall': 0.36553893233594015, 'f1-score': 0.3574990508031115, 'support': 58820}}
[[8200 3828 7657]
 [7124 3532 6818]
 [7793 4099 9769]]
training model: results/QRTEA/W0/deepLOB_L1/h500
Epoch 1/50
589/589 - 18s - loss: 3.3204 - accuracy500: 0.3627 - val_loss: 3.4664 - val_accuracy500: 0.3263 - 18s/epoch - 31ms/step
Epoch 2/50
589/589 - 16s - loss: 3.2831 - accuracy500: 0.3765 - val_loss: 3.4139 - val_accuracy500: 0.3627 - 16s/epoch - 27ms/step
Epoch 3/50
589/589 - 17s - loss: 3.2719 - accuracy500: 0.3838 - val_loss: 3.4745 - val_accuracy500: 0.3673 - 17s/epoch - 28ms/step
Epoch 4/50
589/589 - 16s - loss: 3.2536 - accuracy500: 0.3968 - val_loss: 3.5011 - val_accuracy500: 0.3699 - 16s/epoch - 27ms/step
Epoch 5/50
589/589 - 16s - loss: 3.2444 - accuracy500: 0.4016 - val_loss: 3.5142 - val_accuracy500: 0.3666 - 16s/epoch - 28ms/step
Epoch 6/50
589/589 - 16s - loss: 3.2355 - accuracy500: 0.4097 - val_loss: 3.4964 - val_accuracy500: 0.3564 - 16s/epoch - 27ms/step
Epoch 7/50
589/589 - 15s - loss: 3.2240 - accuracy500: 0.4144 - val_loss: 3.5850 - val_accuracy500: 0.3512 - 15s/epoch - 26ms/step
Epoch 8/50
589/589 - 15s - loss: 3.2194 - accuracy500: 0.4153 - val_loss: 3.6521 - val_accuracy500: 0.3607 - 15s/epoch - 26ms/step
Epoch 9/50
589/589 - 16s - loss: 3.2122 - accuracy500: 0.4196 - val_loss: 3.6278 - val_accuracy500: 0.3630 - 16s/epoch - 26ms/step
Epoch 10/50
589/589 - 16s - loss: 3.2037 - accuracy500: 0.4246 - val_loss: 3.6984 - val_accuracy500: 0.3624 - 16s/epoch - 27ms/step
Epoch 11/50
589/589 - 16s - loss: 3.1974 - accuracy500: 0.4279 - val_loss: 3.7293 - val_accuracy500: 0.3645 - 16s/epoch - 27ms/step
Epoch 12/50
589/589 - 16s - loss: 3.1930 - accuracy500: 0.4299 - val_loss: 3.7793 - val_accuracy500: 0.3633 - 16s/epoch - 27ms/step
testing model: results/QRTEA/W0/deepLOB_L1/h500
Evaluating performance on  test set...
2359/2359 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1348913
{'0': {'precision': 0.34673494206568134, 'recall': 0.6287688380781004, 'f1-score': 0.4469816131549629, 'support': 204506}, '1': {'precision': 0.29717753790583396, 'recall': 0.0857620770531445, 'f1-score': 0.13311008790288825, 'support': 165003}, '2': {'precision': 0.410772775592357, 'recall': 0.32492882417971736, 'f1-score': 0.3628425302313166, 'support': 234279}, 'accuracy': 0.36248153325339355, 'macro avg': {'precision': 0.35156175185462407, 'recall': 0.3464865797703207, 'f1-score': 0.3143114104297226, 'support': 603788}, 'weighted avg': {'precision': 0.3580395709125758, 'recall': 0.36248153325339355, 'f1-score': 0.3285596447000797, 'support': 603788}}
[[128587  16090  59829]
 [101486  14151  49366]
 [140778  17377  76124]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1215934
{'0': {'precision': 0.353806907378336, 'recall': 0.44332431767887875, 'f1-score': 0.3935392338753684, 'support': 52871}, '1': {'precision': 0.31839421192785006, 'recall': 0.1343381667090647, 'f1-score': 0.18895266492732016, 'support': 47172}, '2': {'precision': 0.35198438516590763, 'recall': 0.448501835695393, 'f1-score': 0.3944243855020136, 'support': 50662}, 'accuracy': 0.3483494243721177, 'macro avg': {'precision': 0.3413951681573646, 'recall': 0.3420547733611121, 'f1-score': 0.3256387614349007, 'support': 150705}, 'weighted avg': {'precision': 0.3421097487564166, 'recall': 0.3483494243721177, 'f1-score': 0.32979938397849545, 'support': 150705}}
[[23439  7138 22294]
 [21297  6337 19538]
 [21512  6428 22722]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1369681
{'0': {'precision': 0.34626008968609867, 'recall': 0.4790074441687345, 'f1-score': 0.4019573138990109, 'support': 20150}, '1': {'precision': 0.2696810658054098, 'recall': 0.08068607319724605, 'f1-score': 0.12420974339903311, 'support': 16558}, '2': {'precision': 0.40240852602824057, 'recall': 0.47300108538350216, 'f1-score': 0.43485853273184627, 'support': 22112}, 'accuracy': 0.36462087725263514, 'macro avg': {'precision': 0.33944989383991636, 'recall': 0.3442315342498275, 'f1-score': 0.3203418633432968, 'support': 58820}, 'weighted avg': {'precision': 0.3458105614130792, 'recall': 0.36462087725263514, 'f1-score': 0.3361390119352745, 'support': 58820}}
[[ 9652  1707  8791]
 [ 8481  1336  6741]
 [ 9742  1911 10459]]
training model: results/QRTEA/W0/deepLOB_L1/h1000
Epoch 1/50
589/589 - 18s - loss: 3.2887 - accuracy1000: 0.3962 - val_loss: 3.4337 - val_accuracy1000: 0.3578 - 18s/epoch - 31ms/step
Epoch 2/50
589/589 - 15s - loss: 3.2656 - accuracy1000: 0.3957 - val_loss: 3.5026 - val_accuracy1000: 0.3387 - 15s/epoch - 26ms/step
Epoch 3/50
589/589 - 16s - loss: 3.2411 - accuracy1000: 0.4051 - val_loss: 3.4836 - val_accuracy1000: 0.3541 - 16s/epoch - 27ms/step
Epoch 4/50
589/589 - 15s - loss: 3.2330 - accuracy1000: 0.4087 - val_loss: 3.4638 - val_accuracy1000: 0.3465 - 15s/epoch - 26ms/step
Epoch 5/50
589/589 - 15s - loss: 3.2324 - accuracy1000: 0.4101 - val_loss: 3.4703 - val_accuracy1000: 0.3358 - 15s/epoch - 26ms/step
Epoch 6/50
589/589 - 15s - loss: 3.2116 - accuracy1000: 0.4174 - val_loss: 3.4804 - val_accuracy1000: 0.3419 - 15s/epoch - 26ms/step
Epoch 7/50
589/589 - 16s - loss: 3.1875 - accuracy1000: 0.4270 - val_loss: 3.5322 - val_accuracy1000: 0.3480 - 16s/epoch - 27ms/step
Epoch 8/50
589/589 - 16s - loss: 3.1727 - accuracy1000: 0.4363 - val_loss: 3.5437 - val_accuracy1000: 0.3480 - 16s/epoch - 27ms/step
Epoch 9/50
589/589 - 16s - loss: 3.1701 - accuracy1000: 0.4368 - val_loss: 3.5840 - val_accuracy1000: 0.3453 - 16s/epoch - 27ms/step
Epoch 10/50
589/589 - 15s - loss: 3.1460 - accuracy1000: 0.4503 - val_loss: 3.6063 - val_accuracy1000: 0.3434 - 15s/epoch - 26ms/step
Epoch 11/50
589/589 - 15s - loss: 3.1455 - accuracy1000: 0.4495 - val_loss: 3.6280 - val_accuracy1000: 0.3464 - 15s/epoch - 25ms/step
testing model: results/QRTEA/W0/deepLOB_L1/h1000
Evaluating performance on  test set...
2359/2359 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.125326
{'0': {'precision': 0.2932037610778875, 'recall': 0.35649364870784056, 'f1-score': 0.32176603146991384, 'support': 182640}, '1': {'precision': 0.394051823143346, 'recall': 0.525621046032678, 'f1-score': 0.4504252292606155, 'support': 226513}, '2': {'precision': 0.4127869717646172, 'recall': 0.16877745523672516, 'f1-score': 0.23959214633719408, 'support': 194635}, 'accuracy': 0.35943079358980307, 'macro avg': {'precision': 0.3666808519952836, 'recall': 0.3502973833257479, 'f1-score': 0.33726113568924115, 'support': 603788}, 'weighted avg': {'precision': 0.36958566216675454, 'recall': 0.35943079358980307, 'f1-score': 0.34354365331128583, 'support': 603788}}
[[ 65110  88329  29201]
 [ 89923 119060  17530]
 [ 67031  94754  32850]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1332498
{'0': {'precision': 0.3423195084485407, 'recall': 0.2590626392575514, 'f1-score': 0.2949279278285708, 'support': 51613}, '1': {'precision': 0.34505662841214435, 'recall': 0.5433175168050612, 'f1-score': 0.4220638601772358, 'support': 50580}, '2': {'precision': 0.3640908664812674, 'recall': 0.24018799472295516, 'f1-score': 0.2894367509159784, 'support': 48512}, 'accuracy': 0.3483892372515842, 'macro avg': {'precision': 0.3504890011139841, 'recall': 0.3475227169285226, 'f1-score': 0.335476179640595, 'support': 150705}, 'weighted avg': {'precision': 0.35024635658657666, 'recall': 0.3483892372515842, 'f1-score': 0.3358300046263664, 'support': 150705}}
[[13371 26936 11306]
 [14054 27481  9045]
 [11635 25225 11652]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1416355
{'0': {'precision': 0.3589953749780458, 'recall': 0.31090604877554123, 'f1-score': 0.33322464949462016, 'support': 19723}, '1': {'precision': 0.34001300240926996, 'recall': 0.4848931064572426, 'f1-score': 0.39973024615038777, 'support': 18336}, '2': {'precision': 0.38441308531109686, 'recall': 0.2886662492172824, 'f1-score': 0.32972958102940775, 'support': 20761}, 'accuracy': 0.35729343760625637, 'macro avg': {'precision': 0.3611404875661375, 'recall': 0.3614884681500221, 'f1-score': 0.3542281588914719, 'support': 58820}, 'weighted avg': {'precision': 0.36204937533172477, 'recall': 0.35729343760625637, 'f1-score': 0.3527228729538837, 'support': 58820}}
[[6132 8183 5408]
 [5256 8891 4189]
 [5693 9075 5993]]
training model: results/QRTEA/W0/deepOF_L1/h10
Epoch 1/50
589/589 - 17s - loss: 3.2402 - accuracy10: 0.3760 - val_loss: 3.3088 - val_accuracy10: 0.5637 - 17s/epoch - 29ms/step
Epoch 2/50
589/589 - 14s - loss: 3.1814 - accuracy10: 0.4056 - val_loss: 3.2986 - val_accuracy10: 0.5767 - 14s/epoch - 24ms/step
Epoch 3/50
589/589 - 13s - loss: 3.1557 - accuracy10: 0.4190 - val_loss: 3.2943 - val_accuracy10: 0.5860 - 13s/epoch - 23ms/step
Epoch 4/50
589/589 - 14s - loss: 3.1385 - accuracy10: 0.4334 - val_loss: 3.2756 - val_accuracy10: 0.5891 - 14s/epoch - 24ms/step
Epoch 5/50
589/589 - 14s - loss: 3.1235 - accuracy10: 0.4444 - val_loss: 3.2810 - val_accuracy10: 0.5976 - 14s/epoch - 24ms/step
Epoch 6/50
589/589 - 15s - loss: 3.1108 - accuracy10: 0.4543 - val_loss: 3.2709 - val_accuracy10: 0.6006 - 15s/epoch - 25ms/step
Epoch 7/50
589/589 - 14s - loss: 3.0972 - accuracy10: 0.4624 - val_loss: 3.2586 - val_accuracy10: 0.5933 - 14s/epoch - 24ms/step
Epoch 8/50
589/589 - 14s - loss: 3.0832 - accuracy10: 0.4658 - val_loss: 3.2515 - val_accuracy10: 0.5957 - 14s/epoch - 24ms/step
Epoch 9/50
589/589 - 14s - loss: 3.0719 - accuracy10: 0.4687 - val_loss: 3.2485 - val_accuracy10: 0.5924 - 14s/epoch - 24ms/step
Epoch 10/50
589/589 - 15s - loss: 3.0600 - accuracy10: 0.4739 - val_loss: 3.2500 - val_accuracy10: 0.5926 - 15s/epoch - 25ms/step
Epoch 11/50
589/589 - 15s - loss: 3.0479 - accuracy10: 0.4777 - val_loss: 3.2326 - val_accuracy10: 0.5803 - 15s/epoch - 25ms/step
Epoch 12/50
589/589 - 15s - loss: 3.0333 - accuracy10: 0.4815 - val_loss: 3.2323 - val_accuracy10: 0.5753 - 15s/epoch - 25ms/step
Epoch 13/50
589/589 - 14s - loss: 3.0217 - accuracy10: 0.4851 - val_loss: 3.2273 - val_accuracy10: 0.5730 - 14s/epoch - 24ms/step
Epoch 14/50
589/589 - 14s - loss: 3.0091 - accuracy10: 0.4873 - val_loss: 3.2159 - val_accuracy10: 0.5559 - 14s/epoch - 24ms/step
Epoch 15/50
589/589 - 14s - loss: 2.9939 - accuracy10: 0.4888 - val_loss: 3.2061 - val_accuracy10: 0.5549 - 14s/epoch - 24ms/step
Epoch 16/50
589/589 - 14s - loss: 2.9856 - accuracy10: 0.4895 - val_loss: 3.1988 - val_accuracy10: 0.5478 - 14s/epoch - 24ms/step
Epoch 17/50
589/589 - 14s - loss: 2.9702 - accuracy10: 0.4963 - val_loss: 3.1618 - val_accuracy10: 0.5118 - 14s/epoch - 24ms/step
Epoch 18/50
589/589 - 14s - loss: 2.9573 - accuracy10: 0.4973 - val_loss: 3.1841 - val_accuracy10: 0.5220 - 14s/epoch - 24ms/step
Epoch 19/50
589/589 - 15s - loss: 2.9477 - accuracy10: 0.4998 - val_loss: 3.1810 - val_accuracy10: 0.5134 - 15s/epoch - 25ms/step
Epoch 20/50
589/589 - 15s - loss: 2.9374 - accuracy10: 0.5013 - val_loss: 3.1730 - val_accuracy10: 0.5099 - 15s/epoch - 25ms/step
Epoch 21/50
589/589 - 15s - loss: 2.9265 - accuracy10: 0.5014 - val_loss: 3.1789 - val_accuracy10: 0.5116 - 15s/epoch - 25ms/step
Epoch 22/50
589/589 - 13s - loss: 2.9159 - accuracy10: 0.5061 - val_loss: 3.1637 - val_accuracy10: 0.4992 - 13s/epoch - 22ms/step
Epoch 23/50
589/589 - 14s - loss: 2.9037 - accuracy10: 0.5073 - val_loss: 3.1596 - val_accuracy10: 0.4926 - 14s/epoch - 25ms/step
Epoch 24/50
589/589 - 15s - loss: 2.8923 - accuracy10: 0.5090 - val_loss: 3.1622 - val_accuracy10: 0.4807 - 15s/epoch - 25ms/step
Epoch 25/50
589/589 - 14s - loss: 2.8852 - accuracy10: 0.5123 - val_loss: 3.1649 - val_accuracy10: 0.4712 - 14s/epoch - 24ms/step
Epoch 26/50
589/589 - 14s - loss: 2.8744 - accuracy10: 0.5121 - val_loss: 3.1710 - val_accuracy10: 0.4604 - 14s/epoch - 24ms/step
Epoch 27/50
589/589 - 14s - loss: 2.8638 - accuracy10: 0.5171 - val_loss: 3.1503 - val_accuracy10: 0.4723 - 14s/epoch - 24ms/step
Epoch 28/50
589/589 - 14s - loss: 2.8533 - accuracy10: 0.5179 - val_loss: 3.1641 - val_accuracy10: 0.4679 - 14s/epoch - 24ms/step
Epoch 29/50
589/589 - 14s - loss: 2.8417 - accuracy10: 0.5217 - val_loss: 3.1834 - val_accuracy10: 0.4804 - 14s/epoch - 25ms/step
Epoch 30/50
589/589 - 14s - loss: 2.8368 - accuracy10: 0.5217 - val_loss: 3.1676 - val_accuracy10: 0.4746 - 14s/epoch - 24ms/step
Epoch 31/50
589/589 - 15s - loss: 2.8239 - accuracy10: 0.5254 - val_loss: 3.1714 - val_accuracy10: 0.4760 - 15s/epoch - 25ms/step
Epoch 32/50
589/589 - 15s - loss: 2.8121 - accuracy10: 0.5283 - val_loss: 3.1842 - val_accuracy10: 0.4888 - 15s/epoch - 25ms/step
Epoch 33/50
589/589 - 14s - loss: 2.8056 - accuracy10: 0.5288 - val_loss: 3.1678 - val_accuracy10: 0.4714 - 14s/epoch - 25ms/step
Epoch 34/50
589/589 - 14s - loss: 2.7965 - accuracy10: 0.5325 - val_loss: 3.2026 - val_accuracy10: 0.4837 - 14s/epoch - 24ms/step
Epoch 35/50
589/589 - 15s - loss: 2.7854 - accuracy10: 0.5312 - val_loss: 3.1763 - val_accuracy10: 0.4669 - 15s/epoch - 25ms/step
Epoch 36/50
589/589 - 14s - loss: 2.7803 - accuracy10: 0.5333 - val_loss: 3.2060 - val_accuracy10: 0.4782 - 14s/epoch - 24ms/step
Epoch 37/50
589/589 - 15s - loss: 2.7702 - accuracy10: 0.5358 - val_loss: 3.2069 - val_accuracy10: 0.4831 - 15s/epoch - 25ms/step
testing model: results/QRTEA/W0/deepOF_L1/h10
Evaluating performance on  test set...
2359/2359 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.956328
{'0': {'precision': 0.2574465616752226, 'recall': 0.4319780032605786, 'f1-score': 0.32262050792785424, 'support': 82194}, '1': {'precision': 0.8076023542941317, 'recall': 0.5704496915045087, 'f1-score': 0.668619904843157, 'support': 438256}, '2': {'precision': 0.22149643325549406, 'recall': 0.41545366181464727, 'f1-score': 0.2889441574374682, 'support': 83333}, 'accuracy': 0.5302070445838986, 'macro avg': {'precision': 0.4288484497416161, 'recall': 0.47262711885991154, 'f1-score': 0.4267281900694932, 'support': 603783}, 'weighted avg': {'precision': 0.6518154740135815, 'recall': 0.5302070445838986, 'f1-score': 0.5691162860121951, 'support': 603783}}
[[ 35506  28042  18646]
 [ 85215 250003 103038]
 [ 17195  31517  34621]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9797294
{'0': {'precision': 0.27247749881572714, 'recall': 0.491120218579235, 'f1-score': 0.35049661812199134, 'support': 23424}, '1': {'precision': 0.8133870793371326, 'recall': 0.5054609670422481, 'f1-score': 0.623476557182008, 'support': 104194}, '2': {'precision': 0.26525665942608895, 'recall': 0.5025123451442433, 'f1-score': 0.34722617141317846, 'support': 23086}, 'accuracy': 0.5027802845312666, 'macro avg': {'precision': 0.45037374585964957, 'recall': 0.49969784358857544, 'f1-score': 0.44039978223905923, 'support': 150704}, 'weighted avg': {'precision': 0.6453463844106558, 'recall': 0.5027802845312666, 'f1-score': 0.5387289824766185, 'support': 150704}}
[[11504  6059  5861]
 [25255 52666 26273]
 [ 5461  6024 11601]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0003568
{'0': {'precision': 0.2625631876300922, 'recall': 0.4671463337212993, 'f1-score': 0.33617604507728616, 'support': 9451}, '1': {'precision': 0.7763922173930704, 'recall': 0.47862777012645547, 'f1-score': 0.592186386591071, 'support': 39935}, '2': {'precision': 0.25033074489502444, 'recall': 0.46135905862397963, 'f1-score': 0.32455813259750915, 'support': 9433}, 'accuracy': 0.474013499039426, 'macro avg': {'precision': 0.42976204997272904, 'recall': 0.4690443874905781, 'f1-score': 0.4176401880886221, 'support': 58819}, 'weighted avg': {'precision': 0.6094642514235032, 'recall': 0.474013499039426, 'f1-score': 0.5081303662988517, 'support': 58819}}
[[ 4415  2727  2309]
 [10097 19114 10724]
 [ 2303  2778  4352]]
training model: results/QRTEA/W0/deepOF_L1/h20
Epoch 1/50
589/589 - 17s - loss: 3.2587 - accuracy20: 0.3848 - val_loss: 3.2989 - val_accuracy20: 0.5073 - 17s/epoch - 28ms/step
Epoch 2/50
589/589 - 14s - loss: 3.2047 - accuracy20: 0.4112 - val_loss: 3.3009 - val_accuracy20: 0.5343 - 14s/epoch - 23ms/step
Epoch 3/50
589/589 - 14s - loss: 3.1796 - accuracy20: 0.4257 - val_loss: 3.3019 - val_accuracy20: 0.5406 - 14s/epoch - 23ms/step
Epoch 4/50
589/589 - 14s - loss: 3.1615 - accuracy20: 0.4391 - val_loss: 3.2960 - val_accuracy20: 0.5471 - 14s/epoch - 24ms/step
Epoch 5/50
589/589 - 15s - loss: 3.1479 - accuracy20: 0.4476 - val_loss: 3.2819 - val_accuracy20: 0.5474 - 15s/epoch - 25ms/step
Epoch 6/50
589/589 - 14s - loss: 3.1327 - accuracy20: 0.4567 - val_loss: 3.2758 - val_accuracy20: 0.5492 - 14s/epoch - 25ms/step
Epoch 7/50
589/589 - 14s - loss: 3.1207 - accuracy20: 0.4627 - val_loss: 3.2653 - val_accuracy20: 0.5460 - 14s/epoch - 25ms/step
Epoch 8/50
589/589 - 14s - loss: 3.1084 - accuracy20: 0.4676 - val_loss: 3.2549 - val_accuracy20: 0.5428 - 14s/epoch - 24ms/step
Epoch 9/50
589/589 - 14s - loss: 3.0977 - accuracy20: 0.4727 - val_loss: 3.2468 - val_accuracy20: 0.5387 - 14s/epoch - 24ms/step
Epoch 10/50
589/589 - 14s - loss: 3.0852 - accuracy20: 0.4754 - val_loss: 3.2409 - val_accuracy20: 0.5298 - 14s/epoch - 24ms/step
Epoch 11/50
589/589 - 14s - loss: 3.0731 - accuracy20: 0.4777 - val_loss: 3.2422 - val_accuracy20: 0.5283 - 14s/epoch - 24ms/step
Epoch 12/50
589/589 - 14s - loss: 3.0605 - accuracy20: 0.4804 - val_loss: 3.2370 - val_accuracy20: 0.5166 - 14s/epoch - 24ms/step
Epoch 13/50
589/589 - 14s - loss: 3.0494 - accuracy20: 0.4818 - val_loss: 3.2343 - val_accuracy20: 0.5079 - 14s/epoch - 24ms/step
Epoch 14/50
589/589 - 14s - loss: 3.0361 - accuracy20: 0.4856 - val_loss: 3.2497 - val_accuracy20: 0.5119 - 14s/epoch - 24ms/step
Epoch 15/50
589/589 - 15s - loss: 3.0253 - accuracy20: 0.4859 - val_loss: 3.2326 - val_accuracy20: 0.4993 - 15s/epoch - 25ms/step
Epoch 16/50
589/589 - 15s - loss: 3.0163 - accuracy20: 0.4910 - val_loss: 3.2185 - val_accuracy20: 0.4929 - 15s/epoch - 25ms/step
Epoch 17/50
589/589 - 15s - loss: 3.0009 - accuracy20: 0.4950 - val_loss: 3.2056 - val_accuracy20: 0.4817 - 15s/epoch - 25ms/step
Epoch 18/50
589/589 - 14s - loss: 2.9920 - accuracy20: 0.4954 - val_loss: 3.2152 - val_accuracy20: 0.4812 - 14s/epoch - 24ms/step
Epoch 19/50
589/589 - 13s - loss: 2.9819 - accuracy20: 0.4979 - val_loss: 3.2214 - val_accuracy20: 0.4896 - 13s/epoch - 23ms/step
Epoch 20/50
589/589 - 14s - loss: 2.9700 - accuracy20: 0.5000 - val_loss: 3.1917 - val_accuracy20: 0.4765 - 14s/epoch - 24ms/step
Epoch 21/50
589/589 - 14s - loss: 2.9582 - accuracy20: 0.5058 - val_loss: 3.1853 - val_accuracy20: 0.4695 - 14s/epoch - 24ms/step
Epoch 22/50
589/589 - 14s - loss: 2.9506 - accuracy20: 0.5066 - val_loss: 3.1822 - val_accuracy20: 0.4621 - 14s/epoch - 24ms/step
Epoch 23/50
589/589 - 15s - loss: 2.9427 - accuracy20: 0.5067 - val_loss: 3.1673 - val_accuracy20: 0.4661 - 15s/epoch - 26ms/step
Epoch 24/50
589/589 - 15s - loss: 2.9291 - accuracy20: 0.5114 - val_loss: 3.1790 - val_accuracy20: 0.4608 - 15s/epoch - 25ms/step
Epoch 25/50
589/589 - 14s - loss: 2.9199 - accuracy20: 0.5138 - val_loss: 3.1862 - val_accuracy20: 0.4600 - 14s/epoch - 24ms/step
Epoch 26/50
589/589 - 15s - loss: 2.9111 - accuracy20: 0.5161 - val_loss: 3.1840 - val_accuracy20: 0.4583 - 15s/epoch - 25ms/step
Epoch 27/50
589/589 - 15s - loss: 2.9035 - accuracy20: 0.5170 - val_loss: 3.1840 - val_accuracy20: 0.4721 - 15s/epoch - 25ms/step
Epoch 28/50
589/589 - 15s - loss: 2.8910 - accuracy20: 0.5200 - val_loss: 3.1865 - val_accuracy20: 0.4688 - 15s/epoch - 25ms/step
Epoch 29/50
589/589 - 15s - loss: 2.8788 - accuracy20: 0.5258 - val_loss: 3.1830 - val_accuracy20: 0.4591 - 15s/epoch - 26ms/step
Epoch 30/50
589/589 - 15s - loss: 2.8708 - accuracy20: 0.5283 - val_loss: 3.1941 - val_accuracy20: 0.4691 - 15s/epoch - 25ms/step
Epoch 31/50
589/589 - 15s - loss: 2.8650 - accuracy20: 0.5279 - val_loss: 3.1969 - val_accuracy20: 0.4647 - 15s/epoch - 25ms/step
Epoch 32/50
589/589 - 15s - loss: 2.8502 - accuracy20: 0.5326 - val_loss: 3.2040 - val_accuracy20: 0.4657 - 15s/epoch - 26ms/step
Epoch 33/50
589/589 - 15s - loss: 2.8397 - accuracy20: 0.5339 - val_loss: 3.1850 - val_accuracy20: 0.4508 - 15s/epoch - 25ms/step
testing model: results/QRTEA/W0/deepOF_L1/h20
Evaluating performance on  test set...
2359/2359 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97582525
{'0': {'precision': 0.2935566088871974, 'recall': 0.4795674209167813, 'f1-score': 0.3641852546034653, 'support': 106154}, '1': {'precision': 0.7330894535671517, 'recall': 0.5743094930885052, 'f1-score': 0.6440577813584067, 'support': 389062}, '2': {'precision': 0.28269491120490564, 'recall': 0.32696860003500144, 'f1-score': 0.30322418071470975, 'support': 108567}, 'accuracy': 0.5131777476344979, 'macro avg': {'precision': 0.43644699121975156, 'recall': 0.46028183801342926, 'f1-score': 0.4371557388921939, 'support': 603783}, 'weighted avg': {'precision': 0.5748270416165041, 'recall': 0.5131777476344979, 'f1-score': 0.5335663138506626, 'support': 603783}}
[[ 50908  37005  18241]
 [ 93789 223442  71831]
 [ 28721  44348  35498]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9960412
{'0': {'precision': 0.3120491174213354, 'recall': 0.5332459016393443, 'f1-score': 0.3937061244250787, 'support': 30500}, '1': {'precision': 0.7345566831245276, 'recall': 0.5059429520908335, 'f1-score': 0.5991840161622523, 'support': 90275}, '2': {'precision': 0.3295975827496223, 'recall': 0.4009155000167062, 'f1-score': 0.3617752585401152, 'support': 29929}, 'accuracy': 0.4906107336235269, 'macro avg': {'precision': 0.4587344610984951, 'recall': 0.4800347845822947, 'f1-score': 0.45155513304248207, 'support': 150704}, 'weighted avg': {'precision': 0.5686254426195118, 'recall': 0.4906107336235269, 'f1-score': 0.5104505890146203, 'support': 150704}}
[[16264  8057  6179]
 [26374 45674 18227]
 [ 9482  8448 11999]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0125527
{'0': {'precision': 0.310752531860251, 'recall': 0.5250532176191256, 'f1-score': 0.39042951508325463, 'support': 12214}, '1': {'precision': 0.6863383474139707, 'recall': 0.4855535146797283, 'f1-score': 0.5687453042824944, 'support': 34299}, '2': {'precision': 0.3169504922037796, 'recall': 0.35844303591743865, 'f1-score': 0.3364222247645197, 'support': 12306}, 'accuracy': 0.46716197147180333, 'macro avg': {'precision': 0.4380137904926671, 'recall': 0.4563499227387642, 'f1-score': 0.43186568137675624, 'support': 58819}, 'weighted avg': {'precision': 0.531063825620167, 'recall': 0.46716197147180333, 'f1-score': 0.4831111237315209, 'support': 58819}}
[[ 6413  3554  2247]
 [10386 16654  7259]
 [ 3838  4057  4411]]
training model: results/QRTEA/W0/deepOF_L1/h30
Epoch 1/50
589/589 - 17s - loss: 3.2771 - accuracy30: 0.3820 - val_loss: 3.3301 - val_accuracy30: 0.4741 - 17s/epoch - 29ms/step
Epoch 2/50
589/589 - 15s - loss: 3.2227 - accuracy30: 0.4117 - val_loss: 3.3223 - val_accuracy30: 0.4906 - 15s/epoch - 26ms/step
Epoch 3/50
589/589 - 15s - loss: 3.2011 - accuracy30: 0.4227 - val_loss: 3.3182 - val_accuracy30: 0.4970 - 15s/epoch - 25ms/step
Epoch 4/50
589/589 - 15s - loss: 3.1826 - accuracy30: 0.4333 - val_loss: 3.3138 - val_accuracy30: 0.5010 - 15s/epoch - 26ms/step
Epoch 5/50
589/589 - 16s - loss: 3.1693 - accuracy30: 0.4416 - val_loss: 3.3046 - val_accuracy30: 0.5021 - 16s/epoch - 26ms/step
Epoch 6/50
589/589 - 16s - loss: 3.1587 - accuracy30: 0.4451 - val_loss: 3.3030 - val_accuracy30: 0.5079 - 16s/epoch - 27ms/step
Epoch 7/50
589/589 - 16s - loss: 3.1479 - accuracy30: 0.4522 - val_loss: 3.2914 - val_accuracy30: 0.5053 - 16s/epoch - 26ms/step
Epoch 8/50
589/589 - 16s - loss: 3.1375 - accuracy30: 0.4580 - val_loss: 3.2887 - val_accuracy30: 0.5070 - 16s/epoch - 27ms/step
Epoch 9/50
589/589 - 15s - loss: 3.1267 - accuracy30: 0.4624 - val_loss: 3.2886 - val_accuracy30: 0.5040 - 15s/epoch - 25ms/step
Epoch 10/50
589/589 - 15s - loss: 3.1166 - accuracy30: 0.4667 - val_loss: 3.2805 - val_accuracy30: 0.5029 - 15s/epoch - 25ms/step
Epoch 11/50
589/589 - 15s - loss: 3.1093 - accuracy30: 0.4671 - val_loss: 3.2787 - val_accuracy30: 0.5000 - 15s/epoch - 25ms/step
Epoch 12/50
589/589 - 15s - loss: 3.1004 - accuracy30: 0.4711 - val_loss: 3.2788 - val_accuracy30: 0.4996 - 15s/epoch - 26ms/step
Epoch 13/50
589/589 - 15s - loss: 3.0901 - accuracy30: 0.4743 - val_loss: 3.2728 - val_accuracy30: 0.4967 - 15s/epoch - 26ms/step
Epoch 14/50
589/589 - 15s - loss: 3.0797 - accuracy30: 0.4776 - val_loss: 3.2782 - val_accuracy30: 0.4941 - 15s/epoch - 26ms/step
Epoch 15/50
589/589 - 15s - loss: 3.0716 - accuracy30: 0.4793 - val_loss: 3.2773 - val_accuracy30: 0.4894 - 15s/epoch - 25ms/step
Epoch 16/50
589/589 - 15s - loss: 3.0620 - accuracy30: 0.4811 - val_loss: 3.2661 - val_accuracy30: 0.4860 - 15s/epoch - 26ms/step
Epoch 17/50
589/589 - 15s - loss: 3.0486 - accuracy30: 0.4827 - val_loss: 3.2711 - val_accuracy30: 0.4824 - 15s/epoch - 26ms/step
Epoch 18/50
589/589 - 16s - loss: 3.0408 - accuracy30: 0.4856 - val_loss: 3.2831 - val_accuracy30: 0.4803 - 16s/epoch - 27ms/step
Epoch 19/50
589/589 - 15s - loss: 3.0322 - accuracy30: 0.4880 - val_loss: 3.2722 - val_accuracy30: 0.4749 - 15s/epoch - 26ms/step
Epoch 20/50
589/589 - 16s - loss: 3.0220 - accuracy30: 0.4900 - val_loss: 3.2825 - val_accuracy30: 0.4731 - 16s/epoch - 27ms/step
Epoch 21/50
589/589 - 16s - loss: 3.0133 - accuracy30: 0.4912 - val_loss: 3.2849 - val_accuracy30: 0.4786 - 16s/epoch - 27ms/step
Epoch 22/50
589/589 - 15s - loss: 3.0053 - accuracy30: 0.4945 - val_loss: 3.2874 - val_accuracy30: 0.4770 - 15s/epoch - 25ms/step
Epoch 23/50
589/589 - 15s - loss: 2.9926 - accuracy30: 0.4956 - val_loss: 3.2711 - val_accuracy30: 0.4726 - 15s/epoch - 26ms/step
Epoch 24/50
589/589 - 15s - loss: 2.9827 - accuracy30: 0.4999 - val_loss: 3.2847 - val_accuracy30: 0.4698 - 15s/epoch - 25ms/step
Epoch 25/50
589/589 - 15s - loss: 2.9757 - accuracy30: 0.5021 - val_loss: 3.2833 - val_accuracy30: 0.4771 - 15s/epoch - 25ms/step
Epoch 26/50
589/589 - 15s - loss: 2.9682 - accuracy30: 0.5035 - val_loss: 3.2874 - val_accuracy30: 0.4679 - 15s/epoch - 25ms/step
testing model: results/QRTEA/W0/deepOF_L1/h30
Evaluating performance on  test set...
2359/2359 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99053943
{'0': {'precision': 0.3668252821445477, 'recall': 0.24230256553721594, 'f1-score': 0.29183596614671076, 'support': 121534}, '1': {'precision': 0.6254945114599991, 'recall': 0.7762199092787209, 'f1-score': 0.6927535106386976, 'support': 356256}, '2': {'precision': 0.3195990270509324, 'recall': 0.20648766201296898, 'f1-score': 0.2508835796427108, 'support': 125993}, 'accuracy': 0.5498614568479073, 'macro avg': {'precision': 0.43730627355182644, 'recall': 0.4083367122763019, 'f1-score': 0.41182435214270646, 'support': 603783}, 'weighted avg': {'precision': 0.509595594327891, 'recall': 0.5498614568479073, 'f1-score': 0.5198476304329507, 'support': 603783}}
[[ 29448  79488  12598]
 [ 36935 276533  42788]
 [ 13895  86082  26016]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0065991
{'0': {'precision': 0.37936316883685306, 'recall': 0.29723936899862824, 'f1-score': 0.3333173100033649, 'support': 34992}, '1': {'precision': 0.605482233502538, 'recall': 0.6959245338639546, 'f1-score': 0.6475607038156684, 'support': 81414}, '2': {'precision': 0.3622778675282714, 'recall': 0.3138375415476121, 'f1-score': 0.33632244961724733, 'support': 34298}, 'accuracy': 0.5163963796581378, 'macro avg': {'precision': 0.4490410899558875, 'recall': 0.43566714813673163, 'f1-score': 0.4390668211454269, 'support': 150704}, 'weighted avg': {'precision': 0.49762987619969906, 'recall': 0.5163963796581378, 'f1-score': 0.5037632301004548, 'support': 150704}}
[[10401 18743  5848]
 [11656 56658 13100]
 [ 5360 18174 10764]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0227342
{'0': {'precision': 0.37293860520564276, 'recall': 0.2678176499964329, 'f1-score': 0.31175518000249136, 'support': 14017}, '1': {'precision': 0.5572764465225014, 'recall': 0.6855900905317515, 'f1-score': 0.6148097129207637, 'support': 30597}, '2': {'precision': 0.34686346863468637, 'recall': 0.27131291798662444, 'f1-score': 0.3044714804866488, 'support': 14205}, 'accuracy': 0.48598242064638975, 'macro avg': {'precision': 0.4256928401209435, 'recall': 0.40824021950493633, 'f1-score': 0.4103454578033013, 'support': 58819}, 'weighted avg': {'precision': 0.4625318933571157, 'recall': 0.48598242064638975, 'f1-score': 0.4676417913368873, 'support': 58819}}
[[ 3754  8197  2066]
 [ 4429 20977  5191]
 [ 1883  8468  3854]]
training model: results/QRTEA/W0/deepOF_L1/h50
Epoch 1/50
589/589 - 17s - loss: 3.2935 - accuracy50: 0.3781 - val_loss: 3.3369 - val_accuracy50: 0.4151 - 17s/epoch - 29ms/step
Epoch 2/50
589/589 - 15s - loss: 3.2465 - accuracy50: 0.4022 - val_loss: 3.3304 - val_accuracy50: 0.4289 - 15s/epoch - 26ms/step
Epoch 3/50
589/589 - 15s - loss: 3.2275 - accuracy50: 0.4082 - val_loss: 3.3314 - val_accuracy50: 0.4342 - 15s/epoch - 26ms/step
Epoch 4/50
589/589 - 15s - loss: 3.2128 - accuracy50: 0.4163 - val_loss: 3.3226 - val_accuracy50: 0.4358 - 15s/epoch - 26ms/step
Epoch 5/50
589/589 - 15s - loss: 3.2016 - accuracy50: 0.4205 - val_loss: 3.3160 - val_accuracy50: 0.4384 - 15s/epoch - 26ms/step
Epoch 6/50
589/589 - 15s - loss: 3.1911 - accuracy50: 0.4257 - val_loss: 3.3163 - val_accuracy50: 0.4398 - 15s/epoch - 25ms/step
Epoch 7/50
589/589 - 16s - loss: 3.1833 - accuracy50: 0.4300 - val_loss: 3.3072 - val_accuracy50: 0.4413 - 16s/epoch - 27ms/step
Epoch 8/50
589/589 - 15s - loss: 3.1770 - accuracy50: 0.4341 - val_loss: 3.3095 - val_accuracy50: 0.4444 - 15s/epoch - 26ms/step
Epoch 9/50
589/589 - 15s - loss: 3.1712 - accuracy50: 0.4367 - val_loss: 3.2997 - val_accuracy50: 0.4427 - 15s/epoch - 25ms/step
Epoch 10/50
589/589 - 16s - loss: 3.1633 - accuracy50: 0.4396 - val_loss: 3.3018 - val_accuracy50: 0.4450 - 16s/epoch - 27ms/step
Epoch 11/50
589/589 - 15s - loss: 3.1566 - accuracy50: 0.4436 - val_loss: 3.3019 - val_accuracy50: 0.4449 - 15s/epoch - 26ms/step
Epoch 12/50
589/589 - 15s - loss: 3.1514 - accuracy50: 0.4462 - val_loss: 3.3000 - val_accuracy50: 0.4439 - 15s/epoch - 25ms/step
Epoch 13/50
589/589 - 14s - loss: 3.1441 - accuracy50: 0.4475 - val_loss: 3.3027 - val_accuracy50: 0.4432 - 14s/epoch - 23ms/step
Epoch 14/50
589/589 - 14s - loss: 3.1388 - accuracy50: 0.4506 - val_loss: 3.2971 - val_accuracy50: 0.4460 - 14s/epoch - 24ms/step
Epoch 15/50
589/589 - 14s - loss: 3.1335 - accuracy50: 0.4534 - val_loss: 3.2946 - val_accuracy50: 0.4436 - 14s/epoch - 24ms/step
Epoch 16/50
589/589 - 16s - loss: 3.1272 - accuracy50: 0.4543 - val_loss: 3.2944 - val_accuracy50: 0.4429 - 16s/epoch - 26ms/step
Epoch 17/50
589/589 - 14s - loss: 3.1206 - accuracy50: 0.4576 - val_loss: 3.2994 - val_accuracy50: 0.4404 - 14s/epoch - 24ms/step
Epoch 18/50
589/589 - 15s - loss: 3.1134 - accuracy50: 0.4583 - val_loss: 3.2940 - val_accuracy50: 0.4439 - 15s/epoch - 25ms/step
Epoch 19/50
589/589 - 14s - loss: 3.1074 - accuracy50: 0.4602 - val_loss: 3.2965 - val_accuracy50: 0.4453 - 14s/epoch - 24ms/step
Epoch 20/50
589/589 - 14s - loss: 3.1018 - accuracy50: 0.4611 - val_loss: 3.2932 - val_accuracy50: 0.4445 - 14s/epoch - 23ms/step
Epoch 21/50
589/589 - 13s - loss: 3.0966 - accuracy50: 0.4628 - val_loss: 3.3015 - val_accuracy50: 0.4406 - 13s/epoch - 23ms/step
Epoch 22/50
589/589 - 13s - loss: 3.0873 - accuracy50: 0.4662 - val_loss: 3.3063 - val_accuracy50: 0.4427 - 13s/epoch - 22ms/step
Epoch 23/50
589/589 - 14s - loss: 3.0805 - accuracy50: 0.4656 - val_loss: 3.2973 - val_accuracy50: 0.4416 - 14s/epoch - 23ms/step
Epoch 24/50
589/589 - 14s - loss: 3.0731 - accuracy50: 0.4683 - val_loss: 3.2867 - val_accuracy50: 0.4409 - 14s/epoch - 24ms/step
Epoch 25/50
589/589 - 14s - loss: 3.0669 - accuracy50: 0.4713 - val_loss: 3.3117 - val_accuracy50: 0.4396 - 14s/epoch - 24ms/step
Epoch 26/50
589/589 - 15s - loss: 3.0586 - accuracy50: 0.4748 - val_loss: 3.2885 - val_accuracy50: 0.4394 - 15s/epoch - 25ms/step
Epoch 27/50
589/589 - 15s - loss: 3.0528 - accuracy50: 0.4748 - val_loss: 3.2714 - val_accuracy50: 0.4336 - 15s/epoch - 25ms/step
Epoch 28/50
589/589 - 14s - loss: 3.0435 - accuracy50: 0.4771 - val_loss: 3.2959 - val_accuracy50: 0.4338 - 14s/epoch - 24ms/step
Epoch 29/50
589/589 - 14s - loss: 3.0348 - accuracy50: 0.4797 - val_loss: 3.2703 - val_accuracy50: 0.4367 - 14s/epoch - 25ms/step
Epoch 30/50
589/589 - 15s - loss: 3.0275 - accuracy50: 0.4823 - val_loss: 3.2736 - val_accuracy50: 0.4304 - 15s/epoch - 25ms/step
Epoch 31/50
589/589 - 15s - loss: 3.0225 - accuracy50: 0.4827 - val_loss: 3.2940 - val_accuracy50: 0.4315 - 15s/epoch - 25ms/step
Epoch 32/50
589/589 - 14s - loss: 3.0125 - accuracy50: 0.4862 - val_loss: 3.2958 - val_accuracy50: 0.4302 - 14s/epoch - 24ms/step
Epoch 33/50
589/589 - 15s - loss: 3.0015 - accuracy50: 0.4903 - val_loss: 3.3220 - val_accuracy50: 0.4275 - 15s/epoch - 25ms/step
Epoch 34/50
589/589 - 14s - loss: 2.9937 - accuracy50: 0.4905 - val_loss: 3.3068 - val_accuracy50: 0.4325 - 14s/epoch - 24ms/step
Epoch 35/50
589/589 - 15s - loss: 2.9839 - accuracy50: 0.4950 - val_loss: 3.3455 - val_accuracy50: 0.4239 - 15s/epoch - 26ms/step
Epoch 36/50
589/589 - 15s - loss: 2.9764 - accuracy50: 0.4976 - val_loss: 3.3114 - val_accuracy50: 0.4310 - 15s/epoch - 25ms/step
Epoch 37/50
589/589 - 15s - loss: 2.9685 - accuracy50: 0.4976 - val_loss: 3.3165 - val_accuracy50: 0.4285 - 15s/epoch - 25ms/step
Epoch 38/50
589/589 - 15s - loss: 2.9544 - accuracy50: 0.5017 - val_loss: 3.2930 - val_accuracy50: 0.4300 - 15s/epoch - 25ms/step
Epoch 39/50
589/589 - 14s - loss: 2.9482 - accuracy50: 0.5028 - val_loss: 3.3417 - val_accuracy50: 0.4227 - 14s/epoch - 24ms/step
testing model: results/QRTEA/W0/deepOF_L1/h50
Evaluating performance on  test set...
2359/2359 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0281721
{'0': {'precision': 0.38433869966226963, 'recall': 0.35584830787136035, 'f1-score': 0.36954519474751446, 'support': 142631}, '1': {'precision': 0.5736660693609007, 'recall': 0.6912744942521666, 'f1-score': 0.6270029333779653, 'support': 308899}, '2': {'precision': 0.3367102856338821, 'recall': 0.22004164121560824, 'f1-score': 0.26615187228650533, 'support': 152253}, 'accuracy': 0.49320865277757076, 'macro avg': {'precision': 0.43157168488568415, 'recall': 0.4223881477797118, 'f1-score': 0.42090000013732837, 'support': 603783}, 'weighted avg': {'precision': 0.4691894924992216, 'recall': 0.49320865277757076, 'f1-score': 0.4751899288333559, 'support': 603783}}
[[ 50755  69116  22760]
 [ 52129 213534  43236]
 [ 29174  89577  33502]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0364842
{'0': {'precision': 0.3855248041775457, 'recall': 0.45126036038238676, 'f1-score': 0.41581057943588356, 'support': 40901}, '1': {'precision': 0.5664780333455032, 'recall': 0.5347060681772494, 'f1-score': 0.5501336997148725, 'support': 69642}, '2': {'precision': 0.3863801795487019, 'recall': 0.35686362391374715, 'f1-score': 0.37103580397131536, 'support': 40161}, 'accuracy': 0.46466583501433273, 'macro avg': {'precision': 0.44612767235725026, 'recall': 0.4476100174911277, 'f1-score': 0.4456600277073571, 'support': 150704}, 'weighted avg': {'precision': 0.469373258870161, 'recall': 0.46466583501433273, 'f1-score': 0.46595079459299166, 'support': 150704}}
[[18457 13923  8521]
 [18164 37238 14240]
 [11254 14575 14332]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0582049
{'0': {'precision': 0.3862803075103489, 'recall': 0.3961909383150361, 'f1-score': 0.39117285983770994, 'support': 16487}, '1': {'precision': 0.49705205637043426, 'recall': 0.5415377384356272, 'f1-score': 0.518342174817703, 'support': 25531}, '2': {'precision': 0.365003902646704, 'recall': 0.3061722516516874, 'f1-score': 0.3330096458859325, 'support': 16801}, 'accuracy': 0.43356738468862105, 'macro avg': {'precision': 0.4161120888424958, 'recall': 0.4146336428007836, 'f1-score': 0.41417489351378184, 'support': 58819}, 'weighted avg': {'precision': 0.4282845687530212, 'recall': 0.43356738468862105, 'f1-score': 0.42975834451358663, 'support': 58819}}
[[ 6532  6471  3484]
 [ 6240 13826  5465]
 [ 4138  7519  5144]]
training model: results/QRTEA/W0/deepOF_L1/h100
Epoch 1/50
589/589 - 18s - loss: 3.3193 - accuracy100: 0.3622 - val_loss: 3.3036 - val_accuracy100: 0.3516 - 18s/epoch - 30ms/step
Epoch 2/50
589/589 - 15s - loss: 3.2820 - accuracy100: 0.3802 - val_loss: 3.2983 - val_accuracy100: 0.3500 - 15s/epoch - 26ms/step
Epoch 3/50
589/589 - 15s - loss: 3.2689 - accuracy100: 0.3849 - val_loss: 3.3020 - val_accuracy100: 0.3477 - 15s/epoch - 26ms/step
Epoch 4/50
589/589 - 15s - loss: 3.2594 - accuracy100: 0.3896 - val_loss: 3.2995 - val_accuracy100: 0.3491 - 15s/epoch - 25ms/step
Epoch 5/50
589/589 - 15s - loss: 3.2531 - accuracy100: 0.3921 - val_loss: 3.3005 - val_accuracy100: 0.3466 - 15s/epoch - 26ms/step
Epoch 6/50
589/589 - 15s - loss: 3.2464 - accuracy100: 0.3953 - val_loss: 3.2990 - val_accuracy100: 0.3511 - 15s/epoch - 26ms/step
Epoch 7/50
589/589 - 15s - loss: 3.2400 - accuracy100: 0.3985 - val_loss: 3.2950 - val_accuracy100: 0.3527 - 15s/epoch - 26ms/step
Epoch 8/50
589/589 - 14s - loss: 3.2361 - accuracy100: 0.4004 - val_loss: 3.2976 - val_accuracy100: 0.3525 - 14s/epoch - 24ms/step
Epoch 9/50
589/589 - 15s - loss: 3.2305 - accuracy100: 0.4041 - val_loss: 3.2948 - val_accuracy100: 0.3557 - 15s/epoch - 25ms/step
Epoch 10/50
589/589 - 15s - loss: 3.2272 - accuracy100: 0.4060 - val_loss: 3.2948 - val_accuracy100: 0.3565 - 15s/epoch - 25ms/step
Epoch 11/50
589/589 - 15s - loss: 3.2235 - accuracy100: 0.4073 - val_loss: 3.2941 - val_accuracy100: 0.3565 - 15s/epoch - 26ms/step
Epoch 12/50
589/589 - 15s - loss: 3.2191 - accuracy100: 0.4093 - val_loss: 3.2938 - val_accuracy100: 0.3563 - 15s/epoch - 25ms/step
Epoch 13/50
589/589 - 14s - loss: 3.2160 - accuracy100: 0.4109 - val_loss: 3.2926 - val_accuracy100: 0.3575 - 14s/epoch - 24ms/step
Epoch 14/50
589/589 - 14s - loss: 3.2133 - accuracy100: 0.4136 - val_loss: 3.2906 - val_accuracy100: 0.3605 - 14s/epoch - 24ms/step
Epoch 15/50
589/589 - 15s - loss: 3.2096 - accuracy100: 0.4157 - val_loss: 3.2937 - val_accuracy100: 0.3597 - 15s/epoch - 25ms/step
Epoch 16/50
589/589 - 15s - loss: 3.2039 - accuracy100: 0.4180 - val_loss: 3.2946 - val_accuracy100: 0.3577 - 15s/epoch - 25ms/step
Epoch 17/50
589/589 - 14s - loss: 3.2004 - accuracy100: 0.4198 - val_loss: 3.2957 - val_accuracy100: 0.3586 - 14s/epoch - 25ms/step
Epoch 18/50
589/589 - 15s - loss: 3.1962 - accuracy100: 0.4224 - val_loss: 3.2961 - val_accuracy100: 0.3591 - 15s/epoch - 25ms/step
Epoch 19/50
589/589 - 15s - loss: 3.1935 - accuracy100: 0.4230 - val_loss: 3.2967 - val_accuracy100: 0.3573 - 15s/epoch - 26ms/step
Epoch 20/50
589/589 - 16s - loss: 3.1897 - accuracy100: 0.4248 - val_loss: 3.3021 - val_accuracy100: 0.3608 - 16s/epoch - 27ms/step
Epoch 21/50
589/589 - 15s - loss: 3.1864 - accuracy100: 0.4263 - val_loss: 3.2988 - val_accuracy100: 0.3603 - 15s/epoch - 26ms/step
Epoch 22/50
589/589 - 15s - loss: 3.1835 - accuracy100: 0.4275 - val_loss: 3.3024 - val_accuracy100: 0.3593 - 15s/epoch - 25ms/step
Epoch 23/50
589/589 - 14s - loss: 3.1791 - accuracy100: 0.4305 - val_loss: 3.3060 - val_accuracy100: 0.3594 - 14s/epoch - 24ms/step
Epoch 24/50
589/589 - 15s - loss: 3.1738 - accuracy100: 0.4312 - val_loss: 3.3091 - val_accuracy100: 0.3607 - 15s/epoch - 25ms/step
testing model: results/QRTEA/W0/deepOF_L1/h100
Evaluating performance on  test set...
2359/2359 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0734466
{'0': {'precision': 0.4917257005191155, 'recall': 0.1969421981253446, 'f1-score': 0.2812430796486307, 'support': 174112}, '1': {'precision': 0.4091372745043057, 'recall': 0.8554264982029212, 'f1-score': 0.5535297998680448, 'support': 235382}, '2': {'precision': 0.44673236143255945, 'recall': 0.09636675262109538, 'f1-score': 0.15853513971210836, 'support': 194289}, 'accuracy': 0.42128546182982957, 'macro avg': {'precision': 0.44919844548532684, 'recall': 0.3829118163164537, 'f1-score': 0.33110267307626134, 'support': 603783}, 'weighted avg': {'precision': 0.4450507531456289, 'recall': 0.42128546182982957, 'f1-score': 0.34790707952335254, 'support': 603783}}
[[ 34290 131332   8490]
 [ 19332 201352  14698]
 [ 16112 159454  18723]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0841955
{'0': {'precision': 0.4543585526315789, 'recall': 0.2211548083658561, 'f1-score': 0.2975028606044288, 'support': 49965}, '1': {'precision': 0.364805739494352, 'recall': 0.7800720567156084, 'f1-score': 0.49712688018071954, 'support': 51626}, '2': {'precision': 0.46670001876055284, 'recall': 0.15195569401176878, 'f1-score': 0.22926394691570415, 'support': 49113}, 'accuracy': 0.39006927486994375, 'macro avg': {'precision': 0.42862143696216126, 'recall': 0.38439418636441114, 'f1-score': 0.34129789590028414, 'support': 150704}, 'weighted avg': {'precision': 0.4277028095522301, 'recall': 0.39006927486994375, 'f1-score': 0.3436487616200041, 'support': 150704}}
[[11050 34952  3963]
 [ 6789 40272  4565]
 [ 6481 35169  7463]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0938555
{'0': {'precision': 0.4684663986214819, 'recall': 0.20659607882871472, 'f1-score': 0.28673885529461396, 'support': 19739}, '1': {'precision': 0.32183671603583835, 'recall': 0.7689493228484054, 'f1-score': 0.4537574117040474, 'support': 18312}, '2': {'precision': 0.4640050298648224, 'recall': 0.1421417565485362, 'f1-score': 0.21761887209730923, 'support': 20768}, 'accuracy': 0.3589146364270049, 'macro avg': {'precision': 0.4181027148407142, 'recall': 0.37256238607521874, 'f1-score': 0.3193717130319902, 'support': 58819}, 'weighted avg': {'precision': 0.4212412425690735, 'recall': 0.3589146364270049, 'f1-score': 0.31433129980961627, 'support': 58819}}
[[ 4078 14130  1531]
 [ 2352 14081  1879]
 [ 2275 15541  2952]]
training model: results/QRTEA/W0/deepOF_L1/h200
Epoch 1/50
589/589 - 17s - loss: 3.3203 - accuracy200: 0.3554 - val_loss: 3.3609 - val_accuracy200: 0.3062 - 17s/epoch - 28ms/step
Epoch 2/50
589/589 - 15s - loss: 3.2902 - accuracy200: 0.3689 - val_loss: 3.3657 - val_accuracy200: 0.3043 - 15s/epoch - 25ms/step
Epoch 3/50
589/589 - 14s - loss: 3.2825 - accuracy200: 0.3721 - val_loss: 3.3610 - val_accuracy200: 0.3052 - 14s/epoch - 24ms/step
Epoch 4/50
589/589 - 15s - loss: 3.2757 - accuracy200: 0.3763 - val_loss: 3.3601 - val_accuracy200: 0.3052 - 15s/epoch - 25ms/step
Epoch 5/50
589/589 - 15s - loss: 3.2727 - accuracy200: 0.3785 - val_loss: 3.3613 - val_accuracy200: 0.3056 - 15s/epoch - 25ms/step
Epoch 6/50
589/589 - 14s - loss: 3.2692 - accuracy200: 0.3798 - val_loss: 3.3585 - val_accuracy200: 0.3072 - 14s/epoch - 24ms/step
Epoch 7/50
589/589 - 15s - loss: 3.2671 - accuracy200: 0.3800 - val_loss: 3.3582 - val_accuracy200: 0.3075 - 15s/epoch - 25ms/step
Epoch 8/50
589/589 - 15s - loss: 3.2650 - accuracy200: 0.3817 - val_loss: 3.3601 - val_accuracy200: 0.3079 - 15s/epoch - 26ms/step
Epoch 9/50
589/589 - 15s - loss: 3.2638 - accuracy200: 0.3824 - val_loss: 3.3549 - val_accuracy200: 0.3093 - 15s/epoch - 26ms/step
Epoch 10/50
589/589 - 15s - loss: 3.2617 - accuracy200: 0.3842 - val_loss: 3.3534 - val_accuracy200: 0.3102 - 15s/epoch - 26ms/step
Epoch 11/50
589/589 - 15s - loss: 3.2598 - accuracy200: 0.3834 - val_loss: 3.3510 - val_accuracy200: 0.3111 - 15s/epoch - 25ms/step
Epoch 12/50
589/589 - 15s - loss: 3.2577 - accuracy200: 0.3855 - val_loss: 3.3516 - val_accuracy200: 0.3121 - 15s/epoch - 25ms/step
Epoch 13/50
589/589 - 15s - loss: 3.2554 - accuracy200: 0.3872 - val_loss: 3.3549 - val_accuracy200: 0.3125 - 15s/epoch - 25ms/step
Epoch 14/50
589/589 - 13s - loss: 3.2538 - accuracy200: 0.3895 - val_loss: 3.3556 - val_accuracy200: 0.3140 - 13s/epoch - 23ms/step
Epoch 15/50
589/589 - 14s - loss: 3.2532 - accuracy200: 0.3895 - val_loss: 3.3556 - val_accuracy200: 0.3130 - 14s/epoch - 23ms/step
Epoch 16/50
589/589 - 15s - loss: 3.2509 - accuracy200: 0.3889 - val_loss: 3.3562 - val_accuracy200: 0.3148 - 15s/epoch - 25ms/step
Epoch 17/50
589/589 - 14s - loss: 3.2484 - accuracy200: 0.3912 - val_loss: 3.3542 - val_accuracy200: 0.3151 - 14s/epoch - 25ms/step
Epoch 18/50
589/589 - 15s - loss: 3.2466 - accuracy200: 0.3939 - val_loss: 3.3559 - val_accuracy200: 0.3163 - 15s/epoch - 25ms/step
Epoch 19/50
589/589 - 15s - loss: 3.2469 - accuracy200: 0.3922 - val_loss: 3.3593 - val_accuracy200: 0.3143 - 15s/epoch - 25ms/step
Epoch 20/50
589/589 - 14s - loss: 3.2441 - accuracy200: 0.3944 - val_loss: 3.3652 - val_accuracy200: 0.3156 - 14s/epoch - 24ms/step
Epoch 21/50
589/589 - 15s - loss: 3.2422 - accuracy200: 0.3937 - val_loss: 3.3619 - val_accuracy200: 0.3159 - 15s/epoch - 26ms/step
testing model: results/QRTEA/W0/deepOF_L1/h200
Evaluating performance on  test set...
2359/2359 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955113
{'0': {'precision': 0.46727060198714204, 'recall': 0.0732759361413277, 'f1-score': 0.12668545028695363, 'support': 174573}, '1': {'precision': 0.3681455611151326, 'recall': 0.9417502410365926, 'f1-score': 0.5293568699849446, 'support': 221958}, '2': {'precision': 0.3974239962868415, 'recall': 0.016525775384556, 'f1-score': 0.031732060962616396, 'support': 207252}, 'accuracy': 0.3730578701288377, 'macro avg': {'precision': 0.41094671979637204, 'recall': 0.3438506508541588, 'f1-score': 0.22925812707817153, 'support': 603783}, 'weighted avg': {'precision': 0.4068557765507383, 'recall': 0.3730578701288377, 'f1-score': 0.2421190798013307, 'support': 603783}}
[[ 12792 159840   1941]
 [  9677 209029   3252]
 [  4907 198920   3425]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1058975
{'0': {'precision': 0.4540697131109242, 'recall': 0.09570047072262818, 'f1-score': 0.15808309203891077, 'support': 50773}, '1': {'precision': 0.33457032246775686, 'recall': 0.9184980585244786, 'f1-score': 0.49047952416325097, 'support': 49962}, '2': {'precision': 0.4732582688247713, 'recall': 0.026916688346775002, 'f1-score': 0.05093635795572893, 'support': 49969}, 'accuracy': 0.3456709841809109, 'macro avg': {'precision': 0.42063276813448414, 'recall': 0.34703840586462725, 'f1-score': 0.23316632471929688, 'support': 150704}, 'weighted avg': {'precision': 0.4208151504261335, 'recall': 0.3456709841809109, 'f1-score': 0.2327538067272652, 'support': 150704}}
[[ 4859 45235   679]
 [ 3254 45890   818]
 [ 2588 46036  1345]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1177188
{'0': {'precision': 0.4805419429230326, 'recall': 0.08456348602445087, 'f1-score': 0.14381847985505994, 'support': 19713}, '1': {'precision': 0.2970403454474694, 'recall': 0.9212553167030694, 'f1-score': 0.4492341326008661, 'support': 17398}, '2': {'precision': 0.47951114306254494, 'recall': 0.030725999631472267, 'f1-score': 0.05775141781029481, 'support': 21708}, 'accuracy': 0.31217803770890357, 'macro avg': {'precision': 0.41903114381101564, 'recall': 0.3455149341196642, 'f1-score': 0.21693467675540692, 'support': 58819}, 'weighted avg': {'precision': 0.4258837985096404, 'recall': 0.31217803770890357, 'f1-score': 0.2023927117121771, 'support': 58819}}
[[ 1667 17745   301]
 [  947 16028   423]
 [  855 20186   667]]
training model: results/QRTEA/W0/deepOF_L1/h300
Epoch 1/50
589/589 - 17s - loss: 3.3276 - accuracy300: 0.3450 - val_loss: 3.3192 - val_accuracy300: 0.3453 - 17s/epoch - 29ms/step
Epoch 2/50
589/589 - 15s - loss: 3.3032 - accuracy300: 0.3529 - val_loss: 3.3155 - val_accuracy300: 0.3478 - 15s/epoch - 26ms/step
Epoch 3/50
589/589 - 15s - loss: 3.2948 - accuracy300: 0.3563 - val_loss: 3.3130 - val_accuracy300: 0.3440 - 15s/epoch - 25ms/step
Epoch 4/50
589/589 - 14s - loss: 3.2887 - accuracy300: 0.3589 - val_loss: 3.3105 - val_accuracy300: 0.3456 - 14s/epoch - 24ms/step
Epoch 5/50
589/589 - 14s - loss: 3.2850 - accuracy300: 0.3589 - val_loss: 3.3105 - val_accuracy300: 0.3428 - 14s/epoch - 24ms/step
Epoch 6/50
589/589 - 15s - loss: 3.2824 - accuracy300: 0.3614 - val_loss: 3.3107 - val_accuracy300: 0.3418 - 15s/epoch - 25ms/step
Epoch 7/50
589/589 - 15s - loss: 3.2804 - accuracy300: 0.3615 - val_loss: 3.3084 - val_accuracy300: 0.3417 - 15s/epoch - 25ms/step
Epoch 8/50
589/589 - 14s - loss: 3.2783 - accuracy300: 0.3640 - val_loss: 3.3093 - val_accuracy300: 0.3425 - 14s/epoch - 25ms/step
Epoch 9/50
589/589 - 15s - loss: 3.2765 - accuracy300: 0.3656 - val_loss: 3.3085 - val_accuracy300: 0.3463 - 15s/epoch - 25ms/step
Epoch 10/50
589/589 - 15s - loss: 3.2754 - accuracy300: 0.3659 - val_loss: 3.3084 - val_accuracy300: 0.3452 - 15s/epoch - 26ms/step
Epoch 11/50
589/589 - 15s - loss: 3.2736 - accuracy300: 0.3672 - val_loss: 3.3067 - val_accuracy300: 0.3491 - 15s/epoch - 25ms/step
Epoch 12/50
589/589 - 16s - loss: 3.2708 - accuracy300: 0.3703 - val_loss: 3.3071 - val_accuracy300: 0.3453 - 16s/epoch - 27ms/step
Epoch 13/50
589/589 - 16s - loss: 3.2704 - accuracy300: 0.3701 - val_loss: 3.3070 - val_accuracy300: 0.3470 - 16s/epoch - 26ms/step
Epoch 14/50
589/589 - 16s - loss: 3.2686 - accuracy300: 0.3717 - val_loss: 3.3096 - val_accuracy300: 0.3454 - 16s/epoch - 26ms/step
Epoch 15/50
589/589 - 15s - loss: 3.2672 - accuracy300: 0.3731 - val_loss: 3.3089 - val_accuracy300: 0.3471 - 15s/epoch - 25ms/step
Epoch 16/50
589/589 - 15s - loss: 3.2656 - accuracy300: 0.3732 - val_loss: 3.3111 - val_accuracy300: 0.3436 - 15s/epoch - 25ms/step
Epoch 17/50
589/589 - 15s - loss: 3.2637 - accuracy300: 0.3746 - val_loss: 3.3124 - val_accuracy300: 0.3458 - 15s/epoch - 25ms/step
Epoch 18/50
589/589 - 15s - loss: 3.2627 - accuracy300: 0.3767 - val_loss: 3.3118 - val_accuracy300: 0.3487 - 15s/epoch - 25ms/step
Epoch 19/50
589/589 - 14s - loss: 3.2610 - accuracy300: 0.3778 - val_loss: 3.3173 - val_accuracy300: 0.3453 - 14s/epoch - 24ms/step
Epoch 20/50
589/589 - 14s - loss: 3.2597 - accuracy300: 0.3794 - val_loss: 3.3176 - val_accuracy300: 0.3465 - 14s/epoch - 24ms/step
Epoch 21/50
589/589 - 14s - loss: 3.2578 - accuracy300: 0.3802 - val_loss: 3.3159 - val_accuracy300: 0.3464 - 14s/epoch - 24ms/step
testing model: results/QRTEA/W0/deepOF_L1/h300
Evaluating performance on  test set...
2359/2359 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988365
{'0': {'precision': 0.3234270831788957, 'recall': 0.6979667144814935, 'f1-score': 0.44202606112900045, 'support': 187529}, '1': {'precision': 0.3294123409222631, 'recall': 0.21062026347105367, 'f1-score': 0.25695083397272833, 'support': 191596}, '2': {'precision': 0.4168647011203092, 'recall': 0.14210933952941804, 'f1-score': 0.21196106810426102, 'support': 224658}, 'accuracy': 0.3364934090559025, 'macro avg': {'precision': 0.35656804174048934, 'recall': 0.3502321058273217, 'f1-score': 0.3036459877353299, 'support': 603783}, 'weighted avg': {'precision': 0.36009300423675966, 'recall': 0.3364934090559025, 'f1-score': 0.2976933879249105, 'support': 603783}}
[[130889  36305  20335]
 [126917  40354  24325]
 [146888  45844  31926]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0949466
{'0': {'precision': 0.3544163240176785, 'recall': 0.6348865605798015, 'f1-score': 0.45489437961251356, 'support': 50776}, '1': {'precision': 0.34366981892823106, 'recall': 0.2773198722246322, 'f1-score': 0.3069502493534271, 'support': 50714}, '2': {'precision': 0.38059820432449665, 'recall': 0.14556833421384158, 'f1-score': 0.21059129591251816, 'support': 49214}, 'accuracy': 0.3547682875039813, 'macro avg': {'precision': 0.3595614490901354, 'recall': 0.3525915890060918, 'f1-score': 0.32414530829281957, 'support': 150704}, 'weighted avg': {'precision': 0.3593499475334014, 'recall': 0.3547682875039813, 'f1-score': 0.32532933433719985, 'support': 150704}}
[[32237 13118  5421]
 [30412 14064  6238]
 [28309 13741  7164]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003052
{'0': {'precision': 0.3545345748562422, 'recall': 0.6169240146281999, 'f1-score': 0.4502938068845348, 'support': 19688}, '1': {'precision': 0.2985583064663301, 'recall': 0.2807940957720693, 'f1-score': 0.28940385635945515, 'support': 17479}, '2': {'precision': 0.41780568895456227, 'recall': 0.15670607796046554, 'f1-score': 0.22792462969804858, 'support': 21652}, 'accuracy': 0.3476257671840732, 'macro avg': {'precision': 0.3569661900923782, 'recall': 0.3514747294535782, 'f1-score': 0.32254076431401285, 'support': 58819}, 'weighted avg': {'precision': 0.3611912158611819, 'recall': 0.3476257671840732, 'f1-score': 0.3206259636762235, 'support': 58819}}
[[12146  5248  2294]
 [10137  4908  2434]
 [11976  6283  3393]]
training model: results/QRTEA/W0/deepOF_L1/h500
Epoch 1/50
589/589 - 16s - loss: 3.3330 - accuracy500: 0.3402 - val_loss: 3.3307 - val_accuracy500: 0.3337 - 16s/epoch - 28ms/step
Epoch 2/50
589/589 - 14s - loss: 3.3092 - accuracy500: 0.3455 - val_loss: 3.3258 - val_accuracy500: 0.3323 - 14s/epoch - 24ms/step
Epoch 3/50
589/589 - 14s - loss: 3.3012 - accuracy500: 0.3481 - val_loss: 3.3185 - val_accuracy500: 0.3373 - 14s/epoch - 24ms/step
Epoch 4/50
589/589 - 15s - loss: 3.2967 - accuracy500: 0.3493 - val_loss: 3.3136 - val_accuracy500: 0.3329 - 15s/epoch - 25ms/step
Epoch 5/50
589/589 - 15s - loss: 3.2917 - accuracy500: 0.3537 - val_loss: 3.3135 - val_accuracy500: 0.3313 - 15s/epoch - 25ms/step
Epoch 6/50
589/589 - 15s - loss: 3.2893 - accuracy500: 0.3546 - val_loss: 3.3109 - val_accuracy500: 0.3299 - 15s/epoch - 25ms/step
Epoch 7/50
589/589 - 14s - loss: 3.2875 - accuracy500: 0.3563 - val_loss: 3.3105 - val_accuracy500: 0.3300 - 14s/epoch - 25ms/step
Epoch 8/50
589/589 - 15s - loss: 3.2861 - accuracy500: 0.3573 - val_loss: 3.3097 - val_accuracy500: 0.3323 - 15s/epoch - 26ms/step
Epoch 9/50
589/589 - 15s - loss: 3.2842 - accuracy500: 0.3590 - val_loss: 3.3071 - val_accuracy500: 0.3343 - 15s/epoch - 26ms/step
Epoch 10/50
589/589 - 15s - loss: 3.2829 - accuracy500: 0.3615 - val_loss: 3.3084 - val_accuracy500: 0.3362 - 15s/epoch - 26ms/step
Epoch 11/50
589/589 - 16s - loss: 3.2814 - accuracy500: 0.3623 - val_loss: 3.3065 - val_accuracy500: 0.3340 - 16s/epoch - 27ms/step
Epoch 12/50
589/589 - 15s - loss: 3.2800 - accuracy500: 0.3637 - val_loss: 3.3053 - val_accuracy500: 0.3331 - 15s/epoch - 26ms/step
Epoch 13/50
589/589 - 16s - loss: 3.2791 - accuracy500: 0.3650 - val_loss: 3.3085 - val_accuracy500: 0.3331 - 16s/epoch - 27ms/step
Epoch 14/50
589/589 - 16s - loss: 3.2771 - accuracy500: 0.3668 - val_loss: 3.3108 - val_accuracy500: 0.3333 - 16s/epoch - 26ms/step
Epoch 15/50
589/589 - 14s - loss: 3.2765 - accuracy500: 0.3679 - val_loss: 3.3087 - val_accuracy500: 0.3373 - 14s/epoch - 24ms/step
Epoch 16/50
589/589 - 14s - loss: 3.2758 - accuracy500: 0.3678 - val_loss: 3.3076 - val_accuracy500: 0.3378 - 14s/epoch - 24ms/step
Epoch 17/50
589/589 - 15s - loss: 3.2741 - accuracy500: 0.3695 - val_loss: 3.3104 - val_accuracy500: 0.3340 - 15s/epoch - 25ms/step
Epoch 18/50
589/589 - 15s - loss: 3.2735 - accuracy500: 0.3701 - val_loss: 3.3093 - val_accuracy500: 0.3365 - 15s/epoch - 25ms/step
Epoch 19/50
589/589 - 15s - loss: 3.2724 - accuracy500: 0.3718 - val_loss: 3.3104 - val_accuracy500: 0.3378 - 15s/epoch - 25ms/step
Epoch 20/50
589/589 - 15s - loss: 3.2706 - accuracy500: 0.3725 - val_loss: 3.3115 - val_accuracy500: 0.3380 - 15s/epoch - 25ms/step
Epoch 21/50
589/589 - 15s - loss: 3.2702 - accuracy500: 0.3728 - val_loss: 3.3138 - val_accuracy500: 0.3355 - 15s/epoch - 25ms/step
Epoch 22/50
589/589 - 14s - loss: 3.2683 - accuracy500: 0.3765 - val_loss: 3.3141 - val_accuracy500: 0.3334 - 14s/epoch - 24ms/step
testing model: results/QRTEA/W0/deepOF_L1/h500
Evaluating performance on  test set...
2359/2359 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1019589
{'0': {'precision': 0.35365271367181284, 'recall': 0.5649907582173628, 'f1-score': 0.4350121041673726, 'support': 204506}, '1': {'precision': 0.2688348554792719, 'recall': 0.35929043714356707, 'f1-score': 0.30754944556124764, 'support': 165003}, '2': {'precision': 0.42589088336722963, 'recall': 0.10279416409844883, 'f1-score': 0.16561503890736165, 'support': 234274}, 'accuracy': 0.3294395503020125, 'macro avg': {'precision': 0.34945948417277145, 'recall': 0.34235845315312624, 'f1-score': 0.3027255295453273, 'support': 603783}, 'weighted avg': {'precision': 0.35850267452178747, 'recall': 0.3294395503020125, 'f1-score': 0.295650033481861, 'support': 603783}}
[[115544  71810  17152]
 [ 90408  59284  15311]
 [120764  89428  24082]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0972301
{'0': {'precision': 0.3668078172157767, 'recall': 0.6044286443658643, 'f1-score': 0.45655030566188654, 'support': 52883}, '1': {'precision': 0.3154213165130196, 'recall': 0.33067695307532535, 'f1-score': 0.32286902717132626, 'support': 47182}, '2': {'precision': 0.3798850982339173, 'recall': 0.10576828136416595, 'f1-score': 0.16546695912756032, 'support': 50639}, 'accuracy': 0.3511651980040344, 'macro avg': {'precision': 0.3540380773209045, 'recall': 0.34695795960178527, 'f1-score': 0.31496209732025776, 'support': 150704}, 'weighted avg': {'precision': 0.3551140503437636, 'recall': 0.3511651980040344, 'f1-score': 0.3168889850141708, 'support': 150704}}
[[31964 16494  4425]
 [27262 15602  4318]
 [27915 17368  5356]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1039006
{'0': {'precision': 0.35514801712902627, 'recall': 0.5681874596634067, 'f1-score': 0.4370906452290478, 'support': 20143}, '1': {'precision': 0.27700083419206045, 'recall': 0.3413763909046928, 'f1-score': 0.30583773533793857, 'support': 16536}, '2': {'precision': 0.40698422915996135, 'recall': 0.11422764227642276, 'f1-score': 0.17838752909642377, 'support': 22140}, 'accuracy': 0.33354868324861014, 'macro avg': {'precision': 0.3463776934936827, 'recall': 0.3412638309481741, 'f1-score': 0.3071053032211367, 'support': 58819}, 'weighted avg': {'precision': 0.35268983044307844, 'recall': 0.33354868324861014, 'f1-score': 0.3028128589842004, 'support': 58819}}
[[11445  6734  1964]
 [ 9170  5645  1721]
 [11611  8000  2529]]
training model: results/QRTEA/W0/deepOF_L1/h1000
Epoch 1/50
589/589 - 17s - loss: 3.3324 - accuracy1000: 0.3559 - val_loss: 3.4271 - val_accuracy1000: 0.3114 - 17s/epoch - 29ms/step
Epoch 2/50
589/589 - 14s - loss: 3.3087 - accuracy1000: 0.3622 - val_loss: 3.4149 - val_accuracy1000: 0.3108 - 14s/epoch - 24ms/step
Epoch 3/50
589/589 - 14s - loss: 3.2999 - accuracy1000: 0.3615 - val_loss: 3.4066 - val_accuracy1000: 0.3117 - 14s/epoch - 24ms/step
Epoch 4/50
589/589 - 14s - loss: 3.2945 - accuracy1000: 0.3621 - val_loss: 3.3963 - val_accuracy1000: 0.3118 - 14s/epoch - 24ms/step
Epoch 5/50
589/589 - 14s - loss: 3.2913 - accuracy1000: 0.3642 - val_loss: 3.3855 - val_accuracy1000: 0.3123 - 14s/epoch - 24ms/step
Epoch 6/50
589/589 - 14s - loss: 3.2895 - accuracy1000: 0.3655 - val_loss: 3.3666 - val_accuracy1000: 0.3112 - 14s/epoch - 23ms/step
Epoch 7/50
589/589 - 14s - loss: 3.2870 - accuracy1000: 0.3654 - val_loss: 3.3628 - val_accuracy1000: 0.3121 - 14s/epoch - 24ms/step
Epoch 8/50
589/589 - 14s - loss: 3.2857 - accuracy1000: 0.3676 - val_loss: 3.3610 - val_accuracy1000: 0.3118 - 14s/epoch - 24ms/step
Epoch 9/50
589/589 - 15s - loss: 3.2845 - accuracy1000: 0.3679 - val_loss: 3.3541 - val_accuracy1000: 0.3117 - 15s/epoch - 26ms/step
Epoch 10/50
589/589 - 14s - loss: 3.2842 - accuracy1000: 0.3684 - val_loss: 3.3526 - val_accuracy1000: 0.3123 - 14s/epoch - 24ms/step
Epoch 11/50
589/589 - 14s - loss: 3.2834 - accuracy1000: 0.3681 - val_loss: 3.3515 - val_accuracy1000: 0.3116 - 14s/epoch - 24ms/step
Epoch 12/50
589/589 - 15s - loss: 3.2810 - accuracy1000: 0.3691 - val_loss: 3.3520 - val_accuracy1000: 0.3120 - 15s/epoch - 25ms/step
Epoch 13/50
589/589 - 15s - loss: 3.2807 - accuracy1000: 0.3703 - val_loss: 3.3516 - val_accuracy1000: 0.3125 - 15s/epoch - 25ms/step
Epoch 14/50
589/589 - 15s - loss: 3.2790 - accuracy1000: 0.3707 - val_loss: 3.3512 - val_accuracy1000: 0.3124 - 15s/epoch - 25ms/step
Epoch 15/50
589/589 - 15s - loss: 3.2782 - accuracy1000: 0.3710 - val_loss: 3.3556 - val_accuracy1000: 0.3124 - 15s/epoch - 25ms/step
Epoch 16/50
589/589 - 15s - loss: 3.2777 - accuracy1000: 0.3711 - val_loss: 3.3547 - val_accuracy1000: 0.3115 - 15s/epoch - 25ms/step
Epoch 17/50
589/589 - 14s - loss: 3.2765 - accuracy1000: 0.3715 - val_loss: 3.3561 - val_accuracy1000: 0.3131 - 14s/epoch - 25ms/step
Epoch 18/50
589/589 - 14s - loss: 3.2761 - accuracy1000: 0.3728 - val_loss: 3.3546 - val_accuracy1000: 0.3115 - 14s/epoch - 23ms/step
Epoch 19/50
589/589 - 14s - loss: 3.2752 - accuracy1000: 0.3736 - val_loss: 3.3573 - val_accuracy1000: 0.3130 - 14s/epoch - 24ms/step
Epoch 20/50
589/589 - 14s - loss: 3.2736 - accuracy1000: 0.3738 - val_loss: 3.3572 - val_accuracy1000: 0.3142 - 14s/epoch - 23ms/step
Epoch 21/50
589/589 - 13s - loss: 3.2726 - accuracy1000: 0.3770 - val_loss: 3.3626 - val_accuracy1000: 0.3137 - 13s/epoch - 23ms/step
Epoch 22/50
589/589 - 14s - loss: 3.2718 - accuracy1000: 0.3755 - val_loss: 3.3629 - val_accuracy1000: 0.3125 - 14s/epoch - 24ms/step
Epoch 23/50
589/589 - 14s - loss: 3.2708 - accuracy1000: 0.3765 - val_loss: 3.3633 - val_accuracy1000: 0.3136 - 14s/epoch - 24ms/step
Epoch 24/50
589/589 - 14s - loss: 3.2692 - accuracy1000: 0.3791 - val_loss: 3.3637 - val_accuracy1000: 0.3162 - 14s/epoch - 24ms/step
testing model: results/QRTEA/W0/deepOF_L1/h1000
Evaluating performance on  test set...
2359/2359 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982376
{'0': {'precision': 0.36897448015122875, 'recall': 0.034198610373468975, 'f1-score': 0.06259551929928295, 'support': 182639}, '1': {'precision': 0.375401927884854, 'recall': 0.9684873207600481, 'f1-score': 0.5410743596795098, 'support': 226512}, '2': {'precision': 0.32407407407407407, 'recall': 0.004136010522421801, 'f1-score': 0.00816777937863999, 'support': 194632}, 'accuracy': 0.3750105584291045, 'macro avg': {'precision': 0.3561501607033856, 'recall': 0.3356073138853129, 'f1-score': 0.20394588611914424, 'support': 603783}, 'weighted avg': {'precision': 0.35691193152934, 'recall': 0.3750105584291045, 'f1-score': 0.2245540693345959, 'support': 603783}}
[[  6246 175583    810]
 [  6269 219374    869]
 [  4413 189414    805]]
Evaluating performance on  train set...
589/589 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030647
{'0': {'precision': 0.39715267550319094, 'recall': 0.031363883073583, 'f1-score': 0.0581366102547519, 'support': 51588}, '1': {'precision': 0.3349555490057646, 'recall': 0.965579244798356, 'f1-score': 0.4973740458015267, 'support': 50609}, '2': {'precision': 0.3870094722598105, 'recall': 0.0058960562393056675, 'f1-score': 0.01161515656093896, 'support': 48507}, 'accuracy': 0.3368921860070071, 'macro avg': {'precision': 0.3730392322562553, 'recall': 0.3342797280370815, 'f1-score': 0.1890419375390725, 'support': 150704}, 'weighted avg': {'precision': 0.37300102236435656, 'recall': 0.3368921860070071, 'f1-score': 0.19066627915047424, 'support': 150704}}
[[ 1618 49756   214]
 [ 1503 48867   239]
 [  953 47268   286]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1132975
{'0': {'precision': 0.3529044347282948, 'recall': 0.02866710639809224, 'f1-score': 0.053026748005631154, 'support': 19709}, '1': {'precision': 0.3105100872169853, 'recall': 0.9603291373767097, 'f1-score': 0.46928341277660907, 'support': 18351}, '2': {'precision': 0.3326133909287257, 'recall': 0.007418469097740739, 'f1-score': 0.0145132409763453, 'support': 20759}, 'accuracy': 0.31183801152688756, 'macro avg': {'precision': 0.33200930429133524, 'recall': 0.3321382376241809, 'f1-score': 0.1789411339195285, 'support': 58819}, 'weighted avg': {'precision': 0.3325164572139662, 'recall': 0.31183801152688756, 'f1-score': 0.16930251200691085, 'support': 58819}}
[[  565 19008   136]
 [  555 17623   173]
 [  481 20124   154]]
training model: results/QRTEA/W0/deepLOB_L2/h10
Epoch 1/50
589/589 - 32s - loss: 3.2114 - accuracy10: 0.4082 - val_loss: 3.3058 - val_accuracy10: 0.4850 - 32s/epoch - 54ms/step
Epoch 2/50
589/589 - 29s - loss: 2.9334 - accuracy10: 0.4428 - val_loss: 3.3289 - val_accuracy10: 0.4478 - 29s/epoch - 48ms/step
Epoch 3/50
589/589 - 28s - loss: 2.8249 - accuracy10: 0.4739 - val_loss: 3.3278 - val_accuracy10: 0.5509 - 28s/epoch - 48ms/step
Epoch 4/50
589/589 - 29s - loss: 2.7752 - accuracy10: 0.4924 - val_loss: 3.1755 - val_accuracy10: 0.5866 - 29s/epoch - 50ms/step
Epoch 5/50
589/589 - 30s - loss: 2.7203 - accuracy10: 0.5132 - val_loss: 3.0521 - val_accuracy10: 0.6184 - 30s/epoch - 51ms/step
Epoch 6/50
589/589 - 29s - loss: 2.6725 - accuracy10: 0.5343 - val_loss: 2.9028 - val_accuracy10: 0.6169 - 29s/epoch - 49ms/step
Epoch 7/50
589/589 - 29s - loss: 2.6298 - accuracy10: 0.5501 - val_loss: 2.8884 - val_accuracy10: 0.6209 - 29s/epoch - 48ms/step
Epoch 8/50
589/589 - 29s - loss: 2.5906 - accuracy10: 0.5640 - val_loss: 2.8659 - val_accuracy10: 0.6273 - 29s/epoch - 49ms/step
Epoch 9/50
589/589 - 29s - loss: 2.5485 - accuracy10: 0.5790 - val_loss: 2.8266 - val_accuracy10: 0.6314 - 29s/epoch - 49ms/step
Epoch 10/50
589/589 - 29s - loss: 2.5114 - accuracy10: 0.5928 - val_loss: 2.8200 - val_accuracy10: 0.6402 - 29s/epoch - 49ms/step
Epoch 11/50
589/589 - 29s - loss: 2.4784 - accuracy10: 0.6041 - val_loss: 2.8225 - val_accuracy10: 0.6383 - 29s/epoch - 49ms/step
Epoch 12/50
589/589 - 29s - loss: 2.4484 - accuracy10: 0.6094 - val_loss: 2.7696 - val_accuracy10: 0.6346 - 29s/epoch - 49ms/step
Epoch 13/50
589/589 - 29s - loss: 2.4243 - accuracy10: 0.6142 - val_loss: 2.7224 - val_accuracy10: 0.6338 - 29s/epoch - 49ms/step
Epoch 14/50
589/589 - 28s - loss: 2.4023 - accuracy10: 0.6197 - val_loss: 2.7186 - val_accuracy10: 0.6313 - 28s/epoch - 48ms/step
Epoch 15/50
589/589 - 29s - loss: 2.3814 - accuracy10: 0.6216 - val_loss: 2.8031 - val_accuracy10: 0.6435 - 29s/epoch - 49ms/step
Epoch 16/50
589/589 - 29s - loss: 2.3617 - accuracy10: 0.6258 - val_loss: 2.7721 - val_accuracy10: 0.6439 - 29s/epoch - 50ms/step
Epoch 17/50
589/589 - 29s - loss: 2.3420 - accuracy10: 0.6263 - val_loss: 2.8158 - val_accuracy10: 0.6370 - 29s/epoch - 49ms/step
Epoch 18/50
589/589 - 29s - loss: 2.3264 - accuracy10: 0.6297 - val_loss: 2.7768 - val_accuracy10: 0.6122 - 29s/epoch - 49ms/step
Epoch 19/50
589/589 - 29s - loss: 2.3086 - accuracy10: 0.6298 - val_loss: 2.7537 - val_accuracy10: 0.6152 - 29s/epoch - 49ms/step
Epoch 20/50
589/589 - 29s - loss: 2.2877 - accuracy10: 0.6333 - val_loss: 2.7562 - val_accuracy10: 0.6198 - 29s/epoch - 49ms/step
Epoch 21/50
589/589 - 29s - loss: 2.2738 - accuracy10: 0.6343 - val_loss: 2.7779 - val_accuracy10: 0.6184 - 29s/epoch - 49ms/step
Epoch 22/50
589/589 - 29s - loss: 2.2582 - accuracy10: 0.6370 - val_loss: 2.7828 - val_accuracy10: 0.6138 - 29s/epoch - 49ms/step
Epoch 23/50
589/589 - 29s - loss: 2.2404 - accuracy10: 0.6379 - val_loss: 2.8117 - val_accuracy10: 0.6181 - 29s/epoch - 49ms/step
Epoch 24/50
589/589 - 29s - loss: 2.2238 - accuracy10: 0.6399 - val_loss: 2.7896 - val_accuracy10: 0.6168 - 29s/epoch - 49ms/step
testing model: results/QRTEA/W0/deepLOB_L2/h10
Evaluating performance on  test set...
2359/2359 - 42s - 42s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7641548
{'0': {'precision': 0.33200966502217705, 'recall': 0.6001386928804321, 'f1-score': 0.4275110173200505, 'support': 82196}, '1': {'precision': 0.883034864866482, 'recall': 0.6734975140157488, 'f1-score': 0.7641624348397904, 'support': 438257}, '2': {'precision': 0.36336803115362676, 'recall': 0.527377452450951, 'f1-score': 0.4302735407569854, 'support': 83335}, 'accuracy': 0.6433433589273057, 'macro avg': {'precision': 0.5261375203474286, 'recall': 0.600337886449044, 'f1-score': 0.540648997638942, 'support': 603788}, 'weighted avg': {'precision': 0.7362970977795852, 'recall': 0.6433433589273057, 'f1-score': 0.6722493280823804, 'support': 603788}}
[[ 49329  19565  13302]
 [ 79394 295165  63698]
 [ 19854  19532  43949]]
Evaluating performance on  train set...
589/589 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7898912
{'0': {'precision': 0.3640230621396541, 'recall': 0.6077433155080214, 'f1-score': 0.4553205128205128, 'support': 23375}, '1': {'precision': 0.8571684633702916, 'recall': 0.6423171386906132, 'f1-score': 0.7343504919435334, 'support': 104232}, '2': {'precision': 0.3887829868350509, 'recall': 0.5651138626720928, 'f1-score': 0.46065076228119706, 'support': 23098}, 'accuracy': 0.6251219269433662, 'macro avg': {'precision': 0.5366581707816656, 'recall': 0.6050581056235759, 'f1-score': 0.5501072556817478, 'support': 150705}, 'weighted avg': {'precision': 0.7088917539659776, 'recall': 0.6251219269433662, 'f1-score': 0.649122781398155, 'support': 150705}}
[[14206  5549  3620]
 [20381 66950 16901]
 [ 4438  5607 13053]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7887322
{'0': {'precision': 0.375786719468213, 'recall': 0.5622090562843842, 'f1-score': 0.4504725978044335, 'support': 9452}, '1': {'precision': 0.8351284692953701, 'recall': 0.6692017111550297, 'f1-score': 0.7430142769846119, 'support': 39973}, '2': {'precision': 0.3968216318785579, 'recall': 0.5342203299627462, 'f1-score': 0.4553826611622737, 'support': 9395}, 'accuracy': 0.6304488269296158, 'macro avg': {'precision': 0.5359122735473804, 'recall': 0.5885436991340534, 'f1-score': 0.5496231786504396, 'support': 58820}, 'weighted avg': {'precision': 0.691306793727583, 'recall': 0.6304488269296158, 'f1-score': 0.6500628492004923, 'support': 58820}}
[[ 5314  2666  1472]
 [ 7066 26750  6157]
 [ 1761  2615  5019]]
training model: results/QRTEA/W0/deepLOB_L2/h20
Epoch 1/50
589/589 - 31s - loss: 3.2007 - accuracy20: 0.4068 - val_loss: 3.3112 - val_accuracy20: 0.4515 - 31s/epoch - 53ms/step
Epoch 2/50
589/589 - 29s - loss: 2.9906 - accuracy20: 0.4489 - val_loss: 3.1770 - val_accuracy20: 0.4605 - 29s/epoch - 50ms/step
Epoch 3/50
589/589 - 29s - loss: 2.8973 - accuracy20: 0.4790 - val_loss: 3.1327 - val_accuracy20: 0.4987 - 29s/epoch - 50ms/step
Epoch 4/50
589/589 - 29s - loss: 2.8478 - accuracy20: 0.4983 - val_loss: 3.0624 - val_accuracy20: 0.5198 - 29s/epoch - 50ms/step
Epoch 5/50
589/589 - 29s - loss: 2.8027 - accuracy20: 0.5161 - val_loss: 3.1089 - val_accuracy20: 0.5132 - 29s/epoch - 49ms/step
Epoch 6/50
589/589 - 29s - loss: 2.7596 - accuracy20: 0.5306 - val_loss: 3.0743 - val_accuracy20: 0.5479 - 29s/epoch - 48ms/step
Epoch 7/50
589/589 - 29s - loss: 2.7208 - accuracy20: 0.5443 - val_loss: 3.0666 - val_accuracy20: 0.5543 - 29s/epoch - 49ms/step
Epoch 8/50
589/589 - 29s - loss: 2.6823 - accuracy20: 0.5601 - val_loss: 2.9631 - val_accuracy20: 0.5623 - 29s/epoch - 49ms/step
Epoch 9/50
589/589 - 29s - loss: 2.6409 - accuracy20: 0.5742 - val_loss: 2.9196 - val_accuracy20: 0.5685 - 29s/epoch - 49ms/step
Epoch 10/50
589/589 - 28s - loss: 2.6091 - accuracy20: 0.5838 - val_loss: 2.9542 - val_accuracy20: 0.5673 - 28s/epoch - 48ms/step
Epoch 11/50
589/589 - 29s - loss: 2.5790 - accuracy20: 0.5926 - val_loss: 2.9719 - val_accuracy20: 0.5556 - 29s/epoch - 49ms/step
Epoch 12/50
589/589 - 29s - loss: 2.5510 - accuracy20: 0.5993 - val_loss: 2.9491 - val_accuracy20: 0.5648 - 29s/epoch - 49ms/step
Epoch 13/50
589/589 - 29s - loss: 2.5248 - accuracy20: 0.6044 - val_loss: 2.9309 - val_accuracy20: 0.5747 - 29s/epoch - 50ms/step
Epoch 14/50
589/589 - 29s - loss: 2.5028 - accuracy20: 0.6097 - val_loss: 2.9208 - val_accuracy20: 0.5719 - 29s/epoch - 49ms/step
Epoch 15/50
589/589 - 29s - loss: 2.4790 - accuracy20: 0.6162 - val_loss: 2.9315 - val_accuracy20: 0.5591 - 29s/epoch - 49ms/step
Epoch 16/50
589/589 - 28s - loss: 2.4621 - accuracy20: 0.6195 - val_loss: 2.9019 - val_accuracy20: 0.5744 - 28s/epoch - 48ms/step
Epoch 17/50
589/589 - 29s - loss: 2.4434 - accuracy20: 0.6205 - val_loss: 2.9369 - val_accuracy20: 0.5724 - 29s/epoch - 48ms/step
Epoch 18/50
589/589 - 28s - loss: 2.4238 - accuracy20: 0.6243 - val_loss: 2.9127 - val_accuracy20: 0.5777 - 28s/epoch - 48ms/step
Epoch 19/50
589/589 - 29s - loss: 2.4084 - accuracy20: 0.6256 - val_loss: 2.9458 - val_accuracy20: 0.5640 - 29s/epoch - 49ms/step
Epoch 20/50
589/589 - 29s - loss: 2.3919 - accuracy20: 0.6290 - val_loss: 2.9711 - val_accuracy20: 0.5658 - 29s/epoch - 49ms/step
Epoch 21/50
589/589 - 30s - loss: 2.3748 - accuracy20: 0.6314 - val_loss: 2.9329 - val_accuracy20: 0.5629 - 30s/epoch - 50ms/step
Epoch 22/50
589/589 - 29s - loss: 2.3580 - accuracy20: 0.6335 - val_loss: 2.9241 - val_accuracy20: 0.5630 - 29s/epoch - 50ms/step
Epoch 23/50
589/589 - 29s - loss: 2.3454 - accuracy20: 0.6339 - val_loss: 2.9176 - val_accuracy20: 0.5702 - 29s/epoch - 49ms/step
Epoch 24/50
589/589 - 29s - loss: 2.3276 - accuracy20: 0.6365 - val_loss: 2.9613 - val_accuracy20: 0.5778 - 29s/epoch - 50ms/step
Epoch 25/50
589/589 - 30s - loss: 2.3153 - accuracy20: 0.6379 - val_loss: 2.9727 - val_accuracy20: 0.5690 - 30s/epoch - 51ms/step
Epoch 26/50
589/589 - 29s - loss: 2.3005 - accuracy20: 0.6408 - val_loss: 3.0377 - val_accuracy20: 0.5738 - 29s/epoch - 50ms/step
testing model: results/QRTEA/W0/deepLOB_L2/h20
Evaluating performance on  test set...
2359/2359 - 44s - 44s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85636556
{'0': {'precision': 0.35111848560687076, 'recall': 0.6000188403749235, 'f1-score': 0.4430016587784853, 'support': 106155}, '1': {'precision': 0.8095850474337308, 'recall': 0.6181122803049386, 'f1-score': 0.7010091705678991, 'support': 389062}, '2': {'precision': 0.40097817067721964, 'recall': 0.4628952482707169, 'f1-score': 0.4297177938240412, 'support': 108571}, 'accuracy': 0.587020609882939, 'macro avg': {'precision': 0.5205605679059405, 'recall': 0.5603421229835264, 'f1-score': 0.5245762077234751, 'support': 603788}, 'weighted avg': {'precision': 0.6555055110947153, 'recall': 0.587020609882939, 'f1-score': 0.6068649287504687, 'support': 603788}}
[[ 63695  26178  16282]
 [ 89781 240484  58797]
 [ 27930  30384  50257]]
Evaluating performance on  train set...
589/589 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85099405
{'0': {'precision': 0.4243376853847129, 'recall': 0.5493812977976171, 'f1-score': 0.4788305298089026, 'support': 30467}, '1': {'precision': 0.7723607137992099, 'recall': 0.6280210894752, 'f1-score': 0.6927522420154925, 'support': 90282}, '2': {'precision': 0.43033025099075295, 'recall': 0.5437308051809321, 'f1-score': 0.480429460519718, 'support': 29956}, 'accuracy': 0.5953684350220629, 'macro avg': {'precision': 0.5423428833915586, 'recall': 0.5737110641512498, 'f1-score': 0.5506707441147043, 'support': 150705}, 'weighted avg': {'precision': 0.6340170480243874, 'recall': 0.5953684350220629, 'f1-score': 0.6073012347610179, 'support': 150705}}
[[16738  8657  5072]
 [17093 56699 16490]
 [ 5614  8054 16288]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8799187
{'0': {'precision': 0.42625607779578606, 'recall': 0.4729829150658056, 'f1-score': 0.4484054713837331, 'support': 12233}, '1': {'precision': 0.7375852496658556, 'recall': 0.6270796305468955, 'f1-score': 0.6778582677165356, 'support': 34321}, '2': {'precision': 0.4171282753469845, 'recall': 0.5463883906734062, 'f1-score': 0.4730879186813962, 'support': 12266}, 'accuracy': 0.5782046922815369, 'macro avg': {'precision': 0.5269898676028754, 'recall': 0.5488169787620357, 'f1-score': 0.533117219260555, 'support': 58820}, 'weighted avg': {'precision': 0.6060107000826895, 'recall': 0.5782046922815369, 'f1-score': 0.5874364867100039, 'support': 58820}}
[[ 5786  4209  2238]
 [ 5672 21522  7127]
 [ 2116  3448  6702]]
training model: results/QRTEA/W0/deepLOB_L2/h30
Epoch 1/50
589/589 - 32s - loss: 3.2073 - accuracy30: 0.4146 - val_loss: 3.2858 - val_accuracy30: 0.4079 - 32s/epoch - 54ms/step
Epoch 2/50
589/589 - 30s - loss: 3.0140 - accuracy30: 0.4644 - val_loss: 3.2198 - val_accuracy30: 0.4379 - 30s/epoch - 50ms/step
Epoch 3/50
589/589 - 29s - loss: 2.9507 - accuracy30: 0.4837 - val_loss: 3.2652 - val_accuracy30: 0.4394 - 29s/epoch - 50ms/step
Epoch 4/50
589/589 - 30s - loss: 2.8952 - accuracy30: 0.5008 - val_loss: 3.1514 - val_accuracy30: 0.4701 - 30s/epoch - 51ms/step
Epoch 5/50
589/589 - 30s - loss: 2.8533 - accuracy30: 0.5180 - val_loss: 3.1644 - val_accuracy30: 0.4856 - 30s/epoch - 51ms/step
Epoch 6/50
589/589 - 30s - loss: 2.8075 - accuracy30: 0.5337 - val_loss: 3.0353 - val_accuracy30: 0.5117 - 30s/epoch - 50ms/step
Epoch 7/50
589/589 - 30s - loss: 2.7680 - accuracy30: 0.5462 - val_loss: 3.0812 - val_accuracy30: 0.5314 - 30s/epoch - 50ms/step
Epoch 8/50
589/589 - 30s - loss: 2.7387 - accuracy30: 0.5555 - val_loss: 3.0853 - val_accuracy30: 0.5380 - 30s/epoch - 51ms/step
Epoch 9/50
589/589 - 29s - loss: 2.7039 - accuracy30: 0.5646 - val_loss: 3.0809 - val_accuracy30: 0.5455 - 29s/epoch - 50ms/step
Epoch 10/50
589/589 - 30s - loss: 2.6735 - accuracy30: 0.5735 - val_loss: 3.0150 - val_accuracy30: 0.5477 - 30s/epoch - 50ms/step
Epoch 11/50
589/589 - 29s - loss: 2.6507 - accuracy30: 0.5795 - val_loss: 3.0288 - val_accuracy30: 0.5551 - 29s/epoch - 50ms/step
Epoch 12/50
589/589 - 29s - loss: 2.6274 - accuracy30: 0.5849 - val_loss: 3.0067 - val_accuracy30: 0.5524 - 29s/epoch - 50ms/step
Epoch 13/50
589/589 - 29s - loss: 2.6047 - accuracy30: 0.5896 - val_loss: 3.0282 - val_accuracy30: 0.5389 - 29s/epoch - 49ms/step
Epoch 14/50
589/589 - 29s - loss: 2.5838 - accuracy30: 0.5957 - val_loss: 3.0921 - val_accuracy30: 0.5511 - 29s/epoch - 49ms/step
Epoch 15/50
589/589 - 29s - loss: 2.5659 - accuracy30: 0.5989 - val_loss: 3.0285 - val_accuracy30: 0.5319 - 29s/epoch - 49ms/step
Epoch 16/50
589/589 - 30s - loss: 2.5452 - accuracy30: 0.6034 - val_loss: 3.0458 - val_accuracy30: 0.5495 - 30s/epoch - 50ms/step
Epoch 17/50
589/589 - 30s - loss: 2.5256 - accuracy30: 0.6056 - val_loss: 3.0696 - val_accuracy30: 0.5479 - 30s/epoch - 51ms/step
Epoch 18/50
589/589 - 30s - loss: 2.5085 - accuracy30: 0.6081 - val_loss: 3.0753 - val_accuracy30: 0.5442 - 30s/epoch - 50ms/step
Epoch 19/50
589/589 - 30s - loss: 2.4883 - accuracy30: 0.6100 - val_loss: 3.1249 - val_accuracy30: 0.5487 - 30s/epoch - 51ms/step
Epoch 20/50
589/589 - 30s - loss: 2.4739 - accuracy30: 0.6135 - val_loss: 3.1184 - val_accuracy30: 0.5365 - 30s/epoch - 51ms/step
Epoch 21/50
589/589 - 30s - loss: 2.4585 - accuracy30: 0.6150 - val_loss: 3.1630 - val_accuracy30: 0.5379 - 30s/epoch - 51ms/step
Epoch 22/50
589/589 - 29s - loss: 2.4412 - accuracy30: 0.6170 - val_loss: 3.2178 - val_accuracy30: 0.5329 - 29s/epoch - 49ms/step
testing model: results/QRTEA/W0/deepLOB_L2/h30
Evaluating performance on  test set...
2359/2359 - 42s - 42s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8904114
{'0': {'precision': 0.37435388996028124, 'recall': 0.5095075492656437, 'f1-score': 0.4315973625883435, 'support': 121535}, '1': {'precision': 0.7506740390558442, 'recall': 0.6306925357046618, 'f1-score': 0.6854726642880786, 'support': 356256}, '2': {'precision': 0.43727887242916724, 'recall': 0.4826146654285419, 'f1-score': 0.4588296102347797, 'support': 125997}, 'accuracy': 0.5753989810993263, 'macro avg': {'precision': 0.5207689338150975, 'recall': 0.5409382501329492, 'f1-score': 0.5252998790370673, 'support': 603788}, 'weighted avg': {'precision': 0.6095269474776899, 'recall': 0.5753989810993263, 'f1-score': 0.5870754128130066, 'support': 603788}}
[[ 61923  35654  23958]
 [ 77274 224688  54294]
 [ 26216  38973  60808]]
Evaluating performance on  train set...
589/589 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9004178
{'0': {'precision': 0.4396878606363686, 'recall': 0.45784097736831564, 'f1-score': 0.4485808395823113, 'support': 34951}, '1': {'precision': 0.6877034358047016, 'recall': 0.6535888339205264, 'f1-score': 0.6702122972539195, 'support': 81461}, '2': {'precision': 0.4585942370767938, 'recall': 0.49333683258974137, 'f1-score': 0.47533153517644416, 'support': 34293}, 'accuracy': 0.5717262200988686, 'macro avg': {'precision': 0.5286618445059547, 'recall': 0.5349222146261945, 'f1-score': 0.5313748906708917, 'support': 150705}, 'weighted avg': {'precision': 0.5780505767775656, 'recall': 0.5717262200988686, 'f1-score': 0.5744670528957149, 'support': 150705}}
[[16002 12358  6591]
 [14837 53242 13382]
 [ 5555 11820 16918]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.930851
{'0': {'precision': 0.4437157626726333, 'recall': 0.40920734310516577, 'f1-score': 0.4257634647418101, 'support': 14054}, '1': {'precision': 0.6813993665418946, 'recall': 0.619016479204813, 'f1-score': 0.6487116228070177, 'support': 30584}, '2': {'precision': 0.427939142461964, 'recall': 0.5454096742349457, 'f1-score': 0.4795858263322689, 'support': 14182}, 'accuracy': 0.5511390683441006, 'macro avg': {'precision': 0.5176847572254973, 'recall': 0.5245444988483081, 'f1-score': 0.5180203046270323, 'support': 58820}, 'weighted avg': {'precision': 0.5634976619060535, 'recall': 0.5511390683441006, 'f1-score': 0.5546644371719732, 'support': 58820}}
[[ 5751  4569  3734]
 [ 5046 18932  6606]
 [ 2164  4283  7735]]
training model: results/QRTEA/W0/deepLOB_L2/h50
Epoch 1/50
589/589 - 31s - loss: 3.2439 - accuracy50: 0.4000 - val_loss: 3.4281 - val_accuracy50: 0.3866 - 31s/epoch - 53ms/step
Epoch 2/50
589/589 - 29s - loss: 3.1036 - accuracy50: 0.4494 - val_loss: 3.2916 - val_accuracy50: 0.4185 - 29s/epoch - 49ms/step
Epoch 3/50
589/589 - 30s - loss: 3.0440 - accuracy50: 0.4695 - val_loss: 3.3349 - val_accuracy50: 0.4303 - 30s/epoch - 50ms/step
Epoch 4/50
589/589 - 30s - loss: 3.0105 - accuracy50: 0.4837 - val_loss: 3.2866 - val_accuracy50: 0.4478 - 30s/epoch - 50ms/step
Epoch 5/50
589/589 - 29s - loss: 2.9757 - accuracy50: 0.4968 - val_loss: 3.2629 - val_accuracy50: 0.4582 - 29s/epoch - 50ms/step
Epoch 6/50
589/589 - 30s - loss: 2.9521 - accuracy50: 0.5029 - val_loss: 3.1981 - val_accuracy50: 0.4701 - 30s/epoch - 50ms/step
Epoch 7/50
589/589 - 30s - loss: 2.9279 - accuracy50: 0.5123 - val_loss: 3.2086 - val_accuracy50: 0.4731 - 30s/epoch - 51ms/step
Epoch 8/50
589/589 - 29s - loss: 2.9089 - accuracy50: 0.5156 - val_loss: 3.2479 - val_accuracy50: 0.4783 - 29s/epoch - 50ms/step
Epoch 9/50
589/589 - 30s - loss: 2.8838 - accuracy50: 0.5228 - val_loss: 3.2543 - val_accuracy50: 0.4796 - 30s/epoch - 51ms/step
Epoch 10/50
589/589 - 30s - loss: 2.8608 - accuracy50: 0.5292 - val_loss: 3.2233 - val_accuracy50: 0.4826 - 30s/epoch - 50ms/step
Epoch 11/50
589/589 - 29s - loss: 2.8433 - accuracy50: 0.5324 - val_loss: 3.2430 - val_accuracy50: 0.4765 - 29s/epoch - 49ms/step
Epoch 12/50
589/589 - 29s - loss: 2.8228 - accuracy50: 0.5368 - val_loss: 3.2197 - val_accuracy50: 0.4784 - 29s/epoch - 50ms/step
Epoch 13/50
589/589 - 29s - loss: 2.8033 - accuracy50: 0.5423 - val_loss: 3.2264 - val_accuracy50: 0.4802 - 29s/epoch - 49ms/step
Epoch 14/50
589/589 - 29s - loss: 2.7888 - accuracy50: 0.5467 - val_loss: 3.2403 - val_accuracy50: 0.4717 - 29s/epoch - 50ms/step
Epoch 15/50
589/589 - 29s - loss: 2.7706 - accuracy50: 0.5514 - val_loss: 3.2412 - val_accuracy50: 0.4727 - 29s/epoch - 50ms/step
Epoch 16/50
589/589 - 30s - loss: 2.7549 - accuracy50: 0.5536 - val_loss: 3.2649 - val_accuracy50: 0.4688 - 30s/epoch - 51ms/step
testing model: results/QRTEA/W0/deepLOB_L2/h50
Evaluating performance on  test set...
2359/2359 - 44s - 44s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9976729
{'0': {'precision': 0.3852808570217467, 'recall': 0.4205828945615671, 'f1-score': 0.4021586471583958, 'support': 142633}, '1': {'precision': 0.5681540116568455, 'recall': 0.5727632656628866, 'f1-score': 0.5704493280713973, 'support': 308899}, '2': {'precision': 0.39933128964523235, 'recall': 0.3584817675493905, 'f1-score': 0.377805542384672, 'support': 152256}, 'accuracy': 0.48277872365797264, 'macro avg': {'precision': 0.45092205277460823, 'recall': 0.4506093092579481, 'f1-score': 0.4501378392048217, 'support': 603788}, 'weighted avg': {'precision': 0.4823821529453968, 'recall': 0.48277872365797264, 'f1-score': 0.4821153815136946, 'support': 603788}}
[[ 59989  61958  20686]
 [ 70559 176926  61414]
 [ 25154  72521  54581]]
Evaluating performance on  train set...
589/589 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0134213
{'0': {'precision': 0.44949552636588613, 'recall': 0.2889236943859821, 'f1-score': 0.35175115825226805, 'support': 40862}, '1': {'precision': 0.5141023710516257, 'recall': 0.6367588195630031, 'f1-score': 0.5688943577123228, 'support': 69703}, '2': {'precision': 0.43435589261815416, 'recall': 0.4123567513702043, 'f1-score': 0.4230705330555804, 'support': 40140}, 'accuracy': 0.48267807969211374, 'macro avg': {'precision': 0.46598459667855535, 'recall': 0.4460130884397298, 'f1-score': 0.4479053496733904, 'support': 150705}, 'weighted avg': {'precision': 0.47534460898753866, 'recall': 0.48267807969211374, 'f1-score': 0.471178464158304, 'support': 150705}}
[[11806 22545  6511]
 [10275 44384 15044]
 [ 4184 19404 16552]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0226471
{'0': {'precision': 0.4705735245081694, 'recall': 0.3419968496304374, 'f1-score': 0.3961125535050173, 'support': 16506}, '1': {'precision': 0.5086950168054947, 'recall': 0.5450133082824488, 'f1-score': 0.5262282690854119, 'support': 25548}, '2': {'precision': 0.4182089245321818, 'recall': 0.4852081593701539, 'f1-score': 0.44922414269147937, 'support': 16766}, 'accuracy': 0.4709962597755865, 'macro avg': {'precision': 0.4658258219486153, 'recall': 0.4574061057610133, 'f1-score': 0.4571883217606361, 'support': 58820}, 'weighted avg': {'precision': 0.47220533345095517, 'recall': 0.4709962597755865, 'f1-score': 0.4677661612225988, 'support': 58820}}
[[ 5645  6979  3882]
 [ 4189 13924  7435]
 [ 2162  6469  8135]]
training model: results/QRTEA/W0/deepLOB_L2/h100
Epoch 1/50
589/589 - 32s - loss: 3.2883 - accuracy100: 0.3858 - val_loss: 3.2487 - val_accuracy100: 0.3964 - 32s/epoch - 54ms/step
Epoch 2/50
589/589 - 30s - loss: 3.1853 - accuracy100: 0.4331 - val_loss: 3.2421 - val_accuracy100: 0.4197 - 30s/epoch - 51ms/step
Epoch 3/50
589/589 - 30s - loss: 3.1377 - accuracy100: 0.4511 - val_loss: 3.2076 - val_accuracy100: 0.4231 - 30s/epoch - 50ms/step
Epoch 4/50
589/589 - 30s - loss: 3.1111 - accuracy100: 0.4604 - val_loss: 3.1876 - val_accuracy100: 0.4322 - 30s/epoch - 50ms/step
Epoch 5/50
589/589 - 29s - loss: 3.0885 - accuracy100: 0.4684 - val_loss: 3.2210 - val_accuracy100: 0.4294 - 29s/epoch - 50ms/step
Epoch 6/50
589/589 - 29s - loss: 3.0645 - accuracy100: 0.4748 - val_loss: 3.2451 - val_accuracy100: 0.4268 - 29s/epoch - 50ms/step
Epoch 7/50
589/589 - 29s - loss: 3.0429 - accuracy100: 0.4809 - val_loss: 3.2748 - val_accuracy100: 0.4189 - 29s/epoch - 50ms/step
Epoch 8/50
589/589 - 29s - loss: 3.0193 - accuracy100: 0.4889 - val_loss: 3.2883 - val_accuracy100: 0.4219 - 29s/epoch - 50ms/step
Epoch 9/50
589/589 - 29s - loss: 2.9978 - accuracy100: 0.4945 - val_loss: 3.3422 - val_accuracy100: 0.4111 - 29s/epoch - 50ms/step
Epoch 10/50
589/589 - 30s - loss: 2.9738 - accuracy100: 0.5006 - val_loss: 3.3773 - val_accuracy100: 0.4066 - 30s/epoch - 50ms/step
Epoch 11/50
589/589 - 30s - loss: 2.9501 - accuracy100: 0.5074 - val_loss: 3.4046 - val_accuracy100: 0.4031 - 30s/epoch - 51ms/step
Epoch 12/50
589/589 - 30s - loss: 2.9285 - accuracy100: 0.5129 - val_loss: 3.4565 - val_accuracy100: 0.3923 - 30s/epoch - 50ms/step
Epoch 13/50
589/589 - 29s - loss: 2.9061 - accuracy100: 0.5187 - val_loss: 3.4891 - val_accuracy100: 0.3891 - 29s/epoch - 50ms/step
Epoch 14/50
589/589 - 29s - loss: 2.8842 - accuracy100: 0.5262 - val_loss: 3.5197 - val_accuracy100: 0.3876 - 29s/epoch - 50ms/step
testing model: results/QRTEA/W0/deepLOB_L2/h100
Evaluating performance on  test set...
2359/2359 - 46s - 46s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0695156
{'0': {'precision': 0.3579174380989197, 'recall': 0.6062269905176523, 'f1-score': 0.4500969043898009, 'support': 174113}, '1': {'precision': 0.5275123925833176, 'recall': 0.26131453843310687, 'f1-score': 0.3494978479196557, 'support': 235383}, '2': {'precision': 0.41761493655086335, 'recall': 0.41329030531365163, 'f1-score': 0.41544136667942844, 'support': 194292}, 'accuracy': 0.4096802188847741, 'macro avg': {'precision': 0.4343482557443668, 'recall': 0.4269439447548036, 'f1-score': 0.4050120396629617, 'support': 603788}, 'weighted avg': {'precision': 0.4432429423166684, 'recall': 0.40968021888477407, 'f1-score': 0.3997272358274315, 'support': 603788}}
[[105552  25415  43146]
 [105039  61509  68835]
 [ 84315  29678  80299]]
Evaluating performance on  train set...
589/589 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0596856
{'0': {'precision': 0.415418058998958, 'recall': 0.4633310623973069, 'f1-score': 0.4380683540466808, 'support': 49906}, '1': {'precision': 0.44758522727272726, 'recall': 0.30511067645293105, 'f1-score': 0.3628637562329422, 'support': 51637}, '2': {'precision': 0.42599802817372123, 'recall': 0.5185509133070257, 'f1-score': 0.4677400119260584, 'support': 49162}, 'accuracy': 0.4271324773564248, 'macro avg': {'precision': 0.4296671048151355, 'recall': 0.42899755071908796, 'f1-score': 0.4228907074018938, 'support': 150705}, 'weighted avg': {'precision': 0.429891026138219, 'recall': 0.4271324773564248, 'f1-score': 0.42197982498233616, 'support': 150705}}
[[23123 11169 15614]
 [17146 15755 18736]
 [15393  8276 25493]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0620706
{'0': {'precision': 0.4391353811149033, 'recall': 0.42999645551673504, 'f1-score': 0.4345178703916904, 'support': 19749}, '1': {'precision': 0.44078402502990705, 'recall': 0.2612347294938918, 'f1-score': 0.32804848816902377, 'support': 18336}, '2': {'precision': 0.4270138039489778, 'recall': 0.5892934651555342, 'f1-score': 0.49519756838905776, 'support': 20735}, 'accuracy': 0.43354301258075484, 'macro avg': {'precision': 0.43564440336459603, 'recall': 0.42684155005538704, 'f1-score': 0.4192546423165906, 'support': 58820}, 'weighted avg': {'precision': 0.4353762623167062, 'recall': 0.43354301258075484, 'f1-score': 0.4227186685137679, 'support': 58820}}
[[ 8492  3342  7915]
 [ 5065  4790  8481]
 [ 5781  2735 12219]]
training model: results/QRTEA/W0/deepLOB_L2/h200
Epoch 1/50
589/589 - 33s - loss: 3.3105 - accuracy200: 0.3712 - val_loss: 3.4062 - val_accuracy200: 0.3318 - 33s/epoch - 56ms/step
Epoch 2/50
589/589 - 30s - loss: 3.2662 - accuracy200: 0.3863 - val_loss: 3.5020 - val_accuracy200: 0.3682 - 30s/epoch - 51ms/step
Epoch 3/50
589/589 - 29s - loss: 3.2391 - accuracy200: 0.4022 - val_loss: 3.5132 - val_accuracy200: 0.3613 - 29s/epoch - 50ms/step
Epoch 4/50
589/589 - 30s - loss: 3.2202 - accuracy200: 0.4102 - val_loss: 3.5258 - val_accuracy200: 0.3718 - 30s/epoch - 51ms/step
Epoch 5/50
589/589 - 30s - loss: 3.2014 - accuracy200: 0.4210 - val_loss: 3.5159 - val_accuracy200: 0.3737 - 30s/epoch - 51ms/step
Epoch 6/50
589/589 - 29s - loss: 3.1798 - accuracy200: 0.4305 - val_loss: 3.5020 - val_accuracy200: 0.3703 - 29s/epoch - 50ms/step
Epoch 7/50
589/589 - 29s - loss: 3.1582 - accuracy200: 0.4411 - val_loss: 3.5100 - val_accuracy200: 0.3780 - 29s/epoch - 50ms/step
Epoch 8/50
589/589 - 30s - loss: 3.1435 - accuracy200: 0.4485 - val_loss: 3.5588 - val_accuracy200: 0.3838 - 30s/epoch - 50ms/step
Epoch 9/50
589/589 - 30s - loss: 3.1226 - accuracy200: 0.4568 - val_loss: 3.6397 - val_accuracy200: 0.3848 - 30s/epoch - 50ms/step
Epoch 10/50
589/589 - 30s - loss: 3.1035 - accuracy200: 0.4611 - val_loss: 3.6901 - val_accuracy200: 0.3863 - 30s/epoch - 51ms/step
Epoch 11/50
589/589 - 29s - loss: 3.0894 - accuracy200: 0.4672 - val_loss: 3.7339 - val_accuracy200: 0.3828 - 29s/epoch - 49ms/step
testing model: results/QRTEA/W0/deepLOB_L2/h200
Evaluating performance on  test set...
2359/2359 - 44s - 44s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1239289
{'0': {'precision': 0.30138194486552633, 'recall': 0.3131870335046084, 'f1-score': 0.3071711088138793, 'support': 174573}, '1': {'precision': 0.3852500431715413, 'recall': 0.5427603420466935, 'f1-score': 0.45063815779629823, 'support': 221958}, '2': {'precision': 0.3400625507198804, 'recall': 0.17994567131628847, 'f1-score': 0.23535314014539585, 'support': 207257}, 'accuracy': 0.3518436934818181, 'macro avg': {'precision': 0.34223151291898274, 'recall': 0.34529768228919683, 'f1-score': 0.33105413558519114, 'support': 603788}, 'weighted avg': {'precision': 0.3454901777077861, 'recall': 0.3518436934818181, 'f1-score': 0.3352585874085448, 'support': 603788}}
[[ 54674  88145  31754]
 [ 60866 120470  40622]
 [ 65871 104091  37295]]
Evaluating performance on  train set...
589/589 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1170766
{'0': {'precision': 0.3466591892324948, 'recall': 0.25572278476025373, 'f1-score': 0.29432704516597136, 'support': 50762}, '1': {'precision': 0.3388414791828291, 'recall': 0.5246026344236697, 'f1-score': 0.4117397520700112, 'support': 49954}, '2': {'precision': 0.35268242434366215, 'recall': 0.25341575146532236, 'f1-score': 0.2949201471341435, 'support': 49989}, 'accuracy': 0.3440828107892903, 'macro avg': {'precision': 0.34606103091966195, 'recall': 0.3445803902164153, 'f1-score': 0.333662314790042, 'support': 150705}, 'weighted avg': {'precision': 0.3460657756904832, 'recall': 0.3440828107892903, 'f1-score': 0.33344242245916905, 'support': 150705}}
[[12981 25840 11941]
 [12438 26206 11310]
 [12027 25294 12668]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.135971
{'0': {'precision': 0.3436894221197674, 'recall': 0.33328252806990805, 'f1-score': 0.33840598400825384, 'support': 19683}, '1': {'precision': 0.3000312315647014, 'recall': 0.49658262018264315, 'f1-score': 0.37405901185428747, 'support': 17411}, '2': {'precision': 0.3990472700622939, 'recall': 0.20049710024855014, 'f1-score': 0.2668954108204154, 'support': 21726}, 'accuracy': 0.33257395443726623, 'macro avg': {'precision': 0.34758930791558756, 'recall': 0.34345408283370044, 'f1-score': 0.32645346889431887, 'support': 58820}, 'weighted avg': {'precision': 0.35121359499710636, 'recall': 0.33257395443726623, 'f1-score': 0.3225460070403571, 'support': 58820}}
[[ 6560  9480  3643]
 [ 5848  8646  2917]
 [ 6679 10691  4356]]
training model: results/QRTEA/W0/deepLOB_L2/h300
Epoch 1/50
589/589 - 32s - loss: 3.3221 - accuracy300: 0.3631 - val_loss: 3.3644 - val_accuracy300: 0.3448 - 32s/epoch - 55ms/step
Epoch 2/50
589/589 - 30s - loss: 3.2899 - accuracy300: 0.3690 - val_loss: 3.3605 - val_accuracy300: 0.3536 - 30s/epoch - 51ms/step
Epoch 3/50
589/589 - 30s - loss: 3.2618 - accuracy300: 0.3841 - val_loss: 3.4042 - val_accuracy300: 0.3552 - 30s/epoch - 51ms/step
Epoch 4/50
589/589 - 30s - loss: 3.2417 - accuracy300: 0.3968 - val_loss: 3.4753 - val_accuracy300: 0.3599 - 30s/epoch - 50ms/step
Epoch 5/50
589/589 - 29s - loss: 3.2254 - accuracy300: 0.4079 - val_loss: 3.4807 - val_accuracy300: 0.3678 - 29s/epoch - 50ms/step
Epoch 6/50
589/589 - 29s - loss: 3.2055 - accuracy300: 0.4198 - val_loss: 3.5201 - val_accuracy300: 0.3640 - 29s/epoch - 50ms/step
Epoch 7/50
589/589 - 29s - loss: 3.1832 - accuracy300: 0.4293 - val_loss: 3.5464 - val_accuracy300: 0.3643 - 29s/epoch - 50ms/step
Epoch 8/50
589/589 - 29s - loss: 3.1592 - accuracy300: 0.4406 - val_loss: 3.5807 - val_accuracy300: 0.3683 - 29s/epoch - 50ms/step
Epoch 9/50
589/589 - 29s - loss: 3.1318 - accuracy300: 0.4499 - val_loss: 3.6119 - val_accuracy300: 0.3714 - 29s/epoch - 50ms/step
Epoch 10/50
589/589 - 29s - loss: 3.1082 - accuracy300: 0.4603 - val_loss: 3.6391 - val_accuracy300: 0.3736 - 29s/epoch - 50ms/step
Epoch 11/50
589/589 - 30s - loss: 3.0882 - accuracy300: 0.4659 - val_loss: 3.7048 - val_accuracy300: 0.3732 - 30s/epoch - 50ms/step
Epoch 12/50
589/589 - 29s - loss: 3.0646 - accuracy300: 0.4749 - val_loss: 3.7410 - val_accuracy300: 0.3744 - 29s/epoch - 49ms/step
testing model: results/QRTEA/W0/deepLOB_L2/h300
Evaluating performance on  test set...
2359/2359 - 45s - 45s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1256405
{'0': {'precision': 0.32061086292164603, 'recall': 0.5935615291501581, 'f1-score': 0.41633782798152275, 'support': 187529}, '1': {'precision': 0.3378865093479593, 'recall': 0.23600701476022465, 'f1-score': 0.2779037680304343, 'support': 191596}, '2': {'precision': 0.39969539260960574, 'recall': 0.21843828311738026, 'f1-score': 0.2824915669863345, 'support': 224663}, 'accuracy': 0.3405218387910989, 'macro avg': {'precision': 0.3527309216264037, 'recall': 0.34933560900925437, 'f1-score': 0.3255777209994305, 'support': 603788}, 'weighted avg': {'precision': 0.3555193282206947, 'recall': 0.3405218387910989, 'f1-score': 0.32260672586562983, 'support': 603788}}
[[111310  39308  36911]
 [109583  45218  36795]
 [126288  49300  49075]]
Evaluating performance on  train set...
589/589 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1092492
{'0': {'precision': 0.34555824855231265, 'recall': 0.46857165348132407, 'f1-score': 0.3977714109107311, 'support': 50814}, '1': {'precision': 0.3477826358525921, 'recall': 0.2746754015549153, 'f1-score': 0.3069358235119014, 'support': 50678}, '2': {'precision': 0.34387342317543146, 'recall': 0.29191473797573814, 'f1-score': 0.3157709638421805, 'support': 49213}, 'accuracy': 0.34568196144786173, 'macro avg': {'precision': 0.3457381025267787, 'recall': 0.34505393100399245, 'f1-score': 0.34015939942160434, 'support': 150705}, 'weighted avg': {'precision': 0.34575606672908915, 'recall': 0.34568196144786173, 'f1-score': 0.3404484694039299, 'support': 150705}}
[[23810 13238 13766]
 [23113 13920 13645]
 [21980 12867 14366]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1174954
{'0': {'precision': 0.3540011625653943, 'recall': 0.46405892811785626, 'f1-score': 0.40162673114970326, 'support': 19685}, '1': {'precision': 0.30169449901768175, 'recall': 0.2812178093166991, 'f1-score': 0.2910964990225698, 'support': 17474}, '2': {'precision': 0.39690321037843007, 'recall': 0.30649554498868936, 'f1-score': 0.34588934041888086, 'support': 21661}, 'accuracy': 0.3517171030261816, 'macro avg': {'precision': 0.35086629065383534, 'recall': 0.35059076080774826, 'f1-score': 0.34620419019705134, 'support': 58820}, 'weighted avg': {'precision': 0.35426118668721407, 'recall': 0.3517171030261816, 'f1-score': 0.3482650702042787, 'support': 58820}}
[[9135 5334 5216]
 [7688 4914 4872]
 [8982 6040 6639]]
training model: results/QRTEA/W0/deepLOB_L2/h500
Epoch 1/50
589/589 - 31s - loss: 3.3322 - accuracy500: 0.3549 - val_loss: 3.3950 - val_accuracy500: 0.3343 - 31s/epoch - 53ms/step
Epoch 2/50
589/589 - 30s - loss: 3.2842 - accuracy500: 0.3723 - val_loss: 3.4392 - val_accuracy500: 0.3383 - 30s/epoch - 50ms/step
Epoch 3/50
589/589 - 29s - loss: 3.2648 - accuracy500: 0.3832 - val_loss: 3.5488 - val_accuracy500: 0.3415 - 29s/epoch - 50ms/step
Epoch 4/50
589/589 - 29s - loss: 3.2461 - accuracy500: 0.3980 - val_loss: 3.5210 - val_accuracy500: 0.3471 - 29s/epoch - 50ms/step
Epoch 5/50
589/589 - 29s - loss: 3.2216 - accuracy500: 0.4131 - val_loss: 3.5274 - val_accuracy500: 0.3550 - 29s/epoch - 50ms/step
Epoch 6/50
589/589 - 29s - loss: 3.1953 - accuracy500: 0.4254 - val_loss: 3.5363 - val_accuracy500: 0.3527 - 29s/epoch - 50ms/step
Epoch 7/50
589/589 - 30s - loss: 3.1771 - accuracy500: 0.4352 - val_loss: 3.5906 - val_accuracy500: 0.3581 - 30s/epoch - 50ms/step
Epoch 8/50
589/589 - 30s - loss: 3.1566 - accuracy500: 0.4447 - val_loss: 3.5518 - val_accuracy500: 0.3493 - 30s/epoch - 51ms/step
Epoch 9/50
589/589 - 30s - loss: 3.1271 - accuracy500: 0.4543 - val_loss: 3.6224 - val_accuracy500: 0.3621 - 30s/epoch - 51ms/step
Epoch 10/50
589/589 - 30s - loss: 3.0990 - accuracy500: 0.4664 - val_loss: 3.6981 - val_accuracy500: 0.3587 - 30s/epoch - 50ms/step
Epoch 11/50
589/589 - 30s - loss: 3.0730 - accuracy500: 0.4744 - val_loss: 3.7278 - val_accuracy500: 0.3480 - 30s/epoch - 51ms/step
testing model: results/QRTEA/W0/deepLOB_L2/h500
Evaluating performance on  test set...
2359/2359 - 45s - 45s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1415681
{'0': {'precision': 0.3465936778153973, 'recall': 0.8034043010963003, 'f1-score': 0.4842701580279154, 'support': 204506}, '1': {'precision': 0.287339631658273, 'recall': 0.18948746386429338, 'f1-score': 0.22837317166700144, 'support': 165003}, '2': {'precision': 0.40786393387798003, 'recall': 0.036439458935713404, 'f1-score': 0.06690176717213275, 'support': 234279}, 'accuracy': 0.3380391793145939, 'macro avg': {'precision': 0.3472657477838834, 'recall': 0.3431104079654357, 'f1-score': 0.25984836562234986, 'support': 603788}, 'weighted avg': {'precision': 0.3541745488198257, 'recall': 0.3380391793145939, 'f1-score': 0.25239337398813355, 'support': 603788}}
[[164301  33950   6255]
 [127598  31266   6139]
 [182146  43596   8537]]
Evaluating performance on  train set...
589/589 - 13s - 13s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1176864
{'0': {'precision': 0.35695692025664527, 'recall': 0.7365852735904371, 'f1-score': 0.4808762062344494, 'support': 52871}, '1': {'precision': 0.31314183227747405, 'recall': 0.22947935215805987, 'f1-score': 0.26486096328647796, 'support': 47172}, '2': {'precision': 0.377771461057419, 'recall': 0.05246535865145474, 'f1-score': 0.09213490935561024, 'support': 50662}, 'accuracy': 0.3478783052984307, 'macro avg': {'precision': 0.3492900711971794, 'recall': 0.33950999479998395, 'f1-score': 0.27929069295884584, 'support': 150705}, 'weighted avg': {'precision': 0.3502395647335726, 'recall': 0.3478783052984307, 'f1-score': 0.2825796492335705, 'support': 150705}}
[[38944 11725  2202]
 [34171 10825  2176]
 [35985 12019  2658]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1313441
{'0': {'precision': 0.3481649128537763, 'recall': 0.740545905707196, 'f1-score': 0.4736466219111555, 'support': 20150}, '1': {'precision': 0.2704200465826038, 'recall': 0.20334581471192173, 'f1-score': 0.23213485470026543, 'support': 16558}, '2': {'precision': 0.40683760683760684, 'recall': 0.06458031837916063, 'f1-score': 0.11146670829755678, 'support': 22112}, 'accuracy': 0.3352091125467528, 'macro avg': {'precision': 0.34180752209132903, 'recall': 0.3361573462660928, 'f1-score': 0.27241606163632587, 'support': 58820}, 'weighted avg': {'precision': 0.3483361320590192, 'recall': 0.3352091125467528, 'f1-score': 0.26950731400055006, 'support': 58820}}
[[14922  4153  1075]
 [12184  3367  1007]
 [15753  4931  1428]]
training model: results/QRTEA/W0/deepLOB_L2/h1000
Epoch 1/50
589/589 - 33s - loss: 3.3001 - accuracy1000: 0.3873 - val_loss: 3.5144 - val_accuracy1000: 0.3451 - 33s/epoch - 56ms/step
Epoch 2/50
589/589 - 30s - loss: 3.2587 - accuracy1000: 0.3990 - val_loss: 3.5155 - val_accuracy1000: 0.3392 - 30s/epoch - 51ms/step
Epoch 3/50
589/589 - 30s - loss: 3.2447 - accuracy1000: 0.4011 - val_loss: 3.6683 - val_accuracy1000: 0.3478 - 30s/epoch - 51ms/step
Epoch 4/50
589/589 - 30s - loss: 3.2210 - accuracy1000: 0.4190 - val_loss: 3.5653 - val_accuracy1000: 0.3634 - 30s/epoch - 51ms/step
Epoch 5/50
589/589 - 30s - loss: 3.1954 - accuracy1000: 0.4316 - val_loss: 3.6153 - val_accuracy1000: 0.3653 - 30s/epoch - 51ms/step
Epoch 6/50
589/589 - 30s - loss: 3.1798 - accuracy1000: 0.4362 - val_loss: 3.6970 - val_accuracy1000: 0.3563 - 30s/epoch - 51ms/step
Epoch 7/50
589/589 - 30s - loss: 3.1478 - accuracy1000: 0.4508 - val_loss: 3.7058 - val_accuracy1000: 0.3596 - 30s/epoch - 51ms/step
Epoch 8/50
589/589 - 30s - loss: 3.1448 - accuracy1000: 0.4526 - val_loss: 3.6906 - val_accuracy1000: 0.3564 - 30s/epoch - 51ms/step
Epoch 9/50
589/589 - 30s - loss: 3.1170 - accuracy1000: 0.4592 - val_loss: 3.8064 - val_accuracy1000: 0.3668 - 30s/epoch - 51ms/step
Epoch 10/50
589/589 - 30s - loss: 3.0805 - accuracy1000: 0.4730 - val_loss: 3.7456 - val_accuracy1000: 0.3654 - 30s/epoch - 50ms/step
Epoch 11/50
589/589 - 30s - loss: 3.0447 - accuracy1000: 0.4828 - val_loss: 3.8515 - val_accuracy1000: 0.3701 - 30s/epoch - 51ms/step
testing model: results/QRTEA/W0/deepLOB_L2/h1000
Evaluating performance on  test set...
2359/2359 - 46s - 46s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1441938
{'0': {'precision': 0.30117257269896774, 'recall': 0.30559023215067893, 'f1-score': 0.3033653205927834, 'support': 182640}, '1': {'precision': 0.39227999734536767, 'recall': 0.6262819352531642, 'f1-score': 0.48240144862236356, 'support': 226513}, '2': {'precision': 0.3865615708077485, 'recall': 0.11288308885863282, 'f1-score': 0.1747391359674238, 'support': 194635}, 'accuracy': 0.3637783460419882, 'macro avg': {'precision': 0.36000471361736136, 'recall': 0.348251752087492, 'f1-score': 0.32016863506085697, 'support': 603788}, 'weighted avg': {'precision': 0.3628775150393795, 'recall': 0.3637783460419882, 'f1-score': 0.32906780726659507, 'support': 603788}}
[[ 55813 104617  22210]
 [ 71996 141861  12656]
 [ 57510 115154  21971]]
Evaluating performance on  train set...
589/589 - 13s - 13s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1513965
{'0': {'precision': 0.33993940924009086, 'recall': 0.20870710867417125, 'f1-score': 0.258628347798946, 'support': 51613}, '1': {'precision': 0.3426695604991861, 'recall': 0.6242981415579281, 'f1-score': 0.44247179990191277, 'support': 50580}, '2': {'precision': 0.36014441508169875, 'recall': 0.19945580474934038, 'f1-score': 0.2567293277968665, 'support': 48512}, 'accuracy': 0.3452108423741747, 'macro avg': {'precision': 0.3475844616069919, 'recall': 0.3441536849938132, 'f1-score': 0.31927649183257506, 'support': 150705}, 'weighted avg': {'precision': 0.3473597091244551, 'recall': 0.3452108423741747, 'f1-score': 0.31971906508786924, 'support': 150705}}
[[10772 31457  9384]
 [11196 31577  7807]
 [ 9720 29116  9676]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1672486
{'0': {'precision': 0.34967194133539176, 'recall': 0.18374486639963494, 'f1-score': 0.24090138598065605, 'support': 19723}, '1': {'precision': 0.3302765906932574, 'recall': 0.6069480802792321, 'f1-score': 0.42777521525215256, 'support': 18336}, '2': {'precision': 0.38929539295392956, 'recall': 0.2767689417658109, 'f1-score': 0.32352692773289043, 'support': 20761}, 'accuracy': 0.3485039102346141, 'macro avg': {'precision': 0.35641464166085957, 'recall': 0.35582062948155935, 'f1-score': 0.330734509655233, 'support': 58820}, 'weighted avg': {'precision': 0.35761123629762037, 'recall': 0.3485039102346141, 'f1-score': 0.3283190569401987, 'support': 58820}}
[[ 3624 11109  4990]
 [ 3183 11129  4024]
 [ 3557 11458  5746]]
training model: results/QRTEA/W0/deepOF_L2/h10
Epoch 1/50
589/589 - 22s - loss: 3.0576 - accuracy10: 0.4567 - val_loss: 2.9833 - val_accuracy10: 0.5997 - 22s/epoch - 38ms/step
Epoch 2/50
589/589 - 19s - loss: 2.7616 - accuracy10: 0.5596 - val_loss: 2.7698 - val_accuracy10: 0.6085 - 19s/epoch - 33ms/step
Epoch 3/50
589/589 - 19s - loss: 2.5916 - accuracy10: 0.6073 - val_loss: 2.7091 - val_accuracy10: 0.6075 - 19s/epoch - 32ms/step
Epoch 4/50
589/589 - 20s - loss: 2.5246 - accuracy10: 0.6149 - val_loss: 2.6589 - val_accuracy10: 0.6338 - 20s/epoch - 33ms/step
Epoch 5/50
589/589 - 20s - loss: 2.4808 - accuracy10: 0.6209 - val_loss: 2.6744 - val_accuracy10: 0.6257 - 20s/epoch - 33ms/step
Epoch 6/50
589/589 - 19s - loss: 2.4539 - accuracy10: 0.6245 - val_loss: 2.6624 - val_accuracy10: 0.6150 - 19s/epoch - 33ms/step
Epoch 7/50
589/589 - 19s - loss: 2.4337 - accuracy10: 0.6275 - val_loss: 2.6312 - val_accuracy10: 0.6322 - 19s/epoch - 33ms/step
Epoch 8/50
589/589 - 20s - loss: 2.4150 - accuracy10: 0.6267 - val_loss: 2.6174 - val_accuracy10: 0.6372 - 20s/epoch - 34ms/step
Epoch 9/50
589/589 - 19s - loss: 2.3975 - accuracy10: 0.6295 - val_loss: 2.6077 - val_accuracy10: 0.6278 - 19s/epoch - 33ms/step
Epoch 10/50
589/589 - 19s - loss: 2.3851 - accuracy10: 0.6311 - val_loss: 2.6512 - val_accuracy10: 0.6172 - 19s/epoch - 32ms/step
Epoch 11/50
589/589 - 19s - loss: 2.3758 - accuracy10: 0.6322 - val_loss: 2.6145 - val_accuracy10: 0.6326 - 19s/epoch - 33ms/step
Epoch 12/50
589/589 - 20s - loss: 2.3603 - accuracy10: 0.6345 - val_loss: 2.6010 - val_accuracy10: 0.6336 - 20s/epoch - 35ms/step
Epoch 13/50
589/589 - 20s - loss: 2.3509 - accuracy10: 0.6353 - val_loss: 2.5978 - val_accuracy10: 0.6350 - 20s/epoch - 33ms/step
Epoch 14/50
589/589 - 20s - loss: 2.3399 - accuracy10: 0.6362 - val_loss: 2.6070 - val_accuracy10: 0.6315 - 20s/epoch - 33ms/step
Epoch 15/50
589/589 - 20s - loss: 2.3310 - accuracy10: 0.6368 - val_loss: 2.6114 - val_accuracy10: 0.6290 - 20s/epoch - 33ms/step
Epoch 16/50
589/589 - 20s - loss: 2.3207 - accuracy10: 0.6374 - val_loss: 2.6049 - val_accuracy10: 0.6309 - 20s/epoch - 34ms/step
Epoch 17/50
589/589 - 20s - loss: 2.3094 - accuracy10: 0.6387 - val_loss: 2.6140 - val_accuracy10: 0.6319 - 20s/epoch - 34ms/step
Epoch 18/50
589/589 - 20s - loss: 2.2998 - accuracy10: 0.6398 - val_loss: 2.5911 - val_accuracy10: 0.6346 - 20s/epoch - 34ms/step
Epoch 19/50
589/589 - 19s - loss: 2.2909 - accuracy10: 0.6403 - val_loss: 2.6004 - val_accuracy10: 0.6325 - 19s/epoch - 32ms/step
Epoch 20/50
589/589 - 19s - loss: 2.2817 - accuracy10: 0.6410 - val_loss: 2.6257 - val_accuracy10: 0.6356 - 19s/epoch - 32ms/step
Epoch 21/50
589/589 - 19s - loss: 2.2747 - accuracy10: 0.6424 - val_loss: 2.6339 - val_accuracy10: 0.6353 - 19s/epoch - 33ms/step
Epoch 22/50
589/589 - 20s - loss: 2.2615 - accuracy10: 0.6426 - val_loss: 2.6218 - val_accuracy10: 0.6286 - 20s/epoch - 33ms/step
Epoch 23/50
589/589 - 20s - loss: 2.2507 - accuracy10: 0.6449 - val_loss: 2.6322 - val_accuracy10: 0.6298 - 20s/epoch - 34ms/step
Epoch 24/50
589/589 - 19s - loss: 2.2421 - accuracy10: 0.6453 - val_loss: 2.6186 - val_accuracy10: 0.6367 - 19s/epoch - 32ms/step
Epoch 25/50
589/589 - 20s - loss: 2.2350 - accuracy10: 0.6467 - val_loss: 2.6310 - val_accuracy10: 0.6300 - 20s/epoch - 33ms/step
Epoch 26/50
589/589 - 20s - loss: 2.2237 - accuracy10: 0.6470 - val_loss: 2.6668 - val_accuracy10: 0.6229 - 20s/epoch - 33ms/step
Epoch 27/50
589/589 - 20s - loss: 2.2147 - accuracy10: 0.6463 - val_loss: 2.6861 - val_accuracy10: 0.6266 - 20s/epoch - 34ms/step
Epoch 28/50
589/589 - 19s - loss: 2.2029 - accuracy10: 0.6469 - val_loss: 2.6346 - val_accuracy10: 0.6279 - 19s/epoch - 33ms/step
testing model: results/QRTEA/W0/deepOF_L2/h10
Evaluating performance on  test set...
2359/2359 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7639741
{'0': {'precision': 0.31509858036589034, 'recall': 0.5986811689417719, 'f1-score': 0.4128863362714538, 'support': 82194}, '1': {'precision': 0.8884731723485131, 'recall': 0.6789342302216056, 'f1-score': 0.7696975889636333, 'support': 438256}, '2': {'precision': 0.4118826462264569, 'recall': 0.557126228504914, 'f1-score': 0.47361924387407417, 'support': 83333}, 'accuracy': 0.6511975328884715, 'macro avg': {'precision': 0.5384847996469534, 'recall': 0.6115805425560971, 'f1-score': 0.5520677230363872, 'support': 603783}, 'weighted avg': {'precision': 0.7446405875842037, 'recall': 0.6511975328884715, 'f1-score': 0.6802600909964344, 'support': 603783}}
[[ 49208  16485  16501]
 [ 90918 297547  49791]
 [ 16041  20865  46427]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77710414
{'0': {'precision': 0.38619019092021983, 'recall': 0.6329832650273224, 'f1-score': 0.47970622967792026, 'support': 23424}, '1': {'precision': 0.8812047420698494, 'recall': 0.6598844463212853, 'f1-score': 0.754652368852864, 'support': 104194}, '2': {'precision': 0.427171440237998, 'recall': 0.6344104652170146, 'f1-score': 0.5105626437983685, 'support': 23086}, 'accuracy': 0.6518008811975794, 'macro avg': {'precision': 0.5648554577426891, 'recall': 0.6424260588552074, 'f1-score': 0.5816404141097177, 'support': 150704}, 'weighted avg': {'precision': 0.7347120567249412, 'recall': 0.6518008811975794, 'f1-score': 0.674525804484022, 'support': 150704}}
[[14827  4500  4097]
 [19895 68756 15543]
 [ 3671  4769 14646]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8044152
{'0': {'precision': 0.3737731187821326, 'recall': 0.5923182731986033, 'f1-score': 0.4583265105616506, 'support': 9451}, '1': {'precision': 0.8617851239669422, 'recall': 0.6527857768874421, 'f1-score': 0.7428652846049726, 'support': 39935}, '2': {'precision': 0.4139199529134785, 'recall': 0.5964168345171208, 'f1-score': 0.488686210640608, 'support': 9433}, 'accuracy': 0.6340298202961628, 'macro avg': {'precision': 0.5498260652208511, 'recall': 0.6138402948677221, 'f1-score': 0.5632926686024103, 'support': 58819}, 'weighted avg': {'precision': 0.7115460240239143, 'recall': 0.6340298202961628, 'f1-score': 0.6563822237200666, 'support': 58819}}
[[ 5598  2042  1811]
 [ 7711 26069  6155]
 [ 1668  2139  5626]]
training model: results/QRTEA/W0/deepOF_L2/h20
Epoch 1/50
589/589 - 22s - loss: 3.0890 - accuracy20: 0.4558 - val_loss: 3.0168 - val_accuracy20: 0.5517 - 22s/epoch - 37ms/step
Epoch 2/50
589/589 - 20s - loss: 2.8320 - accuracy20: 0.5477 - val_loss: 2.8786 - val_accuracy20: 0.5899 - 20s/epoch - 34ms/step
Epoch 3/50
589/589 - 20s - loss: 2.6907 - accuracy20: 0.5902 - val_loss: 2.8168 - val_accuracy20: 0.5760 - 20s/epoch - 34ms/step
Epoch 4/50
589/589 - 20s - loss: 2.6164 - accuracy20: 0.6062 - val_loss: 2.7853 - val_accuracy20: 0.5985 - 20s/epoch - 33ms/step
Epoch 5/50
589/589 - 19s - loss: 2.5732 - accuracy20: 0.6133 - val_loss: 2.8203 - val_accuracy20: 0.5926 - 19s/epoch - 32ms/step
Epoch 6/50
589/589 - 19s - loss: 2.5437 - accuracy20: 0.6173 - val_loss: 2.7701 - val_accuracy20: 0.5996 - 19s/epoch - 33ms/step
Epoch 7/50
589/589 - 19s - loss: 2.5209 - accuracy20: 0.6199 - val_loss: 2.7715 - val_accuracy20: 0.6124 - 19s/epoch - 32ms/step
Epoch 8/50
589/589 - 19s - loss: 2.5055 - accuracy20: 0.6212 - val_loss: 2.7589 - val_accuracy20: 0.6050 - 19s/epoch - 32ms/step
Epoch 9/50
589/589 - 19s - loss: 2.4875 - accuracy20: 0.6229 - val_loss: 2.7949 - val_accuracy20: 0.5995 - 19s/epoch - 32ms/step
Epoch 10/50
589/589 - 19s - loss: 2.4746 - accuracy20: 0.6246 - val_loss: 2.7661 - val_accuracy20: 0.5996 - 19s/epoch - 32ms/step
Epoch 11/50
589/589 - 18s - loss: 2.4611 - accuracy20: 0.6254 - val_loss: 2.7630 - val_accuracy20: 0.6084 - 18s/epoch - 31ms/step
Epoch 12/50
589/589 - 19s - loss: 2.4495 - accuracy20: 0.6272 - val_loss: 2.7656 - val_accuracy20: 0.6115 - 19s/epoch - 32ms/step
Epoch 13/50
589/589 - 19s - loss: 2.4400 - accuracy20: 0.6272 - val_loss: 2.8187 - val_accuracy20: 0.5956 - 19s/epoch - 32ms/step
Epoch 14/50
589/589 - 19s - loss: 2.4312 - accuracy20: 0.6289 - val_loss: 2.7595 - val_accuracy20: 0.6054 - 19s/epoch - 32ms/step
Epoch 15/50
589/589 - 19s - loss: 2.4190 - accuracy20: 0.6304 - val_loss: 2.7639 - val_accuracy20: 0.6016 - 19s/epoch - 32ms/step
Epoch 16/50
589/589 - 20s - loss: 2.4076 - accuracy20: 0.6314 - val_loss: 2.8014 - val_accuracy20: 0.6026 - 20s/epoch - 33ms/step
Epoch 17/50
589/589 - 20s - loss: 2.3941 - accuracy20: 0.6332 - val_loss: 2.7699 - val_accuracy20: 0.6011 - 20s/epoch - 33ms/step
Epoch 18/50
589/589 - 20s - loss: 2.3838 - accuracy20: 0.6336 - val_loss: 2.8062 - val_accuracy20: 0.6103 - 20s/epoch - 34ms/step
testing model: results/QRTEA/W0/deepOF_L2/h20
Evaluating performance on  test set...
2359/2359 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82983243
{'0': {'precision': 0.3469978908414056, 'recall': 0.5935810237956177, 'f1-score': 0.4379672137984243, 'support': 106154}, '1': {'precision': 0.8119799813300614, 'recall': 0.6684744333807979, 'f1-score': 0.7332719637195625, 'support': 389062}, '2': {'precision': 0.4870403266171376, 'recall': 0.45710022382491916, 'f1-score': 0.47159555259906866, 'support': 108567}, 'accuracy': 0.6172995927344758, 'macro avg': {'precision': 0.5486727329295348, 'recall': 0.5730518936671115, 'f1-score': 0.5476115767056852, 'support': 603783}, 'weighted avg': {'precision': 0.6718014199479907, 'recall': 0.6172995927344758, 'f1-score': 0.6343006390064666, 'support': 603783}}
[[ 63011  23238  19905]
 [ 96622 260078  32362]
 [ 21956  36985  49626]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8444404
{'0': {'precision': 0.4155545227187216, 'recall': 0.6156065573770492, 'f1-score': 0.4961748345070887, 'support': 30500}, '1': {'precision': 0.7986161840309842, 'recall': 0.6418388258100249, 'f1-score': 0.7116957771390671, 'support': 90275}, '2': {'precision': 0.48504610531424414, 'recall': 0.5342978382171139, 'f1-score': 0.5084821215638266, 'support': 29929}, 'accuracy': 0.6151727890434229, 'macro avg': {'precision': 0.5664056040213167, 'recall': 0.5972477404680627, 'f1-score': 0.5721175777366607, 'support': 150704}, 'weighted avg': {'precision': 0.6588175087739419, 'recall': 0.6151727890434229, 'f1-score': 0.6277207648767069, 'support': 150704}}
[[18776  6324  5400]
 [20756 57942 11577]
 [ 5651  8287 15991]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8609935
{'0': {'precision': 0.4137392210197349, 'recall': 0.5853119371213362, 'f1-score': 0.4847930017292239, 'support': 12214}, '1': {'precision': 0.7747977120535714, 'recall': 0.6476865214729293, 'f1-score': 0.7055628781502598, 'support': 34299}, '2': {'precision': 0.48002797637550515, 'recall': 0.5019502681618723, 'f1-score': 0.4907444188448399, 'support': 12306}, 'accuracy': 0.6042435267515599, 'macro avg': {'precision': 0.5561883031496038, 'recall': 0.5783162422520459, 'f1-score': 0.5603667662414412, 'support': 58819}, 'weighted avg': {'precision': 0.6381513090759355, 'recall': 0.6042435267515599, 'f1-score': 0.6147752205767031, 'support': 58819}}
[[ 7149  2708  2357]
 [ 7750 22215  4334]
 [ 2380  3749  6177]]
training model: results/QRTEA/W0/deepOF_L2/h30
Epoch 1/50
589/589 - 21s - loss: 3.1257 - accuracy30: 0.4450 - val_loss: 3.0789 - val_accuracy30: 0.5289 - 21s/epoch - 36ms/step
Epoch 2/50
589/589 - 21s - loss: 2.9059 - accuracy30: 0.5251 - val_loss: 2.9678 - val_accuracy30: 0.5657 - 21s/epoch - 35ms/step
Epoch 3/50
589/589 - 19s - loss: 2.7827 - accuracy30: 0.5635 - val_loss: 2.9440 - val_accuracy30: 0.5576 - 19s/epoch - 33ms/step
Epoch 4/50
589/589 - 19s - loss: 2.7115 - accuracy30: 0.5820 - val_loss: 2.8927 - val_accuracy30: 0.5679 - 19s/epoch - 33ms/step
Epoch 5/50
589/589 - 19s - loss: 2.6714 - accuracy30: 0.5904 - val_loss: 2.8901 - val_accuracy30: 0.5677 - 19s/epoch - 32ms/step
Epoch 6/50
589/589 - 19s - loss: 2.6395 - accuracy30: 0.5955 - val_loss: 2.8656 - val_accuracy30: 0.5712 - 19s/epoch - 33ms/step
Epoch 7/50
589/589 - 20s - loss: 2.6198 - accuracy30: 0.5980 - val_loss: 2.8626 - val_accuracy30: 0.5713 - 20s/epoch - 33ms/step
Epoch 8/50
589/589 - 19s - loss: 2.6038 - accuracy30: 0.5990 - val_loss: 2.8158 - val_accuracy30: 0.5808 - 19s/epoch - 33ms/step
Epoch 9/50
589/589 - 19s - loss: 2.5894 - accuracy30: 0.6012 - val_loss: 2.8405 - val_accuracy30: 0.5761 - 19s/epoch - 33ms/step
Epoch 10/50
589/589 - 19s - loss: 2.5753 - accuracy30: 0.6030 - val_loss: 2.8565 - val_accuracy30: 0.5793 - 19s/epoch - 32ms/step
Epoch 11/50
589/589 - 19s - loss: 2.5643 - accuracy30: 0.6028 - val_loss: 2.8167 - val_accuracy30: 0.5838 - 19s/epoch - 32ms/step
Epoch 12/50
589/589 - 19s - loss: 2.5499 - accuracy30: 0.6056 - val_loss: 2.8399 - val_accuracy30: 0.5815 - 19s/epoch - 32ms/step
Epoch 13/50
589/589 - 19s - loss: 2.5402 - accuracy30: 0.6078 - val_loss: 2.8564 - val_accuracy30: 0.5782 - 19s/epoch - 33ms/step
Epoch 14/50
589/589 - 20s - loss: 2.5309 - accuracy30: 0.6079 - val_loss: 2.8118 - val_accuracy30: 0.5874 - 20s/epoch - 34ms/step
Epoch 15/50
589/589 - 20s - loss: 2.5191 - accuracy30: 0.6087 - val_loss: 2.8656 - val_accuracy30: 0.5807 - 20s/epoch - 34ms/step
Epoch 16/50
589/589 - 19s - loss: 2.5073 - accuracy30: 0.6114 - val_loss: 2.8629 - val_accuracy30: 0.5762 - 19s/epoch - 33ms/step
Epoch 17/50
589/589 - 18s - loss: 2.4960 - accuracy30: 0.6119 - val_loss: 2.8505 - val_accuracy30: 0.5853 - 18s/epoch - 31ms/step
Epoch 18/50
589/589 - 19s - loss: 2.4844 - accuracy30: 0.6153 - val_loss: 2.8802 - val_accuracy30: 0.5816 - 19s/epoch - 33ms/step
Epoch 19/50
589/589 - 20s - loss: 2.4727 - accuracy30: 0.6151 - val_loss: 2.8693 - val_accuracy30: 0.5782 - 20s/epoch - 34ms/step
Epoch 20/50
589/589 - 20s - loss: 2.4637 - accuracy30: 0.6154 - val_loss: 2.8796 - val_accuracy30: 0.5802 - 20s/epoch - 34ms/step
Epoch 21/50
589/589 - 19s - loss: 2.4536 - accuracy30: 0.6173 - val_loss: 2.8925 - val_accuracy30: 0.5839 - 19s/epoch - 32ms/step
Epoch 22/50
589/589 - 18s - loss: 2.4408 - accuracy30: 0.6196 - val_loss: 2.8961 - val_accuracy30: 0.5803 - 18s/epoch - 30ms/step
Epoch 23/50
589/589 - 18s - loss: 2.4348 - accuracy30: 0.6191 - val_loss: 2.9251 - val_accuracy30: 0.5818 - 18s/epoch - 30ms/step
Epoch 24/50
589/589 - 19s - loss: 2.4172 - accuracy30: 0.6213 - val_loss: 2.9879 - val_accuracy30: 0.5633 - 19s/epoch - 31ms/step
testing model: results/QRTEA/W0/deepOF_L2/h30
Evaluating performance on  test set...
2359/2359 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83731115
{'0': {'precision': 0.4130044152377041, 'recall': 0.5295308308786019, 'f1-score': 0.4640644942637314, 'support': 121534}, '1': {'precision': 0.7699931826524726, 'recall': 0.7006506557082547, 'f1-score': 0.7336871297372687, 'support': 356256}, '2': {'precision': 0.48210621556557287, 'recall': 0.4736612351479844, 'f1-score': 0.47784641623194907, 'support': 125993}, 'accuracy': 0.6188398812156023, 'macro avg': {'precision': 0.5550346044852499, 'recall': 0.5679475739116137, 'f1-score': 0.5585326800776497, 'support': 603783}, 'weighted avg': {'precision': 0.638061651782663, 'recall': 0.6188398812156023, 'f1-score': 0.6260284901327806, 'support': 603783}}
[[ 64356  31440  25738]
 [ 68275 249611  38370]
 [ 23193  43122  59678]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8512073
{'0': {'precision': 0.4849169051432172, 'recall': 0.5278349336991313, 'f1-score': 0.5054665371300339, 'support': 34992}, '1': {'precision': 0.7423400254410707, 'recall': 0.659456604515194, 'f1-score': 0.6984480089502921, 'support': 81414}, '2': {'precision': 0.48340820530639594, 'recall': 0.5678756778820923, 'f1-score': 0.522248588934025, 'support': 34298}, 'accuracy': 0.6080528718547616, 'macro avg': {'precision': 0.5702217119635613, 'recall': 0.5850557386988058, 'f1-score': 0.5753877116714503, 'support': 150704}, 'weighted avg': {'precision': 0.6236398357152402, 'recall': 0.6080528718547616, 'f1-score': 0.6135392117740235, 'support': 150704}}
[[18470  9374  7148]
 [14059 53689 13666]
 [ 5560  9261 19477]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8841126
{'0': {'precision': 0.4705802233723781, 'recall': 0.49297281872012555, 'f1-score': 0.48151632347304973, 'support': 14017}, '1': {'precision': 0.7080623044196758, 'recall': 0.6581691015459032, 'f1-score': 0.6822046817304109, 'support': 30597}, '2': {'precision': 0.46896903275137, 'recall': 0.5181274199225625, 'f1-score': 0.4923241579985953, 'support': 14205}, 'accuracy': 0.5849810435403526, 'macro avg': {'precision': 0.5492038535144746, 'recall': 0.5564231133961971, 'f1-score': 0.5520150544006853, 'support': 58819}, 'weighted avg': {'precision': 0.5937266942581929, 'recall': 0.5849810435403526, 'f1-score': 0.588522341716064, 'support': 58819}}
[[ 6910  3918  3189]
 [ 5314 20138  5145]
 [ 2460  4385  7360]]
training model: results/QRTEA/W0/deepOF_L2/h50
Epoch 1/50
589/589 - 22s - loss: 3.1814 - accuracy50: 0.4264 - val_loss: 3.1752 - val_accuracy50: 0.4734 - 22s/epoch - 38ms/step
Epoch 2/50
589/589 - 20s - loss: 3.0152 - accuracy50: 0.4886 - val_loss: 3.1247 - val_accuracy50: 0.5069 - 20s/epoch - 33ms/step
Epoch 3/50
589/589 - 19s - loss: 2.9309 - accuracy50: 0.5177 - val_loss: 3.0825 - val_accuracy50: 0.5115 - 19s/epoch - 33ms/step
Epoch 4/50
589/589 - 18s - loss: 2.8745 - accuracy50: 0.5351 - val_loss: 3.0607 - val_accuracy50: 0.5278 - 18s/epoch - 31ms/step
Epoch 5/50
589/589 - 18s - loss: 2.8367 - accuracy50: 0.5460 - val_loss: 3.0764 - val_accuracy50: 0.5291 - 18s/epoch - 31ms/step
Epoch 6/50
589/589 - 18s - loss: 2.8071 - accuracy50: 0.5535 - val_loss: 3.0699 - val_accuracy50: 0.5290 - 18s/epoch - 31ms/step
Epoch 7/50
589/589 - 19s - loss: 2.7878 - accuracy50: 0.5578 - val_loss: 3.0796 - val_accuracy50: 0.5307 - 19s/epoch - 32ms/step
Epoch 8/50
589/589 - 20s - loss: 2.7738 - accuracy50: 0.5601 - val_loss: 3.0592 - val_accuracy50: 0.5353 - 20s/epoch - 34ms/step
Epoch 9/50
589/589 - 19s - loss: 2.7598 - accuracy50: 0.5620 - val_loss: 3.0593 - val_accuracy50: 0.5372 - 19s/epoch - 32ms/step
Epoch 10/50
589/589 - 19s - loss: 2.7475 - accuracy50: 0.5648 - val_loss: 3.0585 - val_accuracy50: 0.5331 - 19s/epoch - 33ms/step
Epoch 11/50
589/589 - 19s - loss: 2.7364 - accuracy50: 0.5646 - val_loss: 3.0122 - val_accuracy50: 0.5378 - 19s/epoch - 33ms/step
Epoch 12/50
589/589 - 19s - loss: 2.7258 - accuracy50: 0.5685 - val_loss: 3.0611 - val_accuracy50: 0.5342 - 19s/epoch - 33ms/step
Epoch 13/50
589/589 - 18s - loss: 2.7163 - accuracy50: 0.5686 - val_loss: 3.0849 - val_accuracy50: 0.5296 - 18s/epoch - 31ms/step
Epoch 14/50
589/589 - 19s - loss: 2.7046 - accuracy50: 0.5723 - val_loss: 3.0552 - val_accuracy50: 0.5359 - 19s/epoch - 32ms/step
Epoch 15/50
589/589 - 18s - loss: 2.6948 - accuracy50: 0.5718 - val_loss: 3.0452 - val_accuracy50: 0.5323 - 18s/epoch - 31ms/step
Epoch 16/50
589/589 - 19s - loss: 2.6832 - accuracy50: 0.5736 - val_loss: 3.0668 - val_accuracy50: 0.5256 - 19s/epoch - 32ms/step
Epoch 17/50
589/589 - 19s - loss: 2.6693 - accuracy50: 0.5777 - val_loss: 3.0685 - val_accuracy50: 0.5306 - 19s/epoch - 32ms/step
Epoch 18/50
589/589 - 19s - loss: 2.6588 - accuracy50: 0.5791 - val_loss: 3.0417 - val_accuracy50: 0.5277 - 19s/epoch - 32ms/step
Epoch 19/50
589/589 - 19s - loss: 2.6442 - accuracy50: 0.5818 - val_loss: 3.0908 - val_accuracy50: 0.5261 - 19s/epoch - 32ms/step
Epoch 20/50
589/589 - 20s - loss: 2.6306 - accuracy50: 0.5836 - val_loss: 3.0722 - val_accuracy50: 0.5242 - 20s/epoch - 33ms/step
Epoch 21/50
589/589 - 20s - loss: 2.6194 - accuracy50: 0.5859 - val_loss: 3.1525 - val_accuracy50: 0.5141 - 20s/epoch - 34ms/step
testing model: results/QRTEA/W0/deepOF_L2/h50
Evaluating performance on  test set...
2359/2359 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9325734
{'0': {'precision': 0.40041389916755693, 'recall': 0.5439701046757016, 'f1-score': 0.4612809826455568, 'support': 142631}, '1': {'precision': 0.6542499153403318, 'recall': 0.6692284533132189, 'f1-score': 0.661654424120217, 'support': 308899}, '2': {'precision': 0.5325960976128449, 'recall': 0.3289787393351855, 'f1-score': 0.4067268106115356, 'support': 152253}, 'accuracy': 0.5538397073120641, 'macro avg': {'precision': 0.5290866373735779, 'recall': 0.5140590991080354, 'f1-score': 0.5098874057924364, 'support': 603783}, 'weighted avg': {'precision': 0.5636096629099022, 'recall': 0.5538397073120641, 'f1-score': 0.550036577525481, 'support': 603783}}
[[ 77587  42521  22523]
 [ 80741 206724  21434]
 [ 35439  66726  50088]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9288849
{'0': {'precision': 0.47051692787254307, 'recall': 0.5314295493997702, 'f1-score': 0.49912166894382126, 'support': 40901}, '1': {'precision': 0.6231216873394897, 'recall': 0.6549926768329456, 'f1-score': 0.6386598154656064, 'support': 69642}, '2': {'precision': 0.5322642473805265, 'recall': 0.41488010756704263, 'f1-score': 0.46629818792415867, 'support': 40161}, 'accuracy': 0.5574702728527444, 'macro avg': {'precision': 0.5419676208641864, 'recall': 0.5337674445999195, 'f1-score': 0.5346932241111954, 'support': 150704}, 'weighted avg': {'precision': 0.5574922885634154, 'recall': 0.5574702728527444, 'f1-score': 0.5548566977342946, 'support': 150704}}
[[21736 12766  6399]
 [15784 45615  8243]
 [ 8676 14823 16662]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95894593
{'0': {'precision': 0.473171862324719, 'recall': 0.4952993267422818, 'f1-score': 0.48398281226848416, 'support': 16487}, '1': {'precision': 0.5849238281921662, 'recall': 0.6662097058477929, 'f1-score': 0.6229262039919428, 'support': 25531}, '2': {'precision': 0.515782727127063, 'recall': 0.3831914766978156, 'f1-score': 0.43970904620428236, 'support': 16801}, 'accuracy': 0.5374623846036145, 'macro avg': {'precision': 0.5246261392146494, 'recall': 0.5149001697626301, 'f1-score': 0.515539354154903, 'support': 58819}, 'weighted avg': {'precision': 0.5338502924256383, 'recall': 0.5374623846036145, 'f1-score': 0.5316463255966088, 'support': 58819}}
[[ 8166  5395  2926]
 [ 5404 17009  3118]
 [ 3688  6675  6438]]
training model: results/QRTEA/W0/deepOF_L2/h100
Epoch 1/50
589/589 - 21s - loss: 3.2479 - accuracy100: 0.3934 - val_loss: 3.2281 - val_accuracy100: 0.3985 - 21s/epoch - 35ms/step
Epoch 2/50
589/589 - 19s - loss: 3.1442 - accuracy100: 0.4379 - val_loss: 3.1898 - val_accuracy100: 0.4140 - 19s/epoch - 32ms/step
Epoch 3/50
589/589 - 19s - loss: 3.0906 - accuracy100: 0.4591 - val_loss: 3.1728 - val_accuracy100: 0.4237 - 19s/epoch - 31ms/step
Epoch 4/50
589/589 - 19s - loss: 3.0589 - accuracy100: 0.4683 - val_loss: 3.1487 - val_accuracy100: 0.4362 - 19s/epoch - 31ms/step
Epoch 5/50
589/589 - 18s - loss: 3.0320 - accuracy100: 0.4760 - val_loss: 3.1283 - val_accuracy100: 0.4442 - 18s/epoch - 31ms/step
Epoch 6/50
589/589 - 18s - loss: 3.0104 - accuracy100: 0.4828 - val_loss: 3.1157 - val_accuracy100: 0.4483 - 18s/epoch - 31ms/step
Epoch 7/50
589/589 - 19s - loss: 2.9952 - accuracy100: 0.4876 - val_loss: 3.1344 - val_accuracy100: 0.4510 - 19s/epoch - 32ms/step
Epoch 8/50
589/589 - 18s - loss: 2.9831 - accuracy100: 0.4925 - val_loss: 3.1340 - val_accuracy100: 0.4534 - 18s/epoch - 31ms/step
Epoch 9/50
589/589 - 18s - loss: 2.9716 - accuracy100: 0.4944 - val_loss: 3.1507 - val_accuracy100: 0.4519 - 18s/epoch - 31ms/step
Epoch 10/50
589/589 - 19s - loss: 2.9614 - accuracy100: 0.4985 - val_loss: 3.1661 - val_accuracy100: 0.4535 - 19s/epoch - 32ms/step
Epoch 11/50
589/589 - 19s - loss: 2.9512 - accuracy100: 0.5009 - val_loss: 3.1879 - val_accuracy100: 0.4517 - 19s/epoch - 32ms/step
Epoch 12/50
589/589 - 19s - loss: 2.9411 - accuracy100: 0.5063 - val_loss: 3.2044 - val_accuracy100: 0.4507 - 19s/epoch - 33ms/step
Epoch 13/50
589/589 - 20s - loss: 2.9302 - accuracy100: 0.5085 - val_loss: 3.2132 - val_accuracy100: 0.4510 - 20s/epoch - 35ms/step
Epoch 14/50
589/589 - 21s - loss: 2.9226 - accuracy100: 0.5091 - val_loss: 3.2395 - val_accuracy100: 0.4473 - 21s/epoch - 35ms/step
Epoch 15/50
589/589 - 20s - loss: 2.9139 - accuracy100: 0.5117 - val_loss: 3.2366 - val_accuracy100: 0.4450 - 20s/epoch - 34ms/step
Epoch 16/50
589/589 - 19s - loss: 2.9018 - accuracy100: 0.5159 - val_loss: 3.2898 - val_accuracy100: 0.4404 - 19s/epoch - 33ms/step
testing model: results/QRTEA/W0/deepOF_L2/h100
Evaluating performance on  test set...
2359/2359 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0154219
{'0': {'precision': 0.43755299567762085, 'recall': 0.36454121485021135, 'f1-score': 0.39772410400694297, 'support': 174112}, '1': {'precision': 0.49934236044480346, 'recall': 0.7274175595415112, 'f1-score': 0.5921784618045047, 'support': 235382}, '2': {'precision': 0.5068591309753002, 'recall': 0.30217871315411576, 'f1-score': 0.37862762801496197, 'support': 194289}, 'accuracy': 0.4859394848811576, 'macro avg': {'precision': 0.4812514956992415, 'recall': 0.4647124958486128, 'f1-score': 0.4561767312754699, 'support': 603783}, 'weighted avg': {'precision': 0.483943046372125, 'recall': 0.4859394848811576, 'f1-score': 0.4673862515385888, 'support': 603783}}
[[ 63471  72254  38387]
 [ 45427 171221  18734]
 [ 36161  99418  58710]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0171444
{'0': {'precision': 0.47405318504071897, 'recall': 0.35999199439607726, 'f1-score': 0.409223278882468, 'support': 49965}, '1': {'precision': 0.45302889218219256, 'recall': 0.6691008406616821, 'f1-score': 0.5402619745845553, 'support': 51626}, '2': {'precision': 0.5063540753724802, 'recall': 0.3764380103027712, 'f1-score': 0.43183649635036503, 'support': 49113}, 'accuracy': 0.47124163923983436, 'macro avg': {'precision': 0.4778120508651306, 'recall': 0.46851028178684345, 'f1-score': 0.4604405832724628, 'support': 150704}, 'weighted avg': {'precision': 0.47737753929640897, 'recall': 0.47124163923983436, 'f1-score': 0.46148205538353493, 'support': 150704}}
[[17987 20845 11133]
 [10192 34543  6891]
 [ 9764 20861 18488]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0364327
{'0': {'precision': 0.47795741044085177, 'recall': 0.33998682810679365, 'f1-score': 0.397335701598579, 'support': 19739}, '1': {'precision': 0.40873624541513837, 'recall': 0.669397116644823, 'f1-score': 0.507556622914165, 'support': 18312}, '2': {'precision': 0.5033134974303489, 'recall': 0.35838790446841295, 'f1-score': 0.4186635167060412, 'support': 20768}, 'accuracy': 0.44903857597034974, 'macro avg': {'precision': 0.46333571776211296, 'recall': 0.4559239497400099, 'f1-score': 0.4411852804062617, 'support': 58819}, 'weighted avg': {'precision': 0.4653597335107274, 'recall': 0.44903857597034974, 'f1-score': 0.4391810504702496, 'support': 58819}}
[[ 6711  8266  4762]
 [ 3471 12258  2583]
 [ 3859  9466  7443]]
training model: results/QRTEA/W0/deepOF_L2/h200
Epoch 1/50
589/589 - 21s - loss: 3.2935 - accuracy200: 0.3693 - val_loss: 3.3618 - val_accuracy200: 0.3316 - 21s/epoch - 36ms/step
Epoch 2/50
589/589 - 19s - loss: 3.2581 - accuracy200: 0.3878 - val_loss: 3.3624 - val_accuracy200: 0.3325 - 19s/epoch - 33ms/step
Epoch 3/50
589/589 - 19s - loss: 3.2424 - accuracy200: 0.3963 - val_loss: 3.3615 - val_accuracy200: 0.3326 - 19s/epoch - 33ms/step
Epoch 4/50
589/589 - 19s - loss: 3.2328 - accuracy200: 0.4017 - val_loss: 3.3575 - val_accuracy200: 0.3361 - 19s/epoch - 32ms/step
Epoch 5/50
589/589 - 19s - loss: 3.2263 - accuracy200: 0.4060 - val_loss: 3.3572 - val_accuracy200: 0.3363 - 19s/epoch - 32ms/step
Epoch 6/50
589/589 - 18s - loss: 3.2198 - accuracy200: 0.4097 - val_loss: 3.3585 - val_accuracy200: 0.3335 - 18s/epoch - 31ms/step
Epoch 7/50
589/589 - 19s - loss: 3.2148 - accuracy200: 0.4117 - val_loss: 3.3605 - val_accuracy200: 0.3360 - 19s/epoch - 31ms/step
Epoch 8/50
589/589 - 20s - loss: 3.2108 - accuracy200: 0.4146 - val_loss: 3.3656 - val_accuracy200: 0.3331 - 20s/epoch - 34ms/step
Epoch 9/50
589/589 - 19s - loss: 3.2058 - accuracy200: 0.4159 - val_loss: 3.3697 - val_accuracy200: 0.3294 - 19s/epoch - 33ms/step
Epoch 10/50
589/589 - 20s - loss: 3.2023 - accuracy200: 0.4179 - val_loss: 3.3648 - val_accuracy200: 0.3331 - 20s/epoch - 33ms/step
Epoch 11/50
589/589 - 20s - loss: 3.1979 - accuracy200: 0.4195 - val_loss: 3.3609 - val_accuracy200: 0.3366 - 20s/epoch - 34ms/step
Epoch 12/50
589/589 - 19s - loss: 3.1926 - accuracy200: 0.4225 - val_loss: 3.3685 - val_accuracy200: 0.3374 - 19s/epoch - 32ms/step
Epoch 13/50
589/589 - 20s - loss: 3.1887 - accuracy200: 0.4237 - val_loss: 3.3741 - val_accuracy200: 0.3371 - 20s/epoch - 34ms/step
Epoch 14/50
589/589 - 19s - loss: 3.1836 - accuracy200: 0.4266 - val_loss: 3.3645 - val_accuracy200: 0.3396 - 19s/epoch - 32ms/step
Epoch 15/50
589/589 - 18s - loss: 3.1772 - accuracy200: 0.4294 - val_loss: 3.3770 - val_accuracy200: 0.3439 - 18s/epoch - 31ms/step
testing model: results/QRTEA/W0/deepOF_L2/h200
Evaluating performance on  test set...
2359/2359 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0986154
{'0': {'precision': 0.41297990347907515, 'recall': 0.1642121061103378, 'f1-score': 0.23498696657212648, 'support': 174573}, '1': {'precision': 0.3755751198000414, 'recall': 0.8502869912325756, 'f1-score': 0.5210155950208568, 'support': 221958}, '2': {'precision': 0.4199409992467989, 'recall': 0.06456391253160404, 'f1-score': 0.11192057411465565, 'support': 207252}, 'accuracy': 0.38221678980693397, 'macro avg': {'precision': 0.40283200750863846, 'recall': 0.3596876699581724, 'f1-score': 0.2893077119025463, 'support': 603783}, 'weighted avg': {'precision': 0.40161888477570207, 'recall': 0.38221678980693397, 'f1-score': 0.2978913317888145, 'support': 603783}}
[[ 28667 136571   9335]
 [ 24082 188728   9148]
 [ 16666 177205  13381]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1020277
{'0': {'precision': 0.44663879679015905, 'recall': 0.18306974179189728, 'f1-score': 0.25969490388913724, 'support': 50773}, '1': {'precision': 0.346181055505156, 'recall': 0.8325127096593411, 'f1-score': 0.48901612457601706, 'support': 49962}, '2': {'precision': 0.46499692055019504, 'recall': 0.09065620684824591, 'f1-score': 0.15173083686422936, 'support': 49969}, 'accuracy': 0.36773410128463746, 'macro avg': {'precision': 0.41927225761517, 'recall': 0.36874621943316144, 'f1-score': 0.30014728844312794, 'support': 150704}, 'weighted avg': {'precision': 0.41942165203012555, 'recall': 0.36773410128463746, 'f1-score': 0.2999227038333342, 'support': 150704}}
[[ 9295 38463  3015]
 [ 6171 41594  2197]
 [ 5345 40094  4530]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1194255
{'0': {'precision': 0.45555401469976425, 'recall': 0.16664130269365393, 'f1-score': 0.24402020502154212, 'support': 19713}, '1': {'precision': 0.30720628056844185, 'recall': 0.8411886423726865, 'f1-score': 0.4500515091409506, 'support': 17398}, '2': {'precision': 0.48223733938019653, 'recall': 0.08817025981205086, 'f1-score': 0.14908283677999767, 'support': 21708}, 'accuracy': 0.3372039647052823, 'macro avg': {'precision': 0.41499921154946756, 'recall': 0.3653334016261304, 'f1-score': 0.28105151698083014, 'support': 58819}, 'weighted avg': {'precision': 0.4215222857303169, 'recall': 0.3372039647052823, 'f1-score': 0.26992394767752104, 'support': 58819}}
[[ 3285 15209  1219]
 [ 1927 14635   836]
 [ 1999 17795  1914]]
training model: results/QRTEA/W0/deepOF_L2/h300
Epoch 1/50
589/589 - 22s - loss: 3.3138 - accuracy300: 0.3523 - val_loss: 3.3391 - val_accuracy300: 0.3457 - 22s/epoch - 37ms/step
Epoch 2/50
589/589 - 19s - loss: 3.2864 - accuracy300: 0.3661 - val_loss: 3.3231 - val_accuracy300: 0.3468 - 19s/epoch - 32ms/step
Epoch 3/50
589/589 - 19s - loss: 3.2738 - accuracy300: 0.3742 - val_loss: 3.3152 - val_accuracy300: 0.3522 - 19s/epoch - 32ms/step
Epoch 4/50
589/589 - 19s - loss: 3.2656 - accuracy300: 0.3787 - val_loss: 3.3110 - val_accuracy300: 0.3549 - 19s/epoch - 32ms/step
Epoch 5/50
589/589 - 19s - loss: 3.2618 - accuracy300: 0.3820 - val_loss: 3.3123 - val_accuracy300: 0.3544 - 19s/epoch - 32ms/step
Epoch 6/50
589/589 - 18s - loss: 3.2555 - accuracy300: 0.3864 - val_loss: 3.3085 - val_accuracy300: 0.3560 - 18s/epoch - 31ms/step
Epoch 7/50
589/589 - 18s - loss: 3.2521 - accuracy300: 0.3887 - val_loss: 3.3036 - val_accuracy300: 0.3589 - 18s/epoch - 31ms/step
Epoch 8/50
589/589 - 19s - loss: 3.2487 - accuracy300: 0.3886 - val_loss: 3.3102 - val_accuracy300: 0.3562 - 19s/epoch - 32ms/step
Epoch 9/50
589/589 - 18s - loss: 3.2443 - accuracy300: 0.3945 - val_loss: 3.3091 - val_accuracy300: 0.3598 - 18s/epoch - 30ms/step
Epoch 10/50
589/589 - 18s - loss: 3.2403 - accuracy300: 0.3973 - val_loss: 3.3111 - val_accuracy300: 0.3587 - 18s/epoch - 30ms/step
Epoch 11/50
589/589 - 18s - loss: 3.2361 - accuracy300: 0.3996 - val_loss: 3.3113 - val_accuracy300: 0.3609 - 18s/epoch - 30ms/step
Epoch 12/50
589/589 - 18s - loss: 3.2340 - accuracy300: 0.4002 - val_loss: 3.3128 - val_accuracy300: 0.3594 - 18s/epoch - 30ms/step
Epoch 13/50
589/589 - 18s - loss: 3.2303 - accuracy300: 0.4025 - val_loss: 3.3109 - val_accuracy300: 0.3641 - 18s/epoch - 30ms/step
Epoch 14/50
589/589 - 18s - loss: 3.2257 - accuracy300: 0.4052 - val_loss: 3.3204 - val_accuracy300: 0.3648 - 18s/epoch - 30ms/step
Epoch 15/50
589/589 - 18s - loss: 3.2203 - accuracy300: 0.4080 - val_loss: 3.3267 - val_accuracy300: 0.3638 - 18s/epoch - 30ms/step
Epoch 16/50
589/589 - 18s - loss: 3.2163 - accuracy300: 0.4107 - val_loss: 3.3405 - val_accuracy300: 0.3626 - 18s/epoch - 31ms/step
Epoch 17/50
589/589 - 19s - loss: 3.2107 - accuracy300: 0.4142 - val_loss: 3.3371 - val_accuracy300: 0.3674 - 19s/epoch - 32ms/step
testing model: results/QRTEA/W0/deepOF_L2/h300
Evaluating performance on  test set...
2359/2359 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099756
{'0': {'precision': 0.33262331370337883, 'recall': 0.5520852774770836, 'f1-score': 0.4151342855080716, 'support': 187529}, '1': {'precision': 0.32789446961219754, 'recall': 0.34717321864757095, 'f1-score': 0.3372585605021587, 'support': 191596}, '2': {'precision': 0.43046741688321827, 'recall': 0.17180336333449064, 'f1-score': 0.2455896997018971, 'support': 224658}, 'accuracy': 0.34556454885281634, 'macro avg': {'precision': 0.36366173339959823, 'recall': 0.35702061981971506, 'f1-score': 0.33266084857070916, 'support': 603783}, 'weighted avg': {'precision': 0.3675289551667562, 'recall': 0.34556454885281634, 'f1-score': 0.32733746948927606, 'support': 603783}}
[[103532  59396  24601]
 [ 98614  66517  26465]
 [109113  76948  38597]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0883638
{'0': {'precision': 0.37127730832646333, 'recall': 0.5676500708996376, 'f1-score': 0.44892841567503583, 'support': 50776}, '1': {'precision': 0.3629632659739835, 'recall': 0.3499230981582995, 'f1-score': 0.35632391622994597, 'support': 50714}, '2': {'precision': 0.4068238213399504, 'recall': 0.1998821473564433, 'f1-score': 0.268060059405401, 'support': 49214}, 'accuracy': 0.3742833634143752, 'macro avg': {'precision': 0.38035479854679904, 'recall': 0.37248510547146013, 'f1-score': 0.35777079710346094, 'support': 150704}, 'weighted avg': {'precision': 0.3800876102931138, 'recall': 0.3742833634143752, 'f1-score': 0.35870121619584416, 'support': 150704}}
[[28823 14985  6968]
 [25593 17746  7375]
 [23216 16161  9837]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0999508
{'0': {'precision': 0.36787165475690065, 'recall': 0.5334213734254368, 'f1-score': 0.43544240815988056, 'support': 19688}, '1': {'precision': 0.30544776495489595, 'recall': 0.34675896790434235, 'f1-score': 0.32479502706178665, 'support': 17479}, '2': {'precision': 0.4286536248561565, 'recall': 0.2064474413449104, 'f1-score': 0.2786783042394015, 'support': 21652}, 'accuracy': 0.35758853431714244, 'macro avg': {'precision': 0.36732434818931775, 'recall': 0.3622092608915632, 'f1-score': 0.3463052464870229, 'support': 58819}, 'weighted avg': {'precision': 0.3716959980259098, 'recall': 0.35758853431714244, 'f1-score': 0.3448549797387956, 'support': 58819}}
[[10502  6206  2980]
 [ 8440  6061  2978]
 [ 9606  7576  4470]]
training model: results/QRTEA/W0/deepOF_L2/h500
Epoch 1/50
589/589 - 21s - loss: 3.3204 - accuracy500: 0.3451 - val_loss: 3.3479 - val_accuracy500: 0.3353 - 21s/epoch - 35ms/step
Epoch 2/50
589/589 - 19s - loss: 3.2972 - accuracy500: 0.3572 - val_loss: 3.3299 - val_accuracy500: 0.3363 - 19s/epoch - 33ms/step
Epoch 3/50
589/589 - 19s - loss: 3.2869 - accuracy500: 0.3647 - val_loss: 3.3218 - val_accuracy500: 0.3402 - 19s/epoch - 32ms/step
Epoch 4/50
589/589 - 19s - loss: 3.2806 - accuracy500: 0.3692 - val_loss: 3.3201 - val_accuracy500: 0.3393 - 19s/epoch - 32ms/step
Epoch 5/50
589/589 - 19s - loss: 3.2760 - accuracy500: 0.3740 - val_loss: 3.3188 - val_accuracy500: 0.3370 - 19s/epoch - 32ms/step
Epoch 6/50
589/589 - 19s - loss: 3.2720 - accuracy500: 0.3772 - val_loss: 3.3197 - val_accuracy500: 0.3430 - 19s/epoch - 32ms/step
Epoch 7/50
589/589 - 19s - loss: 3.2693 - accuracy500: 0.3783 - val_loss: 3.3215 - val_accuracy500: 0.3421 - 19s/epoch - 32ms/step
Epoch 8/50
589/589 - 18s - loss: 3.2662 - accuracy500: 0.3812 - val_loss: 3.3221 - val_accuracy500: 0.3454 - 18s/epoch - 31ms/step
Epoch 9/50
589/589 - 18s - loss: 3.2630 - accuracy500: 0.3823 - val_loss: 3.3194 - val_accuracy500: 0.3461 - 18s/epoch - 31ms/step
Epoch 10/50
589/589 - 18s - loss: 3.2596 - accuracy500: 0.3863 - val_loss: 3.3244 - val_accuracy500: 0.3444 - 18s/epoch - 31ms/step
Epoch 11/50
589/589 - 18s - loss: 3.2570 - accuracy500: 0.3888 - val_loss: 3.3244 - val_accuracy500: 0.3439 - 18s/epoch - 31ms/step
Epoch 12/50
589/589 - 19s - loss: 3.2546 - accuracy500: 0.3902 - val_loss: 3.3334 - val_accuracy500: 0.3424 - 19s/epoch - 32ms/step
Epoch 13/50
589/589 - 18s - loss: 3.2513 - accuracy500: 0.3923 - val_loss: 3.3343 - val_accuracy500: 0.3483 - 18s/epoch - 31ms/step
Epoch 14/50
589/589 - 19s - loss: 3.2491 - accuracy500: 0.3946 - val_loss: 3.3362 - val_accuracy500: 0.3495 - 19s/epoch - 33ms/step
Epoch 15/50
589/589 - 19s - loss: 3.2465 - accuracy500: 0.3974 - val_loss: 3.3316 - val_accuracy500: 0.3487 - 19s/epoch - 32ms/step
testing model: results/QRTEA/W0/deepOF_L2/h500
Evaluating performance on  test set...
2359/2359 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1125993
{'0': {'precision': 0.3552358360605063, 'recall': 0.5169823868248364, 'f1-score': 0.4211117483988146, 'support': 204506}, '1': {'precision': 0.28351577063313105, 'recall': 0.43967685436022375, 'f1-score': 0.3447361543396137, 'support': 165003}, '2': {'precision': 0.38966463778493854, 'recall': 0.0836200346602696, 'f1-score': 0.13769205898477585, 'support': 234274}, 'accuracy': 0.3277071398167885, 'macro avg': {'precision': 0.34280541482619203, 'recall': 0.34675975861510994, 'f1-score': 0.30117998724106804, 'support': 603783}, 'weighted avg': {'precision': 0.3489947645819725, 'recall': 0.3277071398167885, 'f1-score': 0.290269928631887, 'support': 603783}}
[[105726  81103  17677]
 [ 79448  72548  13007]
 [112448 102236  19590]]
Evaluating performance on  train set...
589/589 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0971202
{'0': {'precision': 0.3776665687914108, 'recall': 0.5594047236351947, 'f1-score': 0.45091225021720244, 'support': 52883}, '1': {'precision': 0.3341711085621753, 'recall': 0.41988470179305665, 'f1-score': 0.37215636916950007, 'support': 47182}, '2': {'precision': 0.4032393612957445, 'recall': 0.10422796658701791, 'f1-score': 0.1656414762741652, 'support': 50639}, 'accuracy': 0.36277736490073254, 'macro avg': {'precision': 0.3716923462164436, 'recall': 0.36117246400508973, 'f1-score': 0.3295700318869559, 'support': 150704}, 'weighted avg': {'precision': 0.3726420029875248, 'recall': 0.36277736490073254, 'f1-score': 0.3303999433023617, 'support': 150704}}
[[29583 19072  4228]
 [23788 19811  3583]
 [24960 20401  5278]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1089915
{'0': {'precision': 0.36577861687993846, 'recall': 0.5193863873305863, 'f1-score': 0.42925428249051184, 'support': 20143}, '1': {'precision': 0.2910618792971734, 'recall': 0.4377721335268505, 'f1-score': 0.3496510251889777, 'support': 16536}, '2': {'precision': 0.4169472502805836, 'recall': 0.10067750677506775, 'f1-score': 0.16219166120934292, 'support': 22140}, 'accuracy': 0.3388360903789592, 'macro avg': {'precision': 0.3579292488192318, 'recall': 0.35261200921083485, 'f1-score': 0.31369898962961085, 'support': 58819}, 'weighted avg': {'precision': 0.36403356121462077, 'recall': 0.3388360903789592, 'f1-score': 0.3063503586240189, 'support': 58819}}
[[10462  7964  1717]
 [ 7897  7239  1400]
 [10243  9668  2229]]
training model: results/QRTEA/W0/deepOF_L2/h1000
Epoch 1/50
589/589 - 20s - loss: 3.3163 - accuracy1000: 0.3650 - val_loss: 3.4289 - val_accuracy1000: 0.3213 - 20s/epoch - 35ms/step
Epoch 2/50
589/589 - 18s - loss: 3.2987 - accuracy1000: 0.3682 - val_loss: 3.4165 - val_accuracy1000: 0.3229 - 18s/epoch - 31ms/step
Epoch 3/50
589/589 - 18s - loss: 3.2884 - accuracy1000: 0.3688 - val_loss: 3.4026 - val_accuracy1000: 0.3235 - 18s/epoch - 31ms/step
Epoch 4/50
589/589 - 18s - loss: 3.2835 - accuracy1000: 0.3705 - val_loss: 3.3940 - val_accuracy1000: 0.3244 - 18s/epoch - 31ms/step
Epoch 5/50
589/589 - 18s - loss: 3.2795 - accuracy1000: 0.3732 - val_loss: 3.3843 - val_accuracy1000: 0.3253 - 18s/epoch - 31ms/step
Epoch 6/50
589/589 - 18s - loss: 3.2755 - accuracy1000: 0.3743 - val_loss: 3.3741 - val_accuracy1000: 0.3257 - 18s/epoch - 31ms/step
Epoch 7/50
589/589 - 19s - loss: 3.2727 - accuracy1000: 0.3773 - val_loss: 3.3811 - val_accuracy1000: 0.3276 - 19s/epoch - 31ms/step
Epoch 8/50
589/589 - 19s - loss: 3.2710 - accuracy1000: 0.3786 - val_loss: 3.3754 - val_accuracy1000: 0.3268 - 19s/epoch - 32ms/step
Epoch 9/50
589/589 - 18s - loss: 3.2679 - accuracy1000: 0.3802 - val_loss: 3.3773 - val_accuracy1000: 0.3261 - 18s/epoch - 31ms/step
Epoch 10/50
589/589 - 18s - loss: 3.2658 - accuracy1000: 0.3819 - val_loss: 3.3801 - val_accuracy1000: 0.3258 - 18s/epoch - 31ms/step
Epoch 11/50
589/589 - 19s - loss: 3.2631 - accuracy1000: 0.3843 - val_loss: 3.3886 - val_accuracy1000: 0.3258 - 19s/epoch - 32ms/step
Epoch 12/50
589/589 - 19s - loss: 3.2608 - accuracy1000: 0.3851 - val_loss: 3.3959 - val_accuracy1000: 0.3262 - 19s/epoch - 33ms/step
Epoch 13/50
589/589 - 19s - loss: 3.2577 - accuracy1000: 0.3877 - val_loss: 3.3961 - val_accuracy1000: 0.3270 - 19s/epoch - 32ms/step
Epoch 14/50
589/589 - 19s - loss: 3.2544 - accuracy1000: 0.3886 - val_loss: 3.4119 - val_accuracy1000: 0.3274 - 19s/epoch - 32ms/step
Epoch 15/50
589/589 - 18s - loss: 3.2527 - accuracy1000: 0.3910 - val_loss: 3.4133 - val_accuracy1000: 0.3273 - 18s/epoch - 31ms/step
Epoch 16/50
589/589 - 18s - loss: 3.2504 - accuracy1000: 0.3919 - val_loss: 3.4135 - val_accuracy1000: 0.3267 - 18s/epoch - 31ms/step
testing model: results/QRTEA/W0/deepOF_L2/h1000
Evaluating performance on  test set...
2359/2359 - 32s - 32s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993572
{'0': {'precision': 0.3435291093689757, 'recall': 0.04390628507602429, 'f1-score': 0.07786117233544679, 'support': 182639}, '1': {'precision': 0.38194171433515856, 'recall': 0.896416083916084, 'f1-score': 0.535653940261299, 'support': 226512}, '2': {'precision': 0.3480959501812893, 'recall': 0.08730835628262568, 'f1-score': 0.13960213432792906, 'support': 194632}, 'accuracy': 0.3777201411765485, 'macro avg': {'precision': 0.35785559129514116, 'recall': 0.34254357509157796, 'f1-score': 0.2510390823082249, 'support': 603783}, 'weighted avg': {'precision': 0.3594119171609842, 'recall': 0.3777201411765485, 'f1-score': 0.26950671777634433, 'support': 603783}}
[[  8019 157978  16642]
 [  8281 203049  15182]
 [  7043 170596  16993]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1080463
{'0': {'precision': 0.41515010110437084, 'recall': 0.05173683802434675, 'f1-score': 0.09200751503869556, 'support': 51588}, '1': {'precision': 0.34270405836753304, 'recall': 0.8910075283052421, 'f1-score': 0.4950134201296455, 'support': 50609}, '2': {'precision': 0.3850334777471445, 'recall': 0.1007689611808605, 'f1-score': 0.1597333420476455, 'support': 48507}, 'accuracy': 0.34936033549209045, 'macro avg': {'precision': 0.3809625457396828, 'recall': 0.34783777583681647, 'f1-score': 0.24891809240532883, 'support': 150704}, 'weighted avg': {'precision': 0.3811278533467957, 'recall': 0.34936033549209045, 'f1-score': 0.2491427107964128, 'support': 150704}}
[[ 2669 44677  4242]
 [ 1951 45093  3565]
 [ 1809 41810  4888]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1212337
{'0': {'precision': 0.3749504558065795, 'recall': 0.0479983763762748, 'f1-score': 0.08510255487585464, 'support': 19709}, '1': {'precision': 0.3186344238975818, 'recall': 0.8910686066154433, 'f1-score': 0.46941294674895934, 'support': 18351}, '2': {'precision': 0.3881856540084388, 'recall': 0.09306806686256563, 'f1-score': 0.15013988187752567, 'support': 20759}, 'accuracy': 0.32693517400839867, 'macro avg': {'precision': 0.3605901779042, 'recall': 0.34404501661809456, 'f1-score': 0.23488512783411322, 'support': 58819}, 'weighted avg': {'precision': 0.3620514602083949, 'recall': 0.32693517400839867, 'f1-score': 0.22795758254533274, 'support': 58819}}
[[  946 17020  1743]
 [  697 16352  1302]
 [  880 17947  1932]]
training model: results/QRTEA/W0/deepVOL_L2/h10
Epoch 1/50
589/589 - 26s - loss: 2.9306 - accuracy10: 0.4913 - val_loss: 2.9172 - val_accuracy10: 0.5094 - 26s/epoch - 45ms/step
Epoch 2/50
589/589 - 18s - loss: 2.6567 - accuracy10: 0.5696 - val_loss: 2.8710 - val_accuracy10: 0.4886 - 18s/epoch - 31ms/step
Epoch 3/50
589/589 - 19s - loss: 2.5904 - accuracy10: 0.5831 - val_loss: 2.8639 - val_accuracy10: 0.5091 - 19s/epoch - 32ms/step
Epoch 4/50
589/589 - 18s - loss: 2.5475 - accuracy10: 0.5954 - val_loss: 2.8223 - val_accuracy10: 0.5113 - 18s/epoch - 31ms/step
Epoch 5/50
589/589 - 19s - loss: 2.5240 - accuracy10: 0.6009 - val_loss: 2.8228 - val_accuracy10: 0.5332 - 19s/epoch - 32ms/step
Epoch 6/50
589/589 - 19s - loss: 2.5091 - accuracy10: 0.6029 - val_loss: 2.7861 - val_accuracy10: 0.5514 - 19s/epoch - 32ms/step
Epoch 7/50
589/589 - 18s - loss: 2.4926 - accuracy10: 0.6070 - val_loss: 2.7992 - val_accuracy10: 0.5404 - 18s/epoch - 31ms/step
Epoch 8/50
589/589 - 18s - loss: 2.4828 - accuracy10: 0.6088 - val_loss: 2.8033 - val_accuracy10: 0.5617 - 18s/epoch - 31ms/step
Epoch 9/50
589/589 - 18s - loss: 2.4660 - accuracy10: 0.6136 - val_loss: 2.7710 - val_accuracy10: 0.5618 - 18s/epoch - 31ms/step
Epoch 10/50
589/589 - 18s - loss: 2.4564 - accuracy10: 0.6172 - val_loss: 2.7514 - val_accuracy10: 0.5611 - 18s/epoch - 31ms/step
Epoch 11/50
589/589 - 19s - loss: 2.4430 - accuracy10: 0.6193 - val_loss: 2.7631 - val_accuracy10: 0.5584 - 19s/epoch - 32ms/step
Epoch 12/50
589/589 - 19s - loss: 2.4327 - accuracy10: 0.6221 - val_loss: 2.7446 - val_accuracy10: 0.5555 - 19s/epoch - 33ms/step
Epoch 13/50
589/589 - 18s - loss: 2.4228 - accuracy10: 0.6206 - val_loss: 2.7324 - val_accuracy10: 0.5641 - 18s/epoch - 31ms/step
Epoch 14/50
589/589 - 18s - loss: 2.4119 - accuracy10: 0.6241 - val_loss: 2.7565 - val_accuracy10: 0.5670 - 18s/epoch - 31ms/step
Epoch 15/50
589/589 - 18s - loss: 2.4000 - accuracy10: 0.6261 - val_loss: 2.7418 - val_accuracy10: 0.5658 - 18s/epoch - 31ms/step
Epoch 16/50
589/589 - 18s - loss: 2.3894 - accuracy10: 0.6266 - val_loss: 2.7263 - val_accuracy10: 0.5603 - 18s/epoch - 31ms/step
Epoch 17/50
589/589 - 19s - loss: 2.3742 - accuracy10: 0.6287 - val_loss: 2.7293 - val_accuracy10: 0.5588 - 19s/epoch - 32ms/step
Epoch 18/50
589/589 - 20s - loss: 2.3682 - accuracy10: 0.6297 - val_loss: 2.6999 - val_accuracy10: 0.5667 - 20s/epoch - 34ms/step
Epoch 19/50
589/589 - 19s - loss: 2.3562 - accuracy10: 0.6309 - val_loss: 2.6663 - val_accuracy10: 0.5834 - 19s/epoch - 33ms/step
Epoch 20/50
589/589 - 20s - loss: 2.3452 - accuracy10: 0.6339 - val_loss: 2.6917 - val_accuracy10: 0.5756 - 20s/epoch - 34ms/step
Epoch 21/50
589/589 - 20s - loss: 2.3339 - accuracy10: 0.6338 - val_loss: 2.6960 - val_accuracy10: 0.5786 - 20s/epoch - 34ms/step
Epoch 22/50
589/589 - 19s - loss: 2.3286 - accuracy10: 0.6350 - val_loss: 2.6967 - val_accuracy10: 0.5812 - 19s/epoch - 32ms/step
Epoch 23/50
589/589 - 18s - loss: 2.3173 - accuracy10: 0.6360 - val_loss: 2.7100 - val_accuracy10: 0.5747 - 18s/epoch - 31ms/step
Epoch 24/50
589/589 - 18s - loss: 2.3115 - accuracy10: 0.6359 - val_loss: 2.6923 - val_accuracy10: 0.5752 - 18s/epoch - 31ms/step
Epoch 25/50
589/589 - 19s - loss: 2.2976 - accuracy10: 0.6383 - val_loss: 2.7085 - val_accuracy10: 0.5825 - 19s/epoch - 33ms/step
Epoch 26/50
589/589 - 20s - loss: 2.2883 - accuracy10: 0.6398 - val_loss: 2.7264 - val_accuracy10: 0.5792 - 20s/epoch - 34ms/step
Epoch 27/50
589/589 - 21s - loss: 2.2825 - accuracy10: 0.6415 - val_loss: 2.7175 - val_accuracy10: 0.5739 - 21s/epoch - 36ms/step
Epoch 28/50
589/589 - 19s - loss: 2.2745 - accuracy10: 0.6402 - val_loss: 2.7476 - val_accuracy10: 0.5760 - 19s/epoch - 32ms/step
Epoch 29/50
589/589 - 19s - loss: 2.2647 - accuracy10: 0.6432 - val_loss: 2.6893 - val_accuracy10: 0.5877 - 19s/epoch - 31ms/step
testing model: results/QRTEA/W0/deepVOL_L2/h10
Evaluating performance on  test set...
2359/2359 - 39s - 39s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81770736
{'0': {'precision': 0.41439783869390034, 'recall': 0.432940775706847, 'f1-score': 0.42346641280418873, 'support': 82196}, '1': {'precision': 0.8974683630241147, 'recall': 0.6032693145802577, 'f1-score': 0.7215319936303386, 'support': 438257}, '2': {'precision': 0.2926223121770358, 'recall': 0.7841723165536689, 'f1-score': 0.42620256508085574, 'support': 83335}, 'accuracy': 0.6050501169284583, 'macro avg': {'precision': 0.5348295046316837, 'recall': 0.6067941356135912, 'f1-score': 0.5237336571717943, 'support': 603788}, 'weighted avg': {'precision': 0.7482250682498105, 'recall': 0.6050501169284583, 'f1-score': 0.6401937152780736, 'support': 603788}}
[[ 35586  19552  27058]
 [ 42955 264387 130915]
 [  7333  10653  65349]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82964295
{'0': {'precision': 0.39599540874888406, 'recall': 0.531336898395722, 'f1-score': 0.45378980251740075, 'support': 23375}, '1': {'precision': 0.8741412705711857, 'recall': 0.6018401258730525, 'f1-score': 0.7128725247876361, 'support': 104232}, '2': {'precision': 0.34234309975198624, 'recall': 0.7051692787254308, 'f1-score': 0.46092025581526974, 'support': 23098}, 'accuracy': 0.6067416475896619, 'macro avg': {'precision': 0.5374932596906854, 'recall': 0.6127821009980684, 'f1-score': 0.5425275277067688, 'support': 150705}, 'weighted avg': {'precision': 0.7184720248946775, 'recall': 0.6067416475896619, 'f1-score': 0.634071873569757, 'support': 150705}}
[[12420  4930  6025]
 [16236 62731 25265]
 [ 2708  4102 16288]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87063617
{'0': {'precision': 0.4228255867464335, 'recall': 0.4860347016504443, 'f1-score': 0.4522321208839888, 'support': 9452}, '1': {'precision': 0.8514977216702772, 'recall': 0.5703349761088735, 'f1-score': 0.6831168442027357, 'support': 39973}, '2': {'precision': 0.32127850431990934, 'recall': 0.7243214475784993, 'f1-score': 0.4451203558346415, 'support': 9395}, 'accuracy': 0.5813838830329819, 'macro avg': {'precision': 0.5318672709122066, 'recall': 0.593563708445939, 'f1-score': 0.5268231069737886, 'support': 58820}, 'weighted avg': {'precision': 0.6979237916072565, 'recall': 0.5813838830329819, 'f1-score': 0.6080012472454586, 'support': 58820}}
[[ 4594  2355  2503]
 [ 5302 22798 11873]
 [  969  1621  6805]]
training model: results/QRTEA/W0/deepVOL_L2/h20
Epoch 1/50
589/589 - 22s - loss: 2.9770 - accuracy20: 0.5001 - val_loss: 3.0387 - val_accuracy20: 0.4628 - 22s/epoch - 37ms/step
Epoch 2/50
589/589 - 19s - loss: 2.7508 - accuracy20: 0.5665 - val_loss: 2.9117 - val_accuracy20: 0.4733 - 19s/epoch - 32ms/step
Epoch 3/50
589/589 - 19s - loss: 2.6820 - accuracy20: 0.5828 - val_loss: 2.8798 - val_accuracy20: 0.5064 - 19s/epoch - 31ms/step
Epoch 4/50
589/589 - 20s - loss: 2.6425 - accuracy20: 0.5910 - val_loss: 2.8593 - val_accuracy20: 0.4916 - 20s/epoch - 33ms/step
Epoch 5/50
589/589 - 19s - loss: 2.6235 - accuracy20: 0.5967 - val_loss: 2.8961 - val_accuracy20: 0.4941 - 19s/epoch - 31ms/step
Epoch 6/50
589/589 - 19s - loss: 2.6088 - accuracy20: 0.5983 - val_loss: 2.8954 - val_accuracy20: 0.5247 - 19s/epoch - 32ms/step
Epoch 7/50
589/589 - 19s - loss: 2.5980 - accuracy20: 0.6010 - val_loss: 2.8618 - val_accuracy20: 0.5207 - 19s/epoch - 32ms/step
Epoch 8/50
589/589 - 19s - loss: 2.5842 - accuracy20: 0.6045 - val_loss: 2.8512 - val_accuracy20: 0.5362 - 19s/epoch - 32ms/step
Epoch 9/50
589/589 - 19s - loss: 2.5749 - accuracy20: 0.6064 - val_loss: 2.8121 - val_accuracy20: 0.5503 - 19s/epoch - 31ms/step
Epoch 10/50
589/589 - 18s - loss: 2.5656 - accuracy20: 0.6078 - val_loss: 2.8151 - val_accuracy20: 0.5339 - 18s/epoch - 31ms/step
Epoch 11/50
589/589 - 18s - loss: 2.5559 - accuracy20: 0.6120 - val_loss: 2.8099 - val_accuracy20: 0.5464 - 18s/epoch - 31ms/step
Epoch 12/50
589/589 - 19s - loss: 2.5476 - accuracy20: 0.6118 - val_loss: 2.7985 - val_accuracy20: 0.5554 - 19s/epoch - 32ms/step
Epoch 13/50
589/589 - 19s - loss: 2.5357 - accuracy20: 0.6143 - val_loss: 2.8010 - val_accuracy20: 0.5537 - 19s/epoch - 33ms/step
Epoch 14/50
589/589 - 20s - loss: 2.5272 - accuracy20: 0.6148 - val_loss: 2.7920 - val_accuracy20: 0.5497 - 20s/epoch - 34ms/step
Epoch 15/50
589/589 - 20s - loss: 2.5174 - accuracy20: 0.6164 - val_loss: 2.7996 - val_accuracy20: 0.5542 - 20s/epoch - 34ms/step
Epoch 16/50
589/589 - 19s - loss: 2.5074 - accuracy20: 0.6188 - val_loss: 2.8016 - val_accuracy20: 0.5533 - 19s/epoch - 33ms/step
Epoch 17/50
589/589 - 18s - loss: 2.5023 - accuracy20: 0.6199 - val_loss: 2.7837 - val_accuracy20: 0.5484 - 18s/epoch - 31ms/step
Epoch 18/50
589/589 - 18s - loss: 2.4919 - accuracy20: 0.6208 - val_loss: 2.7895 - val_accuracy20: 0.5645 - 18s/epoch - 31ms/step
Epoch 19/50
589/589 - 19s - loss: 2.4800 - accuracy20: 0.6216 - val_loss: 2.7860 - val_accuracy20: 0.5658 - 19s/epoch - 32ms/step
Epoch 20/50
589/589 - 18s - loss: 2.4727 - accuracy20: 0.6221 - val_loss: 2.7868 - val_accuracy20: 0.5645 - 18s/epoch - 31ms/step
Epoch 21/50
589/589 - 18s - loss: 2.4600 - accuracy20: 0.6245 - val_loss: 2.7800 - val_accuracy20: 0.5670 - 18s/epoch - 31ms/step
Epoch 22/50
589/589 - 18s - loss: 2.4544 - accuracy20: 0.6246 - val_loss: 2.7798 - val_accuracy20: 0.5650 - 18s/epoch - 31ms/step
Epoch 23/50
589/589 - 18s - loss: 2.4401 - accuracy20: 0.6259 - val_loss: 2.7525 - val_accuracy20: 0.5720 - 18s/epoch - 31ms/step
Epoch 24/50
589/589 - 18s - loss: 2.4344 - accuracy20: 0.6273 - val_loss: 2.7469 - val_accuracy20: 0.5638 - 18s/epoch - 31ms/step
Epoch 25/50
589/589 - 17s - loss: 2.4237 - accuracy20: 0.6292 - val_loss: 2.7408 - val_accuracy20: 0.5656 - 17s/epoch - 29ms/step
Epoch 26/50
589/589 - 18s - loss: 2.4133 - accuracy20: 0.6299 - val_loss: 2.7583 - val_accuracy20: 0.5679 - 18s/epoch - 30ms/step
Epoch 27/50
589/589 - 18s - loss: 2.4047 - accuracy20: 0.6299 - val_loss: 2.7412 - val_accuracy20: 0.5767 - 18s/epoch - 31ms/step
Epoch 28/50
589/589 - 18s - loss: 2.3980 - accuracy20: 0.6324 - val_loss: 2.7361 - val_accuracy20: 0.5800 - 18s/epoch - 31ms/step
Epoch 29/50
589/589 - 18s - loss: 2.3891 - accuracy20: 0.6330 - val_loss: 2.7492 - val_accuracy20: 0.5676 - 18s/epoch - 31ms/step
Epoch 30/50
589/589 - 18s - loss: 2.3805 - accuracy20: 0.6332 - val_loss: 2.7536 - val_accuracy20: 0.5715 - 18s/epoch - 31ms/step
Epoch 31/50
589/589 - 18s - loss: 2.3752 - accuracy20: 0.6340 - val_loss: 2.7707 - val_accuracy20: 0.5598 - 18s/epoch - 31ms/step
Epoch 32/50
589/589 - 18s - loss: 2.3664 - accuracy20: 0.6343 - val_loss: 2.7614 - val_accuracy20: 0.5582 - 18s/epoch - 31ms/step
Epoch 33/50
589/589 - 18s - loss: 2.3581 - accuracy20: 0.6354 - val_loss: 2.7722 - val_accuracy20: 0.5721 - 18s/epoch - 31ms/step
Epoch 34/50
589/589 - 18s - loss: 2.3531 - accuracy20: 0.6362 - val_loss: 2.7594 - val_accuracy20: 0.5712 - 18s/epoch - 31ms/step
Epoch 35/50
589/589 - 18s - loss: 2.3487 - accuracy20: 0.6359 - val_loss: 2.7563 - val_accuracy20: 0.5717 - 18s/epoch - 30ms/step
Epoch 36/50
589/589 - 18s - loss: 2.3355 - accuracy20: 0.6395 - val_loss: 2.7764 - val_accuracy20: 0.5699 - 18s/epoch - 31ms/step
Epoch 37/50
589/589 - 19s - loss: 2.3298 - accuracy20: 0.6384 - val_loss: 2.7587 - val_accuracy20: 0.5713 - 19s/epoch - 32ms/step
Epoch 38/50
589/589 - 18s - loss: 2.3220 - accuracy20: 0.6398 - val_loss: 2.7922 - val_accuracy20: 0.5681 - 18s/epoch - 31ms/step
testing model: results/QRTEA/W0/deepVOL_L2/h20
Evaluating performance on  test set...
2359/2359 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8507131
{'0': {'precision': 0.44629793837286635, 'recall': 0.45516461777589373, 'f1-score': 0.4506876722678494, 'support': 106155}, '1': {'precision': 0.8407833469306324, 'recall': 0.6065922655001003, 'f1-score': 0.7047412859926391, 'support': 389062}, '2': {'precision': 0.3591194939277851, 'recall': 0.7105949102430668, 'f1-score': 0.47711516935578635, 'support': 108571}, 'accuracy': 0.5986703942443374, 'macro avg': {'precision': 0.5487335930770946, 'recall': 0.5907839311730202, 'f1-score': 0.5441813758720916, 'support': 603788}, 'weighted avg': {'precision': 0.684815814071712, 'recall': 0.5986703942443374, 'f1-score': 0.6191439298439002, 'support': 603788}}
[[ 48318  26633  31204]
 [ 46583 236002 106477]
 [ 13363  18058  77150]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8630876
{'0': {'precision': 0.42547854463981294, 'recall': 0.573440115534841, 'f1-score': 0.48850116735869364, 'support': 30467}, '1': {'precision': 0.8092467202708421, 'recall': 0.5930639551627124, 'f1-score': 0.6844917735192974, 'support': 90282}, '2': {'precision': 0.4250787736608478, 'recall': 0.6169715582854853, 'f1-score': 0.5033567100156601, 'support': 29956}, 'accuracy': 0.5938489101224246, 'macro avg': {'precision': 0.5532680128571675, 'recall': 0.5944918763276795, 'f1-score': 0.5587832169645504, 'support': 150705}, 'weighted avg': {'precision': 0.6553009320382052, 'recall': 0.5938489101224246, 'f1-score': 0.6088650341263769, 'support': 150705}}
[[17471  6483  6513]
 [18255 53543 18484]
 [ 5336  6138 18482]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89416575
{'0': {'precision': 0.4489329268292683, 'recall': 0.5296329600261588, 'f1-score': 0.4859553722107632, 'support': 12233}, '1': {'precision': 0.7871534011569918, 'recall': 0.5748666996882376, 'f1-score': 0.6644663725457179, 'support': 34321}, '2': {'precision': 0.4026289913574497, 'recall': 0.6342736018261862, 'f1-score': 0.49257652980467875, 'support': 12266}, 'accuracy': 0.5778476708602516, 'macro avg': {'precision': 0.5462384397812367, 'recall': 0.5795910871801943, 'f1-score': 0.5476660915203866, 'support': 58820}, 'weighted avg': {'precision': 0.6366259024651825, 'recall': 0.5778476708602516, 'f1-score': 0.5914958543859239, 'support': 58820}}
[[ 6479  2883  2871]
 [ 5919 19730  8672]
 [ 2034  2452  7780]]
training model: results/QRTEA/W0/deepVOL_L2/h30
Epoch 1/50
589/589 - 20s - loss: 3.0447 - accuracy30: 0.4817 - val_loss: 3.0336 - val_accuracy30: 0.4891 - 20s/epoch - 35ms/step
Epoch 2/50
589/589 - 18s - loss: 2.8048 - accuracy30: 0.5578 - val_loss: 3.0001 - val_accuracy30: 0.5069 - 18s/epoch - 31ms/step
Epoch 3/50
589/589 - 18s - loss: 2.7469 - accuracy30: 0.5725 - val_loss: 2.9360 - val_accuracy30: 0.4981 - 18s/epoch - 31ms/step
Epoch 4/50
589/589 - 18s - loss: 2.7168 - accuracy30: 0.5785 - val_loss: 2.9289 - val_accuracy30: 0.5085 - 18s/epoch - 30ms/step
Epoch 5/50
589/589 - 19s - loss: 2.7007 - accuracy30: 0.5813 - val_loss: 2.9368 - val_accuracy30: 0.5327 - 19s/epoch - 32ms/step
Epoch 6/50
589/589 - 19s - loss: 2.6865 - accuracy30: 0.5847 - val_loss: 2.9618 - val_accuracy30: 0.5148 - 19s/epoch - 32ms/step
Epoch 7/50
589/589 - 21s - loss: 2.6728 - accuracy30: 0.5868 - val_loss: 2.9256 - val_accuracy30: 0.5417 - 21s/epoch - 36ms/step
Epoch 8/50
589/589 - 20s - loss: 2.6622 - accuracy30: 0.5892 - val_loss: 2.9337 - val_accuracy30: 0.5378 - 20s/epoch - 34ms/step
Epoch 9/50
589/589 - 18s - loss: 2.6510 - accuracy30: 0.5926 - val_loss: 2.9335 - val_accuracy30: 0.5411 - 18s/epoch - 30ms/step
Epoch 10/50
589/589 - 18s - loss: 2.6431 - accuracy30: 0.5941 - val_loss: 2.9188 - val_accuracy30: 0.5541 - 18s/epoch - 30ms/step
Epoch 11/50
589/589 - 18s - loss: 2.6331 - accuracy30: 0.5947 - val_loss: 2.9165 - val_accuracy30: 0.5533 - 18s/epoch - 31ms/step
Epoch 12/50
589/589 - 18s - loss: 2.6257 - accuracy30: 0.5974 - val_loss: 2.9097 - val_accuracy30: 0.5530 - 18s/epoch - 31ms/step
Epoch 13/50
589/589 - 18s - loss: 2.6160 - accuracy30: 0.5991 - val_loss: 2.9231 - val_accuracy30: 0.5541 - 18s/epoch - 31ms/step
Epoch 14/50
589/589 - 18s - loss: 2.6082 - accuracy30: 0.6011 - val_loss: 2.9121 - val_accuracy30: 0.5593 - 18s/epoch - 31ms/step
Epoch 15/50
589/589 - 18s - loss: 2.6027 - accuracy30: 0.6032 - val_loss: 2.9017 - val_accuracy30: 0.5604 - 18s/epoch - 31ms/step
Epoch 16/50
589/589 - 18s - loss: 2.5955 - accuracy30: 0.6029 - val_loss: 2.9230 - val_accuracy30: 0.5586 - 18s/epoch - 31ms/step
Epoch 17/50
589/589 - 18s - loss: 2.5854 - accuracy30: 0.6046 - val_loss: 2.9228 - val_accuracy30: 0.5596 - 18s/epoch - 30ms/step
Epoch 18/50
589/589 - 18s - loss: 2.5792 - accuracy30: 0.6055 - val_loss: 2.9261 - val_accuracy30: 0.5576 - 18s/epoch - 30ms/step
Epoch 19/50
589/589 - 18s - loss: 2.5718 - accuracy30: 0.6065 - val_loss: 2.9209 - val_accuracy30: 0.5589 - 18s/epoch - 30ms/step
Epoch 20/50
589/589 - 18s - loss: 2.5642 - accuracy30: 0.6079 - val_loss: 2.9118 - val_accuracy30: 0.5585 - 18s/epoch - 31ms/step
Epoch 21/50
589/589 - 18s - loss: 2.5554 - accuracy30: 0.6077 - val_loss: 2.9336 - val_accuracy30: 0.5546 - 18s/epoch - 31ms/step
Epoch 22/50
589/589 - 18s - loss: 2.5485 - accuracy30: 0.6095 - val_loss: 2.9473 - val_accuracy30: 0.5435 - 18s/epoch - 31ms/step
Epoch 23/50
589/589 - 19s - loss: 2.5424 - accuracy30: 0.6094 - val_loss: 2.9432 - val_accuracy30: 0.5480 - 19s/epoch - 32ms/step
Epoch 24/50
589/589 - 18s - loss: 2.5331 - accuracy30: 0.6089 - val_loss: 2.9270 - val_accuracy30: 0.5503 - 18s/epoch - 31ms/step
Epoch 25/50
589/589 - 18s - loss: 2.5243 - accuracy30: 0.6108 - val_loss: 2.9241 - val_accuracy30: 0.5571 - 18s/epoch - 30ms/step
testing model: results/QRTEA/W0/deepVOL_L2/h30
Evaluating performance on  test set...
2359/2359 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8862267
{'0': {'precision': 0.47786022547119955, 'recall': 0.3571399185419838, 'f1-score': 0.40877349117329903, 'support': 121535}, '1': {'precision': 0.7472533842534184, 'recall': 0.6151391134465104, 'f1-score': 0.6747905395626965, 'support': 356256}, '2': {'precision': 0.37741139626557907, 'recall': 0.6580474138273134, 'f1-score': 0.4796996091795083, 'support': 125997}, 'accuracy': 0.5721610896539845, 'macro avg': {'precision': 0.5341750019967323, 'recall': 0.5434421486052692, 'f1-score': 0.5210878799718346, 'support': 603788}, 'weighted avg': {'precision': 0.6158501789676214, 'recall': 0.5721610896539845, 'f1-score': 0.5805335256248642, 'support': 603788}}
[[ 43405  42685  35445]
 [ 35780 219147 101329]
 [ 11647  31438  82912]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8922653
{'0': {'precision': 0.45956869250490123, 'recall': 0.4359531916111127, 'f1-score': 0.4474495639150735, 'support': 34951}, '1': {'precision': 0.6957472817345429, 'recall': 0.6637532070561373, 'f1-score': 0.679373774940946, 'support': 81461}, '2': {'precision': 0.4516882138822643, 'recall': 0.5246843379115271, 'f1-score': 0.4854575868767537, 'support': 34293}, 'accuracy': 0.5792773962376829, 'macro avg': {'precision': 0.5356680627072361, 'recall': 0.5414635788595924, 'f1-score': 0.5374269752442578, 'support': 150705}, 'weighted avg': {'precision': 0.5854377665490919, 'recall': 0.5792773962376829, 'f1-score': 0.5814609589305242, 'support': 150705}}
[[15237 12221  7493]
 [13042 54070 14349]
 [ 4876 11424 17993]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92014885
{'0': {'precision': 0.4957568410114305, 'recall': 0.4073573359897538, 'f1-score': 0.44723068510272634, 'support': 14054}, '1': {'precision': 0.669977659391648, 'recall': 0.6373594036097305, 'f1-score': 0.6532616163139463, 'support': 30584}, '2': {'precision': 0.4318644440776806, 'recall': 0.5535185446340432, 'f1-score': 0.4851818659414691, 'support': 14182}, 'accuracy': 0.5621897313838831, 'macro avg': {'precision': 0.5325329814935864, 'recall': 0.5327450947445092, 'f1-score': 0.5285580557860472, 'support': 58820}, 'weighted avg': {'precision': 0.5709395600870193, 'recall': 0.5621897313838831, 'f1-score': 0.5635087137803699, 'support': 58820}}
[[ 5725  5188  3141]
 [ 3905 19493  7186]
 [ 1918  4414  7850]]
training model: results/QRTEA/W0/deepVOL_L2/h50
Epoch 1/50
589/589 - 22s - loss: 3.1136 - accuracy50: 0.4643 - val_loss: 3.0710 - val_accuracy50: 0.4658 - 22s/epoch - 38ms/step
Epoch 2/50
589/589 - 21s - loss: 2.9270 - accuracy50: 0.5259 - val_loss: 3.0289 - val_accuracy50: 0.4679 - 21s/epoch - 36ms/step
Epoch 3/50
589/589 - 19s - loss: 2.8799 - accuracy50: 0.5353 - val_loss: 3.0133 - val_accuracy50: 0.4718 - 19s/epoch - 33ms/step
Epoch 4/50
589/589 - 18s - loss: 2.8567 - accuracy50: 0.5414 - val_loss: 3.0206 - val_accuracy50: 0.4724 - 18s/epoch - 30ms/step
Epoch 5/50
589/589 - 18s - loss: 2.8349 - accuracy50: 0.5470 - val_loss: 3.0053 - val_accuracy50: 0.4832 - 18s/epoch - 31ms/step
Epoch 6/50
589/589 - 18s - loss: 2.8236 - accuracy50: 0.5490 - val_loss: 2.9875 - val_accuracy50: 0.4939 - 18s/epoch - 30ms/step
Epoch 7/50
589/589 - 18s - loss: 2.8092 - accuracy50: 0.5530 - val_loss: 2.9813 - val_accuracy50: 0.5036 - 18s/epoch - 31ms/step
Epoch 8/50
589/589 - 18s - loss: 2.7994 - accuracy50: 0.5564 - val_loss: 2.9663 - val_accuracy50: 0.5052 - 18s/epoch - 31ms/step
Epoch 9/50
589/589 - 19s - loss: 2.7892 - accuracy50: 0.5576 - val_loss: 2.9824 - val_accuracy50: 0.5096 - 19s/epoch - 32ms/step
Epoch 10/50
589/589 - 18s - loss: 2.7815 - accuracy50: 0.5594 - val_loss: 2.9766 - val_accuracy50: 0.5007 - 18s/epoch - 30ms/step
Epoch 11/50
589/589 - 18s - loss: 2.7711 - accuracy50: 0.5614 - val_loss: 2.9789 - val_accuracy50: 0.5029 - 18s/epoch - 31ms/step
Epoch 12/50
589/589 - 18s - loss: 2.7672 - accuracy50: 0.5621 - val_loss: 2.9985 - val_accuracy50: 0.5043 - 18s/epoch - 31ms/step
Epoch 13/50
589/589 - 18s - loss: 2.7583 - accuracy50: 0.5638 - val_loss: 2.9941 - val_accuracy50: 0.5065 - 18s/epoch - 31ms/step
Epoch 14/50
589/589 - 19s - loss: 2.7521 - accuracy50: 0.5650 - val_loss: 2.9857 - val_accuracy50: 0.5067 - 19s/epoch - 32ms/step
Epoch 15/50
589/589 - 19s - loss: 2.7455 - accuracy50: 0.5666 - val_loss: 2.9756 - val_accuracy50: 0.5064 - 19s/epoch - 32ms/step
Epoch 16/50
589/589 - 18s - loss: 2.7391 - accuracy50: 0.5685 - val_loss: 3.0164 - val_accuracy50: 0.5043 - 18s/epoch - 31ms/step
Epoch 17/50
589/589 - 18s - loss: 2.7344 - accuracy50: 0.5689 - val_loss: 3.0178 - val_accuracy50: 0.4961 - 18s/epoch - 31ms/step
Epoch 18/50
589/589 - 19s - loss: 2.7268 - accuracy50: 0.5701 - val_loss: 3.0222 - val_accuracy50: 0.4945 - 19s/epoch - 32ms/step
testing model: results/QRTEA/W0/deepVOL_L2/h50
Evaluating performance on  test set...
2359/2359 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9530387
{'0': {'precision': 0.47581974087998186, 'recall': 0.3380774435088654, 'f1-score': 0.3952929796373414, 'support': 142633}, '1': {'precision': 0.6951887271496276, 'recall': 0.5318469791096766, 'f1-score': 0.6026459092584815, 'support': 308899}, '2': {'precision': 0.39907937999060594, 'recall': 0.6975422971836907, 'f1-score': 0.5076951391196063, 'support': 152256}, 'accuracy': 0.5278558036926868, 'macro avg': {'precision': 0.5233626160067385, 'recall': 0.5224889066007442, 'f1-score': 0.5018780093384764, 'support': 603788}, 'weighted avg': {'precision': 0.5686978373345893, 'recall': 0.5278558036926868, 'f1-score': 0.5297193276289747, 'support': 603788}}
[[ 48221  39961  54451]
 [ 39143 164287 105469]
 [ 13979  32072 106205]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97327447
{'0': {'precision': 0.44738828095520455, 'recall': 0.4062209387695169, 'f1-score': 0.42581191319070344, 'support': 40862}, '1': {'precision': 0.6288479681330584, 'recall': 0.5163909731288466, 'f1-score': 0.5670981006924477, 'support': 69703}, '2': {'precision': 0.43189922824447796, 'recall': 0.6064773293472845, 'f1-score': 0.5045127195482099, 'support': 40140}, 'accuracy': 0.5105139179191135, 'macro avg': {'precision': 0.5027118257775803, 'recall': 0.5096964137485493, 'f1-score': 0.499140911143787, 'support': 150705}, 'weighted avg': {'precision': 0.5271902384187882, 'recall': 0.5105139179191135, 'f1-score': 0.5121204065693199, 'support': 150705}}
[[16599 11163 13100]
 [14788 35994 18921]
 [ 5715 10081 24344]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98047477
{'0': {'precision': 0.49187768752986144, 'recall': 0.3742275536168666, 'f1-score': 0.42506193228736583, 'support': 16506}, '1': {'precision': 0.5985922015374641, 'recall': 0.5059495850947237, 'f1-score': 0.5483857282253617, 'support': 25548}, '2': {'precision': 0.4365980217285552, 'recall': 0.6423714660622689, 'f1-score': 0.5198629145146498, 'support': 16766}, 'accuracy': 0.5078714722883373, 'macro avg': {'precision': 0.5090226369319603, 'recall': 0.5075162015912863, 'f1-score': 0.49777019167579245, 'support': 58820}, 'weighted avg': {'precision': 0.5224714231137025, 'recall': 0.5078714722883373, 'f1-score': 0.5056486308022683, 'support': 58820}}
[[ 6177  4751  5578]
 [ 4302 12926  8320]
 [ 2079  3917 10770]]
training model: results/QRTEA/W0/deepVOL_L2/h100
Epoch 1/50
589/589 - 23s - loss: 3.2146 - accuracy100: 0.4201 - val_loss: 3.1928 - val_accuracy100: 0.4182 - 23s/epoch - 39ms/step
Epoch 2/50
589/589 - 18s - loss: 3.0760 - accuracy100: 0.4668 - val_loss: 3.1615 - val_accuracy100: 0.4310 - 18s/epoch - 31ms/step
Epoch 3/50
589/589 - 19s - loss: 3.0344 - accuracy100: 0.4779 - val_loss: 3.1290 - val_accuracy100: 0.4339 - 19s/epoch - 32ms/step
Epoch 4/50
589/589 - 18s - loss: 3.0094 - accuracy100: 0.4847 - val_loss: 3.1335 - val_accuracy100: 0.4344 - 18s/epoch - 30ms/step
Epoch 5/50
589/589 - 18s - loss: 2.9903 - accuracy100: 0.4894 - val_loss: 3.1273 - val_accuracy100: 0.4409 - 18s/epoch - 30ms/step
Epoch 6/50
589/589 - 18s - loss: 2.9776 - accuracy100: 0.4945 - val_loss: 3.1396 - val_accuracy100: 0.4360 - 18s/epoch - 30ms/step
Epoch 7/50
589/589 - 18s - loss: 2.9666 - accuracy100: 0.4940 - val_loss: 3.1370 - val_accuracy100: 0.4355 - 18s/epoch - 30ms/step
Epoch 8/50
589/589 - 18s - loss: 2.9548 - accuracy100: 0.4992 - val_loss: 3.1329 - val_accuracy100: 0.4414 - 18s/epoch - 31ms/step
Epoch 9/50
589/589 - 18s - loss: 2.9446 - accuracy100: 0.5021 - val_loss: 3.1354 - val_accuracy100: 0.4421 - 18s/epoch - 31ms/step
Epoch 10/50
589/589 - 18s - loss: 2.9370 - accuracy100: 0.5041 - val_loss: 3.1413 - val_accuracy100: 0.4454 - 18s/epoch - 31ms/step
Epoch 11/50
589/589 - 18s - loss: 2.9279 - accuracy100: 0.5067 - val_loss: 3.1618 - val_accuracy100: 0.4428 - 18s/epoch - 30ms/step
Epoch 12/50
589/589 - 18s - loss: 2.9240 - accuracy100: 0.5083 - val_loss: 3.1627 - val_accuracy100: 0.4407 - 18s/epoch - 30ms/step
Epoch 13/50
589/589 - 18s - loss: 2.9161 - accuracy100: 0.5101 - val_loss: 3.1683 - val_accuracy100: 0.4417 - 18s/epoch - 30ms/step
Epoch 14/50
589/589 - 18s - loss: 2.9117 - accuracy100: 0.5115 - val_loss: 3.1585 - val_accuracy100: 0.4440 - 18s/epoch - 30ms/step
Epoch 15/50
589/589 - 18s - loss: 2.9019 - accuracy100: 0.5153 - val_loss: 3.1636 - val_accuracy100: 0.4440 - 18s/epoch - 31ms/step
testing model: results/QRTEA/W0/deepVOL_L2/h100
Evaluating performance on  test set...
2359/2359 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0425043
{'0': {'precision': 0.47806000191699416, 'recall': 0.2864576453222907, 'f1-score': 0.35824926466098983, 'support': 174113}, '1': {'precision': 0.5118151748443661, 'recall': 0.301079517212373, 'f1-score': 0.3791316815077745, 'support': 235383}, '2': {'precision': 0.392681832284372, 'recall': 0.7295977188973298, 'f1-score': 0.5105675654259801, 'support': 194292}, 'accuracy': 0.4347552452185204, 'macro avg': {'precision': 0.4608523363485774, 'recall': 0.43904496047733116, 'f1-score': 0.41598283719824813, 'support': 603788}, 'weighted avg': {'precision': 0.463745538123249, 'recall': 0.4347552452185204, 'f1-score': 0.41540441384725757, 'support': 603788}}
[[ 49876  37216  87021]
 [ 32298  70869 132216]
 [ 22156  30381 141755]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0331395
{'0': {'precision': 0.4504679895170348, 'recall': 0.3616398829800024, 'f1-score': 0.4011959409142946, 'support': 49906}, '1': {'precision': 0.46171648517625274, 'recall': 0.3670430117938687, 'f1-score': 0.4089722288155708, 'support': 51637}, '2': {'precision': 0.43307324222959864, 'recall': 0.6130344575078313, 'f1-score': 0.5075745454851667, 'support': 49162}, 'accuracy': 0.4454994857503069, 'macro avg': {'precision': 0.44841923897429536, 'recall': 0.4472391174272341, 'f1-score': 0.439247571738344, 'support': 150705}, 'weighted avg': {'precision': 0.44864773142480235, 'recall': 0.4454994857503069, 'f1-score': 0.43856251227072884, 'support': 150705}}
[[18048 12054 19804]
 [13035 18953 19649]
 [ 8982 10042 30138]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0425465
{'0': {'precision': 0.47689652467247196, 'recall': 0.30781305382551016, 'f1-score': 0.3741383554899065, 'support': 19749}, '1': {'precision': 0.42015815760266373, 'recall': 0.33033376963350786, 'f1-score': 0.3698705422569614, 'support': 18336}, '2': {'precision': 0.4355750702846132, 'recall': 0.6650108512177477, 'f1-score': 0.5263780729882425, 'support': 20735}, 'accuracy': 0.4407514450867052, 'macro avg': {'precision': 0.44420991751991634, 'recall': 0.4343858915589219, 'f1-score': 0.4234623235783701, 'support': 58820}, 'weighted avg': {'precision': 0.44464295351769034, 'recall': 0.4407514450867052, 'f1-score': 0.42647490630406354, 'support': 58820}}
[[ 6079  4629  9041]
 [ 3452  6057  8827]
 [ 3216  3730 13789]]
training model: results/QRTEA/W0/deepVOL_L2/h200
Epoch 1/50
589/589 - 22s - loss: 3.2945 - accuracy200: 0.3812 - val_loss: 3.3222 - val_accuracy200: 0.3401 - 22s/epoch - 38ms/step
Epoch 2/50
589/589 - 20s - loss: 3.2436 - accuracy200: 0.4029 - val_loss: 3.3049 - val_accuracy200: 0.3573 - 20s/epoch - 34ms/step
Epoch 3/50
589/589 - 20s - loss: 3.2188 - accuracy200: 0.4123 - val_loss: 3.3222 - val_accuracy200: 0.3623 - 20s/epoch - 33ms/step
Epoch 4/50
589/589 - 19s - loss: 3.2017 - accuracy200: 0.4212 - val_loss: 3.3169 - val_accuracy200: 0.3657 - 19s/epoch - 32ms/step
Epoch 5/50
589/589 - 18s - loss: 3.1891 - accuracy200: 0.4276 - val_loss: 3.3106 - val_accuracy200: 0.3696 - 18s/epoch - 31ms/step
Epoch 6/50
589/589 - 19s - loss: 3.1738 - accuracy200: 0.4351 - val_loss: 3.3031 - val_accuracy200: 0.3736 - 19s/epoch - 32ms/step
Epoch 7/50
589/589 - 21s - loss: 3.1638 - accuracy200: 0.4393 - val_loss: 3.3000 - val_accuracy200: 0.3780 - 21s/epoch - 35ms/step
Epoch 8/50
589/589 - 19s - loss: 3.1558 - accuracy200: 0.4427 - val_loss: 3.3033 - val_accuracy200: 0.3796 - 19s/epoch - 32ms/step
Epoch 9/50
589/589 - 19s - loss: 3.1517 - accuracy200: 0.4439 - val_loss: 3.3084 - val_accuracy200: 0.3773 - 19s/epoch - 32ms/step
Epoch 10/50
589/589 - 19s - loss: 3.1423 - accuracy200: 0.4471 - val_loss: 3.3240 - val_accuracy200: 0.3770 - 19s/epoch - 33ms/step
Epoch 11/50
589/589 - 20s - loss: 3.1326 - accuracy200: 0.4516 - val_loss: 3.3379 - val_accuracy200: 0.3772 - 20s/epoch - 33ms/step
Epoch 12/50
589/589 - 19s - loss: 3.1241 - accuracy200: 0.4548 - val_loss: 3.3459 - val_accuracy200: 0.3762 - 19s/epoch - 33ms/step
Epoch 13/50
589/589 - 20s - loss: 3.1126 - accuracy200: 0.4589 - val_loss: 3.3575 - val_accuracy200: 0.3744 - 20s/epoch - 33ms/step
Epoch 14/50
589/589 - 19s - loss: 3.1056 - accuracy200: 0.4606 - val_loss: 3.3649 - val_accuracy200: 0.3835 - 19s/epoch - 33ms/step
Epoch 15/50
589/589 - 20s - loss: 3.0919 - accuracy200: 0.4656 - val_loss: 3.3729 - val_accuracy200: 0.3788 - 20s/epoch - 34ms/step
Epoch 16/50
589/589 - 20s - loss: 3.0815 - accuracy200: 0.4698 - val_loss: 3.3796 - val_accuracy200: 0.3749 - 20s/epoch - 35ms/step
Epoch 17/50
589/589 - 20s - loss: 3.0742 - accuracy200: 0.4724 - val_loss: 3.4072 - val_accuracy200: 0.3750 - 20s/epoch - 34ms/step
testing model: results/QRTEA/W0/deepVOL_L2/h200
Evaluating performance on  test set...
2359/2359 - 38s - 38s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0849403
{'0': {'precision': 0.38978469783773795, 'recall': 0.19330595223774583, 'f1-score': 0.25844249834385735, 'support': 174573}, '1': {'precision': 0.38643663570095976, 'recall': 0.452608151091648, 'f1-score': 0.4169130753253113, 'support': 221958}, '2': {'precision': 0.4081719125976202, 'recall': 0.5066222130012497, 'f1-score': 0.45209944370769684, 'support': 207257}, 'accuracy': 0.39617713502090135, 'macro avg': {'precision': 0.394797748712106, 'recall': 0.3841787721102145, 'f1-score': 0.37581833912562185, 'support': 603788}, 'weighted avg': {'precision': 0.39486553712857164, 'recall': 0.39617713502090135, 'f1-score': 0.38317265172703624, 'support': 603788}}
[[ 33746  77658  63169]
 [ 32421 100460  89077]
 [ 20409  81847 105001]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0895168
{'0': {'precision': 0.4191112119542316, 'recall': 0.25471809621370317, 'f1-score': 0.3168612843542083, 'support': 50762}, '1': {'precision': 0.35607318728609183, 'recall': 0.4935941065780518, 'f1-score': 0.4137045830152432, 'support': 49954}, '2': {'precision': 0.41521923844527436, 'recall': 0.4203524775450599, 'f1-score': 0.41777009026203826, 'support': 49989}, 'accuracy': 0.38883912278955574, 'macro avg': {'precision': 0.3968012125618659, 'recall': 0.389554893445605, 'f1-score': 0.3827786525438299, 'support': 150705}, 'weighted avg': {'precision': 0.39692510433994205, 'recall': 0.38883912278955574, 'f1-score': 0.3824333651732909, 'support': 150705}}
[[12930 23121 14711]
 [10414 24657 14883]
 [ 7507 21469 21013]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1014489
{'0': {'precision': 0.42675643392333584, 'recall': 0.19966468526139308, 'f1-score': 0.2720476256403157, 'support': 19683}, '1': {'precision': 0.3032438435908238, 'recall': 0.4547699730055712, 'f1-score': 0.3638619548733974, 'support': 17411}, '2': {'precision': 0.43442553191489364, 'recall': 0.4698978182822425, 'f1-score': 0.4514659709016937, 'support': 21726}, 'accuracy': 0.3749914994899694, 'macro avg': {'precision': 0.38814193647635103, 'recall': 0.3747774921830689, 'f1-score': 0.36245851713846894, 'support': 58820}, 'weighted avg': {'precision': 0.39302880918150007, 'recall': 0.3749914994899694, 'f1-score': 0.3654958108736697, 'support': 58820}}
[[ 3930  9163  6590]
 [ 2792  7918  6701]
 [ 2487  9030 10209]]
training model: results/QRTEA/W0/deepVOL_L2/h300
Epoch 1/50
589/589 - 22s - loss: 3.3224 - accuracy300: 0.3580 - val_loss: 3.3114 - val_accuracy300: 0.3553 - 22s/epoch - 38ms/step
Epoch 2/50
589/589 - 20s - loss: 3.2815 - accuracy300: 0.3716 - val_loss: 3.2934 - val_accuracy300: 0.3743 - 20s/epoch - 33ms/step
Epoch 3/50
589/589 - 21s - loss: 3.2675 - accuracy300: 0.3801 - val_loss: 3.2870 - val_accuracy300: 0.3752 - 21s/epoch - 35ms/step
Epoch 4/50
589/589 - 20s - loss: 3.2589 - accuracy300: 0.3877 - val_loss: 3.2855 - val_accuracy300: 0.3765 - 20s/epoch - 34ms/step
Epoch 5/50
589/589 - 21s - loss: 3.2500 - accuracy300: 0.3949 - val_loss: 3.2947 - val_accuracy300: 0.3628 - 21s/epoch - 35ms/step
Epoch 6/50
589/589 - 20s - loss: 3.2393 - accuracy300: 0.4032 - val_loss: 3.2845 - val_accuracy300: 0.3741 - 20s/epoch - 34ms/step
Epoch 7/50
589/589 - 20s - loss: 3.2291 - accuracy300: 0.4086 - val_loss: 3.2911 - val_accuracy300: 0.3744 - 20s/epoch - 34ms/step
Epoch 8/50
589/589 - 20s - loss: 3.2186 - accuracy300: 0.4142 - val_loss: 3.2971 - val_accuracy300: 0.3775 - 20s/epoch - 33ms/step
Epoch 9/50
589/589 - 19s - loss: 3.2104 - accuracy300: 0.4197 - val_loss: 3.2996 - val_accuracy300: 0.3735 - 19s/epoch - 32ms/step
Epoch 10/50
589/589 - 19s - loss: 3.2037 - accuracy300: 0.4238 - val_loss: 3.3035 - val_accuracy300: 0.3766 - 19s/epoch - 32ms/step
Epoch 11/50
589/589 - 19s - loss: 3.1974 - accuracy300: 0.4267 - val_loss: 3.3108 - val_accuracy300: 0.3774 - 19s/epoch - 33ms/step
Epoch 12/50
589/589 - 19s - loss: 3.1843 - accuracy300: 0.4329 - val_loss: 3.3243 - val_accuracy300: 0.3709 - 19s/epoch - 32ms/step
Epoch 13/50
589/589 - 19s - loss: 3.1755 - accuracy300: 0.4377 - val_loss: 3.3259 - val_accuracy300: 0.3703 - 19s/epoch - 33ms/step
Epoch 14/50
589/589 - 20s - loss: 3.1672 - accuracy300: 0.4408 - val_loss: 3.3259 - val_accuracy300: 0.3734 - 20s/epoch - 34ms/step
Epoch 15/50
589/589 - 20s - loss: 3.1527 - accuracy300: 0.4464 - val_loss: 3.3642 - val_accuracy300: 0.3661 - 20s/epoch - 33ms/step
Epoch 16/50
589/589 - 19s - loss: 3.1394 - accuracy300: 0.4524 - val_loss: 3.3523 - val_accuracy300: 0.3686 - 19s/epoch - 32ms/step
testing model: results/QRTEA/W0/deepVOL_L2/h300
Evaluating performance on  test set...
2359/2359 - 32s - 32s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0889611
{'0': {'precision': 0.3613502306039497, 'recall': 0.2815937801620016, 'f1-score': 0.31652515831652517, 'support': 187529}, '1': {'precision': 0.3368379804069329, 'recall': 0.29161882293993613, 'f1-score': 0.31260158166676455, 'support': 191596}, '2': {'precision': 0.421886727786822, 'recall': 0.5479139867267864, 'f1-score': 0.4767116285013883, 'support': 224663}, 'accuracy': 0.3838698351076868, 'macro avg': {'precision': 0.3733583129325682, 'recall': 0.37370886327624137, 'f1-score': 0.3686127894948927, 'support': 603788}, 'weighted avg': {'precision': 0.37609689992803036, 'recall': 0.3838698351076868, 'f1-score': 0.37488377319352567, 'support': 603788}}
[[ 52807  54894  79828]
 [ 46872  55873  88851]
 [ 46459  55108 123096]]
Evaluating performance on  train set...
589/589 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0867668
{'0': {'precision': 0.4052076717896609, 'recall': 0.3139095524855355, 'f1-score': 0.353763071225008, 'support': 50814}, '1': {'precision': 0.36517953563714906, 'recall': 0.4270492126761119, 'f1-score': 0.39369849557039166, 'support': 50678}, '2': {'precision': 0.3885091020815731, 'recall': 0.41111088533517565, 'f1-score': 0.39949056659657023, 'support': 49213}, 'accuracy': 0.3836966258584652, 'macro avg': {'precision': 0.3862987698361276, 'recall': 0.38402321683227436, 'f1-score': 0.3823173777973233, 'support': 150705}, 'weighted avg': {'precision': 0.3862943471157541, 'recall': 0.3836966258584652, 'f1-score': 0.38212466947785984, 'support': 150705}}
[[15951 19216 15647]
 [12839 21642 16197]
 [10575 18406 20232]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0935975
{'0': {'precision': 0.4059835933730095, 'recall': 0.2564389128778258, 'f1-score': 0.31433108129144743, 'support': 19685}, '1': {'precision': 0.3127460295914212, 'recall': 0.3955591164015108, 'f1-score': 0.34931143398610237, 'support': 17474}, '2': {'precision': 0.41235330450895613, 'recall': 0.462305526060662, 'f1-score': 0.4359030165846864, 'support': 21661}, 'accuracy': 0.3735804148248895, 'macro avg': {'precision': 0.3770276424911289, 'recall': 0.37143451844666614, 'f1-score': 0.36651517728741206, 'support': 58820}, 'weighted avg': {'precision': 0.38063067129542133, 'recall': 0.3735804148248895, 'f1-score': 0.36949286934607595, 'support': 58820}}
[[ 5048  7378  7259]
 [ 3550  6912  7012]
 [ 3836  7811 10014]]
training model: results/QRTEA/W0/deepVOL_L2/h500
Epoch 1/50
589/589 - 21s - loss: 3.3320 - accuracy500: 0.3530 - val_loss: 3.3189 - val_accuracy500: 0.3311 - 21s/epoch - 36ms/step
Epoch 2/50
589/589 - 19s - loss: 3.2968 - accuracy500: 0.3563 - val_loss: 3.2932 - val_accuracy500: 0.3452 - 19s/epoch - 32ms/step
Epoch 3/50
589/589 - 20s - loss: 3.2853 - accuracy500: 0.3670 - val_loss: 3.2840 - val_accuracy500: 0.3653 - 20s/epoch - 33ms/step
Epoch 4/50
589/589 - 18s - loss: 3.2747 - accuracy500: 0.3770 - val_loss: 3.2843 - val_accuracy500: 0.3684 - 18s/epoch - 31ms/step
Epoch 5/50
589/589 - 19s - loss: 3.2662 - accuracy500: 0.3830 - val_loss: 3.2863 - val_accuracy500: 0.3702 - 19s/epoch - 32ms/step
Epoch 6/50
589/589 - 20s - loss: 3.2576 - accuracy500: 0.3918 - val_loss: 3.2906 - val_accuracy500: 0.3680 - 20s/epoch - 34ms/step
Epoch 7/50
589/589 - 20s - loss: 3.2495 - accuracy500: 0.3968 - val_loss: 3.2863 - val_accuracy500: 0.3679 - 20s/epoch - 35ms/step
Epoch 8/50
589/589 - 19s - loss: 3.2381 - accuracy500: 0.4039 - val_loss: 3.2959 - val_accuracy500: 0.3697 - 19s/epoch - 33ms/step
Epoch 9/50
589/589 - 19s - loss: 3.2255 - accuracy500: 0.4124 - val_loss: 3.2987 - val_accuracy500: 0.3661 - 19s/epoch - 33ms/step
Epoch 10/50
589/589 - 19s - loss: 3.2150 - accuracy500: 0.4176 - val_loss: 3.3078 - val_accuracy500: 0.3637 - 19s/epoch - 31ms/step
Epoch 11/50
589/589 - 20s - loss: 3.1992 - accuracy500: 0.4253 - val_loss: 3.3204 - val_accuracy500: 0.3679 - 20s/epoch - 35ms/step
Epoch 12/50
589/589 - 21s - loss: 3.1856 - accuracy500: 0.4309 - val_loss: 3.3399 - val_accuracy500: 0.3638 - 21s/epoch - 35ms/step
Epoch 13/50
589/589 - 19s - loss: 3.1713 - accuracy500: 0.4382 - val_loss: 3.3620 - val_accuracy500: 0.3632 - 19s/epoch - 32ms/step
testing model: results/QRTEA/W0/deepVOL_L2/h500
Evaluating performance on  test set...
2359/2359 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0964459
{'0': {'precision': 0.3794417683524327, 'recall': 0.35975961585479155, 'f1-score': 0.3693386612584211, 'support': 204506}, '1': {'precision': 0.2904202085970941, 'recall': 0.2919462070386599, 'f1-score': 0.29118120849993806, 'support': 165003}, '2': {'precision': 0.4270879436111794, 'recall': 0.44484567545533316, 'f1-score': 0.4357859832447904, 'support': 234279}, 'accuracy': 0.3742422837154763, 'macro avg': {'precision': 0.3656499735202354, 'recall': 0.36551716611626156, 'f1-score': 0.36543528433438316, 'support': 603788}, 'weighted avg': {'precision': 0.3736014301362604, 'recall': 0.3742422837154763, 'f1-score': 0.3737623960297922, 'support': 603788}}
[[ 73573  55282  75651]
 [ 52680  48172  64151]
 [ 67645  62416 104218]]
Evaluating performance on  train set...
589/589 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0944141
{'0': {'precision': 0.39809549001454836, 'recall': 0.34158612471865485, 'f1-score': 0.36768223785335463, 'support': 52871}, '1': {'precision': 0.3318401720121842, 'recall': 0.31408462647333163, 'f1-score': 0.3227183620126334, 'support': 47172}, '2': {'precision': 0.3666935789491028, 'recall': 0.43928388141012986, 'f1-score': 0.3997198099736873, 'support': 50662}, 'accuracy': 0.3658206429780034, 'macro avg': {'precision': 0.36554308032527844, 'recall': 0.3649848775340388, 'f1-score': 0.36337346994655845, 'support': 150705}, 'weighted avg': {'precision': 0.3668007122752223, 'recall': 0.3658206429780034, 'f1-score': 0.36437811076800103, 'support': 150705}}
[[18060 14972 19839]
 [13759 14816 18597]
 [13547 14860 22255]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0963647
{'0': {'precision': 0.389795233299765, 'recall': 0.28813895781637716, 'f1-score': 0.3313454130403766, 'support': 20150}, '1': {'precision': 0.29752537347474056, 'recall': 0.31513467810122, 'f1-score': 0.3060769591740966, 'support': 16558}, '2': {'precision': 0.4026982984045174, 'recall': 0.4805535455861071, 'f1-score': 0.43819460195055565, 'support': 22112}, 'accuracy': 0.3680720843250595, 'macro avg': {'precision': 0.3633396350596743, 'recall': 0.36127572716790146, 'f1-score': 0.35853899138834294, 'support': 58820}, 'weighted avg': {'precision': 0.3686716059045513, 'recall': 0.3680720843250595, 'f1-score': 0.36439971780175057, 'support': 58820}}
[[ 5806  5774  8570]
 [ 4149  5218  7191]
 [ 4940  6546 10626]]
training model: results/QRTEA/W0/deepVOL_L2/h1000
Epoch 1/50
589/589 - 23s - loss: 3.3192 - accuracy1000: 0.3812 - val_loss: 3.4299 - val_accuracy1000: 0.3163 - 23s/epoch - 39ms/step
Epoch 2/50
589/589 - 18s - loss: 3.3013 - accuracy1000: 0.3527 - val_loss: 3.3336 - val_accuracy1000: 0.3148 - 18s/epoch - 31ms/step
Epoch 3/50
589/589 - 19s - loss: 3.2878 - accuracy1000: 0.3613 - val_loss: 3.3165 - val_accuracy1000: 0.3224 - 19s/epoch - 32ms/step
Epoch 4/50
589/589 - 19s - loss: 3.2862 - accuracy1000: 0.3659 - val_loss: 3.3573 - val_accuracy1000: 0.3250 - 19s/epoch - 33ms/step
Epoch 5/50
589/589 - 19s - loss: 3.2848 - accuracy1000: 0.3663 - val_loss: 3.3371 - val_accuracy1000: 0.3321 - 19s/epoch - 32ms/step
Epoch 6/50
589/589 - 19s - loss: 3.2759 - accuracy1000: 0.3751 - val_loss: 3.3614 - val_accuracy1000: 0.3283 - 19s/epoch - 33ms/step
Epoch 7/50
589/589 - 19s - loss: 3.2765 - accuracy1000: 0.3741 - val_loss: 3.3390 - val_accuracy1000: 0.3264 - 19s/epoch - 32ms/step
Epoch 8/50
589/589 - 20s - loss: 3.2667 - accuracy1000: 0.3845 - val_loss: 3.3266 - val_accuracy1000: 0.3381 - 20s/epoch - 33ms/step
Epoch 9/50
589/589 - 19s - loss: 3.2580 - accuracy1000: 0.3896 - val_loss: 3.3570 - val_accuracy1000: 0.3339 - 19s/epoch - 33ms/step
Epoch 10/50
589/589 - 19s - loss: 3.2441 - accuracy1000: 0.4008 - val_loss: 3.4079 - val_accuracy1000: 0.3286 - 19s/epoch - 32ms/step
Epoch 11/50
589/589 - 21s - loss: 3.2311 - accuracy1000: 0.4089 - val_loss: 3.4102 - val_accuracy1000: 0.3316 - 21s/epoch - 35ms/step
Epoch 12/50
589/589 - 21s - loss: 3.2203 - accuracy1000: 0.4171 - val_loss: 3.4286 - val_accuracy1000: 0.3311 - 21s/epoch - 35ms/step
Epoch 13/50
589/589 - 21s - loss: 3.2016 - accuracy1000: 0.4264 - val_loss: 3.4499 - val_accuracy1000: 0.3318 - 21s/epoch - 36ms/step
testing model: results/QRTEA/W0/deepVOL_L2/h1000
Evaluating performance on  test set...
2359/2359 - 40s - 40s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.092751
{'0': {'precision': 0.3410435598026301, 'recall': 0.08363447218572054, 'f1-score': 0.13432763631726824, 'support': 182640}, '1': {'precision': 0.37956935023375205, 'recall': 0.8839051180285459, 'f1-score': 0.5310804448305361, 'support': 226513}, '2': {'precision': 0.3659294983659612, 'recall': 0.05925450201659516, 'f1-score': 0.10199334960557502, 'support': 194635}, 'accuracy': 0.3759995230113881, 'macro avg': {'precision': 0.36218080280078113, 'recall': 0.3422646974102872, 'f1-score': 0.2558004769177931, 'support': 603788}, 'weighted avg': {'precision': 0.36351877795900067, 'recall': 0.3759995230113881, 'f1-score': 0.27274755360717035, 'support': 603788}}
[[ 15275 157474   9891]
 [ 16204 200216  10093]
 [ 13310 169792  11533]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001059
{'0': {'precision': 0.35854984894259817, 'recall': 0.057485517214655224, 'f1-score': 0.09908495858936682, 'support': 51613}, '1': {'precision': 0.33968959570799, 'recall': 0.8762554369315935, 'f1-score': 0.4895860373919527, 'support': 50580}, '2': {'precision': 0.3541614387285655, 'recall': 0.08727737467018469, 'f1-score': 0.14004332941935269, 'support': 48512}, 'accuracy': 0.34187319597889915, 'macro avg': {'precision': 0.3508002944597179, 'recall': 0.34033944293881113, 'f1-score': 0.24290477513355743, 'support': 150705}, 'weighted avg': {'precision': 0.3508072911979338, 'recall': 0.34187319597889915, 'f1-score': 0.24333045178162369, 'support': 150705}}
[[ 2967 44618  4028]
 [ 2566 44321  3693]
 [ 2742 41536  4234]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1041405
{'0': {'precision': 0.3636968085106383, 'recall': 0.055468235055518934, 'f1-score': 0.09625621398090713, 'support': 19723}, '1': {'precision': 0.31350008665010687, 'recall': 0.887925392670157, 'f1-score': 0.46339068437006364, 'support': 18336}, '2': {'precision': 0.3555039958752256, 'recall': 0.06642261933432879, 'f1-score': 0.11193181818181819, 'support': 20761}, 'accuracy': 0.3188371302278137, 'macro avg': {'precision': 0.34423363034532356, 'recall': 0.33660541568666824, 'f1-score': 0.22385957217759633, 'support': 58820}, 'weighted avg': {'precision': 0.3451572288581645, 'recall': 0.3188371302278137, 'f1-score': 0.21623613352988177, 'support': 58820}}
[[ 1094 17212  1417]
 [  972 16281  1083]
 [  942 18440  1379]]
training model: results/QRTEA/W0/deepVOL_L3/h10
Epoch 1/50
589/589 - 30s - loss: 3.2204 - accuracy10: 0.3685 - val_loss: 3.1716 - val_accuracy10: 0.3173 - 30s/epoch - 51ms/step
Epoch 2/50
589/589 - 26s - loss: 3.0158 - accuracy10: 0.3908 - val_loss: 3.1062 - val_accuracy10: 0.4082 - 26s/epoch - 44ms/step
Epoch 3/50
589/589 - 25s - loss: 2.8312 - accuracy10: 0.4787 - val_loss: 2.8485 - val_accuracy10: 0.4903 - 25s/epoch - 42ms/step
Epoch 4/50
589/589 - 26s - loss: 2.6265 - accuracy10: 0.5710 - val_loss: 2.7524 - val_accuracy10: 0.5171 - 26s/epoch - 44ms/step
Epoch 5/50
589/589 - 25s - loss: 2.5469 - accuracy10: 0.5900 - val_loss: 2.7158 - val_accuracy10: 0.5251 - 25s/epoch - 43ms/step
Epoch 6/50
589/589 - 25s - loss: 2.5138 - accuracy10: 0.5987 - val_loss: 2.6974 - val_accuracy10: 0.5379 - 25s/epoch - 42ms/step
Epoch 7/50
589/589 - 25s - loss: 2.4854 - accuracy10: 0.6035 - val_loss: 2.6954 - val_accuracy10: 0.5375 - 25s/epoch - 43ms/step
Epoch 8/50
589/589 - 25s - loss: 2.4644 - accuracy10: 0.6080 - val_loss: 2.6864 - val_accuracy10: 0.5833 - 25s/epoch - 42ms/step
Epoch 9/50
589/589 - 26s - loss: 2.4392 - accuracy10: 0.6146 - val_loss: 2.6186 - val_accuracy10: 0.5831 - 26s/epoch - 44ms/step
Epoch 10/50
589/589 - 26s - loss: 2.4251 - accuracy10: 0.6154 - val_loss: 2.6081 - val_accuracy10: 0.5781 - 26s/epoch - 44ms/step
Epoch 11/50
589/589 - 25s - loss: 2.3998 - accuracy10: 0.6198 - val_loss: 2.6048 - val_accuracy10: 0.5892 - 25s/epoch - 43ms/step
Epoch 12/50
589/589 - 26s - loss: 2.3856 - accuracy10: 0.6231 - val_loss: 2.6139 - val_accuracy10: 0.5991 - 26s/epoch - 44ms/step
Epoch 13/50
589/589 - 26s - loss: 2.3719 - accuracy10: 0.6260 - val_loss: 2.5820 - val_accuracy10: 0.5916 - 26s/epoch - 44ms/step
Epoch 14/50
589/589 - 25s - loss: 2.3609 - accuracy10: 0.6281 - val_loss: 2.5660 - val_accuracy10: 0.6061 - 25s/epoch - 43ms/step
Epoch 15/50
589/589 - 25s - loss: 2.3505 - accuracy10: 0.6283 - val_loss: 2.5617 - val_accuracy10: 0.6193 - 25s/epoch - 43ms/step
Epoch 16/50
589/589 - 25s - loss: 2.3388 - accuracy10: 0.6305 - val_loss: 2.5423 - val_accuracy10: 0.6208 - 25s/epoch - 42ms/step
Epoch 17/50
589/589 - 25s - loss: 2.3295 - accuracy10: 0.6322 - val_loss: 2.5464 - val_accuracy10: 0.6137 - 25s/epoch - 43ms/step
Epoch 18/50
589/589 - 25s - loss: 2.3178 - accuracy10: 0.6358 - val_loss: 2.5378 - val_accuracy10: 0.6214 - 25s/epoch - 42ms/step
Epoch 19/50
589/589 - 25s - loss: 2.3101 - accuracy10: 0.6370 - val_loss: 2.5311 - val_accuracy10: 0.6110 - 25s/epoch - 42ms/step
Epoch 20/50
589/589 - 26s - loss: 2.3037 - accuracy10: 0.6376 - val_loss: 2.5437 - val_accuracy10: 0.6151 - 26s/epoch - 45ms/step
Epoch 21/50
589/589 - 26s - loss: 2.2914 - accuracy10: 0.6391 - val_loss: 2.5254 - val_accuracy10: 0.6087 - 26s/epoch - 44ms/step
Epoch 22/50
589/589 - 26s - loss: 2.2863 - accuracy10: 0.6391 - val_loss: 2.5546 - val_accuracy10: 0.6124 - 26s/epoch - 44ms/step
Epoch 23/50
589/589 - 25s - loss: 2.2767 - accuracy10: 0.6405 - val_loss: 2.5240 - val_accuracy10: 0.6270 - 25s/epoch - 42ms/step
Epoch 24/50
589/589 - 26s - loss: 2.2674 - accuracy10: 0.6431 - val_loss: 2.5405 - val_accuracy10: 0.6156 - 26s/epoch - 45ms/step
Epoch 25/50
589/589 - 26s - loss: 2.2592 - accuracy10: 0.6432 - val_loss: 2.5320 - val_accuracy10: 0.6167 - 26s/epoch - 44ms/step
Epoch 26/50
589/589 - 27s - loss: 2.2514 - accuracy10: 0.6431 - val_loss: 2.5370 - val_accuracy10: 0.6101 - 27s/epoch - 46ms/step
Epoch 27/50
589/589 - 25s - loss: 2.2465 - accuracy10: 0.6449 - val_loss: 2.5538 - val_accuracy10: 0.6064 - 25s/epoch - 43ms/step
Epoch 28/50
589/589 - 25s - loss: 2.2383 - accuracy10: 0.6457 - val_loss: 2.5202 - val_accuracy10: 0.6069 - 25s/epoch - 43ms/step
Epoch 29/50
589/589 - 25s - loss: 2.2284 - accuracy10: 0.6462 - val_loss: 2.5537 - val_accuracy10: 0.6143 - 25s/epoch - 43ms/step
Epoch 30/50
589/589 - 25s - loss: 2.2215 - accuracy10: 0.6480 - val_loss: 2.5561 - val_accuracy10: 0.6110 - 25s/epoch - 42ms/step
Epoch 31/50
589/589 - 26s - loss: 2.2174 - accuracy10: 0.6468 - val_loss: 2.5686 - val_accuracy10: 0.6079 - 26s/epoch - 43ms/step
Epoch 32/50
589/589 - 26s - loss: 2.2112 - accuracy10: 0.6480 - val_loss: 2.5643 - val_accuracy10: 0.6172 - 26s/epoch - 44ms/step
Epoch 33/50
589/589 - 27s - loss: 2.2038 - accuracy10: 0.6506 - val_loss: 2.5766 - val_accuracy10: 0.6126 - 27s/epoch - 46ms/step
Epoch 34/50
589/589 - 26s - loss: 2.1971 - accuracy10: 0.6500 - val_loss: 2.5604 - val_accuracy10: 0.6120 - 26s/epoch - 45ms/step
Epoch 35/50
589/589 - 26s - loss: 2.1917 - accuracy10: 0.6504 - val_loss: 2.5734 - val_accuracy10: 0.6112 - 26s/epoch - 43ms/step
Epoch 36/50
589/589 - 26s - loss: 2.1842 - accuracy10: 0.6501 - val_loss: 2.5735 - val_accuracy10: 0.6040 - 26s/epoch - 44ms/step
Epoch 37/50
589/589 - 27s - loss: 2.1783 - accuracy10: 0.6517 - val_loss: 2.5808 - val_accuracy10: 0.6141 - 27s/epoch - 45ms/step
Epoch 38/50
589/589 - 27s - loss: 2.1716 - accuracy10: 0.6516 - val_loss: 2.5945 - val_accuracy10: 0.6054 - 27s/epoch - 46ms/step
testing model: results/QRTEA/W0/deepVOL_L3/h10
Evaluating performance on  test set...
2359/2359 - 49s - 49s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74841255
{'0': {'precision': 0.4027942841635396, 'recall': 0.5236629519684656, 'f1-score': 0.4553441554663408, 'support': 82196}, '1': {'precision': 0.91039198360744, 'recall': 0.6559142238458257, 'f1-score': 0.7624806037055212, 'support': 438257}, '2': {'precision': 0.34102023469151205, 'recall': 0.7413931721365573, 'f1-score': 0.4671599076023879, 'support': 83335}, 'accuracy': 0.6497081757173048, 'macro avg': {'precision': 0.5514021674874973, 'recall': 0.6403234493169495, 'f1-score': 0.5616615555914167, 'support': 603788}, 'weighted avg': {'precision': 0.7627058831890816, 'recall': 0.6497081757173048, 'f1-score': 0.6799086782793414, 'support': 603788}}
[[ 43043  16578  22575]
 [ 53983 287459  96815]
 [  9835  11716  61784]]
Evaluating performance on  train set...
589/589 - 13s - 13s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7968931
{'0': {'precision': 0.38350311335747594, 'recall': 0.6297326203208556, 'f1-score': 0.4766993749797597, 'support': 23375}, '1': {'precision': 0.8951594851706771, 'recall': 0.613880574103922, 'f1-score': 0.7283054088508468, 'support': 104232}, '2': {'precision': 0.3886685274962049, 'recall': 0.6872456489739371, 'f1-score': 0.4965279949953081, 'support': 23098}, 'accuracy': 0.6275836899903785, 'macro avg': {'precision': 0.5557770420081193, 'recall': 0.6436196144662383, 'f1-score': 0.5671775929419716, 'support': 150705}, 'weighted avg': {'precision': 0.7381713571623262, 'recall': 0.6275836899903785, 'f1-score': 0.6537565501734844, 'support': 150705}}
[[14720  3788  4867]
 [20145 63986 20101]
 [ 3518  3706 15874]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8247576
{'0': {'precision': 0.4012626633387168, 'recall': 0.5782903089293271, 'f1-score': 0.4737800121348705, 'support': 9452}, '1': {'precision': 0.8774971169227336, 'recall': 0.5900983163635454, 'f1-score': 0.7056571035390552, 'support': 39973}, '2': {'precision': 0.3603756073592837, 'recall': 0.7026077700904737, 'f1-score': 0.476400115473441, 'support': 9395}, 'accuracy': 0.6061713702822169, 'macro avg': {'precision': 0.5463784625402447, 'recall': 0.623665465127782, 'f1-score': 0.5519457437157889, 'support': 58820}, 'weighted avg': {'precision': 0.7183722505911332, 'recall': 0.6061713702822169, 'f1-score': 0.6317779523858964, 'support': 58820}}
[[ 5466  1834  2152]
 [ 6821 23588  9564]
 [ 1335  1459  6601]]
training model: results/QRTEA/W0/deepVOL_L3/h20
Epoch 1/50
589/589 - 30s - loss: 3.2046 - accuracy20: 0.4264 - val_loss: 3.1512 - val_accuracy20: 0.3675 - 30s/epoch - 51ms/step
Epoch 2/50
589/589 - 28s - loss: 2.8582 - accuracy20: 0.5381 - val_loss: 2.9393 - val_accuracy20: 0.5140 - 28s/epoch - 47ms/step
Epoch 3/50
589/589 - 28s - loss: 2.7256 - accuracy20: 0.5717 - val_loss: 2.8816 - val_accuracy20: 0.5070 - 28s/epoch - 48ms/step
Epoch 4/50
589/589 - 26s - loss: 2.6640 - accuracy20: 0.5855 - val_loss: 2.9095 - val_accuracy20: 0.5202 - 26s/epoch - 45ms/step
Epoch 5/50
589/589 - 27s - loss: 2.6275 - accuracy20: 0.5941 - val_loss: 2.9279 - val_accuracy20: 0.5636 - 27s/epoch - 45ms/step
Epoch 6/50
589/589 - 26s - loss: 2.6039 - accuracy20: 0.5973 - val_loss: 2.9208 - val_accuracy20: 0.5358 - 26s/epoch - 44ms/step
Epoch 7/50
589/589 - 27s - loss: 2.5918 - accuracy20: 0.6021 - val_loss: 2.8624 - val_accuracy20: 0.5540 - 27s/epoch - 46ms/step
Epoch 8/50
589/589 - 27s - loss: 2.5710 - accuracy20: 0.6068 - val_loss: 2.8587 - val_accuracy20: 0.5630 - 27s/epoch - 45ms/step
Epoch 9/50
589/589 - 26s - loss: 2.5568 - accuracy20: 0.6098 - val_loss: 2.8467 - val_accuracy20: 0.5491 - 26s/epoch - 44ms/step
Epoch 10/50
589/589 - 27s - loss: 2.5481 - accuracy20: 0.6116 - val_loss: 2.8220 - val_accuracy20: 0.5552 - 27s/epoch - 45ms/step
Epoch 11/50
589/589 - 27s - loss: 2.5334 - accuracy20: 0.6119 - val_loss: 2.8014 - val_accuracy20: 0.5665 - 27s/epoch - 46ms/step
Epoch 12/50
589/589 - 26s - loss: 2.5252 - accuracy20: 0.6157 - val_loss: 2.8056 - val_accuracy20: 0.5607 - 26s/epoch - 45ms/step
Epoch 13/50
589/589 - 27s - loss: 2.5163 - accuracy20: 0.6159 - val_loss: 2.7948 - val_accuracy20: 0.5702 - 27s/epoch - 46ms/step
Epoch 14/50
589/589 - 26s - loss: 2.5062 - accuracy20: 0.6184 - val_loss: 2.8060 - val_accuracy20: 0.5745 - 26s/epoch - 44ms/step
Epoch 15/50
589/589 - 27s - loss: 2.4971 - accuracy20: 0.6214 - val_loss: 2.7740 - val_accuracy20: 0.5599 - 27s/epoch - 45ms/step
Epoch 16/50
589/589 - 26s - loss: 2.4903 - accuracy20: 0.6208 - val_loss: 2.7648 - val_accuracy20: 0.5704 - 26s/epoch - 44ms/step
Epoch 17/50
589/589 - 26s - loss: 2.4785 - accuracy20: 0.6238 - val_loss: 2.7554 - val_accuracy20: 0.5753 - 26s/epoch - 44ms/step
Epoch 18/50
589/589 - 26s - loss: 2.4699 - accuracy20: 0.6240 - val_loss: 2.7518 - val_accuracy20: 0.5727 - 26s/epoch - 45ms/step
Epoch 19/50
589/589 - 27s - loss: 2.4611 - accuracy20: 0.6248 - val_loss: 2.7589 - val_accuracy20: 0.5721 - 27s/epoch - 46ms/step
Epoch 20/50
589/589 - 26s - loss: 2.4551 - accuracy20: 0.6256 - val_loss: 2.7695 - val_accuracy20: 0.5718 - 26s/epoch - 44ms/step
Epoch 21/50
589/589 - 26s - loss: 2.4428 - accuracy20: 0.6270 - val_loss: 2.7553 - val_accuracy20: 0.5680 - 26s/epoch - 44ms/step
Epoch 22/50
589/589 - 26s - loss: 2.4331 - accuracy20: 0.6276 - val_loss: 2.7593 - val_accuracy20: 0.5701 - 26s/epoch - 45ms/step
Epoch 23/50
589/589 - 26s - loss: 2.4229 - accuracy20: 0.6298 - val_loss: 2.7465 - val_accuracy20: 0.5805 - 26s/epoch - 45ms/step
Epoch 24/50
589/589 - 27s - loss: 2.4159 - accuracy20: 0.6312 - val_loss: 2.7598 - val_accuracy20: 0.5675 - 27s/epoch - 46ms/step
Epoch 25/50
589/589 - 27s - loss: 2.4077 - accuracy20: 0.6315 - val_loss: 2.7570 - val_accuracy20: 0.5709 - 27s/epoch - 46ms/step
Epoch 26/50
589/589 - 26s - loss: 2.3963 - accuracy20: 0.6326 - val_loss: 2.7469 - val_accuracy20: 0.5791 - 26s/epoch - 44ms/step
Epoch 27/50
589/589 - 26s - loss: 2.3827 - accuracy20: 0.6341 - val_loss: 2.7547 - val_accuracy20: 0.5804 - 26s/epoch - 44ms/step
Epoch 28/50
589/589 - 26s - loss: 2.3773 - accuracy20: 0.6342 - val_loss: 2.7501 - val_accuracy20: 0.5845 - 26s/epoch - 45ms/step
Epoch 29/50
589/589 - 27s - loss: 2.3689 - accuracy20: 0.6353 - val_loss: 2.7681 - val_accuracy20: 0.5800 - 27s/epoch - 45ms/step
Epoch 30/50
589/589 - 27s - loss: 2.3592 - accuracy20: 0.6366 - val_loss: 2.7847 - val_accuracy20: 0.5672 - 27s/epoch - 46ms/step
Epoch 31/50
589/589 - 27s - loss: 2.3505 - accuracy20: 0.6382 - val_loss: 2.7946 - val_accuracy20: 0.5802 - 27s/epoch - 47ms/step
Epoch 32/50
589/589 - 28s - loss: 2.3438 - accuracy20: 0.6391 - val_loss: 2.7717 - val_accuracy20: 0.5777 - 28s/epoch - 47ms/step
Epoch 33/50
589/589 - 28s - loss: 2.3362 - accuracy20: 0.6394 - val_loss: 2.7702 - val_accuracy20: 0.5873 - 28s/epoch - 47ms/step
testing model: results/QRTEA/W0/deepVOL_L3/h20
Evaluating performance on  test set...
2359/2359 - 49s - 49s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8090697
{'0': {'precision': 0.474630438538042, 'recall': 0.36234751071546323, 'f1-score': 0.4109574405572739, 'support': 106155}, '1': {'precision': 0.8428911803508956, 'recall': 0.660136430697421, 'f1-score': 0.7404031318827043, 'support': 389062}, '2': {'precision': 0.37492661896899654, 'recall': 0.7529542879774526, 'f1-score': 0.5005893861504971, 'support': 108571}, 'accuracy': 0.6244708407586769, 'macro avg': {'precision': 0.5641494126193114, 'recall': 0.5918127431301122, 'f1-score': 0.5506499861968251, 'support': 603788}, 'weighted avg': {'precision': 0.6939976954837938, 'recall': 0.6244708407586769, 'f1-score': 0.6393591801139666, 'support': 603788}}
[[ 38465  28388  39302]
 [ 35239 256834  96989]
 [  7338  19484  81749]]
Evaluating performance on  train set...
589/589 - 14s - 14s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84791946
{'0': {'precision': 0.4453099537187928, 'recall': 0.4484524239340926, 'f1-score': 0.4468756643608236, 'support': 30467}, '1': {'precision': 0.8084595813576964, 'recall': 0.6194590283777497, 'f1-score': 0.7014511658242295, 'support': 90282}, '2': {'precision': 0.4076740023993549, 'recall': 0.6919815729736948, 'f1-score': 0.513075009591228, 'support': 29956}, 'accuracy': 0.5993032746093361, 'macro avg': {'precision': 0.553814512491948, 'recall': 0.5866310084285123, 'f1-score': 0.5538006132587604, 'support': 150705}, 'weighted avg': {'precision': 0.6553789768087394, 'recall': 0.5993032746093361, 'f1-score': 0.6125413888480085, 'support': 150705}}
[[13663  7037  9767]
 [14005 55926 20351]
 [ 3014  6213 20729]]
Evaluating performance on  val set...
230/230 - 6s - 6s/epoch - 25ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8811426
{'0': {'precision': 0.45848822800495664, 'recall': 0.42344478051173057, 'f1-score': 0.4402702817559815, 'support': 12233}, '1': {'precision': 0.7866769945778467, 'recall': 0.5918242475452347, 'f1-score': 0.6754792903343809, 'support': 34321}, '2': {'precision': 0.3948023223666022, 'recall': 0.6985162237078102, 'f1-score': 0.5044747998115874, 'support': 12266}, 'accuracy': 0.579054743284597, 'macro avg': {'precision': 0.5466558483164685, 'recall': 0.5712617505882585, 'f1-score': 0.5400747906339832, 'support': 58820}, 'weighted avg': {'precision': 0.6367030416565735, 'recall': 0.579054743284597, 'f1-score': 0.5909017166741948, 'support': 58820}}
[[ 5180  3080  3973]
 [ 4848 20312  9161]
 [ 1270  2428  8568]]
training model: results/QRTEA/W0/deepVOL_L3/h30
Epoch 1/50
589/589 - 29s - loss: 3.2883 - accuracy30: 0.3894 - val_loss: 3.2479 - val_accuracy30: 0.4317 - 29s/epoch - 48ms/step
Epoch 2/50
589/589 - 26s - loss: 3.0421 - accuracy30: 0.5012 - val_loss: 3.0213 - val_accuracy30: 0.4812 - 26s/epoch - 43ms/step
Epoch 3/50
589/589 - 26s - loss: 2.8422 - accuracy30: 0.5502 - val_loss: 2.9375 - val_accuracy30: 0.5062 - 26s/epoch - 45ms/step
Epoch 4/50
589/589 - 26s - loss: 2.7625 - accuracy30: 0.5691 - val_loss: 2.8803 - val_accuracy30: 0.5306 - 26s/epoch - 44ms/step
Epoch 5/50
589/589 - 26s - loss: 2.7220 - accuracy30: 0.5764 - val_loss: 2.8762 - val_accuracy30: 0.5430 - 26s/epoch - 44ms/step
Epoch 6/50
589/589 - 26s - loss: 2.6957 - accuracy30: 0.5832 - val_loss: 2.8949 - val_accuracy30: 0.5392 - 26s/epoch - 44ms/step
Epoch 7/50
589/589 - 27s - loss: 2.6769 - accuracy30: 0.5877 - val_loss: 2.8725 - val_accuracy30: 0.5512 - 27s/epoch - 47ms/step
Epoch 8/50
589/589 - 29s - loss: 2.6623 - accuracy30: 0.5874 - val_loss: 2.8630 - val_accuracy30: 0.5487 - 29s/epoch - 49ms/step
Epoch 9/50
589/589 - 27s - loss: 2.6549 - accuracy30: 0.5903 - val_loss: 2.8711 - val_accuracy30: 0.5568 - 27s/epoch - 46ms/step
Epoch 10/50
589/589 - 28s - loss: 2.6407 - accuracy30: 0.5931 - val_loss: 2.8996 - val_accuracy30: 0.5595 - 28s/epoch - 47ms/step
Epoch 11/50
589/589 - 27s - loss: 2.6314 - accuracy30: 0.5937 - val_loss: 2.8736 - val_accuracy30: 0.5561 - 27s/epoch - 47ms/step
Epoch 12/50
589/589 - 28s - loss: 2.6229 - accuracy30: 0.5952 - val_loss: 2.8678 - val_accuracy30: 0.5510 - 28s/epoch - 47ms/step
Epoch 13/50
589/589 - 27s - loss: 2.6123 - accuracy30: 0.5973 - val_loss: 2.8528 - val_accuracy30: 0.5578 - 27s/epoch - 46ms/step
Epoch 14/50
589/589 - 28s - loss: 2.6044 - accuracy30: 0.5986 - val_loss: 2.8538 - val_accuracy30: 0.5654 - 28s/epoch - 48ms/step
Epoch 15/50
589/589 - 27s - loss: 2.5926 - accuracy30: 0.5998 - val_loss: 2.8549 - val_accuracy30: 0.5561 - 27s/epoch - 46ms/step
Epoch 16/50
589/589 - 27s - loss: 2.5842 - accuracy30: 0.6014 - val_loss: 2.8618 - val_accuracy30: 0.5599 - 27s/epoch - 47ms/step
Epoch 17/50
589/589 - 27s - loss: 2.5741 - accuracy30: 0.6023 - val_loss: 2.8511 - val_accuracy30: 0.5628 - 27s/epoch - 46ms/step
Epoch 18/50
589/589 - 28s - loss: 2.5633 - accuracy30: 0.6025 - val_loss: 2.8582 - val_accuracy30: 0.5579 - 28s/epoch - 47ms/step
Epoch 19/50
589/589 - 27s - loss: 2.5551 - accuracy30: 0.6038 - val_loss: 2.8509 - val_accuracy30: 0.5607 - 27s/epoch - 46ms/step
Epoch 20/50
589/589 - 27s - loss: 2.5453 - accuracy30: 0.6052 - val_loss: 2.8642 - val_accuracy30: 0.5531 - 27s/epoch - 46ms/step
Epoch 21/50
589/589 - 28s - loss: 2.5336 - accuracy30: 0.6071 - val_loss: 2.8620 - val_accuracy30: 0.5582 - 28s/epoch - 47ms/step
Epoch 22/50
589/589 - 28s - loss: 2.5254 - accuracy30: 0.6084 - val_loss: 2.8494 - val_accuracy30: 0.5562 - 28s/epoch - 48ms/step
Epoch 23/50
589/589 - 27s - loss: 2.5147 - accuracy30: 0.6084 - val_loss: 2.8542 - val_accuracy30: 0.5552 - 27s/epoch - 45ms/step
Epoch 24/50
589/589 - 27s - loss: 2.5066 - accuracy30: 0.6094 - val_loss: 2.8544 - val_accuracy30: 0.5515 - 27s/epoch - 47ms/step
Epoch 25/50
589/589 - 26s - loss: 2.5022 - accuracy30: 0.6088 - val_loss: 2.8529 - val_accuracy30: 0.5525 - 26s/epoch - 45ms/step
Epoch 26/50
589/589 - 28s - loss: 2.4914 - accuracy30: 0.6112 - val_loss: 2.8473 - val_accuracy30: 0.5547 - 28s/epoch - 47ms/step
Epoch 27/50
589/589 - 27s - loss: 2.4829 - accuracy30: 0.6126 - val_loss: 2.8499 - val_accuracy30: 0.5569 - 27s/epoch - 46ms/step
Epoch 28/50
589/589 - 28s - loss: 2.4749 - accuracy30: 0.6129 - val_loss: 2.8653 - val_accuracy30: 0.5567 - 28s/epoch - 47ms/step
Epoch 29/50
589/589 - 28s - loss: 2.4675 - accuracy30: 0.6141 - val_loss: 2.8599 - val_accuracy30: 0.5574 - 28s/epoch - 47ms/step
Epoch 30/50
589/589 - 27s - loss: 2.4579 - accuracy30: 0.6152 - val_loss: 2.8558 - val_accuracy30: 0.5521 - 27s/epoch - 45ms/step
Epoch 31/50
589/589 - 29s - loss: 2.4525 - accuracy30: 0.6155 - val_loss: 2.8614 - val_accuracy30: 0.5476 - 29s/epoch - 49ms/step
Epoch 32/50
589/589 - 27s - loss: 2.4434 - accuracy30: 0.6164 - val_loss: 2.8713 - val_accuracy30: 0.5522 - 27s/epoch - 46ms/step
Epoch 33/50
589/589 - 26s - loss: 2.4348 - accuracy30: 0.6183 - val_loss: 2.8742 - val_accuracy30: 0.5537 - 26s/epoch - 45ms/step
Epoch 34/50
589/589 - 26s - loss: 2.4291 - accuracy30: 0.6180 - val_loss: 2.8786 - val_accuracy30: 0.5593 - 26s/epoch - 43ms/step
Epoch 35/50
589/589 - 26s - loss: 2.4170 - accuracy30: 0.6208 - val_loss: 2.8759 - val_accuracy30: 0.5589 - 26s/epoch - 44ms/step
Epoch 36/50
589/589 - 28s - loss: 2.4127 - accuracy30: 0.6203 - val_loss: 2.8773 - val_accuracy30: 0.5537 - 28s/epoch - 47ms/step
testing model: results/QRTEA/W0/deepVOL_L3/h30
Evaluating performance on  test set...
2359/2359 - 47s - 47s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8584923
{'0': {'precision': 0.4635200665034868, 'recall': 0.4129098613568108, 'f1-score': 0.4367536988685814, 'support': 121535}, '1': {'precision': 0.787627920184358, 'recall': 0.6072824036647804, 'f1-score': 0.6857968836924012, 'support': 356256}, '2': {'precision': 0.40034414055424744, 'recall': 0.7016992468074637, 'f1-score': 0.5098187332954675, 'support': 125997}, 'accuracy': 0.5878603085851325, 'macro avg': {'precision': 0.550497375747364, 'recall': 0.5739638372763516, 'f1-score': 0.5441231052854834, 'support': 603788}, 'weighted avg': {'precision': 0.6415716183380813, 'recall': 0.5878603085851325, 'f1-score': 0.598944905045715, 'support': 603788}}
[[ 50183  32612  38740]
 [ 46220 216348  93688]
 [ 11862  25723  88412]]
Evaluating performance on  train set...
589/589 - 12s - 12s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8837709
{'0': {'precision': 0.4338755562039536, 'recall': 0.5105433320935023, 'f1-score': 0.46909750519203974, 'support': 34951}, '1': {'precision': 0.736967343999499, 'recall': 0.577896171173936, 'f1-score': 0.6478096037539821, 'support': 81461}, '2': {'precision': 0.45549234135667394, 'recall': 0.60700434491004, 'f1-score': 0.5204455389846611, 'support': 34293}, 'accuracy': 0.5688995056567466, 'macro avg': {'precision': 0.5421117471867088, 'recall': 0.5651479493924928, 'f1-score': 0.5457842159768943, 'support': 150705}, 'weighted avg': {'precision': 0.6026255282609867, 'recall': 0.5688995056567466, 'f1-score': 0.5773815328208824, 'support': 150705}}
[[17844  8073  9034]
 [18535 47076 15850]
 [ 4748  8729 20816]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9195298
{'0': {'precision': 0.4501849983181971, 'recall': 0.47616336985911484, 'f1-score': 0.46280991735537186, 'support': 14054}, '1': {'precision': 0.7104686272076767, 'recall': 0.561633533873921, 'f1-score': 0.6273442778619821, 'support': 30584}, '2': {'precision': 0.4410456062291435, 'recall': 0.6150754477506699, 'f1-score': 0.5137220259128387, 'support': 14182}, 'accuracy': 0.5540972458347501, 'macro avg': {'precision': 0.533899743918339, 'recall': 0.5509574504945686, 'f1-score': 0.5346254070433974, 'support': 58820}, 'weighted avg': {'precision': 0.5833182803200482, 'recall': 0.5540972458347501, 'f1-score': 0.5606364118350754, 'support': 58820}}
[[ 6692  3603  3759]
 [ 6111 17177  7296]
 [ 2062  3397  8723]]
training model: results/QRTEA/W0/deepVOL_L3/h50
Epoch 1/50
589/589 - 29s - loss: 3.2905 - accuracy50: 0.3870 - val_loss: 3.2973 - val_accuracy50: 0.3923 - 29s/epoch - 48ms/step
Epoch 2/50
589/589 - 27s - loss: 3.1426 - accuracy50: 0.4535 - val_loss: 3.2134 - val_accuracy50: 0.4582 - 27s/epoch - 46ms/step
Epoch 3/50
589/589 - 28s - loss: 3.0018 - accuracy50: 0.5036 - val_loss: 3.1118 - val_accuracy50: 0.4516 - 28s/epoch - 47ms/step
Epoch 4/50
589/589 - 26s - loss: 2.9135 - accuracy50: 0.5252 - val_loss: 3.0885 - val_accuracy50: 0.4692 - 26s/epoch - 44ms/step
Epoch 5/50
589/589 - 26s - loss: 2.8746 - accuracy50: 0.5354 - val_loss: 3.0534 - val_accuracy50: 0.4858 - 26s/epoch - 44ms/step
Epoch 6/50
589/589 - 26s - loss: 2.8474 - accuracy50: 0.5415 - val_loss: 3.0317 - val_accuracy50: 0.4906 - 26s/epoch - 44ms/step
Epoch 7/50
589/589 - 26s - loss: 2.8295 - accuracy50: 0.5472 - val_loss: 3.0391 - val_accuracy50: 0.4929 - 26s/epoch - 45ms/step
Epoch 8/50
589/589 - 26s - loss: 2.8158 - accuracy50: 0.5497 - val_loss: 3.0249 - val_accuracy50: 0.5024 - 26s/epoch - 44ms/step
Epoch 9/50
589/589 - 26s - loss: 2.8031 - accuracy50: 0.5516 - val_loss: 3.0172 - val_accuracy50: 0.5041 - 26s/epoch - 44ms/step
Epoch 10/50
589/589 - 27s - loss: 2.7942 - accuracy50: 0.5532 - val_loss: 3.0159 - val_accuracy50: 0.5028 - 27s/epoch - 45ms/step
Epoch 11/50
589/589 - 25s - loss: 2.7820 - accuracy50: 0.5562 - val_loss: 3.0101 - val_accuracy50: 0.5045 - 25s/epoch - 43ms/step
Epoch 12/50
589/589 - 26s - loss: 2.7734 - accuracy50: 0.5576 - val_loss: 3.0067 - val_accuracy50: 0.5127 - 26s/epoch - 44ms/step
Epoch 13/50
589/589 - 25s - loss: 2.7639 - accuracy50: 0.5594 - val_loss: 3.0122 - val_accuracy50: 0.5094 - 25s/epoch - 43ms/step
Epoch 14/50
589/589 - 26s - loss: 2.7556 - accuracy50: 0.5611 - val_loss: 3.0134 - val_accuracy50: 0.5017 - 26s/epoch - 43ms/step
Epoch 15/50
589/589 - 25s - loss: 2.7511 - accuracy50: 0.5627 - val_loss: 3.0077 - val_accuracy50: 0.5085 - 25s/epoch - 42ms/step
Epoch 16/50
589/589 - 25s - loss: 2.7427 - accuracy50: 0.5643 - val_loss: 2.9958 - val_accuracy50: 0.5090 - 25s/epoch - 43ms/step
Epoch 17/50
589/589 - 25s - loss: 2.7368 - accuracy50: 0.5642 - val_loss: 3.0139 - val_accuracy50: 0.5047 - 25s/epoch - 42ms/step
Epoch 18/50
589/589 - 26s - loss: 2.7247 - accuracy50: 0.5668 - val_loss: 3.0157 - val_accuracy50: 0.5037 - 26s/epoch - 44ms/step
Epoch 19/50
589/589 - 25s - loss: 2.7173 - accuracy50: 0.5672 - val_loss: 3.0138 - val_accuracy50: 0.5052 - 25s/epoch - 42ms/step
Epoch 20/50
589/589 - 25s - loss: 2.7083 - accuracy50: 0.5695 - val_loss: 3.0350 - val_accuracy50: 0.5060 - 25s/epoch - 43ms/step
Epoch 21/50
589/589 - 25s - loss: 2.7007 - accuracy50: 0.5699 - val_loss: 3.0394 - val_accuracy50: 0.5086 - 25s/epoch - 42ms/step
Epoch 22/50
589/589 - 25s - loss: 2.6909 - accuracy50: 0.5727 - val_loss: 3.0529 - val_accuracy50: 0.5067 - 25s/epoch - 42ms/step
Epoch 23/50
589/589 - 25s - loss: 2.6834 - accuracy50: 0.5743 - val_loss: 3.0408 - val_accuracy50: 0.5057 - 25s/epoch - 42ms/step
Epoch 24/50
589/589 - 26s - loss: 2.6764 - accuracy50: 0.5753 - val_loss: 3.0469 - val_accuracy50: 0.5060 - 26s/epoch - 45ms/step
Epoch 25/50
589/589 - 28s - loss: 2.6698 - accuracy50: 0.5774 - val_loss: 3.0533 - val_accuracy50: 0.5072 - 28s/epoch - 47ms/step
Epoch 26/50
589/589 - 26s - loss: 2.6587 - accuracy50: 0.5779 - val_loss: 3.0552 - val_accuracy50: 0.4972 - 26s/epoch - 44ms/step
testing model: results/QRTEA/W0/deepVOL_L3/h50
Evaluating performance on  test set...
2359/2359 - 46s - 46s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9424971
{'0': {'precision': 0.46054160561814783, 'recall': 0.3834526371877476, 'f1-score': 0.41847653515231975, 'support': 142633}, '1': {'precision': 0.6843417999273841, 'recall': 0.5613614806134044, 'f1-score': 0.6167811100025431, 'support': 308899}, '2': {'precision': 0.4105991141502836, 'recall': 0.6246847414880202, 'f1-score': 0.49550661894565734, 'support': 152256}, 'accuracy': 0.5353021259117439, 'macro avg': {'precision': 0.5184941732319385, 'recall': 0.5231662864297241, 'f1-score': 0.5102547547001735, 'support': 603788}, 'weighted avg': {'precision': 0.5624442804659382, 'recall': 0.5353021259117439, 'f1-score': 0.539354024113176, 'support': 603788}}
[[ 54693  43476  44464]
 [ 43429 173404  92066]
 [ 20636  36508  95112]]
Evaluating performance on  train set...
589/589 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9670132
{'0': {'precision': 0.44390711255075505, 'recall': 0.47623709069551173, 'f1-score': 0.45950413223140496, 'support': 40862}, '1': {'precision': 0.6323303575948833, 'recall': 0.537566532286989, 'f1-score': 0.5811104218362283, 'support': 69703}, '2': {'precision': 0.45072463768115945, 'recall': 0.5346038863976084, 'f1-score': 0.48909401709401706, 'support': 40140}, 'accuracy': 0.5201486347500083, 'macro avg': {'precision': 0.5089873692755993, 'recall': 0.5161358364600364, 'f1-score': 0.5099028570538834, 'support': 150705}, 'weighted avg': {'precision': 0.5328711210975539, 'recall': 0.5201486347500083, 'f1-score': 0.523629816068771, 'support': 150705}}
[[19460 11467  9935]
 [16017 37470 16216]
 [ 8361 10320 21459]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.985643
{'0': {'precision': 0.4676328502415459, 'recall': 0.41051738761662426, 'f1-score': 0.43721770551038847, 'support': 16506}, '1': {'precision': 0.6004872107186358, 'recall': 0.5210192578675434, 'f1-score': 0.5579377554228229, 'support': 25548}, '2': {'precision': 0.43974191219600234, 'recall': 0.581295478945485, 'f1-score': 0.5007064142413111, 'support': 16766}, 'accuracy': 0.5071914314858892, 'macro avg': {'precision': 0.5026206577187281, 'recall': 0.5042773748098842, 'f1-score': 0.49862062505817417, 'support': 58820}, 'weighted avg': {'precision': 0.5173870789766208, 'recall': 0.5071914314858892, 'f1-score': 0.5077482652816486, 'support': 58820}}
[[ 6776  4873  4857]
 [ 4677 13311  7560]
 [ 3037  3983  9746]]
training model: results/QRTEA/W0/deepVOL_L3/h100
Epoch 1/50
589/589 - 28s - loss: 3.3022 - accuracy100: 0.3773 - val_loss: 3.2782 - val_accuracy100: 0.3834 - 28s/epoch - 48ms/step
Epoch 2/50
589/589 - 26s - loss: 3.2007 - accuracy100: 0.4254 - val_loss: 3.2457 - val_accuracy100: 0.4116 - 26s/epoch - 44ms/step
Epoch 3/50
589/589 - 26s - loss: 3.0917 - accuracy100: 0.4630 - val_loss: 3.1855 - val_accuracy100: 0.4268 - 26s/epoch - 45ms/step
Epoch 4/50
589/589 - 27s - loss: 3.0381 - accuracy100: 0.4795 - val_loss: 3.1509 - val_accuracy100: 0.4294 - 27s/epoch - 45ms/step
Epoch 5/50
589/589 - 27s - loss: 3.0185 - accuracy100: 0.4850 - val_loss: 3.1259 - val_accuracy100: 0.4400 - 27s/epoch - 45ms/step
Epoch 6/50
589/589 - 25s - loss: 2.9977 - accuracy100: 0.4887 - val_loss: 3.1269 - val_accuracy100: 0.4394 - 25s/epoch - 43ms/step
Epoch 7/50
589/589 - 25s - loss: 2.9836 - accuracy100: 0.4919 - val_loss: 3.1260 - val_accuracy100: 0.4353 - 25s/epoch - 42ms/step
Epoch 8/50
589/589 - 25s - loss: 2.9719 - accuracy100: 0.4947 - val_loss: 3.1259 - val_accuracy100: 0.4390 - 25s/epoch - 43ms/step
Epoch 9/50
589/589 - 25s - loss: 2.9566 - accuracy100: 0.4998 - val_loss: 3.1276 - val_accuracy100: 0.4406 - 25s/epoch - 43ms/step
Epoch 10/50
589/589 - 25s - loss: 2.9489 - accuracy100: 0.5020 - val_loss: 3.1161 - val_accuracy100: 0.4462 - 25s/epoch - 43ms/step
Epoch 11/50
589/589 - 25s - loss: 2.9414 - accuracy100: 0.5053 - val_loss: 3.1305 - val_accuracy100: 0.4414 - 25s/epoch - 43ms/step
Epoch 12/50
589/589 - 25s - loss: 2.9307 - accuracy100: 0.5079 - val_loss: 3.1039 - val_accuracy100: 0.4429 - 25s/epoch - 42ms/step
Epoch 13/50
589/589 - 25s - loss: 2.9259 - accuracy100: 0.5079 - val_loss: 3.1106 - val_accuracy100: 0.4441 - 25s/epoch - 42ms/step
Epoch 14/50
589/589 - 25s - loss: 2.9184 - accuracy100: 0.5102 - val_loss: 3.1343 - val_accuracy100: 0.4429 - 25s/epoch - 42ms/step
Epoch 15/50
589/589 - 25s - loss: 2.9091 - accuracy100: 0.5132 - val_loss: 3.1578 - val_accuracy100: 0.4420 - 25s/epoch - 43ms/step
Epoch 16/50
589/589 - 25s - loss: 2.8983 - accuracy100: 0.5158 - val_loss: 3.1843 - val_accuracy100: 0.4422 - 25s/epoch - 42ms/step
Epoch 17/50
589/589 - 25s - loss: 2.8859 - accuracy100: 0.5196 - val_loss: 3.2097 - val_accuracy100: 0.4359 - 25s/epoch - 42ms/step
Epoch 18/50
589/589 - 25s - loss: 2.8766 - accuracy100: 0.5210 - val_loss: 3.2045 - val_accuracy100: 0.4405 - 25s/epoch - 43ms/step
Epoch 19/50
589/589 - 26s - loss: 2.8611 - accuracy100: 0.5262 - val_loss: 3.2174 - val_accuracy100: 0.4391 - 26s/epoch - 43ms/step
Epoch 20/50
589/589 - 26s - loss: 2.8536 - accuracy100: 0.5266 - val_loss: 3.2107 - val_accuracy100: 0.4374 - 26s/epoch - 44ms/step
Epoch 21/50
589/589 - 25s - loss: 2.8454 - accuracy100: 0.5293 - val_loss: 3.2532 - val_accuracy100: 0.4308 - 25s/epoch - 43ms/step
Epoch 22/50
589/589 - 24s - loss: 2.8323 - accuracy100: 0.5332 - val_loss: 3.2471 - val_accuracy100: 0.4351 - 24s/epoch - 41ms/step
testing model: results/QRTEA/W0/deepVOL_L3/h100
Evaluating performance on  test set...
2359/2359 - 44s - 44s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0241691
{'0': {'precision': 0.4437435610099951, 'recall': 0.28201225640819466, 'f1-score': 0.3448573746255711, 'support': 174113}, '1': {'precision': 0.4822448460665806, 'recall': 0.41898097993482963, 'f1-score': 0.4483924280553869, 'support': 235383}, '2': {'precision': 0.4135848664380002, 'recall': 0.614399975294917, 'f1-score': 0.4943779740827712, 'support': 194292}, 'accuracy': 0.442367188483375, 'macro avg': {'precision': 0.4465244245048587, 'recall': 0.43846440387931374, 'f1-score': 0.42920925892124306, 'support': 603788}, 'weighted avg': {'precision': 0.4490483284030076, 'recall': 0.442367188483375, 'f1-score': 0.43333387265337003, 'support': 603788}}
[[ 49102  52201  72810]
 [ 40315  98621  96447]
 [ 21237  53682 119373]]
Evaluating performance on  train set...
589/589 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0121881
{'0': {'precision': 0.4648963766701068, 'recall': 0.3339678595760029, 'f1-score': 0.38870296302342666, 'support': 49906}, '1': {'precision': 0.46195021048047613, 'recall': 0.493037937912737, 'f1-score': 0.47698807482974076, 'support': 51637}, '2': {'precision': 0.46098222356131363, 'recall': 0.5601887636792645, 'f1-score': 0.5057665466833174, 'support': 49162}, 'accuracy': 0.4622673434856176, 'macro avg': {'precision': 0.4626096035706322, 'recall': 0.4623981870560015, 'f1-score': 0.4571525281788283, 'support': 150705}, 'weighted avg': {'precision': 0.46261006381606445, 'recall': 0.4622673434856176, 'f1-score': 0.45714036203626757, 'support': 150705}}
[[16667 15537 17702]
 [11678 25459 14500]
 [ 7506 14116 27540]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0342796
{'0': {'precision': 0.4915370736317553, 'recall': 0.28968555369892146, 'f1-score': 0.3645342168981776, 'support': 19749}, '1': {'precision': 0.40701105165774865, 'recall': 0.44388089005235604, 'f1-score': 0.4246471708449639, 'support': 18336}, '2': {'precision': 0.4483887580929959, 'recall': 0.5878466361224982, 'f1-score': 0.5087334877605961, 'support': 20735}, 'accuracy': 0.44285957157429445, 'macro avg': {'precision': 0.44897896112749996, 'recall': 0.4404710266245919, 'f1-score': 0.4326382918345792, 'support': 58820}, 'weighted avg': {'precision': 0.44997723919429244, 'recall': 0.44285957157429445, 'f1-score': 0.4341058422790093, 'support': 58820}}
[[ 5721  6120  7908]
 [ 3110  8139  7087]
 [ 2808  5738 12189]]
training model: results/QRTEA/W0/deepVOL_L3/h200
Epoch 1/50
589/589 - 29s - loss: 3.3185 - accuracy200: 0.3643 - val_loss: 3.3729 - val_accuracy200: 0.3062 - 29s/epoch - 48ms/step
Epoch 2/50
589/589 - 25s - loss: 3.2984 - accuracy200: 0.3558 - val_loss: 3.3831 - val_accuracy200: 0.2966 - 25s/epoch - 43ms/step
Epoch 3/50
589/589 - 25s - loss: 3.2824 - accuracy200: 0.3670 - val_loss: 3.3588 - val_accuracy200: 0.3003 - 25s/epoch - 42ms/step
Epoch 4/50
589/589 - 26s - loss: 3.2600 - accuracy200: 0.3874 - val_loss: 3.3530 - val_accuracy200: 0.3151 - 26s/epoch - 44ms/step
Epoch 5/50
589/589 - 26s - loss: 3.2390 - accuracy200: 0.4021 - val_loss: 3.3466 - val_accuracy200: 0.3310 - 26s/epoch - 44ms/step
Epoch 6/50
589/589 - 26s - loss: 3.2251 - accuracy200: 0.4113 - val_loss: 3.3267 - val_accuracy200: 0.3439 - 26s/epoch - 43ms/step
Epoch 7/50
589/589 - 25s - loss: 3.2098 - accuracy200: 0.4179 - val_loss: 3.3396 - val_accuracy200: 0.3426 - 25s/epoch - 42ms/step
Epoch 8/50
589/589 - 25s - loss: 3.2033 - accuracy200: 0.4223 - val_loss: 3.3289 - val_accuracy200: 0.3530 - 25s/epoch - 42ms/step
Epoch 9/50
589/589 - 25s - loss: 3.1903 - accuracy200: 0.4292 - val_loss: 3.3250 - val_accuracy200: 0.3719 - 25s/epoch - 43ms/step
Epoch 10/50
589/589 - 25s - loss: 3.1792 - accuracy200: 0.4341 - val_loss: 3.3497 - val_accuracy200: 0.3709 - 25s/epoch - 43ms/step
Epoch 11/50
589/589 - 25s - loss: 3.1674 - accuracy200: 0.4380 - val_loss: 3.3604 - val_accuracy200: 0.3747 - 25s/epoch - 43ms/step
Epoch 12/50
589/589 - 25s - loss: 3.1577 - accuracy200: 0.4418 - val_loss: 3.3755 - val_accuracy200: 0.3798 - 25s/epoch - 42ms/step
Epoch 13/50
589/589 - 25s - loss: 3.1497 - accuracy200: 0.4456 - val_loss: 3.3857 - val_accuracy200: 0.3759 - 25s/epoch - 43ms/step
Epoch 14/50
589/589 - 25s - loss: 3.1357 - accuracy200: 0.4510 - val_loss: 3.3973 - val_accuracy200: 0.3791 - 25s/epoch - 42ms/step
Epoch 15/50
589/589 - 25s - loss: 3.1222 - accuracy200: 0.4560 - val_loss: 3.4163 - val_accuracy200: 0.3832 - 25s/epoch - 43ms/step
Epoch 16/50
589/589 - 26s - loss: 3.1105 - accuracy200: 0.4612 - val_loss: 3.4682 - val_accuracy200: 0.3766 - 26s/epoch - 44ms/step
Epoch 17/50
589/589 - 26s - loss: 3.0931 - accuracy200: 0.4675 - val_loss: 3.4602 - val_accuracy200: 0.3762 - 26s/epoch - 45ms/step
Epoch 18/50
589/589 - 26s - loss: 3.0844 - accuracy200: 0.4707 - val_loss: 3.5040 - val_accuracy200: 0.3774 - 26s/epoch - 45ms/step
Epoch 19/50
589/589 - 26s - loss: 3.0732 - accuracy200: 0.4740 - val_loss: 3.5120 - val_accuracy200: 0.3748 - 26s/epoch - 44ms/step
testing model: results/QRTEA/W0/deepVOL_L3/h200
Evaluating performance on  test set...
2359/2359 - 47s - 47s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0858219
{'0': {'precision': 0.4122405281627312, 'recall': 0.1588103544076117, 'f1-score': 0.22928977566422, 'support': 174573}, '1': {'precision': 0.3891034117958212, 'recall': 0.5634038872219068, 'f1-score': 0.4603059209376029, 'support': 221958}, '2': {'precision': 0.4039023755408992, 'recall': 0.41928620022484164, 'f1-score': 0.41145054070945625, 'support': 207257}, 'accuracy': 0.3969538977256918, 'macro avg': {'precision': 0.40174877183315055, 'recall': 0.3805001472847867, 'f1-score': 0.36701541243709307, 'support': 603788}, 'weighted avg': {'precision': 0.4008729478654917, 'recall': 0.3969538977256918, 'f1-score': 0.3767421517524663, 'support': 603788}}
[[ 27724  92214  54635]
 [ 23290 125052  73616]
 [ 16238 104119  86900]]
Evaluating performance on  train set...
589/589 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0889301
{'0': {'precision': 0.42780979262221175, 'recall': 0.21498364918639928, 'f1-score': 0.28616381062264823, 'support': 50762}, '1': {'precision': 0.35262945330379764, 'recall': 0.5767906473956039, 'f1-score': 0.4376780112863902, 'support': 49954}, '2': {'precision': 0.4258284084898935, 'recall': 0.37044149712936847, 'f1-score': 0.3962086524883393, 'support': 49989}, 'accuracy': 0.38647689194120965, 'macro avg': {'precision': 0.40208921813863435, 'recall': 0.38740526457045715, 'f1-score': 0.37335015813245925, 'support': 150705}, 'weighted avg': {'precision': 0.40223263140193033, 'recall': 0.38647689194120965, 'f1-score': 0.3728880200382655, 'support': 150705}}
[[10913 27294 12555]
 [ 8727 28813 12414]
 [ 5869 25602 18518]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1086463
{'0': {'precision': 0.42474834274490547, 'recall': 0.17578621145150639, 'f1-score': 0.2486614682525423, 'support': 19683}, '1': {'precision': 0.31206477193216275, 'recall': 0.5379357877204066, 'f1-score': 0.39498987854251016, 'support': 17411}, '2': {'precision': 0.4427181646580514, 'recall': 0.42101629384148026, 'f1-score': 0.43159459268171846, 'support': 21726}, 'accuracy': 0.37356341380482827, 'macro avg': {'precision': 0.3931770931117065, 'recall': 0.3782460976711311, 'f1-score': 0.3584153131589236, 'support': 58820}, 'weighted avg': {'precision': 0.39803087758788996, 'recall': 0.37356341380482827, 'f1-score': 0.35954431444273127, 'support': 58820}}
[[ 3460 10400  5823]
 [ 2354  9366  5691]
 [ 2332 10247  9147]]
training model: results/QRTEA/W0/deepVOL_L3/h300
Epoch 1/50
589/589 - 28s - loss: 3.3234 - accuracy300: 0.3547 - val_loss: 3.3385 - val_accuracy300: 0.3173 - 28s/epoch - 48ms/step
Epoch 2/50
589/589 - 27s - loss: 3.3010 - accuracy300: 0.3417 - val_loss: 3.3339 - val_accuracy300: 0.3231 - 27s/epoch - 46ms/step
Epoch 3/50
589/589 - 26s - loss: 3.2954 - accuracy300: 0.3462 - val_loss: 3.3407 - val_accuracy300: 0.3228 - 26s/epoch - 45ms/step
Epoch 4/50
589/589 - 26s - loss: 3.2867 - accuracy300: 0.3588 - val_loss: 3.3009 - val_accuracy300: 0.3492 - 26s/epoch - 44ms/step
Epoch 5/50
589/589 - 26s - loss: 3.2760 - accuracy300: 0.3723 - val_loss: 3.3035 - val_accuracy300: 0.3537 - 26s/epoch - 44ms/step
Epoch 6/50
589/589 - 26s - loss: 3.2673 - accuracy300: 0.3783 - val_loss: 3.2993 - val_accuracy300: 0.3646 - 26s/epoch - 45ms/step
Epoch 7/50
589/589 - 26s - loss: 3.2584 - accuracy300: 0.3880 - val_loss: 3.2987 - val_accuracy300: 0.3688 - 26s/epoch - 45ms/step
Epoch 8/50
589/589 - 26s - loss: 3.2560 - accuracy300: 0.3872 - val_loss: 3.2993 - val_accuracy300: 0.3704 - 26s/epoch - 44ms/step
Epoch 9/50
589/589 - 27s - loss: 3.2462 - accuracy300: 0.3947 - val_loss: 3.3174 - val_accuracy300: 0.3588 - 27s/epoch - 45ms/step
Epoch 10/50
589/589 - 26s - loss: 3.2320 - accuracy300: 0.4049 - val_loss: 3.3218 - val_accuracy300: 0.3645 - 26s/epoch - 45ms/step
Epoch 11/50
589/589 - 26s - loss: 3.2264 - accuracy300: 0.4054 - val_loss: 3.3263 - val_accuracy300: 0.3603 - 26s/epoch - 43ms/step
Epoch 12/50
589/589 - 25s - loss: 3.2199 - accuracy300: 0.4101 - val_loss: 3.3239 - val_accuracy300: 0.3670 - 25s/epoch - 43ms/step
Epoch 13/50
589/589 - 25s - loss: 3.2056 - accuracy300: 0.4176 - val_loss: 3.3506 - val_accuracy300: 0.3586 - 25s/epoch - 43ms/step
Epoch 14/50
589/589 - 25s - loss: 3.1947 - accuracy300: 0.4237 - val_loss: 3.3657 - val_accuracy300: 0.3581 - 25s/epoch - 43ms/step
Epoch 15/50
589/589 - 26s - loss: 3.1783 - accuracy300: 0.4339 - val_loss: 3.3906 - val_accuracy300: 0.3561 - 26s/epoch - 43ms/step
Epoch 16/50
589/589 - 26s - loss: 3.1628 - accuracy300: 0.4416 - val_loss: 3.4150 - val_accuracy300: 0.3514 - 26s/epoch - 44ms/step
Epoch 17/50
589/589 - 26s - loss: 3.1500 - accuracy300: 0.4452 - val_loss: 3.4305 - val_accuracy300: 0.3524 - 26s/epoch - 45ms/step
testing model: results/QRTEA/W0/deepVOL_L3/h300
Evaluating performance on  test set...
2359/2359 - 47s - 47s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0925274
{'0': {'precision': 0.36993356458345583, 'recall': 0.3355321043678578, 'f1-score': 0.3518940548460792, 'support': 187529}, '1': {'precision': 0.3075961361303398, 'recall': 0.24398212906323724, 'f1-score': 0.2721208028687189, 'support': 191596}, '2': {'precision': 0.4043396775590467, 'recall': 0.5070394323942973, 'f1-score': 0.4499031377063878, 'support': 224663}, 'accuracy': 0.3702971904045791, 'macro avg': {'precision': 0.36062312609094743, 'recall': 0.36218455527513077, 'f1-score': 0.35797266514039533, 'support': 603788}, 'weighted avg': {'precision': 0.36295458954177223, 'recall': 0.3702971904045791, 'f1-score': 0.36304826559023307, 'support': 603788}}
[[ 62922  48583  76024]
 [ 53061  46746  91789]
 [ 54107  56643 113913]]
Evaluating performance on  train set...
589/589 - 12s - 12s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0850009
{'0': {'precision': 0.4076137246918607, 'recall': 0.43344353918211515, 'f1-score': 0.4201320006104074, 'support': 50814}, '1': {'precision': 0.35181387293774496, 'recall': 0.30464896010103004, 'f1-score': 0.32653708677904447, 'support': 50678}, '2': {'precision': 0.3960634247068407, 'recall': 0.4248267734135289, 'f1-score': 0.40994117647058825, 'support': 49213}, 'accuracy': 0.3873195978899174, 'macro avg': {'precision': 0.38516367411214875, 'recall': 0.3876397575655581, 'f1-score': 0.3855367546200134, 'support': 150705}, 'weighted avg': {'precision': 0.3850779773685611, 'recall': 0.3873195978899174, 'f1-score': 0.3853307393945305, 'support': 150705}}
[[22025 14521 14268]
 [17627 15439 17612]
 [14382 13924 20907]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0982062
{'0': {'precision': 0.38607704266712733, 'recall': 0.34061468122936245, 'f1-score': 0.36192378279175214, 'support': 19685}, '1': {'precision': 0.29535500586021834, 'recall': 0.2740070962572966, 'f1-score': 0.2842808371678789, 'support': 17474}, '2': {'precision': 0.4047222882497425, 'recall': 0.4716310419648216, 'f1-score': 0.4356224548536341, 'support': 21661}, 'accuracy': 0.3690751445086705, 'macro avg': {'precision': 0.36205144559236274, 'recall': 0.3620842731504936, 'f1-score': 0.360609024937755, 'support': 58820}, 'weighted avg': {'precision': 0.36599200005238913, 'recall': 0.3690751445086705, 'f1-score': 0.36599814701652034, 'support': 58820}}
[[ 6705  5633  7347]
 [ 5007  4788  7679]
 [ 5655  5790 10216]]
training model: results/QRTEA/W0/deepVOL_L3/h500
Epoch 1/50
589/589 - 27s - loss: 3.3311 - accuracy500: 0.3493 - val_loss: 3.3668 - val_accuracy500: 0.3236 - 27s/epoch - 46ms/step
Epoch 2/50
589/589 - 25s - loss: 3.3083 - accuracy500: 0.3415 - val_loss: 3.3242 - val_accuracy500: 0.3169 - 25s/epoch - 43ms/step
Epoch 3/50
589/589 - 25s - loss: 3.2989 - accuracy500: 0.3450 - val_loss: 3.3067 - val_accuracy500: 0.3124 - 25s/epoch - 43ms/step
Epoch 4/50
589/589 - 26s - loss: 3.2905 - accuracy500: 0.3587 - val_loss: 3.3023 - val_accuracy500: 0.3184 - 26s/epoch - 44ms/step
Epoch 5/50
589/589 - 26s - loss: 3.2817 - accuracy500: 0.3679 - val_loss: 3.2992 - val_accuracy500: 0.3202 - 26s/epoch - 44ms/step
Epoch 6/50
589/589 - 26s - loss: 3.2816 - accuracy500: 0.3685 - val_loss: 3.3055 - val_accuracy500: 0.3193 - 26s/epoch - 45ms/step
Epoch 7/50
589/589 - 26s - loss: 3.2735 - accuracy500: 0.3746 - val_loss: 3.2988 - val_accuracy500: 0.3418 - 26s/epoch - 44ms/step
Epoch 8/50
589/589 - 25s - loss: 3.2675 - accuracy500: 0.3825 - val_loss: 3.2943 - val_accuracy500: 0.3567 - 25s/epoch - 42ms/step
Epoch 9/50
589/589 - 25s - loss: 3.2598 - accuracy500: 0.3875 - val_loss: 3.3109 - val_accuracy500: 0.3491 - 25s/epoch - 43ms/step
Epoch 10/50
589/589 - 25s - loss: 3.2515 - accuracy500: 0.3925 - val_loss: 3.3158 - val_accuracy500: 0.3487 - 25s/epoch - 42ms/step
Epoch 11/50
589/589 - 26s - loss: 3.2411 - accuracy500: 0.4012 - val_loss: 3.3247 - val_accuracy500: 0.3481 - 26s/epoch - 43ms/step
Epoch 12/50
589/589 - 25s - loss: 3.2288 - accuracy500: 0.4102 - val_loss: 3.3416 - val_accuracy500: 0.3460 - 25s/epoch - 43ms/step
Epoch 13/50
589/589 - 26s - loss: 3.2129 - accuracy500: 0.4161 - val_loss: 3.3590 - val_accuracy500: 0.3487 - 26s/epoch - 43ms/step
Epoch 14/50
589/589 - 25s - loss: 3.2029 - accuracy500: 0.4217 - val_loss: 3.3651 - val_accuracy500: 0.3465 - 25s/epoch - 43ms/step
Epoch 15/50
589/589 - 25s - loss: 3.1815 - accuracy500: 0.4306 - val_loss: 3.3957 - val_accuracy500: 0.3470 - 25s/epoch - 42ms/step
Epoch 16/50
589/589 - 25s - loss: 3.1603 - accuracy500: 0.4384 - val_loss: 3.4133 - val_accuracy500: 0.3458 - 25s/epoch - 43ms/step
Epoch 17/50
589/589 - 25s - loss: 3.1501 - accuracy500: 0.4411 - val_loss: 3.4244 - val_accuracy500: 0.3390 - 25s/epoch - 43ms/step
Epoch 18/50
589/589 - 25s - loss: 3.1238 - accuracy500: 0.4528 - val_loss: 3.4568 - val_accuracy500: 0.3366 - 25s/epoch - 43ms/step
testing model: results/QRTEA/W0/deepVOL_L3/h500
Evaluating performance on  test set...
2359/2359 - 46s - 46s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0977432
{'0': {'precision': 0.4024306714202919, 'recall': 0.22409122470734355, 'f1-score': 0.28787878787878785, 'support': 204506}, '1': {'precision': 0.27575743667416325, 'recall': 0.32770919316618485, 'f1-score': 0.29949708107629075, 'support': 165003}, '2': {'precision': 0.4190068102688371, 'recall': 0.5254973770589767, 'f1-score': 0.46624881651202427, 'support': 234279}, 'accuracy': 0.36935811907490707, 'macro avg': {'precision': 0.36573163945443077, 'recall': 0.3590992649775017, 'f1-score': 0.35120822848903427, 'support': 603788}, 'weighted avg': {'precision': 0.37424524454940816, 'recall': 0.36935811907490707, 'f1-score': 0.36026413699243964, 'support': 603788}}
[[ 45828  68308  90370]
 [ 30592  54073  80338]
 [ 37458  73708 123113]]
Evaluating performance on  train set...
589/589 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0922868
{'0': {'precision': 0.44928195464292675, 'recall': 0.26154224433054035, 'f1-score': 0.33061961290631087, 'support': 52871}, '1': {'precision': 0.3267171784644159, 'recall': 0.362905961163402, 'f1-score': 0.3438620454157419, 'support': 47172}, '2': {'precision': 0.37146453428106024, 'recall': 0.49514428960562157, 'f1-score': 0.4244788141329362, 'support': 50662}, 'accuracy': 0.3717992103778906, 'macro avg': {'precision': 0.38248788912946763, 'recall': 0.37319749836652133, 'f1-score': 0.3663201574849963, 'support': 150705}, 'weighted avg': {'precision': 0.38475846987290857, 'recall': 0.3717992103778906, 'f1-score': 0.3663169479574251, 'support': 150705}}
[[13828 17720 21323]
 [ 8931 17119 21122]
 [ 8019 17558 25085]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.101842
{'0': {'precision': 0.40297646515920627, 'recall': 0.1733498759305211, 'f1-score': 0.24241793323617186, 'support': 20150}, '1': {'precision': 0.27516644140761876, 'recall': 0.33198453919555504, 'f1-score': 0.3009169289722184, 'support': 16558}, '2': {'precision': 0.3978790389395195, 'recall': 0.5429630969609262, 'f1-score': 0.45923460898502494, 'support': 22112}, 'accuracy': 0.3569534172050323, 'macro avg': {'precision': 0.35867398183544813, 'recall': 0.3494325040290008, 'f1-score': 0.3341898237311384, 'support': 58820}, 'weighted avg': {'precision': 0.3650813161988441, 'recall': 0.3569534172050323, 'f1-score': 0.34039271571757446, 'support': 58820}}
[[ 3493  7103  9554]
 [ 2446  5497  8615]
 [ 2729  7377 12006]]
training model: results/QRTEA/W0/deepVOL_L3/h1000
Epoch 1/50
589/589 - 27s - loss: 3.2993 - accuracy1000: 0.3864 - val_loss: 3.3972 - val_accuracy1000: 0.3113 - 27s/epoch - 46ms/step
Epoch 2/50
589/589 - 26s - loss: 3.2951 - accuracy1000: 0.3634 - val_loss: 3.3985 - val_accuracy1000: 0.3118 - 26s/epoch - 43ms/step
Epoch 3/50
589/589 - 25s - loss: 3.2885 - accuracy1000: 0.3695 - val_loss: 3.3912 - val_accuracy1000: 0.3118 - 25s/epoch - 42ms/step
Epoch 4/50
589/589 - 25s - loss: 3.2853 - accuracy1000: 0.3702 - val_loss: 3.3694 - val_accuracy1000: 0.3118 - 25s/epoch - 43ms/step
Epoch 5/50
589/589 - 25s - loss: 3.2722 - accuracy1000: 0.3834 - val_loss: 3.3802 - val_accuracy1000: 0.3117 - 25s/epoch - 42ms/step
Epoch 6/50
589/589 - 25s - loss: 3.2707 - accuracy1000: 0.3845 - val_loss: 3.3452 - val_accuracy1000: 0.3185 - 25s/epoch - 42ms/step
Epoch 7/50
589/589 - 25s - loss: 3.2602 - accuracy1000: 0.3941 - val_loss: 3.3660 - val_accuracy1000: 0.3180 - 25s/epoch - 42ms/step
Epoch 8/50
589/589 - 25s - loss: 3.2557 - accuracy1000: 0.3952 - val_loss: 3.3583 - val_accuracy1000: 0.3280 - 25s/epoch - 42ms/step
Epoch 9/50
589/589 - 25s - loss: 3.2483 - accuracy1000: 0.4005 - val_loss: 3.3625 - val_accuracy1000: 0.3268 - 25s/epoch - 42ms/step
Epoch 10/50
589/589 - 25s - loss: 3.2366 - accuracy1000: 0.4068 - val_loss: 3.3795 - val_accuracy1000: 0.3243 - 25s/epoch - 43ms/step
Epoch 11/50
589/589 - 26s - loss: 3.2271 - accuracy1000: 0.4105 - val_loss: 3.3838 - val_accuracy1000: 0.3221 - 26s/epoch - 44ms/step
Epoch 12/50
589/589 - 26s - loss: 3.2108 - accuracy1000: 0.4212 - val_loss: 3.3944 - val_accuracy1000: 0.3245 - 26s/epoch - 44ms/step
Epoch 13/50
589/589 - 26s - loss: 3.2047 - accuracy1000: 0.4228 - val_loss: 3.4058 - val_accuracy1000: 0.3336 - 26s/epoch - 45ms/step
Epoch 14/50
589/589 - 26s - loss: 3.1959 - accuracy1000: 0.4299 - val_loss: 3.3995 - val_accuracy1000: 0.3343 - 26s/epoch - 44ms/step
Epoch 15/50
589/589 - 25s - loss: 3.2001 - accuracy1000: 0.4283 - val_loss: 3.4132 - val_accuracy1000: 0.3240 - 25s/epoch - 43ms/step
Epoch 16/50
589/589 - 25s - loss: 3.1841 - accuracy1000: 0.4349 - val_loss: 3.4210 - val_accuracy1000: 0.3384 - 25s/epoch - 43ms/step
testing model: results/QRTEA/W0/deepVOL_L3/h1000
Evaluating performance on  test set...
2359/2359 - 46s - 46s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0937475
{'0': {'precision': 0.3804347826086957, 'recall': 0.0005749014454664914, 'f1-score': 0.0011480679656235648, 'support': 182640}, '1': {'precision': 0.37620815162034454, 'recall': 0.9669422947027323, 'f1-score': 0.5416691397594176, 'support': 226513}, '2': {'precision': 0.3660710098025421, 'recall': 0.04010070131271354, 'f1-score': 0.07228324288280946, 'support': 194635}, 'accuracy': 0.3758521202806283, 'macro avg': {'precision': 0.37423798134386077, 'recall': 0.33587263248697075, 'f1-score': 0.2050334835359502, 'support': 603788}, 'weighted avg': {'precision': 0.3742188926188481, 'recall': 0.3758521202806283, 'f1-score': 0.22685716504147493, 'support': 603788}}
[[   105 176413   6122]
 [    94 219025   7394]
 [    77 186753   7805]]
Evaluating performance on  train set...
589/589 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009195
{'0': {'precision': 0.3884297520661157, 'recall': 0.0009106232925813264, 'f1-score': 0.0018169868944987822, 'support': 51613}, '1': {'precision': 0.33847561955466127, 'recall': 0.9577896401739818, 'f1-score': 0.5001884289158369, 'support': 50580}, '2': {'precision': 0.4461579723749497, 'recall': 0.06858096965699209, 'f1-score': 0.11888724115135164, 'support': 48512}, 'accuracy': 0.3438439335124913, 'macro avg': {'precision': 0.3910211146652422, 'recall': 0.34242707770785175, 'f1-score': 0.20696421898722914, 'support': 150705}, 'weighted avg': {'precision': 0.3902467548277546, 'recall': 0.3438439335124913, 'f1-score': 0.20676665486800816, 'support': 150705}}
[[   47 49547  2019]
 [   24 48445  2111]
 [   50 45135  3327]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1129369
{'0': {'precision': 0.2711864406779661, 'recall': 0.0008112356132434214, 'f1-score': 0.0016176321908805986, 'support': 19723}, '1': {'precision': 0.3139183739896204, 'recall': 0.9467713787085514, 'f1-score': 0.47150209813001603, 'support': 18336}, '2': {'precision': 0.4031791907514451, 'recall': 0.06719329512065893, 'f1-score': 0.11518929854258701, 'support': 20761}, 'accuracy': 0.31912614756885416, 'macro avg': {'precision': 0.32942800180634385, 'recall': 0.33825863648081794, 'f1-score': 0.19610300962116123, 'support': 58820}, 'weighted avg': {'precision': 0.3310952168336613, 'recall': 0.31912614756885416, 'f1-score': 0.18818109585269233, 'support': 58820}}
[[   16 18599  1108]
 [   19 17360   957]
 [   24 19342  1395]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        19 (peak)  14.09 (ave)

============================================
