This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/CHTR_orderbooks/CHTR_orderbooks_2019-04-17.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-04-09.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-03-27.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-03-28.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-04-05.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-04-01.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-04-03.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-03-29.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-04-02.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-04-15.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-04-04.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-03-26.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-04-11.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-04-10.csv
training model: results/CHTR/W2/deepLOB_L1/h10
Epoch 1/50
320/320 - 23s - loss: 3.3248 - accuracy10: 0.3596 - val_loss: 3.3607 - val_accuracy10: 0.3487 - 23s/epoch - 71ms/step
Epoch 2/50
320/320 - 9s - loss: 3.2844 - accuracy10: 0.3736 - val_loss: 3.3024 - val_accuracy10: 0.3687 - 9s/epoch - 27ms/step
Epoch 3/50
320/320 - 9s - loss: 3.2643 - accuracy10: 0.3850 - val_loss: 3.2980 - val_accuracy10: 0.3770 - 9s/epoch - 27ms/step
Epoch 4/50
320/320 - 9s - loss: 3.2512 - accuracy10: 0.3925 - val_loss: 3.2737 - val_accuracy10: 0.3886 - 9s/epoch - 27ms/step
Epoch 5/50
320/320 - 9s - loss: 3.2410 - accuracy10: 0.3997 - val_loss: 3.2609 - val_accuracy10: 0.3953 - 9s/epoch - 27ms/step
Epoch 6/50
320/320 - 9s - loss: 3.2318 - accuracy10: 0.4047 - val_loss: 3.2550 - val_accuracy10: 0.3990 - 9s/epoch - 28ms/step
Epoch 7/50
320/320 - 9s - loss: 3.2224 - accuracy10: 0.4112 - val_loss: 3.2461 - val_accuracy10: 0.4010 - 9s/epoch - 27ms/step
Epoch 8/50
320/320 - 9s - loss: 3.2188 - accuracy10: 0.4124 - val_loss: 3.2544 - val_accuracy10: 0.3990 - 9s/epoch - 27ms/step
Epoch 9/50
320/320 - 9s - loss: 3.2107 - accuracy10: 0.4194 - val_loss: 3.2415 - val_accuracy10: 0.4054 - 9s/epoch - 27ms/step
Epoch 10/50
320/320 - 9s - loss: 3.2058 - accuracy10: 0.4216 - val_loss: 3.2439 - val_accuracy10: 0.4050 - 9s/epoch - 29ms/step
Epoch 11/50
320/320 - 9s - loss: 3.2009 - accuracy10: 0.4231 - val_loss: 3.2405 - val_accuracy10: 0.4058 - 9s/epoch - 28ms/step
Epoch 12/50
320/320 - 9s - loss: 3.1964 - accuracy10: 0.4238 - val_loss: 3.2445 - val_accuracy10: 0.4037 - 9s/epoch - 27ms/step
Epoch 13/50
320/320 - 9s - loss: 3.1930 - accuracy10: 0.4267 - val_loss: 3.2408 - val_accuracy10: 0.4066 - 9s/epoch - 27ms/step
Epoch 14/50
320/320 - 9s - loss: 3.1906 - accuracy10: 0.4283 - val_loss: 3.2359 - val_accuracy10: 0.4096 - 9s/epoch - 28ms/step
Epoch 15/50
320/320 - 9s - loss: 3.1848 - accuracy10: 0.4296 - val_loss: 3.2446 - val_accuracy10: 0.4058 - 9s/epoch - 27ms/step
Epoch 16/50
320/320 - 9s - loss: 3.1812 - accuracy10: 0.4312 - val_loss: 3.2453 - val_accuracy10: 0.4064 - 9s/epoch - 28ms/step
Epoch 17/50
320/320 - 9s - loss: 3.1791 - accuracy10: 0.4322 - val_loss: 3.2490 - val_accuracy10: 0.4075 - 9s/epoch - 28ms/step
Epoch 18/50
320/320 - 9s - loss: 3.1763 - accuracy10: 0.4355 - val_loss: 3.2468 - val_accuracy10: 0.4085 - 9s/epoch - 27ms/step
Epoch 19/50
320/320 - 9s - loss: 3.1736 - accuracy10: 0.4357 - val_loss: 3.2477 - val_accuracy10: 0.4074 - 9s/epoch - 27ms/step
Epoch 20/50
320/320 - 8s - loss: 3.1702 - accuracy10: 0.4379 - val_loss: 3.2620 - val_accuracy10: 0.4026 - 8s/epoch - 26ms/step
Epoch 21/50
320/320 - 9s - loss: 3.1673 - accuracy10: 0.4376 - val_loss: 3.2470 - val_accuracy10: 0.4092 - 9s/epoch - 29ms/step
Epoch 22/50
320/320 - 9s - loss: 3.1631 - accuracy10: 0.4394 - val_loss: 3.2582 - val_accuracy10: 0.4005 - 9s/epoch - 29ms/step
Epoch 23/50
320/320 - 9s - loss: 3.1611 - accuracy10: 0.4406 - val_loss: 3.2654 - val_accuracy10: 0.3994 - 9s/epoch - 28ms/step
Epoch 24/50
320/320 - 9s - loss: 3.1585 - accuracy10: 0.4414 - val_loss: 3.2553 - val_accuracy10: 0.3965 - 9s/epoch - 29ms/step
testing model: results/CHTR/W2/deepLOB_L1/h10
Evaluating performance on  test set...
860/860 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0834883
{'0': {'precision': 0.40322444926877704, 'recall': 0.6137688120397055, 'f1-score': 0.4867025193355577, 'support': 78075}, '1': {'precision': 0.3750212008141113, 'recall': 0.2705815767736409, 'f1-score': 0.31435375237689045, 'support': 65374}, '2': {'precision': 0.43208365780398267, 'recall': 0.3046473625727172, 'f1-score': 0.35734384224367277, 'support': 76495}, 'accuracy': 0.4042529007383698, 'macro avg': {'precision': 0.40344310262895694, 'recall': 0.3963325837953546, 'f1-score': 0.38613337131870695, 'support': 219944}, 'weighted avg': {'precision': 0.4048786248426742, 'recall': 0.4042529007383698, 'f1-score': 0.390485208132253, 'support': 219944}}
[[47920 14167 15988]
 [33043 17689 14642]
 [37879 15312 23304]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0807709
{'0': {'precision': 0.410006678539626, 'recall': 0.5283844360767438, 'f1-score': 0.4617288980116263, 'support': 27885}, '1': {'precision': 0.3976558603491272, 'recall': 0.29363237947924725, 'f1-score': 0.3378175115988391, 'support': 27153}, '2': {'precision': 0.39870018679950187, 'recall': 0.3845143371866086, 'f1-score': 0.3914787925105082, 'support': 26644}, 'accuracy': 0.40341813373815527, 'macro avg': {'precision': 0.40212090856275173, 'recall': 0.4021770509141999, 'f1-score': 0.39700840070699117, 'support': 81682}, 'weighted avg': {'precision': 0.4022128937124856, 'recall': 0.40341813373815527, 'f1-score': 0.3976228564573279, 'support': 81682}}
[[14734  5898  7253]
 [10982  7973  8198]
 [10220  6179 10245]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0780385
{'0': {'precision': 0.41217234106658635, 'recall': 0.6131779471089198, 'f1-score': 0.492972972972973, 'support': 8924}, '1': {'precision': 0.41120090208607407, 'recall': 0.2667316835304157, 'f1-score': 0.32357290742383915, 'support': 8203}, '2': {'precision': 0.4024198617221873, 'recall': 0.32690834822568293, 'f1-score': 0.36075503592055225, 'support': 7834}, 'accuracy': 0.40947878690757583, 'macro avg': {'precision': 0.4085977016249492, 'recall': 0.4022726596216728, 'f1-score': 0.3924336387724548, 'support': 24961}, 'weighted avg': {'precision': 0.40879228268987217, 'recall': 0.40947878690757583, 'f1-score': 0.39580603027964306, 'support': 24961}}
[[5472 1650 1802]
 [4014 2188 2001]
 [3790 1483 2561]]
training model: results/CHTR/W2/deepLOB_L1/h20
Epoch 1/50
320/320 - 10s - loss: 3.3269 - accuracy20: 0.3573 - val_loss: 3.3390 - val_accuracy20: 0.3534 - 10s/epoch - 33ms/step
Epoch 2/50
320/320 - 9s - loss: 3.2913 - accuracy20: 0.3699 - val_loss: 3.3086 - val_accuracy20: 0.3621 - 9s/epoch - 27ms/step
Epoch 3/50
320/320 - 9s - loss: 3.2780 - accuracy20: 0.3755 - val_loss: 3.3080 - val_accuracy20: 0.3643 - 9s/epoch - 28ms/step
Epoch 4/50
320/320 - 9s - loss: 3.2641 - accuracy20: 0.3843 - val_loss: 3.2965 - val_accuracy20: 0.3779 - 9s/epoch - 28ms/step
Epoch 5/50
320/320 - 9s - loss: 3.2559 - accuracy20: 0.3891 - val_loss: 3.2838 - val_accuracy20: 0.3757 - 9s/epoch - 30ms/step
Epoch 6/50
320/320 - 9s - loss: 3.2478 - accuracy20: 0.3960 - val_loss: 3.2857 - val_accuracy20: 0.3785 - 9s/epoch - 29ms/step
Epoch 7/50
320/320 - 9s - loss: 3.2419 - accuracy20: 0.3989 - val_loss: 3.2898 - val_accuracy20: 0.3828 - 9s/epoch - 28ms/step
Epoch 8/50
320/320 - 9s - loss: 3.2380 - accuracy20: 0.4006 - val_loss: 3.2875 - val_accuracy20: 0.3754 - 9s/epoch - 28ms/step
Epoch 9/50
320/320 - 9s - loss: 3.2305 - accuracy20: 0.4069 - val_loss: 3.2918 - val_accuracy20: 0.3675 - 9s/epoch - 29ms/step
Epoch 10/50
320/320 - 9s - loss: 3.2302 - accuracy20: 0.4072 - val_loss: 3.3040 - val_accuracy20: 0.3792 - 9s/epoch - 29ms/step
Epoch 11/50
320/320 - 9s - loss: 3.2232 - accuracy20: 0.4111 - val_loss: 3.2911 - val_accuracy20: 0.3744 - 9s/epoch - 28ms/step
Epoch 12/50
320/320 - 9s - loss: 3.2213 - accuracy20: 0.4110 - val_loss: 3.2923 - val_accuracy20: 0.3724 - 9s/epoch - 29ms/step
Epoch 13/50
320/320 - 9s - loss: 3.2150 - accuracy20: 0.4162 - val_loss: 3.2903 - val_accuracy20: 0.3716 - 9s/epoch - 28ms/step
Epoch 14/50
320/320 - 9s - loss: 3.2125 - accuracy20: 0.4155 - val_loss: 3.2894 - val_accuracy20: 0.3741 - 9s/epoch - 28ms/step
Epoch 15/50
320/320 - 9s - loss: 3.2105 - accuracy20: 0.4196 - val_loss: 3.2834 - val_accuracy20: 0.3781 - 9s/epoch - 29ms/step
Epoch 16/50
320/320 - 9s - loss: 3.2067 - accuracy20: 0.4208 - val_loss: 3.2880 - val_accuracy20: 0.3753 - 9s/epoch - 27ms/step
Epoch 17/50
320/320 - 9s - loss: 3.2017 - accuracy20: 0.4227 - val_loss: 3.2987 - val_accuracy20: 0.3783 - 9s/epoch - 28ms/step
Epoch 18/50
320/320 - 9s - loss: 3.1982 - accuracy20: 0.4262 - val_loss: 3.3027 - val_accuracy20: 0.3792 - 9s/epoch - 28ms/step
Epoch 19/50
320/320 - 9s - loss: 3.1940 - accuracy20: 0.4263 - val_loss: 3.2930 - val_accuracy20: 0.3768 - 9s/epoch - 28ms/step
Epoch 20/50
320/320 - 9s - loss: 3.1934 - accuracy20: 0.4272 - val_loss: 3.3036 - val_accuracy20: 0.3798 - 9s/epoch - 27ms/step
Epoch 21/50
320/320 - 9s - loss: 3.1890 - accuracy20: 0.4288 - val_loss: 3.3089 - val_accuracy20: 0.3795 - 9s/epoch - 27ms/step
Epoch 22/50
320/320 - 9s - loss: 3.1885 - accuracy20: 0.4304 - val_loss: 3.3105 - val_accuracy20: 0.3739 - 9s/epoch - 28ms/step
Epoch 23/50
320/320 - 8s - loss: 3.1864 - accuracy20: 0.4291 - val_loss: 3.3054 - val_accuracy20: 0.3779 - 8s/epoch - 26ms/step
Epoch 24/50
320/320 - 9s - loss: 3.1793 - accuracy20: 0.4336 - val_loss: 3.3115 - val_accuracy20: 0.3783 - 9s/epoch - 29ms/step
Epoch 25/50
320/320 - 9s - loss: 3.1791 - accuracy20: 0.4341 - val_loss: 3.3230 - val_accuracy20: 0.3801 - 9s/epoch - 28ms/step
testing model: results/CHTR/W2/deepLOB_L1/h20
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1032436
{'0': {'precision': 0.36931802359580806, 'recall': 0.5280362048600512, 'f1-score': 0.4346405942757264, 'support': 75349}, '1': {'precision': 0.33809596577017115, 'recall': 0.2635693544784454, 'f1-score': 0.2962169580024601, 'support': 67155}, '2': {'precision': 0.405389151534388, 'recall': 0.31336518595041324, 'f1-score': 0.3534861362990801, 'support': 77440}, 'accuracy': 0.3717037063979922, 'macro avg': {'precision': 0.3709343803001224, 'recall': 0.3683235817629699, 'f1-score': 0.3614478961924222, 'support': 219944}, 'weighted avg': {'precision': 0.3724853337033035, 'recall': 0.3717037063979922, 'f1-score': 0.3638023785497112, 'support': 219944}}
[[39787 15957 19605]
 [33466 17700 15989]
 [34478 18695 24267]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0965466
{'0': {'precision': 0.40805410155503763, 'recall': 0.37916711044839707, 'f1-score': 0.3930806036069194, 'support': 28167}, '1': {'precision': 0.35244558857945235, 'recall': 0.44405130473241927, 'f1-score': 0.39298062495922753, 'support': 27132}, '2': {'precision': 0.3747245017584994, 'recall': 0.3028844331577152, 'f1-score': 0.3349962270478746, 'support': 26383}, 'accuracy': 0.37608040939252224, 'macro avg': {'precision': 0.37840806396432985, 'recall': 0.37536761611284386, 'f1-score': 0.3736858185380072, 'support': 81682}, 'weighted avg': {'precision': 0.3788174887702668, 'recall': 0.37608040939252224, 'f1-score': 0.37428634382598286, 'support': 81682}}
[[10680 11284  6203]
 [ 7953 12048  7131]
 [ 7540 10852  7991]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0930111
{'0': {'precision': 0.41503887729945005, 'recall': 0.4931275349256422, 'f1-score': 0.45072598084646276, 'support': 8876}, '1': {'precision': 0.3328344462353212, 'recall': 0.3594876896294454, 'f1-score': 0.3456480153036824, 'support': 8042}, '2': {'precision': 0.3761563972770117, 'recall': 0.267934850180281, 'f1-score': 0.31295381934359573, 'support': 8043}, 'accuracy': 0.37750891390569286, 'macro avg': {'precision': 0.37467657360392764, 'recall': 0.3735166915784562, 'f1-score': 0.3697759384979136, 'support': 24961}, 'weighted avg': {'precision': 0.3760252231414357, 'recall': 0.37750891390569286, 'f1-score': 0.37247837482656776, 'support': 24961}}
[[4377 2904 1595]
 [3172 2891 1979]
 [2997 2891 2155]]
training model: results/CHTR/W2/deepLOB_L1/h30
Epoch 1/50
320/320 - 11s - loss: 3.3358 - accuracy30: 0.3537 - val_loss: 3.3692 - val_accuracy30: 0.3457 - 11s/epoch - 35ms/step
Epoch 2/50
320/320 - 9s - loss: 3.2989 - accuracy30: 0.3625 - val_loss: 3.3062 - val_accuracy30: 0.3582 - 9s/epoch - 28ms/step
Epoch 3/50
320/320 - 8s - loss: 3.2821 - accuracy30: 0.3696 - val_loss: 3.2848 - val_accuracy30: 0.3747 - 8s/epoch - 26ms/step
Epoch 4/50
320/320 - 9s - loss: 3.2704 - accuracy30: 0.3780 - val_loss: 3.2857 - val_accuracy30: 0.3709 - 9s/epoch - 27ms/step
Epoch 5/50
320/320 - 8s - loss: 3.2649 - accuracy30: 0.3807 - val_loss: 3.2968 - val_accuracy30: 0.3753 - 8s/epoch - 27ms/step
Epoch 6/50
320/320 - 9s - loss: 3.2603 - accuracy30: 0.3861 - val_loss: 3.2860 - val_accuracy30: 0.3757 - 9s/epoch - 27ms/step
Epoch 7/50
320/320 - 8s - loss: 3.2578 - accuracy30: 0.3884 - val_loss: 3.2857 - val_accuracy30: 0.3740 - 8s/epoch - 26ms/step
Epoch 8/50
320/320 - 9s - loss: 3.2522 - accuracy30: 0.3926 - val_loss: 3.2866 - val_accuracy30: 0.3714 - 9s/epoch - 27ms/step
Epoch 9/50
320/320 - 9s - loss: 3.2455 - accuracy30: 0.3975 - val_loss: 3.2898 - val_accuracy30: 0.3793 - 9s/epoch - 27ms/step
Epoch 10/50
320/320 - 9s - loss: 3.2425 - accuracy30: 0.3980 - val_loss: 3.2844 - val_accuracy30: 0.3799 - 9s/epoch - 29ms/step
Epoch 11/50
320/320 - 9s - loss: 3.2387 - accuracy30: 0.4006 - val_loss: 3.2822 - val_accuracy30: 0.3829 - 9s/epoch - 27ms/step
Epoch 12/50
320/320 - 9s - loss: 3.2385 - accuracy30: 0.4032 - val_loss: 3.2846 - val_accuracy30: 0.3708 - 9s/epoch - 28ms/step
Epoch 13/50
320/320 - 9s - loss: 3.2366 - accuracy30: 0.4026 - val_loss: 3.2850 - val_accuracy30: 0.3837 - 9s/epoch - 28ms/step
Epoch 14/50
320/320 - 9s - loss: 3.2327 - accuracy30: 0.4064 - val_loss: 3.2910 - val_accuracy30: 0.3808 - 9s/epoch - 28ms/step
Epoch 15/50
320/320 - 9s - loss: 3.2285 - accuracy30: 0.4085 - val_loss: 3.3087 - val_accuracy30: 0.3745 - 9s/epoch - 28ms/step
Epoch 16/50
320/320 - 9s - loss: 3.2258 - accuracy30: 0.4111 - val_loss: 3.3038 - val_accuracy30: 0.3741 - 9s/epoch - 28ms/step
Epoch 17/50
320/320 - 9s - loss: 3.2245 - accuracy30: 0.4100 - val_loss: 3.2954 - val_accuracy30: 0.3814 - 9s/epoch - 27ms/step
Epoch 18/50
320/320 - 9s - loss: 3.2215 - accuracy30: 0.4132 - val_loss: 3.3163 - val_accuracy30: 0.3765 - 9s/epoch - 27ms/step
Epoch 19/50
320/320 - 9s - loss: 3.2179 - accuracy30: 0.4144 - val_loss: 3.3107 - val_accuracy30: 0.3784 - 9s/epoch - 27ms/step
Epoch 20/50
320/320 - 8s - loss: 3.2145 - accuracy30: 0.4149 - val_loss: 3.3014 - val_accuracy30: 0.3795 - 8s/epoch - 26ms/step
Epoch 21/50
320/320 - 9s - loss: 3.2103 - accuracy30: 0.4207 - val_loss: 3.3112 - val_accuracy30: 0.3757 - 9s/epoch - 27ms/step
testing model: results/CHTR/W2/deepLOB_L1/h30
Evaluating performance on  test set...
860/860 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0960923
{'0': {'precision': 0.36734738763705144, 'recall': 0.447384986272015, 'f1-score': 0.4034348240920785, 'support': 74665}, '1': {'precision': 0.3439944328462074, 'recall': 0.183674682678874, 'f1-score': 0.23947988024068134, 'support': 67282}, '2': {'precision': 0.4111251960552607, 'recall': 0.4906598971755324, 'f1-score': 0.4473851873067458, 'support': 77997}, 'accuracy': 0.3820608882260939, 'macro avg': {'precision': 0.3741556721795065, 'recall': 0.3739065220421405, 'f1-score': 0.3634332972131686, 'support': 219944}, 'weighted avg': {'precision': 0.37572817646947015, 'recall': 0.3820608882260939, 'f1-score': 0.3688659335901539, 'support': 219944}}
[[33404 11795 29466]
 [29574 12358 25350]
 [27955 11772 38270]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0897148
{'0': {'precision': 0.40879007903360537, 'recall': 0.45248933143669984, 'f1-score': 0.42953110758532226, 'support': 28120}, '1': {'precision': 0.36600441501103753, 'recall': 0.1827668565129524, 'f1-score': 0.24379365273863496, 'support': 27215}, '2': {'precision': 0.36820321376399934, 'recall': 0.5166053061069571, 'f1-score': 0.42995909212957845, 'support': 26347}, 'accuracy': 0.38330354300825153, 'macro avg': {'precision': 0.38099923593621404, 'recall': 0.38395383135220307, 'f1-score': 0.36776128415117854, 'support': 81682}, 'weighted avg': {'precision': 0.381443123943959, 'recall': 0.38330354300825153, 'f1-score': 0.3677847163991971, 'support': 81682}}
[[12724  4460 10936]
 [ 9822  4974 12419]
 [ 8580  4156 13611]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0932603
{'0': {'precision': 0.39511709018435476, 'recall': 0.5465196416264645, 'f1-score': 0.4586466165413534, 'support': 8706}, '1': {'precision': 0.36695156695156694, 'recall': 0.15587558997942635, 'f1-score': 0.21880574195192393, 'support': 8263}, '2': {'precision': 0.3603996173876076, 'recall': 0.4242992992992993, 'f1-score': 0.389747715648526, 'support': 7992}, 'accuracy': 0.3780697888706382, 'macro avg': {'precision': 0.37415609150784307, 'recall': 0.3755648436350634, 'f1-score': 0.35573335804726774, 'support': 24961}, 'weighted avg': {'precision': 0.37467745390920043, 'recall': 0.3780697888706382, 'f1-score': 0.3571905385529743, 'support': 24961}}
[[4758 1181 2767]
 [3724 1288 3251]
 [3560 1041 3391]]
training model: results/CHTR/W2/deepLOB_L1/h50
Epoch 1/50
320/320 - 11s - loss: 3.3458 - accuracy50: 0.3511 - val_loss: 3.4142 - val_accuracy50: 0.3406 - 11s/epoch - 35ms/step
Epoch 2/50
320/320 - 9s - loss: 3.3119 - accuracy50: 0.3573 - val_loss: 3.4021 - val_accuracy50: 0.3359 - 9s/epoch - 27ms/step
Epoch 3/50
320/320 - 9s - loss: 3.3011 - accuracy50: 0.3621 - val_loss: 3.3502 - val_accuracy50: 0.3487 - 9s/epoch - 27ms/step
Epoch 4/50
320/320 - 9s - loss: 3.2906 - accuracy50: 0.3674 - val_loss: 3.3385 - val_accuracy50: 0.3474 - 9s/epoch - 28ms/step
Epoch 5/50
320/320 - 9s - loss: 3.2802 - accuracy50: 0.3739 - val_loss: 3.3514 - val_accuracy50: 0.3450 - 9s/epoch - 27ms/step
Epoch 6/50
320/320 - 9s - loss: 3.2772 - accuracy50: 0.3782 - val_loss: 3.3678 - val_accuracy50: 0.3460 - 9s/epoch - 27ms/step
Epoch 7/50
320/320 - 9s - loss: 3.2723 - accuracy50: 0.3809 - val_loss: 3.3385 - val_accuracy50: 0.3538 - 9s/epoch - 28ms/step
Epoch 8/50
320/320 - 9s - loss: 3.2655 - accuracy50: 0.3854 - val_loss: 3.3519 - val_accuracy50: 0.3525 - 9s/epoch - 27ms/step
Epoch 9/50
320/320 - 9s - loss: 3.2645 - accuracy50: 0.3871 - val_loss: 3.3713 - val_accuracy50: 0.3503 - 9s/epoch - 27ms/step
Epoch 10/50
320/320 - 9s - loss: 3.2595 - accuracy50: 0.3890 - val_loss: 3.3582 - val_accuracy50: 0.3501 - 9s/epoch - 27ms/step
Epoch 11/50
320/320 - 9s - loss: 3.2569 - accuracy50: 0.3935 - val_loss: 3.3571 - val_accuracy50: 0.3503 - 9s/epoch - 29ms/step
Epoch 12/50
320/320 - 9s - loss: 3.2529 - accuracy50: 0.3949 - val_loss: 3.3602 - val_accuracy50: 0.3529 - 9s/epoch - 29ms/step
Epoch 13/50
320/320 - 9s - loss: 3.2510 - accuracy50: 0.3949 - val_loss: 3.3547 - val_accuracy50: 0.3576 - 9s/epoch - 28ms/step
Epoch 14/50
320/320 - 9s - loss: 3.2481 - accuracy50: 0.3974 - val_loss: 3.3740 - val_accuracy50: 0.3582 - 9s/epoch - 29ms/step
Epoch 15/50
320/320 - 9s - loss: 3.2452 - accuracy50: 0.3999 - val_loss: 3.4018 - val_accuracy50: 0.3528 - 9s/epoch - 28ms/step
Epoch 16/50
320/320 - 9s - loss: 3.2430 - accuracy50: 0.4018 - val_loss: 3.3713 - val_accuracy50: 0.3507 - 9s/epoch - 28ms/step
Epoch 17/50
320/320 - 9s - loss: 3.2413 - accuracy50: 0.4031 - val_loss: 3.4144 - val_accuracy50: 0.3514 - 9s/epoch - 28ms/step
testing model: results/CHTR/W2/deepLOB_L1/h50
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1045556
{'0': {'precision': 0.35580148976107767, 'recall': 0.5683295119998915, 'f1-score': 0.437627320497686, 'support': 73709}, '1': {'precision': 0.35669053534025036, 'recall': 0.21578334733088744, 'f1-score': 0.26889568242951706, 'support': 67869}, '2': {'precision': 0.40337536182112543, 'recall': 0.314753847331751, 'f1-score': 0.35359638748521666, 'support': 78366}, 'accuracy': 0.3691939766486015, 'macro avg': {'precision': 0.37195579564081777, 'recall': 0.3662889022208433, 'f1-score': 0.35337313013747323, 'support': 219944}, 'weighted avg': {'precision': 0.3730263865178457, 'recall': 0.3691939766486015, 'f1-score': 0.3556209205026703, 'support': 219944}}
[[41891 12630 19188]
 [35929 14645 17295]
 [39917 13783 24666]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1017501
{'0': {'precision': 0.3725342730671709, 'recall': 0.6118149415957935, 'f1-score': 0.4630918196994992, 'support': 28337}, '1': {'precision': 0.334649213934483, 'recall': 0.18161999624130803, 'f1-score': 0.23545463405126205, 'support': 26605}, '2': {'precision': 0.3684134267085245, 'recall': 0.28526551982049364, 'f1-score': 0.3215512698914533, 'support': 26740}, 'accuracy': 0.3647927327930266, 'macro avg': {'precision': 0.35853230457005947, 'recall': 0.35956681921919836, 'f1-score': 0.3400325745474049, 'support': 81682}, 'weighted avg': {'precision': 0.35884553589306445, 'recall': 0.3647927327930266, 'f1-score': 0.3426114001941186, 'support': 81682}}
[[17337  4761  6239]
 [14935  4832  6838]
 [14266  4846  7628]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1095141
{'0': {'precision': 0.37001124227093873, 'recall': 0.6111175583149588, 'f1-score': 0.46093920959341766, 'support': 8617}, '1': {'precision': 0.32084513177956875, 'recall': 0.17837248728505692, 'f1-score': 0.22927854307728227, 'support': 8258}, '2': {'precision': 0.3434343434343434, 'recall': 0.26069750185505813, 'f1-score': 0.296400449943757, 'support': 8086}, 'accuracy': 0.3544329153479428, 'macro avg': {'precision': 0.3447635724949503, 'recall': 0.35006251581835796, 'f1-score': 0.328872734204819, 'support': 24961}, 'weighted avg': {'precision': 0.34513585488940585, 'recall': 0.3544329153479428, 'f1-score': 0.33099593029301294, 'support': 24961}}
[[5266 1524 1827]
 [4582 1473 2203]
 [4384 1594 2108]]
training model: results/CHTR/W2/deepLOB_L1/h100
Epoch 1/50
320/320 - 10s - loss: 3.3408 - accuracy100: 0.3532 - val_loss: 3.3736 - val_accuracy100: 0.3366 - 10s/epoch - 32ms/step
Epoch 2/50
320/320 - 9s - loss: 3.3107 - accuracy100: 0.3563 - val_loss: 3.3672 - val_accuracy100: 0.3411 - 9s/epoch - 27ms/step
Epoch 3/50
320/320 - 9s - loss: 3.3020 - accuracy100: 0.3579 - val_loss: 3.3443 - val_accuracy100: 0.3445 - 9s/epoch - 28ms/step
Epoch 4/50
320/320 - 9s - loss: 3.2912 - accuracy100: 0.3612 - val_loss: 3.3355 - val_accuracy100: 0.3458 - 9s/epoch - 28ms/step
Epoch 5/50
320/320 - 9s - loss: 3.2855 - accuracy100: 0.3674 - val_loss: 3.3289 - val_accuracy100: 0.3426 - 9s/epoch - 28ms/step
Epoch 6/50
320/320 - 9s - loss: 3.2761 - accuracy100: 0.3757 - val_loss: 3.3480 - val_accuracy100: 0.3436 - 9s/epoch - 27ms/step
Epoch 7/50
320/320 - 9s - loss: 3.2733 - accuracy100: 0.3795 - val_loss: 3.3621 - val_accuracy100: 0.3407 - 9s/epoch - 27ms/step
Epoch 8/50
320/320 - 9s - loss: 3.2691 - accuracy100: 0.3818 - val_loss: 3.3663 - val_accuracy100: 0.3421 - 9s/epoch - 27ms/step
Epoch 9/50
320/320 - 9s - loss: 3.2641 - accuracy100: 0.3847 - val_loss: 3.3990 - val_accuracy100: 0.3363 - 9s/epoch - 28ms/step
Epoch 10/50
320/320 - 9s - loss: 3.2614 - accuracy100: 0.3889 - val_loss: 3.4452 - val_accuracy100: 0.3413 - 9s/epoch - 28ms/step
Epoch 11/50
320/320 - 9s - loss: 3.2555 - accuracy100: 0.3942 - val_loss: 3.5041 - val_accuracy100: 0.3419 - 9s/epoch - 28ms/step
Epoch 12/50
320/320 - 9s - loss: 3.2537 - accuracy100: 0.3930 - val_loss: 3.5031 - val_accuracy100: 0.3373 - 9s/epoch - 28ms/step
Epoch 13/50
320/320 - 9s - loss: 3.2502 - accuracy100: 0.3962 - val_loss: 3.4672 - val_accuracy100: 0.3407 - 9s/epoch - 27ms/step
Epoch 14/50
320/320 - 9s - loss: 3.2473 - accuracy100: 0.3983 - val_loss: 3.4800 - val_accuracy100: 0.3395 - 9s/epoch - 27ms/step
Epoch 15/50
320/320 - 9s - loss: 3.2443 - accuracy100: 0.4002 - val_loss: 3.4804 - val_accuracy100: 0.3407 - 9s/epoch - 27ms/step
testing model: results/CHTR/W2/deepLOB_L1/h100
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.11215
{'0': {'precision': 0.3332944223543574, 'recall': 0.6226217085536717, 'f1-score': 0.43417269776702766, 'support': 73372}, '1': {'precision': 0.28149793716280547, 'recall': 0.0407335404962726, 'f1-score': 0.07116876170098957, 'support': 65327}, '2': {'precision': 0.39826491978318307, 'recall': 0.35993599606129606, 'f1-score': 0.3781316471736783, 'support': 81245}, 'accuracy': 0.35275797475721093, 'macro avg': {'precision': 0.337685759766782, 'recall': 0.3410970817037468, 'f1-score': 0.2944910355472318, 'support': 219944}, 'weighted avg': {'precision': 0.34190942924473144, 'recall': 0.35275797475721093, 'f1-score': 0.30565355977352593, 'support': 219944}}
[[45683  3317 24372]
 [42855  2661 19811]
 [48527  3475 29243]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1112615
{'0': {'precision': 0.34045684500996476, 'recall': 0.3996400935756703, 'f1-score': 0.36768211920529803, 'support': 27785}, '1': {'precision': 0.3269410041283793, 'recall': 0.09131485958713037, 'f1-score': 0.14275745769610979, 'support': 26885}, '2': {'precision': 0.3307425766398768, 'recall': 0.5088479194432104, 'f1-score': 0.4009041855038647, 'support': 27012}, 'accuracy': 0.33427193261673316, 'macro avg': {'precision': 0.332713475259407, 'recall': 0.3332676242020037, 'f1-score': 0.30378125413509083, 'support': 81682}, 'weighted avg': {'precision': 0.3327957299624115, 'recall': 0.33427193261673316, 'f1-score': 0.30463634327158384, 'support': 81682}}
[[11104  2562 14119]
 [10736  2455 13694]
 [10775  2492 13745]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1091009
{'0': {'precision': 0.34703773982711367, 'recall': 0.5849324804548686, 'f1-score': 0.43562260156146626, 'support': 8442}, '1': {'precision': 0.34231536926147704, 'recall': 0.04196231954979202, 'f1-score': 0.07476024411508282, 'support': 8174}, '2': {'precision': 0.3373072970195272, 'recall': 0.3932893948472139, 'f1-score': 0.3631535269709544, 'support': 8345}, 'accuracy': 0.3430551660590521, 'macro avg': {'precision': 0.3422201353693726, 'recall': 0.3400613982839582, 'f1-score': 0.29117879088250115, 'support': 24961}, 'weighted avg': {'precision': 0.3422382044626322, 'recall': 0.3430551660590521, 'f1-score': 0.29322272426389967, 'support': 24961}}
[[4938  331 3173]
 [4556  343 3275]
 [4735  328 3282]]
training model: results/CHTR/W2/deepLOB_L1/h200
Epoch 1/50
320/320 - 11s - loss: 3.3462 - accuracy200: 0.3504 - val_loss: 3.3939 - val_accuracy200: 0.3197 - 11s/epoch - 35ms/step
Epoch 2/50
320/320 - 9s - loss: 3.3156 - accuracy200: 0.3590 - val_loss: 3.3741 - val_accuracy200: 0.3352 - 9s/epoch - 29ms/step
Epoch 3/50
320/320 - 9s - loss: 3.3056 - accuracy200: 0.3591 - val_loss: 3.4122 - val_accuracy200: 0.3263 - 9s/epoch - 28ms/step
Epoch 4/50
320/320 - 8s - loss: 3.2936 - accuracy200: 0.3692 - val_loss: 3.3983 - val_accuracy200: 0.3376 - 8s/epoch - 26ms/step
Epoch 5/50
320/320 - 8s - loss: 3.2795 - accuracy200: 0.3738 - val_loss: 3.4260 - val_accuracy200: 0.3373 - 8s/epoch - 26ms/step
Epoch 6/50
320/320 - 9s - loss: 3.2706 - accuracy200: 0.3826 - val_loss: 3.4398 - val_accuracy200: 0.3359 - 9s/epoch - 27ms/step
Epoch 7/50
320/320 - 9s - loss: 3.2609 - accuracy200: 0.3891 - val_loss: 3.4926 - val_accuracy200: 0.3320 - 9s/epoch - 27ms/step
Epoch 8/50
320/320 - 9s - loss: 3.2574 - accuracy200: 0.3908 - val_loss: 3.4934 - val_accuracy200: 0.3264 - 9s/epoch - 28ms/step
Epoch 9/50
320/320 - 9s - loss: 3.2498 - accuracy200: 0.3981 - val_loss: 3.5101 - val_accuracy200: 0.3366 - 9s/epoch - 27ms/step
Epoch 10/50
320/320 - 9s - loss: 3.2450 - accuracy200: 0.4009 - val_loss: 3.5146 - val_accuracy200: 0.3383 - 9s/epoch - 27ms/step
Epoch 11/50
320/320 - 9s - loss: 3.2370 - accuracy200: 0.4038 - val_loss: 3.5572 - val_accuracy200: 0.3395 - 9s/epoch - 28ms/step
Epoch 12/50
320/320 - 9s - loss: 3.2327 - accuracy200: 0.4069 - val_loss: 3.5263 - val_accuracy200: 0.3428 - 9s/epoch - 28ms/step
testing model: results/CHTR/W2/deepLOB_L1/h200
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1189271
{'0': {'precision': 0.3365131147779736, 'recall': 0.3197309975507493, 'f1-score': 0.3279074717945079, 'support': 72267}, '1': {'precision': 0.30600444551243544, 'recall': 0.3210936884406272, 'f1-score': 0.31336752820307756, 'support': 63455}, '2': {'precision': 0.37444065315182357, 'recall': 0.37655244472940563, 'f1-score': 0.37549357976308173, 'support': 84222}, 'accuracy': 0.34188247917651765, 'macro avg': {'precision': 0.33898607114741086, 'recall': 0.33912571024026067, 'f1-score': 0.3389228599202225, 'support': 219944}, 'weighted avg': {'precision': 0.34223459628543756, 'recall': 0.34188247917651765, 'f1-score': 0.34193451988281676, 'support': 219944}}
[[23106 20252 28909]
 [19006 20375 24074]
 [26551 25957 31714]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1232607
{'0': {'precision': 0.34194128819432873, 'recall': 0.37669774612730345, 'f1-score': 0.3584790316664629, 'support': 27242}, '1': {'precision': 0.3376674907670238, 'recall': 0.4064589609817033, 'f1-score': 0.36888347976859337, 'support': 27218}, '2': {'precision': 0.34281785487624283, 'recall': 0.23811622952024097, 'f1-score': 0.28103186646433986, 'support': 27222}, 'accuracy': 0.3404299600891261, 'macro avg': {'precision': 0.3408088779458651, 'recall': 0.3404243122097492, 'f1-score': 0.33613145929979876, 'support': 81682}, 'weighted avg': {'precision': 0.340809309053743, 'recall': 0.3404299600891261, 'f1-score': 0.3361353272678389, 'support': 81682}}
[[10262 10804  6176]
 [ 9905 11063  6250]
 [ 9844 10896  6482]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1275702
{'0': {'precision': 0.3370573355817875, 'recall': 0.37890995260663507, 'f1-score': 0.356760374832664, 'support': 8440}, '1': {'precision': 0.3155329289428076, 'recall': 0.35839074803149606, 'f1-score': 0.3355990783410138, 'support': 8128}, '2': {'precision': 0.3488223041179298, 'recall': 0.25938281901584653, 'f1-score': 0.29752630859641926, 'support': 8393}, 'accuracy': 0.3320379792476263, 'macro avg': {'precision': 0.3338041895475083, 'recall': 0.3322278398846592, 'f1-score': 0.3299619205900324, 'support': 24961}, 'weighted avg': {'precision': 0.3340042929858264, 'recall': 0.3320379792476263, 'f1-score': 0.3299525331674689, 'support': 24961}}
[[3198 3102 2140]
 [3291 2913 1924]
 [2999 3217 2177]]
training model: results/CHTR/W2/deepLOB_L1/h300
Epoch 1/50
320/320 - 11s - loss: 3.3511 - accuracy300: 0.3492 - val_loss: 3.3800 - val_accuracy300: 0.3330 - 11s/epoch - 35ms/step
Epoch 2/50
320/320 - 9s - loss: 3.3184 - accuracy300: 0.3591 - val_loss: 3.3686 - val_accuracy300: 0.3431 - 9s/epoch - 27ms/step
Epoch 3/50
320/320 - 8s - loss: 3.2997 - accuracy300: 0.3650 - val_loss: 3.3435 - val_accuracy300: 0.3497 - 8s/epoch - 26ms/step
Epoch 4/50
320/320 - 9s - loss: 3.2935 - accuracy300: 0.3633 - val_loss: 3.3407 - val_accuracy300: 0.3505 - 9s/epoch - 27ms/step
Epoch 5/50
320/320 - 9s - loss: 3.2813 - accuracy300: 0.3701 - val_loss: 3.3404 - val_accuracy300: 0.3502 - 9s/epoch - 28ms/step
Epoch 6/50
320/320 - 8s - loss: 3.2743 - accuracy300: 0.3778 - val_loss: 3.3373 - val_accuracy300: 0.3497 - 8s/epoch - 26ms/step
Epoch 7/50
320/320 - 9s - loss: 3.2666 - accuracy300: 0.3847 - val_loss: 3.3358 - val_accuracy300: 0.3554 - 9s/epoch - 28ms/step
Epoch 8/50
320/320 - 9s - loss: 3.2599 - accuracy300: 0.3882 - val_loss: 3.3383 - val_accuracy300: 0.3516 - 9s/epoch - 28ms/step
Epoch 9/50
320/320 - 9s - loss: 3.2559 - accuracy300: 0.3945 - val_loss: 3.3482 - val_accuracy300: 0.3534 - 9s/epoch - 28ms/step
Epoch 10/50
320/320 - 9s - loss: 3.2478 - accuracy300: 0.3982 - val_loss: 3.3539 - val_accuracy300: 0.3490 - 9s/epoch - 27ms/step
Epoch 11/50
320/320 - 9s - loss: 3.2448 - accuracy300: 0.4009 - val_loss: 3.3842 - val_accuracy300: 0.3484 - 9s/epoch - 27ms/step
Epoch 12/50
320/320 - 9s - loss: 3.2404 - accuracy300: 0.4007 - val_loss: 3.3950 - val_accuracy300: 0.3477 - 9s/epoch - 27ms/step
Epoch 13/50
320/320 - 9s - loss: 3.2337 - accuracy300: 0.4053 - val_loss: 3.4167 - val_accuracy300: 0.3500 - 9s/epoch - 27ms/step
Epoch 14/50
320/320 - 8s - loss: 3.2300 - accuracy300: 0.4083 - val_loss: 3.4152 - val_accuracy300: 0.3447 - 8s/epoch - 26ms/step
Epoch 15/50
320/320 - 9s - loss: 3.2253 - accuracy300: 0.4105 - val_loss: 3.4302 - val_accuracy300: 0.3458 - 9s/epoch - 27ms/step
Epoch 16/50
320/320 - 9s - loss: 3.2198 - accuracy300: 0.4142 - val_loss: 3.4218 - val_accuracy300: 0.3489 - 9s/epoch - 27ms/step
Epoch 17/50
320/320 - 9s - loss: 3.2142 - accuracy300: 0.4162 - val_loss: 3.4254 - val_accuracy300: 0.3401 - 9s/epoch - 27ms/step
testing model: results/CHTR/W2/deepLOB_L1/h300
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1296132
{'0': {'precision': 0.3031272601490519, 'recall': 0.5292640074669888, 'f1-score': 0.3854782113187175, 'support': 72854}, '1': {'precision': 0.2712098009188361, 'recall': 0.029691350780424834, 'f1-score': 0.05352312737053659, 'support': 59647}, '2': {'precision': 0.3988052430112516, 'recall': 0.3931818441727754, 'f1-score': 0.39597357949473955, 'support': 87443}, 'accuracy': 0.3396819190339359, 'macro avg': {'precision': 0.3243807680263799, 'recall': 0.31737906747339634, 'f1-score': 0.2783249727279979, 'support': 219944}, 'weighted avg': {'precision': 0.3325101447229191, 'recall': 0.3396819190339359, 'f1-score': 0.2996273655905265, 'support': 219944}}
[[38559  2208 32087]
 [38134  1771 19742]
 [50511  2551 34381]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1129843
{'0': {'precision': 0.33406850920118547, 'recall': 0.5295917252431074, 'f1-score': 0.4096979601036853, 'support': 27457}, '1': {'precision': 0.31131592421915005, 'recall': 0.022572022572022572, 'f1-score': 0.042092145799439235, 'support': 26936}, '2': {'precision': 0.33409756367051546, 'recall': 0.4432188794019568, 'f1-score': 0.380998881731269, 'support': 27289}, 'accuracy': 0.33353737665581157, 'macro avg': {'precision': 0.3264939990302837, 'recall': 0.3317942090723623, 'f1-score': 0.2775963292114645, 'support': 81682}, 'weighted avg': {'precision': 0.32657517209310094, 'recall': 0.33353737665581157, 'f1-score': 0.27888579385158524, 'support': 81682}}
[[14541   689 12227]
 [14448   608 11880]
 [14538   656 12095]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1124725
{'0': {'precision': 0.3441821649976156, 'recall': 0.6675144508670521, 'f1-score': 0.4541807598521199, 'support': 8650}, '1': {'precision': 0.26749611197511663, 'recall': 0.022014591066171766, 'f1-score': 0.04068117313150426, 'support': 7813}, '2': {'precision': 0.3705913550782286, 'recall': 0.3289009178630266, 'f1-score': 0.3485037406483791, 'support': 8498}, 'accuracy': 0.3501862906133568, 'macro avg': {'precision': 0.3274232106836536, 'recall': 0.3394766532654168, 'f1-score': 0.2811218912106677, 'support': 24961}, 'weighted avg': {'precision': 0.329169832360312, 'recall': 0.3501862906133568, 'f1-score': 0.28877410225660854, 'support': 24961}}
[[5774  236 2640]
 [5534  172 2107]
 [5468  235 2795]]
training model: results/CHTR/W2/deepLOB_L1/h500
Epoch 1/50
320/320 - 11s - loss: 3.3496 - accuracy500: 0.3481 - val_loss: 3.3898 - val_accuracy500: 0.3320 - 11s/epoch - 34ms/step
Epoch 2/50
320/320 - 9s - loss: 3.3102 - accuracy500: 0.3577 - val_loss: 3.4097 - val_accuracy500: 0.3277 - 9s/epoch - 28ms/step
Epoch 3/50
320/320 - 9s - loss: 3.2936 - accuracy500: 0.3698 - val_loss: 3.3804 - val_accuracy500: 0.3177 - 9s/epoch - 28ms/step
Epoch 4/50
320/320 - 9s - loss: 3.2898 - accuracy500: 0.3714 - val_loss: 3.3874 - val_accuracy500: 0.3203 - 9s/epoch - 27ms/step
Epoch 5/50
320/320 - 9s - loss: 3.2816 - accuracy500: 0.3750 - val_loss: 3.3728 - val_accuracy500: 0.3465 - 9s/epoch - 28ms/step
Epoch 6/50
320/320 - 9s - loss: 3.2647 - accuracy500: 0.3875 - val_loss: 3.5151 - val_accuracy500: 0.3348 - 9s/epoch - 28ms/step
Epoch 7/50
320/320 - 9s - loss: 3.2532 - accuracy500: 0.3920 - val_loss: 3.4557 - val_accuracy500: 0.3251 - 9s/epoch - 28ms/step
Epoch 8/50
320/320 - 8s - loss: 3.2373 - accuracy500: 0.4046 - val_loss: 3.4964 - val_accuracy500: 0.3328 - 8s/epoch - 26ms/step
Epoch 9/50
320/320 - 9s - loss: 3.2277 - accuracy500: 0.4103 - val_loss: 3.5501 - val_accuracy500: 0.3323 - 9s/epoch - 27ms/step
Epoch 10/50
320/320 - 9s - loss: 3.2150 - accuracy500: 0.4166 - val_loss: 3.5605 - val_accuracy500: 0.3355 - 9s/epoch - 28ms/step
Epoch 11/50
320/320 - 9s - loss: 3.2106 - accuracy500: 0.4197 - val_loss: 3.5922 - val_accuracy500: 0.3415 - 9s/epoch - 27ms/step
Epoch 12/50
320/320 - 9s - loss: 3.2026 - accuracy500: 0.4221 - val_loss: 3.5540 - val_accuracy500: 0.3405 - 9s/epoch - 28ms/step
Epoch 13/50
320/320 - 9s - loss: 3.1943 - accuracy500: 0.4268 - val_loss: 3.6063 - val_accuracy500: 0.3388 - 9s/epoch - 28ms/step
Epoch 14/50
320/320 - 9s - loss: 3.1854 - accuracy500: 0.4308 - val_loss: 3.5957 - val_accuracy500: 0.3433 - 9s/epoch - 29ms/step
Epoch 15/50
320/320 - 9s - loss: 3.1815 - accuracy500: 0.4319 - val_loss: 3.6049 - val_accuracy500: 0.3403 - 9s/epoch - 28ms/step
testing model: results/CHTR/W2/deepLOB_L1/h500
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1481292
{'0': {'precision': 0.309157192490254, 'recall': 0.5319459451874097, 'f1-score': 0.39104577691811737, 'support': 71261}, '1': {'precision': 0.2831321176712235, 'recall': 0.20435190828378, 'f1-score': 0.23737634655492412, 'support': 60709}, '2': {'precision': 0.4071907760731037, 'recall': 0.24768681655943803, 'f1-score': 0.30801416384544167, 'support': 87974}, 'accuracy': 0.3278243552904376, 'macro avg': {'precision': 0.3331600287448604, 'recall': 0.32799489001020926, 'f1-score': 0.31214542910616105, 'support': 219944}, 'weighted avg': {'precision': 0.34118557341871353, 'recall': 0.3278243552904376, 'f1-score': 0.31541861465692966, 'support': 219944}}
[[37907 14465 18889]
 [35469 12406 12834]
 [49238 16946 21790]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1185416
{'0': {'precision': 0.341005144057768, 'recall': 0.5160441488195308, 'f1-score': 0.41065014759557356, 'support': 27362}, '1': {'precision': 0.3300564199008377, 'recall': 0.14320685434516525, 'f1-score': 0.1997465014614967, 'support': 26961}, '2': {'precision': 0.34937187248486545, 'recall': 0.36492561862641176, 'f1-score': 0.35697940503432496, 'support': 27359}, 'accuracy': 0.3423642907862197, 'macro avg': {'precision': 0.34014447881449045, 'recall': 0.34139220726370256, 'f1-score': 0.32245868469713174, 'support': 81682}, 'weighted avg': {'precision': 0.34019366504209697, 'recall': 0.3423642907862197, 'f1-score': 0.3230598455810043, 'support': 81682}}
[[14120  3937  9305]
 [13812  3861  9288]
 [13475  3900  9984]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.124277
{'0': {'precision': 0.35021860394994725, 'recall': 0.5312142693802882, 'f1-score': 0.4221333817917499, 'support': 8746}, '1': {'precision': 0.3139391447368421, 'recall': 0.2045271899276721, 'f1-score': 0.24768856447688561, 'support': 7466}, '2': {'precision': 0.3776899429073342, 'recall': 0.29489084466796206, 'f1-score': 0.33119383825417203, 'support': 8749}, 'accuracy': 0.35066704058330994, 'macro avg': {'precision': 0.34728256386470785, 'recall': 0.3435441013253075, 'f1-score': 0.3336719281742692, 'support': 24961}, 'weighted avg': {'precision': 0.34899606887735946, 'recall': 0.35066704058330994, 'f1-score': 0.3380808569536807, 'support': 24961}}
[[4646 1698 2402]
 [4090 1527 1849]
 [4530 1639 2580]]
training model: results/CHTR/W2/deepLOB_L1/h1000
Epoch 1/50
320/320 - 11s - loss: 3.3370 - accuracy1000: 0.3634 - val_loss: 3.4133 - val_accuracy1000: 0.3417 - 11s/epoch - 34ms/step
Epoch 2/50
320/320 - 9s - loss: 3.3103 - accuracy1000: 0.3734 - val_loss: 3.4203 - val_accuracy1000: 0.3360 - 9s/epoch - 28ms/step
Epoch 3/50
320/320 - 8s - loss: 3.2775 - accuracy1000: 0.3860 - val_loss: 3.6228 - val_accuracy1000: 0.3296 - 8s/epoch - 25ms/step
Epoch 4/50
320/320 - 8s - loss: 3.2421 - accuracy1000: 0.4050 - val_loss: 3.6564 - val_accuracy1000: 0.3463 - 8s/epoch - 26ms/step
Epoch 5/50
320/320 - 8s - loss: 3.2321 - accuracy1000: 0.4093 - val_loss: 3.5365 - val_accuracy1000: 0.3465 - 8s/epoch - 24ms/step
Epoch 6/50
320/320 - 8s - loss: 3.2165 - accuracy1000: 0.4134 - val_loss: 3.6579 - val_accuracy1000: 0.3481 - 8s/epoch - 25ms/step
Epoch 7/50
320/320 - 8s - loss: 3.1822 - accuracy1000: 0.4293 - val_loss: 3.7066 - val_accuracy1000: 0.3471 - 8s/epoch - 25ms/step
Epoch 8/50
320/320 - 8s - loss: 3.1709 - accuracy1000: 0.4370 - val_loss: 3.6796 - val_accuracy1000: 0.3471 - 8s/epoch - 26ms/step
Epoch 9/50
320/320 - 8s - loss: 3.1467 - accuracy1000: 0.4479 - val_loss: 3.7324 - val_accuracy1000: 0.3509 - 8s/epoch - 24ms/step
Epoch 10/50
320/320 - 8s - loss: 3.1339 - accuracy1000: 0.4528 - val_loss: 3.7798 - val_accuracy1000: 0.3445 - 8s/epoch - 26ms/step
Epoch 11/50
320/320 - 8s - loss: 3.1237 - accuracy1000: 0.4593 - val_loss: 3.7840 - val_accuracy1000: 0.3515 - 8s/epoch - 24ms/step
testing model: results/CHTR/W2/deepLOB_L1/h1000
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1466961
{'0': {'precision': 0.3145044760750054, 'recall': 0.27738958470665787, 'f1-score': 0.29478338029484563, 'support': 68265}, '1': {'precision': 0.28078411257679997, 'recall': 0.41713878673425436, 'f1-score': 0.3356414989969809, 'support': 60366}, '2': {'precision': 0.42908327861364093, 'recall': 0.3291864247149913, 'f1-score': 0.37255448759659654, 'support': 91313}, 'accuracy': 0.3372494816862474, 'macro avg': {'precision': 0.3414572890884821, 'recall': 0.3412382653853012, 'f1-score': 0.33432645562947433, 'support': 219944}, 'weighted avg': {'precision': 0.3528186411955714, 'recall': 0.3372494816862474, 'f1-score': 0.33828515490391825, 'support': 219944}}
[[18936 27338 21991]
 [17181 25181 18004]
 [24092 37162 30059]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.140907
{'0': {'precision': 0.3373325715736685, 'recall': 0.1910548644567484, 'f1-score': 0.24394610599765879, 'support': 27814}, '1': {'precision': 0.32931264960984863, 'recall': 0.3925077812361049, 'f1-score': 0.35814385935254844, 'support': 26988}, '2': {'precision': 0.31612463716604466, 'recall': 0.3970610119047619, 'f1-score': 0.3520002638435408, 'support': 26880}, 'accuracy': 0.3254082906882789, 'macro avg': {'precision': 0.3275899527831873, 'recall': 0.32687455253253844, 'f1-score': 0.318030076397916, 'support': 81682}, 'weighted avg': {'precision': 0.3277036333640691, 'recall': 0.3254082906882789, 'f1-score': 0.31723599520751, 'support': 81682}}
[[ 5314 10688 11812]
 [ 5118 10593 11277]
 [ 5321 10886 10673]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1367792
{'0': {'precision': 0.34345071460144394, 'recall': 0.26041783041001004, 'f1-score': 0.29622569576820434, 'support': 8951}, '1': {'precision': 0.31465314934760164, 'recall': 0.4450936130659939, 'f1-score': 0.3686757589089309, 'support': 7531}, '2': {'precision': 0.3736205291849488, 'recall': 0.3314070055431065, 'f1-score': 0.35125, 'support': 8479}, 'accuracy': 0.34025079123432556, 'macro avg': {'precision': 0.3439081310446648, 'recall': 0.3456394830063701, 'f1-score': 0.3387171515590451, 'support': 24961}, 'weighted avg': {'precision': 0.3450105637231479, 'recall': 0.34025079123432556, 'f1-score': 0.33677585405890614, 'support': 24961}}
[[2331 3882 2738]
 [2206 3352 1973]
 [2250 3419 2810]]
training model: results/CHTR/W2/deepOF_L1/h10
Epoch 1/50
320/320 - 10s - loss: 3.3017 - accuracy10: 0.3724 - val_loss: 3.2590 - val_accuracy10: 0.4054 - 10s/epoch - 33ms/step
Epoch 2/50
320/320 - 8s - loss: 3.2575 - accuracy10: 0.3999 - val_loss: 3.2428 - val_accuracy10: 0.4139 - 8s/epoch - 25ms/step
Epoch 3/50
320/320 - 8s - loss: 3.2410 - accuracy10: 0.4077 - val_loss: 3.2344 - val_accuracy10: 0.4181 - 8s/epoch - 25ms/step
Epoch 4/50
320/320 - 8s - loss: 3.2272 - accuracy10: 0.4148 - val_loss: 3.2314 - val_accuracy10: 0.4163 - 8s/epoch - 25ms/step
Epoch 5/50
320/320 - 8s - loss: 3.2194 - accuracy10: 0.4181 - val_loss: 3.2253 - val_accuracy10: 0.4189 - 8s/epoch - 25ms/step
Epoch 6/50
320/320 - 7s - loss: 3.2136 - accuracy10: 0.4209 - val_loss: 3.2219 - val_accuracy10: 0.4199 - 7s/epoch - 23ms/step
Epoch 7/50
320/320 - 7s - loss: 3.2067 - accuracy10: 0.4228 - val_loss: 3.2203 - val_accuracy10: 0.4193 - 7s/epoch - 23ms/step
Epoch 8/50
320/320 - 8s - loss: 3.2005 - accuracy10: 0.4251 - val_loss: 3.2164 - val_accuracy10: 0.4183 - 8s/epoch - 24ms/step
Epoch 9/50
320/320 - 8s - loss: 3.1970 - accuracy10: 0.4264 - val_loss: 3.2139 - val_accuracy10: 0.4193 - 8s/epoch - 24ms/step
Epoch 10/50
320/320 - 7s - loss: 3.1922 - accuracy10: 0.4289 - val_loss: 3.2148 - val_accuracy10: 0.4193 - 7s/epoch - 23ms/step
Epoch 11/50
320/320 - 7s - loss: 3.1880 - accuracy10: 0.4306 - val_loss: 3.2156 - val_accuracy10: 0.4207 - 7s/epoch - 23ms/step
Epoch 12/50
320/320 - 7s - loss: 3.1827 - accuracy10: 0.4339 - val_loss: 3.2115 - val_accuracy10: 0.4213 - 7s/epoch - 23ms/step
Epoch 13/50
320/320 - 7s - loss: 3.1796 - accuracy10: 0.4364 - val_loss: 3.2150 - val_accuracy10: 0.4170 - 7s/epoch - 23ms/step
Epoch 14/50
320/320 - 8s - loss: 3.1755 - accuracy10: 0.4360 - val_loss: 3.2141 - val_accuracy10: 0.4205 - 8s/epoch - 24ms/step
Epoch 15/50
320/320 - 8s - loss: 3.1728 - accuracy10: 0.4363 - val_loss: 3.2119 - val_accuracy10: 0.4213 - 8s/epoch - 24ms/step
Epoch 16/50
320/320 - 8s - loss: 3.1692 - accuracy10: 0.4383 - val_loss: 3.2099 - val_accuracy10: 0.4201 - 8s/epoch - 25ms/step
Epoch 17/50
320/320 - 8s - loss: 3.1668 - accuracy10: 0.4399 - val_loss: 3.2122 - val_accuracy10: 0.4205 - 8s/epoch - 24ms/step
Epoch 18/50
320/320 - 8s - loss: 3.1619 - accuracy10: 0.4403 - val_loss: 3.2136 - val_accuracy10: 0.4224 - 8s/epoch - 24ms/step
Epoch 19/50
320/320 - 8s - loss: 3.1596 - accuracy10: 0.4432 - val_loss: 3.2131 - val_accuracy10: 0.4195 - 8s/epoch - 24ms/step
Epoch 20/50
320/320 - 8s - loss: 3.1570 - accuracy10: 0.4421 - val_loss: 3.2127 - val_accuracy10: 0.4188 - 8s/epoch - 24ms/step
Epoch 21/50
320/320 - 8s - loss: 3.1534 - accuracy10: 0.4457 - val_loss: 3.2107 - val_accuracy10: 0.4189 - 8s/epoch - 25ms/step
Epoch 22/50
320/320 - 8s - loss: 3.1489 - accuracy10: 0.4455 - val_loss: 3.2131 - val_accuracy10: 0.4185 - 8s/epoch - 25ms/step
Epoch 23/50
320/320 - 8s - loss: 3.1447 - accuracy10: 0.4493 - val_loss: 3.2188 - val_accuracy10: 0.4187 - 8s/epoch - 25ms/step
Epoch 24/50
320/320 - 8s - loss: 3.1441 - accuracy10: 0.4475 - val_loss: 3.2177 - val_accuracy10: 0.4184 - 8s/epoch - 25ms/step
Epoch 25/50
320/320 - 8s - loss: 3.1411 - accuracy10: 0.4492 - val_loss: 3.2175 - val_accuracy10: 0.4180 - 8s/epoch - 25ms/step
Epoch 26/50
320/320 - 8s - loss: 3.1394 - accuracy10: 0.4489 - val_loss: 3.2182 - val_accuracy10: 0.4189 - 8s/epoch - 25ms/step
testing model: results/CHTR/W2/deepOF_L1/h10
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0743128
{'0': {'precision': 0.41339911962463116, 'recall': 0.5473210969221114, 'f1-score': 0.47102591518865955, 'support': 78073}, '1': {'precision': 0.38306347982523775, 'recall': 0.2735991923271075, 'f1-score': 0.3192076027305582, 'support': 65373}, '2': {'precision': 0.4469820554649266, 'recall': 0.4083510909494987, 'f1-score': 0.4267941929974381, 'support': 76493}, 'accuracy': 0.41762943361568433, 'macro avg': {'precision': 0.41448155163826517, 'recall': 0.4097571267329059, 'f1-score': 0.4056759036388853, 'support': 219939}, 'weighted avg': {'precision': 0.4160622568155158, 'recall': 0.41762943361568433, 'f1-score': 0.41051715746085066, 'support': 219939}}
[[42731 14034 21308]
 [30149 17886 17338]
 [30485 14772 31236]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0613633
{'0': {'precision': 0.43189964157706096, 'recall': 0.5347505547204925, 'f1-score': 0.47785346509322335, 'support': 27942}, '1': {'precision': 0.4450206371044555, 'recall': 0.3118279569892473, 'f1-score': 0.3667044562658062, 'support': 26970}, '2': {'precision': 0.43104977471884204, 'recall': 0.4538832231312339, 'f1-score': 0.4421719193536648, 'support': 26769}, 'accuracy': 0.4346420832262093, 'macro avg': {'precision': 0.4359900178001195, 'recall': 0.43348724494699126, 'f1-score': 0.42890994690423145, 'support': 81681}, 'weighted avg': {'precision': 0.43595349943196193, 'recall': 0.4346420832262093, 'f1-score': 0.4294597374701815, 'support': 81681}}
[[14942  5461  7539]
 [10062  8410  8498]
 [ 9592  5027 12150]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.069335
{'0': {'precision': 0.42607538802660755, 'recall': 0.5362804197365484, 'f1-score': 0.4748677902436614, 'support': 8958}, '1': {'precision': 0.42548423243156713, 'recall': 0.32426497499085033, 'f1-score': 0.3680420936028801, 'support': 8197}, '2': {'precision': 0.408388224223686, 'recall': 0.3891878042531386, 'f1-score': 0.398556903902919, 'support': 7806}, 'accuracy': 0.42065622370898603, 'macro avg': {'precision': 0.41998261489395355, 'recall': 0.4165777329935125, 'f1-score': 0.4138222625831534, 'support': 24961}, 'weighted avg': {'precision': 0.4203499882806779, 'recall': 0.42065622370898603, 'f1-score': 0.4159225150487445, 'support': 24961}}
[[4804 1891 2263]
 [3401 2658 2138]
 [3070 1698 3038]]
training model: results/CHTR/W2/deepOF_L1/h20
Epoch 1/50
320/320 - 10s - loss: 3.3097 - accuracy20: 0.3651 - val_loss: 3.2672 - val_accuracy20: 0.3974 - 10s/epoch - 31ms/step
Epoch 2/50
320/320 - 8s - loss: 3.2640 - accuracy20: 0.3954 - val_loss: 3.2534 - val_accuracy20: 0.4094 - 8s/epoch - 24ms/step
Epoch 3/50
320/320 - 8s - loss: 3.2485 - accuracy20: 0.4024 - val_loss: 3.2491 - val_accuracy20: 0.4117 - 8s/epoch - 24ms/step
Epoch 4/50
320/320 - 8s - loss: 3.2381 - accuracy20: 0.4098 - val_loss: 3.2423 - val_accuracy20: 0.4105 - 8s/epoch - 25ms/step
Epoch 5/50
320/320 - 8s - loss: 3.2294 - accuracy20: 0.4121 - val_loss: 3.2393 - val_accuracy20: 0.4118 - 8s/epoch - 25ms/step
Epoch 6/50
320/320 - 8s - loss: 3.2235 - accuracy20: 0.4167 - val_loss: 3.2366 - val_accuracy20: 0.4173 - 8s/epoch - 25ms/step
Epoch 7/50
320/320 - 8s - loss: 3.2177 - accuracy20: 0.4200 - val_loss: 3.2316 - val_accuracy20: 0.4184 - 8s/epoch - 25ms/step
Epoch 8/50
320/320 - 8s - loss: 3.2129 - accuracy20: 0.4207 - val_loss: 3.2304 - val_accuracy20: 0.4154 - 8s/epoch - 25ms/step
Epoch 9/50
320/320 - 8s - loss: 3.2079 - accuracy20: 0.4224 - val_loss: 3.2288 - val_accuracy20: 0.4221 - 8s/epoch - 25ms/step
Epoch 10/50
320/320 - 8s - loss: 3.2054 - accuracy20: 0.4248 - val_loss: 3.2285 - val_accuracy20: 0.4181 - 8s/epoch - 25ms/step
Epoch 11/50
320/320 - 8s - loss: 3.2020 - accuracy20: 0.4272 - val_loss: 3.2299 - val_accuracy20: 0.4152 - 8s/epoch - 24ms/step
Epoch 12/50
320/320 - 8s - loss: 3.1984 - accuracy20: 0.4284 - val_loss: 3.2261 - val_accuracy20: 0.4177 - 8s/epoch - 25ms/step
Epoch 13/50
320/320 - 8s - loss: 3.1950 - accuracy20: 0.4290 - val_loss: 3.2233 - val_accuracy20: 0.4191 - 8s/epoch - 25ms/step
Epoch 14/50
320/320 - 8s - loss: 3.1934 - accuracy20: 0.4304 - val_loss: 3.2247 - val_accuracy20: 0.4193 - 8s/epoch - 25ms/step
Epoch 15/50
320/320 - 8s - loss: 3.1892 - accuracy20: 0.4317 - val_loss: 3.2222 - val_accuracy20: 0.4199 - 8s/epoch - 25ms/step
Epoch 16/50
320/320 - 8s - loss: 3.1865 - accuracy20: 0.4337 - val_loss: 3.2229 - val_accuracy20: 0.4179 - 8s/epoch - 25ms/step
Epoch 17/50
320/320 - 8s - loss: 3.1833 - accuracy20: 0.4347 - val_loss: 3.2249 - val_accuracy20: 0.4189 - 8s/epoch - 25ms/step
Epoch 18/50
320/320 - 8s - loss: 3.1809 - accuracy20: 0.4347 - val_loss: 3.2225 - val_accuracy20: 0.4216 - 8s/epoch - 24ms/step
Epoch 19/50
320/320 - 8s - loss: 3.1792 - accuracy20: 0.4358 - val_loss: 3.2243 - val_accuracy20: 0.4191 - 8s/epoch - 24ms/step
Epoch 20/50
320/320 - 8s - loss: 3.1754 - accuracy20: 0.4376 - val_loss: 3.2242 - val_accuracy20: 0.4190 - 8s/epoch - 25ms/step
Epoch 21/50
320/320 - 8s - loss: 3.1722 - accuracy20: 0.4393 - val_loss: 3.2259 - val_accuracy20: 0.4161 - 8s/epoch - 25ms/step
Epoch 22/50
320/320 - 8s - loss: 3.1704 - accuracy20: 0.4411 - val_loss: 3.2210 - val_accuracy20: 0.4206 - 8s/epoch - 25ms/step
Epoch 23/50
320/320 - 8s - loss: 3.1672 - accuracy20: 0.4408 - val_loss: 3.2218 - val_accuracy20: 0.4182 - 8s/epoch - 25ms/step
Epoch 24/50
320/320 - 8s - loss: 3.1630 - accuracy20: 0.4429 - val_loss: 3.2250 - val_accuracy20: 0.4168 - 8s/epoch - 25ms/step
Epoch 25/50
320/320 - 8s - loss: 3.1599 - accuracy20: 0.4438 - val_loss: 3.2264 - val_accuracy20: 0.4183 - 8s/epoch - 25ms/step
Epoch 26/50
320/320 - 8s - loss: 3.1577 - accuracy20: 0.4460 - val_loss: 3.2314 - val_accuracy20: 0.4182 - 8s/epoch - 24ms/step
Epoch 27/50
320/320 - 8s - loss: 3.1535 - accuracy20: 0.4461 - val_loss: 3.2251 - val_accuracy20: 0.4172 - 8s/epoch - 25ms/step
Epoch 28/50
320/320 - 8s - loss: 3.1532 - accuracy20: 0.4462 - val_loss: 3.2267 - val_accuracy20: 0.4188 - 8s/epoch - 24ms/step
Epoch 29/50
320/320 - 8s - loss: 3.1500 - accuracy20: 0.4476 - val_loss: 3.2298 - val_accuracy20: 0.4190 - 8s/epoch - 25ms/step
Epoch 30/50
320/320 - 8s - loss: 3.1461 - accuracy20: 0.4501 - val_loss: 3.2285 - val_accuracy20: 0.4164 - 8s/epoch - 25ms/step
Epoch 31/50
320/320 - 8s - loss: 3.1433 - accuracy20: 0.4503 - val_loss: 3.2289 - val_accuracy20: 0.4182 - 8s/epoch - 25ms/step
Epoch 32/50
320/320 - 8s - loss: 3.1401 - accuracy20: 0.4523 - val_loss: 3.2324 - val_accuracy20: 0.4176 - 8s/epoch - 25ms/step
testing model: results/CHTR/W2/deepOF_L1/h20
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0815706
{'0': {'precision': 0.39565334890897835, 'recall': 0.6023384827732654, 'f1-score': 0.4775935640360523, 'support': 75348}, '1': {'precision': 0.3751612440877168, 'recall': 0.23386892618349142, 'f1-score': 0.28812548731825893, 'support': 67153}, '2': {'precision': 0.4595694988006565, 'recall': 0.3760685968129342, 'f1-score': 0.41364714571822225, 'support': 77438}, 'accuracy': 0.41016827393049893, 'macro avg': {'precision': 0.41012803059911723, 'recall': 0.40409200192323036, 'f1-score': 0.3931220656908445, 'support': 219939}, 'weighted avg': {'precision': 0.4119007288654644, 'recall': 0.41016827393049893, 'f1-score': 0.3972293153237907, 'support': 219939}}
[[45385 11899 18064]
 [35266 15705 16182]
 [34058 14258 29122]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0605963
{'0': {'precision': 0.4306917980586513, 'recall': 0.5942881440011338, 'f1-score': 0.49943422071347743, 'support': 28222}, '1': {'precision': 0.4468988954970263, 'recall': 0.2728721236150739, 'f1-score': 0.3388473484412745, 'support': 26987}, '2': {'precision': 0.4310574616351243, 'recall': 0.42762163795708674, 'f1-score': 0.4293326759334762, 'support': 26472}, 'accuracy': 0.434078916761548, 'macro avg': {'precision': 0.43621605173026734, 'recall': 0.4315939685244315, 'f1-score': 0.42253808169607604, 'support': 81681}, 'weighted avg': {'precision': 0.43616505113789644, 'recall': 0.434078916761548, 'f1-score': 0.42365789555308353, 'support': 81681}}
[[16772  4468  6982]
 [11664  7364  7959]
 [10506  4646 11320]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0734502
{'0': {'precision': 0.4151884700665188, 'recall': 0.5883078994614004, 'f1-score': 0.4868152274837512, 'support': 8912}, '1': {'precision': 0.4227053140096618, 'recall': 0.2821530447724172, 'f1-score': 0.3384157679434734, 'support': 8063}, '2': {'precision': 0.4218098115379082, 'recall': 0.3671424993739043, 'f1-score': 0.3925821784829618, 'support': 7986}, 'accuracy': 0.41865309883418134, 'macro avg': {'precision': 0.4199011985380296, 'recall': 0.41253448120257397, 'f1-score': 0.4059377246367288, 'support': 24961}, 'weighted avg': {'precision': 0.4197350165071293, 'recall': 0.41865309883418134, 'f1-score': 0.4087298153771223, 'support': 24961}}
[[5243 1601 2068]
 [3837 2275 1951]
 [3548 1506 2932]]
training model: results/CHTR/W2/deepOF_L1/h30
Epoch 1/50
320/320 - 10s - loss: 3.3106 - accuracy30: 0.3649 - val_loss: 3.2823 - val_accuracy30: 0.3873 - 10s/epoch - 31ms/step
Epoch 2/50
320/320 - 8s - loss: 3.2698 - accuracy30: 0.3890 - val_loss: 3.2610 - val_accuracy30: 0.4011 - 8s/epoch - 25ms/step
Epoch 3/50
320/320 - 8s - loss: 3.2543 - accuracy30: 0.3985 - val_loss: 3.2566 - val_accuracy30: 0.4012 - 8s/epoch - 24ms/step
Epoch 4/50
320/320 - 8s - loss: 3.2453 - accuracy30: 0.4039 - val_loss: 3.2521 - val_accuracy30: 0.4019 - 8s/epoch - 25ms/step
Epoch 5/50
320/320 - 8s - loss: 3.2375 - accuracy30: 0.4082 - val_loss: 3.2493 - val_accuracy30: 0.4042 - 8s/epoch - 25ms/step
Epoch 6/50
320/320 - 8s - loss: 3.2335 - accuracy30: 0.4097 - val_loss: 3.2471 - val_accuracy30: 0.4067 - 8s/epoch - 24ms/step
Epoch 7/50
320/320 - 8s - loss: 3.2246 - accuracy30: 0.4149 - val_loss: 3.2431 - val_accuracy30: 0.4096 - 8s/epoch - 26ms/step
Epoch 8/50
320/320 - 8s - loss: 3.2227 - accuracy30: 0.4154 - val_loss: 3.2422 - val_accuracy30: 0.4107 - 8s/epoch - 25ms/step
Epoch 9/50
320/320 - 8s - loss: 3.2173 - accuracy30: 0.4177 - val_loss: 3.2445 - val_accuracy30: 0.4100 - 8s/epoch - 25ms/step
Epoch 10/50
320/320 - 8s - loss: 3.2138 - accuracy30: 0.4217 - val_loss: 3.2430 - val_accuracy30: 0.4098 - 8s/epoch - 25ms/step
Epoch 11/50
320/320 - 8s - loss: 3.2115 - accuracy30: 0.4214 - val_loss: 3.2403 - val_accuracy30: 0.4096 - 8s/epoch - 25ms/step
Epoch 12/50
320/320 - 8s - loss: 3.2084 - accuracy30: 0.4234 - val_loss: 3.2421 - val_accuracy30: 0.4108 - 8s/epoch - 25ms/step
Epoch 13/50
320/320 - 8s - loss: 3.2034 - accuracy30: 0.4263 - val_loss: 3.2391 - val_accuracy30: 0.4104 - 8s/epoch - 25ms/step
Epoch 14/50
320/320 - 8s - loss: 3.2027 - accuracy30: 0.4252 - val_loss: 3.2422 - val_accuracy30: 0.4108 - 8s/epoch - 24ms/step
Epoch 15/50
320/320 - 8s - loss: 3.1980 - accuracy30: 0.4282 - val_loss: 3.2411 - val_accuracy30: 0.4118 - 8s/epoch - 25ms/step
Epoch 16/50
320/320 - 8s - loss: 3.1954 - accuracy30: 0.4286 - val_loss: 3.2389 - val_accuracy30: 0.4094 - 8s/epoch - 24ms/step
Epoch 17/50
320/320 - 8s - loss: 3.1933 - accuracy30: 0.4289 - val_loss: 3.2376 - val_accuracy30: 0.4125 - 8s/epoch - 25ms/step
Epoch 18/50
320/320 - 8s - loss: 3.1879 - accuracy30: 0.4325 - val_loss: 3.2371 - val_accuracy30: 0.4108 - 8s/epoch - 25ms/step
Epoch 19/50
320/320 - 8s - loss: 3.1857 - accuracy30: 0.4349 - val_loss: 3.2418 - val_accuracy30: 0.4088 - 8s/epoch - 25ms/step
Epoch 20/50
320/320 - 8s - loss: 3.1849 - accuracy30: 0.4332 - val_loss: 3.2366 - val_accuracy30: 0.4146 - 8s/epoch - 26ms/step
Epoch 21/50
320/320 - 8s - loss: 3.1816 - accuracy30: 0.4361 - val_loss: 3.2353 - val_accuracy30: 0.4134 - 8s/epoch - 25ms/step
Epoch 22/50
320/320 - 8s - loss: 3.1787 - accuracy30: 0.4355 - val_loss: 3.2328 - val_accuracy30: 0.4107 - 8s/epoch - 25ms/step
Epoch 23/50
320/320 - 8s - loss: 3.1766 - accuracy30: 0.4379 - val_loss: 3.2374 - val_accuracy30: 0.4122 - 8s/epoch - 24ms/step
Epoch 24/50
320/320 - 8s - loss: 3.1721 - accuracy30: 0.4385 - val_loss: 3.2376 - val_accuracy30: 0.4142 - 8s/epoch - 24ms/step
Epoch 25/50
320/320 - 8s - loss: 3.1702 - accuracy30: 0.4384 - val_loss: 3.2387 - val_accuracy30: 0.4089 - 8s/epoch - 24ms/step
Epoch 26/50
320/320 - 8s - loss: 3.1681 - accuracy30: 0.4414 - val_loss: 3.2384 - val_accuracy30: 0.4130 - 8s/epoch - 24ms/step
Epoch 27/50
320/320 - 8s - loss: 3.1634 - accuracy30: 0.4418 - val_loss: 3.2374 - val_accuracy30: 0.4126 - 8s/epoch - 25ms/step
Epoch 28/50
320/320 - 8s - loss: 3.1615 - accuracy30: 0.4442 - val_loss: 3.2385 - val_accuracy30: 0.4131 - 8s/epoch - 25ms/step
Epoch 29/50
320/320 - 8s - loss: 3.1580 - accuracy30: 0.4439 - val_loss: 3.2401 - val_accuracy30: 0.4093 - 8s/epoch - 24ms/step
Epoch 30/50
320/320 - 8s - loss: 3.1554 - accuracy30: 0.4460 - val_loss: 3.2417 - val_accuracy30: 0.4106 - 8s/epoch - 24ms/step
Epoch 31/50
320/320 - 8s - loss: 3.1514 - accuracy30: 0.4476 - val_loss: 3.2429 - val_accuracy30: 0.4116 - 8s/epoch - 25ms/step
Epoch 32/50
320/320 - 8s - loss: 3.1464 - accuracy30: 0.4508 - val_loss: 3.2458 - val_accuracy30: 0.4084 - 8s/epoch - 24ms/step
testing model: results/CHTR/W2/deepOF_L1/h30
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0791411
{'0': {'precision': 0.4001945637726108, 'recall': 0.5564796957034179, 'f1-score': 0.4655715294196744, 'support': 74664}, '1': {'precision': 0.3918559598875636, 'recall': 0.22999405469678955, 'f1-score': 0.2898594161226573, 'support': 67280}, '2': {'precision': 0.44499399697238606, 'recall': 0.4371946919674338, 'f1-score': 0.44105986819554666, 'support': 77995}, 'accuracy': 0.4143057847857815, 'macro avg': {'precision': 0.4123481735441869, 'recall': 0.4078894807892138, 'f1-score': 0.39883027124595943, 'support': 219939}, 'weighted avg': {'precision': 0.4135305820459979, 'recall': 0.4143057847857815, 'f1-score': 0.4031283156203976, 'support': 219939}}
[[41549 11399 21716]
 [30993 15474 20813]
 [31280 12616 34099]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0642308
{'0': {'precision': 0.4362774642485343, 'recall': 0.5667864896608179, 'f1-score': 0.4930416879518259, 'support': 28097}, '1': {'precision': 0.44550656344665096, 'recall': 0.24328199095687975, 'f1-score': 0.3147082600218745, 'support': 27203}, '2': {'precision': 0.4149518533175043, 'recall': 0.4769720632273227, 'f1-score': 0.443805660876466, 'support': 26381}, 'accuracy': 0.4300388095150647, 'macro avg': {'precision': 0.4322452936708965, 'recall': 0.42901351461500675, 'f1-score': 0.4171852029500555, 'support': 81681}, 'weighted avg': {'precision': 0.43246345907615474, 'recall': 0.4300388095150647, 'f1-score': 0.41774755748998604, 'support': 81681}}
[[15925  4083  8089]
 [10933  6618  9652]
 [ 9644  4154 12583]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0771042
{'0': {'precision': 0.4127822752449936, 'recall': 0.554233409610984, 'f1-score': 0.47316239316239317, 'support': 8740}, '1': {'precision': 0.42505133470225875, 'recall': 0.251488276029644, 'f1-score': 0.31600641172429583, 'support': 8231}, '2': {'precision': 0.4120392532312111, 'recall': 0.4309136420525657, 'f1-score': 0.42126514131897713, 'support': 7990}, 'accuracy': 0.4149272865670446, 'macro avg': {'precision': 0.4166242877261545, 'recall': 0.4122117758977312, 'f1-score': 0.4034779820685554, 'support': 24961}, 'weighted avg': {'precision': 0.4165902109247592, 'recall': 0.4149272865670446, 'f1-score': 0.4047272373014151, 'support': 24961}}
[[4844 1484 2412]
 [3660 2070 2501]
 [3231 1316 3443]]
training model: results/CHTR/W2/deepOF_L1/h50
Epoch 1/50
320/320 - 10s - loss: 3.3191 - accuracy50: 0.3599 - val_loss: 3.2934 - val_accuracy50: 0.3743 - 10s/epoch - 30ms/step
Epoch 2/50
320/320 - 8s - loss: 3.2815 - accuracy50: 0.3800 - val_loss: 3.2829 - val_accuracy50: 0.3825 - 8s/epoch - 26ms/step
Epoch 3/50
320/320 - 8s - loss: 3.2682 - accuracy50: 0.3864 - val_loss: 3.2747 - val_accuracy50: 0.3874 - 8s/epoch - 25ms/step
Epoch 4/50
320/320 - 8s - loss: 3.2595 - accuracy50: 0.3919 - val_loss: 3.2729 - val_accuracy50: 0.3900 - 8s/epoch - 26ms/step
Epoch 5/50
320/320 - 8s - loss: 3.2529 - accuracy50: 0.3967 - val_loss: 3.2671 - val_accuracy50: 0.3961 - 8s/epoch - 26ms/step
Epoch 6/50
320/320 - 8s - loss: 3.2487 - accuracy50: 0.3998 - val_loss: 3.2673 - val_accuracy50: 0.3927 - 8s/epoch - 25ms/step
Epoch 7/50
320/320 - 8s - loss: 3.2439 - accuracy50: 0.4046 - val_loss: 3.2651 - val_accuracy50: 0.4008 - 8s/epoch - 26ms/step
Epoch 8/50
320/320 - 8s - loss: 3.2414 - accuracy50: 0.4049 - val_loss: 3.2632 - val_accuracy50: 0.3993 - 8s/epoch - 26ms/step
Epoch 9/50
320/320 - 8s - loss: 3.2360 - accuracy50: 0.4066 - val_loss: 3.2632 - val_accuracy50: 0.3997 - 8s/epoch - 24ms/step
Epoch 10/50
320/320 - 8s - loss: 3.2342 - accuracy50: 0.4107 - val_loss: 3.2633 - val_accuracy50: 0.3979 - 8s/epoch - 25ms/step
Epoch 11/50
320/320 - 8s - loss: 3.2314 - accuracy50: 0.4102 - val_loss: 3.2635 - val_accuracy50: 0.3985 - 8s/epoch - 25ms/step
Epoch 12/50
320/320 - 8s - loss: 3.2272 - accuracy50: 0.4134 - val_loss: 3.2637 - val_accuracy50: 0.3990 - 8s/epoch - 26ms/step
Epoch 13/50
320/320 - 8s - loss: 3.2255 - accuracy50: 0.4138 - val_loss: 3.2588 - val_accuracy50: 0.4023 - 8s/epoch - 25ms/step
Epoch 14/50
320/320 - 8s - loss: 3.2213 - accuracy50: 0.4162 - val_loss: 3.2602 - val_accuracy50: 0.4022 - 8s/epoch - 25ms/step
Epoch 15/50
320/320 - 8s - loss: 3.2193 - accuracy50: 0.4167 - val_loss: 3.2602 - val_accuracy50: 0.4029 - 8s/epoch - 24ms/step
Epoch 16/50
320/320 - 8s - loss: 3.2149 - accuracy50: 0.4222 - val_loss: 3.2592 - val_accuracy50: 0.4009 - 8s/epoch - 24ms/step
Epoch 17/50
320/320 - 8s - loss: 3.2139 - accuracy50: 0.4204 - val_loss: 3.2596 - val_accuracy50: 0.4000 - 8s/epoch - 25ms/step
Epoch 18/50
320/320 - 8s - loss: 3.2113 - accuracy50: 0.4226 - val_loss: 3.2603 - val_accuracy50: 0.4045 - 8s/epoch - 25ms/step
Epoch 19/50
320/320 - 8s - loss: 3.2094 - accuracy50: 0.4250 - val_loss: 3.2624 - val_accuracy50: 0.3999 - 8s/epoch - 25ms/step
Epoch 20/50
320/320 - 8s - loss: 3.2064 - accuracy50: 0.4241 - val_loss: 3.2602 - val_accuracy50: 0.3999 - 8s/epoch - 25ms/step
Epoch 21/50
320/320 - 8s - loss: 3.2048 - accuracy50: 0.4251 - val_loss: 3.2612 - val_accuracy50: 0.4007 - 8s/epoch - 25ms/step
Epoch 22/50
320/320 - 8s - loss: 3.2018 - accuracy50: 0.4269 - val_loss: 3.2607 - val_accuracy50: 0.4035 - 8s/epoch - 25ms/step
Epoch 23/50
320/320 - 8s - loss: 3.1984 - accuracy50: 0.4273 - val_loss: 3.2587 - val_accuracy50: 0.4015 - 8s/epoch - 25ms/step
Epoch 24/50
320/320 - 8s - loss: 3.1969 - accuracy50: 0.4275 - val_loss: 3.2631 - val_accuracy50: 0.3972 - 8s/epoch - 25ms/step
Epoch 25/50
320/320 - 8s - loss: 3.1917 - accuracy50: 0.4313 - val_loss: 3.2651 - val_accuracy50: 0.4002 - 8s/epoch - 24ms/step
Epoch 26/50
320/320 - 8s - loss: 3.1896 - accuracy50: 0.4309 - val_loss: 3.2635 - val_accuracy50: 0.4016 - 8s/epoch - 25ms/step
Epoch 27/50
320/320 - 8s - loss: 3.1861 - accuracy50: 0.4329 - val_loss: 3.2643 - val_accuracy50: 0.4007 - 8s/epoch - 25ms/step
Epoch 28/50
320/320 - 8s - loss: 3.1837 - accuracy50: 0.4337 - val_loss: 3.2694 - val_accuracy50: 0.3947 - 8s/epoch - 25ms/step
Epoch 29/50
320/320 - 8s - loss: 3.1798 - accuracy50: 0.4369 - val_loss: 3.2673 - val_accuracy50: 0.3975 - 8s/epoch - 25ms/step
Epoch 30/50
320/320 - 8s - loss: 3.1767 - accuracy50: 0.4368 - val_loss: 3.2679 - val_accuracy50: 0.3936 - 8s/epoch - 25ms/step
Epoch 31/50
320/320 - 8s - loss: 3.1754 - accuracy50: 0.4387 - val_loss: 3.2672 - val_accuracy50: 0.3978 - 8s/epoch - 26ms/step
Epoch 32/50
320/320 - 8s - loss: 3.1702 - accuracy50: 0.4405 - val_loss: 3.2663 - val_accuracy50: 0.3990 - 8s/epoch - 25ms/step
Epoch 33/50
320/320 - 8s - loss: 3.1670 - accuracy50: 0.4408 - val_loss: 3.2735 - val_accuracy50: 0.3948 - 8s/epoch - 26ms/step
testing model: results/CHTR/W2/deepOF_L1/h50
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0825783
{'0': {'precision': 0.3926986749900548, 'recall': 0.5223177945406198, 'f1-score': 0.4483274622259746, 'support': 73708}, '1': {'precision': 0.37742321934219125, 'recall': 0.20425243490945527, 'f1-score': 0.26506047134184235, 'support': 67867}, '2': {'precision': 0.4346749007913213, 'recall': 0.47244908376295236, 'f1-score': 0.4527755017182551, 'support': 78364}, 'accuracy': 0.4064035937237143, 'macro avg': {'precision': 0.4015989317078558, 'recall': 0.39967310440434245, 'f1-score': 0.3887211450953574, 'support': 219939}, 'weighted avg': {'precision': 0.40294117682118474, 'recall': 0.4064035937237143, 'f1-score': 0.3933612456679274, 'support': 219939}}
[[38499 10996 24213]
 [30067 13862 23938]
 [29471 11870 37023]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0696882
{'0': {'precision': 0.4368943011329924, 'recall': 0.5456823234640223, 'f1-score': 0.48526596579319003, 'support': 28337}, '1': {'precision': 0.4301588485345663, 'recall': 0.21690734055354993, 'f1-score': 0.2883927901802455, 'support': 26592}, '2': {'precision': 0.40819367985644334, 'recall': 0.5016821172248804, 'f1-score': 0.4501349968975868, 'support': 26752}, 'accuracy': 0.4242357463792069, 'macro avg': {'precision': 0.4250822765080007, 'recall': 0.42142392708081755, 'f1-score': 0.40793125095700744, 'support': 81681}, 'weighted avg': {'precision': 0.4253015417900903, 'recall': 0.4242357463792069, 'f1-score': 0.40966606905105174, 'support': 81681}}
[[15463  3819  9055]
 [10421  5768 10403]
 [ 9509  3822 13421]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0851624
{'0': {'precision': 0.39753412593571114, 'recall': 0.5223932415229718, 'f1-score': 0.45149029805961194, 'support': 8641}, '1': {'precision': 0.40933816863100636, 'recall': 0.2199756394640682, 'f1-score': 0.2861670099825701, 'support': 8210}, '2': {'precision': 0.39678050902762674, 'recall': 0.4498150431565968, 'f1-score': 0.4216366158113731, 'support': 8110}, 'accuracy': 0.3993429750410641, 'macro avg': {'precision': 0.4012176011981148, 'recall': 0.3973946413812122, 'f1-score': 0.386431307951185, 'support': 24961}, 'weighted avg': {'precision': 0.4011717749643482, 'recall': 0.3993429750410641, 'f1-score': 0.38741363614119, 'support': 24961}}
[[4514 1368 2759]
 [3617 1806 2787]
 [3224 1238 3648]]
training model: results/CHTR/W2/deepOF_L1/h100
Epoch 1/50
320/320 - 10s - loss: 3.3281 - accuracy100: 0.3529 - val_loss: 3.3103 - val_accuracy100: 0.3594 - 10s/epoch - 32ms/step
Epoch 2/50
320/320 - 8s - loss: 3.2977 - accuracy100: 0.3664 - val_loss: 3.2989 - val_accuracy100: 0.3687 - 8s/epoch - 25ms/step
Epoch 3/50
320/320 - 8s - loss: 3.2863 - accuracy100: 0.3731 - val_loss: 3.2924 - val_accuracy100: 0.3677 - 8s/epoch - 25ms/step
Epoch 4/50
320/320 - 8s - loss: 3.2789 - accuracy100: 0.3782 - val_loss: 3.2903 - val_accuracy100: 0.3698 - 8s/epoch - 24ms/step
Epoch 5/50
320/320 - 8s - loss: 3.2733 - accuracy100: 0.3803 - val_loss: 3.2896 - val_accuracy100: 0.3692 - 8s/epoch - 25ms/step
Epoch 6/50
320/320 - 8s - loss: 3.2709 - accuracy100: 0.3818 - val_loss: 3.2897 - val_accuracy100: 0.3711 - 8s/epoch - 25ms/step
Epoch 7/50
320/320 - 8s - loss: 3.2669 - accuracy100: 0.3849 - val_loss: 3.2877 - val_accuracy100: 0.3732 - 8s/epoch - 25ms/step
Epoch 8/50
320/320 - 8s - loss: 3.2640 - accuracy100: 0.3884 - val_loss: 3.2859 - val_accuracy100: 0.3765 - 8s/epoch - 25ms/step
Epoch 9/50
320/320 - 8s - loss: 3.2621 - accuracy100: 0.3893 - val_loss: 3.2848 - val_accuracy100: 0.3759 - 8s/epoch - 24ms/step
Epoch 10/50
320/320 - 8s - loss: 3.2579 - accuracy100: 0.3924 - val_loss: 3.2860 - val_accuracy100: 0.3756 - 8s/epoch - 25ms/step
Epoch 11/50
320/320 - 8s - loss: 3.2569 - accuracy100: 0.3917 - val_loss: 3.2872 - val_accuracy100: 0.3739 - 8s/epoch - 26ms/step
Epoch 12/50
320/320 - 8s - loss: 3.2545 - accuracy100: 0.3922 - val_loss: 3.2882 - val_accuracy100: 0.3723 - 8s/epoch - 24ms/step
Epoch 13/50
320/320 - 8s - loss: 3.2515 - accuracy100: 0.3961 - val_loss: 3.2871 - val_accuracy100: 0.3782 - 8s/epoch - 25ms/step
Epoch 14/50
320/320 - 8s - loss: 3.2497 - accuracy100: 0.3972 - val_loss: 3.2861 - val_accuracy100: 0.3793 - 8s/epoch - 25ms/step
Epoch 15/50
320/320 - 8s - loss: 3.2476 - accuracy100: 0.3971 - val_loss: 3.2832 - val_accuracy100: 0.3810 - 8s/epoch - 25ms/step
Epoch 16/50
320/320 - 8s - loss: 3.2447 - accuracy100: 0.3994 - val_loss: 3.2870 - val_accuracy100: 0.3809 - 8s/epoch - 25ms/step
Epoch 17/50
320/320 - 8s - loss: 3.2447 - accuracy100: 0.3993 - val_loss: 3.2855 - val_accuracy100: 0.3786 - 8s/epoch - 25ms/step
Epoch 18/50
320/320 - 8s - loss: 3.2418 - accuracy100: 0.4013 - val_loss: 3.2861 - val_accuracy100: 0.3808 - 8s/epoch - 25ms/step
Epoch 19/50
320/320 - 8s - loss: 3.2401 - accuracy100: 0.4023 - val_loss: 3.2905 - val_accuracy100: 0.3742 - 8s/epoch - 25ms/step
Epoch 20/50
320/320 - 8s - loss: 3.2398 - accuracy100: 0.4036 - val_loss: 3.2931 - val_accuracy100: 0.3741 - 8s/epoch - 24ms/step
Epoch 21/50
320/320 - 8s - loss: 3.2361 - accuracy100: 0.4053 - val_loss: 3.2904 - val_accuracy100: 0.3788 - 8s/epoch - 25ms/step
Epoch 22/50
320/320 - 8s - loss: 3.2343 - accuracy100: 0.4069 - val_loss: 3.2911 - val_accuracy100: 0.3745 - 8s/epoch - 25ms/step
Epoch 23/50
320/320 - 8s - loss: 3.2310 - accuracy100: 0.4054 - val_loss: 3.2889 - val_accuracy100: 0.3803 - 8s/epoch - 24ms/step
Epoch 24/50
320/320 - 8s - loss: 3.2311 - accuracy100: 0.4087 - val_loss: 3.2888 - val_accuracy100: 0.3800 - 8s/epoch - 24ms/step
Epoch 25/50
320/320 - 8s - loss: 3.2270 - accuracy100: 0.4096 - val_loss: 3.2898 - val_accuracy100: 0.3782 - 8s/epoch - 25ms/step
testing model: results/CHTR/W2/deepOF_L1/h100
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.088157
{'0': {'precision': 0.3676460158161637, 'recall': 0.5652037617554859, 'f1-score': 0.4455056240129777, 'support': 73370}, '1': {'precision': 0.34234448339373774, 'recall': 0.08820377797507883, 'f1-score': 0.14026802341857664, 'support': 65326}, '2': {'precision': 0.42754008326689696, 'recall': 0.47526556134066933, 'f1-score': 0.4501413540846958, 'support': 81243}, 'accuracy': 0.3903036751099168, 'macro avg': {'precision': 0.3791768608255994, 'recall': 0.3762243670237447, 'f1-score': 0.34530500050541674, 'support': 219939}, 'weighted avg': {'precision': 0.3822551838803657, 'recall': 0.3903036751099168, 'f1-score': 0.3565567296458429, 'support': 219939}}
[[41469  5340 26561]
 [34425  5762 25139]
 [36902  5729 38612]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.085389
{'0': {'precision': 0.39535468302247245, 'recall': 0.5658164550131309, 'f1-score': 0.4654700424688143, 'support': 27797}, '1': {'precision': 0.4241114313160423, 'recall': 0.09881378692927484, 'f1-score': 0.16028317298965328, 'support': 26808}, '2': {'precision': 0.3837264746304659, 'recall': 0.5052814300487517, 'f1-score': 0.43619378596821246, 'support': 27076}, 'accuracy': 0.39247805487200205, 'macro avg': {'precision': 0.4010641963229935, 'recall': 0.38997055733038577, 'f1-score': 0.3539823338088934, 'support': 81681}, 'weighted avg': {'precision': 0.4009381790354014, 'recall': 0.39247805487200205, 'f1-score': 0.35560197623544737, 'support': 81681}}
[[15728  1778 10291]
 [12478  2649 11681]
 [11576  1819 13681]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0950187
{'0': {'precision': 0.36614507053110307, 'recall': 0.5611340815121086, 'f1-score': 0.44313835245825167, 'support': 8465}, '1': {'precision': 0.38461538461538464, 'recall': 0.09002939735423812, 'f1-score': 0.1459057071960298, 'support': 8164}, '2': {'precision': 0.3831497469484966, 'recall': 0.46339414306289006, 'f1-score': 0.4194687381172253, 'support': 8332}, 'accuracy': 0.37442410159849365, 'macro avg': {'precision': 0.3779700673649948, 'recall': 0.3715192073097456, 'f1-score': 0.33617093259050224, 'support': 24961}, 'weighted avg': {'precision': 0.37786233378553186, 'recall': 0.37442410159849365, 'f1-score': 0.3380214684147353, 'support': 24961}}
[[4750  637 3078]
 [4291  735 3138]
 [3932  539 3861]]
training model: results/CHTR/W2/deepOF_L1/h200
Epoch 1/50
320/320 - 9s - loss: 3.3374 - accuracy200: 0.3469 - val_loss: 3.3180 - val_accuracy200: 0.3495 - 9s/epoch - 29ms/step
Epoch 2/50
320/320 - 8s - loss: 3.3082 - accuracy200: 0.3568 - val_loss: 3.3043 - val_accuracy200: 0.3598 - 8s/epoch - 25ms/step
Epoch 3/50
320/320 - 8s - loss: 3.2976 - accuracy200: 0.3641 - val_loss: 3.3011 - val_accuracy200: 0.3579 - 8s/epoch - 25ms/step
Epoch 4/50
320/320 - 8s - loss: 3.2882 - accuracy200: 0.3666 - val_loss: 3.3041 - val_accuracy200: 0.3570 - 8s/epoch - 24ms/step
Epoch 5/50
320/320 - 8s - loss: 3.2858 - accuracy200: 0.3698 - val_loss: 3.3035 - val_accuracy200: 0.3542 - 8s/epoch - 25ms/step
Epoch 6/50
320/320 - 8s - loss: 3.2836 - accuracy200: 0.3706 - val_loss: 3.3041 - val_accuracy200: 0.3552 - 8s/epoch - 24ms/step
Epoch 7/50
320/320 - 8s - loss: 3.2797 - accuracy200: 0.3750 - val_loss: 3.3000 - val_accuracy200: 0.3598 - 8s/epoch - 24ms/step
Epoch 8/50
320/320 - 8s - loss: 3.2783 - accuracy200: 0.3719 - val_loss: 3.3004 - val_accuracy200: 0.3617 - 8s/epoch - 25ms/step
Epoch 9/50
320/320 - 8s - loss: 3.2755 - accuracy200: 0.3748 - val_loss: 3.3023 - val_accuracy200: 0.3568 - 8s/epoch - 25ms/step
Epoch 10/50
320/320 - 8s - loss: 3.2731 - accuracy200: 0.3814 - val_loss: 3.3005 - val_accuracy200: 0.3567 - 8s/epoch - 25ms/step
Epoch 11/50
320/320 - 8s - loss: 3.2708 - accuracy200: 0.3812 - val_loss: 3.2986 - val_accuracy200: 0.3587 - 8s/epoch - 25ms/step
Epoch 12/50
320/320 - 8s - loss: 3.2696 - accuracy200: 0.3816 - val_loss: 3.2958 - val_accuracy200: 0.3599 - 8s/epoch - 24ms/step
Epoch 13/50
320/320 - 8s - loss: 3.2692 - accuracy200: 0.3815 - val_loss: 3.2971 - val_accuracy200: 0.3573 - 8s/epoch - 25ms/step
Epoch 14/50
320/320 - 8s - loss: 3.2671 - accuracy200: 0.3846 - val_loss: 3.2979 - val_accuracy200: 0.3553 - 8s/epoch - 24ms/step
Epoch 15/50
320/320 - 8s - loss: 3.2660 - accuracy200: 0.3840 - val_loss: 3.2983 - val_accuracy200: 0.3578 - 8s/epoch - 24ms/step
Epoch 16/50
320/320 - 8s - loss: 3.2622 - accuracy200: 0.3877 - val_loss: 3.2978 - val_accuracy200: 0.3592 - 8s/epoch - 25ms/step
Epoch 17/50
320/320 - 8s - loss: 3.2611 - accuracy200: 0.3881 - val_loss: 3.2991 - val_accuracy200: 0.3614 - 8s/epoch - 24ms/step
Epoch 18/50
320/320 - 8s - loss: 3.2606 - accuracy200: 0.3878 - val_loss: 3.2984 - val_accuracy200: 0.3574 - 8s/epoch - 24ms/step
Epoch 19/50
320/320 - 8s - loss: 3.2566 - accuracy200: 0.3921 - val_loss: 3.3007 - val_accuracy200: 0.3567 - 8s/epoch - 24ms/step
Epoch 20/50
320/320 - 8s - loss: 3.2558 - accuracy200: 0.3902 - val_loss: 3.3005 - val_accuracy200: 0.3559 - 8s/epoch - 24ms/step
Epoch 21/50
320/320 - 8s - loss: 3.2549 - accuracy200: 0.3920 - val_loss: 3.3008 - val_accuracy200: 0.3572 - 8s/epoch - 24ms/step
Epoch 22/50
320/320 - 8s - loss: 3.2526 - accuracy200: 0.3943 - val_loss: 3.3007 - val_accuracy200: 0.3561 - 8s/epoch - 25ms/step
testing model: results/CHTR/W2/deepOF_L1/h200
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0911239
{'0': {'precision': 0.3541542024510277, 'recall': 0.507866878848682, 'f1-score': 0.41730577901589017, 'support': 72265}, '1': {'precision': 0.31031795511221943, 'recall': 0.031377555040738817, 'f1-score': 0.05699237143797679, 'support': 63453}, '2': {'precision': 0.41112718735497256, 'recall': 0.5364457795561677, 'f1-score': 0.465499654842, 'support': 84221}, 'accuracy': 0.38134209940028824, 'macro avg': {'precision': 0.35853311497273993, 'recall': 0.35856340448186286, 'f1-score': 0.31326593509862233, 'support': 219939}, 'weighted avg': {'precision': 0.36332392841688976, 'recall': 0.38134209940028824, 'f1-score': 0.33180920844363815, 'support': 219939}}
[[36701  1964 33600]
 [30349  1991 31113]
 [36580  2461 45180]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0932083
{'0': {'precision': 0.3751086756066075, 'recall': 0.522399559713814, 'f1-score': 0.4366680978960928, 'support': 27255}, '1': {'precision': 0.4114219114219114, 'recall': 0.03895673925838729, 'f1-score': 0.07117413804691175, 'support': 27184}, '2': {'precision': 0.36626974483596597, 'recall': 0.55326334336686, 'f1-score': 0.4407533044800562, 'support': 27242}, 'accuracy': 0.37180005141954675, 'macro avg': {'precision': 0.3842667772881616, 'recall': 0.3715398807796871, 'f1-score': 0.3161985134743536, 'support': 81681}, 'weighted avg': {'precision': 0.3842460374208532, 'recall': 0.37180005141954675, 'f1-score': 0.3163916736752849, 'support': 81681}}
[[14238   765 12252]
 [12299  1059 13826]
 [11420   750 15072]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.098949
{'0': {'precision': 0.3592382495948136, 'recall': 0.5241811517086438, 'f1-score': 0.42631148723373563, 'support': 8457}, '1': {'precision': 0.27180232558139533, 'recall': 0.023083569929638316, 'f1-score': 0.042553191489361694, 'support': 8101}, '2': {'precision': 0.3610156708287941, 'recall': 0.5126740449839343, 'f1-score': 0.42368214004720695, 'support': 8403}, 'accuracy': 0.3576779776451264, 'macro avg': {'precision': 0.330685415335001, 'recall': 0.35331292220740546, 'f1-score': 0.2975156062567681, 'support': 24961}, 'weighted avg': {'precision': 0.3314596049169736, 'recall': 0.3576779776451264, 'f1-score': 0.30087899822153363, 'support': 24961}}
[[4433  242 3782]
 [4071  187 3843]
 [3836  259 4308]]
training model: results/CHTR/W2/deepOF_L1/h300
Epoch 1/50
320/320 - 10s - loss: 3.3433 - accuracy300: 0.3414 - val_loss: 3.3099 - val_accuracy300: 0.3490 - 10s/epoch - 30ms/step
Epoch 2/50
320/320 - 8s - loss: 3.3158 - accuracy300: 0.3495 - val_loss: 3.3038 - val_accuracy300: 0.3542 - 8s/epoch - 24ms/step
Epoch 3/50
320/320 - 8s - loss: 3.3051 - accuracy300: 0.3531 - val_loss: 3.2995 - val_accuracy300: 0.3558 - 8s/epoch - 24ms/step
Epoch 4/50
320/320 - 8s - loss: 3.2984 - accuracy300: 0.3586 - val_loss: 3.2993 - val_accuracy300: 0.3568 - 8s/epoch - 25ms/step
Epoch 5/50
320/320 - 8s - loss: 3.2958 - accuracy300: 0.3573 - val_loss: 3.2978 - val_accuracy300: 0.3574 - 8s/epoch - 25ms/step
Epoch 6/50
320/320 - 8s - loss: 3.2926 - accuracy300: 0.3598 - val_loss: 3.2972 - val_accuracy300: 0.3539 - 8s/epoch - 26ms/step
Epoch 7/50
320/320 - 8s - loss: 3.2882 - accuracy300: 0.3642 - val_loss: 3.2960 - val_accuracy300: 0.3606 - 8s/epoch - 25ms/step
Epoch 8/50
320/320 - 8s - loss: 3.2877 - accuracy300: 0.3638 - val_loss: 3.2919 - val_accuracy300: 0.3622 - 8s/epoch - 25ms/step
Epoch 9/50
320/320 - 8s - loss: 3.2843 - accuracy300: 0.3673 - val_loss: 3.2929 - val_accuracy300: 0.3607 - 8s/epoch - 25ms/step
Epoch 10/50
320/320 - 8s - loss: 3.2831 - accuracy300: 0.3689 - val_loss: 3.2951 - val_accuracy300: 0.3566 - 8s/epoch - 25ms/step
Epoch 11/50
320/320 - 8s - loss: 3.2804 - accuracy300: 0.3701 - val_loss: 3.2940 - val_accuracy300: 0.3622 - 8s/epoch - 25ms/step
Epoch 12/50
320/320 - 8s - loss: 3.2794 - accuracy300: 0.3710 - val_loss: 3.2931 - val_accuracy300: 0.3600 - 8s/epoch - 24ms/step
Epoch 13/50
320/320 - 8s - loss: 3.2785 - accuracy300: 0.3726 - val_loss: 3.2949 - val_accuracy300: 0.3577 - 8s/epoch - 24ms/step
Epoch 14/50
320/320 - 8s - loss: 3.2779 - accuracy300: 0.3714 - val_loss: 3.2939 - val_accuracy300: 0.3569 - 8s/epoch - 25ms/step
Epoch 15/50
320/320 - 8s - loss: 3.2757 - accuracy300: 0.3740 - val_loss: 3.2916 - val_accuracy300: 0.3589 - 8s/epoch - 24ms/step
Epoch 16/50
320/320 - 8s - loss: 3.2729 - accuracy300: 0.3758 - val_loss: 3.2931 - val_accuracy300: 0.3615 - 8s/epoch - 24ms/step
Epoch 17/50
320/320 - 8s - loss: 3.2710 - accuracy300: 0.3779 - val_loss: 3.2924 - val_accuracy300: 0.3618 - 8s/epoch - 24ms/step
Epoch 18/50
320/320 - 8s - loss: 3.2699 - accuracy300: 0.3797 - val_loss: 3.2946 - val_accuracy300: 0.3610 - 8s/epoch - 24ms/step
Epoch 19/50
320/320 - 8s - loss: 3.2671 - accuracy300: 0.3813 - val_loss: 3.2962 - val_accuracy300: 0.3599 - 8s/epoch - 24ms/step
Epoch 20/50
320/320 - 8s - loss: 3.2682 - accuracy300: 0.3813 - val_loss: 3.2939 - val_accuracy300: 0.3586 - 8s/epoch - 24ms/step
Epoch 21/50
320/320 - 8s - loss: 3.2659 - accuracy300: 0.3827 - val_loss: 3.2953 - val_accuracy300: 0.3566 - 8s/epoch - 24ms/step
Epoch 22/50
320/320 - 8s - loss: 3.2635 - accuracy300: 0.3842 - val_loss: 3.2956 - val_accuracy300: 0.3606 - 8s/epoch - 25ms/step
Epoch 23/50
320/320 - 8s - loss: 3.2633 - accuracy300: 0.3843 - val_loss: 3.2958 - val_accuracy300: 0.3607 - 8s/epoch - 24ms/step
Epoch 24/50
320/320 - 8s - loss: 3.2604 - accuracy300: 0.3841 - val_loss: 3.2968 - val_accuracy300: 0.3597 - 8s/epoch - 24ms/step
Epoch 25/50
320/320 - 8s - loss: 3.2578 - accuracy300: 0.3885 - val_loss: 3.2991 - val_accuracy300: 0.3600 - 8s/epoch - 24ms/step
testing model: results/CHTR/W2/deepOF_L1/h300
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0920045
{'0': {'precision': 0.3485044743013402, 'recall': 0.5650574460199586, 'f1-score': 0.4311148347908048, 'support': 72851}, '1': {'precision': 0.29665924276169264, 'recall': 0.033497074454708536, 'f1-score': 0.060197041366635534, 'support': 59647}, '2': {'precision': 0.42042383130882893, 'recall': 0.4571768392401734, 'f1-score': 0.43803074630463606, 'support': 87441}, 'accuracy': 0.3780093571399343, 'macro avg': {'precision': 0.35519584945728727, 'recall': 0.35191045323828013, 'f1-score': 0.3097808741540255, 'support': 219939}, 'weighted avg': {'precision': 0.36303708548192415, 'recall': 0.3780093571399343, 'f1-score': 0.33327225386750103, 'support': 219939}}
[[41165  2149 29537]
 [32077  1998 25572]
 [44877  2588 39976]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0933235
{'0': {'precision': 0.36480154355016536, 'recall': 0.5783685360524399, 'f1-score': 0.4474054876331061, 'support': 27460}, '1': {'precision': 0.39855334538878845, 'recall': 0.04092698507019238, 'f1-score': 0.0742312485264895, 'support': 26926}, '2': {'precision': 0.3700395703787451, 'recall': 0.4796482872320938, 'f1-score': 0.4177742321499801, 'support': 27295}, 'accuracy': 0.3682129258946389, 'macro avg': {'precision': 0.37779815310589965, 'recall': 0.3663146027849087, 'f1-score': 0.31313698943652524, 'support': 81681}, 'weighted avg': {'precision': 0.3776781361309718, 'recall': 0.3682129258946389, 'f1-score': 0.31448749347783517, 'support': 81681}}
[[15882   806 10772]
 [14308  1102 11516]
 [13346   857 13092]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0972676
{'0': {'precision': 0.36090488863986553, 'recall': 0.5940742448697256, 'f1-score': 0.4490240501917044, 'support': 8674}, '1': {'precision': 0.3059895833333333, 'recall': 0.030085776469082063, 'f1-score': 0.05478493996969344, 'support': 7811}, '2': {'precision': 0.3637922339889057, 'recall': 0.4255545068428504, 'f1-score': 0.392257082268501, 'support': 8476}, 'accuracy': 0.3603621649773647, 'macro avg': {'precision': 0.3435622353207015, 'recall': 0.34990484272721933, 'f1-score': 0.29868869080996624, 'support': 24961}, 'weighted avg': {'precision': 0.34470079783537616, 'recall': 0.3603621649773647, 'f1-score': 0.3063791837976817, 'support': 24961}}
[[5153  267 3254]
 [4522  235 3054]
 [4603  266 3607]]
training model: results/CHTR/W2/deepOF_L1/h500
Epoch 1/50
320/320 - 9s - loss: 3.3457 - accuracy500: 0.3415 - val_loss: 3.3081 - val_accuracy500: 0.3558 - 9s/epoch - 30ms/step
Epoch 2/50
320/320 - 8s - loss: 3.3174 - accuracy500: 0.3497 - val_loss: 3.3005 - val_accuracy500: 0.3607 - 8s/epoch - 24ms/step
Epoch 3/50
320/320 - 8s - loss: 3.3067 - accuracy500: 0.3529 - val_loss: 3.2961 - val_accuracy500: 0.3597 - 8s/epoch - 25ms/step
Epoch 4/50
320/320 - 8s - loss: 3.3000 - accuracy500: 0.3572 - val_loss: 3.2928 - val_accuracy500: 0.3585 - 8s/epoch - 25ms/step
Epoch 5/50
320/320 - 8s - loss: 3.2977 - accuracy500: 0.3559 - val_loss: 3.2944 - val_accuracy500: 0.3653 - 8s/epoch - 25ms/step
Epoch 6/50
320/320 - 8s - loss: 3.2948 - accuracy500: 0.3590 - val_loss: 3.2931 - val_accuracy500: 0.3622 - 8s/epoch - 25ms/step
Epoch 7/50
320/320 - 8s - loss: 3.2911 - accuracy500: 0.3601 - val_loss: 3.2900 - val_accuracy500: 0.3657 - 8s/epoch - 25ms/step
Epoch 8/50
320/320 - 8s - loss: 3.2895 - accuracy500: 0.3630 - val_loss: 3.2885 - val_accuracy500: 0.3649 - 8s/epoch - 25ms/step
Epoch 9/50
320/320 - 8s - loss: 3.2871 - accuracy500: 0.3633 - val_loss: 3.2901 - val_accuracy500: 0.3673 - 8s/epoch - 24ms/step
Epoch 10/50
320/320 - 8s - loss: 3.2853 - accuracy500: 0.3645 - val_loss: 3.2900 - val_accuracy500: 0.3612 - 8s/epoch - 24ms/step
Epoch 11/50
320/320 - 8s - loss: 3.2835 - accuracy500: 0.3674 - val_loss: 3.2917 - val_accuracy500: 0.3603 - 8s/epoch - 25ms/step
Epoch 12/50
320/320 - 8s - loss: 3.2831 - accuracy500: 0.3671 - val_loss: 3.2898 - val_accuracy500: 0.3655 - 8s/epoch - 24ms/step
Epoch 13/50
320/320 - 8s - loss: 3.2811 - accuracy500: 0.3694 - val_loss: 3.2914 - val_accuracy500: 0.3639 - 8s/epoch - 24ms/step
Epoch 14/50
320/320 - 8s - loss: 3.2798 - accuracy500: 0.3694 - val_loss: 3.2881 - val_accuracy500: 0.3671 - 8s/epoch - 25ms/step
Epoch 15/50
320/320 - 8s - loss: 3.2777 - accuracy500: 0.3723 - val_loss: 3.2900 - val_accuracy500: 0.3672 - 8s/epoch - 24ms/step
Epoch 16/50
320/320 - 8s - loss: 3.2764 - accuracy500: 0.3738 - val_loss: 3.2919 - val_accuracy500: 0.3613 - 8s/epoch - 24ms/step
Epoch 17/50
320/320 - 8s - loss: 3.2749 - accuracy500: 0.3739 - val_loss: 3.2903 - val_accuracy500: 0.3661 - 8s/epoch - 24ms/step
Epoch 18/50
320/320 - 8s - loss: 3.2736 - accuracy500: 0.3735 - val_loss: 3.2912 - val_accuracy500: 0.3650 - 8s/epoch - 25ms/step
Epoch 19/50
320/320 - 8s - loss: 3.2716 - accuracy500: 0.3761 - val_loss: 3.2917 - val_accuracy500: 0.3627 - 8s/epoch - 25ms/step
Epoch 20/50
320/320 - 8s - loss: 3.2715 - accuracy500: 0.3783 - val_loss: 3.2935 - val_accuracy500: 0.3612 - 8s/epoch - 24ms/step
Epoch 21/50
320/320 - 8s - loss: 3.2682 - accuracy500: 0.3809 - val_loss: 3.2933 - val_accuracy500: 0.3618 - 8s/epoch - 25ms/step
Epoch 22/50
320/320 - 8s - loss: 3.2676 - accuracy500: 0.3793 - val_loss: 3.2943 - val_accuracy500: 0.3612 - 8s/epoch - 24ms/step
Epoch 23/50
320/320 - 8s - loss: 3.2657 - accuracy500: 0.3821 - val_loss: 3.2950 - val_accuracy500: 0.3617 - 8s/epoch - 25ms/step
Epoch 24/50
320/320 - 8s - loss: 3.2627 - accuracy500: 0.3833 - val_loss: 3.2977 - val_accuracy500: 0.3618 - 8s/epoch - 24ms/step
testing model: results/CHTR/W2/deepOF_L1/h500
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0929258
{'0': {'precision': 0.336314549381504, 'recall': 0.4807460214993404, 'f1-score': 0.3957647385020622, 'support': 71258}, '1': {'precision': 0.27726557229592985, 'recall': 0.020310003459124676, 'f1-score': 0.03784762723310209, 'support': 60709}, '2': {'precision': 0.4111869895803999, 'recall': 0.5311235393079616, 'f1-score': 0.4635225491557707, 'support': 87972}, 'accuracy': 0.3738036455562679, 'macro avg': {'precision': 0.3415890370859446, 'recall': 0.34405985475547557, 'f1-score': 0.29904497163031163, 'support': 219939}, 'weighted avg': {'precision': 0.3499632154174919, 'recall': 0.3738036455562679, 'f1-score': 0.3240721337834845, 'support': 219939}}
[[34257  1329 35672]
 [28240  1233 31236]
 [39363  1885 46724]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0954372
{'0': {'precision': 0.3603792071604481, 'recall': 0.4981150031111599, 'f1-score': 0.41819802101899084, 'support': 27321}, '1': {'precision': 0.4011770475723394, 'recall': 0.03033674529001632, 'f1-score': 0.056407957797469224, 'support': 26964}, '2': {'precision': 0.3625444733637384, 'recall': 0.5542049934296978, 'f1-score': 0.4383399494767232, 'support': 27396}, 'accuracy': 0.3625078047526353, 'macro avg': {'precision': 0.37470024269884195, 'recall': 0.36088558061029136, 'f1-score': 0.3043153094310611, 'support': 81681}, 'weighted avg': {'precision': 0.374573360045104, 'recall': 0.3625078047526353, 'f1-score': 0.3055218907968208, 'support': 81681}}
[[13609   637 13075]
 [12525   818 13621]
 [11629   584 15183]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0967245
{'0': {'precision': 0.36487261407389204, 'recall': 0.5095526827594097, 'f1-score': 0.425243459996181, 'support': 8741}, '1': {'precision': 0.2741020793950851, 'recall': 0.019416175682913765, 'f1-score': 0.03626359884956859, 'support': 7468}, '2': {'precision': 0.36441717791411044, 'recall': 0.509026508226691, 'f1-score': 0.42475091767173573, 'support': 8752}, 'accuracy': 0.3627258523296342, 'macro avg': {'precision': 0.3344639571276959, 'recall': 0.3459984555563382, 'f1-score': 0.29541932550582845, 'support': 24961}, 'weighted avg': {'precision': 0.337555586300496, 'recall': 0.3627258523296342, 'f1-score': 0.30869314817107596, 'support': 24961}}
[[4454  189 4098]
 [3651  145 3672]
 [4102  195 4455]]
training model: results/CHTR/W2/deepOF_L1/h1000
Epoch 1/50
320/320 - 10s - loss: 3.3467 - accuracy1000: 0.3444 - val_loss: 3.3155 - val_accuracy1000: 0.3458 - 10s/epoch - 31ms/step
Epoch 2/50
320/320 - 8s - loss: 3.3189 - accuracy1000: 0.3524 - val_loss: 3.3045 - val_accuracy1000: 0.3474 - 8s/epoch - 25ms/step
Epoch 3/50
320/320 - 8s - loss: 3.3094 - accuracy1000: 0.3537 - val_loss: 3.3000 - val_accuracy1000: 0.3489 - 8s/epoch - 24ms/step
Epoch 4/50
320/320 - 8s - loss: 3.3023 - accuracy1000: 0.3571 - val_loss: 3.2973 - val_accuracy1000: 0.3526 - 8s/epoch - 25ms/step
Epoch 5/50
320/320 - 8s - loss: 3.2984 - accuracy1000: 0.3574 - val_loss: 3.2952 - val_accuracy1000: 0.3544 - 8s/epoch - 24ms/step
Epoch 6/50
320/320 - 8s - loss: 3.2968 - accuracy1000: 0.3578 - val_loss: 3.2953 - val_accuracy1000: 0.3507 - 8s/epoch - 24ms/step
Epoch 7/50
320/320 - 8s - loss: 3.2936 - accuracy1000: 0.3579 - val_loss: 3.2949 - val_accuracy1000: 0.3521 - 8s/epoch - 25ms/step
Epoch 8/50
320/320 - 8s - loss: 3.2927 - accuracy1000: 0.3565 - val_loss: 3.2953 - val_accuracy1000: 0.3523 - 8s/epoch - 24ms/step
Epoch 9/50
320/320 - 8s - loss: 3.2913 - accuracy1000: 0.3571 - val_loss: 3.2956 - val_accuracy1000: 0.3516 - 8s/epoch - 24ms/step
Epoch 10/50
320/320 - 8s - loss: 3.2884 - accuracy1000: 0.3590 - val_loss: 3.2941 - val_accuracy1000: 0.3516 - 8s/epoch - 24ms/step
Epoch 11/50
320/320 - 8s - loss: 3.2865 - accuracy1000: 0.3612 - val_loss: 3.2946 - val_accuracy1000: 0.3484 - 8s/epoch - 25ms/step
Epoch 12/50
320/320 - 8s - loss: 3.2872 - accuracy1000: 0.3615 - val_loss: 3.2959 - val_accuracy1000: 0.3515 - 8s/epoch - 25ms/step
Epoch 13/50
320/320 - 8s - loss: 3.2849 - accuracy1000: 0.3610 - val_loss: 3.2953 - val_accuracy1000: 0.3466 - 8s/epoch - 25ms/step
Epoch 14/50
320/320 - 8s - loss: 3.2832 - accuracy1000: 0.3637 - val_loss: 3.2973 - val_accuracy1000: 0.3488 - 8s/epoch - 25ms/step
Epoch 15/50
320/320 - 8s - loss: 3.2829 - accuracy1000: 0.3626 - val_loss: 3.2979 - val_accuracy1000: 0.3486 - 8s/epoch - 26ms/step
Epoch 16/50
320/320 - 8s - loss: 3.2806 - accuracy1000: 0.3644 - val_loss: 3.2972 - val_accuracy1000: 0.3475 - 8s/epoch - 25ms/step
Epoch 17/50
320/320 - 8s - loss: 3.2785 - accuracy1000: 0.3668 - val_loss: 3.2980 - val_accuracy1000: 0.3489 - 8s/epoch - 25ms/step
Epoch 18/50
320/320 - 8s - loss: 3.2773 - accuracy1000: 0.3695 - val_loss: 3.2995 - val_accuracy1000: 0.3481 - 8s/epoch - 24ms/step
Epoch 19/50
320/320 - 8s - loss: 3.2757 - accuracy1000: 0.3705 - val_loss: 3.3003 - val_accuracy1000: 0.3467 - 8s/epoch - 24ms/step
Epoch 20/50
320/320 - 8s - loss: 3.2753 - accuracy1000: 0.3687 - val_loss: 3.3006 - val_accuracy1000: 0.3443 - 8s/epoch - 24ms/step
testing model: results/CHTR/W2/deepOF_L1/h1000
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0959207
{'0': {'precision': 0.3193165171673389, 'recall': 0.4661979052222955, 'f1-score': 0.37902471848556846, 'support': 68265}, '1': {'precision': 0.27764552116883723, 'recall': 0.09853718337392112, 'f1-score': 0.14545276697723328, 'support': 60363}, '2': {'precision': 0.4224886191198786, 'recall': 0.4573709629726977, 'f1-score': 0.4392383296259485, 'support': 91311}, 'accuracy': 0.3616275421821505, 'macro avg': {'precision': 0.3398168858186849, 'recall': 0.34070201718963805, 'f1-score': 0.3212386050295834, 'support': 219939}, 'weighted avg': {'precision': 0.3507132293008432, 'recall': 0.3616275421821505, 'f1-score': 0.3399186997164625, 'support': 219939}}
[[31825  6345 30095]
 [27423  5948 26992]
 [40418  9130 41763]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0960052
{'0': {'precision': 0.3599581347949431, 'recall': 0.46995576971484054, 'f1-score': 0.4076673529228274, 'support': 27809}, '1': {'precision': 0.3662886711438952, 'recall': 0.12335014088684562, 'f1-score': 0.18455137983636113, 'support': 26972}, '2': {'precision': 0.34937036730869914, 'recall': 0.4713382899628253, 'f1-score': 0.4012913231314586, 'support': 26900}, 'accuracy': 0.35595793391363967, 'macro avg': {'precision': 0.35853905774917916, 'recall': 0.35488140018817044, 'f1-score': 0.3311700186302157, 'support': 81681}, 'weighted avg': {'precision': 0.35856168128707677, 'recall': 0.35595793391363967, 'f1-score': 0.3318920902855435, 'support': 81681}}
[[13069  3021 11719]
 [11752  3327 11893]
 [11486  2735 12679]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990744
{'0': {'precision': 0.3651196212697608, 'recall': 0.4821388702835454, 'f1-score': 0.41554817915043063, 'support': 8958}, '1': {'precision': 0.30096308186195825, 'recall': 0.09989344698987747, 'f1-score': 0.15000000000000002, 'support': 7508}, '2': {'precision': 0.3468984962406015, 'recall': 0.4344908769864626, 'f1-score': 0.3857852103475307, 'support': 8495}, 'accuracy': 0.35094747806578264, 'macro avg': {'precision': 0.3376603997907735, 'recall': 0.3388410647532951, 'f1-score': 0.3171111298326538, 'support': 24961}, 'weighted avg': {'precision': 0.3396208129288894, 'recall': 0.35094747806578264, 'f1-score': 0.3255448880546385, 'support': 24961}}
[[4319  892 3747]
 [3556  750 3202]
 [3954  850 3691]]
training model: results/CHTR/W2/deepLOB_L2/h10
Epoch 1/50
320/320 - 18s - loss: 3.3525 - accuracy10: 0.3379 - val_loss: 3.3647 - val_accuracy10: 0.3441 - 18s/epoch - 57ms/step
Epoch 2/50
320/320 - 16s - loss: 3.3112 - accuracy10: 0.3538 - val_loss: 3.3167 - val_accuracy10: 0.3620 - 16s/epoch - 49ms/step
Epoch 3/50
320/320 - 16s - loss: 3.2899 - accuracy10: 0.3639 - val_loss: 3.3022 - val_accuracy10: 0.3654 - 16s/epoch - 49ms/step
Epoch 4/50
320/320 - 15s - loss: 3.2688 - accuracy10: 0.3770 - val_loss: 3.2907 - val_accuracy10: 0.3779 - 15s/epoch - 48ms/step
Epoch 5/50
320/320 - 15s - loss: 3.2539 - accuracy10: 0.3899 - val_loss: 3.2860 - val_accuracy10: 0.3828 - 15s/epoch - 48ms/step
Epoch 6/50
320/320 - 15s - loss: 3.2402 - accuracy10: 0.3989 - val_loss: 3.2903 - val_accuracy10: 0.3854 - 15s/epoch - 48ms/step
Epoch 7/50
320/320 - 16s - loss: 3.2330 - accuracy10: 0.4048 - val_loss: 3.2765 - val_accuracy10: 0.3933 - 16s/epoch - 49ms/step
Epoch 8/50
320/320 - 16s - loss: 3.2203 - accuracy10: 0.4145 - val_loss: 3.2807 - val_accuracy10: 0.3962 - 16s/epoch - 49ms/step
Epoch 9/50
320/320 - 16s - loss: 3.2095 - accuracy10: 0.4189 - val_loss: 3.2862 - val_accuracy10: 0.4001 - 16s/epoch - 49ms/step
Epoch 10/50
320/320 - 16s - loss: 3.1949 - accuracy10: 0.4270 - val_loss: 3.2801 - val_accuracy10: 0.4011 - 16s/epoch - 49ms/step
Epoch 11/50
320/320 - 16s - loss: 3.1881 - accuracy10: 0.4300 - val_loss: 3.2791 - val_accuracy10: 0.4035 - 16s/epoch - 49ms/step
Epoch 12/50
320/320 - 15s - loss: 3.1791 - accuracy10: 0.4352 - val_loss: 3.2790 - val_accuracy10: 0.4015 - 15s/epoch - 48ms/step
Epoch 13/50
320/320 - 16s - loss: 3.1699 - accuracy10: 0.4384 - val_loss: 3.2599 - val_accuracy10: 0.4078 - 16s/epoch - 49ms/step
Epoch 14/50
320/320 - 16s - loss: 3.1603 - accuracy10: 0.4430 - val_loss: 3.2601 - val_accuracy10: 0.4066 - 16s/epoch - 49ms/step
Epoch 15/50
320/320 - 16s - loss: 3.1504 - accuracy10: 0.4474 - val_loss: 3.2614 - val_accuracy10: 0.4086 - 16s/epoch - 49ms/step
Epoch 16/50
320/320 - 16s - loss: 3.1431 - accuracy10: 0.4485 - val_loss: 3.2546 - val_accuracy10: 0.4110 - 16s/epoch - 49ms/step
Epoch 17/50
320/320 - 16s - loss: 3.1327 - accuracy10: 0.4557 - val_loss: 3.2716 - val_accuracy10: 0.4058 - 16s/epoch - 49ms/step
Epoch 18/50
320/320 - 16s - loss: 3.1233 - accuracy10: 0.4573 - val_loss: 3.2626 - val_accuracy10: 0.4077 - 16s/epoch - 48ms/step
Epoch 19/50
320/320 - 15s - loss: 3.1188 - accuracy10: 0.4591 - val_loss: 3.2668 - val_accuracy10: 0.4069 - 15s/epoch - 48ms/step
Epoch 20/50
320/320 - 16s - loss: 3.1068 - accuracy10: 0.4631 - val_loss: 3.2770 - val_accuracy10: 0.4068 - 16s/epoch - 49ms/step
Epoch 21/50
320/320 - 15s - loss: 3.0996 - accuracy10: 0.4666 - val_loss: 3.2759 - val_accuracy10: 0.4087 - 15s/epoch - 48ms/step
Epoch 22/50
320/320 - 15s - loss: 3.0912 - accuracy10: 0.4699 - val_loss: 3.2735 - val_accuracy10: 0.4040 - 15s/epoch - 48ms/step
Epoch 23/50
320/320 - 15s - loss: 3.0785 - accuracy10: 0.4733 - val_loss: 3.2875 - val_accuracy10: 0.4047 - 15s/epoch - 48ms/step
Epoch 24/50
320/320 - 15s - loss: 3.0742 - accuracy10: 0.4757 - val_loss: 3.2933 - val_accuracy10: 0.4090 - 15s/epoch - 47ms/step
Epoch 25/50
320/320 - 15s - loss: 3.0632 - accuracy10: 0.4804 - val_loss: 3.3107 - val_accuracy10: 0.4025 - 15s/epoch - 47ms/step
Epoch 26/50
320/320 - 15s - loss: 3.0555 - accuracy10: 0.4828 - val_loss: 3.3050 - val_accuracy10: 0.4009 - 15s/epoch - 48ms/step
testing model: results/CHTR/W2/deepLOB_L2/h10
Evaluating performance on  test set...
860/860 - 16s - 16s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0897335
{'0': {'precision': 0.40103051853897675, 'recall': 0.5951328850464297, 'f1-score': 0.47917128581667434, 'support': 78075}, '1': {'precision': 0.37147151071615264, 'recall': 0.26088353167926087, 'f1-score': 0.30650755710511657, 'support': 65374}, '2': {'precision': 0.42703892174391417, 'recall': 0.32472710634682006, 'f1-score': 0.3689209359660783, 'support': 76495}, 'accuracy': 0.40173862437711416, 'macro avg': {'precision': 0.39984698366634785, 'recall': 0.3935811743575035, 'f1-score': 0.3848665929626231, 'support': 219944}, 'weighted avg': {'precision': 0.4012902311283285, 'recall': 0.40173862437711416, 'f1-score': 0.38950610234901567, 'support': 219944}}
[[46465 14095 17515]
 [32506 17055 15813]
 [36893 14762 24840]]
Evaluating performance on  train set...
320/320 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.072882
{'0': {'precision': 0.42432322763897745, 'recall': 0.5250134480903712, 'f1-score': 0.46932854601118823, 'support': 27885}, '1': {'precision': 0.43240284619594965, 'recall': 0.2909439104334696, 'f1-score': 0.3478414019329415, 'support': 27153}, '2': {'precision': 0.4074714631615358, 'recall': 0.44212580693589554, 'f1-score': 0.4240918745724881, 'support': 26644}, 'accuracy': 0.42016600964716827, 'macro avg': {'precision': 0.421399178998821, 'recall': 0.41936105515324545, 'f1-score': 0.41375394083887257, 'support': 81682}, 'weighted avg': {'precision': 0.4215121734280192, 'recall': 0.42016600964716827, 'f1-score': 0.41418755660141177, 'support': 81682}}
[[14640  5169  8076]
 [10199  7900  9054]
 [ 9663  5201 11780]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0849386
{'0': {'precision': 0.4090682610861983, 'recall': 0.6439937247870909, 'f1-score': 0.5003264702041527, 'support': 8924}, '1': {'precision': 0.4264736297828335, 'recall': 0.2513714494697062, 'f1-score': 0.3163061819297438, 'support': 8203}, '2': {'precision': 0.39526081948329767, 'recall': 0.30661220321674754, 'f1-score': 0.34533822155129035, 'support': 7834}, 'accuracy': 0.40907816193261487, 'macro avg': {'precision': 0.41026757011744314, 'recall': 0.4006591258245149, 'f1-score': 0.3873236245617289, 'support': 24961}, 'weighted avg': {'precision': 0.4104547737219651, 'recall': 0.40907816193261487, 'f1-score': 0.3912083914147813, 'support': 24961}}
[[5747 1381 1796]
 [4262 2062 1879]
 [4040 1392 2402]]
training model: results/CHTR/W2/deepLOB_L2/h20
Epoch 1/50
320/320 - 18s - loss: 3.3432 - accuracy20: 0.3441 - val_loss: 3.3432 - val_accuracy20: 0.3464 - 18s/epoch - 57ms/step
Epoch 2/50
320/320 - 16s - loss: 3.2999 - accuracy20: 0.3625 - val_loss: 3.3137 - val_accuracy20: 0.3640 - 16s/epoch - 49ms/step
Epoch 3/50
320/320 - 15s - loss: 3.2769 - accuracy20: 0.3765 - val_loss: 3.3066 - val_accuracy20: 0.3731 - 15s/epoch - 48ms/step
Epoch 4/50
320/320 - 16s - loss: 3.2625 - accuracy20: 0.3861 - val_loss: 3.2955 - val_accuracy20: 0.3813 - 16s/epoch - 49ms/step
Epoch 5/50
320/320 - 16s - loss: 3.2501 - accuracy20: 0.3938 - val_loss: 3.2888 - val_accuracy20: 0.3876 - 16s/epoch - 49ms/step
Epoch 6/50
320/320 - 16s - loss: 3.2443 - accuracy20: 0.3979 - val_loss: 3.2891 - val_accuracy20: 0.3879 - 16s/epoch - 49ms/step
Epoch 7/50
320/320 - 16s - loss: 3.2336 - accuracy20: 0.4054 - val_loss: 3.2887 - val_accuracy20: 0.3874 - 16s/epoch - 49ms/step
Epoch 8/50
320/320 - 16s - loss: 3.2262 - accuracy20: 0.4105 - val_loss: 3.2852 - val_accuracy20: 0.3868 - 16s/epoch - 49ms/step
Epoch 9/50
320/320 - 15s - loss: 3.2195 - accuracy20: 0.4156 - val_loss: 3.2862 - val_accuracy20: 0.3914 - 15s/epoch - 48ms/step
Epoch 10/50
320/320 - 16s - loss: 3.2121 - accuracy20: 0.4196 - val_loss: 3.2841 - val_accuracy20: 0.3923 - 16s/epoch - 49ms/step
Epoch 11/50
320/320 - 15s - loss: 3.2012 - accuracy20: 0.4255 - val_loss: 3.2975 - val_accuracy20: 0.3898 - 15s/epoch - 48ms/step
Epoch 12/50
320/320 - 16s - loss: 3.1944 - accuracy20: 0.4296 - val_loss: 3.3060 - val_accuracy20: 0.3944 - 16s/epoch - 49ms/step
Epoch 13/50
320/320 - 15s - loss: 3.1848 - accuracy20: 0.4347 - val_loss: 3.3089 - val_accuracy20: 0.3898 - 15s/epoch - 48ms/step
Epoch 14/50
320/320 - 15s - loss: 3.1790 - accuracy20: 0.4353 - val_loss: 3.3047 - val_accuracy20: 0.3906 - 15s/epoch - 48ms/step
Epoch 15/50
320/320 - 16s - loss: 3.1703 - accuracy20: 0.4419 - val_loss: 3.3002 - val_accuracy20: 0.3893 - 16s/epoch - 49ms/step
Epoch 16/50
320/320 - 16s - loss: 3.1593 - accuracy20: 0.4447 - val_loss: 3.3140 - val_accuracy20: 0.3931 - 16s/epoch - 48ms/step
Epoch 17/50
320/320 - 15s - loss: 3.1519 - accuracy20: 0.4487 - val_loss: 3.3224 - val_accuracy20: 0.3925 - 15s/epoch - 48ms/step
Epoch 18/50
320/320 - 16s - loss: 3.1428 - accuracy20: 0.4521 - val_loss: 3.3245 - val_accuracy20: 0.3955 - 16s/epoch - 48ms/step
Epoch 19/50
320/320 - 16s - loss: 3.1345 - accuracy20: 0.4550 - val_loss: 3.3414 - val_accuracy20: 0.3935 - 16s/epoch - 49ms/step
Epoch 20/50
320/320 - 16s - loss: 3.1257 - accuracy20: 0.4581 - val_loss: 3.3425 - val_accuracy20: 0.3889 - 16s/epoch - 49ms/step
testing model: results/CHTR/W2/deepLOB_L2/h20
Evaluating performance on  test set...
860/860 - 16s - 16s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0970461
{'0': {'precision': 0.3758396052396037, 'recall': 0.640871146266042, 'f1-score': 0.47381176655284746, 'support': 75349}, '1': {'precision': 0.33859281919175654, 'recall': 0.18789367880276972, 'f1-score': 0.24167552503806705, 'support': 67155}, '2': {'precision': 0.42922778854137833, 'recall': 0.3003873966942149, 'f1-score': 0.35343183803699624, 'support': 77440}, 'accuracy': 0.3826837740515768, 'macro avg': {'precision': 0.3812200709909129, 'recall': 0.37638407392100887, 'f1-score': 0.3563063765426369, 'support': 219944}, 'weighted avg': {'precision': 0.3832645543077586, 'recall': 0.3826837740515768, 'f1-score': 0.3605496136266817, 'support': 219944}}
[[48289 11046 16014]
 [39618 12618 14919]
 [40576 13602 23262]]
Evaluating performance on  train set...
320/320 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0900413
{'0': {'precision': 0.41624675032897906, 'recall': 0.46043242091809566, 'f1-score': 0.4372260805070461, 'support': 28167}, '1': {'precision': 0.38582062672589745, 'recall': 0.23687896211116025, 'f1-score': 0.29353733729161907, 'support': 27132}, '2': {'precision': 0.3719254731744766, 'recall': 0.4774286472349619, 'f1-score': 0.4181244813278008, 'support': 26383}, 'accuracy': 0.39166523836340933, 'macro avg': {'precision': 0.391330950076451, 'recall': 0.3915800100880726, 'f1-score': 0.38296263304215533, 'support': 81682}, 'weighted avg': {'precision': 0.3918246029676749, 'recall': 0.39166523836340933, 'f1-score': 0.383327786243108, 'support': 81682}}
[[12969  5038 10160]
 [ 9594  6427 11111]
 [ 8594  5193 12596]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0917284
{'0': {'precision': 0.39948635634028895, 'recall': 0.7009914375844976, 'f1-score': 0.508936239826592, 'support': 8876}, '1': {'precision': 0.36524822695035464, 'recall': 0.15369311116637652, 'f1-score': 0.21634867845265185, 'support': 8042}, '2': {'precision': 0.39370209930023325, 'recall': 0.2937958473206515, 'f1-score': 0.3364898540405838, 'support': 8043}, 'accuracy': 0.39345378790913826, 'macro avg': {'precision': 0.38614556086362556, 'recall': 0.3828267986905085, 'f1-score': 0.3539249241066092, 'support': 24961}, 'weighted avg': {'precision': 0.38659160789563457, 'recall': 0.39345378790913826, 'f1-score': 0.3591034827477053, 'support': 24961}}
[[6222  978 1676]
 [4843 1236 1963]
 [4510 1170 2363]]
training model: results/CHTR/W2/deepLOB_L2/h30
Epoch 1/50
320/320 - 18s - loss: 3.3390 - accuracy30: 0.3443 - val_loss: 3.3619 - val_accuracy30: 0.3427 - 18s/epoch - 55ms/step
Epoch 2/50
320/320 - 16s - loss: 3.3046 - accuracy30: 0.3555 - val_loss: 3.3313 - val_accuracy30: 0.3652 - 16s/epoch - 49ms/step
Epoch 3/50
320/320 - 16s - loss: 3.2831 - accuracy30: 0.3714 - val_loss: 3.3203 - val_accuracy30: 0.3660 - 16s/epoch - 49ms/step
Epoch 4/50
320/320 - 16s - loss: 3.2719 - accuracy30: 0.3798 - val_loss: 3.2915 - val_accuracy30: 0.3671 - 16s/epoch - 49ms/step
Epoch 5/50
320/320 - 16s - loss: 3.2593 - accuracy30: 0.3874 - val_loss: 3.2998 - val_accuracy30: 0.3697 - 16s/epoch - 48ms/step
Epoch 6/50
320/320 - 16s - loss: 3.2513 - accuracy30: 0.3948 - val_loss: 3.2911 - val_accuracy30: 0.3763 - 16s/epoch - 49ms/step
Epoch 7/50
320/320 - 16s - loss: 3.2434 - accuracy30: 0.4015 - val_loss: 3.2883 - val_accuracy30: 0.3762 - 16s/epoch - 49ms/step
Epoch 8/50
320/320 - 16s - loss: 3.2383 - accuracy30: 0.4028 - val_loss: 3.2864 - val_accuracy30: 0.3788 - 16s/epoch - 49ms/step
Epoch 9/50
320/320 - 15s - loss: 3.2304 - accuracy30: 0.4096 - val_loss: 3.2973 - val_accuracy30: 0.3770 - 15s/epoch - 48ms/step
Epoch 10/50
320/320 - 15s - loss: 3.2273 - accuracy30: 0.4110 - val_loss: 3.3039 - val_accuracy30: 0.3723 - 15s/epoch - 48ms/step
Epoch 11/50
320/320 - 16s - loss: 3.2203 - accuracy30: 0.4143 - val_loss: 3.3188 - val_accuracy30: 0.3764 - 16s/epoch - 49ms/step
Epoch 12/50
320/320 - 15s - loss: 3.2120 - accuracy30: 0.4203 - val_loss: 3.3350 - val_accuracy30: 0.3723 - 15s/epoch - 48ms/step
Epoch 13/50
320/320 - 16s - loss: 3.2044 - accuracy30: 0.4235 - val_loss: 3.3355 - val_accuracy30: 0.3754 - 16s/epoch - 49ms/step
Epoch 14/50
320/320 - 16s - loss: 3.1947 - accuracy30: 0.4296 - val_loss: 3.3606 - val_accuracy30: 0.3724 - 16s/epoch - 50ms/step
Epoch 15/50
320/320 - 16s - loss: 3.1909 - accuracy30: 0.4286 - val_loss: 3.3402 - val_accuracy30: 0.3789 - 16s/epoch - 49ms/step
Epoch 16/50
320/320 - 15s - loss: 3.1784 - accuracy30: 0.4358 - val_loss: 3.3304 - val_accuracy30: 0.3803 - 15s/epoch - 48ms/step
Epoch 17/50
320/320 - 15s - loss: 3.1755 - accuracy30: 0.4361 - val_loss: 3.3472 - val_accuracy30: 0.3758 - 15s/epoch - 48ms/step
Epoch 18/50
320/320 - 16s - loss: 3.1678 - accuracy30: 0.4406 - val_loss: 3.3311 - val_accuracy30: 0.3835 - 16s/epoch - 49ms/step
testing model: results/CHTR/W2/deepLOB_L2/h30
Evaluating performance on  test set...
860/860 - 16s - 16s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1003698
{'0': {'precision': 0.3672539489671932, 'recall': 0.5829237259760263, 'f1-score': 0.45061265057434374, 'support': 74665}, '1': {'precision': 0.3098583438903605, 'recall': 0.159953628013436, 'f1-score': 0.21099064834238437, 'support': 67282}, '2': {'precision': 0.4149025487256372, 'recall': 0.35480851827634396, 'f1-score': 0.3825096581131607, 'support': 77997}, 'accuracy': 0.3726403084421489, 'macro avg': {'precision': 0.36400494719439697, 'recall': 0.36589529075526867, 'f1-score': 0.34803765234329626, 'support': 219944}, 'weighted avg': {'precision': 0.3665935842133463, 'recall': 0.3726403084421489, 'f1-score': 0.35316022333302055, 'support': 219944}}
[[43524 11086 20055]
 [37549 10762 18971]
 [37439 12884 27674]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.09522
{'0': {'precision': 0.41073811723642334, 'recall': 0.4268492176386913, 'f1-score': 0.41863871789058826, 'support': 28120}, '1': {'precision': 0.3631682363303747, 'recall': 0.19695021128054382, 'f1-score': 0.2553961976461619, 'support': 27215}, '2': {'precision': 0.35737400530503977, 'recall': 0.5113675181235056, 'f1-score': 0.42072228207410184, 'support': 26347}, 'accuracy': 0.3775127935163194, 'macro avg': {'precision': 0.3770934529572793, 'recall': 0.37838898234758017, 'f1-score': 0.36491906587028405, 'support': 81682}, 'weighted avg': {'precision': 0.377675770992278, 'recall': 0.3775127935163194, 'f1-score': 0.364921258439191, 'support': 81682}}
[[12003  4603 11514]
 [ 9142  5360 12713]
 [ 8078  4796 13473]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0930729
{'0': {'precision': 0.3944440350747918, 'recall': 0.614863312657937, 'f1-score': 0.4805853570947614, 'support': 8706}, '1': {'precision': 0.3577289136855924, 'recall': 0.1319133486627133, 'f1-score': 0.1927497789566755, 'support': 8263}, '2': {'precision': 0.36521634903511924, 'recall': 0.38125625625625625, 'f1-score': 0.37306397306397304, 'support': 7992}, 'accuracy': 0.38019310123793115, 'macro avg': {'precision': 0.37246309926516785, 'recall': 0.37601097252563553, 'f1-score': 0.34879970303846997, 'support': 24961}, 'weighted avg': {'precision': 0.37293188752990103, 'recall': 0.38019310123793115, 'f1-score': 0.3508751578507782, 'support': 24961}}
[[5353  954 2399]
 [4276 1090 2897]
 [3942 1003 3047]]
training model: results/CHTR/W2/deepLOB_L2/h50
Epoch 1/50
320/320 - 18s - loss: 3.3434 - accuracy50: 0.3437 - val_loss: 3.3419 - val_accuracy50: 0.3437 - 18s/epoch - 55ms/step
Epoch 2/50
320/320 - 16s - loss: 3.3125 - accuracy50: 0.3540 - val_loss: 3.3238 - val_accuracy50: 0.3461 - 16s/epoch - 49ms/step
Epoch 3/50
320/320 - 16s - loss: 3.2941 - accuracy50: 0.3629 - val_loss: 3.3024 - val_accuracy50: 0.3608 - 16s/epoch - 49ms/step
Epoch 4/50
320/320 - 16s - loss: 3.2781 - accuracy50: 0.3772 - val_loss: 3.2995 - val_accuracy50: 0.3630 - 16s/epoch - 49ms/step
Epoch 5/50
320/320 - 16s - loss: 3.2699 - accuracy50: 0.3839 - val_loss: 3.2964 - val_accuracy50: 0.3685 - 16s/epoch - 49ms/step
Epoch 6/50
320/320 - 16s - loss: 3.2597 - accuracy50: 0.3909 - val_loss: 3.3068 - val_accuracy50: 0.3682 - 16s/epoch - 49ms/step
Epoch 7/50
320/320 - 16s - loss: 3.2518 - accuracy50: 0.3975 - val_loss: 3.2972 - val_accuracy50: 0.3695 - 16s/epoch - 49ms/step
Epoch 8/50
320/320 - 15s - loss: 3.2444 - accuracy50: 0.4030 - val_loss: 3.3000 - val_accuracy50: 0.3707 - 15s/epoch - 48ms/step
Epoch 9/50
320/320 - 16s - loss: 3.2379 - accuracy50: 0.4071 - val_loss: 3.3074 - val_accuracy50: 0.3732 - 16s/epoch - 49ms/step
Epoch 10/50
320/320 - 15s - loss: 3.2335 - accuracy50: 0.4092 - val_loss: 3.3020 - val_accuracy50: 0.3763 - 15s/epoch - 48ms/step
Epoch 11/50
320/320 - 16s - loss: 3.2267 - accuracy50: 0.4126 - val_loss: 3.3058 - val_accuracy50: 0.3759 - 16s/epoch - 49ms/step
Epoch 12/50
320/320 - 16s - loss: 3.2166 - accuracy50: 0.4198 - val_loss: 3.3300 - val_accuracy50: 0.3728 - 16s/epoch - 49ms/step
Epoch 13/50
320/320 - 16s - loss: 3.2111 - accuracy50: 0.4209 - val_loss: 3.3242 - val_accuracy50: 0.3723 - 16s/epoch - 48ms/step
Epoch 14/50
320/320 - 16s - loss: 3.2079 - accuracy50: 0.4230 - val_loss: 3.3457 - val_accuracy50: 0.3704 - 16s/epoch - 49ms/step
Epoch 15/50
320/320 - 15s - loss: 3.2005 - accuracy50: 0.4254 - val_loss: 3.3403 - val_accuracy50: 0.3707 - 15s/epoch - 48ms/step
testing model: results/CHTR/W2/deepLOB_L2/h50
Evaluating performance on  test set...
860/860 - 16s - 16s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0969733
{'0': {'precision': 0.36702637021300566, 'recall': 0.618784680296843, 'f1-score': 0.46075826606996734, 'support': 73709}, '1': {'precision': 0.34419364294987226, 'recall': 0.12110094446654585, 'f1-score': 0.17916466843963902, 'support': 67869}, '2': {'precision': 0.3863028580979442, 'recall': 0.353916239185361, 'f1-score': 0.36940104686938113, 'support': 78366}, 'accuracy': 0.37083985014367293, 'macro avg': {'precision': 0.3658409570869407, 'recall': 0.36460062131625, 'f1-score': 0.3364413271263292, 'support': 219944}, 'weighted avg': {'precision': 0.3668489927122304, 'recall': 0.37083985014367293, 'f1-score': 0.34131524549452136, 'support': 219944}}
[[45610  7217 20882]
 [36471  8219 23179]
 [42188  8443 27735]]
Evaluating performance on  train set...
320/320 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0999837
{'0': {'precision': 0.3943455497382199, 'recall': 0.4651515686205315, 'f1-score': 0.42683203264142994, 'support': 28337}, '1': {'precision': 0.3352725907853993, 'recall': 0.13429806427363278, 'f1-score': 0.1917771456175192, 'support': 26605}, '2': {'precision': 0.35593085106382977, 'recall': 0.5004861630516081, 'f1-score': 0.41600870376126825, 'support': 26740}, 'accuracy': 0.3689552165715825, 'macro avg': {'precision': 0.361849663862483, 'recall': 0.36664526531525743, 'f1-score': 0.34487262734007246, 'support': 81682}, 'weighted avg': {'precision': 0.3625289302199297, 'recall': 0.3689552165715825, 'f1-score': 0.34672807970777664, 'support': 81682}}
[[13181  3587 11569]
 [10384  3573 12648]
 [ 9860  3497 13383]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0970498
{'0': {'precision': 0.3773904787739048, 'recall': 0.6458164094232332, 'f1-score': 0.4763942986773959, 'support': 8617}, '1': {'precision': 0.326775956284153, 'recall': 0.10862194235892468, 'f1-score': 0.1630464418794874, 'support': 8258}, '2': {'precision': 0.36305220883534134, 'recall': 0.33539450902794954, 'f1-score': 0.3486757521213679, 'support': 8086}, 'accuracy': 0.3675333520291655, 'macro avg': {'precision': 0.35573954796446644, 'recall': 0.3632776202700358, 'f1-score': 0.3293721642260838, 'support': 24961}, 'weighted avg': {'precision': 0.35600055138944126, 'recall': 0.3675333520291655, 'f1-score': 0.3313536845638119, 'support': 24961}}
[[5565  832 2220]
 [4823  897 2538]
 [4358 1016 2712]]
training model: results/CHTR/W2/deepLOB_L2/h100
Epoch 1/50
320/320 - 18s - loss: 3.3429 - accuracy100: 0.3479 - val_loss: 3.3595 - val_accuracy100: 0.3474 - 18s/epoch - 55ms/step
Epoch 2/50
320/320 - 16s - loss: 3.3084 - accuracy100: 0.3589 - val_loss: 3.3311 - val_accuracy100: 0.3515 - 16s/epoch - 48ms/step
Epoch 3/50
320/320 - 16s - loss: 3.2936 - accuracy100: 0.3657 - val_loss: 3.3486 - val_accuracy100: 0.3478 - 16s/epoch - 49ms/step
Epoch 4/50
320/320 - 16s - loss: 3.2722 - accuracy100: 0.3828 - val_loss: 3.3687 - val_accuracy100: 0.3523 - 16s/epoch - 49ms/step
Epoch 5/50
320/320 - 15s - loss: 3.2688 - accuracy100: 0.3877 - val_loss: 3.3547 - val_accuracy100: 0.3519 - 15s/epoch - 48ms/step
Epoch 6/50
320/320 - 16s - loss: 3.2560 - accuracy100: 0.3961 - val_loss: 3.3583 - val_accuracy100: 0.3546 - 16s/epoch - 49ms/step
Epoch 7/50
320/320 - 15s - loss: 3.2530 - accuracy100: 0.3986 - val_loss: 3.3531 - val_accuracy100: 0.3560 - 15s/epoch - 48ms/step
Epoch 8/50
320/320 - 15s - loss: 3.2467 - accuracy100: 0.4031 - val_loss: 3.3486 - val_accuracy100: 0.3582 - 15s/epoch - 48ms/step
Epoch 9/50
320/320 - 16s - loss: 3.2392 - accuracy100: 0.4090 - val_loss: 3.4051 - val_accuracy100: 0.3586 - 16s/epoch - 48ms/step
Epoch 10/50
320/320 - 16s - loss: 3.2322 - accuracy100: 0.4110 - val_loss: 3.4095 - val_accuracy100: 0.3643 - 16s/epoch - 48ms/step
Epoch 11/50
320/320 - 15s - loss: 3.2286 - accuracy100: 0.4132 - val_loss: 3.3917 - val_accuracy100: 0.3630 - 15s/epoch - 48ms/step
Epoch 12/50
320/320 - 15s - loss: 3.2194 - accuracy100: 0.4185 - val_loss: 3.3889 - val_accuracy100: 0.3578 - 15s/epoch - 48ms/step
testing model: results/CHTR/W2/deepLOB_L2/h100
Evaluating performance on  test set...
860/860 - 16s - 16s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1284981
{'0': {'precision': 0.33500235374673687, 'recall': 0.4267568009594941, 'f1-score': 0.3753536322224886, 'support': 73372}, '1': {'precision': 0.2744704010717575, 'recall': 0.10035666722794556, 'f1-score': 0.14697409570354095, 'support': 65327}, '2': {'precision': 0.36999707573837604, 'recall': 0.4672041356391163, 'f1-score': 0.41295727146626054, 'support': 81245}, 'accuracy': 0.3447513912632306, 'macro avg': {'precision': 0.3264899435189568, 'recall': 0.3314392012755187, 'f1-score': 0.3117616664640967, 'support': 219944}, 'weighted avg': {'precision': 0.3299500464131081, 'recall': 0.3447513912632306, 'f1-score': 0.32141152736028256, 'support': 219944}}
[[31312  7949 34111]
 [28250  6556 30521]
 [33906  9381 37958]]
Evaluating performance on  train set...
320/320 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1139971
{'0': {'precision': 0.34654016031408474, 'recall': 0.381212884649991, 'f1-score': 0.3630505569837189, 'support': 27785}, '1': {'precision': 0.3279838866870249, 'recall': 0.18776269295145992, 'f1-score': 0.2388116188854196, 'support': 26885}, '2': {'precision': 0.33513407602306444, 'recall': 0.4432474455797423, 'f1-score': 0.38168255283878993, 'support': 27012}, 'accuracy': 0.33805489581547954, 'macro avg': {'precision': 0.3365527076747246, 'recall': 0.3374076743937311, 'f1-score': 0.3278482429026428, 'support': 81682}, 'weighted avg': {'precision': 0.33666054711494, 'recall': 0.33805489581547954, 'f1-score': 0.3283198160770859, 'support': 81682}}
[[10592  5323 11870]
 [ 9954  5048 11883]
 [10019  5020 11973]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1103178
{'0': {'precision': 0.34370292256703827, 'recall': 0.5405117270788913, 'f1-score': 0.4202044387144304, 'support': 8442}, '1': {'precision': 0.35028437604550017, 'recall': 0.12808906288230976, 'f1-score': 0.18758398280032249, 'support': 8174}, '2': {'precision': 0.3578656853725851, 'recall': 0.37291791491911325, 'f1-score': 0.3652367818789977, 'support': 8345}, 'accuracy': 0.34942510316093106, 'macro avg': {'precision': 0.35061766132837446, 'recall': 0.34717290162677145, 'f1-score': 0.32434173446458353, 'support': 24961}, 'weighted avg': {'precision': 0.3505930734562348, 'recall': 0.34942510316093106, 'f1-score': 0.3256511474627336, 'support': 24961}}
[[4563  981 2898]
 [4441 1047 2686]
 [4272  961 3112]]
training model: results/CHTR/W2/deepLOB_L2/h200
Epoch 1/50
320/320 - 18s - loss: 3.3375 - accuracy200: 0.3523 - val_loss: 3.3483 - val_accuracy200: 0.3407 - 18s/epoch - 57ms/step
Epoch 2/50
320/320 - 16s - loss: 3.3084 - accuracy200: 0.3597 - val_loss: 3.3395 - val_accuracy200: 0.3373 - 16s/epoch - 49ms/step
Epoch 3/50
320/320 - 16s - loss: 3.2941 - accuracy200: 0.3651 - val_loss: 3.3445 - val_accuracy200: 0.3370 - 16s/epoch - 49ms/step
Epoch 4/50
320/320 - 15s - loss: 3.2821 - accuracy200: 0.3737 - val_loss: 3.3773 - val_accuracy200: 0.3347 - 15s/epoch - 48ms/step
Epoch 5/50
320/320 - 15s - loss: 3.2711 - accuracy200: 0.3798 - val_loss: 3.3949 - val_accuracy200: 0.3365 - 15s/epoch - 48ms/step
Epoch 6/50
320/320 - 16s - loss: 3.2596 - accuracy200: 0.3916 - val_loss: 3.4345 - val_accuracy200: 0.3315 - 16s/epoch - 49ms/step
Epoch 7/50
320/320 - 16s - loss: 3.2487 - accuracy200: 0.3997 - val_loss: 3.4755 - val_accuracy200: 0.3296 - 16s/epoch - 49ms/step
Epoch 8/50
320/320 - 16s - loss: 3.2479 - accuracy200: 0.3989 - val_loss: 3.4818 - val_accuracy200: 0.3358 - 16s/epoch - 49ms/step
Epoch 9/50
320/320 - 16s - loss: 3.2361 - accuracy200: 0.4091 - val_loss: 3.5438 - val_accuracy200: 0.3392 - 16s/epoch - 48ms/step
Epoch 10/50
320/320 - 15s - loss: 3.2263 - accuracy200: 0.4136 - val_loss: 3.5894 - val_accuracy200: 0.3366 - 15s/epoch - 48ms/step
Epoch 11/50
320/320 - 16s - loss: 3.2195 - accuracy200: 0.4200 - val_loss: 3.6260 - val_accuracy200: 0.3365 - 16s/epoch - 48ms/step
Epoch 12/50
320/320 - 15s - loss: 3.2105 - accuracy200: 0.4220 - val_loss: 3.6148 - val_accuracy200: 0.3328 - 15s/epoch - 48ms/step
testing model: results/CHTR/W2/deepLOB_L2/h200
Evaluating performance on  test set...
860/860 - 16s - 16s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1179429
{'0': {'precision': 0.3365428026498853, 'recall': 0.5054312480108487, 'f1-score': 0.40404867256637167, 'support': 72267}, '1': {'precision': 0.3114912722065255, 'recall': 0.2536600740682373, 'f1-score': 0.27961677770153476, 'support': 63455}, '2': {'precision': 0.38873729849172206, 'recall': 0.27572368264823915, 'f1-score': 0.32261963475711836, 'support': 84222}, 'accuracy': 0.34483323027679774, 'macro avg': {'precision': 0.34559045778271097, 'recall': 0.3449383349091084, 'f1-score': 0.3354283616750083, 'support': 219944}, 'weighted avg': {'precision': 0.34930186843257444, 'recall': 0.34483323027679774, 'f1-score': 0.3369682234019518, 'support': 219944}}
[[36526 16015 19726]
 [30570 16096 16789]
 [41437 19563 23222]]
Evaluating performance on  train set...
320/320 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1131128
{'0': {'precision': 0.33310131945285076, 'recall': 0.4040452242860289, 'f1-score': 0.36515940682745573, 'support': 27242}, '1': {'precision': 0.34032416502946955, 'recall': 0.25457417885223016, 'f1-score': 0.2912690739417378, 'support': 27218}, '2': {'precision': 0.3405474220241884, 'recall': 0.3537579898611417, 'f1-score': 0.34702702702702704, 'support': 27222}, 'accuracy': 0.3374794936460909, 'macro avg': {'precision': 0.33799096883550295, 'recall': 0.3374591309998003, 'f1-score': 0.3344851692654069, 'support': 81682}, 'weighted avg': {'precision': 0.3379896573375911, 'recall': 0.3374794936460909, 'f1-score': 0.3344947962227846, 'support': 81682}}
[[11007  6778  9457]
 [11098  6929  9191]
 [10939  6653  9630]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1176125
{'0': {'precision': 0.3335754640839387, 'recall': 0.4896919431279621, 'f1-score': 0.3968314930388862, 'support': 8440}, '1': {'precision': 0.31003303773256824, 'recall': 0.21936515748031496, 'f1-score': 0.25693493767562503, 'support': 8128}, '2': {'precision': 0.33885630498533725, 'recall': 0.2753485047063029, 'f1-score': 0.3038191020837442, 'support': 8393}, 'accuracy': 0.3295941669003646, 'macro avg': {'precision': 0.32748826893394806, 'recall': 0.32813520177152666, 'f1-score': 0.31919517759941846, 'support': 24961}, 'weighted avg': {'precision': 0.32768504528266873, 'recall': 0.3295941669003646, 'f1-score': 0.3200023516070889, 'support': 24961}}
[[4133 1966 2341]
 [4177 1783 2168]
 [4080 2002 2311]]
training model: results/CHTR/W2/deepLOB_L2/h300
Epoch 1/50
320/320 - 18s - loss: 3.3417 - accuracy300: 0.3528 - val_loss: 3.3664 - val_accuracy300: 0.3412 - 18s/epoch - 55ms/step
Epoch 2/50
320/320 - 15s - loss: 3.3030 - accuracy300: 0.3666 - val_loss: 3.3499 - val_accuracy300: 0.3346 - 15s/epoch - 48ms/step
Epoch 3/50
320/320 - 16s - loss: 3.2926 - accuracy300: 0.3704 - val_loss: 3.3486 - val_accuracy300: 0.3383 - 16s/epoch - 49ms/step
Epoch 4/50
320/320 - 15s - loss: 3.2746 - accuracy300: 0.3803 - val_loss: 3.3863 - val_accuracy300: 0.3300 - 15s/epoch - 48ms/step
Epoch 5/50
320/320 - 15s - loss: 3.2632 - accuracy300: 0.3919 - val_loss: 3.4032 - val_accuracy300: 0.3377 - 15s/epoch - 48ms/step
Epoch 6/50
320/320 - 16s - loss: 3.2451 - accuracy300: 0.4029 - val_loss: 3.3993 - val_accuracy300: 0.3374 - 16s/epoch - 49ms/step
Epoch 7/50
320/320 - 16s - loss: 3.2309 - accuracy300: 0.4099 - val_loss: 3.4151 - val_accuracy300: 0.3319 - 16s/epoch - 49ms/step
Epoch 8/50
320/320 - 15s - loss: 3.2272 - accuracy300: 0.4115 - val_loss: 3.4043 - val_accuracy300: 0.3333 - 15s/epoch - 48ms/step
Epoch 9/50
320/320 - 15s - loss: 3.2199 - accuracy300: 0.4170 - val_loss: 3.3975 - val_accuracy300: 0.3330 - 15s/epoch - 48ms/step
Epoch 10/50
320/320 - 16s - loss: 3.2148 - accuracy300: 0.4206 - val_loss: 3.4199 - val_accuracy300: 0.3337 - 16s/epoch - 49ms/step
Epoch 11/50
320/320 - 16s - loss: 3.2070 - accuracy300: 0.4239 - val_loss: 3.4139 - val_accuracy300: 0.3348 - 16s/epoch - 49ms/step
Epoch 12/50
320/320 - 16s - loss: 3.1931 - accuracy300: 0.4302 - val_loss: 3.4527 - val_accuracy300: 0.3319 - 16s/epoch - 49ms/step
Epoch 13/50
320/320 - 16s - loss: 3.1833 - accuracy300: 0.4333 - val_loss: 3.4656 - val_accuracy300: 0.3273 - 16s/epoch - 49ms/step
testing model: results/CHTR/W2/deepLOB_L2/h300
Evaluating performance on  test set...
860/860 - 16s - 16s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1308362
{'0': {'precision': 0.3240844427854506, 'recall': 0.3217668213138606, 'f1-score': 0.32292147368566054, 'support': 72854}, '1': {'precision': 0.27557659056941064, 'recall': 0.31530504467953124, 'f1-score': 0.29410522858952404, 'support': 59647}, '2': {'precision': 0.3933345933345933, 'recall': 0.3569982731608019, 'f1-score': 0.3742866049589948, 'support': 87443}, 'accuracy': 0.3340213872622122, 'macro avg': {'precision': 0.3309985422298182, 'recall': 0.3313567130513979, 'f1-score': 0.3304377690780598, 'support': 219944}, 'weighted avg': {'precision': 0.3384612525794825, 'recall': 0.3340213872622122, 'f1-score': 0.33552794898248567, 'support': 219944}}
[[23442 22015 27397]
 [20089 18807 20751]
 [28802 27424 31217]]
Evaluating performance on  train set...
320/320 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1206282
{'0': {'precision': 0.34127942063971034, 'recall': 0.28834177076883855, 'f1-score': 0.3125851347349719, 'support': 27457}, '1': {'precision': 0.33375641676538614, 'recall': 0.4393005643005643, 'f1-score': 0.37932360955281297, 'support': 26936}, '2': {'precision': 0.33391228831958314, 'recall': 0.28179852687896223, 'f1-score': 0.305649953297959, 'support': 27289}, 'accuracy': 0.3359369261281555, 'macro avg': {'precision': 0.3363160419082265, 'recall': 0.3364802873161217, 'f1-score': 0.33251956586191467, 'support': 81682}, 'weighted avg': {'precision': 0.3363373121428231, 'recall': 0.3359369261281555, 'f1-score': 0.33227629547367465, 'support': 81682}}
[[ 7917 11827  7713]
 [ 7476 11833  7627]
 [ 7805 11794  7690]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1180968
{'0': {'precision': 0.329332407499256, 'recall': 0.3838150289017341, 'f1-score': 0.35449255245315253, 'support': 8650}, '1': {'precision': 0.30528294007099605, 'recall': 0.37424804812492, 'f1-score': 0.33626588465298146, 'support': 7813}, '2': {'precision': 0.3870237646171256, 'recall': 0.24146858084255118, 'f1-score': 0.2973913043478261, 'support': 8498}, 'accuracy': 0.33235847922759504, 'macro avg': {'precision': 0.34054637072912586, 'recall': 0.3331772192897351, 'f1-score': 0.32938324715132, 'support': 24961}, 'weighted avg': {'precision': 0.3414458109594804, 'recall': 0.33235847922759504, 'f1-score': 0.32934727133774044, 'support': 24961}}
[[3320 3455 1875]
 [3514 2924 1375]
 [3247 3199 2052]]
training model: results/CHTR/W2/deepLOB_L2/h500
Epoch 1/50
320/320 - 18s - loss: 3.3470 - accuracy500: 0.3497 - val_loss: 3.3280 - val_accuracy500: 0.3525 - 18s/epoch - 56ms/step
Epoch 2/50
320/320 - 16s - loss: 3.3083 - accuracy500: 0.3594 - val_loss: 3.3130 - val_accuracy500: 0.3562 - 16s/epoch - 49ms/step
Epoch 3/50
320/320 - 15s - loss: 3.2851 - accuracy500: 0.3729 - val_loss: 3.3486 - val_accuracy500: 0.3401 - 15s/epoch - 48ms/step
Epoch 4/50
320/320 - 15s - loss: 3.2738 - accuracy500: 0.3824 - val_loss: 3.3577 - val_accuracy500: 0.3437 - 15s/epoch - 48ms/step
Epoch 5/50
320/320 - 16s - loss: 3.2529 - accuracy500: 0.3963 - val_loss: 3.4318 - val_accuracy500: 0.3195 - 16s/epoch - 48ms/step
Epoch 6/50
320/320 - 16s - loss: 3.2525 - accuracy500: 0.4003 - val_loss: 3.4108 - val_accuracy500: 0.3229 - 16s/epoch - 49ms/step
Epoch 7/50
320/320 - 16s - loss: 3.2322 - accuracy500: 0.4098 - val_loss: 3.4054 - val_accuracy500: 0.3310 - 16s/epoch - 49ms/step
Epoch 8/50
320/320 - 16s - loss: 3.2195 - accuracy500: 0.4151 - val_loss: 3.4108 - val_accuracy500: 0.3239 - 16s/epoch - 49ms/step
Epoch 9/50
320/320 - 16s - loss: 3.2031 - accuracy500: 0.4232 - val_loss: 3.4138 - val_accuracy500: 0.3276 - 16s/epoch - 49ms/step
Epoch 10/50
320/320 - 15s - loss: 3.1916 - accuracy500: 0.4291 - val_loss: 3.4601 - val_accuracy500: 0.3144 - 15s/epoch - 48ms/step
Epoch 11/50
320/320 - 16s - loss: 3.1925 - accuracy500: 0.4274 - val_loss: 3.4572 - val_accuracy500: 0.3217 - 16s/epoch - 49ms/step
Epoch 12/50
320/320 - 16s - loss: 3.1778 - accuracy500: 0.4344 - val_loss: 3.4636 - val_accuracy500: 0.3241 - 16s/epoch - 49ms/step
testing model: results/CHTR/W2/deepLOB_L2/h500
Evaluating performance on  test set...
860/860 - 16s - 16s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1179819
{'0': {'precision': 0.31046782458241834, 'recall': 0.3273459536071624, 'f1-score': 0.31868357058936037, 'support': 71261}, '1': {'precision': 0.28067135201052595, 'recall': 0.14406430677494275, 'f1-score': 0.19039947752258624, 'support': 60709}, '2': {'precision': 0.38921054484020834, 'recall': 0.5027962807193034, 'f1-score': 0.4387715626270942, 'support': 87974}, 'accuracy': 0.34693376495835304, 'macro avg': {'precision': 0.32678324047771756, 'recall': 0.3247355137004695, 'f1-score': 0.31595153691301364, 'support': 219944}, 'weighted avg': {'precision': 0.33373919374271277, 'recall': 0.34693376495835304, 'f1-score': 0.33130779314390524, 'support': 219944}}
[[23327 10225 37709]
 [20257  8746 31706]
 [31551 12190 44233]]
Evaluating performance on  train set...
320/320 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1177891
{'0': {'precision': 0.3319281524926686, 'recall': 0.3971200935604122, 'f1-score': 0.36160937136011184, 'support': 27362}, '1': {'precision': 0.34378691869831385, 'recall': 0.11872705018359853, 'f1-score': 0.17649977944419937, 'support': 26961}, '2': {'precision': 0.3358899962154661, 'recall': 0.4866040425454147, 'f1-score': 0.39743857658894827, 'support': 27359}, 'accuracy': 0.3352023701672339, 'macro avg': {'precision': 0.33720168913548293, 'recall': 0.33415039542980846, 'f1-score': 0.31184924246441986, 'support': 81682}, 'weighted avg': {'precision': 0.3371694085598856, 'recall': 0.3352023701672339, 'f1-score': 0.312510567685016, 'support': 81682}}
[[10866  3153 13343]
 [10781  3201 12979]
 [11089  2957 13313]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1035132
{'0': {'precision': 0.34357495881383854, 'recall': 0.4769037274182483, 'f1-score': 0.3994063008713971, 'support': 8746}, '1': {'precision': 0.30961621388529537, 'recall': 0.09616930083043129, 'f1-score': 0.14675523760858458, 'support': 7466}, '2': {'precision': 0.38449819082079606, 'recall': 0.46153846153846156, 'f1-score': 0.41951067477014187, 'support': 8749}, 'accuracy': 0.3576379151476303, 'macro avg': {'precision': 0.34589645450664336, 'recall': 0.34487049659571367, 'f1-score': 0.32189073775004123, 'support': 24961}, 'weighted avg': {'precision': 0.34776154457532116, 'recall': 0.3576379151476303, 'f1-score': 0.3308834183314332, 'support': 24961}}
[[4171  837 3738]
 [4022  718 2726]
 [3947  764 4038]]
training model: results/CHTR/W2/deepLOB_L2/h1000
Epoch 1/50
320/320 - 18s - loss: 3.3461 - accuracy1000: 0.3514 - val_loss: 3.3976 - val_accuracy1000: 0.3438 - 18s/epoch - 56ms/step
Epoch 2/50
320/320 - 15s - loss: 3.2972 - accuracy1000: 0.3790 - val_loss: 3.4561 - val_accuracy1000: 0.3441 - 15s/epoch - 48ms/step
Epoch 3/50
320/320 - 16s - loss: 3.2577 - accuracy1000: 0.4062 - val_loss: 3.4068 - val_accuracy1000: 0.3471 - 16s/epoch - 49ms/step
Epoch 4/50
320/320 - 16s - loss: 3.2438 - accuracy1000: 0.4087 - val_loss: 3.4456 - val_accuracy1000: 0.3316 - 16s/epoch - 49ms/step
Epoch 5/50
320/320 - 16s - loss: 3.2413 - accuracy1000: 0.4025 - val_loss: 3.3945 - val_accuracy1000: 0.3485 - 16s/epoch - 50ms/step
Epoch 6/50
320/320 - 15s - loss: 3.2012 - accuracy1000: 0.4215 - val_loss: 3.4814 - val_accuracy1000: 0.3425 - 15s/epoch - 48ms/step
Epoch 7/50
320/320 - 16s - loss: 3.1897 - accuracy1000: 0.4244 - val_loss: 3.4979 - val_accuracy1000: 0.3347 - 16s/epoch - 49ms/step
Epoch 8/50
320/320 - 16s - loss: 3.1638 - accuracy1000: 0.4382 - val_loss: 3.5466 - val_accuracy1000: 0.3271 - 16s/epoch - 49ms/step
Epoch 9/50
320/320 - 16s - loss: 3.1384 - accuracy1000: 0.4432 - val_loss: 3.6505 - val_accuracy1000: 0.3366 - 16s/epoch - 49ms/step
Epoch 10/50
320/320 - 16s - loss: 3.1234 - accuracy1000: 0.4501 - val_loss: 3.6069 - val_accuracy1000: 0.3407 - 16s/epoch - 49ms/step
Epoch 11/50
320/320 - 16s - loss: 3.1037 - accuracy1000: 0.4610 - val_loss: 3.6834 - val_accuracy1000: 0.3313 - 16s/epoch - 50ms/step
Epoch 12/50
320/320 - 16s - loss: 3.0987 - accuracy1000: 0.4637 - val_loss: 3.7592 - val_accuracy1000: 0.3332 - 16s/epoch - 50ms/step
Epoch 13/50
320/320 - 16s - loss: 3.0778 - accuracy1000: 0.4705 - val_loss: 3.7761 - val_accuracy1000: 0.3333 - 16s/epoch - 49ms/step
Epoch 14/50
320/320 - 16s - loss: 3.0589 - accuracy1000: 0.4774 - val_loss: 3.7553 - val_accuracy1000: 0.3336 - 16s/epoch - 50ms/step
Epoch 15/50
320/320 - 16s - loss: 3.0390 - accuracy1000: 0.4845 - val_loss: 3.7949 - val_accuracy1000: 0.3306 - 16s/epoch - 49ms/step
testing model: results/CHTR/W2/deepLOB_L2/h1000
Evaluating performance on  test set...
860/860 - 17s - 17s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1482856
{'0': {'precision': 0.3050914051841746, 'recall': 0.4094924192485168, 'f1-score': 0.3496653949590343, 'support': 68265}, '1': {'precision': 0.29254353890739687, 'recall': 0.17892522280754067, 'f1-score': 0.22204405521806614, 'support': 60366}, '2': {'precision': 0.417481782971181, 'recall': 0.41787040180478136, 'f1-score': 0.41767600199221716, 'support': 91313}, 'accuracy': 0.3496890117484451, 'macro avg': {'precision': 0.33837224235425084, 'recall': 0.33542934795361296, 'f1-score': 0.3297951507231059, 'support': 219944}, 'weighted avg': {'precision': 0.34830803337680977, 'recall': 0.3496890117484451, 'f1-score': 0.3428739515244225, 'support': 219944}}
[[27954 10566 29745]
 [26069 10801 23496]
 [37602 15554 38157]]
Evaluating performance on  train set...
320/320 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1491836
{'0': {'precision': 0.3411507892085526, 'recall': 0.21913424893938305, 'f1-score': 0.26685639229422065, 'support': 27814}, '1': {'precision': 0.32415468718364043, 'recall': 0.17796798577145398, 'f1-score': 0.22978112665949052, 'support': 26988}, '2': {'precision': 0.323537215045205, 'recall': 0.5897693452380952, 'f1-score': 0.41784947086809265, 'support': 26880}, 'accuracy': 0.32750177517690554, 'macro avg': {'precision': 0.3296142304791327, 'recall': 0.32895719331631074, 'f1-score': 0.3048289966072679, 'support': 81682}, 'weighted avg': {'precision': 0.3297389276606092, 'recall': 0.32750177517690554, 'f1-score': 0.30429556718116735, 'support': 81682}}
[[ 6095  5401 16318]
 [ 5357  4803 16828]
 [ 6414  4613 15853]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1301711
{'0': {'precision': 0.33845391476709613, 'recall': 0.3815216176963468, 'f1-score': 0.35869964812772437, 'support': 8951}, '1': {'precision': 0.2903421132303966, 'recall': 0.1273403266498473, 'f1-score': 0.17703525936865422, 'support': 7531}, '2': {'precision': 0.382088520055325, 'recall': 0.5212878877226088, 'f1-score': 0.44096373522222776, 'support': 8479}, 'accuracy': 0.35230960298064984, 'macro avg': {'precision': 0.3369615160176059, 'recall': 0.34338327735626767, 'f1-score': 0.32556621423953547, 'support': 24961}, 'weighted avg': {'precision': 0.3387603063726411, 'recall': 0.35230960298064984, 'f1-score': 0.33183384478369715, 'support': 24961}}
[[3415 1338 4198]
 [3622  959 2950]
 [3053 1006 4420]]
training model: results/CHTR/W2/deepOF_L2/h10
Epoch 1/50
320/320 - 12s - loss: 3.3238 - accuracy10: 0.3547 - val_loss: 3.2826 - val_accuracy10: 0.3805 - 12s/epoch - 39ms/step
Epoch 2/50
320/320 - 10s - loss: 3.2728 - accuracy10: 0.3844 - val_loss: 3.2612 - val_accuracy10: 0.3969 - 10s/epoch - 31ms/step
Epoch 3/50
320/320 - 10s - loss: 3.2448 - accuracy10: 0.4015 - val_loss: 3.2478 - val_accuracy10: 0.4025 - 10s/epoch - 31ms/step
Epoch 4/50
320/320 - 10s - loss: 3.2275 - accuracy10: 0.4096 - val_loss: 3.2367 - val_accuracy10: 0.4126 - 10s/epoch - 31ms/step
Epoch 5/50
320/320 - 10s - loss: 3.2107 - accuracy10: 0.4187 - val_loss: 3.2291 - val_accuracy10: 0.4133 - 10s/epoch - 32ms/step
Epoch 6/50
320/320 - 10s - loss: 3.1983 - accuracy10: 0.4256 - val_loss: 3.2179 - val_accuracy10: 0.4208 - 10s/epoch - 32ms/step
Epoch 7/50
320/320 - 10s - loss: 3.1872 - accuracy10: 0.4290 - val_loss: 3.2145 - val_accuracy10: 0.4217 - 10s/epoch - 31ms/step
Epoch 8/50
320/320 - 10s - loss: 3.1777 - accuracy10: 0.4325 - val_loss: 3.2051 - val_accuracy10: 0.4258 - 10s/epoch - 31ms/step
Epoch 9/50
320/320 - 10s - loss: 3.1664 - accuracy10: 0.4397 - val_loss: 3.2038 - val_accuracy10: 0.4283 - 10s/epoch - 33ms/step
Epoch 10/50
320/320 - 10s - loss: 3.1574 - accuracy10: 0.4423 - val_loss: 3.2045 - val_accuracy10: 0.4264 - 10s/epoch - 32ms/step
Epoch 11/50
320/320 - 10s - loss: 3.1471 - accuracy10: 0.4485 - val_loss: 3.1999 - val_accuracy10: 0.4270 - 10s/epoch - 33ms/step
Epoch 12/50
320/320 - 11s - loss: 3.1362 - accuracy10: 0.4533 - val_loss: 3.2003 - val_accuracy10: 0.4263 - 11s/epoch - 33ms/step
Epoch 13/50
320/320 - 10s - loss: 3.1292 - accuracy10: 0.4571 - val_loss: 3.2027 - val_accuracy10: 0.4287 - 10s/epoch - 32ms/step
Epoch 14/50
320/320 - 10s - loss: 3.1192 - accuracy10: 0.4603 - val_loss: 3.2010 - val_accuracy10: 0.4308 - 10s/epoch - 31ms/step
Epoch 15/50
320/320 - 10s - loss: 3.1099 - accuracy10: 0.4621 - val_loss: 3.2056 - val_accuracy10: 0.4275 - 10s/epoch - 32ms/step
Epoch 16/50
320/320 - 11s - loss: 3.0990 - accuracy10: 0.4670 - val_loss: 3.2038 - val_accuracy10: 0.4274 - 11s/epoch - 33ms/step
Epoch 17/50
320/320 - 10s - loss: 3.0916 - accuracy10: 0.4709 - val_loss: 3.2115 - val_accuracy10: 0.4303 - 10s/epoch - 32ms/step
Epoch 18/50
320/320 - 10s - loss: 3.0803 - accuracy10: 0.4752 - val_loss: 3.2186 - val_accuracy10: 0.4265 - 10s/epoch - 31ms/step
Epoch 19/50
320/320 - 10s - loss: 3.0711 - accuracy10: 0.4787 - val_loss: 3.2295 - val_accuracy10: 0.4282 - 10s/epoch - 32ms/step
Epoch 20/50
320/320 - 10s - loss: 3.0638 - accuracy10: 0.4791 - val_loss: 3.2288 - val_accuracy10: 0.4296 - 10s/epoch - 31ms/step
Epoch 21/50
320/320 - 10s - loss: 3.0520 - accuracy10: 0.4847 - val_loss: 3.2314 - val_accuracy10: 0.4250 - 10s/epoch - 32ms/step
testing model: results/CHTR/W2/deepOF_L2/h10
Evaluating performance on  test set...
860/860 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0685868
{'0': {'precision': 0.4167222512664275, 'recall': 0.5921637441881317, 'f1-score': 0.48918868872840787, 'support': 78073}, '1': {'precision': 0.41245593419506466, 'recall': 0.3006745904272406, 'f1-score': 0.3478045457360501, 'support': 65373}, '2': {'precision': 0.44754731745488335, 'recall': 0.358895585216948, 'f1-score': 0.3983487383374204, 'support': 76493}, 'accuracy': 0.42439494587135523, 'macro avg': {'precision': 0.42557516763879183, 'recall': 0.41724463994410677, 'f1-score': 0.41178065760062615, 'support': 219939}, 'weighted avg': {'precision': 0.4261748715022536, 'recall': 0.42439494587135523, 'f1-score': 0.4155713407132891, 'support': 219939}}
[[46232 13049 18792]
 [30621 19656 15096]
 [34089 14951 27453]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0457609
{'0': {'precision': 0.44274643689373, 'recall': 0.5847827642974733, 'f1-score': 0.503947693066864, 'support': 27942}, '1': {'precision': 0.46254212806933076, 'recall': 0.3562106043752317, 'f1-score': 0.4024717218265605, 'support': 26970}, '2': {'precision': 0.45832118308685693, 'recall': 0.4109977959580111, 'f1-score': 0.4333714105644621, 'support': 26769}, 'accuracy': 0.45235734136457684, 'macro avg': {'precision': 0.4545365826833059, 'recall': 0.45066372154357204, 'f1-score': 0.4465969418192956, 'support': 81681}, 'weighted avg': {'precision': 0.4543869673947004, 'recall': 0.45235734136457684, 'f1-score': 0.44731195831021586, 'support': 81681}}
[[16340  5507  6095]
 [10455  9607  6908]
 [10111  5656 11002]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.066715
{'0': {'precision': 0.4210159516803469, 'recall': 0.6069435141772717, 'f1-score': 0.49716532553035836, 'support': 8958}, '1': {'precision': 0.44392067620286085, 'recall': 0.3331706721971453, 'f1-score': 0.3806537040908774, 'support': 8197}, '2': {'precision': 0.42815945716709075, 'recall': 0.32334101972841406, 'f1-score': 0.3684402598350485, 'support': 7806}, 'accuracy': 0.42834822322823607, 'macro avg': {'precision': 0.4310320283500995, 'recall': 0.42115173536761036, 'f1-score': 0.4154197631520948, 'support': 24961}, 'weighted avg': {'precision': 0.43077165981465915, 'recall': 0.42834822322823607, 'f1-score': 0.4186478933859325, 'support': 24961}}
[[5437 1739 1782]
 [3877 2731 1589]
 [3600 1682 2524]]
training model: results/CHTR/W2/deepOF_L2/h20
Epoch 1/50
320/320 - 13s - loss: 3.3299 - accuracy20: 0.3509 - val_loss: 3.2968 - val_accuracy20: 0.3717 - 13s/epoch - 39ms/step
Epoch 2/50
320/320 - 10s - loss: 3.2815 - accuracy20: 0.3770 - val_loss: 3.2737 - val_accuracy20: 0.3877 - 10s/epoch - 32ms/step
Epoch 3/50
320/320 - 10s - loss: 3.2565 - accuracy20: 0.3930 - val_loss: 3.2637 - val_accuracy20: 0.3929 - 10s/epoch - 32ms/step
Epoch 4/50
320/320 - 10s - loss: 3.2407 - accuracy20: 0.4027 - val_loss: 3.2544 - val_accuracy20: 0.4033 - 10s/epoch - 32ms/step
Epoch 5/50
320/320 - 11s - loss: 3.2240 - accuracy20: 0.4124 - val_loss: 3.2525 - val_accuracy20: 0.4054 - 11s/epoch - 33ms/step
Epoch 6/50
320/320 - 10s - loss: 3.2134 - accuracy20: 0.4190 - val_loss: 3.2472 - val_accuracy20: 0.4038 - 10s/epoch - 31ms/step
Epoch 7/50
320/320 - 10s - loss: 3.2051 - accuracy20: 0.4233 - val_loss: 3.2407 - val_accuracy20: 0.4055 - 10s/epoch - 31ms/step
Epoch 8/50
320/320 - 10s - loss: 3.1950 - accuracy20: 0.4270 - val_loss: 3.2370 - val_accuracy20: 0.4114 - 10s/epoch - 32ms/step
Epoch 9/50
320/320 - 10s - loss: 3.1844 - accuracy20: 0.4337 - val_loss: 3.2356 - val_accuracy20: 0.4136 - 10s/epoch - 31ms/step
Epoch 10/50
320/320 - 10s - loss: 3.1769 - accuracy20: 0.4366 - val_loss: 3.2379 - val_accuracy20: 0.4119 - 10s/epoch - 31ms/step
Epoch 11/50
320/320 - 10s - loss: 3.1669 - accuracy20: 0.4411 - val_loss: 3.2298 - val_accuracy20: 0.4171 - 10s/epoch - 33ms/step
Epoch 12/50
320/320 - 10s - loss: 3.1558 - accuracy20: 0.4468 - val_loss: 3.2323 - val_accuracy20: 0.4136 - 10s/epoch - 32ms/step
Epoch 13/50
320/320 - 10s - loss: 3.1490 - accuracy20: 0.4497 - val_loss: 3.2280 - val_accuracy20: 0.4199 - 10s/epoch - 32ms/step
Epoch 14/50
320/320 - 10s - loss: 3.1406 - accuracy20: 0.4534 - val_loss: 3.2350 - val_accuracy20: 0.4171 - 10s/epoch - 31ms/step
Epoch 15/50
320/320 - 10s - loss: 3.1269 - accuracy20: 0.4588 - val_loss: 3.2380 - val_accuracy20: 0.4190 - 10s/epoch - 31ms/step
Epoch 16/50
320/320 - 10s - loss: 3.1181 - accuracy20: 0.4617 - val_loss: 3.2401 - val_accuracy20: 0.4181 - 10s/epoch - 32ms/step
Epoch 17/50
320/320 - 10s - loss: 3.1087 - accuracy20: 0.4670 - val_loss: 3.2514 - val_accuracy20: 0.4161 - 10s/epoch - 32ms/step
Epoch 18/50
320/320 - 10s - loss: 3.0998 - accuracy20: 0.4661 - val_loss: 3.2560 - val_accuracy20: 0.4124 - 10s/epoch - 32ms/step
Epoch 19/50
320/320 - 10s - loss: 3.0889 - accuracy20: 0.4723 - val_loss: 3.2637 - val_accuracy20: 0.4146 - 10s/epoch - 32ms/step
Epoch 20/50
320/320 - 10s - loss: 3.0799 - accuracy20: 0.4767 - val_loss: 3.2685 - val_accuracy20: 0.4185 - 10s/epoch - 32ms/step
Epoch 21/50
320/320 - 10s - loss: 3.0690 - accuracy20: 0.4803 - val_loss: 3.2684 - val_accuracy20: 0.4171 - 10s/epoch - 32ms/step
Epoch 22/50
320/320 - 11s - loss: 3.0609 - accuracy20: 0.4813 - val_loss: 3.2756 - val_accuracy20: 0.4139 - 11s/epoch - 33ms/step
Epoch 23/50
320/320 - 10s - loss: 3.0491 - accuracy20: 0.4875 - val_loss: 3.2837 - val_accuracy20: 0.4130 - 10s/epoch - 32ms/step
testing model: results/CHTR/W2/deepOF_L2/h20
Evaluating performance on  test set...
860/860 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0761471
{'0': {'precision': 0.40415826880237615, 'recall': 0.5562191431756649, 'f1-score': 0.46815046496690776, 'support': 75348}, '1': {'precision': 0.41174262958175223, 'recall': 0.29407472488198594, 'f1-score': 0.34310037788298664, 'support': 67153}, '2': {'precision': 0.44677797305213823, 'recall': 0.3939409592189881, 'f1-score': 0.4186991311986165, 'support': 77438}, 'accuracy': 0.41904346205084136, 'macro avg': {'precision': 0.42089295714542224, 'recall': 0.41474494242554627, 'f1-score': 0.409983324682837, 'support': 219939}, 'weighted avg': {'precision': 0.4214798772352167, 'recall': 0.41904346205084136, 'f1-score': 0.41255822856365276, 'support': 219939}}
[[41910 13183 20255]
 [29886 19748 17519]
 [31901 15031 30506]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0477796
{'0': {'precision': 0.4510008457851706, 'recall': 0.566827297852739, 'f1-score': 0.5023236827231049, 'support': 28222}, '1': {'precision': 0.45787173493241184, 'recall': 0.33386445325527103, 'f1-score': 0.3861566484517304, 'support': 26987}, '2': {'precision': 0.4464628952625033, 'recall': 0.4474916893321245, 'f1-score': 0.4469767003112914, 'support': 26472}, 'accuracy': 0.45118203743832713, 'macro avg': {'precision': 0.4517784919933619, 'recall': 0.4493944801467115, 'f1-score': 0.4451523438287089, 'support': 81681}, 'weighted avg': {'precision': 0.4518002490635407, 'recall': 0.45118203743832713, 'f1-score': 0.44600526017334285, 'support': 81681}}
[[15997  5369  6856]
 [10146  9010  7831]
 [ 9327  5299 11846]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0758051
{'0': {'precision': 0.41645387807213535, 'recall': 0.5856149012567325, 'f1-score': 0.48675620220108196, 'support': 8912}, '1': {'precision': 0.4170706371191136, 'recall': 0.2987721691678035, 'f1-score': 0.34814654238022974, 'support': 8063}, '2': {'precision': 0.4171050653840373, 'recall': 0.3474830954169797, 'f1-score': 0.3791242571213881, 'support': 7986}, 'accuracy': 0.4167701614518649, 'macro avg': {'precision': 0.41687652685842874, 'recall': 0.41062338861383857, 'f1-score': 0.4046756672342333, 'support': 24961}, 'weighted avg': {'precision': 0.416861446281287, 'recall': 0.4167701614518649, 'f1-score': 0.4075462987299884, 'support': 24961}}
[[5219 1700 1993]
 [3769 2409 1885]
 [3544 1667 2775]]
training model: results/CHTR/W2/deepOF_L2/h30
Epoch 1/50
320/320 - 12s - loss: 3.3333 - accuracy30: 0.3484 - val_loss: 3.3068 - val_accuracy30: 0.3638 - 12s/epoch - 38ms/step
Epoch 2/50
320/320 - 10s - loss: 3.2874 - accuracy30: 0.3718 - val_loss: 3.2848 - val_accuracy30: 0.3847 - 10s/epoch - 31ms/step
Epoch 3/50
320/320 - 10s - loss: 3.2636 - accuracy30: 0.3884 - val_loss: 3.2759 - val_accuracy30: 0.3880 - 10s/epoch - 33ms/step
Epoch 4/50
320/320 - 10s - loss: 3.2500 - accuracy30: 0.3960 - val_loss: 3.2688 - val_accuracy30: 0.3932 - 10s/epoch - 32ms/step
Epoch 5/50
320/320 - 10s - loss: 3.2366 - accuracy30: 0.4051 - val_loss: 3.2634 - val_accuracy30: 0.3965 - 10s/epoch - 32ms/step
Epoch 6/50
320/320 - 10s - loss: 3.2250 - accuracy30: 0.4116 - val_loss: 3.2648 - val_accuracy30: 0.3965 - 10s/epoch - 32ms/step
Epoch 7/50
320/320 - 10s - loss: 3.2162 - accuracy30: 0.4158 - val_loss: 3.2598 - val_accuracy30: 0.3992 - 10s/epoch - 32ms/step
Epoch 8/50
320/320 - 10s - loss: 3.2077 - accuracy30: 0.4219 - val_loss: 3.2592 - val_accuracy30: 0.3997 - 10s/epoch - 32ms/step
Epoch 9/50
320/320 - 10s - loss: 3.1982 - accuracy30: 0.4274 - val_loss: 3.2611 - val_accuracy30: 0.3975 - 10s/epoch - 31ms/step
Epoch 10/50
320/320 - 10s - loss: 3.1888 - accuracy30: 0.4306 - val_loss: 3.2614 - val_accuracy30: 0.4013 - 10s/epoch - 32ms/step
Epoch 11/50
320/320 - 10s - loss: 3.1808 - accuracy30: 0.4360 - val_loss: 3.2597 - val_accuracy30: 0.4026 - 10s/epoch - 32ms/step
Epoch 12/50
320/320 - 10s - loss: 3.1693 - accuracy30: 0.4403 - val_loss: 3.2612 - val_accuracy30: 0.4033 - 10s/epoch - 32ms/step
Epoch 13/50
320/320 - 10s - loss: 3.1615 - accuracy30: 0.4452 - val_loss: 3.2640 - val_accuracy30: 0.4034 - 10s/epoch - 32ms/step
Epoch 14/50
320/320 - 10s - loss: 3.1516 - accuracy30: 0.4481 - val_loss: 3.2618 - val_accuracy30: 0.4037 - 10s/epoch - 31ms/step
Epoch 15/50
320/320 - 11s - loss: 3.1448 - accuracy30: 0.4510 - val_loss: 3.2741 - val_accuracy30: 0.4035 - 11s/epoch - 33ms/step
Epoch 16/50
320/320 - 10s - loss: 3.1334 - accuracy30: 0.4569 - val_loss: 3.2797 - val_accuracy30: 0.4037 - 10s/epoch - 32ms/step
Epoch 17/50
320/320 - 11s - loss: 3.1228 - accuracy30: 0.4599 - val_loss: 3.2830 - val_accuracy30: 0.4036 - 11s/epoch - 33ms/step
Epoch 18/50
320/320 - 11s - loss: 3.1141 - accuracy30: 0.4641 - val_loss: 3.2861 - val_accuracy30: 0.4040 - 11s/epoch - 33ms/step
testing model: results/CHTR/W2/deepOF_L2/h30
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.082958
{'0': {'precision': 0.38701621921586105, 'recall': 0.6164818386370942, 'f1-score': 0.4755135668424614, 'support': 74664}, '1': {'precision': 0.40476662045289497, 'recall': 0.18225326991676574, 'f1-score': 0.2513374464508988, 'support': 67280}, '2': {'precision': 0.43701210544179203, 'recall': 0.3962048849285211, 'f1-score': 0.4156092181269207, 'support': 77995}, 'accuracy': 0.40553517111562754, 'macro avg': {'precision': 0.4095983150368494, 'recall': 0.39831333116079365, 'f1-score': 0.3808200771400936, 'support': 219939}, 'weighted avg': {'precision': 0.41017571408225184, 'recall': 0.40553517111562754, 'f1-score': 0.3856940757198641, 'support': 219939}}
[[46029  7992 20643]
 [35851 12262 19167]
 [37053 10040 30902]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0656834
{'0': {'precision': 0.42481426448737, 'recall': 0.6105278143574047, 'f1-score': 0.5010149393226923, 'support': 28097}, '1': {'precision': 0.4511125607016018, 'recall': 0.22879829430577509, 'f1-score': 0.30360975609756097, 'support': 27203}, '2': {'precision': 0.4190663176265271, 'recall': 0.43690534854630225, 'f1-score': 0.42779994432587914, 'support': 26381}, 'accuracy': 0.4273209191856123, 'macro avg': {'precision': 0.4316643809384996, 'recall': 0.425410485736494, 'f1-score': 0.41080821324871075, 'support': 81681}, 'weighted avg': {'precision': 0.43171618740432555, 'recall': 0.4273209191856123, 'f1-score': 0.4116245305093309, 'support': 81681}}
[[17154  3617  7326]
 [12327  6224  8652]
 [10899  3956 11526]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.086184
{'0': {'precision': 0.39246932731631645, 'recall': 0.6368421052631579, 'f1-score': 0.4856469767036035, 'support': 8740}, '1': {'precision': 0.4021035598705502, 'recall': 0.18114445389381606, 'f1-score': 0.2497696624507915, 'support': 8231}, '2': {'precision': 0.40404468957714607, 'recall': 0.35757196495619525, 'f1-score': 0.3793904787198725, 'support': 7990}, 'accuracy': 0.397179600176275, 'macro avg': {'precision': 0.39953919225467094, 'recall': 0.3918528413710564, 'f1-score': 0.3716023726247559, 'support': 24961}, 'weighted avg': {'precision': 0.3993515240479349, 'recall': 0.397179600176275, 'f1-score': 0.37385275401601464, 'support': 24961}}
[[5566 1053 2121]
 [4647 1491 2093]
 [3969 1164 2857]]
training model: results/CHTR/W2/deepOF_L2/h50
Epoch 1/50
320/320 - 13s - loss: 3.3318 - accuracy50: 0.3489 - val_loss: 3.3133 - val_accuracy50: 0.3597 - 13s/epoch - 39ms/step
Epoch 2/50
320/320 - 10s - loss: 3.2919 - accuracy50: 0.3703 - val_loss: 3.2942 - val_accuracy50: 0.3719 - 10s/epoch - 32ms/step
Epoch 3/50
320/320 - 10s - loss: 3.2723 - accuracy50: 0.3849 - val_loss: 3.2871 - val_accuracy50: 0.3767 - 10s/epoch - 32ms/step
Epoch 4/50
320/320 - 10s - loss: 3.2601 - accuracy50: 0.3910 - val_loss: 3.2811 - val_accuracy50: 0.3824 - 10s/epoch - 32ms/step
Epoch 5/50
320/320 - 11s - loss: 3.2499 - accuracy50: 0.3993 - val_loss: 3.2822 - val_accuracy50: 0.3826 - 11s/epoch - 33ms/step
Epoch 6/50
320/320 - 10s - loss: 3.2419 - accuracy50: 0.4021 - val_loss: 3.2815 - val_accuracy50: 0.3830 - 10s/epoch - 32ms/step
Epoch 7/50
320/320 - 10s - loss: 3.2324 - accuracy50: 0.4082 - val_loss: 3.2843 - val_accuracy50: 0.3829 - 10s/epoch - 31ms/step
Epoch 8/50
320/320 - 10s - loss: 3.2258 - accuracy50: 0.4137 - val_loss: 3.2736 - val_accuracy50: 0.3883 - 10s/epoch - 32ms/step
Epoch 9/50
320/320 - 10s - loss: 3.2161 - accuracy50: 0.4208 - val_loss: 3.2711 - val_accuracy50: 0.3929 - 10s/epoch - 32ms/step
Epoch 10/50
320/320 - 10s - loss: 3.2080 - accuracy50: 0.4245 - val_loss: 3.2813 - val_accuracy50: 0.3888 - 10s/epoch - 32ms/step
Epoch 11/50
320/320 - 10s - loss: 3.2007 - accuracy50: 0.4265 - val_loss: 3.2775 - val_accuracy50: 0.3893 - 10s/epoch - 31ms/step
Epoch 12/50
320/320 - 10s - loss: 3.1928 - accuracy50: 0.4310 - val_loss: 3.2821 - val_accuracy50: 0.3901 - 10s/epoch - 30ms/step
Epoch 13/50
320/320 - 10s - loss: 3.1865 - accuracy50: 0.4333 - val_loss: 3.2866 - val_accuracy50: 0.3961 - 10s/epoch - 31ms/step
Epoch 14/50
320/320 - 10s - loss: 3.1783 - accuracy50: 0.4375 - val_loss: 3.2872 - val_accuracy50: 0.3903 - 10s/epoch - 31ms/step
Epoch 15/50
320/320 - 10s - loss: 3.1679 - accuracy50: 0.4426 - val_loss: 3.2900 - val_accuracy50: 0.3902 - 10s/epoch - 31ms/step
Epoch 16/50
320/320 - 10s - loss: 3.1614 - accuracy50: 0.4443 - val_loss: 3.3023 - val_accuracy50: 0.3892 - 10s/epoch - 32ms/step
Epoch 17/50
320/320 - 10s - loss: 3.1513 - accuracy50: 0.4501 - val_loss: 3.3018 - val_accuracy50: 0.3867 - 10s/epoch - 31ms/step
Epoch 18/50
320/320 - 10s - loss: 3.1405 - accuracy50: 0.4539 - val_loss: 3.3029 - val_accuracy50: 0.3890 - 10s/epoch - 30ms/step
Epoch 19/50
320/320 - 10s - loss: 3.1312 - accuracy50: 0.4573 - val_loss: 3.3178 - val_accuracy50: 0.3880 - 10s/epoch - 31ms/step
testing model: results/CHTR/W2/deepOF_L2/h50
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0889417
{'0': {'precision': 0.3810136327787584, 'recall': 0.5505643892114831, 'f1-score': 0.45035956851777864, 'support': 73708}, '1': {'precision': 0.3782247606434346, 'recall': 0.20198329084827676, 'f1-score': 0.26333685524925554, 'support': 67867}, '2': {'precision': 0.4213996994351454, 'recall': 0.41507580011229644, 'f1-score': 0.41821384488788316, 'support': 78364}, 'accuracy': 0.39472762902441133, 'macro avg': {'precision': 0.3935460309524461, 'recall': 0.3892078267240188, 'f1-score': 0.3773034228849725, 'support': 219939}, 'weighted avg': {'precision': 0.394542571903939, 'recall': 0.39472762902441133, 'f1-score': 0.38119612789138685, 'support': 219939}}
[[40581 10106 23021]
 [32519 13708 21640]
 [33408 12429 32527]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0696006
{'0': {'precision': 0.4310660009276691, 'recall': 0.5575396125207326, 'f1-score': 0.486212839293408, 'support': 28337}, '1': {'precision': 0.4244152141514935, 'recall': 0.2463146811070999, 'f1-score': 0.31171921475312314, 'support': 26592}, '2': {'precision': 0.41260938608642767, 'recall': 0.45648923444976075, 'f1-score': 0.4334415872508829, 'support': 26752}, 'accuracy': 0.42312165619911607, 'macro avg': {'precision': 0.42269686705519677, 'recall': 0.42011450935919775, 'f1-score': 0.4104578804324713, 'support': 81681}, 'weighted avg': {'precision': 0.422855902101933, 'recall': 0.42312165619911607, 'f1-score': 0.4121213002767838, 'support': 81681}}
[[15799  4390  8148]
 [10805  6550  9237]
 [10047  4493 12212]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0903436
{'0': {'precision': 0.3852155410197809, 'recall': 0.5656752690660803, 'f1-score': 0.45832161275199246, 'support': 8641}, '1': {'precision': 0.39216135686454273, 'recall': 0.20840438489646773, 'f1-score': 0.2721705241390281, 'support': 8210}, '2': {'precision': 0.38677456062713367, 'recall': 0.3771886559802713, 'f1-score': 0.3819214682564455, 'support': 8110}, 'accuracy': 0.38692360081727495, 'macro avg': {'precision': 0.3880504861704857, 'recall': 0.3837561033142731, 'f1-score': 0.37080453504915534, 'support': 24961}, 'weighted avg': {'precision': 0.38800664702920057, 'recall': 0.38692360081727495, 'f1-score': 0.3722711496547078, 'support': 24961}}
[[4888 1307 2446]
 [4095 1711 2404]
 [3706 1345 3059]]
training model: results/CHTR/W2/deepOF_L2/h100
Epoch 1/50
320/320 - 12s - loss: 3.3331 - accuracy100: 0.3480 - val_loss: 3.3280 - val_accuracy100: 0.3475 - 12s/epoch - 38ms/step
Epoch 2/50
320/320 - 10s - loss: 3.3018 - accuracy100: 0.3613 - val_loss: 3.3130 - val_accuracy100: 0.3511 - 10s/epoch - 32ms/step
Epoch 3/50
320/320 - 10s - loss: 3.2861 - accuracy100: 0.3730 - val_loss: 3.3048 - val_accuracy100: 0.3617 - 10s/epoch - 32ms/step
Epoch 4/50
320/320 - 10s - loss: 3.2784 - accuracy100: 0.3769 - val_loss: 3.3024 - val_accuracy100: 0.3623 - 10s/epoch - 32ms/step
Epoch 5/50
320/320 - 10s - loss: 3.2693 - accuracy100: 0.3825 - val_loss: 3.2987 - val_accuracy100: 0.3651 - 10s/epoch - 32ms/step
Epoch 6/50
320/320 - 10s - loss: 3.2620 - accuracy100: 0.3879 - val_loss: 3.2979 - val_accuracy100: 0.3712 - 10s/epoch - 32ms/step
Epoch 7/50
320/320 - 10s - loss: 3.2557 - accuracy100: 0.3927 - val_loss: 3.3016 - val_accuracy100: 0.3646 - 10s/epoch - 32ms/step
Epoch 8/50
320/320 - 11s - loss: 3.2505 - accuracy100: 0.3973 - val_loss: 3.2975 - val_accuracy100: 0.3688 - 11s/epoch - 33ms/step
Epoch 9/50
320/320 - 10s - loss: 3.2434 - accuracy100: 0.3989 - val_loss: 3.3000 - val_accuracy100: 0.3710 - 10s/epoch - 32ms/step
Epoch 10/50
320/320 - 10s - loss: 3.2377 - accuracy100: 0.4031 - val_loss: 3.3029 - val_accuracy100: 0.3736 - 10s/epoch - 31ms/step
Epoch 11/50
320/320 - 10s - loss: 3.2312 - accuracy100: 0.4071 - val_loss: 3.2985 - val_accuracy100: 0.3726 - 10s/epoch - 32ms/step
Epoch 12/50
320/320 - 10s - loss: 3.2237 - accuracy100: 0.4094 - val_loss: 3.3075 - val_accuracy100: 0.3674 - 10s/epoch - 31ms/step
Epoch 13/50
320/320 - 10s - loss: 3.2178 - accuracy100: 0.4138 - val_loss: 3.3087 - val_accuracy100: 0.3730 - 10s/epoch - 31ms/step
Epoch 14/50
320/320 - 10s - loss: 3.2090 - accuracy100: 0.4175 - val_loss: 3.3084 - val_accuracy100: 0.3702 - 10s/epoch - 31ms/step
Epoch 15/50
320/320 - 10s - loss: 3.2023 - accuracy100: 0.4195 - val_loss: 3.3144 - val_accuracy100: 0.3730 - 10s/epoch - 32ms/step
Epoch 16/50
320/320 - 10s - loss: 3.1923 - accuracy100: 0.4293 - val_loss: 3.3163 - val_accuracy100: 0.3714 - 10s/epoch - 32ms/step
Epoch 17/50
320/320 - 10s - loss: 3.1837 - accuracy100: 0.4333 - val_loss: 3.3262 - val_accuracy100: 0.3679 - 10s/epoch - 31ms/step
Epoch 18/50
320/320 - 10s - loss: 3.1784 - accuracy100: 0.4349 - val_loss: 3.3362 - val_accuracy100: 0.3677 - 10s/epoch - 32ms/step
testing model: results/CHTR/W2/deepOF_L2/h100
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0939468
{'0': {'precision': 0.3617145966762945, 'recall': 0.588864658579801, 'f1-score': 0.44814978087804375, 'support': 73370}, '1': {'precision': 0.3427660645377775, 'recall': 0.09382175550316872, 'f1-score': 0.14731933611354814, 'support': 65326}, '2': {'precision': 0.41538256690835584, 'recall': 0.4223871595091269, 'f1-score': 0.4188555805097158, 'support': 81243}, 'accuracy': 0.38033272862020834, 'macro avg': {'precision': 0.37328774270747594, 'recall': 0.36835785786403225, 'f1-score': 0.33810823250043587, 'support': 219939}, 'weighted avg': {'precision': 0.37591087425818126, 'recall': 0.38033272862020834, 'f1-score': 0.3479765585063429, 'support': 219939}}
[[43205  5223 24942]
 [35842  6129 23355]
 [40398  6529 34316]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0839
{'0': {'precision': 0.39021332954921717, 'recall': 0.5935532611432889, 'f1-score': 0.4708685911614036, 'support': 27797}, '1': {'precision': 0.43137254901960786, 'recall': 0.11407042673828707, 'f1-score': 0.1804289465144408, 'support': 26808}, '2': {'precision': 0.39068399876199317, 'recall': 0.46620623430344216, 'f1-score': 0.42511703095005554, 'support': 27076}, 'accuracy': 0.3939716702782777, 'macro avg': {'precision': 0.40408995911027273, 'recall': 0.3912766407283394, 'f1-score': 0.3588048562086333, 'support': 81681}, 'weighted avg': {'precision': 0.4038779540661471, 'recall': 0.3939716702782777, 'f1-score': 0.3603793067748481, 'support': 81681}}
[[16499  1965  9333]
 [13396  3058 10354]
 [12387  2066 12623]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0986377
{'0': {'precision': 0.35990020098412917, 'recall': 0.6134672179562906, 'f1-score': 0.45365597973268096, 'support': 8465}, '1': {'precision': 0.3802889576883385, 'recall': 0.09027437530622244, 'f1-score': 0.14591170065333597, 'support': 8164}, '2': {'precision': 0.37526181056551083, 'recall': 0.3870619299087854, 'f1-score': 0.38107054236086496, 'support': 8332}, 'accuracy': 0.3667721645767397, 'macro avg': {'precision': 0.3718169897459928, 'recall': 0.3636011743904328, 'f1-score': 0.326879407582294, 'support': 24961}, 'weighted avg': {'precision': 0.37169647279876944, 'recall': 0.3667721645767397, 'f1-score': 0.3287729158095311, 'support': 24961}}
[[5193  616 2656]
 [4714  737 2713]
 [4522  585 3225]]
training model: results/CHTR/W2/deepOF_L2/h200
Epoch 1/50
320/320 - 13s - loss: 3.3392 - accuracy200: 0.3460 - val_loss: 3.3313 - val_accuracy200: 0.3428 - 13s/epoch - 39ms/step
Epoch 2/50
320/320 - 10s - loss: 3.3072 - accuracy200: 0.3567 - val_loss: 3.3169 - val_accuracy200: 0.3487 - 10s/epoch - 32ms/step
Epoch 3/50
320/320 - 10s - loss: 3.2965 - accuracy200: 0.3620 - val_loss: 3.3167 - val_accuracy200: 0.3495 - 10s/epoch - 32ms/step
Epoch 4/50
320/320 - 10s - loss: 3.2869 - accuracy200: 0.3674 - val_loss: 3.3124 - val_accuracy200: 0.3487 - 10s/epoch - 32ms/step
Epoch 5/50
320/320 - 10s - loss: 3.2810 - accuracy200: 0.3730 - val_loss: 3.3078 - val_accuracy200: 0.3520 - 10s/epoch - 32ms/step
Epoch 6/50
320/320 - 10s - loss: 3.2744 - accuracy200: 0.3779 - val_loss: 3.3085 - val_accuracy200: 0.3517 - 10s/epoch - 32ms/step
Epoch 7/50
320/320 - 10s - loss: 3.2682 - accuracy200: 0.3816 - val_loss: 3.3060 - val_accuracy200: 0.3543 - 10s/epoch - 32ms/step
Epoch 8/50
320/320 - 10s - loss: 3.2649 - accuracy200: 0.3843 - val_loss: 3.3084 - val_accuracy200: 0.3535 - 10s/epoch - 32ms/step
Epoch 9/50
320/320 - 10s - loss: 3.2591 - accuracy200: 0.3867 - val_loss: 3.3063 - val_accuracy200: 0.3562 - 10s/epoch - 31ms/step
Epoch 10/50
320/320 - 10s - loss: 3.2535 - accuracy200: 0.3901 - val_loss: 3.3095 - val_accuracy200: 0.3525 - 10s/epoch - 31ms/step
Epoch 11/50
320/320 - 10s - loss: 3.2476 - accuracy200: 0.3940 - val_loss: 3.3039 - val_accuracy200: 0.3587 - 10s/epoch - 31ms/step
Epoch 12/50
320/320 - 10s - loss: 3.2435 - accuracy200: 0.3986 - val_loss: 3.3072 - val_accuracy200: 0.3571 - 10s/epoch - 31ms/step
Epoch 13/50
320/320 - 10s - loss: 3.2390 - accuracy200: 0.4011 - val_loss: 3.3106 - val_accuracy200: 0.3572 - 10s/epoch - 32ms/step
Epoch 14/50
320/320 - 10s - loss: 3.2328 - accuracy200: 0.4039 - val_loss: 3.3184 - val_accuracy200: 0.3520 - 10s/epoch - 32ms/step
Epoch 15/50
320/320 - 10s - loss: 3.2271 - accuracy200: 0.4081 - val_loss: 3.3199 - val_accuracy200: 0.3546 - 10s/epoch - 32ms/step
Epoch 16/50
320/320 - 10s - loss: 3.2190 - accuracy200: 0.4117 - val_loss: 3.3276 - val_accuracy200: 0.3531 - 10s/epoch - 31ms/step
Epoch 17/50
320/320 - 10s - loss: 3.2130 - accuracy200: 0.4133 - val_loss: 3.3283 - val_accuracy200: 0.3539 - 10s/epoch - 33ms/step
Epoch 18/50
320/320 - 10s - loss: 3.2065 - accuracy200: 0.4170 - val_loss: 3.3297 - val_accuracy200: 0.3570 - 10s/epoch - 33ms/step
Epoch 19/50
320/320 - 10s - loss: 3.1974 - accuracy200: 0.4228 - val_loss: 3.3343 - val_accuracy200: 0.3556 - 10s/epoch - 33ms/step
Epoch 20/50
320/320 - 10s - loss: 3.1907 - accuracy200: 0.4265 - val_loss: 3.3441 - val_accuracy200: 0.3507 - 10s/epoch - 32ms/step
Epoch 21/50
320/320 - 10s - loss: 3.1834 - accuracy200: 0.4283 - val_loss: 3.3524 - val_accuracy200: 0.3494 - 10s/epoch - 32ms/step
testing model: results/CHTR/W2/deepOF_L2/h200
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0983558
{'0': {'precision': 0.34678395472135565, 'recall': 0.5629834636407666, 'f1-score': 0.4291946007817156, 'support': 72265}, '1': {'precision': 0.29047005040440743, 'recall': 0.07810505413455629, 'f1-score': 0.12310749549773335, 'support': 63453}, '2': {'precision': 0.4135976343809535, 'recall': 0.4201683665594092, 'f1-score': 0.4168571092001414, 'support': 84221}, 'accuracy': 0.3684066945834982, 'macro avg': {'precision': 0.35028387983557224, 'recall': 0.35375229477824405, 'f1-score': 0.32305306849319676, 'support': 219939}, 'weighted avg': {'precision': 0.3561221291423891, 'recall': 0.3684066945834982, 'f1-score': 0.336163255863005, 'support': 219939}}
[[40684  5297 26284]
 [34609  4956 23888]
 [42025  6809 35387]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0862466
{'0': {'precision': 0.3780563685387044, 'recall': 0.6019079068060906, 'f1-score': 0.4644151285245159, 'support': 27255}, '1': {'precision': 0.44312750908048176, 'recall': 0.08527074749852855, 'f1-score': 0.14302020669443158, 'support': 27184}, '2': {'precision': 0.38950902985751884, 'recall': 0.4726525218412745, 'f1-score': 0.4270717590673146, 'support': 27242}, 'accuracy': 0.3868586329746208, 'macro avg': {'precision': 0.403564302492235, 'recall': 0.38661039204863124, 'f1-score': 0.34483569809542064, 'support': 81681}, 'weighted avg': {'precision': 0.40353214973794066, 'recall': 0.3868586329746208, 'f1-score': 0.34499803488239483, 'support': 81681}}
[[16405  1385  9465]
 [14150  2318 10716]
 [12838  1528 12876]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1014346
{'0': {'precision': 0.34802704194260486, 'recall': 0.5965472389736313, 'f1-score': 0.43959395286019254, 'support': 8457}, '1': {'precision': 0.3450400492914356, 'recall': 0.06912726823848908, 'f1-score': 0.11517893870835048, 'support': 8101}, '2': {'precision': 0.3752544673150871, 'recall': 0.39485897893609423, 'f1-score': 0.3848071904899971, 'support': 8403}, 'accuracy': 0.35747766515764595, 'macro avg': {'precision': 0.3561071861830425, 'recall': 0.35351116204940486, 'f1-score': 0.31319336068618003, 'support': 24961}, 'weighted avg': {'precision': 0.35622360569957956, 'recall': 0.35747766515764595, 'f1-score': 0.3158625641401563, 'support': 24961}}
[[5045  545 2867]
 [4884  560 2657]
 [4567  518 3318]]
training model: results/CHTR/W2/deepOF_L2/h300
Epoch 1/50
320/320 - 13s - loss: 3.3419 - accuracy300: 0.3427 - val_loss: 3.3237 - val_accuracy300: 0.3426 - 13s/epoch - 40ms/step
Epoch 2/50
320/320 - 10s - loss: 3.3127 - accuracy300: 0.3506 - val_loss: 3.3221 - val_accuracy300: 0.3426 - 10s/epoch - 32ms/step
Epoch 3/50
320/320 - 10s - loss: 3.3015 - accuracy300: 0.3547 - val_loss: 3.3183 - val_accuracy300: 0.3455 - 10s/epoch - 31ms/step
Epoch 4/50
320/320 - 10s - loss: 3.2933 - accuracy300: 0.3598 - val_loss: 3.3136 - val_accuracy300: 0.3475 - 10s/epoch - 31ms/step
Epoch 5/50
320/320 - 10s - loss: 3.2870 - accuracy300: 0.3651 - val_loss: 3.3150 - val_accuracy300: 0.3465 - 10s/epoch - 31ms/step
Epoch 6/50
320/320 - 10s - loss: 3.2813 - accuracy300: 0.3699 - val_loss: 3.3126 - val_accuracy300: 0.3511 - 10s/epoch - 32ms/step
Epoch 7/50
320/320 - 10s - loss: 3.2756 - accuracy300: 0.3732 - val_loss: 3.3137 - val_accuracy300: 0.3492 - 10s/epoch - 31ms/step
Epoch 8/50
320/320 - 10s - loss: 3.2730 - accuracy300: 0.3761 - val_loss: 3.3151 - val_accuracy300: 0.3479 - 10s/epoch - 32ms/step
Epoch 9/50
320/320 - 10s - loss: 3.2662 - accuracy300: 0.3804 - val_loss: 3.3149 - val_accuracy300: 0.3499 - 10s/epoch - 32ms/step
Epoch 10/50
320/320 - 10s - loss: 3.2623 - accuracy300: 0.3849 - val_loss: 3.3193 - val_accuracy300: 0.3481 - 10s/epoch - 32ms/step
Epoch 11/50
320/320 - 10s - loss: 3.2574 - accuracy300: 0.3888 - val_loss: 3.3208 - val_accuracy300: 0.3504 - 10s/epoch - 32ms/step
Epoch 12/50
320/320 - 10s - loss: 3.2527 - accuracy300: 0.3904 - val_loss: 3.3234 - val_accuracy300: 0.3465 - 10s/epoch - 32ms/step
Epoch 13/50
320/320 - 10s - loss: 3.2457 - accuracy300: 0.3961 - val_loss: 3.3292 - val_accuracy300: 0.3469 - 10s/epoch - 32ms/step
Epoch 14/50
320/320 - 10s - loss: 3.2412 - accuracy300: 0.4001 - val_loss: 3.3294 - val_accuracy300: 0.3489 - 10s/epoch - 32ms/step
Epoch 15/50
320/320 - 10s - loss: 3.2338 - accuracy300: 0.4037 - val_loss: 3.3333 - val_accuracy300: 0.3457 - 10s/epoch - 32ms/step
Epoch 16/50
320/320 - 10s - loss: 3.2275 - accuracy300: 0.4060 - val_loss: 3.3422 - val_accuracy300: 0.3437 - 10s/epoch - 32ms/step
testing model: results/CHTR/W2/deepOF_L2/h300
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.097453
{'0': {'precision': 0.34108237055054025, 'recall': 0.6005682832081921, 'f1-score': 0.43507271597265385, 'support': 72851}, '1': {'precision': 0.2634089074767041, 'recall': 0.06018743608228411, 'f1-score': 0.09798569790927453, 'support': 59647}, '2': {'precision': 0.4183325644574299, 'recall': 0.37333745039512356, 'f1-score': 0.3945563431776017, 'support': 87441}, 'accuracy': 0.36367811074888945, 'macro avg': {'precision': 0.3409412808282248, 'recall': 0.34469772322853326, 'f1-score': 0.3092049190198433, 'support': 219939}, 'weighted avg': {'precision': 0.3507297962160531, 'recall': 0.36367811074888945, 'f1-score': 0.32754734975748256, 'support': 219939}}
[[43752  4364 24735]
 [35401  3590 20656]
 [49121  5675 32645]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0951113
{'0': {'precision': 0.3624700580569201, 'recall': 0.6502549162418063, 'f1-score': 0.4654727457574098, 'support': 27460}, '1': {'precision': 0.42592592592592593, 'recall': 0.05808512218673401, 'f1-score': 0.10222890384992483, 'support': 26926}, '2': {'precision': 0.3722823251121856, 'recall': 0.3920864627221103, 'f1-score': 0.3819278398344099, 'support': 27295}, 'accuracy': 0.3687760923593002, 'macro avg': {'precision': 0.3868927696983439, 'recall': 0.36680883371688355, 'f1-score': 0.3165431631472482, 'support': 81681}, 'weighted avg': {'precision': 0.38666709932128174, 'recall': 0.3687760923593002, 'f1-score': 0.3178121895158209, 'support': 81681}}
[[17856  1007  8597]
 [15914  1564  9448]
 [15492  1101 10702]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1041707
{'0': {'precision': 0.35030132068213876, 'recall': 0.6299285220198294, 'f1-score': 0.45023071852340146, 'support': 8674}, '1': {'precision': 0.2629757785467128, 'recall': 0.038919472538727434, 'f1-score': 0.06780417084866733, 'support': 7811}, '2': {'precision': 0.34702083587181676, 'recall': 0.3360075507314771, 'f1-score': 0.34142540310495717, 'support': 8476}, 'accuracy': 0.3451784784263451, 'macro avg': {'precision': 0.32009931170022277, 'recall': 0.3349518484300113, 'f1-score': 0.28648676415900864, 'support': 24961}, 'weighted avg': {'precision': 0.32186074542986115, 'recall': 0.3451784784263451, 'f1-score': 0.2936116881410417, 'support': 24961}}
[[5464  438 2772]
 [4920  304 2587]
 [5214  414 2848]]
training model: results/CHTR/W2/deepOF_L2/h500
Epoch 1/50
320/320 - 13s - loss: 3.3454 - accuracy500: 0.3424 - val_loss: 3.3116 - val_accuracy500: 0.3535 - 13s/epoch - 40ms/step
Epoch 2/50
320/320 - 10s - loss: 3.3155 - accuracy500: 0.3485 - val_loss: 3.3057 - val_accuracy500: 0.3491 - 10s/epoch - 33ms/step
Epoch 3/50
320/320 - 10s - loss: 3.3041 - accuracy500: 0.3550 - val_loss: 3.3045 - val_accuracy500: 0.3494 - 10s/epoch - 32ms/step
Epoch 4/50
320/320 - 10s - loss: 3.2965 - accuracy500: 0.3621 - val_loss: 3.3000 - val_accuracy500: 0.3552 - 10s/epoch - 32ms/step
Epoch 5/50
320/320 - 10s - loss: 3.2893 - accuracy500: 0.3656 - val_loss: 3.2999 - val_accuracy500: 0.3528 - 10s/epoch - 32ms/step
Epoch 6/50
320/320 - 10s - loss: 3.2846 - accuracy500: 0.3681 - val_loss: 3.2976 - val_accuracy500: 0.3536 - 10s/epoch - 32ms/step
Epoch 7/50
320/320 - 10s - loss: 3.2784 - accuracy500: 0.3737 - val_loss: 3.2978 - val_accuracy500: 0.3539 - 10s/epoch - 32ms/step
Epoch 8/50
320/320 - 10s - loss: 3.2761 - accuracy500: 0.3752 - val_loss: 3.3004 - val_accuracy500: 0.3557 - 10s/epoch - 32ms/step
Epoch 9/50
320/320 - 10s - loss: 3.2718 - accuracy500: 0.3797 - val_loss: 3.3015 - val_accuracy500: 0.3592 - 10s/epoch - 32ms/step
Epoch 10/50
320/320 - 10s - loss: 3.2681 - accuracy500: 0.3797 - val_loss: 3.3034 - val_accuracy500: 0.3576 - 10s/epoch - 32ms/step
Epoch 11/50
320/320 - 10s - loss: 3.2618 - accuracy500: 0.3847 - val_loss: 3.3037 - val_accuracy500: 0.3566 - 10s/epoch - 33ms/step
Epoch 12/50
320/320 - 10s - loss: 3.2574 - accuracy500: 0.3885 - val_loss: 3.3040 - val_accuracy500: 0.3565 - 10s/epoch - 33ms/step
Epoch 13/50
320/320 - 10s - loss: 3.2544 - accuracy500: 0.3897 - val_loss: 3.3081 - val_accuracy500: 0.3566 - 10s/epoch - 33ms/step
Epoch 14/50
320/320 - 10s - loss: 3.2484 - accuracy500: 0.3927 - val_loss: 3.3119 - val_accuracy500: 0.3544 - 10s/epoch - 32ms/step
Epoch 15/50
320/320 - 10s - loss: 3.2423 - accuracy500: 0.3979 - val_loss: 3.3115 - val_accuracy500: 0.3577 - 10s/epoch - 32ms/step
Epoch 16/50
320/320 - 10s - loss: 3.2348 - accuracy500: 0.4011 - val_loss: 3.3198 - val_accuracy500: 0.3517 - 10s/epoch - 32ms/step
testing model: results/CHTR/W2/deepOF_L2/h500
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.095944
{'0': {'precision': 0.3275151310735098, 'recall': 0.4905694799180443, 'f1-score': 0.3927929345139108, 'support': 71258}, '1': {'precision': 0.2694093510420041, 'recall': 0.0410976955640844, 'f1-score': 0.07131627840503073, 'support': 60709}, '2': {'precision': 0.40819094897252367, 'recall': 0.48230118674123584, 'f1-score': 0.4421621959607328, 'support': 87972}, 'accuracy': 0.3631961589349774, 'macro avg': {'precision': 0.3350384770293459, 'recall': 0.33798945407445485, 'f1-score': 0.3020904696265581, 'support': 219939}, 'weighted avg': {'precision': 0.34374540061315195, 'recall': 0.3631961589349774, 'f1-score': 0.32380374365774534, 'support': 219939}}
[[34957  2829 33472]
 [30171  2495 28043]
 [41606  3937 42429]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0960057
{'0': {'precision': 0.3605573880204599, 'recall': 0.5521393799641302, 'f1-score': 0.43624112552234706, 'support': 27321}, '1': {'precision': 0.4334705075445816, 'recall': 0.046877317905355285, 'f1-score': 0.08460508701472556, 'support': 26964}, '2': {'precision': 0.3661006851355377, 'recall': 0.4934661994451745, 'f1-score': 0.42034730967150163, 'support': 27396}, 'accuracy': 0.3656664340544313, 'macro avg': {'precision': 0.38670952690019306, 'recall': 0.3641609657715534, 'f1-score': 0.3137311740695248, 'support': 81681}, 'weighted avg': {'precision': 0.3864862273173966, 'recall': 0.3656664340544313, 'f1-score': 0.3148305022272201, 'support': 81681}}
[[15085   809 11427]
 [13719  1264 11981]
 [13034   843 13519]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0991689
{'0': {'precision': 0.35704323570432356, 'recall': 0.527170804255806, 'f1-score': 0.42574028733773733, 'support': 8741}, '1': {'precision': 0.3187721369539551, 'recall': 0.03615425816818425, 'f1-score': 0.06494287432351173, 'support': 7468}, '2': {'precision': 0.3628658101356174, 'recall': 0.46469378427787933, 'f1-score': 0.40751503006012024, 'support': 8752}, 'accuracy': 0.35835904010256, 'macro avg': {'precision': 0.34622706093129874, 'recall': 0.3426729489006232, 'f1-score': 0.29939939724045644, 'support': 24961}, 'weighted avg': {'precision': 0.34763458244343387, 'recall': 0.35835904010256, 'f1-score': 0.3114042217921285, 'support': 24961}}
[[4608  289 3844]
 [3901  270 3297]
 [4397  288 4067]]
training model: results/CHTR/W2/deepOF_L2/h1000
Epoch 1/50
320/320 - 12s - loss: 3.3503 - accuracy1000: 0.3419 - val_loss: 3.3168 - val_accuracy1000: 0.3448 - 12s/epoch - 39ms/step
Epoch 2/50
320/320 - 11s - loss: 3.3199 - accuracy1000: 0.3494 - val_loss: 3.3110 - val_accuracy1000: 0.3429 - 11s/epoch - 33ms/step
Epoch 3/50
320/320 - 11s - loss: 3.3072 - accuracy1000: 0.3572 - val_loss: 3.3043 - val_accuracy1000: 0.3466 - 11s/epoch - 33ms/step
Epoch 4/50
320/320 - 10s - loss: 3.2967 - accuracy1000: 0.3617 - val_loss: 3.3025 - val_accuracy1000: 0.3451 - 10s/epoch - 32ms/step
Epoch 5/50
320/320 - 10s - loss: 3.2916 - accuracy1000: 0.3654 - val_loss: 3.3037 - val_accuracy1000: 0.3412 - 10s/epoch - 32ms/step
Epoch 6/50
320/320 - 10s - loss: 3.2861 - accuracy1000: 0.3673 - val_loss: 3.3021 - val_accuracy1000: 0.3483 - 10s/epoch - 33ms/step
Epoch 7/50
320/320 - 10s - loss: 3.2814 - accuracy1000: 0.3695 - val_loss: 3.3055 - val_accuracy1000: 0.3447 - 10s/epoch - 32ms/step
Epoch 8/50
320/320 - 11s - loss: 3.2772 - accuracy1000: 0.3716 - val_loss: 3.3008 - val_accuracy1000: 0.3493 - 11s/epoch - 33ms/step
Epoch 9/50
320/320 - 10s - loss: 3.2708 - accuracy1000: 0.3779 - val_loss: 3.3050 - val_accuracy1000: 0.3463 - 10s/epoch - 32ms/step
Epoch 10/50
320/320 - 10s - loss: 3.2686 - accuracy1000: 0.3794 - val_loss: 3.3032 - val_accuracy1000: 0.3478 - 10s/epoch - 31ms/step
Epoch 11/50
320/320 - 10s - loss: 3.2636 - accuracy1000: 0.3839 - val_loss: 3.3061 - val_accuracy1000: 0.3463 - 10s/epoch - 31ms/step
Epoch 12/50
320/320 - 10s - loss: 3.2587 - accuracy1000: 0.3855 - val_loss: 3.3069 - val_accuracy1000: 0.3490 - 10s/epoch - 31ms/step
Epoch 13/50
320/320 - 10s - loss: 3.2551 - accuracy1000: 0.3887 - val_loss: 3.3126 - val_accuracy1000: 0.3480 - 10s/epoch - 31ms/step
Epoch 14/50
320/320 - 10s - loss: 3.2491 - accuracy1000: 0.3950 - val_loss: 3.3151 - val_accuracy1000: 0.3441 - 10s/epoch - 31ms/step
Epoch 15/50
320/320 - 10s - loss: 3.2423 - accuracy1000: 0.3967 - val_loss: 3.3161 - val_accuracy1000: 0.3465 - 10s/epoch - 32ms/step
Epoch 16/50
320/320 - 10s - loss: 3.2373 - accuracy1000: 0.3994 - val_loss: 3.3227 - val_accuracy1000: 0.3474 - 10s/epoch - 32ms/step
Epoch 17/50
320/320 - 10s - loss: 3.2320 - accuracy1000: 0.4038 - val_loss: 3.3236 - val_accuracy1000: 0.3490 - 10s/epoch - 32ms/step
Epoch 18/50
320/320 - 10s - loss: 3.2271 - accuracy1000: 0.4072 - val_loss: 3.3257 - val_accuracy1000: 0.3448 - 10s/epoch - 32ms/step
testing model: results/CHTR/W2/deepOF_L2/h1000
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011626
{'0': {'precision': 0.317224476513002, 'recall': 0.45693986669596426, 'f1-score': 0.3744747773055776, 'support': 68265}, '1': {'precision': 0.26893962517550823, 'recall': 0.14596690025346654, 'f1-score': 0.18922953020134228, 'support': 60363}, '2': {'precision': 0.4191297300947707, 'recall': 0.40781504966542914, 'f1-score': 0.413394983264597, 'support': 91311}, 'accuracy': 0.3511973774546579, 'macro avg': {'precision': 0.3350979439277603, 'recall': 0.3369072722049533, 'f1-score': 0.3256997635905056, 'support': 219939}, 'weighted avg': {'precision': 0.3462800425041166, 'recall': 0.3511973774546579, 'f1-score': 0.33979190648853774, 'support': 219939}}
[[31193  9904 27168]
 [27112  8811 24440]
 [40026 14047 37238]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0905215
{'0': {'precision': 0.3752638243984804, 'recall': 0.4795210183753461, 'f1-score': 0.42103435210911844, 'support': 27809}, '1': {'precision': 0.39522569444444444, 'recall': 0.16880468634139106, 'f1-score': 0.2365686376389899, 'support': 26972}, '2': {'precision': 0.3663720903367412, 'recall': 0.4715985130111524, 'f1-score': 0.4123785066475962, 'support': 26900}, 'accuracy': 0.3743098150120591, 'macro avg': {'precision': 0.3789538697265553, 'recall': 0.3733080725759632, 'f1-score': 0.3566604987985682, 'support': 81681}, 'weighted avg': {'precision': 0.37892714772482256, 'recall': 0.3743098150120591, 'f1-score': 0.3572710351369553, 'support': 81681}}
[[13335  3560 10914]
 [11393  4553 11026]
 [10807  3407 12686]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1022146
{'0': {'precision': 0.35707461130895507, 'recall': 0.4589194016521545, 'f1-score': 0.4016413462947584, 'support': 8958}, '1': {'precision': 0.2861851139796759, 'recall': 0.1387852956846031, 'f1-score': 0.18692259395461475, 'support': 7508}, '2': {'precision': 0.3461812990720914, 'recall': 0.3996468510888758, 'f1-score': 0.370997705168834, 'support': 8495}, 'accuracy': 0.34245422859661073, 'macro avg': {'precision': 0.32981367478690743, 'recall': 0.3324505161418778, 'f1-score': 0.31985388180606905, 'support': 24961}, 'weighted avg': {'precision': 0.33204448297273514, 'recall': 0.34245422859661073, 'f1-score': 0.3266272793930106, 'support': 24961}}
[[4111 1335 3512]
 [3566 1042 2900]
 [3836 1264 3395]]
training model: results/CHTR/W2/deepVOL_L2/h10
Epoch 1/50
320/320 - 12s - loss: 3.3343 - accuracy10: 0.3518 - val_loss: 3.3171 - val_accuracy10: 0.3533 - 12s/epoch - 38ms/step
Epoch 2/50
320/320 - 10s - loss: 3.2932 - accuracy10: 0.3702 - val_loss: 3.2895 - val_accuracy10: 0.3683 - 10s/epoch - 30ms/step
Epoch 3/50
320/320 - 10s - loss: 3.2703 - accuracy10: 0.3806 - val_loss: 3.2747 - val_accuracy10: 0.3765 - 10s/epoch - 30ms/step
Epoch 4/50
320/320 - 10s - loss: 3.2593 - accuracy10: 0.3851 - val_loss: 3.2611 - val_accuracy10: 0.3860 - 10s/epoch - 30ms/step
Epoch 5/50
320/320 - 10s - loss: 3.2450 - accuracy10: 0.3957 - val_loss: 3.2663 - val_accuracy10: 0.3801 - 10s/epoch - 30ms/step
Epoch 6/50
320/320 - 10s - loss: 3.2355 - accuracy10: 0.4010 - val_loss: 3.2560 - val_accuracy10: 0.3901 - 10s/epoch - 30ms/step
Epoch 7/50
320/320 - 10s - loss: 3.2287 - accuracy10: 0.4028 - val_loss: 3.2532 - val_accuracy10: 0.3883 - 10s/epoch - 31ms/step
Epoch 8/50
320/320 - 10s - loss: 3.2197 - accuracy10: 0.4102 - val_loss: 3.2492 - val_accuracy10: 0.3922 - 10s/epoch - 31ms/step
Epoch 9/50
320/320 - 10s - loss: 3.2149 - accuracy10: 0.4121 - val_loss: 3.2468 - val_accuracy10: 0.3964 - 10s/epoch - 31ms/step
Epoch 10/50
320/320 - 10s - loss: 3.2079 - accuracy10: 0.4158 - val_loss: 3.2429 - val_accuracy10: 0.3989 - 10s/epoch - 31ms/step
Epoch 11/50
320/320 - 10s - loss: 3.2019 - accuracy10: 0.4172 - val_loss: 3.2375 - val_accuracy10: 0.4003 - 10s/epoch - 30ms/step
Epoch 12/50
320/320 - 10s - loss: 3.1972 - accuracy10: 0.4217 - val_loss: 3.2329 - val_accuracy10: 0.4003 - 10s/epoch - 31ms/step
Epoch 13/50
320/320 - 10s - loss: 3.1907 - accuracy10: 0.4244 - val_loss: 3.2353 - val_accuracy10: 0.3972 - 10s/epoch - 30ms/step
Epoch 14/50
320/320 - 10s - loss: 3.1865 - accuracy10: 0.4262 - val_loss: 3.2317 - val_accuracy10: 0.3981 - 10s/epoch - 31ms/step
Epoch 15/50
320/320 - 10s - loss: 3.1818 - accuracy10: 0.4274 - val_loss: 3.2270 - val_accuracy10: 0.4025 - 10s/epoch - 30ms/step
Epoch 16/50
320/320 - 10s - loss: 3.1782 - accuracy10: 0.4292 - val_loss: 3.2339 - val_accuracy10: 0.4027 - 10s/epoch - 31ms/step
Epoch 17/50
320/320 - 10s - loss: 3.1726 - accuracy10: 0.4318 - val_loss: 3.2287 - val_accuracy10: 0.4040 - 10s/epoch - 31ms/step
Epoch 18/50
320/320 - 10s - loss: 3.1691 - accuracy10: 0.4322 - val_loss: 3.2325 - val_accuracy10: 0.4000 - 10s/epoch - 31ms/step
Epoch 19/50
320/320 - 10s - loss: 3.1674 - accuracy10: 0.4340 - val_loss: 3.2343 - val_accuracy10: 0.4008 - 10s/epoch - 31ms/step
Epoch 20/50
320/320 - 10s - loss: 3.1595 - accuracy10: 0.4369 - val_loss: 3.2310 - val_accuracy10: 0.3989 - 10s/epoch - 31ms/step
Epoch 21/50
320/320 - 10s - loss: 3.1565 - accuracy10: 0.4385 - val_loss: 3.2317 - val_accuracy10: 0.4038 - 10s/epoch - 31ms/step
Epoch 22/50
320/320 - 10s - loss: 3.1532 - accuracy10: 0.4380 - val_loss: 3.2301 - val_accuracy10: 0.4104 - 10s/epoch - 31ms/step
Epoch 23/50
320/320 - 10s - loss: 3.1504 - accuracy10: 0.4429 - val_loss: 3.2315 - val_accuracy10: 0.4084 - 10s/epoch - 31ms/step
Epoch 24/50
320/320 - 10s - loss: 3.1466 - accuracy10: 0.4425 - val_loss: 3.2344 - val_accuracy10: 0.4089 - 10s/epoch - 30ms/step
Epoch 25/50
320/320 - 10s - loss: 3.1421 - accuracy10: 0.4441 - val_loss: 3.2329 - val_accuracy10: 0.4057 - 10s/epoch - 31ms/step
testing model: results/CHTR/W2/deepVOL_L2/h10
Evaluating performance on  test set...
860/860 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0802546
{'0': {'precision': 0.4049758835167393, 'recall': 0.4011271213576689, 'f1-score': 0.4030423144239679, 'support': 78075}, '1': {'precision': 0.3953456967951026, 'recall': 0.2687000948389268, 'f1-score': 0.31994608673478686, 'support': 65374}, '2': {'precision': 0.3923853369865246, 'recall': 0.5036146153343356, 'f1-score': 0.4410959845197339, 'support': 76495}, 'accuracy': 0.3974102498817881, 'macro avg': {'precision': 0.3975689724327889, 'recall': 0.39114727717697706, 'f1-score': 0.3880281285594962, 'support': 219944}, 'weighted avg': {'precision': 0.397734596263761, 'recall': 0.3974102498817881, 'f1-score': 0.3915784086344174, 'support': 219944}}
[[31318 13391 33366]
 [21519 17566 26289]
 [24496 13475 38524]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0633019
{'0': {'precision': 0.4271964271964272, 'recall': 0.39792002868925946, 'f1-score': 0.4120388421619413, 'support': 27885}, '1': {'precision': 0.4612634088200238, 'recall': 0.3420616506463374, 'f1-score': 0.3928186258960858, 'support': 27153}, '2': {'precision': 0.39562015068031037, 'recall': 0.5281864584897162, 'f1-score': 0.45239166773820244, 'support': 26644}, 'accuracy': 0.4218432457579393, 'macro avg': {'precision': 0.4280266622322538, 'recall': 0.4227227126084377, 'f1-score': 0.4190830452654099, 'support': 81682}, 'weighted avg': {'precision': 0.4282211626403451, 'recall': 0.4218432457579393, 'f1-score': 0.41881235593960503, 'support': 81682}}
[[11096  5556 11233]
 [ 7599  9288 10266]
 [ 7279  5292 14073]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0771725
{'0': {'precision': 0.42334199525477345, 'recall': 0.41987897803675484, 'f1-score': 0.42160337552742616, 'support': 8924}, '1': {'precision': 0.4411350017624251, 'recall': 0.30513226868218946, 'f1-score': 0.3607407941197665, 'support': 8203}, '2': {'precision': 0.36594480643924876, 'recall': 0.4874904263466939, 'f1-score': 0.41806239737274214, 'support': 7834}, 'accuracy': 0.40338928728816953, 'macro avg': {'precision': 0.4101406011521491, 'recall': 0.40416722435521274, 'f1-score': 0.4001355223399783, 'support': 24961}, 'weighted avg': {'precision': 0.41117527337670157, 'recall': 0.40338928728816953, 'f1-score': 0.4004906084848066, 'support': 24961}}
[[3747 1702 3475]
 [2558 2503 3142]
 [2546 1469 3819]]
training model: results/CHTR/W2/deepVOL_L2/h20
Epoch 1/50
320/320 - 12s - loss: 3.3269 - accuracy20: 0.3587 - val_loss: 3.3089 - val_accuracy20: 0.3611 - 12s/epoch - 37ms/step
Epoch 2/50
320/320 - 10s - loss: 3.2935 - accuracy20: 0.3717 - val_loss: 3.2864 - val_accuracy20: 0.3748 - 10s/epoch - 30ms/step
Epoch 3/50
320/320 - 10s - loss: 3.2717 - accuracy20: 0.3807 - val_loss: 3.2789 - val_accuracy20: 0.3758 - 10s/epoch - 31ms/step
Epoch 4/50
320/320 - 10s - loss: 3.2602 - accuracy20: 0.3882 - val_loss: 3.2714 - val_accuracy20: 0.3841 - 10s/epoch - 31ms/step
Epoch 5/50
320/320 - 10s - loss: 3.2471 - accuracy20: 0.3934 - val_loss: 3.2718 - val_accuracy20: 0.3792 - 10s/epoch - 31ms/step
Epoch 6/50
320/320 - 10s - loss: 3.2399 - accuracy20: 0.3987 - val_loss: 3.2633 - val_accuracy20: 0.3839 - 10s/epoch - 30ms/step
Epoch 7/50
320/320 - 10s - loss: 3.2337 - accuracy20: 0.4054 - val_loss: 3.2556 - val_accuracy20: 0.3892 - 10s/epoch - 31ms/step
Epoch 8/50
320/320 - 10s - loss: 3.2268 - accuracy20: 0.4072 - val_loss: 3.2534 - val_accuracy20: 0.3885 - 10s/epoch - 30ms/step
Epoch 9/50
320/320 - 10s - loss: 3.2227 - accuracy20: 0.4107 - val_loss: 3.2519 - val_accuracy20: 0.3919 - 10s/epoch - 30ms/step
Epoch 10/50
320/320 - 10s - loss: 3.2160 - accuracy20: 0.4144 - val_loss: 3.2474 - val_accuracy20: 0.3973 - 10s/epoch - 30ms/step
Epoch 11/50
320/320 - 10s - loss: 3.2138 - accuracy20: 0.4138 - val_loss: 3.2481 - val_accuracy20: 0.3980 - 10s/epoch - 31ms/step
Epoch 12/50
320/320 - 10s - loss: 3.2085 - accuracy20: 0.4151 - val_loss: 3.2495 - val_accuracy20: 0.3926 - 10s/epoch - 30ms/step
Epoch 13/50
320/320 - 10s - loss: 3.2019 - accuracy20: 0.4195 - val_loss: 3.2482 - val_accuracy20: 0.3948 - 10s/epoch - 30ms/step
Epoch 14/50
320/320 - 10s - loss: 3.1999 - accuracy20: 0.4215 - val_loss: 3.2472 - val_accuracy20: 0.3960 - 10s/epoch - 31ms/step
Epoch 15/50
320/320 - 10s - loss: 3.1954 - accuracy20: 0.4241 - val_loss: 3.2426 - val_accuracy20: 0.3969 - 10s/epoch - 31ms/step
Epoch 16/50
320/320 - 10s - loss: 3.1906 - accuracy20: 0.4239 - val_loss: 3.2454 - val_accuracy20: 0.3990 - 10s/epoch - 31ms/step
Epoch 17/50
320/320 - 10s - loss: 3.1879 - accuracy20: 0.4267 - val_loss: 3.2415 - val_accuracy20: 0.4020 - 10s/epoch - 30ms/step
Epoch 18/50
320/320 - 10s - loss: 3.1804 - accuracy20: 0.4290 - val_loss: 3.2450 - val_accuracy20: 0.3985 - 10s/epoch - 30ms/step
Epoch 19/50
320/320 - 10s - loss: 3.1768 - accuracy20: 0.4305 - val_loss: 3.2500 - val_accuracy20: 0.4010 - 10s/epoch - 30ms/step
Epoch 20/50
320/320 - 10s - loss: 3.1754 - accuracy20: 0.4316 - val_loss: 3.2398 - val_accuracy20: 0.4050 - 10s/epoch - 30ms/step
Epoch 21/50
320/320 - 10s - loss: 3.1694 - accuracy20: 0.4338 - val_loss: 3.2433 - val_accuracy20: 0.4021 - 10s/epoch - 31ms/step
Epoch 22/50
320/320 - 10s - loss: 3.1665 - accuracy20: 0.4341 - val_loss: 3.2426 - val_accuracy20: 0.4040 - 10s/epoch - 31ms/step
Epoch 23/50
320/320 - 10s - loss: 3.1601 - accuracy20: 0.4349 - val_loss: 3.2556 - val_accuracy20: 0.4001 - 10s/epoch - 30ms/step
Epoch 24/50
320/320 - 10s - loss: 3.1596 - accuracy20: 0.4360 - val_loss: 3.2480 - val_accuracy20: 0.4043 - 10s/epoch - 31ms/step
Epoch 25/50
320/320 - 10s - loss: 3.1540 - accuracy20: 0.4405 - val_loss: 3.2512 - val_accuracy20: 0.4005 - 10s/epoch - 31ms/step
Epoch 26/50
320/320 - 10s - loss: 3.1481 - accuracy20: 0.4437 - val_loss: 3.2492 - val_accuracy20: 0.4009 - 10s/epoch - 31ms/step
Epoch 27/50
320/320 - 10s - loss: 3.1444 - accuracy20: 0.4420 - val_loss: 3.2483 - val_accuracy20: 0.4001 - 10s/epoch - 31ms/step
Epoch 28/50
320/320 - 10s - loss: 3.1429 - accuracy20: 0.4445 - val_loss: 3.2528 - val_accuracy20: 0.3990 - 10s/epoch - 31ms/step
Epoch 29/50
320/320 - 10s - loss: 3.1402 - accuracy20: 0.4454 - val_loss: 3.2539 - val_accuracy20: 0.3987 - 10s/epoch - 31ms/step
Epoch 30/50
320/320 - 10s - loss: 3.1337 - accuracy20: 0.4479 - val_loss: 3.2543 - val_accuracy20: 0.4011 - 10s/epoch - 30ms/step
testing model: results/CHTR/W2/deepVOL_L2/h20
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0873399
{'0': {'precision': 0.3782868138504212, 'recall': 0.49050418718231165, 'f1-score': 0.42714822305691996, 'support': 75349}, '1': {'precision': 0.40559992112787147, 'recall': 0.24504504504504504, 'f1-score': 0.30551300973757733, 'support': 67155}, '2': {'precision': 0.3997747058319355, 'recall': 0.4216167355371901, 'f1-score': 0.410405314528851, 'support': 77440}, 'accuracy': 0.39130415014731024, 'macro avg': {'precision': 0.3945538136034094, 'recall': 0.3857219892548489, 'f1-score': 0.381022182441116, 'support': 219944}, 'weighted avg': {'precision': 0.39419192639845907, 'recall': 0.39130415014731024, 'f1-score': 0.3841146163803381, 'support': 219944}}
[[36959 11393 26997]
 [28675 16456 22024]
 [32067 12723 32650]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.062695
{'0': {'precision': 0.4284185680566483, 'recall': 0.4832960556679803, 'f1-score': 0.4542057322078009, 'support': 28167}, '1': {'precision': 0.4550907035052357, 'recall': 0.34118384195783574, 'f1-score': 0.3899900996355823, 'support': 27132}, '2': {'precision': 0.40360549279577895, 'recall': 0.4522988287912671, 'f1-score': 0.4265670521367674, 'support': 26383}, 'accuracy': 0.42607918513258736, 'macro avg': {'precision': 0.4290382547858876, 'recall': 0.4255929088056944, 'f1-score': 0.4235876279933835, 'support': 81682}, 'weighted avg': {'precision': 0.429263613652784, 'recall': 0.42607918513258736, 'f1-score': 0.4239482723113303, 'support': 81682}}
[[13613  5446  9108]
 [ 9350  9257  8525]
 [ 8812  5638 11933]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0796187
{'0': {'precision': 0.41272311212814644, 'recall': 0.507999098693105, 'f1-score': 0.4554315438614212, 'support': 8876}, '1': {'precision': 0.42708534001155846, 'recall': 0.275677692116389, 'f1-score': 0.3350714123781456, 'support': 8042}, '2': {'precision': 0.38405879027699263, 'recall': 0.422354842720378, 'f1-score': 0.4022974893415443, 'support': 8043}, 'accuracy': 0.4055526621529586, 'macro avg': {'precision': 0.40795574747223257, 'recall': 0.4020105445099573, 'f1-score': 0.39760014852703707, 'support': 24961}, 'weighted avg': {'precision': 0.40811407787429316, 'recall': 0.4055526621529586, 'f1-score': 0.3995326064033116, 'support': 24961}}
[[4509 1476 2891]
 [3268 2217 2557]
 [3148 1498 3397]]
training model: results/CHTR/W2/deepVOL_L2/h30
Epoch 1/50
320/320 - 13s - loss: 3.3271 - accuracy30: 0.3529 - val_loss: 3.3151 - val_accuracy30: 0.3604 - 13s/epoch - 40ms/step
Epoch 2/50
320/320 - 10s - loss: 3.2954 - accuracy30: 0.3660 - val_loss: 3.2930 - val_accuracy30: 0.3712 - 10s/epoch - 31ms/step
Epoch 3/50
320/320 - 10s - loss: 3.2733 - accuracy30: 0.3786 - val_loss: 3.2904 - val_accuracy30: 0.3615 - 10s/epoch - 31ms/step
Epoch 4/50
320/320 - 10s - loss: 3.2643 - accuracy30: 0.3857 - val_loss: 3.2825 - val_accuracy30: 0.3723 - 10s/epoch - 31ms/step
Epoch 5/50
320/320 - 10s - loss: 3.2529 - accuracy30: 0.3918 - val_loss: 3.2740 - val_accuracy30: 0.3777 - 10s/epoch - 31ms/step
Epoch 6/50
320/320 - 10s - loss: 3.2465 - accuracy30: 0.3965 - val_loss: 3.2749 - val_accuracy30: 0.3758 - 10s/epoch - 30ms/step
Epoch 7/50
320/320 - 10s - loss: 3.2388 - accuracy30: 0.3972 - val_loss: 3.2687 - val_accuracy30: 0.3834 - 10s/epoch - 31ms/step
Epoch 8/50
320/320 - 10s - loss: 3.2330 - accuracy30: 0.4048 - val_loss: 3.2687 - val_accuracy30: 0.3803 - 10s/epoch - 31ms/step
Epoch 9/50
320/320 - 10s - loss: 3.2282 - accuracy30: 0.4050 - val_loss: 3.2664 - val_accuracy30: 0.3851 - 10s/epoch - 31ms/step
Epoch 10/50
320/320 - 10s - loss: 3.2244 - accuracy30: 0.4074 - val_loss: 3.2654 - val_accuracy30: 0.3856 - 10s/epoch - 30ms/step
Epoch 11/50
320/320 - 10s - loss: 3.2188 - accuracy30: 0.4117 - val_loss: 3.2641 - val_accuracy30: 0.3844 - 10s/epoch - 31ms/step
Epoch 12/50
320/320 - 10s - loss: 3.2158 - accuracy30: 0.4128 - val_loss: 3.2666 - val_accuracy30: 0.3904 - 10s/epoch - 30ms/step
Epoch 13/50
320/320 - 10s - loss: 3.2063 - accuracy30: 0.4173 - val_loss: 3.2680 - val_accuracy30: 0.3816 - 10s/epoch - 31ms/step
Epoch 14/50
320/320 - 10s - loss: 3.2060 - accuracy30: 0.4175 - val_loss: 3.2681 - val_accuracy30: 0.3873 - 10s/epoch - 31ms/step
Epoch 15/50
320/320 - 10s - loss: 3.2017 - accuracy30: 0.4194 - val_loss: 3.2641 - val_accuracy30: 0.3891 - 10s/epoch - 31ms/step
Epoch 16/50
320/320 - 10s - loss: 3.1953 - accuracy30: 0.4220 - val_loss: 3.2729 - val_accuracy30: 0.3805 - 10s/epoch - 30ms/step
Epoch 17/50
320/320 - 10s - loss: 3.1902 - accuracy30: 0.4258 - val_loss: 3.2720 - val_accuracy30: 0.3848 - 10s/epoch - 30ms/step
Epoch 18/50
320/320 - 10s - loss: 3.1895 - accuracy30: 0.4232 - val_loss: 3.2739 - val_accuracy30: 0.3842 - 10s/epoch - 30ms/step
Epoch 19/50
320/320 - 10s - loss: 3.1821 - accuracy30: 0.4287 - val_loss: 3.2746 - val_accuracy30: 0.3840 - 10s/epoch - 30ms/step
Epoch 20/50
320/320 - 10s - loss: 3.1791 - accuracy30: 0.4298 - val_loss: 3.2709 - val_accuracy30: 0.3898 - 10s/epoch - 31ms/step
Epoch 21/50
320/320 - 10s - loss: 3.1751 - accuracy30: 0.4291 - val_loss: 3.2731 - val_accuracy30: 0.3889 - 10s/epoch - 30ms/step
testing model: results/CHTR/W2/deepVOL_L2/h30
Evaluating performance on  test set...
860/860 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0889877
{'0': {'precision': 0.3708720973405327, 'recall': 0.46823813031540884, 'f1-score': 0.4139061871048706, 'support': 74665}, '1': {'precision': 0.3798985271288478, 'recall': 0.2982521328141256, 'f1-score': 0.3341603943249184, 'support': 67282}, '2': {'precision': 0.40484524054629056, 'recall': 0.37815557008602896, 'f1-score': 0.3910455280672447, 'support': 77997}, 'accuracy': 0.3842932746517295, 'macro avg': {'precision': 0.38520528833855705, 'recall': 0.38154861107185445, 'f1-score': 0.3797040364990112, 'support': 219944}, 'weighted avg': {'precision': 0.38568095550277814, 'recall': 0.3842932746517295, 'f1-score': 0.3814046446541629, 'support': 219944}}
[[34961 15867 23837]
 [27692 20067 19523]
 [31614 16888 29495]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0740197
{'0': {'precision': 0.4184304239736612, 'recall': 0.442923186344239, 'f1-score': 0.43032857685796216, 'support': 28120}, '1': {'precision': 0.4219004524886878, 'recall': 0.3426051809663788, 'f1-score': 0.3781405251951739, 'support': 27215}, '2': {'precision': 0.3902938019855111, 'recall': 0.4416821649523665, 'f1-score': 0.41440094012072004, 'support': 26347}, 'accuracy': 0.40909869983594915, 'macro avg': {'precision': 0.4102082261492867, 'recall': 0.4090701774209948, 'f1-score': 0.40762334739128536, 'support': 81682}, 'weighted avg': {'precision': 0.41051094656755777, 'recall': 0.40909869983594915, 'f1-score': 0.40780288856532854, 'support': 81682}}
[[12455  6435  9230]
 [ 8942  9324  8949]
 [ 8369  6341 11637]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0889736
{'0': {'precision': 0.3924921018398067, 'recall': 0.48518263266712613, 'f1-score': 0.4339428806246147, 'support': 8706}, '1': {'precision': 0.3807272134355128, 'recall': 0.282585017548106, 'f1-score': 0.3243956654626285, 'support': 8263}, '2': {'precision': 0.3708157698983387, 'recall': 0.37424924924924924, 'f1-score': 0.37252459833104995, 'support': 7992}, 'accuracy': 0.3825968510876968, 'macro avg': {'precision': 0.3813450283912194, 'recall': 0.3806722998214938, 'f1-score': 0.37695438147276433, 'support': 24961}, 'weighted avg': {'precision': 0.3816571786491936, 'recall': 0.3825968510876968, 'f1-score': 0.3780138893592944, 'support': 24961}}
[[4224 1934 2548]
 [3401 2335 2527]
 [3137 1864 2991]]
training model: results/CHTR/W2/deepVOL_L2/h50
Epoch 1/50
320/320 - 12s - loss: 3.3313 - accuracy50: 0.3546 - val_loss: 3.3230 - val_accuracy50: 0.3564 - 12s/epoch - 38ms/step
Epoch 2/50
320/320 - 10s - loss: 3.2972 - accuracy50: 0.3693 - val_loss: 3.3061 - val_accuracy50: 0.3607 - 10s/epoch - 31ms/step
Epoch 3/50
320/320 - 10s - loss: 3.2794 - accuracy50: 0.3758 - val_loss: 3.3043 - val_accuracy50: 0.3624 - 10s/epoch - 31ms/step
Epoch 4/50
320/320 - 10s - loss: 3.2696 - accuracy50: 0.3814 - val_loss: 3.2995 - val_accuracy50: 0.3649 - 10s/epoch - 31ms/step
Epoch 5/50
320/320 - 10s - loss: 3.2619 - accuracy50: 0.3863 - val_loss: 3.2923 - val_accuracy50: 0.3673 - 10s/epoch - 31ms/step
Epoch 6/50
320/320 - 10s - loss: 3.2575 - accuracy50: 0.3873 - val_loss: 3.2897 - val_accuracy50: 0.3683 - 10s/epoch - 31ms/step
Epoch 7/50
320/320 - 10s - loss: 3.2511 - accuracy50: 0.3940 - val_loss: 3.2878 - val_accuracy50: 0.3702 - 10s/epoch - 32ms/step
Epoch 8/50
320/320 - 10s - loss: 3.2442 - accuracy50: 0.3976 - val_loss: 3.2872 - val_accuracy50: 0.3684 - 10s/epoch - 31ms/step
Epoch 9/50
320/320 - 10s - loss: 3.2418 - accuracy50: 0.3986 - val_loss: 3.2862 - val_accuracy50: 0.3733 - 10s/epoch - 31ms/step
Epoch 10/50
320/320 - 10s - loss: 3.2362 - accuracy50: 0.4050 - val_loss: 3.2876 - val_accuracy50: 0.3749 - 10s/epoch - 31ms/step
Epoch 11/50
320/320 - 10s - loss: 3.2317 - accuracy50: 0.4042 - val_loss: 3.2838 - val_accuracy50: 0.3732 - 10s/epoch - 30ms/step
Epoch 12/50
320/320 - 10s - loss: 3.2292 - accuracy50: 0.4057 - val_loss: 3.2870 - val_accuracy50: 0.3710 - 10s/epoch - 30ms/step
Epoch 13/50
320/320 - 10s - loss: 3.2283 - accuracy50: 0.4072 - val_loss: 3.2862 - val_accuracy50: 0.3788 - 10s/epoch - 31ms/step
Epoch 14/50
320/320 - 10s - loss: 3.2221 - accuracy50: 0.4114 - val_loss: 3.2885 - val_accuracy50: 0.3776 - 10s/epoch - 31ms/step
Epoch 15/50
320/320 - 10s - loss: 3.2185 - accuracy50: 0.4114 - val_loss: 3.2872 - val_accuracy50: 0.3781 - 10s/epoch - 30ms/step
Epoch 16/50
320/320 - 10s - loss: 3.2131 - accuracy50: 0.4165 - val_loss: 3.2972 - val_accuracy50: 0.3797 - 10s/epoch - 30ms/step
Epoch 17/50
320/320 - 10s - loss: 3.2115 - accuracy50: 0.4168 - val_loss: 3.2927 - val_accuracy50: 0.3760 - 10s/epoch - 30ms/step
Epoch 18/50
320/320 - 10s - loss: 3.2056 - accuracy50: 0.4170 - val_loss: 3.2937 - val_accuracy50: 0.3787 - 10s/epoch - 30ms/step
Epoch 19/50
320/320 - 10s - loss: 3.2021 - accuracy50: 0.4204 - val_loss: 3.2958 - val_accuracy50: 0.3751 - 10s/epoch - 31ms/step
Epoch 20/50
320/320 - 10s - loss: 3.1988 - accuracy50: 0.4203 - val_loss: 3.2926 - val_accuracy50: 0.3806 - 10s/epoch - 31ms/step
Epoch 21/50
320/320 - 10s - loss: 3.1963 - accuracy50: 0.4219 - val_loss: 3.2967 - val_accuracy50: 0.3773 - 10s/epoch - 31ms/step
testing model: results/CHTR/W2/deepVOL_L2/h50
Evaluating performance on  test set...
860/860 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0945147
{'0': {'precision': 0.3650358740394296, 'recall': 0.3886092607415648, 'f1-score': 0.3764538895241099, 'support': 73709}, '1': {'precision': 0.34823933025503817, 'recall': 0.4756074201771059, 'f1-score': 0.40207771501174006, 'support': 67869}, '2': {'precision': 0.41040936391775823, 'recall': 0.25548069315774696, 'f1-score': 0.3149218633257045, 'support': 78366}, 'accuracy': 0.36802095078747316, 'macro avg': {'precision': 0.37456152273740867, 'recall': 0.3732324580254725, 'f1-score': 0.3644844892871848, 'support': 219944}, 'weighted avg': {'precision': 0.3760194620332018, 'recall': 0.36802095078747316, 'f1-score': 0.362436888137192, 'support': 219944}}
[[28644 29400 15665]
 [22493 32279 13097]
 [27332 31013 20021]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0811534
{'0': {'precision': 0.4165634839211802, 'recall': 0.41553446024632107, 'f1-score': 0.41604833580665684, 'support': 28337}, '1': {'precision': 0.37978966924327373, 'recall': 0.43029505732005263, 'f1-score': 0.40346796362867415, 'support': 26605}, '2': {'precision': 0.4033172911653489, 'recall': 0.35100972326103214, 'f1-score': 0.3753499160201551, 'support': 26740}, 'accuracy': 0.39921892216155336, 'macro avg': {'precision': 0.39989014810993423, 'recall': 0.39894641360913524, 'f1-score': 0.39828873848516205, 'support': 81682}, 'weighted avg': {'precision': 0.4002493567720331, 'recall': 0.39921892216155336, 'f1-score': 0.39862740406054037, 'support': 81682}}
[[11775  9566  6996]
 [ 8267 11448  6890]
 [ 8225  9129  9386]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0938836
{'0': {'precision': 0.3902668759811617, 'recall': 0.4327492166647325, 'f1-score': 0.410411622276029, 'support': 8617}, '1': {'precision': 0.3711435623200329, 'recall': 0.4370307580527973, 'f1-score': 0.40140140140140146, 'support': 8258}, '2': {'precision': 0.37416402675114396, 'recall': 0.26292357160524366, 'f1-score': 0.3088320743753632, 'support': 8086}, 'accuracy': 0.37915147630303275, 'macro avg': {'precision': 0.37852482168411283, 'recall': 0.3775678487742578, 'f1-score': 0.37354836601759783, 'support': 24961}, 'weighted avg': {'precision': 0.3787237501814131, 'recall': 0.37915147630303275, 'f1-score': 0.37452449322240705, 'support': 24961}}
[[3729 3101 1787]
 [2880 3609 1769]
 [2946 3014 2126]]
training model: results/CHTR/W2/deepVOL_L2/h100
Epoch 1/50
320/320 - 12s - loss: 3.3396 - accuracy100: 0.3486 - val_loss: 3.3260 - val_accuracy100: 0.3408 - 12s/epoch - 38ms/step
Epoch 2/50
320/320 - 10s - loss: 3.3075 - accuracy100: 0.3563 - val_loss: 3.3126 - val_accuracy100: 0.3390 - 10s/epoch - 31ms/step
Epoch 3/50
320/320 - 10s - loss: 3.2931 - accuracy100: 0.3632 - val_loss: 3.3039 - val_accuracy100: 0.3442 - 10s/epoch - 30ms/step
Epoch 4/50
320/320 - 10s - loss: 3.2818 - accuracy100: 0.3714 - val_loss: 3.3036 - val_accuracy100: 0.3460 - 10s/epoch - 31ms/step
Epoch 5/50
320/320 - 10s - loss: 3.2781 - accuracy100: 0.3738 - val_loss: 3.2995 - val_accuracy100: 0.3475 - 10s/epoch - 31ms/step
Epoch 6/50
320/320 - 10s - loss: 3.2725 - accuracy100: 0.3777 - val_loss: 3.2949 - val_accuracy100: 0.3519 - 10s/epoch - 31ms/step
Epoch 7/50
320/320 - 10s - loss: 3.2688 - accuracy100: 0.3794 - val_loss: 3.2944 - val_accuracy100: 0.3513 - 10s/epoch - 32ms/step
Epoch 8/50
320/320 - 10s - loss: 3.2662 - accuracy100: 0.3819 - val_loss: 3.2941 - val_accuracy100: 0.3520 - 10s/epoch - 30ms/step
Epoch 9/50
320/320 - 10s - loss: 3.2647 - accuracy100: 0.3834 - val_loss: 3.2926 - val_accuracy100: 0.3517 - 10s/epoch - 30ms/step
Epoch 10/50
320/320 - 10s - loss: 3.2603 - accuracy100: 0.3862 - val_loss: 3.2938 - val_accuracy100: 0.3534 - 10s/epoch - 31ms/step
Epoch 11/50
320/320 - 10s - loss: 3.2579 - accuracy100: 0.3910 - val_loss: 3.2936 - val_accuracy100: 0.3549 - 10s/epoch - 30ms/step
Epoch 12/50
320/320 - 10s - loss: 3.2539 - accuracy100: 0.3921 - val_loss: 3.2962 - val_accuracy100: 0.3544 - 10s/epoch - 31ms/step
Epoch 13/50
320/320 - 10s - loss: 3.2510 - accuracy100: 0.3917 - val_loss: 3.2986 - val_accuracy100: 0.3528 - 10s/epoch - 31ms/step
Epoch 14/50
320/320 - 10s - loss: 3.2476 - accuracy100: 0.3962 - val_loss: 3.2962 - val_accuracy100: 0.3544 - 10s/epoch - 30ms/step
Epoch 15/50
320/320 - 10s - loss: 3.2454 - accuracy100: 0.3968 - val_loss: 3.2970 - val_accuracy100: 0.3555 - 10s/epoch - 31ms/step
Epoch 16/50
320/320 - 10s - loss: 3.2420 - accuracy100: 0.3982 - val_loss: 3.3010 - val_accuracy100: 0.3558 - 10s/epoch - 31ms/step
Epoch 17/50
320/320 - 10s - loss: 3.2386 - accuracy100: 0.4015 - val_loss: 3.3043 - val_accuracy100: 0.3508 - 10s/epoch - 31ms/step
Epoch 18/50
320/320 - 10s - loss: 3.2352 - accuracy100: 0.4017 - val_loss: 3.3032 - val_accuracy100: 0.3531 - 10s/epoch - 31ms/step
Epoch 19/50
320/320 - 10s - loss: 3.2311 - accuracy100: 0.4039 - val_loss: 3.3051 - val_accuracy100: 0.3547 - 10s/epoch - 31ms/step
testing model: results/CHTR/W2/deepVOL_L2/h100
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1014209
{'0': {'precision': 0.33513346985375403, 'recall': 0.2520443766014283, 'f1-score': 0.28771012734047435, 'support': 73372}, '1': {'precision': 0.30645002267663124, 'recall': 0.47579102055811534, 'f1-score': 0.3727908943167439, 'support': 65327}, '2': {'precision': 0.384167232423386, 'recall': 0.29948919933534374, 'f1-score': 0.3365840837725305, 'support': 81245}, 'accuracy': 0.3360264430946059, 'macro avg': {'precision': 0.3419169083179237, 'recall': 0.3424415321649625, 'f1-score': 0.33236170180991625, 'support': 219944}, 'weighted avg': {'precision': 0.3447265684889969, 'recall': 0.3360264430946059, 'f1-score': 0.33103404549500987, 'support': 219944}}
[[18493 33869 21010]
 [16250 31082 17995]
 [20438 36475 24332]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0925931
{'0': {'precision': 0.3952050945870013, 'recall': 0.3037610221342451, 'f1-score': 0.34350135324881464, 'support': 27785}, '1': {'precision': 0.3534517624366114, 'recall': 0.4225776455272457, 'f1-score': 0.3849359625940232, 'support': 26885}, '2': {'precision': 0.3611396941418586, 'recall': 0.37679549829705317, 'f1-score': 0.3688015218769817, 'support': 27012}, 'accuracy': 0.3670208858744889, 'macro avg': {'precision': 0.36993218372182374, 'recall': 0.367711388652848, 'f1-score': 0.3657462792399399, 'support': 81682}, 'weighted avg': {'precision': 0.37019697857995654, 'recall': 0.3670208858744889, 'f1-score': 0.36550592741729704, 'support': 81682}}
[[ 8440 10387  8958]
 [ 6477 11361  9047]
 [ 6439 10395 10178]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0977553
{'0': {'precision': 0.37111892208553016, 'recall': 0.30016583747927034, 'f1-score': 0.3318925998690242, 'support': 8442}, '1': {'precision': 0.34428086070215175, 'recall': 0.44629312454122827, 'f1-score': 0.3887053809270112, 'support': 8174}, '2': {'precision': 0.3500066339392331, 'recall': 0.31611743559017375, 'f1-score': 0.3321999748142551, 'support': 8345}, 'accuracy': 0.35335122791554824, 'macro avg': {'precision': 0.355135472242305, 'recall': 0.3541921325368908, 'f1-score': 0.3509326518700968, 'support': 24961}, 'weighted avg': {'precision': 0.3552719464704272, 'recall': 0.35335122791554824, 'f1-score': 0.3505998918960238, 'support': 24961}}
[[2534 3441 2467]
 [2094 3648 2432]
 [2200 3507 2638]]
training model: results/CHTR/W2/deepVOL_L2/h200
Epoch 1/50
320/320 - 13s - loss: 3.3355 - accuracy200: 0.3547 - val_loss: 3.3319 - val_accuracy200: 0.3447 - 13s/epoch - 40ms/step
Epoch 2/50
320/320 - 10s - loss: 3.3125 - accuracy200: 0.3578 - val_loss: 3.3147 - val_accuracy200: 0.3400 - 10s/epoch - 31ms/step
Epoch 3/50
320/320 - 10s - loss: 3.2983 - accuracy200: 0.3627 - val_loss: 3.3123 - val_accuracy200: 0.3383 - 10s/epoch - 31ms/step
Epoch 4/50
320/320 - 10s - loss: 3.2903 - accuracy200: 0.3615 - val_loss: 3.3065 - val_accuracy200: 0.3450 - 10s/epoch - 31ms/step
Epoch 5/50
320/320 - 10s - loss: 3.2852 - accuracy200: 0.3675 - val_loss: 3.3087 - val_accuracy200: 0.3406 - 10s/epoch - 30ms/step
Epoch 6/50
320/320 - 10s - loss: 3.2836 - accuracy200: 0.3691 - val_loss: 3.3066 - val_accuracy200: 0.3446 - 10s/epoch - 30ms/step
Epoch 7/50
320/320 - 10s - loss: 3.2787 - accuracy200: 0.3717 - val_loss: 3.3083 - val_accuracy200: 0.3387 - 10s/epoch - 31ms/step
Epoch 8/50
320/320 - 10s - loss: 3.2769 - accuracy200: 0.3731 - val_loss: 3.3082 - val_accuracy200: 0.3445 - 10s/epoch - 31ms/step
Epoch 9/50
320/320 - 10s - loss: 3.2762 - accuracy200: 0.3737 - val_loss: 3.3057 - val_accuracy200: 0.3480 - 10s/epoch - 32ms/step
Epoch 10/50
320/320 - 10s - loss: 3.2716 - accuracy200: 0.3780 - val_loss: 3.3050 - val_accuracy200: 0.3423 - 10s/epoch - 31ms/step
Epoch 11/50
320/320 - 10s - loss: 3.2679 - accuracy200: 0.3790 - val_loss: 3.3033 - val_accuracy200: 0.3476 - 10s/epoch - 31ms/step
Epoch 12/50
320/320 - 10s - loss: 3.2660 - accuracy200: 0.3815 - val_loss: 3.3056 - val_accuracy200: 0.3448 - 10s/epoch - 31ms/step
Epoch 13/50
320/320 - 10s - loss: 3.2642 - accuracy200: 0.3842 - val_loss: 3.3104 - val_accuracy200: 0.3438 - 10s/epoch - 30ms/step
Epoch 14/50
320/320 - 10s - loss: 3.2615 - accuracy200: 0.3857 - val_loss: 3.3097 - val_accuracy200: 0.3428 - 10s/epoch - 31ms/step
Epoch 15/50
320/320 - 10s - loss: 3.2578 - accuracy200: 0.3883 - val_loss: 3.3051 - val_accuracy200: 0.3453 - 10s/epoch - 31ms/step
Epoch 16/50
320/320 - 10s - loss: 3.2550 - accuracy200: 0.3894 - val_loss: 3.3026 - val_accuracy200: 0.3470 - 10s/epoch - 30ms/step
Epoch 17/50
320/320 - 10s - loss: 3.2511 - accuracy200: 0.3921 - val_loss: 3.3050 - val_accuracy200: 0.3439 - 10s/epoch - 30ms/step
Epoch 18/50
320/320 - 10s - loss: 3.2493 - accuracy200: 0.3956 - val_loss: 3.3109 - val_accuracy200: 0.3433 - 10s/epoch - 30ms/step
Epoch 19/50
320/320 - 10s - loss: 3.2456 - accuracy200: 0.3962 - val_loss: 3.3089 - val_accuracy200: 0.3461 - 10s/epoch - 30ms/step
Epoch 20/50
320/320 - 10s - loss: 3.2421 - accuracy200: 0.3989 - val_loss: 3.3088 - val_accuracy200: 0.3485 - 10s/epoch - 30ms/step
Epoch 21/50
320/320 - 10s - loss: 3.2403 - accuracy200: 0.4004 - val_loss: 3.3104 - val_accuracy200: 0.3512 - 10s/epoch - 31ms/step
Epoch 22/50
320/320 - 10s - loss: 3.2395 - accuracy200: 0.3998 - val_loss: 3.3152 - val_accuracy200: 0.3490 - 10s/epoch - 30ms/step
Epoch 23/50
320/320 - 10s - loss: 3.2364 - accuracy200: 0.4014 - val_loss: 3.3145 - val_accuracy200: 0.3486 - 10s/epoch - 31ms/step
Epoch 24/50
320/320 - 10s - loss: 3.2322 - accuracy200: 0.4028 - val_loss: 3.3152 - val_accuracy200: 0.3476 - 10s/epoch - 30ms/step
Epoch 25/50
320/320 - 10s - loss: 3.2291 - accuracy200: 0.4040 - val_loss: 3.3192 - val_accuracy200: 0.3445 - 10s/epoch - 31ms/step
Epoch 26/50
320/320 - 10s - loss: 3.2265 - accuracy200: 0.4051 - val_loss: 3.3152 - val_accuracy200: 0.3443 - 10s/epoch - 31ms/step
testing model: results/CHTR/W2/deepVOL_L2/h200
Evaluating performance on  test set...
860/860 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0960983
{'0': {'precision': 0.32652265291530347, 'recall': 0.2085322484674886, 'f1-score': 0.25451781793615946, 'support': 72267}, '1': {'precision': 0.3366372625048468, 'recall': 0.21891103931920258, 'f1-score': 0.2653004707837164, 'support': 63455}, '2': {'precision': 0.39334626151652113, 'recall': 0.6189475433972121, 'f1-score': 0.4810079861960147, 'support': 84222}, 'accuracy': 0.36868475611973955, 'macro avg': {'precision': 0.3521687256455572, 'recall': 0.3487969437279677, 'f1-score': 0.33360875830529685, 'support': 219944}, 'weighted avg': {'precision': 0.3550291841919749, 'recall': 0.36868475611973955, 'f1-score': 0.34435735976327564, 'support': 219944}}
[[15070 12869 44328]
 [13494 13891 36070]
 [17589 14504 52129]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0917023
{'0': {'precision': 0.3842713787085515, 'recall': 0.2586447397401072, 'f1-score': 0.30918425556189394, 'support': 27242}, '1': {'precision': 0.3913487372380441, 'recall': 0.2675802777573664, 'f1-score': 0.3178406214541328, 'support': 27218}, '2': {'precision': 0.35586552217453504, 'recall': 0.5848211005804129, 'f1-score': 0.44248033575141055, 'support': 27222}, 'accuracy': 0.3703263876986362, 'macro avg': {'precision': 0.3771618793737102, 'recall': 0.3703487060259622, 'f1-score': 0.3565017375891458, 'support': 81682}, 'weighted avg': {'precision': 0.3771629254126813, 'recall': 0.3703263876986362, 'f1-score': 0.35649204505987364, 'support': 81682}}
[[ 7046  5506 14690]
 [ 5809  7283 14126]
 [ 5481  5821 15920]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1013957
{'0': {'precision': 0.3802546659689517, 'recall': 0.25829383886255924, 'f1-score': 0.30762717843787485, 'support': 8440}, '1': {'precision': 0.3372509960159363, 'recall': 0.20829232283464566, 'f1-score': 0.2575296623060541, 'support': 8128}, '2': {'precision': 0.3351632882882883, 'recall': 0.5673775765518885, 'f1-score': 0.4213972833060484, 'support': 8393}, 'accuracy': 0.3459396658787709, 'macro avg': {'precision': 0.35088965009105877, 'recall': 0.34465457941636446, 'f1-score': 0.32885137468332576, 'support': 24961}, 'weighted avg': {'precision': 0.3510897381915422, 'recall': 0.3459396658787709, 'f1-score': 0.32956860222054146, 'support': 24961}}
[[2180 1544 4716]
 [1705 1693 4730]
 [1848 1783 4762]]
training model: results/CHTR/W2/deepVOL_L2/h300
Epoch 1/50
320/320 - 12s - loss: 3.3414 - accuracy300: 0.3532 - val_loss: 3.3261 - val_accuracy300: 0.3457 - 12s/epoch - 37ms/step
Epoch 2/50
320/320 - 10s - loss: 3.3126 - accuracy300: 0.3559 - val_loss: 3.3074 - val_accuracy300: 0.3448 - 10s/epoch - 31ms/step
Epoch 3/50
320/320 - 10s - loss: 3.3046 - accuracy300: 0.3541 - val_loss: 3.2960 - val_accuracy300: 0.3522 - 10s/epoch - 30ms/step
Epoch 4/50
320/320 - 10s - loss: 3.3005 - accuracy300: 0.3497 - val_loss: 3.3029 - val_accuracy300: 0.3442 - 10s/epoch - 30ms/step
Epoch 5/50
320/320 - 10s - loss: 3.2954 - accuracy300: 0.3524 - val_loss: 3.2978 - val_accuracy300: 0.3459 - 10s/epoch - 31ms/step
Epoch 6/50
320/320 - 10s - loss: 3.2919 - accuracy300: 0.3587 - val_loss: 3.2989 - val_accuracy300: 0.3441 - 10s/epoch - 31ms/step
Epoch 7/50
320/320 - 10s - loss: 3.2902 - accuracy300: 0.3587 - val_loss: 3.2977 - val_accuracy300: 0.3482 - 10s/epoch - 30ms/step
Epoch 8/50
320/320 - 10s - loss: 3.2875 - accuracy300: 0.3621 - val_loss: 3.2967 - val_accuracy300: 0.3540 - 10s/epoch - 30ms/step
Epoch 9/50
320/320 - 10s - loss: 3.2867 - accuracy300: 0.3617 - val_loss: 3.2952 - val_accuracy300: 0.3477 - 10s/epoch - 30ms/step
Epoch 10/50
320/320 - 10s - loss: 3.2837 - accuracy300: 0.3637 - val_loss: 3.2952 - val_accuracy300: 0.3522 - 10s/epoch - 31ms/step
Epoch 11/50
320/320 - 10s - loss: 3.2811 - accuracy300: 0.3672 - val_loss: 3.2968 - val_accuracy300: 0.3471 - 10s/epoch - 31ms/step
Epoch 12/50
320/320 - 10s - loss: 3.2800 - accuracy300: 0.3702 - val_loss: 3.2935 - val_accuracy300: 0.3539 - 10s/epoch - 32ms/step
Epoch 13/50
320/320 - 10s - loss: 3.2781 - accuracy300: 0.3693 - val_loss: 3.2966 - val_accuracy300: 0.3472 - 10s/epoch - 31ms/step
Epoch 14/50
320/320 - 10s - loss: 3.2748 - accuracy300: 0.3729 - val_loss: 3.2990 - val_accuracy300: 0.3479 - 10s/epoch - 31ms/step
Epoch 15/50
320/320 - 10s - loss: 3.2734 - accuracy300: 0.3756 - val_loss: 3.2953 - val_accuracy300: 0.3531 - 10s/epoch - 30ms/step
Epoch 16/50
320/320 - 10s - loss: 3.2712 - accuracy300: 0.3774 - val_loss: 3.2965 - val_accuracy300: 0.3467 - 10s/epoch - 30ms/step
Epoch 17/50
320/320 - 10s - loss: 3.2680 - accuracy300: 0.3799 - val_loss: 3.2983 - val_accuracy300: 0.3494 - 10s/epoch - 30ms/step
Epoch 18/50
320/320 - 10s - loss: 3.2669 - accuracy300: 0.3784 - val_loss: 3.2953 - val_accuracy300: 0.3481 - 10s/epoch - 30ms/step
Epoch 19/50
320/320 - 10s - loss: 3.2626 - accuracy300: 0.3855 - val_loss: 3.3032 - val_accuracy300: 0.3454 - 10s/epoch - 31ms/step
Epoch 20/50
320/320 - 10s - loss: 3.2619 - accuracy300: 0.3853 - val_loss: 3.2976 - val_accuracy300: 0.3513 - 10s/epoch - 31ms/step
Epoch 21/50
320/320 - 10s - loss: 3.2590 - accuracy300: 0.3872 - val_loss: 3.3016 - val_accuracy300: 0.3469 - 10s/epoch - 30ms/step
Epoch 22/50
320/320 - 10s - loss: 3.2569 - accuracy300: 0.3890 - val_loss: 3.3039 - val_accuracy300: 0.3500 - 10s/epoch - 30ms/step
testing model: results/CHTR/W2/deepVOL_L2/h300
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0904809
{'0': {'precision': 0.3301983835415136, 'recall': 0.2775825623850441, 'f1-score': 0.30161298741974213, 'support': 72854}, '1': {'precision': 0.2877471539844218, 'recall': 0.0644122923198149, 'f1-score': 0.10526171591391663, 'support': 59647}, '2': {'precision': 0.3950201930552402, 'recall': 0.656599156021637, 'f1-score': 0.4932772026289789, 'support': 87443}, 'accuracy': 0.37045793474702654, 'macro avg': {'precision': 0.33765524352705856, 'recall': 0.3328646702421653, 'f1-score': 0.3000506353208792, 'support': 219944}, 'weighted avg': {'precision': 0.344457126675752, 'recall': 0.37045793474702654, 'f1-score': 0.3245639643913045, 'support': 219944}}
[[20223  4296 48335]
 [16208  3842 39597]
 [24814  5214 57415]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0955504
{'0': {'precision': 0.3680342357428598, 'recall': 0.28815966784426555, 'f1-score': 0.323235624553161, 'support': 27457}, '1': {'precision': 0.3947918117253864, 'recall': 0.10524948024948025, 'f1-score': 0.16619280710496231, 'support': 26936}, '2': {'precision': 0.3470558270286588, 'recall': 0.6740811315914838, 'f1-score': 0.45820256065361425, 'support': 27289}, 'accuracy': 0.3567738302196322, 'macro avg': {'precision': 0.3699606248323017, 'recall': 0.3558300932284098, 'f1-score': 0.3158769974372459, 'support': 81682}, 'weighted avg': {'precision': 0.36984935132846625, 'recall': 0.3567738302196322, 'f1-score': 0.31653901316338834, 'support': 81682}}
[[ 7912  2187 17358]
 [ 6851  2835 17250]
 [ 6735  2159 18395]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0978352
{'0': {'precision': 0.3612199216564074, 'recall': 0.2984971098265896, 'f1-score': 0.326876819850614, 'support': 8650}, '1': {'precision': 0.3337110481586402, 'recall': 0.07538717522078588, 'f1-score': 0.12299018584255586, 'support': 7813}, '2': {'precision': 0.3468344965104686, 'recall': 0.6549776417980702, 'f1-score': 0.4535158477959749, 'support': 8498}, 'accuracy': 0.35002604062337245, 'macro avg': {'precision': 0.34725515544183877, 'recall': 0.34295397561514857, 'f1-score': 0.3011276178297149, 'support': 24961}, 'weighted avg': {'precision': 0.3477118822538096, 'recall': 0.35002604062337245, 'f1-score': 0.3061730094253393, 'support': 24961}}
[[2582  606 5462]
 [2204  589 5020]
 [2362  570 5566]]
training model: results/CHTR/W2/deepVOL_L2/h500
Epoch 1/50
320/320 - 12s - loss: 3.3366 - accuracy500: 0.3554 - val_loss: 3.3335 - val_accuracy500: 0.3394 - 12s/epoch - 39ms/step
Epoch 2/50
320/320 - 10s - loss: 3.3164 - accuracy500: 0.3563 - val_loss: 3.3170 - val_accuracy500: 0.3395 - 10s/epoch - 31ms/step
Epoch 3/50
320/320 - 10s - loss: 3.3038 - accuracy500: 0.3559 - val_loss: 3.2967 - val_accuracy500: 0.3492 - 10s/epoch - 30ms/step
Epoch 4/50
320/320 - 10s - loss: 3.2954 - accuracy500: 0.3579 - val_loss: 3.2991 - val_accuracy500: 0.3512 - 10s/epoch - 30ms/step
Epoch 5/50
320/320 - 10s - loss: 3.2915 - accuracy500: 0.3594 - val_loss: 3.2899 - val_accuracy500: 0.3534 - 10s/epoch - 30ms/step
Epoch 6/50
320/320 - 10s - loss: 3.2884 - accuracy500: 0.3624 - val_loss: 3.2907 - val_accuracy500: 0.3527 - 10s/epoch - 31ms/step
Epoch 7/50
320/320 - 10s - loss: 3.2834 - accuracy500: 0.3643 - val_loss: 3.2927 - val_accuracy500: 0.3500 - 10s/epoch - 30ms/step
Epoch 8/50
320/320 - 10s - loss: 3.2801 - accuracy500: 0.3680 - val_loss: 3.2932 - val_accuracy500: 0.3529 - 10s/epoch - 31ms/step
Epoch 9/50
320/320 - 10s - loss: 3.2788 - accuracy500: 0.3682 - val_loss: 3.2934 - val_accuracy500: 0.3538 - 10s/epoch - 31ms/step
Epoch 10/50
320/320 - 10s - loss: 3.2773 - accuracy500: 0.3704 - val_loss: 3.2937 - val_accuracy500: 0.3548 - 10s/epoch - 31ms/step
Epoch 11/50
320/320 - 10s - loss: 3.2759 - accuracy500: 0.3703 - val_loss: 3.2981 - val_accuracy500: 0.3521 - 10s/epoch - 31ms/step
Epoch 12/50
320/320 - 10s - loss: 3.2716 - accuracy500: 0.3724 - val_loss: 3.2970 - val_accuracy500: 0.3520 - 10s/epoch - 31ms/step
Epoch 13/50
320/320 - 10s - loss: 3.2689 - accuracy500: 0.3736 - val_loss: 3.2999 - val_accuracy500: 0.3521 - 10s/epoch - 31ms/step
Epoch 14/50
320/320 - 10s - loss: 3.2664 - accuracy500: 0.3759 - val_loss: 3.3054 - val_accuracy500: 0.3516 - 10s/epoch - 31ms/step
Epoch 15/50
320/320 - 10s - loss: 3.2640 - accuracy500: 0.3792 - val_loss: 3.3027 - val_accuracy500: 0.3494 - 10s/epoch - 31ms/step
testing model: results/CHTR/W2/deepVOL_L2/h500
Evaluating performance on  test set...
860/860 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0907229
{'0': {'precision': 0.3255350462991353, 'recall': 0.14898752473302368, 'f1-score': 0.20441877256317692, 'support': 71261}, '1': {'precision': 0.2995804370968752, 'recall': 0.07880215454051294, 'f1-score': 0.12478155403114323, 'support': 60709}, '2': {'precision': 0.39939075985784395, 'recall': 0.7779571236956373, 'f1-score': 0.527811517920836, 'support': 87974}, 'accuracy': 0.3811924853599098, 'macro avg': {'precision': 0.34150208108461816, 'recall': 0.33524893432305797, 'f1-score': 0.2856706148383854, 'support': 219944}, 'weighted avg': {'precision': 0.34791212489438605, 'recall': 0.3811924853599098, 'f1-score': 0.3117890917363913, 'support': 219944}}
[[10617  4975 55669]
 [ 8673  4784 47252]
 [13324  6210 68440]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0991048
{'0': {'precision': 0.34375900835975787, 'recall': 0.1743293618887508, 'f1-score': 0.23134002618943694, 'support': 27362}, '1': {'precision': 0.37630802253823453, 'recall': 0.10403916768665851, 'f1-score': 0.16301031526950457, 'support': 26961}, '2': {'precision': 0.34370029162248145, 'recall': 0.7581782959903505, 'f1-score': 0.4729851443946598, 'support': 27359}, 'accuracy': 0.3466859283563086, 'macro avg': {'precision': 0.3545891075068246, 'recall': 0.3455156085219199, 'f1-score': 0.2891118286178671, 'support': 81682}, 'weighted avg': {'precision': 0.3544828831430732, 'recall': 0.3466859283563086, 'f1-score': 0.28972414328823953, 'support': 81682}}
[[ 4770  2314 20278]
 [ 4825  2805 19331]
 [ 4281  2335 20743]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0970383
{'0': {'precision': 0.3310196266156056, 'recall': 0.15812943059684428, 'f1-score': 0.21402042711234914, 'support': 8746}, '1': {'precision': 0.32321152856407614, 'recall': 0.08411465309402626, 'f1-score': 0.133489212456159, 'support': 7466}, '2': {'precision': 0.3543524416135881, 'recall': 0.7630586352726025, 'f1-score': 0.4839609989488563, 'support': 8749}, 'accuracy': 0.34802291574856775, 'macro avg': {'precision': 0.3361945322644233, 'recall': 0.3351009063211577, 'f1-score': 0.27715687950578816, 'support': 24961}, 'weighted avg': {'precision': 0.33686248300616006, 'recall': 0.34802291574856775, 'f1-score': 0.2845490122801904, 'support': 24961}}
[[1383  671 6692]
 [1366  628 5472]
 [1429  644 6676]]
training model: results/CHTR/W2/deepVOL_L2/h1000
Epoch 1/50
320/320 - 12s - loss: 3.3447 - accuracy1000: 0.3562 - val_loss: 3.3423 - val_accuracy1000: 0.3369 - 12s/epoch - 38ms/step
Epoch 2/50
320/320 - 10s - loss: 3.3208 - accuracy1000: 0.3571 - val_loss: 3.3254 - val_accuracy1000: 0.3392 - 10s/epoch - 30ms/step
Epoch 3/50
320/320 - 10s - loss: 3.3059 - accuracy1000: 0.3551 - val_loss: 3.3012 - val_accuracy1000: 0.3403 - 10s/epoch - 31ms/step
Epoch 4/50
320/320 - 10s - loss: 3.2997 - accuracy1000: 0.3565 - val_loss: 3.2985 - val_accuracy1000: 0.3417 - 10s/epoch - 31ms/step
Epoch 5/50
320/320 - 10s - loss: 3.2962 - accuracy1000: 0.3537 - val_loss: 3.2959 - val_accuracy1000: 0.3449 - 10s/epoch - 31ms/step
Epoch 6/50
320/320 - 10s - loss: 3.2930 - accuracy1000: 0.3546 - val_loss: 3.2997 - val_accuracy1000: 0.3419 - 10s/epoch - 31ms/step
Epoch 7/50
320/320 - 10s - loss: 3.2911 - accuracy1000: 0.3558 - val_loss: 3.2890 - val_accuracy1000: 0.3471 - 10s/epoch - 31ms/step
Epoch 8/50
320/320 - 10s - loss: 3.2872 - accuracy1000: 0.3595 - val_loss: 3.2937 - val_accuracy1000: 0.3446 - 10s/epoch - 30ms/step
Epoch 9/50
320/320 - 10s - loss: 3.2875 - accuracy1000: 0.3598 - val_loss: 3.2940 - val_accuracy1000: 0.3455 - 10s/epoch - 30ms/step
Epoch 10/50
320/320 - 10s - loss: 3.2871 - accuracy1000: 0.3617 - val_loss: 3.2924 - val_accuracy1000: 0.3407 - 10s/epoch - 30ms/step
Epoch 11/50
320/320 - 10s - loss: 3.2829 - accuracy1000: 0.3639 - val_loss: 3.2942 - val_accuracy1000: 0.3459 - 10s/epoch - 30ms/step
Epoch 12/50
320/320 - 10s - loss: 3.2815 - accuracy1000: 0.3655 - val_loss: 3.3014 - val_accuracy1000: 0.3416 - 10s/epoch - 31ms/step
Epoch 13/50
320/320 - 10s - loss: 3.2789 - accuracy1000: 0.3685 - val_loss: 3.2976 - val_accuracy1000: 0.3482 - 10s/epoch - 31ms/step
Epoch 14/50
320/320 - 10s - loss: 3.2795 - accuracy1000: 0.3693 - val_loss: 3.2968 - val_accuracy1000: 0.3459 - 10s/epoch - 31ms/step
Epoch 15/50
320/320 - 10s - loss: 3.2788 - accuracy1000: 0.3694 - val_loss: 3.2949 - val_accuracy1000: 0.3455 - 10s/epoch - 31ms/step
Epoch 16/50
320/320 - 10s - loss: 3.2749 - accuracy1000: 0.3747 - val_loss: 3.3058 - val_accuracy1000: 0.3389 - 10s/epoch - 31ms/step
Epoch 17/50
320/320 - 10s - loss: 3.2715 - accuracy1000: 0.3763 - val_loss: 3.3072 - val_accuracy1000: 0.3451 - 10s/epoch - 31ms/step
testing model: results/CHTR/W2/deepVOL_L2/h1000
Evaluating performance on  test set...
860/860 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.087215
{'0': {'precision': 0.31134065220918283, 'recall': 0.08433311360140629, 'f1-score': 0.132717045506939, 'support': 68265}, '1': {'precision': 0.3041068931586307, 'recall': 0.19454659907895172, 'f1-score': 0.23729087529297666, 'support': 60366}, '2': {'precision': 0.41680842570700405, 'recall': 0.7432786131218994, 'f1-score': 0.5341061113996569, 'support': 91313}, 'accuracy': 0.38815334812497726, 'macro avg': {'precision': 0.3440853236916059, 'recall': 0.34071944193408576, 'f1-score': 0.30137134406652416, 'support': 219944}, 'weighted avg': {'precision': 0.35314177296065097, 'recall': 0.38815334812497726, 'f1-score': 0.3280610584498958, 'support': 219944}}
[[ 5757 11125 51383]
 [ 5041 11744 43581]
 [ 7693 15749 67871]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.096364
{'0': {'precision': 0.37322052108514636, 'recall': 0.09991371251887539, 'f1-score': 0.15762904140669315, 'support': 27814}, '1': {'precision': 0.3797606093579978, 'recall': 0.2715651400622499, 'f1-score': 0.3166763886188346, 'support': 26988}, '2': {'precision': 0.33895189034712486, 'recall': 0.6927455357142858, 'f1-score': 0.4551865749171932, 'support': 26880}, 'accuracy': 0.3517176366886217, 'macro avg': {'precision': 0.36397767359675637, 'recall': 0.354741462765137, 'f1-score': 0.30983066831424033, 'support': 81682}, 'weighted avg': {'precision': 0.3641042299569871, 'recall': 0.3517176366886217, 'f1-score': 0.30809935686571127, 'support': 81682}}
[[ 2779  6082 18953]
 [ 2296  7329 17363]
 [ 2371  5888 18621]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0971019
{'0': {'precision': 0.35983455882352944, 'recall': 0.08747625963579489, 'f1-score': 0.14073874359665678, 'support': 8951}, '1': {'precision': 0.3439540866811795, 'recall': 0.23077944496082858, 'f1-score': 0.2762237762237762, 'support': 7531}, '2': {'precision': 0.34446198962327995, 'recall': 0.7203679679207454, 'f1-score': 0.466063866315669, 'support': 8479}, 'accuracy': 0.3456992908937943, 'macro avg': {'precision': 0.3494168783759963, 'recall': 0.3462078908391229, 'f1-score': 0.29434212871203397, 'support': 24961}, 'weighted avg': {'precision': 0.34982134421061517, 'recall': 0.3456992908937943, 'f1-score': 0.29212568707846204, 'support': 24961}}
[[ 783 1684 6484]
 [ 653 1738 5140]
 [ 740 1631 6108]]
training model: results/CHTR/W2/deepVOL_L3/h10
Epoch 1/50
320/320 - 16s - loss: 3.3306 - accuracy10: 0.3490 - val_loss: 3.3192 - val_accuracy10: 0.3415 - 16s/epoch - 50ms/step
Epoch 2/50
320/320 - 13s - loss: 3.2999 - accuracy10: 0.3621 - val_loss: 3.3217 - val_accuracy10: 0.3380 - 13s/epoch - 41ms/step
Epoch 3/50
320/320 - 13s - loss: 3.2843 - accuracy10: 0.3681 - val_loss: 3.3251 - val_accuracy10: 0.3396 - 13s/epoch - 41ms/step
Epoch 4/50
320/320 - 13s - loss: 3.2681 - accuracy10: 0.3808 - val_loss: 3.2861 - val_accuracy10: 0.3627 - 13s/epoch - 41ms/step
Epoch 5/50
320/320 - 13s - loss: 3.2566 - accuracy10: 0.3892 - val_loss: 3.2850 - val_accuracy10: 0.3600 - 13s/epoch - 41ms/step
Epoch 6/50
320/320 - 13s - loss: 3.2495 - accuracy10: 0.3931 - val_loss: 3.2669 - val_accuracy10: 0.3738 - 13s/epoch - 42ms/step
Epoch 7/50
320/320 - 13s - loss: 3.2397 - accuracy10: 0.3992 - val_loss: 3.2645 - val_accuracy10: 0.3785 - 13s/epoch - 40ms/step
Epoch 8/50
320/320 - 13s - loss: 3.2334 - accuracy10: 0.4006 - val_loss: 3.2612 - val_accuracy10: 0.3806 - 13s/epoch - 41ms/step
Epoch 9/50
320/320 - 13s - loss: 3.2217 - accuracy10: 0.4087 - val_loss: 3.2692 - val_accuracy10: 0.3751 - 13s/epoch - 40ms/step
Epoch 10/50
320/320 - 13s - loss: 3.2164 - accuracy10: 0.4103 - val_loss: 3.2761 - val_accuracy10: 0.3750 - 13s/epoch - 41ms/step
Epoch 11/50
320/320 - 13s - loss: 3.2119 - accuracy10: 0.4145 - val_loss: 3.2420 - val_accuracy10: 0.3960 - 13s/epoch - 41ms/step
Epoch 12/50
320/320 - 13s - loss: 3.2035 - accuracy10: 0.4182 - val_loss: 3.2562 - val_accuracy10: 0.3838 - 13s/epoch - 41ms/step
Epoch 13/50
320/320 - 13s - loss: 3.1965 - accuracy10: 0.4210 - val_loss: 3.2496 - val_accuracy10: 0.3874 - 13s/epoch - 41ms/step
Epoch 14/50
320/320 - 13s - loss: 3.1918 - accuracy10: 0.4237 - val_loss: 3.2453 - val_accuracy10: 0.3922 - 13s/epoch - 41ms/step
Epoch 15/50
320/320 - 13s - loss: 3.1863 - accuracy10: 0.4232 - val_loss: 3.2375 - val_accuracy10: 0.3970 - 13s/epoch - 41ms/step
Epoch 16/50
320/320 - 13s - loss: 3.1835 - accuracy10: 0.4252 - val_loss: 3.2307 - val_accuracy10: 0.3990 - 13s/epoch - 41ms/step
Epoch 17/50
320/320 - 13s - loss: 3.1783 - accuracy10: 0.4273 - val_loss: 3.2406 - val_accuracy10: 0.4063 - 13s/epoch - 41ms/step
Epoch 18/50
320/320 - 13s - loss: 3.1750 - accuracy10: 0.4279 - val_loss: 3.2480 - val_accuracy10: 0.4023 - 13s/epoch - 40ms/step
Epoch 19/50
320/320 - 13s - loss: 3.1703 - accuracy10: 0.4311 - val_loss: 3.2526 - val_accuracy10: 0.4029 - 13s/epoch - 41ms/step
Epoch 20/50
320/320 - 13s - loss: 3.1631 - accuracy10: 0.4348 - val_loss: 3.2439 - val_accuracy10: 0.4035 - 13s/epoch - 41ms/step
Epoch 21/50
320/320 - 13s - loss: 3.1579 - accuracy10: 0.4376 - val_loss: 3.2435 - val_accuracy10: 0.4032 - 13s/epoch - 42ms/step
Epoch 22/50
320/320 - 13s - loss: 3.1525 - accuracy10: 0.4392 - val_loss: 3.2563 - val_accuracy10: 0.4039 - 13s/epoch - 41ms/step
Epoch 23/50
320/320 - 13s - loss: 3.1515 - accuracy10: 0.4381 - val_loss: 3.2479 - val_accuracy10: 0.4040 - 13s/epoch - 42ms/step
Epoch 24/50
320/320 - 13s - loss: 3.1465 - accuracy10: 0.4409 - val_loss: 3.2488 - val_accuracy10: 0.4017 - 13s/epoch - 42ms/step
Epoch 25/50
320/320 - 13s - loss: 3.1422 - accuracy10: 0.4429 - val_loss: 3.2443 - val_accuracy10: 0.4044 - 13s/epoch - 41ms/step
Epoch 26/50
320/320 - 13s - loss: 3.1365 - accuracy10: 0.4431 - val_loss: 3.2498 - val_accuracy10: 0.4022 - 13s/epoch - 41ms/step
testing model: results/CHTR/W2/deepVOL_L3/h10
Evaluating performance on  test set...
860/860 - 17s - 17s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0860184
{'0': {'precision': 0.42110343163446456, 'recall': 0.31292987512007686, 'f1-score': 0.3590459535321175, 'support': 78075}, '1': {'precision': 0.3677864613075329, 'recall': 0.3448159818888243, 'f1-score': 0.35593099909209336, 'support': 65374}, '2': {'precision': 0.38436313770693803, 'recall': 0.5056539643113929, 'f1-score': 0.4367438420586126, 'support': 76495}, 'accuracy': 0.3894354926708617, 'macro avg': {'precision': 0.39108434354964516, 'recall': 0.387799940440098, 'f1-score': 0.3839069315609412, 'support': 219944}, 'weighted avg': {'precision': 0.39247799787796755, 'recall': 0.3894354926708617, 'f1-score': 0.38514288252891715, 'support': 219944}}
[[24432 19604 34039]
 [14917 22542 27915]
 [18670 19145 38680]]
Evaluating performance on  train set...
320/320 - 7s - 7s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.064777
{'0': {'precision': 0.4438159688904601, 'recall': 0.3151515151515151, 'f1-score': 0.36857777964182353, 'support': 27885}, '1': {'precision': 0.4298459321277837, 'recall': 0.46134865392405994, 'f1-score': 0.44504050021315905, 'support': 27153}, '2': {'precision': 0.39107459221699553, 'recall': 0.4805209428013812, 'f1-score': 0.4312081102017446, 'support': 26644}, 'accuracy': 0.41769300457873215, 'macro avg': {'precision': 0.42157883107841315, 'recall': 0.41900703729231875, 'f1-score': 0.41494213001890906, 'support': 81682}, 'weighted avg': {'precision': 0.42196819767642585, 'recall': 0.41769300457873215, 'f1-score': 0.41442527087749376, 'support': 81682}}
[[ 8788  8436 10661]
 [ 5352 12527  9274]
 [ 5661  8180 12803]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 24ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0789465
{'0': {'precision': 0.4420875934686403, 'recall': 0.32463021066786196, 'f1-score': 0.3743619564515087, 'support': 8924}, '1': {'precision': 0.41520395550061806, 'recall': 0.40948433499939046, 'f1-score': 0.4123243110538268, 'support': 8203}, '2': {'precision': 0.36305485559216905, 'recall': 0.4781720704620883, 'f1-score': 0.4127368884971353, 'support': 7834}, 'accuracy': 0.40070509995593123, 'macro avg': {'precision': 0.40678213485380915, 'recall': 0.4040955387097802, 'f1-score': 0.39980771866749026, 'support': 24961}, 'weighted avg': {'precision': 0.4084483582306305, 'recall': 0.40070509995593123, 'f1-score': 0.3988815835677401, 'support': 24961}}
[[2897 2556 3471]
 [1743 3359 3101]
 [1913 2175 3746]]
training model: results/CHTR/W2/deepVOL_L3/h20
Epoch 1/50
320/320 - 16s - loss: 3.3390 - accuracy20: 0.3490 - val_loss: 3.3263 - val_accuracy20: 0.3381 - 16s/epoch - 49ms/step
Epoch 2/50
320/320 - 13s - loss: 3.3006 - accuracy20: 0.3608 - val_loss: 3.3293 - val_accuracy20: 0.3421 - 13s/epoch - 41ms/step
Epoch 3/50
320/320 - 13s - loss: 3.2884 - accuracy20: 0.3691 - val_loss: 3.2865 - val_accuracy20: 0.3651 - 13s/epoch - 42ms/step
Epoch 4/50
320/320 - 13s - loss: 3.2689 - accuracy20: 0.3818 - val_loss: 3.2792 - val_accuracy20: 0.3746 - 13s/epoch - 42ms/step
Epoch 5/50
320/320 - 14s - loss: 3.2588 - accuracy20: 0.3893 - val_loss: 3.2774 - val_accuracy20: 0.3752 - 14s/epoch - 43ms/step
Epoch 6/50
320/320 - 14s - loss: 3.2488 - accuracy20: 0.3958 - val_loss: 3.2761 - val_accuracy20: 0.3788 - 14s/epoch - 43ms/step
Epoch 7/50
320/320 - 13s - loss: 3.2422 - accuracy20: 0.4003 - val_loss: 3.2767 - val_accuracy20: 0.3815 - 13s/epoch - 41ms/step
Epoch 8/50
320/320 - 13s - loss: 3.2335 - accuracy20: 0.4051 - val_loss: 3.2810 - val_accuracy20: 0.3856 - 13s/epoch - 42ms/step
Epoch 9/50
320/320 - 14s - loss: 3.2241 - accuracy20: 0.4092 - val_loss: 3.2855 - val_accuracy20: 0.3888 - 14s/epoch - 43ms/step
Epoch 10/50
320/320 - 13s - loss: 3.2213 - accuracy20: 0.4110 - val_loss: 3.2738 - val_accuracy20: 0.3935 - 13s/epoch - 42ms/step
Epoch 11/50
320/320 - 13s - loss: 3.2159 - accuracy20: 0.4132 - val_loss: 3.2646 - val_accuracy20: 0.3927 - 13s/epoch - 42ms/step
Epoch 12/50
320/320 - 13s - loss: 3.2106 - accuracy20: 0.4153 - val_loss: 3.2610 - val_accuracy20: 0.3917 - 13s/epoch - 41ms/step
Epoch 13/50
320/320 - 13s - loss: 3.2049 - accuracy20: 0.4178 - val_loss: 3.2562 - val_accuracy20: 0.3908 - 13s/epoch - 42ms/step
Epoch 14/50
320/320 - 13s - loss: 3.1995 - accuracy20: 0.4201 - val_loss: 3.2674 - val_accuracy20: 0.3920 - 13s/epoch - 41ms/step
Epoch 15/50
320/320 - 13s - loss: 3.1955 - accuracy20: 0.4204 - val_loss: 3.2706 - val_accuracy20: 0.3943 - 13s/epoch - 42ms/step
Epoch 16/50
320/320 - 13s - loss: 3.1895 - accuracy20: 0.4249 - val_loss: 3.2532 - val_accuracy20: 0.3970 - 13s/epoch - 42ms/step
Epoch 17/50
320/320 - 13s - loss: 3.1867 - accuracy20: 0.4255 - val_loss: 3.2622 - val_accuracy20: 0.3928 - 13s/epoch - 41ms/step
Epoch 18/50
320/320 - 13s - loss: 3.1846 - accuracy20: 0.4264 - val_loss: 3.2585 - val_accuracy20: 0.3951 - 13s/epoch - 41ms/step
Epoch 19/50
320/320 - 13s - loss: 3.1808 - accuracy20: 0.4284 - val_loss: 3.2584 - val_accuracy20: 0.3958 - 13s/epoch - 42ms/step
Epoch 20/50
320/320 - 13s - loss: 3.1803 - accuracy20: 0.4261 - val_loss: 3.2772 - val_accuracy20: 0.3977 - 13s/epoch - 41ms/step
Epoch 21/50
320/320 - 13s - loss: 3.1708 - accuracy20: 0.4314 - val_loss: 3.2665 - val_accuracy20: 0.3916 - 13s/epoch - 41ms/step
Epoch 22/50
320/320 - 13s - loss: 3.1709 - accuracy20: 0.4326 - val_loss: 3.2656 - val_accuracy20: 0.3996 - 13s/epoch - 41ms/step
Epoch 23/50
320/320 - 13s - loss: 3.1654 - accuracy20: 0.4325 - val_loss: 3.2503 - val_accuracy20: 0.3989 - 13s/epoch - 42ms/step
Epoch 24/50
320/320 - 13s - loss: 3.1598 - accuracy20: 0.4351 - val_loss: 3.2626 - val_accuracy20: 0.4019 - 13s/epoch - 41ms/step
Epoch 25/50
320/320 - 13s - loss: 3.1568 - accuracy20: 0.4360 - val_loss: 3.2615 - val_accuracy20: 0.3987 - 13s/epoch - 42ms/step
Epoch 26/50
320/320 - 13s - loss: 3.1518 - accuracy20: 0.4381 - val_loss: 3.2671 - val_accuracy20: 0.3976 - 13s/epoch - 42ms/step
Epoch 27/50
320/320 - 13s - loss: 3.1488 - accuracy20: 0.4403 - val_loss: 3.2648 - val_accuracy20: 0.4030 - 13s/epoch - 42ms/step
Epoch 28/50
320/320 - 14s - loss: 3.1439 - accuracy20: 0.4404 - val_loss: 3.2620 - val_accuracy20: 0.4059 - 14s/epoch - 42ms/step
Epoch 29/50
320/320 - 13s - loss: 3.1384 - accuracy20: 0.4426 - val_loss: 3.2617 - val_accuracy20: 0.4006 - 13s/epoch - 42ms/step
Epoch 30/50
320/320 - 13s - loss: 3.1368 - accuracy20: 0.4450 - val_loss: 3.2631 - val_accuracy20: 0.3983 - 13s/epoch - 42ms/step
Epoch 31/50
320/320 - 13s - loss: 3.1311 - accuracy20: 0.4452 - val_loss: 3.2646 - val_accuracy20: 0.4006 - 13s/epoch - 42ms/step
Epoch 32/50
320/320 - 13s - loss: 3.1253 - accuracy20: 0.4474 - val_loss: 3.2669 - val_accuracy20: 0.3977 - 13s/epoch - 41ms/step
Epoch 33/50
320/320 - 13s - loss: 3.1205 - accuracy20: 0.4502 - val_loss: 3.2745 - val_accuracy20: 0.3929 - 13s/epoch - 41ms/step
testing model: results/CHTR/W2/deepVOL_L3/h20
Evaluating performance on  test set...
860/860 - 17s - 17s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0899773
{'0': {'precision': 0.37949630979121596, 'recall': 0.4865625290315731, 'f1-score': 0.42641140756937823, 'support': 75349}, '1': {'precision': 0.39356546448938284, 'recall': 0.30110937383664654, 'f1-score': 0.34118480773448967, 'support': 67155}, '2': {'precision': 0.39491092025904, 'recall': 0.36695506198347105, 'f1-score': 0.3804200859449256, 'support': 77440}, 'accuracy': 0.3878259920707089, 'macro avg': {'precision': 0.3893242315132129, 'recall': 0.3848756549505636, 'f1-score': 0.38267210041626454, 'support': 219944}, 'weighted avg': {'precision': 0.38921933709991136, 'recall': 0.3878259920707089, 'f1-score': 0.38419629709348635, 'support': 219944}}
[[36662 15151 23536]
 [26929 20221 20005]
 [33016 16007 28417]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0630819
{'0': {'precision': 0.42480020961614046, 'recall': 0.46046792345652715, 'f1-score': 0.441915535187993, 'support': 28167}, '1': {'precision': 0.4418306416062197, 'recall': 0.40634674922600617, 'f1-score': 0.42334645291350675, 'support': 27132}, '2': {'precision': 0.4095507119135779, 'recall': 0.40666338172307925, 'f1-score': 0.4081019399011031, 'support': 26383}, 'accuracy': 0.42511201978404056, 'macro avg': {'precision': 0.425393854378646, 'recall': 0.42449268480187086, 'f1-score': 0.42445464266753435, 'support': 81682}, 'weighted avg': {'precision': 0.42553160922521127, 'recall': 0.42511201978404056, 'f1-score': 0.42482584070542184, 'support': 81682}}
[[12970  7179  8018]
 [ 8657 11025  7450]
 [ 8905  6749 10729]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0843719
{'0': {'precision': 0.41269101751770404, 'recall': 0.49898602974312756, 'f1-score': 0.4517543859649123, 'support': 8876}, '1': {'precision': 0.4031019656019656, 'recall': 0.3264113404625715, 'f1-score': 0.3607255737254363, 'support': 8042}, '2': {'precision': 0.37384994168718416, 'recall': 0.3586970036056198, 'f1-score': 0.36611675126903553, 'support': 8043}, 'accuracy': 0.39818116261367736, 'macro avg': {'precision': 0.3965476416022846, 'recall': 0.3946981246037729, 'f1-score': 0.3928655703197947, 'support': 24961}, 'weighted avg': {'precision': 0.39708611673603506, 'recall': 0.39818116261367736, 'f1-score': 0.39483209904176003, 'support': 24961}}
[[4429 2007 2440]
 [3025 2625 2392]
 [3278 1880 2885]]
training model: results/CHTR/W2/deepVOL_L3/h30
Epoch 1/50
320/320 - 16s - loss: 3.3346 - accuracy30: 0.3516 - val_loss: 3.3869 - val_accuracy30: 0.3317 - 16s/epoch - 49ms/step
Epoch 2/50
320/320 - 13s - loss: 3.3086 - accuracy30: 0.3554 - val_loss: 3.3139 - val_accuracy30: 0.3348 - 13s/epoch - 41ms/step
Epoch 3/50
320/320 - 13s - loss: 3.2930 - accuracy30: 0.3629 - val_loss: 3.2941 - val_accuracy30: 0.3589 - 13s/epoch - 41ms/step
Epoch 4/50
320/320 - 14s - loss: 3.2773 - accuracy30: 0.3733 - val_loss: 3.2909 - val_accuracy30: 0.3677 - 14s/epoch - 43ms/step
Epoch 5/50
320/320 - 14s - loss: 3.2657 - accuracy30: 0.3835 - val_loss: 3.2807 - val_accuracy30: 0.3694 - 14s/epoch - 43ms/step
Epoch 6/50
320/320 - 13s - loss: 3.2553 - accuracy30: 0.3893 - val_loss: 3.2792 - val_accuracy30: 0.3812 - 13s/epoch - 42ms/step
Epoch 7/50
320/320 - 13s - loss: 3.2516 - accuracy30: 0.3928 - val_loss: 3.2823 - val_accuracy30: 0.3826 - 13s/epoch - 41ms/step
Epoch 8/50
320/320 - 13s - loss: 3.2420 - accuracy30: 0.3989 - val_loss: 3.2835 - val_accuracy30: 0.3835 - 13s/epoch - 41ms/step
Epoch 9/50
320/320 - 13s - loss: 3.2367 - accuracy30: 0.4014 - val_loss: 3.2770 - val_accuracy30: 0.3823 - 13s/epoch - 41ms/step
Epoch 10/50
320/320 - 13s - loss: 3.2324 - accuracy30: 0.4039 - val_loss: 3.2772 - val_accuracy30: 0.3852 - 13s/epoch - 41ms/step
Epoch 11/50
320/320 - 13s - loss: 3.2270 - accuracy30: 0.4076 - val_loss: 3.2763 - val_accuracy30: 0.3894 - 13s/epoch - 42ms/step
Epoch 12/50
320/320 - 14s - loss: 3.2202 - accuracy30: 0.4101 - val_loss: 3.2665 - val_accuracy30: 0.3845 - 14s/epoch - 43ms/step
Epoch 13/50
320/320 - 13s - loss: 3.2158 - accuracy30: 0.4127 - val_loss: 3.2671 - val_accuracy30: 0.3861 - 13s/epoch - 42ms/step
Epoch 14/50
320/320 - 13s - loss: 3.2097 - accuracy30: 0.4156 - val_loss: 3.2695 - val_accuracy30: 0.3881 - 13s/epoch - 42ms/step
Epoch 15/50
320/320 - 13s - loss: 3.2075 - accuracy30: 0.4167 - val_loss: 3.2686 - val_accuracy30: 0.3881 - 13s/epoch - 42ms/step
Epoch 16/50
320/320 - 13s - loss: 3.2023 - accuracy30: 0.4190 - val_loss: 3.2767 - val_accuracy30: 0.3908 - 13s/epoch - 41ms/step
Epoch 17/50
320/320 - 13s - loss: 3.1976 - accuracy30: 0.4219 - val_loss: 3.2674 - val_accuracy30: 0.3912 - 13s/epoch - 41ms/step
Epoch 18/50
320/320 - 13s - loss: 3.1938 - accuracy30: 0.4218 - val_loss: 3.2690 - val_accuracy30: 0.3931 - 13s/epoch - 41ms/step
Epoch 19/50
320/320 - 13s - loss: 3.1923 - accuracy30: 0.4229 - val_loss: 3.2660 - val_accuracy30: 0.3939 - 13s/epoch - 41ms/step
Epoch 20/50
320/320 - 13s - loss: 3.1886 - accuracy30: 0.4262 - val_loss: 3.2647 - val_accuracy30: 0.3926 - 13s/epoch - 42ms/step
Epoch 21/50
320/320 - 13s - loss: 3.1831 - accuracy30: 0.4294 - val_loss: 3.2693 - val_accuracy30: 0.3951 - 13s/epoch - 42ms/step
Epoch 22/50
320/320 - 13s - loss: 3.1791 - accuracy30: 0.4300 - val_loss: 3.2683 - val_accuracy30: 0.3913 - 13s/epoch - 41ms/step
Epoch 23/50
320/320 - 13s - loss: 3.1732 - accuracy30: 0.4326 - val_loss: 3.2678 - val_accuracy30: 0.3943 - 13s/epoch - 41ms/step
Epoch 24/50
320/320 - 13s - loss: 3.1695 - accuracy30: 0.4338 - val_loss: 3.2734 - val_accuracy30: 0.3908 - 13s/epoch - 42ms/step
Epoch 25/50
320/320 - 13s - loss: 3.1660 - accuracy30: 0.4363 - val_loss: 3.2727 - val_accuracy30: 0.3951 - 13s/epoch - 41ms/step
Epoch 26/50
320/320 - 13s - loss: 3.1601 - accuracy30: 0.4381 - val_loss: 3.2763 - val_accuracy30: 0.3974 - 13s/epoch - 41ms/step
Epoch 27/50
320/320 - 13s - loss: 3.1590 - accuracy30: 0.4378 - val_loss: 3.2806 - val_accuracy30: 0.3933 - 13s/epoch - 41ms/step
Epoch 28/50
320/320 - 13s - loss: 3.1560 - accuracy30: 0.4400 - val_loss: 3.2691 - val_accuracy30: 0.3926 - 13s/epoch - 41ms/step
Epoch 29/50
320/320 - 13s - loss: 3.1496 - accuracy30: 0.4389 - val_loss: 3.2764 - val_accuracy30: 0.3954 - 13s/epoch - 42ms/step
Epoch 30/50
320/320 - 13s - loss: 3.1445 - accuracy30: 0.4433 - val_loss: 3.2825 - val_accuracy30: 0.3966 - 13s/epoch - 42ms/step
testing model: results/CHTR/W2/deepVOL_L3/h30
Evaluating performance on  test set...
860/860 - 18s - 18s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.087353
{'0': {'precision': 0.3704485488126649, 'recall': 0.5359137480747338, 'f1-score': 0.43807751259032185, 'support': 74665}, '1': {'precision': 0.4188837370756986, 'recall': 0.25109241699117146, 'f1-score': 0.31397693587206005, 'support': 67282}, '2': {'precision': 0.40489957820050837, 'recall': 0.37168096208828544, 'f1-score': 0.3875797987900665, 'support': 77997}, 'accuracy': 0.3905448659658822, 'macro avg': {'precision': 0.39807728802962394, 'recall': 0.38622904238473027, 'f1-score': 0.3798780824174828, 'support': 219944}, 'weighted avg': {'precision': 0.39748221772782993, 'recall': 0.3905448659658822, 'f1-score': 0.38220690377154704, 'support': 219944}}
[[40014 11505 23146]
 [30926 16894 19462]
 [37075 11932 28990]]
Evaluating performance on  train set...
320/320 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0677468
{'0': {'precision': 0.42311146901229596, 'recall': 0.4858108108108108, 'f1-score': 0.4522985746684987, 'support': 28120}, '1': {'precision': 0.45135340247912975, 'recall': 0.32779717067793496, 'f1-score': 0.37977862920391653, 'support': 27215}, '2': {'precision': 0.3971987850151873, 'recall': 0.44669222302349415, 'f1-score': 0.42049413151830217, 'support': 26347}, 'accuracy': 0.42054553022697777, 'macro avg': {'precision': 0.42388788550220435, 'recall': 0.4201000681707467, 'f1-score': 0.4175237784635725, 'support': 81682}, 'weighted avg': {'precision': 0.4241628969159719, 'recall': 0.42054553022697777, 'f1-score': 0.4178775029575118, 'support': 81682}}
[[13661  5384  9075]
 [ 9508  8921  8786]
 [ 9118  5460 11769]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.089364
{'0': {'precision': 0.39336924989639455, 'recall': 0.5451412818745692, 'f1-score': 0.456983294015695, 'support': 8706}, '1': {'precision': 0.42176165803108806, 'recall': 0.246278591310662, 'f1-score': 0.3109718826405867, 'support': 8263}, '2': {'precision': 0.3751703630281254, 'recall': 0.3788788788788789, 'f1-score': 0.37701550146298946, 'support': 7992}, 'accuracy': 0.39297303793918514, 'macro avg': {'precision': 0.396767090318536, 'recall': 0.39009958402137007, 'f1-score': 0.3816568927064237, 'support': 24961}, 'weighted avg': {'precision': 0.39694126081605985, 'recall': 0.39297303793918514, 'f1-score': 0.3830441533452995, 'support': 24961}}
[[4746 1428 2532]
 [3717 2035 2511]
 [3602 1362 3028]]
training model: results/CHTR/W2/deepVOL_L3/h50
Epoch 1/50
320/320 - 16s - loss: 3.3353 - accuracy50: 0.3460 - val_loss: 3.3278 - val_accuracy50: 0.3374 - 16s/epoch - 51ms/step
Epoch 2/50
320/320 - 13s - loss: 3.3127 - accuracy50: 0.3536 - val_loss: 3.3057 - val_accuracy50: 0.3429 - 13s/epoch - 41ms/step
Epoch 3/50
320/320 - 13s - loss: 3.2899 - accuracy50: 0.3673 - val_loss: 3.2971 - val_accuracy50: 0.3508 - 13s/epoch - 42ms/step
Epoch 4/50
320/320 - 13s - loss: 3.2798 - accuracy50: 0.3748 - val_loss: 3.3007 - val_accuracy50: 0.3502 - 13s/epoch - 42ms/step
Epoch 5/50
320/320 - 14s - loss: 3.2738 - accuracy50: 0.3804 - val_loss: 3.3038 - val_accuracy50: 0.3493 - 14s/epoch - 43ms/step
Epoch 6/50
320/320 - 14s - loss: 3.2714 - accuracy50: 0.3787 - val_loss: 3.2925 - val_accuracy50: 0.3601 - 14s/epoch - 44ms/step
Epoch 7/50
320/320 - 13s - loss: 3.2613 - accuracy50: 0.3872 - val_loss: 3.2905 - val_accuracy50: 0.3630 - 13s/epoch - 42ms/step
Epoch 8/50
320/320 - 13s - loss: 3.2568 - accuracy50: 0.3876 - val_loss: 3.2862 - val_accuracy50: 0.3682 - 13s/epoch - 42ms/step
Epoch 9/50
320/320 - 13s - loss: 3.2519 - accuracy50: 0.3933 - val_loss: 3.2884 - val_accuracy50: 0.3644 - 13s/epoch - 42ms/step
Epoch 10/50
320/320 - 14s - loss: 3.2494 - accuracy50: 0.3954 - val_loss: 3.2881 - val_accuracy50: 0.3659 - 14s/epoch - 42ms/step
Epoch 11/50
320/320 - 14s - loss: 3.2424 - accuracy50: 0.3972 - val_loss: 3.2954 - val_accuracy50: 0.3660 - 14s/epoch - 44ms/step
Epoch 12/50
320/320 - 13s - loss: 3.2421 - accuracy50: 0.3985 - val_loss: 3.2935 - val_accuracy50: 0.3641 - 13s/epoch - 41ms/step
Epoch 13/50
320/320 - 13s - loss: 3.2378 - accuracy50: 0.4010 - val_loss: 3.2887 - val_accuracy50: 0.3671 - 13s/epoch - 41ms/step
Epoch 14/50
320/320 - 14s - loss: 3.2325 - accuracy50: 0.4033 - val_loss: 3.2870 - val_accuracy50: 0.3735 - 14s/epoch - 44ms/step
Epoch 15/50
320/320 - 14s - loss: 3.2270 - accuracy50: 0.4075 - val_loss: 3.2847 - val_accuracy50: 0.3732 - 14s/epoch - 44ms/step
Epoch 16/50
320/320 - 13s - loss: 3.2264 - accuracy50: 0.4079 - val_loss: 3.2905 - val_accuracy50: 0.3699 - 13s/epoch - 41ms/step
Epoch 17/50
320/320 - 14s - loss: 3.2234 - accuracy50: 0.4077 - val_loss: 3.2895 - val_accuracy50: 0.3675 - 14s/epoch - 42ms/step
Epoch 18/50
320/320 - 13s - loss: 3.2181 - accuracy50: 0.4140 - val_loss: 3.2913 - val_accuracy50: 0.3687 - 13s/epoch - 42ms/step
Epoch 19/50
320/320 - 13s - loss: 3.2156 - accuracy50: 0.4128 - val_loss: 3.2879 - val_accuracy50: 0.3707 - 13s/epoch - 42ms/step
Epoch 20/50
320/320 - 13s - loss: 3.2097 - accuracy50: 0.4145 - val_loss: 3.2926 - val_accuracy50: 0.3717 - 13s/epoch - 41ms/step
Epoch 21/50
320/320 - 13s - loss: 3.2052 - accuracy50: 0.4181 - val_loss: 3.2922 - val_accuracy50: 0.3709 - 13s/epoch - 41ms/step
Epoch 22/50
320/320 - 13s - loss: 3.2019 - accuracy50: 0.4202 - val_loss: 3.2892 - val_accuracy50: 0.3732 - 13s/epoch - 41ms/step
Epoch 23/50
320/320 - 13s - loss: 3.1993 - accuracy50: 0.4212 - val_loss: 3.2924 - val_accuracy50: 0.3764 - 13s/epoch - 42ms/step
Epoch 24/50
320/320 - 13s - loss: 3.1971 - accuracy50: 0.4226 - val_loss: 3.2927 - val_accuracy50: 0.3771 - 13s/epoch - 41ms/step
Epoch 25/50
320/320 - 13s - loss: 3.1924 - accuracy50: 0.4253 - val_loss: 3.2924 - val_accuracy50: 0.3731 - 13s/epoch - 42ms/step
testing model: results/CHTR/W2/deepVOL_L3/h50
Evaluating performance on  test set...
860/860 - 18s - 18s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0933839
{'0': {'precision': 0.37245943557636263, 'recall': 0.26875958159790525, 'f1-score': 0.31222418358340687, 'support': 73709}, '1': {'precision': 0.3405182669637256, 'recall': 0.4639084117933077, 'f1-score': 0.3927499984407258, 'support': 67869}, '2': {'precision': 0.38768423177871997, 'recall': 0.3675445984227854, 'f1-score': 0.3773458840175291, 'support': 78366}, 'accuracy': 0.36417451714981997, 'macro avg': {'precision': 0.36688731143960274, 'recall': 0.36673753060466613, 'f1-score': 0.36077335534722055, 'support': 219944}, 'weighted avg': {'precision': 0.3680278130116319, 'recall': 0.36417451714981997, 'f1-score': 0.360275204319466, 'support': 219944}}
[[19810 29675 24224]
 [15116 31485 21268]
 [18261 31302 28803]]
Evaluating performance on  train set...
320/320 - 7s - 7s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0816818
{'0': {'precision': 0.44447392157903115, 'recall': 0.2956205667501853, 'f1-score': 0.355077992539844, 'support': 28337}, '1': {'precision': 0.3738118976404121, 'recall': 0.4227776733696674, 'f1-score': 0.3967898403739307, 'support': 26605}, '2': {'precision': 0.3835394716750649, 'recall': 0.46967090501121916, 'f1-score': 0.4222577120282424, 'support': 26740}, 'accuracy': 0.3940158174383585, 'macro avg': {'precision': 0.4006084302981694, 'recall': 0.39602304837702396, 'f1-score': 0.39137518164733903, 'support': 81682}, 'weighted avg': {'precision': 0.4015103514250313, 'recall': 0.3940158174383585, 'f1-score': 0.39065657057105835, 'support': 81682}}
[[ 8377  9754 10206]
 [ 5377 11248  9980]
 [ 5093  9088 12559]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 24ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0956115
{'0': {'precision': 0.4019578313253012, 'recall': 0.30973656725078336, 'f1-score': 0.34987218981451135, 'support': 8617}, '1': {'precision': 0.36245719622289096, 'recall': 0.422983773310729, 'f1-score': 0.39038837664152004, 'support': 8258}, '2': {'precision': 0.3619299861814832, 'recall': 0.38869651249072473, 'f1-score': 0.37483601669648176, 'support': 8086}, 'accuracy': 0.3727815392011538, 'macro avg': {'precision': 0.3754483379098918, 'recall': 0.373805617684079, 'f1-score': 0.37169886105083766, 'support': 24961}, 'weighted avg': {'precision': 0.3759227605946167, 'recall': 0.3727815392011538, 'f1-score': 0.3713633229816541, 'support': 24961}}
[[2669 3176 2772]
 [1996 3493 2769]
 [1975 2968 3143]]
training model: results/CHTR/W2/deepVOL_L3/h100
Epoch 1/50
320/320 - 16s - loss: 3.3447 - accuracy100: 0.3496 - val_loss: 3.3263 - val_accuracy100: 0.3335 - 16s/epoch - 49ms/step
Epoch 2/50
320/320 - 14s - loss: 3.3088 - accuracy100: 0.3571 - val_loss: 3.3075 - val_accuracy100: 0.3340 - 14s/epoch - 42ms/step
Epoch 3/50
320/320 - 14s - loss: 3.2983 - accuracy100: 0.3581 - val_loss: 3.3014 - val_accuracy100: 0.3433 - 14s/epoch - 42ms/step
Epoch 4/50
320/320 - 13s - loss: 3.2915 - accuracy100: 0.3620 - val_loss: 3.3011 - val_accuracy100: 0.3440 - 13s/epoch - 42ms/step
Epoch 5/50
320/320 - 13s - loss: 3.2853 - accuracy100: 0.3633 - val_loss: 3.3000 - val_accuracy100: 0.3492 - 13s/epoch - 42ms/step
Epoch 6/50
320/320 - 13s - loss: 3.2822 - accuracy100: 0.3693 - val_loss: 3.2980 - val_accuracy100: 0.3478 - 13s/epoch - 42ms/step
Epoch 7/50
320/320 - 13s - loss: 3.2780 - accuracy100: 0.3710 - val_loss: 3.2935 - val_accuracy100: 0.3530 - 13s/epoch - 41ms/step
Epoch 8/50
320/320 - 13s - loss: 3.2742 - accuracy100: 0.3745 - val_loss: 3.2944 - val_accuracy100: 0.3517 - 13s/epoch - 41ms/step
Epoch 9/50
320/320 - 13s - loss: 3.2719 - accuracy100: 0.3743 - val_loss: 3.2901 - val_accuracy100: 0.3527 - 13s/epoch - 41ms/step
Epoch 10/50
320/320 - 13s - loss: 3.2676 - accuracy100: 0.3796 - val_loss: 3.2911 - val_accuracy100: 0.3544 - 13s/epoch - 41ms/step
Epoch 11/50
320/320 - 13s - loss: 3.2666 - accuracy100: 0.3800 - val_loss: 3.2924 - val_accuracy100: 0.3563 - 13s/epoch - 40ms/step
Epoch 12/50
320/320 - 13s - loss: 3.2641 - accuracy100: 0.3820 - val_loss: 3.2964 - val_accuracy100: 0.3542 - 13s/epoch - 42ms/step
Epoch 13/50
320/320 - 13s - loss: 3.2606 - accuracy100: 0.3877 - val_loss: 3.2904 - val_accuracy100: 0.3548 - 13s/epoch - 41ms/step
Epoch 14/50
320/320 - 13s - loss: 3.2583 - accuracy100: 0.3880 - val_loss: 3.2919 - val_accuracy100: 0.3595 - 13s/epoch - 42ms/step
Epoch 15/50
320/320 - 13s - loss: 3.2540 - accuracy100: 0.3886 - val_loss: 3.2925 - val_accuracy100: 0.3589 - 13s/epoch - 41ms/step
Epoch 16/50
320/320 - 13s - loss: 3.2533 - accuracy100: 0.3879 - val_loss: 3.2934 - val_accuracy100: 0.3550 - 13s/epoch - 41ms/step
Epoch 17/50
320/320 - 13s - loss: 3.2493 - accuracy100: 0.3935 - val_loss: 3.2964 - val_accuracy100: 0.3538 - 13s/epoch - 41ms/step
Epoch 18/50
320/320 - 13s - loss: 3.2452 - accuracy100: 0.3953 - val_loss: 3.2941 - val_accuracy100: 0.3568 - 13s/epoch - 40ms/step
Epoch 19/50
320/320 - 13s - loss: 3.2428 - accuracy100: 0.3954 - val_loss: 3.2938 - val_accuracy100: 0.3599 - 13s/epoch - 41ms/step
testing model: results/CHTR/W2/deepVOL_L3/h100
Evaluating performance on  test set...
860/860 - 17s - 17s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0991436
{'0': {'precision': 0.3290387220591556, 'recall': 0.3177915281033637, 'f1-score': 0.3233173410244322, 'support': 73372}, '1': {'precision': 0.304901616303584, 'recall': 0.2656635081972232, 'f1-score': 0.283933348057621, 'support': 65327}, '2': {'precision': 0.3760308159722222, 'recall': 0.42654932611237617, 'f1-score': 0.39970012398719756, 'support': 81245}, 'accuracy': 0.3424826319426763, 'macro avg': {'precision': 0.3366570514449873, 'recall': 0.336668120804321, 'f1-score': 0.3356502710230836, 'support': 219944}, 'weighted avg': {'precision': 0.33922798824633443, 'recall': 0.3424826319426763, 'f1-score': 0.3398346413066267, 'support': 219944}}
[[23317 19105 30950]
 [21417 17355 26555]
 [26130 20460 34655]]
Evaluating performance on  train set...
320/320 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0929917
{'0': {'precision': 0.38552566492903617, 'recall': 0.364657189130826, 'f1-score': 0.3748011689416639, 'support': 27785}, '1': {'precision': 0.36206022508364594, 'recall': 0.2656499907011345, 'f1-score': 0.3064512668683358, 'support': 26885}, '2': {'precision': 0.35579537491240365, 'recall': 0.4699022656597068, 'f1-score': 0.4049643466747492, 'support': 27012}, 'accuracy': 0.36687397468230454, 'macro avg': {'precision': 0.3677937549750286, 'recall': 0.3667364818305558, 'f1-score': 0.3620722608282496, 'support': 81682}, 'weighted avg': {'precision': 0.36797047597464483, 'recall': 0.36687397468230454, 'f1-score': 0.3622792013072362, 'support': 81682}}
[[10132  6230 11423]
 [ 8184  7142 11559]
 [ 7965  6354 12693]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0976634
{'0': {'precision': 0.36015908293367643, 'recall': 0.36472399905235725, 'f1-score': 0.3624271673238773, 'support': 8442}, '1': {'precision': 0.33916312520431513, 'recall': 0.25385368240763395, 'f1-score': 0.2903722362160649, 'support': 8174}, '2': {'precision': 0.3483582669516223, 'recall': 0.42971839424805275, 'f1-score': 0.3847845914480391, 'support': 8345}, 'accuracy': 0.35014622811586077, 'macro avg': {'precision': 0.3492268250298713, 'recall': 0.34943202523601463, 'f1-score': 0.3458613316626605, 'support': 24961}, 'weighted avg': {'precision': 0.3493382517229861, 'recall': 0.35014622811586077, 'f1-score': 0.3463058459601849, 'support': 24961}}
[[3079 2031 3332]
 [2723 2075 3376]
 [2747 2012 3586]]
training model: results/CHTR/W2/deepVOL_L3/h200
Epoch 1/50
320/320 - 16s - loss: 3.3272 - accuracy200: 0.3600 - val_loss: 3.3229 - val_accuracy200: 0.3365 - 16s/epoch - 49ms/step
Epoch 2/50
320/320 - 13s - loss: 3.3081 - accuracy200: 0.3572 - val_loss: 3.3069 - val_accuracy200: 0.3375 - 13s/epoch - 41ms/step
Epoch 3/50
320/320 - 13s - loss: 3.2985 - accuracy200: 0.3535 - val_loss: 3.3066 - val_accuracy200: 0.3340 - 13s/epoch - 41ms/step
Epoch 4/50
320/320 - 13s - loss: 3.2941 - accuracy200: 0.3559 - val_loss: 3.3072 - val_accuracy200: 0.3368 - 13s/epoch - 41ms/step
Epoch 5/50
320/320 - 13s - loss: 3.2914 - accuracy200: 0.3588 - val_loss: 3.3056 - val_accuracy200: 0.3382 - 13s/epoch - 41ms/step
Epoch 6/50
320/320 - 14s - loss: 3.2881 - accuracy200: 0.3600 - val_loss: 3.2986 - val_accuracy200: 0.3434 - 14s/epoch - 43ms/step
Epoch 7/50
320/320 - 13s - loss: 3.2868 - accuracy200: 0.3631 - val_loss: 3.3086 - val_accuracy200: 0.3382 - 13s/epoch - 41ms/step
Epoch 8/50
320/320 - 13s - loss: 3.2871 - accuracy200: 0.3640 - val_loss: 3.2997 - val_accuracy200: 0.3421 - 13s/epoch - 42ms/step
Epoch 9/50
320/320 - 14s - loss: 3.2835 - accuracy200: 0.3645 - val_loss: 3.3002 - val_accuracy200: 0.3456 - 14s/epoch - 43ms/step
Epoch 10/50
320/320 - 13s - loss: 3.2820 - accuracy200: 0.3671 - val_loss: 3.3005 - val_accuracy200: 0.3472 - 13s/epoch - 42ms/step
Epoch 11/50
320/320 - 13s - loss: 3.2812 - accuracy200: 0.3676 - val_loss: 3.3117 - val_accuracy200: 0.3449 - 13s/epoch - 41ms/step
Epoch 12/50
320/320 - 13s - loss: 3.2826 - accuracy200: 0.3671 - val_loss: 3.3044 - val_accuracy200: 0.3443 - 13s/epoch - 41ms/step
Epoch 13/50
320/320 - 13s - loss: 3.2760 - accuracy200: 0.3728 - val_loss: 3.3209 - val_accuracy200: 0.3429 - 13s/epoch - 41ms/step
Epoch 14/50
320/320 - 13s - loss: 3.2786 - accuracy200: 0.3706 - val_loss: 3.3055 - val_accuracy200: 0.3426 - 13s/epoch - 41ms/step
Epoch 15/50
320/320 - 13s - loss: 3.2852 - accuracy200: 0.3639 - val_loss: 3.3068 - val_accuracy200: 0.3466 - 13s/epoch - 41ms/step
Epoch 16/50
320/320 - 13s - loss: 3.2862 - accuracy200: 0.3596 - val_loss: 3.2929 - val_accuracy200: 0.3504 - 13s/epoch - 41ms/step
Epoch 17/50
320/320 - 13s - loss: 3.2745 - accuracy200: 0.3743 - val_loss: 3.3050 - val_accuracy200: 0.3456 - 13s/epoch - 41ms/step
Epoch 18/50
320/320 - 13s - loss: 3.2744 - accuracy200: 0.3724 - val_loss: 3.3019 - val_accuracy200: 0.3479 - 13s/epoch - 41ms/step
Epoch 19/50
320/320 - 13s - loss: 3.2688 - accuracy200: 0.3777 - val_loss: 3.3015 - val_accuracy200: 0.3476 - 13s/epoch - 41ms/step
Epoch 20/50
320/320 - 13s - loss: 3.2667 - accuracy200: 0.3812 - val_loss: 3.3066 - val_accuracy200: 0.3487 - 13s/epoch - 41ms/step
Epoch 21/50
320/320 - 13s - loss: 3.2666 - accuracy200: 0.3798 - val_loss: 3.3088 - val_accuracy200: 0.3459 - 13s/epoch - 41ms/step
Epoch 22/50
320/320 - 13s - loss: 3.2642 - accuracy200: 0.3820 - val_loss: 3.3053 - val_accuracy200: 0.3510 - 13s/epoch - 42ms/step
Epoch 23/50
320/320 - 13s - loss: 3.2620 - accuracy200: 0.3812 - val_loss: 3.3049 - val_accuracy200: 0.3517 - 13s/epoch - 42ms/step
Epoch 24/50
320/320 - 13s - loss: 3.2591 - accuracy200: 0.3851 - val_loss: 3.3047 - val_accuracy200: 0.3506 - 13s/epoch - 41ms/step
Epoch 25/50
320/320 - 13s - loss: 3.2569 - accuracy200: 0.3863 - val_loss: 3.3004 - val_accuracy200: 0.3518 - 13s/epoch - 41ms/step
Epoch 26/50
320/320 - 13s - loss: 3.2536 - accuracy200: 0.3899 - val_loss: 3.3069 - val_accuracy200: 0.3476 - 13s/epoch - 42ms/step
testing model: results/CHTR/W2/deepVOL_L3/h200
Evaluating performance on  test set...
860/860 - 17s - 17s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0943927
{'0': {'precision': 0.33594628406733495, 'recall': 0.5871006130045525, 'f1-score': 0.42735481791489766, 'support': 72267}, '1': {'precision': 0.4093810713294477, 'recall': 0.04648963832637302, 'f1-score': 0.08349726157286197, 'support': 63455}, '2': {'precision': 0.3812873073897552, 'recall': 0.3913466790149842, 'f1-score': 0.38625150879495623, 'support': 84222}, 'accuracy': 0.3561724802677045, 'macro avg': {'precision': 0.375538220928846, 'recall': 0.34164564344863657, 'f1-score': 0.29903452942757197, 'support': 219944}, 'weighted avg': {'precision': 0.3744948059273459, 'recall': 0.3561724802677045, 'f1-score': 0.312410631492974, 'support': 219944}}
[[42428  2269 27570]
 [34591  2950 25914]
 [49275  1987 32960]]
Evaluating performance on  train set...
320/320 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0941286
{'0': {'precision': 0.3660685478867297, 'recall': 0.5414433595183907, 'f1-score': 0.4368105426815725, 'support': 27242}, '1': {'precision': 0.41720123544784987, 'recall': 0.06451612903225806, 'f1-score': 0.11175104209755941, 'support': 27218}, '2': {'precision': 0.35476062399139324, 'recall': 0.4845345676291235, 'f1-score': 0.4096146082419801, 'support': 27222}, 'accuracy': 0.36355623025880857, 'macro avg': {'precision': 0.3793434691086576, 'recall': 0.36349801872659077, 'f1-score': 0.31939206434037065, 'support': 81682}, 'weighted avg': {'precision': 0.3793383648079574, 'recall': 0.36355623025880857, 'f1-score': 0.31943098275147463, 'support': 81682}}
[[14750  1213 11279]
 [12751  1756 12711]
 [12792  1240 13190]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0974666
{'0': {'precision': 0.35108664569631115, 'recall': 0.581872037914692, 'f1-score': 0.43793472445157844, 'support': 8440}, '1': {'precision': 0.38453159041394336, 'recall': 0.04343011811023622, 'f1-score': 0.07804554499226177, 'support': 8128}, '2': {'precision': 0.3461959224266534, 'recall': 0.41475038722745144, 'f1-score': 0.37738508239375546, 'support': 8393}, 'accuracy': 0.3503465406033412, 'macro avg': {'precision': 0.3606047195123027, 'recall': 0.3466841810841266, 'f1-score': 0.2977884506125319, 'support': 24961}, 'weighted avg': {'precision': 0.36033277647082645, 'recall': 0.3503465406033412, 'f1-score': 0.30038525141617783, 'support': 24961}}
[[4911  284 3245]
 [4446  353 3329]
 [4631  281 3481]]
training model: results/CHTR/W2/deepVOL_L3/h300
Epoch 1/50
320/320 - 16s - loss: 3.3406 - accuracy300: 0.3515 - val_loss: 3.3264 - val_accuracy300: 0.3312 - 16s/epoch - 51ms/step
Epoch 2/50
320/320 - 13s - loss: 3.3146 - accuracy300: 0.3526 - val_loss: 3.3019 - val_accuracy300: 0.3392 - 13s/epoch - 40ms/step
Epoch 3/50
320/320 - 13s - loss: 3.3031 - accuracy300: 0.3543 - val_loss: 3.2938 - val_accuracy300: 0.3497 - 13s/epoch - 41ms/step
Epoch 4/50
320/320 - 14s - loss: 3.3013 - accuracy300: 0.3470 - val_loss: 3.2963 - val_accuracy300: 0.3455 - 14s/epoch - 42ms/step
Epoch 5/50
320/320 - 13s - loss: 3.2949 - accuracy300: 0.3506 - val_loss: 3.2949 - val_accuracy300: 0.3462 - 13s/epoch - 42ms/step
Epoch 6/50
320/320 - 13s - loss: 3.2927 - accuracy300: 0.3563 - val_loss: 3.2965 - val_accuracy300: 0.3462 - 13s/epoch - 41ms/step
Epoch 7/50
320/320 - 13s - loss: 3.2907 - accuracy300: 0.3569 - val_loss: 3.2951 - val_accuracy300: 0.3404 - 13s/epoch - 41ms/step
Epoch 8/50
320/320 - 13s - loss: 3.2871 - accuracy300: 0.3601 - val_loss: 3.2928 - val_accuracy300: 0.3523 - 13s/epoch - 41ms/step
Epoch 9/50
320/320 - 13s - loss: 3.2856 - accuracy300: 0.3646 - val_loss: 3.2957 - val_accuracy300: 0.3485 - 13s/epoch - 40ms/step
Epoch 10/50
320/320 - 13s - loss: 3.2857 - accuracy300: 0.3636 - val_loss: 3.2954 - val_accuracy300: 0.3497 - 13s/epoch - 41ms/step
Epoch 11/50
320/320 - 13s - loss: 3.2851 - accuracy300: 0.3615 - val_loss: 3.2932 - val_accuracy300: 0.3495 - 13s/epoch - 40ms/step
Epoch 12/50
320/320 - 13s - loss: 3.2798 - accuracy300: 0.3645 - val_loss: 3.2925 - val_accuracy300: 0.3469 - 13s/epoch - 41ms/step
Epoch 13/50
320/320 - 13s - loss: 3.2771 - accuracy300: 0.3702 - val_loss: 3.2949 - val_accuracy300: 0.3483 - 13s/epoch - 41ms/step
Epoch 14/50
320/320 - 14s - loss: 3.2742 - accuracy300: 0.3738 - val_loss: 3.2949 - val_accuracy300: 0.3497 - 14s/epoch - 43ms/step
Epoch 15/50
320/320 - 13s - loss: 3.2738 - accuracy300: 0.3714 - val_loss: 3.2968 - val_accuracy300: 0.3548 - 13s/epoch - 41ms/step
Epoch 16/50
320/320 - 13s - loss: 3.2727 - accuracy300: 0.3757 - val_loss: 3.3004 - val_accuracy300: 0.3477 - 13s/epoch - 41ms/step
Epoch 17/50
320/320 - 13s - loss: 3.2680 - accuracy300: 0.3785 - val_loss: 3.3047 - val_accuracy300: 0.3481 - 13s/epoch - 41ms/step
Epoch 18/50
320/320 - 13s - loss: 3.2701 - accuracy300: 0.3774 - val_loss: 3.3061 - val_accuracy300: 0.3522 - 13s/epoch - 41ms/step
Epoch 19/50
320/320 - 13s - loss: 3.2674 - accuracy300: 0.3777 - val_loss: 3.2995 - val_accuracy300: 0.3517 - 13s/epoch - 40ms/step
Epoch 20/50
320/320 - 13s - loss: 3.2636 - accuracy300: 0.3805 - val_loss: 3.3018 - val_accuracy300: 0.3493 - 13s/epoch - 41ms/step
Epoch 21/50
320/320 - 13s - loss: 3.2598 - accuracy300: 0.3836 - val_loss: 3.3043 - val_accuracy300: 0.3476 - 13s/epoch - 41ms/step
Epoch 22/50
320/320 - 13s - loss: 3.2558 - accuracy300: 0.3877 - val_loss: 3.3035 - val_accuracy300: 0.3483 - 13s/epoch - 41ms/step
testing model: results/CHTR/W2/deepVOL_L3/h300
Evaluating performance on  test set...
860/860 - 17s - 17s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.088698
{'0': {'precision': 0.33138857969011887, 'recall': 0.35551925769346915, 'f1-score': 0.34303007025885196, 'support': 72854}, '1': {'precision': 0.39764295067656047, 'recall': 0.015273190604724462, 'f1-score': 0.02941651328748103, 'support': 59647}, '2': {'precision': 0.4037019513384088, 'recall': 0.6440080967029951, 'f1-score': 0.4962963289371059, 'support': 87443}, 'accuracy': 0.3779416578765504, 'macro avg': {'precision': 0.3775778272350294, 'recall': 0.3382668483337296, 'f1-score': 0.289580970827813, 'support': 219944}, 'weighted avg': {'precision': 0.3781058014523388, 'recall': 0.3779416578765504, 'f1-score': 0.31891463007831145, 'support': 219944}}
[[25901   735 46218]
 [21774   911 36962]
 [30484   645 56314]]
Evaluating performance on  train set...
320/320 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0985929
{'0': {'precision': 0.35128821710752317, 'recall': 0.3724369013366355, 'f1-score': 0.3615535559601888, 'support': 27457}, '1': {'precision': 0.4349514563106796, 'recall': 0.02494802494802495, 'f1-score': 0.047189354306379695, 'support': 26936}, '2': {'precision': 0.3454249710937347, 'recall': 0.6459012789035875, 'f1-score': 0.45012513407222027, 'support': 27289}, 'accuracy': 0.3492079038221395, 'macro avg': {'precision': 0.3772215481706458, 'recall': 0.34776206839608265, 'f1-score': 0.2862893481129296, 'support': 81682}, 'weighted avg': {'precision': 0.376918721878537, 'recall': 0.3492079038221395, 'f1-score': 0.2874774517922231, 'support': 81682}}
[[10226   426 16805]
 [ 9668   672 16596]
 [ 9216   447 17626]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0972079
{'0': {'precision': 0.3546905500057412, 'recall': 0.3571098265895954, 'f1-score': 0.3558960769629587, 'support': 8650}, '1': {'precision': 0.4473684210526316, 'recall': 0.01523102521438628, 'f1-score': 0.029459091471716794, 'support': 7813}, '2': {'precision': 0.34780432878768924, 'recall': 0.6542715933160743, 'f1-score': 0.4541741545499101, 'support': 8498}, 'accuracy': 0.3512679780457514, 'macro avg': {'precision': 0.383287766615354, 'recall': 0.342204148373352, 'f1-score': 0.27984310766152853, 'support': 24961}, 'weighted avg': {'precision': 0.38135507060100376, 'recall': 0.3512679780457514, 'f1-score': 0.2871774733689857, 'support': 24961}}
[[3089   83 5478]
 [2746  119 4948]
 [2874   64 5560]]
training model: results/CHTR/W2/deepVOL_L3/h500
Epoch 1/50
320/320 - 15s - loss: 3.3406 - accuracy500: 0.3565 - val_loss: 3.3234 - val_accuracy500: 0.3308 - 15s/epoch - 48ms/step
Epoch 2/50
320/320 - 13s - loss: 3.3101 - accuracy500: 0.3562 - val_loss: 3.2980 - val_accuracy500: 0.3426 - 13s/epoch - 41ms/step
Epoch 3/50
320/320 - 13s - loss: 3.3033 - accuracy500: 0.3544 - val_loss: 3.2906 - val_accuracy500: 0.3487 - 13s/epoch - 41ms/step
Epoch 4/50
320/320 - 13s - loss: 3.2999 - accuracy500: 0.3524 - val_loss: 3.2926 - val_accuracy500: 0.3553 - 13s/epoch - 42ms/step
Epoch 5/50
320/320 - 13s - loss: 3.2980 - accuracy500: 0.3560 - val_loss: 3.2865 - val_accuracy500: 0.3508 - 13s/epoch - 42ms/step
Epoch 6/50
320/320 - 13s - loss: 3.2958 - accuracy500: 0.3592 - val_loss: 3.3274 - val_accuracy500: 0.3051 - 13s/epoch - 41ms/step
Epoch 7/50
320/320 - 14s - loss: 3.2972 - accuracy500: 0.3536 - val_loss: 3.2896 - val_accuracy500: 0.3524 - 14s/epoch - 42ms/step
Epoch 8/50
320/320 - 13s - loss: 3.2937 - accuracy500: 0.3543 - val_loss: 3.2878 - val_accuracy500: 0.3524 - 13s/epoch - 41ms/step
Epoch 9/50
320/320 - 13s - loss: 3.2924 - accuracy500: 0.3552 - val_loss: 3.2912 - val_accuracy500: 0.3527 - 13s/epoch - 41ms/step
Epoch 10/50
320/320 - 13s - loss: 3.2898 - accuracy500: 0.3578 - val_loss: 3.2946 - val_accuracy500: 0.3510 - 13s/epoch - 41ms/step
Epoch 11/50
320/320 - 13s - loss: 3.2892 - accuracy500: 0.3572 - val_loss: 3.2909 - val_accuracy500: 0.3475 - 13s/epoch - 41ms/step
Epoch 12/50
320/320 - 13s - loss: 3.2873 - accuracy500: 0.3590 - val_loss: 3.3000 - val_accuracy500: 0.3475 - 13s/epoch - 40ms/step
Epoch 13/50
320/320 - 13s - loss: 3.2835 - accuracy500: 0.3639 - val_loss: 3.3028 - val_accuracy500: 0.3434 - 13s/epoch - 42ms/step
Epoch 14/50
320/320 - 13s - loss: 3.2864 - accuracy500: 0.3614 - val_loss: 3.3014 - val_accuracy500: 0.3493 - 13s/epoch - 41ms/step
Epoch 15/50
320/320 - 13s - loss: 3.2818 - accuracy500: 0.3634 - val_loss: 3.3038 - val_accuracy500: 0.3494 - 13s/epoch - 42ms/step
testing model: results/CHTR/W2/deepVOL_L3/h500
Evaluating performance on  test set...
860/860 - 18s - 18s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.088122
{'0': {'precision': 0.33083350455448257, 'recall': 0.13557205203407194, 'f1-score': 0.19232951434856613, 'support': 71261}, '1': {'precision': 0.3944856839872747, 'recall': 0.012255184569009538, 'f1-score': 0.02377186676252097, 'support': 60709}, '2': {'precision': 0.4031802007879019, 'recall': 0.8655170845931752, 'f1-score': 0.5501065635949861, 'support': 87974}, 'accuracy': 0.39350016367802715, 'macro avg': {'precision': 0.3761664631098864, 'recall': 0.33778144039875224, 'f1-score': 0.25540264823535774, 'support': 219944}, 'weighted avg': {'precision': 0.3773402899890669, 'recall': 0.39350016367802715, 'f1-score': 0.2889091523614391, 'support': 219944}}
[[ 9661   537 61063]
 [ 8315   744 51650]
 [11226   605 76143]]
Evaluating performance on  train set...
320/320 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.100616
{'0': {'precision': 0.3392325763508222, 'recall': 0.15832176010525548, 'f1-score': 0.21588757101564837, 'support': 27362}, '1': {'precision': 0.4141048824593128, 'recall': 0.016987500463632656, 'f1-score': 0.03263619196921652, 'support': 26961}, '2': {'precision': 0.339217768339085, 'recall': 0.8407105522862678, 'f1-score': 0.4833920033625808, 'support': 27359}, 'accuracy': 0.340234078499547, 'macro avg': {'precision': 0.3641850757164067, 'recall': 0.3386732709517186, 'f1-score': 0.24397192211581523, 'support': 81682}, 'weighted avg': {'precision': 0.3639409222850292, 'recall': 0.340234078499547, 'f1-score': 0.24500063551099466, 'support': 81682}}
[[ 4332   351 22679]
 [ 4377   458 22126]
 [ 4061   297 23001]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0958228
{'0': {'precision': 0.3415576694411415, 'recall': 0.1313743425565973, 'f1-score': 0.1897605284888522, 'support': 8746}, '1': {'precision': 0.418848167539267, 'recall': 0.010715242432360031, 'f1-score': 0.020895912237168603, 'support': 7466}, '2': {'precision': 0.35233112211529477, 'recall': 0.8620413761572752, 'f1-score': 0.5002155529762892, 'support': 8749}, 'accuracy': 0.35138816553823965, 'macro avg': {'precision': 0.37091231969856775, 'recall': 0.33471032038207754, 'f1-score': 0.23695733123410334, 'support': 24961}, 'weighted avg': {'precision': 0.36845193634738616, 'recall': 0.35138816553823965, 'f1-score': 0.24806860045333742, 'support': 24961}}
[[1149   51 7546]
 [1068   80 6318]
 [1147   60 7542]]
training model: results/CHTR/W2/deepVOL_L3/h1000
Epoch 1/50
320/320 - 16s - loss: 3.3390 - accuracy1000: 0.3581 - val_loss: 3.3016 - val_accuracy1000: 0.3455 - 16s/epoch - 49ms/step
Epoch 2/50
320/320 - 13s - loss: 3.3081 - accuracy1000: 0.3670 - val_loss: 3.2884 - val_accuracy1000: 0.3493 - 13s/epoch - 42ms/step
Epoch 3/50
320/320 - 13s - loss: 3.3011 - accuracy1000: 0.3570 - val_loss: 3.2879 - val_accuracy1000: 0.3496 - 13s/epoch - 41ms/step
Epoch 4/50
320/320 - 13s - loss: 3.2975 - accuracy1000: 0.3553 - val_loss: 3.2826 - val_accuracy1000: 0.3525 - 13s/epoch - 41ms/step
Epoch 5/50
320/320 - 14s - loss: 3.2951 - accuracy1000: 0.3537 - val_loss: 3.2824 - val_accuracy1000: 0.3514 - 14s/epoch - 43ms/step
Epoch 6/50
320/320 - 13s - loss: 3.2946 - accuracy1000: 0.3484 - val_loss: 3.2809 - val_accuracy1000: 0.3507 - 13s/epoch - 41ms/step
Epoch 7/50
320/320 - 14s - loss: 3.2925 - accuracy1000: 0.3528 - val_loss: 3.2782 - val_accuracy1000: 0.3544 - 14s/epoch - 43ms/step
Epoch 8/50
320/320 - 13s - loss: 3.2909 - accuracy1000: 0.3533 - val_loss: 3.2768 - val_accuracy1000: 0.3556 - 13s/epoch - 42ms/step
Epoch 9/50
320/320 - 13s - loss: 3.2890 - accuracy1000: 0.3565 - val_loss: 3.2760 - val_accuracy1000: 0.3585 - 13s/epoch - 41ms/step
Epoch 10/50
320/320 - 13s - loss: 3.2875 - accuracy1000: 0.3579 - val_loss: 3.2779 - val_accuracy1000: 0.3538 - 13s/epoch - 41ms/step
Epoch 11/50
320/320 - 13s - loss: 3.2871 - accuracy1000: 0.3591 - val_loss: 3.2768 - val_accuracy1000: 0.3558 - 13s/epoch - 41ms/step
Epoch 12/50
320/320 - 13s - loss: 3.2847 - accuracy1000: 0.3621 - val_loss: 3.2785 - val_accuracy1000: 0.3548 - 13s/epoch - 41ms/step
Epoch 13/50
320/320 - 13s - loss: 3.2835 - accuracy1000: 0.3628 - val_loss: 3.2785 - val_accuracy1000: 0.3552 - 13s/epoch - 41ms/step
Epoch 14/50
320/320 - 13s - loss: 3.2817 - accuracy1000: 0.3635 - val_loss: 3.2772 - val_accuracy1000: 0.3561 - 13s/epoch - 41ms/step
Epoch 15/50
320/320 - 13s - loss: 3.2785 - accuracy1000: 0.3664 - val_loss: 3.2793 - val_accuracy1000: 0.3521 - 13s/epoch - 41ms/step
Epoch 16/50
320/320 - 13s - loss: 3.2768 - accuracy1000: 0.3700 - val_loss: 3.2797 - val_accuracy1000: 0.3528 - 13s/epoch - 41ms/step
Epoch 17/50
320/320 - 13s - loss: 3.2751 - accuracy1000: 0.3730 - val_loss: 3.2825 - val_accuracy1000: 0.3508 - 13s/epoch - 41ms/step
Epoch 18/50
320/320 - 13s - loss: 3.2716 - accuracy1000: 0.3750 - val_loss: 3.2842 - val_accuracy1000: 0.3509 - 13s/epoch - 41ms/step
Epoch 19/50
320/320 - 14s - loss: 3.2681 - accuracy1000: 0.3785 - val_loss: 3.2843 - val_accuracy1000: 0.3498 - 14s/epoch - 42ms/step
testing model: results/CHTR/W2/deepVOL_L3/h1000
Evaluating performance on  test set...
860/860 - 17s - 17s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0857795
{'0': {'precision': 0.31362395913512, 'recall': 0.13131179960448253, 'f1-score': 0.18511673051307734, 'support': 68265}, '1': {'precision': 0.3699707614380431, 'recall': 0.297650995593546, 'f1-score': 0.3298938787500459, 'support': 60366}, '2': {'precision': 0.4332824448864114, 'recall': 0.6775705540284516, 'f1-score': 0.5285657535592394, 'support': 91313}, 'accuracy': 0.40375277343323757, 'macro avg': {'precision': 0.3722923884865248, 'recall': 0.3688444497421601, 'f1-score': 0.3478587876074542, 'support': 219944}, 'weighted avg': {'precision': 0.37876693360692154, 'recall': 0.40375277343323757, 'f1-score': 0.36744031275167915, 'support': 219944}}
[[ 8964 13323 45978]
 [ 7451 17968 34947]
 [12167 17275 61871]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0949904
{'0': {'precision': 0.34888078098806824, 'recall': 0.1272021284245344, 'f1-score': 0.18643130022394938, 'support': 27814}, '1': {'precision': 0.37934254762794173, 'recall': 0.37627834593152515, 'f1-score': 0.37780423378845945, 'support': 26988}, '2': {'precision': 0.3446427374863193, 'recall': 0.5740327380952381, 'f1-score': 0.43069880392457893, 'support': 26880}, 'accuracy': 0.35654122083200707, 'macro avg': {'precision': 0.35762202203410975, 'recall': 0.3591710708170992, 'f1-score': 0.3316447793123292, 'support': 81682}, 'weighted avg': {'precision': 0.3575507884407493, 'recall': 0.35654122083200707, 'f1-score': 0.33004535510154687, 'support': 81682}}
[[ 3538  8541 15735]
 [ 3227 10155 13606]
 [ 3376  8074 15430]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0926919
{'0': {'precision': 0.35850773430391264, 'recall': 0.13205228466093175, 'f1-score': 0.1930111038536904, 'support': 8951}, '1': {'precision': 0.3717391304347826, 'recall': 0.31788607090691806, 'f1-score': 0.34270989907665883, 'support': 7531}, '2': {'precision': 0.34944823962165, 'recall': 0.627432480245312, 'f1-score': 0.4488883263721892, 'support': 8479}, 'accuracy': 0.3563959777252514, 'macro avg': {'precision': 0.3598983681201151, 'recall': 0.3591236119377206, 'f1-score': 0.3282031097675128, 'support': 24961}, 'weighted avg': {'precision': 0.3594223686875783, 'recall': 0.3563959777252514, 'f1-score': 0.32509573974802664, 'support': 24961}}
[[1182 2067 5702]
 [ 935 2394 4202]
 [1180 1979 5320]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        16 (peak)  11.35 (ave)

============================================
