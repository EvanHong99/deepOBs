This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/PCAR_orderbooks/PCAR_orderbooks_2019-05-22.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-05-14.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-05-01.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-05-02.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-05-10.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-05-06.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-05-08.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-05-03.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-05-24.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-05-07.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-05-20.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-05-09.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-04-30.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-05-16.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-05-15.csv
training model: results/PCAR/W3/deepLOB_L1/h10
Epoch 1/50
878/878 - 24s - loss: 3.2127 - accuracy10: 0.4188 - val_loss: 3.2870 - val_accuracy10: 0.3751 - 24s/epoch - 28ms/step
Epoch 2/50
878/878 - 14s - loss: 3.1386 - accuracy10: 0.4506 - val_loss: 3.2259 - val_accuracy10: 0.4054 - 14s/epoch - 16ms/step
Epoch 3/50
878/878 - 14s - loss: 3.0924 - accuracy10: 0.4693 - val_loss: 3.1586 - val_accuracy10: 0.4320 - 14s/epoch - 16ms/step
Epoch 4/50
878/878 - 14s - loss: 3.0696 - accuracy10: 0.4765 - val_loss: 3.1580 - val_accuracy10: 0.4322 - 14s/epoch - 16ms/step
Epoch 5/50
878/878 - 14s - loss: 3.0555 - accuracy10: 0.4802 - val_loss: 3.1498 - val_accuracy10: 0.4365 - 14s/epoch - 16ms/step
Epoch 6/50
878/878 - 14s - loss: 3.0457 - accuracy10: 0.4830 - val_loss: 3.1425 - val_accuracy10: 0.4417 - 14s/epoch - 15ms/step
Epoch 7/50
878/878 - 14s - loss: 3.0371 - accuracy10: 0.4870 - val_loss: 3.1351 - val_accuracy10: 0.4447 - 14s/epoch - 15ms/step
Epoch 8/50
878/878 - 13s - loss: 3.0292 - accuracy10: 0.4892 - val_loss: 3.1472 - val_accuracy10: 0.4416 - 13s/epoch - 15ms/step
Epoch 9/50
878/878 - 14s - loss: 3.0225 - accuracy10: 0.4906 - val_loss: 3.1580 - val_accuracy10: 0.4392 - 14s/epoch - 15ms/step
Epoch 10/50
878/878 - 14s - loss: 3.0147 - accuracy10: 0.4936 - val_loss: 3.1796 - val_accuracy10: 0.4339 - 14s/epoch - 15ms/step
Epoch 11/50
878/878 - 14s - loss: 3.0095 - accuracy10: 0.4950 - val_loss: 3.1792 - val_accuracy10: 0.4347 - 14s/epoch - 16ms/step
Epoch 12/50
878/878 - 14s - loss: 3.0044 - accuracy10: 0.4957 - val_loss: 3.1852 - val_accuracy10: 0.4327 - 14s/epoch - 16ms/step
Epoch 13/50
878/878 - 14s - loss: 2.9997 - accuracy10: 0.4972 - val_loss: 3.1947 - val_accuracy10: 0.4335 - 14s/epoch - 16ms/step
Epoch 14/50
878/878 - 14s - loss: 2.9948 - accuracy10: 0.4988 - val_loss: 3.1901 - val_accuracy10: 0.4343 - 14s/epoch - 16ms/step
Epoch 15/50
878/878 - 14s - loss: 2.9913 - accuracy10: 0.4995 - val_loss: 3.1613 - val_accuracy10: 0.4407 - 14s/epoch - 15ms/step
Epoch 16/50
878/878 - 14s - loss: 2.9881 - accuracy10: 0.5008 - val_loss: 3.1853 - val_accuracy10: 0.4373 - 14s/epoch - 15ms/step
Epoch 17/50
878/878 - 14s - loss: 2.9838 - accuracy10: 0.5012 - val_loss: 3.1835 - val_accuracy10: 0.4425 - 14s/epoch - 15ms/step
testing model: results/PCAR/W3/deepLOB_L1/h10
Evaluating performance on  test set...
2282/2282 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.045369
{'0': {'precision': 0.4716953905803966, 'recall': 0.4007227335959194, 'f1-score': 0.43332219058706906, 'support': 187621}, '1': {'precision': 0.3995609976967144, 'recall': 0.3918583660742729, 'f1-score': 0.39567219826010674, 'support': 207182}, '2': {'precision': 0.4537251147161903, 'recall': 0.5310055393462726, 'f1-score': 0.48933289171180294, 'support': 189192}, 'accuracy': 0.4397845871968082, 'macro avg': {'precision': 0.44166050099776705, 'recall': 0.4411955463388216, 'f1-score': 0.4394424268529929, 'support': 583995}, 'weighted avg': {'precision': 0.4402828267438433, 'recall': 0.4397845871968082, 'f1-score': 0.43811054640673525, 'support': 583995}}
[[ 75184  66088  46349]
 [ 51391  81186  74605]
 [ 32816  55914 100462]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0392151
{'0': {'precision': 0.5047889853337324, 'recall': 0.3629906642632301, 'f1-score': 0.4223046465405262, 'support': 74338}, '1': {'precision': 0.40805422747075787, 'recall': 0.4404559786563182, 'f1-score': 0.4236364461090843, 'support': 74214}, '2': {'precision': 0.46555165606492654, 'recall': 0.5571392946673491, 'f1-score': 0.5072443852280263, 'support': 76191}, 'accuracy': 0.45439012561014136, 'macro avg': {'precision': 0.45946495628980566, 'recall': 0.45352864586229913, 'f1-score': 0.4510618259592123, 'support': 224743}, 'weighted avg': {'precision': 0.45954350638950553, 'recall': 0.45439012561014136, 'f1-score': 0.45154018136706264, 'support': 224743}}
[[26984 25266 22088]
 [14883 32688 26643]
 [11589 22153 42449]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0442489
{'0': {'precision': 0.5077941082903862, 'recall': 0.3195083870451179, 'f1-score': 0.39222528012581087, 'support': 24979}, '1': {'precision': 0.4021168862859932, 'recall': 0.4880062189975568, 'f1-score': 0.4409177564467039, 'support': 27014}, '2': {'precision': 0.4598836000831428, 'recall': 0.5231733270276662, 'f1-score': 0.4894911504424779, 'support': 25374}, 'accuracy': 0.44513810797885406, 'macro avg': {'precision': 0.45659819821984077, 'recall': 0.44356264435678033, 'f1-score': 0.4408780623383309, 'support': 77367}, 'weighted avg': {'precision': 0.4551819388838269, 'recall': 0.44513810797885406, 'f1-score': 0.44112730228962377, 'support': 77367}}
[[ 7981 10576  6422]
 [ 4662 13183  9169]
 [ 3074  9025 13275]]
training model: results/PCAR/W3/deepLOB_L1/h20
Epoch 1/50
878/878 - 16s - loss: 3.2510 - accuracy20: 0.4010 - val_loss: 3.3993 - val_accuracy20: 0.3645 - 16s/epoch - 18ms/step
Epoch 2/50
878/878 - 14s - loss: 3.1998 - accuracy20: 0.4261 - val_loss: 3.2655 - val_accuracy20: 0.3892 - 14s/epoch - 16ms/step
Epoch 3/50
878/878 - 14s - loss: 3.1763 - accuracy20: 0.4355 - val_loss: 3.2480 - val_accuracy20: 0.4003 - 14s/epoch - 15ms/step
Epoch 4/50
878/878 - 14s - loss: 3.1555 - accuracy20: 0.4444 - val_loss: 3.2438 - val_accuracy20: 0.4117 - 14s/epoch - 16ms/step
Epoch 5/50
878/878 - 13s - loss: 3.1410 - accuracy20: 0.4492 - val_loss: 3.2119 - val_accuracy20: 0.4063 - 13s/epoch - 15ms/step
Epoch 6/50
878/878 - 14s - loss: 3.1315 - accuracy20: 0.4539 - val_loss: 3.2126 - val_accuracy20: 0.4116 - 14s/epoch - 16ms/step
Epoch 7/50
878/878 - 13s - loss: 3.1244 - accuracy20: 0.4555 - val_loss: 3.2157 - val_accuracy20: 0.4104 - 13s/epoch - 15ms/step
Epoch 8/50
878/878 - 14s - loss: 3.1185 - accuracy20: 0.4577 - val_loss: 3.2364 - val_accuracy20: 0.4062 - 14s/epoch - 16ms/step
Epoch 9/50
878/878 - 13s - loss: 3.1120 - accuracy20: 0.4598 - val_loss: 3.2296 - val_accuracy20: 0.4115 - 13s/epoch - 15ms/step
Epoch 10/50
878/878 - 13s - loss: 3.1083 - accuracy20: 0.4608 - val_loss: 3.2633 - val_accuracy20: 0.4015 - 13s/epoch - 15ms/step
Epoch 11/50
878/878 - 14s - loss: 3.1032 - accuracy20: 0.4634 - val_loss: 3.2451 - val_accuracy20: 0.4057 - 14s/epoch - 15ms/step
Epoch 12/50
878/878 - 14s - loss: 3.1000 - accuracy20: 0.4635 - val_loss: 3.2617 - val_accuracy20: 0.4037 - 14s/epoch - 15ms/step
Epoch 13/50
878/878 - 14s - loss: 3.0966 - accuracy20: 0.4640 - val_loss: 3.2670 - val_accuracy20: 0.4027 - 14s/epoch - 15ms/step
Epoch 14/50
878/878 - 14s - loss: 3.0933 - accuracy20: 0.4658 - val_loss: 3.2714 - val_accuracy20: 0.4033 - 14s/epoch - 15ms/step
Epoch 15/50
878/878 - 14s - loss: 3.0909 - accuracy20: 0.4663 - val_loss: 3.2760 - val_accuracy20: 0.4049 - 14s/epoch - 16ms/step
testing model: results/PCAR/W3/deepLOB_L1/h20
Evaluating performance on  test set...
2282/2282 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0671167
{'0': {'precision': 0.4601626404025469, 'recall': 0.303583977512298, 'f1-score': 0.36582290880021234, 'support': 190682}, '1': {'precision': 0.3937189552956257, 'recall': 0.24709508414325723, 'f1-score': 0.3036326060295267, 'support': 198887}, '2': {'precision': 0.407134886734498, 'recall': 0.6981010770164484, 'f1-score': 0.5143178692009504, 'support': 194426}, 'accuracy': 0.415690202827079, 'macro avg': {'precision': 0.42033882747755685, 'recall': 0.4162600462240012, 'f1-score': 0.39459112801022983, 'support': 583995}, 'weighted avg': {'precision': 0.41988017354148766, 'recall': 0.415690202827079, 'f1-score': 0.39408075077440824, 'support': 583995}}
[[ 57888  46710  86084]
 [ 38180  49144 111563]
 [ 29731  28966 135729]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0722026
{'0': {'precision': 0.47734497199656895, 'recall': 0.254560865353568, 'f1-score': 0.33204639980345013, 'support': 74328}, '1': {'precision': 0.3788341995312341, 'recall': 0.30097152880852784, 'f1-score': 0.335443799440551, 'support': 74110}, '2': {'precision': 0.411267003097594, 'recall': 0.6803354957080139, 'f1-score': 0.5126399778800387, 'support': 76305}, 'accuracy': 0.41442447595698195, 'macro avg': {'precision': 0.4224820582084657, 'recall': 0.41195596329003653, 'f1-score': 0.39337672570801335, 'support': 224743}, 'weighted avg': {'precision': 0.4224257408559227, 'recall': 0.41442447595698195, 'f1-score': 0.3944820452395244, 'support': 224743}}
[[18921 21323 34084]
 [11575 22305 40230]
 [ 9142 15250 51913]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0695772
{'0': {'precision': 0.4719945355191257, 'recall': 0.21930416154242868, 'f1-score': 0.2994663994149354, 'support': 25207}, '1': {'precision': 0.3625854443104142, 'recall': 0.4082625919637804, 'f1-score': 0.3840707022307406, 'support': 26505}, '2': {'precision': 0.4198989137415878, 'recall': 0.5861235626583512, 'f1-score': 0.48927862558162233, 'support': 25655}, 'accuracy': 0.4056768389623483, 'macro avg': {'precision': 0.4181596311903759, 'recall': 0.40456343872152006, 'f1-score': 0.3909385757424328, 'support': 77367}, 'weighted avg': {'precision': 0.4172373245740247, 'recall': 0.4056768389623483, 'f1-score': 0.39139279837624025, 'support': 77367}}
[[ 5528 10966  8713]
 [ 3623 10821 12061]
 [ 2561  8057 15037]]
training model: results/PCAR/W3/deepLOB_L1/h30
Epoch 1/50
878/878 - 16s - loss: 3.2674 - accuracy30: 0.3914 - val_loss: 3.3093 - val_accuracy30: 0.3630 - 16s/epoch - 18ms/step
Epoch 2/50
878/878 - 14s - loss: 3.2285 - accuracy30: 0.4096 - val_loss: 3.2623 - val_accuracy30: 0.3879 - 14s/epoch - 15ms/step
Epoch 3/50
878/878 - 14s - loss: 3.2134 - accuracy30: 0.4189 - val_loss: 3.2436 - val_accuracy30: 0.3942 - 14s/epoch - 15ms/step
Epoch 4/50
878/878 - 14s - loss: 3.1991 - accuracy30: 0.4229 - val_loss: 3.2482 - val_accuracy30: 0.3953 - 14s/epoch - 16ms/step
Epoch 5/50
878/878 - 14s - loss: 3.1885 - accuracy30: 0.4285 - val_loss: 3.2491 - val_accuracy30: 0.4007 - 14s/epoch - 16ms/step
Epoch 6/50
878/878 - 14s - loss: 3.1787 - accuracy30: 0.4320 - val_loss: 3.2342 - val_accuracy30: 0.4050 - 14s/epoch - 16ms/step
Epoch 7/50
878/878 - 14s - loss: 3.1718 - accuracy30: 0.4341 - val_loss: 3.2319 - val_accuracy30: 0.4091 - 14s/epoch - 15ms/step
Epoch 8/50
878/878 - 14s - loss: 3.1669 - accuracy30: 0.4365 - val_loss: 3.2382 - val_accuracy30: 0.4066 - 14s/epoch - 15ms/step
Epoch 9/50
878/878 - 14s - loss: 3.1631 - accuracy30: 0.4380 - val_loss: 3.2371 - val_accuracy30: 0.4042 - 14s/epoch - 15ms/step
Epoch 10/50
878/878 - 14s - loss: 3.1596 - accuracy30: 0.4399 - val_loss: 3.2643 - val_accuracy30: 0.4009 - 14s/epoch - 16ms/step
Epoch 11/50
878/878 - 14s - loss: 3.1563 - accuracy30: 0.4407 - val_loss: 3.2503 - val_accuracy30: 0.4017 - 14s/epoch - 16ms/step
Epoch 12/50
878/878 - 14s - loss: 3.1528 - accuracy30: 0.4421 - val_loss: 3.2358 - val_accuracy30: 0.4066 - 14s/epoch - 15ms/step
Epoch 13/50
878/878 - 14s - loss: 3.1497 - accuracy30: 0.4433 - val_loss: 3.2502 - val_accuracy30: 0.4047 - 14s/epoch - 15ms/step
Epoch 14/50
878/878 - 14s - loss: 3.1484 - accuracy30: 0.4438 - val_loss: 3.2593 - val_accuracy30: 0.4019 - 14s/epoch - 16ms/step
Epoch 15/50
878/878 - 13s - loss: 3.1452 - accuracy30: 0.4449 - val_loss: 3.2689 - val_accuracy30: 0.4011 - 13s/epoch - 15ms/step
Epoch 16/50
878/878 - 13s - loss: 3.1429 - accuracy30: 0.4469 - val_loss: 3.2704 - val_accuracy30: 0.3990 - 13s/epoch - 15ms/step
Epoch 17/50
878/878 - 14s - loss: 3.1411 - accuracy30: 0.4458 - val_loss: 3.2859 - val_accuracy30: 0.3945 - 14s/epoch - 15ms/step
testing model: results/PCAR/W3/deepLOB_L1/h30
Evaluating performance on  test set...
2282/2282 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0769938
{'0': {'precision': 0.435541622240965, 'recall': 0.4215674193647762, 'f1-score': 0.42844060394016953, 'support': 194766}, '1': {'precision': 0.41316352420277597, 'recall': 0.08716689232448545, 'f1-score': 0.14396158713099552, 'support': 190554}, '2': {'precision': 0.4004267105011315, 'recall': 0.7160538568013086, 'f1-score': 0.5136266565093301, 'support': 198675}, 'accuracy': 0.41263880683909965, 'macro avg': {'precision': 0.4163772856482908, 'recall': 0.40826272283019005, 'f1-score': 0.3620096158601651, 'support': 583995}, 'weighted avg': {'precision': 0.4162936985712752, 'recall': 0.41263880683909965, 'f1-score': 0.36459711970678166, 'support': 583995}}
[[ 82107  13550  99109]
 [ 60039  16610 113905]
 [ 46371  10042 142262]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0772806
{'0': {'precision': 0.44663495484782045, 'recall': 0.3229607534899969, 'f1-score': 0.37486061834769396, 'support': 74427}, '1': {'precision': 0.4173625825750966, 'recall': 0.18085580415614577, 'f1-score': 0.25235749074431707, 'support': 74059}, '2': {'precision': 0.3952878638364078, 'recall': 0.719658523151973, 'f1-score': 0.5102887163512949, 'support': 76257}, 'accuracy': 0.4107358182457296, 'macro avg': {'precision': 0.41976180041977496, 'recall': 0.4078250269327052, 'f1-score': 0.3791689418144353, 'support': 224743}, 'weighted avg': {'precision': 0.4195664466522239, 'recall': 0.4107358182457296, 'f1-score': 0.38044424650199515, 'support': 224743}}
[[24037 10628 39762]
 [16473 13394 44192]
 [13308  8070 54879]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0759107
{'0': {'precision': 0.44334743770568874, 'recall': 0.33582621082621084, 'f1-score': 0.38216818642350553, 'support': 25272}, '1': {'precision': 0.38354346383543464, 'recall': 0.2841046581972172, 'f1-score': 0.326418905710376, 'support': 26448}, '2': {'precision': 0.4040069370745218, 'recall': 0.6085702031426677, 'f1-score': 0.4856253889234599, 'support': 25647}, 'accuracy': 0.4085592048289322, 'macro avg': {'precision': 0.41029927953854844, 'recall': 0.4095003573886986, 'f1-score': 0.3980708270191138, 'support': 77367}, 'weighted avg': {'precision': 0.4098620845110707, 'recall': 0.4085592048289322, 'f1-score': 0.3974060772065975, 'support': 77367}}
[[ 8487  6545 10240]
 [ 6149  7514 12785]
 [ 4507  5532 15608]]
training model: results/PCAR/W3/deepLOB_L1/h50
Epoch 1/50
878/878 - 16s - loss: 3.2724 - accuracy50: 0.3876 - val_loss: 3.2986 - val_accuracy50: 0.3663 - 16s/epoch - 18ms/step
Epoch 2/50
878/878 - 14s - loss: 3.2461 - accuracy50: 0.3990 - val_loss: 3.2907 - val_accuracy50: 0.3570 - 14s/epoch - 15ms/step
Epoch 3/50
878/878 - 14s - loss: 3.2369 - accuracy50: 0.4032 - val_loss: 3.3078 - val_accuracy50: 0.3511 - 14s/epoch - 16ms/step
Epoch 4/50
878/878 - 14s - loss: 3.2298 - accuracy50: 0.4062 - val_loss: 3.3229 - val_accuracy50: 0.3511 - 14s/epoch - 15ms/step
Epoch 5/50
878/878 - 14s - loss: 3.2234 - accuracy50: 0.4099 - val_loss: 3.3227 - val_accuracy50: 0.3431 - 14s/epoch - 15ms/step
Epoch 6/50
878/878 - 13s - loss: 3.2147 - accuracy50: 0.4140 - val_loss: 3.3190 - val_accuracy50: 0.3474 - 13s/epoch - 15ms/step
Epoch 7/50
878/878 - 14s - loss: 3.2078 - accuracy50: 0.4174 - val_loss: 3.3568 - val_accuracy50: 0.3421 - 14s/epoch - 16ms/step
Epoch 8/50
878/878 - 14s - loss: 3.2051 - accuracy50: 0.4190 - val_loss: 3.3724 - val_accuracy50: 0.3431 - 14s/epoch - 15ms/step
Epoch 9/50
878/878 - 14s - loss: 3.2014 - accuracy50: 0.4201 - val_loss: 3.3942 - val_accuracy50: 0.3432 - 14s/epoch - 15ms/step
Epoch 10/50
878/878 - 14s - loss: 3.1964 - accuracy50: 0.4216 - val_loss: 3.4570 - val_accuracy50: 0.3405 - 14s/epoch - 16ms/step
Epoch 11/50
878/878 - 14s - loss: 3.1932 - accuracy50: 0.4230 - val_loss: 3.4690 - val_accuracy50: 0.3413 - 14s/epoch - 15ms/step
Epoch 12/50
878/878 - 13s - loss: 3.1911 - accuracy50: 0.4257 - val_loss: 3.4965 - val_accuracy50: 0.3447 - 13s/epoch - 15ms/step
testing model: results/PCAR/W3/deepLOB_L1/h50
Evaluating performance on  test set...
2282/2282 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0915656
{'0': {'precision': 0.4052398564040536, 'recall': 0.2462554007510401, 'f1-score': 0.30634913191798646, 'support': 212239}, '1': {'precision': 0.2944968432891138, 'recall': 0.3660602517585609, 'f1-score': 0.32640203066393186, 'support': 157373}, '2': {'precision': 0.41376292852544455, 'recall': 0.5006600336780435, 'f1-score': 0.45308258933282675, 'support': 214383}, 'accuracy': 0.37193126653481623, 'macro avg': {'precision': 0.37116654273953725, 'recall': 0.3709918953958815, 'f1-score': 0.36194458397158175, 'support': 583995}, 'weighted avg': {'precision': 0.3785260002368993, 'recall': 0.37193126653481623, 'f1-score': 0.36561837846172635, 'support': 583995}}
[[ 52265  73584  86390]
 [ 34081  57608  65684]
 [ 42627  64423 107333]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0938997
{'0': {'precision': 0.3837019444856761, 'recall': 0.17329686389659843, 'f1-score': 0.2387593748845458, 'support': 74583}, '1': {'precision': 0.34862163156977083, 'recall': 0.48514544523225406, 'f1-score': 0.405706105149247, 'support': 74186}, '2': {'precision': 0.38291960828968347, 'recall': 0.4426251085897807, 'f1-score': 0.41061333137965983, 'support': 75974}, 'accuracy': 0.36728173958699495, 'macro avg': {'precision': 0.3717477281150435, 'recall': 0.36702247257287773, 'f1-score': 0.3516929371378175, 'support': 224743}, 'weighted avg': {'precision': 0.3718577255149687, 'recall': 0.36728173958699495, 'f1-score': 0.351962200432736, 'support': 224743}}
[[12925 35146 26512]
 [10515 35991 27680]
 [10245 32101 33628]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0965848
{'0': {'precision': 0.38410194174757284, 'recall': 0.14905223499862644, 'f1-score': 0.21476434165512173, 'support': 25481}, '1': {'precision': 0.3413286589154167, 'recall': 0.5862870645628477, 'f1-score': 0.4314643928982133, 'support': 26238}, '2': {'precision': 0.3844540627370488, 'recall': 0.3359326263256394, 'f1-score': 0.35855927089619005, 'support': 25648}, 'accuracy': 0.3592875515400623, 'macro avg': {'precision': 0.36996155446667944, 'recall': 0.35709064196237117, 'f1-score': 0.3349293351498417, 'support': 77367}, 'weighted avg': {'precision': 0.3697126776451514, 'recall': 0.3592875515400623, 'f1-score': 0.33592489188572594, 'support': 77367}}
[[ 3798 15609  6074]
 [ 3134 15383  7721]
 [ 2956 14076  8616]]
training model: results/PCAR/W3/deepLOB_L1/h100
Epoch 1/50
878/878 - 16s - loss: 3.3068 - accuracy100: 0.3657 - val_loss: 3.3419 - val_accuracy100: 0.3480 - 16s/epoch - 18ms/step
Epoch 2/50
878/878 - 14s - loss: 3.2851 - accuracy100: 0.3704 - val_loss: 3.3324 - val_accuracy100: 0.3465 - 14s/epoch - 15ms/step
Epoch 3/50
878/878 - 14s - loss: 3.2769 - accuracy100: 0.3743 - val_loss: 3.3525 - val_accuracy100: 0.3483 - 14s/epoch - 15ms/step
Epoch 4/50
878/878 - 13s - loss: 3.2648 - accuracy100: 0.3808 - val_loss: 3.3527 - val_accuracy100: 0.3514 - 13s/epoch - 15ms/step
Epoch 5/50
878/878 - 14s - loss: 3.2579 - accuracy100: 0.3857 - val_loss: 3.3063 - val_accuracy100: 0.3536 - 14s/epoch - 16ms/step
Epoch 6/50
878/878 - 14s - loss: 3.2518 - accuracy100: 0.3901 - val_loss: 3.3060 - val_accuracy100: 0.3525 - 14s/epoch - 15ms/step
Epoch 7/50
878/878 - 14s - loss: 3.2466 - accuracy100: 0.3931 - val_loss: 3.3107 - val_accuracy100: 0.3531 - 14s/epoch - 15ms/step
Epoch 8/50
878/878 - 14s - loss: 3.2431 - accuracy100: 0.3966 - val_loss: 3.3033 - val_accuracy100: 0.3552 - 14s/epoch - 16ms/step
Epoch 9/50
878/878 - 13s - loss: 3.2375 - accuracy100: 0.3994 - val_loss: 3.3056 - val_accuracy100: 0.3541 - 13s/epoch - 15ms/step
Epoch 10/50
878/878 - 14s - loss: 3.2334 - accuracy100: 0.4012 - val_loss: 3.3067 - val_accuracy100: 0.3521 - 14s/epoch - 16ms/step
Epoch 11/50
878/878 - 13s - loss: 3.2312 - accuracy100: 0.4025 - val_loss: 3.3039 - val_accuracy100: 0.3569 - 13s/epoch - 15ms/step
Epoch 12/50
878/878 - 14s - loss: 3.2282 - accuracy100: 0.4036 - val_loss: 3.3095 - val_accuracy100: 0.3533 - 14s/epoch - 16ms/step
Epoch 13/50
878/878 - 14s - loss: 3.2260 - accuracy100: 0.4047 - val_loss: 3.3035 - val_accuracy100: 0.3554 - 14s/epoch - 15ms/step
Epoch 14/50
878/878 - 14s - loss: 3.2238 - accuracy100: 0.4065 - val_loss: 3.3059 - val_accuracy100: 0.3560 - 14s/epoch - 16ms/step
Epoch 15/50
878/878 - 14s - loss: 3.2218 - accuracy100: 0.4058 - val_loss: 3.3082 - val_accuracy100: 0.3550 - 14s/epoch - 15ms/step
Epoch 16/50
878/878 - 13s - loss: 3.2202 - accuracy100: 0.4084 - val_loss: 3.3245 - val_accuracy100: 0.3562 - 13s/epoch - 15ms/step
Epoch 17/50
878/878 - 14s - loss: 3.2179 - accuracy100: 0.4091 - val_loss: 3.3270 - val_accuracy100: 0.3538 - 14s/epoch - 15ms/step
Epoch 18/50
878/878 - 14s - loss: 3.2168 - accuracy100: 0.4098 - val_loss: 3.3385 - val_accuracy100: 0.3556 - 14s/epoch - 15ms/step
testing model: results/PCAR/W3/deepLOB_L1/h100
Evaluating performance on  test set...
2282/2282 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1060497
{'0': {'precision': 0.37533477872720317, 'recall': 0.029599010349093322, 'f1-score': 0.05487088654796308, 'support': 198858}, '1': {'precision': 0.32828017066573717, 'recall': 0.5203168245299958, 'f1-score': 0.4025696459544106, 'support': 188243}, '2': {'precision': 0.3583674134660977, 'recall': 0.49134051824839764, 'f1-score': 0.41444930448156353, 'support': 196894}, 'accuracy': 0.343451570647009, 'macro avg': {'precision': 0.35399412095301264, 'recall': 0.3470854510424956, 'f1-score': 0.2906299456613124, 'support': 583995}, 'weighted avg': {'precision': 0.3544468036571518, 'recall': 0.343451570647009, 'f1-score': 0.28817886108124885, 'support': 583995}}
[[  5886 104806  88166]
 [  5253  97946  85044]
 [  4543  95609  96742]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1050743
{'0': {'precision': 0.36065323565323565, 'recall': 0.03162811864225292, 'f1-score': 0.05815613309706636, 'support': 74712}, '1': {'precision': 0.3398517321674666, 'recall': 0.5750643293663558, 'f1-score': 0.42722303533558353, 'support': 74616}, '2': {'precision': 0.3624052298956849, 'recall': 0.4417821388317974, 'f1-score': 0.39817625546764823, 'support': 75415}, 'accuracy': 0.34968386112136973, 'macro avg': {'precision': 0.3543033992387958, 'recall': 0.3494915289468021, 'f1-score': 0.29451847463343267, 'support': 224743}, 'weighted avg': {'precision': 0.3543349150012028, 'recall': 0.34968386112136973, 'f1-score': 0.2947860326089828, 'support': 224743}}
[[ 2363 43168 29181]
 [ 2272 42909 29435]
 [ 1917 40181 33317]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1013318
{'0': {'precision': 0.35422061108234076, 'recall': 0.027218463987266215, 'f1-score': 0.05055245556335686, 'support': 25130}, '1': {'precision': 0.35128903333479733, 'recall': 0.5955917941844447, 'f1-score': 0.4419243891321464, 'support': 26859}, '2': {'precision': 0.35580975316074653, 'recall': 0.4191819686342501, 'f1-score': 0.38490484116072077, 'support': 25378}, 'accuracy': 0.3531092067677434, 'macro avg': {'precision': 0.3537731325259615, 'recall': 0.34733074226865374, 'f1-score': 0.29246056195207465, 'support': 77367}, 'weighted avg': {'precision': 0.35372414619349296, 'recall': 0.3531092067677434, 'f1-score': 0.29609711420869683, 'support': 77367}}
[[  684 15383  9063]
 [  665 15997 10197]
 [  582 14158 10638]]
training model: results/PCAR/W3/deepLOB_L1/h200
Epoch 1/50
878/878 - 16s - loss: 3.2944 - accuracy200: 0.3767 - val_loss: 3.3574 - val_accuracy200: 0.3481 - 16s/epoch - 18ms/step
Epoch 2/50
878/878 - 14s - loss: 3.2731 - accuracy200: 0.3833 - val_loss: 3.4350 - val_accuracy200: 0.3258 - 14s/epoch - 16ms/step
Epoch 3/50
878/878 - 14s - loss: 3.2718 - accuracy200: 0.3833 - val_loss: 3.4262 - val_accuracy200: 0.3248 - 14s/epoch - 16ms/step
Epoch 4/50
878/878 - 14s - loss: 3.2716 - accuracy200: 0.3858 - val_loss: 3.3893 - val_accuracy200: 0.3278 - 14s/epoch - 15ms/step
Epoch 5/50
878/878 - 14s - loss: 3.2674 - accuracy200: 0.3876 - val_loss: 3.3596 - val_accuracy200: 0.3321 - 14s/epoch - 15ms/step
Epoch 6/50
878/878 - 14s - loss: 3.2585 - accuracy200: 0.3908 - val_loss: 3.3827 - val_accuracy200: 0.3279 - 14s/epoch - 15ms/step
Epoch 7/50
878/878 - 13s - loss: 3.2534 - accuracy200: 0.3933 - val_loss: 3.3825 - val_accuracy200: 0.3298 - 13s/epoch - 15ms/step
Epoch 8/50
878/878 - 13s - loss: 3.2451 - accuracy200: 0.3980 - val_loss: 3.3988 - val_accuracy200: 0.3300 - 13s/epoch - 15ms/step
Epoch 9/50
878/878 - 13s - loss: 3.2381 - accuracy200: 0.4017 - val_loss: 3.3880 - val_accuracy200: 0.3361 - 13s/epoch - 15ms/step
Epoch 10/50
878/878 - 14s - loss: 3.2338 - accuracy200: 0.4050 - val_loss: 3.3870 - val_accuracy200: 0.3346 - 14s/epoch - 15ms/step
Epoch 11/50
878/878 - 14s - loss: 3.2258 - accuracy200: 0.4079 - val_loss: 3.4119 - val_accuracy200: 0.3242 - 14s/epoch - 15ms/step
testing model: results/PCAR/W3/deepLOB_L1/h200
Evaluating performance on  test set...
2282/2282 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1205109
{'0': {'precision': 0.36633402849513713, 'recall': 0.17687468533705988, 'f1-score': 0.23856471506585897, 'support': 212529}, '1': {'precision': 0.2833917911108749, 'recall': 0.3880264865323744, 'f1-score': 0.32755593548288026, 'support': 164914}, '2': {'precision': 0.3527273580956033, 'recall': 0.4364469963980015, 'f1-score': 0.3901464742528602, 'support': 206552}, 'accuracy': 0.32830931771676125, 'macro avg': {'precision': 0.33415105923387173, 'recall': 0.33378272275581194, 'f1-score': 0.31875570826719984, 'support': 583995}, 'weighted avg': {'precision': 0.3380995040208647, 'recall': 0.32830931771676125, 'f1-score': 0.31730753589043137, 'support': 583995}}
[[37591 82510 92428]
 [27923 63991 73000]
 [37100 79303 90149]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.116578
{'0': {'precision': 0.343463462072798, 'recall': 0.13231555567448955, 'f1-score': 0.19103641456582635, 'support': 74738}, '1': {'precision': 0.3380349618398118, 'recall': 0.5404992220794156, 'f1-score': 0.4159374495707987, 'support': 73915}, '2': {'precision': 0.34577251977110524, 'recall': 0.3533841503482718, 'f1-score': 0.3495369016281564, 'support': 76090}, 'accuracy': 0.34140774128671414, 'macro avg': {'precision': 0.3424236478945717, 'recall': 0.3420663093673923, 'f1-score': 0.3188369219215938, 'support': 224743}, 'weighted avg': {'precision': 0.3424598651000025, 'recall': 0.34140774128671414, 'f1-score': 0.3186660273367034, 'support': 224743}}
[[ 9889 39133 25716]
 [ 8804 39951 25160]
 [10099 39102 26889]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1195887
{'0': {'precision': 0.35153003400075555, 'recall': 0.07093847678585043, 'f1-score': 0.11805379345343824, 'support': 26234}, '1': {'precision': 0.3462183329888146, 'recall': 0.6046530284797432, 'f1-score': 0.44031605544114855, 'support': 24930}, '2': {'precision': 0.3544543351790846, 'recall': 0.3859863374422776, 'f1-score': 0.36954893399345967, 'support': 26203}, 'accuracy': 0.3496193467499063, 'macro avg': {'precision': 0.35073423405621823, 'recall': 0.35385928090262375, 'f1-score': 0.30930626096268216, 'support': 77367}, 'weighted avg': {'precision': 0.35080885775698323, 'recall': 0.3496193467499063, 'f1-score': 0.30707398757914817, 'support': 77367}}
[[ 1861 14298 10075]
 [ 1511 15074  8345]
 [ 1922 14167 10114]]
training model: results/PCAR/W3/deepLOB_L1/h300
Epoch 1/50
878/878 - 16s - loss: 3.3087 - accuracy300: 0.3676 - val_loss: 3.3857 - val_accuracy300: 0.3451 - 16s/epoch - 18ms/step
Epoch 2/50
878/878 - 14s - loss: 3.2860 - accuracy300: 0.3772 - val_loss: 3.3627 - val_accuracy300: 0.3453 - 14s/epoch - 16ms/step
Epoch 3/50
878/878 - 14s - loss: 3.2750 - accuracy300: 0.3818 - val_loss: 3.3669 - val_accuracy300: 0.3429 - 14s/epoch - 16ms/step
Epoch 4/50
878/878 - 14s - loss: 3.2781 - accuracy300: 0.3769 - val_loss: 3.3894 - val_accuracy300: 0.3445 - 14s/epoch - 16ms/step
Epoch 5/50
878/878 - 14s - loss: 3.2619 - accuracy300: 0.3901 - val_loss: 3.4297 - val_accuracy300: 0.3426 - 14s/epoch - 16ms/step
Epoch 6/50
878/878 - 14s - loss: 3.2498 - accuracy300: 0.3980 - val_loss: 3.4378 - val_accuracy300: 0.3383 - 14s/epoch - 15ms/step
Epoch 7/50
878/878 - 14s - loss: 3.2440 - accuracy300: 0.4018 - val_loss: 3.4473 - val_accuracy300: 0.3392 - 14s/epoch - 15ms/step
Epoch 8/50
878/878 - 14s - loss: 3.2345 - accuracy300: 0.4062 - val_loss: 3.4406 - val_accuracy300: 0.3414 - 14s/epoch - 15ms/step
Epoch 9/50
878/878 - 14s - loss: 3.2260 - accuracy300: 0.4104 - val_loss: 3.4359 - val_accuracy300: 0.3448 - 14s/epoch - 16ms/step
Epoch 10/50
878/878 - 14s - loss: 3.2240 - accuracy300: 0.4112 - val_loss: 3.4347 - val_accuracy300: 0.3420 - 14s/epoch - 15ms/step
Epoch 11/50
878/878 - 14s - loss: 3.2161 - accuracy300: 0.4155 - val_loss: 3.4139 - val_accuracy300: 0.3419 - 14s/epoch - 15ms/step
Epoch 12/50
878/878 - 13s - loss: 3.2104 - accuracy300: 0.4177 - val_loss: 3.4278 - val_accuracy300: 0.3462 - 13s/epoch - 15ms/step
testing model: results/PCAR/W3/deepLOB_L1/h300
Evaluating performance on  test set...
2282/2282 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1238531
{'0': {'precision': 0.3185206587691419, 'recall': 0.028360328469406657, 'f1-score': 0.05208328411941737, 'support': 194356}, '1': {'precision': 0.3578273266956481, 'recall': 0.18912161594600338, 'f1-score': 0.24745593958907122, 'support': 202383}, '2': {'precision': 0.3247093371037033, 'recall': 0.7971813987268765, 'f1-score': 0.4614571370720315, 'support': 187256}, 'accuracy': 0.3305918715057492, 'macro avg': {'precision': 0.3336857741894978, 'recall': 0.33822111438076224, 'f1-score': 0.25366545359350673, 'support': 583995}, 'weighted avg': {'precision': 0.3341267316382362, 'recall': 0.3305918715057492, 'f1-score': 0.2510538478064518, 'support': 583995}}
[[  5512  35973 152871]
 [  6531  38275 157577]
 [  5262  32717 149277]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1230786
{'0': {'precision': 0.3197621225983532, 'recall': 0.018810802082912848, 'f1-score': 0.03553138224193364, 'support': 74319}, '1': {'precision': 0.3372959754875965, 'recall': 0.30858074689020365, 'f1-score': 0.3223000316711827, 'support': 74201}, '2': {'precision': 0.34494743814226786, 'recall': 0.6900804219198929, 'f1-score': 0.4599711424948625, 'support': 76223}, 'accuracy': 0.3421463627343232, 'macro avg': {'precision': 0.33400184540940586, 'recall': 0.3391573236310032, 'f1-score': 0.27260085213599294, 'support': 224743}, 'weighted avg': {'precision': 0.33409284580191706, 'recall': 0.3421463627343232, 'f1-score': 0.27416214005000195, 'support': 224743}}
[[ 1398 22890 50031]
 [ 1448 22897 49856]
 [ 1526 22097 52600]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1199659
{'0': {'precision': 0.3389570552147239, 'recall': 0.04291595463725338, 'f1-score': 0.07618587975730833, 'support': 25748}, '1': {'precision': 0.3535535761265832, 'recall': 0.3631906104011428, 'f1-score': 0.35830730555343954, 'support': 25901}, '2': {'precision': 0.33985263157894735, 'recall': 0.6276926666148223, 'f1-score': 0.44095714168647054, 'support': 25718}, 'accuracy': 0.3445267362053589, 'macro avg': {'precision': 0.34412108764008487, 'recall': 0.3445997438844062, 'f1-score': 0.2918167756657395, 'support': 77367}, 'weighted avg': {'precision': 0.3441413963559491, 'recall': 0.3445267362053589, 'f1-score': 0.29189043549605725, 'support': 77367}}
[[ 1105  8720 15923]
 [ 1060  9407 15434]
 [ 1095  8480 16143]]
training model: results/PCAR/W3/deepLOB_L1/h500
Epoch 1/50
878/878 - 16s - loss: 3.3072 - accuracy500: 0.3701 - val_loss: 3.5088 - val_accuracy500: 0.3364 - 16s/epoch - 18ms/step
Epoch 2/50
878/878 - 14s - loss: 3.2807 - accuracy500: 0.3825 - val_loss: 3.5393 - val_accuracy500: 0.3324 - 14s/epoch - 16ms/step
Epoch 3/50
878/878 - 14s - loss: 3.2672 - accuracy500: 0.3891 - val_loss: 3.5136 - val_accuracy500: 0.3330 - 14s/epoch - 16ms/step
Epoch 4/50
878/878 - 14s - loss: 3.2511 - accuracy500: 0.4019 - val_loss: 3.4331 - val_accuracy500: 0.3369 - 14s/epoch - 16ms/step
Epoch 5/50
878/878 - 14s - loss: 3.2302 - accuracy500: 0.4116 - val_loss: 3.4374 - val_accuracy500: 0.3356 - 14s/epoch - 16ms/step
Epoch 6/50
878/878 - 14s - loss: 3.2227 - accuracy500: 0.4166 - val_loss: 3.4261 - val_accuracy500: 0.3349 - 14s/epoch - 16ms/step
Epoch 7/50
878/878 - 14s - loss: 3.2115 - accuracy500: 0.4183 - val_loss: 3.5160 - val_accuracy500: 0.3318 - 14s/epoch - 15ms/step
Epoch 8/50
878/878 - 14s - loss: 3.2030 - accuracy500: 0.4242 - val_loss: 3.4563 - val_accuracy500: 0.3403 - 14s/epoch - 15ms/step
Epoch 9/50
878/878 - 14s - loss: 3.1947 - accuracy500: 0.4270 - val_loss: 3.5664 - val_accuracy500: 0.3353 - 14s/epoch - 15ms/step
Epoch 10/50
878/878 - 13s - loss: 3.1893 - accuracy500: 0.4287 - val_loss: 3.5392 - val_accuracy500: 0.3379 - 13s/epoch - 15ms/step
Epoch 11/50
878/878 - 14s - loss: 3.1842 - accuracy500: 0.4308 - val_loss: 3.5194 - val_accuracy500: 0.3423 - 14s/epoch - 15ms/step
Epoch 12/50
878/878 - 14s - loss: 3.1765 - accuracy500: 0.4348 - val_loss: 3.5418 - val_accuracy500: 0.3360 - 14s/epoch - 15ms/step
Epoch 13/50
878/878 - 14s - loss: 3.1703 - accuracy500: 0.4368 - val_loss: 3.5237 - val_accuracy500: 0.3407 - 14s/epoch - 15ms/step
Epoch 14/50
878/878 - 13s - loss: 3.1654 - accuracy500: 0.4405 - val_loss: 3.5211 - val_accuracy500: 0.3390 - 13s/epoch - 15ms/step
Epoch 15/50
878/878 - 13s - loss: 3.1613 - accuracy500: 0.4417 - val_loss: 3.4504 - val_accuracy500: 0.3432 - 13s/epoch - 15ms/step
Epoch 16/50
878/878 - 13s - loss: 3.1552 - accuracy500: 0.4433 - val_loss: 3.4747 - val_accuracy500: 0.3472 - 13s/epoch - 15ms/step
testing model: results/PCAR/W3/deepLOB_L1/h500
Evaluating performance on  test set...
2282/2282 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1374506
{'0': {'precision': 0.3383028447094851, 'recall': 0.021193992174681306, 'f1-score': 0.0398890176925562, 'support': 198075}, '1': {'precision': 0.34512299791103684, 'recall': 0.8601021355156653, 'f1-score': 0.49259017138959155, 'support': 201497}, '2': {'precision': 0.3161200178615156, 'recall': 0.1189981726791127, 'f1-score': 0.17290798358059611, 'support': 184423}, 'accuracy': 0.34153032132124417, 'macro avg': {'precision': 0.33318195349401253, 'recall': 0.33343143345648646, 'f1-score': 0.23512905755424796, 'support': 583995}, 'weighted avg': {'precision': 0.3336507790819883, 'recall': 0.34153032132124417, 'f1-score': 0.2380922233920254, 'support': 583995}}
[[  4198 170142  23735]
 [  4447 173308  23742]
 [  3764 158713  21946]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1492406
{'0': {'precision': 0.34680927281101276, 'recall': 0.0914155448242372, 'f1-score': 0.1446917534027222, 'support': 74134}, '1': {'precision': 0.3285918893008536, 'recall': 0.7672195253505933, 'f1-score': 0.4601195241676574, 'support': 74160}, '2': {'precision': 0.3321892161757364, 'recall': 0.13925623618359953, 'f1-score': 0.19624505746702675, 'support': 76449}, 'accuracy': 0.33068883124279735, 'macro avg': {'precision': 0.3358634594292009, 'recall': 0.33263043545281, 'f1-score': 0.26701877834580207, 'support': 224743}, 'weighted avg': {'precision': 0.3358247710876058, 'recall': 0.33068883124279735, 'f1-score': 0.26631210207805184, 'support': 224743}}
[[ 6777 56832 10525]
 [ 6386 56897 10877]
 [ 6378 59425 10646]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1425705
{'0': {'precision': 0.35565284573783157, 'recall': 0.0540614601683304, 'f1-score': 0.09385619138235694, 'support': 25545}, '1': {'precision': 0.33195244350139774, 'recall': 0.7694289394589953, 'f1-score': 0.4638063081610804, 'support': 25619}, '2': {'precision': 0.3467593249184513, 'recall': 0.18661985268862344, 'f1-score': 0.2426497953107555, 'support': 26203}, 'accuracy': 0.3358408623831866, 'macro avg': {'precision': 0.34478820471922683, 'recall': 0.3367034174386497, 'f1-score': 0.2667707649513976, 'support': 77367}, 'weighted avg': {'precision': 0.3447926917842671, 'recall': 0.3358408623831866, 'f1-score': 0.2667540786662111, 'support': 77367}}
[[ 1381 19569  4595]
 [ 1290 19712  4617]
 [ 1212 20101  4890]]
training model: results/PCAR/W3/deepLOB_L1/h1000
Epoch 1/50
878/878 - 16s - loss: 3.2993 - accuracy1000: 0.3831 - val_loss: 3.5230 - val_accuracy1000: 0.3429 - 16s/epoch - 18ms/step
Epoch 2/50
878/878 - 14s - loss: 3.2472 - accuracy1000: 0.4056 - val_loss: 3.4007 - val_accuracy1000: 0.3353 - 14s/epoch - 16ms/step
Epoch 3/50
878/878 - 14s - loss: 3.2310 - accuracy1000: 0.4160 - val_loss: 3.5128 - val_accuracy1000: 0.3345 - 14s/epoch - 15ms/step
Epoch 4/50
878/878 - 14s - loss: 3.2089 - accuracy1000: 0.4260 - val_loss: 3.4663 - val_accuracy1000: 0.3447 - 14s/epoch - 16ms/step
Epoch 5/50
878/878 - 14s - loss: 3.1943 - accuracy1000: 0.4300 - val_loss: 3.5007 - val_accuracy1000: 0.3372 - 14s/epoch - 16ms/step
Epoch 6/50
878/878 - 14s - loss: 3.1718 - accuracy1000: 0.4391 - val_loss: 3.5181 - val_accuracy1000: 0.3428 - 14s/epoch - 16ms/step
Epoch 7/50
878/878 - 13s - loss: 3.1601 - accuracy1000: 0.4432 - val_loss: 3.5852 - val_accuracy1000: 0.3395 - 13s/epoch - 15ms/step
Epoch 8/50
878/878 - 13s - loss: 3.1469 - accuracy1000: 0.4488 - val_loss: 3.7203 - val_accuracy1000: 0.3457 - 13s/epoch - 15ms/step
Epoch 9/50
878/878 - 14s - loss: 3.1298 - accuracy1000: 0.4557 - val_loss: 3.7390 - val_accuracy1000: 0.3472 - 14s/epoch - 16ms/step
Epoch 10/50
878/878 - 14s - loss: 3.1202 - accuracy1000: 0.4580 - val_loss: 3.6939 - val_accuracy1000: 0.3489 - 14s/epoch - 15ms/step
Epoch 11/50
878/878 - 13s - loss: 3.1119 - accuracy1000: 0.4604 - val_loss: 3.7405 - val_accuracy1000: 0.3447 - 13s/epoch - 15ms/step
Epoch 12/50
878/878 - 13s - loss: 3.0990 - accuracy1000: 0.4664 - val_loss: 3.7772 - val_accuracy1000: 0.3454 - 13s/epoch - 15ms/step
testing model: results/PCAR/W3/deepLOB_L1/h1000
Evaluating performance on  test set...
2282/2282 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1379061
{'0': {'precision': 0.3430218735140276, 'recall': 0.05579538148436405, 'f1-score': 0.09597897809247811, 'support': 206863}, '1': {'precision': 0.33407816264152024, 'recall': 0.5380392277139658, 'f1-score': 0.4122086283601729, 'support': 195627}, '2': {'precision': 0.31865049344202373, 'recall': 0.41306851050935234, 'f1-score': 0.35976784527496986, 'support': 181505}, 'accuracy': 0.3283778114538652, 'macro avg': {'precision': 0.3319168431991905, 'recall': 0.3356343732358941, 'f1-score': 0.28931848390920695, 'support': 583995}, 'weighted avg': {'precision': 0.33245130584337107, 'recall': 0.3283778114538652, 'f1-score': 0.28389506663925757, 'support': 583995}}
[[ 11542 113131  82190]
 [ 12250 105255  78122]
 [  9856  96675  74974]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1334989
{'0': {'precision': 0.33258990800111515, 'recall': 0.04873565096613424, 'f1-score': 0.08501389581700278, 'support': 73437}, '1': {'precision': 0.3307324147933285, 'recall': 0.6146133735816511, 'f1-score': 0.43004912638020615, 'support': 74206}, '2': {'precision': 0.35198864383165535, 'recall': 0.34734111543450064, 'f1-score': 0.3496494366178794, 'support': 77100}, 'accuracy': 0.33801720187058104, 'macro avg': {'precision': 0.3384369888753663, 'recall': 0.3368967133274287, 'f1-score': 0.2882374862716961, 'support': 224743}, 'weighted avg': {'precision': 0.3386314994702939, 'recall': 0.33801720187058104, 'f1-score': 0.2897236510259332, 'support': 224743}}
[[ 3579 45684 24174]
 [ 3470 45608 25128]
 [ 3712 46608 26780]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.133042
{'0': {'precision': 0.34828832660004255, 'recall': 0.06355488301711093, 'f1-score': 0.10749442184013651, 'support': 25773}, '1': {'precision': 0.3236890795600106, 'recall': 0.638511210042915, 'f1-score': 0.4295968481839279, 'support': 24933}, '2': {'precision': 0.3543716196073421, 'recall': 0.31210382206218823, 'f1-score': 0.331897411351761, 'support': 26661}, 'accuracy': 0.3344966200059457, 'macro avg': {'precision': 0.3421163419224651, 'recall': 0.33805663837407146, 'f1-score': 0.2896628937919418, 'support': 77367}, 'weighted avg': {'precision': 0.342457076175682, 'recall': 0.3344966200059457, 'f1-score': 0.28862834068666243, 'support': 77367}}
[[ 1638 16528  7607]
 [ 1460 15920  7553]
 [ 1605 16735  8321]]
training model: results/PCAR/W3/deepOF_L1/h10
Epoch 1/50
878/878 - 15s - loss: 3.2730 - accuracy10: 0.3951 - val_loss: 3.2378 - val_accuracy10: 0.4013 - 15s/epoch - 18ms/step
Epoch 2/50
878/878 - 12s - loss: 3.2399 - accuracy10: 0.4090 - val_loss: 3.2248 - val_accuracy10: 0.4105 - 12s/epoch - 14ms/step
Epoch 3/50
878/878 - 12s - loss: 3.2290 - accuracy10: 0.4122 - val_loss: 3.2179 - val_accuracy10: 0.4144 - 12s/epoch - 14ms/step
Epoch 4/50
878/878 - 12s - loss: 3.2213 - accuracy10: 0.4159 - val_loss: 3.2119 - val_accuracy10: 0.4186 - 12s/epoch - 14ms/step
Epoch 5/50
878/878 - 12s - loss: 3.2173 - accuracy10: 0.4172 - val_loss: 3.2085 - val_accuracy10: 0.4205 - 12s/epoch - 14ms/step
Epoch 6/50
878/878 - 12s - loss: 3.2125 - accuracy10: 0.4185 - val_loss: 3.2073 - val_accuracy10: 0.4200 - 12s/epoch - 14ms/step
Epoch 7/50
878/878 - 12s - loss: 3.2095 - accuracy10: 0.4206 - val_loss: 3.2049 - val_accuracy10: 0.4222 - 12s/epoch - 14ms/step
Epoch 8/50
878/878 - 12s - loss: 3.2065 - accuracy10: 0.4216 - val_loss: 3.2022 - val_accuracy10: 0.4244 - 12s/epoch - 14ms/step
Epoch 9/50
878/878 - 12s - loss: 3.2033 - accuracy10: 0.4236 - val_loss: 3.2012 - val_accuracy10: 0.4242 - 12s/epoch - 14ms/step
Epoch 10/50
878/878 - 12s - loss: 3.2011 - accuracy10: 0.4241 - val_loss: 3.1996 - val_accuracy10: 0.4234 - 12s/epoch - 14ms/step
Epoch 11/50
878/878 - 12s - loss: 3.1990 - accuracy10: 0.4251 - val_loss: 3.1979 - val_accuracy10: 0.4255 - 12s/epoch - 14ms/step
Epoch 12/50
878/878 - 12s - loss: 3.1962 - accuracy10: 0.4264 - val_loss: 3.1977 - val_accuracy10: 0.4247 - 12s/epoch - 14ms/step
Epoch 13/50
878/878 - 12s - loss: 3.1936 - accuracy10: 0.4271 - val_loss: 3.1982 - val_accuracy10: 0.4245 - 12s/epoch - 14ms/step
Epoch 14/50
878/878 - 12s - loss: 3.1913 - accuracy10: 0.4277 - val_loss: 3.1969 - val_accuracy10: 0.4267 - 12s/epoch - 14ms/step
Epoch 15/50
878/878 - 12s - loss: 3.1887 - accuracy10: 0.4294 - val_loss: 3.1971 - val_accuracy10: 0.4252 - 12s/epoch - 14ms/step
Epoch 16/50
878/878 - 12s - loss: 3.1859 - accuracy10: 0.4307 - val_loss: 3.1967 - val_accuracy10: 0.4260 - 12s/epoch - 14ms/step
Epoch 17/50
878/878 - 12s - loss: 3.1850 - accuracy10: 0.4311 - val_loss: 3.1952 - val_accuracy10: 0.4273 - 12s/epoch - 14ms/step
Epoch 18/50
878/878 - 12s - loss: 3.1820 - accuracy10: 0.4321 - val_loss: 3.1965 - val_accuracy10: 0.4274 - 12s/epoch - 14ms/step
Epoch 19/50
878/878 - 12s - loss: 3.1799 - accuracy10: 0.4335 - val_loss: 3.1955 - val_accuracy10: 0.4252 - 12s/epoch - 14ms/step
Epoch 20/50
878/878 - 12s - loss: 3.1772 - accuracy10: 0.4333 - val_loss: 3.1970 - val_accuracy10: 0.4253 - 12s/epoch - 14ms/step
Epoch 21/50
878/878 - 12s - loss: 3.1747 - accuracy10: 0.4351 - val_loss: 3.1965 - val_accuracy10: 0.4255 - 12s/epoch - 14ms/step
Epoch 22/50
878/878 - 12s - loss: 3.1730 - accuracy10: 0.4354 - val_loss: 3.1954 - val_accuracy10: 0.4260 - 12s/epoch - 14ms/step
Epoch 23/50
878/878 - 12s - loss: 3.1706 - accuracy10: 0.4370 - val_loss: 3.1989 - val_accuracy10: 0.4245 - 12s/epoch - 14ms/step
Epoch 24/50
878/878 - 12s - loss: 3.1678 - accuracy10: 0.4376 - val_loss: 3.1976 - val_accuracy10: 0.4250 - 12s/epoch - 14ms/step
Epoch 25/50
878/878 - 12s - loss: 3.1654 - accuracy10: 0.4391 - val_loss: 3.1983 - val_accuracy10: 0.4233 - 12s/epoch - 14ms/step
Epoch 26/50
878/878 - 12s - loss: 3.1638 - accuracy10: 0.4396 - val_loss: 3.1991 - val_accuracy10: 0.4233 - 12s/epoch - 13ms/step
Epoch 27/50
878/878 - 12s - loss: 3.1606 - accuracy10: 0.4418 - val_loss: 3.1979 - val_accuracy10: 0.4255 - 12s/epoch - 14ms/step
testing model: results/PCAR/W3/deepOF_L1/h10
Evaluating performance on  test set...
2282/2282 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0732043
{'0': {'precision': 0.4392371049317449, 'recall': 0.34762285470632126, 'f1-score': 0.38809664779370856, 'support': 187620}, '1': {'precision': 0.38164487645975664, 'recall': 0.4591782064957694, 'f1-score': 0.4168368196436865, 'support': 207181}, '2': {'precision': 0.4216707028292515, 'recall': 0.41508007822823617, 'f1-score': 0.418349435170461, 'support': 189190}, 'accuracy': 0.4090525367685461, 'macro avg': {'precision': 0.41418422807358435, 'recall': 0.40729371314344226, 'f1-score': 0.4077609675359521, 'support': 583991}, 'weighted avg': {'precision': 0.41311443677277365, 'recall': 0.4090525367685461, 'f1-score': 0.4080934326548761, 'support': 583991}}
[[65221 79145 43254]
 [47598 95133 64450]
 [35668 74993 78529]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0692868
{'0': {'precision': 0.44993234100135315, 'recall': 0.3754991193987712, 'f1-score': 0.4093597250415882, 'support': 74381}, '1': {'precision': 0.3816485369177117, 'recall': 0.44483027806939623, 'f1-score': 0.4108243834526651, 'support': 74298}, '2': {'precision': 0.44092707744488413, 'recall': 0.440956062159817, 'f1-score': 0.4409415693260325, 'support': 76062}, 'accuracy': 0.4205730151596727, 'macro avg': {'precision': 0.4241693184546496, 'recall': 0.42042848654266146, 'f1-score': 0.42037522594009524, 'support': 224741}, 'weighted avg': {'precision': 0.42431036533853006, 'recall': 0.4205730151596727, 'f1-score': 0.4205325837126344, 'support': 224741}}
[[27930 26903 19548]
 [18269 33050 22979]
 [15877 26645 33540]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0649401
{'0': {'precision': 0.4481650275845527, 'recall': 0.3730681682041452, 'f1-score': 0.40718301878568625, 'support': 25041}, '1': {'precision': 0.40357928002198407, 'recall': 0.43642509565023585, 'f1-score': 0.4193600199882212, 'support': 26921}, '2': {'precision': 0.43057278365560014, 'recall': 0.4645542216099193, 'f1-score': 0.44691848906560633, 'support': 25405}, 'accuracy': 0.4251554280248685, 'macro avg': {'precision': 0.4274390304207123, 'recall': 0.42468249515476675, 'f1-score': 0.4244871759465046, 'support': 77367}, 'weighted avg': {'precision': 0.4268739879016524, 'recall': 0.4251554280248685, 'f1-score': 0.42446812318206734, 'support': 77367}}
[[ 9342  8897  6802]
 [ 6366 11749  8806]
 [ 5137  8466 11802]]
training model: results/PCAR/W3/deepOF_L1/h20
Epoch 1/50
878/878 - 14s - loss: 3.2833 - accuracy20: 0.3857 - val_loss: 3.2490 - val_accuracy20: 0.3927 - 14s/epoch - 16ms/step
Epoch 2/50
878/878 - 12s - loss: 3.2517 - accuracy20: 0.3995 - val_loss: 3.2385 - val_accuracy20: 0.4028 - 12s/epoch - 14ms/step
Epoch 3/50
878/878 - 12s - loss: 3.2421 - accuracy20: 0.4021 - val_loss: 3.2325 - val_accuracy20: 0.4079 - 12s/epoch - 14ms/step
Epoch 4/50
878/878 - 12s - loss: 3.2375 - accuracy20: 0.4058 - val_loss: 3.2297 - val_accuracy20: 0.4097 - 12s/epoch - 14ms/step
Epoch 5/50
878/878 - 12s - loss: 3.2336 - accuracy20: 0.4061 - val_loss: 3.2269 - val_accuracy20: 0.4114 - 12s/epoch - 14ms/step
Epoch 6/50
878/878 - 12s - loss: 3.2307 - accuracy20: 0.4079 - val_loss: 3.2249 - val_accuracy20: 0.4136 - 12s/epoch - 14ms/step
Epoch 7/50
878/878 - 12s - loss: 3.2289 - accuracy20: 0.4089 - val_loss: 3.2247 - val_accuracy20: 0.4126 - 12s/epoch - 14ms/step
Epoch 8/50
878/878 - 12s - loss: 3.2269 - accuracy20: 0.4092 - val_loss: 3.2229 - val_accuracy20: 0.4114 - 12s/epoch - 14ms/step
Epoch 9/50
878/878 - 12s - loss: 3.2243 - accuracy20: 0.4104 - val_loss: 3.2214 - val_accuracy20: 0.4121 - 12s/epoch - 14ms/step
Epoch 10/50
878/878 - 12s - loss: 3.2224 - accuracy20: 0.4116 - val_loss: 3.2208 - val_accuracy20: 0.4124 - 12s/epoch - 14ms/step
Epoch 11/50
878/878 - 12s - loss: 3.2206 - accuracy20: 0.4132 - val_loss: 3.2214 - val_accuracy20: 0.4111 - 12s/epoch - 14ms/step
Epoch 12/50
878/878 - 12s - loss: 3.2189 - accuracy20: 0.4136 - val_loss: 3.2207 - val_accuracy20: 0.4137 - 12s/epoch - 14ms/step
Epoch 13/50
878/878 - 12s - loss: 3.2176 - accuracy20: 0.4154 - val_loss: 3.2194 - val_accuracy20: 0.4143 - 12s/epoch - 14ms/step
Epoch 14/50
878/878 - 12s - loss: 3.2157 - accuracy20: 0.4157 - val_loss: 3.2193 - val_accuracy20: 0.4136 - 12s/epoch - 14ms/step
Epoch 15/50
878/878 - 12s - loss: 3.2140 - accuracy20: 0.4170 - val_loss: 3.2188 - val_accuracy20: 0.4136 - 12s/epoch - 14ms/step
Epoch 16/50
878/878 - 12s - loss: 3.2111 - accuracy20: 0.4177 - val_loss: 3.2191 - val_accuracy20: 0.4132 - 12s/epoch - 14ms/step
Epoch 17/50
878/878 - 12s - loss: 3.2107 - accuracy20: 0.4188 - val_loss: 3.2180 - val_accuracy20: 0.4153 - 12s/epoch - 14ms/step
Epoch 18/50
878/878 - 12s - loss: 3.2095 - accuracy20: 0.4193 - val_loss: 3.2185 - val_accuracy20: 0.4138 - 12s/epoch - 14ms/step
Epoch 19/50
878/878 - 12s - loss: 3.2073 - accuracy20: 0.4200 - val_loss: 3.2176 - val_accuracy20: 0.4139 - 12s/epoch - 14ms/step
Epoch 20/50
878/878 - 12s - loss: 3.2053 - accuracy20: 0.4208 - val_loss: 3.2191 - val_accuracy20: 0.4137 - 12s/epoch - 14ms/step
Epoch 21/50
878/878 - 12s - loss: 3.2031 - accuracy20: 0.4229 - val_loss: 3.2165 - val_accuracy20: 0.4147 - 12s/epoch - 14ms/step
Epoch 22/50
878/878 - 12s - loss: 3.2016 - accuracy20: 0.4223 - val_loss: 3.2159 - val_accuracy20: 0.4146 - 12s/epoch - 14ms/step
Epoch 23/50
878/878 - 12s - loss: 3.1993 - accuracy20: 0.4227 - val_loss: 3.2173 - val_accuracy20: 0.4151 - 12s/epoch - 13ms/step
Epoch 24/50
878/878 - 12s - loss: 3.1986 - accuracy20: 0.4240 - val_loss: 3.2171 - val_accuracy20: 0.4130 - 12s/epoch - 14ms/step
Epoch 25/50
878/878 - 12s - loss: 3.1957 - accuracy20: 0.4247 - val_loss: 3.2193 - val_accuracy20: 0.4102 - 12s/epoch - 14ms/step
Epoch 26/50
878/878 - 12s - loss: 3.1936 - accuracy20: 0.4258 - val_loss: 3.2179 - val_accuracy20: 0.4127 - 12s/epoch - 14ms/step
Epoch 27/50
878/878 - 12s - loss: 3.1919 - accuracy20: 0.4263 - val_loss: 3.2187 - val_accuracy20: 0.4107 - 12s/epoch - 13ms/step
Epoch 28/50
878/878 - 12s - loss: 3.1892 - accuracy20: 0.4279 - val_loss: 3.2191 - val_accuracy20: 0.4130 - 12s/epoch - 14ms/step
Epoch 29/50
878/878 - 12s - loss: 3.1888 - accuracy20: 0.4279 - val_loss: 3.2180 - val_accuracy20: 0.4114 - 12s/epoch - 14ms/step
Epoch 30/50
878/878 - 12s - loss: 3.1866 - accuracy20: 0.4287 - val_loss: 3.2192 - val_accuracy20: 0.4106 - 12s/epoch - 14ms/step
Epoch 31/50
878/878 - 12s - loss: 3.1836 - accuracy20: 0.4299 - val_loss: 3.2192 - val_accuracy20: 0.4117 - 12s/epoch - 14ms/step
Epoch 32/50
878/878 - 12s - loss: 3.1827 - accuracy20: 0.4299 - val_loss: 3.2194 - val_accuracy20: 0.4111 - 12s/epoch - 14ms/step
testing model: results/PCAR/W3/deepOF_L1/h20
Evaluating performance on  test set...
2282/2282 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0743861
{'0': {'precision': 0.4250708112426465, 'recall': 0.46041294098520563, 'f1-score': 0.44203657455893014, 'support': 190681}, '1': {'precision': 0.35919628877260584, 'recall': 0.31028171775933067, 'f1-score': 0.3329520623701745, 'support': 198887}, '2': {'precision': 0.42165686860877305, 'recall': 0.4460120458999193, 'f1-score': 0.4334926363990842, 'support': 194423}, 'accuracy': 0.40448911027738443, 'macro avg': {'precision': 0.40197465620800843, 'recall': 0.40556890154815184, 'f1-score': 0.4028270911093963, 'support': 583991}, 'weighted avg': {'precision': 0.4014996686750307, 'recall': 0.40448911027738443, 'f1-score': 0.40204172966485346, 'support': 583991}}
[[87792 54119 48770]
 [67008 61711 70168]
 [51735 55973 86715]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0713593
{'0': {'precision': 0.42782381697060745, 'recall': 0.4671713436689032, 'f1-score': 0.446632643879112, 'support': 74371}, '1': {'precision': 0.3746576329825573, 'recall': 0.3152128505397065, 'f1-score': 0.3423741217798595, 'support': 74207}, '2': {'precision': 0.4329383331072666, 'recall': 0.46098499271299714, 'f1-score': 0.44652168383568613, 'support': 76163}, 'accuracy': 0.4148998180127347, 'macro avg': {'precision': 0.41180659435347716, 'recall': 0.4144563956405356, 'f1-score': 0.41184281649821913, 'support': 224741}, 'weighted avg': {'precision': 0.41200219954127826, 'recall': 0.4148998180127347, 'f1-score': 0.4121700260247522, 'support': 224741}}
[[34744 19192 20435]
 [25264 23391 25552]
 [21203 19850 35110]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0719404
{'0': {'precision': 0.42549265628459665, 'recall': 0.45663366336633665, 'f1-score': 0.4405134866661573, 'support': 25250}, '1': {'precision': 0.3873444280196462, 'recall': 0.306736651310324, 'f1-score': 0.3423598086527722, 'support': 26482}, '2': {'precision': 0.42228138439483925, 'recall': 0.4826214160327677, 'f1-score': 0.450439626454044, 'support': 25635}, 'accuracy': 0.413936174337896, 'macro avg': {'precision': 0.41170615623302736, 'recall': 0.4153305769031428, 'f1-score': 0.41110430725765784, 'support': 77367}, 'weighted avg': {'precision': 0.4113708429041327, 'recall': 0.413936174337896, 'f1-score': 0.4102053564854861, 'support': 77367}}
[[11530  6434  7286]
 [ 8719  8123  9640]
 [ 6849  6414 12372]]
training model: results/PCAR/W3/deepOF_L1/h30
Epoch 1/50
878/878 - 14s - loss: 3.2873 - accuracy30: 0.3805 - val_loss: 3.2572 - val_accuracy30: 0.3881 - 14s/epoch - 16ms/step
Epoch 2/50
878/878 - 12s - loss: 3.2582 - accuracy30: 0.3943 - val_loss: 3.2481 - val_accuracy30: 0.3948 - 12s/epoch - 14ms/step
Epoch 3/50
878/878 - 12s - loss: 3.2500 - accuracy30: 0.3972 - val_loss: 3.2436 - val_accuracy30: 0.3985 - 12s/epoch - 14ms/step
Epoch 4/50
878/878 - 12s - loss: 3.2461 - accuracy30: 0.3993 - val_loss: 3.2416 - val_accuracy30: 0.4001 - 12s/epoch - 14ms/step
Epoch 5/50
878/878 - 12s - loss: 3.2412 - accuracy30: 0.4011 - val_loss: 3.2387 - val_accuracy30: 0.4034 - 12s/epoch - 14ms/step
Epoch 6/50
878/878 - 12s - loss: 3.2390 - accuracy30: 0.4018 - val_loss: 3.2387 - val_accuracy30: 0.4041 - 12s/epoch - 14ms/step
Epoch 7/50
878/878 - 12s - loss: 3.2374 - accuracy30: 0.4028 - val_loss: 3.2386 - val_accuracy30: 0.4032 - 12s/epoch - 14ms/step
Epoch 8/50
878/878 - 12s - loss: 3.2353 - accuracy30: 0.4048 - val_loss: 3.2357 - val_accuracy30: 0.4050 - 12s/epoch - 14ms/step
Epoch 9/50
878/878 - 12s - loss: 3.2334 - accuracy30: 0.4060 - val_loss: 3.2356 - val_accuracy30: 0.4061 - 12s/epoch - 13ms/step
Epoch 10/50
878/878 - 12s - loss: 3.2326 - accuracy30: 0.4059 - val_loss: 3.2358 - val_accuracy30: 0.4047 - 12s/epoch - 13ms/step
Epoch 11/50
878/878 - 12s - loss: 3.2302 - accuracy30: 0.4071 - val_loss: 3.2363 - val_accuracy30: 0.4059 - 12s/epoch - 13ms/step
Epoch 12/50
878/878 - 12s - loss: 3.2289 - accuracy30: 0.4090 - val_loss: 3.2357 - val_accuracy30: 0.4036 - 12s/epoch - 14ms/step
Epoch 13/50
878/878 - 12s - loss: 3.2273 - accuracy30: 0.4096 - val_loss: 3.2358 - val_accuracy30: 0.4042 - 12s/epoch - 14ms/step
Epoch 14/50
878/878 - 12s - loss: 3.2262 - accuracy30: 0.4097 - val_loss: 3.2347 - val_accuracy30: 0.4053 - 12s/epoch - 14ms/step
Epoch 15/50
878/878 - 12s - loss: 3.2240 - accuracy30: 0.4123 - val_loss: 3.2355 - val_accuracy30: 0.4040 - 12s/epoch - 13ms/step
Epoch 16/50
878/878 - 12s - loss: 3.2229 - accuracy30: 0.4118 - val_loss: 3.2348 - val_accuracy30: 0.4045 - 12s/epoch - 13ms/step
Epoch 17/50
878/878 - 12s - loss: 3.2217 - accuracy30: 0.4128 - val_loss: 3.2344 - val_accuracy30: 0.4041 - 12s/epoch - 14ms/step
Epoch 18/50
878/878 - 12s - loss: 3.2204 - accuracy30: 0.4134 - val_loss: 3.2344 - val_accuracy30: 0.4051 - 12s/epoch - 13ms/step
Epoch 19/50
878/878 - 12s - loss: 3.2187 - accuracy30: 0.4131 - val_loss: 3.2335 - val_accuracy30: 0.4046 - 12s/epoch - 14ms/step
Epoch 20/50
878/878 - 12s - loss: 3.2172 - accuracy30: 0.4156 - val_loss: 3.2350 - val_accuracy30: 0.4038 - 12s/epoch - 13ms/step
Epoch 21/50
878/878 - 12s - loss: 3.2151 - accuracy30: 0.4162 - val_loss: 3.2349 - val_accuracy30: 0.4036 - 12s/epoch - 14ms/step
Epoch 22/50
878/878 - 12s - loss: 3.2138 - accuracy30: 0.4164 - val_loss: 3.2349 - val_accuracy30: 0.4026 - 12s/epoch - 14ms/step
Epoch 23/50
878/878 - 12s - loss: 3.2134 - accuracy30: 0.4174 - val_loss: 3.2357 - val_accuracy30: 0.4041 - 12s/epoch - 14ms/step
Epoch 24/50
878/878 - 12s - loss: 3.2102 - accuracy30: 0.4187 - val_loss: 3.2355 - val_accuracy30: 0.4034 - 12s/epoch - 13ms/step
Epoch 25/50
878/878 - 12s - loss: 3.2088 - accuracy30: 0.4194 - val_loss: 3.2352 - val_accuracy30: 0.4035 - 12s/epoch - 14ms/step
Epoch 26/50
878/878 - 12s - loss: 3.2075 - accuracy30: 0.4197 - val_loss: 3.2339 - val_accuracy30: 0.4034 - 12s/epoch - 14ms/step
Epoch 27/50
878/878 - 12s - loss: 3.2067 - accuracy30: 0.4199 - val_loss: 3.2359 - val_accuracy30: 0.4026 - 12s/epoch - 14ms/step
Epoch 28/50
878/878 - 12s - loss: 3.2046 - accuracy30: 0.4210 - val_loss: 3.2366 - val_accuracy30: 0.4014 - 12s/epoch - 14ms/step
Epoch 29/50
878/878 - 12s - loss: 3.2028 - accuracy30: 0.4228 - val_loss: 3.2360 - val_accuracy30: 0.4028 - 12s/epoch - 13ms/step
testing model: results/PCAR/W3/deepOF_L1/h30
Evaluating performance on  test set...
2282/2282 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0784276
{'0': {'precision': 0.43300425353148136, 'recall': 0.42336662131286423, 'f1-score': 0.4281312062721479, 'support': 194765}, '1': {'precision': 0.3340772028909204, 'recall': 0.29303504518404233, 'f1-score': 0.31221309596363417, 'support': 190554}, '2': {'precision': 0.42346643582416515, 'recall': 0.48260449383909154, 'f1-score': 0.45110553319422514, 'support': 198672}, 'accuracy': 0.4009924810485093, 'macro avg': {'precision': 0.3968492974155223, 'recall': 0.39966872011199933, 'f1-score': 0.39714994514333574, 'support': 583991}, 'weighted avg': {'precision': 0.3974800031109965, 'recall': 0.4009924810485093, 'f1-score': 0.39812337376537027, 'support': 583991}}
[[82457 56293 56015]
 [60193 55839 74522]
 [47780 55012 95880]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0756823
{'0': {'precision': 0.422582643028567, 'recall': 0.44073475979006865, 'f1-score': 0.4314678681527152, 'support': 74310}, '1': {'precision': 0.3642203201827724, 'recall': 0.2957824117022278, 'f1-score': 0.32645308720749067, 'support': 74379}, '2': {'precision': 0.42620572112948546, 'recall': 0.48664071950770527, 'f1-score': 0.4544226707922007, 'support': 76052}, 'accuracy': 0.4082966614903378, 'macro avg': {'precision': 0.40433622811360825, 'recall': 0.4077192970000006, 'f1-score': 0.40411454205080216, 'support': 224741}, 'weighted avg': {'precision': 0.4044934253281193, 'recall': 0.4082966614903378, 'f1-score': 0.4044806440076473, 'support': 224741}}
[[32751 19271 22288]
 [24841 22000 27538]
 [19910 19132 37010]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0779586
{'0': {'precision': 0.4208732533040482, 'recall': 0.4397404447258052, 'f1-score': 0.43010003676399455, 'support': 25274}, '1': {'precision': 0.3669550432564885, 'recall': 0.27748156551332953, 'f1-score': 0.3160070625726713, 'support': 26445}, '2': {'precision': 0.4107160158899332, 'recall': 0.4958281347473487, 'f1-score': 0.44927664234866016, 'support': 25648}, 'accuracy': 0.4028720255406052, 'macro avg': {'precision': 0.39951477081682324, 'recall': 0.4043500483288278, 'f1-score': 0.39846124722844206, 'support': 77367}, 'weighted avg': {'precision': 0.3990761060719604, 'recall': 0.4028720255406052, 'f1-score': 0.3974588961943196, 'support': 77367}}
[[11114  6297  7863]
 [ 8724  7338 10383]
 [ 6569  6362 12717]]
training model: results/PCAR/W3/deepOF_L1/h50
Epoch 1/50
878/878 - 14s - loss: 3.2976 - accuracy50: 0.3744 - val_loss: 3.2745 - val_accuracy50: 0.3725 - 14s/epoch - 16ms/step
Epoch 2/50
878/878 - 12s - loss: 3.2705 - accuracy50: 0.3844 - val_loss: 3.2649 - val_accuracy50: 0.3813 - 12s/epoch - 14ms/step
Epoch 3/50
878/878 - 12s - loss: 3.2629 - accuracy50: 0.3880 - val_loss: 3.2623 - val_accuracy50: 0.3858 - 12s/epoch - 14ms/step
Epoch 4/50
878/878 - 12s - loss: 3.2599 - accuracy50: 0.3883 - val_loss: 3.2587 - val_accuracy50: 0.3876 - 12s/epoch - 14ms/step
Epoch 5/50
878/878 - 12s - loss: 3.2568 - accuracy50: 0.3901 - val_loss: 3.2589 - val_accuracy50: 0.3869 - 12s/epoch - 14ms/step
Epoch 6/50
878/878 - 12s - loss: 3.2541 - accuracy50: 0.3918 - val_loss: 3.2575 - val_accuracy50: 0.3892 - 12s/epoch - 14ms/step
Epoch 7/50
878/878 - 12s - loss: 3.2529 - accuracy50: 0.3938 - val_loss: 3.2567 - val_accuracy50: 0.3888 - 12s/epoch - 14ms/step
Epoch 8/50
878/878 - 12s - loss: 3.2513 - accuracy50: 0.3941 - val_loss: 3.2563 - val_accuracy50: 0.3897 - 12s/epoch - 14ms/step
Epoch 9/50
878/878 - 12s - loss: 3.2503 - accuracy50: 0.3955 - val_loss: 3.2552 - val_accuracy50: 0.3900 - 12s/epoch - 14ms/step
Epoch 10/50
878/878 - 12s - loss: 3.2480 - accuracy50: 0.3960 - val_loss: 3.2557 - val_accuracy50: 0.3899 - 12s/epoch - 14ms/step
Epoch 11/50
878/878 - 12s - loss: 3.2470 - accuracy50: 0.3971 - val_loss: 3.2558 - val_accuracy50: 0.3909 - 12s/epoch - 14ms/step
Epoch 12/50
878/878 - 12s - loss: 3.2459 - accuracy50: 0.3980 - val_loss: 3.2555 - val_accuracy50: 0.3903 - 12s/epoch - 13ms/step
Epoch 13/50
878/878 - 12s - loss: 3.2447 - accuracy50: 0.3990 - val_loss: 3.2555 - val_accuracy50: 0.3889 - 12s/epoch - 14ms/step
Epoch 14/50
878/878 - 12s - loss: 3.2429 - accuracy50: 0.3990 - val_loss: 3.2564 - val_accuracy50: 0.3904 - 12s/epoch - 14ms/step
Epoch 15/50
878/878 - 12s - loss: 3.2416 - accuracy50: 0.4003 - val_loss: 3.2551 - val_accuracy50: 0.3902 - 12s/epoch - 14ms/step
Epoch 16/50
878/878 - 12s - loss: 3.2408 - accuracy50: 0.4013 - val_loss: 3.2549 - val_accuracy50: 0.3908 - 12s/epoch - 14ms/step
Epoch 17/50
878/878 - 12s - loss: 3.2390 - accuracy50: 0.4026 - val_loss: 3.2555 - val_accuracy50: 0.3917 - 12s/epoch - 14ms/step
Epoch 18/50
878/878 - 12s - loss: 3.2380 - accuracy50: 0.4033 - val_loss: 3.2561 - val_accuracy50: 0.3895 - 12s/epoch - 13ms/step
Epoch 19/50
878/878 - 12s - loss: 3.2366 - accuracy50: 0.4036 - val_loss: 3.2543 - val_accuracy50: 0.3895 - 12s/epoch - 14ms/step
Epoch 20/50
878/878 - 12s - loss: 3.2345 - accuracy50: 0.4062 - val_loss: 3.2559 - val_accuracy50: 0.3903 - 12s/epoch - 13ms/step
Epoch 21/50
878/878 - 12s - loss: 3.2344 - accuracy50: 0.4058 - val_loss: 3.2551 - val_accuracy50: 0.3922 - 12s/epoch - 13ms/step
Epoch 22/50
878/878 - 12s - loss: 3.2322 - accuracy50: 0.4073 - val_loss: 3.2557 - val_accuracy50: 0.3904 - 12s/epoch - 13ms/step
Epoch 23/50
878/878 - 12s - loss: 3.2307 - accuracy50: 0.4082 - val_loss: 3.2565 - val_accuracy50: 0.3917 - 12s/epoch - 14ms/step
Epoch 24/50
878/878 - 12s - loss: 3.2291 - accuracy50: 0.4090 - val_loss: 3.2562 - val_accuracy50: 0.3904 - 12s/epoch - 13ms/step
Epoch 25/50
878/878 - 12s - loss: 3.2286 - accuracy50: 0.4094 - val_loss: 3.2578 - val_accuracy50: 0.3899 - 12s/epoch - 14ms/step
Epoch 26/50
878/878 - 12s - loss: 3.2272 - accuracy50: 0.4102 - val_loss: 3.2565 - val_accuracy50: 0.3901 - 12s/epoch - 14ms/step
Epoch 27/50
878/878 - 12s - loss: 3.2238 - accuracy50: 0.4125 - val_loss: 3.2562 - val_accuracy50: 0.3916 - 12s/epoch - 14ms/step
Epoch 28/50
878/878 - 12s - loss: 3.2231 - accuracy50: 0.4116 - val_loss: 3.2576 - val_accuracy50: 0.3909 - 12s/epoch - 14ms/step
Epoch 29/50
878/878 - 12s - loss: 3.2220 - accuracy50: 0.4139 - val_loss: 3.2588 - val_accuracy50: 0.3900 - 12s/epoch - 13ms/step
testing model: results/PCAR/W3/deepOF_L1/h50
Evaluating performance on  test set...
2282/2282 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0848192
{'0': {'precision': 0.44567046675477545, 'recall': 0.4416975282465911, 'f1-score': 0.44367510364803214, 'support': 212238}, '1': {'precision': 0.2849548832721055, 'recall': 0.21391352972574537, 'f1-score': 0.24437588472287758, 'support': 157372}, '2': {'precision': 0.4348726257989018, 'recall': 0.5182968639944772, 'f1-score': 0.4729339757559249, 'support': 214381}, 'accuracy': 0.40843437655717296, 'macro avg': {'precision': 0.3884993252752609, 'recall': 0.39130264065560455, 'f1-score': 0.3869949880422782, 'support': 583991}, 'weighted avg': {'precision': 0.39839750407933033, 'recall': 0.40843437655717296, 'f1-score': 0.4007094236643898, 'support': 583991}}
[[ 93745  42512  75981]
 [ 55295  33664  68413]
 [ 61306  41962 111113]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0813335
{'0': {'precision': 0.40818916083062884, 'recall': 0.44830959304273255, 'f1-score': 0.42730970885566677, 'support': 74627}, '1': {'precision': 0.37686859160864417, 'recall': 0.2529153537475425, 'f1-score': 0.3026938170331751, 'support': 74262}, '2': {'precision': 0.40820081341051406, 'recall': 0.5001713863840109, 'f1-score': 0.44953019657096815, 'support': 75852}, 'accuracy': 0.40124854832896534, 'macro avg': {'precision': 0.3977528552832624, 'recall': 0.4004654443914286, 'f1-score': 0.3931779074866033, 'support': 224741}, 'weighted avg': {'precision': 0.3978437221253033, 'recall': 0.40124854832896534, 'f1-score': 0.39363202243289197, 'support': 224741}}
[[33456 15594 25577]
 [26054 18782 29426]
 [22452 15461 37939]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.084433
{'0': {'precision': 0.4034927477987651, 'recall': 0.4335911428683601, 'f1-score': 0.4180008326709814, 'support': 25471}, '1': {'precision': 0.3677613574165298, 'recall': 0.25565998249686084, 'f1-score': 0.3016318376691881, 'support': 26281}, '2': {'precision': 0.39648868435983103, 'recall': 0.49107944563732187, 'f1-score': 0.4387436563715317, 'support': 25615}, 'accuracy': 0.39218271356004497, 'macro avg': {'precision': 0.389247596525042, 'recall': 0.39344352366751423, 'f1-score': 0.3861254422372338, 'support': 77367}, 'weighted avg': {'precision': 0.389036122162204, 'recall': 0.39218271356004497, 'f1-score': 0.3853387657877814, 'support': 77367}}
[[11044  5813  8614]
 [ 9029  6719 10533]
 [ 7298  5738 12579]]
training model: results/PCAR/W3/deepOF_L1/h100
Epoch 1/50
878/878 - 15s - loss: 3.3157 - accuracy100: 0.3554 - val_loss: 3.3010 - val_accuracy100: 0.3531 - 15s/epoch - 17ms/step
Epoch 2/50
878/878 - 12s - loss: 3.2901 - accuracy100: 0.3639 - val_loss: 3.2894 - val_accuracy100: 0.3564 - 12s/epoch - 14ms/step
Epoch 3/50
878/878 - 12s - loss: 3.2830 - accuracy100: 0.3687 - val_loss: 3.2840 - val_accuracy100: 0.3580 - 12s/epoch - 14ms/step
Epoch 4/50
878/878 - 12s - loss: 3.2799 - accuracy100: 0.3712 - val_loss: 3.2796 - val_accuracy100: 0.3648 - 12s/epoch - 14ms/step
Epoch 5/50
878/878 - 12s - loss: 3.2773 - accuracy100: 0.3726 - val_loss: 3.2788 - val_accuracy100: 0.3653 - 12s/epoch - 14ms/step
Epoch 6/50
878/878 - 12s - loss: 3.2751 - accuracy100: 0.3749 - val_loss: 3.2774 - val_accuracy100: 0.3669 - 12s/epoch - 14ms/step
Epoch 7/50
878/878 - 12s - loss: 3.2742 - accuracy100: 0.3754 - val_loss: 3.2759 - val_accuracy100: 0.3705 - 12s/epoch - 14ms/step
Epoch 8/50
878/878 - 12s - loss: 3.2726 - accuracy100: 0.3771 - val_loss: 3.2759 - val_accuracy100: 0.3706 - 12s/epoch - 14ms/step
Epoch 9/50
878/878 - 12s - loss: 3.2709 - accuracy100: 0.3775 - val_loss: 3.2754 - val_accuracy100: 0.3693 - 12s/epoch - 14ms/step
Epoch 10/50
878/878 - 12s - loss: 3.2708 - accuracy100: 0.3775 - val_loss: 3.2762 - val_accuracy100: 0.3715 - 12s/epoch - 14ms/step
Epoch 11/50
878/878 - 12s - loss: 3.2696 - accuracy100: 0.3784 - val_loss: 3.2760 - val_accuracy100: 0.3702 - 12s/epoch - 14ms/step
Epoch 12/50
878/878 - 12s - loss: 3.2691 - accuracy100: 0.3806 - val_loss: 3.2759 - val_accuracy100: 0.3718 - 12s/epoch - 14ms/step
Epoch 13/50
878/878 - 12s - loss: 3.2683 - accuracy100: 0.3805 - val_loss: 3.2754 - val_accuracy100: 0.3696 - 12s/epoch - 14ms/step
Epoch 14/50
878/878 - 12s - loss: 3.2672 - accuracy100: 0.3811 - val_loss: 3.2757 - val_accuracy100: 0.3706 - 12s/epoch - 14ms/step
Epoch 15/50
878/878 - 12s - loss: 3.2665 - accuracy100: 0.3820 - val_loss: 3.2761 - val_accuracy100: 0.3723 - 12s/epoch - 14ms/step
Epoch 16/50
878/878 - 12s - loss: 3.2651 - accuracy100: 0.3827 - val_loss: 3.2760 - val_accuracy100: 0.3726 - 12s/epoch - 14ms/step
Epoch 17/50
878/878 - 12s - loss: 3.2648 - accuracy100: 0.3834 - val_loss: 3.2761 - val_accuracy100: 0.3696 - 12s/epoch - 14ms/step
Epoch 18/50
878/878 - 12s - loss: 3.2642 - accuracy100: 0.3836 - val_loss: 3.2782 - val_accuracy100: 0.3696 - 12s/epoch - 13ms/step
Epoch 19/50
878/878 - 12s - loss: 3.2630 - accuracy100: 0.3849 - val_loss: 3.2775 - val_accuracy100: 0.3711 - 12s/epoch - 13ms/step
Epoch 20/50
878/878 - 12s - loss: 3.2618 - accuracy100: 0.3847 - val_loss: 3.2770 - val_accuracy100: 0.3706 - 12s/epoch - 14ms/step
Epoch 21/50
878/878 - 12s - loss: 3.2607 - accuracy100: 0.3863 - val_loss: 3.2773 - val_accuracy100: 0.3724 - 12s/epoch - 14ms/step
Epoch 22/50
878/878 - 12s - loss: 3.2595 - accuracy100: 0.3869 - val_loss: 3.2793 - val_accuracy100: 0.3682 - 12s/epoch - 14ms/step
Epoch 23/50
878/878 - 12s - loss: 3.2578 - accuracy100: 0.3884 - val_loss: 3.2797 - val_accuracy100: 0.3688 - 12s/epoch - 14ms/step
testing model: results/PCAR/W3/deepOF_L1/h100
Evaluating performance on  test set...
2282/2282 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0933231
{'0': {'precision': 0.39563573141088465, 'recall': 0.3593203121857022, 'f1-score': 0.3766045870568362, 'support': 198856}, '1': {'precision': 0.3248633078014864, 'recall': 0.2881716088864334, 'f1-score': 0.3054194125943421, 'support': 188242}, '2': {'precision': 0.38176957535098366, 'recall': 0.45838602692833164, 'f1-score': 0.4165843526425109, 'support': 196893}, 'accuracy': 0.36978652068268175, 'macro avg': {'precision': 0.3674228715211183, 'recall': 0.3686259826668224, 'f1-score': 0.36620278409789647, 'support': 583991}, 'weighted avg': {'precision': 0.368148164598755, 'recall': 0.36978652068268175, 'f1-score': 0.3671381678385459, 'support': 583991}}
[[71453 57506 69897]
 [57739 54246 76257]
 [51411 55229 90253]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0902089
{'0': {'precision': 0.3910292121991286, 'recall': 0.3661632713118153, 'f1-score': 0.37818794727971045, 'support': 74759}, '1': {'precision': 0.34634285986926855, 'recall': 0.29221850972183083, 'f1-score': 0.3169868995633187, 'support': 74523}, '2': {'precision': 0.38664692626743163, 'recall': 0.47067944181608556, 'f1-score': 0.424544878614375, 'support': 75459}, 'accuracy': 0.3767358870878033, 'macro avg': {'precision': 0.37467299944527627, 'recall': 0.37635374094991053, 'f1-score': 0.3732399084858014, 'support': 224741}, 'weighted avg': {'precision': 0.37474004400641747, 'recall': 0.3767358870878033, 'f1-score': 0.37345877904878594, 'support': 224741}}
[[27374 20826 26559]
 [22963 21777 29783]
 [19668 20274 35517]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.091769
{'0': {'precision': 0.37640328616284574, 'recall': 0.3483262349241731, 'f1-score': 0.36182088811709257, 'support': 25123}, '1': {'precision': 0.35845138664574777, 'recall': 0.28944034577837396, 'f1-score': 0.3202704652744851, 'support': 26838}, '2': {'precision': 0.3769840046845625, 'recall': 0.4814610721876722, 'f1-score': 0.42286484711250927, 'support': 25406}, 'accuracy': 0.37161839026975324, 'macro avg': {'precision': 0.3706128924977186, 'recall': 0.3730758842967397, 'f1-score': 0.3683187335013623, 'support': 77367}, 'weighted avg': {'precision': 0.3703666123293361, 'recall': 0.37161839026975324, 'f1-score': 0.3674531676934967, 'support': 77367}}
[[ 8751  7163  9209]
 [ 8064  7768 11006]
 [ 6434  6740 12232]]
training model: results/PCAR/W3/deepOF_L1/h200
Epoch 1/50
878/878 - 14s - loss: 3.3279 - accuracy200: 0.3501 - val_loss: 3.3448 - val_accuracy200: 0.3267 - 14s/epoch - 16ms/step
Epoch 2/50
878/878 - 12s - loss: 3.3039 - accuracy200: 0.3555 - val_loss: 3.3164 - val_accuracy200: 0.3275 - 12s/epoch - 14ms/step
Epoch 3/50
878/878 - 12s - loss: 3.2966 - accuracy200: 0.3563 - val_loss: 3.3050 - val_accuracy200: 0.3300 - 12s/epoch - 14ms/step
Epoch 4/50
878/878 - 12s - loss: 3.2921 - accuracy200: 0.3574 - val_loss: 3.2986 - val_accuracy200: 0.3374 - 12s/epoch - 14ms/step
Epoch 5/50
878/878 - 12s - loss: 3.2905 - accuracy200: 0.3577 - val_loss: 3.2951 - val_accuracy200: 0.3417 - 12s/epoch - 14ms/step
Epoch 6/50
878/878 - 12s - loss: 3.2882 - accuracy200: 0.3594 - val_loss: 3.2939 - val_accuracy200: 0.3446 - 12s/epoch - 14ms/step
Epoch 7/50
878/878 - 12s - loss: 3.2870 - accuracy200: 0.3605 - val_loss: 3.2940 - val_accuracy200: 0.3489 - 12s/epoch - 14ms/step
Epoch 8/50
878/878 - 12s - loss: 3.2856 - accuracy200: 0.3619 - val_loss: 3.2939 - val_accuracy200: 0.3486 - 12s/epoch - 14ms/step
Epoch 9/50
878/878 - 12s - loss: 3.2843 - accuracy200: 0.3628 - val_loss: 3.2927 - val_accuracy200: 0.3514 - 12s/epoch - 14ms/step
Epoch 10/50
878/878 - 12s - loss: 3.2840 - accuracy200: 0.3634 - val_loss: 3.2934 - val_accuracy200: 0.3505 - 12s/epoch - 14ms/step
Epoch 11/50
878/878 - 12s - loss: 3.2827 - accuracy200: 0.3654 - val_loss: 3.2941 - val_accuracy200: 0.3487 - 12s/epoch - 14ms/step
Epoch 12/50
878/878 - 12s - loss: 3.2822 - accuracy200: 0.3650 - val_loss: 3.2934 - val_accuracy200: 0.3482 - 12s/epoch - 14ms/step
Epoch 13/50
878/878 - 12s - loss: 3.2814 - accuracy200: 0.3660 - val_loss: 3.2930 - val_accuracy200: 0.3501 - 12s/epoch - 14ms/step
Epoch 14/50
878/878 - 12s - loss: 3.2807 - accuracy200: 0.3655 - val_loss: 3.2938 - val_accuracy200: 0.3495 - 12s/epoch - 14ms/step
Epoch 15/50
878/878 - 12s - loss: 3.2789 - accuracy200: 0.3683 - val_loss: 3.2947 - val_accuracy200: 0.3494 - 12s/epoch - 14ms/step
Epoch 16/50
878/878 - 12s - loss: 3.2789 - accuracy200: 0.3679 - val_loss: 3.2939 - val_accuracy200: 0.3493 - 12s/epoch - 13ms/step
Epoch 17/50
878/878 - 12s - loss: 3.2770 - accuracy200: 0.3692 - val_loss: 3.2943 - val_accuracy200: 0.3489 - 12s/epoch - 14ms/step
Epoch 18/50
878/878 - 12s - loss: 3.2768 - accuracy200: 0.3696 - val_loss: 3.2952 - val_accuracy200: 0.3482 - 12s/epoch - 14ms/step
Epoch 19/50
878/878 - 12s - loss: 3.2753 - accuracy200: 0.3719 - val_loss: 3.2952 - val_accuracy200: 0.3475 - 12s/epoch - 14ms/step
testing model: results/PCAR/W3/deepOF_L1/h200
Evaluating performance on  test set...
2282/2282 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1012466
{'0': {'precision': 0.39765092861243423, 'recall': 0.24118347315870453, 'f1-score': 0.3002556900556192, 'support': 212527}, '1': {'precision': 0.28354496199671325, 'recall': 0.5356670749602823, 'f1-score': 0.3708092497680842, 'support': 164914}, '2': {'precision': 0.3884782320934672, 'recall': 0.26996368917937547, 'f1-score': 0.3185551020174985, 'support': 206550}, 'accuracy': 0.3345222785967592, 'macro avg': {'precision': 0.35655804090087156, 'recall': 0.3489380790994541, 'f1-score': 0.32987334728040063, 'support': 583991}, 'weighted avg': {'precision': 0.36218412887672313, 'recall': 0.3345222785967592, 'f1-score': 0.326651667540114, 'support': 583991}}
[[ 51258 114312  46957]
 [ 35756  88339  40819]
 [ 41888 108901  55761]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0956761
{'0': {'precision': 0.37554910574207717, 'recall': 0.25593734546863933, 'f1-score': 0.3044152128124627, 'support': 74823}, '1': {'precision': 0.33117007896024037, 'recall': 0.5129887701258287, 'f1-score': 0.4024989649571652, 'support': 73910}, '2': {'precision': 0.3771451713605913, 'recall': 0.29404799494790024, 'f1-score': 0.33045265360134246, 'support': 76008}, 'accuracy': 0.3533623148424186, 'macro avg': {'precision': 0.3612881186876363, 'recall': 0.35432470351412276, 'f1-score': 0.34578894379032343, 'support': 224741}, 'weighted avg': {'precision': 0.3614940818972356, 'recall': 0.3533623148424186, 'f1-score': 0.3454776977195163, 'support': 224741}}
[[19150 38300 17373]
 [16457 37915 19538]
 [15385 38273 22350]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.097872
{'0': {'precision': 0.37176705178581904, 'recall': 0.24194656488549618, 'f1-score': 0.2931261704931678, 'support': 26200}, '1': {'precision': 0.3257326437862404, 'recall': 0.4991394836902141, 'f1-score': 0.3942090373156738, 'support': 24985}, '2': {'precision': 0.3720381298229687, 'recall': 0.3130394927813001, 'f1-score': 0.33999834066207585, 'support': 26182}, 'accuracy': 0.34906355422854707, 'macro avg': {'precision': 0.3565126084650094, 'recall': 0.3513751804523368, 'f1-score': 0.34244451615697247, 'support': 77367}, 'weighted avg': {'precision': 0.3569923762949661, 'recall': 0.34906355422854707, 'f1-score': 0.3416321560803388, 'support': 77367}}
[[ 6339 13115  6746]
 [ 5426 12471  7088]
 [ 5286 12700  8196]]
training model: results/PCAR/W3/deepOF_L1/h300
Epoch 1/50
878/878 - 14s - loss: 3.3306 - accuracy300: 0.3470 - val_loss: 3.3224 - val_accuracy300: 0.3354 - 14s/epoch - 16ms/step
Epoch 2/50
878/878 - 12s - loss: 3.3064 - accuracy300: 0.3521 - val_loss: 3.3073 - val_accuracy300: 0.3383 - 12s/epoch - 14ms/step
Epoch 3/50
878/878 - 12s - loss: 3.2996 - accuracy300: 0.3524 - val_loss: 3.3016 - val_accuracy300: 0.3409 - 12s/epoch - 14ms/step
Epoch 4/50
878/878 - 12s - loss: 3.2951 - accuracy300: 0.3537 - val_loss: 3.2985 - val_accuracy300: 0.3427 - 12s/epoch - 14ms/step
Epoch 5/50
878/878 - 12s - loss: 3.2937 - accuracy300: 0.3550 - val_loss: 3.2967 - val_accuracy300: 0.3476 - 12s/epoch - 14ms/step
Epoch 6/50
878/878 - 12s - loss: 3.2918 - accuracy300: 0.3557 - val_loss: 3.2960 - val_accuracy300: 0.3475 - 12s/epoch - 14ms/step
Epoch 7/50
878/878 - 12s - loss: 3.2907 - accuracy300: 0.3556 - val_loss: 3.2952 - val_accuracy300: 0.3490 - 12s/epoch - 14ms/step
Epoch 8/50
878/878 - 12s - loss: 3.2898 - accuracy300: 0.3568 - val_loss: 3.2953 - val_accuracy300: 0.3500 - 12s/epoch - 14ms/step
Epoch 9/50
878/878 - 12s - loss: 3.2883 - accuracy300: 0.3582 - val_loss: 3.2944 - val_accuracy300: 0.3508 - 12s/epoch - 14ms/step
Epoch 10/50
878/878 - 12s - loss: 3.2872 - accuracy300: 0.3598 - val_loss: 3.2955 - val_accuracy300: 0.3495 - 12s/epoch - 14ms/step
Epoch 11/50
878/878 - 12s - loss: 3.2870 - accuracy300: 0.3602 - val_loss: 3.2946 - val_accuracy300: 0.3511 - 12s/epoch - 14ms/step
Epoch 12/50
878/878 - 12s - loss: 3.2860 - accuracy300: 0.3611 - val_loss: 3.2947 - val_accuracy300: 0.3500 - 12s/epoch - 14ms/step
Epoch 13/50
878/878 - 12s - loss: 3.2855 - accuracy300: 0.3611 - val_loss: 3.2949 - val_accuracy300: 0.3509 - 12s/epoch - 13ms/step
Epoch 14/50
878/878 - 12s - loss: 3.2845 - accuracy300: 0.3632 - val_loss: 3.2950 - val_accuracy300: 0.3496 - 12s/epoch - 14ms/step
Epoch 15/50
878/878 - 12s - loss: 3.2832 - accuracy300: 0.3652 - val_loss: 3.2951 - val_accuracy300: 0.3504 - 12s/epoch - 14ms/step
Epoch 16/50
878/878 - 12s - loss: 3.2829 - accuracy300: 0.3657 - val_loss: 3.2949 - val_accuracy300: 0.3512 - 12s/epoch - 14ms/step
Epoch 17/50
878/878 - 12s - loss: 3.2821 - accuracy300: 0.3667 - val_loss: 3.2965 - val_accuracy300: 0.3492 - 12s/epoch - 13ms/step
Epoch 18/50
878/878 - 12s - loss: 3.2815 - accuracy300: 0.3677 - val_loss: 3.2956 - val_accuracy300: 0.3515 - 12s/epoch - 14ms/step
Epoch 19/50
878/878 - 12s - loss: 3.2797 - accuracy300: 0.3688 - val_loss: 3.2966 - val_accuracy300: 0.3496 - 12s/epoch - 14ms/step
testing model: results/PCAR/W3/deepOF_L1/h300
Evaluating performance on  test set...
2282/2282 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977882
{'0': {'precision': 0.3619988560952105, 'recall': 0.2377235588301879, 'f1-score': 0.2869849591135101, 'support': 194356}, '1': {'precision': 0.34695550720524704, 'recall': 0.2718387595673507, 'f1-score': 0.3048378427798064, 'support': 202381}, '2': {'precision': 0.3395345088702555, 'recall': 0.5399671035064671, 'f1-score': 0.416912175521135, 'support': 187254}, 'accuracy': 0.3464591063903382, 'macro avg': {'precision': 0.349496290723571, 'recall': 0.34984314063466854, 'f1-score': 0.3362449924714839, 'support': 583991}, 'weighted avg': {'precision': 0.34958252285212726, 'recall': 0.3464591063903382, 'f1-score': 0.33483240099268646, 'support': 583991}}
[[ 46203  54837  93316]
 [ 44000  55015 103366]
 [ 37430  48713 101111]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958364
{'0': {'precision': 0.36532251864380716, 'recall': 0.25568006026446416, 'f1-score': 0.30082220832970635, 'support': 74339}, '1': {'precision': 0.34029098675209396, 'recall': 0.27515076292109064, 'f1-score': 0.3042735552787248, 'support': 74123}, '2': {'precision': 0.36309951320724604, 'recall': 0.5368450032118932, 'f1-score': 0.4332003935300278, 'support': 76279}, 'accuracy': 0.3575315585496193, 'macro avg': {'precision': 0.35623767286771574, 'recall': 0.35589194213248265, 'f1-score': 0.346098719046153, 'support': 224741}, 'weighted avg': {'precision': 0.35631223182429084, 'recall': 0.3575315585496193, 'f1-score': 0.34689079296178243, 'support': 224741}}
[[19007 20207 35125]
 [17024 20395 36704]
 [15997 19332 40950]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0978054
{'0': {'precision': 0.3658382959230417, 'recall': 0.24788546597346162, 'f1-score': 0.2955270826587724, 'support': 25774}, '1': {'precision': 0.3397792801749851, 'recall': 0.26383849301320156, 'f1-score': 0.2970318543305375, 'support': 25906}, '2': {'precision': 0.3475004398421595, 'recall': 0.5382489196870012, 'f1-score': 0.42233558359043283, 'support': 25687}, 'accuracy': 0.34963227215737974, 'macro avg': {'precision': 0.35103933864672876, 'recall': 0.3499909595578881, 'f1-score': 0.3382981735265809, 'support': 77367}, 'weighted avg': {'precision': 0.35102410678401885, 'recall': 0.34963227215737974, 'f1-score': 0.3381332658940059, 'support': 77367}}
[[ 6389  6815 12570]
 [ 5680  6835 13391]
 [ 5395  6466 13826]]
training model: results/PCAR/W3/deepOF_L1/h500
Epoch 1/50
878/878 - 15s - loss: 3.3317 - accuracy500: 0.3473 - val_loss: 3.3607 - val_accuracy500: 0.3317 - 15s/epoch - 17ms/step
Epoch 2/50
878/878 - 13s - loss: 3.3099 - accuracy500: 0.3495 - val_loss: 3.3246 - val_accuracy500: 0.3306 - 13s/epoch - 14ms/step
Epoch 3/50
878/878 - 12s - loss: 3.3029 - accuracy500: 0.3489 - val_loss: 3.3104 - val_accuracy500: 0.3340 - 12s/epoch - 14ms/step
Epoch 4/50
878/878 - 12s - loss: 3.2992 - accuracy500: 0.3484 - val_loss: 3.3018 - val_accuracy500: 0.3393 - 12s/epoch - 14ms/step
Epoch 5/50
878/878 - 12s - loss: 3.2966 - accuracy500: 0.3500 - val_loss: 3.2988 - val_accuracy500: 0.3422 - 12s/epoch - 14ms/step
Epoch 6/50
878/878 - 12s - loss: 3.2946 - accuracy500: 0.3519 - val_loss: 3.2982 - val_accuracy500: 0.3429 - 12s/epoch - 14ms/step
Epoch 7/50
878/878 - 12s - loss: 3.2942 - accuracy500: 0.3513 - val_loss: 3.2970 - val_accuracy500: 0.3437 - 12s/epoch - 14ms/step
Epoch 8/50
878/878 - 12s - loss: 3.2928 - accuracy500: 0.3523 - val_loss: 3.2974 - val_accuracy500: 0.3438 - 12s/epoch - 14ms/step
Epoch 9/50
878/878 - 12s - loss: 3.2915 - accuracy500: 0.3521 - val_loss: 3.2968 - val_accuracy500: 0.3460 - 12s/epoch - 14ms/step
Epoch 10/50
878/878 - 13s - loss: 3.2911 - accuracy500: 0.3542 - val_loss: 3.2969 - val_accuracy500: 0.3453 - 13s/epoch - 14ms/step
Epoch 11/50
878/878 - 12s - loss: 3.2903 - accuracy500: 0.3548 - val_loss: 3.2972 - val_accuracy500: 0.3443 - 12s/epoch - 14ms/step
Epoch 12/50
878/878 - 12s - loss: 3.2893 - accuracy500: 0.3568 - val_loss: 3.2969 - val_accuracy500: 0.3461 - 12s/epoch - 14ms/step
Epoch 13/50
878/878 - 12s - loss: 3.2886 - accuracy500: 0.3575 - val_loss: 3.2976 - val_accuracy500: 0.3435 - 12s/epoch - 14ms/step
Epoch 14/50
878/878 - 12s - loss: 3.2876 - accuracy500: 0.3578 - val_loss: 3.2973 - val_accuracy500: 0.3453 - 12s/epoch - 13ms/step
Epoch 15/50
878/878 - 12s - loss: 3.2867 - accuracy500: 0.3594 - val_loss: 3.2979 - val_accuracy500: 0.3443 - 12s/epoch - 14ms/step
Epoch 16/50
878/878 - 12s - loss: 3.2861 - accuracy500: 0.3607 - val_loss: 3.2988 - val_accuracy500: 0.3438 - 12s/epoch - 14ms/step
Epoch 17/50
878/878 - 12s - loss: 3.2848 - accuracy500: 0.3624 - val_loss: 3.2982 - val_accuracy500: 0.3432 - 12s/epoch - 14ms/step
Epoch 18/50
878/878 - 12s - loss: 3.2843 - accuracy500: 0.3623 - val_loss: 3.2986 - val_accuracy500: 0.3418 - 12s/epoch - 14ms/step
Epoch 19/50
878/878 - 12s - loss: 3.2831 - accuracy500: 0.3645 - val_loss: 3.3006 - val_accuracy500: 0.3418 - 12s/epoch - 14ms/step
testing model: results/PCAR/W3/deepOF_L1/h500
Evaluating performance on  test set...
2282/2282 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0987985
{'0': {'precision': 0.36270250635670176, 'recall': 0.12602801968951155, 'f1-score': 0.18705882352941178, 'support': 198075}, '1': {'precision': 0.34260528675495217, 'recall': 0.4588802810959965, 'f1-score': 0.3923085245630374, 'support': 201497}, '2': {'precision': 0.33025798666036105, 'recall': 0.4392551743583904, 'f1-score': 0.37703716287761546, 'support': 184419}, 'accuracy': 0.33978777070194577, 'macro avg': {'precision': 0.34518859325733836, 'recall': 0.3413878250479661, 'f1-score': 0.3188015036566882, 'support': 583991}, 'weighted avg': {'precision': 0.3455225920498491, 'recall': 0.33978777070194577, 'f1-score': 0.3178704531151911, 'support': 583991}}
[[24963 93896 79216]
 [23973 92463 85061]
 [19889 83523 81007]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0971186
{'0': {'precision': 0.3636593219268893, 'recall': 0.1553356166230684, 'f1-score': 0.217687074829932, 'support': 74162}, '1': {'precision': 0.3350415670197016, 'recall': 0.4361337969326972, 'f1-score': 0.3789616670472443, 'support': 74202}, '2': {'precision': 0.3616075130607845, 'recall': 0.45674745014860496, 'f1-score': 0.40364711395495495, 'support': 76377}, 'accuracy': 0.35047899582185715, 'macro avg': {'precision': 0.3534361340024585, 'recall': 0.34940562123479024, 'f1-score': 0.3334319519440438, 'support': 224741}, 'weighted avg': {'precision': 0.3535133954809376, 'recall': 0.35047899582185715, 'f1-score': 0.334132081303877, 'support': 224741}}
[[11520 32342 30300]
 [10553 32362 31287]
 [ 9605 31887 34885]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0988301
{'0': {'precision': 0.35065517860348233, 'recall': 0.15274845570412074, 'f1-score': 0.21279956427015254, 'support': 25578}, '1': {'precision': 0.33352084712111185, 'recall': 0.39445053224796495, 'f1-score': 0.3614358459442014, 'support': 25552}, '2': {'precision': 0.3503957783641161, 'recall': 0.48084765788771583, 'f1-score': 0.40538543105941327, 'support': 26237}, 'accuracy': 0.3438416896092649, 'macro avg': {'precision': 0.34485726802957006, 'recall': 0.3426822152799338, 'f1-score': 0.3265402804245891, 'support': 77367}, 'weighted avg': {'precision': 0.3449082539183093, 'recall': 0.3438416896092649, 'f1-score': 0.32720014405591563, 'support': 77367}}
[[ 3907 10075 11596]
 [ 3680 10079 11793]
 [ 3555 10066 12616]]
training model: results/PCAR/W3/deepOF_L1/h1000
Epoch 1/50
878/878 - 15s - loss: 3.3347 - accuracy1000: 0.3484 - val_loss: 3.4054 - val_accuracy1000: 0.3216 - 15s/epoch - 17ms/step
Epoch 2/50
878/878 - 12s - loss: 3.3138 - accuracy1000: 0.3471 - val_loss: 3.3345 - val_accuracy1000: 0.3234 - 12s/epoch - 14ms/step
Epoch 3/50
878/878 - 12s - loss: 3.3054 - accuracy1000: 0.3436 - val_loss: 3.3140 - val_accuracy1000: 0.3279 - 12s/epoch - 14ms/step
Epoch 4/50
878/878 - 12s - loss: 3.3019 - accuracy1000: 0.3403 - val_loss: 3.3078 - val_accuracy1000: 0.3334 - 12s/epoch - 14ms/step
Epoch 5/50
878/878 - 12s - loss: 3.2997 - accuracy1000: 0.3411 - val_loss: 3.3052 - val_accuracy1000: 0.3363 - 12s/epoch - 14ms/step
Epoch 6/50
878/878 - 12s - loss: 3.2979 - accuracy1000: 0.3428 - val_loss: 3.3046 - val_accuracy1000: 0.3343 - 12s/epoch - 14ms/step
Epoch 7/50
878/878 - 12s - loss: 3.2971 - accuracy1000: 0.3426 - val_loss: 3.3040 - val_accuracy1000: 0.3389 - 12s/epoch - 14ms/step
Epoch 8/50
878/878 - 12s - loss: 3.2960 - accuracy1000: 0.3446 - val_loss: 3.3042 - val_accuracy1000: 0.3391 - 12s/epoch - 14ms/step
Epoch 9/50
878/878 - 12s - loss: 3.2948 - accuracy1000: 0.3463 - val_loss: 3.3036 - val_accuracy1000: 0.3364 - 12s/epoch - 14ms/step
Epoch 10/50
878/878 - 12s - loss: 3.2942 - accuracy1000: 0.3469 - val_loss: 3.3040 - val_accuracy1000: 0.3374 - 12s/epoch - 14ms/step
Epoch 11/50
878/878 - 12s - loss: 3.2935 - accuracy1000: 0.3484 - val_loss: 3.3042 - val_accuracy1000: 0.3379 - 12s/epoch - 14ms/step
Epoch 12/50
878/878 - 12s - loss: 3.2919 - accuracy1000: 0.3492 - val_loss: 3.3048 - val_accuracy1000: 0.3393 - 12s/epoch - 13ms/step
Epoch 13/50
878/878 - 12s - loss: 3.2909 - accuracy1000: 0.3505 - val_loss: 3.3053 - val_accuracy1000: 0.3359 - 12s/epoch - 14ms/step
Epoch 14/50
878/878 - 12s - loss: 3.2905 - accuracy1000: 0.3515 - val_loss: 3.3047 - val_accuracy1000: 0.3395 - 12s/epoch - 14ms/step
Epoch 15/50
878/878 - 12s - loss: 3.2891 - accuracy1000: 0.3534 - val_loss: 3.3062 - val_accuracy1000: 0.3366 - 12s/epoch - 14ms/step
Epoch 16/50
878/878 - 12s - loss: 3.2881 - accuracy1000: 0.3543 - val_loss: 3.3062 - val_accuracy1000: 0.3373 - 12s/epoch - 14ms/step
Epoch 17/50
878/878 - 12s - loss: 3.2871 - accuracy1000: 0.3567 - val_loss: 3.3070 - val_accuracy1000: 0.3356 - 12s/epoch - 14ms/step
Epoch 18/50
878/878 - 12s - loss: 3.2857 - accuracy1000: 0.3578 - val_loss: 3.3080 - val_accuracy1000: 0.3339 - 12s/epoch - 14ms/step
Epoch 19/50
878/878 - 12s - loss: 3.2851 - accuracy1000: 0.3583 - val_loss: 3.3079 - val_accuracy1000: 0.3335 - 12s/epoch - 14ms/step
testing model: results/PCAR/W3/deepOF_L1/h1000
Evaluating performance on  test set...
2282/2282 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1022959
{'0': {'precision': 0.3563327032136106, 'recall': 0.009112355096634472, 'f1-score': 0.01777027791394849, 'support': 206862}, '1': {'precision': 0.3355976793101476, 'recall': 0.5399282303988222, 'f1-score': 0.41391958617446506, 'support': 195626}, '2': {'precision': 0.31988468255501634, 'recall': 0.4652209605350876, 'f1-score': 0.3791007250768851, 'support': 181503}, 'accuracy': 0.32868314751425964, 'macro avg': {'precision': 0.3372716883595915, 'recall': 0.3380871820101814, 'f1-score': 0.2702635297217662, 'support': 583991}, 'weighted avg': {'precision': 0.33805890296714153, 'recall': 0.32868314751425964, 'f1-score': 0.26277347955436126, 'support': 583991}}
[[  1885 113521  91456]
 [  1930 105624  88072]
 [  1475  95589  84439]]
Evaluating performance on  train set...
878/878 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977979
{'0': {'precision': 0.3541731791184745, 'recall': 0.015429030544850408, 'f1-score': 0.02956989247311828, 'support': 73433}, '1': {'precision': 0.33605196207553806, 'recall': 0.5538776830978319, 'f1-score': 0.4183065103278329, 'support': 74168}, '2': {'precision': 0.360205037311554, 'recall': 0.4636764324604615, 'f1-score': 0.4054432410068069, 'support': 77140}, 'accuracy': 0.3469816366395095, 'macro avg': {'precision': 0.35014339283518886, 'recall': 0.3443277153677146, 'f1-score': 0.28443988126925274, 'support': 224741}, 'weighted avg': {'precision': 0.3502632700025306, 'recall': 0.3469816366395095, 'f1-score': 0.28687357795523866, 'support': 224741}}
[[ 1133 40763 31537]
 [ 1094 41080 31994]
 [  972 40400 35768]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007237
{'0': {'precision': 0.34296875, 'recall': 0.01703002560322756, 'f1-score': 0.03244881365954616, 'support': 25778}, '1': {'precision': 0.3241839762611276, 'recall': 0.5262101629605844, 'f1-score': 0.4011996205282003, 'support': 24914}, '2': {'precision': 0.35116559598283165, 'recall': 0.4692783505154639, 'f1-score': 0.40172009884150056, 'support': 26675}, 'accuracy': 0.33692659661095814, 'macro avg': {'precision': 0.33943944074798643, 'recall': 0.337506179693092, 'f1-score': 0.2784561776764157, 'support': 77367}, 'weighted avg': {'precision': 0.3397457610468516, 'recall': 0.33692659661095814, 'f1-score': 0.27851456694653265, 'support': 77367}}
[[  439 13575 11764]
 [  439 13110 11365]
 [  402 13755 12518]]
training model: results/PCAR/W3/deepLOB_L2/h10
Epoch 1/50
878/878 - 40s - loss: 3.2441 - accuracy10: 0.4029 - val_loss: 3.2740 - val_accuracy10: 0.3838 - 40s/epoch - 46ms/step
Epoch 2/50
878/878 - 37s - loss: 3.1298 - accuracy10: 0.4531 - val_loss: 3.2153 - val_accuracy10: 0.4081 - 37s/epoch - 42ms/step
Epoch 3/50
878/878 - 37s - loss: 3.0839 - accuracy10: 0.4682 - val_loss: 3.1955 - val_accuracy10: 0.4169 - 37s/epoch - 42ms/step
Epoch 4/50
878/878 - 36s - loss: 3.0547 - accuracy10: 0.4773 - val_loss: 3.1865 - val_accuracy10: 0.4293 - 36s/epoch - 41ms/step
Epoch 5/50
878/878 - 36s - loss: 3.0282 - accuracy10: 0.4855 - val_loss: 3.1886 - val_accuracy10: 0.4323 - 36s/epoch - 41ms/step
Epoch 6/50
878/878 - 37s - loss: 3.0120 - accuracy10: 0.4912 - val_loss: 3.1672 - val_accuracy10: 0.4423 - 37s/epoch - 42ms/step
Epoch 7/50
878/878 - 36s - loss: 2.9979 - accuracy10: 0.4949 - val_loss: 3.1389 - val_accuracy10: 0.4494 - 36s/epoch - 41ms/step
Epoch 8/50
878/878 - 36s - loss: 2.9868 - accuracy10: 0.4988 - val_loss: 3.1350 - val_accuracy10: 0.4508 - 36s/epoch - 41ms/step
Epoch 9/50
878/878 - 36s - loss: 2.9774 - accuracy10: 0.5011 - val_loss: 3.1549 - val_accuracy10: 0.4493 - 36s/epoch - 41ms/step
Epoch 10/50
878/878 - 36s - loss: 2.9688 - accuracy10: 0.5043 - val_loss: 3.1659 - val_accuracy10: 0.4507 - 36s/epoch - 41ms/step
Epoch 11/50
878/878 - 36s - loss: 2.9606 - accuracy10: 0.5064 - val_loss: 3.1514 - val_accuracy10: 0.4506 - 36s/epoch - 41ms/step
Epoch 12/50
878/878 - 36s - loss: 2.9540 - accuracy10: 0.5093 - val_loss: 3.1747 - val_accuracy10: 0.4473 - 36s/epoch - 41ms/step
Epoch 13/50
878/878 - 36s - loss: 2.9469 - accuracy10: 0.5094 - val_loss: 3.1736 - val_accuracy10: 0.4482 - 36s/epoch - 41ms/step
Epoch 14/50
878/878 - 36s - loss: 2.9409 - accuracy10: 0.5125 - val_loss: 3.1684 - val_accuracy10: 0.4522 - 36s/epoch - 41ms/step
Epoch 15/50
878/878 - 36s - loss: 2.9329 - accuracy10: 0.5143 - val_loss: 3.2181 - val_accuracy10: 0.4465 - 36s/epoch - 41ms/step
Epoch 16/50
878/878 - 36s - loss: 2.9272 - accuracy10: 0.5158 - val_loss: 3.2566 - val_accuracy10: 0.4409 - 36s/epoch - 41ms/step
Epoch 17/50
878/878 - 36s - loss: 2.9205 - accuracy10: 0.5176 - val_loss: 3.2639 - val_accuracy10: 0.4411 - 36s/epoch - 41ms/step
Epoch 18/50
878/878 - 36s - loss: 2.9146 - accuracy10: 0.5197 - val_loss: 3.2803 - val_accuracy10: 0.4401 - 36s/epoch - 41ms/step
testing model: results/PCAR/W3/deepLOB_L2/h10
Evaluating performance on  test set...
2282/2282 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0365503
{'0': {'precision': 0.4703055251129347, 'recall': 0.46888674508717043, 'f1-score': 0.4695950634681698, 'support': 187621}, '1': {'precision': 0.47183837925261757, 'recall': 0.3210510565589675, 'f1-score': 0.3821067688436727, 'support': 207182}, '2': {'precision': 0.4424576509563695, 'recall': 0.5986246775762188, 'f1-score': 0.5088282864588013, 'support': 189192}, 'accuracy': 0.4584696786787558, 'macro avg': {'precision': 0.46153385177397394, 'recall': 0.4628541597407856, 'f1-score': 0.4535100395902146, 'support': 583995}, 'weighted avg': {'precision': 0.4618276867392138, 'recall': 0.4584696786787558, 'f1-score': 0.4512671874883258, 'support': 583995}}
[[ 87973  40152  59496]
 [ 57449  66516  83217]
 [ 41633  34304 113255]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0155547
{'0': {'precision': 0.5143163538873995, 'recall': 0.3870967741935484, 'f1-score': 0.44172909247206193, 'support': 74338}, '1': {'precision': 0.49868954431087503, 'recall': 0.38457703398280646, 'f1-score': 0.4342619783028772, 'support': 74214}, '2': {'precision': 0.45448678301556994, 'recall': 0.6654722998779383, 'f1-score': 0.5401060974050876, 'support': 76191}, 'accuracy': 0.4806378841610195, 'macro avg': {'precision': 0.4891642270712815, 'recall': 0.47904870268476435, 'f1-score': 0.4720323893933423, 'support': 224743}, 'weighted avg': {'precision': 0.48887305696510264, 'recall': 0.4806378841610195, 'f1-score': 0.47261449478448225, 'support': 224743}}
[[28776 15562 30000]
 [14815 28541 30858]
 [12359 13129 50703]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0436779
{'0': {'precision': 0.50201126307321, 'recall': 0.299771808318988, 'f1-score': 0.3753853866399299, 'support': 24979}, '1': {'precision': 0.42539323091988496, 'recall': 0.5145850299844525, 'f1-score': 0.4657575554513168, 'support': 27014}, '2': {'precision': 0.4518523494441272, 'recall': 0.5301883818081501, 'f1-score': 0.48789598708905285, 'support': 25374}, 'accuracy': 0.4503470471906627, 'macro avg': {'precision': 0.4597522811457407, 'recall': 0.44818174003719685, 'f1-score': 0.4430129763934332, 'support': 77367}, 'weighted avg': {'precision': 0.45880819464591843, 'recall': 0.4503470471906627, 'f1-score': 0.4438403835257708, 'support': 77367}}
[[ 7488 10182  7309]
 [ 4102 13901  9011]
 [ 3326  8595 13453]]
training model: results/PCAR/W3/deepLOB_L2/h20
Epoch 1/50
878/878 - 39s - loss: 3.2809 - accuracy20: 0.3842 - val_loss: 3.2736 - val_accuracy20: 0.3811 - 39s/epoch - 44ms/step
Epoch 2/50
878/878 - 36s - loss: 3.1866 - accuracy20: 0.4288 - val_loss: 3.2823 - val_accuracy20: 0.3982 - 36s/epoch - 41ms/step
Epoch 3/50
878/878 - 36s - loss: 3.1483 - accuracy20: 0.4472 - val_loss: 3.2514 - val_accuracy20: 0.4067 - 36s/epoch - 41ms/step
Epoch 4/50
878/878 - 36s - loss: 3.1321 - accuracy20: 0.4521 - val_loss: 3.3176 - val_accuracy20: 0.3900 - 36s/epoch - 41ms/step
Epoch 5/50
878/878 - 36s - loss: 3.1198 - accuracy20: 0.4557 - val_loss: 3.3170 - val_accuracy20: 0.4010 - 36s/epoch - 41ms/step
Epoch 6/50
878/878 - 36s - loss: 3.1090 - accuracy20: 0.4609 - val_loss: 3.2960 - val_accuracy20: 0.4056 - 36s/epoch - 41ms/step
Epoch 7/50
878/878 - 36s - loss: 3.1018 - accuracy20: 0.4617 - val_loss: 3.2971 - val_accuracy20: 0.4080 - 36s/epoch - 41ms/step
Epoch 8/50
878/878 - 36s - loss: 3.0932 - accuracy20: 0.4653 - val_loss: 3.2917 - val_accuracy20: 0.4055 - 36s/epoch - 41ms/step
Epoch 9/50
878/878 - 37s - loss: 3.0877 - accuracy20: 0.4670 - val_loss: 3.2965 - val_accuracy20: 0.4076 - 37s/epoch - 42ms/step
Epoch 10/50
878/878 - 36s - loss: 3.0824 - accuracy20: 0.4691 - val_loss: 3.3099 - val_accuracy20: 0.4072 - 36s/epoch - 41ms/step
Epoch 11/50
878/878 - 36s - loss: 3.0771 - accuracy20: 0.4712 - val_loss: 3.3304 - val_accuracy20: 0.4056 - 36s/epoch - 41ms/step
Epoch 12/50
878/878 - 36s - loss: 3.0722 - accuracy20: 0.4732 - val_loss: 3.3664 - val_accuracy20: 0.4022 - 36s/epoch - 41ms/step
Epoch 13/50
878/878 - 36s - loss: 3.0664 - accuracy20: 0.4744 - val_loss: 3.3350 - val_accuracy20: 0.4055 - 36s/epoch - 41ms/step
testing model: results/PCAR/W3/deepLOB_L2/h20
Evaluating performance on  test set...
2282/2282 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0711828
{'0': {'precision': 0.4783878562700549, 'recall': 0.25254087957961424, 'f1-score': 0.3305725553728766, 'support': 190682}, '1': {'precision': 0.42765617080587937, 'recall': 0.2715159864646759, 'f1-score': 0.3321513474946103, 'support': 198887}, '2': {'precision': 0.3994824428250556, 'recall': 0.7336467344902431, 'f1-score': 0.5172914007195079, 'support': 194426}, 'accuracy': 0.4191748217022406, 'macro avg': {'precision': 0.4351754899669966, 'recall': 0.4192345335115111, 'f1-score': 0.39333843452899825, 'support': 583995}, 'weighted avg': {'precision': 0.4348410165858608, 'recall': 0.4191748217022406, 'f1-score': 0.3932734337264231, 'support': 583995}}
[[ 48155  42144 100383]
 [ 30847  54001 114039]
 [ 21659  30127 142640]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0737656
{'0': {'precision': 0.4732908678102926, 'recall': 0.20192928640619956, 'f1-score': 0.28308185590343266, 'support': 74328}, '1': {'precision': 0.43201728770003506, 'recall': 0.2994332748616921, 'f1-score': 0.3537090758392043, 'support': 74110}, '2': {'precision': 0.4071436134542759, 'recall': 0.755887556516611, 'f1-score': 0.5292287929531587, 'support': 76305}, 'accuracy': 0.42216220304970564, 'macro avg': {'precision': 0.4374839229882012, 'recall': 0.4190833725948342, 'f1-score': 0.3886732415652652, 'support': 224743}, 'weighted avg': {'precision': 0.4372223305672771, 'recall': 0.42216220304970564, 'f1-score': 0.3899435837482126, 'support': 224743}}
[[15009 17206 42113]
 [10045 22191 41874]
 [ 6658 11969 57678]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0811261
{'0': {'precision': 0.46024478295324467, 'recall': 0.20736303407783552, 'f1-score': 0.2859096378951974, 'support': 25207}, '1': {'precision': 0.3929214741249209, 'recall': 0.3045085832861724, 'f1-score': 0.343110997746886, 'support': 26505}, '2': {'precision': 0.4019441817502034, 'recall': 0.7123757552134087, 'f1-score': 0.5139193521174287, 'support': 25655}, 'accuracy': 0.4081068155673608, 'macro avg': {'precision': 0.41837014627612296, 'recall': 0.4080824575258055, 'f1-score': 0.3809799959198374, 'support': 77367}, 'weighted avg': {'precision': 0.41784807344714076, 'recall': 0.4081068155673608, 'f1-score': 0.38111445727866, 'support': 77367}}
[[ 5227  7459 12521]
 [ 3762  8071 14672]
 [ 2368  5011 18276]]
training model: results/PCAR/W3/deepLOB_L2/h30
Epoch 1/50
878/878 - 39s - loss: 3.2915 - accuracy30: 0.3757 - val_loss: 3.3082 - val_accuracy30: 0.3671 - 39s/epoch - 44ms/step
Epoch 2/50
878/878 - 37s - loss: 3.2115 - accuracy30: 0.4184 - val_loss: 3.2728 - val_accuracy30: 0.3882 - 37s/epoch - 42ms/step
Epoch 3/50
878/878 - 36s - loss: 3.1835 - accuracy30: 0.4320 - val_loss: 3.3071 - val_accuracy30: 0.3891 - 36s/epoch - 41ms/step
Epoch 4/50
878/878 - 36s - loss: 3.1693 - accuracy30: 0.4358 - val_loss: 3.3098 - val_accuracy30: 0.3898 - 36s/epoch - 41ms/step
Epoch 5/50
878/878 - 36s - loss: 3.1590 - accuracy30: 0.4398 - val_loss: 3.3885 - val_accuracy30: 0.3851 - 36s/epoch - 41ms/step
Epoch 6/50
878/878 - 36s - loss: 3.1510 - accuracy30: 0.4422 - val_loss: 3.3956 - val_accuracy30: 0.3864 - 36s/epoch - 41ms/step
Epoch 7/50
878/878 - 36s - loss: 3.1442 - accuracy30: 0.4458 - val_loss: 3.3550 - val_accuracy30: 0.3949 - 36s/epoch - 41ms/step
Epoch 8/50
878/878 - 36s - loss: 3.1375 - accuracy30: 0.4476 - val_loss: 3.3887 - val_accuracy30: 0.3916 - 36s/epoch - 41ms/step
Epoch 9/50
878/878 - 36s - loss: 3.1331 - accuracy30: 0.4490 - val_loss: 3.3457 - val_accuracy30: 0.4013 - 36s/epoch - 41ms/step
Epoch 10/50
878/878 - 36s - loss: 3.1272 - accuracy30: 0.4510 - val_loss: 3.3245 - val_accuracy30: 0.4056 - 36s/epoch - 41ms/step
Epoch 11/50
878/878 - 36s - loss: 3.1235 - accuracy30: 0.4523 - val_loss: 3.3703 - val_accuracy30: 0.3977 - 36s/epoch - 41ms/step
Epoch 12/50
878/878 - 36s - loss: 3.1178 - accuracy30: 0.4547 - val_loss: 3.2892 - val_accuracy30: 0.4055 - 36s/epoch - 41ms/step
testing model: results/PCAR/W3/deepLOB_L2/h30
Evaluating performance on  test set...
2282/2282 - 30s - 30s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0782889
{'0': {'precision': 0.42015342453929483, 'recall': 0.39987985582699237, 'f1-score': 0.4097660298736761, 'support': 194766}, '1': {'precision': 0.39239786047570274, 'recall': 0.30760834199229614, 'f1-score': 0.34486795927432756, 'support': 190554}, '2': {'precision': 0.4177044550006419, 'recall': 0.5240317100792752, 'f1-score': 0.4648656130629595, 'support': 198675}, 'accuracy': 0.41200866445774365, 'macro avg': {'precision': 0.41008524667187984, 'recall': 0.4105066359661879, 'f1-score': 0.4064998674036544, 'support': 583995}, 'weighted avg': {'precision': 0.4102638145637546, 'recall': 0.41200866445774365, 'f1-score': 0.40733505485701094, 'support': 583995}}
[[ 77883  47868  69015]
 [ 55817  58616  76121]
 [ 51668  42895 104112]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0793359
{'0': {'precision': 0.43481184124661354, 'recall': 0.2954304217555457, 'f1-score': 0.3518192582162629, 'support': 74427}, '1': {'precision': 0.39210582235444114, 'recall': 0.2989913447386543, 'f1-score': 0.33927572760493674, 'support': 74059}, '2': {'precision': 0.4043856519005624, 'recall': 0.6241656503665237, 'f1-score': 0.4907944462489494, 'support': 76257}, 'accuracy': 0.4081461936523051, 'macro avg': {'precision': 0.410434438500539, 'recall': 0.4061958056202412, 'f1-score': 0.393963144023383, 'support': 224743}, 'weighted avg': {'precision': 0.4104151971949758, 'recall': 0.4081461936523051, 'f1-score': 0.3948411524699854, 'support': 224743}}
[[21988 18844 33595]
 [15406 22143 36510]
 [13175 15485 47597]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0900544
{'0': {'precision': 0.41551344830033354, 'recall': 0.23167932890155113, 'f1-score': 0.29748748825038746, 'support': 25272}, '1': {'precision': 0.35920295399354646, 'recall': 0.4082728372655777, 'f1-score': 0.3821692119839318, 'support': 26448}, '2': {'precision': 0.39831401475237094, 'recall': 0.5158498069949702, 'f1-score': 0.4495260099894669, 'support': 25647}, 'accuracy': 0.38624995152972197, 'macro avg': {'precision': 0.391010139015417, 'recall': 0.38526732438736633, 'f1-score': 0.37639423674126204, 'support': 77367}, 'weighted avg': {'precision': 0.3905620630116381, 'recall': 0.38624995152972197, 'f1-score': 0.376836489715443, 'support': 77367}}
[[ 5855 10339  9078]
 [ 4743 10798 10907]
 [ 3493  8924 13230]]
training model: results/PCAR/W3/deepLOB_L2/h50
Epoch 1/50
878/878 - 39s - loss: 3.2894 - accuracy50: 0.3772 - val_loss: 3.3254 - val_accuracy50: 0.3688 - 39s/epoch - 44ms/step
Epoch 2/50
878/878 - 36s - loss: 3.2461 - accuracy50: 0.3977 - val_loss: 3.3108 - val_accuracy50: 0.3627 - 36s/epoch - 41ms/step
Epoch 3/50
878/878 - 36s - loss: 3.2297 - accuracy50: 0.4064 - val_loss: 3.2928 - val_accuracy50: 0.3591 - 36s/epoch - 41ms/step
Epoch 4/50
878/878 - 36s - loss: 3.2131 - accuracy50: 0.4152 - val_loss: 3.2882 - val_accuracy50: 0.3590 - 36s/epoch - 41ms/step
Epoch 5/50
878/878 - 36s - loss: 3.1950 - accuracy50: 0.4232 - val_loss: 3.2755 - val_accuracy50: 0.3714 - 36s/epoch - 41ms/step
Epoch 6/50
878/878 - 36s - loss: 3.1854 - accuracy50: 0.4273 - val_loss: 3.3090 - val_accuracy50: 0.3700 - 36s/epoch - 41ms/step
Epoch 7/50
878/878 - 36s - loss: 3.1762 - accuracy50: 0.4317 - val_loss: 3.3427 - val_accuracy50: 0.3688 - 36s/epoch - 41ms/step
Epoch 8/50
878/878 - 36s - loss: 3.1698 - accuracy50: 0.4340 - val_loss: 3.3372 - val_accuracy50: 0.3667 - 36s/epoch - 41ms/step
Epoch 9/50
878/878 - 36s - loss: 3.1630 - accuracy50: 0.4362 - val_loss: 3.3661 - val_accuracy50: 0.3639 - 36s/epoch - 41ms/step
Epoch 10/50
878/878 - 36s - loss: 3.1573 - accuracy50: 0.4394 - val_loss: 3.3469 - val_accuracy50: 0.3669 - 36s/epoch - 41ms/step
Epoch 11/50
878/878 - 36s - loss: 3.1523 - accuracy50: 0.4418 - val_loss: 3.3573 - val_accuracy50: 0.3747 - 36s/epoch - 41ms/step
Epoch 12/50
878/878 - 36s - loss: 3.1480 - accuracy50: 0.4435 - val_loss: 3.3414 - val_accuracy50: 0.3798 - 36s/epoch - 41ms/step
Epoch 13/50
878/878 - 36s - loss: 3.1422 - accuracy50: 0.4457 - val_loss: 3.3557 - val_accuracy50: 0.3683 - 36s/epoch - 41ms/step
Epoch 14/50
878/878 - 36s - loss: 3.1371 - accuracy50: 0.4473 - val_loss: 3.4072 - val_accuracy50: 0.3613 - 36s/epoch - 41ms/step
Epoch 15/50
878/878 - 36s - loss: 3.1329 - accuracy50: 0.4499 - val_loss: 3.3675 - val_accuracy50: 0.3703 - 36s/epoch - 41ms/step
testing model: results/PCAR/W3/deepLOB_L2/h50
Evaluating performance on  test set...
2282/2282 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0800683
{'0': {'precision': 0.412036858406614, 'recall': 0.5534703800903699, 'f1-score': 0.4723945870950878, 'support': 212239}, '1': {'precision': 0.33954209142978686, 'recall': 0.14201292470754195, 'f1-score': 0.20026524010502075, 'support': 157373}, '2': {'precision': 0.42339424153627675, 'recall': 0.4603256788084876, 'f1-score': 0.4410882614545016, 'support': 214383}, 'accuracy': 0.4083990445123674, 'macro avg': {'precision': 0.39165773045755925, 'recall': 0.38526966120213313, 'f1-score': 0.37124936288487004, 'support': 583995}, 'weighted avg': {'precision': 0.3966704783931589, 'recall': 0.4083990445123674, 'f1-score': 0.3875696215839557, 'support': 583995}}
[[117468  21982  72789]
 [ 73416  22349  61608]
 [ 94207  21490  98686]]
Evaluating performance on  train set...
878/878 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0795509
{'0': {'precision': 0.3945559161994689, 'recall': 0.35856696566241636, 'f1-score': 0.3757015516672169, 'support': 74583}, '1': {'precision': 0.4515315602272124, 'recall': 0.2293020246407678, 'f1-score': 0.30414804219560165, 'support': 74186}, '2': {'precision': 0.39307061003110094, 'recall': 0.6171716639903124, 'f1-score': 0.480265078381465, 'support': 75974}, 'accuracy': 0.4033184570820893, 'macro avg': {'precision': 0.41305269548592743, 'recall': 0.4016802180978322, 'f1-score': 0.38670489074809455, 'support': 224743}, 'weighted avg': {'precision': 0.4128610490712673, 'recall': 0.4033184570820893, 'f1-score': 0.38742979559440055, 'support': 224743}}
[[26743 10965 36875]
 [21650 17011 35525]
 [19387  9698 46889]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0917436
{'0': {'precision': 0.3720606826801517, 'recall': 0.34649346571955575, 'f1-score': 0.3588222145455284, 'support': 25481}, '1': {'precision': 0.352324819908317, 'recall': 0.2665599512157939, 'f1-score': 0.3034997504827616, 'support': 26238}, '2': {'precision': 0.38412360149174213, 'recall': 0.506004366812227, 'f1-score': 0.43671972271763637, 'support': 25648}, 'accuracy': 0.3722646606434268, 'macro avg': {'precision': 0.3695030346934036, 'recall': 0.37301926124919227, 'f1-score': 0.3663472292486421, 'support': 77367}, 'weighted avg': {'precision': 0.36936651299892165, 'recall': 0.3722646606434268, 'f1-score': 0.36588419804649586, 'support': 77367}}
[[ 8829  6660  9992]
 [ 8428  6994 10816]
 [ 6473  6197 12978]]
training model: results/PCAR/W3/deepLOB_L2/h100
Epoch 1/50
878/878 - 41s - loss: 3.3169 - accuracy100: 0.3590 - val_loss: 3.3596 - val_accuracy100: 0.3499 - 41s/epoch - 46ms/step
Epoch 2/50
878/878 - 37s - loss: 3.2801 - accuracy100: 0.3724 - val_loss: 3.3658 - val_accuracy100: 0.3456 - 37s/epoch - 42ms/step
Epoch 3/50
878/878 - 38s - loss: 3.2636 - accuracy100: 0.3820 - val_loss: 3.3397 - val_accuracy100: 0.3485 - 38s/epoch - 43ms/step
Epoch 4/50
878/878 - 38s - loss: 3.2532 - accuracy100: 0.3890 - val_loss: 3.3426 - val_accuracy100: 0.3491 - 38s/epoch - 43ms/step
Epoch 5/50
878/878 - 37s - loss: 3.2432 - accuracy100: 0.3940 - val_loss: 3.3452 - val_accuracy100: 0.3489 - 37s/epoch - 42ms/step
Epoch 6/50
878/878 - 37s - loss: 3.2347 - accuracy100: 0.3991 - val_loss: 3.3543 - val_accuracy100: 0.3484 - 37s/epoch - 42ms/step
Epoch 7/50
878/878 - 36s - loss: 3.2276 - accuracy100: 0.4026 - val_loss: 3.3724 - val_accuracy100: 0.3493 - 36s/epoch - 41ms/step
Epoch 8/50
878/878 - 36s - loss: 3.2218 - accuracy100: 0.4063 - val_loss: 3.3623 - val_accuracy100: 0.3509 - 36s/epoch - 41ms/step
Epoch 9/50
878/878 - 36s - loss: 3.2162 - accuracy100: 0.4102 - val_loss: 3.3815 - val_accuracy100: 0.3495 - 36s/epoch - 41ms/step
Epoch 10/50
878/878 - 36s - loss: 3.2121 - accuracy100: 0.4124 - val_loss: 3.3838 - val_accuracy100: 0.3508 - 36s/epoch - 41ms/step
Epoch 11/50
878/878 - 36s - loss: 3.2067 - accuracy100: 0.4154 - val_loss: 3.3898 - val_accuracy100: 0.3512 - 36s/epoch - 41ms/step
Epoch 12/50
878/878 - 36s - loss: 3.2023 - accuracy100: 0.4180 - val_loss: 3.3936 - val_accuracy100: 0.3490 - 36s/epoch - 41ms/step
Epoch 13/50
878/878 - 36s - loss: 3.1969 - accuracy100: 0.4198 - val_loss: 3.3934 - val_accuracy100: 0.3512 - 36s/epoch - 41ms/step
testing model: results/PCAR/W3/deepLOB_L2/h100
Evaluating performance on  test set...
2282/2282 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1060109
{'0': {'precision': 0.3692685641901618, 'recall': 0.09675245652676784, 'f1-score': 0.15333059718442307, 'support': 198858}, '1': {'precision': 0.32882109549227095, 'recall': 0.5036468819557699, 'f1-score': 0.3978764924355289, 'support': 188243}, '2': {'precision': 0.35020220475027203, 'recall': 0.4332127947017177, 'f1-score': 0.3873096020287928, 'support': 196894}, 'accuracy': 0.34134710057449125, 'macro avg': {'precision': 0.34943062147756826, 'recall': 0.3445373777280851, 'f1-score': 0.3128388972162483, 'support': 583995}, 'weighted avg': {'precision': 0.3498026361845201, 'recall': 0.34134710057449125, 'f1-score': 0.31104276105497203, 'support': 583995}}
[[19240 99084 80534]
 [15701 94808 77734]
 [17162 94435 85297]]
Evaluating performance on  train set...
878/878 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1054566
{'0': {'precision': 0.35197193579249497, 'recall': 0.0886336866902238, 'f1-score': 0.14160768128648718, 'support': 74712}, '1': {'precision': 0.3470530390949601, 'recall': 0.5250214431221186, 'f1-score': 0.41787781007493535, 'support': 74616}, '2': {'precision': 0.35503492745835574, 'recall': 0.43805608963734005, 'f1-score': 0.3922001602706794, 'support': 75415}, 'accuracy': 0.3507695456588192, 'macro avg': {'precision': 0.35135330078193694, 'recall': 0.3505704064832275, 'f1-score': 0.317228550544034, 'support': 224743}, 'weighted avg': {'precision': 0.3513666538504439, 'recall': 0.3507695456588192, 'f1-score': 0.31742007024753033, 'support': 224743}}
[[ 6622 37337 30753]
 [ 6180 39175 29261]
 [ 6012 36367 33036]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1133573
{'0': {'precision': 0.3333333333333333, 'recall': 0.041225626740947076, 'f1-score': 0.07337630143777887, 'support': 25130}, '1': {'precision': 0.3505030181086519, 'recall': 0.6485721732007893, 'f1-score': 0.4550738646011573, 'support': 26859}, '2': {'precision': 0.34105623193126755, 'recall': 0.3300496493025455, 'f1-score': 0.3354626829805555, 'support': 25378}, 'accuracy': 0.34681453332816314, 'macro avg': {'precision': 0.3416308611244176, 'recall': 0.339949149748094, 'f1-score': 0.2879709496731639, 'support': 77367}, 'weighted avg': {'precision': 0.34182729437613785, 'recall': 0.34681453332816314, 'f1-score': 0.29185760535027083, 'support': 77367}}
[[ 1036 16316  7778]
 [ 1034 17420  8405]
 [ 1038 15964  8376]]
training model: results/PCAR/W3/deepLOB_L2/h200
Epoch 1/50
878/878 - 39s - loss: 3.2968 - accuracy200: 0.3762 - val_loss: 3.4859 - val_accuracy200: 0.3383 - 39s/epoch - 45ms/step
Epoch 2/50
878/878 - 37s - loss: 3.2686 - accuracy200: 0.3846 - val_loss: 3.4089 - val_accuracy200: 0.3410 - 37s/epoch - 42ms/step
Epoch 3/50
878/878 - 37s - loss: 3.2562 - accuracy200: 0.3913 - val_loss: 3.5031 - val_accuracy200: 0.3371 - 37s/epoch - 43ms/step
Epoch 4/50
878/878 - 37s - loss: 3.2457 - accuracy200: 0.3950 - val_loss: 3.4532 - val_accuracy200: 0.3574 - 37s/epoch - 42ms/step
Epoch 5/50
878/878 - 37s - loss: 3.2274 - accuracy200: 0.4066 - val_loss: 3.4112 - val_accuracy200: 0.3507 - 37s/epoch - 42ms/step
Epoch 6/50
878/878 - 36s - loss: 3.2165 - accuracy200: 0.4127 - val_loss: 3.4496 - val_accuracy200: 0.3457 - 36s/epoch - 41ms/step
Epoch 7/50
878/878 - 37s - loss: 3.2046 - accuracy200: 0.4172 - val_loss: 3.4599 - val_accuracy200: 0.3468 - 37s/epoch - 42ms/step
Epoch 8/50
878/878 - 36s - loss: 3.1958 - accuracy200: 0.4209 - val_loss: 3.4295 - val_accuracy200: 0.3408 - 36s/epoch - 41ms/step
Epoch 9/50
878/878 - 37s - loss: 3.1850 - accuracy200: 0.4251 - val_loss: 3.4577 - val_accuracy200: 0.3479 - 37s/epoch - 42ms/step
Epoch 10/50
878/878 - 36s - loss: 3.1776 - accuracy200: 0.4292 - val_loss: 3.4557 - val_accuracy200: 0.3503 - 36s/epoch - 41ms/step
Epoch 11/50
878/878 - 36s - loss: 3.1691 - accuracy200: 0.4324 - val_loss: 3.4496 - val_accuracy200: 0.3469 - 36s/epoch - 41ms/step
Epoch 12/50
878/878 - 36s - loss: 3.1615 - accuracy200: 0.4359 - val_loss: 3.5134 - val_accuracy200: 0.3454 - 36s/epoch - 41ms/step
testing model: results/PCAR/W3/deepLOB_L2/h200
Evaluating performance on  test set...
2282/2282 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1519406
{'0': {'precision': 0.38135688886380315, 'recall': 0.06358191117447501, 'f1-score': 0.10899206736488912, 'support': 212529}, '1': {'precision': 0.28243320674262107, 'recall': 0.6426137259420062, 'f1-score': 0.39240269634297836, 'support': 164914}, '2': {'precision': 0.35986177135736375, 'recall': 0.3019917502614354, 'f1-score': 0.32839679063302873, 'support': 206552}, 'accuracy': 0.3114170498035086, 'macro avg': {'precision': 0.3412172889879293, 'recall': 0.33606246245930554, 'f1-score': 0.27659718478029877, 'support': 583995}, 'weighted avg': {'precision': 0.3458193249728063, 'recall': 0.3114170498035086, 'f1-score': 0.26662503488648326, 'support': 583995}}
[[ 13513 137284  61732]
 [  9711 105976  49227]
 [ 12210 131965  62377]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1331196
{'0': {'precision': 0.3661791850063893, 'recall': 0.06901442372019588, 'f1-score': 0.11613978204088984, 'support': 74738}, '1': {'precision': 0.3360726254831213, 'recall': 0.7081918419806534, 'f1-score': 0.45583068101169927, 'support': 73915}, '2': {'precision': 0.35386801216779906, 'recall': 0.25531607307136284, 'f1-score': 0.2966203268976784, 'support': 76090}, 'accuracy': 0.34230654569886493, 'macro avg': {'precision': 0.3520399408857699, 'recall': 0.34417411292407074, 'f1-score': 0.28953026331675585, 'support': 224743}, 'weighted avg': {'precision': 0.35210940980337657, 'recall': 0.34230654569886493, 'f1-score': 0.2889639298701011, 'support': 224743}}
[[ 5158 51694 17886]
 [ 3983 52346 17586]
 [ 4945 51718 19427]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1369056
{'0': {'precision': 0.37570380481146565, 'recall': 0.08393687581001753, 'f1-score': 0.13721763514566132, 'support': 26234}, '1': {'precision': 0.3321989481155253, 'recall': 0.732210188527878, 'f1-score': 0.45704127492832913, 'support': 24930}, '2': {'precision': 0.3580962734794951, 'recall': 0.2262718009388238, 'f1-score': 0.2773152478952292, 'support': 26203}, 'accuracy': 0.3410368761875218, 'macro avg': {'precision': 0.355333008802162, 'recall': 0.34747295509223974, 'f1-score': 0.2905247193230732, 'support': 77367}, 'weighted avg': {'precision': 0.35572181997398433, 'recall': 0.3410368761875218, 'f1-score': 0.28772342038560644, 'support': 77367}}
[[ 2202 18460  5572]
 [ 1620 18254  5056]
 [ 2039 18235  5929]]
training model: results/PCAR/W3/deepLOB_L2/h300
Epoch 1/50
878/878 - 39s - loss: 3.3053 - accuracy300: 0.3680 - val_loss: 3.3854 - val_accuracy300: 0.3390 - 39s/epoch - 45ms/step
Epoch 2/50
878/878 - 37s - loss: 3.2691 - accuracy300: 0.3837 - val_loss: 3.3637 - val_accuracy300: 0.3502 - 37s/epoch - 42ms/step
Epoch 3/50
878/878 - 37s - loss: 3.2534 - accuracy300: 0.3956 - val_loss: 3.3554 - val_accuracy300: 0.3496 - 37s/epoch - 42ms/step
Epoch 4/50
878/878 - 36s - loss: 3.2373 - accuracy300: 0.4040 - val_loss: 3.3856 - val_accuracy300: 0.3515 - 36s/epoch - 41ms/step
Epoch 5/50
878/878 - 36s - loss: 3.2226 - accuracy300: 0.4106 - val_loss: 3.3842 - val_accuracy300: 0.3536 - 36s/epoch - 41ms/step
Epoch 6/50
878/878 - 36s - loss: 3.2086 - accuracy300: 0.4172 - val_loss: 3.4156 - val_accuracy300: 0.3517 - 36s/epoch - 41ms/step
Epoch 7/50
878/878 - 36s - loss: 3.1979 - accuracy300: 0.4225 - val_loss: 3.4163 - val_accuracy300: 0.3531 - 36s/epoch - 41ms/step
Epoch 8/50
878/878 - 36s - loss: 3.1896 - accuracy300: 0.4250 - val_loss: 3.4006 - val_accuracy300: 0.3503 - 36s/epoch - 41ms/step
Epoch 9/50
878/878 - 36s - loss: 3.1789 - accuracy300: 0.4317 - val_loss: 3.4231 - val_accuracy300: 0.3457 - 36s/epoch - 41ms/step
Epoch 10/50
878/878 - 36s - loss: 3.1728 - accuracy300: 0.4338 - val_loss: 3.4162 - val_accuracy300: 0.3460 - 36s/epoch - 41ms/step
Epoch 11/50
878/878 - 36s - loss: 3.1632 - accuracy300: 0.4364 - val_loss: 3.4235 - val_accuracy300: 0.3483 - 36s/epoch - 41ms/step
Epoch 12/50
878/878 - 36s - loss: 3.1559 - accuracy300: 0.4408 - val_loss: 3.4771 - val_accuracy300: 0.3449 - 36s/epoch - 41ms/step
Epoch 13/50
878/878 - 36s - loss: 3.1460 - accuracy300: 0.4451 - val_loss: 3.4508 - val_accuracy300: 0.3421 - 36s/epoch - 41ms/step
testing model: results/PCAR/W3/deepLOB_L2/h300
Evaluating performance on  test set...
2282/2282 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1176696
{'0': {'precision': 0.4087403598971722, 'recall': 0.008998950379715574, 'f1-score': 0.01761018954363531, 'support': 194356}, '1': {'precision': 0.3873654510602516, 'recall': 0.4802873759159613, 'f1-score': 0.4288506421597391, 'support': 202383}, '2': {'precision': 0.34292318688504647, 'recall': 0.6021062075447515, 'f1-score': 0.4369730312126362, 'support': 187256}, 'accuracy': 0.3625013912790349, 'macro avg': {'precision': 0.3796763326141568, 'recall': 0.3637975112801428, 'f1-score': 0.29447795430533685, 'support': 583995}, 'weighted avg': {'precision': 0.38022885085222985, 'recall': 0.3625013912790349, 'f1-score': 0.29459250069591464, 'support': 583995}}
[[  1749  80565 112042]
 [  1186  97202 103995]
 [  1344  73164 112748]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1133457
{'0': {'precision': 0.3725220973139964, 'recall': 0.05841036612440964, 'f1-score': 0.10098636765458521, 'support': 74319}, '1': {'precision': 0.36626438618925833, 'recall': 0.6176062317219444, 'f1-score': 0.4598311266750619, 'support': 74201}, '2': {'precision': 0.3655564396953507, 'recall': 0.42189365414638624, 'f1-score': 0.3917097562015433, 'support': 76223}, 'accuracy': 0.36631174274615896, 'macro avg': {'precision': 0.3681143077328685, 'recall': 0.3659700839975801, 'f1-score': 0.3175090835103968, 'support': 224743}, 'weighted avg': {'precision': 0.36809360902367044, 'recall': 0.36631174274615896, 'f1-score': 0.318062978758349, 'support': 224743}}
[[ 4341 39454 30524]
 [ 3086 45827 25288]
 [ 4226 39839 32158]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1182293
{'0': {'precision': 0.3405286343612335, 'recall': 0.03002174926207861, 'f1-score': 0.05517881361981584, 'support': 25748}, '1': {'precision': 0.3466808284652151, 'recall': 0.75610980271032, 'f1-score': 0.47539172967921256, 'support': 25901}, '2': {'precision': 0.36002579674316115, 'recall': 0.26047904191616766, 'f1-score': 0.30226734348561757, 'support': 25718}, 'accuracy': 0.3497098246022206, 'macro avg': {'precision': 0.3490784198565366, 'recall': 0.3488701979628554, 'f1-score': 0.2776126289282153, 'support': 77367}, 'weighted avg': {'precision': 0.3490694334309356, 'recall': 0.3497098246022206, 'f1-score': 0.27799419420770377, 'support': 77367}}
[[  773 18648  6327]
 [  736 19584  5581]
 [  761 18258  6699]]
training model: results/PCAR/W3/deepLOB_L2/h500
Epoch 1/50
878/878 - 39s - loss: 3.3097 - accuracy500: 0.3703 - val_loss: 3.4826 - val_accuracy500: 0.3374 - 39s/epoch - 44ms/step
Epoch 2/50
878/878 - 36s - loss: 3.2818 - accuracy500: 0.3837 - val_loss: 3.3796 - val_accuracy500: 0.3366 - 36s/epoch - 41ms/step
Epoch 3/50
878/878 - 36s - loss: 3.2629 - accuracy500: 0.3923 - val_loss: 3.3991 - val_accuracy500: 0.3353 - 36s/epoch - 41ms/step
Epoch 4/50
878/878 - 36s - loss: 3.2468 - accuracy500: 0.4021 - val_loss: 3.4134 - val_accuracy500: 0.3390 - 36s/epoch - 41ms/step
Epoch 5/50
878/878 - 36s - loss: 3.2246 - accuracy500: 0.4148 - val_loss: 3.4248 - val_accuracy500: 0.3458 - 36s/epoch - 41ms/step
Epoch 6/50
878/878 - 36s - loss: 3.2093 - accuracy500: 0.4218 - val_loss: 3.3899 - val_accuracy500: 0.3437 - 36s/epoch - 41ms/step
Epoch 7/50
878/878 - 36s - loss: 3.1954 - accuracy500: 0.4281 - val_loss: 3.4010 - val_accuracy500: 0.3481 - 36s/epoch - 41ms/step
Epoch 8/50
878/878 - 36s - loss: 3.1845 - accuracy500: 0.4322 - val_loss: 3.4342 - val_accuracy500: 0.3502 - 36s/epoch - 41ms/step
Epoch 9/50
878/878 - 36s - loss: 3.1733 - accuracy500: 0.4357 - val_loss: 3.3719 - val_accuracy500: 0.3491 - 36s/epoch - 41ms/step
Epoch 10/50
878/878 - 36s - loss: 3.1636 - accuracy500: 0.4408 - val_loss: 3.3868 - val_accuracy500: 0.3498 - 36s/epoch - 41ms/step
Epoch 11/50
878/878 - 36s - loss: 3.1551 - accuracy500: 0.4428 - val_loss: 3.3875 - val_accuracy500: 0.3503 - 36s/epoch - 41ms/step
Epoch 12/50
878/878 - 36s - loss: 3.1451 - accuracy500: 0.4478 - val_loss: 3.4518 - val_accuracy500: 0.3457 - 36s/epoch - 41ms/step
Epoch 13/50
878/878 - 36s - loss: 3.1382 - accuracy500: 0.4500 - val_loss: 3.5405 - val_accuracy500: 0.3469 - 36s/epoch - 41ms/step
Epoch 14/50
878/878 - 36s - loss: 3.1265 - accuracy500: 0.4537 - val_loss: 3.5745 - val_accuracy500: 0.3477 - 36s/epoch - 41ms/step
Epoch 15/50
878/878 - 36s - loss: 3.1171 - accuracy500: 0.4582 - val_loss: 3.5419 - val_accuracy500: 0.3467 - 36s/epoch - 41ms/step
Epoch 16/50
878/878 - 36s - loss: 3.1057 - accuracy500: 0.4610 - val_loss: 3.4662 - val_accuracy500: 0.3456 - 36s/epoch - 41ms/step
Epoch 17/50
878/878 - 36s - loss: 3.0956 - accuracy500: 0.4643 - val_loss: 3.4698 - val_accuracy500: 0.3426 - 36s/epoch - 41ms/step
Epoch 18/50
878/878 - 36s - loss: 3.0874 - accuracy500: 0.4658 - val_loss: 3.6187 - val_accuracy500: 0.3470 - 36s/epoch - 41ms/step
Epoch 19/50
878/878 - 36s - loss: 3.0791 - accuracy500: 0.4685 - val_loss: 3.5620 - val_accuracy500: 0.3479 - 36s/epoch - 41ms/step
testing model: results/PCAR/W3/deepLOB_L2/h500
Evaluating performance on  test set...
2282/2282 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1305679
{'0': {'precision': 0.3463854491554211, 'recall': 0.05663006436955698, 'f1-score': 0.09734528634284771, 'support': 198075}, '1': {'precision': 0.4116294206986331, 'recall': 0.047077623984476194, 'f1-score': 0.08449198813584986, 'support': 201497}, '2': {'precision': 0.3171386030531607, 'recall': 0.9089376053962901, 'f1-score': 0.47021416850166203, 'support': 184423}, 'accuracy': 0.3224890624063562, 'macro avg': {'precision': 0.35838449096907166, 'recall': 0.33754843125010775, 'f1-score': 0.21735048099345322, 'support': 583995}, 'weighted avg': {'precision': 0.35966068855871297, 'recall': 0.3224890624063562, 'f1-score': 0.21066080586880181, 'support': 583995}}
[[ 11217   7811 179047]
 [ 10120   9486 181891]
 [ 11046   5748 167629]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1187677
{'0': {'precision': 0.3507446808510638, 'recall': 0.08894704184314889, 'f1-score': 0.14190715991994318, 'support': 74134}, '1': {'precision': 0.393070169559681, 'recall': 0.1581715210355987, 'f1-score': 0.2255725851425934, 'support': 74160}, '2': {'precision': 0.34619905622341723, 'recall': 0.797472825020602, 'f1-score': 0.48280340526628396, 'support': 76449}, 'accuracy': 0.3528029794031405, 'macro avg': {'precision': 0.36333796887805403, 'recall': 0.3481971292997832, 'f1-score': 0.2834277167762735, 'support': 224743}, 'weighted avg': {'precision': 0.36316486650966984, 'recall': 0.3528029794031405, 'f1-score': 0.2854747237372552, 'support': 224743}}
[[ 6594  9414 58126]
 [ 5421 11730 57009]
 [ 6785  8698 60966]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1217892
{'0': {'precision': 0.35511766373688686, 'recall': 0.09806224310041103, 'f1-score': 0.1536856958802417, 'support': 25545}, '1': {'precision': 0.37150571791613723, 'recall': 0.18259885241422383, 'f1-score': 0.24485095914788937, 'support': 25619}, '2': {'precision': 0.343549141560264, 'recall': 0.7567835743998779, 'f1-score': 0.47257042085696577, 'support': 26203}, 'accuracy': 0.3491540320808614, 'macro avg': {'precision': 0.3567241744044294, 'recall': 0.3458148899715043, 'f1-score': 0.2903690252950323, 'support': 77367}, 'weighted avg': {'precision': 0.35662626008189396, 'recall': 0.3491540320808614, 'f1-score': 0.29187509611831436, 'support': 77367}}
[[ 2505  3811 19229]
 [ 2279  4678 18662]
 [ 2270  4103 19830]]
training model: results/PCAR/W3/deepLOB_L2/h1000
Epoch 1/50
878/878 - 39s - loss: 3.2952 - accuracy1000: 0.3871 - val_loss: 3.4816 - val_accuracy1000: 0.3402 - 39s/epoch - 45ms/step
Epoch 2/50
878/878 - 36s - loss: 3.2655 - accuracy1000: 0.3995 - val_loss: 3.3841 - val_accuracy1000: 0.3410 - 36s/epoch - 41ms/step
Epoch 3/50
878/878 - 36s - loss: 3.2360 - accuracy1000: 0.4152 - val_loss: 3.4806 - val_accuracy1000: 0.3447 - 36s/epoch - 41ms/step
Epoch 4/50
878/878 - 36s - loss: 3.2152 - accuracy1000: 0.4212 - val_loss: 3.4351 - val_accuracy1000: 0.3472 - 36s/epoch - 41ms/step
Epoch 5/50
878/878 - 36s - loss: 3.1900 - accuracy1000: 0.4348 - val_loss: 3.4757 - val_accuracy1000: 0.3432 - 36s/epoch - 41ms/step
Epoch 6/50
878/878 - 36s - loss: 3.1723 - accuracy1000: 0.4416 - val_loss: 3.4456 - val_accuracy1000: 0.3450 - 36s/epoch - 41ms/step
Epoch 7/50
878/878 - 36s - loss: 3.1618 - accuracy1000: 0.4447 - val_loss: 3.5568 - val_accuracy1000: 0.3438 - 36s/epoch - 41ms/step
Epoch 8/50
878/878 - 36s - loss: 3.1471 - accuracy1000: 0.4497 - val_loss: 3.4720 - val_accuracy1000: 0.3424 - 36s/epoch - 41ms/step
Epoch 9/50
878/878 - 36s - loss: 3.1244 - accuracy1000: 0.4571 - val_loss: 3.5115 - val_accuracy1000: 0.3440 - 36s/epoch - 41ms/step
Epoch 10/50
878/878 - 36s - loss: 3.1095 - accuracy1000: 0.4611 - val_loss: 3.5255 - val_accuracy1000: 0.3403 - 36s/epoch - 41ms/step
Epoch 11/50
878/878 - 36s - loss: 3.0959 - accuracy1000: 0.4665 - val_loss: 3.5041 - val_accuracy1000: 0.3440 - 36s/epoch - 41ms/step
Epoch 12/50
878/878 - 36s - loss: 3.0820 - accuracy1000: 0.4710 - val_loss: 3.5033 - val_accuracy1000: 0.3448 - 36s/epoch - 41ms/step
testing model: results/PCAR/W3/deepLOB_L2/h1000
Evaluating performance on  test set...
2282/2282 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1392671
{'0': {'precision': 0.36336404656277255, 'recall': 0.04632534576023745, 'f1-score': 0.08217427841328097, 'support': 206863}, '1': {'precision': 0.3723536902424789, 'recall': 0.143492462696867, 'f1-score': 0.20715458553954577, 'support': 195627}, '2': {'precision': 0.31350547659435046, 'recall': 0.8329412412881187, 'f1-score': 0.4555495458305147, 'support': 181505}, 'accuracy': 0.3233537958372931, 'macro avg': {'precision': 0.3497410711332007, 'recall': 0.34091968324840777, 'f1-score': 0.2482928032611138, 'support': 583995}, 'weighted avg': {'precision': 0.35087941447176396, 'recall': 0.3233537958372931, 'f1-score': 0.2400848777416225, 'support': 583995}}
[[  9583  24885 172395]
 [  8900  28071 158656]
 [  7890  22432 151183]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.12375
{'0': {'precision': 0.31527257594673325, 'recall': 0.051581627789806225, 'f1-score': 0.08865796002434115, 'support': 73437}, '1': {'precision': 0.34890222068662247, 'recall': 0.29938279923456323, 'f1-score': 0.3222512329561938, 'support': 74206}, '2': {'precision': 0.3527848967488293, 'recall': 0.6820233463035019, 'f1-score': 0.4650282550828197, 'support': 77100}, 'accuracy': 0.34967941159457694, 'macro avg': {'precision': 0.33898656446072833, 'recall': 0.34432925777595713, 'f1-score': 0.2919791493544515, 'support': 224743}, 'weighted avg': {'precision': 0.3392453864521097, 'recall': 0.34967941159457694, 'f1-score': 0.29490319195676956, 'support': 224743}}
[[ 3788 21082 48567]
 [ 4087 22216 47903]
 [ 4140 20376 52584]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1255956
{'0': {'precision': 0.33294163728946335, 'recall': 0.06596050129980988, 'f1-score': 0.11010719259043361, 'support': 25773}, '1': {'precision': 0.3279236441320378, 'recall': 0.3817029639433682, 'f1-score': 0.35277546103234175, 'support': 24933}, '2': {'precision': 0.3538934757973126, 'recall': 0.5739469637297926, 'f1-score': 0.4378254649499285, 'support': 26661}, 'accuracy': 0.3427688807889669, 'macro avg': {'precision': 0.3382529190729379, 'recall': 0.3405368096576569, 'f1-score': 0.30023603952423467, 'support': 77367}, 'weighted avg': {'precision': 0.33854458613152366, 'recall': 0.3427688807889669, 'f1-score': 0.3012448196980969, 'support': 77367}}
[[ 1700  9804 14269]
 [ 1748  9517 13668]
 [ 1658  9701 15302]]
training model: results/PCAR/W3/deepOF_L2/h10
Epoch 1/50
878/878 - 22s - loss: 3.1853 - accuracy10: 0.4250 - val_loss: 3.0919 - val_accuracy10: 0.4615 - 22s/epoch - 25ms/step
Epoch 2/50
878/878 - 20s - loss: 3.0702 - accuracy10: 0.4709 - val_loss: 3.0701 - val_accuracy10: 0.4717 - 20s/epoch - 23ms/step
Epoch 3/50
878/878 - 20s - loss: 3.0171 - accuracy10: 0.4900 - val_loss: 3.0604 - val_accuracy10: 0.4749 - 20s/epoch - 23ms/step
Epoch 4/50
878/878 - 20s - loss: 2.9893 - accuracy10: 0.4999 - val_loss: 3.0504 - val_accuracy10: 0.4803 - 20s/epoch - 23ms/step
Epoch 5/50
878/878 - 20s - loss: 2.9702 - accuracy10: 0.5045 - val_loss: 3.0250 - val_accuracy10: 0.4868 - 20s/epoch - 23ms/step
Epoch 6/50
878/878 - 20s - loss: 2.9565 - accuracy10: 0.5093 - val_loss: 3.0120 - val_accuracy10: 0.4906 - 20s/epoch - 23ms/step
Epoch 7/50
878/878 - 20s - loss: 2.9446 - accuracy10: 0.5118 - val_loss: 2.9991 - val_accuracy10: 0.4959 - 20s/epoch - 23ms/step
Epoch 8/50
878/878 - 20s - loss: 2.9341 - accuracy10: 0.5151 - val_loss: 3.0005 - val_accuracy10: 0.4951 - 20s/epoch - 22ms/step
Epoch 9/50
878/878 - 20s - loss: 2.9260 - accuracy10: 0.5175 - val_loss: 2.9985 - val_accuracy10: 0.4955 - 20s/epoch - 23ms/step
Epoch 10/50
878/878 - 20s - loss: 2.9172 - accuracy10: 0.5195 - val_loss: 2.9961 - val_accuracy10: 0.4955 - 20s/epoch - 22ms/step
Epoch 11/50
878/878 - 20s - loss: 2.9112 - accuracy10: 0.5211 - val_loss: 2.9941 - val_accuracy10: 0.4970 - 20s/epoch - 22ms/step
Epoch 12/50
878/878 - 20s - loss: 2.9047 - accuracy10: 0.5231 - val_loss: 2.9890 - val_accuracy10: 0.4980 - 20s/epoch - 23ms/step
Epoch 13/50
878/878 - 20s - loss: 2.9004 - accuracy10: 0.5238 - val_loss: 2.9941 - val_accuracy10: 0.4972 - 20s/epoch - 22ms/step
Epoch 14/50
878/878 - 20s - loss: 2.8943 - accuracy10: 0.5254 - val_loss: 2.9941 - val_accuracy10: 0.4975 - 20s/epoch - 22ms/step
Epoch 15/50
878/878 - 20s - loss: 2.8877 - accuracy10: 0.5269 - val_loss: 2.9929 - val_accuracy10: 0.4996 - 20s/epoch - 22ms/step
Epoch 16/50
878/878 - 20s - loss: 2.8829 - accuracy10: 0.5290 - val_loss: 2.9861 - val_accuracy10: 0.5010 - 20s/epoch - 23ms/step
Epoch 17/50
878/878 - 20s - loss: 2.8785 - accuracy10: 0.5293 - val_loss: 2.9891 - val_accuracy10: 0.5003 - 20s/epoch - 22ms/step
Epoch 18/50
878/878 - 20s - loss: 2.8743 - accuracy10: 0.5310 - val_loss: 2.9938 - val_accuracy10: 0.4999 - 20s/epoch - 22ms/step
Epoch 19/50
878/878 - 20s - loss: 2.8696 - accuracy10: 0.5315 - val_loss: 2.9870 - val_accuracy10: 0.5017 - 20s/epoch - 22ms/step
Epoch 20/50
878/878 - 20s - loss: 2.8643 - accuracy10: 0.5325 - val_loss: 2.9880 - val_accuracy10: 0.5013 - 20s/epoch - 22ms/step
Epoch 21/50
878/878 - 20s - loss: 2.8604 - accuracy10: 0.5341 - val_loss: 2.9858 - val_accuracy10: 0.5036 - 20s/epoch - 23ms/step
Epoch 22/50
878/878 - 20s - loss: 2.8549 - accuracy10: 0.5354 - val_loss: 2.9977 - val_accuracy10: 0.5013 - 20s/epoch - 23ms/step
Epoch 23/50
878/878 - 20s - loss: 2.8510 - accuracy10: 0.5378 - val_loss: 2.9908 - val_accuracy10: 0.5030 - 20s/epoch - 22ms/step
Epoch 24/50
878/878 - 20s - loss: 2.8458 - accuracy10: 0.5384 - val_loss: 3.0019 - val_accuracy10: 0.4999 - 20s/epoch - 22ms/step
Epoch 25/50
878/878 - 20s - loss: 2.8426 - accuracy10: 0.5387 - val_loss: 3.0036 - val_accuracy10: 0.5011 - 20s/epoch - 22ms/step
Epoch 26/50
878/878 - 20s - loss: 2.8393 - accuracy10: 0.5394 - val_loss: 2.9962 - val_accuracy10: 0.5020 - 20s/epoch - 23ms/step
Epoch 27/50
878/878 - 20s - loss: 2.8349 - accuracy10: 0.5405 - val_loss: 3.0001 - val_accuracy10: 0.5013 - 20s/epoch - 22ms/step
Epoch 28/50
878/878 - 20s - loss: 2.8308 - accuracy10: 0.5419 - val_loss: 2.9994 - val_accuracy10: 0.5018 - 20s/epoch - 23ms/step
Epoch 29/50
878/878 - 20s - loss: 2.8274 - accuracy10: 0.5433 - val_loss: 2.9984 - val_accuracy10: 0.5034 - 20s/epoch - 23ms/step
Epoch 30/50
878/878 - 20s - loss: 2.8242 - accuracy10: 0.5423 - val_loss: 3.0044 - val_accuracy10: 0.5028 - 20s/epoch - 23ms/step
Epoch 31/50
878/878 - 20s - loss: 2.8187 - accuracy10: 0.5448 - val_loss: 3.0043 - val_accuracy10: 0.5023 - 20s/epoch - 23ms/step
testing model: results/PCAR/W3/deepOF_L2/h10
Evaluating performance on  test set...
2282/2282 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99745136
{'0': {'precision': 0.49246511331535014, 'recall': 0.49431297303059374, 'f1-score': 0.4933873130040644, 'support': 187620}, '1': {'precision': 0.48606287005046717, 'recall': 0.5099647168417953, 'f1-score': 0.4977270050641856, 'support': 207181}, '2': {'precision': 0.5153170534722767, 'recall': 0.48564934721708336, 'f1-score': 0.5000435388366423, 'support': 189190}, 'accuracy': 0.49705903001929824, 'macro avg': {'precision': 0.4979483456126981, 'recall': 0.4966423456964908, 'f1-score': 0.4970526189682974, 'support': 583991}, 'weighted avg': {'precision': 0.4975969310940954, 'recall': 0.49705903001929824, 'f1-score': 0.4970832485680943, 'support': 583991}}
[[ 92743  56795  38082]
 [ 53190 105655  48336]
 [ 42391  54919  91880]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97870314
{'0': {'precision': 0.523818970158982, 'recall': 0.4970086446807653, 'f1-score': 0.5100617432996447, 'support': 74381}, '1': {'precision': 0.498362517976048, 'recall': 0.555048588118119, 'f1-score': 0.525180360019612, 'support': 74298}, '2': {'precision': 0.5300624492424879, 'recall': 0.4976992453524756, 'f1-score': 0.5133713045836724, 'support': 76062}, 'accuracy': 0.5164300238941715, 'macro avg': {'precision': 0.517414645792506, 'recall': 0.51658549271712, 'f1-score': 0.5162044693009764, 'support': 224741}, 'weighted avg': {'precision': 0.5175162840525839, 'recall': 0.5164300238941715, 'f1-score': 0.5161799630968595, 'support': 224741}}
[[36968 20279 17134]
 [16631 41239 16428]
 [16975 21231 37856]]
Evaluating performance on  val set...
303/303 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9953418
{'0': {'precision': 0.5084409955834399, 'recall': 0.49191326224991017, 'f1-score': 0.5000405943005602, 'support': 25041}, '1': {'precision': 0.48322542672160096, 'recall': 0.5489394896177705, 'f1-score': 0.5139905744048138, 'support': 26921}, '2': {'precision': 0.5214114726482845, 'recall': 0.4629797283999213, 'f1-score': 0.49046139732710636, 'support': 25405}, 'accuracy': 0.5022554836041206, 'macro avg': {'precision': 0.504359298317775, 'recall': 0.501277493422534, 'f1-score': 0.5014975220108268, 'support': 77367}, 'weighted avg': {'precision': 0.5039259780760118, 'recall': 0.5022554836041206, 'f1-score': 0.5017491769685712, 'support': 77367}}
[[12318  7807  4916]
 [ 6263 14778  5880]
 [ 5646  7997 11762]]
training model: results/PCAR/W3/deepOF_L2/h20
Epoch 1/50
878/878 - 22s - loss: 3.2430 - accuracy20: 0.4000 - val_loss: 3.1753 - val_accuracy20: 0.4301 - 22s/epoch - 25ms/step
Epoch 2/50
878/878 - 20s - loss: 3.1643 - accuracy20: 0.4363 - val_loss: 3.1478 - val_accuracy20: 0.4395 - 20s/epoch - 23ms/step
Epoch 3/50
878/878 - 20s - loss: 3.1263 - accuracy20: 0.4535 - val_loss: 3.1386 - val_accuracy20: 0.4453 - 20s/epoch - 23ms/step
Epoch 4/50
878/878 - 20s - loss: 3.1040 - accuracy20: 0.4621 - val_loss: 3.1328 - val_accuracy20: 0.4500 - 20s/epoch - 23ms/step
Epoch 5/50
878/878 - 20s - loss: 3.0886 - accuracy20: 0.4674 - val_loss: 3.1245 - val_accuracy20: 0.4519 - 20s/epoch - 23ms/step
Epoch 6/50
878/878 - 20s - loss: 3.0789 - accuracy20: 0.4703 - val_loss: 3.1098 - val_accuracy20: 0.4575 - 20s/epoch - 23ms/step
Epoch 7/50
878/878 - 20s - loss: 3.0687 - accuracy20: 0.4745 - val_loss: 3.1078 - val_accuracy20: 0.4585 - 20s/epoch - 23ms/step
Epoch 8/50
878/878 - 20s - loss: 3.0604 - accuracy20: 0.4766 - val_loss: 3.1051 - val_accuracy20: 0.4606 - 20s/epoch - 23ms/step
Epoch 9/50
878/878 - 20s - loss: 3.0529 - accuracy20: 0.4800 - val_loss: 3.1008 - val_accuracy20: 0.4605 - 20s/epoch - 23ms/step
Epoch 10/50
878/878 - 20s - loss: 3.0471 - accuracy20: 0.4810 - val_loss: 3.0988 - val_accuracy20: 0.4614 - 20s/epoch - 23ms/step
Epoch 11/50
878/878 - 20s - loss: 3.0412 - accuracy20: 0.4831 - val_loss: 3.0990 - val_accuracy20: 0.4605 - 20s/epoch - 23ms/step
Epoch 12/50
878/878 - 20s - loss: 3.0356 - accuracy20: 0.4858 - val_loss: 3.0958 - val_accuracy20: 0.4627 - 20s/epoch - 23ms/step
Epoch 13/50
878/878 - 20s - loss: 3.0291 - accuracy20: 0.4868 - val_loss: 3.0961 - val_accuracy20: 0.4602 - 20s/epoch - 22ms/step
Epoch 14/50
878/878 - 20s - loss: 3.0258 - accuracy20: 0.4872 - val_loss: 3.0935 - val_accuracy20: 0.4618 - 20s/epoch - 22ms/step
Epoch 15/50
878/878 - 20s - loss: 3.0201 - accuracy20: 0.4904 - val_loss: 3.0944 - val_accuracy20: 0.4614 - 20s/epoch - 23ms/step
Epoch 16/50
878/878 - 20s - loss: 3.0162 - accuracy20: 0.4907 - val_loss: 3.0952 - val_accuracy20: 0.4624 - 20s/epoch - 22ms/step
Epoch 17/50
878/878 - 20s - loss: 3.0129 - accuracy20: 0.4921 - val_loss: 3.0973 - val_accuracy20: 0.4612 - 20s/epoch - 22ms/step
Epoch 18/50
878/878 - 20s - loss: 3.0076 - accuracy20: 0.4944 - val_loss: 3.0982 - val_accuracy20: 0.4612 - 20s/epoch - 22ms/step
Epoch 19/50
878/878 - 20s - loss: 3.0029 - accuracy20: 0.4954 - val_loss: 3.1001 - val_accuracy20: 0.4609 - 20s/epoch - 22ms/step
Epoch 20/50
878/878 - 20s - loss: 2.9995 - accuracy20: 0.4960 - val_loss: 3.1008 - val_accuracy20: 0.4599 - 20s/epoch - 22ms/step
Epoch 21/50
878/878 - 20s - loss: 2.9954 - accuracy20: 0.4978 - val_loss: 3.0989 - val_accuracy20: 0.4623 - 20s/epoch - 22ms/step
Epoch 22/50
878/878 - 20s - loss: 2.9921 - accuracy20: 0.4979 - val_loss: 3.1070 - val_accuracy20: 0.4609 - 20s/epoch - 22ms/step
Epoch 23/50
878/878 - 20s - loss: 2.9858 - accuracy20: 0.4995 - val_loss: 3.1006 - val_accuracy20: 0.4628 - 20s/epoch - 22ms/step
Epoch 24/50
878/878 - 20s - loss: 2.9811 - accuracy20: 0.5008 - val_loss: 3.1100 - val_accuracy20: 0.4606 - 20s/epoch - 22ms/step
testing model: results/PCAR/W3/deepOF_L2/h20
Evaluating performance on  test set...
2282/2282 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0306023
{'0': {'precision': 0.4506299915130677, 'recall': 0.5429958936653363, 'f1-score': 0.49251984797096415, 'support': 190681}, '1': {'precision': 0.45590574666931794, 'recall': 0.3688928889268781, 'f1-score': 0.40780956880619207, 'support': 198887}, '2': {'precision': 0.48028950118469926, 'recall': 0.477510376858705, 'f1-score': 0.47889590710846197, 'support': 194423}, 'accuracy': 0.46190095395305747, 'macro avg': {'precision': 0.46227507978902826, 'recall': 0.46313305315030645, 'f1-score': 0.45974177462853943, 'support': 583991}, 'weighted avg': {'precision': 0.46230101035522236, 'recall': 0.46190095395305747, 'f1-score': 0.4591347774021467, 'support': 583991}}
[[103539  43861  43281]
 [ 68341  73368  57178]
 [ 57885  43699  92839]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0207857
{'0': {'precision': 0.46825227024200067, 'recall': 0.5297091608288177, 'f1-score': 0.4970883831851763, 'support': 74371}, '1': {'precision': 0.470270188633652, 'recall': 0.41961000983734686, 'f1-score': 0.4434980771969805, 'support': 74207}, '2': {'precision': 0.49200225818592397, 'recall': 0.4805876869346008, 'f1-score': 0.4862279903559402, 'support': 76163}, 'accuracy': 0.47670874473282576, 'macro avg': {'precision': 0.4768415723538589, 'recall': 0.47663561920025516, 'f1-score': 0.47560481691269896, 'support': 224741}, 'weighted avg': {'precision': 0.4769672532751914, 'recall': 0.47670874473282576, 'f1-score': 0.4757129513079525, 'support': 224741}}
[[39395 17206 17770]
 [23046 31138 20023]
 [21691 17869 36603]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0318983
{'0': {'precision': 0.4619744922059518, 'recall': 0.5035247524752475, 'f1-score': 0.4818555646093498, 'support': 25250}, '1': {'precision': 0.4471760009485791, 'recall': 0.4272335926289555, 'f1-score': 0.4369773864009424, 'support': 26482}, '2': {'precision': 0.4772458749236097, 'recall': 0.45695338404525065, 'f1-score': 0.4668792347548824, 'support': 25635}, 'accuracy': 0.4619799139167862, 'macro avg': {'precision': 0.46213212269271353, 'recall': 0.4625705763831512, 'f1-score': 0.4619040619217249, 'support': 77367}, 'weighted avg': {'precision': 0.46196917017575057, 'recall': 0.4619799139167862, 'f1-score': 0.4615318848604347, 'support': 77367}}
[[12714  6937  5599]
 [ 7936 11314  7232]
 [ 6871  7050 11714]]
training model: results/PCAR/W3/deepOF_L2/h30
Epoch 1/50
878/878 - 22s - loss: 3.2668 - accuracy30: 0.3857 - val_loss: 3.2168 - val_accuracy30: 0.4108 - 22s/epoch - 25ms/step
Epoch 2/50
878/878 - 20s - loss: 3.2073 - accuracy30: 0.4173 - val_loss: 3.1986 - val_accuracy30: 0.4175 - 20s/epoch - 22ms/step
Epoch 3/50
878/878 - 20s - loss: 3.1797 - accuracy30: 0.4298 - val_loss: 3.1929 - val_accuracy30: 0.4153 - 20s/epoch - 23ms/step
Epoch 4/50
878/878 - 20s - loss: 3.1630 - accuracy30: 0.4390 - val_loss: 3.1903 - val_accuracy30: 0.4160 - 20s/epoch - 23ms/step
Epoch 5/50
878/878 - 20s - loss: 3.1519 - accuracy30: 0.4434 - val_loss: 3.1837 - val_accuracy30: 0.4191 - 20s/epoch - 22ms/step
Epoch 6/50
878/878 - 20s - loss: 3.1448 - accuracy30: 0.4465 - val_loss: 3.1756 - val_accuracy30: 0.4245 - 20s/epoch - 22ms/step
Epoch 7/50
878/878 - 20s - loss: 3.1356 - accuracy30: 0.4505 - val_loss: 3.1737 - val_accuracy30: 0.4257 - 20s/epoch - 22ms/step
Epoch 8/50
878/878 - 20s - loss: 3.1291 - accuracy30: 0.4525 - val_loss: 3.1671 - val_accuracy30: 0.4300 - 20s/epoch - 22ms/step
Epoch 9/50
878/878 - 20s - loss: 3.1238 - accuracy30: 0.4548 - val_loss: 3.1654 - val_accuracy30: 0.4305 - 20s/epoch - 22ms/step
Epoch 10/50
878/878 - 20s - loss: 3.1172 - accuracy30: 0.4567 - val_loss: 3.1657 - val_accuracy30: 0.4307 - 20s/epoch - 23ms/step
Epoch 11/50
878/878 - 20s - loss: 3.1129 - accuracy30: 0.4584 - val_loss: 3.1625 - val_accuracy30: 0.4310 - 20s/epoch - 23ms/step
Epoch 12/50
878/878 - 20s - loss: 3.1078 - accuracy30: 0.4604 - val_loss: 3.1566 - val_accuracy30: 0.4345 - 20s/epoch - 23ms/step
Epoch 13/50
878/878 - 20s - loss: 3.1019 - accuracy30: 0.4626 - val_loss: 3.1575 - val_accuracy30: 0.4339 - 20s/epoch - 22ms/step
Epoch 14/50
878/878 - 20s - loss: 3.0977 - accuracy30: 0.4631 - val_loss: 3.1577 - val_accuracy30: 0.4336 - 20s/epoch - 22ms/step
Epoch 15/50
878/878 - 20s - loss: 3.0924 - accuracy30: 0.4654 - val_loss: 3.1577 - val_accuracy30: 0.4343 - 20s/epoch - 23ms/step
Epoch 16/50
878/878 - 20s - loss: 3.0893 - accuracy30: 0.4670 - val_loss: 3.1544 - val_accuracy30: 0.4375 - 20s/epoch - 23ms/step
Epoch 17/50
878/878 - 20s - loss: 3.0845 - accuracy30: 0.4696 - val_loss: 3.1554 - val_accuracy30: 0.4368 - 20s/epoch - 23ms/step
Epoch 18/50
878/878 - 20s - loss: 3.0808 - accuracy30: 0.4700 - val_loss: 3.1572 - val_accuracy30: 0.4366 - 20s/epoch - 22ms/step
Epoch 19/50
878/878 - 20s - loss: 3.0768 - accuracy30: 0.4712 - val_loss: 3.1555 - val_accuracy30: 0.4372 - 20s/epoch - 22ms/step
Epoch 20/50
878/878 - 20s - loss: 3.0720 - accuracy30: 0.4728 - val_loss: 3.1596 - val_accuracy30: 0.4370 - 20s/epoch - 23ms/step
Epoch 21/50
878/878 - 20s - loss: 3.0693 - accuracy30: 0.4737 - val_loss: 3.1600 - val_accuracy30: 0.4394 - 20s/epoch - 22ms/step
Epoch 22/50
878/878 - 19s - loss: 3.0648 - accuracy30: 0.4756 - val_loss: 3.1615 - val_accuracy30: 0.4389 - 19s/epoch - 22ms/step
Epoch 23/50
878/878 - 20s - loss: 3.0594 - accuracy30: 0.4773 - val_loss: 3.1621 - val_accuracy30: 0.4396 - 20s/epoch - 22ms/step
Epoch 24/50
878/878 - 20s - loss: 3.0552 - accuracy30: 0.4785 - val_loss: 3.1631 - val_accuracy30: 0.4387 - 20s/epoch - 22ms/step
Epoch 25/50
878/878 - 20s - loss: 3.0495 - accuracy30: 0.4807 - val_loss: 3.1763 - val_accuracy30: 0.4355 - 20s/epoch - 22ms/step
Epoch 26/50
878/878 - 20s - loss: 3.0456 - accuracy30: 0.4815 - val_loss: 3.1758 - val_accuracy30: 0.4344 - 20s/epoch - 22ms/step
testing model: results/PCAR/W3/deepOF_L2/h30
Evaluating performance on  test set...
2282/2282 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0503477
{'0': {'precision': 0.4552619309037857, 'recall': 0.4662388006058583, 'f1-score': 0.46068498779887684, 'support': 194765}, '1': {'precision': 0.3971775876460768, 'recall': 0.3995245442236846, 'f1-score': 0.39834760905623257, 'support': 190554}, '2': {'precision': 0.46653357531760437, 'recall': 0.45286200370459856, 'f1-score': 0.4595961401913558, 'support': 198672}, 'accuracy': 0.4399194508134543, 'macro avg': {'precision': 0.43965769795582227, 'recall': 0.43954178284471385, 'f1-score': 0.4395429123488217, 'support': 583991}, 'weighted avg': {'precision': 0.44014381468941377, 'recall': 0.4399194508134543, 'f1-score': 0.43997411999302494, 'support': 583991}}
[[90807 57764 46194]
 [57738 76131 56685]
 [50916 57785 89971]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0405288
{'0': {'precision': 0.4690199626430072, 'recall': 0.4325259049925986, 'f1-score': 0.4500343045968159, 'support': 74310}, '1': {'precision': 0.4204463382926477, 'recall': 0.4696083571975961, 'f1-score': 0.4436696198913975, 'support': 74379}, '2': {'precision': 0.4767354417052928, 'recall': 0.4584626308315363, 'f1-score': 0.46742052027964526, 'support': 76052}, 'accuracy': 0.45357544907248787, 'macro avg': {'precision': 0.4554005808803159, 'recall': 0.4535322976739103, 'f1-score': 0.4537081482559529, 'support': 224741}, 'weighted avg': {'precision': 0.4555552188182915, 'recall': 0.45357544907248787, 'f1-score': 0.4538113528052257, 'support': 224741}}
[[32141 24374 17795]
 [18975 34929 20475]
 [17412 23773 34867]]
Evaluating performance on  val set...
303/303 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0523742
{'0': {'precision': 0.45847650497567943, 'recall': 0.4065047083959801, 'f1-score': 0.4309292620011325, 'support': 25274}, '1': {'precision': 0.4036761880363776, 'recall': 0.4766874645490641, 'f1-score': 0.43715430097272556, 'support': 26445}, '2': {'precision': 0.4592077538980194, 'recall': 0.4248674360573924, 'f1-score': 0.4413706508971607, 'support': 25648}, 'accuracy': 0.4365814882314165, 'macro avg': {'precision': 0.4404534823033588, 'recall': 0.43601986966747885, 'f1-score': 0.43648473795700626, 'support': 77367}, 'weighted avg': {'precision': 0.43998749403949655, 'recall': 0.4365814882314165, 'f1-score': 0.4365184912333518, 'support': 77367}}
[[10274  9369  5631]
 [ 6637 12606  7202]
 [ 5498  9253 10897]]
training model: results/PCAR/W3/deepOF_L2/h50
Epoch 1/50
878/878 - 23s - loss: 3.2875 - accuracy50: 0.3764 - val_loss: 3.2595 - val_accuracy50: 0.3778 - 23s/epoch - 26ms/step
Epoch 2/50
878/878 - 20s - loss: 3.2417 - accuracy50: 0.3974 - val_loss: 3.2474 - val_accuracy50: 0.3845 - 20s/epoch - 23ms/step
Epoch 3/50
878/878 - 20s - loss: 3.2226 - accuracy50: 0.4081 - val_loss: 3.2438 - val_accuracy50: 0.3825 - 20s/epoch - 23ms/step
Epoch 4/50
878/878 - 20s - loss: 3.2076 - accuracy50: 0.4174 - val_loss: 3.2443 - val_accuracy50: 0.3827 - 20s/epoch - 23ms/step
Epoch 5/50
878/878 - 20s - loss: 3.1986 - accuracy50: 0.4213 - val_loss: 3.2462 - val_accuracy50: 0.3840 - 20s/epoch - 22ms/step
Epoch 6/50
878/878 - 20s - loss: 3.1939 - accuracy50: 0.4249 - val_loss: 3.2445 - val_accuracy50: 0.3841 - 20s/epoch - 22ms/step
Epoch 7/50
878/878 - 20s - loss: 3.1878 - accuracy50: 0.4283 - val_loss: 3.2419 - val_accuracy50: 0.3903 - 20s/epoch - 22ms/step
Epoch 8/50
878/878 - 20s - loss: 3.1823 - accuracy50: 0.4308 - val_loss: 3.2475 - val_accuracy50: 0.3872 - 20s/epoch - 22ms/step
Epoch 9/50
878/878 - 20s - loss: 3.1787 - accuracy50: 0.4323 - val_loss: 3.2454 - val_accuracy50: 0.3894 - 20s/epoch - 23ms/step
Epoch 10/50
878/878 - 20s - loss: 3.1748 - accuracy50: 0.4339 - val_loss: 3.2414 - val_accuracy50: 0.3939 - 20s/epoch - 23ms/step
Epoch 11/50
878/878 - 20s - loss: 3.1721 - accuracy50: 0.4352 - val_loss: 3.2458 - val_accuracy50: 0.3914 - 20s/epoch - 22ms/step
Epoch 12/50
878/878 - 20s - loss: 3.1675 - accuracy50: 0.4367 - val_loss: 3.2506 - val_accuracy50: 0.3924 - 20s/epoch - 22ms/step
Epoch 13/50
878/878 - 19s - loss: 3.1653 - accuracy50: 0.4397 - val_loss: 3.2479 - val_accuracy50: 0.3941 - 19s/epoch - 22ms/step
Epoch 14/50
878/878 - 20s - loss: 3.1613 - accuracy50: 0.4406 - val_loss: 3.2514 - val_accuracy50: 0.3952 - 20s/epoch - 22ms/step
Epoch 15/50
878/878 - 20s - loss: 3.1581 - accuracy50: 0.4418 - val_loss: 3.2519 - val_accuracy50: 0.3945 - 20s/epoch - 22ms/step
Epoch 16/50
878/878 - 20s - loss: 3.1543 - accuracy50: 0.4432 - val_loss: 3.2533 - val_accuracy50: 0.3958 - 20s/epoch - 23ms/step
Epoch 17/50
878/878 - 20s - loss: 3.1510 - accuracy50: 0.4447 - val_loss: 3.2520 - val_accuracy50: 0.3947 - 20s/epoch - 22ms/step
Epoch 18/50
878/878 - 20s - loss: 3.1472 - accuracy50: 0.4462 - val_loss: 3.2608 - val_accuracy50: 0.3921 - 20s/epoch - 22ms/step
Epoch 19/50
878/878 - 20s - loss: 3.1421 - accuracy50: 0.4495 - val_loss: 3.2629 - val_accuracy50: 0.3952 - 20s/epoch - 22ms/step
Epoch 20/50
878/878 - 20s - loss: 3.1381 - accuracy50: 0.4505 - val_loss: 3.2690 - val_accuracy50: 0.3935 - 20s/epoch - 22ms/step
testing model: results/PCAR/W3/deepOF_L2/h50
Evaluating performance on  test set...
2282/2282 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0937977
{'0': {'precision': 0.46004741117631753, 'recall': 0.2999180165663076, 'f1-score': 0.36311258920371253, 'support': 212238}, '1': {'precision': 0.2928261542208968, 'recall': 0.565284802887426, 'f1-score': 0.38580133139623135, 'support': 157372}, '2': {'precision': 0.46647723667233076, 'recall': 0.30860943833641974, 'f1-score': 0.3714662698969709, 'support': 214381}, 'accuracy': 0.37461878693336026, 'macro avg': {'precision': 0.40645026735651496, 'recall': 0.3912707525967178, 'f1-score': 0.3734600634989716, 'support': 583991}, 'weighted avg': {'precision': 0.4173455352399971, 'recall': 0.37461878693336026, 'f1-score': 0.37229328403808926, 'support': 583991}}
[[ 63654 107983  40601]
 [ 33344  88960  35068]
 [ 41366 106855  66160]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0744432
{'0': {'precision': 0.4408517865307989, 'recall': 0.271309311643239, 'f1-score': 0.3358992650596413, 'support': 74627}, '1': {'precision': 0.3697750656783992, 'recall': 0.657684953273545, 'f1-score': 0.47339164990670957, 'support': 74262}, '2': {'precision': 0.4609359953778006, 'recall': 0.28397405473817433, 'f1-score': 0.3514353540050415, 'support': 75852}, 'accuracy': 0.403255302770745, 'macro avg': {'precision': 0.42385428252899954, 'recall': 0.40432277321831944, 'f1-score': 0.38690875632379745, 'support': 224741}, 'weighted avg': {'precision': 0.4241442341283528, 'recall': 0.403255302770745, 'f1-score': 0.3865749446294549, 'support': 224741}}
[[20247 42274 12106]
 [12336 48841 13085]
 [13344 40968 21540]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.081009
{'0': {'precision': 0.43303377301058127, 'recall': 0.23458050331749833, 'f1-score': 0.3043112888028725, 'support': 25471}, '1': {'precision': 0.36724120346761857, 'recall': 0.6850576462082874, 'f1-score': 0.4781557910392266, 'support': 26281}, '2': {'precision': 0.44733223322332233, 'recall': 0.2539918016787039, 'f1-score': 0.3240120520929306, 'support': 25615}, 'accuracy': 0.3940310468287513, 'macro avg': {'precision': 0.41586906990050737, 'recall': 0.3912099837348299, 'f1-score': 0.3688263773116766, 'support': 77367}, 'weighted avg': {'precision': 0.4154185176457715, 'recall': 0.3940310468287513, 'f1-score': 0.3698875993092701, 'support': 77367}}
[[ 5975 15702  3794]
 [ 4033 18004  4244]
 [ 3790 15319  6506]]
training model: results/PCAR/W3/deepOF_L2/h100
Epoch 1/50
878/878 - 22s - loss: 3.3113 - accuracy100: 0.3573 - val_loss: 3.2928 - val_accuracy100: 0.3579 - 22s/epoch - 25ms/step
Epoch 2/50
878/878 - 20s - loss: 3.2737 - accuracy100: 0.3781 - val_loss: 3.2849 - val_accuracy100: 0.3571 - 20s/epoch - 23ms/step
Epoch 3/50
878/878 - 20s - loss: 3.2592 - accuracy100: 0.3877 - val_loss: 3.2863 - val_accuracy100: 0.3608 - 20s/epoch - 22ms/step
Epoch 4/50
878/878 - 20s - loss: 3.2484 - accuracy100: 0.3949 - val_loss: 3.2874 - val_accuracy100: 0.3600 - 20s/epoch - 22ms/step
Epoch 5/50
878/878 - 20s - loss: 3.2420 - accuracy100: 0.3978 - val_loss: 3.2874 - val_accuracy100: 0.3603 - 20s/epoch - 23ms/step
Epoch 6/50
878/878 - 20s - loss: 3.2375 - accuracy100: 0.4011 - val_loss: 3.2856 - val_accuracy100: 0.3620 - 20s/epoch - 23ms/step
Epoch 7/50
878/878 - 20s - loss: 3.2324 - accuracy100: 0.4041 - val_loss: 3.2851 - val_accuracy100: 0.3629 - 20s/epoch - 22ms/step
Epoch 8/50
878/878 - 20s - loss: 3.2299 - accuracy100: 0.4048 - val_loss: 3.2824 - val_accuracy100: 0.3652 - 20s/epoch - 22ms/step
Epoch 9/50
878/878 - 20s - loss: 3.2262 - accuracy100: 0.4055 - val_loss: 3.2830 - val_accuracy100: 0.3669 - 20s/epoch - 22ms/step
Epoch 10/50
878/878 - 20s - loss: 3.2228 - accuracy100: 0.4086 - val_loss: 3.2811 - val_accuracy100: 0.3694 - 20s/epoch - 22ms/step
Epoch 11/50
878/878 - 20s - loss: 3.2207 - accuracy100: 0.4095 - val_loss: 3.2795 - val_accuracy100: 0.3699 - 20s/epoch - 23ms/step
Epoch 12/50
878/878 - 20s - loss: 3.2182 - accuracy100: 0.4109 - val_loss: 3.2805 - val_accuracy100: 0.3708 - 20s/epoch - 23ms/step
Epoch 13/50
878/878 - 20s - loss: 3.2153 - accuracy100: 0.4121 - val_loss: 3.2793 - val_accuracy100: 0.3729 - 20s/epoch - 22ms/step
Epoch 14/50
878/878 - 20s - loss: 3.2129 - accuracy100: 0.4127 - val_loss: 3.2785 - val_accuracy100: 0.3738 - 20s/epoch - 22ms/step
Epoch 15/50
878/878 - 20s - loss: 3.2105 - accuracy100: 0.4139 - val_loss: 3.2838 - val_accuracy100: 0.3734 - 20s/epoch - 22ms/step
Epoch 16/50
878/878 - 20s - loss: 3.2074 - accuracy100: 0.4149 - val_loss: 3.2822 - val_accuracy100: 0.3746 - 20s/epoch - 22ms/step
Epoch 17/50
878/878 - 20s - loss: 3.2054 - accuracy100: 0.4173 - val_loss: 3.2865 - val_accuracy100: 0.3730 - 20s/epoch - 23ms/step
Epoch 18/50
878/878 - 20s - loss: 3.2022 - accuracy100: 0.4180 - val_loss: 3.2849 - val_accuracy100: 0.3743 - 20s/epoch - 22ms/step
Epoch 19/50
878/878 - 20s - loss: 3.1999 - accuracy100: 0.4199 - val_loss: 3.2871 - val_accuracy100: 0.3743 - 20s/epoch - 22ms/step
Epoch 20/50
878/878 - 20s - loss: 3.1962 - accuracy100: 0.4219 - val_loss: 3.2886 - val_accuracy100: 0.3736 - 20s/epoch - 22ms/step
Epoch 21/50
878/878 - 20s - loss: 3.1925 - accuracy100: 0.4239 - val_loss: 3.2947 - val_accuracy100: 0.3742 - 20s/epoch - 22ms/step
Epoch 22/50
878/878 - 20s - loss: 3.1898 - accuracy100: 0.4251 - val_loss: 3.2957 - val_accuracy100: 0.3739 - 20s/epoch - 22ms/step
Epoch 23/50
878/878 - 20s - loss: 3.1860 - accuracy100: 0.4261 - val_loss: 3.2995 - val_accuracy100: 0.3742 - 20s/epoch - 22ms/step
Epoch 24/50
878/878 - 20s - loss: 3.1810 - accuracy100: 0.4282 - val_loss: 3.3074 - val_accuracy100: 0.3738 - 20s/epoch - 22ms/step
testing model: results/PCAR/W3/deepOF_L2/h100
Evaluating performance on  test set...
2282/2282 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0988786
{'0': {'precision': 0.4238865073720228, 'recall': 0.11088928672003862, 'f1-score': 0.17579132403528422, 'support': 198856}, '1': {'precision': 0.33464349257008696, 'recall': 0.6784405180565443, 'f1-score': 0.44820706295240187, 'support': 188242}, '2': {'precision': 0.39232524262157686, 'recall': 0.29955864352719497, 'f1-score': 0.33972295020591536, 'support': 196893}, 'accuracy': 0.3574421523619371, 'macro avg': {'precision': 0.38361841418789555, 'recall': 0.3629628161012593, 'f1-score': 0.3212404457312005, 'support': 583991}, 'weighted avg': {'precision': 0.3844792636082396, 'recall': 0.3574421523619371, 'f1-score': 0.31887070915740107, 'support': 583991}}
[[ 22051 130754  46051]
 [ 15226 127711  45305]
 [ 14744 123168  58981]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0880208
{'0': {'precision': 0.44038864136561273, 'recall': 0.10973929560320496, 'f1-score': 0.17569709170343084, 'support': 74759}, '1': {'precision': 0.355946072070114, 'recall': 0.7471653046710411, 'f1-score': 0.4821825991322947, 'support': 74523}, '2': {'precision': 0.4241661802298666, 'recall': 0.27926423620774193, 'f1-score': 0.33679079431037234, 'support': 75459}, 'accuracy': 0.37802626134083234, 'macro avg': {'precision': 0.4068336312218644, 'recall': 0.378722945493996, 'f1-score': 0.33155682838203265, 'support': 224741}, 'weighted avg': {'precision': 0.40694105375831935, 'recall': 0.37802626134083234, 'f1-score': 0.3314149588266457, 'support': 224741}}
[[ 8204 51689 14866]
 [ 5100 55681 13742]
 [ 5325 49061 21073]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0932075
{'0': {'precision': 0.4141228392791467, 'recall': 0.08963897623691439, 'f1-score': 0.14737737639475149, 'support': 25123}, '1': {'precision': 0.3632306692200924, 'recall': 0.7703256576496013, 'f1-score': 0.4936779893737688, 'support': 26838}, '2': {'precision': 0.4044764188649081, 'recall': 0.2389986617334488, 'f1-score': 0.3004601910040081, 'support': 25406}, 'accuracy': 0.3748109659157005, 'macro avg': {'precision': 0.3939433091213824, 'recall': 0.3663210985399881, 'f1-score': 0.31383851892417614, 'support': 77367}, 'weighted avg': {'precision': 0.3933010287256931, 'recall': 0.3748109659157005, 'f1-score': 0.31777609728471284, 'support': 77367}}
[[ 2252 18412  4459]
 [ 1683 20674  4481]
 [ 1503 17831  6072]]
training model: results/PCAR/W3/deepOF_L2/h200
Epoch 1/50
878/878 - 22s - loss: 3.3164 - accuracy200: 0.3563 - val_loss: 3.3713 - val_accuracy200: 0.3309 - 22s/epoch - 25ms/step
Epoch 2/50
878/878 - 20s - loss: 3.2785 - accuracy200: 0.3730 - val_loss: 3.3846 - val_accuracy200: 0.3288 - 20s/epoch - 23ms/step
Epoch 3/50
878/878 - 20s - loss: 3.2583 - accuracy200: 0.3857 - val_loss: 3.4269 - val_accuracy200: 0.3297 - 20s/epoch - 22ms/step
Epoch 4/50
878/878 - 20s - loss: 3.2461 - accuracy200: 0.3943 - val_loss: 3.4483 - val_accuracy200: 0.3278 - 20s/epoch - 22ms/step
Epoch 5/50
878/878 - 20s - loss: 3.2397 - accuracy200: 0.3964 - val_loss: 3.4423 - val_accuracy200: 0.3284 - 20s/epoch - 22ms/step
Epoch 6/50
878/878 - 20s - loss: 3.2347 - accuracy200: 0.4003 - val_loss: 3.4497 - val_accuracy200: 0.3270 - 20s/epoch - 22ms/step
Epoch 7/50
878/878 - 20s - loss: 3.2318 - accuracy200: 0.4004 - val_loss: 3.4444 - val_accuracy200: 0.3281 - 20s/epoch - 22ms/step
Epoch 8/50
878/878 - 20s - loss: 3.2291 - accuracy200: 0.4034 - val_loss: 3.4459 - val_accuracy200: 0.3277 - 20s/epoch - 22ms/step
Epoch 9/50
878/878 - 20s - loss: 3.2261 - accuracy200: 0.4036 - val_loss: 3.4440 - val_accuracy200: 0.3277 - 20s/epoch - 22ms/step
Epoch 10/50
878/878 - 20s - loss: 3.2237 - accuracy200: 0.4060 - val_loss: 3.4500 - val_accuracy200: 0.3271 - 20s/epoch - 22ms/step
Epoch 11/50
878/878 - 20s - loss: 3.2218 - accuracy200: 0.4065 - val_loss: 3.4490 - val_accuracy200: 0.3278 - 20s/epoch - 22ms/step
testing model: results/PCAR/W3/deepOF_L2/h200
Evaluating performance on  test set...
2282/2282 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.143969
{'0': {'precision': 0.37184767277856134, 'recall': 0.031012530172636887, 'f1-score': 0.05725031704393447, 'support': 212527}, '1': {'precision': 0.28474262383118526, 'recall': 0.8745224783826722, 'f1-score': 0.4296063508139587, 'support': 164914}, '2': {'precision': 0.37149071440522, 'recall': 0.10749939481965626, 'f1-score': 0.16674677080204264, 'support': 206550}, 'accuracy': 0.29626483969787204, 'macro avg': {'precision': 0.34269367033832215, 'recall': 0.3376781344583218, 'f1-score': 0.21786781288664528, 'support': 583991}, 'weighted avg': {'precision': 0.3471237099193371, 'recall': 0.29626483969787204, 'f1-score': 0.20112790330277583, 'support': 583991}}
[[  6591 184221  21715]
 [  4842 144221  15851]
 [  6292 178054  22204]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1191581
{'0': {'precision': 0.36517930468108406, 'recall': 0.035657484997928444, 'f1-score': 0.0649709603185233, 'support': 74823}, '1': {'precision': 0.33655324276039716, 'recall': 0.8767961033689623, 'f1-score': 0.4864033145439125, 'support': 73910}, '2': {'precision': 0.36639472732387574, 'recall': 0.11994790022102937, 'f1-score': 0.18072969838736855, 'support': 76008}, 'accuracy': 0.34078784022497005, 'macro avg': {'precision': 0.35604242492178567, 'recall': 0.34413382952930666, 'f1-score': 0.2440346577499348, 'support': 224741}, 'weighted avg': {'precision': 0.35617618378937027, 'recall': 0.34078784022497005, 'f1-score': 0.24271625585398549, 'support': 224741}}
[[ 2668 63311  8844]
 [ 2184 64804  6922]
 [ 2454 64437  9117]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1261266
{'0': {'precision': 0.374805598755832, 'recall': 0.036793893129770994, 'f1-score': 0.0670095926595301, 'support': 26200}, '1': {'precision': 0.3270946876684434, 'recall': 0.8743646187712627, 'f1-score': 0.4760877382236605, 'support': 24985}, '2': {'precision': 0.3530660671912077, 'recall': 0.10797494461844015, 'f1-score': 0.16537482816110446, 'support': 26182}, 'accuracy': 0.3313686713973658, 'macro avg': {'precision': 0.351655451205161, 'recall': 0.33971115217315795, 'f1-score': 0.23615738634809835, 'support': 77367}, 'weighted avg': {'precision': 0.35204083433504024, 'recall': 0.3313686713973658, 'f1-score': 0.23240589939007436, 'support': 77367}}
[[  964 22427  2809]
 [  768 21846  2371]
 [  840 22515  2827]]
training model: results/PCAR/W3/deepOF_L2/h300
Epoch 1/50
878/878 - 22s - loss: 3.3187 - accuracy300: 0.3544 - val_loss: 3.3434 - val_accuracy300: 0.3418 - 22s/epoch - 25ms/step
Epoch 2/50
878/878 - 20s - loss: 3.2800 - accuracy300: 0.3731 - val_loss: 3.3693 - val_accuracy300: 0.3403 - 20s/epoch - 22ms/step
Epoch 3/50
878/878 - 20s - loss: 3.2611 - accuracy300: 0.3846 - val_loss: 3.3899 - val_accuracy300: 0.3388 - 20s/epoch - 22ms/step
Epoch 4/50
878/878 - 20s - loss: 3.2523 - accuracy300: 0.3889 - val_loss: 3.3992 - val_accuracy300: 0.3378 - 20s/epoch - 22ms/step
Epoch 5/50
878/878 - 20s - loss: 3.2464 - accuracy300: 0.3929 - val_loss: 3.4006 - val_accuracy300: 0.3385 - 20s/epoch - 22ms/step
Epoch 6/50
878/878 - 20s - loss: 3.2429 - accuracy300: 0.3951 - val_loss: 3.4022 - val_accuracy300: 0.3382 - 20s/epoch - 22ms/step
Epoch 7/50
878/878 - 20s - loss: 3.2400 - accuracy300: 0.3966 - val_loss: 3.4027 - val_accuracy300: 0.3387 - 20s/epoch - 23ms/step
Epoch 8/50
878/878 - 20s - loss: 3.2373 - accuracy300: 0.3977 - val_loss: 3.4002 - val_accuracy300: 0.3390 - 20s/epoch - 23ms/step
Epoch 9/50
878/878 - 20s - loss: 3.2355 - accuracy300: 0.3999 - val_loss: 3.3997 - val_accuracy300: 0.3391 - 20s/epoch - 22ms/step
Epoch 10/50
878/878 - 20s - loss: 3.2328 - accuracy300: 0.4004 - val_loss: 3.3960 - val_accuracy300: 0.3400 - 20s/epoch - 22ms/step
Epoch 11/50
878/878 - 20s - loss: 3.2317 - accuracy300: 0.4018 - val_loss: 3.3910 - val_accuracy300: 0.3416 - 20s/epoch - 22ms/step
testing model: results/PCAR/W3/deepOF_L2/h300
Evaluating performance on  test set...
2282/2282 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1125757
{'0': {'precision': 0.34019612876726396, 'recall': 0.03409207845397106, 'f1-score': 0.06197359621760906, 'support': 194356}, '1': {'precision': 0.3503889351295252, 'recall': 0.8424407429551193, 'f1-score': 0.4949271807317051, 'support': 202381}, '2': {'precision': 0.3466360404984024, 'recall': 0.14425860061734327, 'f1-score': 0.20373100839797423, 'support': 187254}, 'accuracy': 0.34954819509204765, 'macro avg': {'precision': 0.34574036813173054, 'recall': 0.3402638073421445, 'f1-score': 0.2535439284490961, 'support': 583991}, 'weighted avg': {'precision': 0.34579335471030653, 'recall': 0.34954819509204765, 'f1-score': 0.2574667148580836, 'support': 583991}}
[[  6626 161888  25842]
 [  6813 170494  25074]
 [  6038 154203  27013]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1137817
{'0': {'precision': 0.3606382978723404, 'recall': 0.041041714308774666, 'f1-score': 0.07369654222877087, 'support': 74339}, '1': {'precision': 0.3387615743902106, 'recall': 0.8366094194784345, 'f1-score': 0.48224964810364807, 'support': 74123}, '2': {'precision': 0.3677842653343767, 'recall': 0.1602013660378348, 'f1-score': 0.223186155883293, 'support': 76279}, 'accuracy': 0.34387583929946025, 'macro avg': {'precision': 0.3557280458656426, 'recall': 0.3459508332750147, 'f1-score': 0.259710782071904, 'support': 224741}, 'weighted avg': {'precision': 0.3558484236498833, 'recall': 0.34387583929946025, 'f1-score': 0.2591816121835936, 'support': 224741}}
[[ 3051 59786 11502]
 [ 2607 62012  9504]
 [ 2802 61257 12220]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1153653
{'0': {'precision': 0.3404887714663144, 'recall': 0.04000155195157911, 'f1-score': 0.07159225053815707, 'support': 25774}, '1': {'precision': 0.3403747763583289, 'recall': 0.8371805759283564, 'f1-score': 0.48397750602517187, 'support': 25906}, '2': {'precision': 0.34394124847001223, 'recall': 0.14221201385915055, 'f1-score': 0.2012228709926187, 'support': 25687}, 'accuracy': 0.3408688458903667, 'macro avg': {'precision': 0.3416015987648852, 'recall': 0.339798047246362, 'f1-score': 0.2522642091853159, 'support': 77367}, 'weighted avg': {'precision': 0.3415968746566477, 'recall': 0.3408688458903667, 'f1-score': 0.25271694422229063, 'support': 77367}}
[[ 1031 20999  3744]
 [  994 21688  3224]
 [ 1003 21031  3653]]
training model: results/PCAR/W3/deepOF_L2/h500
Epoch 1/50
878/878 - 23s - loss: 3.3217 - accuracy500: 0.3530 - val_loss: 3.3926 - val_accuracy500: 0.3311 - 23s/epoch - 26ms/step
Epoch 2/50
878/878 - 20s - loss: 3.2882 - accuracy500: 0.3670 - val_loss: 3.4064 - val_accuracy500: 0.3315 - 20s/epoch - 23ms/step
Epoch 3/50
878/878 - 20s - loss: 3.2715 - accuracy500: 0.3753 - val_loss: 3.4290 - val_accuracy500: 0.3320 - 20s/epoch - 23ms/step
Epoch 4/50
878/878 - 20s - loss: 3.2634 - accuracy500: 0.3798 - val_loss: 3.4493 - val_accuracy500: 0.3310 - 20s/epoch - 23ms/step
Epoch 5/50
878/878 - 20s - loss: 3.2580 - accuracy500: 0.3828 - val_loss: 3.4464 - val_accuracy500: 0.3316 - 20s/epoch - 22ms/step
Epoch 6/50
878/878 - 20s - loss: 3.2540 - accuracy500: 0.3848 - val_loss: 3.4456 - val_accuracy500: 0.3314 - 20s/epoch - 22ms/step
Epoch 7/50
878/878 - 20s - loss: 3.2507 - accuracy500: 0.3881 - val_loss: 3.4492 - val_accuracy500: 0.3311 - 20s/epoch - 22ms/step
Epoch 8/50
878/878 - 20s - loss: 3.2484 - accuracy500: 0.3897 - val_loss: 3.4392 - val_accuracy500: 0.3315 - 20s/epoch - 22ms/step
Epoch 9/50
878/878 - 20s - loss: 3.2458 - accuracy500: 0.3906 - val_loss: 3.4448 - val_accuracy500: 0.3316 - 20s/epoch - 23ms/step
Epoch 10/50
878/878 - 20s - loss: 3.2431 - accuracy500: 0.3918 - val_loss: 3.4382 - val_accuracy500: 0.3322 - 20s/epoch - 22ms/step
Epoch 11/50
878/878 - 20s - loss: 3.2412 - accuracy500: 0.3938 - val_loss: 3.4355 - val_accuracy500: 0.3319 - 20s/epoch - 22ms/step
testing model: results/PCAR/W3/deepOF_L2/h500
Evaluating performance on  test set...
2282/2282 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.126953
{'0': {'precision': 0.33366758586111805, 'recall': 0.013439353780133789, 'f1-score': 0.025838012550169133, 'support': 198075}, '1': {'precision': 0.34571779886481324, 'recall': 0.9376864171675012, 'f1-score': 0.5051797089630555, 'support': 201497}, '2': {'precision': 0.3322936090862858, 'recall': 0.05314528329510517, 'f1-score': 0.09163495610385483, 'support': 184419}, 'accuracy': 0.34487517787089184, 'macro avg': {'precision': 0.33722633127073903, 'recall': 0.3347570180809134, 'f1-score': 0.2075508925390265, 'support': 583991}, 'weighted avg': {'precision': 0.337391434938874, 'recall': 0.34487517787089184, 'f1-score': 0.2120054711845223, 'support': 583991}}
[[  2662 185408  10005]
 [  2867 188941   9689]
 [  2449 172169   9801]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1296539
{'0': {'precision': 0.3300389338125187, 'recall': 0.01485936193738033, 'f1-score': 0.028438342731061533, 'support': 74162}, '1': {'precision': 0.33227604353546225, 'recall': 0.9360125064014447, 'f1-score': 0.4904475915078718, 'support': 74202}, '2': {'precision': 0.36301203845843094, 'recall': 0.058826610105136366, 'f1-score': 0.10124614101899633, 'support': 76377}, 'accuracy': 0.33393550798474686, 'macro avg': {'precision': 0.3417756719354706, 'recall': 0.3365661594813205, 'f1-score': 0.20671069175264323, 'support': 224741}, 'weighted avg': {'precision': 0.34198328232570807, 'recall': 0.33393550798474686, 'f1-score': 0.20572175558218558, 'support': 224741}}
[[ 1102 68797  4263]
 [ 1127 69454  3621]
 [ 1110 70774  4493]]
Evaluating performance on  val set...
303/303 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1319343
{'0': {'precision': 0.3050724637681159, 'recall': 0.016459457346156853, 'f1-score': 0.031233771051264934, 'support': 25578}, '1': {'precision': 0.3311531649629743, 'recall': 0.9293206011271133, 'f1-score': 0.4883044242692193, 'support': 25552}, '2': {'precision': 0.3352803738317757, 'recall': 0.054693753096771734, 'f1-score': 0.0940459416063178, 'support': 26237}, 'accuracy': 0.3309162821357943, 'macro avg': {'precision': 0.32383533418762195, 'recall': 0.3334912705233473, 'f1-score': 0.20452804564226734, 'support': 77367}, 'weighted avg': {'precision': 0.3239303620098891, 'recall': 0.3309162821357943, 'f1-score': 0.20349161030932186, 'support': 77367}}
[[  421 23651  1506]
 [  467 23746  1339]
 [  492 24310  1435]]
training model: results/PCAR/W3/deepOF_L2/h1000
Epoch 1/50
878/878 - 23s - loss: 3.3233 - accuracy1000: 0.3580 - val_loss: 3.4175 - val_accuracy1000: 0.3269 - 23s/epoch - 26ms/step
Epoch 2/50
878/878 - 21s - loss: 3.2906 - accuracy1000: 0.3681 - val_loss: 3.4357 - val_accuracy1000: 0.3229 - 21s/epoch - 23ms/step
Epoch 3/50
878/878 - 21s - loss: 3.2745 - accuracy1000: 0.3747 - val_loss: 3.4723 - val_accuracy1000: 0.3225 - 21s/epoch - 23ms/step
Epoch 4/50
878/878 - 20s - loss: 3.2662 - accuracy1000: 0.3785 - val_loss: 3.4894 - val_accuracy1000: 0.3227 - 20s/epoch - 23ms/step
Epoch 5/50
878/878 - 20s - loss: 3.2619 - accuracy1000: 0.3783 - val_loss: 3.4927 - val_accuracy1000: 0.3229 - 20s/epoch - 23ms/step
Epoch 6/50
878/878 - 20s - loss: 3.2583 - accuracy1000: 0.3804 - val_loss: 3.5036 - val_accuracy1000: 0.3224 - 20s/epoch - 23ms/step
Epoch 7/50
878/878 - 20s - loss: 3.2561 - accuracy1000: 0.3820 - val_loss: 3.4994 - val_accuracy1000: 0.3224 - 20s/epoch - 23ms/step
Epoch 8/50
878/878 - 20s - loss: 3.2533 - accuracy1000: 0.3841 - val_loss: 3.4957 - val_accuracy1000: 0.3229 - 20s/epoch - 23ms/step
Epoch 9/50
878/878 - 20s - loss: 3.2515 - accuracy1000: 0.3856 - val_loss: 3.5004 - val_accuracy1000: 0.3227 - 20s/epoch - 22ms/step
Epoch 10/50
878/878 - 20s - loss: 3.2490 - accuracy1000: 0.3873 - val_loss: 3.5001 - val_accuracy1000: 0.3232 - 20s/epoch - 23ms/step
Epoch 11/50
878/878 - 20s - loss: 3.2468 - accuracy1000: 0.3891 - val_loss: 3.4985 - val_accuracy1000: 0.3235 - 20s/epoch - 23ms/step
testing model: results/PCAR/W3/deepOF_L2/h1000
Evaluating performance on  test set...
2282/2282 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1367129
{'0': {'precision': 0.3418587517103463, 'recall': 0.015701288781893242, 'f1-score': 0.03002361771652269, 'support': 206862}, '1': {'precision': 0.3367730057478411, 'recall': 0.9275709772729597, 'f1-score': 0.49413904800547903, 'support': 195626}, '2': {'precision': 0.33776170856806526, 'recall': 0.0663955967669956, 'f1-score': 0.11097604773876289, 'support': 181503}, 'accuracy': 0.3369161511050684, 'macro avg': {'precision': 0.33879782200875086, 'recall': 0.3365559542739495, 'f1-score': 0.21171290448692157, 'support': 583991}, 'weighted avg': {'precision': 0.3388817713097674, 'recall': 0.3369161511050684, 'f1-score': 0.2106533775450715, 'support': 583991}}
[[  3248 190863  12751]
 [  3292 181457  10877]
 [  2961 166491  12051]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1325034
{'0': {'precision': 0.3300529901589705, 'recall': 0.017812155298026773, 'f1-score': 0.03380019639257843, 'support': 73433}, '1': {'precision': 0.3339003479849919, 'recall': 0.926302448495308, 'f1-score': 0.49086180534716556, 'support': 74168}, '2': {'precision': 0.37311942484356275, 'recall': 0.07266009852216748, 'f1-score': 0.12163364510318786, 'support': 77140}, 'accuracy': 0.3364539625613484, 'macro avg': {'precision': 0.3456909209958417, 'recall': 0.33892490077183407, 'f1-score': 0.2154318822809773, 'support': 224741}, 'weighted avg': {'precision': 0.34610478136222134, 'recall': 0.3364539625613484, 'f1-score': 0.2147854979017834, 'support': 224741}}
[[ 1308 66878  5247]
 [ 1296 68702  4170]
 [ 1359 70176  5605]]
Evaluating performance on  val set...
303/303 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1403407
{'0': {'precision': 0.3464419475655431, 'recall': 0.02152998681045853, 'f1-score': 0.04054054054054054, 'support': 25778}, '1': {'precision': 0.32467808122258385, 'recall': 0.9209681303684675, 'f1-score': 0.4801012721794442, 'support': 24914}, '2': {'precision': 0.35191364082433757, 'recall': 0.06721649484536082, 'f1-score': 0.11287378029587662, 'support': 26675}, 'accuracy': 0.3269223312264919, 'macro avg': {'precision': 0.34101122320415483, 'recall': 0.3365715373414289, 'f1-score': 0.21117186433862045, 'support': 77367}, 'weighted avg': {'precision': 0.3413200280340873, 'recall': 0.3269223312264919, 'f1-score': 0.20702890429414655, 'support': 77367}}
[[  555 23408  1815]
 [  482 22945  1487]
 [  565 24317  1793]]
training model: results/PCAR/W3/deepVOL_L2/h10
Epoch 1/50
878/878 - 23s - loss: 3.2273 - accuracy10: 0.4151 - val_loss: 3.1914 - val_accuracy10: 0.4214 - 23s/epoch - 26ms/step
Epoch 2/50
878/878 - 19s - loss: 3.0770 - accuracy10: 0.4727 - val_loss: 3.1567 - val_accuracy10: 0.4341 - 19s/epoch - 22ms/step
Epoch 3/50
878/878 - 19s - loss: 3.0410 - accuracy10: 0.4857 - val_loss: 3.1232 - val_accuracy10: 0.4584 - 19s/epoch - 22ms/step
Epoch 4/50
878/878 - 19s - loss: 3.0159 - accuracy10: 0.4929 - val_loss: 3.0811 - val_accuracy10: 0.4750 - 19s/epoch - 22ms/step
Epoch 5/50
878/878 - 20s - loss: 2.9925 - accuracy10: 0.5007 - val_loss: 3.0533 - val_accuracy10: 0.4823 - 20s/epoch - 22ms/step
Epoch 6/50
878/878 - 20s - loss: 2.9778 - accuracy10: 0.5039 - val_loss: 3.0450 - val_accuracy10: 0.4870 - 20s/epoch - 23ms/step
Epoch 7/50
878/878 - 20s - loss: 2.9665 - accuracy10: 0.5068 - val_loss: 3.0356 - val_accuracy10: 0.4885 - 20s/epoch - 23ms/step
Epoch 8/50
878/878 - 20s - loss: 2.9557 - accuracy10: 0.5109 - val_loss: 3.0556 - val_accuracy10: 0.4857 - 20s/epoch - 23ms/step
Epoch 9/50
878/878 - 19s - loss: 2.9470 - accuracy10: 0.5130 - val_loss: 3.0700 - val_accuracy10: 0.4830 - 19s/epoch - 22ms/step
Epoch 10/50
878/878 - 19s - loss: 2.9417 - accuracy10: 0.5153 - val_loss: 3.0611 - val_accuracy10: 0.4841 - 19s/epoch - 22ms/step
Epoch 11/50
878/878 - 21s - loss: 2.9341 - accuracy10: 0.5171 - val_loss: 3.0584 - val_accuracy10: 0.4855 - 21s/epoch - 24ms/step
Epoch 12/50
878/878 - 20s - loss: 2.9277 - accuracy10: 0.5184 - val_loss: 3.0659 - val_accuracy10: 0.4850 - 20s/epoch - 22ms/step
Epoch 13/50
878/878 - 20s - loss: 2.9240 - accuracy10: 0.5191 - val_loss: 3.0615 - val_accuracy10: 0.4856 - 20s/epoch - 22ms/step
Epoch 14/50
878/878 - 19s - loss: 2.9182 - accuracy10: 0.5209 - val_loss: 3.0794 - val_accuracy10: 0.4830 - 19s/epoch - 22ms/step
Epoch 15/50
878/878 - 19s - loss: 2.9150 - accuracy10: 0.5217 - val_loss: 3.0586 - val_accuracy10: 0.4889 - 19s/epoch - 22ms/step
Epoch 16/50
878/878 - 20s - loss: 2.9117 - accuracy10: 0.5227 - val_loss: 3.0620 - val_accuracy10: 0.4875 - 20s/epoch - 23ms/step
Epoch 17/50
878/878 - 19s - loss: 2.9057 - accuracy10: 0.5252 - val_loss: 3.0690 - val_accuracy10: 0.4874 - 19s/epoch - 21ms/step
testing model: results/PCAR/W3/deepVOL_L2/h10
Evaluating performance on  test set...
2282/2282 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0138655
{'0': {'precision': 0.5095337918840541, 'recall': 0.4054929885247387, 'f1-score': 0.45159854213906664, 'support': 187621}, '1': {'precision': 0.4851569674343912, 'recall': 0.5074475581855566, 'f1-score': 0.4960519766067523, 'support': 207182}, '2': {'precision': 0.4732066262047958, 'recall': 0.5452186138948792, 'f1-score': 0.5066666666666668, 'support': 189192}, 'accuracy': 0.4869288264454319, 'macro avg': {'precision': 0.48929912850774704, 'recall': 0.48605305353505823, 'f1-score': 0.4847723951374953, 'support': 583995}, 'weighted avg': {'precision': 0.4891170958980948, 'recall': 0.4869288264454319, 'f1-score': 0.48520910400262673, 'support': 583995}}
[[ 76079  58040  53502]
 [ 40718 105134  61330]
 [ 32514  53527 103151]]
Evaluating performance on  train set...
878/878 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0051005
{'0': {'precision': 0.5324722052315332, 'recall': 0.39815437595846, 'f1-score': 0.4556202087374157, 'support': 74338}, '1': {'precision': 0.49861612673643146, 'recall': 0.5097690462715929, 'f1-score': 0.5041309098662118, 'support': 74214}, '2': {'precision': 0.47289431086049977, 'recall': 0.5789791445183814, 'f1-score': 0.5205872287194496, 'support': 76191}, 'accuracy': 0.496313567052144, 'macro avg': {'precision': 0.5013275476094882, 'recall': 0.4956341889161448, 'f1-score': 0.49344611577435904, 'support': 224743}, 'weighted avg': {'precision': 0.5010946123389453, 'recall': 0.496313567052144, 'f1-score': 0.49366399827935303, 'support': 224743}}
[[29598 18701 26039]
 [13251 37832 23131]
 [12737 19341 44113]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0111649
{'0': {'precision': 0.5222153656278926, 'recall': 0.40654149485567875, 'f1-score': 0.457175014068655, 'support': 24979}, '1': {'precision': 0.49195974300887585, 'recall': 0.49037536092396533, 'f1-score': 0.4911662742626203, 'support': 27014}, '2': {'precision': 0.46618700393624574, 'recall': 0.5694411602427681, 'f1-score': 0.5126667612829974, 'support': 25374}, 'accuracy': 0.48923959827833574, 'macro avg': {'precision': 0.4934540375243381, 'recall': 0.48878600534080413, 'f1-score': 0.4870026832047576, 'support': 77367}, 'weighted avg': {'precision': 0.49327551997026114, 'recall': 0.48923959827833574, 'f1-score': 0.4872432278638971, 'support': 77367}}
[[10155  6874  7950]
 [ 5172 13247  8595]
 [ 4119  6806 14449]]
training model: results/PCAR/W3/deepVOL_L2/h20
Epoch 1/50
878/878 - 22s - loss: 3.2607 - accuracy20: 0.3958 - val_loss: 3.2209 - val_accuracy20: 0.4085 - 22s/epoch - 25ms/step
Epoch 2/50
878/878 - 20s - loss: 3.1654 - accuracy20: 0.4397 - val_loss: 3.1945 - val_accuracy20: 0.4250 - 20s/epoch - 22ms/step
Epoch 3/50
878/878 - 20s - loss: 3.1406 - accuracy20: 0.4513 - val_loss: 3.1806 - val_accuracy20: 0.4320 - 20s/epoch - 23ms/step
Epoch 4/50
878/878 - 20s - loss: 3.1238 - accuracy20: 0.4567 - val_loss: 3.1647 - val_accuracy20: 0.4377 - 20s/epoch - 23ms/step
Epoch 5/50
878/878 - 20s - loss: 3.1115 - accuracy20: 0.4619 - val_loss: 3.1881 - val_accuracy20: 0.4348 - 20s/epoch - 22ms/step
Epoch 6/50
878/878 - 20s - loss: 3.1010 - accuracy20: 0.4655 - val_loss: 3.2082 - val_accuracy20: 0.4309 - 20s/epoch - 22ms/step
Epoch 7/50
878/878 - 20s - loss: 3.0913 - accuracy20: 0.4684 - val_loss: 3.1994 - val_accuracy20: 0.4348 - 20s/epoch - 23ms/step
Epoch 8/50
878/878 - 19s - loss: 3.0836 - accuracy20: 0.4710 - val_loss: 3.1907 - val_accuracy20: 0.4357 - 19s/epoch - 21ms/step
Epoch 9/50
878/878 - 20s - loss: 3.0780 - accuracy20: 0.4730 - val_loss: 3.1896 - val_accuracy20: 0.4383 - 20s/epoch - 23ms/step
Epoch 10/50
878/878 - 19s - loss: 3.0718 - accuracy20: 0.4746 - val_loss: 3.1783 - val_accuracy20: 0.4428 - 19s/epoch - 22ms/step
Epoch 11/50
878/878 - 20s - loss: 3.0657 - accuracy20: 0.4774 - val_loss: 3.1922 - val_accuracy20: 0.4395 - 20s/epoch - 23ms/step
Epoch 12/50
878/878 - 20s - loss: 3.0619 - accuracy20: 0.4789 - val_loss: 3.1879 - val_accuracy20: 0.4402 - 20s/epoch - 23ms/step
Epoch 13/50
878/878 - 19s - loss: 3.0572 - accuracy20: 0.4805 - val_loss: 3.1835 - val_accuracy20: 0.4443 - 19s/epoch - 21ms/step
Epoch 14/50
878/878 - 19s - loss: 3.0527 - accuracy20: 0.4827 - val_loss: 3.1638 - val_accuracy20: 0.4486 - 19s/epoch - 21ms/step
Epoch 15/50
878/878 - 19s - loss: 3.0500 - accuracy20: 0.4830 - val_loss: 3.1711 - val_accuracy20: 0.4475 - 19s/epoch - 21ms/step
Epoch 16/50
878/878 - 19s - loss: 3.0452 - accuracy20: 0.4838 - val_loss: 3.1575 - val_accuracy20: 0.4515 - 19s/epoch - 21ms/step
Epoch 17/50
878/878 - 19s - loss: 3.0427 - accuracy20: 0.4850 - val_loss: 3.1654 - val_accuracy20: 0.4482 - 19s/epoch - 21ms/step
Epoch 18/50
878/878 - 19s - loss: 3.0395 - accuracy20: 0.4863 - val_loss: 3.1473 - val_accuracy20: 0.4527 - 19s/epoch - 22ms/step
Epoch 19/50
878/878 - 20s - loss: 3.0359 - accuracy20: 0.4869 - val_loss: 3.1559 - val_accuracy20: 0.4499 - 20s/epoch - 22ms/step
Epoch 20/50
878/878 - 19s - loss: 3.0330 - accuracy20: 0.4877 - val_loss: 3.1535 - val_accuracy20: 0.4510 - 19s/epoch - 22ms/step
Epoch 21/50
878/878 - 19s - loss: 3.0303 - accuracy20: 0.4882 - val_loss: 3.1623 - val_accuracy20: 0.4504 - 19s/epoch - 22ms/step
Epoch 22/50
878/878 - 19s - loss: 3.0290 - accuracy20: 0.4888 - val_loss: 3.1502 - val_accuracy20: 0.4537 - 19s/epoch - 21ms/step
Epoch 23/50
878/878 - 19s - loss: 3.0250 - accuracy20: 0.4908 - val_loss: 3.1523 - val_accuracy20: 0.4504 - 19s/epoch - 22ms/step
Epoch 24/50
878/878 - 19s - loss: 3.0225 - accuracy20: 0.4908 - val_loss: 3.1513 - val_accuracy20: 0.4525 - 19s/epoch - 21ms/step
Epoch 25/50
878/878 - 19s - loss: 3.0181 - accuracy20: 0.4923 - val_loss: 3.1619 - val_accuracy20: 0.4507 - 19s/epoch - 21ms/step
Epoch 26/50
878/878 - 19s - loss: 3.0154 - accuracy20: 0.4924 - val_loss: 3.1631 - val_accuracy20: 0.4514 - 19s/epoch - 22ms/step
Epoch 27/50
878/878 - 19s - loss: 3.0129 - accuracy20: 0.4937 - val_loss: 3.1576 - val_accuracy20: 0.4530 - 19s/epoch - 22ms/step
Epoch 28/50
878/878 - 19s - loss: 3.0108 - accuracy20: 0.4950 - val_loss: 3.1621 - val_accuracy20: 0.4509 - 19s/epoch - 22ms/step
testing model: results/PCAR/W3/deepVOL_L2/h20
Evaluating performance on  test set...
2282/2282 - 21s - 21s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0434477
{'0': {'precision': 0.49575631761746974, 'recall': 0.3256259112029452, 'f1-score': 0.39307181722359913, 'support': 190682}, '1': {'precision': 0.4361739803844719, 'recall': 0.46442955044824447, 'f1-score': 0.44985851974148805, 'support': 198887}, '2': {'precision': 0.4563748334878674, 'recall': 0.5797321345910527, 'f1-score': 0.5107101188251153, 'support': 194426}, 'accuracy': 0.45749535526845264, 'macro avg': {'precision': 0.46276837716326974, 'recall': 0.45659586541408076, 'f1-score': 0.4512134852634008, 'support': 583995}, 'weighted avg': {'precision': 0.4623537427004904, 'recall': 0.45749535526845264, 'f1-score': 0.45157588203725635, 'support': 583995}}
[[ 62091  67100  61491]
 [ 33745  92369  72773]
 [ 29409  52302 112715]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0373347
{'0': {'precision': 0.5114620367744891, 'recall': 0.31548003444193307, 'f1-score': 0.39024755564801333, 'support': 74328}, '1': {'precision': 0.44784158415841585, 'recall': 0.4577519902847119, 'f1-score': 0.4527425597224075, 'support': 74110}, '2': {'precision': 0.4541911465301611, 'recall': 0.6139571456654217, 'f1-score': 0.5221258170754134, 'support': 76305}, 'accuracy': 0.46373413187507506, 'macro avg': {'precision': 0.47116492248768865, 'recall': 0.4623963901306889, 'f1-score': 0.4550386441486114, 'support': 224743}, 'weighted avg': {'precision': 0.47103823259161964, 'recall': 0.46373413187507506, 'f1-score': 0.4556310180480485, 'support': 224743}}
[[23449 23150 27729]
 [11617 33924 28569]
 [10781 18676 46848]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0479559
{'0': {'precision': 0.5034737435062903, 'recall': 0.31911770539929385, 'f1-score': 0.39063714063714067, 'support': 25207}, '1': {'precision': 0.4371578467153285, 'recall': 0.4338426711941143, 'f1-score': 0.43549394989490425, 'support': 26505}, '2': {'precision': 0.44168614262098843, 'recall': 0.6040537906840772, 'f1-score': 0.5102648952108131, 'support': 25655}, 'accuracy': 0.4529062778704099, 'macro avg': {'precision': 0.46077257761420237, 'recall': 0.4523380557591617, 'f1-score': 0.44546532858095267, 'support': 77367}, 'weighted avg': {'precision': 0.46026586747184584, 'recall': 0.4529062778704099, 'f1-score': 0.44567326421650383, 'support': 77367}}
[[ 8044  8246  8917]
 [ 4334 11499 10672]
 [ 3599  6559 15497]]
training model: results/PCAR/W3/deepVOL_L2/h30
Epoch 1/50
878/878 - 22s - loss: 3.2766 - accuracy30: 0.3863 - val_loss: 3.2407 - val_accuracy30: 0.3883 - 22s/epoch - 25ms/step
Epoch 2/50
878/878 - 19s - loss: 3.2109 - accuracy30: 0.4159 - val_loss: 3.2617 - val_accuracy30: 0.3923 - 19s/epoch - 22ms/step
Epoch 3/50
878/878 - 19s - loss: 3.1882 - accuracy30: 0.4288 - val_loss: 3.2121 - val_accuracy30: 0.4108 - 19s/epoch - 22ms/step
Epoch 4/50
878/878 - 19s - loss: 3.1747 - accuracy30: 0.4355 - val_loss: 3.2121 - val_accuracy30: 0.4147 - 19s/epoch - 22ms/step
Epoch 5/50
878/878 - 19s - loss: 3.1651 - accuracy30: 0.4397 - val_loss: 3.2186 - val_accuracy30: 0.4105 - 19s/epoch - 22ms/step
Epoch 6/50
878/878 - 19s - loss: 3.1567 - accuracy30: 0.4433 - val_loss: 3.2025 - val_accuracy30: 0.4184 - 19s/epoch - 22ms/step
Epoch 7/50
878/878 - 19s - loss: 3.1499 - accuracy30: 0.4460 - val_loss: 3.2083 - val_accuracy30: 0.4170 - 19s/epoch - 22ms/step
Epoch 8/50
878/878 - 19s - loss: 3.1446 - accuracy30: 0.4479 - val_loss: 3.2046 - val_accuracy30: 0.4214 - 19s/epoch - 21ms/step
Epoch 9/50
878/878 - 19s - loss: 3.1401 - accuracy30: 0.4489 - val_loss: 3.2139 - val_accuracy30: 0.4157 - 19s/epoch - 22ms/step
Epoch 10/50
878/878 - 20s - loss: 3.1357 - accuracy30: 0.4511 - val_loss: 3.2112 - val_accuracy30: 0.4154 - 20s/epoch - 22ms/step
Epoch 11/50
878/878 - 19s - loss: 3.1325 - accuracy30: 0.4524 - val_loss: 3.2143 - val_accuracy30: 0.4141 - 19s/epoch - 21ms/step
Epoch 12/50
878/878 - 20s - loss: 3.1275 - accuracy30: 0.4541 - val_loss: 3.2050 - val_accuracy30: 0.4183 - 20s/epoch - 22ms/step
Epoch 13/50
878/878 - 19s - loss: 3.1244 - accuracy30: 0.4554 - val_loss: 3.2044 - val_accuracy30: 0.4201 - 19s/epoch - 22ms/step
Epoch 14/50
878/878 - 20s - loss: 3.1226 - accuracy30: 0.4557 - val_loss: 3.2106 - val_accuracy30: 0.4167 - 20s/epoch - 23ms/step
Epoch 15/50
878/878 - 19s - loss: 3.1194 - accuracy30: 0.4569 - val_loss: 3.2174 - val_accuracy30: 0.4165 - 19s/epoch - 22ms/step
Epoch 16/50
878/878 - 19s - loss: 3.1167 - accuracy30: 0.4585 - val_loss: 3.1976 - val_accuracy30: 0.4223 - 19s/epoch - 21ms/step
Epoch 17/50
878/878 - 19s - loss: 3.1134 - accuracy30: 0.4583 - val_loss: 3.1963 - val_accuracy30: 0.4228 - 19s/epoch - 22ms/step
Epoch 18/50
878/878 - 19s - loss: 3.1104 - accuracy30: 0.4608 - val_loss: 3.1980 - val_accuracy30: 0.4213 - 19s/epoch - 21ms/step
Epoch 19/50
878/878 - 19s - loss: 3.1088 - accuracy30: 0.4608 - val_loss: 3.1973 - val_accuracy30: 0.4225 - 19s/epoch - 21ms/step
Epoch 20/50
878/878 - 19s - loss: 3.1061 - accuracy30: 0.4619 - val_loss: 3.1982 - val_accuracy30: 0.4213 - 19s/epoch - 21ms/step
Epoch 21/50
878/878 - 19s - loss: 3.1029 - accuracy30: 0.4633 - val_loss: 3.2047 - val_accuracy30: 0.4197 - 19s/epoch - 21ms/step
Epoch 22/50
878/878 - 20s - loss: 3.0999 - accuracy30: 0.4636 - val_loss: 3.2060 - val_accuracy30: 0.4181 - 20s/epoch - 22ms/step
Epoch 23/50
878/878 - 19s - loss: 3.0968 - accuracy30: 0.4648 - val_loss: 3.1997 - val_accuracy30: 0.4214 - 19s/epoch - 21ms/step
Epoch 24/50
878/878 - 19s - loss: 3.0967 - accuracy30: 0.4647 - val_loss: 3.2043 - val_accuracy30: 0.4197 - 19s/epoch - 21ms/step
Epoch 25/50
878/878 - 19s - loss: 3.0927 - accuracy30: 0.4668 - val_loss: 3.2139 - val_accuracy30: 0.4187 - 19s/epoch - 21ms/step
Epoch 26/50
878/878 - 19s - loss: 3.0902 - accuracy30: 0.4665 - val_loss: 3.2158 - val_accuracy30: 0.4178 - 19s/epoch - 22ms/step
Epoch 27/50
878/878 - 19s - loss: 3.0879 - accuracy30: 0.4684 - val_loss: 3.2047 - val_accuracy30: 0.4187 - 19s/epoch - 21ms/step
testing model: results/PCAR/W3/deepVOL_L2/h30
Evaluating performance on  test set...
2282/2282 - 24s - 24s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0651039
{'0': {'precision': 0.47852461430833243, 'recall': 0.2669100356325026, 'f1-score': 0.34268066789276275, 'support': 194766}, '1': {'precision': 0.3717693918952351, 'recall': 0.47316246313380983, 'f1-score': 0.41638226832117997, 'support': 190554}, '2': {'precision': 0.45187364442631045, 'recall': 0.5295683905876432, 'f1-score': 0.48764570925355144, 'support': 198675}, 'accuracy': 0.4235652702506015, 'macro avg': {'precision': 0.43405588354329266, 'recall': 0.4232136297846519, 'f1-score': 0.41556954848916466, 'support': 583995}, 'weighted avg': {'precision': 0.43462438212652255, 'recall': 0.4235652702506015, 'f1-score': 0.4160461322552852, 'support': 583995}}
[[ 51985  84327  58454]
 [ 31222  90163  69169]
 [ 25429  68034 105212]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0610346
{'0': {'precision': 0.48791631597931945, 'recall': 0.27261612049390677, 'f1-score': 0.3497914008895632, 'support': 74427}, '1': {'precision': 0.3887498714564837, 'recall': 0.45940398871170285, 'f1-score': 0.4211340652811645, 'support': 74059}, '2': {'precision': 0.4448708162987902, 'recall': 0.5579422216976803, 'f1-score': 0.4950318797412388, 'support': 76257}, 'accuracy': 0.430981165153086, 'macro avg': {'precision': 0.4405123345781978, 'recall': 0.4299874436344299, 'f1-score': 0.42198578197065545, 'support': 224743}, 'weighted avg': {'precision': 0.4406325812954592, 'recall': 0.430981165153086, 'f1-score': 0.4225819642351171, 'support': 224743}}
[[20290 29607 24530]
 [11474 34023 28562]
 [ 9821 23889 42547]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0649151
{'0': {'precision': 0.482548118356794, 'recall': 0.2658673630895853, 'f1-score': 0.34284110623533015, 'support': 25272}, '1': {'precision': 0.38721901923948954, 'recall': 0.45201905626134303, 'f1-score': 0.41711733714804083, 'support': 26448}, '2': {'precision': 0.43384813779974823, 'recall': 0.5509416306000702, 'f1-score': 0.48543355778480146, 'support': 25647}, 'accuracy': 0.4240050667597296, 'macro avg': {'precision': 0.4345384251320106, 'recall': 0.4229426833169995, 'f1-score': 0.4151306670560575, 'support': 77367}, 'weighted avg': {'precision': 0.43381581110950485, 'recall': 0.4240050667597296, 'f1-score': 0.41550162506207367, 'support': 77367}}
[[ 6719 10447  8106]
 [ 4160 11955 10333]
 [ 3045  8472 14130]]
training model: results/PCAR/W3/deepVOL_L2/h50
Epoch 1/50
878/878 - 22s - loss: 3.2892 - accuracy50: 0.3808 - val_loss: 3.3437 - val_accuracy50: 0.3589 - 22s/epoch - 25ms/step
Epoch 2/50
878/878 - 19s - loss: 3.2506 - accuracy50: 0.3959 - val_loss: 3.2808 - val_accuracy50: 0.3777 - 19s/epoch - 22ms/step
Epoch 3/50
878/878 - 22s - loss: 3.2356 - accuracy50: 0.4035 - val_loss: 3.2725 - val_accuracy50: 0.3863 - 22s/epoch - 25ms/step
Epoch 4/50
878/878 - 20s - loss: 3.2243 - accuracy50: 0.4098 - val_loss: 3.2735 - val_accuracy50: 0.3844 - 20s/epoch - 23ms/step
Epoch 5/50
878/878 - 20s - loss: 3.2180 - accuracy50: 0.4136 - val_loss: 3.2920 - val_accuracy50: 0.3853 - 20s/epoch - 23ms/step
Epoch 6/50
878/878 - 19s - loss: 3.2152 - accuracy50: 0.4147 - val_loss: 3.3032 - val_accuracy50: 0.3869 - 19s/epoch - 22ms/step
Epoch 7/50
878/878 - 19s - loss: 3.2087 - accuracy50: 0.4180 - val_loss: 3.2823 - val_accuracy50: 0.3873 - 19s/epoch - 22ms/step
Epoch 8/50
878/878 - 19s - loss: 3.2048 - accuracy50: 0.4204 - val_loss: 3.2912 - val_accuracy50: 0.3856 - 19s/epoch - 22ms/step
Epoch 9/50
878/878 - 19s - loss: 3.2026 - accuracy50: 0.4209 - val_loss: 3.2881 - val_accuracy50: 0.3871 - 19s/epoch - 22ms/step
Epoch 10/50
878/878 - 19s - loss: 3.1988 - accuracy50: 0.4234 - val_loss: 3.2876 - val_accuracy50: 0.3850 - 19s/epoch - 22ms/step
Epoch 11/50
878/878 - 20s - loss: 3.1963 - accuracy50: 0.4238 - val_loss: 3.3089 - val_accuracy50: 0.3828 - 20s/epoch - 22ms/step
Epoch 12/50
878/878 - 19s - loss: 3.1920 - accuracy50: 0.4260 - val_loss: 3.2905 - val_accuracy50: 0.3846 - 19s/epoch - 22ms/step
Epoch 13/50
878/878 - 19s - loss: 3.1902 - accuracy50: 0.4278 - val_loss: 3.3210 - val_accuracy50: 0.3832 - 19s/epoch - 22ms/step
testing model: results/PCAR/W3/deepVOL_L2/h50
Evaluating performance on  test set...
2282/2282 - 24s - 24s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1054924
{'0': {'precision': 0.47135118402724036, 'recall': 0.07174458982562111, 'f1-score': 0.12453382622350169, 'support': 212239}, '1': {'precision': 0.2849289026090895, 'recall': 0.6076074040655004, 'f1-score': 0.3879392010450961, 'support': 157373}, '2': {'precision': 0.44374670282377116, 'recall': 0.4472882644612679, 'f1-score': 0.4455104453896492, 'support': 214383}, 'accuracy': 0.35400816787814965, 'macro avg': {'precision': 0.4000089298200337, 'recall': 0.3755467527841298, 'f1-score': 0.3193278242194157, 'support': 583995}, 'weighted avg': {'precision': 0.4109812062235571, 'recall': 0.35400816787814965, 'f1-score': 0.3133450739199631, 'support': 583995}}
[[ 15227 130166  66846]
 [  8395  95621  53357]
 [  8683 109809  95891]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0959761
{'0': {'precision': 0.445360052439367, 'recall': 0.0637678827614872, 'f1-score': 0.11156200886678709, 'support': 74583}, '1': {'precision': 0.35559028021630734, 'recall': 0.5460059849567304, 'f1-score': 0.4306903847994131, 'support': 74186}, '2': {'precision': 0.4023384455627446, 'recall': 0.5303788138047226, 'f1-score': 0.45757014864358464, 'support': 75974}, 'accuracy': 0.3806881638137784, 'macro avg': {'precision': 0.40109625940613963, 'recall': 0.3800508938409801, 'f1-score': 0.33327418076992826, 'support': 224743}, 'weighted avg': {'precision': 0.4011843322479287, 'recall': 0.3806881638137784, 'f1-score': 0.3338714027448621, 'support': 224743}}
[[ 4756 40265 29562]
 [ 3385 40506 30295]
 [ 2538 33141 40295]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0908155
{'0': {'precision': 0.44338198288877706, 'recall': 0.06914956241905734, 'f1-score': 0.1196401290103548, 'support': 25481}, '1': {'precision': 0.3699611163065413, 'recall': 0.5729476332037503, 'f1-score': 0.4496052159349204, 'support': 26238}, '2': {'precision': 0.401141670991178, 'recall': 0.5123596381784155, 'f1-score': 0.44998031057921145, 'support': 25648}, 'accuracy': 0.38693499812581594, 'macro avg': {'precision': 0.4048282567288321, 'recall': 0.3848189446004077, 'f1-score': 0.3397418851748289, 'support': 77367}, 'weighted avg': {'precision': 0.40447914037279065, 'recall': 0.38693499812581594, 'f1-score': 0.34105480099718105, 'support': 77367}}
[[ 1762 14014  9705]
 [ 1292 15033  9913]
 [  920 11587 13141]]
training model: results/PCAR/W3/deepVOL_L2/h100
Epoch 1/50
878/878 - 22s - loss: 3.3041 - accuracy100: 0.3665 - val_loss: 3.3125 - val_accuracy100: 0.3539 - 22s/epoch - 25ms/step
Epoch 2/50
878/878 - 19s - loss: 3.2683 - accuracy100: 0.3818 - val_loss: 3.3108 - val_accuracy100: 0.3678 - 19s/epoch - 22ms/step
Epoch 3/50
878/878 - 19s - loss: 3.2555 - accuracy100: 0.3895 - val_loss: 3.3005 - val_accuracy100: 0.3692 - 19s/epoch - 21ms/step
Epoch 4/50
878/878 - 19s - loss: 3.2493 - accuracy100: 0.3923 - val_loss: 3.2985 - val_accuracy100: 0.3734 - 19s/epoch - 21ms/step
Epoch 5/50
878/878 - 19s - loss: 3.2450 - accuracy100: 0.3946 - val_loss: 3.2925 - val_accuracy100: 0.3679 - 19s/epoch - 21ms/step
Epoch 6/50
878/878 - 19s - loss: 3.2397 - accuracy100: 0.3985 - val_loss: 3.2927 - val_accuracy100: 0.3727 - 19s/epoch - 21ms/step
Epoch 7/50
878/878 - 19s - loss: 3.2360 - accuracy100: 0.3999 - val_loss: 3.2969 - val_accuracy100: 0.3721 - 19s/epoch - 21ms/step
Epoch 8/50
878/878 - 20s - loss: 3.2318 - accuracy100: 0.4026 - val_loss: 3.3027 - val_accuracy100: 0.3700 - 20s/epoch - 22ms/step
Epoch 9/50
878/878 - 19s - loss: 3.2302 - accuracy100: 0.4036 - val_loss: 3.2991 - val_accuracy100: 0.3688 - 19s/epoch - 21ms/step
Epoch 10/50
878/878 - 19s - loss: 3.2270 - accuracy100: 0.4047 - val_loss: 3.3043 - val_accuracy100: 0.3686 - 19s/epoch - 21ms/step
Epoch 11/50
878/878 - 19s - loss: 3.2236 - accuracy100: 0.4063 - val_loss: 3.3073 - val_accuracy100: 0.3699 - 19s/epoch - 21ms/step
Epoch 12/50
878/878 - 19s - loss: 3.2213 - accuracy100: 0.4083 - val_loss: 3.3115 - val_accuracy100: 0.3688 - 19s/epoch - 21ms/step
Epoch 13/50
878/878 - 19s - loss: 3.2185 - accuracy100: 0.4109 - val_loss: 3.3196 - val_accuracy100: 0.3671 - 19s/epoch - 21ms/step
Epoch 14/50
878/878 - 19s - loss: 3.2148 - accuracy100: 0.4124 - val_loss: 3.3181 - val_accuracy100: 0.3696 - 19s/epoch - 21ms/step
Epoch 15/50
878/878 - 19s - loss: 3.2124 - accuracy100: 0.4123 - val_loss: 3.3166 - val_accuracy100: 0.3678 - 19s/epoch - 21ms/step
testing model: results/PCAR/W3/deepVOL_L2/h100
Evaluating performance on  test set...
2282/2282 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1069436
{'0': {'precision': 0.4028575243690746, 'recall': 0.030343260014683845, 'f1-score': 0.05643577320937541, 'support': 198858}, '1': {'precision': 0.3307110484922771, 'recall': 0.8055173366340316, 'f1-score': 0.4689083400206263, 'support': 188243}, '2': {'precision': 0.4024848205156048, 'recall': 0.2259032779058783, 'f1-score': 0.2893837120411184, 'support': 196894}, 'accuracy': 0.3461433745151928, 'macro avg': {'precision': 0.3786844644589855, 'recall': 0.3539212915181979, 'f1-score': 0.27157594175704003, 'support': 583995}, 'weighted avg': {'precision': 0.3794764128681181, 'recall': 0.3461433745151928, 'f1-score': 0.26792923610304314, 'support': 583995}}
[[  6034 158833  33991]
 [  4569 151633  32041]
 [  4375 148040  44479]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0998453
{'0': {'precision': 0.44389544150462223, 'recall': 0.037276474997323054, 'f1-score': 0.06877731953671004, 'support': 74712}, '1': {'precision': 0.3492379058979457, 'recall': 0.7769111182588185, 'f1-score': 0.48186662011753656, 'support': 74616}, '2': {'precision': 0.39958840679128793, 'recall': 0.2780613936219585, 'f1-score': 0.32792781522198067, 'support': 75415}, 'accuracy': 0.3636375771436708, 'macro avg': {'precision': 0.39757391806461867, 'recall': 0.36408299562603336, 'f1-score': 0.2928572516254091, 'support': 224743}, 'weighted avg': {'precision': 0.39760086636887215, 'recall': 0.3636375771436708, 'f1-score': 0.2928862167403766, 'support': 224743}}
[[ 2785 55268 16659]
 [ 1796 57970 14850]
 [ 1693 52752 20970]]
Evaluating performance on  val set...
303/303 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.097822
{'0': {'precision': 0.40222984562607206, 'recall': 0.03732590529247911, 'f1-score': 0.06831257737965188, 'support': 25130}, '1': {'precision': 0.3617605898214834, 'recall': 0.7891954279757251, 'f1-score': 0.4961089721835394, 'support': 26859}, '2': {'precision': 0.3920686089653914, 'recall': 0.2539995271494996, 'f1-score': 0.3082809249384251, 'support': 25378}, 'accuracy': 0.36942107099926325, 'macro avg': {'precision': 0.38535301480431566, 'recall': 0.36017362013923454, 'f1-score': 0.2909008248338721, 'support': 77367}, 'weighted avg': {'precision': 0.3848472974384701, 'recall': 0.36942107099926325, 'f1-score': 0.2955425344981153, 'support': 77367}}
[[  938 19090  5102]
 [  769 21197  4893]
 [  625 18307  6446]]
training model: results/PCAR/W3/deepVOL_L2/h200
Epoch 1/50
878/878 - 22s - loss: 3.3059 - accuracy200: 0.3731 - val_loss: 3.3969 - val_accuracy200: 0.3253 - 22s/epoch - 25ms/step
Epoch 2/50
878/878 - 19s - loss: 3.2743 - accuracy200: 0.3776 - val_loss: 3.4069 - val_accuracy200: 0.3233 - 19s/epoch - 22ms/step
Epoch 3/50
878/878 - 20s - loss: 3.2593 - accuracy200: 0.3870 - val_loss: 3.3905 - val_accuracy200: 0.3239 - 20s/epoch - 22ms/step
Epoch 4/50
878/878 - 19s - loss: 3.2527 - accuracy200: 0.3884 - val_loss: 3.3939 - val_accuracy200: 0.3249 - 19s/epoch - 22ms/step
Epoch 5/50
878/878 - 19s - loss: 3.2489 - accuracy200: 0.3907 - val_loss: 3.3980 - val_accuracy200: 0.3246 - 19s/epoch - 21ms/step
Epoch 6/50
878/878 - 19s - loss: 3.2436 - accuracy200: 0.3930 - val_loss: 3.3762 - val_accuracy200: 0.3306 - 19s/epoch - 21ms/step
Epoch 7/50
878/878 - 19s - loss: 3.2379 - accuracy200: 0.3949 - val_loss: 3.3919 - val_accuracy200: 0.3278 - 19s/epoch - 22ms/step
Epoch 8/50
878/878 - 19s - loss: 3.2319 - accuracy200: 0.3986 - val_loss: 3.3921 - val_accuracy200: 0.3326 - 19s/epoch - 22ms/step
Epoch 9/50
878/878 - 20s - loss: 3.2297 - accuracy200: 0.3999 - val_loss: 3.4060 - val_accuracy200: 0.3291 - 20s/epoch - 23ms/step
Epoch 10/50
878/878 - 20s - loss: 3.2288 - accuracy200: 0.4005 - val_loss: 3.4140 - val_accuracy200: 0.3270 - 20s/epoch - 23ms/step
Epoch 11/50
878/878 - 19s - loss: 3.2269 - accuracy200: 0.4010 - val_loss: 3.4150 - val_accuracy200: 0.3260 - 19s/epoch - 22ms/step
Epoch 12/50
878/878 - 19s - loss: 3.2220 - accuracy200: 0.4023 - val_loss: 3.4154 - val_accuracy200: 0.3272 - 19s/epoch - 21ms/step
Epoch 13/50
878/878 - 19s - loss: 3.2181 - accuracy200: 0.4055 - val_loss: 3.4096 - val_accuracy200: 0.3309 - 19s/epoch - 22ms/step
Epoch 14/50
878/878 - 19s - loss: 3.2146 - accuracy200: 0.4072 - val_loss: 3.4200 - val_accuracy200: 0.3285 - 19s/epoch - 21ms/step
Epoch 15/50
878/878 - 19s - loss: 3.2116 - accuracy200: 0.4088 - val_loss: 3.4163 - val_accuracy200: 0.3304 - 19s/epoch - 21ms/step
Epoch 16/50
878/878 - 19s - loss: 3.2082 - accuracy200: 0.4103 - val_loss: 3.4084 - val_accuracy200: 0.3333 - 19s/epoch - 21ms/step
testing model: results/PCAR/W3/deepVOL_L2/h200
Evaluating performance on  test set...
2282/2282 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.151605
{'0': {'precision': 0.3593656133605671, 'recall': 0.014073373516084864, 'f1-score': 0.027086012352163444, 'support': 212529}, '1': {'precision': 0.28433011436196926, 'recall': 0.9612404040894041, 'f1-score': 0.43885045443094395, 'support': 164914}, '2': {'precision': 0.4012345679012346, 'recall': 0.035245361942755335, 'f1-score': 0.06479866130238189, 'support': 206552}, 'accuracy': 0.289031584174522, 'macro avg': {'precision': 0.348310098541257, 'recall': 0.33685304651608144, 'f1-score': 0.17691170936182976, 'support': 583995}, 'weighted avg': {'precision': 0.3529849286225628, 'recall': 0.289031584174522, 'f1-score': 0.1567024376074234, 'support': 583995}}
[[  2991 203411   6127]
 [  1655 158522   4737]
 [  3677 195595   7280]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.117542
{'0': {'precision': 0.4076586763153927, 'recall': 0.036179721159249646, 'f1-score': 0.06646102419781003, 'support': 74738}, '1': {'precision': 0.33607599778164504, 'recall': 0.9510248258134344, 'f1-score': 0.49664581265300506, 'support': 73915}, '2': {'precision': 0.39436619718309857, 'recall': 0.04636614535418583, 'f1-score': 0.08297662166611788, 'support': 76090}, 'accuracy': 0.3405089368745634, 'macro avg': {'precision': 0.3793669570933788, 'recall': 0.3445235641089566, 'f1-score': 0.21536115283897764, 'support': 224743}, 'weighted avg': {'precision': 0.3796157187104919, 'recall': 0.3405089368745634, 'f1-score': 0.2135347059143898, 'support': 224743}}
[[ 2704 69066  2968]
 [ 1170 70295  2450]
 [ 2759 69803  3528]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1275882
{'0': {'precision': 0.3790849673202614, 'recall': 0.02210871388274758, 'f1-score': 0.041780723238726405, 'support': 26234}, '1': {'precision': 0.3264343222373095, 'recall': 0.9546730846369835, 'f1-score': 0.48651355798812335, 'support': 24930}, '2': {'precision': 0.3671448087431694, 'recall': 0.04102583673625158, 'f1-score': 0.07380453812090214, 'support': 26203}, 'accuracy': 0.32901624723719414, 'macro avg': {'precision': 0.3575546994335801, 'recall': 0.3392692117519942, 'f1-score': 0.20069960644925064, 'support': 77367}, 'weighted avg': {'precision': 0.3580753823924041, 'recall': 0.32901624723719414, 'f1-score': 0.19593313436569418, 'support': 77367}}
[[  580 24652  1002]
 [  279 23800   851]
 [  671 24457  1075]]
training model: results/PCAR/W3/deepVOL_L2/h300
Epoch 1/50
878/878 - 22s - loss: 3.3041 - accuracy300: 0.3671 - val_loss: 3.3562 - val_accuracy300: 0.3434 - 22s/epoch - 26ms/step
Epoch 2/50
878/878 - 20s - loss: 3.2745 - accuracy300: 0.3752 - val_loss: 3.3399 - val_accuracy300: 0.3472 - 20s/epoch - 22ms/step
Epoch 3/50
878/878 - 19s - loss: 3.2583 - accuracy300: 0.3835 - val_loss: 3.3389 - val_accuracy300: 0.3561 - 19s/epoch - 22ms/step
Epoch 4/50
878/878 - 20s - loss: 3.2551 - accuracy300: 0.3856 - val_loss: 3.3400 - val_accuracy300: 0.3450 - 20s/epoch - 23ms/step
Epoch 5/50
878/878 - 19s - loss: 3.2490 - accuracy300: 0.3868 - val_loss: 3.3451 - val_accuracy300: 0.3443 - 19s/epoch - 22ms/step
Epoch 6/50
878/878 - 20s - loss: 3.2451 - accuracy300: 0.3901 - val_loss: 3.3392 - val_accuracy300: 0.3491 - 20s/epoch - 22ms/step
Epoch 7/50
878/878 - 20s - loss: 3.2406 - accuracy300: 0.3931 - val_loss: 3.3451 - val_accuracy300: 0.3492 - 20s/epoch - 22ms/step
Epoch 8/50
878/878 - 20s - loss: 3.2378 - accuracy300: 0.3950 - val_loss: 3.3430 - val_accuracy300: 0.3523 - 20s/epoch - 22ms/step
Epoch 9/50
878/878 - 21s - loss: 3.2344 - accuracy300: 0.3971 - val_loss: 3.3482 - val_accuracy300: 0.3515 - 21s/epoch - 24ms/step
Epoch 10/50
878/878 - 20s - loss: 3.2328 - accuracy300: 0.3992 - val_loss: 3.3505 - val_accuracy300: 0.3480 - 20s/epoch - 22ms/step
Epoch 11/50
878/878 - 19s - loss: 3.2287 - accuracy300: 0.4017 - val_loss: 3.3453 - val_accuracy300: 0.3483 - 19s/epoch - 22ms/step
Epoch 12/50
878/878 - 19s - loss: 3.2256 - accuracy300: 0.4020 - val_loss: 3.3484 - val_accuracy300: 0.3498 - 19s/epoch - 21ms/step
Epoch 13/50
878/878 - 20s - loss: 3.2235 - accuracy300: 0.4026 - val_loss: 3.3503 - val_accuracy300: 0.3496 - 20s/epoch - 23ms/step
testing model: results/PCAR/W3/deepVOL_L2/h300
Evaluating performance on  test set...
2282/2282 - 23s - 23s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1094661
{'0': {'precision': 0.3236014144528062, 'recall': 0.018363209779991355, 'f1-score': 0.03475424203325462, 'support': 194356}, '1': {'precision': 0.3650086460749443, 'recall': 0.82500506465464, 'f1-score': 0.5061017010803012, 'support': 202383}, '2': {'precision': 0.37026650394259647, 'recall': 0.2284466185329175, 'f1-score': 0.2825598023706277, 'support': 187256}, 'accuracy': 0.3652668259146054, 'macro avg': {'precision': 0.352958854823449, 'recall': 0.35727163098918296, 'f1-score': 0.2744719151613945, 'support': 583995}, 'weighted avg': {'precision': 0.35291405883312343, 'recall': 0.3652668259146054, 'f1-score': 0.2775573324892578, 'support': 583995}}
[[  3569 150403  40384]
 [  3045 166967  32371]
 [  4415 140063  42778]]
Evaluating performance on  train set...
878/878 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1059687
{'0': {'precision': 0.3722103332314277, 'recall': 0.03276416528747696, 'f1-score': 0.06022680896847677, 'support': 74319}, '1': {'precision': 0.36091547108875227, 'recall': 0.7831565612323284, 'f1-score': 0.4941180472001734, 'support': 74201}, '2': {'precision': 0.3849381895752828, 'recall': 0.2888235834328221, 'f1-score': 0.3300253346725231, 'support': 76223}, 'accuracy': 0.36735738154247294, 'macro avg': {'precision': 0.3726879979651543, 'recall': 0.36824810331754243, 'f1-score': 0.2947900636137244, 'support': 224743}, 'weighted avg': {'precision': 0.372797961447875, 'recall': 0.36735738154247294, 'f1-score': 0.29498391727783296, 'support': 224743}}
[[ 2435 51142 20742]
 [ 1656 58111 14434]
 [ 2451 51757 22015]]
Evaluating performance on  val set...
303/303 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1129693
{'0': {'precision': 0.363039912520503, 'recall': 0.02578841075034954, 'f1-score': 0.04815607208905972, 'support': 25748}, '1': {'precision': 0.35678565866657436, 'recall': 0.7960696498204702, 'f1-score': 0.4927352674090713, 'support': 25901}, '2': {'precision': 0.3549895757029357, 'recall': 0.24496461622210125, 'f1-score': 0.28988841596686993, 'support': 25718}, 'accuracy': 0.3565215143407396, 'macro avg': {'precision': 0.3582717156300044, 'recall': 0.3556075589309737, 'f1-score': 0.2769265851550003, 'support': 77367}, 'weighted avg': {'precision': 0.35827004951244007, 'recall': 0.3565215143407396, 'f1-score': 0.27734833956528526, 'support': 77367}}
[[  664 18418  6666]
 [  501 20619  4781]
 [  664 18754  6300]]
training model: results/PCAR/W3/deepVOL_L2/h500
Epoch 1/50
878/878 - 22s - loss: 3.3053 - accuracy500: 0.3649 - val_loss: 3.4122 - val_accuracy500: 0.3312 - 22s/epoch - 25ms/step
Epoch 2/50
878/878 - 20s - loss: 3.2833 - accuracy500: 0.3707 - val_loss: 3.4060 - val_accuracy500: 0.3312 - 20s/epoch - 23ms/step
Epoch 3/50
878/878 - 20s - loss: 3.2702 - accuracy500: 0.3758 - val_loss: 3.4016 - val_accuracy500: 0.3337 - 20s/epoch - 23ms/step
Epoch 4/50
878/878 - 20s - loss: 3.2657 - accuracy500: 0.3776 - val_loss: 3.3991 - val_accuracy500: 0.3364 - 20s/epoch - 23ms/step
Epoch 5/50
878/878 - 20s - loss: 3.2643 - accuracy500: 0.3792 - val_loss: 3.4046 - val_accuracy500: 0.3389 - 20s/epoch - 22ms/step
Epoch 6/50
878/878 - 20s - loss: 3.2618 - accuracy500: 0.3817 - val_loss: 3.3895 - val_accuracy500: 0.3340 - 20s/epoch - 22ms/step
Epoch 7/50
878/878 - 21s - loss: 3.2561 - accuracy500: 0.3839 - val_loss: 3.3797 - val_accuracy500: 0.3391 - 21s/epoch - 23ms/step
Epoch 8/50
878/878 - 20s - loss: 3.2516 - accuracy500: 0.3878 - val_loss: 3.3883 - val_accuracy500: 0.3357 - 20s/epoch - 22ms/step
Epoch 9/50
878/878 - 19s - loss: 3.2475 - accuracy500: 0.3890 - val_loss: 3.3749 - val_accuracy500: 0.3361 - 19s/epoch - 22ms/step
Epoch 10/50
878/878 - 19s - loss: 3.2443 - accuracy500: 0.3899 - val_loss: 3.3688 - val_accuracy500: 0.3378 - 19s/epoch - 22ms/step
Epoch 11/50
878/878 - 19s - loss: 3.2390 - accuracy500: 0.3934 - val_loss: 3.3699 - val_accuracy500: 0.3378 - 19s/epoch - 21ms/step
Epoch 12/50
878/878 - 19s - loss: 3.2379 - accuracy500: 0.3939 - val_loss: 3.3623 - val_accuracy500: 0.3388 - 19s/epoch - 21ms/step
Epoch 13/50
878/878 - 21s - loss: 3.2332 - accuracy500: 0.3959 - val_loss: 3.3692 - val_accuracy500: 0.3420 - 21s/epoch - 24ms/step
Epoch 14/50
878/878 - 19s - loss: 3.2298 - accuracy500: 0.3969 - val_loss: 3.3745 - val_accuracy500: 0.3415 - 19s/epoch - 21ms/step
Epoch 15/50
878/878 - 19s - loss: 3.2272 - accuracy500: 0.3988 - val_loss: 3.3915 - val_accuracy500: 0.3442 - 19s/epoch - 21ms/step
Epoch 16/50
878/878 - 19s - loss: 3.2230 - accuracy500: 0.4023 - val_loss: 3.4059 - val_accuracy500: 0.3441 - 19s/epoch - 21ms/step
Epoch 17/50
878/878 - 19s - loss: 3.2194 - accuracy500: 0.4035 - val_loss: 3.4231 - val_accuracy500: 0.3464 - 19s/epoch - 21ms/step
Epoch 18/50
878/878 - 19s - loss: 3.2157 - accuracy500: 0.4053 - val_loss: 3.4213 - val_accuracy500: 0.3459 - 19s/epoch - 21ms/step
Epoch 19/50
878/878 - 19s - loss: 3.2115 - accuracy500: 0.4077 - val_loss: 3.4396 - val_accuracy500: 0.3473 - 19s/epoch - 22ms/step
Epoch 20/50
878/878 - 19s - loss: 3.2077 - accuracy500: 0.4114 - val_loss: 3.4325 - val_accuracy500: 0.3512 - 19s/epoch - 21ms/step
Epoch 21/50
878/878 - 19s - loss: 3.2036 - accuracy500: 0.4120 - val_loss: 3.4365 - val_accuracy500: 0.3477 - 19s/epoch - 22ms/step
Epoch 22/50
878/878 - 19s - loss: 3.2004 - accuracy500: 0.4134 - val_loss: 3.4496 - val_accuracy500: 0.3478 - 19s/epoch - 21ms/step
testing model: results/PCAR/W3/deepVOL_L2/h500
Evaluating performance on  test set...
2282/2282 - 23s - 23s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1178615
{'0': {'precision': 0.35691823899371067, 'recall': 0.018336488703773822, 'f1-score': 0.034880984965258266, 'support': 198075}, '1': {'precision': 0.348972138723137, 'recall': 0.9650565517104474, 'f1-score': 0.5125882734387562, 'support': 201497}, '2': {'precision': 0.3958057129082801, 'recall': 0.03561377919240008, 'f1-score': 0.0653477069103608, 'support': 184423}, 'accuracy': 0.35044135651846336, 'macro avg': {'precision': 0.36723203020837597, 'recall': 0.33966893986887375, 'f1-score': 0.20427232177145846, 'support': 583995}, 'weighted avg': {'precision': 0.3664570693527494, 'recall': 0.35044135651846336, 'f1-score': 0.20932657057271392, 'support': 583995}}
[[  3632 188922   5521]
 [  2536 194456   4505]
 [  4008 173847   6568]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.114776
{'0': {'precision': 0.3894988066825776, 'recall': 0.033021285779804135, 'f1-score': 0.06088113505514865, 'support': 74134}, '1': {'precision': 0.3388006766498145, 'recall': 0.9506337648327939, 'f1-score': 0.49956066382279163, 'support': 74160}, '2': {'precision': 0.40948525159051474, 'recall': 0.05556645606875172, 'f1-score': 0.09785425520887324, 'support': 76449}, 'accuracy': 0.34348122077217086, 'macro avg': {'precision': 0.3792615783076356, 'recall': 0.34640716889378326, 'f1-score': 0.21943201802893786, 'support': 224743}, 'weighted avg': {'precision': 0.37956822109609517, 'recall': 0.34348122077217086, 'f1-score': 0.21821209493394575, 'support': 224743}}
[[ 2448 67859  3827]
 [ 1362 70499  2299]
 [ 2475 69726  4248]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1226683
{'0': {'precision': 0.3970037453183521, 'recall': 0.024897240164415736, 'f1-score': 0.046856006188529115, 'support': 25545}, '1': {'precision': 0.33574472166276187, 'recall': 0.9565166478004606, 'f1-score': 0.4970285783826542, 'support': 25619}, '2': {'precision': 0.36861051115910726, 'recall': 0.039079494714345686, 'f1-score': 0.07066698871674545, 'support': 26203}, 'accuracy': 0.3381932865433583, 'macro avg': {'precision': 0.3671196593800737, 'recall': 0.34016446089307406, 'f1-score': 0.2048505244293096, 'support': 77367}, 'weighted avg': {'precision': 0.3671023294471505, 'recall': 0.3381932865433583, 'f1-score': 0.20398876695511103, 'support': 77367}}
[[  636 23877  1032]
 [  392 24505   722]
 [  574 24605  1024]]
training model: results/PCAR/W3/deepVOL_L2/h1000
Epoch 1/50
878/878 - 21s - loss: 3.3142 - accuracy1000: 0.3711 - val_loss: 3.4973 - val_accuracy1000: 0.3233 - 21s/epoch - 24ms/step
Epoch 2/50
878/878 - 19s - loss: 3.2892 - accuracy1000: 0.3730 - val_loss: 3.4117 - val_accuracy1000: 0.3348 - 19s/epoch - 21ms/step
Epoch 3/50
878/878 - 20s - loss: 3.2763 - accuracy1000: 0.3780 - val_loss: 3.4354 - val_accuracy1000: 0.3330 - 20s/epoch - 22ms/step
Epoch 4/50
878/878 - 19s - loss: 3.2662 - accuracy1000: 0.3796 - val_loss: 3.4485 - val_accuracy1000: 0.3389 - 19s/epoch - 21ms/step
Epoch 5/50
878/878 - 19s - loss: 3.2652 - accuracy1000: 0.3813 - val_loss: 3.4618 - val_accuracy1000: 0.3317 - 19s/epoch - 21ms/step
Epoch 6/50
878/878 - 19s - loss: 3.2629 - accuracy1000: 0.3823 - val_loss: 3.4472 - val_accuracy1000: 0.3331 - 19s/epoch - 22ms/step
Epoch 7/50
878/878 - 20s - loss: 3.2573 - accuracy1000: 0.3841 - val_loss: 3.4642 - val_accuracy1000: 0.3317 - 20s/epoch - 22ms/step
Epoch 8/50
878/878 - 19s - loss: 3.2523 - accuracy1000: 0.3867 - val_loss: 3.4566 - val_accuracy1000: 0.3352 - 19s/epoch - 21ms/step
Epoch 9/50
878/878 - 19s - loss: 3.2487 - accuracy1000: 0.3886 - val_loss: 3.4588 - val_accuracy1000: 0.3336 - 19s/epoch - 21ms/step
Epoch 10/50
878/878 - 19s - loss: 3.2476 - accuracy1000: 0.3893 - val_loss: 3.4903 - val_accuracy1000: 0.3333 - 19s/epoch - 21ms/step
Epoch 11/50
878/878 - 19s - loss: 3.2435 - accuracy1000: 0.3898 - val_loss: 3.4862 - val_accuracy1000: 0.3327 - 19s/epoch - 21ms/step
Epoch 12/50
878/878 - 19s - loss: 3.2387 - accuracy1000: 0.3929 - val_loss: 3.4846 - val_accuracy1000: 0.3309 - 19s/epoch - 21ms/step
testing model: results/PCAR/W3/deepVOL_L2/h1000
Evaluating performance on  test set...
2282/2282 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1338981
{'0': {'precision': 0.3324693146298696, 'recall': 0.021081585397098562, 'f1-score': 0.03964905900536412, 'support': 206863}, '1': {'precision': 0.34251613081886406, 'recall': 0.9483813584014477, 'f1-score': 0.5032714311290506, 'support': 195627}, '2': {'precision': 0.4030055112449937, 'recall': 0.06486322690834963, 'f1-score': 0.11174175912831366, 'support': 181505}, 'accuracy': 0.345316312639663, 'macro avg': {'precision': 0.3593303188979091, 'recall': 0.3447753902356319, 'f1-score': 0.21822074975424277, 'support': 583995}, 'weighted avg': {'precision': 0.35775737510510064, 'recall': 0.345316312639663, 'f1-score': 0.21735989441877754, 'support': 583995}}
[[  4361 191994  10508]
 [  3166 185529   6932]
 [  5590 164142  11773]]
Evaluating performance on  train set...
878/878 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1289883
{'0': {'precision': 0.36538461538461536, 'recall': 0.04450072851559841, 'f1-score': 0.07933868246318934, 'support': 73437}, '1': {'precision': 0.34060165656305297, 'recall': 0.9259898121445705, 'f1-score': 0.49801956158565536, 'support': 74206}, '2': {'precision': 0.4135600455321571, 'recall': 0.07539559014267186, 'f1-score': 0.12753960243977358, 'support': 77100}, 'accuracy': 0.34615093684786624, 'macro avg': {'precision': 0.3731821058266085, 'recall': 0.3486287102676136, 'f1-score': 0.23496594882953944, 'support': 224743}, 'weighted avg': {'precision': 0.37372873031617104, 'recall': 0.34615093684786624, 'f1-score': 0.23411513488376023, 'support': 224743}}
[[ 3268 65251  4918]
 [ 2167 68714  3325]
 [ 3509 67778  5813]]
Evaluating performance on  val set...
303/303 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1378882
{'0': {'precision': 0.39990557129367327, 'recall': 0.03286384976525822, 'f1-score': 0.060736438277580594, 'support': 25773}, '1': {'precision': 0.32982461111268524, 'recall': 0.9337424297116271, 'f1-score': 0.48746322721134017, 'support': 24933}, '2': {'precision': 0.3641432554149689, 'recall': 0.06368853381343535, 'f1-score': 0.10841527263440173, 'support': 26661}, 'accuracy': 0.33381157340985174, 'macro avg': {'precision': 0.3646244792737758, 'recall': 0.3434316044301069, 'f1-score': 0.2188716460411075, 'support': 77367}, 'weighted avg': {'precision': 0.3649967899807787, 'recall': 0.33381157340985174, 'f1-score': 0.21468766336415027, 'support': 77367}}
[[  847 23169  1757]
 [  444 23281  1208]
 [  827 24136  1698]]
training model: results/PCAR/W3/deepVOL_L3/h10
Epoch 1/50
878/878 - 33s - loss: 3.2945 - accuracy10: 0.3730 - val_loss: 3.2696 - val_accuracy10: 0.3796 - 33s/epoch - 38ms/step
Epoch 2/50
878/878 - 30s - loss: 3.2163 - accuracy10: 0.4077 - val_loss: 3.2105 - val_accuracy10: 0.4171 - 30s/epoch - 34ms/step
Epoch 3/50
878/878 - 31s - loss: 3.1220 - accuracy10: 0.4530 - val_loss: 3.1301 - val_accuracy10: 0.4548 - 31s/epoch - 35ms/step
Epoch 4/50
878/878 - 31s - loss: 3.0571 - accuracy10: 0.4782 - val_loss: 3.1259 - val_accuracy10: 0.4571 - 31s/epoch - 35ms/step
Epoch 5/50
878/878 - 30s - loss: 3.0300 - accuracy10: 0.4873 - val_loss: 3.1348 - val_accuracy10: 0.4570 - 30s/epoch - 34ms/step
Epoch 6/50
878/878 - 32s - loss: 3.0094 - accuracy10: 0.4952 - val_loss: 3.0738 - val_accuracy10: 0.4780 - 32s/epoch - 37ms/step
Epoch 7/50
878/878 - 33s - loss: 2.9915 - accuracy10: 0.4999 - val_loss: 3.0654 - val_accuracy10: 0.4822 - 33s/epoch - 37ms/step
Epoch 8/50
878/878 - 30s - loss: 2.9760 - accuracy10: 0.5043 - val_loss: 3.0451 - val_accuracy10: 0.4866 - 30s/epoch - 35ms/step
Epoch 9/50
878/878 - 30s - loss: 2.9622 - accuracy10: 0.5088 - val_loss: 3.0587 - val_accuracy10: 0.4817 - 30s/epoch - 35ms/step
Epoch 10/50
878/878 - 30s - loss: 2.9531 - accuracy10: 0.5113 - val_loss: 3.0415 - val_accuracy10: 0.4884 - 30s/epoch - 34ms/step
Epoch 11/50
878/878 - 29s - loss: 2.9435 - accuracy10: 0.5141 - val_loss: 3.0350 - val_accuracy10: 0.4901 - 29s/epoch - 34ms/step
Epoch 12/50
878/878 - 30s - loss: 2.9363 - accuracy10: 0.5180 - val_loss: 3.0295 - val_accuracy10: 0.4924 - 30s/epoch - 34ms/step
Epoch 13/50
878/878 - 30s - loss: 2.9295 - accuracy10: 0.5184 - val_loss: 3.0271 - val_accuracy10: 0.4933 - 30s/epoch - 34ms/step
Epoch 14/50
878/878 - 29s - loss: 2.9232 - accuracy10: 0.5204 - val_loss: 3.0152 - val_accuracy10: 0.4968 - 29s/epoch - 33ms/step
Epoch 15/50
878/878 - 30s - loss: 2.9172 - accuracy10: 0.5214 - val_loss: 3.0140 - val_accuracy10: 0.4967 - 30s/epoch - 34ms/step
Epoch 16/50
878/878 - 29s - loss: 2.9104 - accuracy10: 0.5231 - val_loss: 3.0151 - val_accuracy10: 0.4958 - 29s/epoch - 34ms/step
Epoch 17/50
878/878 - 29s - loss: 2.9072 - accuracy10: 0.5241 - val_loss: 3.0140 - val_accuracy10: 0.4964 - 29s/epoch - 33ms/step
Epoch 18/50
878/878 - 29s - loss: 2.9014 - accuracy10: 0.5255 - val_loss: 3.0130 - val_accuracy10: 0.4985 - 29s/epoch - 34ms/step
Epoch 19/50
878/878 - 30s - loss: 2.8993 - accuracy10: 0.5258 - val_loss: 3.0076 - val_accuracy10: 0.4987 - 30s/epoch - 35ms/step
Epoch 20/50
878/878 - 30s - loss: 2.8945 - accuracy10: 0.5267 - val_loss: 3.0124 - val_accuracy10: 0.4980 - 30s/epoch - 34ms/step
Epoch 21/50
878/878 - 30s - loss: 2.8905 - accuracy10: 0.5284 - val_loss: 3.0249 - val_accuracy10: 0.4941 - 30s/epoch - 34ms/step
Epoch 22/50
878/878 - 30s - loss: 2.8860 - accuracy10: 0.5291 - val_loss: 3.0201 - val_accuracy10: 0.4938 - 30s/epoch - 34ms/step
Epoch 23/50
878/878 - 30s - loss: 2.8840 - accuracy10: 0.5301 - val_loss: 3.0191 - val_accuracy10: 0.4966 - 30s/epoch - 35ms/step
Epoch 24/50
878/878 - 31s - loss: 2.8800 - accuracy10: 0.5316 - val_loss: 3.0221 - val_accuracy10: 0.4945 - 31s/epoch - 35ms/step
Epoch 25/50
878/878 - 31s - loss: 2.8759 - accuracy10: 0.5323 - val_loss: 3.0287 - val_accuracy10: 0.4939 - 31s/epoch - 35ms/step
Epoch 26/50
878/878 - 30s - loss: 2.8721 - accuracy10: 0.5334 - val_loss: 3.0327 - val_accuracy10: 0.4936 - 30s/epoch - 34ms/step
Epoch 27/50
878/878 - 31s - loss: 2.8700 - accuracy10: 0.5336 - val_loss: 3.0280 - val_accuracy10: 0.4930 - 31s/epoch - 35ms/step
Epoch 28/50
878/878 - 30s - loss: 2.8663 - accuracy10: 0.5350 - val_loss: 3.0264 - val_accuracy10: 0.4929 - 30s/epoch - 34ms/step
Epoch 29/50
878/878 - 29s - loss: 2.8642 - accuracy10: 0.5346 - val_loss: 3.0204 - val_accuracy10: 0.4955 - 29s/epoch - 34ms/step
testing model: results/PCAR/W3/deepVOL_L3/h10
Evaluating performance on  test set...
2282/2282 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0006433
{'0': {'precision': 0.4861187818059884, 'recall': 0.525426258254673, 'f1-score': 0.5050087983750542, 'support': 187621}, '1': {'precision': 0.5497656659047084, 'recall': 0.4155814694326727, 'f1-score': 0.4733477003595422, 'support': 207182}, '2': {'precision': 0.4781667846599789, 'recall': 0.5676297095014589, 'f1-score': 0.5190716828467233, 'support': 189192}, 'accuracy': 0.5001292819287836, 'macro avg': {'precision': 0.5046837441235585, 'recall': 0.5028791457296015, 'f1-score': 0.49914272719377323, 'support': 583995}, 'weighted avg': {'precision': 0.5061224367983995, 'recall': 0.5001292819287836, 'f1-score': 0.49833232962089397, 'support': 583995}}
[[ 98581  36321  52719]
 [ 56602  86101  64479]
 [ 47609  34192 107391]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9870976
{'0': {'precision': 0.5032373768675906, 'recall': 0.5133579057816998, 'f1-score': 0.5082472647848121, 'support': 74338}, '1': {'precision': 0.5687547746371275, 'recall': 0.421335597057159, 'f1-score': 0.48407022106631986, 'support': 74214}, '2': {'precision': 0.48334965719882467, 'recall': 0.5958971532070717, 'f1-score': 0.5337549890373435, 'support': 76191}, 'accuracy': 0.5109525102005402, 'macro avg': {'precision': 0.5184472695678476, 'recall': 0.5101968853486435, 'f1-score': 0.5086908249628251, 'support': 224743}, 'weighted avg': {'precision': 0.5181301339669684, 'recall': 0.5109525102005402, 'f1-score': 0.508911062527124, 'support': 224743}}
[[38162 11250 24926]
 [19341 31269 23604]
 [18330 12459 45402]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0016252
{'0': {'precision': 0.4926299752428109, 'recall': 0.5177949477561151, 'f1-score': 0.5048990904477495, 'support': 24979}, '1': {'precision': 0.5472538597823335, 'recall': 0.4001998963500407, 'f1-score': 0.46231478115845964, 'support': 27014}, '2': {'precision': 0.47351468571610805, 'recall': 0.5851659178686844, 'f1-score': 0.5234527859547691, 'support': 25374}, 'accuracy': 0.4988302506236509, 'macro avg': {'precision': 0.5044661735804176, 'recall': 0.5010535873249468, 'f1-score': 0.49688888585365937, 'support': 77367}, 'weighted avg': {'precision': 0.5054336028941364, 'recall': 0.4988302506236509, 'f1-score': 0.4961150990645272, 'support': 77367}}
[[12934  4386  7659]
 [ 7353 10811  8850]
 [ 5968  4558 14848]]
training model: results/PCAR/W3/deepVOL_L3/h20
Epoch 1/50
878/878 - 33s - loss: 3.3137 - accuracy20: 0.3626 - val_loss: 3.3044 - val_accuracy20: 0.3437 - 33s/epoch - 38ms/step
Epoch 2/50
878/878 - 31s - loss: 3.2714 - accuracy20: 0.3821 - val_loss: 3.2458 - val_accuracy20: 0.3989 - 31s/epoch - 35ms/step
Epoch 3/50
878/878 - 33s - loss: 3.2084 - accuracy20: 0.4171 - val_loss: 3.2224 - val_accuracy20: 0.4069 - 33s/epoch - 37ms/step
Epoch 4/50
878/878 - 30s - loss: 3.1551 - accuracy20: 0.4417 - val_loss: 3.2321 - val_accuracy20: 0.4092 - 30s/epoch - 35ms/step
Epoch 5/50
878/878 - 30s - loss: 3.1319 - accuracy20: 0.4518 - val_loss: 3.2274 - val_accuracy20: 0.4124 - 30s/epoch - 35ms/step
Epoch 6/50
878/878 - 29s - loss: 3.1165 - accuracy20: 0.4587 - val_loss: 3.1851 - val_accuracy20: 0.4260 - 29s/epoch - 34ms/step
Epoch 7/50
878/878 - 29s - loss: 3.1031 - accuracy20: 0.4640 - val_loss: 3.1880 - val_accuracy20: 0.4265 - 29s/epoch - 33ms/step
Epoch 8/50
878/878 - 30s - loss: 3.0933 - accuracy20: 0.4670 - val_loss: 3.1794 - val_accuracy20: 0.4365 - 30s/epoch - 34ms/step
Epoch 9/50
878/878 - 32s - loss: 3.0826 - accuracy20: 0.4709 - val_loss: 3.1746 - val_accuracy20: 0.4374 - 32s/epoch - 37ms/step
Epoch 10/50
878/878 - 29s - loss: 3.0741 - accuracy20: 0.4744 - val_loss: 3.1604 - val_accuracy20: 0.4443 - 29s/epoch - 34ms/step
Epoch 11/50
878/878 - 30s - loss: 3.0677 - accuracy20: 0.4766 - val_loss: 3.1675 - val_accuracy20: 0.4420 - 30s/epoch - 34ms/step
Epoch 12/50
878/878 - 31s - loss: 3.0614 - accuracy20: 0.4789 - val_loss: 3.1587 - val_accuracy20: 0.4465 - 31s/epoch - 35ms/step
Epoch 13/50
878/878 - 31s - loss: 3.0568 - accuracy20: 0.4805 - val_loss: 3.1550 - val_accuracy20: 0.4462 - 31s/epoch - 35ms/step
Epoch 14/50
878/878 - 31s - loss: 3.0517 - accuracy20: 0.4809 - val_loss: 3.1519 - val_accuracy20: 0.4472 - 31s/epoch - 35ms/step
Epoch 15/50
878/878 - 31s - loss: 3.0463 - accuracy20: 0.4844 - val_loss: 3.1455 - val_accuracy20: 0.4489 - 31s/epoch - 35ms/step
Epoch 16/50
878/878 - 30s - loss: 3.0424 - accuracy20: 0.4848 - val_loss: 3.1324 - val_accuracy20: 0.4551 - 30s/epoch - 35ms/step
Epoch 17/50
878/878 - 30s - loss: 3.0383 - accuracy20: 0.4860 - val_loss: 3.1403 - val_accuracy20: 0.4548 - 30s/epoch - 35ms/step
Epoch 18/50
878/878 - 31s - loss: 3.0350 - accuracy20: 0.4864 - val_loss: 3.1520 - val_accuracy20: 0.4517 - 31s/epoch - 35ms/step
Epoch 19/50
878/878 - 30s - loss: 3.0309 - accuracy20: 0.4883 - val_loss: 3.1471 - val_accuracy20: 0.4525 - 30s/epoch - 35ms/step
Epoch 20/50
878/878 - 29s - loss: 3.0253 - accuracy20: 0.4893 - val_loss: 3.1460 - val_accuracy20: 0.4530 - 29s/epoch - 34ms/step
Epoch 21/50
878/878 - 29s - loss: 3.0236 - accuracy20: 0.4903 - val_loss: 3.1527 - val_accuracy20: 0.4510 - 29s/epoch - 33ms/step
Epoch 22/50
878/878 - 29s - loss: 3.0204 - accuracy20: 0.4904 - val_loss: 3.1422 - val_accuracy20: 0.4539 - 29s/epoch - 34ms/step
Epoch 23/50
878/878 - 30s - loss: 3.0168 - accuracy20: 0.4917 - val_loss: 3.1371 - val_accuracy20: 0.4541 - 30s/epoch - 34ms/step
Epoch 24/50
878/878 - 29s - loss: 3.0136 - accuracy20: 0.4938 - val_loss: 3.1472 - val_accuracy20: 0.4533 - 29s/epoch - 33ms/step
Epoch 25/50
878/878 - 30s - loss: 3.0104 - accuracy20: 0.4943 - val_loss: 3.1352 - val_accuracy20: 0.4571 - 30s/epoch - 34ms/step
Epoch 26/50
878/878 - 29s - loss: 3.0083 - accuracy20: 0.4953 - val_loss: 3.1404 - val_accuracy20: 0.4552 - 29s/epoch - 33ms/step
testing model: results/PCAR/W3/deepVOL_L3/h20
Evaluating performance on  test set...
2282/2282 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0379399
{'0': {'precision': 0.49628733585916224, 'recall': 0.3421036070525797, 'f1-score': 0.405017943400678, 'support': 190682}, '1': {'precision': 0.47152977124748596, 'recall': 0.3972607561077396, 'f1-score': 0.4312208007684583, 'support': 198887}, '2': {'precision': 0.4386614361104873, 'recall': 0.6429952784092663, 'f1-score': 0.5215281862591726, 'support': 194426}, 'accuracy': 0.4610621666281389, 'macro avg': {'precision': 0.46882618107237845, 'recall': 0.46078654718986184, 'f1-score': 0.45258897680943627, 'support': 583995}, 'weighted avg': {'precision': 0.4686707793176536, 'recall': 0.4610621666281389, 'f1-score': 0.45273072890622407, 'support': 583995}}
[[ 65233  49255  76194]
 [ 36094  79010  83783]
 [ 30115  39296 125015]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0335529
{'0': {'precision': 0.5025912106135987, 'recall': 0.32618932300075343, 'f1-score': 0.39561712681939826, 'support': 74328}, '1': {'precision': 0.4816268637023354, 'recall': 0.3940358925920928, 'f1-score': 0.43345059446943046, 'support': 74110}, '2': {'precision': 0.4388242096814561, 'recall': 0.6663652447414979, 'f1-score': 0.5291711764216135, 'support': 76305}, 'accuracy': 0.4640589473309514, 'macro avg': {'precision': 0.47434742799913004, 'recall': 0.4621968201114481, 'f1-score': 0.45274629923681403, 'support': 224743}, 'weighted avg': {'precision': 0.4740278793609196, 'recall': 0.4640589473309514, 'f1-score': 0.45343730383243497, 'support': 224743}}
[[24245 17283 32800]
 [12684 29202 32224]
 [11311 14147 50847]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0433661
{'0': {'precision': 0.5008285984848485, 'recall': 0.33570040068235013, 'f1-score': 0.4019666057050566, 'support': 25207}, '1': {'precision': 0.4665418811417876, 'recall': 0.37615544236936427, 'f1-score': 0.4165013054830287, 'support': 26505}, '2': {'precision': 0.42881256233855913, 'recall': 0.653556811537712, 'f1-score': 0.5178516276484032, 'support': 25655}, 'accuracy': 0.4549614176586917, 'macro avg': {'precision': 0.4653943473217317, 'recall': 0.4551375515298088, 'f1-score': 0.44543984627882943, 'support': 77367}, 'weighted avg': {'precision': 0.4652017698562228, 'recall': 0.4549614176586917, 'f1-score': 0.4453736456002536, 'support': 77367}}
[[ 8462  6217 10528]
 [ 4729  9970 11806]
 [ 3705  5183 16767]]
training model: results/PCAR/W3/deepVOL_L3/h30
Epoch 1/50
878/878 - 34s - loss: 3.3143 - accuracy30: 0.3595 - val_loss: 3.3063 - val_accuracy30: 0.3513 - 34s/epoch - 39ms/step
Epoch 2/50
878/878 - 31s - loss: 3.2747 - accuracy30: 0.3760 - val_loss: 3.2759 - val_accuracy30: 0.3740 - 31s/epoch - 36ms/step
Epoch 3/50
878/878 - 30s - loss: 3.2343 - accuracy30: 0.4037 - val_loss: 3.2368 - val_accuracy30: 0.3980 - 30s/epoch - 34ms/step
Epoch 4/50
878/878 - 30s - loss: 3.2037 - accuracy30: 0.4189 - val_loss: 3.2251 - val_accuracy30: 0.4076 - 30s/epoch - 34ms/step
Epoch 5/50
878/878 - 30s - loss: 3.1853 - accuracy30: 0.4290 - val_loss: 3.2171 - val_accuracy30: 0.4125 - 30s/epoch - 34ms/step
Epoch 6/50
878/878 - 30s - loss: 3.1754 - accuracy30: 0.4350 - val_loss: 3.2098 - val_accuracy30: 0.4162 - 30s/epoch - 34ms/step
Epoch 7/50
878/878 - 30s - loss: 3.1656 - accuracy30: 0.4383 - val_loss: 3.2000 - val_accuracy30: 0.4202 - 30s/epoch - 34ms/step
Epoch 8/50
878/878 - 29s - loss: 3.1576 - accuracy30: 0.4421 - val_loss: 3.1957 - val_accuracy30: 0.4229 - 29s/epoch - 33ms/step
Epoch 9/50
878/878 - 29s - loss: 3.1511 - accuracy30: 0.4458 - val_loss: 3.2140 - val_accuracy30: 0.4175 - 29s/epoch - 33ms/step
Epoch 10/50
878/878 - 29s - loss: 3.1464 - accuracy30: 0.4462 - val_loss: 3.2030 - val_accuracy30: 0.4192 - 29s/epoch - 33ms/step
Epoch 11/50
878/878 - 29s - loss: 3.1405 - accuracy30: 0.4486 - val_loss: 3.2167 - val_accuracy30: 0.4156 - 29s/epoch - 33ms/step
Epoch 12/50
878/878 - 30s - loss: 3.1358 - accuracy30: 0.4519 - val_loss: 3.1954 - val_accuracy30: 0.4229 - 30s/epoch - 34ms/step
Epoch 13/50
878/878 - 29s - loss: 3.1318 - accuracy30: 0.4530 - val_loss: 3.2364 - val_accuracy30: 0.4077 - 29s/epoch - 33ms/step
Epoch 14/50
878/878 - 29s - loss: 3.1282 - accuracy30: 0.4550 - val_loss: 3.2487 - val_accuracy30: 0.4068 - 29s/epoch - 33ms/step
Epoch 15/50
878/878 - 29s - loss: 3.1240 - accuracy30: 0.4560 - val_loss: 3.2321 - val_accuracy30: 0.4126 - 29s/epoch - 33ms/step
Epoch 16/50
878/878 - 29s - loss: 3.1192 - accuracy30: 0.4571 - val_loss: 3.2349 - val_accuracy30: 0.4097 - 29s/epoch - 34ms/step
Epoch 17/50
878/878 - 29s - loss: 3.1157 - accuracy30: 0.4576 - val_loss: 3.2224 - val_accuracy30: 0.4129 - 29s/epoch - 34ms/step
Epoch 18/50
878/878 - 30s - loss: 3.1128 - accuracy30: 0.4602 - val_loss: 3.2338 - val_accuracy30: 0.4115 - 30s/epoch - 34ms/step
Epoch 19/50
878/878 - 30s - loss: 3.1096 - accuracy30: 0.4609 - val_loss: 3.2258 - val_accuracy30: 0.4147 - 30s/epoch - 34ms/step
Epoch 20/50
878/878 - 30s - loss: 3.1062 - accuracy30: 0.4627 - val_loss: 3.2325 - val_accuracy30: 0.4146 - 30s/epoch - 34ms/step
Epoch 21/50
878/878 - 29s - loss: 3.1038 - accuracy30: 0.4632 - val_loss: 3.2406 - val_accuracy30: 0.4119 - 29s/epoch - 33ms/step
Epoch 22/50
878/878 - 29s - loss: 3.0992 - accuracy30: 0.4641 - val_loss: 3.2372 - val_accuracy30: 0.4149 - 29s/epoch - 33ms/step
testing model: results/PCAR/W3/deepVOL_L3/h30
Evaluating performance on  test set...
2282/2282 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0658478
{'0': {'precision': 0.48228207288609976, 'recall': 0.25568631075239007, 'f1-score': 0.33419568288353585, 'support': 194766}, '1': {'precision': 0.3850826011813706, 'recall': 0.4478363088678275, 'f1-score': 0.41409546269540304, 'support': 190554}, '2': {'precision': 0.436790658006954, 'recall': 0.5697042909273939, 'f1-score': 0.4944714573421929, 'support': 198675}, 'accuracy': 0.4252125446279506, 'macro avg': {'precision': 0.43471844402480814, 'recall': 0.42440897018253715, 'f1-score': 0.41425420097371063, 'support': 583995}, 'weighted avg': {'precision': 0.4350903075758878, 'recall': 0.4252125446279506, 'f1-score': 0.414792284109307, 'support': 583995}}
[[ 49799  75344  69623]
 [ 28895  85337  76322]
 [ 24563  60926 113186]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.062967
{'0': {'precision': 0.4898183671826791, 'recall': 0.245300764507504, 'f1-score': 0.3268934646374217, 'support': 74427}, '1': {'precision': 0.4026048673107497, 'recall': 0.44452396062598737, 'f1-score': 0.42252725744245295, 'support': 74059}, '2': {'precision': 0.4285241248817408, 'recall': 0.5939782577337163, 'f1-score': 0.4978648801639947, 'support': 76257}, 'accuracy': 0.42925919828426246, 'macro avg': {'precision': 0.4403157864583899, 'recall': 0.4279343276224026, 'f1-score': 0.4157618674146231, 'support': 224743}, 'weighted avg': {'precision': 0.440281520107763, 'recall': 0.42925919828426246, 'f1-score': 0.41641932437569024, 'support': 224743}}
[[18257 26721 29449]
 [10182 32921 30956]
 [ 8834 22128 45295]]
Evaluating performance on  val set...
303/303 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0649619
{'0': {'precision': 0.4828116588479582, 'recall': 0.24841722063944285, 'f1-score': 0.32804702808621816, 'support': 25272}, '1': {'precision': 0.3998361327324867, 'recall': 0.44283121597096187, 'f1-score': 0.42023681377825617, 'support': 26448}, '2': {'precision': 0.41811131386861317, 'recall': 0.5717627792724296, 'f1-score': 0.4830119073107265, 'support': 25647}, 'accuracy': 0.42206625563870903, 'macro avg': {'precision': 0.4335863684830194, 'recall': 0.4210037386276115, 'f1-score': 0.4104319163917336, 'support': 77367}, 'weighted avg': {'precision': 0.43299834745696136, 'recall': 0.42206625563870903, 'f1-score': 0.41093275080331965, 'support': 77367}}
[[ 6278  9474  9520]
 [ 3848 11712 10888]
 [ 2877  8106 14664]]
training model: results/PCAR/W3/deepVOL_L3/h50
Epoch 1/50
878/878 - 33s - loss: 3.3017 - accuracy50: 0.3691 - val_loss: 3.3308 - val_accuracy50: 0.3390 - 33s/epoch - 38ms/step
Epoch 2/50
878/878 - 35s - loss: 3.2833 - accuracy50: 0.3697 - val_loss: 3.2930 - val_accuracy50: 0.3606 - 35s/epoch - 40ms/step
Epoch 3/50
878/878 - 33s - loss: 3.2642 - accuracy50: 0.3843 - val_loss: 3.2836 - val_accuracy50: 0.3723 - 33s/epoch - 37ms/step
Epoch 4/50
878/878 - 31s - loss: 3.2493 - accuracy50: 0.3933 - val_loss: 3.2828 - val_accuracy50: 0.3757 - 31s/epoch - 35ms/step
Epoch 5/50
878/878 - 31s - loss: 3.2380 - accuracy50: 0.4005 - val_loss: 3.2691 - val_accuracy50: 0.3831 - 31s/epoch - 35ms/step
Epoch 6/50
878/878 - 29s - loss: 3.2226 - accuracy50: 0.4110 - val_loss: 3.2845 - val_accuracy50: 0.3767 - 29s/epoch - 33ms/step
Epoch 7/50
878/878 - 29s - loss: 3.2189 - accuracy50: 0.4136 - val_loss: 3.2722 - val_accuracy50: 0.3785 - 29s/epoch - 33ms/step
Epoch 8/50
878/878 - 29s - loss: 3.2132 - accuracy50: 0.4175 - val_loss: 3.2739 - val_accuracy50: 0.3794 - 29s/epoch - 33ms/step
Epoch 9/50
878/878 - 30s - loss: 3.2072 - accuracy50: 0.4208 - val_loss: 3.2697 - val_accuracy50: 0.3795 - 30s/epoch - 34ms/step
Epoch 10/50
878/878 - 29s - loss: 3.2032 - accuracy50: 0.4230 - val_loss: 3.2690 - val_accuracy50: 0.3841 - 29s/epoch - 33ms/step
Epoch 11/50
878/878 - 29s - loss: 3.1976 - accuracy50: 0.4263 - val_loss: 3.2650 - val_accuracy50: 0.3806 - 29s/epoch - 33ms/step
Epoch 12/50
878/878 - 29s - loss: 3.1945 - accuracy50: 0.4255 - val_loss: 3.2680 - val_accuracy50: 0.3830 - 29s/epoch - 33ms/step
Epoch 13/50
878/878 - 29s - loss: 3.1890 - accuracy50: 0.4289 - val_loss: 3.2573 - val_accuracy50: 0.3872 - 29s/epoch - 33ms/step
Epoch 14/50
878/878 - 29s - loss: 3.1850 - accuracy50: 0.4309 - val_loss: 3.2531 - val_accuracy50: 0.3933 - 29s/epoch - 34ms/step
Epoch 15/50
878/878 - 30s - loss: 3.1823 - accuracy50: 0.4322 - val_loss: 3.2543 - val_accuracy50: 0.3934 - 30s/epoch - 34ms/step
Epoch 16/50
878/878 - 29s - loss: 3.1790 - accuracy50: 0.4337 - val_loss: 3.2453 - val_accuracy50: 0.4009 - 29s/epoch - 33ms/step
Epoch 17/50
878/878 - 30s - loss: 3.1756 - accuracy50: 0.4348 - val_loss: 3.2539 - val_accuracy50: 0.3943 - 30s/epoch - 34ms/step
Epoch 18/50
878/878 - 30s - loss: 3.1719 - accuracy50: 0.4363 - val_loss: 3.2434 - val_accuracy50: 0.4009 - 30s/epoch - 34ms/step
Epoch 19/50
878/878 - 29s - loss: 3.1703 - accuracy50: 0.4373 - val_loss: 3.2457 - val_accuracy50: 0.3998 - 29s/epoch - 33ms/step
Epoch 20/50
878/878 - 29s - loss: 3.1658 - accuracy50: 0.4381 - val_loss: 3.2498 - val_accuracy50: 0.3994 - 29s/epoch - 33ms/step
Epoch 21/50
878/878 - 30s - loss: 3.1632 - accuracy50: 0.4397 - val_loss: 3.2499 - val_accuracy50: 0.3988 - 30s/epoch - 34ms/step
Epoch 22/50
878/878 - 29s - loss: 3.1588 - accuracy50: 0.4418 - val_loss: 3.2537 - val_accuracy50: 0.3986 - 29s/epoch - 33ms/step
Epoch 23/50
878/878 - 29s - loss: 3.1554 - accuracy50: 0.4420 - val_loss: 3.2631 - val_accuracy50: 0.3973 - 29s/epoch - 33ms/step
Epoch 24/50
878/878 - 30s - loss: 3.1542 - accuracy50: 0.4440 - val_loss: 3.2739 - val_accuracy50: 0.3949 - 30s/epoch - 34ms/step
Epoch 25/50
878/878 - 30s - loss: 3.1502 - accuracy50: 0.4448 - val_loss: 3.2823 - val_accuracy50: 0.3945 - 30s/epoch - 34ms/step
Epoch 26/50
878/878 - 30s - loss: 3.1475 - accuracy50: 0.4463 - val_loss: 3.2876 - val_accuracy50: 0.3922 - 30s/epoch - 34ms/step
Epoch 27/50
878/878 - 30s - loss: 3.1449 - accuracy50: 0.4476 - val_loss: 3.2857 - val_accuracy50: 0.3894 - 30s/epoch - 34ms/step
Epoch 28/50
878/878 - 29s - loss: 3.1402 - accuracy50: 0.4507 - val_loss: 3.3040 - val_accuracy50: 0.3901 - 29s/epoch - 33ms/step
testing model: results/PCAR/W3/deepVOL_L3/h50
Evaluating performance on  test set...
2282/2282 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0987313
{'0': {'precision': 0.4590069284064665, 'recall': 0.24722129297631443, 'f1-score': 0.32135868516709487, 'support': 212239}, '1': {'precision': 0.2966714426204148, 'recall': 0.5118158769293335, 'f1-score': 0.3756178999794811, 'support': 157373}, '2': {'precision': 0.4440822669842167, 'recall': 0.4105269540961737, 'f1-score': 0.42664585388555076, 'support': 214383}, 'accuracy': 0.37847241842824, 'macro avg': {'precision': 0.39992021267036604, 'recall': 0.3898547080006072, 'f1-score': 0.3745408130107089, 'support': 583995}, 'weighted avg': {'precision': 0.40978250680303757, 'recall': 0.37847241842824, 'f1-score': 0.3746309126759578, 'support': 583995}}
[[52470 98038 61731]
 [28384 80546 48443]
 [33458 92915 88010]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0759376
{'0': {'precision': 0.4356976903102364, 'recall': 0.2564659506858131, 'f1-score': 0.32287631345739964, 'support': 74583}, '1': {'precision': 0.394145600127023, 'recall': 0.46845766047502224, 'f1-score': 0.42810069044524784, 'support': 74186}, '2': {'precision': 0.40976388828937715, 'recall': 0.4998025640350646, 'f1-score': 0.450326727624198, 'support': 75974}, 'accuracy': 0.4087023845014083, 'macro avg': {'precision': 0.41320239290887883, 'recall': 0.4082420583986333, 'f1-score': 0.4004345771756152, 'support': 224743}, 'weighted avg': {'precision': 0.41321477410343743, 'recall': 0.4087023845014083, 'f1-score': 0.4006945031101534, 'support': 224743}}
[[19128 27695 27760]
 [12497 34753 26936]
 [12277 25725 37972]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0813513
{'0': {'precision': 0.427972760607648, 'recall': 0.2565048467485577, 'f1-score': 0.3207616617181557, 'support': 25481}, '1': {'precision': 0.3818328223233919, 'recall': 0.46989099778946564, 'f1-score': 0.4213098228168196, 'support': 26238}, '2': {'precision': 0.40488492249882574, 'recall': 0.4705240174672489, 'f1-score': 0.4352436253471345, 'support': 25648}, 'accuracy': 0.3998216293768661, 'macro avg': {'precision': 0.4048968351432885, 'recall': 0.3989732873350908, 'f1-score': 0.39243836996070325, 'support': 77367}, 'weighted avg': {'precision': 0.40467113882423406, 'recall': 0.3998216293768661, 'f1-score': 0.3928132606435734, 'support': 77367}}
[[ 6536 10322  8623]
 [ 4794 12329  9115]
 [ 3942  9638 12068]]
training model: results/PCAR/W3/deepVOL_L3/h100
Epoch 1/50
878/878 - 33s - loss: 3.3224 - accuracy100: 0.3534 - val_loss: 3.3300 - val_accuracy100: 0.3442 - 33s/epoch - 38ms/step
Epoch 2/50
878/878 - 30s - loss: 3.2967 - accuracy100: 0.3506 - val_loss: 3.3284 - val_accuracy100: 0.3432 - 30s/epoch - 34ms/step
Epoch 3/50
878/878 - 31s - loss: 3.2935 - accuracy100: 0.3522 - val_loss: 3.2971 - val_accuracy100: 0.3508 - 31s/epoch - 35ms/step
Epoch 4/50
878/878 - 30s - loss: 3.2849 - accuracy100: 0.3633 - val_loss: 3.2899 - val_accuracy100: 0.3596 - 30s/epoch - 34ms/step
Epoch 5/50
878/878 - 30s - loss: 3.2723 - accuracy100: 0.3735 - val_loss: 3.2986 - val_accuracy100: 0.3570 - 30s/epoch - 34ms/step
Epoch 6/50
878/878 - 30s - loss: 3.2646 - accuracy100: 0.3782 - val_loss: 3.2971 - val_accuracy100: 0.3524 - 30s/epoch - 34ms/step
Epoch 7/50
878/878 - 30s - loss: 3.2570 - accuracy100: 0.3843 - val_loss: 3.2937 - val_accuracy100: 0.3594 - 30s/epoch - 34ms/step
Epoch 8/50
878/878 - 30s - loss: 3.2518 - accuracy100: 0.3889 - val_loss: 3.2851 - val_accuracy100: 0.3683 - 30s/epoch - 34ms/step
Epoch 9/50
878/878 - 30s - loss: 3.2475 - accuracy100: 0.3908 - val_loss: 3.2847 - val_accuracy100: 0.3631 - 30s/epoch - 34ms/step
Epoch 10/50
878/878 - 29s - loss: 3.2423 - accuracy100: 0.3931 - val_loss: 3.2820 - val_accuracy100: 0.3636 - 29s/epoch - 34ms/step
Epoch 11/50
878/878 - 29s - loss: 3.2395 - accuracy100: 0.3950 - val_loss: 3.2826 - val_accuracy100: 0.3707 - 29s/epoch - 33ms/step
Epoch 12/50
878/878 - 30s - loss: 3.2359 - accuracy100: 0.3973 - val_loss: 3.2785 - val_accuracy100: 0.3701 - 30s/epoch - 34ms/step
Epoch 13/50
878/878 - 29s - loss: 3.2325 - accuracy100: 0.3996 - val_loss: 3.2766 - val_accuracy100: 0.3727 - 29s/epoch - 33ms/step
Epoch 14/50
878/878 - 30s - loss: 3.2290 - accuracy100: 0.4019 - val_loss: 3.2733 - val_accuracy100: 0.3740 - 30s/epoch - 34ms/step
Epoch 15/50
878/878 - 29s - loss: 3.2272 - accuracy100: 0.4033 - val_loss: 3.2732 - val_accuracy100: 0.3759 - 29s/epoch - 33ms/step
Epoch 16/50
878/878 - 30s - loss: 3.2237 - accuracy100: 0.4068 - val_loss: 3.2789 - val_accuracy100: 0.3711 - 30s/epoch - 34ms/step
Epoch 17/50
878/878 - 29s - loss: 3.2201 - accuracy100: 0.4084 - val_loss: 3.2786 - val_accuracy100: 0.3704 - 29s/epoch - 33ms/step
Epoch 18/50
878/878 - 29s - loss: 3.2173 - accuracy100: 0.4104 - val_loss: 3.2779 - val_accuracy100: 0.3742 - 29s/epoch - 33ms/step
Epoch 19/50
878/878 - 31s - loss: 3.2145 - accuracy100: 0.4110 - val_loss: 3.2790 - val_accuracy100: 0.3722 - 31s/epoch - 35ms/step
Epoch 20/50
878/878 - 29s - loss: 3.2126 - accuracy100: 0.4127 - val_loss: 3.2808 - val_accuracy100: 0.3754 - 29s/epoch - 33ms/step
Epoch 21/50
878/878 - 30s - loss: 3.2077 - accuracy100: 0.4158 - val_loss: 3.2799 - val_accuracy100: 0.3749 - 30s/epoch - 34ms/step
Epoch 22/50
878/878 - 30s - loss: 3.2045 - accuracy100: 0.4178 - val_loss: 3.2857 - val_accuracy100: 0.3735 - 30s/epoch - 34ms/step
Epoch 23/50
878/878 - 29s - loss: 3.2031 - accuracy100: 0.4172 - val_loss: 3.2799 - val_accuracy100: 0.3771 - 29s/epoch - 33ms/step
Epoch 24/50
878/878 - 30s - loss: 3.1989 - accuracy100: 0.4207 - val_loss: 3.2823 - val_accuracy100: 0.3773 - 30s/epoch - 34ms/step
Epoch 25/50
878/878 - 30s - loss: 3.1968 - accuracy100: 0.4201 - val_loss: 3.2877 - val_accuracy100: 0.3711 - 30s/epoch - 34ms/step
testing model: results/PCAR/W3/deepVOL_L3/h100
Evaluating performance on  test set...
2282/2282 - 30s - 30s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1004871
{'0': {'precision': 0.39031917981940134, 'recall': 0.1284635267376721, 'f1-score': 0.193305512150643, 'support': 198858}, '1': {'precision': 0.3370943644896953, 'recall': 0.7119733535908374, 'f1-score': 0.4575533133388753, 'support': 188243}, '2': {'precision': 0.3939732142857143, 'recall': 0.24203378467601858, 'f1-score': 0.2998546502482272, 'support': 196894}, 'accuracy': 0.3548403667839622, 'macro avg': {'precision': 0.3737955861982703, 'recall': 0.36082355500150937, 'f1-score': 0.3169044919125818, 'support': 583995}, 'weighted avg': {'precision': 0.3743948286693065, 'recall': 0.3548403667839622, 'f1-score': 0.31440532436763485, 'support': 583995}}
[[ 25546 135373  37939]
 [ 18853 134024  35366]
 [ 21050 128189  47655]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0899183
{'0': {'precision': 0.4024020993136859, 'recall': 0.16009476389335048, 'f1-score': 0.22905894519131337, 'support': 74712}, '1': {'precision': 0.36320890874010603, 'recall': 0.6408143025624531, 'f1-score': 0.4636336310129835, 'support': 74616}, '2': {'precision': 0.38527448597983366, 'recall': 0.32375522110985877, 'f1-score': 0.35184598092054065, 'support': 75415}, 'accuracy': 0.3746145597415715, 'macro avg': {'precision': 0.3836284980112085, 'recall': 0.3748880958552208, 'f1-score': 0.34817951904161254, 'support': 224743}, 'weighted avg': {'precision': 0.38364236901102594, 'recall': 0.3746145597415715, 'f1-score': 0.34814167104613164, 'support': 224743}}
[[11961 42365 20386]
 [ 8230 47815 18571]
 [ 9533 41466 24416]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0913582
{'0': {'precision': 0.3878410914927769, 'recall': 0.1538400318344608, 'f1-score': 0.22029745284631602, 'support': 25130}, '1': {'precision': 0.37180567833720524, 'recall': 0.6733310994452512, 'f1-score': 0.47907284768211916, 'support': 26859}, '2': {'precision': 0.3742403241283719, 'recall': 0.2766175427535661, 'f1-score': 0.3181076672104404, 'support': 25378}, 'accuracy': 0.3744619799139168, 'macro avg': {'precision': 0.3779623646527847, 'recall': 0.36792955801109267, 'f1-score': 0.3391593225796252, 'support': 77367}, 'weighted avg': {'precision': 0.37781284384042685, 'recall': 0.3744619799139168, 'f1-score': 0.342218633065629, 'support': 77367}}
[[ 3866 15249  6015]
 [ 3051 18085  5723]
 [ 3051 15307  7020]]
training model: results/PCAR/W3/deepVOL_L3/h200
Epoch 1/50
878/878 - 33s - loss: 3.3001 - accuracy200: 0.3750 - val_loss: 3.4393 - val_accuracy200: 0.3231 - 33s/epoch - 37ms/step
Epoch 2/50
878/878 - 34s - loss: 3.2827 - accuracy200: 0.3738 - val_loss: 3.3907 - val_accuracy200: 0.3227 - 34s/epoch - 38ms/step
Epoch 3/50
878/878 - 29s - loss: 3.2723 - accuracy200: 0.3764 - val_loss: 3.3862 - val_accuracy200: 0.3230 - 29s/epoch - 34ms/step
Epoch 4/50
878/878 - 30s - loss: 3.2613 - accuracy200: 0.3831 - val_loss: 3.3857 - val_accuracy200: 0.3288 - 30s/epoch - 34ms/step
Epoch 5/50
878/878 - 33s - loss: 3.2524 - accuracy200: 0.3885 - val_loss: 3.3805 - val_accuracy200: 0.3298 - 33s/epoch - 37ms/step
Epoch 6/50
878/878 - 29s - loss: 3.2444 - accuracy200: 0.3918 - val_loss: 3.3669 - val_accuracy200: 0.3325 - 29s/epoch - 33ms/step
Epoch 7/50
878/878 - 29s - loss: 3.2402 - accuracy200: 0.3944 - val_loss: 3.3823 - val_accuracy200: 0.3321 - 29s/epoch - 33ms/step
Epoch 8/50
878/878 - 30s - loss: 3.2364 - accuracy200: 0.3969 - val_loss: 3.3847 - val_accuracy200: 0.3348 - 30s/epoch - 34ms/step
Epoch 9/50
878/878 - 30s - loss: 3.2375 - accuracy200: 0.3975 - val_loss: 3.3859 - val_accuracy200: 0.3312 - 30s/epoch - 34ms/step
Epoch 10/50
878/878 - 29s - loss: 3.2307 - accuracy200: 0.4003 - val_loss: 3.3723 - val_accuracy200: 0.3373 - 29s/epoch - 33ms/step
Epoch 11/50
878/878 - 29s - loss: 3.2262 - accuracy200: 0.4028 - val_loss: 3.3673 - val_accuracy200: 0.3431 - 29s/epoch - 33ms/step
Epoch 12/50
878/878 - 29s - loss: 3.2215 - accuracy200: 0.4035 - val_loss: 3.3913 - val_accuracy200: 0.3394 - 29s/epoch - 33ms/step
Epoch 13/50
878/878 - 30s - loss: 3.2180 - accuracy200: 0.4048 - val_loss: 3.3945 - val_accuracy200: 0.3407 - 30s/epoch - 34ms/step
Epoch 14/50
878/878 - 32s - loss: 3.2151 - accuracy200: 0.4073 - val_loss: 3.3766 - val_accuracy200: 0.3470 - 32s/epoch - 37ms/step
Epoch 15/50
878/878 - 33s - loss: 3.2120 - accuracy200: 0.4083 - val_loss: 3.3797 - val_accuracy200: 0.3477 - 33s/epoch - 37ms/step
Epoch 16/50
878/878 - 29s - loss: 3.2085 - accuracy200: 0.4095 - val_loss: 3.3965 - val_accuracy200: 0.3455 - 29s/epoch - 33ms/step
testing model: results/PCAR/W3/deepVOL_L3/h200
Evaluating performance on  test set...
2282/2282 - 30s - 30s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1408112
{'0': {'precision': 0.3760009561372057, 'recall': 0.02960537150224205, 'f1-score': 0.05488892669118, 'support': 212529}, '1': {'precision': 0.28835308620405153, 'recall': 0.9006815673623828, 'f1-score': 0.43684901673310994, 'support': 164914}, '2': {'precision': 0.38702872703563074, 'recall': 0.0977090514737209, 'f1-score': 0.15602749151520307, 'support': 206552}, 'accuracy': 0.29967551092047023, 'macro avg': {'precision': 0.3504609231256293, 'recall': 0.34266533011278194, 'f1-score': 0.21592181164649768, 'support': 583995}, 'weighted avg': {'precision': 0.35515051617188975, 'recall': 0.29967551092047023, 'f1-score': 0.19852190151237958, 'support': 583995}}
[[  6292 186877  19360]
 [  3775 148535  12604]
 [  6667 179703  20182]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1126233
{'0': {'precision': 0.3588152327221439, 'recall': 0.034038909256335466, 'f1-score': 0.06217920516204722, 'support': 74738}, '1': {'precision': 0.3404620859120895, 'recall': 0.9035107894202801, 'f1-score': 0.49456250069426705, 'support': 73915}, '2': {'precision': 0.3816456579375785, 'recall': 0.1078328295439611, 'f1-score': 0.16815419770670872, 'support': 76090}, 'accuracy': 0.3449807113013531, 'macro avg': {'precision': 0.3603076588572706, 'recall': 0.34846084274019223, 'f1-score': 0.24163196785434096, 'support': 224743}, 'weighted avg': {'precision': 0.3605086968486228, 'recall': 0.3449807113013531, 'f1-score': 0.2402637215740704, 'support': 224743}}
[[ 2544 64232  7962]
 [ 1800 66783  5332]
 [ 2746 65139  8205]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1246029
{'0': {'precision': 0.37947306331104996, 'recall': 0.03678432568422658, 'f1-score': 0.06706744969941272, 'support': 26234}, '1': {'precision': 0.3292602619448306, 'recall': 0.9025270758122743, 'f1-score': 0.48249611322575453, 'support': 24930}, '2': {'precision': 0.34211742949607027, 'recall': 0.08472312330649162, 'f1-score': 0.13581304294628654, 'support': 26203}, 'accuracy': 0.3319890909560924, 'macro avg': {'precision': 0.3502835849173169, 'recall': 0.3413448416009975, 'f1-score': 0.22845886862381795, 'support': 77367}, 'weighted avg': {'precision': 0.35064119945548156, 'recall': 0.3319890909560924, 'f1-score': 0.22421426115080076, 'support': 77367}}
[[  965 22705  2564]
 [  725 22500  1705]
 [  853 23130  2220]]
training model: results/PCAR/W3/deepVOL_L3/h300
Epoch 1/50
878/878 - 34s - loss: 3.3075 - accuracy300: 0.3652 - val_loss: 3.3912 - val_accuracy300: 0.3344 - 34s/epoch - 39ms/step
Epoch 2/50
878/878 - 30s - loss: 3.2969 - accuracy300: 0.3597 - val_loss: 3.3674 - val_accuracy300: 0.3351 - 30s/epoch - 34ms/step
Epoch 3/50
878/878 - 29s - loss: 3.2854 - accuracy300: 0.3691 - val_loss: 3.3433 - val_accuracy300: 0.3406 - 29s/epoch - 33ms/step
Epoch 4/50
878/878 - 29s - loss: 3.2686 - accuracy300: 0.3799 - val_loss: 3.3404 - val_accuracy300: 0.3433 - 29s/epoch - 33ms/step
Epoch 5/50
878/878 - 30s - loss: 3.2581 - accuracy300: 0.3842 - val_loss: 3.3292 - val_accuracy300: 0.3462 - 30s/epoch - 34ms/step
Epoch 6/50
878/878 - 30s - loss: 3.2519 - accuracy300: 0.3877 - val_loss: 3.3248 - val_accuracy300: 0.3501 - 30s/epoch - 34ms/step
Epoch 7/50
878/878 - 30s - loss: 3.2483 - accuracy300: 0.3880 - val_loss: 3.3334 - val_accuracy300: 0.3447 - 30s/epoch - 34ms/step
Epoch 8/50
878/878 - 29s - loss: 3.2418 - accuracy300: 0.3929 - val_loss: 3.3251 - val_accuracy300: 0.3434 - 29s/epoch - 33ms/step
Epoch 9/50
878/878 - 29s - loss: 3.2385 - accuracy300: 0.3953 - val_loss: 3.3224 - val_accuracy300: 0.3458 - 29s/epoch - 34ms/step
Epoch 10/50
878/878 - 30s - loss: 3.2333 - accuracy300: 0.3981 - val_loss: 3.3226 - val_accuracy300: 0.3431 - 30s/epoch - 34ms/step
Epoch 11/50
878/878 - 29s - loss: 3.2292 - accuracy300: 0.4007 - val_loss: 3.3215 - val_accuracy300: 0.3463 - 29s/epoch - 33ms/step
Epoch 12/50
878/878 - 29s - loss: 3.2257 - accuracy300: 0.4023 - val_loss: 3.3291 - val_accuracy300: 0.3414 - 29s/epoch - 34ms/step
Epoch 13/50
878/878 - 29s - loss: 3.2241 - accuracy300: 0.4023 - val_loss: 3.3379 - val_accuracy300: 0.3385 - 29s/epoch - 34ms/step
Epoch 14/50
878/878 - 32s - loss: 3.2193 - accuracy300: 0.4056 - val_loss: 3.3277 - val_accuracy300: 0.3450 - 32s/epoch - 36ms/step
Epoch 15/50
878/878 - 29s - loss: 3.2159 - accuracy300: 0.4068 - val_loss: 3.3285 - val_accuracy300: 0.3463 - 29s/epoch - 33ms/step
Epoch 16/50
878/878 - 29s - loss: 3.2125 - accuracy300: 0.4109 - val_loss: 3.3327 - val_accuracy300: 0.3491 - 29s/epoch - 33ms/step
Epoch 17/50
878/878 - 30s - loss: 3.2078 - accuracy300: 0.4121 - val_loss: 3.3223 - val_accuracy300: 0.3604 - 30s/epoch - 34ms/step
Epoch 18/50
878/878 - 30s - loss: 3.2063 - accuracy300: 0.4137 - val_loss: 3.3232 - val_accuracy300: 0.3513 - 30s/epoch - 34ms/step
Epoch 19/50
878/878 - 30s - loss: 3.1999 - accuracy300: 0.4157 - val_loss: 3.3320 - val_accuracy300: 0.3544 - 30s/epoch - 34ms/step
Epoch 20/50
878/878 - 31s - loss: 3.1959 - accuracy300: 0.4170 - val_loss: 3.3362 - val_accuracy300: 0.3534 - 31s/epoch - 35ms/step
Epoch 21/50
878/878 - 29s - loss: 3.1895 - accuracy300: 0.4206 - val_loss: 3.3323 - val_accuracy300: 0.3515 - 29s/epoch - 33ms/step
testing model: results/PCAR/W3/deepVOL_L3/h300
Evaluating performance on  test set...
2282/2282 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0999877
{'0': {'precision': 0.35870345267522524, 'recall': 0.04629134166169298, 'f1-score': 0.08200038279605174, 'support': 194356}, '1': {'precision': 0.3542026537948617, 'recall': 0.8622216292870448, 'f1-score': 0.5021293861037414, 'support': 202383}, '2': {'precision': 0.36486568065197705, 'recall': 0.12910667748963986, 'f1-score': 0.19072563467394565, 'support': 187256}, 'accuracy': 0.3556057842960984, 'macro avg': {'precision': 0.35925726237402134, 'recall': 0.34587321614612593, 'f1-score': 0.2582851345245796, 'support': 583995}, 'weighted avg': {'precision': 0.35911960175562835, 'recall': 0.3556057842960984, 'f1-score': 0.26245813302005544, 'support': 583995}}
[[  8997 164131  21228]
 [  7028 174499  20856]
 [  9057 154023  24176]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011702
{'0': {'precision': 0.3835629102338911, 'recall': 0.05582690832761474, 'f1-score': 0.09746758128171397, 'support': 74319}, '1': {'precision': 0.343039822460665, 'recall': 0.8582768426301532, 'f1-score': 0.4901674042716952, 'support': 74201}, '2': {'precision': 0.3756763447324681, 'recall': 0.1393673825485746, 'f1-score': 0.20331100478468903, 'support': 76223}, 'accuracy': 0.34909652358471677, 'macro avg': {'precision': 0.3674263591423414, 'recall': 0.35115704450211416, 'f1-score': 0.2636486634460327, 'support': 224743}, 'weighted avg': {'precision': 0.36750905619582935, 'recall': 0.34909652358471677, 'f1-score': 0.26301855655278744, 'support': 224743}}
[[ 4149 60340  9830]
 [ 2692 63685  7824]
 [ 3976 61624 10623]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1085575
{'0': {'precision': 0.3563720452209661, 'recall': 0.05386826161255243, 'f1-score': 0.09358974358974359, 'support': 25748}, '1': {'precision': 0.34330901373979583, 'recall': 0.8556812478282692, 'f1-score': 0.4900174666696146, 'support': 25901}, '2': {'precision': 0.34615384615384615, 'recall': 0.12003266194882961, 'f1-score': 0.1782538399353274, 'support': 25718}, 'accuracy': 0.3442940788708364, 'macro avg': {'precision': 0.3486116350382027, 'recall': 0.3431940571298837, 'f1-score': 0.2539536833982285, 'support': 77367}, 'weighted avg': {'precision': 0.34860210167912037, 'recall': 0.3442940788708364, 'f1-score': 0.25444987368794386, 'support': 77367}}
[[ 1387 21069  3292]
 [ 1199 22163  2539]
 [ 1306 21325  3087]]
training model: results/PCAR/W3/deepVOL_L3/h500
Epoch 1/50
878/878 - 33s - loss: 3.3152 - accuracy500: 0.3638 - val_loss: 3.3884 - val_accuracy500: 0.3317 - 33s/epoch - 38ms/step
Epoch 2/50
878/878 - 31s - loss: 3.2974 - accuracy500: 0.3553 - val_loss: 3.3093 - val_accuracy500: 0.3476 - 31s/epoch - 35ms/step
Epoch 3/50
878/878 - 29s - loss: 3.2895 - accuracy500: 0.3635 - val_loss: 3.3312 - val_accuracy500: 0.3371 - 29s/epoch - 33ms/step
Epoch 4/50
878/878 - 30s - loss: 3.2757 - accuracy500: 0.3724 - val_loss: 3.3940 - val_accuracy500: 0.3317 - 30s/epoch - 34ms/step
Epoch 5/50
878/878 - 29s - loss: 3.2731 - accuracy500: 0.3766 - val_loss: 3.3561 - val_accuracy500: 0.3360 - 29s/epoch - 34ms/step
Epoch 6/50
878/878 - 29s - loss: 3.2658 - accuracy500: 0.3805 - val_loss: 3.3693 - val_accuracy500: 0.3376 - 29s/epoch - 33ms/step
Epoch 7/50
878/878 - 29s - loss: 3.2606 - accuracy500: 0.3824 - val_loss: 3.3713 - val_accuracy500: 0.3359 - 29s/epoch - 33ms/step
Epoch 8/50
878/878 - 30s - loss: 3.2537 - accuracy500: 0.3847 - val_loss: 3.3714 - val_accuracy500: 0.3346 - 30s/epoch - 34ms/step
Epoch 9/50
878/878 - 30s - loss: 3.2474 - accuracy500: 0.3895 - val_loss: 3.3579 - val_accuracy500: 0.3406 - 30s/epoch - 34ms/step
Epoch 10/50
878/878 - 30s - loss: 3.2440 - accuracy500: 0.3912 - val_loss: 3.3582 - val_accuracy500: 0.3427 - 30s/epoch - 34ms/step
Epoch 11/50
878/878 - 30s - loss: 3.2381 - accuracy500: 0.3936 - val_loss: 3.3600 - val_accuracy500: 0.3396 - 30s/epoch - 34ms/step
Epoch 12/50
878/878 - 30s - loss: 3.2346 - accuracy500: 0.3944 - val_loss: 3.3426 - val_accuracy500: 0.3482 - 30s/epoch - 34ms/step
testing model: results/PCAR/W3/deepVOL_L3/h500
Evaluating performance on  test set...
2282/2282 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.099324
{'0': {'precision': 0.36740654205607476, 'recall': 0.012702259245235391, 'f1-score': 0.0245555647731099, 'support': 198075}, '1': {'precision': 0.3574276085971577, 'recall': 0.6616624565130002, 'f1-score': 0.4641325386768412, 'support': 201497}, '2': {'precision': 0.34329381796806113, 'recall': 0.37999598748529195, 'f1-score': 0.3607137066576076, 'support': 184423}, 'accuracy': 0.3526040462675194, 'macro avg': {'precision': 0.3560426562070979, 'recall': 0.3514535677478425, 'f1-score': 0.2831339367025196, 'support': 583995}, 'weighted avg': {'precision': 0.3563488000040792, 'recall': 0.3526040462675194, 'f1-score': 0.2823809477155064, 'support': 583995}}
[[  2516 127306  68253]
 [  2367 133323  65807]
 [  1965 112378  70080]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1003916
{'0': {'precision': 0.32508939213349225, 'recall': 0.014716594275231337, 'f1-score': 0.02815847206091108, 'support': 74134}, '1': {'precision': 0.3505307384529493, 'recall': 0.6603694714131607, 'f1-score': 0.457967653398544, 'support': 74160}, '2': {'precision': 0.36436652137714876, 'recall': 0.3892791272613115, 'f1-score': 0.37641106719367595, 'support': 76449}, 'accuracy': 0.3551790267105093, 'macro avg': {'precision': 0.3466622173211968, 'recall': 0.35478839764990117, 'f1-score': 0.2875123975510437, 'support': 224743}, 'weighted avg': {'precision': 0.3468450307811886, 'recall': 0.3551790267105093, 'f1-score': 0.28844783161072396, 'support': 224743}}
[[ 1091 45136 27907]
 [ 1178 48973 24009]
 [ 1087 45602 29760]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1024503
{'0': {'precision': 0.32164767747589834, 'recall': 0.01436680367978078, 'f1-score': 0.027505058832346548, 'support': 25545}, '1': {'precision': 0.35027951065381185, 'recall': 0.6750458643975175, 'f1-score': 0.4612286807750263, 'support': 25619}, '2': {'precision': 0.3482162806285842, 'recall': 0.35686753425180323, 'f1-score': 0.3524888327647624, 'support': 26203}, 'accuracy': 0.3491411066733879, 'macro avg': {'precision': 0.3400478229194315, 'recall': 0.34876006744303384, 'f1-score': 0.28040752412404507, 'support': 77367}, 'weighted avg': {'precision': 0.34012708138964437, 'recall': 0.3491411066733879, 'f1-score': 0.2811935215994256, 'support': 77367}}
[[  367 15601  9577]
 [  399 17294  7926]
 [  375 16477  9351]]
training model: results/PCAR/W3/deepVOL_L3/h1000
Epoch 1/50
878/878 - 33s - loss: 3.3148 - accuracy1000: 0.3717 - val_loss: 3.5363 - val_accuracy1000: 0.3225 - 33s/epoch - 38ms/step
Epoch 2/50
878/878 - 29s - loss: 3.2992 - accuracy1000: 0.3626 - val_loss: 3.3377 - val_accuracy1000: 0.3225 - 29s/epoch - 33ms/step
Epoch 3/50
878/878 - 29s - loss: 3.2986 - accuracy1000: 0.3543 - val_loss: 3.3462 - val_accuracy1000: 0.3228 - 29s/epoch - 33ms/step
Epoch 4/50
878/878 - 29s - loss: 3.2822 - accuracy1000: 0.3739 - val_loss: 3.4661 - val_accuracy1000: 0.3225 - 29s/epoch - 33ms/step
Epoch 5/50
878/878 - 30s - loss: 3.2732 - accuracy1000: 0.3793 - val_loss: 3.5004 - val_accuracy1000: 0.3226 - 30s/epoch - 34ms/step
Epoch 6/50
878/878 - 29s - loss: 3.2648 - accuracy1000: 0.3847 - val_loss: 3.5126 - val_accuracy1000: 0.3225 - 29s/epoch - 33ms/step
Epoch 7/50
878/878 - 29s - loss: 3.2593 - accuracy1000: 0.3879 - val_loss: 3.4924 - val_accuracy1000: 0.3231 - 29s/epoch - 34ms/step
Epoch 8/50
878/878 - 30s - loss: 3.2525 - accuracy1000: 0.3886 - val_loss: 3.4813 - val_accuracy1000: 0.3238 - 30s/epoch - 34ms/step
Epoch 9/50
878/878 - 30s - loss: 3.2530 - accuracy1000: 0.3920 - val_loss: 3.4834 - val_accuracy1000: 0.3235 - 30s/epoch - 34ms/step
Epoch 10/50
878/878 - 29s - loss: 3.2425 - accuracy1000: 0.3964 - val_loss: 3.5527 - val_accuracy1000: 0.3226 - 29s/epoch - 33ms/step
Epoch 11/50
878/878 - 29s - loss: 3.2313 - accuracy1000: 0.4010 - val_loss: 3.6076 - val_accuracy1000: 0.3230 - 29s/epoch - 33ms/step
Epoch 12/50
878/878 - 29s - loss: 3.2280 - accuracy1000: 0.4027 - val_loss: 3.5978 - val_accuracy1000: 0.3226 - 29s/epoch - 33ms/step
testing model: results/PCAR/W3/deepVOL_L3/h1000
Evaluating performance on  test set...
2282/2282 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1118629
{'0': {'precision': 0.36046511627906974, 'recall': 0.0001498576352465158, 'f1-score': 0.0002995907204190404, 'support': 206863}, '1': {'precision': 0.33508113743295703, 'recall': 0.9989520873907999, 'f1-score': 0.5018315817856157, 'support': 195627}, '2': {'precision': 0.3651925820256776, 'recall': 0.0014104294647530372, 'f1-score': 0.002810006256654556, 'support': 181505}, 'accuracy': 0.3351210198717455, 'macro avg': {'precision': 0.3535796119125681, 'recall': 0.33350412483026654, 'f1-score': 0.16831372625422977, 'support': 583995}, 'weighted avg': {'precision': 0.35343126674373054, 'recall': 0.3351210198717455, 'f1-score': 0.16908331624549314, 'support': 583995}}
[[    31 206571    261]
 [    21 195422    184]
 [    34 181215    256]]
Evaluating performance on  train set...
878/878 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.110046
{'0': {'precision': 0.2222222222222222, 'recall': 0.0001089369119108896, 'f1-score': 0.00021776707089679202, 'support': 73437}, '1': {'precision': 0.330198686122278, 'recall': 0.9984098320890494, 'f1-score': 0.49626900663138857, 'support': 74206}, '2': {'precision': 0.37537537537537535, 'recall': 0.001621271076523995, 'f1-score': 0.0032285976263350257, 'support': 77100}, 'accuracy': 0.3302483280903076, 'macro avg': {'precision': 0.3092654279066252, 'recall': 0.3333800133591615, 'f1-score': 0.16657179044287346, 'support': 224743}, 'weighted avg': {'precision': 0.31041455563539033, 'recall': 0.3302483280903076, 'f1-score': 0.16503764274511196, 'support': 224743}}
[[    8 73322   107]
 [   17 74088   101]
 [   11 76964   125]]
Evaluating performance on  val set...
303/303 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1125797
{'0': {'precision': 0.46153846153846156, 'recall': 0.00023280176929344664, 'f1-score': 0.00046536880477778637, 'support': 25773}, '1': {'precision': 0.3223133004415783, 'recall': 0.9982753780130751, 'f1-score': 0.48729394259759584, 'support': 24933}, '2': {'precision': 0.3053435114503817, 'recall': 0.0015003188177487715, 'f1-score': 0.002985965959988056, 'support': 26661}, 'accuracy': 0.3223079607584629, 'macro avg': {'precision': 0.36306509114347385, 'recall': 0.3333361662000391, 'f1-score': 0.16358175912078723, 'support': 77367}, 'weighted avg': {'precision': 0.36284503273901364, 'recall': 0.3223079607584629, 'f1-score': 0.1582238248794788, 'support': 77367}}
[[    6 25717    50]
 [    2 24890    41]
 [    5 26616    40]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        18 (peak)  11.06 (ave)

============================================
