This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/LILAK_orderbooks/LILAK_orderbooks_2019-04-17.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-04-09.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-03-27.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-03-28.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-04-05.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-04-01.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-04-03.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-03-29.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-04-02.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-04-15.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-04-04.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-03-26.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-04-11.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-04-10.csv
training model: results/LILAK/W2/deepLOB_L1/h10
Epoch 1/50
237/237 - 18s - loss: 3.3328 - accuracy10: 0.3541 - val_loss: 3.2537 - val_accuracy10: 0.3892 - 18s/epoch - 74ms/step
Epoch 2/50
237/237 - 7s - loss: 3.2892 - accuracy10: 0.3667 - val_loss: 3.2327 - val_accuracy10: 0.4088 - 7s/epoch - 29ms/step
Epoch 3/50
237/237 - 7s - loss: 3.2612 - accuracy10: 0.3762 - val_loss: 3.2068 - val_accuracy10: 0.3955 - 7s/epoch - 29ms/step
Epoch 4/50
237/237 - 7s - loss: 3.2507 - accuracy10: 0.3841 - val_loss: 3.2126 - val_accuracy10: 0.4005 - 7s/epoch - 28ms/step
Epoch 5/50
237/237 - 7s - loss: 3.2333 - accuracy10: 0.3897 - val_loss: 3.1862 - val_accuracy10: 0.4082 - 7s/epoch - 28ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2245 - accuracy10: 0.3983 - val_loss: 3.1844 - val_accuracy10: 0.4050 - 7s/epoch - 29ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2075 - accuracy10: 0.4078 - val_loss: 3.1890 - val_accuracy10: 0.4162 - 7s/epoch - 30ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2037 - accuracy10: 0.4138 - val_loss: 3.1726 - val_accuracy10: 0.4447 - 7s/epoch - 29ms/step
Epoch 9/50
237/237 - 7s - loss: 3.1876 - accuracy10: 0.4291 - val_loss: 3.1732 - val_accuracy10: 0.4256 - 7s/epoch - 30ms/step
Epoch 10/50
237/237 - 8s - loss: 3.1839 - accuracy10: 0.4330 - val_loss: 3.1712 - val_accuracy10: 0.4400 - 8s/epoch - 32ms/step
Epoch 11/50
237/237 - 7s - loss: 3.1766 - accuracy10: 0.4382 - val_loss: 3.1614 - val_accuracy10: 0.4380 - 7s/epoch - 31ms/step
Epoch 12/50
237/237 - 7s - loss: 3.1669 - accuracy10: 0.4444 - val_loss: 3.1647 - val_accuracy10: 0.4434 - 7s/epoch - 29ms/step
Epoch 13/50
237/237 - 7s - loss: 3.1628 - accuracy10: 0.4440 - val_loss: 3.1611 - val_accuracy10: 0.4389 - 7s/epoch - 29ms/step
Epoch 14/50
237/237 - 7s - loss: 3.1567 - accuracy10: 0.4441 - val_loss: 3.1645 - val_accuracy10: 0.4316 - 7s/epoch - 29ms/step
Epoch 15/50
237/237 - 7s - loss: 3.1515 - accuracy10: 0.4502 - val_loss: 3.1626 - val_accuracy10: 0.4317 - 7s/epoch - 30ms/step
Epoch 16/50
237/237 - 7s - loss: 3.1480 - accuracy10: 0.4513 - val_loss: 3.1588 - val_accuracy10: 0.4309 - 7s/epoch - 29ms/step
Epoch 17/50
237/237 - 7s - loss: 3.1433 - accuracy10: 0.4521 - val_loss: 3.1613 - val_accuracy10: 0.4352 - 7s/epoch - 28ms/step
Epoch 18/50
237/237 - 7s - loss: 3.1396 - accuracy10: 0.4556 - val_loss: 3.1648 - val_accuracy10: 0.4378 - 7s/epoch - 31ms/step
Epoch 19/50
237/237 - 7s - loss: 3.1350 - accuracy10: 0.4561 - val_loss: 3.1785 - val_accuracy10: 0.4361 - 7s/epoch - 29ms/step
Epoch 20/50
237/237 - 7s - loss: 3.1326 - accuracy10: 0.4572 - val_loss: 3.1707 - val_accuracy10: 0.4299 - 7s/epoch - 30ms/step
Epoch 21/50
237/237 - 7s - loss: 3.1297 - accuracy10: 0.4586 - val_loss: 3.1699 - val_accuracy10: 0.4323 - 7s/epoch - 29ms/step
Epoch 22/50
237/237 - 6s - loss: 3.1255 - accuracy10: 0.4597 - val_loss: 3.1658 - val_accuracy10: 0.4363 - 6s/epoch - 27ms/step
Epoch 23/50
237/237 - 7s - loss: 3.1242 - accuracy10: 0.4613 - val_loss: 3.1739 - val_accuracy10: 0.4300 - 7s/epoch - 28ms/step
Epoch 24/50
237/237 - 7s - loss: 3.1195 - accuracy10: 0.4604 - val_loss: 3.1705 - val_accuracy10: 0.4375 - 7s/epoch - 29ms/step
Epoch 25/50
237/237 - 7s - loss: 3.1169 - accuracy10: 0.4612 - val_loss: 3.1695 - val_accuracy10: 0.4382 - 7s/epoch - 29ms/step
Epoch 26/50
237/237 - 7s - loss: 3.1070 - accuracy10: 0.4673 - val_loss: 3.1789 - val_accuracy10: 0.4365 - 7s/epoch - 30ms/step
testing model: results/LILAK/W2/deepLOB_L1/h10
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.057816
{'0': {'precision': 0.3596984627096065, 'recall': 0.48601428571428573, 'f1-score': 0.4134230960858417, 'support': 70000}, '1': {'precision': 0.5181963088859441, 'recall': 0.4770728171217921, 'f1-score': 0.4967849729127639, 'support': 113119}, '2': {'precision': 0.39532461735879937, 'recall': 0.3064027905904059, 'f1-score': 0.34522968484818956, 'support': 69376}, 'accuracy': 0.432658072437078, 'macro avg': {'precision': 0.4244064629847833, 'recall': 0.42316329780882794, 'f1-score': 0.41847925128226504, 'support': 252495}, 'weighted avg': {'precision': 0.4404949852806021, 'recall': 0.432658072437078, 'f1-score': 0.432032676658769, 'support': 252495}}
[[34021 24161 11818]
 [38457 53966 20696]
 [22104 26015 21257]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0564382
{'0': {'precision': 0.38275862068965516, 'recall': 0.4557335337998034, 'f1-score': 0.41607053295673524, 'support': 17293}, '1': {'precision': 0.500071921749137, 'recall': 0.5408159296853732, 'f1-score': 0.5196464938995908, 'support': 25713}, '2': {'precision': 0.41503994728605553, 'recall': 0.2874009011578167, 'f1-score': 0.339623913189998, 'support': 17533}, 'accuracy': 0.4431193115181949, 'macro avg': {'precision': 0.4326234965749492, 'recall': 0.42798345488099776, 'f1-score': 0.425113646682108, 'support': 60539}, 'weighted avg': {'precision': 0.441934778362513, 'recall': 0.4431193115181949, 'f1-score': 0.4379227290510454, 'support': 60539}}
[[ 7881  6524  2888]
 [ 7593 13906  4214]
 [ 5116  7378  5039]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0597628
{'0': {'precision': 0.3545868575146389, 'recall': 0.47589940621725463, 'f1-score': 0.4063828200730744, 'support': 5726}, '1': {'precision': 0.5284148683764547, 'recall': 0.4687781898366242, 'f1-score': 0.4968132568514978, 'support': 9977}, '2': {'precision': 0.3858609794628752, 'recall': 0.3313549262336781, 'f1-score': 0.356536812334641, 'support': 5897}, 'accuracy': 0.43314814814814817, 'macro avg': {'precision': 0.4229542351179896, 'recall': 0.42534417409585235, 'f1-score': 0.4199109630864044, 'support': 21600}, 'weighted avg': {'precision': 0.4434158186950595, 'recall': 0.43314814814814817, 'f1-score': 0.4345440497075554, 'support': 21600}}
[[2725 1926 1075]
 [3265 4677 2035]
 [1695 2248 1954]]
training model: results/LILAK/W2/deepLOB_L1/h20
Epoch 1/50
237/237 - 9s - loss: 3.3377 - accuracy20: 0.3511 - val_loss: 3.3614 - val_accuracy20: 0.3496 - 9s/epoch - 38ms/step
Epoch 2/50
237/237 - 7s - loss: 3.2925 - accuracy20: 0.3716 - val_loss: 3.3238 - val_accuracy20: 0.3624 - 7s/epoch - 28ms/step
Epoch 3/50
237/237 - 7s - loss: 3.2734 - accuracy20: 0.3837 - val_loss: 3.2782 - val_accuracy20: 0.3850 - 7s/epoch - 29ms/step
Epoch 4/50
237/237 - 7s - loss: 3.2656 - accuracy20: 0.3891 - val_loss: 3.2609 - val_accuracy20: 0.3917 - 7s/epoch - 29ms/step
Epoch 5/50
237/237 - 7s - loss: 3.2487 - accuracy20: 0.3991 - val_loss: 3.2479 - val_accuracy20: 0.3960 - 7s/epoch - 30ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2412 - accuracy20: 0.4041 - val_loss: 3.2608 - val_accuracy20: 0.3969 - 7s/epoch - 29ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2351 - accuracy20: 0.4072 - val_loss: 3.2373 - val_accuracy20: 0.4074 - 7s/epoch - 28ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2265 - accuracy20: 0.4119 - val_loss: 3.2313 - val_accuracy20: 0.4093 - 7s/epoch - 29ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2168 - accuracy20: 0.4163 - val_loss: 3.2312 - val_accuracy20: 0.4113 - 7s/epoch - 29ms/step
Epoch 10/50
237/237 - 7s - loss: 3.2105 - accuracy20: 0.4238 - val_loss: 3.2301 - val_accuracy20: 0.4117 - 7s/epoch - 29ms/step
Epoch 11/50
237/237 - 7s - loss: 3.2061 - accuracy20: 0.4248 - val_loss: 3.2233 - val_accuracy20: 0.4151 - 7s/epoch - 30ms/step
Epoch 12/50
237/237 - 7s - loss: 3.2011 - accuracy20: 0.4256 - val_loss: 3.2356 - val_accuracy20: 0.4112 - 7s/epoch - 29ms/step
Epoch 13/50
237/237 - 7s - loss: 3.1932 - accuracy20: 0.4284 - val_loss: 3.2223 - val_accuracy20: 0.4163 - 7s/epoch - 29ms/step
Epoch 14/50
237/237 - 7s - loss: 3.1906 - accuracy20: 0.4303 - val_loss: 3.2286 - val_accuracy20: 0.4126 - 7s/epoch - 29ms/step
Epoch 15/50
237/237 - 7s - loss: 3.1870 - accuracy20: 0.4318 - val_loss: 3.2344 - val_accuracy20: 0.4157 - 7s/epoch - 29ms/step
Epoch 16/50
237/237 - 7s - loss: 3.1831 - accuracy20: 0.4348 - val_loss: 3.2277 - val_accuracy20: 0.4156 - 7s/epoch - 29ms/step
Epoch 17/50
237/237 - 7s - loss: 3.1803 - accuracy20: 0.4356 - val_loss: 3.2209 - val_accuracy20: 0.4180 - 7s/epoch - 30ms/step
Epoch 18/50
237/237 - 7s - loss: 3.1698 - accuracy20: 0.4380 - val_loss: 3.2336 - val_accuracy20: 0.4138 - 7s/epoch - 30ms/step
Epoch 19/50
237/237 - 7s - loss: 3.1701 - accuracy20: 0.4399 - val_loss: 3.2345 - val_accuracy20: 0.4157 - 7s/epoch - 30ms/step
Epoch 20/50
237/237 - 7s - loss: 3.1690 - accuracy20: 0.4399 - val_loss: 3.2469 - val_accuracy20: 0.4096 - 7s/epoch - 29ms/step
Epoch 21/50
237/237 - 7s - loss: 3.1609 - accuracy20: 0.4426 - val_loss: 3.2248 - val_accuracy20: 0.4251 - 7s/epoch - 29ms/step
Epoch 22/50
237/237 - 7s - loss: 3.1577 - accuracy20: 0.4460 - val_loss: 3.2418 - val_accuracy20: 0.4157 - 7s/epoch - 29ms/step
Epoch 23/50
237/237 - 7s - loss: 3.1554 - accuracy20: 0.4451 - val_loss: 3.2432 - val_accuracy20: 0.4165 - 7s/epoch - 30ms/step
Epoch 24/50
237/237 - 7s - loss: 3.1505 - accuracy20: 0.4478 - val_loss: 3.2597 - val_accuracy20: 0.4095 - 7s/epoch - 29ms/step
Epoch 25/50
237/237 - 7s - loss: 3.1512 - accuracy20: 0.4477 - val_loss: 3.2328 - val_accuracy20: 0.4212 - 7s/epoch - 30ms/step
Epoch 26/50
237/237 - 7s - loss: 3.1415 - accuracy20: 0.4510 - val_loss: 3.2479 - val_accuracy20: 0.4174 - 7s/epoch - 30ms/step
Epoch 27/50
237/237 - 7s - loss: 3.1430 - accuracy20: 0.4514 - val_loss: 3.2508 - val_accuracy20: 0.4210 - 7s/epoch - 29ms/step
testing model: results/LILAK/W2/deepLOB_L1/h20
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0762676
{'0': {'precision': 0.39942248409880204, 'recall': 0.3831698734745826, 'f1-score': 0.3911274144552072, 'support': 80142}, '1': {'precision': 0.4070339399901623, 'recall': 0.5291037371844339, 'f1-score': 0.46011005445202857, 'support': 90710}, '2': {'precision': 0.4365511265164645, 'recall': 0.30852614431120856, 'f1-score': 0.3615395104167414, 'support': 81643}, 'accuracy': 0.4114616131012495, 'macro avg': {'precision': 0.4143358502018096, 'recall': 0.4069332516567417, 'f1-score': 0.40425899310799235, 'support': 252495}, 'weighted avg': {'precision': 0.41416229643889, 'recall': 0.4114616131012495, 'f1-score': 0.40634264653781954, 'support': 252495}}
[[30708 34475 14959]
 [25163 47995 17552]
 [21010 35444 25189]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0787879
{'0': {'precision': 0.4230636635256263, 'recall': 0.36859231077292753, 'f1-score': 0.39395398608881754, 'support': 19976}, '1': {'precision': 0.3860513259806546, 'recall': 0.5412600710604013, 'f1-score': 0.45066666666666666, 'support': 19983}, '2': {'precision': 0.4349781717158354, 'recall': 0.319533527696793, 'f1-score': 0.3684240013446131, 'support': 20580}, 'accuracy': 0.4089099588694891, 'macro avg': {'precision': 0.41469772040737213, 'recall': 0.40979530317670726, 'f1-score': 0.4043482180333658, 'support': 60539}, 'weighted avg': {'precision': 0.41489674694942474, 'recall': 0.4089099588694891, 'f1-score': 0.4039951564079744, 'support': 60539}}
[[ 7363  8240  4373]
 [ 4998 10816  4169]
 [ 5043  8961  6576]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.073346
{'0': {'precision': 0.39260589732076034, 'recall': 0.39201913017486173, 'f1-score': 0.39231229434639536, 'support': 6691}, '1': {'precision': 0.4343489697501096, 'recall': 0.499244142101285, 'f1-score': 0.4645410854530536, 'support': 7938}, '2': {'precision': 0.4243313201035375, 'recall': 0.3527470951083058, 'f1-score': 0.3852420491931694, 'support': 6971}, 'accuracy': 0.41875, 'macro avg': {'precision': 0.4170953957248025, 'recall': 0.41467012246148416, 'f1-score': 0.4140318096642061, 'support': 21600}, 'weighted avg': {'precision': 0.4181852691338583, 'recall': 0.41875, 'f1-score': 0.4165745843853544, 'support': 21600}}
[[2623 2541 1527]
 [2166 3963 1809]
 [1892 2620 2459]]
training model: results/LILAK/W2/deepLOB_L1/h30
Epoch 1/50
237/237 - 9s - loss: 3.3380 - accuracy30: 0.3559 - val_loss: 3.3882 - val_accuracy30: 0.3477 - 9s/epoch - 39ms/step
Epoch 2/50
237/237 - 7s - loss: 3.3023 - accuracy30: 0.3679 - val_loss: 3.3118 - val_accuracy30: 0.3708 - 7s/epoch - 30ms/step
Epoch 3/50
237/237 - 7s - loss: 3.2833 - accuracy30: 0.3736 - val_loss: 3.2961 - val_accuracy30: 0.3700 - 7s/epoch - 31ms/step
Epoch 4/50
237/237 - 7s - loss: 3.2667 - accuracy30: 0.3875 - val_loss: 3.2805 - val_accuracy30: 0.3813 - 7s/epoch - 30ms/step
Epoch 5/50
237/237 - 7s - loss: 3.2568 - accuracy30: 0.3919 - val_loss: 3.2728 - val_accuracy30: 0.3809 - 7s/epoch - 30ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2513 - accuracy30: 0.3966 - val_loss: 3.2588 - val_accuracy30: 0.3950 - 7s/epoch - 31ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2477 - accuracy30: 0.3999 - val_loss: 3.2653 - val_accuracy30: 0.3906 - 7s/epoch - 31ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2414 - accuracy30: 0.4039 - val_loss: 3.2537 - val_accuracy30: 0.3945 - 7s/epoch - 31ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2364 - accuracy30: 0.4080 - val_loss: 3.2549 - val_accuracy30: 0.3981 - 7s/epoch - 31ms/step
Epoch 10/50
237/237 - 7s - loss: 3.2296 - accuracy30: 0.4119 - val_loss: 3.2611 - val_accuracy30: 0.3946 - 7s/epoch - 32ms/step
Epoch 11/50
237/237 - 7s - loss: 3.2248 - accuracy30: 0.4148 - val_loss: 3.2538 - val_accuracy30: 0.3977 - 7s/epoch - 31ms/step
Epoch 12/50
237/237 - 7s - loss: 3.2210 - accuracy30: 0.4151 - val_loss: 3.2566 - val_accuracy30: 0.3955 - 7s/epoch - 30ms/step
Epoch 13/50
237/237 - 7s - loss: 3.2219 - accuracy30: 0.4164 - val_loss: 3.2492 - val_accuracy30: 0.3951 - 7s/epoch - 31ms/step
Epoch 14/50
237/237 - 7s - loss: 3.2188 - accuracy30: 0.4168 - val_loss: 3.2555 - val_accuracy30: 0.3972 - 7s/epoch - 31ms/step
Epoch 15/50
237/237 - 7s - loss: 3.2141 - accuracy30: 0.4195 - val_loss: 3.2611 - val_accuracy30: 0.3925 - 7s/epoch - 31ms/step
Epoch 16/50
237/237 - 8s - loss: 3.2091 - accuracy30: 0.4208 - val_loss: 3.2806 - val_accuracy30: 0.3913 - 8s/epoch - 32ms/step
Epoch 17/50
237/237 - 8s - loss: 3.2051 - accuracy30: 0.4224 - val_loss: 3.2612 - val_accuracy30: 0.3986 - 8s/epoch - 32ms/step
Epoch 18/50
237/237 - 7s - loss: 3.2027 - accuracy30: 0.4256 - val_loss: 3.2611 - val_accuracy30: 0.3983 - 7s/epoch - 31ms/step
Epoch 19/50
237/237 - 7s - loss: 3.1961 - accuracy30: 0.4263 - val_loss: 3.2728 - val_accuracy30: 0.3959 - 7s/epoch - 31ms/step
Epoch 20/50
237/237 - 7s - loss: 3.1954 - accuracy30: 0.4288 - val_loss: 3.2618 - val_accuracy30: 0.4012 - 7s/epoch - 31ms/step
Epoch 21/50
237/237 - 7s - loss: 3.1916 - accuracy30: 0.4287 - val_loss: 3.2642 - val_accuracy30: 0.4002 - 7s/epoch - 31ms/step
Epoch 22/50
237/237 - 8s - loss: 3.1873 - accuracy30: 0.4325 - val_loss: 3.2659 - val_accuracy30: 0.4037 - 8s/epoch - 32ms/step
Epoch 23/50
237/237 - 7s - loss: 3.1829 - accuracy30: 0.4333 - val_loss: 3.2737 - val_accuracy30: 0.3975 - 7s/epoch - 30ms/step
testing model: results/LILAK/W2/deepLOB_L1/h30
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0901755
{'0': {'precision': 0.35710088148873653, 'recall': 0.39277838331094267, 'f1-score': 0.3740909063475107, 'support': 78902}, '1': {'precision': 0.38313872283367784, 'recall': 0.3845825996253884, 'f1-score': 0.38385930345808095, 'support': 89159}, '2': {'precision': 0.422410286688972, 'recall': 0.38129189662931995, 'f1-score': 0.4007992580096982, 'support': 84434}, 'accuracy': 0.3860432879859007, 'macro avg': {'precision': 0.3875499636704622, 'recall': 0.3862176265218837, 'f1-score': 0.3862498226050966, 'support': 252495}, 'weighted avg': {'precision': 0.3881345344923616, 'recall': 0.3860432879859007, 'f1-score': 0.38647148213010624, 'support': 252495}}
[[30991 26826 21085]
 [31934 34289 22936]
 [23860 28380 32194]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0805364
{'0': {'precision': 0.41191886367210023, 'recall': 0.3949444695713352, 'f1-score': 0.40325311714300377, 'support': 19899}, '1': {'precision': 0.3889243536546441, 'recall': 0.3657877620453295, 'f1-score': 0.3770014180739977, 'support': 19987}, '2': {'precision': 0.41633571617685994, 'recall': 0.4568343582046192, 'f1-score': 0.43564585016737845, 'support': 20653}, 'accuracy': 0.40643221724838535, 'macro avg': {'precision': 0.4057263111678681, 'recall': 0.405855529940428, 'f1-score': 0.40530012846145996, 'support': 60539}, 'weighted avg': {'precision': 0.4058340255192055, 'recall': 0.40643221724838535, 'f1-score': 0.4056369425425014, 'support': 60539}}
[[7859 5656 6384]
 [5833 7311 6843]
 [5387 5831 9435]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0831515
{'0': {'precision': 0.3779819029339183, 'recall': 0.4080213112327956, 'f1-score': 0.39242758522525084, 'support': 6757}, '1': {'precision': 0.4099685675797036, 'recall': 0.3498531102311917, 'f1-score': 0.37753273604410753, 'support': 7829}, '2': {'precision': 0.4044590163934426, 'recall': 0.43969204448246363, 'f1-score': 0.4213402554819319, 'support': 7014}, 'accuracy': 0.3972222222222222, 'macro avg': {'precision': 0.3974698289690215, 'recall': 0.3991888219821503, 'f1-score': 0.3971001922504301, 'support': 21600}, 'weighted avg': {'precision': 0.39817329512451816, 'recall': 0.3972222222222222, 'f1-score': 0.3964174785095652, 'support': 21600}}
[[2757 1989 2011]
 [2560 2739 2530]
 [1977 1953 3084]]
training model: results/LILAK/W2/deepLOB_L1/h50
Epoch 1/50
237/237 - 9s - loss: 3.3467 - accuracy50: 0.3534 - val_loss: 3.3762 - val_accuracy50: 0.3495 - 9s/epoch - 39ms/step
Epoch 2/50
237/237 - 7s - loss: 3.3132 - accuracy50: 0.3597 - val_loss: 3.2979 - val_accuracy50: 0.3629 - 7s/epoch - 29ms/step
Epoch 3/50
237/237 - 7s - loss: 3.2939 - accuracy50: 0.3664 - val_loss: 3.3069 - val_accuracy50: 0.3658 - 7s/epoch - 30ms/step
Epoch 4/50
237/237 - 7s - loss: 3.2854 - accuracy50: 0.3699 - val_loss: 3.2912 - val_accuracy50: 0.3729 - 7s/epoch - 29ms/step
Epoch 5/50
237/237 - 7s - loss: 3.2758 - accuracy50: 0.3782 - val_loss: 3.2869 - val_accuracy50: 0.3811 - 7s/epoch - 31ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2741 - accuracy50: 0.3815 - val_loss: 3.2980 - val_accuracy50: 0.3805 - 7s/epoch - 29ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2641 - accuracy50: 0.3887 - val_loss: 3.2846 - val_accuracy50: 0.3764 - 7s/epoch - 30ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2606 - accuracy50: 0.3895 - val_loss: 3.2814 - val_accuracy50: 0.3841 - 7s/epoch - 30ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2575 - accuracy50: 0.3923 - val_loss: 3.2805 - val_accuracy50: 0.3825 - 7s/epoch - 30ms/step
Epoch 10/50
237/237 - 7s - loss: 3.2542 - accuracy50: 0.3963 - val_loss: 3.2781 - val_accuracy50: 0.3814 - 7s/epoch - 31ms/step
Epoch 11/50
237/237 - 7s - loss: 3.2488 - accuracy50: 0.3997 - val_loss: 3.2774 - val_accuracy50: 0.3904 - 7s/epoch - 31ms/step
Epoch 12/50
237/237 - 7s - loss: 3.2442 - accuracy50: 0.4015 - val_loss: 3.2763 - val_accuracy50: 0.3907 - 7s/epoch - 30ms/step
Epoch 13/50
237/237 - 7s - loss: 3.2401 - accuracy50: 0.4047 - val_loss: 3.2808 - val_accuracy50: 0.3836 - 7s/epoch - 31ms/step
Epoch 14/50
237/237 - 7s - loss: 3.2369 - accuracy50: 0.4066 - val_loss: 3.2784 - val_accuracy50: 0.3851 - 7s/epoch - 30ms/step
Epoch 15/50
237/237 - 7s - loss: 3.2338 - accuracy50: 0.4087 - val_loss: 3.2769 - val_accuracy50: 0.3897 - 7s/epoch - 30ms/step
Epoch 16/50
237/237 - 7s - loss: 3.2319 - accuracy50: 0.4098 - val_loss: 3.2853 - val_accuracy50: 0.3858 - 7s/epoch - 31ms/step
Epoch 17/50
237/237 - 7s - loss: 3.2296 - accuracy50: 0.4095 - val_loss: 3.2857 - val_accuracy50: 0.3912 - 7s/epoch - 31ms/step
Epoch 18/50
237/237 - 7s - loss: 3.2250 - accuracy50: 0.4132 - val_loss: 3.2880 - val_accuracy50: 0.3882 - 7s/epoch - 30ms/step
Epoch 19/50
237/237 - 7s - loss: 3.2242 - accuracy50: 0.4120 - val_loss: 3.2849 - val_accuracy50: 0.3890 - 7s/epoch - 30ms/step
Epoch 20/50
237/237 - 7s - loss: 3.2223 - accuracy50: 0.4133 - val_loss: 3.2918 - val_accuracy50: 0.3919 - 7s/epoch - 31ms/step
Epoch 21/50
237/237 - 8s - loss: 3.2186 - accuracy50: 0.4170 - val_loss: 3.2873 - val_accuracy50: 0.3906 - 8s/epoch - 32ms/step
Epoch 22/50
237/237 - 7s - loss: 3.2152 - accuracy50: 0.4174 - val_loss: 3.2965 - val_accuracy50: 0.3927 - 7s/epoch - 31ms/step
testing model: results/LILAK/W2/deepLOB_L1/h50
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1067736
{'0': {'precision': 0.33209384764375904, 'recall': 0.46364703181203604, 'f1-score': 0.3869961459020932, 'support': 78398}, '1': {'precision': 0.3407604251839738, 'recall': 0.15084266485691664, 'f1-score': 0.20911671083373842, 'support': 88410}, '2': {'precision': 0.4129830133294837, 'recall': 0.5007877507673276, 'f1-score': 0.45266677918899534, 'support': 85687}, 'accuracy': 0.36672409354640684, 'macro avg': {'precision': 0.36194576205240553, 'recall': 0.3717591491454268, 'f1-score': 0.3495932119749423, 'support': 252495}, 'weighted avg': {'precision': 0.3625790535307789, 'recall': 0.36672409354640684, 'f1-score': 0.346998517038399, 'support': 252495}}
[[36349 12496 29553]
 [43633 13336 31441]
 [29472 13304 42911]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0876665
{'0': {'precision': 0.39235753960090514, 'recall': 0.38796786004882017, 'f1-score': 0.39015035286897826, 'support': 19664}, '1': {'precision': 0.4013129102844639, 'recall': 0.22858709741748928, 'f1-score': 0.2912683035288886, 'support': 20058}, '2': {'precision': 0.39376474553420965, 'recall': 0.5612239996156987, 'f1-score': 0.46281220908352644, 'support': 20817}, 'accuracy': 0.3947372767967756, 'macro avg': {'precision': 0.39581173180652623, 'recall': 0.3925929856940027, 'f1-score': 0.38141028849379777, 'support': 60539}, 'weighted avg': {'precision': 0.39580854855520603, 'recall': 0.3947372767967756, 'f1-score': 0.3823739726042685, 'support': 60539}}
[[ 7629  3521  8514]
 [ 6000  4585  9473]
 [ 5815  3319 11683]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0928482
{'0': {'precision': 0.37575070821529744, 'recall': 0.476710753306498, 'f1-score': 0.42025220201508146, 'support': 6956}, '1': {'precision': 0.37731958762886597, 'recall': 0.1498976109215017, 'f1-score': 0.2145578895945286, 'support': 7325}, '2': {'precision': 0.3972630511910796, 'recall': 0.5354556633419866, 'f1-score': 0.4561219739292364, 'support': 7319}, 'accuracy': 0.38578703703703704, 'macro avg': {'precision': 0.3834444490117477, 'recall': 0.3873546758566621, 'f1-score': 0.36364402184628214, 'support': 21600}, 'weighted avg': {'precision': 0.3835720452497483, 'recall': 0.38578703703703704, 'f1-score': 0.3626512771150422, 'support': 21600}}
[[3316  987 2653]
 [2934 1098 3293]
 [2575  825 3919]]
training model: results/LILAK/W2/deepLOB_L1/h100
Epoch 1/50
237/237 - 9s - loss: 3.3461 - accuracy100: 0.3533 - val_loss: 3.3837 - val_accuracy100: 0.3515 - 9s/epoch - 40ms/step
Epoch 2/50
237/237 - 8s - loss: 3.3094 - accuracy100: 0.3670 - val_loss: 3.3369 - val_accuracy100: 0.3587 - 8s/epoch - 32ms/step
Epoch 3/50
237/237 - 7s - loss: 3.3028 - accuracy100: 0.3666 - val_loss: 3.3485 - val_accuracy100: 0.3395 - 7s/epoch - 29ms/step
Epoch 4/50
237/237 - 7s - loss: 3.2858 - accuracy100: 0.3756 - val_loss: 3.3259 - val_accuracy100: 0.3458 - 7s/epoch - 29ms/step
Epoch 5/50
237/237 - 7s - loss: 3.2859 - accuracy100: 0.3724 - val_loss: 3.3211 - val_accuracy100: 0.3444 - 7s/epoch - 28ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2678 - accuracy100: 0.3839 - val_loss: 3.3128 - val_accuracy100: 0.3529 - 7s/epoch - 28ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2607 - accuracy100: 0.3890 - val_loss: 3.3054 - val_accuracy100: 0.3555 - 7s/epoch - 28ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2546 - accuracy100: 0.3904 - val_loss: 3.3024 - val_accuracy100: 0.3678 - 7s/epoch - 28ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2456 - accuracy100: 0.3961 - val_loss: 3.3028 - val_accuracy100: 0.3750 - 7s/epoch - 28ms/step
Epoch 10/50
237/237 - 7s - loss: 3.2395 - accuracy100: 0.4000 - val_loss: 3.3075 - val_accuracy100: 0.3608 - 7s/epoch - 28ms/step
Epoch 11/50
237/237 - 7s - loss: 3.2355 - accuracy100: 0.4048 - val_loss: 3.3058 - val_accuracy100: 0.3609 - 7s/epoch - 29ms/step
Epoch 12/50
237/237 - 7s - loss: 3.2333 - accuracy100: 0.4028 - val_loss: 3.3056 - val_accuracy100: 0.3681 - 7s/epoch - 29ms/step
Epoch 13/50
237/237 - 7s - loss: 3.2321 - accuracy100: 0.4056 - val_loss: 3.3144 - val_accuracy100: 0.3710 - 7s/epoch - 30ms/step
Epoch 14/50
237/237 - 7s - loss: 3.2281 - accuracy100: 0.4084 - val_loss: 3.3044 - val_accuracy100: 0.3805 - 7s/epoch - 28ms/step
Epoch 15/50
237/237 - 7s - loss: 3.2246 - accuracy100: 0.4078 - val_loss: 3.3037 - val_accuracy100: 0.3815 - 7s/epoch - 30ms/step
Epoch 16/50
237/237 - 7s - loss: 3.2149 - accuracy100: 0.4154 - val_loss: 3.3195 - val_accuracy100: 0.3650 - 7s/epoch - 29ms/step
Epoch 17/50
237/237 - 7s - loss: 3.2112 - accuracy100: 0.4166 - val_loss: 3.3143 - val_accuracy100: 0.3827 - 7s/epoch - 28ms/step
Epoch 18/50
237/237 - 7s - loss: 3.2051 - accuracy100: 0.4220 - val_loss: 3.3177 - val_accuracy100: 0.3770 - 7s/epoch - 28ms/step
testing model: results/LILAK/W2/deepLOB_L1/h100
Evaluating performance on  test set...
987/987 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1089826
{'0': {'precision': 0.27526547228142945, 'recall': 0.19414385741565882, 'f1-score': 0.22769509347649985, 'support': 73837}, '1': {'precision': 0.3642781155015198, 'recall': 0.49261169797361176, 'f1-score': 0.4188348564538958, 'support': 97316}, '2': {'precision': 0.3718794501438577, 'recall': 0.31462221238720467, 'f1-score': 0.34086307938199256, 'support': 81342}, 'accuracy': 0.34799104932770947, 'macro avg': {'precision': 0.3371410126422689, 'recall': 0.3337925892588251, 'f1-score': 0.32913100977079607, 'support': 252495}, 'weighted avg': {'precision': 0.34069698013264216, 'recall': 0.34799104932770947, 'f1-score': 0.3378211058071711, 'support': 252495}}
[[14335 40493 19009]
 [25160 47939 24217]
 [12582 43168 25592]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1033934
{'0': {'precision': 0.3620828076614291, 'recall': 0.1605471928397071, 'f1-score': 0.22245710460486914, 'support': 19664}, '1': {'precision': 0.3475943369620396, 'recall': 0.6145906053655131, 'f1-score': 0.44404813373684965, 'support': 20054}, '2': {'precision': 0.38607749663855273, 'recall': 0.3033956102012391, 'f1-score': 0.3397789312320146, 'support': 20821}, 'accuracy': 0.36008193065627114, 'macro avg': {'precision': 0.3652515470873405, 'recall': 0.3595111361354864, 'f1-score': 0.3354280565245778, 'support': 60539}, 'weighted avg': {'precision': 0.36553581527283885, 'recall': 0.36008193065627114, 'f1-score': 0.33621095337040097, 'support': 60539}}
[[ 3157 11458  5049]
 [ 2733 12325  4996]
 [ 2829 11675  6317]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1002823
{'0': {'precision': 0.35748519875951507, 'recall': 0.1842487648939262, 'f1-score': 0.24316808898264453, 'support': 6882}, '1': {'precision': 0.35177793904209, 'recall': 0.5168599226975876, 'f1-score': 0.41863226642197876, 'support': 7503}, '2': {'precision': 0.3804239578887466, 'recall': 0.3706167706167706, 'f1-score': 0.3754563324908734, 'support': 7215}, 'accuracy': 0.36203703703703705, 'macro avg': {'precision': 0.3632290318967839, 'recall': 0.3572418194027615, 'f1-score': 0.3457522292984989, 'support': 21600}, 'weighted avg': {'precision': 0.36316490141958757, 'recall': 0.36203703703703705, 'f1-score': 0.34830546862334805, 'support': 21600}}
[[1268 3632 1982]
 [1252 3878 2373]
 [1027 3514 2674]]
training model: results/LILAK/W2/deepLOB_L1/h200
Epoch 1/50
237/237 - 9s - loss: 3.3536 - accuracy200: 0.3471 - val_loss: 3.4170 - val_accuracy200: 0.3341 - 9s/epoch - 40ms/step
Epoch 2/50
237/237 - 7s - loss: 3.3269 - accuracy200: 0.3527 - val_loss: 3.3249 - val_accuracy200: 0.3544 - 7s/epoch - 30ms/step
Epoch 3/50
237/237 - 7s - loss: 3.3139 - accuracy200: 0.3542 - val_loss: 3.3438 - val_accuracy200: 0.3428 - 7s/epoch - 30ms/step
Epoch 4/50
237/237 - 7s - loss: 3.3098 - accuracy200: 0.3551 - val_loss: 3.3590 - val_accuracy200: 0.3328 - 7s/epoch - 30ms/step
Epoch 5/50
237/237 - 7s - loss: 3.2971 - accuracy200: 0.3608 - val_loss: 3.3503 - val_accuracy200: 0.3393 - 7s/epoch - 30ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2907 - accuracy200: 0.3648 - val_loss: 3.3301 - val_accuracy200: 0.3454 - 7s/epoch - 31ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2779 - accuracy200: 0.3751 - val_loss: 3.3315 - val_accuracy200: 0.3498 - 7s/epoch - 31ms/step
Epoch 8/50
237/237 - 8s - loss: 3.2729 - accuracy200: 0.3797 - val_loss: 3.3226 - val_accuracy200: 0.3566 - 8s/epoch - 32ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2628 - accuracy200: 0.3866 - val_loss: 3.3339 - val_accuracy200: 0.3440 - 7s/epoch - 30ms/step
Epoch 10/50
237/237 - 7s - loss: 3.2606 - accuracy200: 0.3904 - val_loss: 3.3374 - val_accuracy200: 0.3471 - 7s/epoch - 31ms/step
Epoch 11/50
237/237 - 7s - loss: 3.2507 - accuracy200: 0.3950 - val_loss: 3.3603 - val_accuracy200: 0.3349 - 7s/epoch - 31ms/step
Epoch 12/50
237/237 - 7s - loss: 3.2493 - accuracy200: 0.3957 - val_loss: 3.3665 - val_accuracy200: 0.3406 - 7s/epoch - 31ms/step
Epoch 13/50
237/237 - 7s - loss: 3.2428 - accuracy200: 0.4017 - val_loss: 3.3569 - val_accuracy200: 0.3410 - 7s/epoch - 29ms/step
Epoch 14/50
237/237 - 7s - loss: 3.2391 - accuracy200: 0.4029 - val_loss: 3.3696 - val_accuracy200: 0.3397 - 7s/epoch - 28ms/step
Epoch 15/50
237/237 - 7s - loss: 3.2355 - accuracy200: 0.4069 - val_loss: 3.3893 - val_accuracy200: 0.3342 - 7s/epoch - 30ms/step
Epoch 16/50
237/237 - 7s - loss: 3.2304 - accuracy200: 0.4089 - val_loss: 3.4317 - val_accuracy200: 0.3376 - 7s/epoch - 29ms/step
Epoch 17/50
237/237 - 7s - loss: 3.2261 - accuracy200: 0.4085 - val_loss: 3.3897 - val_accuracy200: 0.3420 - 7s/epoch - 29ms/step
Epoch 18/50
237/237 - 7s - loss: 3.2225 - accuracy200: 0.4112 - val_loss: 3.3972 - val_accuracy200: 0.3510 - 7s/epoch - 29ms/step
testing model: results/LILAK/W2/deepLOB_L1/h200
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1095386
{'0': {'precision': 0.3249021337597177, 'recall': 0.2915362827918022, 'f1-score': 0.30731621457767, 'support': 80851}, '1': {'precision': 0.32479340598644657, 'recall': 0.18175874080150267, 'f1-score': 0.2330817897705618, 'support': 84117}, '2': {'precision': 0.36506013215527494, 'recall': 0.5541947056336902, 'f1-score': 0.4401704166496523, 'support': 87527}, 'accuracy': 0.3460147725697539, 'macro avg': {'precision': 0.33825189063381306, 'recall': 0.3424965764089984, 'f1-score': 0.32685614033262805, 'support': 252495}, 'weighted avg': {'precision': 0.3387866196761267, 'recall': 0.3460147725697539, 'f1-score': 0.3286392215015888, 'support': 252495}}
[[23571 14741 42539]
 [27000 15289 41828]
 [21977 17043 48507]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1083647
{'0': {'precision': 0.3409336373454938, 'recall': 0.1426419641512276, 'f1-score': 0.20113274336283185, 'support': 19917}, '1': {'precision': 0.35383827238335436, 'recall': 0.45300438928409265, 'f1-score': 0.39732725623382087, 'support': 19821}, '2': {'precision': 0.3569511740588893, 'recall': 0.4604105571847507, 'f1-score': 0.4021330646007852, 'support': 20801}, 'accuracy': 0.3534415831117131, 'macro avg': {'precision': 0.3505743612625792, 'recall': 0.3520189702066903, 'f1-score': 0.333531021399146, 'support': 60539}, 'weighted avg': {'precision': 0.3506623007238247, 'recall': 0.3534415831117131, 'f1-score': 0.33443159404894396, 'support': 60539}}
[[2841 7932 9144]
 [2733 8979 8109]
 [2759 8465 9577]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1076577
{'0': {'precision': 0.37949718248807973, 'recall': 0.23490743225114033, 'f1-score': 0.2901889294000663, 'support': 7454}, '1': {'precision': 0.3432777993025959, 'recall': 0.2605499191295398, 'f1-score': 0.29624676084594165, 'support': 6801}, '2': {'precision': 0.35021989174560214, 'recall': 0.563784887678693, 'f1-score': 0.4320517502217121, 'support': 7345}, 'accuracy': 0.3548148148148148, 'macro avg': {'precision': 0.3576649578454259, 'recall': 0.3530807463531243, 'f1-score': 0.33949581348924, 'support': 21600}, 'weighted avg': {'precision': 0.35813747297196985, 'recall': 0.3548148148148148, 'f1-score': 0.3403362317425842, 'support': 21600}}
[[1751 1623 4080]
 [1426 1772 3603]
 [1437 1767 4141]]
training model: results/LILAK/W2/deepLOB_L1/h300
Epoch 1/50
237/237 - 9s - loss: 3.3627 - accuracy300: 0.3447 - val_loss: 3.4003 - val_accuracy300: 0.3435 - 9s/epoch - 37ms/step
Epoch 2/50
237/237 - 7s - loss: 3.3360 - accuracy300: 0.3505 - val_loss: 3.3269 - val_accuracy300: 0.3452 - 7s/epoch - 28ms/step
Epoch 3/50
237/237 - 7s - loss: 3.3157 - accuracy300: 0.3492 - val_loss: 3.3260 - val_accuracy300: 0.3367 - 7s/epoch - 29ms/step
Epoch 4/50
237/237 - 7s - loss: 3.3128 - accuracy300: 0.3437 - val_loss: 3.3127 - val_accuracy300: 0.3429 - 7s/epoch - 28ms/step
Epoch 5/50
237/237 - 7s - loss: 3.3029 - accuracy300: 0.3530 - val_loss: 3.3092 - val_accuracy300: 0.3425 - 7s/epoch - 28ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2876 - accuracy300: 0.3618 - val_loss: 3.3052 - val_accuracy300: 0.3476 - 7s/epoch - 28ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2831 - accuracy300: 0.3635 - val_loss: 3.3055 - val_accuracy300: 0.3459 - 7s/epoch - 28ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2733 - accuracy300: 0.3737 - val_loss: 3.3075 - val_accuracy300: 0.3583 - 7s/epoch - 28ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2677 - accuracy300: 0.3807 - val_loss: 3.3011 - val_accuracy300: 0.3571 - 7s/epoch - 29ms/step
Epoch 10/50
237/237 - 7s - loss: 3.2574 - accuracy300: 0.3887 - val_loss: 3.3127 - val_accuracy300: 0.3606 - 7s/epoch - 28ms/step
Epoch 11/50
237/237 - 6s - loss: 3.2577 - accuracy300: 0.3885 - val_loss: 3.3112 - val_accuracy300: 0.3577 - 6s/epoch - 27ms/step
Epoch 12/50
237/237 - 7s - loss: 3.2572 - accuracy300: 0.3885 - val_loss: 3.3236 - val_accuracy300: 0.3477 - 7s/epoch - 28ms/step
Epoch 13/50
237/237 - 7s - loss: 3.2516 - accuracy300: 0.3944 - val_loss: 3.3163 - val_accuracy300: 0.3562 - 7s/epoch - 28ms/step
Epoch 14/50
237/237 - 7s - loss: 3.2399 - accuracy300: 0.4043 - val_loss: 3.3342 - val_accuracy300: 0.3477 - 7s/epoch - 30ms/step
Epoch 15/50
237/237 - 7s - loss: 3.2405 - accuracy300: 0.4008 - val_loss: 3.3251 - val_accuracy300: 0.3503 - 7s/epoch - 28ms/step
Epoch 16/50
237/237 - 7s - loss: 3.2281 - accuracy300: 0.4072 - val_loss: 3.3326 - val_accuracy300: 0.3594 - 7s/epoch - 29ms/step
Epoch 17/50
237/237 - 7s - loss: 3.2183 - accuracy300: 0.4120 - val_loss: 3.3612 - val_accuracy300: 0.3535 - 7s/epoch - 30ms/step
Epoch 18/50
237/237 - 7s - loss: 3.2151 - accuracy300: 0.4153 - val_loss: 3.3647 - val_accuracy300: 0.3538 - 7s/epoch - 31ms/step
Epoch 19/50
237/237 - 7s - loss: 3.2181 - accuracy300: 0.4137 - val_loss: 3.3530 - val_accuracy300: 0.3517 - 7s/epoch - 31ms/step
testing model: results/LILAK/W2/deepLOB_L1/h300
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103359
{'0': {'precision': 0.31502333130452426, 'recall': 0.0775057402415893, 'f1-score': 0.12440411809478027, 'support': 80136}, '1': {'precision': 0.34991173660258795, 'recall': 0.4907889057992413, 'f1-score': 0.40854684693202226, 'support': 88046}, '2': {'precision': 0.3468362538317244, 'recall': 0.44956293809969994, 'f1-score': 0.3915742931228628, 'support': 84313}, 'accuracy': 0.34585635359116024, 'macro avg': {'precision': 0.3372571072462789, 'recall': 0.3392858613801768, 'f1-score': 0.3081750860498884, 'support': 252495}, 'weighted avg': {'precision': 0.3378120101690924, 'recall': 0.34585635359116024, 'f1-score': 0.31269913253208215, 'support': 252495}}
[[ 6211 39685 34240]
 [ 7693 43212 37141]
 [ 5812 40597 37904]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1283987
{'0': {'precision': 0.34172413793103446, 'recall': 0.14858313758808536, 'f1-score': 0.20711275209864505, 'support': 20009}, '1': {'precision': 0.34770401796855505, 'recall': 0.554334311433829, 'f1-score': 0.4273527212775339, 'support': 20107}, '2': {'precision': 0.35859070919476316, 'recall': 0.34735347402438427, 'f1-score': 0.35288265433019944, 'support': 20423}, 'accuracy': 0.3504022200564925, 'macro avg': {'precision': 0.34933962169811755, 'recall': 0.3500903076820996, 'f1-score': 0.32911604256879284, 'support': 60539}, 'weighted avg': {'precision': 0.34940023817771104, 'recall': 0.3504022200564925, 'f1-score': 0.3294375968029671, 'support': 60539}}
[[ 2973 10408  6628]
 [ 2900 11146  6061]
 [ 2827 10502  7094]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0999575
{'0': {'precision': 0.40106241699867196, 'recall': 0.08343693880370216, 'f1-score': 0.13813607775871928, 'support': 7239}, '1': {'precision': 0.36672862453531596, 'recall': 0.53476080769752, 'f1-score': 0.43508462429020345, 'support': 7379}, '2': {'precision': 0.33544032569102206, 'recall': 0.44843884273847034, 'f1-score': 0.3837950478058348, 'support': 6982}, 'accuracy': 0.35560185185185184, 'macro avg': {'precision': 0.3677437890750033, 'recall': 0.35554552974656417, 'f1-score': 0.31900524995158586, 'support': 21600}, 'weighted avg': {'precision': 0.36812156069787955, 'recall': 0.35560185185185184, 'f1-score': 0.31898673765338514, 'support': 21600}}
[[ 604 3518 3117]
 [ 347 3946 3086]
 [ 555 3296 3131]]
training model: results/LILAK/W2/deepLOB_L1/h500
Epoch 1/50
237/237 - 9s - loss: 3.3525 - accuracy500: 0.3498 - val_loss: 3.3592 - val_accuracy500: 0.3460 - 9s/epoch - 39ms/step
Epoch 2/50
237/237 - 7s - loss: 3.3277 - accuracy500: 0.3588 - val_loss: 3.3495 - val_accuracy500: 0.3633 - 7s/epoch - 31ms/step
Epoch 3/50
237/237 - 7s - loss: 3.3112 - accuracy500: 0.3665 - val_loss: 3.3324 - val_accuracy500: 0.3527 - 7s/epoch - 31ms/step
Epoch 4/50
237/237 - 8s - loss: 3.3013 - accuracy500: 0.3638 - val_loss: 3.3206 - val_accuracy500: 0.3523 - 8s/epoch - 32ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2798 - accuracy500: 0.3778 - val_loss: 3.2879 - val_accuracy500: 0.3780 - 8s/epoch - 32ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2731 - accuracy500: 0.3826 - val_loss: 3.3004 - val_accuracy500: 0.3862 - 7s/epoch - 31ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2633 - accuracy500: 0.3882 - val_loss: 3.3009 - val_accuracy500: 0.3741 - 7s/epoch - 30ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2654 - accuracy500: 0.3848 - val_loss: 3.3152 - val_accuracy500: 0.3665 - 7s/epoch - 30ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2532 - accuracy500: 0.3925 - val_loss: 3.3234 - val_accuracy500: 0.3822 - 7s/epoch - 28ms/step
Epoch 10/50
237/237 - 7s - loss: 3.2458 - accuracy500: 0.3999 - val_loss: 3.3250 - val_accuracy500: 0.3724 - 7s/epoch - 28ms/step
Epoch 11/50
237/237 - 7s - loss: 3.2354 - accuracy500: 0.4066 - val_loss: 3.3329 - val_accuracy500: 0.3811 - 7s/epoch - 30ms/step
Epoch 12/50
237/237 - 7s - loss: 3.2195 - accuracy500: 0.4158 - val_loss: 3.3302 - val_accuracy500: 0.3817 - 7s/epoch - 29ms/step
Epoch 13/50
237/237 - 7s - loss: 3.2140 - accuracy500: 0.4179 - val_loss: 3.3477 - val_accuracy500: 0.3794 - 7s/epoch - 29ms/step
Epoch 14/50
237/237 - 7s - loss: 3.2120 - accuracy500: 0.4170 - val_loss: 3.3744 - val_accuracy500: 0.3743 - 7s/epoch - 29ms/step
Epoch 15/50
237/237 - 7s - loss: 3.2056 - accuracy500: 0.4223 - val_loss: 3.3591 - val_accuracy500: 0.3776 - 7s/epoch - 28ms/step
testing model: results/LILAK/W2/deepLOB_L1/h500
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0980363
{'0': {'precision': 0.30653900046707144, 'recall': 0.08512100853414957, 'f1-score': 0.1332426506415462, 'support': 77102}, '1': {'precision': 0.38217735912693634, 'recall': 0.827403118969384, 'f1-score': 0.5228502686134274, 'support': 95865}, '2': {'precision': 0.35819881053525915, 'recall': 0.10602555074942159, 'f1-score': 0.163620134280281, 'support': 79528}, 'accuracy': 0.3735281886770035, 'macro avg': {'precision': 0.3489717233764223, 'recall': 0.33951655941765174, 'f1-score': 0.2732376845117515, 'support': 252495}, 'weighted avg': {'precision': 0.35152790174444637, 'recall': 0.3735281886770035, 'f1-score': 0.2907332734883182, 'support': 252495}}
[[ 6563 63747  6792]
 [ 8230 79319  8316]
 [ 6617 64479  8432]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1081022
{'0': {'precision': 0.32244857199920113, 'recall': 0.1604472049689441, 'f1-score': 0.21427386442814958, 'support': 20125}, '1': {'precision': 0.3376112661086754, 'recall': 0.6276427583481525, 'f1-score': 0.4390538882841791, 'support': 20244}, '2': {'precision': 0.34631497284716833, 'recall': 0.2213187902825979, 'f1-score': 0.27005444646098004, 'support': 20170}, 'accuracy': 0.33695634219263615, 'macro avg': {'precision': 0.33545827031834835, 'recall': 0.3364695845332315, 'f1-score': 0.3077940663911029, 'support': 60539}, 'weighted avg': {'precision': 0.3354705724395073, 'recall': 0.33695634219263615, 'f1-score': 0.3080240278359306, 'support': 60539}}
[[ 3229 12707  4189]
 [ 3301 12706  4237]
 [ 3484 12222  4464]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.096732
{'0': {'precision': 0.3515801354401806, 'recall': 0.08846918489065607, 'f1-score': 0.14136600862264578, 'support': 7042}, '1': {'precision': 0.3835750460405157, 'recall': 0.821926254778641, 'f1-score': 0.5230527761428292, 'support': 8109}, '2': {'precision': 0.35807504078303426, 'recall': 0.13614513878120638, 'f1-score': 0.19728120435906074, 'support': 6449}, 'accuracy': 0.37805555555555553, 'macro avg': {'precision': 0.36441007408791015, 'recall': 0.3488468594835011, 'f1-score': 0.28723332970817855, 'support': 21600}, 'weighted avg': {'precision': 0.3655307083389852, 'recall': 0.37805555555555553, 'f1-score': 0.3013518926562248, 'support': 21600}}
[[ 623 5697  722]
 [ 592 6665  852]
 [ 557 5014  878]]
training model: results/LILAK/W2/deepLOB_L1/h1000
Epoch 1/50
237/237 - 9s - loss: 3.3406 - accuracy1000: 0.3615 - val_loss: 3.4746 - val_accuracy1000: 0.3299 - 9s/epoch - 39ms/step
Epoch 2/50
237/237 - 7s - loss: 3.3192 - accuracy1000: 0.3711 - val_loss: 3.4170 - val_accuracy1000: 0.3301 - 7s/epoch - 31ms/step
Epoch 3/50
237/237 - 7s - loss: 3.3138 - accuracy1000: 0.3672 - val_loss: 3.4331 - val_accuracy1000: 0.3275 - 7s/epoch - 29ms/step
Epoch 4/50
237/237 - 7s - loss: 3.2984 - accuracy1000: 0.3720 - val_loss: 3.3401 - val_accuracy1000: 0.3342 - 7s/epoch - 30ms/step
Epoch 5/50
237/237 - 7s - loss: 3.2966 - accuracy1000: 0.3707 - val_loss: 3.3864 - val_accuracy1000: 0.3144 - 7s/epoch - 29ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2970 - accuracy1000: 0.3625 - val_loss: 3.3701 - val_accuracy1000: 0.3257 - 7s/epoch - 29ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2610 - accuracy1000: 0.3877 - val_loss: 3.3420 - val_accuracy1000: 0.3397 - 7s/epoch - 28ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2512 - accuracy1000: 0.3990 - val_loss: 3.3676 - val_accuracy1000: 0.3264 - 7s/epoch - 28ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2344 - accuracy1000: 0.4096 - val_loss: 3.3788 - val_accuracy1000: 0.3324 - 7s/epoch - 31ms/step
Epoch 10/50
237/237 - 7s - loss: 3.2255 - accuracy1000: 0.4160 - val_loss: 3.3721 - val_accuracy1000: 0.3474 - 7s/epoch - 31ms/step
Epoch 11/50
237/237 - 7s - loss: 3.2162 - accuracy1000: 0.4217 - val_loss: 3.3945 - val_accuracy1000: 0.3402 - 7s/epoch - 31ms/step
Epoch 12/50
237/237 - 7s - loss: 3.2106 - accuracy1000: 0.4210 - val_loss: 3.4394 - val_accuracy1000: 0.3432 - 7s/epoch - 30ms/step
Epoch 13/50
237/237 - 7s - loss: 3.1906 - accuracy1000: 0.4351 - val_loss: 3.3933 - val_accuracy1000: 0.3471 - 7s/epoch - 31ms/step
Epoch 14/50
237/237 - 7s - loss: 3.1769 - accuracy1000: 0.4376 - val_loss: 3.4202 - val_accuracy1000: 0.3363 - 7s/epoch - 29ms/step
testing model: results/LILAK/W2/deepLOB_L1/h1000
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1203494
{'0': {'precision': 0.2690125624746724, 'recall': 0.14834448596506475, 'f1-score': 0.19123448590427872, 'support': 80549}, '1': {'precision': 0.3361226153595304, 'recall': 0.5841295748467022, 'f1-score': 0.42670729283963704, 'support': 88227}, '2': {'precision': 0.34438924605493865, 'recall': 0.22522963723885855, 'f1-score': 0.27234583414577784, 'support': 83719}, 'accuracy': 0.32610942790946357, 'macro avg': {'precision': 0.31650814129638055, 'recall': 0.3192345660168752, 'f1-score': 0.29676253762989785, 'support': 252495}, 'weighted avg': {'precision': 0.317454627499836, 'recall': 0.32610942790946357, 'f1-score': 0.30040742121355585, 'support': 252495}}
[[11949 51006 17594]
 [18389 51536 18302]
 [14080 50783 18856]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1091354
{'0': {'precision': 0.35161959758188216, 'recall': 0.1864504090713363, 'f1-score': 0.24368434217108556, 'support': 20901}, '1': {'precision': 0.3197688944409744, 'recall': 0.5282464014858381, 'f1-score': 0.3983814174269984, 'support': 19383}, '2': {'precision': 0.36195228263363155, 'recall': 0.3115773882991854, 'f1-score': 0.334881006075721, 'support': 20255}, 'accuracy': 0.33774921951138936, 'macro avg': {'precision': 0.34444692488549605, 'recall': 0.34209139961878665, 'f1-score': 0.3256489218912683, 'support': 60539}, 'weighted avg': {'precision': 0.3448789239127262, 'recall': 0.33774921951138936, 'f1-score': 0.323726659306713, 'support': 60539}}
[[ 3897 11438  5566]
 [ 3585 10239  5559]
 [ 3601 10343  6311]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1141276
{'0': {'precision': 0.3344103392568659, 'recall': 0.16370106761565836, 'f1-score': 0.21980355720732675, 'support': 7587}, '1': {'precision': 0.3362881328861204, 'recall': 0.5672908527549508, 'f1-score': 0.42226121835046376, 'support': 7423}, '2': {'precision': 0.3400447427293065, 'recall': 0.27678300455235205, 'f1-score': 0.3051698176342647, 'support': 6590}, 'accuracy': 0.33689814814814817, 'macro avg': {'precision': 0.3369144049574309, 'recall': 0.33592497497432044, 'f1-score': 0.3157448643973517, 'support': 21600}, 'weighted avg': {'precision': 0.33677467171026126, 'recall': 0.33689814814814817, 'f1-score': 0.31542424585913353, 'support': 21600}}
[[1242 4629 1716]
 [1388 4211 1824]
 [1084 3682 1824]]
training model: results/LILAK/W2/deepOF_L1/h10
Epoch 1/50
237/237 - 9s - loss: 3.2922 - accuracy10: 0.3944 - val_loss: 3.2136 - val_accuracy10: 0.4248 - 9s/epoch - 38ms/step
Epoch 2/50
237/237 - 7s - loss: 3.2600 - accuracy10: 0.4129 - val_loss: 3.1993 - val_accuracy10: 0.4278 - 7s/epoch - 29ms/step
Epoch 3/50
237/237 - 7s - loss: 3.2442 - accuracy10: 0.4197 - val_loss: 3.1946 - val_accuracy10: 0.4257 - 7s/epoch - 28ms/step
Epoch 4/50
237/237 - 7s - loss: 3.2367 - accuracy10: 0.4219 - val_loss: 3.1890 - val_accuracy10: 0.4223 - 7s/epoch - 28ms/step
Epoch 5/50
237/237 - 7s - loss: 3.2281 - accuracy10: 0.4250 - val_loss: 3.1866 - val_accuracy10: 0.4227 - 7s/epoch - 28ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2221 - accuracy10: 0.4264 - val_loss: 3.1814 - val_accuracy10: 0.4259 - 7s/epoch - 29ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2176 - accuracy10: 0.4301 - val_loss: 3.1792 - val_accuracy10: 0.4241 - 7s/epoch - 29ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2127 - accuracy10: 0.4315 - val_loss: 3.1751 - val_accuracy10: 0.4279 - 7s/epoch - 29ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2111 - accuracy10: 0.4320 - val_loss: 3.1747 - val_accuracy10: 0.4276 - 7s/epoch - 29ms/step
Epoch 10/50
237/237 - 7s - loss: 3.2041 - accuracy10: 0.4332 - val_loss: 3.1770 - val_accuracy10: 0.4270 - 7s/epoch - 29ms/step
Epoch 11/50
237/237 - 7s - loss: 3.2028 - accuracy10: 0.4346 - val_loss: 3.1694 - val_accuracy10: 0.4311 - 7s/epoch - 28ms/step
Epoch 12/50
237/237 - 7s - loss: 3.1993 - accuracy10: 0.4383 - val_loss: 3.1717 - val_accuracy10: 0.4313 - 7s/epoch - 29ms/step
Epoch 13/50
237/237 - 7s - loss: 3.1960 - accuracy10: 0.4393 - val_loss: 3.1710 - val_accuracy10: 0.4311 - 7s/epoch - 28ms/step
Epoch 14/50
237/237 - 7s - loss: 3.1922 - accuracy10: 0.4405 - val_loss: 3.1707 - val_accuracy10: 0.4335 - 7s/epoch - 27ms/step
Epoch 15/50
237/237 - 6s - loss: 3.1893 - accuracy10: 0.4414 - val_loss: 3.1702 - val_accuracy10: 0.4329 - 6s/epoch - 27ms/step
Epoch 16/50
237/237 - 6s - loss: 3.1855 - accuracy10: 0.4433 - val_loss: 3.1697 - val_accuracy10: 0.4333 - 6s/epoch - 27ms/step
Epoch 17/50
237/237 - 7s - loss: 3.1826 - accuracy10: 0.4443 - val_loss: 3.1709 - val_accuracy10: 0.4298 - 7s/epoch - 28ms/step
Epoch 18/50
237/237 - 7s - loss: 3.1793 - accuracy10: 0.4467 - val_loss: 3.1669 - val_accuracy10: 0.4377 - 7s/epoch - 29ms/step
Epoch 19/50
237/237 - 7s - loss: 3.1758 - accuracy10: 0.4495 - val_loss: 3.1664 - val_accuracy10: 0.4367 - 7s/epoch - 29ms/step
Epoch 20/50
237/237 - 7s - loss: 3.1711 - accuracy10: 0.4491 - val_loss: 3.1658 - val_accuracy10: 0.4382 - 7s/epoch - 28ms/step
Epoch 21/50
237/237 - 7s - loss: 3.1692 - accuracy10: 0.4496 - val_loss: 3.1686 - val_accuracy10: 0.4391 - 7s/epoch - 29ms/step
Epoch 22/50
237/237 - 7s - loss: 3.1674 - accuracy10: 0.4516 - val_loss: 3.1685 - val_accuracy10: 0.4376 - 7s/epoch - 29ms/step
Epoch 23/50
237/237 - 7s - loss: 3.1625 - accuracy10: 0.4530 - val_loss: 3.1675 - val_accuracy10: 0.4368 - 7s/epoch - 29ms/step
Epoch 24/50
237/237 - 7s - loss: 3.1605 - accuracy10: 0.4561 - val_loss: 3.1639 - val_accuracy10: 0.4430 - 7s/epoch - 29ms/step
Epoch 25/50
237/237 - 7s - loss: 3.1578 - accuracy10: 0.4556 - val_loss: 3.1667 - val_accuracy10: 0.4434 - 7s/epoch - 28ms/step
Epoch 26/50
237/237 - 7s - loss: 3.1515 - accuracy10: 0.4583 - val_loss: 3.1764 - val_accuracy10: 0.4322 - 7s/epoch - 29ms/step
Epoch 27/50
237/237 - 6s - loss: 3.1483 - accuracy10: 0.4574 - val_loss: 3.1730 - val_accuracy10: 0.4338 - 6s/epoch - 27ms/step
Epoch 28/50
237/237 - 6s - loss: 3.1432 - accuracy10: 0.4609 - val_loss: 3.1690 - val_accuracy10: 0.4408 - 6s/epoch - 27ms/step
Epoch 29/50
237/237 - 7s - loss: 3.1399 - accuracy10: 0.4622 - val_loss: 3.1798 - val_accuracy10: 0.4329 - 7s/epoch - 28ms/step
Epoch 30/50
237/237 - 7s - loss: 3.1404 - accuracy10: 0.4640 - val_loss: 3.1714 - val_accuracy10: 0.4398 - 7s/epoch - 29ms/step
Epoch 31/50
237/237 - 7s - loss: 3.1357 - accuracy10: 0.4622 - val_loss: 3.1785 - val_accuracy10: 0.4299 - 7s/epoch - 30ms/step
Epoch 32/50
237/237 - 7s - loss: 3.1321 - accuracy10: 0.4646 - val_loss: 3.1769 - val_accuracy10: 0.4388 - 7s/epoch - 29ms/step
Epoch 33/50
237/237 - 7s - loss: 3.1260 - accuracy10: 0.4659 - val_loss: 3.1777 - val_accuracy10: 0.4351 - 7s/epoch - 28ms/step
Epoch 34/50
237/237 - 7s - loss: 3.1244 - accuracy10: 0.4681 - val_loss: 3.1815 - val_accuracy10: 0.4363 - 7s/epoch - 29ms/step
testing model: results/LILAK/W2/deepOF_L1/h10
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0746138
{'0': {'precision': 0.360028551034975, 'recall': 0.3602960084573845, 'f1-score': 0.3601622300925397, 'support': 69998}, '1': {'precision': 0.5414979473128033, 'recall': 0.5118857132754002, 'f1-score': 0.5262756075836621, 'support': 113119}, '2': {'precision': 0.33153217582475797, 'recall': 0.36084643881625417, 'f1-score': 0.34556874654886804, 'support': 69373}, 'accuracy': 0.42836151926808985, 'macro avg': {'precision': 0.41101955805751206, 'recall': 0.41100938684967964, 'f1-score': 0.4106688614083566, 'support': 252490}, 'weighted avg': {'precision': 0.4334998077187775, 'recall': 0.42836151926808985, 'f1-score': 0.4305736737716681, 'support': 252490}}
[[25220 23936 20842]
 [25583 57904 29632]
 [19247 25093 25033]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0598862
{'0': {'precision': 0.3827811774635999, 'recall': 0.4189134576525605, 'f1-score': 0.4000330788102654, 'support': 17321}, '1': {'precision': 0.5413649143733492, 'recall': 0.4925772316756463, 'f1-score': 0.5158200231364033, 'support': 25799}, '2': {'precision': 0.3832007952286282, 'recall': 0.39838098518773685, 'f1-score': 0.3906434723864213, 'support': 17418}, 'accuracy': 0.44439855958241103, 'macro avg': {'precision': 0.4357822956885258, 'recall': 0.4366238915053146, 'f1-score': 0.43549885811103, 'support': 60538}, 'weighted avg': {'precision': 0.45048428511112515, 'recall': 0.44439855958241103, 'f1-score': 0.44667550525282235, 'support': 60538}}
[[ 7256  5363  4702]
 [ 6624 12708  6467]
 [ 5076  5403  6939]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0670747
{'0': {'precision': 0.35229215229215227, 'recall': 0.3939867917970108, 'f1-score': 0.3719747313151202, 'support': 5754}, '1': {'precision': 0.5697044890593278, 'recall': 0.5055549994995496, 'f1-score': 0.5357161796680279, 'support': 9991}, '2': {'precision': 0.35006353240152477, 'recall': 0.37662337662337664, 'f1-score': 0.3628580836351663, 'support': 5852}, 'accuracy': 0.44089456869009586, 'macro avg': {'precision': 0.4240200579176683, 'recall': 0.4253883893066457, 'f1-score': 0.42351633153943813, 'support': 21597}, 'weighted avg': {'precision': 0.4522655177151693, 'recall': 0.44089456869009586, 'f1-score': 0.4452529731205011, 'support': 21597}}
[[2267 1869 1618]
 [2466 5051 2474]
 [1702 1946 2204]]
training model: results/LILAK/W2/deepOF_L1/h20
Epoch 1/50
237/237 - 9s - loss: 3.3103 - accuracy20: 0.3675 - val_loss: 3.2817 - val_accuracy20: 0.3914 - 9s/epoch - 36ms/step
Epoch 2/50
237/237 - 6s - loss: 3.2831 - accuracy20: 0.3823 - val_loss: 3.2664 - val_accuracy20: 0.4011 - 6s/epoch - 27ms/step
Epoch 3/50
237/237 - 7s - loss: 3.2700 - accuracy20: 0.3907 - val_loss: 3.2607 - val_accuracy20: 0.4028 - 7s/epoch - 28ms/step
Epoch 4/50
237/237 - 7s - loss: 3.2593 - accuracy20: 0.3963 - val_loss: 3.2500 - val_accuracy20: 0.4056 - 7s/epoch - 28ms/step
Epoch 5/50
237/237 - 7s - loss: 3.2523 - accuracy20: 0.4008 - val_loss: 3.2516 - val_accuracy20: 0.4035 - 7s/epoch - 28ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2494 - accuracy20: 0.4024 - val_loss: 3.2502 - val_accuracy20: 0.4039 - 7s/epoch - 28ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2422 - accuracy20: 0.4050 - val_loss: 3.2445 - val_accuracy20: 0.4035 - 7s/epoch - 28ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2395 - accuracy20: 0.4065 - val_loss: 3.2394 - val_accuracy20: 0.4065 - 7s/epoch - 29ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2356 - accuracy20: 0.4080 - val_loss: 3.2417 - val_accuracy20: 0.4069 - 7s/epoch - 28ms/step
Epoch 10/50
237/237 - 6s - loss: 3.2308 - accuracy20: 0.4122 - val_loss: 3.2428 - val_accuracy20: 0.4062 - 6s/epoch - 27ms/step
Epoch 11/50
237/237 - 7s - loss: 3.2294 - accuracy20: 0.4102 - val_loss: 3.2404 - val_accuracy20: 0.4067 - 7s/epoch - 28ms/step
Epoch 12/50
237/237 - 7s - loss: 3.2262 - accuracy20: 0.4125 - val_loss: 3.2391 - val_accuracy20: 0.4060 - 7s/epoch - 29ms/step
Epoch 13/50
237/237 - 7s - loss: 3.2226 - accuracy20: 0.4157 - val_loss: 3.2356 - val_accuracy20: 0.4083 - 7s/epoch - 29ms/step
Epoch 14/50
237/237 - 7s - loss: 3.2183 - accuracy20: 0.4151 - val_loss: 3.2349 - val_accuracy20: 0.4065 - 7s/epoch - 30ms/step
Epoch 15/50
237/237 - 7s - loss: 3.2172 - accuracy20: 0.4172 - val_loss: 3.2337 - val_accuracy20: 0.4131 - 7s/epoch - 30ms/step
Epoch 16/50
237/237 - 7s - loss: 3.2134 - accuracy20: 0.4194 - val_loss: 3.2369 - val_accuracy20: 0.4096 - 7s/epoch - 29ms/step
Epoch 17/50
237/237 - 7s - loss: 3.2112 - accuracy20: 0.4197 - val_loss: 3.2304 - val_accuracy20: 0.4142 - 7s/epoch - 29ms/step
Epoch 18/50
237/237 - 7s - loss: 3.2059 - accuracy20: 0.4245 - val_loss: 3.2315 - val_accuracy20: 0.4109 - 7s/epoch - 30ms/step
Epoch 19/50
237/237 - 7s - loss: 3.2015 - accuracy20: 0.4239 - val_loss: 3.2349 - val_accuracy20: 0.4093 - 7s/epoch - 30ms/step
Epoch 20/50
237/237 - 7s - loss: 3.1988 - accuracy20: 0.4258 - val_loss: 3.2340 - val_accuracy20: 0.4104 - 7s/epoch - 29ms/step
Epoch 21/50
237/237 - 7s - loss: 3.1966 - accuracy20: 0.4273 - val_loss: 3.2364 - val_accuracy20: 0.4137 - 7s/epoch - 29ms/step
Epoch 22/50
237/237 - 7s - loss: 3.1943 - accuracy20: 0.4286 - val_loss: 3.2398 - val_accuracy20: 0.4092 - 7s/epoch - 29ms/step
Epoch 23/50
237/237 - 6s - loss: 3.1924 - accuracy20: 0.4284 - val_loss: 3.2412 - val_accuracy20: 0.4087 - 6s/epoch - 27ms/step
Epoch 24/50
237/237 - 7s - loss: 3.1887 - accuracy20: 0.4304 - val_loss: 3.2339 - val_accuracy20: 0.4125 - 7s/epoch - 28ms/step
Epoch 25/50
237/237 - 7s - loss: 3.1839 - accuracy20: 0.4322 - val_loss: 3.2374 - val_accuracy20: 0.4097 - 7s/epoch - 29ms/step
Epoch 26/50
237/237 - 7s - loss: 3.1806 - accuracy20: 0.4336 - val_loss: 3.2428 - val_accuracy20: 0.4082 - 7s/epoch - 28ms/step
Epoch 27/50
237/237 - 7s - loss: 3.1774 - accuracy20: 0.4345 - val_loss: 3.2414 - val_accuracy20: 0.4066 - 7s/epoch - 28ms/step
testing model: results/LILAK/W2/deepOF_L1/h20
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0831267
{'0': {'precision': 0.38683339043051274, 'recall': 0.33815400356871017, 'f1-score': 0.3608594046485616, 'support': 80141}, '1': {'precision': 0.43006986126143854, 'recall': 0.48184854865559096, 'f1-score': 0.45448920915674934, 'support': 90709}, '2': {'precision': 0.3735582396911044, 'recall': 0.36973297403233707, 'f1-score': 0.37163576370933976, 'support': 81640}, 'accuracy': 0.3999881183413205, 'macro avg': {'precision': 0.3968204971276852, 'recall': 0.3965785087522127, 'f1-score': 0.3956614591715502, 'support': 252490}, 'weighted avg': {'precision': 0.3980740483822619, 'recall': 0.3999881183413205, 'f1-score': 0.3979810644800604, 'support': 252490}}
[[27100 27892 25149]
 [21531 43708 25470]
 [21425 30030 30185]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0731319
{'0': {'precision': 0.415918257596128, 'recall': 0.38704834350915823, 'f1-score': 0.4009643051559219, 'support': 19982}, '1': {'precision': 0.42188338401001607, 'recall': 0.4696366351418616, 'f1-score': 0.4444810854100909, 'support': 20090}, '2': {'precision': 0.41564942029725727, 'recall': 0.3976351021205902, 'f1-score': 0.40644275190410784, 'support': 20466}, 'accuracy': 0.41803495325250256, 'macro avg': {'precision': 0.4178170206344671, 'recall': 0.41810669359053665, 'f1-score': 0.41729604749004023, 'support': 60538}, 'weighted avg': {'precision': 0.4178069451229099, 'recall': 0.41803495325250256, 'f1-score': 0.4172577738277417, 'support': 60538}}
[[7734 6377 5871]
 [5085 9435 5570]
 [5776 6552 8138]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0775564
{'0': {'precision': 0.39152, 'recall': 0.3635958395245171, 'f1-score': 0.3770416024653313, 'support': 6730}, '1': {'precision': 0.4519873373197327, 'recall': 0.4860060514372163, 'f1-score': 0.4683798068161108, 'support': 7932}, '2': {'precision': 0.3809034907597536, 'recall': 0.37447728911319395, 'f1-score': 0.3776630553333818, 'support': 6935}, 'accuracy': 0.41204796962541096, 'macro avg': {'precision': 0.40813694269316203, 'recall': 0.4080263933583091, 'f1-score': 0.4076948215382746, 'support': 21597}, 'weighted avg': {'precision': 0.41031897337773815, 'recall': 0.41204796962541096, 'f1-score': 0.41078723438413084, 'support': 21597}}
[[2447 2259 2024]
 [1880 3855 2197]
 [1923 2415 2597]]
training model: results/LILAK/W2/deepOF_L1/h30
Epoch 1/50
237/237 - 9s - loss: 3.3234 - accuracy30: 0.3519 - val_loss: 3.2983 - val_accuracy30: 0.3757 - 9s/epoch - 37ms/step
Epoch 2/50
237/237 - 8s - loss: 3.2970 - accuracy30: 0.3702 - val_loss: 3.2882 - val_accuracy30: 0.3837 - 8s/epoch - 35ms/step
Epoch 3/50
237/237 - 7s - loss: 3.2845 - accuracy30: 0.3768 - val_loss: 3.2799 - val_accuracy30: 0.3871 - 7s/epoch - 29ms/step
Epoch 4/50
237/237 - 7s - loss: 3.2775 - accuracy30: 0.3836 - val_loss: 3.2704 - val_accuracy30: 0.3935 - 7s/epoch - 28ms/step
Epoch 5/50
237/237 - 7s - loss: 3.2713 - accuracy30: 0.3853 - val_loss: 3.2737 - val_accuracy30: 0.3878 - 7s/epoch - 29ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2667 - accuracy30: 0.3874 - val_loss: 3.2704 - val_accuracy30: 0.3892 - 7s/epoch - 29ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2600 - accuracy30: 0.3923 - val_loss: 3.2696 - val_accuracy30: 0.3876 - 7s/epoch - 29ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2584 - accuracy30: 0.3938 - val_loss: 3.2693 - val_accuracy30: 0.3907 - 7s/epoch - 30ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2550 - accuracy30: 0.3979 - val_loss: 3.2680 - val_accuracy30: 0.3921 - 7s/epoch - 29ms/step
Epoch 10/50
237/237 - 7s - loss: 3.2522 - accuracy30: 0.3973 - val_loss: 3.2655 - val_accuracy30: 0.3893 - 7s/epoch - 29ms/step
Epoch 11/50
237/237 - 7s - loss: 3.2499 - accuracy30: 0.3987 - val_loss: 3.2699 - val_accuracy30: 0.3886 - 7s/epoch - 29ms/step
Epoch 12/50
237/237 - 7s - loss: 3.2473 - accuracy30: 0.3995 - val_loss: 3.2681 - val_accuracy30: 0.3897 - 7s/epoch - 28ms/step
Epoch 13/50
237/237 - 7s - loss: 3.2445 - accuracy30: 0.4011 - val_loss: 3.2669 - val_accuracy30: 0.3913 - 7s/epoch - 28ms/step
Epoch 14/50
237/237 - 7s - loss: 3.2425 - accuracy30: 0.4022 - val_loss: 3.2667 - val_accuracy30: 0.3905 - 7s/epoch - 28ms/step
Epoch 15/50
237/237 - 7s - loss: 3.2394 - accuracy30: 0.4035 - val_loss: 3.2701 - val_accuracy30: 0.3909 - 7s/epoch - 29ms/step
Epoch 16/50
237/237 - 7s - loss: 3.2363 - accuracy30: 0.4082 - val_loss: 3.2643 - val_accuracy30: 0.3925 - 7s/epoch - 29ms/step
Epoch 17/50
237/237 - 7s - loss: 3.2345 - accuracy30: 0.4071 - val_loss: 3.2694 - val_accuracy30: 0.3894 - 7s/epoch - 29ms/step
Epoch 18/50
237/237 - 7s - loss: 3.2312 - accuracy30: 0.4087 - val_loss: 3.2677 - val_accuracy30: 0.3913 - 7s/epoch - 28ms/step
Epoch 19/50
237/237 - 7s - loss: 3.2288 - accuracy30: 0.4097 - val_loss: 3.2672 - val_accuracy30: 0.3922 - 7s/epoch - 29ms/step
Epoch 20/50
237/237 - 7s - loss: 3.2252 - accuracy30: 0.4114 - val_loss: 3.2678 - val_accuracy30: 0.3931 - 7s/epoch - 28ms/step
Epoch 21/50
237/237 - 7s - loss: 3.2229 - accuracy30: 0.4131 - val_loss: 3.2703 - val_accuracy30: 0.3939 - 7s/epoch - 29ms/step
Epoch 22/50
237/237 - 7s - loss: 3.2222 - accuracy30: 0.4128 - val_loss: 3.2699 - val_accuracy30: 0.3906 - 7s/epoch - 28ms/step
Epoch 23/50
237/237 - 7s - loss: 3.2186 - accuracy30: 0.4129 - val_loss: 3.2719 - val_accuracy30: 0.3903 - 7s/epoch - 28ms/step
Epoch 24/50
237/237 - 7s - loss: 3.2158 - accuracy30: 0.4178 - val_loss: 3.2718 - val_accuracy30: 0.3879 - 7s/epoch - 29ms/step
Epoch 25/50
237/237 - 7s - loss: 3.2135 - accuracy30: 0.4179 - val_loss: 3.2719 - val_accuracy30: 0.3925 - 7s/epoch - 30ms/step
Epoch 26/50
237/237 - 7s - loss: 3.2127 - accuracy30: 0.4159 - val_loss: 3.2797 - val_accuracy30: 0.3890 - 7s/epoch - 29ms/step
testing model: results/LILAK/W2/deepOF_L1/h30
Evaluating performance on  test set...
987/987 - 17s - 17s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0941458
{'0': {'precision': 0.3538830180762138, 'recall': 0.4061747484220932, 'f1-score': 0.37823005611844474, 'support': 78902}, '1': {'precision': 0.40204806981736285, 'recall': 0.3844298885125283, 'f1-score': 0.39304164349316834, 'support': 89158}, '2': {'precision': 0.3918203396019719, 'recall': 0.3558450787634727, 'f1-score': 0.3729672021252825, 'support': 84430}, 'accuracy': 0.3816666006574518, 'macro avg': {'precision': 0.3825838091651828, 'recall': 0.38214990523269804, 'f1-score': 0.3814129672456319, 'support': 252490}, 'weighted avg': {'precision': 0.3835766603573224, 'recall': 0.3816666006574518, 'f1-score': 0.38170040640761627, 'support': 252490}}
[[32048 24336 22518]
 [30767 34275 24116]
 [27746 26640 30044]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0819392
{'0': {'precision': 0.39776048927463237, 'recall': 0.44382558081188217, 'f1-score': 0.4195323246217331, 'support': 19929}, '1': {'precision': 0.4001682704948204, 'recall': 0.3794375747905864, 'f1-score': 0.38952729506308703, 'support': 20056}, '2': {'precision': 0.4062953744036507, 'recall': 0.3812095557826108, 'f1-score': 0.3933529131209679, 'support': 20553}, 'accuracy': 0.4012355875648353, 'macro avg': {'precision': 0.4014080447243678, 'recall': 0.40149090379502644, 'f1-score': 0.4008041776019293, 'support': 60538}, 'weighted avg': {'precision': 0.4014558203759043, 'recall': 0.4012355875648353, 'f1-score': 0.4007037158569336, 'support': 60538}}
[[8845 5553 5531]
 [6528 7610 5918]
 [6864 5854 7835]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0883449
{'0': {'precision': 0.37416107382550334, 'recall': 0.4263235294117647, 'f1-score': 0.39854275501787184, 'support': 6800}, '1': {'precision': 0.4278089503216094, 'recall': 0.3999488229273286, 'f1-score': 0.4134100376909343, 'support': 7816}, '2': {'precision': 0.3682360134515439, 'recall': 0.3450795015040825, 'f1-score': 0.3562818901131406, 'support': 6981}, 'accuracy': 0.3905172014631662, 'macro avg': {'precision': 0.39006867919955224, 'recall': 0.39045061794772523, 'f1-score': 0.38941156094064894, 'support': 21597}, 'weighted avg': {'precision': 0.3916611412525975, 'recall': 0.3905172014631662, 'f1-score': 0.3902628820481412, 'support': 21597}}
[[2899 1984 1917]
 [2474 3126 2216]
 [2375 2197 2409]]
training model: results/LILAK/W2/deepOF_L1/h50
Epoch 1/50
237/237 - 9s - loss: 3.3293 - accuracy50: 0.3418 - val_loss: 3.3086 - val_accuracy50: 0.3624 - 9s/epoch - 37ms/step
Epoch 2/50
237/237 - 7s - loss: 3.3073 - accuracy50: 0.3509 - val_loss: 3.2973 - val_accuracy50: 0.3738 - 7s/epoch - 28ms/step
Epoch 3/50
237/237 - 7s - loss: 3.2948 - accuracy50: 0.3583 - val_loss: 3.2921 - val_accuracy50: 0.3708 - 7s/epoch - 28ms/step
Epoch 4/50
237/237 - 7s - loss: 3.2876 - accuracy50: 0.3627 - val_loss: 3.2910 - val_accuracy50: 0.3801 - 7s/epoch - 29ms/step
Epoch 5/50
237/237 - 7s - loss: 3.2829 - accuracy50: 0.3668 - val_loss: 3.2895 - val_accuracy50: 0.3813 - 7s/epoch - 29ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2805 - accuracy50: 0.3701 - val_loss: 3.2876 - val_accuracy50: 0.3782 - 7s/epoch - 29ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2736 - accuracy50: 0.3770 - val_loss: 3.2808 - val_accuracy50: 0.3845 - 7s/epoch - 29ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2715 - accuracy50: 0.3780 - val_loss: 3.2811 - val_accuracy50: 0.3826 - 7s/epoch - 28ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2686 - accuracy50: 0.3807 - val_loss: 3.2824 - val_accuracy50: 0.3852 - 7s/epoch - 29ms/step
Epoch 10/50
237/237 - 7s - loss: 3.2644 - accuracy50: 0.3834 - val_loss: 3.2845 - val_accuracy50: 0.3844 - 7s/epoch - 28ms/step
Epoch 11/50
237/237 - 7s - loss: 3.2639 - accuracy50: 0.3830 - val_loss: 3.2831 - val_accuracy50: 0.3835 - 7s/epoch - 28ms/step
Epoch 12/50
237/237 - 7s - loss: 3.2621 - accuracy50: 0.3829 - val_loss: 3.2840 - val_accuracy50: 0.3857 - 7s/epoch - 28ms/step
Epoch 13/50
237/237 - 7s - loss: 3.2586 - accuracy50: 0.3855 - val_loss: 3.2846 - val_accuracy50: 0.3846 - 7s/epoch - 28ms/step
Epoch 14/50
237/237 - 6s - loss: 3.2575 - accuracy50: 0.3862 - val_loss: 3.2870 - val_accuracy50: 0.3857 - 6s/epoch - 26ms/step
Epoch 15/50
237/237 - 6s - loss: 3.2533 - accuracy50: 0.3904 - val_loss: 3.2878 - val_accuracy50: 0.3839 - 6s/epoch - 27ms/step
Epoch 16/50
237/237 - 6s - loss: 3.2508 - accuracy50: 0.3912 - val_loss: 3.2859 - val_accuracy50: 0.3822 - 6s/epoch - 26ms/step
Epoch 17/50
237/237 - 7s - loss: 3.2484 - accuracy50: 0.3947 - val_loss: 3.2820 - val_accuracy50: 0.3869 - 7s/epoch - 28ms/step
testing model: results/LILAK/W2/deepOF_L1/h50
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0984203
{'0': {'precision': 0.33800481162263796, 'recall': 0.36917699882647076, 'f1-score': 0.3529038787479728, 'support': 78396}, '1': {'precision': 0.36314934352083605, 'recall': 0.3741700505604633, 'f1-score': 0.3685773338310093, 'support': 88409}, '2': {'precision': 0.40132238821728344, 'recall': 0.354892921748264, 'f1-score': 0.3766823364734883, 'support': 85685}, 'accuracy': 0.36607786446988, 'macro avg': {'precision': 0.3674921811202525, 'recall': 0.36607999037839933, 'f1-score': 0.3660545163508235, 'support': 252490}, 'weighted avg': {'precision': 0.36829658345954236, 'recall': 0.36607786446988, 'f1-score': 0.3664613726710864, 'support': 252490}}
[[28942 27383 22071]
 [32037 33080 23292]
 [24647 30629 30409]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0927393
{'0': {'precision': 0.3771807071555182, 'recall': 0.41041518627550505, 'f1-score': 0.3930967428293632, 'support': 19702}, '1': {'precision': 0.3623523498366424, 'recall': 0.35967669510552314, 'f1-score': 0.36100956482547947, 'support': 20043}, '2': {'precision': 0.3996875813590211, 'recall': 0.3691626989852354, 'f1-score': 0.383819190959548, 'support': 20793}, 'accuracy': 0.37944761967689716, 'macro avg': {'precision': 0.3797402127837272, 'recall': 0.37975152678875457, 'f1-score': 0.37930849953813023, 'support': 60538}, 'weighted avg': {'precision': 0.38000175624156673, 'recall': 0.37944761967689716, 'f1-score': 0.37928671532992625, 'support': 60538}}
[[8086 6155 5461]
 [6766 7209 6068]
 [6586 6531 7676]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0941638
{'0': {'precision': 0.37204750097872896, 'recall': 0.4094499497343099, 'f1-score': 0.3898536852181047, 'support': 6963}, '1': {'precision': 0.3821776814734561, 'recall': 0.38525597269624573, 'f1-score': 0.3837106533414916, 'support': 7325}, '2': {'precision': 0.39893129770992364, 'recall': 0.35750444657271857, 'f1-score': 0.3770834836568295, 'support': 7309}, 'accuracy': 0.38366439783303236, 'macro avg': {'precision': 0.3843854933873696, 'recall': 0.38407012300109145, 'f1-score': 0.38354927407214195, 'support': 21597}, 'weighted avg': {'precision': 0.384581521557151, 'recall': 0.38366439783303236, 'f1-score': 0.38344839227429073, 'support': 21597}}
[[2851 2216 1896]
 [2462 2822 2041]
 [2350 2346 2613]]
training model: results/LILAK/W2/deepOF_L1/h100
Epoch 1/50
237/237 - 9s - loss: 3.3431 - accuracy100: 0.3351 - val_loss: 3.3019 - val_accuracy100: 0.3642 - 9s/epoch - 38ms/step
Epoch 2/50
237/237 - 7s - loss: 3.3166 - accuracy100: 0.3474 - val_loss: 3.2958 - val_accuracy100: 0.3638 - 7s/epoch - 28ms/step
Epoch 3/50
237/237 - 6s - loss: 3.3028 - accuracy100: 0.3551 - val_loss: 3.2940 - val_accuracy100: 0.3678 - 6s/epoch - 27ms/step
Epoch 4/50
237/237 - 10s - loss: 3.2989 - accuracy100: 0.3585 - val_loss: 3.2911 - val_accuracy100: 0.3649 - 10s/epoch - 44ms/step
Epoch 5/50
237/237 - 7s - loss: 3.2919 - accuracy100: 0.3611 - val_loss: 3.2899 - val_accuracy100: 0.3679 - 7s/epoch - 31ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2862 - accuracy100: 0.3630 - val_loss: 3.2849 - val_accuracy100: 0.3718 - 7s/epoch - 28ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2804 - accuracy100: 0.3700 - val_loss: 3.2852 - val_accuracy100: 0.3741 - 7s/epoch - 28ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2786 - accuracy100: 0.3725 - val_loss: 3.2841 - val_accuracy100: 0.3776 - 7s/epoch - 28ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2759 - accuracy100: 0.3743 - val_loss: 3.2779 - val_accuracy100: 0.3771 - 7s/epoch - 28ms/step
Epoch 10/50
237/237 - 7s - loss: 3.2726 - accuracy100: 0.3749 - val_loss: 3.2836 - val_accuracy100: 0.3733 - 7s/epoch - 28ms/step
Epoch 11/50
237/237 - 7s - loss: 3.2704 - accuracy100: 0.3771 - val_loss: 3.2828 - val_accuracy100: 0.3751 - 7s/epoch - 28ms/step
Epoch 12/50
237/237 - 7s - loss: 3.2671 - accuracy100: 0.3782 - val_loss: 3.2818 - val_accuracy100: 0.3738 - 7s/epoch - 28ms/step
Epoch 13/50
237/237 - 7s - loss: 3.2635 - accuracy100: 0.3827 - val_loss: 3.2827 - val_accuracy100: 0.3753 - 7s/epoch - 28ms/step
Epoch 14/50
237/237 - 6s - loss: 3.2616 - accuracy100: 0.3844 - val_loss: 3.2819 - val_accuracy100: 0.3759 - 6s/epoch - 27ms/step
Epoch 15/50
237/237 - 7s - loss: 3.2578 - accuracy100: 0.3872 - val_loss: 3.2820 - val_accuracy100: 0.3762 - 7s/epoch - 28ms/step
Epoch 16/50
237/237 - 7s - loss: 3.2564 - accuracy100: 0.3882 - val_loss: 3.2813 - val_accuracy100: 0.3767 - 7s/epoch - 27ms/step
Epoch 17/50
237/237 - 7s - loss: 3.2537 - accuracy100: 0.3901 - val_loss: 3.2855 - val_accuracy100: 0.3732 - 7s/epoch - 29ms/step
Epoch 18/50
237/237 - 7s - loss: 3.2507 - accuracy100: 0.3906 - val_loss: 3.2836 - val_accuracy100: 0.3750 - 7s/epoch - 29ms/step
Epoch 19/50
237/237 - 7s - loss: 3.2481 - accuracy100: 0.3933 - val_loss: 3.2862 - val_accuracy100: 0.3752 - 7s/epoch - 28ms/step
testing model: results/LILAK/W2/deepOF_L1/h100
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0967221
{'0': {'precision': 0.30771224550626597, 'recall': 0.3215775502464922, 'f1-score': 0.31449214895462885, 'support': 73836}, '1': {'precision': 0.37444085696027984, 'recall': 0.4576217193826171, 'f1-score': 0.4118735144233882, 'support': 97314}, '2': {'precision': 0.3837574253036617, 'recall': 0.2660683550528645, 'f1-score': 0.3142556358224126, 'support': 81340}, 'accuracy': 0.3561289556022021, 'macro avg': {'precision': 0.3553035092567358, 'recall': 0.3484225415606579, 'f1-score': 0.3468737664001433, 'support': 252490}, 'weighted avg': {'precision': 0.35792866207625323, 'recall': 0.3561289556022021, 'f1-score': 0.3519484134445191, 'support': 252490}}
[[23744 35022 15070]
 [33098 44533 19683]
 [20321 39377 21642]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0929134
{'0': {'precision': 0.37842038075151246, 'recall': 0.3457754336139568, 'f1-score': 0.3613621306479396, 'support': 19718}, '1': {'precision': 0.3413151993055053, 'recall': 0.47269812644023645, 'f1-score': 0.39640396572004705, 'support': 19962}, '2': {'precision': 0.4048403361344538, 'recall': 0.2887141624316809, 'f1-score': 0.33705538297931886, 'support': 20858}, 'accuracy': 0.3679672271961413, 'macro avg': {'precision': 0.3748586387304906, 'recall': 0.36906257416195803, 'f1-score': 0.3649404931157685, 'support': 60538}, 'weighted avg': {'precision': 0.37528803077880435, 'recall': 0.3679672271961413, 'f1-score': 0.3645421988503466, 'support': 60538}}
[[6818 8802 4098]
 [5771 9436 4755]
 [5428 9408 6022]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0926324
{'0': {'precision': 0.36659972192182916, 'recall': 0.34516363636363634, 'f1-score': 0.3555588852262511, 'support': 6875}, '1': {'precision': 0.3685448309652131, 'recall': 0.4997342545841084, 'f1-score': 0.4242287519034459, 'support': 7526}, '2': {'precision': 0.40983939825167714, 'recall': 0.2801556420233463, 'f1-score': 0.33281056541477505, 'support': 7196}, 'accuracy': 0.3773672269296662, 'macro avg': {'precision': 0.3816613170462398, 'recall': 0.37501784432369706, 'f1-score': 0.37086606751482404, 'support': 21597}, 'weighted avg': {'precision': 0.3816847615815085, 'recall': 0.3773672269296662, 'f1-score': 0.37190895733113544, 'support': 21597}}
[[2373 3131 1371]
 [2233 3761 1532]
 [1867 3313 2016]]
training model: results/LILAK/W2/deepOF_L1/h200
Epoch 1/50
237/237 - 9s - loss: 3.3376 - accuracy200: 0.3391 - val_loss: 3.3178 - val_accuracy200: 0.3463 - 9s/epoch - 37ms/step
Epoch 2/50
237/237 - 7s - loss: 3.3127 - accuracy200: 0.3501 - val_loss: 3.3091 - val_accuracy200: 0.3559 - 7s/epoch - 29ms/step
Epoch 3/50
237/237 - 7s - loss: 3.2998 - accuracy200: 0.3574 - val_loss: 3.3023 - val_accuracy200: 0.3560 - 7s/epoch - 28ms/step
Epoch 4/50
237/237 - 7s - loss: 3.2960 - accuracy200: 0.3568 - val_loss: 3.3034 - val_accuracy200: 0.3560 - 7s/epoch - 28ms/step
Epoch 5/50
237/237 - 7s - loss: 3.2915 - accuracy200: 0.3588 - val_loss: 3.3012 - val_accuracy200: 0.3548 - 7s/epoch - 29ms/step
Epoch 6/50
237/237 - 6s - loss: 3.2876 - accuracy200: 0.3637 - val_loss: 3.2958 - val_accuracy200: 0.3610 - 6s/epoch - 27ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2827 - accuracy200: 0.3663 - val_loss: 3.2957 - val_accuracy200: 0.3613 - 7s/epoch - 28ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2790 - accuracy200: 0.3690 - val_loss: 3.2964 - val_accuracy200: 0.3623 - 7s/epoch - 28ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2789 - accuracy200: 0.3685 - val_loss: 3.2936 - val_accuracy200: 0.3656 - 7s/epoch - 28ms/step
Epoch 10/50
237/237 - 7s - loss: 3.2750 - accuracy200: 0.3723 - val_loss: 3.2980 - val_accuracy200: 0.3661 - 7s/epoch - 28ms/step
Epoch 11/50
237/237 - 7s - loss: 3.2746 - accuracy200: 0.3728 - val_loss: 3.2944 - val_accuracy200: 0.3639 - 7s/epoch - 28ms/step
Epoch 12/50
237/237 - 7s - loss: 3.2712 - accuracy200: 0.3751 - val_loss: 3.2937 - val_accuracy200: 0.3639 - 7s/epoch - 28ms/step
Epoch 13/50
237/237 - 7s - loss: 3.2688 - accuracy200: 0.3776 - val_loss: 3.2945 - val_accuracy200: 0.3628 - 7s/epoch - 28ms/step
Epoch 14/50
237/237 - 7s - loss: 3.2660 - accuracy200: 0.3802 - val_loss: 3.2952 - val_accuracy200: 0.3623 - 7s/epoch - 28ms/step
Epoch 15/50
237/237 - 7s - loss: 3.2637 - accuracy200: 0.3795 - val_loss: 3.2930 - val_accuracy200: 0.3687 - 7s/epoch - 28ms/step
Epoch 16/50
237/237 - 7s - loss: 3.2645 - accuracy200: 0.3800 - val_loss: 3.2937 - val_accuracy200: 0.3667 - 7s/epoch - 29ms/step
Epoch 17/50
237/237 - 7s - loss: 3.2622 - accuracy200: 0.3807 - val_loss: 3.2951 - val_accuracy200: 0.3620 - 7s/epoch - 29ms/step
Epoch 18/50
237/237 - 7s - loss: 3.2582 - accuracy200: 0.3826 - val_loss: 3.2943 - val_accuracy200: 0.3663 - 7s/epoch - 28ms/step
Epoch 19/50
237/237 - 7s - loss: 3.2573 - accuracy200: 0.3851 - val_loss: 3.2946 - val_accuracy200: 0.3663 - 7s/epoch - 28ms/step
Epoch 20/50
237/237 - 7s - loss: 3.2554 - accuracy200: 0.3867 - val_loss: 3.2940 - val_accuracy200: 0.3635 - 7s/epoch - 28ms/step
Epoch 21/50
237/237 - 7s - loss: 3.2531 - accuracy200: 0.3878 - val_loss: 3.2962 - val_accuracy200: 0.3644 - 7s/epoch - 29ms/step
Epoch 22/50
237/237 - 7s - loss: 3.2518 - accuracy200: 0.3880 - val_loss: 3.2964 - val_accuracy200: 0.3661 - 7s/epoch - 27ms/step
Epoch 23/50
237/237 - 6s - loss: 3.2498 - accuracy200: 0.3908 - val_loss: 3.2972 - val_accuracy200: 0.3666 - 6s/epoch - 27ms/step
Epoch 24/50
237/237 - 7s - loss: 3.2477 - accuracy200: 0.3884 - val_loss: 3.2963 - val_accuracy200: 0.3666 - 7s/epoch - 28ms/step
Epoch 25/50
237/237 - 7s - loss: 3.2436 - accuracy200: 0.3938 - val_loss: 3.2956 - val_accuracy200: 0.3637 - 7s/epoch - 28ms/step
testing model: results/LILAK/W2/deepOF_L1/h200
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0990094
{'0': {'precision': 0.3235890857148056, 'recall': 0.4399064923499363, 'f1-score': 0.3728873977773118, 'support': 80849}, '1': {'precision': 0.34354930493455815, 'recall': 0.05024074184152648, 'f1-score': 0.08766179887155659, 'support': 84115}, '2': {'precision': 0.3904419779241315, 'recall': 0.5811530288142952, 'f1-score': 0.4670804943894511, 'support': 87526}, 'accuracy': 0.35905580419026495, 'macro avg': {'precision': 0.3525267895244984, 'recall': 0.357100087668586, 'f1-score': 0.3092098970127732, 'support': 252490}, 'weighted avg': {'precision': 0.3534133167068566, 'recall': 0.35905580419026495, 'f1-score': 0.31051896228329817, 'support': 252490}}
[[35566  4065 41218]
 [41695  4226 38194]
 [32650  4010 50866]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0913298
{'0': {'precision': 0.3688942513525085, 'recall': 0.4745881528215913, 'f1-score': 0.41511913104414855, 'support': 19971}, '1': {'precision': 0.42761168962042323, 'recall': 0.0644100384537543, 'f1-score': 0.11195637834747811, 'support': 19764}, '2': {'precision': 0.37768294213631226, 'recall': 0.5785703985002163, 'f1-score': 0.45702568775986785, 'support': 20803}, 'accuracy': 0.37640820641580497, 'macro avg': {'precision': 0.391396294369748, 'recall': 0.37252286325852063, 'f1-score': 0.3280337323838315, 'support': 60538}, 'weighted avg': {'precision': 0.39108399307345293, 'recall': 0.37640820641580497, 'f1-score': 0.3305453667152991, 'support': 60538}}
[[ 9478   824  9669]
 [ 8328  1273 10163]
 [ 7887   880 12036]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0971003
{'0': {'precision': 0.3637433155080214, 'recall': 0.4553487749364038, 'f1-score': 0.40442356858315004, 'support': 7469}, '1': {'precision': 0.36037934668071653, 'recall': 0.05030151492866598, 'f1-score': 0.08828084667010842, 'support': 6799}, '2': {'precision': 0.36714462736767567, 'recall': 0.565970800927821, 'f1-score': 0.4453749932893112, 'support': 7329}, 'accuracy': 0.365374820576932, 'macro avg': {'precision': 0.36375576318547126, 'recall': 0.35720703026429695, 'f1-score': 0.31269313618085653, 'support': 21597}, 'weighted avg': {'precision': 0.36383854125986476, 'recall': 0.365374820576932, 'f1-score': 0.3187949454125562, 'support': 21597}}
[[3401  342 3726]
 [3033  342 3424]
 [2916  265 4148]]
training model: results/LILAK/W2/deepOF_L1/h300
Epoch 1/50
237/237 - 9s - loss: 3.3376 - accuracy300: 0.3373 - val_loss: 3.3192 - val_accuracy300: 0.3388 - 9s/epoch - 37ms/step
Epoch 2/50
237/237 - 7s - loss: 3.3159 - accuracy300: 0.3443 - val_loss: 3.3124 - val_accuracy300: 0.3379 - 7s/epoch - 29ms/step
Epoch 3/50
237/237 - 7s - loss: 3.3058 - accuracy300: 0.3503 - val_loss: 3.3115 - val_accuracy300: 0.3398 - 7s/epoch - 29ms/step
Epoch 4/50
237/237 - 7s - loss: 3.3035 - accuracy300: 0.3493 - val_loss: 3.3055 - val_accuracy300: 0.3425 - 7s/epoch - 29ms/step
Epoch 5/50
237/237 - 7s - loss: 3.3003 - accuracy300: 0.3550 - val_loss: 3.3049 - val_accuracy300: 0.3414 - 7s/epoch - 30ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2943 - accuracy300: 0.3538 - val_loss: 3.3021 - val_accuracy300: 0.3452 - 7s/epoch - 30ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2913 - accuracy300: 0.3594 - val_loss: 3.3025 - val_accuracy300: 0.3432 - 7s/epoch - 29ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2904 - accuracy300: 0.3577 - val_loss: 3.2995 - val_accuracy300: 0.3446 - 7s/epoch - 30ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2870 - accuracy300: 0.3614 - val_loss: 3.2971 - val_accuracy300: 0.3494 - 7s/epoch - 31ms/step
Epoch 10/50
237/237 - 7s - loss: 3.2863 - accuracy300: 0.3599 - val_loss: 3.2994 - val_accuracy300: 0.3463 - 7s/epoch - 30ms/step
Epoch 11/50
237/237 - 7s - loss: 3.2833 - accuracy300: 0.3629 - val_loss: 3.2993 - val_accuracy300: 0.3460 - 7s/epoch - 30ms/step
Epoch 12/50
237/237 - 7s - loss: 3.2820 - accuracy300: 0.3642 - val_loss: 3.2968 - val_accuracy300: 0.3452 - 7s/epoch - 29ms/step
Epoch 13/50
237/237 - 7s - loss: 3.2786 - accuracy300: 0.3646 - val_loss: 3.2992 - val_accuracy300: 0.3484 - 7s/epoch - 29ms/step
Epoch 14/50
237/237 - 7s - loss: 3.2777 - accuracy300: 0.3685 - val_loss: 3.2989 - val_accuracy300: 0.3440 - 7s/epoch - 28ms/step
Epoch 15/50
237/237 - 6s - loss: 3.2772 - accuracy300: 0.3672 - val_loss: 3.2982 - val_accuracy300: 0.3450 - 6s/epoch - 27ms/step
Epoch 16/50
237/237 - 6s - loss: 3.2742 - accuracy300: 0.3692 - val_loss: 3.2992 - val_accuracy300: 0.3462 - 6s/epoch - 27ms/step
Epoch 17/50
237/237 - 6s - loss: 3.2742 - accuracy300: 0.3691 - val_loss: 3.2988 - val_accuracy300: 0.3482 - 6s/epoch - 27ms/step
Epoch 18/50
237/237 - 7s - loss: 3.2722 - accuracy300: 0.3704 - val_loss: 3.3014 - val_accuracy300: 0.3485 - 7s/epoch - 28ms/step
Epoch 19/50
237/237 - 7s - loss: 3.2697 - accuracy300: 0.3718 - val_loss: 3.2991 - val_accuracy300: 0.3499 - 7s/epoch - 28ms/step
Epoch 20/50
237/237 - 7s - loss: 3.2678 - accuracy300: 0.3734 - val_loss: 3.3033 - val_accuracy300: 0.3446 - 7s/epoch - 29ms/step
Epoch 21/50
237/237 - 7s - loss: 3.2660 - accuracy300: 0.3761 - val_loss: 3.3030 - val_accuracy300: 0.3475 - 7s/epoch - 28ms/step
Epoch 22/50
237/237 - 7s - loss: 3.2655 - accuracy300: 0.3753 - val_loss: 3.3036 - val_accuracy300: 0.3432 - 7s/epoch - 28ms/step
testing model: results/LILAK/W2/deepOF_L1/h300
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0987427
{'0': {'precision': 0.3171138211382114, 'recall': 0.3893977587540869, 'f1-score': 0.349558067370921, 'support': 80134}, '1': {'precision': 0.3501913995920534, 'recall': 0.2846953262536203, 'f1-score': 0.31406501569322715, 'support': 88045}, '2': {'precision': 0.37430919139034324, 'recall': 0.3663223066978212, 'f1-score': 0.37027268422219956, 'support': 84311}, 'accuracy': 0.3451819874054418, 'macro avg': {'precision': 0.34720480404020265, 'recall': 0.3468051305685094, 'f1-score': 0.34463192242878254, 'support': 252490}, 'weighted avg': {'precision': 0.3477467739533566, 'recall': 0.3451819874054418, 'f1-score': 0.3440983831314881, 'support': 252490}}
[[31204 22848 26082]
 [37434 25066 25545]
 [29762 23664 30885]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0938612
{'0': {'precision': 0.3593577698381192, 'recall': 0.406293636544983, 'f1-score': 0.38138707487770057, 'support': 20052}, '1': {'precision': 0.354575858923685, 'recall': 0.2905476107429369, 'f1-score': 0.31938434573040475, 'support': 20069}, '2': {'precision': 0.37363458127158994, 'recall': 0.3920262526326101, 'f1-score': 0.38260952699634315, 'support': 20417}, 'accuracy': 0.36311077339852654, 'macro avg': {'precision': 0.36252273667779805, 'recall': 0.3629558333068434, 'f1-score': 0.3611269825348162, 'support': 60538}, 'weighted avg': {'precision': 0.36258750139342977, 'recall': 0.36311077339852654, 'f1-score': 0.36124478464097726, 'support': 60538}}
[[8147 5340 6565]
 [7385 5831 6853]
 [7139 5274 8004]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991802
{'0': {'precision': 0.34322393120988254, 'recall': 0.39165284687672747, 'f1-score': 0.3658426386109856, 'support': 7236}, '1': {'precision': 0.3586646535816138, 'recall': 0.2901343465870539, 'f1-score': 0.3207801950487622, 'support': 7369}, '2': {'precision': 0.34733703753896195, 'recall': 0.3665617848970252, 'f1-score': 0.3566905573724863, 'support': 6992}, 'accuracy': 0.3488910496828263, 'macro avg': {'precision': 0.3497418741101528, 'recall': 0.3494496594536021, 'f1-score': 0.347771130344078, 'support': 21597}, 'weighted avg': {'precision': 0.34982399245034235, 'recall': 0.3488910496828263, 'f1-score': 0.3475041425870188, 'support': 21597}}
[[2834 1984 2418]
 [2833 2138 2398]
 [2590 1839 2563]]
training model: results/LILAK/W2/deepOF_L1/h500
Epoch 1/50
237/237 - 9s - loss: 3.3437 - accuracy500: 0.3341 - val_loss: 3.3087 - val_accuracy500: 0.3582 - 9s/epoch - 36ms/step
Epoch 2/50
237/237 - 7s - loss: 3.3219 - accuracy500: 0.3475 - val_loss: 3.3080 - val_accuracy500: 0.3533 - 7s/epoch - 28ms/step
Epoch 3/50
237/237 - 7s - loss: 3.3106 - accuracy500: 0.3478 - val_loss: 3.2992 - val_accuracy500: 0.3620 - 7s/epoch - 29ms/step
Epoch 4/50
237/237 - 7s - loss: 3.3064 - accuracy500: 0.3516 - val_loss: 3.2964 - val_accuracy500: 0.3608 - 7s/epoch - 29ms/step
Epoch 5/50
237/237 - 7s - loss: 3.3022 - accuracy500: 0.3535 - val_loss: 3.2966 - val_accuracy500: 0.3638 - 7s/epoch - 28ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2962 - accuracy500: 0.3562 - val_loss: 3.2950 - val_accuracy500: 0.3593 - 7s/epoch - 28ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2941 - accuracy500: 0.3578 - val_loss: 3.2940 - val_accuracy500: 0.3586 - 7s/epoch - 29ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2922 - accuracy500: 0.3610 - val_loss: 3.2948 - val_accuracy500: 0.3590 - 7s/epoch - 28ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2901 - accuracy500: 0.3613 - val_loss: 3.2944 - val_accuracy500: 0.3619 - 7s/epoch - 28ms/step
Epoch 10/50
237/237 - 7s - loss: 3.2853 - accuracy500: 0.3666 - val_loss: 3.2979 - val_accuracy500: 0.3593 - 7s/epoch - 28ms/step
Epoch 11/50
237/237 - 7s - loss: 3.2855 - accuracy500: 0.3657 - val_loss: 3.2949 - val_accuracy500: 0.3579 - 7s/epoch - 28ms/step
Epoch 12/50
237/237 - 7s - loss: 3.2834 - accuracy500: 0.3656 - val_loss: 3.2958 - val_accuracy500: 0.3575 - 7s/epoch - 28ms/step
Epoch 13/50
237/237 - 7s - loss: 3.2813 - accuracy500: 0.3663 - val_loss: 3.2972 - val_accuracy500: 0.3566 - 7s/epoch - 28ms/step
Epoch 14/50
237/237 - 7s - loss: 3.2810 - accuracy500: 0.3668 - val_loss: 3.2984 - val_accuracy500: 0.3553 - 7s/epoch - 28ms/step
Epoch 15/50
237/237 - 7s - loss: 3.2782 - accuracy500: 0.3701 - val_loss: 3.2930 - val_accuracy500: 0.3605 - 7s/epoch - 29ms/step
Epoch 16/50
237/237 - 7s - loss: 3.2776 - accuracy500: 0.3695 - val_loss: 3.2971 - val_accuracy500: 0.3560 - 7s/epoch - 28ms/step
Epoch 17/50
237/237 - 7s - loss: 3.2745 - accuracy500: 0.3732 - val_loss: 3.2973 - val_accuracy500: 0.3602 - 7s/epoch - 29ms/step
Epoch 18/50
237/237 - 7s - loss: 3.2737 - accuracy500: 0.3730 - val_loss: 3.3007 - val_accuracy500: 0.3577 - 7s/epoch - 28ms/step
Epoch 19/50
237/237 - 7s - loss: 3.2705 - accuracy500: 0.3758 - val_loss: 3.2981 - val_accuracy500: 0.3585 - 7s/epoch - 29ms/step
Epoch 20/50
237/237 - 7s - loss: 3.2684 - accuracy500: 0.3804 - val_loss: 3.2975 - val_accuracy500: 0.3596 - 7s/epoch - 30ms/step
Epoch 21/50
237/237 - 7s - loss: 3.2677 - accuracy500: 0.3786 - val_loss: 3.3017 - val_accuracy500: 0.3593 - 7s/epoch - 29ms/step
Epoch 22/50
237/237 - 7s - loss: 3.2670 - accuracy500: 0.3783 - val_loss: 3.2993 - val_accuracy500: 0.3606 - 7s/epoch - 30ms/step
Epoch 23/50
237/237 - 7s - loss: 3.2641 - accuracy500: 0.3807 - val_loss: 3.3038 - val_accuracy500: 0.3592 - 7s/epoch - 29ms/step
Epoch 24/50
237/237 - 7s - loss: 3.2628 - accuracy500: 0.3793 - val_loss: 3.3029 - val_accuracy500: 0.3584 - 7s/epoch - 30ms/step
Epoch 25/50
237/237 - 7s - loss: 3.2605 - accuracy500: 0.3839 - val_loss: 3.3053 - val_accuracy500: 0.3590 - 7s/epoch - 29ms/step
testing model: results/LILAK/W2/deepOF_L1/h500
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995929
{'0': {'precision': 0.3025380088278568, 'recall': 0.25603112840466924, 'f1-score': 0.2773484699468907, 'support': 77100}, '1': {'precision': 0.3731639010078302, 'recall': 0.6129621129934073, 'f1-score': 0.46390690440569843, 'support': 95864}, '2': {'precision': 0.344080604534005, 'recall': 0.12882579282247314, 'f1-score': 0.18746397562693845, 'support': 79526}, 'accuracy': 0.3514832270584974, 'macro avg': {'precision': 0.3399275047898973, 'recall': 0.33260634474018325, 'f1-score': 0.30957311665984255, 'support': 252490}, 'weighted avg': {'precision': 0.3424373988792177, 'recall': 0.3514832270584974, 'f1-score': 0.3198692963783162, 'support': 252490}}
[[19740 48569  8791]
 [26364 58761 10739]
 [19144 50137 10245]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0951933
{'0': {'precision': 0.37531848174038024, 'recall': 0.2848289538919187, 'f1-score': 0.32387180426755363, 'support': 20170}, '1': {'precision': 0.349347090117685, 'recall': 0.6431539374752672, 'f1-score': 0.4527631716404917, 'support': 20216}, '2': {'precision': 0.3897416697865968, 'recall': 0.1549722111949186, 'f1-score': 0.22176460145570745, 'support': 20152}, 'accuracy': 0.36126069576134, 'macro avg': {'precision': 0.37146908054822064, 'recall': 0.36098503418736816, 'f1-score': 0.33279985912125093, 'support': 60538}, 'weighted avg': {'precision': 0.371446838020121, 'recall': 0.36126069576134, 'f1-score': 0.3329240281888426, 'support': 60538}}
[[ 5745 12014  2411]
 [ 4735 13002  2479]
 [ 4827 12202  3123]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0983971
{'0': {'precision': 0.3243510996631662, 'recall': 0.23206691239013325, 'f1-score': 0.2705561523841005, 'support': 7054}, '1': {'precision': 0.37615658362989324, 'recall': 0.6527915019762845, 'f1-score': 0.4772870947349408, 'support': 8096}, '2': {'precision': 0.3216, 'recall': 0.12470916705444393, 'f1-score': 0.17972504750195598, 'support': 6447}, 'accuracy': 0.3577348705838774, 'macro avg': {'precision': 0.34070256109768654, 'recall': 0.33652252714028724, 'f1-score': 0.3091894315403324, 'support': 21597}, 'weighted avg': {'precision': 0.3429500188957536, 'recall': 0.3577348705838774, 'f1-score': 0.3209384080722617, 'support': 21597}}
[[1637 4586  831]
 [1946 5285  865]
 [1464 4179  804]]
training model: results/LILAK/W2/deepOF_L1/h1000
Epoch 1/50
237/237 - 9s - loss: 3.3391 - accuracy1000: 0.3467 - val_loss: 3.3548 - val_accuracy1000: 0.3364 - 9s/epoch - 36ms/step
Epoch 2/50
237/237 - 7s - loss: 3.3257 - accuracy1000: 0.3487 - val_loss: 3.3291 - val_accuracy1000: 0.3366 - 7s/epoch - 29ms/step
Epoch 3/50
237/237 - 7s - loss: 3.3137 - accuracy1000: 0.3510 - val_loss: 3.3266 - val_accuracy1000: 0.3351 - 7s/epoch - 29ms/step
Epoch 4/50
237/237 - 7s - loss: 3.3083 - accuracy1000: 0.3532 - val_loss: 3.3184 - val_accuracy1000: 0.3362 - 7s/epoch - 31ms/step
Epoch 5/50
237/237 - 7s - loss: 3.3030 - accuracy1000: 0.3551 - val_loss: 3.3194 - val_accuracy1000: 0.3336 - 7s/epoch - 30ms/step
Epoch 6/50
237/237 - 7s - loss: 3.3020 - accuracy1000: 0.3540 - val_loss: 3.3194 - val_accuracy1000: 0.3324 - 7s/epoch - 29ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2967 - accuracy1000: 0.3606 - val_loss: 3.3141 - val_accuracy1000: 0.3344 - 7s/epoch - 30ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2943 - accuracy1000: 0.3609 - val_loss: 3.3194 - val_accuracy1000: 0.3326 - 7s/epoch - 29ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2935 - accuracy1000: 0.3615 - val_loss: 3.3160 - val_accuracy1000: 0.3351 - 7s/epoch - 28ms/step
Epoch 10/50
237/237 - 7s - loss: 3.2887 - accuracy1000: 0.3670 - val_loss: 3.3157 - val_accuracy1000: 0.3309 - 7s/epoch - 28ms/step
Epoch 11/50
237/237 - 7s - loss: 3.2880 - accuracy1000: 0.3653 - val_loss: 3.3162 - val_accuracy1000: 0.3338 - 7s/epoch - 28ms/step
Epoch 12/50
237/237 - 7s - loss: 3.2861 - accuracy1000: 0.3670 - val_loss: 3.3195 - val_accuracy1000: 0.3320 - 7s/epoch - 29ms/step
Epoch 13/50
237/237 - 7s - loss: 3.2844 - accuracy1000: 0.3678 - val_loss: 3.3155 - val_accuracy1000: 0.3342 - 7s/epoch - 28ms/step
Epoch 14/50
237/237 - 7s - loss: 3.2820 - accuracy1000: 0.3706 - val_loss: 3.3176 - val_accuracy1000: 0.3353 - 7s/epoch - 28ms/step
Epoch 15/50
237/237 - 7s - loss: 3.2802 - accuracy1000: 0.3732 - val_loss: 3.3166 - val_accuracy1000: 0.3376 - 7s/epoch - 29ms/step
Epoch 16/50
237/237 - 6s - loss: 3.2780 - accuracy1000: 0.3728 - val_loss: 3.3215 - val_accuracy1000: 0.3341 - 6s/epoch - 27ms/step
Epoch 17/50
237/237 - 7s - loss: 3.2770 - accuracy1000: 0.3733 - val_loss: 3.3239 - val_accuracy1000: 0.3324 - 7s/epoch - 29ms/step
testing model: results/LILAK/W2/deepOF_L1/h1000
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013201
{'0': {'precision': 0.3405544336331926, 'recall': 0.09212012862055695, 'f1-score': 0.14501392485464404, 'support': 80547}, '1': {'precision': 0.3552075370914416, 'recall': 0.874334096524834, 'f1-score': 0.505180227379892, 'support': 88226}, '2': {'precision': 0.36088947990543735, 'recall': 0.05835135038283742, 'f1-score': 0.10045962592413601, 'support': 83717}, 'accuracy': 0.35424769297793973, 'macro avg': {'precision': 0.3522171502100238, 'recall': 0.34160185850940944, 'f1-score': 0.25021792605289067, 'support': 252490}, 'weighted avg': {'precision': 0.35241697779130177, 'recall': 0.35424769297793973, 'f1-score': 0.25609190799467807, 'support': 252490}}
[[ 7420 68655  4472]
 [ 6908 77139  4179]
 [ 7460 71372  4885]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1041703
{'0': {'precision': 0.38966778421213044, 'recall': 0.12222169112375125, 'f1-score': 0.18607866681221116, 'support': 20921}, '1': {'precision': 0.32576826591407965, 'recall': 0.8582640574172562, 'f1-score': 0.4722762853205665, 'support': 19367}, '2': {'precision': 0.39295392953929537, 'recall': 0.05728395061728395, 'f1-score': 0.09999138005344367, 'support': 20250}, 'accuracy': 0.335970795203013, 'macro avg': {'precision': 0.3694633265551685, 'recall': 0.3459232330527638, 'f1-score': 0.2527821107287404, 'support': 60538}, 'weighted avg': {'precision': 0.37032460260713423, 'recall': 0.335970795203013, 'f1-score': 0.24884125759463338, 'support': 60538}}
[[ 2557 17389   975]
 [ 1928 16622   817]
 [ 2077 17013  1160]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1060194
{'0': {'precision': 0.3335075797177209, 'recall': 0.08373802336264602, 'f1-score': 0.13386487620646245, 'support': 7619}, '1': {'precision': 0.33814410947188367, 'recall': 0.8557900432900433, 'f1-score': 0.4847509578544061, 'support': 7392}, '2': {'precision': 0.3165983606557377, 'recall': 0.04691770422107501, 'f1-score': 0.08172441153134093, 'support': 6586}, 'accuracy': 0.33675973514840024, 'macro avg': {'precision': 0.3294166832817807, 'recall': 0.3288152569579214, 'f1-score': 0.23344674853073646, 'support': 21597}, 'weighted avg': {'precision': 0.3299380613216728, 'recall': 0.33675973514840024, 'f1-score': 0.2380623487809519, 'support': 21597}}
[[ 638 6666  315]
 [ 714 6326  352]
 [ 561 5716  309]]
training model: results/LILAK/W2/deepLOB_L2/h10
Epoch 1/50
237/237 - 15s - loss: 3.3553 - accuracy10: 0.3393 - val_loss: 3.3100 - val_accuracy10: 0.3462 - 15s/epoch - 65ms/step
Epoch 2/50
237/237 - 13s - loss: 3.3114 - accuracy10: 0.3487 - val_loss: 3.3160 - val_accuracy10: 0.3678 - 13s/epoch - 53ms/step
Epoch 3/50
237/237 - 13s - loss: 3.2919 - accuracy10: 0.3614 - val_loss: 3.2747 - val_accuracy10: 0.3940 - 13s/epoch - 54ms/step
Epoch 4/50
237/237 - 13s - loss: 3.2746 - accuracy10: 0.3698 - val_loss: 3.2480 - val_accuracy10: 0.3883 - 13s/epoch - 54ms/step
Epoch 5/50
237/237 - 13s - loss: 3.2506 - accuracy10: 0.3847 - val_loss: 3.2285 - val_accuracy10: 0.3881 - 13s/epoch - 54ms/step
Epoch 6/50
237/237 - 13s - loss: 3.2250 - accuracy10: 0.3953 - val_loss: 3.2146 - val_accuracy10: 0.3845 - 13s/epoch - 53ms/step
Epoch 7/50
237/237 - 12s - loss: 3.2068 - accuracy10: 0.4039 - val_loss: 3.2066 - val_accuracy10: 0.3869 - 12s/epoch - 53ms/step
Epoch 8/50
237/237 - 13s - loss: 3.1868 - accuracy10: 0.4164 - val_loss: 3.2033 - val_accuracy10: 0.4057 - 13s/epoch - 54ms/step
Epoch 9/50
237/237 - 12s - loss: 3.1761 - accuracy10: 0.4216 - val_loss: 3.2177 - val_accuracy10: 0.4021 - 12s/epoch - 52ms/step
Epoch 10/50
237/237 - 13s - loss: 3.1617 - accuracy10: 0.4257 - val_loss: 3.2267 - val_accuracy10: 0.4035 - 13s/epoch - 53ms/step
Epoch 11/50
237/237 - 12s - loss: 3.1488 - accuracy10: 0.4345 - val_loss: 3.2351 - val_accuracy10: 0.4034 - 12s/epoch - 52ms/step
Epoch 12/50
237/237 - 12s - loss: 3.1287 - accuracy10: 0.4439 - val_loss: 3.2233 - val_accuracy10: 0.4172 - 12s/epoch - 52ms/step
Epoch 13/50
237/237 - 13s - loss: 3.1183 - accuracy10: 0.4498 - val_loss: 3.2220 - val_accuracy10: 0.4144 - 13s/epoch - 53ms/step
Epoch 14/50
237/237 - 12s - loss: 3.1089 - accuracy10: 0.4528 - val_loss: 3.2194 - val_accuracy10: 0.4213 - 12s/epoch - 53ms/step
Epoch 15/50
237/237 - 13s - loss: 3.1012 - accuracy10: 0.4559 - val_loss: 3.2426 - val_accuracy10: 0.4182 - 13s/epoch - 53ms/step
Epoch 16/50
237/237 - 13s - loss: 3.0825 - accuracy10: 0.4655 - val_loss: 3.2228 - val_accuracy10: 0.4208 - 13s/epoch - 53ms/step
Epoch 17/50
237/237 - 12s - loss: 3.0697 - accuracy10: 0.4680 - val_loss: 3.2622 - val_accuracy10: 0.4081 - 12s/epoch - 52ms/step
Epoch 18/50
237/237 - 12s - loss: 3.0545 - accuracy10: 0.4758 - val_loss: 3.2997 - val_accuracy10: 0.4185 - 12s/epoch - 52ms/step
testing model: results/LILAK/W2/deepLOB_L2/h10
Evaluating performance on  test set...
987/987 - 20s - 20s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.077574
{'0': {'precision': 0.32945161548945723, 'recall': 0.46962857142857145, 'f1-score': 0.38724497007963066, 'support': 70000}, '1': {'precision': 0.47049227905487223, 'recall': 0.415606573608324, 'f1-score': 0.44134959303799254, 'support': 113119}, '2': {'precision': 0.36381374554823065, 'recall': 0.27682483856088563, 'f1-score': 0.31441341147965035, 'support': 69376}, 'accuracy': 0.3924513356700133, 'macro avg': {'precision': 0.3879192133641867, 'recall': 0.38735332786592697, 'f1-score': 0.38100265819909124, 'support': 252495}, 'weighted avg': {'precision': 0.4020799287503679, 'recall': 0.3924513356700133, 'f1-score': 0.3914727711647797, 'support': 252495}}
[[32874 26121 11005]
 [43528 47013 22578]
 [23382 26789 19205]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0730963
{'0': {'precision': 0.34666860634274077, 'recall': 0.5512056901636501, 'f1-score': 0.42564022416218267, 'support': 17293}, '1': {'precision': 0.4722717369776193, 'recall': 0.37094076926068525, 'f1-score': 0.4155176544904049, 'support': 25713}, '2': {'precision': 0.40772164707713865, 'recall': 0.29875092682370386, 'f1-score': 0.34483212639894667, 'support': 17533}, 'accuracy': 0.4015262888385999, 'macro avg': {'precision': 0.40888733013249956, 'recall': 0.4069657954160131, 'f1-score': 0.39533000168384475, 'support': 60539}, 'weighted avg': {'precision': 0.41769845918488935, 'recall': 0.4015262888385999, 'f1-score': 0.3979375859941713, 'support': 60539}}
[[ 9532  5097  2664]
 [11230  9538  4945]
 [ 6734  5561  5238]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0713788
{'0': {'precision': 0.32099040820878877, 'recall': 0.5026196297589941, 'f1-score': 0.3917778382793357, 'support': 5726}, '1': {'precision': 0.49804839968774395, 'recall': 0.4476295479603087, 'f1-score': 0.47149493243243246, 'support': 9977}, '2': {'precision': 0.3689664575947641, 'recall': 0.22943869764286925, 'f1-score': 0.28293601003764113, 'support': 5897}, 'accuracy': 0.4026388888888889, 'macro avg': {'precision': 0.3960017551637656, 'recall': 0.3932292917873907, 'f1-score': 0.3820695935831364, 'support': 21600}, 'weighted avg': {'precision': 0.4158710722927995, 'recall': 0.4026388888888889, 'f1-score': 0.3988841895397141, 'support': 21600}}
[[2878 2143  705]
 [3902 4466 1609]
 [2186 2358 1353]]
training model: results/LILAK/W2/deepLOB_L2/h20
Epoch 1/50
237/237 - 15s - loss: 3.3614 - accuracy20: 0.3390 - val_loss: 3.3436 - val_accuracy20: 0.3395 - 15s/epoch - 62ms/step
Epoch 2/50
237/237 - 12s - loss: 3.3101 - accuracy20: 0.3533 - val_loss: 3.3196 - val_accuracy20: 0.3458 - 12s/epoch - 52ms/step
Epoch 3/50
237/237 - 12s - loss: 3.2902 - accuracy20: 0.3655 - val_loss: 3.3020 - val_accuracy20: 0.3571 - 12s/epoch - 52ms/step
Epoch 4/50
237/237 - 12s - loss: 3.2784 - accuracy20: 0.3751 - val_loss: 3.2805 - val_accuracy20: 0.3716 - 12s/epoch - 51ms/step
Epoch 5/50
237/237 - 12s - loss: 3.2584 - accuracy20: 0.3883 - val_loss: 3.2783 - val_accuracy20: 0.3722 - 12s/epoch - 51ms/step
Epoch 6/50
237/237 - 12s - loss: 3.2421 - accuracy20: 0.4008 - val_loss: 3.2601 - val_accuracy20: 0.3787 - 12s/epoch - 52ms/step
Epoch 7/50
237/237 - 12s - loss: 3.2377 - accuracy20: 0.4044 - val_loss: 3.2647 - val_accuracy20: 0.3853 - 12s/epoch - 52ms/step
Epoch 8/50
237/237 - 12s - loss: 3.2220 - accuracy20: 0.4140 - val_loss: 3.2566 - val_accuracy20: 0.3869 - 12s/epoch - 53ms/step
Epoch 9/50
237/237 - 12s - loss: 3.2117 - accuracy20: 0.4193 - val_loss: 3.2623 - val_accuracy20: 0.3886 - 12s/epoch - 52ms/step
Epoch 10/50
237/237 - 13s - loss: 3.2045 - accuracy20: 0.4227 - val_loss: 3.2535 - val_accuracy20: 0.4007 - 13s/epoch - 53ms/step
Epoch 11/50
237/237 - 13s - loss: 3.1942 - accuracy20: 0.4287 - val_loss: 3.2485 - val_accuracy20: 0.4028 - 13s/epoch - 53ms/step
Epoch 12/50
237/237 - 12s - loss: 3.1811 - accuracy20: 0.4331 - val_loss: 3.2424 - val_accuracy20: 0.4006 - 12s/epoch - 53ms/step
Epoch 13/50
237/237 - 12s - loss: 3.1760 - accuracy20: 0.4381 - val_loss: 3.2443 - val_accuracy20: 0.4020 - 12s/epoch - 53ms/step
Epoch 14/50
237/237 - 12s - loss: 3.1633 - accuracy20: 0.4411 - val_loss: 3.2549 - val_accuracy20: 0.4023 - 12s/epoch - 53ms/step
Epoch 15/50
237/237 - 13s - loss: 3.1572 - accuracy20: 0.4407 - val_loss: 3.2481 - val_accuracy20: 0.4029 - 13s/epoch - 53ms/step
Epoch 16/50
237/237 - 12s - loss: 3.1450 - accuracy20: 0.4482 - val_loss: 3.2739 - val_accuracy20: 0.3932 - 12s/epoch - 52ms/step
Epoch 17/50
237/237 - 12s - loss: 3.1339 - accuracy20: 0.4529 - val_loss: 3.2580 - val_accuracy20: 0.4026 - 12s/epoch - 53ms/step
Epoch 18/50
237/237 - 12s - loss: 3.1202 - accuracy20: 0.4582 - val_loss: 3.2770 - val_accuracy20: 0.3969 - 12s/epoch - 52ms/step
Epoch 19/50
237/237 - 12s - loss: 3.1106 - accuracy20: 0.4595 - val_loss: 3.2660 - val_accuracy20: 0.4024 - 12s/epoch - 52ms/step
Epoch 20/50
237/237 - 12s - loss: 3.1017 - accuracy20: 0.4638 - val_loss: 3.2850 - val_accuracy20: 0.3947 - 12s/epoch - 53ms/step
Epoch 21/50
237/237 - 13s - loss: 3.0952 - accuracy20: 0.4670 - val_loss: 3.3044 - val_accuracy20: 0.3909 - 13s/epoch - 53ms/step
Epoch 22/50
237/237 - 13s - loss: 3.0808 - accuracy20: 0.4717 - val_loss: 3.3285 - val_accuracy20: 0.3903 - 13s/epoch - 54ms/step
testing model: results/LILAK/W2/deepLOB_L2/h20
Evaluating performance on  test set...
987/987 - 20s - 20s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0901966
{'0': {'precision': 0.38706217405777266, 'recall': 0.261161438446757, 'f1-score': 0.31188531918698215, 'support': 80142}, '1': {'precision': 0.37592907351924404, 'recall': 0.5754271855363245, 'f1-score': 0.45476088831580685, 'support': 90710}, '2': {'precision': 0.41084048142614943, 'recall': 0.29978075278958394, 'f1-score': 0.34663210967595737, 'support': 81643}, 'accuracy': 0.38655022871740036, 'macro avg': {'precision': 0.3912772430010554, 'recall': 0.37878979225755516, 'f1-score': 0.37109277239291544, 'support': 252495}, 'weighted avg': {'precision': 0.3907511532400395, 'recall': 0.38655022871740036, 'f1-score': 0.3744492317063077, 'support': 252495}}
[[20930 42240 16972]
 [20387 52197 18126]
 [12757 44411 24475]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0842303
{'0': {'precision': 0.42994256348246673, 'recall': 0.28479175010012014, 'f1-score': 0.3426282823416044, 'support': 19976}, '1': {'precision': 0.3603685795091689, 'recall': 0.5930040534454286, 'f1-score': 0.4483032572920213, 'support': 19983}, '2': {'precision': 0.43046311702717693, 'recall': 0.30170068027210883, 'f1-score': 0.3547594560621643, 'support': 20580}, 'accuracy': 0.3922760534531459, 'macro avg': {'precision': 0.40692475333960415, 'recall': 0.39316549460588585, 'f1-score': 0.3818969985652633, 'support': 60539}, 'weighted avg': {'precision': 0.4071542133315182, 'recall': 0.3922760534531459, 'f1-score': 0.3816339246482713, 'support': 60539}}
[[ 5689 10224  4063]
 [ 3981 11850  4152]
 [ 3562 10809  6209]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0810386
{'0': {'precision': 0.38332598147331276, 'recall': 0.25975190554476163, 'f1-score': 0.30966592427616924, 'support': 6691}, '1': {'precision': 0.404877085595814, 'recall': 0.516628873771731, 'f1-score': 0.4539768638955, 'support': 7938}, '2': {'precision': 0.4020469943779732, 'recall': 0.4000860708650122, 'f1-score': 0.401064135749209, 'support': 6971}, 'accuracy': 0.39944444444444444, 'macro avg': {'precision': 0.3967500204823666, 'recall': 0.39215561672716825, 'f1-score': 0.3882356413069594, 'support': 21600}, 'weighted avg': {'precision': 0.39728787246788694, 'recall': 0.39944444444444444, 'f1-score': 0.39219727477972516, 'support': 21600}}
[[1738 3011 1942]
 [1631 4101 2206]
 [1165 3017 2789]]
training model: results/LILAK/W2/deepLOB_L2/h30
Epoch 1/50
237/237 - 15s - loss: 3.3641 - accuracy30: 0.3385 - val_loss: 3.3403 - val_accuracy30: 0.3408 - 15s/epoch - 63ms/step
Epoch 2/50
237/237 - 12s - loss: 3.3169 - accuracy30: 0.3478 - val_loss: 3.3225 - val_accuracy30: 0.3439 - 12s/epoch - 52ms/step
Epoch 3/50
237/237 - 12s - loss: 3.3009 - accuracy30: 0.3529 - val_loss: 3.3029 - val_accuracy30: 0.3508 - 12s/epoch - 52ms/step
Epoch 4/50
237/237 - 12s - loss: 3.2880 - accuracy30: 0.3648 - val_loss: 3.2995 - val_accuracy30: 0.3492 - 12s/epoch - 52ms/step
Epoch 5/50
237/237 - 13s - loss: 3.2733 - accuracy30: 0.3783 - val_loss: 3.2810 - val_accuracy30: 0.3638 - 13s/epoch - 53ms/step
Epoch 6/50
237/237 - 12s - loss: 3.2634 - accuracy30: 0.3847 - val_loss: 3.2703 - val_accuracy30: 0.3713 - 12s/epoch - 53ms/step
Epoch 7/50
237/237 - 13s - loss: 3.2507 - accuracy30: 0.3952 - val_loss: 3.2613 - val_accuracy30: 0.3806 - 13s/epoch - 53ms/step
Epoch 8/50
237/237 - 12s - loss: 3.2384 - accuracy30: 0.4040 - val_loss: 3.2559 - val_accuracy30: 0.3858 - 12s/epoch - 52ms/step
Epoch 9/50
237/237 - 12s - loss: 3.2307 - accuracy30: 0.4081 - val_loss: 3.2526 - val_accuracy30: 0.3866 - 12s/epoch - 52ms/step
Epoch 10/50
237/237 - 13s - loss: 3.2223 - accuracy30: 0.4125 - val_loss: 3.2520 - val_accuracy30: 0.3913 - 13s/epoch - 53ms/step
Epoch 11/50
237/237 - 13s - loss: 3.2112 - accuracy30: 0.4179 - val_loss: 3.2571 - val_accuracy30: 0.3844 - 13s/epoch - 53ms/step
Epoch 12/50
237/237 - 12s - loss: 3.2022 - accuracy30: 0.4248 - val_loss: 3.2589 - val_accuracy30: 0.3837 - 12s/epoch - 52ms/step
Epoch 13/50
237/237 - 13s - loss: 3.1941 - accuracy30: 0.4280 - val_loss: 3.2631 - val_accuracy30: 0.3863 - 13s/epoch - 53ms/step
Epoch 14/50
237/237 - 12s - loss: 3.1839 - accuracy30: 0.4330 - val_loss: 3.2672 - val_accuracy30: 0.3841 - 12s/epoch - 52ms/step
Epoch 15/50
237/237 - 12s - loss: 3.1742 - accuracy30: 0.4386 - val_loss: 3.2684 - val_accuracy30: 0.3851 - 12s/epoch - 52ms/step
Epoch 16/50
237/237 - 13s - loss: 3.1632 - accuracy30: 0.4421 - val_loss: 3.2762 - val_accuracy30: 0.3885 - 13s/epoch - 53ms/step
Epoch 17/50
237/237 - 12s - loss: 3.1536 - accuracy30: 0.4472 - val_loss: 3.2768 - val_accuracy30: 0.3901 - 12s/epoch - 53ms/step
Epoch 18/50
237/237 - 13s - loss: 3.1420 - accuracy30: 0.4520 - val_loss: 3.2990 - val_accuracy30: 0.3886 - 13s/epoch - 53ms/step
Epoch 19/50
237/237 - 13s - loss: 3.1313 - accuracy30: 0.4563 - val_loss: 3.2791 - val_accuracy30: 0.3940 - 13s/epoch - 53ms/step
Epoch 20/50
237/237 - 12s - loss: 3.1214 - accuracy30: 0.4586 - val_loss: 3.2944 - val_accuracy30: 0.3901 - 12s/epoch - 53ms/step
testing model: results/LILAK/W2/deepLOB_L2/h30
Evaluating performance on  test set...
987/987 - 20s - 20s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0914918
{'0': {'precision': 0.3479205189163805, 'recall': 0.30047400572862537, 'f1-score': 0.3224613040994532, 'support': 78902}, '1': {'precision': 0.363810966038154, 'recall': 0.4419071546338564, 'f1-score': 0.3990742288194392, 'support': 89159}, '2': {'precision': 0.4139241338505029, 'recall': 0.3728474311296397, 'f1-score': 0.3923134918904099, 'support': 84434}, 'accuracy': 0.37461731915483476, 'macro avg': {'precision': 0.3752185396016791, 'recall': 0.37174286383070715, 'f1-score': 0.3712830082697674, 'support': 252495}, 'weighted avg': {'precision': 0.3756031486646048, 'recall': 0.37461731915483476, 'f1-score': 0.3728727236485566, 'support': 252495}}
[[23708 33668 21526]
 [26711 39400 23048]
 [17723 35230 31481]]
Evaluating performance on  train set...
237/237 - 6s - 6s/epoch - 24ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0811007
{'0': {'precision': 0.40837758112094397, 'recall': 0.3478566762148852, 'f1-score': 0.37569540557409975, 'support': 19899}, '1': {'precision': 0.36846001974333664, 'recall': 0.44819132436083453, 'f1-score': 0.40443350865708033, 'support': 19987}, '2': {'precision': 0.42293925403330396, 'recall': 0.39476105166319664, 'f1-score': 0.4083646381167042, 'support': 20653}, 'accuracy': 0.396983762533243, 'macro avg': {'precision': 0.3999256182991948, 'recall': 0.3969363507463055, 'f1-score': 0.3961645174492947, 'support': 60539}, 'weighted avg': {'precision': 0.40016650943830523, 'recall': 0.396983762533243, 'f1-score': 0.39632848715823465, 'support': 60539}}
[[6922 7630 5347]
 [5252 8958 5777]
 [4776 7724 8153]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0847636
{'0': {'precision': 0.37913287585776667, 'recall': 0.35977504809826844, 'f1-score': 0.36920039486673245, 'support': 6757}, '1': {'precision': 0.39201974496092146, 'recall': 0.36518073828075104, 'f1-score': 0.37812458669488164, 'support': 7829}, '2': {'precision': 0.390880303989867, 'recall': 0.43997718848018247, 'f1-score': 0.41397813401301226, 'support': 7014}, 'accuracy': 0.3877777777777778, 'macro avg': {'precision': 0.3873443082695183, 'recall': 0.388310991619734, 'f1-score': 0.38710103852487543, 'support': 21600}, 'weighted avg': {'precision': 0.3876184202618014, 'recall': 0.3877777777777778, 'f1-score': 0.38697532820907443, 'support': 21600}}
[[2431 2257 2069]
 [2230 2859 2740]
 [1751 2177 3086]]
training model: results/LILAK/W2/deepLOB_L2/h50
Epoch 1/50
237/237 - 15s - loss: 3.3578 - accuracy50: 0.3415 - val_loss: 3.3681 - val_accuracy50: 0.3359 - 15s/epoch - 62ms/step
Epoch 2/50
237/237 - 12s - loss: 3.3220 - accuracy50: 0.3458 - val_loss: 3.3359 - val_accuracy50: 0.3350 - 12s/epoch - 53ms/step
Epoch 3/50
237/237 - 13s - loss: 3.3045 - accuracy50: 0.3496 - val_loss: 3.3198 - val_accuracy50: 0.3407 - 13s/epoch - 53ms/step
Epoch 4/50
237/237 - 13s - loss: 3.2939 - accuracy50: 0.3587 - val_loss: 3.3192 - val_accuracy50: 0.3399 - 13s/epoch - 53ms/step
Epoch 5/50
237/237 - 13s - loss: 3.2835 - accuracy50: 0.3664 - val_loss: 3.3000 - val_accuracy50: 0.3532 - 13s/epoch - 53ms/step
Epoch 6/50
237/237 - 12s - loss: 3.2704 - accuracy50: 0.3814 - val_loss: 3.3016 - val_accuracy50: 0.3584 - 12s/epoch - 52ms/step
Epoch 7/50
237/237 - 13s - loss: 3.2583 - accuracy50: 0.3924 - val_loss: 3.2967 - val_accuracy50: 0.3601 - 13s/epoch - 53ms/step
Epoch 8/50
237/237 - 13s - loss: 3.2497 - accuracy50: 0.3963 - val_loss: 3.2951 - val_accuracy50: 0.3625 - 13s/epoch - 53ms/step
Epoch 9/50
237/237 - 12s - loss: 3.2400 - accuracy50: 0.4032 - val_loss: 3.2887 - val_accuracy50: 0.3656 - 12s/epoch - 53ms/step
Epoch 10/50
237/237 - 12s - loss: 3.2338 - accuracy50: 0.4066 - val_loss: 3.2767 - val_accuracy50: 0.3761 - 12s/epoch - 52ms/step
Epoch 11/50
237/237 - 12s - loss: 3.2239 - accuracy50: 0.4099 - val_loss: 3.2752 - val_accuracy50: 0.3768 - 12s/epoch - 53ms/step
Epoch 12/50
237/237 - 12s - loss: 3.2159 - accuracy50: 0.4150 - val_loss: 3.2782 - val_accuracy50: 0.3814 - 12s/epoch - 52ms/step
Epoch 13/50
237/237 - 12s - loss: 3.2035 - accuracy50: 0.4230 - val_loss: 3.2867 - val_accuracy50: 0.3807 - 12s/epoch - 53ms/step
Epoch 14/50
237/237 - 12s - loss: 3.1986 - accuracy50: 0.4220 - val_loss: 3.2853 - val_accuracy50: 0.3817 - 12s/epoch - 53ms/step
Epoch 15/50
237/237 - 12s - loss: 3.1910 - accuracy50: 0.4279 - val_loss: 3.2994 - val_accuracy50: 0.3729 - 12s/epoch - 53ms/step
Epoch 16/50
237/237 - 12s - loss: 3.1839 - accuracy50: 0.4297 - val_loss: 3.2981 - val_accuracy50: 0.3707 - 12s/epoch - 53ms/step
Epoch 17/50
237/237 - 13s - loss: 3.1735 - accuracy50: 0.4361 - val_loss: 3.3056 - val_accuracy50: 0.3712 - 13s/epoch - 53ms/step
Epoch 18/50
237/237 - 13s - loss: 3.1677 - accuracy50: 0.4377 - val_loss: 3.3326 - val_accuracy50: 0.3673 - 13s/epoch - 53ms/step
Epoch 19/50
237/237 - 13s - loss: 3.1530 - accuracy50: 0.4447 - val_loss: 3.3490 - val_accuracy50: 0.3613 - 13s/epoch - 53ms/step
Epoch 20/50
237/237 - 13s - loss: 3.1417 - accuracy50: 0.4483 - val_loss: 3.3536 - val_accuracy50: 0.3640 - 13s/epoch - 53ms/step
Epoch 21/50
237/237 - 13s - loss: 3.1339 - accuracy50: 0.4505 - val_loss: 3.3881 - val_accuracy50: 0.3571 - 13s/epoch - 54ms/step
testing model: results/LILAK/W2/deepLOB_L2/h50
Evaluating performance on  test set...
987/987 - 20s - 20s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1080046
{'0': {'precision': 0.3273746093703229, 'recall': 0.3487588969106355, 'f1-score': 0.33772858933898237, 'support': 78398}, '1': {'precision': 0.3439339727248825, 'recall': 0.34031218187987783, 'f1-score': 0.34211349203190644, 'support': 88410}, '2': {'precision': 0.3983704921653558, 'recall': 0.37889061351196796, 'f1-score': 0.38838644846396786, 'support': 85687}, 'accuracy': 0.3560268520168716, 'macro avg': {'precision': 0.356559691420187, 'recall': 0.3559872307674938, 'f1-score': 0.3560761766116189, 'support': 252495}, 'weighted avg': {'precision': 0.35726604295607556, 'recall': 0.3560268520168716, 'f1-score': 0.35645525411224144, 'support': 252495}}
[[27342 27693 23363]
 [32655 30087 25668]
 [23522 29699 32466]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.102176
{'0': {'precision': 0.3792123629112662, 'recall': 0.38684906427990234, 'f1-score': 0.38299264928003224, 'support': 19664}, '1': {'precision': 0.36217492165561027, 'recall': 0.44366337620899393, 'f1-score': 0.3987989872056287, 'support': 20058}, '2': {'precision': 0.4060221272315816, 'recall': 0.31027525580054766, 'f1-score': 0.3517494894486045, 'support': 20817}, 'accuracy': 0.37934224219098434, 'macro avg': {'precision': 0.3824698039328194, 'recall': 0.3802625654298146, 'f1-score': 0.37784704197808844, 'support': 60539}, 'weighted avg': {'precision': 0.382786288267649, 'recall': 0.37934224219098434, 'f1-score': 0.37748635858974633, 'support': 60539}}
[[7607 7437 4620]
 [6330 8899 4829]
 [6123 8235 6459]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.090553
{'0': {'precision': 0.3688594879333578, 'recall': 0.4328637147786084, 'f1-score': 0.3983067663205238, 'support': 6956}, '1': {'precision': 0.37454156479217604, 'recall': 0.3346075085324232, 'f1-score': 0.3534501406013411, 'support': 7325}, '2': {'precision': 0.39576381836645874, 'recall': 0.3727285148244296, 'f1-score': 0.38390092879256965, 'support': 7319}, 'accuracy': 0.37916666666666665, 'macro avg': {'precision': 0.37972162369733087, 'recall': 0.38006657937848703, 'f1-score': 0.37855261190481154, 'support': 21600}, 'weighted avg': {'precision': 0.37990272901811284, 'recall': 0.37916666666666665, 'f1-score': 0.3782136594566299, 'support': 21600}}
[[3011 1944 2001]
 [2710 2451 2164]
 [2442 2149 2728]]
training model: results/LILAK/W2/deepLOB_L2/h100
Epoch 1/50
237/237 - 15s - loss: 3.3641 - accuracy100: 0.3444 - val_loss: 3.3612 - val_accuracy100: 0.3365 - 15s/epoch - 63ms/step
Epoch 2/50
237/237 - 13s - loss: 3.3121 - accuracy100: 0.3580 - val_loss: 3.3476 - val_accuracy100: 0.3405 - 13s/epoch - 53ms/step
Epoch 3/50
237/237 - 13s - loss: 3.2963 - accuracy100: 0.3621 - val_loss: 3.3261 - val_accuracy100: 0.3414 - 13s/epoch - 53ms/step
Epoch 4/50
237/237 - 13s - loss: 3.2823 - accuracy100: 0.3718 - val_loss: 3.3107 - val_accuracy100: 0.3520 - 13s/epoch - 53ms/step
Epoch 5/50
237/237 - 13s - loss: 3.2711 - accuracy100: 0.3789 - val_loss: 3.3063 - val_accuracy100: 0.3465 - 13s/epoch - 53ms/step
Epoch 6/50
237/237 - 13s - loss: 3.2585 - accuracy100: 0.3880 - val_loss: 3.2973 - val_accuracy100: 0.3629 - 13s/epoch - 53ms/step
Epoch 7/50
237/237 - 13s - loss: 3.2478 - accuracy100: 0.3955 - val_loss: 3.3116 - val_accuracy100: 0.3569 - 13s/epoch - 53ms/step
Epoch 8/50
237/237 - 13s - loss: 3.2346 - accuracy100: 0.4039 - val_loss: 3.3106 - val_accuracy100: 0.3608 - 13s/epoch - 54ms/step
Epoch 9/50
237/237 - 13s - loss: 3.2250 - accuracy100: 0.4094 - val_loss: 3.3184 - val_accuracy100: 0.3691 - 13s/epoch - 54ms/step
Epoch 10/50
237/237 - 13s - loss: 3.2113 - accuracy100: 0.4195 - val_loss: 3.3457 - val_accuracy100: 0.3564 - 13s/epoch - 54ms/step
Epoch 11/50
237/237 - 13s - loss: 3.1963 - accuracy100: 0.4244 - val_loss: 3.3493 - val_accuracy100: 0.3652 - 13s/epoch - 53ms/step
Epoch 12/50
237/237 - 12s - loss: 3.1871 - accuracy100: 0.4291 - val_loss: 3.3349 - val_accuracy100: 0.3645 - 12s/epoch - 52ms/step
Epoch 13/50
237/237 - 12s - loss: 3.1745 - accuracy100: 0.4358 - val_loss: 3.3604 - val_accuracy100: 0.3554 - 12s/epoch - 53ms/step
Epoch 14/50
237/237 - 13s - loss: 3.1598 - accuracy100: 0.4429 - val_loss: 3.3592 - val_accuracy100: 0.3621 - 13s/epoch - 53ms/step
Epoch 15/50
237/237 - 13s - loss: 3.1454 - accuracy100: 0.4488 - val_loss: 3.3591 - val_accuracy100: 0.3625 - 13s/epoch - 53ms/step
Epoch 16/50
237/237 - 12s - loss: 3.1308 - accuracy100: 0.4554 - val_loss: 3.3656 - val_accuracy100: 0.3710 - 12s/epoch - 52ms/step
testing model: results/LILAK/W2/deepLOB_L2/h100
Evaluating performance on  test set...
987/987 - 20s - 20s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1074554
{'0': {'precision': 0.2890537628542593, 'recall': 0.14351883202188603, 'f1-score': 0.1918043765498018, 'support': 73837}, '1': {'precision': 0.38719968230855784, 'recall': 0.601155000205516, 'f1-score': 0.4710192185373944, 'support': 97316}, '2': {'precision': 0.32183677251946124, 'recall': 0.2561653266455214, 'f1-score': 0.28527032022233484, 'support': 81342}, 'accuracy': 0.3561892314699301, 'macro avg': {'precision': 0.3326967392274261, 'recall': 0.3336130529576411, 'f1-score': 0.31603130510317706, 'support': 252495}, 'weighted avg': {'precision': 0.33744206309704183, 'recall': 0.3561892314699301, 'f1-score': 0.32952899823765996, 'support': 252495}}
[[10597 44228 19012]
 [13919 58502 24895]
 [12145 48360 20837]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1023401
{'0': {'precision': 0.36693548387096775, 'recall': 0.10181041497152156, 'f1-score': 0.15939490445859872, 'support': 19664}, '1': {'precision': 0.3541419416093045, 'recall': 0.7439912236960208, 'f1-score': 0.47986620352502257, 'support': 20054}, '2': {'precision': 0.38369489693507297, 'recall': 0.23870131117621632, 'f1-score': 0.2943092319535738, 'support': 20821}, 'accuracy': 0.3616181304613555, 'macro avg': {'precision': 0.3682574408051151, 'recall': 0.36150098328125285, 'f1-score': 0.3111901133123984, 'support': 60539}, 'weighted avg': {'precision': 0.36846154216219057, 'recall': 0.3616181304613555, 'f1-score': 0.3119541248661201, 'support': 60539}}
[[ 2002 13283  4379]
 [ 1530 14920  3604]
 [ 1924 13927  4970]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 24ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1005023
{'0': {'precision': 0.32667569397427215, 'recall': 0.14022086602731765, 'f1-score': 0.1962179747864986, 'support': 6882}, '1': {'precision': 0.35992084633533755, 'recall': 0.6302812208449954, 'f1-score': 0.4581920356554598, 'support': 7503}, '2': {'precision': 0.3698928636281097, 'recall': 0.28232848232848234, 'f1-score': 0.32023266781952525, 'support': 7215}, 'accuracy': 0.35791666666666666, 'macro avg': {'precision': 0.35216313464590643, 'recall': 0.3509435230669318, 'f1-score': 0.32488089275382787, 'support': 21600}, 'weighted avg': {'precision': 0.35265950217878655, 'recall': 0.35791666666666666, 'f1-score': 0.32864192797784597, 'support': 21600}}
[[ 965 4215 1702]
 [1006 4729 1768]
 [ 983 4195 2037]]
training model: results/LILAK/W2/deepLOB_L2/h200
Epoch 1/50
237/237 - 15s - loss: 3.3583 - accuracy200: 0.3469 - val_loss: 3.3616 - val_accuracy200: 0.3336 - 15s/epoch - 62ms/step
Epoch 2/50
237/237 - 13s - loss: 3.3183 - accuracy200: 0.3535 - val_loss: 3.3437 - val_accuracy200: 0.3374 - 13s/epoch - 53ms/step
Epoch 3/50
237/237 - 13s - loss: 3.3043 - accuracy200: 0.3599 - val_loss: 3.3254 - val_accuracy200: 0.3426 - 13s/epoch - 54ms/step
Epoch 4/50
237/237 - 13s - loss: 3.2996 - accuracy200: 0.3609 - val_loss: 3.3142 - val_accuracy200: 0.3406 - 13s/epoch - 53ms/step
Epoch 5/50
237/237 - 13s - loss: 3.2846 - accuracy200: 0.3735 - val_loss: 3.3089 - val_accuracy200: 0.3443 - 13s/epoch - 54ms/step
Epoch 6/50
237/237 - 13s - loss: 3.2675 - accuracy200: 0.3857 - val_loss: 3.3128 - val_accuracy200: 0.3564 - 13s/epoch - 53ms/step
Epoch 7/50
237/237 - 12s - loss: 3.2595 - accuracy200: 0.3924 - val_loss: 3.3384 - val_accuracy200: 0.3560 - 12s/epoch - 52ms/step
Epoch 8/50
237/237 - 12s - loss: 3.2452 - accuracy200: 0.3999 - val_loss: 3.3269 - val_accuracy200: 0.3621 - 12s/epoch - 52ms/step
Epoch 9/50
237/237 - 12s - loss: 3.2353 - accuracy200: 0.4061 - val_loss: 3.3370 - val_accuracy200: 0.3573 - 12s/epoch - 51ms/step
Epoch 10/50
237/237 - 12s - loss: 3.2200 - accuracy200: 0.4143 - val_loss: 3.3422 - val_accuracy200: 0.3605 - 12s/epoch - 51ms/step
Epoch 11/50
237/237 - 12s - loss: 3.2060 - accuracy200: 0.4204 - val_loss: 3.3558 - val_accuracy200: 0.3593 - 12s/epoch - 51ms/step
Epoch 12/50
237/237 - 12s - loss: 3.1892 - accuracy200: 0.4290 - val_loss: 3.3697 - val_accuracy200: 0.3545 - 12s/epoch - 51ms/step
Epoch 13/50
237/237 - 12s - loss: 3.1776 - accuracy200: 0.4364 - val_loss: 3.4016 - val_accuracy200: 0.3575 - 12s/epoch - 52ms/step
Epoch 14/50
237/237 - 12s - loss: 3.1640 - accuracy200: 0.4408 - val_loss: 3.4674 - val_accuracy200: 0.3480 - 12s/epoch - 52ms/step
Epoch 15/50
237/237 - 12s - loss: 3.1537 - accuracy200: 0.4445 - val_loss: 3.4667 - val_accuracy200: 0.3467 - 12s/epoch - 52ms/step
testing model: results/LILAK/W2/deepLOB_L2/h200
Evaluating performance on  test set...
987/987 - 20s - 20s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1082977
{'0': {'precision': 0.3166248668705122, 'recall': 0.34196237523345413, 'f1-score': 0.3288062222010798, 'support': 80851}, '1': {'precision': 0.3408152978609457, 'recall': 0.2572250555773506, 'f1-score': 0.2931783229338157, 'support': 84117}, '2': {'precision': 0.3521064432381402, 'recall': 0.40907377152193036, 'f1-score': 0.3784583674655815, 'support': 87527}, 'accuracy': 0.33699677221331115, 'macro avg': {'precision': 0.336515535989866, 'recall': 0.33608706744424505, 'f1-score': 0.33348097086682565, 'support': 252495}, 'weighted avg': {'precision': 0.3369833785968897, 'recall': 0.33699677221331115, 'f1-score': 0.3341488678610001, 'support': 252495}}
[[27648 20573 32630]
 [29227 21637 33253]
 [30446 21276 35805]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1034744
{'0': {'precision': 0.349862258953168, 'recall': 0.3315760405683587, 'f1-score': 0.3404737968190138, 'support': 19917}, '1': {'precision': 0.3508373767412741, 'recall': 0.452348519247263, 'f1-score': 0.3951781739647839, 'support': 19821}, '2': {'precision': 0.37263301670081334, 'recall': 0.2885438200086534, 'f1-score': 0.32524114013222066, 'support': 20801}, 'accuracy': 0.35633228166966746, 'macro avg': {'precision': 0.3577775507984185, 'recall': 0.35748945994142506, 'f1-score': 0.3536310369720061, 'support': 60539}, 'weighted avg': {'precision': 0.35800547806129374, 'recall': 0.35633228166966746, 'f1-score': 0.35315059966782736, 'support': 60539}}
[[6604 8063 5250]
 [6000 8966 4855]
 [6272 8527 6002]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1039186
{'0': {'precision': 0.3393924898349677, 'recall': 0.38073517574456667, 'f1-score': 0.35887708649468897, 'support': 7454}, '1': {'precision': 0.3305687203791469, 'recall': 0.24614027348919276, 'f1-score': 0.28217446270543617, 'support': 6801}, '2': {'precision': 0.35539515537068755, 'recall': 0.3955071477195371, 'f1-score': 0.37437979251240416, 'support': 7345}, 'accuracy': 0.34337962962962965, 'macro avg': {'precision': 0.34178545519493403, 'recall': 0.34079419898443214, 'f1-score': 0.33847711390417645, 'support': 21600}, 'weighted avg': {'precision': 0.34205587512620966, 'recall': 0.34337962962962965, 'f1-score': 0.3399980509071617, 'support': 21600}}
[[2838 1783 2833]
 [2691 1674 2436]
 [2833 1607 2905]]
training model: results/LILAK/W2/deepLOB_L2/h300
Epoch 1/50
237/237 - 15s - loss: 3.3695 - accuracy300: 0.3382 - val_loss: 3.3392 - val_accuracy300: 0.3364 - 15s/epoch - 63ms/step
Epoch 2/50
237/237 - 13s - loss: 3.3218 - accuracy300: 0.3509 - val_loss: 3.3127 - val_accuracy300: 0.3544 - 13s/epoch - 53ms/step
Epoch 3/50
237/237 - 13s - loss: 3.2992 - accuracy300: 0.3610 - val_loss: 3.3030 - val_accuracy300: 0.3581 - 13s/epoch - 53ms/step
Epoch 4/50
237/237 - 13s - loss: 3.2822 - accuracy300: 0.3750 - val_loss: 3.3023 - val_accuracy300: 0.3605 - 13s/epoch - 53ms/step
Epoch 5/50
237/237 - 12s - loss: 3.2728 - accuracy300: 0.3809 - val_loss: 3.3137 - val_accuracy300: 0.3582 - 12s/epoch - 53ms/step
Epoch 6/50
237/237 - 12s - loss: 3.2518 - accuracy300: 0.3957 - val_loss: 3.3245 - val_accuracy300: 0.3512 - 12s/epoch - 53ms/step
Epoch 7/50
237/237 - 12s - loss: 3.2417 - accuracy300: 0.4032 - val_loss: 3.3478 - val_accuracy300: 0.3466 - 12s/epoch - 52ms/step
Epoch 8/50
237/237 - 12s - loss: 3.2291 - accuracy300: 0.4099 - val_loss: 3.3274 - val_accuracy300: 0.3534 - 12s/epoch - 53ms/step
Epoch 9/50
237/237 - 12s - loss: 3.2119 - accuracy300: 0.4166 - val_loss: 3.3473 - val_accuracy300: 0.3555 - 12s/epoch - 53ms/step
Epoch 10/50
237/237 - 12s - loss: 3.1954 - accuracy300: 0.4275 - val_loss: 3.3801 - val_accuracy300: 0.3573 - 12s/epoch - 52ms/step
Epoch 11/50
237/237 - 12s - loss: 3.1778 - accuracy300: 0.4327 - val_loss: 3.3812 - val_accuracy300: 0.3577 - 12s/epoch - 52ms/step
Epoch 12/50
237/237 - 12s - loss: 3.1720 - accuracy300: 0.4371 - val_loss: 3.4019 - val_accuracy300: 0.3592 - 12s/epoch - 52ms/step
Epoch 13/50
237/237 - 13s - loss: 3.1486 - accuracy300: 0.4474 - val_loss: 3.4028 - val_accuracy300: 0.3540 - 13s/epoch - 53ms/step
Epoch 14/50
237/237 - 12s - loss: 3.1356 - accuracy300: 0.4508 - val_loss: 3.4102 - val_accuracy300: 0.3566 - 12s/epoch - 52ms/step
testing model: results/LILAK/W2/deepLOB_L2/h300
Evaluating performance on  test set...
987/987 - 19s - 19s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.108892
{'0': {'precision': 0.3187410919456645, 'recall': 0.13674253768593392, 'f1-score': 0.19138104178491902, 'support': 80136}, '1': {'precision': 0.3471628418736247, 'recall': 0.5017036549076619, 'f1-score': 0.4103657460308613, 'support': 88046}, '2': {'precision': 0.35104978212069193, 'recall': 0.3783758139314222, 'f1-score': 0.3642009486897009, 'support': 84313}, 'accuracy': 0.344691974098497, 'macro avg': {'precision': 0.3389845719799937, 'recall': 0.3389406688416727, 'f1-score': 0.3219825788351604, 'support': 252495}, 'weighted avg': {'precision': 0.3394403691150511, 'recall': 0.344691974098497, 'f1-score': 0.3254498038629844, 'support': 252495}}
[[10958 40691 28487]
 [13386 44173 30487]
 [10035 42376 31902]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 23ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1115997
{'0': {'precision': 0.37271028037383175, 'recall': 0.09965515518016893, 'f1-score': 0.15726172167672228, 'support': 20009}, '1': {'precision': 0.34436464228612035, 'recall': 0.6748396080966828, 'f1-score': 0.4560241976138464, 'support': 20107}, '2': {'precision': 0.36259977194982895, 'recall': 0.28027224208000784, 'f1-score': 0.3161644894915629, 'support': 20423}, 'accuracy': 0.35162457258957036, 'macro avg': {'precision': 0.359891564869927, 'recall': 0.35158900178561986, 'f1-score': 0.3098168029273772, 'support': 60539}, 'weighted avg': {'precision': 0.35988495027962764, 'recall': 0.35162457258957036, 'f1-score': 0.3100968912492333, 'support': 60539}}
[[ 1994 12795  5220]
 [ 1696 13569  4842]
 [ 1660 13039  5724]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1004117
{'0': {'precision': 0.37746284134116836, 'recall': 0.15084956485702444, 'f1-score': 0.21555467824713778, 'support': 7239}, '1': {'precision': 0.3640545557259301, 'recall': 0.6113294484347472, 'f1-score': 0.4563480020232676, 'support': 7379}, '2': {'precision': 0.3416719442685244, 'recall': 0.3090804926955027, 'f1-score': 0.32456008422319144, 'support': 6982}, 'accuracy': 0.35930555555555554, 'macro avg': {'precision': 0.36106311377854095, 'recall': 0.3570865019957581, 'f1-score': 0.3321542548311989, 'support': 21600}, 'weighted avg': {'precision': 0.36131322176172187, 'recall': 0.35930555555555554, 'f1-score': 0.3330495708706965, 'support': 21600}}
[[1092 3999 2148]
 [ 858 4511 2010]
 [ 943 3881 2158]]
training model: results/LILAK/W2/deepLOB_L2/h500
Epoch 1/50
237/237 - 15s - loss: 3.3654 - accuracy500: 0.3423 - val_loss: 3.3313 - val_accuracy500: 0.3622 - 15s/epoch - 61ms/step
Epoch 2/50
237/237 - 13s - loss: 3.3206 - accuracy500: 0.3580 - val_loss: 3.3298 - val_accuracy500: 0.3569 - 13s/epoch - 53ms/step
Epoch 3/50
237/237 - 12s - loss: 3.3019 - accuracy500: 0.3611 - val_loss: 3.3326 - val_accuracy500: 0.3620 - 12s/epoch - 52ms/step
Epoch 4/50
237/237 - 12s - loss: 3.2841 - accuracy500: 0.3760 - val_loss: 3.3287 - val_accuracy500: 0.3561 - 12s/epoch - 53ms/step
Epoch 5/50
237/237 - 12s - loss: 3.2657 - accuracy500: 0.3836 - val_loss: 3.3359 - val_accuracy500: 0.3638 - 12s/epoch - 52ms/step
Epoch 6/50
237/237 - 12s - loss: 3.2668 - accuracy500: 0.3833 - val_loss: 3.3334 - val_accuracy500: 0.3667 - 12s/epoch - 52ms/step
Epoch 7/50
237/237 - 13s - loss: 3.2462 - accuracy500: 0.4007 - val_loss: 3.3315 - val_accuracy500: 0.3677 - 13s/epoch - 53ms/step
Epoch 8/50
237/237 - 13s - loss: 3.2205 - accuracy500: 0.4146 - val_loss: 3.3452 - val_accuracy500: 0.3706 - 13s/epoch - 53ms/step
Epoch 9/50
237/237 - 13s - loss: 3.2104 - accuracy500: 0.4216 - val_loss: 3.3638 - val_accuracy500: 0.3791 - 13s/epoch - 53ms/step
Epoch 10/50
237/237 - 13s - loss: 3.1920 - accuracy500: 0.4321 - val_loss: 3.3858 - val_accuracy500: 0.3508 - 13s/epoch - 53ms/step
Epoch 11/50
237/237 - 12s - loss: 3.1745 - accuracy500: 0.4420 - val_loss: 3.4142 - val_accuracy500: 0.3519 - 12s/epoch - 52ms/step
Epoch 12/50
237/237 - 12s - loss: 3.1574 - accuracy500: 0.4448 - val_loss: 3.4033 - val_accuracy500: 0.3498 - 12s/epoch - 52ms/step
Epoch 13/50
237/237 - 12s - loss: 3.1371 - accuracy500: 0.4562 - val_loss: 3.4602 - val_accuracy500: 0.3406 - 12s/epoch - 52ms/step
Epoch 14/50
237/237 - 13s - loss: 3.1316 - accuracy500: 0.4581 - val_loss: 3.4431 - val_accuracy500: 0.3422 - 13s/epoch - 53ms/step
testing model: results/LILAK/W2/deepLOB_L2/h500
Evaluating performance on  test set...
987/987 - 19s - 19s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1126963
{'0': {'precision': 0.30315414785274053, 'recall': 0.23859303260615808, 'f1-score': 0.2670266504093364, 'support': 77102}, '1': {'precision': 0.37804354755657993, 'recall': 0.6433109059615084, 'f1-score': 0.4762294543952247, 'support': 95865}, '2': {'precision': 0.282103134479272, 'recall': 0.10173775274117292, 'f1-score': 0.14954393811974973, 'support': 79528}, 'accuracy': 0.349147507871443, 'macro avg': {'precision': 0.3211002766295308, 'recall': 0.3278805637696131, 'f1-score': 0.2976000143081036, 'support': 252495}, 'weighted avg': {'precision': 0.32495706399382596, 'recall': 0.349147507871443, 'f1-score': 0.3094514970840861, 'support': 252495}}
[[18396 50579  8127]
 [21731 61671 12463]
 [20555 50882  8091]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1179639
{'0': {'precision': 0.32895247601619254, 'recall': 0.2947577639751553, 'f1-score': 0.3109177629854814, 'support': 20125}, '1': {'precision': 0.3420698000605044, 'recall': 0.6144042679312389, 'f1-score': 0.43946647822630514, 'support': 20244}, '2': {'precision': 0.34955248169243286, 'recall': 0.10649479424888449, 'f1-score': 0.16325289758692763, 'support': 20170}, 'accuracy': 0.3389220172120451, 'macro avg': {'precision': 0.34019158592304327, 'recall': 0.3385522753850929, 'f1-score': 0.3045457129329047, 'support': 60539}, 'weighted avg': {'precision': 0.34020223604597194, 'recall': 0.3389220172120451, 'f1-score': 0.30470589718403784, 'support': 60539}}
[[ 5932 11999  2194]
 [ 6003 12438  1803]
 [ 6098 11924  2148]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 24ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1097212
{'0': {'precision': 0.30710805388363427, 'recall': 0.3043169554103948, 'f1-score': 0.30570613409415126, 'support': 7042}, '1': {'precision': 0.38385677438931876, 'recall': 0.6239980268837094, 'f1-score': 0.4753182095721197, 'support': 8109}, '2': {'precision': 0.3111111111111111, 'recall': 0.06946813459451077, 'f1-score': 0.11357586512866015, 'support': 6449}, 'accuracy': 0.35421296296296295, 'macro avg': {'precision': 0.33402531312802136, 'recall': 0.332594372296205, 'f1-score': 0.29820006959831036, 'support': 21600}, 'weighted avg': {'precision': 0.33711597474662475, 'recall': 0.35421296296296295, 'f1-score': 0.3120179959225028, 'support': 21600}}
[[2143 4382  517]
 [2574 5060  475]
 [2261 3740  448]]
training model: results/LILAK/W2/deepLOB_L2/h1000
Epoch 1/50
237/237 - 15s - loss: 3.3647 - accuracy1000: 0.3480 - val_loss: 3.4202 - val_accuracy1000: 0.3311 - 15s/epoch - 62ms/step
Epoch 2/50
237/237 - 12s - loss: 3.3122 - accuracy1000: 0.3719 - val_loss: 3.4718 - val_accuracy1000: 0.3255 - 12s/epoch - 52ms/step
Epoch 3/50
237/237 - 12s - loss: 3.3069 - accuracy1000: 0.3732 - val_loss: 3.4448 - val_accuracy1000: 0.3269 - 12s/epoch - 53ms/step
Epoch 4/50
237/237 - 12s - loss: 3.2632 - accuracy1000: 0.3935 - val_loss: 3.4152 - val_accuracy1000: 0.3452 - 12s/epoch - 53ms/step
Epoch 5/50
237/237 - 12s - loss: 3.2451 - accuracy1000: 0.4002 - val_loss: 3.4127 - val_accuracy1000: 0.3445 - 12s/epoch - 53ms/step
Epoch 6/50
237/237 - 12s - loss: 3.2251 - accuracy1000: 0.4131 - val_loss: 3.4600 - val_accuracy1000: 0.3478 - 12s/epoch - 52ms/step
Epoch 7/50
237/237 - 12s - loss: 3.1971 - accuracy1000: 0.4277 - val_loss: 3.4816 - val_accuracy1000: 0.3389 - 12s/epoch - 52ms/step
Epoch 8/50
237/237 - 12s - loss: 3.1631 - accuracy1000: 0.4418 - val_loss: 3.4831 - val_accuracy1000: 0.3436 - 12s/epoch - 53ms/step
Epoch 9/50
237/237 - 12s - loss: 3.1526 - accuracy1000: 0.4485 - val_loss: 3.4664 - val_accuracy1000: 0.3582 - 12s/epoch - 52ms/step
Epoch 10/50
237/237 - 12s - loss: 3.1336 - accuracy1000: 0.4555 - val_loss: 3.4930 - val_accuracy1000: 0.3545 - 12s/epoch - 52ms/step
Epoch 11/50
237/237 - 12s - loss: 3.1053 - accuracy1000: 0.4650 - val_loss: 3.5100 - val_accuracy1000: 0.3479 - 12s/epoch - 52ms/step
Epoch 12/50
237/237 - 13s - loss: 3.0852 - accuracy1000: 0.4721 - val_loss: 3.5325 - val_accuracy1000: 0.3427 - 13s/epoch - 53ms/step
Epoch 13/50
237/237 - 13s - loss: 3.0659 - accuracy1000: 0.4815 - val_loss: 3.6780 - val_accuracy1000: 0.3313 - 13s/epoch - 53ms/step
Epoch 14/50
237/237 - 13s - loss: 3.0443 - accuracy1000: 0.4876 - val_loss: 3.6787 - val_accuracy1000: 0.3233 - 13s/epoch - 53ms/step
Epoch 15/50
237/237 - 13s - loss: 3.0128 - accuracy1000: 0.4943 - val_loss: 3.7192 - val_accuracy1000: 0.3350 - 13s/epoch - 53ms/step
testing model: results/LILAK/W2/deepLOB_L2/h1000
Evaluating performance on  test set...
987/987 - 19s - 19s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1282382
{'0': {'precision': 0.4169577831724791, 'recall': 0.08742504562440254, 'f1-score': 0.14454319669943963, 'support': 80549}, '1': {'precision': 0.3488135316463599, 'recall': 0.8232287168327156, 'f1-score': 0.4900050598751897, 'support': 88227}, '2': {'precision': 0.35547602527115363, 'recall': 0.11626990288942773, 'f1-score': 0.1752263685622221, 'support': 83719}, 'accuracy': 0.3540941404780293, 'macro avg': {'precision': 0.37374911336333083, 'recall': 0.34230788844884863, 'f1-score': 0.26992487504561713, 'support': 252495}, 'weighted avg': {'precision': 0.37276144594150035, 'recall': 0.3540941404780293, 'f1-score': 0.27542827667166553, 'support': 252495}}
[[ 7042 65061  8446]
 [ 6393 72631  9203]
 [ 3454 70531  9734]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 23ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1332799
{'0': {'precision': 0.33481173062997827, 'recall': 0.17697717812544855, 'f1-score': 0.23155654324079, 'support': 20901}, '1': {'precision': 0.33048631689036084, 'recall': 0.6847237269772481, 'f1-score': 0.445802962614625, 'support': 19383}, '2': {'precision': 0.3601585940848693, 'recall': 0.1659343372006912, 'f1-score': 0.22719437590833813, 'support': 20255}, 'accuracy': 0.3358496176018765, 'macro avg': {'precision': 0.3418188805350695, 'recall': 0.34254508076779594, 'f1-score': 0.3015179605879177, 'support': 60539}, 'weighted avg': {'precision': 0.34190734213270896, 'recall': 0.3358496176018765, 'f1-score': 0.29869314357122545, 'support': 60539}}
[[ 3699 13999  3203]
 [ 3343 13272  2768]
 [ 4006 12888  3361]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1453986
{'0': {'precision': 0.385558583106267, 'recall': 0.03730064584157111, 'f1-score': 0.06802067059247686, 'support': 7587}, '1': {'precision': 0.3428895980959593, 'recall': 0.8539673986258925, 'f1-score': 0.489309147047472, 'support': 7423}, '2': {'precision': 0.33669609079445145, 'recall': 0.12154779969650986, 'f1-score': 0.17861523023748468, 'support': 6590}, 'accuracy': 0.3436574074074074, 'macro avg': {'precision': 0.35504809066555926, 'recall': 0.33760528138799123, 'f1-score': 0.24531501595914454, 'support': 21600}, 'weighted avg': {'precision': 0.3559874858809717, 'recall': 0.3436574074074074, 'f1-score': 0.24654115711034866, 'support': 21600}}
[[ 283 6542  762]
 [ 268 6339  816]
 [ 183 5606  801]]
training model: results/LILAK/W2/deepOF_L2/h10
Epoch 1/50
237/237 - 11s - loss: 3.3336 - accuracy10: 0.3497 - val_loss: 3.2463 - val_accuracy10: 0.4122 - 11s/epoch - 46ms/step
Epoch 2/50
237/237 - 8s - loss: 3.2816 - accuracy10: 0.3886 - val_loss: 3.2259 - val_accuracy10: 0.4334 - 8s/epoch - 36ms/step
Epoch 3/50
237/237 - 9s - loss: 3.2536 - accuracy10: 0.4075 - val_loss: 3.2064 - val_accuracy10: 0.4448 - 9s/epoch - 36ms/step
Epoch 4/50
237/237 - 8s - loss: 3.2295 - accuracy10: 0.4241 - val_loss: 3.1956 - val_accuracy10: 0.4529 - 8s/epoch - 36ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2070 - accuracy10: 0.4359 - val_loss: 3.1858 - val_accuracy10: 0.4510 - 8s/epoch - 35ms/step
Epoch 6/50
237/237 - 8s - loss: 3.1844 - accuracy10: 0.4470 - val_loss: 3.1708 - val_accuracy10: 0.4579 - 8s/epoch - 35ms/step
Epoch 7/50
237/237 - 8s - loss: 3.1661 - accuracy10: 0.4518 - val_loss: 3.1622 - val_accuracy10: 0.4606 - 8s/epoch - 36ms/step
Epoch 8/50
237/237 - 8s - loss: 3.1455 - accuracy10: 0.4585 - val_loss: 3.1521 - val_accuracy10: 0.4615 - 8s/epoch - 35ms/step
Epoch 9/50
237/237 - 8s - loss: 3.1309 - accuracy10: 0.4622 - val_loss: 3.1460 - val_accuracy10: 0.4643 - 8s/epoch - 36ms/step
Epoch 10/50
237/237 - 8s - loss: 3.1129 - accuracy10: 0.4709 - val_loss: 3.1443 - val_accuracy10: 0.4671 - 8s/epoch - 35ms/step
Epoch 11/50
237/237 - 8s - loss: 3.0975 - accuracy10: 0.4733 - val_loss: 3.1413 - val_accuracy10: 0.4629 - 8s/epoch - 35ms/step
Epoch 12/50
237/237 - 8s - loss: 3.0826 - accuracy10: 0.4800 - val_loss: 3.1349 - val_accuracy10: 0.4663 - 8s/epoch - 36ms/step
Epoch 13/50
237/237 - 9s - loss: 3.0670 - accuracy10: 0.4833 - val_loss: 3.1348 - val_accuracy10: 0.4685 - 9s/epoch - 36ms/step
Epoch 14/50
237/237 - 9s - loss: 3.0510 - accuracy10: 0.4880 - val_loss: 3.1385 - val_accuracy10: 0.4681 - 9s/epoch - 36ms/step
Epoch 15/50
237/237 - 8s - loss: 3.0322 - accuracy10: 0.4921 - val_loss: 3.1337 - val_accuracy10: 0.4690 - 8s/epoch - 35ms/step
Epoch 16/50
237/237 - 8s - loss: 3.0204 - accuracy10: 0.4939 - val_loss: 3.1381 - val_accuracy10: 0.4685 - 8s/epoch - 35ms/step
Epoch 17/50
237/237 - 8s - loss: 3.0049 - accuracy10: 0.4978 - val_loss: 3.1354 - val_accuracy10: 0.4706 - 8s/epoch - 35ms/step
Epoch 18/50
237/237 - 8s - loss: 2.9893 - accuracy10: 0.5021 - val_loss: 3.1526 - val_accuracy10: 0.4645 - 8s/epoch - 35ms/step
Epoch 19/50
237/237 - 8s - loss: 2.9716 - accuracy10: 0.5077 - val_loss: 3.1517 - val_accuracy10: 0.4715 - 8s/epoch - 35ms/step
Epoch 20/50
237/237 - 8s - loss: 2.9587 - accuracy10: 0.5104 - val_loss: 3.1596 - val_accuracy10: 0.4701 - 8s/epoch - 36ms/step
Epoch 21/50
237/237 - 8s - loss: 2.9453 - accuracy10: 0.5124 - val_loss: 3.1591 - val_accuracy10: 0.4606 - 8s/epoch - 36ms/step
Epoch 22/50
237/237 - 8s - loss: 2.9279 - accuracy10: 0.5165 - val_loss: 3.1804 - val_accuracy10: 0.4642 - 8s/epoch - 35ms/step
Epoch 23/50
237/237 - 8s - loss: 2.9131 - accuracy10: 0.5171 - val_loss: 3.1734 - val_accuracy10: 0.4680 - 8s/epoch - 35ms/step
Epoch 24/50
237/237 - 8s - loss: 2.8984 - accuracy10: 0.5214 - val_loss: 3.1997 - val_accuracy10: 0.4620 - 8s/epoch - 35ms/step
Epoch 25/50
237/237 - 8s - loss: 2.8855 - accuracy10: 0.5235 - val_loss: 3.2149 - val_accuracy10: 0.4589 - 8s/epoch - 35ms/step
testing model: results/LILAK/W2/deepOF_L2/h10
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0479906
{'0': {'precision': 0.40129002861984026, 'recall': 0.4026257893082659, 'f1-score': 0.4019567992355362, 'support': 69998}, '1': {'precision': 0.5517793961318165, 'recall': 0.6148746010838144, 'f1-score': 0.5816208351277109, 'support': 113119}, '2': {'precision': 0.3753936482519349, 'recall': 0.30413849768641976, 'f1-score': 0.33603019637197595, 'support': 69373}, 'accuracy': 0.47065626361440055, 'macro avg': {'precision': 0.4428210243345305, 'recall': 0.44054629602616674, 'f1-score': 0.439869276911741, 'support': 252490}, 'weighted avg': {'precision': 0.4615961681434829, 'recall': 0.47065626361440055, 'f1-score': 0.4643350710705916, 'support': 252490}}
[[28183 27207 14608]
 [23067 69554 20498]
 [18981 29293 21099]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0019779
{'0': {'precision': 0.46155971922843086, 'recall': 0.4821315166560822, 'f1-score': 0.4716213926695657, 'support': 17321}, '1': {'precision': 0.549292139802389, 'recall': 0.5775030039924028, 'f1-score': 0.5630444230296847, 'support': 25799}, '2': {'precision': 0.4662228314078716, 'recall': 0.41009300723389597, 'f1-score': 0.4363603042243196, 'support': 17418}, 'accuracy': 0.5020483002411709, 'macro avg': {'precision': 0.49235823014623054, 'recall': 0.4899091759607937, 'f1-score': 0.4903420399745233, 'support': 60538}, 'weighted avg': {'precision': 0.5002896212127885, 'recall': 0.5020483002411709, 'f1-score': 0.5004370972141726, 'support': 60538}}
[[ 8351  5880  3090]
 [ 5812 14899  5088]
 [ 3930  6345  7143]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0429889
{'0': {'precision': 0.37683651140981556, 'recall': 0.4190128606187, 'f1-score': 0.39680710994075047, 'support': 5754}, '1': {'precision': 0.5610712577714012, 'recall': 0.5871284155740166, 'f1-score': 0.5738041670742443, 'support': 9991}, '2': {'precision': 0.3728920741989882, 'recall': 0.30228981544771016, 'f1-score': 0.33389958474896186, 'support': 5852}, 'accuracy': 0.465157197758948, 'macro avg': {'precision': 0.436933281126735, 'recall': 0.4361436972134756, 'f1-score': 0.4348369539213189, 'support': 21597}, 'weighted avg': {'precision': 0.4609966495929354, 'recall': 0.465157197758948, 'f1-score': 0.46164216853214696, 'support': 21597}}
[[2411 2212 1131]
 [2281 5866 1844]
 [1706 2377 1769]]
training model: results/LILAK/W2/deepOF_L2/h20
Epoch 1/50
237/237 - 11s - loss: 3.3406 - accuracy20: 0.3439 - val_loss: 3.3036 - val_accuracy20: 0.3680 - 11s/epoch - 46ms/step
Epoch 2/50
237/237 - 8s - loss: 3.2959 - accuracy20: 0.3677 - val_loss: 3.2866 - val_accuracy20: 0.3774 - 8s/epoch - 36ms/step
Epoch 3/50
237/237 - 9s - loss: 3.2753 - accuracy20: 0.3799 - val_loss: 3.2756 - val_accuracy20: 0.3868 - 9s/epoch - 38ms/step
Epoch 4/50
237/237 - 9s - loss: 3.2567 - accuracy20: 0.3938 - val_loss: 3.2668 - val_accuracy20: 0.3946 - 9s/epoch - 37ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2401 - accuracy20: 0.4031 - val_loss: 3.2597 - val_accuracy20: 0.4012 - 8s/epoch - 36ms/step
Epoch 6/50
237/237 - 8s - loss: 3.2274 - accuracy20: 0.4097 - val_loss: 3.2539 - val_accuracy20: 0.4038 - 8s/epoch - 36ms/step
Epoch 7/50
237/237 - 8s - loss: 3.2117 - accuracy20: 0.4199 - val_loss: 3.2467 - val_accuracy20: 0.4058 - 8s/epoch - 34ms/step
Epoch 8/50
237/237 - 9s - loss: 3.1993 - accuracy20: 0.4220 - val_loss: 3.2358 - val_accuracy20: 0.4133 - 9s/epoch - 36ms/step
Epoch 9/50
237/237 - 8s - loss: 3.1891 - accuracy20: 0.4289 - val_loss: 3.2289 - val_accuracy20: 0.4171 - 8s/epoch - 36ms/step
Epoch 10/50
237/237 - 9s - loss: 3.1745 - accuracy20: 0.4373 - val_loss: 3.2262 - val_accuracy20: 0.4169 - 9s/epoch - 36ms/step
Epoch 11/50
237/237 - 8s - loss: 3.1623 - accuracy20: 0.4405 - val_loss: 3.2268 - val_accuracy20: 0.4182 - 8s/epoch - 36ms/step
Epoch 12/50
237/237 - 9s - loss: 3.1477 - accuracy20: 0.4474 - val_loss: 3.2168 - val_accuracy20: 0.4200 - 9s/epoch - 37ms/step
Epoch 13/50
237/237 - 9s - loss: 3.1360 - accuracy20: 0.4509 - val_loss: 3.2174 - val_accuracy20: 0.4225 - 9s/epoch - 36ms/step
Epoch 14/50
237/237 - 9s - loss: 3.1235 - accuracy20: 0.4576 - val_loss: 3.2183 - val_accuracy20: 0.4222 - 9s/epoch - 36ms/step
Epoch 15/50
237/237 - 8s - loss: 3.1117 - accuracy20: 0.4618 - val_loss: 3.2164 - val_accuracy20: 0.4277 - 8s/epoch - 35ms/step
Epoch 16/50
237/237 - 8s - loss: 3.0989 - accuracy20: 0.4681 - val_loss: 3.2169 - val_accuracy20: 0.4252 - 8s/epoch - 34ms/step
Epoch 17/50
237/237 - 8s - loss: 3.0864 - accuracy20: 0.4700 - val_loss: 3.2177 - val_accuracy20: 0.4264 - 8s/epoch - 34ms/step
Epoch 18/50
237/237 - 8s - loss: 3.0720 - accuracy20: 0.4778 - val_loss: 3.2193 - val_accuracy20: 0.4277 - 8s/epoch - 34ms/step
Epoch 19/50
237/237 - 8s - loss: 3.0560 - accuracy20: 0.4832 - val_loss: 3.2171 - val_accuracy20: 0.4307 - 8s/epoch - 34ms/step
Epoch 20/50
237/237 - 8s - loss: 3.0414 - accuracy20: 0.4880 - val_loss: 3.2265 - val_accuracy20: 0.4286 - 8s/epoch - 35ms/step
Epoch 21/50
237/237 - 8s - loss: 3.0299 - accuracy20: 0.4907 - val_loss: 3.2280 - val_accuracy20: 0.4294 - 8s/epoch - 35ms/step
Epoch 22/50
237/237 - 8s - loss: 3.0180 - accuracy20: 0.4942 - val_loss: 3.2333 - val_accuracy20: 0.4283 - 8s/epoch - 33ms/step
Epoch 23/50
237/237 - 8s - loss: 2.9986 - accuracy20: 0.5013 - val_loss: 3.2431 - val_accuracy20: 0.4295 - 8s/epoch - 34ms/step
Epoch 24/50
237/237 - 8s - loss: 2.9908 - accuracy20: 0.5031 - val_loss: 3.2487 - val_accuracy20: 0.4268 - 8s/epoch - 33ms/step
Epoch 25/50
237/237 - 8s - loss: 2.9715 - accuracy20: 0.5083 - val_loss: 3.2435 - val_accuracy20: 0.4322 - 8s/epoch - 33ms/step
testing model: results/LILAK/W2/deepOF_L2/h20
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0690044
{'0': {'precision': 0.4273491751882563, 'recall': 0.36398347911805445, 'f1-score': 0.3931293337556183, 'support': 80141}, '1': {'precision': 0.44702337117075935, 'recall': 0.5821914032786162, 'f1-score': 0.5057314959348036, 'support': 90709}, '2': {'precision': 0.4073833118995385, 'recall': 0.3298138167564919, 'f1-score': 0.3645175483128575, 'support': 81640}, 'accuracy': 0.43132797338508455, 'macro avg': {'precision': 0.4272519527528514, 'recall': 0.4253295663843875, 'f1-score': 0.42112612600109317, 'support': 252490}, 'weighted avg': {'precision': 0.4279615303884066, 'recall': 0.43132797338508455, 'f1-score': 0.424331216466081, 'support': 252490}}
[[29170 30866 20105]
 [18835 52810 19064]
 [20253 34461 26926]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0344336
{'0': {'precision': 0.49240121580547114, 'recall': 0.42968671804624164, 'f1-score': 0.45891124829632013, 'support': 19982}, '1': {'precision': 0.43825237490865737, 'recall': 0.5671976107516177, 'f1-score': 0.49445661842876054, 'support': 20090}, '2': {'precision': 0.48076023391812867, 'recall': 0.4016906088146194, 'f1-score': 0.43768301123356235, 'support': 20466}, 'accuracy': 0.46585615646370876, 'macro avg': {'precision': 0.4704712748774191, 'recall': 0.46619164587082623, 'f1-score': 0.4636836259862143, 'support': 60538}, 'weighted avg': {'precision': 0.4704960562540598, 'recall': 0.46585615646370876, 'f1-score': 0.4635306507581512, 'support': 60538}}
[[ 8586  6892  4504]
 [ 4320 11395  4375]
 [ 4531  7714  8221]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0716573
{'0': {'precision': 0.4004934210526316, 'recall': 0.36181277860326894, 'f1-score': 0.3801717408274785, 'support': 6730}, '1': {'precision': 0.4475842308072325, 'recall': 0.5711043872919819, 'f1-score': 0.5018556472608431, 'support': 7932}, '2': {'precision': 0.40492957746478875, 'recall': 0.3150684931506849, 'f1-score': 0.35439137134052395, 'support': 6935}, 'accuracy': 0.42366995416030007, 'macro avg': {'precision': 0.41766907644155093, 'recall': 0.41599521968197856, 'f1-score': 0.41213958647628185, 'support': 21597}, 'weighted avg': {'precision': 0.4192131065502379, 'recall': 0.42366995416030007, 'f1-score': 0.4165846631517559, 'support': 21597}}
[[2435 2684 1611]
 [1802 4530 1600]
 [1843 2907 2185]]
training model: results/LILAK/W2/deepOF_L2/h30
Epoch 1/50
237/237 - 10s - loss: 3.3473 - accuracy30: 0.3387 - val_loss: 3.3184 - val_accuracy30: 0.3500 - 10s/epoch - 44ms/step
Epoch 2/50
237/237 - 8s - loss: 3.3073 - accuracy30: 0.3560 - val_loss: 3.3029 - val_accuracy30: 0.3572 - 8s/epoch - 35ms/step
Epoch 3/50
237/237 - 8s - loss: 3.2900 - accuracy30: 0.3652 - val_loss: 3.2932 - val_accuracy30: 0.3664 - 8s/epoch - 35ms/step
Epoch 4/50
237/237 - 8s - loss: 3.2760 - accuracy30: 0.3796 - val_loss: 3.2841 - val_accuracy30: 0.3751 - 8s/epoch - 34ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2662 - accuracy30: 0.3847 - val_loss: 3.2850 - val_accuracy30: 0.3750 - 8s/epoch - 34ms/step
Epoch 6/50
237/237 - 8s - loss: 3.2558 - accuracy30: 0.3898 - val_loss: 3.2815 - val_accuracy30: 0.3788 - 8s/epoch - 34ms/step
Epoch 7/50
237/237 - 8s - loss: 3.2468 - accuracy30: 0.3984 - val_loss: 3.2817 - val_accuracy30: 0.3795 - 8s/epoch - 35ms/step
Epoch 8/50
237/237 - 9s - loss: 3.2367 - accuracy30: 0.4041 - val_loss: 3.2802 - val_accuracy30: 0.3832 - 9s/epoch - 36ms/step
Epoch 9/50
237/237 - 9s - loss: 3.2303 - accuracy30: 0.4049 - val_loss: 3.2766 - val_accuracy30: 0.3863 - 9s/epoch - 37ms/step
Epoch 10/50
237/237 - 9s - loss: 3.2186 - accuracy30: 0.4142 - val_loss: 3.2773 - val_accuracy30: 0.3851 - 9s/epoch - 37ms/step
Epoch 11/50
237/237 - 9s - loss: 3.2091 - accuracy30: 0.4194 - val_loss: 3.2800 - val_accuracy30: 0.3833 - 9s/epoch - 37ms/step
Epoch 12/50
237/237 - 9s - loss: 3.1976 - accuracy30: 0.4243 - val_loss: 3.2747 - val_accuracy30: 0.3896 - 9s/epoch - 38ms/step
Epoch 13/50
237/237 - 8s - loss: 3.1894 - accuracy30: 0.4286 - val_loss: 3.2689 - val_accuracy30: 0.3943 - 8s/epoch - 36ms/step
Epoch 14/50
237/237 - 8s - loss: 3.1796 - accuracy30: 0.4336 - val_loss: 3.2741 - val_accuracy30: 0.3924 - 8s/epoch - 36ms/step
Epoch 15/50
237/237 - 8s - loss: 3.1683 - accuracy30: 0.4389 - val_loss: 3.2774 - val_accuracy30: 0.3913 - 8s/epoch - 35ms/step
Epoch 16/50
237/237 - 8s - loss: 3.1563 - accuracy30: 0.4418 - val_loss: 3.2762 - val_accuracy30: 0.3938 - 8s/epoch - 35ms/step
Epoch 17/50
237/237 - 8s - loss: 3.1460 - accuracy30: 0.4442 - val_loss: 3.2832 - val_accuracy30: 0.3939 - 8s/epoch - 35ms/step
Epoch 18/50
237/237 - 8s - loss: 3.1344 - accuracy30: 0.4508 - val_loss: 3.2865 - val_accuracy30: 0.3977 - 8s/epoch - 35ms/step
Epoch 19/50
237/237 - 8s - loss: 3.1215 - accuracy30: 0.4590 - val_loss: 3.2872 - val_accuracy30: 0.3990 - 8s/epoch - 35ms/step
Epoch 20/50
237/237 - 8s - loss: 3.1051 - accuracy30: 0.4638 - val_loss: 3.2917 - val_accuracy30: 0.3994 - 8s/epoch - 36ms/step
Epoch 21/50
237/237 - 8s - loss: 3.0973 - accuracy30: 0.4674 - val_loss: 3.2992 - val_accuracy30: 0.3977 - 8s/epoch - 35ms/step
Epoch 22/50
237/237 - 8s - loss: 3.0812 - accuracy30: 0.4717 - val_loss: 3.3155 - val_accuracy30: 0.3942 - 8s/epoch - 35ms/step
Epoch 23/50
237/237 - 8s - loss: 3.0742 - accuracy30: 0.4757 - val_loss: 3.3118 - val_accuracy30: 0.3952 - 8s/epoch - 35ms/step
testing model: results/LILAK/W2/deepOF_L2/h30
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0935401
{'0': {'precision': 0.370963277357446, 'recall': 0.30573369496337227, 'f1-score': 0.3352046133537136, 'support': 78902}, '1': {'precision': 0.4053074107243781, 'recall': 0.5228246483770386, 'f1-score': 0.45662619326335796, 'support': 89158}, '2': {'precision': 0.39287538128165844, 'recall': 0.33714319554660666, 'f1-score': 0.3628818928755824, 'support': 84430}, 'accuracy': 0.3928947681096281, 'macro avg': {'precision': 0.3897153564544942, 'recall': 0.38856717962900583, 'f1-score': 0.384904233164218, 'support': 252490}, 'weighted avg': {'precision': 0.390417882201401, 'recall': 0.3928947681096281, 'f1-score': 0.3873353826183001, 'support': 252490}}
[[24123 32661 22118]
 [20674 46614 21870]
 [20231 35734 28465]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0614207
{'0': {'precision': 0.45664739884393063, 'recall': 0.38055095589342164, 'f1-score': 0.41514081615896214, 'support': 19929}, '1': {'precision': 0.4040914747977598, 'recall': 0.5180494615077782, 'f1-score': 0.4540290159063101, 'support': 20056}, '2': {'precision': 0.44373696344274893, 'recall': 0.39332457548776334, 'f1-score': 0.4170127156895618, 'support': 20553}, 'accuracy': 0.43044038455185174, 'macro avg': {'precision': 0.43482527902814644, 'recall': 0.4306416642963211, 'f1-score': 0.428727515918278, 'support': 60538}, 'weighted avg': {'precision': 0.43485266179496157, 'recall': 0.43044038455185174, 'f1-score': 0.428659843632371, 'support': 60538}}
[[ 7584  7316  5029]
 [ 4561 10390  5105]
 [ 4463  8006  8084]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0901033
{'0': {'precision': 0.37026696911533763, 'recall': 0.3120588235294118, 'f1-score': 0.3386800734179235, 'support': 6800}, '1': {'precision': 0.40773926742812133, 'recall': 0.5298106448311156, 'f1-score': 0.46082795459603826, 'support': 7816}, '2': {'precision': 0.3788091068301226, 'recall': 0.309840996991835, 'f1-score': 0.3408714837286266, 'support': 6981}, 'accuracy': 0.39014677964532113, 'macro avg': {'precision': 0.3856051144578605, 'recall': 0.3839034884507875, 'f1-score': 0.3801265039141961, 'support': 21597}, 'weighted avg': {'precision': 0.38658942811425556, 'recall': 0.39014677964532113, 'f1-score': 0.3835940001052951, 'support': 21597}}
[[2122 2943 1735]
 [1863 4141 1812]
 [1746 3072 2163]]
training model: results/LILAK/W2/deepOF_L2/h50
Epoch 1/50
237/237 - 10s - loss: 3.3519 - accuracy50: 0.3333 - val_loss: 3.3296 - val_accuracy50: 0.3370 - 10s/epoch - 44ms/step
Epoch 2/50
237/237 - 8s - loss: 3.3149 - accuracy50: 0.3469 - val_loss: 3.3169 - val_accuracy50: 0.3442 - 8s/epoch - 35ms/step
Epoch 3/50
237/237 - 8s - loss: 3.2994 - accuracy50: 0.3533 - val_loss: 3.3135 - val_accuracy50: 0.3424 - 8s/epoch - 35ms/step
Epoch 4/50
237/237 - 8s - loss: 3.2869 - accuracy50: 0.3636 - val_loss: 3.3064 - val_accuracy50: 0.3523 - 8s/epoch - 36ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2785 - accuracy50: 0.3714 - val_loss: 3.3089 - val_accuracy50: 0.3497 - 8s/epoch - 35ms/step
Epoch 6/50
237/237 - 8s - loss: 3.2684 - accuracy50: 0.3798 - val_loss: 3.3049 - val_accuracy50: 0.3595 - 8s/epoch - 35ms/step
Epoch 7/50
237/237 - 8s - loss: 3.2606 - accuracy50: 0.3854 - val_loss: 3.3060 - val_accuracy50: 0.3583 - 8s/epoch - 35ms/step
Epoch 8/50
237/237 - 8s - loss: 3.2524 - accuracy50: 0.3904 - val_loss: 3.3037 - val_accuracy50: 0.3618 - 8s/epoch - 36ms/step
Epoch 9/50
237/237 - 8s - loss: 3.2451 - accuracy50: 0.3932 - val_loss: 3.3063 - val_accuracy50: 0.3638 - 8s/epoch - 35ms/step
Epoch 10/50
237/237 - 8s - loss: 3.2361 - accuracy50: 0.4003 - val_loss: 3.3061 - val_accuracy50: 0.3652 - 8s/epoch - 35ms/step
Epoch 11/50
237/237 - 8s - loss: 3.2274 - accuracy50: 0.4050 - val_loss: 3.3085 - val_accuracy50: 0.3623 - 8s/epoch - 36ms/step
Epoch 12/50
237/237 - 9s - loss: 3.2186 - accuracy50: 0.4124 - val_loss: 3.3050 - val_accuracy50: 0.3678 - 9s/epoch - 37ms/step
Epoch 13/50
237/237 - 9s - loss: 3.2107 - accuracy50: 0.4141 - val_loss: 3.3051 - val_accuracy50: 0.3703 - 9s/epoch - 37ms/step
Epoch 14/50
237/237 - 9s - loss: 3.2032 - accuracy50: 0.4187 - val_loss: 3.3061 - val_accuracy50: 0.3692 - 9s/epoch - 39ms/step
Epoch 15/50
237/237 - 9s - loss: 3.1944 - accuracy50: 0.4241 - val_loss: 3.3083 - val_accuracy50: 0.3682 - 9s/epoch - 37ms/step
Epoch 16/50
237/237 - 9s - loss: 3.1827 - accuracy50: 0.4283 - val_loss: 3.3151 - val_accuracy50: 0.3673 - 9s/epoch - 36ms/step
Epoch 17/50
237/237 - 8s - loss: 3.1715 - accuracy50: 0.4346 - val_loss: 3.3138 - val_accuracy50: 0.3723 - 8s/epoch - 35ms/step
Epoch 18/50
237/237 - 9s - loss: 3.1633 - accuracy50: 0.4351 - val_loss: 3.3264 - val_accuracy50: 0.3688 - 9s/epoch - 37ms/step
testing model: results/LILAK/W2/deepOF_L2/h50
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1013513
{'0': {'precision': 0.3304482335159645, 'recall': 0.35696974335425274, 'f1-score': 0.3431973706801403, 'support': 78396}, '1': {'precision': 0.3720806000128208, 'recall': 0.19695958556255586, 'f1-score': 0.2575735163599787, 'support': 88409}, '2': {'precision': 0.3712552581340958, 'recall': 0.5242807959386123, 'f1-score': 0.43469383805542644, 'support': 85685}, 'accuracy': 0.357721097865262, 'macro avg': {'precision': 0.35792803055429373, 'recall': 0.359403374951807, 'f1-score': 0.34515490836518176, 'support': 252490}, 'weighted avg': {'precision': 0.35887401589952483, 'recall': 0.357721097865262, 'f1-score': 0.3442665435997023, 'support': 252490}}
[[27985 13954 36457]
 [31373 17413 39623]
 [25330 15432 44923]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0815426
{'0': {'precision': 0.39584146817649357, 'recall': 0.4116333367170846, 'f1-score': 0.40358298084100525, 'support': 19702}, '1': {'precision': 0.39162303664921466, 'recall': 0.22391857506361323, 'f1-score': 0.2849252452147415, 'support': 20043}, '2': {'precision': 0.3968870234347674, 'recall': 0.5457124993988361, 'f1-score': 0.4595508575825689, 'support': 20793}, 'accuracy': 0.39553668770028744, 'macro avg': {'precision': 0.39478384275349193, 'recall': 0.39375480372651134, 'f1-score': 0.38268636121277183, 'support': 60538}, 'weighted avg': {'precision': 0.3948039414558228, 'recall': 0.39553668770028744, 'f1-score': 0.38352092173647795, 'support': 60538}}
[[ 8110  3471  8121]
 [ 6433  4488  9122]
 [ 5945  3501 11347]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1002513
{'0': {'precision': 0.34924928986879483, 'recall': 0.3708171765043803, 'f1-score': 0.35971022568960714, 'support': 6963}, '1': {'precision': 0.3660557368817474, 'recall': 0.1990443686006826, 'f1-score': 0.2578705341351255, 'support': 7325}, '2': {'precision': 0.36620682907738966, 'recall': 0.5121083595567109, 'f1-score': 0.42703936109526525, 'support': 7309}, 'accuracy': 0.36037412603602353, 'macro avg': {'precision': 0.360503951942644, 'recall': 0.3606566348872579, 'f1-score': 0.3482067069733326, 'support': 21597}, 'weighted avg': {'precision': 0.3606883730028179, 'recall': 0.36037412603602353, 'f1-score': 0.3479554870705108, 'support': 21597}}
[[2582 1249 3132]
 [2521 1458 3346]
 [2290 1276 3743]]
training model: results/LILAK/W2/deepOF_L2/h100
Epoch 1/50
237/237 - 10s - loss: 3.3614 - accuracy100: 0.3277 - val_loss: 3.3221 - val_accuracy100: 0.3410 - 10s/epoch - 44ms/step
Epoch 2/50
237/237 - 9s - loss: 3.3274 - accuracy100: 0.3378 - val_loss: 3.3132 - val_accuracy100: 0.3450 - 9s/epoch - 37ms/step
Epoch 3/50
237/237 - 8s - loss: 3.3115 - accuracy100: 0.3477 - val_loss: 3.3053 - val_accuracy100: 0.3464 - 8s/epoch - 35ms/step
Epoch 4/50
237/237 - 8s - loss: 3.2995 - accuracy100: 0.3559 - val_loss: 3.2999 - val_accuracy100: 0.3547 - 8s/epoch - 35ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2911 - accuracy100: 0.3614 - val_loss: 3.2987 - val_accuracy100: 0.3545 - 8s/epoch - 35ms/step
Epoch 6/50
237/237 - 8s - loss: 3.2800 - accuracy100: 0.3685 - val_loss: 3.2963 - val_accuracy100: 0.3579 - 8s/epoch - 35ms/step
Epoch 7/50
237/237 - 8s - loss: 3.2726 - accuracy100: 0.3742 - val_loss: 3.2989 - val_accuracy100: 0.3582 - 8s/epoch - 35ms/step
Epoch 8/50
237/237 - 8s - loss: 3.2647 - accuracy100: 0.3797 - val_loss: 3.2966 - val_accuracy100: 0.3615 - 8s/epoch - 35ms/step
Epoch 9/50
237/237 - 8s - loss: 3.2610 - accuracy100: 0.3824 - val_loss: 3.2986 - val_accuracy100: 0.3632 - 8s/epoch - 35ms/step
Epoch 10/50
237/237 - 8s - loss: 3.2519 - accuracy100: 0.3892 - val_loss: 3.3002 - val_accuracy100: 0.3616 - 8s/epoch - 35ms/step
Epoch 11/50
237/237 - 8s - loss: 3.2456 - accuracy100: 0.3945 - val_loss: 3.3023 - val_accuracy100: 0.3621 - 8s/epoch - 35ms/step
Epoch 12/50
237/237 - 8s - loss: 3.2375 - accuracy100: 0.3995 - val_loss: 3.3025 - val_accuracy100: 0.3638 - 8s/epoch - 35ms/step
Epoch 13/50
237/237 - 8s - loss: 3.2286 - accuracy100: 0.4059 - val_loss: 3.2997 - val_accuracy100: 0.3690 - 8s/epoch - 35ms/step
Epoch 14/50
237/237 - 8s - loss: 3.2240 - accuracy100: 0.4089 - val_loss: 3.3049 - val_accuracy100: 0.3655 - 8s/epoch - 35ms/step
Epoch 15/50
237/237 - 8s - loss: 3.2136 - accuracy100: 0.4145 - val_loss: 3.3055 - val_accuracy100: 0.3681 - 8s/epoch - 35ms/step
Epoch 16/50
237/237 - 8s - loss: 3.2042 - accuracy100: 0.4210 - val_loss: 3.3145 - val_accuracy100: 0.3663 - 8s/epoch - 35ms/step
testing model: results/LILAK/W2/deepOF_L2/h100
Evaluating performance on  test set...
987/987 - 17s - 17s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0966026
{'0': {'precision': 0.31260738614541855, 'recall': 0.20945067446773932, 'f1-score': 0.25083734094576954, 'support': 73836}, '1': {'precision': 0.4013849312130404, 'recall': 0.40384733954004565, 'f1-score': 0.40261237034191316, 'support': 97314}, '2': {'precision': 0.3472618639875176, 'recall': 0.4487337103516105, 'f1-score': 0.3915300780914786, 'support': 81340}, 'accuracy': 0.3614598597964276, 'macro avg': {'precision': 0.3537513937819922, 'recall': 0.3540105747864652, 'f1-score': 0.3483265964597204, 'support': 252490}, 'weighted avg': {'precision': 0.35798777051068803, 'recall': 0.3614598597964276, 'f1-score': 0.3546584128697598, 'support': 252490}}
[[15465 28280 30091]
 [19497 39300 38517]
 [14509 30331 36500]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0879283
{'0': {'precision': 0.39488568469688523, 'recall': 0.2513946647733036, 'f1-score': 0.30721080846580523, 'support': 19718}, '1': {'precision': 0.3618995633187773, 'recall': 0.4317703636910129, 'f1-score': 0.3937594225410023, 'support': 19962}, '2': {'precision': 0.39637552236335805, 'recall': 0.45929619330712435, 'f1-score': 0.42552246429919827, 'support': 20858}, 'accuracy': 0.3825035514883214, 'macro avg': {'precision': 0.3843869234596735, 'recall': 0.3808204072571469, 'f1-score': 0.375497565102002, 'support': 60538}, 'weighted avg': {'precision': 0.3845220466364521, 'recall': 0.3825035514883214, 'f1-score': 0.3765131962477272, 'support': 60538}}
[[4957 7575 7186]
 [3940 8619 7403]
 [3656 7622 9580]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0991071
{'0': {'precision': 0.332220367278798, 'recall': 0.2026181818181818, 'f1-score': 0.25171666064329595, 'support': 6875}, '1': {'precision': 0.3602720774729075, 'recall': 0.4152272123305873, 'f1-score': 0.38580246913580246, 'support': 7526}, '2': {'precision': 0.3563573883161512, 'recall': 0.4323235130628127, 'f1-score': 0.39068190380509854, 'support': 7196}, 'accuracy': 0.35324350604250593, 'macro avg': {'precision': 0.34961661102261893, 'recall': 0.3500563024038606, 'f1-score': 0.34273367786139897, 'support': 21597}, 'weighted avg': {'precision': 0.35003798890706406, 'recall': 0.35324350604250593, 'f1-score': 0.3447445665796267, 'support': 21597}}
[[1393 2745 2737]
 [1519 3125 2882]
 [1281 2804 3111]]
training model: results/LILAK/W2/deepOF_L2/h200
Epoch 1/50
237/237 - 11s - loss: 3.3528 - accuracy200: 0.3365 - val_loss: 3.3335 - val_accuracy200: 0.3383 - 11s/epoch - 45ms/step
Epoch 2/50
237/237 - 8s - loss: 3.3208 - accuracy200: 0.3440 - val_loss: 3.3242 - val_accuracy200: 0.3350 - 8s/epoch - 35ms/step
Epoch 3/50
237/237 - 9s - loss: 3.3060 - accuracy200: 0.3542 - val_loss: 3.3187 - val_accuracy200: 0.3400 - 9s/epoch - 37ms/step
Epoch 4/50
237/237 - 9s - loss: 3.2945 - accuracy200: 0.3615 - val_loss: 3.3153 - val_accuracy200: 0.3408 - 9s/epoch - 37ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2882 - accuracy200: 0.3645 - val_loss: 3.3128 - val_accuracy200: 0.3494 - 8s/epoch - 36ms/step
Epoch 6/50
237/237 - 8s - loss: 3.2794 - accuracy200: 0.3731 - val_loss: 3.3101 - val_accuracy200: 0.3481 - 8s/epoch - 36ms/step
Epoch 7/50
237/237 - 9s - loss: 3.2730 - accuracy200: 0.3756 - val_loss: 3.3104 - val_accuracy200: 0.3490 - 9s/epoch - 36ms/step
Epoch 8/50
237/237 - 8s - loss: 3.2659 - accuracy200: 0.3835 - val_loss: 3.3073 - val_accuracy200: 0.3512 - 8s/epoch - 36ms/step
Epoch 9/50
237/237 - 8s - loss: 3.2603 - accuracy200: 0.3866 - val_loss: 3.3079 - val_accuracy200: 0.3532 - 8s/epoch - 34ms/step
Epoch 10/50
237/237 - 8s - loss: 3.2527 - accuracy200: 0.3933 - val_loss: 3.3074 - val_accuracy200: 0.3583 - 8s/epoch - 34ms/step
Epoch 11/50
237/237 - 8s - loss: 3.2487 - accuracy200: 0.3917 - val_loss: 3.3068 - val_accuracy200: 0.3548 - 8s/epoch - 35ms/step
Epoch 12/50
237/237 - 8s - loss: 3.2405 - accuracy200: 0.3994 - val_loss: 3.3054 - val_accuracy200: 0.3605 - 8s/epoch - 35ms/step
Epoch 13/50
237/237 - 8s - loss: 3.2331 - accuracy200: 0.4038 - val_loss: 3.3111 - val_accuracy200: 0.3536 - 8s/epoch - 35ms/step
Epoch 14/50
237/237 - 8s - loss: 3.2263 - accuracy200: 0.4073 - val_loss: 3.3122 - val_accuracy200: 0.3595 - 8s/epoch - 35ms/step
Epoch 15/50
237/237 - 8s - loss: 3.2176 - accuracy200: 0.4118 - val_loss: 3.3095 - val_accuracy200: 0.3618 - 8s/epoch - 35ms/step
Epoch 16/50
237/237 - 8s - loss: 3.2094 - accuracy200: 0.4185 - val_loss: 3.3148 - val_accuracy200: 0.3626 - 8s/epoch - 35ms/step
Epoch 17/50
237/237 - 8s - loss: 3.2046 - accuracy200: 0.4170 - val_loss: 3.3147 - val_accuracy200: 0.3614 - 8s/epoch - 35ms/step
Epoch 18/50
237/237 - 8s - loss: 3.1955 - accuracy200: 0.4223 - val_loss: 3.3185 - val_accuracy200: 0.3636 - 8s/epoch - 35ms/step
Epoch 19/50
237/237 - 8s - loss: 3.1886 - accuracy200: 0.4249 - val_loss: 3.3199 - val_accuracy200: 0.3650 - 8s/epoch - 35ms/step
Epoch 20/50
237/237 - 8s - loss: 3.1756 - accuracy200: 0.4330 - val_loss: 3.3270 - val_accuracy200: 0.3635 - 8s/epoch - 34ms/step
Epoch 21/50
237/237 - 8s - loss: 3.1693 - accuracy200: 0.4357 - val_loss: 3.3302 - val_accuracy200: 0.3651 - 8s/epoch - 35ms/step
Epoch 22/50
237/237 - 8s - loss: 3.1608 - accuracy200: 0.4399 - val_loss: 3.3347 - val_accuracy200: 0.3655 - 8s/epoch - 35ms/step
testing model: results/LILAK/W2/deepOF_L2/h200
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1034684
{'0': {'precision': 0.32064931731227614, 'recall': 0.3244567032368984, 'f1-score': 0.3225417747666884, 'support': 80849}, '1': {'precision': 0.3516023247508036, 'recall': 0.12874041490816143, 'f1-score': 0.18847137859616755, 'support': 84115}, '2': {'precision': 0.36522211578330305, 'recall': 0.5836894180015081, 'f1-score': 0.4493069724899739, 'support': 87526}, 'accuracy': 0.3491187769812666, 'macro avg': {'precision': 0.3458245859487943, 'recall': 0.34562884538218935, 'f1-score': 0.3201067086176099, 'support': 252490}, 'weighted avg': {'precision': 0.34641228210164143, 'recall': 0.3491187769812666, 'f1-score': 0.32182063461082056, 'support': 252490}}
[[26232 10005 44612]
 [29104 10829 44182]
 [26473  9965 51088]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0793152
{'0': {'precision': 0.401451597700066, 'recall': 0.4265184517550448, 'f1-score': 0.41360557430381906, 'support': 19971}, '1': {'precision': 0.43471769815418027, 'recall': 0.1620623355596033, 'f1-score': 0.2361049683031107, 'support': 19764}, '2': {'precision': 0.39887956935403107, 'recall': 0.6126520213430755, 'f1-score': 0.4831769500521278, 'support': 20803}, 'accuracy': 0.40414285242327136, 'macro avg': {'precision': 0.4116829550694258, 'recall': 0.4004109362192412, 'f1-score': 0.37762916421968584, 'support': 60538}, 'weighted avg': {'precision': 0.4114282289679069, 'recall': 0.40414285242327136, 'f1-score': 0.3795636725676214, 'support': 60538}}
[[ 8518  2090  9363]
 [ 6717  3203  9844]
 [ 5983  2075 12745]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1009161
{'0': {'precision': 0.3560244161358811, 'recall': 0.35921810148614275, 'f1-score': 0.3576141286237921, 'support': 7469}, '1': {'precision': 0.37067888379841735, 'recall': 0.13090160317693778, 'f1-score': 0.19347826086956524, 'support': 6799}, '2': {'precision': 0.3602058319039451, 'recall': 0.5730659025787965, 'f1-score': 0.44236136710727264, 'support': 7329}, 'accuracy': 0.3599110987637172, 'macro avg': {'precision': 0.3623030439460812, 'recall': 0.354395202413959, 'f1-score': 0.33115125220021, 'support': 21597}, 'weighted avg': {'precision': 0.36205679664251283, 'recall': 0.3599110987637172, 'f1-score': 0.33470135120028144, 'support': 21597}}
[[2683  789 3997]
 [2446  890 3463]
 [2407  722 4200]]
training model: results/LILAK/W2/deepOF_L2/h300
Epoch 1/50
237/237 - 10s - loss: 3.3544 - accuracy300: 0.3332 - val_loss: 3.3293 - val_accuracy300: 0.3308 - 10s/epoch - 43ms/step
Epoch 2/50
237/237 - 8s - loss: 3.3224 - accuracy300: 0.3430 - val_loss: 3.3186 - val_accuracy300: 0.3315 - 8s/epoch - 34ms/step
Epoch 3/50
237/237 - 8s - loss: 3.3074 - accuracy300: 0.3494 - val_loss: 3.3131 - val_accuracy300: 0.3369 - 8s/epoch - 35ms/step
Epoch 4/50
237/237 - 8s - loss: 3.2968 - accuracy300: 0.3548 - val_loss: 3.3109 - val_accuracy300: 0.3376 - 8s/epoch - 35ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2905 - accuracy300: 0.3609 - val_loss: 3.3086 - val_accuracy300: 0.3416 - 8s/epoch - 34ms/step
Epoch 6/50
237/237 - 8s - loss: 3.2821 - accuracy300: 0.3673 - val_loss: 3.3083 - val_accuracy300: 0.3369 - 8s/epoch - 34ms/step
Epoch 7/50
237/237 - 8s - loss: 3.2778 - accuracy300: 0.3720 - val_loss: 3.3099 - val_accuracy300: 0.3373 - 8s/epoch - 34ms/step
Epoch 8/50
237/237 - 8s - loss: 3.2698 - accuracy300: 0.3758 - val_loss: 3.3040 - val_accuracy300: 0.3485 - 8s/epoch - 34ms/step
Epoch 9/50
237/237 - 8s - loss: 3.2642 - accuracy300: 0.3825 - val_loss: 3.3086 - val_accuracy300: 0.3441 - 8s/epoch - 33ms/step
Epoch 10/50
237/237 - 8s - loss: 3.2559 - accuracy300: 0.3873 - val_loss: 3.3083 - val_accuracy300: 0.3448 - 8s/epoch - 34ms/step
Epoch 11/50
237/237 - 8s - loss: 3.2532 - accuracy300: 0.3893 - val_loss: 3.3068 - val_accuracy300: 0.3417 - 8s/epoch - 34ms/step
Epoch 12/50
237/237 - 8s - loss: 3.2448 - accuracy300: 0.3926 - val_loss: 3.3139 - val_accuracy300: 0.3405 - 8s/epoch - 34ms/step
Epoch 13/50
237/237 - 8s - loss: 3.2361 - accuracy300: 0.4026 - val_loss: 3.3174 - val_accuracy300: 0.3411 - 8s/epoch - 34ms/step
Epoch 14/50
237/237 - 8s - loss: 3.2281 - accuracy300: 0.4055 - val_loss: 3.3209 - val_accuracy300: 0.3432 - 8s/epoch - 34ms/step
Epoch 15/50
237/237 - 8s - loss: 3.2225 - accuracy300: 0.4098 - val_loss: 3.3249 - val_accuracy300: 0.3418 - 8s/epoch - 35ms/step
Epoch 16/50
237/237 - 8s - loss: 3.2146 - accuracy300: 0.4128 - val_loss: 3.3296 - val_accuracy300: 0.3431 - 8s/epoch - 34ms/step
Epoch 17/50
237/237 - 8s - loss: 3.2078 - accuracy300: 0.4162 - val_loss: 3.3331 - val_accuracy300: 0.3456 - 8s/epoch - 34ms/step
Epoch 18/50
237/237 - 8s - loss: 3.2004 - accuracy300: 0.4198 - val_loss: 3.3363 - val_accuracy300: 0.3416 - 8s/epoch - 35ms/step
testing model: results/LILAK/W2/deepOF_L2/h300
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1029416
{'0': {'precision': 0.31245176047937806, 'recall': 0.277847106097287, 'f1-score': 0.2941351317432114, 'support': 80134}, '1': {'precision': 0.35370577321601004, 'recall': 0.37026520529274803, 'f1-score': 0.3617961068075378, 'support': 88045}, '2': {'precision': 0.3480418575406449, 'recall': 0.36766258258115786, 'f1-score': 0.35758327325162226, 'support': 84311}, 'accuracy': 0.3400649530674482, 'macro avg': {'precision': 0.3380664637453443, 'recall': 0.338591631323731, 'f1-score': 0.33783817060079047, 'support': 252490}, 'weighted avg': {'precision': 0.33872149878477326, 'recall': 0.3400649530674482, 'f1-score': 0.3389154668386775, 'support': 252490}}
[[22265 29247 28622]
 [26001 32600 29444]
 [22993 30320 30998]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0873762
{'0': {'precision': 0.38253626143181685, 'recall': 0.32749850388988627, 'f1-score': 0.35288427953464624, 'support': 20052}, '1': {'precision': 0.3705606634216694, 'recall': 0.40968658129453384, 'f1-score': 0.3891426272570225, 'support': 20069}, '2': {'precision': 0.3922485011565878, 'recall': 0.4069647842484204, 'f1-score': 0.39947115384615384, 'support': 20417}, 'accuracy': 0.38154547556906404, 'macro avg': {'precision': 0.3817818086700247, 'recall': 0.3813832898109468, 'f1-score': 0.3804993535459409, 'support': 60538}, 'weighted avg': {'precision': 0.38184176412425797, 'recall': 0.38154547556906404, 'f1-score': 0.38061616683284605, 'support': 60538}}
[[6567 7095 6390]
 [5363 8222 6484]
 [5237 6871 8309]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1016248
{'0': {'precision': 0.3346141530579571, 'recall': 0.28883360972913213, 'f1-score': 0.31004302032339415, 'support': 7236}, '1': {'precision': 0.35649358734902253, 'recall': 0.38851947346994165, 'f1-score': 0.37181818181818177, 'support': 7369}, '2': {'precision': 0.34112021857923497, 'recall': 0.35712242562929064, 'f1-score': 0.3489379541643376, 'support': 6992}, 'accuracy': 0.3449553178682224, 'macro avg': {'precision': 0.3440759863287382, 'recall': 0.3448251696094548, 'f1-score': 0.3435997187686379, 'support': 21597}, 'weighted avg': {'precision': 0.34418585104451244, 'recall': 0.3449553178682224, 'f1-score': 0.3437131848124883, 'support': 21597}}
[[2090 2645 2501]
 [2184 2863 2322]
 [1972 2523 2497]]
training model: results/LILAK/W2/deepOF_L2/h500
Epoch 1/50
237/237 - 11s - loss: 3.3558 - accuracy500: 0.3357 - val_loss: 3.3158 - val_accuracy500: 0.3575 - 11s/epoch - 46ms/step
Epoch 2/50
237/237 - 8s - loss: 3.3268 - accuracy500: 0.3431 - val_loss: 3.3062 - val_accuracy500: 0.3615 - 8s/epoch - 34ms/step
Epoch 3/50
237/237 - 8s - loss: 3.3096 - accuracy500: 0.3543 - val_loss: 3.2985 - val_accuracy500: 0.3656 - 8s/epoch - 34ms/step
Epoch 4/50
237/237 - 8s - loss: 3.2976 - accuracy500: 0.3587 - val_loss: 3.2981 - val_accuracy500: 0.3659 - 8s/epoch - 34ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2917 - accuracy500: 0.3626 - val_loss: 3.2940 - val_accuracy500: 0.3662 - 8s/epoch - 35ms/step
Epoch 6/50
237/237 - 8s - loss: 3.2837 - accuracy500: 0.3698 - val_loss: 3.2973 - val_accuracy500: 0.3685 - 8s/epoch - 35ms/step
Epoch 7/50
237/237 - 8s - loss: 3.2785 - accuracy500: 0.3726 - val_loss: 3.2989 - val_accuracy500: 0.3658 - 8s/epoch - 35ms/step
Epoch 8/50
237/237 - 9s - loss: 3.2732 - accuracy500: 0.3752 - val_loss: 3.2981 - val_accuracy500: 0.3665 - 9s/epoch - 36ms/step
Epoch 9/50
237/237 - 8s - loss: 3.2677 - accuracy500: 0.3813 - val_loss: 3.2985 - val_accuracy500: 0.3658 - 8s/epoch - 35ms/step
Epoch 10/50
237/237 - 8s - loss: 3.2597 - accuracy500: 0.3871 - val_loss: 3.3019 - val_accuracy500: 0.3667 - 8s/epoch - 35ms/step
Epoch 11/50
237/237 - 8s - loss: 3.2544 - accuracy500: 0.3906 - val_loss: 3.3029 - val_accuracy500: 0.3639 - 8s/epoch - 35ms/step
Epoch 12/50
237/237 - 8s - loss: 3.2496 - accuracy500: 0.3940 - val_loss: 3.3074 - val_accuracy500: 0.3623 - 8s/epoch - 35ms/step
Epoch 13/50
237/237 - 8s - loss: 3.2449 - accuracy500: 0.3991 - val_loss: 3.3070 - val_accuracy500: 0.3620 - 8s/epoch - 34ms/step
Epoch 14/50
237/237 - 8s - loss: 3.2364 - accuracy500: 0.4022 - val_loss: 3.3087 - val_accuracy500: 0.3652 - 8s/epoch - 34ms/step
Epoch 15/50
237/237 - 8s - loss: 3.2318 - accuracy500: 0.4031 - val_loss: 3.3119 - val_accuracy500: 0.3617 - 8s/epoch - 35ms/step
testing model: results/LILAK/W2/deepOF_L2/h500
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981331
{'0': {'precision': 0.31875308033514044, 'recall': 0.13421530479896238, 'f1-score': 0.1888941623160892, 'support': 77100}, '1': {'precision': 0.3871922593376514, 'recall': 0.7613911374447133, 'f1-score': 0.5133362637362638, 'support': 95864}, '2': {'precision': 0.3269236871331112, 'recall': 0.1295551140507507, 'f1-score': 0.18557109536117292, 'support': 79526}, 'accuracy': 0.3708701334706325, 'macro avg': {'precision': 0.3442896756019677, 'recall': 0.34172051876480874, 'f1-score': 0.2959338404711753, 'support': 252490}, 'weighted avg': {'precision': 0.34731115840600313, 'recall': 0.3708701334706325, 'f1-score': 0.3110298801183267, 'support': 252490}}
[[10348 56380 10372]
 [12034 72990 10840]
 [10082 59141 10303]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0976747
{'0': {'precision': 0.38528347406513874, 'recall': 0.15835399107585524, 'f1-score': 0.22445537596626847, 'support': 20170}, '1': {'precision': 0.34733756717147046, 'recall': 0.7737435694499406, 'f1-score': 0.47944827586206895, 'support': 20216}, '2': {'precision': 0.4031050734682562, 'recall': 0.14430329495831679, 'f1-score': 0.2125264927282029, 'support': 20152}, 'accuracy': 0.3591793584195051, 'macro avg': {'precision': 0.37857537156828847, 'recall': 0.3588002851613709, 'f1-score': 0.30547671485218014, 'support': 60538}, 'weighted avg': {'precision': 0.37854434190697733, 'recall': 0.3591793584195051, 'f1-score': 0.3056365449721822, 'support': 60538}}
[[ 3194 14728  2248]
 [ 2516 15642  2058]
 [ 2580 14664  2908]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0987451
{'0': {'precision': 0.3102697998259356, 'recall': 0.10107740289197618, 'f1-score': 0.15248075278015397, 'support': 7054}, '1': {'precision': 0.3772761215463266, 'recall': 0.8112648221343873, 'f1-score': 0.5150362673985494, 'support': 8096}, '2': {'precision': 0.3232804232804233, 'recall': 0.09477276252520553, 'f1-score': 0.14657550677701814, 'support': 6447}, 'accuracy': 0.3654211233041626, 'macro avg': {'precision': 0.3369421148842285, 'recall': 0.335704995850523, 'f1-score': 0.2713641756519071, 'support': 21597}, 'weighted avg': {'precision': 0.33927209968514604, 'recall': 0.3654211233041626, 'f1-score': 0.28662801051818765, 'support': 21597}}
[[ 713 5713  628]
 [ 877 6568  651]
 [ 708 5128  611]]
training model: results/LILAK/W2/deepOF_L2/h1000
Epoch 1/50
237/237 - 10s - loss: 3.3532 - accuracy1000: 0.3444 - val_loss: 3.3469 - val_accuracy1000: 0.3344 - 10s/epoch - 43ms/step
Epoch 2/50
237/237 - 8s - loss: 3.3257 - accuracy1000: 0.3512 - val_loss: 3.3410 - val_accuracy1000: 0.3387 - 8s/epoch - 34ms/step
Epoch 3/50
237/237 - 8s - loss: 3.3098 - accuracy1000: 0.3576 - val_loss: 3.3358 - val_accuracy1000: 0.3355 - 8s/epoch - 35ms/step
Epoch 4/50
237/237 - 8s - loss: 3.2990 - accuracy1000: 0.3621 - val_loss: 3.3381 - val_accuracy1000: 0.3357 - 8s/epoch - 35ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2924 - accuracy1000: 0.3656 - val_loss: 3.3335 - val_accuracy1000: 0.3353 - 8s/epoch - 35ms/step
Epoch 6/50
237/237 - 8s - loss: 3.2848 - accuracy1000: 0.3694 - val_loss: 3.3289 - val_accuracy1000: 0.3350 - 8s/epoch - 35ms/step
Epoch 7/50
237/237 - 8s - loss: 3.2787 - accuracy1000: 0.3736 - val_loss: 3.3321 - val_accuracy1000: 0.3367 - 8s/epoch - 35ms/step
Epoch 8/50
237/237 - 8s - loss: 3.2746 - accuracy1000: 0.3770 - val_loss: 3.3314 - val_accuracy1000: 0.3369 - 8s/epoch - 35ms/step
Epoch 9/50
237/237 - 8s - loss: 3.2691 - accuracy1000: 0.3794 - val_loss: 3.3326 - val_accuracy1000: 0.3357 - 8s/epoch - 34ms/step
Epoch 10/50
237/237 - 8s - loss: 3.2640 - accuracy1000: 0.3855 - val_loss: 3.3336 - val_accuracy1000: 0.3388 - 8s/epoch - 35ms/step
Epoch 11/50
237/237 - 8s - loss: 3.2582 - accuracy1000: 0.3897 - val_loss: 3.3361 - val_accuracy1000: 0.3375 - 8s/epoch - 35ms/step
Epoch 12/50
237/237 - 8s - loss: 3.2524 - accuracy1000: 0.3931 - val_loss: 3.3399 - val_accuracy1000: 0.3382 - 8s/epoch - 35ms/step
Epoch 13/50
237/237 - 8s - loss: 3.2469 - accuracy1000: 0.3977 - val_loss: 3.3418 - val_accuracy1000: 0.3367 - 8s/epoch - 35ms/step
Epoch 14/50
237/237 - 8s - loss: 3.2417 - accuracy1000: 0.4003 - val_loss: 3.3471 - val_accuracy1000: 0.3343 - 8s/epoch - 35ms/step
Epoch 15/50
237/237 - 8s - loss: 3.2352 - accuracy1000: 0.4035 - val_loss: 3.3523 - val_accuracy1000: 0.3342 - 8s/epoch - 35ms/step
Epoch 16/50
237/237 - 9s - loss: 3.2295 - accuracy1000: 0.4061 - val_loss: 3.3579 - val_accuracy1000: 0.3362 - 9s/epoch - 36ms/step
testing model: results/LILAK/W2/deepOF_L2/h1000
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1070584
{'0': {'precision': 0.3322676896845695, 'recall': 0.07742063639862441, 'f1-score': 0.1255802245380859, 'support': 80547}, '1': {'precision': 0.3549153359267802, 'recall': 0.8179674925758846, 'f1-score': 0.49503531017735686, 'support': 88226}, '2': {'precision': 0.3447300009871993, 'recall': 0.12513587443410537, 'f1-score': 0.18361874046938811, 'support': 83717}, 'accuracy': 0.35200602004039766, 'macro avg': {'precision': 0.343971008866183, 'recall': 0.3401746678028715, 'f1-score': 0.26807809172827696, 'support': 252490}, 'weighted avg': {'precision': 0.3443133887327993, 'recall': 0.35200602004039766, 'f1-score': 0.2739201778979463, 'support': 252490}}
[[ 6236 63846 10465]
 [ 6612 72166  9448]
 [ 5920 67321 10476]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1046001
{'0': {'precision': 0.4080288870008496, 'recall': 0.09182161464557144, 'f1-score': 0.14990830699598112, 'support': 20921}, '1': {'precision': 0.3302915601023018, 'recall': 0.8335312645221252, 'f1-score': 0.47311040121919057, 'support': 19367}, '2': {'precision': 0.4122214234363767, 'recall': 0.14158024691358026, 'f1-score': 0.21077007902959013, 'support': 20250}, 'accuracy': 0.3457497769995705, 'macro avg': {'precision': 0.38351395684650935, 'recall': 0.35564437536042565, 'f1-score': 0.27792959574825393, 'support': 60538}, 'weighted avg': {'precision': 0.38456197452893526, 'recall': 0.3457497769995705, 'f1-score': 0.273663730738118, 'support': 60538}}
[[ 1921 16829  2171]
 [ 1307 16143  1917]
 [ 1480 15903  2867]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1133013
{'0': {'precision': 0.3133826496301278, 'recall': 0.061162882268014175, 'f1-score': 0.10235009883593234, 'support': 7619}, '1': {'precision': 0.3398632515736922, 'recall': 0.847267316017316, 'f1-score': 0.485127807900852, 'support': 7392}, '2': {'precision': 0.31331747919143876, 'recall': 0.08001822046765868, 'f1-score': 0.12747943880019352, 'support': 6586}, 'accuracy': 0.3359725887854795, 'macro avg': {'precision': 0.32218779346508625, 'recall': 0.3294828062509963, 'f1-score': 0.23831911517899262, 'support': 21597}, 'weighted avg': {'precision': 0.3224262851840298, 'recall': 0.3359725887854795, 'f1-score': 0.24102651956161228, 'support': 21597}}
[[ 466 6567  586]
 [ 560 6263  569]
 [ 461 5598  527]]
training model: results/LILAK/W2/deepVOL_L2/h10
Epoch 1/50
237/237 - 11s - loss: 3.3573 - accuracy10: 0.3389 - val_loss: 3.2846 - val_accuracy10: 0.3837 - 11s/epoch - 45ms/step
Epoch 2/50
237/237 - 8s - loss: 3.3064 - accuracy10: 0.3534 - val_loss: 3.2508 - val_accuracy10: 0.3997 - 8s/epoch - 33ms/step
Epoch 3/50
237/237 - 8s - loss: 3.2873 - accuracy10: 0.3604 - val_loss: 3.2423 - val_accuracy10: 0.3894 - 8s/epoch - 33ms/step
Epoch 4/50
237/237 - 8s - loss: 3.2666 - accuracy10: 0.3779 - val_loss: 3.2525 - val_accuracy10: 0.3844 - 8s/epoch - 33ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2557 - accuracy10: 0.3794 - val_loss: 3.2302 - val_accuracy10: 0.3855 - 8s/epoch - 33ms/step
Epoch 6/50
237/237 - 8s - loss: 3.2401 - accuracy10: 0.3906 - val_loss: 3.2288 - val_accuracy10: 0.3886 - 8s/epoch - 33ms/step
Epoch 7/50
237/237 - 8s - loss: 3.2255 - accuracy10: 0.3984 - val_loss: 3.2163 - val_accuracy10: 0.3997 - 8s/epoch - 33ms/step
Epoch 8/50
237/237 - 8s - loss: 3.2129 - accuracy10: 0.4045 - val_loss: 3.2216 - val_accuracy10: 0.3958 - 8s/epoch - 33ms/step
Epoch 9/50
237/237 - 8s - loss: 3.2014 - accuracy10: 0.4136 - val_loss: 3.2037 - val_accuracy10: 0.3925 - 8s/epoch - 33ms/step
Epoch 10/50
237/237 - 8s - loss: 3.1872 - accuracy10: 0.4200 - val_loss: 3.1935 - val_accuracy10: 0.4013 - 8s/epoch - 33ms/step
Epoch 11/50
237/237 - 8s - loss: 3.1752 - accuracy10: 0.4244 - val_loss: 3.1902 - val_accuracy10: 0.4150 - 8s/epoch - 33ms/step
Epoch 12/50
237/237 - 8s - loss: 3.1664 - accuracy10: 0.4296 - val_loss: 3.1788 - val_accuracy10: 0.4158 - 8s/epoch - 32ms/step
Epoch 13/50
237/237 - 8s - loss: 3.1554 - accuracy10: 0.4347 - val_loss: 3.1782 - val_accuracy10: 0.4083 - 8s/epoch - 33ms/step
Epoch 14/50
237/237 - 8s - loss: 3.1428 - accuracy10: 0.4416 - val_loss: 3.1678 - val_accuracy10: 0.4201 - 8s/epoch - 33ms/step
Epoch 15/50
237/237 - 8s - loss: 3.1318 - accuracy10: 0.4448 - val_loss: 3.1832 - val_accuracy10: 0.4108 - 8s/epoch - 32ms/step
Epoch 16/50
237/237 - 8s - loss: 3.1232 - accuracy10: 0.4476 - val_loss: 3.1807 - val_accuracy10: 0.4076 - 8s/epoch - 33ms/step
Epoch 17/50
237/237 - 8s - loss: 3.1117 - accuracy10: 0.4522 - val_loss: 3.1982 - val_accuracy10: 0.4095 - 8s/epoch - 32ms/step
Epoch 18/50
237/237 - 8s - loss: 3.1036 - accuracy10: 0.4596 - val_loss: 3.1706 - val_accuracy10: 0.4235 - 8s/epoch - 33ms/step
Epoch 19/50
237/237 - 8s - loss: 3.0925 - accuracy10: 0.4606 - val_loss: 3.1653 - val_accuracy10: 0.4156 - 8s/epoch - 33ms/step
Epoch 20/50
237/237 - 8s - loss: 3.0874 - accuracy10: 0.4626 - val_loss: 3.1699 - val_accuracy10: 0.4283 - 8s/epoch - 32ms/step
Epoch 21/50
237/237 - 8s - loss: 3.0785 - accuracy10: 0.4690 - val_loss: 3.1745 - val_accuracy10: 0.4292 - 8s/epoch - 32ms/step
Epoch 22/50
237/237 - 8s - loss: 3.0726 - accuracy10: 0.4713 - val_loss: 3.1856 - val_accuracy10: 0.4206 - 8s/epoch - 33ms/step
Epoch 23/50
237/237 - 8s - loss: 3.0594 - accuracy10: 0.4759 - val_loss: 3.1846 - val_accuracy10: 0.4239 - 8s/epoch - 33ms/step
Epoch 24/50
237/237 - 8s - loss: 3.0544 - accuracy10: 0.4765 - val_loss: 3.2077 - val_accuracy10: 0.4263 - 8s/epoch - 33ms/step
Epoch 25/50
237/237 - 8s - loss: 3.0492 - accuracy10: 0.4792 - val_loss: 3.1985 - val_accuracy10: 0.4135 - 8s/epoch - 32ms/step
Epoch 26/50
237/237 - 8s - loss: 3.0419 - accuracy10: 0.4832 - val_loss: 3.2071 - val_accuracy10: 0.4226 - 8s/epoch - 33ms/step
Epoch 27/50
237/237 - 8s - loss: 3.0306 - accuracy10: 0.4840 - val_loss: 3.1859 - val_accuracy10: 0.4326 - 8s/epoch - 33ms/step
Epoch 28/50
237/237 - 8s - loss: 3.0242 - accuracy10: 0.4865 - val_loss: 3.1906 - val_accuracy10: 0.4320 - 8s/epoch - 32ms/step
Epoch 29/50
237/237 - 8s - loss: 3.0177 - accuracy10: 0.4897 - val_loss: 3.1703 - val_accuracy10: 0.4348 - 8s/epoch - 32ms/step
testing model: results/LILAK/W2/deepVOL_L2/h10
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.072965
{'0': {'precision': 0.3383696041684826, 'recall': 0.4991, 'f1-score': 0.4033108034008462, 'support': 70000}, '1': {'precision': 0.5019204090757959, 'recall': 0.3870083717147429, 'f1-score': 0.437037037037037, 'support': 113119}, '2': {'precision': 0.39246731051384165, 'recall': 0.3508706180811808, 'f1-score': 0.37050510277855997, 'support': 69376}, 'accuracy': 0.4081546169231074, 'macro avg': {'precision': 0.4109191079193734, 'recall': 0.41232632993197454, 'f1-score': 0.4036176477388144, 'support': 252495}, 'weighted avg': {'precision': 0.4265051552713797, 'recall': 0.4081546169231074, 'f1-score': 0.40940656583701535, 'support': 252495}}
[[34937 20982 14081]
 [45741 43778 23600]
 [22573 22461 24342]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0477983
{'0': {'precision': 0.38674252447737495, 'recall': 0.5070837911293588, 'f1-score': 0.4388120199164311, 'support': 17293}, '1': {'precision': 0.5213505461767627, 'recall': 0.4287714385719286, 'f1-score': 0.47055057618437907, 'support': 25713}, '2': {'precision': 0.4214020815887068, 'recall': 0.4018137226943478, 'f1-score': 0.41137485036933225, 'support': 17533}, 'accuracy': 0.44333404912535723, 'macro avg': {'precision': 0.4431650507476148, 'recall': 0.44588965079854503, 'f1-score': 0.4402458154900475, 'support': 60539}, 'weighted avg': {'precision': 0.45395311726531884, 'recall': 0.44333404912535723, 'f1-score': 0.4443462640177288, 'support': 60539}}
[[ 8769  4963  3561]
 [ 8576 11025  6112]
 [ 5329  5159  7045]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0662954
{'0': {'precision': 0.3369671729544341, 'recall': 0.480440097799511, 'f1-score': 0.3961123110151188, 'support': 5726}, '1': {'precision': 0.5233621127475876, 'recall': 0.413150245564799, 'f1-score': 0.4617711309023693, 'support': 9977}, '2': {'precision': 0.38633093525179857, 'recall': 0.3642530100050873, 'f1-score': 0.3749672689185651, 'support': 5897}, 'accuracy': 0.4176388888888889, 'macro avg': {'precision': 0.41555340698460674, 'recall': 0.4192811177897991, 'f1-score': 0.41095023694535104, 'support': 21600}, 'weighted avg': {'precision': 0.4365394146481309, 'recall': 0.4176388888888889, 'f1-score': 0.42066720605084656, 'support': 21600}}
[[2751 1845 1130]
 [3573 4122 2282]
 [1840 1909 2148]]
training model: results/LILAK/W2/deepVOL_L2/h20
Epoch 1/50
237/237 - 11s - loss: 3.3567 - accuracy20: 0.3448 - val_loss: 3.3300 - val_accuracy20: 0.3499 - 11s/epoch - 46ms/step
Epoch 2/50
237/237 - 8s - loss: 3.3133 - accuracy20: 0.3552 - val_loss: 3.3155 - val_accuracy20: 0.3550 - 8s/epoch - 35ms/step
Epoch 3/50
237/237 - 8s - loss: 3.2931 - accuracy20: 0.3638 - val_loss: 3.3050 - val_accuracy20: 0.3623 - 8s/epoch - 34ms/step
Epoch 4/50
237/237 - 8s - loss: 3.2746 - accuracy20: 0.3780 - val_loss: 3.2959 - val_accuracy20: 0.3722 - 8s/epoch - 33ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2663 - accuracy20: 0.3813 - val_loss: 3.2892 - val_accuracy20: 0.3695 - 8s/epoch - 33ms/step
Epoch 6/50
237/237 - 8s - loss: 3.2546 - accuracy20: 0.3929 - val_loss: 3.2850 - val_accuracy20: 0.3694 - 8s/epoch - 33ms/step
Epoch 7/50
237/237 - 8s - loss: 3.2419 - accuracy20: 0.4008 - val_loss: 3.2736 - val_accuracy20: 0.3810 - 8s/epoch - 36ms/step
Epoch 8/50
237/237 - 8s - loss: 3.2288 - accuracy20: 0.4086 - val_loss: 3.2673 - val_accuracy20: 0.3851 - 8s/epoch - 32ms/step
Epoch 9/50
237/237 - 8s - loss: 3.2208 - accuracy20: 0.4148 - val_loss: 3.2505 - val_accuracy20: 0.3935 - 8s/epoch - 32ms/step
Epoch 10/50
237/237 - 8s - loss: 3.2131 - accuracy20: 0.4195 - val_loss: 3.2475 - val_accuracy20: 0.3904 - 8s/epoch - 33ms/step
Epoch 11/50
237/237 - 8s - loss: 3.2063 - accuracy20: 0.4216 - val_loss: 3.2549 - val_accuracy20: 0.3870 - 8s/epoch - 32ms/step
Epoch 12/50
237/237 - 8s - loss: 3.1958 - accuracy20: 0.4289 - val_loss: 3.2553 - val_accuracy20: 0.3916 - 8s/epoch - 32ms/step
Epoch 13/50
237/237 - 8s - loss: 3.1858 - accuracy20: 0.4325 - val_loss: 3.2550 - val_accuracy20: 0.3918 - 8s/epoch - 33ms/step
Epoch 14/50
237/237 - 8s - loss: 3.1763 - accuracy20: 0.4368 - val_loss: 3.2563 - val_accuracy20: 0.3903 - 8s/epoch - 32ms/step
Epoch 15/50
237/237 - 8s - loss: 3.1722 - accuracy20: 0.4386 - val_loss: 3.2659 - val_accuracy20: 0.3908 - 8s/epoch - 32ms/step
Epoch 16/50
237/237 - 8s - loss: 3.1619 - accuracy20: 0.4406 - val_loss: 3.2659 - val_accuracy20: 0.3873 - 8s/epoch - 32ms/step
Epoch 17/50
237/237 - 8s - loss: 3.1518 - accuracy20: 0.4477 - val_loss: 3.2710 - val_accuracy20: 0.3926 - 8s/epoch - 32ms/step
Epoch 18/50
237/237 - 8s - loss: 3.1454 - accuracy20: 0.4504 - val_loss: 3.2798 - val_accuracy20: 0.3884 - 8s/epoch - 33ms/step
Epoch 19/50
237/237 - 8s - loss: 3.1368 - accuracy20: 0.4526 - val_loss: 3.2737 - val_accuracy20: 0.3874 - 8s/epoch - 34ms/step
Epoch 20/50
237/237 - 8s - loss: 3.1252 - accuracy20: 0.4557 - val_loss: 3.2684 - val_accuracy20: 0.3973 - 8s/epoch - 33ms/step
testing model: results/LILAK/W2/deepVOL_L2/h20
Evaluating performance on  test set...
987/987 - 17s - 17s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0937965
{'0': {'precision': 0.35816963518698813, 'recall': 0.46821891143220784, 'f1-score': 0.4058667012784736, 'support': 80142}, '1': {'precision': 0.3713060863164805, 'recall': 0.41153125344504465, 'f1-score': 0.3903852086568678, 'support': 90710}, '2': {'precision': 0.4174860145787422, 'recall': 0.24131891282779908, 'f1-score': 0.3058485659952653, 'support': 81643}, 'accuracy': 0.374486623497495, 'macro avg': {'precision': 0.38232057869407027, 'recall': 0.37368969256835055, 'f1-score': 0.3673668253102022, 'support': 252495}, 'weighted avg': {'precision': 0.38206862187835716, 'recall': 0.374486623497495, 'f1-score': 0.36796453761332043, 'support': 252495}}
[[37524 29723 12895]
 [38785 37330 14595]
 [28457 33484 19702]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0843322
{'0': {'precision': 0.4021467077396996, 'recall': 0.4182519022827393, 'f1-score': 0.41004122497055356, 'support': 19976}, '1': {'precision': 0.3634679224889987, 'recall': 0.47120052044237604, 'f1-score': 0.41038157292597355, 'support': 19983}, '2': {'precision': 0.4485097784513242, 'recall': 0.3019922254616132, 'f1-score': 0.36094897929552516, 'support': 20580}, 'accuracy': 0.39620740349196387, 'macro avg': {'precision': 0.40470813622667423, 'recall': 0.3971482160622428, 'f1-score': 0.39379059239735076, 'support': 60539}, 'weighted avg': {'precision': 0.4051403784243901, 'recall': 0.39620740349196387, 'f1-score': 0.3934648487040324, 'support': 60539}}
[[8355 7959 3662]
 [6587 9416 3980]
 [5834 8531 6215]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0838413
{'0': {'precision': 0.3722455403987408, 'recall': 0.42415184576296516, 'f1-score': 0.39650716032134126, 'support': 6691}, '1': {'precision': 0.3930490077842342, 'recall': 0.45162509448223737, 'f1-score': 0.4203059968345155, 'support': 7938}, '2': {'precision': 0.42409886714727085, 'recall': 0.29536651843351025, 'f1-score': 0.3482157957043802, 'support': 6971}, 'accuracy': 0.3926851851851852, 'macro avg': {'precision': 0.39646447177674854, 'recall': 0.3903811528929042, 'f1-score': 0.38834298428674563, 'support': 21600}, 'weighted avg': {'precision': 0.39662551562420606, 'recall': 0.3926851851851852, 'f1-score': 0.3896680890943386, 'support': 21600}}
[[2838 2677 1176]
 [2733 3585 1620]
 [2053 2859 2059]]
training model: results/LILAK/W2/deepVOL_L2/h30
Epoch 1/50
237/237 - 10s - loss: 3.3458 - accuracy30: 0.3490 - val_loss: 3.3290 - val_accuracy30: 0.3523 - 10s/epoch - 42ms/step
Epoch 2/50
237/237 - 8s - loss: 3.3091 - accuracy30: 0.3523 - val_loss: 3.3212 - val_accuracy30: 0.3475 - 8s/epoch - 33ms/step
Epoch 3/50
237/237 - 8s - loss: 3.2933 - accuracy30: 0.3602 - val_loss: 3.2991 - val_accuracy30: 0.3594 - 8s/epoch - 32ms/step
Epoch 4/50
237/237 - 7s - loss: 3.2770 - accuracy30: 0.3728 - val_loss: 3.3057 - val_accuracy30: 0.3559 - 7s/epoch - 31ms/step
Epoch 5/50
237/237 - 7s - loss: 3.2629 - accuracy30: 0.3891 - val_loss: 3.3107 - val_accuracy30: 0.3579 - 7s/epoch - 30ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2548 - accuracy30: 0.3913 - val_loss: 3.2993 - val_accuracy30: 0.3650 - 7s/epoch - 31ms/step
Epoch 7/50
237/237 - 7s - loss: 3.2461 - accuracy30: 0.3993 - val_loss: 3.2896 - val_accuracy30: 0.3663 - 7s/epoch - 31ms/step
Epoch 8/50
237/237 - 7s - loss: 3.2349 - accuracy30: 0.4072 - val_loss: 3.2833 - val_accuracy30: 0.3743 - 7s/epoch - 31ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2245 - accuracy30: 0.4121 - val_loss: 3.2800 - val_accuracy30: 0.3766 - 7s/epoch - 31ms/step
Epoch 10/50
237/237 - 7s - loss: 3.2199 - accuracy30: 0.4139 - val_loss: 3.2727 - val_accuracy30: 0.3801 - 7s/epoch - 31ms/step
Epoch 11/50
237/237 - 8s - loss: 3.2122 - accuracy30: 0.4178 - val_loss: 3.2704 - val_accuracy30: 0.3791 - 8s/epoch - 32ms/step
Epoch 12/50
237/237 - 8s - loss: 3.2074 - accuracy30: 0.4194 - val_loss: 3.2875 - val_accuracy30: 0.3761 - 8s/epoch - 33ms/step
Epoch 13/50
237/237 - 8s - loss: 3.1994 - accuracy30: 0.4245 - val_loss: 3.2858 - val_accuracy30: 0.3792 - 8s/epoch - 32ms/step
Epoch 14/50
237/237 - 8s - loss: 3.1899 - accuracy30: 0.4287 - val_loss: 3.2801 - val_accuracy30: 0.3804 - 8s/epoch - 33ms/step
Epoch 15/50
237/237 - 8s - loss: 3.1786 - accuracy30: 0.4335 - val_loss: 3.2794 - val_accuracy30: 0.3844 - 8s/epoch - 33ms/step
Epoch 16/50
237/237 - 8s - loss: 3.1785 - accuracy30: 0.4352 - val_loss: 3.2852 - val_accuracy30: 0.3848 - 8s/epoch - 33ms/step
Epoch 17/50
237/237 - 8s - loss: 3.1695 - accuracy30: 0.4379 - val_loss: 3.2822 - val_accuracy30: 0.3891 - 8s/epoch - 32ms/step
Epoch 18/50
237/237 - 8s - loss: 3.1667 - accuracy30: 0.4393 - val_loss: 3.2928 - val_accuracy30: 0.3811 - 8s/epoch - 34ms/step
Epoch 19/50
237/237 - 8s - loss: 3.1586 - accuracy30: 0.4430 - val_loss: 3.2890 - val_accuracy30: 0.3853 - 8s/epoch - 33ms/step
Epoch 20/50
237/237 - 8s - loss: 3.1550 - accuracy30: 0.4447 - val_loss: 3.2807 - val_accuracy30: 0.3933 - 8s/epoch - 32ms/step
Epoch 21/50
237/237 - 7s - loss: 3.1481 - accuracy30: 0.4479 - val_loss: 3.2860 - val_accuracy30: 0.3821 - 7s/epoch - 31ms/step
testing model: results/LILAK/W2/deepVOL_L2/h30
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1100975
{'0': {'precision': 0.3337378130041383, 'recall': 0.6030392132011863, 'f1-score': 0.4296795983239416, 'support': 78902}, '1': {'precision': 0.36290104818715174, 'recall': 0.3316210365751074, 'f1-score': 0.34655664496316657, 'support': 89159}, '2': {'precision': 0.45597694281396084, 'recall': 0.15364663524172725, 'f1-score': 0.2298445320458874, 'support': 84434}, 'accuracy': 0.35692191924592565, 'macro avg': {'precision': 0.38420526800175026, 'recall': 0.36276896167267364, 'f1-score': 0.3353602584443318, 'support': 252495}, 'weighted avg': {'precision': 0.3849123058536793, 'recall': 0.35692191924592565, 'f1-score': 0.3335033042000399, 'support': 252495}}
[[47581 23384  7937]
 [52051 29567  7541]
 [42938 28523 12973]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0878627
{'0': {'precision': 0.38492409701622754, 'recall': 0.554299211015629, 'f1-score': 0.4543394982905631, 'support': 19899}, '1': {'precision': 0.3663067709927001, 'recall': 0.41927252714264274, 'f1-score': 0.3910041060097051, 'support': 19987}, '2': {'precision': 0.4769623626068613, 'recall': 0.20800852176439258, 'f1-score': 0.2896830748482805, 'support': 20653}, 'accuracy': 0.3915822857992369, 'macro avg': {'precision': 0.4093977435385963, 'recall': 0.3938600866408881, 'f1-score': 0.3783422263828496, 'support': 60539}, 'weighted avg': {'precision': 0.4101766086865742, 'recall': 0.3915822857992369, 'f1-score': 0.37725640146255185, 'support': 60539}}
[[11030  6603  2266]
 [ 9162  8380  2445]
 [ 8463  7894  4296]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0912975
{'0': {'precision': 0.3600483286347161, 'recall': 0.5292289477578808, 'f1-score': 0.42854574869674633, 'support': 6757}, '1': {'precision': 0.3780256288561936, 'recall': 0.40694852471580023, 'f1-score': 0.39195423509872673, 'support': 7829}, '2': {'precision': 0.4382716049382716, 'recall': 0.2024522383803821, 'f1-score': 0.27696508679539694, 'support': 7014}, 'accuracy': 0.3787962962962963, 'macro avg': {'precision': 0.39211518747639373, 'recall': 0.37954323695135433, 'f1-score': 0.36582169019695665, 'support': 21600}, 'weighted avg': {'precision': 0.3919651037933775, 'recall': 0.3787962962962963, 'f1-score': 0.36606140969049816, 'support': 21600}}
[[3576 2416  765]
 [3588 3186 1055]
 [2768 2826 1420]]
training model: results/LILAK/W2/deepVOL_L2/h50
Epoch 1/50
237/237 - 10s - loss: 3.3584 - accuracy50: 0.3428 - val_loss: 3.3466 - val_accuracy50: 0.3408 - 10s/epoch - 42ms/step
Epoch 2/50
237/237 - 8s - loss: 3.3140 - accuracy50: 0.3539 - val_loss: 3.3357 - val_accuracy50: 0.3412 - 8s/epoch - 32ms/step
Epoch 3/50
237/237 - 8s - loss: 3.2980 - accuracy50: 0.3616 - val_loss: 3.3197 - val_accuracy50: 0.3464 - 8s/epoch - 32ms/step
Epoch 4/50
237/237 - 8s - loss: 3.2785 - accuracy50: 0.3749 - val_loss: 3.3106 - val_accuracy50: 0.3516 - 8s/epoch - 32ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2709 - accuracy50: 0.3816 - val_loss: 3.3246 - val_accuracy50: 0.3496 - 8s/epoch - 32ms/step
Epoch 6/50
237/237 - 7s - loss: 3.2610 - accuracy50: 0.3901 - val_loss: 3.3115 - val_accuracy50: 0.3602 - 7s/epoch - 32ms/step
Epoch 7/50
237/237 - 8s - loss: 3.2532 - accuracy50: 0.3978 - val_loss: 3.3177 - val_accuracy50: 0.3595 - 8s/epoch - 32ms/step
Epoch 8/50
237/237 - 8s - loss: 3.2417 - accuracy50: 0.4024 - val_loss: 3.3029 - val_accuracy50: 0.3694 - 8s/epoch - 33ms/step
Epoch 9/50
237/237 - 8s - loss: 3.2353 - accuracy50: 0.4062 - val_loss: 3.3305 - val_accuracy50: 0.3599 - 8s/epoch - 33ms/step
Epoch 10/50
237/237 - 8s - loss: 3.2280 - accuracy50: 0.4112 - val_loss: 3.3313 - val_accuracy50: 0.3625 - 8s/epoch - 33ms/step
Epoch 11/50
237/237 - 8s - loss: 3.2208 - accuracy50: 0.4127 - val_loss: 3.3361 - val_accuracy50: 0.3591 - 8s/epoch - 32ms/step
Epoch 12/50
237/237 - 8s - loss: 3.2157 - accuracy50: 0.4173 - val_loss: 3.3098 - val_accuracy50: 0.3729 - 8s/epoch - 32ms/step
Epoch 13/50
237/237 - 8s - loss: 3.2077 - accuracy50: 0.4209 - val_loss: 3.3063 - val_accuracy50: 0.3796 - 8s/epoch - 32ms/step
Epoch 14/50
237/237 - 8s - loss: 3.1992 - accuracy50: 0.4249 - val_loss: 3.3276 - val_accuracy50: 0.3752 - 8s/epoch - 32ms/step
Epoch 15/50
237/237 - 7s - loss: 3.1948 - accuracy50: 0.4265 - val_loss: 3.3324 - val_accuracy50: 0.3757 - 7s/epoch - 32ms/step
Epoch 16/50
237/237 - 8s - loss: 3.1898 - accuracy50: 0.4308 - val_loss: 3.3324 - val_accuracy50: 0.3756 - 8s/epoch - 32ms/step
Epoch 17/50
237/237 - 8s - loss: 3.1838 - accuracy50: 0.4332 - val_loss: 3.3388 - val_accuracy50: 0.3757 - 8s/epoch - 32ms/step
Epoch 18/50
237/237 - 8s - loss: 3.1788 - accuracy50: 0.4363 - val_loss: 3.3190 - val_accuracy50: 0.3836 - 8s/epoch - 32ms/step
testing model: results/LILAK/W2/deepVOL_L2/h50
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1228629
{'0': {'precision': 0.31882075389671743, 'recall': 0.7015740197454017, 'f1-score': 0.4384114142239404, 'support': 78398}, '1': {'precision': 0.3573155985489722, 'recall': 0.12032575500508992, 'f1-score': 0.18002741534243794, 'support': 88410}, '2': {'precision': 0.41409393299605624, 'recall': 0.2426272363369006, 'f1-score': 0.30597602525516393, 'support': 85687}, 'accuracy': 0.3423038079961979, 'macro avg': {'precision': 0.3634100951472486, 'recall': 0.3548423370291307, 'f1-score': 0.3081382849405141, 'support': 252495}, 'weighted avg': {'precision': 0.36463157040077054, 'recall': 0.3423038079961979, 'f1-score': 0.3029959782126087, 'support': 252495}}
[[55002  9026 14370]
 [62726 10638 15046]
 [54789 10108 20790]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0962118
{'0': {'precision': 0.3610339311273891, 'recall': 0.6541903986981286, 'f1-score': 0.46528619224161316, 'support': 19664}, '1': {'precision': 0.3848655888261743, 'recall': 0.20056835177983848, 'f1-score': 0.26370817082363734, 'support': 20058}, '2': {'precision': 0.42898650985818054, 'recall': 0.2978815391266753, 'f1-score': 0.3516103424812883, 'support': 20817}, 'accuracy': 0.3813739903202894, 'macro avg': {'precision': 0.3916286766039147, 'recall': 0.3842134298682141, 'f1-score': 0.3602015685155129, 'support': 60539}, 'weighted avg': {'precision': 0.3922961624420973, 'recall': 0.3813739903202894, 'f1-score': 0.3594099452262604, 'support': 60539}}
[[12864  2858  3942]
 [11723  4023  4312]
 [11044  3572  6201]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1024208
{'0': {'precision': 0.3486810551558753, 'recall': 0.6270845313398505, 'f1-score': 0.4481660330833248, 'support': 6956}, '1': {'precision': 0.36427566807313644, 'recall': 0.21215017064846417, 'f1-score': 0.26813907341903204, 'support': 7325}, '2': {'precision': 0.42081260364842454, 'recall': 0.27736029512228444, 'f1-score': 0.3343490076587334, 'support': 7319}, 'accuracy': 0.36787037037037035, 'macro avg': {'precision': 0.37792310895914544, 'recall': 0.37219833237019967, 'f1-score': 0.3502180380536968, 'support': 21600}, 'weighted avg': {'precision': 0.3784107469630931, 'recall': 0.36787037037037035, 'f1-score': 0.3485491678692725, 'support': 21600}}
[[4362 1240 1354]
 [4331 1554 1440]
 [3817 1472 2030]]
training model: results/LILAK/W2/deepVOL_L2/h100
Epoch 1/50
237/237 - 10s - loss: 3.3670 - accuracy100: 0.3435 - val_loss: 3.3607 - val_accuracy100: 0.3380 - 10s/epoch - 43ms/step
Epoch 2/50
237/237 - 8s - loss: 3.3202 - accuracy100: 0.3567 - val_loss: 3.3360 - val_accuracy100: 0.3358 - 8s/epoch - 33ms/step
Epoch 3/50
237/237 - 8s - loss: 3.3186 - accuracy100: 0.3517 - val_loss: 3.3390 - val_accuracy100: 0.3458 - 8s/epoch - 33ms/step
Epoch 4/50
237/237 - 8s - loss: 3.2981 - accuracy100: 0.3614 - val_loss: 3.3214 - val_accuracy100: 0.3388 - 8s/epoch - 33ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2869 - accuracy100: 0.3691 - val_loss: 3.3169 - val_accuracy100: 0.3367 - 8s/epoch - 33ms/step
Epoch 6/50
237/237 - 8s - loss: 3.2757 - accuracy100: 0.3763 - val_loss: 3.3122 - val_accuracy100: 0.3524 - 8s/epoch - 33ms/step
Epoch 7/50
237/237 - 8s - loss: 3.2646 - accuracy100: 0.3848 - val_loss: 3.3209 - val_accuracy100: 0.3468 - 8s/epoch - 33ms/step
Epoch 8/50
237/237 - 8s - loss: 3.2543 - accuracy100: 0.3929 - val_loss: 3.3355 - val_accuracy100: 0.3467 - 8s/epoch - 32ms/step
Epoch 9/50
237/237 - 7s - loss: 3.2507 - accuracy100: 0.3972 - val_loss: 3.3308 - val_accuracy100: 0.3524 - 7s/epoch - 31ms/step
Epoch 10/50
237/237 - 8s - loss: 3.2417 - accuracy100: 0.4029 - val_loss: 3.3241 - val_accuracy100: 0.3579 - 8s/epoch - 34ms/step
Epoch 11/50
237/237 - 8s - loss: 3.2342 - accuracy100: 0.4062 - val_loss: 3.3320 - val_accuracy100: 0.3545 - 8s/epoch - 32ms/step
Epoch 12/50
237/237 - 8s - loss: 3.2270 - accuracy100: 0.4099 - val_loss: 3.3293 - val_accuracy100: 0.3559 - 8s/epoch - 32ms/step
Epoch 13/50
237/237 - 8s - loss: 3.2191 - accuracy100: 0.4141 - val_loss: 3.3355 - val_accuracy100: 0.3566 - 8s/epoch - 32ms/step
Epoch 14/50
237/237 - 8s - loss: 3.2089 - accuracy100: 0.4210 - val_loss: 3.3357 - val_accuracy100: 0.3615 - 8s/epoch - 32ms/step
Epoch 15/50
237/237 - 8s - loss: 3.1992 - accuracy100: 0.4246 - val_loss: 3.3516 - val_accuracy100: 0.3540 - 8s/epoch - 32ms/step
Epoch 16/50
237/237 - 8s - loss: 3.1948 - accuracy100: 0.4269 - val_loss: 3.3462 - val_accuracy100: 0.3585 - 8s/epoch - 33ms/step
testing model: results/LILAK/W2/deepVOL_L2/h100
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1094041
{'0': {'precision': 0.2817689312629515, 'recall': 0.4106613215596517, 'f1-score': 0.33421879305593827, 'support': 73837}, '1': {'precision': 0.3710230694702663, 'recall': 0.43679353857536274, 'f1-score': 0.4012308679790262, 'support': 97316}, '2': {'precision': 0.3710374402111166, 'recall': 0.1382803471761206, 'f1-score': 0.20147415746437755, 'support': 81342}, 'accuracy': 0.3329848115804273, 'macro avg': {'precision': 0.34127648031477814, 'recall': 0.328578402437045, 'f1-score': 0.3123079394997807, 'support': 252495}, 'weighted avg': {'precision': 0.3449271513015451, 'recall': 0.3329848115804273, 'f1-score': 0.3172823504924281, 'support': 252495}}
[[30322 34404  9111]
 [44853 42507  9956]
 [32438 37656 11248]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1032491
{'0': {'precision': 0.34739277451503825, 'recall': 0.39707078925956063, 'f1-score': 0.3705742762221168, 'support': 19664}, '1': {'precision': 0.353532059226404, 'recall': 0.5405405405405406, 'f1-score': 0.4274785077687515, 'support': 20054}, '2': {'precision': 0.4150790433725172, 'recall': 0.1475433456606311, 'f1-score': 0.21770250159450075, 'support': 20821}, 'accuracy': 0.3587769867358232, 'macro avg': {'precision': 0.3720012923713198, 'recall': 0.3617182251535775, 'f1-score': 0.33858509519512303, 'support': 60539}, 'weighted avg': {'precision': 0.3727055979756719, 'recall': 0.3587769867358232, 'f1-score': 0.3368474924945134, 'support': 60539}}
[[ 7808  9595  2261]
 [ 7146 10840  2068]
 [ 7522 10227  3072]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1078665
{'0': {'precision': 0.3241298089505365, 'recall': 0.3599244405696019, 'f1-score': 0.3410906086477555, 'support': 6882}, '1': {'precision': 0.35300814432086874, 'recall': 0.5372517659602826, 'f1-score': 0.4260648980023254, 'support': 7503}, '2': {'precision': 0.37179992122883027, 'recall': 0.13083853083853084, 'f1-score': 0.19356161574738567, 'support': 7215}, 'accuracy': 0.345, 'macro avg': {'precision': 0.3496459581667452, 'recall': 0.34267157912280516, 'f1-score': 0.3202390407991555, 'support': 21600}, 'weighted avg': {'precision': 0.35008416128255004, 'recall': 0.345, 'f1-score': 0.3213285905575319, 'support': 21600}}
[[2477 3637  768]
 [2645 4031  827]
 [2520 3751  944]]
training model: results/LILAK/W2/deepVOL_L2/h200
Epoch 1/50
237/237 - 10s - loss: 3.3662 - accuracy200: 0.3457 - val_loss: 3.3661 - val_accuracy200: 0.3348 - 10s/epoch - 43ms/step
Epoch 2/50
237/237 - 8s - loss: 3.3231 - accuracy200: 0.3514 - val_loss: 3.3197 - val_accuracy200: 0.3467 - 8s/epoch - 32ms/step
Epoch 3/50
237/237 - 8s - loss: 3.3071 - accuracy200: 0.3535 - val_loss: 3.3267 - val_accuracy200: 0.3375 - 8s/epoch - 32ms/step
Epoch 4/50
237/237 - 8s - loss: 3.2913 - accuracy200: 0.3625 - val_loss: 3.3241 - val_accuracy200: 0.3449 - 8s/epoch - 32ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2887 - accuracy200: 0.3647 - val_loss: 3.3265 - val_accuracy200: 0.3445 - 8s/epoch - 32ms/step
Epoch 6/50
237/237 - 8s - loss: 3.2808 - accuracy200: 0.3669 - val_loss: 3.3314 - val_accuracy200: 0.3513 - 8s/epoch - 34ms/step
Epoch 7/50
237/237 - 8s - loss: 3.2724 - accuracy200: 0.3752 - val_loss: 3.3410 - val_accuracy200: 0.3462 - 8s/epoch - 33ms/step
Epoch 8/50
237/237 - 8s - loss: 3.2699 - accuracy200: 0.3783 - val_loss: 3.3472 - val_accuracy200: 0.3403 - 8s/epoch - 33ms/step
Epoch 9/50
237/237 - 8s - loss: 3.2634 - accuracy200: 0.3847 - val_loss: 3.3494 - val_accuracy200: 0.3406 - 8s/epoch - 32ms/step
Epoch 10/50
237/237 - 8s - loss: 3.2583 - accuracy200: 0.3860 - val_loss: 3.3475 - val_accuracy200: 0.3408 - 8s/epoch - 32ms/step
Epoch 11/50
237/237 - 8s - loss: 3.2480 - accuracy200: 0.3919 - val_loss: 3.3615 - val_accuracy200: 0.3405 - 8s/epoch - 32ms/step
Epoch 12/50
237/237 - 8s - loss: 3.2421 - accuracy200: 0.3985 - val_loss: 3.3712 - val_accuracy200: 0.3401 - 8s/epoch - 32ms/step
testing model: results/LILAK/W2/deepVOL_L2/h200
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1139759
{'0': {'precision': 0.3099120972342075, 'recall': 0.5241493611705483, 'f1-score': 0.3895162068632722, 'support': 80851}, '1': {'precision': 0.34069247565244515, 'recall': 0.11686103879120749, 'f1-score': 0.17402850314242718, 'support': 84117}, '2': {'precision': 0.3637399309551208, 'recall': 0.3611342785654712, 'f1-score': 0.3624324215861076, 'support': 87527}, 'accuracy': 0.3319550882195687, 'macro avg': {'precision': 0.3381148346139245, 'recall': 0.3340482261757423, 'f1-score': 0.30865904386393567, 'support': 252495}, 'weighted avg': {'precision': 0.3388257069829046, 'recall': 0.3319550882195687, 'f1-score': 0.30833938495455837, 'support': 252495}}
[[42378  9354 29119]
 [48115  9830 26172]
 [46249  9669 31609]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1046872
{'0': {'precision': 0.3384190878104204, 'recall': 0.5234222021388764, 'f1-score': 0.41106423248294627, 'support': 19917}, '1': {'precision': 0.3542415031776734, 'recall': 0.12935775187931992, 'f1-score': 0.18951180753169, 'support': 19821}, '2': {'precision': 0.3625088904694168, 'recall': 0.3920484592086919, 'f1-score': 0.37670046423539744, 'support': 20801}, 'accuracy': 0.3492624589107848, 'macro avg': {'precision': 0.35172316048583685, 'recall': 0.34827613774229604, 'f1-score': 0.3257588347500113, 'support': 60539}, 'weighted avg': {'precision': 0.3518766619379102, 'recall': 0.3492624589107848, 'f1-score': 0.3267187467914728, 'support': 60539}}
[[10425  2253  7239]
 [10155  2564  7102]
 [10225  2421  8155]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1065995
{'0': {'precision': 0.34891952309985097, 'recall': 0.5025489669975852, 'f1-score': 0.41187465640461796, 'support': 7454}, '1': {'precision': 0.3239812959251837, 'recall': 0.14262608439935304, 'f1-score': 0.19806023481368046, 'support': 6801}, '2': {'precision': 0.36010165184243964, 'recall': 0.3858407079646018, 'f1-score': 0.37252711140322053, 'support': 7345}, 'accuracy': 0.34953703703703703, 'macro avg': {'precision': 0.34433415695582476, 'recall': 0.34367191978718004, 'f1-score': 0.32748733420717296, 'support': 21600}, 'weighted avg': {'precision': 0.34486988664611956, 'recall': 0.34953703703703703, 'f1-score': 0.3311728231048388, 'support': 21600}}
[[3746 1049 2659]
 [3454  970 2377]
 [3536  975 2834]]
training model: results/LILAK/W2/deepVOL_L2/h300
Epoch 1/50
237/237 - 10s - loss: 3.3711 - accuracy300: 0.3368 - val_loss: 3.3914 - val_accuracy300: 0.3229 - 10s/epoch - 41ms/step
Epoch 2/50
237/237 - 8s - loss: 3.3201 - accuracy300: 0.3446 - val_loss: 3.3385 - val_accuracy300: 0.3318 - 8s/epoch - 33ms/step
Epoch 3/50
237/237 - 8s - loss: 3.3016 - accuracy300: 0.3540 - val_loss: 3.3320 - val_accuracy300: 0.3362 - 8s/epoch - 34ms/step
Epoch 4/50
237/237 - 8s - loss: 3.2886 - accuracy300: 0.3605 - val_loss: 3.3211 - val_accuracy300: 0.3407 - 8s/epoch - 33ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2810 - accuracy300: 0.3725 - val_loss: 3.3149 - val_accuracy300: 0.3431 - 8s/epoch - 32ms/step
Epoch 6/50
237/237 - 8s - loss: 3.2727 - accuracy300: 0.3774 - val_loss: 3.3067 - val_accuracy300: 0.3491 - 8s/epoch - 33ms/step
Epoch 7/50
237/237 - 8s - loss: 3.2650 - accuracy300: 0.3826 - val_loss: 3.3339 - val_accuracy300: 0.3352 - 8s/epoch - 32ms/step
Epoch 8/50
237/237 - 8s - loss: 3.2598 - accuracy300: 0.3881 - val_loss: 3.3212 - val_accuracy300: 0.3468 - 8s/epoch - 32ms/step
Epoch 9/50
237/237 - 8s - loss: 3.2559 - accuracy300: 0.3908 - val_loss: 3.3153 - val_accuracy300: 0.3543 - 8s/epoch - 33ms/step
Epoch 10/50
237/237 - 8s - loss: 3.2460 - accuracy300: 0.3982 - val_loss: 3.3087 - val_accuracy300: 0.3559 - 8s/epoch - 32ms/step
Epoch 11/50
237/237 - 8s - loss: 3.2432 - accuracy300: 0.4005 - val_loss: 3.3269 - val_accuracy300: 0.3556 - 8s/epoch - 32ms/step
Epoch 12/50
237/237 - 8s - loss: 3.2324 - accuracy300: 0.4064 - val_loss: 3.3133 - val_accuracy300: 0.3613 - 8s/epoch - 32ms/step
Epoch 13/50
237/237 - 8s - loss: 3.2253 - accuracy300: 0.4109 - val_loss: 3.3268 - val_accuracy300: 0.3594 - 8s/epoch - 33ms/step
Epoch 14/50
237/237 - 8s - loss: 3.2213 - accuracy300: 0.4120 - val_loss: 3.3346 - val_accuracy300: 0.3575 - 8s/epoch - 32ms/step
Epoch 15/50
237/237 - 7s - loss: 3.2105 - accuracy300: 0.4187 - val_loss: 3.3419 - val_accuracy300: 0.3556 - 7s/epoch - 32ms/step
Epoch 16/50
237/237 - 8s - loss: 3.2084 - accuracy300: 0.4204 - val_loss: 3.3380 - val_accuracy300: 0.3600 - 8s/epoch - 32ms/step
testing model: results/LILAK/W2/deepVOL_L2/h300
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1174898
{'0': {'precision': 0.2975589833809808, 'recall': 0.5909703504043127, 'f1-score': 0.3958193162300295, 'support': 80136}, '1': {'precision': 0.3376485513813013, 'recall': 0.14811575767212593, 'f1-score': 0.2059067332970182, 'support': 88046}, '2': {'precision': 0.367472631905989, 'recall': 0.23848042413388207, 'f1-score': 0.2892469251240739, 'support': 84313}, 'accuracy': 0.3188419572664805, 'macro avg': {'precision': 0.334226722222757, 'recall': 0.32585551073677355, 'f1-score': 0.2969909915503739, 'support': 252495}, 'weighted avg': {'precision': 0.3348839028932295, 'recall': 0.3188419572664805, 'f1-score': 0.29400945350705937, 'support': 252495}}
[[47358 13413 19365]
 [59760 13041 15245]
 [52037 12169 20107]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0951694
{'0': {'precision': 0.3566490919742238, 'recall': 0.6085261632265481, 'f1-score': 0.4497220631959962, 'support': 20009}, '1': {'precision': 0.39533507986140454, 'recall': 0.23265529417615755, 'f1-score': 0.2929242329367564, 'support': 20107}, '2': {'precision': 0.39784429493340656, 'recall': 0.2837487146844244, 'f1-score': 0.3312469633313327, 'support': 20423}, 'accuracy': 0.3741224665091924, 'macro avg': {'precision': 0.38327615558967826, 'recall': 0.37497672402904336, 'f1-score': 0.3579644198213618, 'support': 60539}, 'weighted avg': {'precision': 0.3833953016652153, 'recall': 0.3741224665091924, 'f1-score': 0.3576764242267606, 'support': 60539}}
[[12176  3403  4430]
 [11088  4678  4341]
 [10876  3752  5795]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.102116
{'0': {'precision': 0.33803057477154325, 'recall': 0.5467606022931344, 'f1-score': 0.4177749630567869, 'support': 7239}, '1': {'precision': 0.38550895845638905, 'recall': 0.2653476080769752, 'f1-score': 0.3143361695296195, 'support': 7379}, '2': {'precision': 0.3480881130507066, 'recall': 0.23990260670295044, 'f1-score': 0.2840427335933526, 'support': 6982}, 'accuracy': 0.3514351851851852, 'macro avg': {'precision': 0.357209215426213, 'recall': 0.35067027235768666, 'f1-score': 0.33871795539325306, 'support': 21600}, 'weighted avg': {'precision': 0.357501163913932, 'recall': 0.3514351851851852, 'f1-score': 0.3392104591887005, 'support': 21600}}
[[3958 1670 1611]
 [3895 1958 1526]
 [3856 1451 1675]]
training model: results/LILAK/W2/deepVOL_L2/h500
Epoch 1/50
237/237 - 10s - loss: 3.3701 - accuracy500: 0.3394 - val_loss: 3.3409 - val_accuracy500: 0.3454 - 10s/epoch - 42ms/step
Epoch 2/50
237/237 - 8s - loss: 3.3227 - accuracy500: 0.3570 - val_loss: 3.3265 - val_accuracy500: 0.3491 - 8s/epoch - 32ms/step
Epoch 3/50
237/237 - 8s - loss: 3.3048 - accuracy500: 0.3632 - val_loss: 3.3098 - val_accuracy500: 0.3564 - 8s/epoch - 32ms/step
Epoch 4/50
237/237 - 8s - loss: 3.2903 - accuracy500: 0.3678 - val_loss: 3.2991 - val_accuracy500: 0.3667 - 8s/epoch - 33ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2777 - accuracy500: 0.3773 - val_loss: 3.3051 - val_accuracy500: 0.3595 - 8s/epoch - 32ms/step
Epoch 6/50
237/237 - 8s - loss: 3.2690 - accuracy500: 0.3827 - val_loss: 3.3071 - val_accuracy500: 0.3681 - 8s/epoch - 32ms/step
Epoch 7/50
237/237 - 8s - loss: 3.2564 - accuracy500: 0.3951 - val_loss: 3.3289 - val_accuracy500: 0.3579 - 8s/epoch - 32ms/step
Epoch 8/50
237/237 - 8s - loss: 3.2514 - accuracy500: 0.3974 - val_loss: 3.3314 - val_accuracy500: 0.3586 - 8s/epoch - 33ms/step
Epoch 9/50
237/237 - 8s - loss: 3.2370 - accuracy500: 0.4085 - val_loss: 3.3415 - val_accuracy500: 0.3622 - 8s/epoch - 33ms/step
Epoch 10/50
237/237 - 8s - loss: 3.2317 - accuracy500: 0.4097 - val_loss: 3.3261 - val_accuracy500: 0.3679 - 8s/epoch - 33ms/step
Epoch 11/50
237/237 - 8s - loss: 3.2208 - accuracy500: 0.4155 - val_loss: 3.3457 - val_accuracy500: 0.3638 - 8s/epoch - 33ms/step
Epoch 12/50
237/237 - 8s - loss: 3.2128 - accuracy500: 0.4202 - val_loss: 3.3539 - val_accuracy500: 0.3650 - 8s/epoch - 33ms/step
Epoch 13/50
237/237 - 8s - loss: 3.2106 - accuracy500: 0.4199 - val_loss: 3.3645 - val_accuracy500: 0.3668 - 8s/epoch - 32ms/step
Epoch 14/50
237/237 - 8s - loss: 3.1979 - accuracy500: 0.4259 - val_loss: 3.3579 - val_accuracy500: 0.3663 - 8s/epoch - 32ms/step
testing model: results/LILAK/W2/deepVOL_L2/h500
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1194234
{'0': {'precision': 0.29653556391609176, 'recall': 0.41197374905968714, 'f1-score': 0.34485042259484633, 'support': 77102}, '1': {'precision': 0.35790999850286426, 'recall': 0.4738121316434569, 'f1-score': 0.4077854686812645, 'support': 95865}, '2': {'precision': 0.26790838702690994, 'recall': 0.062217080776581835, 'f1-score': 0.10098268314336152, 'support': 79528}, 'accuracy': 0.3252896096952415, 'macro avg': {'precision': 0.3074513164819553, 'recall': 0.3160009871599086, 'f1-score': 0.2845395248064908, 'support': 252495}, 'weighted avg': {'precision': 0.3108209875799984, 'recall': 0.3252896096952415, 'f1-score': 0.2919343435040793, 'support': 252495}}
[[31764 39810  5528]
 [42450 45422  7993]
 [32903 41677  4948]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1050756
{'0': {'precision': 0.3536908308507117, 'recall': 0.42474534161490685, 'f1-score': 0.38597521052988054, 'support': 20125}, '1': {'precision': 0.3573806190698398, 'recall': 0.5674767832444181, 'f1-score': 0.43856534768749167, 'support': 20244}, '2': {'precision': 0.39209654519640325, 'recall': 0.08215171046108082, 'f1-score': 0.13584194130185276, 'support': 20170}, 'accuracy': 0.3583309932440245, 'macro avg': {'precision': 0.3677226650389849, 'recall': 0.3581246117734686, 'f1-score': 0.32012749983974165, 'support': 60539}, 'weighted avg': {'precision': 0.367720453590774, 'recall': 0.3583309932440245, 'f1-score': 0.3202233265590413, 'support': 60539}}
[[ 8548 10313  1264]
 [ 7451 11488  1305]
 [ 8169 10344  1657]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0999606
{'0': {'precision': 0.33461825416563046, 'recall': 0.38213575688724793, 'f1-score': 0.35680190930787586, 'support': 7042}, '1': {'precision': 0.38683669271904564, 'recall': 0.5798495498828462, 'f1-score': 0.4640742202921437, 'support': 8109}, '2': {'precision': 0.33499643620812547, 'recall': 0.07287951620406265, 'f1-score': 0.119714722363729, 'support': 6449}, 'accuracy': 0.3640277777777778, 'macro avg': {'precision': 0.35215046103093384, 'recall': 0.34495494099138563, 'f1-score': 0.3135302839879162, 'support': 21600}, 'weighted avg': {'precision': 0.3543348381573756, 'recall': 0.3640277777777778, 'f1-score': 0.32628783065827516, 'support': 21600}}
[[2691 3889  462]
 [2936 4702  471]
 [2415 3564  470]]
training model: results/LILAK/W2/deepVOL_L2/h1000
Epoch 1/50
237/237 - 10s - loss: 3.3531 - accuracy1000: 0.3564 - val_loss: 3.4097 - val_accuracy1000: 0.3235 - 10s/epoch - 43ms/step
Epoch 2/50
237/237 - 8s - loss: 3.3207 - accuracy1000: 0.3607 - val_loss: 3.3549 - val_accuracy1000: 0.3462 - 8s/epoch - 32ms/step
Epoch 3/50
237/237 - 8s - loss: 3.3045 - accuracy1000: 0.3605 - val_loss: 3.3371 - val_accuracy1000: 0.3496 - 8s/epoch - 33ms/step
Epoch 4/50
237/237 - 8s - loss: 3.2930 - accuracy1000: 0.3676 - val_loss: 3.3558 - val_accuracy1000: 0.3369 - 8s/epoch - 32ms/step
Epoch 5/50
237/237 - 8s - loss: 3.2826 - accuracy1000: 0.3754 - val_loss: 3.3374 - val_accuracy1000: 0.3551 - 8s/epoch - 33ms/step
Epoch 6/50
237/237 - 8s - loss: 3.2722 - accuracy1000: 0.3805 - val_loss: 3.3590 - val_accuracy1000: 0.3502 - 8s/epoch - 32ms/step
Epoch 7/50
237/237 - 8s - loss: 3.2589 - accuracy1000: 0.3896 - val_loss: 3.3707 - val_accuracy1000: 0.3463 - 8s/epoch - 32ms/step
Epoch 8/50
237/237 - 8s - loss: 3.2487 - accuracy1000: 0.3983 - val_loss: 3.3556 - val_accuracy1000: 0.3487 - 8s/epoch - 32ms/step
Epoch 9/50
237/237 - 8s - loss: 3.2418 - accuracy1000: 0.4027 - val_loss: 3.3756 - val_accuracy1000: 0.3470 - 8s/epoch - 32ms/step
Epoch 10/50
237/237 - 8s - loss: 3.2352 - accuracy1000: 0.4054 - val_loss: 3.3863 - val_accuracy1000: 0.3598 - 8s/epoch - 32ms/step
Epoch 11/50
237/237 - 8s - loss: 3.2289 - accuracy1000: 0.4097 - val_loss: 3.3974 - val_accuracy1000: 0.3545 - 8s/epoch - 32ms/step
Epoch 12/50
237/237 - 8s - loss: 3.2243 - accuracy1000: 0.4142 - val_loss: 3.4214 - val_accuracy1000: 0.3613 - 8s/epoch - 32ms/step
Epoch 13/50
237/237 - 8s - loss: 3.2204 - accuracy1000: 0.4151 - val_loss: 3.4004 - val_accuracy1000: 0.3597 - 8s/epoch - 32ms/step
testing model: results/LILAK/W2/deepVOL_L2/h1000
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1332209
{'0': {'precision': 0.2810651528611358, 'recall': 0.16104482985511925, 'f1-score': 0.20476393427096654, 'support': 80549}, '1': {'precision': 0.33212356858604725, 'recall': 0.7416210457116302, 'f1-score': 0.45878661454590075, 'support': 88227}, '2': {'precision': 0.33833297621598457, 'recall': 0.0377214252439709, 'f1-score': 0.06787529687382458, 'support': 83719}, 'accuracy': 0.32302025782688765, 'macro avg': {'precision': 0.3171738992210559, 'recall': 0.31346243360357345, 'f1-score': 0.2438086152302306, 'support': 252495}, 'weighted avg': {'precision': 0.3178941425346198, 'recall': 0.32302025782688765, 'f1-score': 0.24813698790911895, 'support': 252495}}
[[12972 64447  3130]
 [19750 65431  3046]
 [13431 67130  3158]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1205727
{'0': {'precision': 0.3821485305798253, 'recall': 0.18415386823596958, 'f1-score': 0.24853905014044486, 'support': 20901}, '1': {'precision': 0.3255483601420514, 'recall': 0.8040035082288604, 'f1-score': 0.4634440099326424, 'support': 19383}, '2': {'precision': 0.40315748941085866, 'recall': 0.051690940508516414, 'f1-score': 0.09163311745142656, 'support': 20255}, 'accuracy': 0.33829432266803217, 'macro avg': {'precision': 0.3702847933775784, 'recall': 0.3466161056577821, 'f1-score': 0.2678720591748379, 'support': 60539}, 'weighted avg': {'precision': 0.3710557698392648, 'recall': 0.33829432266803217, 'f1-score': 0.26484875411699055, 'support': 60539}}
[[ 3849 16255   797]
 [ 3046 15584   753]
 [ 3177 16031  1047]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1144716
{'0': {'precision': 0.3486370157819225, 'recall': 0.1601423487544484, 'f1-score': 0.21947254335260116, 'support': 7587}, '1': {'precision': 0.3432766793849, 'recall': 0.7999461134312272, 'f1-score': 0.4804012782654423, 'support': 7423}, '2': {'precision': 0.3402692778457772, 'recall': 0.04218512898330804, 'f1-score': 0.07506412852706898, 'support': 6590}, 'accuracy': 0.34402777777777777, 'macro avg': {'precision': 0.3440609910041999, 'recall': 0.3340911970563279, 'f1-score': 0.25831265004837084, 'support': 21600}, 'weighted avg': {'precision': 0.34424196161181625, 'recall': 0.34402777777777777, 'f1-score': 0.2650846982395346, 'support': 21600}}
[[1215 6087  285]
 [1231 5938  254]
 [1039 5273  278]]
training model: results/LILAK/W2/deepVOL_L3/h10
Epoch 1/50
237/237 - 13s - loss: 3.3601 - accuracy10: 0.3382 - val_loss: 3.2718 - val_accuracy10: 0.3677 - 13s/epoch - 56ms/step
Epoch 2/50
237/237 - 10s - loss: 3.3180 - accuracy10: 0.3484 - val_loss: 3.2513 - val_accuracy10: 0.3921 - 10s/epoch - 44ms/step
Epoch 3/50
237/237 - 10s - loss: 3.3084 - accuracy10: 0.3510 - val_loss: 3.2408 - val_accuracy10: 0.4153 - 10s/epoch - 43ms/step
Epoch 4/50
237/237 - 10s - loss: 3.2962 - accuracy10: 0.3567 - val_loss: 3.2341 - val_accuracy10: 0.4122 - 10s/epoch - 43ms/step
Epoch 5/50
237/237 - 10s - loss: 3.2849 - accuracy10: 0.3692 - val_loss: 3.2325 - val_accuracy10: 0.4024 - 10s/epoch - 43ms/step
Epoch 6/50
237/237 - 10s - loss: 3.2754 - accuracy10: 0.3798 - val_loss: 3.2367 - val_accuracy10: 0.4124 - 10s/epoch - 42ms/step
Epoch 7/50
237/237 - 11s - loss: 3.2648 - accuracy10: 0.3869 - val_loss: 3.2238 - val_accuracy10: 0.4091 - 11s/epoch - 45ms/step
Epoch 8/50
237/237 - 11s - loss: 3.2576 - accuracy10: 0.3930 - val_loss: 3.2239 - val_accuracy10: 0.4160 - 11s/epoch - 45ms/step
Epoch 9/50
237/237 - 11s - loss: 3.2471 - accuracy10: 0.4009 - val_loss: 3.2230 - val_accuracy10: 0.3975 - 11s/epoch - 45ms/step
Epoch 10/50
237/237 - 11s - loss: 3.2375 - accuracy10: 0.4075 - val_loss: 3.2097 - val_accuracy10: 0.4170 - 11s/epoch - 45ms/step
Epoch 11/50
237/237 - 11s - loss: 3.2268 - accuracy10: 0.4132 - val_loss: 3.2080 - val_accuracy10: 0.4228 - 11s/epoch - 44ms/step
Epoch 12/50
237/237 - 11s - loss: 3.2190 - accuracy10: 0.4199 - val_loss: 3.2130 - val_accuracy10: 0.4227 - 11s/epoch - 45ms/step
Epoch 13/50
237/237 - 11s - loss: 3.2062 - accuracy10: 0.4244 - val_loss: 3.2053 - val_accuracy10: 0.4215 - 11s/epoch - 46ms/step
Epoch 14/50
237/237 - 11s - loss: 3.1949 - accuracy10: 0.4315 - val_loss: 3.2014 - val_accuracy10: 0.4258 - 11s/epoch - 45ms/step
Epoch 15/50
237/237 - 10s - loss: 3.1859 - accuracy10: 0.4319 - val_loss: 3.1955 - val_accuracy10: 0.4272 - 10s/epoch - 44ms/step
Epoch 16/50
237/237 - 11s - loss: 3.1700 - accuracy10: 0.4416 - val_loss: 3.2073 - val_accuracy10: 0.4251 - 11s/epoch - 45ms/step
Epoch 17/50
237/237 - 10s - loss: 3.1576 - accuracy10: 0.4446 - val_loss: 3.1994 - val_accuracy10: 0.4137 - 10s/epoch - 44ms/step
Epoch 18/50
237/237 - 11s - loss: 3.1457 - accuracy10: 0.4477 - val_loss: 3.1898 - val_accuracy10: 0.4281 - 11s/epoch - 45ms/step
Epoch 19/50
237/237 - 10s - loss: 3.1341 - accuracy10: 0.4513 - val_loss: 3.1795 - val_accuracy10: 0.4288 - 10s/epoch - 44ms/step
Epoch 20/50
237/237 - 11s - loss: 3.1298 - accuracy10: 0.4544 - val_loss: 3.2008 - val_accuracy10: 0.4219 - 11s/epoch - 45ms/step
Epoch 21/50
237/237 - 11s - loss: 3.1160 - accuracy10: 0.4577 - val_loss: 3.1968 - val_accuracy10: 0.4105 - 11s/epoch - 44ms/step
Epoch 22/50
237/237 - 11s - loss: 3.1033 - accuracy10: 0.4629 - val_loss: 3.1916 - val_accuracy10: 0.4221 - 11s/epoch - 45ms/step
Epoch 23/50
237/237 - 11s - loss: 3.0930 - accuracy10: 0.4668 - val_loss: 3.2055 - val_accuracy10: 0.4174 - 11s/epoch - 45ms/step
Epoch 24/50
237/237 - 11s - loss: 3.0839 - accuracy10: 0.4700 - val_loss: 3.2006 - val_accuracy10: 0.4130 - 11s/epoch - 45ms/step
Epoch 25/50
237/237 - 10s - loss: 3.0686 - accuracy10: 0.4760 - val_loss: 3.1906 - val_accuracy10: 0.4193 - 10s/epoch - 44ms/step
Epoch 26/50
237/237 - 10s - loss: 3.0624 - accuracy10: 0.4767 - val_loss: 3.2252 - val_accuracy10: 0.4150 - 10s/epoch - 44ms/step
Epoch 27/50
237/237 - 10s - loss: 3.0540 - accuracy10: 0.4809 - val_loss: 3.2087 - val_accuracy10: 0.4218 - 10s/epoch - 44ms/step
Epoch 28/50
237/237 - 11s - loss: 3.0415 - accuracy10: 0.4850 - val_loss: 3.2129 - val_accuracy10: 0.4260 - 11s/epoch - 44ms/step
Epoch 29/50
237/237 - 10s - loss: 3.0314 - accuracy10: 0.4867 - val_loss: 3.2151 - val_accuracy10: 0.4176 - 10s/epoch - 44ms/step
testing model: results/LILAK/W2/deepVOL_L3/h10
Evaluating performance on  test set...
987/987 - 21s - 21s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0659024
{'0': {'precision': 0.3547310260148876, 'recall': 0.39621428571428574, 'f1-score': 0.37432685948740096, 'support': 70000}, '1': {'precision': 0.5095629402203359, 'recall': 0.49884634765158814, 'f1-score': 0.5041477001148044, 'support': 113119}, '2': {'precision': 0.3703062813635577, 'recall': 0.3393104243542435, 'f1-score': 0.35413140772499907, 'support': 69376}, 'accuracy': 0.426558941761223, 'macro avg': {'precision': 0.4115334158662604, 'recall': 0.41145701924003913, 'f1-score': 0.41086865577573484, 'support': 252495}, 'weighted avg': {'precision': 0.42837597034279684, 'recall': 0.426558941761223, 'f1-score': 0.4269382934146584, 'support': 252495}}
[[27735 26469 15796]
 [32457 56429 24233]
 [17994 27842 23540]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0443405
{'0': {'precision': 0.3979821891556758, 'recall': 0.4083155033828717, 'f1-score': 0.4030826316540603, 'support': 17293}, '1': {'precision': 0.5219163722483209, 'recall': 0.5228094738070237, 'f1-score': 0.5223625412861862, 'support': 25713}, '2': {'precision': 0.40657276995305164, 'recall': 0.3951405920264644, 'f1-score': 0.4007751713765077, 'support': 17533}, 'accuracy': 0.45312938766745403, 'macro avg': {'precision': 0.44215711045234946, 'recall': 0.44208852307211993, 'f1-score': 0.44207344810558474, 'support': 60539}, 'weighted avg': {'precision': 0.4531092692690172, 'recall': 0.45312938766745403, 'f1-score': 0.45307664568343836, 'support': 60539}}
[[ 7061  6022  4210]
 [ 6368 13443  5902]
 [ 4313  6292  6928]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0611814
{'0': {'precision': 0.33414793092212447, 'recall': 0.3581907090464548, 'f1-score': 0.345751854349292, 'support': 5726}, '1': {'precision': 0.5226269881990765, 'recall': 0.5104740904079382, 'f1-score': 0.5164790589189737, 'support': 9977}, '2': {'precision': 0.37484694769984256, 'recall': 0.36340512124809227, 'f1-score': 0.3690373686929568, 'support': 5897}, 'accuracy': 0.4299537037037037, 'macro avg': {'precision': 0.41054062227368116, 'recall': 0.4106899735674951, 'f1-score': 0.4104227606537408, 'support': 21600}, 'weighted avg': {'precision': 0.4323172668661224, 'recall': 0.4299537037037037, 'f1-score': 0.43096759500097287, 'support': 21600}}
[[2051 2334 1341]
 [2651 5093 2233]
 [1436 2318 2143]]
training model: results/LILAK/W2/deepVOL_L3/h20
Epoch 1/50
237/237 - 13s - loss: 3.3582 - accuracy20: 0.3411 - val_loss: 3.3278 - val_accuracy20: 0.3372 - 13s/epoch - 56ms/step
Epoch 2/50
237/237 - 11s - loss: 3.3212 - accuracy20: 0.3469 - val_loss: 3.2994 - val_accuracy20: 0.3571 - 11s/epoch - 45ms/step
Epoch 3/50
237/237 - 11s - loss: 3.3076 - accuracy20: 0.3462 - val_loss: 3.2923 - val_accuracy20: 0.3618 - 11s/epoch - 45ms/step
Epoch 4/50
237/237 - 11s - loss: 3.2953 - accuracy20: 0.3571 - val_loss: 3.2881 - val_accuracy20: 0.3684 - 11s/epoch - 44ms/step
Epoch 5/50
237/237 - 10s - loss: 3.2860 - accuracy20: 0.3651 - val_loss: 3.2925 - val_accuracy20: 0.3627 - 10s/epoch - 44ms/step
Epoch 6/50
237/237 - 11s - loss: 3.2812 - accuracy20: 0.3689 - val_loss: 3.2863 - val_accuracy20: 0.3671 - 11s/epoch - 45ms/step
Epoch 7/50
237/237 - 10s - loss: 3.2725 - accuracy20: 0.3780 - val_loss: 3.2879 - val_accuracy20: 0.3719 - 10s/epoch - 44ms/step
Epoch 8/50
237/237 - 10s - loss: 3.2682 - accuracy20: 0.3834 - val_loss: 3.2793 - val_accuracy20: 0.3713 - 10s/epoch - 44ms/step
Epoch 9/50
237/237 - 11s - loss: 3.2604 - accuracy20: 0.3903 - val_loss: 3.2826 - val_accuracy20: 0.3727 - 11s/epoch - 44ms/step
Epoch 10/50
237/237 - 10s - loss: 3.2538 - accuracy20: 0.3943 - val_loss: 3.2833 - val_accuracy20: 0.3773 - 10s/epoch - 43ms/step
Epoch 11/50
237/237 - 11s - loss: 3.2488 - accuracy20: 0.3970 - val_loss: 3.2858 - val_accuracy20: 0.3694 - 11s/epoch - 44ms/step
Epoch 12/50
237/237 - 10s - loss: 3.2423 - accuracy20: 0.4044 - val_loss: 3.2915 - val_accuracy20: 0.3653 - 10s/epoch - 44ms/step
Epoch 13/50
237/237 - 10s - loss: 3.2339 - accuracy20: 0.4063 - val_loss: 3.2799 - val_accuracy20: 0.3769 - 10s/epoch - 43ms/step
Epoch 14/50
237/237 - 10s - loss: 3.2255 - accuracy20: 0.4113 - val_loss: 3.2835 - val_accuracy20: 0.3730 - 10s/epoch - 43ms/step
Epoch 15/50
237/237 - 10s - loss: 3.2177 - accuracy20: 0.4190 - val_loss: 3.2855 - val_accuracy20: 0.3752 - 10s/epoch - 44ms/step
Epoch 16/50
237/237 - 11s - loss: 3.2074 - accuracy20: 0.4254 - val_loss: 3.2861 - val_accuracy20: 0.3753 - 11s/epoch - 45ms/step
Epoch 17/50
237/237 - 10s - loss: 3.2006 - accuracy20: 0.4259 - val_loss: 3.2799 - val_accuracy20: 0.3792 - 10s/epoch - 44ms/step
Epoch 18/50
237/237 - 10s - loss: 3.1899 - accuracy20: 0.4315 - val_loss: 3.2752 - val_accuracy20: 0.3835 - 10s/epoch - 44ms/step
Epoch 19/50
237/237 - 11s - loss: 3.1831 - accuracy20: 0.4343 - val_loss: 3.2723 - val_accuracy20: 0.3858 - 11s/epoch - 46ms/step
Epoch 20/50
237/237 - 11s - loss: 3.1722 - accuracy20: 0.4421 - val_loss: 3.2835 - val_accuracy20: 0.3791 - 11s/epoch - 45ms/step
Epoch 21/50
237/237 - 11s - loss: 3.1651 - accuracy20: 0.4431 - val_loss: 3.2865 - val_accuracy20: 0.3811 - 11s/epoch - 45ms/step
Epoch 22/50
237/237 - 11s - loss: 3.1532 - accuracy20: 0.4483 - val_loss: 3.2945 - val_accuracy20: 0.3764 - 11s/epoch - 45ms/step
Epoch 23/50
237/237 - 11s - loss: 3.1457 - accuracy20: 0.4496 - val_loss: 3.2875 - val_accuracy20: 0.3763 - 11s/epoch - 45ms/step
Epoch 24/50
237/237 - 11s - loss: 3.1340 - accuracy20: 0.4541 - val_loss: 3.2863 - val_accuracy20: 0.3866 - 11s/epoch - 46ms/step
Epoch 25/50
237/237 - 11s - loss: 3.1225 - accuracy20: 0.4582 - val_loss: 3.2898 - val_accuracy20: 0.3850 - 11s/epoch - 46ms/step
Epoch 26/50
237/237 - 11s - loss: 3.1134 - accuracy20: 0.4617 - val_loss: 3.3101 - val_accuracy20: 0.3828 - 11s/epoch - 45ms/step
Epoch 27/50
237/237 - 11s - loss: 3.1098 - accuracy20: 0.4646 - val_loss: 3.2919 - val_accuracy20: 0.3887 - 11s/epoch - 45ms/step
Epoch 28/50
237/237 - 11s - loss: 3.0976 - accuracy20: 0.4662 - val_loss: 3.2910 - val_accuracy20: 0.3885 - 11s/epoch - 45ms/step
Epoch 29/50
237/237 - 11s - loss: 3.0932 - accuracy20: 0.4687 - val_loss: 3.2948 - val_accuracy20: 0.3871 - 11s/epoch - 46ms/step
testing model: results/LILAK/W2/deepVOL_L3/h20
Evaluating performance on  test set...
987/987 - 21s - 21s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0975512
{'0': {'precision': 0.3521748528482591, 'recall': 0.528574280651843, 'f1-score': 0.4227096284913135, 'support': 80142}, '1': {'precision': 0.3881736730168786, 'recall': 0.3782714143975306, 'f1-score': 0.3831585764854332, 'support': 90710}, '2': {'precision': 0.40463311651260986, 'recall': 0.2171527258919932, 'f1-score': 0.28262844936153936, 'support': 81643}, 'accuracy': 0.3738806709043743, 'macro avg': {'precision': 0.38166054745924916, 'recall': 0.3746661403137889, 'f1-score': 0.36283221811276206, 'support': 252495}, 'weighted avg': {'precision': 0.3820697141241025, 'recall': 0.3738806709043743, 'f1-score': 0.36320617838281416, 'support': 252495}}
[[42361 25281 12500]
 [42811 34313 13586]
 [35112 28802 17729]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0734876
{'0': {'precision': 0.40232414485367923, 'recall': 0.5216760112134562, 'f1-score': 0.454291817428833, 'support': 19976}, '1': {'precision': 0.4080033580523296, 'recall': 0.4377721062903468, 'f1-score': 0.42236384704519114, 'support': 19983}, '2': {'precision': 0.45498635950287963, 'recall': 0.29173955296404275, 'f1-score': 0.3555187115111322, 'support': 20580}, 'accuracy': 0.41581459885363153, 'macro avg': {'precision': 0.4217712874696295, 'recall': 0.4170625568226152, 'f1-score': 0.41072479199505213, 'support': 60539}, 'weighted avg': {'precision': 0.4221010836010846, 'recall': 0.41581459885363153, 'f1-score': 0.4101753445442033, 'support': 60539}}
[[10421  5954  3601]
 [ 7644  8748  3591]
 [ 7837  6739  6004]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0911883
{'0': {'precision': 0.35170664206642066, 'recall': 0.4558361978777462, 'f1-score': 0.3970578663021545, 'support': 6691}, '1': {'precision': 0.40891853014253954, 'recall': 0.3939279415469892, 'f1-score': 0.40128328521013795, 'support': 7938}, '2': {'precision': 0.39651581139935616, 'recall': 0.3003873188925549, 'f1-score': 0.3418217433888344, 'support': 6971}, 'accuracy': 0.3829166666666667, 'macro avg': {'precision': 0.3857136612027721, 'recall': 0.3833838194390968, 'f1-score': 0.3800542983003756, 'support': 21600}, 'weighted avg': {'precision': 0.3871933405371672, 'recall': 0.3829166666666667, 'f1-score': 0.38078427197172937, 'support': 21600}}
[[3050 2238 1403]
 [3027 3127 1784]
 [2595 2282 2094]]
training model: results/LILAK/W2/deepVOL_L3/h30
Epoch 1/50
237/237 - 14s - loss: 3.3617 - accuracy30: 0.3381 - val_loss: 3.3270 - val_accuracy30: 0.3421 - 14s/epoch - 60ms/step
Epoch 2/50
237/237 - 12s - loss: 3.3195 - accuracy30: 0.3431 - val_loss: 3.3070 - val_accuracy30: 0.3541 - 12s/epoch - 49ms/step
Epoch 3/50
237/237 - 11s - loss: 3.3129 - accuracy30: 0.3410 - val_loss: 3.2992 - val_accuracy30: 0.3464 - 11s/epoch - 48ms/step
Epoch 4/50
237/237 - 11s - loss: 3.3001 - accuracy30: 0.3474 - val_loss: 3.2958 - val_accuracy30: 0.3545 - 11s/epoch - 48ms/step
Epoch 5/50
237/237 - 11s - loss: 3.2973 - accuracy30: 0.3502 - val_loss: 3.2973 - val_accuracy30: 0.3555 - 11s/epoch - 47ms/step
Epoch 6/50
237/237 - 11s - loss: 3.2920 - accuracy30: 0.3554 - val_loss: 3.2947 - val_accuracy30: 0.3588 - 11s/epoch - 47ms/step
Epoch 7/50
237/237 - 11s - loss: 3.2869 - accuracy30: 0.3593 - val_loss: 3.2949 - val_accuracy30: 0.3625 - 11s/epoch - 48ms/step
Epoch 8/50
237/237 - 12s - loss: 3.2798 - accuracy30: 0.3699 - val_loss: 3.2944 - val_accuracy30: 0.3622 - 12s/epoch - 49ms/step
Epoch 9/50
237/237 - 11s - loss: 3.2761 - accuracy30: 0.3715 - val_loss: 3.2904 - val_accuracy30: 0.3616 - 11s/epoch - 48ms/step
Epoch 10/50
237/237 - 11s - loss: 3.2680 - accuracy30: 0.3799 - val_loss: 3.2904 - val_accuracy30: 0.3569 - 11s/epoch - 45ms/step
Epoch 11/50
237/237 - 11s - loss: 3.2613 - accuracy30: 0.3861 - val_loss: 3.2909 - val_accuracy30: 0.3656 - 11s/epoch - 46ms/step
Epoch 12/50
237/237 - 11s - loss: 3.2569 - accuracy30: 0.3898 - val_loss: 3.2941 - val_accuracy30: 0.3667 - 11s/epoch - 47ms/step
Epoch 13/50
237/237 - 11s - loss: 3.2504 - accuracy30: 0.3946 - val_loss: 3.3037 - val_accuracy30: 0.3571 - 11s/epoch - 47ms/step
Epoch 14/50
237/237 - 11s - loss: 3.2447 - accuracy30: 0.3986 - val_loss: 3.2984 - val_accuracy30: 0.3655 - 11s/epoch - 47ms/step
Epoch 15/50
237/237 - 11s - loss: 3.2328 - accuracy30: 0.4067 - val_loss: 3.3040 - val_accuracy30: 0.3643 - 11s/epoch - 47ms/step
Epoch 16/50
237/237 - 11s - loss: 3.2237 - accuracy30: 0.4138 - val_loss: 3.3075 - val_accuracy30: 0.3637 - 11s/epoch - 46ms/step
Epoch 17/50
237/237 - 11s - loss: 3.2187 - accuracy30: 0.4158 - val_loss: 3.3194 - val_accuracy30: 0.3576 - 11s/epoch - 47ms/step
Epoch 18/50
237/237 - 11s - loss: 3.2087 - accuracy30: 0.4209 - val_loss: 3.3134 - val_accuracy30: 0.3609 - 11s/epoch - 47ms/step
Epoch 19/50
237/237 - 11s - loss: 3.1990 - accuracy30: 0.4269 - val_loss: 3.3407 - val_accuracy30: 0.3559 - 11s/epoch - 47ms/step
testing model: results/LILAK/W2/deepVOL_L3/h30
Evaluating performance on  test set...
987/987 - 21s - 21s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0997901
{'0': {'precision': 0.31634921781566294, 'recall': 0.4995183899013967, 'f1-score': 0.3873722903940753, 'support': 78902}, '1': {'precision': 0.3669153097425634, 'recall': 0.3619152300945502, 'f1-score': 0.36439811860894505, 'support': 89159}, '2': {'precision': 0.4020868781903713, 'recall': 0.19031432835113818, 'f1-score': 0.2583482049550636, 'support': 84434}, 'accuracy': 0.3475316342897879, 'macro avg': {'precision': 0.3617838019161992, 'recall': 0.35058264944902834, 'f1-score': 0.3367062046526947, 'support': 252495}, 'weighted avg': {'precision': 0.36287527102934497, 'recall': 0.3475316342897879, 'f1-score': 0.3361143493966379, 'support': 252495}}
[[39413 26583 12906]
 [45902 32268 10989]
 [39272 29093 16069]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0908796
{'0': {'precision': 0.3618102421595871, 'recall': 0.45801296547565207, 'f1-score': 0.40426711614806277, 'support': 19899}, '1': {'precision': 0.3736784382540031, 'recall': 0.4261770150597889, 'f1-score': 0.39820485250806414, 'support': 19987}, '2': {'precision': 0.4130954277521109, 'recall': 0.251101534885973, 'f1-score': 0.31234378293733245, 'support': 20653}, 'accuracy': 0.37691405540230266, 'macro avg': {'precision': 0.382861369388567, 'recall': 0.37843050514047133, 'f1-score': 0.3716052505311531, 'support': 60539}, 'weighted avg': {'precision': 0.3832245795847426, 'recall': 0.37691405540230266, 'f1-score': 0.37090582732310917, 'support': 60539}}
[[9114 6943 3842]
 [7943 8518 3526]
 [8133 7334 5186]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0964261
{'0': {'precision': 0.33470830878020036, 'recall': 0.4203048690247151, 'f1-score': 0.3726545072825089, 'support': 6757}, '1': {'precision': 0.39597657244716067, 'recall': 0.3972410269510793, 'f1-score': 0.39660779187655426, 'support': 7829}, '2': {'precision': 0.35088386238357727, 'recall': 0.2631879098944967, 'f1-score': 0.3007739307535642, 'support': 7014}, 'accuracy': 0.36092592592592593, 'macro avg': {'precision': 0.36052291453697943, 'recall': 0.3602446019567637, 'f1-score': 0.3566787433042091, 'support': 21600}, 'weighted avg': {'precision': 0.3621677795775484, 'recall': 0.36092592592592593, 'f1-score': 0.35799524345439604, 'support': 21600}}
[[2840 2329 1588]
 [2892 3110 1827]
 [2753 2415 1846]]
training model: results/LILAK/W2/deepVOL_L3/h50
Epoch 1/50
237/237 - 13s - loss: 3.3613 - accuracy50: 0.3381 - val_loss: 3.3420 - val_accuracy50: 0.3319 - 13s/epoch - 54ms/step
Epoch 2/50
237/237 - 10s - loss: 3.3323 - accuracy50: 0.3398 - val_loss: 3.3258 - val_accuracy50: 0.3350 - 10s/epoch - 44ms/step
Epoch 3/50
237/237 - 10s - loss: 3.3124 - accuracy50: 0.3477 - val_loss: 3.3060 - val_accuracy50: 0.3416 - 10s/epoch - 44ms/step
Epoch 4/50
237/237 - 10s - loss: 3.3035 - accuracy50: 0.3512 - val_loss: 3.3055 - val_accuracy50: 0.3363 - 10s/epoch - 43ms/step
Epoch 5/50
237/237 - 10s - loss: 3.2983 - accuracy50: 0.3551 - val_loss: 3.3032 - val_accuracy50: 0.3497 - 10s/epoch - 44ms/step
Epoch 6/50
237/237 - 11s - loss: 3.2924 - accuracy50: 0.3574 - val_loss: 3.3035 - val_accuracy50: 0.3376 - 11s/epoch - 44ms/step
Epoch 7/50
237/237 - 11s - loss: 3.2836 - accuracy50: 0.3664 - val_loss: 3.3016 - val_accuracy50: 0.3461 - 11s/epoch - 45ms/step
Epoch 8/50
237/237 - 10s - loss: 3.2759 - accuracy50: 0.3731 - val_loss: 3.3017 - val_accuracy50: 0.3416 - 10s/epoch - 43ms/step
Epoch 9/50
237/237 - 10s - loss: 3.2674 - accuracy50: 0.3826 - val_loss: 3.3003 - val_accuracy50: 0.3442 - 10s/epoch - 43ms/step
Epoch 10/50
237/237 - 10s - loss: 3.2632 - accuracy50: 0.3870 - val_loss: 3.3049 - val_accuracy50: 0.3470 - 10s/epoch - 44ms/step
Epoch 11/50
237/237 - 11s - loss: 3.2584 - accuracy50: 0.3889 - val_loss: 3.3126 - val_accuracy50: 0.3431 - 11s/epoch - 44ms/step
Epoch 12/50
237/237 - 10s - loss: 3.2540 - accuracy50: 0.3920 - val_loss: 3.3125 - val_accuracy50: 0.3442 - 10s/epoch - 44ms/step
Epoch 13/50
237/237 - 10s - loss: 3.2423 - accuracy50: 0.4021 - val_loss: 3.3171 - val_accuracy50: 0.3413 - 10s/epoch - 44ms/step
Epoch 14/50
237/237 - 10s - loss: 3.2371 - accuracy50: 0.4059 - val_loss: 3.3268 - val_accuracy50: 0.3472 - 10s/epoch - 44ms/step
Epoch 15/50
237/237 - 10s - loss: 3.2317 - accuracy50: 0.4108 - val_loss: 3.3247 - val_accuracy50: 0.3438 - 10s/epoch - 44ms/step
Epoch 16/50
237/237 - 11s - loss: 3.2233 - accuracy50: 0.4129 - val_loss: 3.3302 - val_accuracy50: 0.3398 - 11s/epoch - 44ms/step
Epoch 17/50
237/237 - 10s - loss: 3.2121 - accuracy50: 0.4185 - val_loss: 3.3377 - val_accuracy50: 0.3441 - 10s/epoch - 43ms/step
Epoch 18/50
237/237 - 10s - loss: 3.2025 - accuracy50: 0.4224 - val_loss: 3.3402 - val_accuracy50: 0.3426 - 10s/epoch - 43ms/step
Epoch 19/50
237/237 - 10s - loss: 3.2008 - accuracy50: 0.4252 - val_loss: 3.3390 - val_accuracy50: 0.3490 - 10s/epoch - 44ms/step
testing model: results/LILAK/W2/deepVOL_L3/h50
Evaluating performance on  test set...
987/987 - 21s - 21s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1051954
{'0': {'precision': 0.3079213400494602, 'recall': 0.5606393020230108, 'f1-score': 0.3975146853336589, 'support': 78398}, '1': {'precision': 0.35742809774381895, 'recall': 0.2804320778192512, 'f1-score': 0.31428299794010456, 'support': 88410}, '2': {'precision': 0.3807224739409245, 'recall': 0.1794554599880962, 'f1-score': 0.24393223135251754, 'support': 85687}, 'accuracy': 0.33316699340581, 'macro avg': {'precision': 0.34869063724473454, 'recall': 0.3401756132767861, 'f1-score': 0.3185766382087603, 'support': 252495}, 'weighted avg': {'precision': 0.3499617891970321, 'recall': 0.33316699340581, 'f1-score': 0.31625155847274605, 'support': 252495}}
[[43953 21278 13167]
 [51772 24793 11845]
 [47016 23294 15377]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0926409
{'0': {'precision': 0.35368907098494456, 'recall': 0.5531427990235964, 'f1-score': 0.43148144475077854, 'support': 19664}, '1': {'precision': 0.37691230036424767, 'recall': 0.3353275501046964, 'f1-score': 0.3549059441205182, 'support': 20058}, '2': {'precision': 0.40725232392596933, 'recall': 0.23360714800403518, 'f1-score': 0.2969045729287502, 'support': 20817}, 'accuracy': 0.37109962173144584, 'macro avg': {'precision': 0.37928456509172054, 'recall': 0.37402583237744264, 'f1-score': 0.36109732060001565, 'support': 60539}, 'weighted avg': {'precision': 0.3798017879337441, 'recall': 0.37109962173144584, 'f1-score': 0.35983443815402394, 'support': 60539}}
[[10877  5198  3589]
 [ 9843  6726  3489]
 [10033  5921  4863]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1024026
{'0': {'precision': 0.3297833935018051, 'recall': 0.5253018976423232, 'f1-score': 0.405189620758483, 'support': 6956}, '1': {'precision': 0.3607224210868858, 'recall': 0.3026621160409556, 'f1-score': 0.3291515106525128, 'support': 7325}, '2': {'precision': 0.37745770461819844, 'recall': 0.2255772646536412, 'f1-score': 0.2823911742067904, 'support': 7319}, 'accuracy': 0.34824074074074074, 'macro avg': {'precision': 0.35598783973562975, 'recall': 0.35118042611230665, 'f1-score': 0.33891076853926205, 'support': 21600}, 'weighted avg': {'precision': 0.3564295351741013, 'recall': 0.34824074074074074, 'f1-score': 0.33779420470116495, 'support': 21600}}
[[3654 1973 1329]
 [3714 2217 1394]
 [3712 1956 1651]]
training model: results/LILAK/W2/deepVOL_L3/h100
Epoch 1/50
237/237 - 13s - loss: 3.3552 - accuracy100: 0.3483 - val_loss: 3.3374 - val_accuracy100: 0.3438 - 13s/epoch - 54ms/step
Epoch 2/50
237/237 - 11s - loss: 3.3260 - accuracy100: 0.3513 - val_loss: 3.3358 - val_accuracy100: 0.3275 - 11s/epoch - 46ms/step
Epoch 3/50
237/237 - 10s - loss: 3.3139 - accuracy100: 0.3505 - val_loss: 3.3164 - val_accuracy100: 0.3446 - 10s/epoch - 43ms/step
Epoch 4/50
237/237 - 10s - loss: 3.3059 - accuracy100: 0.3475 - val_loss: 3.3081 - val_accuracy100: 0.3490 - 10s/epoch - 43ms/step
Epoch 5/50
237/237 - 10s - loss: 3.3050 - accuracy100: 0.3472 - val_loss: 3.3060 - val_accuracy100: 0.3462 - 10s/epoch - 43ms/step
Epoch 6/50
237/237 - 10s - loss: 3.2995 - accuracy100: 0.3481 - val_loss: 3.3329 - val_accuracy100: 0.3327 - 10s/epoch - 44ms/step
Epoch 7/50
237/237 - 11s - loss: 3.2933 - accuracy100: 0.3547 - val_loss: 3.3244 - val_accuracy100: 0.3415 - 11s/epoch - 45ms/step
Epoch 8/50
237/237 - 11s - loss: 3.2853 - accuracy100: 0.3619 - val_loss: 3.3207 - val_accuracy100: 0.3462 - 11s/epoch - 44ms/step
Epoch 9/50
237/237 - 11s - loss: 3.2801 - accuracy100: 0.3669 - val_loss: 3.3124 - val_accuracy100: 0.3546 - 11s/epoch - 46ms/step
Epoch 10/50
237/237 - 11s - loss: 3.2743 - accuracy100: 0.3756 - val_loss: 3.3233 - val_accuracy100: 0.3494 - 11s/epoch - 45ms/step
Epoch 11/50
237/237 - 11s - loss: 3.2713 - accuracy100: 0.3792 - val_loss: 3.3266 - val_accuracy100: 0.3483 - 11s/epoch - 45ms/step
Epoch 12/50
237/237 - 10s - loss: 3.2613 - accuracy100: 0.3891 - val_loss: 3.3161 - val_accuracy100: 0.3501 - 10s/epoch - 44ms/step
Epoch 13/50
237/237 - 10s - loss: 3.2540 - accuracy100: 0.3930 - val_loss: 3.3138 - val_accuracy100: 0.3502 - 10s/epoch - 44ms/step
Epoch 14/50
237/237 - 10s - loss: 3.2463 - accuracy100: 0.3982 - val_loss: 3.3198 - val_accuracy100: 0.3506 - 10s/epoch - 42ms/step
Epoch 15/50
237/237 - 10s - loss: 3.2482 - accuracy100: 0.3984 - val_loss: 3.3085 - val_accuracy100: 0.3572 - 10s/epoch - 43ms/step
testing model: results/LILAK/W2/deepVOL_L3/h100
Evaluating performance on  test set...
987/987 - 21s - 21s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1023805
{'0': {'precision': 0.26241157250261715, 'recall': 0.22406110757479314, 'f1-score': 0.24172468458464527, 'support': 73837}, '1': {'precision': 0.3641613783286875, 'recall': 0.5047576965761026, 'f1-score': 0.4230848736455875, 'support': 97316}, '2': {'precision': 0.3354777221825113, 'recall': 0.225025202232549, 'f1-score': 0.26936859377644345, 'support': 81342}, 'accuracy': 0.3325570803382245, 'macro avg': {'precision': 0.32068355767127205, 'recall': 0.3179480021278149, 'f1-score': 0.3113927173355588, 'support': 252495}, 'weighted avg': {'precision': 0.3251662046776377, 'recall': 0.3325570803382245, 'f1-score': 0.3205296471388896, 'support': 252495}}
[[16544 40826 16467]
 [28405 49121 19790]
 [18097 44941 18304]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0994924
{'0': {'precision': 0.3458339750500539, 'recall': 0.22838689991863304, 'f1-score': 0.27509954058192954, 'support': 19664}, '1': {'precision': 0.34520128397679417, 'recall': 0.5845217911638576, 'f1-score': 0.43405972857380903, 'support': 20054}, '2': {'precision': 0.3648867313915858, 'recall': 0.2382690552807262, 'f1-score': 0.28828776476741147, 'support': 20821}, 'accuracy': 0.34975800723500555, 'macro avg': {'precision': 0.3519739968061446, 'recall': 0.35039258212107227, 'f1-score': 0.33248234464105003, 'support': 60539}, 'weighted avg': {'precision': 0.35217714974742065, 'recall': 0.34975800723500555, 'f1-score': 0.33229208796056264, 'support': 60539}}
[[ 4491 10723  4450]
 [ 4147 11722  4185]
 [ 4348 11512  4961]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1014625
{'0': {'precision': 0.31857265692175407, 'recall': 0.2153443766346992, 'f1-score': 0.25697936535460375, 'support': 6882}, '1': {'precision': 0.3576819640843238, 'recall': 0.5495135279221645, 'f1-score': 0.4333158171308461, 'support': 7503}, '2': {'precision': 0.35473159933591586, 'recall': 0.26652806652806654, 'f1-score': 0.3043684710351377, 'support': 7215}, 'accuracy': 0.3485185185185185, 'macro avg': {'precision': 0.34366207344733124, 'recall': 0.34379532369497673, 'f1-score': 0.33155455117352917, 'support': 21600}, 'weighted avg': {'precision': 0.34423580049392716, 'recall': 0.3485185185185185, 'f1-score': 0.3340610688343352, 'support': 21600}}
[[1482 3603 1797]
 [1679 4123 1701]
 [1491 3801 1923]]
training model: results/LILAK/W2/deepVOL_L3/h200
Epoch 1/50
237/237 - 14s - loss: 3.3546 - accuracy200: 0.3490 - val_loss: 3.3234 - val_accuracy200: 0.3408 - 14s/epoch - 58ms/step
Epoch 2/50
237/237 - 10s - loss: 3.3262 - accuracy200: 0.3558 - val_loss: 3.3509 - val_accuracy200: 0.3309 - 10s/epoch - 42ms/step
Epoch 3/50
237/237 - 10s - loss: 3.3139 - accuracy200: 0.3523 - val_loss: 3.3123 - val_accuracy200: 0.3365 - 10s/epoch - 43ms/step
Epoch 4/50
237/237 - 10s - loss: 3.3044 - accuracy200: 0.3498 - val_loss: 3.3072 - val_accuracy200: 0.3380 - 10s/epoch - 43ms/step
Epoch 5/50
237/237 - 11s - loss: 3.2997 - accuracy200: 0.3501 - val_loss: 3.3040 - val_accuracy200: 0.3387 - 11s/epoch - 45ms/step
Epoch 6/50
237/237 - 11s - loss: 3.2976 - accuracy200: 0.3495 - val_loss: 3.3040 - val_accuracy200: 0.3355 - 11s/epoch - 45ms/step
Epoch 7/50
237/237 - 11s - loss: 3.2915 - accuracy200: 0.3577 - val_loss: 3.3096 - val_accuracy200: 0.3433 - 11s/epoch - 45ms/step
Epoch 8/50
237/237 - 10s - loss: 3.2905 - accuracy200: 0.3576 - val_loss: 3.3186 - val_accuracy200: 0.3422 - 10s/epoch - 44ms/step
Epoch 9/50
237/237 - 10s - loss: 3.2874 - accuracy200: 0.3587 - val_loss: 3.3183 - val_accuracy200: 0.3368 - 10s/epoch - 44ms/step
Epoch 10/50
237/237 - 10s - loss: 3.2798 - accuracy200: 0.3706 - val_loss: 3.3294 - val_accuracy200: 0.3294 - 10s/epoch - 43ms/step
Epoch 11/50
237/237 - 10s - loss: 3.2793 - accuracy200: 0.3697 - val_loss: 3.3254 - val_accuracy200: 0.3373 - 10s/epoch - 44ms/step
Epoch 12/50
237/237 - 10s - loss: 3.2757 - accuracy200: 0.3733 - val_loss: 3.3302 - val_accuracy200: 0.3419 - 10s/epoch - 44ms/step
Epoch 13/50
237/237 - 10s - loss: 3.2724 - accuracy200: 0.3800 - val_loss: 3.3421 - val_accuracy200: 0.3411 - 10s/epoch - 43ms/step
Epoch 14/50
237/237 - 10s - loss: 3.2670 - accuracy200: 0.3829 - val_loss: 3.3564 - val_accuracy200: 0.3382 - 10s/epoch - 43ms/step
Epoch 15/50
237/237 - 10s - loss: 3.2547 - accuracy200: 0.3896 - val_loss: 3.3681 - val_accuracy200: 0.3389 - 10s/epoch - 43ms/step
Epoch 16/50
237/237 - 10s - loss: 3.2501 - accuracy200: 0.3952 - val_loss: 3.3549 - val_accuracy200: 0.3462 - 10s/epoch - 43ms/step
testing model: results/LILAK/W2/deepVOL_L3/h200
Evaluating performance on  test set...
987/987 - 21s - 21s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.102978
{'0': {'precision': 0.3175050776149717, 'recall': 0.43310534192526995, 'f1-score': 0.3664035073951417, 'support': 80851}, '1': {'precision': 0.3009371075258429, 'recall': 0.11109526017333, 'f1-score': 0.16228184423026829, 'support': 84117}, '2': {'precision': 0.3357683934001475, 'recall': 0.4264055662824043, 'f1-score': 0.37569772650630906, 'support': 87527}, 'accuracy': 0.3235073961860631, 'macro avg': {'precision': 0.3180701928469874, 'recall': 0.3235353894603348, 'f1-score': 0.30146102604390634, 'support': 252495}, 'weighted avg': {'precision': 0.318316520616781, 'recall': 0.3235073961860631, 'f1-score': 0.3016235837360732, 'support': 252495}}
[[35017 10319 35515]
 [36455  9345 38317]
 [38816 11389 37322]]
Evaluating performance on  train set...
237/237 - 6s - 6s/epoch - 25ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0977793
{'0': {'precision': 0.3346643280964287, 'recall': 0.45026861475121754, 'f1-score': 0.3839534186753436, 'support': 19917}, '1': {'precision': 0.3614457831325301, 'recall': 0.15286817012259724, 'f1-score': 0.21486313998014467, 'support': 19821}, '2': {'precision': 0.36279033084900825, 'recall': 0.44228642853708955, 'f1-score': 0.3986135181975736, 'support': 20801}, 'accuracy': 0.35015444589438216, 'macro avg': {'precision': 0.352966814025989, 'recall': 0.3484744044703014, 'f1-score': 0.332476692284354, 'support': 60539}, 'weighted avg': {'precision': 0.3530968129991687, 'recall': 0.35015444589438216, 'f1-score': 0.33362893885480427, 'support': 60539}}
[[8968 2669 8280]
 [8912 3030 7879]
 [8917 2684 9200]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 26ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.10084
{'0': {'precision': 0.34989082969432317, 'recall': 0.4299704856452911, 'f1-score': 0.38581918863609005, 'support': 7454}, '1': {'precision': 0.31430900937627393, 'recall': 0.1133656815174239, 'f1-score': 0.16663064620704562, 'support': 6801}, '2': {'precision': 0.34084309602483226, 'recall': 0.46344452008168824, 'f1-score': 0.39279944611123935, 'support': 7345}, 'accuracy': 0.3416666666666667, 'macro avg': {'precision': 0.33501431169847645, 'recall': 0.33559356241480104, 'f1-score': 0.31508309365145837, 'support': 21600}, 'weighted avg': {'precision': 0.3356108498894406, 'recall': 0.3416666666666667, 'f1-score': 0.3191788513256753, 'support': 21600}}
[[3205  825 3424]
 [2871  771 3159]
 [3084  857 3404]]
training model: results/LILAK/W2/deepVOL_L3/h300
Epoch 1/50
237/237 - 13s - loss: 3.3638 - accuracy300: 0.3442 - val_loss: 3.3368 - val_accuracy300: 0.3357 - 13s/epoch - 57ms/step
Epoch 2/50
237/237 - 11s - loss: 3.3257 - accuracy300: 0.3428 - val_loss: 3.3116 - val_accuracy300: 0.3331 - 11s/epoch - 47ms/step
Epoch 3/50
237/237 - 10s - loss: 3.3116 - accuracy300: 0.3396 - val_loss: 3.3048 - val_accuracy300: 0.3348 - 10s/epoch - 44ms/step
Epoch 4/50
237/237 - 10s - loss: 3.3025 - accuracy300: 0.3469 - val_loss: 3.3036 - val_accuracy300: 0.3333 - 10s/epoch - 44ms/step
Epoch 5/50
237/237 - 10s - loss: 3.2974 - accuracy300: 0.3452 - val_loss: 3.3002 - val_accuracy300: 0.3362 - 10s/epoch - 44ms/step
Epoch 6/50
237/237 - 10s - loss: 3.2907 - accuracy300: 0.3604 - val_loss: 3.3043 - val_accuracy300: 0.3388 - 10s/epoch - 44ms/step
Epoch 7/50
237/237 - 10s - loss: 3.2837 - accuracy300: 0.3648 - val_loss: 3.3101 - val_accuracy300: 0.3343 - 10s/epoch - 44ms/step
Epoch 8/50
237/237 - 11s - loss: 3.2797 - accuracy300: 0.3721 - val_loss: 3.3142 - val_accuracy300: 0.3411 - 11s/epoch - 44ms/step
Epoch 9/50
237/237 - 11s - loss: 3.2759 - accuracy300: 0.3718 - val_loss: 3.3187 - val_accuracy300: 0.3423 - 11s/epoch - 45ms/step
Epoch 10/50
237/237 - 10s - loss: 3.2694 - accuracy300: 0.3798 - val_loss: 3.3236 - val_accuracy300: 0.3389 - 10s/epoch - 43ms/step
Epoch 11/50
237/237 - 10s - loss: 3.2612 - accuracy300: 0.3883 - val_loss: 3.3278 - val_accuracy300: 0.3410 - 10s/epoch - 44ms/step
Epoch 12/50
237/237 - 10s - loss: 3.2633 - accuracy300: 0.3837 - val_loss: 3.3270 - val_accuracy300: 0.3438 - 10s/epoch - 44ms/step
Epoch 13/50
237/237 - 11s - loss: 3.2541 - accuracy300: 0.3913 - val_loss: 3.3449 - val_accuracy300: 0.3445 - 11s/epoch - 46ms/step
Epoch 14/50
237/237 - 10s - loss: 3.2497 - accuracy300: 0.3936 - val_loss: 3.3633 - val_accuracy300: 0.3390 - 10s/epoch - 43ms/step
Epoch 15/50
237/237 - 10s - loss: 3.2395 - accuracy300: 0.3991 - val_loss: 3.3409 - val_accuracy300: 0.3426 - 10s/epoch - 44ms/step
testing model: results/LILAK/W2/deepVOL_L3/h300
Evaluating performance on  test set...
987/987 - 20s - 20s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1046052
{'0': {'precision': 0.29866384925804706, 'recall': 0.46916491963661777, 'f1-score': 0.3649839821376566, 'support': 80136}, '1': {'precision': 0.3323732165831365, 'recall': 0.19659041864479931, 'f1-score': 0.24705437365742955, 'support': 88046}, '2': {'precision': 0.34785467035178574, 'recall': 0.30750892507679717, 'f1-score': 0.3264399075840274, 'support': 84313}, 'accuracy': 0.3201370324164835, 'macro avg': {'precision': 0.3262972453976564, 'recall': 0.32442142111940475, 'f1-score': 0.31282608779303783, 'support': 252495}, 'weighted avg': {'precision': 0.32684421185683604, 'recall': 0.3201370324164835, 'f1-score': 0.31099084617025047, 'support': 252495}}
[[37597 17151 25388]
 [47518 17309 23219]
 [40769 17617 25927]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0970978
{'0': {'precision': 0.34563264103697156, 'recall': 0.4690889099905043, 'f1-score': 0.3980069967136648, 'support': 20009}, '1': {'precision': 0.35629350348027844, 'recall': 0.2443925001243348, 'f1-score': 0.2899200566388389, 'support': 20107}, '2': {'precision': 0.3660864682762493, 'recall': 0.35117269744895463, 'f1-score': 0.35847453391313044, 'support': 20423}, 'accuracy': 0.354680453922265, 'macro avg': {'precision': 0.35600420426449975, 'recall': 0.35488470252126464, 'f1-score': 0.34880052908854475, 'support': 60539}, 'weighted avg': {'precision': 0.3560736208162104, 'recall': 0.354680453922265, 'f1-score': 0.3487713702272703, 'support': 60539}}
[[9386 4351 6272]
 [9046 4914 6147]
 [8724 4527 7172]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0998304
{'0': {'precision': 0.3422507185496352, 'recall': 0.4276833816825528, 'f1-score': 0.3802272029474977, 'support': 7239}, '1': {'precision': 0.35363201391909527, 'recall': 0.22035506166147176, 'f1-score': 0.2715204141270769, 'support': 7379}, '2': {'precision': 0.32114127702363, 'recall': 0.36594099112002293, 'f1-score': 0.3420805998125586, 'support': 6982}, 'accuracy': 0.33689814814814817, 'macro avg': {'precision': 0.3390080031641201, 'recall': 0.3379931448213492, 'f1-score': 0.3312760722957111, 'support': 21600}, 'weighted avg': {'precision': 0.3393153693735555, 'recall': 0.33689814814814817, 'f1-score': 0.33076021323481114, 'support': 21600}}
[[3096 1530 2613]
 [2965 1626 2788]
 [2985 1442 2555]]
training model: results/LILAK/W2/deepVOL_L3/h500
Epoch 1/50
237/237 - 14s - loss: 3.3589 - accuracy500: 0.3448 - val_loss: 3.3353 - val_accuracy500: 0.3526 - 14s/epoch - 58ms/step
Epoch 2/50
237/237 - 11s - loss: 3.3124 - accuracy500: 0.3592 - val_loss: 3.3169 - val_accuracy500: 0.3650 - 11s/epoch - 44ms/step
Epoch 3/50
237/237 - 11s - loss: 3.3087 - accuracy500: 0.3594 - val_loss: 3.3329 - val_accuracy500: 0.3650 - 11s/epoch - 45ms/step
Epoch 4/50
237/237 - 10s - loss: 3.3020 - accuracy500: 0.3654 - val_loss: 3.3165 - val_accuracy500: 0.3699 - 10s/epoch - 44ms/step
Epoch 5/50
237/237 - 11s - loss: 3.2987 - accuracy500: 0.3640 - val_loss: 3.3072 - val_accuracy500: 0.3638 - 11s/epoch - 45ms/step
Epoch 6/50
237/237 - 11s - loss: 3.2906 - accuracy500: 0.3635 - val_loss: 3.3065 - val_accuracy500: 0.3495 - 11s/epoch - 45ms/step
Epoch 7/50
237/237 - 10s - loss: 3.2766 - accuracy500: 0.3750 - val_loss: 3.3092 - val_accuracy500: 0.3557 - 10s/epoch - 44ms/step
Epoch 8/50
237/237 - 10s - loss: 3.2647 - accuracy500: 0.3816 - val_loss: 3.3157 - val_accuracy500: 0.3478 - 10s/epoch - 43ms/step
Epoch 9/50
237/237 - 10s - loss: 3.2559 - accuracy500: 0.3898 - val_loss: 3.3281 - val_accuracy500: 0.3450 - 10s/epoch - 44ms/step
Epoch 10/50
237/237 - 10s - loss: 3.2584 - accuracy500: 0.3869 - val_loss: 3.3239 - val_accuracy500: 0.3524 - 10s/epoch - 44ms/step
Epoch 11/50
237/237 - 10s - loss: 3.2526 - accuracy500: 0.3920 - val_loss: 3.3268 - val_accuracy500: 0.3519 - 10s/epoch - 44ms/step
Epoch 12/50
237/237 - 10s - loss: 3.2477 - accuracy500: 0.3933 - val_loss: 3.3301 - val_accuracy500: 0.3569 - 10s/epoch - 43ms/step
Epoch 13/50
237/237 - 11s - loss: 3.2365 - accuracy500: 0.3997 - val_loss: 3.3337 - val_accuracy500: 0.3556 - 11s/epoch - 45ms/step
Epoch 14/50
237/237 - 10s - loss: 3.2295 - accuracy500: 0.4038 - val_loss: 3.3529 - val_accuracy500: 0.3379 - 10s/epoch - 44ms/step
Epoch 15/50
237/237 - 10s - loss: 3.2227 - accuracy500: 0.4072 - val_loss: 3.3545 - val_accuracy500: 0.3429 - 10s/epoch - 43ms/step
Epoch 16/50
237/237 - 10s - loss: 3.2111 - accuracy500: 0.4123 - val_loss: 3.3611 - val_accuracy500: 0.3473 - 10s/epoch - 43ms/step
testing model: results/LILAK/W2/deepVOL_L3/h500
Evaluating performance on  test set...
987/987 - 20s - 20s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0970677
{'0': {'precision': 0.3188117541383293, 'recall': 0.12889419210915412, 'f1-score': 0.18357130982507347, 'support': 77102}, '1': {'precision': 0.3897287111536506, 'recall': 0.6795910916392844, 'f1-score': 0.4953731513515569, 'support': 95865}, '2': {'precision': 0.32414417075962926, 'recall': 0.22073986520470779, 'f1-score': 0.2626303427434436, 'support': 79528}, 'accuracy': 0.36690627537178955, 'macro avg': {'precision': 0.34422821201720305, 'recall': 0.3430750496510488, 'f1-score': 0.313858267973358, 'support': 252495}, 'weighted avg': {'precision': 0.34741640180791694, 'recall': 0.36690627537178955, 'f1-score': 0.32685450477098715, 'support': 252495}}
[[ 9938 50444 16720]
 [10833 65149 19883]
 [10401 51572 17555]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0969332
{'0': {'precision': 0.38926258096661687, 'recall': 0.15527950310559005, 'f1-score': 0.22200120768656978, 'support': 20125}, '1': {'precision': 0.35223918254068376, 'recall': 0.6896364354870579, 'f1-score': 0.466307052555988, 'support': 20244}, '2': {'precision': 0.35911773842808326, 'recall': 0.22925136341100644, 'f1-score': 0.2798523270592507, 'support': 20170}, 'accuracy': 0.35861180396108294, 'macro avg': {'precision': 0.36687316731179465, 'recall': 0.35805576733455147, 'f1-score': 0.32272019576726946, 'support': 60539}, 'weighted avg': {'precision': 0.36683863686881524, 'recall': 0.35861180396108294, 'f1-score': 0.32297057621402275, 'support': 60539}}
[[ 3125 12501  4499]
 [ 2530 13961  3753]
 [ 2373 13173  4624]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018641
{'0': {'precision': 0.3543123543123543, 'recall': 0.12950866231184321, 'f1-score': 0.18968386023294506, 'support': 7042}, '1': {'precision': 0.36753002459846623, 'recall': 0.6264644222468861, 'f1-score': 0.46327116866535956, 'support': 8109}, '2': {'precision': 0.29650269023827824, 'recall': 0.23926190106993334, 'f1-score': 0.26482450871020335, 'support': 6449}, 'accuracy': 0.3488425925925926, 'macro avg': {'precision': 0.339448356383033, 'recall': 0.3317449952095542, 'f1-score': 0.3059265125361693, 'support': 21600}, 'weighted avg': {'precision': 0.3420145563834823, 'recall': 0.3488425925925926, 'f1-score': 0.3148274494046251, 'support': 21600}}
[[ 912 4572 1558]
 [ 926 5080 2103]
 [ 736 4170 1543]]
training model: results/LILAK/W2/deepVOL_L3/h1000
Epoch 1/50
237/237 - 13s - loss: 3.3491 - accuracy1000: 0.3566 - val_loss: 3.4216 - val_accuracy1000: 0.3432 - 13s/epoch - 54ms/step
Epoch 2/50
237/237 - 11s - loss: 3.3339 - accuracy1000: 0.3549 - val_loss: 3.4150 - val_accuracy1000: 0.3436 - 11s/epoch - 45ms/step
Epoch 3/50
237/237 - 11s - loss: 3.3046 - accuracy1000: 0.3564 - val_loss: 3.4000 - val_accuracy1000: 0.3401 - 11s/epoch - 45ms/step
Epoch 4/50
237/237 - 11s - loss: 3.3009 - accuracy1000: 0.3597 - val_loss: 3.3745 - val_accuracy1000: 0.3442 - 11s/epoch - 45ms/step
Epoch 5/50
237/237 - 10s - loss: 3.3031 - accuracy1000: 0.3612 - val_loss: 3.3316 - val_accuracy1000: 0.3452 - 10s/epoch - 44ms/step
Epoch 6/50
237/237 - 10s - loss: 3.2940 - accuracy1000: 0.3591 - val_loss: 3.3148 - val_accuracy1000: 0.3405 - 10s/epoch - 43ms/step
Epoch 7/50
237/237 - 11s - loss: 3.2888 - accuracy1000: 0.3600 - val_loss: 3.3064 - val_accuracy1000: 0.3375 - 11s/epoch - 45ms/step
Epoch 8/50
237/237 - 10s - loss: 3.2828 - accuracy1000: 0.3659 - val_loss: 3.3146 - val_accuracy1000: 0.3366 - 10s/epoch - 43ms/step
Epoch 9/50
237/237 - 11s - loss: 3.2824 - accuracy1000: 0.3688 - val_loss: 3.3138 - val_accuracy1000: 0.3342 - 11s/epoch - 44ms/step
Epoch 10/50
237/237 - 10s - loss: 3.2834 - accuracy1000: 0.3713 - val_loss: 3.3339 - val_accuracy1000: 0.3241 - 10s/epoch - 44ms/step
Epoch 11/50
237/237 - 10s - loss: 3.2741 - accuracy1000: 0.3802 - val_loss: 3.3247 - val_accuracy1000: 0.3228 - 10s/epoch - 43ms/step
Epoch 12/50
237/237 - 10s - loss: 3.2647 - accuracy1000: 0.3896 - val_loss: 3.3322 - val_accuracy1000: 0.3371 - 10s/epoch - 43ms/step
Epoch 13/50
237/237 - 10s - loss: 3.2630 - accuracy1000: 0.3891 - val_loss: 3.3432 - val_accuracy1000: 0.3302 - 10s/epoch - 44ms/step
Epoch 14/50
237/237 - 10s - loss: 3.2577 - accuracy1000: 0.3939 - val_loss: 3.3458 - val_accuracy1000: 0.3296 - 10s/epoch - 44ms/step
Epoch 15/50
237/237 - 11s - loss: 3.2616 - accuracy1000: 0.3928 - val_loss: 3.4658 - val_accuracy1000: 0.3249 - 11s/epoch - 46ms/step
Epoch 16/50
237/237 - 10s - loss: 3.2555 - accuracy1000: 0.3988 - val_loss: 3.4640 - val_accuracy1000: 0.3301 - 10s/epoch - 44ms/step
Epoch 17/50
237/237 - 10s - loss: 3.2518 - accuracy1000: 0.4027 - val_loss: 3.4395 - val_accuracy1000: 0.3341 - 10s/epoch - 44ms/step
testing model: results/LILAK/W2/deepVOL_L3/h1000
Evaluating performance on  test set...
987/987 - 20s - 20s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1008456
{'0': {'precision': 0.34068412479639143, 'recall': 0.06751170095221543, 'f1-score': 0.11269181751302962, 'support': 80549}, '1': {'precision': 0.3547388165345413, 'recall': 0.9088827683135549, 'f1-score': 0.5103046694773684, 'support': 88227}, '2': {'precision': 0.36118264186933713, 'recall': 0.04523465402118993, 'f1-score': 0.0803999830155832, 'support': 83719}, 'accuracy': 0.3541179033248183, 'macro avg': {'precision': 0.3522018610667566, 'recall': 0.34054304109565336, 'f1-score': 0.2344654900019937, 'support': 252495}, 'weighted avg': {'precision': 0.35239175718044535, 'recall': 0.3541179033248183, 'f1-score': 0.24091910517403678, 'support': 252495}}
[[ 5438 71626  3485]
 [ 4826 80188  3213]
 [ 5698 74234  3787]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003165
{'0': {'precision': 0.40801668211306763, 'recall': 0.08425434189751686, 'f1-score': 0.13966768449855255, 'support': 20901}, '1': {'precision': 0.3224388236174512, 'recall': 0.8891812412939174, 'f1-score': 0.4732614814306309, 'support': 19383}, '2': {'precision': 0.39985564778058463, 'recall': 0.054702542582078496, 'f1-score': 0.09623903413532528, 'support': 20255}, 'accuracy': 0.3320834503377988, 'macro avg': {'precision': 0.37677038450370115, 'recall': 0.3427127085911709, 'f1-score': 0.2363894000215029, 'support': 60539}, 'weighted avg': {'precision': 0.3778863961548427, 'recall': 0.3320834503377988, 'f1-score': 0.23194541047399492, 'support': 60539}}
[[ 1761 18251   889]
 [ 1374 17235   774]
 [ 1181 17966  1108]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1038882
{'0': {'precision': 0.3825701624815362, 'recall': 0.0682746803743245, 'f1-score': 0.1158707079744995, 'support': 7587}, '1': {'precision': 0.3388830347734457, 'recall': 0.866496025865553, 'f1-score': 0.4872173616634473, 'support': 7423}, '2': {'precision': 0.28672985781990523, 'recall': 0.0550834597875569, 'f1-score': 0.09241344195519348, 'support': 6590}, 'accuracy': 0.3385648148148148, 'macro avg': {'precision': 0.3360610183582957, 'recall': 0.3299513886758115, 'f1-score': 0.23183383719771344, 'support': 21600}, 'weighted avg': {'precision': 0.3383165904122166, 'recall': 0.3385648148148148, 'f1-score': 0.23633009812569547, 'support': 21600}}
[[ 518 6682  387]
 [ 475 6432  516]
 [ 361 5866  363]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        16 (peak)  12.63 (ave)

============================================
