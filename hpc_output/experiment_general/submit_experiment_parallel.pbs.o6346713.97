This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/WBA_orderbooks/WBA_orderbooks_2019-12-18.csv
data/WBA_orderbooks/WBA_orderbooks_2019-12-10.csv
data/WBA_orderbooks/WBA_orderbooks_2019-11-27.csv
data/WBA_orderbooks/WBA_orderbooks_2019-12-06.csv
data/WBA_orderbooks/WBA_orderbooks_2019-12-02.csv
data/WBA_orderbooks/WBA_orderbooks_2019-12-04.csv
data/WBA_orderbooks/WBA_orderbooks_2019-11-29.csv
data/WBA_orderbooks/WBA_orderbooks_2019-12-20.csv
data/WBA_orderbooks/WBA_orderbooks_2019-12-03.csv
data/WBA_orderbooks/WBA_orderbooks_2019-12-16.csv
data/WBA_orderbooks/WBA_orderbooks_2019-12-05.csv
data/WBA_orderbooks/WBA_orderbooks_2019-11-26.csv
data/WBA_orderbooks/WBA_orderbooks_2019-12-12.csv
data/WBA_orderbooks/WBA_orderbooks_2019-12-11.csv
training model: results/WBA/W9/deepLOB_L1/h10
Epoch 1/50
1200/1200 - 29s - loss: 3.0270 - accuracy10: 0.4469 - val_loss: 3.0866 - val_accuracy10: 0.3735 - 29s/epoch - 24ms/step
Epoch 2/50
1200/1200 - 19s - loss: 2.9643 - accuracy10: 0.4584 - val_loss: 3.1737 - val_accuracy10: 0.4731 - 19s/epoch - 16ms/step
Epoch 3/50
1200/1200 - 19s - loss: 2.9161 - accuracy10: 0.4721 - val_loss: 3.3630 - val_accuracy10: 0.5363 - 19s/epoch - 15ms/step
Epoch 4/50
1200/1200 - 19s - loss: 2.8738 - accuracy10: 0.4949 - val_loss: 3.3936 - val_accuracy10: 0.5439 - 19s/epoch - 16ms/step
Epoch 5/50
1200/1200 - 20s - loss: 2.8384 - accuracy10: 0.5063 - val_loss: 3.2605 - val_accuracy10: 0.5336 - 20s/epoch - 17ms/step
Epoch 6/50
1200/1200 - 19s - loss: 2.7996 - accuracy10: 0.5211 - val_loss: 3.2405 - val_accuracy10: 0.5373 - 19s/epoch - 16ms/step
Epoch 7/50
1200/1200 - 19s - loss: 2.7703 - accuracy10: 0.5317 - val_loss: 3.1927 - val_accuracy10: 0.5351 - 19s/epoch - 16ms/step
Epoch 8/50
1200/1200 - 19s - loss: 2.7472 - accuracy10: 0.5383 - val_loss: 3.1522 - val_accuracy10: 0.5140 - 19s/epoch - 16ms/step
Epoch 9/50
1200/1200 - 19s - loss: 2.7304 - accuracy10: 0.5412 - val_loss: 3.1602 - val_accuracy10: 0.5180 - 19s/epoch - 16ms/step
Epoch 10/50
1200/1200 - 19s - loss: 2.7178 - accuracy10: 0.5430 - val_loss: 3.1526 - val_accuracy10: 0.5175 - 19s/epoch - 16ms/step
Epoch 11/50
1200/1200 - 19s - loss: 2.7057 - accuracy10: 0.5477 - val_loss: 3.1281 - val_accuracy10: 0.5135 - 19s/epoch - 16ms/step
testing model: results/WBA/W9/deepLOB_L1/h10
Evaluating performance on  test set...
2451/2451 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0877926
{'0': {'precision': 0.29217307911428464, 'recall': 0.4633483413392763, 'f1-score': 0.3583694860969574, 'support': 132818}, '1': {'precision': 0.614412627798845, 'recall': 0.12488560845407996, 'f1-score': 0.20757873102318078, 'support': 367160}, '2': {'precision': 0.26908325537885874, 'recall': 0.722721669558663, 'f1-score': 0.39215836640444096, 'support': 127363}, 'accuracy': 0.31791641228614104, 'macro avg': {'precision': 0.3918896540973294, 'recall': 0.4369852064506731, 'f1-score': 0.31936886117485974, 'support': 627341}, 'weighted avg': {'precision': 0.4760805289296294, 'recall': 0.31791641228614104, 'f1-score': 0.27697694126043976, 'support': 627341}}
[[ 61541  18578  52699]
 [123974  45853 197333]
 [ 25117  10198  92048]]
Evaluating performance on  train set...
1200/1200 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0499287
{'0': {'precision': 0.3037379759335796, 'recall': 0.5133443570446151, 'f1-score': 0.38165597191982675, 'support': 64709}, '1': {'precision': 0.6414655473941938, 'recall': 0.2059183490152927, 'f1-score': 0.31175840614694184, 'support': 178124}, '2': {'precision': 0.3102569940518542, 'recall': 0.6785975505376679, 'f1-score': 0.4258252891746865, 'support': 64259}, 'accuracy': 0.3696058510153309, 'macro avg': {'precision': 0.41848683912654255, 'recall': 0.46595341886585856, 'f1-score': 0.373079889080485, 'support': 307092}, 'weighted avg': {'precision': 0.5009957733497046, 'recall': 0.3696058510153309, 'f1-score': 0.3503553914805795, 'support': 307092}}
[[33218 10820 20671]
 [65174 36679 76271]
 [10972  9681 43606]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0474025
{'0': {'precision': 0.3046830614398182, 'recall': 0.605997013600226, 'f1-score': 0.40549262114686146, 'support': 24779}, '1': {'precision': 0.6385698023388182, 'recall': 0.19189563216246056, 'f1-score': 0.29510862417351175, 'support': 64311}, '2': {'precision': 0.3287099990934639, 'recall': 0.6134325833192353, 'f1-score': 0.42804863652461345, 'support': 23644}, 'accuracy': 0.371325420902301, 'macro avg': {'precision': 0.42398762095736675, 'recall': 0.4704417430273073, 'f1-score': 0.3762166272816622, 'support': 112734}, 'weighted avg': {'precision': 0.5001935827363072, 'recall': 0.371325420902301, 'f1-score': 0.34725295253081373, 'support': 112734}}
[[15016  3487  6276]
 [28626 12341 23344]
 [ 5642  3498 14504]]
training model: results/WBA/W9/deepLOB_L1/h20
Epoch 1/50
1200/1200 - 22s - loss: 3.0704 - accuracy20: 0.4605 - val_loss: 3.2034 - val_accuracy20: 0.3947 - 22s/epoch - 18ms/step
Epoch 2/50
1200/1200 - 20s - loss: 3.0128 - accuracy20: 0.4705 - val_loss: 3.2092 - val_accuracy20: 0.3889 - 20s/epoch - 17ms/step
Epoch 3/50
1200/1200 - 19s - loss: 2.9621 - accuracy20: 0.4910 - val_loss: 3.2431 - val_accuracy20: 0.4461 - 19s/epoch - 16ms/step
Epoch 4/50
1200/1200 - 19s - loss: 2.9225 - accuracy20: 0.5054 - val_loss: 3.3297 - val_accuracy20: 0.4419 - 19s/epoch - 16ms/step
Epoch 5/50
1200/1200 - 19s - loss: 2.8976 - accuracy20: 0.5133 - val_loss: 3.3595 - val_accuracy20: 0.4634 - 19s/epoch - 16ms/step
Epoch 6/50
1200/1200 - 19s - loss: 2.8721 - accuracy20: 0.5212 - val_loss: 3.3364 - val_accuracy20: 0.4789 - 19s/epoch - 16ms/step
Epoch 7/50
1200/1200 - 19s - loss: 2.8574 - accuracy20: 0.5257 - val_loss: 3.4158 - val_accuracy20: 0.4816 - 19s/epoch - 16ms/step
Epoch 8/50
1200/1200 - 19s - loss: 2.8382 - accuracy20: 0.5315 - val_loss: 3.4360 - val_accuracy20: 0.4812 - 19s/epoch - 16ms/step
Epoch 9/50
1200/1200 - 20s - loss: 2.8253 - accuracy20: 0.5348 - val_loss: 3.3935 - val_accuracy20: 0.4811 - 20s/epoch - 17ms/step
Epoch 10/50
1200/1200 - 19s - loss: 2.8090 - accuracy20: 0.5391 - val_loss: 3.4152 - val_accuracy20: 0.4803 - 19s/epoch - 16ms/step
Epoch 11/50
1200/1200 - 19s - loss: 2.7978 - accuracy20: 0.5425 - val_loss: 3.4606 - val_accuracy20: 0.4799 - 19s/epoch - 16ms/step
testing model: results/WBA/W9/deepLOB_L1/h20
Evaluating performance on  test set...
2451/2451 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0972637
{'0': {'precision': 0.3564971408365687, 'recall': 0.5903845357592822, 'f1-score': 0.444554803825066, 'support': 169061}, '1': {'precision': 0.42835105830700543, 'recall': 0.09733039894038306, 'f1-score': 0.1586191744706561, 'support': 296711}, '2': {'precision': 0.3400203611423673, 'recall': 0.5891414813485261, 'f1-score': 0.4311845151003139, 'support': 161569}, 'accuracy': 0.35686652075984193, 'macro avg': {'precision': 0.37495618676198045, 'recall': 0.42561880534939717, 'f1-score': 0.3447861644653454, 'support': 627341}, 'weighted avg': {'precision': 0.3862380805936678, 'recall': 0.35686652075984193, 'f1-score': 0.30587349541329983, 'support': 627341}}
[[ 99811  21905  47345]
 [130419  28879 137413]
 [ 49747  16635  95187]]
Evaluating performance on  train set...
1200/1200 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0743926
{'0': {'precision': 0.340134898530596, 'recall': 0.5670702417755663, 'f1-score': 0.42521888507148403, 'support': 81191}, '1': {'precision': 0.46320746282001607, 'recall': 0.21401375625675592, 'f1-score': 0.2927633282944586, 'support': 145243}, '2': {'precision': 0.3669390681003584, 'recall': 0.4759726251580748, 'f1-score': 0.41440391185375886, 'support': 80658}, 'accuracy': 0.37616088989618746, 'macro avg': {'precision': 0.39009380981699016, 'recall': 0.419018874396799, 'f1-score': 0.37746204173990044, 'support': 307092}, 'weighted avg': {'precision': 0.4053837463164261, 'recall': 0.37616088989618746, 'f1-score': 0.35973181102604884, 'support': 307092}}
[[46041 17816 17334]
 [65259 31084 48900]
 [24061 18206 38391]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.069081
{'0': {'precision': 0.34780982905982905, 'recall': 0.6344767101929448, 'f1-score': 0.449313366917397, 'support': 30786}, '1': {'precision': 0.5229266442221063, 'recall': 0.20961794335677628, 'f1-score': 0.2992713605340642, 'support': 52610}, '2': {'precision': 0.390080315626321, 'recall': 0.4718113027472902, 'f1-score': 0.42707063850793703, 'support': 29338}, 'accuracy': 0.3938740752567992, 'macro avg': {'precision': 0.42027226296941883, 'recall': 0.4386353187656704, 'f1-score': 0.3918851219864661, 'support': 112734}, 'weighted avg': {'precision': 0.44053276251890217, 'recall': 0.3938740752567992, 'f1-score': 0.3735042310586155, 'support': 112734}}
[[19533  5128  6125]
 [26064 11028 15518]
 [10563  4933 13842]]
training model: results/WBA/W9/deepLOB_L1/h30
Epoch 1/50
1200/1200 - 21s - loss: 3.1002 - accuracy30: 0.4605 - val_loss: 3.3164 - val_accuracy30: 0.3862 - 21s/epoch - 18ms/step
Epoch 2/50
1200/1200 - 19s - loss: 3.0756 - accuracy30: 0.4633 - val_loss: 3.3975 - val_accuracy30: 0.3874 - 19s/epoch - 16ms/step
Epoch 3/50
1200/1200 - 19s - loss: 3.0406 - accuracy30: 0.4740 - val_loss: 3.2728 - val_accuracy30: 0.4058 - 19s/epoch - 16ms/step
Epoch 4/50
1200/1200 - 20s - loss: 3.0078 - accuracy30: 0.4873 - val_loss: 3.4562 - val_accuracy30: 0.4064 - 20s/epoch - 16ms/step
Epoch 5/50
1200/1200 - 19s - loss: 2.9850 - accuracy30: 0.4938 - val_loss: 3.3702 - val_accuracy30: 0.4049 - 19s/epoch - 16ms/step
Epoch 6/50
1200/1200 - 19s - loss: 2.9631 - accuracy30: 0.5015 - val_loss: 3.4208 - val_accuracy30: 0.4139 - 19s/epoch - 16ms/step
Epoch 7/50
1200/1200 - 20s - loss: 2.9419 - accuracy30: 0.5069 - val_loss: 3.4316 - val_accuracy30: 0.4064 - 20s/epoch - 17ms/step
Epoch 8/50
1200/1200 - 19s - loss: 2.9221 - accuracy30: 0.5130 - val_loss: 3.5227 - val_accuracy30: 0.4119 - 19s/epoch - 16ms/step
Epoch 9/50
1200/1200 - 19s - loss: 2.9087 - accuracy30: 0.5165 - val_loss: 3.5445 - val_accuracy30: 0.4100 - 19s/epoch - 16ms/step
Epoch 10/50
1200/1200 - 19s - loss: 2.8980 - accuracy30: 0.5203 - val_loss: 3.6009 - val_accuracy30: 0.4107 - 19s/epoch - 16ms/step
Epoch 11/50
1200/1200 - 20s - loss: 2.8880 - accuracy30: 0.5222 - val_loss: 3.5845 - val_accuracy30: 0.4179 - 20s/epoch - 17ms/step
Epoch 12/50
1200/1200 - 19s - loss: 2.8801 - accuracy30: 0.5251 - val_loss: 3.6036 - val_accuracy30: 0.4144 - 19s/epoch - 16ms/step
Epoch 13/50
1200/1200 - 19s - loss: 2.8711 - accuracy30: 0.5267 - val_loss: 3.5947 - val_accuracy30: 0.4164 - 19s/epoch - 16ms/step
testing model: results/WBA/W9/deepLOB_L1/h30
Evaluating performance on  test set...
2451/2451 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0986232
{'0': {'precision': 0.31003964598934763, 'recall': 0.12025722806726866, 'f1-score': 0.17329667336942123, 'support': 193136}, '1': {'precision': 0.3994360514032406, 'recall': 0.7345692832982832, 'f1-score': 0.517481611459972, 'support': 250118}, '2': {'precision': 0.339660598981148, 'recall': 0.17059325210362491, 'f1-score': 0.22711756537838462, 'support': 184087}, 'accuracy': 0.379951254580842, 'macro avg': {'precision': 0.3497120987912454, 'recall': 0.34180658782305895, 'f1-score': 0.3059652834025926, 'support': 627341}, 'weighted avg': {'precision': 0.3543735608820673, 'recall': 0.379951254580842, 'f1-score': 0.32631484832145913, 'support': 627341}}
[[ 23226 144954  24956]
 [ 30292 183729  36097]
 [ 21395 131288  31404]]
Evaluating performance on  train set...
1200/1200 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0655609
{'0': {'precision': 0.4003882335374048, 'recall': 0.14587413500456978, 'f1-score': 0.21383968802086237, 'support': 91908}, '1': {'precision': 0.41662413750867594, 'recall': 0.6596767676767676, 'f1-score': 0.510707113677454, 'support': 123750}, '2': {'precision': 0.41076188146221493, 'recall': 0.3488964717719885, 'f1-score': 0.37731006463745664, 'support': 91434}, 'accuracy': 0.413371237283941, 'macro avg': {'precision': 0.40925808416943193, 'recall': 0.38481579148444195, 'f1-score': 0.36728562211192434, 'support': 307092}, 'weighted avg': {'precision': 0.41001954024940607, 'recall': 0.413371237283941, 'f1-score': 0.3821413511725072, 'support': 307092}}
[[13407 61992 16509]
 [12862 81635 29253]
 [ 7216 52317 31901]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0661713
{'0': {'precision': 0.4058189265706885, 'recall': 0.19447491484325385, 'f1-score': 0.2629432312706126, 'support': 34642}, '1': {'precision': 0.4039129443632414, 'recall': 0.6657163064138266, 'f1-score': 0.5027750189869721, 'support': 45246}, '2': {'precision': 0.412569573283859, 'recall': 0.27080923095658527, 'f1-score': 0.3269859941918171, 'support': 32846}, 'accuracy': 0.4058491670658364, 'macro avg': {'precision': 0.40743381473926293, 'recall': 0.3770001507378886, 'f1-score': 0.36423474814980056, 'support': 112734}, 'weighted avg': {'precision': 0.4070208148296223, 'recall': 0.4058491670658364, 'f1-score': 0.37785956226147854, 'support': 112734}}
[[ 6737 23666  4239]
 [ 6699 30121  8426]
 [ 3165 20786  8895]]
training model: results/WBA/W9/deepLOB_L1/h50
Epoch 1/50
1200/1200 - 22s - loss: 3.1593 - accuracy50: 0.4424 - val_loss: 3.5735 - val_accuracy50: 0.3586 - 22s/epoch - 18ms/step
Epoch 2/50
1200/1200 - 20s - loss: 3.1379 - accuracy50: 0.4496 - val_loss: 3.3650 - val_accuracy50: 0.3452 - 20s/epoch - 17ms/step
Epoch 3/50
1200/1200 - 19s - loss: 3.1014 - accuracy50: 0.4630 - val_loss: 3.4434 - val_accuracy50: 0.3420 - 19s/epoch - 16ms/step
Epoch 4/50
1200/1200 - 19s - loss: 3.0698 - accuracy50: 0.4709 - val_loss: 3.4618 - val_accuracy50: 0.3428 - 19s/epoch - 16ms/step
Epoch 5/50
1200/1200 - 20s - loss: 3.0482 - accuracy50: 0.4759 - val_loss: 3.3274 - val_accuracy50: 0.3510 - 20s/epoch - 17ms/step
Epoch 6/50
1200/1200 - 19s - loss: 3.0276 - accuracy50: 0.4809 - val_loss: 3.2763 - val_accuracy50: 0.3696 - 19s/epoch - 16ms/step
Epoch 7/50
1200/1200 - 19s - loss: 3.0138 - accuracy50: 0.4857 - val_loss: 3.3112 - val_accuracy50: 0.3634 - 19s/epoch - 16ms/step
Epoch 8/50
1200/1200 - 20s - loss: 3.0037 - accuracy50: 0.4880 - val_loss: 3.3441 - val_accuracy50: 0.3758 - 20s/epoch - 17ms/step
Epoch 9/50
1200/1200 - 19s - loss: 2.9930 - accuracy50: 0.4912 - val_loss: 3.2989 - val_accuracy50: 0.3920 - 19s/epoch - 16ms/step
Epoch 10/50
1200/1200 - 19s - loss: 2.9840 - accuracy50: 0.4936 - val_loss: 3.2801 - val_accuracy50: 0.3972 - 19s/epoch - 16ms/step
Epoch 11/50
1200/1200 - 19s - loss: 2.9793 - accuracy50: 0.4950 - val_loss: 3.2886 - val_accuracy50: 0.3917 - 19s/epoch - 16ms/step
Epoch 12/50
1200/1200 - 19s - loss: 2.9719 - accuracy50: 0.4965 - val_loss: 3.3867 - val_accuracy50: 0.3898 - 19s/epoch - 16ms/step
Epoch 13/50
1200/1200 - 19s - loss: 2.9652 - accuracy50: 0.4991 - val_loss: 3.4237 - val_accuracy50: 0.3868 - 19s/epoch - 16ms/step
Epoch 14/50
1200/1200 - 19s - loss: 2.9606 - accuracy50: 0.4999 - val_loss: 3.4020 - val_accuracy50: 0.3870 - 19s/epoch - 16ms/step
Epoch 15/50
1200/1200 - 19s - loss: 2.9547 - accuracy50: 0.5006 - val_loss: 3.4098 - val_accuracy50: 0.3851 - 19s/epoch - 16ms/step
Epoch 16/50
1200/1200 - 19s - loss: 2.9501 - accuracy50: 0.5030 - val_loss: 3.3728 - val_accuracy50: 0.3833 - 19s/epoch - 16ms/step
testing model: results/WBA/W9/deepLOB_L1/h50
Evaluating performance on  test set...
2451/2451 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1178433
{'0': {'precision': 0.44073422773705323, 'recall': 0.10298198069260991, 'f1-score': 0.1669535799290451, 'support': 216601}, '1': {'precision': 0.3211699323183276, 'recall': 0.7246742578324105, 'f1-score': 0.44508270836657626, 'support': 202077}, '2': {'precision': 0.33683304077103965, 'recall': 0.1949555024129817, 'f1-score': 0.24696829420067695, 'support': 208663}, 'accuracy': 0.3338312018503493, 'macro avg': {'precision': 0.3662457336088068, 'recall': 0.3408705803126673, 'f1-score': 0.28633486083209947, 'support': 627341}, 'weighted avg': {'precision': 0.36766148500029744, 'recall': 0.3338312018503493, 'f1-score': 0.2831577021071468, 'support': 627341}}
[[ 22306 153575  40720]
 [ 16265 146440  39372]
 [ 12040 155943  40680]]
Evaluating performance on  train set...
1200/1200 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0989035
{'0': {'precision': 0.4294334504225646, 'recall': 0.23947827773467806, 'f1-score': 0.3074844670227734, 'support': 103120}, '1': {'precision': 0.3408225964196113, 'recall': 0.6335503759547075, 'f1-score': 0.4432148473275847, 'support': 101209}, '2': {'precision': 0.40086248982912936, 'recall': 0.23970689839728307, 'f1-score': 0.30001278826889466, 'support': 102763}, 'accuracy': 0.3694300079455017, 'macro avg': {'precision': 0.3903728455571018, 'recall': 0.3709118506955562, 'f1-score': 0.35023736753975093, 'support': 307092}, 'weighted avg': {'precision': 0.3906689969485305, 'recall': 0.3694300079455017, 'f1-score': 0.34971716581168616, 'support': 307092}}
[[24695 60277 18148]
 [18419 64121 18669]
 [14392 63738 24633]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0936394
{'0': {'precision': 0.43171376295995123, 'recall': 0.2763305139882889, 'f1-score': 0.33697238971755, 'support': 38425}, '1': {'precision': 0.3341086559229108, 'recall': 0.5854284655692584, 'f1-score': 0.42542429924515596, 'support': 37786}, '2': {'precision': 0.400547195622435, 'recall': 0.24050598253155545, 'f1-score': 0.30054915915350794, 'support': 36523}, 'accuracy': 0.36832721273085317, 'macro avg': {'precision': 0.38878987150176564, 'recall': 0.3674216540297009, 'f1-score': 0.35431528270540463, 'support': 112734}, 'weighted avg': {'precision': 0.3889014515599325, 'recall': 0.36832721273085317, 'f1-score': 0.3548193409791003, 'support': 112734}}
[[10618 21566  6241]
 [ 8760 22121  6905]
 [ 5217 22522  8784]]
training model: results/WBA/W9/deepLOB_L1/h100
Epoch 1/50
1200/1200 - 22s - loss: 3.2360 - accuracy100: 0.4087 - val_loss: 3.3217 - val_accuracy100: 0.3589 - 22s/epoch - 18ms/step
Epoch 2/50
1200/1200 - 19s - loss: 3.2165 - accuracy100: 0.4159 - val_loss: 3.2988 - val_accuracy100: 0.3687 - 19s/epoch - 16ms/step
Epoch 3/50
1200/1200 - 19s - loss: 3.1996 - accuracy100: 0.4238 - val_loss: 3.3765 - val_accuracy100: 0.3716 - 19s/epoch - 16ms/step
Epoch 4/50
1200/1200 - 19s - loss: 3.1929 - accuracy100: 0.4244 - val_loss: 3.4516 - val_accuracy100: 0.3703 - 19s/epoch - 16ms/step
Epoch 5/50
1200/1200 - 19s - loss: 3.1798 - accuracy100: 0.4310 - val_loss: 3.3740 - val_accuracy100: 0.3669 - 19s/epoch - 16ms/step
Epoch 6/50
1200/1200 - 19s - loss: 3.1725 - accuracy100: 0.4324 - val_loss: 3.3293 - val_accuracy100: 0.3617 - 19s/epoch - 16ms/step
Epoch 7/50
1200/1200 - 20s - loss: 3.1652 - accuracy100: 0.4356 - val_loss: 3.4089 - val_accuracy100: 0.3699 - 20s/epoch - 17ms/step
Epoch 8/50
1200/1200 - 20s - loss: 3.1619 - accuracy100: 0.4363 - val_loss: 3.3570 - val_accuracy100: 0.3631 - 20s/epoch - 17ms/step
Epoch 9/50
1200/1200 - 20s - loss: 3.1562 - accuracy100: 0.4393 - val_loss: 3.3790 - val_accuracy100: 0.3620 - 20s/epoch - 17ms/step
Epoch 10/50
1200/1200 - 20s - loss: 3.1524 - accuracy100: 0.4404 - val_loss: 3.3792 - val_accuracy100: 0.3646 - 20s/epoch - 16ms/step
Epoch 11/50
1200/1200 - 19s - loss: 3.1489 - accuracy100: 0.4421 - val_loss: 3.4009 - val_accuracy100: 0.3591 - 19s/epoch - 16ms/step
Epoch 12/50
1200/1200 - 20s - loss: 3.1461 - accuracy100: 0.4429 - val_loss: 3.3913 - val_accuracy100: 0.3629 - 20s/epoch - 16ms/step
testing model: results/WBA/W9/deepLOB_L1/h100
Evaluating performance on  test set...
2451/2451 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1119827
{'0': {'precision': 0.3556931495161879, 'recall': 0.7896076342411743, 'f1-score': 0.4904528666851425, 'support': 219642}, '1': {'precision': 0.32412546597883796, 'recall': 0.21779878446831874, 'f1-score': 0.2605313655816994, 'support': 197609}, '2': {'precision': 0.40215208034433286, 'recall': 0.013341901090009043, 'f1-score': 0.025826960287478117, 'support': 210090}, 'accuracy': 0.34952760938628274, 'macro avg': {'precision': 0.36065689861311956, 'recall': 0.3402494399331674, 'f1-score': 0.2589370641847733, 'support': 627341}, 'weighted avg': {'precision': 0.3613081155419264, 'recall': 0.34952760938628274, 'f1-score': 0.262430444132439, 'support': 627341}}
[[173431  44031   2180]
 [152583  43039   1987]
 [161572  45715   2803]]
Evaluating performance on  train set...
1200/1200 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0987288
{'0': {'precision': 0.36886280682664524, 'recall': 0.6806105144149237, 'f1-score': 0.47843408616773825, 'support': 102602}, '1': {'precision': 0.3554368001305403, 'recall': 0.16963407867454516, 'f1-score': 0.22966116214399618, 'support': 102727}, '2': {'precision': 0.3831529644498749, 'recall': 0.25884653557776405, 'f1-score': 0.30896540399153133, 'support': 101763}, 'accuracy': 0.36991846091724956, 'macro avg': {'precision': 0.3691508571356868, 'recall': 0.3696970428890776, 'f1-score': 0.3390202174344219, 'support': 307092}, 'weighted avg': {'precision': 0.36910702002771184, 'recall': 0.36991846091724956, 'f1-score': 0.33905781563485465, 'support': 307092}}
[[69832 13887 18883]
 [61777 17426 23524]
 [57708 17714 26341]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0988864
{'0': {'precision': 0.36774584296883606, 'recall': 0.7067724867724867, 'f1-score': 0.48377517021584815, 'support': 37800}, '1': {'precision': 0.36046807428135336, 'recall': 0.14562832404100615, 'f1-score': 0.20744807393174125, 'support': 38921}, '2': {'precision': 0.3693046547902471, 'recall': 0.2498264515591592, 'f1-score': 0.29803726708074535, 'support': 36013}, 'accuracy': 0.36706761048131, 'macro avg': {'precision': 0.3658395240134788, 'recall': 0.3674090874575507, 'f1-score': 0.3297535037427783, 'support': 112734}, 'weighted avg': {'precision': 0.36573118417059386, 'recall': 0.36706761048131, 'f1-score': 0.32904007680943853, 'support': 112734}}
[[26716  4444  6640]
 [24528  5668  8725]
 [21404  5612  8997]]
training model: results/WBA/W9/deepLOB_L1/h200
Epoch 1/50
1200/1200 - 22s - loss: 3.2886 - accuracy200: 0.3780 - val_loss: 3.3958 - val_accuracy200: 0.3280 - 22s/epoch - 18ms/step
Epoch 2/50
1200/1200 - 18s - loss: 3.2661 - accuracy200: 0.3865 - val_loss: 3.3782 - val_accuracy200: 0.3299 - 18s/epoch - 15ms/step
Epoch 3/50
1200/1200 - 19s - loss: 3.2550 - accuracy200: 0.3917 - val_loss: 3.3717 - val_accuracy200: 0.3316 - 19s/epoch - 16ms/step
Epoch 4/50
1200/1200 - 19s - loss: 3.2459 - accuracy200: 0.3971 - val_loss: 3.3562 - val_accuracy200: 0.3301 - 19s/epoch - 16ms/step
Epoch 5/50
1200/1200 - 19s - loss: 3.2367 - accuracy200: 0.4027 - val_loss: 3.3376 - val_accuracy200: 0.3374 - 19s/epoch - 16ms/step
Epoch 6/50
1200/1200 - 19s - loss: 3.2263 - accuracy200: 0.4081 - val_loss: 3.3453 - val_accuracy200: 0.3394 - 19s/epoch - 16ms/step
Epoch 7/50
1200/1200 - 19s - loss: 3.2206 - accuracy200: 0.4103 - val_loss: 3.3398 - val_accuracy200: 0.3377 - 19s/epoch - 16ms/step
Epoch 8/50
1200/1200 - 20s - loss: 3.2156 - accuracy200: 0.4126 - val_loss: 3.3429 - val_accuracy200: 0.3414 - 20s/epoch - 16ms/step
Epoch 9/50
1200/1200 - 19s - loss: 3.2114 - accuracy200: 0.4144 - val_loss: 3.3392 - val_accuracy200: 0.3411 - 19s/epoch - 16ms/step
Epoch 10/50
1200/1200 - 19s - loss: 3.2077 - accuracy200: 0.4166 - val_loss: 3.3490 - val_accuracy200: 0.3409 - 19s/epoch - 16ms/step
Epoch 11/50
1200/1200 - 19s - loss: 3.2033 - accuracy200: 0.4187 - val_loss: 3.3446 - val_accuracy200: 0.3458 - 19s/epoch - 16ms/step
Epoch 12/50
1200/1200 - 19s - loss: 3.2001 - accuracy200: 0.4197 - val_loss: 3.3616 - val_accuracy200: 0.3407 - 19s/epoch - 16ms/step
Epoch 13/50
1200/1200 - 19s - loss: 3.1966 - accuracy200: 0.4220 - val_loss: 3.3500 - val_accuracy200: 0.3419 - 19s/epoch - 16ms/step
Epoch 14/50
1200/1200 - 19s - loss: 3.1940 - accuracy200: 0.4232 - val_loss: 3.3714 - val_accuracy200: 0.3424 - 19s/epoch - 16ms/step
Epoch 15/50
1200/1200 - 19s - loss: 3.1920 - accuracy200: 0.4241 - val_loss: 3.3681 - val_accuracy200: 0.3487 - 19s/epoch - 16ms/step
testing model: results/WBA/W9/deepLOB_L1/h200
Evaluating performance on  test set...
2451/2451 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1053015
{'0': {'precision': 0.346630616337726, 'recall': 0.2986116124064583, 'f1-score': 0.32083432436065806, 'support': 207795}, '1': {'precision': 0.351540903711532, 'recall': 0.3698671677931291, 'f1-score': 0.3604712604560354, 'support': 217643}, '2': {'precision': 0.3261376018382169, 'recall': 0.35430875222260194, 'f1-score': 0.33964002032066776, 'support': 201903}, 'accuracy': 0.3412577848410992, 'macro avg': {'precision': 0.34143637396249166, 'recall': 0.3409291774740631, 'f1-score': 0.3403152017124538, 'support': 627341}, 'weighted avg': {'precision': 0.34173868127912604, 'recall': 0.3412577848410992, 'f1-score': 0.34063795287213755, 'support': 627341}}
[[62050 74895 70850]
 [60187 80499 76957]
 [56772 73595 71536]]
Evaluating performance on  train set...
1200/1200 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1120034
{'0': {'precision': 0.35740485720536946, 'recall': 0.26707829616165113, 'f1-score': 0.30570906448843, 'support': 103977}, '1': {'precision': 0.33566877010640933, 'recall': 0.43129968203497615, 'f1-score': 0.3775222655162816, 'support': 100640}, '2': {'precision': 0.35107562874072, 'recall': 0.3428738716760185, 'f1-score': 0.3469262821145757, 'support': 102475}, 'accuracy': 0.34618941554973753, 'macro avg': {'precision': 0.3480497520174996, 'recall': 0.3470839499575486, 'f1-score': 0.34338587070642906, 'support': 307092}, 'weighted avg': {'precision': 0.3481694896524723, 'recall': 0.34618941554973753, 'f1-score': 0.34299761296146825, 'support': 307092}}
[[27770 42396 33811]
 [26100 43406 31134]
 [23829 43510 35136]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1128228
{'0': {'precision': 0.3493553862265718, 'recall': 0.2515079034941764, 'f1-score': 0.2924646663139597, 'support': 38464}, '1': {'precision': 0.32593635469741666, 'recall': 0.386163255579973, 'f1-score': 0.35350291455094107, 'support': 37769}, '2': {'precision': 0.3408115150763122, 'recall': 0.37623626749952055, 'f1-score': 0.3576488358768685, 'support': 36501}, 'accuracy': 0.33700569482143805, 'macro avg': {'precision': 0.33870108533343357, 'recall': 0.33796914219122326, 'f1-score': 0.3345388055805898, 'support': 112734}, 'weighted avg': {'precision': 0.33874303110140735, 'recall': 0.33700569482143805, 'f1-score': 0.3340194853648076, 'support': 112734}}
[[ 9674 15283 13507]
 [10129 14585 13055]
 [ 7888 14880 13733]]
training model: results/WBA/W9/deepLOB_L1/h300
Epoch 1/50
1200/1200 - 21s - loss: 3.2976 - accuracy300: 0.3745 - val_loss: 3.3377 - val_accuracy300: 0.3367 - 21s/epoch - 18ms/step
Epoch 2/50
1200/1200 - 19s - loss: 3.2713 - accuracy300: 0.3844 - val_loss: 3.3450 - val_accuracy300: 0.3418 - 19s/epoch - 16ms/step
Epoch 3/50
1200/1200 - 19s - loss: 3.2634 - accuracy300: 0.3874 - val_loss: 3.3791 - val_accuracy300: 0.3424 - 19s/epoch - 16ms/step
Epoch 4/50
1200/1200 - 19s - loss: 3.2505 - accuracy300: 0.3956 - val_loss: 3.4258 - val_accuracy300: 0.3427 - 19s/epoch - 16ms/step
Epoch 5/50
1200/1200 - 19s - loss: 3.2448 - accuracy300: 0.4002 - val_loss: 3.3999 - val_accuracy300: 0.3354 - 19s/epoch - 16ms/step
Epoch 6/50
1200/1200 - 18s - loss: 3.2384 - accuracy300: 0.4033 - val_loss: 3.4103 - val_accuracy300: 0.3220 - 18s/epoch - 15ms/step
Epoch 7/50
1200/1200 - 20s - loss: 3.2311 - accuracy300: 0.4085 - val_loss: 3.4149 - val_accuracy300: 0.3260 - 20s/epoch - 16ms/step
Epoch 8/50
1200/1200 - 19s - loss: 3.2256 - accuracy300: 0.4130 - val_loss: 3.3983 - val_accuracy300: 0.3254 - 19s/epoch - 15ms/step
Epoch 9/50
1200/1200 - 19s - loss: 3.2201 - accuracy300: 0.4149 - val_loss: 3.3999 - val_accuracy300: 0.3271 - 19s/epoch - 16ms/step
Epoch 10/50
1200/1200 - 18s - loss: 3.2167 - accuracy300: 0.4159 - val_loss: 3.4082 - val_accuracy300: 0.3338 - 18s/epoch - 15ms/step
Epoch 11/50
1200/1200 - 19s - loss: 3.2123 - accuracy300: 0.4181 - val_loss: 3.4031 - val_accuracy300: 0.3332 - 19s/epoch - 16ms/step
testing model: results/WBA/W9/deepLOB_L1/h300
Evaluating performance on  test set...
2451/2451 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1073459
{'0': {'precision': 0.3427088695796869, 'recall': 0.312233808195036, 'f1-score': 0.32676232312314696, 'support': 211079}, '1': {'precision': 0.3414152867137784, 'recall': 0.36388546697081403, 'f1-score': 0.35229243804941535, 'support': 213493}, '2': {'precision': 0.3228234885872918, 'recall': 0.3303364912782526, 'f1-score': 0.3265367806033779, 'support': 202769}, 'accuracy': 0.3356627416349322, 'macro avg': {'precision': 0.33564921496025235, 'recall': 0.3354852554813676, 'f1-score': 0.33519718059198006, 'support': 627341}, 'weighted avg': {'precision': 0.3358412972302974, 'recall': 0.3356627416349322, 'f1-score': 0.33537768190690687, 'support': 627341}}
[[65906 76047 69126]
 [64426 77687 71380]
 [61977 73810 66982]]
Evaluating performance on  train set...
1200/1200 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1179371
{'0': {'precision': 0.3456130483689539, 'recall': 0.2662779305927126, 'f1-score': 0.30080236666241006, 'support': 106156}, '1': {'precision': 0.3146979442213957, 'recall': 0.4827092601746581, 'f1-score': 0.38100386100386097, 'support': 97104}, '2': {'precision': 0.33734513737918753, 'recall': 0.24808344248401262, 'f1-score': 0.2859093179421721, 'support': 103832}, 'accuracy': 0.32856277597592903, 'macro avg': {'precision': 0.33255204332317906, 'recall': 0.3323568777504611, 'f1-score': 0.32257184853614773, 'support': 307092}, 'weighted avg': {'precision': 0.3330420468220757, 'recall': 0.32856277597592903, 'f1-score': 0.3211269302193001, 'support': 307092}}
[[28267 51193 26696]
 [26328 46873 23903]
 [27193 50880 25759]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1135112
{'0': {'precision': 0.34259292447757983, 'recall': 0.24444387611570037, 'f1-score': 0.2853134328358209, 'support': 39101}, '1': {'precision': 0.33125702596612794, 'recall': 0.4820844284718125, 'f1-score': 0.39268588406208693, 'support': 37286}, '2': {'precision': 0.3366479131231192, 'recall': 0.2831595454920626, 'f1-score': 0.30759575008592477, 'support': 36347}, 'accuracy': 0.3355243316124683, 'macro avg': {'precision': 0.3368326211889423, 'recall': 0.3365626166931918, 'f1-score': 0.3285316889946109, 'support': 112734}, 'weighted avg': {'precision': 0.33692689967939493, 'recall': 0.3355243316124683, 'f1-score': 0.3280102643286455, 'support': 112734}}
[[ 9558 18956 10587]
 [ 9618 17975  9693]
 [ 8723 17332 10292]]
training model: results/WBA/W9/deepLOB_L1/h500
Epoch 1/50
1200/1200 - 22s - loss: 3.2626 - accuracy500: 0.4021 - val_loss: 3.3619 - val_accuracy500: 0.3490 - 22s/epoch - 18ms/step
Epoch 2/50
1200/1200 - 19s - loss: 3.2374 - accuracy500: 0.4144 - val_loss: 3.4900 - val_accuracy500: 0.3475 - 19s/epoch - 16ms/step
Epoch 3/50
1200/1200 - 19s - loss: 3.2288 - accuracy500: 0.4144 - val_loss: 3.3938 - val_accuracy500: 0.3442 - 19s/epoch - 15ms/step
Epoch 4/50
1200/1200 - 19s - loss: 3.2049 - accuracy500: 0.4289 - val_loss: 3.3982 - val_accuracy500: 0.3376 - 19s/epoch - 16ms/step
Epoch 5/50
1200/1200 - 19s - loss: 3.1949 - accuracy500: 0.4325 - val_loss: 3.3502 - val_accuracy500: 0.3351 - 19s/epoch - 16ms/step
Epoch 6/50
1200/1200 - 19s - loss: 3.1877 - accuracy500: 0.4362 - val_loss: 3.3627 - val_accuracy500: 0.3358 - 19s/epoch - 16ms/step
Epoch 7/50
1200/1200 - 19s - loss: 3.1869 - accuracy500: 0.4368 - val_loss: 3.3722 - val_accuracy500: 0.3343 - 19s/epoch - 16ms/step
Epoch 8/50
1200/1200 - 19s - loss: 3.1760 - accuracy500: 0.4417 - val_loss: 3.3664 - val_accuracy500: 0.3325 - 19s/epoch - 16ms/step
Epoch 9/50
1200/1200 - 19s - loss: 3.1715 - accuracy500: 0.4428 - val_loss: 3.3632 - val_accuracy500: 0.3368 - 19s/epoch - 16ms/step
Epoch 10/50
1200/1200 - 20s - loss: 3.1708 - accuracy500: 0.4424 - val_loss: 3.4027 - val_accuracy500: 0.3351 - 20s/epoch - 17ms/step
Epoch 11/50
1200/1200 - 19s - loss: 3.1709 - accuracy500: 0.4433 - val_loss: 3.3558 - val_accuracy500: 0.3283 - 19s/epoch - 16ms/step
Epoch 12/50
1200/1200 - 19s - loss: 3.1679 - accuracy500: 0.4456 - val_loss: 3.3503 - val_accuracy500: 0.3281 - 19s/epoch - 16ms/step
Epoch 13/50
1200/1200 - 19s - loss: 3.1588 - accuracy500: 0.4485 - val_loss: 3.3808 - val_accuracy500: 0.3270 - 19s/epoch - 15ms/step
Epoch 14/50
1200/1200 - 19s - loss: 3.1522 - accuracy500: 0.4524 - val_loss: 3.3868 - val_accuracy500: 0.3256 - 19s/epoch - 16ms/step
Epoch 15/50
1200/1200 - 19s - loss: 3.1458 - accuracy500: 0.4541 - val_loss: 3.3887 - val_accuracy500: 0.3233 - 19s/epoch - 16ms/step
testing model: results/WBA/W9/deepLOB_L1/h500
Evaluating performance on  test set...
2451/2451 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.109335
{'0': {'precision': 0.3431804066643264, 'recall': 0.05720857791061976, 'f1-score': 0.0980689468912167, 'support': 222152}, '1': {'precision': 0.30427551599998365, 'recall': 0.3921818545711186, 'f1-score': 0.3426809484910892, 'support': 189866}, '2': {'precision': 0.3438448561730842, 'recall': 0.5518639439353901, 'f1-score': 0.4236992612031833, 'support': 215323}, 'accuracy': 0.3283700571140735, 'macro avg': {'precision': 0.33043359294579805, 'recall': 0.3337514588057095, 'f1-score': 0.2881497188618298, 'support': 627341}, 'weighted avg': {'precision': 0.3316338240094356, 'recall': 0.3283700571140735, 'f1-score': 0.2838677364878746, 'support': 627341}}
[[ 12709  86821 122622]
 [ 11266  74462 104138]
 [ 13058  83436 118829]]
Evaluating performance on  train set...
1200/1200 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1138327
{'0': {'precision': 0.3305112999201883, 'recall': 0.3116604744212632, 'f1-score': 0.32080920604256863, 'support': 104970}, '1': {'precision': 0.34308876241376207, 'recall': 0.2660125510509015, 'f1-score': 0.29967401123286597, 'support': 100390}, '2': {'precision': 0.33344080078604765, 'recall': 0.42698462627295247, 'f1-score': 0.37445906105067156, 'support': 101732}, 'accuracy': 0.33494197178695634, 'macro avg': {'precision': 0.335680287706666, 'recall': 0.33488588391503904, 'f1-score': 0.33164742610870207, 'support': 307092}, 'weighted avg': {'precision': 0.3355934103034463, 'recall': 0.33494197178695634, 'f1-score': 0.33167287179334776, 'support': 307092}}
[[32715 26620 45635]
 [32486 26705 41199]
 [33782 24512 43438]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1187516
{'0': {'precision': 0.3296265833196249, 'recall': 0.25087012043969253, 'f1-score': 0.2849058749928909, 'support': 39937}, '1': {'precision': 0.3239719877895493, 'recall': 0.25255466278451244, 'f1-score': 0.28383990938266945, 'support': 35719}, '2': {'precision': 0.33539472235475465, 'recall': 0.49293381520038837, 'f1-score': 0.39918315642336083, 'support': 37078}, 'accuracy': 0.3310181489169195, 'macro avg': {'precision': 0.32966443115464295, 'recall': 0.3321195328081978, 'f1-score': 0.32264298026630706, 'support': 112734}, 'weighted avg': {'precision': 0.329732093293597, 'recall': 0.3310181489169195, 'f1-score': 0.3221537134023101, 'support': 112734}}
[[10019  9838 20080]
 [10561  9021 16137]
 [ 9815  8986 18277]]
training model: results/WBA/W9/deepLOB_L1/h1000
Epoch 1/50
1200/1200 - 21s - loss: 3.2752 - accuracy1000: 0.3969 - val_loss: 3.4175 - val_accuracy1000: 0.3370 - 21s/epoch - 18ms/step
Epoch 2/50
1200/1200 - 19s - loss: 3.2327 - accuracy1000: 0.4070 - val_loss: 3.4409 - val_accuracy1000: 0.3286 - 19s/epoch - 16ms/step
Epoch 3/50
1200/1200 - 19s - loss: 3.2017 - accuracy1000: 0.4202 - val_loss: 3.3743 - val_accuracy1000: 0.3187 - 19s/epoch - 16ms/step
Epoch 4/50
1200/1200 - 19s - loss: 3.1824 - accuracy1000: 0.4284 - val_loss: 3.4315 - val_accuracy1000: 0.3282 - 19s/epoch - 16ms/step
Epoch 5/50
1200/1200 - 19s - loss: 3.1655 - accuracy1000: 0.4375 - val_loss: 3.4256 - val_accuracy1000: 0.3234 - 19s/epoch - 16ms/step
Epoch 6/50
1200/1200 - 19s - loss: 3.1512 - accuracy1000: 0.4424 - val_loss: 3.3713 - val_accuracy1000: 0.3311 - 19s/epoch - 16ms/step
Epoch 7/50
1200/1200 - 18s - loss: 3.1364 - accuracy1000: 0.4517 - val_loss: 3.4186 - val_accuracy1000: 0.3215 - 18s/epoch - 15ms/step
Epoch 8/50
1200/1200 - 19s - loss: 3.1243 - accuracy1000: 0.4571 - val_loss: 3.3897 - val_accuracy1000: 0.3241 - 19s/epoch - 16ms/step
Epoch 9/50
1200/1200 - 19s - loss: 3.1146 - accuracy1000: 0.4604 - val_loss: 3.4123 - val_accuracy1000: 0.3211 - 19s/epoch - 16ms/step
Epoch 10/50
1200/1200 - 19s - loss: 3.1094 - accuracy1000: 0.4621 - val_loss: 3.4302 - val_accuracy1000: 0.3213 - 19s/epoch - 16ms/step
Epoch 11/50
1200/1200 - 19s - loss: 3.1007 - accuracy1000: 0.4647 - val_loss: 3.4874 - val_accuracy1000: 0.3150 - 19s/epoch - 16ms/step
Epoch 12/50
1200/1200 - 19s - loss: 3.1020 - accuracy1000: 0.4630 - val_loss: 3.4377 - val_accuracy1000: 0.3159 - 19s/epoch - 16ms/step
Epoch 13/50
1200/1200 - 19s - loss: 3.0916 - accuracy1000: 0.4692 - val_loss: 3.4612 - val_accuracy1000: 0.3137 - 19s/epoch - 16ms/step
Epoch 14/50
1200/1200 - 19s - loss: 3.0852 - accuracy1000: 0.4702 - val_loss: 3.4523 - val_accuracy1000: 0.3148 - 19s/epoch - 16ms/step
Epoch 15/50
1200/1200 - 19s - loss: 3.0758 - accuracy1000: 0.4734 - val_loss: 3.4709 - val_accuracy1000: 0.3158 - 19s/epoch - 16ms/step
Epoch 16/50
1200/1200 - 19s - loss: 3.0703 - accuracy1000: 0.4761 - val_loss: 3.4470 - val_accuracy1000: 0.3164 - 19s/epoch - 16ms/step
testing model: results/WBA/W9/deepLOB_L1/h1000
Evaluating performance on  test set...
2451/2451 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1018491
{'0': {'precision': 0.3243832601130728, 'recall': 0.6945759098820723, 'f1-score': 0.44223322126758813, 'support': 204532}, '1': {'precision': 0.3501714576686531, 'recall': 0.19828708647014565, 'f1-score': 0.25319863770250367, 'support': 221961}, '2': {'precision': 0.31441308510972277, 'recall': 0.09972715685493508, 'f1-score': 0.1514246618837742, 'support': 200848}, 'accuracy': 0.3285374302014375, 'macro avg': {'precision': 0.32965593429714957, 'recall': 0.33086338440238433, 'f1-score': 0.2822855069512887, 'support': 627341}, 'weighted avg': {'precision': 0.3303154156848612, 'recall': 0.3285374302014375, 'f1-score': 0.28224587349690206, 'support': 627341}}
[[142063  41346  21123]
 [155396  44012  22553]
 [140489  40329  20030]]
Evaluating performance on  train set...
1200/1200 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1228458
{'0': {'precision': 0.33540464214059545, 'recall': 0.6717098623198066, 'f1-score': 0.4474061390157281, 'support': 105026}, '1': {'precision': 0.3281745901907535, 'recall': 0.19726620119972466, 'f1-score': 0.24641312893081763, 'support': 101690}, '2': {'precision': 0.3501627750336776, 'recall': 0.12430262214075077, 'f1-score': 0.18347450149991176, 'support': 100376}, 'accuracy': 0.33567790759772315, 'macro avg': {'precision': 0.33791400245500886, 'recall': 0.331092895220094, 'f1-score': 0.2924312564821525, 'support': 307092}, 'weighted avg': {'precision': 0.3378343321504185, 'recall': 0.33567790759772315, 'f1-score': 0.2945809881071335, 'support': 307092}}
[[70547 21639 12840]
 [71315 20060 10315]
 [68472 19427 12477]]
Evaluating performance on  val set...
441/441 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.123163
{'0': {'precision': 0.3311941734231139, 'recall': 0.6345708267509216, 'f1-score': 0.43523250564334093, 'support': 37980}, '1': {'precision': 0.34106532663316586, 'recall': 0.21518248915717655, 'f1-score': 0.263879817112998, 'support': 39427}, '2': {'precision': 0.32480615017562464, 'recall': 0.13873241430067654, 'f1-score': 0.19442240558552842, 'support': 35327}, 'accuracy': 0.3325172530026434, 'macro avg': {'precision': 0.3323552167439681, 'recall': 0.32949524340292485, 'f1-score': 0.2978449094472891, 'support': 112734}, 'weighted avg': {'precision': 0.3326446698159383, 'recall': 0.3325172530026434, 'f1-score': 0.29984281969741367, 'support': 112734}}
[[24101  8384  5495]
 [26250  8484  4693]
 [22419  8007  4901]]
training model: results/WBA/W9/deepOF_L1/h10
Epoch 1/50
1200/1200 - 20s - loss: 3.2101 - accuracy10: 0.4043 - val_loss: 3.2109 - val_accuracy10: 0.3625 - 20s/epoch - 17ms/step
Epoch 2/50
1200/1200 - 18s - loss: 3.1685 - accuracy10: 0.4113 - val_loss: 3.1993 - val_accuracy10: 0.3001 - 18s/epoch - 15ms/step
Epoch 3/50
1200/1200 - 17s - loss: 3.1538 - accuracy10: 0.4223 - val_loss: 3.1949 - val_accuracy10: 0.2793 - 17s/epoch - 14ms/step
Epoch 4/50
1200/1200 - 17s - loss: 3.1432 - accuracy10: 0.4240 - val_loss: 3.1875 - val_accuracy10: 0.2806 - 17s/epoch - 14ms/step
Epoch 5/50
1200/1200 - 17s - loss: 3.1354 - accuracy10: 0.4270 - val_loss: 3.1859 - val_accuracy10: 0.2818 - 17s/epoch - 14ms/step
Epoch 6/50
1200/1200 - 17s - loss: 3.1287 - accuracy10: 0.4299 - val_loss: 3.1803 - val_accuracy10: 0.2865 - 17s/epoch - 14ms/step
Epoch 7/50
1200/1200 - 17s - loss: 3.1223 - accuracy10: 0.4327 - val_loss: 3.1795 - val_accuracy10: 0.2858 - 17s/epoch - 14ms/step
Epoch 8/50
1200/1200 - 18s - loss: 3.1155 - accuracy10: 0.4352 - val_loss: 3.1784 - val_accuracy10: 0.2887 - 18s/epoch - 15ms/step
Epoch 9/50
1200/1200 - 17s - loss: 3.1108 - accuracy10: 0.4371 - val_loss: 3.1742 - val_accuracy10: 0.2904 - 17s/epoch - 14ms/step
Epoch 10/50
1200/1200 - 16s - loss: 3.1050 - accuracy10: 0.4383 - val_loss: 3.1747 - val_accuracy10: 0.2965 - 16s/epoch - 14ms/step
Epoch 11/50
1200/1200 - 17s - loss: 3.0990 - accuracy10: 0.4418 - val_loss: 3.1714 - val_accuracy10: 0.3033 - 17s/epoch - 14ms/step
Epoch 12/50
1200/1200 - 17s - loss: 3.0938 - accuracy10: 0.4422 - val_loss: 3.1699 - val_accuracy10: 0.3036 - 17s/epoch - 14ms/step
Epoch 13/50
1200/1200 - 17s - loss: 3.0896 - accuracy10: 0.4433 - val_loss: 3.1666 - val_accuracy10: 0.3072 - 17s/epoch - 14ms/step
Epoch 14/50
1200/1200 - 17s - loss: 3.0834 - accuracy10: 0.4466 - val_loss: 3.1662 - val_accuracy10: 0.3103 - 17s/epoch - 14ms/step
Epoch 15/50
1200/1200 - 16s - loss: 3.0803 - accuracy10: 0.4462 - val_loss: 3.1652 - val_accuracy10: 0.3141 - 16s/epoch - 14ms/step
Epoch 16/50
1200/1200 - 17s - loss: 3.0760 - accuracy10: 0.4477 - val_loss: 3.1658 - val_accuracy10: 0.3173 - 17s/epoch - 14ms/step
Epoch 17/50
1200/1200 - 17s - loss: 3.0694 - accuracy10: 0.4506 - val_loss: 3.1629 - val_accuracy10: 0.3255 - 17s/epoch - 14ms/step
Epoch 18/50
1200/1200 - 17s - loss: 3.0657 - accuracy10: 0.4518 - val_loss: 3.1640 - val_accuracy10: 0.3240 - 17s/epoch - 14ms/step
Epoch 19/50
1200/1200 - 17s - loss: 3.0593 - accuracy10: 0.4540 - val_loss: 3.1643 - val_accuracy10: 0.3247 - 17s/epoch - 14ms/step
Epoch 20/50
1200/1200 - 17s - loss: 3.0545 - accuracy10: 0.4561 - val_loss: 3.1624 - val_accuracy10: 0.3271 - 17s/epoch - 14ms/step
Epoch 21/50
1200/1200 - 17s - loss: 3.0502 - accuracy10: 0.4568 - val_loss: 3.1637 - val_accuracy10: 0.3343 - 17s/epoch - 14ms/step
Epoch 22/50
1200/1200 - 17s - loss: 3.0452 - accuracy10: 0.4583 - val_loss: 3.1604 - val_accuracy10: 0.3388 - 17s/epoch - 14ms/step
Epoch 23/50
1200/1200 - 16s - loss: 3.0419 - accuracy10: 0.4578 - val_loss: 3.1605 - val_accuracy10: 0.3317 - 16s/epoch - 14ms/step
Epoch 24/50
1200/1200 - 17s - loss: 3.0336 - accuracy10: 0.4598 - val_loss: 3.1585 - val_accuracy10: 0.3406 - 17s/epoch - 14ms/step
Epoch 25/50
1200/1200 - 17s - loss: 3.0286 - accuracy10: 0.4616 - val_loss: 3.1595 - val_accuracy10: 0.3460 - 17s/epoch - 14ms/step
Epoch 26/50
1200/1200 - 16s - loss: 3.0242 - accuracy10: 0.4635 - val_loss: 3.1552 - val_accuracy10: 0.3470 - 16s/epoch - 14ms/step
Epoch 27/50
1200/1200 - 18s - loss: 3.0187 - accuracy10: 0.4647 - val_loss: 3.1522 - val_accuracy10: 0.3538 - 18s/epoch - 15ms/step
Epoch 28/50
1200/1200 - 17s - loss: 3.0138 - accuracy10: 0.4653 - val_loss: 3.1552 - val_accuracy10: 0.3554 - 17s/epoch - 14ms/step
Epoch 29/50
1200/1200 - 17s - loss: 3.0091 - accuracy10: 0.4646 - val_loss: 3.1556 - val_accuracy10: 0.3562 - 17s/epoch - 14ms/step
Epoch 30/50
1200/1200 - 17s - loss: 3.0073 - accuracy10: 0.4657 - val_loss: 3.1523 - val_accuracy10: 0.3644 - 17s/epoch - 14ms/step
Epoch 31/50
1200/1200 - 16s - loss: 3.0006 - accuracy10: 0.4673 - val_loss: 3.1468 - val_accuracy10: 0.3601 - 16s/epoch - 13ms/step
Epoch 32/50
1200/1200 - 17s - loss: 2.9943 - accuracy10: 0.4690 - val_loss: 3.1495 - val_accuracy10: 0.3690 - 17s/epoch - 14ms/step
Epoch 33/50
1200/1200 - 16s - loss: 2.9903 - accuracy10: 0.4695 - val_loss: 3.1472 - val_accuracy10: 0.3665 - 16s/epoch - 14ms/step
Epoch 34/50
1200/1200 - 16s - loss: 2.9864 - accuracy10: 0.4709 - val_loss: 3.1480 - val_accuracy10: 0.3620 - 16s/epoch - 14ms/step
Epoch 35/50
1200/1200 - 17s - loss: 2.9780 - accuracy10: 0.4722 - val_loss: 3.1510 - val_accuracy10: 0.3636 - 17s/epoch - 14ms/step
Epoch 36/50
1200/1200 - 16s - loss: 2.9748 - accuracy10: 0.4729 - val_loss: 3.1481 - val_accuracy10: 0.3685 - 16s/epoch - 14ms/step
Epoch 37/50
1200/1200 - 17s - loss: 2.9712 - accuracy10: 0.4738 - val_loss: 3.1461 - val_accuracy10: 0.3779 - 17s/epoch - 14ms/step
Epoch 38/50
1200/1200 - 17s - loss: 2.9644 - accuracy10: 0.4765 - val_loss: 3.1514 - val_accuracy10: 0.3721 - 17s/epoch - 14ms/step
Epoch 39/50
1200/1200 - 17s - loss: 2.9621 - accuracy10: 0.4765 - val_loss: 3.1488 - val_accuracy10: 0.3753 - 17s/epoch - 14ms/step
Epoch 40/50
1200/1200 - 17s - loss: 2.9592 - accuracy10: 0.4755 - val_loss: 3.1468 - val_accuracy10: 0.3738 - 17s/epoch - 14ms/step
Epoch 41/50
1200/1200 - 17s - loss: 2.9549 - accuracy10: 0.4778 - val_loss: 3.1448 - val_accuracy10: 0.3772 - 17s/epoch - 15ms/step
Epoch 42/50
1200/1200 - 17s - loss: 2.9487 - accuracy10: 0.4787 - val_loss: 3.1528 - val_accuracy10: 0.3711 - 17s/epoch - 14ms/step
Epoch 43/50
1200/1200 - 17s - loss: 2.9431 - accuracy10: 0.4811 - val_loss: 3.1555 - val_accuracy10: 0.3904 - 17s/epoch - 14ms/step
Epoch 44/50
1200/1200 - 17s - loss: 2.9393 - accuracy10: 0.4812 - val_loss: 3.1573 - val_accuracy10: 0.3845 - 17s/epoch - 14ms/step
Epoch 45/50
1200/1200 - 16s - loss: 2.9374 - accuracy10: 0.4822 - val_loss: 3.1523 - val_accuracy10: 0.3909 - 16s/epoch - 14ms/step
Epoch 46/50
1200/1200 - 17s - loss: 2.9313 - accuracy10: 0.4845 - val_loss: 3.1523 - val_accuracy10: 0.3823 - 17s/epoch - 14ms/step
Epoch 47/50
1200/1200 - 17s - loss: 2.9268 - accuracy10: 0.4853 - val_loss: 3.1530 - val_accuracy10: 0.3871 - 17s/epoch - 14ms/step
Epoch 48/50
1200/1200 - 17s - loss: 2.9211 - accuracy10: 0.4877 - val_loss: 3.1477 - val_accuracy10: 0.4052 - 17s/epoch - 14ms/step
Epoch 49/50
1200/1200 - 17s - loss: 2.9170 - accuracy10: 0.4881 - val_loss: 3.1576 - val_accuracy10: 0.4031 - 17s/epoch - 14ms/step
Epoch 50/50
1200/1200 - 16s - loss: 2.9126 - accuracy10: 0.4890 - val_loss: 3.1579 - val_accuracy10: 0.4118 - 16s/epoch - 14ms/step
testing model: results/WBA/W9/deepOF_L1/h10
Evaluating performance on  test set...
2451/2451 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0834128
{'0': {'precision': 0.2887889764960753, 'recall': 0.4927946513273803, 'f1-score': 0.36416746183869736, 'support': 132818}, '1': {'precision': 0.6596124089519568, 'recall': 0.19041069400450486, 'f1-score': 0.2955149245371946, 'support': 367159}, '2': {'precision': 0.2667302328422224, 'recall': 0.617203203517588, 'f1-score': 0.37248676747238585, 'support': 127360}, 'accuracy': 0.3410766462045121, 'macro avg': {'precision': 0.4050438727634182, 'recall': 0.43346951628315766, 'f1-score': 0.3440563846160926, 'support': 627337}, 'weighted avg': {'precision': 0.5013410163810403, 'recall': 0.3410766462045121, 'f1-score': 0.3256764272311804, 'support': 627337}}
[[ 65452  19532  47834]
 [128983  69911 168265]
 [ 32208  16545  78607]]
Evaluating performance on  train set...
1200/1200 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0599722
{'0': {'precision': 0.3019153826508896, 'recall': 0.5477120751162108, 'f1-score': 0.38925931413707376, 'support': 64753}, '1': {'precision': 0.6924018064376833, 'recall': 0.21600974437845907, 'f1-score': 0.32929025854286725, 'support': 178154}, '2': {'precision': 0.293586195062631, 'recall': 0.6131409607204624, 'f1-score': 0.39705377862980523, 'support': 64181}, 'accuracy': 0.3689528734434429, 'macro avg': {'precision': 0.4293011280504013, 'recall': 0.45895426007171075, 'f1-score': 0.3718677837699154, 'support': 307088}, 'weighted avg': {'precision': 0.5267113458754715, 'recall': 0.3689528734434429, 'f1-score': 0.3560979056654882, 'support': 307088}}
[[35466  9103 20184]
 [65168 38483 74503]
 [16836  7993 39352]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0670205
{'0': {'precision': 0.30657615415121187, 'recall': 0.5316558113192281, 'f1-score': 0.3888971088687006, 'support': 24719}, '1': {'precision': 0.6863905325443787, 'recall': 0.23640691361097715, 'f1-score': 0.3516859913443958, 'support': 64279}, '2': {'precision': 0.29508883674153535, 'recall': 0.5933602965958881, 'f1-score': 0.3941564983768051, 'support': 23736}, 'accuracy': 0.3763017368318342, 'macro avg': {'precision': 0.4293518411457086, 'recall': 0.4538076738420311, 'f1-score': 0.3782465328633005, 'support': 112734}, 'weighted avg': {'precision': 0.5207211810525751, 'recall': 0.3763017368318342, 'f1-score': 0.3687873234092969, 'support': 112734}}
[[13142  3712  7865]
 [23304 15196 25779]
 [ 6421  3231 14084]]
training model: results/WBA/W9/deepOF_L1/h20
Epoch 1/50
1200/1200 - 18s - loss: 3.2359 - accuracy20: 0.4015 - val_loss: 3.2219 - val_accuracy20: 0.3429 - 18s/epoch - 15ms/step
Epoch 2/50
1200/1200 - 17s - loss: 3.1969 - accuracy20: 0.4131 - val_loss: 3.2117 - val_accuracy20: 0.3353 - 17s/epoch - 14ms/step
Epoch 3/50
1200/1200 - 17s - loss: 3.1836 - accuracy20: 0.4148 - val_loss: 3.2088 - val_accuracy20: 0.3366 - 17s/epoch - 14ms/step
Epoch 4/50
1200/1200 - 17s - loss: 3.1739 - accuracy20: 0.4160 - val_loss: 3.1985 - val_accuracy20: 0.3380 - 17s/epoch - 14ms/step
Epoch 5/50
1200/1200 - 17s - loss: 3.1676 - accuracy20: 0.4179 - val_loss: 3.1959 - val_accuracy20: 0.3375 - 17s/epoch - 14ms/step
Epoch 6/50
1200/1200 - 17s - loss: 3.1626 - accuracy20: 0.4194 - val_loss: 3.1945 - val_accuracy20: 0.3389 - 17s/epoch - 14ms/step
Epoch 7/50
1200/1200 - 17s - loss: 3.1568 - accuracy20: 0.4213 - val_loss: 3.1935 - val_accuracy20: 0.3382 - 17s/epoch - 14ms/step
Epoch 8/50
1200/1200 - 16s - loss: 3.1512 - accuracy20: 0.4229 - val_loss: 3.1938 - val_accuracy20: 0.3388 - 16s/epoch - 14ms/step
Epoch 9/50
1200/1200 - 17s - loss: 3.1468 - accuracy20: 0.4250 - val_loss: 3.1893 - val_accuracy20: 0.3403 - 17s/epoch - 14ms/step
Epoch 10/50
1200/1200 - 17s - loss: 3.1403 - accuracy20: 0.4281 - val_loss: 3.1896 - val_accuracy20: 0.3391 - 17s/epoch - 14ms/step
Epoch 11/50
1200/1200 - 17s - loss: 3.1367 - accuracy20: 0.4293 - val_loss: 3.1859 - val_accuracy20: 0.3409 - 17s/epoch - 14ms/step
Epoch 12/50
1200/1200 - 17s - loss: 3.1317 - accuracy20: 0.4320 - val_loss: 3.1818 - val_accuracy20: 0.3445 - 17s/epoch - 14ms/step
Epoch 13/50
1200/1200 - 17s - loss: 3.1266 - accuracy20: 0.4356 - val_loss: 3.1835 - val_accuracy20: 0.3449 - 17s/epoch - 14ms/step
Epoch 14/50
1200/1200 - 17s - loss: 3.1196 - accuracy20: 0.4382 - val_loss: 3.1808 - val_accuracy20: 0.3462 - 17s/epoch - 14ms/step
Epoch 15/50
1200/1200 - 17s - loss: 3.1157 - accuracy20: 0.4405 - val_loss: 3.1821 - val_accuracy20: 0.3463 - 17s/epoch - 14ms/step
Epoch 16/50
1200/1200 - 17s - loss: 3.1107 - accuracy20: 0.4419 - val_loss: 3.1818 - val_accuracy20: 0.3463 - 17s/epoch - 14ms/step
Epoch 17/50
1200/1200 - 17s - loss: 3.1060 - accuracy20: 0.4451 - val_loss: 3.1787 - val_accuracy20: 0.3505 - 17s/epoch - 14ms/step
Epoch 18/50
1200/1200 - 17s - loss: 3.1004 - accuracy20: 0.4466 - val_loss: 3.1778 - val_accuracy20: 0.3567 - 17s/epoch - 14ms/step
Epoch 19/50
1200/1200 - 16s - loss: 3.0947 - accuracy20: 0.4501 - val_loss: 3.1751 - val_accuracy20: 0.3603 - 16s/epoch - 14ms/step
Epoch 20/50
1200/1200 - 17s - loss: 3.0904 - accuracy20: 0.4513 - val_loss: 3.1728 - val_accuracy20: 0.3606 - 17s/epoch - 14ms/step
Epoch 21/50
1200/1200 - 17s - loss: 3.0852 - accuracy20: 0.4533 - val_loss: 3.1716 - val_accuracy20: 0.3651 - 17s/epoch - 14ms/step
Epoch 22/50
1200/1200 - 17s - loss: 3.0808 - accuracy20: 0.4548 - val_loss: 3.1678 - val_accuracy20: 0.3647 - 17s/epoch - 14ms/step
Epoch 23/50
1200/1200 - 16s - loss: 3.0754 - accuracy20: 0.4568 - val_loss: 3.1653 - val_accuracy20: 0.3680 - 16s/epoch - 14ms/step
Epoch 24/50
1200/1200 - 16s - loss: 3.0695 - accuracy20: 0.4581 - val_loss: 3.1665 - val_accuracy20: 0.3700 - 16s/epoch - 14ms/step
Epoch 25/50
1200/1200 - 16s - loss: 3.0638 - accuracy20: 0.4602 - val_loss: 3.1648 - val_accuracy20: 0.3742 - 16s/epoch - 14ms/step
Epoch 26/50
1200/1200 - 17s - loss: 3.0580 - accuracy20: 0.4621 - val_loss: 3.1639 - val_accuracy20: 0.3792 - 17s/epoch - 14ms/step
Epoch 27/50
1200/1200 - 19s - loss: 3.0541 - accuracy20: 0.4648 - val_loss: 3.1611 - val_accuracy20: 0.3775 - 19s/epoch - 16ms/step
Epoch 28/50
1200/1200 - 17s - loss: 3.0484 - accuracy20: 0.4661 - val_loss: 3.1595 - val_accuracy20: 0.3847 - 17s/epoch - 14ms/step
Epoch 29/50
1200/1200 - 17s - loss: 3.0431 - accuracy20: 0.4664 - val_loss: 3.1625 - val_accuracy20: 0.3810 - 17s/epoch - 14ms/step
Epoch 30/50
1200/1200 - 17s - loss: 3.0401 - accuracy20: 0.4686 - val_loss: 3.1560 - val_accuracy20: 0.3936 - 17s/epoch - 14ms/step
Epoch 31/50
1200/1200 - 17s - loss: 3.0323 - accuracy20: 0.4705 - val_loss: 3.1547 - val_accuracy20: 0.3866 - 17s/epoch - 14ms/step
Epoch 32/50
1200/1200 - 17s - loss: 3.0268 - accuracy20: 0.4723 - val_loss: 3.1496 - val_accuracy20: 0.3911 - 17s/epoch - 14ms/step
Epoch 33/50
1200/1200 - 17s - loss: 3.0216 - accuracy20: 0.4747 - val_loss: 3.1522 - val_accuracy20: 0.3949 - 17s/epoch - 14ms/step
Epoch 34/50
1200/1200 - 16s - loss: 3.0162 - accuracy20: 0.4756 - val_loss: 3.1533 - val_accuracy20: 0.4022 - 16s/epoch - 14ms/step
Epoch 35/50
1200/1200 - 17s - loss: 3.0129 - accuracy20: 0.4766 - val_loss: 3.1518 - val_accuracy20: 0.4039 - 17s/epoch - 14ms/step
Epoch 36/50
1200/1200 - 17s - loss: 3.0072 - accuracy20: 0.4777 - val_loss: 3.1544 - val_accuracy20: 0.4027 - 17s/epoch - 14ms/step
Epoch 37/50
1200/1200 - 17s - loss: 3.0016 - accuracy20: 0.4802 - val_loss: 3.1544 - val_accuracy20: 0.4054 - 17s/epoch - 14ms/step
Epoch 38/50
1200/1200 - 17s - loss: 2.9946 - accuracy20: 0.4824 - val_loss: 3.1621 - val_accuracy20: 0.4039 - 17s/epoch - 14ms/step
Epoch 39/50
1200/1200 - 16s - loss: 2.9930 - accuracy20: 0.4832 - val_loss: 3.1546 - val_accuracy20: 0.4103 - 16s/epoch - 13ms/step
Epoch 40/50
1200/1200 - 17s - loss: 2.9869 - accuracy20: 0.4847 - val_loss: 3.1544 - val_accuracy20: 0.4111 - 17s/epoch - 14ms/step
Epoch 41/50
1200/1200 - 17s - loss: 2.9822 - accuracy20: 0.4860 - val_loss: 3.1537 - val_accuracy20: 0.4107 - 17s/epoch - 14ms/step
Epoch 42/50
1200/1200 - 17s - loss: 2.9756 - accuracy20: 0.4881 - val_loss: 3.1641 - val_accuracy20: 0.4166 - 17s/epoch - 14ms/step
testing model: results/WBA/W9/deepOF_L1/h20
Evaluating performance on  test set...
2451/2451 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0846628
{'0': {'precision': 0.341012055885796, 'recall': 0.5307169052407429, 'f1-score': 0.41522278373225224, 'support': 169060}, '1': {'precision': 0.5514762367196672, 'recall': 0.12823295473694854, 'f1-score': 0.20808142126260928, 'support': 296710}, '2': {'precision': 0.3245844002763891, 'recall': 0.5931223579072459, 'f1-score': 0.4195637944584427, 'support': 161567}, 'accuracy': 0.35642724723713093, 'macro avg': {'precision': 0.4056908976272841, 'recall': 0.4173574059616458, 'f1-score': 0.3476226664844348, 'support': 627337}, 'weighted avg': {'precision': 0.4363239218547614, 'recall': 0.35642724723713093, 'f1-score': 0.3183696576160351, 'support': 627337}}
[[ 89723  16502  62835]
 [122090  38048 136572]
 [ 51295  14443  95829]]
Evaluating performance on  train set...
1200/1200 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0628973
{'0': {'precision': 0.35059123614059917, 'recall': 0.5848993948934914, 'f1-score': 0.4384022566787736, 'support': 81308}, '1': {'precision': 0.6021631387485046, 'recall': 0.16988682936237334, 'f1-score': 0.26500768247214435, 'support': 145179}, '2': {'precision': 0.3506180976540646, 'recall': 0.5675984168930907, 'f1-score': 0.43347135236543144, 'support': 80601}, 'accuracy': 0.38415698431719897, 'macro avg': {'precision': 0.4344574908477228, 'recall': 0.4407948803829851, 'f1-score': 0.37896043050544975, 'support': 307088}, 'weighted avg': {'precision': 0.4695314823031321, 'recall': 0.38415698431719897, 'f1-score': 0.3551339859964157, 'support': 307088}}
[[47557  8191 25560]
 [61343 24664 59172]
 [26748  8104 45749]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.064925
{'0': {'precision': 0.3578324637442997, 'recall': 0.566025474395633, 'f1-score': 0.43847063857635477, 'support': 30776}, '1': {'precision': 0.611665854846566, 'recall': 0.19130865326020718, 'f1-score': 0.2914587443425786, 'support': 52512}, '2': {'precision': 0.35113798605862095, 'recall': 0.5679549004958229, 'f1-score': 0.4339725458650128, 'support': 29446}, 'accuracy': 0.3919846718824844, 'macro avg': {'precision': 0.44021210154982887, 'recall': 0.44176300938388763, 'f1-score': 0.38796730959464876, 'support': 112734}, 'weighted avg': {'precision': 0.4743205990329412, 'recall': 0.3919846718824844, 'f1-score': 0.3688169455646438, 'support': 112734}}
[[17420  3279 10077]
 [21639 10046 20827]
 [ 9623  3099 16724]]
training model: results/WBA/W9/deepOF_L1/h30
Epoch 1/50
1200/1200 - 19s - loss: 3.2552 - accuracy30: 0.3989 - val_loss: 3.2422 - val_accuracy30: 0.3640 - 19s/epoch - 16ms/step
Epoch 2/50
1200/1200 - 17s - loss: 3.2215 - accuracy30: 0.4081 - val_loss: 3.2426 - val_accuracy30: 0.3621 - 17s/epoch - 14ms/step
Epoch 3/50
1200/1200 - 17s - loss: 3.2076 - accuracy30: 0.4102 - val_loss: 3.2403 - val_accuracy30: 0.3632 - 17s/epoch - 14ms/step
Epoch 4/50
1200/1200 - 17s - loss: 3.1997 - accuracy30: 0.4112 - val_loss: 3.2342 - val_accuracy30: 0.3633 - 17s/epoch - 14ms/step
Epoch 5/50
1200/1200 - 18s - loss: 3.1951 - accuracy30: 0.4127 - val_loss: 3.2289 - val_accuracy30: 0.3658 - 18s/epoch - 15ms/step
Epoch 6/50
1200/1200 - 17s - loss: 3.1898 - accuracy30: 0.4147 - val_loss: 3.2258 - val_accuracy30: 0.3657 - 17s/epoch - 14ms/step
Epoch 7/50
1200/1200 - 17s - loss: 3.1855 - accuracy30: 0.4163 - val_loss: 3.2214 - val_accuracy30: 0.3660 - 17s/epoch - 14ms/step
Epoch 8/50
1200/1200 - 16s - loss: 3.1812 - accuracy30: 0.4182 - val_loss: 3.2180 - val_accuracy30: 0.3683 - 16s/epoch - 14ms/step
Epoch 9/50
1200/1200 - 16s - loss: 3.1782 - accuracy30: 0.4195 - val_loss: 3.2182 - val_accuracy30: 0.3688 - 16s/epoch - 14ms/step
Epoch 10/50
1200/1200 - 17s - loss: 3.1730 - accuracy30: 0.4208 - val_loss: 3.2174 - val_accuracy30: 0.3693 - 17s/epoch - 14ms/step
Epoch 11/50
1200/1200 - 17s - loss: 3.1697 - accuracy30: 0.4223 - val_loss: 3.2195 - val_accuracy30: 0.3668 - 17s/epoch - 14ms/step
Epoch 12/50
1200/1200 - 17s - loss: 3.1645 - accuracy30: 0.4252 - val_loss: 3.2191 - val_accuracy30: 0.3689 - 17s/epoch - 14ms/step
Epoch 13/50
1200/1200 - 17s - loss: 3.1617 - accuracy30: 0.4276 - val_loss: 3.2135 - val_accuracy30: 0.3701 - 17s/epoch - 14ms/step
Epoch 14/50
1200/1200 - 16s - loss: 3.1573 - accuracy30: 0.4300 - val_loss: 3.2140 - val_accuracy30: 0.3707 - 16s/epoch - 14ms/step
Epoch 15/50
1200/1200 - 17s - loss: 3.1526 - accuracy30: 0.4319 - val_loss: 3.2158 - val_accuracy30: 0.3703 - 17s/epoch - 14ms/step
Epoch 16/50
1200/1200 - 17s - loss: 3.1479 - accuracy30: 0.4346 - val_loss: 3.2104 - val_accuracy30: 0.3721 - 17s/epoch - 14ms/step
Epoch 17/50
1200/1200 - 17s - loss: 3.1425 - accuracy30: 0.4376 - val_loss: 3.2076 - val_accuracy30: 0.3745 - 17s/epoch - 14ms/step
Epoch 18/50
1200/1200 - 16s - loss: 3.1376 - accuracy30: 0.4391 - val_loss: 3.2053 - val_accuracy30: 0.3761 - 16s/epoch - 14ms/step
Epoch 19/50
1200/1200 - 17s - loss: 3.1321 - accuracy30: 0.4418 - val_loss: 3.2070 - val_accuracy30: 0.3777 - 17s/epoch - 14ms/step
Epoch 20/50
1200/1200 - 17s - loss: 3.1285 - accuracy30: 0.4436 - val_loss: 3.2066 - val_accuracy30: 0.3772 - 17s/epoch - 14ms/step
Epoch 21/50
1200/1200 - 17s - loss: 3.1235 - accuracy30: 0.4452 - val_loss: 3.2065 - val_accuracy30: 0.3792 - 17s/epoch - 14ms/step
Epoch 22/50
1200/1200 - 17s - loss: 3.1179 - accuracy30: 0.4480 - val_loss: 3.2021 - val_accuracy30: 0.3818 - 17s/epoch - 14ms/step
Epoch 23/50
1200/1200 - 17s - loss: 3.1119 - accuracy30: 0.4511 - val_loss: 3.1965 - val_accuracy30: 0.3873 - 17s/epoch - 14ms/step
Epoch 24/50
1200/1200 - 18s - loss: 3.1062 - accuracy30: 0.4527 - val_loss: 3.2004 - val_accuracy30: 0.3864 - 18s/epoch - 15ms/step
Epoch 25/50
1200/1200 - 17s - loss: 3.1013 - accuracy30: 0.4545 - val_loss: 3.1997 - val_accuracy30: 0.3864 - 17s/epoch - 14ms/step
Epoch 26/50
1200/1200 - 17s - loss: 3.0953 - accuracy30: 0.4580 - val_loss: 3.2038 - val_accuracy30: 0.3893 - 17s/epoch - 14ms/step
Epoch 27/50
1200/1200 - 17s - loss: 3.0895 - accuracy30: 0.4598 - val_loss: 3.1971 - val_accuracy30: 0.3952 - 17s/epoch - 14ms/step
Epoch 28/50
1200/1200 - 17s - loss: 3.0831 - accuracy30: 0.4624 - val_loss: 3.1984 - val_accuracy30: 0.3936 - 17s/epoch - 14ms/step
Epoch 29/50
1200/1200 - 17s - loss: 3.0778 - accuracy30: 0.4634 - val_loss: 3.1948 - val_accuracy30: 0.3951 - 17s/epoch - 14ms/step
Epoch 30/50
1200/1200 - 17s - loss: 3.0725 - accuracy30: 0.4653 - val_loss: 3.1942 - val_accuracy30: 0.3987 - 17s/epoch - 14ms/step
Epoch 31/50
1200/1200 - 17s - loss: 3.0665 - accuracy30: 0.4676 - val_loss: 3.2028 - val_accuracy30: 0.4009 - 17s/epoch - 14ms/step
Epoch 32/50
1200/1200 - 17s - loss: 3.0616 - accuracy30: 0.4700 - val_loss: 3.1923 - val_accuracy30: 0.4047 - 17s/epoch - 14ms/step
Epoch 33/50
1200/1200 - 17s - loss: 3.0562 - accuracy30: 0.4718 - val_loss: 3.1948 - val_accuracy30: 0.4068 - 17s/epoch - 14ms/step
Epoch 34/50
1200/1200 - 17s - loss: 3.0509 - accuracy30: 0.4738 - val_loss: 3.1933 - val_accuracy30: 0.4056 - 17s/epoch - 14ms/step
Epoch 35/50
1200/1200 - 17s - loss: 3.0448 - accuracy30: 0.4751 - val_loss: 3.2008 - val_accuracy30: 0.4065 - 17s/epoch - 14ms/step
Epoch 36/50
1200/1200 - 17s - loss: 3.0393 - accuracy30: 0.4782 - val_loss: 3.1987 - val_accuracy30: 0.4095 - 17s/epoch - 14ms/step
Epoch 37/50
1200/1200 - 16s - loss: 3.0319 - accuracy30: 0.4810 - val_loss: 3.1929 - val_accuracy30: 0.4122 - 16s/epoch - 14ms/step
Epoch 38/50
1200/1200 - 17s - loss: 3.0298 - accuracy30: 0.4807 - val_loss: 3.1894 - val_accuracy30: 0.4161 - 17s/epoch - 14ms/step
Epoch 39/50
1200/1200 - 16s - loss: 3.0210 - accuracy30: 0.4834 - val_loss: 3.1993 - val_accuracy30: 0.4123 - 16s/epoch - 14ms/step
Epoch 40/50
1200/1200 - 17s - loss: 3.0181 - accuracy30: 0.4846 - val_loss: 3.2087 - val_accuracy30: 0.4152 - 17s/epoch - 14ms/step
Epoch 41/50
1200/1200 - 17s - loss: 3.0117 - accuracy30: 0.4866 - val_loss: 3.2003 - val_accuracy30: 0.4162 - 17s/epoch - 14ms/step
Epoch 42/50
1200/1200 - 17s - loss: 3.0088 - accuracy30: 0.4882 - val_loss: 3.1966 - val_accuracy30: 0.4150 - 17s/epoch - 14ms/step
Epoch 43/50
1200/1200 - 16s - loss: 3.0037 - accuracy30: 0.4892 - val_loss: 3.1964 - val_accuracy30: 0.4142 - 16s/epoch - 14ms/step
Epoch 44/50
1200/1200 - 17s - loss: 2.9975 - accuracy30: 0.4901 - val_loss: 3.2067 - val_accuracy30: 0.4200 - 17s/epoch - 15ms/step
Epoch 45/50
1200/1200 - 17s - loss: 2.9925 - accuracy30: 0.4930 - val_loss: 3.1969 - val_accuracy30: 0.4199 - 17s/epoch - 14ms/step
Epoch 46/50
1200/1200 - 17s - loss: 2.9880 - accuracy30: 0.4942 - val_loss: 3.1997 - val_accuracy30: 0.4249 - 17s/epoch - 14ms/step
Epoch 47/50
1200/1200 - 17s - loss: 2.9845 - accuracy30: 0.4950 - val_loss: 3.2021 - val_accuracy30: 0.4198 - 17s/epoch - 14ms/step
Epoch 48/50
1200/1200 - 16s - loss: 2.9788 - accuracy30: 0.4973 - val_loss: 3.2091 - val_accuracy30: 0.4223 - 16s/epoch - 14ms/step
testing model: results/WBA/W9/deepOF_L1/h30
Evaluating performance on  test set...
2451/2451 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0873476
{'0': {'precision': 0.38983647006325955, 'recall': 0.3844855438654627, 'f1-score': 0.38714251826672674, 'support': 193136}, '1': {'precision': 0.4515006494363448, 'recall': 0.259889332235185, 'f1-score': 0.3298899487171679, 'support': 250118}, '2': {'precision': 0.3572918693940542, 'recall': 0.5684609659773037, 'f1-score': 0.43879202623258773, 'support': 184083}, 'accuracy': 0.38879422065014496, 'macro avg': {'precision': 0.39954299629788625, 'recall': 0.4042786140259838, 'f1-score': 0.38527483107216076, 'support': 627337}, 'weighted avg': {'precision': 0.40487211038329174, 'recall': 0.38879422065014496, 'f1-score': 0.3794718375708377, 'support': 627337}}
[[ 74258  42916  75962]
 [ 72840  65003 112275]
 [ 43387  36052 104644]]
Evaluating performance on  train set...
1200/1200 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0565628
{'0': {'precision': 0.4031004876963302, 'recall': 0.4727142251361842, 'f1-score': 0.43514074815463527, 'support': 91971}, '1': {'precision': 0.5043608593248162, 'recall': 0.2854799744681539, 'f1-score': 0.3645922547492029, 'support': 123767}, '2': {'precision': 0.39034208346557875, 'recall': 0.5519868637110017, 'f1-score': 0.4573004004008543, 'support': 91350}, 'accuracy': 0.4208337675194081, 'macro avg': {'precision': 0.43260114349557505, 'recall': 0.43672702110511324, 'f1-score': 0.4190111344348975, 'support': 307088}, 'weighted avg': {'precision': 0.4401166270077448, 'recall': 0.4208337675194081, 'f1-score': 0.4132991550262225, 'support': 307088}}
[[43476 18335 30160]
 [39839 35333 48595]
 [24539 16387 50424]]
Evaluating performance on  val set...
441/441 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0642524
{'0': {'precision': 0.40366698221314334, 'recall': 0.46809371118236703, 'f1-score': 0.43349964552762876, 'support': 34617}, '1': {'precision': 0.5042920114453638, 'recall': 0.2890770458373969, 'f1-score': 0.3674941531178675, 'support': 45116}, '2': {'precision': 0.3815750053498823, 'recall': 0.5403169600921184, 'f1-score': 0.4472789755553047, 'support': 33001}, 'accuracy': 0.4175936274770699, 'macro avg': {'precision': 0.4298446663361298, 'recall': 0.43249590570396074, 'f1-score': 0.41609092473360026, 'support': 112734}, 'weighted avg': {'precision': 0.4374699297744504, 'recall': 0.4175936274770699, 'f1-score': 0.4111180026752909, 'support': 112734}}
[[16204  6813 11600]
 [14775 13042 17299]
 [ 9163  6007 17831]]
training model: results/WBA/W9/deepOF_L1/h50
Epoch 1/50
1200/1200 - 19s - loss: 3.2754 - accuracy50: 0.3919 - val_loss: 3.2710 - val_accuracy50: 0.3901 - 19s/epoch - 16ms/step
Epoch 2/50
1200/1200 - 17s - loss: 3.2461 - accuracy50: 0.4027 - val_loss: 3.2659 - val_accuracy50: 0.3900 - 17s/epoch - 14ms/step
Epoch 3/50
1200/1200 - 16s - loss: 3.2359 - accuracy50: 0.4015 - val_loss: 3.2653 - val_accuracy50: 0.3946 - 16s/epoch - 14ms/step
Epoch 4/50
1200/1200 - 17s - loss: 3.2303 - accuracy50: 0.4033 - val_loss: 3.2625 - val_accuracy50: 0.3958 - 17s/epoch - 14ms/step
Epoch 5/50
1200/1200 - 17s - loss: 3.2257 - accuracy50: 0.4041 - val_loss: 3.2615 - val_accuracy50: 0.3951 - 17s/epoch - 15ms/step
Epoch 6/50
1200/1200 - 17s - loss: 3.2205 - accuracy50: 0.4075 - val_loss: 3.2506 - val_accuracy50: 0.3962 - 17s/epoch - 14ms/step
Epoch 7/50
1200/1200 - 16s - loss: 3.2162 - accuracy50: 0.4099 - val_loss: 3.2500 - val_accuracy50: 0.3977 - 16s/epoch - 14ms/step
Epoch 8/50
1200/1200 - 17s - loss: 3.2124 - accuracy50: 0.4124 - val_loss: 3.2532 - val_accuracy50: 0.3963 - 17s/epoch - 14ms/step
Epoch 9/50
1200/1200 - 16s - loss: 3.2104 - accuracy50: 0.4140 - val_loss: 3.2590 - val_accuracy50: 0.3949 - 16s/epoch - 13ms/step
Epoch 10/50
1200/1200 - 17s - loss: 3.2059 - accuracy50: 0.4160 - val_loss: 3.2592 - val_accuracy50: 0.3950 - 17s/epoch - 14ms/step
Epoch 11/50
1200/1200 - 17s - loss: 3.2027 - accuracy50: 0.4184 - val_loss: 3.2603 - val_accuracy50: 0.3969 - 17s/epoch - 14ms/step
Epoch 12/50
1200/1200 - 16s - loss: 3.1982 - accuracy50: 0.4205 - val_loss: 3.2604 - val_accuracy50: 0.3962 - 16s/epoch - 14ms/step
Epoch 13/50
1200/1200 - 16s - loss: 3.1940 - accuracy50: 0.4234 - val_loss: 3.2522 - val_accuracy50: 0.3981 - 16s/epoch - 14ms/step
Epoch 14/50
1200/1200 - 17s - loss: 3.1908 - accuracy50: 0.4247 - val_loss: 3.2491 - val_accuracy50: 0.3980 - 17s/epoch - 14ms/step
Epoch 15/50
1200/1200 - 17s - loss: 3.1857 - accuracy50: 0.4279 - val_loss: 3.2550 - val_accuracy50: 0.3963 - 17s/epoch - 14ms/step
Epoch 16/50
1200/1200 - 16s - loss: 3.1834 - accuracy50: 0.4296 - val_loss: 3.2507 - val_accuracy50: 0.3970 - 16s/epoch - 14ms/step
Epoch 17/50
1200/1200 - 16s - loss: 3.1789 - accuracy50: 0.4315 - val_loss: 3.2439 - val_accuracy50: 0.3989 - 16s/epoch - 14ms/step
Epoch 18/50
1200/1200 - 16s - loss: 3.1746 - accuracy50: 0.4343 - val_loss: 3.2450 - val_accuracy50: 0.3990 - 16s/epoch - 14ms/step
Epoch 19/50
1200/1200 - 16s - loss: 3.1700 - accuracy50: 0.4354 - val_loss: 3.2482 - val_accuracy50: 0.3977 - 16s/epoch - 14ms/step
Epoch 20/50
1200/1200 - 17s - loss: 3.1649 - accuracy50: 0.4378 - val_loss: 3.2499 - val_accuracy50: 0.3987 - 17s/epoch - 14ms/step
Epoch 21/50
1200/1200 - 17s - loss: 3.1612 - accuracy50: 0.4390 - val_loss: 3.2428 - val_accuracy50: 0.3985 - 17s/epoch - 14ms/step
Epoch 22/50
1200/1200 - 17s - loss: 3.1557 - accuracy50: 0.4420 - val_loss: 3.2442 - val_accuracy50: 0.3994 - 17s/epoch - 14ms/step
Epoch 23/50
1200/1200 - 16s - loss: 3.1512 - accuracy50: 0.4431 - val_loss: 3.2476 - val_accuracy50: 0.4005 - 16s/epoch - 14ms/step
Epoch 24/50
1200/1200 - 17s - loss: 3.1480 - accuracy50: 0.4445 - val_loss: 3.2441 - val_accuracy50: 0.4011 - 17s/epoch - 14ms/step
Epoch 25/50
1200/1200 - 16s - loss: 3.1416 - accuracy50: 0.4474 - val_loss: 3.2413 - val_accuracy50: 0.4008 - 16s/epoch - 14ms/step
Epoch 26/50
1200/1200 - 17s - loss: 3.1373 - accuracy50: 0.4488 - val_loss: 3.2409 - val_accuracy50: 0.4025 - 17s/epoch - 14ms/step
Epoch 27/50
1200/1200 - 17s - loss: 3.1323 - accuracy50: 0.4516 - val_loss: 3.2393 - val_accuracy50: 0.4008 - 17s/epoch - 14ms/step
Epoch 28/50
1200/1200 - 17s - loss: 3.1293 - accuracy50: 0.4528 - val_loss: 3.2382 - val_accuracy50: 0.4034 - 17s/epoch - 14ms/step
Epoch 29/50
1200/1200 - 17s - loss: 3.1233 - accuracy50: 0.4552 - val_loss: 3.2397 - val_accuracy50: 0.4023 - 17s/epoch - 14ms/step
Epoch 30/50
1200/1200 - 18s - loss: 3.1191 - accuracy50: 0.4566 - val_loss: 3.2386 - val_accuracy50: 0.4033 - 18s/epoch - 15ms/step
Epoch 31/50
1200/1200 - 17s - loss: 3.1131 - accuracy50: 0.4595 - val_loss: 3.2366 - val_accuracy50: 0.4043 - 17s/epoch - 14ms/step
Epoch 32/50
1200/1200 - 17s - loss: 3.1090 - accuracy50: 0.4598 - val_loss: 3.2344 - val_accuracy50: 0.4043 - 17s/epoch - 14ms/step
Epoch 33/50
1200/1200 - 16s - loss: 3.1046 - accuracy50: 0.4610 - val_loss: 3.2350 - val_accuracy50: 0.4054 - 16s/epoch - 14ms/step
Epoch 34/50
1200/1200 - 17s - loss: 3.0994 - accuracy50: 0.4633 - val_loss: 3.2358 - val_accuracy50: 0.4050 - 17s/epoch - 14ms/step
Epoch 35/50
1200/1200 - 17s - loss: 3.0948 - accuracy50: 0.4653 - val_loss: 3.2394 - val_accuracy50: 0.4032 - 17s/epoch - 14ms/step
Epoch 36/50
1200/1200 - 17s - loss: 3.0898 - accuracy50: 0.4670 - val_loss: 3.2367 - val_accuracy50: 0.4036 - 17s/epoch - 14ms/step
Epoch 37/50
1200/1200 - 16s - loss: 3.0856 - accuracy50: 0.4676 - val_loss: 3.2385 - val_accuracy50: 0.4041 - 16s/epoch - 14ms/step
Epoch 38/50
1200/1200 - 16s - loss: 3.0815 - accuracy50: 0.4694 - val_loss: 3.2399 - val_accuracy50: 0.4053 - 16s/epoch - 14ms/step
Epoch 39/50
1200/1200 - 16s - loss: 3.0801 - accuracy50: 0.4700 - val_loss: 3.2372 - val_accuracy50: 0.4053 - 16s/epoch - 14ms/step
Epoch 40/50
1200/1200 - 17s - loss: 3.0704 - accuracy50: 0.4734 - val_loss: 3.2458 - val_accuracy50: 0.4042 - 17s/epoch - 14ms/step
Epoch 41/50
1200/1200 - 17s - loss: 3.0659 - accuracy50: 0.4764 - val_loss: 3.2454 - val_accuracy50: 0.4054 - 17s/epoch - 14ms/step
Epoch 42/50
1200/1200 - 17s - loss: 3.0612 - accuracy50: 0.4767 - val_loss: 3.2506 - val_accuracy50: 0.4060 - 17s/epoch - 14ms/step
testing model: results/WBA/W9/deepOF_L1/h50
Evaluating performance on  test set...
2451/2451 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0892982
{'0': {'precision': 0.40893477978922355, 'recall': 0.45126292122381706, 'f1-score': 0.4290574204055116, 'support': 216601}, '1': {'precision': 0.35413235151632594, 'recall': 0.09043582396809137, 'f1-score': 0.14407801893709446, 'support': 202077}, '2': {'precision': 0.385606647837463, 'recall': 0.622249699270101, 'f1-score': 0.476146469369419, 'support': 208659}, 'accuracy': 0.39190578588541725, 'macro avg': {'precision': 0.38289125971433746, 'recall': 0.3879828148206698, 'f1-score': 0.3497606362373417, 'support': 627337}, 'weighted avg': {'precision': 0.38352270464775295, 'recall': 0.39190578588541725, 'f1-score': 0.35292253812888297, 'support': 627337}}
[[ 97744  16908 101949]
 [ 78878  18275 104924]
 [ 62399  16422 129838]]
Evaluating performance on  train set...
1200/1200 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0707351
{'0': {'precision': 0.41545447777860495, 'recall': 0.5409114699439781, 'f1-score': 0.46995419024521695, 'support': 103174}, '1': {'precision': 0.3886955145953643, 'recall': 0.0971460205423253, 'f1-score': 0.15544254541715768, 'support': 101157}, '2': {'precision': 0.4109143182619545, 'recall': 0.5897408449059431, 'f1-score': 0.4843485871168071, 'support': 102757}, 'accuracy': 0.4110710936278852, 'macro avg': {'precision': 0.4050214368786413, 'recall': 0.4092661117974155, 'f1-score': 0.3699151075930606, 'support': 307088}, 'weighted avg': {'precision': 0.4051206659390686, 'recall': 0.4110710936278852, 'f1-score': 0.3711684043579859, 'support': 307088}}
[[55808  7733 39633]
 [44087  9827 47243]
 [34435  7722 60600]]
Evaluating performance on  val set...
441/441 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0778176
{'0': {'precision': 0.4113881742864667, 'recall': 0.5287287495769442, 'f1-score': 0.4627355373783864, 'support': 38411}, '1': {'precision': 0.3998458425667213, 'recall': 0.1100678973053257, 'f1-score': 0.17261818106191376, 'support': 37704}, '2': {'precision': 0.39865629953951837, 'recall': 0.5768590076189956, 'f1-score': 0.47148102268795966, 'support': 36619}, 'accuracy': 0.4043411925417354, 'macro avg': {'precision': 0.40329677213090215, 'recall': 0.40521855150042185, 'f1-score': 0.3689449137094199, 'support': 112734}, 'weighted avg': {'precision': 0.40339217843322117, 'recall': 0.4043411925417354, 'f1-score': 0.3685462610641865, 'support': 112734}}
[[20309  3191 14911]
 [16601  4150 16953]
 [12457  3038 21124]]
training model: results/WBA/W9/deepOF_L1/h100
Epoch 1/50
1200/1200 - 19s - loss: 3.2854 - accuracy100: 0.3816 - val_loss: 3.2794 - val_accuracy100: 0.3711 - 19s/epoch - 16ms/step
Epoch 2/50
1200/1200 - 17s - loss: 3.2635 - accuracy100: 0.3916 - val_loss: 3.2753 - val_accuracy100: 0.3764 - 17s/epoch - 14ms/step
Epoch 3/50
1200/1200 - 17s - loss: 3.2569 - accuracy100: 0.3939 - val_loss: 3.2770 - val_accuracy100: 0.3775 - 17s/epoch - 14ms/step
Epoch 4/50
1200/1200 - 17s - loss: 3.2540 - accuracy100: 0.3945 - val_loss: 3.2770 - val_accuracy100: 0.3791 - 17s/epoch - 14ms/step
Epoch 5/50
1200/1200 - 17s - loss: 3.2514 - accuracy100: 0.3955 - val_loss: 3.2777 - val_accuracy100: 0.3779 - 17s/epoch - 14ms/step
Epoch 6/50
1200/1200 - 18s - loss: 3.2496 - accuracy100: 0.3962 - val_loss: 3.2763 - val_accuracy100: 0.3783 - 18s/epoch - 15ms/step
Epoch 7/50
1200/1200 - 17s - loss: 3.2479 - accuracy100: 0.3971 - val_loss: 3.2780 - val_accuracy100: 0.3779 - 17s/epoch - 14ms/step
Epoch 8/50
1200/1200 - 17s - loss: 3.2453 - accuracy100: 0.3984 - val_loss: 3.2777 - val_accuracy100: 0.3785 - 17s/epoch - 14ms/step
Epoch 9/50
1200/1200 - 16s - loss: 3.2429 - accuracy100: 0.3997 - val_loss: 3.2791 - val_accuracy100: 0.3786 - 16s/epoch - 14ms/step
Epoch 10/50
1200/1200 - 17s - loss: 3.2420 - accuracy100: 0.4005 - val_loss: 3.2803 - val_accuracy100: 0.3765 - 17s/epoch - 14ms/step
Epoch 11/50
1200/1200 - 17s - loss: 3.2392 - accuracy100: 0.4022 - val_loss: 3.2795 - val_accuracy100: 0.3788 - 17s/epoch - 14ms/step
Epoch 12/50
1200/1200 - 18s - loss: 3.2373 - accuracy100: 0.4031 - val_loss: 3.2809 - val_accuracy100: 0.3787 - 18s/epoch - 15ms/step
testing model: results/WBA/W9/deepOF_L1/h100
Evaluating performance on  test set...
2451/2451 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0922582
{'0': {'precision': 0.38435815396840206, 'recall': 0.5813968311782918, 'f1-score': 0.46277703183861624, 'support': 219640}, '1': {'precision': 0.3522072936660269, 'recall': 0.0018572028601936148, 'f1-score': 0.0036949222505801636, 'support': 197609}, '2': {'precision': 0.37689843500261855, 'recall': 0.5275408400289403, 'f1-score': 0.4396742213565118, 'support': 210088}, 'accuracy': 0.3808080824182218, 'macro avg': {'precision': 0.3711546275456825, 'recall': 0.3702649580224753, 'f1-score': 0.3020487251485694, 'support': 627337}, 'weighted avg': {'precision': 0.3717325686903528, 'recall': 0.3808080824182218, 'f1-score': 0.310430876833975, 'support': 627337}}
[[127698    353  91589]
 [105603    367  91639]
 [ 98936    322 110830]]
Evaluating performance on  train set...
1200/1200 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0918626
{'0': {'precision': 0.3747531618787907, 'recall': 0.6213337750667473, 'f1-score': 0.4675230407144271, 'support': 102626}, '1': {'precision': 0.3683806600153492, 'recall': 0.004675218420360576, 'f1-score': 0.009233255107144232, 'support': 102669}, '2': {'precision': 0.38242905487602574, 'recall': 0.5095635259791931, 'f1-score': 0.4369361401026004, 'support': 101793}, 'accuracy': 0.37811637055176367, 'macro avg': {'precision': 0.37518762559005525, 'recall': 0.37852417315543363, 'f1-score': 0.30456414530805725, 'support': 307088}, 'weighted avg': {'precision': 0.37516702950647357, 'recall': 0.37811637055176367, 'f1-score': 0.30416372230246114, 'support': 307088}}
[[63765   395 38466]
 [56892   480 45297]
 [49495   428 51870]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0925214
{'0': {'precision': 0.37827469587602847, 'recall': 0.5948878069432684, 'f1-score': 0.46247364361018256, 'support': 37792}, '1': {'precision': 0.4746450304259635, 'recall': 0.01202652001850234, 'f1-score': 0.023458646616541352, 'support': 38914}, '2': {'precision': 0.36954984230144317, 'recall': 0.5366104141223493, 'f1-score': 0.4376804047858914, 'support': 36028}, 'accuracy': 0.37506874589742223, 'macro avg': {'precision': 0.4074898562011451, 'recall': 0.3811749136947067, 'f1-score': 0.30787089833753845, 'support': 112734}, 'weighted avg': {'precision': 0.40875189152322466, 'recall': 0.37506874589742223, 'f1-score': 0.30300905971027553, 'support': 112734}}
[[22482   228 15082]
 [20546   468 17900]
 [16405   290 19333]]
training model: results/WBA/W9/deepOF_L1/h200
Epoch 1/50
1200/1200 - 20s - loss: 3.3105 - accuracy200: 0.3576 - val_loss: 3.2959 - val_accuracy200: 0.3494 - 20s/epoch - 17ms/step
Epoch 2/50
1200/1200 - 17s - loss: 3.2905 - accuracy200: 0.3637 - val_loss: 3.2870 - val_accuracy200: 0.3582 - 17s/epoch - 14ms/step
Epoch 3/50
1200/1200 - 17s - loss: 3.2841 - accuracy200: 0.3685 - val_loss: 3.2845 - val_accuracy200: 0.3590 - 17s/epoch - 14ms/step
Epoch 4/50
1200/1200 - 17s - loss: 3.2804 - accuracy200: 0.3699 - val_loss: 3.2830 - val_accuracy200: 0.3628 - 17s/epoch - 14ms/step
Epoch 5/50
1200/1200 - 17s - loss: 3.2781 - accuracy200: 0.3714 - val_loss: 3.2839 - val_accuracy200: 0.3619 - 17s/epoch - 14ms/step
Epoch 6/50
1200/1200 - 18s - loss: 3.2764 - accuracy200: 0.3728 - val_loss: 3.2829 - val_accuracy200: 0.3626 - 18s/epoch - 15ms/step
Epoch 7/50
1200/1200 - 17s - loss: 3.2750 - accuracy200: 0.3737 - val_loss: 3.2846 - val_accuracy200: 0.3621 - 17s/epoch - 14ms/step
Epoch 8/50
1200/1200 - 17s - loss: 3.2740 - accuracy200: 0.3744 - val_loss: 3.2825 - val_accuracy200: 0.3632 - 17s/epoch - 14ms/step
Epoch 9/50
1200/1200 - 17s - loss: 3.2722 - accuracy200: 0.3770 - val_loss: 3.2833 - val_accuracy200: 0.3644 - 17s/epoch - 14ms/step
Epoch 10/50
1200/1200 - 17s - loss: 3.2716 - accuracy200: 0.3778 - val_loss: 3.2827 - val_accuracy200: 0.3653 - 17s/epoch - 14ms/step
Epoch 11/50
1200/1200 - 18s - loss: 3.2697 - accuracy200: 0.3774 - val_loss: 3.2825 - val_accuracy200: 0.3642 - 18s/epoch - 15ms/step
Epoch 12/50
1200/1200 - 16s - loss: 3.2691 - accuracy200: 0.3786 - val_loss: 3.2826 - val_accuracy200: 0.3667 - 16s/epoch - 14ms/step
Epoch 13/50
1200/1200 - 16s - loss: 3.2680 - accuracy200: 0.3794 - val_loss: 3.2830 - val_accuracy200: 0.3653 - 16s/epoch - 14ms/step
Epoch 14/50
1200/1200 - 17s - loss: 3.2663 - accuracy200: 0.3807 - val_loss: 3.2842 - val_accuracy200: 0.3640 - 17s/epoch - 14ms/step
Epoch 15/50
1200/1200 - 17s - loss: 3.2656 - accuracy200: 0.3809 - val_loss: 3.2835 - val_accuracy200: 0.3650 - 17s/epoch - 14ms/step
Epoch 16/50
1200/1200 - 18s - loss: 3.2649 - accuracy200: 0.3815 - val_loss: 3.2838 - val_accuracy200: 0.3630 - 18s/epoch - 15ms/step
Epoch 17/50
1200/1200 - 17s - loss: 3.2633 - accuracy200: 0.3831 - val_loss: 3.2850 - val_accuracy200: 0.3640 - 17s/epoch - 14ms/step
Epoch 18/50
1200/1200 - 17s - loss: 3.2626 - accuracy200: 0.3827 - val_loss: 3.2864 - val_accuracy200: 0.3650 - 17s/epoch - 14ms/step
Epoch 19/50
1200/1200 - 17s - loss: 3.2617 - accuracy200: 0.3840 - val_loss: 3.2867 - val_accuracy200: 0.3650 - 17s/epoch - 14ms/step
Epoch 20/50
1200/1200 - 17s - loss: 3.2599 - accuracy200: 0.3856 - val_loss: 3.2859 - val_accuracy200: 0.3658 - 17s/epoch - 14ms/step
Epoch 21/50
1200/1200 - 17s - loss: 3.2588 - accuracy200: 0.3864 - val_loss: 3.2870 - val_accuracy200: 0.3635 - 17s/epoch - 14ms/step
testing model: results/WBA/W9/deepOF_L1/h200
Evaluating performance on  test set...
2451/2451 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.097311
{'0': {'precision': 0.3639063495487541, 'recall': 0.3490957390492507, 'f1-score': 0.3563472199365806, 'support': 207794}, '1': {'precision': 0.3612491760639909, 'recall': 0.09317135479365196, 'f1-score': 0.1481362432654552, 'support': 217642}, '2': {'precision': 0.3425579575493389, 'recall': 0.6309329820060326, 'f1-score': 0.44403312837244324, 'support': 201901}, 'accuracy': 0.35101388886674945, 'macro avg': {'precision': 0.35590449438736127, 'recall': 0.3577333586163118, 'f1-score': 0.316172197191493, 'support': 627337}, 'weighted avg': {'precision': 0.35611376877535034, 'recall': 0.35101388886674945, 'f1-score': 0.3123332676500935, 'support': 627337}}
[[ 72540  18935 116319]
 [ 69202  20278 128162]
 [ 57595  16920 127386]]
Evaluating performance on  train set...
1200/1200 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0919759
{'0': {'precision': 0.3798253842268562, 'recall': 0.40507108366518535, 'f1-score': 0.3920422279527449, 'support': 103962}, '1': {'precision': 0.35418521816562776, 'recall': 0.11059473093613767, 'f1-score': 0.16855726663891935, 'support': 100701}, '2': {'precision': 0.36823610807661494, 'recall': 0.5923846717110081, 'f1-score': 0.4541592907105993, 'support': 102425}, 'accuracy': 0.37098160787787215, 'macro avg': {'precision': 0.36741557015636633, 'recall': 0.36935016210411037, 'f1-score': 0.33825292843408783, 'support': 307088}, 'weighted avg': {'precision': 0.3675519578076531, 'recall': 0.37098160787787215, 'f1-score': 0.33947482402849416, 'support': 307088}}
[[42112 10772 51078]
 [36545 11137 53019]
 [32215  9535 60675]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.093999
{'0': {'precision': 0.38361831941134883, 'recall': 0.38138130320464425, 'f1-score': 0.3824965405602987, 'support': 38413}, '1': {'precision': 0.3413847364280094, 'recall': 0.11460644479661912, 'f1-score': 0.17160371761914178, 'support': 37860}, '2': {'precision': 0.3568367429449341, 'recall': 0.6051671649159376, 'f1-score': 0.44895010987222267, 'support': 36461}, 'accuracy': 0.36416697713200985, 'macro avg': {'precision': 0.3606132662614308, 'recall': 0.36705163763906695, 'f1-score': 0.3343501226838877, 'support': 112734}, 'weighted avg': {'precision': 0.36077297983951445, 'recall': 0.36416697713200985, 'f1-score': 0.3331641414094645, 'support': 112734}}
[[14650  4523 19240]
 [12991  4339 20530]
 [10548  3848 22065]]
training model: results/WBA/W9/deepOF_L1/h300
Epoch 1/50
1200/1200 - 19s - loss: 3.3155 - accuracy300: 0.3545 - val_loss: 3.3013 - val_accuracy300: 0.3414 - 19s/epoch - 16ms/step
Epoch 2/50
1200/1200 - 17s - loss: 3.2957 - accuracy300: 0.3595 - val_loss: 3.2956 - val_accuracy300: 0.3430 - 17s/epoch - 14ms/step
Epoch 3/50
1200/1200 - 18s - loss: 3.2905 - accuracy300: 0.3623 - val_loss: 3.2947 - val_accuracy300: 0.3469 - 18s/epoch - 15ms/step
Epoch 4/50
1200/1200 - 18s - loss: 3.2876 - accuracy300: 0.3632 - val_loss: 3.2940 - val_accuracy300: 0.3470 - 18s/epoch - 15ms/step
Epoch 5/50
1200/1200 - 17s - loss: 3.2858 - accuracy300: 0.3645 - val_loss: 3.2933 - val_accuracy300: 0.3509 - 17s/epoch - 14ms/step
Epoch 6/50
1200/1200 - 17s - loss: 3.2841 - accuracy300: 0.3663 - val_loss: 3.2929 - val_accuracy300: 0.3514 - 17s/epoch - 14ms/step
Epoch 7/50
1200/1200 - 17s - loss: 3.2829 - accuracy300: 0.3674 - val_loss: 3.2930 - val_accuracy300: 0.3531 - 17s/epoch - 14ms/step
Epoch 8/50
1200/1200 - 16s - loss: 3.2825 - accuracy300: 0.3673 - val_loss: 3.2933 - val_accuracy300: 0.3524 - 16s/epoch - 14ms/step
Epoch 9/50
1200/1200 - 17s - loss: 3.2812 - accuracy300: 0.3688 - val_loss: 3.2929 - val_accuracy300: 0.3545 - 17s/epoch - 14ms/step
Epoch 10/50
1200/1200 - 16s - loss: 3.2802 - accuracy300: 0.3703 - val_loss: 3.2921 - val_accuracy300: 0.3538 - 16s/epoch - 14ms/step
Epoch 11/50
1200/1200 - 17s - loss: 3.2794 - accuracy300: 0.3709 - val_loss: 3.2920 - val_accuracy300: 0.3552 - 17s/epoch - 14ms/step
Epoch 12/50
1200/1200 - 17s - loss: 3.2788 - accuracy300: 0.3720 - val_loss: 3.2928 - val_accuracy300: 0.3555 - 17s/epoch - 14ms/step
Epoch 13/50
1200/1200 - 17s - loss: 3.2779 - accuracy300: 0.3724 - val_loss: 3.2937 - val_accuracy300: 0.3532 - 17s/epoch - 14ms/step
Epoch 14/50
1200/1200 - 17s - loss: 3.2772 - accuracy300: 0.3736 - val_loss: 3.2943 - val_accuracy300: 0.3541 - 17s/epoch - 14ms/step
Epoch 15/50
1200/1200 - 17s - loss: 3.2759 - accuracy300: 0.3745 - val_loss: 3.2952 - val_accuracy300: 0.3539 - 17s/epoch - 14ms/step
Epoch 16/50
1200/1200 - 17s - loss: 3.2750 - accuracy300: 0.3748 - val_loss: 3.2944 - val_accuracy300: 0.3545 - 17s/epoch - 14ms/step
Epoch 17/50
1200/1200 - 17s - loss: 3.2740 - accuracy300: 0.3760 - val_loss: 3.2956 - val_accuracy300: 0.3537 - 17s/epoch - 14ms/step
Epoch 18/50
1200/1200 - 17s - loss: 3.2733 - accuracy300: 0.3766 - val_loss: 3.2965 - val_accuracy300: 0.3555 - 17s/epoch - 14ms/step
Epoch 19/50
1200/1200 - 18s - loss: 3.2727 - accuracy300: 0.3770 - val_loss: 3.2966 - val_accuracy300: 0.3549 - 18s/epoch - 15ms/step
Epoch 20/50
1200/1200 - 18s - loss: 3.2714 - accuracy300: 0.3777 - val_loss: 3.2983 - val_accuracy300: 0.3534 - 18s/epoch - 15ms/step
Epoch 21/50
1200/1200 - 18s - loss: 3.2706 - accuracy300: 0.3778 - val_loss: 3.2978 - val_accuracy300: 0.3548 - 18s/epoch - 15ms/step
testing model: results/WBA/W9/deepOF_L1/h300
Evaluating performance on  test set...
2451/2451 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988957
{'0': {'precision': 0.36796793825144725, 'recall': 0.2114005249244355, 'f1-score': 0.2685289940543533, 'support': 211078}, '1': {'precision': 0.34865367288984184, 'recall': 0.1431950611732524, 'f1-score': 0.20301153814227607, 'support': 213492}, '2': {'precision': 0.3344264175836783, 'recall': 0.6900531151518738, 'f1-score': 0.4505155717976995, 'support': 202767}, 'accuracy': 0.342898633429879, 'macro avg': {'precision': 0.3503493429083225, 'recall': 0.34821623374985394, 'f1-score': 0.3073520346647763, 'support': 627337}, 'weighted avg': {'precision': 0.350553765865917, 'recall': 0.342898633429879, 'f1-score': 0.3050538916958186, 'support': 627337}}
[[ 44622  29767 136689]
 [ 41142  30571 141779]
 [ 35502  27345 139920]]
Evaluating performance on  train set...
1200/1200 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0949699
{'0': {'precision': 0.39268191506100786, 'recall': 0.25847150429812915, 'f1-score': 0.3117455342440863, 'support': 106209}, '1': {'precision': 0.33401189793861297, 'recall': 0.17407605784681307, 'f1-score': 0.22887168965540589, 'support': 97084}, '2': {'precision': 0.360838666109271, 'recall': 0.6486439616551857, 'f1-score': 0.46371441264287466, 'support': 103795}, 'accuracy': 0.36366774344813213, 'macro avg': {'precision': 0.3625108263696306, 'recall': 0.36039717460004267, 'f1-score': 0.334777212180789, 'support': 307088}, 'weighted avg': {'precision': 0.3633708056485394, 'recall': 0.36366774344813213, 'f1-score': 0.33691058597308515, 'support': 307088}}
[[27452 17542 61215]
 [22143 16900 58041]
 [20314 16155 67326]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0968132
{'0': {'precision': 0.38534773017531637, 'recall': 0.2549285677710072, 'f1-score': 0.3068554786816031, 'support': 39058}, '1': {'precision': 0.3451862965741435, 'recall': 0.18524880562563745, 'f1-score': 0.24110526959285974, 'support': 37258}, '2': {'precision': 0.345949177877429, 'recall': 0.6355099126805426, 'f1-score': 0.4480148667221588, 'support': 36418}, 'accuracy': 0.354844146397715, 'macro avg': {'precision': 0.35882773487562963, 'recall': 0.3585624286923957, 'f1-score': 0.33199187166554056, 'support': 112734}, 'weighted avg': {'precision': 0.3593471343417882, 'recall': 0.354844146397715, 'f1-score': 0.3307260173250697, 'support': 112734}}
[[ 9957  6903 22198]
 [ 8798  6902 21558]
 [ 7084  6190 23144]]
training model: results/WBA/W9/deepOF_L1/h500
Epoch 1/50
1200/1200 - 20s - loss: 3.3088 - accuracy500: 0.3642 - val_loss: 3.3138 - val_accuracy500: 0.3540 - 20s/epoch - 16ms/step
Epoch 2/50
1200/1200 - 17s - loss: 3.2894 - accuracy500: 0.3677 - val_loss: 3.3097 - val_accuracy500: 0.3548 - 17s/epoch - 14ms/step
Epoch 3/50
1200/1200 - 17s - loss: 3.2871 - accuracy500: 0.3645 - val_loss: 3.3048 - val_accuracy500: 0.3520 - 17s/epoch - 14ms/step
Epoch 4/50
1200/1200 - 18s - loss: 3.2858 - accuracy500: 0.3640 - val_loss: 3.3014 - val_accuracy500: 0.3540 - 18s/epoch - 15ms/step
Epoch 5/50
1200/1200 - 17s - loss: 3.2857 - accuracy500: 0.3630 - val_loss: 3.2997 - val_accuracy500: 0.3540 - 17s/epoch - 14ms/step
Epoch 6/50
1200/1200 - 17s - loss: 3.2843 - accuracy500: 0.3642 - val_loss: 3.3008 - val_accuracy500: 0.3546 - 17s/epoch - 14ms/step
Epoch 7/50
1200/1200 - 17s - loss: 3.2830 - accuracy500: 0.3660 - val_loss: 3.3016 - val_accuracy500: 0.3532 - 17s/epoch - 14ms/step
Epoch 8/50
1200/1200 - 17s - loss: 3.2818 - accuracy500: 0.3668 - val_loss: 3.3037 - val_accuracy500: 0.3546 - 17s/epoch - 14ms/step
Epoch 9/50
1200/1200 - 17s - loss: 3.2799 - accuracy500: 0.3683 - val_loss: 3.3056 - val_accuracy500: 0.3565 - 17s/epoch - 14ms/step
Epoch 10/50
1200/1200 - 17s - loss: 3.2782 - accuracy500: 0.3692 - val_loss: 3.3079 - val_accuracy500: 0.3546 - 17s/epoch - 14ms/step
Epoch 11/50
1200/1200 - 17s - loss: 3.2763 - accuracy500: 0.3713 - val_loss: 3.3127 - val_accuracy500: 0.3549 - 17s/epoch - 14ms/step
Epoch 12/50
1200/1200 - 17s - loss: 3.2751 - accuracy500: 0.3728 - val_loss: 3.3130 - val_accuracy500: 0.3545 - 17s/epoch - 14ms/step
Epoch 13/50
1200/1200 - 18s - loss: 3.2736 - accuracy500: 0.3729 - val_loss: 3.3161 - val_accuracy500: 0.3550 - 18s/epoch - 15ms/step
Epoch 14/50
1200/1200 - 18s - loss: 3.2735 - accuracy500: 0.3739 - val_loss: 3.3137 - val_accuracy500: 0.3553 - 18s/epoch - 15ms/step
Epoch 15/50
1200/1200 - 17s - loss: 3.2714 - accuracy500: 0.3743 - val_loss: 3.3159 - val_accuracy500: 0.3551 - 17s/epoch - 14ms/step
testing model: results/WBA/W9/deepOF_L1/h500
Evaluating performance on  test set...
2451/2451 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0972259
{'0': {'precision': 0.36614663142630893, 'recall': 0.3205311726311051, 'f1-score': 0.3418238027574024, 'support': 222150}, '1': {'precision': 0.2, 'recall': 0.00040554917678783985, 'f1-score': 0.0008094569805152141, 'support': 189866}, '2': {'precision': 0.3514860871535662, 'recall': 0.7059692273396464, 'f1-score': 0.4693122403708558, 'support': 215321}, 'accuracy': 0.35593787708998514, 'macro avg': {'precision': 0.30587757285995837, 'recall': 0.3423019830491798, 'f1-score': 0.2706485000362578, 'support': 627337}, 'weighted avg': {'precision': 0.3108297612660302, 'recall': 0.35593787708998514, 'f1-score': 0.2823723565651515, 'support': 627337}}
[[ 71206    159 150785]
 [ 60106     77 129683]
 [ 63162    149 152010]]
Evaluating performance on  train set...
1200/1200 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1014456
{'0': {'precision': 0.36466221789008024, 'recall': 0.37060179452498426, 'f1-score': 0.36760801579728086, 'support': 104986}, '1': {'precision': 0.35733333333333334, 'recall': 0.0013354062026628398, 'f1-score': 0.0026608683565166455, 'support': 100344}, '2': {'precision': 0.3433008194303484, 'recall': 0.6747970675524283, 'f1-score': 0.45508077209841774, 'support': 101758}, 'accuracy': 0.3507398530714323, 'macro avg': {'precision': 0.3550987902179206, 'recall': 0.3489114227600251, 'f1-score': 0.27511655208407176, 'support': 307088}, 'weighted avg': {'precision': 0.3551890285227731, 'recall': 0.3507398530714323, 'f1-score': 0.2773433235035248, 'support': 307088}}
[[38908   110 65968]
 [34827   134 65383]
 [32961   131 68666]]
Evaluating performance on  val set...
441/441 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0990773
{'0': {'precision': 0.3750406565087943, 'recall': 0.3754633804228033, 'f1-score': 0.37525189941546816, 'support': 39924}, '1': {'precision': 0.484472049689441, 'recall': 0.004366323331840573, 'f1-score': 0.008654646324549238, 'support': 35728}, '2': {'precision': 0.3428626644396284, 'recall': 0.669812847203495, 'f1-score': 0.4535585482766491, 'support': 37082}, 'accuracy': 0.35467560806855075, 'macro avg': {'precision': 0.40079179021262124, 'recall': 0.3498808503193796, 'f1-score': 0.27915503133888886, 'support': 112734}, 'weighted avg': {'precision': 0.39913756173392007, 'recall': 0.35467560806855075, 'f1-score': 0.28482647757855967, 'support': 112734}}
[[14990    80 24854]
 [12821   156 22751]
 [12158    86 24838]]
training model: results/WBA/W9/deepOF_L1/h1000
Epoch 1/50
1200/1200 - 20s - loss: 3.3289 - accuracy1000: 0.3496 - val_loss: 3.3026 - val_accuracy1000: 0.3434 - 20s/epoch - 17ms/step
Epoch 2/50
1200/1200 - 17s - loss: 3.3088 - accuracy1000: 0.3458 - val_loss: 3.2961 - val_accuracy1000: 0.3426 - 17s/epoch - 14ms/step
Epoch 3/50
1200/1200 - 17s - loss: 3.3023 - accuracy1000: 0.3442 - val_loss: 3.2975 - val_accuracy1000: 0.3358 - 17s/epoch - 14ms/step
Epoch 4/50
1200/1200 - 17s - loss: 3.2981 - accuracy1000: 0.3479 - val_loss: 3.2970 - val_accuracy1000: 0.3351 - 17s/epoch - 14ms/step
Epoch 5/50
1200/1200 - 17s - loss: 3.2965 - accuracy1000: 0.3489 - val_loss: 3.2963 - val_accuracy1000: 0.3415 - 17s/epoch - 14ms/step
Epoch 6/50
1200/1200 - 17s - loss: 3.2947 - accuracy1000: 0.3512 - val_loss: 3.2968 - val_accuracy1000: 0.3362 - 17s/epoch - 14ms/step
Epoch 7/50
1200/1200 - 17s - loss: 3.2926 - accuracy1000: 0.3549 - val_loss: 3.2970 - val_accuracy1000: 0.3388 - 17s/epoch - 14ms/step
Epoch 8/50
1200/1200 - 17s - loss: 3.2916 - accuracy1000: 0.3555 - val_loss: 3.2970 - val_accuracy1000: 0.3390 - 17s/epoch - 14ms/step
Epoch 9/50
1200/1200 - 17s - loss: 3.2904 - accuracy1000: 0.3567 - val_loss: 3.2968 - val_accuracy1000: 0.3390 - 17s/epoch - 14ms/step
Epoch 10/50
1200/1200 - 17s - loss: 3.2890 - accuracy1000: 0.3586 - val_loss: 3.2967 - val_accuracy1000: 0.3382 - 17s/epoch - 14ms/step
Epoch 11/50
1200/1200 - 17s - loss: 3.2879 - accuracy1000: 0.3592 - val_loss: 3.2970 - val_accuracy1000: 0.3409 - 17s/epoch - 14ms/step
Epoch 12/50
1200/1200 - 17s - loss: 3.2868 - accuracy1000: 0.3619 - val_loss: 3.2974 - val_accuracy1000: 0.3388 - 17s/epoch - 14ms/step
testing model: results/WBA/W9/deepOF_L1/h1000
Evaluating performance on  test set...
2451/2451 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098676
{'0': {'precision': 0.33039080923616276, 'recall': 0.12809367818901873, 'f1-score': 0.1846124575886015, 'support': 204530}, '1': {'precision': 0.35223681107005267, 'recall': 0.605525294984254, 'f1-score': 0.4453888864035153, 'support': 221961}, '2': {'precision': 0.32428665825674297, 'recall': 0.26878304770819433, 'f1-score': 0.2939376449705431, 'support': 200846}, 'accuracy': 0.34205857457793815, 'macro avg': {'precision': 0.33563809285431945, 'recall': 0.334134006960489, 'f1-score': 0.3079796629875533, 'support': 627337}, 'weighted avg': {'precision': 0.3361659605590394, 'recall': 0.34205857457793815, 'f1-score': 0.31188013588766644, 'support': 627337}}
[[ 26199 124959  53372]
 [ 28444 134403  59114]
 [ 24654 122208  53984]]
Evaluating performance on  train set...
1200/1200 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993795
{'0': {'precision': 0.3545761448128741, 'recall': 0.16290488334031133, 'f1-score': 0.22324368378158108, 'support': 105092}, '1': {'precision': 0.3310498315403546, 'recall': 0.5812589202224518, 'f1-score': 0.4218433008543589, 'support': 101595}, '2': {'precision': 0.33595692828011536, 'recall': 0.2691108654296272, 'f1-score': 0.29884142126365265, 'support': 100401}, 'accuracy': 0.3360339707184911, 'macro avg': {'precision': 0.3405276348777813, 'recall': 0.33775822299746344, 'f1-score': 0.3146428019665309, 'support': 307088}, 'weighted avg': {'precision': 0.34070538543436657, 'recall': 0.3360339707184911, 'f1-score': 0.3136634218939343, 'support': 307088}}
[[17120 60985 26987]
 [16124 59053 26418]
 [15039 58343 27019]]
Evaluating performance on  val set...
441/441 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991861
{'0': {'precision': 0.3451938943894389, 'recall': 0.176492301202278, 'f1-score': 0.2335659455687369, 'support': 37928}, '1': {'precision': 0.3483212959626502, 'recall': 0.5632314941480469, 'f1-score': 0.43044248472938834, 'support': 39474}, '2': {'precision': 0.32077389624911057, 'recall': 0.2679440733612589, 'f1-score': 0.2919885881717943, 'support': 35332}, 'accuracy': 0.34057161104901806, 'macro avg': {'precision': 0.3380963622003999, 'recall': 0.3358892895705279, 'f1-score': 0.31866567282330654, 'support': 112734}, 'weighted avg': {'precision': 0.33863547967344254, 'recall': 0.34057161104901806, 'f1-score': 0.32081285701762347, 'support': 112734}}
[[ 6694 21566  9668]
 [ 6863 22233 10378]
 [ 5835 20030  9467]]
training model: results/WBA/W9/deepLOB_L2/h10
Epoch 1/50
1200/1200 - 53s - loss: 3.1101 - accuracy10: 0.4448 - val_loss: 3.2669 - val_accuracy10: 0.4594 - 53s/epoch - 44ms/step
Epoch 2/50
1200/1200 - 49s - loss: 2.9358 - accuracy10: 0.4708 - val_loss: 3.4216 - val_accuracy10: 0.5420 - 49s/epoch - 41ms/step
Epoch 3/50
1200/1200 - 50s - loss: 2.8499 - accuracy10: 0.4998 - val_loss: 3.2035 - val_accuracy10: 0.5469 - 50s/epoch - 41ms/step
Epoch 4/50
1200/1200 - 49s - loss: 2.7861 - accuracy10: 0.5256 - val_loss: 3.4747 - val_accuracy10: 0.5475 - 49s/epoch - 41ms/step
Epoch 5/50
1200/1200 - 49s - loss: 2.7441 - accuracy10: 0.5435 - val_loss: 3.4631 - val_accuracy10: 0.5591 - 49s/epoch - 41ms/step
Epoch 6/50
1200/1200 - 49s - loss: 2.7065 - accuracy10: 0.5565 - val_loss: 3.4530 - val_accuracy10: 0.5645 - 49s/epoch - 41ms/step
Epoch 7/50
1200/1200 - 49s - loss: 2.6744 - accuracy10: 0.5661 - val_loss: 3.3732 - val_accuracy10: 0.5643 - 49s/epoch - 41ms/step
Epoch 8/50
1200/1200 - 49s - loss: 2.6492 - accuracy10: 0.5719 - val_loss: 3.2481 - val_accuracy10: 0.5681 - 49s/epoch - 41ms/step
Epoch 9/50
1200/1200 - 49s - loss: 2.6269 - accuracy10: 0.5777 - val_loss: 3.1395 - val_accuracy10: 0.5694 - 49s/epoch - 41ms/step
Epoch 10/50
1200/1200 - 49s - loss: 2.6113 - accuracy10: 0.5808 - val_loss: 3.1591 - val_accuracy10: 0.5697 - 49s/epoch - 41ms/step
Epoch 11/50
1200/1200 - 49s - loss: 2.5961 - accuracy10: 0.5840 - val_loss: 3.0202 - val_accuracy10: 0.5724 - 49s/epoch - 41ms/step
Epoch 12/50
1200/1200 - 49s - loss: 2.5833 - accuracy10: 0.5865 - val_loss: 3.0489 - val_accuracy10: 0.5714 - 49s/epoch - 41ms/step
Epoch 13/50
1200/1200 - 49s - loss: 2.5736 - accuracy10: 0.5883 - val_loss: 2.9869 - val_accuracy10: 0.5757 - 49s/epoch - 41ms/step
Epoch 14/50
1200/1200 - 49s - loss: 2.5632 - accuracy10: 0.5898 - val_loss: 2.9786 - val_accuracy10: 0.5683 - 49s/epoch - 41ms/step
Epoch 15/50
1200/1200 - 49s - loss: 2.5537 - accuracy10: 0.5916 - val_loss: 3.0189 - val_accuracy10: 0.5620 - 49s/epoch - 41ms/step
Epoch 16/50
1200/1200 - 49s - loss: 2.5482 - accuracy10: 0.5923 - val_loss: 2.9550 - val_accuracy10: 0.5599 - 49s/epoch - 41ms/step
Epoch 17/50
1200/1200 - 50s - loss: 2.5399 - accuracy10: 0.5931 - val_loss: 3.0150 - val_accuracy10: 0.5613 - 50s/epoch - 41ms/step
Epoch 18/50
1200/1200 - 50s - loss: 2.5318 - accuracy10: 0.5948 - val_loss: 2.9415 - val_accuracy10: 0.5649 - 50s/epoch - 41ms/step
Epoch 19/50
1200/1200 - 50s - loss: 2.5252 - accuracy10: 0.5949 - val_loss: 2.9332 - val_accuracy10: 0.5614 - 50s/epoch - 41ms/step
Epoch 20/50
1200/1200 - 49s - loss: 2.5193 - accuracy10: 0.5960 - val_loss: 2.8869 - val_accuracy10: 0.5691 - 49s/epoch - 41ms/step
Epoch 21/50
1200/1200 - 49s - loss: 2.5112 - accuracy10: 0.5972 - val_loss: 2.8864 - val_accuracy10: 0.5635 - 49s/epoch - 41ms/step
Epoch 22/50
1200/1200 - 49s - loss: 2.5045 - accuracy10: 0.5974 - val_loss: 2.9230 - val_accuracy10: 0.5707 - 49s/epoch - 41ms/step
Epoch 23/50
1200/1200 - 49s - loss: 2.4990 - accuracy10: 0.5986 - val_loss: 2.9727 - val_accuracy10: 0.5657 - 49s/epoch - 41ms/step
Epoch 24/50
1200/1200 - 49s - loss: 2.4931 - accuracy10: 0.5996 - val_loss: 2.9032 - val_accuracy10: 0.5706 - 49s/epoch - 41ms/step
Epoch 25/50
1200/1200 - 49s - loss: 2.4858 - accuracy10: 0.6004 - val_loss: 2.9029 - val_accuracy10: 0.5698 - 49s/epoch - 41ms/step
Epoch 26/50
1200/1200 - 50s - loss: 2.4815 - accuracy10: 0.6006 - val_loss: 2.9025 - val_accuracy10: 0.5678 - 50s/epoch - 41ms/step
Epoch 27/50
1200/1200 - 50s - loss: 2.4754 - accuracy10: 0.6001 - val_loss: 2.8852 - val_accuracy10: 0.5714 - 50s/epoch - 41ms/step
Epoch 28/50
1200/1200 - 49s - loss: 2.4703 - accuracy10: 0.6020 - val_loss: 2.9292 - val_accuracy10: 0.5699 - 49s/epoch - 41ms/step
Epoch 29/50
1200/1200 - 49s - loss: 2.4640 - accuracy10: 0.6023 - val_loss: 2.8927 - val_accuracy10: 0.5751 - 49s/epoch - 41ms/step
Epoch 30/50
1200/1200 - 49s - loss: 2.4606 - accuracy10: 0.6035 - val_loss: 2.8806 - val_accuracy10: 0.5728 - 49s/epoch - 41ms/step
Epoch 31/50
1200/1200 - 49s - loss: 2.4544 - accuracy10: 0.6042 - val_loss: 2.8742 - val_accuracy10: 0.5714 - 49s/epoch - 41ms/step
Epoch 32/50
1200/1200 - 49s - loss: 2.4483 - accuracy10: 0.6045 - val_loss: 2.8601 - val_accuracy10: 0.5704 - 49s/epoch - 41ms/step
Epoch 33/50
1200/1200 - 49s - loss: 2.4441 - accuracy10: 0.6054 - val_loss: 2.8858 - val_accuracy10: 0.5774 - 49s/epoch - 41ms/step
Epoch 34/50
1200/1200 - 49s - loss: 2.4386 - accuracy10: 0.6067 - val_loss: 2.8467 - val_accuracy10: 0.5694 - 49s/epoch - 41ms/step
Epoch 35/50
1200/1200 - 49s - loss: 2.4363 - accuracy10: 0.6080 - val_loss: 2.8661 - val_accuracy10: 0.5603 - 49s/epoch - 41ms/step
Epoch 36/50
1200/1200 - 49s - loss: 2.4285 - accuracy10: 0.6079 - val_loss: 2.8401 - val_accuracy10: 0.5712 - 49s/epoch - 41ms/step
Epoch 37/50
1200/1200 - 49s - loss: 2.4255 - accuracy10: 0.6085 - val_loss: 2.8528 - val_accuracy10: 0.5655 - 49s/epoch - 41ms/step
Epoch 38/50
1200/1200 - 50s - loss: 2.4197 - accuracy10: 0.6092 - val_loss: 2.8643 - val_accuracy10: 0.5716 - 50s/epoch - 42ms/step
Epoch 39/50
1200/1200 - 50s - loss: 2.4127 - accuracy10: 0.6102 - val_loss: 2.8934 - val_accuracy10: 0.5621 - 50s/epoch - 41ms/step
Epoch 40/50
1200/1200 - 49s - loss: 2.4077 - accuracy10: 0.6110 - val_loss: 2.9157 - val_accuracy10: 0.5564 - 49s/epoch - 41ms/step
Epoch 41/50
1200/1200 - 49s - loss: 2.4075 - accuracy10: 0.6107 - val_loss: 2.8584 - val_accuracy10: 0.5694 - 49s/epoch - 41ms/step
Epoch 42/50
1200/1200 - 49s - loss: 2.3990 - accuracy10: 0.6126 - val_loss: 2.8688 - val_accuracy10: 0.5619 - 49s/epoch - 41ms/step
Epoch 43/50
1200/1200 - 49s - loss: 2.3949 - accuracy10: 0.6134 - val_loss: 2.9073 - val_accuracy10: 0.5551 - 49s/epoch - 41ms/step
Epoch 44/50
1200/1200 - 49s - loss: 2.3919 - accuracy10: 0.6134 - val_loss: 2.8826 - val_accuracy10: 0.5576 - 49s/epoch - 41ms/step
Epoch 45/50
1200/1200 - 50s - loss: 2.3865 - accuracy10: 0.6129 - val_loss: 2.9168 - val_accuracy10: 0.5489 - 50s/epoch - 41ms/step
Epoch 46/50
1200/1200 - 49s - loss: 2.3822 - accuracy10: 0.6143 - val_loss: 2.9315 - val_accuracy10: 0.5536 - 49s/epoch - 41ms/step
testing model: results/WBA/W9/deepLOB_L2/h10
Evaluating performance on  test set...
2451/2451 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9588043
{'0': {'precision': 0.3873163740594769, 'recall': 0.17091809845051123, 'f1-score': 0.23717409587888982, 'support': 132818}, '1': {'precision': 0.618848488590707, 'recall': 0.7916140102407669, 'f1-score': 0.6946503493578675, 'support': 367160}, '2': {'precision': 0.3465362525108763, 'recall': 0.2695523817749268, 'f1-score': 0.30323452515545507, 'support': 127363}, 'accuracy': 0.5542137370265932, 'macro avg': {'precision': 0.4509003717203533, 'recall': 0.41069483015540165, 'f1-score': 0.4116863234640708, 'support': 627341}, 'weighted avg': {'precision': 0.5145445522759365, 'recall': 0.5542137370265932, 'f1-score': 0.518330015356961, 'support': 627341}}
[[ 22701  93838  16279]
 [ 28052 290649  48459]
 [  7858  85174  34331]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8992357
{'0': {'precision': 0.4056864121619986, 'recall': 0.5179650435024494, 'f1-score': 0.45500145933874986, 'support': 64709}, '1': {'precision': 0.7493411052697634, 'recall': 0.6033549662033191, 'f1-score': 0.6684704521281559, 'support': 178124}, '2': {'precision': 0.41026748260376056, 'recall': 0.5174839322118302, 'f1-score': 0.4576804233678111, 'support': 64259}, 'accuracy': 0.5673934846886275, 'macro avg': {'precision': 0.5217650000118409, 'recall': 0.5462679806391996, 'f1-score': 0.527050778278239, 'support': 307092}, 'weighted avg': {'precision': 0.6059766299489963, 'recall': 0.5673934846886275, 'f1-score': 0.5793814445586957, 'support': 307092}}
[[ 33517  18137  13055]
 [ 35908 107472  34744]
 [ 13193  17813  33253]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8912402
{'0': {'precision': 0.4001276509327222, 'recall': 0.5566003470680818, 'f1-score': 0.46556845800702135, 'support': 24779}, '1': {'precision': 0.7448012634903922, 'recall': 0.6159599446439956, 'f1-score': 0.6742810454735014, 'support': 64311}, '2': {'precision': 0.435663303959488, 'recall': 0.46210455083742175, 'f1-score': 0.448494550828151, 'support': 23644}, 'accuracy': 0.5706441712349424, 'macro avg': {'precision': 0.5268640727942008, 'recall': 0.5448882808498331, 'f1-score': 0.5294480181028912, 'support': 112734}, 'weighted avg': {'precision': 0.6042054772970946, 'recall': 0.5706441712349424, 'f1-score': 0.5810510963523261, 'support': 112734}}
[[13792  6786  4201]
 [14746 39613  9952]
 [ 5931  6787 10926]]
training model: results/WBA/W9/deepLOB_L2/h20
Epoch 1/50
1200/1200 - 52s - loss: 3.1343 - accuracy20: 0.4459 - val_loss: 3.1823 - val_accuracy20: 0.4122 - 52s/epoch - 43ms/step
Epoch 2/50
1200/1200 - 49s - loss: 2.9899 - accuracy20: 0.4801 - val_loss: 3.2709 - val_accuracy20: 0.4293 - 49s/epoch - 41ms/step
Epoch 3/50
1200/1200 - 49s - loss: 2.8936 - accuracy20: 0.5131 - val_loss: 2.9969 - val_accuracy20: 0.4973 - 49s/epoch - 41ms/step
Epoch 4/50
1200/1200 - 49s - loss: 2.8420 - accuracy20: 0.5300 - val_loss: 2.9559 - val_accuracy20: 0.4994 - 49s/epoch - 41ms/step
Epoch 5/50
1200/1200 - 49s - loss: 2.8067 - accuracy20: 0.5418 - val_loss: 2.9881 - val_accuracy20: 0.5342 - 49s/epoch - 41ms/step
Epoch 6/50
1200/1200 - 49s - loss: 2.7760 - accuracy20: 0.5500 - val_loss: 3.1725 - val_accuracy20: 0.5116 - 49s/epoch - 41ms/step
Epoch 7/50
1200/1200 - 49s - loss: 2.7523 - accuracy20: 0.5541 - val_loss: 3.1577 - val_accuracy20: 0.5146 - 49s/epoch - 41ms/step
Epoch 8/50
1200/1200 - 49s - loss: 2.7324 - accuracy20: 0.5601 - val_loss: 3.1327 - val_accuracy20: 0.5211 - 49s/epoch - 41ms/step
Epoch 9/50
1200/1200 - 49s - loss: 2.7160 - accuracy20: 0.5633 - val_loss: 3.0974 - val_accuracy20: 0.5319 - 49s/epoch - 41ms/step
Epoch 10/50
1200/1200 - 49s - loss: 2.6994 - accuracy20: 0.5667 - val_loss: 3.1784 - val_accuracy20: 0.5245 - 49s/epoch - 41ms/step
Epoch 11/50
1200/1200 - 49s - loss: 2.6850 - accuracy20: 0.5700 - val_loss: 3.0506 - val_accuracy20: 0.5394 - 49s/epoch - 41ms/step
Epoch 12/50
1200/1200 - 49s - loss: 2.6718 - accuracy20: 0.5724 - val_loss: 3.0884 - val_accuracy20: 0.5374 - 49s/epoch - 41ms/step
Epoch 13/50
1200/1200 - 49s - loss: 2.6614 - accuracy20: 0.5752 - val_loss: 3.0551 - val_accuracy20: 0.5383 - 49s/epoch - 41ms/step
Epoch 14/50
1200/1200 - 49s - loss: 2.6503 - accuracy20: 0.5781 - val_loss: 3.0789 - val_accuracy20: 0.5356 - 49s/epoch - 41ms/step
testing model: results/WBA/W9/deepLOB_L2/h20
Evaluating performance on  test set...
2451/2451 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0982834
{'0': {'precision': 0.3279242627380274, 'recall': 0.7552067005400418, 'f1-score': 0.4572865311502184, 'support': 169061}, '1': {'precision': 0.5806905760606105, 'recall': 0.1348416472594545, 'f1-score': 0.2188616285112552, 'support': 296711}, '2': {'precision': 0.3904882433647159, 'recall': 0.4086798828983283, 'f1-score': 0.3993770129889768, 'support': 161569}, 'accuracy': 0.37254858203114416, 'macro avg': {'precision': 0.43303436072111795, 'recall': 0.43290941023260815, 'f1-score': 0.35850839088348346, 'support': 627341}, 'weighted avg': {'precision': 0.463587236109974, 'recall': 0.37254858203114416, 'f1-score': 0.3296052952247759, 'support': 627341}}
[[127676  16031  25354]
 [178990  40009  77712]
 [ 82680  12859  66030]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9934941
{'0': {'precision': 0.3996961874009081, 'recall': 0.5930583439051126, 'f1-score': 0.4775463651690965, 'support': 81191}, '1': {'precision': 0.6568632895365238, 'recall': 0.4071934619912836, 'f1-score': 0.5027371642298538, 'support': 145243}, '2': {'precision': 0.4207856211045079, 'recall': 0.5038805822113119, 'f1-score': 0.4585994448331114, 'support': 80658}, 'accuracy': 0.4817286025034843, 'macro avg': {'precision': 0.49244836601398, 'recall': 0.5013774627025694, 'f1-score': 0.4796276580773539, 'support': 307092}, 'weighted avg': {'precision': 0.5268657423197864, 'recall': 0.4817286025034843, 'f1-score': 0.48448424218159336, 'support': 307092}}
[[48151 15189 17851]
 [48008 59142 38093]
 [24310 15706 40642]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9737128
{'0': {'precision': 0.407058776505386, 'recall': 0.6615994283115701, 'f1-score': 0.5040149462405503, 'support': 30786}, '1': {'precision': 0.6682056543547652, 'recall': 0.44565671925489453, 'f1-score': 0.5346986248261077, 'support': 52610}, '2': {'precision': 0.4522438335325437, 'recall': 0.4255913831890381, 'f1-score': 0.43851300331887544, 'support': 29338}, 'accuracy': 0.4994056806287367, 'macro avg': {'precision': 0.5091694214642316, 'recall': 0.510949176918501, 'f1-score': 0.4924088581285111, 'support': 112734}, 'weighted avg': {'precision': 0.5406881735525819, 'recall': 0.4994056806287367, 'f1-score': 0.5012879280290976, 'support': 112734}}
[[20368  5518  4900]
 [18941 23446 10223]
 [10728  6124 12486]]
training model: results/WBA/W9/deepLOB_L2/h30
Epoch 1/50
1200/1200 - 52s - loss: 3.1638 - accuracy30: 0.4459 - val_loss: 3.4538 - val_accuracy30: 0.3719 - 52s/epoch - 44ms/step
Epoch 2/50
1200/1200 - 50s - loss: 3.0663 - accuracy30: 0.4706 - val_loss: 3.2334 - val_accuracy30: 0.4067 - 50s/epoch - 42ms/step
Epoch 3/50
1200/1200 - 50s - loss: 2.9929 - accuracy30: 0.4926 - val_loss: 3.2415 - val_accuracy30: 0.4398 - 50s/epoch - 41ms/step
Epoch 4/50
1200/1200 - 49s - loss: 2.9364 - accuracy30: 0.5079 - val_loss: 3.2931 - val_accuracy30: 0.4418 - 49s/epoch - 41ms/step
Epoch 5/50
1200/1200 - 49s - loss: 2.9044 - accuracy30: 0.5180 - val_loss: 3.2385 - val_accuracy30: 0.4552 - 49s/epoch - 41ms/step
Epoch 6/50
1200/1200 - 49s - loss: 2.8792 - accuracy30: 0.5262 - val_loss: 3.2559 - val_accuracy30: 0.4646 - 49s/epoch - 41ms/step
Epoch 7/50
1200/1200 - 50s - loss: 2.8615 - accuracy30: 0.5303 - val_loss: 3.1282 - val_accuracy30: 0.4862 - 50s/epoch - 42ms/step
Epoch 8/50
1200/1200 - 51s - loss: 2.8402 - accuracy30: 0.5359 - val_loss: 3.1235 - val_accuracy30: 0.4900 - 51s/epoch - 42ms/step
Epoch 9/50
1200/1200 - 51s - loss: 2.8231 - accuracy30: 0.5394 - val_loss: 3.1218 - val_accuracy30: 0.4951 - 51s/epoch - 43ms/step
Epoch 10/50
1200/1200 - 50s - loss: 2.8072 - accuracy30: 0.5439 - val_loss: 3.1395 - val_accuracy30: 0.4952 - 50s/epoch - 42ms/step
Epoch 11/50
1200/1200 - 50s - loss: 2.7939 - accuracy30: 0.5470 - val_loss: 3.1583 - val_accuracy30: 0.4863 - 50s/epoch - 42ms/step
Epoch 12/50
1200/1200 - 51s - loss: 2.7819 - accuracy30: 0.5491 - val_loss: 3.1207 - val_accuracy30: 0.4957 - 51s/epoch - 42ms/step
Epoch 13/50
1200/1200 - 51s - loss: 2.7687 - accuracy30: 0.5516 - val_loss: 3.1148 - val_accuracy30: 0.4936 - 51s/epoch - 42ms/step
Epoch 14/50
1200/1200 - 50s - loss: 2.7586 - accuracy30: 0.5538 - val_loss: 3.0571 - val_accuracy30: 0.4991 - 50s/epoch - 42ms/step
Epoch 15/50
1200/1200 - 50s - loss: 2.7473 - accuracy30: 0.5566 - val_loss: 3.0629 - val_accuracy30: 0.4956 - 50s/epoch - 42ms/step
Epoch 16/50
1200/1200 - 50s - loss: 2.7384 - accuracy30: 0.5591 - val_loss: 3.0381 - val_accuracy30: 0.4989 - 50s/epoch - 41ms/step
Epoch 17/50
1200/1200 - 50s - loss: 2.7287 - accuracy30: 0.5611 - val_loss: 3.0855 - val_accuracy30: 0.4927 - 50s/epoch - 42ms/step
Epoch 18/50
1200/1200 - 50s - loss: 2.7223 - accuracy30: 0.5626 - val_loss: 3.1047 - val_accuracy30: 0.4883 - 50s/epoch - 42ms/step
Epoch 19/50
1200/1200 - 50s - loss: 2.7139 - accuracy30: 0.5643 - val_loss: 3.1500 - val_accuracy30: 0.4843 - 50s/epoch - 41ms/step
Epoch 20/50
1200/1200 - 50s - loss: 2.7050 - accuracy30: 0.5658 - val_loss: 3.2160 - val_accuracy30: 0.4818 - 50s/epoch - 41ms/step
Epoch 21/50
1200/1200 - 50s - loss: 2.6973 - accuracy30: 0.5682 - val_loss: 3.1406 - val_accuracy30: 0.4890 - 50s/epoch - 41ms/step
Epoch 22/50
1200/1200 - 49s - loss: 2.6913 - accuracy30: 0.5691 - val_loss: 3.1246 - val_accuracy30: 0.4903 - 49s/epoch - 41ms/step
Epoch 23/50
1200/1200 - 50s - loss: 2.6840 - accuracy30: 0.5698 - val_loss: 3.1167 - val_accuracy30: 0.4923 - 50s/epoch - 41ms/step
Epoch 24/50
1200/1200 - 50s - loss: 2.6777 - accuracy30: 0.5713 - val_loss: 3.1160 - val_accuracy30: 0.4940 - 50s/epoch - 41ms/step
Epoch 25/50
1200/1200 - 49s - loss: 2.6698 - accuracy30: 0.5734 - val_loss: 3.1278 - val_accuracy30: 0.4924 - 49s/epoch - 41ms/step
Epoch 26/50
1200/1200 - 49s - loss: 2.6639 - accuracy30: 0.5739 - val_loss: 3.1566 - val_accuracy30: 0.4910 - 49s/epoch - 41ms/step
testing model: results/WBA/W9/deepLOB_L2/h30
Evaluating performance on  test set...
2451/2451 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0322
{'0': {'precision': 0.4711566388005809, 'recall': 0.3107810040593157, 'f1-score': 0.3745222770964431, 'support': 193136}, '1': {'precision': 0.47206735245616593, 'recall': 0.6729863504425911, 'f1-score': 0.554899536831001, 'support': 250118}, '2': {'precision': 0.4412864257117748, 'recall': 0.3436907549147957, 'f1-score': 0.3864215891358055, 'support': 184087}, 'accuracy': 0.4648476665800577, 'macro avg': {'precision': 0.46150347232284056, 'recall': 0.4424860364722341, 'f1-score': 0.43861446768774986, 'support': 627341}, 'weighted avg': {'precision': 0.4627546181471062, 'recall': 0.4648476665800577, 'f1-score': 0.4499296043804533, 'support': 627341}}
[[ 60023 100104  33009]
 [ 34696 168326  47096]
 [ 32676  88142  63269]]
Evaluating performance on  train set...
1200/1200 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0145953
{'0': {'precision': 0.450268942837963, 'recall': 0.5765439352395875, 'f1-score': 0.5056419407321878, 'support': 91908}, '1': {'precision': 0.6059888026803033, 'recall': 0.44432323232323234, 'f1-score': 0.512714116539075, 'support': 123750}, '2': {'precision': 0.45571736949317443, 'recall': 0.4917973620316294, 'f1-score': 0.4730704287585413, 'support': 91434}, 'accuracy': 0.49802990634728356, 'macro avg': {'precision': 0.5039917050038135, 'recall': 0.5042215098648164, 'f1-score': 0.4971421620099346, 'support': 307092}, 'weighted avg': {'precision': 0.5146421733300703, 'recall': 0.49802990634728356, 'f1-score': 0.49879395423401757, 'support': 307092}}
[[52989 17185 21734]
 [36793 54985 31972]
 [27901 18566 44967]]
Evaluating performance on  val set...
441/441 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0093119
{'0': {'precision': 0.45040938059921526, 'recall': 0.5732636683794238, 'f1-score': 0.504464455819034, 'support': 34642}, '1': {'precision': 0.5666203602154468, 'recall': 0.5138354771692525, 'f1-score': 0.5389385351831889, 'support': 45246}, '2': {'precision': 0.4737070838765754, 'recall': 0.3982220057236802, 'f1-score': 0.43269707896390885, 'support': 32846}, 'accuracy': 0.4984121915305054, 'macro avg': {'precision': 0.4969122748970791, 'recall': 0.49510705042411884, 'f1-score': 0.49203335665537723, 'support': 112734}, 'weighted avg': {'precision': 0.5038388548089849, 'recall': 0.4984121915305054, 'f1-score': 0.4973906620631761, 'support': 112734}}
[[19859  8730  6053]
 [13518 23249  8479]
 [10714  9052 13080]]
training model: results/WBA/W9/deepLOB_L2/h50
Epoch 1/50
1200/1200 - 54s - loss: 3.1984 - accuracy50: 0.4232 - val_loss: 3.2894 - val_accuracy50: 0.3826 - 54s/epoch - 45ms/step
Epoch 2/50
1200/1200 - 50s - loss: 3.1101 - accuracy50: 0.4558 - val_loss: 3.3228 - val_accuracy50: 0.3627 - 50s/epoch - 42ms/step
Epoch 3/50
1200/1200 - 50s - loss: 3.0429 - accuracy50: 0.4750 - val_loss: 3.3975 - val_accuracy50: 0.4047 - 50s/epoch - 42ms/step
Epoch 4/50
1200/1200 - 51s - loss: 3.0196 - accuracy50: 0.4817 - val_loss: 3.3756 - val_accuracy50: 0.4020 - 51s/epoch - 42ms/step
Epoch 5/50
1200/1200 - 50s - loss: 3.0000 - accuracy50: 0.4882 - val_loss: 3.4119 - val_accuracy50: 0.3993 - 50s/epoch - 42ms/step
Epoch 6/50
1200/1200 - 50s - loss: 2.9838 - accuracy50: 0.4932 - val_loss: 3.3987 - val_accuracy50: 0.3994 - 50s/epoch - 42ms/step
Epoch 7/50
1200/1200 - 50s - loss: 2.9713 - accuracy50: 0.4971 - val_loss: 3.4249 - val_accuracy50: 0.4027 - 50s/epoch - 42ms/step
Epoch 8/50
1200/1200 - 52s - loss: 2.9580 - accuracy50: 0.5004 - val_loss: 3.4294 - val_accuracy50: 0.4041 - 52s/epoch - 43ms/step
Epoch 9/50
1200/1200 - 50s - loss: 2.9453 - accuracy50: 0.5046 - val_loss: 3.4104 - val_accuracy50: 0.3994 - 50s/epoch - 42ms/step
Epoch 10/50
1200/1200 - 51s - loss: 2.9345 - accuracy50: 0.5075 - val_loss: 3.4688 - val_accuracy50: 0.3852 - 51s/epoch - 43ms/step
Epoch 11/50
1200/1200 - 50s - loss: 2.9233 - accuracy50: 0.5105 - val_loss: 3.4994 - val_accuracy50: 0.3865 - 50s/epoch - 41ms/step
testing model: results/WBA/W9/deepLOB_L2/h50
Evaluating performance on  test set...
2451/2451 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1275082
{'0': {'precision': 0.3545909926824201, 'recall': 0.6382657513123208, 'f1-score': 0.45590320602027423, 'support': 216601}, '1': {'precision': 0.3135186326074449, 'recall': 0.3047155292289573, 'f1-score': 0.3090544067456334, 'support': 202077}, '2': {'precision': 0.47197661673365, 'recall': 0.09286265413609504, 'f1-score': 0.15519105551061596, 'support': 208663}, 'accuracy': 0.34941443329863664, 'macro avg': {'precision': 0.3800287473411717, 'recall': 0.3452813115591244, 'f1-score': 0.3067162227588412, 'support': 627341}, 'weighted avg': {'precision': 0.38040511476997857, 'recall': 0.34941443329863664, 'f1-score': 0.3085793992344617, 'support': 627341}}
[[138249  69432   8920]
 [127743  61576  12758]
 [123891  65395  19377]]
Evaluating performance on  train set...
1200/1200 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0972247
{'0': {'precision': 0.39305645684620377, 'recall': 0.4698991466252909, 'f1-score': 0.42805653710247354, 'support': 103120}, '1': {'precision': 0.3202674616534848, 'recall': 0.336481933424893, 'f1-score': 0.3281745381657688, 'support': 101209}, '2': {'precision': 0.43623433446482274, 'recall': 0.32890242597043684, 'f1-score': 0.37504022369924883, 'support': 102763}, 'accuracy': 0.37874643429330623, 'macro avg': {'precision': 0.3831860843215038, 'recall': 0.3784278353402069, 'f1-score': 0.3770904329891637, 'support': 307092}, 'weighted avg': {'precision': 0.3835159504939128, 'recall': 0.37874643429330623, 'f1-score': 0.3773972146693248, 'support': 307092}}
[[48456 36911 17753]
 [41227 34055 25927]
 [33597 35367 33799]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0965232
{'0': {'precision': 0.3996785997792794, 'recall': 0.5372283669486012, 'f1-score': 0.4583564624641961, 'support': 38425}, '1': {'precision': 0.3253669449446172, 'recall': 0.3156195416291748, 'f1-score': 0.3204191295002687, 'support': 37786}, '2': {'precision': 0.4294543817281323, 'recall': 0.287271034690469, 'f1-score': 0.34425960560422614, 'support': 36523}, 'accuracy': 0.3819699469547785, 'macro avg': {'precision': 0.38483330881734296, 'recall': 0.3800396477560817, 'f1-score': 0.37434506585623034, 'support': 112734}, 'weighted avg': {'precision': 0.38441754893867597, 'recall': 0.3819699469547785, 'f1-score': 0.37515831845731573, 'support': 112734}}
[[20643 12568  5214]
 [17135 11926  8725]
 [13871 12160 10492]]
training model: results/WBA/W9/deepLOB_L2/h100
Epoch 1/50
1200/1200 - 55s - loss: 3.2557 - accuracy100: 0.3960 - val_loss: 3.3815 - val_accuracy100: 0.3487 - 55s/epoch - 46ms/step
Epoch 2/50
1200/1200 - 51s - loss: 3.1932 - accuracy100: 0.4250 - val_loss: 3.4438 - val_accuracy100: 0.3675 - 51s/epoch - 43ms/step
Epoch 3/50
1200/1200 - 50s - loss: 3.1707 - accuracy100: 0.4344 - val_loss: 3.4918 - val_accuracy100: 0.3601 - 50s/epoch - 42ms/step
Epoch 4/50
1200/1200 - 50s - loss: 3.1584 - accuracy100: 0.4390 - val_loss: 3.4712 - val_accuracy100: 0.3593 - 50s/epoch - 42ms/step
Epoch 5/50
1200/1200 - 50s - loss: 3.1524 - accuracy100: 0.4408 - val_loss: 3.4400 - val_accuracy100: 0.3603 - 50s/epoch - 41ms/step
Epoch 6/50
1200/1200 - 50s - loss: 3.1433 - accuracy100: 0.4434 - val_loss: 3.4469 - val_accuracy100: 0.3682 - 50s/epoch - 42ms/step
Epoch 7/50
1200/1200 - 50s - loss: 3.1329 - accuracy100: 0.4481 - val_loss: 3.4390 - val_accuracy100: 0.3627 - 50s/epoch - 42ms/step
Epoch 8/50
1200/1200 - 50s - loss: 3.1244 - accuracy100: 0.4505 - val_loss: 3.4990 - val_accuracy100: 0.3655 - 50s/epoch - 42ms/step
Epoch 9/50
1200/1200 - 50s - loss: 3.1180 - accuracy100: 0.4525 - val_loss: 3.5035 - val_accuracy100: 0.3578 - 50s/epoch - 41ms/step
Epoch 10/50
1200/1200 - 50s - loss: 3.1106 - accuracy100: 0.4550 - val_loss: 3.4889 - val_accuracy100: 0.3527 - 50s/epoch - 41ms/step
Epoch 11/50
1200/1200 - 50s - loss: 3.1018 - accuracy100: 0.4586 - val_loss: 3.5445 - val_accuracy100: 0.3422 - 50s/epoch - 41ms/step
testing model: results/WBA/W9/deepLOB_L2/h100
Evaluating performance on  test set...
2451/2451 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1487685
{'0': {'precision': 0.3475480389539987, 'recall': 0.57502663425028, 'f1-score': 0.4332427171144594, 'support': 219642}, '1': {'precision': 0.3031793814593997, 'recall': 0.3929476896295209, 'f1-score': 0.34227554834614565, 'support': 197609}, '2': {'precision': 0.40670162424862516, 'recall': 0.01513637012708839, 'f1-score': 0.029186495280139873, 'support': 210090}, 'accuracy': 0.33017131033999053, 'macro avg': {'precision': 0.35247634822067453, 'recall': 0.32770356466896305, 'f1-score': 0.2682349202469149, 'support': 627341}, 'weighted avg': {'precision': 0.3533820760975902, 'recall': 0.33017131033999053, 'f1-score': 0.26927431253336254, 'support': 627341}}
[[126300  90658   2684]
 [118004  77650   1955]
 [119099  87811   3180]]
Evaluating performance on  train set...
1200/1200 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1265867
{'0': {'precision': 0.34994952677869307, 'recall': 0.6115572795851932, 'f1-score': 0.44516415104379137, 'support': 102602}, '1': {'precision': 0.3383397787570825, 'recall': 0.2563493531398756, 'f1-score': 0.2916925121843155, 'support': 102727}, '2': {'precision': 0.37831291536552164, 'recall': 0.18571582991853622, 'f1-score': 0.24913161832071132, 'support': 101763}, 'accuracy': 0.351621012595574, 'macro avg': {'precision': 0.3555340736337657, 'recall': 0.35120748754786835, 'f1-score': 0.3286627605162727, 'support': 307092}, 'weighted avg': {'precision': 0.35546484117224764, 'recall': 0.351621012595574, 'f1-score': 0.3288649974591452, 'support': 307092}}
[[62747 25193 14662]
 [59998 26334 16395]
 [56558 26306 18899]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1264825
{'0': {'precision': 0.3503047011027278, 'recall': 0.6387037037037037, 'f1-score': 0.45245502248875563, 'support': 37800}, '1': {'precision': 0.3450178005555338, 'recall': 0.22658718943500938, 'f1-score': 0.273533699326944, 'support': 38921}, '2': {'precision': 0.3573659124527475, 'recall': 0.18112903673673394, 'f1-score': 0.240408358825047, 'support': 36013}, 'accuracy': 0.3502492593183955, 'macro avg': {'precision': 0.35089613803700304, 'recall': 0.3488066432918157, 'f1-score': 0.3221323602135822, 'support': 112734}, 'weighted avg': {'precision': 0.3507351297946124, 'recall': 0.3502492593183955, 'f1-score': 0.3229445525568628, 'support': 112734}}
[[24143  8346  5311]
 [23683  8819  6419]
 [21094  8396  6523]]
training model: results/WBA/W9/deepLOB_L2/h200
Epoch 1/50
1200/1200 - 52s - loss: 3.2975 - accuracy200: 0.3681 - val_loss: 3.3476 - val_accuracy200: 0.3565 - 52s/epoch - 43ms/step
Epoch 2/50
1200/1200 - 50s - loss: 3.2623 - accuracy200: 0.3871 - val_loss: 3.3961 - val_accuracy200: 0.3494 - 50s/epoch - 41ms/step
Epoch 3/50
1200/1200 - 49s - loss: 3.2357 - accuracy200: 0.4041 - val_loss: 3.3723 - val_accuracy200: 0.3471 - 49s/epoch - 41ms/step
Epoch 4/50
1200/1200 - 50s - loss: 3.2197 - accuracy200: 0.4121 - val_loss: 3.4852 - val_accuracy200: 0.3540 - 50s/epoch - 41ms/step
Epoch 5/50
1200/1200 - 50s - loss: 3.2089 - accuracy200: 0.4171 - val_loss: 3.5428 - val_accuracy200: 0.3495 - 50s/epoch - 41ms/step
Epoch 6/50
1200/1200 - 50s - loss: 3.1984 - accuracy200: 0.4227 - val_loss: 3.5919 - val_accuracy200: 0.3501 - 50s/epoch - 42ms/step
Epoch 7/50
1200/1200 - 50s - loss: 3.1883 - accuracy200: 0.4270 - val_loss: 3.6590 - val_accuracy200: 0.3500 - 50s/epoch - 41ms/step
Epoch 8/50
1200/1200 - 50s - loss: 3.1791 - accuracy200: 0.4322 - val_loss: 3.7035 - val_accuracy200: 0.3460 - 50s/epoch - 42ms/step
Epoch 9/50
1200/1200 - 49s - loss: 3.1714 - accuracy200: 0.4351 - val_loss: 3.6939 - val_accuracy200: 0.3453 - 49s/epoch - 41ms/step
Epoch 10/50
1200/1200 - 48s - loss: 3.1623 - accuracy200: 0.4394 - val_loss: 3.7180 - val_accuracy200: 0.3449 - 48s/epoch - 40ms/step
Epoch 11/50
1200/1200 - 49s - loss: 3.1528 - accuracy200: 0.4442 - val_loss: 3.7066 - val_accuracy200: 0.3433 - 49s/epoch - 41ms/step
testing model: results/WBA/W9/deepLOB_L2/h200
Evaluating performance on  test set...
2451/2451 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1349324
{'0': {'precision': 0.3360039343263043, 'recall': 0.7003392766909695, 'f1-score': 0.4541289986363054, 'support': 207795}, '1': {'precision': 0.35413339440363045, 'recall': 0.26998800788447136, 'f1-score': 0.3063883703711428, 'support': 217643}, '2': {'precision': 0.3343344758135755, 'recall': 0.04686408820076968, 'f1-score': 0.0822053482997689, 'support': 201903}, 'accuracy': 0.3407237849909379, 'macro avg': {'precision': 0.34149060151450344, 'recall': 0.3390637909254035, 'f1-score': 0.28090757243573905, 'support': 627341}, 'weighted avg': {'precision': 0.3417562785816838, 'recall': 0.3407237849909379, 'f1-score': 0.28317378555217326, 'support': 627341}}
[[145527  53364   8904]
 [148947  58761   9935]
 [138637  53804   9462]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.119883
{'0': {'precision': 0.35034961327529024, 'recall': 0.5720015003318042, 'f1-score': 0.43454277113715406, 'support': 103977}, '1': {'precision': 0.3430485074959644, 'recall': 0.3822038950715421, 'f1-score': 0.3615692283107813, 'support': 100640}, '2': {'precision': 0.3704276759501706, 'recall': 0.09111490607465235, 'f1-score': 0.1462551201823294, 'support': 102475}, 'accuracy': 0.3493317963346489, 'macro avg': {'precision': 0.35460859890714175, 'recall': 0.3484401004926662, 'f1-score': 0.31412237321008823, 'support': 307092}, 'weighted avg': {'precision': 0.3546568442906765, 'recall': 0.3493317963346489, 'f1-score': 0.31442784016649444, 'support': 307092}}
[[59475 35802  8700]
 [55006 38465  7169]
 [55278 37860  9337]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1158009
{'0': {'precision': 0.3563870719507503, 'recall': 0.5779430116472546, 'f1-score': 0.4408964696548989, 'support': 38464}, '1': {'precision': 0.35843685924496443, 'recall': 0.3934178823903201, 'f1-score': 0.3751136019388064, 'support': 37769}, '2': {'precision': 0.3441536560709873, 'recall': 0.08394290567381715, 'f1-score': 0.13496608228349924, 'support': 36501}, 'accuracy': 0.35617471215427465, 'macro avg': {'precision': 0.35299252908890066, 'recall': 0.3517679332371306, 'f1-score': 0.31699205129240154, 'support': 112734}, 'weighted avg': {'precision': 0.3531128734240232, 'recall': 0.35617471215427465, 'f1-score': 0.319803292794213, 'support': 112734}}
[[22230 13417  2817]
 [19888 14859  3022]
 [20258 13179  3064]]
training model: results/WBA/W9/deepLOB_L2/h300
Epoch 1/50
1200/1200 - 52s - loss: 3.3064 - accuracy300: 0.3677 - val_loss: 3.3953 - val_accuracy300: 0.3252 - 52s/epoch - 43ms/step
Epoch 2/50
1200/1200 - 50s - loss: 3.2744 - accuracy300: 0.3795 - val_loss: 3.3329 - val_accuracy300: 0.3247 - 50s/epoch - 42ms/step
Epoch 3/50
1200/1200 - 50s - loss: 3.2599 - accuracy300: 0.3904 - val_loss: 3.3846 - val_accuracy300: 0.3391 - 50s/epoch - 42ms/step
Epoch 4/50
1200/1200 - 51s - loss: 3.2509 - accuracy300: 0.3956 - val_loss: 3.3648 - val_accuracy300: 0.3396 - 51s/epoch - 43ms/step
Epoch 5/50
1200/1200 - 51s - loss: 3.2387 - accuracy300: 0.4028 - val_loss: 3.3653 - val_accuracy300: 0.3306 - 51s/epoch - 42ms/step
Epoch 6/50
1200/1200 - 49s - loss: 3.2304 - accuracy300: 0.4087 - val_loss: 3.3868 - val_accuracy300: 0.3340 - 49s/epoch - 41ms/step
Epoch 7/50
1200/1200 - 50s - loss: 3.2227 - accuracy300: 0.4134 - val_loss: 3.3846 - val_accuracy300: 0.3331 - 50s/epoch - 41ms/step
Epoch 8/50
1200/1200 - 50s - loss: 3.2132 - accuracy300: 0.4175 - val_loss: 3.3952 - val_accuracy300: 0.3295 - 50s/epoch - 41ms/step
Epoch 9/50
1200/1200 - 49s - loss: 3.2041 - accuracy300: 0.4233 - val_loss: 3.3890 - val_accuracy300: 0.3306 - 49s/epoch - 41ms/step
Epoch 10/50
1200/1200 - 49s - loss: 3.1961 - accuracy300: 0.4270 - val_loss: 3.3924 - val_accuracy300: 0.3266 - 49s/epoch - 41ms/step
Epoch 11/50
1200/1200 - 50s - loss: 3.1896 - accuracy300: 0.4291 - val_loss: 3.4365 - val_accuracy300: 0.3257 - 50s/epoch - 42ms/step
Epoch 12/50
1200/1200 - 50s - loss: 3.1811 - accuracy300: 0.4343 - val_loss: 3.4045 - val_accuracy300: 0.3283 - 50s/epoch - 42ms/step
testing model: results/WBA/W9/deepLOB_L2/h300
Evaluating performance on  test set...
2451/2451 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1029245
{'0': {'precision': 0.3340156261700906, 'recall': 0.19017998000748534, 'f1-score': 0.24236405020799245, 'support': 211079}, '1': {'precision': 0.3399259130390505, 'recall': 0.7504695704308806, 'f1-score': 0.46791106126913057, 'support': 213493}, '2': {'precision': 0.3351758793969849, 'recall': 0.05921023430603297, 'f1-score': 0.10064168926480266, 'support': 202769}, 'accuracy': 0.3385224303847509, 'macro avg': {'precision': 0.3363724728687087, 'recall': 0.33328659491479967, 'f1-score': 0.2703056002473086, 'support': 627341}, 'weighted avg': {'precision': 0.3364019969972468, 'recall': 0.3385224303847509, 'f1-score': 0.2733134168624689, 'support': 627341}}
[[ 40143 158970  11966]
 [ 41425 160220  11848]
 [ 38615 152148  12006]]
Evaluating performance on  train set...
1200/1200 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.11728
{'0': {'precision': 0.33634303392208353, 'recall': 0.3523116922265345, 'f1-score': 0.3441422209135412, 'support': 106156}, '1': {'precision': 0.3182367871998299, 'recall': 0.4932237600922722, 'f1-score': 0.38686278786116424, 'support': 97104}, '2': {'precision': 0.349817172562668, 'recall': 0.15294899452962477, 'f1-score': 0.21283924143938887, 'support': 103832}, 'accuracy': 0.32946152944394513, 'macro avg': {'precision': 0.33479899789486045, 'recall': 0.33282814894947715, 'f1-score': 0.31461475007136475, 'support': 307092}, 'weighted avg': {'precision': 0.3351735400297367, 'recall': 0.32946152944394513, 'f1-score': 0.3132553432616382, 'support': 307092}}
[[37400 52437 16319]
 [36012 47894 13198]
 [37784 50167 15881]]
Evaluating performance on  val set...
441/441 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1118287
{'0': {'precision': 0.33605778369131345, 'recall': 0.31651364415232347, 'f1-score': 0.3259930460436203, 'support': 39101}, '1': {'precision': 0.315821568482519, 'recall': 0.4583757978866062, 'f1-score': 0.37397431128421693, 'support': 37286}, '2': {'precision': 0.33463356431554314, 'recall': 0.20062178446639337, 'f1-score': 0.2508514224775534, 'support': 36347}, 'accuracy': 0.3260684443025174, 'macro avg': {'precision': 0.32883763882979183, 'recall': 0.32517040883510767, 'f1-score': 0.31693959326846355, 'support': 112734}, 'weighted avg': {'precision': 0.32890560580419664, 'recall': 0.3260684443025174, 'f1-score': 0.31763582341340274, 'support': 112734}}
[[12376 19509  7216]
 [12912 17091  7283]
 [11539 17516  7292]]
training model: results/WBA/W9/deepLOB_L2/h500
Epoch 1/50
1200/1200 - 52s - loss: 3.2713 - accuracy500: 0.3929 - val_loss: 3.3183 - val_accuracy500: 0.3418 - 52s/epoch - 43ms/step
Epoch 2/50
1200/1200 - 50s - loss: 3.2362 - accuracy500: 0.4080 - val_loss: 3.3273 - val_accuracy500: 0.3390 - 50s/epoch - 41ms/step
Epoch 3/50
1200/1200 - 49s - loss: 3.2250 - accuracy500: 0.4185 - val_loss: 3.3876 - val_accuracy500: 0.3374 - 49s/epoch - 41ms/step
Epoch 4/50
1200/1200 - 50s - loss: 3.2143 - accuracy500: 0.4239 - val_loss: 3.3893 - val_accuracy500: 0.3398 - 50s/epoch - 41ms/step
Epoch 5/50
1200/1200 - 49s - loss: 3.2031 - accuracy500: 0.4274 - val_loss: 3.3741 - val_accuracy500: 0.3444 - 49s/epoch - 41ms/step
Epoch 6/50
1200/1200 - 48s - loss: 3.1885 - accuracy500: 0.4360 - val_loss: 3.3630 - val_accuracy500: 0.3403 - 48s/epoch - 40ms/step
Epoch 7/50
1200/1200 - 48s - loss: 3.1776 - accuracy500: 0.4400 - val_loss: 3.3854 - val_accuracy500: 0.3415 - 48s/epoch - 40ms/step
Epoch 8/50
1200/1200 - 48s - loss: 3.1680 - accuracy500: 0.4438 - val_loss: 3.4235 - val_accuracy500: 0.3446 - 48s/epoch - 40ms/step
Epoch 9/50
1200/1200 - 48s - loss: 3.1574 - accuracy500: 0.4474 - val_loss: 3.3947 - val_accuracy500: 0.3442 - 48s/epoch - 40ms/step
Epoch 10/50
1200/1200 - 49s - loss: 3.1486 - accuracy500: 0.4510 - val_loss: 3.3638 - val_accuracy500: 0.3501 - 49s/epoch - 41ms/step
Epoch 11/50
1200/1200 - 48s - loss: 3.1430 - accuracy500: 0.4538 - val_loss: 3.3753 - val_accuracy500: 0.3518 - 48s/epoch - 40ms/step
testing model: results/WBA/W9/deepLOB_L2/h500
Evaluating performance on  test set...
2451/2451 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1030048
{'0': {'precision': 0.3500099661152083, 'recall': 0.6244553278836112, 'f1-score': 0.4485856797548889, 'support': 222152}, '1': {'precision': 0.28937156842223904, 'recall': 0.09465623123676699, 'f1-score': 0.14265020458541194, 'support': 189866}, '2': {'precision': 0.33734775683725005, 'recall': 0.2646024809240072, 'f1-score': 0.29657951037702945, 'support': 215323}, 'accuracy': 0.3405978566680641, 'macro avg': {'precision': 0.3255764304582325, 'recall': 0.32790468001479517, 'f1-score': 0.29593846490577674, 'support': 627341}, 'weighted avg': {'precision': 0.3273115693824408, 'recall': 0.3405978566680641, 'f1-score': 0.30382044149136594, 'support': 627341}}
[[138724  23024  60404]
 [120382  17972  51512]
 [137237  21111  56975]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1058369
{'0': {'precision': 0.3409672717636147, 'recall': 0.6128608173763933, 'f1-score': 0.43816172589351093, 'support': 104970}, '1': {'precision': 0.3431425779129113, 'recall': 0.06295447753760335, 'f1-score': 0.10639014207797454, 'support': 100390}, '2': {'precision': 0.33351333513335135, 'recall': 0.32783195061534226, 'f1-score': 0.3306482394872379, 'support': 101732}, 'accuracy': 0.3386704961379652, 'macro avg': {'precision': 0.3392077282699591, 'recall': 0.33454908184311294, 'f1-score': 0.2917333691529078, 'support': 307092}, 'weighted avg': {'precision': 0.33920908562740126, 'recall': 0.3386704961379652, 'f1-score': 0.29408727492010667, 'support': 307092}}
[[64332  6296 34342]
 [61764  6320 32306]
 [62579  5802 33351]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1053334
{'0': {'precision': 0.34564656038841557, 'recall': 0.5597315772341438, 'f1-score': 0.42737787974381036, 'support': 39937}, '1': {'precision': 0.2978588421887391, 'recall': 0.05257705982810269, 'f1-score': 0.08937749857224445, 'support': 35719}, '2': {'precision': 0.3420107289970304, 'recall': 0.3851610119208156, 'f1-score': 0.36230560418093716, 'support': 37078}, 'accuracy': 0.34162719321588875, 'macro avg': {'precision': 0.32850537719139505, 'recall': 0.33248988299435406, 'f1-score': 0.2930203274989973, 'support': 112734}, 'weighted avg': {'precision': 0.3293095293001545, 'recall': 0.34162719321588875, 'f1-score': 0.2988826125805111, 'support': 112734}}
[[22354  2256 15327]
 [21693  1878 12148]
 [20626  2171 14281]]
training model: results/WBA/W9/deepLOB_L2/h1000
Epoch 1/50
1200/1200 - 52s - loss: 3.2775 - accuracy1000: 0.3950 - val_loss: 3.5262 - val_accuracy1000: 0.3416 - 52s/epoch - 44ms/step
Epoch 2/50
1200/1200 - 50s - loss: 3.2423 - accuracy1000: 0.4011 - val_loss: 3.3674 - val_accuracy1000: 0.3286 - 50s/epoch - 41ms/step
Epoch 3/50
1200/1200 - 49s - loss: 3.2097 - accuracy1000: 0.4196 - val_loss: 3.3680 - val_accuracy1000: 0.3293 - 49s/epoch - 41ms/step
Epoch 4/50
1200/1200 - 48s - loss: 3.1841 - accuracy1000: 0.4296 - val_loss: 3.4157 - val_accuracy1000: 0.3265 - 48s/epoch - 40ms/step
Epoch 5/50
1200/1200 - 48s - loss: 3.1612 - accuracy1000: 0.4384 - val_loss: 3.3891 - val_accuracy1000: 0.3305 - 48s/epoch - 40ms/step
Epoch 6/50
1200/1200 - 49s - loss: 3.1489 - accuracy1000: 0.4445 - val_loss: 3.4201 - val_accuracy1000: 0.3291 - 49s/epoch - 41ms/step
Epoch 7/50
1200/1200 - 49s - loss: 3.1359 - accuracy1000: 0.4523 - val_loss: 3.4303 - val_accuracy1000: 0.3216 - 49s/epoch - 41ms/step
Epoch 8/50
1200/1200 - 48s - loss: 3.1191 - accuracy1000: 0.4579 - val_loss: 3.4584 - val_accuracy1000: 0.3232 - 48s/epoch - 40ms/step
Epoch 9/50
1200/1200 - 49s - loss: 3.1046 - accuracy1000: 0.4640 - val_loss: 3.4542 - val_accuracy1000: 0.3201 - 49s/epoch - 41ms/step
Epoch 10/50
1200/1200 - 48s - loss: 3.1003 - accuracy1000: 0.4638 - val_loss: 3.4987 - val_accuracy1000: 0.3150 - 48s/epoch - 40ms/step
Epoch 11/50
1200/1200 - 49s - loss: 3.0864 - accuracy1000: 0.4689 - val_loss: 3.4893 - val_accuracy1000: 0.3168 - 49s/epoch - 40ms/step
Epoch 12/50
1200/1200 - 48s - loss: 3.0751 - accuracy1000: 0.4745 - val_loss: 3.4585 - val_accuracy1000: 0.3183 - 48s/epoch - 40ms/step
testing model: results/WBA/W9/deepLOB_L2/h1000
Evaluating performance on  test set...
2451/2451 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1213728
{'0': {'precision': 0.32680869130239226, 'recall': 0.7602282283456867, 'f1-score': 0.4571127031770437, 'support': 204532}, '1': {'precision': 0.3524618207831794, 'recall': 0.1021080279868986, 'f1-score': 0.15834390053901481, 'support': 221961}, '2': {'precision': 0.3260059826023174, 'recall': 0.14162451206882817, 'f1-score': 0.19746547217815974, 'support': 200848}, 'accuracy': 0.32932647475615334, 'macro avg': {'precision': 0.33509216489596305, 'recall': 0.3346535894671378, 'f1-score': 0.27097402529807274, 'support': 627341}, 'weighted avg': {'precision': 0.3356280922911565, 'recall': 0.32932647475615334, 'f1-score': 0.2682765689948312, 'support': 627341}}
[[155491  21036  28005]
 [168494  22664  30803]
 [151801  20602  28445]]
Evaluating performance on  train set...
1200/1200 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1297722
{'0': {'precision': 0.33924054498353545, 'recall': 0.6346523717936511, 'f1-score': 0.44214268894129194, 'support': 105026}, '1': {'precision': 0.33392272675971557, 'recall': 0.08728488543612942, 'f1-score': 0.13839449290954306, 'support': 101690}, '2': {'precision': 0.3340672156900081, 'recall': 0.27965848409978483, 'f1-score': 0.30445109650549884, 'support': 100376}, 'accuracy': 0.3373646985268258, 'macro avg': {'precision': 0.3357434958110863, 'recall': 0.3338652471098551, 'f1-score': 0.29499609278544464, 'support': 307092}, 'weighted avg': {'precision': 0.3357886574828928, 'recall': 0.3373646985268258, 'f1-score': 0.2965541182953496, 'support': 307092}}
[[66655  8970 29401]
 [66258  8876 26556]
 [63570  8735 28071]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1216404
{'0': {'precision': 0.33115924564680366, 'recall': 0.5788572933122696, 'f1-score': 0.42129771577495023, 'support': 37980}, '1': {'precision': 0.3425717048018047, 'recall': 0.08088365840667563, 'f1-score': 0.13086835193696653, 'support': 39427}, '2': {'precision': 0.3227853227853228, 'recall': 0.3384097149489059, 'f1-score': 0.33041291249792715, 'support': 35327}, 'accuracy': 0.32935050650203135, 'macro avg': {'precision': 0.33217209107797707, 'recall': 0.33271688888928375, 'f1-score': 0.2941929934032813, 'support': 112734}, 'weighted avg': {'precision': 0.3325264769539221, 'recall': 0.32935050650203135, 'f1-score': 0.2912442627491765, 'support': 112734}}
[[21985  3159 12836]
 [23992  3189 12246]
 [20411  2961 11955]]
training model: results/WBA/W9/deepOF_L2/h10
Epoch 1/50
1200/1200 - 30s - loss: 3.0031 - accuracy10: 0.4724 - val_loss: 2.9244 - val_accuracy10: 0.5420 - 30s/epoch - 25ms/step
Epoch 2/50
1200/1200 - 27s - loss: 2.7751 - accuracy10: 0.5503 - val_loss: 2.7871 - val_accuracy10: 0.5701 - 27s/epoch - 22ms/step
Epoch 3/50
1200/1200 - 26s - loss: 2.6900 - accuracy10: 0.5707 - val_loss: 2.7373 - val_accuracy10: 0.5753 - 26s/epoch - 22ms/step
Epoch 4/50
1200/1200 - 27s - loss: 2.6487 - accuracy10: 0.5768 - val_loss: 2.7096 - val_accuracy10: 0.5814 - 27s/epoch - 23ms/step
Epoch 5/50
1200/1200 - 27s - loss: 2.6262 - accuracy10: 0.5795 - val_loss: 2.6984 - val_accuracy10: 0.5861 - 27s/epoch - 22ms/step
Epoch 6/50
1200/1200 - 27s - loss: 2.6100 - accuracy10: 0.5829 - val_loss: 2.6932 - val_accuracy10: 0.5794 - 27s/epoch - 22ms/step
Epoch 7/50
1200/1200 - 27s - loss: 2.5952 - accuracy10: 0.5854 - val_loss: 2.6784 - val_accuracy10: 0.5848 - 27s/epoch - 22ms/step
Epoch 8/50
1200/1200 - 26s - loss: 2.5857 - accuracy10: 0.5874 - val_loss: 2.6841 - val_accuracy10: 0.5869 - 26s/epoch - 22ms/step
Epoch 9/50
1200/1200 - 27s - loss: 2.5767 - accuracy10: 0.5878 - val_loss: 2.6747 - val_accuracy10: 0.5885 - 27s/epoch - 22ms/step
Epoch 10/50
1200/1200 - 27s - loss: 2.5680 - accuracy10: 0.5895 - val_loss: 2.6759 - val_accuracy10: 0.5897 - 27s/epoch - 22ms/step
Epoch 11/50
1200/1200 - 27s - loss: 2.5599 - accuracy10: 0.5909 - val_loss: 2.6656 - val_accuracy10: 0.5920 - 27s/epoch - 22ms/step
Epoch 12/50
1200/1200 - 27s - loss: 2.5525 - accuracy10: 0.5921 - val_loss: 2.6734 - val_accuracy10: 0.5924 - 27s/epoch - 22ms/step
Epoch 13/50
1200/1200 - 27s - loss: 2.5464 - accuracy10: 0.5929 - val_loss: 2.6637 - val_accuracy10: 0.5904 - 27s/epoch - 22ms/step
Epoch 14/50
1200/1200 - 27s - loss: 2.5395 - accuracy10: 0.5933 - val_loss: 2.6723 - val_accuracy10: 0.5945 - 27s/epoch - 22ms/step
Epoch 15/50
1200/1200 - 26s - loss: 2.5328 - accuracy10: 0.5946 - val_loss: 2.6665 - val_accuracy10: 0.5942 - 26s/epoch - 22ms/step
Epoch 16/50
1200/1200 - 26s - loss: 2.5258 - accuracy10: 0.5958 - val_loss: 2.6700 - val_accuracy10: 0.5913 - 26s/epoch - 22ms/step
Epoch 17/50
1200/1200 - 26s - loss: 2.5207 - accuracy10: 0.5966 - val_loss: 2.6740 - val_accuracy10: 0.5899 - 26s/epoch - 22ms/step
Epoch 18/50
1200/1200 - 26s - loss: 2.5159 - accuracy10: 0.5969 - val_loss: 2.6638 - val_accuracy10: 0.5919 - 26s/epoch - 22ms/step
Epoch 19/50
1200/1200 - 27s - loss: 2.5092 - accuracy10: 0.5981 - val_loss: 2.6612 - val_accuracy10: 0.5884 - 27s/epoch - 22ms/step
Epoch 20/50
1200/1200 - 27s - loss: 2.5045 - accuracy10: 0.6000 - val_loss: 2.6612 - val_accuracy10: 0.5905 - 27s/epoch - 22ms/step
Epoch 21/50
1200/1200 - 27s - loss: 2.4979 - accuracy10: 0.6002 - val_loss: 2.6734 - val_accuracy10: 0.5913 - 27s/epoch - 22ms/step
Epoch 22/50
1200/1200 - 27s - loss: 2.4943 - accuracy10: 0.6011 - val_loss: 2.6671 - val_accuracy10: 0.5887 - 27s/epoch - 22ms/step
Epoch 23/50
1200/1200 - 26s - loss: 2.4887 - accuracy10: 0.6019 - val_loss: 2.6600 - val_accuracy10: 0.5880 - 26s/epoch - 22ms/step
Epoch 24/50
1200/1200 - 27s - loss: 2.4822 - accuracy10: 0.6026 - val_loss: 2.6898 - val_accuracy10: 0.5867 - 27s/epoch - 22ms/step
Epoch 25/50
1200/1200 - 27s - loss: 2.4771 - accuracy10: 0.6026 - val_loss: 2.6881 - val_accuracy10: 0.5873 - 27s/epoch - 22ms/step
Epoch 26/50
1200/1200 - 27s - loss: 2.4726 - accuracy10: 0.6037 - val_loss: 2.6870 - val_accuracy10: 0.5812 - 27s/epoch - 22ms/step
Epoch 27/50
1200/1200 - 27s - loss: 2.4680 - accuracy10: 0.6049 - val_loss: 2.6914 - val_accuracy10: 0.5843 - 27s/epoch - 22ms/step
Epoch 28/50
1200/1200 - 27s - loss: 2.4622 - accuracy10: 0.6061 - val_loss: 2.6939 - val_accuracy10: 0.5841 - 27s/epoch - 22ms/step
Epoch 29/50
1200/1200 - 27s - loss: 2.4567 - accuracy10: 0.6064 - val_loss: 2.6797 - val_accuracy10: 0.5828 - 27s/epoch - 22ms/step
Epoch 30/50
1200/1200 - 27s - loss: 2.4539 - accuracy10: 0.6064 - val_loss: 2.6947 - val_accuracy10: 0.5840 - 27s/epoch - 22ms/step
Epoch 31/50
1200/1200 - 27s - loss: 2.4488 - accuracy10: 0.6076 - val_loss: 2.7179 - val_accuracy10: 0.5825 - 27s/epoch - 22ms/step
Epoch 32/50
1200/1200 - 26s - loss: 2.4424 - accuracy10: 0.6079 - val_loss: 2.7140 - val_accuracy10: 0.5839 - 26s/epoch - 22ms/step
Epoch 33/50
1200/1200 - 27s - loss: 2.4383 - accuracy10: 0.6091 - val_loss: 2.6989 - val_accuracy10: 0.5860 - 27s/epoch - 22ms/step
testing model: results/WBA/W9/deepOF_L2/h10
Evaluating performance on  test set...
2451/2451 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9003658
{'0': {'precision': 0.41359546638734457, 'recall': 0.5797181104970712, 'f1-score': 0.4827655392293633, 'support': 132818}, '1': {'precision': 0.7619221385078813, 'recall': 0.5800593203489497, 'f1-score': 0.6586678748873093, 'support': 367159}, '2': {'precision': 0.41965357253325086, 'recall': 0.5326397613065327, 'f1-score': 0.4694439638766825, 'support': 127360}, 'accuracy': 0.5703601094786375, 'macro avg': {'precision': 0.5317237258094922, 'recall': 0.5641390640508512, 'f1-score': 0.5369591259977851, 'support': 627337}, 'weighted avg': {'precision': 0.6186891130363494, 'recall': 0.5703601094786375, 'f1-score': 0.5830106862889475, 'support': 627337}}
[[ 76997  34296  21525]
 [ 81897 212974  72288]
 [ 27271  32252  67837]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86836916
{'0': {'precision': 0.4362129807477554, 'recall': 0.6032461816440937, 'f1-score': 0.5063090971542633, 'support': 64753}, '1': {'precision': 0.7976965410003506, 'recall': 0.5874299763126284, 'f1-score': 0.6766036955144368, 'support': 178154}, '2': {'precision': 0.43439186528617424, 'recall': 0.5844097162711706, 'f1-score': 0.4983557767045115, 'support': 64181}, 'accuracy': 0.590133772729641, 'macro avg': {'precision': 0.5561004623447601, 'recall': 0.5916952914092976, 'f1-score': 0.5604228564577372, 'support': 307088}, 'weighted avg': {'precision': 0.6455434045409387, 'recall': 0.590133772729641, 'f1-score': 0.6034415537024607, 'support': 307088}}
[[ 39062  13536  12155]
 [ 36818 104653  36683]
 [ 13668  13005  37508]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87375915
{'0': {'precision': 0.4311327964258421, 'recall': 0.5933897002305919, 'f1-score': 0.4994126759844062, 'support': 24719}, '1': {'precision': 0.7942071264846843, 'recall': 0.5929463743991039, 'f1-score': 0.6789763870703399, 'support': 64279}, '2': {'precision': 0.4397500162749821, 'recall': 0.5691776204920795, 'f1-score': 0.4961621800286459, 'support': 23736}, 'accuracy': 0.5880391008923661, 'macro avg': {'precision': 0.5550299797285029, 'recall': 0.5851712317072585, 'f1-score': 0.558183747694464, 'support': 112734}, 'weighted avg': {'precision': 0.6399659185734773, 'recall': 0.5880391008923661, 'f1-score': 0.6011124472414077, 'support': 112734}}
[[14668  5307  4744]
 [13697 38114 12468]
 [ 5657  4569 13510]]
training model: results/WBA/W9/deepOF_L2/h20
Epoch 1/50
1200/1200 - 29s - loss: 3.0473 - accuracy20: 0.4669 - val_loss: 2.9740 - val_accuracy20: 0.5144 - 29s/epoch - 24ms/step
Epoch 2/50
1200/1200 - 27s - loss: 2.8445 - accuracy20: 0.5345 - val_loss: 2.8593 - val_accuracy20: 0.5465 - 27s/epoch - 22ms/step
Epoch 3/50
1200/1200 - 27s - loss: 2.7685 - accuracy20: 0.5558 - val_loss: 2.8113 - val_accuracy20: 0.5530 - 27s/epoch - 22ms/step
Epoch 4/50
1200/1200 - 27s - loss: 2.7302 - accuracy20: 0.5639 - val_loss: 2.7856 - val_accuracy20: 0.5596 - 27s/epoch - 22ms/step
Epoch 5/50
1200/1200 - 27s - loss: 2.7104 - accuracy20: 0.5680 - val_loss: 2.7720 - val_accuracy20: 0.5602 - 27s/epoch - 22ms/step
Epoch 6/50
1200/1200 - 26s - loss: 2.6959 - accuracy20: 0.5702 - val_loss: 2.7619 - val_accuracy20: 0.5603 - 26s/epoch - 22ms/step
Epoch 7/50
1200/1200 - 26s - loss: 2.6826 - accuracy20: 0.5734 - val_loss: 2.7649 - val_accuracy20: 0.5618 - 26s/epoch - 22ms/step
Epoch 8/50
1200/1200 - 27s - loss: 2.6727 - accuracy20: 0.5758 - val_loss: 2.7680 - val_accuracy20: 0.5662 - 27s/epoch - 22ms/step
Epoch 9/50
1200/1200 - 27s - loss: 2.6623 - accuracy20: 0.5771 - val_loss: 2.7566 - val_accuracy20: 0.5648 - 27s/epoch - 22ms/step
Epoch 10/50
1200/1200 - 26s - loss: 2.6565 - accuracy20: 0.5775 - val_loss: 2.7476 - val_accuracy20: 0.5689 - 26s/epoch - 22ms/step
Epoch 11/50
1200/1200 - 26s - loss: 2.6480 - accuracy20: 0.5804 - val_loss: 2.7618 - val_accuracy20: 0.5669 - 26s/epoch - 22ms/step
Epoch 12/50
1200/1200 - 26s - loss: 2.6427 - accuracy20: 0.5812 - val_loss: 2.7450 - val_accuracy20: 0.5681 - 26s/epoch - 22ms/step
Epoch 13/50
1200/1200 - 26s - loss: 2.6350 - accuracy20: 0.5831 - val_loss: 2.7468 - val_accuracy20: 0.5688 - 26s/epoch - 22ms/step
Epoch 14/50
1200/1200 - 27s - loss: 2.6306 - accuracy20: 0.5837 - val_loss: 2.7529 - val_accuracy20: 0.5668 - 27s/epoch - 22ms/step
Epoch 15/50
1200/1200 - 26s - loss: 2.6236 - accuracy20: 0.5854 - val_loss: 2.7486 - val_accuracy20: 0.5679 - 26s/epoch - 22ms/step
Epoch 16/50
1200/1200 - 27s - loss: 2.6183 - accuracy20: 0.5871 - val_loss: 2.7412 - val_accuracy20: 0.5689 - 27s/epoch - 22ms/step
Epoch 17/50
1200/1200 - 27s - loss: 2.6135 - accuracy20: 0.5866 - val_loss: 2.7460 - val_accuracy20: 0.5676 - 27s/epoch - 22ms/step
Epoch 18/50
1200/1200 - 26s - loss: 2.6067 - accuracy20: 0.5878 - val_loss: 2.7392 - val_accuracy20: 0.5649 - 26s/epoch - 22ms/step
Epoch 19/50
1200/1200 - 26s - loss: 2.6022 - accuracy20: 0.5893 - val_loss: 2.7498 - val_accuracy20: 0.5660 - 26s/epoch - 22ms/step
Epoch 20/50
1200/1200 - 27s - loss: 2.5963 - accuracy20: 0.5905 - val_loss: 2.7438 - val_accuracy20: 0.5670 - 27s/epoch - 22ms/step
Epoch 21/50
1200/1200 - 27s - loss: 2.5907 - accuracy20: 0.5915 - val_loss: 2.7380 - val_accuracy20: 0.5696 - 27s/epoch - 22ms/step
Epoch 22/50
1200/1200 - 27s - loss: 2.5849 - accuracy20: 0.5923 - val_loss: 2.7326 - val_accuracy20: 0.5665 - 27s/epoch - 22ms/step
Epoch 23/50
1200/1200 - 26s - loss: 2.5813 - accuracy20: 0.5929 - val_loss: 2.7426 - val_accuracy20: 0.5676 - 26s/epoch - 22ms/step
Epoch 24/50
1200/1200 - 27s - loss: 2.5758 - accuracy20: 0.5933 - val_loss: 2.7509 - val_accuracy20: 0.5648 - 27s/epoch - 22ms/step
Epoch 25/50
1200/1200 - 27s - loss: 2.5701 - accuracy20: 0.5942 - val_loss: 2.7526 - val_accuracy20: 0.5648 - 27s/epoch - 22ms/step
Epoch 26/50
1200/1200 - 27s - loss: 2.5648 - accuracy20: 0.5956 - val_loss: 2.7664 - val_accuracy20: 0.5627 - 27s/epoch - 22ms/step
Epoch 27/50
1200/1200 - 27s - loss: 2.5601 - accuracy20: 0.5969 - val_loss: 2.7538 - val_accuracy20: 0.5675 - 27s/epoch - 22ms/step
Epoch 28/50
1200/1200 - 27s - loss: 2.5545 - accuracy20: 0.5979 - val_loss: 2.7573 - val_accuracy20: 0.5656 - 27s/epoch - 22ms/step
Epoch 29/50
1200/1200 - 26s - loss: 2.5490 - accuracy20: 0.5982 - val_loss: 2.7680 - val_accuracy20: 0.5615 - 26s/epoch - 22ms/step
Epoch 30/50
1200/1200 - 26s - loss: 2.5447 - accuracy20: 0.5997 - val_loss: 2.7576 - val_accuracy20: 0.5632 - 26s/epoch - 22ms/step
Epoch 31/50
1200/1200 - 27s - loss: 2.5384 - accuracy20: 0.6002 - val_loss: 2.7628 - val_accuracy20: 0.5657 - 27s/epoch - 22ms/step
Epoch 32/50
1200/1200 - 26s - loss: 2.5328 - accuracy20: 0.6017 - val_loss: 2.7671 - val_accuracy20: 0.5616 - 26s/epoch - 22ms/step
testing model: results/WBA/W9/deepOF_L2/h20
Evaluating performance on  test set...
2451/2451 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9407329
{'0': {'precision': 0.45356528641354676, 'recall': 0.6083934697740447, 'f1-score': 0.5196927974130309, 'support': 169060}, '1': {'precision': 0.654180228187761, 'recall': 0.5602103063597452, 'f1-score': 0.6035595562083447, 'support': 296710}, '2': {'precision': 0.48674203634675517, 'recall': 0.4412844207047231, 'f1-score': 0.462899900988492, 'support': 161567}, 'accuracy': 0.542566435584064, 'macro avg': {'precision': 0.531495850316021, 'recall': 0.536629398946171, 'f1-score': 0.5287174182032892, 'support': 627337}, 'weighted avg': {'precision': 0.5569941090882587, 'recall': 0.542566435584064, 'f1-score': 0.5447323664254343, 'support': 627337}}
[[102855  41447  24758]
 [ 80067 166220  50423]
 [ 43848  46422  71297]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89624256
{'0': {'precision': 0.4722314002775444, 'recall': 0.6152285137993802, 'f1-score': 0.5343281509530702, 'support': 81308}, '1': {'precision': 0.6963821349629437, 'recall': 0.590264432183718, 'f1-score': 0.6389471918280611, 'support': 145179}, '2': {'precision': 0.5059216675415797, 'recall': 0.4902420565501669, 'f1-score': 0.4979584635547938, 'support': 80601}, 'accuracy': 0.5706214505288386, 'macro avg': {'precision': 0.5581784009273559, 'recall': 0.5652450008444216, 'f1-score': 0.5570779354453084, 'support': 307088}, 'weighted avg': {'precision': 0.5870435998510872, 'recall': 0.5706214505288386, 'f1-score': 0.5742419690156509, 'support': 307088}}
[[50023 17502 13783]
 [34679 85694 24806]
 [21227 19860 39514]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9003815
{'0': {'precision': 0.4693980017070844, 'recall': 0.6075513387054848, 'f1-score': 0.52961336921116, 'support': 30776}, '1': {'precision': 0.6971837302121171, 'recall': 0.5921122790981109, 'f1-score': 0.6403665945834621, 'support': 52512}, '2': {'precision': 0.49791534167196666, 'recall': 0.47857094342185696, 'f1-score': 0.48805153425226844, 'support': 29446}, 'accuracy': 0.5666702148420175, 'macro avg': {'precision': 0.5548323578637228, 'recall': 0.5594115204084843, 'f1-score': 0.5526771660156301, 'support': 112734}, 'weighted avg': {'precision': 0.5829503086230299, 'recall': 0.5666702148420175, 'f1-score': 0.5703468087994901, 'support': 112734}}
[[18698  6808  5270]
 [12479 31093  8940]
 [ 8657  6697 14092]]
training model: results/WBA/W9/deepOF_L2/h30
Epoch 1/50
1200/1200 - 29s - loss: 3.0843 - accuracy30: 0.4588 - val_loss: 3.0231 - val_accuracy30: 0.4828 - 29s/epoch - 24ms/step
Epoch 2/50
1200/1200 - 27s - loss: 2.9074 - accuracy30: 0.5179 - val_loss: 2.9209 - val_accuracy30: 0.5211 - 27s/epoch - 22ms/step
Epoch 3/50
1200/1200 - 26s - loss: 2.8372 - accuracy30: 0.5358 - val_loss: 2.8641 - val_accuracy30: 0.5328 - 26s/epoch - 22ms/step
Epoch 4/50
1200/1200 - 27s - loss: 2.8002 - accuracy30: 0.5460 - val_loss: 2.8463 - val_accuracy30: 0.5347 - 27s/epoch - 22ms/step
Epoch 5/50
1200/1200 - 26s - loss: 2.7801 - accuracy30: 0.5500 - val_loss: 2.8416 - val_accuracy30: 0.5382 - 26s/epoch - 22ms/step
Epoch 6/50
1200/1200 - 27s - loss: 2.7655 - accuracy30: 0.5534 - val_loss: 2.8354 - val_accuracy30: 0.5399 - 27s/epoch - 22ms/step
Epoch 7/50
1200/1200 - 27s - loss: 2.7553 - accuracy30: 0.5557 - val_loss: 2.8331 - val_accuracy30: 0.5401 - 27s/epoch - 23ms/step
Epoch 8/50
1200/1200 - 27s - loss: 2.7457 - accuracy30: 0.5580 - val_loss: 2.8316 - val_accuracy30: 0.5412 - 27s/epoch - 22ms/step
Epoch 9/50
1200/1200 - 26s - loss: 2.7359 - accuracy30: 0.5594 - val_loss: 2.8137 - val_accuracy30: 0.5413 - 26s/epoch - 22ms/step
Epoch 10/50
1200/1200 - 26s - loss: 2.7292 - accuracy30: 0.5617 - val_loss: 2.8206 - val_accuracy30: 0.5419 - 26s/epoch - 22ms/step
Epoch 11/50
1200/1200 - 27s - loss: 2.7221 - accuracy30: 0.5628 - val_loss: 2.8170 - val_accuracy30: 0.5402 - 27s/epoch - 22ms/step
Epoch 12/50
1200/1200 - 27s - loss: 2.7161 - accuracy30: 0.5636 - val_loss: 2.8126 - val_accuracy30: 0.5405 - 27s/epoch - 22ms/step
Epoch 13/50
1200/1200 - 26s - loss: 2.7084 - accuracy30: 0.5662 - val_loss: 2.8222 - val_accuracy30: 0.5407 - 26s/epoch - 22ms/step
Epoch 14/50
1200/1200 - 26s - loss: 2.7038 - accuracy30: 0.5667 - val_loss: 2.8164 - val_accuracy30: 0.5416 - 26s/epoch - 22ms/step
Epoch 15/50
1200/1200 - 26s - loss: 2.6975 - accuracy30: 0.5678 - val_loss: 2.8237 - val_accuracy30: 0.5416 - 26s/epoch - 22ms/step
Epoch 16/50
1200/1200 - 27s - loss: 2.6911 - accuracy30: 0.5697 - val_loss: 2.8315 - val_accuracy30: 0.5396 - 27s/epoch - 22ms/step
Epoch 17/50
1200/1200 - 26s - loss: 2.6862 - accuracy30: 0.5707 - val_loss: 2.8311 - val_accuracy30: 0.5390 - 26s/epoch - 22ms/step
Epoch 18/50
1200/1200 - 26s - loss: 2.6801 - accuracy30: 0.5715 - val_loss: 2.8293 - val_accuracy30: 0.5406 - 26s/epoch - 22ms/step
Epoch 19/50
1200/1200 - 27s - loss: 2.6753 - accuracy30: 0.5734 - val_loss: 2.8336 - val_accuracy30: 0.5400 - 27s/epoch - 22ms/step
Epoch 20/50
1200/1200 - 26s - loss: 2.6710 - accuracy30: 0.5739 - val_loss: 2.8236 - val_accuracy30: 0.5367 - 26s/epoch - 22ms/step
Epoch 21/50
1200/1200 - 26s - loss: 2.6633 - accuracy30: 0.5756 - val_loss: 2.8287 - val_accuracy30: 0.5390 - 26s/epoch - 22ms/step
Epoch 22/50
1200/1200 - 27s - loss: 2.6586 - accuracy30: 0.5764 - val_loss: 2.8289 - val_accuracy30: 0.5366 - 27s/epoch - 22ms/step
testing model: results/WBA/W9/deepOF_L2/h30
Evaluating performance on  test set...
2451/2451 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9683673
{'0': {'precision': 0.4898377875646251, 'recall': 0.5563022947560269, 'f1-score': 0.5209586935545654, 'support': 193136}, '1': {'precision': 0.5671886978425145, 'recall': 0.559068119847432, 'f1-score': 0.5630991332011154, 'support': 250118}, '2': {'precision': 0.4851106789381759, 'recall': 0.42548741600256407, 'f1-score': 0.45334707024636733, 'support': 184083}, 'accuracy': 0.519019283096645, 'macro avg': {'precision': 0.5140457214484385, 'recall': 0.5136192768686744, 'f1-score': 0.5124682990006827, 'support': 627337}, 'weighted avg': {'precision': 0.5192903380113587, 'recall': 0.519019283096645, 'f1-score': 0.5179203457926332, 'support': 627337}}
[[107442  53821  31873]
 [ 59025 139833  51260]
 [ 52875  52883  78325]]
Evaluating performance on  train set...
1200/1200 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93833
{'0': {'precision': 0.48879483671951746, 'recall': 0.5788889976188146, 'f1-score': 0.530040717990582, 'support': 91971}, '1': {'precision': 0.6130048423208428, 'recall': 0.5707417970864609, 'f1-score': 0.591118865611441, 'support': 123767}, '2': {'precision': 0.508121209198008, 'recall': 0.4612917350848385, 'f1-score': 0.48357537539949846, 'support': 91350}, 'accuracy': 0.5406235346219976, 'macro avg': {'precision': 0.5366402960794562, 'recall': 0.5369741765967047, 'f1-score': 0.5349116530005072, 'support': 307088}, 'weighted avg': {'precision': 0.5446047800880938, 'recall': 0.5406235346219976, 'f1-score': 0.5408351809813058, 'support': 307088}}
[[53241 21992 16738]
 [29074 70639 24054]
 [26608 22603 42139]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93442374
{'0': {'precision': 0.48871243586611285, 'recall': 0.5778374786954387, 'f1-score': 0.5295511403497161, 'support': 34617}, '1': {'precision': 0.6183301797540208, 'recall': 0.5794618317226704, 'f1-score': 0.5982653668360107, 'support': 45116}, '2': {'precision': 0.5037935239127489, 'recall': 0.4507136147389473, 'f1-score': 0.47577768892443023, 'support': 33001}, 'accuracy': 0.5412741497684815, 'macro avg': {'precision': 0.5369453798442941, 'recall': 0.5360043083856855, 'f1-score': 0.5345313987033857, 'support': 112734}, 'weighted avg': {'precision': 0.5450000254120697, 'recall': 0.5412741497684815, 'f1-score': 0.5413092024398558, 'support': 112734}}
[[20003  8590  6024]
 [10347 26143  8626]
 [10580  7547 14874]]
training model: results/WBA/W9/deepOF_L2/h50
Epoch 1/50
1200/1200 - 30s - loss: 3.1472 - accuracy50: 0.4370 - val_loss: 3.0877 - val_accuracy50: 0.4456 - 30s/epoch - 25ms/step
Epoch 2/50
1200/1200 - 28s - loss: 3.0065 - accuracy50: 0.4846 - val_loss: 3.0380 - val_accuracy50: 0.4658 - 28s/epoch - 23ms/step
Epoch 3/50
1200/1200 - 27s - loss: 2.9648 - accuracy50: 0.4943 - val_loss: 3.0105 - val_accuracy50: 0.4750 - 27s/epoch - 22ms/step
Epoch 4/50
1200/1200 - 27s - loss: 2.9328 - accuracy50: 0.5025 - val_loss: 2.9853 - val_accuracy50: 0.4930 - 27s/epoch - 22ms/step
Epoch 5/50
1200/1200 - 27s - loss: 2.9076 - accuracy50: 0.5099 - val_loss: 2.9684 - val_accuracy50: 0.4961 - 27s/epoch - 23ms/step
Epoch 6/50
1200/1200 - 28s - loss: 2.8943 - accuracy50: 0.5133 - val_loss: 2.9592 - val_accuracy50: 0.4971 - 28s/epoch - 23ms/step
Epoch 7/50
1200/1200 - 27s - loss: 2.8829 - accuracy50: 0.5166 - val_loss: 2.9507 - val_accuracy50: 0.4970 - 27s/epoch - 23ms/step
Epoch 8/50
1200/1200 - 27s - loss: 2.8741 - accuracy50: 0.5195 - val_loss: 2.9475 - val_accuracy50: 0.4989 - 27s/epoch - 22ms/step
Epoch 9/50
1200/1200 - 26s - loss: 2.8659 - accuracy50: 0.5212 - val_loss: 2.9518 - val_accuracy50: 0.4991 - 26s/epoch - 22ms/step
Epoch 10/50
1200/1200 - 27s - loss: 2.8600 - accuracy50: 0.5228 - val_loss: 2.9499 - val_accuracy50: 0.5000 - 27s/epoch - 22ms/step
Epoch 11/50
1200/1200 - 27s - loss: 2.8526 - accuracy50: 0.5247 - val_loss: 2.9558 - val_accuracy50: 0.5011 - 27s/epoch - 22ms/step
Epoch 12/50
1200/1200 - 26s - loss: 2.8481 - accuracy50: 0.5261 - val_loss: 2.9589 - val_accuracy50: 0.4987 - 26s/epoch - 22ms/step
Epoch 13/50
1200/1200 - 26s - loss: 2.8417 - accuracy50: 0.5284 - val_loss: 2.9625 - val_accuracy50: 0.5003 - 26s/epoch - 22ms/step
Epoch 14/50
1200/1200 - 26s - loss: 2.8354 - accuracy50: 0.5296 - val_loss: 2.9595 - val_accuracy50: 0.4992 - 26s/epoch - 22ms/step
Epoch 15/50
1200/1200 - 26s - loss: 2.8295 - accuracy50: 0.5322 - val_loss: 2.9713 - val_accuracy50: 0.5002 - 26s/epoch - 22ms/step
Epoch 16/50
1200/1200 - 26s - loss: 2.8239 - accuracy50: 0.5340 - val_loss: 2.9659 - val_accuracy50: 0.4978 - 26s/epoch - 22ms/step
Epoch 17/50
1200/1200 - 27s - loss: 2.8193 - accuracy50: 0.5348 - val_loss: 2.9702 - val_accuracy50: 0.4993 - 27s/epoch - 22ms/step
Epoch 18/50
1200/1200 - 26s - loss: 2.8116 - accuracy50: 0.5370 - val_loss: 2.9896 - val_accuracy50: 0.4982 - 26s/epoch - 22ms/step
testing model: results/WBA/W9/deepOF_L2/h50
Evaluating performance on  test set...
2451/2451 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0117837
{'0': {'precision': 0.49315740527442903, 'recall': 0.5337140641086606, 'f1-score': 0.5126348347615934, 'support': 216601}, '1': {'precision': 0.45870857168295237, 'recall': 0.509914537527774, 'f1-score': 0.48295806070604996, 'support': 202077}, '2': {'precision': 0.4812286081003993, 'recall': 0.3881212888013457, 'f1-score': 0.42968905442940253, 'support': 208659}, 'accuracy': 0.47762207553515895, 'macro avg': {'precision': 0.47769819501926025, 'recall': 0.47724996347926013, 'f1-score': 0.4750939832990153, 'support': 627337}, 'weighted avg': {'precision': 0.47809314502005107, 'recall': 0.47762207553515895, 'f1-score': 0.4754867356551217, 'support': 627337}}
[[115603  57774  43224]
 [ 54956 103042  44079]
 [ 63855  63819  80985]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9862126
{'0': {'precision': 0.49432739059967584, 'recall': 0.5202861185957702, 'f1-score': 0.5069746795991803, 'support': 103174}, '1': {'precision': 0.4978971609449883, 'recall': 0.5535652500568423, 'f1-score': 0.5242575740553496, 'support': 101157}, '2': {'precision': 0.5079914912413256, 'recall': 0.4252946271300252, 'f1-score': 0.4629792463424195, 'support': 102757}, 'accuracy': 0.4994626947324545, 'macro avg': {'precision': 0.5000720142619967, 'recall': 0.49971533192754586, 'f1-score': 0.4980704999989832, 'support': 307088}, 'weighted avg': {'precision': 0.5000755450324599, 'recall': 0.4994626947324545, 'f1-score': 0.4979461503806427, 'support': 307088}}
[[53680 27108 22386]
 [25219 55997 19941]
 [29693 29362 43702]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98256123
{'0': {'precision': 0.4940346664665716, 'recall': 0.5142276951914816, 'f1-score': 0.5039289723441167, 'support': 38411}, '1': {'precision': 0.5064152222329815, 'recall': 0.55482176957352, 'f1-score': 0.5295145041259556, 'support': 37704}, '2': {'precision': 0.49597710287804103, 'recall': 0.4258991234058822, 'f1-score': 0.45827456511518566, 'support': 36619}, 'accuracy': 0.49911295616229356, 'macro avg': {'precision': 0.4988089971925314, 'recall': 0.4983161960569613, 'f1-score': 0.497239347195086, 'support': 112734}, 'weighted avg': {'precision': 0.49880631081138604, 'recall': 0.49911295616229356, 'f1-score': 0.497656314157467, 'support': 112734}}
[[19752 10428  8231]
 [ 9167 20919  7618]
 [11062  9961 15596]]
training model: results/WBA/W9/deepOF_L2/h100
Epoch 1/50
1200/1200 - 30s - loss: 3.2444 - accuracy100: 0.4009 - val_loss: 3.2360 - val_accuracy100: 0.3921 - 30s/epoch - 25ms/step
Epoch 2/50
1200/1200 - 27s - loss: 3.1854 - accuracy100: 0.4259 - val_loss: 3.2167 - val_accuracy100: 0.3985 - 27s/epoch - 22ms/step
Epoch 3/50
1200/1200 - 27s - loss: 3.1657 - accuracy100: 0.4319 - val_loss: 3.2052 - val_accuracy100: 0.4047 - 27s/epoch - 22ms/step
Epoch 4/50
1200/1200 - 26s - loss: 3.1541 - accuracy100: 0.4370 - val_loss: 3.2063 - val_accuracy100: 0.4067 - 26s/epoch - 22ms/step
Epoch 5/50
1200/1200 - 27s - loss: 3.1457 - accuracy100: 0.4390 - val_loss: 3.1997 - val_accuracy100: 0.4067 - 27s/epoch - 23ms/step
Epoch 6/50
1200/1200 - 26s - loss: 3.1389 - accuracy100: 0.4419 - val_loss: 3.1991 - val_accuracy100: 0.4109 - 26s/epoch - 22ms/step
Epoch 7/50
1200/1200 - 27s - loss: 3.1322 - accuracy100: 0.4436 - val_loss: 3.1999 - val_accuracy100: 0.4107 - 27s/epoch - 22ms/step
Epoch 8/50
1200/1200 - 26s - loss: 3.1264 - accuracy100: 0.4461 - val_loss: 3.1987 - val_accuracy100: 0.4119 - 26s/epoch - 22ms/step
Epoch 9/50
1200/1200 - 27s - loss: 3.1220 - accuracy100: 0.4477 - val_loss: 3.1993 - val_accuracy100: 0.4115 - 27s/epoch - 22ms/step
Epoch 10/50
1200/1200 - 27s - loss: 3.1172 - accuracy100: 0.4503 - val_loss: 3.2013 - val_accuracy100: 0.4134 - 27s/epoch - 22ms/step
Epoch 11/50
1200/1200 - 27s - loss: 3.1124 - accuracy100: 0.4515 - val_loss: 3.1970 - val_accuracy100: 0.4146 - 27s/epoch - 22ms/step
Epoch 12/50
1200/1200 - 26s - loss: 3.1083 - accuracy100: 0.4530 - val_loss: 3.1995 - val_accuracy100: 0.4162 - 26s/epoch - 22ms/step
Epoch 13/50
1200/1200 - 26s - loss: 3.1032 - accuracy100: 0.4545 - val_loss: 3.1968 - val_accuracy100: 0.4154 - 26s/epoch - 22ms/step
Epoch 14/50
1200/1200 - 26s - loss: 3.0986 - accuracy100: 0.4566 - val_loss: 3.1980 - val_accuracy100: 0.4175 - 26s/epoch - 22ms/step
Epoch 15/50
1200/1200 - 26s - loss: 3.0920 - accuracy100: 0.4584 - val_loss: 3.2079 - val_accuracy100: 0.4162 - 26s/epoch - 22ms/step
Epoch 16/50
1200/1200 - 26s - loss: 3.0873 - accuracy100: 0.4605 - val_loss: 3.2095 - val_accuracy100: 0.4165 - 26s/epoch - 22ms/step
Epoch 17/50
1200/1200 - 26s - loss: 3.0821 - accuracy100: 0.4627 - val_loss: 3.2023 - val_accuracy100: 0.4176 - 26s/epoch - 22ms/step
Epoch 18/50
1200/1200 - 27s - loss: 3.0770 - accuracy100: 0.4642 - val_loss: 3.2046 - val_accuracy100: 0.4169 - 27s/epoch - 22ms/step
Epoch 19/50
1200/1200 - 27s - loss: 3.0704 - accuracy100: 0.4662 - val_loss: 3.2183 - val_accuracy100: 0.4147 - 27s/epoch - 22ms/step
Epoch 20/50
1200/1200 - 27s - loss: 3.0659 - accuracy100: 0.4686 - val_loss: 3.2247 - val_accuracy100: 0.4158 - 27s/epoch - 22ms/step
Epoch 21/50
1200/1200 - 27s - loss: 3.0598 - accuracy100: 0.4714 - val_loss: 3.2276 - val_accuracy100: 0.4141 - 27s/epoch - 22ms/step
Epoch 22/50
1200/1200 - 26s - loss: 3.0527 - accuracy100: 0.4720 - val_loss: 3.2229 - val_accuracy100: 0.4140 - 26s/epoch - 22ms/step
Epoch 23/50
1200/1200 - 27s - loss: 3.0458 - accuracy100: 0.4754 - val_loss: 3.2387 - val_accuracy100: 0.4111 - 27s/epoch - 22ms/step
testing model: results/WBA/W9/deepOF_L2/h100
Evaluating performance on  test set...
2451/2451 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0768043
{'0': {'precision': 0.46543164447768937, 'recall': 0.35128391914041157, 'f1-score': 0.4003808901100897, 'support': 219640}, '1': {'precision': 0.3481163756744282, 'recall': 0.44274299247503907, 'f1-score': 0.38976862917183625, 'support': 197609}, '2': {'precision': 0.42168949771689496, 'recall': 0.421994592742089, 'f1-score': 0.4218419900649017, 'support': 210088}, 'accuracy': 0.40377341046359455, 'macro avg': {'precision': 0.41174583928967085, 'recall': 0.40534050145251316, 'f1-score': 0.4039971697822759, 'support': 627337}, 'weighted avg': {'precision': 0.4138289921845433, 'recall': 0.40377341046359455, 'f1-score': 0.4042251417572255, 'support': 627337}}
[[77156 81683 60801]
 [49336 87490 60783]
 [39281 82151 88656]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0581803
{'0': {'precision': 0.4548903405392058, 'recall': 0.3949096720129402, 'f1-score': 0.4227832255372418, 'support': 102626}, '1': {'precision': 0.38259890494048, 'recall': 0.4104062570006526, 'f1-score': 0.396015037593985, 'support': 102669}, '2': {'precision': 0.44083698766027274, 'recall': 0.4671244584598155, 'f1-score': 0.4536001831571717, 'support': 101793}, 'accuracy': 0.42402829156463295, 'macro avg': {'precision': 0.4261087443799862, 'recall': 0.4241467958244694, 'f1-score': 0.4241328154294661, 'support': 307088}, 'weighted avg': {'precision': 0.42606270041295263, 'recall': 0.42402829156463295, 'f1-score': 0.42404894571862073, 'support': 307088}}
[[40528 33426 28672]
 [28892 42136 31641]
 [19674 34569 47550]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0664059
{'0': {'precision': 0.4369030261552653, 'recall': 0.3885213801862828, 'f1-score': 0.4112942758301936, 'support': 37792}, '1': {'precision': 0.39008005656994216, 'recall': 0.3969265559952716, 'f1-score': 0.3934735260027257, 'support': 38914}, '2': {'precision': 0.4213761699974703, 'recall': 0.46233485067169977, 'f1-score': 0.4409063236189418, 'support': 36028}, 'accuracy': 0.4150123299093441, 'macro avg': {'precision': 0.4161197509075592, 'recall': 0.41592759561775133, 'f1-score': 0.4152247084839537, 'support': 112734}, 'weighted avg': {'precision': 0.41577833784387475, 'recall': 0.4150123299093441, 'f1-score': 0.4146063750987987, 'support': 112734}}
[[14683 12125 10984]
 [11579 15446 11889]
 [ 7345 12026 16657]]
training model: results/WBA/W9/deepOF_L2/h200
Epoch 1/50
1200/1200 - 29s - loss: 3.2880 - accuracy200: 0.3739 - val_loss: 3.2767 - val_accuracy200: 0.3646 - 29s/epoch - 24ms/step
Epoch 2/50
1200/1200 - 26s - loss: 3.2495 - accuracy200: 0.3926 - val_loss: 3.2729 - val_accuracy200: 0.3682 - 26s/epoch - 22ms/step
Epoch 3/50
1200/1200 - 27s - loss: 3.2342 - accuracy200: 0.4010 - val_loss: 3.2728 - val_accuracy200: 0.3698 - 27s/epoch - 22ms/step
Epoch 4/50
1200/1200 - 27s - loss: 3.2262 - accuracy200: 0.4041 - val_loss: 3.2697 - val_accuracy200: 0.3727 - 27s/epoch - 22ms/step
Epoch 5/50
1200/1200 - 27s - loss: 3.2208 - accuracy200: 0.4071 - val_loss: 3.2669 - val_accuracy200: 0.3788 - 27s/epoch - 22ms/step
Epoch 6/50
1200/1200 - 26s - loss: 3.2165 - accuracy200: 0.4089 - val_loss: 3.2682 - val_accuracy200: 0.3781 - 26s/epoch - 22ms/step
Epoch 7/50
1200/1200 - 26s - loss: 3.2118 - accuracy200: 0.4106 - val_loss: 3.2666 - val_accuracy200: 0.3800 - 26s/epoch - 22ms/step
Epoch 8/50
1200/1200 - 26s - loss: 3.2080 - accuracy200: 0.4131 - val_loss: 3.2669 - val_accuracy200: 0.3817 - 26s/epoch - 22ms/step
Epoch 9/50
1200/1200 - 26s - loss: 3.2039 - accuracy200: 0.4155 - val_loss: 3.2639 - val_accuracy200: 0.3848 - 26s/epoch - 22ms/step
Epoch 10/50
1200/1200 - 27s - loss: 3.1995 - accuracy200: 0.4168 - val_loss: 3.2696 - val_accuracy200: 0.3862 - 27s/epoch - 22ms/step
Epoch 11/50
1200/1200 - 27s - loss: 3.1954 - accuracy200: 0.4191 - val_loss: 3.2686 - val_accuracy200: 0.3862 - 27s/epoch - 22ms/step
Epoch 12/50
1200/1200 - 27s - loss: 3.1912 - accuracy200: 0.4220 - val_loss: 3.2679 - val_accuracy200: 0.3868 - 27s/epoch - 22ms/step
Epoch 13/50
1200/1200 - 27s - loss: 3.1863 - accuracy200: 0.4237 - val_loss: 3.2669 - val_accuracy200: 0.3892 - 27s/epoch - 22ms/step
Epoch 14/50
1200/1200 - 27s - loss: 3.1821 - accuracy200: 0.4270 - val_loss: 3.2695 - val_accuracy200: 0.3907 - 27s/epoch - 22ms/step
Epoch 15/50
1200/1200 - 27s - loss: 3.1782 - accuracy200: 0.4285 - val_loss: 3.2758 - val_accuracy200: 0.3870 - 27s/epoch - 22ms/step
Epoch 16/50
1200/1200 - 26s - loss: 3.1728 - accuracy200: 0.4314 - val_loss: 3.2762 - val_accuracy200: 0.3879 - 26s/epoch - 22ms/step
Epoch 17/50
1200/1200 - 26s - loss: 3.1677 - accuracy200: 0.4334 - val_loss: 3.2814 - val_accuracy200: 0.3878 - 26s/epoch - 22ms/step
Epoch 18/50
1200/1200 - 26s - loss: 3.1611 - accuracy200: 0.4378 - val_loss: 3.2804 - val_accuracy200: 0.3896 - 26s/epoch - 22ms/step
Epoch 19/50
1200/1200 - 27s - loss: 3.1569 - accuracy200: 0.4395 - val_loss: 3.2800 - val_accuracy200: 0.3871 - 27s/epoch - 22ms/step
testing model: results/WBA/W9/deepOF_L2/h200
Evaluating performance on  test set...
2451/2451 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0947572
{'0': {'precision': 0.40037632786572874, 'recall': 0.2426874693205771, 'f1-score': 0.3021980656063857, 'support': 207794}, '1': {'precision': 0.36728490119745727, 'recall': 0.5479319249042005, 'f1-score': 0.43978020762266523, 'support': 217642}, '2': {'precision': 0.3829423583010272, 'recall': 0.3351345461389493, 'f1-score': 0.35744698834641675, 'support': 201901}, 'accuracy': 0.37833891512855133, 'macro avg': {'precision': 0.38353452912140434, 'recall': 0.37525131345457563, 'f1-score': 0.36647508719182254, 'support': 627337}, 'weighted avg': {'precision': 0.38328500347067673, 'recall': 0.37833891512855133, 'f1-score': 0.3677106454523729, 'support': 627337}}
[[ 50429 104127  53238]
 [ 42596 119253  55793]
 [ 32929 101308  67664]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0882818
{'0': {'precision': 0.4261853921081113, 'recall': 0.2802947230718916, 'f1-score': 0.3381765852752762, 'support': 103962}, '1': {'precision': 0.35795286876607224, 'recall': 0.5059135460422439, 'f1-score': 0.41926205730227506, 'support': 100701}, '2': {'precision': 0.4135680790139851, 'recall': 0.3891920917744691, 'f1-score': 0.4010099943162671, 'support': 102425}, 'accuracy': 0.3906013911321836, 'macro avg': {'precision': 0.39923544662938953, 'recall': 0.39180012029620154, 'f1-score': 0.38614954563127274, 'support': 307088}, 'weighted avg': {'precision': 0.39960209472517044, 'recall': 0.3906013911321836, 'f1-score': 0.38572354262826397, 'support': 307088}}
[[29140 46168 28654]
 [21884 50946 27871]
 [17350 45212 39863]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0891529
{'0': {'precision': 0.42967863154186403, 'recall': 0.285762632442142, 'f1-score': 0.3432457786116323, 'support': 38413}, '1': {'precision': 0.36055181981079365, 'recall': 0.4942683571051241, 'f1-score': 0.4169516828021078, 'support': 37860}, '2': {'precision': 0.39307374029360087, 'recall': 0.38040646169880143, 'f1-score': 0.38663637504007137, 'support': 36461}, 'accuracy': 0.3863962957049337, 'macro avg': {'precision': 0.39443473054875283, 'recall': 0.3868124837486892, 'f1-score': 0.38227794548460386, 'support': 112734}, 'weighted avg': {'precision': 0.3946245038435543, 'recall': 0.3863962957049337, 'f1-score': 0.3820323919583487, 'support': 112734}}
[[10977 16809 10627]
 [ 8358 18713 10789]
 [ 6212 16379 13870]]
training model: results/WBA/W9/deepOF_L2/h300
Epoch 1/50
1200/1200 - 30s - loss: 3.3028 - accuracy300: 0.3646 - val_loss: 3.2879 - val_accuracy300: 0.3538 - 30s/epoch - 25ms/step
Epoch 2/50
1200/1200 - 27s - loss: 3.2736 - accuracy300: 0.3775 - val_loss: 3.2817 - val_accuracy300: 0.3566 - 27s/epoch - 23ms/step
Epoch 3/50
1200/1200 - 26s - loss: 3.2621 - accuracy300: 0.3843 - val_loss: 3.2809 - val_accuracy300: 0.3578 - 26s/epoch - 22ms/step
Epoch 4/50
1200/1200 - 26s - loss: 3.2557 - accuracy300: 0.3879 - val_loss: 3.2806 - val_accuracy300: 0.3602 - 26s/epoch - 22ms/step
Epoch 5/50
1200/1200 - 26s - loss: 3.2515 - accuracy300: 0.3913 - val_loss: 3.2810 - val_accuracy300: 0.3614 - 26s/epoch - 22ms/step
Epoch 6/50
1200/1200 - 26s - loss: 3.2482 - accuracy300: 0.3933 - val_loss: 3.2801 - val_accuracy300: 0.3631 - 26s/epoch - 22ms/step
Epoch 7/50
1200/1200 - 27s - loss: 3.2451 - accuracy300: 0.3945 - val_loss: 3.2800 - val_accuracy300: 0.3647 - 27s/epoch - 22ms/step
Epoch 8/50
1200/1200 - 26s - loss: 3.2428 - accuracy300: 0.3965 - val_loss: 3.2798 - val_accuracy300: 0.3665 - 26s/epoch - 22ms/step
Epoch 9/50
1200/1200 - 27s - loss: 3.2405 - accuracy300: 0.3981 - val_loss: 3.2800 - val_accuracy300: 0.3670 - 27s/epoch - 22ms/step
Epoch 10/50
1200/1200 - 26s - loss: 3.2373 - accuracy300: 0.4001 - val_loss: 3.2815 - val_accuracy300: 0.3672 - 26s/epoch - 22ms/step
Epoch 11/50
1200/1200 - 27s - loss: 3.2344 - accuracy300: 0.4016 - val_loss: 3.2834 - val_accuracy300: 0.3683 - 27s/epoch - 22ms/step
Epoch 12/50
1200/1200 - 26s - loss: 3.2316 - accuracy300: 0.4039 - val_loss: 3.2840 - val_accuracy300: 0.3686 - 26s/epoch - 22ms/step
Epoch 13/50
1200/1200 - 27s - loss: 3.2291 - accuracy300: 0.4055 - val_loss: 3.2872 - val_accuracy300: 0.3702 - 27s/epoch - 22ms/step
Epoch 14/50
1200/1200 - 27s - loss: 3.2263 - accuracy300: 0.4065 - val_loss: 3.2869 - val_accuracy300: 0.3694 - 27s/epoch - 22ms/step
Epoch 15/50
1200/1200 - 27s - loss: 3.2222 - accuracy300: 0.4093 - val_loss: 3.2881 - val_accuracy300: 0.3714 - 27s/epoch - 22ms/step
Epoch 16/50
1200/1200 - 26s - loss: 3.2189 - accuracy300: 0.4114 - val_loss: 3.2941 - val_accuracy300: 0.3693 - 26s/epoch - 22ms/step
Epoch 17/50
1200/1200 - 26s - loss: 3.2158 - accuracy300: 0.4131 - val_loss: 3.3050 - val_accuracy300: 0.3683 - 26s/epoch - 22ms/step
Epoch 18/50
1200/1200 - 27s - loss: 3.2117 - accuracy300: 0.4159 - val_loss: 3.3057 - val_accuracy300: 0.3702 - 27s/epoch - 22ms/step
testing model: results/WBA/W9/deepOF_L2/h300
Evaluating performance on  test set...
2451/2451 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.100532
{'0': {'precision': 0.40131016344773063, 'recall': 0.11783321805209448, 'f1-score': 0.1821757521378477, 'support': 211078}, '1': {'precision': 0.34972167260255904, 'recall': 0.6209225638431417, 'f1-score': 0.4474349497588357, 'support': 213492}, '2': {'precision': 0.3618163276259997, 'recall': 0.332450546686591, 'f1-score': 0.3465123870082272, 'support': 202767}, 'accuracy': 0.3584102324587901, 'macro avg': {'precision': 0.37094938789209647, 'recall': 0.3570687761939424, 'f1-score': 0.3253743629683035, 'support': 627337}, 'weighted avg': {'precision': 0.37098869875557594, 'recall': 0.3584102324587901, 'f1-score': 0.32556401564097637, 'support': 627337}}
[[ 24872 127747  58459]
 [ 20489 132562  60441]
 [ 16616 118741  67410]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0963426
{'0': {'precision': 0.4285345317423421, 'recall': 0.1562202826502462, 'f1-score': 0.2289704471906546, 'support': 106209}, '1': {'precision': 0.33500590670978364, 'recall': 0.5783548267479708, 'f1-score': 0.42426234462956663, 'support': 97084}, '2': {'precision': 0.4006490413242825, 'recall': 0.3889493713570018, 'f1-score': 0.3947125279259285, 'support': 103795}, 'accuracy': 0.3683374146824363, 'macro avg': {'precision': 0.3880631599254694, 'recall': 0.37450816025173966, 'f1-score': 0.3493151065820499, 'support': 307088}, 'weighted avg': {'precision': 0.38954079864107016, 'recall': 0.3683374146824363, 'f1-score': 0.34673121231621173, 'support': 307088}}
[[16592 58156 31461]
 [12003 56149 28932]
 [10123 53301 40371]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0959387
{'0': {'precision': 0.42598835427520687, 'recall': 0.17794049874545548, 'f1-score': 0.2510248677153125, 'support': 39058}, '1': {'precision': 0.3437900874635568, 'recall': 0.5538676257448065, 'f1-score': 0.424246785152596, 'support': 37258}, '2': {'precision': 0.37665549266362586, 'recall': 0.37640727112966116, 'f1-score': 0.37653134098774926, 'support': 36418}, 'accuracy': 0.3662958823425054, 'macro avg': {'precision': 0.3821446448007965, 'recall': 0.36940513187330776, 'f1-score': 0.350600997951886, 'support': 112734}, 'weighted avg': {'precision': 0.38288558865845407, 'recall': 0.3662958823425054, 'f1-score': 0.3488178755347273, 'support': 112734}}
[[ 6950 20722 11386]
 [ 5322 20636 11300]
 [ 4043 18667 13708]]
training model: results/WBA/W9/deepOF_L2/h500
Epoch 1/50
1200/1200 - 29s - loss: 3.2919 - accuracy500: 0.3740 - val_loss: 3.2913 - val_accuracy500: 0.3639 - 29s/epoch - 25ms/step
Epoch 2/50
1200/1200 - 27s - loss: 3.2557 - accuracy500: 0.3904 - val_loss: 3.2846 - val_accuracy500: 0.3658 - 27s/epoch - 22ms/step
Epoch 3/50
1200/1200 - 27s - loss: 3.2423 - accuracy500: 0.3955 - val_loss: 3.2820 - val_accuracy500: 0.3655 - 27s/epoch - 22ms/step
Epoch 4/50
1200/1200 - 27s - loss: 3.2351 - accuracy500: 0.3975 - val_loss: 3.2815 - val_accuracy500: 0.3654 - 27s/epoch - 22ms/step
Epoch 5/50
1200/1200 - 27s - loss: 3.2306 - accuracy500: 0.4010 - val_loss: 3.2808 - val_accuracy500: 0.3644 - 27s/epoch - 22ms/step
Epoch 6/50
1200/1200 - 27s - loss: 3.2272 - accuracy500: 0.4023 - val_loss: 3.2800 - val_accuracy500: 0.3649 - 27s/epoch - 22ms/step
Epoch 7/50
1200/1200 - 27s - loss: 3.2252 - accuracy500: 0.4036 - val_loss: 3.2816 - val_accuracy500: 0.3651 - 27s/epoch - 22ms/step
Epoch 8/50
1200/1200 - 26s - loss: 3.2235 - accuracy500: 0.4045 - val_loss: 3.2808 - val_accuracy500: 0.3671 - 26s/epoch - 22ms/step
Epoch 9/50
1200/1200 - 27s - loss: 3.2210 - accuracy500: 0.4058 - val_loss: 3.2806 - val_accuracy500: 0.3667 - 27s/epoch - 22ms/step
Epoch 10/50
1200/1200 - 27s - loss: 3.2191 - accuracy500: 0.4071 - val_loss: 3.2813 - val_accuracy500: 0.3674 - 27s/epoch - 22ms/step
Epoch 11/50
1200/1200 - 27s - loss: 3.2173 - accuracy500: 0.4078 - val_loss: 3.2820 - val_accuracy500: 0.3669 - 27s/epoch - 22ms/step
Epoch 12/50
1200/1200 - 27s - loss: 3.2162 - accuracy500: 0.4077 - val_loss: 3.2813 - val_accuracy500: 0.3674 - 27s/epoch - 22ms/step
Epoch 13/50
1200/1200 - 27s - loss: 3.2142 - accuracy500: 0.4090 - val_loss: 3.2806 - val_accuracy500: 0.3683 - 27s/epoch - 22ms/step
Epoch 14/50
1200/1200 - 27s - loss: 3.2121 - accuracy500: 0.4106 - val_loss: 3.2817 - val_accuracy500: 0.3678 - 27s/epoch - 22ms/step
Epoch 15/50
1200/1200 - 27s - loss: 3.2102 - accuracy500: 0.4116 - val_loss: 3.2811 - val_accuracy500: 0.3692 - 27s/epoch - 22ms/step
Epoch 16/50
1200/1200 - 27s - loss: 3.2083 - accuracy500: 0.4128 - val_loss: 3.2833 - val_accuracy500: 0.3694 - 27s/epoch - 22ms/step
testing model: results/WBA/W9/deepOF_L2/h500
Evaluating performance on  test set...
2451/2451 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0962191
{'0': {'precision': 0.3820906697434072, 'recall': 0.28025658338960163, 'f1-score': 0.3233452698439079, 'support': 222150}, '1': {'precision': 0.3287913142059824, 'recall': 0.07942970305373263, 'f1-score': 0.12794929878591974, 'support': 189866}, '2': {'precision': 0.3573971509535847, 'recall': 0.6946837512365259, 'f1-score': 0.4719750980914952, 'support': 215321}, 'accuracy': 0.3617194586004014, 'macro avg': {'precision': 0.3560930449676581, 'recall': 0.35145667922662005, 'f1-score': 0.3077565555737743, 'support': 627337}, 'weighted avg': {'precision': 0.35748384980801035, 'recall': 0.3617194586004014, 'f1-score': 0.3152221586727236, 'support': 627337}}
[[ 62259  15948 143943]
 [ 49782  15081 125003]
 [ 50902  14839 149580]]
Evaluating performance on  train set...
1200/1200 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0937253
{'0': {'precision': 0.3768351854750352, 'recall': 0.3439887223058313, 'f1-score': 0.359663580999995, 'support': 104986}, '1': {'precision': 0.36568998478405057, 'recall': 0.09340867416088655, 'f1-score': 0.14880730303631673, 'support': 100344}, '2': {'precision': 0.3575492129165724, 'recall': 0.6522239037716936, 'f1-score': 0.46189018024914746, 'support': 101758}, 'accuracy': 0.36424738185796907, 'macro avg': {'precision': 0.3666914610585527, 'recall': 0.3632071000794705, 'f1-score': 0.32345368809515307, 'support': 307088}, 'weighted avg': {'precision': 0.36680269962817624, 'recall': 0.36424738185796907, 'f1-score': 0.3246384804763924, 'support': 307088}}
[[36114  8588 60284]
 [32002  9373 58969]
 [27719  7670 66369]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0938575
{'0': {'precision': 0.390990990990991, 'recall': 0.35329626289950905, 'f1-score': 0.37118909459334987, 'support': 39924}, '1': {'precision': 0.3541173941087938, 'recall': 0.09219659650694133, 'f1-score': 0.14630246502331778, 'support': 35728}, '2': {'precision': 0.35436554478376414, 'recall': 0.643681570573324, 'f1-score': 0.4570897844674882, 'support': 37082}, 'accuracy': 0.3660652509447017, 'macro avg': {'precision': 0.366491309961183, 'recall': 0.3630581433265914, 'f1-score': 0.3248604480280519, 'support': 112734}, 'weighted avg': {'precision': 0.3672575595003712, 'recall': 0.3660652509447017, 'f1-score': 0.3281729670775578, 'support': 112734}}
[[14105  3073 22746]
 [11692  3294 20742]
 [10278  2935 23869]]
training model: results/WBA/W9/deepOF_L2/h1000
Epoch 1/50
1200/1200 - 30s - loss: 3.3098 - accuracy1000: 0.3646 - val_loss: 3.3142 - val_accuracy1000: 0.3603 - 30s/epoch - 25ms/step
Epoch 2/50
1200/1200 - 28s - loss: 3.2717 - accuracy1000: 0.3749 - val_loss: 3.3233 - val_accuracy1000: 0.3602 - 28s/epoch - 23ms/step
Epoch 3/50
1200/1200 - 27s - loss: 3.2591 - accuracy1000: 0.3795 - val_loss: 3.3324 - val_accuracy1000: 0.3574 - 27s/epoch - 23ms/step
Epoch 4/50
1200/1200 - 27s - loss: 3.2532 - accuracy1000: 0.3812 - val_loss: 3.3385 - val_accuracy1000: 0.3534 - 27s/epoch - 23ms/step
Epoch 5/50
1200/1200 - 27s - loss: 3.2496 - accuracy1000: 0.3832 - val_loss: 3.3392 - val_accuracy1000: 0.3532 - 27s/epoch - 22ms/step
Epoch 6/50
1200/1200 - 26s - loss: 3.2462 - accuracy1000: 0.3856 - val_loss: 3.3490 - val_accuracy1000: 0.3522 - 26s/epoch - 22ms/step
Epoch 7/50
1200/1200 - 26s - loss: 3.2438 - accuracy1000: 0.3870 - val_loss: 3.3474 - val_accuracy1000: 0.3531 - 26s/epoch - 22ms/step
Epoch 8/50
1200/1200 - 26s - loss: 3.2423 - accuracy1000: 0.3874 - val_loss: 3.3486 - val_accuracy1000: 0.3525 - 26s/epoch - 22ms/step
Epoch 9/50
1200/1200 - 26s - loss: 3.2402 - accuracy1000: 0.3901 - val_loss: 3.3500 - val_accuracy1000: 0.3531 - 26s/epoch - 22ms/step
Epoch 10/50
1200/1200 - 27s - loss: 3.2379 - accuracy1000: 0.3913 - val_loss: 3.3558 - val_accuracy1000: 0.3521 - 27s/epoch - 22ms/step
Epoch 11/50
1200/1200 - 26s - loss: 3.2364 - accuracy1000: 0.3926 - val_loss: 3.3547 - val_accuracy1000: 0.3532 - 26s/epoch - 22ms/step
testing model: results/WBA/W9/deepOF_L2/h1000
Evaluating performance on  test set...
2451/2451 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1082284
{'0': {'precision': 0.3562879327298003, 'recall': 0.051376326211313744, 'f1-score': 0.08980313900770437, 'support': 204530}, '1': {'precision': 0.36141869107737246, 'recall': 0.898639851145021, 'f1-score': 0.5155081734186211, 'support': 221961}, '2': {'precision': 0.3393319551735393, 'recall': 0.0776415761329576, 'f1-score': 0.126369017953736, 'support': 200846}, 'accuracy': 0.35955953498677745, 'macro avg': {'precision': 0.35234619299357073, 'recall': 0.3425525844964308, 'f1-score': 0.24389344346002048, 'support': 627337}, 'weighted avg': {'precision': 0.3526747040908402, 'recall': 0.35955953498677745, 'f1-score': 0.25213060521115827, 'support': 627337}}
[[ 10508 176924  17098]
 [  9235 199463  13263]
 [  9750 175502  15594]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1107807
{'0': {'precision': 0.3807787319138925, 'recall': 0.06160316674913409, 'f1-score': 0.10604943731878717, 'support': 105092}, '1': {'precision': 0.34324475566781104, 'recall': 0.8935479108223829, 'f1-score': 0.4959693611348618, 'support': 101595}, '2': {'precision': 0.3827801639984381, 'recall': 0.0976384697363572, 'f1-score': 0.15558959138487907, 'support': 100401}, 'accuracy': 0.3486199395612984, 'macro avg': {'precision': 0.36893455052671387, 'recall': 0.35092984910262476, 'f1-score': 0.25253612994617597, 'support': 307088}, 'weighted avg': {'precision': 0.3690155938752841, 'recall': 0.3486199395612984, 'f1-score': 0.2512449372031324, 'support': 307088}}
[[ 6474 89129  9489]
 [ 4497 90780  6318]
 [ 6031 84567  9803]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1053382
{'0': {'precision': 0.3466096115865701, 'recall': 0.055526260282640794, 'f1-score': 0.09571857103899646, 'support': 37928}, '1': {'precision': 0.36049956133560407, 'recall': 0.8848102548512945, 'f1-score': 0.5122800841895292, 'support': 39474}, '2': {'precision': 0.37491046761485725, 'recall': 0.10370202649156572, 'f1-score': 0.16246535860769318, 'support': 35332}, 'accuracy': 0.3610002306313978, 'macro avg': {'precision': 0.36067321351234377, 'recall': 0.3480128472085004, 'f1-score': 0.2568213379454063, 'support': 112734}, 'weighted avg': {'precision': 0.36034298148016747, 'recall': 0.3610002306313978, 'f1-score': 0.26249741919910186, 'support': 112734}}
[[ 2106 32494  3328]
 [ 1766 34927  2781]
 [ 2204 29464  3664]]
training model: results/WBA/W9/deepVOL_L2/h10
Epoch 1/50
1200/1200 - 29s - loss: 3.0227 - accuracy10: 0.4897 - val_loss: 2.8422 - val_accuracy10: 0.5479 - 29s/epoch - 24ms/step
Epoch 2/50
1200/1200 - 26s - loss: 2.8099 - accuracy10: 0.5314 - val_loss: 2.8012 - val_accuracy10: 0.5644 - 26s/epoch - 22ms/step
Epoch 3/50
1200/1200 - 25s - loss: 2.7500 - accuracy10: 0.5478 - val_loss: 2.7845 - val_accuracy10: 0.5646 - 25s/epoch - 21ms/step
Epoch 4/50
1200/1200 - 25s - loss: 2.7201 - accuracy10: 0.5560 - val_loss: 2.7681 - val_accuracy10: 0.5601 - 25s/epoch - 21ms/step
Epoch 5/50
1200/1200 - 26s - loss: 2.6986 - accuracy10: 0.5621 - val_loss: 2.7764 - val_accuracy10: 0.5681 - 26s/epoch - 22ms/step
Epoch 6/50
1200/1200 - 26s - loss: 2.6795 - accuracy10: 0.5668 - val_loss: 2.7574 - val_accuracy10: 0.5710 - 26s/epoch - 21ms/step
Epoch 7/50
1200/1200 - 25s - loss: 2.6644 - accuracy10: 0.5699 - val_loss: 2.7904 - val_accuracy10: 0.5756 - 25s/epoch - 21ms/step
Epoch 8/50
1200/1200 - 25s - loss: 2.6544 - accuracy10: 0.5736 - val_loss: 2.7667 - val_accuracy10: 0.5841 - 25s/epoch - 21ms/step
Epoch 9/50
1200/1200 - 26s - loss: 2.6429 - accuracy10: 0.5756 - val_loss: 2.7692 - val_accuracy10: 0.5831 - 26s/epoch - 21ms/step
Epoch 10/50
1200/1200 - 26s - loss: 2.6329 - accuracy10: 0.5786 - val_loss: 2.7437 - val_accuracy10: 0.5891 - 26s/epoch - 22ms/step
Epoch 11/50
1200/1200 - 27s - loss: 2.6259 - accuracy10: 0.5795 - val_loss: 2.7433 - val_accuracy10: 0.5826 - 27s/epoch - 22ms/step
Epoch 12/50
1200/1200 - 27s - loss: 2.6174 - accuracy10: 0.5808 - val_loss: 2.7470 - val_accuracy10: 0.5862 - 27s/epoch - 22ms/step
Epoch 13/50
1200/1200 - 25s - loss: 2.6097 - accuracy10: 0.5828 - val_loss: 2.7313 - val_accuracy10: 0.5890 - 25s/epoch - 21ms/step
Epoch 14/50
1200/1200 - 27s - loss: 2.6033 - accuracy10: 0.5838 - val_loss: 2.7324 - val_accuracy10: 0.5923 - 27s/epoch - 23ms/step
Epoch 15/50
1200/1200 - 27s - loss: 2.5953 - accuracy10: 0.5853 - val_loss: 2.7311 - val_accuracy10: 0.5883 - 27s/epoch - 22ms/step
Epoch 16/50
1200/1200 - 25s - loss: 2.5901 - accuracy10: 0.5860 - val_loss: 2.7269 - val_accuracy10: 0.5962 - 25s/epoch - 21ms/step
Epoch 17/50
1200/1200 - 25s - loss: 2.5823 - accuracy10: 0.5876 - val_loss: 2.7268 - val_accuracy10: 0.5943 - 25s/epoch - 21ms/step
Epoch 18/50
1200/1200 - 26s - loss: 2.5756 - accuracy10: 0.5882 - val_loss: 2.7226 - val_accuracy10: 0.5889 - 26s/epoch - 21ms/step
Epoch 19/50
1200/1200 - 25s - loss: 2.5696 - accuracy10: 0.5884 - val_loss: 2.7204 - val_accuracy10: 0.5977 - 25s/epoch - 21ms/step
Epoch 20/50
1200/1200 - 26s - loss: 2.5644 - accuracy10: 0.5895 - val_loss: 2.7271 - val_accuracy10: 0.5962 - 26s/epoch - 21ms/step
Epoch 21/50
1200/1200 - 25s - loss: 2.5584 - accuracy10: 0.5914 - val_loss: 2.7212 - val_accuracy10: 0.6018 - 25s/epoch - 21ms/step
Epoch 22/50
1200/1200 - 27s - loss: 2.5521 - accuracy10: 0.5925 - val_loss: 2.7307 - val_accuracy10: 0.5976 - 27s/epoch - 23ms/step
Epoch 23/50
1200/1200 - 28s - loss: 2.5467 - accuracy10: 0.5926 - val_loss: 2.7148 - val_accuracy10: 0.5990 - 28s/epoch - 23ms/step
Epoch 24/50
1200/1200 - 26s - loss: 2.5410 - accuracy10: 0.5930 - val_loss: 2.7124 - val_accuracy10: 0.6008 - 26s/epoch - 22ms/step
Epoch 25/50
1200/1200 - 26s - loss: 2.5335 - accuracy10: 0.5940 - val_loss: 2.7302 - val_accuracy10: 0.6057 - 26s/epoch - 22ms/step
Epoch 26/50
1200/1200 - 25s - loss: 2.5306 - accuracy10: 0.5947 - val_loss: 2.7283 - val_accuracy10: 0.6046 - 25s/epoch - 21ms/step
Epoch 27/50
1200/1200 - 25s - loss: 2.5257 - accuracy10: 0.5953 - val_loss: 2.7307 - val_accuracy10: 0.6081 - 25s/epoch - 21ms/step
Epoch 28/50
1200/1200 - 26s - loss: 2.5202 - accuracy10: 0.5971 - val_loss: 2.7236 - val_accuracy10: 0.6064 - 26s/epoch - 22ms/step
Epoch 29/50
1200/1200 - 26s - loss: 2.5155 - accuracy10: 0.5980 - val_loss: 2.7128 - val_accuracy10: 0.6041 - 26s/epoch - 22ms/step
Epoch 30/50
1200/1200 - 27s - loss: 2.5109 - accuracy10: 0.5976 - val_loss: 2.7172 - val_accuracy10: 0.6034 - 27s/epoch - 22ms/step
Epoch 31/50
1200/1200 - 27s - loss: 2.5056 - accuracy10: 0.5985 - val_loss: 2.7227 - val_accuracy10: 0.6031 - 27s/epoch - 22ms/step
Epoch 32/50
1200/1200 - 28s - loss: 2.5009 - accuracy10: 0.5986 - val_loss: 2.7083 - val_accuracy10: 0.6015 - 28s/epoch - 23ms/step
Epoch 33/50
1200/1200 - 27s - loss: 2.4974 - accuracy10: 0.5995 - val_loss: 2.7267 - val_accuracy10: 0.5984 - 27s/epoch - 23ms/step
Epoch 34/50
1200/1200 - 26s - loss: 2.4929 - accuracy10: 0.6008 - val_loss: 2.7279 - val_accuracy10: 0.6054 - 26s/epoch - 21ms/step
Epoch 35/50
1200/1200 - 26s - loss: 2.4893 - accuracy10: 0.6015 - val_loss: 2.7166 - val_accuracy10: 0.6001 - 26s/epoch - 22ms/step
Epoch 36/50
1200/1200 - 26s - loss: 2.4852 - accuracy10: 0.6014 - val_loss: 2.7167 - val_accuracy10: 0.5950 - 26s/epoch - 21ms/step
Epoch 37/50
1200/1200 - 28s - loss: 2.4796 - accuracy10: 0.6024 - val_loss: 2.7178 - val_accuracy10: 0.5985 - 28s/epoch - 23ms/step
Epoch 38/50
1200/1200 - 25s - loss: 2.4749 - accuracy10: 0.6028 - val_loss: 2.7263 - val_accuracy10: 0.5943 - 25s/epoch - 21ms/step
Epoch 39/50
1200/1200 - 27s - loss: 2.4714 - accuracy10: 0.6025 - val_loss: 2.7197 - val_accuracy10: 0.6015 - 27s/epoch - 22ms/step
Epoch 40/50
1200/1200 - 26s - loss: 2.4685 - accuracy10: 0.6041 - val_loss: 2.7246 - val_accuracy10: 0.5960 - 26s/epoch - 22ms/step
Epoch 41/50
1200/1200 - 28s - loss: 2.4627 - accuracy10: 0.6051 - val_loss: 2.7453 - val_accuracy10: 0.5968 - 28s/epoch - 23ms/step
Epoch 42/50
1200/1200 - 25s - loss: 2.4593 - accuracy10: 0.6051 - val_loss: 2.7402 - val_accuracy10: 0.5965 - 25s/epoch - 21ms/step
testing model: results/WBA/W9/deepVOL_L2/h10
Evaluating performance on  test set...
2451/2451 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90331113
{'0': {'precision': 0.4185588791282108, 'recall': 0.5668057040461383, 'f1-score': 0.4815305202156851, 'support': 132818}, '1': {'precision': 0.7597371129826994, 'recall': 0.5849847477938773, 'f1-score': 0.6610060212320368, 'support': 367160}, '2': {'precision': 0.41557527279789286, 'recall': 0.5376443708141297, 'f1-score': 0.46879375087715697, 'support': 127363}, 'accuracy': 0.571524896348238, 'macro avg': {'precision': 0.5312904216362676, 'recall': 0.5631449408847152, 'f1-score': 0.5371100974416263, 'support': 627341}, 'weighted avg': {'precision': 0.6176324281055066, 'recall': 0.571524896348238, 'f1-score': 0.5839852167840597, 'support': 627341}}
[[ 75282  36515  21021]
 [ 77100 214783  75277]
 [ 27478  31409  68476]]
Evaluating performance on  train set...
1200/1200 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86375946
{'0': {'precision': 0.44275339289287524, 'recall': 0.5812947194362453, 'f1-score': 0.5026525730626863, 'support': 64709}, '1': {'precision': 0.7805834968070454, 'recall': 0.6299656419123757, 'f1-score': 0.6972331131671006, 'support': 178124}, '2': {'precision': 0.44333448157078886, 'recall': 0.5407647177827231, 'f1-score': 0.48722658440830063, 'support': 64259}, 'accuracy': 0.6010446380889115, 'macro avg': {'precision': 0.5555571237569031, 'recall': 0.5840083597104481, 'f1-score': 0.5623707568793624, 'support': 307092}, 'weighted avg': {'precision': 0.6388281509685064, 'recall': 0.6010446380889115, 'f1-score': 0.6122881399957764, 'support': 307092}}
[[ 37615  15862  11232]
 [ 33512 112212  32400]
 [ 13830  15680  34749]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8627984
{'0': {'precision': 0.4338951082988562, 'recall': 0.5756083780620687, 'f1-score': 0.4948049470087249, 'support': 24779}, '1': {'precision': 0.7802509028701767, 'recall': 0.6382889396837244, 'f1-score': 0.702166420061409, 'support': 64311}, '2': {'precision': 0.45901218259210336, 'recall': 0.5290559972931822, 'f1-score': 0.4915513989311538, 'support': 23644}, 'accuracy': 0.6016020011708979, 'macro avg': {'precision': 0.5577193979203788, 'recall': 0.5809844383463251, 'f1-score': 0.5628409220004292, 'support': 112734}, 'weighted avg': {'precision': 0.6367474475156474, 'recall': 0.6016020011708979, 'f1-score': 0.6124153999576585, 'support': 112734}}
[[14263  6275  4241]
 [12760 41049 10502]
 [ 5849  5286 12509]]
training model: results/WBA/W9/deepVOL_L2/h20
Epoch 1/50
1200/1200 - 28s - loss: 3.0822 - accuracy20: 0.4797 - val_loss: 2.9446 - val_accuracy20: 0.5054 - 28s/epoch - 23ms/step
Epoch 2/50
1200/1200 - 26s - loss: 2.8955 - accuracy20: 0.5219 - val_loss: 2.8943 - val_accuracy20: 0.5275 - 26s/epoch - 21ms/step
Epoch 3/50
1200/1200 - 26s - loss: 2.8350 - accuracy20: 0.5412 - val_loss: 2.8744 - val_accuracy20: 0.5416 - 26s/epoch - 21ms/step
Epoch 4/50
1200/1200 - 26s - loss: 2.8025 - accuracy20: 0.5496 - val_loss: 2.8381 - val_accuracy20: 0.5496 - 26s/epoch - 21ms/step
Epoch 5/50
1200/1200 - 25s - loss: 2.7803 - accuracy20: 0.5544 - val_loss: 2.8189 - val_accuracy20: 0.5531 - 25s/epoch - 21ms/step
Epoch 6/50
1200/1200 - 26s - loss: 2.7630 - accuracy20: 0.5600 - val_loss: 2.8042 - val_accuracy20: 0.5559 - 26s/epoch - 22ms/step
Epoch 7/50
1200/1200 - 27s - loss: 2.7506 - accuracy20: 0.5633 - val_loss: 2.8057 - val_accuracy20: 0.5517 - 27s/epoch - 22ms/step
Epoch 8/50
1200/1200 - 25s - loss: 2.7380 - accuracy20: 0.5663 - val_loss: 2.8002 - val_accuracy20: 0.5560 - 25s/epoch - 21ms/step
Epoch 9/50
1200/1200 - 25s - loss: 2.7281 - accuracy20: 0.5680 - val_loss: 2.7997 - val_accuracy20: 0.5614 - 25s/epoch - 21ms/step
Epoch 10/50
1200/1200 - 26s - loss: 2.7218 - accuracy20: 0.5693 - val_loss: 2.7954 - val_accuracy20: 0.5567 - 26s/epoch - 22ms/step
Epoch 11/50
1200/1200 - 26s - loss: 2.7125 - accuracy20: 0.5717 - val_loss: 2.7971 - val_accuracy20: 0.5565 - 26s/epoch - 22ms/step
Epoch 12/50
1200/1200 - 25s - loss: 2.7048 - accuracy20: 0.5732 - val_loss: 2.7929 - val_accuracy20: 0.5599 - 25s/epoch - 21ms/step
Epoch 13/50
1200/1200 - 26s - loss: 2.6986 - accuracy20: 0.5748 - val_loss: 2.7950 - val_accuracy20: 0.5615 - 26s/epoch - 22ms/step
Epoch 14/50
1200/1200 - 25s - loss: 2.6918 - accuracy20: 0.5748 - val_loss: 2.7829 - val_accuracy20: 0.5674 - 25s/epoch - 21ms/step
Epoch 15/50
1200/1200 - 28s - loss: 2.6865 - accuracy20: 0.5752 - val_loss: 2.7873 - val_accuracy20: 0.5665 - 28s/epoch - 23ms/step
Epoch 16/50
1200/1200 - 26s - loss: 2.6805 - accuracy20: 0.5775 - val_loss: 2.7965 - val_accuracy20: 0.5692 - 26s/epoch - 21ms/step
Epoch 17/50
1200/1200 - 27s - loss: 2.6754 - accuracy20: 0.5776 - val_loss: 2.7958 - val_accuracy20: 0.5713 - 27s/epoch - 22ms/step
Epoch 18/50
1200/1200 - 26s - loss: 2.6698 - accuracy20: 0.5794 - val_loss: 2.7857 - val_accuracy20: 0.5731 - 26s/epoch - 21ms/step
Epoch 19/50
1200/1200 - 26s - loss: 2.6663 - accuracy20: 0.5793 - val_loss: 2.7972 - val_accuracy20: 0.5749 - 26s/epoch - 21ms/step
Epoch 20/50
1200/1200 - 26s - loss: 2.6604 - accuracy20: 0.5797 - val_loss: 2.7988 - val_accuracy20: 0.5747 - 26s/epoch - 22ms/step
Epoch 21/50
1200/1200 - 26s - loss: 2.6549 - accuracy20: 0.5813 - val_loss: 2.8032 - val_accuracy20: 0.5724 - 26s/epoch - 21ms/step
Epoch 22/50
1200/1200 - 27s - loss: 2.6495 - accuracy20: 0.5817 - val_loss: 2.8096 - val_accuracy20: 0.5717 - 27s/epoch - 22ms/step
Epoch 23/50
1200/1200 - 26s - loss: 2.6468 - accuracy20: 0.5830 - val_loss: 2.8001 - val_accuracy20: 0.5788 - 26s/epoch - 21ms/step
Epoch 24/50
1200/1200 - 29s - loss: 2.6418 - accuracy20: 0.5832 - val_loss: 2.7983 - val_accuracy20: 0.5764 - 29s/epoch - 24ms/step
testing model: results/WBA/W9/deepVOL_L2/h20
Evaluating performance on  test set...
2451/2451 - 23s - 23s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.975863
{'0': {'precision': 0.46255848282418877, 'recall': 0.5467848882947575, 'f1-score': 0.5011574764303102, 'support': 169061}, '1': {'precision': 0.6496112825572369, 'recall': 0.5725234318916387, 'f1-score': 0.6086361454071213, 'support': 296711}, '2': {'precision': 0.45457393294978765, 'recall': 0.46702647166226197, 'f1-score': 0.46071607380542434, 'support': 161569}, 'accuracy': 0.5384169056382414, 'macro avg': {'precision': 0.5222478994437377, 'recall': 0.5287782639495527, 'f1-score': 0.5235032318809519, 'support': 627341}, 'weighted avg': {'precision': 0.5489717214343471, 'recall': 0.5384169056382414, 'f1-score': 0.541575728019284, 'support': 627341}}
[[ 92440  45881  30740]
 [ 67039 169874  59798]
 [ 40366  45746  75457]]
Evaluating performance on  train set...
1200/1200 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92944705
{'0': {'precision': 0.4783505826391981, 'recall': 0.5425108694313409, 'f1-score': 0.5084145159056281, 'support': 81191}, '1': {'precision': 0.6722976193094751, 'recall': 0.6313144179065429, 'f1-score': 0.6511617997954777, 'support': 145243}, '2': {'precision': 0.48112487598890896, 'recall': 0.4689801383619728, 'f1-score': 0.47497488699146156, 'support': 80658}, 'accuracy': 0.565198702668907, 'macro avg': {'precision': 0.5439243593125274, 'recall': 0.5476018085666188, 'f1-score': 0.5448504008975225, 'support': 307092}, 'weighted avg': {'precision': 0.5708089286726409, 'recall': 0.565198702668907, 'f1-score': 0.5671456784401604, 'support': 307092}}
[[44047 21653 15491]
 [28245 91694 25304]
 [19789 23042 37827]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91415066
{'0': {'precision': 0.4685520735804373, 'recall': 0.552686285974144, 'f1-score': 0.5071535022354694, 'support': 30786}, '1': {'precision': 0.6781273453822593, 'recall': 0.6354495343090667, 'f1-score': 0.6560951437066402, 'support': 52610}, '2': {'precision': 0.49839607684082443, 'recall': 0.4607335196673257, 'f1-score': 0.47882534228378115, 'support': 29338}, 'accuracy': 0.5673798499121827, 'macro avg': {'precision': 0.5483584986011737, 'recall': 0.5496231133168454, 'f1-score': 0.5473579960752969, 'support': 112734}, 'weighted avg': {'precision': 0.5741219852055645, 'recall': 0.5673798499121827, 'f1-score': 0.5692885120917298, 'support': 112734}}
[[17015  8067  5704]
 [11279 33431  7900]
 [ 8020  7801 13517]]
training model: results/WBA/W9/deepVOL_L2/h30
Epoch 1/50
1200/1200 - 28s - loss: 3.1200 - accuracy30: 0.4602 - val_loss: 3.0589 - val_accuracy30: 0.4569 - 28s/epoch - 23ms/step
Epoch 2/50
1200/1200 - 26s - loss: 2.9395 - accuracy30: 0.5120 - val_loss: 2.9264 - val_accuracy30: 0.5117 - 26s/epoch - 21ms/step
Epoch 3/50
1200/1200 - 27s - loss: 2.8857 - accuracy30: 0.5269 - val_loss: 2.8962 - val_accuracy30: 0.5210 - 27s/epoch - 23ms/step
Epoch 4/50
1200/1200 - 26s - loss: 2.8592 - accuracy30: 0.5347 - val_loss: 2.8803 - val_accuracy30: 0.5261 - 26s/epoch - 22ms/step
Epoch 5/50
1200/1200 - 27s - loss: 2.8393 - accuracy30: 0.5402 - val_loss: 2.8753 - val_accuracy30: 0.5315 - 27s/epoch - 22ms/step
Epoch 6/50
1200/1200 - 25s - loss: 2.8257 - accuracy30: 0.5430 - val_loss: 2.8716 - val_accuracy30: 0.5330 - 25s/epoch - 21ms/step
Epoch 7/50
1200/1200 - 26s - loss: 2.8160 - accuracy30: 0.5453 - val_loss: 2.8684 - val_accuracy30: 0.5340 - 26s/epoch - 22ms/step
Epoch 8/50
1200/1200 - 26s - loss: 2.8078 - accuracy30: 0.5471 - val_loss: 2.8718 - val_accuracy30: 0.5345 - 26s/epoch - 21ms/step
Epoch 9/50
1200/1200 - 27s - loss: 2.7999 - accuracy30: 0.5490 - val_loss: 2.8720 - val_accuracy30: 0.5357 - 27s/epoch - 22ms/step
Epoch 10/50
1200/1200 - 27s - loss: 2.7936 - accuracy30: 0.5501 - val_loss: 2.8663 - val_accuracy30: 0.5370 - 27s/epoch - 22ms/step
Epoch 11/50
1200/1200 - 25s - loss: 2.7870 - accuracy30: 0.5512 - val_loss: 2.8750 - val_accuracy30: 0.5346 - 25s/epoch - 21ms/step
Epoch 12/50
1200/1200 - 27s - loss: 2.7815 - accuracy30: 0.5535 - val_loss: 2.8719 - val_accuracy30: 0.5374 - 27s/epoch - 22ms/step
Epoch 13/50
1200/1200 - 28s - loss: 2.7746 - accuracy30: 0.5546 - val_loss: 2.8834 - val_accuracy30: 0.5360 - 28s/epoch - 23ms/step
Epoch 14/50
1200/1200 - 27s - loss: 2.7680 - accuracy30: 0.5551 - val_loss: 2.8767 - val_accuracy30: 0.5377 - 27s/epoch - 23ms/step
Epoch 15/50
1200/1200 - 25s - loss: 2.7618 - accuracy30: 0.5578 - val_loss: 2.8733 - val_accuracy30: 0.5371 - 25s/epoch - 21ms/step
Epoch 16/50
1200/1200 - 28s - loss: 2.7560 - accuracy30: 0.5585 - val_loss: 2.8774 - val_accuracy30: 0.5375 - 28s/epoch - 23ms/step
Epoch 17/50
1200/1200 - 25s - loss: 2.7506 - accuracy30: 0.5597 - val_loss: 2.8767 - val_accuracy30: 0.5385 - 25s/epoch - 21ms/step
Epoch 18/50
1200/1200 - 27s - loss: 2.7442 - accuracy30: 0.5614 - val_loss: 2.8813 - val_accuracy30: 0.5372 - 27s/epoch - 23ms/step
Epoch 19/50
1200/1200 - 27s - loss: 2.7404 - accuracy30: 0.5618 - val_loss: 2.8955 - val_accuracy30: 0.5365 - 27s/epoch - 22ms/step
Epoch 20/50
1200/1200 - 25s - loss: 2.7349 - accuracy30: 0.5622 - val_loss: 2.8960 - val_accuracy30: 0.5381 - 25s/epoch - 21ms/step
testing model: results/WBA/W9/deepVOL_L2/h30
Evaluating performance on  test set...
2451/2451 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0022159
{'0': {'precision': 0.5040490140605132, 'recall': 0.42895161958412725, 'f1-score': 0.4634780152001276, 'support': 193136}, '1': {'precision': 0.5681300826591261, 'recall': 0.5438233153951335, 'f1-score': 0.5557110318976172, 'support': 250118}, '2': {'precision': 0.4415176035390472, 'recall': 0.5361975587629763, 'f1-score': 0.48427327364160433, 'support': 184087}, 'accuracy': 0.5062206997470275, 'macro avg': {'precision': 0.5045655667528954, 'recall': 0.5029908312474123, 'f1-score': 0.5011541069131163, 'support': 627341}, 'weighted avg': {'precision': 0.5112486215261224, 'recall': 0.5062206997470275, 'f1-score': 0.5063530614844591, 'support': 627341}}
[[ 82846  55486  54804]
 [ 44046 136020  70052]
 [ 37469  47911  98707]]
Evaluating performance on  train set...
1200/1200 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9663183
{'0': {'precision': 0.508906337348173, 'recall': 0.43581625103364235, 'f1-score': 0.46953392413372724, 'support': 91908}, '1': {'precision': 0.5856546877297812, 'recall': 0.6114424242424242, 'f1-score': 0.5982707976706767, 'support': 123750}, '2': {'precision': 0.4724807178504814, 'recall': 0.5125336308156703, 'f1-score': 0.49169285328325085, 'support': 91434}, 'accuracy': 0.5294309197243823, 'macro avg': {'precision': 0.5223472476428119, 'recall': 0.5199307686972456, 'f1-score': 0.5198325250292183, 'support': 307092}, 'weighted avg': {'precision': 0.5289884894933676, 'recall': 0.5294309197243823, 'f1-score': 0.5280091290496972, 'support': 307092}}
[[40055 27502 24351]
 [20113 75666 27971]
 [18540 26031 46863]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94912094
{'0': {'precision': 0.4956486478056084, 'recall': 0.458691761445644, 'f1-score': 0.47645462586767817, 'support': 34642}, '1': {'precision': 0.5953922037919623, 'recall': 0.6322768863545949, 'f1-score': 0.6132804544723726, 'support': 45246}, '2': {'precision': 0.48985471709679396, 'recall': 0.48657370760518787, 'f1-score': 0.4882086999022483, 'support': 32846}, 'accuracy': 0.5364841130448667, 'macro avg': {'precision': 0.5269651895647882, 'recall': 0.5258474518018089, 'f1-score': 0.5259812600807664, 'support': 112734}, 'weighted avg': {'precision': 0.5339927985152155, 'recall': 0.5364841130448667, 'f1-score': 0.5347945743906393, 'support': 112734}}
[[15890 10428  8324]
 [ 8318 28608  8320]
 [ 7851  9013 15982]]
training model: results/WBA/W9/deepVOL_L2/h50
Epoch 1/50
1200/1200 - 28s - loss: 3.1613 - accuracy50: 0.4413 - val_loss: 3.0624 - val_accuracy50: 0.4605 - 28s/epoch - 23ms/step
Epoch 2/50
1200/1200 - 26s - loss: 3.0267 - accuracy50: 0.4806 - val_loss: 3.0026 - val_accuracy50: 0.4771 - 26s/epoch - 21ms/step
Epoch 3/50
1200/1200 - 26s - loss: 2.9792 - accuracy50: 0.4946 - val_loss: 2.9948 - val_accuracy50: 0.4809 - 26s/epoch - 22ms/step
Epoch 4/50
1200/1200 - 26s - loss: 2.9521 - accuracy50: 0.5023 - val_loss: 2.9850 - val_accuracy50: 0.4848 - 26s/epoch - 22ms/step
Epoch 5/50
1200/1200 - 28s - loss: 2.9367 - accuracy50: 0.5062 - val_loss: 2.9818 - val_accuracy50: 0.4834 - 28s/epoch - 23ms/step
Epoch 6/50
1200/1200 - 26s - loss: 2.9280 - accuracy50: 0.5085 - val_loss: 2.9902 - val_accuracy50: 0.4802 - 26s/epoch - 21ms/step
Epoch 7/50
1200/1200 - 26s - loss: 2.9206 - accuracy50: 0.5101 - val_loss: 2.9866 - val_accuracy50: 0.4834 - 26s/epoch - 21ms/step
Epoch 8/50
1200/1200 - 26s - loss: 2.9141 - accuracy50: 0.5117 - val_loss: 2.9953 - val_accuracy50: 0.4809 - 26s/epoch - 21ms/step
Epoch 9/50
1200/1200 - 28s - loss: 2.9072 - accuracy50: 0.5134 - val_loss: 2.9987 - val_accuracy50: 0.4802 - 28s/epoch - 23ms/step
Epoch 10/50
1200/1200 - 25s - loss: 2.9008 - accuracy50: 0.5148 - val_loss: 3.0050 - val_accuracy50: 0.4812 - 25s/epoch - 21ms/step
Epoch 11/50
1200/1200 - 25s - loss: 2.8945 - accuracy50: 0.5161 - val_loss: 3.0071 - val_accuracy50: 0.4796 - 25s/epoch - 21ms/step
Epoch 12/50
1200/1200 - 27s - loss: 2.8884 - accuracy50: 0.5177 - val_loss: 3.0075 - val_accuracy50: 0.4836 - 27s/epoch - 23ms/step
Epoch 13/50
1200/1200 - 28s - loss: 2.8828 - accuracy50: 0.5194 - val_loss: 3.0093 - val_accuracy50: 0.4822 - 28s/epoch - 24ms/step
Epoch 14/50
1200/1200 - 27s - loss: 2.8791 - accuracy50: 0.5206 - val_loss: 3.0144 - val_accuracy50: 0.4811 - 27s/epoch - 23ms/step
Epoch 15/50
1200/1200 - 25s - loss: 2.8750 - accuracy50: 0.5208 - val_loss: 3.0157 - val_accuracy50: 0.4831 - 25s/epoch - 21ms/step
testing model: results/WBA/W9/deepVOL_L2/h50
Evaluating performance on  test set...
2451/2451 - 26s - 26s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0273166
{'0': {'precision': 0.5089789543602233, 'recall': 0.39268978444236174, 'f1-score': 0.44333540084542133, 'support': 216601}, '1': {'precision': 0.43070460070592304, 'recall': 0.6286168143826363, 'f1-score': 0.5111728134242771, 'support': 202077}, '2': {'precision': 0.4651441362412656, 'recall': 0.36846973349371953, 'f1-score': 0.4112012578952717, 'support': 208663}, 'accuracy': 0.4606298647784857, 'macro avg': {'precision': 0.4682758971024707, 'recall': 0.4632587774395725, 'f1-score': 0.4552364907216567, 'support': 627341}, 'weighted avg': {'precision': 0.469185363288452, 'recall': 0.4606298647784857, 'f1-score': 0.4544986663601739, 'support': 627341}}
[[ 85057  80562  50982]
 [ 37621 127029  37427]
 [ 44435  87342  76886]]
Evaluating performance on  train set...
1200/1200 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0052996
{'0': {'precision': 0.5089222516112208, 'recall': 0.39743017843289374, 'f1-score': 0.446318792914745, 'support': 103120}, '1': {'precision': 0.4516708370328517, 'recall': 0.663468663854005, 'f1-score': 0.5374564285628529, 'support': 101209}, '2': {'precision': 0.49657872777456835, 'recall': 0.3764097973005848, 'f1-score': 0.42822349411595384, 'support': 102763}, 'accuracy': 0.47807497427481016, 'macro avg': {'precision': 0.4857239388062136, 'recall': 0.47910287986249456, 'f1-score': 0.4706662385311839, 'support': 307092}, 'weighted avg': {'precision': 0.4859232286536444, 'recall': 0.47807497427481016, 'f1-score': 0.47029995092553395, 'support': 307092}}
[[40983 38886 23251]
 [18097 67149 15963]
 [21449 42633 38681]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99459785
{'0': {'precision': 0.4918851435705368, 'recall': 0.42040338321405335, 'f1-score': 0.453343810512727, 'support': 38425}, '1': {'precision': 0.468803532681107, 'recall': 0.6518287196316096, 'f1-score': 0.5453700013285506, 'support': 37786}, '2': {'precision': 0.5027600073112777, 'recall': 0.3765572379048819, 'f1-score': 0.43060208522496013, 'support': 36523}, 'accuracy': 0.4837670977699718, 'macro avg': {'precision': 0.48781622785430717, 'recall': 0.4829297802501816, 'f1-score': 0.47643863235541256, 'support': 112734}, 'weighted avg': {'precision': 0.48767187072769513, 'recall': 0.4837670977699718, 'f1-score': 0.4768212495593465, 'support': 112734}}
[[16154 13759  8512]
 [ 8066 24630  5090]
 [ 8621 14149 13753]]
training model: results/WBA/W9/deepVOL_L2/h100
Epoch 1/50
1200/1200 - 29s - loss: 3.2643 - accuracy100: 0.3952 - val_loss: 3.2794 - val_accuracy100: 0.3685 - 29s/epoch - 24ms/step
Epoch 2/50
1200/1200 - 27s - loss: 3.2036 - accuracy100: 0.4159 - val_loss: 3.2478 - val_accuracy100: 0.3869 - 27s/epoch - 23ms/step
Epoch 3/50
1200/1200 - 25s - loss: 3.1858 - accuracy100: 0.4220 - val_loss: 3.2276 - val_accuracy100: 0.3970 - 25s/epoch - 21ms/step
Epoch 4/50
1200/1200 - 26s - loss: 3.1742 - accuracy100: 0.4275 - val_loss: 3.2227 - val_accuracy100: 0.4007 - 26s/epoch - 21ms/step
Epoch 5/50
1200/1200 - 25s - loss: 3.1657 - accuracy100: 0.4316 - val_loss: 3.2126 - val_accuracy100: 0.4090 - 25s/epoch - 21ms/step
Epoch 6/50
1200/1200 - 28s - loss: 3.1581 - accuracy100: 0.4355 - val_loss: 3.2099 - val_accuracy100: 0.4125 - 28s/epoch - 23ms/step
Epoch 7/50
1200/1200 - 26s - loss: 3.1530 - accuracy100: 0.4383 - val_loss: 3.2024 - val_accuracy100: 0.4138 - 26s/epoch - 22ms/step
Epoch 8/50
1200/1200 - 27s - loss: 3.1489 - accuracy100: 0.4407 - val_loss: 3.1978 - val_accuracy100: 0.4165 - 27s/epoch - 23ms/step
Epoch 9/50
1200/1200 - 25s - loss: 3.1436 - accuracy100: 0.4428 - val_loss: 3.1956 - val_accuracy100: 0.4163 - 25s/epoch - 21ms/step
Epoch 10/50
1200/1200 - 27s - loss: 3.1382 - accuracy100: 0.4450 - val_loss: 3.1980 - val_accuracy100: 0.4183 - 27s/epoch - 22ms/step
Epoch 11/50
1200/1200 - 26s - loss: 3.1327 - accuracy100: 0.4461 - val_loss: 3.1975 - val_accuracy100: 0.4174 - 26s/epoch - 21ms/step
Epoch 12/50
1200/1200 - 26s - loss: 3.1287 - accuracy100: 0.4481 - val_loss: 3.2023 - val_accuracy100: 0.4164 - 26s/epoch - 22ms/step
Epoch 13/50
1200/1200 - 26s - loss: 3.1237 - accuracy100: 0.4510 - val_loss: 3.2074 - val_accuracy100: 0.4159 - 26s/epoch - 22ms/step
Epoch 14/50
1200/1200 - 28s - loss: 3.1190 - accuracy100: 0.4524 - val_loss: 3.2061 - val_accuracy100: 0.4151 - 28s/epoch - 24ms/step
Epoch 15/50
1200/1200 - 27s - loss: 3.1146 - accuracy100: 0.4534 - val_loss: 3.2124 - val_accuracy100: 0.4148 - 27s/epoch - 23ms/step
Epoch 16/50
1200/1200 - 26s - loss: 3.1113 - accuracy100: 0.4555 - val_loss: 3.2135 - val_accuracy100: 0.4145 - 26s/epoch - 21ms/step
Epoch 17/50
1200/1200 - 29s - loss: 3.1079 - accuracy100: 0.4564 - val_loss: 3.2192 - val_accuracy100: 0.4133 - 29s/epoch - 24ms/step
Epoch 18/50
1200/1200 - 27s - loss: 3.1039 - accuracy100: 0.4581 - val_loss: 3.2194 - val_accuracy100: 0.4143 - 27s/epoch - 22ms/step
Epoch 19/50
1200/1200 - 27s - loss: 3.0995 - accuracy100: 0.4590 - val_loss: 3.2180 - val_accuracy100: 0.4139 - 27s/epoch - 23ms/step
testing model: results/WBA/W9/deepVOL_L2/h100
Evaluating performance on  test set...
2451/2451 - 24s - 24s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0783284
{'0': {'precision': 0.4329628865371577, 'recall': 0.3343486218482804, 'f1-score': 0.37731884076586936, 'support': 219642}, '1': {'precision': 0.38445674479710357, 'recall': 0.3820676183777055, 'f1-score': 0.38325845833650596, 'support': 197609}, '2': {'precision': 0.3911228452811418, 'recall': 0.48654386215431483, 'f1-score': 0.43364620785474134, 'support': 210090}, 'accuracy': 0.40034845482759773, 'macro avg': {'precision': 0.4028474922051343, 'recall': 0.40098670079343357, 'f1-score': 0.3980745023190389, 'support': 627341}, 'weighted avg': {'precision': 0.4036719196936281, 'recall': 0.40034845482759773, 'f1-score': 0.39805323950629445, 'support': 627341}}
[[ 73437  59807  86398]
 [ 49380  75500  72729]
 [ 46798  61074 102218]]
Evaluating performance on  train set...
1200/1200 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0657246
{'0': {'precision': 0.4378040988843564, 'recall': 0.34728367868072746, 'f1-score': 0.387325398119463, 'support': 102602}, '1': {'precision': 0.4058923996584116, 'recall': 0.41641437986118546, 'f1-score': 0.4110860717769331, 'support': 102727}, '2': {'precision': 0.41144837674751067, 'recall': 0.48645381916806696, 'f1-score': 0.4458183422866843, 'support': 101763}, 'accuracy': 0.41652664348143226, 'macro avg': {'precision': 0.4183816250967595, 'recall': 0.4167172925699933, 'f1-score': 0.41474327072769346, 'support': 307092}, 'weighted avg': {'precision': 0.4183954836218439, 'recall': 0.41652664348143226, 'f1-score': 0.41465688249580585, 'support': 307092}}
[[35632 31515 35455]
 [24594 42777 35356]
 [21162 31098 49503]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0650257
{'0': {'precision': 0.4177729612571119, 'recall': 0.36714285714285716, 'f1-score': 0.39082499049550123, 'support': 37800}, '1': {'precision': 0.4299038711353598, 'recall': 0.42514323886847716, 'f1-score': 0.42751030215344066, 'support': 38921}, '2': {'precision': 0.40819012797074955, 'recall': 0.46499875045122596, 'f1-score': 0.4347464887458138, 'support': 36013}, 'accuracy': 0.418427448684514, 'macro avg': {'precision': 0.41862232012107375, 'recall': 0.41909494882085346, 'f1-score': 0.4176939271315852, 'support': 112734}, 'weighted avg': {'precision': 0.4188998667889791, 'recall': 0.418427448684514, 'f1-score': 0.417521230596333, 'support': 112734}}
[[13878 11365 12557]
 [10652 16547 11722]
 [ 8689 10578 16746]]
training model: results/WBA/W9/deepVOL_L2/h200
Epoch 1/50
1200/1200 - 28s - loss: 3.3013 - accuracy200: 0.3656 - val_loss: 3.3120 - val_accuracy200: 0.3395 - 28s/epoch - 23ms/step
Epoch 2/50
1200/1200 - 26s - loss: 3.2710 - accuracy200: 0.3745 - val_loss: 3.2869 - val_accuracy200: 0.3550 - 26s/epoch - 22ms/step
Epoch 3/50
1200/1200 - 26s - loss: 3.2516 - accuracy200: 0.3904 - val_loss: 3.2818 - val_accuracy200: 0.3652 - 26s/epoch - 22ms/step
Epoch 4/50
1200/1200 - 28s - loss: 3.2389 - accuracy200: 0.4009 - val_loss: 3.2847 - val_accuracy200: 0.3630 - 28s/epoch - 23ms/step
Epoch 5/50
1200/1200 - 25s - loss: 3.2282 - accuracy200: 0.4055 - val_loss: 3.2953 - val_accuracy200: 0.3623 - 25s/epoch - 21ms/step
Epoch 6/50
1200/1200 - 25s - loss: 3.2203 - accuracy200: 0.4104 - val_loss: 3.3045 - val_accuracy200: 0.3579 - 25s/epoch - 21ms/step
Epoch 7/50
1200/1200 - 25s - loss: 3.2135 - accuracy200: 0.4130 - val_loss: 3.3313 - val_accuracy200: 0.3542 - 25s/epoch - 21ms/step
Epoch 8/50
1200/1200 - 25s - loss: 3.2097 - accuracy200: 0.4129 - val_loss: 3.3163 - val_accuracy200: 0.3567 - 25s/epoch - 21ms/step
Epoch 9/50
1200/1200 - 26s - loss: 3.2051 - accuracy200: 0.4175 - val_loss: 3.3300 - val_accuracy200: 0.3560 - 26s/epoch - 21ms/step
Epoch 10/50
1200/1200 - 26s - loss: 3.1999 - accuracy200: 0.4187 - val_loss: 3.3197 - val_accuracy200: 0.3586 - 26s/epoch - 22ms/step
Epoch 11/50
1200/1200 - 26s - loss: 3.1937 - accuracy200: 0.4213 - val_loss: 3.3215 - val_accuracy200: 0.3603 - 26s/epoch - 21ms/step
Epoch 12/50
1200/1200 - 26s - loss: 3.1899 - accuracy200: 0.4224 - val_loss: 3.3453 - val_accuracy200: 0.3570 - 26s/epoch - 21ms/step
Epoch 13/50
1200/1200 - 26s - loss: 3.1839 - accuracy200: 0.4250 - val_loss: 3.3479 - val_accuracy200: 0.3573 - 26s/epoch - 21ms/step
testing model: results/WBA/W9/deepVOL_L2/h200
Evaluating performance on  test set...
2451/2451 - 24s - 24s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0984476
{'0': {'precision': 0.3854845603162731, 'recall': 0.20834476286724898, 'f1-score': 0.27049418468430475, 'support': 207795}, '1': {'precision': 0.35708342543769234, 'recall': 0.6605771837366697, 'f1-score': 0.4635753047885907, 'support': 217643}, '2': {'precision': 0.35961213415176585, 'recall': 0.20021495470597267, 'f1-score': 0.25722130487762196, 'support': 201903}, 'accuracy': 0.36262096690635554, 'macro avg': {'precision': 0.3673933733019104, 'recall': 0.35637896710329714, 'f1-score': 0.3304302647835058, 'support': 627341}, 'weighted avg': {'precision': 0.3673046092876117, 'recall': 0.36262096690635554, 'f1-score': 0.3332079559366993, 'support': 627341}}
[[ 43293 128717  35785]
 [ 37672 143770  36201]
 [ 31343 130136  40424]]
Evaluating performance on  train set...
1200/1200 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0956433
{'0': {'precision': 0.4106186247890218, 'recall': 0.21525914384912048, 'f1-score': 0.2824494431649683, 'support': 103977}, '1': {'precision': 0.3393488586194631, 'recall': 0.6446144674085851, 'f1-score': 0.4446287335681877, 'support': 100640}, '2': {'precision': 0.39397837556177945, 'recall': 0.23610636740668456, 'f1-score': 0.2952644199967051, 'support': 102475}, 'accuracy': 0.3629238143618199, 'macro avg': {'precision': 0.38131528632342143, 'recall': 0.36532665955479676, 'f1-score': 0.3407808655766204, 'support': 307092}, 'weighted avg': {'precision': 0.38170937672373173, 'recall': 0.3629238143618199, 'f1-score': 0.3398750307316005, 'support': 307092}}
[[22382 62777 18818]
 [17367 64874 18399]
 [14759 63521 24195]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0947683
{'0': {'precision': 0.3988475510459727, 'recall': 0.2483361064891847, 'f1-score': 0.3060900773877237, 'support': 38464}, '1': {'precision': 0.3443575748635492, 'recall': 0.6180730228494268, 'f1-score': 0.44229293570420336, 'support': 37769}, '2': {'precision': 0.389664205763277, 'recall': 0.22413084573025396, 'f1-score': 0.28457631835258107, 'support': 36501}, 'accuracy': 0.36437099721468236, 'macro avg': {'precision': 0.3776231105575996, 'recall': 0.36351332502295514, 'f1-score': 0.3443197771481694, 'support': 112734}, 'weighted avg': {'precision': 0.37761852345360813, 'recall': 0.36437099721468236, 'f1-score': 0.3447560702311727, 'support': 112734}}
[[ 9552 22264  6648]
 [ 8259 23344  6166]
 [ 6138 22182  8181]]
training model: results/WBA/W9/deepVOL_L2/h300
Epoch 1/50
1200/1200 - 28s - loss: 3.3054 - accuracy300: 0.3659 - val_loss: 3.3054 - val_accuracy300: 0.3393 - 28s/epoch - 23ms/step
Epoch 2/50
1200/1200 - 25s - loss: 3.2822 - accuracy300: 0.3668 - val_loss: 3.3012 - val_accuracy300: 0.3418 - 25s/epoch - 21ms/step
Epoch 3/50
1200/1200 - 25s - loss: 3.2706 - accuracy300: 0.3780 - val_loss: 3.2957 - val_accuracy300: 0.3524 - 25s/epoch - 21ms/step
Epoch 4/50
1200/1200 - 25s - loss: 3.2619 - accuracy300: 0.3863 - val_loss: 3.2940 - val_accuracy300: 0.3587 - 25s/epoch - 21ms/step
Epoch 5/50
1200/1200 - 27s - loss: 3.2543 - accuracy300: 0.3918 - val_loss: 3.2985 - val_accuracy300: 0.3577 - 27s/epoch - 23ms/step
Epoch 6/50
1200/1200 - 25s - loss: 3.2494 - accuracy300: 0.3949 - val_loss: 3.2978 - val_accuracy300: 0.3611 - 25s/epoch - 21ms/step
Epoch 7/50
1200/1200 - 26s - loss: 3.2439 - accuracy300: 0.3988 - val_loss: 3.3043 - val_accuracy300: 0.3663 - 26s/epoch - 22ms/step
Epoch 8/50
1200/1200 - 26s - loss: 3.2386 - accuracy300: 0.4009 - val_loss: 3.2997 - val_accuracy300: 0.3660 - 26s/epoch - 22ms/step
Epoch 9/50
1200/1200 - 25s - loss: 3.2344 - accuracy300: 0.4051 - val_loss: 3.3112 - val_accuracy300: 0.3641 - 25s/epoch - 21ms/step
Epoch 10/50
1200/1200 - 25s - loss: 3.2309 - accuracy300: 0.4055 - val_loss: 3.3234 - val_accuracy300: 0.3639 - 25s/epoch - 21ms/step
Epoch 11/50
1200/1200 - 25s - loss: 3.2271 - accuracy300: 0.4080 - val_loss: 3.3215 - val_accuracy300: 0.3624 - 25s/epoch - 21ms/step
Epoch 12/50
1200/1200 - 25s - loss: 3.2221 - accuracy300: 0.4117 - val_loss: 3.3323 - val_accuracy300: 0.3629 - 25s/epoch - 21ms/step
Epoch 13/50
1200/1200 - 26s - loss: 3.2177 - accuracy300: 0.4140 - val_loss: 3.3393 - val_accuracy300: 0.3613 - 26s/epoch - 22ms/step
Epoch 14/50
1200/1200 - 25s - loss: 3.2134 - accuracy300: 0.4161 - val_loss: 3.3417 - val_accuracy300: 0.3611 - 25s/epoch - 21ms/step
testing model: results/WBA/W9/deepVOL_L2/h300
Evaluating performance on  test set...
2451/2451 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1008114
{'0': {'precision': 0.37748658754674036, 'recall': 0.2750060403924597, 'f1-score': 0.318198512281625, 'support': 211079}, '1': {'precision': 0.35587928966692617, 'recall': 0.6337959558393015, 'f1-score': 0.45581589633978936, 'support': 213493}, '2': {'precision': 0.35691483663631496, 'recall': 0.16431505802168972, 'f1-score': 0.22503115301618604, 'support': 202769}, 'accuracy': 0.36132980308954776, 'macro avg': {'precision': 0.3634269046166605, 'recall': 0.35770568475115033, 'f1-score': 0.3330151872125335, 'support': 627341}, 'weighted avg': {'precision': 0.36348412284793824, 'recall': 0.36132980308954776, 'f1-score': 0.3349181207622374, 'support': 627341}}
[[ 58048 123630  29401]
 [ 47551 135311  30631]
 [ 48176 121275  33318]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0994622
{'0': {'precision': 0.39039164358789535, 'recall': 0.29080786766645317, 'f1-score': 0.33332073658581357, 'support': 106156}, '1': {'precision': 0.3359042233872858, 'recall': 0.6050420168067226, 'f1-score': 0.4319825301182672, 'support': 97104}, '2': {'precision': 0.38783234164344355, 'recall': 0.19836851837583788, 'f1-score': 0.2624824773798904, 'support': 103832}, 'accuracy': 0.35891524364034233, 'macro avg': {'precision': 0.37137606953954155, 'recall': 0.36473946761633785, 'f1-score': 0.34259524802799035, 'support': 307092}, 'weighted avg': {'precision': 0.37229711852486436, 'recall': 0.35891524364034233, 'f1-score': 0.3405666976310572, 'support': 307092}}
[[30871 58390 16895]
 [22736 58752 15616]
 [25470 57765 20597]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991157
{'0': {'precision': 0.3789569990850869, 'recall': 0.3177923838265006, 'f1-score': 0.34569000292108887, 'support': 39101}, '1': {'precision': 0.3474119810825013, 'recall': 0.5673979509735557, 'f1-score': 0.43095475749118983, 'support': 37286}, '2': {'precision': 0.36066778664426713, 'recall': 0.18901147274878258, 'f1-score': 0.24803682642837802, 'support': 36347}, 'accuracy': 0.35882697322901697, 'macro avg': {'precision': 0.3623455889372851, 'recall': 0.3580672691829463, 'f1-score': 0.34156052894688554, 'support': 112734}, 'weighted avg': {'precision': 0.3626270050652625, 'recall': 0.35882697322901697, 'f1-score': 0.34240600370985025, 'support': 112734}}
[[12426 20491  6184]
 [10136 21156  5994]
 [10228 19249  6870]]
training model: results/WBA/W9/deepVOL_L2/h500
Epoch 1/50
1200/1200 - 31s - loss: 3.2782 - accuracy500: 0.3834 - val_loss: 3.2931 - val_accuracy500: 0.3467 - 31s/epoch - 25ms/step
Epoch 2/50
1200/1200 - 28s - loss: 3.2712 - accuracy500: 0.3761 - val_loss: 3.2970 - val_accuracy500: 0.3405 - 28s/epoch - 23ms/step
Epoch 3/50
1200/1200 - 26s - loss: 3.2662 - accuracy500: 0.3764 - val_loss: 3.2891 - val_accuracy500: 0.3458 - 26s/epoch - 22ms/step
Epoch 4/50
1200/1200 - 25s - loss: 3.2651 - accuracy500: 0.3774 - val_loss: 3.2954 - val_accuracy500: 0.3371 - 25s/epoch - 21ms/step
Epoch 5/50
1200/1200 - 29s - loss: 3.2621 - accuracy500: 0.3766 - val_loss: 3.2882 - val_accuracy500: 0.3517 - 29s/epoch - 25ms/step
Epoch 6/50
1200/1200 - 27s - loss: 3.2603 - accuracy500: 0.3791 - val_loss: 3.2874 - val_accuracy500: 0.3502 - 27s/epoch - 22ms/step
Epoch 7/50
1200/1200 - 28s - loss: 3.2548 - accuracy500: 0.3814 - val_loss: 3.2909 - val_accuracy500: 0.3458 - 28s/epoch - 23ms/step
Epoch 8/50
1200/1200 - 27s - loss: 3.2524 - accuracy500: 0.3836 - val_loss: 3.2940 - val_accuracy500: 0.3467 - 27s/epoch - 22ms/step
Epoch 9/50
1200/1200 - 26s - loss: 3.2488 - accuracy500: 0.3869 - val_loss: 3.2939 - val_accuracy500: 0.3448 - 26s/epoch - 22ms/step
Epoch 10/50
1200/1200 - 27s - loss: 3.2465 - accuracy500: 0.3869 - val_loss: 3.2930 - val_accuracy500: 0.3485 - 27s/epoch - 23ms/step
Epoch 11/50
1200/1200 - 26s - loss: 3.2429 - accuracy500: 0.3907 - val_loss: 3.2939 - val_accuracy500: 0.3492 - 26s/epoch - 22ms/step
Epoch 12/50
1200/1200 - 26s - loss: 3.2381 - accuracy500: 0.3940 - val_loss: 3.2988 - val_accuracy500: 0.3399 - 26s/epoch - 21ms/step
Epoch 13/50
1200/1200 - 26s - loss: 3.2320 - accuracy500: 0.3975 - val_loss: 3.3008 - val_accuracy500: 0.3397 - 26s/epoch - 22ms/step
Epoch 14/50
1200/1200 - 26s - loss: 3.2270 - accuracy500: 0.4012 - val_loss: 3.2974 - val_accuracy500: 0.3447 - 26s/epoch - 22ms/step
Epoch 15/50
1200/1200 - 28s - loss: 3.2273 - accuracy500: 0.4001 - val_loss: 3.2978 - val_accuracy500: 0.3469 - 28s/epoch - 24ms/step
Epoch 16/50
1200/1200 - 26s - loss: 3.2186 - accuracy500: 0.4059 - val_loss: 3.2997 - val_accuracy500: 0.3473 - 26s/epoch - 22ms/step
testing model: results/WBA/W9/deepVOL_L2/h500
Evaluating performance on  test set...
2451/2451 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0979501
{'0': {'precision': 0.3547716879675409, 'recall': 0.30976088443948285, 'f1-score': 0.33074192718909734, 'support': 222152}, '1': {'precision': 0.30895552835577317, 'recall': 0.14358020920017275, 'f1-score': 0.19605037000812653, 'support': 189866}, '2': {'precision': 0.34178792251215456, 'recall': 0.5478467232947711, 'f1-score': 0.42095346509391374, 'support': 215323}, 'accuracy': 0.3411844594885397, 'macro avg': {'precision': 0.3351717129451562, 'recall': 0.33372927231147553, 'f1-score': 0.31591525409704585, 'support': 627341}, 'weighted avg': {'precision': 0.3364489029271911, 'recall': 0.3411844594885397, 'f1-score': 0.32094067361338113, 'support': 627341}}
[[ 68814  29626 123712]
 [ 59143  27261 103462]
 [ 66010  31349 117964]]
Evaluating performance on  train set...
1200/1200 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0969381
{'0': {'precision': 0.3395006214443782, 'recall': 0.3200724016385634, 'f1-score': 0.32950037512320224, 'support': 104970}, '1': {'precision': 0.3788346992700076, 'recall': 0.16852276123119833, 'f1-score': 0.23327450223374335, 'support': 100390}, '2': {'precision': 0.342238072808021, 'recall': 0.5499351236582393, 'f1-score': 0.4219107626987628, 'support': 101732}, 'accuracy': 0.3466778685214854, 'macro avg': {'precision': 0.35352446450746894, 'recall': 0.34617676217600035, 'f1-score': 0.32822854668523616, 'support': 307092}, 'weighted avg': {'precision': 0.3532659897217708, 'recall': 0.3466778685214854, 'f1-score': 0.32865690857071683, 'support': 307092}}
[[33598 14034 57338]
 [33285 16918 50187]
 [32080 13706 55946]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0958143
{'0': {'precision': 0.3526772599813059, 'recall': 0.3306708065202694, 'f1-score': 0.3413196867488563, 'support': 39937}, '1': {'precision': 0.3645034349363036, 'recall': 0.15299980402586857, 'f1-score': 0.2155308408266288, 'support': 35719}, '2': {'precision': 0.34405267347751095, 'recall': 0.5594961972058903, 'f1-score': 0.42608909975968945, 'support': 37078}, 'accuracy': 0.34963719907037805, 'macro avg': {'precision': 0.35374445613170685, 'recall': 0.34772226925067606, 'f1-score': 0.3276465424450582, 'support': 112734}, 'weighted avg': {'precision': 0.3535876927241328, 'recall': 0.34963719907037805, 'f1-score': 0.32934484781933754, 'support': 112734}}
[[13206  5291 21440]
 [12143  5465 18111]
 [12096  4237 20745]]
training model: results/WBA/W9/deepVOL_L2/h1000
Epoch 1/50
1200/1200 - 31s - loss: 3.3029 - accuracy1000: 0.3747 - val_loss: 3.2937 - val_accuracy1000: 0.3623 - 31s/epoch - 26ms/step
Epoch 2/50
1200/1200 - 28s - loss: 3.2667 - accuracy1000: 0.3754 - val_loss: 3.2976 - val_accuracy1000: 0.3702 - 28s/epoch - 24ms/step
Epoch 3/50
1200/1200 - 27s - loss: 3.2547 - accuracy1000: 0.3847 - val_loss: 3.3054 - val_accuracy1000: 0.3621 - 27s/epoch - 23ms/step
Epoch 4/50
1200/1200 - 29s - loss: 3.2494 - accuracy1000: 0.3869 - val_loss: 3.2977 - val_accuracy1000: 0.3624 - 29s/epoch - 24ms/step
Epoch 5/50
1200/1200 - 29s - loss: 3.2428 - accuracy1000: 0.3928 - val_loss: 3.3015 - val_accuracy1000: 0.3718 - 29s/epoch - 24ms/step
Epoch 6/50
1200/1200 - 27s - loss: 3.2358 - accuracy1000: 0.3992 - val_loss: 3.3153 - val_accuracy1000: 0.3707 - 27s/epoch - 22ms/step
Epoch 7/50
1200/1200 - 26s - loss: 3.2310 - accuracy1000: 0.4030 - val_loss: 3.3008 - val_accuracy1000: 0.3816 - 26s/epoch - 22ms/step
Epoch 8/50
1200/1200 - 26s - loss: 3.2311 - accuracy1000: 0.3997 - val_loss: 3.3140 - val_accuracy1000: 0.3811 - 26s/epoch - 22ms/step
Epoch 9/50
1200/1200 - 26s - loss: 3.2214 - accuracy1000: 0.4079 - val_loss: 3.3111 - val_accuracy1000: 0.3747 - 26s/epoch - 21ms/step
Epoch 10/50
1200/1200 - 26s - loss: 3.2150 - accuracy1000: 0.4117 - val_loss: 3.3154 - val_accuracy1000: 0.3748 - 26s/epoch - 22ms/step
Epoch 11/50
1200/1200 - 27s - loss: 3.2087 - accuracy1000: 0.4137 - val_loss: 3.3110 - val_accuracy1000: 0.3731 - 27s/epoch - 22ms/step
testing model: results/WBA/W9/deepVOL_L2/h1000
Evaluating performance on  test set...
2451/2451 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1004041
{'0': {'precision': 0.34163253163687957, 'recall': 0.07299102340953982, 'f1-score': 0.12028312338104426, 'support': 204532}, '1': {'precision': 0.36066883063100724, 'recall': 0.8239870968323264, 'f1-score': 0.5017262072134474, 'support': 221961}, '2': {'precision': 0.32456759157652715, 'recall': 0.12370050983828566, 'f1-score': 0.1791301965421275, 'support': 200848}, 'accuracy': 0.3549377451816476, 'macro avg': {'precision': 0.3422896512814713, 'recall': 0.34022621002671727, 'f1-score': 0.2670465090455397, 'support': 627341}, 'weighted avg': {'precision': 0.34290433896302897, 'recall': 0.3549377451816476, 'f1-score': 0.27408273998633753, 'support': 627341}}
[[ 14929 162253  27350]
 [ 14715 182893  24353]
 [ 14055 161948  24845]]
Evaluating performance on  train set...
1200/1200 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017776
{'0': {'precision': 0.36620630125161846, 'recall': 0.06463161502865956, 'f1-score': 0.10987196710962917, 'support': 105026}, '1': {'precision': 0.34479870390323314, 'recall': 0.8622578424623857, 'f1-score': 0.4926121935324389, 'support': 101690}, '2': {'precision': 0.3689496117241782, 'recall': 0.125906591217024, 'f1-score': 0.18774418777389884, 'support': 100376}, 'accuracy': 0.34878472900629126, 'macro avg': {'precision': 0.3599848722930099, 'recall': 0.35093201623602305, 'f1-score': 0.26340944947198897, 'support': 307092}, 'weighted avg': {'precision': 0.36001409812563784, 'recall': 0.34878472900629126, 'f1-score': 0.2620653021568862, 'support': 307092}}
[[ 6788 85438 12800]
 [ 5191 87683  8816]
 [ 6557 81181 12638]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991334
{'0': {'precision': 0.3492188732838883, 'recall': 0.05826750921537652, 'f1-score': 0.09987138118554956, 'support': 37980}, '1': {'precision': 0.3613219329426458, 'recall': 0.8585233469449869, 'f1-score': 0.5085945247468222, 'support': 39427}, '2': {'precision': 0.37566844919786097, 'recall': 0.13522235117615422, 'f1-score': 0.19886351809837025, 'support': 35327}, 'accuracy': 0.362259832880941, 'macro avg': {'precision': 0.3620697518081317, 'recall': 0.35067106911217255, 'f1-score': 0.26910980801024736, 'support': 112734}, 'weighted avg': {'precision': 0.36174013130257604, 'recall': 0.362259832880941, 'f1-score': 0.2738368450377105, 'support': 112734}}
[[ 2213 31478  4289]
 [ 1928 33849  3650]
 [ 2196 28354  4777]]
training model: results/WBA/W9/deepVOL_L3/h10
Epoch 1/50
1200/1200 - 48s - loss: 3.2852 - accuracy10: 0.4194 - val_loss: 3.3236 - val_accuracy10: 0.2338 - 48s/epoch - 40ms/step
Epoch 2/50
1200/1200 - 44s - loss: 3.2335 - accuracy10: 0.4520 - val_loss: 3.2088 - val_accuracy10: 0.4743 - 44s/epoch - 37ms/step
Epoch 3/50
1200/1200 - 43s - loss: 2.9589 - accuracy10: 0.4859 - val_loss: 2.8637 - val_accuracy10: 0.5271 - 43s/epoch - 36ms/step
Epoch 4/50
1200/1200 - 43s - loss: 2.7741 - accuracy10: 0.5358 - val_loss: 2.7689 - val_accuracy10: 0.5591 - 43s/epoch - 36ms/step
Epoch 5/50
1200/1200 - 43s - loss: 2.7189 - accuracy10: 0.5534 - val_loss: 2.7446 - val_accuracy10: 0.5613 - 43s/epoch - 36ms/step
Epoch 6/50
1200/1200 - 43s - loss: 2.6883 - accuracy10: 0.5598 - val_loss: 2.7336 - val_accuracy10: 0.5678 - 43s/epoch - 36ms/step
Epoch 7/50
1200/1200 - 43s - loss: 2.6670 - accuracy10: 0.5644 - val_loss: 2.7161 - val_accuracy10: 0.5761 - 43s/epoch - 36ms/step
Epoch 8/50
1200/1200 - 43s - loss: 2.6491 - accuracy10: 0.5685 - val_loss: 2.7444 - val_accuracy10: 0.5734 - 43s/epoch - 36ms/step
Epoch 9/50
1200/1200 - 43s - loss: 2.6349 - accuracy10: 0.5721 - val_loss: 2.7160 - val_accuracy10: 0.5728 - 43s/epoch - 36ms/step
Epoch 10/50
1200/1200 - 46s - loss: 2.6220 - accuracy10: 0.5748 - val_loss: 2.6997 - val_accuracy10: 0.5712 - 46s/epoch - 38ms/step
Epoch 11/50
1200/1200 - 47s - loss: 2.6112 - accuracy10: 0.5778 - val_loss: 2.6805 - val_accuracy10: 0.5705 - 47s/epoch - 39ms/step
Epoch 12/50
1200/1200 - 45s - loss: 2.6032 - accuracy10: 0.5792 - val_loss: 2.6820 - val_accuracy10: 0.5704 - 45s/epoch - 38ms/step
Epoch 13/50
1200/1200 - 46s - loss: 2.5975 - accuracy10: 0.5809 - val_loss: 2.6754 - val_accuracy10: 0.5705 - 46s/epoch - 38ms/step
Epoch 14/50
1200/1200 - 47s - loss: 2.5904 - accuracy10: 0.5815 - val_loss: 2.6619 - val_accuracy10: 0.5746 - 47s/epoch - 39ms/step
Epoch 15/50
1200/1200 - 47s - loss: 2.5837 - accuracy10: 0.5828 - val_loss: 2.6540 - val_accuracy10: 0.5755 - 47s/epoch - 39ms/step
Epoch 16/50
1200/1200 - 46s - loss: 2.5777 - accuracy10: 0.5839 - val_loss: 2.6509 - val_accuracy10: 0.5860 - 46s/epoch - 39ms/step
Epoch 17/50
1200/1200 - 46s - loss: 2.5700 - accuracy10: 0.5856 - val_loss: 2.6468 - val_accuracy10: 0.5771 - 46s/epoch - 38ms/step
Epoch 18/50
1200/1200 - 46s - loss: 2.5639 - accuracy10: 0.5876 - val_loss: 2.6467 - val_accuracy10: 0.5750 - 46s/epoch - 38ms/step
Epoch 19/50
1200/1200 - 46s - loss: 2.5585 - accuracy10: 0.5889 - val_loss: 2.6531 - val_accuracy10: 0.5693 - 46s/epoch - 38ms/step
Epoch 20/50
1200/1200 - 46s - loss: 2.5521 - accuracy10: 0.5905 - val_loss: 2.6419 - val_accuracy10: 0.5706 - 46s/epoch - 38ms/step
Epoch 21/50
1200/1200 - 46s - loss: 2.5495 - accuracy10: 0.5903 - val_loss: 2.6503 - val_accuracy10: 0.5663 - 46s/epoch - 38ms/step
Epoch 22/50
1200/1200 - 45s - loss: 2.5425 - accuracy10: 0.5910 - val_loss: 2.6408 - val_accuracy10: 0.5682 - 45s/epoch - 38ms/step
Epoch 23/50
1200/1200 - 42s - loss: 2.5377 - accuracy10: 0.5921 - val_loss: 2.6417 - val_accuracy10: 0.5661 - 42s/epoch - 35ms/step
Epoch 24/50
1200/1200 - 44s - loss: 2.5319 - accuracy10: 0.5936 - val_loss: 2.6571 - val_accuracy10: 0.5652 - 44s/epoch - 37ms/step
Epoch 25/50
1200/1200 - 44s - loss: 2.5297 - accuracy10: 0.5939 - val_loss: 2.6328 - val_accuracy10: 0.5671 - 44s/epoch - 36ms/step
Epoch 26/50
1200/1200 - 43s - loss: 2.5238 - accuracy10: 0.5953 - val_loss: 2.6450 - val_accuracy10: 0.5605 - 43s/epoch - 36ms/step
Epoch 27/50
1200/1200 - 44s - loss: 2.5186 - accuracy10: 0.5964 - val_loss: 2.6396 - val_accuracy10: 0.5630 - 44s/epoch - 36ms/step
Epoch 28/50
1200/1200 - 44s - loss: 2.5128 - accuracy10: 0.5969 - val_loss: 2.6386 - val_accuracy10: 0.5675 - 44s/epoch - 36ms/step
Epoch 29/50
1200/1200 - 44s - loss: 2.5107 - accuracy10: 0.5968 - val_loss: 2.6427 - val_accuracy10: 0.5626 - 44s/epoch - 37ms/step
Epoch 30/50
1200/1200 - 44s - loss: 2.5071 - accuracy10: 0.5976 - val_loss: 2.6285 - val_accuracy10: 0.5716 - 44s/epoch - 37ms/step
Epoch 31/50
1200/1200 - 43s - loss: 2.5035 - accuracy10: 0.5986 - val_loss: 2.6346 - val_accuracy10: 0.5689 - 43s/epoch - 36ms/step
Epoch 32/50
1200/1200 - 46s - loss: 2.4993 - accuracy10: 0.5998 - val_loss: 2.6269 - val_accuracy10: 0.5666 - 46s/epoch - 38ms/step
Epoch 33/50
1200/1200 - 44s - loss: 2.4957 - accuracy10: 0.5996 - val_loss: 2.6309 - val_accuracy10: 0.5693 - 44s/epoch - 36ms/step
Epoch 34/50
1200/1200 - 43s - loss: 2.4900 - accuracy10: 0.6000 - val_loss: 2.6388 - val_accuracy10: 0.5572 - 43s/epoch - 36ms/step
Epoch 35/50
1200/1200 - 43s - loss: 2.4866 - accuracy10: 0.6007 - val_loss: 2.6346 - val_accuracy10: 0.5595 - 43s/epoch - 36ms/step
Epoch 36/50
1200/1200 - 44s - loss: 2.4823 - accuracy10: 0.6017 - val_loss: 2.6329 - val_accuracy10: 0.5607 - 44s/epoch - 37ms/step
Epoch 37/50
1200/1200 - 43s - loss: 2.4775 - accuracy10: 0.6027 - val_loss: 2.6434 - val_accuracy10: 0.5562 - 43s/epoch - 36ms/step
Epoch 38/50
1200/1200 - 44s - loss: 2.4747 - accuracy10: 0.6026 - val_loss: 2.6497 - val_accuracy10: 0.5645 - 44s/epoch - 36ms/step
Epoch 39/50
1200/1200 - 44s - loss: 2.4711 - accuracy10: 0.6041 - val_loss: 2.6493 - val_accuracy10: 0.5510 - 44s/epoch - 37ms/step
Epoch 40/50
1200/1200 - 44s - loss: 2.4660 - accuracy10: 0.6046 - val_loss: 2.6452 - val_accuracy10: 0.5562 - 44s/epoch - 37ms/step
Epoch 41/50
1200/1200 - 44s - loss: 2.4632 - accuracy10: 0.6046 - val_loss: 2.6535 - val_accuracy10: 0.5598 - 44s/epoch - 37ms/step
Epoch 42/50
1200/1200 - 44s - loss: 2.4600 - accuracy10: 0.6040 - val_loss: 2.6403 - val_accuracy10: 0.5662 - 44s/epoch - 37ms/step
testing model: results/WBA/W9/deepVOL_L3/h10
Evaluating performance on  test set...
2451/2451 - 39s - 39s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9548248
{'0': {'precision': 0.40710480952037825, 'recall': 0.5529898055986388, 'f1-score': 0.46896379987932224, 'support': 132818}, '1': {'precision': 0.8009174785288448, 'recall': 0.46505610632966554, 'f1-score': 0.5884349697511687, 'support': 367160}, '2': {'precision': 0.3685755235630094, 'recall': 0.6764052354294419, 'f1-score': 0.4771502473012866, 'support': 127363}, 'accuracy': 0.5265812373175035, 'macro avg': {'precision': 0.5255326038707442, 'recall': 0.5648170491192487, 'f1-score': 0.5115163389772591, 'support': 627341}, 'weighted avg': {'precision': 0.6297668929897516, 'recall': 0.5265812373175035, 'f1-score': 0.5405479705825775, 'support': 627341}}
[[ 73447  22936  36435]
 [ 85259 170750 111151]
 [ 21707  19507  86149]]
Evaluating performance on  train set...
1200/1200 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9137356
{'0': {'precision': 0.4271669196848117, 'recall': 0.5478990557727673, 'f1-score': 0.48005849418104757, 'support': 64709}, '1': {'precision': 0.8336514837377954, 'recall': 0.5124183153308931, 'f1-score': 0.6347045140832583, 'support': 178124}, '2': {'precision': 0.39253274232813007, 'recall': 0.7000887035279105, 'f1-score': 0.5030246106023504, 'support': 64259}, 'accuracy': 0.5591646802912482, 'macro avg': {'precision': 0.551117048583579, 'recall': 0.5868020248771902, 'f1-score': 0.5392625396222187, 'support': 307092}, 'weighted avg': {'precision': 0.6556948490499878, 'recall': 0.5591646802912482, 'f1-score': 0.5745642036237484, 'support': 307092}}
[[35454  9526 19729]
 [36959 91274 49891]
 [10585  8687 44987]]
Evaluating performance on  val set...
441/441 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90138096
{'0': {'precision': 0.41659024346951457, 'recall': 0.5683038056418742, 'f1-score': 0.4807620088081664, 'support': 24779}, '1': {'precision': 0.8371791677049589, 'recall': 0.522398967517221, 'f1-score': 0.6433488763991153, 'support': 64311}, '2': {'precision': 0.41143269503363317, 'recall': 0.6751818643207579, 'f1-score': 0.5112979421891265, 'support': 23644}, 'accuracy': 0.5645324391931449, 'macro avg': {'precision': 0.5550673687360356, 'recall': 0.5886282124932843, 'f1-score': 0.5451362757988027, 'support': 112734}, 'weighted avg': {'precision': 0.6554405391326479, 'recall': 0.5645324391931449, 'f1-score': 0.5799167948576363, 'support': 112734}}
[[14082  3557  7140]
 [15018 33596 15697]
 [ 4703  2977 15964]]
training model: results/WBA/W9/deepVOL_L3/h20
Epoch 1/50
1200/1200 - 48s - loss: 3.2434 - accuracy20: 0.4363 - val_loss: 3.2504 - val_accuracy20: 0.4561 - 48s/epoch - 40ms/step
Epoch 2/50
1200/1200 - 44s - loss: 2.9990 - accuracy20: 0.4990 - val_loss: 2.9053 - val_accuracy20: 0.5280 - 44s/epoch - 37ms/step
Epoch 3/50
1200/1200 - 42s - loss: 2.8585 - accuracy20: 0.5276 - val_loss: 2.8473 - val_accuracy20: 0.5461 - 42s/epoch - 35ms/step
Epoch 4/50
1200/1200 - 41s - loss: 2.8076 - accuracy20: 0.5426 - val_loss: 2.8266 - val_accuracy20: 0.5453 - 41s/epoch - 35ms/step
Epoch 5/50
1200/1200 - 42s - loss: 2.7844 - accuracy20: 0.5507 - val_loss: 2.7975 - val_accuracy20: 0.5399 - 42s/epoch - 35ms/step
Epoch 6/50
1200/1200 - 43s - loss: 2.7596 - accuracy20: 0.5580 - val_loss: 2.8154 - val_accuracy20: 0.5386 - 43s/epoch - 36ms/step
Epoch 7/50
1200/1200 - 43s - loss: 2.7442 - accuracy20: 0.5609 - val_loss: 2.7966 - val_accuracy20: 0.5426 - 43s/epoch - 36ms/step
Epoch 8/50
1200/1200 - 42s - loss: 2.7317 - accuracy20: 0.5637 - val_loss: 2.8013 - val_accuracy20: 0.5464 - 42s/epoch - 35ms/step
Epoch 9/50
1200/1200 - 43s - loss: 2.7226 - accuracy20: 0.5658 - val_loss: 2.7787 - val_accuracy20: 0.5411 - 43s/epoch - 36ms/step
Epoch 10/50
1200/1200 - 43s - loss: 2.7093 - accuracy20: 0.5685 - val_loss: 2.7748 - val_accuracy20: 0.5384 - 43s/epoch - 36ms/step
Epoch 11/50
1200/1200 - 43s - loss: 2.7025 - accuracy20: 0.5697 - val_loss: 2.7790 - val_accuracy20: 0.5331 - 43s/epoch - 36ms/step
Epoch 12/50
1200/1200 - 44s - loss: 2.6952 - accuracy20: 0.5715 - val_loss: 2.7732 - val_accuracy20: 0.5365 - 44s/epoch - 36ms/step
Epoch 13/50
1200/1200 - 44s - loss: 2.6875 - accuracy20: 0.5738 - val_loss: 2.7755 - val_accuracy20: 0.5336 - 44s/epoch - 36ms/step
Epoch 14/50
1200/1200 - 43s - loss: 2.6825 - accuracy20: 0.5750 - val_loss: 2.7556 - val_accuracy20: 0.5454 - 43s/epoch - 36ms/step
Epoch 15/50
1200/1200 - 42s - loss: 2.6784 - accuracy20: 0.5756 - val_loss: 2.7403 - val_accuracy20: 0.5493 - 42s/epoch - 35ms/step
Epoch 16/50
1200/1200 - 43s - loss: 2.6780 - accuracy20: 0.5748 - val_loss: 2.7594 - val_accuracy20: 0.5496 - 43s/epoch - 36ms/step
Epoch 17/50
1200/1200 - 43s - loss: 2.6718 - accuracy20: 0.5767 - val_loss: 2.7404 - val_accuracy20: 0.5534 - 43s/epoch - 36ms/step
Epoch 18/50
1200/1200 - 43s - loss: 2.6645 - accuracy20: 0.5786 - val_loss: 2.7391 - val_accuracy20: 0.5504 - 43s/epoch - 36ms/step
Epoch 19/50
1200/1200 - 43s - loss: 2.6590 - accuracy20: 0.5787 - val_loss: 2.7396 - val_accuracy20: 0.5560 - 43s/epoch - 36ms/step
Epoch 20/50
1200/1200 - 43s - loss: 2.6539 - accuracy20: 0.5802 - val_loss: 2.7320 - val_accuracy20: 0.5568 - 43s/epoch - 36ms/step
Epoch 21/50
1200/1200 - 42s - loss: 2.6474 - accuracy20: 0.5806 - val_loss: 2.7190 - val_accuracy20: 0.5548 - 42s/epoch - 35ms/step
Epoch 22/50
1200/1200 - 43s - loss: 2.6409 - accuracy20: 0.5820 - val_loss: 2.7138 - val_accuracy20: 0.5543 - 43s/epoch - 36ms/step
Epoch 23/50
1200/1200 - 43s - loss: 2.6362 - accuracy20: 0.5834 - val_loss: 2.7194 - val_accuracy20: 0.5523 - 43s/epoch - 36ms/step
Epoch 24/50
1200/1200 - 43s - loss: 2.6315 - accuracy20: 0.5840 - val_loss: 2.7228 - val_accuracy20: 0.5470 - 43s/epoch - 36ms/step
Epoch 25/50
1200/1200 - 43s - loss: 2.6279 - accuracy20: 0.5850 - val_loss: 2.7252 - val_accuracy20: 0.5469 - 43s/epoch - 36ms/step
Epoch 26/50
1200/1200 - 44s - loss: 2.6216 - accuracy20: 0.5854 - val_loss: 2.7323 - val_accuracy20: 0.5429 - 44s/epoch - 36ms/step
Epoch 27/50
1200/1200 - 43s - loss: 2.6184 - accuracy20: 0.5861 - val_loss: 2.7335 - val_accuracy20: 0.5462 - 43s/epoch - 36ms/step
Epoch 28/50
1200/1200 - 44s - loss: 2.6127 - accuracy20: 0.5868 - val_loss: 2.7217 - val_accuracy20: 0.5487 - 44s/epoch - 37ms/step
Epoch 29/50
1200/1200 - 44s - loss: 2.6083 - accuracy20: 0.5874 - val_loss: 2.7301 - val_accuracy20: 0.5486 - 44s/epoch - 36ms/step
Epoch 30/50
1200/1200 - 44s - loss: 2.6046 - accuracy20: 0.5888 - val_loss: 2.7203 - val_accuracy20: 0.5471 - 44s/epoch - 37ms/step
Epoch 31/50
1200/1200 - 43s - loss: 2.6007 - accuracy20: 0.5884 - val_loss: 2.7195 - val_accuracy20: 0.5548 - 43s/epoch - 36ms/step
Epoch 32/50
1200/1200 - 44s - loss: 2.5966 - accuracy20: 0.5890 - val_loss: 2.7272 - val_accuracy20: 0.5481 - 44s/epoch - 37ms/step
testing model: results/WBA/W9/deepVOL_L3/h20
Evaluating performance on  test set...
2451/2451 - 37s - 37s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9754902
{'0': {'precision': 0.437182007400555, 'recall': 0.6261704355232727, 'f1-score': 0.5148818715725733, 'support': 169061}, '1': {'precision': 0.7005787899402853, 'recall': 0.43731779408245736, 'f1-score': 0.5384945790320071, 'support': 296711}, '2': {'precision': 0.4429326492751884, 'recall': 0.5482425465281088, 'f1-score': 0.48999314068239147, 'support': 161569}, 'accuracy': 0.5167795505155888, 'macro avg': {'precision': 0.5268978155386762, 'recall': 0.5372435920446129, 'f1-score': 0.5144565304289906, 'support': 627341}, 'weighted avg': {'precision': 0.5632407987137142, 'recall': 0.5167795505155888, 'f1-score': 0.5196398942138486, 'support': 627341}}
[[105861  26351  36849]
 [ 92399 129757  74555]
 [ 43884  29106  88579]]
Evaluating performance on  train set...
1200/1200 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9304149
{'0': {'precision': 0.45216066689095735, 'recall': 0.5959158034757547, 'f1-score': 0.5141794415367039, 'support': 81191}, '1': {'precision': 0.7247058133625239, 'recall': 0.5105168579552887, 'f1-score': 0.5990410366821646, 'support': 145243}, '2': {'precision': 0.46398764472446097, 'recall': 0.5624364601155496, 'f1-score': 0.508490724653926, 'support': 80658}, 'accuracy': 0.5467319239836922, 'macro avg': {'precision': 0.5469513749926475, 'recall': 0.5562897071821976, 'f1-score': 0.5405704009575981, 'support': 307092}, 'weighted avg': {'precision': 0.5841706674349783, 'recall': 0.5467319239836922, 'f1-score': 0.5528216469259066, 'support': 307092}}
[[48383 13209 19599]
 [38286 74149 32808]
 [20335 14958 45365]]
Evaluating performance on  val set...
441/441 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9128122
{'0': {'precision': 0.4461642937429749, 'recall': 0.6188852075618788, 'f1-score': 0.5185195264661859, 'support': 30786}, '1': {'precision': 0.7336470711957094, 'recall': 0.5304124691123361, 'f1-score': 0.6156918121042296, 'support': 52610}, '2': {'precision': 0.4864662124148278, 'recall': 0.5305065103279024, 'f1-score': 0.5075327724515751, 'support': 29338}, 'accuracy': 0.5545975482108326, 'macro avg': {'precision': 0.5554258591178374, 'recall': 0.5599347290007057, 'f1-score': 0.5472480370073303, 'support': 112734}, 'weighted avg': {'precision': 0.5908131717370422, 'recall': 0.5545975482108326, 'f1-score': 0.5610080796811594, 'support': 112734}}
[[19053  5013  6720]
 [14995 27905  9710]
 [ 8656  5118 15564]]
training model: results/WBA/W9/deepVOL_L3/h30
Epoch 1/50
1200/1200 - 46s - loss: 3.2382 - accuracy30: 0.4212 - val_loss: 3.2031 - val_accuracy30: 0.4001 - 46s/epoch - 38ms/step
Epoch 2/50
1200/1200 - 43s - loss: 3.1378 - accuracy30: 0.4480 - val_loss: 3.1871 - val_accuracy30: 0.4165 - 43s/epoch - 36ms/step
Epoch 3/50
1200/1200 - 43s - loss: 2.9696 - accuracy30: 0.4975 - val_loss: 2.9348 - val_accuracy30: 0.5098 - 43s/epoch - 36ms/step
Epoch 4/50
1200/1200 - 44s - loss: 2.8869 - accuracy30: 0.5249 - val_loss: 2.8991 - val_accuracy30: 0.5128 - 44s/epoch - 37ms/step
Epoch 5/50
1200/1200 - 44s - loss: 2.8566 - accuracy30: 0.5332 - val_loss: 2.8904 - val_accuracy30: 0.5229 - 44s/epoch - 37ms/step
Epoch 6/50
1200/1200 - 43s - loss: 2.8394 - accuracy30: 0.5381 - val_loss: 2.8992 - val_accuracy30: 0.5250 - 43s/epoch - 36ms/step
Epoch 7/50
1200/1200 - 41s - loss: 2.8236 - accuracy30: 0.5416 - val_loss: 2.8957 - val_accuracy30: 0.5238 - 41s/epoch - 34ms/step
Epoch 8/50
1200/1200 - 44s - loss: 2.8071 - accuracy30: 0.5458 - val_loss: 2.9106 - val_accuracy30: 0.5223 - 44s/epoch - 36ms/step
Epoch 9/50
1200/1200 - 44s - loss: 2.7925 - accuracy30: 0.5487 - val_loss: 2.9269 - val_accuracy30: 0.5199 - 44s/epoch - 37ms/step
Epoch 10/50
1200/1200 - 44s - loss: 2.7839 - accuracy30: 0.5509 - val_loss: 2.9171 - val_accuracy30: 0.5173 - 44s/epoch - 37ms/step
Epoch 11/50
1200/1200 - 43s - loss: 2.7790 - accuracy30: 0.5513 - val_loss: 2.9489 - val_accuracy30: 0.5139 - 43s/epoch - 36ms/step
Epoch 12/50
1200/1200 - 43s - loss: 2.7680 - accuracy30: 0.5542 - val_loss: 2.8784 - val_accuracy30: 0.5233 - 43s/epoch - 36ms/step
Epoch 13/50
1200/1200 - 42s - loss: 2.7610 - accuracy30: 0.5551 - val_loss: 2.8894 - val_accuracy30: 0.5192 - 42s/epoch - 35ms/step
Epoch 14/50
1200/1200 - 43s - loss: 2.7528 - accuracy30: 0.5573 - val_loss: 2.8963 - val_accuracy30: 0.5201 - 43s/epoch - 36ms/step
Epoch 15/50
1200/1200 - 43s - loss: 2.7476 - accuracy30: 0.5588 - val_loss: 2.8657 - val_accuracy30: 0.5298 - 43s/epoch - 36ms/step
Epoch 16/50
1200/1200 - 44s - loss: 2.7404 - accuracy30: 0.5603 - val_loss: 2.8860 - val_accuracy30: 0.5241 - 44s/epoch - 37ms/step
Epoch 17/50
1200/1200 - 45s - loss: 2.7351 - accuracy30: 0.5618 - val_loss: 2.8679 - val_accuracy30: 0.5259 - 45s/epoch - 37ms/step
Epoch 18/50
1200/1200 - 44s - loss: 2.7285 - accuracy30: 0.5635 - val_loss: 2.8784 - val_accuracy30: 0.5264 - 44s/epoch - 37ms/step
Epoch 19/50
1200/1200 - 44s - loss: 2.7246 - accuracy30: 0.5637 - val_loss: 2.8918 - val_accuracy30: 0.5210 - 44s/epoch - 36ms/step
Epoch 20/50
1200/1200 - 43s - loss: 2.7189 - accuracy30: 0.5648 - val_loss: 2.8783 - val_accuracy30: 0.5273 - 43s/epoch - 36ms/step
Epoch 21/50
1200/1200 - 44s - loss: 2.7152 - accuracy30: 0.5652 - val_loss: 2.8525 - val_accuracy30: 0.5330 - 44s/epoch - 36ms/step
Epoch 22/50
1200/1200 - 43s - loss: 2.7112 - accuracy30: 0.5657 - val_loss: 2.9108 - val_accuracy30: 0.5220 - 43s/epoch - 36ms/step
Epoch 23/50
1200/1200 - 44s - loss: 2.7072 - accuracy30: 0.5665 - val_loss: 2.9261 - val_accuracy30: 0.5169 - 44s/epoch - 37ms/step
Epoch 24/50
1200/1200 - 45s - loss: 2.7042 - accuracy30: 0.5668 - val_loss: 2.8954 - val_accuracy30: 0.5220 - 45s/epoch - 37ms/step
Epoch 25/50
1200/1200 - 45s - loss: 2.7006 - accuracy30: 0.5676 - val_loss: 2.8686 - val_accuracy30: 0.5291 - 45s/epoch - 37ms/step
Epoch 26/50
1200/1200 - 46s - loss: 2.6963 - accuracy30: 0.5684 - val_loss: 2.8950 - val_accuracy30: 0.5251 - 46s/epoch - 38ms/step
Epoch 27/50
1200/1200 - 45s - loss: 2.6924 - accuracy30: 0.5689 - val_loss: 2.8440 - val_accuracy30: 0.5340 - 45s/epoch - 37ms/step
Epoch 28/50
1200/1200 - 44s - loss: 2.6879 - accuracy30: 0.5698 - val_loss: 2.8546 - val_accuracy30: 0.5328 - 44s/epoch - 36ms/step
Epoch 29/50
1200/1200 - 44s - loss: 2.6826 - accuracy30: 0.5709 - val_loss: 2.8414 - val_accuracy30: 0.5334 - 44s/epoch - 37ms/step
Epoch 30/50
1200/1200 - 42s - loss: 2.6771 - accuracy30: 0.5723 - val_loss: 2.8452 - val_accuracy30: 0.5333 - 42s/epoch - 35ms/step
Epoch 31/50
1200/1200 - 40s - loss: 2.6739 - accuracy30: 0.5730 - val_loss: 2.8358 - val_accuracy30: 0.5351 - 40s/epoch - 33ms/step
Epoch 32/50
1200/1200 - 43s - loss: 2.6700 - accuracy30: 0.5733 - val_loss: 2.8344 - val_accuracy30: 0.5335 - 43s/epoch - 36ms/step
Epoch 33/50
1200/1200 - 44s - loss: 2.6650 - accuracy30: 0.5745 - val_loss: 2.8367 - val_accuracy30: 0.5306 - 44s/epoch - 37ms/step
Epoch 34/50
1200/1200 - 44s - loss: 2.6625 - accuracy30: 0.5759 - val_loss: 2.8383 - val_accuracy30: 0.5364 - 44s/epoch - 37ms/step
Epoch 35/50
1200/1200 - 43s - loss: 2.6596 - accuracy30: 0.5756 - val_loss: 2.8438 - val_accuracy30: 0.5354 - 43s/epoch - 36ms/step
Epoch 36/50
1200/1200 - 44s - loss: 2.6564 - accuracy30: 0.5770 - val_loss: 2.8247 - val_accuracy30: 0.5379 - 44s/epoch - 37ms/step
Epoch 37/50
1200/1200 - 43s - loss: 2.6514 - accuracy30: 0.5777 - val_loss: 2.8368 - val_accuracy30: 0.5359 - 43s/epoch - 36ms/step
Epoch 38/50
1200/1200 - 43s - loss: 2.6496 - accuracy30: 0.5780 - val_loss: 2.8587 - val_accuracy30: 0.5336 - 43s/epoch - 36ms/step
Epoch 39/50
1200/1200 - 43s - loss: 2.6432 - accuracy30: 0.5794 - val_loss: 2.8599 - val_accuracy30: 0.5321 - 43s/epoch - 36ms/step
Epoch 40/50
1200/1200 - 43s - loss: 2.6433 - accuracy30: 0.5793 - val_loss: 2.8305 - val_accuracy30: 0.5397 - 43s/epoch - 36ms/step
Epoch 41/50
1200/1200 - 43s - loss: 2.6361 - accuracy30: 0.5806 - val_loss: 2.8422 - val_accuracy30: 0.5329 - 43s/epoch - 36ms/step
Epoch 42/50
1200/1200 - 43s - loss: 2.6341 - accuracy30: 0.5808 - val_loss: 2.8451 - val_accuracy30: 0.5313 - 43s/epoch - 36ms/step
Epoch 43/50
1200/1200 - 44s - loss: 2.6304 - accuracy30: 0.5816 - val_loss: 2.8610 - val_accuracy30: 0.5298 - 44s/epoch - 36ms/step
Epoch 44/50
1200/1200 - 44s - loss: 2.6258 - accuracy30: 0.5824 - val_loss: 2.8454 - val_accuracy30: 0.5327 - 44s/epoch - 36ms/step
Epoch 45/50
1200/1200 - 43s - loss: 2.6231 - accuracy30: 0.5831 - val_loss: 2.8589 - val_accuracy30: 0.5317 - 43s/epoch - 36ms/step
Epoch 46/50
1200/1200 - 44s - loss: 2.6208 - accuracy30: 0.5833 - val_loss: 2.8626 - val_accuracy30: 0.5296 - 44s/epoch - 37ms/step
testing model: results/WBA/W9/deepVOL_L3/h30
Evaluating performance on  test set...
2451/2451 - 39s - 39s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98524934
{'0': {'precision': 0.47853139885394286, 'recall': 0.5893411896280342, 'f1-score': 0.5281871019385376, 'support': 193136}, '1': {'precision': 0.5821137152777778, 'recall': 0.5362229027898832, 'f1-score': 0.5582267469688962, 'support': 250118}, '2': {'precision': 0.4839768169874656, 'recall': 0.4182370292307442, 'f1-score': 0.44871185917142864, 'support': 184087}, 'accuracy': 0.5179543501859435, 'macro avg': {'precision': 0.5148739770397287, 'recall': 0.5146003738828872, 'f1-score': 0.5117085693596208, 'support': 627341}, 'weighted avg': {'precision': 0.5214271007246042, 'recall': 0.5179543501859435, 'f1-score': 0.5168425491680897, 'support': 627341}}
[[113823  47012  32301]
 [ 66210 134119  49789]
 [ 57826  49269  76992]]
Evaluating performance on  train set...
1200/1200 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9433724
{'0': {'precision': 0.4849562583216421, 'recall': 0.5904817861339601, 'f1-score': 0.5325417658170399, 'support': 91908}, '1': {'precision': 0.6123916511229459, 'recall': 0.5863272727272727, 'f1-score': 0.5990760961553546, 'support': 123750}, '2': {'precision': 0.5084352428880603, 'recall': 0.42651530065402365, 'f1-score': 0.4638863776942475, 'support': 91434}, 'accuracy': 0.5399880166204265, 'macro avg': {'precision': 0.5352610507775494, 'recall': 0.5344414531717522, 'f1-score': 0.5318347465555474, 'support': 307092}, 'weighted avg': {'precision': 0.5433000358671569, 'recall': 0.5399880166204265, 'f1-score': 0.5389118002749452, 'support': 307092}}
[[54270 22515 15123]
 [28611 72558 22581]
 [29026 23410 38998]]
Evaluating performance on  val set...
441/441 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9399034
{'0': {'precision': 0.475558454997413, 'recall': 0.6102419028924427, 'f1-score': 0.5345470636576268, 'support': 34642}, '1': {'precision': 0.6197646404744255, 'recall': 0.5913008884763294, 'f1-score': 0.6051982717669148, 'support': 45246}, '2': {'precision': 0.5091386931071556, 'recall': 0.38927114412713876, 'f1-score': 0.44120844044928315, 'support': 32846}, 'accuracy': 0.5382582007202796, 'macro avg': {'precision': 0.534820596192998, 'recall': 0.5302713118319703, 'f1-score': 0.5269845919579416, 'support': 112734}, 'weighted avg': {'precision': 0.5432197600965447, 'recall': 0.5382582007202796, 'f1-score': 0.5357080633933905, 'support': 112734}}
[[21140  8307  5195]
 [11360 26754  7132]
 [11953  8107 12786]]
training model: results/WBA/W9/deepVOL_L3/h50
Epoch 1/50
1200/1200 - 46s - loss: 3.2812 - accuracy50: 0.3741 - val_loss: 3.3080 - val_accuracy50: 0.3377 - 46s/epoch - 39ms/step
Epoch 2/50
1200/1200 - 43s - loss: 3.2918 - accuracy50: 0.3642 - val_loss: 3.2641 - val_accuracy50: 0.3720 - 43s/epoch - 36ms/step
Epoch 3/50
1200/1200 - 43s - loss: 3.1857 - accuracy50: 0.4214 - val_loss: 3.1727 - val_accuracy50: 0.4359 - 43s/epoch - 36ms/step
Epoch 4/50
1200/1200 - 43s - loss: 3.1206 - accuracy50: 0.4433 - val_loss: 3.1126 - val_accuracy50: 0.4479 - 43s/epoch - 36ms/step
Epoch 5/50
1200/1200 - 44s - loss: 3.0371 - accuracy50: 0.4719 - val_loss: 3.0281 - val_accuracy50: 0.4728 - 44s/epoch - 37ms/step
Epoch 6/50
1200/1200 - 43s - loss: 2.9932 - accuracy50: 0.4870 - val_loss: 3.0154 - val_accuracy50: 0.4756 - 43s/epoch - 36ms/step
Epoch 7/50
1200/1200 - 43s - loss: 2.9687 - accuracy50: 0.4939 - val_loss: 2.9967 - val_accuracy50: 0.4837 - 43s/epoch - 36ms/step
Epoch 8/50
1200/1200 - 45s - loss: 2.9455 - accuracy50: 0.5005 - val_loss: 3.0055 - val_accuracy50: 0.4784 - 45s/epoch - 38ms/step
Epoch 9/50
1200/1200 - 44s - loss: 2.9304 - accuracy50: 0.5052 - val_loss: 2.9860 - val_accuracy50: 0.4857 - 44s/epoch - 37ms/step
Epoch 10/50
1200/1200 - 44s - loss: 2.9165 - accuracy50: 0.5074 - val_loss: 2.9943 - val_accuracy50: 0.4826 - 44s/epoch - 36ms/step
Epoch 11/50
1200/1200 - 43s - loss: 2.9086 - accuracy50: 0.5098 - val_loss: 2.9632 - val_accuracy50: 0.4898 - 43s/epoch - 36ms/step
Epoch 12/50
1200/1200 - 43s - loss: 2.9024 - accuracy50: 0.5119 - val_loss: 2.9641 - val_accuracy50: 0.4881 - 43s/epoch - 36ms/step
Epoch 13/50
1200/1200 - 43s - loss: 2.8961 - accuracy50: 0.5135 - val_loss: 2.9617 - val_accuracy50: 0.4913 - 43s/epoch - 36ms/step
Epoch 14/50
1200/1200 - 43s - loss: 2.8901 - accuracy50: 0.5148 - val_loss: 2.9571 - val_accuracy50: 0.4914 - 43s/epoch - 36ms/step
Epoch 15/50
1200/1200 - 43s - loss: 2.8857 - accuracy50: 0.5153 - val_loss: 2.9795 - val_accuracy50: 0.4860 - 43s/epoch - 36ms/step
Epoch 16/50
1200/1200 - 43s - loss: 2.8818 - accuracy50: 0.5172 - val_loss: 2.9438 - val_accuracy50: 0.4924 - 43s/epoch - 36ms/step
Epoch 17/50
1200/1200 - 44s - loss: 2.8773 - accuracy50: 0.5178 - val_loss: 2.9611 - val_accuracy50: 0.4908 - 44s/epoch - 37ms/step
Epoch 18/50
1200/1200 - 44s - loss: 2.8722 - accuracy50: 0.5194 - val_loss: 2.9577 - val_accuracy50: 0.4915 - 44s/epoch - 37ms/step
Epoch 19/50
1200/1200 - 44s - loss: 2.8684 - accuracy50: 0.5197 - val_loss: 2.9505 - val_accuracy50: 0.4928 - 44s/epoch - 37ms/step
Epoch 20/50
1200/1200 - 41s - loss: 2.8673 - accuracy50: 0.5199 - val_loss: 2.9589 - val_accuracy50: 0.4894 - 41s/epoch - 35ms/step
Epoch 21/50
1200/1200 - 43s - loss: 2.8625 - accuracy50: 0.5212 - val_loss: 2.9521 - val_accuracy50: 0.4909 - 43s/epoch - 36ms/step
Epoch 22/50
1200/1200 - 43s - loss: 2.8591 - accuracy50: 0.5221 - val_loss: 2.9573 - val_accuracy50: 0.4918 - 43s/epoch - 36ms/step
Epoch 23/50
1200/1200 - 43s - loss: 2.8544 - accuracy50: 0.5236 - val_loss: 2.9564 - val_accuracy50: 0.4890 - 43s/epoch - 36ms/step
Epoch 24/50
1200/1200 - 44s - loss: 2.8527 - accuracy50: 0.5236 - val_loss: 2.9688 - val_accuracy50: 0.4873 - 44s/epoch - 36ms/step
Epoch 25/50
1200/1200 - 44s - loss: 2.8486 - accuracy50: 0.5251 - val_loss: 2.9729 - val_accuracy50: 0.4862 - 44s/epoch - 36ms/step
Epoch 26/50
1200/1200 - 43s - loss: 2.8460 - accuracy50: 0.5261 - val_loss: 2.9527 - val_accuracy50: 0.4923 - 43s/epoch - 36ms/step
testing model: results/WBA/W9/deepVOL_L3/h50
Evaluating performance on  test set...
2451/2451 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0180345
{'0': {'precision': 0.49725008799718406, 'recall': 0.41741266199140353, 'f1-score': 0.453847022651691, 'support': 216601}, '1': {'precision': 0.45999883922427015, 'recall': 0.5490976212037986, 'f1-score': 0.5006147148061674, 'support': 202077}, '2': {'precision': 0.458631711364226, 'recall': 0.4490398393581996, 'f1-score': 0.453785094028022, 'support': 208663}, 'accuracy': 0.47035025608082365, 'macro avg': {'precision': 0.4719602128618934, 'recall': 0.4718500408511339, 'f1-score': 0.4694156104952934, 'support': 627341}, 'weighted avg': {'precision': 0.47240578972615277, 'recall': 0.47035025608082365, 'f1-score': 0.4688910779822042, 'support': 627341}}
[[ 90412  61545  64644]
 [ 45160 110960  45957]
 [ 46252  68713  93698]]
Evaluating performance on  train set...
1200/1200 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98990315
{'0': {'precision': 0.5038334895570457, 'recall': 0.4065748642358417, 'f1-score': 0.45000912340206295, 'support': 103120}, '1': {'precision': 0.4926608643407295, 'recall': 0.5833374502267585, 'f1-score': 0.53417840630457, 'support': 101209}, '2': {'precision': 0.47960900029795944, 'recall': 0.48557360139349764, 'f1-score': 0.48257287093092976, 'support': 102763}, 'accuracy': 0.4912664608651479, 'macro avg': {'precision': 0.49203445139857815, 'recall': 0.49182863861869935, 'f1-score': 0.48892013354585423, 'support': 307092}, 'weighted avg': {'precision': 0.4920449981106725, 'recall': 0.4912664608651479, 'f1-score': 0.488645875061464, 'support': 307092}}
[[41926 29084 32110]
 [20138 59039 22032]
 [21150 31714 49899]]
Evaluating performance on  val set...
441/441 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98103267
{'0': {'precision': 0.4812759652537695, 'recall': 0.4311255692908263, 'f1-score': 0.45482250226505233, 'support': 38425}, '1': {'precision': 0.5084698175011698, 'recall': 0.5751336473826285, 'f1-score': 0.5397511362789659, 'support': 37786}, '2': {'precision': 0.4819104376915076, 'recall': 0.46937546203762015, 'f1-score': 0.47556036395916557, 'support': 36523}, 'accuracy': 0.4917859740628382, 'macro avg': {'precision': 0.49055207348214896, 'recall': 0.49187822623702493, 'f1-score': 0.49004466750106124, 'support': 112734}, 'weighted avg': {'precision': 0.49059630994005554, 'recall': 0.4917859740628382, 'f1-score': 0.4900072937876084, 'support': 112734}}
[[16566 10367 11492]
 [ 9116 21732  6938]
 [ 8739 10641 17143]]
training model: results/WBA/W9/deepVOL_L3/h100
Epoch 1/50
1200/1200 - 46s - loss: 3.2872 - accuracy100: 0.3700 - val_loss: 3.3059 - val_accuracy100: 0.3305 - 46s/epoch - 38ms/step
Epoch 2/50
1200/1200 - 44s - loss: 3.2876 - accuracy100: 0.3645 - val_loss: 3.3000 - val_accuracy100: 0.3426 - 44s/epoch - 36ms/step
Epoch 3/50
1200/1200 - 44s - loss: 3.2655 - accuracy100: 0.3861 - val_loss: 3.2782 - val_accuracy100: 0.3713 - 44s/epoch - 36ms/step
Epoch 4/50
1200/1200 - 42s - loss: 3.2351 - accuracy100: 0.3991 - val_loss: 3.2398 - val_accuracy100: 0.3835 - 42s/epoch - 35ms/step
Epoch 5/50
1200/1200 - 43s - loss: 3.2057 - accuracy100: 0.4124 - val_loss: 3.2222 - val_accuracy100: 0.3929 - 43s/epoch - 36ms/step
Epoch 6/50
1200/1200 - 43s - loss: 3.1901 - accuracy100: 0.4204 - val_loss: 3.2152 - val_accuracy100: 0.3937 - 43s/epoch - 36ms/step
Epoch 7/50
1200/1200 - 43s - loss: 3.1797 - accuracy100: 0.4226 - val_loss: 3.2052 - val_accuracy100: 0.3984 - 43s/epoch - 36ms/step
Epoch 8/50
1200/1200 - 43s - loss: 3.1723 - accuracy100: 0.4270 - val_loss: 3.2015 - val_accuracy100: 0.4007 - 43s/epoch - 36ms/step
Epoch 9/50
1200/1200 - 44s - loss: 3.1655 - accuracy100: 0.4303 - val_loss: 3.1992 - val_accuracy100: 0.4033 - 44s/epoch - 36ms/step
Epoch 10/50
1200/1200 - 44s - loss: 3.1594 - accuracy100: 0.4330 - val_loss: 3.1970 - val_accuracy100: 0.4057 - 44s/epoch - 36ms/step
Epoch 11/50
1200/1200 - 44s - loss: 3.1547 - accuracy100: 0.4351 - val_loss: 3.1969 - val_accuracy100: 0.4054 - 44s/epoch - 37ms/step
Epoch 12/50
1200/1200 - 44s - loss: 3.1487 - accuracy100: 0.4385 - val_loss: 3.1926 - val_accuracy100: 0.4088 - 44s/epoch - 37ms/step
Epoch 13/50
1200/1200 - 49s - loss: 3.1464 - accuracy100: 0.4395 - val_loss: 3.1879 - val_accuracy100: 0.4116 - 49s/epoch - 41ms/step
Epoch 14/50
1200/1200 - 43s - loss: 3.1440 - accuracy100: 0.4409 - val_loss: 3.1882 - val_accuracy100: 0.4144 - 43s/epoch - 36ms/step
Epoch 15/50
1200/1200 - 43s - loss: 3.1387 - accuracy100: 0.4418 - val_loss: 3.1919 - val_accuracy100: 0.4121 - 43s/epoch - 36ms/step
Epoch 16/50
1200/1200 - 43s - loss: 3.1347 - accuracy100: 0.4442 - val_loss: 3.1950 - val_accuracy100: 0.4132 - 43s/epoch - 36ms/step
Epoch 17/50
1200/1200 - 44s - loss: 3.1294 - accuracy100: 0.4464 - val_loss: 3.1920 - val_accuracy100: 0.4147 - 44s/epoch - 36ms/step
Epoch 18/50
1200/1200 - 45s - loss: 3.1254 - accuracy100: 0.4476 - val_loss: 3.1971 - val_accuracy100: 0.4123 - 45s/epoch - 38ms/step
Epoch 19/50
1200/1200 - 44s - loss: 3.1224 - accuracy100: 0.4495 - val_loss: 3.1953 - val_accuracy100: 0.4143 - 44s/epoch - 37ms/step
Epoch 20/50
1200/1200 - 45s - loss: 3.1166 - accuracy100: 0.4516 - val_loss: 3.1990 - val_accuracy100: 0.4131 - 45s/epoch - 37ms/step
Epoch 21/50
1200/1200 - 44s - loss: 3.1126 - accuracy100: 0.4530 - val_loss: 3.1956 - val_accuracy100: 0.4141 - 44s/epoch - 37ms/step
Epoch 22/50
1200/1200 - 43s - loss: 3.1085 - accuracy100: 0.4545 - val_loss: 3.2012 - val_accuracy100: 0.4132 - 43s/epoch - 36ms/step
Epoch 23/50
1200/1200 - 44s - loss: 3.1031 - accuracy100: 0.4564 - val_loss: 3.2003 - val_accuracy100: 0.4129 - 44s/epoch - 36ms/step
testing model: results/WBA/W9/deepVOL_L3/h100
Evaluating performance on  test set...
2451/2451 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0758246
{'0': {'precision': 0.4166341987039319, 'recall': 0.47712186193897344, 'f1-score': 0.4448311869126349, 'support': 219642}, '1': {'precision': 0.40029636782910566, 'recall': 0.24332899817316012, 'f1-score': 0.30267208006798224, 'support': 197609}, '2': {'precision': 0.3895694004458524, 'recall': 0.4741253748393546, 'f1-score': 0.4277083601700373, 'support': 210090}, 'accuracy': 0.4024748900518219, 'macro avg': {'precision': 0.40216665565962995, 'recall': 0.3981920783171627, 'f1-score': 0.3917372090502182, 'support': 627341}, 'weighted avg': {'precision': 0.40242415044089236, 'recall': 0.4024748900518219, 'f1-score': 0.394317584876713, 'support': 627341}}
[[104796  32314  82532]
 [ 75976  48084  73549]
 [ 70758  39723  99609]]
Evaluating performance on  train set...
1200/1200 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0641689
{'0': {'precision': 0.4162177168189192, 'recall': 0.4676029707023255, 'f1-score': 0.4404165767816736, 'support': 102602}, '1': {'precision': 0.4319119233453899, 'recall': 0.2650325620333505, 'f1-score': 0.32849308953143946, 'support': 102727}, '2': {'precision': 0.403060867944746, 'recall': 0.5100969900651514, 'f1-score': 0.45030579050097597, 'support': 101763}, 'accuracy': 0.4139215609654436, 'macro avg': {'precision': 0.41706350270301834, 'recall': 0.41424417426694243, 'f1-score': 0.406405152271363, 'support': 307092}, 'weighted avg': {'precision': 0.4171078029880876, 'recall': 0.4139215609654436, 'f1-score': 0.40625349855418014, 'support': 307092}}
[[47977 16573 38052]
 [36675 27226 38826]
 [30617 19237 51909]]
Evaluating performance on  val set...
441/441 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0623806
{'0': {'precision': 0.4021489038419796, 'recall': 0.49013227513227514, 'f1-score': 0.4418027900321927, 'support': 37800}, '1': {'precision': 0.45224649115521964, 'recall': 0.2798232316744174, 'f1-score': 0.3457295684332492, 'support': 38921}, '2': {'precision': 0.4036447325160866, 'recall': 0.47727209618748784, 'f1-score': 0.43738151281888166, 'support': 36013}, 'accuracy': 0.4134156510014725, 'macro avg': {'precision': 0.41934670917109523, 'recall': 0.41574253433139347, 'f1-score': 0.40830462376144117, 'support': 112734}, 'weighted avg': {'precision': 0.41992275621889547, 'recall': 0.4134156510014725, 'f1-score': 0.40722148080750936, 'support': 112734}}
[[18527  6313 12960]
 [15596 10891 12434]
 [11947  6878 17188]]
training model: results/WBA/W9/deepVOL_L3/h200
Epoch 1/50
1200/1200 - 47s - loss: 3.3081 - accuracy200: 0.3536 - val_loss: 3.2983 - val_accuracy200: 0.3387 - 47s/epoch - 39ms/step
Epoch 2/50
1200/1200 - 42s - loss: 3.2973 - accuracy200: 0.3475 - val_loss: 3.2938 - val_accuracy200: 0.3502 - 42s/epoch - 35ms/step
Epoch 3/50
1200/1200 - 42s - loss: 3.2757 - accuracy200: 0.3704 - val_loss: 3.2889 - val_accuracy200: 0.3575 - 42s/epoch - 35ms/step
Epoch 4/50
1200/1200 - 43s - loss: 3.2670 - accuracy200: 0.3752 - val_loss: 3.2887 - val_accuracy200: 0.3601 - 43s/epoch - 35ms/step
Epoch 5/50
1200/1200 - 44s - loss: 3.2640 - accuracy200: 0.3777 - val_loss: 3.2880 - val_accuracy200: 0.3569 - 44s/epoch - 37ms/step
Epoch 6/50
1200/1200 - 43s - loss: 3.2595 - accuracy200: 0.3791 - val_loss: 3.2890 - val_accuracy200: 0.3610 - 43s/epoch - 36ms/step
Epoch 7/50
1200/1200 - 43s - loss: 3.2552 - accuracy200: 0.3827 - val_loss: 3.2817 - val_accuracy200: 0.3681 - 43s/epoch - 36ms/step
Epoch 8/50
1200/1200 - 44s - loss: 3.2520 - accuracy200: 0.3841 - val_loss: 3.2823 - val_accuracy200: 0.3684 - 44s/epoch - 37ms/step
Epoch 9/50
1200/1200 - 43s - loss: 3.2487 - accuracy200: 0.3892 - val_loss: 3.2882 - val_accuracy200: 0.3645 - 43s/epoch - 36ms/step
Epoch 10/50
1200/1200 - 43s - loss: 3.2419 - accuracy200: 0.3931 - val_loss: 3.2873 - val_accuracy200: 0.3644 - 43s/epoch - 36ms/step
Epoch 11/50
1200/1200 - 42s - loss: 3.2323 - accuracy200: 0.3999 - val_loss: 3.2816 - val_accuracy200: 0.3711 - 42s/epoch - 35ms/step
Epoch 12/50
1200/1200 - 43s - loss: 3.2257 - accuracy200: 0.4043 - val_loss: 3.2921 - val_accuracy200: 0.3668 - 43s/epoch - 35ms/step
Epoch 13/50
1200/1200 - 43s - loss: 3.2179 - accuracy200: 0.4088 - val_loss: 3.2779 - val_accuracy200: 0.3741 - 43s/epoch - 36ms/step
Epoch 14/50
1200/1200 - 43s - loss: 3.2127 - accuracy200: 0.4118 - val_loss: 3.2834 - val_accuracy200: 0.3736 - 43s/epoch - 36ms/step
Epoch 15/50
1200/1200 - 44s - loss: 3.2053 - accuracy200: 0.4156 - val_loss: 3.2808 - val_accuracy200: 0.3770 - 44s/epoch - 37ms/step
Epoch 16/50
1200/1200 - 44s - loss: 3.2024 - accuracy200: 0.4163 - val_loss: 3.2882 - val_accuracy200: 0.3722 - 44s/epoch - 36ms/step
Epoch 17/50
1200/1200 - 42s - loss: 3.1963 - accuracy200: 0.4218 - val_loss: 3.3001 - val_accuracy200: 0.3723 - 42s/epoch - 35ms/step
Epoch 18/50
1200/1200 - 40s - loss: 3.1936 - accuracy200: 0.4224 - val_loss: 3.2980 - val_accuracy200: 0.3731 - 40s/epoch - 33ms/step
Epoch 19/50
1200/1200 - 41s - loss: 3.1865 - accuracy200: 0.4269 - val_loss: 3.3138 - val_accuracy200: 0.3724 - 41s/epoch - 34ms/step
Epoch 20/50
1200/1200 - 40s - loss: 3.1818 - accuracy200: 0.4291 - val_loss: 3.3125 - val_accuracy200: 0.3733 - 40s/epoch - 33ms/step
Epoch 21/50
1200/1200 - 40s - loss: 3.1772 - accuracy200: 0.4301 - val_loss: 3.3362 - val_accuracy200: 0.3713 - 40s/epoch - 33ms/step
Epoch 22/50
1200/1200 - 41s - loss: 3.1704 - accuracy200: 0.4341 - val_loss: 3.3423 - val_accuracy200: 0.3684 - 41s/epoch - 34ms/step
Epoch 23/50
1200/1200 - 40s - loss: 3.1665 - accuracy200: 0.4352 - val_loss: 3.3524 - val_accuracy200: 0.3650 - 40s/epoch - 33ms/step
testing model: results/WBA/W9/deepVOL_L3/h200
Evaluating performance on  test set...
2451/2451 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0987214
{'0': {'precision': 0.3681926998022384, 'recall': 0.3234485911595563, 'f1-score': 0.34437333797887987, 'support': 207795}, '1': {'precision': 0.3789761832781848, 'recall': 0.4204637870273797, 'f1-score': 0.39864346826046804, 'support': 217643}, '2': {'precision': 0.3537911463686931, 'recall': 0.35628990158640533, 'f1-score': 0.35503612745291585, 'support': 201903}, 'accuracy': 0.3676756341447474, 'macro avg': {'precision': 0.36698667648303873, 'recall': 0.36673409325778045, 'f1-score': 0.3660176445640879, 'support': 627341}, 'weighted avg': {'precision': 0.3672988204786525, 'recall': 0.3676756341447474, 'f1-score': 0.366632943437557, 'support': 627341}}
[[67211 76006 64578]
 [59317 91511 66815]
 [56015 73952 71936]]
Evaluating performance on  train set...
1200/1200 - 20s - 20s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0860953
{'0': {'precision': 0.40254651214422094, 'recall': 0.3487598218836858, 'f1-score': 0.3737278484600204, 'support': 103977}, '1': {'precision': 0.3795806168121155, 'recall': 0.36908783783783783, 'f1-score': 0.3742606978407843, 'support': 100640}, '2': {'precision': 0.3848174569869912, 'recall': 0.44743595999024155, 'f1-score': 0.41377100958826846, 'support': 102475}, 'accuracy': 0.38834941971786957, 'macro avg': {'precision': 0.38898152864777585, 'recall': 0.38842787323725503, 'f1-score': 0.3872531852963577, 'support': 307092}, 'weighted avg': {'precision': 0.38910404984152275, 'recall': 0.38834941971786957, 'f1-score': 0.3872646677138509, 'support': 307092}}
[[36263 31227 36487]
 [26683 37145 36812]
 [27138 29486 45851]]
Evaluating performance on  val set...
441/441 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0925847
{'0': {'precision': 0.38255743252174373, 'recall': 0.376221921797005, 'f1-score': 0.3793632276415305, 'support': 38464}, '1': {'precision': 0.37855765959859394, 'recall': 0.35357038841377847, 'f1-score': 0.3656376206448079, 'support': 37769}, '2': {'precision': 0.3672377684136156, 'recall': 0.3987288019506315, 'f1-score': 0.3823359428361267, 'support': 36501}, 'accuracy': 0.37592030798162046, 'macro avg': {'precision': 0.3761176201779844, 'recall': 0.37617370405380496, 'f1-score': 0.375778930374155, 'support': 112734}, 'weighted avg': {'precision': 0.37625719937872365, 'recall': 0.37592030798162046, 'f1-score': 0.375727275991263, 'support': 112734}}
[[14471 11342 12651]
 [11989 13354 12426]
 [11367 10580 14554]]
training model: results/WBA/W9/deepVOL_L3/h300
Epoch 1/50
1200/1200 - 47s - loss: 3.3087 - accuracy300: 0.3592 - val_loss: 3.3009 - val_accuracy300: 0.3314 - 47s/epoch - 39ms/step
Epoch 2/50
1200/1200 - 46s - loss: 3.2988 - accuracy300: 0.3499 - val_loss: 3.2995 - val_accuracy300: 0.3315 - 46s/epoch - 39ms/step
Epoch 3/50
1200/1200 - 43s - loss: 3.2863 - accuracy300: 0.3617 - val_loss: 3.3046 - val_accuracy300: 0.3327 - 43s/epoch - 36ms/step
Epoch 4/50
1200/1200 - 41s - loss: 3.2771 - accuracy300: 0.3671 - val_loss: 3.3099 - val_accuracy300: 0.3417 - 41s/epoch - 34ms/step
Epoch 5/50
1200/1200 - 41s - loss: 3.2724 - accuracy300: 0.3713 - val_loss: 3.3031 - val_accuracy300: 0.3388 - 41s/epoch - 34ms/step
Epoch 6/50
1200/1200 - 42s - loss: 3.2651 - accuracy300: 0.3798 - val_loss: 3.3030 - val_accuracy300: 0.3503 - 42s/epoch - 35ms/step
Epoch 7/50
1200/1200 - 42s - loss: 3.2597 - accuracy300: 0.3833 - val_loss: 3.3037 - val_accuracy300: 0.3507 - 42s/epoch - 35ms/step
Epoch 8/50
1200/1200 - 42s - loss: 3.2549 - accuracy300: 0.3859 - val_loss: 3.3095 - val_accuracy300: 0.3512 - 42s/epoch - 35ms/step
Epoch 9/50
1200/1200 - 43s - loss: 3.2518 - accuracy300: 0.3876 - val_loss: 3.3308 - val_accuracy300: 0.3408 - 43s/epoch - 36ms/step
Epoch 10/50
1200/1200 - 42s - loss: 3.2480 - accuracy300: 0.3922 - val_loss: 3.3238 - val_accuracy300: 0.3417 - 42s/epoch - 35ms/step
Epoch 11/50
1200/1200 - 41s - loss: 3.2414 - accuracy300: 0.3970 - val_loss: 3.3320 - val_accuracy300: 0.3446 - 41s/epoch - 35ms/step
Epoch 12/50
1200/1200 - 42s - loss: 3.2364 - accuracy300: 0.4000 - val_loss: 3.3349 - val_accuracy300: 0.3438 - 42s/epoch - 35ms/step
testing model: results/WBA/W9/deepVOL_L3/h300
Evaluating performance on  test set...
2451/2451 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1004932
{'0': {'precision': 0.3474722991689751, 'recall': 0.009508288365967245, 'f1-score': 0.0185100643286989, 'support': 211079}, '1': {'precision': 0.3404696647800068, 'recall': 0.983343716187416, 'f1-score': 0.5058095200234187, 'support': 213493}, '2': {'precision': 0.30938446014127147, 'recall': 0.007560327268961232, 'f1-score': 0.014759969960139417, 'support': 202769}, 'accuracy': 0.34028861496379165, 'macro avg': {'precision': 0.33244214136341776, 'recall': 0.33347077727411484, 'f1-score': 0.17969318477075236, 'support': 627341}, 'weighted avg': {'precision': 0.33277846207652867, 'recall': 0.34028861496379165, 'f1-score': 0.18313284493703533, 'support': 627341}}
[[  2007 207291   1781]
 [  1915 209937   1641]
 [  1854 199382   1533]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1029284
{'0': {'precision': 0.3533145275035261, 'recall': 0.009438938920079883, 'f1-score': 0.01838667058132707, 'support': 106156}, '1': {'precision': 0.31648889434123667, 'recall': 0.9830079090459714, 'f1-score': 0.4788177784689008, 'support': 97104}, '2': {'precision': 0.37617791179796456, 'recall': 0.009611680406811002, 'f1-score': 0.0187444240972907, 'support': 103832}, 'accuracy': 0.31734463939145274, 'macro avg': {'precision': 0.34866044454757583, 'recall': 0.33401950945762077, 'f1-score': 0.17198295771583952, 'support': 307092}, 'weighted avg': {'precision': 0.3494005038085721, 'recall': 0.31734463939145274, 'f1-score': 0.16409821162891047, 'support': 307092}}
[[  1002 104259    895]
 [   890  95454    760]
 [   944 101890    998]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011405
{'0': {'precision': 0.3443830570902394, 'recall': 0.00956497276284494, 'f1-score': 0.018612984298404956, 'support': 39101}, '1': {'precision': 0.33070062082614154, 'recall': 0.9814675749611114, 'f1-score': 0.4947108722836189, 'support': 37286}, '2': {'precision': 0.3528816986855409, 'recall': 0.009601892865986188, 'f1-score': 0.018695093207628025, 'support': 36347}, 'accuracy': 0.33102701935529655, 'macro avg': {'precision': 0.342655125533974, 'recall': 0.33354481352998083, 'f1-score': 0.17733964992988396, 'support': 112734}, 'weighted avg': {'precision': 0.3425977643437856, 'recall': 0.33102701935529655, 'f1-score': 0.17610557982362554, 'support': 112734}}
[[  374 38413   314]
 [  365 36595   326]
 [  347 35651   349]]
training model: results/WBA/W9/deepVOL_L3/h500
Epoch 1/50
1200/1200 - 44s - loss: 3.2801 - accuracy500: 0.3829 - val_loss: 3.3117 - val_accuracy500: 0.3410 - 44s/epoch - 36ms/step
Epoch 2/50
1200/1200 - 46s - loss: 3.2858 - accuracy500: 0.3637 - val_loss: 3.3107 - val_accuracy500: 0.3319 - 46s/epoch - 38ms/step
Epoch 3/50
1200/1200 - 44s - loss: 3.2872 - accuracy500: 0.3631 - val_loss: 3.3129 - val_accuracy500: 0.3361 - 44s/epoch - 36ms/step
Epoch 4/50
1200/1200 - 40s - loss: 3.2724 - accuracy500: 0.3803 - val_loss: 3.2970 - val_accuracy500: 0.3515 - 40s/epoch - 34ms/step
Epoch 5/50
1200/1200 - 41s - loss: 3.2665 - accuracy500: 0.3771 - val_loss: 3.3044 - val_accuracy500: 0.3404 - 41s/epoch - 34ms/step
Epoch 6/50
1200/1200 - 40s - loss: 3.2502 - accuracy500: 0.3888 - val_loss: 3.3010 - val_accuracy500: 0.3469 - 40s/epoch - 34ms/step
Epoch 7/50
1200/1200 - 40s - loss: 3.2431 - accuracy500: 0.3925 - val_loss: 3.3072 - val_accuracy500: 0.3539 - 40s/epoch - 34ms/step
Epoch 8/50
1200/1200 - 40s - loss: 3.2390 - accuracy500: 0.3958 - val_loss: 3.3172 - val_accuracy500: 0.3481 - 40s/epoch - 33ms/step
Epoch 9/50
1200/1200 - 40s - loss: 3.2403 - accuracy500: 0.3947 - val_loss: 3.3294 - val_accuracy500: 0.3389 - 40s/epoch - 34ms/step
Epoch 10/50
1200/1200 - 41s - loss: 3.2355 - accuracy500: 0.4000 - val_loss: 3.3327 - val_accuracy500: 0.3516 - 41s/epoch - 34ms/step
Epoch 11/50
1200/1200 - 40s - loss: 3.2288 - accuracy500: 0.4036 - val_loss: 3.3390 - val_accuracy500: 0.3454 - 40s/epoch - 33ms/step
Epoch 12/50
1200/1200 - 40s - loss: 3.2230 - accuracy500: 0.4094 - val_loss: 3.3365 - val_accuracy500: 0.3474 - 40s/epoch - 34ms/step
Epoch 13/50
1200/1200 - 40s - loss: 3.2183 - accuracy500: 0.4107 - val_loss: 3.3568 - val_accuracy500: 0.3394 - 40s/epoch - 34ms/step
Epoch 14/50
1200/1200 - 40s - loss: 3.2172 - accuracy500: 0.4128 - val_loss: 3.3571 - val_accuracy500: 0.3376 - 40s/epoch - 33ms/step
testing model: results/WBA/W9/deepVOL_L3/h500
Evaluating performance on  test set...
2451/2451 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.096328
{'0': {'precision': 0.34987838966130613, 'recall': 0.8677031942093701, 'f1-score': 0.4986780357318405, 'support': 222152}, '1': {'precision': 0.3212996389891697, 'recall': 0.00046875164589763307, 'f1-score': 0.0009361375385893774, 'support': 189866}, '2': {'precision': 0.3403394461667805, 'recall': 0.12032156341867799, 'f1-score': 0.17778875747563022, 'support': 215323}, 'accuracy': 0.348708278272901, 'macro avg': {'precision': 0.33717249160575213, 'recall': 0.3294978364246486, 'f1-score': 0.22580097691535336, 'support': 627341}, 'weighted avg': {'precision': 0.33795491103455033, 'recall': 0.348708278272901, 'f1-score': 0.23789625149595955, 'support': 627341}}
[[192762     85  29305]
 [168866     89  20911]
 [189312    103  25908]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1000605
{'0': {'precision': 0.3405517100437871, 'recall': 0.8572449271220348, 'f1-score': 0.4874554107090137, 'support': 104970}, '1': {'precision': 0.35172413793103446, 'recall': 0.0005080187269648371, 'f1-score': 0.0010145720395882032, 'support': 100390}, '2': {'precision': 0.34335346724727256, 'recall': 0.14416309519128692, 'f1-score': 0.2030655054484029, 'support': 101732}, 'accuracy': 0.3409466869863103, 'macro avg': {'precision': 0.34520977174069806, 'recall': 0.3339720136800955, 'f1-score': 0.2305118293990016, 'support': 307092}, 'weighted avg': {'precision': 0.34513218885608354, 'recall': 0.3409466869863103, 'f1-score': 0.2342239698509123, 'support': 307092}}
[[89985    43 14942]
 [87233    51 13106]
 [87015    51 14666]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098428
{'0': {'precision': 0.3535318990175351, 'recall': 0.8541703182512457, 'f1-score': 0.5000842929289228, 'support': 39937}, '1': {'precision': 0.34328358208955223, 'recall': 0.000643915003219575, 'f1-score': 0.0012854188788911864, 'support': 35719}, '2': {'precision': 0.34794435857805256, 'recall': 0.1517881223366956, 'f1-score': 0.2113683736127542, 'support': 37078}, 'accuracy': 0.3527241116255965, 'macro avg': {'precision': 0.3482532798950466, 'recall': 0.335534118530387, 'f1-score': 0.23757936180685604, 'support': 112734}, 'weighted avg': {'precision': 0.3484470580931844, 'recall': 0.3527241116255965, 'f1-score': 0.2470851459227137, 'support': 112734}}
[[34113    21  5803]
 [30952    23  4744]
 [31427    23  5628]]
training model: results/WBA/W9/deepVOL_L3/h1000
Epoch 1/50
1200/1200 - 47s - loss: 3.2979 - accuracy1000: 0.3653 - val_loss: 3.2963 - val_accuracy1000: 0.3588 - 47s/epoch - 39ms/step
Epoch 2/50
1200/1200 - 42s - loss: 3.2698 - accuracy1000: 0.3743 - val_loss: 3.3098 - val_accuracy1000: 0.3615 - 42s/epoch - 35ms/step
Epoch 3/50
1200/1200 - 42s - loss: 3.2561 - accuracy1000: 0.3880 - val_loss: 3.3060 - val_accuracy1000: 0.3634 - 42s/epoch - 35ms/step
Epoch 4/50
1200/1200 - 41s - loss: 3.2498 - accuracy1000: 0.3892 - val_loss: 3.3089 - val_accuracy1000: 0.3580 - 41s/epoch - 34ms/step
Epoch 5/50
1200/1200 - 43s - loss: 3.2435 - accuracy1000: 0.3962 - val_loss: 3.3092 - val_accuracy1000: 0.3607 - 43s/epoch - 36ms/step
Epoch 6/50
1200/1200 - 42s - loss: 3.2444 - accuracy1000: 0.3960 - val_loss: 3.3226 - val_accuracy1000: 0.3617 - 42s/epoch - 35ms/step
Epoch 7/50
1200/1200 - 42s - loss: 3.2388 - accuracy1000: 0.3975 - val_loss: 3.3225 - val_accuracy1000: 0.3601 - 42s/epoch - 35ms/step
Epoch 8/50
1200/1200 - 41s - loss: 3.2335 - accuracy1000: 0.4022 - val_loss: 3.3384 - val_accuracy1000: 0.3558 - 41s/epoch - 34ms/step
Epoch 9/50
1200/1200 - 41s - loss: 3.2283 - accuracy1000: 0.4057 - val_loss: 3.3283 - val_accuracy1000: 0.3571 - 41s/epoch - 34ms/step
Epoch 10/50
1200/1200 - 42s - loss: 3.2224 - accuracy1000: 0.4106 - val_loss: 3.3555 - val_accuracy1000: 0.3546 - 42s/epoch - 35ms/step
Epoch 11/50
1200/1200 - 44s - loss: 3.2164 - accuracy1000: 0.4126 - val_loss: 3.3618 - val_accuracy1000: 0.3518 - 44s/epoch - 37ms/step
testing model: results/WBA/W9/deepVOL_L3/h1000
Evaluating performance on  test set...
2451/2451 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0960014
{'0': {'precision': 0.3723627355768554, 'recall': 0.258697905462226, 'f1-score': 0.30529382915500686, 'support': 204532}, '1': {'precision': 0.3684193652496746, 'recall': 0.776586877874942, 'f1-score': 0.49975211283939525, 'support': 221961}, '2': {'precision': 0.3475883504086566, 'recall': 0.030067513741735042, 'f1-score': 0.05534730687098459, 'support': 200848}, 'accuracy': 0.36873566369805255, 'macro avg': {'precision': 0.36279015041172885, 'recall': 0.3551174323596343, 'f1-score': 0.28679774962179555, 'support': 627341}, 'weighted avg': {'precision': 0.36303581427973985, 'recall': 0.36873566369805255, 'f1-score': 0.2940732904004367, 'support': 627341}}
[[ 52912 146066   5554]
 [ 43808 172372   5781]
 [ 45378 149431   6039]]
Evaluating performance on  train set...
1200/1200 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988775
{'0': {'precision': 0.373084307510537, 'recall': 0.3126844781292251, 'f1-score': 0.340224502587426, 'support': 105026}, '1': {'precision': 0.35098109879271266, 'recall': 0.727869013668994, 'f1-score': 0.47359362203112204, 'support': 101690}, '2': {'precision': 0.32408652083587924, 'recall': 0.026420658324699132, 'f1-score': 0.04885822455991673, 'support': 100376}, 'accuracy': 0.35659997655425735, 'macro avg': {'precision': 0.34938397571304297, 'recall': 0.35565805004097273, 'f1-score': 0.2875587830594883, 'support': 307092}, 'weighted avg': {'precision': 0.34974968098242487, 'recall': 0.35659997655425735, 'f1-score': 0.28915226440779307, 'support': 307092}}
[[32840 69320  2866]
 [25008 74017  2665]
 [30175 67549  2652]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0989127
{'0': {'precision': 0.34509412791422517, 'recall': 0.29152185360716165, 'f1-score': 0.3160538935830099, 'support': 37980}, '1': {'precision': 0.36806740063058874, 'recall': 0.7224490831156314, 'f1-score': 0.4876770962633224, 'support': 39427}, '2': {'precision': 0.309319435928878, 'recall': 0.028561723327766297, 'f1-score': 0.05229469537951229, 'support': 35327}, 'accuracy': 0.3598293327656253, 'macro avg': {'precision': 0.3408269881578973, 'recall': 0.34751088668351987, 'f1-score': 0.2853418950752815, 'support': 112734}, 'weighted avg': {'precision': 0.34191810896361313, 'recall': 0.3598293327656253, 'f1-score': 0.2934233368489432, 'support': 112734}}
[[11072 25795  1113]
 [ 9803 28484  1140]
 [11209 23109  1009]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        21 (peak)  14.12 (ave)

============================================
