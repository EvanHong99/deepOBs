This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/PCAR_orderbooks/PCAR_orderbooks_2019-12-18.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-12-10.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-11-27.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-12-06.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-12-02.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-12-04.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-11-29.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-12-20.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-12-03.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-12-16.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-12-05.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-11-26.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-12-12.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-12-11.csv
training model: results/PCAR/W9/deepLOB_L1/h10
Epoch 1/50
477/477 - 16s - loss: 3.2589 - accuracy10: 0.3976 - val_loss: 3.3572 - val_accuracy10: 0.3853 - 16s/epoch - 33ms/step
Epoch 2/50
477/477 - 8s - loss: 3.1807 - accuracy10: 0.4348 - val_loss: 3.2967 - val_accuracy10: 0.3896 - 8s/epoch - 16ms/step
Epoch 3/50
477/477 - 8s - loss: 3.1652 - accuracy10: 0.4422 - val_loss: 3.2270 - val_accuracy10: 0.4104 - 8s/epoch - 16ms/step
Epoch 4/50
477/477 - 8s - loss: 3.1403 - accuracy10: 0.4530 - val_loss: 3.2192 - val_accuracy10: 0.4244 - 8s/epoch - 16ms/step
Epoch 5/50
477/477 - 8s - loss: 3.1194 - accuracy10: 0.4633 - val_loss: 3.2048 - val_accuracy10: 0.4249 - 8s/epoch - 16ms/step
Epoch 6/50
477/477 - 8s - loss: 3.1002 - accuracy10: 0.4675 - val_loss: 3.1870 - val_accuracy10: 0.4341 - 8s/epoch - 16ms/step
Epoch 7/50
477/477 - 8s - loss: 3.0840 - accuracy10: 0.4703 - val_loss: 3.1846 - val_accuracy10: 0.4306 - 8s/epoch - 16ms/step
Epoch 8/50
477/477 - 8s - loss: 3.0799 - accuracy10: 0.4717 - val_loss: 3.1885 - val_accuracy10: 0.4279 - 8s/epoch - 16ms/step
Epoch 9/50
477/477 - 8s - loss: 3.0681 - accuracy10: 0.4756 - val_loss: 3.1811 - val_accuracy10: 0.4317 - 8s/epoch - 16ms/step
Epoch 10/50
477/477 - 8s - loss: 3.0587 - accuracy10: 0.4772 - val_loss: 3.1769 - val_accuracy10: 0.4319 - 8s/epoch - 16ms/step
Epoch 11/50
477/477 - 8s - loss: 3.0515 - accuracy10: 0.4796 - val_loss: 3.1828 - val_accuracy10: 0.4352 - 8s/epoch - 16ms/step
Epoch 12/50
477/477 - 8s - loss: 3.0456 - accuracy10: 0.4808 - val_loss: 3.1761 - val_accuracy10: 0.4333 - 8s/epoch - 16ms/step
Epoch 13/50
477/477 - 8s - loss: 3.0388 - accuracy10: 0.4835 - val_loss: 3.1839 - val_accuracy10: 0.4323 - 8s/epoch - 16ms/step
Epoch 14/50
477/477 - 8s - loss: 3.0323 - accuracy10: 0.4842 - val_loss: 3.2118 - val_accuracy10: 0.4300 - 8s/epoch - 16ms/step
Epoch 15/50
477/477 - 8s - loss: 3.0276 - accuracy10: 0.4850 - val_loss: 3.2035 - val_accuracy10: 0.4315 - 8s/epoch - 16ms/step
Epoch 16/50
477/477 - 8s - loss: 3.0241 - accuracy10: 0.4860 - val_loss: 3.2139 - val_accuracy10: 0.4330 - 8s/epoch - 16ms/step
Epoch 17/50
477/477 - 8s - loss: 3.0178 - accuracy10: 0.4871 - val_loss: 3.2304 - val_accuracy10: 0.4309 - 8s/epoch - 16ms/step
Epoch 18/50
477/477 - 8s - loss: 3.0129 - accuracy10: 0.4883 - val_loss: 3.2188 - val_accuracy10: 0.4285 - 8s/epoch - 16ms/step
Epoch 19/50
477/477 - 8s - loss: 3.0080 - accuracy10: 0.4899 - val_loss: 3.2053 - val_accuracy10: 0.4296 - 8s/epoch - 16ms/step
Epoch 20/50
477/477 - 8s - loss: 3.0044 - accuracy10: 0.4904 - val_loss: 3.2147 - val_accuracy10: 0.4278 - 8s/epoch - 16ms/step
Epoch 21/50
477/477 - 8s - loss: 3.0008 - accuracy10: 0.4922 - val_loss: 3.2294 - val_accuracy10: 0.4285 - 8s/epoch - 17ms/step
Epoch 22/50
477/477 - 8s - loss: 2.9967 - accuracy10: 0.4934 - val_loss: 3.2021 - val_accuracy10: 0.4300 - 8s/epoch - 17ms/step
testing model: results/PCAR/W9/deepLOB_L1/h10
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0776943
{'0': {'precision': 0.5000380199224393, 'recall': 0.32257431570685763, 'f1-score': 0.39216387870113606, 'support': 61158}, '1': {'precision': 0.2897998753548923, 'recall': 0.20943849464518066, 'f1-score': 0.2431513813438689, 'support': 39964}, '2': {'precision': 0.4302754563152743, 'recall': 0.6646728475060645, 'f1-score': 0.5223852336460802, 'support': 60186}, 'accuracy': 0.4221861284003273, 'macro avg': {'precision': 0.40670445053086873, 'recall': 0.3988952192860342, 'f1-score': 0.385900164563695, 'support': 161308}, 'weighted avg': {'precision': 0.4219223228537367, 'recall': 0.4221861284003273, 'f1-score': 0.40383327528611995, 'support': 161308}}
[[19728 11609 29821]
 [ 8446  8370 23148]
 [11279  8903 40004]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0525635
{'0': {'precision': 0.4552072913193287, 'recall': 0.39487068238243306, 'f1-score': 0.42289770893836726, 'support': 41487}, '1': {'precision': 0.4365565075479396, 'recall': 0.35624647851252367, 'f1-score': 0.3923338363254312, 'support': 39046}, '2': {'precision': 0.43633505917159765, 'recall': 0.5700033818058844, 'f1-score': 0.49429187875741015, 'support': 41398}, 'accuracy': 0.44196307747824587, 'macro avg': {'precision': 0.44269961934628865, 'recall': 0.44037351423361376, 'f1-score': 0.4365078080070695, 'support': 121931}, 'weighted avg': {'precision': 0.4428272471173667, 'recall': 0.44196307747824587, 'f1-score': 0.4373499718749792, 'support': 121931}}
[[16382  9599 15506]
 [10159 13910 14977]
 [ 9447  8354 23597]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0573883
{'0': {'precision': 0.4568065144273323, 'recall': 0.32935545628589663, 'f1-score': 0.38274992583803025, 'support': 15670}, '1': {'precision': 0.43833232951883827, 'recall': 0.41398053343445834, 'f1-score': 0.42580854867544293, 'support': 15822}, '2': {'precision': 0.41795095473490357, 'recall': 0.560618864980823, 'f1-score': 0.4788849709859233, 'support': 15383}, 'accuracy': 0.43381333333333333, 'macro avg': {'precision': 0.43769659956035806, 'recall': 0.43465161823372594, 'f1-score': 0.42914781516646555, 'support': 46875}, 'weighted avg': {'precision': 0.4378195570220881, 'recall': 0.43381333333333333, 'f1-score': 0.4288324630122934, 'support': 46875}}
[[5161 4408 6101]
 [3363 6550 5909]
 [2774 3985 8624]]
training model: results/PCAR/W9/deepLOB_L1/h20
Epoch 1/50
477/477 - 10s - loss: 3.2852 - accuracy20: 0.3837 - val_loss: 3.3231 - val_accuracy20: 0.3715 - 10s/epoch - 21ms/step
Epoch 2/50
477/477 - 8s - loss: 3.2292 - accuracy20: 0.4055 - val_loss: 3.2972 - val_accuracy20: 0.3846 - 8s/epoch - 17ms/step
Epoch 3/50
477/477 - 8s - loss: 3.2035 - accuracy20: 0.4204 - val_loss: 3.2810 - val_accuracy20: 0.3904 - 8s/epoch - 17ms/step
Epoch 4/50
477/477 - 8s - loss: 3.1902 - accuracy20: 0.4257 - val_loss: 3.2754 - val_accuracy20: 0.3950 - 8s/epoch - 17ms/step
Epoch 5/50
477/477 - 8s - loss: 3.1713 - accuracy20: 0.4347 - val_loss: 3.2392 - val_accuracy20: 0.4014 - 8s/epoch - 17ms/step
Epoch 6/50
477/477 - 8s - loss: 3.1608 - accuracy20: 0.4413 - val_loss: 3.2930 - val_accuracy20: 0.3959 - 8s/epoch - 17ms/step
Epoch 7/50
477/477 - 8s - loss: 3.1497 - accuracy20: 0.4443 - val_loss: 3.2457 - val_accuracy20: 0.4053 - 8s/epoch - 17ms/step
Epoch 8/50
477/477 - 8s - loss: 3.1408 - accuracy20: 0.4468 - val_loss: 3.2669 - val_accuracy20: 0.4018 - 8s/epoch - 17ms/step
Epoch 9/50
477/477 - 8s - loss: 3.1352 - accuracy20: 0.4484 - val_loss: 3.3073 - val_accuracy20: 0.3938 - 8s/epoch - 17ms/step
Epoch 10/50
477/477 - 8s - loss: 3.1289 - accuracy20: 0.4514 - val_loss: 3.2918 - val_accuracy20: 0.4002 - 8s/epoch - 17ms/step
Epoch 11/50
477/477 - 8s - loss: 3.1221 - accuracy20: 0.4520 - val_loss: 3.3107 - val_accuracy20: 0.3993 - 8s/epoch - 17ms/step
Epoch 12/50
477/477 - 8s - loss: 3.1213 - accuracy20: 0.4529 - val_loss: 3.3206 - val_accuracy20: 0.3992 - 8s/epoch - 17ms/step
Epoch 13/50
477/477 - 8s - loss: 3.1178 - accuracy20: 0.4543 - val_loss: 3.2745 - val_accuracy20: 0.4060 - 8s/epoch - 17ms/step
Epoch 14/50
477/477 - 8s - loss: 3.1164 - accuracy20: 0.4539 - val_loss: 3.2789 - val_accuracy20: 0.4051 - 8s/epoch - 17ms/step
Epoch 15/50
477/477 - 8s - loss: 3.1121 - accuracy20: 0.4559 - val_loss: 3.2691 - val_accuracy20: 0.4051 - 8s/epoch - 17ms/step
testing model: results/PCAR/W9/deepLOB_L1/h20
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0833814
{'0': {'precision': 0.42496546961325965, 'recall': 0.617769597590563, 'f1-score': 0.5035425687885711, 'support': 59765}, '1': {'precision': 0.29287215628091, 'recall': 0.21777103587763452, 'f1-score': 0.24979897444009436, 'support': 43509}, '2': {'precision': 0.4420572297746934, 'recall': 0.32050177482165626, 'f1-score': 0.371591249625412, 'support': 58034}, 'accuracy': 0.4029310387581521, 'macro avg': {'precision': 0.3866316185562877, 'recall': 0.3853474694299513, 'f1-score': 0.3749775976180258, 'support': 161308}, 'weighted avg': {'precision': 0.39548556309548905, 'recall': 0.4029310387581521, 'f1-score': 0.38762895692293114, 'support': 161308}}
[[36921 11138 11706]
 [22264  9475 11770]
 [27695 11739 18600]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0776559
{'0': {'precision': 0.39911842387036905, 'recall': 0.5519224125166576, 'f1-score': 0.4632448890822097, 'support': 40522}, '1': {'precision': 0.38343347382895404, 'recall': 0.3147035010672489, 'f1-score': 0.3456853339082628, 'support': 40759}, '2': {'precision': 0.42891930213920226, 'recall': 0.34231242312423127, 'f1-score': 0.38075302358671265, 'support': 40650}, 'accuracy': 0.4027441749842124, 'macro avg': {'precision': 0.40382373327950843, 'recall': 0.4029794455693792, 'f1-score': 0.39656108219239505, 'support': 121931}, 'weighted avg': {'precision': 0.40381044495516316, 'recall': 0.4027441749842124, 'f1-score': 0.3964455989777501, 'support': 121931}}
[[22365 10007  8150]
 [17555 12827 10377]
 [16116 10619 13915]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0793861
{'0': {'precision': 0.40408639813193226, 'recall': 0.4541994750656168, 'f1-score': 0.4276799505715168, 'support': 15240}, '1': {'precision': 0.4025164769322948, 'recall': 0.40290272280196715, 'f1-score': 0.402709507253327, 'support': 16674}, '2': {'precision': 0.39754883186518575, 'recall': 0.3469019450571486, 'f1-score': 0.37050256996002284, 'support': 14961}, 'accuracy': 0.40170666666666666, 'macro avg': {'precision': 0.40138390230980425, 'recall': 0.4013347143082442, 'f1-score': 0.4002973425949556, 'support': 46875}, 'weighted avg': {'precision': 0.4014413763719418, 'recall': 0.40170666666666666, 'f1-score': 0.4005484740229076, 'support': 46875}}
[[6922 4869 3449]
 [5540 6718 4416]
 [4668 5103 5190]]
training model: results/PCAR/W9/deepLOB_L1/h30
Epoch 1/50
477/477 - 10s - loss: 3.2946 - accuracy30: 0.3754 - val_loss: 3.3460 - val_accuracy30: 0.3674 - 10s/epoch - 22ms/step
Epoch 2/50
477/477 - 8s - loss: 3.2466 - accuracy30: 0.3989 - val_loss: 3.3061 - val_accuracy30: 0.3746 - 8s/epoch - 17ms/step
Epoch 3/50
477/477 - 8s - loss: 3.2279 - accuracy30: 0.4083 - val_loss: 3.3025 - val_accuracy30: 0.3766 - 8s/epoch - 17ms/step
Epoch 4/50
477/477 - 8s - loss: 3.2125 - accuracy30: 0.4172 - val_loss: 3.3014 - val_accuracy30: 0.3791 - 8s/epoch - 17ms/step
Epoch 5/50
477/477 - 8s - loss: 3.2059 - accuracy30: 0.4194 - val_loss: 3.2744 - val_accuracy30: 0.3919 - 8s/epoch - 17ms/step
Epoch 6/50
477/477 - 8s - loss: 3.1926 - accuracy30: 0.4276 - val_loss: 3.2776 - val_accuracy30: 0.3864 - 8s/epoch - 17ms/step
Epoch 7/50
477/477 - 8s - loss: 3.1864 - accuracy30: 0.4271 - val_loss: 3.2890 - val_accuracy30: 0.3869 - 8s/epoch - 17ms/step
Epoch 8/50
477/477 - 8s - loss: 3.1796 - accuracy30: 0.4275 - val_loss: 3.2886 - val_accuracy30: 0.3920 - 8s/epoch - 17ms/step
Epoch 9/50
477/477 - 8s - loss: 3.1712 - accuracy30: 0.4332 - val_loss: 3.3144 - val_accuracy30: 0.3904 - 8s/epoch - 17ms/step
Epoch 10/50
477/477 - 8s - loss: 3.1673 - accuracy30: 0.4348 - val_loss: 3.3097 - val_accuracy30: 0.3907 - 8s/epoch - 18ms/step
Epoch 11/50
477/477 - 8s - loss: 3.1616 - accuracy30: 0.4365 - val_loss: 3.3062 - val_accuracy30: 0.3921 - 8s/epoch - 17ms/step
Epoch 12/50
477/477 - 8s - loss: 3.1591 - accuracy30: 0.4369 - val_loss: 3.3277 - val_accuracy30: 0.3889 - 8s/epoch - 18ms/step
Epoch 13/50
477/477 - 8s - loss: 3.1520 - accuracy30: 0.4408 - val_loss: 3.3391 - val_accuracy30: 0.3857 - 8s/epoch - 17ms/step
Epoch 14/50
477/477 - 9s - loss: 3.1480 - accuracy30: 0.4411 - val_loss: 3.3520 - val_accuracy30: 0.3850 - 9s/epoch - 18ms/step
Epoch 15/50
477/477 - 8s - loss: 3.1447 - accuracy30: 0.4438 - val_loss: 3.3766 - val_accuracy30: 0.3821 - 8s/epoch - 18ms/step
testing model: results/PCAR/W9/deepLOB_L1/h30
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.095207
{'0': {'precision': 0.4166060341482344, 'recall': 0.5711554447215295, 'f1-score': 0.48179000659121823, 'support': 60150}, '1': {'precision': 0.2936866239629376, 'recall': 0.2823671113333182, 'f1-score': 0.28791565287915655, 'support': 44003}, '2': {'precision': 0.4059720283548184, 'recall': 0.25952235150030617, 'f1-score': 0.3166332237544294, 'support': 57155}, 'accuracy': 0.38195873732238944, 'macro avg': {'precision': 0.3720882288219968, 'recall': 0.3710149691850513, 'f1-score': 0.36211296107493474, 'support': 161308}, 'weighted avg': {'precision': 0.3793071437800797, 'recall': 0.38195873732238944, 'f1-score': 0.3703845641492531, 'support': 161308}}
[[34355 14082 11713]
 [21587 12425  9991]
 [26522 15800 14833]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0874839
{'0': {'precision': 0.3913376096039546, 'recall': 0.4887429873343296, 'f1-score': 0.43464999237456153, 'support': 40819}, '1': {'precision': 0.35469113466011887, 'recall': 0.34451334320789295, 'f1-score': 0.34952816372273093, 'support': 39833}, '2': {'precision': 0.4213315975450995, 'recall': 0.32929576782383296, 'f1-score': 0.3696713397968481, 'support': 41279}, 'accuracy': 0.38764547161919444, 'macro avg': {'precision': 0.38912011393639095, 'recall': 0.38751736612201854, 'f1-score': 0.3846164986313802, 'support': 121931}, 'weighted avg': {'precision': 0.3895200471447335, 'recall': 0.38764547161919444, 'f1-score': 0.38484385939407423, 'support': 121931}}
[[19950 11837  9032]
 [16473 13723  9637]
 [14556 13130 13593]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.092271
{'0': {'precision': 0.42468398876404495, 'recall': 0.31374837872892347, 'f1-score': 0.3608831866328509, 'support': 15420}, '1': {'precision': 0.3754678377164529, 'recall': 0.45878048780487807, 'f1-score': 0.4129641318367683, 'support': 16400}, '2': {'precision': 0.3831908831908832, 'recall': 0.3930919960146131, 'f1-score': 0.38807829764910323, 'support': 15055}, 'accuracy': 0.38997333333333334, 'macro avg': {'precision': 0.39444756989046037, 'recall': 0.38854028751613817, 'f1-score': 0.38730853870624077, 'support': 46875}, 'weighted avg': {'precision': 0.3941384190235765, 'recall': 0.38997333333333334, 'f1-score': 0.3878389177836546, 'support': 46875}}
[[4838 6131 4451]
 [3801 7524 5075]
 [2753 6384 5918]]
training model: results/PCAR/W9/deepLOB_L1/h50
Epoch 1/50
477/477 - 10s - loss: 3.3029 - accuracy50: 0.3775 - val_loss: 3.3560 - val_accuracy50: 0.3500 - 10s/epoch - 22ms/step
Epoch 2/50
477/477 - 9s - loss: 3.2667 - accuracy50: 0.3900 - val_loss: 3.3071 - val_accuracy50: 0.3608 - 9s/epoch - 18ms/step
Epoch 3/50
477/477 - 9s - loss: 3.2443 - accuracy50: 0.3987 - val_loss: 3.3139 - val_accuracy50: 0.3656 - 9s/epoch - 18ms/step
Epoch 4/50
477/477 - 9s - loss: 3.2312 - accuracy50: 0.4034 - val_loss: 3.3072 - val_accuracy50: 0.3673 - 9s/epoch - 18ms/step
Epoch 5/50
477/477 - 9s - loss: 3.2321 - accuracy50: 0.3990 - val_loss: 3.3093 - val_accuracy50: 0.3727 - 9s/epoch - 18ms/step
Epoch 6/50
477/477 - 8s - loss: 3.2259 - accuracy50: 0.4043 - val_loss: 3.3096 - val_accuracy50: 0.3720 - 8s/epoch - 18ms/step
Epoch 7/50
477/477 - 8s - loss: 3.2163 - accuracy50: 0.4096 - val_loss: 3.3116 - val_accuracy50: 0.3743 - 8s/epoch - 17ms/step
Epoch 8/50
477/477 - 8s - loss: 3.2070 - accuracy50: 0.4148 - val_loss: 3.3029 - val_accuracy50: 0.3766 - 8s/epoch - 17ms/step
Epoch 9/50
477/477 - 8s - loss: 3.1997 - accuracy50: 0.4188 - val_loss: 3.3032 - val_accuracy50: 0.3768 - 8s/epoch - 17ms/step
Epoch 10/50
477/477 - 8s - loss: 3.1936 - accuracy50: 0.4192 - val_loss: 3.3143 - val_accuracy50: 0.3680 - 8s/epoch - 17ms/step
Epoch 11/50
477/477 - 8s - loss: 3.1944 - accuracy50: 0.4189 - val_loss: 3.3056 - val_accuracy50: 0.3741 - 8s/epoch - 17ms/step
Epoch 12/50
477/477 - 8s - loss: 3.1908 - accuracy50: 0.4218 - val_loss: 3.3245 - val_accuracy50: 0.3596 - 8s/epoch - 17ms/step
Epoch 13/50
477/477 - 8s - loss: 3.1839 - accuracy50: 0.4251 - val_loss: 3.3043 - val_accuracy50: 0.3686 - 8s/epoch - 17ms/step
Epoch 14/50
477/477 - 8s - loss: 3.1806 - accuracy50: 0.4250 - val_loss: 3.3086 - val_accuracy50: 0.3651 - 8s/epoch - 17ms/step
Epoch 15/50
477/477 - 8s - loss: 3.1783 - accuracy50: 0.4266 - val_loss: 3.3012 - val_accuracy50: 0.3784 - 8s/epoch - 18ms/step
Epoch 16/50
477/477 - 8s - loss: 3.1744 - accuracy50: 0.4288 - val_loss: 3.3045 - val_accuracy50: 0.3774 - 8s/epoch - 18ms/step
Epoch 17/50
477/477 - 8s - loss: 3.1684 - accuracy50: 0.4293 - val_loss: 3.3213 - val_accuracy50: 0.3730 - 8s/epoch - 17ms/step
Epoch 18/50
477/477 - 8s - loss: 3.1654 - accuracy50: 0.4320 - val_loss: 3.3048 - val_accuracy50: 0.3764 - 8s/epoch - 17ms/step
Epoch 19/50
477/477 - 8s - loss: 3.1625 - accuracy50: 0.4336 - val_loss: 3.3230 - val_accuracy50: 0.3683 - 8s/epoch - 17ms/step
Epoch 20/50
477/477 - 8s - loss: 3.1608 - accuracy50: 0.4344 - val_loss: 3.3321 - val_accuracy50: 0.3713 - 8s/epoch - 17ms/step
Epoch 21/50
477/477 - 8s - loss: 3.1577 - accuracy50: 0.4353 - val_loss: 3.3451 - val_accuracy50: 0.3644 - 8s/epoch - 17ms/step
Epoch 22/50
477/477 - 8s - loss: 3.1562 - accuracy50: 0.4364 - val_loss: 3.3343 - val_accuracy50: 0.3667 - 8s/epoch - 17ms/step
Epoch 23/50
477/477 - 8s - loss: 3.1548 - accuracy50: 0.4366 - val_loss: 3.3542 - val_accuracy50: 0.3566 - 8s/epoch - 17ms/step
Epoch 24/50
477/477 - 8s - loss: 3.1516 - accuracy50: 0.4368 - val_loss: 3.3315 - val_accuracy50: 0.3637 - 8s/epoch - 17ms/step
Epoch 25/50
477/477 - 8s - loss: 3.1503 - accuracy50: 0.4384 - val_loss: 3.3227 - val_accuracy50: 0.3684 - 8s/epoch - 17ms/step
testing model: results/PCAR/W9/deepLOB_L1/h50
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1564052
{'0': {'precision': 0.41820873427091043, 'recall': 0.00889974009608569, 'f1-score': 0.017428589055463014, 'support': 63485}, '1': {'precision': 0.24417732073374096, 'recall': 0.8942439818820296, 'f1-score': 0.3836085974085516, 'support': 39298}, '2': {'precision': 0.4060609839745588, 'recall': 0.11126868859461768, 'f1-score': 0.17467342614200262, 'support': 58525}, 'accuracy': 0.261729114489052, 'macro avg': {'precision': 0.35614901299307006, 'recall': 0.338137470190911, 'f1-score': 0.19190353753533906, 'support': 161308}, 'weighted avg': {'precision': 0.3714036559407739, 'recall': 0.261729114489052, 'f1-score': 0.1636885145318771, 'support': 161308}}
[[  565 57230  5690]
 [  321 35142  3835]
 [  465 51548  6512]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1088362
{'0': {'precision': 0.3869983041266252, 'recall': 0.25360565049886397, 'f1-score': 0.3064138332313844, 'support': 40492}, '1': {'precision': 0.34390109812655945, 'recall': 0.6056002383080131, 'f1-score': 0.43868624295334596, 'support': 40284}, '2': {'precision': 0.3992721920104674, 'recall': 0.2372737212975337, 'f1-score': 0.2976589648235079, 'support': 41155}, 'accuracy': 0.36438641526765136, 'macro avg': {'precision': 0.3767238647545507, 'recall': 0.3654932033681369, 'f1-score': 0.3475863470027461, 'support': 121931}, 'weighted avg': {'precision': 0.3769024631128787, 'recall': 0.36438641526765136, 'f1-score': 0.3471594610365639, 'support': 121931}}
[[10269 22853  7370]
 [ 8566 24396  7322]
 [ 7700 23690  9765]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0997097
{'0': {'precision': 0.3964136282127914, 'recall': 0.21931216931216932, 'f1-score': 0.28239301681924633, 'support': 15120}, '1': {'precision': 0.3879635449402891, 'recall': 0.5815911901537012, 'f1-score': 0.4654428918161038, 'support': 16981}, '2': {'precision': 0.3465604412440631, 'recall': 0.3062136185190199, 'f1-score': 0.3251401466149202, 'support': 14774}, 'accuracy': 0.37794133333333335, 'macro avg': {'precision': 0.3769792047990479, 'recall': 0.36903899266163015, 'f1-score': 0.3576586850834234, 'support': 46875}, 'weighted avg': {'precision': 0.3776398287818292, 'recall': 0.37794133333333335, 'f1-score': 0.36217789197493533, 'support': 46875}}
[[3316 7833 3971]
 [2546 9876 4559]
 [2503 7747 4524]]
training model: results/PCAR/W9/deepLOB_L1/h100
Epoch 1/50
477/477 - 10s - loss: 3.3343 - accuracy100: 0.3551 - val_loss: 3.3684 - val_accuracy100: 0.3390 - 10s/epoch - 21ms/step
Epoch 2/50
477/477 - 8s - loss: 3.2928 - accuracy100: 0.3651 - val_loss: 3.3222 - val_accuracy100: 0.3464 - 8s/epoch - 18ms/step
Epoch 3/50
477/477 - 9s - loss: 3.2783 - accuracy100: 0.3742 - val_loss: 3.3185 - val_accuracy100: 0.3490 - 9s/epoch - 18ms/step
Epoch 4/50
477/477 - 8s - loss: 3.2677 - accuracy100: 0.3784 - val_loss: 3.3372 - val_accuracy100: 0.3443 - 8s/epoch - 18ms/step
Epoch 5/50
477/477 - 8s - loss: 3.2598 - accuracy100: 0.3847 - val_loss: 3.3289 - val_accuracy100: 0.3472 - 8s/epoch - 18ms/step
Epoch 6/50
477/477 - 8s - loss: 3.2517 - accuracy100: 0.3889 - val_loss: 3.3350 - val_accuracy100: 0.3500 - 8s/epoch - 18ms/step
Epoch 7/50
477/477 - 9s - loss: 3.2477 - accuracy100: 0.3920 - val_loss: 3.3315 - val_accuracy100: 0.3469 - 9s/epoch - 19ms/step
Epoch 8/50
477/477 - 8s - loss: 3.2416 - accuracy100: 0.3967 - val_loss: 3.3375 - val_accuracy100: 0.3465 - 8s/epoch - 18ms/step
Epoch 9/50
477/477 - 8s - loss: 3.2336 - accuracy100: 0.3999 - val_loss: 3.3467 - val_accuracy100: 0.3391 - 8s/epoch - 18ms/step
Epoch 10/50
477/477 - 8s - loss: 3.2297 - accuracy100: 0.4016 - val_loss: 3.3439 - val_accuracy100: 0.3448 - 8s/epoch - 18ms/step
Epoch 11/50
477/477 - 9s - loss: 3.2262 - accuracy100: 0.4048 - val_loss: 3.3522 - val_accuracy100: 0.3478 - 9s/epoch - 19ms/step
Epoch 12/50
477/477 - 9s - loss: 3.2238 - accuracy100: 0.4037 - val_loss: 3.3567 - val_accuracy100: 0.3469 - 9s/epoch - 18ms/step
Epoch 13/50
477/477 - 8s - loss: 3.2212 - accuracy100: 0.4050 - val_loss: 3.3693 - val_accuracy100: 0.3375 - 8s/epoch - 18ms/step
testing model: results/PCAR/W9/deepLOB_L1/h100
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1272008
{'0': {'precision': 0.3824554416011152, 'recall': 0.12823851495726496, 'f1-score': 0.19207400925115642, 'support': 59904}, '1': {'precision': 0.2931045773033855, 'recall': 0.48059784826164453, 'f1-score': 0.36413335285790993, 'support': 46567}, '2': {'precision': 0.3397104845298842, 'recall': 0.4018454692999252, 'f1-score': 0.36817483125041767, 'support': 54837}, 'accuracy': 0.32297220224663375, 'macro avg': {'precision': 0.33842350114479497, 'recall': 0.3368939441729449, 'f1-score': 0.3081273977864947, 'support': 161308}, 'weighted avg': {'precision': 0.3421300584293725, 'recall': 0.32297220224663375, 'f1-score': 0.30161059906510973, 'support': 161308}}
[[ 7682 27967 24255]
 [ 5611 22380 18576]
 [ 6793 26008 22036]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.104144
{'0': {'precision': 0.3664974965087367, 'recall': 0.2671300893743793, 'f1-score': 0.30902224328321776, 'support': 40280}, '1': {'precision': 0.3429385745747969, 'recall': 0.45993844320889593, 'f1-score': 0.39291356113696846, 'support': 40288}, '2': {'precision': 0.36562962194141, 'recall': 0.3406667794889152, 'f1-score': 0.3527070661560412, 'support': 41363}, 'accuracy': 0.35578318885271176, 'macro avg': {'precision': 0.3583552310083145, 'recall': 0.3559117706907302, 'f1-score': 0.35154762352540914, 'support': 121931}, 'weighted avg': {'precision': 0.35841883117668083, 'recall': 0.35578318885271176, 'f1-score': 0.3515606358345829, 'support': 121931}}
[[10760 17528 11992]
 [ 9302 18530 12456]
 [ 9297 17975 14091]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1058576
{'0': {'precision': 0.3625819813600276, 'recall': 0.33362978020581885, 'f1-score': 0.34750388725311804, 'support': 15742}, '1': {'precision': 0.3379510860270224, 'recall': 0.37374692642330243, 'f1-score': 0.35494880546075086, 'support': 15861}, '2': {'precision': 0.3524143039935349, 'recall': 0.3426532215819801, 'f1-score': 0.34746522359815407, 'support': 15272}, 'accuracy': 0.350144, 'macro avg': {'precision': 0.35098245712686166, 'recall': 0.35000997607036705, 'f1-score': 0.3499726387706743, 'support': 46875}, 'weighted avg': {'precision': 0.3509350181681797, 'recall': 0.350144, 'f1-score': 0.350010412615308, 'support': 46875}}
[[5252 5801 4689]
 [5006 5928 4927]
 [4227 5812 5233]]
training model: results/PCAR/W9/deepLOB_L1/h200
Epoch 1/50
477/477 - 10s - loss: 3.3336 - accuracy200: 0.3569 - val_loss: 3.3959 - val_accuracy200: 0.3365 - 10s/epoch - 22ms/step
Epoch 2/50
477/477 - 8s - loss: 3.2947 - accuracy200: 0.3648 - val_loss: 3.4883 - val_accuracy200: 0.3149 - 8s/epoch - 17ms/step
Epoch 3/50
477/477 - 8s - loss: 3.2902 - accuracy200: 0.3672 - val_loss: 3.4063 - val_accuracy200: 0.3424 - 8s/epoch - 18ms/step
Epoch 4/50
477/477 - 8s - loss: 3.2774 - accuracy200: 0.3750 - val_loss: 3.4280 - val_accuracy200: 0.3109 - 8s/epoch - 17ms/step
Epoch 5/50
477/477 - 8s - loss: 3.2661 - accuracy200: 0.3851 - val_loss: 3.4122 - val_accuracy200: 0.3322 - 8s/epoch - 18ms/step
Epoch 6/50
477/477 - 8s - loss: 3.2585 - accuracy200: 0.3915 - val_loss: 3.4564 - val_accuracy200: 0.3203 - 8s/epoch - 17ms/step
Epoch 7/50
477/477 - 8s - loss: 3.2473 - accuracy200: 0.3987 - val_loss: 3.4407 - val_accuracy200: 0.3176 - 8s/epoch - 17ms/step
Epoch 8/50
477/477 - 8s - loss: 3.2383 - accuracy200: 0.4018 - val_loss: 3.4048 - val_accuracy200: 0.3449 - 8s/epoch - 18ms/step
Epoch 9/50
477/477 - 8s - loss: 3.2347 - accuracy200: 0.4035 - val_loss: 3.4329 - val_accuracy200: 0.3311 - 8s/epoch - 17ms/step
Epoch 10/50
477/477 - 8s - loss: 3.2234 - accuracy200: 0.4099 - val_loss: 3.4589 - val_accuracy200: 0.3214 - 8s/epoch - 17ms/step
Epoch 11/50
477/477 - 8s - loss: 3.2179 - accuracy200: 0.4137 - val_loss: 3.4693 - val_accuracy200: 0.3120 - 8s/epoch - 17ms/step
testing model: results/PCAR/W9/deepLOB_L1/h200
Evaluating performance on  test set...
631/631 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1502218
{'0': {'precision': 0.4087745839636914, 'recall': 0.08390522622115952, 'f1-score': 0.1392317007188313, 'support': 64406}, '1': {'precision': 0.23722065927066194, 'recall': 0.23047962867457453, 'f1-score': 0.23380156425750087, 'support': 38780}, '2': {'precision': 0.35827370709174894, 'recall': 0.6805856646364543, 'f1-score': 0.46943013789666055, 'support': 58122}, 'accuracy': 0.33413717856522923, 'macro avg': {'precision': 0.3347563167753674, 'recall': 0.33165683984406275, 'f1-score': 0.2808211342909976, 'support': 161308}, 'weighted avg': {'precision': 0.3493350449132616, 'recall': 0.33413717856522923, 'f1-score': 0.2809432889455739, 'support': 161308}}
[[ 5404 14908 44094]
 [ 3083  8938 26759]
 [ 4733 13832 39557]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1296773
{'0': {'precision': 0.3404428524910453, 'recall': 0.2602947766767913, 'f1-score': 0.2950222924544274, 'support': 40166}, '1': {'precision': 0.33693397372404643, 'recall': 0.44854953475643133, 'f1-score': 0.3848115855415515, 'support': 40194}, '2': {'precision': 0.3400509121764955, 'recall': 0.3084842799066657, 'f1-score': 0.32349936304125726, 'support': 41571}, 'accuracy': 0.3387817700174689, 'macro avg': {'precision': 0.33914257946386234, 'recall': 0.3391095304466294, 'f1-score': 0.33444441367907873, 'support': 121931}, 'weighted avg': {'precision': 0.33915253892044467, 'recall': 0.3387817700174689, 'f1-score': 0.3343298610605158, 'support': 121931}}
[[10455 17315 12396]
 [ 9673 18029 12492]
 [10582 18165 12824]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1327164
{'0': {'precision': 0.36053437712729747, 'recall': 0.2720035950439751, 'f1-score': 0.3100735482454536, 'support': 15577}, '1': {'precision': 0.3455431535922025, 'recall': 0.4027608111409724, 'f1-score': 0.37196446199407707, 'support': 16372}, '2': {'precision': 0.307356608478803, 'recall': 0.33029612756264237, 'f1-score': 0.3184137441064393, 'support': 14926}, 'accuracy': 0.3362346666666667, 'macro avg': {'precision': 0.3378113797327676, 'recall': 0.3350201779158633, 'f1-score': 0.33348391811532335, 'support': 46875}, 'weighted avg': {'precision': 0.33836546648059873, 'recall': 0.3362346666666667, 'f1-score': 0.33434584271614237, 'support': 46875}}
[[4237 6246 5094]
 [3762 6594 6016]
 [3753 6243 4930]]
training model: results/PCAR/W9/deepLOB_L1/h300
Epoch 1/50
477/477 - 11s - loss: 3.3380 - accuracy300: 0.3581 - val_loss: 3.4227 - val_accuracy300: 0.3259 - 11s/epoch - 23ms/step
Epoch 2/50
477/477 - 8s - loss: 3.3006 - accuracy300: 0.3626 - val_loss: 3.3852 - val_accuracy300: 0.3319 - 8s/epoch - 18ms/step
Epoch 3/50
477/477 - 8s - loss: 3.2787 - accuracy300: 0.3761 - val_loss: 3.3549 - val_accuracy300: 0.3479 - 8s/epoch - 17ms/step
Epoch 4/50
477/477 - 8s - loss: 3.2673 - accuracy300: 0.3842 - val_loss: 3.3858 - val_accuracy300: 0.3378 - 8s/epoch - 17ms/step
Epoch 5/50
477/477 - 8s - loss: 3.2501 - accuracy300: 0.3984 - val_loss: 3.3958 - val_accuracy300: 0.3403 - 8s/epoch - 17ms/step
Epoch 6/50
477/477 - 8s - loss: 3.2346 - accuracy300: 0.4095 - val_loss: 3.3929 - val_accuracy300: 0.3408 - 8s/epoch - 17ms/step
Epoch 7/50
477/477 - 8s - loss: 3.2244 - accuracy300: 0.4167 - val_loss: 3.4110 - val_accuracy300: 0.3442 - 8s/epoch - 18ms/step
Epoch 8/50
477/477 - 8s - loss: 3.2156 - accuracy300: 0.4205 - val_loss: 3.4382 - val_accuracy300: 0.3332 - 8s/epoch - 17ms/step
Epoch 9/50
477/477 - 8s - loss: 3.2081 - accuracy300: 0.4242 - val_loss: 3.4322 - val_accuracy300: 0.3394 - 8s/epoch - 18ms/step
Epoch 10/50
477/477 - 9s - loss: 3.2015 - accuracy300: 0.4287 - val_loss: 3.4280 - val_accuracy300: 0.3419 - 9s/epoch - 18ms/step
Epoch 11/50
477/477 - 8s - loss: 3.1976 - accuracy300: 0.4293 - val_loss: 3.4191 - val_accuracy300: 0.3456 - 8s/epoch - 17ms/step
Epoch 12/50
477/477 - 8s - loss: 3.1932 - accuracy300: 0.4307 - val_loss: 3.4045 - val_accuracy300: 0.3421 - 8s/epoch - 17ms/step
Epoch 13/50
477/477 - 8s - loss: 3.1885 - accuracy300: 0.4316 - val_loss: 3.3847 - val_accuracy300: 0.3416 - 8s/epoch - 17ms/step
testing model: results/PCAR/W9/deepLOB_L1/h300
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1290934
{'0': {'precision': 0.396842678279804, 'recall': 0.024420474340077717, 'f1-score': 0.04600965634762852, 'support': 59704}, '1': {'precision': 0.296250373468778, 'recall': 0.8286741047177302, 'f1-score': 0.43646487878421064, 'support': 47862}, '2': {'precision': 0.32242990654205606, 'recall': 0.14251423467678911, 'f1-score': 0.19766181480334466, 'support': 53742}, 'accuracy': 0.302396657326357, 'macro avg': {'precision': 0.33850765276354605, 'recall': 0.33186960457819903, 'f1-score': 0.22671211664506127, 'support': 161308}, 'weighted avg': {'precision': 0.34220409822428677, 'recall': 0.302396657326357, 'f1-score': 0.21238738191602435, 'support': 161308}}
[[ 1458 49346  8900]
 [ 1005 39662  7195]
 [ 1211 44872  7659]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1172241
{'0': {'precision': 0.3399151436031332, 'recall': 0.052271016311166874, 'f1-score': 0.0906085519161338, 'support': 39850}, '1': {'precision': 0.33411133154393746, 'recall': 0.7814252394422113, 'f1-score': 0.4680851063829788, 'support': 40302}, '2': {'precision': 0.35499443000371333, 'recall': 0.18305847435314393, 'f1-score': 0.24155520111176035, 'support': 41779}, 'accuracy': 0.33809285579549087, 'macro avg': {'precision': 0.3430069683835946, 'recall': 0.3389182433688407, 'f1-score': 0.26674961980362427, 'support': 121931}, 'weighted avg': {'precision': 0.3431636388415888, 'recall': 0.33809285579549087, 'f1-score': 0.2670973870349048, 'support': 121931}}
[[ 2083 30760  7007]
 [ 1920 31493  6889]
 [ 2125 32006  7648]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1165216
{'0': {'precision': 0.32672764227642276, 'recall': 0.041462470982718595, 'f1-score': 0.07358663309681848, 'support': 15508}, '1': {'precision': 0.3576015137885039, 'recall': 0.6973986690865094, 'f1-score': 0.47277872331699716, 'support': 16530}, '2': {'precision': 0.31886345698500396, 'recall': 0.27229224236705535, 'f1-score': 0.2937434107681681, 'support': 14837}, 'accuracy': 0.3458346666666667, 'macro avg': {'precision': 0.3343975376833102, 'recall': 0.3370511274787611, 'f1-score': 0.28003625572732793, 'support': 46875}, 'weighted avg': {'precision': 0.3351258114268424, 'recall': 0.3458346666666667, 'f1-score': 0.28404234214533836, 'support': 46875}}
[[  643 10601  4264]
 [  636 11528  4366]
 [  689 10108  4040]]
training model: results/PCAR/W9/deepLOB_L1/h500
Epoch 1/50
477/477 - 11s - loss: 3.3276 - accuracy500: 0.3595 - val_loss: 3.4257 - val_accuracy500: 0.3386 - 11s/epoch - 23ms/step
Epoch 2/50
477/477 - 8s - loss: 3.3002 - accuracy500: 0.3667 - val_loss: 3.4513 - val_accuracy500: 0.3372 - 8s/epoch - 18ms/step
Epoch 3/50
477/477 - 9s - loss: 3.2766 - accuracy500: 0.3782 - val_loss: 3.3971 - val_accuracy500: 0.3411 - 9s/epoch - 18ms/step
Epoch 4/50
477/477 - 8s - loss: 3.2590 - accuracy500: 0.3946 - val_loss: 3.4175 - val_accuracy500: 0.3454 - 8s/epoch - 17ms/step
Epoch 5/50
477/477 - 8s - loss: 3.2499 - accuracy500: 0.3989 - val_loss: 3.4168 - val_accuracy500: 0.3454 - 8s/epoch - 17ms/step
Epoch 6/50
477/477 - 9s - loss: 3.2366 - accuracy500: 0.4091 - val_loss: 3.4684 - val_accuracy500: 0.3404 - 9s/epoch - 18ms/step
Epoch 7/50
477/477 - 8s - loss: 3.2205 - accuracy500: 0.4175 - val_loss: 3.4672 - val_accuracy500: 0.3340 - 8s/epoch - 18ms/step
Epoch 8/50
477/477 - 8s - loss: 3.2101 - accuracy500: 0.4239 - val_loss: 3.4952 - val_accuracy500: 0.3353 - 8s/epoch - 17ms/step
Epoch 9/50
477/477 - 8s - loss: 3.2032 - accuracy500: 0.4272 - val_loss: 3.4990 - val_accuracy500: 0.3416 - 8s/epoch - 17ms/step
Epoch 10/50
477/477 - 8s - loss: 3.1914 - accuracy500: 0.4330 - val_loss: 3.5725 - val_accuracy500: 0.3264 - 8s/epoch - 18ms/step
Epoch 11/50
477/477 - 8s - loss: 3.1849 - accuracy500: 0.4335 - val_loss: 3.4924 - val_accuracy500: 0.3313 - 8s/epoch - 17ms/step
Epoch 12/50
477/477 - 8s - loss: 3.1776 - accuracy500: 0.4396 - val_loss: 3.5338 - val_accuracy500: 0.3226 - 8s/epoch - 17ms/step
Epoch 13/50
477/477 - 8s - loss: 3.1688 - accuracy500: 0.4423 - val_loss: 3.5822 - val_accuracy500: 0.3216 - 8s/epoch - 17ms/step
testing model: results/PCAR/W9/deepLOB_L1/h500
Evaluating performance on  test set...
631/631 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1510806
{'0': {'precision': 0.32608695652173914, 'recall': 0.0002478232854759033, 'f1-score': 0.0004952701698776683, 'support': 60527}, '1': {'precision': 0.3061869795875347, 'recall': 0.893497918759868, 'f1-score': 0.4560821418852442, 'support': 48769}, '2': {'precision': 0.3016836438486304, 'recall': 0.10989771591171268, 'f1-score': 0.16110711819501403, 'support': 52012}, 'accuracy': 0.30566369925856124, 'macro avg': {'precision': 0.3113191933193014, 'recall': 0.33454781931901884, 'f1-score': 0.20589484341671196, 'support': 161308}, 'weighted avg': {'precision': 0.31220192246355266, 'recall': 0.30566369925856124, 'f1-score': 0.1900225074189298, 'support': 161308}}
[[   15 52458  8054]
 [   17 43575  5177]
 [   14 46282  5716]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1277242
{'0': {'precision': 0.32619696379914365, 'recall': 0.021091842641765876, 'f1-score': 0.039621749408983456, 'support': 39731}, '1': {'precision': 0.3378311558451548, 'recall': 0.7638319544856028, 'f1-score': 0.46846668393545526, 'support': 40251}, '2': {'precision': 0.3629342267677658, 'recall': 0.24532170015971774, 'f1-score': 0.29275716886663633, 'support': 41949}, 'accuracy': 0.34342373965603495, 'macro avg': {'precision': 0.3423207821373548, 'recall': 0.34341516576236214, 'f1-score': 0.26694853407035835, 'support': 121931}, 'weighted avg': {'precision': 0.34267660645207626, 'recall': 0.34342373965603495, 'f1-score': 0.2682774249177064, 'support': 121931}}
[[  838 29524  9369]
 [  811 30745  8695]
 [  920 30738 10291]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1309441
{'0': {'precision': 0.34485049833887044, 'recall': 0.032927293490673776, 'f1-score': 0.06011466960097296, 'support': 15762}, '1': {'precision': 0.3526162225248006, 'recall': 0.5668188355950222, 'f1-score': 0.4347659247889486, 'support': 15991}, '2': {'precision': 0.32804474955504703, 'recall': 0.42659701097738395, 'f1-score': 0.370885675683445, 'support': 15122}, 'accuracy': 0.3420586666666667, 'macro avg': {'precision': 0.34183715680623933, 'recall': 0.3421143800210267, 'f1-score': 0.2885887566911222, 'support': 46875}, 'weighted avg': {'precision': 0.34207812846896607, 'recall': 0.3420586666666667, 'f1-score': 0.2881792536156943, 'support': 46875}}
[[ 519 8518 6725]
 [ 438 9064 6489]
 [ 548 8123 6451]]
training model: results/PCAR/W9/deepLOB_L1/h1000
Epoch 1/50
477/477 - 11s - loss: 3.3194 - accuracy1000: 0.3703 - val_loss: 3.4934 - val_accuracy1000: 0.3291 - 11s/epoch - 22ms/step
Epoch 2/50
477/477 - 8s - loss: 3.2714 - accuracy1000: 0.3972 - val_loss: 3.6506 - val_accuracy1000: 0.3246 - 8s/epoch - 18ms/step
Epoch 3/50
477/477 - 8s - loss: 3.2405 - accuracy1000: 0.4105 - val_loss: 3.6572 - val_accuracy1000: 0.3214 - 8s/epoch - 17ms/step
Epoch 4/50
477/477 - 8s - loss: 3.2139 - accuracy1000: 0.4173 - val_loss: 3.6441 - val_accuracy1000: 0.3198 - 8s/epoch - 17ms/step
Epoch 5/50
477/477 - 8s - loss: 3.1860 - accuracy1000: 0.4339 - val_loss: 3.6917 - val_accuracy1000: 0.3188 - 8s/epoch - 17ms/step
Epoch 6/50
477/477 - 8s - loss: 3.1702 - accuracy1000: 0.4443 - val_loss: 3.6693 - val_accuracy1000: 0.3106 - 8s/epoch - 17ms/step
Epoch 7/50
477/477 - 8s - loss: 3.1480 - accuracy1000: 0.4556 - val_loss: 3.7728 - val_accuracy1000: 0.3147 - 8s/epoch - 17ms/step
Epoch 8/50
477/477 - 8s - loss: 3.1306 - accuracy1000: 0.4629 - val_loss: 3.6638 - val_accuracy1000: 0.3149 - 8s/epoch - 17ms/step
Epoch 9/50
477/477 - 8s - loss: 3.1177 - accuracy1000: 0.4647 - val_loss: 3.6728 - val_accuracy1000: 0.3178 - 8s/epoch - 17ms/step
Epoch 10/50
477/477 - 8s - loss: 3.1001 - accuracy1000: 0.4709 - val_loss: 3.6042 - val_accuracy1000: 0.3168 - 8s/epoch - 17ms/step
Epoch 11/50
477/477 - 9s - loss: 3.0862 - accuracy1000: 0.4782 - val_loss: 3.5815 - val_accuracy1000: 0.3159 - 9s/epoch - 18ms/step
testing model: results/PCAR/W9/deepLOB_L1/h1000
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2086277
{'0': {'precision': 0.3649060436769934, 'recall': 0.023469654406480696, 'f1-score': 0.044102752969339847, 'support': 61228}, '1': {'precision': 0.3223800195886386, 'recall': 0.13590849970064206, 'f1-score': 0.1912078655764846, 'support': 48437}, '2': {'precision': 0.3195910916392844, 'recall': 0.8475107952675096, 'f1-score': 0.4641529643199907, 'support': 51643}, 'accuracy': 0.32105041287474895, 'macro avg': {'precision': 0.33562571830163884, 'recall': 0.3356296497915441, 'f1-score': 0.23315452762193836, 'support': 161308}, 'weighted avg': {'precision': 0.33762882805934863, 'recall': 0.32105041287474895, 'f1-score': 0.22275466982488284, 'support': 161308}}
[[ 1437  7226 52565]
 [ 1237  6583 40617]
 [ 1264  6611 43768]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1502037
{'0': {'precision': 0.3279394101161084, 'recall': 0.2465076618262985, 'f1-score': 0.281451786097788, 'support': 39873}, '1': {'precision': 0.35429167753717716, 'recall': 0.2724309142885802, 'f1-score': 0.30801508321283777, 'support': 39878}, '2': {'precision': 0.3585284280936455, 'recall': 0.5210052157420578, 'f1-score': 0.42475960376902633, 'support': 42180}, 'accuracy': 0.34994382068546964, 'macro avg': {'precision': 0.3469198385823103, 'recall': 0.34664793061897886, 'f1-score': 0.3380754910265507, 'support': 121931}, 'weighted avg': {'precision': 0.34713978162548575, 'recall': 0.34994382068546964, 'f1-score': 0.3397143683100784, 'support': 121931}}
[[ 9829  9731 20313]
 [10008 10864 19006]
 [10135 10069 21976]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1609107
{'0': {'precision': 0.32481881905667104, 'recall': 0.1774978900214244, 'f1-score': 0.22955499580184718, 'support': 15403}, '1': {'precision': 0.34360620652755486, 'recall': 0.19931719428926134, 'f1-score': 0.2522883519937144, 'support': 16110}, '2': {'precision': 0.31728093978634975, 'recall': 0.6012888946751725, 'f1-score': 0.41537942664418215, 'support': 15362}, 'accuracy': 0.32388266666666665, 'macro avg': {'precision': 0.32856865512352523, 'recall': 0.3260346596619528, 'f1-score': 0.29907425814658123, 'support': 46875}, 'weighted avg': {'precision': 0.32880533448718335, 'recall': 0.32388266666666665, 'f1-score': 0.2982668736653337, 'support': 46875}}
[[ 2734  2954  9715]
 [ 2738  3211 10161]
 [ 2945  3180  9237]]
training model: results/PCAR/W9/deepOF_L1/h10
Epoch 1/50
477/477 - 10s - loss: 3.3120 - accuracy10: 0.3706 - val_loss: 3.2793 - val_accuracy10: 0.3933 - 10s/epoch - 20ms/step
Epoch 2/50
477/477 - 8s - loss: 3.2812 - accuracy10: 0.3871 - val_loss: 3.2656 - val_accuracy10: 0.4037 - 8s/epoch - 16ms/step
Epoch 3/50
477/477 - 8s - loss: 3.2642 - accuracy10: 0.3964 - val_loss: 3.2598 - val_accuracy10: 0.4063 - 8s/epoch - 16ms/step
Epoch 4/50
477/477 - 7s - loss: 3.2520 - accuracy10: 0.4030 - val_loss: 3.2560 - val_accuracy10: 0.4055 - 7s/epoch - 15ms/step
Epoch 5/50
477/477 - 7s - loss: 3.2430 - accuracy10: 0.4048 - val_loss: 3.2529 - val_accuracy10: 0.4080 - 7s/epoch - 16ms/step
Epoch 6/50
477/477 - 8s - loss: 3.2359 - accuracy10: 0.4087 - val_loss: 3.2516 - val_accuracy10: 0.4069 - 8s/epoch - 16ms/step
Epoch 7/50
477/477 - 7s - loss: 3.2289 - accuracy10: 0.4107 - val_loss: 3.2495 - val_accuracy10: 0.4092 - 7s/epoch - 16ms/step
Epoch 8/50
477/477 - 7s - loss: 3.2221 - accuracy10: 0.4126 - val_loss: 3.2479 - val_accuracy10: 0.4091 - 7s/epoch - 15ms/step
Epoch 9/50
477/477 - 8s - loss: 3.2158 - accuracy10: 0.4159 - val_loss: 3.2482 - val_accuracy10: 0.4081 - 8s/epoch - 16ms/step
Epoch 10/50
477/477 - 8s - loss: 3.2101 - accuracy10: 0.4169 - val_loss: 3.2466 - val_accuracy10: 0.4100 - 8s/epoch - 16ms/step
Epoch 11/50
477/477 - 8s - loss: 3.2031 - accuracy10: 0.4195 - val_loss: 3.2482 - val_accuracy10: 0.4118 - 8s/epoch - 17ms/step
Epoch 12/50
477/477 - 8s - loss: 3.1971 - accuracy10: 0.4219 - val_loss: 3.2443 - val_accuracy10: 0.4098 - 8s/epoch - 16ms/step
Epoch 13/50
477/477 - 8s - loss: 3.1936 - accuracy10: 0.4215 - val_loss: 3.2408 - val_accuracy10: 0.4119 - 8s/epoch - 16ms/step
Epoch 14/50
477/477 - 7s - loss: 3.1872 - accuracy10: 0.4229 - val_loss: 3.2393 - val_accuracy10: 0.4097 - 7s/epoch - 15ms/step
Epoch 15/50
477/477 - 7s - loss: 3.1829 - accuracy10: 0.4241 - val_loss: 3.2363 - val_accuracy10: 0.4116 - 7s/epoch - 16ms/step
Epoch 16/50
477/477 - 7s - loss: 3.1784 - accuracy10: 0.4242 - val_loss: 3.2328 - val_accuracy10: 0.4096 - 7s/epoch - 16ms/step
Epoch 17/50
477/477 - 8s - loss: 3.1741 - accuracy10: 0.4282 - val_loss: 3.2345 - val_accuracy10: 0.4120 - 8s/epoch - 16ms/step
Epoch 18/50
477/477 - 8s - loss: 3.1697 - accuracy10: 0.4280 - val_loss: 3.2319 - val_accuracy10: 0.4107 - 8s/epoch - 16ms/step
Epoch 19/50
477/477 - 7s - loss: 3.1653 - accuracy10: 0.4291 - val_loss: 3.2326 - val_accuracy10: 0.4109 - 7s/epoch - 15ms/step
Epoch 20/50
477/477 - 8s - loss: 3.1617 - accuracy10: 0.4303 - val_loss: 3.2301 - val_accuracy10: 0.4127 - 8s/epoch - 16ms/step
Epoch 21/50
477/477 - 8s - loss: 3.1576 - accuracy10: 0.4321 - val_loss: 3.2292 - val_accuracy10: 0.4120 - 8s/epoch - 16ms/step
Epoch 22/50
477/477 - 8s - loss: 3.1561 - accuracy10: 0.4330 - val_loss: 3.2254 - val_accuracy10: 0.4106 - 8s/epoch - 17ms/step
Epoch 23/50
477/477 - 8s - loss: 3.1534 - accuracy10: 0.4340 - val_loss: 3.2330 - val_accuracy10: 0.4111 - 8s/epoch - 17ms/step
Epoch 24/50
477/477 - 8s - loss: 3.1499 - accuracy10: 0.4347 - val_loss: 3.2248 - val_accuracy10: 0.4110 - 8s/epoch - 17ms/step
Epoch 25/50
477/477 - 8s - loss: 3.1467 - accuracy10: 0.4356 - val_loss: 3.2273 - val_accuracy10: 0.4134 - 8s/epoch - 16ms/step
Epoch 26/50
477/477 - 8s - loss: 3.1421 - accuracy10: 0.4382 - val_loss: 3.2281 - val_accuracy10: 0.4107 - 8s/epoch - 16ms/step
Epoch 27/50
477/477 - 7s - loss: 3.1399 - accuracy10: 0.4392 - val_loss: 3.2321 - val_accuracy10: 0.4119 - 7s/epoch - 16ms/step
Epoch 28/50
477/477 - 8s - loss: 3.1343 - accuracy10: 0.4411 - val_loss: 3.2341 - val_accuracy10: 0.4083 - 8s/epoch - 16ms/step
Epoch 29/50
477/477 - 8s - loss: 3.1317 - accuracy10: 0.4432 - val_loss: 3.2369 - val_accuracy10: 0.4095 - 8s/epoch - 16ms/step
Epoch 30/50
477/477 - 8s - loss: 3.1297 - accuracy10: 0.4438 - val_loss: 3.2366 - val_accuracy10: 0.4079 - 8s/epoch - 16ms/step
Epoch 31/50
477/477 - 8s - loss: 3.1267 - accuracy10: 0.4430 - val_loss: 3.2333 - val_accuracy10: 0.4100 - 8s/epoch - 16ms/step
Epoch 32/50
477/477 - 7s - loss: 3.1247 - accuracy10: 0.4450 - val_loss: 3.2315 - val_accuracy10: 0.4077 - 7s/epoch - 15ms/step
Epoch 33/50
477/477 - 8s - loss: 3.1211 - accuracy10: 0.4468 - val_loss: 3.2336 - val_accuracy10: 0.4095 - 8s/epoch - 16ms/step
Epoch 34/50
477/477 - 7s - loss: 3.1182 - accuracy10: 0.4477 - val_loss: 3.2369 - val_accuracy10: 0.4074 - 7s/epoch - 15ms/step
testing model: results/PCAR/W9/deepOF_L1/h10
Evaluating performance on  test set...
631/631 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0856827
{'0': {'precision': 0.44035775464488075, 'recall': 0.4371535556027928, 'f1-score': 0.43874980511861095, 'support': 61157}, '1': {'precision': 0.3042905532555514, 'recall': 0.36416184971098264, 'f1-score': 0.33154495437925025, 'support': 39963}, '2': {'precision': 0.4291589280976386, 'recall': 0.37626279409809915, 'f1-score': 0.4009738822487826, 'support': 60184}, 'accuracy': 0.3963509894360958, 'macro avg': {'precision': 0.39126907866602356, 'recall': 0.3925260664706249, 'f1-score': 0.3904228805822146, 'support': 161304}, 'weighted avg': {'precision': 0.40246877640478135, 'recall': 0.3963509894360958, 'f1-score': 0.3980953043492883, 'support': 161304}}
[[26735 16500 17922]
 [13211 14553 12199]
 [20766 16773 22645]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0575962
{'0': {'precision': 0.41855576945743134, 'recall': 0.5123106515989421, 'f1-score': 0.46071181456495414, 'support': 41590}, '1': {'precision': 0.43590838390923786, 'recall': 0.3669105378000257, 'f1-score': 0.3984444692239072, 'support': 38955}, '2': {'precision': 0.43566272622659274, 'recall': 0.40250326197264774, 'f1-score': 0.4184270678958077, 'support': 41386}, 'accuracy': 0.428586659668173, 'macro avg': {'precision': 0.43004229319775406, 'recall': 0.4272414837905385, 'f1-score': 0.425861117228223, 'support': 121931}, 'weighted avg': {'precision': 0.42990612013788704, 'recall': 0.428586659668173, 'f1-score': 0.4264660447163531, 'support': 121931}}
[[21307  9279 11004]
 [14088 14293 10574]
 [15511  9217 16658]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0730345
{'0': {'precision': 0.39121766193347596, 'recall': 0.515044814340589, 'f1-score': 0.44467167808976343, 'support': 15620}, '1': {'precision': 0.43573913043478263, 'recall': 0.3183204167196036, 'f1-score': 0.36788782027751266, 'support': 15742}, '2': {'precision': 0.416244683005874, 'recall': 0.3974086250241733, 'f1-score': 0.40660862683023347, 'support': 15513}, 'accuracy': 0.410048, 'macro avg': {'precision': 0.4144004917913775, 'recall': 0.410257952028122, 'f1-score': 0.4063893750658365, 'support': 46875}, 'weighted avg': {'precision': 0.4144518194810745, 'recall': 0.410048, 'f1-score': 0.4062886678738799, 'support': 46875}}
[[8045 3349 4226]
 [6311 5011 4420]
 [6208 3140 6165]]
training model: results/PCAR/W9/deepOF_L1/h20
Epoch 1/50
477/477 - 10s - loss: 3.3172 - accuracy20: 0.3640 - val_loss: 3.2892 - val_accuracy20: 0.3719 - 10s/epoch - 20ms/step
Epoch 2/50
477/477 - 7s - loss: 3.2886 - accuracy20: 0.3788 - val_loss: 3.2775 - val_accuracy20: 0.3786 - 7s/epoch - 16ms/step
Epoch 3/50
477/477 - 7s - loss: 3.2728 - accuracy20: 0.3852 - val_loss: 3.2724 - val_accuracy20: 0.3809 - 7s/epoch - 16ms/step
Epoch 4/50
477/477 - 8s - loss: 3.2637 - accuracy20: 0.3905 - val_loss: 3.2690 - val_accuracy20: 0.3829 - 8s/epoch - 16ms/step
Epoch 5/50
477/477 - 8s - loss: 3.2571 - accuracy20: 0.3919 - val_loss: 3.2658 - val_accuracy20: 0.3865 - 8s/epoch - 16ms/step
Epoch 6/50
477/477 - 7s - loss: 3.2517 - accuracy20: 0.3954 - val_loss: 3.2617 - val_accuracy20: 0.3895 - 7s/epoch - 15ms/step
Epoch 7/50
477/477 - 8s - loss: 3.2443 - accuracy20: 0.3985 - val_loss: 3.2579 - val_accuracy20: 0.3904 - 8s/epoch - 16ms/step
Epoch 8/50
477/477 - 8s - loss: 3.2397 - accuracy20: 0.4002 - val_loss: 3.2554 - val_accuracy20: 0.3923 - 8s/epoch - 16ms/step
Epoch 9/50
477/477 - 8s - loss: 3.2326 - accuracy20: 0.4029 - val_loss: 3.2513 - val_accuracy20: 0.3905 - 8s/epoch - 16ms/step
Epoch 10/50
477/477 - 8s - loss: 3.2269 - accuracy20: 0.4038 - val_loss: 3.2419 - val_accuracy20: 0.3951 - 8s/epoch - 16ms/step
Epoch 11/50
477/477 - 8s - loss: 3.2194 - accuracy20: 0.4059 - val_loss: 3.2380 - val_accuracy20: 0.3951 - 8s/epoch - 16ms/step
Epoch 12/50
477/477 - 7s - loss: 3.2144 - accuracy20: 0.4073 - val_loss: 3.2343 - val_accuracy20: 0.3948 - 7s/epoch - 15ms/step
Epoch 13/50
477/477 - 7s - loss: 3.2117 - accuracy20: 0.4076 - val_loss: 3.2328 - val_accuracy20: 0.3963 - 7s/epoch - 15ms/step
Epoch 14/50
477/477 - 7s - loss: 3.2072 - accuracy20: 0.4101 - val_loss: 3.2289 - val_accuracy20: 0.3972 - 7s/epoch - 15ms/step
Epoch 15/50
477/477 - 7s - loss: 3.2036 - accuracy20: 0.4117 - val_loss: 3.2263 - val_accuracy20: 0.3975 - 7s/epoch - 15ms/step
Epoch 16/50
477/477 - 7s - loss: 3.1998 - accuracy20: 0.4137 - val_loss: 3.2262 - val_accuracy20: 0.3968 - 7s/epoch - 15ms/step
Epoch 17/50
477/477 - 7s - loss: 3.1977 - accuracy20: 0.4135 - val_loss: 3.2236 - val_accuracy20: 0.3960 - 7s/epoch - 16ms/step
Epoch 18/50
477/477 - 7s - loss: 3.1934 - accuracy20: 0.4165 - val_loss: 3.2314 - val_accuracy20: 0.3955 - 7s/epoch - 15ms/step
Epoch 19/50
477/477 - 8s - loss: 3.1927 - accuracy20: 0.4160 - val_loss: 3.2289 - val_accuracy20: 0.3955 - 8s/epoch - 16ms/step
Epoch 20/50
477/477 - 7s - loss: 3.1903 - accuracy20: 0.4175 - val_loss: 3.2299 - val_accuracy20: 0.3956 - 7s/epoch - 15ms/step
Epoch 21/50
477/477 - 7s - loss: 3.1864 - accuracy20: 0.4188 - val_loss: 3.2259 - val_accuracy20: 0.3938 - 7s/epoch - 15ms/step
Epoch 22/50
477/477 - 7s - loss: 3.1836 - accuracy20: 0.4206 - val_loss: 3.2274 - val_accuracy20: 0.3964 - 7s/epoch - 15ms/step
Epoch 23/50
477/477 - 7s - loss: 3.1807 - accuracy20: 0.4215 - val_loss: 3.2247 - val_accuracy20: 0.3973 - 7s/epoch - 16ms/step
Epoch 24/50
477/477 - 7s - loss: 3.1789 - accuracy20: 0.4228 - val_loss: 3.2273 - val_accuracy20: 0.3933 - 7s/epoch - 16ms/step
Epoch 25/50
477/477 - 8s - loss: 3.1804 - accuracy20: 0.4223 - val_loss: 3.2312 - val_accuracy20: 0.3943 - 8s/epoch - 16ms/step
Epoch 26/50
477/477 - 7s - loss: 3.1741 - accuracy20: 0.4237 - val_loss: 3.2311 - val_accuracy20: 0.3931 - 7s/epoch - 16ms/step
Epoch 27/50
477/477 - 8s - loss: 3.1709 - accuracy20: 0.4259 - val_loss: 3.2296 - val_accuracy20: 0.3947 - 8s/epoch - 16ms/step
testing model: results/PCAR/W9/deepOF_L1/h20
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.089941
{'0': {'precision': 0.42941998041450613, 'recall': 0.4475771367378355, 'f1-score': 0.43831059768137315, 'support': 59764}, '1': {'precision': 0.28904877436626786, 'recall': 0.23822657381231468, 'f1-score': 0.2611883882673117, 'support': 43509}, '2': {'precision': 0.40909522753903155, 'recall': 0.4452103186228051, 'f1-score': 0.4263894046292858, 'support': 58031}, 'accuracy': 0.39025690621435305, 'macro avg': {'precision': 0.3758546607732685, 'recall': 0.3770046763909851, 'f1-score': 0.3752961301926569, 'support': 161304}, 'weighted avg': {'precision': 0.3842451767018303, 'recall': 0.39025690621435305, 'f1-score': 0.38624611717622714, 'support': 161304}}
[[26749 12722 20293]
 [16119 10365 17025]
 [19423 12772 25836]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0680257
{'0': {'precision': 0.40572029845035396, 'recall': 0.523953057442866, 'f1-score': 0.4573184538250041, 'support': 40475}, '1': {'precision': 0.4240130661673904, 'recall': 0.2605375238654722, 'f1-score': 0.32275573479691316, 'support': 40854}, '2': {'precision': 0.41321423762287357, 'recall': 0.4534751982660953, 'f1-score': 0.4324095819633631, 'support': 40602}, 'accuracy': 0.4122249468961954, 'macro avg': {'precision': 0.41431586741353926, 'recall': 0.4126552598581445, 'f1-score': 0.4041612568617601, 'support': 121931}, 'weighted avg': {'precision': 0.41434486193785464, 'recall': 0.4122249468961954, 'f1-score': 0.4039376455112859, 'support': 121931}}
[[21207  7140 12128]
 [16192 10644 14018]
 [14871  7319 18412]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0745994
{'0': {'precision': 0.3852677489701963, 'recall': 0.5232328550743715, 'f1-score': 0.4437745959976555, 'support': 15194}, '1': {'precision': 0.4310420797532496, 'recall': 0.23463452659351203, 'f1-score': 0.3038633275092215, 'support': 16677}, '2': {'precision': 0.39377694907353455, 'recall': 0.45041322314049587, 'f1-score': 0.42019523720698876, 'support': 15004}, 'accuracy': 0.397248, 'macro avg': {'precision': 0.4033622592656601, 'recall': 0.40276020160279313, 'f1-score': 0.3892777202379553, 'support': 46875}, 'weighted avg': {'precision': 0.404276827430345, 'recall': 0.397248, 'f1-score': 0.3864501176216176, 'support': 46875}}
[[7950 2610 4634]
 [6994 3913 5770]
 [5691 2555 6758]]
training model: results/PCAR/W9/deepOF_L1/h30
Epoch 1/50
477/477 - 9s - loss: 3.3152 - accuracy30: 0.3633 - val_loss: 3.2889 - val_accuracy30: 0.3716 - 9s/epoch - 20ms/step
Epoch 2/50
477/477 - 7s - loss: 3.2845 - accuracy30: 0.3784 - val_loss: 3.2802 - val_accuracy30: 0.3775 - 7s/epoch - 15ms/step
Epoch 3/50
477/477 - 8s - loss: 3.2723 - accuracy30: 0.3853 - val_loss: 3.2741 - val_accuracy30: 0.3765 - 8s/epoch - 16ms/step
Epoch 4/50
477/477 - 8s - loss: 3.2620 - accuracy30: 0.3917 - val_loss: 3.2701 - val_accuracy30: 0.3844 - 8s/epoch - 16ms/step
Epoch 5/50
477/477 - 8s - loss: 3.2546 - accuracy30: 0.3945 - val_loss: 3.2722 - val_accuracy30: 0.3820 - 8s/epoch - 16ms/step
Epoch 6/50
477/477 - 8s - loss: 3.2495 - accuracy30: 0.3956 - val_loss: 3.2686 - val_accuracy30: 0.3881 - 8s/epoch - 16ms/step
Epoch 7/50
477/477 - 8s - loss: 3.2429 - accuracy30: 0.3985 - val_loss: 3.2651 - val_accuracy30: 0.3875 - 8s/epoch - 16ms/step
Epoch 8/50
477/477 - 7s - loss: 3.2372 - accuracy30: 0.3996 - val_loss: 3.2601 - val_accuracy30: 0.3907 - 7s/epoch - 15ms/step
Epoch 9/50
477/477 - 8s - loss: 3.2303 - accuracy30: 0.4032 - val_loss: 3.2509 - val_accuracy30: 0.3932 - 8s/epoch - 16ms/step
Epoch 10/50
477/477 - 7s - loss: 3.2254 - accuracy30: 0.4043 - val_loss: 3.2501 - val_accuracy30: 0.3890 - 7s/epoch - 15ms/step
Epoch 11/50
477/477 - 7s - loss: 3.2214 - accuracy30: 0.4063 - val_loss: 3.2434 - val_accuracy30: 0.3907 - 7s/epoch - 16ms/step
Epoch 12/50
477/477 - 7s - loss: 3.2161 - accuracy30: 0.4066 - val_loss: 3.2405 - val_accuracy30: 0.3912 - 7s/epoch - 15ms/step
Epoch 13/50
477/477 - 7s - loss: 3.2118 - accuracy30: 0.4076 - val_loss: 3.2409 - val_accuracy30: 0.3921 - 7s/epoch - 16ms/step
Epoch 14/50
477/477 - 8s - loss: 3.2077 - accuracy30: 0.4084 - val_loss: 3.2376 - val_accuracy30: 0.3922 - 8s/epoch - 16ms/step
Epoch 15/50
477/477 - 8s - loss: 3.2044 - accuracy30: 0.4104 - val_loss: 3.2375 - val_accuracy30: 0.3925 - 8s/epoch - 16ms/step
Epoch 16/50
477/477 - 7s - loss: 3.2023 - accuracy30: 0.4124 - val_loss: 3.2337 - val_accuracy30: 0.3937 - 7s/epoch - 15ms/step
Epoch 17/50
477/477 - 7s - loss: 3.1993 - accuracy30: 0.4148 - val_loss: 3.2348 - val_accuracy30: 0.3886 - 7s/epoch - 15ms/step
Epoch 18/50
477/477 - 7s - loss: 3.1963 - accuracy30: 0.4143 - val_loss: 3.2365 - val_accuracy30: 0.3942 - 7s/epoch - 15ms/step
Epoch 19/50
477/477 - 8s - loss: 3.1936 - accuracy30: 0.4157 - val_loss: 3.2372 - val_accuracy30: 0.3925 - 8s/epoch - 16ms/step
Epoch 20/50
477/477 - 7s - loss: 3.1917 - accuracy30: 0.4171 - val_loss: 3.2359 - val_accuracy30: 0.3927 - 7s/epoch - 15ms/step
Epoch 21/50
477/477 - 7s - loss: 3.1880 - accuracy30: 0.4188 - val_loss: 3.2368 - val_accuracy30: 0.3920 - 7s/epoch - 16ms/step
Epoch 22/50
477/477 - 8s - loss: 3.1871 - accuracy30: 0.4180 - val_loss: 3.2391 - val_accuracy30: 0.3899 - 8s/epoch - 16ms/step
Epoch 23/50
477/477 - 8s - loss: 3.1842 - accuracy30: 0.4191 - val_loss: 3.2355 - val_accuracy30: 0.3905 - 8s/epoch - 16ms/step
Epoch 24/50
477/477 - 7s - loss: 3.1815 - accuracy30: 0.4207 - val_loss: 3.2366 - val_accuracy30: 0.3899 - 7s/epoch - 15ms/step
Epoch 25/50
477/477 - 8s - loss: 3.1782 - accuracy30: 0.4231 - val_loss: 3.2423 - val_accuracy30: 0.3874 - 8s/epoch - 16ms/step
Epoch 26/50
477/477 - 7s - loss: 3.1778 - accuracy30: 0.4222 - val_loss: 3.2402 - val_accuracy30: 0.3914 - 7s/epoch - 15ms/step
testing model: results/PCAR/W9/deepOF_L1/h30
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0918262
{'0': {'precision': 0.42296495353263913, 'recall': 0.5024189928344611, 'f1-score': 0.4592809866486318, 'support': 60149}, '1': {'precision': 0.28280391865815646, 'recall': 0.17319273685885053, 'f1-score': 0.2148243153725811, 'support': 44003}, '2': {'precision': 0.4056876708844662, 'recall': 0.4465460526315789, 'f1-score': 0.4251374312843579, 'support': 57152}, 'accuracy': 0.39281108961960026, 'macro avg': {'precision': 0.37048551435842053, 'recall': 0.37405259410829683, 'f1-score': 0.3664142444351903, 'support': 161304}, 'weighted avg': {'precision': 0.37860810388544974, 'recall': 0.39281108961960026, 'f1-score': 0.380496831374497, 'support': 161304}}
[[30220  9723 20206]
 [19201  7621 17181]
 [22027  9604 25521]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0689247
{'0': {'precision': 0.3996323851203501, 'recall': 0.559041042217651, 'f1-score': 0.4660834413695246, 'support': 40836}, '1': {'precision': 0.41505905511811025, 'recall': 0.21251291354851715, 'f1-score': 0.28110053827053505, 'support': 39687}, '2': {'precision': 0.41907566425392256, 'recall': 0.45022700927357034, 'f1-score': 0.4340931846229073, 'support': 41408}, 'accuracy': 0.4092970614527889, 'macro avg': {'precision': 0.411255701497461, 'recall': 0.40726032167991283, 'f1-score': 0.3937590547543223, 'support': 121931}, 'weighted avg': {'precision': 0.41125654595364164, 'recall': 0.4092970614527889, 'f1-score': 0.39500989135637354, 'support': 121931}}
[[22829  5752 12255]
 [17665  8434 13588]
 [16631  6134 18643]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0778272
{'0': {'precision': 0.3841485672567987, 'recall': 0.5488265971316819, 'f1-score': 0.45195404767017394, 'support': 15340}, '1': {'precision': 0.41458465440710207, 'recall': 0.19888057431404757, 'f1-score': 0.2688101307458268, 'support': 16437}, '2': {'precision': 0.3938151575494905, 'recall': 0.44535700092727515, 'f1-score': 0.41800323262464256, 'support': 15098}, 'accuracy': 0.3927893333333333, 'macro avg': {'precision': 0.39751612640446377, 'recall': 0.3976880574576682, 'f1-score': 0.3795891370135478, 'support': 46875}, 'weighted avg': {'precision': 0.3979346823443421, 'recall': 0.3927893333333333, 'f1-score': 0.3767982936852582, 'support': 46875}}
[[8419 2265 4656]
 [7474 3269 5694]
 [6023 2351 6724]]
training model: results/PCAR/W9/deepOF_L1/h50
Epoch 1/50
477/477 - 9s - loss: 3.3153 - accuracy50: 0.3631 - val_loss: 3.2858 - val_accuracy50: 0.3650 - 9s/epoch - 19ms/step
Epoch 2/50
477/477 - 8s - loss: 3.2843 - accuracy50: 0.3777 - val_loss: 3.2744 - val_accuracy50: 0.3715 - 8s/epoch - 16ms/step
Epoch 3/50
477/477 - 8s - loss: 3.2745 - accuracy50: 0.3815 - val_loss: 3.2650 - val_accuracy50: 0.3799 - 8s/epoch - 16ms/step
Epoch 4/50
477/477 - 8s - loss: 3.2658 - accuracy50: 0.3864 - val_loss: 3.2641 - val_accuracy50: 0.3789 - 8s/epoch - 16ms/step
Epoch 5/50
477/477 - 7s - loss: 3.2602 - accuracy50: 0.3887 - val_loss: 3.2637 - val_accuracy50: 0.3793 - 7s/epoch - 16ms/step
Epoch 6/50
477/477 - 8s - loss: 3.2530 - accuracy50: 0.3946 - val_loss: 3.2628 - val_accuracy50: 0.3799 - 8s/epoch - 16ms/step
Epoch 7/50
477/477 - 8s - loss: 3.2478 - accuracy50: 0.3962 - val_loss: 3.2587 - val_accuracy50: 0.3798 - 8s/epoch - 16ms/step
Epoch 8/50
477/477 - 7s - loss: 3.2424 - accuracy50: 0.3989 - val_loss: 3.2570 - val_accuracy50: 0.3803 - 7s/epoch - 16ms/step
Epoch 9/50
477/477 - 7s - loss: 3.2373 - accuracy50: 0.3994 - val_loss: 3.2557 - val_accuracy50: 0.3801 - 7s/epoch - 16ms/step
Epoch 10/50
477/477 - 8s - loss: 3.2319 - accuracy50: 0.4010 - val_loss: 3.2475 - val_accuracy50: 0.3823 - 8s/epoch - 16ms/step
Epoch 11/50
477/477 - 7s - loss: 3.2263 - accuracy50: 0.4018 - val_loss: 3.2473 - val_accuracy50: 0.3823 - 7s/epoch - 15ms/step
Epoch 12/50
477/477 - 7s - loss: 3.2221 - accuracy50: 0.4038 - val_loss: 3.2457 - val_accuracy50: 0.3844 - 7s/epoch - 15ms/step
Epoch 13/50
477/477 - 8s - loss: 3.2189 - accuracy50: 0.4045 - val_loss: 3.2450 - val_accuracy50: 0.3828 - 8s/epoch - 16ms/step
Epoch 14/50
477/477 - 8s - loss: 3.2170 - accuracy50: 0.4057 - val_loss: 3.2384 - val_accuracy50: 0.3853 - 8s/epoch - 16ms/step
Epoch 15/50
477/477 - 8s - loss: 3.2112 - accuracy50: 0.4074 - val_loss: 3.2350 - val_accuracy50: 0.3863 - 8s/epoch - 16ms/step
Epoch 16/50
477/477 - 8s - loss: 3.2094 - accuracy50: 0.4072 - val_loss: 3.2366 - val_accuracy50: 0.3869 - 8s/epoch - 16ms/step
Epoch 17/50
477/477 - 7s - loss: 3.2071 - accuracy50: 0.4088 - val_loss: 3.2362 - val_accuracy50: 0.3844 - 7s/epoch - 16ms/step
Epoch 18/50
477/477 - 8s - loss: 3.2043 - accuracy50: 0.4112 - val_loss: 3.2346 - val_accuracy50: 0.3864 - 8s/epoch - 16ms/step
Epoch 19/50
477/477 - 8s - loss: 3.2021 - accuracy50: 0.4119 - val_loss: 3.2388 - val_accuracy50: 0.3825 - 8s/epoch - 16ms/step
Epoch 20/50
477/477 - 7s - loss: 3.2007 - accuracy50: 0.4123 - val_loss: 3.2343 - val_accuracy50: 0.3892 - 7s/epoch - 15ms/step
Epoch 21/50
477/477 - 7s - loss: 3.1990 - accuracy50: 0.4135 - val_loss: 3.2357 - val_accuracy50: 0.3847 - 7s/epoch - 15ms/step
Epoch 22/50
477/477 - 7s - loss: 3.1972 - accuracy50: 0.4135 - val_loss: 3.2328 - val_accuracy50: 0.3865 - 7s/epoch - 15ms/step
Epoch 23/50
477/477 - 7s - loss: 3.1941 - accuracy50: 0.4157 - val_loss: 3.2345 - val_accuracy50: 0.3859 - 7s/epoch - 16ms/step
Epoch 24/50
477/477 - 7s - loss: 3.1934 - accuracy50: 0.4156 - val_loss: 3.2307 - val_accuracy50: 0.3867 - 7s/epoch - 15ms/step
Epoch 25/50
477/477 - 8s - loss: 3.1892 - accuracy50: 0.4172 - val_loss: 3.2364 - val_accuracy50: 0.3828 - 8s/epoch - 16ms/step
Epoch 26/50
477/477 - 7s - loss: 3.1884 - accuracy50: 0.4172 - val_loss: 3.2355 - val_accuracy50: 0.3834 - 7s/epoch - 15ms/step
Epoch 27/50
477/477 - 7s - loss: 3.1856 - accuracy50: 0.4193 - val_loss: 3.2344 - val_accuracy50: 0.3854 - 7s/epoch - 15ms/step
Epoch 28/50
477/477 - 7s - loss: 3.1844 - accuracy50: 0.4210 - val_loss: 3.2403 - val_accuracy50: 0.3841 - 7s/epoch - 15ms/step
Epoch 29/50
477/477 - 8s - loss: 3.1806 - accuracy50: 0.4225 - val_loss: 3.2394 - val_accuracy50: 0.3852 - 8s/epoch - 16ms/step
Epoch 30/50
477/477 - 7s - loss: 3.1803 - accuracy50: 0.4222 - val_loss: 3.2392 - val_accuracy50: 0.3870 - 7s/epoch - 16ms/step
Epoch 31/50
477/477 - 7s - loss: 3.1766 - accuracy50: 0.4238 - val_loss: 3.2411 - val_accuracy50: 0.3832 - 7s/epoch - 16ms/step
Epoch 32/50
477/477 - 8s - loss: 3.1737 - accuracy50: 0.4253 - val_loss: 3.2408 - val_accuracy50: 0.3831 - 8s/epoch - 16ms/step
Epoch 33/50
477/477 - 7s - loss: 3.1707 - accuracy50: 0.4261 - val_loss: 3.2433 - val_accuracy50: 0.3832 - 7s/epoch - 16ms/step
Epoch 34/50
477/477 - 7s - loss: 3.1705 - accuracy50: 0.4275 - val_loss: 3.2444 - val_accuracy50: 0.3841 - 7s/epoch - 15ms/step
testing model: results/PCAR/W9/deepOF_L1/h50
Evaluating performance on  test set...
631/631 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1031318
{'0': {'precision': 0.44988306732860134, 'recall': 0.34544137105412387, 'f1-score': 0.39080459770114945, 'support': 63484}, '1': {'precision': 0.25, 'recall': 0.4334062802178228, 'f1-score': 0.3170926963677322, 'support': 39298}, '2': {'precision': 0.4259959486833221, 'recall': 0.3234168346946448, 'f1-score': 0.367685911881265, 'support': 58522}, 'accuracy': 0.35888136686009026, 'macro avg': {'precision': 0.3752930053373078, 'recall': 0.3674214953221971, 'f1-score': 0.35852773531671556, 'support': 161304}, 'weighted avg': {'precision': 0.39251978596398296, 'recall': 0.35888136686009026, 'f1-score': 0.3644588032375781, 'support': 161304}}
[[21930 26723 14831]
 [11594 17032 10672]
 [15222 24373 18927]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0721804
{'0': {'precision': 0.41699987426128504, 'recall': 0.40899785413018275, 'f1-score': 0.4129601036011356, 'support': 40543}, '1': {'precision': 0.37018548981791366, 'recall': 0.48634952179853436, 'f1-score': 0.420390371690537, 'support': 40255}, '2': {'precision': 0.43444106697633117, 'recall': 0.30924075559769526, 'f1-score': 0.36130205078679767, 'support': 41133}, 'accuracy': 0.4008824663129147, 'macro avg': {'precision': 0.40720881035184325, 'recall': 0.4015293771754708, 'f1-score': 0.3982175086928234, 'support': 121931}, 'weighted avg': {'precision': 0.40742803062988764, 'recall': 0.4008824663129147, 'f1-score': 0.3979865099746312, 'support': 121931}}
[[16582 16175  7786]
 [11904 19578  8773]
 [11279 17134 12720]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0775572
{'0': {'precision': 0.3870360757851025, 'recall': 0.39547835311277596, 'f1-score': 0.39121167404492535, 'support': 15083}, '1': {'precision': 0.3781155312286189, 'recall': 0.45624484019341904, 'f1-score': 0.4135221806520577, 'support': 16958}, '2': {'precision': 0.39341878011089904, 'recall': 0.29176216799244975, 'f1-score': 0.33504935165473193, 'support': 14834}, 'accuracy': 0.38464, 'macro avg': {'precision': 0.38619012904154015, 'recall': 0.3811617870995483, 'f1-score': 0.3799277354505717, 'support': 46875}, 'weighted avg': {'precision': 0.38582874653454285, 'recall': 0.38464, 'f1-score': 0.38150990723335465, 'support': 46875}}
[[5965 6259 2859]
 [5407 7737 3814]
 [4040 6466 4328]]
training model: results/PCAR/W9/deepOF_L1/h100
Epoch 1/50
477/477 - 9s - loss: 3.3239 - accuracy100: 0.3531 - val_loss: 3.3028 - val_accuracy100: 0.3534 - 9s/epoch - 19ms/step
Epoch 2/50
477/477 - 7s - loss: 3.2987 - accuracy100: 0.3623 - val_loss: 3.2899 - val_accuracy100: 0.3583 - 7s/epoch - 16ms/step
Epoch 3/50
477/477 - 7s - loss: 3.2885 - accuracy100: 0.3677 - val_loss: 3.2860 - val_accuracy100: 0.3624 - 7s/epoch - 15ms/step
Epoch 4/50
477/477 - 8s - loss: 3.2810 - accuracy100: 0.3705 - val_loss: 3.2843 - val_accuracy100: 0.3624 - 8s/epoch - 17ms/step
Epoch 5/50
477/477 - 7s - loss: 3.2766 - accuracy100: 0.3741 - val_loss: 3.2842 - val_accuracy100: 0.3604 - 7s/epoch - 15ms/step
Epoch 6/50
477/477 - 7s - loss: 3.2719 - accuracy100: 0.3758 - val_loss: 3.2832 - val_accuracy100: 0.3633 - 7s/epoch - 15ms/step
Epoch 7/50
477/477 - 7s - loss: 3.2670 - accuracy100: 0.3779 - val_loss: 3.2832 - val_accuracy100: 0.3655 - 7s/epoch - 15ms/step
Epoch 8/50
477/477 - 7s - loss: 3.2624 - accuracy100: 0.3801 - val_loss: 3.2817 - val_accuracy100: 0.3654 - 7s/epoch - 15ms/step
Epoch 9/50
477/477 - 7s - loss: 3.2594 - accuracy100: 0.3831 - val_loss: 3.2804 - val_accuracy100: 0.3656 - 7s/epoch - 15ms/step
Epoch 10/50
477/477 - 7s - loss: 3.2555 - accuracy100: 0.3847 - val_loss: 3.2800 - val_accuracy100: 0.3679 - 7s/epoch - 15ms/step
Epoch 11/50
477/477 - 7s - loss: 3.2513 - accuracy100: 0.3868 - val_loss: 3.2769 - val_accuracy100: 0.3683 - 7s/epoch - 15ms/step
Epoch 12/50
477/477 - 7s - loss: 3.2479 - accuracy100: 0.3872 - val_loss: 3.2775 - val_accuracy100: 0.3689 - 7s/epoch - 16ms/step
Epoch 13/50
477/477 - 7s - loss: 3.2452 - accuracy100: 0.3891 - val_loss: 3.2727 - val_accuracy100: 0.3682 - 7s/epoch - 16ms/step
Epoch 14/50
477/477 - 7s - loss: 3.2407 - accuracy100: 0.3909 - val_loss: 3.2711 - val_accuracy100: 0.3685 - 7s/epoch - 15ms/step
Epoch 15/50
477/477 - 7s - loss: 3.2396 - accuracy100: 0.3910 - val_loss: 3.2700 - val_accuracy100: 0.3709 - 7s/epoch - 16ms/step
Epoch 16/50
477/477 - 8s - loss: 3.2362 - accuracy100: 0.3931 - val_loss: 3.2700 - val_accuracy100: 0.3703 - 8s/epoch - 16ms/step
Epoch 17/50
477/477 - 7s - loss: 3.2326 - accuracy100: 0.3934 - val_loss: 3.2699 - val_accuracy100: 0.3686 - 7s/epoch - 16ms/step
Epoch 18/50
477/477 - 7s - loss: 3.2324 - accuracy100: 0.3928 - val_loss: 3.2684 - val_accuracy100: 0.3689 - 7s/epoch - 15ms/step
Epoch 19/50
477/477 - 7s - loss: 3.2288 - accuracy100: 0.3949 - val_loss: 3.2675 - val_accuracy100: 0.3691 - 7s/epoch - 16ms/step
Epoch 20/50
477/477 - 7s - loss: 3.2260 - accuracy100: 0.3980 - val_loss: 3.2668 - val_accuracy100: 0.3687 - 7s/epoch - 15ms/step
Epoch 21/50
477/477 - 7s - loss: 3.2246 - accuracy100: 0.3986 - val_loss: 3.2670 - val_accuracy100: 0.3677 - 7s/epoch - 15ms/step
Epoch 22/50
477/477 - 8s - loss: 3.2233 - accuracy100: 0.3990 - val_loss: 3.2660 - val_accuracy100: 0.3723 - 8s/epoch - 16ms/step
Epoch 23/50
477/477 - 7s - loss: 3.2195 - accuracy100: 0.4013 - val_loss: 3.2667 - val_accuracy100: 0.3697 - 7s/epoch - 15ms/step
Epoch 24/50
477/477 - 7s - loss: 3.2168 - accuracy100: 0.4024 - val_loss: 3.2658 - val_accuracy100: 0.3717 - 7s/epoch - 16ms/step
Epoch 25/50
477/477 - 8s - loss: 3.2154 - accuracy100: 0.4045 - val_loss: 3.2673 - val_accuracy100: 0.3702 - 8s/epoch - 16ms/step
Epoch 26/50
477/477 - 7s - loss: 3.2141 - accuracy100: 0.4038 - val_loss: 3.2679 - val_accuracy100: 0.3715 - 7s/epoch - 15ms/step
Epoch 27/50
477/477 - 7s - loss: 3.2108 - accuracy100: 0.4053 - val_loss: 3.2680 - val_accuracy100: 0.3723 - 7s/epoch - 15ms/step
Epoch 28/50
477/477 - 7s - loss: 3.2088 - accuracy100: 0.4076 - val_loss: 3.2692 - val_accuracy100: 0.3684 - 7s/epoch - 16ms/step
Epoch 29/50
477/477 - 7s - loss: 3.2064 - accuracy100: 0.4082 - val_loss: 3.2737 - val_accuracy100: 0.3694 - 7s/epoch - 15ms/step
Epoch 30/50
477/477 - 7s - loss: 3.2041 - accuracy100: 0.4099 - val_loss: 3.2723 - val_accuracy100: 0.3694 - 7s/epoch - 16ms/step
Epoch 31/50
477/477 - 8s - loss: 3.2020 - accuracy100: 0.4104 - val_loss: 3.2742 - val_accuracy100: 0.3705 - 8s/epoch - 16ms/step
Epoch 32/50
477/477 - 8s - loss: 3.1999 - accuracy100: 0.4113 - val_loss: 3.2743 - val_accuracy100: 0.3679 - 8s/epoch - 16ms/step
Epoch 33/50
477/477 - 7s - loss: 3.1981 - accuracy100: 0.4137 - val_loss: 3.2746 - val_accuracy100: 0.3670 - 7s/epoch - 16ms/step
Epoch 34/50
477/477 - 7s - loss: 3.1961 - accuracy100: 0.4149 - val_loss: 3.2728 - val_accuracy100: 0.3709 - 7s/epoch - 16ms/step
testing model: results/PCAR/W9/deepOF_L1/h100
Evaluating performance on  test set...
631/631 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.101769
{'0': {'precision': 0.4012907917462049, 'recall': 0.3684790411164716, 'f1-score': 0.3841856093570509, 'support': 59903}, '1': {'precision': 0.29262804958750605, 'recall': 0.4273197758069019, 'f1-score': 0.3473744850219957, 'support': 46567}, '2': {'precision': 0.3755809702856546, 'recall': 0.2623189991611044, 'f1-score': 0.30889490185972596, 'support': 54834}, 'accuracy': 0.3493775727818281, 'macro avg': {'precision': 0.3564999372064552, 'recall': 0.35270593869482597, 'f1-score': 0.34681833207959084, 'support': 161304}, 'weighted avg': {'precision': 0.36118099741951776, 'recall': 0.3493775727818281, 'f1-score': 0.3479641003937342, 'support': 161304}}
[[22073 24777 13053]
 [15807 19899 10861]
 [17125 23325 14384]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0773114
{'0': {'precision': 0.39609564237235295, 'recall': 0.4098771559746867, 'f1-score': 0.40286857254366276, 'support': 40295}, '1': {'precision': 0.36842304346181487, 'recall': 0.48445660283511566, 'f1-score': 0.4185466890120751, 'support': 40210}, '2': {'precision': 0.4197733918128655, 'recall': 0.2772413460145802, 'f1-score': 0.3339342308027797, 'support': 41426}, 'accuracy': 0.38940876397306673, 'macro avg': {'precision': 0.39476402588234444, 'recall': 0.39052503494146085, 'f1-score': 0.38511649745283916, 'support': 121931}, 'weighted avg': {'precision': 0.3950143689154793, 'recall': 0.38940876397306673, 'f1-score': 0.38461843945394014, 'support': 121931}}
[[16516 16128  7651]
 [12506 19480  8224]
 [12675 17266 11485]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0890353
{'0': {'precision': 0.38214854956965255, 'recall': 0.3809826479374563, 'f1-score': 0.38156470812909793, 'support': 15733}, '1': {'precision': 0.3535971047097374, 'recall': 0.45615141955835964, 'f1-score': 0.3983800314075543, 'support': 15850}, '2': {'precision': 0.3734524806850973, 'recall': 0.2623594036097306, 'f1-score': 0.3082004993278279, 'support': 15292}, 'accuracy': 0.3677013333333333, 'macro avg': {'precision': 0.36973271165482907, 'recall': 0.3664978237018488, 'f1-score': 0.36271507962149335, 'support': 46875}, 'weighted avg': {'precision': 0.3696574415928573, 'recall': 0.3677013333333333, 'f1-score': 0.3633169725125541, 'support': 46875}}
[[5994 6562 3177]
 [5066 7230 3554]
 [4625 6655 4012]]
training model: results/PCAR/W9/deepOF_L1/h200
Epoch 1/50
477/477 - 10s - loss: 3.3339 - accuracy200: 0.3444 - val_loss: 3.3103 - val_accuracy200: 0.3452 - 10s/epoch - 20ms/step
Epoch 2/50
477/477 - 7s - loss: 3.3095 - accuracy200: 0.3526 - val_loss: 3.3022 - val_accuracy200: 0.3487 - 7s/epoch - 16ms/step
Epoch 3/50
477/477 - 8s - loss: 3.2987 - accuracy200: 0.3575 - val_loss: 3.2977 - val_accuracy200: 0.3485 - 8s/epoch - 16ms/step
Epoch 4/50
477/477 - 7s - loss: 3.2922 - accuracy200: 0.3607 - val_loss: 3.2954 - val_accuracy200: 0.3503 - 7s/epoch - 16ms/step
Epoch 5/50
477/477 - 8s - loss: 3.2874 - accuracy200: 0.3632 - val_loss: 3.2947 - val_accuracy200: 0.3495 - 8s/epoch - 16ms/step
Epoch 6/50
477/477 - 7s - loss: 3.2832 - accuracy200: 0.3694 - val_loss: 3.2930 - val_accuracy200: 0.3530 - 7s/epoch - 16ms/step
Epoch 7/50
477/477 - 7s - loss: 3.2798 - accuracy200: 0.3702 - val_loss: 3.2905 - val_accuracy200: 0.3529 - 7s/epoch - 16ms/step
Epoch 8/50
477/477 - 7s - loss: 3.2775 - accuracy200: 0.3707 - val_loss: 3.2894 - val_accuracy200: 0.3523 - 7s/epoch - 16ms/step
Epoch 9/50
477/477 - 8s - loss: 3.2752 - accuracy200: 0.3712 - val_loss: 3.2916 - val_accuracy200: 0.3498 - 8s/epoch - 16ms/step
Epoch 10/50
477/477 - 7s - loss: 3.2716 - accuracy200: 0.3730 - val_loss: 3.2905 - val_accuracy200: 0.3532 - 7s/epoch - 15ms/step
Epoch 11/50
477/477 - 8s - loss: 3.2685 - accuracy200: 0.3759 - val_loss: 3.2895 - val_accuracy200: 0.3549 - 8s/epoch - 16ms/step
Epoch 12/50
477/477 - 7s - loss: 3.2662 - accuracy200: 0.3783 - val_loss: 3.2906 - val_accuracy200: 0.3553 - 7s/epoch - 16ms/step
Epoch 13/50
477/477 - 7s - loss: 3.2641 - accuracy200: 0.3786 - val_loss: 3.2886 - val_accuracy200: 0.3555 - 7s/epoch - 15ms/step
Epoch 14/50
477/477 - 7s - loss: 3.2615 - accuracy200: 0.3799 - val_loss: 3.2906 - val_accuracy200: 0.3530 - 7s/epoch - 15ms/step
Epoch 15/50
477/477 - 7s - loss: 3.2581 - accuracy200: 0.3811 - val_loss: 3.2883 - val_accuracy200: 0.3545 - 7s/epoch - 15ms/step
Epoch 16/50
477/477 - 7s - loss: 3.2566 - accuracy200: 0.3817 - val_loss: 3.2874 - val_accuracy200: 0.3513 - 7s/epoch - 15ms/step
Epoch 17/50
477/477 - 7s - loss: 3.2537 - accuracy200: 0.3843 - val_loss: 3.2873 - val_accuracy200: 0.3555 - 7s/epoch - 16ms/step
Epoch 18/50
477/477 - 7s - loss: 3.2512 - accuracy200: 0.3847 - val_loss: 3.2884 - val_accuracy200: 0.3526 - 7s/epoch - 15ms/step
Epoch 19/50
477/477 - 7s - loss: 3.2495 - accuracy200: 0.3878 - val_loss: 3.2884 - val_accuracy200: 0.3512 - 7s/epoch - 16ms/step
Epoch 20/50
477/477 - 7s - loss: 3.2476 - accuracy200: 0.3872 - val_loss: 3.2894 - val_accuracy200: 0.3561 - 7s/epoch - 15ms/step
Epoch 21/50
477/477 - 8s - loss: 3.2457 - accuracy200: 0.3877 - val_loss: 3.2892 - val_accuracy200: 0.3544 - 8s/epoch - 16ms/step
Epoch 22/50
477/477 - 7s - loss: 3.2432 - accuracy200: 0.3883 - val_loss: 3.2894 - val_accuracy200: 0.3540 - 7s/epoch - 16ms/step
Epoch 23/50
477/477 - 7s - loss: 3.2420 - accuracy200: 0.3896 - val_loss: 3.2894 - val_accuracy200: 0.3532 - 7s/epoch - 15ms/step
Epoch 24/50
477/477 - 7s - loss: 3.2381 - accuracy200: 0.3920 - val_loss: 3.2906 - val_accuracy200: 0.3535 - 7s/epoch - 15ms/step
Epoch 25/50
477/477 - 7s - loss: 3.2373 - accuracy200: 0.3928 - val_loss: 3.2911 - val_accuracy200: 0.3536 - 7s/epoch - 15ms/step
Epoch 26/50
477/477 - 7s - loss: 3.2349 - accuracy200: 0.3945 - val_loss: 3.2905 - val_accuracy200: 0.3559 - 7s/epoch - 15ms/step
Epoch 27/50
477/477 - 7s - loss: 3.2342 - accuracy200: 0.3937 - val_loss: 3.2921 - val_accuracy200: 0.3542 - 7s/epoch - 15ms/step
testing model: results/PCAR/W9/deepOF_L1/h200
Evaluating performance on  test set...
631/631 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1149989
{'0': {'precision': 0.4173319495449465, 'recall': 0.1623295966214328, 'f1-score': 0.2337409734176932, 'support': 64406}, '1': {'precision': 0.2413191567305428, 'recall': 0.7134531576368653, 'f1-score': 0.3606512500977658, 'support': 38779}, '2': {'precision': 0.38480766560199975, 'recall': 0.14303411965106075, 'f1-score': 0.20854971024309477, 'support': 58119}, 'accuracy': 0.2878725884045033, 'macro avg': {'precision': 0.3478195906258297, 'recall': 0.33960562463645294, 'f1-score': 0.26764731125285124, 'support': 161304}, 'weighted avg': {'precision': 0.36329808212051884, 'recall': 0.2878725884045033, 'f1-score': 0.2551748039174455, 'support': 161304}}
[[10455 45780  8171]
 [ 5993 27667  5119]
 [ 8604 41202  8313]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0888455
{'0': {'precision': 0.38985973251316464, 'recall': 0.2083582386929667, 'f1-score': 0.2715748811088929, 'support': 40152}, '1': {'precision': 0.34487461715160794, 'recall': 0.7161561203448361, 'f1-score': 0.46555497234222953, 'support': 40251}, '2': {'precision': 0.4133704405495026, 'recall': 0.16810344827586207, 'f1-score': 0.23900986031224325, 'support': 41528}, 'accuracy': 0.3622786658027901, 'macro avg': {'precision': 0.38270159673809173, 'recall': 0.3642059357712217, 'f1-score': 0.32537990458778854, 'support': 121931}, 'weighted avg': {'precision': 0.3830169837857288, 'recall': 0.3622786658027901, 'f1-score': 0.3245190254904674, 'support': 121931}}
[[ 8366 26910  4876]
 [ 6394 28826  5031]
 [ 6699 27848  6981]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.095638
{'0': {'precision': 0.352337786259542, 'recall': 0.19026149684400362, 'f1-score': 0.24709326641572568, 'support': 15526}, '1': {'precision': 0.35070551469427697, 'recall': 0.6771912714860417, 'f1-score': 0.4620983674742643, 'support': 16406}, '2': {'precision': 0.36186142102172636, 'recall': 0.16496018202502843, 'f1-score': 0.2266145713629051, 'support': 14943}, 'accuracy': 0.3526186666666667, 'macro avg': {'precision': 0.3549682406585151, 'recall': 0.34413765011835795, 'f1-score': 0.311935401750965, 'support': 46875}, 'weighted avg': {'precision': 0.3548024823011757, 'recall': 0.3526186666666667, 'f1-score': 0.3158156247686235, 'support': 46875}}
[[ 2954 10529  2043]
 [ 2992 11110  2304]
 [ 2438 10040  2465]]
training model: results/PCAR/W9/deepOF_L1/h300
Epoch 1/50
477/477 - 10s - loss: 3.3380 - accuracy300: 0.3440 - val_loss: 3.3135 - val_accuracy300: 0.3457 - 10s/epoch - 20ms/step
Epoch 2/50
477/477 - 7s - loss: 3.3128 - accuracy300: 0.3524 - val_loss: 3.3035 - val_accuracy300: 0.3487 - 7s/epoch - 15ms/step
Epoch 3/50
477/477 - 8s - loss: 3.3030 - accuracy300: 0.3551 - val_loss: 3.2980 - val_accuracy300: 0.3532 - 8s/epoch - 16ms/step
Epoch 4/50
477/477 - 7s - loss: 3.2960 - accuracy300: 0.3567 - val_loss: 3.2969 - val_accuracy300: 0.3511 - 7s/epoch - 16ms/step
Epoch 5/50
477/477 - 7s - loss: 3.2917 - accuracy300: 0.3588 - val_loss: 3.2937 - val_accuracy300: 0.3526 - 7s/epoch - 16ms/step
Epoch 6/50
477/477 - 7s - loss: 3.2867 - accuracy300: 0.3608 - val_loss: 3.2954 - val_accuracy300: 0.3496 - 7s/epoch - 15ms/step
Epoch 7/50
477/477 - 7s - loss: 3.2826 - accuracy300: 0.3637 - val_loss: 3.2943 - val_accuracy300: 0.3524 - 7s/epoch - 16ms/step
Epoch 8/50
477/477 - 7s - loss: 3.2804 - accuracy300: 0.3647 - val_loss: 3.2943 - val_accuracy300: 0.3545 - 7s/epoch - 16ms/step
Epoch 9/50
477/477 - 8s - loss: 3.2777 - accuracy300: 0.3667 - val_loss: 3.2942 - val_accuracy300: 0.3524 - 8s/epoch - 16ms/step
Epoch 10/50
477/477 - 7s - loss: 3.2747 - accuracy300: 0.3673 - val_loss: 3.2938 - val_accuracy300: 0.3536 - 7s/epoch - 15ms/step
Epoch 11/50
477/477 - 7s - loss: 3.2716 - accuracy300: 0.3687 - val_loss: 3.2943 - val_accuracy300: 0.3524 - 7s/epoch - 15ms/step
Epoch 12/50
477/477 - 7s - loss: 3.2676 - accuracy300: 0.3710 - val_loss: 3.2952 - val_accuracy300: 0.3539 - 7s/epoch - 15ms/step
Epoch 13/50
477/477 - 7s - loss: 3.2649 - accuracy300: 0.3743 - val_loss: 3.2948 - val_accuracy300: 0.3521 - 7s/epoch - 15ms/step
Epoch 14/50
477/477 - 7s - loss: 3.2627 - accuracy300: 0.3738 - val_loss: 3.2969 - val_accuracy300: 0.3507 - 7s/epoch - 15ms/step
Epoch 15/50
477/477 - 7s - loss: 3.2601 - accuracy300: 0.3750 - val_loss: 3.2977 - val_accuracy300: 0.3534 - 7s/epoch - 15ms/step
testing model: results/PCAR/W9/deepOF_L1/h300
Evaluating performance on  test set...
631/631 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1064621
{'0': {'precision': 0.3861800209105598, 'recall': 0.13610478359908884, 'f1-score': 0.20127312808064796, 'support': 59704}, '1': {'precision': 0.2986969452132506, 'recall': 0.7260817784835252, 'f1-score': 0.4232687587924702, 'support': 47861}, '2': {'precision': 0.34891304347826085, 'recall': 0.1553062021995199, 'f1-score': 0.21493967215647897, 'support': 53739}, 'accuracy': 0.3175556712790755, 'macro avg': {'precision': 0.34459666986735704, 'recall': 0.33916425476071127, 'f1-score': 0.2798271863431991, 'support': 161304}, 'weighted avg': {'precision': 0.3478070259062001, 'recall': 0.3175556712790755, 'f1-score': 0.2716951839105691, 'support': 161304}}
[[ 8126 42983  8595]
 [ 6131 34751  6979]
 [ 6785 38608  8346]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096513
{'0': {'precision': 0.3690417148840029, 'recall': 0.1679119446394544, 'f1-score': 0.23080767176164466, 'support': 39884}, '1': {'precision': 0.33669907461637577, 'recall': 0.7137465236392531, 'f1-score': 0.45755400264242846, 'support': 40272}, '2': {'precision': 0.38389269034430323, 'recall': 0.1692160383004189, 'f1-score': 0.23489341906328398, 'support': 41775}, 'accuracy': 0.3486398044795827, 'macro avg': {'precision': 0.3632111599482273, 'recall': 0.3502915021930421, 'f1-score': 0.3077516978224524, 'support': 121931}, 'weighted avg': {'precision': 0.36344754023601483, 'recall': 0.3486398044795827, 'f1-score': 0.3070984454841345, 'support': 121931}}
[[ 6697 27594  5593]
 [ 5776 28744  5752]
 [ 5674 29032  7069]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0974039
{'0': {'precision': 0.3535758749481256, 'recall': 0.16491386541067166, 'f1-score': 0.2249208025343189, 'support': 15499}, '1': {'precision': 0.35263500325309044, 'recall': 0.6877756964167019, 'f1-score': 0.46622701019948387, 'support': 16549}, '2': {'precision': 0.35215090242909486, 'recall': 0.17501854724489108, 'f1-score': 0.23382591457920346, 'support': 14827}, 'accuracy': 0.352704, 'macro avg': {'precision': 0.3527872602101036, 'recall': 0.34256936969075485, 'f1-score': 0.3083245757710021, 'support': 46875}, 'weighted avg': {'precision': 0.3527929724794151, 'recall': 0.352704, 'f1-score': 0.3129296031090457, 'support': 46875}}
[[ 2556 10726  2217]
 [ 2610 11382  2557]
 [ 2063 10169  2595]]
training model: results/PCAR/W9/deepOF_L1/h500
Epoch 1/50
477/477 - 10s - loss: 3.3389 - accuracy500: 0.3436 - val_loss: 3.3220 - val_accuracy500: 0.3394 - 10s/epoch - 20ms/step
Epoch 2/50
477/477 - 8s - loss: 3.3135 - accuracy500: 0.3485 - val_loss: 3.3113 - val_accuracy500: 0.3421 - 8s/epoch - 16ms/step
Epoch 3/50
477/477 - 7s - loss: 3.3051 - accuracy500: 0.3509 - val_loss: 3.3074 - val_accuracy500: 0.3414 - 7s/epoch - 15ms/step
Epoch 4/50
477/477 - 7s - loss: 3.2982 - accuracy500: 0.3548 - val_loss: 3.3020 - val_accuracy500: 0.3457 - 7s/epoch - 15ms/step
Epoch 5/50
477/477 - 7s - loss: 3.2943 - accuracy500: 0.3558 - val_loss: 3.3005 - val_accuracy500: 0.3438 - 7s/epoch - 15ms/step
Epoch 6/50
477/477 - 7s - loss: 3.2913 - accuracy500: 0.3550 - val_loss: 3.3004 - val_accuracy500: 0.3452 - 7s/epoch - 15ms/step
Epoch 7/50
477/477 - 7s - loss: 3.2883 - accuracy500: 0.3572 - val_loss: 3.2996 - val_accuracy500: 0.3465 - 7s/epoch - 15ms/step
Epoch 8/50
477/477 - 7s - loss: 3.2860 - accuracy500: 0.3602 - val_loss: 3.2998 - val_accuracy500: 0.3472 - 7s/epoch - 15ms/step
Epoch 9/50
477/477 - 7s - loss: 3.2825 - accuracy500: 0.3607 - val_loss: 3.2989 - val_accuracy500: 0.3457 - 7s/epoch - 15ms/step
Epoch 10/50
477/477 - 8s - loss: 3.2809 - accuracy500: 0.3625 - val_loss: 3.2997 - val_accuracy500: 0.3473 - 8s/epoch - 16ms/step
Epoch 11/50
477/477 - 7s - loss: 3.2774 - accuracy500: 0.3654 - val_loss: 3.3012 - val_accuracy500: 0.3428 - 7s/epoch - 15ms/step
Epoch 12/50
477/477 - 7s - loss: 3.2757 - accuracy500: 0.3657 - val_loss: 3.3007 - val_accuracy500: 0.3462 - 7s/epoch - 16ms/step
Epoch 13/50
477/477 - 8s - loss: 3.2731 - accuracy500: 0.3675 - val_loss: 3.3024 - val_accuracy500: 0.3452 - 8s/epoch - 16ms/step
Epoch 14/50
477/477 - 7s - loss: 3.2716 - accuracy500: 0.3707 - val_loss: 3.3024 - val_accuracy500: 0.3484 - 7s/epoch - 15ms/step
Epoch 15/50
477/477 - 7s - loss: 3.2690 - accuracy500: 0.3707 - val_loss: 3.3018 - val_accuracy500: 0.3473 - 7s/epoch - 15ms/step
Epoch 16/50
477/477 - 7s - loss: 3.2670 - accuracy500: 0.3730 - val_loss: 3.3036 - val_accuracy500: 0.3467 - 7s/epoch - 15ms/step
Epoch 17/50
477/477 - 7s - loss: 3.2649 - accuracy500: 0.3722 - val_loss: 3.3045 - val_accuracy500: 0.3461 - 7s/epoch - 15ms/step
Epoch 18/50
477/477 - 7s - loss: 3.2629 - accuracy500: 0.3747 - val_loss: 3.3043 - val_accuracy500: 0.3456 - 7s/epoch - 15ms/step
Epoch 19/50
477/477 - 7s - loss: 3.2617 - accuracy500: 0.3775 - val_loss: 3.3027 - val_accuracy500: 0.3461 - 7s/epoch - 16ms/step
testing model: results/PCAR/W9/deepOF_L1/h500
Evaluating performance on  test set...
631/631 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1054468
{'0': {'precision': 0.3834226284273558, 'recall': 0.10050226349007038, 'f1-score': 0.1592595986438193, 'support': 60526}, '1': {'precision': 0.30322470206557, 'recall': 0.7627747703412073, 'f1-score': 0.43394421567140673, 'support': 48768}, '2': {'precision': 0.33386055094240147, 'recall': 0.14610651797731206, 'f1-score': 0.2032606224338313, 'support': 52010}, 'accuracy': 0.31543545107374893, 'macro avg': {'precision': 0.34016929381177574, 'recall': 0.3364611839361966, 'f1-score': 0.26548814558301914, 'support': 161304}, 'weighted avg': {'precision': 0.3431953797366597, 'recall': 0.31543545107374893, 'f1-score': 0.25649409159204073, 'support': 161304}}
[[ 6083 46108  8335]
 [ 4742 37199  6827]
 [ 5040 39371  7599]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0954218
{'0': {'precision': 0.3623317718789501, 'recall': 0.12268378650553877, 'f1-score': 0.18330230021252986, 'support': 39720}, '1': {'precision': 0.33666971956910463, 'recall': 0.7670790480449148, 'f1-score': 0.46795483822080775, 'support': 40254}, '2': {'precision': 0.3883454610521293, 'recall': 0.15518268703672808, 'f1-score': 0.22175297583570322, 'support': 41957}, 'accuracy': 0.3466058672527905, 'macro avg': {'precision': 0.362448984166728, 'recall': 0.3483151738623939, 'f1-score': 0.29100337142301363, 'support': 121931}, 'weighted avg': {'precision': 0.36281119141096874, 'recall': 0.3466058672527905, 'f1-score': 0.2905078366397445, 'support': 121931}}
[[ 4873 29833  5014]
 [ 4135 30878  5241]
 [ 4441 31005  6511]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0991125
{'0': {'precision': 0.3549041297935103, 'recall': 0.12212142358688068, 'f1-score': 0.18171520271864824, 'support': 15763}, '1': {'precision': 0.34359180855959504, 'recall': 0.7466716669791862, 'f1-score': 0.4706206787874012, 'support': 15999}, '2': {'precision': 0.3621128235822236, 'recall': 0.16012704294316152, 'f1-score': 0.22205909341163516, 'support': 15113}, 'accuracy': 0.3475413333333333, 'macro avg': {'precision': 0.35353625397844296, 'recall': 0.34297337783640947, 'f1-score': 0.29146499163922823, 'support': 46875}, 'weighted avg': {'precision': 0.3533672585787352, 'recall': 0.3475413333333333, 'f1-score': 0.2933294092608795, 'support': 46875}}
[[ 1925 11806  2032]
 [ 1822 11946  2231]
 [ 1677 11016  2420]]
training model: results/PCAR/W9/deepOF_L1/h1000
Epoch 1/50
477/477 - 9s - loss: 3.3424 - accuracy1000: 0.3431 - val_loss: 3.3183 - val_accuracy1000: 0.3379 - 9s/epoch - 20ms/step
Epoch 2/50
477/477 - 7s - loss: 3.3179 - accuracy1000: 0.3469 - val_loss: 3.3083 - val_accuracy1000: 0.3372 - 7s/epoch - 15ms/step
Epoch 3/50
477/477 - 7s - loss: 3.3086 - accuracy1000: 0.3491 - val_loss: 3.3066 - val_accuracy1000: 0.3390 - 7s/epoch - 15ms/step
Epoch 4/50
477/477 - 7s - loss: 3.3019 - accuracy1000: 0.3505 - val_loss: 3.3030 - val_accuracy1000: 0.3393 - 7s/epoch - 15ms/step
Epoch 5/50
477/477 - 7s - loss: 3.2985 - accuracy1000: 0.3495 - val_loss: 3.3016 - val_accuracy1000: 0.3424 - 7s/epoch - 15ms/step
Epoch 6/50
477/477 - 7s - loss: 3.2960 - accuracy1000: 0.3506 - val_loss: 3.3007 - val_accuracy1000: 0.3376 - 7s/epoch - 15ms/step
Epoch 7/50
477/477 - 7s - loss: 3.2934 - accuracy1000: 0.3526 - val_loss: 3.2993 - val_accuracy1000: 0.3437 - 7s/epoch - 16ms/step
Epoch 8/50
477/477 - 7s - loss: 3.2923 - accuracy1000: 0.3518 - val_loss: 3.2999 - val_accuracy1000: 0.3421 - 7s/epoch - 15ms/step
Epoch 9/50
477/477 - 7s - loss: 3.2901 - accuracy1000: 0.3542 - val_loss: 3.2997 - val_accuracy1000: 0.3404 - 7s/epoch - 15ms/step
Epoch 10/50
477/477 - 7s - loss: 3.2885 - accuracy1000: 0.3547 - val_loss: 3.3003 - val_accuracy1000: 0.3409 - 7s/epoch - 15ms/step
Epoch 11/50
477/477 - 7s - loss: 3.2869 - accuracy1000: 0.3558 - val_loss: 3.3013 - val_accuracy1000: 0.3395 - 7s/epoch - 15ms/step
Epoch 12/50
477/477 - 7s - loss: 3.2863 - accuracy1000: 0.3556 - val_loss: 3.2991 - val_accuracy1000: 0.3438 - 7s/epoch - 15ms/step
Epoch 13/50
477/477 - 8s - loss: 3.2841 - accuracy1000: 0.3589 - val_loss: 3.3016 - val_accuracy1000: 0.3421 - 8s/epoch - 16ms/step
Epoch 14/50
477/477 - 7s - loss: 3.2828 - accuracy1000: 0.3582 - val_loss: 3.3011 - val_accuracy1000: 0.3455 - 7s/epoch - 16ms/step
Epoch 15/50
477/477 - 7s - loss: 3.2811 - accuracy1000: 0.3605 - val_loss: 3.2997 - val_accuracy1000: 0.3492 - 7s/epoch - 15ms/step
Epoch 16/50
477/477 - 7s - loss: 3.2784 - accuracy1000: 0.3627 - val_loss: 3.3025 - val_accuracy1000: 0.3405 - 7s/epoch - 15ms/step
Epoch 17/50
477/477 - 7s - loss: 3.2780 - accuracy1000: 0.3647 - val_loss: 3.3017 - val_accuracy1000: 0.3436 - 7s/epoch - 15ms/step
Epoch 18/50
477/477 - 7s - loss: 3.2761 - accuracy1000: 0.3662 - val_loss: 3.3024 - val_accuracy1000: 0.3419 - 7s/epoch - 15ms/step
Epoch 19/50
477/477 - 7s - loss: 3.2743 - accuracy1000: 0.3676 - val_loss: 3.3025 - val_accuracy1000: 0.3449 - 7s/epoch - 14ms/step
Epoch 20/50
477/477 - 7s - loss: 3.2723 - accuracy1000: 0.3685 - val_loss: 3.3039 - val_accuracy1000: 0.3434 - 7s/epoch - 14ms/step
Epoch 21/50
477/477 - 7s - loss: 3.2697 - accuracy1000: 0.3717 - val_loss: 3.3052 - val_accuracy1000: 0.3409 - 7s/epoch - 14ms/step
Epoch 22/50
477/477 - 7s - loss: 3.2686 - accuracy1000: 0.3729 - val_loss: 3.3053 - val_accuracy1000: 0.3405 - 7s/epoch - 16ms/step
testing model: results/PCAR/W9/deepOF_L1/h1000
Evaluating performance on  test set...
631/631 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007589
{'0': {'precision': 0.3818639180317811, 'recall': 0.30496847744422306, 'f1-score': 0.33911172053067934, 'support': 61226}, '1': {'precision': 0.2986984388219886, 'recall': 0.5320835742010075, 'f1-score': 0.38260947022276326, 'support': 48436}, '2': {'precision': 0.32400673658424556, 'recall': 0.16391696680996087, 'f1-score': 0.21769879642012138, 'support': 51642}, 'accuracy': 0.3280079849228785, 'macro avg': {'precision': 0.3348563644793385, 'recall': 0.3336563394850638, 'f1-score': 0.31313999572452134, 'support': 161304}, 'weighted avg': {'precision': 0.3383680114496806, 'recall': 0.3280079849228785, 'f1-score': 0.3133023839808625, 'support': 161304}}
[[18672 32874  9680]
 [14683 25772  7981]
 [15542 27635  8465]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0953326
{'0': {'precision': 0.34923290774299837, 'recall': 0.3403919010462403, 'f1-score': 0.3447557334349787, 'support': 39857}, '1': {'precision': 0.3415207817013686, 'recall': 0.5424480994885167, 'f1-score': 0.4191489155599469, 'support': 39884}, '2': {'precision': 0.38319651363129625, 'recall': 0.17923678596823892, 'f1-score': 0.2442348685485434, 'support': 42190}, 'accuracy': 0.3507229498650876, 'macro avg': {'precision': 0.35798340102522114, 'recall': 0.3540255955009986, 'f1-score': 0.336046505847823, 'support': 121931}, 'weighted avg': {'precision': 0.3584621775544731, 'recall': 0.3507229498650876, 'f1-score': 0.33430820480250234, 'support': 121931}}
[[13567 20161  6129]
 [12206 21635  6043]
 [13075 21553  7562]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999328
{'0': {'precision': 0.33638979987952616, 'recall': 0.32623653122160196, 'f1-score': 0.331235377467295, 'support': 15406}, '1': {'precision': 0.34516235644055193, 'recall': 0.5180752774849631, 'f1-score': 0.41430094463590605, 'support': 16127}, '2': {'precision': 0.33773291925465837, 'recall': 0.17012123582323035, 'f1-score': 0.2262678803641092, 'support': 15342}, 'accuracy': 0.34114133333333335, 'macro avg': {'precision': 0.3397616918582455, 'recall': 0.33814434817659844, 'f1-score': 0.32393473415577007, 'support': 46875}, 'weighted avg': {'precision': 0.33984753123126893, 'recall': 0.34114133333333335, 'f1-score': 0.3254580347722788, 'support': 46875}}
[[5026 7949 2431]
 [5085 8355 2687]
 [4830 7902 2610]]
training model: results/PCAR/W9/deepLOB_L2/h10
Epoch 1/50
477/477 - 23s - loss: 3.2939 - accuracy10: 0.3806 - val_loss: 3.3707 - val_accuracy10: 0.3669 - 23s/epoch - 48ms/step
Epoch 2/50
477/477 - 20s - loss: 3.2380 - accuracy10: 0.4087 - val_loss: 3.2224 - val_accuracy10: 0.4109 - 20s/epoch - 42ms/step
Epoch 3/50
477/477 - 20s - loss: 3.1650 - accuracy10: 0.4414 - val_loss: 3.2330 - val_accuracy10: 0.4133 - 20s/epoch - 42ms/step
Epoch 4/50
477/477 - 20s - loss: 3.1106 - accuracy10: 0.4620 - val_loss: 3.1787 - val_accuracy10: 0.4359 - 20s/epoch - 43ms/step
Epoch 5/50
477/477 - 20s - loss: 3.0791 - accuracy10: 0.4730 - val_loss: 3.1826 - val_accuracy10: 0.4387 - 20s/epoch - 43ms/step
Epoch 6/50
477/477 - 20s - loss: 3.0521 - accuracy10: 0.4808 - val_loss: 3.1928 - val_accuracy10: 0.4356 - 20s/epoch - 42ms/step
Epoch 7/50
477/477 - 20s - loss: 3.0332 - accuracy10: 0.4855 - val_loss: 3.1832 - val_accuracy10: 0.4388 - 20s/epoch - 43ms/step
Epoch 8/50
477/477 - 20s - loss: 3.0180 - accuracy10: 0.4897 - val_loss: 3.1673 - val_accuracy10: 0.4440 - 20s/epoch - 42ms/step
Epoch 9/50
477/477 - 20s - loss: 3.0070 - accuracy10: 0.4937 - val_loss: 3.1721 - val_accuracy10: 0.4430 - 20s/epoch - 43ms/step
Epoch 10/50
477/477 - 20s - loss: 2.9956 - accuracy10: 0.4955 - val_loss: 3.1489 - val_accuracy10: 0.4482 - 20s/epoch - 43ms/step
Epoch 11/50
477/477 - 20s - loss: 2.9875 - accuracy10: 0.4974 - val_loss: 3.1539 - val_accuracy10: 0.4471 - 20s/epoch - 43ms/step
Epoch 12/50
477/477 - 20s - loss: 2.9783 - accuracy10: 0.4983 - val_loss: 3.1603 - val_accuracy10: 0.4503 - 20s/epoch - 43ms/step
Epoch 13/50
477/477 - 20s - loss: 2.9687 - accuracy10: 0.5021 - val_loss: 3.1441 - val_accuracy10: 0.4491 - 20s/epoch - 43ms/step
Epoch 14/50
477/477 - 20s - loss: 2.9627 - accuracy10: 0.5019 - val_loss: 3.1601 - val_accuracy10: 0.4442 - 20s/epoch - 42ms/step
Epoch 15/50
477/477 - 20s - loss: 2.9516 - accuracy10: 0.5069 - val_loss: 3.1491 - val_accuracy10: 0.4491 - 20s/epoch - 42ms/step
Epoch 16/50
477/477 - 20s - loss: 2.9473 - accuracy10: 0.5071 - val_loss: 3.1621 - val_accuracy10: 0.4467 - 20s/epoch - 43ms/step
Epoch 17/50
477/477 - 20s - loss: 2.9382 - accuracy10: 0.5084 - val_loss: 3.1562 - val_accuracy10: 0.4454 - 20s/epoch - 42ms/step
Epoch 18/50
477/477 - 20s - loss: 2.9303 - accuracy10: 0.5116 - val_loss: 3.1668 - val_accuracy10: 0.4446 - 20s/epoch - 43ms/step
Epoch 19/50
477/477 - 20s - loss: 2.9236 - accuracy10: 0.5129 - val_loss: 3.1523 - val_accuracy10: 0.4473 - 20s/epoch - 42ms/step
Epoch 20/50
477/477 - 20s - loss: 2.9181 - accuracy10: 0.5148 - val_loss: 3.1598 - val_accuracy10: 0.4434 - 20s/epoch - 42ms/step
Epoch 21/50
477/477 - 20s - loss: 2.9062 - accuracy10: 0.5182 - val_loss: 3.1699 - val_accuracy10: 0.4424 - 20s/epoch - 42ms/step
Epoch 22/50
477/477 - 20s - loss: 2.8975 - accuracy10: 0.5209 - val_loss: 3.1792 - val_accuracy10: 0.4393 - 20s/epoch - 43ms/step
Epoch 23/50
477/477 - 20s - loss: 2.8917 - accuracy10: 0.5215 - val_loss: 3.1831 - val_accuracy10: 0.4396 - 20s/epoch - 43ms/step
testing model: results/PCAR/W9/deepLOB_L2/h10
Evaluating performance on  test set...
631/631 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0618796
{'0': {'precision': 0.4996446013803224, 'recall': 0.3563066156512639, 'f1-score': 0.415973885903542, 'support': 61158}, '1': {'precision': 0.44863266814486324, 'recall': 0.03037733960564508, 'f1-score': 0.056901804546519795, 'support': 39964}, '2': {'precision': 0.4102653297271913, 'recall': 0.7838367726713854, 'f1-score': 0.5386156700442415, 'support': 60186}, 'accuracy': 0.4350745158330647, 'macro avg': {'precision': 0.4528475330841257, 'recall': 0.3901735759760981, 'f1-score': 0.3371637868314344, 'support': 161308}, 'weighted avg': {'precision': 0.4536579067121272, 'recall': 0.4350745158330647, 'f1-score': 0.3727730636314917, 'support': 161308}}
[[21791   896 38471]
 [ 9408  1214 29342]
 [12414   596 47176]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0354708
{'0': {'precision': 0.44720560100948425, 'recall': 0.5296357895244294, 'f1-score': 0.48494278368148663, 'support': 41487}, '1': {'precision': 0.588927380874567, 'recall': 0.23075347026584028, 'f1-score': 0.3315852424326065, 'support': 39046}, '2': {'precision': 0.4405892378865352, 'recall': 0.6119377747717281, 'f1-score': 0.5123159682899208, 'support': 41398}, 'accuracy': 0.46186777767753895, 'macro avg': {'precision': 0.49224073992352885, 'recall': 0.4574423448539992, 'f1-score': 0.4429479981346713, 'support': 121931}, 'weighted avg': {'precision': 0.49034282137221546, 'recall': 0.46186777767753895, 'f1-score': 0.4451267938250612, 'support': 121931}}
[[21973  3450 16064]
 [13935  9010 16101]
 [13226  2839 25333]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0437263
{'0': {'precision': 0.4436822046320727, 'recall': 0.48289725590299937, 'f1-score': 0.46245989304812835, 'support': 15670}, '1': {'precision': 0.5491455736862393, 'recall': 0.27013019845784353, 'f1-score': 0.36212666807879684, 'support': 15822}, '2': {'precision': 0.41838725779371055, 'recall': 0.5993629331079764, 'f1-score': 0.49278460716194555, 'support': 15383}, 'accuracy': 0.44930133333333333, 'macro avg': {'precision': 0.47040501203734086, 'recall': 0.45079679582293974, 'f1-score': 0.4391237227629569, 'support': 46875}, 'weighted avg': {'precision': 0.4709788288018967, 'recall': 0.44930133333333333, 'f1-score': 0.4385454992720876, 'support': 46875}}
[[7567 1835 6268]
 [4999 4274 6549]
 [4489 1674 9220]]
training model: results/PCAR/W9/deepLOB_L2/h20
Epoch 1/50
477/477 - 23s - loss: 3.3104 - accuracy20: 0.3715 - val_loss: 3.3613 - val_accuracy20: 0.3580 - 23s/epoch - 48ms/step
Epoch 2/50
477/477 - 21s - loss: 3.2503 - accuracy20: 0.3976 - val_loss: 3.2693 - val_accuracy20: 0.3946 - 21s/epoch - 44ms/step
Epoch 3/50
477/477 - 21s - loss: 3.2086 - accuracy20: 0.4211 - val_loss: 3.2821 - val_accuracy20: 0.4041 - 21s/epoch - 43ms/step
Epoch 4/50
477/477 - 21s - loss: 3.1670 - accuracy20: 0.4402 - val_loss: 3.2275 - val_accuracy20: 0.4137 - 21s/epoch - 43ms/step
Epoch 5/50
477/477 - 20s - loss: 3.1381 - accuracy20: 0.4507 - val_loss: 3.2347 - val_accuracy20: 0.4099 - 20s/epoch - 43ms/step
Epoch 6/50
477/477 - 20s - loss: 3.1172 - accuracy20: 0.4575 - val_loss: 3.2242 - val_accuracy20: 0.4121 - 20s/epoch - 43ms/step
Epoch 7/50
477/477 - 20s - loss: 3.1042 - accuracy20: 0.4620 - val_loss: 3.2355 - val_accuracy20: 0.4142 - 20s/epoch - 43ms/step
Epoch 8/50
477/477 - 20s - loss: 3.0913 - accuracy20: 0.4654 - val_loss: 3.2385 - val_accuracy20: 0.4095 - 20s/epoch - 43ms/step
Epoch 9/50
477/477 - 20s - loss: 3.0830 - accuracy20: 0.4670 - val_loss: 3.2477 - val_accuracy20: 0.4055 - 20s/epoch - 42ms/step
Epoch 10/50
477/477 - 20s - loss: 3.0749 - accuracy20: 0.4694 - val_loss: 3.2378 - val_accuracy20: 0.4084 - 20s/epoch - 43ms/step
Epoch 11/50
477/477 - 20s - loss: 3.0660 - accuracy20: 0.4720 - val_loss: 3.2564 - val_accuracy20: 0.4101 - 20s/epoch - 42ms/step
Epoch 12/50
477/477 - 20s - loss: 3.0565 - accuracy20: 0.4747 - val_loss: 3.2669 - val_accuracy20: 0.4127 - 20s/epoch - 42ms/step
Epoch 13/50
477/477 - 20s - loss: 3.0512 - accuracy20: 0.4762 - val_loss: 3.2595 - val_accuracy20: 0.4111 - 20s/epoch - 43ms/step
Epoch 14/50
477/477 - 20s - loss: 3.0418 - accuracy20: 0.4789 - val_loss: 3.2614 - val_accuracy20: 0.4075 - 20s/epoch - 43ms/step
Epoch 15/50
477/477 - 20s - loss: 3.0343 - accuracy20: 0.4818 - val_loss: 3.2680 - val_accuracy20: 0.4049 - 20s/epoch - 42ms/step
Epoch 16/50
477/477 - 20s - loss: 3.0272 - accuracy20: 0.4825 - val_loss: 3.2773 - val_accuracy20: 0.4017 - 20s/epoch - 42ms/step
testing model: results/PCAR/W9/deepLOB_L2/h20
Evaluating performance on  test set...
631/631 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0784351
{'0': {'precision': 0.4130870181535507, 'recall': 0.7557767924370451, 'f1-score': 0.5341966767192952, 'support': 59765}, '1': {'precision': 0.3718541820873427, 'recall': 0.09237169321289848, 'f1-score': 0.14798313603475893, 'support': 43509}, '2': {'precision': 0.4333616814481837, 'recall': 0.3073198469862494, 'f1-score': 0.35961648973172433, 'support': 58034}, 'accuracy': 0.4154970615220572, 'macro avg': {'precision': 0.4061009605630257, 'recall': 0.385156110878731, 'f1-score': 0.3472654341619261, 'support': 161308}, 'weighted avg': {'precision': 0.4092596837698628, 'recall': 0.4154970615220572, 'f1-score': 0.3672157984412174, 'support': 161308}}
[[45169  3272 11324]
 [27494  4019 11996]
 [36682  3517 17835]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0742003
{'0': {'precision': 0.3873473599724818, 'recall': 0.6669463501307932, 'f1-score': 0.49007198941012203, 'support': 40522}, '1': {'precision': 0.4646237515034252, 'recall': 0.217988665080105, 'f1-score': 0.2967502755418991, 'support': 40759}, '2': {'precision': 0.4400956532267829, 'recall': 0.3576629766297663, 'f1-score': 0.39462041636131695, 'support': 40650}, 'accuracy': 0.413758601176075, 'macro avg': {'precision': 0.4306889215675633, 'recall': 0.4141993306135548, 'f1-score': 0.393814227104446, 'support': 121931}, 'weighted avg': {'precision': 0.4307647563950246, 'recall': 0.413758601176075, 'f1-score': 0.3936264080568253, 'support': 121931}}
[[27026  5038  8458]
 [21835  8885 10039]
 [20911  5200 14539]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.074972
{'0': {'precision': 0.38521926307348164, 'recall': 0.5988845144356956, 'f1-score': 0.4688567539105643, 'support': 15240}, '1': {'precision': 0.469678953626635, 'recall': 0.3316540722082284, 'f1-score': 0.3887795275590551, 'support': 16674}, '2': {'precision': 0.4109396914446003, 'recall': 0.31334803823273844, 'f1-score': 0.35556903940232854, 'support': 14961}, 'accuracy': 0.41269333333333336, 'macro avg': {'precision': 0.42194596938157236, 'recall': 0.4146288749588875, 'f1-score': 0.40440177362398266, 'support': 46875}, 'weighted avg': {'precision': 0.42347172620187806, 'recall': 0.41269333333333336, 'f1-score': 0.4042145103064516, 'support': 46875}}
[[9127 3029 3084]
 [7508 5530 3636]
 [7058 3215 4688]]
training model: results/PCAR/W9/deepLOB_L2/h30
Epoch 1/50
477/477 - 22s - loss: 3.3171 - accuracy30: 0.3665 - val_loss: 3.3618 - val_accuracy30: 0.3552 - 22s/epoch - 47ms/step
Epoch 2/50
477/477 - 20s - loss: 3.2591 - accuracy30: 0.3899 - val_loss: 3.3337 - val_accuracy30: 0.3703 - 20s/epoch - 43ms/step
Epoch 3/50
477/477 - 20s - loss: 3.2315 - accuracy30: 0.4084 - val_loss: 3.2727 - val_accuracy30: 0.3892 - 20s/epoch - 43ms/step
Epoch 4/50
477/477 - 20s - loss: 3.1930 - accuracy30: 0.4290 - val_loss: 3.2525 - val_accuracy30: 0.4008 - 20s/epoch - 43ms/step
Epoch 5/50
477/477 - 20s - loss: 3.1766 - accuracy30: 0.4360 - val_loss: 3.2501 - val_accuracy30: 0.4030 - 20s/epoch - 43ms/step
Epoch 6/50
477/477 - 20s - loss: 3.1576 - accuracy30: 0.4429 - val_loss: 3.2594 - val_accuracy30: 0.4017 - 20s/epoch - 42ms/step
Epoch 7/50
477/477 - 20s - loss: 3.1430 - accuracy30: 0.4460 - val_loss: 3.2694 - val_accuracy30: 0.4004 - 20s/epoch - 43ms/step
Epoch 8/50
477/477 - 20s - loss: 3.1324 - accuracy30: 0.4508 - val_loss: 3.2669 - val_accuracy30: 0.3989 - 20s/epoch - 42ms/step
Epoch 9/50
477/477 - 20s - loss: 3.1229 - accuracy30: 0.4527 - val_loss: 3.2701 - val_accuracy30: 0.4003 - 20s/epoch - 42ms/step
Epoch 10/50
477/477 - 20s - loss: 3.1133 - accuracy30: 0.4563 - val_loss: 3.2743 - val_accuracy30: 0.3993 - 20s/epoch - 43ms/step
Epoch 11/50
477/477 - 20s - loss: 3.1074 - accuracy30: 0.4578 - val_loss: 3.2851 - val_accuracy30: 0.3957 - 20s/epoch - 42ms/step
Epoch 12/50
477/477 - 20s - loss: 3.1017 - accuracy30: 0.4587 - val_loss: 3.2727 - val_accuracy30: 0.4029 - 20s/epoch - 42ms/step
Epoch 13/50
477/477 - 20s - loss: 3.0950 - accuracy30: 0.4608 - val_loss: 3.2906 - val_accuracy30: 0.3977 - 20s/epoch - 42ms/step
Epoch 14/50
477/477 - 20s - loss: 3.0898 - accuracy30: 0.4618 - val_loss: 3.2908 - val_accuracy30: 0.4016 - 20s/epoch - 42ms/step
Epoch 15/50
477/477 - 20s - loss: 3.0825 - accuracy30: 0.4645 - val_loss: 3.3297 - val_accuracy30: 0.3968 - 20s/epoch - 42ms/step
testing model: results/PCAR/W9/deepLOB_L2/h30
Evaluating performance on  test set...
631/631 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.084081
{'0': {'precision': 0.40043904733696883, 'recall': 0.7642227763923525, 'f1-score': 0.5255167367843424, 'support': 60150}, '1': {'precision': 0.3378283184059575, 'recall': 0.07629025293729973, 'f1-score': 0.12447163515016685, 'support': 44003}, '2': {'precision': 0.42206851299997267, 'recall': 0.27010760213454643, 'f1-score': 0.3294072461912687, 'support': 57155}, 'accuracy': 0.4014865970689612, 'macro avg': {'precision': 0.386778626247633, 'recall': 0.3702068771547329, 'f1-score': 0.32646520604192597, 'support': 161308}, 'weighted avg': {'precision': 0.391023346967599, 'recall': 0.4014865970689612, 'f1-score': 0.3466302243853557, 'support': 161308}}
[[45968  3424 10758]
 [30265  3357 10381]
 [38561  3156 15438]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0759989
{'0': {'precision': 0.38778430486519055, 'recall': 0.6307111884171587, 'f1-score': 0.48027684242927365, 'support': 40819}, '1': {'precision': 0.4703358081874532, 'recall': 0.17334873095172346, 'f1-score': 0.25332941996551345, 'support': 39833}, '2': {'precision': 0.42344591287322564, 'recall': 0.4191477506722547, 'f1-score': 0.4212858690755914, 'support': 41279}, 'accuracy': 0.4096743240029197, 'macro avg': {'precision': 0.4271886753086231, 'recall': 0.40773589001371224, 'f1-score': 0.38496404382345945, 'support': 121931}, 'weighted avg': {'precision': 0.42682564421941027, 'recall': 0.4096743240029197, 'f1-score': 0.3861655412173947, 'support': 121931}}
[[25745  3886 11188]
 [20558  6905 12370]
 [20087  3890 17302]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0818422
{'0': {'precision': 0.38962820688709016, 'recall': 0.5525291828793775, 'f1-score': 0.45699573577922603, 'support': 15420}, '1': {'precision': 0.49563933986314235, 'recall': 0.2252439024390244, 'f1-score': 0.3097304322307467, 'support': 16400}, '2': {'precision': 0.38598689831956706, 'recall': 0.4500830288940551, 'f1-score': 0.41557804354492484, 'support': 15055}, 'accuracy': 0.40512, 'macro avg': {'precision': 0.4237514816899332, 'recall': 0.4092853714041523, 'f1-score': 0.39410140385163256, 'support': 46875}, 'weighted avg': {'precision': 0.42554847740065166, 'recall': 0.40512, 'f1-score': 0.39217025663720007, 'support': 46875}}
[[8520 1846 5054]
 [6981 3694 5725]
 [6366 1913 6776]]
training model: results/PCAR/W9/deepLOB_L2/h50
Epoch 1/50
477/477 - 23s - loss: 3.3090 - accuracy50: 0.3715 - val_loss: 3.3271 - val_accuracy50: 0.3528 - 23s/epoch - 47ms/step
Epoch 2/50
477/477 - 21s - loss: 3.2684 - accuracy50: 0.3823 - val_loss: 3.3581 - val_accuracy50: 0.3419 - 21s/epoch - 43ms/step
Epoch 3/50
477/477 - 20s - loss: 3.2357 - accuracy50: 0.4015 - val_loss: 3.2953 - val_accuracy50: 0.3602 - 20s/epoch - 43ms/step
Epoch 4/50
477/477 - 20s - loss: 3.2157 - accuracy50: 0.4108 - val_loss: 3.2630 - val_accuracy50: 0.3755 - 20s/epoch - 43ms/step
Epoch 5/50
477/477 - 20s - loss: 3.1965 - accuracy50: 0.4210 - val_loss: 3.2839 - val_accuracy50: 0.3685 - 20s/epoch - 42ms/step
Epoch 6/50
477/477 - 20s - loss: 3.1832 - accuracy50: 0.4290 - val_loss: 3.2508 - val_accuracy50: 0.3878 - 20s/epoch - 43ms/step
Epoch 7/50
477/477 - 20s - loss: 3.1709 - accuracy50: 0.4337 - val_loss: 3.2626 - val_accuracy50: 0.3866 - 20s/epoch - 43ms/step
Epoch 8/50
477/477 - 20s - loss: 3.1615 - accuracy50: 0.4353 - val_loss: 3.2575 - val_accuracy50: 0.3917 - 20s/epoch - 43ms/step
Epoch 9/50
477/477 - 20s - loss: 3.1517 - accuracy50: 0.4394 - val_loss: 3.2604 - val_accuracy50: 0.3908 - 20s/epoch - 42ms/step
Epoch 10/50
477/477 - 20s - loss: 3.1439 - accuracy50: 0.4438 - val_loss: 3.2547 - val_accuracy50: 0.3933 - 20s/epoch - 43ms/step
Epoch 11/50
477/477 - 20s - loss: 3.1351 - accuracy50: 0.4467 - val_loss: 3.2580 - val_accuracy50: 0.3936 - 20s/epoch - 42ms/step
Epoch 12/50
477/477 - 20s - loss: 3.1255 - accuracy50: 0.4502 - val_loss: 3.2629 - val_accuracy50: 0.3934 - 20s/epoch - 42ms/step
Epoch 13/50
477/477 - 20s - loss: 3.1200 - accuracy50: 0.4525 - val_loss: 3.2685 - val_accuracy50: 0.3958 - 20s/epoch - 43ms/step
Epoch 14/50
477/477 - 20s - loss: 3.1117 - accuracy50: 0.4546 - val_loss: 3.2698 - val_accuracy50: 0.3952 - 20s/epoch - 43ms/step
Epoch 15/50
477/477 - 20s - loss: 3.1036 - accuracy50: 0.4584 - val_loss: 3.2734 - val_accuracy50: 0.3978 - 20s/epoch - 42ms/step
Epoch 16/50
477/477 - 20s - loss: 3.0955 - accuracy50: 0.4619 - val_loss: 3.2893 - val_accuracy50: 0.3902 - 20s/epoch - 42ms/step
testing model: results/PCAR/W9/deepLOB_L2/h50
Evaluating performance on  test set...
631/631 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0763673
{'0': {'precision': 0.4209807546852677, 'recall': 0.6312357249744034, 'f1-score': 0.5051015585119456, 'support': 63485}, '1': {'precision': 0.3236883584778203, 'recall': 0.0731589393862283, 'f1-score': 0.11934412619344127, 'support': 39298}, '2': {'precision': 0.4033266939231925, 'recall': 0.3944297308842375, 'f1-score': 0.3988286007999377, 'support': 58525}, 'accuracy': 0.40935973417313465, 'macro avg': {'precision': 0.3826652690287602, 'recall': 0.3662747984149564, 'f1-score': 0.3410914285017748, 'support': 161308}, 'weighted avg': {'precision': 0.3908731314287601, 'recall': 0.40935973417313465, 'f1-score': 0.3725655378226565, 'support': 161308}}
[[40074  3069 20342]
 [22615  2875 13808]
 [32503  2938 23084]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0805312
{'0': {'precision': 0.3783192856546775, 'recall': 0.5597895880667786, 'f1-score': 0.45150238529186215, 'support': 40492}, '1': {'precision': 0.41520526106018335, 'recall': 0.31032171581769435, 'f1-score': 0.35518240709171495, 'support': 40284}, '2': {'precision': 0.4186410931427855, 'recall': 0.3245778155752643, 'f1-score': 0.3656570357089088, 'support': 41155}, 'accuracy': 0.39797918494886453, 'macro avg': {'precision': 0.4040552132858821, 'recall': 0.3982297064865791, 'f1-score': 0.390780609364162, 'support': 121931}, 'weighted avg': {'precision': 0.4041155033549218, 'recall': 0.39797918494886453, 'f1-score': 0.3907047262560044, 'support': 121931}}
[[22667  8538  9287]
 [18520 12501  9263]
 [18728  9069 13358]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0830463
{'0': {'precision': 0.3766273269254167, 'recall': 0.40945767195767196, 'f1-score': 0.3923569300969643, 'support': 15120}, '1': {'precision': 0.41983741673252795, 'recall': 0.43796007302279016, 'f1-score': 0.4287073065283182, 'support': 16981}, '2': {'precision': 0.35754146034740236, 'recall': 0.30790578042507105, 'f1-score': 0.33087245881368876, 'support': 14774}, 'accuracy': 0.387776, 'macro avg': {'precision': 0.384668734668449, 'recall': 0.3851078418018444, 'f1-score': 0.3839788984796571, 'support': 46875}, 'weighted avg': {'precision': 0.38626521369215744, 'recall': 0.387776, 'f1-score': 0.3861466722503874, 'support': 46875}}
[[6191 5042 3887]
 [5257 7437 4287]
 [4990 5235 4549]]
training model: results/PCAR/W9/deepLOB_L2/h100
Epoch 1/50
477/477 - 22s - loss: 3.3197 - accuracy100: 0.3644 - val_loss: 3.3455 - val_accuracy100: 0.3452 - 22s/epoch - 47ms/step
Epoch 2/50
477/477 - 20s - loss: 3.2893 - accuracy100: 0.3705 - val_loss: 3.3313 - val_accuracy100: 0.3338 - 20s/epoch - 42ms/step
Epoch 3/50
477/477 - 21s - loss: 3.2678 - accuracy100: 0.3817 - val_loss: 3.2942 - val_accuracy100: 0.3592 - 21s/epoch - 43ms/step
Epoch 4/50
477/477 - 20s - loss: 3.2607 - accuracy100: 0.3860 - val_loss: 3.2976 - val_accuracy100: 0.3553 - 20s/epoch - 42ms/step
Epoch 5/50
477/477 - 20s - loss: 3.2462 - accuracy100: 0.3957 - val_loss: 3.2952 - val_accuracy100: 0.3560 - 20s/epoch - 42ms/step
Epoch 6/50
477/477 - 20s - loss: 3.2294 - accuracy100: 0.4061 - val_loss: 3.2999 - val_accuracy100: 0.3549 - 20s/epoch - 43ms/step
Epoch 7/50
477/477 - 20s - loss: 3.2180 - accuracy100: 0.4096 - val_loss: 3.3077 - val_accuracy100: 0.3554 - 20s/epoch - 43ms/step
Epoch 8/50
477/477 - 20s - loss: 3.2084 - accuracy100: 0.4126 - val_loss: 3.3134 - val_accuracy100: 0.3545 - 20s/epoch - 42ms/step
Epoch 9/50
477/477 - 20s - loss: 3.1984 - accuracy100: 0.4176 - val_loss: 3.3203 - val_accuracy100: 0.3519 - 20s/epoch - 42ms/step
Epoch 10/50
477/477 - 20s - loss: 3.1879 - accuracy100: 0.4217 - val_loss: 3.3108 - val_accuracy100: 0.3620 - 20s/epoch - 42ms/step
Epoch 11/50
477/477 - 20s - loss: 3.1787 - accuracy100: 0.4263 - val_loss: 3.3398 - val_accuracy100: 0.3472 - 20s/epoch - 43ms/step
Epoch 12/50
477/477 - 20s - loss: 3.1709 - accuracy100: 0.4285 - val_loss: 3.3423 - val_accuracy100: 0.3502 - 20s/epoch - 42ms/step
Epoch 13/50
477/477 - 20s - loss: 3.1624 - accuracy100: 0.4313 - val_loss: 3.3371 - val_accuracy100: 0.3548 - 20s/epoch - 42ms/step
testing model: results/PCAR/W9/deepLOB_L2/h100
Evaluating performance on  test set...
631/631 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1132231
{'0': {'precision': 0.3883106811966858, 'recall': 0.15882077991452992, 'f1-score': 0.22543688170132103, 'support': 59904}, '1': {'precision': 0.29692942071339923, 'recall': 0.6371035282496188, 'f1-score': 0.40507089559880666, 'support': 46567}, '2': {'precision': 0.35081727250548916, 'recall': 0.23600853438371902, 'f1-score': 0.28218210361067503, 'support': 54837}, 'accuracy': 0.3231333845810499, 'macro avg': {'precision': 0.3453524581385248, 'recall': 0.34397761418262257, 'f1-score': 0.30422996030360094, 'support': 161308}, 'weighted avg': {'precision': 0.3491844307359253, 'recall': 0.3231333845810499, 'f1-score': 0.29658496399734763, 'support': 161308}}
[[ 9514 36681 13709]
 [ 6659 29668 10240]
 [ 8328 33567 12942]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0962459
{'0': {'precision': 0.3566223866375203, 'recall': 0.31591360476663355, 'f1-score': 0.3350359390221426, 'support': 40280}, '1': {'precision': 0.3655563601255129, 'recall': 0.5262857426528992, 'f1-score': 0.43143758266354665, 'support': 40288}, '2': {'precision': 0.3744822459022197, 'recall': 0.2557358025288301, 'f1-score': 0.30392185030886365, 'support': 41363}, 'accuracy': 0.36500971861134573, 'macro avg': {'precision': 0.36555366422175095, 'recall': 0.3659783833161209, 'f1-score': 0.35679845733151766, 'support': 121931}, 'weighted avg': {'precision': 0.3656329687097579, 'recall': 0.36500971861134573, 'f1-score': 0.3563337006051488, 'support': 121931}}
[[12725 18226  9329]
 [10745 21203  8340]
 [12212 18573 10578]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0987185
{'0': {'precision': 0.3584933861445333, 'recall': 0.30472621013848306, 'f1-score': 0.32943034714830205, 'support': 15742}, '1': {'precision': 0.36547705753823745, 'recall': 0.4745602421032722, 'f1-score': 0.412936142198815, 'support': 15861}, '2': {'precision': 0.33940615551593145, 'recall': 0.286668412781561, 'f1-score': 0.31081608746583367, 'support': 15272}, 'accuracy': 0.3563093333333333, 'macro avg': {'precision': 0.35445886639956736, 'recall': 0.35531828834110546, 'f1-score': 0.35106085893765027, 'support': 46875}, 'weighted avg': {'precision': 0.35463776642859807, 'recall': 0.3563093333333333, 'f1-score': 0.3516214605653801, 'support': 46875}}
[[4797 6545 4400]
 [4213 7527 4121]
 [4371 6523 4378]]
training model: results/PCAR/W9/deepLOB_L2/h200
Epoch 1/50
477/477 - 22s - loss: 3.3282 - accuracy200: 0.3606 - val_loss: 3.3478 - val_accuracy200: 0.3757 - 22s/epoch - 47ms/step
Epoch 2/50
477/477 - 20s - loss: 3.2862 - accuracy200: 0.3750 - val_loss: 3.3024 - val_accuracy200: 0.3802 - 20s/epoch - 43ms/step
Epoch 3/50
477/477 - 20s - loss: 3.2636 - accuracy200: 0.3872 - val_loss: 3.2834 - val_accuracy200: 0.3907 - 20s/epoch - 42ms/step
Epoch 4/50
477/477 - 20s - loss: 3.2441 - accuracy200: 0.4011 - val_loss: 3.3328 - val_accuracy200: 0.3665 - 20s/epoch - 43ms/step
Epoch 5/50
477/477 - 20s - loss: 3.2273 - accuracy200: 0.4099 - val_loss: 3.3434 - val_accuracy200: 0.3549 - 20s/epoch - 42ms/step
Epoch 6/50
477/477 - 20s - loss: 3.2101 - accuracy200: 0.4167 - val_loss: 3.3657 - val_accuracy200: 0.3617 - 20s/epoch - 43ms/step
Epoch 7/50
477/477 - 20s - loss: 3.1998 - accuracy200: 0.4219 - val_loss: 3.3911 - val_accuracy200: 0.3538 - 20s/epoch - 42ms/step
Epoch 8/50
477/477 - 21s - loss: 3.1881 - accuracy200: 0.4251 - val_loss: 3.4357 - val_accuracy200: 0.3496 - 21s/epoch - 43ms/step
Epoch 9/50
477/477 - 20s - loss: 3.1752 - accuracy200: 0.4296 - val_loss: 3.4628 - val_accuracy200: 0.3505 - 20s/epoch - 42ms/step
Epoch 10/50
477/477 - 20s - loss: 3.1671 - accuracy200: 0.4340 - val_loss: 3.4554 - val_accuracy200: 0.3473 - 20s/epoch - 43ms/step
Epoch 11/50
477/477 - 20s - loss: 3.1560 - accuracy200: 0.4392 - val_loss: 3.4558 - val_accuracy200: 0.3470 - 20s/epoch - 42ms/step
Epoch 12/50
477/477 - 20s - loss: 3.1445 - accuracy200: 0.4437 - val_loss: 3.4434 - val_accuracy200: 0.3542 - 20s/epoch - 43ms/step
Epoch 13/50
477/477 - 20s - loss: 3.1357 - accuracy200: 0.4480 - val_loss: 3.4600 - val_accuracy200: 0.3541 - 20s/epoch - 43ms/step
testing model: results/PCAR/W9/deepLOB_L2/h200
Evaluating performance on  test set...
631/631 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1199187
{'0': {'precision': 0.4714744381328723, 'recall': 0.0592801912865261, 'f1-score': 0.10531832726470264, 'support': 64406}, '1': {'precision': 0.2564321272933112, 'recall': 0.42637957710159874, 'f1-score': 0.3202564375708157, 'support': 38780}, '2': {'precision': 0.36272244700154405, 'recall': 0.5537318055125425, 'f1-score': 0.4383218364192276, 'support': 58122}, 'accuracy': 0.3256937039700449, 'macro avg': {'precision': 0.36354300414257584, 'recall': 0.3464638579668891, 'f1-score': 0.287965533751582, 'support': 161308}, 'weighted avg': {'precision': 0.38059100989066963, 'recall': 0.3256937039700449, 'f1-score': 0.2769783185655083, 'support': 161308}}
[[ 3818 24821 35767]
 [ 1467 16535 20778]
 [ 2813 23125 32184]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0983857
{'0': {'precision': 0.3583975812547241, 'recall': 0.29512523029427873, 'f1-score': 0.3236984748979397, 'support': 40166}, '1': {'precision': 0.3948038505330711, 'recall': 0.47447380206000894, 'f1-score': 0.4309879207674663, 'support': 40194}, '2': {'precision': 0.3653424083253187, 'recall': 0.3563782444492555, 'f1-score': 0.3608046564866905, 'support': 41571}, 'accuracy': 0.3751301965865941, 'macro avg': {'precision': 0.3728479467043713, 'recall': 0.3753257589345143, 'f1-score': 0.3718303507173655, 'support': 121931}, 'weighted avg': {'precision': 0.372766502968854, 'recall': 0.3751301965865941, 'f1-score': 0.37171688746000936, 'support': 121931}}
[[11854 14466 13846]
 [ 9233 19071 11890]
 [11988 14768 14815]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.094391
{'0': {'precision': 0.39105835367206565, 'recall': 0.22629517878924055, 'f1-score': 0.2866902525314139, 'support': 15577}, '1': {'precision': 0.42673791688534757, 'recall': 0.546298558514537, 'f1-score': 0.47917280544319735, 'support': 16372}, '2': {'precision': 0.337179032067211, 'recall': 0.3818169636875251, 'f1-score': 0.3581123539022245, 'support': 14926}, 'accuracy': 0.387584, 'macro avg': {'precision': 0.38499176754154146, 'recall': 0.3848035669971009, 'f1-score': 0.374658470625612, 'support': 46875}, 'weighted avg': {'precision': 0.38636380550467986, 'recall': 0.387584, 'f1-score': 0.37666082621317254, 'support': 46875}}
[[3525 6031 6021]
 [2246 8944 5182]
 [3243 5984 5699]]
training model: results/PCAR/W9/deepLOB_L2/h300
Epoch 1/50
477/477 - 22s - loss: 3.3245 - accuracy300: 0.3621 - val_loss: 3.3676 - val_accuracy300: 0.3452 - 22s/epoch - 47ms/step
Epoch 2/50
477/477 - 20s - loss: 3.2890 - accuracy300: 0.3745 - val_loss: 3.3519 - val_accuracy300: 0.3367 - 20s/epoch - 43ms/step
Epoch 3/50
477/477 - 20s - loss: 3.2616 - accuracy300: 0.3899 - val_loss: 3.3149 - val_accuracy300: 0.3553 - 20s/epoch - 43ms/step
Epoch 4/50
477/477 - 20s - loss: 3.2354 - accuracy300: 0.4058 - val_loss: 3.2937 - val_accuracy300: 0.3719 - 20s/epoch - 42ms/step
Epoch 5/50
477/477 - 21s - loss: 3.2223 - accuracy300: 0.4148 - val_loss: 3.3208 - val_accuracy300: 0.3629 - 21s/epoch - 44ms/step
Epoch 6/50
477/477 - 21s - loss: 3.2086 - accuracy300: 0.4222 - val_loss: 3.3456 - val_accuracy300: 0.3619 - 21s/epoch - 44ms/step
Epoch 7/50
477/477 - 20s - loss: 3.1967 - accuracy300: 0.4271 - val_loss: 3.3298 - val_accuracy300: 0.3647 - 20s/epoch - 43ms/step
Epoch 8/50
477/477 - 20s - loss: 3.1818 - accuracy300: 0.4331 - val_loss: 3.3277 - val_accuracy300: 0.3665 - 20s/epoch - 42ms/step
Epoch 9/50
477/477 - 20s - loss: 3.1662 - accuracy300: 0.4399 - val_loss: 3.3570 - val_accuracy300: 0.3504 - 20s/epoch - 42ms/step
Epoch 10/50
477/477 - 20s - loss: 3.1531 - accuracy300: 0.4447 - val_loss: 3.3933 - val_accuracy300: 0.3380 - 20s/epoch - 42ms/step
Epoch 11/50
477/477 - 20s - loss: 3.1426 - accuracy300: 0.4486 - val_loss: 3.4092 - val_accuracy300: 0.3368 - 20s/epoch - 42ms/step
Epoch 12/50
477/477 - 20s - loss: 3.1313 - accuracy300: 0.4508 - val_loss: 3.4259 - val_accuracy300: 0.3452 - 20s/epoch - 42ms/step
Epoch 13/50
477/477 - 20s - loss: 3.1196 - accuracy300: 0.4566 - val_loss: 3.4625 - val_accuracy300: 0.3343 - 20s/epoch - 42ms/step
Epoch 14/50
477/477 - 20s - loss: 3.1096 - accuracy300: 0.4600 - val_loss: 3.4657 - val_accuracy300: 0.3376 - 20s/epoch - 42ms/step
testing model: results/PCAR/W9/deepLOB_L2/h300
Evaluating performance on  test set...
631/631 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103659
{'0': {'precision': 0.35505405155686964, 'recall': 0.2574534369556479, 'f1-score': 0.29847761078100127, 'support': 59704}, '1': {'precision': 0.3412402935857887, 'recall': 0.40215619907233296, 'f1-score': 0.36920243986649787, 'support': 47862}, '2': {'precision': 0.3455445544554455, 'recall': 0.39613337799114284, 'f1-score': 0.3691136694639018, 'support': 53742}, 'accuracy': 0.3465916135591539, 'macro avg': {'precision': 0.34727963319936794, 'recall': 0.35191433800637456, 'f1-score': 0.34559790670380036, 'support': 161308}, 'weighted avg': {'precision': 0.34778712445321325, 'recall': 0.3465916135591539, 'f1-score': 0.3429958915570724, 'support': 161308}}
[[15371 19350 24983]
 [13276 19248 15338]
 [14645 17808 21289]]
Evaluating performance on  train set...
477/477 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0985118
{'0': {'precision': 0.33726824062958516, 'recall': 0.380702634880803, 'f1-score': 0.35767163334590724, 'support': 39850}, '1': {'precision': 0.38818114190068814, 'recall': 0.41432186988238795, 'f1-score': 0.4008257519383567, 'support': 40302}, '2': {'precision': 0.3730586744467038, 'recall': 0.302999114387611, 'f1-score': 0.33439877430262044, 'support': 41779}, 'accuracy': 0.36519014852662574, 'macro avg': {'precision': 0.36616935232565906, 'recall': 0.36600787305026733, 'f1-score': 0.36429871986229473, 'support': 121931}, 'weighted avg': {'precision': 0.36635994234181085, 'recall': 0.36519014852662574, 'f1-score': 0.3639610963171239, 'support': 121931}}
[[15171 13203 11476]
 [13806 16698  9798]
 [16005 13115 12659]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0957649
{'0': {'precision': 0.3521332105586249, 'recall': 0.29591178746453445, 'f1-score': 0.321583742116328, 'support': 15508}, '1': {'precision': 0.4264420679337286, 'recall': 0.46557773744706593, 'f1-score': 0.4451514012204645, 'support': 16530}, '2': {'precision': 0.32596859964547986, 'recall': 0.3470378108782099, 'f1-score': 0.33617340776287014, 'support': 14837}, 'accuracy': 0.37192533333333333, 'macro avg': {'precision': 0.3681812927126111, 'recall': 0.36950911192993674, 'f1-score': 0.36763618369988754, 'support': 46875}, 'weighted avg': {'precision': 0.37005579360485696, 'recall': 0.37192533333333333, 'f1-score': 0.36977660129902923, 'support': 46875}}
[[4589 5068 5851]
 [4038 7696 4796]
 [4405 5283 5149]]
training model: results/PCAR/W9/deepLOB_L2/h500
Epoch 1/50
477/477 - 23s - loss: 3.3320 - accuracy500: 0.3604 - val_loss: 3.4371 - val_accuracy500: 0.3297 - 23s/epoch - 48ms/step
Epoch 2/50
477/477 - 21s - loss: 3.2763 - accuracy500: 0.3847 - val_loss: 3.4389 - val_accuracy500: 0.3287 - 21s/epoch - 43ms/step
Epoch 3/50
477/477 - 20s - loss: 3.2424 - accuracy500: 0.4060 - val_loss: 3.4110 - val_accuracy500: 0.3422 - 20s/epoch - 43ms/step
Epoch 4/50
477/477 - 20s - loss: 3.2204 - accuracy500: 0.4199 - val_loss: 3.4140 - val_accuracy500: 0.3390 - 20s/epoch - 42ms/step
Epoch 5/50
477/477 - 20s - loss: 3.2002 - accuracy500: 0.4283 - val_loss: 3.4094 - val_accuracy500: 0.3389 - 20s/epoch - 43ms/step
Epoch 6/50
477/477 - 20s - loss: 3.1807 - accuracy500: 0.4377 - val_loss: 3.4544 - val_accuracy500: 0.3265 - 20s/epoch - 42ms/step
Epoch 7/50
477/477 - 20s - loss: 3.1658 - accuracy500: 0.4447 - val_loss: 3.4543 - val_accuracy500: 0.3286 - 20s/epoch - 43ms/step
Epoch 8/50
477/477 - 20s - loss: 3.1495 - accuracy500: 0.4510 - val_loss: 3.4942 - val_accuracy500: 0.3156 - 20s/epoch - 42ms/step
Epoch 9/50
477/477 - 20s - loss: 3.1367 - accuracy500: 0.4563 - val_loss: 3.5077 - val_accuracy500: 0.3161 - 20s/epoch - 42ms/step
Epoch 10/50
477/477 - 20s - loss: 3.1202 - accuracy500: 0.4625 - val_loss: 3.5466 - val_accuracy500: 0.3179 - 20s/epoch - 42ms/step
Epoch 11/50
477/477 - 20s - loss: 3.1078 - accuracy500: 0.4628 - val_loss: 3.5633 - val_accuracy500: 0.3150 - 20s/epoch - 42ms/step
Epoch 12/50
477/477 - 20s - loss: 3.0939 - accuracy500: 0.4693 - val_loss: 3.5282 - val_accuracy500: 0.3190 - 20s/epoch - 42ms/step
Epoch 13/50
477/477 - 20s - loss: 3.0841 - accuracy500: 0.4739 - val_loss: 3.5689 - val_accuracy500: 0.3191 - 20s/epoch - 42ms/step
Epoch 14/50
477/477 - 20s - loss: 3.0672 - accuracy500: 0.4773 - val_loss: 3.5604 - val_accuracy500: 0.3185 - 20s/epoch - 42ms/step
Epoch 15/50
477/477 - 20s - loss: 3.0599 - accuracy500: 0.4799 - val_loss: 3.5680 - val_accuracy500: 0.3164 - 20s/epoch - 42ms/step
testing model: results/PCAR/W9/deepLOB_L2/h500
Evaluating performance on  test set...
631/631 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1230937
{'0': {'precision': 0.37377902125362, 'recall': 0.1258116212599336, 'f1-score': 0.18825710754017308, 'support': 60527}, '1': {'precision': 0.305250529460012, 'recall': 0.5112879083024052, 'f1-score': 0.38227448335070835, 'support': 48769}, '2': {'precision': 0.3205846610856063, 'recall': 0.3651849573175421, 'f1-score': 0.3414344777997484, 'support': 52012}, 'accuracy': 0.3195377786594589, 'macro avg': {'precision': 0.3332047372664128, 'recall': 0.3340948289599603, 'f1-score': 0.3039886895635433, 'support': 161308}, 'weighted avg': {'precision': 0.3359085431785016, 'recall': 0.3195377786594589, 'f1-score': 0.2963056530732218, 'support': 161308}}
[[ 7615 30466 22446]
 [ 6026 24935 17808]
 [ 6732 26286 18994]]
Evaluating performance on  train set...
477/477 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1336839
{'0': {'precision': 0.32676925162689807, 'recall': 0.24265686743349021, 'f1-score': 0.27850075828699355, 'support': 39731}, '1': {'precision': 0.36279968708296906, 'recall': 0.39174182007900427, 'f1-score': 0.3767156833466726, 'support': 40251}, '2': {'precision': 0.3591749208618401, 'recall': 0.41924718110086057, 'f1-score': 0.38689310777218033, 'support': 41949}, 'accuracy': 0.3526256653353126, 'macro avg': {'precision': 0.34958128652390236, 'recall': 0.35121528953778497, 'f1-score': 0.34736984980194885, 'support': 121931}, 'weighted avg': {'precision': 0.34981217324878994, 'recall': 0.3526256653353126, 'f1-score': 0.3482139535952518, 'support': 121931}}
[[ 9641 13869 16221]
 [ 9326 15768 15157]
 [10537 13825 17587]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1338737
{'0': {'precision': 0.35307748008689355, 'recall': 0.15467580256312652, 'f1-score': 0.21511448361053515, 'support': 15762}, '1': {'precision': 0.37264450561084056, 'recall': 0.3301857294728285, 'f1-score': 0.35013262599469497, 'support': 15991}, '2': {'precision': 0.31801092980892215, 'recall': 0.5425869593969052, 'f1-score': 0.4009969943552526, 'support': 15122}, 'accuracy': 0.33969066666666664, 'macro avg': {'precision': 0.34791097183555214, 'recall': 0.34248283047762, 'f1-score': 0.32208136798682757, 'support': 46875}, 'weighted avg': {'precision': 0.34844003863302586, 'recall': 0.33969066666666664, 'f1-score': 0.3211409463805984, 'support': 46875}}
[[2438 4359 8965]
 [2080 5280 8631]
 [2387 4530 8205]]
training model: results/PCAR/W9/deepLOB_L2/h1000
Epoch 1/50
477/477 - 22s - loss: 3.3128 - accuracy1000: 0.3738 - val_loss: 3.5278 - val_accuracy1000: 0.3312 - 22s/epoch - 47ms/step
Epoch 2/50
477/477 - 20s - loss: 3.2518 - accuracy1000: 0.4049 - val_loss: 3.5993 - val_accuracy1000: 0.3272 - 20s/epoch - 42ms/step
Epoch 3/50
477/477 - 20s - loss: 3.2386 - accuracy1000: 0.4111 - val_loss: 3.5265 - val_accuracy1000: 0.3278 - 20s/epoch - 42ms/step
Epoch 4/50
477/477 - 20s - loss: 3.2052 - accuracy1000: 0.4298 - val_loss: 3.4985 - val_accuracy1000: 0.3228 - 20s/epoch - 43ms/step
Epoch 5/50
477/477 - 20s - loss: 3.1721 - accuracy1000: 0.4435 - val_loss: 3.6176 - val_accuracy1000: 0.3318 - 20s/epoch - 43ms/step
Epoch 6/50
477/477 - 20s - loss: 3.1469 - accuracy1000: 0.4548 - val_loss: 3.6550 - val_accuracy1000: 0.3291 - 20s/epoch - 42ms/step
Epoch 7/50
477/477 - 20s - loss: 3.1311 - accuracy1000: 0.4594 - val_loss: 3.7695 - val_accuracy1000: 0.3254 - 20s/epoch - 42ms/step
Epoch 8/50
477/477 - 20s - loss: 3.1076 - accuracy1000: 0.4672 - val_loss: 3.8133 - val_accuracy1000: 0.3208 - 20s/epoch - 43ms/step
Epoch 9/50
477/477 - 20s - loss: 3.0838 - accuracy1000: 0.4778 - val_loss: 3.9623 - val_accuracy1000: 0.3208 - 20s/epoch - 43ms/step
Epoch 10/50
477/477 - 20s - loss: 3.0675 - accuracy1000: 0.4841 - val_loss: 3.9412 - val_accuracy1000: 0.3204 - 20s/epoch - 43ms/step
Epoch 11/50
477/477 - 20s - loss: 3.0433 - accuracy1000: 0.4910 - val_loss: 3.9729 - val_accuracy1000: 0.3195 - 20s/epoch - 43ms/step
Epoch 12/50
477/477 - 20s - loss: 3.0331 - accuracy1000: 0.4929 - val_loss: 3.9988 - val_accuracy1000: 0.3186 - 20s/epoch - 42ms/step
Epoch 13/50
477/477 - 20s - loss: 3.0119 - accuracy1000: 0.5035 - val_loss: 3.9852 - val_accuracy1000: 0.3239 - 20s/epoch - 42ms/step
Epoch 14/50
477/477 - 20s - loss: 2.9963 - accuracy1000: 0.5042 - val_loss: 3.9764 - val_accuracy1000: 0.3211 - 20s/epoch - 42ms/step
testing model: results/PCAR/W9/deepLOB_L2/h1000
Evaluating performance on  test set...
631/631 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1468906
{'0': {'precision': 0.3786955540510043, 'recall': 0.05481152413928268, 'f1-score': 0.0957625909544871, 'support': 61228}, '1': {'precision': 0.30078334934775175, 'recall': 0.3812994198649792, 'f1-score': 0.3362891478514203, 'support': 48437}, '2': {'precision': 0.31856375558801886, 'recall': 0.5616056387119261, 'f1-score': 0.40652902176807815, 'support': 51643}, 'accuracy': 0.3150990651424604, 'macro avg': {'precision': 0.33268088632892495, 'recall': 0.33257219423872936, 'f1-score': 0.27952692019132847, 'support': 161308}, 'weighted avg': {'precision': 0.33604906455739336, 'recall': 0.3150990651424604, 'f1-score': 0.2674794036539381, 'support': 161308}}
[[ 3356 23163 34709]
 [ 2637 18469 27331]
 [ 2869 19771 29003]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1449398
{'0': {'precision': 0.31538728725251824, 'recall': 0.13663381235422467, 'f1-score': 0.1906661767021891, 'support': 39873}, '1': {'precision': 0.33423815128876505, 'recall': 0.3489141882742364, 'f1-score': 0.34141852846994736, 'support': 39878}, '2': {'precision': 0.35836453639652216, 'recall': 0.5354907539118066, 'f1-score': 0.4293779940688921, 'support': 42180}, 'accuracy': 0.3440388416399439, 'macro avg': {'precision': 0.3359966583126018, 'recall': 0.34034625151342257, 'f1-score': 0.3204875664136762, 'support': 121931}, 'weighted avg': {'precision': 0.33641979846731623, 'recall': 0.3440388416399439, 'f1-score': 0.3225486900935514, 'support': 121931}}
[[ 5448 13961 20464]
 [ 5987 13914 19977]
 [ 5839 13754 22587]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1628773
{'0': {'precision': 0.3346625766871166, 'recall': 0.07083035772252158, 'f1-score': 0.11691582275089749, 'support': 15403}, '1': {'precision': 0.3340887491775715, 'recall': 0.28367473618870265, 'f1-score': 0.30682466682332404, 'support': 16110}, '2': {'precision': 0.31547300908605025, 'recall': 0.614763702642885, 'f1-score': 0.41697205174621393, 'support': 15362}, 'accuracy': 0.32224, 'macro avg': {'precision': 0.32807477831691273, 'recall': 0.32308959885136973, 'f1-score': 0.2802375137734785, 'support': 46875}, 'weighted avg': {'precision': 0.3281765073822344, 'recall': 0.32224, 'f1-score': 0.28051892179799814, 'support': 46875}}
[[ 1091  4437  9875]
 [  923  4570 10617]
 [ 1246  4672  9444]]
training model: results/PCAR/W9/deepOF_L2/h10
Epoch 1/50
477/477 - 13s - loss: 3.2739 - accuracy10: 0.3872 - val_loss: 3.2151 - val_accuracy10: 0.4155 - 13s/epoch - 28ms/step
Epoch 2/50
477/477 - 12s - loss: 3.1716 - accuracy10: 0.4330 - val_loss: 3.1641 - val_accuracy10: 0.4352 - 12s/epoch - 24ms/step
Epoch 3/50
477/477 - 11s - loss: 3.1081 - accuracy10: 0.4579 - val_loss: 3.1245 - val_accuracy10: 0.4546 - 11s/epoch - 24ms/step
Epoch 4/50
477/477 - 11s - loss: 3.0578 - accuracy10: 0.4750 - val_loss: 3.1072 - val_accuracy10: 0.4589 - 11s/epoch - 24ms/step
Epoch 5/50
477/477 - 12s - loss: 3.0291 - accuracy10: 0.4837 - val_loss: 3.0791 - val_accuracy10: 0.4694 - 12s/epoch - 24ms/step
Epoch 6/50
477/477 - 11s - loss: 3.0059 - accuracy10: 0.4904 - val_loss: 3.0754 - val_accuracy10: 0.4698 - 11s/epoch - 24ms/step
Epoch 7/50
477/477 - 11s - loss: 2.9854 - accuracy10: 0.4959 - val_loss: 3.0510 - val_accuracy10: 0.4799 - 11s/epoch - 24ms/step
Epoch 8/50
477/477 - 11s - loss: 2.9701 - accuracy10: 0.5020 - val_loss: 3.0322 - val_accuracy10: 0.4834 - 11s/epoch - 24ms/step
Epoch 9/50
477/477 - 11s - loss: 2.9577 - accuracy10: 0.5046 - val_loss: 3.0290 - val_accuracy10: 0.4855 - 11s/epoch - 24ms/step
Epoch 10/50
477/477 - 11s - loss: 2.9442 - accuracy10: 0.5084 - val_loss: 3.0182 - val_accuracy10: 0.4896 - 11s/epoch - 24ms/step
Epoch 11/50
477/477 - 11s - loss: 2.9340 - accuracy10: 0.5119 - val_loss: 3.0141 - val_accuracy10: 0.4883 - 11s/epoch - 24ms/step
Epoch 12/50
477/477 - 11s - loss: 2.9252 - accuracy10: 0.5149 - val_loss: 3.0027 - val_accuracy10: 0.4905 - 11s/epoch - 24ms/step
Epoch 13/50
477/477 - 12s - loss: 2.9160 - accuracy10: 0.5175 - val_loss: 3.0064 - val_accuracy10: 0.4912 - 12s/epoch - 25ms/step
Epoch 14/50
477/477 - 11s - loss: 2.9083 - accuracy10: 0.5195 - val_loss: 3.0002 - val_accuracy10: 0.4902 - 11s/epoch - 24ms/step
Epoch 15/50
477/477 - 11s - loss: 2.8989 - accuracy10: 0.5213 - val_loss: 2.9958 - val_accuracy10: 0.4941 - 11s/epoch - 24ms/step
Epoch 16/50
477/477 - 11s - loss: 2.8921 - accuracy10: 0.5251 - val_loss: 2.9897 - val_accuracy10: 0.4947 - 11s/epoch - 24ms/step
Epoch 17/50
477/477 - 11s - loss: 2.8813 - accuracy10: 0.5279 - val_loss: 2.9951 - val_accuracy10: 0.4947 - 11s/epoch - 23ms/step
Epoch 18/50
477/477 - 11s - loss: 2.8745 - accuracy10: 0.5297 - val_loss: 2.9943 - val_accuracy10: 0.4944 - 11s/epoch - 24ms/step
Epoch 19/50
477/477 - 11s - loss: 2.8675 - accuracy10: 0.5309 - val_loss: 2.9968 - val_accuracy10: 0.4931 - 11s/epoch - 24ms/step
Epoch 20/50
477/477 - 11s - loss: 2.8602 - accuracy10: 0.5337 - val_loss: 2.9928 - val_accuracy10: 0.4946 - 11s/epoch - 24ms/step
Epoch 21/50
477/477 - 11s - loss: 2.8537 - accuracy10: 0.5343 - val_loss: 3.0009 - val_accuracy10: 0.4921 - 11s/epoch - 24ms/step
Epoch 22/50
477/477 - 11s - loss: 2.8460 - accuracy10: 0.5360 - val_loss: 2.9967 - val_accuracy10: 0.4945 - 11s/epoch - 24ms/step
Epoch 23/50
477/477 - 11s - loss: 2.8390 - accuracy10: 0.5375 - val_loss: 3.0064 - val_accuracy10: 0.4910 - 11s/epoch - 24ms/step
Epoch 24/50
477/477 - 11s - loss: 2.8315 - accuracy10: 0.5406 - val_loss: 3.0063 - val_accuracy10: 0.4932 - 11s/epoch - 24ms/step
Epoch 25/50
477/477 - 11s - loss: 2.8248 - accuracy10: 0.5425 - val_loss: 3.0196 - val_accuracy10: 0.4899 - 11s/epoch - 24ms/step
Epoch 26/50
477/477 - 11s - loss: 2.8169 - accuracy10: 0.5443 - val_loss: 3.0093 - val_accuracy10: 0.4937 - 11s/epoch - 24ms/step
testing model: results/PCAR/W9/deepOF_L2/h10
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0322831
{'0': {'precision': 0.47989088193608365, 'recall': 0.5148879114410452, 'f1-score': 0.4967737864230836, 'support': 61157}, '1': {'precision': 0.4139087934390921, 'recall': 0.2500563020794235, 'f1-score': 0.3117648894019281, 'support': 39963}, '2': {'precision': 0.4766437437101644, 'recall': 0.5666123886747308, 'f1-score': 0.5177486942791206, 'support': 60184}, 'accuracy': 0.4685748648514606, 'macro avg': {'precision': 0.4568144730284467, 'recall': 0.44385220073173315, 'f1-score': 0.44209579003471083, 'support': 161304}, 'weighted avg': {'precision': 0.4623323094915442, 'recall': 0.4685748648514606, 'f1-score': 0.4587638381437557, 'support': 161304}}
[[31489  6922 22746]
 [15273  9993 14697]
 [18855  7228 34101]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9788456
{'0': {'precision': 0.47748463760249676, 'recall': 0.5922577542678529, 'f1-score': 0.5287141676594008, 'support': 41590}, '1': {'precision': 0.6011154118283598, 'recall': 0.37076113464253624, 'f1-score': 0.45863897621542665, 'support': 38955}, '2': {'precision': 0.49880173586372173, 'recall': 0.5582322524525202, 'f1-score': 0.526846288040318, 'support': 41386}, 'accuracy': 0.509944148739861, 'macro avg': {'precision': 0.5258005950981928, 'recall': 0.5070837137876364, 'f1-score': 0.5047331439717152, 'support': 121931}, 'weighted avg': {'precision': 0.5242181691786141, 'recall': 0.509944148739861, 'f1-score': 0.5056922688099256, 'support': 121931}}
[[24632  4500 12458]
 [13756 14443 10756]
 [13199  5084 23103]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9953895
{'0': {'precision': 0.4579665020399399, 'recall': 0.5461587708066581, 'f1-score': 0.4981896753095072, 'support': 15620}, '1': {'precision': 0.5853121409421678, 'recall': 0.3883242281793927, 'f1-score': 0.46689070495684715, 'support': 15742}, '2': {'precision': 0.4755940010110655, 'recall': 0.5458002965254948, 'f1-score': 0.5082843078400769, 'support': 15513}, 'accuracy': 0.4930346666666667, 'macro avg': {'precision': 0.5062908813310577, 'recall': 0.4934277651705152, 'f1-score': 0.49112156270214374, 'support': 46875}, 'weighted avg': {'precision': 0.5065666180748827, 'recall': 0.4930346666666667, 'f1-score': 0.4910193210301505, 'support': 46875}}
[[8531 2131 4958]
 [5251 6113 4378]
 [4846 2200 8467]]
training model: results/PCAR/W9/deepOF_L2/h20
Epoch 1/50
477/477 - 13s - loss: 3.3093 - accuracy20: 0.3661 - val_loss: 3.2594 - val_accuracy20: 0.3804 - 13s/epoch - 28ms/step
Epoch 2/50
477/477 - 11s - loss: 3.2310 - accuracy20: 0.4059 - val_loss: 3.2247 - val_accuracy20: 0.3969 - 11s/epoch - 24ms/step
Epoch 3/50
477/477 - 11s - loss: 3.1924 - accuracy20: 0.4245 - val_loss: 3.2092 - val_accuracy20: 0.4065 - 11s/epoch - 24ms/step
Epoch 4/50
477/477 - 11s - loss: 3.1603 - accuracy20: 0.4385 - val_loss: 3.2060 - val_accuracy20: 0.4066 - 11s/epoch - 24ms/step
Epoch 5/50
477/477 - 11s - loss: 3.1392 - accuracy20: 0.4470 - val_loss: 3.1935 - val_accuracy20: 0.4151 - 11s/epoch - 24ms/step
Epoch 6/50
477/477 - 11s - loss: 3.1197 - accuracy20: 0.4537 - val_loss: 3.1866 - val_accuracy20: 0.4214 - 11s/epoch - 24ms/step
Epoch 7/50
477/477 - 11s - loss: 3.1061 - accuracy20: 0.4589 - val_loss: 3.1938 - val_accuracy20: 0.4116 - 11s/epoch - 24ms/step
Epoch 8/50
477/477 - 11s - loss: 3.0933 - accuracy20: 0.4628 - val_loss: 3.1850 - val_accuracy20: 0.4170 - 11s/epoch - 24ms/step
Epoch 9/50
477/477 - 11s - loss: 3.0850 - accuracy20: 0.4658 - val_loss: 3.1784 - val_accuracy20: 0.4212 - 11s/epoch - 24ms/step
Epoch 10/50
477/477 - 11s - loss: 3.0734 - accuracy20: 0.4690 - val_loss: 3.1757 - val_accuracy20: 0.4257 - 11s/epoch - 24ms/step
Epoch 11/50
477/477 - 11s - loss: 3.0651 - accuracy20: 0.4715 - val_loss: 3.1543 - val_accuracy20: 0.4367 - 11s/epoch - 24ms/step
Epoch 12/50
477/477 - 11s - loss: 3.0578 - accuracy20: 0.4735 - val_loss: 3.1616 - val_accuracy20: 0.4332 - 11s/epoch - 24ms/step
Epoch 13/50
477/477 - 12s - loss: 3.0482 - accuracy20: 0.4768 - val_loss: 3.1672 - val_accuracy20: 0.4296 - 12s/epoch - 25ms/step
Epoch 14/50
477/477 - 12s - loss: 3.0399 - accuracy20: 0.4809 - val_loss: 3.1472 - val_accuracy20: 0.4379 - 12s/epoch - 24ms/step
Epoch 15/50
477/477 - 12s - loss: 3.0344 - accuracy20: 0.4822 - val_loss: 3.1491 - val_accuracy20: 0.4400 - 12s/epoch - 24ms/step
Epoch 16/50
477/477 - 12s - loss: 3.0244 - accuracy20: 0.4848 - val_loss: 3.1411 - val_accuracy20: 0.4419 - 12s/epoch - 24ms/step
Epoch 17/50
477/477 - 12s - loss: 3.0151 - accuracy20: 0.4888 - val_loss: 3.1298 - val_accuracy20: 0.4465 - 12s/epoch - 24ms/step
Epoch 18/50
477/477 - 12s - loss: 3.0079 - accuracy20: 0.4910 - val_loss: 3.1512 - val_accuracy20: 0.4395 - 12s/epoch - 24ms/step
Epoch 19/50
477/477 - 12s - loss: 3.0022 - accuracy20: 0.4921 - val_loss: 3.1337 - val_accuracy20: 0.4460 - 12s/epoch - 24ms/step
Epoch 20/50
477/477 - 11s - loss: 2.9919 - accuracy20: 0.4964 - val_loss: 3.1343 - val_accuracy20: 0.4466 - 11s/epoch - 24ms/step
Epoch 21/50
477/477 - 12s - loss: 2.9852 - accuracy20: 0.4988 - val_loss: 3.1260 - val_accuracy20: 0.4504 - 12s/epoch - 24ms/step
Epoch 22/50
477/477 - 11s - loss: 2.9783 - accuracy20: 0.5010 - val_loss: 3.1277 - val_accuracy20: 0.4503 - 11s/epoch - 24ms/step
Epoch 23/50
477/477 - 11s - loss: 2.9691 - accuracy20: 0.5027 - val_loss: 3.1338 - val_accuracy20: 0.4496 - 11s/epoch - 24ms/step
Epoch 24/50
477/477 - 11s - loss: 2.9614 - accuracy20: 0.5052 - val_loss: 3.1419 - val_accuracy20: 0.4461 - 11s/epoch - 24ms/step
Epoch 25/50
477/477 - 11s - loss: 2.9527 - accuracy20: 0.5087 - val_loss: 3.1587 - val_accuracy20: 0.4441 - 11s/epoch - 23ms/step
Epoch 26/50
477/477 - 11s - loss: 2.9455 - accuracy20: 0.5096 - val_loss: 3.1571 - val_accuracy20: 0.4457 - 11s/epoch - 24ms/step
Epoch 27/50
477/477 - 11s - loss: 2.9391 - accuracy20: 0.5122 - val_loss: 3.1444 - val_accuracy20: 0.4512 - 11s/epoch - 24ms/step
Epoch 28/50
477/477 - 11s - loss: 2.9306 - accuracy20: 0.5153 - val_loss: 3.1550 - val_accuracy20: 0.4447 - 11s/epoch - 24ms/step
Epoch 29/50
477/477 - 11s - loss: 2.9194 - accuracy20: 0.5188 - val_loss: 3.1685 - val_accuracy20: 0.4438 - 11s/epoch - 24ms/step
Epoch 30/50
477/477 - 11s - loss: 2.9123 - accuracy20: 0.5215 - val_loss: 3.1774 - val_accuracy20: 0.4429 - 11s/epoch - 24ms/step
Epoch 31/50
477/477 - 11s - loss: 2.9019 - accuracy20: 0.5222 - val_loss: 3.1643 - val_accuracy20: 0.4455 - 11s/epoch - 24ms/step
testing model: results/PCAR/W9/deepOF_L2/h20
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0712482
{'0': {'precision': 0.4462058874854021, 'recall': 0.5562044039890235, 'f1-score': 0.4951698557287671, 'support': 59764}, '1': {'precision': 0.36073243992606285, 'recall': 0.14353352180008733, 'f1-score': 0.20535670245474422, 'support': 43509}, '2': {'precision': 0.43636232822505217, 'recall': 0.5225655253226724, 'f1-score': 0.4755892915954394, 'support': 58031}, 'accuracy': 0.43279149928086097, 'macro avg': {'precision': 0.41443355187883907, 'recall': 0.4074344837039277, 'f1-score': 0.3920386165929835, 'support': 161304}, 'weighted avg': {'precision': 0.41960954878768436, 'recall': 0.43279149928086097, 'f1-score': 0.4099533688281285, 'support': 161304}}
[[33241  5420 21103]
 [19197  6245 18067]
 [22059  5647 30325]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0124755
{'0': {'precision': 0.4528573182065265, 'recall': 0.6380728844966028, 'f1-score': 0.5297423695438136, 'support': 40475}, '1': {'precision': 0.5608413603302536, 'recall': 0.27933617271258626, 'f1-score': 0.3729289892487173, 'support': 40854}, '2': {'precision': 0.479261121335907, 'recall': 0.5259100536919363, 'f1-score': 0.5015031236788952, 'support': 40602}, 'accuracy': 0.48052587118944323, 'macro avg': {'precision': 0.49765326662422904, 'recall': 0.4811063703003751, 'f1-score': 0.46805816082380874, 'support': 121931}, 'weighted avg': {'precision': 0.49783051839008813, 'recall': 0.48052587118944323, 'f1-score': 0.46779730471876274, 'support': 121931}}
[[25826  3989 10660]
 [16901 11412 12541]
 [14302  4947 21353]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0438708
{'0': {'precision': 0.4175896998958629, 'recall': 0.5806239304988812, 'f1-score': 0.48579295154185026, 'support': 15194}, '1': {'precision': 0.5435100754249691, 'recall': 0.28950050968399593, 'f1-score': 0.3777777777777778, 'support': 16677}, '2': {'precision': 0.4401162101268825, 'recall': 0.4947347374033591, 'f1-score': 0.465829934107311, 'support': 15004}, 'accuracy': 0.4495573333333333, 'macro avg': {'precision': 0.4670719951492382, 'recall': 0.45495305919541207, 'f1-score': 0.44313355447564634, 'support': 46875}, 'weighted avg': {'precision': 0.46959955295623884, 'recall': 0.4495573333333333, 'f1-score': 0.44097387599088994, 'support': 46875}}
[[8822 1919 4453]
 [6859 4828 4990]
 [5445 2136 7423]]
training model: results/PCAR/W9/deepOF_L2/h30
Epoch 1/50
477/477 - 13s - loss: 3.3159 - accuracy30: 0.3600 - val_loss: 3.2762 - val_accuracy30: 0.3736 - 13s/epoch - 28ms/step
Epoch 2/50
477/477 - 11s - loss: 3.2472 - accuracy30: 0.3972 - val_loss: 3.2450 - val_accuracy30: 0.3905 - 11s/epoch - 24ms/step
Epoch 3/50
477/477 - 11s - loss: 3.2166 - accuracy30: 0.4148 - val_loss: 3.2298 - val_accuracy30: 0.4000 - 11s/epoch - 24ms/step
Epoch 4/50
477/477 - 11s - loss: 3.1901 - accuracy30: 0.4262 - val_loss: 3.2290 - val_accuracy30: 0.4036 - 11s/epoch - 24ms/step
Epoch 5/50
477/477 - 11s - loss: 3.1737 - accuracy30: 0.4318 - val_loss: 3.2227 - val_accuracy30: 0.4097 - 11s/epoch - 24ms/step
Epoch 6/50
477/477 - 11s - loss: 3.1567 - accuracy30: 0.4387 - val_loss: 3.2211 - val_accuracy30: 0.4094 - 11s/epoch - 24ms/step
Epoch 7/50
477/477 - 11s - loss: 3.1456 - accuracy30: 0.4430 - val_loss: 3.2175 - val_accuracy30: 0.4098 - 11s/epoch - 24ms/step
Epoch 8/50
477/477 - 11s - loss: 3.1343 - accuracy30: 0.4472 - val_loss: 3.2128 - val_accuracy30: 0.4138 - 11s/epoch - 24ms/step
Epoch 9/50
477/477 - 11s - loss: 3.1264 - accuracy30: 0.4504 - val_loss: 3.2036 - val_accuracy30: 0.4201 - 11s/epoch - 24ms/step
Epoch 10/50
477/477 - 11s - loss: 3.1145 - accuracy30: 0.4558 - val_loss: 3.2171 - val_accuracy30: 0.4102 - 11s/epoch - 24ms/step
Epoch 11/50
477/477 - 11s - loss: 3.1093 - accuracy30: 0.4554 - val_loss: 3.1931 - val_accuracy30: 0.4232 - 11s/epoch - 24ms/step
Epoch 12/50
477/477 - 11s - loss: 3.1013 - accuracy30: 0.4596 - val_loss: 3.1961 - val_accuracy30: 0.4237 - 11s/epoch - 24ms/step
Epoch 13/50
477/477 - 11s - loss: 3.0933 - accuracy30: 0.4618 - val_loss: 3.1977 - val_accuracy30: 0.4217 - 11s/epoch - 24ms/step
Epoch 14/50
477/477 - 11s - loss: 3.0872 - accuracy30: 0.4649 - val_loss: 3.1941 - val_accuracy30: 0.4245 - 11s/epoch - 24ms/step
Epoch 15/50
477/477 - 11s - loss: 3.0794 - accuracy30: 0.4671 - val_loss: 3.2016 - val_accuracy30: 0.4214 - 11s/epoch - 24ms/step
Epoch 16/50
477/477 - 12s - loss: 3.0746 - accuracy30: 0.4695 - val_loss: 3.2012 - val_accuracy30: 0.4214 - 12s/epoch - 24ms/step
Epoch 17/50
477/477 - 12s - loss: 3.0661 - accuracy30: 0.4730 - val_loss: 3.1927 - val_accuracy30: 0.4233 - 12s/epoch - 24ms/step
Epoch 18/50
477/477 - 11s - loss: 3.0579 - accuracy30: 0.4755 - val_loss: 3.2024 - val_accuracy30: 0.4220 - 11s/epoch - 24ms/step
Epoch 19/50
477/477 - 11s - loss: 3.0503 - accuracy30: 0.4790 - val_loss: 3.2028 - val_accuracy30: 0.4233 - 11s/epoch - 24ms/step
Epoch 20/50
477/477 - 12s - loss: 3.0440 - accuracy30: 0.4819 - val_loss: 3.1973 - val_accuracy30: 0.4245 - 12s/epoch - 24ms/step
Epoch 21/50
477/477 - 11s - loss: 3.0338 - accuracy30: 0.4848 - val_loss: 3.2048 - val_accuracy30: 0.4275 - 11s/epoch - 24ms/step
Epoch 22/50
477/477 - 12s - loss: 3.0273 - accuracy30: 0.4878 - val_loss: 3.2087 - val_accuracy30: 0.4253 - 12s/epoch - 24ms/step
Epoch 23/50
477/477 - 12s - loss: 3.0204 - accuracy30: 0.4894 - val_loss: 3.2197 - val_accuracy30: 0.4202 - 12s/epoch - 24ms/step
Epoch 24/50
477/477 - 12s - loss: 3.0113 - accuracy30: 0.4926 - val_loss: 3.2258 - val_accuracy30: 0.4225 - 12s/epoch - 24ms/step
Epoch 25/50
477/477 - 12s - loss: 3.0050 - accuracy30: 0.4940 - val_loss: 3.2245 - val_accuracy30: 0.4250 - 12s/epoch - 24ms/step
Epoch 26/50
477/477 - 12s - loss: 2.9984 - accuracy30: 0.4972 - val_loss: 3.2331 - val_accuracy30: 0.4250 - 12s/epoch - 24ms/step
Epoch 27/50
477/477 - 12s - loss: 2.9880 - accuracy30: 0.4996 - val_loss: 3.2517 - val_accuracy30: 0.4165 - 12s/epoch - 24ms/step
testing model: results/PCAR/W9/deepOF_L2/h30
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0821832
{'0': {'precision': 0.4396846219015605, 'recall': 0.5349548620924703, 'f1-score': 0.4826634466103156, 'support': 60149}, '1': {'precision': 0.32813880126182965, 'recall': 0.11819648660318614, 'f1-score': 0.17379245818923028, 'support': 44003}, '2': {'precision': 0.4182809386761125, 'recall': 0.5289403695408734, 'f1-score': 0.467146742489801, 'support': 57152}, 'accuracy': 0.4191340574319298, 'macro avg': {'precision': 0.39536812061316756, 'recall': 0.39403057274551, 'f1-score': 0.3745342157631157, 'support': 161304}, 'weighted avg': {'precision': 0.4016718382798842, 'recall': 0.4191340574319298, 'f1-score': 0.3929070811302986, 'support': 161304}}
[[32177  5464 22508]
 [19268  5201 19534]
 [21737  5185 30230]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0350965
{'0': {'precision': 0.44139298336350313, 'recall': 0.6269712998334802, 'f1-score': 0.5180643660019627, 'support': 40836}, '1': {'precision': 0.5080817684811029, 'recall': 0.215435785017764, 'f1-score': 0.3025745377333451, 'support': 39687}, '2': {'precision': 0.4610386852944923, 'recall': 0.5243914219474498, 'f1-score': 0.4906785980611484, 'support': 41408}, 'accuracy': 0.4581853671338708, 'macro avg': {'precision': 0.4701711457130328, 'recall': 0.4555995022662313, 'f1-score': 0.4371058339321521, 'support': 121931}, 'weighted avg': {'precision': 0.4697710581805765, 'recall': 0.4581853671338708, 'f1-score': 0.43862489045111946, 'support': 121931}}
[[25603  4014 11219]
 [16972  8550 14165]
 [15430  4264 21714]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0629095
{'0': {'precision': 0.40602398608440904, 'recall': 0.5782268578878749, 'f1-score': 0.47706125961383317, 'support': 15340}, '1': {'precision': 0.4752503173036243, 'recall': 0.20502524791628643, 'f1-score': 0.2864671880312819, 'support': 16437}, '2': {'precision': 0.42083844352770655, 'recall': 0.5, 'f1-score': 0.4570165879646446, 'support': 15098}, 'accuracy': 0.42216533333333334, 'macro avg': {'precision': 0.43403758230524664, 'recall': 0.4277507019347204, 'f1-score': 0.4068483452032532, 'support': 46875}, 'weighted avg': {'precision': 0.4350702129586308, 'recall': 0.42216533333333334, 'f1-score': 0.4037721031943805, 'support': 46875}}
[[8870 1830 4640]
 [7318 3370 5749]
 [5658 1891 7549]]
training model: results/PCAR/W9/deepOF_L2/h50
Epoch 1/50
477/477 - 13s - loss: 3.3199 - accuracy50: 0.3591 - val_loss: 3.2852 - val_accuracy50: 0.3679 - 13s/epoch - 28ms/step
Epoch 2/50
477/477 - 11s - loss: 3.2673 - accuracy50: 0.3872 - val_loss: 3.2578 - val_accuracy50: 0.3831 - 11s/epoch - 24ms/step
Epoch 3/50
477/477 - 11s - loss: 3.2437 - accuracy50: 0.3997 - val_loss: 3.2464 - val_accuracy50: 0.3944 - 11s/epoch - 24ms/step
Epoch 4/50
477/477 - 11s - loss: 3.2277 - accuracy50: 0.4085 - val_loss: 3.2408 - val_accuracy50: 0.4006 - 11s/epoch - 24ms/step
Epoch 5/50
477/477 - 12s - loss: 3.2138 - accuracy50: 0.4160 - val_loss: 3.2362 - val_accuracy50: 0.4028 - 12s/epoch - 24ms/step
Epoch 6/50
477/477 - 12s - loss: 3.1994 - accuracy50: 0.4216 - val_loss: 3.2379 - val_accuracy50: 0.3988 - 12s/epoch - 24ms/step
Epoch 7/50
477/477 - 11s - loss: 3.1876 - accuracy50: 0.4267 - val_loss: 3.2359 - val_accuracy50: 0.4015 - 11s/epoch - 24ms/step
Epoch 8/50
477/477 - 11s - loss: 3.1771 - accuracy50: 0.4311 - val_loss: 3.2317 - val_accuracy50: 0.4058 - 11s/epoch - 24ms/step
Epoch 9/50
477/477 - 11s - loss: 3.1686 - accuracy50: 0.4340 - val_loss: 3.2342 - val_accuracy50: 0.4055 - 11s/epoch - 24ms/step
Epoch 10/50
477/477 - 11s - loss: 3.1585 - accuracy50: 0.4382 - val_loss: 3.2314 - val_accuracy50: 0.4060 - 11s/epoch - 24ms/step
Epoch 11/50
477/477 - 11s - loss: 3.1516 - accuracy50: 0.4412 - val_loss: 3.2304 - val_accuracy50: 0.4079 - 11s/epoch - 24ms/step
Epoch 12/50
477/477 - 11s - loss: 3.1434 - accuracy50: 0.4441 - val_loss: 3.2250 - val_accuracy50: 0.4112 - 11s/epoch - 24ms/step
Epoch 13/50
477/477 - 11s - loss: 3.1348 - accuracy50: 0.4494 - val_loss: 3.2275 - val_accuracy50: 0.4083 - 11s/epoch - 24ms/step
Epoch 14/50
477/477 - 11s - loss: 3.1294 - accuracy50: 0.4496 - val_loss: 3.2248 - val_accuracy50: 0.4124 - 11s/epoch - 24ms/step
Epoch 15/50
477/477 - 11s - loss: 3.1214 - accuracy50: 0.4521 - val_loss: 3.2280 - val_accuracy50: 0.4075 - 11s/epoch - 24ms/step
Epoch 16/50
477/477 - 11s - loss: 3.1147 - accuracy50: 0.4551 - val_loss: 3.2310 - val_accuracy50: 0.4071 - 11s/epoch - 23ms/step
Epoch 17/50
477/477 - 11s - loss: 3.1092 - accuracy50: 0.4580 - val_loss: 3.2351 - val_accuracy50: 0.4069 - 11s/epoch - 24ms/step
Epoch 18/50
477/477 - 11s - loss: 3.0994 - accuracy50: 0.4620 - val_loss: 3.2367 - val_accuracy50: 0.4067 - 11s/epoch - 24ms/step
Epoch 19/50
477/477 - 12s - loss: 3.0932 - accuracy50: 0.4647 - val_loss: 3.2423 - val_accuracy50: 0.4055 - 12s/epoch - 24ms/step
Epoch 20/50
477/477 - 12s - loss: 3.0846 - accuracy50: 0.4675 - val_loss: 3.2516 - val_accuracy50: 0.4007 - 12s/epoch - 25ms/step
Epoch 21/50
477/477 - 12s - loss: 3.0803 - accuracy50: 0.4688 - val_loss: 3.2464 - val_accuracy50: 0.4085 - 12s/epoch - 24ms/step
Epoch 22/50
477/477 - 11s - loss: 3.0688 - accuracy50: 0.4746 - val_loss: 3.2464 - val_accuracy50: 0.4074 - 11s/epoch - 24ms/step
Epoch 23/50
477/477 - 11s - loss: 3.0603 - accuracy50: 0.4767 - val_loss: 3.2640 - val_accuracy50: 0.4004 - 11s/epoch - 24ms/step
Epoch 24/50
477/477 - 11s - loss: 3.0522 - accuracy50: 0.4808 - val_loss: 3.2685 - val_accuracy50: 0.4036 - 11s/epoch - 24ms/step
testing model: results/PCAR/W9/deepOF_L2/h50
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0842658
{'0': {'precision': 0.45614893207049373, 'recall': 0.4847678155125701, 'f1-score': 0.47002313842582344, 'support': 63484}, '1': {'precision': 0.28777695597646075, 'recall': 0.2277215125451677, 'f1-score': 0.254251012145749, 'support': 39298}, '2': {'precision': 0.42658591010519603, 'recall': 0.4573322852944192, 'f1-score': 0.441424353878379, 'support': 58522}, 'accuracy': 0.4121906462331994, 'macro avg': {'precision': 0.39017059938405013, 'recall': 0.38994053778405235, 'f1-score': 0.38856616814998385, 'support': 161304}, 'weighted avg': {'precision': 0.4044033517501268, 'recall': 0.4121906462331994, 'f1-score': 0.4070794353072405, 'support': 161304}}
[[30775 11378 21331]
 [15704  8949 14645]
 [20988 10770 26764]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0541672
{'0': {'precision': 0.42951919924398757, 'recall': 0.5493180080408455, 'f1-score': 0.4820875814446826, 'support': 40543}, '1': {'precision': 0.4425752293267441, 'recall': 0.324804372127686, 'f1-score': 0.37465256884151404, 'support': 40255}, '2': {'precision': 0.4473444014110566, 'recall': 0.44086256776797217, 'f1-score': 0.4440798334761846, 'support': 41133}, 'accuracy': 0.4386087213259959, 'macro avg': {'precision': 0.4398129433272628, 'recall': 0.43832831597883454, 'f1-score': 0.4336066612541271, 'support': 121931}, 'weighted avg': {'precision': 0.4398428620673829, 'recall': 0.4386087213259959, 'f1-score': 0.4337965879358229, 'support': 121931}}
[[22271  7981 10291]
 [15068 13075 12112]
 [14512  8487 18134]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0744537
{'0': {'precision': 0.3986597013350219, 'recall': 0.5008950474043625, 'f1-score': 0.4439677969089733, 'support': 15083}, '1': {'precision': 0.43883768161224807, 'recall': 0.33128906710697015, 'f1-score': 0.3775537634408601, 'support': 16958}, '2': {'precision': 0.40450998545165984, 'recall': 0.4123634892813806, 'f1-score': 0.40839898517826145, 'support': 14834}, 'accuracy': 0.41152, 'macro avg': {'precision': 0.41400245613297654, 'recall': 0.41484920126423774, 'f1-score': 0.4099735151760316, 'support': 46875}, 'weighted avg': {'precision': 0.41504628915640657, 'recall': 0.41152, 'f1-score': 0.4086850890099729, 'support': 46875}}
[[7555 3517 4011]
 [6346 5618 4994]
 [5050 3667 6117]]
training model: results/PCAR/W9/deepOF_L2/h100
Epoch 1/50
477/477 - 14s - loss: 3.3326 - accuracy100: 0.3459 - val_loss: 3.2988 - val_accuracy100: 0.3606 - 14s/epoch - 29ms/step
Epoch 2/50
477/477 - 12s - loss: 3.2905 - accuracy100: 0.3673 - val_loss: 3.2832 - val_accuracy100: 0.3722 - 12s/epoch - 24ms/step
Epoch 3/50
477/477 - 11s - loss: 3.2707 - accuracy100: 0.3806 - val_loss: 3.2749 - val_accuracy100: 0.3785 - 11s/epoch - 24ms/step
Epoch 4/50
477/477 - 11s - loss: 3.2539 - accuracy100: 0.3912 - val_loss: 3.2700 - val_accuracy100: 0.3829 - 11s/epoch - 24ms/step
Epoch 5/50
477/477 - 11s - loss: 3.2406 - accuracy100: 0.3995 - val_loss: 3.2647 - val_accuracy100: 0.3857 - 11s/epoch - 24ms/step
Epoch 6/50
477/477 - 11s - loss: 3.2324 - accuracy100: 0.4009 - val_loss: 3.2635 - val_accuracy100: 0.3863 - 11s/epoch - 24ms/step
Epoch 7/50
477/477 - 12s - loss: 3.2233 - accuracy100: 0.4044 - val_loss: 3.2623 - val_accuracy100: 0.3850 - 12s/epoch - 24ms/step
Epoch 8/50
477/477 - 12s - loss: 3.2171 - accuracy100: 0.4085 - val_loss: 3.2571 - val_accuracy100: 0.3911 - 12s/epoch - 24ms/step
Epoch 9/50
477/477 - 11s - loss: 3.2096 - accuracy100: 0.4126 - val_loss: 3.2592 - val_accuracy100: 0.3873 - 11s/epoch - 24ms/step
Epoch 10/50
477/477 - 11s - loss: 3.2030 - accuracy100: 0.4153 - val_loss: 3.2576 - val_accuracy100: 0.3903 - 11s/epoch - 24ms/step
Epoch 11/50
477/477 - 11s - loss: 3.1975 - accuracy100: 0.4191 - val_loss: 3.2543 - val_accuracy100: 0.3941 - 11s/epoch - 24ms/step
Epoch 12/50
477/477 - 11s - loss: 3.1932 - accuracy100: 0.4202 - val_loss: 3.2538 - val_accuracy100: 0.3939 - 11s/epoch - 24ms/step
Epoch 13/50
477/477 - 11s - loss: 3.1859 - accuracy100: 0.4242 - val_loss: 3.2536 - val_accuracy100: 0.3967 - 11s/epoch - 24ms/step
Epoch 14/50
477/477 - 11s - loss: 3.1819 - accuracy100: 0.4264 - val_loss: 3.2523 - val_accuracy100: 0.3945 - 11s/epoch - 24ms/step
Epoch 15/50
477/477 - 11s - loss: 3.1769 - accuracy100: 0.4295 - val_loss: 3.2533 - val_accuracy100: 0.3939 - 11s/epoch - 24ms/step
Epoch 16/50
477/477 - 11s - loss: 3.1711 - accuracy100: 0.4314 - val_loss: 3.2532 - val_accuracy100: 0.3968 - 11s/epoch - 24ms/step
Epoch 17/50
477/477 - 11s - loss: 3.1655 - accuracy100: 0.4326 - val_loss: 3.2547 - val_accuracy100: 0.3960 - 11s/epoch - 24ms/step
Epoch 18/50
477/477 - 11s - loss: 3.1582 - accuracy100: 0.4360 - val_loss: 3.2577 - val_accuracy100: 0.3919 - 11s/epoch - 24ms/step
Epoch 19/50
477/477 - 11s - loss: 3.1513 - accuracy100: 0.4404 - val_loss: 3.2594 - val_accuracy100: 0.3940 - 11s/epoch - 24ms/step
Epoch 20/50
477/477 - 11s - loss: 3.1481 - accuracy100: 0.4405 - val_loss: 3.2606 - val_accuracy100: 0.3913 - 11s/epoch - 24ms/step
Epoch 21/50
477/477 - 11s - loss: 3.1398 - accuracy100: 0.4454 - val_loss: 3.2640 - val_accuracy100: 0.3942 - 11s/epoch - 24ms/step
Epoch 22/50
477/477 - 11s - loss: 3.1321 - accuracy100: 0.4488 - val_loss: 3.2634 - val_accuracy100: 0.3937 - 11s/epoch - 24ms/step
Epoch 23/50
477/477 - 11s - loss: 3.1254 - accuracy100: 0.4526 - val_loss: 3.2689 - val_accuracy100: 0.3926 - 11s/epoch - 24ms/step
Epoch 24/50
477/477 - 11s - loss: 3.1161 - accuracy100: 0.4556 - val_loss: 3.2766 - val_accuracy100: 0.3916 - 11s/epoch - 24ms/step
testing model: results/PCAR/W9/deepOF_L2/h100
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0900501
{'0': {'precision': 0.41335952848722984, 'recall': 0.4039196701333823, 'f1-score': 0.4085850824904169, 'support': 59903}, '1': {'precision': 0.34897401198597033, 'recall': 0.27135095668606524, 'f1-score': 0.30530588576398954, 'support': 46567}, '2': {'precision': 0.37826021634615387, 'recall': 0.45914943283364335, 'f1-score': 0.41479809545776564, 'support': 54834}, 'accuracy': 0.3844232009125626, 'macro avg': {'precision': 0.38019791893978466, 'recall': 0.37814001988436363, 'f1-score': 0.37622968790405736, 'support': 161304}, 'weighted avg': {'precision': 0.3828402851401467, 'recall': 0.3844232009125626, 'f1-score': 0.3808813801587454, 'support': 161304}}
[[24196 12258 23449]
 [15997 12636 17934]
 [18342 11315 25177]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.066001
{'0': {'precision': 0.40830136632041725, 'recall': 0.4701824047648592, 'f1-score': 0.43706241277091484, 'support': 40295}, '1': {'precision': 0.43101761252446186, 'recall': 0.35055956229793583, 'f1-score': 0.3866472831006391, 'support': 40210}, '2': {'precision': 0.42594279042615296, 'recall': 0.44032733066190316, 'f1-score': 0.43301563186193637, 'support': 41426}, 'accuracy': 0.4205903338773569, 'macro avg': {'precision': 0.42175392309034404, 'recall': 0.4203564325748994, 'f1-score': 0.41890844257783016, 'support': 121931}, 'weighted avg': {'precision': 0.4217863200636724, 'recall': 0.4205903338773569, 'f1-score': 0.4190617869253372, 'support': 121931}}
[[18946  9190 12159]
 [13689 14096 12425]
 [13767  9418 18241]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0836744
{'0': {'precision': 0.3957869395124887, 'recall': 0.41797495709654864, 'f1-score': 0.4065784592555954, 'support': 15733}, '1': {'precision': 0.40043793622553714, 'recall': 0.36921135646687697, 'f1-score': 0.38419117647058826, 'support': 15850}, '2': {'precision': 0.38789466956410584, 'recall': 0.3968741825791263, 'f1-score': 0.3923330532031805, 'support': 15292}, 'accuracy': 0.39460266666666666, 'macro avg': {'precision': 0.3947065151007106, 'recall': 0.39468683204751737, 'f1-score': 0.3943675629764547, 'support': 46875}, 'weighted avg': {'precision': 0.3947849065706465, 'recall': 0.39460266666666666, 'f1-score': 0.394361303383683, 'support': 46875}}
[[6576 4422 4735]
 [5156 5852 4842]
 [4883 4340 6069]]
training model: results/PCAR/W9/deepOF_L2/h200
Epoch 1/50
477/477 - 13s - loss: 3.3340 - accuracy200: 0.3454 - val_loss: 3.3015 - val_accuracy200: 0.3604 - 13s/epoch - 28ms/step
Epoch 2/50
477/477 - 11s - loss: 3.2956 - accuracy200: 0.3662 - val_loss: 3.2859 - val_accuracy200: 0.3745 - 11s/epoch - 24ms/step
Epoch 3/50
477/477 - 11s - loss: 3.2753 - accuracy200: 0.3781 - val_loss: 3.2781 - val_accuracy200: 0.3795 - 11s/epoch - 24ms/step
Epoch 4/50
477/477 - 12s - loss: 3.2601 - accuracy200: 0.3883 - val_loss: 3.2684 - val_accuracy200: 0.3885 - 12s/epoch - 24ms/step
Epoch 5/50
477/477 - 11s - loss: 3.2487 - accuracy200: 0.3934 - val_loss: 3.2665 - val_accuracy200: 0.3876 - 11s/epoch - 24ms/step
Epoch 6/50
477/477 - 11s - loss: 3.2416 - accuracy200: 0.3971 - val_loss: 3.2674 - val_accuracy200: 0.3876 - 11s/epoch - 24ms/step
Epoch 7/50
477/477 - 12s - loss: 3.2344 - accuracy200: 0.4011 - val_loss: 3.2647 - val_accuracy200: 0.3869 - 12s/epoch - 24ms/step
Epoch 8/50
477/477 - 11s - loss: 3.2275 - accuracy200: 0.4046 - val_loss: 3.2639 - val_accuracy200: 0.3875 - 11s/epoch - 24ms/step
Epoch 9/50
477/477 - 11s - loss: 3.2218 - accuracy200: 0.4066 - val_loss: 3.2645 - val_accuracy200: 0.3878 - 11s/epoch - 24ms/step
Epoch 10/50
477/477 - 11s - loss: 3.2184 - accuracy200: 0.4072 - val_loss: 3.2622 - val_accuracy200: 0.3878 - 11s/epoch - 23ms/step
Epoch 11/50
477/477 - 11s - loss: 3.2116 - accuracy200: 0.4116 - val_loss: 3.2600 - val_accuracy200: 0.3910 - 11s/epoch - 24ms/step
Epoch 12/50
477/477 - 11s - loss: 3.2065 - accuracy200: 0.4146 - val_loss: 3.2588 - val_accuracy200: 0.3913 - 11s/epoch - 24ms/step
Epoch 13/50
477/477 - 11s - loss: 3.2033 - accuracy200: 0.4166 - val_loss: 3.2601 - val_accuracy200: 0.3881 - 11s/epoch - 24ms/step
Epoch 14/50
477/477 - 11s - loss: 3.1970 - accuracy200: 0.4188 - val_loss: 3.2592 - val_accuracy200: 0.3916 - 11s/epoch - 24ms/step
Epoch 15/50
477/477 - 11s - loss: 3.1937 - accuracy200: 0.4215 - val_loss: 3.2585 - val_accuracy200: 0.3919 - 11s/epoch - 24ms/step
Epoch 16/50
477/477 - 11s - loss: 3.1874 - accuracy200: 0.4244 - val_loss: 3.2562 - val_accuracy200: 0.3967 - 11s/epoch - 24ms/step
Epoch 17/50
477/477 - 11s - loss: 3.1817 - accuracy200: 0.4252 - val_loss: 3.2588 - val_accuracy200: 0.3915 - 11s/epoch - 24ms/step
Epoch 18/50
477/477 - 11s - loss: 3.1747 - accuracy200: 0.4303 - val_loss: 3.2602 - val_accuracy200: 0.3927 - 11s/epoch - 24ms/step
Epoch 19/50
477/477 - 11s - loss: 3.1703 - accuracy200: 0.4329 - val_loss: 3.2581 - val_accuracy200: 0.3948 - 11s/epoch - 24ms/step
Epoch 20/50
477/477 - 11s - loss: 3.1641 - accuracy200: 0.4342 - val_loss: 3.2595 - val_accuracy200: 0.3965 - 11s/epoch - 24ms/step
Epoch 21/50
477/477 - 11s - loss: 3.1562 - accuracy200: 0.4371 - val_loss: 3.2623 - val_accuracy200: 0.3951 - 11s/epoch - 24ms/step
Epoch 22/50
477/477 - 11s - loss: 3.1526 - accuracy200: 0.4387 - val_loss: 3.2639 - val_accuracy200: 0.3962 - 11s/epoch - 24ms/step
Epoch 23/50
477/477 - 12s - loss: 3.1462 - accuracy200: 0.4448 - val_loss: 3.2635 - val_accuracy200: 0.3985 - 12s/epoch - 24ms/step
Epoch 24/50
477/477 - 11s - loss: 3.1385 - accuracy200: 0.4474 - val_loss: 3.2718 - val_accuracy200: 0.3938 - 11s/epoch - 24ms/step
Epoch 25/50
477/477 - 11s - loss: 3.1293 - accuracy200: 0.4497 - val_loss: 3.2756 - val_accuracy200: 0.3939 - 11s/epoch - 24ms/step
Epoch 26/50
477/477 - 12s - loss: 3.1207 - accuracy200: 0.4527 - val_loss: 3.2787 - val_accuracy200: 0.3923 - 12s/epoch - 24ms/step
testing model: results/PCAR/W9/deepOF_L2/h200
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0956832
{'0': {'precision': 0.4195217179111762, 'recall': 0.33366456541316025, 'f1-score': 0.37169963072186524, 'support': 64406}, '1': {'precision': 0.28024866572051094, 'recall': 0.3615358828231775, 'f1-score': 0.315744431682544, 'support': 38779}, '2': {'precision': 0.38325118230866584, 'recall': 0.39599786644642887, 'f1-score': 0.3895202714710039, 'support': 58119}, 'accuracy': 0.36282423250508355, 'macro avg': {'precision': 0.36100718864678427, 'recall': 0.3637327715609222, 'f1-score': 0.35898811129180436, 'support': 161304}, 'weighted avg': {'precision': 0.37297062835614897, 'recall': 0.36282423250508355, 'f1-score': 0.36466838014006536, 'support': 161304}}
[[21490 19037 23879]
 [11601 14020 13158]
 [18134 16970 23015]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0675019
{'0': {'precision': 0.4110764430577223, 'recall': 0.38062861127714687, 'f1-score': 0.3952670373723005, 'support': 40152}, '1': {'precision': 0.4248534188214451, 'recall': 0.5004596159101637, 'f1-score': 0.4595676723892089, 'support': 40251}, '2': {'precision': 0.42398028870617854, 'recall': 0.3812126757850125, 'f1-score': 0.401460686979345, 'support': 41528}, 'accuracy': 0.42038529988272055, 'macro avg': {'precision': 0.41997005019511535, 'recall': 0.42076696765744104, 'f1-score': 0.4187651322469515, 'support': 121931}, 'weighted avg': {'precision': 0.4200192709977433, 'recall': 0.42038529988272055, 'f1-score': 0.4186029793472447, 'support': 121931}}
[[15283 13448 11421]
 [10020 20144 10087]
 [11875 13822 15831]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.085346
{'0': {'precision': 0.38031423290203326, 'recall': 0.31804714672162826, 'f1-score': 0.34640477025605054, 'support': 15526}, '1': {'precision': 0.4138329640689722, 'recall': 0.5237108374984761, 'f1-score': 0.46233318984072325, 'support': 16406}, '2': {'precision': 0.36255617335669127, 'recall': 0.3185437997724687, 'f1-score': 0.3391279566828156, 'support': 14943}, 'accuracy': 0.3901866666666667, 'macro avg': {'precision': 0.38556779010923226, 'recall': 0.3867672613308577, 'f1-score': 0.38262197225986316, 'support': 46875}, 'weighted avg': {'precision': 0.38638462478979335, 'recall': 0.3901866666666667, 'f1-score': 0.3846593670876514, 'support': 46875}}
[[4938 6167 4421]
 [3866 8592 3948]
 [4180 6003 4760]]
training model: results/PCAR/W9/deepOF_L2/h300
Epoch 1/50
477/477 - 13s - loss: 3.3312 - accuracy300: 0.3493 - val_loss: 3.3013 - val_accuracy300: 0.3623 - 13s/epoch - 28ms/step
Epoch 2/50
477/477 - 12s - loss: 3.2918 - accuracy300: 0.3688 - val_loss: 3.2913 - val_accuracy300: 0.3667 - 12s/epoch - 24ms/step
Epoch 3/50
477/477 - 11s - loss: 3.2697 - accuracy300: 0.3807 - val_loss: 3.2851 - val_accuracy300: 0.3722 - 11s/epoch - 24ms/step
Epoch 4/50
477/477 - 11s - loss: 3.2533 - accuracy300: 0.3892 - val_loss: 3.2860 - val_accuracy300: 0.3695 - 11s/epoch - 24ms/step
Epoch 5/50
477/477 - 11s - loss: 3.2428 - accuracy300: 0.3951 - val_loss: 3.2841 - val_accuracy300: 0.3738 - 11s/epoch - 24ms/step
Epoch 6/50
477/477 - 11s - loss: 3.2355 - accuracy300: 0.3977 - val_loss: 3.2824 - val_accuracy300: 0.3769 - 11s/epoch - 24ms/step
Epoch 7/50
477/477 - 12s - loss: 3.2271 - accuracy300: 0.4019 - val_loss: 3.2801 - val_accuracy300: 0.3750 - 12s/epoch - 24ms/step
Epoch 8/50
477/477 - 11s - loss: 3.2209 - accuracy300: 0.4066 - val_loss: 3.2808 - val_accuracy300: 0.3751 - 11s/epoch - 24ms/step
Epoch 9/50
477/477 - 11s - loss: 3.2160 - accuracy300: 0.4084 - val_loss: 3.2791 - val_accuracy300: 0.3786 - 11s/epoch - 24ms/step
Epoch 10/50
477/477 - 11s - loss: 3.2115 - accuracy300: 0.4101 - val_loss: 3.2757 - val_accuracy300: 0.3814 - 11s/epoch - 24ms/step
Epoch 11/50
477/477 - 11s - loss: 3.2059 - accuracy300: 0.4126 - val_loss: 3.2766 - val_accuracy300: 0.3837 - 11s/epoch - 24ms/step
Epoch 12/50
477/477 - 11s - loss: 3.2006 - accuracy300: 0.4167 - val_loss: 3.2766 - val_accuracy300: 0.3832 - 11s/epoch - 24ms/step
Epoch 13/50
477/477 - 11s - loss: 3.1962 - accuracy300: 0.4182 - val_loss: 3.2757 - val_accuracy300: 0.3813 - 11s/epoch - 24ms/step
Epoch 14/50
477/477 - 11s - loss: 3.1917 - accuracy300: 0.4200 - val_loss: 3.2764 - val_accuracy300: 0.3804 - 11s/epoch - 24ms/step
Epoch 15/50
477/477 - 11s - loss: 3.1871 - accuracy300: 0.4213 - val_loss: 3.2785 - val_accuracy300: 0.3792 - 11s/epoch - 24ms/step
Epoch 16/50
477/477 - 11s - loss: 3.1811 - accuracy300: 0.4249 - val_loss: 3.2780 - val_accuracy300: 0.3798 - 11s/epoch - 24ms/step
Epoch 17/50
477/477 - 11s - loss: 3.1760 - accuracy300: 0.4263 - val_loss: 3.2776 - val_accuracy300: 0.3807 - 11s/epoch - 24ms/step
Epoch 18/50
477/477 - 11s - loss: 3.1694 - accuracy300: 0.4300 - val_loss: 3.2792 - val_accuracy300: 0.3808 - 11s/epoch - 24ms/step
Epoch 19/50
477/477 - 12s - loss: 3.1668 - accuracy300: 0.4305 - val_loss: 3.2817 - val_accuracy300: 0.3823 - 12s/epoch - 24ms/step
Epoch 20/50
477/477 - 11s - loss: 3.1606 - accuracy300: 0.4353 - val_loss: 3.2800 - val_accuracy300: 0.3812 - 11s/epoch - 24ms/step
Epoch 21/50
477/477 - 11s - loss: 3.1541 - accuracy300: 0.4375 - val_loss: 3.2842 - val_accuracy300: 0.3803 - 11s/epoch - 23ms/step
Epoch 22/50
477/477 - 11s - loss: 3.1471 - accuracy300: 0.4392 - val_loss: 3.2832 - val_accuracy300: 0.3851 - 11s/epoch - 24ms/step
Epoch 23/50
477/477 - 11s - loss: 3.1430 - accuracy300: 0.4431 - val_loss: 3.2932 - val_accuracy300: 0.3813 - 11s/epoch - 24ms/step
testing model: results/PCAR/W9/deepOF_L2/h300
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0999095
{'0': {'precision': 0.4011605035405193, 'recall': 0.2732815221760686, 'f1-score': 0.32509763290029486, 'support': 59704}, '1': {'precision': 0.3353257887008499, 'recall': 0.4723678987066714, 'f1-score': 0.3922208150448465, 'support': 47861}, '2': {'precision': 0.35413730243746594, 'recall': 0.35065780903998955, 'f1-score': 0.35238896680691906, 'support': 53739}, 'accuracy': 0.358131230471656, 'macro avg': {'precision': 0.3635411982262784, 'recall': 0.36543574330757655, 'f1-score': 0.3565691382506868, 'support': 161304}, 'weighted avg': {'precision': 0.3659605389332039, 'recall': 0.358131230471656, 'f1-score': 0.3541061609803701, 'support': 161304}}
[[16316 23440 19948]
 [10834 22608 14419]
 [13522 21373 18844]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0754045
{'0': {'precision': 0.40353724933211593, 'recall': 0.29919265871025974, 'f1-score': 0.3436181700381542, 'support': 39884}, '1': {'precision': 0.394694163238131, 'recall': 0.5740961462058005, 'f1-score': 0.46778419609707733, 'support': 40272}, '2': {'precision': 0.4197081372287837, 'recall': 0.33941352483542786, 'f1-score': 0.37531432806585663, 'support': 41775}, 'accuracy': 0.4037693449573939, 'macro avg': {'precision': 0.40597984993301023, 'recall': 0.4042341099171627, 'f1-score': 0.39557223140036274, 'support': 121931}, 'weighted avg': {'precision': 0.4061568463066863, 'recall': 0.4037693449573939, 'f1-score': 0.39548784389510794, 'support': 121931}}
[[11933 17422 10529]
 [ 8077 23120  9075]
 [ 9561 18035 14179]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0917938
{'0': {'precision': 0.3770117131701743, 'recall': 0.25543583456997226, 'f1-score': 0.3045384615384616, 'support': 15499}, '1': {'precision': 0.3970919090075827, 'recall': 0.5759260378270591, 'f1-score': 0.4700747207220537, 'support': 16549}, '2': {'precision': 0.35337859683155515, 'recall': 0.2948674715046874, 'f1-score': 0.32148240744145007, 'support': 14827}, 'accuracy': 0.381056, 'macro avg': {'precision': 0.37582740633643735, 'recall': 0.37540978130057284, 'f1-score': 0.36536519656732186, 'support': 46875}, 'weighted avg': {'precision': 0.376625557329333, 'recall': 0.381056, 'f1-score': 0.3683397935732963, 'support': 46875}}
[[3959 7320 4220]
 [3238 9531 3780]
 [3304 7151 4372]]
training model: results/PCAR/W9/deepOF_L2/h500
Epoch 1/50
477/477 - 14s - loss: 3.3344 - accuracy500: 0.3477 - val_loss: 3.3102 - val_accuracy500: 0.3581 - 14s/epoch - 30ms/step
Epoch 2/50
477/477 - 12s - loss: 3.2984 - accuracy500: 0.3627 - val_loss: 3.3005 - val_accuracy500: 0.3648 - 12s/epoch - 24ms/step
Epoch 3/50
477/477 - 12s - loss: 3.2790 - accuracy500: 0.3746 - val_loss: 3.2956 - val_accuracy500: 0.3676 - 12s/epoch - 24ms/step
Epoch 4/50
477/477 - 11s - loss: 3.2674 - accuracy500: 0.3817 - val_loss: 3.2950 - val_accuracy500: 0.3682 - 11s/epoch - 24ms/step
Epoch 5/50
477/477 - 11s - loss: 3.2586 - accuracy500: 0.3864 - val_loss: 3.2922 - val_accuracy500: 0.3658 - 11s/epoch - 24ms/step
Epoch 6/50
477/477 - 12s - loss: 3.2530 - accuracy500: 0.3901 - val_loss: 3.2949 - val_accuracy500: 0.3701 - 12s/epoch - 24ms/step
Epoch 7/50
477/477 - 12s - loss: 3.2472 - accuracy500: 0.3912 - val_loss: 3.2920 - val_accuracy500: 0.3695 - 12s/epoch - 24ms/step
Epoch 8/50
477/477 - 11s - loss: 3.2405 - accuracy500: 0.3965 - val_loss: 3.2915 - val_accuracy500: 0.3721 - 11s/epoch - 24ms/step
Epoch 9/50
477/477 - 11s - loss: 3.2382 - accuracy500: 0.3997 - val_loss: 3.2922 - val_accuracy500: 0.3688 - 11s/epoch - 24ms/step
Epoch 10/50
477/477 - 11s - loss: 3.2336 - accuracy500: 0.4011 - val_loss: 3.2887 - val_accuracy500: 0.3745 - 11s/epoch - 24ms/step
Epoch 11/50
477/477 - 11s - loss: 3.2278 - accuracy500: 0.4021 - val_loss: 3.2865 - val_accuracy500: 0.3748 - 11s/epoch - 24ms/step
Epoch 12/50
477/477 - 11s - loss: 3.2243 - accuracy500: 0.4039 - val_loss: 3.2892 - val_accuracy500: 0.3741 - 11s/epoch - 23ms/step
Epoch 13/50
477/477 - 12s - loss: 3.2193 - accuracy500: 0.4086 - val_loss: 3.2922 - val_accuracy500: 0.3744 - 12s/epoch - 25ms/step
Epoch 14/50
477/477 - 11s - loss: 3.2142 - accuracy500: 0.4095 - val_loss: 3.2916 - val_accuracy500: 0.3736 - 11s/epoch - 24ms/step
Epoch 15/50
477/477 - 11s - loss: 3.2104 - accuracy500: 0.4122 - val_loss: 3.2950 - val_accuracy500: 0.3724 - 11s/epoch - 24ms/step
Epoch 16/50
477/477 - 11s - loss: 3.2062 - accuracy500: 0.4154 - val_loss: 3.2963 - val_accuracy500: 0.3729 - 11s/epoch - 24ms/step
Epoch 17/50
477/477 - 11s - loss: 3.1995 - accuracy500: 0.4174 - val_loss: 3.2996 - val_accuracy500: 0.3726 - 11s/epoch - 24ms/step
Epoch 18/50
477/477 - 12s - loss: 3.1970 - accuracy500: 0.4178 - val_loss: 3.2999 - val_accuracy500: 0.3737 - 12s/epoch - 24ms/step
Epoch 19/50
477/477 - 12s - loss: 3.1914 - accuracy500: 0.4223 - val_loss: 3.3038 - val_accuracy500: 0.3724 - 12s/epoch - 24ms/step
Epoch 20/50
477/477 - 11s - loss: 3.1880 - accuracy500: 0.4239 - val_loss: 3.3042 - val_accuracy500: 0.3718 - 11s/epoch - 24ms/step
Epoch 21/50
477/477 - 11s - loss: 3.1811 - accuracy500: 0.4271 - val_loss: 3.3070 - val_accuracy500: 0.3689 - 11s/epoch - 24ms/step
testing model: results/PCAR/W9/deepOF_L2/h500
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1040574
{'0': {'precision': 0.4044558071585099, 'recall': 0.18296269371840201, 'f1-score': 0.2519509476031215, 'support': 60526}, '1': {'precision': 0.32712612594698853, 'recall': 0.674684219160105, 'f1-score': 0.44061600267827256, 'support': 48768}, '2': {'precision': 0.33066402735288825, 'recall': 0.211978465679677, 'f1-score': 0.2583419252038616, 'support': 52010}, 'accuracy': 0.34098348460050587, 'macro avg': {'precision': 0.35408198681946224, 'recall': 0.35654179285272797, 'f1-score': 0.3169696251617519, 'support': 161304}, 'weighted avg': {'precision': 0.3572832363542282, 'recall': 0.34098348460050587, 'f1-score': 0.3110518511821987, 'support': 161304}}
[[11074 35680 13772]
 [ 7320 32903  8545]
 [ 8986 31999 11025]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0863906
{'0': {'precision': 0.40980426732498676, 'recall': 0.1755287009063444, 'f1-score': 0.2457828776902332, 'support': 39720}, '1': {'precision': 0.36870104746626403, 'recall': 0.7764942614398569, 'f1-score': 0.4999920019195393, 'support': 40254}, '2': {'precision': 0.428606891073379, 'recall': 0.20575827633052887, 'f1-score': 0.2780399040242194, 'support': 41957}, 'accuracy': 0.38433212226587166, 'macro avg': {'precision': 0.40237073528820994, 'recall': 0.38592707955891004, 'f1-score': 0.341271594544664, 'support': 121931}, 'weighted avg': {'precision': 0.40270461811697783, 'recall': 0.38433212226587166, 'f1-score': 0.3408066381828196, 'support': 121931}}
[[ 6972 26023  6725]
 [ 4213 31257  4784]
 [ 5828 27496  8633]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0953325
{'0': {'precision': 0.39861135837635747, 'recall': 0.14204148956416926, 'f1-score': 0.20944808231992518, 'support': 15763}, '1': {'precision': 0.3750401870524624, 'recall': 0.8020501281330084, 'f1-score': 0.5110925239972917, 'support': 15999}, '2': {'precision': 0.3674570495527474, 'recall': 0.17124330046979422, 'f1-score': 0.23361617620509117, 'support': 15113}, 'accuracy': 0.37672533333333336, 'macro avg': {'precision': 0.3803695316605224, 'recall': 0.37177830605565726, 'f1-score': 0.3180522608407694, 'support': 46875}, 'weighted avg': {'precision': 0.38052175327209686, 'recall': 0.37672533333333336, 'f1-score': 0.32019500125928946, 'support': 46875}}
[[ 2239 10802  2722]
 [ 1434 12832  1733]
 [ 1944 10581  2588]]
training model: results/PCAR/W9/deepOF_L2/h1000
Epoch 1/50
477/477 - 14s - loss: 3.3367 - accuracy1000: 0.3499 - val_loss: 3.3013 - val_accuracy1000: 0.3654 - 14s/epoch - 29ms/step
Epoch 2/50
477/477 - 11s - loss: 3.3011 - accuracy1000: 0.3646 - val_loss: 3.2939 - val_accuracy1000: 0.3692 - 11s/epoch - 24ms/step
Epoch 3/50
477/477 - 12s - loss: 3.2813 - accuracy1000: 0.3774 - val_loss: 3.2875 - val_accuracy1000: 0.3741 - 12s/epoch - 25ms/step
Epoch 4/50
477/477 - 12s - loss: 3.2674 - accuracy1000: 0.3850 - val_loss: 3.2819 - val_accuracy1000: 0.3736 - 12s/epoch - 24ms/step
Epoch 5/50
477/477 - 11s - loss: 3.2587 - accuracy1000: 0.3912 - val_loss: 3.2788 - val_accuracy1000: 0.3779 - 11s/epoch - 24ms/step
Epoch 6/50
477/477 - 11s - loss: 3.2514 - accuracy1000: 0.3949 - val_loss: 3.2790 - val_accuracy1000: 0.3765 - 11s/epoch - 24ms/step
Epoch 7/50
477/477 - 11s - loss: 3.2467 - accuracy1000: 0.3966 - val_loss: 3.2756 - val_accuracy1000: 0.3786 - 11s/epoch - 24ms/step
Epoch 8/50
477/477 - 11s - loss: 3.2422 - accuracy1000: 0.3982 - val_loss: 3.2775 - val_accuracy1000: 0.3771 - 11s/epoch - 24ms/step
Epoch 9/50
477/477 - 11s - loss: 3.2397 - accuracy1000: 0.3996 - val_loss: 3.2781 - val_accuracy1000: 0.3775 - 11s/epoch - 24ms/step
Epoch 10/50
477/477 - 11s - loss: 3.2358 - accuracy1000: 0.4021 - val_loss: 3.2761 - val_accuracy1000: 0.3779 - 11s/epoch - 24ms/step
Epoch 11/50
477/477 - 11s - loss: 3.2314 - accuracy1000: 0.4042 - val_loss: 3.2788 - val_accuracy1000: 0.3759 - 11s/epoch - 24ms/step
Epoch 12/50
477/477 - 11s - loss: 3.2276 - accuracy1000: 0.4060 - val_loss: 3.2782 - val_accuracy1000: 0.3774 - 11s/epoch - 24ms/step
Epoch 13/50
477/477 - 11s - loss: 3.2234 - accuracy1000: 0.4093 - val_loss: 3.2818 - val_accuracy1000: 0.3746 - 11s/epoch - 24ms/step
Epoch 14/50
477/477 - 11s - loss: 3.2198 - accuracy1000: 0.4091 - val_loss: 3.2798 - val_accuracy1000: 0.3775 - 11s/epoch - 24ms/step
Epoch 15/50
477/477 - 11s - loss: 3.2168 - accuracy1000: 0.4122 - val_loss: 3.2819 - val_accuracy1000: 0.3759 - 11s/epoch - 24ms/step
Epoch 16/50
477/477 - 11s - loss: 3.2128 - accuracy1000: 0.4133 - val_loss: 3.2842 - val_accuracy1000: 0.3778 - 11s/epoch - 23ms/step
Epoch 17/50
477/477 - 11s - loss: 3.2076 - accuracy1000: 0.4159 - val_loss: 3.2854 - val_accuracy1000: 0.3755 - 11s/epoch - 24ms/step
testing model: results/PCAR/W9/deepOF_L2/h1000
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993718
{'0': {'precision': 0.40282191644065823, 'recall': 0.39542024630059125, 'f1-score': 0.39908676551798034, 'support': 61226}, '1': {'precision': 0.32574453434326045, 'recall': 0.46880419522669087, 'f1-score': 0.3843953141928494, 'support': 48436}, '2': {'precision': 0.32024130814414986, 'recall': 0.19530614616010225, 'f1-score': 0.24263564959043507, 'support': 51642}, 'accuracy': 0.3533886326439518, 'macro avg': {'precision': 0.34960258630935614, 'recall': 0.35317686256246145, 'f1-score': 0.3420392431004216, 'support': 161304}, 'weighted avg': {'precision': 0.3532388443970769, 'recall': 0.3533886326439518, 'f1-score': 0.3445869163814782, 'support': 161304}}
[[24210 24252 12764]
 [17084 22707  8645]
 [18807 22749 10086]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.08661
{'0': {'precision': 0.3750868751670676, 'recall': 0.3520586095290664, 'f1-score': 0.363208096600101, 'support': 39857}, '1': {'precision': 0.38406292749658005, 'recall': 0.6194463945441782, 'f1-score': 0.47414885042029714, 'support': 39884}, '2': {'precision': 0.412172535036894, 'recall': 0.19727423560085328, 'f1-score': 0.26683551608611317, 'support': 42190}, 'accuracy': 0.38596419286317674, 'macro avg': {'precision': 0.3904407792335139, 'recall': 0.389593079891366, 'f1-score': 0.36806415436883705, 'support': 121931}, 'weighted avg': {'precision': 0.39085517741192943, 'recall': 0.38596419286317674, 'f1-score': 0.366150759692174, 'support': 121931}}
[[14032 19099  6726]
 [10034 24706  5144]
 [13344 20523  8323]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0923241
{'0': {'precision': 0.36852372034956304, 'recall': 0.30656886927171234, 'f1-score': 0.3347034228615973, 'support': 15406}, '1': {'precision': 0.39360492831212646, 'recall': 0.6655918645749365, 'f1-score': 0.4946771740633209, 'support': 16127}, '2': {'precision': 0.3643193871538008, 'recall': 0.16119150045626385, 'f1-score': 0.22349751468594664, 'support': 15342}, 'accuracy': 0.38250666666666666, 'macro avg': {'precision': 0.37548267860516343, 'recall': 0.37778407810097087, 'f1-score': 0.3509593705369549, 'support': 46875}, 'weighted avg': {'precision': 0.37577666458258435, 'recall': 0.38250666666666666, 'f1-score': 0.35334396989945044, 'support': 46875}}
[[ 4723  8196  2487]
 [ 3565 10734  1828]
 [ 4528  8341  2473]]
training model: results/PCAR/W9/deepVOL_L2/h10
Epoch 1/50
477/477 - 13s - loss: 3.2958 - accuracy10: 0.3783 - val_loss: 3.3143 - val_accuracy10: 0.3777 - 13s/epoch - 28ms/step
Epoch 2/50
477/477 - 11s - loss: 3.2105 - accuracy10: 0.4203 - val_loss: 3.1686 - val_accuracy10: 0.4505 - 11s/epoch - 23ms/step
Epoch 3/50
477/477 - 11s - loss: 3.1394 - accuracy10: 0.4527 - val_loss: 3.1291 - val_accuracy10: 0.4678 - 11s/epoch - 22ms/step
Epoch 4/50
477/477 - 10s - loss: 3.0819 - accuracy10: 0.4724 - val_loss: 3.1170 - val_accuracy10: 0.4699 - 10s/epoch - 22ms/step
Epoch 5/50
477/477 - 11s - loss: 3.0507 - accuracy10: 0.4859 - val_loss: 3.0994 - val_accuracy10: 0.4797 - 11s/epoch - 22ms/step
Epoch 6/50
477/477 - 11s - loss: 3.0320 - accuracy10: 0.4903 - val_loss: 3.0875 - val_accuracy10: 0.4776 - 11s/epoch - 23ms/step
Epoch 7/50
477/477 - 11s - loss: 3.0119 - accuracy10: 0.4945 - val_loss: 3.0713 - val_accuracy10: 0.4856 - 11s/epoch - 23ms/step
Epoch 8/50
477/477 - 11s - loss: 2.9979 - accuracy10: 0.5003 - val_loss: 3.0529 - val_accuracy10: 0.4902 - 11s/epoch - 23ms/step
Epoch 9/50
477/477 - 11s - loss: 2.9833 - accuracy10: 0.5028 - val_loss: 3.0516 - val_accuracy10: 0.4906 - 11s/epoch - 22ms/step
Epoch 10/50
477/477 - 11s - loss: 2.9753 - accuracy10: 0.5053 - val_loss: 3.0422 - val_accuracy10: 0.4903 - 11s/epoch - 22ms/step
Epoch 11/50
477/477 - 11s - loss: 2.9673 - accuracy10: 0.5067 - val_loss: 3.0261 - val_accuracy10: 0.4959 - 11s/epoch - 22ms/step
Epoch 12/50
477/477 - 11s - loss: 2.9599 - accuracy10: 0.5088 - val_loss: 3.0346 - val_accuracy10: 0.4925 - 11s/epoch - 23ms/step
Epoch 13/50
477/477 - 11s - loss: 2.9521 - accuracy10: 0.5110 - val_loss: 3.0199 - val_accuracy10: 0.4993 - 11s/epoch - 22ms/step
Epoch 14/50
477/477 - 11s - loss: 2.9465 - accuracy10: 0.5118 - val_loss: 3.0072 - val_accuracy10: 0.5016 - 11s/epoch - 23ms/step
Epoch 15/50
477/477 - 11s - loss: 2.9391 - accuracy10: 0.5142 - val_loss: 3.0184 - val_accuracy10: 0.5003 - 11s/epoch - 22ms/step
Epoch 16/50
477/477 - 11s - loss: 2.9315 - accuracy10: 0.5160 - val_loss: 3.0082 - val_accuracy10: 0.4979 - 11s/epoch - 23ms/step
Epoch 17/50
477/477 - 11s - loss: 2.9264 - accuracy10: 0.5178 - val_loss: 3.0018 - val_accuracy10: 0.5025 - 11s/epoch - 22ms/step
Epoch 18/50
477/477 - 11s - loss: 2.9217 - accuracy10: 0.5191 - val_loss: 3.0031 - val_accuracy10: 0.5020 - 11s/epoch - 23ms/step
Epoch 19/50
477/477 - 11s - loss: 2.9175 - accuracy10: 0.5185 - val_loss: 3.0005 - val_accuracy10: 0.5008 - 11s/epoch - 23ms/step
Epoch 20/50
477/477 - 11s - loss: 2.9101 - accuracy10: 0.5210 - val_loss: 3.0175 - val_accuracy10: 0.4973 - 11s/epoch - 22ms/step
Epoch 21/50
477/477 - 11s - loss: 2.9074 - accuracy10: 0.5211 - val_loss: 3.0075 - val_accuracy10: 0.5003 - 11s/epoch - 22ms/step
Epoch 22/50
477/477 - 11s - loss: 2.9018 - accuracy10: 0.5224 - val_loss: 3.0023 - val_accuracy10: 0.5023 - 11s/epoch - 22ms/step
Epoch 23/50
477/477 - 11s - loss: 2.8991 - accuracy10: 0.5241 - val_loss: 3.0006 - val_accuracy10: 0.5018 - 11s/epoch - 22ms/step
Epoch 24/50
477/477 - 11s - loss: 2.8932 - accuracy10: 0.5251 - val_loss: 3.0060 - val_accuracy10: 0.5012 - 11s/epoch - 22ms/step
Epoch 25/50
477/477 - 11s - loss: 2.8873 - accuracy10: 0.5262 - val_loss: 3.0069 - val_accuracy10: 0.5013 - 11s/epoch - 22ms/step
Epoch 26/50
477/477 - 11s - loss: 2.8819 - accuracy10: 0.5256 - val_loss: 3.0030 - val_accuracy10: 0.5035 - 11s/epoch - 23ms/step
Epoch 27/50
477/477 - 11s - loss: 2.8793 - accuracy10: 0.5274 - val_loss: 3.0161 - val_accuracy10: 0.4976 - 11s/epoch - 22ms/step
Epoch 28/50
477/477 - 11s - loss: 2.8747 - accuracy10: 0.5287 - val_loss: 3.0174 - val_accuracy10: 0.4969 - 11s/epoch - 22ms/step
Epoch 29/50
477/477 - 11s - loss: 2.8709 - accuracy10: 0.5307 - val_loss: 3.0117 - val_accuracy10: 0.5017 - 11s/epoch - 23ms/step
testing model: results/PCAR/W9/deepVOL_L2/h10
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0292258
{'0': {'precision': 0.4973014773404649, 'recall': 0.5047254651885281, 'f1-score': 0.5009859692117927, 'support': 61158}, '1': {'precision': 0.45796765468896616, 'recall': 0.20761185066559903, 'f1-score': 0.2857044472374787, 'support': 39964}, '2': {'precision': 0.4585552268244576, 'recall': 0.618050709467318, 'f1-score': 0.5264886133639054, 'support': 60186}, 'accuracy': 0.4733987155007811, 'macro avg': {'precision': 0.4712747862846296, 'recall': 0.4434626751071484, 'f1-score': 0.4377263432710589, 'support': 161308}, 'weighted avg': {'precision': 0.4730998337641953, 'recall': 0.4733987155007811, 'f1-score': 0.457165398606228, 'support': 161308}}
[[30868  4775 25515]
 [13260  8297 18407]
 [17943  5045 37198]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99156934
{'0': {'precision': 0.4687250959097059, 'recall': 0.6096126497457035, 'f1-score': 0.5299652152047275, 'support': 41487}, '1': {'precision': 0.6188912741507766, 'recall': 0.3765558571940788, 'f1-score': 0.46822604015731734, 'support': 39046}, '2': {'precision': 0.49496799873351877, 'recall': 0.5286728827479589, 'f1-score': 0.5112655492612276, 'support': 41398}, 'accuracy': 0.5075001435237962, 'macro avg': {'precision': 0.5275281229313337, 'recall': 0.5049471298959137, 'f1-score': 0.5031522682077575, 'support': 121931}, 'weighted avg': {'precision': 0.5257228428871034, 'recall': 0.5075001435237962, 'f1-score': 0.5038455524476749, 'support': 121931}}
[[25291  4129 12067]
 [14079 14703 10264]
 [14587  4925 21886]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.996374
{'0': {'precision': 0.45651960302643213, 'recall': 0.5929802169751117, 'f1-score': 0.51587830335332, 'support': 15670}, '1': {'precision': 0.6146616541353384, 'recall': 0.41334850208570345, 'f1-score': 0.49429370417957824, 'support': 15822}, '2': {'precision': 0.48183363768024684, 'recall': 0.4974322303841903, 'f1-score': 0.48950870010235414, 'support': 15383}, 'accuracy': 0.500992, 'macro avg': {'precision': 0.5176716316140058, 'recall': 0.5012536498150019, 'f1-score': 0.49989356921175077, 'support': 46875}, 'weighted avg': {'precision': 0.5182055620178935, 'recall': 0.500992, 'f1-score': 0.49993899380800694, 'support': 46875}}
[[9292 1895 4483]
 [5536 6540 3746]
 [5526 2205 7652]]
training model: results/PCAR/W9/deepVOL_L2/h20
Epoch 1/50
477/477 - 14s - loss: 3.3099 - accuracy20: 0.3710 - val_loss: 3.2991 - val_accuracy20: 0.3695 - 14s/epoch - 29ms/step
Epoch 2/50
477/477 - 11s - loss: 3.2286 - accuracy20: 0.4118 - val_loss: 3.2285 - val_accuracy20: 0.4154 - 11s/epoch - 22ms/step
Epoch 3/50
477/477 - 11s - loss: 3.2002 - accuracy20: 0.4238 - val_loss: 3.1956 - val_accuracy20: 0.4279 - 11s/epoch - 22ms/step
Epoch 4/50
477/477 - 11s - loss: 3.1651 - accuracy20: 0.4389 - val_loss: 3.1926 - val_accuracy20: 0.4245 - 11s/epoch - 22ms/step
Epoch 5/50
477/477 - 10s - loss: 3.1333 - accuracy20: 0.4547 - val_loss: 3.1832 - val_accuracy20: 0.4318 - 10s/epoch - 22ms/step
Epoch 6/50
477/477 - 11s - loss: 3.1176 - accuracy20: 0.4604 - val_loss: 3.1627 - val_accuracy20: 0.4400 - 11s/epoch - 23ms/step
Epoch 7/50
477/477 - 11s - loss: 3.1054 - accuracy20: 0.4641 - val_loss: 3.1571 - val_accuracy20: 0.4398 - 11s/epoch - 23ms/step
Epoch 8/50
477/477 - 11s - loss: 3.0973 - accuracy20: 0.4668 - val_loss: 3.1496 - val_accuracy20: 0.4453 - 11s/epoch - 23ms/step
Epoch 9/50
477/477 - 11s - loss: 3.0858 - accuracy20: 0.4700 - val_loss: 3.1576 - val_accuracy20: 0.4433 - 11s/epoch - 22ms/step
Epoch 10/50
477/477 - 10s - loss: 3.0804 - accuracy20: 0.4716 - val_loss: 3.1477 - val_accuracy20: 0.4460 - 10s/epoch - 22ms/step
Epoch 11/50
477/477 - 11s - loss: 3.0726 - accuracy20: 0.4734 - val_loss: 3.1461 - val_accuracy20: 0.4472 - 11s/epoch - 22ms/step
Epoch 12/50
477/477 - 11s - loss: 3.0664 - accuracy20: 0.4766 - val_loss: 3.1503 - val_accuracy20: 0.4446 - 11s/epoch - 22ms/step
Epoch 13/50
477/477 - 11s - loss: 3.0592 - accuracy20: 0.4781 - val_loss: 3.1586 - val_accuracy20: 0.4442 - 11s/epoch - 23ms/step
Epoch 14/50
477/477 - 10s - loss: 3.0559 - accuracy20: 0.4798 - val_loss: 3.1526 - val_accuracy20: 0.4465 - 10s/epoch - 22ms/step
Epoch 15/50
477/477 - 11s - loss: 3.0503 - accuracy20: 0.4805 - val_loss: 3.1487 - val_accuracy20: 0.4472 - 11s/epoch - 22ms/step
Epoch 16/50
477/477 - 11s - loss: 3.0441 - accuracy20: 0.4826 - val_loss: 3.1645 - val_accuracy20: 0.4409 - 11s/epoch - 23ms/step
Epoch 17/50
477/477 - 11s - loss: 3.0380 - accuracy20: 0.4831 - val_loss: 3.1562 - val_accuracy20: 0.4453 - 11s/epoch - 22ms/step
Epoch 18/50
477/477 - 11s - loss: 3.0321 - accuracy20: 0.4862 - val_loss: 3.1667 - val_accuracy20: 0.4415 - 11s/epoch - 22ms/step
Epoch 19/50
477/477 - 11s - loss: 3.0272 - accuracy20: 0.4875 - val_loss: 3.1744 - val_accuracy20: 0.4410 - 11s/epoch - 22ms/step
Epoch 20/50
477/477 - 11s - loss: 3.0217 - accuracy20: 0.4877 - val_loss: 3.1600 - val_accuracy20: 0.4471 - 11s/epoch - 22ms/step
Epoch 21/50
477/477 - 11s - loss: 3.0187 - accuracy20: 0.4897 - val_loss: 3.1859 - val_accuracy20: 0.4352 - 11s/epoch - 22ms/step
testing model: results/PCAR/W9/deepVOL_L2/h20
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0658225
{'0': {'precision': 0.450599252287016, 'recall': 0.6271898268217184, 'f1-score': 0.5244277799541106, 'support': 59765}, '1': {'precision': 0.4664179104477612, 'recall': 0.05171343859891057, 'f1-score': 0.09310409037303705, 'support': 43509}, '2': {'precision': 0.4315319863023043, 'recall': 0.5450253299789778, 'f1-score': 0.48168368473551554, 'support': 58034}, 'accuracy': 0.44240831204899944, 'macro avg': {'precision': 0.4495163830123605, 'recall': 0.4079761984665356, 'f1-score': 0.36640518502088776, 'support': 161308}, 'weighted avg': {'precision': 0.4480061030554782, 'recall': 0.44240831204899944, 'f1-score': 0.3927103621453294, 'support': 161308}}
[[37484  1481 20800]
 [20392  2250 20867]
 [25311  1093 31630]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.052198
{'0': {'precision': 0.412306781834322, 'recall': 0.7221015744533833, 'f1-score': 0.5249033554277924, 'support': 40522}, '1': {'precision': 0.6310425160163076, 'recall': 0.15949851566525183, 'f1-score': 0.2546366111121991, 'support': 40759}, '2': {'precision': 0.45484505656665025, 'recall': 0.45495694956949567, 'f1-score': 0.4549009961874308, 'support': 40650}, 'accuracy': 0.44497297651950696, 'macro avg': {'precision': 0.49939811813909324, 'recall': 0.4455190132293769, 'f1-score': 0.41148032090914083, 'support': 121931}, 'weighted avg': {'precision': 0.49960722763885657, 'recall': 0.4449729765195069, 'f1-score': 0.41122104219588285, 'support': 121931}}
[[29261  1792  9469]
 [21561  6501 12697]
 [20147  2009 18494]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.049959
{'0': {'precision': 0.40762022289923255, 'recall': 0.6935695538057742, 'f1-score': 0.5134682179203808, 'support': 15240}, '1': {'precision': 0.6415165165165165, 'recall': 0.20498980448602616, 'f1-score': 0.31069902736114896, 'support': 16674}, '2': {'precision': 0.44473616803278687, 'recall': 0.4642069380389011, 'f1-score': 0.4542630081433758, 'support': 14961}, 'accuracy': 0.44657066666666667, 'macro avg': {'precision': 0.49795763581617863, 'recall': 0.45425543211023384, 'f1-score': 0.42614341780830184, 'support': 46875}, 'weighted avg': {'precision': 0.50266616327081, 'recall': 0.44657066666666667, 'f1-score': 0.42244437521406825, 'support': 46875}}
[[10570   960  3710]
 [ 8295  3418  4961]
 [ 7066   950  6945]]
training model: results/PCAR/W9/deepVOL_L2/h30
Epoch 1/50
477/477 - 14s - loss: 3.3167 - accuracy30: 0.3653 - val_loss: 3.3009 - val_accuracy30: 0.3720 - 14s/epoch - 29ms/step
Epoch 2/50
477/477 - 11s - loss: 3.2521 - accuracy30: 0.3987 - val_loss: 3.2719 - val_accuracy30: 0.3842 - 11s/epoch - 23ms/step
Epoch 3/50
477/477 - 11s - loss: 3.2275 - accuracy30: 0.4120 - val_loss: 3.2334 - val_accuracy30: 0.4058 - 11s/epoch - 23ms/step
Epoch 4/50
477/477 - 11s - loss: 3.2014 - accuracy30: 0.4232 - val_loss: 3.2422 - val_accuracy30: 0.3975 - 11s/epoch - 23ms/step
Epoch 5/50
477/477 - 11s - loss: 3.1826 - accuracy30: 0.4325 - val_loss: 3.2303 - val_accuracy30: 0.4097 - 11s/epoch - 23ms/step
Epoch 6/50
477/477 - 11s - loss: 3.1656 - accuracy30: 0.4404 - val_loss: 3.2265 - val_accuracy30: 0.4126 - 11s/epoch - 23ms/step
Epoch 7/50
477/477 - 11s - loss: 3.1537 - accuracy30: 0.4439 - val_loss: 3.2239 - val_accuracy30: 0.4133 - 11s/epoch - 23ms/step
Epoch 8/50
477/477 - 11s - loss: 3.1442 - accuracy30: 0.4491 - val_loss: 3.2287 - val_accuracy30: 0.4123 - 11s/epoch - 23ms/step
Epoch 9/50
477/477 - 11s - loss: 3.1345 - accuracy30: 0.4514 - val_loss: 3.2215 - val_accuracy30: 0.4148 - 11s/epoch - 23ms/step
Epoch 10/50
477/477 - 11s - loss: 3.1279 - accuracy30: 0.4525 - val_loss: 3.2239 - val_accuracy30: 0.4179 - 11s/epoch - 23ms/step
Epoch 11/50
477/477 - 11s - loss: 3.1216 - accuracy30: 0.4556 - val_loss: 3.2120 - val_accuracy30: 0.4212 - 11s/epoch - 23ms/step
Epoch 12/50
477/477 - 11s - loss: 3.1138 - accuracy30: 0.4576 - val_loss: 3.2072 - val_accuracy30: 0.4216 - 11s/epoch - 24ms/step
Epoch 13/50
477/477 - 11s - loss: 3.1099 - accuracy30: 0.4578 - val_loss: 3.2092 - val_accuracy30: 0.4226 - 11s/epoch - 22ms/step
Epoch 14/50
477/477 - 11s - loss: 3.1046 - accuracy30: 0.4598 - val_loss: 3.2109 - val_accuracy30: 0.4217 - 11s/epoch - 23ms/step
Epoch 15/50
477/477 - 11s - loss: 3.1002 - accuracy30: 0.4612 - val_loss: 3.2088 - val_accuracy30: 0.4224 - 11s/epoch - 23ms/step
Epoch 16/50
477/477 - 11s - loss: 3.0975 - accuracy30: 0.4611 - val_loss: 3.2024 - val_accuracy30: 0.4240 - 11s/epoch - 23ms/step
Epoch 17/50
477/477 - 11s - loss: 3.0914 - accuracy30: 0.4638 - val_loss: 3.2118 - val_accuracy30: 0.4222 - 11s/epoch - 22ms/step
Epoch 18/50
477/477 - 11s - loss: 3.0876 - accuracy30: 0.4644 - val_loss: 3.2199 - val_accuracy30: 0.4214 - 11s/epoch - 23ms/step
Epoch 19/50
477/477 - 11s - loss: 3.0836 - accuracy30: 0.4659 - val_loss: 3.2131 - val_accuracy30: 0.4244 - 11s/epoch - 23ms/step
Epoch 20/50
477/477 - 11s - loss: 3.0785 - accuracy30: 0.4687 - val_loss: 3.2245 - val_accuracy30: 0.4181 - 11s/epoch - 23ms/step
Epoch 21/50
477/477 - 12s - loss: 3.0743 - accuracy30: 0.4687 - val_loss: 3.2260 - val_accuracy30: 0.4189 - 12s/epoch - 24ms/step
Epoch 22/50
477/477 - 11s - loss: 3.0703 - accuracy30: 0.4703 - val_loss: 3.2370 - val_accuracy30: 0.4179 - 11s/epoch - 23ms/step
Epoch 23/50
477/477 - 11s - loss: 3.0685 - accuracy30: 0.4717 - val_loss: 3.2311 - val_accuracy30: 0.4195 - 11s/epoch - 23ms/step
Epoch 24/50
477/477 - 11s - loss: 3.0643 - accuracy30: 0.4727 - val_loss: 3.2218 - val_accuracy30: 0.4201 - 11s/epoch - 23ms/step
Epoch 25/50
477/477 - 12s - loss: 3.0573 - accuracy30: 0.4752 - val_loss: 3.2245 - val_accuracy30: 0.4220 - 12s/epoch - 24ms/step
Epoch 26/50
477/477 - 11s - loss: 3.0543 - accuracy30: 0.4755 - val_loss: 3.2322 - val_accuracy30: 0.4208 - 11s/epoch - 23ms/step
testing model: results/PCAR/W9/deepVOL_L2/h30
Evaluating performance on  test set...
631/631 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0696901
{'0': {'precision': 0.4444026454705418, 'recall': 0.6088279301745636, 'f1-score': 0.5137806460664304, 'support': 60150}, '1': {'precision': 0.36805357651752635, 'recall': 0.05870054314478558, 'f1-score': 0.10125242547186453, 'support': 44003}, '2': {'precision': 0.42396883911803573, 'recall': 0.5332341877351063, 'f1-score': 0.47236515809051455, 'support': 57155}, 'accuracy': 0.4319748555558311, 'macro avg': {'precision': 0.41214168703536797, 'recall': 0.40025422035148517, 'f1-score': 0.36246607654293644, 'support': 161308}, 'weighted avg': {'precision': 0.41633533149220836, 'recall': 0.4319748555558311, 'f1-score': 0.38657318266668483, 'support': 161308}}
[[36621  2402 21127]
 [21139  2583 20281]
 [24645  2033 30477]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0616215
{'0': {'precision': 0.4064450370701331, 'recall': 0.7131482887870845, 'f1-score': 0.5177872643187478, 'support': 40819}, '1': {'precision': 0.5262773722627737, 'recall': 0.12670398915472095, 'f1-score': 0.2042368937539202, 'support': 39833}, '2': {'precision': 0.4537328094302554, 'recall': 0.4475883621211754, 'f1-score': 0.450639641946853, 'support': 41279}, 'accuracy': 0.43166216958771764, 'macro avg': {'precision': 0.46215173958772066, 'recall': 0.4291468800209936, 'f1-score': 0.3908879333398403, 'support': 121931}, 'weighted avg': {'precision': 0.46160142357546763, 'recall': 0.43166216958771764, 'f1-score': 0.3926227153968311, 'support': 121931}}
[[29110  2043  9666]
 [22208  5047 12578]
 [20303  2500 18476]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.065348
{'0': {'precision': 0.4018649078917444, 'recall': 0.6875486381322957, 'f1-score': 0.5072484570116262, 'support': 15420}, '1': {'precision': 0.5209147771696638, 'recall': 0.1625, 'f1-score': 0.24772262502323855, 'support': 16400}, '2': {'precision': 0.434024842296937, 'recall': 0.44330787113915643, 'f1-score': 0.4386172450052576, 'support': 15055}, 'accuracy': 0.425408, 'macro avg': {'precision': 0.4522681757861151, 'recall': 0.4311188364238174, 'f1-score': 0.3978627756800408, 'support': 46875}, 'weighted avg': {'precision': 0.4538454021558095, 'recall': 0.425408, 'f1-score': 0.39440650412916356, 'support': 46875}}
[[10602  1175  3643]
 [ 8675  2665  5060]
 [ 7105  1276  6674]]
training model: results/PCAR/W9/deepVOL_L2/h50
Epoch 1/50
477/477 - 13s - loss: 3.3048 - accuracy50: 0.3767 - val_loss: 3.2887 - val_accuracy50: 0.3593 - 13s/epoch - 27ms/step
Epoch 2/50
477/477 - 11s - loss: 3.2534 - accuracy50: 0.3992 - val_loss: 3.2836 - val_accuracy50: 0.3670 - 11s/epoch - 23ms/step
Epoch 3/50
477/477 - 11s - loss: 3.2371 - accuracy50: 0.4096 - val_loss: 3.2684 - val_accuracy50: 0.3745 - 11s/epoch - 22ms/step
Epoch 4/50
477/477 - 11s - loss: 3.2258 - accuracy50: 0.4131 - val_loss: 3.2585 - val_accuracy50: 0.3835 - 11s/epoch - 23ms/step
Epoch 5/50
477/477 - 11s - loss: 3.2157 - accuracy50: 0.4192 - val_loss: 3.2530 - val_accuracy50: 0.3859 - 11s/epoch - 23ms/step
Epoch 6/50
477/477 - 10s - loss: 3.2020 - accuracy50: 0.4258 - val_loss: 3.2463 - val_accuracy50: 0.3941 - 10s/epoch - 22ms/step
Epoch 7/50
477/477 - 11s - loss: 3.1898 - accuracy50: 0.4297 - val_loss: 3.2453 - val_accuracy50: 0.3963 - 11s/epoch - 22ms/step
Epoch 8/50
477/477 - 10s - loss: 3.1775 - accuracy50: 0.4355 - val_loss: 3.2445 - val_accuracy50: 0.3987 - 10s/epoch - 22ms/step
Epoch 9/50
477/477 - 10s - loss: 3.1677 - accuracy50: 0.4391 - val_loss: 3.2496 - val_accuracy50: 0.3973 - 10s/epoch - 22ms/step
Epoch 10/50
477/477 - 10s - loss: 3.1611 - accuracy50: 0.4409 - val_loss: 3.2564 - val_accuracy50: 0.3960 - 10s/epoch - 22ms/step
Epoch 11/50
477/477 - 11s - loss: 3.1583 - accuracy50: 0.4417 - val_loss: 3.2515 - val_accuracy50: 0.3964 - 11s/epoch - 22ms/step
Epoch 12/50
477/477 - 10s - loss: 3.1570 - accuracy50: 0.4412 - val_loss: 3.2423 - val_accuracy50: 0.4014 - 10s/epoch - 22ms/step
Epoch 13/50
477/477 - 10s - loss: 3.1494 - accuracy50: 0.4441 - val_loss: 3.2483 - val_accuracy50: 0.4005 - 10s/epoch - 22ms/step
Epoch 14/50
477/477 - 10s - loss: 3.1433 - accuracy50: 0.4471 - val_loss: 3.2493 - val_accuracy50: 0.3979 - 10s/epoch - 22ms/step
Epoch 15/50
477/477 - 10s - loss: 3.1393 - accuracy50: 0.4472 - val_loss: 3.2515 - val_accuracy50: 0.3950 - 10s/epoch - 22ms/step
Epoch 16/50
477/477 - 11s - loss: 3.1358 - accuracy50: 0.4494 - val_loss: 3.2480 - val_accuracy50: 0.3963 - 11s/epoch - 22ms/step
Epoch 17/50
477/477 - 11s - loss: 3.1310 - accuracy50: 0.4514 - val_loss: 3.2575 - val_accuracy50: 0.3949 - 11s/epoch - 22ms/step
Epoch 18/50
477/477 - 11s - loss: 3.1259 - accuracy50: 0.4511 - val_loss: 3.2579 - val_accuracy50: 0.3953 - 11s/epoch - 22ms/step
Epoch 19/50
477/477 - 10s - loss: 3.1222 - accuracy50: 0.4539 - val_loss: 3.2579 - val_accuracy50: 0.3941 - 10s/epoch - 22ms/step
Epoch 20/50
477/477 - 11s - loss: 3.1155 - accuracy50: 0.4544 - val_loss: 3.2759 - val_accuracy50: 0.3839 - 11s/epoch - 22ms/step
Epoch 21/50
477/477 - 11s - loss: 3.1128 - accuracy50: 0.4544 - val_loss: 3.2786 - val_accuracy50: 0.3900 - 11s/epoch - 22ms/step
Epoch 22/50
477/477 - 11s - loss: 3.1065 - accuracy50: 0.4584 - val_loss: 3.2626 - val_accuracy50: 0.3974 - 11s/epoch - 22ms/step
testing model: results/PCAR/W9/deepVOL_L2/h50
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0795645
{'0': {'precision': 0.4712829559933353, 'recall': 0.45445380798613844, 'f1-score': 0.4627154118184807, 'support': 63485}, '1': {'precision': 0.30828935113318845, 'recall': 0.15161076899587766, 'f1-score': 0.2032614628820961, 'support': 39298}, '2': {'precision': 0.412708632559061, 'recall': 0.5695343870140965, 'f1-score': 0.4786020432338519, 'support': 58525}, 'accuracy': 0.42242790190195156, 'macro avg': {'precision': 0.3974269798951949, 'recall': 0.3918663213320375, 'f1-score': 0.38152630597814285, 'support': 161308}, 'weighted avg': {'precision': 0.41032265047355354, 'recall': 0.42242790190195156, 'f1-score': 0.4052709194082007, 'support': 161308}}
[[28851  7146 27488]
 [13396  5958 19944]
 [18971  6222 33332]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0730556
{'0': {'precision': 0.4050864449408164, 'recall': 0.5688037143139385, 'f1-score': 0.4731841107766901, 'support': 40492}, '1': {'precision': 0.42299404884055, 'recall': 0.20467183000695066, 'f1-score': 0.2758632226980728, 'support': 40284}, '2': {'precision': 0.42246939581413717, 'recall': 0.46791398372008264, 'f1-score': 0.4440319586796869, 'support': 41155}, 'accuracy': 0.414447515398053, 'macro avg': {'precision': 0.4168499631985012, 'recall': 0.4137965093469906, 'f1-score': 0.3976930973848167, 'support': 121931}, 'weighted avg': {'precision': 0.4168700377817542, 'recall': 0.414447515398053, 'f1-score': 0.3981528925064292, 'support': 121931}}
[[23032  5324 12136]
 [17850  8245 14189]
 [15975  5923 19257]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.080169
{'0': {'precision': 0.3933439458760322, 'recall': 0.5229497354497354, 'f1-score': 0.44898075066719667, 'support': 15120}, '1': {'precision': 0.4354408684060179, 'recall': 0.2693009834520935, 'f1-score': 0.33278754138922245, 'support': 16981}, '2': {'precision': 0.3949972343433102, 'recall': 0.435020982807635, 'f1-score': 0.4140441294894508, 'support': 14774}, 'accuracy': 0.40334933333333334, 'macro avg': {'precision': 0.4079273495417868, 'recall': 0.40909056723648796, 'f1-score': 0.39860414051529, 'support': 46875}, 'weighted avg': {'precision': 0.4091151144157069, 'recall': 0.40334933333333334, 'f1-score': 0.3958771660692384, 'support': 46875}}
[[7907 2865 4348]
 [6912 4573 5496]
 [5283 3064 6427]]
training model: results/PCAR/W9/deepVOL_L2/h100
Epoch 1/50
477/477 - 13s - loss: 3.3217 - accuracy100: 0.3630 - val_loss: 3.2997 - val_accuracy100: 0.3489 - 13s/epoch - 27ms/step
Epoch 2/50
477/477 - 11s - loss: 3.2895 - accuracy100: 0.3701 - val_loss: 3.2963 - val_accuracy100: 0.3526 - 11s/epoch - 23ms/step
Epoch 3/50
477/477 - 11s - loss: 3.2706 - accuracy100: 0.3821 - val_loss: 3.2810 - val_accuracy100: 0.3701 - 11s/epoch - 22ms/step
Epoch 4/50
477/477 - 11s - loss: 3.2489 - accuracy100: 0.3940 - val_loss: 3.2760 - val_accuracy100: 0.3725 - 11s/epoch - 23ms/step
Epoch 5/50
477/477 - 11s - loss: 3.2391 - accuracy100: 0.3990 - val_loss: 3.2734 - val_accuracy100: 0.3776 - 11s/epoch - 23ms/step
Epoch 6/50
477/477 - 11s - loss: 3.2277 - accuracy100: 0.4053 - val_loss: 3.2700 - val_accuracy100: 0.3774 - 11s/epoch - 22ms/step
Epoch 7/50
477/477 - 10s - loss: 3.2209 - accuracy100: 0.4098 - val_loss: 3.2729 - val_accuracy100: 0.3777 - 10s/epoch - 22ms/step
Epoch 8/50
477/477 - 52s - loss: 3.2131 - accuracy100: 0.4110 - val_loss: 3.2686 - val_accuracy100: 0.3836 - 52s/epoch - 109ms/step
Epoch 9/50
477/477 - 11s - loss: 3.2070 - accuracy100: 0.4139 - val_loss: 3.2715 - val_accuracy100: 0.3802 - 11s/epoch - 23ms/step
Epoch 10/50
477/477 - 11s - loss: 3.1985 - accuracy100: 0.4187 - val_loss: 3.2775 - val_accuracy100: 0.3772 - 11s/epoch - 22ms/step
Epoch 11/50
477/477 - 10s - loss: 3.1953 - accuracy100: 0.4196 - val_loss: 3.2868 - val_accuracy100: 0.3660 - 10s/epoch - 22ms/step
Epoch 12/50
477/477 - 11s - loss: 3.1874 - accuracy100: 0.4213 - val_loss: 3.2887 - val_accuracy100: 0.3680 - 11s/epoch - 23ms/step
Epoch 13/50
477/477 - 11s - loss: 3.1836 - accuracy100: 0.4244 - val_loss: 3.2883 - val_accuracy100: 0.3685 - 11s/epoch - 23ms/step
Epoch 14/50
477/477 - 10s - loss: 3.1783 - accuracy100: 0.4259 - val_loss: 3.2889 - val_accuracy100: 0.3688 - 10s/epoch - 22ms/step
Epoch 15/50
477/477 - 10s - loss: 3.1711 - accuracy100: 0.4288 - val_loss: 3.2923 - val_accuracy100: 0.3661 - 10s/epoch - 22ms/step
Epoch 16/50
477/477 - 10s - loss: 3.1666 - accuracy100: 0.4311 - val_loss: 3.2926 - val_accuracy100: 0.3660 - 10s/epoch - 22ms/step
Epoch 17/50
477/477 - 11s - loss: 3.1609 - accuracy100: 0.4331 - val_loss: 3.3001 - val_accuracy100: 0.3602 - 11s/epoch - 24ms/step
Epoch 18/50
477/477 - 10s - loss: 3.1544 - accuracy100: 0.4374 - val_loss: 3.3030 - val_accuracy100: 0.3624 - 10s/epoch - 22ms/step
testing model: results/PCAR/W9/deepVOL_L2/h100
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0889843
{'0': {'precision': 0.4156303465182197, 'recall': 0.5434194711538461, 'f1-score': 0.4710112424580036, 'support': 59904}, '1': {'precision': 0.35720758726289803, 'recall': 0.2454742628900294, 'f1-score': 0.29098360655737704, 'support': 46567}, '2': {'precision': 0.36746101794645486, 'recall': 0.34164888670058535, 'f1-score': 0.3540851618756024, 'support': 54837}, 'accuracy': 0.38881518585563024, 'macro avg': {'precision': 0.38009965057585754, 'recall': 0.37684754024815365, 'f1-score': 0.3720266702969943, 'support': 161308}, 'weighted avg': {'precision': 0.38238937830131514, 'recall': 0.38881518585563024, 'f1-score': 0.37929091611410487, 'support': 161308}}
[[32553 10668 16683]
 [19569 11431 15567]
 [26200  9902 18735]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0860894
{'0': {'precision': 0.37483479925260904, 'recall': 0.6125868917576961, 'f1-score': 0.46508778708686355, 'support': 40280}, '1': {'precision': 0.4047224943417897, 'recall': 0.29738383637807786, 'f1-score': 0.3428481492609921, 'support': 40288}, '2': {'precision': 0.4023548058417299, 'recall': 0.25776660300268356, 'f1-score': 0.3142259290913914, 'support': 41363}, 'accuracy': 0.388071942328038, 'macro avg': {'precision': 0.3939706998120429, 'recall': 0.38924577704615254, 'f1-score': 0.3740539551464157, 'support': 121931}, 'weighted avg': {'precision': 0.39404587348556636, 'recall': 0.388071942328038, 'f1-score': 0.3735205108322981, 'support': 121931}}
[[24675  8292  7313]
 [19783 11981  8524]
 [21371  9330 10662]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0904627
{'0': {'precision': 0.3774950548462507, 'recall': 0.5334137974844365, 'f1-score': 0.44211025114515873, 'support': 15742}, '1': {'precision': 0.3864035087719298, 'recall': 0.3888153332072379, 'f1-score': 0.3876056692121555, 'support': 15861}, '2': {'precision': 0.3808095952023988, 'recall': 0.21621267679413306, 'f1-score': 0.2758217433070208, 'support': 15272}, 'accuracy': 0.38114133333333333, 'macro avg': {'precision': 0.3815693862735265, 'recall': 0.3794806024952691, 'f1-score': 0.3685125545547783, 'support': 46875}, 'weighted avg': {'precision': 0.3815892766709823, 'recall': 0.38114133333333333, 'f1-score': 0.369490405475966, 'support': 46875}}
[[8397 4819 2526]
 [6851 6167 2843]
 [6996 4974 3302]]
training model: results/PCAR/W9/deepVOL_L2/h200
Epoch 1/50
477/477 - 14s - loss: 3.3278 - accuracy200: 0.3580 - val_loss: 3.2955 - val_accuracy200: 0.3707 - 14s/epoch - 28ms/step
Epoch 2/50
477/477 - 10s - loss: 3.2802 - accuracy200: 0.3737 - val_loss: 3.2747 - val_accuracy200: 0.3770 - 10s/epoch - 22ms/step
Epoch 3/50
477/477 - 10s - loss: 3.2540 - accuracy200: 0.3906 - val_loss: 3.2583 - val_accuracy200: 0.3959 - 10s/epoch - 22ms/step
Epoch 4/50
477/477 - 10s - loss: 3.2397 - accuracy200: 0.3984 - val_loss: 3.2645 - val_accuracy200: 0.3887 - 10s/epoch - 22ms/step
Epoch 5/50
477/477 - 10s - loss: 3.2371 - accuracy200: 0.4005 - val_loss: 3.2539 - val_accuracy200: 0.3937 - 10s/epoch - 22ms/step
Epoch 6/50
477/477 - 10s - loss: 3.2313 - accuracy200: 0.4001 - val_loss: 3.2546 - val_accuracy200: 0.3961 - 10s/epoch - 22ms/step
Epoch 7/50
477/477 - 10s - loss: 3.2242 - accuracy200: 0.4036 - val_loss: 3.2571 - val_accuracy200: 0.3940 - 10s/epoch - 22ms/step
Epoch 8/50
477/477 - 10s - loss: 3.2186 - accuracy200: 0.4071 - val_loss: 3.2538 - val_accuracy200: 0.3916 - 10s/epoch - 22ms/step
Epoch 9/50
477/477 - 11s - loss: 3.2127 - accuracy200: 0.4079 - val_loss: 3.2614 - val_accuracy200: 0.3875 - 11s/epoch - 23ms/step
Epoch 10/50
477/477 - 11s - loss: 3.2125 - accuracy200: 0.4088 - val_loss: 3.2583 - val_accuracy200: 0.3881 - 11s/epoch - 22ms/step
Epoch 11/50
477/477 - 10s - loss: 3.2042 - accuracy200: 0.4131 - val_loss: 3.2537 - val_accuracy200: 0.3920 - 10s/epoch - 22ms/step
Epoch 12/50
477/477 - 10s - loss: 3.1959 - accuracy200: 0.4155 - val_loss: 3.2518 - val_accuracy200: 0.3926 - 10s/epoch - 22ms/step
Epoch 13/50
477/477 - 11s - loss: 3.1997 - accuracy200: 0.4147 - val_loss: 3.2513 - val_accuracy200: 0.3938 - 11s/epoch - 22ms/step
Epoch 14/50
477/477 - 11s - loss: 3.1874 - accuracy200: 0.4203 - val_loss: 3.2513 - val_accuracy200: 0.3918 - 11s/epoch - 23ms/step
Epoch 15/50
477/477 - 10s - loss: 3.1837 - accuracy200: 0.4213 - val_loss: 3.2540 - val_accuracy200: 0.3921 - 10s/epoch - 22ms/step
Epoch 16/50
477/477 - 10s - loss: 3.1760 - accuracy200: 0.4228 - val_loss: 3.2627 - val_accuracy200: 0.3814 - 10s/epoch - 22ms/step
Epoch 17/50
477/477 - 11s - loss: 3.1696 - accuracy200: 0.4276 - val_loss: 3.2651 - val_accuracy200: 0.3860 - 11s/epoch - 22ms/step
Epoch 18/50
477/477 - 10s - loss: 3.1639 - accuracy200: 0.4294 - val_loss: 3.2656 - val_accuracy200: 0.3847 - 10s/epoch - 22ms/step
Epoch 19/50
477/477 - 10s - loss: 3.1571 - accuracy200: 0.4314 - val_loss: 3.2706 - val_accuracy200: 0.3811 - 10s/epoch - 22ms/step
Epoch 20/50
477/477 - 11s - loss: 3.1535 - accuracy200: 0.4336 - val_loss: 3.2745 - val_accuracy200: 0.3782 - 11s/epoch - 23ms/step
Epoch 21/50
477/477 - 11s - loss: 3.1466 - accuracy200: 0.4366 - val_loss: 3.2704 - val_accuracy200: 0.3839 - 11s/epoch - 22ms/step
Epoch 22/50
477/477 - 11s - loss: 3.1393 - accuracy200: 0.4386 - val_loss: 3.2774 - val_accuracy200: 0.3801 - 11s/epoch - 22ms/step
Epoch 23/50
477/477 - 10s - loss: 3.1343 - accuracy200: 0.4417 - val_loss: 3.2836 - val_accuracy200: 0.3788 - 10s/epoch - 22ms/step
testing model: results/PCAR/W9/deepVOL_L2/h200
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0964903
{'0': {'precision': 0.422530745362716, 'recall': 0.28966245380865135, 'f1-score': 0.3437025027865032, 'support': 64406}, '1': {'precision': 0.28688979466865683, 'recall': 0.38659102630221764, 'f1-score': 0.32936058965036197, 'support': 38780}, '2': {'precision': 0.37132115011248423, 'recall': 0.4146106465710058, 'f1-score': 0.39177369533409206, 'support': 58122}, 'accuracy': 0.35798596473826466, 'macro avg': {'precision': 0.3602472300479524, 'recall': 0.36362137556062496, 'f1-score': 0.35494559592365243, 'support': 161308}, 'weighted avg': {'precision': 0.37146966864581676, 'recall': 0.35798596473826466, 'f1-score': 0.3575754319768186, 'support': 161308}}
[[18656 19131 26619]
 [ 9607 14992 14181]
 [15890 18134 24098]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0811005
{'0': {'precision': 0.37492414448167594, 'recall': 0.35378180550714533, 'f1-score': 0.3640462679493256, 'support': 40166}, '1': {'precision': 0.4028280377350597, 'recall': 0.4791262377469274, 'f1-score': 0.4376768445813116, 'support': 40194}, '2': {'precision': 0.3950252601937995, 'recall': 0.34420629765942606, 'f1-score': 0.3678689873255007, 'support': 41571}, 'accuracy': 0.39183636646956066, 'macro avg': {'precision': 0.3909258141368451, 'recall': 0.39237144697116627, 'f1-score': 0.38986403328537933, 'support': 121931}, 'weighted avg': {'precision': 0.3909757848905563, 'recall': 0.39183636646956066, 'f1-score': 0.38962156598127007, 'support': 121931}}
[[14210 13654 12302]
 [11324 19258  9612]
 [12367 14895 14309]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0833877
{'0': {'precision': 0.37328597389724105, 'recall': 0.2901072093471143, 'f1-score': 0.32648195643535743, 'support': 15577}, '1': {'precision': 0.4166813225466057, 'recall': 0.5788541412167114, 'f1-score': 0.4845587483382759, 'support': 16372}, '2': {'precision': 0.3654885654885655, 'recall': 0.29445263298941443, 'f1-score': 0.3261474527846833, 'support': 14926}, 'accuracy': 0.3923413333333333, 'macro avg': {'precision': 0.38515195397747076, 'recall': 0.3878046611844134, 'f1-score': 0.37906271918610557, 'support': 46875}, 'weighted avg': {'precision': 0.38595977720773716, 'recall': 0.3923413333333333, 'f1-score': 0.38158681906030933, 'support': 46875}}
[[4519 6659 4399]
 [3664 9477 3231]
 [3923 6608 4395]]
training model: results/PCAR/W9/deepVOL_L2/h300
Epoch 1/50
477/477 - 13s - loss: 3.3205 - accuracy300: 0.3634 - val_loss: 3.2994 - val_accuracy300: 0.3550 - 13s/epoch - 26ms/step
Epoch 2/50
477/477 - 10s - loss: 3.2773 - accuracy300: 0.3728 - val_loss: 3.2767 - val_accuracy300: 0.3765 - 10s/epoch - 22ms/step
Epoch 3/50
477/477 - 11s - loss: 3.2661 - accuracy300: 0.3856 - val_loss: 3.2864 - val_accuracy300: 0.3756 - 11s/epoch - 22ms/step
Epoch 4/50
477/477 - 10s - loss: 3.2634 - accuracy300: 0.3815 - val_loss: 3.2554 - val_accuracy300: 0.3984 - 10s/epoch - 22ms/step
Epoch 5/50
477/477 - 10s - loss: 3.2431 - accuracy300: 0.3943 - val_loss: 3.2462 - val_accuracy300: 0.3970 - 10s/epoch - 22ms/step
Epoch 6/50
477/477 - 10s - loss: 3.2340 - accuracy300: 0.3997 - val_loss: 3.2423 - val_accuracy300: 0.3980 - 10s/epoch - 22ms/step
Epoch 7/50
477/477 - 10s - loss: 3.2272 - accuracy300: 0.4033 - val_loss: 3.2441 - val_accuracy300: 0.3994 - 10s/epoch - 22ms/step
Epoch 8/50
477/477 - 10s - loss: 3.2222 - accuracy300: 0.4062 - val_loss: 3.2448 - val_accuracy300: 0.3970 - 10s/epoch - 22ms/step
Epoch 9/50
477/477 - 10s - loss: 3.2175 - accuracy300: 0.4091 - val_loss: 3.2522 - val_accuracy300: 0.3927 - 10s/epoch - 22ms/step
Epoch 10/50
477/477 - 11s - loss: 3.2119 - accuracy300: 0.4096 - val_loss: 3.2467 - val_accuracy300: 0.3963 - 11s/epoch - 23ms/step
Epoch 11/50
477/477 - 11s - loss: 3.2067 - accuracy300: 0.4126 - val_loss: 3.2406 - val_accuracy300: 0.4004 - 11s/epoch - 22ms/step
Epoch 12/50
477/477 - 11s - loss: 3.2021 - accuracy300: 0.4141 - val_loss: 3.2490 - val_accuracy300: 0.3970 - 11s/epoch - 22ms/step
Epoch 13/50
477/477 - 10s - loss: 3.1967 - accuracy300: 0.4164 - val_loss: 3.2563 - val_accuracy300: 0.3965 - 10s/epoch - 22ms/step
Epoch 14/50
477/477 - 12s - loss: 3.1916 - accuracy300: 0.4187 - val_loss: 3.2652 - val_accuracy300: 0.3919 - 12s/epoch - 25ms/step
Epoch 15/50
477/477 - 10s - loss: 3.1875 - accuracy300: 0.4205 - val_loss: 3.2698 - val_accuracy300: 0.3806 - 10s/epoch - 22ms/step
Epoch 16/50
477/477 - 10s - loss: 3.1827 - accuracy300: 0.4218 - val_loss: 3.2686 - val_accuracy300: 0.3890 - 10s/epoch - 22ms/step
Epoch 17/50
477/477 - 10s - loss: 3.1786 - accuracy300: 0.4235 - val_loss: 3.2695 - val_accuracy300: 0.3804 - 10s/epoch - 22ms/step
Epoch 18/50
477/477 - 10s - loss: 3.1751 - accuracy300: 0.4251 - val_loss: 3.2663 - val_accuracy300: 0.3839 - 10s/epoch - 22ms/step
Epoch 19/50
477/477 - 10s - loss: 3.1710 - accuracy300: 0.4277 - val_loss: 3.2687 - val_accuracy300: 0.3812 - 10s/epoch - 22ms/step
Epoch 20/50
477/477 - 10s - loss: 3.1680 - accuracy300: 0.4263 - val_loss: 3.2610 - val_accuracy300: 0.3842 - 10s/epoch - 22ms/step
Epoch 21/50
477/477 - 11s - loss: 3.1666 - accuracy300: 0.4291 - val_loss: 3.2638 - val_accuracy300: 0.3841 - 11s/epoch - 22ms/step
testing model: results/PCAR/W9/deepVOL_L2/h300
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0843071
{'0': {'precision': 0.42183307954463056, 'recall': 0.3897561302425298, 'f1-score': 0.40516070620190126, 'support': 59704}, '1': {'precision': 0.38381688100776895, 'recall': 0.3654047051940997, 'f1-score': 0.3743845528107206, 'support': 47862}, '2': {'precision': 0.35091947571725707, 'recall': 0.395556547951323, 'f1-score': 0.37190342897130857, 'support': 53742}, 'accuracy': 0.3844632628263942, 'macro avg': {'precision': 0.38552314542321886, 'recall': 0.3835724611293175, 'f1-score': 0.3838162293279768, 'support': 161308}, 'weighted avg': {'precision': 0.3869273700245697, 'recall': 0.3844632628263942, 'f1-score': 0.3849489321638176, 'support': 161308}}
[[23270 14392 22042]
 [13095 17489 17278]
 [18799 13685 21258]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0791616
{'0': {'precision': 0.3755926561081408, 'recall': 0.37372647427854455, 'f1-score': 0.3746572413272622, 'support': 39850}, '1': {'precision': 0.42048873709034723, 'recall': 0.5132003374522356, 'f1-score': 0.4622415912392446, 'support': 40302}, '2': {'precision': 0.39225166963827024, 'recall': 0.3106824002489289, 'f1-score': 0.3467343395218379, 'support': 41779}, 'accuracy': 0.3982252257424281, 'macro avg': {'precision': 0.3961110209455861, 'recall': 0.399203070659903, 'f1-score': 0.39454439069611486, 'support': 121931}, 'weighted avg': {'precision': 0.3961403329255225, 'recall': 0.3982252257424281, 'f1-score': 0.39403896997398774, 'support': 121931}}
[[14893 14025 10932]
 [10440 20683  9179]
 [14319 14480 12980]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0801893
{'0': {'precision': 0.38555930997688065, 'recall': 0.2795976270312097, 'f1-score': 0.3241384465874262, 'support': 15508}, '1': {'precision': 0.43182934818211594, 'recall': 0.6380520266182698, 'f1-score': 0.5150656834497241, 'support': 16530}, '2': {'precision': 0.33850959393128066, 'recall': 0.255644672103525, 'f1-score': 0.2912986713770064, 'support': 14837}, 'accuracy': 0.39842133333333335, 'macro avg': {'precision': 0.3852994173634257, 'recall': 0.3910981085843348, 'f1-score': 0.37683426713805224, 'support': 46875}, 'weighted avg': {'precision': 0.3869836746609121, 'recall': 0.39842133333333335, 'f1-score': 0.38107249417221095, 'support': 46875}}
[[ 4336  6906  4266]
 [ 2837 10547  3146]
 [ 4073  6971  3793]]
training model: results/PCAR/W9/deepVOL_L2/h500
Epoch 1/50
477/477 - 13s - loss: 3.3346 - accuracy500: 0.3594 - val_loss: 3.3423 - val_accuracy500: 0.3502 - 13s/epoch - 27ms/step
Epoch 2/50
477/477 - 11s - loss: 3.3003 - accuracy500: 0.3613 - val_loss: 3.2968 - val_accuracy500: 0.3716 - 11s/epoch - 22ms/step
Epoch 3/50
477/477 - 11s - loss: 3.2707 - accuracy500: 0.3787 - val_loss: 3.2935 - val_accuracy500: 0.3697 - 11s/epoch - 23ms/step
Epoch 4/50
477/477 - 11s - loss: 3.2552 - accuracy500: 0.3858 - val_loss: 3.2925 - val_accuracy500: 0.3699 - 11s/epoch - 22ms/step
Epoch 5/50
477/477 - 11s - loss: 3.2486 - accuracy500: 0.3921 - val_loss: 3.2901 - val_accuracy500: 0.3698 - 11s/epoch - 22ms/step
Epoch 6/50
477/477 - 11s - loss: 3.2424 - accuracy500: 0.3940 - val_loss: 3.2883 - val_accuracy500: 0.3698 - 11s/epoch - 22ms/step
Epoch 7/50
477/477 - 11s - loss: 3.2318 - accuracy500: 0.4006 - val_loss: 3.3018 - val_accuracy500: 0.3582 - 11s/epoch - 22ms/step
Epoch 8/50
477/477 - 11s - loss: 3.2282 - accuracy500: 0.4033 - val_loss: 3.3082 - val_accuracy500: 0.3579 - 11s/epoch - 22ms/step
Epoch 9/50
477/477 - 11s - loss: 3.2219 - accuracy500: 0.4069 - val_loss: 3.3243 - val_accuracy500: 0.3545 - 11s/epoch - 22ms/step
Epoch 10/50
477/477 - 10s - loss: 3.2154 - accuracy500: 0.4087 - val_loss: 3.3462 - val_accuracy500: 0.3474 - 10s/epoch - 22ms/step
Epoch 11/50
477/477 - 10s - loss: 3.2117 - accuracy500: 0.4087 - val_loss: 3.3251 - val_accuracy500: 0.3530 - 10s/epoch - 22ms/step
Epoch 12/50
477/477 - 10s - loss: 3.2028 - accuracy500: 0.4133 - val_loss: 3.3381 - val_accuracy500: 0.3493 - 10s/epoch - 22ms/step
Epoch 13/50
477/477 - 11s - loss: 3.2010 - accuracy500: 0.4148 - val_loss: 3.3244 - val_accuracy500: 0.3555 - 11s/epoch - 23ms/step
Epoch 14/50
477/477 - 11s - loss: 3.1945 - accuracy500: 0.4184 - val_loss: 3.3505 - val_accuracy500: 0.3447 - 11s/epoch - 22ms/step
Epoch 15/50
477/477 - 11s - loss: 3.1929 - accuracy500: 0.4164 - val_loss: 3.3338 - val_accuracy500: 0.3524 - 11s/epoch - 23ms/step
Epoch 16/50
477/477 - 11s - loss: 3.1845 - accuracy500: 0.4228 - val_loss: 3.3445 - val_accuracy500: 0.3474 - 11s/epoch - 23ms/step
testing model: results/PCAR/W9/deepVOL_L2/h500
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1013625
{'0': {'precision': 0.4098164405426975, 'recall': 0.13574107423133477, 'f1-score': 0.2039342227738132, 'support': 60527}, '1': {'precision': 0.32903238936432183, 'recall': 0.6630236420677069, 'f1-score': 0.4398063138423035, 'support': 48769}, '2': {'precision': 0.33542698955498174, 'recall': 0.27722448665692534, 'f1-score': 0.3035610901167381, 'support': 52012}, 'accuracy': 0.34077665087906367, 'macro avg': {'precision': 0.358091939820667, 'recall': 0.358663067651989, 'f1-score': 0.3157672089109516, 'support': 161308}, 'weighted avg': {'precision': 0.3614065568624629, 'recall': 0.34077665087906367, 'f1-score': 0.3073701257269179, 'support': 161308}}
[[ 8216 35075 17236]
 [ 5102 32335 11332]
 [ 6730 30863 14419]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0945247
{'0': {'precision': 0.3777931579988135, 'recall': 0.09617175505272961, 'f1-score': 0.15331527735981543, 'support': 39731}, '1': {'precision': 0.35689069037656906, 'recall': 0.813743757919058, 'f1-score': 0.49617123770137933, 'support': 40251}, '2': {'precision': 0.3948904745272192, 'recall': 0.1886576557248087, 'f1-score': 0.25533150508146474, 'support': 41949}, 'accuracy': 0.36487029549499306, 'macro avg': {'precision': 0.3765247743008673, 'recall': 0.3661910562321988, 'f1-score': 0.30160600671421983, 'support': 121931}, 'weighted avg': {'precision': 0.37677512408444497, 'recall': 0.36487029549499306, 'f1-score': 0.3015940087439898, 'support': 121931}}
[[ 3821 28712  7198]
 [ 2568 32754  4929]
 [ 3725 30310  7914]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0964271
{'0': {'precision': 0.3954954954954955, 'recall': 0.08355538637228778, 'f1-score': 0.13796354494028912, 'support': 15762}, '1': {'precision': 0.36537382053406753, 'recall': 0.8547933212431993, 'f1-score': 0.5119283921950488, 'support': 15991}, '2': {'precision': 0.3770785784153896, 'recall': 0.15295595820658642, 'f1-score': 0.21763266842303344, 'support': 15122}, 'accuracy': 0.36904533333333334, 'macro avg': {'precision': 0.3793159648149842, 'recall': 0.3637682219406912, 'f1-score': 0.2891748685194571, 'support': 46875}, 'weighted avg': {'precision': 0.37927840057509965, 'recall': 0.36904533333333334, 'f1-score': 0.2912398832391035, 'support': 46875}}
[[ 1317 12138  2307]
 [  808 13669  1514]
 [ 1205 11604  2313]]
training model: results/PCAR/W9/deepVOL_L2/h1000
Epoch 1/50
477/477 - 14s - loss: 3.3376 - accuracy1000: 0.3571 - val_loss: 3.3018 - val_accuracy1000: 0.3531 - 14s/epoch - 28ms/step
Epoch 2/50
477/477 - 11s - loss: 3.2870 - accuracy1000: 0.3720 - val_loss: 3.2705 - val_accuracy1000: 0.3830 - 11s/epoch - 22ms/step
Epoch 3/50
477/477 - 11s - loss: 3.2662 - accuracy1000: 0.3837 - val_loss: 3.2637 - val_accuracy1000: 0.3844 - 11s/epoch - 22ms/step
Epoch 4/50
477/477 - 11s - loss: 3.2481 - accuracy1000: 0.3923 - val_loss: 3.2595 - val_accuracy1000: 0.3874 - 11s/epoch - 22ms/step
Epoch 5/50
477/477 - 11s - loss: 3.2351 - accuracy1000: 0.3975 - val_loss: 3.2589 - val_accuracy1000: 0.3878 - 11s/epoch - 22ms/step
Epoch 6/50
477/477 - 11s - loss: 3.2340 - accuracy1000: 0.3997 - val_loss: 3.2682 - val_accuracy1000: 0.3787 - 11s/epoch - 23ms/step
Epoch 7/50
477/477 - 11s - loss: 3.2251 - accuracy1000: 0.4039 - val_loss: 3.2692 - val_accuracy1000: 0.3767 - 11s/epoch - 22ms/step
Epoch 8/50
477/477 - 11s - loss: 3.2194 - accuracy1000: 0.4076 - val_loss: 3.2793 - val_accuracy1000: 0.3695 - 11s/epoch - 22ms/step
Epoch 9/50
477/477 - 11s - loss: 3.2160 - accuracy1000: 0.4091 - val_loss: 3.2842 - val_accuracy1000: 0.3700 - 11s/epoch - 22ms/step
Epoch 10/50
477/477 - 10s - loss: 3.2074 - accuracy1000: 0.4141 - val_loss: 3.2846 - val_accuracy1000: 0.3634 - 10s/epoch - 22ms/step
Epoch 11/50
477/477 - 10s - loss: 3.1961 - accuracy1000: 0.4177 - val_loss: 3.3014 - val_accuracy1000: 0.3551 - 10s/epoch - 22ms/step
Epoch 12/50
477/477 - 10s - loss: 3.1898 - accuracy1000: 0.4178 - val_loss: 3.3102 - val_accuracy1000: 0.3470 - 10s/epoch - 22ms/step
Epoch 13/50
477/477 - 11s - loss: 3.1792 - accuracy1000: 0.4222 - val_loss: 3.3218 - val_accuracy1000: 0.3439 - 11s/epoch - 23ms/step
Epoch 14/50
477/477 - 11s - loss: 3.1741 - accuracy1000: 0.4235 - val_loss: 3.3336 - val_accuracy1000: 0.3373 - 11s/epoch - 23ms/step
Epoch 15/50
477/477 - 10s - loss: 3.1651 - accuracy1000: 0.4294 - val_loss: 3.3498 - val_accuracy1000: 0.3344 - 10s/epoch - 22ms/step
testing model: results/PCAR/W9/deepVOL_L2/h1000
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0989412
{'0': {'precision': 0.37477965160663473, 'recall': 0.44099104984647547, 'f1-score': 0.4051983522543951, 'support': 61228}, '1': {'precision': 0.34852062088712515, 'recall': 0.28647521522802816, 'f1-score': 0.3144666915955627, 'support': 48437}, '2': {'precision': 0.31480919735485047, 'recall': 0.3014348508026257, 'f1-score': 0.3079768923356942, 'support': 51643}, 'accuracy': 0.34991444937634836, 'macro avg': {'precision': 0.34603648994953673, 'recall': 0.34296703862570976, 'f1-score': 0.342547312061884, 'support': 161308}, 'weighted avg': {'precision': 0.3476950504716273, 'recall': 0.34991444937634836, 'f1-score': 0.3468281703544686, 'support': 161308}}
[[27001 13785 20442]
 [21121 13876 13440]
 [23923 12153 15567]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0841275
{'0': {'precision': 0.35472023761740384, 'recall': 0.4432824216888621, 'f1-score': 0.3940870224412214, 'support': 39873}, '1': {'precision': 0.4115049109006614, 'recall': 0.46963237875520336, 'f1-score': 0.43865134853435456, 'support': 39878}, '2': {'precision': 0.39538206979542717, 'recall': 0.24926505452821243, 'f1-score': 0.30576397371023095, 'support': 42180}, 'accuracy': 0.38478319705407155, 'macro avg': {'precision': 0.38720240610449747, 'recall': 0.3873932849907593, 'f1-score': 0.3795007815619356, 'support': 121931}, 'weighted avg': {'precision': 0.38735816630214165, 'recall': 0.38478319705407155, 'f1-score': 0.3781080671342756, 'support': 121931}}
[[17675 12732  9466]
 [14538 18728  6612]
 [17615 14051 10514]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0861197
{'0': {'precision': 0.35564722795174697, 'recall': 0.3694085567746543, 'f1-score': 0.3623972995350615, 'support': 15403}, '1': {'precision': 0.41415064175763944, 'recall': 0.5628181253879578, 'f1-score': 0.477172854774623, 'support': 16110}, '2': {'precision': 0.3743738172102861, 'recall': 0.21891680770732977, 'f1-score': 0.2762784966112138, 'support': 15362}, 'accuracy': 0.38656, 'macro avg': {'precision': 0.3813905623065575, 'recall': 0.38371449662331397, 'f1-score': 0.3719495503069661, 'support': 46875}, 'weighted avg': {'precision': 0.3818908089779359, 'recall': 0.38656, 'f1-score': 0.3736202786154495, 'support': 46875}}
[[5690 6248 3465]
 [4888 9067 2155]
 [5421 6578 3363]]
training model: results/PCAR/W9/deepVOL_L3/h10
Epoch 1/50
477/477 - 19s - loss: 3.2973 - accuracy10: 0.3736 - val_loss: 3.2860 - val_accuracy10: 0.3793 - 19s/epoch - 40ms/step
Epoch 2/50
477/477 - 17s - loss: 3.2593 - accuracy10: 0.3867 - val_loss: 3.2345 - val_accuracy10: 0.4025 - 17s/epoch - 37ms/step
Epoch 3/50
477/477 - 17s - loss: 3.2205 - accuracy10: 0.4034 - val_loss: 3.1782 - val_accuracy10: 0.4235 - 17s/epoch - 36ms/step
Epoch 4/50
477/477 - 17s - loss: 3.1891 - accuracy10: 0.4155 - val_loss: 3.1936 - val_accuracy10: 0.4314 - 17s/epoch - 36ms/step
Epoch 5/50
477/477 - 17s - loss: 3.1426 - accuracy10: 0.4415 - val_loss: 3.1530 - val_accuracy10: 0.4542 - 17s/epoch - 35ms/step
Epoch 6/50
477/477 - 17s - loss: 3.1092 - accuracy10: 0.4580 - val_loss: 3.1271 - val_accuracy10: 0.4618 - 17s/epoch - 35ms/step
Epoch 7/50
477/477 - 17s - loss: 3.0706 - accuracy10: 0.4744 - val_loss: 3.0927 - val_accuracy10: 0.4711 - 17s/epoch - 36ms/step
Epoch 8/50
477/477 - 17s - loss: 3.0417 - accuracy10: 0.4833 - val_loss: 3.0613 - val_accuracy10: 0.4847 - 17s/epoch - 36ms/step
Epoch 9/50
477/477 - 18s - loss: 3.0228 - accuracy10: 0.4898 - val_loss: 3.0589 - val_accuracy10: 0.4842 - 18s/epoch - 37ms/step
Epoch 10/50
477/477 - 18s - loss: 3.0062 - accuracy10: 0.4945 - val_loss: 3.0453 - val_accuracy10: 0.4908 - 18s/epoch - 37ms/step
Epoch 11/50
477/477 - 17s - loss: 2.9936 - accuracy10: 0.4972 - val_loss: 3.0641 - val_accuracy10: 0.4826 - 17s/epoch - 36ms/step
Epoch 12/50
477/477 - 17s - loss: 2.9816 - accuracy10: 0.5012 - val_loss: 3.0396 - val_accuracy10: 0.4912 - 17s/epoch - 35ms/step
Epoch 13/50
477/477 - 17s - loss: 2.9734 - accuracy10: 0.5044 - val_loss: 3.0217 - val_accuracy10: 0.4919 - 17s/epoch - 36ms/step
Epoch 14/50
477/477 - 17s - loss: 2.9642 - accuracy10: 0.5077 - val_loss: 3.0237 - val_accuracy10: 0.4950 - 17s/epoch - 36ms/step
Epoch 15/50
477/477 - 17s - loss: 2.9549 - accuracy10: 0.5091 - val_loss: 3.0216 - val_accuracy10: 0.4947 - 17s/epoch - 36ms/step
Epoch 16/50
477/477 - 17s - loss: 2.9481 - accuracy10: 0.5118 - val_loss: 3.0110 - val_accuracy10: 0.4989 - 17s/epoch - 36ms/step
Epoch 17/50
477/477 - 17s - loss: 2.9431 - accuracy10: 0.5121 - val_loss: 3.0097 - val_accuracy10: 0.4977 - 17s/epoch - 36ms/step
Epoch 18/50
477/477 - 17s - loss: 2.9394 - accuracy10: 0.5141 - val_loss: 3.0092 - val_accuracy10: 0.4985 - 17s/epoch - 36ms/step
Epoch 19/50
477/477 - 17s - loss: 2.9341 - accuracy10: 0.5154 - val_loss: 3.0051 - val_accuracy10: 0.4982 - 17s/epoch - 36ms/step
Epoch 20/50
477/477 - 17s - loss: 2.9265 - accuracy10: 0.5165 - val_loss: 3.0099 - val_accuracy10: 0.4979 - 17s/epoch - 36ms/step
Epoch 21/50
477/477 - 17s - loss: 2.9214 - accuracy10: 0.5186 - val_loss: 3.0018 - val_accuracy10: 0.5000 - 17s/epoch - 36ms/step
Epoch 22/50
477/477 - 17s - loss: 2.9160 - accuracy10: 0.5199 - val_loss: 3.0289 - val_accuracy10: 0.4910 - 17s/epoch - 37ms/step
Epoch 23/50
477/477 - 17s - loss: 2.9094 - accuracy10: 0.5214 - val_loss: 3.0191 - val_accuracy10: 0.4968 - 17s/epoch - 36ms/step
Epoch 24/50
477/477 - 17s - loss: 2.9073 - accuracy10: 0.5221 - val_loss: 3.0125 - val_accuracy10: 0.4998 - 17s/epoch - 36ms/step
Epoch 25/50
477/477 - 17s - loss: 2.9026 - accuracy10: 0.5226 - val_loss: 3.0007 - val_accuracy10: 0.5004 - 17s/epoch - 36ms/step
Epoch 26/50
477/477 - 17s - loss: 2.8955 - accuracy10: 0.5248 - val_loss: 3.0118 - val_accuracy10: 0.4988 - 17s/epoch - 36ms/step
Epoch 27/50
477/477 - 17s - loss: 2.8917 - accuracy10: 0.5262 - val_loss: 3.0098 - val_accuracy10: 0.4987 - 17s/epoch - 36ms/step
Epoch 28/50
477/477 - 17s - loss: 2.8888 - accuracy10: 0.5266 - val_loss: 3.0071 - val_accuracy10: 0.5005 - 17s/epoch - 36ms/step
Epoch 29/50
477/477 - 17s - loss: 2.8845 - accuracy10: 0.5275 - val_loss: 3.0075 - val_accuracy10: 0.5021 - 17s/epoch - 36ms/step
Epoch 30/50
477/477 - 17s - loss: 2.8782 - accuracy10: 0.5292 - val_loss: 3.0056 - val_accuracy10: 0.5000 - 17s/epoch - 36ms/step
Epoch 31/50
477/477 - 17s - loss: 2.8737 - accuracy10: 0.5300 - val_loss: 3.0070 - val_accuracy10: 0.5003 - 17s/epoch - 36ms/step
Epoch 32/50
477/477 - 17s - loss: 2.8712 - accuracy10: 0.5313 - val_loss: 3.0119 - val_accuracy10: 0.4978 - 17s/epoch - 36ms/step
Epoch 33/50
477/477 - 17s - loss: 2.8639 - accuracy10: 0.5328 - val_loss: 3.0123 - val_accuracy10: 0.4974 - 17s/epoch - 36ms/step
Epoch 34/50
477/477 - 17s - loss: 2.8607 - accuracy10: 0.5323 - val_loss: 3.0035 - val_accuracy10: 0.5022 - 17s/epoch - 36ms/step
Epoch 35/50
477/477 - 17s - loss: 2.8566 - accuracy10: 0.5342 - val_loss: 3.0026 - val_accuracy10: 0.5023 - 17s/epoch - 36ms/step
testing model: results/PCAR/W9/deepVOL_L3/h10
Evaluating performance on  test set...
631/631 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0321321
{'0': {'precision': 0.5003623416724431, 'recall': 0.5193269891101736, 'f1-score': 0.5096683088081904, 'support': 61158}, '1': {'precision': 0.45528715405535114, 'recall': 0.21364227805024522, 'f1-score': 0.2908186726161078, 'support': 39964}, '2': {'precision': 0.46190518342417075, 'recall': 0.6069019373276178, 'f1-score': 0.5245682691272034, 'support': 60186}, 'accuracy': 0.47626900091749946, 'macro avg': {'precision': 0.47251822638398827, 'recall': 0.4466237348293456, 'f1-score': 0.44168508351716723, 'support': 161308}, 'weighted avg': {'precision': 0.4748461408376427, 'recall': 0.47626900091749946, 'f1-score': 0.4610077473418014, 'support': 161308}}
[[31761  4994 24403]
 [13277  8538 18149]
 [18438  5221 36527]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9909193
{'0': {'precision': 0.4659716895613974, 'recall': 0.6442982138983296, 'f1-score': 0.5408139523120656, 'support': 41487}, '1': {'precision': 0.6274077665623485, 'recall': 0.3645443835476105, 'f1-score': 0.4611471984189979, 'support': 39046}, '2': {'precision': 0.5009789875835721, 'recall': 0.506811923281318, 'f1-score': 0.5038785753740483, 'support': 41398}, 'accuracy': 0.5080332319098506, 'macro avg': {'precision': 0.5314528145691061, 'recall': 0.5052181735757527, 'f1-score': 0.5019465753683706, 'support': 121931}, 'weighted avg': {'precision': 0.5295540860487642, 'recall': 0.5080332319098506, 'f1-score': 0.5027619490726207, 'support': 121931}}
[[26730  3694 11063]
 [14976 14234  9836]
 [15658  4759 20981]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99788916
{'0': {'precision': 0.45334215751158174, 'recall': 0.6119974473516273, 'f1-score': 0.5208559635020639, 'support': 15670}, '1': {'precision': 0.6209458781002108, 'recall': 0.3908481860700291, 'f1-score': 0.47973313680617513, 'support': 15822}, '2': {'precision': 0.4859154929577465, 'recall': 0.49788727816420725, 'f1-score': 0.49182854390752934, 'support': 15383}, 'accuracy': 0.499904, 'macro avg': {'precision': 0.520067842856513, 'recall': 0.5002443038619545, 'f1-score': 0.4974725480719228, 'support': 46875}, 'weighted avg': {'precision': 0.5206040601531101, 'recall': 0.499904, 'f1-score': 0.4974495814304889, 'support': 46875}}
[[9590 1723 4357]
 [5892 6184 3746]
 [5672 2052 7659]]
training model: results/PCAR/W9/deepVOL_L3/h20
Epoch 1/50
477/477 - 19s - loss: 3.3113 - accuracy20: 0.3681 - val_loss: 3.3129 - val_accuracy20: 0.3469 - 19s/epoch - 40ms/step
Epoch 2/50
477/477 - 17s - loss: 3.2799 - accuracy20: 0.3760 - val_loss: 3.2849 - val_accuracy20: 0.3665 - 17s/epoch - 35ms/step
Epoch 3/50
477/477 - 17s - loss: 3.2770 - accuracy20: 0.3742 - val_loss: 3.2535 - val_accuracy20: 0.3945 - 17s/epoch - 35ms/step
Epoch 4/50
477/477 - 17s - loss: 3.2695 - accuracy20: 0.3774 - val_loss: 3.2420 - val_accuracy20: 0.3961 - 17s/epoch - 36ms/step
Epoch 5/50
477/477 - 17s - loss: 3.2599 - accuracy20: 0.3829 - val_loss: 3.2329 - val_accuracy20: 0.4029 - 17s/epoch - 35ms/step
Epoch 6/50
477/477 - 17s - loss: 3.2384 - accuracy20: 0.3919 - val_loss: 3.2215 - val_accuracy20: 0.4036 - 17s/epoch - 35ms/step
Epoch 7/50
477/477 - 17s - loss: 3.2167 - accuracy20: 0.4059 - val_loss: 3.2144 - val_accuracy20: 0.4164 - 17s/epoch - 36ms/step
Epoch 8/50
477/477 - 17s - loss: 3.1920 - accuracy20: 0.4256 - val_loss: 3.1940 - val_accuracy20: 0.4272 - 17s/epoch - 36ms/step
Epoch 9/50
477/477 - 17s - loss: 3.1652 - accuracy20: 0.4372 - val_loss: 3.1745 - val_accuracy20: 0.4326 - 17s/epoch - 36ms/step
Epoch 10/50
477/477 - 17s - loss: 3.1455 - accuracy20: 0.4434 - val_loss: 3.1604 - val_accuracy20: 0.4338 - 17s/epoch - 35ms/step
Epoch 11/50
477/477 - 17s - loss: 3.1231 - accuracy20: 0.4512 - val_loss: 3.1494 - val_accuracy20: 0.4388 - 17s/epoch - 35ms/step
Epoch 12/50
477/477 - 17s - loss: 3.1043 - accuracy20: 0.4597 - val_loss: 3.1380 - val_accuracy20: 0.4487 - 17s/epoch - 35ms/step
Epoch 13/50
477/477 - 17s - loss: 3.0949 - accuracy20: 0.4624 - val_loss: 3.1316 - val_accuracy20: 0.4464 - 17s/epoch - 36ms/step
Epoch 14/50
477/477 - 17s - loss: 3.0847 - accuracy20: 0.4669 - val_loss: 3.1479 - val_accuracy20: 0.4417 - 17s/epoch - 35ms/step
Epoch 15/50
477/477 - 17s - loss: 3.0766 - accuracy20: 0.4689 - val_loss: 3.1386 - val_accuracy20: 0.4444 - 17s/epoch - 36ms/step
Epoch 16/50
477/477 - 17s - loss: 3.0700 - accuracy20: 0.4706 - val_loss: 3.1273 - val_accuracy20: 0.4489 - 17s/epoch - 35ms/step
Epoch 17/50
477/477 - 17s - loss: 3.0661 - accuracy20: 0.4730 - val_loss: 3.1367 - val_accuracy20: 0.4489 - 17s/epoch - 35ms/step
Epoch 18/50
477/477 - 17s - loss: 3.0627 - accuracy20: 0.4733 - val_loss: 3.1431 - val_accuracy20: 0.4436 - 17s/epoch - 35ms/step
Epoch 19/50
477/477 - 17s - loss: 3.0586 - accuracy20: 0.4741 - val_loss: 3.1352 - val_accuracy20: 0.4471 - 17s/epoch - 35ms/step
Epoch 20/50
477/477 - 17s - loss: 3.0542 - accuracy20: 0.4744 - val_loss: 3.1447 - val_accuracy20: 0.4459 - 17s/epoch - 36ms/step
Epoch 21/50
477/477 - 17s - loss: 3.0478 - accuracy20: 0.4784 - val_loss: 3.1568 - val_accuracy20: 0.4411 - 17s/epoch - 36ms/step
Epoch 22/50
477/477 - 17s - loss: 3.0444 - accuracy20: 0.4804 - val_loss: 3.1474 - val_accuracy20: 0.4448 - 17s/epoch - 36ms/step
Epoch 23/50
477/477 - 17s - loss: 3.0391 - accuracy20: 0.4803 - val_loss: 3.1288 - val_accuracy20: 0.4526 - 17s/epoch - 36ms/step
Epoch 24/50
477/477 - 17s - loss: 3.0349 - accuracy20: 0.4831 - val_loss: 3.1478 - val_accuracy20: 0.4466 - 17s/epoch - 35ms/step
Epoch 25/50
477/477 - 17s - loss: 3.0323 - accuracy20: 0.4835 - val_loss: 3.1393 - val_accuracy20: 0.4489 - 17s/epoch - 35ms/step
Epoch 26/50
477/477 - 17s - loss: 3.0257 - accuracy20: 0.4853 - val_loss: 3.1380 - val_accuracy20: 0.4488 - 17s/epoch - 35ms/step
testing model: results/PCAR/W9/deepVOL_L3/h20
Evaluating performance on  test set...
631/631 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0597923
{'0': {'precision': 0.4510377153349924, 'recall': 0.6247134610558019, 'f1-score': 0.5238559592544004, 'support': 59765}, '1': {'precision': 0.41441523118767, 'recall': 0.10505872348249787, 'f1-score': 0.1676231687416344, 'support': 43509}, '2': {'precision': 0.4341185185185185, 'recall': 0.5049281455698383, 'f1-score': 0.4668536014147562, 'support': 58034}, 'accuracy': 0.4414536166836115, 'macro avg': {'precision': 0.4331904883470603, 'recall': 0.41156677670271274, 'f1-score': 0.386110909803597, 'support': 161308}, 'weighted avg': {'precision': 0.4350726278575387, 'recall': 0.4414536166836115, 'f1-score': 0.40726281249611285, 'support': 161308}}
[[37336  3285 19144]
 [19885  4571 19053]
 [25557  3174 29303]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0418231
{'0': {'precision': 0.4155201342281879, 'recall': 0.7333793988450719, 'f1-score': 0.5304796415629852, 'support': 40522}, '1': {'precision': 0.590955091714105, 'recall': 0.22922544714050885, 'f1-score': 0.3303222613091976, 'support': 40759}, '2': {'precision': 0.4685991734342938, 'recall': 0.39886838868388685, 'f1-score': 0.4309311504166058, 'support': 40650}, 'accuracy': 0.45333016214088295, 'macro avg': {'precision': 0.49169146645886225, 'recall': 0.45382441155648917, 'f1-score': 0.43057768442959626, 'support': 121931}, 'weighted avg': {'precision': 0.4918601656877568, 'recall': 0.45333016214088295, 'f1-score': 0.4303831867904955, 'support': 121931}}
[[29718  2889  7915]
 [20944  9343 10472]
 [20858  3578 16214]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0432289
{'0': {'precision': 0.40626531458513965, 'recall': 0.7071522309711286, 'f1-score': 0.5160533435487346, 'support': 15240}, '1': {'precision': 0.5781855776686482, 'recall': 0.26832193834712725, 'f1-score': 0.3665410453875143, 'support': 16674}, '2': {'precision': 0.46034892942109434, 'recall': 0.38800882293964306, 'f1-score': 0.42109462841391315, 'support': 14961}, 'accuracy': 0.4491946666666667, 'macro avg': {'precision': 0.481599940558294, 'recall': 0.45449433075263296, 'f1-score': 0.43456300578338736, 'support': 46875}, 'weighted avg': {'precision': 0.48468117438706265, 'recall': 0.4491946666666667, 'f1-score': 0.4325622417530599, 'support': 46875}}
[[10777  1450  3013]
 [ 8408  4474  3792]
 [ 7342  1814  5805]]
training model: results/PCAR/W9/deepVOL_L3/h30
Epoch 1/50
477/477 - 19s - loss: 3.3188 - accuracy30: 0.3610 - val_loss: 3.3272 - val_accuracy30: 0.3405 - 19s/epoch - 40ms/step
Epoch 2/50
477/477 - 17s - loss: 3.2868 - accuracy30: 0.3657 - val_loss: 3.2924 - val_accuracy30: 0.3584 - 17s/epoch - 36ms/step
Epoch 3/50
477/477 - 17s - loss: 3.2866 - accuracy30: 0.3646 - val_loss: 3.2758 - val_accuracy30: 0.3738 - 17s/epoch - 35ms/step
Epoch 4/50
477/477 - 16s - loss: 3.2738 - accuracy30: 0.3743 - val_loss: 3.2776 - val_accuracy30: 0.3775 - 16s/epoch - 35ms/step
Epoch 5/50
477/477 - 18s - loss: 3.2640 - accuracy30: 0.3853 - val_loss: 3.2634 - val_accuracy30: 0.3902 - 18s/epoch - 38ms/step
Epoch 6/50
477/477 - 17s - loss: 3.2425 - accuracy30: 0.4021 - val_loss: 3.2474 - val_accuracy30: 0.3996 - 17s/epoch - 35ms/step
Epoch 7/50
477/477 - 17s - loss: 3.2177 - accuracy30: 0.4165 - val_loss: 3.2311 - val_accuracy30: 0.4085 - 17s/epoch - 35ms/step
Epoch 8/50
477/477 - 17s - loss: 3.1964 - accuracy30: 0.4268 - val_loss: 3.2188 - val_accuracy30: 0.4125 - 17s/epoch - 35ms/step
Epoch 9/50
477/477 - 17s - loss: 3.1779 - accuracy30: 0.4360 - val_loss: 3.2133 - val_accuracy30: 0.4155 - 17s/epoch - 35ms/step
Epoch 10/50
477/477 - 17s - loss: 3.1679 - accuracy30: 0.4414 - val_loss: 3.2075 - val_accuracy30: 0.4182 - 17s/epoch - 35ms/step
Epoch 11/50
477/477 - 17s - loss: 3.1535 - accuracy30: 0.4459 - val_loss: 3.2127 - val_accuracy30: 0.4147 - 17s/epoch - 35ms/step
Epoch 12/50
477/477 - 17s - loss: 3.1424 - accuracy30: 0.4483 - val_loss: 3.2116 - val_accuracy30: 0.4177 - 17s/epoch - 35ms/step
Epoch 13/50
477/477 - 16s - loss: 3.1338 - accuracy30: 0.4519 - val_loss: 3.2091 - val_accuracy30: 0.4183 - 16s/epoch - 35ms/step
Epoch 14/50
477/477 - 17s - loss: 3.1275 - accuracy30: 0.4541 - val_loss: 3.2159 - val_accuracy30: 0.4173 - 17s/epoch - 35ms/step
Epoch 15/50
477/477 - 17s - loss: 3.1207 - accuracy30: 0.4571 - val_loss: 3.2186 - val_accuracy30: 0.4148 - 17s/epoch - 35ms/step
Epoch 16/50
477/477 - 17s - loss: 3.1176 - accuracy30: 0.4574 - val_loss: 3.2110 - val_accuracy30: 0.4182 - 17s/epoch - 35ms/step
Epoch 17/50
477/477 - 17s - loss: 3.1093 - accuracy30: 0.4599 - val_loss: 3.2060 - val_accuracy30: 0.4209 - 17s/epoch - 36ms/step
Epoch 18/50
477/477 - 17s - loss: 3.1041 - accuracy30: 0.4603 - val_loss: 3.2141 - val_accuracy30: 0.4202 - 17s/epoch - 35ms/step
Epoch 19/50
477/477 - 17s - loss: 3.0978 - accuracy30: 0.4621 - val_loss: 3.2079 - val_accuracy30: 0.4230 - 17s/epoch - 35ms/step
Epoch 20/50
477/477 - 17s - loss: 3.0949 - accuracy30: 0.4644 - val_loss: 3.2079 - val_accuracy30: 0.4193 - 17s/epoch - 35ms/step
Epoch 21/50
477/477 - 17s - loss: 3.0878 - accuracy30: 0.4662 - val_loss: 3.2099 - val_accuracy30: 0.4204 - 17s/epoch - 35ms/step
Epoch 22/50
477/477 - 17s - loss: 3.0844 - accuracy30: 0.4674 - val_loss: 3.2132 - val_accuracy30: 0.4219 - 17s/epoch - 35ms/step
Epoch 23/50
477/477 - 17s - loss: 3.0820 - accuracy30: 0.4674 - val_loss: 3.2075 - val_accuracy30: 0.4185 - 17s/epoch - 36ms/step
Epoch 24/50
477/477 - 16s - loss: 3.0761 - accuracy30: 0.4709 - val_loss: 3.2151 - val_accuracy30: 0.4180 - 16s/epoch - 34ms/step
Epoch 25/50
477/477 - 18s - loss: 3.0719 - accuracy30: 0.4709 - val_loss: 3.2231 - val_accuracy30: 0.4138 - 18s/epoch - 37ms/step
Epoch 26/50
477/477 - 17s - loss: 3.0692 - accuracy30: 0.4706 - val_loss: 3.2208 - val_accuracy30: 0.4156 - 17s/epoch - 35ms/step
Epoch 27/50
477/477 - 17s - loss: 3.0616 - accuracy30: 0.4726 - val_loss: 3.2252 - val_accuracy30: 0.4112 - 17s/epoch - 35ms/step
testing model: results/PCAR/W9/deepVOL_L3/h30
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0669974
{'0': {'precision': 0.4562901224577871, 'recall': 0.562477140482128, 'f1-score': 0.5038496477981802, 'support': 60150}, '1': {'precision': 0.3926813258943223, 'recall': 0.05438265572801854, 'f1-score': 0.09553466275425675, 'support': 44003}, '2': {'precision': 0.42223620260035033, 'recall': 0.5988802379494358, 'f1-score': 0.4952792990934807, 'support': 57155}, 'accuracy': 0.4367731296649887, 'macro avg': {'precision': 0.4237358836508199, 'recall': 0.4052466780531942, 'f1-score': 0.36488786988197247, 'support': 161308}, 'weighted avg': {'precision': 0.4268723027300988, 'recall': 0.4367731296649887, 'f1-score': 0.38942926835571695, 'support': 161308}}
[[33833  2190 24127]
 [18900  2393 22710]
 [21415  1511 34229]]
Evaluating performance on  train set...
477/477 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0616921
{'0': {'precision': 0.40442326838287584, 'recall': 0.696611871922389, 'f1-score': 0.5117476086350098, 'support': 40819}, '1': {'precision': 0.5492867240714561, 'recall': 0.10729796902066126, 'f1-score': 0.17952702986516572, 'support': 39833}, '2': {'precision': 0.4481523722627737, 'recall': 0.47595629739092515, 'f1-score': 0.4616360624537412, 'support': 41279}, 'accuracy': 0.4293903929271473, 'macro avg': {'precision': 0.46728745490570195, 'recall': 0.4266220461113252, 'f1-score': 0.3843035669846389, 'support': 121931}, 'weighted avg': {'precision': 0.46655217497350104, 'recall': 0.4293903929271473, 'f1-score': 0.38625124734086974, 'support': 121931}}
[[28435  1734 10650]
 [22016  4274 13543]
 [19859  1773 19647]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.067476
{'0': {'precision': 0.39668721109399074, 'recall': 0.6678339818417639, 'f1-score': 0.49772837119381347, 'support': 15420}, '1': {'precision': 0.540149505666747, 'recall': 0.13658536585365855, 'f1-score': 0.218036696354699, 'support': 16400}, '2': {'precision': 0.42950858778625955, 'recall': 0.47837927598804386, 'f1-score': 0.45262860195456117, 'support': 15055}, 'accuracy': 0.42112, 'macro avg': {'precision': 0.4554484348489991, 'recall': 0.4275995412278221, 'f1-score': 0.3894645565010246, 'support': 46875}, 'weighted avg': {'precision': 0.45742123684535735, 'recall': 0.42112, 'f1-score': 0.38538873400430057, 'support': 46875}}
[[10298   968  4154]
 [ 8748  2240  5412]
 [ 6914   939  7202]]
training model: results/PCAR/W9/deepVOL_L3/h50
Epoch 1/50
477/477 - 20s - loss: 3.3082 - accuracy50: 0.3666 - val_loss: 3.3021 - val_accuracy50: 0.3408 - 20s/epoch - 41ms/step
Epoch 2/50
477/477 - 17s - loss: 3.2893 - accuracy50: 0.3656 - val_loss: 3.2903 - val_accuracy50: 0.3588 - 17s/epoch - 35ms/step
Epoch 3/50
477/477 - 17s - loss: 3.2894 - accuracy50: 0.3631 - val_loss: 3.2802 - val_accuracy50: 0.3636 - 17s/epoch - 35ms/step
Epoch 4/50
477/477 - 18s - loss: 3.2837 - accuracy50: 0.3664 - val_loss: 3.2733 - val_accuracy50: 0.3788 - 18s/epoch - 37ms/step
Epoch 5/50
477/477 - 17s - loss: 3.2774 - accuracy50: 0.3729 - val_loss: 3.2676 - val_accuracy50: 0.3833 - 17s/epoch - 36ms/step
Epoch 6/50
477/477 - 17s - loss: 3.2693 - accuracy50: 0.3810 - val_loss: 3.2619 - val_accuracy50: 0.3887 - 17s/epoch - 36ms/step
Epoch 7/50
477/477 - 17s - loss: 3.2566 - accuracy50: 0.3878 - val_loss: 3.2548 - val_accuracy50: 0.3908 - 17s/epoch - 36ms/step
Epoch 8/50
477/477 - 17s - loss: 3.2431 - accuracy50: 0.3987 - val_loss: 3.2512 - val_accuracy50: 0.3940 - 17s/epoch - 35ms/step
Epoch 9/50
477/477 - 17s - loss: 3.2355 - accuracy50: 0.4037 - val_loss: 3.2468 - val_accuracy50: 0.3962 - 17s/epoch - 35ms/step
Epoch 10/50
477/477 - 17s - loss: 3.2243 - accuracy50: 0.4091 - val_loss: 3.2453 - val_accuracy50: 0.3937 - 17s/epoch - 35ms/step
Epoch 11/50
477/477 - 17s - loss: 3.2117 - accuracy50: 0.4176 - val_loss: 3.2442 - val_accuracy50: 0.3950 - 17s/epoch - 35ms/step
Epoch 12/50
477/477 - 17s - loss: 3.2034 - accuracy50: 0.4210 - val_loss: 3.2486 - val_accuracy50: 0.3929 - 17s/epoch - 35ms/step
Epoch 13/50
477/477 - 17s - loss: 3.1971 - accuracy50: 0.4229 - val_loss: 3.2410 - val_accuracy50: 0.4008 - 17s/epoch - 35ms/step
Epoch 14/50
477/477 - 17s - loss: 3.1877 - accuracy50: 0.4257 - val_loss: 3.2377 - val_accuracy50: 0.3998 - 17s/epoch - 35ms/step
Epoch 15/50
477/477 - 16s - loss: 3.1804 - accuracy50: 0.4304 - val_loss: 3.2406 - val_accuracy50: 0.4019 - 16s/epoch - 34ms/step
Epoch 16/50
477/477 - 17s - loss: 3.1745 - accuracy50: 0.4325 - val_loss: 3.2348 - val_accuracy50: 0.4001 - 17s/epoch - 35ms/step
Epoch 17/50
477/477 - 17s - loss: 3.1718 - accuracy50: 0.4337 - val_loss: 3.2398 - val_accuracy50: 0.3978 - 17s/epoch - 35ms/step
Epoch 18/50
477/477 - 17s - loss: 3.1674 - accuracy50: 0.4371 - val_loss: 3.2344 - val_accuracy50: 0.4022 - 17s/epoch - 35ms/step
Epoch 19/50
477/477 - 17s - loss: 3.1566 - accuracy50: 0.4409 - val_loss: 3.2362 - val_accuracy50: 0.4022 - 17s/epoch - 35ms/step
Epoch 20/50
477/477 - 17s - loss: 3.1526 - accuracy50: 0.4424 - val_loss: 3.2360 - val_accuracy50: 0.4022 - 17s/epoch - 35ms/step
Epoch 21/50
477/477 - 17s - loss: 3.1483 - accuracy50: 0.4444 - val_loss: 3.2308 - val_accuracy50: 0.4067 - 17s/epoch - 35ms/step
Epoch 22/50
477/477 - 17s - loss: 3.1411 - accuracy50: 0.4459 - val_loss: 3.2361 - val_accuracy50: 0.4045 - 17s/epoch - 35ms/step
Epoch 23/50
477/477 - 17s - loss: 3.1378 - accuracy50: 0.4474 - val_loss: 3.2306 - val_accuracy50: 0.4095 - 17s/epoch - 35ms/step
Epoch 24/50
477/477 - 17s - loss: 3.1329 - accuracy50: 0.4501 - val_loss: 3.2371 - val_accuracy50: 0.4049 - 17s/epoch - 35ms/step
Epoch 25/50
477/477 - 16s - loss: 3.1238 - accuracy50: 0.4526 - val_loss: 3.2453 - val_accuracy50: 0.4016 - 16s/epoch - 34ms/step
Epoch 26/50
477/477 - 17s - loss: 3.1218 - accuracy50: 0.4542 - val_loss: 3.2544 - val_accuracy50: 0.3979 - 17s/epoch - 35ms/step
Epoch 27/50
477/477 - 17s - loss: 3.1154 - accuracy50: 0.4553 - val_loss: 3.2486 - val_accuracy50: 0.4012 - 17s/epoch - 35ms/step
Epoch 28/50
477/477 - 17s - loss: 3.1131 - accuracy50: 0.4573 - val_loss: 3.2407 - val_accuracy50: 0.4062 - 17s/epoch - 35ms/step
Epoch 29/50
477/477 - 17s - loss: 3.1064 - accuracy50: 0.4588 - val_loss: 3.2526 - val_accuracy50: 0.4017 - 17s/epoch - 35ms/step
Epoch 30/50
477/477 - 17s - loss: 3.1030 - accuracy50: 0.4603 - val_loss: 3.2685 - val_accuracy50: 0.3933 - 17s/epoch - 35ms/step
Epoch 31/50
477/477 - 17s - loss: 3.0994 - accuracy50: 0.4603 - val_loss: 3.2653 - val_accuracy50: 0.3960 - 17s/epoch - 35ms/step
Epoch 32/50
477/477 - 17s - loss: 3.0925 - accuracy50: 0.4633 - val_loss: 3.2705 - val_accuracy50: 0.3972 - 17s/epoch - 36ms/step
Epoch 33/50
477/477 - 17s - loss: 3.0886 - accuracy50: 0.4650 - val_loss: 3.2808 - val_accuracy50: 0.3968 - 17s/epoch - 35ms/step
testing model: results/PCAR/W9/deepVOL_L3/h50
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0771941
{'0': {'precision': 0.46430505193036575, 'recall': 0.44574308891864217, 'f1-score': 0.4548347691912048, 'support': 63485}, '1': {'precision': 0.3061701299161032, 'recall': 0.22008753626138736, 'f1-score': 0.2560883532947429, 'support': 39298}, '2': {'precision': 0.41894552917683603, 'recall': 0.5162067492524562, 'f1-score': 0.46251827583303357, 'support': 58525}, 'accuracy': 0.4163339697969103, 'macro avg': {'precision': 0.3964735703411017, 'recall': 0.3940124581441619, 'f1-score': 0.3911471327729938, 'support': 161308}, 'weighted avg': {'precision': 0.4093229541145921, 'recall': 0.4163339697969103, 'f1-score': 0.4092036819191158, 'support': 161308}}
[[28298  9933 25254]
 [14002  8649 16647]
 [18647  9667 30211]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0608559
{'0': {'precision': 0.41461707658468305, 'recall': 0.512076459547565, 'f1-score': 0.4582219177476741, 'support': 40492}, '1': {'precision': 0.44841744032846154, 'recall': 0.3632956012312581, 'f1-score': 0.4013932886274188, 'support': 40284}, '2': {'precision': 0.4400519295387435, 'recall': 0.42004616692989916, 'f1-score': 0.4298163826004799, 'support': 41155}, 'accuracy': 0.4318590022225685, 'macro avg': {'precision': 0.434362148817296, 'recall': 0.4318060759029074, 'f1-score': 0.42981052965852423, 'support': 121931}, 'weighted avg': {'precision': 0.4343691103281833, 'recall': 0.4318590022225685, 'f1-score': 0.42985903796760877, 'support': 121931}}
[[20735  8372 11385]
 [15037 14635 10612]
 [14238  9630 17287]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0778147
{'0': {'precision': 0.38854727132974637, 'recall': 0.46805555555555556, 'f1-score': 0.42461150776984463, 'support': 15120}, '1': {'precision': 0.43773398318852863, 'recall': 0.36493728284553323, 'f1-score': 0.3980345558481598, 'support': 16981}, '2': {'precision': 0.4006480970766685, 'recall': 0.3933261134425342, 'f1-score': 0.39695334380763714, 'support': 14774}, 'accuracy': 0.40714666666666666, 'macro avg': {'precision': 0.40897645053164783, 'recall': 0.40877298394787437, 'f1-score': 0.40653313580854716, 'support': 46875}, 'weighted avg': {'precision': 0.4101796372744719, 'recall': 0.40714666666666666, 'f1-score': 0.4062664424907026, 'support': 46875}}
[[7077 3879 4164]
 [6255 6197 4529]
 [4882 4081 5811]]
training model: results/PCAR/W9/deepVOL_L3/h100
Epoch 1/50
477/477 - 19s - loss: 3.3309 - accuracy100: 0.3555 - val_loss: 3.3077 - val_accuracy100: 0.3460 - 19s/epoch - 40ms/step
Epoch 2/50
477/477 - 17s - loss: 3.3029 - accuracy100: 0.3543 - val_loss: 3.2921 - val_accuracy100: 0.3611 - 17s/epoch - 36ms/step
Epoch 3/50
477/477 - 17s - loss: 3.2910 - accuracy100: 0.3567 - val_loss: 3.2874 - val_accuracy100: 0.3654 - 17s/epoch - 35ms/step
Epoch 4/50
477/477 - 16s - loss: 3.2894 - accuracy100: 0.3591 - val_loss: 3.2842 - val_accuracy100: 0.3678 - 16s/epoch - 34ms/step
Epoch 5/50
477/477 - 17s - loss: 3.2842 - accuracy100: 0.3611 - val_loss: 3.2826 - val_accuracy100: 0.3659 - 17s/epoch - 35ms/step
Epoch 6/50
477/477 - 17s - loss: 3.2747 - accuracy100: 0.3718 - val_loss: 3.2764 - val_accuracy100: 0.3755 - 17s/epoch - 35ms/step
Epoch 7/50
477/477 - 17s - loss: 3.2595 - accuracy100: 0.3874 - val_loss: 3.2733 - val_accuracy100: 0.3790 - 17s/epoch - 35ms/step
Epoch 8/50
477/477 - 17s - loss: 3.2473 - accuracy100: 0.3941 - val_loss: 3.2734 - val_accuracy100: 0.3802 - 17s/epoch - 35ms/step
Epoch 9/50
477/477 - 17s - loss: 3.2421 - accuracy100: 0.3974 - val_loss: 3.2727 - val_accuracy100: 0.3830 - 17s/epoch - 35ms/step
Epoch 10/50
477/477 - 17s - loss: 3.2330 - accuracy100: 0.4030 - val_loss: 3.2733 - val_accuracy100: 0.3795 - 17s/epoch - 36ms/step
Epoch 11/50
477/477 - 17s - loss: 3.2274 - accuracy100: 0.4049 - val_loss: 3.2747 - val_accuracy100: 0.3818 - 17s/epoch - 36ms/step
Epoch 12/50
477/477 - 17s - loss: 3.2190 - accuracy100: 0.4081 - val_loss: 3.2795 - val_accuracy100: 0.3780 - 17s/epoch - 35ms/step
Epoch 13/50
477/477 - 17s - loss: 3.2113 - accuracy100: 0.4095 - val_loss: 3.2808 - val_accuracy100: 0.3763 - 17s/epoch - 35ms/step
Epoch 14/50
477/477 - 17s - loss: 3.2060 - accuracy100: 0.4145 - val_loss: 3.2864 - val_accuracy100: 0.3745 - 17s/epoch - 35ms/step
Epoch 15/50
477/477 - 16s - loss: 3.2011 - accuracy100: 0.4160 - val_loss: 3.2831 - val_accuracy100: 0.3768 - 16s/epoch - 34ms/step
Epoch 16/50
477/477 - 16s - loss: 3.1937 - accuracy100: 0.4192 - val_loss: 3.2838 - val_accuracy100: 0.3770 - 16s/epoch - 34ms/step
Epoch 17/50
477/477 - 17s - loss: 3.1892 - accuracy100: 0.4204 - val_loss: 3.2872 - val_accuracy100: 0.3760 - 17s/epoch - 35ms/step
Epoch 18/50
477/477 - 17s - loss: 3.1824 - accuracy100: 0.4233 - val_loss: 3.2873 - val_accuracy100: 0.3743 - 17s/epoch - 35ms/step
Epoch 19/50
477/477 - 17s - loss: 3.1773 - accuracy100: 0.4263 - val_loss: 3.2920 - val_accuracy100: 0.3752 - 17s/epoch - 35ms/step
testing model: results/PCAR/W9/deepVOL_L3/h100
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0958881
{'0': {'precision': 0.412873250155208, 'recall': 0.344150641025641, 'f1-score': 0.37539262725675315, 'support': 59904}, '1': {'precision': 0.34612279785364924, 'recall': 0.46958146326797945, 'f1-score': 0.3985092579093162, 'support': 46567}, '2': {'precision': 0.3648491638657206, 'recall': 0.3206776446559805, 'f1-score': 0.3413403212500607, 'support': 54837}, 'accuracy': 0.3723807870657376, 'macro avg': {'precision': 0.37461507062485927, 'recall': 0.37813658298320035, 'f1-score': 0.37174740213871, 'support': 161308}, 'weighted avg': {'precision': 0.3772775876202853, 'recall': 0.3723807870657376, 'f1-score': 0.37048986877675777, 'support': 161308}}
[[20616 20968 18320]
 [12407 21867 12293]
 [16910 20342 17585]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0868734
{'0': {'precision': 0.37628654655302624, 'recall': 0.4329443892750745, 'f1-score': 0.40263203463203473, 'support': 40280}, '1': {'precision': 0.3893915031286929, 'recall': 0.4989078633836378, 'f1-score': 0.43739867474729893, 'support': 40288}, '2': {'precision': 0.4026369591521676, 'recall': 0.233300292531973, 'f1-score': 0.2954232358793816, 'support': 41363}, 'accuracy': 0.3870139669157146, 'macro avg': {'precision': 0.38943833627796226, 'recall': 0.38838418173022843, 'f1-score': 0.3784846484195718, 'support': 121931}, 'weighted avg': {'precision': 0.3895555643324157, 'recall': 0.3870139669157146, 'f1-score': 0.3777507563201844, 'support': 121931}}
[[17439 14830  8011]
 [13882 20100  6306]
 [15024 16689  9650]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0912025
{'0': {'precision': 0.38045103413904807, 'recall': 0.3879430822004828, 'f1-score': 0.3841605334339812, 'support': 15742}, '1': {'precision': 0.3863077280111395, 'recall': 0.524746232898304, 'f1-score': 0.44500882211409937, 'support': 15861}, '2': {'precision': 0.3858590213408062, 'recall': 0.23441592456783655, 'f1-score': 0.2916496945010183, 'support': 15272}, 'accuracy': 0.38421333333333335, 'macro avg': {'precision': 0.3842059278303312, 'recall': 0.38236841322220777, 'f1-score': 0.3736063500163663, 'support': 46875}, 'weighted avg': {'precision': 0.38419468858279193, 'recall': 0.38421333333333335, 'f1-score': 0.3746093691581656, 'support': 46875}}
[[6107 6512 3123]
 [4963 8323 2575]
 [4982 6710 3580]]
training model: results/PCAR/W9/deepVOL_L3/h200
Epoch 1/50
477/477 - 19s - loss: 3.3353 - accuracy200: 0.3562 - val_loss: 3.2960 - val_accuracy200: 0.3580 - 19s/epoch - 41ms/step
Epoch 2/50
477/477 - 17s - loss: 3.3086 - accuracy200: 0.3524 - val_loss: 3.2803 - val_accuracy200: 0.3663 - 17s/epoch - 35ms/step
Epoch 3/50
477/477 - 17s - loss: 3.2921 - accuracy200: 0.3532 - val_loss: 3.2605 - val_accuracy200: 0.3919 - 17s/epoch - 35ms/step
Epoch 4/50
477/477 - 17s - loss: 3.2818 - accuracy200: 0.3636 - val_loss: 3.2517 - val_accuracy200: 0.3940 - 17s/epoch - 35ms/step
Epoch 5/50
477/477 - 17s - loss: 3.2711 - accuracy200: 0.3712 - val_loss: 3.2508 - val_accuracy200: 0.3920 - 17s/epoch - 36ms/step
Epoch 6/50
477/477 - 17s - loss: 3.2620 - accuracy200: 0.3804 - val_loss: 3.2486 - val_accuracy200: 0.3976 - 17s/epoch - 36ms/step
Epoch 7/50
477/477 - 17s - loss: 3.2522 - accuracy200: 0.3864 - val_loss: 3.2451 - val_accuracy200: 0.3979 - 17s/epoch - 35ms/step
Epoch 8/50
477/477 - 17s - loss: 3.2480 - accuracy200: 0.3890 - val_loss: 3.2597 - val_accuracy200: 0.3917 - 17s/epoch - 35ms/step
Epoch 9/50
477/477 - 17s - loss: 3.2406 - accuracy200: 0.3937 - val_loss: 3.2499 - val_accuracy200: 0.3976 - 17s/epoch - 35ms/step
Epoch 10/50
477/477 - 17s - loss: 3.2341 - accuracy200: 0.3962 - val_loss: 3.2487 - val_accuracy200: 0.3954 - 17s/epoch - 35ms/step
Epoch 11/50
477/477 - 17s - loss: 3.2274 - accuracy200: 0.4012 - val_loss: 3.2510 - val_accuracy200: 0.3938 - 17s/epoch - 35ms/step
Epoch 12/50
477/477 - 17s - loss: 3.2193 - accuracy200: 0.4070 - val_loss: 3.2504 - val_accuracy200: 0.3939 - 17s/epoch - 35ms/step
Epoch 13/50
477/477 - 17s - loss: 3.2137 - accuracy200: 0.4095 - val_loss: 3.2564 - val_accuracy200: 0.3918 - 17s/epoch - 35ms/step
Epoch 14/50
477/477 - 17s - loss: 3.2037 - accuracy200: 0.4132 - val_loss: 3.2530 - val_accuracy200: 0.3940 - 17s/epoch - 35ms/step
Epoch 15/50
477/477 - 17s - loss: 3.1968 - accuracy200: 0.4186 - val_loss: 3.2498 - val_accuracy200: 0.3962 - 17s/epoch - 35ms/step
Epoch 16/50
477/477 - 17s - loss: 3.1887 - accuracy200: 0.4231 - val_loss: 3.2522 - val_accuracy200: 0.3949 - 17s/epoch - 35ms/step
Epoch 17/50
477/477 - 17s - loss: 3.1815 - accuracy200: 0.4286 - val_loss: 3.2562 - val_accuracy200: 0.3963 - 17s/epoch - 35ms/step
testing model: results/PCAR/W9/deepVOL_L3/h200
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1019362
{'0': {'precision': 0.42199512469529343, 'recall': 0.1397695866844704, 'f1-score': 0.20998856982901398, 'support': 64406}, '1': {'precision': 0.2908724871096692, 'recall': 0.5178700361010831, 'f1-score': 0.3725144680219617, 'support': 38780}, '2': {'precision': 0.3711441944397451, 'recall': 0.4529438078524483, 'f1-score': 0.40798425465309096, 'support': 58122}, 'accuracy': 0.3435105512435837, 'macro avg': {'precision': 0.3613372687482359, 'recall': 0.37019447687933393, 'f1-score': 0.3301624308346889, 'support': 161308}, 'weighted avg': {'precision': 0.3721495271187102, 'recall': 0.3435105512435837, 'f1-score': 0.3204025575126224, 'support': 161308}}
[[ 9002 25005 30399]
 [ 4490 20083 14207]
 [ 7840 23956 26326]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0847567
{'0': {'precision': 0.36702514169452116, 'recall': 0.12575312453318727, 'f1-score': 0.18732383919299805, 'support': 40166}, '1': {'precision': 0.39756914416893346, 'recall': 0.6290739911429567, 'f1-score': 0.48721975470407447, 'support': 40194}, '2': {'precision': 0.38483284720664124, 'recall': 0.4125953188520844, 'f1-score': 0.3982308076293518, 'support': 41571}, 'accuracy': 0.3894661734915649, 'macro avg': {'precision': 0.383142377690032, 'recall': 0.38914081150940943, 'f1-score': 0.3575914671754748, 'support': 121931}, 'weighted avg': {'precision': 0.3831651697538405, 'recall': 0.3894661734915649, 'f1-score': 0.3580895182485284, 'support': 121931}}
[[ 5051 18974 16141]
 [ 3632 25285 11277]
 [ 5079 19340 17152]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0819671
{'0': {'precision': 0.37494780793319415, 'recall': 0.11529819605829107, 'f1-score': 0.176363725634605, 'support': 15577}, '1': {'precision': 0.42134426353941323, 'recall': 0.678108966528219, 'f1-score': 0.5197443880058988, 'support': 16372}, '2': {'precision': 0.3638154550076258, 'recall': 0.38355889052659786, 'f1-score': 0.37342639097253927, 'support': 14926}, 'accuracy': 0.3972906666666667, 'macro avg': {'precision': 0.3867025088267444, 'recall': 0.3923220177043693, 'f1-score': 0.356511501537681, 'support': 46875}, 'weighted avg': {'precision': 0.3876078883901112, 'recall': 0.3972906666666667, 'f1-score': 0.35904501730771066, 'support': 46875}}
[[ 1796  7707  6074]
 [ 1333 11102  3937]
 [ 1661  7540  5725]]
training model: results/PCAR/W9/deepVOL_L3/h300
Epoch 1/50
477/477 - 84s - loss: 3.3271 - accuracy300: 0.3570 - val_loss: 3.2829 - val_accuracy300: 0.3738 - 84s/epoch - 177ms/step
Epoch 2/50
477/477 - 18s - loss: 3.2989 - accuracy300: 0.3592 - val_loss: 3.2807 - val_accuracy300: 0.3768 - 18s/epoch - 37ms/step
Epoch 3/50
477/477 - 17s - loss: 3.2850 - accuracy300: 0.3716 - val_loss: 3.2832 - val_accuracy300: 0.3731 - 17s/epoch - 35ms/step
Epoch 4/50
477/477 - 17s - loss: 3.2826 - accuracy300: 0.3692 - val_loss: 3.2735 - val_accuracy300: 0.3850 - 17s/epoch - 36ms/step
Epoch 5/50
477/477 - 17s - loss: 3.2715 - accuracy300: 0.3750 - val_loss: 3.2807 - val_accuracy300: 0.3749 - 17s/epoch - 36ms/step
Epoch 6/50
477/477 - 92s - loss: 3.2747 - accuracy300: 0.3708 - val_loss: 3.2668 - val_accuracy300: 0.3890 - 92s/epoch - 192ms/step
Epoch 7/50
477/477 - 17s - loss: 3.2502 - accuracy300: 0.3892 - val_loss: 3.2623 - val_accuracy300: 0.3887 - 17s/epoch - 36ms/step
Epoch 8/50
477/477 - 17s - loss: 3.2410 - accuracy300: 0.3924 - val_loss: 3.2614 - val_accuracy300: 0.3892 - 17s/epoch - 36ms/step
Epoch 9/50
477/477 - 16s - loss: 3.2315 - accuracy300: 0.3981 - val_loss: 3.2617 - val_accuracy300: 0.3889 - 16s/epoch - 35ms/step
Epoch 10/50
477/477 - 17s - loss: 3.2245 - accuracy300: 0.3995 - val_loss: 3.2645 - val_accuracy300: 0.3879 - 17s/epoch - 35ms/step
Epoch 11/50
477/477 - 17s - loss: 3.2207 - accuracy300: 0.4034 - val_loss: 3.2595 - val_accuracy300: 0.3907 - 17s/epoch - 35ms/step
Epoch 12/50
477/477 - 17s - loss: 3.2173 - accuracy300: 0.4053 - val_loss: 3.2711 - val_accuracy300: 0.3819 - 17s/epoch - 35ms/step
Epoch 13/50
477/477 - 17s - loss: 3.2118 - accuracy300: 0.4053 - val_loss: 3.2682 - val_accuracy300: 0.3865 - 17s/epoch - 36ms/step
Epoch 14/50
477/477 - 17s - loss: 3.2059 - accuracy300: 0.4104 - val_loss: 3.2726 - val_accuracy300: 0.3845 - 17s/epoch - 35ms/step
Epoch 15/50
477/477 - 17s - loss: 3.1998 - accuracy300: 0.4109 - val_loss: 3.2670 - val_accuracy300: 0.3881 - 17s/epoch - 35ms/step
Epoch 16/50
477/477 - 17s - loss: 3.1931 - accuracy300: 0.4149 - val_loss: 3.2686 - val_accuracy300: 0.3840 - 17s/epoch - 35ms/step
Epoch 17/50
477/477 - 17s - loss: 3.1883 - accuracy300: 0.4160 - val_loss: 3.2774 - val_accuracy300: 0.3795 - 17s/epoch - 35ms/step
Epoch 18/50
477/477 - 17s - loss: 3.1773 - accuracy300: 0.4207 - val_loss: 3.2893 - val_accuracy300: 0.3797 - 17s/epoch - 36ms/step
Epoch 19/50
477/477 - 17s - loss: 3.1722 - accuracy300: 0.4230 - val_loss: 3.2876 - val_accuracy300: 0.3771 - 17s/epoch - 35ms/step
Epoch 20/50
477/477 - 17s - loss: 3.1609 - accuracy300: 0.4288 - val_loss: 3.2930 - val_accuracy300: 0.3774 - 17s/epoch - 35ms/step
Epoch 21/50
477/477 - 17s - loss: 3.1530 - accuracy300: 0.4313 - val_loss: 3.2991 - val_accuracy300: 0.3744 - 17s/epoch - 35ms/step
testing model: results/PCAR/W9/deepVOL_L3/h300
Evaluating performance on  test set...
631/631 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.097235
{'0': {'precision': 0.3678560779246596, 'recall': 0.061989146455848854, 'f1-score': 0.10609904679997134, 'support': 59704}, '1': {'precision': 0.3576062115856861, 'recall': 0.5263674731519786, 'f1-score': 0.4258775599901954, 'support': 47862}, '2': {'precision': 0.35182801554493925, 'recall': 0.5289531465148302, 'f1-score': 0.4225806451612904, 'support': 53742}, 'accuracy': 0.3553512535026161, 'macro avg': {'precision': 0.3590967683517617, 'recall': 0.37243658870755253, 'f1-score': 0.3181857506504857, 'support': 161308}, 'weighted avg': {'precision': 0.359474849274333, 'recall': 0.3553512535026161, 'f1-score': 0.3064213696695408, 'support': 161308}}
[[ 3701 23397 32606]
 [ 2904 25193 19765]
 [ 3456 21859 28427]]
Evaluating performance on  train set...
477/477 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0832683
{'0': {'precision': 0.36174118264061883, 'recall': 0.06923462986198244, 'f1-score': 0.1162246982749542, 'support': 39850}, '1': {'precision': 0.4007244664934247, 'recall': 0.6313334325839909, 'f1-score': 0.49026465119415785, 'support': 40302}, '2': {'precision': 0.3881202149225531, 'recall': 0.47200746786663156, 'f1-score': 0.42597312826716205, 'support': 41779}, 'accuracy': 0.3930337649982367, 'macro avg': {'precision': 0.3835286213521989, 'recall': 0.39085851010420164, 'f1-score': 0.3441541592454247, 'support': 121931}, 'weighted avg': {'precision': 0.38366500755423977, 'recall': 0.3930337649982367, 'f1-score': 0.3459902036771423, 'support': 121931}}
[[ 2759 18680 18411]
 [ 2180 25444 12678]
 [ 2688 19371 19720]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0862758
{'0': {'precision': 0.35490753911806544, 'recall': 0.06435388186742326, 'f1-score': 0.10895196506550218, 'support': 15508}, '1': {'precision': 0.41845222124266934, 'recall': 0.6604355716878403, 'f1-score': 0.5123067176611371, 'support': 16530}, '2': {'precision': 0.357683320351619, 'recall': 0.4333086203410393, 'f1-score': 0.39188077169242025, 'support': 14837}, 'accuracy': 0.39133866666666667, 'macro avg': {'precision': 0.3770143602374512, 'recall': 0.38603269129876766, 'f1-score': 0.33771315147301983, 'support': 46875}, 'weighted avg': {'precision': 0.37819453350061344, 'recall': 0.39133866666666667, 'f1-score': 0.3407443653711967, 'support': 46875}}
[[  998  7644  6866]
 [  934 10917  4679]
 [  880  7528  6429]]
training model: results/PCAR/W9/deepVOL_L3/h500
Epoch 1/50
477/477 - 19s - loss: 3.3321 - accuracy500: 0.3591 - val_loss: 3.3185 - val_accuracy500: 0.3421 - 19s/epoch - 41ms/step
Epoch 2/50
477/477 - 17s - loss: 3.3115 - accuracy500: 0.3557 - val_loss: 3.3079 - val_accuracy500: 0.3453 - 17s/epoch - 35ms/step
Epoch 3/50
477/477 - 17s - loss: 3.2967 - accuracy500: 0.3533 - val_loss: 3.2967 - val_accuracy500: 0.3497 - 17s/epoch - 35ms/step
Epoch 4/50
477/477 - 17s - loss: 3.2811 - accuracy500: 0.3653 - val_loss: 3.2941 - val_accuracy500: 0.3615 - 17s/epoch - 35ms/step
Epoch 5/50
477/477 - 17s - loss: 3.2645 - accuracy500: 0.3793 - val_loss: 3.2892 - val_accuracy500: 0.3638 - 17s/epoch - 35ms/step
Epoch 6/50
477/477 - 17s - loss: 3.2541 - accuracy500: 0.3877 - val_loss: 3.2866 - val_accuracy500: 0.3686 - 17s/epoch - 35ms/step
Epoch 7/50
477/477 - 17s - loss: 3.2466 - accuracy500: 0.3916 - val_loss: 3.2868 - val_accuracy500: 0.3702 - 17s/epoch - 35ms/step
Epoch 8/50
477/477 - 17s - loss: 3.2405 - accuracy500: 0.3930 - val_loss: 3.2834 - val_accuracy500: 0.3743 - 17s/epoch - 36ms/step
Epoch 9/50
477/477 - 17s - loss: 3.2320 - accuracy500: 0.3995 - val_loss: 3.2888 - val_accuracy500: 0.3749 - 17s/epoch - 35ms/step
Epoch 10/50
477/477 - 17s - loss: 3.2250 - accuracy500: 0.4036 - val_loss: 3.2978 - val_accuracy500: 0.3737 - 17s/epoch - 36ms/step
Epoch 11/50
477/477 - 17s - loss: 3.2187 - accuracy500: 0.4063 - val_loss: 3.2918 - val_accuracy500: 0.3812 - 17s/epoch - 35ms/step
Epoch 12/50
477/477 - 16s - loss: 3.2128 - accuracy500: 0.4064 - val_loss: 3.2975 - val_accuracy500: 0.3769 - 16s/epoch - 34ms/step
Epoch 13/50
477/477 - 17s - loss: 3.2017 - accuracy500: 0.4120 - val_loss: 3.3063 - val_accuracy500: 0.3735 - 17s/epoch - 35ms/step
Epoch 14/50
477/477 - 16s - loss: 3.1941 - accuracy500: 0.4164 - val_loss: 3.3051 - val_accuracy500: 0.3742 - 16s/epoch - 34ms/step
Epoch 15/50
477/477 - 17s - loss: 3.1872 - accuracy500: 0.4188 - val_loss: 3.3147 - val_accuracy500: 0.3662 - 17s/epoch - 35ms/step
Epoch 16/50
477/477 - 16s - loss: 3.1744 - accuracy500: 0.4254 - val_loss: 3.3262 - val_accuracy500: 0.3585 - 16s/epoch - 34ms/step
Epoch 17/50
477/477 - 16s - loss: 3.1645 - accuracy500: 0.4291 - val_loss: 3.3330 - val_accuracy500: 0.3643 - 16s/epoch - 34ms/step
Epoch 18/50
477/477 - 17s - loss: 3.1502 - accuracy500: 0.4353 - val_loss: 3.3346 - val_accuracy500: 0.3634 - 17s/epoch - 35ms/step
testing model: results/PCAR/W9/deepVOL_L3/h500
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1010762
{'0': {'precision': 0.35985834056085575, 'recall': 0.08226080922563483, 'f1-score': 0.13391068138724904, 'support': 60527}, '1': {'precision': 0.3392966866758047, 'recall': 0.5887756566671452, 'f1-score': 0.4305044341327017, 'support': 48769}, '2': {'precision': 0.31882120807077846, 'recall': 0.3852187956625394, 'f1-score': 0.34888904367207635, 'support': 52012}, 'accuracy': 0.3330832940709698, 'macro avg': {'precision': 0.33932541176914627, 'recall': 0.35208508718510645, 'f1-score': 0.30443471973067565, 'support': 161308}, 'weighted avg': {'precision': 0.3404098653866923, 'recall': 0.3330832940709698, 'f1-score': 0.2928986752052954, 'support': 161308}}
[[ 4979 28566 26982]
 [ 4229 28714 15826]
 [ 4628 27348 20036]]
Evaluating performance on  train set...
477/477 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0880574
{'0': {'precision': 0.3688030370701206, 'recall': 0.083134076665576, 'f1-score': 0.135683036539528, 'support': 39731}, '1': {'precision': 0.38112958817955866, 'recall': 0.6895480857618445, 'f1-score': 0.49091745228788236, 'support': 40251}, '2': {'precision': 0.39397788404064554, 'recall': 0.3771007652149038, 'f1-score': 0.3853546241824095, 'support': 41949}, 'accuracy': 0.38445514266265346, 'macro avg': {'precision': 0.3813035030967749, 'recall': 0.3832609758807748, 'f1-score': 0.3373183710032733, 'support': 121931}, 'weighted avg': {'precision': 0.3815333161974348, 'recall': 0.38445514266265346, 'f1-score': 0.3388472351298639, 'support': 121931}}
[[ 3303 22010 14418]
 [ 2581 27755  9915]
 [ 3072 23058 15819]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0935792
{'0': {'precision': 0.3786603837091888, 'recall': 0.07137419109250095, 'f1-score': 0.12010889873485295, 'support': 15762}, '1': {'precision': 0.3838774150566289, 'recall': 0.7206553686448627, 'f1-score': 0.5009236921605703, 'support': 15991}, '2': {'precision': 0.3581100547392682, 'recall': 0.3287924877661685, 'f1-score': 0.34282562228504443, 'support': 15122}, 'accuracy': 0.3759146666666667, 'macro avg': {'precision': 0.3735492845016953, 'recall': 0.37360734916784405, 'f1-score': 0.3212860710601559, 'support': 46875}, 'weighted avg': {'precision': 0.3738105378125227, 'recall': 0.3759146666666667, 'f1-score': 0.32186957404571465, 'support': 46875}}
[[ 1125  9293  5344]
 [  899 11524  3568]
 [  947  9203  4972]]
training model: results/PCAR/W9/deepVOL_L3/h1000
Epoch 1/50
477/477 - 19s - loss: 3.3352 - accuracy1000: 0.3599 - val_loss: 3.3062 - val_accuracy1000: 0.3418 - 19s/epoch - 40ms/step
Epoch 2/50
477/477 - 17s - loss: 3.3082 - accuracy1000: 0.3513 - val_loss: 3.2951 - val_accuracy1000: 0.3496 - 17s/epoch - 35ms/step
Epoch 3/50
477/477 - 17s - loss: 3.3052 - accuracy1000: 0.3448 - val_loss: 3.2953 - val_accuracy1000: 0.3507 - 17s/epoch - 36ms/step
Epoch 4/50
477/477 - 17s - loss: 3.2974 - accuracy1000: 0.3434 - val_loss: 3.2897 - val_accuracy1000: 0.3649 - 17s/epoch - 36ms/step
Epoch 5/50
477/477 - 17s - loss: 3.2943 - accuracy1000: 0.3512 - val_loss: 3.2802 - val_accuracy1000: 0.3729 - 17s/epoch - 36ms/step
Epoch 6/50
477/477 - 17s - loss: 3.2878 - accuracy1000: 0.3570 - val_loss: 3.2758 - val_accuracy1000: 0.3745 - 17s/epoch - 35ms/step
Epoch 7/50
477/477 - 18s - loss: 3.2794 - accuracy1000: 0.3673 - val_loss: 3.2651 - val_accuracy1000: 0.3880 - 18s/epoch - 38ms/step
Epoch 8/50
477/477 - 17s - loss: 3.2725 - accuracy1000: 0.3717 - val_loss: 3.2651 - val_accuracy1000: 0.3860 - 17s/epoch - 35ms/step
Epoch 9/50
477/477 - 17s - loss: 3.2622 - accuracy1000: 0.3805 - val_loss: 3.2632 - val_accuracy1000: 0.3894 - 17s/epoch - 35ms/step
Epoch 10/50
477/477 - 17s - loss: 3.2626 - accuracy1000: 0.3835 - val_loss: 3.2539 - val_accuracy1000: 0.3941 - 17s/epoch - 35ms/step
Epoch 11/50
477/477 - 17s - loss: 3.2458 - accuracy1000: 0.3929 - val_loss: 3.2657 - val_accuracy1000: 0.3884 - 17s/epoch - 35ms/step
Epoch 12/50
477/477 - 17s - loss: 3.2377 - accuracy1000: 0.3971 - val_loss: 3.2613 - val_accuracy1000: 0.3919 - 17s/epoch - 35ms/step
Epoch 13/50
477/477 - 17s - loss: 3.2221 - accuracy1000: 0.4054 - val_loss: 3.2779 - val_accuracy1000: 0.3771 - 17s/epoch - 35ms/step
Epoch 14/50
477/477 - 17s - loss: 3.2114 - accuracy1000: 0.4092 - val_loss: 3.2832 - val_accuracy1000: 0.3747 - 17s/epoch - 35ms/step
Epoch 15/50
477/477 - 17s - loss: 3.2097 - accuracy1000: 0.4115 - val_loss: 3.2776 - val_accuracy1000: 0.3807 - 17s/epoch - 35ms/step
Epoch 16/50
477/477 - 17s - loss: 3.1946 - accuracy1000: 0.4193 - val_loss: 3.2918 - val_accuracy1000: 0.3690 - 17s/epoch - 36ms/step
Epoch 17/50
477/477 - 16s - loss: 3.1882 - accuracy1000: 0.4196 - val_loss: 3.2926 - val_accuracy1000: 0.3773 - 16s/epoch - 34ms/step
Epoch 18/50
477/477 - 17s - loss: 3.1737 - accuracy1000: 0.4258 - val_loss: 3.2979 - val_accuracy1000: 0.3754 - 17s/epoch - 35ms/step
Epoch 19/50
477/477 - 17s - loss: 3.1656 - accuracy1000: 0.4299 - val_loss: 3.3115 - val_accuracy1000: 0.3668 - 17s/epoch - 35ms/step
Epoch 20/50
477/477 - 17s - loss: 3.1587 - accuracy1000: 0.4334 - val_loss: 3.3341 - val_accuracy1000: 0.3567 - 17s/epoch - 35ms/step
testing model: results/PCAR/W9/deepVOL_L3/h1000
Evaluating performance on  test set...
631/631 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0948657
{'0': {'precision': 0.3987616860751189, 'recall': 0.6353302410661789, 'f1-score': 0.48998614435067384, 'support': 61228}, '1': {'precision': 0.34800525694428974, 'recall': 0.32254268431158, 'f1-score': 0.3347905282331512, 'support': 48437}, '2': {'precision': 0.34140910777712985, 'recall': 0.12470228298123656, 'f1-score': 0.18267948827050182, 'support': 51643}, 'accuracy': 0.37792917896198575, 'macro avg': {'precision': 0.3627253502655128, 'recall': 0.3608584027863318, 'f1-score': 0.3358187202847756, 'support': 161308}, 'weighted avg': {'precision': 0.3651592090817086, 'recall': 0.37792917896198575, 'f1-score': 0.34499985912097186, 'support': 161308}}
[[38900 15041  7287]
 [27678 15623  5136]
 [30974 14229  6440]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.082629
{'0': {'precision': 0.36727382254561597, 'recall': 0.5810448172949113, 'f1-score': 0.45006507760747516, 'support': 39873}, '1': {'precision': 0.4284414402703757, 'recall': 0.4959125332263403, 'f1-score': 0.4597145381003301, 'support': 39878}, '2': {'precision': 0.3756697132051686, 'recall': 0.1130393551446183, 'f1-score': 0.17378626621956553, 'support': 42180}, 'accuracy': 0.39130327808350623, 'macro avg': {'precision': 0.39046165867372, 'recall': 0.39666556855529, 'f1-score': 0.3611886273091236, 'support': 121931}, 'weighted avg': {'precision': 0.3901833445510773, 'recall': 0.39130327808350623, 'f1-score': 0.3576469142297619, 'support': 121931}}
[[23168 12575  4130]
 [16308 19776  3794]
 [23605 13807  4768]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.083651
{'0': {'precision': 0.3790789169173802, 'recall': 0.5317146010517432, 'f1-score': 0.4426070038910506, 'support': 15403}, '1': {'precision': 0.4268869123252859, 'recall': 0.5213531967721912, 'f1-score': 0.4694145591728378, 'support': 16110}, '2': {'precision': 0.34226988382484363, 'recall': 0.12465824762400729, 'f1-score': 0.18275516533855035, 'support': 15362}, 'accuracy': 0.394752, 'macro avg': {'precision': 0.38274523768916996, 'recall': 0.39257534848264725, 'f1-score': 0.3649255761341463, 'support': 46875}, 'weighted avg': {'precision': 0.3834464142966616, 'recall': 0.394752, 'f1-score': 0.36666088702163374, 'support': 46875}}
[[8190 5409 1804]
 [5835 8399 1876]
 [7580 5867 1915]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        15 (peak)  10.90 (ave)

============================================
