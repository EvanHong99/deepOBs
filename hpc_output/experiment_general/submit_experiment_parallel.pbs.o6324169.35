This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/EXC_orderbooks/EXC_orderbooks_2019-05-22.csv
data/EXC_orderbooks/EXC_orderbooks_2019-05-14.csv
data/EXC_orderbooks/EXC_orderbooks_2019-05-01.csv
data/EXC_orderbooks/EXC_orderbooks_2019-05-02.csv
data/EXC_orderbooks/EXC_orderbooks_2019-05-10.csv
data/EXC_orderbooks/EXC_orderbooks_2019-05-06.csv
data/EXC_orderbooks/EXC_orderbooks_2019-05-08.csv
data/EXC_orderbooks/EXC_orderbooks_2019-05-03.csv
data/EXC_orderbooks/EXC_orderbooks_2019-05-24.csv
data/EXC_orderbooks/EXC_orderbooks_2019-05-07.csv
data/EXC_orderbooks/EXC_orderbooks_2019-05-20.csv
data/EXC_orderbooks/EXC_orderbooks_2019-05-09.csv
data/EXC_orderbooks/EXC_orderbooks_2019-04-30.csv
data/EXC_orderbooks/EXC_orderbooks_2019-05-16.csv
data/EXC_orderbooks/EXC_orderbooks_2019-05-15.csv
training model: results/EXC/W3/deepLOB_L1/h10
Epoch 1/50
1876/1876 - 54s - loss: 2.5427 - accuracy10: 0.5184 - val_loss: 2.8871 - val_accuracy10: 0.7159 - 54s/epoch - 29ms/step
Epoch 2/50
1876/1876 - 29s - loss: 2.2010 - accuracy10: 0.6217 - val_loss: 2.5044 - val_accuracy10: 0.7284 - 29s/epoch - 15ms/step
Epoch 3/50
1876/1876 - 28s - loss: 2.0999 - accuracy10: 0.6499 - val_loss: 2.2883 - val_accuracy10: 0.7280 - 28s/epoch - 15ms/step
Epoch 4/50
1876/1876 - 29s - loss: 2.0588 - accuracy10: 0.6572 - val_loss: 2.2970 - val_accuracy10: 0.7359 - 29s/epoch - 16ms/step
Epoch 5/50
1876/1876 - 29s - loss: 2.0328 - accuracy10: 0.6583 - val_loss: 2.2610 - val_accuracy10: 0.7428 - 29s/epoch - 15ms/step
Epoch 6/50
1876/1876 - 29s - loss: 2.0113 - accuracy10: 0.6597 - val_loss: 2.1329 - val_accuracy10: 0.7337 - 29s/epoch - 15ms/step
Epoch 7/50
1876/1876 - 29s - loss: 1.9934 - accuracy10: 0.6619 - val_loss: 2.1530 - val_accuracy10: 0.7347 - 29s/epoch - 15ms/step
Epoch 8/50
1876/1876 - 29s - loss: 1.9783 - accuracy10: 0.6640 - val_loss: 2.1204 - val_accuracy10: 0.7349 - 29s/epoch - 16ms/step
Epoch 9/50
1876/1876 - 29s - loss: 1.9676 - accuracy10: 0.6644 - val_loss: 2.0851 - val_accuracy10: 0.7363 - 29s/epoch - 15ms/step
Epoch 10/50
1876/1876 - 29s - loss: 1.9578 - accuracy10: 0.6665 - val_loss: 2.0968 - val_accuracy10: 0.7383 - 29s/epoch - 16ms/step
Epoch 11/50
1876/1876 - 29s - loss: 1.9489 - accuracy10: 0.6673 - val_loss: 2.1626 - val_accuracy10: 0.7365 - 29s/epoch - 15ms/step
Epoch 12/50
1876/1876 - 29s - loss: 1.9410 - accuracy10: 0.6684 - val_loss: 2.1150 - val_accuracy10: 0.7359 - 29s/epoch - 15ms/step
Epoch 13/50
1876/1876 - 29s - loss: 1.9353 - accuracy10: 0.6690 - val_loss: 2.1900 - val_accuracy10: 0.7356 - 29s/epoch - 15ms/step
Epoch 14/50
1876/1876 - 29s - loss: 1.9282 - accuracy10: 0.6693 - val_loss: 2.1350 - val_accuracy10: 0.7358 - 29s/epoch - 15ms/step
Epoch 15/50
1876/1876 - 28s - loss: 1.9223 - accuracy10: 0.6697 - val_loss: 2.1114 - val_accuracy10: 0.7306 - 28s/epoch - 15ms/step
Epoch 16/50
1876/1876 - 28s - loss: 1.9183 - accuracy10: 0.6706 - val_loss: 2.0961 - val_accuracy10: 0.7314 - 28s/epoch - 15ms/step
Epoch 17/50
1876/1876 - 28s - loss: 1.9126 - accuracy10: 0.6717 - val_loss: 2.0730 - val_accuracy10: 0.7278 - 28s/epoch - 15ms/step
Epoch 18/50
1876/1876 - 28s - loss: 1.9073 - accuracy10: 0.6721 - val_loss: 2.1408 - val_accuracy10: 0.7350 - 28s/epoch - 15ms/step
Epoch 19/50
1876/1876 - 28s - loss: 1.9036 - accuracy10: 0.6728 - val_loss: 2.1037 - val_accuracy10: 0.7299 - 28s/epoch - 15ms/step
Epoch 20/50
1876/1876 - 28s - loss: 1.9000 - accuracy10: 0.6726 - val_loss: 2.1517 - val_accuracy10: 0.7281 - 28s/epoch - 15ms/step
Epoch 21/50
1876/1876 - 28s - loss: 1.8971 - accuracy10: 0.6728 - val_loss: 2.0884 - val_accuracy10: 0.7304 - 28s/epoch - 15ms/step
Epoch 22/50
1876/1876 - 28s - loss: 1.8928 - accuracy10: 0.6734 - val_loss: 2.1458 - val_accuracy10: 0.7261 - 28s/epoch - 15ms/step
Epoch 23/50
1876/1876 - 28s - loss: 1.8881 - accuracy10: 0.6735 - val_loss: 2.0992 - val_accuracy10: 0.7284 - 28s/epoch - 15ms/step
Epoch 24/50
1876/1876 - 28s - loss: 1.8851 - accuracy10: 0.6743 - val_loss: 2.1519 - val_accuracy10: 0.7267 - 28s/epoch - 15ms/step
Epoch 25/50
1876/1876 - 28s - loss: 1.8820 - accuracy10: 0.6748 - val_loss: 2.1352 - val_accuracy10: 0.7272 - 28s/epoch - 15ms/step
Epoch 26/50
1876/1876 - 28s - loss: 1.8774 - accuracy10: 0.6756 - val_loss: 2.1232 - val_accuracy10: 0.7249 - 28s/epoch - 15ms/step
Epoch 27/50
1876/1876 - 28s - loss: 1.8773 - accuracy10: 0.6751 - val_loss: 2.1222 - val_accuracy10: 0.7250 - 28s/epoch - 15ms/step
testing model: results/EXC/W3/deepLOB_L1/h10
Evaluating performance on  test set...
5098/5098 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7046606
{'0': {'precision': 0.3489782797081598, 'recall': 0.7331262723808529, 'f1-score': 0.4728658517338541, 'support': 153256}, '1': {'precision': 0.9250252092627937, 'recall': 0.624977365425575, 'f1-score': 0.7459598166842197, 'support': 999577}, '2': {'precision': 0.33019404629933646, 'recall': 0.6678809558253002, 'f1-score': 0.44191130883104734, 'support': 152078}, 'accuracy': 0.6426790792628769, 'macro avg': {'precision': 0.5347325117567633, 'recall': 0.6753281978772426, 'f1-score': 0.5535789924163738, 'support': 1304911}, 'weighted avg': {'precision': 0.7880477588182947, 'recall': 0.6426790792628769, 'f1-score': 0.6784514749890941, 'support': 1304911}}
[[112356  26140  14760]
 [183587 624713 191277]
 [ 26014  24494 101570]]
Evaluating performance on  train set...
1876/1876 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6316461
{'0': {'precision': 0.3684045076540576, 'recall': 0.6838419917247233, 'f1-score': 0.47884307037039336, 'support': 56554}, '1': {'precision': 0.9049556187669214, 'recall': 0.7211027213020741, 'f1-score': 0.8026353584862647, 'support': 366185}, '2': {'precision': 0.38797938638542667, 'recall': 0.5633221967007727, 'f1-score': 0.4594912992874784, 'support': 57468}, 'accuracy': 0.697832393113803, 'macro avg': {'precision': 0.5537798376021352, 'recall': 0.65608896990919, 'f1-score': 0.5803232427147121, 'support': 480207}, 'weighted avg': {'precision': 0.7798976715475419, 'recall': 0.697832393113803, 'f1-score': 0.7234371130293246, 'support': 480207}}
[[ 38674  12811   5069]
 [ 56130 264057  45998]
 [ 10173  14922  32373]]
Evaluating performance on  val set...
619/619 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.575884
{'0': {'precision': 0.3558751712226788, 'recall': 0.7248741432643901, 'f1-score': 0.4773812139247838, 'support': 16487}, '1': {'precision': 0.9155112441744422, 'recall': 0.755416446810892, 'f1-score': 0.8277943501933936, 'support': 125082}, '2': {'precision': 0.4111950326676243, 'recall': 0.5281199785752544, 'f1-score': 0.46238015839933305, 'support': 16803}, 'accuracy': 0.7281211325234258, 'macro avg': {'precision': 0.5608604826882485, 'recall': 0.6694701895501788, 'f1-score': 0.5891852408391701, 'support': 158372}, 'weighted avg': {'precision': 0.8037443583821002, 'recall': 0.7281211325234258, 'f1-score': 0.7525454675476219, 'support': 158372}}
[[11951  3509  1027]
 [18913 94489 11680]
 [ 2718  5211  8874]]
training model: results/EXC/W3/deepLOB_L1/h20
Epoch 1/50
1876/1876 - 30s - loss: 2.6587 - accuracy20: 0.5070 - val_loss: 2.5693 - val_accuracy20: 0.5817 - 30s/epoch - 16ms/step
Epoch 2/50
1876/1876 - 27s - loss: 2.3854 - accuracy20: 0.5899 - val_loss: 2.3728 - val_accuracy20: 0.6940 - 27s/epoch - 15ms/step
Epoch 3/50
1876/1876 - 28s - loss: 2.2370 - accuracy20: 0.6317 - val_loss: 2.3000 - val_accuracy20: 0.7054 - 28s/epoch - 15ms/step
Epoch 4/50
1876/1876 - 27s - loss: 2.1763 - accuracy20: 0.6398 - val_loss: 2.2482 - val_accuracy20: 0.7063 - 27s/epoch - 15ms/step
Epoch 5/50
1876/1876 - 27s - loss: 2.1457 - accuracy20: 0.6414 - val_loss: 2.2169 - val_accuracy20: 0.7138 - 27s/epoch - 15ms/step
Epoch 6/50
1876/1876 - 28s - loss: 2.1220 - accuracy20: 0.6443 - val_loss: 2.1999 - val_accuracy20: 0.7168 - 28s/epoch - 15ms/step
Epoch 7/50
1876/1876 - 28s - loss: 2.1049 - accuracy20: 0.6456 - val_loss: 2.1561 - val_accuracy20: 0.7161 - 28s/epoch - 15ms/step
Epoch 8/50
1876/1876 - 27s - loss: 2.0922 - accuracy20: 0.6465 - val_loss: 2.2078 - val_accuracy20: 0.7101 - 27s/epoch - 15ms/step
Epoch 9/50
1876/1876 - 27s - loss: 2.0825 - accuracy20: 0.6475 - val_loss: 2.1841 - val_accuracy20: 0.7079 - 27s/epoch - 15ms/step
Epoch 10/50
1876/1876 - 28s - loss: 2.0733 - accuracy20: 0.6501 - val_loss: 2.2029 - val_accuracy20: 0.7043 - 28s/epoch - 15ms/step
Epoch 11/50
1876/1876 - 28s - loss: 2.0648 - accuracy20: 0.6511 - val_loss: 2.2127 - val_accuracy20: 0.7109 - 28s/epoch - 15ms/step
Epoch 12/50
1876/1876 - 27s - loss: 2.0597 - accuracy20: 0.6515 - val_loss: 2.2137 - val_accuracy20: 0.7036 - 27s/epoch - 15ms/step
Epoch 13/50
1876/1876 - 27s - loss: 2.0534 - accuracy20: 0.6528 - val_loss: 2.1916 - val_accuracy20: 0.7037 - 27s/epoch - 14ms/step
Epoch 14/50
1876/1876 - 28s - loss: 2.0499 - accuracy20: 0.6537 - val_loss: 2.2425 - val_accuracy20: 0.7003 - 28s/epoch - 15ms/step
Epoch 15/50
1876/1876 - 28s - loss: 2.0435 - accuracy20: 0.6547 - val_loss: 2.2496 - val_accuracy20: 0.7063 - 28s/epoch - 15ms/step
Epoch 16/50
1876/1876 - 28s - loss: 2.0403 - accuracy20: 0.6550 - val_loss: 2.3293 - val_accuracy20: 0.7007 - 28s/epoch - 15ms/step
Epoch 17/50
1876/1876 - 28s - loss: 2.0367 - accuracy20: 0.6560 - val_loss: 2.2817 - val_accuracy20: 0.6999 - 28s/epoch - 15ms/step
testing model: results/EXC/W3/deepLOB_L1/h20
Evaluating performance on  test set...
5098/5098 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.73785806
{'0': {'precision': 0.404620479675231, 'recall': 0.7207292068068183, 'f1-score': 0.5182776533856978, 'support': 210201}, '1': {'precision': 0.845220527458061, 'recall': 0.6280195359865133, 'f1-score': 0.7206089715200821, 'support': 887388}, '2': {'precision': 0.42464409530132036, 'recall': 0.5553583314843576, 'f1-score': 0.4812837801121092, 'support': 207322}, 'accuracy': 0.6314093451584054, 'macro avg': {'precision': 0.5581617008115375, 'recall': 0.634702358092563, 'f1-score': 0.573390135005963, 'support': 1304911}, 'weighted avg': {'precision': 0.7074262122046847, 'recall': 0.6314093451584054, 'f1-score': 0.6499929503996765, 'support': 1304911}}
[[151498  43811  14892]
 [188981 557297 141110]
 [ 33941  58243 115138]]
Evaluating performance on  train set...
1876/1876 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69109863
{'0': {'precision': 0.439739158446443, 'recall': 0.656749798455257, 'f1-score': 0.5267697442181838, 'support': 76906}, '1': {'precision': 0.8319923680721666, 'recall': 0.7306080084266808, 'f1-score': 0.7780111872561706, 'support': 324683}, '2': {'precision': 0.47518384644148076, 'recall': 0.48492711592765014, 'f1-score': 0.4800060435132958, 'support': 78618}, 'accuracy': 0.6785573721332675, 'macro avg': {'precision': 0.5823051243200301, 'recall': 0.6240949742698626, 'f1-score': 0.5949289916625501, 'support': 480207}, 'weighted avg': {'precision': 0.7107567390766769, 'recall': 0.6785573721332675, 'f1-score': 0.6889859485381662, 'support': 480207}}
[[ 50508  20619   5779]
 [ 51140 237216  36327]
 [ 13211  27283  38124]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.62196124
{'0': {'precision': 0.45467374298248303, 'recall': 0.6443632885526717, 'f1-score': 0.5331486744127486, 'support': 23001}, '1': {'precision': 0.8459009997561571, 'recall': 0.7758216592417655, 'f1-score': 0.80934716370135, 'support': 111786}, '2': {'precision': 0.5096344086021506, 'recall': 0.5023955904176384, 'f1-score': 0.5059891107078041, 'support': 23585}, 'accuracy': 0.7160104058798272, 'macro avg': {'precision': 0.6034030504469302, 'recall': 0.6408601794040251, 'f1-score': 0.6161616496073009, 'support': 158372}, 'weighted avg': {'precision': 0.7390041639176342, 'recall': 0.7160104058798272, 'f1-score': 0.7240572063100188, 'support': 158372}}
[[14821  6682  1498]
 [15157 86726  9903]
 [ 2619  9117 11849]]
training model: results/EXC/W3/deepLOB_L1/h30
Epoch 1/50
1876/1876 - 30s - loss: 2.7044 - accuracy30: 0.5135 - val_loss: 2.7152 - val_accuracy30: 0.5799 - 30s/epoch - 16ms/step
Epoch 2/50
1876/1876 - 28s - loss: 2.4377 - accuracy30: 0.5916 - val_loss: 2.8411 - val_accuracy30: 0.6015 - 28s/epoch - 15ms/step
Epoch 3/50
1876/1876 - 27s - loss: 2.3329 - accuracy30: 0.6129 - val_loss: 2.7018 - val_accuracy30: 0.6287 - 27s/epoch - 15ms/step
Epoch 4/50
1876/1876 - 28s - loss: 2.2872 - accuracy30: 0.6188 - val_loss: 2.6945 - val_accuracy30: 0.6390 - 28s/epoch - 15ms/step
Epoch 5/50
1876/1876 - 28s - loss: 2.2616 - accuracy30: 0.6214 - val_loss: 2.6505 - val_accuracy30: 0.6506 - 28s/epoch - 15ms/step
Epoch 6/50
1876/1876 - 28s - loss: 2.2414 - accuracy30: 0.6231 - val_loss: 2.6054 - val_accuracy30: 0.6498 - 28s/epoch - 15ms/step
Epoch 7/50
1876/1876 - 28s - loss: 2.2282 - accuracy30: 0.6250 - val_loss: 2.5637 - val_accuracy30: 0.6591 - 28s/epoch - 15ms/step
Epoch 8/50
1876/1876 - 27s - loss: 2.2178 - accuracy30: 0.6266 - val_loss: 2.5732 - val_accuracy30: 0.6558 - 27s/epoch - 15ms/step
Epoch 9/50
1876/1876 - 28s - loss: 2.2085 - accuracy30: 0.6281 - val_loss: 2.5733 - val_accuracy30: 0.6529 - 28s/epoch - 15ms/step
Epoch 10/50
1876/1876 - 27s - loss: 2.2003 - accuracy30: 0.6294 - val_loss: 2.6181 - val_accuracy30: 0.6506 - 27s/epoch - 15ms/step
Epoch 11/50
1876/1876 - 28s - loss: 2.1955 - accuracy30: 0.6305 - val_loss: 2.5952 - val_accuracy30: 0.6512 - 28s/epoch - 15ms/step
Epoch 12/50
1876/1876 - 28s - loss: 2.1894 - accuracy30: 0.6314 - val_loss: 2.6280 - val_accuracy30: 0.6505 - 28s/epoch - 15ms/step
Epoch 13/50
1876/1876 - 28s - loss: 2.1844 - accuracy30: 0.6318 - val_loss: 2.5942 - val_accuracy30: 0.6588 - 28s/epoch - 15ms/step
Epoch 14/50
1876/1876 - 28s - loss: 2.1790 - accuracy30: 0.6331 - val_loss: 2.6500 - val_accuracy30: 0.6605 - 28s/epoch - 15ms/step
Epoch 15/50
1876/1876 - 27s - loss: 2.1751 - accuracy30: 0.6339 - val_loss: 2.6658 - val_accuracy30: 0.6605 - 27s/epoch - 14ms/step
Epoch 16/50
1876/1876 - 27s - loss: 2.1706 - accuracy30: 0.6338 - val_loss: 2.6810 - val_accuracy30: 0.6576 - 27s/epoch - 15ms/step
Epoch 17/50
1876/1876 - 27s - loss: 2.1674 - accuracy30: 0.6349 - val_loss: 2.7477 - val_accuracy30: 0.6524 - 27s/epoch - 15ms/step
testing model: results/EXC/W3/deepLOB_L1/h30
Evaluating performance on  test set...
5098/5098 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7885782
{'0': {'precision': 0.4722152570872297, 'recall': 0.507854109081103, 'f1-score': 0.4893867045760701, 'support': 252161}, '1': {'precision': 0.7301421562133927, 'recall': 0.6985755325599659, 'f1-score': 0.7140101219845186, 'support': 804792}, '2': {'precision': 0.464964868175079, 'recall': 0.49452326603699015, 'f1-score': 0.4792887728439119, 'support': 247958}, 'accuracy': 0.6229466990469081, 'macro avg': {'precision': 0.5557740938252338, 'recall': 0.566984302559353, 'f1-score': 0.5608951998015003, 'support': 1304911}, 'weighted avg': {'precision': 0.6299116157413173, 'recall': 0.6229466990469081, 'f1-score': 0.6260023560546288, 'support': 1304911}}
[[128061 106482  17618]
 [119102 562208 123482]
 [ 24029 101308 122621]]
Evaluating performance on  train set...
1876/1876 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76938754
{'0': {'precision': 0.48178668619329174, 'recall': 0.48184988031086384, 'f1-score': 0.48181828117998104, 'support': 91487}, '1': {'precision': 0.7248130972866296, 'recall': 0.7580194194499517, 'f1-score': 0.7410444497455471, 'support': 295065}, '2': {'precision': 0.5071450858034321, 'recall': 0.4338796647269233, 'f1-score': 0.4676602600989757, 'support': 93655}, 'accuracy': 0.6421876399136206, 'macro avg': {'precision': 0.5712482897611179, 'recall': 0.557916321495913, 'f1-score': 0.5635076636748346, 'support': 480207}, 'weighted avg': {'precision': 0.6360608406823837, 'recall': 0.6421876399136206, 'f1-score': 0.6383395313147296, 'support': 480207}}
[[ 44083  41081   6323]
 [ 38233 223665  33167]
 [  9183  43837  40635]]
Evaluating performance on  val set...
619/619 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73520446
{'0': {'precision': 0.45856418719792524, 'recall': 0.5574862957256995, 'f1-score': 0.5032097407952395, 'support': 27911}, '1': {'precision': 0.7466052822873758, 'recall': 0.757202819199654, 'f1-score': 0.7518667096131885, 'support': 101731}, '2': {'precision': 0.5481777568774983, 'recall': 0.40574312565262793, 'f1-score': 0.46632663266326635, 'support': 28730}, 'accuracy': 0.6582476700426844, 'macro avg': {'precision': 0.5844490754542665, 'recall': 0.5734774135259939, 'f1-score': 0.5738010276905648, 'support': 158372}, 'weighted avg': {'precision': 0.6598453890608746, 'recall': 0.6582476700426844, 'f1-score': 0.6562448126399291, 'support': 158372}}
[[15560 11072  1279]
 [16371 77031  8329]
 [ 2001 15072 11657]]
training model: results/EXC/W3/deepLOB_L1/h50
Epoch 1/50
1876/1876 - 30s - loss: 2.8803 - accuracy50: 0.4942 - val_loss: 2.9306 - val_accuracy50: 0.5268 - 30s/epoch - 16ms/step
Epoch 2/50
1876/1876 - 28s - loss: 2.6907 - accuracy50: 0.5555 - val_loss: 2.8382 - val_accuracy50: 0.5773 - 28s/epoch - 15ms/step
Epoch 3/50
1876/1876 - 28s - loss: 2.5765 - accuracy50: 0.5788 - val_loss: 2.7400 - val_accuracy50: 0.5857 - 28s/epoch - 15ms/step
Epoch 4/50
1876/1876 - 28s - loss: 2.5307 - accuracy50: 0.5843 - val_loss: 2.6561 - val_accuracy50: 0.6060 - 28s/epoch - 15ms/step
Epoch 5/50
1876/1876 - 27s - loss: 2.5014 - accuracy50: 0.5883 - val_loss: 2.6084 - val_accuracy50: 0.6156 - 27s/epoch - 15ms/step
Epoch 6/50
1876/1876 - 28s - loss: 2.4845 - accuracy50: 0.5901 - val_loss: 2.5821 - val_accuracy50: 0.6160 - 28s/epoch - 15ms/step
Epoch 7/50
1876/1876 - 27s - loss: 2.4725 - accuracy50: 0.5916 - val_loss: 2.5795 - val_accuracy50: 0.6186 - 27s/epoch - 15ms/step
Epoch 8/50
1876/1876 - 27s - loss: 2.4631 - accuracy50: 0.5935 - val_loss: 2.5622 - val_accuracy50: 0.6211 - 27s/epoch - 15ms/step
Epoch 9/50
1876/1876 - 28s - loss: 2.4565 - accuracy50: 0.5955 - val_loss: 2.5738 - val_accuracy50: 0.6194 - 28s/epoch - 15ms/step
Epoch 10/50
1876/1876 - 28s - loss: 2.4509 - accuracy50: 0.5955 - val_loss: 2.5803 - val_accuracy50: 0.6177 - 28s/epoch - 15ms/step
Epoch 11/50
1876/1876 - 28s - loss: 2.4463 - accuracy50: 0.5970 - val_loss: 2.5784 - val_accuracy50: 0.6203 - 28s/epoch - 15ms/step
Epoch 12/50
1876/1876 - 27s - loss: 2.4407 - accuracy50: 0.5977 - val_loss: 2.5732 - val_accuracy50: 0.6181 - 27s/epoch - 14ms/step
Epoch 13/50
1876/1876 - 27s - loss: 2.4369 - accuracy50: 0.5982 - val_loss: 2.5633 - val_accuracy50: 0.6181 - 27s/epoch - 14ms/step
Epoch 14/50
1876/1876 - 27s - loss: 2.4327 - accuracy50: 0.5988 - val_loss: 2.5572 - val_accuracy50: 0.6205 - 27s/epoch - 14ms/step
Epoch 15/50
1876/1876 - 27s - loss: 2.4293 - accuracy50: 0.5990 - val_loss: 2.5582 - val_accuracy50: 0.6184 - 27s/epoch - 15ms/step
Epoch 16/50
1876/1876 - 28s - loss: 2.4257 - accuracy50: 0.6001 - val_loss: 2.5769 - val_accuracy50: 0.6193 - 28s/epoch - 15ms/step
Epoch 17/50
1876/1876 - 27s - loss: 2.4234 - accuracy50: 0.6002 - val_loss: 2.5735 - val_accuracy50: 0.6170 - 27s/epoch - 15ms/step
Epoch 18/50
1876/1876 - 28s - loss: 2.4192 - accuracy50: 0.6011 - val_loss: 2.5681 - val_accuracy50: 0.6187 - 28s/epoch - 15ms/step
Epoch 19/50
1876/1876 - 28s - loss: 2.4168 - accuracy50: 0.6009 - val_loss: 2.5860 - val_accuracy50: 0.6153 - 28s/epoch - 15ms/step
Epoch 20/50
1876/1876 - 28s - loss: 2.4138 - accuracy50: 0.6009 - val_loss: 2.5875 - val_accuracy50: 0.6155 - 28s/epoch - 15ms/step
Epoch 21/50
1876/1876 - 27s - loss: 2.4112 - accuracy50: 0.6020 - val_loss: 2.5777 - val_accuracy50: 0.6124 - 27s/epoch - 15ms/step
Epoch 22/50
1876/1876 - 28s - loss: 2.4081 - accuracy50: 0.6031 - val_loss: 2.5855 - val_accuracy50: 0.6123 - 28s/epoch - 15ms/step
Epoch 23/50
1876/1876 - 27s - loss: 2.4062 - accuracy50: 0.6027 - val_loss: 2.6014 - val_accuracy50: 0.6124 - 27s/epoch - 15ms/step
Epoch 24/50
1876/1876 - 27s - loss: 2.4032 - accuracy50: 0.6039 - val_loss: 2.5997 - val_accuracy50: 0.6128 - 27s/epoch - 15ms/step
testing model: results/EXC/W3/deepLOB_L1/h50
Evaluating performance on  test set...
5098/5098 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87361646
{'0': {'precision': 0.5305412949630575, 'recall': 0.49458170239009225, 'f1-score': 0.5119307976283337, 'support': 317812}, '1': {'precision': 0.6780147261432642, 'recall': 0.5759049458721196, 'f1-score': 0.6228023100274737, 'support': 675068}, '2': {'precision': 0.45286946452285876, 'recall': 0.6316872362040951, 'f1-score': 0.5275369378363078, 'support': 312031}, 'accuracy': 0.5694373026206385, 'macro avg': {'precision': 0.5538084952097269, 'recall': 0.5673912948221023, 'f1-score': 0.5540900151640384, 'support': 1304911}, 'weighted avg': {'precision': 0.5882606147602499, 'recall': 0.5694373026206385, 'f1-score': 0.5730195689449192, 'support': 1304911}}
[[157184 105495  55133]
 [103294 388775 182999]
 [ 35793  79132 197106]]
Evaluating performance on  train set...
1876/1876 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83813095
{'0': {'precision': 0.5316255503597473, 'recall': 0.4758434477154167, 'f1-score': 0.502190211828066, 'support': 114441}, '1': {'precision': 0.6827950386835319, 'recall': 0.6695219019559834, 'f1-score': 0.6760933316849843, 'support': 249133}, '2': {'precision': 0.5005543735578796, 'recall': 0.5728738864643798, 'f1-score': 0.5342779579156954, 'support': 116633}, 'accuracy': 0.5998912968782213, 'macro avg': {'precision': 0.5716583208670528, 'recall': 0.57274641204526, 'f1-score': 0.5708538338095819, 'support': 480207}, 'weighted avg': {'precision': 0.6025061988522458, 'recall': 0.5998912968782213, 'f1-score': 0.6002052262879803, 'support': 480207}}
[[ 54456  41152  18833]
 [ 34498 166800  47835]
 [ 13479  36338  66816]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8039227
{'0': {'precision': 0.5307872805243142, 'recall': 0.547472668094695, 'f1-score': 0.5390008764241894, 'support': 35947}, '1': {'precision': 0.6785047767162853, 'recall': 0.7143826243581797, 'f1-score': 0.6959816316182293, 'support': 85499}, '2': {'precision': 0.5581454836131096, 'recall': 0.4727292422683204, 'f1-score': 0.5118986525124265, 'support': 36926}, 'accuracy': 0.6201538150683201, 'macro avg': {'precision': 0.5891458469512364, 'recall': 0.578194844907065, 'f1-score': 0.5822937201849484, 'support': 158372}, 'weighted avg': {'precision': 0.6169131563999374, 'recall': 0.6201538150683201, 'f1-score': 0.6174296445660924, 'support': 158372}}
[[19680 13402  2865]
 [13466 61079 10954]
 [ 3931 15539 17456]]
training model: results/EXC/W3/deepLOB_L1/h100
Epoch 1/50
1876/1876 - 30s - loss: 3.1018 - accuracy100: 0.4513 - val_loss: 3.2153 - val_accuracy100: 0.4163 - 30s/epoch - 16ms/step
Epoch 2/50
1876/1876 - 27s - loss: 3.0187 - accuracy100: 0.4813 - val_loss: 3.2350 - val_accuracy100: 0.4336 - 27s/epoch - 15ms/step
Epoch 3/50
1876/1876 - 27s - loss: 2.9483 - accuracy100: 0.5012 - val_loss: 3.1656 - val_accuracy100: 0.4490 - 27s/epoch - 14ms/step
Epoch 4/50
1876/1876 - 27s - loss: 2.9020 - accuracy100: 0.5113 - val_loss: 3.1704 - val_accuracy100: 0.4582 - 27s/epoch - 15ms/step
Epoch 5/50
1876/1876 - 29s - loss: 2.8793 - accuracy100: 0.5151 - val_loss: 3.1670 - val_accuracy100: 0.4612 - 29s/epoch - 16ms/step
Epoch 6/50
1876/1876 - 29s - loss: 2.8672 - accuracy100: 0.5170 - val_loss: 3.3027 - val_accuracy100: 0.4515 - 29s/epoch - 16ms/step
Epoch 7/50
1876/1876 - 28s - loss: 2.8556 - accuracy100: 0.5191 - val_loss: 3.4207 - val_accuracy100: 0.4472 - 28s/epoch - 15ms/step
Epoch 8/50
1876/1876 - 29s - loss: 2.8498 - accuracy100: 0.5198 - val_loss: 3.4551 - val_accuracy100: 0.4422 - 29s/epoch - 15ms/step
Epoch 9/50
1876/1876 - 28s - loss: 2.8434 - accuracy100: 0.5214 - val_loss: 3.3977 - val_accuracy100: 0.4476 - 28s/epoch - 15ms/step
Epoch 10/50
1876/1876 - 27s - loss: 2.8387 - accuracy100: 0.5223 - val_loss: 3.4775 - val_accuracy100: 0.4407 - 27s/epoch - 15ms/step
Epoch 11/50
1876/1876 - 27s - loss: 2.8328 - accuracy100: 0.5235 - val_loss: 3.3352 - val_accuracy100: 0.4543 - 27s/epoch - 14ms/step
Epoch 12/50
1876/1876 - 27s - loss: 2.8298 - accuracy100: 0.5245 - val_loss: 3.4561 - val_accuracy100: 0.4442 - 27s/epoch - 15ms/step
Epoch 13/50
1876/1876 - 28s - loss: 2.8256 - accuracy100: 0.5254 - val_loss: 3.4698 - val_accuracy100: 0.4402 - 28s/epoch - 15ms/step
testing model: results/EXC/W3/deepLOB_L1/h100
Evaluating performance on  test set...
5098/5098 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0815865
{'0': {'precision': 0.5484803996757017, 'recall': 0.12032196737544675, 'f1-score': 0.19735049995959328, 'support': 416067}, '1': {'precision': 0.37950224290996454, 'recall': 0.8358636541208229, 'f1-score': 0.5220026862375183, 'support': 483799}, '2': {'precision': 0.5240279081705019, 'recall': 0.1915490871384661, 'f1-score': 0.280548614902857, 'support': 405045}, 'accuracy': 0.4077197601982051, 'macro avg': {'precision': 0.48400351691872273, 'recall': 0.3825782362115786, 'f1-score': 0.3333006003666562, 'support': 1304911}, 'weighted avg': {'precision': 0.47824126253391164, 'recall': 0.4077197601982051, 'f1-score': 0.3435408405546746, 'support': 1304911}}
[[ 50062 347938  18067]
 [ 27005 404390  52404]
 [ 14207 313252  77586]]
Evaluating performance on  train set...
1876/1876 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0610341
{'0': {'precision': 0.5317732862375719, 'recall': 0.21552318337265713, 'f1-score': 0.3067309324831632, 'support': 150884}, '1': {'precision': 0.3878644884313695, 'recall': 0.8415992700894366, 'f1-score': 0.5310062506440758, 'support': 177556}, '2': {'precision': 0.6139868004380123, 'recall': 0.13669638327172573, 'f1-score': 0.2236090452477958, 'support': 151767}, 'accuracy': 0.42210130214678254, 'macro avg': {'precision': 0.5112081917023179, 'recall': 0.39793961224460644, 'f1-score': 0.3537820761250116, 'support': 480207}, 'weighted avg': {'precision': 0.5045463359981546, 'recall': 0.42210130214678254, 'f1-score': 0.3633862268277458, 'support': 480207}}
[[ 32519 114141   4224]
 [ 19306 149431   8819]
 [  9327 121694  20746]]
Evaluating performance on  val set...
619/619 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0401016
{'0': {'precision': 0.5293983443061078, 'recall': 0.3372085781311632, 'f1-score': 0.4119922385258271, 'support': 48169}, '1': {'precision': 0.4103870785700239, 'recall': 0.787181001115266, 'f1-score': 0.539508219755515, 'support': 60972}, '2': {'precision': 0.6205644034646549, 'recall': 0.13534155308646992, 'f1-score': 0.22221851654215583, 'support': 49231}, 'accuracy': 0.44769277397519763, 'macro avg': {'precision': 0.5201166087802621, 'recall': 0.41991037744429965, 'f1-score': 0.3912396582744993, 'support': 158372}, 'weighted avg': {'precision': 0.5119195056475945, 'recall': 0.44769277397519763, 'f1-score': 0.40209247278793414, 'support': 158372}}
[[16243 30840  1086]
 [ 9988 47996  2988]
 [ 4451 38117  6663]]
training model: results/EXC/W3/deepLOB_L1/h200
Epoch 1/50
1876/1876 - 29s - loss: 3.2201 - accuracy200: 0.4119 - val_loss: 3.3913 - val_accuracy200: 0.3737 - 29s/epoch - 16ms/step
Epoch 2/50
1876/1876 - 27s - loss: 3.1876 - accuracy200: 0.4208 - val_loss: 3.5171 - val_accuracy200: 0.3562 - 27s/epoch - 14ms/step
Epoch 3/50
1876/1876 - 28s - loss: 3.1729 - accuracy200: 0.4273 - val_loss: 3.3773 - val_accuracy200: 0.3588 - 28s/epoch - 15ms/step
Epoch 4/50
1876/1876 - 27s - loss: 3.1619 - accuracy200: 0.4313 - val_loss: 3.5469 - val_accuracy200: 0.3540 - 27s/epoch - 14ms/step
Epoch 5/50
1876/1876 - 27s - loss: 3.1531 - accuracy200: 0.4352 - val_loss: 3.4822 - val_accuracy200: 0.3522 - 27s/epoch - 14ms/step
Epoch 6/50
1876/1876 - 27s - loss: 3.1428 - accuracy200: 0.4388 - val_loss: 3.6659 - val_accuracy200: 0.3515 - 27s/epoch - 14ms/step
Epoch 7/50
1876/1876 - 28s - loss: 3.1324 - accuracy200: 0.4417 - val_loss: 3.7269 - val_accuracy200: 0.3526 - 28s/epoch - 15ms/step
Epoch 8/50
1876/1876 - 28s - loss: 3.1258 - accuracy200: 0.4431 - val_loss: 3.6920 - val_accuracy200: 0.3520 - 28s/epoch - 15ms/step
Epoch 9/50
1876/1876 - 27s - loss: 3.1194 - accuracy200: 0.4450 - val_loss: 3.7063 - val_accuracy200: 0.3517 - 27s/epoch - 14ms/step
Epoch 10/50
1876/1876 - 27s - loss: 3.1147 - accuracy200: 0.4466 - val_loss: 3.7317 - val_accuracy200: 0.3500 - 27s/epoch - 15ms/step
Epoch 11/50
1876/1876 - 27s - loss: 3.1108 - accuracy200: 0.4478 - val_loss: 3.7789 - val_accuracy200: 0.3511 - 27s/epoch - 14ms/step
Epoch 12/50
1876/1876 - 28s - loss: 3.1059 - accuracy200: 0.4486 - val_loss: 3.6804 - val_accuracy200: 0.3507 - 28s/epoch - 15ms/step
Epoch 13/50
1876/1876 - 27s - loss: 3.1030 - accuracy200: 0.4501 - val_loss: 3.6868 - val_accuracy200: 0.3507 - 27s/epoch - 14ms/step
testing model: results/EXC/W3/deepLOB_L1/h200
Evaluating performance on  test set...
5098/5098 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1423509
{'0': {'precision': 0.41865260129465354, 'recall': 0.15666641994083066, 'f1-score': 0.22800846772943092, 'support': 445839}, '1': {'precision': 0.3559024796589053, 'recall': 0.2215402039535328, 'f1-score': 0.27308929585164315, 'support': 439708}, '2': {'precision': 0.3446869605860494, 'recall': 0.7104448641275837, 'f1-score': 0.46417153789587823, 'support': 419364}, 'accuracy': 0.35649634342878556, 'macro avg': {'precision': 0.37308068051320276, 'recall': 0.36288382934064906, 'f1-score': 0.3217564338256507, 'support': 1304911}, 'weighted avg': {'precision': 0.37373746345434516, 'recall': 0.35649634342878556, 'f1-score': 0.3190956687180376, 'support': 1304911}}
[[ 69848  95157 280834]
 [ 56700  97413 285595]
 [ 40292  81137 297935]]
Evaluating performance on  train set...
1876/1876 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1325895
{'0': {'precision': 0.3705745858892182, 'recall': 0.39594724794570146, 'f1-score': 0.38284098629616775, 'support': 162951}, '1': {'precision': 0.33814154163178567, 'recall': 0.27174341956309395, 'f1-score': 0.301328101743425, 'support': 154587}, '2': {'precision': 0.3797170459731562, 'recall': 0.4245307956648163, 'f1-score': 0.4008753802215153, 'support': 162669}, 'accuracy': 0.3656464816214674, 'macro avg': {'precision': 0.36281105783138673, 'recall': 0.3640738210578706, 'f1-score': 0.3616814894203693, 'support': 480207}, 'weighted avg': {'precision': 0.36323081086463593, 'recall': 0.3656464816214674, 'f1-score': 0.3627096773837353, 'support': 480207}}
[[64520 40731 57700]
 [57470 42008 55109]
 [52118 41493 69058]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1271654
{'0': {'precision': 0.34254830686818444, 'recall': 0.6251382019202794, 'f1-score': 0.4425814159474324, 'support': 51555}, '1': {'precision': 0.34966909023117076, 'recall': 0.2764064399661054, 'f1-score': 0.30875120887261054, 'support': 54286}, '2': {'precision': 0.42846448956676336, 'recall': 0.1743351544802117, 'f1-score': 0.24783167580001353, 'support': 52531}, 'accuracy': 0.3560730432147097, 'macro avg': {'precision': 0.37356062888870617, 'recall': 0.3586265987888655, 'f1-score': 0.33305476687335217, 'support': 158372}, 'weighted avg': {'precision': 0.37348699450856354, 'recall': 0.3560730432147097, 'f1-score': 0.33211046640491326, 'support': 158372}}
[[32229 13721  5605]
 [32670 15005  6611]
 [29187 14186  9158]]
training model: results/EXC/W3/deepLOB_L1/h300
Epoch 1/50
1876/1876 - 30s - loss: 3.2480 - accuracy300: 0.4004 - val_loss: 3.3589 - val_accuracy300: 0.3539 - 30s/epoch - 16ms/step
Epoch 2/50
1876/1876 - 28s - loss: 3.2199 - accuracy300: 0.4126 - val_loss: 3.4446 - val_accuracy300: 0.3445 - 28s/epoch - 15ms/step
Epoch 3/50
1876/1876 - 28s - loss: 3.2081 - accuracy300: 0.4179 - val_loss: 3.4656 - val_accuracy300: 0.3403 - 28s/epoch - 15ms/step
Epoch 4/50
1876/1876 - 28s - loss: 3.2001 - accuracy300: 0.4214 - val_loss: 3.3680 - val_accuracy300: 0.3490 - 28s/epoch - 15ms/step
Epoch 5/50
1876/1876 - 28s - loss: 3.1921 - accuracy300: 0.4244 - val_loss: 3.3451 - val_accuracy300: 0.3614 - 28s/epoch - 15ms/step
Epoch 6/50
1876/1876 - 28s - loss: 3.1875 - accuracy300: 0.4254 - val_loss: 3.3976 - val_accuracy300: 0.3579 - 28s/epoch - 15ms/step
Epoch 7/50
1876/1876 - 28s - loss: 3.1831 - accuracy300: 0.4281 - val_loss: 3.4599 - val_accuracy300: 0.3483 - 28s/epoch - 15ms/step
Epoch 8/50
1876/1876 - 28s - loss: 3.1790 - accuracy300: 0.4289 - val_loss: 3.4650 - val_accuracy300: 0.3402 - 28s/epoch - 15ms/step
Epoch 9/50
1876/1876 - 28s - loss: 3.1765 - accuracy300: 0.4302 - val_loss: 3.3578 - val_accuracy300: 0.3555 - 28s/epoch - 15ms/step
Epoch 10/50
1876/1876 - 27s - loss: 3.1740 - accuracy300: 0.4318 - val_loss: 3.4506 - val_accuracy300: 0.3405 - 27s/epoch - 15ms/step
Epoch 11/50
1876/1876 - 28s - loss: 3.1710 - accuracy300: 0.4325 - val_loss: 3.4395 - val_accuracy300: 0.3396 - 28s/epoch - 15ms/step
Epoch 12/50
1876/1876 - 28s - loss: 3.1670 - accuracy300: 0.4341 - val_loss: 3.5049 - val_accuracy300: 0.3381 - 28s/epoch - 15ms/step
Epoch 13/50
1876/1876 - 28s - loss: 3.1643 - accuracy300: 0.4360 - val_loss: 3.4611 - val_accuracy300: 0.3427 - 28s/epoch - 15ms/step
Epoch 14/50
1876/1876 - 28s - loss: 3.1612 - accuracy300: 0.4363 - val_loss: 3.5051 - val_accuracy300: 0.3369 - 28s/epoch - 15ms/step
Epoch 15/50
1876/1876 - 28s - loss: 3.1599 - accuracy300: 0.4370 - val_loss: 3.6005 - val_accuracy300: 0.3338 - 28s/epoch - 15ms/step
testing model: results/EXC/W3/deepLOB_L1/h300
Evaluating performance on  test set...
5098/5098 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1262798
{'0': {'precision': 0.3716032029985518, 'recall': 0.11230562611561169, 'f1-score': 0.17248344261754917, 'support': 466112}, '1': {'precision': 0.29367290714419886, 'recall': 0.32582413083875644, 'f1-score': 0.30891421218960563, 'support': 403061}, '2': {'precision': 0.3447754427324912, 'recall': 0.5672078175417338, 'f1-score': 0.4288660437812827, 'support': 435738}, 'accuracy': 0.3301589150524442, 'macro avg': {'precision': 0.33668385095841397, 'recall': 0.33511252483203396, 'f1-score': 0.3034212328628125, 'support': 1304911}, 'weighted avg': {'precision': 0.33857371855082774, 'recall': 0.3301589150524442, 'f1-score': 0.30023588265396967, 'support': 1304911}}
[[ 52347 163518 250247]
 [ 52280 131327 219454]
 [ 36241 152343 247154]]
Evaluating performance on  train set...
1876/1876 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1133362
{'0': {'precision': 0.35776475979341865, 'recall': 0.35597919850150345, 'f1-score': 0.3568697456930898, 'support': 162296}, '1': {'precision': 0.3389138798708073, 'recall': 0.25783492063492064, 'f1-score': 0.2928663894908788, 'support': 157500}, '2': {'precision': 0.3568275515334339, 'recall': 0.44244472012517844, 'f1-score': 0.3950505272591154, 'support': 160411}, 'accuracy': 0.35267290980764543, 'macro avg': {'precision': 0.3511687303992199, 'recall': 0.3520862797538675, 'f1-score': 0.3482622208143613, 'support': 480207}, 'weighted avg': {'precision': 0.3512689109157394, 'recall': 0.35267290980764543, 'f1-score': 0.3486318165290824, 'support': 480207}}
[[57774 38131 66391]
 [55355 40609 61536]
 [48357 41081 70973]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.113812
{'0': {'precision': 0.3489374262101535, 'recall': 0.5798850236427492, 'f1-score': 0.4356991751863017, 'support': 50967}, '1': {'precision': 0.37890128095139486, 'recall': 0.23124977431119778, 'f1-score': 0.2872103062036798, 'support': 55386}, '2': {'precision': 0.372921317314204, 'recall': 0.2858186431880659, 'f1-score': 0.32361135295141913, 'support': 52019}, 'accuracy': 0.36137069684035056, 'macro avg': {'precision': 0.36692000815858417, 'recall': 0.3656511470473376, 'f1-score': 0.3488402781138002, 'support': 158372}, 'weighted avg': {'precision': 0.3672941817606296, 'recall': 0.36137069684035056, 'f1-score': 0.34695305262481446, 'support': 158372}}
[[29555  9311 12101]
 [29678 12808 12900]
 [25467 11684 14868]]
training model: results/EXC/W3/deepLOB_L1/h500
Epoch 1/50
1876/1876 - 32s - loss: 3.2657 - accuracy500: 0.3934 - val_loss: 3.4165 - val_accuracy500: 0.3468 - 32s/epoch - 17ms/step
Epoch 2/50
1876/1876 - 28s - loss: 3.2316 - accuracy500: 0.4098 - val_loss: 3.5935 - val_accuracy500: 0.3417 - 28s/epoch - 15ms/step
Epoch 3/50
1876/1876 - 29s - loss: 3.2101 - accuracy500: 0.4210 - val_loss: 3.4883 - val_accuracy500: 0.3436 - 29s/epoch - 15ms/step
Epoch 4/50
1876/1876 - 28s - loss: 3.1975 - accuracy500: 0.4280 - val_loss: 3.4116 - val_accuracy500: 0.3479 - 28s/epoch - 15ms/step
Epoch 5/50
1876/1876 - 28s - loss: 3.1876 - accuracy500: 0.4318 - val_loss: 3.4237 - val_accuracy500: 0.3445 - 28s/epoch - 15ms/step
Epoch 6/50
1876/1876 - 28s - loss: 3.1806 - accuracy500: 0.4350 - val_loss: 3.4255 - val_accuracy500: 0.3445 - 28s/epoch - 15ms/step
Epoch 7/50
1876/1876 - 28s - loss: 3.1741 - accuracy500: 0.4369 - val_loss: 3.4075 - val_accuracy500: 0.3473 - 28s/epoch - 15ms/step
Epoch 8/50
1876/1876 - 28s - loss: 3.1702 - accuracy500: 0.4388 - val_loss: 3.3904 - val_accuracy500: 0.3494 - 28s/epoch - 15ms/step
Epoch 9/50
1876/1876 - 28s - loss: 3.1650 - accuracy500: 0.4417 - val_loss: 3.3902 - val_accuracy500: 0.3487 - 28s/epoch - 15ms/step
Epoch 10/50
1876/1876 - 28s - loss: 3.1602 - accuracy500: 0.4432 - val_loss: 3.3902 - val_accuracy500: 0.3490 - 28s/epoch - 15ms/step
Epoch 11/50
1876/1876 - 28s - loss: 3.1566 - accuracy500: 0.4447 - val_loss: 3.3845 - val_accuracy500: 0.3463 - 28s/epoch - 15ms/step
Epoch 12/50
1876/1876 - 28s - loss: 3.1534 - accuracy500: 0.4451 - val_loss: 3.3944 - val_accuracy500: 0.3479 - 28s/epoch - 15ms/step
Epoch 13/50
1876/1876 - 28s - loss: 3.1498 - accuracy500: 0.4470 - val_loss: 3.3974 - val_accuracy500: 0.3495 - 28s/epoch - 15ms/step
Epoch 14/50
1876/1876 - 27s - loss: 3.1463 - accuracy500: 0.4482 - val_loss: 3.4169 - val_accuracy500: 0.3503 - 27s/epoch - 15ms/step
Epoch 15/50
1876/1876 - 28s - loss: 3.1441 - accuracy500: 0.4487 - val_loss: 3.4146 - val_accuracy500: 0.3497 - 28s/epoch - 15ms/step
Epoch 16/50
1876/1876 - 28s - loss: 3.1405 - accuracy500: 0.4495 - val_loss: 3.4209 - val_accuracy500: 0.3526 - 28s/epoch - 15ms/step
Epoch 17/50
1876/1876 - 28s - loss: 3.1379 - accuracy500: 0.4510 - val_loss: 3.4185 - val_accuracy500: 0.3489 - 28s/epoch - 15ms/step
Epoch 18/50
1876/1876 - 29s - loss: 3.1350 - accuracy500: 0.4522 - val_loss: 3.4279 - val_accuracy500: 0.3505 - 29s/epoch - 15ms/step
Epoch 19/50
1876/1876 - 28s - loss: 3.1329 - accuracy500: 0.4527 - val_loss: 3.4344 - val_accuracy500: 0.3492 - 28s/epoch - 15ms/step
Epoch 20/50
1876/1876 - 28s - loss: 3.1304 - accuracy500: 0.4535 - val_loss: 3.4557 - val_accuracy500: 0.3482 - 28s/epoch - 15ms/step
Epoch 21/50
1876/1876 - 27s - loss: 3.1284 - accuracy500: 0.4538 - val_loss: 3.4500 - val_accuracy500: 0.3465 - 27s/epoch - 15ms/step
testing model: results/EXC/W3/deepLOB_L1/h500
Evaluating performance on  test set...
5098/5098 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1636125
{'0': {'precision': 0.37724132100558744, 'recall': 0.10608765567116371, 'f1-score': 0.16560417148149337, 'support': 462674}, '1': {'precision': 0.31831550232300415, 'recall': 0.31899988609181, 'f1-score': 0.3186573267432351, 'support': 421392}, '2': {'precision': 0.324531561461794, 'recall': 0.5802849029927883, 'f1-score': 0.41626290647678216, 'support': 420845}, 'accuracy': 0.32777561075046496, 'macro avg': {'precision': 0.3400294615967952, 'recall': 0.33512414825192066, 'f1-score': 0.3001748015671702, 'support': 1304911}, 'weighted avg': {'precision': 0.34121318779075605, 'recall': 0.32777561075046496, 'f1-score': 0.2958688795965665, 'support': 1304911}}
[[ 49084 148502 265088]
 [ 43766 134424 243202]
 [ 37263 139372 244210]]
Evaluating performance on  train set...
1876/1876 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1452948
{'0': {'precision': 0.35627927473292914, 'recall': 0.303690868553703, 'f1-score': 0.32788987044929013, 'support': 165056}, '1': {'precision': 0.33473354917148207, 'recall': 0.317150197705196, 'f1-score': 0.3257047343393292, 'support': 154523}, '2': {'precision': 0.34317066097727694, 'recall': 0.4125619443683542, 'f1-score': 0.3746805527285885, 'support': 160628}, 'accuracy': 0.3444389606981989, 'macro avg': {'precision': 0.3447278282938961, 'recall': 0.34446767020908436, 'f1-score': 0.3427583858390693, 'support': 480207}, 'weighted avg': {'precision': 0.34496140439519063, 'recall': 0.3444389606981989, 'f1-score': 0.34283809054195774, 'support': 480207}}
[[50126 48731 66199]
 [44876 49007 60640]
 [45691 48668 66269]]
Evaluating performance on  val set...
619/619 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1295707
{'0': {'precision': 0.3496115205624463, 'recall': 0.33576950375016784, 'f1-score': 0.3425507348480401, 'support': 52131}, '1': {'precision': 0.33772773660348315, 'recall': 0.38742179403523586, 'f1-score': 0.36087201351460063, 'support': 52106}, '2': {'precision': 0.3579906041374763, 'recall': 0.3209383947538561, 'f1-score': 0.33845344657971893, 'support': 54135}, 'accuracy': 0.34769403682469124, 'macro avg': {'precision': 0.3484432871011352, 'recall': 0.3480432308464199, 'f1-score': 0.3472920649807865, 'support': 158372}, 'weighted avg': {'precision': 0.34856578799841054, 'recall': 0.34769403682469124, 'f1-score': 0.3471780796172811, 'support': 158372}}
[[17504 19041 15586]
 [16347 20187 15572]
 [16216 20545 17374]]
training model: results/EXC/W3/deepLOB_L1/h1000
Epoch 1/50
1876/1876 - 30s - loss: 3.2139 - accuracy1000: 0.4303 - val_loss: 3.4358 - val_accuracy1000: 0.3385 - 30s/epoch - 16ms/step
Epoch 2/50
1876/1876 - 27s - loss: 3.1744 - accuracy1000: 0.4477 - val_loss: 3.4896 - val_accuracy1000: 0.3186 - 27s/epoch - 15ms/step
Epoch 3/50
1876/1876 - 28s - loss: 3.1546 - accuracy1000: 0.4546 - val_loss: 3.4193 - val_accuracy1000: 0.3223 - 28s/epoch - 15ms/step
Epoch 4/50
1876/1876 - 28s - loss: 3.1472 - accuracy1000: 0.4569 - val_loss: 3.3719 - val_accuracy1000: 0.3433 - 28s/epoch - 15ms/step
Epoch 5/50
1876/1876 - 28s - loss: 3.1367 - accuracy1000: 0.4600 - val_loss: 3.3755 - val_accuracy1000: 0.3362 - 28s/epoch - 15ms/step
Epoch 6/50
1876/1876 - 29s - loss: 3.1265 - accuracy1000: 0.4648 - val_loss: 3.3512 - val_accuracy1000: 0.3554 - 29s/epoch - 15ms/step
Epoch 7/50
1876/1876 - 28s - loss: 3.1223 - accuracy1000: 0.4660 - val_loss: 3.3569 - val_accuracy1000: 0.3544 - 28s/epoch - 15ms/step
Epoch 8/50
1876/1876 - 28s - loss: 3.1120 - accuracy1000: 0.4683 - val_loss: 3.3571 - val_accuracy1000: 0.3746 - 28s/epoch - 15ms/step
Epoch 9/50
1876/1876 - 28s - loss: 3.1102 - accuracy1000: 0.4681 - val_loss: 3.3507 - val_accuracy1000: 0.3800 - 28s/epoch - 15ms/step
Epoch 10/50
1876/1876 - 28s - loss: 3.1042 - accuracy1000: 0.4697 - val_loss: 3.3680 - val_accuracy1000: 0.3714 - 28s/epoch - 15ms/step
Epoch 11/50
1876/1876 - 29s - loss: 3.1000 - accuracy1000: 0.4691 - val_loss: 3.3656 - val_accuracy1000: 0.3699 - 29s/epoch - 15ms/step
Epoch 12/50
1876/1876 - 27s - loss: 3.0973 - accuracy1000: 0.4710 - val_loss: 3.3716 - val_accuracy1000: 0.3763 - 27s/epoch - 15ms/step
Epoch 13/50
1876/1876 - 28s - loss: 3.0901 - accuracy1000: 0.4747 - val_loss: 3.3801 - val_accuracy1000: 0.3773 - 28s/epoch - 15ms/step
Epoch 14/50
1876/1876 - 27s - loss: 3.0850 - accuracy1000: 0.4768 - val_loss: 3.3749 - val_accuracy1000: 0.3752 - 27s/epoch - 15ms/step
Epoch 15/50
1876/1876 - 28s - loss: 3.0852 - accuracy1000: 0.4751 - val_loss: 3.3687 - val_accuracy1000: 0.3749 - 28s/epoch - 15ms/step
Epoch 16/50
1876/1876 - 28s - loss: 3.0817 - accuracy1000: 0.4760 - val_loss: 3.3777 - val_accuracy1000: 0.3771 - 28s/epoch - 15ms/step
Epoch 17/50
1876/1876 - 28s - loss: 3.0800 - accuracy1000: 0.4773 - val_loss: 3.3770 - val_accuracy1000: 0.3775 - 28s/epoch - 15ms/step
Epoch 18/50
1876/1876 - 28s - loss: 3.0755 - accuracy1000: 0.4785 - val_loss: 3.3826 - val_accuracy1000: 0.3785 - 28s/epoch - 15ms/step
Epoch 19/50
1876/1876 - 27s - loss: 3.0726 - accuracy1000: 0.4792 - val_loss: 3.4088 - val_accuracy1000: 0.3787 - 27s/epoch - 15ms/step
testing model: results/EXC/W3/deepLOB_L1/h1000
Evaluating performance on  test set...
5098/5098 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1298778
{'0': {'precision': 0.4326991119571826, 'recall': 0.08310187799448336, 'f1-score': 0.1394262884743847, 'support': 522419}, '1': {'precision': 0.2655486597121352, 'recall': 0.1372862369321761, 'f1-score': 0.18099810377873737, 'support': 322261}, '2': {'precision': 0.3617746914174949, 'recall': 0.8159207006916093, 'f1-score': 0.5012832039449928, 'support': 460231}, 'accuracy': 0.35494221444987434, 'macro avg': {'precision': 0.35334082102893755, 'recall': 0.3454362718727562, 'f1-score': 0.27390253206603826, 'support': 1304911}, 'weighted avg': {'precision': 0.36640517399486777, 'recall': 0.35494221444987434, 'f1-score': 0.2773167230218362, 'support': 1304911}}
[[ 43414  66814 412191]
 [ 27750  44242 250269]
 [ 29169  55550 375512]]
Evaluating performance on  train set...
1876/1876 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1343204
{'0': {'precision': 0.35522784992093537, 'recall': 0.1772995790682101, 'f1-score': 0.23653898310492813, 'support': 167248}, '1': {'precision': 0.3695404506736259, 'recall': 0.3666143160357211, 'f1-score': 0.3680715678221888, 'support': 152179}, '2': {'precision': 0.34665543606082433, 'recall': 0.529873118547083, 'f1-score': 0.41911560325382435, 'support': 160780}, 'accuracy': 0.35534050940531897, 'macro avg': {'precision': 0.3571412455517952, 'recall': 0.35792900455033805, 'f1-score': 0.3412420513936471, 'support': 480207}, 'weighted avg': {'precision': 0.3568933911760921, 'recall': 0.35534050940531897, 'f1-score': 0.33935124156269225, 'support': 480207}}
[[29653 49404 88191]
 [24015 55791 72373]
 [29808 45779 85193]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1150403
{'0': {'precision': 0.32552911503454324, 'recall': 0.1205188583492347, 'f1-score': 0.1759111111111111, 'support': 49262}, '1': {'precision': 0.3948559432001604, 'recall': 0.6429049933868114, 'f1-score': 0.4892357162464217, 'support': 58217}, '2': {'precision': 0.3696107619362664, 'recall': 0.32931837384316115, 'f1-score': 0.3483031650699308, 'support': 50893}, 'accuracy': 0.3796441290127043, 'macro avg': {'precision': 0.36333194005698993, 'recall': 0.3642474085264024, 'f1-score': 0.33781666414248784, 'support': 158372}, 'weighted avg': {'precision': 0.36517909868750675, 'recall': 0.3796441290127043, 'f1-score': 0.34648651168247846, 'support': 158372}}
[[ 5937 28402 14923]
 [ 7127 37428 13662]
 [ 5174 28959 16760]]
training model: results/EXC/W3/deepOF_L1/h10
Epoch 1/50
1876/1876 - 29s - loss: 3.0782 - accuracy10: 0.3969 - val_loss: 2.8711 - val_accuracy10: 0.6669 - 29s/epoch - 15ms/step
Epoch 2/50
1876/1876 - 24s - loss: 3.0131 - accuracy10: 0.3986 - val_loss: 2.7584 - val_accuracy10: 0.6149 - 24s/epoch - 13ms/step
Epoch 3/50
1876/1876 - 25s - loss: 2.9561 - accuracy10: 0.4317 - val_loss: 2.7103 - val_accuracy10: 0.6128 - 25s/epoch - 13ms/step
Epoch 4/50
1876/1876 - 25s - loss: 2.9093 - accuracy10: 0.4541 - val_loss: 2.6770 - val_accuracy10: 0.6370 - 25s/epoch - 13ms/step
Epoch 5/50
1876/1876 - 25s - loss: 2.8710 - accuracy10: 0.4661 - val_loss: 2.6482 - val_accuracy10: 0.6407 - 25s/epoch - 13ms/step
Epoch 6/50
1876/1876 - 25s - loss: 2.8303 - accuracy10: 0.4818 - val_loss: 2.6329 - val_accuracy10: 0.6288 - 25s/epoch - 13ms/step
Epoch 7/50
1876/1876 - 25s - loss: 2.8070 - accuracy10: 0.4890 - val_loss: 2.6895 - val_accuracy10: 0.6565 - 25s/epoch - 13ms/step
Epoch 8/50
1876/1876 - 26s - loss: 2.7827 - accuracy10: 0.4928 - val_loss: 2.6148 - val_accuracy10: 0.6442 - 26s/epoch - 14ms/step
Epoch 9/50
1876/1876 - 25s - loss: 2.7593 - accuracy10: 0.4981 - val_loss: 2.5842 - val_accuracy10: 0.6400 - 25s/epoch - 13ms/step
Epoch 10/50
1876/1876 - 24s - loss: 2.7392 - accuracy10: 0.5041 - val_loss: 2.5732 - val_accuracy10: 0.6425 - 24s/epoch - 13ms/step
Epoch 11/50
1876/1876 - 25s - loss: 2.7172 - accuracy10: 0.5095 - val_loss: 2.5626 - val_accuracy10: 0.6383 - 25s/epoch - 13ms/step
Epoch 12/50
1876/1876 - 24s - loss: 2.7003 - accuracy10: 0.5147 - val_loss: 2.5656 - val_accuracy10: 0.6386 - 24s/epoch - 13ms/step
Epoch 13/50
1876/1876 - 25s - loss: 2.6810 - accuracy10: 0.5181 - val_loss: 2.5721 - val_accuracy10: 0.6452 - 25s/epoch - 13ms/step
Epoch 14/50
1876/1876 - 25s - loss: 2.6668 - accuracy10: 0.5208 - val_loss: 2.5839 - val_accuracy10: 0.6507 - 25s/epoch - 13ms/step
Epoch 15/50
1876/1876 - 25s - loss: 2.6521 - accuracy10: 0.5242 - val_loss: 2.5116 - val_accuracy10: 0.6339 - 25s/epoch - 13ms/step
Epoch 16/50
1876/1876 - 24s - loss: 2.6394 - accuracy10: 0.5245 - val_loss: 2.5378 - val_accuracy10: 0.6566 - 24s/epoch - 13ms/step
Epoch 17/50
1876/1876 - 24s - loss: 2.6213 - accuracy10: 0.5298 - val_loss: 2.5504 - val_accuracy10: 0.6576 - 24s/epoch - 13ms/step
Epoch 18/50
1876/1876 - 25s - loss: 2.6077 - accuracy10: 0.5315 - val_loss: 2.5390 - val_accuracy10: 0.6544 - 25s/epoch - 13ms/step
Epoch 19/50
1876/1876 - 24s - loss: 2.5913 - accuracy10: 0.5355 - val_loss: 2.5277 - val_accuracy10: 0.6493 - 24s/epoch - 13ms/step
Epoch 20/50
1876/1876 - 25s - loss: 2.5787 - accuracy10: 0.5364 - val_loss: 2.5052 - val_accuracy10: 0.6415 - 25s/epoch - 13ms/step
Epoch 21/50
1876/1876 - 25s - loss: 2.5697 - accuracy10: 0.5394 - val_loss: 2.4884 - val_accuracy10: 0.6389 - 25s/epoch - 13ms/step
Epoch 22/50
1876/1876 - 24s - loss: 2.5578 - accuracy10: 0.5429 - val_loss: 2.4894 - val_accuracy10: 0.6360 - 24s/epoch - 13ms/step
Epoch 23/50
1876/1876 - 24s - loss: 2.5448 - accuracy10: 0.5440 - val_loss: 2.4916 - val_accuracy10: 0.6384 - 24s/epoch - 13ms/step
Epoch 24/50
1876/1876 - 25s - loss: 2.5336 - accuracy10: 0.5480 - val_loss: 2.4832 - val_accuracy10: 0.6340 - 25s/epoch - 13ms/step
Epoch 25/50
1876/1876 - 24s - loss: 2.5218 - accuracy10: 0.5496 - val_loss: 2.4636 - val_accuracy10: 0.6262 - 24s/epoch - 13ms/step
Epoch 26/50
1876/1876 - 24s - loss: 2.5117 - accuracy10: 0.5517 - val_loss: 2.4773 - val_accuracy10: 0.6357 - 24s/epoch - 13ms/step
Epoch 27/50
1876/1876 - 25s - loss: 2.5025 - accuracy10: 0.5544 - val_loss: 2.4652 - val_accuracy10: 0.6250 - 25s/epoch - 13ms/step
Epoch 28/50
1876/1876 - 25s - loss: 2.4914 - accuracy10: 0.5567 - val_loss: 2.5007 - val_accuracy10: 0.6309 - 25s/epoch - 13ms/step
Epoch 29/50
1876/1876 - 24s - loss: 2.4822 - accuracy10: 0.5588 - val_loss: 2.4635 - val_accuracy10: 0.6346 - 24s/epoch - 13ms/step
Epoch 30/50
1876/1876 - 24s - loss: 2.4718 - accuracy10: 0.5606 - val_loss: 2.4611 - val_accuracy10: 0.6260 - 24s/epoch - 13ms/step
Epoch 31/50
1876/1876 - 25s - loss: 2.4666 - accuracy10: 0.5616 - val_loss: 2.4706 - val_accuracy10: 0.6231 - 25s/epoch - 13ms/step
Epoch 32/50
1876/1876 - 25s - loss: 2.4551 - accuracy10: 0.5637 - val_loss: 2.4433 - val_accuracy10: 0.6142 - 25s/epoch - 13ms/step
Epoch 33/50
1876/1876 - 24s - loss: 2.4463 - accuracy10: 0.5662 - val_loss: 2.4497 - val_accuracy10: 0.6282 - 24s/epoch - 13ms/step
Epoch 34/50
1876/1876 - 25s - loss: 2.4398 - accuracy10: 0.5674 - val_loss: 2.4394 - val_accuracy10: 0.6238 - 25s/epoch - 13ms/step
Epoch 35/50
1876/1876 - 25s - loss: 2.4305 - accuracy10: 0.5698 - val_loss: 2.4365 - val_accuracy10: 0.6273 - 25s/epoch - 13ms/step
Epoch 36/50
1876/1876 - 24s - loss: 2.4222 - accuracy10: 0.5708 - val_loss: 2.4409 - val_accuracy10: 0.6201 - 24s/epoch - 13ms/step
Epoch 37/50
1876/1876 - 24s - loss: 2.4155 - accuracy10: 0.5715 - val_loss: 2.4244 - val_accuracy10: 0.6262 - 24s/epoch - 13ms/step
Epoch 38/50
1876/1876 - 24s - loss: 2.4073 - accuracy10: 0.5731 - val_loss: 2.4376 - val_accuracy10: 0.6298 - 24s/epoch - 13ms/step
Epoch 39/50
1876/1876 - 24s - loss: 2.3995 - accuracy10: 0.5740 - val_loss: 2.4375 - val_accuracy10: 0.6315 - 24s/epoch - 13ms/step
Epoch 40/50
1876/1876 - 24s - loss: 2.3922 - accuracy10: 0.5755 - val_loss: 2.4336 - val_accuracy10: 0.6248 - 24s/epoch - 13ms/step
Epoch 41/50
1876/1876 - 25s - loss: 2.3868 - accuracy10: 0.5761 - val_loss: 2.4223 - val_accuracy10: 0.6282 - 25s/epoch - 13ms/step
Epoch 42/50
1876/1876 - 25s - loss: 2.3821 - accuracy10: 0.5768 - val_loss: 2.4205 - val_accuracy10: 0.6238 - 25s/epoch - 13ms/step
Epoch 43/50
1876/1876 - 24s - loss: 2.3738 - accuracy10: 0.5784 - val_loss: 2.4313 - val_accuracy10: 0.6327 - 24s/epoch - 13ms/step
Epoch 44/50
1876/1876 - 25s - loss: 2.3698 - accuracy10: 0.5803 - val_loss: 2.4221 - val_accuracy10: 0.6265 - 25s/epoch - 13ms/step
Epoch 45/50
1876/1876 - 24s - loss: 2.3637 - accuracy10: 0.5803 - val_loss: 2.4430 - val_accuracy10: 0.6300 - 24s/epoch - 13ms/step
Epoch 46/50
1876/1876 - 24s - loss: 2.3549 - accuracy10: 0.5815 - val_loss: 2.4429 - val_accuracy10: 0.6309 - 24s/epoch - 13ms/step
Epoch 47/50
1876/1876 - 25s - loss: 2.3520 - accuracy10: 0.5826 - val_loss: 2.4365 - val_accuracy10: 0.6349 - 25s/epoch - 13ms/step
Epoch 48/50
1876/1876 - 25s - loss: 2.3412 - accuracy10: 0.5837 - val_loss: 2.4412 - val_accuracy10: 0.6209 - 25s/epoch - 13ms/step
Epoch 49/50
1876/1876 - 24s - loss: 2.3343 - accuracy10: 0.5850 - val_loss: 2.4368 - val_accuracy10: 0.6146 - 24s/epoch - 13ms/step
Epoch 50/50
1876/1876 - 25s - loss: 2.3282 - accuracy10: 0.5856 - val_loss: 2.4375 - val_accuracy10: 0.6217 - 25s/epoch - 13ms/step
testing model: results/EXC/W3/deepOF_L1/h10
Evaluating performance on  test set...
5098/5098 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8084172
{'0': {'precision': 0.28757185486557557, 'recall': 0.5294639652866138, 'f1-score': 0.37271054910075535, 'support': 153255}, '1': {'precision': 0.8738386619573757, 'recall': 0.6175452216287489, 'f1-score': 0.7236700035522062, 'support': 999577}, '2': {'precision': 0.2643581508269688, 'recall': 0.5498997205326319, 'f1-score': 0.35706249426251735, 'support': 152075}, 'accuracy': 0.5993170394518537, 'macro avg': {'precision': 0.4752562225499733, 'recall': 0.5656363024826648, 'f1-score': 0.48448101563849294, 'support': 1304907}, 'weighted avg': {'precision': 0.7339550777241618, 'recall': 0.5993170394518537, 'f1-score': 0.6397267584265487, 'support': 1304907}}
[[ 81143  43869  28243]
 [177826 617284 204467]
 [ 23197  45252  83626]]
Evaluating performance on  train set...
1876/1876 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7673432
{'0': {'precision': 0.2938444370721115, 'recall': 0.5167238270339073, 'f1-score': 0.37464191185423973, 'support': 56566}, '1': {'precision': 0.8745524872481933, 'recall': 0.6473771925031419, 'f1-score': 0.7440098467412497, 'support': 366020}, '2': {'precision': 0.2975535558146313, 'recall': 0.5669831132091845, 'f1-score': 0.3902849872469551, 'support': 57619}, 'accuracy': 0.6223404587624035, 'macro avg': {'precision': 0.4886501600449787, 'recall': 0.5770280442487445, 'f1-score': 0.5029789152808148, 'support': 480205}, 'weighted avg': {'precision': 0.7369145347143157, 'recall': 0.6223404587624035, 'f1-score': 0.658057098885604, 'support': 480205}}
[[ 29229  17531   9806]
 [ 61750 236953  67317]
 [  8492  16458  32669]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7560751
{'0': {'precision': 0.2787680404701681, 'recall': 0.5694140530026744, 'f1-score': 0.37429330563158003, 'support': 16452}, '1': {'precision': 0.9028722772729348, 'recall': 0.6322032949903676, 'f1-score': 0.7436752156844308, 'support': 125099}, '2': {'precision': 0.28099862796265906, 'recall': 0.6209500029724749, 'f1-score': 0.3869091717291451, 'support': 16821}, 'accuracy': 0.6244853888313591, 'macro avg': {'precision': 0.487546315235254, 'recall': 0.6075224503218389, 'f1-score': 0.5016258976817186, 'support': 158372}, 'weighted avg': {'precision': 0.7719886642673072, 'recall': 0.6244853888313591, 'f1-score': 0.6674102647489033, 'support': 158372}}
[[ 9368  4427  2657]
 [21942 79088 24069]
 [ 2295  4081 10445]]
training model: results/EXC/W3/deepOF_L1/h20
Epoch 1/50
1876/1876 - 27s - loss: 3.0972 - accuracy20: 0.4120 - val_loss: 2.9106 - val_accuracy20: 0.6057 - 27s/epoch - 14ms/step
Epoch 2/50
1876/1876 - 25s - loss: 3.0119 - accuracy20: 0.4423 - val_loss: 2.8178 - val_accuracy20: 0.5774 - 25s/epoch - 13ms/step
Epoch 3/50
1876/1876 - 25s - loss: 2.9555 - accuracy20: 0.4537 - val_loss: 2.7873 - val_accuracy20: 0.5989 - 25s/epoch - 13ms/step
Epoch 4/50
1876/1876 - 25s - loss: 2.9152 - accuracy20: 0.4646 - val_loss: 2.7518 - val_accuracy20: 0.6010 - 25s/epoch - 13ms/step
Epoch 5/50
1876/1876 - 25s - loss: 2.8804 - accuracy20: 0.4746 - val_loss: 2.7155 - val_accuracy20: 0.5995 - 25s/epoch - 13ms/step
Epoch 6/50
1876/1876 - 25s - loss: 2.8522 - accuracy20: 0.4811 - val_loss: 2.7200 - val_accuracy20: 0.5984 - 25s/epoch - 13ms/step
Epoch 7/50
1876/1876 - 25s - loss: 2.8223 - accuracy20: 0.4946 - val_loss: 2.7246 - val_accuracy20: 0.6302 - 25s/epoch - 13ms/step
Epoch 8/50
1876/1876 - 24s - loss: 2.7948 - accuracy20: 0.5056 - val_loss: 2.7167 - val_accuracy20: 0.6300 - 24s/epoch - 13ms/step
Epoch 9/50
1876/1876 - 25s - loss: 2.7725 - accuracy20: 0.5107 - val_loss: 2.6212 - val_accuracy20: 0.6159 - 25s/epoch - 13ms/step
Epoch 10/50
1876/1876 - 25s - loss: 2.7453 - accuracy20: 0.5189 - val_loss: 2.6130 - val_accuracy20: 0.6077 - 25s/epoch - 13ms/step
Epoch 11/50
1876/1876 - 24s - loss: 2.7243 - accuracy20: 0.5241 - val_loss: 2.5910 - val_accuracy20: 0.6180 - 24s/epoch - 13ms/step
Epoch 12/50
1876/1876 - 24s - loss: 2.7038 - accuracy20: 0.5273 - val_loss: 2.5747 - val_accuracy20: 0.6204 - 24s/epoch - 13ms/step
Epoch 13/50
1876/1876 - 24s - loss: 2.6853 - accuracy20: 0.5308 - val_loss: 2.5703 - val_accuracy20: 0.6267 - 24s/epoch - 13ms/step
Epoch 14/50
1876/1876 - 26s - loss: 2.6654 - accuracy20: 0.5352 - val_loss: 2.5619 - val_accuracy20: 0.6142 - 26s/epoch - 14ms/step
Epoch 15/50
1876/1876 - 25s - loss: 2.6517 - accuracy20: 0.5388 - val_loss: 2.5671 - val_accuracy20: 0.6146 - 25s/epoch - 13ms/step
Epoch 16/50
1876/1876 - 25s - loss: 2.6381 - accuracy20: 0.5418 - val_loss: 2.5536 - val_accuracy20: 0.6135 - 25s/epoch - 13ms/step
Epoch 17/50
1876/1876 - 25s - loss: 2.6237 - accuracy20: 0.5451 - val_loss: 2.5478 - val_accuracy20: 0.6105 - 25s/epoch - 13ms/step
Epoch 18/50
1876/1876 - 25s - loss: 2.6121 - accuracy20: 0.5468 - val_loss: 2.5351 - val_accuracy20: 0.6117 - 25s/epoch - 13ms/step
Epoch 19/50
1876/1876 - 25s - loss: 2.5992 - accuracy20: 0.5498 - val_loss: 2.5434 - val_accuracy20: 0.6083 - 25s/epoch - 13ms/step
Epoch 20/50
1876/1876 - 24s - loss: 2.5861 - accuracy20: 0.5531 - val_loss: 2.5339 - val_accuracy20: 0.6103 - 24s/epoch - 13ms/step
Epoch 21/50
1876/1876 - 25s - loss: 2.5752 - accuracy20: 0.5555 - val_loss: 2.5275 - val_accuracy20: 0.6063 - 25s/epoch - 13ms/step
Epoch 22/50
1876/1876 - 25s - loss: 2.5648 - accuracy20: 0.5570 - val_loss: 2.5349 - val_accuracy20: 0.5998 - 25s/epoch - 13ms/step
Epoch 23/50
1876/1876 - 24s - loss: 2.5527 - accuracy20: 0.5604 - val_loss: 2.5273 - val_accuracy20: 0.6106 - 24s/epoch - 13ms/step
Epoch 24/50
1876/1876 - 25s - loss: 2.5431 - accuracy20: 0.5617 - val_loss: 2.5102 - val_accuracy20: 0.5977 - 25s/epoch - 13ms/step
Epoch 25/50
1876/1876 - 24s - loss: 2.5340 - accuracy20: 0.5650 - val_loss: 2.5289 - val_accuracy20: 0.6020 - 24s/epoch - 13ms/step
Epoch 26/50
1876/1876 - 25s - loss: 2.5230 - accuracy20: 0.5666 - val_loss: 2.5251 - val_accuracy20: 0.6016 - 25s/epoch - 13ms/step
Epoch 27/50
1876/1876 - 24s - loss: 2.5148 - accuracy20: 0.5685 - val_loss: 2.5201 - val_accuracy20: 0.6037 - 24s/epoch - 13ms/step
Epoch 28/50
1876/1876 - 24s - loss: 2.5058 - accuracy20: 0.5697 - val_loss: 2.5148 - val_accuracy20: 0.5964 - 24s/epoch - 13ms/step
Epoch 29/50
1876/1876 - 25s - loss: 2.4969 - accuracy20: 0.5718 - val_loss: 2.5031 - val_accuracy20: 0.5944 - 25s/epoch - 13ms/step
Epoch 30/50
1876/1876 - 25s - loss: 2.4879 - accuracy20: 0.5739 - val_loss: 2.5045 - val_accuracy20: 0.6026 - 25s/epoch - 13ms/step
Epoch 31/50
1876/1876 - 25s - loss: 2.4810 - accuracy20: 0.5748 - val_loss: 2.5155 - val_accuracy20: 0.6047 - 25s/epoch - 13ms/step
Epoch 32/50
1876/1876 - 25s - loss: 2.4746 - accuracy20: 0.5763 - val_loss: 2.4910 - val_accuracy20: 0.5970 - 25s/epoch - 13ms/step
Epoch 33/50
1876/1876 - 25s - loss: 2.4630 - accuracy20: 0.5783 - val_loss: 2.4977 - val_accuracy20: 0.5988 - 25s/epoch - 14ms/step
Epoch 34/50
1876/1876 - 25s - loss: 2.4541 - accuracy20: 0.5800 - val_loss: 2.4947 - val_accuracy20: 0.6012 - 25s/epoch - 13ms/step
Epoch 35/50
1876/1876 - 25s - loss: 2.4482 - accuracy20: 0.5807 - val_loss: 2.5134 - val_accuracy20: 0.5954 - 25s/epoch - 13ms/step
Epoch 36/50
1876/1876 - 25s - loss: 2.4406 - accuracy20: 0.5821 - val_loss: 2.4997 - val_accuracy20: 0.6031 - 25s/epoch - 13ms/step
Epoch 37/50
1876/1876 - 24s - loss: 2.4356 - accuracy20: 0.5832 - val_loss: 2.5208 - val_accuracy20: 0.5992 - 24s/epoch - 13ms/step
Epoch 38/50
1876/1876 - 26s - loss: 2.4261 - accuracy20: 0.5847 - val_loss: 2.5099 - val_accuracy20: 0.5962 - 26s/epoch - 14ms/step
Epoch 39/50
1876/1876 - 25s - loss: 2.4205 - accuracy20: 0.5859 - val_loss: 2.5129 - val_accuracy20: 0.6071 - 25s/epoch - 13ms/step
Epoch 40/50
1876/1876 - 25s - loss: 2.4124 - accuracy20: 0.5876 - val_loss: 2.5146 - val_accuracy20: 0.6012 - 25s/epoch - 13ms/step
Epoch 41/50
1876/1876 - 25s - loss: 2.4068 - accuracy20: 0.5878 - val_loss: 2.5321 - val_accuracy20: 0.6003 - 25s/epoch - 13ms/step
Epoch 42/50
1876/1876 - 24s - loss: 2.4007 - accuracy20: 0.5890 - val_loss: 2.5342 - val_accuracy20: 0.6098 - 24s/epoch - 13ms/step
testing model: results/EXC/W3/deepOF_L1/h20
Evaluating performance on  test set...
5098/5098 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8725279
{'0': {'precision': 0.3620343541389854, 'recall': 0.5379473736792277, 'f1-score': 0.43279863128523693, 'support': 210199}, '1': {'precision': 0.8241066890126362, 'recall': 0.5718598537053169, 'f1-score': 0.675193160000479, 'support': 887387}, '2': {'precision': 0.32664987619459607, 'recall': 0.5936784020914427, 'f1-score': 0.42142566107765156, 'support': 207321}, 'accuracy': 0.5698635994749051, 'macro avg': {'precision': 0.5042636397820726, 'recall': 0.5678285431586624, 'f1-score': 0.5098058174544559, 'support': 1304907}, 'weighted avg': {'precision': 0.6706395173227337, 'recall': 0.5698635994749051, 'f1-score': 0.595829328566059, 'support': 1304907}}
[[113076  56631  40492]
 [166699 507461 213227]
 [ 32560  51679 123082]]
Evaluating performance on  train set...
1876/1876 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83140165
{'0': {'precision': 0.3651997157838878, 'recall': 0.5282508293761791, 'f1-score': 0.4318471879520122, 'support': 76865}, '1': {'precision': 0.8239995026009823, 'recall': 0.6124276032039433, 'f1-score': 0.7026322997941168, 'support': 324600}, '2': {'precision': 0.3619792278131286, 'recall': 0.5873634747269495, 'f1-score': 0.447917019762042, 'support': 78740}, 'accuracy': 0.5948438687643819, 'macro avg': {'precision': 0.5170594820659996, 'recall': 0.5760139691023572, 'f1-score': 0.5274655025027237, 'support': 480205}, 'weighted avg': {'precision': 0.6748025511937882, 'recall': 0.5948438687643819, 'f1-score': 0.6175224430215531, 'support': 480205}}
[[ 40604  22253  14008]
 [ 58296 198794  67510]
 [ 12283  20208  46249]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82023025
{'0': {'precision': 0.35594497833050687, 'recall': 0.5748130759867849, 'f1-score': 0.4396455704619886, 'support': 23004}, '1': {'precision': 0.8540792420770795, 'recall': 0.59362977543169, 'f1-score': 0.7004264842496409, 'support': 111770}, '2': {'precision': 0.34618829960723063, 'recall': 0.638698194762268, 'f1-score': 0.4490057347136367, 'support': 23598}, 'accuracy': 0.5976119516076074, 'macro avg': {'precision': 0.5187375066716057, 'recall': 0.6023803487269143, 'f1-score': 0.5296925964750887, 'support': 158372}, 'weighted avg': {'precision': 0.7060461865898113, 'recall': 0.5976119516076074, 'f1-score': 0.6250846877936904, 'support': 158372}}
[[13223  6042  3739]
 [20694 66350 24726]
 [ 3232  5294 15072]]
training model: results/EXC/W3/deepOF_L1/h30
Epoch 1/50
1876/1876 - 28s - loss: 3.1201 - accuracy30: 0.4197 - val_loss: 2.9976 - val_accuracy30: 0.5748 - 28s/epoch - 15ms/step
Epoch 2/50
1876/1876 - 25s - loss: 3.0365 - accuracy30: 0.4439 - val_loss: 2.9071 - val_accuracy30: 0.5677 - 25s/epoch - 14ms/step
Epoch 3/50
1876/1876 - 26s - loss: 2.9849 - accuracy30: 0.4559 - val_loss: 2.8755 - val_accuracy30: 0.5718 - 26s/epoch - 14ms/step
Epoch 4/50
1876/1876 - 25s - loss: 2.9464 - accuracy30: 0.4654 - val_loss: 2.8459 - val_accuracy30: 0.5822 - 25s/epoch - 13ms/step
Epoch 5/50
1876/1876 - 25s - loss: 2.9208 - accuracy30: 0.4708 - val_loss: 2.8238 - val_accuracy30: 0.5831 - 25s/epoch - 13ms/step
Epoch 6/50
1876/1876 - 25s - loss: 2.8980 - accuracy30: 0.4799 - val_loss: 2.8038 - val_accuracy30: 0.5816 - 25s/epoch - 13ms/step
Epoch 7/50
1876/1876 - 24s - loss: 2.8742 - accuracy30: 0.4873 - val_loss: 2.7933 - val_accuracy30: 0.5895 - 24s/epoch - 13ms/step
Epoch 8/50
1876/1876 - 25s - loss: 2.8553 - accuracy30: 0.4962 - val_loss: 2.8018 - val_accuracy30: 0.5971 - 25s/epoch - 13ms/step
Epoch 9/50
1876/1876 - 25s - loss: 2.8416 - accuracy30: 0.5004 - val_loss: 2.7887 - val_accuracy30: 0.6035 - 25s/epoch - 13ms/step
Epoch 10/50
1876/1876 - 25s - loss: 2.8228 - accuracy30: 0.5070 - val_loss: 2.7710 - val_accuracy30: 0.5956 - 25s/epoch - 13ms/step
Epoch 11/50
1876/1876 - 25s - loss: 2.7998 - accuracy30: 0.5139 - val_loss: 2.7469 - val_accuracy30: 0.5970 - 25s/epoch - 14ms/step
Epoch 12/50
1876/1876 - 24s - loss: 2.7849 - accuracy30: 0.5196 - val_loss: 2.7352 - val_accuracy30: 0.6021 - 24s/epoch - 13ms/step
Epoch 13/50
1876/1876 - 25s - loss: 2.7660 - accuracy30: 0.5237 - val_loss: 2.7283 - val_accuracy30: 0.6121 - 25s/epoch - 13ms/step
Epoch 14/50
1876/1876 - 25s - loss: 2.7544 - accuracy30: 0.5258 - val_loss: 2.7228 - val_accuracy30: 0.5929 - 25s/epoch - 13ms/step
Epoch 15/50
1876/1876 - 25s - loss: 2.7404 - accuracy30: 0.5290 - val_loss: 2.6952 - val_accuracy30: 0.6036 - 25s/epoch - 13ms/step
Epoch 16/50
1876/1876 - 25s - loss: 2.7245 - accuracy30: 0.5321 - val_loss: 2.7063 - val_accuracy30: 0.5942 - 25s/epoch - 13ms/step
Epoch 17/50
1876/1876 - 24s - loss: 2.7142 - accuracy30: 0.5341 - val_loss: 2.6968 - val_accuracy30: 0.6020 - 24s/epoch - 13ms/step
Epoch 18/50
1876/1876 - 25s - loss: 2.7031 - accuracy30: 0.5364 - val_loss: 2.6917 - val_accuracy30: 0.6044 - 25s/epoch - 13ms/step
Epoch 19/50
1876/1876 - 25s - loss: 2.6917 - accuracy30: 0.5387 - val_loss: 2.6866 - val_accuracy30: 0.6003 - 25s/epoch - 13ms/step
Epoch 20/50
1876/1876 - 25s - loss: 2.6840 - accuracy30: 0.5397 - val_loss: 2.6753 - val_accuracy30: 0.5966 - 25s/epoch - 13ms/step
Epoch 21/50
1876/1876 - 24s - loss: 2.6720 - accuracy30: 0.5430 - val_loss: 2.6782 - val_accuracy30: 0.5926 - 24s/epoch - 13ms/step
Epoch 22/50
1876/1876 - 24s - loss: 2.6640 - accuracy30: 0.5445 - val_loss: 2.6638 - val_accuracy30: 0.5911 - 24s/epoch - 13ms/step
Epoch 23/50
1876/1876 - 25s - loss: 2.6529 - accuracy30: 0.5475 - val_loss: 2.6896 - val_accuracy30: 0.5951 - 25s/epoch - 13ms/step
Epoch 24/50
1876/1876 - 24s - loss: 2.6450 - accuracy30: 0.5490 - val_loss: 2.6652 - val_accuracy30: 0.5936 - 24s/epoch - 13ms/step
Epoch 25/50
1876/1876 - 25s - loss: 2.6380 - accuracy30: 0.5512 - val_loss: 2.6674 - val_accuracy30: 0.5918 - 25s/epoch - 13ms/step
Epoch 26/50
1876/1876 - 25s - loss: 2.6286 - accuracy30: 0.5529 - val_loss: 2.6565 - val_accuracy30: 0.5909 - 25s/epoch - 14ms/step
Epoch 27/50
1876/1876 - 25s - loss: 2.6172 - accuracy30: 0.5564 - val_loss: 2.6579 - val_accuracy30: 0.5936 - 25s/epoch - 14ms/step
Epoch 28/50
1876/1876 - 25s - loss: 2.6135 - accuracy30: 0.5559 - val_loss: 2.6531 - val_accuracy30: 0.5870 - 25s/epoch - 13ms/step
Epoch 29/50
1876/1876 - 25s - loss: 2.6019 - accuracy30: 0.5583 - val_loss: 2.6570 - val_accuracy30: 0.5827 - 25s/epoch - 13ms/step
Epoch 30/50
1876/1876 - 25s - loss: 2.5926 - accuracy30: 0.5604 - val_loss: 2.6465 - val_accuracy30: 0.5818 - 25s/epoch - 13ms/step
Epoch 31/50
1876/1876 - 25s - loss: 2.5883 - accuracy30: 0.5618 - val_loss: 2.6421 - val_accuracy30: 0.5851 - 25s/epoch - 13ms/step
Epoch 32/50
1876/1876 - 25s - loss: 2.5793 - accuracy30: 0.5644 - val_loss: 2.6616 - val_accuracy30: 0.5900 - 25s/epoch - 13ms/step
Epoch 33/50
1876/1876 - 25s - loss: 2.5740 - accuracy30: 0.5656 - val_loss: 2.6417 - val_accuracy30: 0.5847 - 25s/epoch - 13ms/step
Epoch 34/50
1876/1876 - 25s - loss: 2.5662 - accuracy30: 0.5664 - val_loss: 2.6360 - val_accuracy30: 0.5803 - 25s/epoch - 13ms/step
Epoch 35/50
1876/1876 - 25s - loss: 2.5619 - accuracy30: 0.5679 - val_loss: 2.6491 - val_accuracy30: 0.5871 - 25s/epoch - 13ms/step
Epoch 36/50
1876/1876 - 25s - loss: 2.5568 - accuracy30: 0.5687 - val_loss: 2.6496 - val_accuracy30: 0.5803 - 25s/epoch - 13ms/step
Epoch 37/50
1876/1876 - 24s - loss: 2.5445 - accuracy30: 0.5710 - val_loss: 2.6496 - val_accuracy30: 0.5841 - 24s/epoch - 13ms/step
Epoch 38/50
1876/1876 - 25s - loss: 2.5381 - accuracy30: 0.5730 - val_loss: 2.6404 - val_accuracy30: 0.5757 - 25s/epoch - 13ms/step
Epoch 39/50
1876/1876 - 25s - loss: 2.5307 - accuracy30: 0.5737 - val_loss: 2.6457 - val_accuracy30: 0.5814 - 25s/epoch - 13ms/step
Epoch 40/50
1876/1876 - 26s - loss: 2.5232 - accuracy30: 0.5758 - val_loss: 2.6456 - val_accuracy30: 0.5807 - 26s/epoch - 14ms/step
Epoch 41/50
1876/1876 - 25s - loss: 2.5163 - accuracy30: 0.5763 - val_loss: 2.6587 - val_accuracy30: 0.5804 - 25s/epoch - 13ms/step
Epoch 42/50
1876/1876 - 25s - loss: 2.5116 - accuracy30: 0.5779 - val_loss: 2.6437 - val_accuracy30: 0.5806 - 25s/epoch - 13ms/step
Epoch 43/50
1876/1876 - 24s - loss: 2.5037 - accuracy30: 0.5794 - val_loss: 2.6492 - val_accuracy30: 0.5814 - 24s/epoch - 13ms/step
Epoch 44/50
1876/1876 - 25s - loss: 2.4989 - accuracy30: 0.5806 - val_loss: 2.6423 - val_accuracy30: 0.5802 - 25s/epoch - 13ms/step
testing model: results/EXC/W3/deepOF_L1/h30
Evaluating performance on  test set...
5098/5098 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90733296
{'0': {'precision': 0.3969561631471655, 'recall': 0.5058058375634518, 'f1-score': 0.44481877708316986, 'support': 252160}, '1': {'precision': 0.7534904208301783, 'recall': 0.5675200145130848, 'f1-score': 0.6474148623268011, 'support': 804791}, '2': {'precision': 0.362592497410205, 'recall': 0.5519446998661053, 'f1-score': 0.43766619390181305, 'support': 247956}, 'accuracy': 0.5526347854674701, 'macro avg': {'precision': 0.5043463604625162, 'recall': 0.5417568506475473, 'f1-score': 0.5099666111039279, 'support': 1304907}, 'weighted avg': {'precision': 0.6103161073221112, 'recall': 0.5526347854674701, 'f1-score': 0.5684091786397488, 'support': 1304907}}
[[127544  75034  49582]
 [157053 456735 191003]
 [ 36708  74390 136858]]
Evaluating performance on  train set...
1876/1876 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86529857
{'0': {'precision': 0.39913001870459786, 'recall': 0.5017663206938414, 'f1-score': 0.44460165327699663, 'support': 91433}, '1': {'precision': 0.7578821779807341, 'recall': 0.6114664361855373, 'f1-score': 0.6768466548608818, 'support': 295035}, '2': {'precision': 0.4055084379396807, 'recall': 0.5503696512583078, 'f1-score': 0.46696234612599563, 'support': 93737}, 'accuracy': 0.5786528670047167, 'macro avg': {'precision': 0.5208402115416709, 'recall': 0.5545341360458955, 'f1-score': 0.5294702180879579, 'support': 480205}, 'weighted avg': {'precision': 0.6207902204848247, 'recall': 0.5786528670047167, 'f1-score': 0.5916564076170976, 'support': 480205}}
[[ 45878  29357  16198]
 [ 55196 180404  59435]
 [ 13871  28276  51590]]
Evaluating performance on  val set...
619/619 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86009264
{'0': {'precision': 0.3891309452372877, 'recall': 0.5336505778382054, 'f1-score': 0.450073931017834, 'support': 27949}, '1': {'precision': 0.7867187397612152, 'recall': 0.59042982197305, 'f1-score': 0.674585470829845, 'support': 101670}, '2': {'precision': 0.38799725651577505, 'recall': 0.5902340625326052, 'f1-score': 0.4682107237940215, 'support': 28753}, 'accuracy': 0.5803740560200036, 'macro avg': {'precision': 0.5212823138380926, 'recall': 0.5714381541146202, 'f1-score': 0.5309567085472335, 'support': 158372}, 'weighted avg': {'precision': 0.6441643736049162, 'recall': 0.5803740560200036, 'f1-score': 0.5974963002206026, 'support': 158372}}
[[14915  8342  4692]
 [19564 60029 22077]
 [ 3850  7932 16971]]
training model: results/EXC/W3/deepOF_L1/h50
Epoch 1/50
1876/1876 - 29s - loss: 3.1661 - accuracy50: 0.4210 - val_loss: 3.1440 - val_accuracy50: 0.5200 - 29s/epoch - 15ms/step
Epoch 2/50
1876/1876 - 25s - loss: 3.0950 - accuracy50: 0.4365 - val_loss: 3.0384 - val_accuracy50: 0.5186 - 25s/epoch - 14ms/step
Epoch 3/50
1876/1876 - 25s - loss: 3.0568 - accuracy50: 0.4437 - val_loss: 2.9967 - val_accuracy50: 0.5148 - 25s/epoch - 13ms/step
Epoch 4/50
1876/1876 - 25s - loss: 3.0285 - accuracy50: 0.4511 - val_loss: 2.9716 - val_accuracy50: 0.5223 - 25s/epoch - 13ms/step
Epoch 5/50
1876/1876 - 25s - loss: 3.0092 - accuracy50: 0.4576 - val_loss: 2.9585 - val_accuracy50: 0.5291 - 25s/epoch - 14ms/step
Epoch 6/50
1876/1876 - 24s - loss: 2.9928 - accuracy50: 0.4636 - val_loss: 2.9500 - val_accuracy50: 0.5355 - 24s/epoch - 13ms/step
Epoch 7/50
1876/1876 - 25s - loss: 2.9807 - accuracy50: 0.4706 - val_loss: 2.9417 - val_accuracy50: 0.5419 - 25s/epoch - 13ms/step
Epoch 8/50
1876/1876 - 25s - loss: 2.9653 - accuracy50: 0.4772 - val_loss: 2.9346 - val_accuracy50: 0.5407 - 25s/epoch - 13ms/step
Epoch 9/50
1876/1876 - 25s - loss: 2.9532 - accuracy50: 0.4818 - val_loss: 2.9299 - val_accuracy50: 0.5479 - 25s/epoch - 13ms/step
Epoch 10/50
1876/1876 - 24s - loss: 2.9390 - accuracy50: 0.4864 - val_loss: 2.9227 - val_accuracy50: 0.5537 - 24s/epoch - 13ms/step
Epoch 11/50
1876/1876 - 25s - loss: 2.9263 - accuracy50: 0.4912 - val_loss: 2.9171 - val_accuracy50: 0.5543 - 25s/epoch - 13ms/step
Epoch 12/50
1876/1876 - 24s - loss: 2.9139 - accuracy50: 0.4962 - val_loss: 2.9034 - val_accuracy50: 0.5551 - 24s/epoch - 13ms/step
Epoch 13/50
1876/1876 - 25s - loss: 2.9012 - accuracy50: 0.5007 - val_loss: 2.9039 - val_accuracy50: 0.5575 - 25s/epoch - 13ms/step
Epoch 14/50
1876/1876 - 24s - loss: 2.8891 - accuracy50: 0.5049 - val_loss: 2.9018 - val_accuracy50: 0.5573 - 24s/epoch - 13ms/step
Epoch 15/50
1876/1876 - 25s - loss: 2.8785 - accuracy50: 0.5081 - val_loss: 2.8985 - val_accuracy50: 0.5576 - 25s/epoch - 13ms/step
Epoch 16/50
1876/1876 - 24s - loss: 2.8650 - accuracy50: 0.5120 - val_loss: 2.8852 - val_accuracy50: 0.5605 - 24s/epoch - 13ms/step
Epoch 17/50
1876/1876 - 25s - loss: 2.8575 - accuracy50: 0.5139 - val_loss: 2.8952 - val_accuracy50: 0.5595 - 25s/epoch - 13ms/step
Epoch 18/50
1876/1876 - 24s - loss: 2.8462 - accuracy50: 0.5163 - val_loss: 2.8996 - val_accuracy50: 0.5588 - 24s/epoch - 13ms/step
Epoch 19/50
1876/1876 - 24s - loss: 2.8356 - accuracy50: 0.5184 - val_loss: 2.8936 - val_accuracy50: 0.5571 - 24s/epoch - 13ms/step
Epoch 20/50
1876/1876 - 25s - loss: 2.8252 - accuracy50: 0.5211 - val_loss: 2.8972 - val_accuracy50: 0.5566 - 25s/epoch - 13ms/step
Epoch 21/50
1876/1876 - 25s - loss: 2.8159 - accuracy50: 0.5234 - val_loss: 2.8836 - val_accuracy50: 0.5572 - 25s/epoch - 13ms/step
Epoch 22/50
1876/1876 - 25s - loss: 2.8082 - accuracy50: 0.5246 - val_loss: 2.8726 - val_accuracy50: 0.5571 - 25s/epoch - 13ms/step
Epoch 23/50
1876/1876 - 25s - loss: 2.7998 - accuracy50: 0.5277 - val_loss: 2.8786 - val_accuracy50: 0.5562 - 25s/epoch - 13ms/step
Epoch 24/50
1876/1876 - 25s - loss: 2.7904 - accuracy50: 0.5286 - val_loss: 2.8740 - val_accuracy50: 0.5560 - 25s/epoch - 14ms/step
Epoch 25/50
1876/1876 - 24s - loss: 2.7832 - accuracy50: 0.5305 - val_loss: 2.8835 - val_accuracy50: 0.5575 - 24s/epoch - 13ms/step
Epoch 26/50
1876/1876 - 24s - loss: 2.7751 - accuracy50: 0.5332 - val_loss: 2.8793 - val_accuracy50: 0.5553 - 24s/epoch - 13ms/step
Epoch 27/50
1876/1876 - 24s - loss: 2.7641 - accuracy50: 0.5350 - val_loss: 2.8983 - val_accuracy50: 0.5567 - 24s/epoch - 13ms/step
Epoch 28/50
1876/1876 - 24s - loss: 2.7584 - accuracy50: 0.5354 - val_loss: 2.8817 - val_accuracy50: 0.5528 - 24s/epoch - 13ms/step
Epoch 29/50
1876/1876 - 25s - loss: 2.7503 - accuracy50: 0.5378 - val_loss: 2.8751 - val_accuracy50: 0.5523 - 25s/epoch - 13ms/step
Epoch 30/50
1876/1876 - 25s - loss: 2.7430 - accuracy50: 0.5397 - val_loss: 2.8769 - val_accuracy50: 0.5541 - 25s/epoch - 13ms/step
Epoch 31/50
1876/1876 - 25s - loss: 2.7356 - accuracy50: 0.5410 - val_loss: 2.8716 - val_accuracy50: 0.5519 - 25s/epoch - 13ms/step
Epoch 32/50
1876/1876 - 25s - loss: 2.7299 - accuracy50: 0.5423 - val_loss: 2.8718 - val_accuracy50: 0.5503 - 25s/epoch - 13ms/step
Epoch 33/50
1876/1876 - 24s - loss: 2.7211 - accuracy50: 0.5446 - val_loss: 2.8802 - val_accuracy50: 0.5485 - 24s/epoch - 13ms/step
Epoch 34/50
1876/1876 - 24s - loss: 2.7158 - accuracy50: 0.5455 - val_loss: 2.8754 - val_accuracy50: 0.5488 - 24s/epoch - 13ms/step
Epoch 35/50
1876/1876 - 26s - loss: 2.7091 - accuracy50: 0.5472 - val_loss: 2.8659 - val_accuracy50: 0.5446 - 26s/epoch - 14ms/step
Epoch 36/50
1876/1876 - 24s - loss: 2.7027 - accuracy50: 0.5486 - val_loss: 2.8671 - val_accuracy50: 0.5490 - 24s/epoch - 13ms/step
Epoch 37/50
1876/1876 - 25s - loss: 2.6920 - accuracy50: 0.5506 - val_loss: 2.8674 - val_accuracy50: 0.5467 - 25s/epoch - 13ms/step
Epoch 38/50
1876/1876 - 25s - loss: 2.6884 - accuracy50: 0.5516 - val_loss: 2.8857 - val_accuracy50: 0.5468 - 25s/epoch - 14ms/step
Epoch 39/50
1876/1876 - 25s - loss: 2.6822 - accuracy50: 0.5524 - val_loss: 2.8671 - val_accuracy50: 0.5427 - 25s/epoch - 13ms/step
Epoch 40/50
1876/1876 - 25s - loss: 2.6748 - accuracy50: 0.5544 - val_loss: 2.8759 - val_accuracy50: 0.5453 - 25s/epoch - 13ms/step
Epoch 41/50
1876/1876 - 24s - loss: 2.6700 - accuracy50: 0.5553 - val_loss: 2.8775 - val_accuracy50: 0.5427 - 24s/epoch - 13ms/step
Epoch 42/50
1876/1876 - 24s - loss: 2.6622 - accuracy50: 0.5567 - val_loss: 2.8910 - val_accuracy50: 0.5435 - 24s/epoch - 13ms/step
Epoch 43/50
1876/1876 - 24s - loss: 2.6561 - accuracy50: 0.5585 - val_loss: 2.8825 - val_accuracy50: 0.5388 - 24s/epoch - 13ms/step
Epoch 44/50
1876/1876 - 25s - loss: 2.6489 - accuracy50: 0.5599 - val_loss: 2.8868 - val_accuracy50: 0.5426 - 25s/epoch - 13ms/step
Epoch 45/50
1876/1876 - 26s - loss: 2.6437 - accuracy50: 0.5606 - val_loss: 2.9175 - val_accuracy50: 0.5420 - 26s/epoch - 14ms/step
testing model: results/EXC/W3/deepOF_L1/h50
Evaluating performance on  test set...
5098/5098 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97058547
{'0': {'precision': 0.42778016852450823, 'recall': 0.4848164475112567, 'f1-score': 0.4545159558463472, 'support': 317811}, '1': {'precision': 0.6362557283449778, 'recall': 0.5645564594974136, 'f1-score': 0.5982655488778812, 'support': 675068}, '2': {'precision': 0.40510287018369984, 'recall': 0.44885394900457654, 'f1-score': 0.42585765216531996, 'support': 312028}, 'accuracy': 0.5174690610135435, 'macro avg': {'precision': 0.48971292235106195, 'recall': 0.4994089520044156, 'f1-score': 0.4928797189631828, 'support': 1304907}, 'weighted avg': {'precision': 0.5302083317347592, 'recall': 0.5174690610135435, 'f1-score': 0.5220292400019445, 'support': 1304907}}
[[154080 103112  60619]
 [148901 381114 145053]
 [ 57204 114769 140055]]
Evaluating performance on  train set...
1876/1876 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92153424
{'0': {'precision': 0.4462018073477763, 'recall': 0.4944508094209426, 'f1-score': 0.46908888759821776, 'support': 114341}, '1': {'precision': 0.6512566501559347, 'recall': 0.6126536149172025, 'f1-score': 0.6313656150799806, 'support': 249162}, '2': {'precision': 0.4612911079953319, 'recall': 0.4707974156398348, 'f1-score': 0.46599578472407754, 'support': 116702}, 'accuracy': 0.5500338397142887, 'macro avg': {'precision': 0.519583188499681, 'recall': 0.5259672799926599, 'f1-score': 0.5221500958007587, 'support': 480205}, 'weighted avg': {'precision': 0.5562648560622574, 'recall': 0.5500338397142887, 'f1-score': 0.5525370455332519, 'support': 480205}}
[[ 56536  39510  18295]
 [ 50643 152650  45869]
 [ 19526  42233  54943]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9274858
{'0': {'precision': 0.43065101183657883, 'recall': 0.5015006669630947, 'f1-score': 0.4633833196384552, 'support': 35984}, '1': {'precision': 0.6698576108028611, 'recall': 0.5862625789843201, 'f1-score': 0.6252784624504696, 'support': 85460}, '2': {'precision': 0.436181700381542, 'recall': 0.49222811958405543, 'f1-score': 0.4625131995776135, 'support': 36928}, 'accuracy': 0.5450774126739575, 'macro avg': {'precision': 0.5122301076736607, 'recall': 0.52666378851049, 'f1-score': 0.5170583272221795, 'support': 158372}, 'weighted avg': {'precision': 0.5610202261815822, 'recall': 0.5450774126739575, 'f1-score': 0.5505415743243087, 'support': 158372}}
[[18046 11939  5999]
 [17861 50102 17497]
 [ 5997 12754 18177]]
training model: results/EXC/W3/deepOF_L1/h100
Epoch 1/50
1876/1876 - 28s - loss: 3.2479 - accuracy100: 0.4014 - val_loss: 3.2617 - val_accuracy100: 0.4093 - 28s/epoch - 15ms/step
Epoch 2/50
1876/1876 - 26s - loss: 3.2085 - accuracy100: 0.4151 - val_loss: 3.2137 - val_accuracy100: 0.4278 - 26s/epoch - 14ms/step
Epoch 3/50
1876/1876 - 26s - loss: 3.1887 - accuracy100: 0.4237 - val_loss: 3.2066 - val_accuracy100: 0.4325 - 26s/epoch - 14ms/step
Epoch 4/50
1876/1876 - 25s - loss: 3.1740 - accuracy100: 0.4298 - val_loss: 3.1917 - val_accuracy100: 0.4354 - 25s/epoch - 13ms/step
Epoch 5/50
1876/1876 - 25s - loss: 3.1625 - accuracy100: 0.4349 - val_loss: 3.1809 - val_accuracy100: 0.4372 - 25s/epoch - 13ms/step
Epoch 6/50
1876/1876 - 25s - loss: 3.1527 - accuracy100: 0.4384 - val_loss: 3.1656 - val_accuracy100: 0.4422 - 25s/epoch - 13ms/step
Epoch 7/50
1876/1876 - 25s - loss: 3.1428 - accuracy100: 0.4421 - val_loss: 3.1663 - val_accuracy100: 0.4427 - 25s/epoch - 13ms/step
Epoch 8/50
1876/1876 - 25s - loss: 3.1342 - accuracy100: 0.4459 - val_loss: 3.1610 - val_accuracy100: 0.4436 - 25s/epoch - 14ms/step
Epoch 9/50
1876/1876 - 25s - loss: 3.1277 - accuracy100: 0.4483 - val_loss: 3.1634 - val_accuracy100: 0.4417 - 25s/epoch - 13ms/step
Epoch 10/50
1876/1876 - 25s - loss: 3.1214 - accuracy100: 0.4503 - val_loss: 3.1567 - val_accuracy100: 0.4449 - 25s/epoch - 13ms/step
Epoch 11/50
1876/1876 - 24s - loss: 3.1153 - accuracy100: 0.4521 - val_loss: 3.1629 - val_accuracy100: 0.4423 - 24s/epoch - 13ms/step
Epoch 12/50
1876/1876 - 25s - loss: 3.1090 - accuracy100: 0.4547 - val_loss: 3.1592 - val_accuracy100: 0.4443 - 25s/epoch - 13ms/step
Epoch 13/50
1876/1876 - 25s - loss: 3.1029 - accuracy100: 0.4566 - val_loss: 3.1703 - val_accuracy100: 0.4424 - 25s/epoch - 13ms/step
Epoch 14/50
1876/1876 - 25s - loss: 3.0964 - accuracy100: 0.4591 - val_loss: 3.1748 - val_accuracy100: 0.4417 - 25s/epoch - 13ms/step
Epoch 15/50
1876/1876 - 25s - loss: 3.0907 - accuracy100: 0.4619 - val_loss: 3.1775 - val_accuracy100: 0.4430 - 25s/epoch - 13ms/step
Epoch 16/50
1876/1876 - 25s - loss: 3.0847 - accuracy100: 0.4639 - val_loss: 3.1718 - val_accuracy100: 0.4436 - 25s/epoch - 13ms/step
Epoch 17/50
1876/1876 - 25s - loss: 3.0788 - accuracy100: 0.4653 - val_loss: 3.1586 - val_accuracy100: 0.4468 - 25s/epoch - 14ms/step
Epoch 18/50
1876/1876 - 25s - loss: 3.0727 - accuracy100: 0.4680 - val_loss: 3.1799 - val_accuracy100: 0.4449 - 25s/epoch - 13ms/step
Epoch 19/50
1876/1876 - 25s - loss: 3.0658 - accuracy100: 0.4707 - val_loss: 3.1716 - val_accuracy100: 0.4476 - 25s/epoch - 13ms/step
Epoch 20/50
1876/1876 - 25s - loss: 3.0599 - accuracy100: 0.4730 - val_loss: 3.1714 - val_accuracy100: 0.4479 - 25s/epoch - 13ms/step
testing model: results/EXC/W3/deepOF_L1/h100
Evaluating performance on  test set...
5098/5098 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0653474
{'0': {'precision': 0.4894854283589154, 'recall': 0.24358213259947364, 'f1-score': 0.32529035757673996, 'support': 416065}, '1': {'precision': 0.39473009075080645, 'recall': 0.7155554269438341, 'f1-score': 0.508790314046866, 'support': 483799}, '2': {'precision': 0.45486859502635346, 'recall': 0.2480107050362554, 'f1-score': 0.32100043618097196, 'support': 405043}, 'accuracy': 0.4199425706199752, 'macro avg': {'precision': 0.4463613713786918, 'recall': 0.4023827548598544, 'f1-score': 0.3850270359348593, 'support': 1304907}, 'weighted avg': {'precision': 0.4436094819481854, 'recall': 0.4199425706199752, 'f1-score': 0.3919920403850814, 'support': 1304907}}
[[101346 267241  47478]
 [ 64703 346185  72911]
 [ 40997 263591 100455]]
Evaluating performance on  train set...
1876/1876 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.051016
{'0': {'precision': 0.4939301605726446, 'recall': 0.27082035030960366, 'f1-score': 0.349830009163234, 'support': 150838}, '1': {'precision': 0.4004502178939166, 'recall': 0.70359289871485, 'f1-score': 0.510403851734384, 'support': 177489}, '2': {'precision': 0.5050670153644982, 'recall': 0.28483387982459607, 'f1-score': 0.36424872647665557, 'support': 151878}, 'accuracy': 0.4352099624118866, 'macro avg': {'precision': 0.4664824646103531, 'recall': 0.4197490429496833, 'f1-score': 0.4081608624580912, 'support': 480205}, 'weighted avg': {'precision': 0.4629012909981345, 'recall': 0.4352099624118866, 'f1-score': 0.4137401656427348, 'support': 480205}}
[[ 40850  93708  16280]
 [ 26497 124880  26112]
 [ 15357  93261  43260]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0465068
{'0': {'precision': 0.47414725069897484, 'recall': 0.2640823868945041, 'f1-score': 0.33922760975089344, 'support': 48163}, '1': {'precision': 0.4170143116629074, 'recall': 0.6853543720373316, 'f1-score': 0.5185244935314739, 'support': 60967}, '2': {'precision': 0.49864429487383966, 'recall': 0.31745258112992975, 'f1-score': 0.3879341365661178, 'support': 49242}, 'accuracy': 0.4428497461672518, 'macro avg': {'precision': 0.463268619078574, 'recall': 0.4222964466872552, 'f1-score': 0.4152287466161617, 'support': 158372}, 'weighted avg': {'precision': 0.4597700852596723, 'recall': 0.4428497461672518, 'f1-score': 0.4233940022122245, 'support': 158372}}
[[12719 29772  5672]
 [ 9138 41784 10045]
 [ 4968 28642 15632]]
training model: results/EXC/W3/deepOF_L1/h200
Epoch 1/50
1876/1876 - 27s - loss: 3.2876 - accuracy200: 0.3750 - val_loss: 3.2892 - val_accuracy200: 0.3617 - 27s/epoch - 14ms/step
Epoch 2/50
1876/1876 - 25s - loss: 3.2646 - accuracy200: 0.3867 - val_loss: 3.2725 - val_accuracy200: 0.3722 - 25s/epoch - 13ms/step
Epoch 3/50
1876/1876 - 26s - loss: 3.2576 - accuracy200: 0.3915 - val_loss: 3.2649 - val_accuracy200: 0.3803 - 26s/epoch - 14ms/step
Epoch 4/50
1876/1876 - 25s - loss: 3.2524 - accuracy200: 0.3941 - val_loss: 3.2612 - val_accuracy200: 0.3826 - 25s/epoch - 13ms/step
Epoch 5/50
1876/1876 - 25s - loss: 3.2484 - accuracy200: 0.3975 - val_loss: 3.2571 - val_accuracy200: 0.3846 - 25s/epoch - 13ms/step
Epoch 6/50
1876/1876 - 25s - loss: 3.2443 - accuracy200: 0.4001 - val_loss: 3.2548 - val_accuracy200: 0.3875 - 25s/epoch - 13ms/step
Epoch 7/50
1876/1876 - 25s - loss: 3.2407 - accuracy200: 0.4022 - val_loss: 3.2524 - val_accuracy200: 0.3871 - 25s/epoch - 13ms/step
Epoch 8/50
1876/1876 - 25s - loss: 3.2363 - accuracy200: 0.4052 - val_loss: 3.2500 - val_accuracy200: 0.3903 - 25s/epoch - 13ms/step
Epoch 9/50
1876/1876 - 26s - loss: 3.2335 - accuracy200: 0.4055 - val_loss: 3.2492 - val_accuracy200: 0.3905 - 26s/epoch - 14ms/step
Epoch 10/50
1876/1876 - 25s - loss: 3.2303 - accuracy200: 0.4082 - val_loss: 3.2472 - val_accuracy200: 0.3923 - 25s/epoch - 13ms/step
Epoch 11/50
1876/1876 - 25s - loss: 3.2272 - accuracy200: 0.4091 - val_loss: 3.2475 - val_accuracy200: 0.3937 - 25s/epoch - 13ms/step
Epoch 12/50
1876/1876 - 25s - loss: 3.2241 - accuracy200: 0.4114 - val_loss: 3.2470 - val_accuracy200: 0.3951 - 25s/epoch - 13ms/step
Epoch 13/50
1876/1876 - 25s - loss: 3.2212 - accuracy200: 0.4132 - val_loss: 3.2464 - val_accuracy200: 0.3960 - 25s/epoch - 13ms/step
Epoch 14/50
1876/1876 - 24s - loss: 3.2180 - accuracy200: 0.4147 - val_loss: 3.2487 - val_accuracy200: 0.3956 - 24s/epoch - 13ms/step
Epoch 15/50
1876/1876 - 25s - loss: 3.2159 - accuracy200: 0.4163 - val_loss: 3.2495 - val_accuracy200: 0.3934 - 25s/epoch - 13ms/step
Epoch 16/50
1876/1876 - 25s - loss: 3.2135 - accuracy200: 0.4173 - val_loss: 3.2481 - val_accuracy200: 0.3961 - 25s/epoch - 13ms/step
Epoch 17/50
1876/1876 - 24s - loss: 3.2101 - accuracy200: 0.4193 - val_loss: 3.2452 - val_accuracy200: 0.3955 - 24s/epoch - 13ms/step
Epoch 18/50
1876/1876 - 25s - loss: 3.2067 - accuracy200: 0.4213 - val_loss: 3.2571 - val_accuracy200: 0.3900 - 25s/epoch - 13ms/step
Epoch 19/50
1876/1876 - 25s - loss: 3.2039 - accuracy200: 0.4226 - val_loss: 3.2501 - val_accuracy200: 0.3963 - 25s/epoch - 13ms/step
Epoch 20/50
1876/1876 - 24s - loss: 3.2007 - accuracy200: 0.4238 - val_loss: 3.2519 - val_accuracy200: 0.3951 - 24s/epoch - 13ms/step
Epoch 21/50
1876/1876 - 24s - loss: 3.1974 - accuracy200: 0.4253 - val_loss: 3.2507 - val_accuracy200: 0.3942 - 24s/epoch - 13ms/step
Epoch 22/50
1876/1876 - 25s - loss: 3.1940 - accuracy200: 0.4272 - val_loss: 3.2556 - val_accuracy200: 0.3909 - 25s/epoch - 13ms/step
Epoch 23/50
1876/1876 - 25s - loss: 3.1898 - accuracy200: 0.4283 - val_loss: 3.2662 - val_accuracy200: 0.3876 - 25s/epoch - 13ms/step
Epoch 24/50
1876/1876 - 25s - loss: 3.1864 - accuracy200: 0.4297 - val_loss: 3.2698 - val_accuracy200: 0.3849 - 25s/epoch - 13ms/step
Epoch 25/50
1876/1876 - 25s - loss: 3.1835 - accuracy200: 0.4321 - val_loss: 3.2727 - val_accuracy200: 0.3888 - 25s/epoch - 13ms/step
Epoch 26/50
1876/1876 - 25s - loss: 3.1796 - accuracy200: 0.4339 - val_loss: 3.2736 - val_accuracy200: 0.3869 - 25s/epoch - 13ms/step
Epoch 27/50
1876/1876 - 25s - loss: 3.1765 - accuracy200: 0.4346 - val_loss: 3.2735 - val_accuracy200: 0.3892 - 25s/epoch - 13ms/step
testing model: results/EXC/W3/deepOF_L1/h200
Evaluating performance on  test set...
5098/5098 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0908701
{'0': {'precision': 0.4191889782686997, 'recall': 0.31324606695705615, 'f1-score': 0.35855547767773477, 'support': 445838}, '1': {'precision': 0.3487587542406197, 'recall': 0.544750152373848, 'f1-score': 0.4252590726468641, 'support': 439708}, '2': {'precision': 0.4087605330301084, 'recall': 0.2777344579014262, 'f1-score': 0.33074352049842537, 'support': 419361}, 'accuracy': 0.3798423948986403, 'macro avg': {'precision': 0.3922360885131426, 'recall': 0.3785768924107768, 'f1-score': 0.371519356941008, 'support': 1304907}, 'weighted avg': {'precision': 0.39210504342074504, 'recall': 0.3798423948986403, 'f1-score': 0.37209426179186206, 'support': 1304907}}
[[139657 229109  77072]
 [108783 239531  91394]
 [ 84720 218170 116471]]
Evaluating performance on  train set...
1876/1876 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0797446
{'0': {'precision': 0.44553299454394407, 'recall': 0.36558314346600507, 'f1-score': 0.4016178325900838, 'support': 162833}, '1': {'precision': 0.338755960580693, 'recall': 0.5167061044519441, 'f1-score': 0.4092227578667636, 'support': 154674}, '2': {'precision': 0.4592968093469598, 'recall': 0.3124131827066098, 'f1-score': 0.3718764289503045, 'support': 162698}, 'accuracy': 0.3962453535469227, 'macro avg': {'precision': 0.41452858815719895, 'recall': 0.3982341435415197, 'f1-score': 0.39423900646905063, 'support': 480205}, 'weighted avg': {'precision': 0.4158034294406843, 'recall': 0.3962453535469227, 'f1-score': 0.39399070942989256, 'support': 480205}}
[[59529 76498 26806]
 [41721 79921 33032]
 [32363 79506 50829]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0822505
{'0': {'precision': 0.41402547922371713, 'recall': 0.3373430860868047, 'f1-score': 0.3717712966130688, 'support': 51541}, '1': {'precision': 0.3602873837501774, 'recall': 0.514183679104615, 'f1-score': 0.42369359120212363, 'support': 54323}, '2': {'precision': 0.4463063063063063, 'recall': 0.33021634798506894, 'f1-score': 0.37958361610368, 'support': 52508}, 'accuracy': 0.39563811784911473, 'macro avg': {'precision': 0.40687305642673355, 'recall': 0.39391437105882954, 'f1-score': 0.39168283463962417, 'support': 158372}, 'weighted avg': {'precision': 0.406295496070404, 'recall': 0.39563811784911473, 'f1-score': 0.39217126681470943, 'support': 158372}}
[[17387 24952  9202]
 [14082 27932 12309]
 [10526 24643 17339]]
training model: results/EXC/W3/deepOF_L1/h300
Epoch 1/50
1876/1876 - 28s - loss: 3.2961 - accuracy300: 0.3693 - val_loss: 3.2899 - val_accuracy300: 0.3538 - 28s/epoch - 15ms/step
Epoch 2/50
1876/1876 - 25s - loss: 3.2788 - accuracy300: 0.3754 - val_loss: 3.2832 - val_accuracy300: 0.3588 - 25s/epoch - 13ms/step
Epoch 3/50
1876/1876 - 25s - loss: 3.2745 - accuracy300: 0.3769 - val_loss: 3.2833 - val_accuracy300: 0.3615 - 25s/epoch - 14ms/step
Epoch 4/50
1876/1876 - 24s - loss: 3.2714 - accuracy300: 0.3786 - val_loss: 3.2829 - val_accuracy300: 0.3623 - 24s/epoch - 13ms/step
Epoch 5/50
1876/1876 - 25s - loss: 3.2691 - accuracy300: 0.3802 - val_loss: 3.2825 - val_accuracy300: 0.3633 - 25s/epoch - 13ms/step
Epoch 6/50
1876/1876 - 25s - loss: 3.2669 - accuracy300: 0.3812 - val_loss: 3.2806 - val_accuracy300: 0.3652 - 25s/epoch - 13ms/step
Epoch 7/50
1876/1876 - 26s - loss: 3.2644 - accuracy300: 0.3835 - val_loss: 3.2794 - val_accuracy300: 0.3661 - 26s/epoch - 14ms/step
Epoch 8/50
1876/1876 - 25s - loss: 3.2620 - accuracy300: 0.3852 - val_loss: 3.2776 - val_accuracy300: 0.3668 - 25s/epoch - 13ms/step
Epoch 9/50
1876/1876 - 25s - loss: 3.2600 - accuracy300: 0.3870 - val_loss: 3.2766 - val_accuracy300: 0.3683 - 25s/epoch - 13ms/step
Epoch 10/50
1876/1876 - 26s - loss: 3.2574 - accuracy300: 0.3893 - val_loss: 3.2774 - val_accuracy300: 0.3676 - 26s/epoch - 14ms/step
Epoch 11/50
1876/1876 - 27s - loss: 3.2551 - accuracy300: 0.3911 - val_loss: 3.2758 - val_accuracy300: 0.3692 - 27s/epoch - 14ms/step
Epoch 12/50
1876/1876 - 26s - loss: 3.2536 - accuracy300: 0.3921 - val_loss: 3.2737 - val_accuracy300: 0.3719 - 26s/epoch - 14ms/step
Epoch 13/50
1876/1876 - 25s - loss: 3.2512 - accuracy300: 0.3935 - val_loss: 3.2747 - val_accuracy300: 0.3713 - 25s/epoch - 13ms/step
Epoch 14/50
1876/1876 - 26s - loss: 3.2496 - accuracy300: 0.3953 - val_loss: 3.2728 - val_accuracy300: 0.3719 - 26s/epoch - 14ms/step
Epoch 15/50
1876/1876 - 26s - loss: 3.2464 - accuracy300: 0.3979 - val_loss: 3.2765 - val_accuracy300: 0.3700 - 26s/epoch - 14ms/step
Epoch 16/50
1876/1876 - 25s - loss: 3.2448 - accuracy300: 0.3994 - val_loss: 3.2772 - val_accuracy300: 0.3703 - 25s/epoch - 13ms/step
Epoch 17/50
1876/1876 - 25s - loss: 3.2433 - accuracy300: 0.4002 - val_loss: 3.2791 - val_accuracy300: 0.3688 - 25s/epoch - 14ms/step
Epoch 18/50
1876/1876 - 26s - loss: 3.2416 - accuracy300: 0.4014 - val_loss: 3.2858 - val_accuracy300: 0.3649 - 26s/epoch - 14ms/step
Epoch 19/50
1876/1876 - 26s - loss: 3.2390 - accuracy300: 0.4032 - val_loss: 3.2838 - val_accuracy300: 0.3691 - 26s/epoch - 14ms/step
Epoch 20/50
1876/1876 - 26s - loss: 3.2363 - accuracy300: 0.4052 - val_loss: 3.2852 - val_accuracy300: 0.3680 - 26s/epoch - 14ms/step
Epoch 21/50
1876/1876 - 25s - loss: 3.2339 - accuracy300: 0.4061 - val_loss: 3.2895 - val_accuracy300: 0.3640 - 25s/epoch - 13ms/step
Epoch 22/50
1876/1876 - 26s - loss: 3.2331 - accuracy300: 0.4069 - val_loss: 3.2904 - val_accuracy300: 0.3650 - 26s/epoch - 14ms/step
Epoch 23/50
1876/1876 - 26s - loss: 3.2289 - accuracy300: 0.4086 - val_loss: 3.2929 - val_accuracy300: 0.3636 - 26s/epoch - 14ms/step
Epoch 24/50
1876/1876 - 25s - loss: 3.2263 - accuracy300: 0.4105 - val_loss: 3.2951 - val_accuracy300: 0.3650 - 25s/epoch - 13ms/step
testing model: results/EXC/W3/deepOF_L1/h300
Evaluating performance on  test set...
5098/5098 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0913198
{'0': {'precision': 0.39514681542522945, 'recall': 0.5337162178107789, 'f1-score': 0.4540955044232926, 'support': 466111}, '1': {'precision': 0.33082371809150446, 'recall': 0.01842401026147407, 'f1-score': 0.034904161613882705, 'support': 403061}, '2': {'precision': 0.3704291967761995, 'recall': 0.5550414816344796, 'f1-score': 0.44432217036290594, 'support': 435735}, 'accuracy': 0.3816731767091448, 'macro avg': {'precision': 0.3654665767643111, 'recall': 0.36906056990224423, 'f1-score': 0.3111072788000271, 'support': 1304907}, 'weighted avg': {'precision': 0.36702491593625164, 'recall': 0.38167317670914475, 'f1-score': 0.3213517414264613, 'support': 1304907}}
[[248771   7759 209581]
 [194173   7426 201462]
 [186622   7262 241851]]
Evaluating performance on  train set...
1876/1876 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0866865
{'0': {'precision': 0.3889998154331448, 'recall': 0.5715694492382033, 'f1-score': 0.4629346751729715, 'support': 162248}, '1': {'precision': 0.36551943913320584, 'recall': 0.021844845099035042, 'f1-score': 0.04122587369858746, 'support': 157520}, '2': {'precision': 0.386634824329267, 'recall': 0.5600453760666181, 'f1-score': 0.4574576409253829, 'support': 160437}, 'accuracy': 0.3873949667329578, 'macro avg': {'precision': 0.3803846929652059, 'recall': 0.38448655680128546, 'f1-score': 0.3205393965989806, 'support': 480205}, 'weighted avg': {'precision': 0.38050748204948737, 'recall': 0.3873949667329578, 'f1-score': 0.3227730996961952, 'support': 480205}}
[[92736  2826 66686]
 [78222  3441 75857]
 [67438  3147 89852]]
Evaluating performance on  val set...
619/619 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0899957
{'0': {'precision': 0.3683170664243095, 'recall': 0.5490369323201979, 'f1-score': 0.44087598145870777, 'support': 50931}, '1': {'precision': 0.37273337810611146, 'recall': 0.020024534564872278, 'f1-score': 0.03800719054956343, 'support': 55432}, '2': {'precision': 0.37551117989757526, 'recall': 0.5738045338306832, 'f1-score': 0.4539480689371929, 'support': 52009}, 'accuracy': 0.37201020382390826, 'macro avg': {'precision': 0.37218720814266537, 'recall': 0.3809553335719178, 'f1-score': 0.31094374698182137, 'support': 158372}, 'weighted avg': {'precision': 0.3722253560006028, 'recall': 0.37201020382390826, 'f1-score': 0.30416016919386835, 'support': 158372}}
[[27963   901 22067]
 [26759  1110 27563]
 [21199   967 29843]]
training model: results/EXC/W3/deepOF_L1/h500
Epoch 1/50
1876/1876 - 29s - loss: 3.3059 - accuracy500: 0.3559 - val_loss: 3.3087 - val_accuracy500: 0.3364 - 29s/epoch - 15ms/step
Epoch 2/50
1876/1876 - 26s - loss: 3.2874 - accuracy500: 0.3638 - val_loss: 3.2965 - val_accuracy500: 0.3454 - 26s/epoch - 14ms/step
Epoch 3/50
1876/1876 - 26s - loss: 3.2836 - accuracy500: 0.3666 - val_loss: 3.2929 - val_accuracy500: 0.3523 - 26s/epoch - 14ms/step
Epoch 4/50
1876/1876 - 27s - loss: 3.2811 - accuracy500: 0.3688 - val_loss: 3.2906 - val_accuracy500: 0.3567 - 27s/epoch - 14ms/step
Epoch 5/50
1876/1876 - 26s - loss: 3.2790 - accuracy500: 0.3707 - val_loss: 3.2898 - val_accuracy500: 0.3603 - 26s/epoch - 14ms/step
Epoch 6/50
1876/1876 - 26s - loss: 3.2774 - accuracy500: 0.3724 - val_loss: 3.2886 - val_accuracy500: 0.3610 - 26s/epoch - 14ms/step
Epoch 7/50
1876/1876 - 26s - loss: 3.2757 - accuracy500: 0.3739 - val_loss: 3.2890 - val_accuracy500: 0.3616 - 26s/epoch - 14ms/step
Epoch 8/50
1876/1876 - 26s - loss: 3.2748 - accuracy500: 0.3745 - val_loss: 3.2872 - val_accuracy500: 0.3636 - 26s/epoch - 14ms/step
Epoch 9/50
1876/1876 - 26s - loss: 3.2731 - accuracy500: 0.3756 - val_loss: 3.2877 - val_accuracy500: 0.3650 - 26s/epoch - 14ms/step
Epoch 10/50
1876/1876 - 26s - loss: 3.2721 - accuracy500: 0.3775 - val_loss: 3.2885 - val_accuracy500: 0.3636 - 26s/epoch - 14ms/step
Epoch 11/50
1876/1876 - 25s - loss: 3.2707 - accuracy500: 0.3788 - val_loss: 3.2888 - val_accuracy500: 0.3645 - 25s/epoch - 14ms/step
Epoch 12/50
1876/1876 - 26s - loss: 3.2695 - accuracy500: 0.3800 - val_loss: 3.2890 - val_accuracy500: 0.3642 - 26s/epoch - 14ms/step
Epoch 13/50
1876/1876 - 26s - loss: 3.2679 - accuracy500: 0.3815 - val_loss: 3.2893 - val_accuracy500: 0.3648 - 26s/epoch - 14ms/step
Epoch 14/50
1876/1876 - 26s - loss: 3.2667 - accuracy500: 0.3828 - val_loss: 3.2899 - val_accuracy500: 0.3653 - 26s/epoch - 14ms/step
Epoch 15/50
1876/1876 - 26s - loss: 3.2651 - accuracy500: 0.3842 - val_loss: 3.2909 - val_accuracy500: 0.3648 - 26s/epoch - 14ms/step
Epoch 16/50
1876/1876 - 26s - loss: 3.2633 - accuracy500: 0.3869 - val_loss: 3.2919 - val_accuracy500: 0.3657 - 26s/epoch - 14ms/step
Epoch 17/50
1876/1876 - 26s - loss: 3.2620 - accuracy500: 0.3871 - val_loss: 3.2924 - val_accuracy500: 0.3664 - 26s/epoch - 14ms/step
Epoch 18/50
1876/1876 - 26s - loss: 3.2599 - accuracy500: 0.3888 - val_loss: 3.2907 - val_accuracy500: 0.3672 - 26s/epoch - 14ms/step
testing model: results/EXC/W3/deepOF_L1/h500
Evaluating performance on  test set...
5098/5098 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0957122
{'0': {'precision': 0.3807562240469259, 'recall': 0.5701694285164685, 'f1-score': 0.4565983851286445, 'support': 462673}, '1': {'precision': 0.3388454671222996, 'recall': 0.2720181494146766, 'f1-score': 0.3017764175469773, 'support': 421391}, '2': {'precision': 0.3634225270831964, 'recall': 0.2364302126921441, 'f1-score': 0.28648386404829057, 'support': 420843}, 'accuracy': 0.36625445338250157, 'macro avg': {'precision': 0.3610080727508073, 'recall': 0.3595392635410964, 'f1-score': 0.3482862222413041, 'support': 1304907}, 'weighted avg': {'precision': 0.36163181073430517, 'recall': 0.36625445338250157, 'f1-score': 0.3517387367887814, 'support': 1304907}}
[[263802 113079  85792]
 [218271 114626  88494]
 [210764 110579  99500]]
Evaluating performance on  train set...
1876/1876 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0938103
{'0': {'precision': 0.37804220704975333, 'recall': 0.5611638126988938, 'f1-score': 0.45175095092750506, 'support': 164975}, '1': {'precision': 0.34585196299451854, 'recall': 0.2966493561926442, 'f1-score': 0.31936669730136186, 'support': 154627}, '2': {'precision': 0.38478692739171083, 'recall': 0.24602902810034682, 'f1-score': 0.3001469856546559, 'support': 160603}, 'accuracy': 0.37059380889411814, 'macro avg': {'precision': 0.3695603658119942, 'recall': 0.36794739899729495, 'f1-score': 0.3570882112945076, 'support': 480205}, 'weighted avg': {'precision': 0.36993263187571435, 'recall': 0.37059380889411814, 'f1-score': 0.3584194953613093, 'support': 480205}}
[[92578 42272 30125]
 [75707 45870 33050]
 [76603 44487 39513]]
Evaluating performance on  val set...
619/619 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0955617
{'0': {'precision': 0.3619714001682343, 'recall': 0.5444350726526856, 'f1-score': 0.4348378601831154, 'support': 52166}, '1': {'precision': 0.34383131449080306, 'recall': 0.2944181936921363, 'f1-score': 0.3172119782289274, 'support': 52062}, '2': {'precision': 0.3948768751769035, 'recall': 0.2576647458628842, 'f1-score': 0.31184478172429986, 'support': 54144}, 'accuracy': 0.36420579395347663, 'macro avg': {'precision': 0.36689319661198033, 'recall': 0.36550600406923534, 'f1-score': 0.35463154004544756, 'support': 158372}, 'weighted avg': {'precision': 0.36725784536265604, 'recall': 0.36420579395347663, 'f1-score': 0.35412172408347, 'support': 158372}}
[[28401 13977  9788]
 [25143 15328 11591]
 [24918 15275 13951]]
training model: results/EXC/W3/deepOF_L1/h1000
Epoch 1/50
1876/1876 - 30s - loss: 3.2727 - accuracy1000: 0.3877 - val_loss: 3.3439 - val_accuracy1000: 0.3208 - 30s/epoch - 16ms/step
Epoch 2/50
1876/1876 - 27s - loss: 3.2682 - accuracy1000: 0.3833 - val_loss: 3.3473 - val_accuracy1000: 0.3213 - 27s/epoch - 14ms/step
Epoch 3/50
1876/1876 - 26s - loss: 3.2774 - accuracy1000: 0.3728 - val_loss: 3.3529 - val_accuracy1000: 0.3251 - 26s/epoch - 14ms/step
Epoch 4/50
1876/1876 - 26s - loss: 3.2804 - accuracy1000: 0.3696 - val_loss: 3.3523 - val_accuracy1000: 0.3266 - 26s/epoch - 14ms/step
Epoch 5/50
1876/1876 - 27s - loss: 3.2800 - accuracy1000: 0.3707 - val_loss: 3.3514 - val_accuracy1000: 0.3271 - 27s/epoch - 14ms/step
Epoch 6/50
1876/1876 - 27s - loss: 3.2800 - accuracy1000: 0.3711 - val_loss: 3.3525 - val_accuracy1000: 0.3287 - 27s/epoch - 14ms/step
Epoch 7/50
1876/1876 - 27s - loss: 3.2798 - accuracy1000: 0.3715 - val_loss: 3.3522 - val_accuracy1000: 0.3287 - 27s/epoch - 14ms/step
Epoch 8/50
1876/1876 - 26s - loss: 3.2797 - accuracy1000: 0.3721 - val_loss: 3.3530 - val_accuracy1000: 0.3285 - 26s/epoch - 14ms/step
Epoch 9/50
1876/1876 - 27s - loss: 3.2788 - accuracy1000: 0.3727 - val_loss: 3.3526 - val_accuracy1000: 0.3290 - 27s/epoch - 14ms/step
Epoch 10/50
1876/1876 - 26s - loss: 3.2783 - accuracy1000: 0.3728 - val_loss: 3.3536 - val_accuracy1000: 0.3294 - 26s/epoch - 14ms/step
Epoch 11/50
1876/1876 - 26s - loss: 3.2776 - accuracy1000: 0.3734 - val_loss: 3.3530 - val_accuracy1000: 0.3290 - 26s/epoch - 14ms/step
testing model: results/EXC/W3/deepOF_L1/h1000
Evaluating performance on  test set...
5098/5098 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0894005
{'0': {'precision': 0.404578570366548, 'recall': 0.8854652787614515, 'f1-score': 0.5553924028747955, 'support': 522418}, '1': {'precision': 0.2610673880964092, 'recall': 0.013175696642462608, 'f1-score': 0.025085370608878547, 'support': 322260}, '2': {'precision': 0.3728703888540885, 'recall': 0.11769792863987276, 'f1-score': 0.1789193099279606, 'support': 460229}, 'accuracy': 0.39925987062679563, 'macro avg': {'precision': 0.3461721157723486, 'recall': 0.3387796346812623, 'f1-score': 0.25313236113721155, 'support': 1304907}, 'weighted avg': {'precision': 0.35795383905031425, 'recall': 0.39925987062679563, 'f1-score': 0.29164902552158695, 'support': 1304907}}
[[462583   6002  53833]
 [280742   4246  37272]
 [400045   6016  54168]]
Evaluating performance on  train set...
1876/1876 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992517
{'0': {'precision': 0.3532187837877327, 'recall': 0.8671816149127737, 'f1-score': 0.5019743285379586, 'support': 167266}, '1': {'precision': 0.338317248878619, 'recall': 0.016364341645901684, 'f1-score': 0.031218643387517564, 'support': 152099}, '2': {'precision': 0.35801337706604924, 'recall': 0.13844192986819198, 'f1-score': 0.19967180186158287, 'support': 160840}, 'accuracy': 0.3536114784310867, 'macro avg': {'precision': 0.3498498032441337, 'recall': 0.3406626288089558, 'f1-score': 0.24428825792901968, 'support': 480205}, 'weighted avg': {'precision': 0.3501048091826019, 'recall': 0.3536114784310867, 'f1-score': 0.2516149875350011, 'support': 480205}}
[[145050   2309  19907]
 [129588   2489  20022]
 [136014   2559  22267]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1071655
{'0': {'precision': 0.3154916258486816, 'recall': 0.8667870988694257, 'f1-score': 0.46260507842967324, 'support': 49267}, '1': {'precision': 0.36981132075471695, 'recall': 0.01347472629462214, 'f1-score': 0.026002023116594532, 'support': 58183}, '2': {'precision': 0.3459200765733429, 'recall': 0.1419425788460783, 'f1-score': 0.20128938830638984, 'support': 50922}, 'accuracy': 0.32023337458641676, 'macro avg': {'precision': 0.3437410077255805, 'recall': 0.3407348013367087, 'f1-score': 0.22996549661755253, 'support': 158372}, 'weighted avg': {'precision': 0.34523148123043507, 'recall': 0.32023337458641676, 'f1-score': 0.21818312796028033, 'support': 158372}}
[[42704   638  5925]
 [49657   784  7742]
 [42996   698  7228]]
training model: results/EXC/W3/deepLOB_L2/h10
Epoch 1/50
1876/1876 - 78s - loss: 2.5856 - accuracy10: 0.5100 - val_loss: 2.4038 - val_accuracy10: 0.5818 - 78s/epoch - 41ms/step
Epoch 2/50
1876/1876 - 74s - loss: 2.2626 - accuracy10: 0.6039 - val_loss: 2.0398 - val_accuracy10: 0.7066 - 74s/epoch - 39ms/step
Epoch 3/50
1876/1876 - 74s - loss: 2.1050 - accuracy10: 0.6498 - val_loss: 1.9311 - val_accuracy10: 0.6706 - 74s/epoch - 39ms/step
Epoch 4/50
1876/1876 - 74s - loss: 2.0507 - accuracy10: 0.6584 - val_loss: 1.9162 - val_accuracy10: 0.6968 - 74s/epoch - 40ms/step
Epoch 5/50
1876/1876 - 74s - loss: 2.0168 - accuracy10: 0.6609 - val_loss: 1.8881 - val_accuracy10: 0.6806 - 74s/epoch - 39ms/step
Epoch 6/50
1876/1876 - 74s - loss: 1.9946 - accuracy10: 0.6636 - val_loss: 1.8661 - val_accuracy10: 0.7024 - 74s/epoch - 39ms/step
Epoch 7/50
1876/1876 - 74s - loss: 1.9756 - accuracy10: 0.6657 - val_loss: 1.8543 - val_accuracy10: 0.7062 - 74s/epoch - 39ms/step
Epoch 8/50
1876/1876 - 74s - loss: 1.9561 - accuracy10: 0.6676 - val_loss: 1.8681 - val_accuracy10: 0.7034 - 74s/epoch - 39ms/step
Epoch 9/50
1876/1876 - 74s - loss: 1.9398 - accuracy10: 0.6689 - val_loss: 1.8517 - val_accuracy10: 0.6982 - 74s/epoch - 39ms/step
Epoch 10/50
1876/1876 - 74s - loss: 1.9247 - accuracy10: 0.6709 - val_loss: 1.8367 - val_accuracy10: 0.6881 - 74s/epoch - 40ms/step
Epoch 11/50
1876/1876 - 73s - loss: 1.9108 - accuracy10: 0.6721 - val_loss: 1.8336 - val_accuracy10: 0.6872 - 73s/epoch - 39ms/step
Epoch 12/50
1876/1876 - 74s - loss: 1.8988 - accuracy10: 0.6732 - val_loss: 1.8335 - val_accuracy10: 0.6796 - 74s/epoch - 39ms/step
Epoch 13/50
1876/1876 - 74s - loss: 1.8897 - accuracy10: 0.6738 - val_loss: 1.8440 - val_accuracy10: 0.6673 - 74s/epoch - 39ms/step
Epoch 14/50
1876/1876 - 74s - loss: 1.8814 - accuracy10: 0.6749 - val_loss: 1.8132 - val_accuracy10: 0.6754 - 74s/epoch - 39ms/step
Epoch 15/50
1876/1876 - 74s - loss: 1.8686 - accuracy10: 0.6767 - val_loss: 1.8268 - val_accuracy10: 0.6817 - 74s/epoch - 39ms/step
Epoch 16/50
1876/1876 - 74s - loss: 1.8628 - accuracy10: 0.6776 - val_loss: 1.8322 - val_accuracy10: 0.6675 - 74s/epoch - 39ms/step
Epoch 17/50
1876/1876 - 74s - loss: 1.8528 - accuracy10: 0.6790 - val_loss: 1.8328 - val_accuracy10: 0.6665 - 74s/epoch - 40ms/step
Epoch 18/50
1876/1876 - 74s - loss: 1.8449 - accuracy10: 0.6800 - val_loss: 1.8483 - val_accuracy10: 0.6498 - 74s/epoch - 40ms/step
Epoch 19/50
1876/1876 - 74s - loss: 1.8381 - accuracy10: 0.6800 - val_loss: 1.8726 - val_accuracy10: 0.6388 - 74s/epoch - 39ms/step
Epoch 20/50
1876/1876 - 74s - loss: 1.8334 - accuracy10: 0.6799 - val_loss: 1.8402 - val_accuracy10: 0.6528 - 74s/epoch - 39ms/step
Epoch 21/50
1876/1876 - 74s - loss: 1.8249 - accuracy10: 0.6813 - val_loss: 1.8453 - val_accuracy10: 0.6652 - 74s/epoch - 39ms/step
Epoch 22/50
1876/1876 - 74s - loss: 1.8173 - accuracy10: 0.6814 - val_loss: 1.8577 - val_accuracy10: 0.6574 - 74s/epoch - 39ms/step
Epoch 23/50
1876/1876 - 74s - loss: 1.8107 - accuracy10: 0.6819 - val_loss: 1.8851 - val_accuracy10: 0.6483 - 74s/epoch - 39ms/step
Epoch 24/50
1876/1876 - 74s - loss: 1.8040 - accuracy10: 0.6831 - val_loss: 1.8717 - val_accuracy10: 0.6582 - 74s/epoch - 39ms/step
testing model: results/EXC/W3/deepLOB_L2/h10
Evaluating performance on  test set...
5098/5098 - 67s - 67s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83102566
{'0': {'precision': 0.32617035153806223, 'recall': 0.7994532024847314, 'f1-score': 0.4633128565243122, 'support': 153256}, '1': {'precision': 0.9550573666447775, 'recall': 0.542714568262375, 'f1-score': 0.6921261299191753, 'support': 999577}, '2': {'precision': 0.3118337609996042, 'recall': 0.7407646076355554, 'f1-score': 0.4389051332350231, 'support': 152078}, 'accuracy': 0.5959486892209507, 'macro avg': {'precision': 0.5310204930608147, 'recall': 0.6943107927942206, 'f1-score': 0.5314480398928368, 'support': 1304911}, 'weighted avg': {'precision': 0.8062342914415633, 'recall': 0.5959486892209507, 'f1-score': 0.635741939916075, 'support': 1304911}}
[[122521  13144  17591]
 [226074 542485 231018]
 [ 27040  12384 112654]]
Evaluating performance on  train set...
1876/1876 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7145586
{'0': {'precision': 0.3485460873470304, 'recall': 0.7685221204512501, 'f1-score': 0.47958643214971414, 'support': 56554}, '1': {'precision': 0.9463982120764657, 'recall': 0.6475934295506369, 'f1-score': 0.7689893069371144, 'support': 366185}, '2': {'precision': 0.3751322196704752, 'recall': 0.685007308415118, 'f1-score': 0.4847820598865813, 'support': 57468}, 'accuracy': 0.6663126526685367, 'macro avg': {'precision': 0.5566921730313238, 'recall': 0.7003742861390018, 'f1-score': 0.5777859329911367, 'support': 480207}, 'weighted avg': {'precision': 0.8076238020542545, 'recall': 0.6663126526685367, 'f1-score': 0.7008942723911235, 'support': 480207}}
[[ 43463   5648   7443]
 [ 70916 237139  58130]
 [ 10319   7783  39366]]
Evaluating performance on  val set...
619/619 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6776321
{'0': {'precision': 0.31780342777194825, 'recall': 0.82665130102505, 'f1-score': 0.45910530216263556, 'support': 16487}, '1': {'precision': 0.9492847105438964, 'recall': 0.6588877696231272, 'f1-score': 0.7778669183577159, 'support': 125082}, '2': {'precision': 0.38267815410373573, 'recall': 0.6529191215854312, 'f1-score': 0.4825387051372273, 'support': 16803}, 'accuracy': 0.6757191927866036, 'macro avg': {'precision': 0.5499220974731935, 'recall': 0.7128193974112028, 'f1-score': 0.5731703085525263, 'support': 158372}, 'weighted avg': {'precision': 0.8234296233004119, 'recall': 0.6757191927866036, 'f1-score': 0.7133490570378351, 'support': 158372}}
[[13629  1481  1377]
 [26346 82415 16321]
 [ 2910  2922 10971]]
training model: results/EXC/W3/deepLOB_L2/h20
Epoch 1/50
1876/1876 - 77s - loss: 2.6975 - accuracy20: 0.5001 - val_loss: 2.5114 - val_accuracy20: 0.4347 - 77s/epoch - 41ms/step
Epoch 2/50
1876/1876 - 74s - loss: 2.3771 - accuracy20: 0.5885 - val_loss: 2.2752 - val_accuracy20: 0.5572 - 74s/epoch - 39ms/step
Epoch 3/50
1876/1876 - 74s - loss: 2.2157 - accuracy20: 0.6316 - val_loss: 2.1480 - val_accuracy20: 0.5992 - 74s/epoch - 39ms/step
Epoch 4/50
1876/1876 - 74s - loss: 2.1491 - accuracy20: 0.6416 - val_loss: 2.0816 - val_accuracy20: 0.6118 - 74s/epoch - 40ms/step
Epoch 5/50
1876/1876 - 74s - loss: 2.1132 - accuracy20: 0.6449 - val_loss: 2.1091 - val_accuracy20: 0.6099 - 74s/epoch - 39ms/step
Epoch 6/50
1876/1876 - 74s - loss: 2.0914 - accuracy20: 0.6477 - val_loss: 2.0649 - val_accuracy20: 0.6287 - 74s/epoch - 40ms/step
Epoch 7/50
1876/1876 - 74s - loss: 2.0741 - accuracy20: 0.6496 - val_loss: 2.0616 - val_accuracy20: 0.6357 - 74s/epoch - 39ms/step
Epoch 8/50
1876/1876 - 74s - loss: 2.0571 - accuracy20: 0.6524 - val_loss: 2.0387 - val_accuracy20: 0.6529 - 74s/epoch - 40ms/step
Epoch 9/50
1876/1876 - 74s - loss: 2.0435 - accuracy20: 0.6539 - val_loss: 2.0532 - val_accuracy20: 0.6469 - 74s/epoch - 39ms/step
Epoch 10/50
1876/1876 - 74s - loss: 2.0344 - accuracy20: 0.6551 - val_loss: 2.0175 - val_accuracy20: 0.6565 - 74s/epoch - 39ms/step
Epoch 11/50
1876/1876 - 74s - loss: 2.0251 - accuracy20: 0.6557 - val_loss: 2.0293 - val_accuracy20: 0.6533 - 74s/epoch - 39ms/step
Epoch 12/50
1876/1876 - 74s - loss: 2.0181 - accuracy20: 0.6570 - val_loss: 2.0282 - val_accuracy20: 0.6585 - 74s/epoch - 40ms/step
Epoch 13/50
1876/1876 - 74s - loss: 2.0083 - accuracy20: 0.6584 - val_loss: 2.0482 - val_accuracy20: 0.6580 - 74s/epoch - 40ms/step
Epoch 14/50
1876/1876 - 74s - loss: 2.0017 - accuracy20: 0.6587 - val_loss: 2.0768 - val_accuracy20: 0.6311 - 74s/epoch - 39ms/step
Epoch 15/50
1876/1876 - 74s - loss: 1.9944 - accuracy20: 0.6590 - val_loss: 2.0858 - val_accuracy20: 0.6452 - 74s/epoch - 40ms/step
Epoch 16/50
1876/1876 - 74s - loss: 1.9872 - accuracy20: 0.6612 - val_loss: 2.0919 - val_accuracy20: 0.6392 - 74s/epoch - 40ms/step
Epoch 17/50
1876/1876 - 74s - loss: 1.9790 - accuracy20: 0.6617 - val_loss: 2.1534 - val_accuracy20: 0.6154 - 74s/epoch - 39ms/step
Epoch 18/50
1876/1876 - 74s - loss: 1.9748 - accuracy20: 0.6624 - val_loss: 2.1602 - val_accuracy20: 0.6241 - 74s/epoch - 39ms/step
Epoch 19/50
1876/1876 - 74s - loss: 1.9686 - accuracy20: 0.6632 - val_loss: 2.1589 - val_accuracy20: 0.6316 - 74s/epoch - 39ms/step
Epoch 20/50
1876/1876 - 74s - loss: 1.9630 - accuracy20: 0.6637 - val_loss: 2.0941 - val_accuracy20: 0.6313 - 74s/epoch - 39ms/step
testing model: results/EXC/W3/deepLOB_L2/h20
Evaluating performance on  test set...
5098/5098 - 67s - 67s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82404864
{'0': {'precision': 0.4008328188421979, 'recall': 0.7258338447485978, 'f1-score': 0.5164580357324198, 'support': 210201}, '1': {'precision': 0.8935723927999174, 'recall': 0.5266388547061713, 'f1-score': 0.6627041468197977, 'support': 887388}, '2': {'precision': 0.37543672529542815, 'recall': 0.7266763778084333, 'f1-score': 0.49508711740310607, 'support': 207322}, 'accuracy': 0.5905077051231846, 'macro avg': {'precision': 0.5566139789791812, 'recall': 0.6597163590877342, 'f1-score': 0.558083099985108, 'support': 1304911}, 'weighted avg': {'precision': 0.7318791631131016, 'recall': 0.5905077051231846, 'f1-score': 0.612515454587603, 'support': 1304911}}
[[152571  28159  29471]
 [198900 467333 221155]
 [ 29164  27502 150656]]
Evaluating performance on  train set...
1876/1876 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74057907
{'0': {'precision': 0.4120335465617883, 'recall': 0.6892960237172653, 'f1-score': 0.5157640236813046, 'support': 76906}, '1': {'precision': 0.8888224848763667, 'recall': 0.6366979484604984, 'f1-score': 0.7419257589732731, 'support': 324683}, '2': {'precision': 0.438785545571461, 'recall': 0.6639828029204508, 'f1-score': 0.5283903130298352, 'support': 78618}, 'accuracy': 0.6495886149098201, 'macro avg': {'precision': 0.5798805256698719, 'recall': 0.6633255916994049, 'f1-score': 0.5953600318948044, 'support': 480207}, 'weighted avg': {'precision': 0.738785242219983, 'recall': 0.6495886149098201, 'f1-score': 0.6707461966104892, 'support': 480207}}
[[ 53011  11034  12861]
 [ 64053 206725  53905]
 [ 11593  14824  52201]]
Evaluating performance on  val set...
619/619 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7104141
{'0': {'precision': 0.3789657862006451, 'recall': 0.7815747141428634, 'f1-score': 0.510434708538005, 'support': 23001}, '1': {'precision': 0.8900817553277016, 'recall': 0.6437657667328646, 'f1-score': 0.7471461868696047, 'support': 111786}, '2': {'precision': 0.4714133758808669, 'recall': 0.601314394742421, 'f1-score': 0.5284987609234382, 'support': 23585}, 'accuracy': 0.657458389109186, 'macro avg': {'precision': 0.5801536391364045, 'recall': 0.6755516252060496, 'f1-score': 0.5953598854436827, 'support': 158372}, 'weighted avg': {'precision': 0.753501601417004, 'recall': 0.657458389109186, 'f1-score': 0.6802063221583837, 'support': 158372}}
[[17977  3022  2002]
 [25922 71964 13900]
 [ 3538  5865 14182]]
training model: results/EXC/W3/deepLOB_L2/h30
Epoch 1/50
1876/1876 - 77s - loss: 2.7676 - accuracy30: 0.4974 - val_loss: 2.7239 - val_accuracy30: 0.4273 - 77s/epoch - 41ms/step
Epoch 2/50
1876/1876 - 74s - loss: 2.5027 - accuracy30: 0.5703 - val_loss: 2.6219 - val_accuracy30: 0.5219 - 74s/epoch - 39ms/step
Epoch 3/50
1876/1876 - 74s - loss: 2.3374 - accuracy30: 0.6143 - val_loss: 2.4071 - val_accuracy30: 0.5873 - 74s/epoch - 40ms/step
Epoch 4/50
1876/1876 - 75s - loss: 2.2734 - accuracy30: 0.6248 - val_loss: 2.2572 - val_accuracy30: 0.6248 - 75s/epoch - 40ms/step
Epoch 5/50
1876/1876 - 74s - loss: 2.2392 - accuracy30: 0.6293 - val_loss: 2.2138 - val_accuracy30: 0.6514 - 74s/epoch - 40ms/step
Epoch 6/50
1876/1876 - 74s - loss: 2.2171 - accuracy30: 0.6320 - val_loss: 2.2481 - val_accuracy30: 0.6526 - 74s/epoch - 39ms/step
Epoch 7/50
1876/1876 - 74s - loss: 2.2027 - accuracy30: 0.6331 - val_loss: 2.1862 - val_accuracy30: 0.6494 - 74s/epoch - 39ms/step
Epoch 8/50
1876/1876 - 74s - loss: 2.1881 - accuracy30: 0.6340 - val_loss: 2.1738 - val_accuracy30: 0.6598 - 74s/epoch - 40ms/step
Epoch 9/50
1876/1876 - 74s - loss: 2.1772 - accuracy30: 0.6361 - val_loss: 2.1963 - val_accuracy30: 0.6388 - 74s/epoch - 39ms/step
Epoch 10/50
1876/1876 - 74s - loss: 2.1645 - accuracy30: 0.6372 - val_loss: 2.1694 - val_accuracy30: 0.6394 - 74s/epoch - 40ms/step
Epoch 11/50
1876/1876 - 74s - loss: 2.1553 - accuracy30: 0.6377 - val_loss: 2.1644 - val_accuracy30: 0.6272 - 74s/epoch - 39ms/step
Epoch 12/50
1876/1876 - 73s - loss: 2.1472 - accuracy30: 0.6391 - val_loss: 2.2021 - val_accuracy30: 0.6227 - 73s/epoch - 39ms/step
Epoch 13/50
1876/1876 - 74s - loss: 2.1385 - accuracy30: 0.6403 - val_loss: 2.1579 - val_accuracy30: 0.6283 - 74s/epoch - 39ms/step
Epoch 14/50
1876/1876 - 74s - loss: 2.1324 - accuracy30: 0.6400 - val_loss: 2.2002 - val_accuracy30: 0.6164 - 74s/epoch - 39ms/step
Epoch 15/50
1876/1876 - 74s - loss: 2.1252 - accuracy30: 0.6417 - val_loss: 2.1713 - val_accuracy30: 0.6226 - 74s/epoch - 39ms/step
Epoch 16/50
1876/1876 - 74s - loss: 2.1196 - accuracy30: 0.6417 - val_loss: 2.1830 - val_accuracy30: 0.6237 - 74s/epoch - 40ms/step
Epoch 17/50
1876/1876 - 74s - loss: 2.1124 - accuracy30: 0.6430 - val_loss: 2.1672 - val_accuracy30: 0.6260 - 74s/epoch - 40ms/step
Epoch 18/50
1876/1876 - 74s - loss: 2.1073 - accuracy30: 0.6429 - val_loss: 2.1753 - val_accuracy30: 0.6270 - 74s/epoch - 39ms/step
Epoch 19/50
1876/1876 - 74s - loss: 2.1016 - accuracy30: 0.6439 - val_loss: 2.1962 - val_accuracy30: 0.6231 - 74s/epoch - 40ms/step
Epoch 20/50
1876/1876 - 74s - loss: 2.0952 - accuracy30: 0.6444 - val_loss: 2.1962 - val_accuracy30: 0.6116 - 74s/epoch - 40ms/step
Epoch 21/50
1876/1876 - 74s - loss: 2.0913 - accuracy30: 0.6453 - val_loss: 2.1914 - val_accuracy30: 0.6127 - 74s/epoch - 39ms/step
Epoch 22/50
1876/1876 - 74s - loss: 2.0856 - accuracy30: 0.6457 - val_loss: 2.2230 - val_accuracy30: 0.6146 - 74s/epoch - 39ms/step
Epoch 23/50
1876/1876 - 74s - loss: 2.0808 - accuracy30: 0.6465 - val_loss: 2.2532 - val_accuracy30: 0.6020 - 74s/epoch - 40ms/step
testing model: results/EXC/W3/deepLOB_L2/h30
Evaluating performance on  test set...
5098/5098 - 67s - 67s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86910987
{'0': {'precision': 0.46293126263451, 'recall': 0.6520556311245593, 'f1-score': 0.5414537844597498, 'support': 252161}, '1': {'precision': 0.8525899636309863, 'recall': 0.45848989552580044, 'f1-score': 0.5963082730947059, 'support': 804792}, '2': {'precision': 0.3746128713388413, 'recall': 0.7809992014776697, 'f1-score': 0.5063504618220563, 'support': 247958}, 'accuracy': 0.5571774626775312, 'macro avg': {'precision': 0.5633780325347791, 'recall': 0.6305149093760098, 'f1-score': 0.5480375064588374, 'support': 1304911}, 'weighted avg': {'precision': 0.6864675448970282, 'recall': 0.5571774626775312, 'f1-score': 0.5686144903951788, 'support': 1304911}}
[[164423  42647  45091]
 [157602 368989 278201]
 [ 33153  21150 193655]]
Evaluating performance on  train set...
1876/1876 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7839564
{'0': {'precision': 0.44275532332196016, 'recall': 0.6538852514564911, 'f1-score': 0.5279964695498676, 'support': 91487}, '1': {'precision': 0.8487827441815172, 'recall': 0.5907952485045668, 'f1-score': 0.6966719619538612, 'support': 295065}, '2': {'precision': 0.45371258427931344, 'recall': 0.6768458704820886, 'f1-score': 0.5432598159995543, 'support': 93655}, 'accuracy': 0.619597381962362, 'macro avg': {'precision': 0.5817502172609302, 'recall': 0.6405087901477154, 'f1-score': 0.5893094158344276, 'support': 480207}, 'weighted avg': {'precision': 0.6943774013235016, 'recall': 0.619597381962362, 'f1-score': 0.6346165789567062, 'support': 480207}}
[[ 59822  15427  16238]
 [ 60656 174323  60086]
 [ 14635  15630  63390]]
Evaluating performance on  val set...
619/619 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7540523
{'0': {'precision': 0.4108196212356411, 'recall': 0.7585539751352514, 'f1-score': 0.532984253653379, 'support': 27911}, '1': {'precision': 0.8457660452619041, 'recall': 0.600269337763317, 'f1-score': 0.7021784250257284, 'support': 101731}, '2': {'precision': 0.49410983426690536, 'recall': 0.5956491472328577, 'f1-score': 0.5401489804936557, 'support': 28730}, 'accuracy': 0.6273268001919531, 'macro avg': {'precision': 0.5835651669214835, 'recall': 0.6514908200438088, 'f1-score': 0.5917705530575877, 'support': 158372}, 'weighted avg': {'precision': 0.7053190433746808, 'recall': 0.6273268001919531, 'f1-score': 0.6429666675270538, 'support': 158372}}
[[21172  4270  2469]
 [25613 61066 15052]
 [ 4751  6866 17113]]
training model: results/EXC/W3/deepLOB_L2/h50
Epoch 1/50
1876/1876 - 77s - loss: 2.8951 - accuracy50: 0.4901 - val_loss: 2.8917 - val_accuracy50: 0.4683 - 77s/epoch - 41ms/step
Epoch 2/50
1876/1876 - 74s - loss: 2.7178 - accuracy50: 0.5405 - val_loss: 2.7921 - val_accuracy50: 0.4770 - 74s/epoch - 39ms/step
Epoch 3/50
1876/1876 - 74s - loss: 2.5997 - accuracy50: 0.5736 - val_loss: 2.6603 - val_accuracy50: 0.5695 - 74s/epoch - 39ms/step
Epoch 4/50
1876/1876 - 73s - loss: 2.5270 - accuracy50: 0.5870 - val_loss: 2.6468 - val_accuracy50: 0.5903 - 73s/epoch - 39ms/step
Epoch 5/50
1876/1876 - 73s - loss: 2.4891 - accuracy50: 0.5915 - val_loss: 2.6165 - val_accuracy50: 0.5903 - 73s/epoch - 39ms/step
Epoch 6/50
1876/1876 - 73s - loss: 2.4659 - accuracy50: 0.5952 - val_loss: 2.6528 - val_accuracy50: 0.5604 - 73s/epoch - 39ms/step
Epoch 7/50
1876/1876 - 74s - loss: 2.4498 - accuracy50: 0.5977 - val_loss: 2.7243 - val_accuracy50: 0.5527 - 74s/epoch - 39ms/step
Epoch 8/50
1876/1876 - 74s - loss: 2.4392 - accuracy50: 0.5990 - val_loss: 2.7146 - val_accuracy50: 0.5586 - 74s/epoch - 39ms/step
Epoch 9/50
1876/1876 - 73s - loss: 2.4277 - accuracy50: 0.6005 - val_loss: 2.7062 - val_accuracy50: 0.5512 - 73s/epoch - 39ms/step
Epoch 10/50
1876/1876 - 74s - loss: 2.4190 - accuracy50: 0.6019 - val_loss: 2.7761 - val_accuracy50: 0.5441 - 74s/epoch - 39ms/step
Epoch 11/50
1876/1876 - 74s - loss: 2.4099 - accuracy50: 0.6034 - val_loss: 2.7483 - val_accuracy50: 0.5415 - 74s/epoch - 39ms/step
Epoch 12/50
1876/1876 - 74s - loss: 2.4008 - accuracy50: 0.6046 - val_loss: 2.7429 - val_accuracy50: 0.5387 - 74s/epoch - 40ms/step
Epoch 13/50
1876/1876 - 74s - loss: 2.3947 - accuracy50: 0.6056 - val_loss: 2.8093 - val_accuracy50: 0.5272 - 74s/epoch - 39ms/step
Epoch 14/50
1876/1876 - 74s - loss: 2.3874 - accuracy50: 0.6067 - val_loss: 2.7938 - val_accuracy50: 0.5250 - 74s/epoch - 40ms/step
Epoch 15/50
1876/1876 - 74s - loss: 2.3815 - accuracy50: 0.6073 - val_loss: 2.7603 - val_accuracy50: 0.5334 - 74s/epoch - 40ms/step
testing model: results/EXC/W3/deepLOB_L2/h50
Evaluating performance on  test set...
5098/5098 - 68s - 68s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8974248
{'0': {'precision': 0.46368971579325485, 'recall': 0.6133122726643424, 'f1-score': 0.5281078335083145, 'support': 317812}, '1': {'precision': 0.6791070370135656, 'recall': 0.5397159989808434, 'f1-score': 0.6014407704358132, 'support': 675068}, '2': {'precision': 0.46132363335459514, 'recall': 0.5145642580384642, 'f1-score': 0.48649164562101466, 'support': 312031}, 'accuracy': 0.5516261262262331, 'macro avg': {'precision': 0.5347067953871385, 'recall': 0.5558641765612167, 'f1-score': 0.5386800831883808, 'support': 1304911}, 'weighted avg': {'precision': 0.5745655143206144, 'recall': 0.5516261262262331, 'f1-score': 0.5560937868362508, 'support': 1304911}}
[[194918  84563  38331]
 [161572 364345 149151]
 [ 63873  87598 160560]]
Evaluating performance on  train set...
1876/1876 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85616094
{'0': {'precision': 0.46783849368311997, 'recall': 0.5879448798944434, 'f1-score': 0.5210600088282441, 'support': 114441}, '1': {'precision': 0.6828602551215676, 'recall': 0.6517121376935211, 'f1-score': 0.6669227072388284, 'support': 249133}, '2': {'precision': 0.5255381932121237, 'recall': 0.4443596580727581, 'f1-score': 0.4815516840882695, 'support': 116633}, 'accuracy': 0.5861534713154952, 'macro avg': {'precision': 0.5587456473389371, 'recall': 0.5613388918869076, 'f1-score': 0.5565114667184473, 'support': 480207}, 'weighted avg': {'precision': 0.5934066456417775, 'recall': 0.5861534713154952, 'f1-score': 0.5871382567582548, 'support': 480207}}
[[ 67285  35009  12147]
 [ 52127 162363  34643]
 [ 24409  40397  51827]]
Evaluating performance on  val set...
619/619 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8521824
{'0': {'precision': 0.45537406011288617, 'recall': 0.6351573149358778, 'f1-score': 0.5304462978881583, 'support': 35947}, '1': {'precision': 0.6810078641385632, 'recall': 0.6603702967286167, 'f1-score': 0.6705303223737731, 'support': 85499}, '2': {'precision': 0.5572754195459032, 'recall': 0.38219682608460165, 'f1-score': 0.45342243498096413, 'support': 36926}, 'accuracy': 0.5897885989947718, 'macro avg': {'precision': 0.5645524479324507, 'recall': 0.5592414792496987, 'f1-score': 0.5514663517476318, 'support': 158372}, 'weighted avg': {'precision': 0.6009444526621684, 'recall': 0.5897885989947718, 'f1-score': 0.5881134413717571, 'support': 158372}}
[[22832 10439  2676]
 [20502 56461  8536]
 [ 6805 16008 14113]]
training model: results/EXC/W3/deepLOB_L2/h100
Epoch 1/50
1876/1876 - 81s - loss: 3.1108 - accuracy100: 0.4487 - val_loss: 3.2143 - val_accuracy100: 0.4175 - 81s/epoch - 43ms/step
Epoch 2/50
1876/1876 - 77s - loss: 3.0127 - accuracy100: 0.4779 - val_loss: 3.2564 - val_accuracy100: 0.4113 - 77s/epoch - 41ms/step
Epoch 3/50
1876/1876 - 76s - loss: 2.9813 - accuracy100: 0.4875 - val_loss: 3.1848 - val_accuracy100: 0.4373 - 76s/epoch - 40ms/step
Epoch 4/50
1876/1876 - 74s - loss: 2.9512 - accuracy100: 0.4965 - val_loss: 3.2154 - val_accuracy100: 0.4381 - 74s/epoch - 40ms/step
Epoch 5/50
1876/1876 - 75s - loss: 2.9185 - accuracy100: 0.5063 - val_loss: 3.1549 - val_accuracy100: 0.4431 - 75s/epoch - 40ms/step
Epoch 6/50
1876/1876 - 74s - loss: 2.8913 - accuracy100: 0.5128 - val_loss: 3.1636 - val_accuracy100: 0.4442 - 74s/epoch - 40ms/step
Epoch 7/50
1876/1876 - 74s - loss: 2.8732 - accuracy100: 0.5161 - val_loss: 3.1154 - val_accuracy100: 0.4521 - 74s/epoch - 39ms/step
Epoch 8/50
1876/1876 - 74s - loss: 2.8547 - accuracy100: 0.5206 - val_loss: 3.1323 - val_accuracy100: 0.4479 - 74s/epoch - 40ms/step
Epoch 9/50
1876/1876 - 74s - loss: 2.8403 - accuracy100: 0.5238 - val_loss: 3.1743 - val_accuracy100: 0.4422 - 74s/epoch - 40ms/step
Epoch 10/50
1876/1876 - 74s - loss: 2.8296 - accuracy100: 0.5258 - val_loss: 3.1746 - val_accuracy100: 0.4463 - 74s/epoch - 40ms/step
Epoch 11/50
1876/1876 - 74s - loss: 2.8167 - accuracy100: 0.5286 - val_loss: 3.2108 - val_accuracy100: 0.4412 - 74s/epoch - 39ms/step
Epoch 12/50
1876/1876 - 75s - loss: 2.8073 - accuracy100: 0.5309 - val_loss: 3.2576 - val_accuracy100: 0.4429 - 75s/epoch - 40ms/step
Epoch 13/50
1876/1876 - 74s - loss: 2.7976 - accuracy100: 0.5329 - val_loss: 3.2587 - val_accuracy100: 0.4351 - 74s/epoch - 39ms/step
Epoch 14/50
1876/1876 - 74s - loss: 2.7881 - accuracy100: 0.5353 - val_loss: 3.3818 - val_accuracy100: 0.4262 - 74s/epoch - 39ms/step
Epoch 15/50
1876/1876 - 74s - loss: 2.7801 - accuracy100: 0.5371 - val_loss: 3.3319 - val_accuracy100: 0.4340 - 74s/epoch - 39ms/step
Epoch 16/50
1876/1876 - 74s - loss: 2.7699 - accuracy100: 0.5398 - val_loss: 3.3230 - val_accuracy100: 0.4329 - 74s/epoch - 39ms/step
Epoch 17/50
1876/1876 - 74s - loss: 2.7627 - accuracy100: 0.5410 - val_loss: 3.3112 - val_accuracy100: 0.4314 - 74s/epoch - 39ms/step
testing model: results/EXC/W3/deepLOB_L2/h100
Evaluating performance on  test set...
5098/5098 - 68s - 68s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0928394
{'0': {'precision': 0.5131047112726825, 'recall': 0.36094186753575747, 'f1-score': 0.4237782681573705, 'support': 416067}, '1': {'precision': 0.4868884365667761, 'recall': 0.20321042416375396, 'f1-score': 0.28674386046782946, 'support': 483799}, '2': {'precision': 0.3823529048794966, 'recall': 0.7649125405819106, 'f1-score': 0.5098498050773683, 'support': 405045}, 'accuracy': 0.42785523303888157, 'macro avg': {'precision': 0.46078201757298504, 'recall': 0.443021610760474, 'f1-score': 0.40679064456752273, 'support': 1304911}, 'weighted avg': {'precision': 0.46279953880730307, 'recall': 0.42785523303888157, 'f1-score': 0.39968906687541966, 'support': 1304911}}
[[150176  56639 209252]
 [ 94253  98313 291233]
 [ 48252  46969 309824]]
Evaluating performance on  train set...
1876/1876 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0188997
{'0': {'precision': 0.4602844157748131, 'recall': 0.41616075925876833, 'f1-score': 0.437111909336452, 'support': 150884}, '1': {'precision': 0.49074398689617516, 'recall': 0.4809017999954944, 'f1-score': 0.4857730457316293, 'support': 177556}, '2': {'precision': 0.4655284112325669, 'recall': 0.520818096160562, 'f1-score': 0.4916236211706095, 'support': 151767}, 'accuracy': 0.4731751099005221, 'macro avg': {'precision': 0.47218560463451836, 'recall': 0.4726268851382749, 'f1-score': 0.47150285874623027, 'support': 480207}, 'weighted avg': {'precision': 0.47320414636737307, 'recall': 0.4731751099005221, 'f1-score': 0.4723324615227315, 'support': 480207}}
[[62792 43221 44871]
 [46291 85387 45878]
 [27337 45387 79043]]
Evaluating performance on  val set...
619/619 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0392433
{'0': {'precision': 0.3947570430644047, 'recall': 0.640557204841288, 'f1-score': 0.48847867902573394, 'support': 48169}, '1': {'precision': 0.49712761994392485, 'recall': 0.4158466181197927, 'f1-score': 0.4528689439607055, 'support': 60972}, '2': {'precision': 0.5297017838189475, 'recall': 0.3142532144380573, 'f1-score': 0.39447716667941557, 'support': 49231}, 'accuracy': 0.4526115727527593, 'macro avg': {'precision': 0.4738621489424257, 'recall': 0.456885679133046, 'f1-score': 0.44527492988861833, 'support': 158372}, 'weighted avg': {'precision': 0.4761174056637594, 'recall': 0.4526115727527593, 'f1-score': 0.44554820381100835, 'support': 158372}}
[[30855 10928  6386]
 [28267 25355  7350]
 [19040 14720 15471]]
training model: results/EXC/W3/deepLOB_L2/h200
Epoch 1/50
1876/1876 - 77s - loss: 3.2390 - accuracy200: 0.4031 - val_loss: 3.2821 - val_accuracy200: 0.3762 - 77s/epoch - 41ms/step
Epoch 2/50
1876/1876 - 74s - loss: 3.1878 - accuracy200: 0.4208 - val_loss: 3.2487 - val_accuracy200: 0.3980 - 74s/epoch - 40ms/step
Epoch 3/50
1876/1876 - 74s - loss: 3.1687 - accuracy200: 0.4285 - val_loss: 3.2948 - val_accuracy200: 0.3855 - 74s/epoch - 39ms/step
Epoch 4/50
1876/1876 - 74s - loss: 3.1580 - accuracy200: 0.4318 - val_loss: 3.3524 - val_accuracy200: 0.3739 - 74s/epoch - 40ms/step
Epoch 5/50
1876/1876 - 75s - loss: 3.1482 - accuracy200: 0.4367 - val_loss: 3.3629 - val_accuracy200: 0.3737 - 75s/epoch - 40ms/step
Epoch 6/50
1876/1876 - 73s - loss: 3.1392 - accuracy200: 0.4401 - val_loss: 3.3359 - val_accuracy200: 0.3749 - 73s/epoch - 39ms/step
Epoch 7/50
1876/1876 - 74s - loss: 3.1305 - accuracy200: 0.4431 - val_loss: 3.4342 - val_accuracy200: 0.3580 - 74s/epoch - 40ms/step
Epoch 8/50
1876/1876 - 74s - loss: 3.1231 - accuracy200: 0.4467 - val_loss: 3.4499 - val_accuracy200: 0.3628 - 74s/epoch - 40ms/step
Epoch 9/50
1876/1876 - 74s - loss: 3.1159 - accuracy200: 0.4493 - val_loss: 3.5072 - val_accuracy200: 0.3563 - 74s/epoch - 39ms/step
Epoch 10/50
1876/1876 - 74s - loss: 3.1053 - accuracy200: 0.4519 - val_loss: 3.5549 - val_accuracy200: 0.3535 - 74s/epoch - 39ms/step
Epoch 11/50
1876/1876 - 74s - loss: 3.0944 - accuracy200: 0.4568 - val_loss: 3.5719 - val_accuracy200: 0.3529 - 74s/epoch - 39ms/step
Epoch 12/50
1876/1876 - 74s - loss: 3.0880 - accuracy200: 0.4589 - val_loss: 3.5162 - val_accuracy200: 0.3561 - 74s/epoch - 39ms/step
testing model: results/EXC/W3/deepLOB_L2/h200
Evaluating performance on  test set...
5098/5098 - 67s - 67s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.091109
{'0': {'precision': 0.4525388790997482, 'recall': 0.2713199159337788, 'f1-score': 0.33924519941330056, 'support': 445839}, '1': {'precision': 0.36909024701098503, 'recall': 0.22129231217080425, 'f1-score': 0.2766912161970029, 'support': 439708}, '2': {'precision': 0.3749147260380167, 'recall': 0.6919406529888116, 'f1-score': 0.4863240987480517, 'support': 419364}, 'accuracy': 0.3896388336062766, 'macro avg': {'precision': 0.39884795071624995, 'recall': 0.39485096036446493, 'f1-score': 0.3674201714527851, 'support': 1304911}, 'weighted avg': {'precision': 0.39947333942457813, 'recall': 0.3896388336062766, 'f1-score': 0.3654340419386121, 'support': 1304911}}
[[120965  90642 234232]
 [ 92835  97304 249569]
 [ 53503  75686 290175]]
Evaluating performance on  train set...
1876/1876 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0791416
{'0': {'precision': 0.41868030007311835, 'recall': 0.44627526066118034, 'f1-score': 0.43203759483368087, 'support': 162951}, '1': {'precision': 0.3625412798177542, 'recall': 0.28619482880190444, 'f1-score': 0.3198756416744994, 'support': 154587}, '2': {'precision': 0.4229766428342991, 'recall': 0.47969803711832004, 'f1-score': 0.4495552380513435, 'support': 162669}, 'accuracy': 0.40606446803149476, 'macro avg': {'precision': 0.40139940757505727, 'recall': 0.4040560421938016, 'f1-score': 0.4004894915198412, 'support': 480207}, 'weighted avg': {'precision': 0.40206354741520733, 'recall': 0.40606446803149476, 'f1-score': 0.40186476863905146, 'support': 480207}}
[[72721 36585 53645]
 [57539 44242 52806]
 [43431 41206 78032]]
Evaluating performance on  val set...
619/619 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0824741
{'0': {'precision': 0.3910249936884625, 'recall': 0.6008534574726021, 'f1-score': 0.4737449818390365, 'support': 51555}, '1': {'precision': 0.37243303283134865, 'recall': 0.26559333898242643, 'f1-score': 0.3100678501919376, 'support': 54286}, '2': {'precision': 0.43411063577239795, 'recall': 0.33418362490719766, 'f1-score': 0.37764870388297306, 'support': 52531}, 'accuracy': 0.3974818781097669, 'macro avg': {'precision': 0.39918955409740303, 'recall': 0.40021014045407544, 'f1-score': 0.387153845304649, 'support': 158372}, 'weighted avg': {'precision': 0.39894336737334324, 'recall': 0.3974818781097669, 'f1-score': 0.38576598084198915, 'support': 158372}}
[[30977  9403 11175]
 [28159 14418 11709]
 [20084 14892 17555]]
training model: results/EXC/W3/deepLOB_L2/h300
Epoch 1/50
1876/1876 - 79s - loss: 3.2607 - accuracy300: 0.3917 - val_loss: 3.3636 - val_accuracy300: 0.3514 - 79s/epoch - 42ms/step
Epoch 2/50
1876/1876 - 74s - loss: 3.2165 - accuracy300: 0.4118 - val_loss: 3.5557 - val_accuracy300: 0.3305 - 74s/epoch - 40ms/step
Epoch 3/50
1876/1876 - 75s - loss: 3.1985 - accuracy300: 0.4195 - val_loss: 3.5583 - val_accuracy300: 0.3312 - 75s/epoch - 40ms/step
Epoch 4/50
1876/1876 - 74s - loss: 3.1864 - accuracy300: 0.4257 - val_loss: 3.5433 - val_accuracy300: 0.3339 - 74s/epoch - 39ms/step
Epoch 5/50
1876/1876 - 75s - loss: 3.1736 - accuracy300: 0.4317 - val_loss: 3.6239 - val_accuracy300: 0.3319 - 75s/epoch - 40ms/step
Epoch 6/50
1876/1876 - 74s - loss: 3.1651 - accuracy300: 0.4354 - val_loss: 3.6327 - val_accuracy300: 0.3325 - 74s/epoch - 40ms/step
Epoch 7/50
1876/1876 - 75s - loss: 3.1544 - accuracy300: 0.4402 - val_loss: 3.7306 - val_accuracy300: 0.3321 - 75s/epoch - 40ms/step
Epoch 8/50
1876/1876 - 76s - loss: 3.1435 - accuracy300: 0.4445 - val_loss: 3.7292 - val_accuracy300: 0.3320 - 76s/epoch - 41ms/step
Epoch 9/50
1876/1876 - 75s - loss: 3.1357 - accuracy300: 0.4483 - val_loss: 3.8007 - val_accuracy300: 0.3305 - 75s/epoch - 40ms/step
Epoch 10/50
1876/1876 - 75s - loss: 3.1252 - accuracy300: 0.4529 - val_loss: 3.9345 - val_accuracy300: 0.3301 - 75s/epoch - 40ms/step
Epoch 11/50
1876/1876 - 75s - loss: 3.1179 - accuracy300: 0.4553 - val_loss: 4.0091 - val_accuracy300: 0.3294 - 75s/epoch - 40ms/step
testing model: results/EXC/W3/deepLOB_L2/h300
Evaluating performance on  test set...
5098/5098 - 68s - 68s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.120944
{'0': {'precision': 0.3773834274589143, 'recall': 0.15927502402855967, 'f1-score': 0.22400748300859188, 'support': 466112}, '1': {'precision': 0.3417027155115911, 'recall': 0.08407412277546078, 'f1-score': 0.13494560282897147, 'support': 403061}, '2': {'precision': 0.35079190935336074, 'recall': 0.8123115266513363, 'f1-score': 0.4899861914303809, 'support': 435738}, 'accuracy': 0.35410997378365267, 'macro avg': {'precision': 0.3566260174412887, 'recall': 0.3518868911517856, 'f1-score': 0.2829797590893148, 'support': 1304911}, 'weighted avg': {'precision': 0.3574828837785578, 'recall': 0.35410997378365267, 'f1-score': 0.28531408549965487, 'support': 1304911}}
[[ 74240  33731 358141]
 [ 72253  33887 296921]
 [ 50230  31553 353955]]
Evaluating performance on  train set...
1876/1876 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1150358
{'0': {'precision': 0.35660438565487057, 'recall': 0.45381278651353085, 'f1-score': 0.399378580550005, 'support': 162296}, '1': {'precision': 0.33965711073636873, 'recall': 0.12276825396825397, 'f1-score': 0.18034958121140895, 'support': 157500}, '2': {'precision': 0.36159120059794597, 'recall': 0.48856998584885075, 'f1-score': 0.41559791384398376, 'support': 160411}, 'accuracy': 0.3568461101150129, 'macro avg': {'precision': 0.35261756566306174, 'recall': 0.35505034211021186, 'f1-score': 0.33177535853513257, 'support': 480207}, 'weighted avg': {'precision': 0.35271178136582365, 'recall': 0.3568461101150129, 'f1-score': 0.33295866596565193, 'support': 480207}}
[[73652 17284 71360]
 [71154 19336 67010]
 [61731 20308 78372]]
Evaluating performance on  val set...
619/619 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1196923
{'0': {'precision': 0.337537268387262, 'recall': 0.7241352247532717, 'f1-score': 0.4604482592992284, 'support': 50967}, '1': {'precision': 0.35858739837398373, 'recall': 0.12741487018380096, 'f1-score': 0.18802120800362346, 'support': 55386}, '2': {'precision': 0.40170357751277685, 'recall': 0.22664795555470116, 'f1-score': 0.2897909523282823, 'support': 52019}, 'accuracy': 0.3520445533301341, 'macro avg': {'precision': 0.36594274809134086, 'recall': 0.3593993501639246, 'f1-score': 0.31275347321037805, 'support': 158372}, 'weighted avg': {'precision': 0.3659750587406371, 'recall': 0.3520445533301341, 'f1-score': 0.3091205807046535, 'support': 158372}}
[[36907  5565  8495]
 [39264  7057  9065]
 [33171  7058 11790]]
training model: results/EXC/W3/deepLOB_L2/h500
Epoch 1/50
1876/1876 - 78s - loss: 3.2799 - accuracy500: 0.3829 - val_loss: 3.3278 - val_accuracy500: 0.3399 - 78s/epoch - 42ms/step
Epoch 2/50
1876/1876 - 75s - loss: 3.2303 - accuracy500: 0.4074 - val_loss: 3.3818 - val_accuracy500: 0.3417 - 75s/epoch - 40ms/step
Epoch 3/50
1876/1876 - 76s - loss: 3.2057 - accuracy500: 0.4211 - val_loss: 3.3829 - val_accuracy500: 0.3430 - 76s/epoch - 41ms/step
Epoch 4/50
1876/1876 - 77s - loss: 3.1836 - accuracy500: 0.4323 - val_loss: 3.3561 - val_accuracy500: 0.3453 - 77s/epoch - 41ms/step
Epoch 5/50
1876/1876 - 76s - loss: 3.1691 - accuracy500: 0.4386 - val_loss: 3.3752 - val_accuracy500: 0.3418 - 76s/epoch - 40ms/step
Epoch 6/50
1876/1876 - 75s - loss: 3.1535 - accuracy500: 0.4443 - val_loss: 3.3805 - val_accuracy500: 0.3451 - 75s/epoch - 40ms/step
Epoch 7/50
1876/1876 - 74s - loss: 3.1438 - accuracy500: 0.4492 - val_loss: 3.3812 - val_accuracy500: 0.3490 - 74s/epoch - 39ms/step
Epoch 8/50
1876/1876 - 74s - loss: 3.1321 - accuracy500: 0.4529 - val_loss: 3.4064 - val_accuracy500: 0.3492 - 74s/epoch - 39ms/step
Epoch 9/50
1876/1876 - 75s - loss: 3.1223 - accuracy500: 0.4565 - val_loss: 3.4520 - val_accuracy500: 0.3475 - 75s/epoch - 40ms/step
Epoch 10/50
1876/1876 - 76s - loss: 3.1093 - accuracy500: 0.4618 - val_loss: 3.4930 - val_accuracy500: 0.3494 - 76s/epoch - 40ms/step
Epoch 11/50
1876/1876 - 77s - loss: 3.0996 - accuracy500: 0.4646 - val_loss: 3.5860 - val_accuracy500: 0.3463 - 77s/epoch - 41ms/step
testing model: results/EXC/W3/deepLOB_L2/h500
Evaluating performance on  test set...
5098/5098 - 68s - 68s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1235116
{'0': {'precision': 0.38489662128088753, 'recall': 0.046190190069033486, 'f1-score': 0.08248198565027268, 'support': 462674}, '1': {'precision': 0.3300299736892653, 'recall': 0.35065449747503513, 'f1-score': 0.3400297773144728, 'support': 421392}, '2': {'precision': 0.3366996772950162, 'recall': 0.641373902505673, 'f1-score': 0.44158310879455803, 'support': 420845}, 'accuracy': 0.33646202691218025, 'macro avg': {'precision': 0.3505420907550563, 'recall': 0.3460728633499139, 'f1-score': 0.28803162391976783, 'support': 1304911}, 'weighted avg': {'precision': 0.35163472889614794, 'recall': 0.33646202691218025, 'f1-score': 0.28146451487611057, 'support': 1304911}}
[[ 21371 163069 278234]
 [ 20121 147763 253508]
 [ 14032 136894 269919]]
Evaluating performance on  train set...
1876/1876 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1184069
{'0': {'precision': 0.3662392170016599, 'recall': 0.2579912272198527, 'f1-score': 0.30272956381719496, 'support': 165056}, '1': {'precision': 0.3291342576936084, 'recall': 0.3527112468693981, 'f1-score': 0.3405151273760992, 'support': 154523}, '2': {'precision': 0.3520600572742306, 'recall': 0.434724954553378, 'f1-score': 0.3890498423275353, 'support': 160628}, 'accuracy': 0.34758760284627255, 'macro avg': {'precision': 0.34914451065649965, 'recall': 0.3484758095475429, 'f1-score': 0.34409817784027646, 'support': 480207}, 'weighted avg': {'precision': 0.3495565370410272, 'recall': 0.34758760284627255, 'f1-score': 0.3437622691596233, 'support': 480207}}
[[42583 55676 66797]
 [38303 54502 61718]
 [35385 55414 69829]]
Evaluating performance on  val set...
619/619 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1100177
{'0': {'precision': 0.3484313725490196, 'recall': 0.27269762713164913, 'f1-score': 0.3059474233571144, 'support': 52131}, '1': {'precision': 0.3216374269005848, 'recall': 0.500326258012513, 'f1-score': 0.3915590267347551, 'support': 52106}, '2': {'precision': 0.36787337751245963, 'recall': 0.2481573843169853, 'f1-score': 0.2963829106593273, 'support': 54135}, 'accuracy': 0.339201373980249, 'macro avg': {'precision': 0.3459807256540213, 'recall': 0.34039375648704917, 'f1-score': 0.3312964535837323, 'support': 158372}, 'weighted avg': {'precision': 0.3462615925799499, 'recall': 0.339201373980249, 'f1-score': 0.33084515345271615, 'support': 158372}}
[[14216 26579 11336]
 [14288 26070 11748]
 [12296 28405 13434]]
training model: results/EXC/W3/deepLOB_L2/h1000
Epoch 1/50
1876/1876 - 77s - loss: 3.2141 - accuracy1000: 0.4336 - val_loss: 3.4847 - val_accuracy1000: 0.3214 - 77s/epoch - 41ms/step
Epoch 2/50
1876/1876 - 74s - loss: 3.1797 - accuracy1000: 0.4476 - val_loss: 3.4808 - val_accuracy1000: 0.3114 - 74s/epoch - 40ms/step
Epoch 3/50
1876/1876 - 74s - loss: 3.1481 - accuracy1000: 0.4567 - val_loss: 3.4343 - val_accuracy1000: 0.3393 - 74s/epoch - 39ms/step
Epoch 4/50
1876/1876 - 74s - loss: 3.1350 - accuracy1000: 0.4656 - val_loss: 3.3515 - val_accuracy1000: 0.3704 - 74s/epoch - 40ms/step
Epoch 5/50
1876/1876 - 74s - loss: 3.1272 - accuracy1000: 0.4639 - val_loss: 3.3518 - val_accuracy1000: 0.3474 - 74s/epoch - 39ms/step
Epoch 6/50
1876/1876 - 74s - loss: 3.1057 - accuracy1000: 0.4730 - val_loss: 3.3470 - val_accuracy1000: 0.3432 - 74s/epoch - 39ms/step
Epoch 7/50
1876/1876 - 74s - loss: 3.0922 - accuracy1000: 0.4773 - val_loss: 3.3581 - val_accuracy1000: 0.3585 - 74s/epoch - 39ms/step
Epoch 8/50
1876/1876 - 74s - loss: 3.0817 - accuracy1000: 0.4814 - val_loss: 3.3377 - val_accuracy1000: 0.3503 - 74s/epoch - 39ms/step
Epoch 9/50
1876/1876 - 74s - loss: 3.0702 - accuracy1000: 0.4841 - val_loss: 3.3568 - val_accuracy1000: 0.3465 - 74s/epoch - 40ms/step
Epoch 10/50
1876/1876 - 74s - loss: 3.0563 - accuracy1000: 0.4868 - val_loss: 3.3419 - val_accuracy1000: 0.3340 - 74s/epoch - 39ms/step
Epoch 11/50
1876/1876 - 74s - loss: 3.0380 - accuracy1000: 0.4962 - val_loss: 3.3354 - val_accuracy1000: 0.3525 - 74s/epoch - 40ms/step
Epoch 12/50
1876/1876 - 74s - loss: 3.0247 - accuracy1000: 0.5000 - val_loss: 3.3542 - val_accuracy1000: 0.3539 - 74s/epoch - 39ms/step
Epoch 13/50
1876/1876 - 74s - loss: 3.0130 - accuracy1000: 0.5048 - val_loss: 3.3556 - val_accuracy1000: 0.3602 - 74s/epoch - 40ms/step
Epoch 14/50
1876/1876 - 73s - loss: 3.0070 - accuracy1000: 0.5053 - val_loss: 3.3660 - val_accuracy1000: 0.3586 - 73s/epoch - 39ms/step
Epoch 15/50
1876/1876 - 74s - loss: 2.9822 - accuracy1000: 0.5134 - val_loss: 3.3517 - val_accuracy1000: 0.3604 - 74s/epoch - 39ms/step
Epoch 16/50
1876/1876 - 74s - loss: 2.9796 - accuracy1000: 0.5138 - val_loss: 3.3904 - val_accuracy1000: 0.3650 - 74s/epoch - 39ms/step
Epoch 17/50
1876/1876 - 74s - loss: 2.9621 - accuracy1000: 0.5187 - val_loss: 3.4100 - val_accuracy1000: 0.3605 - 74s/epoch - 40ms/step
Epoch 18/50
1876/1876 - 74s - loss: 2.9488 - accuracy1000: 0.5224 - val_loss: 3.4363 - val_accuracy1000: 0.3594 - 74s/epoch - 40ms/step
Epoch 19/50
1876/1876 - 74s - loss: 2.9310 - accuracy1000: 0.5274 - val_loss: 3.4417 - val_accuracy1000: 0.3646 - 74s/epoch - 39ms/step
Epoch 20/50
1876/1876 - 74s - loss: 2.9215 - accuracy1000: 0.5304 - val_loss: 3.4051 - val_accuracy1000: 0.3620 - 74s/epoch - 39ms/step
Epoch 21/50
1876/1876 - 73s - loss: 2.9115 - accuracy1000: 0.5330 - val_loss: 3.4282 - val_accuracy1000: 0.3646 - 73s/epoch - 39ms/step
testing model: results/EXC/W3/deepLOB_L2/h1000
Evaluating performance on  test set...
5098/5098 - 67s - 67s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1720021
{'0': {'precision': 0.406919010760808, 'recall': 0.08251805543060264, 'f1-score': 0.13721137120658733, 'support': 522419}, '1': {'precision': 0.24152508084698981, 'recall': 0.768734038558808, 'f1-score': 0.36756619612986696, 'support': 322261}, '2': {'precision': 0.3395433663457765, 'recall': 0.12783145855016284, 'f1-score': 0.1857366783530834, 'support': 460231}, 'accuracy': 0.2679677004791898, 'macro avg': {'precision': 0.32932915265119145, 'recall': 0.3263611841798578, 'f1-score': 0.23017141522984588, 'support': 1304911}, 'weighted avg': {'precision': 0.34231048692069066, 'recall': 0.2679677004791898, 'f1-score': 0.21121429314374632, 'support': 1304911}}
[[ 43109 409685  69625]
 [ 29717 247733  44811]
 [ 33114 368285  58832]]
Evaluating performance on  train set...
1876/1876 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1331043
{'0': {'precision': 0.37261252429054115, 'recall': 0.12726011671290538, 'f1-score': 0.18972317922707682, 'support': 167248}, '1': {'precision': 0.3235284185967982, 'recall': 0.6925462777387156, 'f1-score': 0.44102742219637014, 'support': 152179}, '2': {'precision': 0.3504022356700332, 'recall': 0.21212215449682797, 'f1-score': 0.26426614905990065, 'support': 160780}, 'accuracy': 0.3348139448196299, 'macro avg': {'precision': 0.3488477261857908, 'recall': 0.3439761829828163, 'f1-score': 0.2983389168277825, 'support': 480207}, 'weighted avg': {'precision': 0.34962131357355164, 'recall': 0.3348139448196299, 'f1-score': 0.29432025315674776, 'support': 480207}}
[[ 21284 112976  32988]
 [ 16550 105391  30238]
 [ 19287 107388  34105]]
Evaluating performance on  val set...
619/619 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1122966
{'0': {'precision': 0.3301069544596622, 'recall': 0.13846372457472292, 'f1-score': 0.19509474436896676, 'support': 49262}, '1': {'precision': 0.3655231445415813, 'recall': 0.6528333648247076, 'f1-score': 0.4686486553140066, 'support': 58217}, '2': {'precision': 0.3177991224949603, 'recall': 0.210638005226652, 'f1-score': 0.2533530280649926, 'support': 50893}, 'accuracy': 0.35073750410426086, 'macro avg': {'precision': 0.3378097404987346, 'recall': 0.33397836487536087, 'f1-score': 0.30569880924932197, 'support': 158372}, 'weighted avg': {'precision': 0.3391706895000703, 'recall': 0.35073750410426086, 'f1-score': 0.31437357437445523, 'support': 158372}}
[[ 6821 32047 10394]
 [ 7593 38006 12618]
 [ 6249 33924 10720]]
training model: results/EXC/W3/deepOF_L2/h10
Epoch 1/50
1876/1876 - 44s - loss: 2.5273 - accuracy10: 0.5629 - val_loss: 2.0558 - val_accuracy10: 0.7210 - 44s/epoch - 24ms/step
Epoch 2/50
1876/1876 - 43s - loss: 2.1333 - accuracy10: 0.6397 - val_loss: 1.9162 - val_accuracy10: 0.6971 - 43s/epoch - 23ms/step
Epoch 3/50
1876/1876 - 42s - loss: 2.0592 - accuracy10: 0.6474 - val_loss: 1.8849 - val_accuracy10: 0.7076 - 42s/epoch - 22ms/step
Epoch 4/50
1876/1876 - 41s - loss: 2.0205 - accuracy10: 0.6514 - val_loss: 1.8730 - val_accuracy10: 0.7062 - 41s/epoch - 22ms/step
Epoch 5/50
1876/1876 - 41s - loss: 1.9950 - accuracy10: 0.6549 - val_loss: 1.8678 - val_accuracy10: 0.7166 - 41s/epoch - 22ms/step
Epoch 6/50
1876/1876 - 63s - loss: 1.9777 - accuracy10: 0.6574 - val_loss: 1.8258 - val_accuracy10: 0.7057 - 63s/epoch - 33ms/step
Epoch 7/50
1876/1876 - 41s - loss: 1.9644 - accuracy10: 0.6585 - val_loss: 1.8371 - val_accuracy10: 0.7195 - 41s/epoch - 22ms/step
Epoch 8/50
1876/1876 - 41s - loss: 1.9536 - accuracy10: 0.6603 - val_loss: 1.8188 - val_accuracy10: 0.7127 - 41s/epoch - 22ms/step
Epoch 9/50
1876/1876 - 41s - loss: 1.9430 - accuracy10: 0.6611 - val_loss: 1.8111 - val_accuracy10: 0.7142 - 41s/epoch - 22ms/step
Epoch 10/50
1876/1876 - 40s - loss: 1.9343 - accuracy10: 0.6627 - val_loss: 1.8155 - val_accuracy10: 0.7134 - 40s/epoch - 22ms/step
Epoch 11/50
1876/1876 - 40s - loss: 1.9285 - accuracy10: 0.6636 - val_loss: 1.8075 - val_accuracy10: 0.7093 - 40s/epoch - 22ms/step
Epoch 12/50
1876/1876 - 41s - loss: 1.9214 - accuracy10: 0.6642 - val_loss: 1.8038 - val_accuracy10: 0.7136 - 41s/epoch - 22ms/step
Epoch 13/50
1876/1876 - 41s - loss: 1.9145 - accuracy10: 0.6643 - val_loss: 1.8034 - val_accuracy10: 0.7114 - 41s/epoch - 22ms/step
Epoch 14/50
1876/1876 - 41s - loss: 1.9090 - accuracy10: 0.6650 - val_loss: 1.8000 - val_accuracy10: 0.7216 - 41s/epoch - 22ms/step
Epoch 15/50
1876/1876 - 40s - loss: 1.9030 - accuracy10: 0.6659 - val_loss: 1.7992 - val_accuracy10: 0.7100 - 40s/epoch - 22ms/step
Epoch 16/50
1876/1876 - 41s - loss: 1.8958 - accuracy10: 0.6664 - val_loss: 1.7982 - val_accuracy10: 0.7197 - 41s/epoch - 22ms/step
Epoch 17/50
1876/1876 - 40s - loss: 1.8919 - accuracy10: 0.6673 - val_loss: 1.8024 - val_accuracy10: 0.7202 - 40s/epoch - 22ms/step
Epoch 18/50
1876/1876 - 41s - loss: 1.8865 - accuracy10: 0.6674 - val_loss: 1.7884 - val_accuracy10: 0.7113 - 41s/epoch - 22ms/step
Epoch 19/50
1876/1876 - 41s - loss: 1.8813 - accuracy10: 0.6681 - val_loss: 1.7823 - val_accuracy10: 0.7038 - 41s/epoch - 22ms/step
Epoch 20/50
1876/1876 - 40s - loss: 1.8780 - accuracy10: 0.6687 - val_loss: 1.7916 - val_accuracy10: 0.7133 - 40s/epoch - 22ms/step
Epoch 21/50
1876/1876 - 41s - loss: 1.8726 - accuracy10: 0.6690 - val_loss: 1.7789 - val_accuracy10: 0.7116 - 41s/epoch - 22ms/step
Epoch 22/50
1876/1876 - 41s - loss: 1.8676 - accuracy10: 0.6698 - val_loss: 1.7871 - val_accuracy10: 0.7106 - 41s/epoch - 22ms/step
Epoch 23/50
1876/1876 - 42s - loss: 1.8644 - accuracy10: 0.6706 - val_loss: 1.7846 - val_accuracy10: 0.7140 - 42s/epoch - 22ms/step
Epoch 24/50
1876/1876 - 41s - loss: 1.8609 - accuracy10: 0.6711 - val_loss: 1.7945 - val_accuracy10: 0.7204 - 41s/epoch - 22ms/step
Epoch 25/50
1876/1876 - 41s - loss: 1.8545 - accuracy10: 0.6716 - val_loss: 1.7949 - val_accuracy10: 0.7172 - 41s/epoch - 22ms/step
Epoch 26/50
1876/1876 - 41s - loss: 1.8533 - accuracy10: 0.6712 - val_loss: 1.7876 - val_accuracy10: 0.7188 - 41s/epoch - 22ms/step
Epoch 27/50
1876/1876 - 40s - loss: 1.8460 - accuracy10: 0.6717 - val_loss: 1.8072 - val_accuracy10: 0.7161 - 40s/epoch - 21ms/step
Epoch 28/50
1876/1876 - 40s - loss: 1.8424 - accuracy10: 0.6727 - val_loss: 1.8106 - val_accuracy10: 0.7141 - 40s/epoch - 22ms/step
Epoch 29/50
1876/1876 - 40s - loss: 1.8385 - accuracy10: 0.6728 - val_loss: 1.7918 - val_accuracy10: 0.7169 - 40s/epoch - 22ms/step
Epoch 30/50
1876/1876 - 41s - loss: 1.8339 - accuracy10: 0.6730 - val_loss: 1.8064 - val_accuracy10: 0.7168 - 41s/epoch - 22ms/step
Epoch 31/50
1876/1876 - 41s - loss: 1.8311 - accuracy10: 0.6738 - val_loss: 1.8127 - val_accuracy10: 0.7161 - 41s/epoch - 22ms/step
testing model: results/EXC/W3/deepOF_L2/h10
Evaluating performance on  test set...
5098/5098 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.637186
{'0': {'precision': 0.3770074389091857, 'recall': 0.7265342076930605, 'f1-score': 0.49641769617961895, 'support': 153255}, '1': {'precision': 0.9327525997954892, 'recall': 0.677123423208017, 'f1-score': 0.7846425741546977, 'support': 999577}, '2': {'precision': 0.36869131558742524, 'recall': 0.6883708696366925, 'f1-score': 0.48019192264379856, 'support': 152075}, 'accuracy': 0.6842372674834298, 'macro avg': {'precision': 0.5594837847640334, 'recall': 0.69734283351259, 'f1-score': 0.5870840643260384, 'support': 1304907}, 'weighted avg': {'precision': 0.8017468312406637, 'recall': 0.6842372674834298, 'f1-score': 0.7153110152753365, 'support': 1304907}}
[[111345  23145  18765]
 [162255 676837 160485]
 [ 21739  25652 104684]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.654124
{'0': {'precision': 0.37631930122528207, 'recall': 0.7129017430965597, 'f1-score': 0.49260650480989465, 'support': 56566}, '1': {'precision': 0.9371125661195229, 'recall': 0.6756980492869242, 'f1-score': 0.7852194508648498, 'support': 366020}, '2': {'precision': 0.3728855493448181, 'recall': 0.7062427324320103, 'f1-score': 0.4880748910038441, 'support': 57619}, 'accuracy': 0.6837454836996699, 'macro avg': {'precision': 0.5621058055632077, 'recall': 0.6982808416051647, 'f1-score': 0.5886336155595295, 'support': 480205}, 'weighted avg': {'precision': 0.8033529669867581, 'recall': 0.6837454836996699, 'f1-score': 0.7150970733361364, 'support': 480205}}
[[ 40326   8013   8227]
 [ 58491 247319  60210]
 [  8342   8584  40693]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5873731
{'0': {'precision': 0.3728466873342069, 'recall': 0.7090931193775832, 'f1-score': 0.48872038708866594, 'support': 16452}, '1': {'precision': 0.9412648848901826, 'recall': 0.7108450107514849, 'f1-score': 0.8099866104365726, 'support': 125099}, '2': {'precision': 0.36889720314033364, 'recall': 0.7151180072528387, 'f1-score': 0.48671832325153247, 'support': 16821}, 'accuracy': 0.7111168640921375, 'macro avg': {'precision': 0.5610029251215743, 'recall': 0.7116853791273022, 'f1-score': 0.595141773592257, 'support': 158372}, 'weighted avg': {'precision': 0.8214241746579122, 'recall': 0.7111168640921375, 'f1-score': 0.7422778755259868, 'support': 158372}}
[[11666  2798  1988]
 [17582 88926 18591]
 [ 2041  2751 12029]]
training model: results/EXC/W3/deepOF_L2/h20
Epoch 1/50
1876/1876 - 43s - loss: 2.5743 - accuracy20: 0.5622 - val_loss: 2.2173 - val_accuracy20: 0.6615 - 43s/epoch - 23ms/step
Epoch 2/50
1876/1876 - 40s - loss: 2.2244 - accuracy20: 0.6300 - val_loss: 2.0887 - val_accuracy20: 0.6931 - 40s/epoch - 21ms/step
Epoch 3/50
1876/1876 - 40s - loss: 2.1605 - accuracy20: 0.6368 - val_loss: 2.0721 - val_accuracy20: 0.6838 - 40s/epoch - 22ms/step
Epoch 4/50
1876/1876 - 41s - loss: 2.1263 - accuracy20: 0.6419 - val_loss: 2.0975 - val_accuracy20: 0.6669 - 41s/epoch - 22ms/step
Epoch 5/50
1876/1876 - 40s - loss: 2.1061 - accuracy20: 0.6454 - val_loss: 2.0198 - val_accuracy20: 0.6934 - 40s/epoch - 22ms/step
Epoch 6/50
1876/1876 - 42s - loss: 2.0900 - accuracy20: 0.6476 - val_loss: 2.0164 - val_accuracy20: 0.6849 - 42s/epoch - 22ms/step
Epoch 7/50
1876/1876 - 42s - loss: 2.0766 - accuracy20: 0.6503 - val_loss: 2.0065 - val_accuracy20: 0.6815 - 42s/epoch - 22ms/step
Epoch 8/50
1876/1876 - 43s - loss: 2.0657 - accuracy20: 0.6517 - val_loss: 2.0102 - val_accuracy20: 0.6876 - 43s/epoch - 23ms/step
Epoch 9/50
1876/1876 - 42s - loss: 2.0582 - accuracy20: 0.6525 - val_loss: 1.9945 - val_accuracy20: 0.6901 - 42s/epoch - 22ms/step
Epoch 10/50
1876/1876 - 43s - loss: 2.0493 - accuracy20: 0.6542 - val_loss: 2.0012 - val_accuracy20: 0.6814 - 43s/epoch - 23ms/step
Epoch 11/50
1876/1876 - 42s - loss: 2.0426 - accuracy20: 0.6544 - val_loss: 1.9943 - val_accuracy20: 0.6808 - 42s/epoch - 23ms/step
Epoch 12/50
1876/1876 - 43s - loss: 2.0350 - accuracy20: 0.6558 - val_loss: 1.9875 - val_accuracy20: 0.6843 - 43s/epoch - 23ms/step
Epoch 13/50
1876/1876 - 43s - loss: 2.0312 - accuracy20: 0.6553 - val_loss: 2.0047 - val_accuracy20: 0.6900 - 43s/epoch - 23ms/step
Epoch 14/50
1876/1876 - 41s - loss: 2.0253 - accuracy20: 0.6569 - val_loss: 1.9761 - val_accuracy20: 0.6824 - 41s/epoch - 22ms/step
Epoch 15/50
1876/1876 - 41s - loss: 2.0190 - accuracy20: 0.6573 - val_loss: 1.9854 - val_accuracy20: 0.6900 - 41s/epoch - 22ms/step
Epoch 16/50
1876/1876 - 41s - loss: 2.0154 - accuracy20: 0.6583 - val_loss: 1.9960 - val_accuracy20: 0.6839 - 41s/epoch - 22ms/step
Epoch 17/50
1876/1876 - 40s - loss: 2.0082 - accuracy20: 0.6583 - val_loss: 1.9887 - val_accuracy20: 0.6862 - 40s/epoch - 21ms/step
Epoch 18/50
1876/1876 - 41s - loss: 2.0051 - accuracy20: 0.6590 - val_loss: 1.9736 - val_accuracy20: 0.6839 - 41s/epoch - 22ms/step
Epoch 19/50
1876/1876 - 41s - loss: 1.9993 - accuracy20: 0.6600 - val_loss: 1.9820 - val_accuracy20: 0.6863 - 41s/epoch - 22ms/step
Epoch 20/50
1876/1876 - 41s - loss: 1.9956 - accuracy20: 0.6598 - val_loss: 1.9842 - val_accuracy20: 0.6850 - 41s/epoch - 22ms/step
Epoch 21/50
1876/1876 - 41s - loss: 1.9920 - accuracy20: 0.6609 - val_loss: 1.9734 - val_accuracy20: 0.6869 - 41s/epoch - 22ms/step
Epoch 22/50
1876/1876 - 41s - loss: 1.9884 - accuracy20: 0.6608 - val_loss: 1.9796 - val_accuracy20: 0.6881 - 41s/epoch - 22ms/step
Epoch 23/50
1876/1876 - 40s - loss: 1.9825 - accuracy20: 0.6616 - val_loss: 1.9885 - val_accuracy20: 0.6863 - 40s/epoch - 21ms/step
Epoch 24/50
1876/1876 - 40s - loss: 1.9794 - accuracy20: 0.6615 - val_loss: 1.9979 - val_accuracy20: 0.6962 - 40s/epoch - 22ms/step
Epoch 25/50
1876/1876 - 41s - loss: 1.9759 - accuracy20: 0.6627 - val_loss: 2.0017 - val_accuracy20: 0.6859 - 41s/epoch - 22ms/step
Epoch 26/50
1876/1876 - 40s - loss: 1.9707 - accuracy20: 0.6629 - val_loss: 2.0049 - val_accuracy20: 0.6839 - 40s/epoch - 21ms/step
Epoch 27/50
1876/1876 - 41s - loss: 1.9668 - accuracy20: 0.6639 - val_loss: 2.0115 - val_accuracy20: 0.6872 - 41s/epoch - 22ms/step
Epoch 28/50
1876/1876 - 40s - loss: 1.9614 - accuracy20: 0.6649 - val_loss: 2.0042 - val_accuracy20: 0.6781 - 40s/epoch - 22ms/step
Epoch 29/50
1876/1876 - 41s - loss: 1.9610 - accuracy20: 0.6650 - val_loss: 2.0130 - val_accuracy20: 0.6779 - 41s/epoch - 22ms/step
Epoch 30/50
1876/1876 - 41s - loss: 1.9547 - accuracy20: 0.6653 - val_loss: 2.0026 - val_accuracy20: 0.6860 - 41s/epoch - 22ms/step
Epoch 31/50
1876/1876 - 41s - loss: 1.9491 - accuracy20: 0.6659 - val_loss: 2.0049 - val_accuracy20: 0.6801 - 41s/epoch - 22ms/step
testing model: results/EXC/W3/deepOF_L2/h20
Evaluating performance on  test set...
5098/5098 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69577676
{'0': {'precision': 0.43487177684219164, 'recall': 0.7061403717429674, 'f1-score': 0.5382598573391985, 'support': 210199}, '1': {'precision': 0.8777934045059772, 'recall': 0.6498911974144314, 'f1-score': 0.7468429098778088, 'support': 887387}, '2': {'precision': 0.4351846415781131, 'recall': 0.6435672218443862, 'f1-score': 0.5192492921981262, 'support': 207321}, 'accuracy': 0.6579472713381107, 'macro avg': {'precision': 0.582616607642094, 'recall': 0.6665329303339284, 'f1-score': 0.6014506864717112, 'support': 1304907}, 'weighted avg': {'precision': 0.7361252438230567, 'recall': 0.6579472713381107, 'f1-score': 0.6770840033262056, 'support': 1304907}}
[[148430  36858  24911]
 [162424 576705 148258]
 [ 30465  43431 133425]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70203084
{'0': {'precision': 0.42454902640095116, 'recall': 0.7014766148442074, 'f1-score': 0.5289599152392724, 'support': 76865}, '1': {'precision': 0.8861660637224158, 'recall': 0.6572889710412816, 'f1-score': 0.7547575628401575, 'support': 324600}, '2': {'precision': 0.45363263636282786, 'recall': 0.6477774955549911, 'f1-score': 0.5335941709078926, 'support': 78740}, 'accuracy': 0.6628023448318947, 'macro avg': {'precision': 0.5881159088287317, 'recall': 0.6688476938134933, 'f1-score': 0.6057705496624409, 'support': 480205}, 'weighted avg': {'precision': 0.7413531699707716, 'recall': 0.6628023448318947, 'f1-score': 0.6823502749868687, 'support': 480205}}
[[ 53919  12296  10650]
 [ 60461 213356  50783]
 [ 12623  15111  51006]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6468909
{'0': {'precision': 0.42921594276408875, 'recall': 0.6989219266214571, 'f1-score': 0.5318293832591833, 'support': 23004}, '1': {'precision': 0.8877403016000921, 'recall': 0.6899704750827592, 'f1-score': 0.776459927507048, 'support': 111770}, '2': {'precision': 0.45351467261992184, 'recall': 0.6542503602000169, 'f1-score': 0.5356950781561735, 'support': 23598}, 'accuracy': 0.6859482736847422, 'macro avg': {'precision': 0.5901569723280343, 'recall': 0.6810475873014111, 'f1-score': 0.6146614629741349, 'support': 158372}, 'weighted avg': {'precision': 0.7564370993715575, 'recall': 0.6859482736847422, 'f1-score': 0.7050517874642386, 'support': 158372}}
[[16078  4492  2434]
 [18482 77118 16170]
 [ 2899  5260 15439]]
training model: results/EXC/W3/deepOF_L2/h30
Epoch 1/50
1876/1876 - 44s - loss: 2.6597 - accuracy30: 0.5448 - val_loss: 2.4119 - val_accuracy30: 0.6344 - 44s/epoch - 24ms/step
Epoch 2/50
1876/1876 - 42s - loss: 2.3417 - accuracy30: 0.6084 - val_loss: 2.2272 - val_accuracy30: 0.6613 - 42s/epoch - 22ms/step
Epoch 3/50
1876/1876 - 41s - loss: 2.2772 - accuracy30: 0.6168 - val_loss: 2.1992 - val_accuracy30: 0.6618 - 41s/epoch - 22ms/step
Epoch 4/50
1876/1876 - 41s - loss: 2.2492 - accuracy30: 0.6221 - val_loss: 2.1803 - val_accuracy30: 0.6612 - 41s/epoch - 22ms/step
Epoch 5/50
1876/1876 - 40s - loss: 2.2297 - accuracy30: 0.6240 - val_loss: 2.1739 - val_accuracy30: 0.6596 - 40s/epoch - 21ms/step
Epoch 6/50
1876/1876 - 40s - loss: 2.2142 - accuracy30: 0.6268 - val_loss: 2.1717 - val_accuracy30: 0.6573 - 40s/epoch - 22ms/step
Epoch 7/50
1876/1876 - 40s - loss: 2.2028 - accuracy30: 0.6296 - val_loss: 2.1606 - val_accuracy30: 0.6614 - 40s/epoch - 21ms/step
Epoch 8/50
1876/1876 - 40s - loss: 2.1926 - accuracy30: 0.6308 - val_loss: 2.1583 - val_accuracy30: 0.6641 - 40s/epoch - 21ms/step
Epoch 9/50
1876/1876 - 40s - loss: 2.1833 - accuracy30: 0.6329 - val_loss: 2.1400 - val_accuracy30: 0.6629 - 40s/epoch - 21ms/step
Epoch 10/50
1876/1876 - 40s - loss: 2.1753 - accuracy30: 0.6345 - val_loss: 2.1551 - val_accuracy30: 0.6616 - 40s/epoch - 21ms/step
Epoch 11/50
1876/1876 - 40s - loss: 2.1703 - accuracy30: 0.6345 - val_loss: 2.1429 - val_accuracy30: 0.6601 - 40s/epoch - 22ms/step
Epoch 12/50
1876/1876 - 40s - loss: 2.1641 - accuracy30: 0.6358 - val_loss: 2.1427 - val_accuracy30: 0.6584 - 40s/epoch - 21ms/step
Epoch 13/50
1876/1876 - 40s - loss: 2.1579 - accuracy30: 0.6370 - val_loss: 2.1338 - val_accuracy30: 0.6591 - 40s/epoch - 21ms/step
Epoch 14/50
1876/1876 - 41s - loss: 2.1526 - accuracy30: 0.6370 - val_loss: 2.1360 - val_accuracy30: 0.6576 - 41s/epoch - 22ms/step
Epoch 15/50
1876/1876 - 40s - loss: 2.1490 - accuracy30: 0.6375 - val_loss: 2.1417 - val_accuracy30: 0.6574 - 40s/epoch - 21ms/step
Epoch 16/50
1876/1876 - 41s - loss: 2.1439 - accuracy30: 0.6379 - val_loss: 2.1327 - val_accuracy30: 0.6535 - 41s/epoch - 22ms/step
Epoch 17/50
1876/1876 - 40s - loss: 2.1392 - accuracy30: 0.6393 - val_loss: 2.1484 - val_accuracy30: 0.6575 - 40s/epoch - 21ms/step
Epoch 18/50
1876/1876 - 41s - loss: 2.1328 - accuracy30: 0.6400 - val_loss: 2.1352 - val_accuracy30: 0.6565 - 41s/epoch - 22ms/step
Epoch 19/50
1876/1876 - 40s - loss: 2.1293 - accuracy30: 0.6408 - val_loss: 2.1389 - val_accuracy30: 0.6620 - 40s/epoch - 21ms/step
Epoch 20/50
1876/1876 - 40s - loss: 2.1259 - accuracy30: 0.6410 - val_loss: 2.1354 - val_accuracy30: 0.6601 - 40s/epoch - 21ms/step
Epoch 21/50
1876/1876 - 40s - loss: 2.1216 - accuracy30: 0.6421 - val_loss: 2.1264 - val_accuracy30: 0.6574 - 40s/epoch - 21ms/step
Epoch 22/50
1876/1876 - 41s - loss: 2.1160 - accuracy30: 0.6425 - val_loss: 2.1389 - val_accuracy30: 0.6586 - 41s/epoch - 22ms/step
Epoch 23/50
1876/1876 - 41s - loss: 2.1148 - accuracy30: 0.6427 - val_loss: 2.1352 - val_accuracy30: 0.6621 - 41s/epoch - 22ms/step
Epoch 24/50
1876/1876 - 41s - loss: 2.1162 - accuracy30: 0.6417 - val_loss: 2.1498 - val_accuracy30: 0.6590 - 41s/epoch - 22ms/step
Epoch 25/50
1876/1876 - 40s - loss: 2.1089 - accuracy30: 0.6425 - val_loss: 2.1536 - val_accuracy30: 0.6580 - 40s/epoch - 22ms/step
Epoch 26/50
1876/1876 - 40s - loss: 2.1036 - accuracy30: 0.6438 - val_loss: 2.1413 - val_accuracy30: 0.6528 - 40s/epoch - 21ms/step
Epoch 27/50
1876/1876 - 41s - loss: 2.0973 - accuracy30: 0.6450 - val_loss: 2.1515 - val_accuracy30: 0.6568 - 41s/epoch - 22ms/step
Epoch 28/50
1876/1876 - 41s - loss: 2.0931 - accuracy30: 0.6455 - val_loss: 2.1448 - val_accuracy30: 0.6602 - 41s/epoch - 22ms/step
Epoch 29/50
1876/1876 - 40s - loss: 2.0892 - accuracy30: 0.6461 - val_loss: 2.1552 - val_accuracy30: 0.6549 - 40s/epoch - 21ms/step
Epoch 30/50
1876/1876 - 40s - loss: 2.0852 - accuracy30: 0.6474 - val_loss: 2.1530 - val_accuracy30: 0.6551 - 40s/epoch - 22ms/step
Epoch 31/50
1876/1876 - 40s - loss: 2.0811 - accuracy30: 0.6474 - val_loss: 2.1564 - val_accuracy30: 0.6526 - 40s/epoch - 21ms/step
testing model: results/EXC/W3/deepOF_L2/h30
Evaluating performance on  test set...
5098/5098 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74854237
{'0': {'precision': 0.46556310488598296, 'recall': 0.6850531408629441, 'f1-score': 0.5543733081301218, 'support': 252160}, '1': {'precision': 0.827636432614432, 'recall': 0.6071986391497917, 'f1-score': 0.7004842932593861, 'support': 804791}, '2': {'precision': 0.45997123123332984, 'recall': 0.6370767394215102, 'f1-score': 0.5342281833800036, 'support': 247956}, 'accuracy': 0.6279206104343068, 'macro avg': {'precision': 0.5843902562445815, 'recall': 0.643109506478082, 'f1-score': 0.5963619282565038, 'support': 1304907}, 'weighted avg': {'precision': 0.6878063887924137, 'recall': 0.6279206104343068, 'f1-score': 0.640658155464549, 'support': 1304907}}
[[172743  49176  30241]
 [160903 488668 155220]
 [ 37395  52594 157967]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7433569
{'0': {'precision': 0.4567976811252148, 'recall': 0.6773703148753732, 'f1-score': 0.5456355499171865, 'support': 91433}, '1': {'precision': 0.8390671734094947, 'recall': 0.6323114206789026, 'f1-score': 0.7211628041826933, 'support': 295035}, '2': {'precision': 0.4833465535993196, 'recall': 0.6305621046118395, 'f1-score': 0.5472262341221346, 'support': 93737}, 'accuracy': 0.6405493487156527, 'macro avg': {'precision': 0.5930704693780097, 'recall': 0.6467479467220384, 'f1-score': 0.6046748627406714, 'support': 480205}, 'weighted avg': {'precision': 0.6968441015398246, 'recall': 0.6405493487156527, 'f1-score': 0.653788920722453, 'support': 480205}}
[[ 61934  17188  12311]
 [ 57612 186554  50869]
 [ 16037  18593  59107]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7041712
{'0': {'precision': 0.4664285175215718, 'recall': 0.6633868832516369, 'f1-score': 0.5477400295420976, 'support': 27949}, '1': {'precision': 0.8353852090672576, 'recall': 0.6600668830530146, 'f1-score': 0.7374493827024831, 'support': 101670}, '2': {'precision': 0.4807772670288341, 'recall': 0.6402114561958752, 'f1-score': 0.5491564863292612, 'support': 28753}, 'accuracy': 0.6570479630237668, 'macro avg': {'precision': 0.5941969978725544, 'recall': 0.6545550741668422, 'f1-score': 0.6114486328579473, 'support': 158372}, 'weighted avg': {'precision': 0.7058925416169433, 'recall': 0.6570479630237668, 'f1-score': 0.6697848185061677, 'support': 158372}}
[[18541  6491  2917]
 [17598 67109 16963]
 [ 3612  6733 18408]]
training model: results/EXC/W3/deepOF_L2/h50
Epoch 1/50
1876/1876 - 45s - loss: 2.8121 - accuracy50: 0.5234 - val_loss: 2.6275 - val_accuracy50: 0.5792 - 45s/epoch - 24ms/step
Epoch 2/50
1876/1876 - 40s - loss: 2.5618 - accuracy50: 0.5749 - val_loss: 2.5212 - val_accuracy50: 0.6128 - 40s/epoch - 22ms/step
Epoch 3/50
1876/1876 - 41s - loss: 2.5102 - accuracy50: 0.5847 - val_loss: 2.4874 - val_accuracy50: 0.6088 - 41s/epoch - 22ms/step
Epoch 4/50
1876/1876 - 41s - loss: 2.4837 - accuracy50: 0.5888 - val_loss: 2.4889 - val_accuracy50: 0.6015 - 41s/epoch - 22ms/step
Epoch 5/50
1876/1876 - 41s - loss: 2.4680 - accuracy50: 0.5923 - val_loss: 2.4703 - val_accuracy50: 0.5977 - 41s/epoch - 22ms/step
Epoch 6/50
1876/1876 - 41s - loss: 2.4548 - accuracy50: 0.5949 - val_loss: 2.4674 - val_accuracy50: 0.6029 - 41s/epoch - 22ms/step
Epoch 7/50
1876/1876 - 41s - loss: 2.4442 - accuracy50: 0.5966 - val_loss: 2.4633 - val_accuracy50: 0.6063 - 41s/epoch - 22ms/step
Epoch 8/50
1876/1876 - 41s - loss: 2.4353 - accuracy50: 0.5984 - val_loss: 2.4549 - val_accuracy50: 0.6072 - 41s/epoch - 22ms/step
Epoch 9/50
1876/1876 - 41s - loss: 2.4269 - accuracy50: 0.6001 - val_loss: 2.4471 - val_accuracy50: 0.6056 - 41s/epoch - 22ms/step
Epoch 10/50
1876/1876 - 41s - loss: 2.4206 - accuracy50: 0.6009 - val_loss: 2.4464 - val_accuracy50: 0.6089 - 41s/epoch - 22ms/step
Epoch 11/50
1876/1876 - 41s - loss: 2.4149 - accuracy50: 0.6020 - val_loss: 2.4417 - val_accuracy50: 0.6099 - 41s/epoch - 22ms/step
Epoch 12/50
1876/1876 - 41s - loss: 2.4096 - accuracy50: 0.6022 - val_loss: 2.4419 - val_accuracy50: 0.6093 - 41s/epoch - 22ms/step
Epoch 13/50
1876/1876 - 41s - loss: 2.4031 - accuracy50: 0.6036 - val_loss: 2.4419 - val_accuracy50: 0.6079 - 41s/epoch - 22ms/step
Epoch 14/50
1876/1876 - 40s - loss: 2.3982 - accuracy50: 0.6043 - val_loss: 2.4338 - val_accuracy50: 0.6070 - 40s/epoch - 22ms/step
Epoch 15/50
1876/1876 - 41s - loss: 2.3935 - accuracy50: 0.6053 - val_loss: 2.4486 - val_accuracy50: 0.6061 - 41s/epoch - 22ms/step
Epoch 16/50
1876/1876 - 41s - loss: 2.3876 - accuracy50: 0.6065 - val_loss: 2.4488 - val_accuracy50: 0.6062 - 41s/epoch - 22ms/step
Epoch 17/50
1876/1876 - 41s - loss: 2.3832 - accuracy50: 0.6072 - val_loss: 2.4595 - val_accuracy50: 0.6059 - 41s/epoch - 22ms/step
Epoch 18/50
1876/1876 - 40s - loss: 2.3789 - accuracy50: 0.6068 - val_loss: 2.4544 - val_accuracy50: 0.6054 - 40s/epoch - 21ms/step
Epoch 19/50
1876/1876 - 40s - loss: 2.3742 - accuracy50: 0.6084 - val_loss: 2.4545 - val_accuracy50: 0.6005 - 40s/epoch - 21ms/step
Epoch 20/50
1876/1876 - 40s - loss: 2.3689 - accuracy50: 0.6094 - val_loss: 2.4635 - val_accuracy50: 0.5984 - 40s/epoch - 21ms/step
Epoch 21/50
1876/1876 - 41s - loss: 2.3635 - accuracy50: 0.6104 - val_loss: 2.4520 - val_accuracy50: 0.6062 - 41s/epoch - 22ms/step
Epoch 22/50
1876/1876 - 42s - loss: 2.3589 - accuracy50: 0.6112 - val_loss: 2.4591 - val_accuracy50: 0.6032 - 42s/epoch - 22ms/step
Epoch 23/50
1876/1876 - 41s - loss: 2.3535 - accuracy50: 0.6122 - val_loss: 2.4597 - val_accuracy50: 0.6049 - 41s/epoch - 22ms/step
Epoch 24/50
1876/1876 - 42s - loss: 2.3500 - accuracy50: 0.6126 - val_loss: 2.4698 - val_accuracy50: 0.6057 - 42s/epoch - 22ms/step
testing model: results/EXC/W3/deepOF_L2/h50
Evaluating performance on  test set...
5098/5098 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8392208
{'0': {'precision': 0.5059112298105048, 'recall': 0.6258405152748017, 'f1-score': 0.5595215490019846, 'support': 317811}, '1': {'precision': 0.7111049873946607, 'recall': 0.5657444879626942, 'f1-score': 0.6301505929173316, 'support': 675068}, '2': {'precision': 0.4912766258410443, 'recall': 0.5899246221492943, 'f1-score': 0.5361003391528606, 'support': 312028}, 'accuracy': 0.586162845321544, 'macro avg': {'precision': 0.5694309476820699, 'recall': 0.5938365417955968, 'f1-score': 0.5752574936907257, 'support': 1304907}, 'weighted avg': {'precision': 0.6085647777931872, 'recall': 0.586162845321544, 'f1-score': 0.5904596420239724, 'support': 1304907}}
[[198899  73474  45438]
 [147980 381916 145172]
 [ 46271  81684 184073]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83394605
{'0': {'precision': 0.4897263140274523, 'recall': 0.6140841867746477, 'f1-score': 0.5449000259975089, 'support': 114341}, '1': {'precision': 0.730789115240453, 'recall': 0.5900056991033946, 'f1-score': 0.6528943605048809, 'support': 249162}, '2': {'precision': 0.5070577222168987, 'recall': 0.589458621103323, 'f1-score': 0.5451620444666342, 'support': 116702}, 'accuracy': 0.595606043252361, 'macro avg': {'precision': 0.5758577171616013, 'recall': 0.5978495023271218, 'f1-score': 0.5809854769896746, 'support': 480205}, 'weighted avg': {'precision': 0.6190175535488202, 'recall': 0.595606043252361, 'f1-score': 0.6009982808134932, 'support': 480205}}
[[ 70215  25674  18452]
 [ 53731 147007  48424]
 [ 19430  28481  68791]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8063364
{'0': {'precision': 0.5007902150759294, 'recall': 0.6076033792796799, 'f1-score': 0.5490501362329395, 'support': 35984}, '1': {'precision': 0.7218674632755975, 'recall': 0.6164170372103909, 'f1-score': 0.664987755308137, 'support': 85460}, '2': {'precision': 0.5197306945875363, 'recall': 0.5874133448873483, 'f1-score': 0.5515032098137672, 'support': 36928}, 'accuracy': 0.6076516050817063, 'macro avg': {'precision': 0.5807961243130211, 'recall': 0.603811253792473, 'f1-score': 0.5885137004516147, 'support': 158372}, 'weighted avg': {'precision': 0.624503344028953, 'recall': 0.6076516050817063, 'f1-score': 0.612183872167064, 'support': 158372}}
[[21864  9730  4390]
 [17126 52679 15655]
 [ 4669 10567 21692]]
training model: results/EXC/W3/deepOF_L2/h100
Epoch 1/50
1876/1876 - 45s - loss: 3.0616 - accuracy100: 0.4657 - val_loss: 3.0092 - val_accuracy100: 0.4779 - 45s/epoch - 24ms/step
Epoch 2/50
1876/1876 - 41s - loss: 2.9097 - accuracy100: 0.5057 - val_loss: 2.9540 - val_accuracy100: 0.4870 - 41s/epoch - 22ms/step
Epoch 3/50
1876/1876 - 40s - loss: 2.8726 - accuracy100: 0.5136 - val_loss: 2.9420 - val_accuracy100: 0.4899 - 40s/epoch - 21ms/step
Epoch 4/50
1876/1876 - 40s - loss: 2.8557 - accuracy100: 0.5167 - val_loss: 2.9283 - val_accuracy100: 0.4925 - 40s/epoch - 21ms/step
Epoch 5/50
1876/1876 - 40s - loss: 2.8444 - accuracy100: 0.5193 - val_loss: 2.9130 - val_accuracy100: 0.4984 - 40s/epoch - 21ms/step
Epoch 6/50
1876/1876 - 40s - loss: 2.8366 - accuracy100: 0.5216 - val_loss: 2.9183 - val_accuracy100: 0.4964 - 40s/epoch - 21ms/step
Epoch 7/50
1876/1876 - 40s - loss: 2.8302 - accuracy100: 0.5223 - val_loss: 2.9072 - val_accuracy100: 0.4994 - 40s/epoch - 21ms/step
Epoch 8/50
1876/1876 - 40s - loss: 2.8247 - accuracy100: 0.5243 - val_loss: 2.9015 - val_accuracy100: 0.5017 - 40s/epoch - 22ms/step
Epoch 9/50
1876/1876 - 41s - loss: 2.8200 - accuracy100: 0.5254 - val_loss: 2.8919 - val_accuracy100: 0.5052 - 41s/epoch - 22ms/step
Epoch 10/50
1876/1876 - 40s - loss: 2.8146 - accuracy100: 0.5265 - val_loss: 2.8900 - val_accuracy100: 0.5047 - 40s/epoch - 22ms/step
Epoch 11/50
1876/1876 - 40s - loss: 2.8109 - accuracy100: 0.5278 - val_loss: 2.8948 - val_accuracy100: 0.5055 - 40s/epoch - 21ms/step
Epoch 12/50
1876/1876 - 40s - loss: 2.8064 - accuracy100: 0.5293 - val_loss: 2.8936 - val_accuracy100: 0.5056 - 40s/epoch - 21ms/step
Epoch 13/50
1876/1876 - 40s - loss: 2.8017 - accuracy100: 0.5298 - val_loss: 2.8882 - val_accuracy100: 0.5062 - 40s/epoch - 22ms/step
Epoch 14/50
1876/1876 - 41s - loss: 2.7974 - accuracy100: 0.5315 - val_loss: 2.8918 - val_accuracy100: 0.5069 - 41s/epoch - 22ms/step
Epoch 15/50
1876/1876 - 40s - loss: 2.7937 - accuracy100: 0.5326 - val_loss: 2.8865 - val_accuracy100: 0.5062 - 40s/epoch - 22ms/step
Epoch 16/50
1876/1876 - 40s - loss: 2.7898 - accuracy100: 0.5336 - val_loss: 2.8878 - val_accuracy100: 0.5064 - 40s/epoch - 22ms/step
Epoch 17/50
1876/1876 - 40s - loss: 2.7851 - accuracy100: 0.5344 - val_loss: 2.8845 - val_accuracy100: 0.5056 - 40s/epoch - 21ms/step
Epoch 18/50
1876/1876 - 40s - loss: 2.7812 - accuracy100: 0.5353 - val_loss: 2.8860 - val_accuracy100: 0.5075 - 40s/epoch - 21ms/step
Epoch 19/50
1876/1876 - 40s - loss: 2.7782 - accuracy100: 0.5364 - val_loss: 2.8743 - val_accuracy100: 0.5087 - 40s/epoch - 22ms/step
Epoch 20/50
1876/1876 - 41s - loss: 2.7736 - accuracy100: 0.5375 - val_loss: 2.8853 - val_accuracy100: 0.5069 - 41s/epoch - 22ms/step
Epoch 21/50
1876/1876 - 41s - loss: 2.7683 - accuracy100: 0.5393 - val_loss: 2.8880 - val_accuracy100: 0.5049 - 41s/epoch - 22ms/step
Epoch 22/50
1876/1876 - 40s - loss: 2.7637 - accuracy100: 0.5406 - val_loss: 2.8969 - val_accuracy100: 0.5035 - 40s/epoch - 22ms/step
Epoch 23/50
1876/1876 - 40s - loss: 2.7580 - accuracy100: 0.5413 - val_loss: 2.8986 - val_accuracy100: 0.5033 - 40s/epoch - 22ms/step
Epoch 24/50
1876/1876 - 41s - loss: 2.7541 - accuracy100: 0.5427 - val_loss: 2.9027 - val_accuracy100: 0.4994 - 41s/epoch - 22ms/step
Epoch 25/50
1876/1876 - 40s - loss: 2.7484 - accuracy100: 0.5445 - val_loss: 2.8992 - val_accuracy100: 0.5000 - 40s/epoch - 22ms/step
Epoch 26/50
1876/1876 - 40s - loss: 2.7421 - accuracy100: 0.5456 - val_loss: 2.9081 - val_accuracy100: 0.5004 - 40s/epoch - 21ms/step
Epoch 27/50
1876/1876 - 41s - loss: 2.7361 - accuracy100: 0.5471 - val_loss: 2.9422 - val_accuracy100: 0.4921 - 41s/epoch - 22ms/step
Epoch 28/50
1876/1876 - 41s - loss: 2.7290 - accuracy100: 0.5488 - val_loss: 2.9288 - val_accuracy100: 0.4939 - 41s/epoch - 22ms/step
Epoch 29/50
1876/1876 - 41s - loss: 2.7239 - accuracy100: 0.5499 - val_loss: 2.9263 - val_accuracy100: 0.4959 - 41s/epoch - 22ms/step
testing model: results/EXC/W3/deepOF_L2/h100
Evaluating performance on  test set...
5098/5098 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.970191
{'0': {'precision': 0.5169905359374157, 'recall': 0.5300325670267867, 'f1-score': 0.5234303237735366, 'support': 416065}, '1': {'precision': 0.4910122358175751, 'recall': 0.5018220376644019, 'f1-score': 0.4963582891472416, 'support': 483799}, '2': {'precision': 0.4927871090086898, 'recall': 0.4670590529894357, 'f1-score': 0.47957826904234674, 'support': 405043}, 'accuracy': 0.500026438665744, 'macro avg': {'precision': 0.5002632935878936, 'recall': 0.49963788589354147, 'f1-score': 0.499788960654375, 'support': 1304907}, 'weighted avg': {'precision': 0.49984624575185405, 'recall': 0.500026438665744, 'f1-score': 0.49978159548512047, 'support': 1304907}}
[[220528 119240  76297]
 [122598 242781 118420]
 [ 83435 132429 189179]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.95221007
{'0': {'precision': 0.515899713966567, 'recall': 0.5297139977989631, 'f1-score': 0.5227156011317731, 'support': 150838}, '1': {'precision': 0.5145336086356488, 'recall': 0.5419490785344444, 'f1-score': 0.5278856311825154, 'support': 177489}, '2': {'precision': 0.5243311991443974, 'recall': 0.4777387113340971, 'f1-score': 0.49995176738096886, 'support': 151878}, 'accuracy': 0.5177976072718943, 'macro avg': {'precision': 0.5182548405822044, 'recall': 0.516467262555835, 'f1-score': 0.5168509998984191, 'support': 480205}, 'weighted avg': {'precision': 0.5180614749577253, 'recall': 0.5177976072718943, 'f1-score': 0.5174268138873078, 'support': 480205}}
[[79901 42601 28336]
 [43811 96190 37488]
 [31165 48155 72558]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9571324
{'0': {'precision': 0.5112220480237644, 'recall': 0.514544359778253, 'f1-score': 0.5128778236529765, 'support': 48163}, '1': {'precision': 0.4954080254509439, 'recall': 0.5414896583397576, 'f1-score': 0.5174248657967948, 'support': 60967}, '2': {'precision': 0.5254750566369226, 'recall': 0.4616181308638967, 'f1-score': 0.49148108108108113, 'support': 49242}, 'accuracy': 0.5084610916071023, 'macro avg': {'precision': 0.5107017100372103, 'recall': 0.5058840496606357, 'f1-score': 0.5072612568436176, 'support': 158372}, 'weighted avg': {'precision': 0.5095659038564367, 'recall': 0.5084610916071023, 'f1-score': 0.5079754489949365, 'support': 158372}}
[[24782 15722  7659]
 [15086 33013 12868]
 [ 8608 17903 22731]]
training model: results/EXC/W3/deepOF_L2/h200
Epoch 1/50
1876/1876 - 44s - loss: 3.2248 - accuracy200: 0.4035 - val_loss: 3.1986 - val_accuracy200: 0.4020 - 44s/epoch - 23ms/step
Epoch 2/50
1876/1876 - 41s - loss: 3.1659 - accuracy200: 0.4255 - val_loss: 3.1706 - val_accuracy200: 0.4085 - 41s/epoch - 22ms/step
Epoch 3/50
1876/1876 - 41s - loss: 3.1417 - accuracy200: 0.4323 - val_loss: 3.1536 - val_accuracy200: 0.4113 - 41s/epoch - 22ms/step
Epoch 4/50
1876/1876 - 41s - loss: 3.1292 - accuracy200: 0.4362 - val_loss: 3.1634 - val_accuracy200: 0.4101 - 41s/epoch - 22ms/step
Epoch 5/50
1876/1876 - 40s - loss: 3.1206 - accuracy200: 0.4384 - val_loss: 3.1610 - val_accuracy200: 0.4136 - 40s/epoch - 22ms/step
Epoch 6/50
1876/1876 - 40s - loss: 3.1148 - accuracy200: 0.4414 - val_loss: 3.1484 - val_accuracy200: 0.4162 - 40s/epoch - 22ms/step
Epoch 7/50
1876/1876 - 40s - loss: 3.1104 - accuracy200: 0.4419 - val_loss: 3.1542 - val_accuracy200: 0.4154 - 40s/epoch - 22ms/step
Epoch 8/50
1876/1876 - 40s - loss: 3.1066 - accuracy200: 0.4436 - val_loss: 3.1492 - val_accuracy200: 0.4180 - 40s/epoch - 21ms/step
Epoch 9/50
1876/1876 - 40s - loss: 3.1026 - accuracy200: 0.4452 - val_loss: 3.1580 - val_accuracy200: 0.4155 - 40s/epoch - 22ms/step
Epoch 10/50
1876/1876 - 41s - loss: 3.0996 - accuracy200: 0.4458 - val_loss: 3.1603 - val_accuracy200: 0.4159 - 41s/epoch - 22ms/step
Epoch 11/50
1876/1876 - 40s - loss: 3.0965 - accuracy200: 0.4474 - val_loss: 3.1745 - val_accuracy200: 0.4153 - 40s/epoch - 22ms/step
Epoch 12/50
1876/1876 - 41s - loss: 3.0909 - accuracy200: 0.4497 - val_loss: 3.1546 - val_accuracy200: 0.4188 - 41s/epoch - 22ms/step
Epoch 13/50
1876/1876 - 41s - loss: 3.0888 - accuracy200: 0.4492 - val_loss: 3.1508 - val_accuracy200: 0.4189 - 41s/epoch - 22ms/step
Epoch 14/50
1876/1876 - 40s - loss: 3.0844 - accuracy200: 0.4514 - val_loss: 3.1636 - val_accuracy200: 0.4203 - 40s/epoch - 22ms/step
Epoch 15/50
1876/1876 - 41s - loss: 3.0803 - accuracy200: 0.4531 - val_loss: 3.1601 - val_accuracy200: 0.4194 - 41s/epoch - 22ms/step
Epoch 16/50
1876/1876 - 40s - loss: 3.0755 - accuracy200: 0.4545 - val_loss: 3.2051 - val_accuracy200: 0.4135 - 40s/epoch - 22ms/step
testing model: results/EXC/W3/deepOF_L2/h200
Evaluating performance on  test set...
5098/5098 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0560333
{'0': {'precision': 0.4613121892273033, 'recall': 0.4101489778798577, 'f1-score': 0.43422869552105187, 'support': 445838}, '1': {'precision': 0.3695253383788101, 'recall': 0.6271639360666624, 'f1-score': 0.46504556963946486, 'support': 439708}, '2': {'precision': 0.4805438956588201, 'recall': 0.1859066532176335, 'f1-score': 0.268095832516618, 'support': 419361}, 'accuracy': 0.4112101475430816, 'macro avg': {'precision': 0.43712714108831113, 'recall': 0.40773985572138455, 'f1-score': 0.3891233658923783, 'support': 1304907}, 'weighted avg': {'precision': 0.4365637703958755, 'recall': 0.4112101475430816, 'f1-score': 0.39122239892095445, 'support': 1304907}}
[[182860 217766  45212]
 [124876 275769  39063]
 [ 88655 252744  77962]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0536679
{'0': {'precision': 0.4639452439931487, 'recall': 0.4175259314758065, 'f1-score': 0.4395133398410984, 'support': 162833}, '1': {'precision': 0.36305526859504134, 'recall': 0.6180159561400106, 'f1-score': 0.45740603392587986, 'support': 154674}, '2': {'precision': 0.5103171896316507, 'recall': 0.22071568181538803, 'f1-score': 0.3081530553577098, 'support': 162698}, 'accuracy': 0.41542257993981735, 'macro avg': {'precision': 0.4457725674066136, 'recall': 0.418752523143735, 'f1-score': 0.4016908097082294, 'support': 480205}, 'weighted avg': {'precision': 0.44715984350120486, 'recall': 0.41542257993981735, 'f1-score': 0.4007704675261311, 'support': 480205}}
[[67987 75398 19448]
 [44073 95591 15010]
 [34481 92307 35910]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0504365
{'0': {'precision': 0.4508365190940108, 'recall': 0.4255835160357773, 'f1-score': 0.43784619991017515, 'support': 51541}, '1': {'precision': 0.3733828501746023, 'recall': 0.6200136222226313, 'f1-score': 0.46608269677847897, 'support': 54323}, '2': {'precision': 0.5224721980218316, 'recall': 0.19416088976917803, 'f1-score': 0.28311187014898437, 'support': 52508}, 'accuracy': 0.415546940115677, 'macro avg': {'precision': 0.4488971890968149, 'recall': 0.4132526760091955, 'f1-score': 0.3956802556125461, 'support': 158372}, 'weighted avg': {'precision': 0.4480199263404495, 'recall': 0.415546940115677, 'f1-score': 0.39622963279146894, 'support': 158372}}
[[21935 24770  4836]
 [16160 33681  4482]
 [10559 31754 10195]]
training model: results/EXC/W3/deepOF_L2/h300
Epoch 1/50
1876/1876 - 44s - loss: 3.2704 - accuracy300: 0.3844 - val_loss: 3.2712 - val_accuracy300: 0.3740 - 44s/epoch - 23ms/step
Epoch 2/50
1876/1876 - 40s - loss: 3.2383 - accuracy300: 0.4000 - val_loss: 3.2522 - val_accuracy300: 0.3834 - 40s/epoch - 21ms/step
Epoch 3/50
1876/1876 - 40s - loss: 3.2239 - accuracy300: 0.4062 - val_loss: 3.2919 - val_accuracy300: 0.3695 - 40s/epoch - 22ms/step
Epoch 4/50
1876/1876 - 40s - loss: 3.2142 - accuracy300: 0.4102 - val_loss: 3.2555 - val_accuracy300: 0.3846 - 40s/epoch - 21ms/step
Epoch 5/50
1876/1876 - 41s - loss: 3.2077 - accuracy300: 0.4132 - val_loss: 3.2508 - val_accuracy300: 0.3878 - 41s/epoch - 22ms/step
Epoch 6/50
1876/1876 - 40s - loss: 3.2034 - accuracy300: 0.4160 - val_loss: 3.2504 - val_accuracy300: 0.3895 - 40s/epoch - 21ms/step
Epoch 7/50
1876/1876 - 40s - loss: 3.1993 - accuracy300: 0.4168 - val_loss: 3.2591 - val_accuracy300: 0.3853 - 40s/epoch - 22ms/step
Epoch 8/50
1876/1876 - 40s - loss: 3.1962 - accuracy300: 0.4185 - val_loss: 3.2588 - val_accuracy300: 0.3873 - 40s/epoch - 22ms/step
Epoch 9/50
1876/1876 - 40s - loss: 3.1929 - accuracy300: 0.4201 - val_loss: 3.2400 - val_accuracy300: 0.3942 - 40s/epoch - 21ms/step
Epoch 10/50
1876/1876 - 40s - loss: 3.1893 - accuracy300: 0.4217 - val_loss: 3.2444 - val_accuracy300: 0.3933 - 40s/epoch - 21ms/step
Epoch 11/50
1876/1876 - 40s - loss: 3.1862 - accuracy300: 0.4237 - val_loss: 3.2542 - val_accuracy300: 0.3902 - 40s/epoch - 21ms/step
Epoch 12/50
1876/1876 - 40s - loss: 3.1829 - accuracy300: 0.4246 - val_loss: 3.2432 - val_accuracy300: 0.3928 - 40s/epoch - 21ms/step
Epoch 13/50
1876/1876 - 40s - loss: 3.1792 - accuracy300: 0.4269 - val_loss: 3.2463 - val_accuracy300: 0.3937 - 40s/epoch - 22ms/step
Epoch 14/50
1876/1876 - 40s - loss: 3.1766 - accuracy300: 0.4276 - val_loss: 3.2522 - val_accuracy300: 0.3922 - 40s/epoch - 22ms/step
Epoch 15/50
1876/1876 - 40s - loss: 3.1723 - accuracy300: 0.4296 - val_loss: 3.2570 - val_accuracy300: 0.3914 - 40s/epoch - 21ms/step
Epoch 16/50
1876/1876 - 40s - loss: 3.1689 - accuracy300: 0.4306 - val_loss: 3.2640 - val_accuracy300: 0.3901 - 40s/epoch - 21ms/step
Epoch 17/50
1876/1876 - 40s - loss: 3.1643 - accuracy300: 0.4332 - val_loss: 3.2591 - val_accuracy300: 0.3911 - 40s/epoch - 21ms/step
Epoch 18/50
1876/1876 - 40s - loss: 3.1626 - accuracy300: 0.4333 - val_loss: 3.2670 - val_accuracy300: 0.3907 - 40s/epoch - 21ms/step
Epoch 19/50
1876/1876 - 40s - loss: 3.1580 - accuracy300: 0.4362 - val_loss: 3.2644 - val_accuracy300: 0.3896 - 40s/epoch - 21ms/step
testing model: results/EXC/W3/deepOF_L2/h300
Evaluating performance on  test set...
5098/5098 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0769033
{'0': {'precision': 0.4323401374183041, 'recall': 0.5644192048675101, 'f1-score': 0.48962887277153366, 'support': 466111}, '1': {'precision': 0.3224205946779166, 'recall': 0.3155179985163536, 'f1-score': 0.31893195300773797, 'support': 403061}, '2': {'precision': 0.44162626503470565, 'recall': 0.30605069595052037, 'f1-score': 0.36154658446556404, 'support': 435735}, 'accuracy': 0.40126384485637673, 'macro avg': {'precision': 0.39879566571030883, 'recall': 0.3953292997781281, 'f1-score': 0.3900358034149452, 'support': 1304907}, 'weighted avg': {'precision': 0.40148890434226836, 'recall': 0.40126384485637673, 'f1-score': 0.3941345524315271, 'support': 1304907}}
[[263082 125907  77122]
 [184399 127173  91489]
 [161026 141352 133357]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0776037
{'0': {'precision': 0.4140652698007516, 'recall': 0.5758653419456634, 'f1-score': 0.4817425289252789, 'support': 162248}, '1': {'precision': 0.3357292538316848, 'recall': 0.2980066023362113, 'f1-score': 0.3157452218160294, 'support': 157520}, '2': {'precision': 0.44200599637428534, 'recall': 0.31609915418513185, 'f1-score': 0.36859720975531757, 'support': 160437}, 'accuracy': 0.3979321331514666, 'macro avg': {'precision': 0.39726684000224055, 'recall': 0.39665703282233555, 'f1-score': 0.38869498683220866, 'support': 480205}, 'weighted avg': {'precision': 0.3977040014129394, 'recall': 0.3979321331514666, 'f1-score': 0.3894890301330546, 'support': 480205}}
[[93433 42713 26102]
 [72658 46942 37920]
 [59557 50166 50714]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0789977
{'0': {'precision': 0.40209908112513, 'recall': 0.5619171035322299, 'f1-score': 0.46876049301830397, 'support': 50931}, '1': {'precision': 0.3430819293981958, 'recall': 0.30051233944292105, 'f1-score': 0.3203892831727348, 'support': 55432}, '2': {'precision': 0.44407928785839973, 'recall': 0.3299621219404334, 'f1-score': 0.3786085402579065, 'support': 52009}, 'accuracy': 0.39424898340615766, 'macro avg': {'precision': 0.39642009946057516, 'recall': 0.39746385497186143, 'f1-score': 0.38925277214964843, 'support': 158372}, 'weighted avg': {'precision': 0.3952286104451058, 'recall': 0.39424898340615766, 'f1-score': 0.3872231896106618, 'support': 158372}}
[[28619 14308  8004]
 [25295 16658 13479]
 [17260 17588 17161]]
training model: results/EXC/W3/deepOF_L2/h500
Epoch 1/50
1876/1876 - 43s - loss: 3.2841 - accuracy500: 0.3723 - val_loss: 3.2752 - val_accuracy500: 0.3665 - 43s/epoch - 23ms/step
Epoch 2/50
1876/1876 - 41s - loss: 3.2554 - accuracy500: 0.3901 - val_loss: 3.2639 - val_accuracy500: 0.3808 - 41s/epoch - 22ms/step
Epoch 3/50
1876/1876 - 41s - loss: 3.2433 - accuracy500: 0.3974 - val_loss: 3.2567 - val_accuracy500: 0.3896 - 41s/epoch - 22ms/step
Epoch 4/50
1876/1876 - 41s - loss: 3.2350 - accuracy500: 0.4034 - val_loss: 3.2528 - val_accuracy500: 0.3943 - 41s/epoch - 22ms/step
Epoch 5/50
1876/1876 - 40s - loss: 3.2285 - accuracy500: 0.4073 - val_loss: 3.2575 - val_accuracy500: 0.3948 - 40s/epoch - 21ms/step
Epoch 6/50
1876/1876 - 42s - loss: 3.2231 - accuracy500: 0.4105 - val_loss: 3.2524 - val_accuracy500: 0.3973 - 42s/epoch - 22ms/step
Epoch 7/50
1876/1876 - 40s - loss: 3.2187 - accuracy500: 0.4131 - val_loss: 3.2461 - val_accuracy500: 0.4007 - 40s/epoch - 22ms/step
Epoch 8/50
1876/1876 - 40s - loss: 3.2152 - accuracy500: 0.4154 - val_loss: 3.2464 - val_accuracy500: 0.3999 - 40s/epoch - 21ms/step
Epoch 9/50
1876/1876 - 40s - loss: 3.2114 - accuracy500: 0.4186 - val_loss: 3.2497 - val_accuracy500: 0.3978 - 40s/epoch - 22ms/step
Epoch 10/50
1876/1876 - 41s - loss: 3.2087 - accuracy500: 0.4203 - val_loss: 3.2521 - val_accuracy500: 0.4001 - 41s/epoch - 22ms/step
Epoch 11/50
1876/1876 - 41s - loss: 3.2060 - accuracy500: 0.4219 - val_loss: 3.2507 - val_accuracy500: 0.3974 - 41s/epoch - 22ms/step
Epoch 12/50
1876/1876 - 40s - loss: 3.2034 - accuracy500: 0.4228 - val_loss: 3.2490 - val_accuracy500: 0.3954 - 40s/epoch - 22ms/step
Epoch 13/50
1876/1876 - 41s - loss: 3.1994 - accuracy500: 0.4255 - val_loss: 3.2490 - val_accuracy500: 0.3944 - 41s/epoch - 22ms/step
Epoch 14/50
1876/1876 - 40s - loss: 3.1976 - accuracy500: 0.4261 - val_loss: 3.2516 - val_accuracy500: 0.3959 - 40s/epoch - 21ms/step
Epoch 15/50
1876/1876 - 41s - loss: 3.1940 - accuracy500: 0.4282 - val_loss: 3.2719 - val_accuracy500: 0.3943 - 41s/epoch - 22ms/step
Epoch 16/50
1876/1876 - 40s - loss: 3.1914 - accuracy500: 0.4295 - val_loss: 3.2585 - val_accuracy500: 0.3945 - 40s/epoch - 21ms/step
Epoch 17/50
1876/1876 - 40s - loss: 3.1871 - accuracy500: 0.4319 - val_loss: 3.2569 - val_accuracy500: 0.3949 - 40s/epoch - 22ms/step
testing model: results/EXC/W3/deepOF_L2/h500
Evaluating performance on  test set...
5098/5098 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0861993
{'0': {'precision': 0.4168787944846195, 'recall': 0.5249258115342802, 'f1-score': 0.4647045429758281, 'support': 462673}, '1': {'precision': 0.3690624553829624, 'recall': 0.3619227748100932, 'f1-score': 0.36545774774450956, 'support': 421391}, '2': {'precision': 0.4035246652150421, 'recall': 0.29635992519775783, 'f1-score': 0.34173788432188645, 'support': 420843}, 'accuracy': 0.3985732316555892, 'macro avg': {'precision': 0.3964886383608747, 'recall': 0.3944028371807104, 'f1-score': 0.3906333916807414, 'support': 1304907}, 'weighted avg': {'precision': 0.39713074594584763, 'recall': 0.3985732316555892, 'f1-score': 0.3929972383041378, 'support': 1304907}}
[[242869 130837  88967]
 [173489 152511  95391]
 [166231 129891 124721]]
Evaluating performance on  train set...
1876/1876 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0846959
{'0': {'precision': 0.41117902115077604, 'recall': 0.5276799515078042, 'f1-score': 0.46220131512929624, 'support': 164975}, '1': {'precision': 0.3675205400765453, 'recall': 0.36826686154423227, 'f1-score': 0.3678933223072153, 'support': 154627}, '2': {'precision': 0.42145914431155657, 'recall': 0.29797077265057315, 'f1-score': 0.34911672119905607, 'support': 160603}, 'accuracy': 0.399523120334024, 'macro avg': {'precision': 0.4000529018462926, 'recall': 0.39797252856753657, 'f1-score': 0.3930704528785225, 'support': 480205}, 'weighted avg': {'precision': 0.40055905398451525, 'recall': 0.399523120334024, 'f1-score': 0.39401317247130996, 'support': 480205}}
[[87054 47242 30679]
 [62671 56944 35012]
 [61993 50755 47855]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0827572
{'0': {'precision': 0.3995439758336238, 'recall': 0.5273741517463482, 'f1-score': 0.4546446100708961, 'support': 52166}, '1': {'precision': 0.3677321873589608, 'recall': 0.3599554377473013, 'f1-score': 0.36380225774826985, 'support': 52062}, '2': {'precision': 0.4399688756322137, 'recall': 0.31329417848699764, 'f1-score': 0.3659802155363057, 'support': 54144}, 'accuracy': 0.3991488394413154, 'macro avg': {'precision': 0.4024150129415995, 'recall': 0.4002079226602157, 'f1-score': 0.39480902778515725, 'support': 158372}, 'weighted avg': {'precision': 0.40290682054813737, 'recall': 0.3991488394413154, 'f1-score': 0.3944693295648633, 'support': 158372}}
[[27511 14916  9739]
 [21469 18740 11853]
 [19876 17305 16963]]
training model: results/EXC/W3/deepOF_L2/h1000
Epoch 1/50
1876/1876 - 45s - loss: 3.2553 - accuracy1000: 0.3982 - val_loss: 3.3369 - val_accuracy1000: 0.3352 - 45s/epoch - 24ms/step
Epoch 2/50
1876/1876 - 41s - loss: 3.2548 - accuracy1000: 0.3945 - val_loss: 3.3405 - val_accuracy1000: 0.3374 - 41s/epoch - 22ms/step
Epoch 3/50
1876/1876 - 40s - loss: 3.2548 - accuracy1000: 0.3936 - val_loss: 3.3379 - val_accuracy1000: 0.3406 - 40s/epoch - 21ms/step
Epoch 4/50
1876/1876 - 41s - loss: 3.2557 - accuracy1000: 0.3927 - val_loss: 3.3366 - val_accuracy1000: 0.3425 - 41s/epoch - 22ms/step
Epoch 5/50
1876/1876 - 40s - loss: 3.2564 - accuracy1000: 0.3927 - val_loss: 3.3503 - val_accuracy1000: 0.3409 - 40s/epoch - 22ms/step
Epoch 6/50
1876/1876 - 40s - loss: 3.2508 - accuracy1000: 0.3976 - val_loss: 3.3417 - val_accuracy1000: 0.3444 - 40s/epoch - 21ms/step
Epoch 7/50
1876/1876 - 40s - loss: 3.2505 - accuracy1000: 0.3976 - val_loss: 3.3499 - val_accuracy1000: 0.3444 - 40s/epoch - 21ms/step
Epoch 8/50
1876/1876 - 41s - loss: 3.2492 - accuracy1000: 0.3985 - val_loss: 3.3502 - val_accuracy1000: 0.3435 - 41s/epoch - 22ms/step
Epoch 9/50
1876/1876 - 40s - loss: 3.2476 - accuracy1000: 0.3993 - val_loss: 3.3490 - val_accuracy1000: 0.3422 - 40s/epoch - 22ms/step
Epoch 10/50
1876/1876 - 40s - loss: 3.2448 - accuracy1000: 0.4020 - val_loss: 3.3482 - val_accuracy1000: 0.3450 - 40s/epoch - 22ms/step
Epoch 11/50
1876/1876 - 40s - loss: 3.2413 - accuracy1000: 0.4041 - val_loss: 3.3579 - val_accuracy1000: 0.3408 - 40s/epoch - 21ms/step
Epoch 12/50
1876/1876 - 40s - loss: 3.2367 - accuracy1000: 0.4072 - val_loss: 3.3533 - val_accuracy1000: 0.3421 - 40s/epoch - 22ms/step
Epoch 13/50
1876/1876 - 41s - loss: 3.2324 - accuracy1000: 0.4089 - val_loss: 3.3603 - val_accuracy1000: 0.3403 - 41s/epoch - 22ms/step
Epoch 14/50
1876/1876 - 40s - loss: 3.2305 - accuracy1000: 0.4110 - val_loss: 3.3581 - val_accuracy1000: 0.3433 - 40s/epoch - 22ms/step
testing model: results/EXC/W3/deepOF_L2/h1000
Evaluating performance on  test set...
5098/5098 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0852005
{'0': {'precision': 0.41576883310993223, 'recall': 0.7997695332090395, 'f1-score': 0.5471143565565425, 'support': 522418}, '1': {'precision': 0.34925834198822936, 'recall': 0.04069695277105443, 'f1-score': 0.07289938328733696, 'support': 322260}, '2': {'precision': 0.3979431253977145, 'recall': 0.22691964217813307, 'f1-score': 0.2890270193976194, 'support': 460229}, 'accuracy': 0.41026985064836036, 'macro avg': {'precision': 0.38765676683195877, 'recall': 0.35579537605274236, 'f1-score': 0.30301358641383297, 'support': 1304907}, 'weighted avg': {'precision': 0.39305642639928834, 'recall': 0.41026985064836036, 'f1-score': 0.33897707598478666, 'support': 1304907}}
[[417814  12400  92204]
 [243347  13115  65798]
 [343758  12036 104435]]
Evaluating performance on  train set...
1876/1876 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0962447
{'0': {'precision': 0.3650429498107109, 'recall': 0.7886181292073703, 'f1-score': 0.49907116291915904, 'support': 167266}, '1': {'precision': 0.38154831199068684, 'recall': 0.03447754423106003, 'f1-score': 0.06324053472259908, 'support': 152099}, '2': {'precision': 0.3844960945304398, 'recall': 0.25126834120865454, 'f1-score': 0.3039229325923391, 'support': 160840}, 'accuracy': 0.36977332597536466, 'macro avg': {'precision': 0.3770291187772792, 'recall': 0.3581213382156949, 'f1-score': 0.2887448767446991, 'support': 480205}, 'weighted avg': {'precision': 0.3767864611838398, 'recall': 0.36977332597536466, 'f1-score': 0.29566419280465733, 'support': 480205}}
[[131909   4298  31059]
 [113219   5244  33636]
 [116224   4202  40414]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1040123
{'0': {'precision': 0.32804525819836244, 'recall': 0.7815170398035196, 'f1-score': 0.46211548386322454, 'support': 49267}, '1': {'precision': 0.3891941391941392, 'recall': 0.02921815650619597, 'f1-score': 0.05435564579303289, 'support': 58183}, '2': {'precision': 0.379930663609314, 'recall': 0.27331997957660736, 'f1-score': 0.3179258751641825, 'support': 50922}, 'accuracy': 0.3417333872149117, 'macro avg': {'precision': 0.3657233536672719, 'recall': 0.361351725295441, 'f1-score': 0.2781323349401466, 'support': 158372}, 'weighted avg': {'precision': 0.367193175490016, 'recall': 0.3417333872149117, 'f1-score': 0.26595003850286675, 'support': 158372}}
[[38503  1245  9519]
 [43287  1700 13196]
 [35581  1423 13918]]
training model: results/EXC/W3/deepVOL_L2/h10
Epoch 1/50
1876/1876 - 46s - loss: 2.3090 - accuracy10: 0.5966 - val_loss: 2.0679 - val_accuracy10: 0.7180 - 46s/epoch - 24ms/step
Epoch 2/50
1876/1876 - 46s - loss: 2.1250 - accuracy10: 0.6375 - val_loss: 1.9399 - val_accuracy10: 0.7309 - 46s/epoch - 24ms/step
Epoch 3/50
1876/1876 - 41s - loss: 2.0713 - accuracy10: 0.6529 - val_loss: 1.9587 - val_accuracy10: 0.7582 - 41s/epoch - 22ms/step
Epoch 4/50
1876/1876 - 45s - loss: 2.0393 - accuracy10: 0.6578 - val_loss: 1.9619 - val_accuracy10: 0.7544 - 45s/epoch - 24ms/step
Epoch 5/50
1876/1876 - 44s - loss: 2.0150 - accuracy10: 0.6625 - val_loss: 1.8996 - val_accuracy10: 0.7544 - 44s/epoch - 24ms/step
Epoch 6/50
1876/1876 - 43s - loss: 1.9964 - accuracy10: 0.6639 - val_loss: 1.8989 - val_accuracy10: 0.7548 - 43s/epoch - 23ms/step
Epoch 7/50
1876/1876 - 43s - loss: 1.9788 - accuracy10: 0.6660 - val_loss: 1.8833 - val_accuracy10: 0.7492 - 43s/epoch - 23ms/step
Epoch 8/50
1876/1876 - 43s - loss: 1.9644 - accuracy10: 0.6668 - val_loss: 1.8742 - val_accuracy10: 0.7602 - 43s/epoch - 23ms/step
Epoch 9/50
1876/1876 - 45s - loss: 1.9506 - accuracy10: 0.6696 - val_loss: 1.8538 - val_accuracy10: 0.7621 - 45s/epoch - 24ms/step
Epoch 10/50
1876/1876 - 41s - loss: 1.9403 - accuracy10: 0.6701 - val_loss: 1.8693 - val_accuracy10: 0.7622 - 41s/epoch - 22ms/step
Epoch 11/50
1876/1876 - 42s - loss: 1.9316 - accuracy10: 0.6708 - val_loss: 1.8520 - val_accuracy10: 0.7545 - 42s/epoch - 23ms/step
Epoch 12/50
1876/1876 - 42s - loss: 1.9221 - accuracy10: 0.6716 - val_loss: 1.8402 - val_accuracy10: 0.7616 - 42s/epoch - 22ms/step
Epoch 13/50
1876/1876 - 48s - loss: 1.9157 - accuracy10: 0.6719 - val_loss: 1.8216 - val_accuracy10: 0.7525 - 48s/epoch - 25ms/step
Epoch 14/50
1876/1876 - 42s - loss: 1.9084 - accuracy10: 0.6729 - val_loss: 1.8345 - val_accuracy10: 0.7530 - 42s/epoch - 22ms/step
Epoch 15/50
1876/1876 - 43s - loss: 1.9010 - accuracy10: 0.6745 - val_loss: 1.8091 - val_accuracy10: 0.7464 - 43s/epoch - 23ms/step
Epoch 16/50
1876/1876 - 45s - loss: 1.8969 - accuracy10: 0.6742 - val_loss: 1.8045 - val_accuracy10: 0.7513 - 45s/epoch - 24ms/step
Epoch 17/50
1876/1876 - 43s - loss: 1.8917 - accuracy10: 0.6753 - val_loss: 1.7985 - val_accuracy10: 0.7432 - 43s/epoch - 23ms/step
Epoch 18/50
1876/1876 - 43s - loss: 1.8858 - accuracy10: 0.6763 - val_loss: 1.8067 - val_accuracy10: 0.7476 - 43s/epoch - 23ms/step
Epoch 19/50
1876/1876 - 43s - loss: 1.8829 - accuracy10: 0.6762 - val_loss: 1.8195 - val_accuracy10: 0.7449 - 43s/epoch - 23ms/step
Epoch 20/50
1876/1876 - 42s - loss: 1.8771 - accuracy10: 0.6776 - val_loss: 1.8148 - val_accuracy10: 0.7502 - 42s/epoch - 22ms/step
Epoch 21/50
1876/1876 - 45s - loss: 1.8726 - accuracy10: 0.6775 - val_loss: 1.8201 - val_accuracy10: 0.7458 - 45s/epoch - 24ms/step
Epoch 22/50
1876/1876 - 42s - loss: 1.8693 - accuracy10: 0.6777 - val_loss: 1.8164 - val_accuracy10: 0.7437 - 42s/epoch - 22ms/step
Epoch 23/50
1876/1876 - 41s - loss: 1.8637 - accuracy10: 0.6780 - val_loss: 1.8130 - val_accuracy10: 0.7449 - 41s/epoch - 22ms/step
Epoch 24/50
1876/1876 - 42s - loss: 1.8593 - accuracy10: 0.6786 - val_loss: 1.8008 - val_accuracy10: 0.7365 - 42s/epoch - 22ms/step
Epoch 25/50
1876/1876 - 44s - loss: 1.8565 - accuracy10: 0.6797 - val_loss: 1.8159 - val_accuracy10: 0.7405 - 44s/epoch - 24ms/step
Epoch 26/50
1876/1876 - 41s - loss: 1.8536 - accuracy10: 0.6790 - val_loss: 1.8209 - val_accuracy10: 0.7459 - 41s/epoch - 22ms/step
Epoch 27/50
1876/1876 - 45s - loss: 1.8480 - accuracy10: 0.6795 - val_loss: 1.8062 - val_accuracy10: 0.7408 - 45s/epoch - 24ms/step
testing model: results/EXC/W3/deepVOL_L2/h10
Evaluating performance on  test set...
5098/5098 - 49s - 49s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.59521306
{'0': {'precision': 0.3761634212783131, 'recall': 0.7784817560160777, 'f1-score': 0.5072317738890874, 'support': 153256}, '1': {'precision': 0.9220426080465081, 'recall': 0.7327409494216054, 'f1-score': 0.8165640430472916, 'support': 999577}, '2': {'precision': 0.44261218495651183, 'recall': 0.5628361761727535, 'f1-score': 0.4955364379501193, 'support': 152078}, 'accuracy': 0.7183118235649788, 'macro avg': {'precision': 0.5802727380937777, 'recall': 0.6913529605368122, 'f1-score': 0.6064440849621661, 'support': 1304911}, 'weighted avg': {'precision': 0.8020573519408987, 'recall': 0.7183118235649788, 'f1-score': 0.7428208817358477, 'support': 1304911}}
[[119307  21493  12456]
 [171811 732431  95335]
 [ 26050  40433  85595]]
Evaluating performance on  train set...
1876/1876 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6188048
{'0': {'precision': 0.37159203893317516, 'recall': 0.7533684620009194, 'f1-score': 0.49769875943275, 'support': 56554}, '1': {'precision': 0.9292850050003357, 'recall': 0.7181342763903491, 'f1-score': 0.8101779822110217, 'support': 366185}, '2': {'precision': 0.4215434550915609, 'recall': 0.6056588014199207, 'f1-score': 0.49710074552257993, 'support': 57468}, 'accuracy': 0.7088234865380971, 'macro avg': {'precision': 0.5741401663416906, 'recall': 0.6923871799370631, 'f1-score': 0.6016591623887838, 'support': 480207}, 'weighted avg': {'precision': 0.8028423263365102, 'recall': 0.7088234865380971, 'f1-score': 0.7359102755698987, 'support': 480207}}
[[ 42606   7430   6518]
 [ 61971 262970  41244]
 [ 10081  12581  34806]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.54959637
{'0': {'precision': 0.36778936967830056, 'recall': 0.7676351064475041, 'f1-score': 0.4973083421745452, 'support': 16487}, '1': {'precision': 0.9323887670374432, 'recall': 0.7612845973041684, 'f1-score': 0.8381937414726465, 'support': 125082}, '2': {'precision': 0.44858700132826457, 'recall': 0.582872106171517, 'f1-score': 0.5069883010663631, 'support': 16803}, 'accuracy': 0.7430164423004066, 'macro avg': {'precision': 0.5829217126813361, 'recall': 0.7039306033077298, 'f1-score': 0.614163461571185, 'support': 158372}, 'weighted avg': {'precision': 0.8222817321229918, 'recall': 0.7430164423004066, 'f1-score': 0.7675662151840691, 'support': 158372}}
[[12656  2471  1360]
 [19180 95223 10679]
 [ 2575  4434  9794]]
training model: results/EXC/W3/deepVOL_L2/h20
Epoch 1/50
1876/1876 - 44s - loss: 2.4207 - accuracy20: 0.5942 - val_loss: 2.2151 - val_accuracy20: 0.6908 - 44s/epoch - 23ms/step
Epoch 2/50
1876/1876 - 43s - loss: 2.2374 - accuracy20: 0.6322 - val_loss: 2.1780 - val_accuracy20: 0.7158 - 43s/epoch - 23ms/step
Epoch 3/50
1876/1876 - 45s - loss: 2.1791 - accuracy20: 0.6421 - val_loss: 2.1444 - val_accuracy20: 0.7211 - 45s/epoch - 24ms/step
Epoch 4/50
1876/1876 - 40s - loss: 2.1420 - accuracy20: 0.6457 - val_loss: 2.0883 - val_accuracy20: 0.7282 - 40s/epoch - 21ms/step
Epoch 5/50
1876/1876 - 45s - loss: 2.1133 - accuracy20: 0.6479 - val_loss: 2.0403 - val_accuracy20: 0.7233 - 45s/epoch - 24ms/step
Epoch 6/50
1876/1876 - 43s - loss: 2.0934 - accuracy20: 0.6499 - val_loss: 2.0273 - val_accuracy20: 0.7186 - 43s/epoch - 23ms/step
Epoch 7/50
1876/1876 - 44s - loss: 2.0804 - accuracy20: 0.6519 - val_loss: 2.0258 - val_accuracy20: 0.7145 - 44s/epoch - 23ms/step
Epoch 8/50
1876/1876 - 45s - loss: 2.0697 - accuracy20: 0.6528 - val_loss: 2.0197 - val_accuracy20: 0.7194 - 45s/epoch - 24ms/step
Epoch 9/50
1876/1876 - 44s - loss: 2.0605 - accuracy20: 0.6534 - val_loss: 1.9920 - val_accuracy20: 0.7155 - 44s/epoch - 24ms/step
Epoch 10/50
1876/1876 - 45s - loss: 2.0527 - accuracy20: 0.6544 - val_loss: 1.9912 - val_accuracy20: 0.7199 - 45s/epoch - 24ms/step
Epoch 11/50
1876/1876 - 43s - loss: 2.0442 - accuracy20: 0.6554 - val_loss: 1.9944 - val_accuracy20: 0.7169 - 43s/epoch - 23ms/step
Epoch 12/50
1876/1876 - 43s - loss: 2.0385 - accuracy20: 0.6568 - val_loss: 1.9711 - val_accuracy20: 0.7170 - 43s/epoch - 23ms/step
Epoch 13/50
1876/1876 - 47s - loss: 2.0334 - accuracy20: 0.6575 - val_loss: 1.9655 - val_accuracy20: 0.7131 - 47s/epoch - 25ms/step
Epoch 14/50
1876/1876 - 44s - loss: 2.0287 - accuracy20: 0.6574 - val_loss: 1.9601 - val_accuracy20: 0.7087 - 44s/epoch - 24ms/step
Epoch 15/50
1876/1876 - 43s - loss: 2.0231 - accuracy20: 0.6590 - val_loss: 1.9560 - val_accuracy20: 0.7118 - 43s/epoch - 23ms/step
Epoch 16/50
1876/1876 - 42s - loss: 2.0180 - accuracy20: 0.6596 - val_loss: 1.9630 - val_accuracy20: 0.7098 - 42s/epoch - 23ms/step
Epoch 17/50
1876/1876 - 45s - loss: 2.0142 - accuracy20: 0.6597 - val_loss: 1.9688 - val_accuracy20: 0.7136 - 45s/epoch - 24ms/step
Epoch 18/50
1876/1876 - 41s - loss: 2.0100 - accuracy20: 0.6609 - val_loss: 1.9668 - val_accuracy20: 0.7122 - 41s/epoch - 22ms/step
Epoch 19/50
1876/1876 - 40s - loss: 2.0049 - accuracy20: 0.6612 - val_loss: 1.9790 - val_accuracy20: 0.7088 - 40s/epoch - 21ms/step
Epoch 20/50
1876/1876 - 41s - loss: 2.0019 - accuracy20: 0.6616 - val_loss: 1.9635 - val_accuracy20: 0.7109 - 41s/epoch - 22ms/step
Epoch 21/50
1876/1876 - 44s - loss: 1.9973 - accuracy20: 0.6623 - val_loss: 1.9705 - val_accuracy20: 0.7075 - 44s/epoch - 23ms/step
Epoch 22/50
1876/1876 - 45s - loss: 1.9945 - accuracy20: 0.6624 - val_loss: 1.9699 - val_accuracy20: 0.7160 - 45s/epoch - 24ms/step
Epoch 23/50
1876/1876 - 42s - loss: 1.9900 - accuracy20: 0.6632 - val_loss: 1.9670 - val_accuracy20: 0.7146 - 42s/epoch - 23ms/step
Epoch 24/50
1876/1876 - 40s - loss: 1.9875 - accuracy20: 0.6638 - val_loss: 1.9678 - val_accuracy20: 0.7138 - 40s/epoch - 22ms/step
Epoch 25/50
1876/1876 - 43s - loss: 1.9837 - accuracy20: 0.6636 - val_loss: 1.9812 - val_accuracy20: 0.7170 - 43s/epoch - 23ms/step
testing model: results/EXC/W3/deepVOL_L2/h20
Evaluating performance on  test set...
5098/5098 - 51s - 51s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6581542
{'0': {'precision': 0.4424548684678439, 'recall': 0.7043734330474165, 'f1-score': 0.5435049941817139, 'support': 210201}, '1': {'precision': 0.8632105633131747, 'recall': 0.7043626914044364, 'f1-score': 0.7757383124446549, 'support': 887388}, '2': {'precision': 0.48938002412800025, 'recall': 0.5811201898496059, 'f1-score': 0.5313191138433856, 'support': 207322}, 'accuracy': 0.6847838664859136, 'macro avg': {'precision': 0.5983484853030062, 'recall': 0.6632854381004863, 'f1-score': 0.6168541401565849, 'support': 1304911}, 'weighted avg': {'precision': 0.7360397732308379, 'recall': 0.6847838664859136, 'f1-score': 0.6994962140758, 'support': 1304911}}
[[148060  38381  23760]
 [160397 625043 101948]
 [ 26176  60667 120479]]
Evaluating performance on  train set...
1876/1876 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6671134
{'0': {'precision': 0.43267016747560755, 'recall': 0.6792447923439003, 'f1-score': 0.5286176887269783, 'support': 76906}, '1': {'precision': 0.8753430177889505, 'recall': 0.7024543939781264, 'f1-score': 0.7794264897357999, 'support': 324683}, '2': {'precision': 0.4876968802442427, 'recall': 0.6136253784120684, 'f1-score': 0.5434616077865897, 'support': 78618}, 'accuracy': 0.6841945244446666, 'macro avg': {'precision': 0.598570021836267, 'recall': 0.6651081882446984, 'f1-score': 0.617168595416456, 'support': 480207}, 'weighted avg': {'precision': 0.7409839554102517, 'recall': 0.6841945244446666, 'f1-score': 0.700627578559021, 'support': 480207}}
[[ 52238  13024  11644]
 [ 57576 228075  39032]
 [ 10920  19456  48242]]
Evaluating performance on  val set...
619/619 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61218774
{'0': {'precision': 0.4329558202895454, 'recall': 0.7047084909351767, 'f1-score': 0.53637551911845, 'support': 23001}, '1': {'precision': 0.8771407613722134, 'recall': 0.7381067396632852, 'f1-score': 0.8016400052464624, 'support': 111786}, '2': {'precision': 0.5166189005099192, 'recall': 0.5885096459614162, 'f1-score': 0.5502259573455959, 'support': 23585}, 'accuracy': 0.7109779506478417, 'macro avg': {'precision': 0.6089051607238928, 'recall': 0.677108292186626, 'f1-score': 0.629413827236836, 'support': 158372}, 'weighted avg': {'precision': 0.7589405371010061, 'recall': 0.7109779506478417, 'f1-score': 0.7256736174684945, 'support': 158372}}
[[16209  4450  2342]
 [18631 82510 10645]
 [ 2598  7107 13880]]
training model: results/EXC/W3/deepVOL_L2/h30
Epoch 1/50
1876/1876 - 44s - loss: 2.5330 - accuracy30: 0.5800 - val_loss: 2.5071 - val_accuracy30: 0.6669 - 44s/epoch - 24ms/step
Epoch 2/50
1876/1876 - 44s - loss: 2.3485 - accuracy30: 0.6162 - val_loss: 2.3986 - val_accuracy30: 0.6787 - 44s/epoch - 24ms/step
Epoch 3/50
1876/1876 - 44s - loss: 2.2927 - accuracy30: 0.6245 - val_loss: 2.3293 - val_accuracy30: 0.6834 - 44s/epoch - 24ms/step
Epoch 4/50
1876/1876 - 47s - loss: 2.2588 - accuracy30: 0.6283 - val_loss: 2.2594 - val_accuracy30: 0.6836 - 47s/epoch - 25ms/step
Epoch 5/50
1876/1876 - 44s - loss: 2.2358 - accuracy30: 0.6304 - val_loss: 2.2438 - val_accuracy30: 0.6783 - 44s/epoch - 24ms/step
Epoch 6/50
1876/1876 - 44s - loss: 2.2194 - accuracy30: 0.6337 - val_loss: 2.2447 - val_accuracy30: 0.6841 - 44s/epoch - 23ms/step
Epoch 7/50
1876/1876 - 47s - loss: 2.2082 - accuracy30: 0.6329 - val_loss: 2.2441 - val_accuracy30: 0.6806 - 47s/epoch - 25ms/step
Epoch 8/50
1876/1876 - 47s - loss: 2.1983 - accuracy30: 0.6341 - val_loss: 2.2456 - val_accuracy30: 0.6791 - 47s/epoch - 25ms/step
Epoch 9/50
1876/1876 - 43s - loss: 2.1900 - accuracy30: 0.6348 - val_loss: 2.2588 - val_accuracy30: 0.6785 - 43s/epoch - 23ms/step
Epoch 10/50
1876/1876 - 44s - loss: 2.1817 - accuracy30: 0.6361 - val_loss: 2.2262 - val_accuracy30: 0.6788 - 44s/epoch - 24ms/step
Epoch 11/50
1876/1876 - 46s - loss: 2.1763 - accuracy30: 0.6362 - val_loss: 2.2326 - val_accuracy30: 0.6767 - 46s/epoch - 24ms/step
Epoch 12/50
1876/1876 - 43s - loss: 2.1700 - accuracy30: 0.6370 - val_loss: 2.2432 - val_accuracy30: 0.6745 - 43s/epoch - 23ms/step
Epoch 13/50
1876/1876 - 40s - loss: 2.1643 - accuracy30: 0.6377 - val_loss: 2.2202 - val_accuracy30: 0.6746 - 40s/epoch - 21ms/step
Epoch 14/50
1876/1876 - 41s - loss: 2.1593 - accuracy30: 0.6387 - val_loss: 2.2150 - val_accuracy30: 0.6777 - 41s/epoch - 22ms/step
Epoch 15/50
1876/1876 - 43s - loss: 2.1552 - accuracy30: 0.6390 - val_loss: 2.2240 - val_accuracy30: 0.6748 - 43s/epoch - 23ms/step
Epoch 16/50
1876/1876 - 42s - loss: 2.1504 - accuracy30: 0.6394 - val_loss: 2.2258 - val_accuracy30: 0.6743 - 42s/epoch - 22ms/step
Epoch 17/50
1876/1876 - 45s - loss: 2.1469 - accuracy30: 0.6402 - val_loss: 2.2222 - val_accuracy30: 0.6715 - 45s/epoch - 24ms/step
Epoch 18/50
1876/1876 - 40s - loss: 2.1425 - accuracy30: 0.6414 - val_loss: 2.2219 - val_accuracy30: 0.6743 - 40s/epoch - 22ms/step
Epoch 19/50
1876/1876 - 45s - loss: 2.1391 - accuracy30: 0.6413 - val_loss: 2.2050 - val_accuracy30: 0.6771 - 45s/epoch - 24ms/step
Epoch 20/50
1876/1876 - 47s - loss: 2.1349 - accuracy30: 0.6418 - val_loss: 2.2149 - val_accuracy30: 0.6747 - 47s/epoch - 25ms/step
Epoch 21/50
1876/1876 - 46s - loss: 2.1304 - accuracy30: 0.6427 - val_loss: 2.2216 - val_accuracy30: 0.6787 - 46s/epoch - 25ms/step
Epoch 22/50
1876/1876 - 43s - loss: 2.1294 - accuracy30: 0.6423 - val_loss: 2.2281 - val_accuracy30: 0.6795 - 43s/epoch - 23ms/step
Epoch 23/50
1876/1876 - 40s - loss: 2.1236 - accuracy30: 0.6435 - val_loss: 2.2057 - val_accuracy30: 0.6783 - 40s/epoch - 22ms/step
Epoch 24/50
1876/1876 - 42s - loss: 2.1198 - accuracy30: 0.6437 - val_loss: 2.2329 - val_accuracy30: 0.6817 - 42s/epoch - 22ms/step
Epoch 25/50
1876/1876 - 43s - loss: 2.1178 - accuracy30: 0.6444 - val_loss: 2.2197 - val_accuracy30: 0.6736 - 43s/epoch - 23ms/step
Epoch 26/50
1876/1876 - 48s - loss: 2.1145 - accuracy30: 0.6445 - val_loss: 2.2547 - val_accuracy30: 0.6777 - 48s/epoch - 26ms/step
Epoch 27/50
1876/1876 - 45s - loss: 2.1115 - accuracy30: 0.6451 - val_loss: 2.2612 - val_accuracy30: 0.6750 - 45s/epoch - 24ms/step
Epoch 28/50
1876/1876 - 48s - loss: 2.1083 - accuracy30: 0.6461 - val_loss: 2.2459 - val_accuracy30: 0.6812 - 48s/epoch - 25ms/step
Epoch 29/50
1876/1876 - 48s - loss: 2.1044 - accuracy30: 0.6465 - val_loss: 2.2412 - val_accuracy30: 0.6750 - 48s/epoch - 25ms/step
testing model: results/EXC/W3/deepVOL_L2/h30
Evaluating performance on  test set...
5098/5098 - 55s - 55s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7249028
{'0': {'precision': 0.46883421904256817, 'recall': 0.6871324272984324, 'f1-score': 0.5573710901624974, 'support': 252161}, '1': {'precision': 0.7949907275972515, 'recall': 0.6812816230777642, 'f1-score': 0.733756983230878, 'support': 804792}, '2': {'precision': 0.5258733686670086, 'recall': 0.520995491171892, 'f1-score': 0.5234230657028945, 'support': 247958}, 'accuracy': 0.6519548076458854, 'macro avg': {'precision': 0.596566105102276, 'recall': 0.6298031805160296, 'f1-score': 0.6048503796987567, 'support': 1304911}, 'weighted avg': {'precision': 0.6808268088018068, 'recall': 0.6519548076458854, 'f1-score': 0.6597047139922712, 'support': 1304911}}
[[173268  55559  23334]
 [163363 548290  93139]
 [ 32941  85832 129185]]
Evaluating performance on  train set...
1876/1876 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72001666
{'0': {'precision': 0.4594347127782531, 'recall': 0.6691223889732968, 'f1-score': 0.5447984016304082, 'support': 91487}, '1': {'precision': 0.8088026166097838, 'recall': 0.6939149001067562, 'f1-score': 0.7469669857009177, 'support': 295065}, '2': {'precision': 0.5371004018632812, 'recall': 0.538006513266777, 'f1-score': 0.5375530757249237, 'support': 93655}, 'accuracy': 0.658784649120067, 'macro avg': {'precision': 0.6017792437504393, 'recall': 0.6336812674489433, 'f1-score': 0.6097728210187499, 'support': 480207}, 'weighted avg': {'precision': 0.6892523136364433, 'recall': 0.658784649120067, 'f1-score': 0.6676085902804836, 'support': 480207}}
[[ 61216  19408  10863]
 [ 57752 204750  32563]
 [ 14274  28994  50387]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.68435913
{'0': {'precision': 0.4602093610877151, 'recall': 0.6851778868546451, 'f1-score': 0.5506002936688452, 'support': 27911}, '1': {'precision': 0.8111206140107297, 'recall': 0.7178342884666424, 'f1-score': 0.7616316058447451, 'support': 101731}, '2': {'precision': 0.5602926902113045, 'recall': 0.5223807866341803, 'f1-score': 0.5406729591469126, 'support': 28730}, 'accuracy': 0.6766221301745258, 'macro avg': {'precision': 0.6105408884365832, 'recall': 0.641797653985156, 'f1-score': 0.6176349528868343, 'support': 158372}, 'weighted avg': {'precision': 0.7037748064747273, 'recall': 0.6766221301745258, 'f1-score': 0.6843563496519188, 'support': 158372}}
[[19124  6532  2255]
 [19182 73026  9523]
 [ 3249 10473 15008]]
training model: results/EXC/W3/deepVOL_L2/h50
Epoch 1/50
1876/1876 - 43s - loss: 2.7496 - accuracy50: 0.5470 - val_loss: 2.7839 - val_accuracy50: 0.5943 - 43s/epoch - 23ms/step
Epoch 2/50
1876/1876 - 45s - loss: 2.5928 - accuracy50: 0.5782 - val_loss: 2.6773 - val_accuracy50: 0.6079 - 45s/epoch - 24ms/step
Epoch 3/50
1876/1876 - 44s - loss: 2.5492 - accuracy50: 0.5860 - val_loss: 2.6552 - val_accuracy50: 0.6221 - 44s/epoch - 24ms/step
Epoch 4/50
1876/1876 - 42s - loss: 2.5200 - accuracy50: 0.5898 - val_loss: 2.5988 - val_accuracy50: 0.6207 - 42s/epoch - 23ms/step
Epoch 5/50
1876/1876 - 42s - loss: 2.4921 - accuracy50: 0.5921 - val_loss: 2.5614 - val_accuracy50: 0.6209 - 42s/epoch - 22ms/step
Epoch 6/50
1876/1876 - 41s - loss: 2.4738 - accuracy50: 0.5946 - val_loss: 2.5320 - val_accuracy50: 0.6197 - 41s/epoch - 22ms/step
Epoch 7/50
1876/1876 - 42s - loss: 2.4604 - accuracy50: 0.5960 - val_loss: 2.5273 - val_accuracy50: 0.6201 - 42s/epoch - 22ms/step
Epoch 8/50
1876/1876 - 42s - loss: 2.4502 - accuracy50: 0.5973 - val_loss: 2.5146 - val_accuracy50: 0.6155 - 42s/epoch - 23ms/step
Epoch 9/50
1876/1876 - 47s - loss: 2.4409 - accuracy50: 0.5992 - val_loss: 2.5179 - val_accuracy50: 0.6137 - 47s/epoch - 25ms/step
Epoch 10/50
1876/1876 - 45s - loss: 2.4351 - accuracy50: 0.5999 - val_loss: 2.5306 - val_accuracy50: 0.6135 - 45s/epoch - 24ms/step
Epoch 11/50
1876/1876 - 48s - loss: 2.4281 - accuracy50: 0.6009 - val_loss: 2.5086 - val_accuracy50: 0.6152 - 48s/epoch - 26ms/step
Epoch 12/50
1876/1876 - 47s - loss: 2.4225 - accuracy50: 0.6015 - val_loss: 2.5083 - val_accuracy50: 0.6134 - 47s/epoch - 25ms/step
Epoch 13/50
1876/1876 - 44s - loss: 2.4174 - accuracy50: 0.6024 - val_loss: 2.4958 - val_accuracy50: 0.6155 - 44s/epoch - 24ms/step
Epoch 14/50
1876/1876 - 46s - loss: 2.4120 - accuracy50: 0.6024 - val_loss: 2.4975 - val_accuracy50: 0.6135 - 46s/epoch - 25ms/step
Epoch 15/50
1876/1876 - 44s - loss: 2.4077 - accuracy50: 0.6035 - val_loss: 2.4917 - val_accuracy50: 0.6142 - 44s/epoch - 23ms/step
Epoch 16/50
1876/1876 - 43s - loss: 2.4049 - accuracy50: 0.6039 - val_loss: 2.4829 - val_accuracy50: 0.6140 - 43s/epoch - 23ms/step
Epoch 17/50
1876/1876 - 42s - loss: 2.4011 - accuracy50: 0.6048 - val_loss: 2.4913 - val_accuracy50: 0.6133 - 42s/epoch - 23ms/step
Epoch 18/50
1876/1876 - 41s - loss: 2.3977 - accuracy50: 0.6049 - val_loss: 2.4858 - val_accuracy50: 0.6132 - 41s/epoch - 22ms/step
Epoch 19/50
1876/1876 - 44s - loss: 2.3944 - accuracy50: 0.6056 - val_loss: 2.4992 - val_accuracy50: 0.6101 - 44s/epoch - 24ms/step
Epoch 20/50
1876/1876 - 41s - loss: 2.3909 - accuracy50: 0.6061 - val_loss: 2.4819 - val_accuracy50: 0.6080 - 41s/epoch - 22ms/step
Epoch 21/50
1876/1876 - 41s - loss: 2.3883 - accuracy50: 0.6061 - val_loss: 2.4898 - val_accuracy50: 0.6108 - 41s/epoch - 22ms/step
Epoch 22/50
1876/1876 - 46s - loss: 2.3853 - accuracy50: 0.6071 - val_loss: 2.5058 - val_accuracy50: 0.6073 - 46s/epoch - 24ms/step
Epoch 23/50
1876/1876 - 42s - loss: 2.3811 - accuracy50: 0.6074 - val_loss: 2.4914 - val_accuracy50: 0.6079 - 42s/epoch - 22ms/step
Epoch 24/50
1876/1876 - 44s - loss: 2.3788 - accuracy50: 0.6077 - val_loss: 2.4884 - val_accuracy50: 0.6101 - 44s/epoch - 23ms/step
Epoch 25/50
1876/1876 - 44s - loss: 2.3765 - accuracy50: 0.6083 - val_loss: 2.4982 - val_accuracy50: 0.6105 - 44s/epoch - 24ms/step
Epoch 26/50
1876/1876 - 46s - loss: 2.3739 - accuracy50: 0.6086 - val_loss: 2.4879 - val_accuracy50: 0.6057 - 46s/epoch - 25ms/step
Epoch 27/50
1876/1876 - 46s - loss: 2.3710 - accuracy50: 0.6090 - val_loss: 2.5171 - val_accuracy50: 0.6102 - 46s/epoch - 24ms/step
Epoch 28/50
1876/1876 - 44s - loss: 2.3680 - accuracy50: 0.6093 - val_loss: 2.5044 - val_accuracy50: 0.6115 - 44s/epoch - 24ms/step
Epoch 29/50
1876/1876 - 45s - loss: 2.3645 - accuracy50: 0.6096 - val_loss: 2.5054 - val_accuracy50: 0.6135 - 45s/epoch - 24ms/step
Epoch 30/50
1876/1876 - 47s - loss: 2.3632 - accuracy50: 0.6100 - val_loss: 2.5067 - val_accuracy50: 0.6123 - 47s/epoch - 25ms/step
testing model: results/EXC/W3/deepVOL_L2/h50
Evaluating performance on  test set...
5098/5098 - 50s - 50s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8428646
{'0': {'precision': 0.48878555095958687, 'recall': 0.6584867783469472, 'f1-score': 0.561085305610853, 'support': 317812}, '1': {'precision': 0.6923458926054081, 'recall': 0.5761952869933104, 'f1-score': 0.6289530788659244, 'support': 675068}, '2': {'precision': 0.512122867067587, 'recall': 0.516900564367002, 'f1-score': 0.5145006244288032, 'support': 312031}, 'accuracy': 0.5820588530558789, 'macro avg': {'precision': 0.5644181035441941, 'recall': 0.5838608765690866, 'f1-score': 0.5681796696351936, 'support': 1304911}, 'weighted avg': {'precision': 0.599673602939114, 'recall': 0.5820588530558789, 'f1-score': 0.5850559038369683, 'support': 1304911}}
[[209275  73267  35270]
 [167714 388971 118383]
 [ 51164  99578 161289]]
Evaluating performance on  train set...
1876/1876 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82776654
{'0': {'precision': 0.4770762229806598, 'recall': 0.6595800456130233, 'f1-score': 0.5536765434000461, 'support': 114441}, '1': {'precision': 0.7223654182408965, 'recall': 0.6085825643331072, 'f1-score': 0.6606103384572485, 'support': 249133}, '2': {'precision': 0.5405366828432772, 'recall': 0.5195099157185359, 'f1-score': 0.5298147589505484, 'support': 116633}, 'accuracy': 0.5991020539059198, 'macro avg': {'precision': 0.5799927746882778, 'recall': 0.5958908418882222, 'f1-score': 0.5813672136026143, 'support': 480207}, 'weighted avg': {'precision': 0.6197463983382143, 'recall': 0.5991020539059198, 'f1-score': 0.603358588139685, 'support': 480207}}
[[ 75483  24668  14290]
 [ 60301 151618  37214]
 [ 22436  33605  60592]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8080119
{'0': {'precision': 0.4836921543795545, 'recall': 0.648120844576738, 'f1-score': 0.553962479492118, 'support': 35947}, '1': {'precision': 0.7036554025545625, 'recall': 0.6436917390846677, 'f1-score': 0.6723392298670836, 'support': 85499}, '2': {'precision': 0.5615153788447111, 'recall': 0.4864864864864865, 'f1-score': 0.5213151861632666, 'support': 36926}, 'accuracy': 0.6080430884247215, 'macro avg': {'precision': 0.582954311926276, 'recall': 0.592766356715964, 'f1-score': 0.582538965174156, 'support': 158372}, 'weighted avg': {'precision': 0.6205871745997663, 'recall': 0.6080430884247215, 'f1-score': 0.6102575305544776, 'support': 158372}}
[[23298  9410  3239]
 [19675 55035 10789]
 [ 5194 13768 17964]]
training model: results/EXC/W3/deepVOL_L2/h100
Epoch 1/50
1876/1876 - 44s - loss: 3.0294 - accuracy100: 0.4795 - val_loss: 3.0504 - val_accuracy100: 0.4837 - 44s/epoch - 23ms/step
Epoch 2/50
1876/1876 - 43s - loss: 2.9209 - accuracy100: 0.5053 - val_loss: 3.0213 - val_accuracy100: 0.4894 - 43s/epoch - 23ms/step
Epoch 3/50
1876/1876 - 40s - loss: 2.8923 - accuracy100: 0.5103 - val_loss: 3.0111 - val_accuracy100: 0.4925 - 40s/epoch - 22ms/step
Epoch 4/50
1876/1876 - 44s - loss: 2.8773 - accuracy100: 0.5140 - val_loss: 3.0062 - val_accuracy100: 0.4895 - 44s/epoch - 23ms/step
Epoch 5/50
1876/1876 - 41s - loss: 2.8671 - accuracy100: 0.5160 - val_loss: 2.9995 - val_accuracy100: 0.4934 - 41s/epoch - 22ms/step
Epoch 6/50
1876/1876 - 46s - loss: 2.8572 - accuracy100: 0.5176 - val_loss: 3.0052 - val_accuracy100: 0.4907 - 46s/epoch - 24ms/step
Epoch 7/50
1876/1876 - 39s - loss: 2.8465 - accuracy100: 0.5201 - val_loss: 2.9976 - val_accuracy100: 0.4916 - 39s/epoch - 21ms/step
Epoch 8/50
1876/1876 - 40s - loss: 2.8384 - accuracy100: 0.5215 - val_loss: 3.0052 - val_accuracy100: 0.4895 - 40s/epoch - 21ms/step
Epoch 9/50
1876/1876 - 40s - loss: 2.8312 - accuracy100: 0.5235 - val_loss: 2.9799 - val_accuracy100: 0.4935 - 40s/epoch - 21ms/step
Epoch 10/50
1876/1876 - 43s - loss: 2.8266 - accuracy100: 0.5242 - val_loss: 2.9826 - val_accuracy100: 0.4929 - 43s/epoch - 23ms/step
Epoch 11/50
1876/1876 - 41s - loss: 2.8209 - accuracy100: 0.5258 - val_loss: 2.9980 - val_accuracy100: 0.4911 - 41s/epoch - 22ms/step
Epoch 12/50
1876/1876 - 40s - loss: 2.8160 - accuracy100: 0.5263 - val_loss: 2.9942 - val_accuracy100: 0.4924 - 40s/epoch - 21ms/step
Epoch 13/50
1876/1876 - 42s - loss: 2.8118 - accuracy100: 0.5276 - val_loss: 2.9802 - val_accuracy100: 0.4950 - 42s/epoch - 22ms/step
Epoch 14/50
1876/1876 - 40s - loss: 2.8067 - accuracy100: 0.5292 - val_loss: 2.9839 - val_accuracy100: 0.4956 - 40s/epoch - 21ms/step
Epoch 15/50
1876/1876 - 45s - loss: 2.8044 - accuracy100: 0.5293 - val_loss: 2.9792 - val_accuracy100: 0.4946 - 45s/epoch - 24ms/step
Epoch 16/50
1876/1876 - 43s - loss: 2.8011 - accuracy100: 0.5303 - val_loss: 2.9778 - val_accuracy100: 0.4933 - 43s/epoch - 23ms/step
Epoch 17/50
1876/1876 - 42s - loss: 2.7975 - accuracy100: 0.5310 - val_loss: 2.9740 - val_accuracy100: 0.4946 - 42s/epoch - 22ms/step
Epoch 18/50
1876/1876 - 41s - loss: 2.7948 - accuracy100: 0.5311 - val_loss: 2.9826 - val_accuracy100: 0.4944 - 41s/epoch - 22ms/step
Epoch 19/50
1876/1876 - 43s - loss: 2.7920 - accuracy100: 0.5319 - val_loss: 2.9797 - val_accuracy100: 0.4948 - 43s/epoch - 23ms/step
Epoch 20/50
1876/1876 - 42s - loss: 2.7896 - accuracy100: 0.5326 - val_loss: 2.9740 - val_accuracy100: 0.4968 - 42s/epoch - 23ms/step
Epoch 21/50
1876/1876 - 41s - loss: 2.7861 - accuracy100: 0.5336 - val_loss: 2.9737 - val_accuracy100: 0.4955 - 41s/epoch - 22ms/step
Epoch 22/50
1876/1876 - 41s - loss: 2.7837 - accuracy100: 0.5339 - val_loss: 2.9826 - val_accuracy100: 0.4946 - 41s/epoch - 22ms/step
Epoch 23/50
1876/1876 - 39s - loss: 2.7802 - accuracy100: 0.5355 - val_loss: 2.9790 - val_accuracy100: 0.4956 - 39s/epoch - 21ms/step
Epoch 24/50
1876/1876 - 44s - loss: 2.7772 - accuracy100: 0.5364 - val_loss: 2.9985 - val_accuracy100: 0.4930 - 44s/epoch - 24ms/step
Epoch 25/50
1876/1876 - 40s - loss: 2.7743 - accuracy100: 0.5366 - val_loss: 2.9884 - val_accuracy100: 0.4927 - 40s/epoch - 21ms/step
Epoch 26/50
1876/1876 - 43s - loss: 2.7725 - accuracy100: 0.5371 - val_loss: 2.9971 - val_accuracy100: 0.4922 - 43s/epoch - 23ms/step
Epoch 27/50
1876/1876 - 47s - loss: 2.7687 - accuracy100: 0.5381 - val_loss: 2.9924 - val_accuracy100: 0.4926 - 47s/epoch - 25ms/step
Epoch 28/50
1876/1876 - 41s - loss: 2.7654 - accuracy100: 0.5393 - val_loss: 2.9965 - val_accuracy100: 0.4902 - 41s/epoch - 22ms/step
Epoch 29/50
1876/1876 - 39s - loss: 2.7644 - accuracy100: 0.5397 - val_loss: 3.0044 - val_accuracy100: 0.4908 - 39s/epoch - 21ms/step
Epoch 30/50
1876/1876 - 39s - loss: 2.7605 - accuracy100: 0.5400 - val_loss: 3.0174 - val_accuracy100: 0.4911 - 39s/epoch - 21ms/step
Epoch 31/50
1876/1876 - 45s - loss: 2.7584 - accuracy100: 0.5406 - val_loss: 3.0019 - val_accuracy100: 0.4904 - 45s/epoch - 24ms/step
testing model: results/EXC/W3/deepVOL_L2/h100
Evaluating performance on  test set...
5098/5098 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9928997
{'0': {'precision': 0.5196904778061051, 'recall': 0.5154049708340244, 'f1-score': 0.5175388528821543, 'support': 416067}, '1': {'precision': 0.44825362870741303, 'recall': 0.6739513723674501, 'f1-score': 0.5384063481212326, 'support': 483799}, '2': {'precision': 0.5677549262801657, 'recall': 0.23111506128948636, 'f1-score': 0.3285058060169215, 'support': 405045}, 'accuracy': 0.48594271946515893, 'macro avg': {'precision': 0.5118996775978947, 'recall': 0.4734904681636536, 'f1-score': 0.4614836690067694, 'support': 1304911}, 'weighted avg': {'precision': 0.5081243161100797, 'recall': 0.48594271946515893, 'f1-score': 0.46659958028934345, 'support': 1304911}}
[[214443 167674  33950]
 [120423 326057  37319]
 [ 77770 233663  93612]]
Evaluating performance on  train set...
1876/1876 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9835475
{'0': {'precision': 0.5128563897981895, 'recall': 0.5222886455820366, 'f1-score': 0.5175295442679687, 'support': 150884}, '1': {'precision': 0.46635757267629363, 'recall': 0.6922661019621978, 'f1-score': 0.557288006492535, 'support': 177556}, '2': {'precision': 0.6123178050871677, 'recall': 0.2541066239696377, 'f1-score': 0.3591634885377813, 'support': 151767}, 'accuracy': 0.500380044439169, 'macro avg': {'precision': 0.5305105891872169, 'recall': 0.48955379050462405, 'f1-score': 0.477993679766095, 'support': 480207}, 'weighted avg': {'precision': 0.5270977828667349, 'recall': 0.500380044439169, 'f1-score': 0.48217939805756727, 'support': 480207}}
[[ 78805  58979  13100]
 [ 43323 122916  11317]
 [ 31531  81671  38565]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9819037
{'0': {'precision': 0.5141908401729215, 'recall': 0.5111378687537628, 'f1-score': 0.5126598092699787, 'support': 48169}, '1': {'precision': 0.4592407056996292, 'recall': 0.6886275667519517, 'f1-score': 0.5510141142658416, 'support': 60972}, '2': {'precision': 0.6192949323260938, 'recall': 0.23978793849403832, 'f1-score': 0.345716252031687, 'support': 49231}, 'accuracy': 0.49511908670724625, 'macro avg': {'precision': 0.5309088260662148, 'recall': 0.4798511246665842, 'f1-score': 0.4697967251891691, 'support': 158372}, 'weighted avg': {'precision': 0.5257077747427144, 'recall': 0.49511908670724625, 'f1-score': 0.4755303950920269, 'support': 158372}}
[[24621 20109  3439]
 [15167 41987  3818]
 [ 8095 29331 11805]]
training model: results/EXC/W3/deepVOL_L2/h200
Epoch 1/50
1876/1876 - 47s - loss: 3.2094 - accuracy200: 0.4128 - val_loss: 3.2571 - val_accuracy200: 0.3992 - 47s/epoch - 25ms/step
Epoch 2/50
1876/1876 - 40s - loss: 3.1530 - accuracy200: 0.4291 - val_loss: 3.2278 - val_accuracy200: 0.4076 - 40s/epoch - 21ms/step
Epoch 3/50
1876/1876 - 41s - loss: 3.1348 - accuracy200: 0.4346 - val_loss: 3.2426 - val_accuracy200: 0.4021 - 41s/epoch - 22ms/step
Epoch 4/50
1876/1876 - 43s - loss: 3.1272 - accuracy200: 0.4364 - val_loss: 3.2431 - val_accuracy200: 0.3984 - 43s/epoch - 23ms/step
Epoch 5/50
1876/1876 - 43s - loss: 3.1208 - accuracy200: 0.4385 - val_loss: 3.2568 - val_accuracy200: 0.3961 - 43s/epoch - 23ms/step
Epoch 6/50
1876/1876 - 46s - loss: 3.1164 - accuracy200: 0.4403 - val_loss: 3.2514 - val_accuracy200: 0.3985 - 46s/epoch - 24ms/step
Epoch 7/50
1876/1876 - 45s - loss: 3.1119 - accuracy200: 0.4420 - val_loss: 3.2574 - val_accuracy200: 0.3972 - 45s/epoch - 24ms/step
Epoch 8/50
1876/1876 - 47s - loss: 3.1094 - accuracy200: 0.4429 - val_loss: 3.2752 - val_accuracy200: 0.3928 - 47s/epoch - 25ms/step
Epoch 9/50
1876/1876 - 43s - loss: 3.1065 - accuracy200: 0.4441 - val_loss: 3.2632 - val_accuracy200: 0.3952 - 43s/epoch - 23ms/step
Epoch 10/50
1876/1876 - 46s - loss: 3.1034 - accuracy200: 0.4454 - val_loss: 3.2684 - val_accuracy200: 0.3936 - 46s/epoch - 25ms/step
Epoch 11/50
1876/1876 - 46s - loss: 3.1001 - accuracy200: 0.4470 - val_loss: 3.2840 - val_accuracy200: 0.3933 - 46s/epoch - 24ms/step
Epoch 12/50
1876/1876 - 46s - loss: 3.0986 - accuracy200: 0.4476 - val_loss: 3.2721 - val_accuracy200: 0.3965 - 46s/epoch - 24ms/step
testing model: results/EXC/W3/deepVOL_L2/h200
Evaluating performance on  test set...
5098/5098 - 54s - 54s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.073768
{'0': {'precision': 0.43432496845646995, 'recall': 0.5211589833998371, 'f1-score': 0.4737962549474212, 'support': 445839}, '1': {'precision': 0.3710358652436419, 'recall': 0.5312298161507182, 'f1-score': 0.4369119175054874, 'support': 439708}, '2': {'precision': 0.4870107205185739, 'recall': 0.16303020764777137, 'f1-score': 0.24428449179900275, 'support': 419364}, 'accuracy': 0.4094593424379134, 'macro avg': {'precision': 0.43079051807289526, 'recall': 0.4051396690661089, 'f1-score': 0.3849975547506372, 'support': 1304911}, 'weighted avg': {'precision': 0.4299306325456423, 'recall': 0.4094593424379134, 'f1-score': 0.38760853081229535, 'support': 1304911}}
[[232353 179494  33992]
 [168098 233586  38024]
 [134524 216471  68369]]
Evaluating performance on  train set...
1876/1876 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0786752
{'0': {'precision': 0.4303463530943877, 'recall': 0.551595264834214, 'f1-score': 0.4834849776635029, 'support': 162951}, '1': {'precision': 0.36769861008179466, 'recall': 0.523148777064048, 'f1-score': 0.4318609022556391, 'support': 154587}, '2': {'precision': 0.5193370165745856, 'recall': 0.1641124000270488, 'f1-score': 0.24941024790608812, 'support': 162669}, 'accuracy': 0.4111789290868313, 'macro avg': {'precision': 0.43912732658358933, 'recall': 0.412952147308437, 'f1-score': 0.38825204260841, 'support': 480207}, 'weighted avg': {'precision': 0.44032433256693304, 'recall': 0.4111789290868313, 'f1-score': 0.3875740201806167, 'support': 480207}}
[[89883 60758 12310]
 [61317 80872 12398]
 [57662 78311 26696]]
Evaluating performance on  val set...
619/619 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0762434
{'0': {'precision': 0.4146946809876332, 'recall': 0.5639220250218213, 'f1-score': 0.47793066035409576, 'support': 51555}, '1': {'precision': 0.3734514489767889, 'recall': 0.5008842058726006, 'f1-score': 0.42788128658651725, 'support': 54286}, '2': {'precision': 0.5349077968295051, 'recall': 0.1573737412194704, 'f1-score': 0.2431971288206395, 'support': 52531}, 'accuracy': 0.40746470335665397, 'macro avg': {'precision': 0.44101797559797573, 'recall': 0.40739332403796413, 'f1-score': 0.38300302525375085, 'support': 158372}, 'weighted avg': {'precision': 0.44043145955549046, 'recall': 0.4074647033566539, 'f1-score': 0.3829153328383054, 'support': 158372}}
[[29073 19196  3286]
 [23193 27191  3902]
 [17841 26423  8267]]
training model: results/EXC/W3/deepVOL_L2/h300
Epoch 1/50
1876/1876 - 44s - loss: 3.2602 - accuracy300: 0.3921 - val_loss: 3.3033 - val_accuracy300: 0.3719 - 44s/epoch - 23ms/step
Epoch 2/50
1876/1876 - 41s - loss: 3.2290 - accuracy300: 0.4017 - val_loss: 3.3480 - val_accuracy300: 0.3669 - 41s/epoch - 22ms/step
Epoch 3/50
1876/1876 - 44s - loss: 3.2044 - accuracy300: 0.4111 - val_loss: 3.3676 - val_accuracy300: 0.3711 - 44s/epoch - 23ms/step
Epoch 4/50
1876/1876 - 41s - loss: 3.1954 - accuracy300: 0.4147 - val_loss: 3.3857 - val_accuracy300: 0.3701 - 41s/epoch - 22ms/step
Epoch 5/50
1876/1876 - 40s - loss: 3.1870 - accuracy300: 0.4191 - val_loss: 3.3934 - val_accuracy300: 0.3715 - 40s/epoch - 21ms/step
Epoch 6/50
1876/1876 - 45s - loss: 3.1814 - accuracy300: 0.4217 - val_loss: 3.3846 - val_accuracy300: 0.3662 - 45s/epoch - 24ms/step
Epoch 7/50
1876/1876 - 39s - loss: 3.1794 - accuracy300: 0.4236 - val_loss: 3.4080 - val_accuracy300: 0.3623 - 39s/epoch - 21ms/step
Epoch 8/50
1876/1876 - 42s - loss: 3.1765 - accuracy300: 0.4242 - val_loss: 3.3772 - val_accuracy300: 0.3670 - 42s/epoch - 23ms/step
Epoch 9/50
1876/1876 - 40s - loss: 3.1748 - accuracy300: 0.4264 - val_loss: 3.3881 - val_accuracy300: 0.3602 - 40s/epoch - 22ms/step
Epoch 10/50
1876/1876 - 41s - loss: 3.1715 - accuracy300: 0.4282 - val_loss: 3.3920 - val_accuracy300: 0.3600 - 41s/epoch - 22ms/step
Epoch 11/50
1876/1876 - 41s - loss: 3.1702 - accuracy300: 0.4298 - val_loss: 3.4041 - val_accuracy300: 0.3591 - 41s/epoch - 22ms/step
testing model: results/EXC/W3/deepVOL_L2/h300
Evaluating performance on  test set...
5098/5098 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0980256
{'0': {'precision': 0.4042314503693429, 'recall': 0.6439568172456406, 'f1-score': 0.49668099949778555, 'support': 466112}, '1': {'precision': 0.31643911184664186, 'recall': 0.21632209516673656, 'f1-score': 0.2569735587585599, 'support': 403061}, '2': {'precision': 0.4276420836848674, 'recall': 0.28150861297385127, 'f1-score': 0.33951861119107196, 'support': 435738}, 'accuracy': 0.39083968178672723, 'macro avg': {'precision': 0.3827708819669507, 'recall': 0.38059584179540945, 'f1-score': 0.36439105648247244, 'support': 1304911}, 'weighted avg': {'precision': 0.3849314634601526, 'recall': 0.39083968178672723, 'f1-score': 0.37016022871128457, 'support': 1304911}}
[[300156  88451  77505]
 [229201  87191  86669]
 [213178  99896 122664]]
Evaluating performance on  train set...
1876/1876 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1021214
{'0': {'precision': 0.37820850899440683, 'recall': 0.6937139547493468, 'f1-score': 0.4895289153247634, 'support': 162296}, '1': {'precision': 0.33611538856380246, 'recall': 0.20787936507936508, 'f1-score': 0.2568828213879409, 'support': 157500}, '2': {'precision': 0.4226783532286869, 'recall': 0.22426766244210186, 'f1-score': 0.2930479018258982, 'support': 160411}, 'accuracy': 0.3775517641350501, 'macro avg': {'precision': 0.37900075026229874, 'recall': 0.3752869940902713, 'f1-score': 0.34648654617953417, 'support': 480207}, 'weighted avg': {'precision': 0.3792576101437964, 'recall': 0.3775517641350501, 'f1-score': 0.34759121834946727, 'support': 480207}}
[[112587  29006  20703]
 [ 96325  32741  28434]
 [ 88773  35663  35975]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003859
{'0': {'precision': 0.3624941181181983, 'recall': 0.7104008476072753, 'f1-score': 0.4800397746105403, 'support': 50967}, '1': {'precision': 0.341454802259887, 'recall': 0.1920521431408659, 'f1-score': 0.24583420000462222, 'support': 55386}, '2': {'precision': 0.4392947287558986, 'recall': 0.23085795574693863, 'f1-score': 0.30266142446695904, 'support': 52019}, 'accuracy': 0.3716124062334251, 'macro avg': {'precision': 0.38108121637799464, 'recall': 0.37777031549836, 'f1-score': 0.34284513302737385, 'support': 158372}, 'weighted avg': {'precision': 0.3803622224335703, 'recall': 0.3716124062334251, 'f1-score': 0.3398713461557482, 'support': 158372}}
[[36207  8723  6037]
 [35458 10637  9291]
 [28218 11792 12009]]
training model: results/EXC/W3/deepVOL_L2/h500
Epoch 1/50
1876/1876 - 43s - loss: 3.2820 - accuracy500: 0.3775 - val_loss: 3.3936 - val_accuracy500: 0.3472 - 43s/epoch - 23ms/step
Epoch 2/50
1876/1876 - 42s - loss: 3.2443 - accuracy500: 0.3988 - val_loss: 3.3822 - val_accuracy500: 0.3669 - 42s/epoch - 22ms/step
Epoch 3/50
1876/1876 - 40s - loss: 3.2246 - accuracy500: 0.4105 - val_loss: 3.3768 - val_accuracy500: 0.3716 - 40s/epoch - 21ms/step
Epoch 4/50
1876/1876 - 40s - loss: 3.2115 - accuracy500: 0.4181 - val_loss: 3.3770 - val_accuracy500: 0.3712 - 40s/epoch - 21ms/step
Epoch 5/50
1876/1876 - 42s - loss: 3.2030 - accuracy500: 0.4228 - val_loss: 3.3715 - val_accuracy500: 0.3716 - 42s/epoch - 22ms/step
Epoch 6/50
1876/1876 - 47s - loss: 3.1970 - accuracy500: 0.4252 - val_loss: 3.3967 - val_accuracy500: 0.3667 - 47s/epoch - 25ms/step
Epoch 7/50
1876/1876 - 41s - loss: 3.1913 - accuracy500: 0.4280 - val_loss: 3.3729 - val_accuracy500: 0.3697 - 41s/epoch - 22ms/step
Epoch 8/50
1876/1876 - 42s - loss: 3.1867 - accuracy500: 0.4303 - val_loss: 3.3882 - val_accuracy500: 0.3696 - 42s/epoch - 22ms/step
Epoch 9/50
1876/1876 - 41s - loss: 3.1823 - accuracy500: 0.4324 - val_loss: 3.3812 - val_accuracy500: 0.3696 - 41s/epoch - 22ms/step
Epoch 10/50
1876/1876 - 43s - loss: 3.1801 - accuracy500: 0.4338 - val_loss: 3.3972 - val_accuracy500: 0.3681 - 43s/epoch - 23ms/step
Epoch 11/50
1876/1876 - 42s - loss: 3.1754 - accuracy500: 0.4352 - val_loss: 3.3987 - val_accuracy500: 0.3671 - 42s/epoch - 23ms/step
Epoch 12/50
1876/1876 - 45s - loss: 3.1723 - accuracy500: 0.4379 - val_loss: 3.4035 - val_accuracy500: 0.3670 - 45s/epoch - 24ms/step
Epoch 13/50
1876/1876 - 42s - loss: 3.1685 - accuracy500: 0.4393 - val_loss: 3.4087 - val_accuracy500: 0.3658 - 42s/epoch - 22ms/step
Epoch 14/50
1876/1876 - 44s - loss: 3.1653 - accuracy500: 0.4399 - val_loss: 3.4443 - val_accuracy500: 0.3651 - 44s/epoch - 24ms/step
Epoch 15/50
1876/1876 - 44s - loss: 3.1609 - accuracy500: 0.4421 - val_loss: 3.4208 - val_accuracy500: 0.3703 - 44s/epoch - 24ms/step
testing model: results/EXC/W3/deepVOL_L2/h500
Evaluating performance on  test set...
5098/5098 - 45s - 45s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1104081
{'0': {'precision': 0.39555515381762546, 'recall': 0.6431547914946593, 'f1-score': 0.4898445299890284, 'support': 462674}, '1': {'precision': 0.37427710209947074, 'recall': 0.35477417701332725, 'f1-score': 0.3642647771878571, 'support': 421392}, '2': {'precision': 0.420830341406097, 'recall': 0.15318466418752746, 'f1-score': 0.22460999764822703, 'support': 420845}, 'accuracy': 0.3920091101998527, 'macro avg': {'precision': 0.3968875324410644, 'recall': 0.38370454423183803, 'f1-score': 0.3595731016083708, 'support': 1304911}, 'weighted avg': {'precision': 0.39683534499622203, 'recall': 0.3920091101998527, 'f1-score': 0.3637509267047004, 'support': 1304911}}
[[297571 121494  43609]
 [226779 149499  45114]
 [227937 128441  64467]]
Evaluating performance on  train set...
1876/1876 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1175762
{'0': {'precision': 0.3767332905127139, 'recall': 0.724917603722373, 'f1-score': 0.49580242821033443, 'support': 165056}, '1': {'precision': 0.3817868719611021, 'recall': 0.3170854824200928, 'f1-score': 0.3464411597297593, 'support': 154523}, '2': {'precision': 0.45168821314967755, 'recall': 0.09635928978758374, 'f1-score': 0.1588342440801457, 'support': 160628}, 'accuracy': 0.3834325613745739, 'macro avg': {'precision': 0.40340279187449785, 'recall': 0.37945412531001654, 'f1-score': 0.3336926106734132, 'support': 480207}, 'weighted avg': {'precision': 0.4034316807475074, 'recall': 0.3834325613745739, 'f1-score': 0.3350253533865858, 'support': 480207}}
[[119652  36841   8563]
 [ 95300  48997  10226]
 [102652  42498  15478]]
Evaluating performance on  val set...
619/619 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1223409
{'0': {'precision': 0.35997663573064337, 'recall': 0.7447775795591874, 'f1-score': 0.4853614021051579, 'support': 52131}, '1': {'precision': 0.3775213876461816, 'recall': 0.2769354776801136, 'f1-score': 0.31949872134087615, 'support': 52106}, '2': {'precision': 0.4619264562316954, 'recall': 0.104885933314861, 'f1-score': 0.17095458172128805, 'support': 54135}, 'accuracy': 0.37212386027833205, 'macro avg': {'precision': 0.39980815986950674, 'recall': 0.37553299685138736, 'f1-score': 0.32527156838910737, 'support': 158372}, 'weighted avg': {'precision': 0.4005977074866071, 'recall': 0.37212386027833205, 'f1-score': 0.3233197908014902, 'support': 158372}}
[[38826 10258  3047]
 [34109 14430  3567]
 [34922 13535  5678]]
training model: results/EXC/W3/deepVOL_L2/h1000
Epoch 1/50
1876/1876 - 47s - loss: 3.2354 - accuracy1000: 0.4183 - val_loss: 3.4716 - val_accuracy1000: 0.3173 - 47s/epoch - 25ms/step
Epoch 2/50
1876/1876 - 42s - loss: 3.2222 - accuracy1000: 0.4230 - val_loss: 3.4615 - val_accuracy1000: 0.3207 - 42s/epoch - 22ms/step
Epoch 3/50
1876/1876 - 42s - loss: 3.2273 - accuracy1000: 0.4167 - val_loss: 3.4758 - val_accuracy1000: 0.3199 - 42s/epoch - 23ms/step
Epoch 4/50
1876/1876 - 44s - loss: 3.2257 - accuracy1000: 0.4159 - val_loss: 3.4593 - val_accuracy1000: 0.3184 - 44s/epoch - 23ms/step
Epoch 5/50
1876/1876 - 44s - loss: 3.2199 - accuracy1000: 0.4178 - val_loss: 3.5507 - val_accuracy1000: 0.3168 - 44s/epoch - 23ms/step
Epoch 6/50
1876/1876 - 43s - loss: 3.2099 - accuracy1000: 0.4248 - val_loss: 3.4960 - val_accuracy1000: 0.3165 - 43s/epoch - 23ms/step
Epoch 7/50
1876/1876 - 45s - loss: 3.2138 - accuracy1000: 0.4218 - val_loss: 3.5936 - val_accuracy1000: 0.3155 - 45s/epoch - 24ms/step
Epoch 8/50
1876/1876 - 44s - loss: 3.2096 - accuracy1000: 0.4222 - val_loss: 3.5876 - val_accuracy1000: 0.3157 - 44s/epoch - 23ms/step
Epoch 9/50
1876/1876 - 41s - loss: 3.1917 - accuracy1000: 0.4338 - val_loss: 3.5507 - val_accuracy1000: 0.3140 - 41s/epoch - 22ms/step
Epoch 10/50
1876/1876 - 41s - loss: 3.1898 - accuracy1000: 0.4355 - val_loss: 3.4537 - val_accuracy1000: 0.3225 - 41s/epoch - 22ms/step
Epoch 11/50
1876/1876 - 44s - loss: 3.1890 - accuracy1000: 0.4333 - val_loss: 3.5616 - val_accuracy1000: 0.3143 - 44s/epoch - 23ms/step
Epoch 12/50
1876/1876 - 45s - loss: 3.1855 - accuracy1000: 0.4330 - val_loss: 3.5538 - val_accuracy1000: 0.3129 - 45s/epoch - 24ms/step
Epoch 13/50
1876/1876 - 42s - loss: 3.1782 - accuracy1000: 0.4381 - val_loss: 3.6253 - val_accuracy1000: 0.3123 - 42s/epoch - 22ms/step
Epoch 14/50
1876/1876 - 42s - loss: 3.1723 - accuracy1000: 0.4409 - val_loss: 3.6631 - val_accuracy1000: 0.3132 - 42s/epoch - 23ms/step
Epoch 15/50
1876/1876 - 42s - loss: 3.1675 - accuracy1000: 0.4419 - val_loss: 3.6510 - val_accuracy1000: 0.3146 - 42s/epoch - 22ms/step
Epoch 16/50
1876/1876 - 46s - loss: 3.1629 - accuracy1000: 0.4437 - val_loss: 3.6621 - val_accuracy1000: 0.3140 - 46s/epoch - 24ms/step
Epoch 17/50
1876/1876 - 44s - loss: 3.1590 - accuracy1000: 0.4465 - val_loss: 3.6141 - val_accuracy1000: 0.3151 - 44s/epoch - 23ms/step
Epoch 18/50
1876/1876 - 40s - loss: 3.1536 - accuracy1000: 0.4485 - val_loss: 3.6228 - val_accuracy1000: 0.3167 - 40s/epoch - 21ms/step
Epoch 19/50
1876/1876 - 45s - loss: 3.1496 - accuracy1000: 0.4503 - val_loss: 3.6644 - val_accuracy1000: 0.3161 - 45s/epoch - 24ms/step
Epoch 20/50
1876/1876 - 39s - loss: 3.1433 - accuracy1000: 0.4525 - val_loss: 3.6755 - val_accuracy1000: 0.3131 - 39s/epoch - 21ms/step
testing model: results/EXC/W3/deepVOL_L2/h1000
Evaluating performance on  test set...
5098/5098 - 51s - 51s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.135352
{'0': {'precision': 0.4022987162954542, 'recall': 0.8569290167470938, 'f1-score': 0.5475442358003294, 'support': 522419}, '1': {'precision': 0.25948288314314605, 'recall': 0.08361545455391747, 'f1-score': 0.1264755718060764, 'support': 322261}, '2': {'precision': 0.36566935913267096, 'recall': 0.07013434557863334, 'f1-score': 0.1176951041199485, 'support': 460231}, 'accuracy': 0.3884556111489596, 'macro avg': {'precision': 0.3424836528570904, 'recall': 0.33689293895988154, 'f1-score': 0.2639049705754514, 'support': 1304911}, 'weighted avg': {'precision': 0.35411003608363834, 'recall': 0.3884556111489596, 'f1-score': 0.2919529315275895, 'support': 1304911}}
[[447676  39032  35711]
 [275033  26946  20282]
 [390086  37867  32278]]
Evaluating performance on  train set...
1876/1876 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1423229
{'0': {'precision': 0.3522627947630737, 'recall': 0.906049698651105, 'f1-score': 0.5072946517046519, 'support': 167248}, '1': {'precision': 0.3092688151105053, 'recall': 0.08349378035077114, 'f1-score': 0.1314892141796412, 'support': 152179}, '2': {'precision': 0.38381580418017214, 'recall': 0.02135837790769996, 'f1-score': 0.040464982000506695, 'support': 160780}, 'accuracy': 0.34917233609672493, 'macro avg': {'precision': 0.3484491380179171, 'recall': 0.33696728563652534, 'f1-score': 0.22641628262826663, 'support': 480207}, 'weighted avg': {'precision': 0.3492022646677874, 'recall': 0.34917233609672493, 'f1-score': 0.23189972832337868, 'support': 480207}}
[[151535  13053   2660]
 [136620  12706   2853]
 [142021  15325   3434]]
Evaluating performance on  val set...
619/619 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1438235
{'0': {'precision': 0.3163463614770028, 'recall': 0.8921684056676545, 'f1-score': 0.4670761775208298, 'support': 49262}, '1': {'precision': 0.3620509028162938, 'recall': 0.10091554013432502, 'f1-score': 0.15783676320455645, 'support': 58217}, '2': {'precision': 0.37573872472783826, 'recall': 0.023736073723301828, 'f1-score': 0.04465143786501072, 'support': 50893}, 'accuracy': 0.32223499103376857, 'macro avg': {'precision': 0.35137866300704496, 'recall': 0.33894000650842715, 'f1-score': 0.22318812619679898, 'support': 158372}, 'weighted avg': {'precision': 0.35223298806550507, 'recall': 0.32223499103376857, 'f1-score': 0.2176542263012071, 'support': 158372}}
[[43950  4227  1085]
 [51420  5875   922]
 [43560  6125  1208]]
training model: results/EXC/W3/deepVOL_L3/h10
Epoch 1/50
1876/1876 - 67s - loss: 2.4735 - accuracy10: 0.5726 - val_loss: 2.0233 - val_accuracy10: 0.7249 - 67s/epoch - 36ms/step
Epoch 2/50
1876/1876 - 64s - loss: 2.1019 - accuracy10: 0.6469 - val_loss: 1.9561 - val_accuracy10: 0.7318 - 64s/epoch - 34ms/step
Epoch 3/50
1876/1876 - 62s - loss: 2.0395 - accuracy10: 0.6587 - val_loss: 1.9057 - val_accuracy10: 0.7435 - 62s/epoch - 33ms/step
Epoch 4/50
1876/1876 - 63s - loss: 2.0007 - accuracy10: 0.6659 - val_loss: 1.8633 - val_accuracy10: 0.7413 - 63s/epoch - 33ms/step
Epoch 5/50
1876/1876 - 62s - loss: 1.9762 - accuracy10: 0.6690 - val_loss: 1.8540 - val_accuracy10: 0.7462 - 62s/epoch - 33ms/step
Epoch 6/50
1876/1876 - 62s - loss: 1.9523 - accuracy10: 0.6719 - val_loss: 1.8535 - val_accuracy10: 0.7422 - 62s/epoch - 33ms/step
Epoch 7/50
1876/1876 - 65s - loss: 1.9370 - accuracy10: 0.6728 - val_loss: 1.8442 - val_accuracy10: 0.7445 - 65s/epoch - 35ms/step
Epoch 8/50
1876/1876 - 63s - loss: 1.9240 - accuracy10: 0.6748 - val_loss: 1.8015 - val_accuracy10: 0.7526 - 63s/epoch - 34ms/step
Epoch 9/50
1876/1876 - 64s - loss: 1.9124 - accuracy10: 0.6763 - val_loss: 1.7926 - val_accuracy10: 0.7497 - 64s/epoch - 34ms/step
Epoch 10/50
1876/1876 - 65s - loss: 1.9028 - accuracy10: 0.6763 - val_loss: 1.7615 - val_accuracy10: 0.7445 - 65s/epoch - 35ms/step
Epoch 11/50
1876/1876 - 61s - loss: 1.8963 - accuracy10: 0.6770 - val_loss: 1.7738 - val_accuracy10: 0.7453 - 61s/epoch - 33ms/step
Epoch 12/50
1876/1876 - 63s - loss: 1.8913 - accuracy10: 0.6777 - val_loss: 1.7581 - val_accuracy10: 0.7436 - 63s/epoch - 34ms/step
Epoch 13/50
1876/1876 - 62s - loss: 1.8829 - accuracy10: 0.6788 - val_loss: 1.7823 - val_accuracy10: 0.7443 - 62s/epoch - 33ms/step
Epoch 14/50
1876/1876 - 65s - loss: 1.8775 - accuracy10: 0.6794 - val_loss: 1.7569 - val_accuracy10: 0.7372 - 65s/epoch - 35ms/step
Epoch 15/50
1876/1876 - 65s - loss: 1.8709 - accuracy10: 0.6791 - val_loss: 1.7524 - val_accuracy10: 0.7442 - 65s/epoch - 34ms/step
Epoch 16/50
1876/1876 - 64s - loss: 1.8674 - accuracy10: 0.6811 - val_loss: 1.7446 - val_accuracy10: 0.7373 - 64s/epoch - 34ms/step
Epoch 17/50
1876/1876 - 63s - loss: 1.8612 - accuracy10: 0.6811 - val_loss: 1.7595 - val_accuracy10: 0.7374 - 63s/epoch - 33ms/step
Epoch 18/50
1876/1876 - 64s - loss: 1.8578 - accuracy10: 0.6807 - val_loss: 1.7399 - val_accuracy10: 0.7435 - 64s/epoch - 34ms/step
Epoch 19/50
1876/1876 - 63s - loss: 1.8547 - accuracy10: 0.6812 - val_loss: 1.7470 - val_accuracy10: 0.7381 - 63s/epoch - 33ms/step
Epoch 20/50
1876/1876 - 65s - loss: 1.8503 - accuracy10: 0.6820 - val_loss: 1.7388 - val_accuracy10: 0.7379 - 65s/epoch - 35ms/step
Epoch 21/50
1876/1876 - 63s - loss: 1.8453 - accuracy10: 0.6823 - val_loss: 1.7399 - val_accuracy10: 0.7418 - 63s/epoch - 33ms/step
Epoch 22/50
1876/1876 - 64s - loss: 1.8420 - accuracy10: 0.6829 - val_loss: 1.7442 - val_accuracy10: 0.7333 - 64s/epoch - 34ms/step
Epoch 23/50
1876/1876 - 65s - loss: 1.8386 - accuracy10: 0.6830 - val_loss: 1.7670 - val_accuracy10: 0.7357 - 65s/epoch - 35ms/step
Epoch 24/50
1876/1876 - 64s - loss: 1.8346 - accuracy10: 0.6834 - val_loss: 1.7588 - val_accuracy10: 0.7267 - 64s/epoch - 34ms/step
Epoch 25/50
1876/1876 - 63s - loss: 1.8332 - accuracy10: 0.6829 - val_loss: 1.7570 - val_accuracy10: 0.7386 - 63s/epoch - 34ms/step
Epoch 26/50
1876/1876 - 62s - loss: 1.8285 - accuracy10: 0.6831 - val_loss: 1.7524 - val_accuracy10: 0.7325 - 62s/epoch - 33ms/step
Epoch 27/50
1876/1876 - 92s - loss: 1.8250 - accuracy10: 0.6841 - val_loss: 1.7584 - val_accuracy10: 0.7366 - 92s/epoch - 49ms/step
Epoch 28/50
1876/1876 - 121s - loss: 1.8232 - accuracy10: 0.6842 - val_loss: 1.7564 - val_accuracy10: 0.7337 - 121s/epoch - 64ms/step
Epoch 29/50
1876/1876 - 122s - loss: 1.8180 - accuracy10: 0.6844 - val_loss: 1.7695 - val_accuracy10: 0.7368 - 122s/epoch - 65ms/step
Epoch 30/50
1876/1876 - 122s - loss: 1.8161 - accuracy10: 0.6845 - val_loss: 1.7823 - val_accuracy10: 0.7318 - 122s/epoch - 65ms/step
testing model: results/EXC/W3/deepVOL_L3/h10
Evaluating performance on  test set...
5098/5098 - 162s - 162s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6338241
{'0': {'precision': 0.3632401406562909, 'recall': 0.7515399070835725, 'f1-score': 0.4897638096615009, 'support': 153256}, '1': {'precision': 0.940458580384931, 'recall': 0.6913724505465813, 'f1-score': 0.7969049993946068, 'support': 999577}, '2': {'precision': 0.4150984414588546, 'recall': 0.6905469561672299, 'f1-score': 0.5185115695766915, 'support': 152078}, 'accuracy': 0.6983426455903889, 'macro avg': {'precision': 0.5729323875000255, 'recall': 0.711153104599128, 'f1-score': 0.6017267928775997, 'support': 1304911}, 'weighted avg': {'precision': 0.811439889909755, 'recall': 0.6983426455903889, 'f1-score': 0.7283878773889024, 'support': 1304911}}
[[115178  17191  20887]
 [181408 691080 127089]
 [ 20499  26562 105017]]
Evaluating performance on  train set...
1876/1876 - 71s - 71s/epoch - 38ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6614468
{'0': {'precision': 0.3625330512956108, 'recall': 0.7273225589701878, 'f1-score': 0.4838777982989637, 'support': 56554}, '1': {'precision': 0.9438631881614403, 'recall': 0.684877862282726, 'f1-score': 0.7937799595817645, 'support': 366185}, '2': {'precision': 0.3991132137095577, 'recall': 0.7017122572562121, 'f1-score': 0.5088229541912975, 'support': 57468}, 'accuracy': 0.6918912052510688, 'macro avg': {'precision': 0.5685031510555363, 'recall': 0.704637559503042, 'f1-score': 0.5954935706906753, 'support': 480207}, 'weighted avg': {'precision': 0.8102078351738519, 'recall': 0.6918912052510688, 'f1-score': 0.723180997019855, 'support': 480207}}
[[ 41133   5923   9498]
 [ 64178 250792  51215]
 [  8149   8993  40326]]
Evaluating performance on  val set...
619/619 - 24s - 24s/epoch - 39ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5608613
{'0': {'precision': 0.370278656244406, 'recall': 0.7527749135682659, 'f1-score': 0.49639036096390365, 'support': 16487}, '1': {'precision': 0.942604700119426, 'recall': 0.7445915479445484, 'f1-score': 0.8319784892446223, 'support': 125082}, '2': {'precision': 0.43101197788697787, 'recall': 0.6681544962209129, 'f1-score': 0.5240017735875475, 'support': 16803}, 'accuracy': 0.7373336195792185, 'macro avg': {'precision': 0.5812984447502699, 'recall': 0.7218403192445756, 'f1-score': 0.6174568745986911, 'support': 158372}, 'weighted avg': {'precision': 0.8287447248899708, 'recall': 0.7373336195792185, 'f1-score': 0.764366952962009, 'support': 158372}}
[[12411  2106  1970]
 [19096 93135 12851]
 [ 2011  3565 11227]]
training model: results/EXC/W3/deepVOL_L3/h20
Epoch 1/50
1876/1876 - 154s - loss: 2.6396 - accuracy20: 0.5393 - val_loss: 2.2780 - val_accuracy20: 0.6926 - 154s/epoch - 82ms/step
Epoch 2/50
1876/1876 - 144s - loss: 2.2489 - accuracy20: 0.6319 - val_loss: 2.1315 - val_accuracy20: 0.6992 - 144s/epoch - 77ms/step
Epoch 3/50
1876/1876 - 141s - loss: 2.1675 - accuracy20: 0.6465 - val_loss: 2.1002 - val_accuracy20: 0.7124 - 141s/epoch - 75ms/step
Epoch 4/50
1876/1876 - 144s - loss: 2.1250 - accuracy20: 0.6516 - val_loss: 2.0658 - val_accuracy20: 0.7155 - 144s/epoch - 77ms/step
Epoch 5/50
1876/1876 - 138s - loss: 2.0954 - accuracy20: 0.6544 - val_loss: 2.0644 - val_accuracy20: 0.7098 - 138s/epoch - 74ms/step
Epoch 6/50
1876/1876 - 143s - loss: 2.0731 - accuracy20: 0.6569 - val_loss: 2.0031 - val_accuracy20: 0.7205 - 143s/epoch - 76ms/step
Epoch 7/50
1876/1876 - 139s - loss: 2.0571 - accuracy20: 0.6578 - val_loss: 1.9990 - val_accuracy20: 0.7092 - 139s/epoch - 74ms/step
Epoch 8/50
1876/1876 - 147s - loss: 2.0465 - accuracy20: 0.6585 - val_loss: 2.0172 - val_accuracy20: 0.7136 - 147s/epoch - 78ms/step
Epoch 9/50
1876/1876 - 140s - loss: 2.0374 - accuracy20: 0.6597 - val_loss: 1.9818 - val_accuracy20: 0.7152 - 140s/epoch - 75ms/step
Epoch 10/50
1876/1876 - 152s - loss: 2.0291 - accuracy20: 0.6603 - val_loss: 1.9695 - val_accuracy20: 0.6992 - 152s/epoch - 81ms/step
Epoch 11/50
1876/1876 - 141s - loss: 2.0228 - accuracy20: 0.6606 - val_loss: 1.9715 - val_accuracy20: 0.6996 - 141s/epoch - 75ms/step
Epoch 12/50
1876/1876 - 143s - loss: 2.0190 - accuracy20: 0.6610 - val_loss: 1.9682 - val_accuracy20: 0.6917 - 143s/epoch - 76ms/step
Epoch 13/50
1876/1876 - 146s - loss: 2.0127 - accuracy20: 0.6620 - val_loss: 1.9731 - val_accuracy20: 0.6912 - 146s/epoch - 78ms/step
Epoch 14/50
1876/1876 - 143s - loss: 2.0069 - accuracy20: 0.6620 - val_loss: 1.9528 - val_accuracy20: 0.6854 - 143s/epoch - 76ms/step
Epoch 15/50
1876/1876 - 146s - loss: 2.0027 - accuracy20: 0.6630 - val_loss: 1.9451 - val_accuracy20: 0.6894 - 146s/epoch - 78ms/step
Epoch 16/50
1876/1876 - 144s - loss: 1.9980 - accuracy20: 0.6637 - val_loss: 1.9237 - val_accuracy20: 0.6864 - 144s/epoch - 77ms/step
Epoch 17/50
1876/1876 - 148s - loss: 1.9950 - accuracy20: 0.6632 - val_loss: 1.9387 - val_accuracy20: 0.6877 - 148s/epoch - 79ms/step
Epoch 18/50
1876/1876 - 149s - loss: 1.9893 - accuracy20: 0.6647 - val_loss: 1.9393 - val_accuracy20: 0.6899 - 149s/epoch - 80ms/step
Epoch 19/50
1876/1876 - 163s - loss: 1.9859 - accuracy20: 0.6649 - val_loss: 1.9465 - val_accuracy20: 0.6931 - 163s/epoch - 87ms/step
Epoch 20/50
1876/1876 - 163s - loss: 1.9825 - accuracy20: 0.6649 - val_loss: 1.9500 - val_accuracy20: 0.6863 - 163s/epoch - 87ms/step
Epoch 21/50
1876/1876 - 143s - loss: 1.9790 - accuracy20: 0.6653 - val_loss: 1.9475 - val_accuracy20: 0.6839 - 143s/epoch - 76ms/step
Epoch 22/50
1876/1876 - 142s - loss: 1.9765 - accuracy20: 0.6655 - val_loss: 1.9199 - val_accuracy20: 0.6833 - 142s/epoch - 76ms/step
Epoch 23/50
1876/1876 - 148s - loss: 1.9721 - accuracy20: 0.6656 - val_loss: 1.9352 - val_accuracy20: 0.6887 - 148s/epoch - 79ms/step
Epoch 24/50
1876/1876 - 138s - loss: 1.9699 - accuracy20: 0.6669 - val_loss: 1.9327 - val_accuracy20: 0.6855 - 138s/epoch - 74ms/step
Epoch 25/50
1876/1876 - 127s - loss: 1.9674 - accuracy20: 0.6666 - val_loss: 1.9590 - val_accuracy20: 0.6847 - 127s/epoch - 67ms/step
Epoch 26/50
1876/1876 - 122s - loss: 1.9630 - accuracy20: 0.6671 - val_loss: 1.9612 - val_accuracy20: 0.6862 - 122s/epoch - 65ms/step
Epoch 27/50
1876/1876 - 121s - loss: 1.9605 - accuracy20: 0.6670 - val_loss: 1.9402 - val_accuracy20: 0.6825 - 121s/epoch - 64ms/step
Epoch 28/50
1876/1876 - 119s - loss: 1.9568 - accuracy20: 0.6675 - val_loss: 1.9619 - val_accuracy20: 0.6828 - 119s/epoch - 64ms/step
Epoch 29/50
1876/1876 - 120s - loss: 1.9543 - accuracy20: 0.6683 - val_loss: 1.9825 - val_accuracy20: 0.6859 - 120s/epoch - 64ms/step
Epoch 30/50
1876/1876 - 120s - loss: 1.9503 - accuracy20: 0.6684 - val_loss: 1.9793 - val_accuracy20: 0.6806 - 120s/epoch - 64ms/step
Epoch 31/50
1876/1876 - 122s - loss: 1.9503 - accuracy20: 0.6685 - val_loss: 1.9503 - val_accuracy20: 0.6790 - 122s/epoch - 65ms/step
Epoch 32/50
1876/1876 - 121s - loss: 1.9463 - accuracy20: 0.6696 - val_loss: 1.9603 - val_accuracy20: 0.6814 - 121s/epoch - 65ms/step
testing model: results/EXC/W3/deepVOL_L3/h20
Evaluating performance on  test set...
5098/5098 - 161s - 161s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7004529
{'0': {'precision': 0.41089622822869004, 'recall': 0.762627199680306, 'f1-score': 0.5340509314783721, 'support': 210201}, '1': {'precision': 0.8931248110239767, 'recall': 0.6257916491996737, 'f1-score': 0.7359325717617748, 'support': 887388}, '2': {'precision': 0.45871046129063087, 'recall': 0.648286240726985, 'f1-score': 0.5372657027617993, 'support': 207322}, 'accuracy': 0.6514076438929551, 'macro avg': {'precision': 0.5875771668477658, 'recall': 0.678901696535655, 'f1-score': 0.6024164020006487, 'support': 1304911}, 'weighted avg': {'precision': 0.7464262375982267, 'recall': 0.6514076438929551, 'f1-score': 0.6718487106524543, 'support': 1304911}}
[[160305  26525  23371]
 [196839 555320 135229]
 [ 32991  39927 134404]]
Evaluating performance on  train set...
1876/1876 - 61s - 61s/epoch - 33ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7216993
{'0': {'precision': 0.40248576086726373, 'recall': 0.7415156164668556, 'f1-score': 0.521764191900015, 'support': 76906}, '1': {'precision': 0.9058488067245061, 'recall': 0.6193517985234829, 'f1-score': 0.7356921911841909, 'support': 324683}, '2': {'precision': 0.45454233389973053, 'recall': 0.6737133989671577, 'f1-score': 0.542840159062026, 'support': 78618}, 'accuracy': 0.6478164624838871, 'macro avg': {'precision': 0.5876256338305001, 'recall': 0.6781936046524987, 'f1-score': 0.6000988473820773, 'support': 480207}, 'weighted avg': {'precision': 0.7513478296766177, 'recall': 0.6478164624838871, 'f1-score': 0.6698581076028828, 'support': 480207}}
[[ 57027   8312  11567]
 [ 71597 201093  51993]
 [ 13063  12589  52966]]
Evaluating performance on  val set...
619/619 - 19s - 19s/epoch - 30ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6409942
{'0': {'precision': 0.4062848902121325, 'recall': 0.7594017651406461, 'f1-score': 0.529359174457897, 'support': 23001}, '1': {'precision': 0.8964595700399688, 'recall': 0.6781707906177875, 'f1-score': 0.7721846479791394, 'support': 111786}, '2': {'precision': 0.4878626598299474, 'recall': 0.6373966504133983, 'f1-score': 0.5526939833452821, 'support': 23585}, 'accuracy': 0.6838961432576466, 'macro avg': {'precision': 0.5968690400273495, 'recall': 0.6916564020572773, 'f1-score': 0.6180792685941062, 'support': 158372}, 'weighted avg': {'precision': 0.7644206620384065, 'recall': 0.6838961432576466, 'f1-score': 0.7042312468611917, 'support': 158372}}
[[17467  3300  2234]
 [22429 75810 13547]
 [ 3096  5456 15033]]
training model: results/EXC/W3/deepVOL_L3/h30
Epoch 1/50
1876/1876 - 127s - loss: 2.6857 - accuracy30: 0.5481 - val_loss: 2.4988 - val_accuracy30: 0.6508 - 127s/epoch - 68ms/step
Epoch 2/50
1876/1876 - 123s - loss: 2.3775 - accuracy30: 0.6150 - val_loss: 2.3600 - val_accuracy30: 0.6569 - 123s/epoch - 65ms/step
Epoch 3/50
1876/1876 - 119s - loss: 2.3037 - accuracy30: 0.6234 - val_loss: 2.4111 - val_accuracy30: 0.6658 - 119s/epoch - 63ms/step
Epoch 4/50
1876/1876 - 119s - loss: 2.2653 - accuracy30: 0.6258 - val_loss: 2.3031 - val_accuracy30: 0.6720 - 119s/epoch - 63ms/step
Epoch 5/50
1876/1876 - 120s - loss: 2.2325 - accuracy30: 0.6294 - val_loss: 2.2579 - val_accuracy30: 0.6738 - 120s/epoch - 64ms/step
Epoch 6/50
1876/1876 - 122s - loss: 2.2112 - accuracy30: 0.6323 - val_loss: 2.2649 - val_accuracy30: 0.6732 - 122s/epoch - 65ms/step
Epoch 7/50
1876/1876 - 120s - loss: 2.1954 - accuracy30: 0.6344 - val_loss: 2.2304 - val_accuracy30: 0.6745 - 120s/epoch - 64ms/step
Epoch 8/50
1876/1876 - 122s - loss: 2.1828 - accuracy30: 0.6362 - val_loss: 2.2428 - val_accuracy30: 0.6769 - 122s/epoch - 65ms/step
Epoch 9/50
1876/1876 - 122s - loss: 2.1745 - accuracy30: 0.6371 - val_loss: 2.2223 - val_accuracy30: 0.6785 - 122s/epoch - 65ms/step
Epoch 10/50
1876/1876 - 121s - loss: 2.1671 - accuracy30: 0.6379 - val_loss: 2.2307 - val_accuracy30: 0.6781 - 121s/epoch - 64ms/step
Epoch 11/50
1876/1876 - 119s - loss: 2.1598 - accuracy30: 0.6391 - val_loss: 2.2140 - val_accuracy30: 0.6701 - 119s/epoch - 64ms/step
Epoch 12/50
1876/1876 - 122s - loss: 2.1554 - accuracy30: 0.6393 - val_loss: 2.2048 - val_accuracy30: 0.6721 - 122s/epoch - 65ms/step
Epoch 13/50
1876/1876 - 121s - loss: 2.1492 - accuracy30: 0.6401 - val_loss: 2.1710 - val_accuracy30: 0.6699 - 121s/epoch - 65ms/step
Epoch 14/50
1876/1876 - 122s - loss: 2.1455 - accuracy30: 0.6406 - val_loss: 2.1760 - val_accuracy30: 0.6647 - 122s/epoch - 65ms/step
Epoch 15/50
1876/1876 - 121s - loss: 2.1408 - accuracy30: 0.6414 - val_loss: 2.1882 - val_accuracy30: 0.6666 - 121s/epoch - 65ms/step
Epoch 16/50
1876/1876 - 125s - loss: 2.1365 - accuracy30: 0.6414 - val_loss: 2.1627 - val_accuracy30: 0.6645 - 125s/epoch - 67ms/step
Epoch 17/50
1876/1876 - 121s - loss: 2.1335 - accuracy30: 0.6414 - val_loss: 2.1548 - val_accuracy30: 0.6616 - 121s/epoch - 65ms/step
Epoch 18/50
1876/1876 - 124s - loss: 2.1295 - accuracy30: 0.6425 - val_loss: 2.1404 - val_accuracy30: 0.6639 - 124s/epoch - 66ms/step
Epoch 19/50
1876/1876 - 122s - loss: 2.1252 - accuracy30: 0.6433 - val_loss: 2.1534 - val_accuracy30: 0.6635 - 122s/epoch - 65ms/step
Epoch 20/50
1876/1876 - 125s - loss: 2.1212 - accuracy30: 0.6438 - val_loss: 2.1422 - val_accuracy30: 0.6610 - 125s/epoch - 67ms/step
Epoch 21/50
1876/1876 - 122s - loss: 2.1186 - accuracy30: 0.6435 - val_loss: 2.1308 - val_accuracy30: 0.6595 - 122s/epoch - 65ms/step
Epoch 22/50
1876/1876 - 121s - loss: 2.1147 - accuracy30: 0.6448 - val_loss: 2.1218 - val_accuracy30: 0.6655 - 121s/epoch - 65ms/step
Epoch 23/50
1876/1876 - 121s - loss: 2.1106 - accuracy30: 0.6449 - val_loss: 2.1289 - val_accuracy30: 0.6556 - 121s/epoch - 64ms/step
Epoch 24/50
1876/1876 - 122s - loss: 2.1075 - accuracy30: 0.6450 - val_loss: 2.1340 - val_accuracy30: 0.6581 - 122s/epoch - 65ms/step
Epoch 25/50
1876/1876 - 124s - loss: 2.1039 - accuracy30: 0.6457 - val_loss: 2.1331 - val_accuracy30: 0.6559 - 124s/epoch - 66ms/step
Epoch 26/50
1876/1876 - 124s - loss: 2.1007 - accuracy30: 0.6459 - val_loss: 2.1157 - val_accuracy30: 0.6549 - 124s/epoch - 66ms/step
Epoch 27/50
1876/1876 - 123s - loss: 2.0984 - accuracy30: 0.6464 - val_loss: 2.1223 - val_accuracy30: 0.6544 - 123s/epoch - 66ms/step
Epoch 28/50
1876/1876 - 124s - loss: 2.0951 - accuracy30: 0.6464 - val_loss: 2.1268 - val_accuracy30: 0.6513 - 124s/epoch - 66ms/step
Epoch 29/50
1876/1876 - 123s - loss: 2.0934 - accuracy30: 0.6474 - val_loss: 2.1462 - val_accuracy30: 0.6491 - 123s/epoch - 65ms/step
Epoch 30/50
1876/1876 - 122s - loss: 2.0887 - accuracy30: 0.6479 - val_loss: 2.1501 - val_accuracy30: 0.6526 - 122s/epoch - 65ms/step
Epoch 31/50
1876/1876 - 120s - loss: 2.0867 - accuracy30: 0.6482 - val_loss: 2.1411 - val_accuracy30: 0.6533 - 120s/epoch - 64ms/step
Epoch 32/50
1876/1876 - 123s - loss: 2.0829 - accuracy30: 0.6484 - val_loss: 2.1370 - val_accuracy30: 0.6528 - 123s/epoch - 65ms/step
Epoch 33/50
1876/1876 - 121s - loss: 2.0805 - accuracy30: 0.6489 - val_loss: 2.1286 - val_accuracy30: 0.6512 - 121s/epoch - 64ms/step
Epoch 34/50
1876/1876 - 123s - loss: 2.0780 - accuracy30: 0.6495 - val_loss: 2.1546 - val_accuracy30: 0.6552 - 123s/epoch - 65ms/step
Epoch 35/50
1876/1876 - 122s - loss: 2.0749 - accuracy30: 0.6500 - val_loss: 2.1357 - val_accuracy30: 0.6558 - 122s/epoch - 65ms/step
Epoch 36/50
1876/1876 - 122s - loss: 2.0704 - accuracy30: 0.6505 - val_loss: 2.1390 - val_accuracy30: 0.6548 - 122s/epoch - 65ms/step
testing model: results/EXC/W3/deepVOL_L3/h30
Evaluating performance on  test set...
5098/5098 - 163s - 163s/epoch - 32ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7506108
{'0': {'precision': 0.4423344799158541, 'recall': 0.7404792969571028, 'f1-score': 0.5538310951600585, 'support': 252161}, '1': {'precision': 0.8339950785074391, 'recall': 0.5916833169315798, 'f1-score': 0.6922472500594219, 'support': 804792}, '2': {'precision': 0.48130664289241937, 'recall': 0.6052718605570299, 'f1-score': 0.536217799849941, 'support': 247958}, 'accuracy': 0.6230187346110194, 'macro avg': {'precision': 0.5858787337719041, 'recall': 0.6458114914819042, 'f1-score': 0.5940987150231405, 'support': 1304911}, 'weighted avg': {'precision': 0.691293049541723, 'recall': 0.6230187346110194, 'f1-score': 0.6358511384084198, 'support': 1304911}}
[[186720  37462  27979]
 [194849 476182 133761]
 [ 40555  57321 150082]]
Evaluating performance on  train set...
1876/1876 - 66s - 66s/epoch - 35ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7521969
{'0': {'precision': 0.4345818262142088, 'recall': 0.6881524150972269, 'f1-score': 0.5327325421505786, 'support': 91487}, '1': {'precision': 0.8502567136831256, 'recall': 0.6039008354091472, 'f1-score': 0.706210602868993, 'support': 295065}, '2': {'precision': 0.47960911844919574, 'recall': 0.6440553093801719, 'f1-score': 0.5497990174184904, 'support': 93655}, 'accuracy': 0.6277834350602969, 'macro avg': {'precision': 0.5881492194488435, 'recall': 0.645369519962182, 'f1-score': 0.596247387479354, 'support': 480207}, 'weighted avg': {'precision': 0.6987765208464894, 'recall': 0.6277834350602969, 'f1-score': 0.6426552728210919, 'support': 480207}}
[[ 62957  12645  15885]
 [ 67312 178190  49563]
 [ 14599  18737  60319]]
Evaluating performance on  val set...
619/619 - 22s - 22s/epoch - 36ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7013717
{'0': {'precision': 0.4375271338022054, 'recall': 0.7221525563397944, 'f1-score': 0.5449113937739088, 'support': 27911}, '1': {'precision': 0.8399355223577494, 'recall': 0.6504998476373967, 'f1-score': 0.7331789627627162, 'support': 101731}, '2': {'precision': 0.5174687472029119, 'recall': 0.6036895231465367, 'f1-score': 0.5572638038780986, 'support': 28730}, 'accuracy': 0.6546359204909958, 'macro avg': {'precision': 0.5983104677876222, 'recall': 0.6587806423745759, 'f1-score': 0.6117847201382413, 'support': 158372}, 'weighted avg': {'precision': 0.7105181317636275, 'recall': 0.6546359204909958, 'f1-score': 0.6680867833825123, 'support': 158372}}
[[20156  4962  2793]
 [22175 66176 13380]
 [ 3737  7649 17344]]
training model: results/EXC/W3/deepVOL_L3/h50
Epoch 1/50
1876/1876 - 131s - loss: 2.9086 - accuracy50: 0.5025 - val_loss: 2.8056 - val_accuracy50: 0.5915 - 131s/epoch - 70ms/step
Epoch 2/50
1876/1876 - 132s - loss: 2.6391 - accuracy50: 0.5760 - val_loss: 2.7295 - val_accuracy50: 0.5980 - 132s/epoch - 70ms/step
Epoch 3/50
1876/1876 - 122s - loss: 2.5577 - accuracy50: 0.5879 - val_loss: 2.7643 - val_accuracy50: 0.6174 - 122s/epoch - 65ms/step
Epoch 4/50
1876/1876 - 121s - loss: 2.5199 - accuracy50: 0.5925 - val_loss: 2.6663 - val_accuracy50: 0.6202 - 121s/epoch - 64ms/step
Epoch 5/50
1876/1876 - 124s - loss: 2.4909 - accuracy50: 0.5960 - val_loss: 2.6083 - val_accuracy50: 0.6183 - 124s/epoch - 66ms/step
Epoch 6/50
1876/1876 - 123s - loss: 2.4647 - accuracy50: 0.5975 - val_loss: 2.5703 - val_accuracy50: 0.6201 - 123s/epoch - 66ms/step
Epoch 7/50
1876/1876 - 122s - loss: 2.4494 - accuracy50: 0.5997 - val_loss: 2.5613 - val_accuracy50: 0.6165 - 122s/epoch - 65ms/step
Epoch 8/50
1876/1876 - 121s - loss: 2.4384 - accuracy50: 0.6006 - val_loss: 2.5279 - val_accuracy50: 0.6155 - 121s/epoch - 64ms/step
Epoch 9/50
1876/1876 - 123s - loss: 2.4289 - accuracy50: 0.6023 - val_loss: 2.5134 - val_accuracy50: 0.6142 - 123s/epoch - 65ms/step
Epoch 10/50
1876/1876 - 124s - loss: 2.4220 - accuracy50: 0.6024 - val_loss: 2.4948 - val_accuracy50: 0.6116 - 124s/epoch - 66ms/step
Epoch 11/50
1876/1876 - 122s - loss: 2.4153 - accuracy50: 0.6038 - val_loss: 2.4926 - val_accuracy50: 0.6096 - 122s/epoch - 65ms/step
Epoch 12/50
1876/1876 - 123s - loss: 2.4100 - accuracy50: 0.6043 - val_loss: 2.5040 - val_accuracy50: 0.6077 - 123s/epoch - 66ms/step
Epoch 13/50
1876/1876 - 121s - loss: 2.4039 - accuracy50: 0.6051 - val_loss: 2.5091 - val_accuracy50: 0.6098 - 121s/epoch - 65ms/step
Epoch 14/50
1876/1876 - 121s - loss: 2.3997 - accuracy50: 0.6056 - val_loss: 2.4738 - val_accuracy50: 0.6088 - 121s/epoch - 64ms/step
Epoch 15/50
1876/1876 - 125s - loss: 2.3959 - accuracy50: 0.6061 - val_loss: 2.5006 - val_accuracy50: 0.6101 - 125s/epoch - 66ms/step
Epoch 16/50
1876/1876 - 122s - loss: 2.3916 - accuracy50: 0.6067 - val_loss: 2.4723 - val_accuracy50: 0.6140 - 122s/epoch - 65ms/step
Epoch 17/50
1876/1876 - 124s - loss: 2.3882 - accuracy50: 0.6076 - val_loss: 2.4724 - val_accuracy50: 0.6099 - 124s/epoch - 66ms/step
Epoch 18/50
1876/1876 - 123s - loss: 2.3848 - accuracy50: 0.6080 - val_loss: 2.4961 - val_accuracy50: 0.6107 - 123s/epoch - 66ms/step
Epoch 19/50
1876/1876 - 122s - loss: 2.3820 - accuracy50: 0.6082 - val_loss: 2.4594 - val_accuracy50: 0.6129 - 122s/epoch - 65ms/step
Epoch 20/50
1876/1876 - 123s - loss: 2.3784 - accuracy50: 0.6084 - val_loss: 2.4859 - val_accuracy50: 0.6168 - 123s/epoch - 66ms/step
Epoch 21/50
1876/1876 - 122s - loss: 2.3752 - accuracy50: 0.6088 - val_loss: 2.4810 - val_accuracy50: 0.6128 - 122s/epoch - 65ms/step
Epoch 22/50
1876/1876 - 122s - loss: 2.3722 - accuracy50: 0.6094 - val_loss: 2.4624 - val_accuracy50: 0.6180 - 122s/epoch - 65ms/step
Epoch 23/50
1876/1876 - 120s - loss: 2.3691 - accuracy50: 0.6095 - val_loss: 2.4796 - val_accuracy50: 0.6104 - 120s/epoch - 64ms/step
Epoch 24/50
1876/1876 - 119s - loss: 2.3664 - accuracy50: 0.6104 - val_loss: 2.4783 - val_accuracy50: 0.6165 - 119s/epoch - 64ms/step
Epoch 25/50
1876/1876 - 125s - loss: 2.3639 - accuracy50: 0.6105 - val_loss: 2.4850 - val_accuracy50: 0.6147 - 125s/epoch - 66ms/step
Epoch 26/50
1876/1876 - 123s - loss: 2.3599 - accuracy50: 0.6104 - val_loss: 2.4865 - val_accuracy50: 0.6149 - 123s/epoch - 66ms/step
Epoch 27/50
1876/1876 - 122s - loss: 2.3547 - accuracy50: 0.6116 - val_loss: 2.4954 - val_accuracy50: 0.6079 - 122s/epoch - 65ms/step
Epoch 28/50
1876/1876 - 124s - loss: 2.3540 - accuracy50: 0.6118 - val_loss: 2.4978 - val_accuracy50: 0.6088 - 124s/epoch - 66ms/step
Epoch 29/50
1876/1876 - 123s - loss: 2.3507 - accuracy50: 0.6128 - val_loss: 2.5286 - val_accuracy50: 0.6023 - 123s/epoch - 65ms/step
testing model: results/EXC/W3/deepVOL_L3/h50
Evaluating performance on  test set...
5098/5098 - 153s - 153s/epoch - 30ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83826226
{'0': {'precision': 0.48434558053650884, 'recall': 0.6710036121984067, 'f1-score': 0.5625963754265582, 'support': 317812}, '1': {'precision': 0.709376758265759, 'recall': 0.584573702204815, 'f1-score': 0.6409565288715244, 'support': 675068}, '2': {'precision': 0.5195138801046968, 'recall': 0.5133336110835142, 'f1-score': 0.5164052550979287, 'support': 312031}, 'accuracy': 0.5885888003089866, 'macro avg': {'precision': 0.5710787396356548, 'recall': 0.5896369751622452, 'f1-score': 0.5733193864653371, 'support': 1304911}, 'weighted avg': {'precision': 0.609170144640797, 'recall': 0.5885888003089866, 'f1-score': 0.5920890922467275, 'support': 1304911}}
[[213253  65680  38879]
 [171177 394627 109264]
 [ 55861  95994 160176]]
Evaluating performance on  train set...
1876/1876 - 59s - 59s/epoch - 31ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8278137
{'0': {'precision': 0.4762196405672836, 'recall': 0.652266233255564, 'f1-score': 0.5505110845612639, 'support': 114441}, '1': {'precision': 0.7345684709585594, 'recall': 0.6069810101431765, 'f1-score': 0.6647076664747227, 'support': 249133}, '2': {'precision': 0.5324960246260597, 'recall': 0.5369063644080149, 'f1-score': 0.5346921001400321, 'support': 116633}, 'accuracy': 0.600753425085432, 'macro avg': {'precision': 0.5810947120506342, 'recall': 0.5987178692689185, 'f1-score': 0.5833036170586728, 'support': 480207}, 'weighted avg': {'precision': 0.6239203251966142, 'recall': 0.600753425085432, 'f1-score': 0.6059145281425615, 'support': 480207}}
[[ 74646  23314  16481]
 [ 59417 151219  38497]
 [ 22684  31328  62621]]
Evaluating performance on  val set...
619/619 - 19s - 19s/epoch - 30ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8011235
{'0': {'precision': 0.48367423142347427, 'recall': 0.6486215817731661, 'f1-score': 0.5541335424762042, 'support': 35947}, '1': {'precision': 0.7101440081202817, 'recall': 0.654627539503386, 'f1-score': 0.6812566184256972, 'support': 85499}, '2': {'precision': 0.5677649835730918, 'recall': 0.48204517142392894, 'f1-score': 0.5214054513232861, 'support': 36926}, 'accuracy': 0.6130250296769632, 'macro avg': {'precision': 0.5871944077056159, 'recall': 0.595098097566827, 'f1-score': 0.5855985374083957, 'support': 158372}, 'weighted avg': {'precision': 0.6255432142719394, 'recall': 0.6130250296769632, 'f1-score': 0.6151315621810324, 'support': 158372}}
[[23316  9218  3413]
 [19391 55970 10138]
 [ 5499 13627 17800]]
training model: results/EXC/W3/deepVOL_L3/h100
Epoch 1/50
1876/1876 - 129s - loss: 3.1564 - accuracy100: 0.4354 - val_loss: 3.2124 - val_accuracy100: 0.4285 - 129s/epoch - 69ms/step
Epoch 2/50
1876/1876 - 132s - loss: 2.9908 - accuracy100: 0.4905 - val_loss: 3.0447 - val_accuracy100: 0.4925 - 132s/epoch - 70ms/step
Epoch 3/50
1876/1876 - 128s - loss: 2.9053 - accuracy100: 0.5090 - val_loss: 3.0173 - val_accuracy100: 0.4947 - 128s/epoch - 68ms/step
Epoch 4/50
1876/1876 - 124s - loss: 2.8793 - accuracy100: 0.5139 - val_loss: 2.9683 - val_accuracy100: 0.4989 - 124s/epoch - 66ms/step
Epoch 5/50
1876/1876 - 129s - loss: 2.8619 - accuracy100: 0.5169 - val_loss: 2.9528 - val_accuracy100: 0.5027 - 129s/epoch - 69ms/step
Epoch 6/50
1876/1876 - 129s - loss: 2.8496 - accuracy100: 0.5210 - val_loss: 2.9597 - val_accuracy100: 0.5016 - 129s/epoch - 69ms/step
Epoch 7/50
1876/1876 - 125s - loss: 2.8389 - accuracy100: 0.5228 - val_loss: 2.9363 - val_accuracy100: 0.5030 - 125s/epoch - 67ms/step
Epoch 8/50
1876/1876 - 131s - loss: 2.8272 - accuracy100: 0.5253 - val_loss: 2.9265 - val_accuracy100: 0.5021 - 131s/epoch - 70ms/step
Epoch 9/50
1876/1876 - 131s - loss: 2.8201 - accuracy100: 0.5263 - val_loss: 2.9225 - val_accuracy100: 0.5031 - 131s/epoch - 70ms/step
Epoch 10/50
1876/1876 - 128s - loss: 2.8127 - accuracy100: 0.5283 - val_loss: 2.9187 - val_accuracy100: 0.5056 - 128s/epoch - 68ms/step
Epoch 11/50
1876/1876 - 132s - loss: 2.8072 - accuracy100: 0.5291 - val_loss: 2.9219 - val_accuracy100: 0.5034 - 132s/epoch - 70ms/step
Epoch 12/50
1876/1876 - 130s - loss: 2.8022 - accuracy100: 0.5301 - val_loss: 2.9174 - val_accuracy100: 0.5042 - 130s/epoch - 69ms/step
Epoch 13/50
1876/1876 - 126s - loss: 2.7976 - accuracy100: 0.5314 - val_loss: 2.9030 - val_accuracy100: 0.5075 - 126s/epoch - 67ms/step
Epoch 14/50
1876/1876 - 127s - loss: 2.7936 - accuracy100: 0.5321 - val_loss: 2.9135 - val_accuracy100: 0.5054 - 127s/epoch - 68ms/step
Epoch 15/50
1876/1876 - 131s - loss: 2.7900 - accuracy100: 0.5325 - val_loss: 2.9040 - val_accuracy100: 0.5059 - 131s/epoch - 70ms/step
Epoch 16/50
1876/1876 - 128s - loss: 2.7862 - accuracy100: 0.5339 - val_loss: 2.9082 - val_accuracy100: 0.5077 - 128s/epoch - 68ms/step
Epoch 17/50
1876/1876 - 129s - loss: 2.7831 - accuracy100: 0.5343 - val_loss: 2.9148 - val_accuracy100: 0.5059 - 129s/epoch - 69ms/step
Epoch 18/50
1876/1876 - 131s - loss: 2.7791 - accuracy100: 0.5348 - val_loss: 2.9074 - val_accuracy100: 0.5074 - 131s/epoch - 70ms/step
Epoch 19/50
1876/1876 - 129s - loss: 2.7756 - accuracy100: 0.5359 - val_loss: 2.9032 - val_accuracy100: 0.5060 - 129s/epoch - 69ms/step
Epoch 20/50
1876/1876 - 130s - loss: 2.7730 - accuracy100: 0.5362 - val_loss: 2.9175 - val_accuracy100: 0.5064 - 130s/epoch - 69ms/step
Epoch 21/50
1876/1876 - 133s - loss: 2.7686 - accuracy100: 0.5377 - val_loss: 2.9155 - val_accuracy100: 0.5060 - 133s/epoch - 71ms/step
Epoch 22/50
1876/1876 - 128s - loss: 2.7659 - accuracy100: 0.5381 - val_loss: 2.9152 - val_accuracy100: 0.5072 - 128s/epoch - 68ms/step
Epoch 23/50
1876/1876 - 131s - loss: 2.7634 - accuracy100: 0.5390 - val_loss: 2.9221 - val_accuracy100: 0.5042 - 131s/epoch - 70ms/step
testing model: results/EXC/W3/deepVOL_L3/h100
Evaluating performance on  test set...
5098/5098 - 163s - 163s/epoch - 32ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9725385
{'0': {'precision': 0.49238823009940846, 'recall': 0.5950003244669728, 'f1-score': 0.5388527503670384, 'support': 416067}, '1': {'precision': 0.49452524108310747, 'recall': 0.5540503390871002, 'f1-score': 0.522598242207301, 'support': 483799}, '2': {'precision': 0.5233291298865069, 'recall': 0.336061425273735, 'f1-score': 0.40929175267496454, 'support': 405045}, 'accuracy': 0.4994432570497145, 'macro avg': {'precision': 0.503414200356341, 'recall': 0.49503736294260264, 'f1-score': 0.490247581749768, 'support': 1304911}, 'weighted avg': {'precision': 0.5027846023663047, 'recall': 0.4994432570497145, 'f1-score': 0.4926105552262519, 'support': 1304911}}
[[247560 117327  51180]
 [142946 268049  72804]
 [112268 156657 136120]]
Evaluating performance on  train set...
1876/1876 - 58s - 58s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.96177965
{'0': {'precision': 0.4835632075570496, 'recall': 0.6120463402348825, 'f1-score': 0.540271106716824, 'support': 150884}, '1': {'precision': 0.5246445075032389, 'recall': 0.5633377638604159, 'f1-score': 0.5433030876653621, 'support': 177556}, '2': {'precision': 0.5509322188634842, 'recall': 0.3578643578643579, 'f1-score': 0.43389028915633776, 'support': 151767}, 'accuracy': 0.5137034653805547, 'macro avg': {'precision': 0.5197133113079242, 'recall': 0.5110828206532188, 'f1-score': 0.5058214945128413, 'support': 480207}, 'weighted avg': {'precision': 0.5200446083533505, 'recall': 0.5137034653805547, 'f1-score': 0.50777105751012, 'support': 480207}}
[[ 92348  39141  19395]
 [ 52657 100024  24875]
 [ 45969  51486  54312]]
Evaluating performance on  val set...
619/619 - 18s - 18s/epoch - 30ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9635662
{'0': {'precision': 0.49395924308588063, 'recall': 0.5635989952043846, 'f1-score': 0.5264862453819973, 'support': 48169}, '1': {'precision': 0.4952410794720144, 'recall': 0.6221216296004723, 'f1-score': 0.5514774833714972, 'support': 60972}, '2': {'precision': 0.5769790074201127, 'recall': 0.3143141516524141, 'f1-score': 0.4069428007889546, 'support': 49231}, 'accuracy': 0.5086378905362059, 'macro avg': {'precision': 0.5220597766593359, 'recall': 0.5000115921524237, 'f1-score': 0.49496884318081635, 'support': 158372}, 'weighted avg': {'precision': 0.5202599916151277, 'recall': 0.5086378905362059, 'f1-score': 0.4989467967543087, 'support': 158372}}
[[27148 16235  4786]
 [16481 37932  6559]
 [11331 22426 15474]]
training model: results/EXC/W3/deepVOL_L3/h200
Epoch 1/50
1876/1876 - 129s - loss: 3.2617 - accuracy200: 0.3871 - val_loss: 3.3008 - val_accuracy200: 0.3779 - 129s/epoch - 69ms/step
Epoch 2/50
1876/1876 - 120s - loss: 3.2074 - accuracy200: 0.4129 - val_loss: 3.2649 - val_accuracy200: 0.3900 - 120s/epoch - 64ms/step
Epoch 3/50
1876/1876 - 125s - loss: 3.1619 - accuracy200: 0.4283 - val_loss: 3.2261 - val_accuracy200: 0.4064 - 125s/epoch - 67ms/step
Epoch 4/50
1876/1876 - 124s - loss: 3.1335 - accuracy200: 0.4356 - val_loss: 3.2220 - val_accuracy200: 0.4003 - 124s/epoch - 66ms/step
Epoch 5/50
1876/1876 - 129s - loss: 3.1241 - accuracy200: 0.4386 - val_loss: 3.2108 - val_accuracy200: 0.4037 - 129s/epoch - 69ms/step
Epoch 6/50
1876/1876 - 128s - loss: 3.1176 - accuracy200: 0.4414 - val_loss: 3.2179 - val_accuracy200: 0.3977 - 128s/epoch - 68ms/step
Epoch 7/50
1876/1876 - 128s - loss: 3.1121 - accuracy200: 0.4432 - val_loss: 3.2301 - val_accuracy200: 0.3961 - 128s/epoch - 68ms/step
Epoch 8/50
1876/1876 - 129s - loss: 3.1080 - accuracy200: 0.4440 - val_loss: 3.2243 - val_accuracy200: 0.3963 - 129s/epoch - 69ms/step
Epoch 9/50
1876/1876 - 130s - loss: 3.1031 - accuracy200: 0.4464 - val_loss: 3.2163 - val_accuracy200: 0.4034 - 130s/epoch - 69ms/step
Epoch 10/50
1876/1876 - 129s - loss: 3.0997 - accuracy200: 0.4470 - val_loss: 3.2236 - val_accuracy200: 0.4017 - 129s/epoch - 69ms/step
Epoch 11/50
1876/1876 - 124s - loss: 3.0953 - accuracy200: 0.4488 - val_loss: 3.2144 - val_accuracy200: 0.4050 - 124s/epoch - 66ms/step
Epoch 12/50
1876/1876 - 121s - loss: 3.0915 - accuracy200: 0.4508 - val_loss: 3.2155 - val_accuracy200: 0.4044 - 121s/epoch - 65ms/step
Epoch 13/50
1876/1876 - 119s - loss: 3.0883 - accuracy200: 0.4519 - val_loss: 3.2148 - val_accuracy200: 0.4083 - 119s/epoch - 63ms/step
Epoch 14/50
1876/1876 - 118s - loss: 3.0833 - accuracy200: 0.4528 - val_loss: 3.2333 - val_accuracy200: 0.4006 - 118s/epoch - 63ms/step
Epoch 15/50
1876/1876 - 121s - loss: 3.0802 - accuracy200: 0.4549 - val_loss: 3.2460 - val_accuracy200: 0.3990 - 121s/epoch - 64ms/step
testing model: results/EXC/W3/deepVOL_L3/h200
Evaluating performance on  test set...
5098/5098 - 166s - 166s/epoch - 33ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0692425
{'0': {'precision': 0.4219939220393871, 'recall': 0.5933285333943419, 'f1-score': 0.4932049587300759, 'support': 445839}, '1': {'precision': 0.3768441448175267, 'recall': 0.4723998653651969, 'f1-score': 0.41924610863527734, 'support': 439708}, '2': {'precision': 0.4914073093053322, 'recall': 0.14864413731269255, 'f1-score': 0.22824670093882274, 'support': 419364}, 'accuracy': 0.40967008477972827, 'macro avg': {'precision': 0.43008179205408203, 'recall': 0.40479084535741044, 'f1-score': 0.3802325894347253, 'support': 1304911}, 'weighted avg': {'precision': 0.42908770659229994, 'recall': 0.40967008477972827, 'f1-score': 0.38313289030713, 'support': 1304911}}
[[264529 150787  30523]
 [197997 207718  33993]
 [164329 192699  62336]]
Evaluating performance on  train set...
1876/1876 - 63s - 63s/epoch - 34ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0676937
{'0': {'precision': 0.4179107590527795, 'recall': 0.6148289976741474, 'f1-score': 0.4975961299679153, 'support': 162951}, '1': {'precision': 0.3734866346994463, 'recall': 0.45598918408404326, 'f1-score': 0.41063491416221504, 'support': 154587}, '2': {'precision': 0.5225458551576181, 'recall': 0.16620253398004536, 'f1-score': 0.25219208238498564, 'support': 162669}, 'accuracy': 0.4117245271310081, 'macro avg': {'precision': 0.437981082969948, 'recall': 0.412340238579412, 'f1-score': 0.38680770883837196, 'support': 480207}, 'weighted avg': {'precision': 0.43905475390680965, 'recall': 0.4117245271310081, 'f1-score': 0.3864717513478132, 'support': 480207}}
[[100187  50335  12429]
 [ 71823  70490  12274]
 [ 67723  67910  27036]]
Evaluating performance on  val set...
619/619 - 21s - 21s/epoch - 35ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0697136
{'0': {'precision': 0.40205307961942915, 'recall': 0.6229463679565512, 'f1-score': 0.48869783543196255, 'support': 51555}, '1': {'precision': 0.3756291225108631, 'recall': 0.44269240688206907, 'f1-score': 0.4064127714266387, 'support': 54286}, '2': {'precision': 0.5364475678655092, 'recall': 0.14821724315166282, 'f1-score': 0.23226191364009247, 'support': 52531}, 'accuracy': 0.40369509761826583, 'macro avg': {'precision': 0.43804325666526717, 'recall': 0.4046186726634277, 'f1-score': 0.37579084016623127, 'support': 158372}, 'weighted avg': {'precision': 0.4375734110319214, 'recall': 0.40369509761826583, 'f1-score': 0.37543436466540187, 'support': 158372}}
[[32116 16334  3105]
 [26631 24032  3623]
 [21133 23612  7786]]
training model: results/EXC/W3/deepVOL_L3/h300
Epoch 1/50
1876/1876 - 131s - loss: 3.2842 - accuracy300: 0.3777 - val_loss: 3.3320 - val_accuracy300: 0.3473 - 131s/epoch - 70ms/step
Epoch 2/50
1876/1876 - 121s - loss: 3.2453 - accuracy300: 0.3979 - val_loss: 3.3779 - val_accuracy300: 0.3481 - 121s/epoch - 65ms/step
Epoch 3/50
1876/1876 - 124s - loss: 3.2327 - accuracy300: 0.4067 - val_loss: 3.3346 - val_accuracy300: 0.3542 - 124s/epoch - 66ms/step
Epoch 4/50
1876/1876 - 130s - loss: 3.2254 - accuracy300: 0.4099 - val_loss: 3.3522 - val_accuracy300: 0.3566 - 130s/epoch - 69ms/step
Epoch 5/50
1876/1876 - 129s - loss: 3.2170 - accuracy300: 0.4130 - val_loss: 3.3370 - val_accuracy300: 0.3561 - 129s/epoch - 69ms/step
Epoch 6/50
1876/1876 - 129s - loss: 3.2080 - accuracy300: 0.4168 - val_loss: 3.3245 - val_accuracy300: 0.3613 - 129s/epoch - 69ms/step
Epoch 7/50
1876/1876 - 127s - loss: 3.1999 - accuracy300: 0.4199 - val_loss: 3.3144 - val_accuracy300: 0.3620 - 127s/epoch - 68ms/step
Epoch 8/50
1876/1876 - 122s - loss: 3.1938 - accuracy300: 0.4221 - val_loss: 3.3064 - val_accuracy300: 0.3646 - 122s/epoch - 65ms/step
Epoch 9/50
1876/1876 - 123s - loss: 3.1861 - accuracy300: 0.4254 - val_loss: 3.3116 - val_accuracy300: 0.3630 - 123s/epoch - 65ms/step
Epoch 10/50
1876/1876 - 131s - loss: 3.1806 - accuracy300: 0.4273 - val_loss: 3.3016 - val_accuracy300: 0.3638 - 131s/epoch - 70ms/step
Epoch 11/50
1876/1876 - 129s - loss: 3.1752 - accuracy300: 0.4294 - val_loss: 3.2946 - val_accuracy300: 0.3620 - 129s/epoch - 69ms/step
Epoch 12/50
1876/1876 - 122s - loss: 3.1703 - accuracy300: 0.4312 - val_loss: 3.3030 - val_accuracy300: 0.3613 - 122s/epoch - 65ms/step
Epoch 13/50
1876/1876 - 121s - loss: 3.1652 - accuracy300: 0.4333 - val_loss: 3.3257 - val_accuracy300: 0.3616 - 121s/epoch - 65ms/step
Epoch 14/50
1876/1876 - 121s - loss: 3.1599 - accuracy300: 0.4353 - val_loss: 3.3329 - val_accuracy300: 0.3640 - 121s/epoch - 64ms/step
Epoch 15/50
1876/1876 - 120s - loss: 3.1564 - accuracy300: 0.4369 - val_loss: 3.3425 - val_accuracy300: 0.3656 - 120s/epoch - 64ms/step
Epoch 16/50
1876/1876 - 120s - loss: 3.1503 - accuracy300: 0.4397 - val_loss: 3.3546 - val_accuracy300: 0.3664 - 120s/epoch - 64ms/step
Epoch 17/50
1876/1876 - 121s - loss: 3.1468 - accuracy300: 0.4401 - val_loss: 3.3607 - val_accuracy300: 0.3623 - 121s/epoch - 65ms/step
Epoch 18/50
1876/1876 - 119s - loss: 3.1395 - accuracy300: 0.4442 - val_loss: 3.3649 - val_accuracy300: 0.3696 - 119s/epoch - 64ms/step
Epoch 19/50
1876/1876 - 122s - loss: 3.1342 - accuracy300: 0.4462 - val_loss: 3.3761 - val_accuracy300: 0.3729 - 122s/epoch - 65ms/step
Epoch 20/50
1876/1876 - 121s - loss: 3.1277 - accuracy300: 0.4494 - val_loss: 3.3783 - val_accuracy300: 0.3711 - 121s/epoch - 65ms/step
Epoch 21/50
1876/1876 - 125s - loss: 3.1199 - accuracy300: 0.4510 - val_loss: 3.3885 - val_accuracy300: 0.3704 - 125s/epoch - 66ms/step
testing model: results/EXC/W3/deepVOL_L3/h300
Evaluating performance on  test set...
5098/5098 - 165s - 165s/epoch - 32ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0880599
{'0': {'precision': 0.3911750499695149, 'recall': 0.7419118151860497, 'f1-score': 0.5122597398365072, 'support': 466112}, '1': {'precision': 0.32566326868937745, 'recall': 0.13402934047203774, 'f1-score': 0.1899026969262353, 'support': 403061}, '2': {'precision': 0.44420347544403876, 'recall': 0.2599429014683135, 'f1-score': 0.3279645938265045, 'support': 435738}, 'accuracy': 0.39320919204451493, 'macro avg': {'precision': 0.3870139313676437, 'recall': 0.3786280190421336, 'f1-score': 0.3433756768630823, 'support': 1304911}, 'weighted avg': {'precision': 0.38864710437388783, 'recall': 0.39320919204451493, 'f1-score': 0.3511499397010469, 'support': 1304911}}
[[345814  53694  66604]
 [273921  54022  75118]
 [264304  58167 113267]]
Evaluating performance on  train set...
1876/1876 - 63s - 63s/epoch - 33ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0916798
{'0': {'precision': 0.36863290398126464, 'recall': 0.7758971262384778, 'f1-score': 0.49980551542381757, 'support': 162296}, '1': {'precision': 0.34135804748366133, 'recall': 0.1173968253968254, 'f1-score': 0.1747092116825565, 'support': 157500}, '2': {'precision': 0.4367664996861714, 'recall': 0.22991565416336784, 'f1-score': 0.3012513681734272, 'support': 160411}, 'accuracy': 0.37753718708806827, 'macro avg': {'precision': 0.38225248371703247, 'recall': 0.3744032019328904, 'f1-score': 0.3252553650932671, 'support': 480207}, 'weighted avg': {'precision': 0.3824469223571885, 'recall': 0.37753718708806827, 'f1-score': 0.3268531487281405, 'support': 480207}}
[[125925  16449  19922]
 [111372  18490  27638]
 [104303  19227  36881]]
Evaluating performance on  val set...
619/619 - 19s - 19s/epoch - 30ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0964059
{'0': {'precision': 0.34635127402470633, 'recall': 0.80756175564581, 'f1-score': 0.48478531003574726, 'support': 50967}, '1': {'precision': 0.34361097380128525, 'recall': 0.1004044343335861, 'f1-score': 0.15540030739136512, 'support': 55386}, '2': {'precision': 0.4558496060294621, 'recall': 0.2046367673350122, 'f1-score': 0.2824693847766382, 'support': 52019}, 'accuracy': 0.3622168060010608, 'macro avg': {'precision': 0.38193728461848453, 'recall': 0.3708676524381361, 'f1-score': 0.3075516674012502, 'support': 158372}, 'weighted avg': {'precision': 0.38135884773963696, 'recall': 0.3622168060010608, 'f1-score': 0.30313962852313553, 'support': 158372}}
[[41159  4583  5225]
 [42343  5561  7482]
 [35334  6040 10645]]
training model: results/EXC/W3/deepVOL_L3/h500
Epoch 1/50
1876/1876 - 129s - loss: 3.2875 - accuracy500: 0.3731 - val_loss: 3.3635 - val_accuracy500: 0.3338 - 129s/epoch - 69ms/step
Epoch 2/50
1876/1876 - 120s - loss: 3.2704 - accuracy500: 0.3812 - val_loss: 3.4024 - val_accuracy500: 0.3373 - 120s/epoch - 64ms/step
Epoch 3/50
1876/1876 - 121s - loss: 3.2526 - accuracy500: 0.3928 - val_loss: 3.3855 - val_accuracy500: 0.3432 - 121s/epoch - 64ms/step
Epoch 4/50
1876/1876 - 122s - loss: 3.2418 - accuracy500: 0.3986 - val_loss: 3.3909 - val_accuracy500: 0.3442 - 122s/epoch - 65ms/step
Epoch 5/50
1876/1876 - 122s - loss: 3.2310 - accuracy500: 0.4055 - val_loss: 3.4141 - val_accuracy500: 0.3446 - 122s/epoch - 65ms/step
Epoch 6/50
1876/1876 - 124s - loss: 3.2172 - accuracy500: 0.4147 - val_loss: 3.3866 - val_accuracy500: 0.3446 - 124s/epoch - 66ms/step
Epoch 7/50
1876/1876 - 122s - loss: 3.2044 - accuracy500: 0.4216 - val_loss: 3.3976 - val_accuracy500: 0.3527 - 122s/epoch - 65ms/step
Epoch 8/50
1876/1876 - 120s - loss: 3.1943 - accuracy500: 0.4267 - val_loss: 3.3951 - val_accuracy500: 0.3519 - 120s/epoch - 64ms/step
Epoch 9/50
1876/1876 - 124s - loss: 3.1854 - accuracy500: 0.4313 - val_loss: 3.4254 - val_accuracy500: 0.3552 - 124s/epoch - 66ms/step
Epoch 10/50
1876/1876 - 120s - loss: 3.1790 - accuracy500: 0.4341 - val_loss: 3.4249 - val_accuracy500: 0.3564 - 120s/epoch - 64ms/step
Epoch 11/50
1876/1876 - 122s - loss: 3.1725 - accuracy500: 0.4381 - val_loss: 3.4323 - val_accuracy500: 0.3611 - 122s/epoch - 65ms/step
testing model: results/EXC/W3/deepVOL_L3/h500
Evaluating performance on  test set...
5098/5098 - 163s - 163s/epoch - 32ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1099455
{'0': {'precision': 0.3737290106078126, 'recall': 0.514148190734729, 'f1-score': 0.432834843238542, 'support': 462674}, '1': {'precision': 0.32983574202474997, 'recall': 0.4536986938527547, 'f1-score': 0.3819769457228512, 'support': 421392}, '2': {'precision': 0.3732791059237061, 'recall': 0.07872969858261356, 'f1-score': 0.13003353564609593, 'support': 420845}, 'accuracy': 0.3542011677424744, 'macro avg': {'precision': 0.3589479528520896, 'recall': 0.3488588610566991, 'f1-score': 0.3149484415358297, 'support': 1304911}, 'weighted avg': {'precision': 0.35940955711900247, 'recall': 0.3542011677424744, 'f1-score': 0.3187553945683454, 'support': 1304911}}
[[237883 196897  27894]
 [202472 191185  27735]
 [196157 191555  33133]]
Evaluating performance on  train set...
1876/1876 - 56s - 56s/epoch - 30ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1169294
{'0': {'precision': 0.3555029622651792, 'recall': 0.5533152384645211, 'f1-score': 0.4328813093370368, 'support': 165056}, '1': {'precision': 0.3229864350932299, 'recall': 0.40725976068287567, 'f1-score': 0.3602603588234621, 'support': 154523}, '2': {'precision': 0.3731558240831811, 'recall': 0.06613417336952461, 'f1-score': 0.11235562888691458, 'support': 160628}, 'accuracy': 0.3433560943509778, 'macro avg': {'precision': 0.3505484071471967, 'recall': 0.34223639083897384, 'f1-score': 0.30183243234913776, 'support': 480207}, 'weighted avg': {'precision': 0.3509444959369309, 'recall': 0.3433560943509778, 'f1-score': 0.3022980272616998, 'support': 480207}}
[[91328 64952  8776]
 [82523 62931  9069]
 [83047 66958 10623]]
Evaluating performance on  val set...
619/619 - 21s - 21s/epoch - 34ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1204473
{'0': {'precision': 0.33779509770699195, 'recall': 0.5736509946097331, 'f1-score': 0.4252067026396797, 'support': 52131}, '1': {'precision': 0.31768976681819666, 'recall': 0.3728553333589222, 'f1-score': 0.34306904467596677, 'support': 52106}, '2': {'precision': 0.38835174953959484, 'recall': 0.06232566731319848, 'f1-score': 0.10741289018353149, 'support': 54135}, 'accuracy': 0.33280504129517846, 'macro avg': {'precision': 0.3479455380215945, 'recall': 0.33627733176061797, 'f1-score': 0.291896212499726, 'support': 158372}, 'weighted avg': {'precision': 0.34846160425907435, 'recall': 0.33280504129517846, 'f1-score': 0.2895537283565311, 'support': 158372}}
[[29905 19697  2529]
 [29893 19428  2785]
 [28732 22029  3374]]
training model: results/EXC/W3/deepVOL_L3/h1000
Epoch 1/50
1876/1876 - 129s - loss: 3.2409 - accuracy1000: 0.4098 - val_loss: 3.7185 - val_accuracy1000: 0.3151 - 129s/epoch - 69ms/step
Epoch 2/50
1876/1876 - 118s - loss: 3.2339 - accuracy1000: 0.4154 - val_loss: 3.4554 - val_accuracy1000: 0.3156 - 118s/epoch - 63ms/step
Epoch 3/50
1876/1876 - 121s - loss: 3.2136 - accuracy1000: 0.4303 - val_loss: 3.4725 - val_accuracy1000: 0.3213 - 121s/epoch - 65ms/step
Epoch 4/50
1876/1876 - 128s - loss: 3.1926 - accuracy1000: 0.4370 - val_loss: 3.4733 - val_accuracy1000: 0.3168 - 128s/epoch - 68ms/step
Epoch 5/50
1876/1876 - 121s - loss: 3.1795 - accuracy1000: 0.4400 - val_loss: 3.5316 - val_accuracy1000: 0.3145 - 121s/epoch - 65ms/step
Epoch 6/50
1876/1876 - 123s - loss: 3.1608 - accuracy1000: 0.4493 - val_loss: 3.5620 - val_accuracy1000: 0.3146 - 123s/epoch - 66ms/step
Epoch 7/50
1876/1876 - 125s - loss: 3.1511 - accuracy1000: 0.4526 - val_loss: 3.5813 - val_accuracy1000: 0.3139 - 125s/epoch - 66ms/step
Epoch 8/50
1876/1876 - 129s - loss: 3.1427 - accuracy1000: 0.4559 - val_loss: 3.6238 - val_accuracy1000: 0.3113 - 129s/epoch - 69ms/step
Epoch 9/50
1876/1876 - 126s - loss: 3.1371 - accuracy1000: 0.4583 - val_loss: 3.6282 - val_accuracy1000: 0.3112 - 126s/epoch - 67ms/step
Epoch 10/50
1876/1876 - 130s - loss: 3.1384 - accuracy1000: 0.4587 - val_loss: 3.6158 - val_accuracy1000: 0.3124 - 130s/epoch - 69ms/step
Epoch 11/50
1876/1876 - 119s - loss: 3.1269 - accuracy1000: 0.4627 - val_loss: 3.6821 - val_accuracy1000: 0.3125 - 119s/epoch - 64ms/step
Epoch 12/50
1876/1876 - 127s - loss: 3.1182 - accuracy1000: 0.4655 - val_loss: 3.6626 - val_accuracy1000: 0.3118 - 127s/epoch - 68ms/step
testing model: results/EXC/W3/deepVOL_L3/h1000
Evaluating performance on  test set...
5098/5098 - 160s - 160s/epoch - 31ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1083026
{'0': {'precision': 0.4040734975990979, 'recall': 0.8999442975848888, 'f1-score': 0.5577280330260863, 'support': 522419}, '1': {'precision': 0.23717948717948717, 'recall': 0.0001148137689636661, 'f1-score': 0.00022951643368680934, 'support': 322261}, '2': {'precision': 0.37507965504057095, 'recall': 0.11510306780725331, 'f1-score': 0.17614990065922373, 'support': 460231}, 'accuracy': 0.40091546473284384, 'macro avg': {'precision': 0.33877754660638537, 'recall': 0.33838739305370197, 'f1-score': 0.24470248337299896, 'support': 1304911}, 'weighted avg': {'precision': 0.35263144841230465, 'recall': 0.40091546473284384, 'f1-score': 0.2854687640852031, 'support': 1304911}}
[[470148     64  52207]
 [286171     37  36053]
 [407202     55  52974]]
Evaluating performance on  train set...
1876/1876 - 56s - 56s/epoch - 30ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1270903
{'0': {'precision': 0.35093373650772813, 'recall': 0.927078350712714, 'f1-score': 0.5091392685629849, 'support': 167248}, '1': {'precision': 0.23728813559322035, 'recall': 9.199692467423232e-05, 'f1-score': 0.00018392254233502803, 'support': 152179}, '2': {'precision': 0.3846715899898228, 'recall': 0.09168428909068292, 'f1-score': 0.14807559982119625, 'support': 160780}, 'accuracy': 0.35361208812033146, 'macro avg': {'precision': 0.32429782069692376, 'recall': 0.33961821224269034, 'f1-score': 0.2191329303088387, 'support': 480207}, 'weighted avg': {'precision': 0.32621501766623334, 'recall': 0.35361208812033146, 'f1-score': 0.22696068253158333, 'support': 480207}}
[[155052     19  12177]
 [140762     14  11403]
 [146013     26  14741]]
Evaluating performance on  val set...
619/619 - 18s - 18s/epoch - 29ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1414586
{'0': {'precision': 0.31296813442669963, 'recall': 0.9304737931874467, 'f1-score': 0.4683912303738485, 'support': 49262}, '1': {'precision': 0.43478260869565216, 'recall': 0.00017177113214353196, 'f1-score': 0.00034340659340659343, 'support': 58217}, '2': {'precision': 0.3513036164844407, 'recall': 0.08207415558131767, 'f1-score': 0.1330614975391428, 'support': 50893}, 'accuracy': 0.31586391533856994, 'macro avg': {'precision': 0.3663514532022642, 'recall': 0.3375732399669693, 'f1-score': 0.20059871150213263, 'support': 158372}, 'weighted avg': {'precision': 0.3700658596362078, 'recall': 0.31586391533856994, 'f1-score': 0.18857992376546656, 'support': 158372}}
[[45837     6  3419]
 [53913    10  4294]
 [46709     7  4177]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        28 (peak)  25.17 (ave)

============================================
