This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/CHTR_orderbooks/CHTR_orderbooks_2019-12-18.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-12-10.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-11-27.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-12-06.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-12-02.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-12-04.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-11-29.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-12-20.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-12-03.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-12-16.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-12-05.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-11-26.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-12-12.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-12-11.csv
training model: results/CHTR/W9/deepLOB_L1/h10
Epoch 1/50
323/323 - 16s - loss: 3.3378 - accuracy10: 0.3536 - val_loss: 3.3460 - val_accuracy10: 0.3402 - 16s/epoch - 49ms/step
Epoch 2/50
323/323 - 6s - loss: 3.2995 - accuracy10: 0.3678 - val_loss: 3.3049 - val_accuracy10: 0.3630 - 6s/epoch - 18ms/step
Epoch 3/50
323/323 - 6s - loss: 3.2794 - accuracy10: 0.3764 - val_loss: 3.2859 - val_accuracy10: 0.3851 - 6s/epoch - 18ms/step
Epoch 4/50
323/323 - 6s - loss: 3.2674 - accuracy10: 0.3842 - val_loss: 3.2705 - val_accuracy10: 0.3926 - 6s/epoch - 17ms/step
Epoch 5/50
323/323 - 6s - loss: 3.2575 - accuracy10: 0.3916 - val_loss: 3.2665 - val_accuracy10: 0.3851 - 6s/epoch - 17ms/step
Epoch 6/50
323/323 - 6s - loss: 3.2481 - accuracy10: 0.3946 - val_loss: 3.2512 - val_accuracy10: 0.4026 - 6s/epoch - 18ms/step
Epoch 7/50
323/323 - 6s - loss: 3.2409 - accuracy10: 0.4020 - val_loss: 3.2474 - val_accuracy10: 0.4052 - 6s/epoch - 18ms/step
Epoch 8/50
323/323 - 6s - loss: 3.2332 - accuracy10: 0.4059 - val_loss: 3.2526 - val_accuracy10: 0.4040 - 6s/epoch - 17ms/step
Epoch 9/50
323/323 - 6s - loss: 3.2255 - accuracy10: 0.4106 - val_loss: 3.2527 - val_accuracy10: 0.4061 - 6s/epoch - 17ms/step
Epoch 10/50
323/323 - 5s - loss: 3.2181 - accuracy10: 0.4149 - val_loss: 3.2530 - val_accuracy10: 0.4067 - 5s/epoch - 17ms/step
Epoch 11/50
323/323 - 6s - loss: 3.2124 - accuracy10: 0.4163 - val_loss: 3.2437 - val_accuracy10: 0.4073 - 6s/epoch - 17ms/step
Epoch 12/50
323/323 - 6s - loss: 3.2102 - accuracy10: 0.4184 - val_loss: 3.2421 - val_accuracy10: 0.4107 - 6s/epoch - 18ms/step
Epoch 13/50
323/323 - 6s - loss: 3.2023 - accuracy10: 0.4245 - val_loss: 3.2427 - val_accuracy10: 0.4152 - 6s/epoch - 17ms/step
Epoch 14/50
323/323 - 5s - loss: 3.1966 - accuracy10: 0.4263 - val_loss: 3.2428 - val_accuracy10: 0.4144 - 5s/epoch - 17ms/step
Epoch 15/50
323/323 - 5s - loss: 3.1930 - accuracy10: 0.4270 - val_loss: 3.2523 - val_accuracy10: 0.4133 - 5s/epoch - 17ms/step
Epoch 16/50
323/323 - 5s - loss: 3.1873 - accuracy10: 0.4319 - val_loss: 3.2445 - val_accuracy10: 0.4128 - 5s/epoch - 17ms/step
Epoch 17/50
323/323 - 5s - loss: 3.1817 - accuracy10: 0.4350 - val_loss: 3.2497 - val_accuracy10: 0.4110 - 5s/epoch - 17ms/step
Epoch 18/50
323/323 - 5s - loss: 3.1765 - accuracy10: 0.4349 - val_loss: 3.2594 - val_accuracy10: 0.4078 - 5s/epoch - 17ms/step
Epoch 19/50
323/323 - 5s - loss: 3.1714 - accuracy10: 0.4375 - val_loss: 3.2529 - val_accuracy10: 0.4067 - 5s/epoch - 17ms/step
Epoch 20/50
323/323 - 5s - loss: 3.1656 - accuracy10: 0.4400 - val_loss: 3.2685 - val_accuracy10: 0.4080 - 5s/epoch - 17ms/step
Epoch 21/50
323/323 - 5s - loss: 3.1612 - accuracy10: 0.4433 - val_loss: 3.2633 - val_accuracy10: 0.4153 - 5s/epoch - 17ms/step
Epoch 22/50
323/323 - 5s - loss: 3.1591 - accuracy10: 0.4424 - val_loss: 3.2705 - val_accuracy10: 0.4109 - 5s/epoch - 17ms/step
testing model: results/CHTR/W9/deepLOB_L1/h10
Evaluating performance on  test set...
604/604 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1020623
{'0': {'precision': 0.391769558717679, 'recall': 0.5403810905758363, 'f1-score': 0.4542288557213931, 'support': 52376}, '1': {'precision': 0.41921119592875317, 'recall': 0.02450725176645593, 'f1-score': 0.04630735717799171, 'support': 53780}, '2': {'precision': 0.3542721198623203, 'recall': 0.5801558355437666, 'f1-score': 0.43991200502828415, 'support': 48256}, 'accuracy': 0.37313809807527915, 'macro avg': {'precision': 0.3884176248362508, 'recall': 0.3816813926286862, 'f1-score': 0.313482739309223, 'support': 154412}, 'weighted avg': {'precision': 0.3896086828777661, 'recall': 0.37313809807527915, 'f1-score': 0.3076800632783784, 'support': 154412}}
[[28303   882 23191]
 [24625  1318 27837]
 [19316   944 27996]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0761819
{'0': {'precision': 0.42666942197555646, 'recall': 0.49143148588915336, 'f1-score': 0.45676632324126165, 'support': 29410}, '1': {'precision': 0.3865942203202385, 'recall': 0.31011339967600093, 'f1-score': 0.3441559831346446, 'support': 25926}, '2': {'precision': 0.4059505077957374, 'recall': 0.41583940803692443, 'f1-score': 0.4108354595298844, 'support': 27299}, 'accuracy': 0.4095722151630665, 'macro avg': {'precision': 0.4064047166971774, 'recall': 0.40579476453402624, 'f1-score': 0.40391925530193024, 'support': 82635}, 'weighted avg': {'precision': 0.4072515564668658, 'recall': 0.4095722151630665, 'f1-score': 0.40626227137388055, 'support': 82635}}
[[14453  6148  8809]
 [10083  8040  7803]
 [ 9338  6609 11352]]
Evaluating performance on  val set...
112/112 - 1s - 762ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0812949
{'0': {'precision': 0.44587521807759406, 'recall': 0.49252087730568045, 'f1-score': 0.46803871980465683, 'support': 10897}, '1': {'precision': 0.32444782939832445, 'recall': 0.11473202262321573, 'f1-score': 0.16951850378034222, 'support': 7426}, '2': {'precision': 0.4006389312422856, 'recall': 0.5456343320478592, 'f1-score': 0.4620279661726534, 'support': 10113}, 'accuracy': 0.4127514418342946, 'macro avg': {'precision': 0.3903206595727347, 'recall': 0.3842957439922518, 'f1-score': 0.36652839658588415, 'support': 28436}, 'weighted avg': {'precision': 0.39807685132074605, 'recall': 0.4127514418342946, 'f1-score': 0.3879431411129628, 'support': 28436}}
[[5367  816 4714]
 [3033  852 3541]
 [3637  958 5518]]
training model: results/CHTR/W9/deepLOB_L1/h20
Epoch 1/50
323/323 - 7s - loss: 3.3356 - accuracy20: 0.3564 - val_loss: 3.3653 - val_accuracy20: 0.3424 - 7s/epoch - 23ms/step
Epoch 2/50
323/323 - 5s - loss: 3.3079 - accuracy20: 0.3636 - val_loss: 3.3409 - val_accuracy20: 0.3415 - 5s/epoch - 17ms/step
Epoch 3/50
323/323 - 5s - loss: 3.2872 - accuracy20: 0.3733 - val_loss: 3.3365 - val_accuracy20: 0.3477 - 5s/epoch - 17ms/step
Epoch 4/50
323/323 - 5s - loss: 3.2822 - accuracy20: 0.3728 - val_loss: 3.3266 - val_accuracy20: 0.3521 - 5s/epoch - 17ms/step
Epoch 5/50
323/323 - 5s - loss: 3.2714 - accuracy20: 0.3777 - val_loss: 3.3197 - val_accuracy20: 0.3658 - 5s/epoch - 17ms/step
Epoch 6/50
323/323 - 5s - loss: 3.2600 - accuracy20: 0.3893 - val_loss: 3.3236 - val_accuracy20: 0.3706 - 5s/epoch - 17ms/step
Epoch 7/50
323/323 - 5s - loss: 3.2519 - accuracy20: 0.3916 - val_loss: 3.3070 - val_accuracy20: 0.3769 - 5s/epoch - 17ms/step
Epoch 8/50
323/323 - 5s - loss: 3.2438 - accuracy20: 0.3989 - val_loss: 3.3061 - val_accuracy20: 0.3813 - 5s/epoch - 17ms/step
Epoch 9/50
323/323 - 5s - loss: 3.2401 - accuracy20: 0.4018 - val_loss: 3.3129 - val_accuracy20: 0.3813 - 5s/epoch - 17ms/step
Epoch 10/50
323/323 - 6s - loss: 3.2364 - accuracy20: 0.4038 - val_loss: 3.3189 - val_accuracy20: 0.3799 - 6s/epoch - 17ms/step
Epoch 11/50
323/323 - 5s - loss: 3.2294 - accuracy20: 0.4093 - val_loss: 3.3144 - val_accuracy20: 0.3862 - 5s/epoch - 17ms/step
Epoch 12/50
323/323 - 5s - loss: 3.2268 - accuracy20: 0.4083 - val_loss: 3.3260 - val_accuracy20: 0.3881 - 5s/epoch - 17ms/step
Epoch 13/50
323/323 - 5s - loss: 3.2214 - accuracy20: 0.4147 - val_loss: 3.3279 - val_accuracy20: 0.3843 - 5s/epoch - 17ms/step
Epoch 14/50
323/323 - 5s - loss: 3.2158 - accuracy20: 0.4143 - val_loss: 3.3081 - val_accuracy20: 0.3857 - 5s/epoch - 17ms/step
Epoch 15/50
323/323 - 5s - loss: 3.2076 - accuracy20: 0.4204 - val_loss: 3.3154 - val_accuracy20: 0.3811 - 5s/epoch - 17ms/step
Epoch 16/50
323/323 - 6s - loss: 3.2031 - accuracy20: 0.4210 - val_loss: 3.3332 - val_accuracy20: 0.3817 - 6s/epoch - 17ms/step
Epoch 17/50
323/323 - 5s - loss: 3.1965 - accuracy20: 0.4245 - val_loss: 3.3350 - val_accuracy20: 0.3781 - 5s/epoch - 17ms/step
Epoch 18/50
323/323 - 5s - loss: 3.1930 - accuracy20: 0.4276 - val_loss: 3.3314 - val_accuracy20: 0.3787 - 5s/epoch - 17ms/step
testing model: results/CHTR/W9/deepLOB_L1/h20
Evaluating performance on  test set...
604/604 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.108714
{'0': {'precision': 0.3305286160913673, 'recall': 0.8479212701530403, 'f1-score': 0.4756455870538275, 'support': 48876}, '1': {'precision': 0.39899737951464054, 'recall': 0.05877416756176155, 'f1-score': 0.10245607875835637, 'support': 59584}, '2': {'precision': 0.3613648708705743, 'recall': 0.15925313370473537, 'f1-score': 0.22107759467093635, 'support': 45952}, 'accuracy': 0.3384646271015206, 'macro avg': {'precision': 0.3636302888255274, 'recall': 0.355316190473179, 'f1-score': 0.26639308682770674, 'support': 154412}, 'weighted avg': {'precision': 0.36612578716243976, 'recall': 0.3384646271015206, 'f1-score': 0.25588266676100074, 'support': 154412}}
[[41443  2480  4953]
 [48102  3502  7980]
 [35839  2795  7318]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.088404
{'0': {'precision': 0.40431390546122076, 'recall': 0.43104773886908504, 'f1-score': 0.41725304465493906, 'support': 28614}, '1': {'precision': 0.35813461698989957, 'recall': 0.4618061784650712, 'f1-score': 0.40341639241498195, 'support': 27871}, '2': {'precision': 0.38678196417541694, 'recall': 0.23946462715105163, 'f1-score': 0.2957959376476146, 'support': 26150}, 'accuracy': 0.3807950626247958, 'macro avg': {'precision': 0.3830768288755124, 'recall': 0.37743951482840266, 'f1-score': 0.3721551249058452, 'support': 82635}, 'weighted avg': {'precision': 0.3831906137130758, 'recall': 0.3807950626247958, 'f1-score': 0.37415091259441535, 'support': 82635}}
[[12334 11375  4905]
 [ 9977 12871  5023]
 [ 8195 11693  6262]]
Evaluating performance on  val set...
112/112 - 1s - 750ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0973309
{'0': {'precision': 0.4069894899735637, 'recall': 0.5964845964845965, 'f1-score': 0.48384500402437625, 'support': 10582}, '1': {'precision': 0.3185826771653543, 'recall': 0.2506815365551425, 'f1-score': 0.28058252427184466, 'support': 8070}, '2': {'precision': 0.3902995286604835, 'recall': 0.26236713000817663, 'f1-score': 0.3137950003056048, 'support': 9784}, 'accuracy': 0.3833872555915037, 'macro avg': {'precision': 0.37195723193313385, 'recall': 0.3698444210159719, 'f1-score': 0.3594075095339419, 'support': 28436}, 'weighted avg': {'precision': 0.3761575318623868, 'recall': 0.3833872555915037, 'f1-score': 0.367650832974039, 'support': 28436}}
[[6312 2179 2091]
 [4128 2023 1919]
 [5069 2148 2567]]
training model: results/CHTR/W9/deepLOB_L1/h30
Epoch 1/50
323/323 - 7s - loss: 3.3433 - accuracy30: 0.3488 - val_loss: 3.3659 - val_accuracy30: 0.3485 - 7s/epoch - 23ms/step
Epoch 2/50
323/323 - 5s - loss: 3.3072 - accuracy30: 0.3613 - val_loss: 3.3554 - val_accuracy30: 0.3554 - 5s/epoch - 17ms/step
Epoch 3/50
323/323 - 6s - loss: 3.2903 - accuracy30: 0.3693 - val_loss: 3.3154 - val_accuracy30: 0.3551 - 6s/epoch - 17ms/step
Epoch 4/50
323/323 - 6s - loss: 3.2850 - accuracy30: 0.3739 - val_loss: 3.3118 - val_accuracy30: 0.3659 - 6s/epoch - 17ms/step
Epoch 5/50
323/323 - 6s - loss: 3.2729 - accuracy30: 0.3795 - val_loss: 3.2997 - val_accuracy30: 0.3622 - 6s/epoch - 17ms/step
Epoch 6/50
323/323 - 5s - loss: 3.2650 - accuracy30: 0.3859 - val_loss: 3.2958 - val_accuracy30: 0.3618 - 5s/epoch - 17ms/step
Epoch 7/50
323/323 - 5s - loss: 3.2595 - accuracy30: 0.3882 - val_loss: 3.2862 - val_accuracy30: 0.3725 - 5s/epoch - 17ms/step
Epoch 8/50
323/323 - 5s - loss: 3.2522 - accuracy30: 0.3939 - val_loss: 3.2812 - val_accuracy30: 0.3758 - 5s/epoch - 17ms/step
Epoch 9/50
323/323 - 5s - loss: 3.2436 - accuracy30: 0.3998 - val_loss: 3.2858 - val_accuracy30: 0.3729 - 5s/epoch - 17ms/step
Epoch 10/50
323/323 - 5s - loss: 3.2380 - accuracy30: 0.4041 - val_loss: 3.2953 - val_accuracy30: 0.3664 - 5s/epoch - 17ms/step
Epoch 11/50
323/323 - 5s - loss: 3.2314 - accuracy30: 0.4077 - val_loss: 3.2882 - val_accuracy30: 0.3724 - 5s/epoch - 17ms/step
Epoch 12/50
323/323 - 5s - loss: 3.2254 - accuracy30: 0.4122 - val_loss: 3.2917 - val_accuracy30: 0.3672 - 5s/epoch - 17ms/step
Epoch 13/50
323/323 - 5s - loss: 3.2213 - accuracy30: 0.4152 - val_loss: 3.2898 - val_accuracy30: 0.3700 - 5s/epoch - 17ms/step
Epoch 14/50
323/323 - 5s - loss: 3.2158 - accuracy30: 0.4168 - val_loss: 3.2841 - val_accuracy30: 0.3797 - 5s/epoch - 17ms/step
Epoch 15/50
323/323 - 5s - loss: 3.2100 - accuracy30: 0.4198 - val_loss: 3.2797 - val_accuracy30: 0.3791 - 5s/epoch - 17ms/step
Epoch 16/50
323/323 - 6s - loss: 3.2066 - accuracy30: 0.4215 - val_loss: 3.2842 - val_accuracy30: 0.3795 - 6s/epoch - 17ms/step
Epoch 17/50
323/323 - 5s - loss: 3.2017 - accuracy30: 0.4242 - val_loss: 3.2783 - val_accuracy30: 0.3836 - 5s/epoch - 17ms/step
Epoch 18/50
323/323 - 5s - loss: 3.1969 - accuracy30: 0.4272 - val_loss: 3.2807 - val_accuracy30: 0.3860 - 5s/epoch - 17ms/step
Epoch 19/50
323/323 - 5s - loss: 3.1931 - accuracy30: 0.4288 - val_loss: 3.2827 - val_accuracy30: 0.3824 - 5s/epoch - 17ms/step
Epoch 20/50
323/323 - 5s - loss: 3.1890 - accuracy30: 0.4292 - val_loss: 3.2854 - val_accuracy30: 0.3804 - 5s/epoch - 17ms/step
Epoch 21/50
323/323 - 5s - loss: 3.1844 - accuracy30: 0.4331 - val_loss: 3.2816 - val_accuracy30: 0.3864 - 5s/epoch - 17ms/step
Epoch 22/50
323/323 - 5s - loss: 3.1787 - accuracy30: 0.4349 - val_loss: 3.2949 - val_accuracy30: 0.3736 - 5s/epoch - 17ms/step
Epoch 23/50
323/323 - 5s - loss: 3.1772 - accuracy30: 0.4344 - val_loss: 3.3019 - val_accuracy30: 0.3708 - 5s/epoch - 17ms/step
Epoch 24/50
323/323 - 5s - loss: 3.1711 - accuracy30: 0.4371 - val_loss: 3.2982 - val_accuracy30: 0.3800 - 5s/epoch - 17ms/step
Epoch 25/50
323/323 - 5s - loss: 3.1652 - accuracy30: 0.4393 - val_loss: 3.2992 - val_accuracy30: 0.3796 - 5s/epoch - 16ms/step
Epoch 26/50
323/323 - 5s - loss: 3.1615 - accuracy30: 0.4404 - val_loss: 3.3152 - val_accuracy30: 0.3660 - 5s/epoch - 17ms/step
Epoch 27/50
323/323 - 5s - loss: 3.1599 - accuracy30: 0.4412 - val_loss: 3.3141 - val_accuracy30: 0.3673 - 5s/epoch - 17ms/step
testing model: results/CHTR/W9/deepLOB_L1/h30
Evaluating performance on  test set...
604/604 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.148805
{'0': {'precision': 0.33772840006073795, 'recall': 0.5437284820828325, 'f1-score': 0.4166569098075948, 'support': 49087}, '1': {'precision': 0.3846926476496585, 'recall': 0.0321481332258931, 'f1-score': 0.05933752672512627, 'support': 59568}, '2': {'precision': 0.315413459080192, 'recall': 0.4853246497803615, 'f1-score': 0.38234205383814124, 'support': 45757}, 'accuracy': 0.32906768903971195, 'macro avg': {'precision': 0.34594483559686284, 'recall': 0.35373375502969573, 'f1-score': 0.2861121634569541, 'support': 154412}, 'weighted avg': {'precision': 0.3492333449220828, 'recall': 0.32906768903971195, 'f1-score': 0.2686441525345151, 'support': 154412}}
[[26690  1589 20808]
 [30262  1915 27391]
 [22076  1474 22207]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0900326
{'0': {'precision': 0.40060499682563394, 'recall': 0.371099425724763, 'f1-score': 0.3852881489862256, 'support': 28906}, '1': {'precision': 0.3745853361316092, 'recall': 0.4003038634061641, 'f1-score': 0.38701780155982235, 'support': 27644}, '2': {'precision': 0.3779829761361909, 'recall': 0.3813302664366494, 'f1-score': 0.3796492433350508, 'support': 26085}, 'accuracy': 0.38409874750408424, 'macro avg': {'precision': 0.3843911030311447, 'recall': 0.38424451852252545, 'f1-score': 0.3839850646270329, 'support': 82635}, 'weighted avg': {'precision': 0.3847596176290497, 'recall': 0.38409874750408424, 'f1-score': 0.38408676533321673, 'support': 82635}}
[[10727  9860  8319]
 [ 8528 11066  8050]
 [ 7522  8616  9947]]
Evaluating performance on  val set...
112/112 - 1s - 783ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0935991
{'0': {'precision': 0.41126194067370536, 'recall': 0.4645088018171493, 'f1-score': 0.43626666666666664, 'support': 10566}, '1': {'precision': 0.3174163291409081, 'recall': 0.18722494656104616, 'f1-score': 0.23552673204682065, 'support': 7953}, '2': {'precision': 0.3821014308695284, 'recall': 0.4550771402641928, 'f1-score': 0.4154086892488955, 'support': 9917}, 'accuracy': 0.38366858911239277, 'macro avg': {'precision': 0.3702599002280473, 'recall': 0.36893696288079614, 'f1-score': 0.3624006959874609, 'support': 28436}, 'weighted avg': {'precision': 0.3748454642266538, 'recall': 0.38366858911239277, 'f1-score': 0.3728494046718829, 'support': 28436}}
[[4908 1691 3967]
 [3133 1489 3331]
 [3893 1511 4513]]
training model: results/CHTR/W9/deepLOB_L1/h50
Epoch 1/50
323/323 - 8s - loss: 3.3411 - accuracy50: 0.3524 - val_loss: 3.4171 - val_accuracy50: 0.3229 - 8s/epoch - 24ms/step
Epoch 2/50
323/323 - 6s - loss: 3.3127 - accuracy50: 0.3537 - val_loss: 3.3512 - val_accuracy50: 0.3303 - 6s/epoch - 17ms/step
Epoch 3/50
323/323 - 5s - loss: 3.2980 - accuracy50: 0.3617 - val_loss: 3.3550 - val_accuracy50: 0.3473 - 5s/epoch - 17ms/step
Epoch 4/50
323/323 - 6s - loss: 3.2875 - accuracy50: 0.3681 - val_loss: 3.3239 - val_accuracy50: 0.3445 - 6s/epoch - 17ms/step
Epoch 5/50
323/323 - 6s - loss: 3.2844 - accuracy50: 0.3707 - val_loss: 3.3186 - val_accuracy50: 0.3619 - 6s/epoch - 17ms/step
Epoch 6/50
323/323 - 6s - loss: 3.2775 - accuracy50: 0.3769 - val_loss: 3.3117 - val_accuracy50: 0.3660 - 6s/epoch - 17ms/step
Epoch 7/50
323/323 - 5s - loss: 3.2682 - accuracy50: 0.3841 - val_loss: 3.3140 - val_accuracy50: 0.3622 - 5s/epoch - 17ms/step
Epoch 8/50
323/323 - 6s - loss: 3.2596 - accuracy50: 0.3894 - val_loss: 3.3221 - val_accuracy50: 0.3527 - 6s/epoch - 18ms/step
Epoch 9/50
323/323 - 6s - loss: 3.2539 - accuracy50: 0.3954 - val_loss: 3.3111 - val_accuracy50: 0.3615 - 6s/epoch - 17ms/step
Epoch 10/50
323/323 - 5s - loss: 3.2498 - accuracy50: 0.3993 - val_loss: 3.3146 - val_accuracy50: 0.3642 - 5s/epoch - 17ms/step
Epoch 11/50
323/323 - 5s - loss: 3.2451 - accuracy50: 0.4009 - val_loss: 3.3117 - val_accuracy50: 0.3696 - 5s/epoch - 17ms/step
Epoch 12/50
323/323 - 6s - loss: 3.2417 - accuracy50: 0.4028 - val_loss: 3.3174 - val_accuracy50: 0.3638 - 6s/epoch - 17ms/step
Epoch 13/50
323/323 - 5s - loss: 3.2317 - accuracy50: 0.4116 - val_loss: 3.3244 - val_accuracy50: 0.3623 - 5s/epoch - 17ms/step
Epoch 14/50
323/323 - 5s - loss: 3.2276 - accuracy50: 0.4134 - val_loss: 3.3210 - val_accuracy50: 0.3646 - 5s/epoch - 17ms/step
Epoch 15/50
323/323 - 5s - loss: 3.2220 - accuracy50: 0.4144 - val_loss: 3.3274 - val_accuracy50: 0.3639 - 5s/epoch - 17ms/step
Epoch 16/50
323/323 - 5s - loss: 3.2175 - accuracy50: 0.4202 - val_loss: 3.3222 - val_accuracy50: 0.3669 - 5s/epoch - 17ms/step
Epoch 17/50
323/323 - 5s - loss: 3.2099 - accuracy50: 0.4217 - val_loss: 3.3371 - val_accuracy50: 0.3713 - 5s/epoch - 17ms/step
Epoch 18/50
323/323 - 5s - loss: 3.2108 - accuracy50: 0.4221 - val_loss: 3.3375 - val_accuracy50: 0.3690 - 5s/epoch - 17ms/step
Epoch 19/50
323/323 - 5s - loss: 3.2039 - accuracy50: 0.4246 - val_loss: 3.3513 - val_accuracy50: 0.3647 - 5s/epoch - 17ms/step
testing model: results/CHTR/W9/deepLOB_L1/h50
Evaluating performance on  test set...
604/604 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1067524
{'0': {'precision': 0.3399969297422689, 'recall': 0.40899950755088643, 'f1-score': 0.37131972839805144, 'support': 48736}, '1': {'precision': 0.38659453753793377, 'recall': 0.19526824391869377, 'f1-score': 0.2594757350336522, 'support': 60020}, '2': {'precision': 0.3080389191831248, 'recall': 0.4417163132994568, 'f1-score': 0.3629606299212599, 'support': 45656}, 'accuracy': 0.33559567909229854, 'macro avg': {'precision': 0.34487679548777583, 'recall': 0.34866135492301237, 'f1-score': 0.3312520311176545, 'support': 154412}, 'weighted avg': {'precision': 0.34866020390365227, 'recall': 0.33559567909229854, 'f1-score': 0.3253743389089726, 'support': 154412}}
[[19933  9603 19200]
 [22198 11720 26102]
 [16496  8993 20167]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0970159
{'0': {'precision': 0.4032086979581013, 'recall': 0.31070771745793885, 'f1-score': 0.3509656074478726, 'support': 29362}, '1': {'precision': 0.3466006757157252, 'recall': 0.4295684113865932, 'f1-score': 0.3836501714042023, 'support': 27225}, '2': {'precision': 0.35470362051243004, 'recall': 0.3576858108108108, 'f1-score': 0.3561884736691197, 'support': 26048}, 'accuracy': 0.3646759847522236, 'macro avg': {'precision': 0.36817099806208553, 'recall': 0.36598731321844763, 'f1-score': 0.3636014175070648, 'support': 82635}, 'weighted avg': {'precision': 0.3692689186532845, 'recall': 0.3646759847522236, 'f1-score': 0.36338023167540473, 'support': 82635}}
[[ 9123 11495  8744]
 [ 7324 11695  8206]
 [ 6179 10552  9317]]
Evaluating performance on  val set...
112/112 - 1s - 742ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1033279
{'0': {'precision': 0.40278072596051795, 'recall': 0.3617041555470835, 'f1-score': 0.3811388972582103, 'support': 10492}, '1': {'precision': 0.29054726368159206, 'recall': 0.2539761431411531, 'f1-score': 0.2710336140025194, 'support': 8048}, '2': {'precision': 0.37014775857751064, 'recall': 0.4480598221503638, 'f1-score': 0.4053942857142857, 'support': 9896}, 'accuracy': 0.361267407511605, 'macro avg': {'precision': 0.3544919160732069, 'recall': 0.35458004027953344, 'f1-score': 0.35252226565833844, 'support': 28436}, 'weighted avg': {'precision': 0.35965965585069115, 'recall': 0.361267407511605, 'f1-score': 0.35841783960310836, 'support': 28436}}
[[3795 2534 4163]
 [2622 2044 3382]
 [3005 2457 4434]]
training model: results/CHTR/W9/deepLOB_L1/h100
Epoch 1/50
323/323 - 7s - loss: 3.3419 - accuracy100: 0.3545 - val_loss: 3.4072 - val_accuracy100: 0.3243 - 7s/epoch - 23ms/step
Epoch 2/50
323/323 - 5s - loss: 3.3227 - accuracy100: 0.3506 - val_loss: 3.3851 - val_accuracy100: 0.3202 - 5s/epoch - 17ms/step
Epoch 3/50
323/323 - 5s - loss: 3.3027 - accuracy100: 0.3582 - val_loss: 3.3629 - val_accuracy100: 0.3305 - 5s/epoch - 17ms/step
Epoch 4/50
323/323 - 6s - loss: 3.2974 - accuracy100: 0.3602 - val_loss: 3.3427 - val_accuracy100: 0.3253 - 6s/epoch - 17ms/step
Epoch 5/50
323/323 - 6s - loss: 3.2894 - accuracy100: 0.3692 - val_loss: 3.3629 - val_accuracy100: 0.3393 - 6s/epoch - 17ms/step
Epoch 6/50
323/323 - 5s - loss: 3.2851 - accuracy100: 0.3668 - val_loss: 3.3538 - val_accuracy100: 0.3330 - 5s/epoch - 17ms/step
Epoch 7/50
323/323 - 5s - loss: 3.2766 - accuracy100: 0.3745 - val_loss: 3.3513 - val_accuracy100: 0.3410 - 5s/epoch - 17ms/step
Epoch 8/50
323/323 - 5s - loss: 3.2705 - accuracy100: 0.3797 - val_loss: 3.3699 - val_accuracy100: 0.3323 - 5s/epoch - 17ms/step
Epoch 9/50
323/323 - 5s - loss: 3.2631 - accuracy100: 0.3876 - val_loss: 3.3717 - val_accuracy100: 0.3211 - 5s/epoch - 17ms/step
Epoch 10/50
323/323 - 5s - loss: 3.2592 - accuracy100: 0.3898 - val_loss: 3.4004 - val_accuracy100: 0.3239 - 5s/epoch - 17ms/step
Epoch 11/50
323/323 - 5s - loss: 3.2514 - accuracy100: 0.3967 - val_loss: 3.4382 - val_accuracy100: 0.3213 - 5s/epoch - 17ms/step
Epoch 12/50
323/323 - 5s - loss: 3.2441 - accuracy100: 0.3999 - val_loss: 3.4313 - val_accuracy100: 0.3193 - 5s/epoch - 17ms/step
Epoch 13/50
323/323 - 5s - loss: 3.2355 - accuracy100: 0.4064 - val_loss: 3.4411 - val_accuracy100: 0.3144 - 5s/epoch - 17ms/step
Epoch 14/50
323/323 - 5s - loss: 3.2359 - accuracy100: 0.4053 - val_loss: 3.4359 - val_accuracy100: 0.3260 - 5s/epoch - 17ms/step
testing model: results/CHTR/W9/deepLOB_L1/h100
Evaluating performance on  test set...
604/604 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.101943
{'0': {'precision': 0.3093067837486859, 'recall': 0.5197323302645525, 'f1-score': 0.3878145982911284, 'support': 48119}, '1': {'precision': 0.37964375448671933, 'recall': 0.28048396453136654, 'f1-score': 0.32261631287472237, 'support': 60335}, '2': {'precision': 0.3168972775266554, 'recall': 0.19983463162017495, 'f1-score': 0.24510601956257763, 'support': 45958}, 'accuracy': 0.3310364479444603, 'macro avg': {'precision': 0.33528260525402026, 'recall': 0.33335030880536465, 'f1-score': 0.31851231024280946, 'support': 154412}, 'weighted avg': {'precision': 0.3390494529876516, 'recall': 0.3310364479444603, 'f1-score': 0.31986431326272646, 'support': 154412}}
[[25009 14493  8617]
 [32232 16923 11180]
 [23614 13160  9184]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1067631
{'0': {'precision': 0.3771083657697298, 'recall': 0.22837523913637606, 'f1-score': 0.2844741377476116, 'support': 29272}, '1': {'precision': 0.3302824753763241, 'recall': 0.5224132863021752, 'f1-score': 0.4047022657406353, 'support': 27216}, '2': {'precision': 0.3337145471180238, 'recall': 0.2789995028110299, 'f1-score': 0.30391401253983785, 'support': 26147}, 'accuracy': 0.34123555394203425, 'macro avg': {'precision': 0.3470351294213592, 'recall': 0.3432626760831938, 'f1-score': 0.3310301386760282, 'support': 82635}, 'weighted avg': {'precision': 0.34795568701093404, 'recall': 0.34123555394203425, 'f1-score': 0.3302225874075677, 'support': 82635}}
[[ 6685 15033  7554]
 [ 5987 14218  7011]
 [ 5055 13797  7295]]
Evaluating performance on  val set...
112/112 - 1s - 741ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1125404
{'0': {'precision': 0.3526966531656363, 'recall': 0.3234604105571848, 'f1-score': 0.33744646135019374, 'support': 10230}, '1': {'precision': 0.28728982100885914, 'recall': 0.383076181292189, 'f1-score': 0.3283397045149292, 'support': 8296}, '2': {'precision': 0.3390890890890891, 'recall': 0.2734611503531786, 'f1-score': 0.30275946821584176, 'support': 9910}, 'accuracy': 0.32342804895203264, 'macro avg': {'precision': 0.3263585210878615, 'recall': 0.32666591406751744, 'f1-score': 0.3228485446936549, 'support': 28436}, 'weighted avg': {'precision': 0.3288724148912234, 'recall': 0.32342804895203264, 'f1-score': 0.32270114707720243, 'support': 28436}}
[[3309 3974 2947]
 [2783 3178 2335]
 [3290 3910 2710]]
training model: results/CHTR/W9/deepLOB_L1/h200
Epoch 1/50
323/323 - 8s - loss: 3.3460 - accuracy200: 0.3508 - val_loss: 3.3793 - val_accuracy200: 0.3337 - 8s/epoch - 23ms/step
Epoch 2/50
323/323 - 6s - loss: 3.3168 - accuracy200: 0.3571 - val_loss: 3.3912 - val_accuracy200: 0.3288 - 6s/epoch - 17ms/step
Epoch 3/50
323/323 - 6s - loss: 3.3014 - accuracy200: 0.3624 - val_loss: 3.3623 - val_accuracy200: 0.3325 - 6s/epoch - 17ms/step
Epoch 4/50
323/323 - 6s - loss: 3.2906 - accuracy200: 0.3681 - val_loss: 3.3548 - val_accuracy200: 0.3382 - 6s/epoch - 17ms/step
Epoch 5/50
323/323 - 5s - loss: 3.2902 - accuracy200: 0.3690 - val_loss: 3.4153 - val_accuracy200: 0.3343 - 5s/epoch - 17ms/step
Epoch 6/50
323/323 - 5s - loss: 3.2903 - accuracy200: 0.3659 - val_loss: 3.3803 - val_accuracy200: 0.3386 - 5s/epoch - 17ms/step
Epoch 7/50
323/323 - 6s - loss: 3.2769 - accuracy200: 0.3793 - val_loss: 3.4139 - val_accuracy200: 0.3282 - 6s/epoch - 17ms/step
Epoch 8/50
323/323 - 5s - loss: 3.2723 - accuracy200: 0.3828 - val_loss: 3.4470 - val_accuracy200: 0.3333 - 5s/epoch - 17ms/step
Epoch 9/50
323/323 - 5s - loss: 3.2618 - accuracy200: 0.3875 - val_loss: 3.4477 - val_accuracy200: 0.3348 - 5s/epoch - 17ms/step
Epoch 10/50
323/323 - 5s - loss: 3.2569 - accuracy200: 0.3921 - val_loss: 3.4576 - val_accuracy200: 0.3393 - 5s/epoch - 17ms/step
Epoch 11/50
323/323 - 5s - loss: 3.2492 - accuracy200: 0.3962 - val_loss: 3.4228 - val_accuracy200: 0.3481 - 5s/epoch - 17ms/step
Epoch 12/50
323/323 - 5s - loss: 3.2445 - accuracy200: 0.3999 - val_loss: 3.4345 - val_accuracy200: 0.3441 - 5s/epoch - 17ms/step
Epoch 13/50
323/323 - 5s - loss: 3.2382 - accuracy200: 0.4052 - val_loss: 3.4403 - val_accuracy200: 0.3388 - 5s/epoch - 17ms/step
Epoch 14/50
323/323 - 5s - loss: 3.2343 - accuracy200: 0.4065 - val_loss: 3.4740 - val_accuracy200: 0.3392 - 5s/epoch - 17ms/step
testing model: results/CHTR/W9/deepLOB_L1/h200
Evaluating performance on  test set...
604/604 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1158433
{'0': {'precision': 0.31361077178834834, 'recall': 0.723165875974246, 'f1-score': 0.4374955955744332, 'support': 47216}, '1': {'precision': 0.3795797117394653, 'recall': 0.22848816994221569, 'f1-score': 0.28526247248147346, 'support': 60397}, '2': {'precision': 0.3308639285325199, 'recall': 0.0648945490288254, 'f1-score': 0.10850691343027616, 'support': 46799}, 'accuracy': 0.3301686397430251, 'macro avg': {'precision': 0.3413514706867778, 'recall': 0.338849531648429, 'f1-score': 0.27708832716206094, 'support': 154412}, 'weighted avg': {'precision': 0.3446430526259652, 'recall': 0.3301686397430251, 'f1-score': 0.2782413583965591, 'support': 154412}}
[[34145 10615  2456]
 [42911 13800  3686]
 [31821 11941  3037]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1052235
{'0': {'precision': 0.38894379246448424, 'recall': 0.21635457825115958, 'f1-score': 0.27804393420907386, 'support': 29105}, '1': {'precision': 0.33029947152084554, 'recall': 0.5815456190230034, 'f1-score': 0.421308866211029, 'support': 27083}, '2': {'precision': 0.3392143275944779, 'recall': 0.2406322078118501, 'f1-score': 0.28154308971863384, 'support': 26447}, 'accuracy': 0.3438131542324681, 'macro avg': {'precision': 0.3528191971932692, 'recall': 0.3461774683620043, 'f1-score': 0.32696529671291225, 'support': 82635}, 'weighted avg': {'precision': 0.3538078415776491, 'recall': 0.3438131542324681, 'f1-score': 0.32611782927981003, 'support': 82635}}
[[ 6297 16462  6346]
 [ 5282 15750  6051]
 [ 4611 15472  6364]]
Evaluating performance on  val set...
112/112 - 1s - 736ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1158288
{'0': {'precision': 0.35244813278008297, 'recall': 0.4211622372074574, 'f1-score': 0.38375350140056025, 'support': 10084}, '1': {'precision': 0.3109564064312946, 'recall': 0.4433939966910896, 'f1-score': 0.3655494933749026, 'support': 8462}, '2': {'precision': 0.3875, 'recall': 0.1692618806875632, 'f1-score': 0.23560872624912038, 'support': 9890}, 'accuracy': 0.34016739344492897, 'macro avg': {'precision': 0.3503015130704592, 'recall': 0.34460603819537, 'f1-score': 0.3283039070081944, 'support': 28436}, 'weighted avg': {'precision': 0.3522919919178496, 'recall': 0.34016739344492897, 'f1-score': 0.32681180277343774, 'support': 28436}}
[[4247 4276 1561]
 [3625 3752 1085]
 [4178 4038 1674]]
training model: results/CHTR/W9/deepLOB_L1/h300
Epoch 1/50
323/323 - 8s - loss: 3.3385 - accuracy300: 0.3504 - val_loss: 3.4833 - val_accuracy300: 0.3142 - 8s/epoch - 24ms/step
Epoch 2/50
323/323 - 5s - loss: 3.3108 - accuracy300: 0.3611 - val_loss: 3.4497 - val_accuracy300: 0.3352 - 5s/epoch - 17ms/step
Epoch 3/50
323/323 - 5s - loss: 3.2925 - accuracy300: 0.3695 - val_loss: 3.4623 - val_accuracy300: 0.3366 - 5s/epoch - 17ms/step
Epoch 4/50
323/323 - 6s - loss: 3.2826 - accuracy300: 0.3742 - val_loss: 3.5587 - val_accuracy300: 0.3431 - 6s/epoch - 17ms/step
Epoch 5/50
323/323 - 5s - loss: 3.2887 - accuracy300: 0.3703 - val_loss: 3.6069 - val_accuracy300: 0.3359 - 5s/epoch - 17ms/step
Epoch 6/50
323/323 - 5s - loss: 3.2732 - accuracy300: 0.3780 - val_loss: 3.5945 - val_accuracy300: 0.3428 - 5s/epoch - 17ms/step
Epoch 7/50
323/323 - 6s - loss: 3.2687 - accuracy300: 0.3826 - val_loss: 3.6611 - val_accuracy300: 0.3431 - 6s/epoch - 17ms/step
Epoch 8/50
323/323 - 6s - loss: 3.2577 - accuracy300: 0.3915 - val_loss: 3.5148 - val_accuracy300: 0.3415 - 6s/epoch - 17ms/step
Epoch 9/50
323/323 - 5s - loss: 3.2490 - accuracy300: 0.3937 - val_loss: 3.5538 - val_accuracy300: 0.3440 - 5s/epoch - 17ms/step
Epoch 10/50
323/323 - 5s - loss: 3.2418 - accuracy300: 0.4019 - val_loss: 3.5341 - val_accuracy300: 0.3434 - 5s/epoch - 17ms/step
Epoch 11/50
323/323 - 5s - loss: 3.2344 - accuracy300: 0.4081 - val_loss: 3.5108 - val_accuracy300: 0.3431 - 5s/epoch - 17ms/step
Epoch 12/50
323/323 - 5s - loss: 3.2281 - accuracy300: 0.4111 - val_loss: 3.5454 - val_accuracy300: 0.3411 - 5s/epoch - 17ms/step
testing model: results/CHTR/W9/deepLOB_L1/h300
Evaluating performance on  test set...
604/604 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1562897
{'0': {'precision': 0.30117928373457964, 'recall': 0.7154198670367262, 'f1-score': 0.4239028587819103, 'support': 46479}, '1': {'precision': 0.3877828170241115, 'recall': 0.2569308863725107, 'f1-score': 0.30907791279485347, 'support': 58903}, '2': {'precision': 0.3510745129544085, 'recall': 0.035651641851927394, 'f1-score': 0.06472995241533819, 'support': 49030}, 'accuracy': 0.32467683858767454, 'macro avg': {'precision': 0.34667887123769986, 'recall': 0.3360007984203881, 'f1-score': 0.26590357466403397, 'support': 154412}, 'weighted avg': {'precision': 0.3500587167449772, 'recall': 0.32467683858767454, 'f1-score': 0.2660538483900454, 'support': 154412}}
[[33252 11687  1540]
 [42078 15134  1691]
 [35076 12206  1748]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1085241
{'0': {'precision': 0.37192011757586235, 'recall': 0.29892644964041276, 'f1-score': 0.3314521255080224, 'support': 28783}, '1': {'precision': 0.3352724452200892, 'recall': 0.3812008525023885, 'f1-score': 0.3567645642753972, 'support': 27214}, '2': {'precision': 0.33425540109947827, 'recall': 0.3583602372550492, 'f1-score': 0.34588836349801616, 'support': 26638}, 'accuracy': 0.34518061354147755, 'macro avg': {'precision': 0.34714932129847664, 'recall': 0.34616251313261676, 'f1-score': 0.34470168442714527, 'support': 82635}, 'weighted avg': {'precision': 0.34770952311845416, 'recall': 0.34518061354147755, 'f1-score': 0.3444418419259178, 'support': 82635}}
[[ 8604 10451  9728]
 [ 7555 10374  9285]
 [ 6975 10117  9546]]
Evaluating performance on  val set...
112/112 - 1s - 776ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1460743
{'0': {'precision': 0.34906567738389666, 'recall': 0.5126109765940274, 'f1-score': 0.4153179663233611, 'support': 9912}, '1': {'precision': 0.3143736464151374, 'recall': 0.3173762945914845, 'f1-score': 0.3158678348508275, 'support': 8690}, '2': {'precision': 0.34188368905423927, 'recall': 0.17754728492983526, 'f1-score': 0.23371929589719562, 'support': 9834}, 'accuracy': 0.3370727247151498, 'macro avg': {'precision': 0.3351076709510911, 'recall': 0.335844852038449, 'f1-score': 0.32163503235712804, 'support': 28436}, 'weighted avg': {'precision': 0.3359801019741214, 'recall': 0.3370727247151498, 'f1-score': 0.3221240231714681, 'support': 28436}}
[[5081 3037 1794]
 [4365 2758 1567]
 [5110 2978 1746]]
training model: results/CHTR/W9/deepLOB_L1/h500
Epoch 1/50
323/323 - 8s - loss: 3.3432 - accuracy500: 0.3532 - val_loss: 3.4875 - val_accuracy500: 0.3327 - 8s/epoch - 24ms/step
Epoch 2/50
323/323 - 6s - loss: 3.3077 - accuracy500: 0.3651 - val_loss: 3.4030 - val_accuracy500: 0.3315 - 6s/epoch - 17ms/step
Epoch 3/50
323/323 - 5s - loss: 3.2810 - accuracy500: 0.3784 - val_loss: 3.4625 - val_accuracy500: 0.3348 - 5s/epoch - 17ms/step
Epoch 4/50
323/323 - 5s - loss: 3.2688 - accuracy500: 0.3851 - val_loss: 3.4833 - val_accuracy500: 0.3304 - 5s/epoch - 17ms/step
Epoch 5/50
323/323 - 6s - loss: 3.2599 - accuracy500: 0.3934 - val_loss: 3.5292 - val_accuracy500: 0.3304 - 6s/epoch - 17ms/step
Epoch 6/50
323/323 - 5s - loss: 3.2557 - accuracy500: 0.3914 - val_loss: 3.5651 - val_accuracy500: 0.3319 - 5s/epoch - 17ms/step
Epoch 7/50
323/323 - 5s - loss: 3.2506 - accuracy500: 0.3946 - val_loss: 3.5877 - val_accuracy500: 0.3258 - 5s/epoch - 17ms/step
Epoch 8/50
323/323 - 6s - loss: 3.2307 - accuracy500: 0.4100 - val_loss: 3.5631 - val_accuracy500: 0.3304 - 6s/epoch - 17ms/step
Epoch 9/50
323/323 - 6s - loss: 3.2316 - accuracy500: 0.4079 - val_loss: 3.5146 - val_accuracy500: 0.3310 - 6s/epoch - 17ms/step
Epoch 10/50
323/323 - 6s - loss: 3.2151 - accuracy500: 0.4188 - val_loss: 3.5622 - val_accuracy500: 0.3277 - 6s/epoch - 17ms/step
Epoch 11/50
323/323 - 5s - loss: 3.2051 - accuracy500: 0.4254 - val_loss: 3.6022 - val_accuracy500: 0.3266 - 5s/epoch - 17ms/step
Epoch 12/50
323/323 - 5s - loss: 3.1996 - accuracy500: 0.4278 - val_loss: 3.6535 - val_accuracy500: 0.3250 - 5s/epoch - 17ms/step
testing model: results/CHTR/W9/deepLOB_L1/h500
Evaluating performance on  test set...
604/604 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.143599
{'0': {'precision': 0.29725729407279494, 'recall': 0.5779124520404604, 'f1-score': 0.3925837072578376, 'support': 45872}, '1': {'precision': 0.37237209010871947, 'recall': 0.20361138236453033, 'f1-score': 0.2632686514265462, 'support': 58371}, '2': {'precision': 0.32011527031489206, 'recall': 0.21256154198808028, 'f1-score': 0.2554802232816655, 'support': 50169}, 'accuracy': 0.31771494443437037, 'macro avg': {'precision': 0.3299148848321355, 'recall': 0.3313617921310237, 'f1-score': 0.30377752732201646, 'support': 154412}, 'weighted avg': {'precision': 0.33307891136615764, 'recall': 0.31771494443437037, 'f1-score': 0.2991544801800917, 'support': 154412}}
[[26510  9580  9782]
 [33619 11885 12867]
 [29053 10452 10664]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1209493
{'0': {'precision': 0.3649805447470817, 'recall': 0.28121472911963885, 'f1-score': 0.3176683865569656, 'support': 28352}, '1': {'precision': 0.334932335790516, 'recall': 0.558404871964194, 'f1-score': 0.4187172468811466, 'support': 27258}, '2': {'precision': 0.33724340175953077, 'recall': 0.19148936170212766, 'f1-score': 0.24427661080953506, 'support': 27025}, 'accuracy': 0.34330489502026984, 'macro avg': {'precision': 0.3457187607657095, 'recall': 0.34370298759532014, 'f1-score': 0.3268874147492158, 'support': 82635}, 'weighted avg': {'precision': 0.3459976637768314, 'recall': 0.34330489502026984, 'f1-score': 0.32699829634267646, 'support': 82635}}
[[ 7973 15054  5325]
 [ 7192 15221  4845]
 [ 6680 15170  5175]]
Evaluating performance on  val set...
112/112 - 1s - 773ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1302482
{'0': {'precision': 0.3406120900429981, 'recall': 0.41804635761589404, 'f1-score': 0.3753774680603949, 'support': 9664}, '1': {'precision': 0.31744992800104727, 'recall': 0.26430517711171664, 'f1-score': 0.28845010110622105, 'support': 9175}, '2': {'precision': 0.3369516562220233, 'recall': 0.3137438782953006, 'f1-score': 0.3249339016888793, 'support': 9597}, 'accuracy': 0.333239555493037, 'macro avg': {'precision': 0.3316712247553562, 'recall': 0.3320318043409704, 'f1-score': 0.3295871569518318, 'support': 28436}, 'weighted avg': {'precision': 0.3319033398631277, 'recall': 0.333239555493037, 'f1-score': 0.33030553465654133, 'support': 28436}}
[[4040 2462 3162]
 [3987 2425 2763]
 [3834 2752 3011]]
training model: results/CHTR/W9/deepLOB_L1/h1000
Epoch 1/50
323/323 - 7s - loss: 3.3168 - accuracy1000: 0.3685 - val_loss: 3.5555 - val_accuracy1000: 0.3296 - 7s/epoch - 23ms/step
Epoch 2/50
323/323 - 5s - loss: 3.2780 - accuracy1000: 0.3902 - val_loss: 3.5521 - val_accuracy1000: 0.3273 - 5s/epoch - 17ms/step
Epoch 3/50
323/323 - 6s - loss: 3.2674 - accuracy1000: 0.3898 - val_loss: 3.5507 - val_accuracy1000: 0.3294 - 6s/epoch - 17ms/step
Epoch 4/50
323/323 - 5s - loss: 3.2442 - accuracy1000: 0.4021 - val_loss: 3.7391 - val_accuracy1000: 0.3258 - 5s/epoch - 17ms/step
Epoch 5/50
323/323 - 5s - loss: 3.2261 - accuracy1000: 0.4109 - val_loss: 3.6765 - val_accuracy1000: 0.3267 - 5s/epoch - 17ms/step
Epoch 6/50
323/323 - 5s - loss: 3.2133 - accuracy1000: 0.4168 - val_loss: 3.7101 - val_accuracy1000: 0.3244 - 5s/epoch - 17ms/step
Epoch 7/50
323/323 - 5s - loss: 3.1856 - accuracy1000: 0.4291 - val_loss: 3.6354 - val_accuracy1000: 0.3274 - 5s/epoch - 17ms/step
Epoch 8/50
323/323 - 5s - loss: 3.1777 - accuracy1000: 0.4374 - val_loss: 3.6582 - val_accuracy1000: 0.3271 - 5s/epoch - 17ms/step
Epoch 9/50
323/323 - 5s - loss: 3.1577 - accuracy1000: 0.4446 - val_loss: 3.6918 - val_accuracy1000: 0.3278 - 5s/epoch - 17ms/step
Epoch 10/50
323/323 - 5s - loss: 3.1409 - accuracy1000: 0.4523 - val_loss: 3.7058 - val_accuracy1000: 0.3278 - 5s/epoch - 17ms/step
Epoch 11/50
323/323 - 6s - loss: 3.1337 - accuracy1000: 0.4531 - val_loss: 3.6382 - val_accuracy1000: 0.3378 - 6s/epoch - 17ms/step
Epoch 12/50
323/323 - 5s - loss: 3.1244 - accuracy1000: 0.4585 - val_loss: 3.6988 - val_accuracy1000: 0.3248 - 5s/epoch - 16ms/step
Epoch 13/50
323/323 - 5s - loss: 3.1147 - accuracy1000: 0.4608 - val_loss: 3.6258 - val_accuracy1000: 0.3242 - 5s/epoch - 17ms/step
testing model: results/CHTR/W9/deepLOB_L1/h1000
Evaluating performance on  test set...
604/604 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.191719
{'0': {'precision': 0.29753906219375476, 'recall': 0.8237362446552211, 'f1-score': 0.4371695483395344, 'support': 46073}, '1': {'precision': 0.37112107623318386, 'recall': 0.13984690515216547, 'f1-score': 0.20314436848758574, 'support': 59179}, '2': {'precision': 0.3198069752138627, 'recall': 0.02965825874694874, 'f1-score': 0.05428246988961076, 'support': 49160}, 'accuracy': 0.3088231484599642, 'macro avg': {'precision': 0.3294890378802671, 'recall': 0.33108046951811176, 'f1-score': 0.23153212890557695, 'support': 154412}, 'weighted avg': {'precision': 0.3328290695306708, 'recall': 0.3088231484599642, 'f1-score': 0.225579096204618, 'support': 154412}}
[[37952  6750  1371]
 [49173  8276  1730]
 [40428  7274  1458]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1468382
{'0': {'precision': 0.37301187147637166, 'recall': 0.29001104736110617, 'f1-score': 0.3263162115561971, 'support': 28061}, '1': {'precision': 0.3507284192215699, 'recall': 0.4136958194408823, 'f1-score': 0.3796187338197223, 'support': 27293}, '2': {'precision': 0.36478602620087336, 'recall': 0.3827572303068069, 'f1-score': 0.3735556112045219, 'support': 27281}, 'accuracy': 0.36148121256126337, 'macro avg': {'precision': 0.3628421056329383, 'recall': 0.3621546990362651, 'f1-score': 0.3598301855268138, 'support': 82635}, 'weighted avg': {'precision': 0.3629363399540001, 'recall': 0.36148121256126337, 'f1-score': 0.3595167174186566, 'support': 82635}}
[[ 8138 10428  9495]
 [ 7314 11291  8688]
 [ 6365 10474 10442]]
Evaluating performance on  val set...
112/112 - 1s - 750ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1821378
{'0': {'precision': 0.33738090790211095, 'recall': 0.5630260833419931, 'f1-score': 0.42192975624951323, 'support': 9623}, '1': {'precision': 0.32547892720306515, 'recall': 0.17872922364822216, 'f1-score': 0.23074833627597444, 'support': 9506}, '2': {'precision': 0.31675282939779237, 'recall': 0.24358010099924787, 'f1-score': 0.27538872691933913, 'support': 9307}, 'accuracy': 0.3300042200028133, 'macro avg': {'precision': 0.32653755483432284, 'recall': 0.3284451359964877, 'f1-score': 0.3093556064816089, 'support': 28436}, 'weighted avg': {'precision': 0.3266506450253061, 'recall': 0.3300042200028133, 'f1-score': 0.3100564991724142, 'support': 28436}}
[[5418 1479 2726]
 [5643 1699 2164]
 [4998 2042 2267]]
training model: results/CHTR/W9/deepOF_L1/h10
Epoch 1/50
323/323 - 7s - loss: 3.3020 - accuracy10: 0.3742 - val_loss: 3.2947 - val_accuracy10: 0.3681 - 7s/epoch - 22ms/step
Epoch 2/50
323/323 - 5s - loss: 3.2558 - accuracy10: 0.3999 - val_loss: 3.2830 - val_accuracy10: 0.3849 - 5s/epoch - 15ms/step
Epoch 3/50
323/323 - 5s - loss: 3.2352 - accuracy10: 0.4131 - val_loss: 3.2780 - val_accuracy10: 0.3865 - 5s/epoch - 16ms/step
Epoch 4/50
323/323 - 5s - loss: 3.2206 - accuracy10: 0.4187 - val_loss: 3.2587 - val_accuracy10: 0.3962 - 5s/epoch - 16ms/step
Epoch 5/50
323/323 - 5s - loss: 3.2052 - accuracy10: 0.4247 - val_loss: 3.2588 - val_accuracy10: 0.3986 - 5s/epoch - 16ms/step
Epoch 6/50
323/323 - 5s - loss: 3.1980 - accuracy10: 0.4289 - val_loss: 3.2421 - val_accuracy10: 0.4024 - 5s/epoch - 16ms/step
Epoch 7/50
323/323 - 5s - loss: 3.1894 - accuracy10: 0.4312 - val_loss: 3.2367 - val_accuracy10: 0.4078 - 5s/epoch - 15ms/step
Epoch 8/50
323/323 - 5s - loss: 3.1845 - accuracy10: 0.4333 - val_loss: 3.2352 - val_accuracy10: 0.4091 - 5s/epoch - 15ms/step
Epoch 9/50
323/323 - 5s - loss: 3.1778 - accuracy10: 0.4352 - val_loss: 3.2338 - val_accuracy10: 0.4065 - 5s/epoch - 16ms/step
Epoch 10/50
323/323 - 5s - loss: 3.1698 - accuracy10: 0.4381 - val_loss: 3.2314 - val_accuracy10: 0.4064 - 5s/epoch - 16ms/step
Epoch 11/50
323/323 - 5s - loss: 3.1666 - accuracy10: 0.4395 - val_loss: 3.2240 - val_accuracy10: 0.4065 - 5s/epoch - 15ms/step
Epoch 12/50
323/323 - 5s - loss: 3.1617 - accuracy10: 0.4415 - val_loss: 3.2291 - val_accuracy10: 0.4044 - 5s/epoch - 15ms/step
Epoch 13/50
323/323 - 5s - loss: 3.1590 - accuracy10: 0.4433 - val_loss: 3.2219 - val_accuracy10: 0.4044 - 5s/epoch - 15ms/step
Epoch 14/50
323/323 - 5s - loss: 3.1555 - accuracy10: 0.4454 - val_loss: 3.2271 - val_accuracy10: 0.4020 - 5s/epoch - 15ms/step
Epoch 15/50
323/323 - 5s - loss: 3.1496 - accuracy10: 0.4455 - val_loss: 3.2234 - val_accuracy10: 0.4051 - 5s/epoch - 15ms/step
Epoch 16/50
323/323 - 5s - loss: 3.1457 - accuracy10: 0.4467 - val_loss: 3.2266 - val_accuracy10: 0.4029 - 5s/epoch - 15ms/step
Epoch 17/50
323/323 - 5s - loss: 3.1418 - accuracy10: 0.4481 - val_loss: 3.2255 - val_accuracy10: 0.4021 - 5s/epoch - 15ms/step
Epoch 18/50
323/323 - 5s - loss: 3.1404 - accuracy10: 0.4489 - val_loss: 3.2280 - val_accuracy10: 0.4010 - 5s/epoch - 15ms/step
Epoch 19/50
323/323 - 5s - loss: 3.1365 - accuracy10: 0.4506 - val_loss: 3.2245 - val_accuracy10: 0.4033 - 5s/epoch - 15ms/step
Epoch 20/50
323/323 - 5s - loss: 3.1346 - accuracy10: 0.4515 - val_loss: 3.2263 - val_accuracy10: 0.4032 - 5s/epoch - 15ms/step
Epoch 21/50
323/323 - 5s - loss: 3.1295 - accuracy10: 0.4546 - val_loss: 3.2201 - val_accuracy10: 0.4070 - 5s/epoch - 15ms/step
Epoch 22/50
323/323 - 5s - loss: 3.1280 - accuracy10: 0.4546 - val_loss: 3.2234 - val_accuracy10: 0.4052 - 5s/epoch - 15ms/step
Epoch 23/50
323/323 - 5s - loss: 3.1236 - accuracy10: 0.4546 - val_loss: 3.2280 - val_accuracy10: 0.4011 - 5s/epoch - 15ms/step
Epoch 24/50
323/323 - 5s - loss: 3.1182 - accuracy10: 0.4583 - val_loss: 3.2272 - val_accuracy10: 0.4066 - 5s/epoch - 15ms/step
Epoch 25/50
323/323 - 5s - loss: 3.1157 - accuracy10: 0.4594 - val_loss: 3.2233 - val_accuracy10: 0.4078 - 5s/epoch - 15ms/step
Epoch 26/50
323/323 - 5s - loss: 3.1108 - accuracy10: 0.4602 - val_loss: 3.2293 - val_accuracy10: 0.4058 - 5s/epoch - 15ms/step
Epoch 27/50
323/323 - 5s - loss: 3.1156 - accuracy10: 0.4611 - val_loss: 3.2237 - val_accuracy10: 0.4058 - 5s/epoch - 15ms/step
Epoch 28/50
323/323 - 5s - loss: 3.1077 - accuracy10: 0.4622 - val_loss: 3.2339 - val_accuracy10: 0.4063 - 5s/epoch - 15ms/step
Epoch 29/50
323/323 - 5s - loss: 3.1054 - accuracy10: 0.4645 - val_loss: 3.2296 - val_accuracy10: 0.4052 - 5s/epoch - 15ms/step
Epoch 30/50
323/323 - 5s - loss: 3.1006 - accuracy10: 0.4638 - val_loss: 3.2370 - val_accuracy10: 0.4057 - 5s/epoch - 15ms/step
Epoch 31/50
323/323 - 5s - loss: 3.0949 - accuracy10: 0.4661 - val_loss: 3.2323 - val_accuracy10: 0.4040 - 5s/epoch - 15ms/step
testing model: results/CHTR/W9/deepOF_L1/h10
Evaluating performance on  test set...
604/604 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0733025
{'0': {'precision': 0.437606088813448, 'recall': 0.3051895978920839, 'f1-score': 0.3595950506186727, 'support': 52374}, '1': {'precision': 0.42802639178144525, 'recall': 0.45476858997006264, 'f1-score': 0.4409924448691826, 'support': 53779}, '2': {'precision': 0.39742851028102005, 'recall': 0.5002797637550513, 'f1-score': 0.442962256188187, 'support': 48255}, 'accuracy': 0.4182555308015129, 'macro avg': {'precision': 0.42102033029197106, 'recall': 0.42007931720573266, 'f1-score': 0.4145165838920141, 'support': 154408}, 'weighted avg': {'precision': 0.42171341758678627, 'recall': 0.4182555308015129, 'f1-score': 0.4139986758852074, 'support': 154408}}
[[15984 18611 17779]
 [10499 24457 18823]
 [10043 14071 24141]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0537381
{'0': {'precision': 0.48475884889200843, 'recall': 0.328788084874864, 'f1-score': 0.3918223446934393, 'support': 29408}, '1': {'precision': 0.40271708433663306, 'recall': 0.5207780725022104, 'f1-score': 0.45420103265607187, 'support': 26013}, '2': {'precision': 0.4508433734939759, 'recall': 0.4812596457705593, 'f1-score': 0.4655552395848145, 'support': 27214}, 'accuracy': 0.4394384945846191, 'macro avg': {'precision': 0.44610643557420576, 'recall': 0.44360860104921124, 'f1-score': 0.43719287231144194, 'support': 82635}, 'weighted avg': {'precision': 0.4477632880659536, 'recall': 0.4394384945846191, 'f1-score': 0.43574106934456586, 'support': 82635}}
[[ 9669 11310  8429]
 [ 4942 13547  7524]
 [ 5335  8782 13097]]
Evaluating performance on  val set...
112/112 - 1s - 737ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0791714
{'0': {'precision': 0.48505125284738043, 'recall': 0.31380676061527124, 'f1-score': 0.381074883955036, 'support': 10857}, '1': {'precision': 0.30844068101972794, 'recall': 0.45622918054630246, 'f1-score': 0.36805331613458026, 'support': 7505}, '2': {'precision': 0.45819592628516004, 'recall': 0.4689764717561799, 'f1-score': 0.46352352450571555, 'support': 10073}, 'accuracy': 0.4063653947599789, 'macro avg': {'precision': 0.4172292867174228, 'recall': 0.4130041376392512, 'f1-score': 0.4042172415317773, 'support': 28435}, 'weighted avg': {'precision': 0.4289240840051868, 'recall': 0.4063653947599789, 'f1-score': 0.40684517724761465, 'support': 28435}}
[[3407 4329 3121]
 [1616 3424 2465]
 [2001 3348 4724]]
training model: results/CHTR/W9/deepOF_L1/h20
Epoch 1/50
323/323 - 7s - loss: 3.3016 - accuracy20: 0.3703 - val_loss: 3.3290 - val_accuracy20: 0.3640 - 7s/epoch - 23ms/step
Epoch 2/50
323/323 - 5s - loss: 3.2643 - accuracy20: 0.3920 - val_loss: 3.3075 - val_accuracy20: 0.3775 - 5s/epoch - 16ms/step
Epoch 3/50
323/323 - 5s - loss: 3.2437 - accuracy20: 0.4017 - val_loss: 3.3036 - val_accuracy20: 0.3766 - 5s/epoch - 15ms/step
Epoch 4/50
323/323 - 5s - loss: 3.2324 - accuracy20: 0.4093 - val_loss: 3.2992 - val_accuracy20: 0.3784 - 5s/epoch - 16ms/step
Epoch 5/50
323/323 - 5s - loss: 3.2202 - accuracy20: 0.4145 - val_loss: 3.2883 - val_accuracy20: 0.3854 - 5s/epoch - 15ms/step
Epoch 6/50
323/323 - 5s - loss: 3.2139 - accuracy20: 0.4186 - val_loss: 3.2826 - val_accuracy20: 0.3861 - 5s/epoch - 15ms/step
Epoch 7/50
323/323 - 5s - loss: 3.2036 - accuracy20: 0.4246 - val_loss: 3.2785 - val_accuracy20: 0.3908 - 5s/epoch - 16ms/step
Epoch 8/50
323/323 - 5s - loss: 3.1994 - accuracy20: 0.4265 - val_loss: 3.2828 - val_accuracy20: 0.3851 - 5s/epoch - 15ms/step
Epoch 9/50
323/323 - 5s - loss: 3.1940 - accuracy20: 0.4289 - val_loss: 3.2841 - val_accuracy20: 0.3858 - 5s/epoch - 15ms/step
Epoch 10/50
323/323 - 5s - loss: 3.1899 - accuracy20: 0.4311 - val_loss: 3.2746 - val_accuracy20: 0.3884 - 5s/epoch - 15ms/step
Epoch 11/50
323/323 - 5s - loss: 3.1857 - accuracy20: 0.4323 - val_loss: 3.2753 - val_accuracy20: 0.3914 - 5s/epoch - 15ms/step
Epoch 12/50
323/323 - 5s - loss: 3.1797 - accuracy20: 0.4352 - val_loss: 3.2777 - val_accuracy20: 0.3918 - 5s/epoch - 15ms/step
Epoch 13/50
323/323 - 5s - loss: 3.1770 - accuracy20: 0.4361 - val_loss: 3.2812 - val_accuracy20: 0.3906 - 5s/epoch - 15ms/step
Epoch 14/50
323/323 - 5s - loss: 3.1715 - accuracy20: 0.4377 - val_loss: 3.2750 - val_accuracy20: 0.3908 - 5s/epoch - 16ms/step
Epoch 15/50
323/323 - 5s - loss: 3.1704 - accuracy20: 0.4391 - val_loss: 3.2761 - val_accuracy20: 0.3915 - 5s/epoch - 16ms/step
Epoch 16/50
323/323 - 5s - loss: 3.1645 - accuracy20: 0.4421 - val_loss: 3.2792 - val_accuracy20: 0.3890 - 5s/epoch - 16ms/step
Epoch 17/50
323/323 - 5s - loss: 3.1629 - accuracy20: 0.4421 - val_loss: 3.2759 - val_accuracy20: 0.3896 - 5s/epoch - 15ms/step
Epoch 18/50
323/323 - 5s - loss: 3.1585 - accuracy20: 0.4440 - val_loss: 3.2805 - val_accuracy20: 0.3911 - 5s/epoch - 15ms/step
Epoch 19/50
323/323 - 5s - loss: 3.1539 - accuracy20: 0.4460 - val_loss: 3.2874 - val_accuracy20: 0.3886 - 5s/epoch - 15ms/step
Epoch 20/50
323/323 - 5s - loss: 3.1537 - accuracy20: 0.4456 - val_loss: 3.2896 - val_accuracy20: 0.3845 - 5s/epoch - 15ms/step
testing model: results/CHTR/W9/deepOF_L1/h20
Evaluating performance on  test set...
604/604 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0803032
{'0': {'precision': 0.4156065939427735, 'recall': 0.24399476204116707, 'f1-score': 0.30747611742106823, 'support': 48874}, '1': {'precision': 0.4280228220320386, 'recall': 0.45830186462581607, 'f1-score': 0.4426451398513548, 'support': 59583}, '2': {'precision': 0.3706090411357139, 'recall': 0.49937977410720114, 'f1-score': 0.4254644565580153, 'support': 45951}, 'accuracy': 0.4026928656546293, 'macro avg': {'precision': 0.40474615237017536, 'recall': 0.4005588002580614, 'f1-score': 0.3918619046101461, 'support': 154408}, 'weighted avg': {'precision': 0.40700673881354116, 'recall': 0.4026928656546293, 'f1-score': 0.39474787817922596, 'support': 154408}}
[[11925 20673 16276]
 [ 9582 27307 22694]
 [ 7186 15818 22947]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0700269
{'0': {'precision': 0.4671698113207547, 'recall': 0.25906808035714285, 'f1-score': 0.3333034191869335, 'support': 28672}, '1': {'precision': 0.3956000317687237, 'recall': 0.5366107659711997, 'f1-score': 0.455440414507772, 'support': 27847}, '2': {'precision': 0.4269387473240798, 'recall': 0.47346454280900596, 'f1-score': 0.4489996005664693, 'support': 26116}, 'accuracy': 0.4203545713075573, 'macro avg': {'precision': 0.42990286347118606, 'recall': 0.4230477963791162, 'f1-score': 0.4125811447537249, 'support': 82635}, 'weighted avg': {'precision': 0.43033701506586797, 'recall': 0.4203545713075573, 'f1-score': 0.4110267855765668, 'support': 82635}}
[[ 7428 13012  8232]
 [ 4539 14943  8365]
 [ 3933  9818 12365]]
Evaluating performance on  val set...
112/112 - 1s - 727ms/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0932473
{'0': {'precision': 0.479697662155036, 'recall': 0.2580858710043503, 'f1-score': 0.3356084363278608, 'support': 10574}, '1': {'precision': 0.30610390683075905, 'recall': 0.45923172242874843, 'f1-score': 0.36734896168905184, 'support': 8070}, '2': {'precision': 0.4349092959864649, 'recall': 0.4725768562965989, 'f1-score': 0.4529613313754283, 'support': 9791}, 'accuracy': 0.3890276068225778, 'macro avg': {'precision': 0.40690362165742, 'recall': 0.39663148324323255, 'f1-score': 0.3853062431307803, 'support': 28435}, 'weighted avg': {'precision': 0.4150089159400406, 'recall': 0.3890276068225778, 'f1-score': 0.38502458667340483, 'support': 28435}}
[[2729 4745 3100]
 [1452 3706 2912]
 [1508 3656 4627]]
training model: results/CHTR/W9/deepOF_L1/h30
Epoch 1/50
323/323 - 7s - loss: 3.3055 - accuracy30: 0.3694 - val_loss: 3.3249 - val_accuracy30: 0.3601 - 7s/epoch - 22ms/step
Epoch 2/50
323/323 - 5s - loss: 3.2661 - accuracy30: 0.3899 - val_loss: 3.3040 - val_accuracy30: 0.3756 - 5s/epoch - 15ms/step
Epoch 3/50
323/323 - 5s - loss: 3.2484 - accuracy30: 0.4011 - val_loss: 3.2850 - val_accuracy30: 0.3832 - 5s/epoch - 16ms/step
Epoch 4/50
323/323 - 5s - loss: 3.2372 - accuracy30: 0.4077 - val_loss: 3.2879 - val_accuracy30: 0.3822 - 5s/epoch - 15ms/step
Epoch 5/50
323/323 - 5s - loss: 3.2273 - accuracy30: 0.4122 - val_loss: 3.2787 - val_accuracy30: 0.3874 - 5s/epoch - 15ms/step
Epoch 6/50
323/323 - 5s - loss: 3.2189 - accuracy30: 0.4177 - val_loss: 3.2793 - val_accuracy30: 0.3869 - 5s/epoch - 15ms/step
Epoch 7/50
323/323 - 5s - loss: 3.2110 - accuracy30: 0.4209 - val_loss: 3.2737 - val_accuracy30: 0.3943 - 5s/epoch - 16ms/step
Epoch 8/50
323/323 - 5s - loss: 3.2048 - accuracy30: 0.4262 - val_loss: 3.2726 - val_accuracy30: 0.3905 - 5s/epoch - 15ms/step
Epoch 9/50
323/323 - 5s - loss: 3.2008 - accuracy30: 0.4272 - val_loss: 3.2730 - val_accuracy30: 0.3903 - 5s/epoch - 15ms/step
Epoch 10/50
323/323 - 5s - loss: 3.1961 - accuracy30: 0.4292 - val_loss: 3.2767 - val_accuracy30: 0.3917 - 5s/epoch - 15ms/step
Epoch 11/50
323/323 - 5s - loss: 3.1906 - accuracy30: 0.4308 - val_loss: 3.2730 - val_accuracy30: 0.3938 - 5s/epoch - 15ms/step
Epoch 12/50
323/323 - 5s - loss: 3.1870 - accuracy30: 0.4356 - val_loss: 3.2710 - val_accuracy30: 0.3928 - 5s/epoch - 15ms/step
Epoch 13/50
323/323 - 5s - loss: 3.1840 - accuracy30: 0.4348 - val_loss: 3.2792 - val_accuracy30: 0.3894 - 5s/epoch - 15ms/step
Epoch 14/50
323/323 - 5s - loss: 3.1797 - accuracy30: 0.4375 - val_loss: 3.2759 - val_accuracy30: 0.3902 - 5s/epoch - 15ms/step
Epoch 15/50
323/323 - 5s - loss: 3.1763 - accuracy30: 0.4394 - val_loss: 3.2750 - val_accuracy30: 0.3928 - 5s/epoch - 15ms/step
Epoch 16/50
323/323 - 5s - loss: 3.1734 - accuracy30: 0.4378 - val_loss: 3.2743 - val_accuracy30: 0.3936 - 5s/epoch - 15ms/step
Epoch 17/50
323/323 - 5s - loss: 3.1684 - accuracy30: 0.4401 - val_loss: 3.2773 - val_accuracy30: 0.3957 - 5s/epoch - 15ms/step
Epoch 18/50
323/323 - 5s - loss: 3.1677 - accuracy30: 0.4414 - val_loss: 3.2835 - val_accuracy30: 0.3929 - 5s/epoch - 15ms/step
Epoch 19/50
323/323 - 5s - loss: 3.1621 - accuracy30: 0.4440 - val_loss: 3.2821 - val_accuracy30: 0.3942 - 5s/epoch - 15ms/step
Epoch 20/50
323/323 - 5s - loss: 3.1597 - accuracy30: 0.4454 - val_loss: 3.2805 - val_accuracy30: 0.3946 - 5s/epoch - 15ms/step
Epoch 21/50
323/323 - 5s - loss: 3.1561 - accuracy30: 0.4473 - val_loss: 3.2803 - val_accuracy30: 0.3951 - 5s/epoch - 15ms/step
Epoch 22/50
323/323 - 5s - loss: 3.1515 - accuracy30: 0.4490 - val_loss: 3.2809 - val_accuracy30: 0.3982 - 5s/epoch - 15ms/step
testing model: results/CHTR/W9/deepOF_L1/h30
Evaluating performance on  test set...
604/604 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0849082
{'0': {'precision': 0.4285664603185644, 'recall': 0.25105429357237447, 'f1-score': 0.3166279114582664, 'support': 49085}, '1': {'precision': 0.41373102776263854, 'recall': 0.42054458769809294, 'f1-score': 0.41710998443184566, 'support': 59568}, '2': {'precision': 0.3611089778050841, 'recall': 0.5138236258332423, 'f1-score': 0.424138553130074, 'support': 45755}, 'accuracy': 0.3943059945080566, 'macro avg': {'precision': 0.40113548862876236, 'recall': 0.39514083570123654, 'f1-score': 0.385958816340062, 'support': 154408}, 'weighted avg': {'precision': 0.4028538407723254, 'recall': 0.3943059945080566, 'f1-score': 0.38725032436811385, 'support': 154408}}
[[12323 20002 16760]
 [ 9682 25051 24835]
 [ 6749 15496 23510]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0716062
{'0': {'precision': 0.4761815453863466, 'recall': 0.2618965754366662, 'f1-score': 0.33793256433007984, 'support': 29084}, '1': {'precision': 0.3896467096626905, 'recall': 0.4972142310913659, 'f1-score': 0.4369070284626338, 'support': 27461}, '2': {'precision': 0.42086274013355696, 'recall': 0.5096972019931008, 'f1-score': 0.4610397489902404, 'support': 26090}, 'accuracy': 0.4183336358685787, 'macro avg': {'precision': 0.428896998394198, 'recall': 0.42293600284037763, 'f1-score': 0.41195978059431804, 'support': 82635}, 'weighted avg': {'precision': 0.42995899134928484, 'recall': 0.4183336358685787, 'f1-score': 0.4096915551611763, 'support': 82635}}
[[ 7617 12419  9048]
 [ 4556 13654  9251]
 [ 3823  8969 13298]]
Evaluating performance on  val set...
112/112 - 1s - 838ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0931121
{'0': {'precision': 0.48141775636613904, 'recall': 0.2650876361913785, 'f1-score': 0.34190749679232596, 'support': 10555}, '1': {'precision': 0.29957318157567137, 'recall': 0.4221275529382283, 'f1-score': 0.35044468715868304, 'support': 7981}, '2': {'precision': 0.43640678562011076, 'recall': 0.5015658147287605, 'f1-score': 0.46672306824591087, 'support': 9899}, 'accuracy': 0.39148936170212767, 'macro avg': {'precision': 0.40579924118730704, 'recall': 0.39626033461945576, 'f1-score': 0.3863584173989733, 'support': 28435}, 'weighted avg': {'precision': 0.4147089414965186, 'recall': 0.39148936170212767, 'f1-score': 0.38775538348594063, 'support': 28435}}
[[2798 4473 3284]
 [1484 3369 3128]
 [1530 3404 4965]]
training model: results/CHTR/W9/deepOF_L1/h50
Epoch 1/50
323/323 - 7s - loss: 3.3115 - accuracy50: 0.3667 - val_loss: 3.3173 - val_accuracy50: 0.3632 - 7s/epoch - 22ms/step
Epoch 2/50
323/323 - 5s - loss: 3.2756 - accuracy50: 0.3857 - val_loss: 3.3041 - val_accuracy50: 0.3642 - 5s/epoch - 16ms/step
Epoch 3/50
323/323 - 5s - loss: 3.2579 - accuracy50: 0.3969 - val_loss: 3.2918 - val_accuracy50: 0.3748 - 5s/epoch - 16ms/step
Epoch 4/50
323/323 - 5s - loss: 3.2473 - accuracy50: 0.4040 - val_loss: 3.2822 - val_accuracy50: 0.3759 - 5s/epoch - 16ms/step
Epoch 5/50
323/323 - 5s - loss: 3.2364 - accuracy50: 0.4098 - val_loss: 3.2777 - val_accuracy50: 0.3778 - 5s/epoch - 15ms/step
Epoch 6/50
323/323 - 5s - loss: 3.2303 - accuracy50: 0.4140 - val_loss: 3.2776 - val_accuracy50: 0.3847 - 5s/epoch - 15ms/step
Epoch 7/50
323/323 - 5s - loss: 3.2255 - accuracy50: 0.4159 - val_loss: 3.2727 - val_accuracy50: 0.3857 - 5s/epoch - 15ms/step
Epoch 8/50
323/323 - 5s - loss: 3.2205 - accuracy50: 0.4165 - val_loss: 3.2702 - val_accuracy50: 0.3864 - 5s/epoch - 16ms/step
Epoch 9/50
323/323 - 5s - loss: 3.2155 - accuracy50: 0.4191 - val_loss: 3.2676 - val_accuracy50: 0.3879 - 5s/epoch - 15ms/step
Epoch 10/50
323/323 - 5s - loss: 3.2111 - accuracy50: 0.4227 - val_loss: 3.2679 - val_accuracy50: 0.3858 - 5s/epoch - 15ms/step
Epoch 11/50
323/323 - 5s - loss: 3.2069 - accuracy50: 0.4246 - val_loss: 3.2729 - val_accuracy50: 0.3896 - 5s/epoch - 16ms/step
Epoch 12/50
323/323 - 5s - loss: 3.2040 - accuracy50: 0.4268 - val_loss: 3.2728 - val_accuracy50: 0.3846 - 5s/epoch - 16ms/step
Epoch 13/50
323/323 - 5s - loss: 3.1999 - accuracy50: 0.4293 - val_loss: 3.2742 - val_accuracy50: 0.3842 - 5s/epoch - 15ms/step
Epoch 14/50
323/323 - 5s - loss: 3.1980 - accuracy50: 0.4290 - val_loss: 3.2752 - val_accuracy50: 0.3867 - 5s/epoch - 16ms/step
Epoch 15/50
323/323 - 5s - loss: 3.1940 - accuracy50: 0.4317 - val_loss: 3.2775 - val_accuracy50: 0.3836 - 5s/epoch - 15ms/step
Epoch 16/50
323/323 - 5s - loss: 3.1905 - accuracy50: 0.4331 - val_loss: 3.2756 - val_accuracy50: 0.3844 - 5s/epoch - 15ms/step
Epoch 17/50
323/323 - 5s - loss: 3.1873 - accuracy50: 0.4333 - val_loss: 3.2775 - val_accuracy50: 0.3846 - 5s/epoch - 15ms/step
Epoch 18/50
323/323 - 5s - loss: 3.1856 - accuracy50: 0.4331 - val_loss: 3.2791 - val_accuracy50: 0.3858 - 5s/epoch - 15ms/step
Epoch 19/50
323/323 - 5s - loss: 3.1794 - accuracy50: 0.4366 - val_loss: 3.2860 - val_accuracy50: 0.3848 - 5s/epoch - 15ms/step
testing model: results/CHTR/W9/deepOF_L1/h50
Evaluating performance on  test set...
604/604 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0844145
{'0': {'precision': 0.4222838582533484, 'recall': 0.23743664457349228, 'f1-score': 0.303964063361967, 'support': 48733}, '1': {'precision': 0.4082515953675254, 'recall': 0.4604631789403532, 'f1-score': 0.43278837420526794, 'support': 60020}, '2': {'precision': 0.35922510158318016, 'recall': 0.4666739678019932, 'f1-score': 0.4059600251510013, 'support': 45655}, 'accuracy': 0.3919097456090358, 'macro avg': {'precision': 0.39658685173468466, 'recall': 0.38819126377194624, 'f1-score': 0.3809041542394121, 'support': 154408}, 'weighted avg': {'precision': 0.39818430412283945, 'recall': 0.3919097456090358, 'f1-score': 0.38419734643210124, 'support': 154408}}
[[11571 22094 15068]
 [ 9446 27637 22937]
 [ 6384 17965 21306]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0790225
{'0': {'precision': 0.4724906330112404, 'recall': 0.24454802163780492, 'f1-score': 0.3222884813702193, 'support': 29393}, '1': {'precision': 0.36444005304350086, 'recall': 0.5161100268807306, 'f1-score': 0.4272128749085589, 'support': 27157}, '2': {'precision': 0.41656596347063496, 'recall': 0.4625263561433774, 'f1-score': 0.4383447173375963, 'support': 26085}, 'accuracy': 0.40260180311006233, 'macro avg': {'precision': 0.4178322165084587, 'recall': 0.4077281348873043, 'f1-score': 0.39594869120545817, 'support': 82635}, 'weighted avg': {'precision': 0.41932763179927696, 'recall': 0.40260180311006233, 'f1-score': 0.39340554642170733, 'support': 82635}}
[[ 7188 13928  8277]
 [ 4520 14016  8621]
 [ 3505 10515 12065]]
Evaluating performance on  val set...
112/112 - 1s - 722ms/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0918596
{'0': {'precision': 0.48761802957420275, 'recall': 0.26241610738255033, 'f1-score': 0.34120800349061897, 'support': 10430}, '1': {'precision': 0.2975677214675018, 'recall': 0.45305920237800346, 'f1-score': 0.35920852359208527, 'support': 8074}, '2': {'precision': 0.437743375439263, 'recall': 0.4641023059107844, 'f1-score': 0.4505376344086022, 'support': 9931}, 'accuracy': 0.3869878670652365, 'macro avg': {'precision': 0.40764304216032254, 'recall': 0.39319253855711267, 'f1-score': 0.38365138716376884, 'support': 28435}, 'weighted avg': {'precision': 0.4162351782336861, 'recall': 0.3869878670652365, 'f1-score': 0.3845028430877961, 'support': 28435}}
[[2737 4742 2951]
 [1447 3658 2969]
 [1429 3893 4609]]
training model: results/CHTR/W9/deepOF_L1/h100
Epoch 1/50
323/323 - 7s - loss: 3.3231 - accuracy100: 0.3576 - val_loss: 3.3139 - val_accuracy100: 0.3601 - 7s/epoch - 21ms/step
Epoch 2/50
323/323 - 5s - loss: 3.2867 - accuracy100: 0.3787 - val_loss: 3.3024 - val_accuracy100: 0.3688 - 5s/epoch - 15ms/step
Epoch 3/50
323/323 - 5s - loss: 3.2751 - accuracy100: 0.3865 - val_loss: 3.2933 - val_accuracy100: 0.3728 - 5s/epoch - 15ms/step
Epoch 4/50
323/323 - 5s - loss: 3.2643 - accuracy100: 0.3943 - val_loss: 3.2913 - val_accuracy100: 0.3778 - 5s/epoch - 15ms/step
Epoch 5/50
323/323 - 5s - loss: 3.2566 - accuracy100: 0.3971 - val_loss: 3.2834 - val_accuracy100: 0.3804 - 5s/epoch - 16ms/step
Epoch 6/50
323/323 - 5s - loss: 3.2484 - accuracy100: 0.4013 - val_loss: 3.2791 - val_accuracy100: 0.3846 - 5s/epoch - 16ms/step
Epoch 7/50
323/323 - 5s - loss: 3.2438 - accuracy100: 0.4057 - val_loss: 3.2767 - val_accuracy100: 0.3879 - 5s/epoch - 16ms/step
Epoch 8/50
323/323 - 5s - loss: 3.2381 - accuracy100: 0.4081 - val_loss: 3.2793 - val_accuracy100: 0.3865 - 5s/epoch - 15ms/step
Epoch 9/50
323/323 - 5s - loss: 3.2350 - accuracy100: 0.4093 - val_loss: 3.2768 - val_accuracy100: 0.3883 - 5s/epoch - 16ms/step
Epoch 10/50
323/323 - 5s - loss: 3.2306 - accuracy100: 0.4141 - val_loss: 3.2779 - val_accuracy100: 0.3871 - 5s/epoch - 15ms/step
Epoch 11/50
323/323 - 5s - loss: 3.2270 - accuracy100: 0.4158 - val_loss: 3.2783 - val_accuracy100: 0.3897 - 5s/epoch - 15ms/step
Epoch 12/50
323/323 - 5s - loss: 3.2217 - accuracy100: 0.4186 - val_loss: 3.2775 - val_accuracy100: 0.3904 - 5s/epoch - 15ms/step
Epoch 13/50
323/323 - 5s - loss: 3.2179 - accuracy100: 0.4184 - val_loss: 3.2779 - val_accuracy100: 0.3880 - 5s/epoch - 15ms/step
Epoch 14/50
323/323 - 5s - loss: 3.2156 - accuracy100: 0.4216 - val_loss: 3.2833 - val_accuracy100: 0.3849 - 5s/epoch - 15ms/step
Epoch 15/50
323/323 - 5s - loss: 3.2140 - accuracy100: 0.4215 - val_loss: 3.2832 - val_accuracy100: 0.3854 - 5s/epoch - 15ms/step
Epoch 16/50
323/323 - 5s - loss: 3.2099 - accuracy100: 0.4239 - val_loss: 3.2858 - val_accuracy100: 0.3872 - 5s/epoch - 15ms/step
Epoch 17/50
323/323 - 5s - loss: 3.2065 - accuracy100: 0.4241 - val_loss: 3.2828 - val_accuracy100: 0.3873 - 5s/epoch - 15ms/step
testing model: results/CHTR/W9/deepOF_L1/h100
Evaluating performance on  test set...
604/604 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0948277
{'0': {'precision': 0.40516975524965654, 'recall': 0.300344985244607, 'f1-score': 0.34496998341031426, 'support': 48118}, '1': {'precision': 0.3995194233079696, 'recall': 0.33069247853614875, 'f1-score': 0.3618622703447775, 'support': 60334}, '2': {'precision': 0.34185089899562493, 'recall': 0.5117721298633475, 'f1-score': 0.4098993507908152, 'support': 45956}, 'accuracy': 0.3751295269675146, 'macro avg': {'precision': 0.3821800258510837, 'recall': 0.3809365312147011, 'f1-score': 0.3722438681819689, 'support': 154408}, 'weighted avg': {'precision': 0.3841165165225179, 'recall': 0.3751295269675146, 'f1-score': 0.3708952803330269, 'support': 154408}}
[[14452 16109 17557]
 [12659 19952 27723]
 [ 8558 13879 23519]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0842818
{'0': {'precision': 0.45049977397157065, 'recall': 0.3064962580733349, 'f1-score': 0.3648011063206703, 'support': 29263}, '1': {'precision': 0.3702426869645356, 'recall': 0.3979674200176108, 'f1-score': 0.3836047601365091, 'support': 27256}, '2': {'precision': 0.3935804241825959, 'recall': 0.5037907795987134, 'f1-score': 0.4419178772357041, 'support': 26116}, 'accuracy': 0.39901978580504627, 'macro avg': {'precision': 0.4047742950395674, 'recall': 0.4027514858965531, 'f1-score': 0.39677458123096115, 'support': 82635}, 'weighted avg': {'precision': 0.40603928020316005, 'recall': 0.39901978580504627, 'f1-score': 0.3953752453370861, 'support': 82635}}
[[ 8969 10356  9938]
 [ 6075 10847 10334]
 [ 4865  8094 13157]]
Evaluating performance on  val set...
112/112 - 1s - 818ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0939052
{'0': {'precision': 0.44285331905781583, 'recall': 0.32352366053969495, 'f1-score': 0.37389830508474575, 'support': 10228}, '1': {'precision': 0.3045774647887324, 'recall': 0.33535255633632177, 'f1-score': 0.3192250028831738, 'support': 8254}, '2': {'precision': 0.41709473684210524, 'recall': 0.4976389028433638, 'f1-score': 0.45382078064870807, 'support': 9953}, 'accuracy': 0.38790223316335504, 'macro avg': {'precision': 0.38817517356288445, 'recall': 0.3855050399064602, 'f1-score': 0.38231469620554254, 'support': 28435}, 'weighted avg': {'precision': 0.3936989645675756, 'recall': 0.38790223316335504, 'f1-score': 0.3860029283629713, 'support': 28435}}
[[3309 3450 3469]
 [2033 2768 3453]
 [2130 2870 4953]]
training model: results/CHTR/W9/deepOF_L1/h200
Epoch 1/50
323/323 - 7s - loss: 3.3297 - accuracy200: 0.3514 - val_loss: 3.3187 - val_accuracy200: 0.3514 - 7s/epoch - 22ms/step
Epoch 2/50
323/323 - 5s - loss: 3.3015 - accuracy200: 0.3660 - val_loss: 3.3108 - val_accuracy200: 0.3579 - 5s/epoch - 15ms/step
Epoch 3/50
323/323 - 5s - loss: 3.2884 - accuracy200: 0.3724 - val_loss: 3.3043 - val_accuracy200: 0.3648 - 5s/epoch - 15ms/step
Epoch 4/50
323/323 - 5s - loss: 3.2777 - accuracy200: 0.3808 - val_loss: 3.2986 - val_accuracy200: 0.3634 - 5s/epoch - 16ms/step
Epoch 5/50
323/323 - 5s - loss: 3.2707 - accuracy200: 0.3837 - val_loss: 3.2905 - val_accuracy200: 0.3728 - 5s/epoch - 16ms/step
Epoch 6/50
323/323 - 5s - loss: 3.2666 - accuracy200: 0.3899 - val_loss: 3.2911 - val_accuracy200: 0.3700 - 5s/epoch - 15ms/step
Epoch 7/50
323/323 - 5s - loss: 3.2620 - accuracy200: 0.3927 - val_loss: 3.2907 - val_accuracy200: 0.3715 - 5s/epoch - 15ms/step
Epoch 8/50
323/323 - 5s - loss: 3.2586 - accuracy200: 0.3931 - val_loss: 3.2875 - val_accuracy200: 0.3718 - 5s/epoch - 15ms/step
Epoch 9/50
323/323 - 5s - loss: 3.2549 - accuracy200: 0.3950 - val_loss: 3.2876 - val_accuracy200: 0.3744 - 5s/epoch - 15ms/step
Epoch 10/50
323/323 - 5s - loss: 3.2514 - accuracy200: 0.3976 - val_loss: 3.2840 - val_accuracy200: 0.3771 - 5s/epoch - 15ms/step
Epoch 11/50
323/323 - 5s - loss: 3.2478 - accuracy200: 0.4010 - val_loss: 3.2889 - val_accuracy200: 0.3731 - 5s/epoch - 15ms/step
Epoch 12/50
323/323 - 5s - loss: 3.2444 - accuracy200: 0.4015 - val_loss: 3.2915 - val_accuracy200: 0.3733 - 5s/epoch - 16ms/step
Epoch 13/50
323/323 - 5s - loss: 3.2410 - accuracy200: 0.4032 - val_loss: 3.2887 - val_accuracy200: 0.3775 - 5s/epoch - 16ms/step
Epoch 14/50
323/323 - 5s - loss: 3.2393 - accuracy200: 0.4046 - val_loss: 3.2896 - val_accuracy200: 0.3745 - 5s/epoch - 15ms/step
Epoch 15/50
323/323 - 5s - loss: 3.2380 - accuracy200: 0.4052 - val_loss: 3.2958 - val_accuracy200: 0.3713 - 5s/epoch - 16ms/step
Epoch 16/50
323/323 - 5s - loss: 3.2332 - accuracy200: 0.4076 - val_loss: 3.2978 - val_accuracy200: 0.3710 - 5s/epoch - 16ms/step
Epoch 17/50
323/323 - 5s - loss: 3.2297 - accuracy200: 0.4084 - val_loss: 3.2974 - val_accuracy200: 0.3729 - 5s/epoch - 15ms/step
Epoch 18/50
323/323 - 5s - loss: 3.2267 - accuracy200: 0.4108 - val_loss: 3.2973 - val_accuracy200: 0.3732 - 5s/epoch - 15ms/step
Epoch 19/50
323/323 - 5s - loss: 3.2258 - accuracy200: 0.4127 - val_loss: 3.3002 - val_accuracy200: 0.3680 - 5s/epoch - 15ms/step
Epoch 20/50
323/323 - 5s - loss: 3.2227 - accuracy200: 0.4122 - val_loss: 3.2989 - val_accuracy200: 0.3729 - 5s/epoch - 15ms/step
testing model: results/CHTR/W9/deepOF_L1/h200
Evaluating performance on  test set...
604/604 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0995914
{'0': {'precision': 0.37875019431058604, 'recall': 0.3096327360528657, 'f1-score': 0.340721577401762, 'support': 47214}, '1': {'precision': 0.38861483591560714, 'recall': 0.2778283689587231, 'f1-score': 0.32401328493087195, 'support': 60397}, '2': {'precision': 0.3347881758477785, 'recall': 0.5196059576468577, 'f1-score': 0.4072076899889473, 'support': 46797}, 'accuracy': 0.36082974975389875, 'macro avg': {'precision': 0.3673844020246572, 'recall': 0.36902235421948215, 'f1-score': 0.3573141841071938, 'support': 154408}, 'weighted avg': {'precision': 0.3692850382371601, 'recall': 0.36082974975389875, 'f1-score': 0.3543362856447168, 'support': 154408}}
[[14619 13955 18640]
 [13942 16780 29675]
 [10037 12444 24316]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0865889
{'0': {'precision': 0.42770318021201414, 'recall': 0.3117338003502627, 'f1-score': 0.3606244786080324, 'support': 29121}, '1': {'precision': 0.3685804215307383, 'recall': 0.34212278106508875, 'f1-score': 0.3548591265655267, 'support': 27040}, '2': {'precision': 0.382501170444218, 'recall': 0.5246279368436957, 'f1-score': 0.442430516843195, 'support': 26474}, 'accuracy': 0.3898832213952926, 'macro avg': {'precision': 0.3929282573956568, 'recall': 0.3928281727530157, 'f1-score': 0.38597137400558473, 'support': 82635}, 'weighted avg': {'precision': 0.39387541472118903, 'recall': 0.3898832213952926, 'f1-score': 0.3849463511439838, 'support': 82635}}
[[ 9078  8877 11166]
 [ 6533  9251 11256]
 [ 5614  6971 13889]]
Evaluating performance on  val set...
112/112 - 1s - 733ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0964881
{'0': {'precision': 0.4038755736868944, 'recall': 0.31431689651751166, 'f1-score': 0.35351224683367743, 'support': 10079}, '1': {'precision': 0.3183720045644732, 'recall': 0.2967032967032967, 'f1-score': 0.3071559633027523, 'support': 8463}, '2': {'precision': 0.3962531486146096, 'recall': 0.5088446376225614, 'f1-score': 0.44554586892065323, 'support': 9893}, 'accuracy': 0.3767540003516793, 'macro avg': {'precision': 0.37283357562199243, 'recall': 0.37328827694778993, 'f1-score': 0.36873802635236097, 'support': 28435}, 'weighted avg': {'precision': 0.37577550838978996, 'recall': 0.3767540003516793, 'f1-score': 0.37173540124845617, 'support': 28435}}
[[3168 2925 3986]
 [2268 2511 3684]
 [2408 2451 5034]]
training model: results/CHTR/W9/deepOF_L1/h300
Epoch 1/50
323/323 - 7s - loss: 3.3316 - accuracy300: 0.3522 - val_loss: 3.3325 - val_accuracy300: 0.3431 - 7s/epoch - 22ms/step
Epoch 2/50
323/323 - 5s - loss: 3.3081 - accuracy300: 0.3615 - val_loss: 3.3211 - val_accuracy300: 0.3481 - 5s/epoch - 15ms/step
Epoch 3/50
323/323 - 5s - loss: 3.2962 - accuracy300: 0.3649 - val_loss: 3.3124 - val_accuracy300: 0.3517 - 5s/epoch - 15ms/step
Epoch 4/50
323/323 - 5s - loss: 3.2876 - accuracy300: 0.3733 - val_loss: 3.3079 - val_accuracy300: 0.3527 - 5s/epoch - 15ms/step
Epoch 5/50
323/323 - 5s - loss: 3.2827 - accuracy300: 0.3758 - val_loss: 3.3072 - val_accuracy300: 0.3563 - 5s/epoch - 15ms/step
Epoch 6/50
323/323 - 5s - loss: 3.2779 - accuracy300: 0.3777 - val_loss: 3.3045 - val_accuracy300: 0.3569 - 5s/epoch - 15ms/step
Epoch 7/50
323/323 - 5s - loss: 3.2720 - accuracy300: 0.3831 - val_loss: 3.3028 - val_accuracy300: 0.3617 - 5s/epoch - 15ms/step
Epoch 8/50
323/323 - 5s - loss: 3.2707 - accuracy300: 0.3832 - val_loss: 3.3023 - val_accuracy300: 0.3591 - 5s/epoch - 16ms/step
Epoch 9/50
323/323 - 5s - loss: 3.2665 - accuracy300: 0.3873 - val_loss: 3.3007 - val_accuracy300: 0.3627 - 5s/epoch - 15ms/step
Epoch 10/50
323/323 - 5s - loss: 3.2635 - accuracy300: 0.3882 - val_loss: 3.3017 - val_accuracy300: 0.3629 - 5s/epoch - 15ms/step
Epoch 11/50
323/323 - 5s - loss: 3.2625 - accuracy300: 0.3894 - val_loss: 3.3015 - val_accuracy300: 0.3619 - 5s/epoch - 15ms/step
Epoch 12/50
323/323 - 5s - loss: 3.2584 - accuracy300: 0.3916 - val_loss: 3.3042 - val_accuracy300: 0.3637 - 5s/epoch - 15ms/step
Epoch 13/50
323/323 - 5s - loss: 3.2563 - accuracy300: 0.3932 - val_loss: 3.3010 - val_accuracy300: 0.3650 - 5s/epoch - 15ms/step
Epoch 14/50
323/323 - 5s - loss: 3.2528 - accuracy300: 0.3962 - val_loss: 3.3049 - val_accuracy300: 0.3612 - 5s/epoch - 15ms/step
Epoch 15/50
323/323 - 5s - loss: 3.2522 - accuracy300: 0.3958 - val_loss: 3.3042 - val_accuracy300: 0.3665 - 5s/epoch - 15ms/step
Epoch 16/50
323/323 - 5s - loss: 3.2496 - accuracy300: 0.3979 - val_loss: 3.3045 - val_accuracy300: 0.3622 - 5s/epoch - 16ms/step
Epoch 17/50
323/323 - 5s - loss: 3.2456 - accuracy300: 0.3990 - val_loss: 3.3063 - val_accuracy300: 0.3630 - 5s/epoch - 16ms/step
Epoch 18/50
323/323 - 5s - loss: 3.2441 - accuracy300: 0.3995 - val_loss: 3.3084 - val_accuracy300: 0.3629 - 5s/epoch - 15ms/step
Epoch 19/50
323/323 - 5s - loss: 3.2423 - accuracy300: 0.4021 - val_loss: 3.3078 - val_accuracy300: 0.3640 - 5s/epoch - 16ms/step
testing model: results/CHTR/W9/deepOF_L1/h300
Evaluating performance on  test set...
604/604 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1022243
{'0': {'precision': 0.3513154750842913, 'recall': 0.28471534919746977, 'f1-score': 0.3145284924832135, 'support': 46478}, '1': {'precision': 0.3805940705670161, 'recall': 0.229275249138414, 'f1-score': 0.28616228929831433, 'support': 58903}, '2': {'precision': 0.33797703582460586, 'recall': 0.5601607277622535, 'f1-score': 0.42158668754413436, 'support': 49027}, 'accuracy': 0.3510245583130408, 'macro avg': {'precision': 0.3566288604919711, 'recall': 0.3580504420327124, 'f1-score': 0.3407591564418874, 'support': 154408}, 'weighted avg': {'precision': 0.3582493998040878, 'recall': 0.3510245583130408, 'f1-score': 0.337700139438369, 'support': 154408}}
[[13233 11269 21976]
 [13580 13505 31818]
 [10854 10710 27463]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0921056
{'0': {'precision': 0.4116217100649806, 'recall': 0.3059735205198596, 'f1-score': 0.351020570881837, 'support': 28777}, '1': {'precision': 0.36378051124351335, 'recall': 0.2790637670475488, 'f1-score': 0.3158399733010721, 'support': 27130}, '2': {'precision': 0.3682479224376731, 'recall': 0.5570562705776714, 'f1-score': 0.44338892197736746, 'support': 26728}, 'accuracy': 0.3783505778423186, 'macro avg': {'precision': 0.3812167145820557, 'recall': 0.3806978527150266, 'f1-score': 0.3700831553867589, 'support': 82635}, 'weighted avg': {'precision': 0.381885807363594, 'recall': 0.3783505778423186, 'f1-score': 0.36934660314074896, 'support': 82635}}
[[ 8805  7310 12662]
 [ 6678  7571 12881]
 [ 5908  5931 14889]]
Evaluating performance on  val set...
112/112 - 1s - 739ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1009353
{'0': {'precision': 0.38401486988847583, 'recall': 0.3125882590276377, 'f1-score': 0.3446396797153025, 'support': 9914}, '1': {'precision': 0.31879722921914355, 'recall': 0.23305328576360917, 'f1-score': 0.26926401170134967, 'support': 8689}, '2': {'precision': 0.3742952972240063, 'recall': 0.5334621643612694, 'f1-score': 0.4399245124764101, 'support': 9832}, 'accuracy': 0.3646562335150343, 'macro avg': {'precision': 0.3590357987772086, 'recall': 0.35970123638417206, 'f1-score': 0.3512760679643541, 'support': 28435}, 'weighted avg': {'precision': 0.3607253000550701, 'recall': 0.3646562335150343, 'f1-score': 0.35455356388389664, 'support': 28435}}
[[3099 2310 4505]
 [2401 2025 4263]
 [2570 2017 5245]]
training model: results/CHTR/W9/deepOF_L1/h500
Epoch 1/50
323/323 - 7s - loss: 3.3402 - accuracy500: 0.3452 - val_loss: 3.3319 - val_accuracy500: 0.3389 - 7s/epoch - 21ms/step
Epoch 2/50
323/323 - 5s - loss: 3.3200 - accuracy500: 0.3487 - val_loss: 3.3189 - val_accuracy500: 0.3446 - 5s/epoch - 15ms/step
Epoch 3/50
323/323 - 5s - loss: 3.3061 - accuracy500: 0.3579 - val_loss: 3.3147 - val_accuracy500: 0.3455 - 5s/epoch - 17ms/step
Epoch 4/50
323/323 - 5s - loss: 3.2978 - accuracy500: 0.3591 - val_loss: 3.3111 - val_accuracy500: 0.3457 - 5s/epoch - 16ms/step
Epoch 5/50
323/323 - 5s - loss: 3.2913 - accuracy500: 0.3644 - val_loss: 3.3065 - val_accuracy500: 0.3463 - 5s/epoch - 15ms/step
Epoch 6/50
323/323 - 5s - loss: 3.2883 - accuracy500: 0.3651 - val_loss: 3.3064 - val_accuracy500: 0.3465 - 5s/epoch - 15ms/step
Epoch 7/50
323/323 - 5s - loss: 3.2822 - accuracy500: 0.3703 - val_loss: 3.3100 - val_accuracy500: 0.3451 - 5s/epoch - 15ms/step
Epoch 8/50
323/323 - 5s - loss: 3.2806 - accuracy500: 0.3716 - val_loss: 3.3064 - val_accuracy500: 0.3525 - 5s/epoch - 16ms/step
Epoch 9/50
323/323 - 5s - loss: 3.2769 - accuracy500: 0.3753 - val_loss: 3.3053 - val_accuracy500: 0.3489 - 5s/epoch - 16ms/step
Epoch 10/50
323/323 - 5s - loss: 3.2749 - accuracy500: 0.3765 - val_loss: 3.3071 - val_accuracy500: 0.3501 - 5s/epoch - 15ms/step
Epoch 11/50
323/323 - 5s - loss: 3.2719 - accuracy500: 0.3783 - val_loss: 3.3079 - val_accuracy500: 0.3511 - 5s/epoch - 16ms/step
Epoch 12/50
323/323 - 5s - loss: 3.2690 - accuracy500: 0.3818 - val_loss: 3.3064 - val_accuracy500: 0.3545 - 5s/epoch - 16ms/step
Epoch 13/50
323/323 - 5s - loss: 3.2690 - accuracy500: 0.3819 - val_loss: 3.3099 - val_accuracy500: 0.3473 - 5s/epoch - 16ms/step
Epoch 14/50
323/323 - 5s - loss: 3.2668 - accuracy500: 0.3830 - val_loss: 3.3075 - val_accuracy500: 0.3528 - 5s/epoch - 16ms/step
Epoch 15/50
323/323 - 5s - loss: 3.2639 - accuracy500: 0.3844 - val_loss: 3.3101 - val_accuracy500: 0.3497 - 5s/epoch - 16ms/step
Epoch 16/50
323/323 - 5s - loss: 3.2612 - accuracy500: 0.3863 - val_loss: 3.3126 - val_accuracy500: 0.3477 - 5s/epoch - 15ms/step
Epoch 17/50
323/323 - 5s - loss: 3.2591 - accuracy500: 0.3886 - val_loss: 3.3123 - val_accuracy500: 0.3502 - 5s/epoch - 15ms/step
Epoch 18/50
323/323 - 5s - loss: 3.2593 - accuracy500: 0.3887 - val_loss: 3.3147 - val_accuracy500: 0.3499 - 5s/epoch - 16ms/step
Epoch 19/50
323/323 - 5s - loss: 3.2575 - accuracy500: 0.3898 - val_loss: 3.3126 - val_accuracy500: 0.3516 - 5s/epoch - 16ms/step
testing model: results/CHTR/W9/deepOF_L1/h500
Evaluating performance on  test set...
604/604 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0988795
{'0': {'precision': 0.3402057284738849, 'recall': 0.1672770874209723, 'f1-score': 0.22427803110019875, 'support': 45870}, '1': {'precision': 0.37861152516570995, 'recall': 0.4090387349882647, 'f1-score': 0.39323742310574555, 'support': 58371}, '2': {'precision': 0.3388330038376555, 'recall': 0.46462814200570096, 'f1-score': 0.39188291764389405, 'support': 50167}, 'accuracy': 0.35527951919589656, 'macro avg': {'precision': 0.35255008582575015, 'recall': 0.346981321471646, 'f1-score': 0.3364661239499462, 'support': 154408}, 'weighted avg': {'precision': 0.35427831073563815, 'recall': 0.35527951919589656, 'f1-score': 0.34260456219958046, 'support': 154408}}
[[ 7673 19428 18769]
 [ 7781 23876 26714]
 [ 7100 19758 23309]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0952514
{'0': {'precision': 0.4038649706457926, 'recall': 0.17465970801890118, 'f1-score': 0.24385800797597357, 'support': 28358}, '1': {'precision': 0.3474569123063514, 'recall': 0.4535711664097482, 'f1-score': 0.3934854249916418, 'support': 27246}, '2': {'precision': 0.36757269279393173, 'recall': 0.4732714290999223, 'f1-score': 0.413778604350287, 'support': 27031}, 'accuracy': 0.3643008410479821, 'macro avg': {'precision': 0.37296485858202527, 'recall': 0.3671674345095239, 'f1-score': 0.35037401243930083, 'support': 82635}, 'weighted avg': {'precision': 0.37339470356610405, 'recall': 0.3643008410479821, 'f1-score': 0.34877568504504797, 'support': 82635}}
[[ 4953 12386 11019]
 [ 3896 12358 10992]
 [ 3415 10823 12793]]
Evaluating performance on  val set...
112/112 - 1s - 736ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.103189
{'0': {'precision': 0.36, 'recall': 0.1872864685785278, 'f1-score': 0.24639062925633343, 'support': 9659}, '1': {'precision': 0.33773617914625614, 'recall': 0.4202220287331302, 'f1-score': 0.37449078564500493, 'support': 9188}, '2': {'precision': 0.36583736850893306, 'recall': 0.4570296203587818, 'f1-score': 0.4063804136140221, 'support': 9588}, 'accuracy': 0.3535080007033585, 'macro avg': {'precision': 0.3545245158850631, 'recall': 0.35484603922347996, 'f1-score': 0.34242060950512015, 'support': 28435}, 'weighted avg': {'precision': 0.35477435214557596, 'recall': 0.3535080007033585, 'f1-score': 0.341729693413908, 'support': 28435}}
[[1809 3987 3863]
 [1594 3861 3733]
 [1622 3584 4382]]
training model: results/CHTR/W9/deepOF_L1/h1000
Epoch 1/50
323/323 - 7s - loss: 3.3521 - accuracy1000: 0.3423 - val_loss: 3.3294 - val_accuracy1000: 0.3401 - 7s/epoch - 22ms/step
Epoch 2/50
323/323 - 5s - loss: 3.3277 - accuracy1000: 0.3480 - val_loss: 3.3222 - val_accuracy1000: 0.3382 - 5s/epoch - 16ms/step
Epoch 3/50
323/323 - 5s - loss: 3.3157 - accuracy1000: 0.3509 - val_loss: 3.3138 - val_accuracy1000: 0.3395 - 5s/epoch - 16ms/step
Epoch 4/50
323/323 - 5s - loss: 3.3078 - accuracy1000: 0.3523 - val_loss: 3.3126 - val_accuracy1000: 0.3360 - 5s/epoch - 16ms/step
Epoch 5/50
323/323 - 5s - loss: 3.3018 - accuracy1000: 0.3552 - val_loss: 3.3102 - val_accuracy1000: 0.3376 - 5s/epoch - 15ms/step
Epoch 6/50
323/323 - 5s - loss: 3.2984 - accuracy1000: 0.3571 - val_loss: 3.3070 - val_accuracy1000: 0.3396 - 5s/epoch - 16ms/step
Epoch 7/50
323/323 - 5s - loss: 3.2955 - accuracy1000: 0.3599 - val_loss: 3.3066 - val_accuracy1000: 0.3382 - 5s/epoch - 16ms/step
Epoch 8/50
323/323 - 5s - loss: 3.2929 - accuracy1000: 0.3591 - val_loss: 3.3074 - val_accuracy1000: 0.3372 - 5s/epoch - 16ms/step
Epoch 9/50
323/323 - 5s - loss: 3.2906 - accuracy1000: 0.3618 - val_loss: 3.3078 - val_accuracy1000: 0.3361 - 5s/epoch - 16ms/step
Epoch 10/50
323/323 - 5s - loss: 3.2896 - accuracy1000: 0.3615 - val_loss: 3.3086 - val_accuracy1000: 0.3335 - 5s/epoch - 16ms/step
Epoch 11/50
323/323 - 5s - loss: 3.2868 - accuracy1000: 0.3643 - val_loss: 3.3066 - val_accuracy1000: 0.3375 - 5s/epoch - 16ms/step
Epoch 12/50
323/323 - 5s - loss: 3.2842 - accuracy1000: 0.3659 - val_loss: 3.3078 - val_accuracy1000: 0.3374 - 5s/epoch - 16ms/step
Epoch 13/50
323/323 - 5s - loss: 3.2831 - accuracy1000: 0.3655 - val_loss: 3.3085 - val_accuracy1000: 0.3390 - 5s/epoch - 16ms/step
Epoch 14/50
323/323 - 5s - loss: 3.2816 - accuracy1000: 0.3665 - val_loss: 3.3070 - val_accuracy1000: 0.3398 - 5s/epoch - 16ms/step
Epoch 15/50
323/323 - 5s - loss: 3.2789 - accuracy1000: 0.3698 - val_loss: 3.3083 - val_accuracy1000: 0.3366 - 5s/epoch - 16ms/step
Epoch 16/50
323/323 - 5s - loss: 3.2786 - accuracy1000: 0.3684 - val_loss: 3.3086 - val_accuracy1000: 0.3373 - 5s/epoch - 16ms/step
Epoch 17/50
323/323 - 5s - loss: 3.2769 - accuracy1000: 0.3707 - val_loss: 3.3096 - val_accuracy1000: 0.3387 - 5s/epoch - 16ms/step
Epoch 18/50
323/323 - 5s - loss: 3.2747 - accuracy1000: 0.3715 - val_loss: 3.3114 - val_accuracy1000: 0.3337 - 5s/epoch - 16ms/step
Epoch 19/50
323/323 - 5s - loss: 3.2724 - accuracy1000: 0.3738 - val_loss: 3.3117 - val_accuracy1000: 0.3384 - 5s/epoch - 16ms/step
Epoch 20/50
323/323 - 5s - loss: 3.2715 - accuracy1000: 0.3773 - val_loss: 3.3113 - val_accuracy1000: 0.3396 - 5s/epoch - 15ms/step
Epoch 21/50
323/323 - 5s - loss: 3.2694 - accuracy1000: 0.3765 - val_loss: 3.3142 - val_accuracy1000: 0.3374 - 5s/epoch - 16ms/step
testing model: results/CHTR/W9/deepOF_L1/h1000
Evaluating performance on  test set...
604/604 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100353
{'0': {'precision': 0.3027804207632942, 'recall': 0.12432983872718195, 'f1-score': 0.17627598516672052, 'support': 46071}, '1': {'precision': 0.3787430562403445, 'recall': 0.38941836493291426, 'f1-score': 0.3840065320269279, 'support': 59178}, '2': {'precision': 0.3177080542307486, 'recall': 0.48241420696108545, 'f1-score': 0.3831086484172435, 'support': 49159}, 'accuracy': 0.3399305735454122, 'macro avg': {'precision': 0.3330771770781291, 'recall': 0.33205413687372726, 'f1-score': 0.3144637218702973, 'support': 154408}, 'weighted avg': {'precision': 0.33664618144854025, 'recall': 0.3399305735454122, 'f1-score': 0.32173972535392464, 'support': 154408}}
[[ 5728 18395 21948]
 [ 7152 23045 28981]
 [ 6038 19406 23715]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0966461
{'0': {'precision': 0.402311206664875, 'recall': 0.1600270809578107, 'f1-score': 0.22897494072959954, 'support': 28064}, '1': {'precision': 0.34571455102609344, 'recall': 0.4087914501134617, 'f1-score': 0.37461637793690994, 'support': 27322}, '2': {'precision': 0.3505425762798417, 'recall': 0.5038350031193806, 'f1-score': 0.413436925949348, 'support': 27249}, 'accuracy': 0.35564833303079807, 'macro avg': {'precision': 0.3661894446569367, 'recall': 0.35755117806355097, 'f1-score': 0.3390094148719525, 'support': 82635}, 'weighted avg': {'precision': 0.36652761333608497, 'recall': 0.35564833303079807, 'f1-score': 0.3379556387707572, 'support': 82635}}
[[ 4491 10799 12774]
 [ 3491 11169 12662]
 [ 3181 10339 13729]]
Evaluating performance on  val set...
112/112 - 1s - 729ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030072
{'0': {'precision': 0.35426305353602117, 'recall': 0.1675872850442939, 'f1-score': 0.22753643696052075, 'support': 9595}, '1': {'precision': 0.3301749271137026, 'recall': 0.3811527135044173, 'f1-score': 0.3538371411833626, 'support': 9508}, '2': {'precision': 0.33227554179566565, 'recall': 0.4600300042863266, 'f1-score': 0.38585295703756967, 'support': 9332}, 'accuracy': 0.33497450325303324, 'macro avg': {'precision': 0.33890450748179646, 'recall': 0.3362566676116793, 'f1-score': 0.32240884506048434, 'support': 28435}, 'weighted avg': {'precision': 0.33899252898584, 'recall': 0.33497450325303324, 'f1-score': 0.3217258816979852, 'support': 28435}}
[[1608 3757 4230]
 [1487 3624 4397]
 [1444 3595 4293]]
training model: results/CHTR/W9/deepLOB_L2/h10
Epoch 1/50
323/323 - 17s - loss: 3.3432 - accuracy10: 0.3440 - val_loss: 3.3364 - val_accuracy10: 0.3435 - 17s/epoch - 53ms/step
Epoch 2/50
323/323 - 14s - loss: 3.3025 - accuracy10: 0.3581 - val_loss: 3.3269 - val_accuracy10: 0.3671 - 14s/epoch - 44ms/step
Epoch 3/50
323/323 - 14s - loss: 3.2808 - accuracy10: 0.3749 - val_loss: 3.2899 - val_accuracy10: 0.3751 - 14s/epoch - 43ms/step
Epoch 4/50
323/323 - 14s - loss: 3.2643 - accuracy10: 0.3871 - val_loss: 3.2707 - val_accuracy10: 0.3928 - 14s/epoch - 43ms/step
Epoch 5/50
323/323 - 14s - loss: 3.2499 - accuracy10: 0.3985 - val_loss: 3.2652 - val_accuracy10: 0.3946 - 14s/epoch - 43ms/step
Epoch 6/50
323/323 - 14s - loss: 3.2381 - accuracy10: 0.4063 - val_loss: 3.2689 - val_accuracy10: 0.3938 - 14s/epoch - 43ms/step
Epoch 7/50
323/323 - 14s - loss: 3.2262 - accuracy10: 0.4146 - val_loss: 3.2475 - val_accuracy10: 0.4077 - 14s/epoch - 43ms/step
Epoch 8/50
323/323 - 14s - loss: 3.2127 - accuracy10: 0.4201 - val_loss: 3.2569 - val_accuracy10: 0.4053 - 14s/epoch - 43ms/step
Epoch 9/50
323/323 - 14s - loss: 3.2023 - accuracy10: 0.4255 - val_loss: 3.2432 - val_accuracy10: 0.4157 - 14s/epoch - 43ms/step
Epoch 10/50
323/323 - 14s - loss: 3.1928 - accuracy10: 0.4300 - val_loss: 3.2457 - val_accuracy10: 0.4103 - 14s/epoch - 42ms/step
Epoch 11/50
323/323 - 14s - loss: 3.1798 - accuracy10: 0.4362 - val_loss: 3.2534 - val_accuracy10: 0.4126 - 14s/epoch - 42ms/step
Epoch 12/50
323/323 - 14s - loss: 3.1724 - accuracy10: 0.4383 - val_loss: 3.2529 - val_accuracy10: 0.4075 - 14s/epoch - 42ms/step
Epoch 13/50
323/323 - 14s - loss: 3.1627 - accuracy10: 0.4423 - val_loss: 3.2654 - val_accuracy10: 0.4098 - 14s/epoch - 42ms/step
Epoch 14/50
323/323 - 14s - loss: 3.1515 - accuracy10: 0.4463 - val_loss: 3.2675 - val_accuracy10: 0.4076 - 14s/epoch - 42ms/step
Epoch 15/50
323/323 - 14s - loss: 3.1393 - accuracy10: 0.4532 - val_loss: 3.2648 - val_accuracy10: 0.4148 - 14s/epoch - 42ms/step
Epoch 16/50
323/323 - 14s - loss: 3.1284 - accuracy10: 0.4554 - val_loss: 3.3305 - val_accuracy10: 0.3973 - 14s/epoch - 42ms/step
Epoch 17/50
323/323 - 14s - loss: 3.1185 - accuracy10: 0.4607 - val_loss: 3.3378 - val_accuracy10: 0.4036 - 14s/epoch - 42ms/step
Epoch 18/50
323/323 - 14s - loss: 3.1104 - accuracy10: 0.4637 - val_loss: 3.3255 - val_accuracy10: 0.4039 - 14s/epoch - 42ms/step
Epoch 19/50
323/323 - 14s - loss: 3.1042 - accuracy10: 0.4636 - val_loss: 3.3415 - val_accuracy10: 0.3996 - 14s/epoch - 43ms/step
testing model: results/CHTR/W9/deepLOB_L2/h10
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.09942
{'0': {'precision': 0.386327524346489, 'recall': 0.5756262410264243, 'f1-score': 0.4623512452459821, 'support': 52376}, '1': {'precision': 0.43178829717291256, 'recall': 0.04884715507623652, 'f1-score': 0.08776560203127089, 'support': 53780}, '2': {'precision': 0.3636751650352834, 'recall': 0.5297165119363395, 'f1-score': 0.4312660278040221, 'support': 48256}, 'accuracy': 0.3778074242934487, 'macro avg': {'precision': 0.39393032885156165, 'recall': 0.38472996934633347, 'f1-score': 0.3271276250270917, 'support': 154412}, 'weighted avg': {'precision': 0.3950818187775146, 'recall': 0.3778074242934487, 'f1-score': 0.3221726053412701, 'support': 154412}}
[[30149  1929 20298]
 [26725  2627 24428]
 [21166  1528 25562]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0752698
{'0': {'precision': 0.4228011472275335, 'recall': 0.5413464807888473, 'f1-score': 0.47478603167029493, 'support': 29410}, '1': {'precision': 0.3840226333618732, 'recall': 0.3979017202807992, 'f1-score': 0.39083900054935694, 'support': 25926}, '2': {'precision': 0.4409361890041952, 'recall': 0.29261145096889996, 'f1-score': 0.3517780469008037, 'support': 27299}, 'accuracy': 0.41417075089247896, 'macro avg': {'precision': 0.415919989864534, 'recall': 0.41061988401284877, 'f1-score': 0.4058010263734852, 'support': 82635}, 'weighted avg': {'precision': 0.4166257585300079, 'recall': 0.41417075089247896, 'f1-score': 0.4078119201550317, 'support': 82635}}
[[15921  8369  5120]
 [10602 10316  5008]
 [11133  8178  7988]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0812181
{'0': {'precision': 0.437879112252908, 'recall': 0.5630907589244746, 'f1-score': 0.492653552790044, 'support': 10897}, '1': {'precision': 0.30638677981241624, 'recall': 0.18475626178292487, 'f1-score': 0.23051075268817206, 'support': 7426}, '2': {'precision': 0.4289592760180995, 'recall': 0.4218332838920202, 'f1-score': 0.42536643733173796, 'support': 10113}, 'accuracy': 0.41405260936840627, 'macro avg': {'precision': 0.39107505602780795, 'recall': 0.38989343486647327, 'f1-score': 0.38284358093665133, 'support': 28436}, 'weighted avg': {'precision': 0.40036791642558667, 'recall': 0.41405260936840627, 'f1-score': 0.4002654872327803, 'support': 28436}}
[[6136 1587 3174]
 [3549 1372 2505]
 [4328 1519 4266]]
training model: results/CHTR/W9/deepLOB_L2/h20
Epoch 1/50
323/323 - 15s - loss: 3.3381 - accuracy20: 0.3472 - val_loss: 3.3612 - val_accuracy20: 0.3424 - 15s/epoch - 48ms/step
Epoch 2/50
323/323 - 14s - loss: 3.3048 - accuracy20: 0.3616 - val_loss: 3.3410 - val_accuracy20: 0.3594 - 14s/epoch - 43ms/step
Epoch 3/50
323/323 - 14s - loss: 3.2778 - accuracy20: 0.3753 - val_loss: 3.3207 - val_accuracy20: 0.3625 - 14s/epoch - 43ms/step
Epoch 4/50
323/323 - 14s - loss: 3.2579 - accuracy20: 0.3906 - val_loss: 3.3135 - val_accuracy20: 0.3606 - 14s/epoch - 43ms/step
Epoch 5/50
323/323 - 14s - loss: 3.2426 - accuracy20: 0.3998 - val_loss: 3.3082 - val_accuracy20: 0.3646 - 14s/epoch - 43ms/step
Epoch 6/50
323/323 - 14s - loss: 3.2315 - accuracy20: 0.4087 - val_loss: 3.3015 - val_accuracy20: 0.3728 - 14s/epoch - 42ms/step
Epoch 7/50
323/323 - 14s - loss: 3.2210 - accuracy20: 0.4121 - val_loss: 3.2949 - val_accuracy20: 0.3737 - 14s/epoch - 43ms/step
Epoch 8/50
323/323 - 14s - loss: 3.2083 - accuracy20: 0.4194 - val_loss: 3.3062 - val_accuracy20: 0.3717 - 14s/epoch - 42ms/step
Epoch 9/50
323/323 - 14s - loss: 3.1980 - accuracy20: 0.4255 - val_loss: 3.3106 - val_accuracy20: 0.3691 - 14s/epoch - 42ms/step
Epoch 10/50
323/323 - 14s - loss: 3.1886 - accuracy20: 0.4305 - val_loss: 3.3084 - val_accuracy20: 0.3744 - 14s/epoch - 42ms/step
Epoch 11/50
323/323 - 14s - loss: 3.1787 - accuracy20: 0.4342 - val_loss: 3.3010 - val_accuracy20: 0.3824 - 14s/epoch - 42ms/step
Epoch 12/50
323/323 - 14s - loss: 3.1692 - accuracy20: 0.4397 - val_loss: 3.3110 - val_accuracy20: 0.3852 - 14s/epoch - 42ms/step
Epoch 13/50
323/323 - 14s - loss: 3.1637 - accuracy20: 0.4422 - val_loss: 3.3241 - val_accuracy20: 0.3851 - 14s/epoch - 43ms/step
Epoch 14/50
323/323 - 13s - loss: 3.1519 - accuracy20: 0.4469 - val_loss: 3.3147 - val_accuracy20: 0.3839 - 13s/epoch - 42ms/step
Epoch 15/50
323/323 - 14s - loss: 3.1438 - accuracy20: 0.4493 - val_loss: 3.3417 - val_accuracy20: 0.3788 - 14s/epoch - 42ms/step
Epoch 16/50
323/323 - 14s - loss: 3.1324 - accuracy20: 0.4550 - val_loss: 3.3424 - val_accuracy20: 0.3825 - 14s/epoch - 42ms/step
Epoch 17/50
323/323 - 14s - loss: 3.1245 - accuracy20: 0.4557 - val_loss: 3.3498 - val_accuracy20: 0.3879 - 14s/epoch - 42ms/step
testing model: results/CHTR/W9/deepLOB_L2/h20
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1224616
{'0': {'precision': 0.37167544889244064, 'recall': 0.30450527866437516, 'f1-score': 0.33475410204793127, 'support': 48876}, '1': {'precision': 0.38757062146892657, 'recall': 0.04029605263157895, 'f1-score': 0.07300202192188997, 'support': 59584}, '2': {'precision': 0.31952225118790095, 'recall': 0.7521761838440112, 'f1-score': 0.44851614912474214, 'support': 45952}, 'accuracy': 0.3357770121493148, 'macro avg': {'precision': 0.3595894405164228, 'recall': 0.36565917171332174, 'f1-score': 0.2854240910315211, 'support': 154412}, 'weighted avg': {'precision': 0.3622885762522205, 'recall': 0.3357770121493148, 'f1-score': 0.26760490150032856, 'support': 154412}}
[[14883  2201 31792]
 [15365  2401 41818]
 [ 9795  1593 34564]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0834216
{'0': {'precision': 0.42558054488937647, 'recall': 0.3253652058432935, 'f1-score': 0.3687858981976629, 'support': 28614}, '1': {'precision': 0.37565234198827396, 'recall': 0.4183918768612536, 'f1-score': 0.39587187887223535, 'support': 27871}, '2': {'precision': 0.3907864185483057, 'recall': 0.44409177820267687, 'f1-score': 0.415737376268638, 'support': 26150}, 'accuracy': 0.39431233738730564, 'macro avg': {'precision': 0.39733976847531866, 'recall': 0.395949620302408, 'f1-score': 0.3934650511128454, 'support': 82635}, 'weighted avg': {'precision': 0.3977301746240454, 'recall': 0.39431233738730564, 'f1-score': 0.39277929710777376, 'support': 82635}}
[[ 9310 10510  8794]
 [ 6900 11661  9310]
 [ 5666  8871 11613]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1010983
{'0': {'precision': 0.4387966804979253, 'recall': 0.23984123984123984, 'f1-score': 0.31015519980447265, 'support': 10582}, '1': {'precision': 0.3031563494005383, 'recall': 0.15353159851301115, 'f1-score': 0.20383318252858434, 'support': 8070}, '2': {'precision': 0.3743064907083221, 'recall': 0.7102412101390024, 'f1-score': 0.4902465695438993, 'support': 9784}, 'accuracy': 0.3771979181319454, 'macro avg': {'precision': 0.3720865068689285, 'recall': 0.3678713494977511, 'f1-score': 0.3347449839589854, 'support': 28436}, 'weighted avg': {'precision': 0.3781134096842598, 'recall': 0.3771979181319454, 'f1-score': 0.3419457217525009, 'support': 28436}}
[[2538 1582 6462]
 [1677 1239 5154]
 [1569 1266 6949]]
training model: results/CHTR/W9/deepLOB_L2/h30
Epoch 1/50
323/323 - 16s - loss: 3.3386 - accuracy30: 0.3483 - val_loss: 3.3621 - val_accuracy30: 0.3337 - 16s/epoch - 48ms/step
Epoch 2/50
323/323 - 14s - loss: 3.2987 - accuracy30: 0.3624 - val_loss: 3.3379 - val_accuracy30: 0.3543 - 14s/epoch - 43ms/step
Epoch 3/50
323/323 - 14s - loss: 3.2795 - accuracy30: 0.3748 - val_loss: 3.3213 - val_accuracy30: 0.3563 - 14s/epoch - 43ms/step
Epoch 4/50
323/323 - 14s - loss: 3.2584 - accuracy30: 0.3919 - val_loss: 3.2999 - val_accuracy30: 0.3690 - 14s/epoch - 43ms/step
Epoch 5/50
323/323 - 14s - loss: 3.2433 - accuracy30: 0.4043 - val_loss: 3.2909 - val_accuracy30: 0.3792 - 14s/epoch - 43ms/step
Epoch 6/50
323/323 - 14s - loss: 3.2320 - accuracy30: 0.4096 - val_loss: 3.2804 - val_accuracy30: 0.3887 - 14s/epoch - 42ms/step
Epoch 7/50
323/323 - 13s - loss: 3.2202 - accuracy30: 0.4154 - val_loss: 3.2853 - val_accuracy30: 0.3892 - 13s/epoch - 42ms/step
Epoch 8/50
323/323 - 14s - loss: 3.2081 - accuracy30: 0.4218 - val_loss: 3.2832 - val_accuracy30: 0.3959 - 14s/epoch - 42ms/step
Epoch 9/50
323/323 - 14s - loss: 3.1973 - accuracy30: 0.4261 - val_loss: 3.2907 - val_accuracy30: 0.3921 - 14s/epoch - 42ms/step
Epoch 10/50
323/323 - 14s - loss: 3.1872 - accuracy30: 0.4333 - val_loss: 3.2940 - val_accuracy30: 0.3872 - 14s/epoch - 42ms/step
Epoch 11/50
323/323 - 14s - loss: 3.1819 - accuracy30: 0.4354 - val_loss: 3.2931 - val_accuracy30: 0.3888 - 14s/epoch - 43ms/step
Epoch 12/50
323/323 - 14s - loss: 3.1719 - accuracy30: 0.4398 - val_loss: 3.2942 - val_accuracy30: 0.3868 - 14s/epoch - 42ms/step
Epoch 13/50
323/323 - 14s - loss: 3.1653 - accuracy30: 0.4419 - val_loss: 3.2976 - val_accuracy30: 0.3918 - 14s/epoch - 42ms/step
Epoch 14/50
323/323 - 14s - loss: 3.1560 - accuracy30: 0.4480 - val_loss: 3.3089 - val_accuracy30: 0.3802 - 14s/epoch - 43ms/step
Epoch 15/50
323/323 - 14s - loss: 3.1460 - accuracy30: 0.4499 - val_loss: 3.3090 - val_accuracy30: 0.3846 - 14s/epoch - 42ms/step
Epoch 16/50
323/323 - 14s - loss: 3.1382 - accuracy30: 0.4532 - val_loss: 3.3343 - val_accuracy30: 0.3792 - 14s/epoch - 42ms/step
testing model: results/CHTR/W9/deepLOB_L2/h30
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1081944
{'0': {'precision': 0.3358636462644304, 'recall': 0.6282518793163159, 'f1-score': 0.43772133392947116, 'support': 49087}, '1': {'precision': 0.4072016855008619, 'recall': 0.07138060703733548, 'f1-score': 0.12146836166261962, 'support': 59568}, '2': {'precision': 0.3338446788111218, 'recall': 0.3804882313088708, 'f1-score': 0.35564362098726343, 'support': 45757}, 'accuracy': 0.34000595808615913, 'macro avg': {'precision': 0.3589700035254713, 'recall': 0.3600402392208408, 'f1-score': 0.3049444388597847, 'support': 154412}, 'weighted avg': {'precision': 0.3627856628659556, 'recall': 0.34000595808615913, 'f1-score': 0.2913972984718098, 'support': 154412}}
[[30839  3205 15043]
 [35619  4252 19697]
 [25362  2985 17410]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0813228
{'0': {'precision': 0.4084036056993312, 'recall': 0.4858852833321802, 'f1-score': 0.44378791708796766, 'support': 28906}, '1': {'precision': 0.37505270824548625, 'recall': 0.3539285197511214, 'f1-score': 0.36418454895684055, 'support': 27644}, '2': {'precision': 0.41231158046755123, 'recall': 0.35023960130343107, 'f1-score': 0.3787492485956512, 'support': 26085}, 'accuracy': 0.39892297452653236, 'macro avg': {'precision': 0.3985892981374562, 'recall': 0.39668446812891084, 'f1-score': 0.39557390488015315, 'support': 82635}, 'weighted avg': {'precision': 0.39848029611640534, 'recall': 0.39892297452653236, 'f1-score': 0.3966276438836481, 'support': 82635}}
[[14045  8540  6321]
 [11159  9784  6701]
 [ 9186  7763  9136]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0934958
{'0': {'precision': 0.407078324497872, 'recall': 0.5159946999810714, 'f1-score': 0.4551108143077758, 'support': 10566}, '1': {'precision': 0.2992743105950653, 'recall': 0.12963661511379354, 'f1-score': 0.1809089313914722, 'support': 7953}, '2': {'precision': 0.3942058975685463, 'recall': 0.4610265201169709, 'f1-score': 0.42500580990006975, 'support': 9917}, 'accuracy': 0.38876775917850614, 'macro avg': {'precision': 0.3668528442204946, 'recall': 0.36888594507061195, 'f1-score': 0.3536751851997726, 'support': 28436}, 'weighted avg': {'precision': 0.3724383898928944, 'recall': 0.38876775917850614, 'f1-score': 0.36792278140776935, 'support': 28436}}
[[5452 1247 3867]
 [3763 1031 3159]
 [4178 1167 4572]]
training model: results/CHTR/W9/deepLOB_L2/h50
Epoch 1/50
323/323 - 16s - loss: 3.3405 - accuracy50: 0.3457 - val_loss: 3.3720 - val_accuracy50: 0.3252 - 16s/epoch - 49ms/step
Epoch 2/50
323/323 - 14s - loss: 3.2981 - accuracy50: 0.3647 - val_loss: 3.3552 - val_accuracy50: 0.3387 - 14s/epoch - 42ms/step
Epoch 3/50
323/323 - 14s - loss: 3.2760 - accuracy50: 0.3785 - val_loss: 3.3086 - val_accuracy50: 0.3562 - 14s/epoch - 43ms/step
Epoch 4/50
323/323 - 14s - loss: 3.2592 - accuracy50: 0.3908 - val_loss: 3.2922 - val_accuracy50: 0.3709 - 14s/epoch - 43ms/step
Epoch 5/50
323/323 - 14s - loss: 3.2484 - accuracy50: 0.3953 - val_loss: 3.2992 - val_accuracy50: 0.3597 - 14s/epoch - 42ms/step
Epoch 6/50
323/323 - 14s - loss: 3.2381 - accuracy50: 0.4020 - val_loss: 3.2868 - val_accuracy50: 0.3783 - 14s/epoch - 42ms/step
Epoch 7/50
323/323 - 14s - loss: 3.2321 - accuracy50: 0.4058 - val_loss: 3.2855 - val_accuracy50: 0.3830 - 14s/epoch - 42ms/step
Epoch 8/50
323/323 - 14s - loss: 3.2231 - accuracy50: 0.4142 - val_loss: 3.2809 - val_accuracy50: 0.3911 - 14s/epoch - 43ms/step
Epoch 9/50
323/323 - 14s - loss: 3.2145 - accuracy50: 0.4175 - val_loss: 3.2870 - val_accuracy50: 0.3858 - 14s/epoch - 42ms/step
Epoch 10/50
323/323 - 14s - loss: 3.2075 - accuracy50: 0.4206 - val_loss: 3.2929 - val_accuracy50: 0.3793 - 14s/epoch - 43ms/step
Epoch 11/50
323/323 - 14s - loss: 3.1994 - accuracy50: 0.4261 - val_loss: 3.2937 - val_accuracy50: 0.3766 - 14s/epoch - 42ms/step
Epoch 12/50
323/323 - 14s - loss: 3.1925 - accuracy50: 0.4293 - val_loss: 3.3029 - val_accuracy50: 0.3800 - 14s/epoch - 42ms/step
Epoch 13/50
323/323 - 14s - loss: 3.1834 - accuracy50: 0.4317 - val_loss: 3.3065 - val_accuracy50: 0.3824 - 14s/epoch - 42ms/step
Epoch 14/50
323/323 - 14s - loss: 3.1771 - accuracy50: 0.4358 - val_loss: 3.3117 - val_accuracy50: 0.3800 - 14s/epoch - 42ms/step
Epoch 15/50
323/323 - 14s - loss: 3.1673 - accuracy50: 0.4410 - val_loss: 3.3303 - val_accuracy50: 0.3767 - 14s/epoch - 43ms/step
Epoch 16/50
323/323 - 14s - loss: 3.1595 - accuracy50: 0.4437 - val_loss: 3.3241 - val_accuracy50: 0.3742 - 14s/epoch - 42ms/step
Epoch 17/50
323/323 - 14s - loss: 3.1501 - accuracy50: 0.4488 - val_loss: 3.3499 - val_accuracy50: 0.3716 - 14s/epoch - 42ms/step
Epoch 18/50
323/323 - 14s - loss: 3.1435 - accuracy50: 0.4505 - val_loss: 3.3505 - val_accuracy50: 0.3699 - 14s/epoch - 42ms/step
testing model: results/CHTR/W9/deepLOB_L2/h50
Evaluating performance on  test set...
604/604 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.104921
{'0': {'precision': 0.3380156898938625, 'recall': 0.7514773473407748, 'f1-score': 0.466292349413697, 'support': 48736}, '1': {'precision': 0.3899414398897692, 'recall': 0.056581139620126626, 'f1-score': 0.0988229131807534, 'support': 60020}, '2': {'precision': 0.3529569244772843, 'recall': 0.2887681794287717, 'f1-score': 0.31765230276235107, 'support': 45656}, 'accuracy': 0.34455871305338964, 'macro avg': {'precision': 0.36030468475363864, 'recall': 0.3656088887965577, 'f1-score': 0.2942558551189338, 'support': 154412}, 'weighted avg': {'precision': 0.36261701958906123, 'recall': 0.34455871305338964, 'f1-score': 0.27950747820799327, 'support': 154412}}
[[36624  2500  9612]
 [42067  3396 14557]
 [29659  2813 13184]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0791638
{'0': {'precision': 0.41693190712235845, 'recall': 0.544274913153055, 'f1-score': 0.4721680553093423, 'support': 29362}, '1': {'precision': 0.3626192223037418, 'recall': 0.36308539944903584, 'f1-score': 0.3628521611452694, 'support': 27225}, '2': {'precision': 0.42299794661190965, 'recall': 0.27679668304668303, 'f1-score': 0.3346251131274221, 'support': 26048}, 'accuracy': 0.40026623101591335, 'macro avg': {'precision': 0.4008496920126699, 'recall': 0.3947189985495913, 'f1-score': 0.38988177652734457, 'support': 82635}, 'weighted avg': {'precision': 0.4009501240091134, 'recall': 0.40026623101591335, 'f1-score': 0.3927967988614505, 'support': 82635}}
[[15981  8752  4629]
 [12134  9885  5206]
 [10215  8623  7210]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0916983
{'0': {'precision': 0.40938511326860844, 'recall': 0.554613038505528, 'f1-score': 0.47105966162065893, 'support': 10492}, '1': {'precision': 0.29283018867924526, 'recall': 0.19284294234592445, 'f1-score': 0.23254420137848364, 'support': 8048}, '2': {'precision': 0.41661062542030936, 'recall': 0.37560630557801133, 'f1-score': 0.39504729514294823, 'support': 9896}, 'accuracy': 0.3899282599521733, 'macro avg': {'precision': 0.37294197578938765, 'recall': 0.3743540954764879, 'f1-score': 0.36621705271403027, 'support': 28436}, 'weighted avg': {'precision': 0.3789121084563295, 'recall': 0.3899282599521733, 'f1-score': 0.3771016224206149, 'support': 28436}}
[[5819 1921 2752]
 [4043 1552 2453]
 [4352 1827 3717]]
training model: results/CHTR/W9/deepLOB_L2/h100
Epoch 1/50
323/323 - 16s - loss: 3.3408 - accuracy100: 0.3463 - val_loss: 3.3857 - val_accuracy100: 0.3324 - 16s/epoch - 50ms/step
Epoch 2/50
323/323 - 14s - loss: 3.3010 - accuracy100: 0.3618 - val_loss: 3.3475 - val_accuracy100: 0.3439 - 14s/epoch - 43ms/step
Epoch 3/50
323/323 - 14s - loss: 3.2876 - accuracy100: 0.3727 - val_loss: 3.3491 - val_accuracy100: 0.3483 - 14s/epoch - 43ms/step
Epoch 4/50
323/323 - 14s - loss: 3.2745 - accuracy100: 0.3791 - val_loss: 3.3352 - val_accuracy100: 0.3489 - 14s/epoch - 43ms/step
Epoch 5/50
323/323 - 14s - loss: 3.2646 - accuracy100: 0.3856 - val_loss: 3.3154 - val_accuracy100: 0.3592 - 14s/epoch - 42ms/step
Epoch 6/50
323/323 - 14s - loss: 3.2508 - accuracy100: 0.3960 - val_loss: 3.3135 - val_accuracy100: 0.3623 - 14s/epoch - 42ms/step
Epoch 7/50
323/323 - 14s - loss: 3.2387 - accuracy100: 0.4066 - val_loss: 3.3172 - val_accuracy100: 0.3587 - 14s/epoch - 43ms/step
Epoch 8/50
323/323 - 14s - loss: 3.2299 - accuracy100: 0.4122 - val_loss: 3.3256 - val_accuracy100: 0.3584 - 14s/epoch - 42ms/step
Epoch 9/50
323/323 - 14s - loss: 3.2215 - accuracy100: 0.4159 - val_loss: 3.3439 - val_accuracy100: 0.3559 - 14s/epoch - 42ms/step
Epoch 10/50
323/323 - 14s - loss: 3.2114 - accuracy100: 0.4221 - val_loss: 3.3479 - val_accuracy100: 0.3499 - 14s/epoch - 42ms/step
Epoch 11/50
323/323 - 14s - loss: 3.2014 - accuracy100: 0.4283 - val_loss: 3.3640 - val_accuracy100: 0.3536 - 14s/epoch - 42ms/step
Epoch 12/50
323/323 - 14s - loss: 3.1950 - accuracy100: 0.4297 - val_loss: 3.3754 - val_accuracy100: 0.3468 - 14s/epoch - 43ms/step
Epoch 13/50
323/323 - 14s - loss: 3.1858 - accuracy100: 0.4339 - val_loss: 3.3782 - val_accuracy100: 0.3506 - 14s/epoch - 42ms/step
Epoch 14/50
323/323 - 14s - loss: 3.1758 - accuracy100: 0.4395 - val_loss: 3.3591 - val_accuracy100: 0.3555 - 14s/epoch - 43ms/step
Epoch 15/50
323/323 - 14s - loss: 3.1708 - accuracy100: 0.4416 - val_loss: 3.3624 - val_accuracy100: 0.3595 - 14s/epoch - 43ms/step
Epoch 16/50
323/323 - 14s - loss: 3.1600 - accuracy100: 0.4461 - val_loss: 3.3759 - val_accuracy100: 0.3545 - 14s/epoch - 43ms/step
testing model: results/CHTR/W9/deepLOB_L2/h100
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1131499
{'0': {'precision': 0.323255540373008, 'recall': 0.7423678796317463, 'f1-score': 0.4503927477210546, 'support': 48119}, '1': {'precision': 0.379409509202454, 'recall': 0.06560039777906687, 'f1-score': 0.1118600477623751, 'support': 60335}, '2': {'precision': 0.31998924506318527, 'recall': 0.2330606205666043, 'f1-score': 0.26969319283403204, 'support': 45958}, 'accuracy': 0.3263412170038598, 'macro avg': {'precision': 0.34088476487954916, 'recall': 0.3470096326591392, 'f1-score': 0.2773153294391539, 'support': 154412}, 'weighted avg': {'precision': 0.34422500718566373, 'recall': 0.3263412170038598, 'f1-score': 0.26433233405174966, 'support': 154412}}
[[35722  3141  9256]
 [42871  3958 13506]
 [31914  3333 10711]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.090519
{'0': {'precision': 0.4153492890576702, 'recall': 0.3213309647444657, 'f1-score': 0.36234061404522516, 'support': 29272}, '1': {'precision': 0.3499474513925381, 'recall': 0.48938124632569074, 'f1-score': 0.4080826031006802, 'support': 27216}, '2': {'precision': 0.38442245428428107, 'recall': 0.32240792442727656, 'f1-score': 0.35069473333888007, 'support': 26147}, 'accuracy': 0.37701942276275185, 'macro avg': {'precision': 0.3832397315781631, 'recall': 0.37770671183247767, 'f1-score': 0.3737059834949285, 'support': 82635}, 'weighted avg': {'precision': 0.3840233331949723, 'recall': 0.37701942276275185, 'f1-score': 0.373720890336197, 'support': 82635}}
[[ 9406 13367  6499]
 [ 6897 13319  7000]
 [ 6343 11374  8430]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1035848
{'0': {'precision': 0.3824400754107191, 'recall': 0.41642228739002934, 'f1-score': 0.398708409378071, 'support': 10230}, '1': {'precision': 0.3091650197628458, 'recall': 0.3017116682738669, 'f1-score': 0.30539287457296244, 'support': 8296}, '2': {'precision': 0.3828931637865449, 'recall': 0.3554994954591322, 'f1-score': 0.36868819004761655, 'support': 9910}, 'accuracy': 0.3617245744830497, 'macro avg': {'precision': 0.35816608632003666, 'recall': 0.35787781704100946, 'f1-score': 0.3575964913328833, 'support': 28436}, 'weighted avg': {'precision': 0.36122050318360127, 'recall': 0.3617245744830497, 'f1-score': 0.3610221648180772, 'support': 28436}}
[[4260 2916 3054]
 [3169 2503 2624]
 [3710 2677 3523]]
training model: results/CHTR/W9/deepLOB_L2/h200
Epoch 1/50
323/323 - 16s - loss: 3.3411 - accuracy200: 0.3483 - val_loss: 3.3869 - val_accuracy200: 0.3329 - 16s/epoch - 49ms/step
Epoch 2/50
323/323 - 14s - loss: 3.2983 - accuracy200: 0.3661 - val_loss: 3.3454 - val_accuracy200: 0.3437 - 14s/epoch - 43ms/step
Epoch 3/50
323/323 - 14s - loss: 3.2813 - accuracy200: 0.3726 - val_loss: 3.3980 - val_accuracy200: 0.3478 - 14s/epoch - 42ms/step
Epoch 4/50
323/323 - 14s - loss: 3.2642 - accuracy200: 0.3837 - val_loss: 3.4170 - val_accuracy200: 0.3477 - 14s/epoch - 42ms/step
Epoch 5/50
323/323 - 14s - loss: 3.2599 - accuracy200: 0.3885 - val_loss: 3.4327 - val_accuracy200: 0.3443 - 14s/epoch - 42ms/step
Epoch 6/50
323/323 - 14s - loss: 3.2513 - accuracy200: 0.3927 - val_loss: 3.3944 - val_accuracy200: 0.3440 - 14s/epoch - 42ms/step
Epoch 7/50
323/323 - 14s - loss: 3.2399 - accuracy200: 0.4025 - val_loss: 3.3975 - val_accuracy200: 0.3473 - 14s/epoch - 42ms/step
Epoch 8/50
323/323 - 14s - loss: 3.2234 - accuracy200: 0.4110 - val_loss: 3.4085 - val_accuracy200: 0.3479 - 14s/epoch - 42ms/step
Epoch 9/50
323/323 - 14s - loss: 3.2151 - accuracy200: 0.4187 - val_loss: 3.4036 - val_accuracy200: 0.3487 - 14s/epoch - 43ms/step
Epoch 10/50
323/323 - 14s - loss: 3.2074 - accuracy200: 0.4228 - val_loss: 3.4118 - val_accuracy200: 0.3537 - 14s/epoch - 43ms/step
Epoch 11/50
323/323 - 14s - loss: 3.2034 - accuracy200: 0.4240 - val_loss: 3.4402 - val_accuracy200: 0.3514 - 14s/epoch - 42ms/step
Epoch 12/50
323/323 - 14s - loss: 3.1893 - accuracy200: 0.4308 - val_loss: 3.4872 - val_accuracy200: 0.3491 - 14s/epoch - 42ms/step
testing model: results/CHTR/W9/deepLOB_L2/h200
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1287462
{'0': {'precision': 0.31104966920114546, 'recall': 0.6671467299220604, 'f1-score': 0.42428242393222254, 'support': 47216}, '1': {'precision': 0.38575720091889026, 'recall': 0.14457671738662517, 'f1-score': 0.2103260149579083, 'support': 60397}, '2': {'precision': 0.31121746541663936, 'recall': 0.20286758264065471, 'f1-score': 0.24562447448418603, 'support': 46799}, 'accuracy': 0.3220345568997228, 'macro avg': {'precision': 0.3360081118455584, 'recall': 0.33819700998311336, 'f1-score': 0.29341097112477227, 'support': 154412}, 'weighted avg': {'precision': 0.3403217690913453, 'recall': 0.3220345568997228, 'f1-score': 0.28644767916471536, 'support': 154412}}
[[31500  6906  8810]
 [39463  8732 12202]
 [30307  6998  9494]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1021178
{'0': {'precision': 0.37315215153386866, 'recall': 0.31135543721010134, 'f1-score': 0.33946431916089154, 'support': 29105}, '1': {'precision': 0.34064561263242055, 'recall': 0.5034154266514049, 'f1-score': 0.40633614973102655, 'support': 27083}, '2': {'precision': 0.3559969442322384, 'recall': 0.2466820433319469, 'f1-score': 0.2914256359859737, 'support': 26447}, 'accuracy': 0.353603194772191, 'macro avg': {'precision': 0.3565982361328425, 'recall': 0.3538176357311511, 'f1-score': 0.34574203495929723, 'support': 82635}, 'weighted avg': {'precision': 0.35700792256824715, 'recall': 0.353603194772191, 'f1-score': 0.346006471195791, 'support': 82635}}
[[ 9062 13959  6084]
 [ 7731 13634  5718]
 [ 7492 12431  6524]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1148928
{'0': {'precision': 0.369457284711522, 'recall': 0.42800476001586674, 'f1-score': 0.39658182486446747, 'support': 10084}, '1': {'precision': 0.29685961264908634, 'recall': 0.3206097849208225, 'f1-score': 0.3082779387534799, 'support': 8462}, '2': {'precision': 0.363887065003283, 'recall': 0.2801820020222447, 'f1-score': 0.31659525849757214, 'support': 9890}, 'accuracy': 0.3446335630890421, 'macro avg': {'precision': 0.3434013207879638, 'recall': 0.3429321823196447, 'f1-score': 0.3404850073718399, 'support': 28436}, 'weighted avg': {'precision': 0.34591631643515347, 'recall': 0.3446335630890421, 'f1-score': 0.34248509446498193, 'support': 28436}}
[[4316 3169 2599]
 [3504 2713 2245]
 [3862 3257 2771]]
training model: results/CHTR/W9/deepLOB_L2/h300
Epoch 1/50
323/323 - 16s - loss: 3.3363 - accuracy300: 0.3554 - val_loss: 3.3997 - val_accuracy300: 0.3327 - 16s/epoch - 49ms/step
Epoch 2/50
323/323 - 14s - loss: 3.3064 - accuracy300: 0.3659 - val_loss: 3.3835 - val_accuracy300: 0.3358 - 14s/epoch - 43ms/step
Epoch 3/50
323/323 - 14s - loss: 3.2899 - accuracy300: 0.3725 - val_loss: 3.3832 - val_accuracy300: 0.3355 - 14s/epoch - 43ms/step
Epoch 4/50
323/323 - 14s - loss: 3.2777 - accuracy300: 0.3788 - val_loss: 3.3551 - val_accuracy300: 0.3435 - 14s/epoch - 43ms/step
Epoch 5/50
323/323 - 14s - loss: 3.2625 - accuracy300: 0.3867 - val_loss: 3.3655 - val_accuracy300: 0.3452 - 14s/epoch - 42ms/step
Epoch 6/50
323/323 - 14s - loss: 3.2522 - accuracy300: 0.3920 - val_loss: 3.3509 - val_accuracy300: 0.3498 - 14s/epoch - 43ms/step
Epoch 7/50
323/323 - 14s - loss: 3.2421 - accuracy300: 0.4019 - val_loss: 3.3641 - val_accuracy300: 0.3450 - 14s/epoch - 43ms/step
Epoch 8/50
323/323 - 14s - loss: 3.2325 - accuracy300: 0.4085 - val_loss: 3.3696 - val_accuracy300: 0.3477 - 14s/epoch - 43ms/step
Epoch 9/50
323/323 - 14s - loss: 3.2174 - accuracy300: 0.4184 - val_loss: 3.3945 - val_accuracy300: 0.3448 - 14s/epoch - 42ms/step
Epoch 10/50
323/323 - 14s - loss: 3.2120 - accuracy300: 0.4223 - val_loss: 3.3872 - val_accuracy300: 0.3423 - 14s/epoch - 42ms/step
Epoch 11/50
323/323 - 14s - loss: 3.2017 - accuracy300: 0.4264 - val_loss: 3.3878 - val_accuracy300: 0.3425 - 14s/epoch - 43ms/step
Epoch 12/50
323/323 - 14s - loss: 3.1906 - accuracy300: 0.4312 - val_loss: 3.4139 - val_accuracy300: 0.3424 - 14s/epoch - 42ms/step
Epoch 13/50
323/323 - 14s - loss: 3.1820 - accuracy300: 0.4359 - val_loss: 3.4432 - val_accuracy300: 0.3395 - 14s/epoch - 42ms/step
Epoch 14/50
323/323 - 14s - loss: 3.1668 - accuracy300: 0.4409 - val_loss: 3.4536 - val_accuracy300: 0.3425 - 14s/epoch - 43ms/step
Epoch 15/50
323/323 - 14s - loss: 3.1506 - accuracy300: 0.4500 - val_loss: 3.4359 - val_accuracy300: 0.3433 - 14s/epoch - 43ms/step
Epoch 16/50
323/323 - 14s - loss: 3.1414 - accuracy300: 0.4537 - val_loss: 3.4741 - val_accuracy300: 0.3431 - 14s/epoch - 42ms/step
testing model: results/CHTR/W9/deepLOB_L2/h300
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1376697
{'0': {'precision': 0.3005834870656193, 'recall': 0.77473697799006, 'f1-score': 0.4331232408766148, 'support': 46479}, '1': {'precision': 0.37475728155339805, 'recall': 0.039318880192859444, 'f1-score': 0.07117065900465559, 'support': 58903}, '2': {'precision': 0.31288904519078603, 'recall': 0.1814603304099531, 'f1-score': 0.22970373717162593, 'support': 49030}, 'accuracy': 0.30581820065797993, 'macro avg': {'precision': 0.3294099379366011, 'recall': 0.33183872953095755, 'f1-score': 0.24466587901763212, 'support': 154412}, 'weighted avg': {'precision': 0.3327856509621465, 'recall': 0.30581820065797993, 'f1-score': 0.23045925623384336, 'support': 154412}}
[[36009  1906  8564]
 [45613  2316 10974]
 [38175  1958  8897]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1049895
{'0': {'precision': 0.37227349783386704, 'recall': 0.34332765868741966, 'f1-score': 0.3572151532677848, 'support': 28783}, '1': {'precision': 0.35483996422043323, 'recall': 0.33526861174395534, 'f1-score': 0.3447767680012092, 'support': 27214}, '2': {'precision': 0.3633999407446423, 'recall': 0.4144079885877318, 'f1-score': 0.387231430325353, 'support': 26638}, 'accuracy': 0.36358685786894174, 'macro avg': {'precision': 0.36350446759964755, 'recall': 0.36433475300636897, 'f1-score': 0.363074450531449, 'support': 82635}, 'weighted avg': {'precision': 0.3636716947540733, 'recall': 0.36358685786894174, 'f1-score': 0.36279481529495144, 'support': 82635}}
[[ 9882  8866 10035]
 [ 8787  9124  9303]
 [ 7876  7723 11039]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1138066
{'0': {'precision': 0.3524830767387528, 'recall': 0.5936238902340597, 'f1-score': 0.442322871640669, 'support': 9912}, '1': {'precision': 0.31898934070272406, 'recall': 0.1859608745684695, 'f1-score': 0.2349520209363187, 'support': 8690}, '2': {'precision': 0.3522540062902501, 'recall': 0.23917022574740696, 'f1-score': 0.2849009751075041, 'support': 9834}, 'accuracy': 0.34646223097482065, 'macro avg': {'precision': 0.341242141243909, 'recall': 0.33958499684997867, 'f1-score': 0.32072528922816396, 'support': 28436}, 'weighted avg': {'precision': 0.3421682207483299, 'recall': 0.34646223097482065, 'f1-score': 0.3245095496851216, 'support': 28436}}
[[5884 1632 2396]
 [5145 1616 1929]
 [5664 1818 2352]]
training model: results/CHTR/W9/deepLOB_L2/h500
Epoch 1/50
323/323 - 16s - loss: 3.3396 - accuracy500: 0.3553 - val_loss: 3.4091 - val_accuracy500: 0.3435 - 16s/epoch - 51ms/step
Epoch 2/50
323/323 - 14s - loss: 3.3037 - accuracy500: 0.3639 - val_loss: 3.4245 - val_accuracy500: 0.3281 - 14s/epoch - 44ms/step
Epoch 3/50
323/323 - 14s - loss: 3.2784 - accuracy500: 0.3802 - val_loss: 3.3989 - val_accuracy500: 0.3315 - 14s/epoch - 44ms/step
Epoch 4/50
323/323 - 14s - loss: 3.2603 - accuracy500: 0.3909 - val_loss: 3.3953 - val_accuracy500: 0.3395 - 14s/epoch - 43ms/step
Epoch 5/50
323/323 - 14s - loss: 3.2495 - accuracy500: 0.3964 - val_loss: 3.4496 - val_accuracy500: 0.3337 - 14s/epoch - 42ms/step
Epoch 6/50
323/323 - 14s - loss: 3.2355 - accuracy500: 0.4051 - val_loss: 3.4571 - val_accuracy500: 0.3405 - 14s/epoch - 43ms/step
Epoch 7/50
323/323 - 14s - loss: 3.2264 - accuracy500: 0.4099 - val_loss: 3.5214 - val_accuracy500: 0.3344 - 14s/epoch - 42ms/step
Epoch 8/50
323/323 - 14s - loss: 3.2214 - accuracy500: 0.4110 - val_loss: 3.5749 - val_accuracy500: 0.3319 - 14s/epoch - 42ms/step
Epoch 9/50
323/323 - 14s - loss: 3.2120 - accuracy500: 0.4183 - val_loss: 3.5247 - val_accuracy500: 0.3365 - 14s/epoch - 43ms/step
Epoch 10/50
323/323 - 14s - loss: 3.1995 - accuracy500: 0.4258 - val_loss: 3.5256 - val_accuracy500: 0.3339 - 14s/epoch - 43ms/step
Epoch 11/50
323/323 - 14s - loss: 3.1935 - accuracy500: 0.4279 - val_loss: 3.5723 - val_accuracy500: 0.3307 - 14s/epoch - 43ms/step
Epoch 12/50
323/323 - 14s - loss: 3.1802 - accuracy500: 0.4353 - val_loss: 3.5987 - val_accuracy500: 0.3309 - 14s/epoch - 43ms/step
Epoch 13/50
323/323 - 14s - loss: 3.1691 - accuracy500: 0.4417 - val_loss: 3.6359 - val_accuracy500: 0.3347 - 14s/epoch - 43ms/step
Epoch 14/50
323/323 - 14s - loss: 3.1607 - accuracy500: 0.4434 - val_loss: 3.5944 - val_accuracy500: 0.3337 - 14s/epoch - 42ms/step
testing model: results/CHTR/W9/deepLOB_L2/h500
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1428286
{'0': {'precision': 0.29880541970656616, 'recall': 0.406239100104639, 'f1-score': 0.3443369642543677, 'support': 45872}, '1': {'precision': 0.3820622785754242, 'recall': 0.24572133422418665, 'f1-score': 0.29908666277420964, 'support': 58371}, '2': {'precision': 0.3314864418596118, 'recall': 0.3601427176144631, 'f1-score': 0.3452209219011225, 'support': 50169}, 'accuracy': 0.33058311530191953, 'macro avg': {'precision': 0.3374513800472007, 'recall': 0.3373677173144296, 'f1-score': 0.32954818297656663, 'support': 154412}, 'weighted avg': {'precision': 0.34089645090511456, 'recall': 0.33058311530191953, 'f1-score': 0.32751859472014583, 'support': 154412}}
[[18635 11226 16011]
 [23601 14343 20427]
 [20129 11972 18068]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1221037
{'0': {'precision': 0.35833984023064447, 'recall': 0.21042607223476298, 'f1-score': 0.2651496633408147, 'support': 28352}, '1': {'precision': 0.3392242160594526, 'recall': 0.41195245432533567, 'f1-score': 0.37206759443339965, 'support': 27258}, '2': {'precision': 0.3411385476219438, 'recall': 0.41509713228492134, 'f1-score': 0.37450132701263583, 'support': 27025}, 'accuracy': 0.34383735705209656, 'macro avg': {'precision': 0.3462342013040136, 'recall': 0.3458252196150067, 'f1-score': 0.3372395282622834, 'support': 82635}, 'weighted avg': {'precision': 0.3464088350099936, 'recall': 0.34383735705209656, 'f1-score': 0.33618007026829877, 'support': 82635}}
[[ 5966 11241 11145]
 [ 5508 11229 10521]
 [ 5175 10632 11218]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1316655
{'0': {'precision': 0.3450637446001475, 'recall': 0.33888658940397354, 'f1-score': 0.3419472722526755, 'support': 9664}, '1': {'precision': 0.3389155799588195, 'recall': 0.2691008174386921, 'f1-score': 0.3, 'support': 9175}, '2': {'precision': 0.3362778730703259, 'recall': 0.40856517661769304, 'f1-score': 0.36891376958178485, 'support': 9597}, 'accuracy': 0.33988605992404, 'macro avg': {'precision': 0.34008573254309765, 'recall': 0.33885086115345286, 'f1-score': 0.3369536806114868, 'support': 28436}, 'weighted avg': {'precision': 0.3401148270429706, 'recall': 0.33988605992404, 'f1-score': 0.33751385165727404, 'support': 28436}}
[[3275 2123 4266]
 [3233 2469 3473]
 [2983 2693 3921]]
training model: results/CHTR/W9/deepLOB_L2/h1000
Epoch 1/50
323/323 - 16s - loss: 3.3320 - accuracy1000: 0.3619 - val_loss: 3.6567 - val_accuracy1000: 0.3340 - 16s/epoch - 50ms/step
Epoch 2/50
323/323 - 14s - loss: 3.2838 - accuracy1000: 0.3865 - val_loss: 3.7351 - val_accuracy1000: 0.3284 - 14s/epoch - 44ms/step
Epoch 3/50
323/323 - 14s - loss: 3.2370 - accuracy1000: 0.4043 - val_loss: 3.7394 - val_accuracy1000: 0.3267 - 14s/epoch - 43ms/step
Epoch 4/50
323/323 - 14s - loss: 3.2157 - accuracy1000: 0.4120 - val_loss: 3.5825 - val_accuracy1000: 0.3309 - 14s/epoch - 43ms/step
Epoch 5/50
323/323 - 14s - loss: 3.1939 - accuracy1000: 0.4224 - val_loss: 3.6906 - val_accuracy1000: 0.3305 - 14s/epoch - 43ms/step
Epoch 6/50
323/323 - 14s - loss: 3.1785 - accuracy1000: 0.4280 - val_loss: 3.7052 - val_accuracy1000: 0.3298 - 14s/epoch - 43ms/step
Epoch 7/50
323/323 - 14s - loss: 3.1521 - accuracy1000: 0.4411 - val_loss: 3.6716 - val_accuracy1000: 0.3312 - 14s/epoch - 42ms/step
Epoch 8/50
323/323 - 14s - loss: 3.1458 - accuracy1000: 0.4418 - val_loss: 3.6902 - val_accuracy1000: 0.3262 - 14s/epoch - 43ms/step
Epoch 9/50
323/323 - 14s - loss: 3.1426 - accuracy1000: 0.4440 - val_loss: 3.7155 - val_accuracy1000: 0.3272 - 14s/epoch - 43ms/step
Epoch 10/50
323/323 - 14s - loss: 3.1223 - accuracy1000: 0.4509 - val_loss: 3.6524 - val_accuracy1000: 0.3289 - 14s/epoch - 43ms/step
Epoch 11/50
323/323 - 14s - loss: 3.1105 - accuracy1000: 0.4585 - val_loss: 3.5368 - val_accuracy1000: 0.3337 - 14s/epoch - 43ms/step
Epoch 12/50
323/323 - 14s - loss: 3.0933 - accuracy1000: 0.4646 - val_loss: 3.6280 - val_accuracy1000: 0.3275 - 14s/epoch - 43ms/step
Epoch 13/50
323/323 - 14s - loss: 3.0776 - accuracy1000: 0.4689 - val_loss: 3.7476 - val_accuracy1000: 0.3288 - 14s/epoch - 43ms/step
Epoch 14/50
323/323 - 14s - loss: 3.0629 - accuracy1000: 0.4721 - val_loss: 3.7218 - val_accuracy1000: 0.3239 - 14s/epoch - 43ms/step
Epoch 15/50
323/323 - 14s - loss: 3.0416 - accuracy1000: 0.4831 - val_loss: 3.7483 - val_accuracy1000: 0.3279 - 14s/epoch - 43ms/step
Epoch 16/50
323/323 - 14s - loss: 3.0284 - accuracy1000: 0.4877 - val_loss: 3.6414 - val_accuracy1000: 0.3275 - 14s/epoch - 43ms/step
Epoch 17/50
323/323 - 14s - loss: 3.0151 - accuracy1000: 0.4931 - val_loss: 3.7530 - val_accuracy1000: 0.3288 - 14s/epoch - 43ms/step
Epoch 18/50
323/323 - 14s - loss: 3.0115 - accuracy1000: 0.4915 - val_loss: 3.6815 - val_accuracy1000: 0.3291 - 14s/epoch - 42ms/step
Epoch 19/50
323/323 - 14s - loss: 2.9941 - accuracy1000: 0.5003 - val_loss: 3.9166 - val_accuracy1000: 0.3281 - 14s/epoch - 42ms/step
Epoch 20/50
323/323 - 14s - loss: 2.9853 - accuracy1000: 0.5007 - val_loss: 4.0884 - val_accuracy1000: 0.3286 - 14s/epoch - 42ms/step
Epoch 21/50
323/323 - 14s - loss: 2.9998 - accuracy1000: 0.4985 - val_loss: 4.4971 - val_accuracy1000: 0.3276 - 14s/epoch - 43ms/step
testing model: results/CHTR/W9/deepLOB_L2/h1000
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1669911
{'0': {'precision': 0.2982793607846453, 'recall': 0.6125496494693204, 'f1-score': 0.4011969663584217, 'support': 46073}, '1': {'precision': 0.3907264854462353, 'recall': 0.32935669747714563, 'f1-score': 0.35742644159797554, 'support': 59179}, '2': {'precision': 0.31012913640032286, 'recall': 0.06253051261187957, 'f1-score': 0.10407638136511374, 'support': 49160}, 'accuracy': 0.3289057845245188, 'macro avg': {'precision': 0.3330449942104012, 'recall': 0.33481228651944855, 'f1-score': 0.2875665964405037, 'support': 154412}, 'weighted avg': {'precision': 0.33748268280375615, 'recall': 0.3289057845245188, 'f1-score': 0.28982774736592465, 'support': 154412}}
[[28222 14714  3137]
 [35987 19491  3701]
 [30407 15679  3074]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1633226
{'0': {'precision': 0.36816347557310897, 'recall': 0.30561989950465057, 'f1-score': 0.3339889007886282, 'support': 28061}, '1': {'precision': 0.3417945447813387, 'recall': 0.30440039570585864, 'f1-score': 0.32201550387596894, 'support': 27293}, '2': {'precision': 0.3569104298681281, 'recall': 0.45834096990579526, 'f1-score': 0.40131589504934606, 'support': 27281}, 'accuracy': 0.35563623162098384, 'macro avg': {'precision': 0.3556228167408586, 'recall': 0.3561204217054348, 'f1-score': 0.35244009990464775, 'support': 82635}, 'weighted avg': {'precision': 0.35573918117028486, 'recall': 0.35563623162098384, 'f1-score': 0.35226151903137565, 'support': 82635}}
[[ 8576  8209 11276]
 [ 7731  8308 11254]
 [ 6987  7790 12504]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1780748
{'0': {'precision': 0.3225013653741125, 'recall': 0.4909072014964148, 'f1-score': 0.3892711466359029, 'support': 9623}, '1': {'precision': 0.3390221402214022, 'recall': 0.30927835051546393, 'f1-score': 0.32346792826493564, 'support': 9506}, '2': {'precision': 0.32740422204847536, 'recall': 0.17997206403782098, 'f1-score': 0.23226790542882894, 'support': 9307}, 'accuracy': 0.32842171894781264, 'macro avg': {'precision': 0.32964257588133, 'recall': 0.3267192053498999, 'f1-score': 0.3150023267765558, 'support': 28436}, 'weighted avg': {'precision': 0.329628857734734, 'recall': 0.32842171894781264, 'f1-score': 0.3158868956952413, 'support': 28436}}
[[4724 2899 2000]
 [5125 2940 1441]
 [4799 2833 1675]]
training model: results/CHTR/W9/deepOF_L2/h10
Epoch 1/50
323/323 - 10s - loss: 3.3279 - accuracy10: 0.3527 - val_loss: 3.3075 - val_accuracy10: 0.3491 - 10s/epoch - 30ms/step
Epoch 2/50
323/323 - 8s - loss: 3.2789 - accuracy10: 0.3818 - val_loss: 3.2901 - val_accuracy10: 0.3610 - 8s/epoch - 24ms/step
Epoch 3/50
323/323 - 8s - loss: 3.2537 - accuracy10: 0.3969 - val_loss: 3.2576 - val_accuracy10: 0.3832 - 8s/epoch - 24ms/step
Epoch 4/50
323/323 - 8s - loss: 3.2300 - accuracy10: 0.4123 - val_loss: 3.2481 - val_accuracy10: 0.3918 - 8s/epoch - 25ms/step
Epoch 5/50
323/323 - 8s - loss: 3.2116 - accuracy10: 0.4221 - val_loss: 3.2397 - val_accuracy10: 0.3991 - 8s/epoch - 25ms/step
Epoch 6/50
323/323 - 8s - loss: 3.1980 - accuracy10: 0.4306 - val_loss: 3.2349 - val_accuracy10: 0.4041 - 8s/epoch - 25ms/step
Epoch 7/50
323/323 - 8s - loss: 3.1833 - accuracy10: 0.4352 - val_loss: 3.2310 - val_accuracy10: 0.4040 - 8s/epoch - 24ms/step
Epoch 8/50
323/323 - 8s - loss: 3.1715 - accuracy10: 0.4416 - val_loss: 3.2265 - val_accuracy10: 0.4069 - 8s/epoch - 25ms/step
Epoch 9/50
323/323 - 8s - loss: 3.1586 - accuracy10: 0.4461 - val_loss: 3.2261 - val_accuracy10: 0.4090 - 8s/epoch - 24ms/step
Epoch 10/50
323/323 - 8s - loss: 3.1486 - accuracy10: 0.4498 - val_loss: 3.2323 - val_accuracy10: 0.4077 - 8s/epoch - 24ms/step
Epoch 11/50
323/323 - 8s - loss: 3.1367 - accuracy10: 0.4546 - val_loss: 3.2301 - val_accuracy10: 0.4095 - 8s/epoch - 24ms/step
Epoch 12/50
323/323 - 8s - loss: 3.1269 - accuracy10: 0.4577 - val_loss: 3.2341 - val_accuracy10: 0.4083 - 8s/epoch - 24ms/step
Epoch 13/50
323/323 - 8s - loss: 3.1150 - accuracy10: 0.4632 - val_loss: 3.2338 - val_accuracy10: 0.4135 - 8s/epoch - 24ms/step
Epoch 14/50
323/323 - 8s - loss: 3.1073 - accuracy10: 0.4669 - val_loss: 3.2388 - val_accuracy10: 0.4123 - 8s/epoch - 24ms/step
Epoch 15/50
323/323 - 8s - loss: 3.0979 - accuracy10: 0.4696 - val_loss: 3.2384 - val_accuracy10: 0.4102 - 8s/epoch - 24ms/step
Epoch 16/50
323/323 - 8s - loss: 3.0849 - accuracy10: 0.4749 - val_loss: 3.2463 - val_accuracy10: 0.4094 - 8s/epoch - 24ms/step
Epoch 17/50
323/323 - 8s - loss: 3.0763 - accuracy10: 0.4759 - val_loss: 3.2511 - val_accuracy10: 0.4104 - 8s/epoch - 24ms/step
Epoch 18/50
323/323 - 8s - loss: 3.0631 - accuracy10: 0.4829 - val_loss: 3.2556 - val_accuracy10: 0.4128 - 8s/epoch - 23ms/step
Epoch 19/50
323/323 - 8s - loss: 3.0542 - accuracy10: 0.4831 - val_loss: 3.2516 - val_accuracy10: 0.4139 - 8s/epoch - 24ms/step
testing model: results/CHTR/W9/deepOF_L2/h10
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0702214
{'0': {'precision': 0.431663175984104, 'recall': 0.306946194676748, 'f1-score': 0.3587752187109445, 'support': 52374}, '1': {'precision': 0.4153224137217293, 'recall': 0.5596608341545957, 'f1-score': 0.47680755338698433, 'support': 53779}, '2': {'precision': 0.42844038749804236, 'recall': 0.39685006735053363, 'f1-score': 0.4120406231173079, 'support': 48255}, 'accuracy': 0.42306098129630587, 'macro avg': {'precision': 0.42514199240129186, 'recall': 0.4211523653939591, 'f1-score': 0.4158744650717456, 'support': 154408}, 'weighted avg': {'precision': 0.4249646531607842, 'recall': 0.42306098129630587, 'f1-score': 0.4165311835325328, 'support': 154408}}
[[16076 23177 13121]
 [11255 30098 12426]
 [ 9911 19194 19150]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0560986
{'0': {'precision': 0.48777027688093144, 'recall': 0.33905739934711643, 'f1-score': 0.4000401203610833, 'support': 29408}, '1': {'precision': 0.3951507025335903, 'recall': 0.5438050205666397, 'f1-score': 0.4577104769300459, 'support': 26013}, '2': {'precision': 0.4643858452678639, 'recall': 0.4503931799808922, 'f1-score': 0.4572824951499776, 'support': 27214}, 'accuracy': 0.44017668058328796, 'macro avg': {'precision': 0.4491022748941285, 'recall': 0.44441853329821607, 'f1-score': 0.43834436414703565, 'support': 82635}, 'weighted avg': {'precision': 0.4509130504101212, 'recall': 0.44017668058328796, 'f1-score': 0.4370459045074304, 'support': 82635}}
[[ 9971 11725  7712]
 [ 5442 14146  6425]
 [ 5029  9928 12257]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0826894
{'0': {'precision': 0.4864044517516125, 'recall': 0.3542415031776734, 'f1-score': 0.4099339160093796, 'support': 10857}, '1': {'precision': 0.2992072699149265, 'recall': 0.4123917388407728, 'f1-score': 0.346798139951818, 'support': 7505}, '2': {'precision': 0.45640219952867245, 'recall': 0.46143154968728284, 'f1-score': 0.45890309522634154, 'support': 10073}, 'accuracy': 0.4075611042729031, 'macro avg': {'precision': 0.41400464039840384, 'recall': 0.40935493056857636, 'f1-score': 0.4052117170625131, 'support': 28435}, 'weighted avg': {'precision': 0.4263683154292632, 'recall': 0.4075611042729031, 'f1-score': 0.410617318258033, 'support': 28435}}
[[3846 3901 3110]
 [1984 3095 2426]
 [2077 3348 4648]]
training model: results/CHTR/W9/deepOF_L2/h20
Epoch 1/50
323/323 - 10s - loss: 3.3287 - accuracy20: 0.3519 - val_loss: 3.3188 - val_accuracy20: 0.3536 - 10s/epoch - 30ms/step
Epoch 2/50
323/323 - 8s - loss: 3.2828 - accuracy20: 0.3787 - val_loss: 3.2975 - val_accuracy20: 0.3667 - 8s/epoch - 26ms/step
Epoch 3/50
323/323 - 8s - loss: 3.2586 - accuracy20: 0.3923 - val_loss: 3.2826 - val_accuracy20: 0.3726 - 8s/epoch - 24ms/step
Epoch 4/50
323/323 - 8s - loss: 3.2400 - accuracy20: 0.4018 - val_loss: 3.2690 - val_accuracy20: 0.3847 - 8s/epoch - 24ms/step
Epoch 5/50
323/323 - 8s - loss: 3.2233 - accuracy20: 0.4118 - val_loss: 3.2645 - val_accuracy20: 0.3869 - 8s/epoch - 24ms/step
Epoch 6/50
323/323 - 8s - loss: 3.2115 - accuracy20: 0.4173 - val_loss: 3.2611 - val_accuracy20: 0.3893 - 8s/epoch - 24ms/step
Epoch 7/50
323/323 - 8s - loss: 3.1981 - accuracy20: 0.4230 - val_loss: 3.2598 - val_accuracy20: 0.3902 - 8s/epoch - 24ms/step
Epoch 8/50
323/323 - 8s - loss: 3.1891 - accuracy20: 0.4271 - val_loss: 3.2539 - val_accuracy20: 0.3924 - 8s/epoch - 24ms/step
Epoch 9/50
323/323 - 8s - loss: 3.1789 - accuracy20: 0.4323 - val_loss: 3.2611 - val_accuracy20: 0.3885 - 8s/epoch - 24ms/step
Epoch 10/50
323/323 - 8s - loss: 3.1688 - accuracy20: 0.4351 - val_loss: 3.2624 - val_accuracy20: 0.3887 - 8s/epoch - 24ms/step
Epoch 11/50
323/323 - 8s - loss: 3.1575 - accuracy20: 0.4426 - val_loss: 3.2680 - val_accuracy20: 0.3901 - 8s/epoch - 24ms/step
Epoch 12/50
323/323 - 8s - loss: 3.1485 - accuracy20: 0.4468 - val_loss: 3.2688 - val_accuracy20: 0.3919 - 8s/epoch - 24ms/step
Epoch 13/50
323/323 - 8s - loss: 3.1375 - accuracy20: 0.4497 - val_loss: 3.2773 - val_accuracy20: 0.3893 - 8s/epoch - 24ms/step
Epoch 14/50
323/323 - 8s - loss: 3.1302 - accuracy20: 0.4533 - val_loss: 3.2854 - val_accuracy20: 0.3885 - 8s/epoch - 24ms/step
Epoch 15/50
323/323 - 8s - loss: 3.1199 - accuracy20: 0.4572 - val_loss: 3.2912 - val_accuracy20: 0.3864 - 8s/epoch - 24ms/step
Epoch 16/50
323/323 - 8s - loss: 3.1076 - accuracy20: 0.4637 - val_loss: 3.2996 - val_accuracy20: 0.3862 - 8s/epoch - 24ms/step
Epoch 17/50
323/323 - 8s - loss: 3.1008 - accuracy20: 0.4661 - val_loss: 3.3052 - val_accuracy20: 0.3856 - 8s/epoch - 24ms/step
Epoch 18/50
323/323 - 8s - loss: 3.0902 - accuracy20: 0.4686 - val_loss: 3.3080 - val_accuracy20: 0.3892 - 8s/epoch - 24ms/step
testing model: results/CHTR/W9/deepOF_L2/h20
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0706202
{'0': {'precision': 0.4044368600682594, 'recall': 0.28610304047141627, 'f1-score': 0.33513085993672703, 'support': 48874}, '1': {'precision': 0.4337546349826562, 'recall': 0.5477569105281708, 'f1-score': 0.4841351074718526, 'support': 59583}, '2': {'precision': 0.40019286403085824, 'recall': 0.3883484581401928, 'f1-score': 0.3941817057277285, 'support': 45951}, 'accuracy': 0.41749779804155224, 'macro avg': {'precision': 0.41279478636059125, 'recall': 0.40740280304659326, 'f1-score': 0.4044825577121027, 'support': 154408}, 'weighted avg': {'precision': 0.4144870201688363, 'recall': 0.41749779804155224, 'f1-score': 0.41020187630781985, 'support': 154408}}
[[13983 23032 11859]
 [12059 32637 14887]
 [ 8532 19574 17845]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0600706
{'0': {'precision': 0.4675, 'recall': 0.3261021205357143, 'f1-score': 0.38420447074293235, 'support': 28672}, '1': {'precision': 0.4006375903482013, 'recall': 0.5235034294538011, 'f1-score': 0.45390291745804406, 'support': 27847}, '2': {'precision': 0.4460530326120085, 'recall': 0.448307550926635, 'f1-score': 0.4471774501565961, 'support': 26116}, 'accuracy': 0.43124584014037637, 'macro avg': {'precision': 0.4380635409867366, 'recall': 0.43263770030538345, 'f1-score': 0.4284282794525242, 'support': 82635}, 'weighted avg': {'precision': 0.43819006447778275, 'recall': 0.43124584014037637, 'f1-score': 0.42759401483493886, 'support': 82635}}
[[ 9350 12038  7284]
 [ 6013 14578  7256]
 [ 4637  9771 11708]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.084768
{'0': {'precision': 0.46719195761445453, 'recall': 0.3252317003972007, 'f1-score': 0.383495957624756, 'support': 10574}, '1': {'precision': 0.2973123779410397, 'recall': 0.39615861214374226, 'f1-score': 0.33969080380385697, 'support': 8070}, '2': {'precision': 0.43290378839259763, 'recall': 0.4563374527627413, 'f1-score': 0.44431185361972947, 'support': 9791}, 'accuracy': 0.39050465975030774, 'macro avg': {'precision': 0.3991360413160306, 'recall': 0.39257592176789474, 'f1-score': 0.38916620501611415, 'support': 28435}, 'weighted avg': {'precision': 0.40717283776864266, 'recall': 0.39050465975030774, 'f1-score': 0.39200451561146704, 'support': 28435}}
[[3439 4093 3042]
 [2062 3197 2811]
 [1860 3463 4468]]
training model: results/CHTR/W9/deepOF_L2/h30
Epoch 1/50
323/323 - 10s - loss: 3.3303 - accuracy30: 0.3486 - val_loss: 3.3187 - val_accuracy30: 0.3517 - 10s/epoch - 30ms/step
Epoch 2/50
323/323 - 10s - loss: 3.2832 - accuracy30: 0.3765 - val_loss: 3.2960 - val_accuracy30: 0.3612 - 10s/epoch - 31ms/step
Epoch 3/50
323/323 - 8s - loss: 3.2589 - accuracy30: 0.3919 - val_loss: 3.2813 - val_accuracy30: 0.3713 - 8s/epoch - 25ms/step
Epoch 4/50
323/323 - 8s - loss: 3.2428 - accuracy30: 0.4021 - val_loss: 3.2711 - val_accuracy30: 0.3770 - 8s/epoch - 24ms/step
Epoch 5/50
323/323 - 8s - loss: 3.2290 - accuracy30: 0.4109 - val_loss: 3.2711 - val_accuracy30: 0.3849 - 8s/epoch - 24ms/step
Epoch 6/50
323/323 - 8s - loss: 3.2205 - accuracy30: 0.4162 - val_loss: 3.2694 - val_accuracy30: 0.3871 - 8s/epoch - 24ms/step
Epoch 7/50
323/323 - 8s - loss: 3.2095 - accuracy30: 0.4193 - val_loss: 3.2633 - val_accuracy30: 0.3914 - 8s/epoch - 24ms/step
Epoch 8/50
323/323 - 8s - loss: 3.2002 - accuracy30: 0.4244 - val_loss: 3.2613 - val_accuracy30: 0.3885 - 8s/epoch - 24ms/step
Epoch 9/50
323/323 - 8s - loss: 3.1897 - accuracy30: 0.4297 - val_loss: 3.2630 - val_accuracy30: 0.3904 - 8s/epoch - 24ms/step
Epoch 10/50
323/323 - 8s - loss: 3.1832 - accuracy30: 0.4342 - val_loss: 3.2671 - val_accuracy30: 0.3912 - 8s/epoch - 24ms/step
Epoch 11/50
323/323 - 8s - loss: 3.1748 - accuracy30: 0.4368 - val_loss: 3.2680 - val_accuracy30: 0.3931 - 8s/epoch - 24ms/step
Epoch 12/50
323/323 - 8s - loss: 3.1646 - accuracy30: 0.4428 - val_loss: 3.2723 - val_accuracy30: 0.3904 - 8s/epoch - 24ms/step
Epoch 13/50
323/323 - 8s - loss: 3.1565 - accuracy30: 0.4447 - val_loss: 3.2730 - val_accuracy30: 0.3937 - 8s/epoch - 24ms/step
Epoch 14/50
323/323 - 8s - loss: 3.1452 - accuracy30: 0.4507 - val_loss: 3.2824 - val_accuracy30: 0.3894 - 8s/epoch - 24ms/step
Epoch 15/50
323/323 - 8s - loss: 3.1368 - accuracy30: 0.4545 - val_loss: 3.2897 - val_accuracy30: 0.3855 - 8s/epoch - 24ms/step
Epoch 16/50
323/323 - 8s - loss: 3.1273 - accuracy30: 0.4568 - val_loss: 3.2978 - val_accuracy30: 0.3844 - 8s/epoch - 24ms/step
Epoch 17/50
323/323 - 8s - loss: 3.1204 - accuracy30: 0.4605 - val_loss: 3.3033 - val_accuracy30: 0.3845 - 8s/epoch - 24ms/step
Epoch 18/50
323/323 - 8s - loss: 3.1089 - accuracy30: 0.4639 - val_loss: 3.3077 - val_accuracy30: 0.3874 - 8s/epoch - 24ms/step
testing model: results/CHTR/W9/deepOF_L2/h30
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0782866
{'0': {'precision': 0.4077240566037736, 'recall': 0.2535805235815422, 'f1-score': 0.31268762639267456, 'support': 49085}, '1': {'precision': 0.41517630077668566, 'recall': 0.507017190437819, 'f1-score': 0.4565235464391254, 'support': 59568}, '2': {'precision': 0.37602424953554314, 'recall': 0.420238225330565, 'f1-score': 0.39690370523273816, 'support': 45755}, 'accuracy': 0.4007370084451583, 'macro avg': {'precision': 0.3996415356386674, 'recall': 0.3936119797833087, 'f1-score': 0.388704959354846, 'support': 154408}, 'weighted avg': {'precision': 0.4012055511408775, 'recall': 0.4007370084451583, 'f1-score': 0.3931324529084904, 'support': 154408}}
[[12447 23319 13319]
 [10778 30202 18588]
 [ 7303 19224 19228]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0661249
{'0': {'precision': 0.4670601461495222, 'recall': 0.2856897263099986, 'f1-score': 0.354524896531126, 'support': 29084}, '1': {'precision': 0.3864913998042232, 'recall': 0.5032227522668512, 'f1-score': 0.43719944317894205, 'support': 27461}, '2': {'precision': 0.4348917153661052, 'recall': 0.48489842851667303, 'f1-score': 0.4585357013410656, 'support': 26090}, 'accuracy': 0.4208749319295698, 'macro avg': {'precision': 0.42948108710661687, 'recall': 0.42460363569784093, 'f1-score': 0.41675334701704453, 'support': 82635}, 'weighted avg': {'precision': 0.43012939401631467, 'recall': 0.4208749319295698, 'f1-score': 0.4148379312378121, 'support': 82635}}
[[ 8309 12602  8173]
 [ 5376 13819  8266]
 [ 4105  9334 12651]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0894129
{'0': {'precision': 0.465414710485133, 'recall': 0.2817621980104216, 'f1-score': 0.3510179994098554, 'support': 10555}, '1': {'precision': 0.2940957347737009, 'recall': 0.3956897631875705, 'f1-score': 0.33741118649500507, 'support': 7981}, '2': {'precision': 0.432210135314407, 'recall': 0.4936862309324174, 'f1-score': 0.4609072903895124, 'support': 9899}, 'accuracy': 0.3875153859679972, 'macro avg': {'precision': 0.39724019352441364, 'recall': 0.3903793973768032, 'f1-score': 0.38311215876479093, 'support': 28435}, 'weighted avg': {'precision': 0.40577029920438895, 'recall': 0.3875153859679972, 'f1-score': 0.3854543671796533, 'support': 28435}}
[[2974 4203 3378]
 [1781 3158 3042]
 [1635 3377 4887]]
training model: results/CHTR/W9/deepOF_L2/h50
Epoch 1/50
323/323 - 10s - loss: 3.3352 - accuracy50: 0.3463 - val_loss: 3.3203 - val_accuracy50: 0.3443 - 10s/epoch - 31ms/step
Epoch 2/50
323/323 - 8s - loss: 3.2853 - accuracy50: 0.3753 - val_loss: 3.3026 - val_accuracy50: 0.3582 - 8s/epoch - 24ms/step
Epoch 3/50
323/323 - 8s - loss: 3.2662 - accuracy50: 0.3904 - val_loss: 3.2853 - val_accuracy50: 0.3676 - 8s/epoch - 24ms/step
Epoch 4/50
323/323 - 8s - loss: 3.2489 - accuracy50: 0.4006 - val_loss: 3.2807 - val_accuracy50: 0.3727 - 8s/epoch - 24ms/step
Epoch 5/50
323/323 - 8s - loss: 3.2375 - accuracy50: 0.4082 - val_loss: 3.2769 - val_accuracy50: 0.3816 - 8s/epoch - 24ms/step
Epoch 6/50
323/323 - 8s - loss: 3.2265 - accuracy50: 0.4107 - val_loss: 3.2735 - val_accuracy50: 0.3805 - 8s/epoch - 24ms/step
Epoch 7/50
323/323 - 8s - loss: 3.2186 - accuracy50: 0.4160 - val_loss: 3.2724 - val_accuracy50: 0.3822 - 8s/epoch - 24ms/step
Epoch 8/50
323/323 - 8s - loss: 3.2092 - accuracy50: 0.4202 - val_loss: 3.2676 - val_accuracy50: 0.3881 - 8s/epoch - 24ms/step
Epoch 9/50
323/323 - 8s - loss: 3.2006 - accuracy50: 0.4250 - val_loss: 3.2673 - val_accuracy50: 0.3910 - 8s/epoch - 24ms/step
Epoch 10/50
323/323 - 8s - loss: 3.1926 - accuracy50: 0.4272 - val_loss: 3.2704 - val_accuracy50: 0.3899 - 8s/epoch - 24ms/step
Epoch 11/50
323/323 - 8s - loss: 3.1852 - accuracy50: 0.4329 - val_loss: 3.2717 - val_accuracy50: 0.3905 - 8s/epoch - 24ms/step
Epoch 12/50
323/323 - 8s - loss: 3.1744 - accuracy50: 0.4371 - val_loss: 3.2799 - val_accuracy50: 0.3865 - 8s/epoch - 24ms/step
Epoch 13/50
323/323 - 8s - loss: 3.1681 - accuracy50: 0.4384 - val_loss: 3.2795 - val_accuracy50: 0.3879 - 8s/epoch - 24ms/step
Epoch 14/50
323/323 - 8s - loss: 3.1585 - accuracy50: 0.4435 - val_loss: 3.2831 - val_accuracy50: 0.3884 - 8s/epoch - 24ms/step
Epoch 15/50
323/323 - 8s - loss: 3.1464 - accuracy50: 0.4479 - val_loss: 3.2899 - val_accuracy50: 0.3847 - 8s/epoch - 24ms/step
Epoch 16/50
323/323 - 8s - loss: 3.1392 - accuracy50: 0.4536 - val_loss: 3.2985 - val_accuracy50: 0.3850 - 8s/epoch - 24ms/step
Epoch 17/50
323/323 - 8s - loss: 3.1295 - accuracy50: 0.4544 - val_loss: 3.3106 - val_accuracy50: 0.3827 - 8s/epoch - 24ms/step
Epoch 18/50
323/323 - 8s - loss: 3.1190 - accuracy50: 0.4604 - val_loss: 3.3294 - val_accuracy50: 0.3791 - 8s/epoch - 24ms/step
Epoch 19/50
323/323 - 8s - loss: 3.1085 - accuracy50: 0.4635 - val_loss: 3.3314 - val_accuracy50: 0.3840 - 8s/epoch - 24ms/step
testing model: results/CHTR/W9/deepOF_L2/h50
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0822337
{'0': {'precision': 0.40003971180575254, 'recall': 0.28939322430385983, 'f1-score': 0.33583768916618056, 'support': 48733}, '1': {'precision': 0.41518663664915645, 'recall': 0.49776741086304566, 'f1-score': 0.4527421236872812, 'support': 60020}, '2': {'precision': 0.3683998643952877, 'recall': 0.3808345197678239, 'f1-score': 0.37451400631118675, 'support': 45655}, 'accuracy': 0.3974275944251593, 'macro avg': {'precision': 0.39454207095006555, 'recall': 0.3893317183115765, 'f1-score': 0.3876979397215495, 'support': 154408}, 'weighted avg': {'precision': 0.39657228262835453, 'recall': 0.3974275944251593, 'f1-score': 0.39271538604206596, 'support': 154408}}
[[14103 22217 12413]
 [12748 29876 17396]
 [ 8403 19865 17387]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0669637
{'0': {'precision': 0.4754262788365095, 'recall': 0.3225257714421801, 'f1-score': 0.3843269211278454, 'support': 29393}, '1': {'precision': 0.373908328100919, 'recall': 0.48241705637588833, 'f1-score': 0.4212878848782057, 'support': 27157}, '2': {'precision': 0.4338503814585819, 'recall': 0.4599961663791451, 'f1-score': 0.4465408805031446, 'support': 26085}, 'accuracy': 0.4184667513765354, 'macro avg': {'precision': 0.42772832946533684, 'recall': 0.4216463313990711, 'f1-score': 0.41738522883639856, 'support': 82635}, 'weighted avg': {'precision': 0.42893955685151924, 'recall': 0.4184667513765354, 'f1-score': 0.41611248442273513, 'support': 82635}}
[[ 9480 12321  7592]
 [ 5990 13101  8066]
 [ 4470  9616 11999]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0908824
{'0': {'precision': 0.47425394967817436, 'recall': 0.3108341323106424, 'f1-score': 0.37553573497046217, 'support': 10430}, '1': {'precision': 0.2961279939411152, 'recall': 0.3874163983155809, 'f1-score': 0.3356763427590277, 'support': 8074}, '2': {'precision': 0.43077201884740846, 'recall': 0.4787030510522606, 'f1-score': 0.4534745075594983, 'support': 9931}, 'accuracy': 0.39120801828732193, 'macro avg': {'precision': 0.400384654155566, 'recall': 0.3923178605594946, 'f1-score': 0.3882288617629961, 'support': 28435}, 'weighted avg': {'precision': 0.4084896443607363, 'recall': 0.39120801828732193, 'f1-score': 0.391438151635368, 'support': 28435}}
[[3242 4000 3188]
 [1852 3128 3094]
 [1742 3435 4754]]
training model: results/CHTR/W9/deepOF_L2/h100
Epoch 1/50
323/323 - 10s - loss: 3.3406 - accuracy100: 0.3435 - val_loss: 3.3083 - val_accuracy100: 0.3536 - 10s/epoch - 30ms/step
Epoch 2/50
323/323 - 8s - loss: 3.2951 - accuracy100: 0.3673 - val_loss: 3.3010 - val_accuracy100: 0.3605 - 8s/epoch - 24ms/step
Epoch 3/50
323/323 - 8s - loss: 3.2760 - accuracy100: 0.3816 - val_loss: 3.2891 - val_accuracy100: 0.3687 - 8s/epoch - 24ms/step
Epoch 4/50
323/323 - 8s - loss: 3.2614 - accuracy100: 0.3905 - val_loss: 3.2823 - val_accuracy100: 0.3757 - 8s/epoch - 24ms/step
Epoch 5/50
323/323 - 8s - loss: 3.2499 - accuracy100: 0.3993 - val_loss: 3.2767 - val_accuracy100: 0.3825 - 8s/epoch - 24ms/step
Epoch 6/50
323/323 - 8s - loss: 3.2416 - accuracy100: 0.4035 - val_loss: 3.2752 - val_accuracy100: 0.3856 - 8s/epoch - 24ms/step
Epoch 7/50
323/323 - 8s - loss: 3.2332 - accuracy100: 0.4102 - val_loss: 3.2760 - val_accuracy100: 0.3855 - 8s/epoch - 24ms/step
Epoch 8/50
323/323 - 8s - loss: 3.2252 - accuracy100: 0.4131 - val_loss: 3.2715 - val_accuracy100: 0.3913 - 8s/epoch - 24ms/step
Epoch 9/50
323/323 - 8s - loss: 3.2176 - accuracy100: 0.4178 - val_loss: 3.2759 - val_accuracy100: 0.3857 - 8s/epoch - 24ms/step
Epoch 10/50
323/323 - 8s - loss: 3.2085 - accuracy100: 0.4221 - val_loss: 3.2811 - val_accuracy100: 0.3854 - 8s/epoch - 24ms/step
Epoch 11/50
323/323 - 8s - loss: 3.2033 - accuracy100: 0.4257 - val_loss: 3.2815 - val_accuracy100: 0.3863 - 8s/epoch - 24ms/step
Epoch 12/50
323/323 - 8s - loss: 3.1957 - accuracy100: 0.4283 - val_loss: 3.2850 - val_accuracy100: 0.3874 - 8s/epoch - 24ms/step
Epoch 13/50
323/323 - 8s - loss: 3.1864 - accuracy100: 0.4339 - val_loss: 3.2884 - val_accuracy100: 0.3859 - 8s/epoch - 24ms/step
Epoch 14/50
323/323 - 8s - loss: 3.1780 - accuracy100: 0.4362 - val_loss: 3.2930 - val_accuracy100: 0.3849 - 8s/epoch - 24ms/step
Epoch 15/50
323/323 - 8s - loss: 3.1702 - accuracy100: 0.4394 - val_loss: 3.3021 - val_accuracy100: 0.3844 - 8s/epoch - 24ms/step
Epoch 16/50
323/323 - 8s - loss: 3.1609 - accuracy100: 0.4454 - val_loss: 3.3040 - val_accuracy100: 0.3829 - 8s/epoch - 24ms/step
Epoch 17/50
323/323 - 8s - loss: 3.1516 - accuracy100: 0.4481 - val_loss: 3.3152 - val_accuracy100: 0.3797 - 8s/epoch - 24ms/step
Epoch 18/50
323/323 - 8s - loss: 3.1382 - accuracy100: 0.4543 - val_loss: 3.3224 - val_accuracy100: 0.3825 - 8s/epoch - 24ms/step
testing model: results/CHTR/W9/deepOF_L2/h100
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.089266
{'0': {'precision': 0.38483064749589885, 'recall': 0.33151835072114383, 'f1-score': 0.35619068884671207, 'support': 48118}, '1': {'precision': 0.4091445015087628, 'recall': 0.33934431663738523, 'f1-score': 0.3709898074745187, 'support': 60334}, '2': {'precision': 0.3412699674163554, 'recall': 0.4672077639481243, 'f1-score': 0.3944301053540428, 'support': 45956}, 'accuracy': 0.3749611419097456, 'macro avg': {'precision': 0.3784150388070057, 'recall': 0.37935681043555114, 'f1-score': 0.3738702005584245, 'support': 154408}, 'weighted avg': {'precision': 0.381366302735761, 'recall': 0.3749611419097456, 'f1-score': 0.3733544410376671, 'support': 154408}}
[[15952 15520 16646]
 [15062 20474 24798]
 [10438 14047 21471]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0736527
{'0': {'precision': 0.4520041536863967, 'recall': 0.3718689129617606, 'f1-score': 0.40803929656155086, 'support': 29263}, '1': {'precision': 0.38575924468922107, 'recall': 0.35977399471675964, 'f1-score': 0.3723137671804997, 'support': 27256}, '2': {'precision': 0.40869040434520215, 'recall': 0.5186092816664114, 'f1-score': 0.45713514243283376, 'support': 26116}, 'accuracy': 0.4142554607611787, 'macro avg': {'precision': 0.41548460090693995, 'recall': 0.4167507297816439, 'f1-score': 0.4124960687249615, 'support': 82635}, 'weighted avg': {'precision': 0.4164653006892205, 'recall': 0.4142554607611787, 'f1-score': 0.41177200161345984, 'support': 82635}}
[[10882  8811  9570]
 [ 7424  9806 10026]
 [ 5769  6803 13544]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.092405
{'0': {'precision': 0.4313039421506881, 'recall': 0.3615565115369574, 'f1-score': 0.393362408254441, 'support': 10228}, '1': {'precision': 0.2977591036414566, 'recall': 0.2575720862612067, 'f1-score': 0.27621151097830327, 'support': 8254}, '2': {'precision': 0.41003065796714094, 'recall': 0.5240630965538029, 'f1-score': 0.4600864426215049, 'support': 9953}, 'accuracy': 0.38825391243186214, 'macro avg': {'precision': 0.3796979012530952, 'recall': 0.3810638981173223, 'f1-score': 0.3765534539514164, 'support': 28435}, 'weighted avg': {'precision': 0.3850928609291639, 'recall': 0.38825391243186214, 'f1-score': 0.38271147834194397, 'support': 28435}}
[[3698 2716 3814]
 [2437 2126 3691]
 [2439 2298 5216]]
training model: results/CHTR/W9/deepOF_L2/h200
Epoch 1/50
323/323 - 10s - loss: 3.3413 - accuracy200: 0.3453 - val_loss: 3.3146 - val_accuracy200: 0.3496 - 10s/epoch - 30ms/step
Epoch 2/50
323/323 - 8s - loss: 3.3021 - accuracy200: 0.3655 - val_loss: 3.3073 - val_accuracy200: 0.3534 - 8s/epoch - 25ms/step
Epoch 3/50
323/323 - 8s - loss: 3.2871 - accuracy200: 0.3729 - val_loss: 3.2965 - val_accuracy200: 0.3619 - 8s/epoch - 25ms/step
Epoch 4/50
323/323 - 8s - loss: 3.2739 - accuracy200: 0.3795 - val_loss: 3.2975 - val_accuracy200: 0.3648 - 8s/epoch - 24ms/step
Epoch 5/50
323/323 - 8s - loss: 3.2656 - accuracy200: 0.3854 - val_loss: 3.2899 - val_accuracy200: 0.3716 - 8s/epoch - 24ms/step
Epoch 6/50
323/323 - 8s - loss: 3.2580 - accuracy200: 0.3914 - val_loss: 3.2899 - val_accuracy200: 0.3697 - 8s/epoch - 24ms/step
Epoch 7/50
323/323 - 8s - loss: 3.2495 - accuracy200: 0.3976 - val_loss: 3.2895 - val_accuracy200: 0.3698 - 8s/epoch - 24ms/step
Epoch 8/50
323/323 - 8s - loss: 3.2421 - accuracy200: 0.4006 - val_loss: 3.2923 - val_accuracy200: 0.3703 - 8s/epoch - 24ms/step
Epoch 9/50
323/323 - 8s - loss: 3.2365 - accuracy200: 0.4042 - val_loss: 3.2953 - val_accuracy200: 0.3706 - 8s/epoch - 24ms/step
Epoch 10/50
323/323 - 8s - loss: 3.2297 - accuracy200: 0.4087 - val_loss: 3.2966 - val_accuracy200: 0.3739 - 8s/epoch - 24ms/step
Epoch 11/50
323/323 - 8s - loss: 3.2247 - accuracy200: 0.4129 - val_loss: 3.2969 - val_accuracy200: 0.3726 - 8s/epoch - 24ms/step
Epoch 12/50
323/323 - 8s - loss: 3.2162 - accuracy200: 0.4159 - val_loss: 3.2980 - val_accuracy200: 0.3746 - 8s/epoch - 24ms/step
Epoch 13/50
323/323 - 8s - loss: 3.2079 - accuracy200: 0.4192 - val_loss: 3.3007 - val_accuracy200: 0.3708 - 8s/epoch - 24ms/step
Epoch 14/50
323/323 - 8s - loss: 3.2018 - accuracy200: 0.4247 - val_loss: 3.3074 - val_accuracy200: 0.3707 - 8s/epoch - 24ms/step
Epoch 15/50
323/323 - 8s - loss: 3.1956 - accuracy200: 0.4267 - val_loss: 3.3126 - val_accuracy200: 0.3668 - 8s/epoch - 24ms/step
Epoch 16/50
323/323 - 8s - loss: 3.1827 - accuracy200: 0.4334 - val_loss: 3.3163 - val_accuracy200: 0.3677 - 8s/epoch - 24ms/step
Epoch 17/50
323/323 - 8s - loss: 3.1776 - accuracy200: 0.4343 - val_loss: 3.3229 - val_accuracy200: 0.3633 - 8s/epoch - 24ms/step
testing model: results/CHTR/W9/deepOF_L2/h200
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096995
{'0': {'precision': 0.35015138506032806, 'recall': 0.32822891515228536, 'f1-score': 0.33883592793423123, 'support': 47214}, '1': {'precision': 0.399880189035078, 'recall': 0.29840886136728645, 'f1-score': 0.3417719118595214, 'support': 60397}, '2': {'precision': 0.32887721077459703, 'recall': 0.4573583776737825, 'f1-score': 0.3826200436197218, 'support': 46797}, 'accuracy': 0.35570048184031916, 'macro avg': {'precision': 0.35963626162333434, 'recall': 0.36133205139778485, 'f1-score': 0.3544092944711581, 'support': 154408}, 'weighted avg': {'precision': 0.3631552646495567, 'recall': 0.35570048184031916, 'f1-score': 0.3532541568010623, 'support': 154408}}
[[15497 13974 17743]
 [16441 18023 25933]
 [12320 13074 21403]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0812163
{'0': {'precision': 0.43004458228338827, 'recall': 0.38092785275230934, 'f1-score': 0.4039988345837279, 'support': 29121}, '1': {'precision': 0.38031281140331874, 'recall': 0.3246301775147929, 'f1-score': 0.3502723409349375, 'support': 27040}, '2': {'precision': 0.39017743416570394, 'recall': 0.49754476089748434, 'f1-score': 0.4373682200786944, 'support': 26474}, 'accuracy': 0.39986688449204333, 'macro avg': {'precision': 0.40017827595080363, 'recall': 0.4010342637215289, 'f1-score': 0.39721313186578655, 'support': 82635}, 'weighted avg': {'precision': 0.40099889989862814, 'recall': 0.39986688449204333, 'f1-score': 0.39710897826776553, 'support': 82635}}
[[11093  7770 10258]
 [ 7933  8778 10329]
 [ 6769  6533 13172]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0976642
{'0': {'precision': 0.38834416657485954, 'recall': 0.34973707709098123, 'f1-score': 0.368030904155356, 'support': 10079}, '1': {'precision': 0.3152319856780546, 'recall': 0.24967505612666904, 'f1-score': 0.2786496109719109, 'support': 8463}, '2': {'precision': 0.3890952192809166, 'recall': 0.4977256646113414, 'f1-score': 0.4367571403228668, 'support': 9893}, 'accuracy': 0.37144364339722175, 'macro avg': {'precision': 0.3642237905112769, 'recall': 0.3657125992763306, 'f1-score': 0.3611458851500446, 'support': 28435}, 'weighted avg': {'precision': 0.3668453720431684, 'recall': 0.37144364339722175, 'f1-score': 0.3653396704712937, 'support': 28435}}
[[3525 2479 4075]
 [2694 2113 3656]
 [2858 2111 4924]]
training model: results/CHTR/W9/deepOF_L2/h300
Epoch 1/50
323/323 - 10s - loss: 3.3423 - accuracy300: 0.3448 - val_loss: 3.3250 - val_accuracy300: 0.3402 - 10s/epoch - 30ms/step
Epoch 2/50
323/323 - 8s - loss: 3.3092 - accuracy300: 0.3584 - val_loss: 3.3139 - val_accuracy300: 0.3475 - 8s/epoch - 24ms/step
Epoch 3/50
323/323 - 8s - loss: 3.2935 - accuracy300: 0.3679 - val_loss: 3.3084 - val_accuracy300: 0.3527 - 8s/epoch - 24ms/step
Epoch 4/50
323/323 - 8s - loss: 3.2809 - accuracy300: 0.3748 - val_loss: 3.3091 - val_accuracy300: 0.3501 - 8s/epoch - 24ms/step
Epoch 5/50
323/323 - 8s - loss: 3.2725 - accuracy300: 0.3796 - val_loss: 3.3070 - val_accuracy300: 0.3534 - 8s/epoch - 24ms/step
Epoch 6/50
323/323 - 8s - loss: 3.2661 - accuracy300: 0.3858 - val_loss: 3.3085 - val_accuracy300: 0.3560 - 8s/epoch - 24ms/step
Epoch 7/50
323/323 - 8s - loss: 3.2596 - accuracy300: 0.3895 - val_loss: 3.3081 - val_accuracy300: 0.3569 - 8s/epoch - 25ms/step
Epoch 8/50
323/323 - 8s - loss: 3.2530 - accuracy300: 0.3938 - val_loss: 3.3076 - val_accuracy300: 0.3612 - 8s/epoch - 24ms/step
Epoch 9/50
323/323 - 8s - loss: 3.2483 - accuracy300: 0.3971 - val_loss: 3.3124 - val_accuracy300: 0.3616 - 8s/epoch - 24ms/step
Epoch 10/50
323/323 - 8s - loss: 3.2396 - accuracy300: 0.4057 - val_loss: 3.3123 - val_accuracy300: 0.3614 - 8s/epoch - 24ms/step
Epoch 11/50
323/323 - 8s - loss: 3.2348 - accuracy300: 0.4067 - val_loss: 3.3164 - val_accuracy300: 0.3608 - 8s/epoch - 24ms/step
Epoch 12/50
323/323 - 8s - loss: 3.2278 - accuracy300: 0.4099 - val_loss: 3.3184 - val_accuracy300: 0.3617 - 8s/epoch - 24ms/step
Epoch 13/50
323/323 - 8s - loss: 3.2204 - accuracy300: 0.4127 - val_loss: 3.3236 - val_accuracy300: 0.3622 - 8s/epoch - 24ms/step
Epoch 14/50
323/323 - 8s - loss: 3.2114 - accuracy300: 0.4191 - val_loss: 3.3320 - val_accuracy300: 0.3610 - 8s/epoch - 24ms/step
Epoch 15/50
323/323 - 8s - loss: 3.2072 - accuracy300: 0.4194 - val_loss: 3.3381 - val_accuracy300: 0.3584 - 8s/epoch - 24ms/step
testing model: results/CHTR/W9/deepOF_L2/h300
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1014626
{'0': {'precision': 0.33302004216729747, 'recall': 0.28206893584061277, 'f1-score': 0.3054342128254412, 'support': 46478}, '1': {'precision': 0.3903449704754998, 'recall': 0.25587830840534437, 'f1-score': 0.30912167358867865, 'support': 58903}, '2': {'precision': 0.33162804694553116, 'recall': 0.516980439349746, 'f1-score': 0.40406198189006504, 'support': 49027}, 'accuracy': 0.34666597585617326, 'macro avg': {'precision': 0.3516643531961095, 'recall': 0.3516425611985678, 'f1-score': 0.3395392894347283, 'support': 154408}, 'weighted avg': {'precision': 0.3544461658292872, 'recall': 0.34666597585617326, 'f1-score': 0.33815677988976617, 'support': 154408}}
[[13110 11755 21613]
 [14361 15072 29470]
 [11896 11785 25346]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0895866
{'0': {'precision': 0.41767533693879305, 'recall': 0.3381519963860027, 'f1-score': 0.373730196831493, 'support': 28777}, '1': {'precision': 0.3766818411734952, 'recall': 0.27449318098046444, 'f1-score': 0.31756929637526654, 'support': 27130}, '2': {'precision': 0.368059241286931, 'recall': 0.5448593235558216, 'f1-score': 0.43933931669054976, 'support': 26728}, 'accuracy': 0.38411084891389846, 'macro avg': {'precision': 0.38747213979973977, 'recall': 0.38583483364076293, 'f1-score': 0.3768796032991031, 'support': 82635}, 'weighted avg': {'precision': 0.38816855960841845, 'recall': 0.38411084891389846, 'f1-score': 0.37651298047299414, 'support': 82635}}
[[ 9731  6618 12428]
 [ 7107  7447 12576]
 [ 6460  5705 14563]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1044695
{'0': {'precision': 0.37467411545623835, 'recall': 0.30441799475489206, 'f1-score': 0.33591184818298175, 'support': 9914}, '1': {'precision': 0.3047407912687585, 'recall': 0.20566233168373807, 'f1-score': 0.2455851027279599, 'support': 8689}, '2': {'precision': 0.35670983742077705, 'recall': 0.5266476810414972, 'f1-score': 0.42533267619517007, 'support': 9832}, 'accuracy': 0.3510814137506594, 'macro avg': {'precision': 0.345374914715258, 'recall': 0.3455760024933758, 'f1-score': 0.3356098757020372, 'support': 28435}, 'weighted avg': {'precision': 0.3470927743094239, 'recall': 0.3510814137506594, 'f1-score': 0.33922946695411416, 'support': 28435}}
[[3018 2077 4819]
 [2383 1787 4519]
 [2654 2000 5178]]
training model: results/CHTR/W9/deepOF_L2/h500
Epoch 1/50
323/323 - 10s - loss: 3.3442 - accuracy500: 0.3397 - val_loss: 3.3333 - val_accuracy500: 0.3339 - 10s/epoch - 30ms/step
Epoch 2/50
323/323 - 8s - loss: 3.3172 - accuracy500: 0.3477 - val_loss: 3.3252 - val_accuracy500: 0.3340 - 8s/epoch - 24ms/step
Epoch 3/50
323/323 - 8s - loss: 3.3018 - accuracy500: 0.3566 - val_loss: 3.3210 - val_accuracy500: 0.3367 - 8s/epoch - 25ms/step
Epoch 4/50
323/323 - 8s - loss: 3.2912 - accuracy500: 0.3652 - val_loss: 3.3231 - val_accuracy500: 0.3371 - 8s/epoch - 24ms/step
Epoch 5/50
323/323 - 8s - loss: 3.2820 - accuracy500: 0.3700 - val_loss: 3.3228 - val_accuracy500: 0.3413 - 8s/epoch - 24ms/step
Epoch 6/50
323/323 - 8s - loss: 3.2764 - accuracy500: 0.3759 - val_loss: 3.3201 - val_accuracy500: 0.3449 - 8s/epoch - 24ms/step
Epoch 7/50
323/323 - 8s - loss: 3.2683 - accuracy500: 0.3798 - val_loss: 3.3273 - val_accuracy500: 0.3401 - 8s/epoch - 24ms/step
Epoch 8/50
323/323 - 8s - loss: 3.2608 - accuracy500: 0.3871 - val_loss: 3.3285 - val_accuracy500: 0.3390 - 8s/epoch - 24ms/step
Epoch 9/50
323/323 - 8s - loss: 3.2565 - accuracy500: 0.3898 - val_loss: 3.3315 - val_accuracy500: 0.3444 - 8s/epoch - 24ms/step
Epoch 10/50
323/323 - 8s - loss: 3.2483 - accuracy500: 0.3968 - val_loss: 3.3339 - val_accuracy500: 0.3403 - 8s/epoch - 24ms/step
Epoch 11/50
323/323 - 8s - loss: 3.2421 - accuracy500: 0.4012 - val_loss: 3.3391 - val_accuracy500: 0.3419 - 8s/epoch - 24ms/step
Epoch 12/50
323/323 - 8s - loss: 3.2355 - accuracy500: 0.4057 - val_loss: 3.3459 - val_accuracy500: 0.3408 - 8s/epoch - 24ms/step
Epoch 13/50
323/323 - 8s - loss: 3.2302 - accuracy500: 0.4081 - val_loss: 3.3511 - val_accuracy500: 0.3405 - 8s/epoch - 24ms/step
Epoch 14/50
323/323 - 8s - loss: 3.2229 - accuracy500: 0.4114 - val_loss: 3.3552 - val_accuracy500: 0.3386 - 8s/epoch - 24ms/step
Epoch 15/50
323/323 - 8s - loss: 3.2170 - accuracy500: 0.4142 - val_loss: 3.3639 - val_accuracy500: 0.3424 - 8s/epoch - 24ms/step
Epoch 16/50
323/323 - 8s - loss: 3.2076 - accuracy500: 0.4225 - val_loss: 3.3639 - val_accuracy500: 0.3410 - 8s/epoch - 24ms/step
testing model: results/CHTR/W9/deepOF_L2/h500
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1016521
{'0': {'precision': 0.31607966014883554, 'recall': 0.2287115761935906, 'f1-score': 0.26539001530463824, 'support': 45870}, '1': {'precision': 0.38921986317110685, 'recall': 0.37719072827260114, 'f1-score': 0.383110894569246, 'support': 58371}, '2': {'precision': 0.3320494972931168, 'recall': 0.4279107780014751, 'f1-score': 0.3739341735108912, 'support': 50167}, 'accuracy': 0.34956090358012537, 'macro avg': {'precision': 0.3457830068710197, 'recall': 0.3446043608225556, 'f1-score': 0.3408116944615918, 'support': 154408}, 'weighted avg': {'precision': 0.34891750281650913, 'recall': 0.34956090358012537, 'f1-score': 0.345158033984289, 'support': 154408}}
[[10491 16541 18838]
 [12009 22017 24345]
 [10691 18009 21467]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0890043
{'0': {'precision': 0.40979084114962133, 'recall': 0.2881021228577474, 'f1-score': 0.33833730199813644, 'support': 28358}, '1': {'precision': 0.36328221836597374, 'recall': 0.3764956323864053, 'f1-score': 0.3697709208225943, 'support': 27246}, '2': {'precision': 0.37535184701546676, 'recall': 0.4785246568754393, 'f1-score': 0.4207051323749431, 'support': 27031}, 'accuracy': 0.3795365160041145, 'macro avg': {'precision': 0.38280830217702055, 'recall': 0.381040804039864, 'f1-score': 0.3762711183985579, 'support': 82635}, 'weighted avg': {'precision': 0.3831908001645231, 'recall': 0.3795365160041145, 'f1-score': 0.3756450432870169, 'support': 82635}}
[[ 8170  9413 10775]
 [ 6237 10258 10751]
 [ 5530  8566 12935]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1089479
{'0': {'precision': 0.35179865955409656, 'recall': 0.2662801532249715, 'f1-score': 0.3031231585150265, 'support': 9659}, '1': {'precision': 0.3237745915305102, 'recall': 0.31704397039616894, 'f1-score': 0.3203739345614518, 'support': 9188}, '2': {'precision': 0.34641708584151065, 'recall': 0.4381518564872758, 'f1-score': 0.386921482845959, 'support': 9588}, 'accuracy': 0.34063653947599787, 'macro avg': {'precision': 0.34066344564203915, 'recall': 0.34049199336947206, 'f1-score': 0.3368061919741458, 'support': 28435}, 'weighted avg': {'precision': 0.3409288278060049, 'recall': 0.34063653947599787, 'f1-score': 0.33695324341038563, 'support': 28435}}
[[2572 3098 3989]
 [2338 2913 3937]
 [2401 2986 4201]]
training model: results/CHTR/W9/deepOF_L2/h1000
Epoch 1/50
323/323 - 10s - loss: 3.3550 - accuracy1000: 0.3377 - val_loss: 3.3338 - val_accuracy1000: 0.3333 - 10s/epoch - 30ms/step
Epoch 2/50
323/323 - 8s - loss: 3.3239 - accuracy1000: 0.3474 - val_loss: 3.3257 - val_accuracy1000: 0.3325 - 8s/epoch - 24ms/step
Epoch 3/50
323/323 - 8s - loss: 3.3095 - accuracy1000: 0.3543 - val_loss: 3.3178 - val_accuracy1000: 0.3380 - 8s/epoch - 24ms/step
Epoch 4/50
323/323 - 8s - loss: 3.3010 - accuracy1000: 0.3589 - val_loss: 3.3184 - val_accuracy1000: 0.3361 - 8s/epoch - 24ms/step
Epoch 5/50
323/323 - 8s - loss: 3.2926 - accuracy1000: 0.3644 - val_loss: 3.3145 - val_accuracy1000: 0.3304 - 8s/epoch - 24ms/step
Epoch 6/50
323/323 - 8s - loss: 3.2857 - accuracy1000: 0.3680 - val_loss: 3.3160 - val_accuracy1000: 0.3349 - 8s/epoch - 24ms/step
Epoch 7/50
323/323 - 8s - loss: 3.2794 - accuracy1000: 0.3719 - val_loss: 3.3168 - val_accuracy1000: 0.3357 - 8s/epoch - 24ms/step
Epoch 8/50
323/323 - 8s - loss: 3.2737 - accuracy1000: 0.3760 - val_loss: 3.3204 - val_accuracy1000: 0.3318 - 8s/epoch - 24ms/step
Epoch 9/50
323/323 - 8s - loss: 3.2705 - accuracy1000: 0.3822 - val_loss: 3.3215 - val_accuracy1000: 0.3342 - 8s/epoch - 24ms/step
Epoch 10/50
323/323 - 8s - loss: 3.2635 - accuracy1000: 0.3860 - val_loss: 3.3203 - val_accuracy1000: 0.3376 - 8s/epoch - 24ms/step
Epoch 11/50
323/323 - 8s - loss: 3.2591 - accuracy1000: 0.3891 - val_loss: 3.3260 - val_accuracy1000: 0.3340 - 8s/epoch - 24ms/step
Epoch 12/50
323/323 - 8s - loss: 3.2532 - accuracy1000: 0.3915 - val_loss: 3.3273 - val_accuracy1000: 0.3354 - 8s/epoch - 24ms/step
Epoch 13/50
323/323 - 8s - loss: 3.2464 - accuracy1000: 0.3963 - val_loss: 3.3290 - val_accuracy1000: 0.3355 - 8s/epoch - 24ms/step
Epoch 14/50
323/323 - 8s - loss: 3.2413 - accuracy1000: 0.3996 - val_loss: 3.3324 - val_accuracy1000: 0.3346 - 8s/epoch - 24ms/step
Epoch 15/50
323/323 - 8s - loss: 3.2340 - accuracy1000: 0.4030 - val_loss: 3.3394 - val_accuracy1000: 0.3355 - 8s/epoch - 24ms/step
testing model: results/CHTR/W9/deepOF_L2/h1000
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001835
{'0': {'precision': 0.2916808811345582, 'recall': 0.1299081851924204, 'f1-score': 0.1797567202282625, 'support': 46071}, '1': {'precision': 0.3987584244186956, 'recall': 0.4309202744263071, 'f1-score': 0.41421598486140554, 'support': 59178}, '2': {'precision': 0.3178243587177214, 'recall': 0.4521654224048496, 'f1-score': 0.3732755652955154, 'support': 49159}, 'accuracy': 0.34787057665405935, 'macro avg': {'precision': 0.3360878880903251, 'recall': 0.33766462734119235, 'f1-score': 0.3224160901283945, 'support': 154408}, 'weighted avg': {'precision': 0.34104245612406264, 'recall': 0.34787057665405935, 'f1-score': 0.33122570672586127, 'support': 154408}}
[[ 5985 18044 22042]
 [ 8009 25501 25668]
 [ 6525 20406 22228]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0945362
{'0': {'precision': 0.39681328926180187, 'recall': 0.16683295324971495, 'f1-score': 0.23490454807716432, 'support': 28064}, '1': {'precision': 0.35707818569467564, 'recall': 0.4474782226776956, 'f1-score': 0.3971995256737219, 'support': 27322}, '2': {'precision': 0.35953766702188705, 'recall': 0.482880105691952, 'f1-score': 0.4121793064561601, 'support': 27249}, 'accuracy': 0.36384098747504084, 'macro avg': {'precision': 0.3711430473261215, 'recall': 0.36573042720645416, 'f1-score': 0.34809446006901545, 'support': 82635}, 'weighted avg': {'precision': 0.37138379897225793, 'recall': 0.36384098747504084, 'f1-score': 0.3470214872550236, 'support': 82635}}
[[ 4682 11333 12049]
 [ 3706 12226 11390]
 [ 3411 10680 13158]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1061463
{'0': {'precision': 0.32117293927499424, 'recall': 0.14497133923918706, 'f1-score': 0.19977021398822345, 'support': 9595}, '1': {'precision': 0.33947391727924897, 'recall': 0.40313420277660916, 'f1-score': 0.3685754122794366, 'support': 9508}, '2': {'precision': 0.32740185748848827, 'recall': 0.4495285040720103, 'f1-score': 0.3788665613005193, 'support': 9332}, 'accuracy': 0.33124670300685777, 'macro avg': {'precision': 0.32934957134757714, 'recall': 0.33254468202926885, 'f1-score': 0.3157373958560598, 'support': 28435}, 'weighted avg': {'precision': 0.3293366095275977, 'recall': 0.33124670300685777, 'f1-score': 0.3149918400993963, 'support': 28435}}
[[1391 3762 4442]
 [1499 3833 4176]
 [1441 3696 4195]]
training model: results/CHTR/W9/deepVOL_L2/h10
Epoch 1/50
323/323 - 10s - loss: 3.3318 - accuracy10: 0.3525 - val_loss: 3.3284 - val_accuracy10: 0.3209 - 10s/epoch - 30ms/step
Epoch 2/50
323/323 - 7s - loss: 3.3073 - accuracy10: 0.3603 - val_loss: 3.3094 - val_accuracy10: 0.3363 - 7s/epoch - 22ms/step
Epoch 3/50
323/323 - 7s - loss: 3.2887 - accuracy10: 0.3666 - val_loss: 3.3113 - val_accuracy10: 0.3196 - 7s/epoch - 22ms/step
Epoch 4/50
323/323 - 7s - loss: 3.2803 - accuracy10: 0.3681 - val_loss: 3.2850 - val_accuracy10: 0.3510 - 7s/epoch - 22ms/step
Epoch 5/50
323/323 - 7s - loss: 3.2744 - accuracy10: 0.3695 - val_loss: 3.2706 - val_accuracy10: 0.3608 - 7s/epoch - 23ms/step
Epoch 6/50
323/323 - 7s - loss: 3.2651 - accuracy10: 0.3771 - val_loss: 3.2640 - val_accuracy10: 0.3715 - 7s/epoch - 22ms/step
Epoch 7/50
323/323 - 7s - loss: 3.2541 - accuracy10: 0.3832 - val_loss: 3.2616 - val_accuracy10: 0.3646 - 7s/epoch - 22ms/step
Epoch 8/50
323/323 - 7s - loss: 3.2479 - accuracy10: 0.3879 - val_loss: 3.2624 - val_accuracy10: 0.3702 - 7s/epoch - 23ms/step
Epoch 9/50
323/323 - 7s - loss: 3.2392 - accuracy10: 0.3938 - val_loss: 3.2649 - val_accuracy10: 0.3682 - 7s/epoch - 23ms/step
Epoch 10/50
323/323 - 7s - loss: 3.2339 - accuracy10: 0.3932 - val_loss: 3.2618 - val_accuracy10: 0.3661 - 7s/epoch - 22ms/step
Epoch 11/50
323/323 - 7s - loss: 3.2293 - accuracy10: 0.3985 - val_loss: 3.2554 - val_accuracy10: 0.3700 - 7s/epoch - 23ms/step
Epoch 12/50
323/323 - 7s - loss: 3.2253 - accuracy10: 0.3962 - val_loss: 3.2577 - val_accuracy10: 0.3697 - 7s/epoch - 22ms/step
Epoch 13/50
323/323 - 7s - loss: 3.2173 - accuracy10: 0.4029 - val_loss: 3.2604 - val_accuracy10: 0.3718 - 7s/epoch - 22ms/step
Epoch 14/50
323/323 - 7s - loss: 3.2145 - accuracy10: 0.4046 - val_loss: 3.2549 - val_accuracy10: 0.3761 - 7s/epoch - 22ms/step
Epoch 15/50
323/323 - 7s - loss: 3.2107 - accuracy10: 0.4061 - val_loss: 3.2582 - val_accuracy10: 0.3749 - 7s/epoch - 22ms/step
Epoch 16/50
323/323 - 7s - loss: 3.2063 - accuracy10: 0.4063 - val_loss: 3.2611 - val_accuracy10: 0.3727 - 7s/epoch - 23ms/step
Epoch 17/50
323/323 - 7s - loss: 3.2024 - accuracy10: 0.4106 - val_loss: 3.2615 - val_accuracy10: 0.3736 - 7s/epoch - 22ms/step
Epoch 18/50
323/323 - 7s - loss: 3.1985 - accuracy10: 0.4115 - val_loss: 3.2611 - val_accuracy10: 0.3704 - 7s/epoch - 22ms/step
Epoch 19/50
323/323 - 7s - loss: 3.1957 - accuracy10: 0.4123 - val_loss: 3.2624 - val_accuracy10: 0.3714 - 7s/epoch - 22ms/step
Epoch 20/50
323/323 - 7s - loss: 3.1910 - accuracy10: 0.4130 - val_loss: 3.2629 - val_accuracy10: 0.3764 - 7s/epoch - 22ms/step
Epoch 21/50
323/323 - 7s - loss: 3.1854 - accuracy10: 0.4153 - val_loss: 3.2646 - val_accuracy10: 0.3726 - 7s/epoch - 22ms/step
Epoch 22/50
323/323 - 7s - loss: 3.1832 - accuracy10: 0.4181 - val_loss: 3.2603 - val_accuracy10: 0.3755 - 7s/epoch - 22ms/step
Epoch 23/50
323/323 - 7s - loss: 3.1794 - accuracy10: 0.4190 - val_loss: 3.2608 - val_accuracy10: 0.3821 - 7s/epoch - 22ms/step
Epoch 24/50
323/323 - 7s - loss: 3.1757 - accuracy10: 0.4192 - val_loss: 3.2626 - val_accuracy10: 0.3769 - 7s/epoch - 22ms/step
testing model: results/CHTR/W9/deepVOL_L2/h10
Evaluating performance on  test set...
604/604 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0779765
{'0': {'precision': 0.39150009379494344, 'recall': 0.35861845119902247, 'f1-score': 0.37433858479567134, 'support': 52376}, '1': {'precision': 0.409268391542255, 'recall': 0.5632577166232801, 'f1-score': 0.4740717555459917, 'support': 53780}, '2': {'precision': 0.39765576804441705, 'recall': 0.2671584880636605, 'f1-score': 0.3195993851951014, 'support': 48256}, 'accuracy': 0.401309483718882, 'macro avg': {'precision': 0.39947475112720515, 'recall': 0.396344885295321, 'f1-score': 0.38933657517892145, 'support': 154412}, 'weighted avg': {'precision': 0.39961233422595277, 'recall': 0.401309483718882, 'f1-score': 0.3919677529110194, 'support': 154412}}
[[18783 22955 10638]
 [14598 30292  8890]
 [14596 20768 12892]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0743467
{'0': {'precision': 0.4146543293462725, 'recall': 0.37483849030941857, 'f1-score': 0.3937424101721551, 'support': 29410}, '1': {'precision': 0.3820253164556962, 'recall': 0.5820411941680167, 'f1-score': 0.46128450463118637, 'support': 25926}, '2': {'precision': 0.43742824339839265, 'recall': 0.2651745485182607, 'f1-score': 0.33018609742747673, 'support': 27299}, 'accuracy': 0.40361832153445876, 'macro avg': {'precision': 0.4113692964001205, 'recall': 0.40735141099856537, 'f1-score': 0.3950710040769394, 'support': 82635}, 'weighted avg': {'precision': 0.4119407732442303, 'recall': 0.40361832153445876, 'f1-score': 0.3939369107993454, 'support': 82635}}
[[11024 12843  5543]
 [ 7069 15090  3767]
 [ 8493 11567  7239]]
Evaluating performance on  val set...
112/112 - 1s - 950ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0911429
{'0': {'precision': 0.4346993081426291, 'recall': 0.3747820501055336, 'f1-score': 0.40252316183717723, 'support': 10897}, '1': {'precision': 0.3016712009327633, 'recall': 0.5226232157285214, 'f1-score': 0.3825341284313242, 'support': 7426}, '2': {'precision': 0.43539507772020725, 'recall': 0.2658953821813507, 'f1-score': 0.3301614586530788, 'support': 10113}, 'accuracy': 0.3746659164439443, 'macro avg': {'precision': 0.3905885289318665, 'recall': 0.3877668826718019, 'f1-score': 0.3717395829738601, 'support': 28436}, 'weighted avg': {'precision': 0.4002067491891048, 'recall': 0.3746659164439443, 'f1-score': 0.3715682994664974, 'support': 28436}}
[[4084 4644 2169]
 [2227 3881 1318]
 [3084 4340 2689]]
training model: results/CHTR/W9/deepVOL_L2/h20
Epoch 1/50
323/323 - 10s - loss: 3.3293 - accuracy20: 0.3551 - val_loss: 3.3864 - val_accuracy20: 0.3119 - 10s/epoch - 30ms/step
Epoch 2/50
323/323 - 7s - loss: 3.3072 - accuracy20: 0.3584 - val_loss: 3.3576 - val_accuracy20: 0.3134 - 7s/epoch - 23ms/step
Epoch 3/50
323/323 - 7s - loss: 3.2979 - accuracy20: 0.3573 - val_loss: 3.3341 - val_accuracy20: 0.3227 - 7s/epoch - 22ms/step
Epoch 4/50
323/323 - 7s - loss: 3.2903 - accuracy20: 0.3580 - val_loss: 3.3265 - val_accuracy20: 0.3291 - 7s/epoch - 22ms/step
Epoch 5/50
323/323 - 7s - loss: 3.2775 - accuracy20: 0.3706 - val_loss: 3.3156 - val_accuracy20: 0.3347 - 7s/epoch - 23ms/step
Epoch 6/50
323/323 - 7s - loss: 3.2695 - accuracy20: 0.3723 - val_loss: 3.3144 - val_accuracy20: 0.3420 - 7s/epoch - 22ms/step
Epoch 7/50
323/323 - 7s - loss: 3.2647 - accuracy20: 0.3752 - val_loss: 3.3139 - val_accuracy20: 0.3425 - 7s/epoch - 22ms/step
Epoch 8/50
323/323 - 7s - loss: 3.2609 - accuracy20: 0.3788 - val_loss: 3.3017 - val_accuracy20: 0.3548 - 7s/epoch - 22ms/step
Epoch 9/50
323/323 - 7s - loss: 3.2544 - accuracy20: 0.3830 - val_loss: 3.2998 - val_accuracy20: 0.3573 - 7s/epoch - 22ms/step
Epoch 10/50
323/323 - 7s - loss: 3.2520 - accuracy20: 0.3870 - val_loss: 3.3041 - val_accuracy20: 0.3531 - 7s/epoch - 22ms/step
Epoch 11/50
323/323 - 7s - loss: 3.2469 - accuracy20: 0.3905 - val_loss: 3.2972 - val_accuracy20: 0.3624 - 7s/epoch - 22ms/step
Epoch 12/50
323/323 - 7s - loss: 3.2439 - accuracy20: 0.3922 - val_loss: 3.2962 - val_accuracy20: 0.3569 - 7s/epoch - 22ms/step
Epoch 13/50
323/323 - 7s - loss: 3.2401 - accuracy20: 0.3924 - val_loss: 3.2992 - val_accuracy20: 0.3561 - 7s/epoch - 22ms/step
Epoch 14/50
323/323 - 7s - loss: 3.2341 - accuracy20: 0.3956 - val_loss: 3.2964 - val_accuracy20: 0.3566 - 7s/epoch - 22ms/step
Epoch 15/50
323/323 - 7s - loss: 3.2283 - accuracy20: 0.3994 - val_loss: 3.3004 - val_accuracy20: 0.3580 - 7s/epoch - 22ms/step
Epoch 16/50
323/323 - 7s - loss: 3.2262 - accuracy20: 0.4008 - val_loss: 3.2995 - val_accuracy20: 0.3598 - 7s/epoch - 22ms/step
Epoch 17/50
323/323 - 7s - loss: 3.2249 - accuracy20: 0.4020 - val_loss: 3.3016 - val_accuracy20: 0.3598 - 7s/epoch - 22ms/step
Epoch 18/50
323/323 - 7s - loss: 3.2195 - accuracy20: 0.4054 - val_loss: 3.3022 - val_accuracy20: 0.3597 - 7s/epoch - 23ms/step
Epoch 19/50
323/323 - 7s - loss: 3.2151 - accuracy20: 0.4072 - val_loss: 3.3032 - val_accuracy20: 0.3625 - 7s/epoch - 22ms/step
Epoch 20/50
323/323 - 7s - loss: 3.2109 - accuracy20: 0.4092 - val_loss: 3.3026 - val_accuracy20: 0.3604 - 7s/epoch - 22ms/step
Epoch 21/50
323/323 - 7s - loss: 3.2093 - accuracy20: 0.4085 - val_loss: 3.3015 - val_accuracy20: 0.3613 - 7s/epoch - 22ms/step
Epoch 22/50
323/323 - 7s - loss: 3.2037 - accuracy20: 0.4122 - val_loss: 3.2995 - val_accuracy20: 0.3611 - 7s/epoch - 22ms/step
testing model: results/CHTR/W9/deepVOL_L2/h20
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0825866
{'0': {'precision': 0.36799653548422023, 'recall': 0.27817333660692367, 'f1-score': 0.31684183542681366, 'support': 48876}, '1': {'precision': 0.4257552030713275, 'recall': 0.5658062567132116, 'f1-score': 0.48589011875936816, 'support': 59584}, '2': {'precision': 0.357792173867614, 'recall': 0.2980719011142061, 'f1-score': 0.3252130968492533, 'support': 45952}, 'accuracy': 0.3950858741548584, 'macro avg': {'precision': 0.38384797080772054, 'recall': 0.3806838314781138, 'f1-score': 0.3759816836784784, 'support': 154412}, 'weighted avg': {'precision': 0.3872475109557116, 'recall': 0.3950858741548584, 'f1-score': 0.38456486938123996, 'support': 154412}}
[[13596 24003 11277]
 [12563 33713 13308]
 [10787 21468 13697]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0798444
{'0': {'precision': 0.39957933868127565, 'recall': 0.2854896204655064, 'f1-score': 0.33303436748338705, 'support': 28614}, '1': {'precision': 0.3899351234456659, 'recall': 0.6210756700513078, 'f1-score': 0.47908334832486893, 'support': 27871}, '2': {'precision': 0.4068206078993202, 'recall': 0.2769024856596558, 'f1-score': 0.32951830530842563, 'support': 26150}, 'accuracy': 0.3959581291220427, 'macro avg': {'precision': 0.39877835667542055, 'recall': 0.39448925872549, 'f1-score': 0.3805453403722272, 'support': 82635}, 'weighted avg': {'precision': 0.3986180664264222, 'recall': 0.3959581291220427, 'f1-score': 0.38118086859257444, 'support': 82635}}
[[ 8169 14525  5920]
 [ 5923 17310  4638]
 [ 6352 12557  7241]]
Evaluating performance on  val set...
112/112 - 1s - 909ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0974507
{'0': {'precision': 0.4147062966615016, 'recall': 0.2782082782082782, 'f1-score': 0.33301283864034836, 'support': 10582}, '1': {'precision': 0.3151437093275488, 'recall': 0.576084262701363, 'f1-score': 0.40741389886951185, 'support': 8070}, '2': {'precision': 0.39802581624905087, 'recall': 0.267886345053148, 'f1-score': 0.3202394770602969, 'support': 9784}, 'accuracy': 0.3591925727950485, 'macro avg': {'precision': 0.37595860741270043, 'recall': 0.37405962865426307, 'f1-score': 0.35355540485671905, 'support': 28436}, 'weighted avg': {'precision': 0.3807116455101295, 'recall': 0.3591925727950485, 'f1-score': 0.34973255964014177, 'support': 28436}}
[[2944 5273 2365]
 [1822 4649 1599]
 [2333 4830 2621]]
training model: results/CHTR/W9/deepVOL_L2/h30
Epoch 1/50
323/323 - 9s - loss: 3.3376 - accuracy30: 0.3523 - val_loss: 3.4233 - val_accuracy30: 0.3082 - 9s/epoch - 29ms/step
Epoch 2/50
323/323 - 7s - loss: 3.3124 - accuracy30: 0.3583 - val_loss: 3.3631 - val_accuracy30: 0.3092 - 7s/epoch - 22ms/step
Epoch 3/50
323/323 - 7s - loss: 3.3034 - accuracy30: 0.3575 - val_loss: 3.3546 - val_accuracy30: 0.3074 - 7s/epoch - 22ms/step
Epoch 4/50
323/323 - 7s - loss: 3.2939 - accuracy30: 0.3592 - val_loss: 3.3270 - val_accuracy30: 0.3191 - 7s/epoch - 23ms/step
Epoch 5/50
323/323 - 7s - loss: 3.2851 - accuracy30: 0.3631 - val_loss: 3.3226 - val_accuracy30: 0.3268 - 7s/epoch - 23ms/step
Epoch 6/50
323/323 - 7s - loss: 3.2819 - accuracy30: 0.3661 - val_loss: 3.3251 - val_accuracy30: 0.3254 - 7s/epoch - 22ms/step
Epoch 7/50
323/323 - 7s - loss: 3.2746 - accuracy30: 0.3715 - val_loss: 3.3119 - val_accuracy30: 0.3368 - 7s/epoch - 22ms/step
Epoch 8/50
323/323 - 7s - loss: 3.2717 - accuracy30: 0.3753 - val_loss: 3.3102 - val_accuracy30: 0.3407 - 7s/epoch - 23ms/step
Epoch 9/50
323/323 - 7s - loss: 3.2666 - accuracy30: 0.3761 - val_loss: 3.3012 - val_accuracy30: 0.3479 - 7s/epoch - 23ms/step
Epoch 10/50
323/323 - 7s - loss: 3.2616 - accuracy30: 0.3813 - val_loss: 3.3009 - val_accuracy30: 0.3483 - 7s/epoch - 22ms/step
Epoch 11/50
323/323 - 7s - loss: 3.2572 - accuracy30: 0.3827 - val_loss: 3.3055 - val_accuracy30: 0.3477 - 7s/epoch - 22ms/step
Epoch 12/50
323/323 - 7s - loss: 3.2530 - accuracy30: 0.3849 - val_loss: 3.3066 - val_accuracy30: 0.3443 - 7s/epoch - 22ms/step
Epoch 13/50
323/323 - 7s - loss: 3.2491 - accuracy30: 0.3892 - val_loss: 3.3040 - val_accuracy30: 0.3554 - 7s/epoch - 22ms/step
Epoch 14/50
323/323 - 7s - loss: 3.2456 - accuracy30: 0.3908 - val_loss: 3.3069 - val_accuracy30: 0.3531 - 7s/epoch - 22ms/step
Epoch 15/50
323/323 - 7s - loss: 3.2423 - accuracy30: 0.3933 - val_loss: 3.3045 - val_accuracy30: 0.3541 - 7s/epoch - 22ms/step
Epoch 16/50
323/323 - 7s - loss: 3.2392 - accuracy30: 0.3939 - val_loss: 3.3016 - val_accuracy30: 0.3542 - 7s/epoch - 22ms/step
Epoch 17/50
323/323 - 7s - loss: 3.2358 - accuracy30: 0.3954 - val_loss: 3.3052 - val_accuracy30: 0.3528 - 7s/epoch - 23ms/step
Epoch 18/50
323/323 - 7s - loss: 3.2291 - accuracy30: 0.3985 - val_loss: 3.3044 - val_accuracy30: 0.3556 - 7s/epoch - 22ms/step
Epoch 19/50
323/323 - 7s - loss: 3.2302 - accuracy30: 0.3983 - val_loss: 3.3075 - val_accuracy30: 0.3544 - 7s/epoch - 22ms/step
Epoch 20/50
323/323 - 7s - loss: 3.2258 - accuracy30: 0.4007 - val_loss: 3.3099 - val_accuracy30: 0.3532 - 7s/epoch - 22ms/step
testing model: results/CHTR/W9/deepVOL_L2/h30
Evaluating performance on  test set...
604/604 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.08505
{'0': {'precision': 0.3821305569850758, 'recall': 0.19665084441909264, 'f1-score': 0.2596707376123097, 'support': 49087}, '1': {'precision': 0.4235741886748598, 'recall': 0.4894910018802041, 'f1-score': 0.4541532327149821, 'support': 59568}, '2': {'precision': 0.3316697892659957, 'recall': 0.43717901086172606, 'f1-score': 0.37718487791081357, 'support': 45757}, 'accuracy': 0.3808965624433334, 'macro avg': {'precision': 0.3791248449753104, 'recall': 0.3744402857203409, 'f1-score': 0.36366961607936843, 'support': 154412}, 'weighted avg': {'precision': 0.3831653269768841, 'recall': 0.3808965624433334, 'f1-score': 0.36951989302713906, 'support': 154412}}
[[ 9653 20642 18792]
 [ 8893 29158 21517]
 [ 6715 19038 20004]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0869274
{'0': {'precision': 0.4143575933668769, 'recall': 0.2022763440116239, 'f1-score': 0.27184601436641326, 'support': 28906}, '1': {'precision': 0.380298004527984, 'recall': 0.5225727101721893, 'f1-score': 0.4402255066280665, 'support': 27644}, '2': {'precision': 0.36469316916628464, 'recall': 0.4269503546099291, 'f1-score': 0.39337371739399185, 'support': 26085}, 'accuracy': 0.3803473104616688, 'macro avg': {'precision': 0.38644958902038185, 'recall': 0.38393313626458075, 'f1-score': 0.36848174612949053, 'support': 82635}, 'weighted avg': {'precision': 0.3872862582288022, 'recall': 0.3803473104616688, 'f1-score': 0.36653631287861177, 'support': 82635}}
[[ 5847 12639 10420]
 [ 4217 14446  8981]
 [ 4047 10901 11137]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1006633
{'0': {'precision': 0.42156229825693997, 'recall': 0.18540601930721182, 'f1-score': 0.25754289094853083, 'support': 10566}, '1': {'precision': 0.30161863403079353, 'recall': 0.48032189111027285, 'f1-score': 0.37055000485013095, 'support': 7953}, '2': {'precision': 0.3736066163250629, 'recall': 0.4190783503075527, 'f1-score': 0.39503825863789743, 'support': 9917}, 'accuracy': 0.3493810662540442, 'macro avg': {'precision': 0.3655958495375988, 'recall': 0.36160208690834583, 'f1-score': 0.34104371814551976, 'support': 28436}, 'weighted avg': {'precision': 0.3712919205909895, 'recall': 0.3493810662540442, 'f1-score': 0.3371000416812244, 'support': 28436}}
[[1959 4552 4055]
 [1220 3820 2913]
 [1468 4293 4156]]
training model: results/CHTR/W9/deepVOL_L2/h50
Epoch 1/50
323/323 - 9s - loss: 3.3357 - accuracy50: 0.3513 - val_loss: 3.3628 - val_accuracy50: 0.3191 - 9s/epoch - 29ms/step
Epoch 2/50
323/323 - 7s - loss: 3.3151 - accuracy50: 0.3551 - val_loss: 3.3837 - val_accuracy50: 0.3010 - 7s/epoch - 23ms/step
Epoch 3/50
323/323 - 7s - loss: 3.3159 - accuracy50: 0.3456 - val_loss: 3.3578 - val_accuracy50: 0.2949 - 7s/epoch - 23ms/step
Epoch 4/50
323/323 - 7s - loss: 3.3018 - accuracy50: 0.3556 - val_loss: 3.3647 - val_accuracy50: 0.2958 - 7s/epoch - 22ms/step
Epoch 5/50
323/323 - 7s - loss: 3.2995 - accuracy50: 0.3540 - val_loss: 3.3375 - val_accuracy50: 0.3057 - 7s/epoch - 22ms/step
Epoch 6/50
323/323 - 7s - loss: 3.2960 - accuracy50: 0.3534 - val_loss: 3.3298 - val_accuracy50: 0.3105 - 7s/epoch - 22ms/step
Epoch 7/50
323/323 - 7s - loss: 3.2925 - accuracy50: 0.3565 - val_loss: 3.3447 - val_accuracy50: 0.3072 - 7s/epoch - 22ms/step
Epoch 8/50
323/323 - 7s - loss: 3.2915 - accuracy50: 0.3534 - val_loss: 3.3254 - val_accuracy50: 0.3176 - 7s/epoch - 22ms/step
Epoch 9/50
323/323 - 7s - loss: 3.2869 - accuracy50: 0.3580 - val_loss: 3.3149 - val_accuracy50: 0.3272 - 7s/epoch - 22ms/step
Epoch 10/50
323/323 - 7s - loss: 3.2828 - accuracy50: 0.3623 - val_loss: 3.3122 - val_accuracy50: 0.3331 - 7s/epoch - 23ms/step
Epoch 11/50
323/323 - 7s - loss: 3.2809 - accuracy50: 0.3623 - val_loss: 3.3162 - val_accuracy50: 0.3294 - 7s/epoch - 22ms/step
Epoch 12/50
323/323 - 7s - loss: 3.2744 - accuracy50: 0.3681 - val_loss: 3.3106 - val_accuracy50: 0.3310 - 7s/epoch - 22ms/step
Epoch 13/50
323/323 - 7s - loss: 3.2716 - accuracy50: 0.3689 - val_loss: 3.3122 - val_accuracy50: 0.3310 - 7s/epoch - 22ms/step
Epoch 14/50
323/323 - 7s - loss: 3.2726 - accuracy50: 0.3692 - val_loss: 3.3052 - val_accuracy50: 0.3373 - 7s/epoch - 22ms/step
Epoch 15/50
323/323 - 7s - loss: 3.2677 - accuracy50: 0.3741 - val_loss: 3.3142 - val_accuracy50: 0.3313 - 7s/epoch - 23ms/step
Epoch 16/50
323/323 - 7s - loss: 3.2663 - accuracy50: 0.3749 - val_loss: 3.3105 - val_accuracy50: 0.3348 - 7s/epoch - 22ms/step
Epoch 17/50
323/323 - 7s - loss: 3.2614 - accuracy50: 0.3785 - val_loss: 3.3119 - val_accuracy50: 0.3351 - 7s/epoch - 22ms/step
Epoch 18/50
323/323 - 7s - loss: 3.2594 - accuracy50: 0.3795 - val_loss: 3.3126 - val_accuracy50: 0.3340 - 7s/epoch - 22ms/step
Epoch 19/50
323/323 - 7s - loss: 3.2568 - accuracy50: 0.3837 - val_loss: 3.3080 - val_accuracy50: 0.3385 - 7s/epoch - 22ms/step
Epoch 20/50
323/323 - 7s - loss: 3.2524 - accuracy50: 0.3851 - val_loss: 3.3133 - val_accuracy50: 0.3398 - 7s/epoch - 22ms/step
Epoch 21/50
323/323 - 7s - loss: 3.2509 - accuracy50: 0.3868 - val_loss: 3.3146 - val_accuracy50: 0.3358 - 7s/epoch - 22ms/step
Epoch 22/50
323/323 - 7s - loss: 3.2479 - accuracy50: 0.3850 - val_loss: 3.3105 - val_accuracy50: 0.3460 - 7s/epoch - 22ms/step
Epoch 23/50
323/323 - 7s - loss: 3.2458 - accuracy50: 0.3881 - val_loss: 3.3138 - val_accuracy50: 0.3419 - 7s/epoch - 22ms/step
Epoch 24/50
323/323 - 7s - loss: 3.2416 - accuracy50: 0.3907 - val_loss: 3.3170 - val_accuracy50: 0.3439 - 7s/epoch - 22ms/step
testing model: results/CHTR/W9/deepVOL_L2/h50
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0930429
{'0': {'precision': 0.36668926553672315, 'recall': 0.16646831910702561, 'f1-score': 0.2289835029141559, 'support': 48736}, '1': {'precision': 0.4079345765301791, 'recall': 0.48037320893035657, 'f1-score': 0.4412003244120033, 'support': 60020}, '2': {'precision': 0.31691798276225874, 'recall': 0.42765463465919046, 'f1-score': 0.3640516477881881, 'support': 45656}, 'accuracy': 0.3657099189182188, 'macro avg': {'precision': 0.3638472749430537, 'recall': 0.3581653875655242, 'f1-score': 0.3447451583714491, 'support': 154412}, 'weighted avg': {'precision': 0.3680051339891509, 'recall': 0.3657099189182188, 'f1-score': 0.3514087344289968, 'support': 154412}}
[[ 8113 21659 18964]
 [ 8068 28832 23120]
 [ 5944 20187 19525]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0925591
{'0': {'precision': 0.42052608883139286, 'recall': 0.16606498194945848, 'f1-score': 0.23810337671216153, 'support': 29362}, '1': {'precision': 0.361360201511335, 'recall': 0.5269421487603306, 'f1-score': 0.4287187149794547, 'support': 27225}, '2': {'precision': 0.3536694320357371, 'recall': 0.425522113022113, 'f1-score': 0.3862828465881369, 'support': 26048}, 'accuracy': 0.36674532583045927, 'macro avg': {'precision': 0.378518574126155, 'recall': 0.37284308124396737, 'f1-score': 0.35103497942658435, 'support': 82635}, 'weighted avg': {'precision': 0.37995885365862325, 'recall': 0.36674532583045927, 'f1-score': 0.3476124396474367, 'support': 82635}}
[[ 4876 13669 10817]
 [ 3440 14346  9439]
 [ 3279 11685 11084]]
Evaluating performance on  val set...
112/112 - 1s - 969ms/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1032125
{'0': {'precision': 0.4110589462702139, 'recall': 0.1502096835684331, 'f1-score': 0.2200195448834287, 'support': 10492}, '1': {'precision': 0.2959044884388696, 'recall': 0.4865805168986084, 'f1-score': 0.36801052532656703, 'support': 8048}, '2': {'precision': 0.37007389162561577, 'recall': 0.4251212611156023, 'f1-score': 0.3956922498118887, 'support': 9896}, 'accuracy': 0.3410817273878183, 'macro avg': {'precision': 0.35901244211156635, 'recall': 0.3539704871942146, 'f1-score': 0.3279074400072948, 'support': 28436}, 'weighted avg': {'precision': 0.3642045652957589, 'recall': 0.3410817273878183, 'f1-score': 0.32303995909704586, 'support': 28436}}
[[1576 4844 4072]
 [1043 3916 3089]
 [1215 4474 4207]]
training model: results/CHTR/W9/deepVOL_L2/h100
Epoch 1/50
323/323 - 9s - loss: 3.3409 - accuracy100: 0.3522 - val_loss: 3.3827 - val_accuracy100: 0.3112 - 9s/epoch - 29ms/step
Epoch 2/50
323/323 - 7s - loss: 3.3224 - accuracy100: 0.3509 - val_loss: 3.3625 - val_accuracy100: 0.3078 - 7s/epoch - 22ms/step
Epoch 3/50
323/323 - 7s - loss: 3.3150 - accuracy100: 0.3476 - val_loss: 3.3382 - val_accuracy100: 0.3097 - 7s/epoch - 23ms/step
Epoch 4/50
323/323 - 7s - loss: 3.3076 - accuracy100: 0.3460 - val_loss: 3.3379 - val_accuracy100: 0.3039 - 7s/epoch - 23ms/step
Epoch 5/50
323/323 - 7s - loss: 3.3013 - accuracy100: 0.3492 - val_loss: 3.3163 - val_accuracy100: 0.3219 - 7s/epoch - 22ms/step
Epoch 6/50
323/323 - 7s - loss: 3.2952 - accuracy100: 0.3502 - val_loss: 3.3217 - val_accuracy100: 0.3096 - 7s/epoch - 22ms/step
Epoch 7/50
323/323 - 7s - loss: 3.2933 - accuracy100: 0.3518 - val_loss: 3.3185 - val_accuracy100: 0.3236 - 7s/epoch - 22ms/step
Epoch 8/50
323/323 - 7s - loss: 3.2877 - accuracy100: 0.3573 - val_loss: 3.3147 - val_accuracy100: 0.3231 - 7s/epoch - 22ms/step
Epoch 9/50
323/323 - 7s - loss: 3.2845 - accuracy100: 0.3594 - val_loss: 3.3200 - val_accuracy100: 0.3122 - 7s/epoch - 22ms/step
Epoch 10/50
323/323 - 7s - loss: 3.2843 - accuracy100: 0.3578 - val_loss: 3.3183 - val_accuracy100: 0.3186 - 7s/epoch - 22ms/step
Epoch 11/50
323/323 - 7s - loss: 3.2804 - accuracy100: 0.3636 - val_loss: 3.3230 - val_accuracy100: 0.3099 - 7s/epoch - 22ms/step
Epoch 12/50
323/323 - 7s - loss: 3.2782 - accuracy100: 0.3679 - val_loss: 3.3227 - val_accuracy100: 0.3111 - 7s/epoch - 22ms/step
Epoch 13/50
323/323 - 7s - loss: 3.2745 - accuracy100: 0.3672 - val_loss: 3.3201 - val_accuracy100: 0.3178 - 7s/epoch - 22ms/step
Epoch 14/50
323/323 - 7s - loss: 3.2707 - accuracy100: 0.3713 - val_loss: 3.3278 - val_accuracy100: 0.3147 - 7s/epoch - 22ms/step
Epoch 15/50
323/323 - 7s - loss: 3.2719 - accuracy100: 0.3688 - val_loss: 3.3278 - val_accuracy100: 0.3171 - 7s/epoch - 22ms/step
Epoch 16/50
323/323 - 7s - loss: 3.2675 - accuracy100: 0.3736 - val_loss: 3.3292 - val_accuracy100: 0.3141 - 7s/epoch - 22ms/step
Epoch 17/50
323/323 - 7s - loss: 3.2636 - accuracy100: 0.3745 - val_loss: 3.3277 - val_accuracy100: 0.3171 - 7s/epoch - 22ms/step
Epoch 18/50
323/323 - 7s - loss: 3.2654 - accuracy100: 0.3733 - val_loss: 3.3181 - val_accuracy100: 0.3290 - 7s/epoch - 22ms/step
testing model: results/CHTR/W9/deepVOL_L2/h100
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0963428
{'0': {'precision': 0.3330202990681211, 'recall': 0.09580415220598931, 'f1-score': 0.14880087795745778, 'support': 48119}, '1': {'precision': 0.39176984540166143, 'recall': 0.5737300074583574, 'f1-score': 0.4656036262635093, 'support': 60335}, '2': {'precision': 0.3055677922276915, 'recall': 0.3471430436485487, 'f1-score': 0.32503132353390585, 'support': 45958}, 'accuracy': 0.35735564593425384, 'macro avg': {'precision': 0.34345264556582467, 'recall': 0.33889240110429847, 'f1-score': 0.313145275918291, 'support': 154412}, 'weighted avg': {'precision': 0.34780536479268714, 'recall': 0.35735564593425384, 'f1-score': 0.32504037124067425, 'support': 154412}}
[[ 4610 27492 16017]
 [ 5479 34616 20240]
 [ 3754 26250 15954]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0992193
{'0': {'precision': 0.3960410557184751, 'recall': 0.09227247881934955, 'f1-score': 0.14967305774132772, 'support': 29272}, '1': {'precision': 0.34082867017774854, 'recall': 0.608722810111699, 'f1-score': 0.4369856509812197, 'support': 27216}, '2': {'precision': 0.3417502848531628, 'recall': 0.3556048495047233, 'f1-score': 0.3485399407729505, 'support': 26147}, 'accuracy': 0.3456888727536758, 'macro avg': {'precision': 0.3595400035831288, 'recall': 0.3522000461452573, 'f1-score': 0.31173288316516595, 'support': 82635}, 'weighted avg': {'precision': 0.3606783030024137, 'recall': 0.3456888727536758, 'f1-score': 0.30722460282809166, 'support': 82635}}
[[ 2701 17188  9383]
 [ 2123 16567  8526]
 [ 1996 14853  9298]]
Evaluating performance on  val set...
112/112 - 1s - 947ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.107179
{'0': {'precision': 0.3722397476340694, 'recall': 0.08074291300097752, 'f1-score': 0.13270142180094788, 'support': 10230}, '1': {'precision': 0.2906520031421838, 'recall': 0.5797974927675988, 'f1-score': 0.3872006439927551, 'support': 8296}, '2': {'precision': 0.3491932147290029, 'recall': 0.34066599394550956, 'f1-score': 0.34487690264582693, 'support': 9910}, 'accuracy': 0.3169222112814742, 'macro avg': {'precision': 0.3373616551684187, 'recall': 0.33373546657136205, 'f1-score': 0.28825965614651, 'support': 28436}, 'weighted avg': {'precision': 0.34040534513744913, 'recall': 0.3169222112814742, 'f1-score': 0.28089331104261284, 'support': 28436}}
[[ 826 5981 3423]
 [ 617 4810 2869]
 [ 776 5758 3376]]
training model: results/CHTR/W9/deepVOL_L2/h200
Epoch 1/50
323/323 - 10s - loss: 3.3445 - accuracy200: 0.3481 - val_loss: 3.3461 - val_accuracy200: 0.3260 - 10s/epoch - 30ms/step
Epoch 2/50
323/323 - 7s - loss: 3.3242 - accuracy200: 0.3460 - val_loss: 3.3357 - val_accuracy200: 0.3164 - 7s/epoch - 22ms/step
Epoch 3/50
323/323 - 7s - loss: 3.3121 - accuracy200: 0.3505 - val_loss: 3.3293 - val_accuracy200: 0.3170 - 7s/epoch - 22ms/step
Epoch 4/50
323/323 - 7s - loss: 3.3046 - accuracy200: 0.3497 - val_loss: 3.3212 - val_accuracy200: 0.3230 - 7s/epoch - 22ms/step
Epoch 5/50
323/323 - 7s - loss: 3.3029 - accuracy200: 0.3488 - val_loss: 3.3180 - val_accuracy200: 0.3263 - 7s/epoch - 22ms/step
Epoch 6/50
323/323 - 7s - loss: 3.2976 - accuracy200: 0.3516 - val_loss: 3.3113 - val_accuracy200: 0.3244 - 7s/epoch - 22ms/step
Epoch 7/50
323/323 - 7s - loss: 3.2933 - accuracy200: 0.3535 - val_loss: 3.3133 - val_accuracy200: 0.3209 - 7s/epoch - 22ms/step
Epoch 8/50
323/323 - 7s - loss: 3.2903 - accuracy200: 0.3583 - val_loss: 3.3147 - val_accuracy200: 0.3192 - 7s/epoch - 22ms/step
Epoch 9/50
323/323 - 7s - loss: 3.2883 - accuracy200: 0.3547 - val_loss: 3.3100 - val_accuracy200: 0.3241 - 7s/epoch - 22ms/step
Epoch 10/50
323/323 - 7s - loss: 3.2847 - accuracy200: 0.3587 - val_loss: 3.3147 - val_accuracy200: 0.3160 - 7s/epoch - 22ms/step
Epoch 11/50
323/323 - 7s - loss: 3.2858 - accuracy200: 0.3579 - val_loss: 3.3150 - val_accuracy200: 0.3199 - 7s/epoch - 22ms/step
Epoch 12/50
323/323 - 7s - loss: 3.2865 - accuracy200: 0.3549 - val_loss: 3.3053 - val_accuracy200: 0.3325 - 7s/epoch - 22ms/step
Epoch 13/50
323/323 - 8s - loss: 3.2838 - accuracy200: 0.3590 - val_loss: 3.3086 - val_accuracy200: 0.3305 - 8s/epoch - 23ms/step
Epoch 14/50
323/323 - 7s - loss: 3.2821 - accuracy200: 0.3580 - val_loss: 3.3063 - val_accuracy200: 0.3248 - 7s/epoch - 22ms/step
Epoch 15/50
323/323 - 7s - loss: 3.2813 - accuracy200: 0.3586 - val_loss: 3.3049 - val_accuracy200: 0.3363 - 7s/epoch - 22ms/step
Epoch 16/50
323/323 - 7s - loss: 3.2785 - accuracy200: 0.3649 - val_loss: 3.3069 - val_accuracy200: 0.3265 - 7s/epoch - 22ms/step
Epoch 17/50
323/323 - 7s - loss: 3.2764 - accuracy200: 0.3633 - val_loss: 3.3059 - val_accuracy200: 0.3391 - 7s/epoch - 23ms/step
Epoch 18/50
323/323 - 7s - loss: 3.2733 - accuracy200: 0.3664 - val_loss: 3.3104 - val_accuracy200: 0.3250 - 7s/epoch - 22ms/step
Epoch 19/50
323/323 - 7s - loss: 3.2714 - accuracy200: 0.3667 - val_loss: 3.3095 - val_accuracy200: 0.3348 - 7s/epoch - 22ms/step
Epoch 20/50
323/323 - 7s - loss: 3.2684 - accuracy200: 0.3717 - val_loss: 3.3126 - val_accuracy200: 0.3343 - 7s/epoch - 22ms/step
Epoch 21/50
323/323 - 8s - loss: 3.2647 - accuracy200: 0.3705 - val_loss: 3.3132 - val_accuracy200: 0.3324 - 8s/epoch - 23ms/step
Epoch 22/50
323/323 - 7s - loss: 3.2630 - accuracy200: 0.3726 - val_loss: 3.3146 - val_accuracy200: 0.3398 - 7s/epoch - 23ms/step
Epoch 23/50
323/323 - 7s - loss: 3.2614 - accuracy200: 0.3727 - val_loss: 3.3161 - val_accuracy200: 0.3423 - 7s/epoch - 21ms/step
Epoch 24/50
323/323 - 7s - loss: 3.2598 - accuracy200: 0.3744 - val_loss: 3.3221 - val_accuracy200: 0.3352 - 7s/epoch - 23ms/step
Epoch 25/50
323/323 - 7s - loss: 3.2590 - accuracy200: 0.3734 - val_loss: 3.3252 - val_accuracy200: 0.3217 - 7s/epoch - 23ms/step
testing model: results/CHTR/W9/deepVOL_L2/h200
Evaluating performance on  test set...
604/604 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0959989
{'0': {'precision': 0.3431479229341356, 'recall': 0.11354201965435445, 'f1-score': 0.17062652174604942, 'support': 47216}, '1': {'precision': 0.4044082730966074, 'recall': 0.5076245508882892, 'f1-score': 0.45017583272764655, 'support': 60397}, '2': {'precision': 0.3076043634977849, 'recall': 0.41394046881343616, 'f1-score': 0.35293688966622944, 'support': 46799}, 'accuracy': 0.35872859622309144, 'macro avg': {'precision': 0.35172018650950926, 'recall': 0.34503567978535993, 'f1-score': 0.32457974804664186, 'support': 154412}, 'weighted avg': {'precision': 0.3563369129783098, 'recall': 0.35872859622309144, 'f1-score': 0.33522436805107775, 'support': 154412}}
[[ 5361 22148 19707]
 [ 5840 30659 23898]
 [ 4422 23005 19372]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0950168
{'0': {'precision': 0.40022396416573347, 'recall': 0.12279677031437897, 'f1-score': 0.18793216774023924, 'support': 29105}, '1': {'precision': 0.34970708694074343, 'recall': 0.49813536166598976, 'f1-score': 0.4109288618814822, 'support': 27083}, '2': {'precision': 0.3405642383351838, 'recall': 0.45233863954323744, 'f1-score': 0.3885730990353071, 'support': 26447}, 'accuracy': 0.35127972408785624, 'macro avg': {'precision': 0.36349842981388686, 'recall': 0.357756923841202, 'f1-score': 0.3291447095523428, 'support': 82635}, 'weighted avg': {'precision': 0.3645735817015845, 'recall': 0.35127972408785624, 'f1-score': 0.3252319823150313, 'support': 82635}}
[[ 3574 13238 12293]
 [ 2721 13491 10871]
 [ 2635 11849 11963]]
Evaluating performance on  val set...
112/112 - 1s - 964ms/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.102385
{'0': {'precision': 0.36127167630057805, 'recall': 0.11156287187623959, 'f1-score': 0.17048037581451733, 'support': 10084}, '1': {'precision': 0.30544611819235223, 'recall': 0.46726542188607895, 'f1-score': 0.3694118746204512, 'support': 8462}, '2': {'precision': 0.3565484366163044, 'recall': 0.4462082912032356, 'f1-score': 0.3963713118067094, 'support': 9890}, 'accuracy': 0.333802222534815, 'macro avg': {'precision': 0.3410887437030783, 'recall': 0.34167886165518474, 'f1-score': 0.31208785408055933, 'support': 28436}, 'weighted avg': {'precision': 0.3430163410498651, 'recall': 0.333802222534815, 'f1-score': 0.3082430604346676, 'support': 28436}}
[[1125 4615 4344]
 [ 888 3954 3620]
 [1101 4376 4413]]
training model: results/CHTR/W9/deepVOL_L2/h300
Epoch 1/50
323/323 - 9s - loss: 3.3407 - accuracy300: 0.3505 - val_loss: 3.3397 - val_accuracy300: 0.3412 - 9s/epoch - 29ms/step
Epoch 2/50
323/323 - 7s - loss: 3.3235 - accuracy300: 0.3547 - val_loss: 3.3382 - val_accuracy300: 0.3289 - 7s/epoch - 22ms/step
Epoch 3/50
323/323 - 7s - loss: 3.3151 - accuracy300: 0.3514 - val_loss: 3.3186 - val_accuracy300: 0.3252 - 7s/epoch - 22ms/step
Epoch 4/50
323/323 - 7s - loss: 3.3042 - accuracy300: 0.3484 - val_loss: 3.3164 - val_accuracy300: 0.3293 - 7s/epoch - 22ms/step
Epoch 5/50
323/323 - 7s - loss: 3.2971 - accuracy300: 0.3528 - val_loss: 3.3093 - val_accuracy300: 0.3252 - 7s/epoch - 22ms/step
Epoch 6/50
323/323 - 7s - loss: 3.2927 - accuracy300: 0.3577 - val_loss: 3.2998 - val_accuracy300: 0.3420 - 7s/epoch - 22ms/step
Epoch 7/50
323/323 - 7s - loss: 3.2906 - accuracy300: 0.3557 - val_loss: 3.3010 - val_accuracy300: 0.3350 - 7s/epoch - 22ms/step
Epoch 8/50
323/323 - 7s - loss: 3.2879 - accuracy300: 0.3583 - val_loss: 3.2992 - val_accuracy300: 0.3385 - 7s/epoch - 22ms/step
Epoch 9/50
323/323 - 7s - loss: 3.2867 - accuracy300: 0.3567 - val_loss: 3.2977 - val_accuracy300: 0.3460 - 7s/epoch - 22ms/step
Epoch 10/50
323/323 - 7s - loss: 3.2846 - accuracy300: 0.3611 - val_loss: 3.2947 - val_accuracy300: 0.3492 - 7s/epoch - 22ms/step
Epoch 11/50
323/323 - 7s - loss: 3.2832 - accuracy300: 0.3633 - val_loss: 3.3012 - val_accuracy300: 0.3320 - 7s/epoch - 22ms/step
Epoch 12/50
323/323 - 7s - loss: 3.2831 - accuracy300: 0.3627 - val_loss: 3.3006 - val_accuracy300: 0.3364 - 7s/epoch - 22ms/step
Epoch 13/50
323/323 - 7s - loss: 3.2797 - accuracy300: 0.3670 - val_loss: 3.3062 - val_accuracy300: 0.3296 - 7s/epoch - 22ms/step
Epoch 14/50
323/323 - 7s - loss: 3.2783 - accuracy300: 0.3679 - val_loss: 3.3017 - val_accuracy300: 0.3372 - 7s/epoch - 22ms/step
Epoch 15/50
323/323 - 7s - loss: 3.2777 - accuracy300: 0.3679 - val_loss: 3.3077 - val_accuracy300: 0.3281 - 7s/epoch - 22ms/step
Epoch 16/50
323/323 - 7s - loss: 3.2779 - accuracy300: 0.3675 - val_loss: 3.3036 - val_accuracy300: 0.3331 - 7s/epoch - 22ms/step
Epoch 17/50
323/323 - 7s - loss: 3.2763 - accuracy300: 0.3657 - val_loss: 3.3041 - val_accuracy300: 0.3377 - 7s/epoch - 22ms/step
Epoch 18/50
323/323 - 7s - loss: 3.2711 - accuracy300: 0.3731 - val_loss: 3.3094 - val_accuracy300: 0.3292 - 7s/epoch - 22ms/step
Epoch 19/50
323/323 - 7s - loss: 3.2719 - accuracy300: 0.3708 - val_loss: 3.3063 - val_accuracy300: 0.3332 - 7s/epoch - 22ms/step
Epoch 20/50
323/323 - 7s - loss: 3.2699 - accuracy300: 0.3717 - val_loss: 3.3113 - val_accuracy300: 0.3222 - 7s/epoch - 22ms/step
testing model: results/CHTR/W9/deepVOL_L2/h300
Evaluating performance on  test set...
604/604 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0969533
{'0': {'precision': 0.34354110207768745, 'recall': 0.08182189806149014, 'f1-score': 0.1321656327651219, 'support': 46479}, '1': {'precision': 0.3977509317568436, 'recall': 0.5254231533198649, 'f1-score': 0.4527586988801358, 'support': 58903}, '2': {'precision': 0.30986388329365805, 'recall': 0.4141545992249643, 'f1-score': 0.35449800108238333, 'support': 49030}, 'accuracy': 0.3565655519001114, 'macro avg': {'precision': 0.35038530570939636, 'recall': 0.3404665502021064, 'f1-score': 0.3131407775758803, 'support': 154412}, 'weighted avg': {'precision': 0.3535269034442287, 'recall': 0.3565655519001114, 'f1-score': 0.32505769680138846, 'support': 154412}}
[[ 3803 21313 21363]
 [ 4091 30949 23863]
 [ 3176 25548 20306]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.098098
{'0': {'precision': 0.4038945778076213, 'recall': 0.08359100858145434, 'f1-score': 0.1385146804835924, 'support': 28783}, '1': {'precision': 0.3526178767717674, 'recall': 0.4927243330638642, 'f1-score': 0.4110605294216827, 'support': 27214}, '2': {'precision': 0.34156942899278153, 'recall': 0.49560777836173886, 'f1-score': 0.40441728315642755, 'support': 26638}, 'accuracy': 0.35114660857989954, 'macro avg': {'precision': 0.36602729452405675, 'recall': 0.3573077066690191, 'f1-score': 0.31799749768723423, 'support': 82635}, 'weighted avg': {'precision': 0.3669167662735325, 'recall': 0.35114660857989954, 'f1-score': 0.3139872558209213, 'support': 82635}}
[[ 2406 12979 13398]
 [ 1754 13409 12051]
 [ 1797 11639 13202]]
Evaluating performance on  val set...
112/112 - 1s - 915ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0996375
{'0': {'precision': 0.3769230769230769, 'recall': 0.07909604519774012, 'f1-score': 0.13075383589059375, 'support': 9912}, '1': {'precision': 0.32634874759152216, 'recall': 0.46777905638665135, 'f1-score': 0.38446987609949873, 'support': 8690}, '2': {'precision': 0.36798561151079134, 'recall': 0.5201342281879194, 'f1-score': 0.43102721833656354, 'support': 9834}, 'accuracy': 0.35040090026726683, 'macro avg': {'precision': 0.35708581200846345, 'recall': 0.3556697765907703, 'f1-score': 0.31541697677555197, 'support': 28436}, 'weighted avg': {'precision': 0.35837679907965214, 'recall': 0.35040090026726683, 'f1-score': 0.31213239941531773, 'support': 28436}}
[[ 784 4353 4775]
 [ 615 4065 4010]
 [ 681 4038 5115]]
training model: results/CHTR/W9/deepVOL_L2/h500
Epoch 1/50
323/323 - 9s - loss: 3.3378 - accuracy500: 0.3543 - val_loss: 3.3615 - val_accuracy500: 0.3248 - 9s/epoch - 29ms/step
Epoch 2/50
323/323 - 7s - loss: 3.3240 - accuracy500: 0.3495 - val_loss: 3.3321 - val_accuracy500: 0.3250 - 7s/epoch - 22ms/step
Epoch 3/50
323/323 - 7s - loss: 3.3138 - accuracy500: 0.3537 - val_loss: 3.3352 - val_accuracy500: 0.3275 - 7s/epoch - 22ms/step
Epoch 4/50
323/323 - 7s - loss: 3.3084 - accuracy500: 0.3547 - val_loss: 3.3299 - val_accuracy500: 0.3252 - 7s/epoch - 22ms/step
Epoch 5/50
323/323 - 7s - loss: 3.2998 - accuracy500: 0.3538 - val_loss: 3.3373 - val_accuracy500: 0.3236 - 7s/epoch - 22ms/step
Epoch 6/50
323/323 - 7s - loss: 3.3016 - accuracy500: 0.3493 - val_loss: 3.3057 - val_accuracy500: 0.3326 - 7s/epoch - 22ms/step
Epoch 7/50
323/323 - 7s - loss: 3.2958 - accuracy500: 0.3521 - val_loss: 3.3113 - val_accuracy500: 0.3265 - 7s/epoch - 22ms/step
Epoch 8/50
323/323 - 7s - loss: 3.2926 - accuracy500: 0.3545 - val_loss: 3.3128 - val_accuracy500: 0.3265 - 7s/epoch - 22ms/step
Epoch 9/50
323/323 - 7s - loss: 3.2898 - accuracy500: 0.3566 - val_loss: 3.3137 - val_accuracy500: 0.3258 - 7s/epoch - 22ms/step
Epoch 10/50
323/323 - 7s - loss: 3.2909 - accuracy500: 0.3557 - val_loss: 3.3054 - val_accuracy500: 0.3357 - 7s/epoch - 22ms/step
Epoch 11/50
323/323 - 7s - loss: 3.2854 - accuracy500: 0.3602 - val_loss: 3.3110 - val_accuracy500: 0.3274 - 7s/epoch - 22ms/step
Epoch 12/50
323/323 - 7s - loss: 3.2887 - accuracy500: 0.3545 - val_loss: 3.3092 - val_accuracy500: 0.3338 - 7s/epoch - 23ms/step
Epoch 13/50
323/323 - 7s - loss: 3.2875 - accuracy500: 0.3582 - val_loss: 3.3102 - val_accuracy500: 0.3303 - 7s/epoch - 22ms/step
Epoch 14/50
323/323 - 7s - loss: 3.2833 - accuracy500: 0.3604 - val_loss: 3.3195 - val_accuracy500: 0.3286 - 7s/epoch - 22ms/step
Epoch 15/50
323/323 - 7s - loss: 3.2801 - accuracy500: 0.3640 - val_loss: 3.3185 - val_accuracy500: 0.3308 - 7s/epoch - 22ms/step
Epoch 16/50
323/323 - 7s - loss: 3.2780 - accuracy500: 0.3654 - val_loss: 3.3292 - val_accuracy500: 0.3260 - 7s/epoch - 22ms/step
Epoch 17/50
323/323 - 7s - loss: 3.2755 - accuracy500: 0.3675 - val_loss: 3.3288 - val_accuracy500: 0.3294 - 7s/epoch - 22ms/step
Epoch 18/50
323/323 - 7s - loss: 3.2745 - accuracy500: 0.3667 - val_loss: 3.3458 - val_accuracy500: 0.3287 - 7s/epoch - 22ms/step
Epoch 19/50
323/323 - 7s - loss: 3.2720 - accuracy500: 0.3712 - val_loss: 3.3404 - val_accuracy500: 0.3275 - 7s/epoch - 22ms/step
Epoch 20/50
323/323 - 7s - loss: 3.2706 - accuracy500: 0.3720 - val_loss: 3.3422 - val_accuracy500: 0.3263 - 7s/epoch - 22ms/step
testing model: results/CHTR/W9/deepVOL_L2/h500
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0942434
{'0': {'precision': 0.34698596201486376, 'recall': 0.045801360306941055, 'f1-score': 0.08092129335413176, 'support': 45872}, '1': {'precision': 0.38038744556239673, 'recall': 0.7811070565863185, 'f1-score': 0.5116224268233155, 'support': 58371}, '2': {'precision': 0.3206878399719249, 'recall': 0.182144352089936, 'f1-score': 0.23232990948845722, 'support': 50169}, 'accuracy': 0.3680607724788229, 'macro avg': {'precision': 0.3493537491830618, 'recall': 0.33635092299439856, 'f1-score': 0.2749578765553015, 'support': 154412}, 'weighted avg': {'precision': 0.35106807682058383, 'recall': 0.3680607724788229, 'f1-score': 0.2929286161306821, 'support': 154412}}
[[ 2101 34902  8869]
 [ 2289 45594 10488]
 [ 1665 39366  9138]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0983219
{'0': {'precision': 0.4357643394757332, 'recall': 0.05921980812641083, 'f1-score': 0.10426952336593698, 'support': 28352}, '1': {'precision': 0.33794079753137474, 'recall': 0.7794408980849659, 'f1-score': 0.4714680395441987, 'support': 27258}, '2': {'precision': 0.33909382266071764, 'recall': 0.19966697502312675, 'f1-score': 0.2513391401555731, 'support': 27025}, 'accuracy': 0.34272402734918617, 'macro avg': {'precision': 0.37093298655594187, 'recall': 0.3461092270781678, 'f1-score': 0.27569223435523627, 'support': 82635}, 'weighted avg': {'precision': 0.37188105971237484, 'recall': 0.34272402734918617, 'f1-score': 0.27349144564737915, 'support': 82635}}
[[ 1679 21164  5509]
 [ 1004 21246  5008]
 [ 1170 20459  5396]]
Evaluating performance on  val set...
112/112 - 1s - 937ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1025527
{'0': {'precision': 0.334556126192223, 'recall': 0.04718543046357616, 'f1-score': 0.08270608506393397, 'support': 9664}, '1': {'precision': 0.3276297335203366, 'recall': 0.7638147138964577, 'f1-score': 0.458563716669393, 'support': 9175}, '2': {'precision': 0.3515748724265353, 'recall': 0.2081900593935605, 'f1-score': 0.2615183246073299, 'support': 9597}, 'accuracy': 0.3327472218314812, 'macro avg': {'precision': 0.33792024404636495, 'recall': 0.3397300679178648, 'f1-score': 0.2675960421135523, 'support': 28436}, 'weighted avg': {'precision': 0.33806503232691626, 'recall': 0.3327472218314812, 'f1-score': 0.26432638443367856, 'support': 28436}}
[[ 456 7302 1906]
 [ 388 7008 1779]
 [ 519 7080 1998]]
training model: results/CHTR/W9/deepVOL_L2/h1000
Epoch 1/50
323/323 - 10s - loss: 3.3454 - accuracy1000: 0.3575 - val_loss: 3.3424 - val_accuracy1000: 0.3378 - 10s/epoch - 31ms/step
Epoch 2/50
323/323 - 7s - loss: 3.3250 - accuracy1000: 0.3550 - val_loss: 3.3346 - val_accuracy1000: 0.3324 - 7s/epoch - 22ms/step
Epoch 3/50
323/323 - 7s - loss: 3.3116 - accuracy1000: 0.3472 - val_loss: 3.3062 - val_accuracy1000: 0.3332 - 7s/epoch - 22ms/step
Epoch 4/50
323/323 - 7s - loss: 3.3044 - accuracy1000: 0.3456 - val_loss: 3.2995 - val_accuracy1000: 0.3352 - 7s/epoch - 22ms/step
Epoch 5/50
323/323 - 7s - loss: 3.3014 - accuracy1000: 0.3371 - val_loss: 3.3003 - val_accuracy1000: 0.3347 - 7s/epoch - 22ms/step
Epoch 6/50
323/323 - 7s - loss: 3.2991 - accuracy1000: 0.3379 - val_loss: 3.3005 - val_accuracy1000: 0.3361 - 7s/epoch - 22ms/step
Epoch 7/50
323/323 - 7s - loss: 3.2977 - accuracy1000: 0.3387 - val_loss: 3.2991 - val_accuracy1000: 0.3375 - 7s/epoch - 22ms/step
Epoch 8/50
323/323 - 7s - loss: 3.2959 - accuracy1000: 0.3386 - val_loss: 3.2989 - val_accuracy1000: 0.3441 - 7s/epoch - 22ms/step
Epoch 9/50
323/323 - 7s - loss: 3.2942 - accuracy1000: 0.3392 - val_loss: 3.2993 - val_accuracy1000: 0.3422 - 7s/epoch - 22ms/step
Epoch 10/50
323/323 - 7s - loss: 3.2928 - accuracy1000: 0.3404 - val_loss: 3.2987 - val_accuracy1000: 0.3452 - 7s/epoch - 22ms/step
Epoch 11/50
323/323 - 7s - loss: 3.2914 - accuracy1000: 0.3419 - val_loss: 3.2983 - val_accuracy1000: 0.3451 - 7s/epoch - 22ms/step
Epoch 12/50
323/323 - 7s - loss: 3.2916 - accuracy1000: 0.3416 - val_loss: 3.2977 - val_accuracy1000: 0.3488 - 7s/epoch - 22ms/step
Epoch 13/50
323/323 - 7s - loss: 3.2883 - accuracy1000: 0.3456 - val_loss: 3.2970 - val_accuracy1000: 0.3486 - 7s/epoch - 22ms/step
Epoch 14/50
323/323 - 7s - loss: 3.2874 - accuracy1000: 0.3445 - val_loss: 3.2967 - val_accuracy1000: 0.3483 - 7s/epoch - 22ms/step
Epoch 15/50
323/323 - 7s - loss: 3.2852 - accuracy1000: 0.3499 - val_loss: 3.2998 - val_accuracy1000: 0.3487 - 7s/epoch - 22ms/step
Epoch 16/50
323/323 - 7s - loss: 3.2832 - accuracy1000: 0.3517 - val_loss: 3.2994 - val_accuracy1000: 0.3490 - 7s/epoch - 22ms/step
Epoch 17/50
323/323 - 7s - loss: 3.2823 - accuracy1000: 0.3519 - val_loss: 3.2990 - val_accuracy1000: 0.3487 - 7s/epoch - 22ms/step
Epoch 18/50
323/323 - 7s - loss: 3.2813 - accuracy1000: 0.3529 - val_loss: 3.2975 - val_accuracy1000: 0.3469 - 7s/epoch - 22ms/step
Epoch 19/50
323/323 - 8s - loss: 3.2782 - accuracy1000: 0.3554 - val_loss: 3.3006 - val_accuracy1000: 0.3489 - 8s/epoch - 23ms/step
Epoch 20/50
323/323 - 7s - loss: 3.2772 - accuracy1000: 0.3565 - val_loss: 3.3026 - val_accuracy1000: 0.3428 - 7s/epoch - 22ms/step
Epoch 21/50
323/323 - 7s - loss: 3.2740 - accuracy1000: 0.3593 - val_loss: 3.2999 - val_accuracy1000: 0.3512 - 7s/epoch - 22ms/step
Epoch 22/50
323/323 - 7s - loss: 3.2739 - accuracy1000: 0.3596 - val_loss: 3.2983 - val_accuracy1000: 0.3546 - 7s/epoch - 22ms/step
Epoch 23/50
323/323 - 7s - loss: 3.2720 - accuracy1000: 0.3580 - val_loss: 3.3015 - val_accuracy1000: 0.3457 - 7s/epoch - 22ms/step
Epoch 24/50
323/323 - 7s - loss: 3.2697 - accuracy1000: 0.3650 - val_loss: 3.3013 - val_accuracy1000: 0.3510 - 7s/epoch - 22ms/step
testing model: results/CHTR/W9/deepVOL_L2/h1000
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0966104
{'0': {'precision': 0.33194013752190915, 'recall': 0.05343693703470579, 'f1-score': 0.09205458964292391, 'support': 46073}, '1': {'precision': 0.409358667342551, 'recall': 0.3957315939775934, 'f1-score': 0.4024298037598378, 'support': 59179}, '2': {'precision': 0.31617401376606596, 'recall': 0.5774613506916192, 'f1-score': 0.40861917579491314, 'support': 49160}, 'accuracy': 0.35145584540061653, 'macro avg': {'precision': 0.35249093954350874, 'recall': 0.34220996056797276, 'f1-score': 0.30103452306589157, 'support': 154412}, 'weighted avg': {'precision': 0.3565916447390847, 'recall': 0.35145584540061653, 'f1-score': 0.3117914614628384, 'support': 154412}}
[[ 2462 15290 28321]
 [ 2683 23419 33077]
 [ 2272 18500 28388]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0956227
{'0': {'precision': 0.4217753800882786, 'recall': 0.06129503581483197, 'f1-score': 0.10703506643019384, 'support': 28061}, '1': {'precision': 0.3562163529284243, 'recall': 0.361228153739054, 'f1-score': 0.35870474804438784, 'support': 27293}, '2': {'precision': 0.33702830188679245, 'recall': 0.6285693339686962, 'f1-score': 0.43878660713143386, 'support': 27281}, 'accuracy': 0.347637199733769, 'macro avg': {'precision': 0.3716733449678318, 'recall': 0.3503641745075274, 'f1-score': 0.3015088072020052, 'support': 82635}, 'weighted avg': {'precision': 0.37214401845351547, 'recall': 0.347637199733769, 'f1-score': 0.2996814560007962, 'support': 82635}}
[[ 1720  8940 17401]
 [ 1103  9859 16331]
 [ 1255  8878 17148]]
Evaluating performance on  val set...
112/112 - 1s - 998ms/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0997134
{'0': {'precision': 0.33454545454545453, 'recall': 0.047802140704561985, 'f1-score': 0.08365157301327514, 'support': 9623}, '1': {'precision': 0.3706528018486424, 'recall': 0.3374710709025878, 'f1-score': 0.3532845107648257, 'support': 9506}, '2': {'precision': 0.341247419319787, 'recall': 0.6748683786397335, 'f1-score': 0.4532890701115, 'support': 9307}, 'accuracy': 0.34987339991559996, 'macro avg': {'precision': 0.3488152252379613, 'recall': 0.35338053008229436, 'f1-score': 0.2967417179632003, 'support': 28436}, 'weighted avg': {'precision': 0.3488094730297286, 'recall': 0.34987339991559996, 'f1-score': 0.29476941278537455, 'support': 28436}}
[[ 460 2885 6278]
 [ 451 3208 5847]
 [ 464 2562 6281]]
training model: results/CHTR/W9/deepVOL_L3/h10
Epoch 1/50
323/323 - 14s - loss: 3.3288 - accuracy10: 0.3526 - val_loss: 3.3172 - val_accuracy10: 0.3203 - 14s/epoch - 44ms/step
Epoch 2/50
323/323 - 11s - loss: 3.3122 - accuracy10: 0.3540 - val_loss: 3.3620 - val_accuracy10: 0.2889 - 11s/epoch - 35ms/step
Epoch 3/50
323/323 - 12s - loss: 3.3022 - accuracy10: 0.3532 - val_loss: 3.3542 - val_accuracy10: 0.2866 - 12s/epoch - 36ms/step
Epoch 4/50
323/323 - 12s - loss: 3.3001 - accuracy10: 0.3545 - val_loss: 3.3236 - val_accuracy10: 0.3103 - 12s/epoch - 36ms/step
Epoch 5/50
323/323 - 12s - loss: 3.2931 - accuracy10: 0.3540 - val_loss: 3.2932 - val_accuracy10: 0.3228 - 12s/epoch - 38ms/step
Epoch 6/50
323/323 - 12s - loss: 3.2864 - accuracy10: 0.3593 - val_loss: 3.2843 - val_accuracy10: 0.3572 - 12s/epoch - 36ms/step
Epoch 7/50
323/323 - 12s - loss: 3.2796 - accuracy10: 0.3623 - val_loss: 3.2834 - val_accuracy10: 0.3512 - 12s/epoch - 37ms/step
Epoch 8/50
323/323 - 12s - loss: 3.2738 - accuracy10: 0.3656 - val_loss: 3.2791 - val_accuracy10: 0.3500 - 12s/epoch - 37ms/step
Epoch 9/50
323/323 - 12s - loss: 3.2651 - accuracy10: 0.3714 - val_loss: 3.2854 - val_accuracy10: 0.3444 - 12s/epoch - 37ms/step
Epoch 10/50
323/323 - 11s - loss: 3.2580 - accuracy10: 0.3746 - val_loss: 3.2780 - val_accuracy10: 0.3551 - 11s/epoch - 35ms/step
Epoch 11/50
323/323 - 12s - loss: 3.2541 - accuracy10: 0.3784 - val_loss: 3.2843 - val_accuracy10: 0.3491 - 12s/epoch - 36ms/step
Epoch 12/50
323/323 - 11s - loss: 3.2494 - accuracy10: 0.3797 - val_loss: 3.2822 - val_accuracy10: 0.3607 - 11s/epoch - 35ms/step
Epoch 13/50
323/323 - 12s - loss: 3.2440 - accuracy10: 0.3827 - val_loss: 3.2715 - val_accuracy10: 0.3612 - 12s/epoch - 36ms/step
Epoch 14/50
323/323 - 12s - loss: 3.2409 - accuracy10: 0.3847 - val_loss: 3.2713 - val_accuracy10: 0.3564 - 12s/epoch - 36ms/step
Epoch 15/50
323/323 - 11s - loss: 3.2354 - accuracy10: 0.3874 - val_loss: 3.2744 - val_accuracy10: 0.3613 - 11s/epoch - 35ms/step
Epoch 16/50
323/323 - 11s - loss: 3.2315 - accuracy10: 0.3895 - val_loss: 3.2691 - val_accuracy10: 0.3606 - 11s/epoch - 35ms/step
Epoch 17/50
323/323 - 11s - loss: 3.2274 - accuracy10: 0.3941 - val_loss: 3.2662 - val_accuracy10: 0.3674 - 11s/epoch - 35ms/step
Epoch 18/50
323/323 - 11s - loss: 3.2242 - accuracy10: 0.3935 - val_loss: 3.2653 - val_accuracy10: 0.3664 - 11s/epoch - 35ms/step
Epoch 19/50
323/323 - 12s - loss: 3.2173 - accuracy10: 0.3966 - val_loss: 3.2603 - val_accuracy10: 0.3707 - 12s/epoch - 36ms/step
Epoch 20/50
323/323 - 11s - loss: 3.2152 - accuracy10: 0.3989 - val_loss: 3.2643 - val_accuracy10: 0.3682 - 11s/epoch - 35ms/step
Epoch 21/50
323/323 - 11s - loss: 3.2138 - accuracy10: 0.4008 - val_loss: 3.2577 - val_accuracy10: 0.3719 - 11s/epoch - 35ms/step
Epoch 22/50
323/323 - 11s - loss: 3.2093 - accuracy10: 0.4010 - val_loss: 3.2583 - val_accuracy10: 0.3677 - 11s/epoch - 35ms/step
Epoch 23/50
323/323 - 11s - loss: 3.2057 - accuracy10: 0.4014 - val_loss: 3.2609 - val_accuracy10: 0.3664 - 11s/epoch - 35ms/step
Epoch 24/50
323/323 - 11s - loss: 3.2017 - accuracy10: 0.4057 - val_loss: 3.2612 - val_accuracy10: 0.3650 - 11s/epoch - 35ms/step
Epoch 25/50
323/323 - 11s - loss: 3.1998 - accuracy10: 0.4047 - val_loss: 3.2579 - val_accuracy10: 0.3727 - 11s/epoch - 35ms/step
Epoch 26/50
323/323 - 11s - loss: 3.1936 - accuracy10: 0.4080 - val_loss: 3.2588 - val_accuracy10: 0.3653 - 11s/epoch - 34ms/step
Epoch 27/50
323/323 - 11s - loss: 3.1907 - accuracy10: 0.4090 - val_loss: 3.2581 - val_accuracy10: 0.3672 - 11s/epoch - 34ms/step
Epoch 28/50
323/323 - 11s - loss: 3.1862 - accuracy10: 0.4105 - val_loss: 3.2699 - val_accuracy10: 0.3627 - 11s/epoch - 34ms/step
Epoch 29/50
323/323 - 11s - loss: 3.1850 - accuracy10: 0.4125 - val_loss: 3.2648 - val_accuracy10: 0.3652 - 11s/epoch - 34ms/step
Epoch 30/50
323/323 - 11s - loss: 3.1784 - accuracy10: 0.4148 - val_loss: 3.2680 - val_accuracy10: 0.3690 - 11s/epoch - 34ms/step
Epoch 31/50
323/323 - 11s - loss: 3.1775 - accuracy10: 0.4124 - val_loss: 3.2624 - val_accuracy10: 0.3677 - 11s/epoch - 35ms/step
testing model: results/CHTR/W9/deepVOL_L3/h10
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.085634
{'0': {'precision': 0.3618467055132228, 'recall': 0.3853291583931572, 'f1-score': 0.373218925391351, 'support': 52376}, '1': {'precision': 0.4243140794223827, 'recall': 0.4370955745630346, 'f1-score': 0.43061000183183734, 'support': 53780}, '2': {'precision': 0.3722737470222263, 'recall': 0.33355437665782495, 'f1-score': 0.35185205425551686, 'support': 48256}, 'accuracy': 0.3871784576328265, 'macro avg': {'precision': 0.3861448439859439, 'recall': 0.38532636987133895, 'f1-score': 0.3852269938262351, 'support': 154412}, 'weighted avg': {'precision': 0.3868620066808334, 'recall': 0.3871784576328265, 'f1-score': 0.38653014704147237, 'support': 154412}}
[[20182 17279 14915]
 [18047 23507 12226]
 [17546 14614 16096]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0712792
{'0': {'precision': 0.3840445830935579, 'recall': 0.4311458687521251, 'f1-score': 0.40623448187482986, 'support': 29410}, '1': {'precision': 0.4114410261907314, 'recall': 0.44414873100362573, 'f1-score': 0.4271696993304027, 'support': 25926}, '2': {'precision': 0.41172391475197634, 'recall': 0.3262390563756914, 'f1-score': 0.3640302472920499, 'support': 27299}, 'accuracy': 0.4005687662612694, 'macro avg': {'precision': 0.40240317467875525, 'recall': 0.40051121871048073, 'f1-score': 0.39914480949909414, 'support': 82635}, 'weighted avg': {'precision': 0.40178401866783614, 'recall': 0.4005687662612694, 'f1-score': 0.3988602826599436, 'support': 82635}}
[[12680  8912  7818]
 [ 9504 11515  4907]
 [10833  7560  8906]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0892633
{'0': {'precision': 0.39624714732482463, 'recall': 0.4302101495824539, 'f1-score': 0.41253079901443157, 'support': 10897}, '1': {'precision': 0.3135090218423552, 'recall': 0.3556423377322919, 'f1-score': 0.33324921135646685, 'support': 7426}, '2': {'precision': 0.39787312064539787, 'recall': 0.32186294867991694, 'f1-score': 0.3558543784847491, 'support': 10113}, 'accuracy': 0.3722042481361654, 'macro avg': {'precision': 0.36920976327085925, 'recall': 0.3692384786648876, 'f1-score': 0.3672114629518825, 'support': 28436}, 'weighted avg': {'precision': 0.3752185268563389, 'recall': 0.3722042481361654, 'f1-score': 0.37167013961209916, 'support': 28436}}
[[4688 3051 3158]
 [3017 2641 1768]
 [4126 2732 3255]]
training model: results/CHTR/W9/deepVOL_L3/h20
Epoch 1/50
323/323 - 14s - loss: 3.3277 - accuracy20: 0.3521 - val_loss: 3.4488 - val_accuracy20: 0.2894 - 14s/epoch - 43ms/step
Epoch 2/50
323/323 - 12s - loss: 3.3106 - accuracy20: 0.3530 - val_loss: 3.3828 - val_accuracy20: 0.2915 - 12s/epoch - 36ms/step
Epoch 3/50
323/323 - 11s - loss: 3.3042 - accuracy20: 0.3540 - val_loss: 3.3956 - val_accuracy20: 0.2871 - 11s/epoch - 35ms/step
Epoch 4/50
323/323 - 11s - loss: 3.3056 - accuracy20: 0.3495 - val_loss: 3.3605 - val_accuracy20: 0.2862 - 11s/epoch - 36ms/step
Epoch 5/50
323/323 - 11s - loss: 3.3023 - accuracy20: 0.3431 - val_loss: 3.3122 - val_accuracy20: 0.3096 - 11s/epoch - 35ms/step
Epoch 6/50
323/323 - 11s - loss: 3.2945 - accuracy20: 0.3470 - val_loss: 3.3152 - val_accuracy20: 0.3121 - 11s/epoch - 35ms/step
Epoch 7/50
323/323 - 11s - loss: 3.2895 - accuracy20: 0.3511 - val_loss: 3.3080 - val_accuracy20: 0.3203 - 11s/epoch - 35ms/step
Epoch 8/50
323/323 - 12s - loss: 3.2850 - accuracy20: 0.3581 - val_loss: 3.3048 - val_accuracy20: 0.3362 - 12s/epoch - 36ms/step
Epoch 9/50
323/323 - 11s - loss: 3.2820 - accuracy20: 0.3591 - val_loss: 3.3065 - val_accuracy20: 0.3392 - 11s/epoch - 35ms/step
Epoch 10/50
323/323 - 11s - loss: 3.2754 - accuracy20: 0.3671 - val_loss: 3.2961 - val_accuracy20: 0.3451 - 11s/epoch - 35ms/step
Epoch 11/50
323/323 - 11s - loss: 3.2695 - accuracy20: 0.3737 - val_loss: 3.2913 - val_accuracy20: 0.3548 - 11s/epoch - 35ms/step
Epoch 12/50
323/323 - 11s - loss: 3.2643 - accuracy20: 0.3773 - val_loss: 3.2917 - val_accuracy20: 0.3582 - 11s/epoch - 34ms/step
Epoch 13/50
323/323 - 11s - loss: 3.2619 - accuracy20: 0.3783 - val_loss: 3.2850 - val_accuracy20: 0.3585 - 11s/epoch - 35ms/step
Epoch 14/50
323/323 - 11s - loss: 3.2566 - accuracy20: 0.3832 - val_loss: 3.2818 - val_accuracy20: 0.3666 - 11s/epoch - 35ms/step
Epoch 15/50
323/323 - 12s - loss: 3.2527 - accuracy20: 0.3864 - val_loss: 3.2906 - val_accuracy20: 0.3567 - 12s/epoch - 36ms/step
Epoch 16/50
323/323 - 11s - loss: 3.2480 - accuracy20: 0.3896 - val_loss: 3.2858 - val_accuracy20: 0.3613 - 11s/epoch - 35ms/step
Epoch 17/50
323/323 - 11s - loss: 3.2456 - accuracy20: 0.3924 - val_loss: 3.2926 - val_accuracy20: 0.3560 - 11s/epoch - 35ms/step
Epoch 18/50
323/323 - 12s - loss: 3.2419 - accuracy20: 0.3926 - val_loss: 3.2953 - val_accuracy20: 0.3580 - 12s/epoch - 36ms/step
Epoch 19/50
323/323 - 11s - loss: 3.2406 - accuracy20: 0.3931 - val_loss: 3.2816 - val_accuracy20: 0.3662 - 11s/epoch - 35ms/step
Epoch 20/50
323/323 - 11s - loss: 3.2373 - accuracy20: 0.3965 - val_loss: 3.2875 - val_accuracy20: 0.3657 - 11s/epoch - 35ms/step
Epoch 21/50
323/323 - 11s - loss: 3.2366 - accuracy20: 0.3969 - val_loss: 3.2849 - val_accuracy20: 0.3654 - 11s/epoch - 35ms/step
Epoch 22/50
323/323 - 11s - loss: 3.2328 - accuracy20: 0.3981 - val_loss: 3.2815 - val_accuracy20: 0.3706 - 11s/epoch - 36ms/step
Epoch 23/50
323/323 - 11s - loss: 3.2299 - accuracy20: 0.4006 - val_loss: 3.2718 - val_accuracy20: 0.3765 - 11s/epoch - 35ms/step
Epoch 24/50
323/323 - 11s - loss: 3.2255 - accuracy20: 0.4042 - val_loss: 3.2844 - val_accuracy20: 0.3695 - 11s/epoch - 35ms/step
Epoch 25/50
323/323 - 11s - loss: 3.2224 - accuracy20: 0.4054 - val_loss: 3.2854 - val_accuracy20: 0.3688 - 11s/epoch - 35ms/step
Epoch 26/50
323/323 - 11s - loss: 3.2204 - accuracy20: 0.4083 - val_loss: 3.2850 - val_accuracy20: 0.3654 - 11s/epoch - 35ms/step
Epoch 27/50
323/323 - 12s - loss: 3.2164 - accuracy20: 0.4068 - val_loss: 3.2863 - val_accuracy20: 0.3700 - 12s/epoch - 36ms/step
Epoch 28/50
323/323 - 11s - loss: 3.2119 - accuracy20: 0.4110 - val_loss: 3.2892 - val_accuracy20: 0.3657 - 11s/epoch - 35ms/step
Epoch 29/50
323/323 - 11s - loss: 3.2082 - accuracy20: 0.4121 - val_loss: 3.2925 - val_accuracy20: 0.3684 - 11s/epoch - 34ms/step
Epoch 30/50
323/323 - 11s - loss: 3.2074 - accuracy20: 0.4115 - val_loss: 3.2930 - val_accuracy20: 0.3681 - 11s/epoch - 35ms/step
Epoch 31/50
323/323 - 11s - loss: 3.2026 - accuracy20: 0.4149 - val_loss: 3.2896 - val_accuracy20: 0.3714 - 11s/epoch - 35ms/step
Epoch 32/50
323/323 - 11s - loss: 3.2004 - accuracy20: 0.4171 - val_loss: 3.2887 - val_accuracy20: 0.3748 - 11s/epoch - 35ms/step
Epoch 33/50
323/323 - 11s - loss: 3.1967 - accuracy20: 0.4169 - val_loss: 3.2862 - val_accuracy20: 0.3716 - 11s/epoch - 35ms/step
testing model: results/CHTR/W9/deepVOL_L3/h20
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0811244
{'0': {'precision': 0.36225321888412015, 'recall': 0.3453842376626565, 'f1-score': 0.35361766307763204, 'support': 48876}, '1': {'precision': 0.4544445313110781, 'recall': 0.48778195488721804, 'f1-score': 0.470523478415723, 'support': 59584}, '2': {'precision': 0.35736598490548827, 'recall': 0.3410732938718663, 'f1-score': 0.349029607277667, 'support': 45952}, 'accuracy': 0.399049296686786, 'macro avg': {'precision': 0.39135457836689547, 'recall': 0.3914131621405803, 'f1-score': 0.3910569162570074, 'support': 154412}, 'weighted avg': {'precision': 0.3963732936442539, 'recall': 0.399049296686786, 'f1-score': 0.3973635232503182, 'support': 154412}}
[[16881 18630 13365]
 [15701 29064 14819]
 [14018 16261 15673]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.075386
{'0': {'precision': 0.3939440222994387, 'recall': 0.3605577689243028, 'f1-score': 0.3765122347316753, 'support': 28614}, '1': {'precision': 0.4135671836498043, 'recall': 0.5118582038678196, 'f1-score': 0.4574928647019209, 'support': 27871}, '2': {'precision': 0.3963828527174161, 'recall': 0.3327342256214149, 'f1-score': 0.3617804203654809, 'support': 26150}, 'accuracy': 0.402783324257276, 'macro avg': {'precision': 0.40129801955555305, 'recall': 0.4017167328045124, 'f1-score': 0.398595173266359, 'support': 82635}, 'weighted avg': {'precision': 0.4013342630621439, 'recall': 0.402783324257276, 'f1-score': 0.3991633413115111, 'support': 82635}}
[[10317 11017  7280]
 [ 7635 14266  5970]
 [ 8237  9212  8701]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0902798
{'0': {'precision': 0.41022404544020197, 'recall': 0.36855036855036855, 'f1-score': 0.3882721887600179, 'support': 10582}, '1': {'precision': 0.32828328922150224, 'recall': 0.445724907063197, 'f1-score': 0.37809428706574866, 'support': 8070}, '2': {'precision': 0.3926241846462619, 'recall': 0.31991005723630417, 'f1-score': 0.3525568821806713, 'support': 9784}, 'accuracy': 0.3737164158109439, 'macro avg': {'precision': 0.37704383976932204, 'recall': 0.3780617776166233, 'f1-score': 0.37297445266881263, 'support': 28436}, 'weighted avg': {'precision': 0.3809140531525097, 'recall': 0.3737164158109439, 'f1-score': 0.37309515168570784, 'support': 28436}}
[[3900 3825 2857]
 [2488 3597 1985]
 [3119 3535 3130]]
training model: results/CHTR/W9/deepVOL_L3/h30
Epoch 1/50
323/323 - 14s - loss: 3.3284 - accuracy30: 0.3572 - val_loss: 3.4286 - val_accuracy30: 0.2881 - 14s/epoch - 44ms/step
Epoch 2/50
323/323 - 12s - loss: 3.3108 - accuracy30: 0.3571 - val_loss: 3.4266 - val_accuracy30: 0.2829 - 12s/epoch - 36ms/step
Epoch 3/50
323/323 - 11s - loss: 3.3038 - accuracy30: 0.3557 - val_loss: 3.4000 - val_accuracy30: 0.2832 - 11s/epoch - 35ms/step
Epoch 4/50
323/323 - 11s - loss: 3.2957 - accuracy30: 0.3608 - val_loss: 3.4150 - val_accuracy30: 0.2820 - 11s/epoch - 35ms/step
Epoch 5/50
323/323 - 11s - loss: 3.3026 - accuracy30: 0.3477 - val_loss: 3.3528 - val_accuracy30: 0.2865 - 11s/epoch - 35ms/step
Epoch 6/50
323/323 - 11s - loss: 3.2972 - accuracy30: 0.3511 - val_loss: 3.3432 - val_accuracy30: 0.2914 - 11s/epoch - 35ms/step
Epoch 7/50
323/323 - 11s - loss: 3.2934 - accuracy30: 0.3521 - val_loss: 3.3148 - val_accuracy30: 0.3067 - 11s/epoch - 35ms/step
Epoch 8/50
323/323 - 11s - loss: 3.2904 - accuracy30: 0.3529 - val_loss: 3.3310 - val_accuracy30: 0.2959 - 11s/epoch - 34ms/step
Epoch 9/50
323/323 - 11s - loss: 3.2866 - accuracy30: 0.3548 - val_loss: 3.3290 - val_accuracy30: 0.2986 - 11s/epoch - 34ms/step
Epoch 10/50
323/323 - 11s - loss: 3.2847 - accuracy30: 0.3584 - val_loss: 3.3077 - val_accuracy30: 0.3257 - 11s/epoch - 35ms/step
Epoch 11/50
323/323 - 11s - loss: 3.2803 - accuracy30: 0.3608 - val_loss: 3.3133 - val_accuracy30: 0.3267 - 11s/epoch - 35ms/step
Epoch 12/50
323/323 - 11s - loss: 3.2773 - accuracy30: 0.3644 - val_loss: 3.3146 - val_accuracy30: 0.3262 - 11s/epoch - 35ms/step
Epoch 13/50
323/323 - 11s - loss: 3.2739 - accuracy30: 0.3688 - val_loss: 3.3056 - val_accuracy30: 0.3334 - 11s/epoch - 35ms/step
Epoch 14/50
323/323 - 11s - loss: 3.2697 - accuracy30: 0.3737 - val_loss: 3.2962 - val_accuracy30: 0.3484 - 11s/epoch - 35ms/step
Epoch 15/50
323/323 - 11s - loss: 3.2658 - accuracy30: 0.3769 - val_loss: 3.3085 - val_accuracy30: 0.3429 - 11s/epoch - 35ms/step
Epoch 16/50
323/323 - 11s - loss: 3.2627 - accuracy30: 0.3790 - val_loss: 3.3031 - val_accuracy30: 0.3458 - 11s/epoch - 34ms/step
Epoch 17/50
323/323 - 11s - loss: 3.2578 - accuracy30: 0.3835 - val_loss: 3.3119 - val_accuracy30: 0.3407 - 11s/epoch - 35ms/step
Epoch 18/50
323/323 - 11s - loss: 3.2550 - accuracy30: 0.3830 - val_loss: 3.2992 - val_accuracy30: 0.3583 - 11s/epoch - 34ms/step
Epoch 19/50
323/323 - 11s - loss: 3.2556 - accuracy30: 0.3844 - val_loss: 3.3194 - val_accuracy30: 0.3364 - 11s/epoch - 35ms/step
Epoch 20/50
323/323 - 11s - loss: 3.2510 - accuracy30: 0.3867 - val_loss: 3.3022 - val_accuracy30: 0.3547 - 11s/epoch - 36ms/step
Epoch 21/50
323/323 - 11s - loss: 3.2464 - accuracy30: 0.3887 - val_loss: 3.3115 - val_accuracy30: 0.3561 - 11s/epoch - 35ms/step
Epoch 22/50
323/323 - 11s - loss: 3.2439 - accuracy30: 0.3904 - val_loss: 3.3337 - val_accuracy30: 0.3383 - 11s/epoch - 35ms/step
Epoch 23/50
323/323 - 11s - loss: 3.2413 - accuracy30: 0.3931 - val_loss: 3.3289 - val_accuracy30: 0.3419 - 11s/epoch - 35ms/step
Epoch 24/50
323/323 - 11s - loss: 3.2376 - accuracy30: 0.3935 - val_loss: 3.3247 - val_accuracy30: 0.3467 - 11s/epoch - 35ms/step
testing model: results/CHTR/W9/deepVOL_L3/h30
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0915666
{'0': {'precision': 0.34294777220419004, 'recall': 0.1894187870515615, 'f1-score': 0.24404519744353598, 'support': 49087}, '1': {'precision': 0.4178878138032209, 'recall': 0.4255976363147999, 'f1-score': 0.4217074894997297, 'support': 59568}, '2': {'precision': 0.32423874056398483, 'recall': 0.47216819284481065, 'f1-score': 0.3844648100364801, 'support': 45757}, 'accuracy': 0.36431754008755796, 'macro avg': {'precision': 0.3616914421904653, 'recall': 0.3623948720703907, 'f1-score': 0.3500724989932486, 'support': 154412}, 'weighted avg': {'precision': 0.36631356784967223, 'recall': 0.36431754008755796, 'f1-score': 0.3541931627999765, 'support': 154412}}
[[ 9298 19021 20768]
 [ 9956 25352 24260]
 [ 7858 16294 21605]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0887161
{'0': {'precision': 0.39149344419571475, 'recall': 0.21175534491109113, 'f1-score': 0.27484789295256057, 'support': 28906}, '1': {'precision': 0.3816357484540894, 'recall': 0.47330342931558383, 'f1-score': 0.42255522542307195, 'support': 27644}, '2': {'precision': 0.3540163834209561, 'recall': 0.4440099674142227, 'f1-score': 0.39393887859050014, 'support': 26085}, 'accuracy': 0.3725661039511103, 'macro avg': {'precision': 0.37571519202358666, 'recall': 0.3763562472136326, 'f1-score': 0.36378066565537753, 'support': 82635}, 'weighted avg': {'precision': 0.3763655290097636, 'recall': 0.3725661039511103, 'f1-score': 0.3618535184040093, 'support': 82635}}
[[ 6121 11458 11327]
 [ 4753 13084  9807]
 [ 4761  9742 11582]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0987507
{'0': {'precision': 0.40230905861456484, 'recall': 0.21436683702441794, 'f1-score': 0.2796986910348234, 'support': 10566}, '1': {'precision': 0.29987316542851966, 'recall': 0.4161951464856029, 'f1-score': 0.34858617239745143, 'support': 7953}, '2': {'precision': 0.36896668932698845, 'recall': 0.43783402238580216, 'f1-score': 0.4004611482591653, 'support': 9917}, 'accuracy': 0.3487480658320439, 'macro avg': {'precision': 0.3570496377900243, 'recall': 0.35613200196527434, 'f1-score': 0.34291533723048007, 'support': 28436}, 'weighted avg': {'precision': 0.36203163089148455, 'recall': 0.3487480658320439, 'f1-score': 0.34108086249251013, 'support': 28436}}
[[2265 4032 4269]
 [1486 3310 3157]
 [1879 3696 4342]]
training model: results/CHTR/W9/deepVOL_L3/h50
Epoch 1/50
323/323 - 14s - loss: 3.3292 - accuracy50: 0.3571 - val_loss: 3.4048 - val_accuracy50: 0.2925 - 14s/epoch - 42ms/step
Epoch 2/50
323/323 - 11s - loss: 3.3138 - accuracy50: 0.3560 - val_loss: 3.3760 - val_accuracy50: 0.2886 - 11s/epoch - 35ms/step
Epoch 3/50
323/323 - 11s - loss: 3.3110 - accuracy50: 0.3397 - val_loss: 3.3164 - val_accuracy50: 0.2986 - 11s/epoch - 35ms/step
Epoch 4/50
323/323 - 11s - loss: 3.3024 - accuracy50: 0.3359 - val_loss: 3.3099 - val_accuracy50: 0.3040 - 11s/epoch - 35ms/step
Epoch 5/50
323/323 - 11s - loss: 3.3000 - accuracy50: 0.3416 - val_loss: 3.3196 - val_accuracy50: 0.2944 - 11s/epoch - 35ms/step
Epoch 6/50
323/323 - 11s - loss: 3.2982 - accuracy50: 0.3420 - val_loss: 3.3168 - val_accuracy50: 0.2985 - 11s/epoch - 35ms/step
Epoch 7/50
323/323 - 11s - loss: 3.2973 - accuracy50: 0.3406 - val_loss: 3.3073 - val_accuracy50: 0.3052 - 11s/epoch - 35ms/step
Epoch 8/50
323/323 - 11s - loss: 3.2962 - accuracy50: 0.3433 - val_loss: 3.3056 - val_accuracy50: 0.3099 - 11s/epoch - 35ms/step
Epoch 9/50
323/323 - 11s - loss: 3.2953 - accuracy50: 0.3441 - val_loss: 3.3053 - val_accuracy50: 0.3132 - 11s/epoch - 35ms/step
Epoch 10/50
323/323 - 11s - loss: 3.2929 - accuracy50: 0.3488 - val_loss: 3.3090 - val_accuracy50: 0.3127 - 11s/epoch - 34ms/step
Epoch 11/50
323/323 - 11s - loss: 3.2919 - accuracy50: 0.3491 - val_loss: 3.3059 - val_accuracy50: 0.3148 - 11s/epoch - 35ms/step
Epoch 12/50
323/323 - 11s - loss: 3.2908 - accuracy50: 0.3507 - val_loss: 3.3041 - val_accuracy50: 0.3210 - 11s/epoch - 35ms/step
Epoch 13/50
323/323 - 11s - loss: 3.2932 - accuracy50: 0.3552 - val_loss: 3.3454 - val_accuracy50: 0.2850 - 11s/epoch - 35ms/step
Epoch 14/50
323/323 - 11s - loss: 3.2981 - accuracy50: 0.3434 - val_loss: 3.3103 - val_accuracy50: 0.3024 - 11s/epoch - 35ms/step
Epoch 15/50
323/323 - 11s - loss: 3.2932 - accuracy50: 0.3457 - val_loss: 3.3086 - val_accuracy50: 0.3093 - 11s/epoch - 34ms/step
Epoch 16/50
323/323 - 11s - loss: 3.2902 - accuracy50: 0.3505 - val_loss: 3.3061 - val_accuracy50: 0.3185 - 11s/epoch - 35ms/step
Epoch 17/50
323/323 - 11s - loss: 3.2854 - accuracy50: 0.3546 - val_loss: 3.3020 - val_accuracy50: 0.3271 - 11s/epoch - 35ms/step
Epoch 18/50
323/323 - 11s - loss: 3.2837 - accuracy50: 0.3568 - val_loss: 3.3090 - val_accuracy50: 0.3263 - 11s/epoch - 35ms/step
Epoch 19/50
323/323 - 11s - loss: 3.2812 - accuracy50: 0.3591 - val_loss: 3.3094 - val_accuracy50: 0.3268 - 11s/epoch - 35ms/step
Epoch 20/50
323/323 - 11s - loss: 3.2793 - accuracy50: 0.3613 - val_loss: 3.3018 - val_accuracy50: 0.3366 - 11s/epoch - 34ms/step
Epoch 21/50
323/323 - 11s - loss: 3.2765 - accuracy50: 0.3655 - val_loss: 3.3068 - val_accuracy50: 0.3328 - 11s/epoch - 35ms/step
Epoch 22/50
323/323 - 11s - loss: 3.2744 - accuracy50: 0.3644 - val_loss: 3.3052 - val_accuracy50: 0.3340 - 11s/epoch - 35ms/step
Epoch 23/50
323/323 - 11s - loss: 3.2751 - accuracy50: 0.3665 - val_loss: 3.3039 - val_accuracy50: 0.3417 - 11s/epoch - 35ms/step
Epoch 24/50
323/323 - 11s - loss: 3.2744 - accuracy50: 0.3663 - val_loss: 3.3077 - val_accuracy50: 0.3284 - 11s/epoch - 35ms/step
Epoch 25/50
323/323 - 12s - loss: 3.2724 - accuracy50: 0.3661 - val_loss: 3.3082 - val_accuracy50: 0.3370 - 12s/epoch - 37ms/step
Epoch 26/50
323/323 - 11s - loss: 3.2696 - accuracy50: 0.3704 - val_loss: 3.3089 - val_accuracy50: 0.3369 - 11s/epoch - 35ms/step
Epoch 27/50
323/323 - 11s - loss: 3.2665 - accuracy50: 0.3718 - val_loss: 3.3095 - val_accuracy50: 0.3344 - 11s/epoch - 35ms/step
Epoch 28/50
323/323 - 11s - loss: 3.2697 - accuracy50: 0.3697 - val_loss: 3.3142 - val_accuracy50: 0.3331 - 11s/epoch - 34ms/step
Epoch 29/50
323/323 - 11s - loss: 3.2649 - accuracy50: 0.3737 - val_loss: 3.3077 - val_accuracy50: 0.3397 - 11s/epoch - 35ms/step
Epoch 30/50
323/323 - 11s - loss: 3.2616 - accuracy50: 0.3733 - val_loss: 3.3150 - val_accuracy50: 0.3380 - 11s/epoch - 35ms/step
testing model: results/CHTR/W9/deepVOL_L3/h50
Evaluating performance on  test set...
604/604 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0935609
{'0': {'precision': 0.3467693570278716, 'recall': 0.22541858174655285, 'f1-score': 0.2732258104629618, 'support': 48736}, '1': {'precision': 0.39963350074657256, 'recall': 0.4905198267244252, 'f1-score': 0.44043683147580226, 'support': 60020}, '2': {'precision': 0.31825686390411934, 'recall': 0.3419922901699667, 'f1-score': 0.32969794229124655, 'support': 45656}, 'accuracy': 0.36293163743750484, 'macro avg': {'precision': 0.35488657389285444, 'recall': 0.35264356621364823, 'f1-score': 0.34778686141000353, 'support': 154412}, 'weighted avg': {'precision': 0.3588871945012441, 'recall': 0.36293163743750484, 'f1-score': 0.3549182769289285, 'support': 154412}}
[[10986 22885 14865]
 [11997 29441 18582]
 [ 8698 21344 15614]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0918171
{'0': {'precision': 0.38989064681247093, 'recall': 0.2282882637422519, 'f1-score': 0.2879666623705804, 'support': 29362}, '1': {'precision': 0.35782404924569217, 'recall': 0.5636730945821855, 'f1-score': 0.4377567320858056, 'support': 27225}, '2': {'precision': 0.3603475793580422, 'recall': 0.31203931203931207, 'f1-score': 0.3344580692947082, 'support': 26048}, 'accuracy': 0.36518424396442184, 'macro avg': {'precision': 0.36935409180540174, 'recall': 0.36800022345458316, 'f1-score': 0.3533938212503647, 'support': 82635}, 'weighted avg': {'precision': 0.37001346474907754, 'recall': 0.36518424396442184, 'f1-score': 0.3519715370067114, 'support': 82635}}
[[ 6703 14866  7793]
 [ 5244 15346  6635]
 [ 5245 12675  8128]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1006494
{'0': {'precision': 0.40064620355411956, 'recall': 0.21273351124666412, 'f1-score': 0.27790574612463426, 'support': 10492}, '1': {'precision': 0.2927931010882212, 'recall': 0.5315606361829026, 'f1-score': 0.37759830530914873, 'support': 8048}, '2': {'precision': 0.35934092561182457, 'recall': 0.29971705739692805, 'f1-score': 0.326831955922865, 'support': 9896}, 'accuracy': 0.333239555493037, 'macro avg': {'precision': 0.35092674341805513, 'recall': 0.34800373494216497, 'f1-score': 0.32744533578554935, 'support': 28436}, 'weighted avg': {'precision': 0.35574682251731754, 'recall': 0.333239555493037, 'f1-score': 0.3231476749641428, 'support': 28436}}
[[2232 5199 3061]
 [1543 4278 2227]
 [1796 5134 2966]]
training model: results/CHTR/W9/deepVOL_L3/h100
Epoch 1/50
323/323 - 13s - loss: 3.3335 - accuracy100: 0.3568 - val_loss: 3.3506 - val_accuracy100: 0.3083 - 13s/epoch - 42ms/step
Epoch 2/50
323/323 - 11s - loss: 3.3100 - accuracy100: 0.3579 - val_loss: 3.3698 - val_accuracy100: 0.3000 - 11s/epoch - 35ms/step
Epoch 3/50
323/323 - 11s - loss: 3.3104 - accuracy100: 0.3531 - val_loss: 3.3740 - val_accuracy100: 0.2933 - 11s/epoch - 35ms/step
Epoch 4/50
323/323 - 11s - loss: 3.3054 - accuracy100: 0.3525 - val_loss: 3.3343 - val_accuracy100: 0.2953 - 11s/epoch - 35ms/step
Epoch 5/50
323/323 - 12s - loss: 3.3070 - accuracy100: 0.3404 - val_loss: 3.3192 - val_accuracy100: 0.2970 - 12s/epoch - 38ms/step
Epoch 6/50
323/323 - 11s - loss: 3.3012 - accuracy100: 0.3424 - val_loss: 3.3052 - val_accuracy100: 0.3169 - 11s/epoch - 35ms/step
Epoch 7/50
323/323 - 11s - loss: 3.2995 - accuracy100: 0.3431 - val_loss: 3.3105 - val_accuracy100: 0.3011 - 11s/epoch - 35ms/step
Epoch 8/50
323/323 - 11s - loss: 3.2976 - accuracy100: 0.3468 - val_loss: 3.3108 - val_accuracy100: 0.2988 - 11s/epoch - 35ms/step
Epoch 9/50
323/323 - 11s - loss: 3.2967 - accuracy100: 0.3459 - val_loss: 3.2993 - val_accuracy100: 0.3327 - 11s/epoch - 35ms/step
Epoch 10/50
323/323 - 12s - loss: 3.2961 - accuracy100: 0.3441 - val_loss: 3.3004 - val_accuracy100: 0.3280 - 12s/epoch - 38ms/step
Epoch 11/50
323/323 - 12s - loss: 3.2955 - accuracy100: 0.3473 - val_loss: 3.2997 - val_accuracy100: 0.3358 - 12s/epoch - 36ms/step
Epoch 12/50
323/323 - 12s - loss: 3.2948 - accuracy100: 0.3451 - val_loss: 3.3026 - val_accuracy100: 0.3226 - 12s/epoch - 36ms/step
Epoch 13/50
323/323 - 11s - loss: 3.2940 - accuracy100: 0.3460 - val_loss: 3.3052 - val_accuracy100: 0.3176 - 11s/epoch - 36ms/step
Epoch 14/50
323/323 - 11s - loss: 3.2924 - accuracy100: 0.3468 - val_loss: 3.3123 - val_accuracy100: 0.3098 - 11s/epoch - 35ms/step
Epoch 15/50
323/323 - 12s - loss: 3.2912 - accuracy100: 0.3493 - val_loss: 3.3032 - val_accuracy100: 0.3235 - 12s/epoch - 37ms/step
Epoch 16/50
323/323 - 12s - loss: 3.2901 - accuracy100: 0.3480 - val_loss: 3.3049 - val_accuracy100: 0.3197 - 12s/epoch - 38ms/step
Epoch 17/50
323/323 - 11s - loss: 3.2892 - accuracy100: 0.3508 - val_loss: 3.3056 - val_accuracy100: 0.3185 - 11s/epoch - 35ms/step
Epoch 18/50
323/323 - 12s - loss: 3.2875 - accuracy100: 0.3543 - val_loss: 3.3038 - val_accuracy100: 0.3277 - 12s/epoch - 37ms/step
Epoch 19/50
323/323 - 11s - loss: 3.2857 - accuracy100: 0.3543 - val_loss: 3.3096 - val_accuracy100: 0.3110 - 11s/epoch - 35ms/step
testing model: results/CHTR/W9/deepVOL_L3/h100
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0994827
{'0': {'precision': 0.3174364123159304, 'recall': 0.1576923876223529, 'f1-score': 0.21071046748955194, 'support': 48119}, '1': {'precision': 0.3930676815163048, 'recall': 0.34921687246208666, 'f1-score': 0.3698470234072618, 'support': 60335}, '2': {'precision': 0.29740975761988975, 'recall': 0.49767178728404193, 'f1-score': 0.3723201640865361, 'support': 45958}, 'accuracy': 0.33371758671605833, 'macro avg': {'precision': 0.33597128381737495, 'recall': 0.3348603491228272, 'f1-score': 0.31762588499444994, 'support': 154412}, 'weighted avg': {'precision': 0.34102802197504983, 'recall': 0.33371758671605833, 'f1-score': 0.32099180920845477, 'support': 154412}}
[[ 7588 16529 24002]
 [ 9235 21070 30030]
 [ 7081 16005 22872]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0989803
{'0': {'precision': 0.36659021406727826, 'recall': 0.16380841760043727, 'f1-score': 0.22643558745749903, 'support': 29272}, '1': {'precision': 0.33815867572380137, 'recall': 0.37680041152263377, 'f1-score': 0.35643529943345736, 'support': 27216}, '2': {'precision': 0.32297534986871956, 'recall': 0.4845680192756339, 'f1-score': 0.3876040137053353, 'support': 26147}, 'accuracy': 0.3354510800508259, 'macro avg': {'precision': 0.3425747465532664, 'recall': 0.34172561613290164, 'f1-score': 0.32349163353209726, 'support': 82635}, 'weighted avg': {'precision': 0.3434258091328584, 'recall': 0.3354510800508259, 'f1-score': 0.3202474468662224, 'support': 82635}}
[[ 4795 10610 13867]
 [ 4269 10255 12692]
 [ 4016  9461 12670]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0992657
{'0': {'precision': 0.3754250736794378, 'recall': 0.16187683284457477, 'f1-score': 0.2262140564169114, 'support': 10230}, '1': {'precision': 0.2948081694979958, 'recall': 0.37234811957569913, 'f1-score': 0.32907212101842975, 'support': 8296}, '2': {'precision': 0.3470879161437957, 'recall': 0.4744702320887992, 'f1-score': 0.4009037813872192, 'support': 9910}, 'accuracy': 0.3322197214798143, 'macro avg': {'precision': 0.3391070531070764, 'recall': 0.336231728169691, 'f1-score': 0.3187299862741868, 'support': 28436}, 'weighted avg': {'precision': 0.34203011418205925, 'recall': 0.3322197214798143, 'f1-score': 0.3171018633654958, 'support': 28436}}
[[1656 3661 4913]
 [1275 3089 3932]
 [1480 3728 4702]]
training model: results/CHTR/W9/deepVOL_L3/h200
Epoch 1/50
323/323 - 14s - loss: 3.3381 - accuracy200: 0.3577 - val_loss: 3.3844 - val_accuracy200: 0.3006 - 14s/epoch - 44ms/step
Epoch 2/50
323/323 - 11s - loss: 3.3216 - accuracy200: 0.3571 - val_loss: 3.3534 - val_accuracy200: 0.3046 - 11s/epoch - 35ms/step
Epoch 3/50
323/323 - 11s - loss: 3.3134 - accuracy200: 0.3526 - val_loss: 3.3479 - val_accuracy200: 0.3007 - 11s/epoch - 35ms/step
Epoch 4/50
323/323 - 11s - loss: 3.3104 - accuracy200: 0.3415 - val_loss: 3.3029 - val_accuracy200: 0.3281 - 11s/epoch - 35ms/step
Epoch 5/50
323/323 - 11s - loss: 3.3013 - accuracy200: 0.3435 - val_loss: 3.2966 - val_accuracy200: 0.3419 - 11s/epoch - 35ms/step
Epoch 6/50
323/323 - 11s - loss: 3.2984 - accuracy200: 0.3449 - val_loss: 3.2956 - val_accuracy200: 0.3438 - 11s/epoch - 35ms/step
Epoch 7/50
323/323 - 11s - loss: 3.2972 - accuracy200: 0.3456 - val_loss: 3.2945 - val_accuracy200: 0.3491 - 11s/epoch - 35ms/step
Epoch 8/50
323/323 - 11s - loss: 3.2960 - accuracy200: 0.3469 - val_loss: 3.2933 - val_accuracy200: 0.3516 - 11s/epoch - 35ms/step
Epoch 9/50
323/323 - 11s - loss: 3.2945 - accuracy200: 0.3466 - val_loss: 3.2939 - val_accuracy200: 0.3512 - 11s/epoch - 35ms/step
Epoch 10/50
323/323 - 11s - loss: 3.2943 - accuracy200: 0.3471 - val_loss: 3.2948 - val_accuracy200: 0.3453 - 11s/epoch - 35ms/step
Epoch 11/50
323/323 - 11s - loss: 3.2935 - accuracy200: 0.3494 - val_loss: 3.2943 - val_accuracy200: 0.3466 - 11s/epoch - 35ms/step
Epoch 12/50
323/323 - 11s - loss: 3.2928 - accuracy200: 0.3483 - val_loss: 3.2929 - val_accuracy200: 0.3529 - 11s/epoch - 35ms/step
Epoch 13/50
323/323 - 11s - loss: 3.2927 - accuracy200: 0.3485 - val_loss: 3.2925 - val_accuracy200: 0.3518 - 11s/epoch - 35ms/step
Epoch 14/50
323/323 - 11s - loss: 3.2916 - accuracy200: 0.3514 - val_loss: 3.2923 - val_accuracy200: 0.3540 - 11s/epoch - 35ms/step
Epoch 15/50
323/323 - 11s - loss: 3.2895 - accuracy200: 0.3538 - val_loss: 3.2928 - val_accuracy200: 0.3561 - 11s/epoch - 35ms/step
Epoch 16/50
323/323 - 11s - loss: 3.2883 - accuracy200: 0.3565 - val_loss: 3.2938 - val_accuracy200: 0.3495 - 11s/epoch - 34ms/step
Epoch 17/50
323/323 - 11s - loss: 3.2865 - accuracy200: 0.3585 - val_loss: 3.2934 - val_accuracy200: 0.3498 - 11s/epoch - 34ms/step
Epoch 18/50
323/323 - 11s - loss: 3.2847 - accuracy200: 0.3621 - val_loss: 3.3150 - val_accuracy200: 0.3189 - 11s/epoch - 35ms/step
Epoch 19/50
323/323 - 11s - loss: 3.2855 - accuracy200: 0.3556 - val_loss: 3.2961 - val_accuracy200: 0.3521 - 11s/epoch - 35ms/step
Epoch 20/50
323/323 - 11s - loss: 3.2824 - accuracy200: 0.3612 - val_loss: 3.3016 - val_accuracy200: 0.3485 - 11s/epoch - 35ms/step
Epoch 21/50
323/323 - 11s - loss: 3.2853 - accuracy200: 0.3568 - val_loss: 3.3005 - val_accuracy200: 0.3482 - 11s/epoch - 34ms/step
Epoch 22/50
323/323 - 11s - loss: 3.2823 - accuracy200: 0.3587 - val_loss: 3.3008 - val_accuracy200: 0.3445 - 11s/epoch - 35ms/step
Epoch 23/50
323/323 - 11s - loss: 3.2790 - accuracy200: 0.3636 - val_loss: 3.2991 - val_accuracy200: 0.3503 - 11s/epoch - 35ms/step
Epoch 24/50
323/323 - 11s - loss: 3.2756 - accuracy200: 0.3680 - val_loss: 3.3042 - val_accuracy200: 0.3477 - 11s/epoch - 35ms/step
testing model: results/CHTR/W9/deepVOL_L3/h200
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0996295
{'0': {'precision': 0.3131755563405157, 'recall': 0.18777533039647576, 'f1-score': 0.2347800757355083, 'support': 47216}, '1': {'precision': 0.40907034607554854, 'recall': 0.23954832193652004, 'f1-score': 0.3021563201587219, 'support': 60397}, '2': {'precision': 0.3021579562236868, 'recall': 0.5858244834291331, 'f1-score': 0.3986824980186573, 'support': 46799}, 'accuracy': 0.328666165842033, 'macro avg': {'precision': 0.341467952879917, 'recall': 0.3377160452540429, 'f1-score': 0.31187296463762915, 'support': 154412}, 'weighted avg': {'precision': 0.3473448239347396, 'recall': 0.328666165842033, 'f1-score': 0.3108090922294202, 'support': 154412}}
[[ 8866  9952 28398]
 [11009 14468 34920]
 [ 8435 10948 27416]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0974587
{'0': {'precision': 0.37502505512126677, 'recall': 0.19285346160453531, 'f1-score': 0.25471954982755496, 'support': 29105}, '1': {'precision': 0.3652516676773802, 'recall': 0.2223904294206698, 'f1-score': 0.27645560324053886, 'support': 27083}, '2': {'precision': 0.33000508030794484, 'recall': 0.6385979506182176, 'f1-score': 0.4351433172302738, 'support': 26447}, 'accuracy': 0.34519271495129183, 'macro avg': {'precision': 0.35676060103553064, 'recall': 0.3512806138811409, 'f1-score': 0.32210615676612253, 'support': 82635}, 'weighted avg': {'precision': 0.35741343866297787, 'recall': 0.34519271495129183, 'f1-score': 0.31958728034227085, 'support': 82635}}
[[ 5613  5490 18002]
 [ 4773  6023 16287]
 [ 4581  4977 16889]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0977159
{'0': {'precision': 0.36126884668102605, 'recall': 0.18296310987703293, 'f1-score': 0.2429069843986571, 'support': 10084}, '1': {'precision': 0.31296368606013275, 'recall': 0.18943512172063343, 'f1-score': 0.23601295641931685, 'support': 8462}, '2': {'precision': 0.35947712418300654, 'recall': 0.6617795753286148, 'f1-score': 0.4658860376552657, 'support': 9890}, 'accuracy': 0.35142073428048953, 'macro avg': {'precision': 0.3445698856413884, 'recall': 0.3447259356420937, 'f1-score': 0.31493532615774655, 'support': 28436}, 'weighted avg': {'precision': 0.3462710127845775, 'recall': 0.35142073428048953, 'f1-score': 0.3184072506789596, 'support': 28436}}
[[1845 1911 6328]
 [1525 1603 5334]
 [1737 1608 6545]]
training model: results/CHTR/W9/deepVOL_L3/h300
Epoch 1/50
323/323 - 14s - loss: 3.3431 - accuracy300: 0.3542 - val_loss: 3.4028 - val_accuracy300: 0.3072 - 14s/epoch - 42ms/step
Epoch 2/50
323/323 - 12s - loss: 3.3199 - accuracy300: 0.3486 - val_loss: 3.3119 - val_accuracy300: 0.3255 - 12s/epoch - 36ms/step
Epoch 3/50
323/323 - 12s - loss: 3.3020 - accuracy300: 0.3469 - val_loss: 3.2949 - val_accuracy300: 0.3483 - 12s/epoch - 36ms/step
Epoch 4/50
323/323 - 12s - loss: 3.2984 - accuracy300: 0.3503 - val_loss: 3.2926 - val_accuracy300: 0.3488 - 12s/epoch - 37ms/step
Epoch 5/50
323/323 - 12s - loss: 3.2965 - accuracy300: 0.3537 - val_loss: 3.2932 - val_accuracy300: 0.3473 - 12s/epoch - 36ms/step
Epoch 6/50
323/323 - 12s - loss: 3.2962 - accuracy300: 0.3514 - val_loss: 3.2928 - val_accuracy300: 0.3488 - 12s/epoch - 36ms/step
Epoch 7/50
323/323 - 12s - loss: 3.2943 - accuracy300: 0.3543 - val_loss: 3.2918 - val_accuracy300: 0.3518 - 12s/epoch - 36ms/step
Epoch 8/50
323/323 - 12s - loss: 3.2937 - accuracy300: 0.3552 - val_loss: 3.2915 - val_accuracy300: 0.3514 - 12s/epoch - 36ms/step
Epoch 9/50
323/323 - 12s - loss: 3.2939 - accuracy300: 0.3545 - val_loss: 3.2905 - val_accuracy300: 0.3527 - 12s/epoch - 36ms/step
Epoch 10/50
323/323 - 12s - loss: 3.2937 - accuracy300: 0.3557 - val_loss: 3.2909 - val_accuracy300: 0.3489 - 12s/epoch - 36ms/step
Epoch 11/50
323/323 - 11s - loss: 3.2934 - accuracy300: 0.3558 - val_loss: 3.2920 - val_accuracy300: 0.3489 - 11s/epoch - 36ms/step
Epoch 12/50
323/323 - 12s - loss: 3.2929 - accuracy300: 0.3538 - val_loss: 3.2918 - val_accuracy300: 0.3471 - 12s/epoch - 36ms/step
Epoch 13/50
323/323 - 12s - loss: 3.2945 - accuracy300: 0.3584 - val_loss: 3.2986 - val_accuracy300: 0.3360 - 12s/epoch - 36ms/step
Epoch 14/50
323/323 - 11s - loss: 3.2959 - accuracy300: 0.3544 - val_loss: 3.2993 - val_accuracy300: 0.3345 - 11s/epoch - 35ms/step
Epoch 15/50
323/323 - 12s - loss: 3.2931 - accuracy300: 0.3570 - val_loss: 3.2941 - val_accuracy300: 0.3448 - 12s/epoch - 36ms/step
Epoch 16/50
323/323 - 12s - loss: 3.2913 - accuracy300: 0.3574 - val_loss: 3.2954 - val_accuracy300: 0.3398 - 12s/epoch - 36ms/step
Epoch 17/50
323/323 - 12s - loss: 3.2896 - accuracy300: 0.3583 - val_loss: 3.2917 - val_accuracy300: 0.3541 - 12s/epoch - 36ms/step
Epoch 18/50
323/323 - 12s - loss: 3.2894 - accuracy300: 0.3584 - val_loss: 3.2937 - val_accuracy300: 0.3528 - 12s/epoch - 36ms/step
Epoch 19/50
323/323 - 12s - loss: 3.2879 - accuracy300: 0.3588 - val_loss: 3.2918 - val_accuracy300: 0.3519 - 12s/epoch - 36ms/step
testing model: results/CHTR/W9/deepVOL_L3/h300
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989366
{'0': {'precision': 0.32592112289266917, 'recall': 0.1838464682975107, 'f1-score': 0.2350853542787185, 'support': 46479}, '1': {'precision': 0.4034251758836225, 'recall': 0.2443508819584741, 'f1-score': 0.3043561006555297, 'support': 58903}, '2': {'precision': 0.3166661262254505, 'recall': 0.5975321231898837, 'f1-score': 0.4139543755784298, 'support': 49030}, 'accuracy': 0.3382832940445043, 'macro avg': {'precision': 0.34867080833391406, 'recall': 0.3419098244819561, 'f1-score': 0.31779861017089267, 'support': 154412}, 'weighted avg': {'precision': 0.35254760753591186, 'recall': 0.3382832940445043, 'f1-score': 0.31830558902833744, 'support': 154412}}
[[ 8545  9643 28291]
 [ 9581 14393 34929]
 [ 8092 11641 29297]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0978892
{'0': {'precision': 0.37092095721537344, 'recall': 0.17770906437827885, 'f1-score': 0.24029314354168135, 'support': 28783}, '1': {'precision': 0.35441975032189443, 'recall': 0.23263761299331226, 'f1-score': 0.2808971315748608, 'support': 27214}, '2': {'precision': 0.3309599466478365, 'recall': 0.6334184248066672, 'f1-score': 0.43475908271064156, 'support': 26638}, 'accuracy': 0.3426998245295577, 'macro avg': {'precision': 0.35210021806170144, 'recall': 0.34792170072608614, 'f1-score': 0.31864978594239457, 'support': 82635}, 'weighted avg': {'precision': 0.35260492594657467, 'recall': 0.3426998245295577, 'f1-score': 0.3163526899556428, 'support': 82635}}
[[ 5115  6008 17660]
 [ 4434  6331 16449]
 [ 4241  5524 16873]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0973424
{'0': {'precision': 0.3650759219088937, 'recall': 0.16979418886198547, 'f1-score': 0.23178625533673047, 'support': 9912}, '1': {'precision': 0.3190016396429222, 'recall': 0.20149597238204833, 'f1-score': 0.24698497778404682, 'support': 8690}, '2': {'precision': 0.35469269782407153, 'recall': 0.661378889566809, 'f1-score': 0.46175144652302014, 'support': 9834}, 'accuracy': 0.3494865663243775, 'macro avg': {'precision': 0.3462567531252958, 'recall': 0.3442230169369476, 'f1-score': 0.31350755988126583, 'support': 28436}, 'weighted avg': {'precision': 0.3474048662561495, 'recall': 0.3494865663243775, 'f1-score': 0.3159596478037846, 'support': 28436}}
[[1683 1956 6273]
 [1379 1751 5560]
 [1548 1782 6504]]
training model: results/CHTR/W9/deepVOL_L3/h500
Epoch 1/50
323/323 - 14s - loss: 3.3446 - accuracy500: 0.3511 - val_loss: 3.3451 - val_accuracy500: 0.3262 - 14s/epoch - 42ms/step
Epoch 2/50
323/323 - 11s - loss: 3.3132 - accuracy500: 0.3418 - val_loss: 3.3029 - val_accuracy500: 0.3314 - 11s/epoch - 35ms/step
Epoch 3/50
323/323 - 11s - loss: 3.3050 - accuracy500: 0.3400 - val_loss: 3.3015 - val_accuracy500: 0.3361 - 11s/epoch - 35ms/step
Epoch 4/50
323/323 - 11s - loss: 3.3032 - accuracy500: 0.3423 - val_loss: 3.2981 - val_accuracy500: 0.3400 - 11s/epoch - 35ms/step
Epoch 5/50
323/323 - 11s - loss: 3.3015 - accuracy500: 0.3419 - val_loss: 3.2966 - val_accuracy500: 0.3426 - 11s/epoch - 35ms/step
Epoch 6/50
323/323 - 11s - loss: 3.3013 - accuracy500: 0.3412 - val_loss: 3.2984 - val_accuracy500: 0.3384 - 11s/epoch - 34ms/step
Epoch 7/50
323/323 - 11s - loss: 3.3011 - accuracy500: 0.3417 - val_loss: 3.2960 - val_accuracy500: 0.3463 - 11s/epoch - 35ms/step
Epoch 8/50
323/323 - 11s - loss: 3.3007 - accuracy500: 0.3426 - val_loss: 3.2965 - val_accuracy500: 0.3369 - 11s/epoch - 35ms/step
Epoch 9/50
323/323 - 11s - loss: 3.2998 - accuracy500: 0.3437 - val_loss: 3.2966 - val_accuracy500: 0.3438 - 11s/epoch - 35ms/step
Epoch 10/50
323/323 - 11s - loss: 3.2997 - accuracy500: 0.3439 - val_loss: 3.2959 - val_accuracy500: 0.3433 - 11s/epoch - 35ms/step
Epoch 11/50
323/323 - 11s - loss: 3.2989 - accuracy500: 0.3465 - val_loss: 3.2949 - val_accuracy500: 0.3490 - 11s/epoch - 35ms/step
Epoch 12/50
323/323 - 11s - loss: 3.2983 - accuracy500: 0.3468 - val_loss: 3.2958 - val_accuracy500: 0.3450 - 11s/epoch - 35ms/step
Epoch 13/50
323/323 - 11s - loss: 3.2972 - accuracy500: 0.3492 - val_loss: 3.2966 - val_accuracy500: 0.3445 - 11s/epoch - 35ms/step
Epoch 14/50
323/323 - 11s - loss: 3.2965 - accuracy500: 0.3491 - val_loss: 3.2951 - val_accuracy500: 0.3439 - 11s/epoch - 35ms/step
Epoch 15/50
323/323 - 11s - loss: 3.2947 - accuracy500: 0.3513 - val_loss: 3.2966 - val_accuracy500: 0.3442 - 11s/epoch - 35ms/step
Epoch 16/50
323/323 - 11s - loss: 3.2945 - accuracy500: 0.3513 - val_loss: 3.2979 - val_accuracy500: 0.3409 - 11s/epoch - 35ms/step
Epoch 17/50
323/323 - 11s - loss: 3.2937 - accuracy500: 0.3530 - val_loss: 3.2968 - val_accuracy500: 0.3448 - 11s/epoch - 35ms/step
Epoch 18/50
323/323 - 11s - loss: 3.2934 - accuracy500: 0.3531 - val_loss: 3.2967 - val_accuracy500: 0.3472 - 11s/epoch - 35ms/step
Epoch 19/50
323/323 - 11s - loss: 3.2918 - accuracy500: 0.3531 - val_loss: 3.2971 - val_accuracy500: 0.3491 - 11s/epoch - 35ms/step
Epoch 20/50
323/323 - 11s - loss: 3.2901 - accuracy500: 0.3557 - val_loss: 3.2989 - val_accuracy500: 0.3452 - 11s/epoch - 35ms/step
Epoch 21/50
323/323 - 11s - loss: 3.2879 - accuracy500: 0.3581 - val_loss: 3.2979 - val_accuracy500: 0.3487 - 11s/epoch - 35ms/step
testing model: results/CHTR/W9/deepVOL_L3/h500
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0966542
{'0': {'precision': 0.2707714083510262, 'recall': 0.041702999651203346, 'f1-score': 0.07227459055103236, 'support': 45872}, '1': {'precision': 0.39607419822174245, 'recall': 0.4777372325298522, 'f1-score': 0.4330897598173587, 'support': 58371}, '2': {'precision': 0.318061891579262, 'recall': 0.4877912655225338, 'f1-score': 0.38505231689088193, 'support': 50169}, 'accuracy': 0.351468797761832, 'macro avg': {'precision': 0.3283024993840102, 'recall': 0.33574383256786317, 'f1-score': 0.29680555575309103, 'support': 154412}, 'weighted avg': {'precision': 0.33350335535398545, 'recall': 0.351468797761832, 'f1-score': 0.3102929310814876, 'support': 154412}}
[[ 1913 19313 24646]
 [ 2662 27886 27823]
 [ 2490 23207 24472]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098983
{'0': {'precision': 0.39387387387387385, 'recall': 0.03855107223476298, 'f1-score': 0.07022841905740997, 'support': 28352}, '1': {'precision': 0.34413443993172055, 'recall': 0.42897497982243743, 'f1-score': 0.3818995362205239, 'support': 27258}, '2': {'precision': 0.3376487511442396, 'recall': 0.5732469935245144, 'f1-score': 0.42497976874648524, 'support': 27025}, 'accuracy': 0.3422036667271737, 'macro avg': {'precision': 0.35855235498327803, 'recall': 0.34692434852723825, 'f1-score': 0.2923692413414731, 'support': 82635}, 'weighted avg': {'precision': 0.35907891493197774, 'recall': 0.3422036667271737, 'f1-score': 0.289054419383899, 'support': 82635}}
[[ 1093 11511 15748]
 [  923 11693 14642]
 [  759 10774 15492]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0992568
{'0': {'precision': 0.3432343234323432, 'recall': 0.03228476821192053, 'f1-score': 0.059018254043317876, 'support': 9664}, '1': {'precision': 0.33678329364352444, 'recall': 0.40076294277929153, 'f1-score': 0.3659981087941074, 'support': 9175}, '2': {'precision': 0.354085134565597, 'recall': 0.6127956653120767, 'f1-score': 0.4488285125543769, 'support': 9597}, 'accuracy': 0.3470952313968209, 'macro avg': {'precision': 0.3447009172138215, 'recall': 0.3486144587677629, 'f1-score': 0.29128162513060074, 'support': 28436}, 'weighted avg': {'precision': 0.34481496192346095, 'recall': 0.3470952313968209, 'f1-score': 0.28962555529064965, 'support': 28436}}
[[ 312 3781 5571]
 [ 341 3677 5157]
 [ 256 3460 5881]]
training model: results/CHTR/W9/deepVOL_L3/h1000
Epoch 1/50
323/323 - 14s - loss: 3.3435 - accuracy1000: 0.3615 - val_loss: 3.4457 - val_accuracy1000: 0.3274 - 14s/epoch - 43ms/step
Epoch 2/50
323/323 - 12s - loss: 3.3195 - accuracy1000: 0.3572 - val_loss: 3.3120 - val_accuracy1000: 0.3333 - 12s/epoch - 37ms/step
Epoch 3/50
323/323 - 12s - loss: 3.3079 - accuracy1000: 0.3421 - val_loss: 3.2978 - val_accuracy1000: 0.3371 - 12s/epoch - 36ms/step
Epoch 4/50
323/323 - 12s - loss: 3.3028 - accuracy1000: 0.3375 - val_loss: 3.2962 - val_accuracy1000: 0.3364 - 12s/epoch - 36ms/step
Epoch 5/50
323/323 - 13s - loss: 3.3009 - accuracy1000: 0.3344 - val_loss: 3.2949 - val_accuracy1000: 0.3416 - 13s/epoch - 40ms/step
Epoch 6/50
323/323 - 12s - loss: 3.2998 - accuracy1000: 0.3365 - val_loss: 3.2955 - val_accuracy1000: 0.3395 - 12s/epoch - 36ms/step
Epoch 7/50
323/323 - 12s - loss: 3.2994 - accuracy1000: 0.3384 - val_loss: 3.2953 - val_accuracy1000: 0.3396 - 12s/epoch - 39ms/step
Epoch 8/50
323/323 - 12s - loss: 3.2982 - accuracy1000: 0.3410 - val_loss: 3.2965 - val_accuracy1000: 0.3396 - 12s/epoch - 36ms/step
Epoch 9/50
323/323 - 12s - loss: 3.2987 - accuracy1000: 0.3385 - val_loss: 3.2951 - val_accuracy1000: 0.3413 - 12s/epoch - 39ms/step
Epoch 10/50
323/323 - 11s - loss: 3.2978 - accuracy1000: 0.3375 - val_loss: 3.2946 - val_accuracy1000: 0.3401 - 11s/epoch - 36ms/step
Epoch 11/50
323/323 - 12s - loss: 3.2962 - accuracy1000: 0.3413 - val_loss: 3.2967 - val_accuracy1000: 0.3379 - 12s/epoch - 38ms/step
Epoch 12/50
323/323 - 11s - loss: 3.2965 - accuracy1000: 0.3407 - val_loss: 3.2960 - val_accuracy1000: 0.3421 - 11s/epoch - 35ms/step
Epoch 13/50
323/323 - 12s - loss: 3.2957 - accuracy1000: 0.3412 - val_loss: 3.2951 - val_accuracy1000: 0.3426 - 12s/epoch - 38ms/step
Epoch 14/50
323/323 - 11s - loss: 3.2945 - accuracy1000: 0.3406 - val_loss: 3.2965 - val_accuracy1000: 0.3427 - 11s/epoch - 36ms/step
Epoch 15/50
323/323 - 12s - loss: 3.2925 - accuracy1000: 0.3439 - val_loss: 3.2975 - val_accuracy1000: 0.3374 - 12s/epoch - 38ms/step
Epoch 16/50
323/323 - 11s - loss: 3.2925 - accuracy1000: 0.3450 - val_loss: 3.2970 - val_accuracy1000: 0.3427 - 11s/epoch - 35ms/step
Epoch 17/50
323/323 - 12s - loss: 3.2910 - accuracy1000: 0.3467 - val_loss: 3.2969 - val_accuracy1000: 0.3430 - 12s/epoch - 38ms/step
Epoch 18/50
323/323 - 12s - loss: 3.2906 - accuracy1000: 0.3492 - val_loss: 3.2958 - val_accuracy1000: 0.3449 - 12s/epoch - 36ms/step
Epoch 19/50
323/323 - 12s - loss: 3.2891 - accuracy1000: 0.3503 - val_loss: 3.2984 - val_accuracy1000: 0.3397 - 12s/epoch - 38ms/step
Epoch 20/50
323/323 - 12s - loss: 3.2898 - accuracy1000: 0.3510 - val_loss: 3.2953 - val_accuracy1000: 0.3416 - 12s/epoch - 36ms/step
testing model: results/CHTR/W9/deepVOL_L3/h1000
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990003
{'0': {'precision': 0.29564315352697096, 'recall': 0.006185835521889176, 'f1-score': 0.01211811977804707, 'support': 46073}, '1': {'precision': 0.4075579361020644, 'recall': 0.25586779093935347, 'f1-score': 0.31437113316447285, 'support': 59179}, '2': {'precision': 0.3127305559138398, 'recall': 0.7398087876322214, 'f1-score': 0.43962406696684897, 'support': 49160}, 'accuracy': 0.3354402507577131, 'macro avg': {'precision': 0.3386438818476251, 'recall': 0.33395413803115465, 'f1-score': 0.2553711066364563, 'support': 154412}, 'weighted avg': {'precision': 0.3439750294132358, 'recall': 0.3354402507577131, 'f1-score': 0.2640624210175673, 'support': 154412}}
[[  285  9534 36254]
 [  365 15142 43672]
 [  314 12477 36369]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0976101
{'0': {'precision': 0.32938856015779094, 'recall': 0.00595132033783543, 'f1-score': 0.011691402968356204, 'support': 28061}, '1': {'precision': 0.37107453076596003, 'recall': 0.2238302861539589, 'f1-score': 0.27923027699058417, 'support': 27293}, '2': {'precision': 0.3396786720475139, 'recall': 0.8176019940618012, 'f1-score': 0.47995610354399326, 'support': 27281}, 'accuracy': 0.3458703939008895, 'macro avg': {'precision': 0.3467139209904217, 'recall': 0.3491278668511985, 'f1-score': 0.25695926116764456, 'support': 82635}, 'weighted avg': {'precision': 0.3465539227556283, 'recall': 0.3458703939008895, 'f1-score': 0.25464738754017957, 'support': 82635}}
[[  167  5537 22357]
 [  181  6109 21003]
 [  159  4817 22305]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985838
{'0': {'precision': 0.29441624365482233, 'recall': 0.006027226436662163, 'f1-score': 0.011812627291242363, 'support': 9623}, '1': {'precision': 0.35934252786699417, 'recall': 0.20008415737428992, 'f1-score': 0.25704439489154673, 'support': 9506}, '2': {'precision': 0.3339579883204044, 'recall': 0.8233587622219835, 'f1-score': 0.47518060335472667, 'support': 9307}, 'accuracy': 0.3384090589393726, 'macro avg': {'precision': 0.329238919947407, 'recall': 0.34315671534431186, 'f1-score': 0.24801254184583862, 'support': 28436}, 'weighted avg': {'precision': 0.32906261710128026, 'recall': 0.3384090589393726, 'f1-score': 0.24545093563388343, 'support': 28436}}
[[  58 1821 7744]
 [  65 1902 7539]
 [  74 1570 7663]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        14 (peak)  11.02 (ave)

============================================
