This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-09-04.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-08-27.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-08-14.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-08-15.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-08-23.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-08-19.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-08-21.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-08-16.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-09-06.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-08-20.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-08-22.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-08-13.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-08-29.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-08-28.csv
training model: results/QRTEA/W6/deepLOB_L1/h10
Epoch 1/50
533/533 - 20s - loss: 3.0095 - accuracy10: 0.3937 - val_loss: 2.9908 - val_accuracy10: 0.2677 - 20s/epoch - 38ms/step
Epoch 2/50
533/533 - 11s - loss: 2.8634 - accuracy10: 0.4279 - val_loss: 2.9488 - val_accuracy10: 0.2886 - 11s/epoch - 21ms/step
Epoch 3/50
533/533 - 11s - loss: 2.8442 - accuracy10: 0.4492 - val_loss: 2.9002 - val_accuracy10: 0.3589 - 11s/epoch - 21ms/step
Epoch 4/50
533/533 - 11s - loss: 2.7470 - accuracy10: 0.5032 - val_loss: 2.8746 - val_accuracy10: 0.4195 - 11s/epoch - 20ms/step
Epoch 5/50
533/533 - 11s - loss: 2.6628 - accuracy10: 0.5257 - val_loss: 2.8749 - val_accuracy10: 0.3429 - 11s/epoch - 21ms/step
Epoch 6/50
533/533 - 10s - loss: 2.6130 - accuracy10: 0.5505 - val_loss: 2.8852 - val_accuracy10: 0.4138 - 10s/epoch - 20ms/step
Epoch 7/50
533/533 - 11s - loss: 2.5728 - accuracy10: 0.5663 - val_loss: 3.0147 - val_accuracy10: 0.4027 - 11s/epoch - 20ms/step
Epoch 8/50
533/533 - 11s - loss: 2.5277 - accuracy10: 0.5905 - val_loss: 2.9542 - val_accuracy10: 0.4037 - 11s/epoch - 20ms/step
Epoch 9/50
533/533 - 11s - loss: 2.4955 - accuracy10: 0.5997 - val_loss: 2.8714 - val_accuracy10: 0.4074 - 11s/epoch - 20ms/step
Epoch 10/50
533/533 - 11s - loss: 2.4706 - accuracy10: 0.6084 - val_loss: 2.9899 - val_accuracy10: 0.3555 - 11s/epoch - 20ms/step
Epoch 11/50
533/533 - 11s - loss: 2.4448 - accuracy10: 0.6191 - val_loss: 2.8995 - val_accuracy10: 0.3847 - 11s/epoch - 21ms/step
Epoch 12/50
533/533 - 11s - loss: 2.4210 - accuracy10: 0.6248 - val_loss: 2.8473 - val_accuracy10: 0.4118 - 11s/epoch - 21ms/step
Epoch 13/50
533/533 - 11s - loss: 2.3976 - accuracy10: 0.6276 - val_loss: 2.8458 - val_accuracy10: 0.4139 - 11s/epoch - 21ms/step
Epoch 14/50
533/533 - 11s - loss: 2.3767 - accuracy10: 0.6393 - val_loss: 2.8907 - val_accuracy10: 0.4347 - 11s/epoch - 20ms/step
Epoch 15/50
533/533 - 11s - loss: 2.3557 - accuracy10: 0.6432 - val_loss: 2.8504 - val_accuracy10: 0.4667 - 11s/epoch - 21ms/step
Epoch 16/50
533/533 - 11s - loss: 2.3447 - accuracy10: 0.6482 - val_loss: 2.8227 - val_accuracy10: 0.4302 - 11s/epoch - 20ms/step
Epoch 17/50
533/533 - 11s - loss: 2.3340 - accuracy10: 0.6492 - val_loss: 2.8642 - val_accuracy10: 0.4169 - 11s/epoch - 20ms/step
Epoch 18/50
533/533 - 11s - loss: 2.3246 - accuracy10: 0.6535 - val_loss: 2.8356 - val_accuracy10: 0.4798 - 11s/epoch - 21ms/step
Epoch 19/50
533/533 - 11s - loss: 2.3126 - accuracy10: 0.6561 - val_loss: 2.8639 - val_accuracy10: 0.4468 - 11s/epoch - 20ms/step
Epoch 20/50
533/533 - 10s - loss: 2.2946 - accuracy10: 0.6580 - val_loss: 2.8093 - val_accuracy10: 0.4865 - 10s/epoch - 20ms/step
Epoch 21/50
533/533 - 11s - loss: 2.2865 - accuracy10: 0.6608 - val_loss: 2.8509 - val_accuracy10: 0.4723 - 11s/epoch - 20ms/step
Epoch 22/50
533/533 - 11s - loss: 2.2740 - accuracy10: 0.6620 - val_loss: 2.8866 - val_accuracy10: 0.5078 - 11s/epoch - 20ms/step
Epoch 23/50
533/533 - 11s - loss: 2.2637 - accuracy10: 0.6647 - val_loss: 2.8986 - val_accuracy10: 0.4986 - 11s/epoch - 20ms/step
Epoch 24/50
533/533 - 11s - loss: 2.2555 - accuracy10: 0.6639 - val_loss: 2.8930 - val_accuracy10: 0.4959 - 11s/epoch - 20ms/step
Epoch 25/50
533/533 - 10s - loss: 2.2456 - accuracy10: 0.6669 - val_loss: 2.8715 - val_accuracy10: 0.5005 - 10s/epoch - 20ms/step
Epoch 26/50
533/533 - 11s - loss: 2.2318 - accuracy10: 0.6673 - val_loss: 2.9272 - val_accuracy10: 0.5039 - 11s/epoch - 20ms/step
Epoch 27/50
533/533 - 10s - loss: 2.2290 - accuracy10: 0.6688 - val_loss: 2.8538 - val_accuracy10: 0.5013 - 10s/epoch - 20ms/step
Epoch 28/50
533/533 - 11s - loss: 2.2203 - accuracy10: 0.6694 - val_loss: 2.9047 - val_accuracy10: 0.5095 - 11s/epoch - 21ms/step
Epoch 29/50
533/533 - 11s - loss: 2.2134 - accuracy10: 0.6703 - val_loss: 2.8821 - val_accuracy10: 0.5089 - 11s/epoch - 21ms/step
Epoch 30/50
533/533 - 11s - loss: 2.2078 - accuracy10: 0.6700 - val_loss: 2.9321 - val_accuracy10: 0.5334 - 11s/epoch - 20ms/step
testing model: results/QRTEA/W6/deepLOB_L1/h10
Evaluating performance on  test set...
2185/2185 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9730422
{'0': {'precision': 0.22549946207908947, 'recall': 0.6703280280953449, 'f1-score': 0.3374725857600187, 'support': 66915}, '1': {'precision': 0.8578032423985936, 'recall': 0.49668952192455407, 'f1-score': 0.6291091301402364, 'support': 424410}, '2': {'precision': 0.2824384152571234, 'recall': 0.4766985998526161, 'f1-score': 0.3547132979102579, 'support': 67850}, 'accuracy': 0.5150426968301516, 'macro avg': {'precision': 0.45524703991160215, 'recall': 0.5479053832908384, 'f1-score': 0.440431671270171, 'support': 559175}, 'weighted avg': {'precision': 0.7123226486996114, 'recall': 0.5150426968301516, 'f1-score': 0.5609147069560699, 'support': 559175}}
[[ 44855  15823   6237]
 [137674 210800  75936]
 [ 16385  19121  32344]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.046983
{'0': {'precision': 0.20727410315226902, 'recall': 0.6495960868598533, 'f1-score': 0.3142703477949086, 'support': 13493}, '1': {'precision': 0.9090596132881978, 'recall': 0.4350157873060907, 'f1-score': 0.5884421115182727, 'support': 109265}, '2': {'precision': 0.20913669064748203, 'recall': 0.6452352767090855, 'f1-score': 0.31588669950738923, 'support': 13516}, 'accuracy': 0.47711228847762593, 'macro avg': {'precision': 0.44182346902931635, 'recall': 0.5766157169583431, 'f1-score': 0.4061997196068569, 'support': 136274}, 'weighted avg': {'precision': 0.7701530712429361, 'recall': 0.47711228847762593, 'f1-score': 0.5342626014381514, 'support': 136274}}
[[ 8765  2382  2346]
 [31100 47532 30633]
 [ 2422  2373  8721]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0459843
{'0': {'precision': 0.20722011317240885, 'recall': 0.6099515074847143, 'f1-score': 0.3093455945252352, 'support': 4743}, '1': {'precision': 0.9159884484116566, 'recall': 0.4471701015072285, 'f1-score': 0.6009611244122155, 'support': 39012}, '2': {'precision': 0.201302974466965, 'recall': 0.6878794693051495, 'f1-score': 0.3114595530214326, 'support': 4447}, 'accuracy': 0.48539479689639436, 'macro avg': {'precision': 0.4415038453503435, 'recall': 0.5816670260990308, 'f1-score': 0.40725542398629444, 'support': 48202}, 'weighted avg': {'precision': 0.780311619303491, 'recall': 0.48539479689639436, 'f1-score': 0.5455579057443436, 'support': 48202}}
[[ 2893   847  1003]
 [10433 17445 11134]
 [  635   753  3059]]
training model: results/QRTEA/W6/deepLOB_L1/h20
Epoch 1/50
533/533 - 12s - loss: 3.0443 - accuracy20: 0.3979 - val_loss: 3.1342 - val_accuracy20: 0.2056 - 12s/epoch - 22ms/step
Epoch 2/50
533/533 - 10s - loss: 2.8831 - accuracy20: 0.4408 - val_loss: 3.0646 - val_accuracy20: 0.2553 - 10s/epoch - 19ms/step
Epoch 3/50
533/533 - 10s - loss: 2.8138 - accuracy20: 0.4817 - val_loss: 2.9304 - val_accuracy20: 0.3449 - 10s/epoch - 19ms/step
Epoch 4/50
533/533 - 10s - loss: 2.7600 - accuracy20: 0.5094 - val_loss: 2.9656 - val_accuracy20: 0.3337 - 10s/epoch - 18ms/step
Epoch 5/50
533/533 - 10s - loss: 2.7283 - accuracy20: 0.5163 - val_loss: 2.9066 - val_accuracy20: 0.3654 - 10s/epoch - 20ms/step
Epoch 6/50
533/533 - 11s - loss: 2.6869 - accuracy20: 0.5402 - val_loss: 2.9179 - val_accuracy20: 0.3569 - 11s/epoch - 20ms/step
Epoch 7/50
533/533 - 11s - loss: 2.6445 - accuracy20: 0.5609 - val_loss: 2.9385 - val_accuracy20: 0.3420 - 11s/epoch - 20ms/step
Epoch 8/50
533/533 - 10s - loss: 2.6064 - accuracy20: 0.5798 - val_loss: 2.9530 - val_accuracy20: 0.3571 - 10s/epoch - 19ms/step
Epoch 9/50
533/533 - 10s - loss: 2.5843 - accuracy20: 0.5844 - val_loss: 2.9251 - val_accuracy20: 0.3796 - 10s/epoch - 19ms/step
Epoch 10/50
533/533 - 10s - loss: 2.5612 - accuracy20: 0.5971 - val_loss: 2.9219 - val_accuracy20: 0.4041 - 10s/epoch - 19ms/step
Epoch 11/50
533/533 - 11s - loss: 2.5426 - accuracy20: 0.6017 - val_loss: 2.9083 - val_accuracy20: 0.3993 - 11s/epoch - 20ms/step
Epoch 12/50
533/533 - 11s - loss: 2.5270 - accuracy20: 0.6050 - val_loss: 3.0041 - val_accuracy20: 0.3873 - 11s/epoch - 20ms/step
Epoch 13/50
533/533 - 10s - loss: 2.5092 - accuracy20: 0.6126 - val_loss: 2.9847 - val_accuracy20: 0.3931 - 10s/epoch - 19ms/step
Epoch 14/50
533/533 - 11s - loss: 2.4906 - accuracy20: 0.6168 - val_loss: 2.9682 - val_accuracy20: 0.4044 - 11s/epoch - 20ms/step
Epoch 15/50
533/533 - 11s - loss: 2.4688 - accuracy20: 0.6239 - val_loss: 2.9737 - val_accuracy20: 0.4065 - 11s/epoch - 20ms/step
testing model: results/QRTEA/W6/deepLOB_L1/h20
Evaluating performance on  test set...
2185/2185 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1076777
{'0': {'precision': 0.215004533632394, 'recall': 0.8032649877423669, 'f1-score': 0.3392139516060723, 'support': 89740}, '1': {'precision': 0.7753177802744916, 'recall': 0.278717259657774, 'f1-score': 0.4100327577268041, 'support': 378814}, '2': {'precision': 0.3617596096849209, 'recall': 0.3501947672173117, 'f1-score': 0.3558832599736466, 'support': 90621}, 'accuracy': 0.37448383779675415, 'macro avg': {'precision': 0.45069397453060217, 'recall': 0.47739233820581745, 'f1-score': 0.3683766564355077, 'support': 559175}, 'weighted avg': {'precision': 0.6183730568325292, 'recall': 0.37448383779675415, 'f1-score': 0.38989172621222756, 'support': 559175}}
[[ 72085   9132   8523]
 [225766 105582  47466]
 [ 37421  21465  31735]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0764807
{'0': {'precision': 0.2188573883161512, 'recall': 0.7305868078535186, 'f1-score': 0.3368166793796084, 'support': 18132}, '1': {'precision': 0.8554244098442993, 'recall': 0.3405686976344258, 'f1-score': 0.4871780202806104, 'support': 100018}, '2': {'precision': 0.2726716027389634, 'recall': 0.540498786139925, 'f1-score': 0.36247918593894546, 'support': 18124}, 'accuracy': 0.41905279070108753, 'macro avg': {'precision': 0.4489844669664714, 'recall': 0.5372180972092898, 'f1-score': 0.39549129519972137, 'support': 136274}, 'weighted avg': {'precision': 0.6932214576279888, 'recall': 0.41905279070108753, 'f1-score': 0.45058708212054094, 'support': 136274}}
[[13247  2463  2422]
 [42247 34063 23708]
 [ 5034  3294  9796]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1394424
{'0': {'precision': 0.2049499062171188, 'recall': 0.7057340894770007, 'f1-score': 0.31765164675435176, 'support': 6348}, '1': {'precision': 0.880052030103131, 'recall': 0.2644258954244717, 'f1-score': 0.4066632320109909, 'support': 35821}, '2': {'precision': 0.23774069319640564, 'recall': 0.6139565721863086, 'f1-score': 0.34275667422384676, 'support': 6033}, 'accuracy': 0.3662918551097465, 'macro avg': {'precision': 0.4409142098388852, 'recall': 0.5280388523625937, 'f1-score': 0.35569051766306314, 'support': 48202}, 'weighted avg': {'precision': 0.71075174011544, 'recall': 0.3662918551097465, 'f1-score': 0.3869421871095556, 'support': 48202}}
[[ 4480   531  1337]
 [15810  9472 10539]
 [ 1569   760  3704]]
training model: results/QRTEA/W6/deepLOB_L1/h30
Epoch 1/50
533/533 - 13s - loss: 3.0472 - accuracy30: 0.4345 - val_loss: 3.0738 - val_accuracy30: 0.3364 - 13s/epoch - 24ms/step
Epoch 2/50
533/533 - 10s - loss: 2.8800 - accuracy30: 0.4796 - val_loss: 3.0302 - val_accuracy30: 0.3826 - 10s/epoch - 19ms/step
Epoch 3/50
533/533 - 11s - loss: 2.8170 - accuracy30: 0.5004 - val_loss: 3.0679 - val_accuracy30: 0.4136 - 11s/epoch - 20ms/step
Epoch 4/50
533/533 - 11s - loss: 2.7731 - accuracy30: 0.5170 - val_loss: 3.0481 - val_accuracy30: 0.4410 - 11s/epoch - 20ms/step
Epoch 5/50
533/533 - 11s - loss: 2.7410 - accuracy30: 0.5312 - val_loss: 3.0310 - val_accuracy30: 0.4588 - 11s/epoch - 20ms/step
Epoch 6/50
533/533 - 11s - loss: 2.7033 - accuracy30: 0.5504 - val_loss: 2.9889 - val_accuracy30: 0.4607 - 11s/epoch - 20ms/step
Epoch 7/50
533/533 - 11s - loss: 2.6733 - accuracy30: 0.5594 - val_loss: 3.0375 - val_accuracy30: 0.4567 - 11s/epoch - 20ms/step
Epoch 8/50
533/533 - 11s - loss: 2.6587 - accuracy30: 0.5681 - val_loss: 3.0548 - val_accuracy30: 0.4314 - 11s/epoch - 20ms/step
Epoch 9/50
533/533 - 11s - loss: 2.6321 - accuracy30: 0.5763 - val_loss: 3.0427 - val_accuracy30: 0.4453 - 11s/epoch - 20ms/step
Epoch 10/50
533/533 - 11s - loss: 2.6099 - accuracy30: 0.5852 - val_loss: 3.0190 - val_accuracy30: 0.4668 - 11s/epoch - 20ms/step
Epoch 11/50
533/533 - 11s - loss: 2.5870 - accuracy30: 0.5883 - val_loss: 3.0442 - val_accuracy30: 0.4542 - 11s/epoch - 20ms/step
Epoch 12/50
533/533 - 11s - loss: 2.5668 - accuracy30: 0.5968 - val_loss: 3.0241 - val_accuracy30: 0.4692 - 11s/epoch - 20ms/step
Epoch 13/50
533/533 - 10s - loss: 2.5520 - accuracy30: 0.5992 - val_loss: 2.9272 - val_accuracy30: 0.4945 - 10s/epoch - 19ms/step
Epoch 14/50
533/533 - 10s - loss: 2.5390 - accuracy30: 0.6045 - val_loss: 2.9409 - val_accuracy30: 0.4865 - 10s/epoch - 18ms/step
Epoch 15/50
533/533 - 10s - loss: 2.5243 - accuracy30: 0.6062 - val_loss: 2.9469 - val_accuracy30: 0.4848 - 10s/epoch - 19ms/step
Epoch 16/50
533/533 - 10s - loss: 2.5144 - accuracy30: 0.6095 - val_loss: 2.9637 - val_accuracy30: 0.4768 - 10s/epoch - 19ms/step
Epoch 17/50
533/533 - 11s - loss: 2.5006 - accuracy30: 0.6120 - val_loss: 2.9876 - val_accuracy30: 0.4762 - 11s/epoch - 20ms/step
Epoch 18/50
533/533 - 11s - loss: 2.4882 - accuracy30: 0.6136 - val_loss: 3.0875 - val_accuracy30: 0.4812 - 11s/epoch - 20ms/step
Epoch 19/50
533/533 - 11s - loss: 2.4765 - accuracy30: 0.6157 - val_loss: 3.0373 - val_accuracy30: 0.4983 - 11s/epoch - 20ms/step
Epoch 20/50
533/533 - 11s - loss: 2.4653 - accuracy30: 0.6156 - val_loss: 3.1004 - val_accuracy30: 0.5032 - 11s/epoch - 20ms/step
Epoch 21/50
533/533 - 11s - loss: 2.4583 - accuracy30: 0.6160 - val_loss: 3.1055 - val_accuracy30: 0.5226 - 11s/epoch - 21ms/step
Epoch 22/50
533/533 - 10s - loss: 2.4497 - accuracy30: 0.6168 - val_loss: 3.0339 - val_accuracy30: 0.5154 - 10s/epoch - 19ms/step
Epoch 23/50
533/533 - 10s - loss: 2.4411 - accuracy30: 0.6186 - val_loss: 3.0758 - val_accuracy30: 0.5080 - 10s/epoch - 19ms/step
testing model: results/QRTEA/W6/deepLOB_L1/h30
Evaluating performance on  test set...
2185/2185 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.000271
{'0': {'precision': 0.3102157328768262, 'recall': 0.6944248083934816, 'f1-score': 0.4288528921822046, 'support': 107512}, '1': {'precision': 0.7349740479384149, 'recall': 0.5508723259791994, 'f1-score': 0.6297437571622738, 'support': 343163}, '2': {'precision': 0.39205898665622657, 'recall': 0.2215115207373272, 'f1-score': 0.2830826492031896, 'support': 108500}, 'accuracy': 0.5145652076720169, 'macro avg': {'precision': 0.47908292249048917, 'recall': 0.4889362183700028, 'f1-score': 0.44722643284922264, 'support': 559175}, 'weighted avg': {'precision': 0.5867683876030656, 'recall': 0.5145652076720169, 'f1-score': 0.5238539929752164, 'support': 559175}}
[[ 74659  29026   3827]
 [120683 189039  33441]
 [ 45326  39140  24034]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0707058
{'0': {'precision': 0.2691384220224468, 'recall': 0.6643694004135079, 'f1-score': 0.38308694961055473, 'support': 21765}, '1': {'precision': 0.8155104993105943, 'recall': 0.38876975959828886, 'f1-score': 0.5265316248796007, 'support': 92803}, '2': {'precision': 0.29608938547486036, 'recall': 0.522528333179766, 'f1-score': 0.37799106845297603, 'support': 21706}, 'accuracy': 0.4540924901301789, 'macro avg': {'precision': 0.46024610226930046, 'recall': 0.525222497730521, 'f1-score': 0.42920321431437713, 'support': 136274}, 'weighted avg': {'precision': 0.6455122387539585, 'recall': 0.4540924901301789, 'f1-score': 0.4799615185128169, 'support': 136274}}
[[14460  4127  3178]
 [32938 36079 23786]
 [ 6329  4035 11342]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0600798
{'0': {'precision': 0.2878726010616578, 'recall': 0.6437516305765719, 'f1-score': 0.3978394937321133, 'support': 7666}, '1': {'precision': 0.8357060407849173, 'recall': 0.4571256764882742, 'f1-score': 0.5909859483412045, 'support': 33260}, '2': {'precision': 0.2944193999689103, 'recall': 0.5206157229246839, 'f1-score': 0.37612948068712143, 'support': 7276}, 'accuracy': 0.4963901912783702, 'macro avg': {'precision': 0.4726660139384952, 'recall': 0.5404976766631767, 'f1-score': 0.4549849742534797, 'support': 48202}, 'weighted avg': {'precision': 0.6668729478116844, 'recall': 0.4963901912783702, 'f1-score': 0.5278359466880698, 'support': 48202}}
[[ 4935  1449  1282]
 [10260 15204  7796]
 [ 1948  1540  3788]]
training model: results/QRTEA/W6/deepLOB_L1/h50
Epoch 1/50
533/533 - 14s - loss: 3.1222 - accuracy50: 0.4219 - val_loss: 3.1155 - val_accuracy50: 0.3665 - 14s/epoch - 26ms/step
Epoch 2/50
533/533 - 11s - loss: 2.9878 - accuracy50: 0.4501 - val_loss: 3.1079 - val_accuracy50: 0.3811 - 11s/epoch - 21ms/step
Epoch 3/50
533/533 - 11s - loss: 2.9326 - accuracy50: 0.4724 - val_loss: 3.0895 - val_accuracy50: 0.4050 - 11s/epoch - 20ms/step
Epoch 4/50
533/533 - 10s - loss: 2.8804 - accuracy50: 0.4968 - val_loss: 3.1036 - val_accuracy50: 0.3712 - 10s/epoch - 20ms/step
Epoch 5/50
533/533 - 11s - loss: 2.8636 - accuracy50: 0.5087 - val_loss: 3.1303 - val_accuracy50: 0.4083 - 11s/epoch - 20ms/step
Epoch 6/50
533/533 - 11s - loss: 2.8434 - accuracy50: 0.5182 - val_loss: 3.1675 - val_accuracy50: 0.3845 - 11s/epoch - 20ms/step
Epoch 7/50
533/533 - 11s - loss: 2.8084 - accuracy50: 0.5309 - val_loss: 3.1077 - val_accuracy50: 0.3903 - 11s/epoch - 20ms/step
Epoch 8/50
533/533 - 11s - loss: 2.7858 - accuracy50: 0.5438 - val_loss: 3.1179 - val_accuracy50: 0.3803 - 11s/epoch - 20ms/step
Epoch 9/50
533/533 - 10s - loss: 2.7715 - accuracy50: 0.5457 - val_loss: 3.1002 - val_accuracy50: 0.3642 - 10s/epoch - 19ms/step
Epoch 10/50
533/533 - 11s - loss: 2.7570 - accuracy50: 0.5484 - val_loss: 3.0920 - val_accuracy50: 0.3954 - 11s/epoch - 20ms/step
Epoch 11/50
533/533 - 11s - loss: 2.7502 - accuracy50: 0.5507 - val_loss: 3.1114 - val_accuracy50: 0.3548 - 11s/epoch - 20ms/step
Epoch 12/50
533/533 - 11s - loss: 2.7331 - accuracy50: 0.5562 - val_loss: 3.0872 - val_accuracy50: 0.3824 - 11s/epoch - 20ms/step
Epoch 13/50
533/533 - 10s - loss: 2.7229 - accuracy50: 0.5590 - val_loss: 3.0885 - val_accuracy50: 0.4074 - 10s/epoch - 19ms/step
Epoch 14/50
533/533 - 10s - loss: 2.7155 - accuracy50: 0.5616 - val_loss: 3.1208 - val_accuracy50: 0.3627 - 10s/epoch - 20ms/step
Epoch 15/50
533/533 - 11s - loss: 2.7073 - accuracy50: 0.5653 - val_loss: 3.0635 - val_accuracy50: 0.4156 - 11s/epoch - 21ms/step
Epoch 16/50
533/533 - 11s - loss: 2.6929 - accuracy50: 0.5702 - val_loss: 3.0844 - val_accuracy50: 0.3941 - 11s/epoch - 21ms/step
Epoch 17/50
533/533 - 11s - loss: 2.6846 - accuracy50: 0.5714 - val_loss: 3.0914 - val_accuracy50: 0.3971 - 11s/epoch - 20ms/step
Epoch 18/50
533/533 - 10s - loss: 2.6820 - accuracy50: 0.5727 - val_loss: 3.0871 - val_accuracy50: 0.3984 - 10s/epoch - 19ms/step
Epoch 19/50
533/533 - 11s - loss: 2.6689 - accuracy50: 0.5746 - val_loss: 3.0894 - val_accuracy50: 0.4037 - 11s/epoch - 21ms/step
Epoch 20/50
533/533 - 11s - loss: 2.6638 - accuracy50: 0.5760 - val_loss: 3.1298 - val_accuracy50: 0.3605 - 11s/epoch - 21ms/step
Epoch 21/50
533/533 - 11s - loss: 2.6539 - accuracy50: 0.5811 - val_loss: 3.2347 - val_accuracy50: 0.3378 - 11s/epoch - 20ms/step
Epoch 22/50
533/533 - 10s - loss: 2.6401 - accuracy50: 0.5815 - val_loss: 3.1387 - val_accuracy50: 0.4113 - 10s/epoch - 19ms/step
Epoch 23/50
533/533 - 11s - loss: 2.6368 - accuracy50: 0.5807 - val_loss: 3.1243 - val_accuracy50: 0.3872 - 11s/epoch - 20ms/step
Epoch 24/50
533/533 - 11s - loss: 2.6259 - accuracy50: 0.5845 - val_loss: 3.1631 - val_accuracy50: 0.3988 - 11s/epoch - 21ms/step
Epoch 25/50
533/533 - 10s - loss: 2.6195 - accuracy50: 0.5858 - val_loss: 3.1548 - val_accuracy50: 0.3903 - 10s/epoch - 20ms/step
testing model: results/QRTEA/W6/deepLOB_L1/h50
Evaluating performance on  test set...
2185/2185 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1546106
{'0': {'precision': 0.269052706983633, 'recall': 0.8227506179417728, 'f1-score': 0.40550028723316955, 'support': 135126}, '1': {'precision': 0.535066811902117, 'recall': 0.1729990027268099, 'f1-score': 0.2614616408215965, 'support': 286782}, '2': {'precision': 0.33780966512029753, 'recall': 0.1310293078452942, 'f1-score': 0.18881948454149391, 'support': 137267}, 'accuracy': 0.3197102874770868, 'macro avg': {'precision': 0.38064306133534914, 'recall': 0.37559297617129234, 'f1-score': 0.28526047086542, 'support': 559175}, 'weighted avg': {'precision': 0.42236091713122226, 'recall': 0.3197102874770868, 'f1-score': 0.2784366401847822, 'support': 559175}}
[[111175  16141   7810]
 [209722  49613  27447]
 [ 92312  26969  17986]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1088779
{'0': {'precision': 0.2730723670040922, 'recall': 0.73136965064715, 'f1-score': 0.3976672384219554, 'support': 27737}, '1': {'precision': 0.6992088016571021, 'recall': 0.25399664479202644, 'f1-score': 0.37263045504311554, 'support': 81068}, '2': {'precision': 0.3404124535144605, 'recall': 0.4032181732134406, 'f1-score': 0.3691630836916308, 'support': 27469}, 'accuracy': 0.3812392679454628, 'macro avg': {'precision': 0.4375645407252183, 'recall': 0.4628614895508723, 'f1-score': 0.37982025905223393, 'support': 136274}, 'weighted avg': {'precision': 0.540150410657346, 'recall': 0.3812392679454628, 'f1-score': 0.3770274789576183, 'support': 136274}}
[[20286  3735  3716]
 [42732 20591 17745]
 [11270  5123 11076]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1025766
{'0': {'precision': 0.2919640496960085, 'recall': 0.6730652041438148, 'f1-score': 0.40726401179941, 'support': 9846}, '1': {'precision': 0.7707506613756614, 'recall': 0.3200810244790057, 'f1-score': 0.4523203066249423, 'support': 29127}, '2': {'precision': 0.3030280429594272, 'recall': 0.4402427131866941, 'f1-score': 0.35896982815744133, 'support': 9229}, 'accuracy': 0.41519024106883534, 'macro avg': {'precision': 0.45524758467703236, 'recall': 0.4777963139365049, 'f1-score': 0.4061847155272646, 'support': 48202}, 'weighted avg': {'precision': 0.5833985800520382, 'recall': 0.41519024106883534, 'f1-score': 0.42524350805582156, 'support': 48202}}
[[ 6627  1302  1917]
 [12376  9323  7428]
 [ 3695  1471  4063]]
training model: results/QRTEA/W6/deepLOB_L1/h100
Epoch 1/50
533/533 - 13s - loss: 3.1784 - accuracy100: 0.4267 - val_loss: 3.3110 - val_accuracy100: 0.4058 - 13s/epoch - 25ms/step
Epoch 2/50
533/533 - 11s - loss: 3.0786 - accuracy100: 0.4556 - val_loss: 3.2909 - val_accuracy100: 0.4369 - 11s/epoch - 21ms/step
Epoch 3/50
533/533 - 11s - loss: 3.0360 - accuracy100: 0.4690 - val_loss: 3.1864 - val_accuracy100: 0.4605 - 11s/epoch - 20ms/step
Epoch 4/50
533/533 - 11s - loss: 3.0147 - accuracy100: 0.4834 - val_loss: 3.1964 - val_accuracy100: 0.4470 - 11s/epoch - 20ms/step
Epoch 5/50
533/533 - 11s - loss: 2.9892 - accuracy100: 0.4913 - val_loss: 3.1777 - val_accuracy100: 0.4396 - 11s/epoch - 20ms/step
Epoch 6/50
533/533 - 10s - loss: 2.9794 - accuracy100: 0.4951 - val_loss: 3.1901 - val_accuracy100: 0.4551 - 10s/epoch - 19ms/step
Epoch 7/50
533/533 - 11s - loss: 2.9692 - accuracy100: 0.4992 - val_loss: 3.1554 - val_accuracy100: 0.4576 - 11s/epoch - 20ms/step
Epoch 8/50
533/533 - 11s - loss: 2.9530 - accuracy100: 0.5039 - val_loss: 3.1579 - val_accuracy100: 0.4611 - 11s/epoch - 21ms/step
Epoch 9/50
533/533 - 11s - loss: 2.9481 - accuracy100: 0.5049 - val_loss: 3.2254 - val_accuracy100: 0.4537 - 11s/epoch - 20ms/step
Epoch 10/50
533/533 - 10s - loss: 2.9402 - accuracy100: 0.5094 - val_loss: 3.2719 - val_accuracy100: 0.4506 - 10s/epoch - 20ms/step
Epoch 11/50
533/533 - 10s - loss: 2.9364 - accuracy100: 0.5106 - val_loss: 3.2479 - val_accuracy100: 0.4556 - 10s/epoch - 19ms/step
Epoch 12/50
533/533 - 10s - loss: 2.9324 - accuracy100: 0.5109 - val_loss: 3.3099 - val_accuracy100: 0.4461 - 10s/epoch - 19ms/step
Epoch 13/50
533/533 - 11s - loss: 2.9201 - accuracy100: 0.5135 - val_loss: 3.2398 - val_accuracy100: 0.4616 - 11s/epoch - 20ms/step
Epoch 14/50
533/533 - 11s - loss: 2.9145 - accuracy100: 0.5149 - val_loss: 3.3367 - val_accuracy100: 0.4583 - 11s/epoch - 20ms/step
Epoch 15/50
533/533 - 11s - loss: 2.9074 - accuracy100: 0.5162 - val_loss: 3.3663 - val_accuracy100: 0.4595 - 11s/epoch - 20ms/step
Epoch 16/50
533/533 - 10s - loss: 2.9029 - accuracy100: 0.5203 - val_loss: 3.3612 - val_accuracy100: 0.4624 - 10s/epoch - 18ms/step
Epoch 17/50
533/533 - 10s - loss: 2.8975 - accuracy100: 0.5219 - val_loss: 3.2792 - val_accuracy100: 0.4592 - 10s/epoch - 18ms/step
testing model: results/QRTEA/W6/deepLOB_L1/h100
Evaluating performance on  test set...
2185/2185 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1120354
{'0': {'precision': 0.4074848168173626, 'recall': 0.6130028138207585, 'f1-score': 0.4895489799167558, 'support': 175562}, '1': {'precision': 0.4481309306172195, 'recall': 0.6329903397800382, 'f1-score': 0.5247562096953411, 'support': 203308}, '2': {'precision': 0.5382665990876837, 'recall': 0.02356007875544217, 'f1-score': 0.045144184019936556, 'support': 180305}, 'accuracy': 0.43020521303706355, 'macro avg': {'precision': 0.4646274488407552, 'recall': 0.42318441078541297, 'f1-score': 0.3531497912106778, 'support': 559175}, 'weighted avg': {'precision': 0.46443351687847323, 'recall': 0.43020521303706355, 'f1-score': 0.3590522744983244, 'support': 559175}}
[[107620  66751   1191]
 [ 72163 128692   2453]
 [ 84325  91732   4248]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0366676
{'0': {'precision': 0.3872721623860812, 'recall': 0.5908827557147371, 'f1-score': 0.46788589064520164, 'support': 37972}, '1': {'precision': 0.5371575004928051, 'recall': 0.5324085380745371, 'f1-score': 0.5347724763890592, 'support': 61419}, '2': {'precision': 0.46180277173290574, 'recall': 0.21863731258303284, 'f1-score': 0.2967706320728678, 'support': 36883}, 'accuracy': 0.4637788573022, 'macro avg': {'precision': 0.4620774782039307, 'recall': 0.4473095354574357, 'f1-score': 0.4331429997023762, 'support': 136274}, 'weighted avg': {'precision': 0.4749977743569326, 'recall': 0.4637788573022, 'f1-score': 0.4517189264985456, 'support': 136274}}
[[22437 12966  2569]
 [21890 32700  6829]
 [13609 15210  8064]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0419431
{'0': {'precision': 0.38996546431312357, 'recall': 0.6093082515176497, 'f1-score': 0.4755637448451347, 'support': 13343}, '1': {'precision': 0.5966796875, 'recall': 0.46107066761363635, 'f1-score': 0.5201822916666667, 'support': 22528}, '2': {'precision': 0.36406595616328175, 'recall': 0.29365015002838374, 'f1-score': 0.32508865646182167, 'support': 12331}, 'accuracy': 0.4592755487324177, 'macro avg': {'precision': 0.4502370359921351, 'recall': 0.45467635638655657, 'f1-score': 0.44027823099120766, 'support': 48202}, 'weighted avg': {'precision': 0.479951174137576, 'recall': 0.4592755487324177, 'f1-score': 0.4579225330269703, 'support': 48202}}
[[ 8130  3217  1996]
 [ 7812 10387  4329]
 [ 4906  3804  3621]]
training model: results/QRTEA/W6/deepLOB_L1/h200
Epoch 1/50
533/533 - 12s - loss: 3.2468 - accuracy200: 0.4018 - val_loss: 3.4843 - val_accuracy200: 0.3529 - 12s/epoch - 23ms/step
Epoch 2/50
533/533 - 11s - loss: 3.2049 - accuracy200: 0.4173 - val_loss: 3.3133 - val_accuracy200: 0.3678 - 11s/epoch - 20ms/step
Epoch 3/50
533/533 - 11s - loss: 3.1723 - accuracy200: 0.4362 - val_loss: 3.2887 - val_accuracy200: 0.3832 - 11s/epoch - 21ms/step
Epoch 4/50
533/533 - 11s - loss: 3.1533 - accuracy200: 0.4438 - val_loss: 3.3085 - val_accuracy200: 0.3697 - 11s/epoch - 21ms/step
Epoch 5/50
533/533 - 11s - loss: 3.1539 - accuracy200: 0.4446 - val_loss: 3.3049 - val_accuracy200: 0.3798 - 11s/epoch - 20ms/step
Epoch 6/50
533/533 - 10s - loss: 3.1391 - accuracy200: 0.4451 - val_loss: 3.3778 - val_accuracy200: 0.3597 - 10s/epoch - 18ms/step
Epoch 7/50
533/533 - 10s - loss: 3.1386 - accuracy200: 0.4499 - val_loss: 3.3791 - val_accuracy200: 0.3691 - 10s/epoch - 19ms/step
Epoch 8/50
533/533 - 11s - loss: 3.1230 - accuracy200: 0.4536 - val_loss: 3.3883 - val_accuracy200: 0.3703 - 11s/epoch - 20ms/step
Epoch 9/50
533/533 - 11s - loss: 3.1132 - accuracy200: 0.4552 - val_loss: 3.3409 - val_accuracy200: 0.3714 - 11s/epoch - 21ms/step
Epoch 10/50
533/533 - 11s - loss: 3.0986 - accuracy200: 0.4627 - val_loss: 3.3234 - val_accuracy200: 0.3902 - 11s/epoch - 20ms/step
Epoch 11/50
533/533 - 11s - loss: 3.0918 - accuracy200: 0.4665 - val_loss: 3.3015 - val_accuracy200: 0.3868 - 11s/epoch - 20ms/step
Epoch 12/50
533/533 - 11s - loss: 3.0837 - accuracy200: 0.4696 - val_loss: 3.3154 - val_accuracy200: 0.3940 - 11s/epoch - 20ms/step
Epoch 13/50
533/533 - 10s - loss: 3.0788 - accuracy200: 0.4721 - val_loss: 3.3404 - val_accuracy200: 0.3919 - 10s/epoch - 19ms/step
testing model: results/QRTEA/W6/deepLOB_L1/h200
Evaluating performance on  test set...
2185/2185 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1339104
{'0': {'precision': 0.4110947514290663, 'recall': 0.09467437917622419, 'f1-score': 0.15390476808093254, 'support': 200540}, '1': {'precision': 0.26547978880797163, 'recall': 0.8525264239964153, 'f1-score': 0.40487885023118997, 'support': 151756}, '2': {'precision': 0.4342997428103811, 'recall': 0.05387207014728416, 'f1-score': 0.09585406444454955, 'support': 206879}, 'accuracy': 0.28525416908838913, 'macro avg': {'precision': 0.3702914276824731, 'recall': 0.3336909577733079, 'f1-score': 0.2182125609188907, 'support': 559175}, 'weighted avg': {'precision': 0.38016111016192844, 'recall': 0.28525416908838913, 'f1-score': 0.20054017076024258, 'support': 559175}}
[[ 18986 174672   6882]
 [ 14745 129376   7635]
 [ 12453 183281  11145]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1017082
{'0': {'precision': 0.43908505657432695, 'recall': 0.19507702975016794, 'f1-score': 0.270137274022954, 'support': 46151}, '1': {'precision': 0.3465426940504914, 'recall': 0.6312359309679494, 'f1-score': 0.4474432034039966, 'support': 46645}, '2': {'precision': 0.38399610452848565, 'recall': 0.27206863241179446, 'f1-score': 0.318484713864545, 'support': 43478}, 'accuracy': 0.36893317874282694, 'macro avg': {'precision': 0.38987461838443466, 'recall': 0.36612719770997054, 'f1-score': 0.3453550637638319, 'support': 136274}, 'weighted avg': {'precision': 0.38983284443574295, 'recall': 0.36893317874282694, 'f1-score': 0.34625219737892377, 'support': 136274}}
[[ 9003 27919  9229]
 [ 7454 29444  9747]
 [ 4047 27602 11829]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.097625
{'0': {'precision': 0.43414376321353065, 'recall': 0.24637072585482903, 'f1-score': 0.31435132032146956, 'support': 16670}, '1': {'precision': 0.3788705245457901, 'recall': 0.5482167230431428, 'f1-score': 0.44807682980065, 'support': 16851}, '2': {'precision': 0.3609582840030643, 'recall': 0.35304134595735986, 'f1-score': 0.3569559228650138, 'support': 14681}, 'accuracy': 0.3843823907721671, 'macro avg': {'precision': 0.39132419058746165, 'recall': 0.3825429316184439, 'f1-score': 0.37312802432904446, 'support': 48202}, 'weighted avg': {'precision': 0.39253044083937705, 'recall': 0.3843823907721671, 'f1-score': 0.3740767825465939, 'support': 48202}}
[[4107 7844 4719]
 [3156 9238 4457]
 [2197 7301 5183]]
training model: results/QRTEA/W6/deepLOB_L1/h300
Epoch 1/50
533/533 - 13s - loss: 3.2902 - accuracy300: 0.3878 - val_loss: 3.4467 - val_accuracy300: 0.3416 - 13s/epoch - 25ms/step
Epoch 2/50
533/533 - 10s - loss: 3.2479 - accuracy300: 0.3978 - val_loss: 3.3209 - val_accuracy300: 0.3645 - 10s/epoch - 20ms/step
Epoch 3/50
533/533 - 11s - loss: 3.2236 - accuracy300: 0.4133 - val_loss: 3.3207 - val_accuracy300: 0.4015 - 11s/epoch - 20ms/step
Epoch 4/50
533/533 - 10s - loss: 3.2104 - accuracy300: 0.4196 - val_loss: 3.3158 - val_accuracy300: 0.4035 - 10s/epoch - 19ms/step
Epoch 5/50
533/533 - 10s - loss: 3.2022 - accuracy300: 0.4253 - val_loss: 3.2752 - val_accuracy300: 0.4191 - 10s/epoch - 19ms/step
Epoch 6/50
533/533 - 11s - loss: 3.1956 - accuracy300: 0.4270 - val_loss: 3.3231 - val_accuracy300: 0.4055 - 11s/epoch - 20ms/step
Epoch 7/50
533/533 - 11s - loss: 3.1858 - accuracy300: 0.4318 - val_loss: 3.3504 - val_accuracy300: 0.4109 - 11s/epoch - 20ms/step
Epoch 8/50
533/533 - 10s - loss: 3.1803 - accuracy300: 0.4346 - val_loss: 3.3498 - val_accuracy300: 0.4024 - 10s/epoch - 19ms/step
Epoch 9/50
533/533 - 11s - loss: 3.1712 - accuracy300: 0.4396 - val_loss: 3.3634 - val_accuracy300: 0.4065 - 11s/epoch - 20ms/step
Epoch 10/50
533/533 - 11s - loss: 3.1712 - accuracy300: 0.4368 - val_loss: 3.3583 - val_accuracy300: 0.3929 - 11s/epoch - 20ms/step
Epoch 11/50
533/533 - 11s - loss: 3.1667 - accuracy300: 0.4414 - val_loss: 3.3259 - val_accuracy300: 0.3853 - 11s/epoch - 20ms/step
Epoch 12/50
533/533 - 10s - loss: 3.1577 - accuracy300: 0.4432 - val_loss: 3.3628 - val_accuracy300: 0.3693 - 10s/epoch - 19ms/step
Epoch 13/50
533/533 - 11s - loss: 3.1502 - accuracy300: 0.4463 - val_loss: 3.3796 - val_accuracy300: 0.3774 - 11s/epoch - 20ms/step
Epoch 14/50
533/533 - 11s - loss: 3.1438 - accuracy300: 0.4496 - val_loss: 3.4006 - val_accuracy300: 0.3827 - 11s/epoch - 21ms/step
Epoch 15/50
533/533 - 11s - loss: 3.1487 - accuracy300: 0.4452 - val_loss: 3.3553 - val_accuracy300: 0.3933 - 11s/epoch - 20ms/step
testing model: results/QRTEA/W6/deepLOB_L1/h300
Evaluating performance on  test set...
2185/2185 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1236274
{'0': {'precision': 0.3503815015554873, 'recall': 0.8962311412043262, 'f1-score': 0.5038017459870459, 'support': 189633}, '1': {'precision': 0.3588356559742723, 'recall': 0.12755155878111407, 'f1-score': 0.18820415453880987, 'support': 170582}, '2': {'precision': 0.4625083438403916, 'recall': 0.031342983514274225, 'f1-score': 0.05870751213266617, 'support': 198960}, 'accuracy': 0.3540018777663522, 'macro avg': {'precision': 0.39057516712338375, 'recall': 0.3517085611665715, 'f1-score': 0.2502378042195073, 'support': 559175}, 'weighted avg': {'precision': 0.39285636740261876, 'recall': 0.3540018777663522, 'f1-score': 0.24915656851650378, 'support': 559175}}
[[169955  17103   2575]
 [144152  21758   4672]
 [170950  21774   6236]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0888892
{'0': {'precision': 0.37958732319058963, 'recall': 0.6651123176833812, 'f1-score': 0.48333165708627, 'support': 46965}, '1': {'precision': 0.3965026285046729, 'recall': 0.24086846599099598, 'f1-score': 0.29968406384945434, 'support': 45091}, '2': {'precision': 0.41816472358029333, 'recall': 0.2514586819847121, 'f1-score': 0.31406055812902495, 'support': 44218}, 'accuracy': 0.3905146983283678, 'macro avg': {'precision': 0.39808489175851863, 'recall': 0.3858131552196964, 'f1-score': 0.36569209302158306, 'support': 136274}, 'weighted avg': {'precision': 0.3977018829917934, 'recall': 0.3905146983283678, 'f1-score': 0.36764060024246475, 'support': 136274}}
[[31237  8234  7494]
 [26253 10861  7977]
 [24802  8297 11119]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0909717
{'0': {'precision': 0.41151369965563706, 'recall': 0.6261533204237385, 'f1-score': 0.49663459366671187, 'support': 17558}, '1': {'precision': 0.5211206428493864, 'recall': 0.30487262562734263, 'f1-score': 0.3846893787575151, 'support': 15741}, '2': {'precision': 0.3639325568135538, 'recall': 0.29980540830705227, 'f1-score': 0.32877115526122147, 'support': 14903}, 'accuracy': 0.4203352557985146, 'macro avg': {'precision': 0.43218896643952576, 'recall': 0.4102771181193778, 'f1-score': 0.4033650425618161, 'support': 48202}, 'weighted avg': {'precision': 0.4325962506086523, 'recall': 0.4203352557985146, 'f1-score': 0.40817771531223096, 'support': 48202}}
[[10994  2490  4074]
 [ 7207  4799  3735]
 [ 8515  1920  4468]]
training model: results/QRTEA/W6/deepLOB_L1/h500
Epoch 1/50
533/533 - 13s - loss: 3.2889 - accuracy500: 0.3916 - val_loss: 3.3577 - val_accuracy500: 0.3717 - 13s/epoch - 25ms/step
Epoch 2/50
533/533 - 11s - loss: 3.2564 - accuracy500: 0.4013 - val_loss: 3.3376 - val_accuracy500: 0.3516 - 11s/epoch - 21ms/step
Epoch 3/50
533/533 - 11s - loss: 3.2630 - accuracy500: 0.4003 - val_loss: 3.3280 - val_accuracy500: 0.3535 - 11s/epoch - 20ms/step
Epoch 4/50
533/533 - 11s - loss: 3.2623 - accuracy500: 0.3929 - val_loss: 3.3352 - val_accuracy500: 0.3406 - 11s/epoch - 20ms/step
Epoch 5/50
533/533 - 11s - loss: 3.2441 - accuracy500: 0.4020 - val_loss: 3.3608 - val_accuracy500: 0.3432 - 11s/epoch - 20ms/step
Epoch 6/50
533/533 - 11s - loss: 3.2309 - accuracy500: 0.4095 - val_loss: 3.3500 - val_accuracy500: 0.3580 - 11s/epoch - 21ms/step
Epoch 7/50
533/533 - 10s - loss: 3.2272 - accuracy500: 0.4092 - val_loss: 3.3659 - val_accuracy500: 0.3409 - 10s/epoch - 20ms/step
Epoch 8/50
533/533 - 11s - loss: 3.2223 - accuracy500: 0.4128 - val_loss: 3.3608 - val_accuracy500: 0.3568 - 11s/epoch - 20ms/step
Epoch 9/50
533/533 - 11s - loss: 3.2192 - accuracy500: 0.4136 - val_loss: 3.3753 - val_accuracy500: 0.3543 - 11s/epoch - 20ms/step
Epoch 10/50
533/533 - 11s - loss: 3.2177 - accuracy500: 0.4134 - val_loss: 3.3425 - val_accuracy500: 0.3610 - 11s/epoch - 20ms/step
Epoch 11/50
533/533 - 11s - loss: 3.2096 - accuracy500: 0.4188 - val_loss: 3.3596 - val_accuracy500: 0.3575 - 11s/epoch - 20ms/step
Epoch 12/50
533/533 - 10s - loss: 3.2035 - accuracy500: 0.4204 - val_loss: 3.4194 - val_accuracy500: 0.3620 - 10s/epoch - 20ms/step
Epoch 13/50
533/533 - 11s - loss: 3.1895 - accuracy500: 0.4279 - val_loss: 3.4460 - val_accuracy500: 0.3603 - 11s/epoch - 21ms/step
testing model: results/QRTEA/W6/deepLOB_L1/h500
Evaluating performance on  test set...
2185/2185 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.138701
{'0': {'precision': 0.3552973833856723, 'recall': 0.36114466085438507, 'f1-score': 0.3581971606967139, 'support': 197054}, '1': {'precision': 0.2712157809983897, 'recall': 0.6127131581511677, 'f1-score': 0.37599736891936336, 'support': 153935}, '2': {'precision': 0.40627810757330457, 'recall': 0.021696944078852566, 'f1-score': 0.04119395907051399, 'support': 208186}, 'accuracy': 0.3040193141681942, 'macro avg': {'precision': 0.34426375731912223, 'recall': 0.3318515876948018, 'f1-score': 0.25846282956219707, 'support': 559175}, 'weighted avg': {'precision': 0.35113119495135403, 'recall': 0.3040193141681942, 'f1-score': 0.24507416077540392, 'support': 559175}}
[[ 71165 122521   3368]
 [ 56384  94318   3233]
 [ 72748 130921   4517]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1231333
{'0': {'precision': 0.38266526757607555, 'recall': 0.19103995976782684, 'f1-score': 0.25484989098227767, 'support': 47723}, '1': {'precision': 0.3227145110233666, 'recall': 0.6628604250430787, 'f1-score': 0.43409114845854085, 'support': 43525}, '2': {'precision': 0.37044429017702185, 'recall': 0.1896237729311953, 'f1-score': 0.25084466903663666, 'support': 45026}, 'accuracy': 0.3412683270469789, 'macro avg': {'precision': 0.358608022925488, 'recall': 0.34784138591403363, 'f1-score': 0.3132619028258184, 'support': 136274}, 'weighted avg': {'precision': 0.3594794918057419, 'recall': 0.3412683270469789, 'f1-score': 0.3107749875401678, 'support': 136274}}
[[ 9117 30813  7793]
 [ 7957 28851  6717]
 [ 6751 29737  8538]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.110428
{'0': {'precision': 0.3383672079028046, 'recall': 0.18043109711794622, 'f1-score': 0.2353591596572286, 'support': 16516}, '1': {'precision': 0.3668682602156731, 'recall': 0.6484728506787331, 'f1-score': 0.4686190758414911, 'support': 17680}, '2': {'precision': 0.3161836935166994, 'recall': 0.18384977866628588, 'f1-score': 0.23250564334085777, 'support': 14006}, 'accuracy': 0.35309738185137546, 'macro avg': {'precision': 0.3404730538783924, 'recall': 0.337584575487655, 'f1-score': 0.3121612929465258, 'support': 48202}, 'weighted avg': {'precision': 0.3423752636349262, 'recall': 0.35309738185137546, 'f1-score': 0.32008736530451853, 'support': 48202}}
[[ 2980 10813  2723]
 [ 3369 11465  2846]
 [ 2458  8973  2575]]
training model: results/QRTEA/W6/deepLOB_L1/h1000
Epoch 1/50
533/533 - 14s - loss: 3.2489 - accuracy1000: 0.4199 - val_loss: 3.3598 - val_accuracy1000: 0.3346 - 14s/epoch - 26ms/step
Epoch 2/50
533/533 - 11s - loss: 3.2225 - accuracy1000: 0.4266 - val_loss: 3.3666 - val_accuracy1000: 0.3289 - 11s/epoch - 20ms/step
Epoch 3/50
533/533 - 11s - loss: 3.2231 - accuracy1000: 0.4168 - val_loss: 3.3337 - val_accuracy1000: 0.3266 - 11s/epoch - 20ms/step
Epoch 4/50
533/533 - 11s - loss: 3.1918 - accuracy1000: 0.4319 - val_loss: 3.2934 - val_accuracy1000: 0.3397 - 11s/epoch - 21ms/step
Epoch 5/50
533/533 - 11s - loss: 3.2186 - accuracy1000: 0.4198 - val_loss: 3.3142 - val_accuracy1000: 0.3120 - 11s/epoch - 20ms/step
Epoch 6/50
533/533 - 11s - loss: 3.2031 - accuracy1000: 0.4322 - val_loss: 3.4054 - val_accuracy1000: 0.3007 - 11s/epoch - 20ms/step
Epoch 7/50
533/533 - 11s - loss: 3.2030 - accuracy1000: 0.4343 - val_loss: 3.4637 - val_accuracy1000: 0.2891 - 11s/epoch - 20ms/step
Epoch 8/50
533/533 - 10s - loss: 3.2095 - accuracy1000: 0.4359 - val_loss: 3.3927 - val_accuracy1000: 0.3212 - 10s/epoch - 19ms/step
Epoch 9/50
533/533 - 11s - loss: 3.1941 - accuracy1000: 0.4368 - val_loss: 3.3891 - val_accuracy1000: 0.3270 - 11s/epoch - 20ms/step
Epoch 10/50
533/533 - 10s - loss: 3.1645 - accuracy1000: 0.4508 - val_loss: 3.3841 - val_accuracy1000: 0.3302 - 10s/epoch - 19ms/step
Epoch 11/50
533/533 - 10s - loss: 3.1410 - accuracy1000: 0.4653 - val_loss: 3.4709 - val_accuracy1000: 0.3005 - 10s/epoch - 19ms/step
Epoch 12/50
533/533 - 10s - loss: 3.1268 - accuracy1000: 0.4703 - val_loss: 3.4977 - val_accuracy1000: 0.3065 - 10s/epoch - 19ms/step
Epoch 13/50
533/533 - 11s - loss: 3.1144 - accuracy1000: 0.4770 - val_loss: 3.3903 - val_accuracy1000: 0.3224 - 11s/epoch - 20ms/step
Epoch 14/50
533/533 - 11s - loss: 3.1049 - accuracy1000: 0.4788 - val_loss: 3.4243 - val_accuracy1000: 0.3118 - 11s/epoch - 20ms/step
testing model: results/QRTEA/W6/deepLOB_L1/h1000
Evaluating performance on  test set...
2185/2185 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0959998
{'0': {'precision': 0.2826047694953318, 'recall': 0.2441108842660734, 'f1-score': 0.2619512053103529, 'support': 147433}, '1': {'precision': 0.43703438761432734, 'recall': 0.5364099691026386, 'f1-score': 0.481649722943853, 'support': 239179}, '2': {'precision': 0.322792729587224, 'recall': 0.25862438645596103, 'f1-score': 0.2871675750107779, 'support': 172563}, 'accuracy': 0.37361648857692137, 'macro avg': {'precision': 0.34747729556562773, 'recall': 0.34638174660822435, 'f1-score': 0.3435895010883279, 'support': 559175}, 'weighted avg': {'precision': 0.3610619190270892, 'recall': 0.37361648857692137, 'f1-score': 0.36370590491902166, 'support': 559175}}
[[ 35990  77022  34421]
 [ 51672 128298  59209]
 [ 39689  88245  44629]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0995194
{'0': {'precision': 0.3588529392330903, 'recall': 0.3403024353565312, 'f1-score': 0.3493315894983973, 'support': 47878}, '1': {'precision': 0.370426955157321, 'recall': 0.41186327847026144, 'f1-score': 0.3900477179099773, 'support': 43563}, '2': {'precision': 0.371038058206669, 'recall': 0.35119220217250685, 'f1-score': 0.3608424623000412, 'support': 44833}, 'accuracy': 0.36676108428607074, 'macro avg': {'precision': 0.36677265086569344, 'recall': 0.3677859719997665, 'f1-score': 0.3667405899028053, 'support': 136274}, 'weighted avg': {'precision': 0.3665616312407346, 'recall': 0.36676108428607074, 'f1-score': 0.3661343813905393, 'support': 136274}}
[[16293 15674 15911]
 [14842 17942 10779]
 [14268 14820 15745]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1021957
{'0': {'precision': 0.4095921450151057, 'recall': 0.2746935467531152, 'f1-score': 0.3288460372324298, 'support': 19742}, '1': {'precision': 0.2925902015637329, 'recall': 0.3076168929110106, 'f1-score': 0.29991544428513656, 'support': 13260}, '2': {'precision': 0.3329527615241901, 'recall': 0.4604605263157895, 'f1-score': 0.3864608928522129, 'support': 15200}, 'accuracy': 0.3423301937678935, 'macro avg': {'precision': 0.3450450360343429, 'recall': 0.34759032199330503, 'f1-score': 0.33840745812325973, 'support': 48202}, 'weighted avg': {'precision': 0.3532383754780093, 'recall': 0.3423301937678935, 'f1-score': 0.33905569954809295, 'support': 48202}}
[[5423 5399 8920]
 [4079 4079 5102]
 [3738 4463 6999]]
training model: results/QRTEA/W6/deepOF_L1/h10
Epoch 1/50
533/533 - 12s - loss: 3.0719 - accuracy10: 0.4503 - val_loss: 2.9586 - val_accuracy10: 0.5631 - 12s/epoch - 23ms/step
Epoch 2/50
533/533 - 10s - loss: 2.9640 - accuracy10: 0.4666 - val_loss: 2.9393 - val_accuracy10: 0.6012 - 10s/epoch - 18ms/step
Epoch 3/50
533/533 - 10s - loss: 2.9232 - accuracy10: 0.4807 - val_loss: 2.8700 - val_accuracy10: 0.6047 - 10s/epoch - 18ms/step
Epoch 4/50
533/533 - 10s - loss: 2.8842 - accuracy10: 0.5020 - val_loss: 2.8441 - val_accuracy10: 0.6124 - 10s/epoch - 19ms/step
Epoch 5/50
533/533 - 10s - loss: 2.8498 - accuracy10: 0.5210 - val_loss: 2.8348 - val_accuracy10: 0.6333 - 10s/epoch - 19ms/step
Epoch 6/50
533/533 - 9s - loss: 2.8240 - accuracy10: 0.5333 - val_loss: 2.8239 - val_accuracy10: 0.6382 - 9s/epoch - 17ms/step
Epoch 7/50
533/533 - 9s - loss: 2.7960 - accuracy10: 0.5486 - val_loss: 2.8230 - val_accuracy10: 0.6274 - 9s/epoch - 17ms/step
Epoch 8/50
533/533 - 10s - loss: 2.7753 - accuracy10: 0.5506 - val_loss: 2.8136 - val_accuracy10: 0.6408 - 10s/epoch - 18ms/step
Epoch 9/50
533/533 - 10s - loss: 2.7587 - accuracy10: 0.5563 - val_loss: 2.7922 - val_accuracy10: 0.6360 - 10s/epoch - 19ms/step
Epoch 10/50
533/533 - 9s - loss: 2.7385 - accuracy10: 0.5637 - val_loss: 2.7869 - val_accuracy10: 0.6288 - 9s/epoch - 18ms/step
Epoch 11/50
533/533 - 9s - loss: 2.7217 - accuracy10: 0.5679 - val_loss: 2.7539 - val_accuracy10: 0.6377 - 9s/epoch - 17ms/step
Epoch 12/50
533/533 - 10s - loss: 2.7026 - accuracy10: 0.5705 - val_loss: 2.7503 - val_accuracy10: 0.6266 - 10s/epoch - 18ms/step
Epoch 13/50
533/533 - 10s - loss: 2.6796 - accuracy10: 0.5734 - val_loss: 2.7449 - val_accuracy10: 0.6243 - 10s/epoch - 18ms/step
Epoch 14/50
533/533 - 10s - loss: 2.6660 - accuracy10: 0.5758 - val_loss: 2.7236 - val_accuracy10: 0.6005 - 10s/epoch - 18ms/step
Epoch 15/50
533/533 - 10s - loss: 2.6472 - accuracy10: 0.5777 - val_loss: 2.7357 - val_accuracy10: 0.5877 - 10s/epoch - 18ms/step
Epoch 16/50
533/533 - 9s - loss: 2.6295 - accuracy10: 0.5798 - val_loss: 2.7289 - val_accuracy10: 0.6090 - 9s/epoch - 18ms/step
Epoch 17/50
533/533 - 10s - loss: 2.6146 - accuracy10: 0.5818 - val_loss: 2.7111 - val_accuracy10: 0.5897 - 10s/epoch - 18ms/step
Epoch 18/50
533/533 - 10s - loss: 2.5941 - accuracy10: 0.5879 - val_loss: 2.7072 - val_accuracy10: 0.5664 - 10s/epoch - 18ms/step
Epoch 19/50
533/533 - 9s - loss: 2.5745 - accuracy10: 0.5879 - val_loss: 2.6882 - val_accuracy10: 0.5490 - 9s/epoch - 17ms/step
Epoch 20/50
533/533 - 10s - loss: 2.5615 - accuracy10: 0.5888 - val_loss: 2.7071 - val_accuracy10: 0.5479 - 10s/epoch - 18ms/step
Epoch 21/50
533/533 - 9s - loss: 2.5423 - accuracy10: 0.5937 - val_loss: 2.6884 - val_accuracy10: 0.5155 - 9s/epoch - 17ms/step
Epoch 22/50
533/533 - 9s - loss: 2.5356 - accuracy10: 0.5930 - val_loss: 2.7016 - val_accuracy10: 0.5355 - 9s/epoch - 18ms/step
Epoch 23/50
533/533 - 9s - loss: 2.5187 - accuracy10: 0.5954 - val_loss: 2.6859 - val_accuracy10: 0.5209 - 9s/epoch - 18ms/step
Epoch 24/50
533/533 - 9s - loss: 2.5083 - accuracy10: 0.5954 - val_loss: 2.6847 - val_accuracy10: 0.5169 - 9s/epoch - 18ms/step
Epoch 25/50
533/533 - 9s - loss: 2.4948 - accuracy10: 0.5958 - val_loss: 2.7246 - val_accuracy10: 0.4899 - 9s/epoch - 17ms/step
Epoch 26/50
533/533 - 9s - loss: 2.4853 - accuracy10: 0.5942 - val_loss: 2.7159 - val_accuracy10: 0.5012 - 9s/epoch - 17ms/step
Epoch 27/50
533/533 - 9s - loss: 2.4724 - accuracy10: 0.5997 - val_loss: 2.7155 - val_accuracy10: 0.4855 - 9s/epoch - 17ms/step
Epoch 28/50
533/533 - 9s - loss: 2.4587 - accuracy10: 0.5998 - val_loss: 2.7186 - val_accuracy10: 0.4824 - 9s/epoch - 18ms/step
Epoch 29/50
533/533 - 9s - loss: 2.4491 - accuracy10: 0.6008 - val_loss: 2.6930 - val_accuracy10: 0.5030 - 9s/epoch - 17ms/step
Epoch 30/50
533/533 - 9s - loss: 2.4337 - accuracy10: 0.6020 - val_loss: 2.7311 - val_accuracy10: 0.4986 - 9s/epoch - 18ms/step
Epoch 31/50
533/533 - 9s - loss: 2.4326 - accuracy10: 0.6018 - val_loss: 2.6998 - val_accuracy10: 0.5082 - 9s/epoch - 16ms/step
Epoch 32/50
533/533 - 9s - loss: 2.4171 - accuracy10: 0.6061 - val_loss: 2.7341 - val_accuracy10: 0.4634 - 9s/epoch - 17ms/step
Epoch 33/50
533/533 - 10s - loss: 2.4060 - accuracy10: 0.6063 - val_loss: 2.6991 - val_accuracy10: 0.4801 - 10s/epoch - 18ms/step
Epoch 34/50
533/533 - 10s - loss: 2.3972 - accuracy10: 0.6048 - val_loss: 2.6987 - val_accuracy10: 0.5043 - 10s/epoch - 18ms/step
testing model: results/QRTEA/W6/deepOF_L1/h10
Evaluating performance on  test set...
2185/2185 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0836611
{'0': {'precision': 0.2100891463640452, 'recall': 0.5934483067818394, 'f1-score': 0.3103204404346518, 'support': 66914}, '1': {'precision': 0.8687026430020804, 'recall': 0.39845055123713213, 'f1-score': 0.5463191799364857, 'support': 424409}, '2': {'precision': 0.23082796740555017, 'recall': 0.5970492431500287, 'f1-score': 0.33293744888775645, 'support': 67847}, 'accuracy': 0.44588228982241535, 'macro avg': {'precision': 0.43653991892389193, 'recall': 0.5296493670563334, 'f1-score': 0.3965256897529647, 'support': 559170}, 'weighted avg': {'precision': 0.7124919259943095, 'recall': 0.44588228982241535, 'f1-score': 0.4921872880941321, 'support': 559170}}
[[ 39710  13582  13622]
 [133943 169106 121360]
 [ 15362  11977  40508]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0452391
{'0': {'precision': 0.19975993721434837, 'recall': 0.6405625462620281, 'f1-score': 0.3045467342342343, 'support': 13510}, '1': {'precision': 0.9209725858616972, 'recall': 0.4377974229445787, 'f1-score': 0.5934770742358079, 'support': 109272}, '2': {'precision': 0.2171930252408243, 'recall': 0.660241678404626, 'f1-score': 0.32686167284471684, 'support': 13489}, 'accuracy': 0.4799186914310455, 'macro avg': {'precision': 0.4459751827722899, 'recall': 0.5795338825370776, 'f1-score': 0.408295160438253, 'support': 136271}, 'weighted avg': {'precision': 0.7798063408320091, 'recall': 0.4799186914310455, 'f1-score': 0.5384409767331426, 'support': 136271}}
[[ 8654  2124  2732]
 [32066 47839 29367]
 [ 2602  1981  8906]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.992403
{'0': {'precision': 0.20018307280664696, 'recall': 0.5965169953839697, 'f1-score': 0.29976803036693384, 'support': 4766}, '1': {'precision': 0.9211330849336008, 'recall': 0.49482922322872025, 'f1-score': 0.6438074887735172, 'support': 38969}, '2': {'precision': 0.21010332950631458, 'recall': 0.6146439767129422, 'f1-score': 0.31315954594717926, 'support': 4466}, 'accuracy': 0.5159851455363996, 'macro avg': {'precision': 0.4438064957488541, 'recall': 0.5686633984418773, 'f1-score': 0.41891168836254344, 'support': 48201}, 'weighted avg': {'precision': 0.7839677430208745, 'recall': 0.5159851455363996, 'f1-score': 0.5791539386100725, 'support': 48201}}
[[ 2843   847  1076]
 [10442 19283  9244]
 [  917   804  2745]]
training model: results/QRTEA/W6/deepOF_L1/h20
Epoch 1/50
533/533 - 12s - loss: 3.1074 - accuracy20: 0.4284 - val_loss: 2.9791 - val_accuracy20: 0.5454 - 12s/epoch - 22ms/step
Epoch 2/50
533/533 - 9s - loss: 3.0001 - accuracy20: 0.4395 - val_loss: 2.9469 - val_accuracy20: 0.5669 - 9s/epoch - 17ms/step
Epoch 3/50
533/533 - 9s - loss: 2.9531 - accuracy20: 0.4646 - val_loss: 2.9269 - val_accuracy20: 0.5794 - 9s/epoch - 17ms/step
Epoch 4/50
533/533 - 10s - loss: 2.9148 - accuracy20: 0.4807 - val_loss: 2.9230 - val_accuracy20: 0.6055 - 10s/epoch - 18ms/step
Epoch 5/50
533/533 - 9s - loss: 2.8858 - accuracy20: 0.4883 - val_loss: 2.9019 - val_accuracy20: 0.6032 - 9s/epoch - 18ms/step
Epoch 6/50
533/533 - 10s - loss: 2.8606 - accuracy20: 0.4997 - val_loss: 2.8791 - val_accuracy20: 0.5896 - 10s/epoch - 19ms/step
Epoch 7/50
533/533 - 10s - loss: 2.8348 - accuracy20: 0.5049 - val_loss: 2.8606 - val_accuracy20: 0.5952 - 10s/epoch - 19ms/step
Epoch 8/50
533/533 - 9s - loss: 2.8122 - accuracy20: 0.5125 - val_loss: 2.8561 - val_accuracy20: 0.5976 - 9s/epoch - 18ms/step
Epoch 9/50
533/533 - 9s - loss: 2.7973 - accuracy20: 0.5191 - val_loss: 2.8609 - val_accuracy20: 0.5862 - 9s/epoch - 17ms/step
Epoch 10/50
533/533 - 10s - loss: 2.7774 - accuracy20: 0.5264 - val_loss: 2.8438 - val_accuracy20: 0.5770 - 10s/epoch - 18ms/step
Epoch 11/50
533/533 - 10s - loss: 2.7642 - accuracy20: 0.5277 - val_loss: 2.8220 - val_accuracy20: 0.5537 - 10s/epoch - 19ms/step
Epoch 12/50
533/533 - 10s - loss: 2.7427 - accuracy20: 0.5353 - val_loss: 2.8223 - val_accuracy20: 0.5491 - 10s/epoch - 18ms/step
Epoch 13/50
533/533 - 9s - loss: 2.7291 - accuracy20: 0.5410 - val_loss: 2.8132 - val_accuracy20: 0.5600 - 9s/epoch - 18ms/step
Epoch 14/50
533/533 - 10s - loss: 2.7162 - accuracy20: 0.5436 - val_loss: 2.8096 - val_accuracy20: 0.5298 - 10s/epoch - 18ms/step
Epoch 15/50
533/533 - 8s - loss: 2.6970 - accuracy20: 0.5499 - val_loss: 2.7921 - val_accuracy20: 0.5447 - 8s/epoch - 16ms/step
Epoch 16/50
533/533 - 9s - loss: 2.6835 - accuracy20: 0.5518 - val_loss: 2.7745 - val_accuracy20: 0.5501 - 9s/epoch - 18ms/step
Epoch 17/50
533/533 - 10s - loss: 2.6701 - accuracy20: 0.5571 - val_loss: 2.7591 - val_accuracy20: 0.5269 - 10s/epoch - 19ms/step
Epoch 18/50
533/533 - 10s - loss: 2.6546 - accuracy20: 0.5618 - val_loss: 2.7593 - val_accuracy20: 0.5429 - 10s/epoch - 18ms/step
Epoch 19/50
533/533 - 9s - loss: 2.6426 - accuracy20: 0.5644 - val_loss: 2.7450 - val_accuracy20: 0.5221 - 9s/epoch - 18ms/step
Epoch 20/50
533/533 - 9s - loss: 2.6250 - accuracy20: 0.5648 - val_loss: 2.7285 - val_accuracy20: 0.5235 - 9s/epoch - 17ms/step
Epoch 21/50
533/533 - 9s - loss: 2.6151 - accuracy20: 0.5708 - val_loss: 2.7353 - val_accuracy20: 0.5098 - 9s/epoch - 18ms/step
Epoch 22/50
533/533 - 10s - loss: 2.6014 - accuracy20: 0.5709 - val_loss: 2.7287 - val_accuracy20: 0.5255 - 10s/epoch - 18ms/step
Epoch 23/50
533/533 - 10s - loss: 2.5878 - accuracy20: 0.5735 - val_loss: 2.7248 - val_accuracy20: 0.5184 - 10s/epoch - 19ms/step
Epoch 24/50
533/533 - 10s - loss: 2.5774 - accuracy20: 0.5754 - val_loss: 2.7084 - val_accuracy20: 0.5206 - 10s/epoch - 18ms/step
Epoch 25/50
533/533 - 10s - loss: 2.5674 - accuracy20: 0.5774 - val_loss: 2.7344 - val_accuracy20: 0.4903 - 10s/epoch - 19ms/step
Epoch 26/50
533/533 - 10s - loss: 2.5584 - accuracy20: 0.5789 - val_loss: 2.7626 - val_accuracy20: 0.5064 - 10s/epoch - 19ms/step
Epoch 27/50
533/533 - 9s - loss: 2.5469 - accuracy20: 0.5801 - val_loss: 2.7273 - val_accuracy20: 0.5080 - 9s/epoch - 17ms/step
Epoch 28/50
533/533 - 9s - loss: 2.5348 - accuracy20: 0.5831 - val_loss: 2.7320 - val_accuracy20: 0.4954 - 9s/epoch - 17ms/step
Epoch 29/50
533/533 - 9s - loss: 2.5238 - accuracy20: 0.5853 - val_loss: 2.7304 - val_accuracy20: 0.5209 - 9s/epoch - 17ms/step
Epoch 30/50
533/533 - 9s - loss: 2.5176 - accuracy20: 0.5860 - val_loss: 2.7347 - val_accuracy20: 0.4987 - 9s/epoch - 17ms/step
Epoch 31/50
533/533 - 10s - loss: 2.5020 - accuracy20: 0.5888 - val_loss: 2.7506 - val_accuracy20: 0.4822 - 10s/epoch - 18ms/step
Epoch 32/50
533/533 - 10s - loss: 2.4954 - accuracy20: 0.5887 - val_loss: 2.7461 - val_accuracy20: 0.4952 - 10s/epoch - 18ms/step
Epoch 33/50
533/533 - 10s - loss: 2.4846 - accuracy20: 0.5913 - val_loss: 2.7473 - val_accuracy20: 0.5185 - 10s/epoch - 18ms/step
Epoch 34/50
533/533 - 10s - loss: 2.4776 - accuracy20: 0.5912 - val_loss: 2.7397 - val_accuracy20: 0.5232 - 10s/epoch - 18ms/step
testing model: results/QRTEA/W6/deepOF_L1/h20
Evaluating performance on  test set...
2185/2185 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0818025
{'0': {'precision': 0.2674294142651555, 'recall': 0.5818939579665248, 'f1-score': 0.36644596258907985, 'support': 89738}, '1': {'precision': 0.814608602190853, 'recall': 0.3441293088428622, 'f1-score': 0.48385522313549595, 'support': 378814}, '2': {'precision': 0.28219754563914423, 'recall': 0.6349180074598866, 'f1-score': 0.3907300509337861, 'support': 90618}, 'accuracy': 0.42941144911207685, 'macro avg': {'precision': 0.4547451873650508, 'recall': 0.5203137580897579, 'f1-score': 0.4136770788861206, 'support': 559170}, 'weighted avg': {'precision': 0.6405134413476765, 'recall': 0.42941144911207685, 'f1-score': 0.4499211975663688, 'support': 559170}}
[[ 52218  15776  21744]
 [123850 130361 124603]
 [ 19191  13892  57535]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0182289
{'0': {'precision': 0.26828400682982356, 'recall': 0.6227225188528651, 'f1-score': 0.37500621529791994, 'support': 18167}, '1': {'precision': 0.8842809640843471, 'recall': 0.42818997329813085, 'f1-score': 0.5769883836886505, 'support': 99993}, '2': {'precision': 0.26775238595569567, 'recall': 0.6753906465683839, 'f1-score': 0.3834783290226507, 'support': 18111}, 'accuracy': 0.48697815382583237, 'macro avg': {'precision': 0.4734391189566221, 'recall': 0.5754343795731266, 'f1-score': 0.44515764266974034, 'support': 136271}, 'weighted avg': {'precision': 0.7202198960586415, 'recall': 0.48697815382583237, 'f1-score': 0.5243427683103944, 'support': 136271}}
[[11313  3065  3789]
 [27514 42816 29663]
 [ 3341  2538 12232]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97748667
{'0': {'precision': 0.269549805033676, 'recall': 0.5970477386934674, 'f1-score': 0.37141601133199825, 'support': 6368}, '1': {'precision': 0.8819409452786455, 'recall': 0.4893480205770521, 'f1-score': 0.62944582299421, 'support': 35768}, '2': {'precision': 0.2658245614035088, 'recall': 0.6245671887881286, 'f1-score': 0.37292640905734675, 'support': 6065}, 'accuracy': 0.5205908591108068, 'macro avg': {'precision': 0.4724384372386101, 'recall': 0.570320982686216, 'f1-score': 0.457929414461185, 'support': 48201}, 'weighted avg': {'precision': 0.7235116046159483, 'recall': 0.5205908591108068, 'f1-score': 0.5630794802587473, 'support': 48201}}
[[ 3802  1265  1301]
 [ 9104 17503  9161]
 [ 1199  1078  3788]]
training model: results/QRTEA/W6/deepOF_L1/h30
Epoch 1/50
533/533 - 11s - loss: 3.1386 - accuracy30: 0.4096 - val_loss: 3.0253 - val_accuracy30: 0.5095 - 11s/epoch - 20ms/step
Epoch 2/50
533/533 - 9s - loss: 3.0319 - accuracy30: 0.4287 - val_loss: 2.9809 - val_accuracy30: 0.5340 - 9s/epoch - 18ms/step
Epoch 3/50
533/533 - 10s - loss: 2.9946 - accuracy30: 0.4430 - val_loss: 2.9525 - val_accuracy30: 0.5403 - 10s/epoch - 18ms/step
Epoch 4/50
533/533 - 10s - loss: 2.9603 - accuracy30: 0.4553 - val_loss: 2.9168 - val_accuracy30: 0.5438 - 10s/epoch - 18ms/step
Epoch 5/50
533/533 - 9s - loss: 2.9356 - accuracy30: 0.4621 - val_loss: 2.9111 - val_accuracy30: 0.5717 - 9s/epoch - 17ms/step
Epoch 6/50
533/533 - 10s - loss: 2.9092 - accuracy30: 0.4720 - val_loss: 2.8985 - val_accuracy30: 0.5741 - 10s/epoch - 18ms/step
Epoch 7/50
533/533 - 9s - loss: 2.8867 - accuracy30: 0.4825 - val_loss: 2.8905 - val_accuracy30: 0.5871 - 9s/epoch - 16ms/step
Epoch 8/50
533/533 - 9s - loss: 2.8656 - accuracy30: 0.4936 - val_loss: 2.8691 - val_accuracy30: 0.5848 - 9s/epoch - 17ms/step
Epoch 9/50
533/533 - 10s - loss: 2.8485 - accuracy30: 0.5009 - val_loss: 2.8532 - val_accuracy30: 0.5870 - 10s/epoch - 19ms/step
Epoch 10/50
533/533 - 10s - loss: 2.8367 - accuracy30: 0.5029 - val_loss: 2.8417 - val_accuracy30: 0.5761 - 10s/epoch - 19ms/step
Epoch 11/50
533/533 - 9s - loss: 2.8189 - accuracy30: 0.5086 - val_loss: 2.8453 - val_accuracy30: 0.5720 - 9s/epoch - 18ms/step
Epoch 12/50
533/533 - 10s - loss: 2.8052 - accuracy30: 0.5115 - val_loss: 2.8356 - val_accuracy30: 0.5627 - 10s/epoch - 18ms/step
Epoch 13/50
533/533 - 10s - loss: 2.7905 - accuracy30: 0.5177 - val_loss: 2.8379 - val_accuracy30: 0.5284 - 10s/epoch - 18ms/step
Epoch 14/50
533/533 - 10s - loss: 2.7746 - accuracy30: 0.5215 - val_loss: 2.8408 - val_accuracy30: 0.5113 - 10s/epoch - 18ms/step
Epoch 15/50
533/533 - 9s - loss: 2.7622 - accuracy30: 0.5249 - val_loss: 2.8184 - val_accuracy30: 0.5302 - 9s/epoch - 17ms/step
Epoch 16/50
533/533 - 9s - loss: 2.7500 - accuracy30: 0.5289 - val_loss: 2.7950 - val_accuracy30: 0.5341 - 9s/epoch - 17ms/step
Epoch 17/50
533/533 - 9s - loss: 2.7333 - accuracy30: 0.5334 - val_loss: 2.7938 - val_accuracy30: 0.5180 - 9s/epoch - 17ms/step
Epoch 18/50
533/533 - 9s - loss: 2.7208 - accuracy30: 0.5340 - val_loss: 2.7948 - val_accuracy30: 0.5035 - 9s/epoch - 16ms/step
Epoch 19/50
533/533 - 9s - loss: 2.7065 - accuracy30: 0.5418 - val_loss: 2.7955 - val_accuracy30: 0.5179 - 9s/epoch - 18ms/step
Epoch 20/50
533/533 - 10s - loss: 2.6987 - accuracy30: 0.5411 - val_loss: 2.7952 - val_accuracy30: 0.5168 - 10s/epoch - 18ms/step
Epoch 21/50
533/533 - 9s - loss: 2.6867 - accuracy30: 0.5454 - val_loss: 2.7879 - val_accuracy30: 0.5001 - 9s/epoch - 18ms/step
Epoch 22/50
533/533 - 10s - loss: 2.6683 - accuracy30: 0.5515 - val_loss: 2.8074 - val_accuracy30: 0.4953 - 10s/epoch - 18ms/step
Epoch 23/50
533/533 - 10s - loss: 2.6534 - accuracy30: 0.5554 - val_loss: 2.8028 - val_accuracy30: 0.4925 - 10s/epoch - 18ms/step
Epoch 24/50
533/533 - 10s - loss: 2.6420 - accuracy30: 0.5544 - val_loss: 2.8145 - val_accuracy30: 0.4777 - 10s/epoch - 18ms/step
Epoch 25/50
533/533 - 10s - loss: 2.6309 - accuracy30: 0.5568 - val_loss: 2.8283 - val_accuracy30: 0.4868 - 10s/epoch - 18ms/step
Epoch 26/50
533/533 - 9s - loss: 2.6175 - accuracy30: 0.5610 - val_loss: 2.8040 - val_accuracy30: 0.4781 - 9s/epoch - 17ms/step
Epoch 27/50
533/533 - 9s - loss: 2.6077 - accuracy30: 0.5640 - val_loss: 2.8016 - val_accuracy30: 0.4730 - 9s/epoch - 17ms/step
Epoch 28/50
533/533 - 9s - loss: 2.5997 - accuracy30: 0.5643 - val_loss: 2.8320 - val_accuracy30: 0.4648 - 9s/epoch - 17ms/step
Epoch 29/50
533/533 - 10s - loss: 2.5871 - accuracy30: 0.5658 - val_loss: 2.8391 - val_accuracy30: 0.4683 - 10s/epoch - 18ms/step
Epoch 30/50
533/533 - 9s - loss: 2.5783 - accuracy30: 0.5681 - val_loss: 2.8440 - val_accuracy30: 0.4672 - 9s/epoch - 17ms/step
Epoch 31/50
533/533 - 10s - loss: 2.5663 - accuracy30: 0.5697 - val_loss: 2.8494 - val_accuracy30: 0.4425 - 10s/epoch - 18ms/step
testing model: results/QRTEA/W6/deepOF_L1/h30
Evaluating performance on  test set...
2185/2185 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0449339
{'0': {'precision': 0.307580159470693, 'recall': 0.5396428239233559, 'f1-score': 0.39182937453990424, 'support': 107510}, '1': {'precision': 0.7434726688102894, 'recall': 0.37058482412148164, 'f1-score': 0.4946238232016694, 'support': 343163}, '2': {'precision': 0.31886854874283194, 'recall': 0.5863111422435643, 'f1-score': 0.4130808167718097, 'support': 108497}, 'accuracy': 0.44494697498077507, 'macro avg': {'precision': 0.4566404590079381, 'recall': 0.4988462634294673, 'f1-score': 0.43317800483779445, 'support': 559170}, 'weighted avg': {'precision': 0.577277992962052, 'recall': 0.44494697498077507, 'f1-score': 0.4590378605351335, 'support': 559170}}
[[ 58017  23888  25605]
 [105714 127171 110278]
 [ 24893  19991  63613]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99197304
{'0': {'precision': 0.3067291899740544, 'recall': 0.591019584460854, 'f1-score': 0.4038612216754944, 'support': 21803}, '1': {'precision': 0.8292118730808598, 'recall': 0.4366342930441625, 'f1-score': 0.5720479307447343, 'support': 92771}, '2': {'precision': 0.29590398590618805, 'recall': 0.6193022076784809, 'f1-score': 0.4004649291430104, 'support': 21697}, 'accuracy': 0.4904198252012534, 'macro avg': {'precision': 0.47728168298703405, 'recall': 0.5489853617278325, 'f1-score': 0.45879136052107966, 'support': 136271}, 'weighted avg': {'precision': 0.6607030108298559, 'recall': 0.4904198252012534, 'f1-score': 0.5178191424949288, 'support': 136271}}
[[12886  4636  4281]
 [24572 40507 27692]
 [ 4553  3707 13437]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97117895
{'0': {'precision': 0.3058058058058058, 'recall': 0.5559599636032757, 'f1-score': 0.3945753955440749, 'support': 7693}, '1': {'precision': 0.8261308669537022, 'recall': 0.467794365518902, 'f1-score': 0.5973441973980053, 'support': 33224}, '2': {'precision': 0.2814569536423841, 'recall': 0.5951400329489291, 'f1-score': 0.3821740280349114, 'support': 7284}, 'accuracy': 0.501109935478517, 'macro avg': {'precision': 0.4711312088006307, 'recall': 0.5396314540237023, 'f1-score': 0.45803120699233046, 'support': 48201}, 'weighted avg': {'precision': 0.6607760925720418, 'recall': 0.501109935478517, 'f1-score': 0.5324658773153709, 'support': 48201}}
[[ 4277  1807  1609]
 [ 8224 15542  9458]
 [ 1485  1464  4335]]
training model: results/QRTEA/W6/deepOF_L1/h50
Epoch 1/50
533/533 - 12s - loss: 3.1873 - accuracy50: 0.4032 - val_loss: 3.0855 - val_accuracy50: 0.4807 - 12s/epoch - 22ms/step
Epoch 2/50
533/533 - 9s - loss: 3.0945 - accuracy50: 0.4183 - val_loss: 3.0501 - val_accuracy50: 0.4954 - 9s/epoch - 18ms/step
Epoch 3/50
533/533 - 10s - loss: 3.0567 - accuracy50: 0.4352 - val_loss: 3.0373 - val_accuracy50: 0.4887 - 10s/epoch - 19ms/step
Epoch 4/50
533/533 - 10s - loss: 3.0324 - accuracy50: 0.4479 - val_loss: 3.0134 - val_accuracy50: 0.4929 - 10s/epoch - 18ms/step
Epoch 5/50
533/533 - 10s - loss: 3.0027 - accuracy50: 0.4578 - val_loss: 3.0082 - val_accuracy50: 0.5009 - 10s/epoch - 18ms/step
Epoch 6/50
533/533 - 10s - loss: 2.9825 - accuracy50: 0.4692 - val_loss: 2.9798 - val_accuracy50: 0.4996 - 10s/epoch - 18ms/step
Epoch 7/50
533/533 - 10s - loss: 2.9603 - accuracy50: 0.4751 - val_loss: 2.9645 - val_accuracy50: 0.5007 - 10s/epoch - 19ms/step
Epoch 8/50
533/533 - 10s - loss: 2.9422 - accuracy50: 0.4814 - val_loss: 2.9666 - val_accuracy50: 0.4798 - 10s/epoch - 19ms/step
Epoch 9/50
533/533 - 10s - loss: 2.9301 - accuracy50: 0.4816 - val_loss: 2.9522 - val_accuracy50: 0.4842 - 10s/epoch - 18ms/step
Epoch 10/50
533/533 - 9s - loss: 2.9143 - accuracy50: 0.4865 - val_loss: 2.9452 - val_accuracy50: 0.4977 - 9s/epoch - 16ms/step
Epoch 11/50
533/533 - 9s - loss: 2.8985 - accuracy50: 0.4923 - val_loss: 2.9563 - val_accuracy50: 0.4743 - 9s/epoch - 17ms/step
Epoch 12/50
533/533 - 9s - loss: 2.8869 - accuracy50: 0.4974 - val_loss: 2.9322 - val_accuracy50: 0.4815 - 9s/epoch - 17ms/step
Epoch 13/50
533/533 - 10s - loss: 2.8730 - accuracy50: 0.4999 - val_loss: 2.9278 - val_accuracy50: 0.4679 - 10s/epoch - 19ms/step
Epoch 14/50
533/533 - 10s - loss: 2.8614 - accuracy50: 0.5047 - val_loss: 2.9193 - val_accuracy50: 0.4749 - 10s/epoch - 18ms/step
Epoch 15/50
533/533 - 10s - loss: 2.8504 - accuracy50: 0.5098 - val_loss: 2.9203 - val_accuracy50: 0.4881 - 10s/epoch - 19ms/step
Epoch 16/50
533/533 - 10s - loss: 2.8407 - accuracy50: 0.5102 - val_loss: 2.9293 - val_accuracy50: 0.4617 - 10s/epoch - 18ms/step
Epoch 17/50
533/533 - 10s - loss: 2.8285 - accuracy50: 0.5149 - val_loss: 2.9093 - val_accuracy50: 0.4794 - 10s/epoch - 18ms/step
Epoch 18/50
533/533 - 10s - loss: 2.8183 - accuracy50: 0.5155 - val_loss: 2.9186 - val_accuracy50: 0.4523 - 10s/epoch - 18ms/step
Epoch 19/50
533/533 - 10s - loss: 2.8061 - accuracy50: 0.5187 - val_loss: 2.9168 - val_accuracy50: 0.4554 - 10s/epoch - 18ms/step
Epoch 20/50
533/533 - 10s - loss: 2.7949 - accuracy50: 0.5214 - val_loss: 2.9026 - val_accuracy50: 0.4526 - 10s/epoch - 19ms/step
Epoch 21/50
533/533 - 9s - loss: 2.7825 - accuracy50: 0.5250 - val_loss: 2.9029 - val_accuracy50: 0.4671 - 9s/epoch - 17ms/step
Epoch 22/50
533/533 - 9s - loss: 2.7687 - accuracy50: 0.5290 - val_loss: 2.9177 - val_accuracy50: 0.4423 - 9s/epoch - 17ms/step
Epoch 23/50
533/533 - 9s - loss: 2.7552 - accuracy50: 0.5300 - val_loss: 2.9142 - val_accuracy50: 0.4524 - 9s/epoch - 17ms/step
Epoch 24/50
533/533 - 10s - loss: 2.7475 - accuracy50: 0.5327 - val_loss: 2.9194 - val_accuracy50: 0.4477 - 10s/epoch - 18ms/step
Epoch 25/50
533/533 - 10s - loss: 2.7356 - accuracy50: 0.5353 - val_loss: 2.9132 - val_accuracy50: 0.4320 - 10s/epoch - 19ms/step
Epoch 26/50
533/533 - 9s - loss: 2.7263 - accuracy50: 0.5374 - val_loss: 2.9042 - val_accuracy50: 0.4652 - 9s/epoch - 18ms/step
Epoch 27/50
533/533 - 9s - loss: 2.7149 - accuracy50: 0.5391 - val_loss: 2.9188 - val_accuracy50: 0.4442 - 9s/epoch - 17ms/step
Epoch 28/50
533/533 - 10s - loss: 2.7061 - accuracy50: 0.5432 - val_loss: 2.9139 - val_accuracy50: 0.4539 - 10s/epoch - 18ms/step
Epoch 29/50
533/533 - 9s - loss: 2.6950 - accuracy50: 0.5453 - val_loss: 2.9253 - val_accuracy50: 0.4479 - 9s/epoch - 17ms/step
Epoch 30/50
533/533 - 10s - loss: 2.6847 - accuracy50: 0.5468 - val_loss: 2.9455 - val_accuracy50: 0.4665 - 10s/epoch - 18ms/step
testing model: results/QRTEA/W6/deepOF_L1/h50
Evaluating performance on  test set...
2185/2185 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0710598
{'0': {'precision': 0.3458579281476827, 'recall': 0.5173138547841596, 'f1-score': 0.4145573373819803, 'support': 135123}, '1': {'precision': 0.6450048413494083, 'recall': 0.2624781192682944, 'f1-score': 0.3731191989788964, 'support': 286782}, '2': {'precision': 0.35218715416170876, 'recall': 0.6166976286744618, 'f1-score': 0.44833603885356554, 'support': 137265}, 'accuracy': 0.4110127510417226, 'macro avg': {'precision': 0.4476833078862666, 'recall': 0.46549653424230525, 'f1-score': 0.4120041917381474, 'support': 559170}, 'weighted avg': {'precision': 0.5008353612550249, 'recall': 0.4110127510417226, 'f1-score': 0.40159691613259985, 'support': 559170}}
[[ 69901  22834  42388]
 [ 98189  75274 113319]
 [ 34019  18595  84651]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.033717
{'0': {'precision': 0.3381627952035478, 'recall': 0.5646094676683081, 'f1-score': 0.4229857819905213, 'support': 27821}, '1': {'precision': 0.7552441540577717, 'recall': 0.3252900518390521, 'f1-score': 0.45472583595017085, 'support': 81020}, '2': {'precision': 0.32490350302235815, 'recall': 0.6505650747356908, 'f1-score': 0.43337299949000657, 'support': 27430}, 'accuracy': 0.43962398456017787, 'macro avg': {'precision': 0.47277015076122586, 'recall': 0.513488198081017, 'f1-score': 0.4370282058102329, 'support': 136271}, 'weighted avg': {'precision': 0.5834697886932791, 'recall': 0.43962398456017787, 'f1-score': 0.44394769279928975, 'support': 136271}}
[[15708  4905  7208]
 [24794 26355 29871]
 [ 5949  3636 17845]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0127465
{'0': {'precision': 0.34843299107442455, 'recall': 0.5265186086603793, 'f1-score': 0.41935223326064125, 'support': 9861}, '1': {'precision': 0.758478139013453, 'recall': 0.3720059108560432, 'f1-score': 0.4991814807129188, 'support': 29099}, '2': {'precision': 0.30591759512297667, 'recall': 0.6299101828806406, 'f1-score': 0.4118292122112562, 'support': 9241}, 'accuracy': 0.4530611398103774, 'macro avg': {'precision': 0.4709429084036181, 'recall': 0.5094782341323544, 'f1-score': 0.4434543087282721, 'support': 48201}, 'weighted avg': {'precision': 0.5878267585458558, 'recall': 0.4530611398103774, 'f1-score': 0.46610294453419276, 'support': 48201}}
[[ 5192  2015  2654]
 [ 7721 10825 10553]
 [ 1988  1432  5821]]
training model: results/QRTEA/W6/deepOF_L1/h100
Epoch 1/50
533/533 - 12s - loss: 3.2573 - accuracy100: 0.3912 - val_loss: 3.1769 - val_accuracy100: 0.3956 - 12s/epoch - 22ms/step
Epoch 2/50
533/533 - 10s - loss: 3.1914 - accuracy100: 0.4158 - val_loss: 3.1548 - val_accuracy100: 0.4372 - 10s/epoch - 18ms/step
Epoch 3/50
533/533 - 9s - loss: 3.1663 - accuracy100: 0.4239 - val_loss: 3.1455 - val_accuracy100: 0.4438 - 9s/epoch - 18ms/step
Epoch 4/50
533/533 - 10s - loss: 3.1479 - accuracy100: 0.4304 - val_loss: 3.1353 - val_accuracy100: 0.4451 - 10s/epoch - 18ms/step
Epoch 5/50
533/533 - 10s - loss: 3.1306 - accuracy100: 0.4385 - val_loss: 3.1264 - val_accuracy100: 0.4448 - 10s/epoch - 19ms/step
Epoch 6/50
533/533 - 10s - loss: 3.1142 - accuracy100: 0.4449 - val_loss: 3.1216 - val_accuracy100: 0.4337 - 10s/epoch - 18ms/step
Epoch 7/50
533/533 - 10s - loss: 3.0992 - accuracy100: 0.4510 - val_loss: 3.1141 - val_accuracy100: 0.4336 - 10s/epoch - 18ms/step
Epoch 8/50
533/533 - 10s - loss: 3.0863 - accuracy100: 0.4552 - val_loss: 3.1056 - val_accuracy100: 0.4312 - 10s/epoch - 18ms/step
Epoch 9/50
533/533 - 9s - loss: 3.0724 - accuracy100: 0.4607 - val_loss: 3.0999 - val_accuracy100: 0.4333 - 9s/epoch - 17ms/step
Epoch 10/50
533/533 - 9s - loss: 3.0616 - accuracy100: 0.4648 - val_loss: 3.0921 - val_accuracy100: 0.4297 - 9s/epoch - 16ms/step
Epoch 11/50
533/533 - 9s - loss: 3.0517 - accuracy100: 0.4680 - val_loss: 3.0875 - val_accuracy100: 0.4338 - 9s/epoch - 17ms/step
Epoch 12/50
533/533 - 9s - loss: 3.0425 - accuracy100: 0.4713 - val_loss: 3.0750 - val_accuracy100: 0.4375 - 9s/epoch - 17ms/step
Epoch 13/50
533/533 - 10s - loss: 3.0352 - accuracy100: 0.4732 - val_loss: 3.0766 - val_accuracy100: 0.4332 - 10s/epoch - 18ms/step
Epoch 14/50
533/533 - 10s - loss: 3.0280 - accuracy100: 0.4763 - val_loss: 3.0644 - val_accuracy100: 0.4325 - 10s/epoch - 18ms/step
Epoch 15/50
533/533 - 9s - loss: 3.0194 - accuracy100: 0.4783 - val_loss: 3.0635 - val_accuracy100: 0.4383 - 9s/epoch - 18ms/step
Epoch 16/50
533/533 - 10s - loss: 3.0094 - accuracy100: 0.4816 - val_loss: 3.0518 - val_accuracy100: 0.4585 - 10s/epoch - 18ms/step
Epoch 17/50
533/533 - 10s - loss: 3.0051 - accuracy100: 0.4827 - val_loss: 3.0488 - val_accuracy100: 0.4552 - 10s/epoch - 18ms/step
Epoch 18/50
533/533 - 9s - loss: 2.9958 - accuracy100: 0.4854 - val_loss: 3.0460 - val_accuracy100: 0.4603 - 9s/epoch - 18ms/step
Epoch 19/50
533/533 - 9s - loss: 2.9879 - accuracy100: 0.4871 - val_loss: 3.0457 - val_accuracy100: 0.4607 - 9s/epoch - 17ms/step
Epoch 20/50
533/533 - 10s - loss: 2.9797 - accuracy100: 0.4887 - val_loss: 3.0368 - val_accuracy100: 0.4659 - 10s/epoch - 18ms/step
Epoch 21/50
533/533 - 9s - loss: 2.9738 - accuracy100: 0.4907 - val_loss: 3.0307 - val_accuracy100: 0.4606 - 9s/epoch - 18ms/step
Epoch 22/50
533/533 - 9s - loss: 2.9645 - accuracy100: 0.4943 - val_loss: 3.0336 - val_accuracy100: 0.4686 - 9s/epoch - 18ms/step
Epoch 23/50
533/533 - 9s - loss: 2.9575 - accuracy100: 0.4962 - val_loss: 3.0310 - val_accuracy100: 0.4675 - 9s/epoch - 16ms/step
Epoch 24/50
533/533 - 9s - loss: 2.9491 - accuracy100: 0.4967 - val_loss: 3.0274 - val_accuracy100: 0.4684 - 9s/epoch - 18ms/step
Epoch 25/50
533/533 - 9s - loss: 2.9390 - accuracy100: 0.5007 - val_loss: 3.0317 - val_accuracy100: 0.4646 - 9s/epoch - 18ms/step
Epoch 26/50
533/533 - 10s - loss: 2.9326 - accuracy100: 0.5021 - val_loss: 3.0339 - val_accuracy100: 0.4694 - 10s/epoch - 18ms/step
Epoch 27/50
533/533 - 9s - loss: 2.9239 - accuracy100: 0.5021 - val_loss: 3.0367 - val_accuracy100: 0.4635 - 9s/epoch - 18ms/step
Epoch 28/50
533/533 - 9s - loss: 2.9159 - accuracy100: 0.5073 - val_loss: 3.0425 - val_accuracy100: 0.4587 - 9s/epoch - 17ms/step
Epoch 29/50
533/533 - 9s - loss: 2.9054 - accuracy100: 0.5078 - val_loss: 3.0438 - val_accuracy100: 0.4518 - 9s/epoch - 16ms/step
Epoch 30/50
533/533 - 9s - loss: 2.8987 - accuracy100: 0.5112 - val_loss: 3.0447 - val_accuracy100: 0.4581 - 9s/epoch - 17ms/step
Epoch 31/50
533/533 - 9s - loss: 2.8897 - accuracy100: 0.5126 - val_loss: 3.0431 - val_accuracy100: 0.4498 - 9s/epoch - 16ms/step
Epoch 32/50
533/533 - 9s - loss: 2.8799 - accuracy100: 0.5150 - val_loss: 3.0586 - val_accuracy100: 0.4545 - 9s/epoch - 18ms/step
Epoch 33/50
533/533 - 10s - loss: 2.8707 - accuracy100: 0.5175 - val_loss: 3.0722 - val_accuracy100: 0.4465 - 10s/epoch - 19ms/step
Epoch 34/50
533/533 - 10s - loss: 2.8584 - accuracy100: 0.5208 - val_loss: 3.0725 - val_accuracy100: 0.4502 - 10s/epoch - 18ms/step
testing model: results/QRTEA/W6/deepOF_L1/h100
Evaluating performance on  test set...
2185/2185 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0677185
{'0': {'precision': 0.4224197499842955, 'recall': 0.38303362402383245, 'f1-score': 0.40176370952564455, 'support': 175559}, '1': {'precision': 0.4236033557595402, 'recall': 0.30597418694788203, 'f1-score': 0.3553061457619374, 'support': 203308}, '2': {'precision': 0.4057354381972757, 'recall': 0.5696133730442644, 'f1-score': 0.4739070347990799, 'support': 180303}, 'accuracy': 0.41517785288910347, 'macro avg': {'precision': 0.4172528479803705, 'recall': 0.41954039467199294, 'f1-score': 0.4103256300288873, 'support': 559170}, 'weighted avg': {'precision': 0.41747028033252315, 'recall': 0.41517785288910347, 'f1-score': 0.4081346943837458, 'support': 559170}}
[[ 67245  44455  63859]
 [ 54535  62207  86566]
 [ 37410  40190 102703]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0285248
{'0': {'precision': 0.4287941787941788, 'recall': 0.43413055489778196, 'f1-score': 0.4314458666178566, 'support': 38007}, '1': {'precision': 0.5677557714141541, 'recall': 0.36658195679796696, 'f1-score': 0.4455113293275656, 'support': 61386}, '2': {'precision': 0.3942327532842699, 'recall': 0.621698573675362, 'f1-score': 0.4825009996422332, 'support': 36878}, 'accuracy': 0.45446206456252614, 'macro avg': {'precision': 0.4635942344975343, 'recall': 0.474137028457037, 'f1-score': 0.45315273186255184, 'support': 136271}, 'weighted avg': {'precision': 0.48203911039822794, 'recall': 0.45446206456252614, 'f1-score': 0.45159860410104197, 'support': 136271}}
[[16500  9739 11768]
 [15422 22503 23461]
 [ 6558  7393 22927]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.02033
{'0': {'precision': 0.4398638719158481, 'recall': 0.42570551688000596, 'f1-score': 0.43266889835666467, 'support': 13359}, '1': {'precision': 0.593518908194553, 'recall': 0.4388725882457544, 'f1-score': 0.5046131827127048, 'support': 22494}, '2': {'precision': 0.37915124201942163, 'recall': 0.572319403952057, 'f1-score': 0.45612676283602804, 'support': 12348}, 'accuracy': 0.4694093483537686, 'macro avg': {'precision': 0.4708446740432743, 'recall': 0.4789658363592724, 'f1-score': 0.46446961463513253, 'support': 48201}, 'weighted avg': {'precision': 0.4960169980354745, 'recall': 0.4694093483537686, 'f1-score': 0.4722525676352262, 'support': 48201}}
[[5687 3719 3953]
 [5003 9872 7619]
 [2239 3042 7067]]
training model: results/QRTEA/W6/deepOF_L1/h200
Epoch 1/50
533/533 - 12s - loss: 3.2956 - accuracy200: 0.3778 - val_loss: 3.2638 - val_accuracy200: 0.3787 - 12s/epoch - 22ms/step
Epoch 2/50
533/533 - 9s - loss: 3.2499 - accuracy200: 0.3990 - val_loss: 3.2444 - val_accuracy200: 0.3834 - 9s/epoch - 17ms/step
Epoch 3/50
533/533 - 9s - loss: 3.2305 - accuracy200: 0.4084 - val_loss: 3.2316 - val_accuracy200: 0.3879 - 9s/epoch - 17ms/step
Epoch 4/50
533/533 - 10s - loss: 3.2176 - accuracy200: 0.4140 - val_loss: 3.2215 - val_accuracy200: 0.3904 - 10s/epoch - 18ms/step
Epoch 5/50
533/533 - 10s - loss: 3.2066 - accuracy200: 0.4189 - val_loss: 3.2188 - val_accuracy200: 0.3909 - 10s/epoch - 18ms/step
Epoch 6/50
533/533 - 10s - loss: 3.1970 - accuracy200: 0.4218 - val_loss: 3.2119 - val_accuracy200: 0.3957 - 10s/epoch - 18ms/step
Epoch 7/50
533/533 - 9s - loss: 3.1888 - accuracy200: 0.4254 - val_loss: 3.2052 - val_accuracy200: 0.4010 - 9s/epoch - 17ms/step
Epoch 8/50
533/533 - 10s - loss: 3.1810 - accuracy200: 0.4279 - val_loss: 3.1995 - val_accuracy200: 0.4051 - 10s/epoch - 18ms/step
Epoch 9/50
533/533 - 10s - loss: 3.1727 - accuracy200: 0.4326 - val_loss: 3.1940 - val_accuracy200: 0.4081 - 10s/epoch - 18ms/step
Epoch 10/50
533/533 - 10s - loss: 3.1651 - accuracy200: 0.4359 - val_loss: 3.1883 - val_accuracy200: 0.4133 - 10s/epoch - 18ms/step
Epoch 11/50
533/533 - 9s - loss: 3.1586 - accuracy200: 0.4384 - val_loss: 3.1901 - val_accuracy200: 0.4097 - 9s/epoch - 18ms/step
Epoch 12/50
533/533 - 10s - loss: 3.1533 - accuracy200: 0.4420 - val_loss: 3.1836 - val_accuracy200: 0.4176 - 10s/epoch - 18ms/step
Epoch 13/50
533/533 - 10s - loss: 3.1464 - accuracy200: 0.4435 - val_loss: 3.1757 - val_accuracy200: 0.4265 - 10s/epoch - 19ms/step
Epoch 14/50
533/533 - 9s - loss: 3.1416 - accuracy200: 0.4460 - val_loss: 3.1764 - val_accuracy200: 0.4244 - 9s/epoch - 17ms/step
Epoch 15/50
533/533 - 9s - loss: 3.1350 - accuracy200: 0.4485 - val_loss: 3.1772 - val_accuracy200: 0.4249 - 9s/epoch - 17ms/step
Epoch 16/50
533/533 - 9s - loss: 3.1301 - accuracy200: 0.4505 - val_loss: 3.1671 - val_accuracy200: 0.4299 - 9s/epoch - 17ms/step
Epoch 17/50
533/533 - 9s - loss: 3.1252 - accuracy200: 0.4524 - val_loss: 3.1604 - val_accuracy200: 0.4317 - 9s/epoch - 18ms/step
Epoch 18/50
533/533 - 9s - loss: 3.1183 - accuracy200: 0.4544 - val_loss: 3.1637 - val_accuracy200: 0.4300 - 9s/epoch - 17ms/step
Epoch 19/50
533/533 - 10s - loss: 3.1139 - accuracy200: 0.4559 - val_loss: 3.1720 - val_accuracy200: 0.4273 - 10s/epoch - 18ms/step
Epoch 20/50
533/533 - 9s - loss: 3.1107 - accuracy200: 0.4565 - val_loss: 3.1706 - val_accuracy200: 0.4307 - 9s/epoch - 17ms/step
Epoch 21/50
533/533 - 9s - loss: 3.1071 - accuracy200: 0.4586 - val_loss: 3.1671 - val_accuracy200: 0.4324 - 9s/epoch - 17ms/step
Epoch 22/50
533/533 - 9s - loss: 3.1019 - accuracy200: 0.4604 - val_loss: 3.1625 - val_accuracy200: 0.4371 - 9s/epoch - 17ms/step
Epoch 23/50
533/533 - 9s - loss: 3.0969 - accuracy200: 0.4618 - val_loss: 3.1652 - val_accuracy200: 0.4362 - 9s/epoch - 17ms/step
Epoch 24/50
533/533 - 9s - loss: 3.0941 - accuracy200: 0.4627 - val_loss: 3.1624 - val_accuracy200: 0.4375 - 9s/epoch - 17ms/step
Epoch 25/50
533/533 - 9s - loss: 3.0854 - accuracy200: 0.4663 - val_loss: 3.1630 - val_accuracy200: 0.4368 - 9s/epoch - 17ms/step
Epoch 26/50
533/533 - 10s - loss: 3.0799 - accuracy200: 0.4674 - val_loss: 3.1728 - val_accuracy200: 0.4344 - 10s/epoch - 19ms/step
Epoch 27/50
533/533 - 8s - loss: 3.0746 - accuracy200: 0.4699 - val_loss: 3.1768 - val_accuracy200: 0.4327 - 8s/epoch - 16ms/step
testing model: results/QRTEA/W6/deepOF_L1/h200
Evaluating performance on  test set...
2185/2185 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0905786
{'0': {'precision': 0.42827395952147274, 'recall': 0.32204530834708806, 'f1-score': 0.36763981749508295, 'support': 200537}, '1': {'precision': 0.2855217008389858, 'recall': 0.4870779409051372, 'f1-score': 0.36000876680303917, 'support': 151756}, '2': {'precision': 0.45312729948491537, 'recall': 0.32743127558887647, 'f1-score': 0.38015865666574067, 'support': 206877}, 'accuracy': 0.368827011463419, 'macro avg': {'precision': 0.38897431994845794, 'recall': 0.37885150828036723, 'f1-score': 0.36926908032128763, 'support': 559170}, 'weighted avg': {'precision': 0.39872672458933694, 'recall': 0.368827011463419, 'f1-score': 0.37020040222295886, 'support': 559170}}
[[64582 93884 42071]
 [38158 73917 39681]
 [48056 91083 67738]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0571327
{'0': {'precision': 0.46421772754312907, 'recall': 0.3382824692214323, 'f1-score': 0.39136867445709417, 'support': 46136}, '1': {'precision': 0.3902587519025875, 'recall': 0.549601303266741, 'f1-score': 0.4564226716035317, 'support': 46652}, '2': {'precision': 0.45793077318611136, 'recall': 0.38914058367637927, 'f1-score': 0.4207424720889177, 'support': 43483}, 'accuracy': 0.42685531037418084, 'macro avg': {'precision': 0.4374690842106093, 'recall': 0.42567478538818415, 'f1-score': 0.42284460604984786, 'support': 136271}, 'weighted avg': {'precision': 0.436891959273367, 'recall': 0.42685531037418084, 'f1-score': 0.42301267734325626, 'support': 136271}}
[[15607 21719  8810]
 [ 9792 25640 11220]
 [ 8221 18341 16921]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0539628
{'0': {'precision': 0.47129165567572323, 'recall': 0.32174800408187765, 'f1-score': 0.38242009132420096, 'support': 16659}, '1': {'precision': 0.40353640767140553, 'recall': 0.6078059196868142, 'f1-score': 0.48504212818328135, 'support': 16859}, '2': {'precision': 0.4429383471797114, 'recall': 0.34495675270721243, 'f1-score': 0.38785511907496745, 'support': 14683}, 'accuracy': 0.42887077031596854, 'macro avg': {'precision': 0.43925547017561345, 'recall': 0.42483689215863474, 'f1-score': 0.41843911286081664, 'support': 48201}, 'weighted avg': {'precision': 0.438956281829709, 'recall': 0.42887077031596854, 'f1-score': 0.41996925901515636, 'support': 48201}}
[[ 5360  8320  2979]
 [ 3221 10247  3391]
 [ 2792  6826  5065]]
training model: results/QRTEA/W6/deepOF_L1/h300
Epoch 1/50
533/533 - 12s - loss: 3.3143 - accuracy300: 0.3594 - val_loss: 3.2806 - val_accuracy300: 0.3599 - 12s/epoch - 22ms/step
Epoch 2/50
533/533 - 9s - loss: 3.2793 - accuracy300: 0.3780 - val_loss: 3.2631 - val_accuracy300: 0.3684 - 9s/epoch - 17ms/step
Epoch 3/50
533/533 - 10s - loss: 3.2653 - accuracy300: 0.3823 - val_loss: 3.2533 - val_accuracy300: 0.3764 - 10s/epoch - 18ms/step
Epoch 4/50
533/533 - 9s - loss: 3.2553 - accuracy300: 0.3874 - val_loss: 3.2487 - val_accuracy300: 0.3741 - 9s/epoch - 17ms/step
Epoch 5/50
533/533 - 9s - loss: 3.2488 - accuracy300: 0.3909 - val_loss: 3.2461 - val_accuracy300: 0.3803 - 9s/epoch - 17ms/step
Epoch 6/50
533/533 - 9s - loss: 3.2443 - accuracy300: 0.3927 - val_loss: 3.2426 - val_accuracy300: 0.3812 - 9s/epoch - 18ms/step
Epoch 7/50
533/533 - 9s - loss: 3.2386 - accuracy300: 0.3972 - val_loss: 3.2402 - val_accuracy300: 0.3790 - 9s/epoch - 18ms/step
Epoch 8/50
533/533 - 10s - loss: 3.2354 - accuracy300: 0.3986 - val_loss: 3.2387 - val_accuracy300: 0.3840 - 10s/epoch - 18ms/step
Epoch 9/50
533/533 - 10s - loss: 3.2317 - accuracy300: 0.3998 - val_loss: 3.2361 - val_accuracy300: 0.3824 - 10s/epoch - 18ms/step
Epoch 10/50
533/533 - 10s - loss: 3.2281 - accuracy300: 0.4033 - val_loss: 3.2364 - val_accuracy300: 0.3830 - 10s/epoch - 18ms/step
Epoch 11/50
533/533 - 10s - loss: 3.2245 - accuracy300: 0.4059 - val_loss: 3.2359 - val_accuracy300: 0.3850 - 10s/epoch - 18ms/step
Epoch 12/50
533/533 - 9s - loss: 3.2207 - accuracy300: 0.4073 - val_loss: 3.2353 - val_accuracy300: 0.3842 - 9s/epoch - 18ms/step
Epoch 13/50
533/533 - 9s - loss: 3.2175 - accuracy300: 0.4084 - val_loss: 3.2343 - val_accuracy300: 0.3850 - 9s/epoch - 18ms/step
Epoch 14/50
533/533 - 10s - loss: 3.2153 - accuracy300: 0.4111 - val_loss: 3.2326 - val_accuracy300: 0.3869 - 10s/epoch - 18ms/step
Epoch 15/50
533/533 - 9s - loss: 3.2111 - accuracy300: 0.4134 - val_loss: 3.2313 - val_accuracy300: 0.3849 - 9s/epoch - 16ms/step
Epoch 16/50
533/533 - 9s - loss: 3.2066 - accuracy300: 0.4151 - val_loss: 3.2300 - val_accuracy300: 0.3897 - 9s/epoch - 16ms/step
Epoch 17/50
533/533 - 9s - loss: 3.2040 - accuracy300: 0.4161 - val_loss: 3.2255 - val_accuracy300: 0.3919 - 9s/epoch - 17ms/step
Epoch 18/50
533/533 - 9s - loss: 3.2004 - accuracy300: 0.4177 - val_loss: 3.2257 - val_accuracy300: 0.3954 - 9s/epoch - 17ms/step
Epoch 19/50
533/533 - 9s - loss: 3.1999 - accuracy300: 0.4182 - val_loss: 3.2233 - val_accuracy300: 0.3996 - 9s/epoch - 18ms/step
Epoch 20/50
533/533 - 9s - loss: 3.1969 - accuracy300: 0.4201 - val_loss: 3.2256 - val_accuracy300: 0.3984 - 9s/epoch - 17ms/step
Epoch 21/50
533/533 - 9s - loss: 3.1942 - accuracy300: 0.4215 - val_loss: 3.2196 - val_accuracy300: 0.4021 - 9s/epoch - 17ms/step
Epoch 22/50
533/533 - 10s - loss: 3.1893 - accuracy300: 0.4244 - val_loss: 3.2228 - val_accuracy300: 0.3986 - 10s/epoch - 19ms/step
Epoch 23/50
533/533 - 10s - loss: 3.1860 - accuracy300: 0.4260 - val_loss: 3.2258 - val_accuracy300: 0.4002 - 10s/epoch - 18ms/step
Epoch 24/50
533/533 - 10s - loss: 3.1836 - accuracy300: 0.4273 - val_loss: 3.2322 - val_accuracy300: 0.3998 - 10s/epoch - 19ms/step
Epoch 25/50
533/533 - 9s - loss: 3.1767 - accuracy300: 0.4290 - val_loss: 3.2289 - val_accuracy300: 0.3992 - 9s/epoch - 17ms/step
Epoch 26/50
533/533 - 10s - loss: 3.1740 - accuracy300: 0.4316 - val_loss: 3.2312 - val_accuracy300: 0.3993 - 10s/epoch - 19ms/step
Epoch 27/50
533/533 - 10s - loss: 3.1701 - accuracy300: 0.4343 - val_loss: 3.2436 - val_accuracy300: 0.3963 - 10s/epoch - 18ms/step
Epoch 28/50
533/533 - 9s - loss: 3.1655 - accuracy300: 0.4345 - val_loss: 3.2438 - val_accuracy300: 0.3949 - 9s/epoch - 18ms/step
Epoch 29/50
533/533 - 10s - loss: 3.1641 - accuracy300: 0.4373 - val_loss: 3.2472 - val_accuracy300: 0.3940 - 10s/epoch - 18ms/step
Epoch 30/50
533/533 - 10s - loss: 3.1579 - accuracy300: 0.4400 - val_loss: 3.2713 - val_accuracy300: 0.3874 - 10s/epoch - 18ms/step
Epoch 31/50
533/533 - 9s - loss: 3.1564 - accuracy300: 0.4419 - val_loss: 3.2708 - val_accuracy300: 0.3877 - 9s/epoch - 18ms/step
testing model: results/QRTEA/W6/deepOF_L1/h300
Evaluating performance on  test set...
2185/2185 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0976259
{'0': {'precision': 0.38730048681969587, 'recall': 0.27102251753414547, 'f1-score': 0.31889255665036864, 'support': 189630}, '1': {'precision': 0.29601887954032424, 'recall': 0.37207911737463506, 'f1-score': 0.32971942419881867, 'support': 170582}, '2': {'precision': 0.3990097142318212, 'recall': 0.4252857386986198, 'f1-score': 0.41172892671367195, 'support': 198958}, 'accuracy': 0.3567394531180142, 'macro avg': {'precision': 0.36077636019728043, 'recall': 0.3561291245358001, 'f1-score': 0.3534469691876197, 'support': 559170}, 'weighted avg': {'precision': 0.36362011293435126, 'recall': 0.3567394531180142, 'f1-score': 0.3552274945676468, 'support': 559170}}
[[51394 76129 62107]
 [41773 63470 65339]
 [39531 74813 84614]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0762789
{'0': {'precision': 0.4526921223801494, 'recall': 0.32015759769992547, 'f1-score': 0.3750608135923057, 'support': 46955}, '1': {'precision': 0.3501632084295722, 'recall': 0.40638915350362215, 'f1-score': 0.376186862990382, 'support': 45139}, '2': {'precision': 0.4122464282895256, 'recall': 0.47289313443647146, 'f1-score': 0.44049212992736136, 'support': 44177}, 'accuracy': 0.39823586823315305, 'macro avg': {'precision': 0.40503391969974906, 'recall': 0.3998132952133397, 'f1-score': 0.39724660217001634, 'support': 136271}, 'weighted avg': {'precision': 0.40561811489024624, 'recall': 0.39823586823315305, 'f1-score': 0.3966456556020768, 'support': 136271}}
[[15033 18371 13551]
 [10561 18344 16234]
 [ 7614 15672 20891]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0754052
{'0': {'precision': 0.4647210300429185, 'recall': 0.3084197333940982, 'f1-score': 0.3707711272428435, 'support': 17554}, '1': {'precision': 0.37019060619849337, 'recall': 0.46527292368303996, 'f1-score': 0.41232120734316924, 'support': 15737}, '2': {'precision': 0.4025757214404961, 'recall': 0.4528504359490275, 'f1-score': 0.42623571744208066, 'support': 14910}, 'accuracy': 0.40430696458579696, 'macro avg': {'precision': 0.4124957858939693, 'recall': 0.4088476976753886, 'f1-score': 0.4031093506760312, 'support': 48201}, 'weighted avg': {'precision': 0.41463468678651644, 'recall': 0.40430696458579696, 'f1-score': 0.40149353238816105, 'support': 48201}}
[[5414 7046 5094]
 [3489 7322 4926]
 [2747 5411 6752]]
training model: results/QRTEA/W6/deepOF_L1/h500
Epoch 1/50
533/533 - 12s - loss: 3.3146 - accuracy500: 0.3669 - val_loss: 3.2806 - val_accuracy500: 0.3640 - 12s/epoch - 23ms/step
Epoch 2/50
533/533 - 10s - loss: 3.2913 - accuracy500: 0.3766 - val_loss: 3.2790 - val_accuracy500: 0.3552 - 10s/epoch - 19ms/step
Epoch 3/50
533/533 - 10s - loss: 3.2819 - accuracy500: 0.3777 - val_loss: 3.2724 - val_accuracy500: 0.3582 - 10s/epoch - 19ms/step
Epoch 4/50
533/533 - 10s - loss: 3.2779 - accuracy500: 0.3756 - val_loss: 3.2718 - val_accuracy500: 0.3628 - 10s/epoch - 19ms/step
Epoch 5/50
533/533 - 10s - loss: 3.2736 - accuracy500: 0.3774 - val_loss: 3.2672 - val_accuracy500: 0.3607 - 10s/epoch - 18ms/step
Epoch 6/50
533/533 - 10s - loss: 3.2708 - accuracy500: 0.3808 - val_loss: 3.2657 - val_accuracy500: 0.3600 - 10s/epoch - 19ms/step
Epoch 7/50
533/533 - 9s - loss: 3.2687 - accuracy500: 0.3803 - val_loss: 3.2625 - val_accuracy500: 0.3570 - 9s/epoch - 18ms/step
Epoch 8/50
533/533 - 9s - loss: 3.2662 - accuracy500: 0.3812 - val_loss: 3.2628 - val_accuracy500: 0.3614 - 9s/epoch - 18ms/step
Epoch 9/50
533/533 - 10s - loss: 3.2659 - accuracy500: 0.3822 - val_loss: 3.2622 - val_accuracy500: 0.3587 - 10s/epoch - 18ms/step
Epoch 10/50
533/533 - 10s - loss: 3.2641 - accuracy500: 0.3823 - val_loss: 3.2628 - val_accuracy500: 0.3589 - 10s/epoch - 18ms/step
Epoch 11/50
533/533 - 9s - loss: 3.2617 - accuracy500: 0.3843 - val_loss: 3.2608 - val_accuracy500: 0.3605 - 9s/epoch - 17ms/step
Epoch 12/50
533/533 - 9s - loss: 3.2604 - accuracy500: 0.3842 - val_loss: 3.2613 - val_accuracy500: 0.3568 - 9s/epoch - 18ms/step
Epoch 13/50
533/533 - 10s - loss: 3.2590 - accuracy500: 0.3849 - val_loss: 3.2613 - val_accuracy500: 0.3588 - 10s/epoch - 18ms/step
Epoch 14/50
533/533 - 10s - loss: 3.2579 - accuracy500: 0.3875 - val_loss: 3.2627 - val_accuracy500: 0.3606 - 10s/epoch - 19ms/step
Epoch 15/50
533/533 - 10s - loss: 3.2558 - accuracy500: 0.3882 - val_loss: 3.2608 - val_accuracy500: 0.3647 - 10s/epoch - 18ms/step
Epoch 16/50
533/533 - 9s - loss: 3.2540 - accuracy500: 0.3902 - val_loss: 3.2604 - val_accuracy500: 0.3629 - 9s/epoch - 17ms/step
Epoch 17/50
533/533 - 10s - loss: 3.2524 - accuracy500: 0.3917 - val_loss: 3.2599 - val_accuracy500: 0.3623 - 10s/epoch - 18ms/step
Epoch 18/50
533/533 - 9s - loss: 3.2503 - accuracy500: 0.3921 - val_loss: 3.2616 - val_accuracy500: 0.3642 - 9s/epoch - 17ms/step
Epoch 19/50
533/533 - 9s - loss: 3.2503 - accuracy500: 0.3920 - val_loss: 3.2579 - val_accuracy500: 0.3648 - 9s/epoch - 17ms/step
Epoch 20/50
533/533 - 9s - loss: 3.2481 - accuracy500: 0.3938 - val_loss: 3.2598 - val_accuracy500: 0.3656 - 9s/epoch - 17ms/step
Epoch 21/50
533/533 - 9s - loss: 3.2480 - accuracy500: 0.3944 - val_loss: 3.2602 - val_accuracy500: 0.3658 - 9s/epoch - 17ms/step
Epoch 22/50
533/533 - 10s - loss: 3.2438 - accuracy500: 0.3965 - val_loss: 3.2583 - val_accuracy500: 0.3647 - 10s/epoch - 19ms/step
Epoch 23/50
533/533 - 10s - loss: 3.2432 - accuracy500: 0.3958 - val_loss: 3.2566 - val_accuracy500: 0.3709 - 10s/epoch - 18ms/step
Epoch 24/50
533/533 - 9s - loss: 3.2416 - accuracy500: 0.3974 - val_loss: 3.2583 - val_accuracy500: 0.3673 - 9s/epoch - 16ms/step
Epoch 25/50
533/533 - 9s - loss: 3.2392 - accuracy500: 0.3994 - val_loss: 3.2544 - val_accuracy500: 0.3717 - 9s/epoch - 17ms/step
Epoch 26/50
533/533 - 9s - loss: 3.2368 - accuracy500: 0.4010 - val_loss: 3.2539 - val_accuracy500: 0.3767 - 9s/epoch - 17ms/step
Epoch 27/50
533/533 - 10s - loss: 3.2351 - accuracy500: 0.4017 - val_loss: 3.2551 - val_accuracy500: 0.3745 - 10s/epoch - 18ms/step
Epoch 28/50
533/533 - 9s - loss: 3.2336 - accuracy500: 0.4027 - val_loss: 3.2539 - val_accuracy500: 0.3772 - 9s/epoch - 18ms/step
Epoch 29/50
533/533 - 9s - loss: 3.2316 - accuracy500: 0.4038 - val_loss: 3.2534 - val_accuracy500: 0.3778 - 9s/epoch - 17ms/step
Epoch 30/50
533/533 - 10s - loss: 3.2289 - accuracy500: 0.4069 - val_loss: 3.2522 - val_accuracy500: 0.3792 - 10s/epoch - 18ms/step
Epoch 31/50
533/533 - 10s - loss: 3.2256 - accuracy500: 0.4080 - val_loss: 3.2537 - val_accuracy500: 0.3801 - 10s/epoch - 19ms/step
Epoch 32/50
533/533 - 10s - loss: 3.2239 - accuracy500: 0.4084 - val_loss: 3.2532 - val_accuracy500: 0.3786 - 10s/epoch - 18ms/step
Epoch 33/50
533/533 - 10s - loss: 3.2193 - accuracy500: 0.4117 - val_loss: 3.2536 - val_accuracy500: 0.3823 - 10s/epoch - 19ms/step
Epoch 34/50
533/533 - 9s - loss: 3.2170 - accuracy500: 0.4146 - val_loss: 3.2535 - val_accuracy500: 0.3785 - 9s/epoch - 17ms/step
Epoch 35/50
533/533 - 10s - loss: 3.2130 - accuracy500: 0.4149 - val_loss: 3.2586 - val_accuracy500: 0.3802 - 10s/epoch - 18ms/step
Epoch 36/50
533/533 - 10s - loss: 3.2110 - accuracy500: 0.4173 - val_loss: 3.2599 - val_accuracy500: 0.3777 - 10s/epoch - 18ms/step
Epoch 37/50
533/533 - 9s - loss: 3.2052 - accuracy500: 0.4222 - val_loss: 3.2590 - val_accuracy500: 0.3799 - 9s/epoch - 17ms/step
Epoch 38/50
533/533 - 10s - loss: 3.2020 - accuracy500: 0.4241 - val_loss: 3.2648 - val_accuracy500: 0.3772 - 10s/epoch - 18ms/step
Epoch 39/50
533/533 - 9s - loss: 3.1970 - accuracy500: 0.4276 - val_loss: 3.2704 - val_accuracy500: 0.3711 - 9s/epoch - 17ms/step
Epoch 40/50
533/533 - 10s - loss: 3.1916 - accuracy500: 0.4285 - val_loss: 3.2998 - val_accuracy500: 0.3676 - 10s/epoch - 18ms/step
testing model: results/QRTEA/W6/deepOF_L1/h500
Evaluating performance on  test set...
2185/2185 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1061304
{'0': {'precision': 0.37423651978429795, 'recall': 0.40888906932723, 'f1-score': 0.3907961236625374, 'support': 197051}, '1': {'precision': 0.2757959247686721, 'recall': 0.445532205151525, 'f1-score': 0.3406936772244963, 'support': 153935}, '2': {'precision': 0.40766806722689075, 'recall': 0.18642162702224954, 'f1-score': 0.2558473749439654, 'support': 208184}, 'accuracy': 0.33615000804764206, 'macro avg': {'precision': 0.3525668372599536, 'recall': 0.34694763383366817, 'f1-score': 0.3291123919436663, 'support': 559170}, 'weighted avg': {'precision': 0.35958348095721204, 'recall': 0.33615000804764206, 'f1-score': 0.3267606954463115, 'support': 559170}}
[[80572 86540 29939]
 [58901 68583 26451]
 [75824 93550 38810]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0856907
{'0': {'precision': 0.4087602720874454, 'recall': 0.43566265060240966, 'f1-score': 0.42178292136199047, 'support': 47725}, '1': {'precision': 0.3296817172464841, 'recall': 0.46046223120749863, 'f1-score': 0.3842489192220315, 'support': 43528}, '2': {'precision': 0.4246241365298659, 'recall': 0.23212937047403262, 'f1-score': 0.3001665996438215, 'support': 45018}, 'accuracy': 0.37634566415451565, 'macro avg': {'precision': 0.3876887086212652, 'recall': 0.37608475076131365, 'f1-score': 0.36873281340928116, 'support': 136271}, 'weighted avg': {'precision': 0.3887415455377872, 'recall': 0.37634566415451565, 'f1-score': 0.3696169901201513, 'support': 136271}}
[[20792 20397  6536]
 [15861 20043  7624]
 [14213 20355 10450]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0826073
{'0': {'precision': 0.38984081361927925, 'recall': 0.42719563900666263, 'f1-score': 0.40766429686145306, 'support': 16510}, '1': {'precision': 0.3791255797199334, 'recall': 0.4760020351630957, 'f1-score': 0.4220762945511053, 'support': 17689}, '2': {'precision': 0.37, 'recall': 0.20875589201542638, 'f1-score': 0.2669162633549448, 'support': 14002}, 'accuracy': 0.3816518329495239, 'macro avg': {'precision': 0.37965546444640424, 'recall': 0.3706511887283949, 'f1-score': 0.3655522849225011, 'support': 48201}, 'weighted avg': {'precision': 0.3801448976685173, 'recall': 0.3816518329495239, 'f1-score': 0.37206710721754793, 'support': 48201}}
[[7053 7274 2183]
 [6475 8420 2794]
 [4564 6515 2923]]
training model: results/QRTEA/W6/deepOF_L1/h1000
Epoch 1/50
533/533 - 12s - loss: 3.2955 - accuracy1000: 0.3869 - val_loss: 3.2925 - val_accuracy1000: 0.3381 - 12s/epoch - 22ms/step
Epoch 2/50
533/533 - 9s - loss: 3.2734 - accuracy1000: 0.3930 - val_loss: 3.2889 - val_accuracy1000: 0.3363 - 9s/epoch - 18ms/step
Epoch 3/50
533/533 - 9s - loss: 3.2675 - accuracy1000: 0.3978 - val_loss: 3.2684 - val_accuracy1000: 0.3554 - 9s/epoch - 16ms/step
Epoch 4/50
533/533 - 9s - loss: 3.2674 - accuracy1000: 0.3940 - val_loss: 3.2586 - val_accuracy1000: 0.3691 - 9s/epoch - 17ms/step
Epoch 5/50
533/533 - 10s - loss: 3.2654 - accuracy1000: 0.3938 - val_loss: 3.2581 - val_accuracy1000: 0.3772 - 10s/epoch - 18ms/step
Epoch 6/50
533/533 - 10s - loss: 3.2696 - accuracy1000: 0.3890 - val_loss: 3.2539 - val_accuracy1000: 0.3984 - 10s/epoch - 19ms/step
Epoch 7/50
533/533 - 10s - loss: 3.2669 - accuracy1000: 0.3906 - val_loss: 3.2520 - val_accuracy1000: 0.3993 - 10s/epoch - 19ms/step
Epoch 8/50
533/533 - 10s - loss: 3.2671 - accuracy1000: 0.3880 - val_loss: 3.2546 - val_accuracy1000: 0.3957 - 10s/epoch - 18ms/step
Epoch 9/50
533/533 - 10s - loss: 3.2679 - accuracy1000: 0.3868 - val_loss: 3.2553 - val_accuracy1000: 0.3970 - 10s/epoch - 19ms/step
Epoch 10/50
533/533 - 10s - loss: 3.2667 - accuracy1000: 0.3863 - val_loss: 3.2575 - val_accuracy1000: 0.3929 - 10s/epoch - 19ms/step
Epoch 11/50
533/533 - 9s - loss: 3.2658 - accuracy1000: 0.3866 - val_loss: 3.2559 - val_accuracy1000: 0.3889 - 9s/epoch - 18ms/step
Epoch 12/50
533/533 - 10s - loss: 3.2625 - accuracy1000: 0.3875 - val_loss: 3.2552 - val_accuracy1000: 0.3807 - 10s/epoch - 18ms/step
Epoch 13/50
533/533 - 9s - loss: 3.2598 - accuracy1000: 0.3921 - val_loss: 3.2513 - val_accuracy1000: 0.3825 - 9s/epoch - 17ms/step
Epoch 14/50
533/533 - 9s - loss: 3.2567 - accuracy1000: 0.3951 - val_loss: 3.2538 - val_accuracy1000: 0.3822 - 9s/epoch - 18ms/step
Epoch 15/50
533/533 - 9s - loss: 3.2578 - accuracy1000: 0.3940 - val_loss: 3.2521 - val_accuracy1000: 0.3898 - 9s/epoch - 17ms/step
Epoch 16/50
533/533 - 10s - loss: 3.2572 - accuracy1000: 0.3956 - val_loss: 3.2518 - val_accuracy1000: 0.3873 - 10s/epoch - 18ms/step
Epoch 17/50
533/533 - 10s - loss: 3.2552 - accuracy1000: 0.3960 - val_loss: 3.2478 - val_accuracy1000: 0.3955 - 10s/epoch - 18ms/step
Epoch 18/50
533/533 - 10s - loss: 3.2528 - accuracy1000: 0.3984 - val_loss: 3.2467 - val_accuracy1000: 0.3920 - 10s/epoch - 19ms/step
Epoch 19/50
533/533 - 9s - loss: 3.2503 - accuracy1000: 0.3996 - val_loss: 3.2472 - val_accuracy1000: 0.3921 - 9s/epoch - 18ms/step
Epoch 20/50
533/533 - 10s - loss: 3.2496 - accuracy1000: 0.4000 - val_loss: 3.2505 - val_accuracy1000: 0.3829 - 10s/epoch - 18ms/step
Epoch 21/50
533/533 - 10s - loss: 3.2479 - accuracy1000: 0.4011 - val_loss: 3.2526 - val_accuracy1000: 0.3841 - 10s/epoch - 19ms/step
Epoch 22/50
533/533 - 10s - loss: 3.2472 - accuracy1000: 0.4029 - val_loss: 3.2499 - val_accuracy1000: 0.3916 - 10s/epoch - 19ms/step
Epoch 23/50
533/533 - 9s - loss: 3.2456 - accuracy1000: 0.4042 - val_loss: 3.2503 - val_accuracy1000: 0.3794 - 9s/epoch - 17ms/step
Epoch 24/50
533/533 - 10s - loss: 3.2448 - accuracy1000: 0.4053 - val_loss: 3.2494 - val_accuracy1000: 0.3891 - 10s/epoch - 19ms/step
Epoch 25/50
533/533 - 10s - loss: 3.2425 - accuracy1000: 0.4058 - val_loss: 3.2470 - val_accuracy1000: 0.3837 - 10s/epoch - 18ms/step
Epoch 26/50
533/533 - 9s - loss: 3.2396 - accuracy1000: 0.4087 - val_loss: 3.2551 - val_accuracy1000: 0.3698 - 9s/epoch - 17ms/step
Epoch 27/50
533/533 - 9s - loss: 3.2397 - accuracy1000: 0.4097 - val_loss: 3.2527 - val_accuracy1000: 0.3709 - 9s/epoch - 16ms/step
Epoch 28/50
533/533 - 9s - loss: 3.2407 - accuracy1000: 0.4072 - val_loss: 3.2519 - val_accuracy1000: 0.3768 - 9s/epoch - 18ms/step
testing model: results/QRTEA/W6/deepOF_L1/h1000
Evaluating performance on  test set...
2185/2185 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1140944
{'0': {'precision': 0.2760806402737919, 'recall': 0.5252762309148008, 'f1-score': 0.361932625439318, 'support': 147431}, '1': {'precision': 0.4790528233151184, 'recall': 0.003298812176756126, 'f1-score': 0.006552503072783443, 'support': 239177}, '2': {'precision': 0.3245601368864117, 'recall': 0.5210243274880912, 'f1-score': 0.3999688598247253, 'support': 172562}, 'accuracy': 0.3006956739453118, 'macro avg': {'precision': 0.3598978668251074, 'recall': 0.34986645685988266, 'f1-score': 0.25615132944560887, 'support': 559170}, 'weighted avg': {'precision': 0.37786005747740126, 'recall': 0.3006956739453118, 'f1-score': 0.22166196920016712, 'support': 559170}}
[[ 77442    428  69561]
 [120840    789 117548]
 [ 82223    430  89909]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0936276
{'0': {'precision': 0.3807556762377954, 'recall': 0.5505273050015662, 'f1-score': 0.4501669213889909, 'support': 47885}, '1': {'precision': 0.39373970345963755, 'recall': 0.005486055319637324, 'f1-score': 0.010821334782214979, 'support': 43565}, '2': {'precision': 0.36054073583428675, 'recall': 0.5343477387831597, 'f1-score': 0.4305656680060046, 'support': 44821}, 'accuracy': 0.37095933837720424, 'macro avg': {'precision': 0.37834537184390654, 'recall': 0.36345369970145436, 'f1-score': 0.29718464139240347, 'support': 136271}, 'weighted avg': {'precision': 0.3782576781464472, 'recall': 0.37095933837720424, 'f1-score': 0.3032637779585984, 'support': 136271}}
[[26362   193 21330]
 [22178   239 21148]
 [20696   175 23950]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0855919
{'0': {'precision': 0.42540338605834194, 'recall': 0.5423866227514568, 'f1-score': 0.4768247321647326, 'support': 19735}, '1': {'precision': 0.3257918552036199, 'recall': 0.0054245460709711445, 'f1-score': 0.010671409515340152, 'support': 13273}, '2': {'precision': 0.35984748882461215, 'recall': 0.5404462581451984, 'f1-score': 0.4320328326010891, 'support': 15193}, 'accuracy': 0.39391298935706726, 'macro avg': {'precision': 0.37034757669552465, 'recall': 0.3627524756558754, 'f1-score': 0.3065096580937206, 'support': 48201}, 'weighted avg': {'precision': 0.37731030509100133, 'recall': 0.39391298935706726, 'f1-score': 0.33434270105343156, 'support': 48201}}
[[10704    98  8933]
 [ 7527    72  5674]
 [ 6931    51  8211]]
training model: results/QRTEA/W6/deepLOB_L2/h10
Epoch 1/50
533/533 - 26s - loss: 3.1341 - accuracy10: 0.3889 - val_loss: 3.1088 - val_accuracy10: 0.2146 - 26s/epoch - 49ms/step
Epoch 2/50
533/533 - 24s - loss: 2.8237 - accuracy10: 0.4518 - val_loss: 3.0452 - val_accuracy10: 0.3238 - 24s/epoch - 45ms/step
Epoch 3/50
533/533 - 24s - loss: 2.7298 - accuracy10: 0.4876 - val_loss: 2.9661 - val_accuracy10: 0.3220 - 24s/epoch - 44ms/step
Epoch 4/50
533/533 - 24s - loss: 2.6616 - accuracy10: 0.5204 - val_loss: 3.0287 - val_accuracy10: 0.3173 - 24s/epoch - 44ms/step
Epoch 5/50
533/533 - 23s - loss: 2.6101 - accuracy10: 0.5443 - val_loss: 2.9924 - val_accuracy10: 0.4811 - 23s/epoch - 44ms/step
Epoch 6/50
533/533 - 24s - loss: 2.5647 - accuracy10: 0.5611 - val_loss: 2.9146 - val_accuracy10: 0.5158 - 24s/epoch - 44ms/step
Epoch 7/50
533/533 - 24s - loss: 2.5166 - accuracy10: 0.5799 - val_loss: 2.9142 - val_accuracy10: 0.4588 - 24s/epoch - 45ms/step
Epoch 8/50
533/533 - 23s - loss: 2.4638 - accuracy10: 0.5950 - val_loss: 2.9427 - val_accuracy10: 0.4318 - 23s/epoch - 44ms/step
Epoch 9/50
533/533 - 23s - loss: 2.4125 - accuracy10: 0.6133 - val_loss: 2.8043 - val_accuracy10: 0.4950 - 23s/epoch - 44ms/step
Epoch 10/50
533/533 - 24s - loss: 2.3625 - accuracy10: 0.6302 - val_loss: 2.8170 - val_accuracy10: 0.5075 - 24s/epoch - 45ms/step
Epoch 11/50
533/533 - 24s - loss: 2.3297 - accuracy10: 0.6398 - val_loss: 2.7336 - val_accuracy10: 0.5132 - 24s/epoch - 45ms/step
Epoch 12/50
533/533 - 24s - loss: 2.2922 - accuracy10: 0.6481 - val_loss: 2.7511 - val_accuracy10: 0.4967 - 24s/epoch - 44ms/step
Epoch 13/50
533/533 - 24s - loss: 2.2634 - accuracy10: 0.6587 - val_loss: 2.7286 - val_accuracy10: 0.4840 - 24s/epoch - 45ms/step
Epoch 14/50
533/533 - 23s - loss: 2.2328 - accuracy10: 0.6632 - val_loss: 2.7744 - val_accuracy10: 0.4443 - 23s/epoch - 44ms/step
Epoch 15/50
533/533 - 23s - loss: 2.2119 - accuracy10: 0.6693 - val_loss: 2.7882 - val_accuracy10: 0.5044 - 23s/epoch - 43ms/step
Epoch 16/50
533/533 - 23s - loss: 2.1869 - accuracy10: 0.6724 - val_loss: 2.7540 - val_accuracy10: 0.4866 - 23s/epoch - 44ms/step
Epoch 17/50
533/533 - 24s - loss: 2.1677 - accuracy10: 0.6756 - val_loss: 2.7814 - val_accuracy10: 0.5180 - 24s/epoch - 45ms/step
Epoch 18/50
533/533 - 24s - loss: 2.1447 - accuracy10: 0.6803 - val_loss: 2.7700 - val_accuracy10: 0.4853 - 24s/epoch - 44ms/step
Epoch 19/50
533/533 - 23s - loss: 2.1289 - accuracy10: 0.6791 - val_loss: 2.7801 - val_accuracy10: 0.4725 - 23s/epoch - 44ms/step
Epoch 20/50
533/533 - 24s - loss: 2.1037 - accuracy10: 0.6830 - val_loss: 2.8034 - val_accuracy10: 0.4840 - 24s/epoch - 44ms/step
Epoch 21/50
533/533 - 24s - loss: 2.0826 - accuracy10: 0.6861 - val_loss: 2.8170 - val_accuracy10: 0.4872 - 24s/epoch - 44ms/step
Epoch 22/50
533/533 - 24s - loss: 2.0639 - accuracy10: 0.6868 - val_loss: 2.8322 - val_accuracy10: 0.5050 - 24s/epoch - 45ms/step
Epoch 23/50
533/533 - 24s - loss: 2.0447 - accuracy10: 0.6908 - val_loss: 2.8000 - val_accuracy10: 0.5343 - 24s/epoch - 44ms/step
testing model: results/QRTEA/W6/deepLOB_L2/h10
Evaluating performance on  test set...
2185/2185 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9783443
{'0': {'precision': 0.2241502291385974, 'recall': 0.7185234999626392, 'f1-score': 0.34170297142288586, 'support': 66915}, '1': {'precision': 0.8697225013527092, 'recall': 0.5302231332909215, 'f1-score': 0.6588069969991949, 'support': 424410}, '2': {'precision': 0.2913796313535654, 'recall': 0.3690493736182756, 'f1-score': 0.3256473281052891, 'support': 67850}, 'accuracy': 0.5331998032816202, 'macro avg': {'precision': 0.46175078728162405, 'recall': 0.5392653356239455, 'f1-score': 0.44205243217579, 'support': 559175}, 'weighted avg': {'precision': 0.7222927480113597, 'recall': 0.5331998032816202, 'f1-score': 0.5804345744018145, 'support': 559175}}
[[ 48080  13545   5290]
 [143772 225032  55606]
 [ 22647  20163  25040]]
Evaluating performance on  train set...
533/533 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0109583
{'0': {'precision': 0.19455268233164089, 'recall': 0.7326762024753576, 'f1-score': 0.30746264014803987, 'support': 13493}, '1': {'precision': 0.9258436303201099, 'recall': 0.46905230403148307, 'f1-score': 0.6226544608525036, 'support': 109265}, '2': {'precision': 0.25102976348657985, 'recall': 0.5591151228174016, 'f1-score': 0.3464924346629986, 'support': 13516}, 'accuracy': 0.504087353420315, 'macro avg': {'precision': 0.45714202537944354, 'recall': 0.5869478764414141, 'f1-score': 0.42553651188784736, 'support': 136274}, 'weighted avg': {'precision': 0.786506023841028, 'recall': 0.504087353420315, 'f1-score': 0.5640556879189824, 'support': 136274}}
[[ 9886  1863  1744]
 [37211 51251 20803]
 [ 3717  2242  7557]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0373089
{'0': {'precision': 0.19776663917264134, 'recall': 0.6571790006325111, 'f1-score': 0.30403823644166994, 'support': 4743}, '1': {'precision': 0.9138517936632626, 'recall': 0.44729826719983595, 'f1-score': 0.6006161047722305, 'support': 39012}, '2': {'precision': 0.20230780758279635, 'recall': 0.6071508882392624, 'f1-score': 0.3034901365705615, 'support': 4447}, 'accuracy': 0.4826978133687399, 'macro avg': {'precision': 0.43797541347290014, 'recall': 0.5705427186905365, 'f1-score': 0.40271482592815394, 'support': 48202}, 'weighted avg': {'precision': 0.7777448272749623, 'recall': 0.4826978133687399, 'f1-score': 0.5440211914888674, 'support': 48202}}
[[ 3117   814   812]
 [11728 17450  9834]
 [  916   831  2700]]
training model: results/QRTEA/W6/deepLOB_L2/h20
Epoch 1/50
533/533 - 27s - loss: 3.1041 - accuracy20: 0.4202 - val_loss: 3.1409 - val_accuracy20: 0.3003 - 27s/epoch - 50ms/step
Epoch 2/50
533/533 - 23s - loss: 2.8639 - accuracy20: 0.4572 - val_loss: 3.0351 - val_accuracy20: 0.3817 - 23s/epoch - 44ms/step
Epoch 3/50
533/533 - 23s - loss: 2.7553 - accuracy20: 0.5112 - val_loss: 3.0634 - val_accuracy20: 0.4620 - 23s/epoch - 44ms/step
Epoch 4/50
533/533 - 24s - loss: 2.7063 - accuracy20: 0.5338 - val_loss: 3.0912 - val_accuracy20: 0.4629 - 24s/epoch - 44ms/step
Epoch 5/50
533/533 - 23s - loss: 2.6493 - accuracy20: 0.5577 - val_loss: 3.0027 - val_accuracy20: 0.5053 - 23s/epoch - 44ms/step
Epoch 6/50
533/533 - 24s - loss: 2.6074 - accuracy20: 0.5671 - val_loss: 3.0229 - val_accuracy20: 0.4988 - 24s/epoch - 44ms/step
Epoch 7/50
533/533 - 24s - loss: 2.5753 - accuracy20: 0.5844 - val_loss: 3.0324 - val_accuracy20: 0.5445 - 24s/epoch - 44ms/step
Epoch 8/50
533/533 - 24s - loss: 2.5342 - accuracy20: 0.5980 - val_loss: 3.0229 - val_accuracy20: 0.5550 - 24s/epoch - 45ms/step
Epoch 9/50
533/533 - 24s - loss: 2.5027 - accuracy20: 0.6058 - val_loss: 3.0291 - val_accuracy20: 0.5298 - 24s/epoch - 45ms/step
Epoch 10/50
533/533 - 24s - loss: 2.4708 - accuracy20: 0.6133 - val_loss: 3.0626 - val_accuracy20: 0.5542 - 24s/epoch - 45ms/step
Epoch 11/50
533/533 - 24s - loss: 2.4409 - accuracy20: 0.6198 - val_loss: 3.0403 - val_accuracy20: 0.5607 - 24s/epoch - 45ms/step
Epoch 12/50
533/533 - 23s - loss: 2.4150 - accuracy20: 0.6267 - val_loss: 3.0318 - val_accuracy20: 0.5814 - 23s/epoch - 44ms/step
Epoch 13/50
533/533 - 23s - loss: 2.3903 - accuracy20: 0.6349 - val_loss: 3.0865 - val_accuracy20: 0.5420 - 23s/epoch - 44ms/step
Epoch 14/50
533/533 - 23s - loss: 2.3711 - accuracy20: 0.6373 - val_loss: 3.0432 - val_accuracy20: 0.5810 - 23s/epoch - 44ms/step
Epoch 15/50
533/533 - 24s - loss: 2.3408 - accuracy20: 0.6435 - val_loss: 3.0511 - val_accuracy20: 0.5829 - 24s/epoch - 44ms/step
testing model: results/QRTEA/W6/deepLOB_L2/h20
Evaluating performance on  test set...
2185/2185 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9087669
{'0': {'precision': 0.27047200878155875, 'recall': 0.4667706708268331, 'f1-score': 0.34248804218960793, 'support': 89740}, '1': {'precision': 0.7036767577751059, 'recall': 0.7276710998009577, 'f1-score': 0.7154728146960917, 'support': 378814}, '2': {'precision': 0.5136790202004136, 'recall': 0.07127487006323038, 'f1-score': 0.12518048355055963, 'support': 90621}, 'accuracy': 0.5794232574775339, 'macro avg': {'precision': 0.4959425955856927, 'recall': 0.42190554689700704, 'f1-score': 0.39438044681208645, 'support': 559175}, 'weighted avg': {'precision': 0.6033618668171105, 'recall': 0.5794232574775339, 'f1-score': 0.559949883904352, 'support': 559175}}
[[ 41888  46489   1363]
 [ 98410 275652   4752]
 [ 14572  69590   6459]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9655946
{'0': {'precision': 0.24253984401492032, 'recall': 0.6311493492168542, 'f1-score': 0.3504194990507686, 'support': 18132}, '1': {'precision': 0.8116962467267966, 'recall': 0.5578595852746505, 'f1-score': 0.6612545775607674, 'support': 100018}, '2': {'precision': 0.2976904176904177, 'recall': 0.33425292429927167, 'f1-score': 0.3149139678744087, 'support': 18124}, 'accuracy': 0.5378722280112127, 'macro avg': {'precision': 0.4506421694773783, 'recall': 0.5077539529302588, 'f1-score': 0.4421960148286482, 'support': 136274}, 'weighted avg': {'precision': 0.6676057706313779, 'recall': 0.5378722280112127, 'f1-score': 0.5738340949045098, 'support': 136274}}
[[11444  5239  1449]
 [31379 55796 12843]
 [ 4361  7705  6058]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0305215
{'0': {'precision': 0.228626320845341, 'recall': 0.5623818525519849, 'f1-score': 0.32509220051905474, 'support': 6348}, '1': {'precision': 0.7995602310942486, 'recall': 0.5177130733368694, 'f1-score': 0.6284842836566974, 'support': 35821}, '2': {'precision': 0.239433620781433, 'recall': 0.3727830266865573, 'f1-score': 0.2915856346428109, 'support': 6033}, 'accuracy': 0.5054562051367163, 'macro avg': {'precision': 0.4225400575736742, 'recall': 0.48429265085847056, 'f1-score': 0.4150540396061877, 'support': 48202}, 'weighted avg': {'precision': 0.6542647599047278, 'recall': 0.5054562051367163, 'f1-score': 0.5463623282760381, 'support': 48202}}
[[ 3570  2025   753]
 [10885 18545  6391]
 [ 1160  2624  2249]]
training model: results/QRTEA/W6/deepLOB_L2/h30
Epoch 1/50
533/533 - 26s - loss: 3.1084 - accuracy30: 0.4217 - val_loss: 3.0717 - val_accuracy30: 0.3117 - 26s/epoch - 49ms/step
Epoch 2/50
533/533 - 24s - loss: 2.8602 - accuracy30: 0.4683 - val_loss: 3.2017 - val_accuracy30: 0.3713 - 24s/epoch - 45ms/step
Epoch 3/50
533/533 - 24s - loss: 2.7794 - accuracy30: 0.5091 - val_loss: 3.2271 - val_accuracy30: 0.4083 - 24s/epoch - 45ms/step
Epoch 4/50
533/533 - 25s - loss: 2.7392 - accuracy30: 0.5266 - val_loss: 3.0461 - val_accuracy30: 0.4793 - 25s/epoch - 47ms/step
Epoch 5/50
533/533 - 24s - loss: 2.7048 - accuracy30: 0.5360 - val_loss: 3.1535 - val_accuracy30: 0.4508 - 24s/epoch - 45ms/step
Epoch 6/50
533/533 - 24s - loss: 2.6644 - accuracy30: 0.5545 - val_loss: 3.1498 - val_accuracy30: 0.4980 - 24s/epoch - 45ms/step
Epoch 7/50
533/533 - 24s - loss: 2.6349 - accuracy30: 0.5638 - val_loss: 3.1759 - val_accuracy30: 0.5043 - 24s/epoch - 45ms/step
Epoch 8/50
533/533 - 24s - loss: 2.5993 - accuracy30: 0.5720 - val_loss: 3.1090 - val_accuracy30: 0.5064 - 24s/epoch - 46ms/step
Epoch 9/50
533/533 - 24s - loss: 2.5702 - accuracy30: 0.5825 - val_loss: 3.0570 - val_accuracy30: 0.5340 - 24s/epoch - 45ms/step
Epoch 10/50
533/533 - 24s - loss: 2.5355 - accuracy30: 0.5916 - val_loss: 3.0741 - val_accuracy30: 0.5213 - 24s/epoch - 46ms/step
Epoch 11/50
533/533 - 25s - loss: 2.5080 - accuracy30: 0.5959 - val_loss: 2.9891 - val_accuracy30: 0.5334 - 25s/epoch - 47ms/step
Epoch 12/50
533/533 - 25s - loss: 2.4930 - accuracy30: 0.6004 - val_loss: 3.0236 - val_accuracy30: 0.5139 - 25s/epoch - 46ms/step
Epoch 13/50
533/533 - 24s - loss: 2.4629 - accuracy30: 0.6061 - val_loss: 3.0111 - val_accuracy30: 0.5204 - 24s/epoch - 45ms/step
Epoch 14/50
533/533 - 24s - loss: 2.4387 - accuracy30: 0.6099 - val_loss: 2.9741 - val_accuracy30: 0.5303 - 24s/epoch - 44ms/step
Epoch 15/50
533/533 - 24s - loss: 2.4086 - accuracy30: 0.6172 - val_loss: 2.9579 - val_accuracy30: 0.5195 - 24s/epoch - 45ms/step
Epoch 16/50
533/533 - 24s - loss: 2.3832 - accuracy30: 0.6217 - val_loss: 2.9774 - val_accuracy30: 0.5484 - 24s/epoch - 46ms/step
Epoch 17/50
533/533 - 24s - loss: 2.3608 - accuracy30: 0.6259 - val_loss: 3.0121 - val_accuracy30: 0.5428 - 24s/epoch - 45ms/step
Epoch 18/50
533/533 - 24s - loss: 2.3389 - accuracy30: 0.6302 - val_loss: 3.0071 - val_accuracy30: 0.5547 - 24s/epoch - 44ms/step
Epoch 19/50
533/533 - 24s - loss: 2.3133 - accuracy30: 0.6344 - val_loss: 3.0209 - val_accuracy30: 0.5544 - 24s/epoch - 45ms/step
Epoch 20/50
533/533 - 24s - loss: 2.2912 - accuracy30: 0.6392 - val_loss: 3.0513 - val_accuracy30: 0.5751 - 24s/epoch - 45ms/step
Epoch 21/50
533/533 - 24s - loss: 2.2692 - accuracy30: 0.6428 - val_loss: 3.1175 - val_accuracy30: 0.5923 - 24s/epoch - 45ms/step
Epoch 22/50
533/533 - 24s - loss: 2.2516 - accuracy30: 0.6456 - val_loss: 3.1659 - val_accuracy30: 0.5829 - 24s/epoch - 46ms/step
Epoch 23/50
533/533 - 24s - loss: 2.2285 - accuracy30: 0.6497 - val_loss: 3.1080 - val_accuracy30: 0.5643 - 24s/epoch - 45ms/step
Epoch 24/50
533/533 - 24s - loss: 2.2136 - accuracy30: 0.6520 - val_loss: 3.1511 - val_accuracy30: 0.5868 - 24s/epoch - 45ms/step
Epoch 25/50
533/533 - 24s - loss: 2.1958 - accuracy30: 0.6535 - val_loss: 3.1056 - val_accuracy30: 0.5529 - 24s/epoch - 45ms/step
testing model: results/QRTEA/W6/deepLOB_L2/h30
Evaluating performance on  test set...
2185/2185 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97051
{'0': {'precision': 0.29987528868360275, 'recall': 0.6038674752585758, 'f1-score': 0.40074441687344914, 'support': 107512}, '1': {'precision': 0.6956947636585163, 'recall': 0.585695427537351, 'f1-score': 0.6359737179761006, 'support': 343163}, '2': {'precision': 0.4028379609826858, 'recall': 0.1996405529953917, 'f1-score': 0.2669731498542562, 'support': 108500}, 'accuracy': 0.5142808601958242, 'macro avg': {'precision': 0.46613600444160164, 'recall': 0.4630678185971062, 'f1-score': 0.43456376156793536, 'support': 559175}, 'weighted avg': {'precision': 0.5627662413107173, 'recall': 0.5142808601958242, 'f1-score': 0.5191470818400639, 'support': 559175}}
[[ 64923  36587   6002]
 [116066 200989  26108]
 [ 35511  51328  21661]]
Evaluating performance on  train set...
533/533 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96198493
{'0': {'precision': 0.31719134811007604, 'recall': 0.5444061566735585, 'f1-score': 0.40083895739246633, 'support': 21765}, '1': {'precision': 0.7991789689745007, 'recall': 0.5454134025839682, 'f1-score': 0.6483495369480844, 'support': 92803}, '2': {'precision': 0.31450411713458676, 'recall': 0.5155717313185294, 'f1-score': 0.3906858210127599, 'support': 21706}, 'accuracy': 0.540499288198776, 'macro avg': {'precision': 0.47695814473972115, 'recall': 0.5351304301920187, 'f1-score': 0.4799581051177702, 'support': 136274}, 'weighted avg': {'precision': 0.6449983262829281, 'recall': 0.540499288198776, 'f1-score': 0.5677771872546713, 'support': 136274}}
[[11849  6151  3765]
 [21560 50616 20627]
 [ 3947  6568 11191]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9765255
{'0': {'precision': 0.30065465125676877, 'recall': 0.48525958779024264, 'f1-score': 0.3712760117770348, 'support': 7666}, '1': {'precision': 0.7958416379778945, 'recall': 0.5282321106434155, 'f1-score': 0.6349934942894317, 'support': 33260}, '2': {'precision': 0.2704864393223297, 'recall': 0.5112699285321606, 'f1-score': 0.3537971372866042, 'support': 7276}, 'accuracy': 0.5188373926393096, 'macro avg': {'precision': 0.4556609095189976, 'recall': 0.5082538756552729, 'f1-score': 0.45335554778435694, 'support': 48202}, 'weighted avg': {'precision': 0.6377862073811964, 'recall': 0.5188373926393096, 'f1-score': 0.5506060640066093, 'support': 48202}}
[[ 3720  2282  1664]
 [ 7322 17569  8369]
 [ 1331  2225  3720]]
training model: results/QRTEA/W6/deepLOB_L2/h50
Epoch 1/50
533/533 - 27s - loss: 3.2079 - accuracy50: 0.4131 - val_loss: 3.3906 - val_accuracy50: 0.3176 - 27s/epoch - 50ms/step
Epoch 2/50
533/533 - 24s - loss: 2.9615 - accuracy50: 0.4638 - val_loss: 3.1334 - val_accuracy50: 0.4343 - 24s/epoch - 45ms/step
Epoch 3/50
533/533 - 24s - loss: 2.8779 - accuracy50: 0.4990 - val_loss: 3.1967 - val_accuracy50: 0.3830 - 24s/epoch - 45ms/step
Epoch 4/50
533/533 - 24s - loss: 2.8134 - accuracy50: 0.5202 - val_loss: 3.3526 - val_accuracy50: 0.4056 - 24s/epoch - 45ms/step
Epoch 5/50
533/533 - 24s - loss: 2.7757 - accuracy50: 0.5307 - val_loss: 3.4733 - val_accuracy50: 0.3938 - 24s/epoch - 44ms/step
Epoch 6/50
533/533 - 24s - loss: 2.7485 - accuracy50: 0.5405 - val_loss: 3.3041 - val_accuracy50: 0.4409 - 24s/epoch - 45ms/step
Epoch 7/50
533/533 - 24s - loss: 2.7203 - accuracy50: 0.5473 - val_loss: 3.3218 - val_accuracy50: 0.3995 - 24s/epoch - 45ms/step
Epoch 8/50
533/533 - 24s - loss: 2.6951 - accuracy50: 0.5537 - val_loss: 3.3909 - val_accuracy50: 0.4095 - 24s/epoch - 45ms/step
Epoch 9/50
533/533 - 24s - loss: 2.6653 - accuracy50: 0.5607 - val_loss: 3.5685 - val_accuracy50: 0.3890 - 24s/epoch - 45ms/step
Epoch 10/50
533/533 - 24s - loss: 2.6354 - accuracy50: 0.5654 - val_loss: 3.6304 - val_accuracy50: 0.3964 - 24s/epoch - 45ms/step
Epoch 11/50
533/533 - 24s - loss: 2.6061 - accuracy50: 0.5713 - val_loss: 3.8278 - val_accuracy50: 0.3813 - 24s/epoch - 45ms/step
Epoch 12/50
533/533 - 24s - loss: 2.5821 - accuracy50: 0.5775 - val_loss: 3.5305 - val_accuracy50: 0.4296 - 24s/epoch - 46ms/step
testing model: results/QRTEA/W6/deepLOB_L2/h50
Evaluating performance on  test set...
2185/2185 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0251787
{'0': {'precision': 0.3531914279945776, 'recall': 0.36249130441217825, 'f1-score': 0.3577809429896644, 'support': 135126}, '1': {'precision': 0.5547804986810521, 'recall': 0.668082376160289, 'f1-score': 0.6061825596828516, 'support': 286782}, '2': {'precision': 0.376270960873037, 'recall': 0.20597084514122113, 'f1-score': 0.2662153318864256, 'support': 137267}, 'accuracy': 0.4807958152635579, 'macro avg': {'precision': 0.42808096251622224, 'recall': 0.4121815085712295, 'f1-score': 0.41005961151964715, 'support': 559175}, 'weighted avg': {'precision': 0.46224525749202644, 'recall': 0.4807958152635579, 'f1-score': 0.4627001108694826, 'support': 559175}}
[[ 48982  69114  17030]
 [ 65351 191594  29837]
 [ 24351  84643  28273]]
Evaluating performance on  train set...
533/533 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0535413
{'0': {'precision': 0.3096122067944288, 'recall': 0.5201355590006129, 'f1-score': 0.38816692226975547, 'support': 27737}, '1': {'precision': 0.6748912613681297, 'recall': 0.42107860068090985, 'f1-score': 0.518595041322314, 'support': 81068}, '2': {'precision': 0.3280047062434458, 'recall': 0.46685354399504897, 'f1-score': 0.38530180572664724, 'support': 27469}, 'accuracy': 0.4504674405976195, 'macro avg': {'precision': 0.4375027248020014, 'recall': 0.4693559012255239, 'f1-score': 0.4306879231062389, 'support': 136274}, 'weighted avg': {'precision': 0.5306203665574492, 'recall': 0.4504674405976195, 'f1-score': 0.46517974106886745, 'support': 136274}}
[[14427  7581  5729]
 [26388 34136 20544]
 [ 5782  8863 12824]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0769404
{'0': {'precision': 0.3127989149832251, 'recall': 0.4450538289660776, 'f1-score': 0.36738629218193253, 'support': 9846}, '1': {'precision': 0.6777809388335704, 'recall': 0.40896762454080404, 'f1-score': 0.5101280459080982, 'support': 29127}, '2': {'precision': 0.2789746058490793, 'recall': 0.5023296131758587, 'f1-score': 0.3587263512206445, 'support': 9229}, 'accuracy': 0.43421434795236713, 'macro avg': {'precision': 0.42318481988862494, 'recall': 0.4521170222275801, 'f1-score': 0.41208022977022507, 'support': 48202}, 'weighted avg': {'precision': 0.5268702576596695, 'recall': 0.43421434795236713, 'f1-score': 0.45198270863042633, 'support': 48202}}
[[ 4382  2714  2750]
 [ 7983 11912  9232]
 [ 1644  2949  4636]]
training model: results/QRTEA/W6/deepLOB_L2/h100
Epoch 1/50
533/533 - 26s - loss: 3.2570 - accuracy100: 0.4102 - val_loss: 3.5480 - val_accuracy100: 0.4164 - 26s/epoch - 50ms/step
Epoch 2/50
533/533 - 24s - loss: 3.0873 - accuracy100: 0.4628 - val_loss: 3.3059 - val_accuracy100: 0.4160 - 24s/epoch - 46ms/step
Epoch 3/50
533/533 - 24s - loss: 3.0276 - accuracy100: 0.4808 - val_loss: 3.3046 - val_accuracy100: 0.4180 - 24s/epoch - 45ms/step
Epoch 4/50
533/533 - 24s - loss: 2.9886 - accuracy100: 0.4947 - val_loss: 3.2698 - val_accuracy100: 0.4277 - 24s/epoch - 45ms/step
Epoch 5/50
533/533 - 24s - loss: 2.9517 - accuracy100: 0.5073 - val_loss: 3.3322 - val_accuracy100: 0.4343 - 24s/epoch - 45ms/step
Epoch 6/50
533/533 - 24s - loss: 2.9280 - accuracy100: 0.5111 - val_loss: 3.3062 - val_accuracy100: 0.4280 - 24s/epoch - 46ms/step
Epoch 7/50
533/533 - 24s - loss: 2.9082 - accuracy100: 0.5169 - val_loss: 3.3181 - val_accuracy100: 0.4285 - 24s/epoch - 45ms/step
Epoch 8/50
533/533 - 24s - loss: 2.8825 - accuracy100: 0.5242 - val_loss: 3.3719 - val_accuracy100: 0.4330 - 24s/epoch - 46ms/step
Epoch 9/50
533/533 - 24s - loss: 2.8568 - accuracy100: 0.5302 - val_loss: 3.4091 - val_accuracy100: 0.4309 - 24s/epoch - 44ms/step
Epoch 10/50
533/533 - 24s - loss: 2.8382 - accuracy100: 0.5340 - val_loss: 3.4664 - val_accuracy100: 0.4262 - 24s/epoch - 45ms/step
Epoch 11/50
533/533 - 24s - loss: 2.8218 - accuracy100: 0.5382 - val_loss: 3.4526 - val_accuracy100: 0.4233 - 24s/epoch - 45ms/step
Epoch 12/50
533/533 - 25s - loss: 2.7955 - accuracy100: 0.5446 - val_loss: 3.4619 - val_accuracy100: 0.4240 - 25s/epoch - 46ms/step
Epoch 13/50
533/533 - 24s - loss: 2.7852 - accuracy100: 0.5474 - val_loss: 3.5780 - val_accuracy100: 0.4263 - 24s/epoch - 46ms/step
Epoch 14/50
533/533 - 24s - loss: 2.7536 - accuracy100: 0.5523 - val_loss: 3.5890 - val_accuracy100: 0.4297 - 24s/epoch - 45ms/step
testing model: results/QRTEA/W6/deepLOB_L2/h100
Evaluating performance on  test set...
2185/2185 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1361333
{'0': {'precision': 0.40979197566791203, 'recall': 0.49730009911028583, 'f1-score': 0.4493250371834262, 'support': 175562}, '1': {'precision': 0.40695702291290814, 'recall': 0.6668207842288547, 'f1-score': 0.5054442350388394, 'support': 203308}, '2': {'precision': 0.47683189655172414, 'recall': 0.034358448185019826, 'f1-score': 0.0640982529475367, 'support': 180305}, 'accuracy': 0.4096606607949211, 'macro avg': {'precision': 0.43119363171084807, 'recall': 0.3994931105080535, 'f1-score': 0.3396225083899341, 'support': 559175}, 'weighted avg': {'precision': 0.43037813270326125, 'recall': 0.4096606607949211, 'f1-score': 0.34551346933067223, 'support': 559175}}
[[ 87307  85476   2779]
 [ 63720 135570   4018]
 [ 62025 112085   6195]]
Evaluating performance on  train set...
533/533 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0586027
{'0': {'precision': 0.37913251680633575, 'recall': 0.6505319709259454, 'f1-score': 0.4790644454356806, 'support': 37972}, '1': {'precision': 0.5515036552356188, 'recall': 0.42130285416564905, 'f1-score': 0.47769019180712213, 'support': 61419}, '2': {'precision': 0.4385769183091608, 'recall': 0.28777485562454247, 'f1-score': 0.34752144587780753, 'support': 36883}, 'accuracy': 0.4490364999926618, 'macro avg': {'precision': 0.4564043634503718, 'recall': 0.453203226905379, 'f1-score': 0.4347586943735367, 'support': 136274}, 'weighted avg': {'precision': 0.47290939876339894, 'recall': 0.4490364999926618, 'f1-score': 0.44284252682827596, 'support': 136274}}
[[24702  9327  3943]
 [25899 25876  9644]
 [14553 11716 10614]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0963143
{'0': {'precision': 0.37188242280285033, 'recall': 0.5632166679157611, 'f1-score': 0.44797472504545316, 'support': 13343}, '1': {'precision': 0.5461092569822589, 'recall': 0.41401811079545453, 'f1-score': 0.47097735248819655, 'support': 22528}, '2': {'precision': 0.33925790196976635, 'recall': 0.30030005676749655, 'f1-score': 0.31859244601221715, 'support': 12331}, 'accuracy': 0.4262271275050828, 'macro avg': {'precision': 0.4190831939182919, 'recall': 0.4258449451595707, 'f1-score': 0.41251484118195564, 'support': 48202}, 'weighted avg': {'precision': 0.4449642275827549, 'recall': 0.4262271275050828, 'f1-score': 0.42562690354989874, 'support': 48202}}
[[7515 3592 2236]
 [8225 9327 4976]
 [4468 4160 3703]]
training model: results/QRTEA/W6/deepLOB_L2/h200
Epoch 1/50
533/533 - 26s - loss: 3.2886 - accuracy200: 0.3857 - val_loss: 3.3980 - val_accuracy200: 0.3482 - 26s/epoch - 49ms/step
Epoch 2/50
533/533 - 25s - loss: 3.2040 - accuracy200: 0.4183 - val_loss: 3.3008 - val_accuracy200: 0.3926 - 25s/epoch - 46ms/step
Epoch 3/50
533/533 - 24s - loss: 3.1579 - accuracy200: 0.4376 - val_loss: 3.3310 - val_accuracy200: 0.3892 - 24s/epoch - 45ms/step
Epoch 4/50
533/533 - 24s - loss: 3.1204 - accuracy200: 0.4547 - val_loss: 3.2417 - val_accuracy200: 0.4128 - 24s/epoch - 45ms/step
Epoch 5/50
533/533 - 24s - loss: 3.0926 - accuracy200: 0.4648 - val_loss: 3.3012 - val_accuracy200: 0.4088 - 24s/epoch - 45ms/step
Epoch 6/50
533/533 - 24s - loss: 3.0618 - accuracy200: 0.4758 - val_loss: 3.3468 - val_accuracy200: 0.4031 - 24s/epoch - 45ms/step
Epoch 7/50
533/533 - 24s - loss: 3.0248 - accuracy200: 0.4881 - val_loss: 3.3798 - val_accuracy200: 0.3981 - 24s/epoch - 45ms/step
Epoch 8/50
533/533 - 25s - loss: 2.9867 - accuracy200: 0.4968 - val_loss: 3.3962 - val_accuracy200: 0.4000 - 25s/epoch - 46ms/step
Epoch 9/50
533/533 - 24s - loss: 2.9566 - accuracy200: 0.5076 - val_loss: 3.3447 - val_accuracy200: 0.4118 - 24s/epoch - 45ms/step
Epoch 10/50
533/533 - 23s - loss: 2.9318 - accuracy200: 0.5114 - val_loss: 3.3640 - val_accuracy200: 0.4118 - 23s/epoch - 44ms/step
Epoch 11/50
533/533 - 23s - loss: 2.8883 - accuracy200: 0.5241 - val_loss: 3.3980 - val_accuracy200: 0.4100 - 23s/epoch - 44ms/step
Epoch 12/50
533/533 - 23s - loss: 2.8513 - accuracy200: 0.5333 - val_loss: 3.4444 - val_accuracy200: 0.4073 - 23s/epoch - 43ms/step
Epoch 13/50
533/533 - 23s - loss: 2.8188 - accuracy200: 0.5428 - val_loss: 3.4417 - val_accuracy200: 0.4096 - 23s/epoch - 44ms/step
Epoch 14/50
533/533 - 23s - loss: 2.7831 - accuracy200: 0.5497 - val_loss: 3.4898 - val_accuracy200: 0.4082 - 23s/epoch - 44ms/step
testing model: results/QRTEA/W6/deepLOB_L2/h200
Evaluating performance on  test set...
2185/2185 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1061618
{'0': {'precision': 0.4364302157758508, 'recall': 0.18245237857783983, 'f1-score': 0.2573274209939622, 'support': 200540}, '1': {'precision': 0.3320526479149714, 'recall': 0.5216663591554864, 'f1-score': 0.4058025988671604, 'support': 151756}, '2': {'precision': 0.43119312522159003, 'recall': 0.4938152253249484, 'f1-score': 0.46038444985725646, 'support': 206879}, 'accuracy': 0.3897080520409532, 'macro avg': {'precision': 0.3998919963041374, 'recall': 0.39931132101942485, 'f1-score': 0.37450482323945966, 'support': 559175}, 'weighted avg': {'precision': 0.40616533225088897, 'recall': 0.3897080520409532, 'f1-score': 0.3727478782167181, 'support': 559175}}
[[ 36589  84911  79040]
 [ 16866  79166  55724]
 [ 30382  74337 102160]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0727779
{'0': {'precision': 0.4592206082827998, 'recall': 0.21167471994106304, 'f1-score': 0.2897781205505458, 'support': 46151}, '1': {'precision': 0.4342733110895849, 'recall': 0.5190052524386323, 'f1-score': 0.4728735924055826, 'support': 46645}, '2': {'precision': 0.4068686186819678, 'recall': 0.5545103270619623, 'f1-score': 0.4693525936164621, 'support': 43478}, 'accuracy': 0.42625152266756683, 'macro avg': {'precision': 0.4334541793514508, 'recall': 0.4283967664805526, 'f1-score': 0.4106681021908634, 'support': 136274}, 'weighted avg': {'precision': 0.4339786216863656, 'recall': 0.42625152266756683, 'f1-score': 0.4097425101233043, 'support': 136274}}
[[ 9769 17148 19234]
 [ 6524 24209 15912]
 [ 4980 14389 24109]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0841811
{'0': {'precision': 0.42649985783338074, 'recall': 0.1799640071985603, 'f1-score': 0.25312183597705024, 'support': 16670}, '1': {'precision': 0.4594500116522955, 'recall': 0.46798409589935314, 'f1-score': 0.46367778921064234, 'support': 16851}, '2': {'precision': 0.37460423262789533, 'recall': 0.612492337034262, 'f1-score': 0.4648830295980354, 'support': 14681}, 'accuracy': 0.41238952740550183, 'macro avg': {'precision': 0.42018470070452385, 'recall': 0.4201468133773918, 'f1-score': 0.39389421826190935, 'support': 48202}, 'weighted avg': {'precision': 0.4222129686661429, 'recall': 0.41238952740550183, 'f1-score': 0.39122698620917634, 'support': 48202}}
[[3000 5303 8367]
 [2320 7886 6645]
 [1714 3975 8992]]
training model: results/QRTEA/W6/deepLOB_L2/h300
Epoch 1/50
533/533 - 26s - loss: 3.3109 - accuracy300: 0.3776 - val_loss: 3.3784 - val_accuracy300: 0.3599 - 26s/epoch - 49ms/step
Epoch 2/50
533/533 - 23s - loss: 3.2558 - accuracy300: 0.3993 - val_loss: 3.4196 - val_accuracy300: 0.3723 - 23s/epoch - 44ms/step
Epoch 3/50
533/533 - 23s - loss: 3.2226 - accuracy300: 0.4126 - val_loss: 3.4407 - val_accuracy300: 0.3668 - 23s/epoch - 43ms/step
Epoch 4/50
533/533 - 23s - loss: 3.1777 - accuracy300: 0.4355 - val_loss: 3.5244 - val_accuracy300: 0.3446 - 23s/epoch - 43ms/step
Epoch 5/50
533/533 - 23s - loss: 3.1532 - accuracy300: 0.4451 - val_loss: 3.5599 - val_accuracy300: 0.3548 - 23s/epoch - 43ms/step
Epoch 6/50
533/533 - 23s - loss: 3.1208 - accuracy300: 0.4587 - val_loss: 3.5443 - val_accuracy300: 0.3655 - 23s/epoch - 44ms/step
Epoch 7/50
533/533 - 23s - loss: 3.0817 - accuracy300: 0.4745 - val_loss: 3.4869 - val_accuracy300: 0.3778 - 23s/epoch - 43ms/step
Epoch 8/50
533/533 - 24s - loss: 3.0369 - accuracy300: 0.4866 - val_loss: 3.4996 - val_accuracy300: 0.3846 - 24s/epoch - 45ms/step
Epoch 9/50
533/533 - 24s - loss: 3.0040 - accuracy300: 0.5003 - val_loss: 3.4500 - val_accuracy300: 0.3862 - 24s/epoch - 44ms/step
Epoch 10/50
533/533 - 23s - loss: 2.9915 - accuracy300: 0.5006 - val_loss: 3.5135 - val_accuracy300: 0.3808 - 23s/epoch - 43ms/step
Epoch 11/50
533/533 - 23s - loss: 2.9448 - accuracy300: 0.5144 - val_loss: 3.4865 - val_accuracy300: 0.3873 - 23s/epoch - 44ms/step
testing model: results/QRTEA/W6/deepLOB_L2/h300
Evaluating performance on  test set...
2185/2185 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.141646
{'0': {'precision': 0.3523516199961452, 'recall': 0.47237558863699886, 'f1-score': 0.40362995705872545, 'support': 189633}, '1': {'precision': 0.32802764272620294, 'recall': 0.41016050931516806, 'f1-score': 0.36452491045262136, 'support': 170582}, '2': {'precision': 0.37064798751813904, 'recall': 0.17074286288701246, 'f1-score': 0.2337885779369815, 'support': 198960}, 'accuracy': 0.34607233871328297, 'macro avg': {'precision': 0.35034241674682903, 'recall': 0.3510929869463932, 'f1-score': 0.3339811484827761, 'support': 559175}, 'weighted avg': {'precision': 0.3514413729205689, 'recall': 0.34607233871328297, 'f1-score': 0.3312693224627142, 'support': 559175}}
[[89578 68911 31144]
 [74078 69966 26538]
 [90573 74416 33971]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1349111
{'0': {'precision': 0.3616343714578723, 'recall': 0.2853188544660918, 'f1-score': 0.31897546983420416, 'support': 46965}, '1': {'precision': 0.35750894141071493, 'recall': 0.43006364906522365, 'f1-score': 0.3904442632357827, 'support': 45091}, '2': {'precision': 0.3541953844101561, 'recall': 0.36028314261160616, 'f1-score': 0.3572133279519262, 'support': 44218}, 'accuracy': 0.3575370210018052, 'macro avg': {'precision': 0.3577795657595811, 'recall': 0.3585552153809739, 'f1-score': 0.355544353673971, 'support': 136274}, 'weighted avg': {'precision': 0.35785553693674366, 'recall': 0.3575370210018052, 'f1-score': 0.35503077732881066, 'support': 136274}}
[[13400 18015 15550]
 [12202 19392 13497]
 [11452 16835 15931]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1306806
{'0': {'precision': 0.34738099300460673, 'recall': 0.23191707483768084, 'f1-score': 0.27814207650273226, 'support': 17558}, '1': {'precision': 0.37722586691658855, 'recall': 0.4602630074328187, 'f1-score': 0.4146278650527942, 'support': 15741}, '2': {'precision': 0.3389487090424916, 'recall': 0.39287391800308663, 'f1-score': 0.3639245423749884, 'support': 14903}, 'accuracy': 0.3562507779760176, 'macro avg': {'precision': 0.3545185229878956, 'recall': 0.3616846667578621, 'f1-score': 0.35223149464350495, 'support': 48202}, 'weighted avg': {'precision': 0.35452015387679264, 'recall': 0.3562507779760176, 'f1-score': 0.34923536903127383, 'support': 48202}}
[[4072 6850 6636]
 [3713 7245 4783]
 [3937 5111 5855]]
training model: results/QRTEA/W6/deepLOB_L2/h500
Epoch 1/50
533/533 - 26s - loss: 3.2943 - accuracy500: 0.3861 - val_loss: 3.3682 - val_accuracy500: 0.3611 - 26s/epoch - 50ms/step
Epoch 2/50
533/533 - 24s - loss: 3.2715 - accuracy500: 0.3904 - val_loss: 3.3818 - val_accuracy500: 0.3374 - 24s/epoch - 44ms/step
Epoch 3/50
533/533 - 23s - loss: 3.2464 - accuracy500: 0.4013 - val_loss: 3.4296 - val_accuracy500: 0.3481 - 23s/epoch - 44ms/step
Epoch 4/50
533/533 - 23s - loss: 3.2299 - accuracy500: 0.4117 - val_loss: 3.4481 - val_accuracy500: 0.3623 - 23s/epoch - 44ms/step
Epoch 5/50
533/533 - 23s - loss: 3.2055 - accuracy500: 0.4259 - val_loss: 3.5014 - val_accuracy500: 0.3486 - 23s/epoch - 44ms/step
Epoch 6/50
533/533 - 23s - loss: 3.1790 - accuracy500: 0.4345 - val_loss: 3.5354 - val_accuracy500: 0.3595 - 23s/epoch - 44ms/step
Epoch 7/50
533/533 - 23s - loss: 3.1484 - accuracy500: 0.4472 - val_loss: 3.5640 - val_accuracy500: 0.3647 - 23s/epoch - 43ms/step
Epoch 8/50
533/533 - 23s - loss: 3.1218 - accuracy500: 0.4570 - val_loss: 3.6692 - val_accuracy500: 0.3578 - 23s/epoch - 43ms/step
Epoch 9/50
533/533 - 23s - loss: 3.0857 - accuracy500: 0.4705 - val_loss: 3.5355 - val_accuracy500: 0.3589 - 23s/epoch - 43ms/step
Epoch 10/50
533/533 - 23s - loss: 3.0694 - accuracy500: 0.4737 - val_loss: 3.6924 - val_accuracy500: 0.3511 - 23s/epoch - 43ms/step
Epoch 11/50
533/533 - 23s - loss: 3.0250 - accuracy500: 0.4901 - val_loss: 3.6797 - val_accuracy500: 0.3501 - 23s/epoch - 44ms/step
testing model: results/QRTEA/W6/deepLOB_L2/h500
Evaluating performance on  test set...
2185/2185 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1499474
{'0': {'precision': 0.3366784976013105, 'recall': 0.4380575882752951, 'f1-score': 0.380734997044839, 'support': 197054}, '1': {'precision': 0.2721799852236707, 'recall': 0.3709487770812356, 'f1-score': 0.31398015011134633, 'support': 153935}, '2': {'precision': 0.3572104527368534, 'recall': 0.1595544368977741, 'f1-score': 0.220581985284352, 'support': 208186}, 'accuracy': 0.31589395090982253, 'macro avg': {'precision': 0.3220229785206115, 'recall': 0.32285360075143493, 'f1-score': 0.3050990441468458, 'support': 559175}, 'weighted avg': {'precision': 0.3265669709933544, 'recall': 0.31589395090982253, 'f1-score': 0.30273164877448366, 'support': 559175}}
[[86321 75804 34929]
 [71989 57102 24844]
 [98080 76889 33217]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.132966
{'0': {'precision': 0.3578448149415734, 'recall': 0.1533642059384364, 'f1-score': 0.21470898850035203, 'support': 47723}, '1': {'precision': 0.33014575639348437, 'recall': 0.6551866743251005, 'f1-score': 0.4390540561346245, 'support': 43525}, '2': {'precision': 0.34659013720961823, 'recall': 0.22664682627815042, 'f1-score': 0.27407009534040555, 'support': 45026}, 'accuracy': 0.337856084065926, 'macro avg': {'precision': 0.3448602361815587, 'recall': 0.34506590218056243, 'f1-score': 0.3092777133251274, 'support': 136274}, 'weighted avg': {'precision': 0.345279287820739, 'recall': 0.337856084065926, 'f1-score': 0.30597667173678716, 'support': 136274}}
[[ 7319 30125 10279]
 [ 6048 28517  8960]
 [ 7086 27735 10205]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1251208
{'0': {'precision': 0.3219019566589522, 'recall': 0.18527488496003874, 'f1-score': 0.235185612174314, 'support': 16516}, '1': {'precision': 0.3949502461135309, 'recall': 0.6308257918552036, 'f1-score': 0.4857684183017923, 'support': 17680}, '2': {'precision': 0.3196901597016353, 'recall': 0.2386834213908325, 'f1-score': 0.2733107141397212, 'support': 14006}, 'accuracy': 0.36421725239616615, 'macro avg': {'precision': 0.3455141208247061, 'recall': 0.3515946994020249, 'f1-score': 0.3314215815386092, 'support': 48202}, 'weighted avg': {'precision': 0.348052641887216, 'recall': 0.36421725239616615, 'f1-score': 0.33817478669946455, 'support': 48202}}
[[ 3060  9576  3880]
 [ 3293 11153  3234]
 [ 3153  7510  3343]]
training model: results/QRTEA/W6/deepLOB_L2/h1000
Epoch 1/50
533/533 - 26s - loss: 3.2388 - accuracy1000: 0.4207 - val_loss: 3.4443 - val_accuracy1000: 0.3462 - 26s/epoch - 49ms/step
Epoch 2/50
533/533 - 24s - loss: 3.1849 - accuracy1000: 0.4330 - val_loss: 3.4010 - val_accuracy1000: 0.3279 - 24s/epoch - 44ms/step
Epoch 3/50
533/533 - 23s - loss: 3.1855 - accuracy1000: 0.4325 - val_loss: 3.3234 - val_accuracy1000: 0.3596 - 23s/epoch - 44ms/step
Epoch 4/50
533/533 - 23s - loss: 3.1674 - accuracy1000: 0.4453 - val_loss: 3.3757 - val_accuracy1000: 0.3690 - 23s/epoch - 44ms/step
Epoch 5/50
533/533 - 23s - loss: 3.1479 - accuracy1000: 0.4517 - val_loss: 3.4017 - val_accuracy1000: 0.3585 - 23s/epoch - 44ms/step
Epoch 6/50
533/533 - 23s - loss: 3.1221 - accuracy1000: 0.4637 - val_loss: 3.4527 - val_accuracy1000: 0.3408 - 23s/epoch - 43ms/step
Epoch 7/50
533/533 - 24s - loss: 3.1047 - accuracy1000: 0.4654 - val_loss: 3.5044 - val_accuracy1000: 0.3367 - 24s/epoch - 44ms/step
Epoch 8/50
533/533 - 24s - loss: 3.0566 - accuracy1000: 0.4873 - val_loss: 3.5666 - val_accuracy1000: 0.3289 - 24s/epoch - 45ms/step
Epoch 9/50
533/533 - 23s - loss: 3.0154 - accuracy1000: 0.5016 - val_loss: 3.7480 - val_accuracy1000: 0.3145 - 23s/epoch - 44ms/step
Epoch 10/50
533/533 - 23s - loss: 2.9703 - accuracy1000: 0.5129 - val_loss: 3.5902 - val_accuracy1000: 0.3185 - 23s/epoch - 44ms/step
Epoch 11/50
533/533 - 24s - loss: 2.9337 - accuracy1000: 0.5231 - val_loss: 3.6399 - val_accuracy1000: 0.3140 - 24s/epoch - 44ms/step
Epoch 12/50
533/533 - 23s - loss: 2.8893 - accuracy1000: 0.5369 - val_loss: 3.7295 - val_accuracy1000: 0.3259 - 23s/epoch - 43ms/step
Epoch 13/50
533/533 - 23s - loss: 2.8417 - accuracy1000: 0.5491 - val_loss: 3.6913 - val_accuracy1000: 0.3396 - 23s/epoch - 44ms/step
testing model: results/QRTEA/W6/deepLOB_L2/h1000
Evaluating performance on  test set...
2185/2185 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.145645
{'0': {'precision': 0.28339517037899986, 'recall': 0.45539329729436423, 'f1-score': 0.34937270063952797, 'support': 147433}, '1': {'precision': 0.5613373339048435, 'recall': 0.027376985437684746, 'f1-score': 0.05220774664731865, 'support': 239179}, '2': {'precision': 0.32883447039089236, 'recall': 0.5918707950139949, 'f1-score': 0.422779203576455, 'support': 172563}, 'accuracy': 0.3144328698529083, 'macro avg': {'precision': 0.3911889915582452, 'recall': 0.3582136925820146, 'f1-score': 0.27478655028776716, 'support': 559175}, 'weighted avg': {'precision': 0.4163035991497782, 'recall': 0.3144328698529083, 'f1-score': 0.24491815570351028, 'support': 559175}}
[[ 67140   3362  76931]
 [101100   6548 131531]
 [ 68673   1755 102135]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1117525
{'0': {'precision': 0.333562715045355, 'recall': 0.44546555829399725, 'f1-score': 0.3814770430521025, 'support': 47878}, '1': {'precision': 0.4331347236014565, 'recall': 0.060073915937837154, 'f1-score': 0.10551355710109867, 'support': 43563}, '2': {'precision': 0.36969770108007, 'recall': 0.5466509044676912, 'f1-score': 0.44108886389201346, 'support': 44833}, 'accuracy': 0.35555571862570995, 'macro avg': {'precision': 0.3787983799089605, 'recall': 0.3507301262331752, 'f1-score': 0.30935982134840484, 'support': 136274}, 'weighted avg': {'precision': 0.37728121775037454, 'recall': 0.35555571862570995, 'f1-score': 0.31287099512830296, 'support': 136274}}
[[21328  1822 24728]
 [23890  2617 17056]
 [18722  1603 24508]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1141299
{'0': {'precision': 0.38656706373241806, 'recall': 0.29095329753824334, 'f1-score': 0.3320135256206468, 'support': 19742}, '1': {'precision': 0.4071340713407134, 'recall': 0.024962292609351434, 'f1-score': 0.04704043203297093, 'support': 13260}, '2': {'precision': 0.34466646172763604, 'recall': 0.7376315789473684, 'f1-score': 0.46980934422794884, 'support': 15200}, 'accuracy': 0.358636571096635, 'macro avg': {'precision': 0.37945586560025585, 'recall': 0.35118238969832105, 'f1-score': 0.28295443396052217, 'support': 48202}, 'weighted avg': {'precision': 0.3790119699689499, 'recall': 0.358636571096635, 'f1-score': 0.29707209625793174, 'support': 48202}}
[[ 5744   311 13687]
 [ 5298   331  7631]
 [ 3817   171 11212]]
training model: results/QRTEA/W6/deepOF_L2/h10
Epoch 1/50
533/533 - 17s - loss: 2.9803 - accuracy10: 0.4803 - val_loss: 2.7163 - val_accuracy10: 0.6373 - 17s/epoch - 32ms/step
Epoch 2/50
533/533 - 14s - loss: 2.6442 - accuracy10: 0.5571 - val_loss: 2.5721 - val_accuracy10: 0.7003 - 14s/epoch - 26ms/step
Epoch 3/50
533/533 - 14s - loss: 2.4885 - accuracy10: 0.6089 - val_loss: 2.5133 - val_accuracy10: 0.6837 - 14s/epoch - 26ms/step
Epoch 4/50
533/533 - 13s - loss: 2.3924 - accuracy10: 0.6350 - val_loss: 2.4731 - val_accuracy10: 0.6999 - 13s/epoch - 25ms/step
Epoch 5/50
533/533 - 13s - loss: 2.3137 - accuracy10: 0.6583 - val_loss: 2.4491 - val_accuracy10: 0.7171 - 13s/epoch - 25ms/step
Epoch 6/50
533/533 - 13s - loss: 2.2579 - accuracy10: 0.6674 - val_loss: 2.4220 - val_accuracy10: 0.7098 - 13s/epoch - 25ms/step
Epoch 7/50
533/533 - 13s - loss: 2.2236 - accuracy10: 0.6746 - val_loss: 2.4059 - val_accuracy10: 0.7089 - 13s/epoch - 25ms/step
Epoch 8/50
533/533 - 13s - loss: 2.1909 - accuracy10: 0.6775 - val_loss: 2.4157 - val_accuracy10: 0.7026 - 13s/epoch - 25ms/step
Epoch 9/50
533/533 - 13s - loss: 2.1664 - accuracy10: 0.6771 - val_loss: 2.4021 - val_accuracy10: 0.6913 - 13s/epoch - 25ms/step
Epoch 10/50
533/533 - 14s - loss: 2.1509 - accuracy10: 0.6817 - val_loss: 2.3866 - val_accuracy10: 0.7026 - 14s/epoch - 26ms/step
Epoch 11/50
533/533 - 14s - loss: 2.1238 - accuracy10: 0.6854 - val_loss: 2.3751 - val_accuracy10: 0.7041 - 14s/epoch - 25ms/step
Epoch 12/50
533/533 - 14s - loss: 2.1096 - accuracy10: 0.6839 - val_loss: 2.3779 - val_accuracy10: 0.6882 - 14s/epoch - 26ms/step
Epoch 13/50
533/533 - 14s - loss: 2.0942 - accuracy10: 0.6870 - val_loss: 2.3737 - val_accuracy10: 0.6827 - 14s/epoch - 25ms/step
Epoch 14/50
533/533 - 13s - loss: 2.0766 - accuracy10: 0.6888 - val_loss: 2.3721 - val_accuracy10: 0.6829 - 13s/epoch - 25ms/step
Epoch 15/50
533/533 - 13s - loss: 2.0629 - accuracy10: 0.6906 - val_loss: 2.3811 - val_accuracy10: 0.6817 - 13s/epoch - 25ms/step
Epoch 16/50
533/533 - 13s - loss: 2.0486 - accuracy10: 0.6925 - val_loss: 2.3973 - val_accuracy10: 0.6825 - 13s/epoch - 25ms/step
Epoch 17/50
533/533 - 13s - loss: 2.0355 - accuracy10: 0.6917 - val_loss: 2.3780 - val_accuracy10: 0.6922 - 13s/epoch - 24ms/step
Epoch 18/50
533/533 - 13s - loss: 2.0214 - accuracy10: 0.6918 - val_loss: 2.3956 - val_accuracy10: 0.6721 - 13s/epoch - 24ms/step
Epoch 19/50
533/533 - 13s - loss: 2.0058 - accuracy10: 0.6938 - val_loss: 2.3951 - val_accuracy10: 0.6832 - 13s/epoch - 24ms/step
Epoch 20/50
533/533 - 13s - loss: 1.9924 - accuracy10: 0.6956 - val_loss: 2.4170 - val_accuracy10: 0.6688 - 13s/epoch - 24ms/step
Epoch 21/50
533/533 - 13s - loss: 1.9756 - accuracy10: 0.6965 - val_loss: 2.3898 - val_accuracy10: 0.6795 - 13s/epoch - 25ms/step
Epoch 22/50
533/533 - 13s - loss: 1.9672 - accuracy10: 0.6970 - val_loss: 2.4416 - val_accuracy10: 0.6825 - 13s/epoch - 25ms/step
Epoch 23/50
533/533 - 14s - loss: 1.9592 - accuracy10: 0.6960 - val_loss: 2.3980 - val_accuracy10: 0.6668 - 14s/epoch - 25ms/step
Epoch 24/50
533/533 - 13s - loss: 1.9455 - accuracy10: 0.6968 - val_loss: 2.4045 - val_accuracy10: 0.6647 - 13s/epoch - 24ms/step
testing model: results/QRTEA/W6/deepOF_L2/h10
Evaluating performance on  test set...
2185/2185 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8519708
{'0': {'precision': 0.2656747760746275, 'recall': 0.5558627492004663, 'f1-score': 0.3595178719867, 'support': 66914}, '1': {'precision': 0.9073544447207715, 'recall': 0.6189548289503757, 'f1-score': 0.7359077544994475, 'support': 424409}, '2': {'precision': 0.32310884185845623, 'recall': 0.6174628207584713, 'f1-score': 0.42422646744606407, 'support': 67847}, 'accuracy': 0.6112237780996834, 'macro avg': {'precision': 0.49871268755128506, 'recall': 0.5974267996364376, 'f1-score': 0.5065506979774038, 'support': 559170}, 'weighted avg': {'precision': 0.7596772360629616, 'recall': 0.6112237780996834, 'f1-score': 0.6530485294316346, 'support': 559170}}
[[ 37195  14743  14976]
 [ 88932 262690  72787]
 [ 13875  12079  41893]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7653725
{'0': {'precision': 0.292186171720034, 'recall': 0.6105847520355292, 'f1-score': 0.3952374107613435, 'support': 13510}, '1': {'precision': 0.9346756263895482, 'recall': 0.6848231934987921, 'f1-score': 0.790476089872923, 'support': 109272}, '2': {'precision': 0.31790399256532154, 'recall': 0.6593520646452665, 'f1-score': 0.42897795784498144, 'support': 13489}, 'accuracy': 0.6749418438259057, 'macro avg': {'precision': 0.5149219302249679, 'recall': 0.6515866700598626, 'f1-score': 0.5382304861597493, 'support': 136271}, 'weighted avg': {'precision': 0.8099266695224221, 'recall': 0.6749418438259057, 'f1-score': 0.7155083941950287, 'support': 136271}}
[[ 8249  2989  2272]
 [17629 74832 16811]
 [ 2354  2241  8894]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76005054
{'0': {'precision': 0.27238463889171843, 'recall': 0.56105749055812, 'f1-score': 0.36672838236302546, 'support': 4766}, '1': {'precision': 0.927542587282847, 'recall': 0.7056121532500192, 'f1-score': 0.801498236511499, 'support': 38969}, '2': {'precision': 0.3030094976541938, 'recall': 0.5929243170622481, 'f1-score': 0.40106020446800456, 'support': 4466}, 'accuracy': 0.6808779900831933, 'macro avg': {'precision': 0.5009789079429198, 'recall': 0.6198646536234625, 'f1-score': 0.523095607780843, 'support': 48201}, 'weighted avg': {'precision': 0.8048968421673165, 'recall': 0.6808779900831933, 'f1-score': 0.7214071725091366, 'support': 48201}}
[[ 2674  1210   882]
 [ 6263 27497  5209]
 [  880   938  2648]]
training model: results/QRTEA/W6/deepOF_L2/h20
Epoch 1/50
533/533 - 15s - loss: 3.0249 - accuracy20: 0.4532 - val_loss: 2.7807 - val_accuracy20: 0.6044 - 15s/epoch - 28ms/step
Epoch 2/50
533/533 - 14s - loss: 2.7320 - accuracy20: 0.5140 - val_loss: 2.6609 - val_accuracy20: 0.6609 - 14s/epoch - 25ms/step
Epoch 3/50
533/533 - 13s - loss: 2.5869 - accuracy20: 0.5652 - val_loss: 2.6368 - val_accuracy20: 0.6657 - 13s/epoch - 25ms/step
Epoch 4/50
533/533 - 14s - loss: 2.4927 - accuracy20: 0.5959 - val_loss: 2.6252 - val_accuracy20: 0.6650 - 14s/epoch - 26ms/step
Epoch 5/50
533/533 - 13s - loss: 2.4190 - accuracy20: 0.6177 - val_loss: 2.5581 - val_accuracy20: 0.6614 - 13s/epoch - 25ms/step
Epoch 6/50
533/533 - 13s - loss: 2.3562 - accuracy20: 0.6352 - val_loss: 2.5515 - val_accuracy20: 0.6610 - 13s/epoch - 25ms/step
Epoch 7/50
533/533 - 13s - loss: 2.3210 - accuracy20: 0.6451 - val_loss: 2.5420 - val_accuracy20: 0.6908 - 13s/epoch - 25ms/step
Epoch 8/50
533/533 - 13s - loss: 2.2907 - accuracy20: 0.6496 - val_loss: 2.5249 - val_accuracy20: 0.6710 - 13s/epoch - 25ms/step
Epoch 9/50
533/533 - 13s - loss: 2.2671 - accuracy20: 0.6509 - val_loss: 2.5403 - val_accuracy20: 0.6607 - 13s/epoch - 24ms/step
Epoch 10/50
533/533 - 13s - loss: 2.2471 - accuracy20: 0.6537 - val_loss: 2.5445 - val_accuracy20: 0.6719 - 13s/epoch - 24ms/step
Epoch 11/50
533/533 - 13s - loss: 2.2229 - accuracy20: 0.6574 - val_loss: 2.5348 - val_accuracy20: 0.6683 - 13s/epoch - 24ms/step
Epoch 12/50
533/533 - 13s - loss: 2.2051 - accuracy20: 0.6617 - val_loss: 2.5383 - val_accuracy20: 0.6665 - 13s/epoch - 25ms/step
Epoch 13/50
533/533 - 13s - loss: 2.1874 - accuracy20: 0.6639 - val_loss: 2.5395 - val_accuracy20: 0.6626 - 13s/epoch - 24ms/step
Epoch 14/50
533/533 - 13s - loss: 2.1690 - accuracy20: 0.6640 - val_loss: 2.5528 - val_accuracy20: 0.6626 - 13s/epoch - 25ms/step
Epoch 15/50
533/533 - 13s - loss: 2.1529 - accuracy20: 0.6680 - val_loss: 2.5463 - val_accuracy20: 0.6491 - 13s/epoch - 24ms/step
Epoch 16/50
533/533 - 14s - loss: 2.1355 - accuracy20: 0.6681 - val_loss: 2.5572 - val_accuracy20: 0.6657 - 14s/epoch - 26ms/step
Epoch 17/50
533/533 - 13s - loss: 2.1205 - accuracy20: 0.6685 - val_loss: 2.5620 - val_accuracy20: 0.6493 - 13s/epoch - 25ms/step
Epoch 18/50
533/533 - 13s - loss: 2.1000 - accuracy20: 0.6709 - val_loss: 2.5545 - val_accuracy20: 0.6603 - 13s/epoch - 25ms/step
testing model: results/QRTEA/W6/deepOF_L2/h20
Evaluating performance on  test set...
2185/2185 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89722013
{'0': {'precision': 0.34823506000489834, 'recall': 0.5070204372729501, 'f1-score': 0.41288782816229114, 'support': 89738}, '1': {'precision': 0.827792096953145, 'recall': 0.6401056983110445, 'f1-score': 0.7219500430970959, 'support': 378814}, '2': {'precision': 0.380834728480924, 'recall': 0.5698316007857158, 'f1-score': 0.4565464375549828, 'support': 90618}, 'accuracy': 0.6073591215551621, 'macro avg': {'precision': 0.5189539618129891, 'recall': 0.5723192454565701, 'f1-score': 0.5304614362714566, 'support': 559170}, 'weighted avg': {'precision': 0.6783976870279389, 'recall': 0.6073591215551621, 'f1-score': 0.6293396223469936, 'support': 559170}}
[[ 45499  29515  14724]
 [ 67105 242481  69228]
 [ 18052  20929  51637]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81514543
{'0': {'precision': 0.3738975677279019, 'recall': 0.5203941212087851, 'f1-score': 0.4351468286845255, 'support': 18167}, '1': {'precision': 0.8749659392107806, 'recall': 0.7064794535617493, 'f1-score': 0.7817474589306759, 'support': 99993}, '2': {'precision': 0.37136339592700346, 'recall': 0.6202307989619569, 'f1-score': 0.46456709195806367, 'support': 18111}, 'accuracy': 0.6702086283948896, 'macro avg': {'precision': 0.540075634288562, 'recall': 0.6157014579108305, 'f1-score': 0.5604871265244217, 'support': 136271}, 'weighted avg': {'precision': 0.7412349563447127, 'recall': 0.6702086283948896, 'f1-score': 0.6933856851422485, 'support': 136271}}
[[ 9454  6169  2544]
 [12879 70643 16471]
 [ 2952  3926 11233]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8257803
{'0': {'precision': 0.3600411475597211, 'recall': 0.4946608040201005, 'f1-score': 0.4167493550307601, 'support': 6368}, '1': {'precision': 0.8697095998102402, 'recall': 0.7175687765600537, 'f1-score': 0.7863478300831813, 'support': 35768}, '2': {'precision': 0.3579116789055427, 'recall': 0.5866446826051113, 'f1-score': 0.4445832812695239, 'support': 6065}, 'accuracy': 0.6716458164768366, 'macro avg': {'precision': 0.5292208087585014, 'recall': 0.5996247543950884, 'f1-score': 0.5492268221278217, 'support': 48201}, 'weighted avg': {'precision': 0.7379774138759588, 'recall': 0.6716458164768366, 'f1-score': 0.6945156050735622, 'support': 48201}}
[[ 3150  2278   940]
 [ 4659 25666  5443]
 [  940  1567  3558]]
training model: results/QRTEA/W6/deepOF_L2/h30
Epoch 1/50
533/533 - 15s - loss: 3.0668 - accuracy30: 0.4329 - val_loss: 2.8483 - val_accuracy30: 0.5587 - 15s/epoch - 29ms/step
Epoch 2/50
533/533 - 13s - loss: 2.7963 - accuracy30: 0.4906 - val_loss: 2.7396 - val_accuracy30: 0.5785 - 13s/epoch - 25ms/step
Epoch 3/50
533/533 - 13s - loss: 2.6673 - accuracy30: 0.5403 - val_loss: 2.7338 - val_accuracy30: 0.6024 - 13s/epoch - 25ms/step
Epoch 4/50
533/533 - 13s - loss: 2.5773 - accuracy30: 0.5657 - val_loss: 2.6999 - val_accuracy30: 0.6260 - 13s/epoch - 25ms/step
Epoch 5/50
533/533 - 13s - loss: 2.5166 - accuracy30: 0.5896 - val_loss: 2.6735 - val_accuracy30: 0.6200 - 13s/epoch - 25ms/step
Epoch 6/50
533/533 - 13s - loss: 2.4709 - accuracy30: 0.6038 - val_loss: 2.6744 - val_accuracy30: 0.6334 - 13s/epoch - 25ms/step
Epoch 7/50
533/533 - 13s - loss: 2.4384 - accuracy30: 0.6151 - val_loss: 2.6297 - val_accuracy30: 0.6360 - 13s/epoch - 25ms/step
Epoch 8/50
533/533 - 14s - loss: 2.4052 - accuracy30: 0.6227 - val_loss: 2.6900 - val_accuracy30: 0.6212 - 14s/epoch - 25ms/step
Epoch 9/50
533/533 - 13s - loss: 2.3859 - accuracy30: 0.6247 - val_loss: 2.6331 - val_accuracy30: 0.6517 - 13s/epoch - 25ms/step
Epoch 10/50
533/533 - 13s - loss: 2.3629 - accuracy30: 0.6317 - val_loss: 2.6145 - val_accuracy30: 0.6437 - 13s/epoch - 25ms/step
Epoch 11/50
533/533 - 13s - loss: 2.3448 - accuracy30: 0.6328 - val_loss: 2.6313 - val_accuracy30: 0.6242 - 13s/epoch - 25ms/step
Epoch 12/50
533/533 - 13s - loss: 2.3290 - accuracy30: 0.6351 - val_loss: 2.6275 - val_accuracy30: 0.6371 - 13s/epoch - 25ms/step
Epoch 13/50
533/533 - 13s - loss: 2.3101 - accuracy30: 0.6397 - val_loss: 2.6184 - val_accuracy30: 0.6437 - 13s/epoch - 24ms/step
Epoch 14/50
533/533 - 13s - loss: 2.2940 - accuracy30: 0.6400 - val_loss: 2.6310 - val_accuracy30: 0.6424 - 13s/epoch - 24ms/step
Epoch 15/50
533/533 - 13s - loss: 2.2759 - accuracy30: 0.6437 - val_loss: 2.6481 - val_accuracy30: 0.6305 - 13s/epoch - 25ms/step
Epoch 16/50
533/533 - 13s - loss: 2.2600 - accuracy30: 0.6449 - val_loss: 2.6588 - val_accuracy30: 0.6339 - 13s/epoch - 25ms/step
Epoch 17/50
533/533 - 14s - loss: 2.2405 - accuracy30: 0.6476 - val_loss: 2.6391 - val_accuracy30: 0.6250 - 14s/epoch - 26ms/step
Epoch 18/50
533/533 - 13s - loss: 2.2267 - accuracy30: 0.6472 - val_loss: 2.6731 - val_accuracy30: 0.6324 - 13s/epoch - 25ms/step
Epoch 19/50
533/533 - 13s - loss: 2.2125 - accuracy30: 0.6487 - val_loss: 2.6718 - val_accuracy30: 0.6151 - 13s/epoch - 25ms/step
Epoch 20/50
533/533 - 13s - loss: 2.1962 - accuracy30: 0.6512 - val_loss: 2.7219 - val_accuracy30: 0.5890 - 13s/epoch - 24ms/step
testing model: results/QRTEA/W6/deepOF_L2/h30
Evaluating performance on  test set...
2185/2185 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93242383
{'0': {'precision': 0.37421753255328705, 'recall': 0.5271416612408149, 'f1-score': 0.4377070831112862, 'support': 107510}, '1': {'precision': 0.7677225015468864, 'recall': 0.6038121825488179, 'f1-score': 0.6759729879620265, 'support': 343163}, '2': {'precision': 0.4134253313888949, 'recall': 0.5251942450021659, 'f1-score': 0.4626551805331146, 'support': 108497}, 'accuracy': 0.5738165495287658, 'macro avg': {'precision': 0.5184551218296894, 'recall': 0.5520493629305996, 'f1-score': 0.5254450838688092, 'support': 559170}, 'weighted avg': {'precision': 0.6233193696064506, 'recall': 0.5738165495287658, 'f1-score': 0.5887717618892441, 'support': 559170}}
[[ 56673  34085  16752]
 [ 71862 207206  64095]
 [ 22909  28606  56982]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84321755
{'0': {'precision': 0.3969457928802589, 'recall': 0.5400632940421043, 'f1-score': 0.4575747566401772, 'support': 21803}, '1': {'precision': 0.8298830834269106, 'recall': 0.6771297064815514, 'f1-score': 0.7457647240392721, 'support': 92771}, '2': {'precision': 0.40330615942028986, 'recall': 0.5745955662073098, 'f1-score': 0.47394932426010755, 'support': 21697}, 'accuracy': 0.638874008409713, 'macro avg': {'precision': 0.5433783452424864, 'recall': 0.5972628555769885, 'f1-score': 0.5590962683131856, 'support': 136271}, 'weighted avg': {'precision': 0.6926948976356543, 'recall': 0.638874008409713, 'f1-score': 0.6563767795154115, 'support': 136271}}
[[11775  7330  2698]
 [14206 62818 15747]
 [ 3683  5547 12467]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8536215
{'0': {'precision': 0.38615554884797265, 'recall': 0.4988950994410503, 'f1-score': 0.43534482758620685, 'support': 7693}, '1': {'precision': 0.8242529509765695, 'recall': 0.6998856248495063, 'f1-score': 0.7569951981769348, 'support': 33224}, '2': {'precision': 0.38792159984081187, 'recall': 0.535282811641955, 'f1-score': 0.44984136140755704, 'support': 7284}, 'accuracy': 0.6429327192381901, 'macro avg': {'precision': 0.5327766998884513, 'recall': 0.5780211786441706, 'f1-score': 0.5473937957235662, 'support': 48201}, 'weighted avg': {'precision': 0.6883943406521332, 'recall': 0.6429327192381901, 'f1-score': 0.6592427688086101, 'support': 48201}}
[[ 3838  2748  1107]
 [ 4926 23253  5045]
 [ 1175  2210  3899]]
training model: results/QRTEA/W6/deepOF_L2/h50
Epoch 1/50
533/533 - 16s - loss: 3.1359 - accuracy50: 0.4193 - val_loss: 2.9701 - val_accuracy50: 0.5000 - 16s/epoch - 30ms/step
Epoch 2/50
533/533 - 14s - loss: 2.9235 - accuracy50: 0.4645 - val_loss: 2.8900 - val_accuracy50: 0.5096 - 14s/epoch - 26ms/step
Epoch 3/50
533/533 - 14s - loss: 2.8183 - accuracy50: 0.5000 - val_loss: 2.8656 - val_accuracy50: 0.5515 - 14s/epoch - 26ms/step
Epoch 4/50
533/533 - 14s - loss: 2.7449 - accuracy50: 0.5271 - val_loss: 2.8417 - val_accuracy50: 0.5805 - 14s/epoch - 26ms/step
Epoch 5/50
533/533 - 14s - loss: 2.6894 - accuracy50: 0.5474 - val_loss: 2.8283 - val_accuracy50: 0.5825 - 14s/epoch - 26ms/step
Epoch 6/50
533/533 - 14s - loss: 2.6466 - accuracy50: 0.5616 - val_loss: 2.8134 - val_accuracy50: 0.5938 - 14s/epoch - 26ms/step
Epoch 7/50
533/533 - 14s - loss: 2.6122 - accuracy50: 0.5725 - val_loss: 2.8100 - val_accuracy50: 0.5815 - 14s/epoch - 25ms/step
Epoch 8/50
533/533 - 14s - loss: 2.5839 - accuracy50: 0.5820 - val_loss: 2.7888 - val_accuracy50: 0.6044 - 14s/epoch - 26ms/step
Epoch 9/50
533/533 - 14s - loss: 2.5594 - accuracy50: 0.5889 - val_loss: 2.7889 - val_accuracy50: 0.5998 - 14s/epoch - 26ms/step
Epoch 10/50
533/533 - 14s - loss: 2.5367 - accuracy50: 0.5966 - val_loss: 2.7626 - val_accuracy50: 0.6077 - 14s/epoch - 26ms/step
Epoch 11/50
533/533 - 14s - loss: 2.5160 - accuracy50: 0.6007 - val_loss: 2.7654 - val_accuracy50: 0.5940 - 14s/epoch - 26ms/step
Epoch 12/50
533/533 - 14s - loss: 2.4965 - accuracy50: 0.6042 - val_loss: 2.7657 - val_accuracy50: 0.5908 - 14s/epoch - 27ms/step
Epoch 13/50
533/533 - 14s - loss: 2.4773 - accuracy50: 0.6076 - val_loss: 2.7866 - val_accuracy50: 0.5932 - 14s/epoch - 26ms/step
Epoch 14/50
533/533 - 14s - loss: 2.4601 - accuracy50: 0.6101 - val_loss: 2.8121 - val_accuracy50: 0.5869 - 14s/epoch - 26ms/step
Epoch 15/50
533/533 - 14s - loss: 2.4378 - accuracy50: 0.6139 - val_loss: 2.8170 - val_accuracy50: 0.5935 - 14s/epoch - 26ms/step
Epoch 16/50
533/533 - 14s - loss: 2.4213 - accuracy50: 0.6157 - val_loss: 2.8490 - val_accuracy50: 0.5613 - 14s/epoch - 26ms/step
Epoch 17/50
533/533 - 14s - loss: 2.4006 - accuracy50: 0.6198 - val_loss: 2.8081 - val_accuracy50: 0.5826 - 14s/epoch - 27ms/step
Epoch 18/50
533/533 - 14s - loss: 2.3778 - accuracy50: 0.6229 - val_loss: 2.8462 - val_accuracy50: 0.5716 - 14s/epoch - 26ms/step
Epoch 19/50
533/533 - 14s - loss: 2.3668 - accuracy50: 0.6238 - val_loss: 2.8572 - val_accuracy50: 0.5606 - 14s/epoch - 26ms/step
Epoch 20/50
533/533 - 14s - loss: 2.3478 - accuracy50: 0.6259 - val_loss: 2.8465 - val_accuracy50: 0.5721 - 14s/epoch - 26ms/step
testing model: results/QRTEA/W6/deepOF_L2/h50
Evaluating performance on  test set...
2185/2185 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9524698
{'0': {'precision': 0.4307911357745245, 'recall': 0.4366318095364964, 'f1-score': 0.43369180896654635, 'support': 135123}, '1': {'precision': 0.6409976692882845, 'recall': 0.6454031285087628, 'f1-score': 0.6431928553432893, 'support': 286782}, '2': {'precision': 0.4606254963959779, 'recall': 0.44786362146213526, 'f1-score': 0.45415492359461745, 'support': 137265}, 'accuracy': 0.5464617200493589, 'macro avg': {'precision': 0.510804767152929, 'recall': 0.5099661865024648, 'f1-score': 0.5103465293014844, 'support': 559170}, 'weighted avg': {'precision': 0.5459236779438951, 'recall': 0.5464617200493589, 'f1-score': 0.5461620747380243, 'support': 559170}}
[[ 58999  56803  19321]
 [ 49027 185090  52665]
 [ 28929  46860  61476]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8761702
{'0': {'precision': 0.4642676676532159, 'recall': 0.46234858560080516, 'f1-score': 0.4633061393556288, 'support': 27821}, '1': {'precision': 0.7320392057026477, 'recall': 0.7098123920019748, 'f1-score': 0.7207544805113422, 'support': 81020}, '2': {'precision': 0.4619896683886019, 'recall': 0.5053590958804229, 'f1-score': 0.48270218507878476, 'support': 27430}, 'accuracy': 0.6181359203352144, 'macro avg': {'precision': 0.5527655139148218, 'recall': 0.5591733578277344, 'f1-score': 0.5555876016485852, 'support': 136271}, 'weighted avg': {'precision': 0.6230128481607091, 'recall': 0.6181359203352144, 'f1-score': 0.6202764274919312, 'support': 136271}}
[[12863 11934  3024]
 [10392 57509 13119]
 [ 4451  9117 13862]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9001757
{'0': {'precision': 0.4342377796188898, 'recall': 0.42521042490619615, 'f1-score': 0.42967669211456677, 'support': 9861}, '1': {'precision': 0.7264383799756648, 'recall': 0.7181002783600811, 'f1-score': 0.7222452647587445, 'support': 29099}, '2': {'precision': 0.438241308793456, 'recall': 0.46380261876420303, 'f1-score': 0.4506597970664003, 'support': 9241}, 'accuracy': 0.609427190307255, 'macro avg': {'precision': 0.5329724894626703, 'recall': 0.5357044406768268, 'f1-score': 0.5341939179799039, 'support': 48201}, 'weighted avg': {'precision': 0.6114071720149803, 'recall': 0.609427190307255, 'f1-score': 0.6103235203594749, 'support': 48201}}
[[ 4193  4437  1231]
 [ 3940 20896  4263]
 [ 1523  3432  4286]]
training model: results/QRTEA/W6/deepOF_L2/h100
Epoch 1/50
533/533 - 16s - loss: 3.2321 - accuracy100: 0.3963 - val_loss: 3.1106 - val_accuracy100: 0.4344 - 16s/epoch - 31ms/step
Epoch 2/50
533/533 - 13s - loss: 3.0998 - accuracy100: 0.4380 - val_loss: 3.0486 - val_accuracy100: 0.4632 - 13s/epoch - 25ms/step
Epoch 3/50
533/533 - 13s - loss: 3.0304 - accuracy100: 0.4631 - val_loss: 3.0243 - val_accuracy100: 0.4831 - 13s/epoch - 25ms/step
Epoch 4/50
533/533 - 14s - loss: 2.9786 - accuracy100: 0.4826 - val_loss: 3.0173 - val_accuracy100: 0.5066 - 14s/epoch - 26ms/step
Epoch 5/50
533/533 - 14s - loss: 2.9408 - accuracy100: 0.4962 - val_loss: 3.0085 - val_accuracy100: 0.5155 - 14s/epoch - 25ms/step
Epoch 6/50
533/533 - 14s - loss: 2.9117 - accuracy100: 0.5044 - val_loss: 3.0011 - val_accuracy100: 0.5135 - 14s/epoch - 26ms/step
Epoch 7/50
533/533 - 14s - loss: 2.8851 - accuracy100: 0.5118 - val_loss: 2.9921 - val_accuracy100: 0.5210 - 14s/epoch - 26ms/step
Epoch 8/50
533/533 - 13s - loss: 2.8642 - accuracy100: 0.5169 - val_loss: 2.9874 - val_accuracy100: 0.5243 - 13s/epoch - 25ms/step
Epoch 9/50
533/533 - 14s - loss: 2.8429 - accuracy100: 0.5223 - val_loss: 2.9719 - val_accuracy100: 0.5306 - 14s/epoch - 25ms/step
Epoch 10/50
533/533 - 13s - loss: 2.8241 - accuracy100: 0.5294 - val_loss: 2.9705 - val_accuracy100: 0.5299 - 13s/epoch - 25ms/step
Epoch 11/50
533/533 - 13s - loss: 2.8042 - accuracy100: 0.5349 - val_loss: 2.9615 - val_accuracy100: 0.5341 - 13s/epoch - 25ms/step
Epoch 12/50
533/533 - 13s - loss: 2.7873 - accuracy100: 0.5401 - val_loss: 2.9566 - val_accuracy100: 0.5347 - 13s/epoch - 25ms/step
Epoch 13/50
533/533 - 14s - loss: 2.7663 - accuracy100: 0.5443 - val_loss: 2.9552 - val_accuracy100: 0.5324 - 14s/epoch - 26ms/step
Epoch 14/50
533/533 - 13s - loss: 2.7492 - accuracy100: 0.5486 - val_loss: 2.9695 - val_accuracy100: 0.5287 - 13s/epoch - 25ms/step
Epoch 15/50
533/533 - 13s - loss: 2.7336 - accuracy100: 0.5538 - val_loss: 2.9573 - val_accuracy100: 0.5306 - 13s/epoch - 25ms/step
Epoch 16/50
533/533 - 13s - loss: 2.7111 - accuracy100: 0.5588 - val_loss: 2.9624 - val_accuracy100: 0.5319 - 13s/epoch - 25ms/step
Epoch 17/50
533/533 - 13s - loss: 2.6973 - accuracy100: 0.5623 - val_loss: 2.9670 - val_accuracy100: 0.5264 - 13s/epoch - 25ms/step
Epoch 18/50
533/533 - 13s - loss: 2.6759 - accuracy100: 0.5680 - val_loss: 2.9826 - val_accuracy100: 0.5254 - 13s/epoch - 25ms/step
Epoch 19/50
533/533 - 13s - loss: 2.6528 - accuracy100: 0.5752 - val_loss: 2.9832 - val_accuracy100: 0.5212 - 13s/epoch - 25ms/step
Epoch 20/50
533/533 - 13s - loss: 2.6283 - accuracy100: 0.5831 - val_loss: 3.0223 - val_accuracy100: 0.5207 - 13s/epoch - 25ms/step
Epoch 21/50
533/533 - 13s - loss: 2.6119 - accuracy100: 0.5860 - val_loss: 3.0308 - val_accuracy100: 0.5163 - 13s/epoch - 25ms/step
Epoch 22/50
533/533 - 14s - loss: 2.5811 - accuracy100: 0.5954 - val_loss: 3.0582 - val_accuracy100: 0.5108 - 14s/epoch - 26ms/step
Epoch 23/50
533/533 - 13s - loss: 2.5630 - accuracy100: 0.5984 - val_loss: 3.0446 - val_accuracy100: 0.5155 - 13s/epoch - 25ms/step
testing model: results/QRTEA/W6/deepOF_L2/h100
Evaluating performance on  test set...
2185/2185 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0229647
{'0': {'precision': 0.46212842340014687, 'recall': 0.387151897652641, 'f1-score': 0.42133060579292386, 'support': 175559}, '1': {'precision': 0.45325109853815443, 'recall': 0.6209986818029787, 'f1-score': 0.5240277258954883, 'support': 203308}, '2': {'precision': 0.4743151967171377, 'recall': 0.3513030842526192, 'f1-score': 0.40364511144036064, 'support': 180303}, 'accuracy': 0.46061662821682137, 'macro avg': {'precision': 0.4632315728851463, 'recall': 0.4531512212360796, 'f1-score': 0.44966781437625764, 'support': 559170}, 'weighted avg': {'precision': 0.46283032197541274, 'recall': 0.46061662821682137, 'f1-score': 0.4529674933326022, 'support': 559170}}
[[ 67968  78839  28752]
 [ 35605 126254  41449]
 [ 43503  73459  63341]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9445459
{'0': {'precision': 0.5001223220214588, 'recall': 0.37650959033862186, 'f1-score': 0.42960072050435305, 'support': 38007}, '1': {'precision': 0.5686910492105297, 'recall': 0.7140553220604047, 'f1-score': 0.6331366502242476, 'support': 61386}, '2': {'precision': 0.5008338510840064, 'recall': 0.41531536417376214, 'f1-score': 0.45408322091937325, 'support': 36878}, 'accuracy': 0.5390655385225029, 'macro avg': {'precision': 0.5232157407719983, 'recall': 0.5019600921909296, 'f1-score': 0.505606863882658, 'support': 136271}, 'weighted avg': {'precision': 0.531203033662211, 'recall': 0.5390655385225029, 'f1-score': 0.5279130703960436, 'support': 136271}}
[[14310 18863  4834]
 [ 7122 43833 10431]
 [ 7181 14381 15316]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.96298176
{'0': {'precision': 0.4764386989157631, 'recall': 0.342091473912718, 'f1-score': 0.39823972811642194, 'support': 13359}, '1': {'precision': 0.5720009588712716, 'recall': 0.7425535698408464, 'f1-score': 0.6462133668633331, 'support': 22494}, '2': {'precision': 0.460671768707483, 'recall': 0.3509880142533204, 'f1-score': 0.3984188269902555, 'support': 12348}, 'accuracy': 0.5312545382875874, 'macro avg': {'precision': 0.5030371421648393, 'recall': 0.4785443526689616, 'f1-score': 0.48095730732333686, 'support': 48201}, 'weighted avg': {'precision': 0.5169956878003789, 'recall': 0.5312545382875874, 'f1-score': 0.5140076695049226, 'support': 48201}}
[[ 4570  6938  1851]
 [ 2568 16703  3223]
 [ 2454  5560  4334]]
training model: results/QRTEA/W6/deepOF_L2/h200
Epoch 1/50
533/533 - 16s - loss: 3.2839 - accuracy200: 0.3751 - val_loss: 3.2145 - val_accuracy200: 0.3937 - 16s/epoch - 29ms/step
Epoch 2/50
533/533 - 13s - loss: 3.2028 - accuracy200: 0.4103 - val_loss: 3.1718 - val_accuracy200: 0.4067 - 13s/epoch - 25ms/step
Epoch 3/50
533/533 - 13s - loss: 3.1584 - accuracy200: 0.4272 - val_loss: 3.1551 - val_accuracy200: 0.4132 - 13s/epoch - 25ms/step
Epoch 4/50
533/533 - 13s - loss: 3.1305 - accuracy200: 0.4392 - val_loss: 3.1520 - val_accuracy200: 0.4130 - 13s/epoch - 25ms/step
Epoch 5/50
533/533 - 13s - loss: 3.1092 - accuracy200: 0.4475 - val_loss: 3.1484 - val_accuracy200: 0.4163 - 13s/epoch - 25ms/step
Epoch 6/50
533/533 - 13s - loss: 3.0956 - accuracy200: 0.4528 - val_loss: 3.1395 - val_accuracy200: 0.4200 - 13s/epoch - 25ms/step
Epoch 7/50
533/533 - 14s - loss: 3.0789 - accuracy200: 0.4596 - val_loss: 3.1396 - val_accuracy200: 0.4229 - 14s/epoch - 26ms/step
Epoch 8/50
533/533 - 14s - loss: 3.0687 - accuracy200: 0.4615 - val_loss: 3.1327 - val_accuracy200: 0.4234 - 14s/epoch - 26ms/step
Epoch 9/50
533/533 - 13s - loss: 3.0554 - accuracy200: 0.4674 - val_loss: 3.1294 - val_accuracy200: 0.4237 - 13s/epoch - 25ms/step
Epoch 10/50
533/533 - 14s - loss: 3.0437 - accuracy200: 0.4710 - val_loss: 3.1251 - val_accuracy200: 0.4274 - 14s/epoch - 25ms/step
Epoch 11/50
533/533 - 13s - loss: 3.0319 - accuracy200: 0.4742 - val_loss: 3.1154 - val_accuracy200: 0.4284 - 13s/epoch - 25ms/step
Epoch 12/50
533/533 - 14s - loss: 3.0194 - accuracy200: 0.4774 - val_loss: 3.1125 - val_accuracy200: 0.4292 - 14s/epoch - 26ms/step
Epoch 13/50
533/533 - 13s - loss: 3.0059 - accuracy200: 0.4830 - val_loss: 3.1207 - val_accuracy200: 0.4292 - 13s/epoch - 25ms/step
Epoch 14/50
533/533 - 13s - loss: 2.9948 - accuracy200: 0.4867 - val_loss: 3.1198 - val_accuracy200: 0.4301 - 13s/epoch - 25ms/step
Epoch 15/50
533/533 - 13s - loss: 2.9812 - accuracy200: 0.4922 - val_loss: 3.1273 - val_accuracy200: 0.4308 - 13s/epoch - 24ms/step
Epoch 16/50
533/533 - 14s - loss: 2.9720 - accuracy200: 0.4952 - val_loss: 3.1254 - val_accuracy200: 0.4329 - 14s/epoch - 25ms/step
Epoch 17/50
533/533 - 14s - loss: 2.9546 - accuracy200: 0.5007 - val_loss: 3.1265 - val_accuracy200: 0.4304 - 14s/epoch - 25ms/step
Epoch 18/50
533/533 - 13s - loss: 2.9395 - accuracy200: 0.5058 - val_loss: 3.1150 - val_accuracy200: 0.4339 - 13s/epoch - 25ms/step
Epoch 19/50
533/533 - 13s - loss: 2.9250 - accuracy200: 0.5105 - val_loss: 3.1561 - val_accuracy200: 0.4259 - 13s/epoch - 25ms/step
Epoch 20/50
533/533 - 13s - loss: 2.9125 - accuracy200: 0.5167 - val_loss: 3.2019 - val_accuracy200: 0.4235 - 13s/epoch - 25ms/step
Epoch 21/50
533/533 - 13s - loss: 2.8999 - accuracy200: 0.5200 - val_loss: 3.1579 - val_accuracy200: 0.4297 - 13s/epoch - 25ms/step
Epoch 22/50
533/533 - 13s - loss: 2.8827 - accuracy200: 0.5234 - val_loss: 3.1712 - val_accuracy200: 0.4321 - 13s/epoch - 25ms/step
testing model: results/QRTEA/W6/deepOF_L2/h200
Evaluating performance on  test set...
2185/2185 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.075477
{'0': {'precision': 0.4721004673157783, 'recall': 0.2110782548856321, 'f1-score': 0.2917249601995879, 'support': 200537}, '1': {'precision': 0.313532961478804, 'recall': 0.7419146524684361, 'f1-score': 0.44078871386708995, 'support': 151756}, '2': {'precision': 0.49384102601260776, 'recall': 0.2635575728573017, 'f1-score': 0.3436910033566037, 'support': 206877}, 'accuracy': 0.37456050932632295, 'macro avg': {'precision': 0.42649148493573, 'recall': 0.40551682673712325, 'f1-score': 0.35873489247442714, 'support': 559170}, 'weighted avg': {'precision': 0.4371094111892481, 'recall': 0.37456050932632295, 'f1-score': 0.35140609136141593, 'support': 559170}}
[[ 42329 125270  32938]
 [ 16220 112590  22946]
 [ 31112 121241  54524]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0270807
{'0': {'precision': 0.5279718386135933, 'recall': 0.21131003988208774, 'f1-score': 0.3018219532205384, 'support': 46136}, '1': {'precision': 0.4017385526825757, 'recall': 0.7776515476292549, 'f1-score': 0.5297867213797031, 'support': 46652}, '2': {'precision': 0.5145994691102141, 'recall': 0.32546052480279647, 'f1-score': 0.3987377437168939, 'support': 43483}, 'accuracy': 0.44162000719155214, 'macro avg': {'precision': 0.481436620135461, 'recall': 0.438140704104713, 'f1-score': 0.4101154727723784, 'support': 136271}, 'weighted avg': {'precision': 0.48048920475628487, 'recall': 0.44162000719155214, 'f1-score': 0.4107901246019356, 'support': 136271}}
[[ 9749 29697  6690]
 [ 3714 36279  6659]
 [ 5002 24329 14152]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0356373
{'0': {'precision': 0.5127278699293808, 'recall': 0.18740620685515338, 'f1-score': 0.27448566906980837, 'support': 16659}, '1': {'precision': 0.4029367178907945, 'recall': 0.8040809063408269, 'f1-score': 0.5368500257415548, 'support': 16859}, '2': {'precision': 0.4814027630180659, 'recall': 0.2776680514881155, 'f1-score': 0.352194194885971, 'support': 14683}, 'accuracy': 0.43059272629198564, 'macro avg': {'precision': 0.4656891169460804, 'recall': 0.4230517215613652, 'f1-score': 0.3878432965657781, 'support': 48201}, 'weighted avg': {'precision': 0.4647845580271928, 'recall': 0.43059272629198564, 'f1-score': 0.38992300384891443, 'support': 48201}}
[[ 3122 11158  2379]
 [ 1290 13556  2013]
 [ 1677  8929  4077]]
training model: results/QRTEA/W6/deepOF_L2/h300
Epoch 1/50
533/533 - 15s - loss: 3.3134 - accuracy300: 0.3549 - val_loss: 3.2691 - val_accuracy300: 0.3662 - 15s/epoch - 28ms/step
Epoch 2/50
533/533 - 13s - loss: 3.2675 - accuracy300: 0.3814 - val_loss: 3.2447 - val_accuracy300: 0.3831 - 13s/epoch - 25ms/step
Epoch 3/50
533/533 - 13s - loss: 3.2441 - accuracy300: 0.3952 - val_loss: 3.2294 - val_accuracy300: 0.3910 - 13s/epoch - 25ms/step
Epoch 4/50
533/533 - 13s - loss: 3.2281 - accuracy300: 0.4063 - val_loss: 3.2257 - val_accuracy300: 0.3882 - 13s/epoch - 25ms/step
Epoch 5/50
533/533 - 13s - loss: 3.2162 - accuracy300: 0.4119 - val_loss: 3.2219 - val_accuracy300: 0.3852 - 13s/epoch - 25ms/step
Epoch 6/50
533/533 - 13s - loss: 3.2082 - accuracy300: 0.4185 - val_loss: 3.2223 - val_accuracy300: 0.3822 - 13s/epoch - 24ms/step
Epoch 7/50
533/533 - 14s - loss: 3.1980 - accuracy300: 0.4235 - val_loss: 3.2176 - val_accuracy300: 0.3878 - 14s/epoch - 25ms/step
Epoch 8/50
533/533 - 13s - loss: 3.1897 - accuracy300: 0.4280 - val_loss: 3.2156 - val_accuracy300: 0.3902 - 13s/epoch - 25ms/step
Epoch 9/50
533/533 - 13s - loss: 3.1824 - accuracy300: 0.4309 - val_loss: 3.2136 - val_accuracy300: 0.3901 - 13s/epoch - 24ms/step
Epoch 10/50
533/533 - 13s - loss: 3.1770 - accuracy300: 0.4319 - val_loss: 3.2154 - val_accuracy300: 0.3887 - 13s/epoch - 24ms/step
Epoch 11/50
533/533 - 13s - loss: 3.1684 - accuracy300: 0.4353 - val_loss: 3.2129 - val_accuracy300: 0.3937 - 13s/epoch - 25ms/step
Epoch 12/50
533/533 - 13s - loss: 3.1601 - accuracy300: 0.4402 - val_loss: 3.2120 - val_accuracy300: 0.3917 - 13s/epoch - 25ms/step
Epoch 13/50
533/533 - 13s - loss: 3.1514 - accuracy300: 0.4435 - val_loss: 3.2101 - val_accuracy300: 0.3923 - 13s/epoch - 25ms/step
Epoch 14/50
533/533 - 13s - loss: 3.1427 - accuracy300: 0.4467 - val_loss: 3.2143 - val_accuracy300: 0.3928 - 13s/epoch - 24ms/step
Epoch 15/50
533/533 - 13s - loss: 3.1348 - accuracy300: 0.4497 - val_loss: 3.2249 - val_accuracy300: 0.3896 - 13s/epoch - 25ms/step
Epoch 16/50
533/533 - 13s - loss: 3.1271 - accuracy300: 0.4550 - val_loss: 3.2190 - val_accuracy300: 0.3924 - 13s/epoch - 25ms/step
Epoch 17/50
533/533 - 13s - loss: 3.1202 - accuracy300: 0.4571 - val_loss: 3.2151 - val_accuracy300: 0.3993 - 13s/epoch - 24ms/step
Epoch 18/50
533/533 - 13s - loss: 3.1094 - accuracy300: 0.4608 - val_loss: 3.2112 - val_accuracy300: 0.3993 - 13s/epoch - 24ms/step
Epoch 19/50
533/533 - 13s - loss: 3.1023 - accuracy300: 0.4648 - val_loss: 3.2142 - val_accuracy300: 0.3984 - 13s/epoch - 25ms/step
Epoch 20/50
533/533 - 13s - loss: 3.0954 - accuracy300: 0.4674 - val_loss: 3.2052 - val_accuracy300: 0.4067 - 13s/epoch - 25ms/step
Epoch 21/50
533/533 - 14s - loss: 3.0965 - accuracy300: 0.4672 - val_loss: 3.1946 - val_accuracy300: 0.4123 - 14s/epoch - 25ms/step
Epoch 22/50
533/533 - 13s - loss: 3.1001 - accuracy300: 0.4657 - val_loss: 3.2295 - val_accuracy300: 0.3967 - 13s/epoch - 25ms/step
Epoch 23/50
533/533 - 13s - loss: 3.0709 - accuracy300: 0.4775 - val_loss: 3.2292 - val_accuracy300: 0.4028 - 13s/epoch - 25ms/step
Epoch 24/50
533/533 - 13s - loss: 3.0507 - accuracy300: 0.4844 - val_loss: 3.2173 - val_accuracy300: 0.4132 - 13s/epoch - 25ms/step
Epoch 25/50
533/533 - 13s - loss: 3.0400 - accuracy300: 0.4871 - val_loss: 3.2377 - val_accuracy300: 0.4047 - 13s/epoch - 25ms/step
Epoch 26/50
533/533 - 13s - loss: 3.0140 - accuracy300: 0.4971 - val_loss: 3.3120 - val_accuracy300: 0.3867 - 13s/epoch - 24ms/step
Epoch 27/50
533/533 - 13s - loss: 2.9957 - accuracy300: 0.5009 - val_loss: 3.2885 - val_accuracy300: 0.3976 - 13s/epoch - 25ms/step
Epoch 28/50
533/533 - 13s - loss: 2.9780 - accuracy300: 0.5073 - val_loss: 3.3728 - val_accuracy300: 0.3822 - 13s/epoch - 25ms/step
Epoch 29/50
533/533 - 13s - loss: 2.9453 - accuracy300: 0.5152 - val_loss: 3.3763 - val_accuracy300: 0.3867 - 13s/epoch - 25ms/step
Epoch 30/50
533/533 - 13s - loss: 2.9297 - accuracy300: 0.5204 - val_loss: 3.3930 - val_accuracy300: 0.3853 - 13s/epoch - 25ms/step
Epoch 31/50
533/533 - 13s - loss: 2.9042 - accuracy300: 0.5261 - val_loss: 3.3766 - val_accuracy300: 0.3897 - 13s/epoch - 24ms/step
testing model: results/QRTEA/W6/deepOF_L2/h300
Evaluating performance on  test set...
2185/2185 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1039898
{'0': {'precision': 0.3973338521269127, 'recall': 0.2477139693086537, 'f1-score': 0.3051716241193037, 'support': 189630}, '1': {'precision': 0.3150308102891127, 'recall': 0.47263486182598397, 'f1-score': 0.37806533599998127, 'support': 170582}, '2': {'precision': 0.4107855112254494, 'recall': 0.3820203258979282, 'f1-score': 0.3958810783782658, 'support': 198958}, 'accuracy': 0.36411645832215606, 'macro avg': {'precision': 0.37438339121382497, 'recall': 0.367456385677522, 'f1-score': 0.3597060128325169, 'support': 559170}, 'weighted avg': {'precision': 0.3770124788560846, 'recall': 0.36411645832215606, 'f1-score': 0.359684074287382, 'support': 559170}}
[[46974 87533 55123]
 [36062 80623 53897]
 [35187 87765 76006]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0591625
{'0': {'precision': 0.48211397404551437, 'recall': 0.27296347566819296, 'f1-score': 0.3485722056023932, 'support': 46955}, '1': {'precision': 0.3747871582923129, 'recall': 0.5363876027382086, 'f1-score': 0.4412571418157297, 'support': 45139}, '2': {'precision': 0.45712447875077633, 'recall': 0.4665097222536614, 'f1-score': 0.46176941777484004, 'support': 44177}, 'accuracy': 0.42296600157040015, 'macro avg': {'precision': 0.4380085370295346, 'recall': 0.4252869335533543, 'f1-score': 0.4171995883976543, 'support': 136271}, 'weighted avg': {'precision': 0.43846135485346766, 'recall': 0.42296600157040015, 'f1-score': 0.41597039434303484, 'support': 136271}}
[[12817 22882 11256]
 [ 7708 24212 13219]
 [ 6060 17508 20609]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0667403
{'0': {'precision': 0.4915542455503911, 'recall': 0.24700922866583114, 'f1-score': 0.3287962085308057, 'support': 17554}, '1': {'precision': 0.3869216636044764, 'recall': 0.5888034568215035, 'f1-score': 0.46697744739826136, 'support': 15737}, '2': {'precision': 0.4073354069466045, 'recall': 0.4215962441314554, 'f1-score': 0.4143431547030519, 'support': 14910}, 'accuracy': 0.4126055476027468, 'macro avg': {'precision': 0.428603772033824, 'recall': 0.41913630987293, 'f1-score': 0.4033722702107063, 'support': 48201}, 'weighted avg': {'precision': 0.431341680963239, 'recall': 0.4126055476027468, 'f1-score': 0.40037279664070674, 'support': 48201}}
[[4336 8321 4897]
 [2222 9266 4249]
 [2263 6361 6286]]
training model: results/QRTEA/W6/deepOF_L2/h500
Epoch 1/50
533/533 - 16s - loss: 3.3142 - accuracy500: 0.3634 - val_loss: 3.3043 - val_accuracy500: 0.3442 - 16s/epoch - 31ms/step
Epoch 2/50
533/533 - 13s - loss: 3.2844 - accuracy500: 0.3780 - val_loss: 3.2916 - val_accuracy500: 0.3462 - 13s/epoch - 25ms/step
Epoch 3/50
533/533 - 14s - loss: 3.2722 - accuracy500: 0.3852 - val_loss: 3.2836 - val_accuracy500: 0.3490 - 14s/epoch - 26ms/step
Epoch 4/50
533/533 - 13s - loss: 3.2661 - accuracy500: 0.3900 - val_loss: 3.2780 - val_accuracy500: 0.3567 - 13s/epoch - 25ms/step
Epoch 5/50
533/533 - 13s - loss: 3.2598 - accuracy500: 0.3930 - val_loss: 3.2778 - val_accuracy500: 0.3595 - 13s/epoch - 25ms/step
Epoch 6/50
533/533 - 14s - loss: 3.2537 - accuracy500: 0.3959 - val_loss: 3.2718 - val_accuracy500: 0.3622 - 14s/epoch - 27ms/step
Epoch 7/50
533/533 - 13s - loss: 3.2478 - accuracy500: 0.4014 - val_loss: 3.2724 - val_accuracy500: 0.3636 - 13s/epoch - 24ms/step
Epoch 8/50
533/533 - 13s - loss: 3.2437 - accuracy500: 0.4022 - val_loss: 3.2718 - val_accuracy500: 0.3646 - 13s/epoch - 25ms/step
Epoch 9/50
533/533 - 13s - loss: 3.2402 - accuracy500: 0.4025 - val_loss: 3.2695 - val_accuracy500: 0.3632 - 13s/epoch - 25ms/step
Epoch 10/50
533/533 - 13s - loss: 3.2356 - accuracy500: 0.4067 - val_loss: 3.2689 - val_accuracy500: 0.3659 - 13s/epoch - 25ms/step
Epoch 11/50
533/533 - 13s - loss: 3.2323 - accuracy500: 0.4089 - val_loss: 3.2715 - val_accuracy500: 0.3674 - 13s/epoch - 25ms/step
Epoch 12/50
533/533 - 13s - loss: 3.2267 - accuracy500: 0.4129 - val_loss: 3.2682 - val_accuracy500: 0.3655 - 13s/epoch - 25ms/step
Epoch 13/50
533/533 - 13s - loss: 3.2232 - accuracy500: 0.4129 - val_loss: 3.2658 - val_accuracy500: 0.3690 - 13s/epoch - 25ms/step
Epoch 14/50
533/533 - 13s - loss: 3.2180 - accuracy500: 0.4158 - val_loss: 3.2688 - val_accuracy500: 0.3709 - 13s/epoch - 25ms/step
Epoch 15/50
533/533 - 13s - loss: 3.2137 - accuracy500: 0.4194 - val_loss: 3.2694 - val_accuracy500: 0.3698 - 13s/epoch - 25ms/step
Epoch 16/50
533/533 - 14s - loss: 3.2081 - accuracy500: 0.4227 - val_loss: 3.2735 - val_accuracy500: 0.3650 - 14s/epoch - 25ms/step
Epoch 17/50
533/533 - 13s - loss: 3.2025 - accuracy500: 0.4251 - val_loss: 3.2728 - val_accuracy500: 0.3706 - 13s/epoch - 25ms/step
Epoch 18/50
533/533 - 14s - loss: 3.1945 - accuracy500: 0.4290 - val_loss: 3.2836 - val_accuracy500: 0.3666 - 14s/epoch - 26ms/step
Epoch 19/50
533/533 - 13s - loss: 3.1902 - accuracy500: 0.4322 - val_loss: 3.2863 - val_accuracy500: 0.3673 - 13s/epoch - 24ms/step
Epoch 20/50
533/533 - 13s - loss: 3.1844 - accuracy500: 0.4336 - val_loss: 3.2903 - val_accuracy500: 0.3648 - 13s/epoch - 25ms/step
Epoch 21/50
533/533 - 13s - loss: 3.1769 - accuracy500: 0.4362 - val_loss: 3.3065 - val_accuracy500: 0.3636 - 13s/epoch - 25ms/step
Epoch 22/50
533/533 - 14s - loss: 3.1711 - accuracy500: 0.4398 - val_loss: 3.3182 - val_accuracy500: 0.3618 - 14s/epoch - 26ms/step
Epoch 23/50
533/533 - 14s - loss: 3.1589 - accuracy500: 0.4468 - val_loss: 3.3187 - val_accuracy500: 0.3570 - 14s/epoch - 25ms/step
testing model: results/QRTEA/W6/deepOF_L2/h500
Evaluating performance on  test set...
2185/2185 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1022316
{'0': {'precision': 0.3938449664197588, 'recall': 0.3470015376729882, 'f1-score': 0.36894230639526254, 'support': 197051}, '1': {'precision': 0.2868081634360911, 'recall': 0.3562282781693572, 'f1-score': 0.3177710363371377, 'support': 153935}, '2': {'precision': 0.41048661775449935, 'recall': 0.383233101487146, 'f1-score': 0.39639196514187197, 'support': 208184}, 'accuracy': 0.36303092082908595, 'macro avg': {'precision': 0.3637132492034498, 'recall': 0.3621543057764971, 'f1-score': 0.3610351026247574, 'support': 559170}, 'weighted avg': {'precision': 0.370574432010153, 'recall': 0.36303092082908595, 'f1-score': 0.3650750214910415, 'support': 559170}}
[[68377 66271 62403]
 [46923 54836 52176]
 [58314 70087 79783]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0815027
{'0': {'precision': 0.43208449491172, 'recall': 0.39945521215295965, 'f1-score': 0.4151296735840428, 'support': 47725}, '1': {'precision': 0.3436937985316209, 'recall': 0.373185076272744, 'f1-score': 0.3578328248394665, 'support': 43528}, '2': {'precision': 0.40617550738521174, 'recall': 0.40499355813230264, 'f1-score': 0.40558367165341197, 'support': 45018}, 'accuracy': 0.39289357236682787, 'macro avg': {'precision': 0.3939846002761842, 'recall': 0.39254461551933545, 'f1-score': 0.39284872335897375, 'support': 136271}, 'weighted avg': {'precision': 0.3952913325183912, 'recall': 0.39289357236682787, 'f1-score': 0.39367419775230267, 'support': 136271}}
[[19064 15741 12920]
 [13549 16244 13735]
 [11508 15278 18232]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.088449
{'0': {'precision': 0.37733324839141236, 'recall': 0.35875227135069654, 'f1-score': 0.3678082404446238, 'support': 16510}, '1': {'precision': 0.37030695854225265, 'recall': 0.3423596585448584, 'f1-score': 0.3557853303175396, 'support': 17689}, '2': {'precision': 0.35678018575851395, 'recall': 0.4115126410512784, 'f1-score': 0.3821968691960732, 'support': 14002}, 'accuracy': 0.3680629032592685, 'macro avg': {'precision': 0.368140130897393, 'recall': 0.37087485698227773, 'f1-score': 0.36859681331941224, 'support': 48201}, 'weighted avg': {'precision': 0.36878421363844804, 'recall': 0.3680629032592685, 'f1-score': 0.3675758038258774, 'support': 48201}}
[[5923 5582 5005]
 [6250 6056 5383]
 [3524 4716 5762]]
training model: results/QRTEA/W6/deepOF_L2/h1000
Epoch 1/50
533/533 - 16s - loss: 3.2944 - accuracy1000: 0.3839 - val_loss: 3.3105 - val_accuracy1000: 0.3317 - 16s/epoch - 30ms/step
Epoch 2/50
533/533 - 14s - loss: 3.2705 - accuracy1000: 0.4015 - val_loss: 3.3027 - val_accuracy1000: 0.3333 - 14s/epoch - 25ms/step
Epoch 3/50
533/533 - 13s - loss: 3.2613 - accuracy1000: 0.4016 - val_loss: 3.2955 - val_accuracy1000: 0.3401 - 13s/epoch - 24ms/step
Epoch 4/50
533/533 - 13s - loss: 3.2550 - accuracy1000: 0.4021 - val_loss: 3.2934 - val_accuracy1000: 0.3466 - 13s/epoch - 24ms/step
Epoch 5/50
533/533 - 13s - loss: 3.2482 - accuracy1000: 0.4029 - val_loss: 3.2897 - val_accuracy1000: 0.3452 - 13s/epoch - 25ms/step
Epoch 6/50
533/533 - 13s - loss: 3.2444 - accuracy1000: 0.4047 - val_loss: 3.2901 - val_accuracy1000: 0.3456 - 13s/epoch - 25ms/step
Epoch 7/50
533/533 - 13s - loss: 3.2395 - accuracy1000: 0.4049 - val_loss: 3.2857 - val_accuracy1000: 0.3482 - 13s/epoch - 24ms/step
Epoch 8/50
533/533 - 13s - loss: 3.2335 - accuracy1000: 0.4063 - val_loss: 3.2875 - val_accuracy1000: 0.3487 - 13s/epoch - 25ms/step
Epoch 9/50
533/533 - 13s - loss: 3.2290 - accuracy1000: 0.4089 - val_loss: 3.2869 - val_accuracy1000: 0.3471 - 13s/epoch - 25ms/step
Epoch 10/50
533/533 - 14s - loss: 3.2245 - accuracy1000: 0.4102 - val_loss: 3.2839 - val_accuracy1000: 0.3498 - 14s/epoch - 25ms/step
Epoch 11/50
533/533 - 13s - loss: 3.2185 - accuracy1000: 0.4116 - val_loss: 3.2868 - val_accuracy1000: 0.3514 - 13s/epoch - 25ms/step
Epoch 12/50
533/533 - 14s - loss: 3.2118 - accuracy1000: 0.4169 - val_loss: 3.2874 - val_accuracy1000: 0.3532 - 14s/epoch - 27ms/step
Epoch 13/50
533/533 - 14s - loss: 3.2063 - accuracy1000: 0.4193 - val_loss: 3.2842 - val_accuracy1000: 0.3582 - 14s/epoch - 26ms/step
Epoch 14/50
533/533 - 14s - loss: 3.2025 - accuracy1000: 0.4229 - val_loss: 3.2824 - val_accuracy1000: 0.3615 - 14s/epoch - 27ms/step
Epoch 15/50
533/533 - 14s - loss: 3.2002 - accuracy1000: 0.4258 - val_loss: 3.2846 - val_accuracy1000: 0.3560 - 14s/epoch - 25ms/step
Epoch 16/50
533/533 - 14s - loss: 3.1990 - accuracy1000: 0.4295 - val_loss: 3.2853 - val_accuracy1000: 0.3592 - 14s/epoch - 26ms/step
Epoch 17/50
533/533 - 14s - loss: 3.1917 - accuracy1000: 0.4313 - val_loss: 3.2869 - val_accuracy1000: 0.3594 - 14s/epoch - 26ms/step
Epoch 18/50
533/533 - 14s - loss: 3.1859 - accuracy1000: 0.4350 - val_loss: 3.2861 - val_accuracy1000: 0.3645 - 14s/epoch - 26ms/step
Epoch 19/50
533/533 - 14s - loss: 3.1780 - accuracy1000: 0.4385 - val_loss: 3.2844 - val_accuracy1000: 0.3640 - 14s/epoch - 26ms/step
Epoch 20/50
533/533 - 14s - loss: 3.1730 - accuracy1000: 0.4406 - val_loss: 3.2894 - val_accuracy1000: 0.3689 - 14s/epoch - 26ms/step
Epoch 21/50
533/533 - 14s - loss: 3.1667 - accuracy1000: 0.4431 - val_loss: 3.2905 - val_accuracy1000: 0.3694 - 14s/epoch - 26ms/step
Epoch 22/50
533/533 - 14s - loss: 3.1646 - accuracy1000: 0.4442 - val_loss: 3.3004 - val_accuracy1000: 0.3633 - 14s/epoch - 26ms/step
Epoch 23/50
533/533 - 13s - loss: 3.1572 - accuracy1000: 0.4477 - val_loss: 3.2901 - val_accuracy1000: 0.3708 - 13s/epoch - 25ms/step
Epoch 24/50
533/533 - 14s - loss: 3.1537 - accuracy1000: 0.4485 - val_loss: 3.2889 - val_accuracy1000: 0.3717 - 14s/epoch - 26ms/step
testing model: results/QRTEA/W6/deepOF_L2/h1000
Evaluating performance on  test set...
2185/2185 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1475497
{'0': {'precision': 0.2717008626719515, 'recall': 0.31616824141462785, 'f1-score': 0.29225275948224244, 'support': 147431}, '1': {'precision': 0.39093041438623927, 'recall': 0.008362008052613754, 'f1-score': 0.0163737806650211, 'support': 239177}, '2': {'precision': 0.32317108242220793, 'recall': 0.7163280444130226, 'f1-score': 0.44540010377331296, 'support': 172562}, 'accuracy': 0.3079993561886367, 'macro avg': {'precision': 0.32860078649346625, 'recall': 0.34695276462675473, 'f1-score': 0.2513422146401922, 'support': 559170}, 'weighted avg': {'precision': 0.33858351115257806, 'recall': 0.3079993561886367, 'f1-score': 0.22151131324762535, 'support': 559170}}
[[ 46613   1542  99276]
 [ 77570   2000 159607]
 [ 47377   1574 123611]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.10069
{'0': {'precision': 0.4005290876877897, 'recall': 0.34463819567714316, 'f1-score': 0.37048760775862066, 'support': 47885}, '1': {'precision': 0.4614722341799397, 'recall': 0.024606909216113852, 'f1-score': 0.046722454672245464, 'support': 43565}, '2': {'precision': 0.35660143403957084, 'recall': 0.7378907208674506, 'f1-score': 0.4808310192925577, 'support': 44821}, 'accuracy': 0.3716711552714811, 'macro avg': {'precision': 0.40620091863576674, 'recall': 0.36904527525356917, 'f1-score': 0.2993470272411413, 'support': 136271}, 'weighted avg': {'precision': 0.4055639580032912, 'recall': 0.3716711552714811, 'f1-score': 0.30327501780297833, 'support': 136271}}
[[16503   599 30783]
 [13604  1072 28889]
 [11096   652 33073]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0962445
{'0': {'precision': 0.41307085570358587, 'recall': 0.3157841398530529, 'f1-score': 0.35793463902130834, 'support': 19735}, '1': {'precision': 0.28508124076809455, 'recall': 0.014540797106908762, 'f1-score': 0.02767025089605735, 'support': 13273}, '2': {'precision': 0.33850232758886456, 'recall': 0.7227012439939445, 'f1-score': 0.46105395758975437, 'support': 15193}, 'accuracy': 0.3610920935250306, 'macro avg': {'precision': 0.34555147468684827, 'recall': 0.35100872698463537, 'f1-score': 0.2822196158357067, 'support': 48201}, 'weighted avg': {'precision': 0.3543225764835336, 'recall': 0.3610920935250306, 'f1-score': 0.299493788902513, 'support': 48201}}
[[ 6232   222 13281]
 [ 4904   193  8176]
 [ 3951   262 10980]]
training model: results/QRTEA/W6/deepVOL_L2/h10
Epoch 1/50
533/533 - 16s - loss: 2.7799 - accuracy10: 0.5338 - val_loss: 2.7625 - val_accuracy10: 0.3950 - 16s/epoch - 31ms/step
Epoch 2/50
533/533 - 13s - loss: 2.4791 - accuracy10: 0.6218 - val_loss: 2.5690 - val_accuracy10: 0.4820 - 13s/epoch - 25ms/step
Epoch 3/50
533/533 - 13s - loss: 2.3820 - accuracy10: 0.6427 - val_loss: 2.5220 - val_accuracy10: 0.4793 - 13s/epoch - 25ms/step
Epoch 4/50
533/533 - 13s - loss: 2.3405 - accuracy10: 0.6531 - val_loss: 2.5032 - val_accuracy10: 0.5303 - 13s/epoch - 25ms/step
Epoch 5/50
533/533 - 13s - loss: 2.3122 - accuracy10: 0.6637 - val_loss: 2.5079 - val_accuracy10: 0.4816 - 13s/epoch - 24ms/step
Epoch 6/50
533/533 - 13s - loss: 2.2875 - accuracy10: 0.6644 - val_loss: 2.4571 - val_accuracy10: 0.5358 - 13s/epoch - 24ms/step
Epoch 7/50
533/533 - 13s - loss: 2.2665 - accuracy10: 0.6731 - val_loss: 2.4644 - val_accuracy10: 0.5378 - 13s/epoch - 24ms/step
Epoch 8/50
533/533 - 13s - loss: 2.2460 - accuracy10: 0.6782 - val_loss: 2.4553 - val_accuracy10: 0.5381 - 13s/epoch - 25ms/step
Epoch 9/50
533/533 - 13s - loss: 2.2305 - accuracy10: 0.6823 - val_loss: 2.4459 - val_accuracy10: 0.5392 - 13s/epoch - 25ms/step
Epoch 10/50
533/533 - 13s - loss: 2.2159 - accuracy10: 0.6852 - val_loss: 2.4299 - val_accuracy10: 0.5542 - 13s/epoch - 24ms/step
Epoch 11/50
533/533 - 14s - loss: 2.2063 - accuracy10: 0.6893 - val_loss: 2.4256 - val_accuracy10: 0.5599 - 14s/epoch - 25ms/step
Epoch 12/50
533/533 - 13s - loss: 2.1944 - accuracy10: 0.6918 - val_loss: 2.3939 - val_accuracy10: 0.5930 - 13s/epoch - 25ms/step
Epoch 13/50
533/533 - 13s - loss: 2.1808 - accuracy10: 0.6926 - val_loss: 2.4392 - val_accuracy10: 0.5536 - 13s/epoch - 25ms/step
Epoch 14/50
533/533 - 13s - loss: 2.1713 - accuracy10: 0.6955 - val_loss: 2.4218 - val_accuracy10: 0.5747 - 13s/epoch - 24ms/step
Epoch 15/50
533/533 - 13s - loss: 2.1585 - accuracy10: 0.6983 - val_loss: 2.4086 - val_accuracy10: 0.5915 - 13s/epoch - 25ms/step
Epoch 16/50
533/533 - 14s - loss: 2.1481 - accuracy10: 0.6978 - val_loss: 2.3963 - val_accuracy10: 0.5981 - 14s/epoch - 26ms/step
Epoch 17/50
533/533 - 13s - loss: 2.1334 - accuracy10: 0.6995 - val_loss: 2.4131 - val_accuracy10: 0.5969 - 13s/epoch - 24ms/step
Epoch 18/50
533/533 - 14s - loss: 2.1265 - accuracy10: 0.7008 - val_loss: 2.3983 - val_accuracy10: 0.5857 - 14s/epoch - 27ms/step
Epoch 19/50
533/533 - 14s - loss: 2.1155 - accuracy10: 0.7013 - val_loss: 2.4381 - val_accuracy10: 0.5661 - 14s/epoch - 26ms/step
Epoch 20/50
533/533 - 13s - loss: 2.1086 - accuracy10: 0.7000 - val_loss: 2.4149 - val_accuracy10: 0.5996 - 13s/epoch - 24ms/step
Epoch 21/50
533/533 - 13s - loss: 2.1041 - accuracy10: 0.6972 - val_loss: 2.4186 - val_accuracy10: 0.5776 - 13s/epoch - 24ms/step
Epoch 22/50
533/533 - 13s - loss: 2.0947 - accuracy10: 0.6986 - val_loss: 2.4160 - val_accuracy10: 0.5819 - 13s/epoch - 24ms/step
testing model: results/QRTEA/W6/deepVOL_L2/h10
Evaluating performance on  test set...
2185/2185 - 23s - 23s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91692984
{'0': {'precision': 0.26113676234757244, 'recall': 0.7251886721960696, 'f1-score': 0.38399784759892536, 'support': 66915}, '1': {'precision': 0.9182670050923487, 'recall': 0.5421455667868335, 'f1-score': 0.6817722546675319, 'support': 424410}, '2': {'precision': 0.3196119794424037, 'recall': 0.578349299926308, 'f1-score': 0.41170453293604786, 'support': 67850}, 'accuracy': 0.5684427951893415, 'macro avg': {'precision': 0.4996719156274416, 'recall': 0.6152278463030704, 'f1-score': 0.49249154506750165, 'support': 559175}, 'weighted avg': {'precision': 0.7669894735796461, 'recall': 0.5684427951893415, 'f1-score': 0.613368500264211, 'support': 559175}}
[[ 48526   8916   9473]
 [120255 230092  74063]
 [ 17045  11564  39241]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8927096
{'0': {'precision': 0.2506668800682885, 'recall': 0.6964351886163196, 'f1-score': 0.3686471430532944, 'support': 13493}, '1': {'precision': 0.945563645338434, 'recall': 0.561012218002105, 'f1-score': 0.7042098188899037, 'support': 109265}, '2': {'precision': 0.268066435007951, 'recall': 0.6734980763539509, 'f1-score': 0.38349412309895947, 'support': 13516}, 'accuracy': 0.5855775863334165, 'macro avg': {'precision': 0.4880989868048912, 'recall': 0.6436484943241252, 'f1-score': 0.48545036168071926, 'support': 136274}, 'weighted avg': {'precision': 0.8095634226355202, 'recall': 0.5855775863334165, 'f1-score': 0.6391751055229096, 'support': 136274}}
[[ 9397  1916  2180]
 [25291 61299 22675]
 [ 2800  1613  9103]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8912641
{'0': {'precision': 0.2554682881513386, 'recall': 0.6377819945182374, 'f1-score': 0.36480945489628563, 'support': 4743}, '1': {'precision': 0.9409170342015478, 'recall': 0.5796677945247616, 'f1-score': 0.7173809599340165, 'support': 39012}, '2': {'precision': 0.2371217652307942, 'recall': 0.6572970541938385, 'f1-score': 0.34851555979492077, 'support': 4447}, 'accuracy': 0.5925480270528194, 'macro avg': {'precision': 0.4778356958612269, 'recall': 0.6249156144122792, 'f1-score': 0.47690199154174095, 'support': 48202}, 'weighted avg': {'precision': 0.8085395195003094, 'recall': 0.5925480270528194, 'f1-score': 0.6486578554401674, 'support': 48202}}
[[ 3025   778   940]
 [ 7934 22614  8464]
 [  882   642  2923]]
training model: results/QRTEA/W6/deepVOL_L2/h20
Epoch 1/50
533/533 - 15s - loss: 2.8951 - accuracy20: 0.4873 - val_loss: 2.8998 - val_accuracy20: 0.3389 - 15s/epoch - 29ms/step
Epoch 2/50
533/533 - 13s - loss: 2.5689 - accuracy20: 0.5990 - val_loss: 2.7433 - val_accuracy20: 0.3983 - 13s/epoch - 25ms/step
Epoch 3/50
533/533 - 13s - loss: 2.4952 - accuracy20: 0.6202 - val_loss: 2.6683 - val_accuracy20: 0.4576 - 13s/epoch - 24ms/step
Epoch 4/50
533/533 - 14s - loss: 2.4412 - accuracy20: 0.6335 - val_loss: 2.6217 - val_accuracy20: 0.4766 - 14s/epoch - 25ms/step
Epoch 5/50
533/533 - 14s - loss: 2.4099 - accuracy20: 0.6401 - val_loss: 2.6076 - val_accuracy20: 0.5066 - 14s/epoch - 25ms/step
Epoch 6/50
533/533 - 14s - loss: 2.3806 - accuracy20: 0.6468 - val_loss: 2.6041 - val_accuracy20: 0.4770 - 14s/epoch - 25ms/step
Epoch 7/50
533/533 - 13s - loss: 2.3582 - accuracy20: 0.6526 - val_loss: 2.5878 - val_accuracy20: 0.5142 - 13s/epoch - 24ms/step
Epoch 8/50
533/533 - 13s - loss: 2.3457 - accuracy20: 0.6559 - val_loss: 2.5991 - val_accuracy20: 0.4986 - 13s/epoch - 24ms/step
Epoch 9/50
533/533 - 12s - loss: 2.3316 - accuracy20: 0.6586 - val_loss: 2.5912 - val_accuracy20: 0.5000 - 12s/epoch - 23ms/step
Epoch 10/50
533/533 - 13s - loss: 2.3228 - accuracy20: 0.6628 - val_loss: 2.6029 - val_accuracy20: 0.5178 - 13s/epoch - 24ms/step
Epoch 11/50
533/533 - 13s - loss: 2.3080 - accuracy20: 0.6641 - val_loss: 2.5855 - val_accuracy20: 0.5184 - 13s/epoch - 24ms/step
Epoch 12/50
533/533 - 13s - loss: 2.2994 - accuracy20: 0.6654 - val_loss: 2.6158 - val_accuracy20: 0.5361 - 13s/epoch - 23ms/step
Epoch 13/50
533/533 - 13s - loss: 2.2871 - accuracy20: 0.6657 - val_loss: 2.6058 - val_accuracy20: 0.5440 - 13s/epoch - 24ms/step
Epoch 14/50
533/533 - 13s - loss: 2.2748 - accuracy20: 0.6710 - val_loss: 2.5925 - val_accuracy20: 0.5449 - 13s/epoch - 24ms/step
Epoch 15/50
533/533 - 13s - loss: 2.2606 - accuracy20: 0.6707 - val_loss: 2.6167 - val_accuracy20: 0.5376 - 13s/epoch - 24ms/step
Epoch 16/50
533/533 - 13s - loss: 2.2484 - accuracy20: 0.6689 - val_loss: 2.5943 - val_accuracy20: 0.5598 - 13s/epoch - 25ms/step
Epoch 17/50
533/533 - 14s - loss: 2.2358 - accuracy20: 0.6740 - val_loss: 2.5923 - val_accuracy20: 0.5591 - 14s/epoch - 25ms/step
Epoch 18/50
533/533 - 14s - loss: 2.2329 - accuracy20: 0.6706 - val_loss: 2.5938 - val_accuracy20: 0.5431 - 14s/epoch - 26ms/step
Epoch 19/50
533/533 - 13s - loss: 2.2166 - accuracy20: 0.6746 - val_loss: 2.6471 - val_accuracy20: 0.5418 - 13s/epoch - 24ms/step
Epoch 20/50
533/533 - 13s - loss: 2.2091 - accuracy20: 0.6740 - val_loss: 2.5875 - val_accuracy20: 0.5758 - 13s/epoch - 24ms/step
Epoch 21/50
533/533 - 13s - loss: 2.1958 - accuracy20: 0.6748 - val_loss: 2.6330 - val_accuracy20: 0.5581 - 13s/epoch - 24ms/step
testing model: results/QRTEA/W6/deepVOL_L2/h20
Evaluating performance on  test set...
2185/2185 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93294686
{'0': {'precision': 0.35209945452238994, 'recall': 0.6185870291954535, 'f1-score': 0.4487631366208569, 'support': 89740}, '1': {'precision': 0.8550235561907786, 'recall': 0.5116679953750389, 'f1-score': 0.6402149607105462, 'support': 378814}, '2': {'precision': 0.32620421798047167, 'recall': 0.629302258858322, 'f1-score': 0.4296800831813867, 'support': 90621}, 'accuracy': 0.5478910895515715, 'macro avg': {'precision': 0.5111090762312134, 'recall': 0.5865190944762714, 'f1-score': 0.5062193935042633, 'support': 559175}, 'weighted avg': {'precision': 0.6886095603367482, 'recall': 0.5478910895515715, 'f1-score': 0.5753698445476657, 'support': 559175}}
[[ 55512  17431  16797]
 [ 83989 193827 100998]
 [ 18159  15434  57028]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9331468
{'0': {'precision': 0.3460679039165787, 'recall': 0.6149900727994706, 'f1-score': 0.44290423799499545, 'support': 18132}, '1': {'precision': 0.9018014382154388, 'recall': 0.49150152972464956, 'f1-score': 0.636238918009448, 'support': 100018}, '2': {'precision': 0.2623132821962051, 'recall': 0.7170050761421319, 'f1-score': 0.38410380704658315, 'support': 18124}, 'accuracy': 0.5379235951098522, 'macro avg': {'precision': 0.5033942081094075, 'recall': 0.607832226222084, 'f1-score': 0.48774898768367553, 'support': 136274}, 'weighted avg': {'precision': 0.742808205584126, 'recall': 0.5379235951098522, 'f1-score': 0.5769815309135014, 'support': 136274}}
[[11151  3328  3653]
 [17967 49159 32892]
 [ 3104  2025 12995]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94855374
{'0': {'precision': 0.3326249653515661, 'recall': 0.5671077504725898, 'f1-score': 0.4193116300739619, 'support': 6348}, '1': {'precision': 0.8914220869654923, 'recall': 0.48245442617459033, 'f1-score': 0.626068685697725, 'support': 35821}, '2': {'precision': 0.23271453979546466, 'recall': 0.6940162439913807, 'f1-score': 0.34855359001040587, 'support': 6033}, 'accuracy': 0.5200821542674577, 'macro avg': {'precision': 0.485587197370841, 'recall': 0.5811928068795202, 'f1-score': 0.4646446352606975, 'support': 48202}, 'weighted avg': {'precision': 0.7353865125063, 'recall': 0.5200821542674577, 'f1-score': 0.5641056476208559, 'support': 48202}}
[[ 3600  1247  1501]
 [ 6235 17282 12304]
 [  988   858  4187]]
training model: results/QRTEA/W6/deepVOL_L2/h30
Epoch 1/50
533/533 - 16s - loss: 2.9416 - accuracy30: 0.4819 - val_loss: 2.9781 - val_accuracy30: 0.3624 - 16s/epoch - 30ms/step
Epoch 2/50
533/533 - 13s - loss: 2.6791 - accuracy30: 0.5721 - val_loss: 2.8230 - val_accuracy30: 0.4177 - 13s/epoch - 25ms/step
Epoch 3/50
533/533 - 13s - loss: 2.6035 - accuracy30: 0.5946 - val_loss: 2.7941 - val_accuracy30: 0.4629 - 13s/epoch - 25ms/step
Epoch 4/50
533/533 - 13s - loss: 2.5546 - accuracy30: 0.6073 - val_loss: 2.7776 - val_accuracy30: 0.4423 - 13s/epoch - 25ms/step
Epoch 5/50
533/533 - 13s - loss: 2.5161 - accuracy30: 0.6168 - val_loss: 2.7641 - val_accuracy30: 0.4375 - 13s/epoch - 25ms/step
Epoch 6/50
533/533 - 14s - loss: 2.4912 - accuracy30: 0.6201 - val_loss: 2.7205 - val_accuracy30: 0.4614 - 14s/epoch - 26ms/step
Epoch 7/50
533/533 - 15s - loss: 2.4714 - accuracy30: 0.6235 - val_loss: 2.6889 - val_accuracy30: 0.5045 - 15s/epoch - 28ms/step
Epoch 8/50
533/533 - 13s - loss: 2.4557 - accuracy30: 0.6279 - val_loss: 2.6983 - val_accuracy30: 0.4959 - 13s/epoch - 24ms/step
Epoch 9/50
533/533 - 13s - loss: 2.4394 - accuracy30: 0.6321 - val_loss: 2.6766 - val_accuracy30: 0.5060 - 13s/epoch - 24ms/step
Epoch 10/50
533/533 - 13s - loss: 2.4243 - accuracy30: 0.6360 - val_loss: 2.6789 - val_accuracy30: 0.5240 - 13s/epoch - 24ms/step
Epoch 11/50
533/533 - 13s - loss: 2.4130 - accuracy30: 0.6389 - val_loss: 2.6822 - val_accuracy30: 0.4967 - 13s/epoch - 25ms/step
Epoch 12/50
533/533 - 13s - loss: 2.3995 - accuracy30: 0.6385 - val_loss: 2.6752 - val_accuracy30: 0.5111 - 13s/epoch - 24ms/step
Epoch 13/50
533/533 - 13s - loss: 2.3890 - accuracy30: 0.6425 - val_loss: 2.6625 - val_accuracy30: 0.5209 - 13s/epoch - 25ms/step
Epoch 14/50
533/533 - 13s - loss: 2.3802 - accuracy30: 0.6427 - val_loss: 2.6669 - val_accuracy30: 0.5112 - 13s/epoch - 25ms/step
Epoch 15/50
533/533 - 13s - loss: 2.3664 - accuracy30: 0.6463 - val_loss: 2.6572 - val_accuracy30: 0.5181 - 13s/epoch - 25ms/step
Epoch 16/50
533/533 - 13s - loss: 2.3561 - accuracy30: 0.6470 - val_loss: 2.6762 - val_accuracy30: 0.4976 - 13s/epoch - 24ms/step
Epoch 17/50
533/533 - 13s - loss: 2.3472 - accuracy30: 0.6500 - val_loss: 2.6671 - val_accuracy30: 0.5130 - 13s/epoch - 24ms/step
Epoch 18/50
533/533 - 13s - loss: 2.3386 - accuracy30: 0.6490 - val_loss: 2.6677 - val_accuracy30: 0.4991 - 13s/epoch - 24ms/step
Epoch 19/50
533/533 - 13s - loss: 2.3308 - accuracy30: 0.6510 - val_loss: 2.6875 - val_accuracy30: 0.4921 - 13s/epoch - 24ms/step
Epoch 20/50
533/533 - 13s - loss: 2.3216 - accuracy30: 0.6517 - val_loss: 2.6852 - val_accuracy30: 0.5016 - 13s/epoch - 24ms/step
Epoch 21/50
533/533 - 13s - loss: 2.3104 - accuracy30: 0.6523 - val_loss: 2.7004 - val_accuracy30: 0.4955 - 13s/epoch - 24ms/step
Epoch 22/50
533/533 - 13s - loss: 2.3004 - accuracy30: 0.6524 - val_loss: 2.7217 - val_accuracy30: 0.4846 - 13s/epoch - 25ms/step
Epoch 23/50
533/533 - 13s - loss: 2.2888 - accuracy30: 0.6541 - val_loss: 2.7146 - val_accuracy30: 0.4897 - 13s/epoch - 25ms/step
Epoch 24/50
533/533 - 13s - loss: 2.2801 - accuracy30: 0.6543 - val_loss: 2.7193 - val_accuracy30: 0.4980 - 13s/epoch - 24ms/step
Epoch 25/50
533/533 - 13s - loss: 2.2695 - accuracy30: 0.6561 - val_loss: 2.7285 - val_accuracy30: 0.4960 - 13s/epoch - 25ms/step
testing model: results/QRTEA/W6/deepVOL_L2/h30
Evaluating performance on  test set...
2185/2185 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96830654
{'0': {'precision': 0.3630087246468717, 'recall': 0.6602239749981398, 'f1-score': 0.4684507507012045, 'support': 107512}, '1': {'precision': 0.8157171381207862, 'recall': 0.44881878291074506, 'f1-score': 0.5790411597515678, 'support': 343163}, '2': {'precision': 0.35810300645220333, 'recall': 0.5770046082949308, 'f1-score': 0.44193220482557066, 'support': 108500}, 'accuracy': 0.5143380873608441, 'macro avg': {'precision': 0.5122762897399536, 'recall': 0.5620157887346052, 'f1-score': 0.49647470509278097, 'support': 559175}, 'weighted avg': {'precision': 0.6398818088670665, 'recall': 0.5143380873608441, 'f1-score': 0.5311740024800636, 'support': 559175}}
[[ 70982  17383  19147]
 [ 96073 154018  93072]
 [ 28483  17412  62605]]
Evaluating performance on  train set...
533/533 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94935614
{'0': {'precision': 0.3569981276770371, 'recall': 0.6395129795543304, 'f1-score': 0.4582085130197189, 'support': 21765}, '1': {'precision': 0.8754904416061441, 'recall': 0.45203280066377166, 'f1-score': 0.5962236798158032, 'support': 92803}, '2': {'precision': 0.3046851262938281, 'recall': 0.6929881138855616, 'f1-score': 0.4232711924023918, 'support': 21706}, 'accuracy': 0.5203560473751413, 'macro avg': {'precision': 0.512391231859003, 'recall': 0.5948446313678879, 'f1-score': 0.4925677950793046, 'support': 136274}, 'weighted avg': {'precision': 0.7017604168997721, 'recall': 0.5203560473751413, 'f1-score': 0.5466323652795579, 'support': 136274}}
[[13919  3588  4258]
 [20784 41950 30069]
 [ 4286  2378 15042]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96423596
{'0': {'precision': 0.34412057225919973, 'recall': 0.5867466736237934, 'f1-score': 0.4338139557313015, 'support': 7666}, '1': {'precision': 0.8670127574971006, 'recall': 0.47200841852074565, 'f1-score': 0.611248466914556, 'support': 33260}, '2': {'precision': 0.2805451127819549, 'recall': 0.6564046179219352, 'f1-score': 0.3930864197530864, 'support': 7276}, 'accuracy': 0.5180905356624207, 'macro avg': {'precision': 0.49722614751275174, 'recall': 0.5717199033554914, 'f1-score': 0.47938294746631466, 'support': 48202}, 'weighted avg': {'precision': 0.6953263113956701, 'recall': 0.5180905356624207, 'f1-score': 0.5500983067992562, 'support': 48202}}
[[ 4498  1397  1771]
 [ 7084 15699 10477]
 [ 1489  1011  4776]]
training model: results/QRTEA/W6/deepVOL_L2/h50
Epoch 1/50
533/533 - 17s - loss: 3.0031 - accuracy50: 0.4853 - val_loss: 3.0562 - val_accuracy50: 0.3810 - 17s/epoch - 31ms/step
Epoch 2/50
533/533 - 13s - loss: 2.8181 - accuracy50: 0.5396 - val_loss: 2.9680 - val_accuracy50: 0.4535 - 13s/epoch - 25ms/step
Epoch 3/50
533/533 - 13s - loss: 2.7578 - accuracy50: 0.5575 - val_loss: 2.9095 - val_accuracy50: 0.4530 - 13s/epoch - 24ms/step
Epoch 4/50
533/533 - 13s - loss: 2.7108 - accuracy50: 0.5708 - val_loss: 2.8779 - val_accuracy50: 0.4554 - 13s/epoch - 25ms/step
Epoch 5/50
533/533 - 13s - loss: 2.6799 - accuracy50: 0.5765 - val_loss: 2.8547 - val_accuracy50: 0.4675 - 13s/epoch - 24ms/step
Epoch 6/50
533/533 - 13s - loss: 2.6626 - accuracy50: 0.5789 - val_loss: 2.8609 - val_accuracy50: 0.4648 - 13s/epoch - 25ms/step
Epoch 7/50
533/533 - 13s - loss: 2.6388 - accuracy50: 0.5836 - val_loss: 2.8503 - val_accuracy50: 0.4704 - 13s/epoch - 24ms/step
Epoch 8/50
533/533 - 13s - loss: 2.6211 - accuracy50: 0.5892 - val_loss: 2.8655 - val_accuracy50: 0.4621 - 13s/epoch - 25ms/step
Epoch 9/50
533/533 - 13s - loss: 2.6077 - accuracy50: 0.5926 - val_loss: 2.8809 - val_accuracy50: 0.4582 - 13s/epoch - 24ms/step
Epoch 10/50
533/533 - 13s - loss: 2.5910 - accuracy50: 0.5946 - val_loss: 2.8769 - val_accuracy50: 0.4723 - 13s/epoch - 25ms/step
Epoch 11/50
533/533 - 13s - loss: 2.5771 - accuracy50: 0.5984 - val_loss: 2.8744 - val_accuracy50: 0.4704 - 13s/epoch - 24ms/step
Epoch 12/50
533/533 - 13s - loss: 2.5692 - accuracy50: 0.5987 - val_loss: 2.8948 - val_accuracy50: 0.4844 - 13s/epoch - 24ms/step
Epoch 13/50
533/533 - 13s - loss: 2.5548 - accuracy50: 0.6017 - val_loss: 2.9061 - val_accuracy50: 0.4722 - 13s/epoch - 24ms/step
Epoch 14/50
533/533 - 13s - loss: 2.5427 - accuracy50: 0.6026 - val_loss: 2.8842 - val_accuracy50: 0.4913 - 13s/epoch - 24ms/step
Epoch 15/50
533/533 - 13s - loss: 2.5296 - accuracy50: 0.6035 - val_loss: 2.9298 - val_accuracy50: 0.4739 - 13s/epoch - 24ms/step
Epoch 16/50
533/533 - 13s - loss: 2.5204 - accuracy50: 0.6057 - val_loss: 2.9285 - val_accuracy50: 0.4880 - 13s/epoch - 25ms/step
Epoch 17/50
533/533 - 14s - loss: 2.5098 - accuracy50: 0.6061 - val_loss: 2.9055 - val_accuracy50: 0.4720 - 14s/epoch - 25ms/step
testing model: results/QRTEA/W6/deepVOL_L2/h50
Evaluating performance on  test set...
2185/2185 - 21s - 21s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0189236
{'0': {'precision': 0.3833896254743795, 'recall': 0.5300682326125246, 'f1-score': 0.44495246141469613, 'support': 135126}, '1': {'precision': 0.7081027366955109, 'recall': 0.340411880801445, 'f1-score': 0.45978678861836486, 'support': 286782}, '2': {'precision': 0.3627566795317398, 'recall': 0.6196755228860542, 'f1-score': 0.45762228582495856, 'support': 137267}, 'accuracy': 0.4547967988554567, 'macro avg': {'precision': 0.4847496805672101, 'recall': 0.4967185454333413, 'f1-score': 0.4541205119526732, 'support': 559175}, 'weighted avg': {'precision': 0.5448590274889729, 'recall': 0.4547967988554567, 'f1-score': 0.45567069240042696, 'support': 559175}}
[[ 71626  19939  43561]
 [ 83295  97624 105863]
 [ 31902  20304  85061]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9947593
{'0': {'precision': 0.38978259752274247, 'recall': 0.5468507769405487, 'f1-score': 0.45514695953549084, 'support': 27737}, '1': {'precision': 0.7937675714022965, 'recall': 0.3726501208861696, 'f1-score': 0.5071898058374675, 'support': 81068}, '2': {'precision': 0.32554257095158595, 'recall': 0.7027922385234264, 'f1-score': 0.4449694594906073, 'support': 27469}, 'accuracy': 0.47465400589987816, 'macro avg': {'precision': 0.5030309132922083, 'recall': 0.5407643787833816, 'f1-score': 0.4691020749545219, 'support': 136274}, 'weighted avg': {'precision': 0.6171601205468307, 'recall': 0.47465400589987816, 'f1-score': 0.48405521580796934, 'support': 136274}}
[[15168  4589  7980]
 [18842 30210 32016]
 [ 4904  3260 19305]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.008931
{'0': {'precision': 0.37435487388238714, 'recall': 0.5230550477351209, 'f1-score': 0.4363852052705165, 'support': 9846}, '1': {'precision': 0.7896253602305475, 'recall': 0.39509733237202593, 'f1-score': 0.5266698702546853, 'support': 29127}, '2': {'precision': 0.29923003371747775, 'recall': 0.6442734857514357, 'f1-score': 0.408659793814433, 'support': 9229}, 'accuracy': 0.4689431973777022, 'macro avg': {'precision': 0.4877367559434708, 'recall': 0.5208086219528608, 'f1-score': 0.4572382897798783, 'support': 48202}, 'weighted avg': {'precision': 0.6109063926156537, 'recall': 0.4689431973777022, 'f1-score': 0.4856330293165248, 'support': 48202}}
[[ 5150  1755  2941]
 [ 6635 11508 10984]
 [ 1972  1311  5946]]
training model: results/QRTEA/W6/deepVOL_L2/h100
Epoch 1/50
533/533 - 15s - loss: 3.1570 - accuracy100: 0.4385 - val_loss: 3.1858 - val_accuracy100: 0.3623 - 15s/epoch - 29ms/step
Epoch 2/50
533/533 - 13s - loss: 3.0122 - accuracy100: 0.4885 - val_loss: 3.0770 - val_accuracy100: 0.4361 - 13s/epoch - 25ms/step
Epoch 3/50
533/533 - 13s - loss: 2.9681 - accuracy100: 0.5028 - val_loss: 3.0699 - val_accuracy100: 0.4327 - 13s/epoch - 24ms/step
Epoch 4/50
533/533 - 15s - loss: 2.9292 - accuracy100: 0.5142 - val_loss: 3.0630 - val_accuracy100: 0.4430 - 15s/epoch - 28ms/step
Epoch 5/50
533/533 - 14s - loss: 2.9021 - accuracy100: 0.5204 - val_loss: 3.0407 - val_accuracy100: 0.4721 - 14s/epoch - 25ms/step
Epoch 6/50
533/533 - 13s - loss: 2.8810 - accuracy100: 0.5260 - val_loss: 3.0506 - val_accuracy100: 0.4632 - 13s/epoch - 24ms/step
Epoch 7/50
533/533 - 13s - loss: 2.8626 - accuracy100: 0.5297 - val_loss: 3.0409 - val_accuracy100: 0.4664 - 13s/epoch - 24ms/step
Epoch 8/50
533/533 - 13s - loss: 2.8521 - accuracy100: 0.5330 - val_loss: 3.0272 - val_accuracy100: 0.4666 - 13s/epoch - 25ms/step
Epoch 9/50
533/533 - 13s - loss: 2.8312 - accuracy100: 0.5374 - val_loss: 3.0168 - val_accuracy100: 0.4702 - 13s/epoch - 24ms/step
Epoch 10/50
533/533 - 13s - loss: 2.8219 - accuracy100: 0.5394 - val_loss: 3.0002 - val_accuracy100: 0.4855 - 13s/epoch - 24ms/step
Epoch 11/50
533/533 - 13s - loss: 2.8080 - accuracy100: 0.5413 - val_loss: 3.0138 - val_accuracy100: 0.4841 - 13s/epoch - 24ms/step
Epoch 12/50
533/533 - 13s - loss: 2.7909 - accuracy100: 0.5466 - val_loss: 2.9921 - val_accuracy100: 0.4912 - 13s/epoch - 25ms/step
Epoch 13/50
533/533 - 13s - loss: 2.7782 - accuracy100: 0.5492 - val_loss: 3.0015 - val_accuracy100: 0.4919 - 13s/epoch - 24ms/step
Epoch 14/50
533/533 - 13s - loss: 2.7661 - accuracy100: 0.5519 - val_loss: 3.0154 - val_accuracy100: 0.4789 - 13s/epoch - 24ms/step
Epoch 15/50
533/533 - 13s - loss: 2.7560 - accuracy100: 0.5550 - val_loss: 3.0225 - val_accuracy100: 0.4763 - 13s/epoch - 24ms/step
Epoch 16/50
533/533 - 13s - loss: 2.7461 - accuracy100: 0.5571 - val_loss: 3.0665 - val_accuracy100: 0.4554 - 13s/epoch - 24ms/step
Epoch 17/50
533/533 - 13s - loss: 2.7350 - accuracy100: 0.5601 - val_loss: 3.0888 - val_accuracy100: 0.4456 - 13s/epoch - 25ms/step
Epoch 18/50
533/533 - 13s - loss: 2.7190 - accuracy100: 0.5645 - val_loss: 3.0908 - val_accuracy100: 0.4357 - 13s/epoch - 24ms/step
Epoch 19/50
533/533 - 13s - loss: 2.7076 - accuracy100: 0.5667 - val_loss: 3.1076 - val_accuracy100: 0.4324 - 13s/epoch - 24ms/step
Epoch 20/50
533/533 - 13s - loss: 2.6928 - accuracy100: 0.5687 - val_loss: 3.1003 - val_accuracy100: 0.4384 - 13s/epoch - 24ms/step
Epoch 21/50
533/533 - 13s - loss: 2.6866 - accuracy100: 0.5694 - val_loss: 3.0931 - val_accuracy100: 0.4501 - 13s/epoch - 25ms/step
Epoch 22/50
533/533 - 13s - loss: 2.6671 - accuracy100: 0.5727 - val_loss: 3.1149 - val_accuracy100: 0.4388 - 13s/epoch - 25ms/step
testing model: results/QRTEA/W6/deepVOL_L2/h100
Evaluating performance on  test set...
2185/2185 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0335826
{'0': {'precision': 0.42985736182842416, 'recall': 0.5015777901823857, 'f1-score': 0.4629563425302826, 'support': 175562}, '1': {'precision': 0.5133010553802633, 'recall': 0.37127904460227834, 'f1-score': 0.4308890182781336, 'support': 203308}, '2': {'precision': 0.41489397631052033, 'recall': 0.47693075621862957, 'f1-score': 0.44375467657455425, 'support': 180305}, 'accuracy': 0.44625564447623733, 'macro avg': {'precision': 0.4526841311730692, 'recall': 0.44992919700109785, 'f1-score': 0.4458666791276569, 'support': 559175}, 'weighted avg': {'precision': 0.45537137304643577, 'recall': 0.44625564447623733, 'f1-score': 0.44510558035528636, 'support': 559175}}
[[88058 32377 55127]
 [61679 75484 66145]
 [55117 39195 85993]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.99535656
{'0': {'precision': 0.45411140583554377, 'recall': 0.4959443800695249, 'f1-score': 0.4741068955967876, 'support': 37972}, '1': {'precision': 0.6462177685445436, 'recall': 0.4304856803269347, 'f1-score': 0.5167393046299372, 'support': 61419}, '2': {'precision': 0.4113641002802056, 'recall': 0.6010357075075238, 'f1-score': 0.4884325562948927, 'support': 36883}, 'accuracy': 0.49488530460689495, 'macro avg': {'precision': 0.5038977582200976, 'recall': 0.5091552559679945, 'f1-score': 0.49309291884053924, 'support': 136274}, 'weighted avg': {'precision': 0.5291244811134876, 'recall': 0.49488530460689495, 'f1-score': 0.4971987052885499, 'support': 136274}}
[[18832  7580 11560]
 [14818 26440 20161]
 [ 7820  6895 22168]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.015318
{'0': {'precision': 0.4328045286183521, 'recall': 0.46413849958779885, 'f1-score': 0.447924200781137, 'support': 13343}, '1': {'precision': 0.6587897661354338, 'recall': 0.4789151278409091, 'f1-score': 0.5546330805809021, 'support': 22528}, '2': {'precision': 0.37799725964832154, 'recall': 0.5369394209715351, 'f1-score': 0.44366267966629813, 'support': 12331}, 'accuracy': 0.48966847848636985, 'macro avg': {'precision': 0.4898638514673692, 'recall': 0.4933310161334144, 'f1-score': 0.4820733203427791, 'support': 48202}, 'weighted avg': {'precision': 0.5244017029496115, 'recall': 0.48966847848636985, 'f1-score': 0.4967061771983402, 'support': 48202}}
[[ 6193  2922  4228]
 [ 5072 10789  6667]
 [ 3044  2666  6621]]
training model: results/QRTEA/W6/deepVOL_L2/h200
Epoch 1/50
533/533 - 15s - loss: 3.2717 - accuracy200: 0.3953 - val_loss: 3.2841 - val_accuracy200: 0.3771 - 15s/epoch - 28ms/step
Epoch 2/50
533/533 - 13s - loss: 3.1720 - accuracy200: 0.4305 - val_loss: 3.2389 - val_accuracy200: 0.4187 - 13s/epoch - 24ms/step
Epoch 3/50
533/533 - 13s - loss: 3.1270 - accuracy200: 0.4481 - val_loss: 3.1793 - val_accuracy200: 0.4318 - 13s/epoch - 25ms/step
Epoch 4/50
533/533 - 13s - loss: 3.1057 - accuracy200: 0.4541 - val_loss: 3.1610 - val_accuracy200: 0.4458 - 13s/epoch - 25ms/step
Epoch 5/50
533/533 - 13s - loss: 3.0788 - accuracy200: 0.4637 - val_loss: 3.1780 - val_accuracy200: 0.4410 - 13s/epoch - 24ms/step
Epoch 6/50
533/533 - 14s - loss: 3.0484 - accuracy200: 0.4725 - val_loss: 3.1647 - val_accuracy200: 0.4494 - 14s/epoch - 26ms/step
Epoch 7/50
533/533 - 13s - loss: 3.0336 - accuracy200: 0.4779 - val_loss: 3.1605 - val_accuracy200: 0.4481 - 13s/epoch - 25ms/step
Epoch 8/50
533/533 - 13s - loss: 3.0117 - accuracy200: 0.4833 - val_loss: 3.2002 - val_accuracy200: 0.4287 - 13s/epoch - 25ms/step
Epoch 9/50
533/533 - 13s - loss: 2.9915 - accuracy200: 0.4892 - val_loss: 3.2155 - val_accuracy200: 0.4229 - 13s/epoch - 25ms/step
Epoch 10/50
533/533 - 14s - loss: 2.9800 - accuracy200: 0.4935 - val_loss: 3.2375 - val_accuracy200: 0.4140 - 14s/epoch - 25ms/step
Epoch 11/50
533/533 - 13s - loss: 2.9615 - accuracy200: 0.4979 - val_loss: 3.2508 - val_accuracy200: 0.4152 - 13s/epoch - 25ms/step
Epoch 12/50
533/533 - 13s - loss: 2.9447 - accuracy200: 0.5037 - val_loss: 3.2610 - val_accuracy200: 0.4215 - 13s/epoch - 24ms/step
Epoch 13/50
533/533 - 14s - loss: 2.9307 - accuracy200: 0.5063 - val_loss: 3.2484 - val_accuracy200: 0.4240 - 14s/epoch - 25ms/step
Epoch 14/50
533/533 - 13s - loss: 2.9145 - accuracy200: 0.5112 - val_loss: 3.2631 - val_accuracy200: 0.4229 - 13s/epoch - 24ms/step
Epoch 15/50
533/533 - 13s - loss: 2.9006 - accuracy200: 0.5131 - val_loss: 3.2801 - val_accuracy200: 0.4227 - 13s/epoch - 24ms/step
Epoch 16/50
533/533 - 13s - loss: 2.8826 - accuracy200: 0.5194 - val_loss: 3.2811 - val_accuracy200: 0.4246 - 13s/epoch - 24ms/step
Epoch 17/50
533/533 - 14s - loss: 2.8697 - accuracy200: 0.5224 - val_loss: 3.3215 - val_accuracy200: 0.4221 - 14s/epoch - 27ms/step
testing model: results/QRTEA/W6/deepVOL_L2/h200
Evaluating performance on  test set...
2185/2185 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0794239
{'0': {'precision': 0.4298189536132563, 'recall': 0.33526478508028323, 'f1-score': 0.37669905088468303, 'support': 200540}, '1': {'precision': 0.36767460944152847, 'recall': 0.3129629141516645, 'f1-score': 0.3381198163243513, 'support': 151756}, '2': {'precision': 0.4222869612577081, 'recall': 0.558432707041314, 'f1-score': 0.48090980235443, 'support': 206879}, 'accuracy': 0.41177806590065724, 'macro avg': {'precision': 0.4065935081041643, 'recall': 0.4022201354244206, 'f1-score': 0.39857622318782143, 'support': 559175}, 'weighted avg': {'precision': 0.41016680868430166, 'recall': 0.41177806590065724, 'f1-score': 0.40478397194405097, 'support': 559175}}
[[ 67234  38321  94985]
 [ 41198  47494  63064]
 [ 47992  43359 115528]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0461473
{'0': {'precision': 0.4746918677554516, 'recall': 0.33630907239279756, 'f1-score': 0.3936941964285714, 'support': 46151}, '1': {'precision': 0.4754483975301382, 'recall': 0.3813270446993247, 'f1-score': 0.423217854763491, 'support': 46645}, '2': {'precision': 0.40945500710334615, 'recall': 0.6231197387184323, 'f1-score': 0.4941811681441757, 'support': 43478}, 'accuracy': 0.4432246796894492, 'macro avg': {'precision': 0.45319842412964534, 'recall': 0.44691861860351817, 'f1-score': 0.4370310731120794, 'support': 136274}, 'weighted avg': {'precision': 0.4541371038526382, 'recall': 0.4432246796894492, 'f1-score': 0.4358600064824582, 'support': 136274}}
[[15521 10440 20190]
 [ 9974 17787 18884]
 [ 7202  9184 27092]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.056373
{'0': {'precision': 0.45861239910698953, 'recall': 0.32039592081583684, 'f1-score': 0.3772425483825399, 'support': 16670}, '1': {'precision': 0.5076029175423414, 'recall': 0.48733012877574033, 'f1-score': 0.49725998365073115, 'support': 16851}, '2': {'precision': 0.3903228972421239, 'recall': 0.5417887064913834, 'f1-score': 0.4537493938788899, 'support': 14681}, 'accuracy': 0.44618480560972573, 'macro avg': {'precision': 0.45217940463048495, 'recall': 0.4498382520276536, 'f1-score': 0.44275064197072034, 'support': 48202}, 'weighted avg': {'precision': 0.4549399591517184, 'recall': 0.44618480560972573, 'f1-score': 0.44250147540706597, 'support': 48202}}
[[5341 4380 6949]
 [3164 8212 5475]
 [3141 3586 7954]]
training model: results/QRTEA/W6/deepVOL_L2/h300
Epoch 1/50
533/533 - 16s - loss: 3.2870 - accuracy300: 0.3832 - val_loss: 3.3120 - val_accuracy300: 0.3682 - 16s/epoch - 29ms/step
Epoch 2/50
533/533 - 13s - loss: 3.2383 - accuracy300: 0.4046 - val_loss: 3.3000 - val_accuracy300: 0.3861 - 13s/epoch - 24ms/step
Epoch 3/50
533/533 - 13s - loss: 3.2172 - accuracy300: 0.4152 - val_loss: 3.3410 - val_accuracy300: 0.3865 - 13s/epoch - 25ms/step
Epoch 4/50
533/533 - 13s - loss: 3.1955 - accuracy300: 0.4236 - val_loss: 3.3067 - val_accuracy300: 0.3995 - 13s/epoch - 24ms/step
Epoch 5/50
533/533 - 12s - loss: 3.1792 - accuracy300: 0.4313 - val_loss: 3.2913 - val_accuracy300: 0.4061 - 12s/epoch - 23ms/step
Epoch 6/50
533/533 - 14s - loss: 3.1703 - accuracy300: 0.4379 - val_loss: 3.2754 - val_accuracy300: 0.4095 - 14s/epoch - 26ms/step
Epoch 7/50
533/533 - 13s - loss: 3.1620 - accuracy300: 0.4416 - val_loss: 3.2542 - val_accuracy300: 0.4157 - 13s/epoch - 25ms/step
Epoch 8/50
533/533 - 13s - loss: 3.1411 - accuracy300: 0.4486 - val_loss: 3.2694 - val_accuracy300: 0.4049 - 13s/epoch - 24ms/step
Epoch 9/50
533/533 - 13s - loss: 3.1335 - accuracy300: 0.4520 - val_loss: 3.2850 - val_accuracy300: 0.3989 - 13s/epoch - 24ms/step
Epoch 10/50
533/533 - 13s - loss: 3.1179 - accuracy300: 0.4569 - val_loss: 3.2994 - val_accuracy300: 0.4004 - 13s/epoch - 24ms/step
Epoch 11/50
533/533 - 13s - loss: 3.0973 - accuracy300: 0.4657 - val_loss: 3.3050 - val_accuracy300: 0.3990 - 13s/epoch - 24ms/step
Epoch 12/50
533/533 - 13s - loss: 3.0851 - accuracy300: 0.4685 - val_loss: 3.3207 - val_accuracy300: 0.4022 - 13s/epoch - 24ms/step
Epoch 13/50
533/533 - 13s - loss: 3.0742 - accuracy300: 0.4725 - val_loss: 3.3399 - val_accuracy300: 0.4005 - 13s/epoch - 25ms/step
Epoch 14/50
533/533 - 13s - loss: 3.0583 - accuracy300: 0.4780 - val_loss: 3.3630 - val_accuracy300: 0.4001 - 13s/epoch - 24ms/step
Epoch 15/50
533/533 - 14s - loss: 3.0338 - accuracy300: 0.4874 - val_loss: 3.3273 - val_accuracy300: 0.4081 - 14s/epoch - 26ms/step
Epoch 16/50
533/533 - 14s - loss: 3.0185 - accuracy300: 0.4929 - val_loss: 3.4123 - val_accuracy300: 0.3914 - 14s/epoch - 25ms/step
Epoch 17/50
533/533 - 13s - loss: 3.0045 - accuracy300: 0.4970 - val_loss: 3.3981 - val_accuracy300: 0.3926 - 13s/epoch - 24ms/step
testing model: results/QRTEA/W6/deepVOL_L2/h300
Evaluating performance on  test set...
2185/2185 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.112457
{'0': {'precision': 0.38137594997375446, 'recall': 0.3524861179225135, 'f1-score': 0.3663623832217506, 'support': 189633}, '1': {'precision': 0.34017124039517016, 'recall': 0.22708726594834155, 'f1-score': 0.2723575092193196, 'support': 170582}, '2': {'precision': 0.3844877644131066, 'recall': 0.5218335343787696, 'f1-score': 0.4427538209606987, 'support': 198960}, 'accuracy': 0.3744874144945679, 'macro avg': {'precision': 0.36867831826067704, 'recall': 0.36713563941654154, 'f1-score': 0.3604912378005896, 'support': 559175}, 'weighted avg': {'precision': 0.3699132501597775, 'recall': 0.3744874144945679, 'f1-score': 0.364866073543132, 'support': 559175}}
[[ 66843  35414  87376]
 [ 53013  38737  78832]
 [ 55412  39724 103824]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0730479
{'0': {'precision': 0.45832785073291404, 'recall': 0.370829340998616, 'f1-score': 0.40996186620215624, 'support': 46965}, '1': {'precision': 0.4353373702422145, 'recall': 0.31250138608591516, 'f1-score': 0.36383118811242077, 'support': 45091}, '2': {'precision': 0.4031438238730332, 'recall': 0.6008865168031119, 'f1-score': 0.4825425652667424, 'support': 44218}, 'accuracy': 0.42617814109808183, 'macro avg': {'precision': 0.4322696816160539, 'recall': 0.4280724146292143, 'f1-score': 0.4187785398604398, 'support': 136274}, 'weighted avg': {'precision': 0.4328146122905381, 'recall': 0.42617814109808183, 'f1-score': 0.418248809753337, 'support': 136274}}
[[17416  9853 19696]
 [11359 14091 19641]
 [ 9224  8424 26570]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0885873
{'0': {'precision': 0.44175620863872483, 'recall': 0.35357102175646427, 'f1-score': 0.39277466704628133, 'support': 17558}, '1': {'precision': 0.45814274304799246, 'recall': 0.40086398576964616, 'f1-score': 0.42759368435318834, 'support': 15741}, '2': {'precision': 0.3655280722418532, 'recall': 0.4997651479567872, 'f1-score': 0.4222341903115168, 'support': 14903}, 'accuracy': 0.41421517779345257, 'macro avg': {'precision': 0.4218090079761902, 'recall': 0.4180667184942992, 'f1-score': 0.4142008472369955, 'support': 48202}, 'weighted avg': {'precision': 0.4235393819803643, 'recall': 0.41421517779345257, 'f1-score': 0.41325351494989176, 'support': 48202}}
[[6208 4111 7239]
 [3742 6310 5689]
 [4103 3352 7448]]
training model: results/QRTEA/W6/deepVOL_L2/h500
Epoch 1/50
533/533 - 18s - loss: 3.2976 - accuracy500: 0.3833 - val_loss: 3.3345 - val_accuracy500: 0.3529 - 18s/epoch - 33ms/step
Epoch 2/50
533/533 - 14s - loss: 3.2537 - accuracy500: 0.4006 - val_loss: 3.3352 - val_accuracy500: 0.3394 - 14s/epoch - 26ms/step
Epoch 3/50
533/533 - 13s - loss: 3.2443 - accuracy500: 0.4010 - val_loss: 3.3420 - val_accuracy500: 0.3433 - 13s/epoch - 25ms/step
Epoch 4/50
533/533 - 13s - loss: 3.2388 - accuracy500: 0.4045 - val_loss: 3.3421 - val_accuracy500: 0.3570 - 13s/epoch - 24ms/step
Epoch 5/50
533/533 - 13s - loss: 3.2312 - accuracy500: 0.4092 - val_loss: 3.3253 - val_accuracy500: 0.3467 - 13s/epoch - 24ms/step
Epoch 6/50
533/533 - 13s - loss: 3.2113 - accuracy500: 0.4196 - val_loss: 3.3467 - val_accuracy500: 0.3425 - 13s/epoch - 24ms/step
Epoch 7/50
533/533 - 13s - loss: 3.1974 - accuracy500: 0.4249 - val_loss: 3.3709 - val_accuracy500: 0.3297 - 13s/epoch - 25ms/step
Epoch 8/50
533/533 - 14s - loss: 3.1799 - accuracy500: 0.4330 - val_loss: 3.3751 - val_accuracy500: 0.3460 - 14s/epoch - 25ms/step
Epoch 9/50
533/533 - 13s - loss: 3.1733 - accuracy500: 0.4346 - val_loss: 3.3890 - val_accuracy500: 0.3406 - 13s/epoch - 24ms/step
Epoch 10/50
533/533 - 13s - loss: 3.1406 - accuracy500: 0.4488 - val_loss: 3.4045 - val_accuracy500: 0.3372 - 13s/epoch - 25ms/step
Epoch 11/50
533/533 - 13s - loss: 3.1141 - accuracy500: 0.4590 - val_loss: 3.4551 - val_accuracy500: 0.3244 - 13s/epoch - 24ms/step
Epoch 12/50
533/533 - 13s - loss: 3.0969 - accuracy500: 0.4652 - val_loss: 3.4559 - val_accuracy500: 0.3326 - 13s/epoch - 24ms/step
Epoch 13/50
533/533 - 14s - loss: 3.0793 - accuracy500: 0.4708 - val_loss: 3.5008 - val_accuracy500: 0.3307 - 14s/epoch - 26ms/step
Epoch 14/50
533/533 - 13s - loss: 3.0784 - accuracy500: 0.4701 - val_loss: 3.5252 - val_accuracy500: 0.3246 - 13s/epoch - 24ms/step
Epoch 15/50
533/533 - 13s - loss: 3.0595 - accuracy500: 0.4796 - val_loss: 3.5177 - val_accuracy500: 0.3435 - 13s/epoch - 25ms/step
testing model: results/QRTEA/W6/deepVOL_L2/h500
Evaluating performance on  test set...
2185/2185 - 23s - 23s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1045395
{'0': {'precision': 0.37578652328108914, 'recall': 0.26670861794228995, 'f1-score': 0.3119883648452109, 'support': 197054}, '1': {'precision': 0.28672827598032913, 'recall': 0.30414785461396043, 'f1-score': 0.29518129259635206, 'support': 153935}, '2': {'precision': 0.39409136357955254, 'recall': 0.4846627534992747, 'f1-score': 0.434709554562727, 'support': 208186}, 'accuracy': 0.3581615773237359, 'macro avg': {'precision': 0.35220205428032364, 'recall': 0.3518397420185084, 'f1-score': 0.3472930706680966, 'support': 559175}, 'weighted avg': {'precision': 0.35808478444107195, 'recall': 0.3581615773237359, 'f1-score': 0.3530517831595181, 'support': 559175}}
[[ 52556  57009  87489]
 [ 39473  46819  67643]
 [ 47827  59459 100900]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0855714
{'0': {'precision': 0.45795561112847766, 'recall': 0.27628187666324416, 'f1-score': 0.34464281046605855, 'support': 47723}, '1': {'precision': 0.3743345344647216, 'recall': 0.36994830557151065, 'f1-score': 0.3721284954934134, 'support': 43525}, '2': {'precision': 0.38200347459204564, 'recall': 0.5469506507351308, 'f1-score': 0.44983286755438656, 'support': 45026}, 'accuracy': 0.39562939372147293, 'macro avg': {'precision': 0.40476454006174833, 'recall': 0.3977269443232952, 'f1-score': 0.38886805783795286, 'support': 136274}, 'weighted avg': {'precision': 0.4061524185790598, 'recall': 0.39562939372147293, 'f1-score': 0.3881771746974943, 'support': 136274}}
[[13185 13878 20660]
 [ 8242 16102 19181]
 [ 7364 13035 24627]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1089873
{'0': {'precision': 0.3588135761918981, 'recall': 0.218273189634294, 'f1-score': 0.2714301848435794, 'support': 16516}, '1': {'precision': 0.39227839111627605, 'recall': 0.3436651583710407, 'f1-score': 0.36636618529349696, 'support': 17680}, '2': {'precision': 0.30742080649430864, 'recall': 0.49750107096958446, 'f1-score': 0.3800174520069808, 'support': 14006}, 'accuracy': 0.34540060578399234, 'macro avg': {'precision': 0.3528375912674943, 'recall': 0.35314647299163976, 'f1-score': 0.33927127404801904, 'support': 48202}, 'weighted avg': {'precision': 0.35615498931746475, 'recall': 0.34540060578399234, 'f1-score': 0.3378038156440678, 'support': 48202}}
[[3605 5090 7821]
 [3727 6076 7877]
 [2715 4323 6968]]
training model: results/QRTEA/W6/deepVOL_L2/h1000
Epoch 1/50
533/533 - 15s - loss: 3.2490 - accuracy1000: 0.4235 - val_loss: 3.3829 - val_accuracy1000: 0.3263 - 15s/epoch - 28ms/step
Epoch 2/50
533/533 - 14s - loss: 3.2534 - accuracy1000: 0.4085 - val_loss: 3.3481 - val_accuracy1000: 0.3276 - 14s/epoch - 26ms/step
Epoch 3/50
533/533 - 13s - loss: 3.2530 - accuracy1000: 0.3987 - val_loss: 3.3314 - val_accuracy1000: 0.3327 - 13s/epoch - 25ms/step
Epoch 4/50
533/533 - 13s - loss: 3.2450 - accuracy1000: 0.4025 - val_loss: 3.3428 - val_accuracy1000: 0.3367 - 13s/epoch - 25ms/step
Epoch 5/50
533/533 - 13s - loss: 3.2310 - accuracy1000: 0.4114 - val_loss: 3.3518 - val_accuracy1000: 0.3278 - 13s/epoch - 24ms/step
Epoch 6/50
533/533 - 12s - loss: 3.2280 - accuracy1000: 0.4173 - val_loss: 3.3744 - val_accuracy1000: 0.3328 - 12s/epoch - 23ms/step
Epoch 7/50
533/533 - 13s - loss: 3.2226 - accuracy1000: 0.4159 - val_loss: 3.3885 - val_accuracy1000: 0.3325 - 13s/epoch - 24ms/step
Epoch 8/50
533/533 - 13s - loss: 3.2170 - accuracy1000: 0.4169 - val_loss: 3.4108 - val_accuracy1000: 0.3353 - 13s/epoch - 24ms/step
Epoch 9/50
533/533 - 13s - loss: 3.1970 - accuracy1000: 0.4289 - val_loss: 3.3475 - val_accuracy1000: 0.3357 - 13s/epoch - 25ms/step
Epoch 10/50
533/533 - 15s - loss: 3.1820 - accuracy1000: 0.4411 - val_loss: 3.3640 - val_accuracy1000: 0.3318 - 15s/epoch - 27ms/step
Epoch 11/50
533/533 - 13s - loss: 3.1783 - accuracy1000: 0.4421 - val_loss: 3.3536 - val_accuracy1000: 0.3301 - 13s/epoch - 25ms/step
Epoch 12/50
533/533 - 12s - loss: 3.1721 - accuracy1000: 0.4434 - val_loss: 3.4003 - val_accuracy1000: 0.3343 - 12s/epoch - 23ms/step
Epoch 13/50
533/533 - 13s - loss: 3.1683 - accuracy1000: 0.4422 - val_loss: 3.3750 - val_accuracy1000: 0.3341 - 13s/epoch - 25ms/step
testing model: results/QRTEA/W6/deepVOL_L2/h1000
Evaluating performance on  test set...
2185/2185 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1300566
{'0': {'precision': 0.25362625168432457, 'recall': 0.2604437269810694, 'f1-score': 0.25698978345475176, 'support': 147433}, '1': {'precision': 0.48675969673662234, 'recall': 0.018521692957993805, 'f1-score': 0.03568551635250524, 'support': 239179}, '2': {'precision': 0.31597429504512414, 'recall': 0.7300058529348702, 'f1-score': 0.4410467736034353, 'support': 172563}, 'accuracy': 0.3018732954799481, 'macro avg': {'precision': 0.35212008115535703, 'recall': 0.3363237576246445, 'f1-score': 0.24457402447023077, 'support': 559175}, 'weighted avg': {'precision': 0.37258648713947395, 'recall': 0.3018732954799481, 'f1-score': 0.21913060357328185, 'support': 559175}}
[[ 38398   1872 107163]
 [ 69206   4430 165543]
 [ 43792   2799 125972]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.101894
{'0': {'precision': 0.3970583643006589, 'recall': 0.26557082584903297, 'f1-score': 0.3182688577114179, 'support': 47878}, '1': {'precision': 0.35694608421881147, 'recall': 0.02082042099947203, 'f1-score': 0.039345826826305746, 'support': 43563}, '2': {'precision': 0.34663258283354637, 'recall': 0.7863850288849731, 'f1-score': 0.4811693496106944, 'support': 44833}, 'accuracy': 0.3586744353288228, 'macro avg': {'precision': 0.36687901045100557, 'recall': 0.3575920919111593, 'f1-score': 0.2795946780494727, 'support': 136274}, 'weighted avg': {'precision': 0.3676459281960419, 'recall': 0.3586744353288228, 'f1-score': 0.28269782992087916, 'support': 136274}}
[[12715   817 34346]
 [10548   907 32108]
 [ 8760   817 35256]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1163563
{'0': {'precision': 0.3908453908453908, 'recall': 0.21755647857359944, 'f1-score': 0.27952230646578374, 'support': 19742}, '1': {'precision': 0.2334152334152334, 'recall': 0.014328808446455505, 'f1-score': 0.027000142106011083, 'support': 13260}, '2': {'precision': 0.3132503640209896, 'recall': 0.7501315789473684, 'f1-score': 0.4419465493517316, 'support': 15200}, 'accuracy': 0.3295921331065101, 'macro avg': {'precision': 0.3125036627605379, 'recall': 0.3273389553224744, 'f1-score': 0.2494896659745088, 'support': 48202}, 'weighted avg': {'precision': 0.32306877794022537, 'recall': 0.3295921331065101, 'f1-score': 0.2612741962723441, 'support': 48202}}
[[ 4295   405 15042]
 [ 3115   190  9955]
 [ 3579   219 11402]]
training model: results/QRTEA/W6/deepVOL_L3/h10
Epoch 1/50
533/533 - 24s - loss: 3.1650 - accuracy10: 0.4080 - val_loss: 2.9751 - val_accuracy10: 0.3147 - 24s/epoch - 45ms/step
Epoch 2/50
533/533 - 21s - loss: 2.6401 - accuracy10: 0.5631 - val_loss: 2.8898 - val_accuracy10: 0.3796 - 21s/epoch - 39ms/step
Epoch 3/50
533/533 - 20s - loss: 2.4504 - accuracy10: 0.6293 - val_loss: 2.6003 - val_accuracy10: 0.4633 - 20s/epoch - 38ms/step
Epoch 4/50
533/533 - 21s - loss: 2.3451 - accuracy10: 0.6498 - val_loss: 2.4755 - val_accuracy10: 0.5220 - 21s/epoch - 39ms/step
Epoch 5/50
533/533 - 21s - loss: 2.2849 - accuracy10: 0.6632 - val_loss: 2.4678 - val_accuracy10: 0.5060 - 21s/epoch - 39ms/step
Epoch 6/50
533/533 - 21s - loss: 2.2571 - accuracy10: 0.6697 - val_loss: 2.3964 - val_accuracy10: 0.5555 - 21s/epoch - 39ms/step
Epoch 7/50
533/533 - 22s - loss: 2.2310 - accuracy10: 0.6762 - val_loss: 2.3891 - val_accuracy10: 0.5417 - 22s/epoch - 42ms/step
Epoch 8/50
533/533 - 22s - loss: 2.2007 - accuracy10: 0.6839 - val_loss: 2.3944 - val_accuracy10: 0.5278 - 22s/epoch - 41ms/step
Epoch 9/50
533/533 - 21s - loss: 2.1833 - accuracy10: 0.6861 - val_loss: 2.3803 - val_accuracy10: 0.5324 - 21s/epoch - 40ms/step
Epoch 10/50
533/533 - 22s - loss: 2.1746 - accuracy10: 0.6872 - val_loss: 2.4129 - val_accuracy10: 0.4976 - 22s/epoch - 41ms/step
Epoch 11/50
533/533 - 22s - loss: 2.1563 - accuracy10: 0.6908 - val_loss: 2.4545 - val_accuracy10: 0.4607 - 22s/epoch - 42ms/step
Epoch 12/50
533/533 - 22s - loss: 2.1434 - accuracy10: 0.6923 - val_loss: 2.4286 - val_accuracy10: 0.4918 - 22s/epoch - 41ms/step
Epoch 13/50
533/533 - 21s - loss: 2.1343 - accuracy10: 0.6945 - val_loss: 2.4079 - val_accuracy10: 0.4969 - 21s/epoch - 39ms/step
Epoch 14/50
533/533 - 21s - loss: 2.1195 - accuracy10: 0.6960 - val_loss: 2.4091 - val_accuracy10: 0.5077 - 21s/epoch - 39ms/step
Epoch 15/50
533/533 - 21s - loss: 2.1061 - accuracy10: 0.6984 - val_loss: 2.3924 - val_accuracy10: 0.5540 - 21s/epoch - 39ms/step
Epoch 16/50
533/533 - 21s - loss: 2.1024 - accuracy10: 0.6966 - val_loss: 2.4106 - val_accuracy10: 0.4894 - 21s/epoch - 40ms/step
Epoch 17/50
533/533 - 21s - loss: 2.0921 - accuracy10: 0.7009 - val_loss: 2.4217 - val_accuracy10: 0.4889 - 21s/epoch - 39ms/step
Epoch 18/50
533/533 - 21s - loss: 2.0823 - accuracy10: 0.7007 - val_loss: 2.4199 - val_accuracy10: 0.4960 - 21s/epoch - 39ms/step
Epoch 19/50
533/533 - 21s - loss: 2.0716 - accuracy10: 0.7009 - val_loss: 2.4008 - val_accuracy10: 0.5193 - 21s/epoch - 40ms/step
testing model: results/QRTEA/W6/deepVOL_L3/h10
Evaluating performance on  test set...
2185/2185 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98073447
{'0': {'precision': 0.24057882400896768, 'recall': 0.7056115968019129, 'f1-score': 0.3588182768120072, 'support': 66915}, '1': {'precision': 0.9306981670540468, 'recall': 0.4472114229165194, 'f1-score': 0.6041308582559871, 'support': 424410}, '2': {'precision': 0.28365024751385387, 'recall': 0.6646278555637436, 'f1-score': 0.3976087924490039, 'support': 67850}, 'accuracy': 0.5045146868153977, 'macro avg': {'precision': 0.48497574619228945, 'recall': 0.605816958427392, 'f1-score': 0.4535193091723327, 'support': 559175}, 'weighted avg': {'precision': 0.7696009485076819, 'recall': 0.5045146868153977, 'f1-score': 0.5497156688209663, 'support': 559175}}
[[ 47216   6603  13096]
 [133819 189801 100790]
 [ 15225   7530  45095]]
Evaluating performance on  train set...
533/533 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96570766
{'0': {'precision': 0.23498739682696584, 'recall': 0.704735788927592, 'f1-score': 0.35245278822809917, 'support': 13493}, '1': {'precision': 0.9548776374470637, 'recall': 0.46637075001144007, 'f1-score': 0.6266701920298098, 'support': 109265}, '2': {'precision': 0.23455539324254276, 'recall': 0.7365344776561112, 'f1-score': 0.3558025662103721, 'support': 13516}, 'accuracy': 0.5167676886273244, 'macro avg': {'precision': 0.4748068091721908, 'recall': 0.6358803388650478, 'f1-score': 0.44497518215609366, 'support': 136274}, 'weighted avg': {'precision': 0.8121552218039088, 'recall': 0.5167676886273244, 'f1-score': 0.5726535618577152, 'support': 136274}}
[[ 9509  1368  2616]
 [28436 50958 29871]
 [ 2521  1040  9955]]
Evaluating performance on  val set...
189/189 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94008696
{'0': {'precision': 0.24479500320307496, 'recall': 0.6445287792536369, 'f1-score': 0.35482560501421856, 'support': 4743}, '1': {'precision': 0.9482572939103192, 'recall': 0.49653952629960013, 'f1-score': 0.6517833109017497, 'support': 39012}, '2': {'precision': 0.21163155828863012, 'recall': 0.7274567123903756, 'f1-score': 0.3278771600871636, 'support': 4447}, 'accuracy': 0.532405294386125, 'macro avg': {'precision': 0.4682279518006747, 'recall': 0.6228416726478709, 'f1-score': 0.44482869200104397, 'support': 48202}, 'weighted avg': {'precision': 0.811078415624478, 'recall': 0.532405294386125, 'f1-score': 0.5926803472965668, 'support': 48202}}
[[ 3057   596  1090]
 [ 8680 19371 10961]
 [  751   461  3235]]
training model: results/QRTEA/W6/deepVOL_L3/h20
Epoch 1/50
533/533 - 25s - loss: 3.1214 - accuracy20: 0.4099 - val_loss: 3.0129 - val_accuracy20: 0.2657 - 25s/epoch - 46ms/step
Epoch 2/50
533/533 - 20s - loss: 2.7112 - accuracy20: 0.5300 - val_loss: 2.9021 - val_accuracy20: 0.3766 - 20s/epoch - 38ms/step
Epoch 3/50
533/533 - 21s - loss: 2.5387 - accuracy20: 0.6025 - val_loss: 2.7658 - val_accuracy20: 0.4158 - 21s/epoch - 39ms/step
Epoch 4/50
533/533 - 21s - loss: 2.4472 - accuracy20: 0.6312 - val_loss: 2.6246 - val_accuracy20: 0.4771 - 21s/epoch - 39ms/step
Epoch 5/50
533/533 - 21s - loss: 2.3961 - accuracy20: 0.6407 - val_loss: 2.6765 - val_accuracy20: 0.4394 - 21s/epoch - 39ms/step
Epoch 6/50
533/533 - 21s - loss: 2.3604 - accuracy20: 0.6469 - val_loss: 2.6674 - val_accuracy20: 0.4611 - 21s/epoch - 40ms/step
Epoch 7/50
533/533 - 21s - loss: 2.3339 - accuracy20: 0.6507 - val_loss: 2.6068 - val_accuracy20: 0.4751 - 21s/epoch - 40ms/step
Epoch 8/50
533/533 - 20s - loss: 2.3151 - accuracy20: 0.6544 - val_loss: 2.5938 - val_accuracy20: 0.4652 - 20s/epoch - 38ms/step
Epoch 9/50
533/533 - 20s - loss: 2.2957 - accuracy20: 0.6593 - val_loss: 2.5860 - val_accuracy20: 0.4846 - 20s/epoch - 38ms/step
Epoch 10/50
533/533 - 21s - loss: 2.2866 - accuracy20: 0.6593 - val_loss: 2.6208 - val_accuracy20: 0.4539 - 21s/epoch - 40ms/step
Epoch 11/50
533/533 - 20s - loss: 2.2656 - accuracy20: 0.6614 - val_loss: 2.5992 - val_accuracy20: 0.4760 - 20s/epoch - 38ms/step
Epoch 12/50
533/533 - 21s - loss: 2.2542 - accuracy20: 0.6657 - val_loss: 2.6053 - val_accuracy20: 0.4570 - 21s/epoch - 38ms/step
Epoch 13/50
533/533 - 21s - loss: 2.2346 - accuracy20: 0.6686 - val_loss: 2.5869 - val_accuracy20: 0.4830 - 21s/epoch - 39ms/step
Epoch 14/50
533/533 - 22s - loss: 2.2284 - accuracy20: 0.6698 - val_loss: 2.5634 - val_accuracy20: 0.5043 - 22s/epoch - 41ms/step
Epoch 15/50
533/533 - 21s - loss: 2.2149 - accuracy20: 0.6726 - val_loss: 2.5518 - val_accuracy20: 0.4945 - 21s/epoch - 39ms/step
Epoch 16/50
533/533 - 21s - loss: 2.2029 - accuracy20: 0.6725 - val_loss: 2.5617 - val_accuracy20: 0.5151 - 21s/epoch - 39ms/step
Epoch 17/50
533/533 - 21s - loss: 2.1954 - accuracy20: 0.6724 - val_loss: 2.6058 - val_accuracy20: 0.4647 - 21s/epoch - 39ms/step
Epoch 18/50
533/533 - 21s - loss: 2.1827 - accuracy20: 0.6735 - val_loss: 2.5783 - val_accuracy20: 0.5026 - 21s/epoch - 40ms/step
Epoch 19/50
533/533 - 22s - loss: 2.1755 - accuracy20: 0.6732 - val_loss: 2.5973 - val_accuracy20: 0.4923 - 22s/epoch - 41ms/step
Epoch 20/50
533/533 - 21s - loss: 2.1684 - accuracy20: 0.6734 - val_loss: 2.5615 - val_accuracy20: 0.5189 - 21s/epoch - 39ms/step
Epoch 21/50
533/533 - 20s - loss: 2.1536 - accuracy20: 0.6756 - val_loss: 2.5698 - val_accuracy20: 0.5193 - 20s/epoch - 38ms/step
Epoch 22/50
533/533 - 21s - loss: 2.1412 - accuracy20: 0.6754 - val_loss: 2.5769 - val_accuracy20: 0.5096 - 21s/epoch - 39ms/step
Epoch 23/50
533/533 - 20s - loss: 2.1341 - accuracy20: 0.6759 - val_loss: 2.5696 - val_accuracy20: 0.5076 - 20s/epoch - 38ms/step
Epoch 24/50
533/533 - 19s - loss: 2.1223 - accuracy20: 0.6772 - val_loss: 2.5952 - val_accuracy20: 0.5107 - 19s/epoch - 36ms/step
Epoch 25/50
533/533 - 19s - loss: 2.1108 - accuracy20: 0.6773 - val_loss: 2.5939 - val_accuracy20: 0.5173 - 19s/epoch - 37ms/step
testing model: results/QRTEA/W6/deepVOL_L3/h20
Evaluating performance on  test set...
2185/2185 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0541753
{'0': {'precision': 0.2965680730358936, 'recall': 0.7304880766659237, 'f1-score': 0.4218648441672941, 'support': 89740}, '1': {'precision': 0.8843947180948504, 'recall': 0.3670429287196355, 'f1-score': 0.5187806652612726, 'support': 378814}, '2': {'precision': 0.3067262888506884, 'recall': 0.6123525452157889, 'f1-score': 0.40872364089004115, 'support': 90621}, 'accuracy': 0.4651263021415478, 'macro avg': {'precision': 0.4958963599938109, 'recall': 0.5699611835337827, 'f1-score': 0.4497897167728693, 'support': 559175}, 'weighted avg': {'precision': 0.6964384363331013, 'recall': 0.4651263021415478, 'f1-score': 0.48539093326231164, 'support': 559175}}
[[ 65554   8672  15514]
 [129862 139041 109911]
 [ 25626   9503  55492]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0227538
{'0': {'precision': 0.2917906210968548, 'recall': 0.7086366644606221, 'f1-score': 0.4133704376920231, 'support': 18132}, '1': {'precision': 0.9256318522792845, 'recall': 0.4009578275910336, 'f1-score': 0.5595390078343554, 'support': 100018}, '2': {'precision': 0.26319663082144173, 'recall': 0.7103288457294196, 'f1-score': 0.3840806706643993, 'support': 18124}, 'accuracy': 0.4830415192920146, 'macro avg': {'precision': 0.4935397013991936, 'recall': 0.6066411125936918, 'f1-score': 0.4523300387302593, 'support': 136274}, 'weighted avg': {'precision': 0.7531940786944351, 'recall': 0.4830415192920146, 'f1-score': 0.5167550914842883, 'support': 136274}}
[[12849  1891  3392]
 [27267 40103 32648]
 [ 3919  1331 12874]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0104377
{'0': {'precision': 0.2974221965484872, 'recall': 0.6488657844990549, 'f1-score': 0.40788235876615336, 'support': 6348}, '1': {'precision': 0.9199905173946542, 'recall': 0.4333491527316379, 'f1-score': 0.5891752381675333, 'support': 35821}, '2': {'precision': 0.24113272311212813, 'recall': 0.6986573843858777, 'f1-score': 0.35852507123718796, 'support': 6033}, 'accuracy': 0.494937969378864, 'macro avg': {'precision': 0.4861818123517565, 'recall': 0.5936241072055234, 'f1-score': 0.4518608893902915, 'support': 48202}, 'weighted avg': {'precision': 0.7530345244143225, 'recall': 0.494937969378864, 'f1-score': 0.5364313757649206, 'support': 48202}}
[[ 4119   796  1433]
 [ 8466 15523 11832]
 [ 1264   554  4215]]
training model: results/QRTEA/W6/deepVOL_L3/h30
Epoch 1/50
533/533 - 22s - loss: 3.1597 - accuracy30: 0.4182 - val_loss: 3.0566 - val_accuracy30: 0.2896 - 22s/epoch - 41ms/step
Epoch 2/50
533/533 - 20s - loss: 2.7864 - accuracy30: 0.5294 - val_loss: 2.8707 - val_accuracy30: 0.3999 - 20s/epoch - 38ms/step
Epoch 3/50
533/533 - 20s - loss: 2.6270 - accuracy30: 0.5891 - val_loss: 2.8110 - val_accuracy30: 0.4517 - 20s/epoch - 37ms/step
Epoch 4/50
533/533 - 20s - loss: 2.5573 - accuracy30: 0.6063 - val_loss: 2.7424 - val_accuracy30: 0.4703 - 20s/epoch - 37ms/step
Epoch 5/50
533/533 - 20s - loss: 2.5145 - accuracy30: 0.6141 - val_loss: 2.7408 - val_accuracy30: 0.4510 - 20s/epoch - 38ms/step
Epoch 6/50
533/533 - 20s - loss: 2.4770 - accuracy30: 0.6190 - val_loss: 2.7239 - val_accuracy30: 0.4565 - 20s/epoch - 37ms/step
Epoch 7/50
533/533 - 19s - loss: 2.4486 - accuracy30: 0.6237 - val_loss: 2.7454 - val_accuracy30: 0.4237 - 19s/epoch - 37ms/step
Epoch 8/50
533/533 - 20s - loss: 2.4237 - accuracy30: 0.6285 - val_loss: 2.7374 - val_accuracy30: 0.4359 - 20s/epoch - 37ms/step
Epoch 9/50
533/533 - 20s - loss: 2.4045 - accuracy30: 0.6340 - val_loss: 2.7347 - val_accuracy30: 0.4436 - 20s/epoch - 37ms/step
Epoch 10/50
533/533 - 20s - loss: 2.3887 - accuracy30: 0.6355 - val_loss: 2.7759 - val_accuracy30: 0.4095 - 20s/epoch - 37ms/step
Epoch 11/50
533/533 - 20s - loss: 2.3741 - accuracy30: 0.6373 - val_loss: 2.7150 - val_accuracy30: 0.4491 - 20s/epoch - 37ms/step
Epoch 12/50
533/533 - 20s - loss: 2.3543 - accuracy30: 0.6421 - val_loss: 2.7764 - val_accuracy30: 0.4138 - 20s/epoch - 37ms/step
Epoch 13/50
533/533 - 20s - loss: 2.3396 - accuracy30: 0.6432 - val_loss: 2.7619 - val_accuracy30: 0.4205 - 20s/epoch - 37ms/step
Epoch 14/50
533/533 - 20s - loss: 2.3223 - accuracy30: 0.6478 - val_loss: 2.7888 - val_accuracy30: 0.4189 - 20s/epoch - 37ms/step
Epoch 15/50
533/533 - 20s - loss: 2.3166 - accuracy30: 0.6468 - val_loss: 2.7768 - val_accuracy30: 0.4285 - 20s/epoch - 37ms/step
Epoch 16/50
533/533 - 20s - loss: 2.2966 - accuracy30: 0.6508 - val_loss: 2.7317 - val_accuracy30: 0.4626 - 20s/epoch - 37ms/step
Epoch 17/50
533/533 - 20s - loss: 2.2878 - accuracy30: 0.6513 - val_loss: 2.7981 - val_accuracy30: 0.4344 - 20s/epoch - 37ms/step
Epoch 18/50
533/533 - 20s - loss: 2.2745 - accuracy30: 0.6528 - val_loss: 2.8660 - val_accuracy30: 0.4077 - 20s/epoch - 37ms/step
Epoch 19/50
533/533 - 20s - loss: 2.2615 - accuracy30: 0.6560 - val_loss: 2.8696 - val_accuracy30: 0.4142 - 20s/epoch - 37ms/step
Epoch 20/50
533/533 - 20s - loss: 2.2520 - accuracy30: 0.6556 - val_loss: 2.8844 - val_accuracy30: 0.3913 - 20s/epoch - 37ms/step
Epoch 21/50
533/533 - 20s - loss: 2.2418 - accuracy30: 0.6575 - val_loss: 2.9175 - val_accuracy30: 0.3861 - 20s/epoch - 37ms/step
testing model: results/QRTEA/W6/deepVOL_L3/h30
Evaluating performance on  test set...
2185/2185 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0439364
{'0': {'precision': 0.3579651649447891, 'recall': 0.5807444750353449, 'f1-score': 0.4429192647924691, 'support': 107512}, '1': {'precision': 0.8376718316652598, 'recall': 0.3238956414298744, 'f1-score': 0.46715883753527887, 'support': 343163}, '2': {'precision': 0.30251324063237656, 'recall': 0.7027926267281106, 'f1-score': 0.4229639593415889, 'support': 108500}, 'accuracy': 0.4467993025439263, 'macro avg': {'precision': 0.4993834124141418, 'recall': 0.5358109143977766, 'f1-score': 0.44434735388977903, 'support': 559175}, 'weighted avg': {'precision': 0.641599170549296, 'recall': 0.4467993025439263, 'f1-score': 0.45392292886851027, 'support': 559175}}
[[ 62437  10684  34391]
 [ 90593 111149 141421]
 [ 21392  10855  76253]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0183458
{'0': {'precision': 0.3548295535182084, 'recall': 0.5743625086147485, 'f1-score': 0.43866236227103655, 'support': 21765}, '1': {'precision': 0.8878625190799516, 'recall': 0.3635335064599205, 'f1-score': 0.5158523252880329, 'support': 92803}, '2': {'precision': 0.269696248711238, 'recall': 0.7833317976596332, 'f1-score': 0.40124600299701474, 'support': 21706}, 'accuracy': 0.46407238358014, 'macro avg': {'precision': 0.504129440436466, 'recall': 0.5737426042447674, 'f1-score': 0.4519202301853615, 'support': 136274}, 'weighted avg': {'precision': 0.7042663851140106, 'recall': 0.46407238358014, 'f1-score': 0.4852692032198925, 'support': 136274}}
[[12501  2620  6644]
 [19668 33737 39398]
 [ 3062  1641 17003]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0405506
{'0': {'precision': 0.35426206410707994, 'recall': 0.5247847638925124, 'f1-score': 0.42298391336347385, 'support': 7666}, '1': {'precision': 0.8930902543326581, 'recall': 0.35790739627179796, 'f1-score': 0.5110219150443237, 'support': 33260}, '2': {'precision': 0.24067695709486756, 'recall': 0.7778999450247389, 'f1-score': 0.3676160166271555, 'support': 7276}, 'accuracy': 0.44784448778059, 'macro avg': {'precision': 0.4960097585115351, 'recall': 0.5535307017296831, 'f1-score': 0.43387394834498433, 'support': 48202}, 'weighted avg': {'precision': 0.7089149907134836, 'recall': 0.44784448778059, 'f1-score': 0.47537358846516287, 'support': 48202}}
[[ 4023   866  2777]
 [ 6276 11904 15080]
 [ 1057   559  5660]]
training model: results/QRTEA/W6/deepVOL_L3/h50
Epoch 1/50
533/533 - 22s - loss: 3.2323 - accuracy50: 0.3937 - val_loss: 3.1673 - val_accuracy50: 0.3365 - 22s/epoch - 41ms/step
Epoch 2/50
533/533 - 20s - loss: 3.0187 - accuracy50: 0.4248 - val_loss: 3.0678 - val_accuracy50: 0.3453 - 20s/epoch - 38ms/step
Epoch 3/50
533/533 - 20s - loss: 2.8360 - accuracy50: 0.5180 - val_loss: 2.9993 - val_accuracy50: 0.4121 - 20s/epoch - 37ms/step
Epoch 4/50
533/533 - 20s - loss: 2.7436 - accuracy50: 0.5556 - val_loss: 2.9374 - val_accuracy50: 0.4136 - 20s/epoch - 37ms/step
Epoch 5/50
533/533 - 20s - loss: 2.6971 - accuracy50: 0.5665 - val_loss: 2.8946 - val_accuracy50: 0.4523 - 20s/epoch - 37ms/step
Epoch 6/50
533/533 - 20s - loss: 2.6507 - accuracy50: 0.5768 - val_loss: 2.8534 - val_accuracy50: 0.4472 - 20s/epoch - 37ms/step
Epoch 7/50
533/533 - 20s - loss: 2.6246 - accuracy50: 0.5789 - val_loss: 2.8331 - val_accuracy50: 0.4590 - 20s/epoch - 37ms/step
Epoch 8/50
533/533 - 20s - loss: 2.6046 - accuracy50: 0.5868 - val_loss: 2.8257 - val_accuracy50: 0.4762 - 20s/epoch - 37ms/step
Epoch 9/50
533/533 - 20s - loss: 2.5841 - accuracy50: 0.5914 - val_loss: 2.8148 - val_accuracy50: 0.4762 - 20s/epoch - 37ms/step
Epoch 10/50
533/533 - 20s - loss: 2.5677 - accuracy50: 0.5952 - val_loss: 2.8179 - val_accuracy50: 0.4800 - 20s/epoch - 37ms/step
Epoch 11/50
533/533 - 20s - loss: 2.5572 - accuracy50: 0.5974 - val_loss: 2.7908 - val_accuracy50: 0.4831 - 20s/epoch - 37ms/step
Epoch 12/50
533/533 - 20s - loss: 2.5427 - accuracy50: 0.6015 - val_loss: 2.8129 - val_accuracy50: 0.4774 - 20s/epoch - 37ms/step
Epoch 13/50
533/533 - 20s - loss: 2.5326 - accuracy50: 0.6047 - val_loss: 2.8404 - val_accuracy50: 0.4668 - 20s/epoch - 37ms/step
Epoch 14/50
533/533 - 20s - loss: 2.5219 - accuracy50: 0.6059 - val_loss: 2.8301 - val_accuracy50: 0.4698 - 20s/epoch - 37ms/step
Epoch 15/50
533/533 - 20s - loss: 2.5114 - accuracy50: 0.6073 - val_loss: 2.8543 - val_accuracy50: 0.4654 - 20s/epoch - 37ms/step
Epoch 16/50
533/533 - 20s - loss: 2.4993 - accuracy50: 0.6105 - val_loss: 2.8486 - val_accuracy50: 0.4559 - 20s/epoch - 37ms/step
Epoch 17/50
533/533 - 20s - loss: 2.4858 - accuracy50: 0.6126 - val_loss: 2.8521 - val_accuracy50: 0.4533 - 20s/epoch - 37ms/step
Epoch 18/50
533/533 - 20s - loss: 2.4719 - accuracy50: 0.6157 - val_loss: 2.8898 - val_accuracy50: 0.4537 - 20s/epoch - 37ms/step
Epoch 19/50
533/533 - 20s - loss: 2.4630 - accuracy50: 0.6167 - val_loss: 2.9044 - val_accuracy50: 0.4519 - 20s/epoch - 37ms/step
Epoch 20/50
533/533 - 20s - loss: 2.4518 - accuracy50: 0.6200 - val_loss: 2.9177 - val_accuracy50: 0.4390 - 20s/epoch - 37ms/step
Epoch 21/50
533/533 - 20s - loss: 2.4350 - accuracy50: 0.6229 - val_loss: 2.9281 - val_accuracy50: 0.4545 - 20s/epoch - 37ms/step
testing model: results/QRTEA/W6/deepVOL_L3/h50
Evaluating performance on  test set...
2185/2185 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.026643
{'0': {'precision': 0.3807610864696707, 'recall': 0.6467297189289996, 'f1-score': 0.4793220710838087, 'support': 135126}, '1': {'precision': 0.7303292474128396, 'recall': 0.3361508044437935, 'f1-score': 0.46039447920149, 'support': 286782}, '2': {'precision': 0.3792920273394616, 'recall': 0.5461764298775379, 'f1-score': 0.44768757650852414, 'support': 137267}, 'accuracy': 0.4627603165377565, 'macro avg': {'precision': 0.4967941204073239, 'recall': 0.5096856510834437, 'f1-score': 0.46246804226460764, 'support': 559175}, 'weighted avg': {'precision': 0.5596821809248546, 'recall': 0.4627603165377565, 'f1-score': 0.4618490709996477, 'support': 559175}}
[[87390 17425 30311]
 [98000 96402 92380]
 [44124 18171 74972]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9836961
{'0': {'precision': 0.3860100727476217, 'recall': 0.6217327036088979, 'f1-score': 0.4763022703419323, 'support': 27737}, '1': {'precision': 0.8124586169452022, 'recall': 0.3783983816055657, 'f1-score': 0.5163223227435304, 'support': 81068}, '2': {'precision': 0.3417406485643178, 'recall': 0.6698460082274564, 'f1-score': 0.4525832913135984, 'support': 27469}, 'accuracy': 0.4866739069815225, 'macro avg': {'precision': 0.5134031127523805, 'recall': 0.5566590311473066, 'f1-score': 0.48173596146635367, 'support': 136274}, 'weighted avg': {'precision': 0.6307764534814247, 'recall': 0.4866739069815225, 'f1-score': 0.4953287095244869, 'support': 136274}}
[[17245  4048  6444]
 [21394 30676 28998]
 [ 6036  3033 18400]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99482745
{'0': {'precision': 0.38444741846869057, 'recall': 0.5543367865122892, 'f1-score': 0.4540198810464584, 'support': 9846}, '1': {'precision': 0.8047919636190864, 'recall': 0.40707934219109415, 'f1-score': 0.5406748746010032, 'support': 29127}, '2': {'precision': 0.31418638439186386, 'recall': 0.6560840827825333, 'f1-score': 0.4248973720220343, 'support': 9229}, 'accuracy': 0.4848346541637276, 'macro avg': {'precision': 0.5011419221598804, 'recall': 0.5391667371619722, 'f1-score': 0.47319737588983196, 'support': 48202}, 'weighted avg': {'precision': 0.6249962853850125, 'recall': 0.4848346541637276, 'f1-score': 0.5008069098310901, 'support': 48202}}
[[ 5458  1675  2713]
 [ 6766 11857 10504]
 [ 1973  1201  6055]]
training model: results/QRTEA/W6/deepVOL_L3/h100
Epoch 1/50
533/533 - 22s - loss: 3.2818 - accuracy100: 0.3891 - val_loss: 3.2560 - val_accuracy100: 0.3620 - 22s/epoch - 42ms/step
Epoch 2/50
533/533 - 20s - loss: 3.1096 - accuracy100: 0.4473 - val_loss: 3.1793 - val_accuracy100: 0.3789 - 20s/epoch - 38ms/step
Epoch 3/50
533/533 - 20s - loss: 3.0134 - accuracy100: 0.4840 - val_loss: 3.1011 - val_accuracy100: 0.4127 - 20s/epoch - 37ms/step
Epoch 4/50
533/533 - 20s - loss: 2.9660 - accuracy100: 0.4998 - val_loss: 3.0844 - val_accuracy100: 0.4328 - 20s/epoch - 37ms/step
Epoch 5/50
533/533 - 19s - loss: 2.9271 - accuracy100: 0.5085 - val_loss: 3.0720 - val_accuracy100: 0.4265 - 19s/epoch - 37ms/step
Epoch 6/50
533/533 - 20s - loss: 2.8919 - accuracy100: 0.5196 - val_loss: 3.0617 - val_accuracy100: 0.4315 - 20s/epoch - 38ms/step
Epoch 7/50
533/533 - 19s - loss: 2.8676 - accuracy100: 0.5254 - val_loss: 3.0814 - val_accuracy100: 0.4372 - 19s/epoch - 37ms/step
Epoch 8/50
533/533 - 20s - loss: 2.8436 - accuracy100: 0.5318 - val_loss: 3.0620 - val_accuracy100: 0.4339 - 20s/epoch - 38ms/step
Epoch 9/50
533/533 - 20s - loss: 2.8188 - accuracy100: 0.5365 - val_loss: 3.0593 - val_accuracy100: 0.4334 - 20s/epoch - 37ms/step
Epoch 10/50
533/533 - 20s - loss: 2.8028 - accuracy100: 0.5398 - val_loss: 3.0807 - val_accuracy100: 0.4225 - 20s/epoch - 37ms/step
Epoch 11/50
533/533 - 20s - loss: 2.7866 - accuracy100: 0.5423 - val_loss: 3.0745 - val_accuracy100: 0.4327 - 20s/epoch - 37ms/step
Epoch 12/50
533/533 - 20s - loss: 2.7720 - accuracy100: 0.5453 - val_loss: 3.0637 - val_accuracy100: 0.4238 - 20s/epoch - 37ms/step
Epoch 13/50
533/533 - 20s - loss: 2.7614 - accuracy100: 0.5490 - val_loss: 3.0654 - val_accuracy100: 0.4281 - 20s/epoch - 37ms/step
Epoch 14/50
533/533 - 20s - loss: 2.7478 - accuracy100: 0.5501 - val_loss: 3.0807 - val_accuracy100: 0.4261 - 20s/epoch - 38ms/step
Epoch 15/50
533/533 - 20s - loss: 2.7349 - accuracy100: 0.5537 - val_loss: 3.1095 - val_accuracy100: 0.4331 - 20s/epoch - 37ms/step
Epoch 16/50
533/533 - 20s - loss: 2.7257 - accuracy100: 0.5543 - val_loss: 3.1224 - val_accuracy100: 0.4414 - 20s/epoch - 38ms/step
Epoch 17/50
533/533 - 20s - loss: 2.7100 - accuracy100: 0.5584 - val_loss: 3.1368 - val_accuracy100: 0.4343 - 20s/epoch - 37ms/step
Epoch 18/50
533/533 - 19s - loss: 2.6919 - accuracy100: 0.5619 - val_loss: 3.1078 - val_accuracy100: 0.4452 - 19s/epoch - 37ms/step
Epoch 19/50
533/533 - 20s - loss: 2.6810 - accuracy100: 0.5645 - val_loss: 3.1304 - val_accuracy100: 0.4418 - 20s/epoch - 37ms/step
testing model: results/QRTEA/W6/deepVOL_L3/h100
Evaluating performance on  test set...
2185/2185 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0649298
{'0': {'precision': 0.3997640326532952, 'recall': 0.47670338683769836, 'f1-score': 0.43485670787944286, 'support': 175562}, '1': {'precision': 0.48588358622650224, 'recall': 0.2690154838963543, 'f1-score': 0.34629850065849455, 'support': 203308}, '2': {'precision': 0.4138160667622018, 'recall': 0.544532874850947, 'f1-score': 0.47025972004358607, 'support': 180305}, 'accuracy': 0.42306254750301786, 'macro avg': {'precision': 0.4331545618806664, 'recall': 0.43008391519499994, 'f1-score': 0.4171383095271745, 'support': 559175}, 'weighted avg': {'precision': 0.4356069194201714, 'recall': 0.42306254750301786, 'f1-score': 0.4140738547736697, 'support': 559175}}
[[83691 28601 63270]
 [72807 54693 75808]
 [52853 29270 98182]]
Evaluating performance on  train set...
533/533 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.016302
{'0': {'precision': 0.4332373807203246, 'recall': 0.503370904877278, 'f1-score': 0.4656783325821344, 'support': 37972}, '1': {'precision': 0.6392564966313763, 'recall': 0.3460492681417802, 'f1-score': 0.4490265879345495, 'support': 61419}, '2': {'precision': 0.40316091466209447, 'recall': 0.6439009841932598, 'f1-score': 0.49585551727737753, 'support': 36883}, 'accuracy': 0.47050060906702673, 'macro avg': {'precision': 0.4918849306712651, 'recall': 0.4977737190707727, 'f1-score': 0.4701868125980205, 'support': 136274}, 'weighted avg': {'precision': 0.5179503691298171, 'recall': 0.47050060906702673, 'f1-score': 0.4663409065038263, 'support': 136274}}
[[19114  6614 12244]
 [17251 21254 22914]
 [ 7754  5380 23749]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0543388
{'0': {'precision': 0.40677543903350355, 'recall': 0.4895450798171326, 'f1-score': 0.44433862793782525, 'support': 13343}, '1': {'precision': 0.6492886645250114, 'recall': 0.31400923295454547, 'f1-score': 0.42330131945067767, 'support': 22528}, '2': {'precision': 0.3429808461574662, 'recall': 0.5910307355445625, 'f1-score': 0.43406789755807035, 'support': 12331}, 'accuracy': 0.4334674909754782, 'macro avg': {'precision': 0.4663483165719937, 'recall': 0.4648616827720802, 'f1-score': 0.4339026149821911, 'support': 48202}, 'weighted avg': {'precision': 0.5037981106885858, 'recall': 0.4334674909754782, 'f1-score': 0.4318790440634794, 'support': 48202}}
[[6532 2005 4806]
 [6299 7074 9155]
 [3227 1816 7288]]
training model: results/QRTEA/W6/deepVOL_L3/h200
Epoch 1/50
533/533 - 23s - loss: 3.2796 - accuracy200: 0.3928 - val_loss: 3.3369 - val_accuracy200: 0.3539 - 23s/epoch - 43ms/step
Epoch 2/50
533/533 - 20s - loss: 3.2242 - accuracy200: 0.4046 - val_loss: 3.3062 - val_accuracy200: 0.3603 - 20s/epoch - 37ms/step
Epoch 3/50
533/533 - 20s - loss: 3.1921 - accuracy200: 0.4179 - val_loss: 3.3164 - val_accuracy200: 0.3672 - 20s/epoch - 38ms/step
Epoch 4/50
533/533 - 20s - loss: 3.1698 - accuracy200: 0.4298 - val_loss: 3.3009 - val_accuracy200: 0.3775 - 20s/epoch - 37ms/step
Epoch 5/50
533/533 - 20s - loss: 3.1276 - accuracy200: 0.4516 - val_loss: 3.2277 - val_accuracy200: 0.4194 - 20s/epoch - 38ms/step
Epoch 6/50
533/533 - 20s - loss: 3.0912 - accuracy200: 0.4648 - val_loss: 3.2213 - val_accuracy200: 0.4294 - 20s/epoch - 37ms/step
Epoch 7/50
533/533 - 20s - loss: 3.0682 - accuracy200: 0.4725 - val_loss: 3.2345 - val_accuracy200: 0.4296 - 20s/epoch - 37ms/step
Epoch 8/50
533/533 - 20s - loss: 3.0420 - accuracy200: 0.4791 - val_loss: 3.2093 - val_accuracy200: 0.4377 - 20s/epoch - 37ms/step
Epoch 9/50
533/533 - 21s - loss: 3.0169 - accuracy200: 0.4877 - val_loss: 3.2270 - val_accuracy200: 0.4326 - 21s/epoch - 39ms/step
Epoch 10/50
533/533 - 20s - loss: 2.9925 - accuracy200: 0.4961 - val_loss: 3.2459 - val_accuracy200: 0.4311 - 20s/epoch - 37ms/step
Epoch 11/50
533/533 - 20s - loss: 2.9658 - accuracy200: 0.5040 - val_loss: 3.2518 - val_accuracy200: 0.4330 - 20s/epoch - 37ms/step
Epoch 12/50
533/533 - 20s - loss: 2.9400 - accuracy200: 0.5104 - val_loss: 3.2861 - val_accuracy200: 0.4187 - 20s/epoch - 37ms/step
Epoch 13/50
533/533 - 20s - loss: 2.9133 - accuracy200: 0.5183 - val_loss: 3.3095 - val_accuracy200: 0.4143 - 20s/epoch - 37ms/step
Epoch 14/50
533/533 - 20s - loss: 2.8970 - accuracy200: 0.5226 - val_loss: 3.3367 - val_accuracy200: 0.4102 - 20s/epoch - 37ms/step
Epoch 15/50
533/533 - 20s - loss: 2.8750 - accuracy200: 0.5271 - val_loss: 3.3844 - val_accuracy200: 0.4041 - 20s/epoch - 37ms/step
Epoch 16/50
533/533 - 19s - loss: 2.8586 - accuracy200: 0.5311 - val_loss: 3.3727 - val_accuracy200: 0.4190 - 19s/epoch - 36ms/step
Epoch 17/50
533/533 - 20s - loss: 2.8459 - accuracy200: 0.5328 - val_loss: 3.4268 - val_accuracy200: 0.4020 - 20s/epoch - 37ms/step
Epoch 18/50
533/533 - 20s - loss: 2.8290 - accuracy200: 0.5381 - val_loss: 3.4395 - val_accuracy200: 0.4065 - 20s/epoch - 37ms/step
testing model: results/QRTEA/W6/deepVOL_L3/h200
Evaluating performance on  test set...
2185/2185 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0902269
{'0': {'precision': 0.40490951742627346, 'recall': 0.3855988830158572, 'f1-score': 0.395018338969544, 'support': 200540}, '1': {'precision': 0.3682076869104233, 'recall': 0.3112232794749466, 'f1-score': 0.33732581974530934, 'support': 151756}, '2': {'precision': 0.4204952298388273, 'recall': 0.4876715374687619, 'f1-score': 0.4515988970654062, 'support': 206879}, 'accuracy': 0.4031778960075111, 'macro avg': {'precision': 0.3978708113918414, 'recall': 0.3948312333198552, 'f1-score': 0.3946476852600865, 'support': 559175}, 'weighted avg': {'precision': 0.4007151840001249, 'recall': 0.4031778960075111, 'f1-score': 0.40029422457051134, 'support': 559175}}
[[ 77328  41536  81676]
 [ 47162  47230  57364]
 [ 66486  39504 100889]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0317473
{'0': {'precision': 0.48540127770013974, 'recall': 0.4214643236332907, 'f1-score': 0.45117891977778557, 'support': 46151}, '1': {'precision': 0.5055530640778748, 'recall': 0.41084789366491586, 'f1-score': 0.4533068407607153, 'support': 46645}, '2': {'precision': 0.433948022986534, 'recall': 0.5818344910069461, 'f1-score': 0.4971259567861811, 'support': 43478}, 'accuracy': 0.46899628689258405, 'macro avg': {'precision': 0.4749674549215162, 'recall': 0.47138223610171753, 'f1-score': 0.46720390577489396, 'support': 136274}, 'weighted avg': {'precision': 0.4758829210594842, 'recall': 0.46899628689258405, 'f1-score': 0.466566610381274, 'support': 136274}}
[[19451 10249 16451]
 [10934 19164 16547]
 [ 9687  8494 25297]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0737076
{'0': {'precision': 0.4379867744305658, 'recall': 0.3575884823035393, 'f1-score': 0.3937252311756935, 'support': 16670}, '1': {'precision': 0.5124183987394012, 'recall': 0.40525784819891997, 'f1-score': 0.4525813506527934, 'support': 16851}, '2': {'precision': 0.3884316952739243, 'recall': 0.5626319732988216, 'f1-score': 0.45957825627329885, 'support': 14681}, 'accuracy': 0.43670387120866355, 'macro avg': {'precision': 0.4462789561479637, 'recall': 0.44182610126709365, 'f1-score': 0.4352949460339286, 'support': 48202}, 'weighted avg': {'precision': 0.4489143123777366, 'recall': 0.43670387120866355, 'f1-score': 0.43435783419562124, 'support': 48202}}
[[5961 3615 7094]
 [4111 6829 5911]
 [3538 2883 8260]]
training model: results/QRTEA/W6/deepVOL_L3/h300
Epoch 1/50
533/533 - 23s - loss: 3.3198 - accuracy300: 0.3676 - val_loss: 3.3728 - val_accuracy300: 0.3443 - 23s/epoch - 43ms/step
Epoch 2/50
533/533 - 20s - loss: 3.2815 - accuracy300: 0.3774 - val_loss: 3.3171 - val_accuracy300: 0.3504 - 20s/epoch - 37ms/step
Epoch 3/50
533/533 - 19s - loss: 3.2493 - accuracy300: 0.3934 - val_loss: 3.3156 - val_accuracy300: 0.3606 - 19s/epoch - 36ms/step
Epoch 4/50
533/533 - 20s - loss: 3.2212 - accuracy300: 0.4097 - val_loss: 3.2897 - val_accuracy300: 0.3912 - 20s/epoch - 38ms/step
Epoch 5/50
533/533 - 19s - loss: 3.2001 - accuracy300: 0.4231 - val_loss: 3.3174 - val_accuracy300: 0.3807 - 19s/epoch - 36ms/step
Epoch 6/50
533/533 - 19s - loss: 3.1791 - accuracy300: 0.4339 - val_loss: 3.3347 - val_accuracy300: 0.3971 - 19s/epoch - 37ms/step
Epoch 7/50
533/533 - 19s - loss: 3.1613 - accuracy300: 0.4389 - val_loss: 3.3149 - val_accuracy300: 0.3870 - 19s/epoch - 36ms/step
Epoch 8/50
533/533 - 19s - loss: 3.1437 - accuracy300: 0.4483 - val_loss: 3.3522 - val_accuracy300: 0.3915 - 19s/epoch - 37ms/step
Epoch 9/50
533/533 - 20s - loss: 3.1259 - accuracy300: 0.4551 - val_loss: 3.3326 - val_accuracy300: 0.3966 - 20s/epoch - 37ms/step
Epoch 10/50
533/533 - 20s - loss: 3.1086 - accuracy300: 0.4617 - val_loss: 3.3500 - val_accuracy300: 0.3964 - 20s/epoch - 37ms/step
Epoch 11/50
533/533 - 20s - loss: 3.0920 - accuracy300: 0.4677 - val_loss: 3.3567 - val_accuracy300: 0.3997 - 20s/epoch - 37ms/step
Epoch 12/50
533/533 - 20s - loss: 3.0744 - accuracy300: 0.4736 - val_loss: 3.4251 - val_accuracy300: 0.3853 - 20s/epoch - 37ms/step
Epoch 13/50
533/533 - 20s - loss: 3.0574 - accuracy300: 0.4805 - val_loss: 3.4521 - val_accuracy300: 0.3733 - 20s/epoch - 37ms/step
Epoch 14/50
533/533 - 20s - loss: 3.0460 - accuracy300: 0.4853 - val_loss: 3.4430 - val_accuracy300: 0.3682 - 20s/epoch - 37ms/step
testing model: results/QRTEA/W6/deepVOL_L3/h300
Evaluating performance on  test set...
2185/2185 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1096627
{'0': {'precision': 0.3596397772730014, 'recall': 0.37738157388218296, 'f1-score': 0.3682971326819703, 'support': 189633}, '1': {'precision': 0.34407744383597083, 'recall': 0.18711235652061764, 'f1-score': 0.2424035299567869, 'support': 170582}, '2': {'precision': 0.37883802066389205, 'recall': 0.5091978287092883, 'f1-score': 0.43444979769845815, 'support': 198960}, 'accuracy': 0.36623954933607544, 'macro avg': {'precision': 0.36085174725762137, 'recall': 0.357897253037363, 'f1-score': 0.3483834867790718, 'support': 559175}, 'weighted avg': {'precision': 0.3617232547938063, 'recall': 0.36623954933607544, 'f1-score': 0.35342978648733203, 'support': 559175}}
[[ 71564  29759  88310]
 [ 60861  31918  77803]
 [ 66563  31087 101310]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.073526
{'0': {'precision': 0.4421145894861193, 'recall': 0.4143724049824337, 'f1-score': 0.4277942033127068, 'support': 46965}, '1': {'precision': 0.4243389017903963, 'recall': 0.25124747732363445, 'f1-score': 0.3156193845853822, 'support': 45091}, '2': {'precision': 0.40022575429390767, 'recall': 0.5933782622461441, 'f1-score': 0.4780279842588544, 'support': 44218}, 'accuracy': 0.41848041445910444, 'macro avg': {'precision': 0.4222264151901411, 'recall': 0.4196660481840708, 'f1-score': 0.40714719071898114, 'support': 136274}, 'weighted avg': {'precision': 0.422640852394546, 'recall': 0.41848041445910444, 'f1-score': 0.40697704504805593, 'support': 136274}}
[[19461  8287 19217]
 [13659 11329 20103]
 [10898  7082 26238]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1004333
{'0': {'precision': 0.4208905256109809, 'recall': 0.35801344116641987, 'f1-score': 0.3869141045763703, 'support': 17558}, '1': {'precision': 0.4327033878773911, 'recall': 0.2385490121339178, 'f1-score': 0.30754740161349764, 'support': 15741}, '2': {'precision': 0.3574769205742405, 'recall': 0.589814131382943, 'f1-score': 0.44515344879975693, 'support': 14903}, 'accuracy': 0.3906684369943156, 'macro avg': {'precision': 0.4036902780208709, 'recall': 0.3954588615610935, 'f1-score': 0.37987165166320835, 'support': 48202}, 'weighted avg': {'precision': 0.4051420776020398, 'recall': 0.3906684369943156, 'f1-score': 0.3790021854780456, 'support': 48202}}
[[6286 2590 8682]
 [4869 3755 7117]
 [3780 2333 8790]]
training model: results/QRTEA/W6/deepVOL_L3/h500
Epoch 1/50
533/533 - 22s - loss: 3.3117 - accuracy500: 0.3756 - val_loss: 3.3130 - val_accuracy500: 0.3543 - 22s/epoch - 41ms/step
Epoch 2/50
533/533 - 20s - loss: 3.2894 - accuracy500: 0.3613 - val_loss: 3.3046 - val_accuracy500: 0.3473 - 20s/epoch - 37ms/step
Epoch 3/50
533/533 - 20s - loss: 3.2701 - accuracy500: 0.3812 - val_loss: 3.3119 - val_accuracy500: 0.3417 - 20s/epoch - 37ms/step
Epoch 4/50
533/533 - 20s - loss: 3.2611 - accuracy500: 0.3898 - val_loss: 3.3097 - val_accuracy500: 0.3437 - 20s/epoch - 37ms/step
Epoch 5/50
533/533 - 20s - loss: 3.2473 - accuracy500: 0.4007 - val_loss: 3.3385 - val_accuracy500: 0.3248 - 20s/epoch - 37ms/step
Epoch 6/50
533/533 - 20s - loss: 3.2464 - accuracy500: 0.4001 - val_loss: 3.3447 - val_accuracy500: 0.3211 - 20s/epoch - 37ms/step
Epoch 7/50
533/533 - 20s - loss: 3.2288 - accuracy500: 0.4069 - val_loss: 3.3315 - val_accuracy500: 0.3331 - 20s/epoch - 37ms/step
Epoch 8/50
533/533 - 20s - loss: 3.2239 - accuracy500: 0.4108 - val_loss: 3.3301 - val_accuracy500: 0.3357 - 20s/epoch - 37ms/step
Epoch 9/50
533/533 - 19s - loss: 3.2053 - accuracy500: 0.4234 - val_loss: 3.3504 - val_accuracy500: 0.3325 - 19s/epoch - 36ms/step
Epoch 10/50
533/533 - 19s - loss: 3.1943 - accuracy500: 0.4294 - val_loss: 3.3452 - val_accuracy500: 0.3396 - 19s/epoch - 36ms/step
Epoch 11/50
533/533 - 20s - loss: 3.1800 - accuracy500: 0.4344 - val_loss: 3.3642 - val_accuracy500: 0.3343 - 20s/epoch - 37ms/step
Epoch 12/50
533/533 - 20s - loss: 3.1710 - accuracy500: 0.4408 - val_loss: 3.3798 - val_accuracy500: 0.3364 - 20s/epoch - 38ms/step
testing model: results/QRTEA/W6/deepVOL_L3/h500
Evaluating performance on  test set...
2185/2185 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1091086
{'0': {'precision': 0.3345752254390128, 'recall': 0.14309783105138693, 'f1-score': 0.20045924061791323, 'support': 197054}, '1': {'precision': 0.2768504282890402, 'recall': 0.3602949296781109, 'f1-score': 0.31310847468152553, 'support': 153935}, '2': {'precision': 0.3844800646846079, 'recall': 0.50706579693159, 'f1-score': 0.43734528709536424, 'support': 208186}, 'accuracy': 0.3383985335538964, 'macro avg': {'precision': 0.3319685728042203, 'recall': 0.33681951922036263, 'f1-score': 0.3169710007982677, 'support': 559175}, 'weighted avg': {'precision': 0.3372642265815933, 'recall': 0.3383985335538964, 'f1-score': 0.3196652464614091, 'support': 559175}}
[[ 28198  70410  98446]
 [ 27920  55462  70553]
 [ 28162  74460 105564]]
Evaluating performance on  train set...
533/533 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0966773
{'0': {'precision': 0.4071948298458896, 'recall': 0.18879785428409782, 'f1-score': 0.2579813886900501, 'support': 47723}, '1': {'precision': 0.32408502843185893, 'recall': 0.3902125215393452, 'f1-score': 0.35408783396399496, 'support': 43525}, '2': {'precision': 0.37325278178196014, 'recall': 0.5118153955492383, 'f1-score': 0.4316876937630542, 'support': 45026}, 'accuracy': 0.35985587859753143, 'macro avg': {'precision': 0.36817754668656955, 'recall': 0.3636085904575605, 'f1-score': 0.34791897213903306, 'support': 136274}, 'weighted avg': {'precision': 0.36943539838668116, 'recall': 0.35985587859753143, 'f1-score': 0.34607106920699043, 'support': 136274}}
[[ 9010 18682 20031]
 [ 7876 16984 18665]
 [ 5241 16740 23045]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1020304
{'0': {'precision': 0.3376483279395901, 'recall': 0.13265923952530878, 'f1-score': 0.19048033036296455, 'support': 16516}, '1': {'precision': 0.37835934113567404, 'recall': 0.3949660633484163, 'f1-score': 0.3864843922957716, 'support': 17680}, '2': {'precision': 0.31925871780539194, 'recall': 0.5301299443095816, 'f1-score': 0.39851863779083807, 'support': 14006}, 'accuracy': 0.3443633044272022, 'macro avg': {'precision': 0.3450887956268853, 'recall': 0.3525850823944355, 'f1-score': 0.32516112014985804, 'support': 48202}, 'weighted avg': {'precision': 0.34723726270925076, 'recall': 0.3443633044272022, 'f1-score': 0.32282206615830134, 'support': 48202}}
[[2191 6442 7883]
 [2748 6983 7949]
 [1550 5031 7425]]
training model: results/QRTEA/W6/deepVOL_L3/h1000
Epoch 1/50
533/533 - 23s - loss: 3.2512 - accuracy1000: 0.4195 - val_loss: 3.3248 - val_accuracy1000: 0.3229 - 23s/epoch - 42ms/step
Epoch 2/50
533/533 - 20s - loss: 3.2605 - accuracy1000: 0.4067 - val_loss: 3.2998 - val_accuracy1000: 0.3268 - 20s/epoch - 37ms/step
Epoch 3/50
533/533 - 20s - loss: 3.2690 - accuracy1000: 0.3879 - val_loss: 3.2834 - val_accuracy1000: 0.3341 - 20s/epoch - 37ms/step
Epoch 4/50
533/533 - 20s - loss: 3.2754 - accuracy1000: 0.3747 - val_loss: 3.2791 - val_accuracy1000: 0.3442 - 20s/epoch - 37ms/step
Epoch 5/50
533/533 - 20s - loss: 3.2613 - accuracy1000: 0.3954 - val_loss: 3.2984 - val_accuracy1000: 0.3341 - 20s/epoch - 37ms/step
Epoch 6/50
533/533 - 19s - loss: 3.2502 - accuracy1000: 0.3993 - val_loss: 3.3091 - val_accuracy1000: 0.3259 - 19s/epoch - 36ms/step
Epoch 7/50
533/533 - 20s - loss: 3.2429 - accuracy1000: 0.4059 - val_loss: 3.3140 - val_accuracy1000: 0.3361 - 20s/epoch - 37ms/step
Epoch 8/50
533/533 - 20s - loss: 3.2373 - accuracy1000: 0.4092 - val_loss: 3.3115 - val_accuracy1000: 0.3403 - 20s/epoch - 37ms/step
Epoch 9/50
533/533 - 20s - loss: 3.2333 - accuracy1000: 0.4128 - val_loss: 3.3480 - val_accuracy1000: 0.3287 - 20s/epoch - 37ms/step
Epoch 10/50
533/533 - 19s - loss: 3.2200 - accuracy1000: 0.4177 - val_loss: 3.3524 - val_accuracy1000: 0.3288 - 19s/epoch - 36ms/step
Epoch 11/50
533/533 - 20s - loss: 3.1861 - accuracy1000: 0.4364 - val_loss: 3.3992 - val_accuracy1000: 0.3265 - 20s/epoch - 37ms/step
Epoch 12/50
533/533 - 20s - loss: 3.1576 - accuracy1000: 0.4519 - val_loss: 3.4318 - val_accuracy1000: 0.3321 - 20s/epoch - 37ms/step
Epoch 13/50
533/533 - 19s - loss: 3.1646 - accuracy1000: 0.4490 - val_loss: 3.4882 - val_accuracy1000: 0.3271 - 19s/epoch - 36ms/step
Epoch 14/50
533/533 - 20s - loss: 3.1350 - accuracy1000: 0.4616 - val_loss: 3.5152 - val_accuracy1000: 0.3318 - 20s/epoch - 37ms/step
testing model: results/QRTEA/W6/deepVOL_L3/h1000
Evaluating performance on  test set...
2185/2185 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.108632
{'0': {'precision': 0.25995609317305457, 'recall': 0.28030359553152956, 'f1-score': 0.26974667597892993, 'support': 147433}, '1': {'precision': 0.406121045392022, 'recall': 0.004937724465776678, 'f1-score': 0.009756822960340705, 'support': 239179}, '2': {'precision': 0.32074987289010154, 'recall': 0.7384665310640172, 'f1-score': 0.4472420273858178, 'support': 172563}, 'accuracy': 0.303910224884875, 'macro avg': {'precision': 0.328942337151726, 'recall': 0.34123595035377446, 'f1-score': 0.24224850877502946, 'support': 559175}, 'weighted avg': {'precision': 0.3412371663900138, 'recall': 0.303910224884875, 'f1-score': 0.21331535710683022, 'support': 559175}}
[[ 41326    877 105230]
 [ 73366   1181 164632]
 [ 44281    850 127432]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0974188
{'0': {'precision': 0.3782186689483676, 'recall': 0.29543840594845233, 'f1-score': 0.33174243934472364, 'support': 47878}, '1': {'precision': 0.3397291196388262, 'recall': 0.006909533319560178, 'f1-score': 0.013543611779792571, 'support': 43563}, '2': {'precision': 0.34916164059231136, 'recall': 0.7631432203956907, 'f1-score': 0.4791138620100544, 'support': 44833}, 'accuracy': 0.35707471711404964, 'macro avg': {'precision': 0.355703143059835, 'recall': 0.35516371988790113, 'f1-score': 0.27479997104485687, 'support': 136274}, 'weighted avg': {'precision': 0.3563551147204252, 'recall': 0.35707471711404964, 'f1-score': 0.27850710074120194, 'support': 136274}}
[[14145   342 33391]
 [12878   301 30384]
 [10376   243 34214]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984765
{'0': {'precision': 0.39693265507554476, 'recall': 0.2648161280518691, 'f1-score': 0.31768602072129554, 'support': 19742}, '1': {'precision': 0.24390243902439024, 'recall': 0.005279034690799397, 'f1-score': 0.010334391378164907, 'support': 13260}, '2': {'precision': 0.32437255353442324, 'recall': 0.7414473684210526, 'f1-score': 0.4513054621175717, 'support': 15200}, 'accuracy': 0.34372017758599227, 'macro avg': {'precision': 0.3217358825447861, 'recall': 0.3371808437212404, 'f1-score': 0.2597752914056774, 'support': 48202}, 'weighted avg': {'precision': 0.3319541436390202, 'recall': 0.34372017758599227, 'f1-score': 0.27527145087219146, 'support': 48202}}
[[ 5228   137 14377]
 [ 4093    70  9097]
 [ 3850    80 11270]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        15 (peak)  12.86 (ave)

============================================
