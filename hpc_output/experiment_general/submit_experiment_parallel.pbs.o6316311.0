This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/LILAK_orderbooks/LILAK_orderbooks_2019-02-06.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-01-29.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-01-16.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-01-17.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-01-25.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-01-23.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-01-18.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-02-08.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-01-22.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-02-04.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-01-24.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-01-15.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-01-31.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-01-30.csv
training model: results/LILAK/W0/deepLOB_L1/h10
Epoch 1/50
318/318 - 39s - loss: 3.3204 - accuracy10: 0.3516 - val_loss: 3.2783 - val_accuracy10: 0.3689 - 39s/epoch - 123ms/step
Epoch 2/50
318/318 - 10s - loss: 3.2515 - accuracy10: 0.3709 - val_loss: 3.1903 - val_accuracy10: 0.4035 - 10s/epoch - 30ms/step
Epoch 3/50
318/318 - 9s - loss: 3.2184 - accuracy10: 0.3799 - val_loss: 3.2103 - val_accuracy10: 0.4339 - 9s/epoch - 29ms/step
Epoch 4/50
318/318 - 10s - loss: 3.2034 - accuracy10: 0.3882 - val_loss: 3.1591 - val_accuracy10: 0.4689 - 10s/epoch - 30ms/step
Epoch 5/50
318/318 - 9s - loss: 3.1840 - accuracy10: 0.4067 - val_loss: 3.2317 - val_accuracy10: 0.3858 - 9s/epoch - 30ms/step
Epoch 6/50
318/318 - 9s - loss: 3.1721 - accuracy10: 0.4188 - val_loss: 3.1472 - val_accuracy10: 0.4773 - 9s/epoch - 29ms/step
Epoch 7/50
318/318 - 9s - loss: 3.1606 - accuracy10: 0.4307 - val_loss: 3.1096 - val_accuracy10: 0.4878 - 9s/epoch - 30ms/step
Epoch 8/50
318/318 - 9s - loss: 3.1447 - accuracy10: 0.4395 - val_loss: 3.1123 - val_accuracy10: 0.4900 - 9s/epoch - 29ms/step
Epoch 9/50
318/318 - 9s - loss: 3.1382 - accuracy10: 0.4481 - val_loss: 3.1050 - val_accuracy10: 0.4847 - 9s/epoch - 29ms/step
Epoch 10/50
318/318 - 10s - loss: 3.1332 - accuracy10: 0.4512 - val_loss: 3.0862 - val_accuracy10: 0.4627 - 10s/epoch - 30ms/step
Epoch 11/50
318/318 - 9s - loss: 3.1250 - accuracy10: 0.4544 - val_loss: 3.0930 - val_accuracy10: 0.4756 - 9s/epoch - 30ms/step
Epoch 12/50
318/318 - 9s - loss: 3.1221 - accuracy10: 0.4545 - val_loss: 3.0958 - val_accuracy10: 0.4597 - 9s/epoch - 30ms/step
Epoch 13/50
318/318 - 9s - loss: 3.1169 - accuracy10: 0.4590 - val_loss: 3.0949 - val_accuracy10: 0.4733 - 9s/epoch - 29ms/step
Epoch 14/50
318/318 - 9s - loss: 3.1108 - accuracy10: 0.4605 - val_loss: 3.0959 - val_accuracy10: 0.4770 - 9s/epoch - 29ms/step
Epoch 15/50
318/318 - 9s - loss: 3.1086 - accuracy10: 0.4616 - val_loss: 3.0871 - val_accuracy10: 0.4921 - 9s/epoch - 30ms/step
Epoch 16/50
318/318 - 9s - loss: 3.1039 - accuracy10: 0.4637 - val_loss: 3.0937 - val_accuracy10: 0.4592 - 9s/epoch - 30ms/step
Epoch 17/50
318/318 - 9s - loss: 3.1014 - accuracy10: 0.4649 - val_loss: 3.0934 - val_accuracy10: 0.4453 - 9s/epoch - 30ms/step
Epoch 18/50
318/318 - 9s - loss: 3.0966 - accuracy10: 0.4661 - val_loss: 3.0730 - val_accuracy10: 0.4914 - 9s/epoch - 30ms/step
Epoch 19/50
318/318 - 9s - loss: 3.0906 - accuracy10: 0.4669 - val_loss: 3.0802 - val_accuracy10: 0.4925 - 9s/epoch - 30ms/step
Epoch 20/50
318/318 - 9s - loss: 3.0897 - accuracy10: 0.4695 - val_loss: 3.0965 - val_accuracy10: 0.5001 - 9s/epoch - 30ms/step
Epoch 21/50
318/318 - 9s - loss: 3.0878 - accuracy10: 0.4692 - val_loss: 3.0905 - val_accuracy10: 0.4948 - 9s/epoch - 29ms/step
Epoch 22/50
318/318 - 10s - loss: 3.0829 - accuracy10: 0.4699 - val_loss: 3.0934 - val_accuracy10: 0.4891 - 10s/epoch - 30ms/step
Epoch 23/50
318/318 - 9s - loss: 3.0836 - accuracy10: 0.4690 - val_loss: 3.0877 - val_accuracy10: 0.4821 - 9s/epoch - 29ms/step
Epoch 24/50
318/318 - 9s - loss: 3.0791 - accuracy10: 0.4721 - val_loss: 3.0742 - val_accuracy10: 0.4954 - 9s/epoch - 29ms/step
Epoch 25/50
318/318 - 10s - loss: 3.0740 - accuracy10: 0.4725 - val_loss: 3.0863 - val_accuracy10: 0.5005 - 10s/epoch - 32ms/step
Epoch 26/50
318/318 - 9s - loss: 3.0720 - accuracy10: 0.4748 - val_loss: 3.0878 - val_accuracy10: 0.5023 - 9s/epoch - 30ms/step
Epoch 27/50
318/318 - 9s - loss: 3.0673 - accuracy10: 0.4758 - val_loss: 3.0921 - val_accuracy10: 0.4919 - 9s/epoch - 29ms/step
Epoch 28/50
318/318 - 9s - loss: 3.0652 - accuracy10: 0.4755 - val_loss: 3.1167 - val_accuracy10: 0.4929 - 9s/epoch - 28ms/step
testing model: results/LILAK/W0/deepLOB_L1/h10
Evaluating performance on  test set...
876/876 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9846703
{'0': {'precision': 0.3211996088232098, 'recall': 0.5279160620604978, 'f1-score': 0.3993953672974776, 'support': 44795}, '1': {'precision': 0.7150746213246213, 'recall': 0.5781901960195719, 'f1-score': 0.6393882056133712, 'support': 133252}, '2': {'precision': 0.37789515507046534, 'recall': 0.3506766721610133, 'f1-score': 0.363777490297542, 'support': 46108}, 'accuracy': 0.5213446052954429, 'macro avg': {'precision': 0.4713897950727655, 'recall': 0.485594310080361, 'f1-score': 0.467520354402797, 'support': 224155}, 'weighted avg': {'precision': 0.5670060883226924, 'recall': 0.5213446052954429, 'f1-score': 0.5347358978167898, 'support': 224155}}
[[23648 14897  6250]
 [35839 77045 20368]
 [14137 15802 16169]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0362433
{'0': {'precision': 0.37746404836105585, 'recall': 0.47308235294117645, 'f1-score': 0.4198985026000877, 'support': 21250}, '1': {'precision': 0.5980629539951574, 'recall': 0.47896308014186206, 'f1-score': 0.5319278559385671, 'support': 39193}, '2': {'precision': 0.3838066100745465, 'recall': 0.4285301900408949, 'f1-score': 0.40493726132024, 'support': 20785}, 'accuracy': 0.46451962377505296, 'macro avg': {'precision': 0.4531112041435866, 'recall': 0.4601918743746445, 'f1-score': 0.45225453995296494, 'support': 81228}, 'weighted avg': {'precision': 0.4855273153839081, 'recall': 0.46451962377505296, 'f1-score': 0.4701249890997354, 'support': 81228}}
[[10053  6369  4828]
 [10949 18772  9472]
 [ 5631  6247  8907]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0141637
{'0': {'precision': 0.35033788260235854, 'recall': 0.42385379929464573, 'f1-score': 0.3836053681537903, 'support': 6238}, '1': {'precision': 0.6223412394797245, 'recall': 0.5932030338389732, 'f1-score': 0.6074228959749085, 'support': 13712}, '2': {'precision': 0.39567733151803947, 'recall': 0.3553415864282439, 'f1-score': 0.3744262823093647, 'support': 6543}, 'accuracy': 0.494583474880157, 'macro avg': {'precision': 0.4561188178667075, 'recall': 0.4574661398539543, 'f1-score': 0.45515151547935445, 'support': 26493}, 'weighted avg': {'precision': 0.5023163691368296, 'recall': 0.494583474880157, 'f1-score': 0.49717979093728387, 'support': 26493}}
[[2644 2431 1163]
 [3190 8134 2388]
 [1713 2505 2325]]
training model: results/LILAK/W0/deepLOB_L1/h20
Epoch 1/50
318/318 - 12s - loss: 3.3316 - accuracy20: 0.3555 - val_loss: 3.2852 - val_accuracy20: 0.3910 - 12s/epoch - 39ms/step
Epoch 2/50
318/318 - 10s - loss: 3.2798 - accuracy20: 0.3793 - val_loss: 3.2783 - val_accuracy20: 0.3633 - 10s/epoch - 30ms/step
Epoch 3/50
318/318 - 9s - loss: 3.2476 - accuracy20: 0.3939 - val_loss: 3.2652 - val_accuracy20: 0.3748 - 9s/epoch - 30ms/step
Epoch 4/50
318/318 - 9s - loss: 3.2383 - accuracy20: 0.3986 - val_loss: 3.2461 - val_accuracy20: 0.3835 - 9s/epoch - 29ms/step
Epoch 5/50
318/318 - 9s - loss: 3.2249 - accuracy20: 0.4085 - val_loss: 3.2356 - val_accuracy20: 0.3863 - 9s/epoch - 29ms/step
Epoch 6/50
318/318 - 9s - loss: 3.2064 - accuracy20: 0.4172 - val_loss: 3.2038 - val_accuracy20: 0.4232 - 9s/epoch - 30ms/step
Epoch 7/50
318/318 - 9s - loss: 3.1969 - accuracy20: 0.4265 - val_loss: 3.2318 - val_accuracy20: 0.4013 - 9s/epoch - 29ms/step
Epoch 8/50
318/318 - 9s - loss: 3.1883 - accuracy20: 0.4280 - val_loss: 3.1983 - val_accuracy20: 0.4205 - 9s/epoch - 29ms/step
Epoch 9/50
318/318 - 10s - loss: 3.1812 - accuracy20: 0.4324 - val_loss: 3.1874 - val_accuracy20: 0.4239 - 10s/epoch - 30ms/step
Epoch 10/50
318/318 - 9s - loss: 3.1731 - accuracy20: 0.4380 - val_loss: 3.2052 - val_accuracy20: 0.4125 - 9s/epoch - 29ms/step
Epoch 11/50
318/318 - 9s - loss: 3.1660 - accuracy20: 0.4408 - val_loss: 3.2131 - val_accuracy20: 0.4103 - 9s/epoch - 30ms/step
Epoch 12/50
318/318 - 9s - loss: 3.1654 - accuracy20: 0.4407 - val_loss: 3.2472 - val_accuracy20: 0.3882 - 9s/epoch - 30ms/step
Epoch 13/50
318/318 - 9s - loss: 3.1564 - accuracy20: 0.4462 - val_loss: 3.1997 - val_accuracy20: 0.4189 - 9s/epoch - 29ms/step
Epoch 14/50
318/318 - 9s - loss: 3.1536 - accuracy20: 0.4472 - val_loss: 3.2062 - val_accuracy20: 0.4156 - 9s/epoch - 29ms/step
Epoch 15/50
318/318 - 9s - loss: 3.1503 - accuracy20: 0.4475 - val_loss: 3.2084 - val_accuracy20: 0.4193 - 9s/epoch - 29ms/step
Epoch 16/50
318/318 - 9s - loss: 3.1444 - accuracy20: 0.4491 - val_loss: 3.2109 - val_accuracy20: 0.4115 - 9s/epoch - 29ms/step
Epoch 17/50
318/318 - 9s - loss: 3.1431 - accuracy20: 0.4497 - val_loss: 3.1951 - val_accuracy20: 0.4257 - 9s/epoch - 29ms/step
Epoch 18/50
318/318 - 9s - loss: 3.1392 - accuracy20: 0.4500 - val_loss: 3.2138 - val_accuracy20: 0.4124 - 9s/epoch - 29ms/step
Epoch 19/50
318/318 - 9s - loss: 3.1357 - accuracy20: 0.4520 - val_loss: 3.2260 - val_accuracy20: 0.4044 - 9s/epoch - 28ms/step
testing model: results/LILAK/W0/deepLOB_L1/h20
Evaluating performance on  test set...
876/876 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0502586
{'0': {'precision': 0.32424465020973886, 'recall': 0.6045920666101969, 'f1-score': 0.42211023661677644, 'support': 55487}, '1': {'precision': 0.5993890779647156, 'recall': 0.4461881400845091, 'f1-score': 0.5115648911766065, 'support': 111704}, '2': {'precision': 0.3892647842301545, 'recall': 0.25653044027807037, 'f1-score': 0.3092567510369931, 'support': 56964}, 'accuracy': 0.4372019361602463, 'macro avg': {'precision': 0.437632837468203, 'recall': 0.43577021565759216, 'f1-score': 0.414310626276792, 'support': 224155}, 'weighted avg': {'precision': 0.4778818212399675, 'recall': 0.4372019361602463, 'f1-score': 0.43800930993829273, 'support': 224155}}
[[33547 15231  6709]
 [45645 49841 16218]
 [24270 18081 14613]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0716884
{'0': {'precision': 0.3916063675832127, 'recall': 0.522595596755504, 'f1-score': 0.44771674387822635, 'support': 25890}, '1': {'precision': 0.451096375555723, 'recall': 0.39907339510699286, 'f1-score': 0.423493208828523, 'support': 30002}, '2': {'precision': 0.42297377830750893, 'recall': 0.3361619829491632, 'f1-score': 0.3746041520056298, 'support': 25336}, 'accuracy': 0.4188210961737332, 'macro avg': {'precision': 0.42189217381548155, 'recall': 0.4192769916038867, 'f1-score': 0.41527136823745975, 'support': 81228}, 'weighted avg': {'precision': 0.4233631994306301, 'recall': 0.4188210961737332, 'f1-score': 0.41596494491425695, 'support': 81228}}
[[13530  7223  5137]
 [11547 11973  6482]
 [ 9473  7346  8517]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0640781
{'0': {'precision': 0.3608216432865731, 'recall': 0.47437755236464235, 'f1-score': 0.4098799157703033, 'support': 7591}, '1': {'precision': 0.5004382120946538, 'recall': 0.472682119205298, 'f1-score': 0.486164325244785, 'support': 10872}, '2': {'precision': 0.4101537475976938, 'recall': 0.31892901618929015, 'f1-score': 0.35883424408014575, 'support': 8030}, 'accuracy': 0.4265655078700034, 'macro avg': {'precision': 0.4238045343263069, 'recall': 0.42199622925307684, 'f1-score': 0.418292828365078, 'support': 26493}, 'weighted avg': {'precision': 0.4330689589435297, 'recall': 0.4265655078700034, 'f1-score': 0.4257130549442209, 'support': 26493}}
[[3601 2446 1544]
 [3594 5139 2139]
 [2785 2684 2561]]
training model: results/LILAK/W0/deepLOB_L1/h30
Epoch 1/50
318/318 - 12s - loss: 3.3308 - accuracy30: 0.3589 - val_loss: 3.3518 - val_accuracy30: 0.3591 - 12s/epoch - 38ms/step
Epoch 2/50
318/318 - 9s - loss: 3.2762 - accuracy30: 0.3799 - val_loss: 3.3033 - val_accuracy30: 0.3590 - 9s/epoch - 29ms/step
Epoch 3/50
318/318 - 9s - loss: 3.2601 - accuracy30: 0.3922 - val_loss: 3.2793 - val_accuracy30: 0.3840 - 9s/epoch - 29ms/step
Epoch 4/50
318/318 - 9s - loss: 3.2484 - accuracy30: 0.4018 - val_loss: 3.2510 - val_accuracy30: 0.3889 - 9s/epoch - 29ms/step
Epoch 5/50
318/318 - 10s - loss: 3.2339 - accuracy30: 0.4072 - val_loss: 3.2664 - val_accuracy30: 0.3840 - 10s/epoch - 30ms/step
Epoch 6/50
318/318 - 9s - loss: 3.2264 - accuracy30: 0.4134 - val_loss: 3.2365 - val_accuracy30: 0.3998 - 9s/epoch - 30ms/step
Epoch 7/50
318/318 - 9s - loss: 3.2186 - accuracy30: 0.4170 - val_loss: 3.2379 - val_accuracy30: 0.4087 - 9s/epoch - 29ms/step
Epoch 8/50
318/318 - 10s - loss: 3.2116 - accuracy30: 0.4227 - val_loss: 3.2277 - val_accuracy30: 0.4064 - 10s/epoch - 30ms/step
Epoch 9/50
318/318 - 9s - loss: 3.2056 - accuracy30: 0.4259 - val_loss: 3.2239 - val_accuracy30: 0.4118 - 9s/epoch - 28ms/step
Epoch 10/50
318/318 - 9s - loss: 3.1981 - accuracy30: 0.4291 - val_loss: 3.2271 - val_accuracy30: 0.4104 - 9s/epoch - 28ms/step
Epoch 11/50
318/318 - 9s - loss: 3.1905 - accuracy30: 0.4330 - val_loss: 3.2322 - val_accuracy30: 0.4096 - 9s/epoch - 29ms/step
Epoch 12/50
318/318 - 9s - loss: 3.1875 - accuracy30: 0.4338 - val_loss: 3.2227 - val_accuracy30: 0.4149 - 9s/epoch - 29ms/step
Epoch 13/50
318/318 - 10s - loss: 3.1811 - accuracy30: 0.4366 - val_loss: 3.2191 - val_accuracy30: 0.4183 - 10s/epoch - 30ms/step
Epoch 14/50
318/318 - 9s - loss: 3.1781 - accuracy30: 0.4381 - val_loss: 3.2216 - val_accuracy30: 0.4163 - 9s/epoch - 29ms/step
Epoch 15/50
318/318 - 9s - loss: 3.1752 - accuracy30: 0.4404 - val_loss: 3.2451 - val_accuracy30: 0.4096 - 9s/epoch - 29ms/step
Epoch 16/50
318/318 - 9s - loss: 3.1693 - accuracy30: 0.4413 - val_loss: 3.2665 - val_accuracy30: 0.4103 - 9s/epoch - 30ms/step
Epoch 17/50
318/318 - 9s - loss: 3.1681 - accuracy30: 0.4432 - val_loss: 3.2638 - val_accuracy30: 0.4089 - 9s/epoch - 28ms/step
Epoch 18/50
318/318 - 10s - loss: 3.1626 - accuracy30: 0.4451 - val_loss: 3.2404 - val_accuracy30: 0.4166 - 10s/epoch - 30ms/step
Epoch 19/50
318/318 - 9s - loss: 3.1571 - accuracy30: 0.4467 - val_loss: 3.2603 - val_accuracy30: 0.4094 - 9s/epoch - 29ms/step
Epoch 20/50
318/318 - 9s - loss: 3.1560 - accuracy30: 0.4473 - val_loss: 3.2614 - val_accuracy30: 0.4130 - 9s/epoch - 28ms/step
Epoch 21/50
318/318 - 9s - loss: 3.1513 - accuracy30: 0.4485 - val_loss: 3.2867 - val_accuracy30: 0.4018 - 9s/epoch - 29ms/step
Epoch 22/50
318/318 - 9s - loss: 3.1482 - accuracy30: 0.4501 - val_loss: 3.3259 - val_accuracy30: 0.4001 - 9s/epoch - 30ms/step
Epoch 23/50
318/318 - 10s - loss: 3.1464 - accuracy30: 0.4500 - val_loss: 3.3173 - val_accuracy30: 0.4046 - 10s/epoch - 30ms/step
testing model: results/LILAK/W0/deepLOB_L1/h30
Evaluating performance on  test set...
876/876 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0389129
{'0': {'precision': 0.3630294896940917, 'recall': 0.35799117746861214, 'f1-score': 0.3604927303480207, 'support': 58940}, '1': {'precision': 0.5154067439722412, 'recall': 0.662644056164031, 'f1-score': 0.5798242577663971, 'support': 104907}, '2': {'precision': 0.42311519080784415, 'recall': 0.21859454798700007, 'f1-score': 0.28826327010331815, 'support': 60308}, 'accuracy': 0.46306796636256164, 'macro avg': {'precision': 0.43385047482472566, 'recall': 0.4130765938732144, 'f1-score': 0.40952675273924527, 'support': 224155}, 'weighted avg': {'precision': 0.4505095328665662, 'recall': 0.46306796636256164, 'f1-score': 0.4437092468586589, 'support': 224155}}
[[21100 31933  5907]
 [23324 69516 12067]
 [13698 33427 13183]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.082747
{'0': {'precision': 0.44471955533097524, 'recall': 0.3184268605955353, 'f1-score': 0.371123152501634, 'support': 27639}, '1': {'precision': 0.36984525642064325, 'recall': 0.5138643953322577, 'f1-score': 0.4301193467336683, 'support': 26651}, '2': {'precision': 0.42193453234462697, 'recall': 0.38232236988640583, 'f1-score': 0.40115293980174105, 'support': 26938}, 'accuracy': 0.4037400896242675, 'macro avg': {'precision': 0.41216644803208186, 'recall': 0.40487120860473297, 'f1-score': 0.40079847967901444, 'support': 81228}, 'weighted avg': {'precision': 0.4125969142532002, 'recall': 0.4037400896242675, 'f1-score': 0.40043878236779135, 'support': 81228}}
[[ 8801 11842  6996]
 [ 5842 13695  7114]
 [ 5147 11492 10299]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0725666
{'0': {'precision': 0.40540540540540543, 'recall': 0.26306039273805115, 'f1-score': 0.31907722267994915, 'support': 8097}, '1': {'precision': 0.41712020823473733, 'recall': 0.7014524472741743, 'f1-score': 0.5231488351387446, 'support': 10052}, '2': {'precision': 0.44405997693194926, 'recall': 0.23070469798657717, 'f1-score': 0.3036517075479139, 'support': 8344}, 'accuracy': 0.419205073038161, 'macro avg': {'precision': 0.422195196857364, 'recall': 0.3984058459996009, 'f1-score': 0.3819592551222026, 'support': 26493}, 'weighted avg': {'precision': 0.4220245479282578, 'recall': 0.419205073038161, 'f1-score': 0.39164799043649273, 'support': 26493}}
[[2130 4831 1136]
 [1727 7051 1274]
 [1397 5022 1925]]
training model: results/LILAK/W0/deepLOB_L1/h50
Epoch 1/50
318/318 - 13s - loss: 3.3385 - accuracy50: 0.3560 - val_loss: 3.3418 - val_accuracy50: 0.3532 - 13s/epoch - 41ms/step
Epoch 2/50
318/318 - 10s - loss: 3.2954 - accuracy50: 0.3689 - val_loss: 3.2961 - val_accuracy50: 0.3644 - 10s/epoch - 31ms/step
Epoch 3/50
318/318 - 9s - loss: 3.2763 - accuracy50: 0.3792 - val_loss: 3.2985 - val_accuracy50: 0.3902 - 9s/epoch - 29ms/step
Epoch 4/50
318/318 - 9s - loss: 3.2636 - accuracy50: 0.3882 - val_loss: 3.2769 - val_accuracy50: 0.3839 - 9s/epoch - 30ms/step
Epoch 5/50
318/318 - 10s - loss: 3.2579 - accuracy50: 0.3915 - val_loss: 3.2654 - val_accuracy50: 0.3863 - 10s/epoch - 31ms/step
Epoch 6/50
318/318 - 10s - loss: 3.2470 - accuracy50: 0.3975 - val_loss: 3.2802 - val_accuracy50: 0.3941 - 10s/epoch - 30ms/step
Epoch 7/50
318/318 - 10s - loss: 3.2448 - accuracy50: 0.4002 - val_loss: 3.2675 - val_accuracy50: 0.3824 - 10s/epoch - 30ms/step
Epoch 8/50
318/318 - 10s - loss: 3.2370 - accuracy50: 0.4033 - val_loss: 3.2681 - val_accuracy50: 0.3855 - 10s/epoch - 31ms/step
Epoch 9/50
318/318 - 10s - loss: 3.2355 - accuracy50: 0.4072 - val_loss: 3.2747 - val_accuracy50: 0.3823 - 10s/epoch - 30ms/step
Epoch 10/50
318/318 - 9s - loss: 3.2275 - accuracy50: 0.4100 - val_loss: 3.2744 - val_accuracy50: 0.3866 - 9s/epoch - 30ms/step
Epoch 11/50
318/318 - 9s - loss: 3.2246 - accuracy50: 0.4125 - val_loss: 3.2721 - val_accuracy50: 0.3742 - 9s/epoch - 30ms/step
Epoch 12/50
318/318 - 10s - loss: 3.2189 - accuracy50: 0.4161 - val_loss: 3.2724 - val_accuracy50: 0.3861 - 10s/epoch - 30ms/step
Epoch 13/50
318/318 - 10s - loss: 3.2150 - accuracy50: 0.4199 - val_loss: 3.3074 - val_accuracy50: 0.3756 - 10s/epoch - 30ms/step
Epoch 14/50
318/318 - 9s - loss: 3.2141 - accuracy50: 0.4191 - val_loss: 3.2936 - val_accuracy50: 0.3856 - 9s/epoch - 29ms/step
Epoch 15/50
318/318 - 10s - loss: 3.2092 - accuracy50: 0.4190 - val_loss: 3.2922 - val_accuracy50: 0.3797 - 10s/epoch - 30ms/step
testing model: results/LILAK/W0/deepLOB_L1/h50
Evaluating performance on  test set...
876/876 - 16s - 16s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0785475
{'0': {'precision': 0.335804791678194, 'recall': 0.39773900221184566, 'f1-score': 0.36415729747162984, 'support': 61035}, '1': {'precision': 0.4625029105693969, 'recall': 0.5143568547383098, 'f1-score': 0.48705361984655793, 'support': 100405}, '2': {'precision': 0.34367304295913037, 'recall': 0.22029817428047516, 'f1-score': 0.2684908080376229, 'support': 62715}, 'accuracy': 0.4003301287055832, 'macro avg': {'precision': 0.3806602484022404, 'recall': 0.37746467707687686, 'f1-score': 0.3732339084519369, 'support': 224155}, 'weighted avg': {'precision': 0.3947576680644229, 'recall': 0.4003301287055832, 'f1-score': 0.39243987588032425, 'support': 224155}}
[[24276 28203  8556]
 [30932 51644 17829]
 [17084 31815 13816]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0960373
{'0': {'precision': 0.41274106175514624, 'recall': 0.34414974344149746, 'f1-score': 0.37533744507280936, 'support': 27674}, '1': {'precision': 0.3485647510037754, 'recall': 0.434358897767157, 'f1-score': 0.3867610878382871, 'support': 26782}, '2': {'precision': 0.3839541547277937, 'recall': 0.3553712834304497, 'f1-score': 0.36911020154798163, 'support': 26772}, 'accuracy': 0.37759147092135714, 'macro avg': {'precision': 0.3817533224955718, 'recall': 0.3779599748797014, 'f1-score': 0.37706957815302605, 'support': 81228}, 'weighted avg': {'precision': 0.38209334139419315, 'recall': 0.37759147092135714, 'f1-score': 0.37705153672714453, 'support': 81228}}
[[ 9524 10566  7584]
 [ 7468 11633  7681]
 [ 6083 11175  9514]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.088204
{'0': {'precision': 0.3790641142509875, 'recall': 0.3031223423642328, 'f1-score': 0.3368662661175994, 'support': 8231}, '1': {'precision': 0.3926953981008035, 'recall': 0.5452885688203671, 'f1-score': 0.45657989723555137, 'support': 9859}, '2': {'precision': 0.39077318759041957, 'recall': 0.28930143996191837, 'f1-score': 0.33246717724288843, 'support': 8403}, 'accuracy': 0.38885743403918016, 'macro avg': {'precision': 0.38751089998073684, 'recall': 0.3792374503821727, 'f1-score': 0.37530444686534636, 'support': 26493}, 'weighted avg': {'precision': 0.38785066808583385, 'recall': 0.38885743403918016, 'f1-score': 0.3800207274990092, 'support': 26493}}
[[2495 4033 1703]
 [2396 5376 2087]
 [1691 4281 2431]]
training model: results/LILAK/W0/deepLOB_L1/h100
Epoch 1/50
318/318 - 12s - loss: 3.3222 - accuracy100: 0.3669 - val_loss: 3.3897 - val_accuracy100: 0.3519 - 12s/epoch - 38ms/step
Epoch 2/50
318/318 - 10s - loss: 3.2875 - accuracy100: 0.3819 - val_loss: 3.2896 - val_accuracy100: 0.4076 - 10s/epoch - 31ms/step
Epoch 3/50
318/318 - 10s - loss: 3.2757 - accuracy100: 0.3827 - val_loss: 3.2833 - val_accuracy100: 0.4049 - 10s/epoch - 30ms/step
Epoch 4/50
318/318 - 10s - loss: 3.2698 - accuracy100: 0.3830 - val_loss: 3.3195 - val_accuracy100: 0.3678 - 10s/epoch - 30ms/step
Epoch 5/50
318/318 - 10s - loss: 3.2647 - accuracy100: 0.3881 - val_loss: 3.3098 - val_accuracy100: 0.3860 - 10s/epoch - 30ms/step
Epoch 6/50
318/318 - 10s - loss: 3.2548 - accuracy100: 0.3964 - val_loss: 3.2667 - val_accuracy100: 0.4083 - 10s/epoch - 31ms/step
Epoch 7/50
318/318 - 9s - loss: 3.2531 - accuracy100: 0.3973 - val_loss: 3.2790 - val_accuracy100: 0.3997 - 9s/epoch - 29ms/step
Epoch 8/50
318/318 - 9s - loss: 3.2433 - accuracy100: 0.4032 - val_loss: 3.2811 - val_accuracy100: 0.4017 - 9s/epoch - 29ms/step
Epoch 9/50
318/318 - 9s - loss: 3.2412 - accuracy100: 0.4027 - val_loss: 3.2930 - val_accuracy100: 0.3910 - 9s/epoch - 30ms/step
Epoch 10/50
318/318 - 9s - loss: 3.2318 - accuracy100: 0.4068 - val_loss: 3.2928 - val_accuracy100: 0.3965 - 9s/epoch - 29ms/step
Epoch 11/50
318/318 - 9s - loss: 3.2320 - accuracy100: 0.4071 - val_loss: 3.3415 - val_accuracy100: 0.3690 - 9s/epoch - 29ms/step
Epoch 12/50
318/318 - 10s - loss: 3.2243 - accuracy100: 0.4145 - val_loss: 3.3306 - val_accuracy100: 0.3706 - 10s/epoch - 31ms/step
Epoch 13/50
318/318 - 10s - loss: 3.2190 - accuracy100: 0.4158 - val_loss: 3.3333 - val_accuracy100: 0.3701 - 10s/epoch - 30ms/step
Epoch 14/50
318/318 - 10s - loss: 3.2160 - accuracy100: 0.4164 - val_loss: 3.3416 - val_accuracy100: 0.3683 - 10s/epoch - 30ms/step
Epoch 15/50
318/318 - 9s - loss: 3.2140 - accuracy100: 0.4185 - val_loss: 3.4273 - val_accuracy100: 0.3315 - 9s/epoch - 29ms/step
Epoch 16/50
318/318 - 10s - loss: 3.2086 - accuracy100: 0.4214 - val_loss: 3.3454 - val_accuracy100: 0.3830 - 10s/epoch - 30ms/step
testing model: results/LILAK/W0/deepLOB_L1/h100
Evaluating performance on  test set...
876/876 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0682724
{'0': {'precision': 0.3028267054052418, 'recall': 0.08760900781003747, 'f1-score': 0.13590123188504216, 'support': 57106}, '1': {'precision': 0.4785101652789119, 'recall': 0.7354886584338012, 'f1-score': 0.5798008904680916, 'support': 109156}, '2': {'precision': 0.2803271696314324, 'recall': 0.19299397163733092, 'f1-score': 0.22860358056265984, 'support': 57893}, 'accuracy': 0.4303227677276884, 'macro avg': {'precision': 0.3538880134385287, 'recall': 0.3386972126270565, 'f1-score': 0.31476856763859784, 'support': 224155}, 'weighted avg': {'precision': 0.3825676798265895, 'recall': 0.4303227677276884, 'f1-score': 0.3760079803594668, 'support': 224155}}
[[ 5003 44687  7416]
 [ 7605 80283 21268]
 [ 3913 42807 11173]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0986818
{'0': {'precision': 0.42872646372564976, 'recall': 0.27330589089902796, 'f1-score': 0.33381215936456965, 'support': 28909}, '1': {'precision': 0.33895811301669043, 'recall': 0.5932005632669483, 'f1-score': 0.43140754612087256, 'support': 24855}, '2': {'precision': 0.3923112792083312, 'recall': 0.27570637926012237, 'f1-score': 0.32383192558537366, 'support': 27464}, 'accuracy': 0.37200226522873886, 'macro avg': {'precision': 0.38666528531689043, 'recall': 0.38073761114203286, 'f1-score': 0.3630172103569386, 'support': 81228}, 'weighted avg': {'precision': 0.38894585870700077, 'recall': 0.3720022652287388, 'f1-score': 0.36030100800439907, 'support': 81228}}
[[ 7901 14534  6474]
 [ 4856 14744  5255]
 [ 5672 14220  7572]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.081257
{'0': {'precision': 0.37058823529411766, 'recall': 0.03286384976525822, 'f1-score': 0.06037374221370388, 'support': 7668}, '1': {'precision': 0.4262592504177608, 'recall': 0.8017241379310345, 'f1-score': 0.5565911287054642, 'support': 11136}, '2': {'precision': 0.3535332785538209, 'recall': 0.22382624528547276, 'f1-score': 0.27411005813490485, 'support': 7689}, 'accuracy': 0.4114671800098139, 'macro avg': {'precision': 0.3834602547552331, 'recall': 0.3528047443272551, 'f1-score': 0.29702497635135766, 'support': 26493}, 'weighted avg': {'precision': 0.3890390284108182, 'recall': 0.4114671800098139, 'f1-score': 0.33098467148144844, 'support': 26493}}
[[ 252 6178 1238]
 [ 299 8928 1909]
 [ 129 5839 1721]]
training model: results/LILAK/W0/deepLOB_L1/h200
Epoch 1/50
318/318 - 13s - loss: 3.3453 - accuracy200: 0.3513 - val_loss: 3.3840 - val_accuracy200: 0.3255 - 13s/epoch - 41ms/step
Epoch 2/50
318/318 - 10s - loss: 3.3234 - accuracy200: 0.3534 - val_loss: 3.3617 - val_accuracy200: 0.3276 - 10s/epoch - 30ms/step
Epoch 3/50
318/318 - 9s - loss: 3.3022 - accuracy200: 0.3583 - val_loss: 3.3348 - val_accuracy200: 0.3463 - 9s/epoch - 30ms/step
Epoch 4/50
318/318 - 10s - loss: 3.2932 - accuracy200: 0.3628 - val_loss: 3.3323 - val_accuracy200: 0.3385 - 10s/epoch - 32ms/step
Epoch 5/50
318/318 - 10s - loss: 3.2862 - accuracy200: 0.3702 - val_loss: 3.3126 - val_accuracy200: 0.3501 - 10s/epoch - 31ms/step
Epoch 6/50
318/318 - 10s - loss: 3.2792 - accuracy200: 0.3711 - val_loss: 3.3275 - val_accuracy200: 0.3401 - 10s/epoch - 31ms/step
Epoch 7/50
318/318 - 10s - loss: 3.2762 - accuracy200: 0.3718 - val_loss: 3.3436 - val_accuracy200: 0.3304 - 10s/epoch - 30ms/step
Epoch 8/50
318/318 - 10s - loss: 3.2736 - accuracy200: 0.3771 - val_loss: 3.3277 - val_accuracy200: 0.3354 - 10s/epoch - 30ms/step
Epoch 9/50
318/318 - 9s - loss: 3.2626 - accuracy200: 0.3856 - val_loss: 3.3517 - val_accuracy200: 0.3426 - 9s/epoch - 29ms/step
Epoch 10/50
318/318 - 10s - loss: 3.2614 - accuracy200: 0.3865 - val_loss: 3.3332 - val_accuracy200: 0.3419 - 10s/epoch - 30ms/step
Epoch 11/50
318/318 - 10s - loss: 3.2521 - accuracy200: 0.3965 - val_loss: 3.3324 - val_accuracy200: 0.3508 - 10s/epoch - 31ms/step
Epoch 12/50
318/318 - 10s - loss: 3.2486 - accuracy200: 0.3976 - val_loss: 3.3126 - val_accuracy200: 0.3507 - 10s/epoch - 31ms/step
Epoch 13/50
318/318 - 9s - loss: 3.2447 - accuracy200: 0.3983 - val_loss: 3.3187 - val_accuracy200: 0.3539 - 9s/epoch - 30ms/step
Epoch 14/50
318/318 - 9s - loss: 3.2378 - accuracy200: 0.4033 - val_loss: 3.3346 - val_accuracy200: 0.3485 - 9s/epoch - 29ms/step
Epoch 15/50
318/318 - 10s - loss: 3.2348 - accuracy200: 0.4042 - val_loss: 3.3341 - val_accuracy200: 0.3488 - 10s/epoch - 30ms/step
Epoch 16/50
318/318 - 9s - loss: 3.2274 - accuracy200: 0.4079 - val_loss: 3.3289 - val_accuracy200: 0.3459 - 9s/epoch - 30ms/step
Epoch 17/50
318/318 - 9s - loss: 3.2219 - accuracy200: 0.4131 - val_loss: 3.3342 - val_accuracy200: 0.3471 - 9s/epoch - 29ms/step
Epoch 18/50
318/318 - 10s - loss: 3.2210 - accuracy200: 0.4129 - val_loss: 3.3293 - val_accuracy200: 0.3493 - 10s/epoch - 31ms/step
Epoch 19/50
318/318 - 10s - loss: 3.2168 - accuracy200: 0.4153 - val_loss: 3.3534 - val_accuracy200: 0.3387 - 10s/epoch - 31ms/step
Epoch 20/50
318/318 - 9s - loss: 3.2100 - accuracy200: 0.4184 - val_loss: 3.4328 - val_accuracy200: 0.3329 - 9s/epoch - 30ms/step
Epoch 21/50
318/318 - 9s - loss: 3.2068 - accuracy200: 0.4195 - val_loss: 3.3522 - val_accuracy200: 0.3322 - 9s/epoch - 30ms/step
Epoch 22/50
318/318 - 9s - loss: 3.1990 - accuracy200: 0.4226 - val_loss: 3.3684 - val_accuracy200: 0.3441 - 9s/epoch - 30ms/step
testing model: results/LILAK/W0/deepLOB_L1/h200
Evaluating performance on  test set...
876/876 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1088266
{'0': {'precision': 0.3106719143755132, 'recall': 0.15405568582300164, 'f1-score': 0.20597345548067356, 'support': 71221}, '1': {'precision': 0.34126157099284254, 'recall': 0.567816237423274, 'f1-score': 0.4263086381041969, 'support': 79015}, '2': {'precision': 0.3420259033939373, 'recall': 0.26543919695883333, 'f1-score': 0.29890468138263027, 'support': 73919}, 'accuracy': 0.336637594521648, 'macro avg': {'precision': 0.3313197962540977, 'recall': 0.32910370673503636, 'f1-score': 0.3103955916558336, 'support': 224155}, 'weighted avg': {'precision': 0.33179433962532323, 'recall': 0.336637594521648, 'f1-score': 0.3142876476354077, 'support': 224155}}
[[10972 43860 16389]
 [12792 44866 21357]
 [11553 42745 19621]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1090939
{'0': {'precision': 0.35767725598526706, 'recall': 0.22558164857899896, 'f1-score': 0.27667104413826876, 'support': 27551}, '1': {'precision': 0.3295199080781336, 'recall': 0.49256963632290346, 'f1-score': 0.3948754789272031, 'support': 26782}, '2': {'precision': 0.3478461667646318, 'recall': 0.3080498233872467, 'f1-score': 0.32674067793267997, 'support': 26895}, 'accuracy': 0.3409169251982075, 'macro avg': {'precision': 0.34501444360934413, 'recall': 0.34206703609638306, 'f1-score': 0.33276240033271726, 'support': 81228}, 'weighted avg': {'precision': 0.345138264058372, 'recall': 0.3409169251982075, 'f1-score': 0.33222299633970087, 'support': 81228}}
[[ 6215 13582  7754]
 [ 5811 13192  7779]
 [ 5350 13260  8285]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1043905
{'0': {'precision': 0.31216931216931215, 'recall': 0.10132814288985574, 'f1-score': 0.15299507304002075, 'support': 8734}, '1': {'precision': 0.3601692199217999, 'recall': 0.6126921818776578, 'f1-score': 0.4536573550783143, 'support': 9171}, '2': {'precision': 0.35708079930495223, 'recall': 0.3350023288309269, 'f1-score': 0.34568939621507966, 'support': 8588}, 'accuracy': 0.35409353414109385, 'macro avg': {'precision': 0.34313977713202143, 'recall': 0.3496742178661468, 'f1-score': 0.3174472747778049, 'support': 26493}, 'weighted avg': {'precision': 0.34334384904769294, 'recall': 0.35409353414109385, 'f1-score': 0.3195384103744335, 'support': 26493}}
[[ 885 5260 2589]
 [ 961 5619 2591]
 [ 989 4722 2877]]
training model: results/LILAK/W0/deepLOB_L1/h300
Epoch 1/50
318/318 - 13s - loss: 3.3397 - accuracy300: 0.3621 - val_loss: 3.4291 - val_accuracy300: 0.3217 - 13s/epoch - 41ms/step
Epoch 2/50
318/318 - 10s - loss: 3.2970 - accuracy300: 0.3677 - val_loss: 3.3096 - val_accuracy300: 0.3605 - 10s/epoch - 30ms/step
Epoch 3/50
318/318 - 10s - loss: 3.2858 - accuracy300: 0.3713 - val_loss: 3.3088 - val_accuracy300: 0.3658 - 10s/epoch - 31ms/step
Epoch 4/50
318/318 - 10s - loss: 3.2838 - accuracy300: 0.3695 - val_loss: 3.3106 - val_accuracy300: 0.3632 - 10s/epoch - 30ms/step
Epoch 5/50
318/318 - 10s - loss: 3.2795 - accuracy300: 0.3712 - val_loss: 3.3160 - val_accuracy300: 0.3524 - 10s/epoch - 31ms/step
Epoch 6/50
318/318 - 10s - loss: 3.2698 - accuracy300: 0.3824 - val_loss: 3.3032 - val_accuracy300: 0.3583 - 10s/epoch - 30ms/step
Epoch 7/50
318/318 - 10s - loss: 3.2654 - accuracy300: 0.3866 - val_loss: 3.2950 - val_accuracy300: 0.3799 - 10s/epoch - 31ms/step
Epoch 8/50
318/318 - 10s - loss: 3.2639 - accuracy300: 0.3853 - val_loss: 3.3422 - val_accuracy300: 0.3422 - 10s/epoch - 30ms/step
Epoch 9/50
318/318 - 9s - loss: 3.2628 - accuracy300: 0.3864 - val_loss: 3.3626 - val_accuracy300: 0.3625 - 9s/epoch - 30ms/step
Epoch 10/50
318/318 - 10s - loss: 3.2492 - accuracy300: 0.3973 - val_loss: 3.3824 - val_accuracy300: 0.3480 - 10s/epoch - 31ms/step
Epoch 11/50
318/318 - 10s - loss: 3.2509 - accuracy300: 0.3929 - val_loss: 3.3523 - val_accuracy300: 0.3477 - 10s/epoch - 30ms/step
Epoch 12/50
318/318 - 10s - loss: 3.2348 - accuracy300: 0.4039 - val_loss: 3.3805 - val_accuracy300: 0.3359 - 10s/epoch - 31ms/step
Epoch 13/50
318/318 - 9s - loss: 3.2296 - accuracy300: 0.4073 - val_loss: 3.4230 - val_accuracy300: 0.3405 - 9s/epoch - 30ms/step
Epoch 14/50
318/318 - 10s - loss: 3.2206 - accuracy300: 0.4135 - val_loss: 3.3768 - val_accuracy300: 0.3367 - 10s/epoch - 32ms/step
Epoch 15/50
318/318 - 10s - loss: 3.2224 - accuracy300: 0.4139 - val_loss: 3.3856 - val_accuracy300: 0.3457 - 10s/epoch - 30ms/step
Epoch 16/50
318/318 - 10s - loss: 3.2183 - accuracy300: 0.4154 - val_loss: 3.4528 - val_accuracy300: 0.3356 - 10s/epoch - 30ms/step
Epoch 17/50
318/318 - 10s - loss: 3.2103 - accuracy300: 0.4204 - val_loss: 3.3984 - val_accuracy300: 0.3462 - 10s/epoch - 33ms/step
testing model: results/LILAK/W0/deepLOB_L1/h300
Evaluating performance on  test set...
876/876 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1051581
{'0': {'precision': 0.2857695881077733, 'recall': 0.11476990049751244, 'f1-score': 0.16376785872748248, 'support': 64320}, '1': {'precision': 0.4068891517869425, 'recall': 0.8028707302773013, 'f1-score': 0.5400731091853912, 'support': 92102}, '2': {'precision': 0.3047986496262358, 'recall': 0.07464603664388113, 'f1-score': 0.11992267643884678, 'support': 67733}, 'accuracy': 0.3853761905824095, 'macro avg': {'precision': 0.3324857965069839, 'recall': 0.33076222247289827, 'f1-score': 0.2745878814505735, 'support': 224155}, 'weighted avg': {'precision': 0.341285858000521, 'recall': 0.3853761905824095, 'f1-score': 0.30513744872421755, 'support': 224155}}
[[ 7382 52756  4182]
 [10806 73946  7350]
 [ 7644 55033  5056]]
Evaluating performance on  train set...
318/318 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.117277
{'0': {'precision': 0.3820271164021164, 'recall': 0.1652186349172298, 'f1-score': 0.23067515287657558, 'support': 27969}, '1': {'precision': 0.3306927111593417, 'recall': 0.7082978228868057, 'f1-score': 0.45087788518445454, 'support': 25814}, '2': {'precision': 0.354645282473631, 'recall': 0.17886682455820732, 'f1-score': 0.23779882287402818, 'support': 27445}, 'accuracy': 0.34241887034027674, 'macro avg': {'precision': 0.3557883700116964, 'recall': 0.3507944274540809, 'f1-score': 0.30645062031168613, 'support': 81228}, 'weighted avg': {'precision': 0.35646153841048456, 'recall': 0.34241887034027674, 'f1-score': 0.30306179855141274, 'support': 81228}}
[[ 4621 18299  5049]
 [ 3646 18284  3884]
 [ 3829 18707  4909]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.098652
{'0': {'precision': 0.322007722007722, 'recall': 0.10085862861289152, 'f1-score': 0.15360530435583386, 'support': 8269}, '1': {'precision': 0.3852224792488774, 'recall': 0.8459163346613546, 'f1-score': 0.5293732664318883, 'support': 10040}, '2': {'precision': 0.3448275862068966, 'recall': 0.07820136852394917, 'f1-score': 0.12749003984063745, 'support': 8184}, 'accuracy': 0.3762125844562715, 'macro avg': {'precision': 0.35068592915449864, 'recall': 0.3416587772660651, 'f1-score': 0.2701562035427865, 'support': 26493}, 'weighted avg': {'precision': 0.3530134190336249, 'recall': 0.3762125844562715, 'f1-score': 0.2879420353584089, 'support': 26493}}
[[ 834 6845  590]
 [ 921 8493  626]
 [ 835 6709  640]]
training model: results/LILAK/W0/deepLOB_L1/h500
Epoch 1/50
318/318 - 13s - loss: 3.3382 - accuracy500: 0.3617 - val_loss: 3.4391 - val_accuracy500: 0.3264 - 13s/epoch - 41ms/step
Epoch 2/50
318/318 - 10s - loss: 3.3103 - accuracy500: 0.3692 - val_loss: 3.4158 - val_accuracy500: 0.3292 - 10s/epoch - 30ms/step
Epoch 3/50
318/318 - 9s - loss: 3.2978 - accuracy500: 0.3667 - val_loss: 3.4250 - val_accuracy500: 0.3101 - 9s/epoch - 29ms/step
Epoch 4/50
318/318 - 10s - loss: 3.2994 - accuracy500: 0.3585 - val_loss: 3.5566 - val_accuracy500: 0.3130 - 10s/epoch - 31ms/step
Epoch 5/50
318/318 - 9s - loss: 3.2912 - accuracy500: 0.3668 - val_loss: 3.4752 - val_accuracy500: 0.3124 - 9s/epoch - 29ms/step
Epoch 6/50
318/318 - 10s - loss: 3.2784 - accuracy500: 0.3694 - val_loss: 3.4504 - val_accuracy500: 0.3127 - 10s/epoch - 30ms/step
Epoch 7/50
318/318 - 10s - loss: 3.2620 - accuracy500: 0.3871 - val_loss: 3.5148 - val_accuracy500: 0.3113 - 10s/epoch - 30ms/step
Epoch 8/50
318/318 - 10s - loss: 3.2515 - accuracy500: 0.3945 - val_loss: 3.5960 - val_accuracy500: 0.3195 - 10s/epoch - 30ms/step
Epoch 9/50
318/318 - 10s - loss: 3.2429 - accuracy500: 0.4010 - val_loss: 3.5967 - val_accuracy500: 0.3277 - 10s/epoch - 30ms/step
Epoch 10/50
318/318 - 10s - loss: 3.2317 - accuracy500: 0.4071 - val_loss: 3.5703 - val_accuracy500: 0.3246 - 10s/epoch - 30ms/step
Epoch 11/50
318/318 - 10s - loss: 3.2231 - accuracy500: 0.4144 - val_loss: 3.6099 - val_accuracy500: 0.3388 - 10s/epoch - 30ms/step
Epoch 12/50
318/318 - 10s - loss: 3.2140 - accuracy500: 0.4185 - val_loss: 3.5537 - val_accuracy500: 0.3304 - 10s/epoch - 30ms/step
testing model: results/LILAK/W0/deepLOB_L1/h500
Evaluating performance on  test set...
876/876 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1470941
{'0': {'precision': 0.29538375043685705, 'recall': 0.5656855184856465, 'f1-score': 0.388108868935019, 'support': 68729}, '1': {'precision': 0.34516602786832395, 'recall': 0.362778440107925, 'f1-score': 0.3537531510805453, 'support': 79685}, '2': {'precision': 0.31131860624003643, 'recall': 0.0360966979575131, 'f1-score': 0.06469245057558298, 'support': 75741}, 'accuracy': 0.3146081952220562, 'macro avg': {'precision': 0.3172894615150725, 'recall': 0.3215202188503615, 'f1-score': 0.2688514901970491, 'support': 224155}, 'weighted avg': {'precision': 0.31846520162248776, 'recall': 0.3146081952220562, 'f1-score': 0.2666147317522848, 'support': 224155}}
[[38879 27117  2733]
 [47462 28908  3315]
 [45281 27726  2734]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1338028
{'0': {'precision': 0.33676285320055194, 'recall': 0.40758758395353056, 'f1-score': 0.3688057421611944, 'support': 27545}, '1': {'precision': 0.32222222222222224, 'recall': 0.4418859649122807, 'f1-score': 0.37268407793615865, 'support': 26448}, '2': {'precision': 0.34182444061962136, 'recall': 0.14584174775105563, 'f1-score': 0.20445245142195342, 'support': 27235}, 'accuracy': 0.3309942384399468, 'macro avg': {'precision': 0.33360317201413187, 'recall': 0.33177176553895565, 'f1-score': 0.3153140905064355, 'support': 81228}, 'weighted avg': {'precision': 0.3337254981658778, 'recall': 0.3309942384399468, 'f1-score': 0.3149623919776742, 'support': 81228}}
[[11227 12324  3994]
 [11107 11687  3654]
 [11004 12259  3972]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1396422
{'0': {'precision': 0.3322687630512222, 'recall': 0.6023157425963037, 'f1-score': 0.4282773907536416, 'support': 8982}, '1': {'precision': 0.3265831282166033, 'recall': 0.341283760084181, 'f1-score': 0.33377165399348235, 'support': 8553}, '2': {'precision': 0.32050274941084056, 'recall': 0.04554588077695914, 'f1-score': 0.07975759945264392, 'support': 8958}, 'accuracy': 0.3297852262861888, 'macro avg': {'precision': 0.3264515468928887, 'recall': 0.3297151278191479, 'f1-score': 0.280602214733256, 'support': 26493}, 'weighted avg': {'precision': 0.3264548052159059, 'recall': 0.3297852262861888, 'f1-score': 0.2799231893802985, 'support': 26493}}
[[5410 3117  455]
 [5224 2919  410]
 [5648 2902  408]]
training model: results/LILAK/W0/deepLOB_L1/h1000
Epoch 1/50
318/318 - 13s - loss: 3.3405 - accuracy1000: 0.3621 - val_loss: 3.5014 - val_accuracy1000: 0.3282 - 13s/epoch - 40ms/step
Epoch 2/50
318/318 - 10s - loss: 3.3019 - accuracy1000: 0.3713 - val_loss: 3.4025 - val_accuracy1000: 0.3266 - 10s/epoch - 32ms/step
Epoch 3/50
318/318 - 10s - loss: 3.2744 - accuracy1000: 0.3816 - val_loss: 3.4183 - val_accuracy1000: 0.3354 - 10s/epoch - 31ms/step
Epoch 4/50
318/318 - 9s - loss: 3.2577 - accuracy1000: 0.3909 - val_loss: 3.3220 - val_accuracy1000: 0.3464 - 9s/epoch - 29ms/step
Epoch 5/50
318/318 - 10s - loss: 3.2311 - accuracy1000: 0.4050 - val_loss: 3.3967 - val_accuracy1000: 0.3380 - 10s/epoch - 31ms/step
Epoch 6/50
318/318 - 9s - loss: 3.2023 - accuracy1000: 0.4210 - val_loss: 3.3618 - val_accuracy1000: 0.3431 - 9s/epoch - 29ms/step
Epoch 7/50
318/318 - 9s - loss: 3.2072 - accuracy1000: 0.4200 - val_loss: 3.3424 - val_accuracy1000: 0.3405 - 9s/epoch - 29ms/step
Epoch 8/50
318/318 - 9s - loss: 3.1831 - accuracy1000: 0.4299 - val_loss: 3.4089 - val_accuracy1000: 0.3267 - 9s/epoch - 29ms/step
Epoch 9/50
318/318 - 9s - loss: 3.1659 - accuracy1000: 0.4317 - val_loss: 3.4409 - val_accuracy1000: 0.3388 - 9s/epoch - 29ms/step
Epoch 10/50
318/318 - 9s - loss: 3.1387 - accuracy1000: 0.4456 - val_loss: 3.3761 - val_accuracy1000: 0.3286 - 9s/epoch - 29ms/step
Epoch 11/50
318/318 - 9s - loss: 3.1312 - accuracy1000: 0.4484 - val_loss: 3.3683 - val_accuracy1000: 0.3443 - 9s/epoch - 29ms/step
Epoch 12/50
318/318 - 9s - loss: 3.1335 - accuracy1000: 0.4452 - val_loss: 3.3733 - val_accuracy1000: 0.3277 - 9s/epoch - 29ms/step
Epoch 13/50
318/318 - 9s - loss: 3.1131 - accuracy1000: 0.4531 - val_loss: 3.3612 - val_accuracy1000: 0.3485 - 9s/epoch - 28ms/step
Epoch 14/50
318/318 - 9s - loss: 3.1020 - accuracy1000: 0.4593 - val_loss: 3.4647 - val_accuracy1000: 0.3261 - 9s/epoch - 29ms/step
testing model: results/LILAK/W0/deepLOB_L1/h1000
Evaluating performance on  test set...
876/876 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1300726
{'0': {'precision': 0.3066507819443656, 'recall': 0.46932839384686625, 'f1-score': 0.37093758041918046, 'support': 69103}, '1': {'precision': 0.2976017692998825, 'recall': 0.05536839398225537, 'f1-score': 0.09336614664079186, 'support': 77770}, '2': {'precision': 0.3324641083868981, 'recall': 0.4470769390026138, 'f1-score': 0.38134498857653715, 'support': 77282}, 'accuracy': 0.3180343958421628, 'macro avg': {'precision': 0.3122388865437154, 'recall': 0.32392457561057847, 'f1-score': 0.2818829052121698, 'support': 224155}, 'weighted avg': {'precision': 0.3124109201557388, 'recall': 0.3180343958421628, 'f1-score': 0.27822305213416143, 'support': 224155}}
[[32432  4600 32071]
 [36162  4306 37302]
 [37168  5563 34551]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1243886
{'0': {'precision': 0.32143189214318924, 'recall': 0.38163753449862003, 'f1-score': 0.34895693135935396, 'support': 27175}, '1': {'precision': 0.32768582900793264, 'recall': 0.2444655512530138, 'f1-score': 0.28002343292325715, 'support': 27374}, '2': {'precision': 0.3214323254265793, 'recall': 0.3438659619925784, 'f1-score': 0.33227091633466127, 'support': 26679}, 'accuracy': 0.3230043827251687, 'macro avg': {'precision': 0.3235166821925671, 'recall': 0.3233230159147374, 'f1-score': 0.3204170935390908, 'support': 81228}, 'weighted avg': {'precision': 0.3235396238034917, 'recall': 0.3230043827251687, 'f1-score': 0.32024575071926076, 'support': 81228}}
[[10371  7227  9577]
 [10892  6692  9790]
 [11002  6503  9174]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1067436
{'0': {'precision': 0.34474223284397404, 'recall': 0.448877528339631, 'f1-score': 0.38997779279714195, 'support': 8998}, '1': {'precision': 0.3240072202166065, 'recall': 0.04438125849919644, 'f1-score': 0.07806893552245298, 'support': 8089}, '2': {'precision': 0.3598653888360524, 'recall': 0.5229640654901127, 'f1-score': 0.4263488624052005, 'support': 9406}, 'accuracy': 0.3516778016834636, 'macro avg': {'precision': 0.34287161396554433, 'recall': 0.33874095077631333, 'f1-score': 0.29813186357493177, 'support': 26493}, 'weighted avg': {'precision': 0.34378057837368803, 'recall': 0.3516778016834636, 'f1-score': 0.3076570112412004, 'support': 26493}}
[[4039  377 4582]
 [3562  359 4168]
 [4115  372 4919]]
training model: results/LILAK/W0/deepOF_L1/h10
Epoch 1/50
318/318 - 12s - loss: 3.2857 - accuracy10: 0.4008 - val_loss: 3.1876 - val_accuracy10: 0.4550 - 12s/epoch - 38ms/step
Epoch 2/50
318/318 - 9s - loss: 3.2588 - accuracy10: 0.4167 - val_loss: 3.1687 - val_accuracy10: 0.4620 - 9s/epoch - 29ms/step
Epoch 3/50
318/318 - 9s - loss: 3.2448 - accuracy10: 0.4233 - val_loss: 3.1668 - val_accuracy10: 0.4637 - 9s/epoch - 28ms/step
Epoch 4/50
318/318 - 9s - loss: 3.2394 - accuracy10: 0.4248 - val_loss: 3.1598 - val_accuracy10: 0.4594 - 9s/epoch - 28ms/step
Epoch 5/50
318/318 - 9s - loss: 3.2354 - accuracy10: 0.4233 - val_loss: 3.1556 - val_accuracy10: 0.4599 - 9s/epoch - 28ms/step
Epoch 6/50
318/318 - 9s - loss: 3.2271 - accuracy10: 0.4276 - val_loss: 3.1518 - val_accuracy10: 0.4608 - 9s/epoch - 28ms/step
Epoch 7/50
318/318 - 9s - loss: 3.2226 - accuracy10: 0.4296 - val_loss: 3.1514 - val_accuracy10: 0.4586 - 9s/epoch - 29ms/step
Epoch 8/50
318/318 - 9s - loss: 3.2202 - accuracy10: 0.4293 - val_loss: 3.1517 - val_accuracy10: 0.4597 - 9s/epoch - 29ms/step
Epoch 9/50
318/318 - 9s - loss: 3.2175 - accuracy10: 0.4330 - val_loss: 3.1513 - val_accuracy10: 0.4607 - 9s/epoch - 28ms/step
Epoch 10/50
318/318 - 9s - loss: 3.2145 - accuracy10: 0.4334 - val_loss: 3.1500 - val_accuracy10: 0.4598 - 9s/epoch - 29ms/step
Epoch 11/50
318/318 - 9s - loss: 3.2111 - accuracy10: 0.4337 - val_loss: 3.1509 - val_accuracy10: 0.4577 - 9s/epoch - 27ms/step
Epoch 12/50
318/318 - 9s - loss: 3.2073 - accuracy10: 0.4370 - val_loss: 3.1448 - val_accuracy10: 0.4595 - 9s/epoch - 29ms/step
Epoch 13/50
318/318 - 9s - loss: 3.2036 - accuracy10: 0.4394 - val_loss: 3.1487 - val_accuracy10: 0.4610 - 9s/epoch - 27ms/step
Epoch 14/50
318/318 - 8s - loss: 3.2013 - accuracy10: 0.4397 - val_loss: 3.1472 - val_accuracy10: 0.4604 - 8s/epoch - 27ms/step
Epoch 15/50
318/318 - 9s - loss: 3.1973 - accuracy10: 0.4416 - val_loss: 3.1478 - val_accuracy10: 0.4557 - 9s/epoch - 28ms/step
Epoch 16/50
318/318 - 9s - loss: 3.1970 - accuracy10: 0.4424 - val_loss: 3.1499 - val_accuracy10: 0.4558 - 9s/epoch - 28ms/step
Epoch 17/50
318/318 - 9s - loss: 3.1926 - accuracy10: 0.4439 - val_loss: 3.1456 - val_accuracy10: 0.4560 - 9s/epoch - 28ms/step
Epoch 18/50
318/318 - 9s - loss: 3.1908 - accuracy10: 0.4466 - val_loss: 3.1495 - val_accuracy10: 0.4566 - 9s/epoch - 28ms/step
Epoch 19/50
318/318 - 9s - loss: 3.1905 - accuracy10: 0.4426 - val_loss: 3.1479 - val_accuracy10: 0.4568 - 9s/epoch - 28ms/step
Epoch 20/50
318/318 - 9s - loss: 3.1860 - accuracy10: 0.4462 - val_loss: 3.1506 - val_accuracy10: 0.4563 - 9s/epoch - 28ms/step
Epoch 21/50
318/318 - 9s - loss: 3.1848 - accuracy10: 0.4477 - val_loss: 3.1510 - val_accuracy10: 0.4552 - 9s/epoch - 29ms/step
Epoch 22/50
318/318 - 9s - loss: 3.1806 - accuracy10: 0.4504 - val_loss: 3.1550 - val_accuracy10: 0.4514 - 9s/epoch - 28ms/step
testing model: results/LILAK/W0/deepOF_L1/h10
Evaluating performance on  test set...
876/876 - 16s - 16s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0155921
{'0': {'precision': 0.27259932065982323, 'recall': 0.32428450238871276, 'f1-score': 0.29620415778795073, 'support': 44794}, '1': {'precision': 0.6968362715264438, 'recall': 0.615234521575985, 'f1-score': 0.6534978636566545, 'support': 133250}, '2': {'precision': 0.30058064152432495, 'recall': 0.346939660781677, 'f1-score': 0.32210062120556165, 'support': 46106}, 'accuracy': 0.5019049743475351, 'macro avg': {'precision': 0.42333874457019727, 'recall': 0.4288195615821249, 'f1-score': 0.42393421421672234, 'support': 224150}, 'weighted avg': {'precision': 0.5305501593069608, 'recall': 0.5019049743475351, 'f1-score': 0.5139305403413175, 'support': 224150}}
[[14526 17828 12440]
 [26489 81980 24781]
 [12272 17838 15996]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0492055
{'0': {'precision': 0.33783721038213305, 'recall': 0.3421745673438676, 'f1-score': 0.33999205626036777, 'support': 21264}, '1': {'precision': 0.569342885375494, 'recall': 0.5885191900104696, 'f1-score': 0.5787722404289248, 'support': 39161}, '2': {'precision': 0.3549042065805914, 'recall': 0.32774038461538463, 'f1-score': 0.3407818436312738, 'support': 20800}, 'accuracy': 0.4572483841181902, 'macro avg': {'precision': 0.4206947674460728, 'recall': 0.4194780473232406, 'f1-score': 0.41984871344018876, 'support': 81225}, 'weighted avg': {'precision': 0.4538235108972816, 'recall': 0.4572483841181902, 'f1-score': 0.455317367058025, 'support': 81225}}
[[ 7276  9022  4966]
 [ 8689 23047  7425]
 [ 5572  8411  6817]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0451062
{'0': {'precision': 0.29867320449956736, 'recall': 0.33685751463890695, 'f1-score': 0.31661825408958877, 'support': 6148}, '1': {'precision': 0.6075463338994315, 'recall': 0.5987047951684494, 'f1-score': 0.6030931613281537, 'support': 13743}, '2': {'precision': 0.32646276595744683, 'recall': 0.2974856104210845, 'f1-score': 0.3113013155809161, 'support': 6602}, 'accuracy': 0.4628769863737591, 'macro avg': {'precision': 0.41089410145214855, 'recall': 0.4110159734094803, 'f1-score': 0.4103375769995529, 'support': 26493}, 'weighted avg': {'precision': 0.4658233989693237, 'recall': 0.4628769863737591, 'f1-score': 0.4638995065768624, 'support': 26493}}
[[2071 2565 1512]
 [2975 8228 2540]
 [1888 2750 1964]]
training model: results/LILAK/W0/deepOF_L1/h20
Epoch 1/50
318/318 - 12s - loss: 3.3039 - accuracy20: 0.3697 - val_loss: 3.2501 - val_accuracy20: 0.4122 - 12s/epoch - 37ms/step
Epoch 2/50
318/318 - 9s - loss: 3.2770 - accuracy20: 0.3884 - val_loss: 3.2376 - val_accuracy20: 0.4160 - 9s/epoch - 29ms/step
Epoch 3/50
318/318 - 9s - loss: 3.2615 - accuracy20: 0.3961 - val_loss: 3.2330 - val_accuracy20: 0.4137 - 9s/epoch - 29ms/step
Epoch 4/50
318/318 - 9s - loss: 3.2579 - accuracy20: 0.3950 - val_loss: 3.2296 - val_accuracy20: 0.4117 - 9s/epoch - 28ms/step
Epoch 5/50
318/318 - 9s - loss: 3.2535 - accuracy20: 0.3978 - val_loss: 3.2234 - val_accuracy20: 0.4175 - 9s/epoch - 28ms/step
Epoch 6/50
318/318 - 9s - loss: 3.2496 - accuracy20: 0.4016 - val_loss: 3.2206 - val_accuracy20: 0.4173 - 9s/epoch - 28ms/step
Epoch 7/50
318/318 - 9s - loss: 3.2456 - accuracy20: 0.4036 - val_loss: 3.2206 - val_accuracy20: 0.4181 - 9s/epoch - 28ms/step
Epoch 8/50
318/318 - 9s - loss: 3.2419 - accuracy20: 0.4065 - val_loss: 3.2197 - val_accuracy20: 0.4158 - 9s/epoch - 29ms/step
Epoch 9/50
318/318 - 9s - loss: 3.2396 - accuracy20: 0.4067 - val_loss: 3.2195 - val_accuracy20: 0.4147 - 9s/epoch - 28ms/step
Epoch 10/50
318/318 - 9s - loss: 3.2355 - accuracy20: 0.4085 - val_loss: 3.2193 - val_accuracy20: 0.4136 - 9s/epoch - 28ms/step
Epoch 11/50
318/318 - 9s - loss: 3.2337 - accuracy20: 0.4092 - val_loss: 3.2177 - val_accuracy20: 0.4128 - 9s/epoch - 28ms/step
Epoch 12/50
318/318 - 9s - loss: 3.2308 - accuracy20: 0.4102 - val_loss: 3.2159 - val_accuracy20: 0.4160 - 9s/epoch - 28ms/step
Epoch 13/50
318/318 - 9s - loss: 3.2299 - accuracy20: 0.4111 - val_loss: 3.2183 - val_accuracy20: 0.4119 - 9s/epoch - 29ms/step
Epoch 14/50
318/318 - 9s - loss: 3.2272 - accuracy20: 0.4127 - val_loss: 3.2188 - val_accuracy20: 0.4144 - 9s/epoch - 28ms/step
Epoch 15/50
318/318 - 9s - loss: 3.2241 - accuracy20: 0.4138 - val_loss: 3.2167 - val_accuracy20: 0.4157 - 9s/epoch - 28ms/step
Epoch 16/50
318/318 - 9s - loss: 3.2231 - accuracy20: 0.4138 - val_loss: 3.2203 - val_accuracy20: 0.4114 - 9s/epoch - 27ms/step
Epoch 17/50
318/318 - 9s - loss: 3.2200 - accuracy20: 0.4162 - val_loss: 3.2210 - val_accuracy20: 0.4101 - 9s/epoch - 29ms/step
Epoch 18/50
318/318 - 9s - loss: 3.2176 - accuracy20: 0.4173 - val_loss: 3.2230 - val_accuracy20: 0.4077 - 9s/epoch - 29ms/step
Epoch 19/50
318/318 - 9s - loss: 3.2159 - accuracy20: 0.4173 - val_loss: 3.2232 - val_accuracy20: 0.4065 - 9s/epoch - 28ms/step
Epoch 20/50
318/318 - 9s - loss: 3.2126 - accuracy20: 0.4175 - val_loss: 3.2269 - val_accuracy20: 0.4094 - 9s/epoch - 28ms/step
Epoch 21/50
318/318 - 9s - loss: 3.2106 - accuracy20: 0.4214 - val_loss: 3.2295 - val_accuracy20: 0.4041 - 9s/epoch - 28ms/step
Epoch 22/50
318/318 - 9s - loss: 3.2076 - accuracy20: 0.4219 - val_loss: 3.2288 - val_accuracy20: 0.4055 - 9s/epoch - 28ms/step
testing model: results/LILAK/W0/deepOF_L1/h20
Evaluating performance on  test set...
876/876 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.051524
{'0': {'precision': 0.3164176445701307, 'recall': 0.25610063799877447, 'f1-score': 0.2830818267842024, 'support': 55486}, '1': {'precision': 0.6016185188670368, 'recall': 0.5723621779377271, 'f1-score': 0.5866258051492852, 'support': 111702}, '2': {'precision': 0.3282399857477628, 'recall': 0.42049085355149046, 'f1-score': 0.36868232088845787, 'support': 56962}, 'accuracy': 0.45548070488512155, 'macro avg': {'precision': 0.4154253830616434, 'recall': 0.4163178898293307, 'f1-score': 0.4127966509406485, 'support': 224150}, 'weighted avg': {'precision': 0.4615478353302167, 'recall': 0.45548070488512155, 'f1-score': 0.4561018795011468, 'support': 224150}}
[[14210 21458 19818]
 [18567 63934 29201]
 [12132 20878 23952]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0758432
{'0': {'precision': 0.38868964083372315, 'recall': 0.28820287509153275, 'f1-score': 0.3309874739963706, 'support': 25947}, '1': {'precision': 0.44422066788231773, 'recall': 0.5447021525112632, 'f1-score': 0.48935659890867667, 'support': 29965}, '2': {'precision': 0.3823634274848473, 'recall': 0.3813060482755896, 'f1-score': 0.3818340058548936, 'support': 25313}, 'accuracy': 0.41184364419821484, 'macro avg': {'precision': 0.405091245400296, 'recall': 0.40473702529279515, 'f1-score': 0.4007260262533136, 'support': 81225}, 'weighted avg': {'precision': 0.4072042827175157, 'recall': 0.41184364419821484, 'f1-score': 0.4052578228905786, 'support': 81225}}
[[ 7478 10551  7918]
 [ 5970 16322  7673]
 [ 5791  9870  9652]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0739168
{'0': {'precision': 0.3397932816537468, 'recall': 0.2791191297426373, 'f1-score': 0.30648215586307354, 'support': 7538}, '1': {'precision': 0.48549044687824766, 'recall': 0.557258212516058, 'f1-score': 0.5189046011876789, 'support': 10898}, '2': {'precision': 0.36049794661190965, 'recall': 0.3486409333498821, 'f1-score': 0.3544703135844533, 'support': 8057}, 'accuracy': 0.4146755746801042, 'macro avg': {'precision': 0.39526055838130136, 'recall': 0.3950060918695258, 'f1-score': 0.39328569021173526, 'support': 26493}, 'weighted avg': {'precision': 0.4060230477121218, 'recall': 0.4146755746801042, 'f1-score': 0.40845703209108497, 'support': 26493}}
[[2104 3130 2304]
 [2146 6073 2679]
 [1942 3306 2809]]
training model: results/LILAK/W0/deepOF_L1/h30
Epoch 1/50
318/318 - 11s - loss: 3.3141 - accuracy30: 0.3574 - val_loss: 3.2844 - val_accuracy30: 0.3835 - 11s/epoch - 36ms/step
Epoch 2/50
318/318 - 9s - loss: 3.2833 - accuracy30: 0.3778 - val_loss: 3.2749 - val_accuracy30: 0.3852 - 9s/epoch - 29ms/step
Epoch 3/50
318/318 - 9s - loss: 3.2769 - accuracy30: 0.3819 - val_loss: 3.2697 - val_accuracy30: 0.3870 - 9s/epoch - 29ms/step
Epoch 4/50
318/318 - 9s - loss: 3.2689 - accuracy30: 0.3869 - val_loss: 3.2666 - val_accuracy30: 0.3892 - 9s/epoch - 28ms/step
Epoch 5/50
318/318 - 9s - loss: 3.2651 - accuracy30: 0.3887 - val_loss: 3.2647 - val_accuracy30: 0.3870 - 9s/epoch - 29ms/step
Epoch 6/50
318/318 - 9s - loss: 3.2608 - accuracy30: 0.3910 - val_loss: 3.2654 - val_accuracy30: 0.3866 - 9s/epoch - 28ms/step
Epoch 7/50
318/318 - 9s - loss: 3.2570 - accuracy30: 0.3924 - val_loss: 3.2634 - val_accuracy30: 0.3889 - 9s/epoch - 29ms/step
Epoch 8/50
318/318 - 9s - loss: 3.2544 - accuracy30: 0.3935 - val_loss: 3.2645 - val_accuracy30: 0.3879 - 9s/epoch - 27ms/step
Epoch 9/50
318/318 - 9s - loss: 3.2524 - accuracy30: 0.3960 - val_loss: 3.2655 - val_accuracy30: 0.3858 - 9s/epoch - 28ms/step
Epoch 10/50
318/318 - 9s - loss: 3.2481 - accuracy30: 0.3976 - val_loss: 3.2651 - val_accuracy30: 0.3844 - 9s/epoch - 28ms/step
Epoch 11/50
318/318 - 9s - loss: 3.2470 - accuracy30: 0.3981 - val_loss: 3.2658 - val_accuracy30: 0.3861 - 9s/epoch - 29ms/step
Epoch 12/50
318/318 - 9s - loss: 3.2424 - accuracy30: 0.4009 - val_loss: 3.2649 - val_accuracy30: 0.3864 - 9s/epoch - 28ms/step
Epoch 13/50
318/318 - 9s - loss: 3.2429 - accuracy30: 0.4015 - val_loss: 3.2674 - val_accuracy30: 0.3809 - 9s/epoch - 29ms/step
Epoch 14/50
318/318 - 9s - loss: 3.2399 - accuracy30: 0.4039 - val_loss: 3.2650 - val_accuracy30: 0.3881 - 9s/epoch - 28ms/step
Epoch 15/50
318/318 - 9s - loss: 3.2367 - accuracy30: 0.4055 - val_loss: 3.2673 - val_accuracy30: 0.3859 - 9s/epoch - 28ms/step
Epoch 16/50
318/318 - 9s - loss: 3.2346 - accuracy30: 0.4040 - val_loss: 3.2676 - val_accuracy30: 0.3838 - 9s/epoch - 28ms/step
Epoch 17/50
318/318 - 9s - loss: 3.2322 - accuracy30: 0.4074 - val_loss: 3.2728 - val_accuracy30: 0.3811 - 9s/epoch - 28ms/step
testing model: results/LILAK/W0/deepOF_L1/h30
Evaluating performance on  test set...
876/876 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0654886
{'0': {'precision': 0.3210640505612678, 'recall': 0.2887392049407014, 'f1-score': 0.3040448795826484, 'support': 58939}, '1': {'precision': 0.5438300037248008, 'recall': 0.5706210380820742, 'f1-score': 0.556903497102029, 'support': 104905}, '2': {'precision': 0.3391898087503275, 'recall': 0.34349815938712563, 'f1-score': 0.34133038936215787, 'support': 60306}, 'accuracy': 0.4353959402186036, 'macro avg': {'precision': 0.4013612876787987, 'recall': 0.40095280080330037, 'f1-score': 0.4007595886822785, 'support': 224150}, 'weighted avg': {'precision': 0.4301979086472364, 'recall': 0.4353959402186036, 'f1-score': 0.43241727852814793, 'support': 224150}}
[[17018 25333 16588]
 [21275 59861 23769]
 [14712 24879 20715]]
Evaluating performance on  train set...
318/318 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0874372
{'0': {'precision': 0.3982563365090778, 'recall': 0.320575893503111, 'f1-score': 0.3552188552188552, 'support': 27644}, '1': {'precision': 0.37993366074413104, 'recall': 0.5543633225782246, 'f1-score': 0.4508658173773743, 'support': 26654}, '2': {'precision': 0.3966736380838562, 'recall': 0.29583689233854493, 'f1-score': 0.3389138250122317, 'support': 26927}, 'accuracy': 0.38909202831640505, 'macro avg': {'precision': 0.3916212117790217, 'recall': 0.3902587028066269, 'f1-score': 0.3816661658694871, 'support': 81225}, 'weighted avg': {'precision': 0.39171906448279487, 'recall': 0.38909202831640505, 'f1-score': 0.38120012429856487, 'support': 81225}}
[[ 8862 12284  6498]
 [ 6260 14776  5618]
 [ 7130 11831  7966]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0861452
{'0': {'precision': 0.3434384814966544, 'recall': 0.31281094527363185, 'f1-score': 0.32741001106554707, 'support': 8040}, '1': {'precision': 0.4244035860811427, 'recall': 0.555544505221283, 'f1-score': 0.4811991213335056, 'support': 10055}, '2': {'precision': 0.3711717709720373, 'recall': 0.2655394141462253, 'f1-score': 0.30959322504512016, 'support': 8398}, 'accuracy': 0.3899520628090439, 'macro avg': {'precision': 0.37967127951661145, 'recall': 0.37796495488038007, 'f1-score': 0.3727341191480576, 'support': 26493}, 'weighted avg': {'precision': 0.382958667644365, 'recall': 0.3899520628090439, 'f1-score': 0.3801305083570874, 'support': 26493}}
[[2515 3686 1839]
 [2530 5586 1939]
 [2278 3890 2230]]
training model: results/LILAK/W0/deepOF_L1/h50
Epoch 1/50
318/318 - 11s - loss: 3.3216 - accuracy50: 0.3506 - val_loss: 3.2984 - val_accuracy50: 0.3651 - 11s/epoch - 35ms/step
Epoch 2/50
318/318 - 9s - loss: 3.2964 - accuracy50: 0.3643 - val_loss: 3.2897 - val_accuracy50: 0.3670 - 9s/epoch - 28ms/step
Epoch 3/50
318/318 - 9s - loss: 3.2893 - accuracy50: 0.3690 - val_loss: 3.2835 - val_accuracy50: 0.3723 - 9s/epoch - 29ms/step
Epoch 4/50
318/318 - 9s - loss: 3.2841 - accuracy50: 0.3706 - val_loss: 3.2838 - val_accuracy50: 0.3727 - 9s/epoch - 28ms/step
Epoch 5/50
318/318 - 9s - loss: 3.2798 - accuracy50: 0.3751 - val_loss: 3.2790 - val_accuracy50: 0.3738 - 9s/epoch - 29ms/step
Epoch 6/50
318/318 - 9s - loss: 3.2773 - accuracy50: 0.3760 - val_loss: 3.2809 - val_accuracy50: 0.3713 - 9s/epoch - 28ms/step
Epoch 7/50
318/318 - 9s - loss: 3.2739 - accuracy50: 0.3799 - val_loss: 3.2791 - val_accuracy50: 0.3760 - 9s/epoch - 29ms/step
Epoch 8/50
318/318 - 9s - loss: 3.2695 - accuracy50: 0.3803 - val_loss: 3.2808 - val_accuracy50: 0.3759 - 9s/epoch - 28ms/step
Epoch 9/50
318/318 - 9s - loss: 3.2687 - accuracy50: 0.3822 - val_loss: 3.2784 - val_accuracy50: 0.3767 - 9s/epoch - 29ms/step
Epoch 10/50
318/318 - 9s - loss: 3.2667 - accuracy50: 0.3843 - val_loss: 3.2804 - val_accuracy50: 0.3739 - 9s/epoch - 28ms/step
Epoch 11/50
318/318 - 9s - loss: 3.2634 - accuracy50: 0.3860 - val_loss: 3.2793 - val_accuracy50: 0.3747 - 9s/epoch - 29ms/step
Epoch 12/50
318/318 - 9s - loss: 3.2617 - accuracy50: 0.3879 - val_loss: 3.2788 - val_accuracy50: 0.3768 - 9s/epoch - 28ms/step
Epoch 13/50
318/318 - 9s - loss: 3.2600 - accuracy50: 0.3893 - val_loss: 3.2767 - val_accuracy50: 0.3763 - 9s/epoch - 29ms/step
Epoch 14/50
318/318 - 9s - loss: 3.2578 - accuracy50: 0.3904 - val_loss: 3.2761 - val_accuracy50: 0.3784 - 9s/epoch - 30ms/step
Epoch 15/50
318/318 - 9s - loss: 3.2572 - accuracy50: 0.3914 - val_loss: 3.2802 - val_accuracy50: 0.3728 - 9s/epoch - 29ms/step
Epoch 16/50
318/318 - 9s - loss: 3.2533 - accuracy50: 0.3939 - val_loss: 3.2810 - val_accuracy50: 0.3738 - 9s/epoch - 29ms/step
Epoch 17/50
318/318 - 9s - loss: 3.2528 - accuracy50: 0.3908 - val_loss: 3.2805 - val_accuracy50: 0.3732 - 9s/epoch - 29ms/step
Epoch 18/50
318/318 - 9s - loss: 3.2500 - accuracy50: 0.3957 - val_loss: 3.2828 - val_accuracy50: 0.3721 - 9s/epoch - 29ms/step
Epoch 19/50
318/318 - 9s - loss: 3.2471 - accuracy50: 0.3971 - val_loss: 3.2824 - val_accuracy50: 0.3728 - 9s/epoch - 28ms/step
Epoch 20/50
318/318 - 9s - loss: 3.2461 - accuracy50: 0.3984 - val_loss: 3.2827 - val_accuracy50: 0.3686 - 9s/epoch - 28ms/step
Epoch 21/50
318/318 - 9s - loss: 3.2457 - accuracy50: 0.3972 - val_loss: 3.2829 - val_accuracy50: 0.3742 - 9s/epoch - 28ms/step
Epoch 22/50
318/318 - 9s - loss: 3.2418 - accuracy50: 0.4005 - val_loss: 3.2862 - val_accuracy50: 0.3688 - 9s/epoch - 28ms/step
Epoch 23/50
318/318 - 9s - loss: 3.2406 - accuracy50: 0.4017 - val_loss: 3.2885 - val_accuracy50: 0.3695 - 9s/epoch - 29ms/step
Epoch 24/50
318/318 - 9s - loss: 3.2385 - accuracy50: 0.4019 - val_loss: 3.2849 - val_accuracy50: 0.3707 - 9s/epoch - 28ms/step
testing model: results/LILAK/W0/deepOF_L1/h50
Evaluating performance on  test set...
876/876 - 16s - 16s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0814788
{'0': {'precision': 0.32710611772610204, 'recall': 0.2871678081069568, 'f1-score': 0.3058386263697913, 'support': 61034}, '1': {'precision': 0.5043402954661232, 'recall': 0.4930231168391383, 'f1-score': 0.49861749759510055, 'support': 100403}, '2': {'precision': 0.3371951724709326, 'recall': 0.3893770031731858, 'f1-score': 0.36141225921513204, 'support': 62713}, 'accuracy': 0.40797233995092574, 'macro avg': {'precision': 0.3895471952210526, 'recall': 0.38985597603976024, 'f1-score': 0.3886227943933413, 'support': 224150}, 'weighted avg': {'precision': 0.4093169499270564, 'recall': 0.40797233995092574, 'f1-score': 0.4077380965650382, 'support': 224150}}
[[17527 24581 18926]
 [21829 49501 29073]
 [14226 24068 24419]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0881842
{'0': {'precision': 0.4031285502053657, 'recall': 0.33308061662875915, 'f1-score': 0.3647721656617574, 'support': 27699}, '1': {'precision': 0.3749842151786842, 'recall': 0.4427958993476235, 'f1-score': 0.40607852857216115, 'support': 26825}, '2': {'precision': 0.38784082811386567, 'recall': 0.3872888655855586, 'f1-score': 0.38756465032606247, 'support': 26701}, 'accuracy': 0.3871345029239766, 'macro avg': {'precision': 0.3886511978326385, 'recall': 0.38772179385398037, 'f1-score': 0.3861384481866604, 'support': 81225}, 'weighted avg': {'precision': 0.3888082146602026, 'recall': 0.3871345029239766, 'f1-score': 0.38590636471492074, 'support': 81225}}
[[ 9226 10151  8322]
 [ 6947 11878  8000]
 [ 6713  9647 10341]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.091271
{'0': {'precision': 0.34990316333118143, 'recall': 0.32968369829683697, 'f1-score': 0.3394926401503288, 'support': 8220}, '1': {'precision': 0.40388385771636637, 'recall': 0.43909866017052374, 'f1-score': 0.4207557263045275, 'support': 9852}, '2': {'precision': 0.36742565633943014, 'recall': 0.3506709416933856, 'f1-score': 0.35885283752582325, 'support': 8421}, 'accuracy': 0.37704299248858186, 'macro avg': {'precision': 0.37373755912899265, 'recall': 0.3731511000535821, 'f1-score': 0.37303373466022655, 'support': 26493}, 'weighted avg': {'precision': 0.37554671878753987, 'recall': 0.37704299248858186, 'f1-score': 0.3758658763595239, 'support': 26493}}
[[2710 3136 2374]
 [2816 4326 2710]
 [2219 3249 2953]]
training model: results/LILAK/W0/deepOF_L1/h100
Epoch 1/50
318/318 - 13s - loss: 3.3299 - accuracy100: 0.3453 - val_loss: 3.2967 - val_accuracy100: 0.3989 - 13s/epoch - 40ms/step
Epoch 2/50
318/318 - 9s - loss: 3.3093 - accuracy100: 0.3530 - val_loss: 3.2848 - val_accuracy100: 0.4100 - 9s/epoch - 29ms/step
Epoch 3/50
318/318 - 9s - loss: 3.3012 - accuracy100: 0.3575 - val_loss: 3.2826 - val_accuracy100: 0.4071 - 9s/epoch - 28ms/step
Epoch 4/50
318/318 - 9s - loss: 3.2969 - accuracy100: 0.3594 - val_loss: 3.2825 - val_accuracy100: 0.4099 - 9s/epoch - 30ms/step
Epoch 5/50
318/318 - 9s - loss: 3.2927 - accuracy100: 0.3624 - val_loss: 3.2829 - val_accuracy100: 0.4055 - 9s/epoch - 29ms/step
Epoch 6/50
318/318 - 9s - loss: 3.2905 - accuracy100: 0.3607 - val_loss: 3.2820 - val_accuracy100: 0.4087 - 9s/epoch - 29ms/step
Epoch 7/50
318/318 - 9s - loss: 3.2873 - accuracy100: 0.3642 - val_loss: 3.2812 - val_accuracy100: 0.4086 - 9s/epoch - 29ms/step
Epoch 8/50
318/318 - 9s - loss: 3.2831 - accuracy100: 0.3669 - val_loss: 3.2852 - val_accuracy100: 0.4068 - 9s/epoch - 29ms/step
Epoch 9/50
318/318 - 9s - loss: 3.2821 - accuracy100: 0.3679 - val_loss: 3.2850 - val_accuracy100: 0.4068 - 9s/epoch - 28ms/step
Epoch 10/50
318/318 - 9s - loss: 3.2788 - accuracy100: 0.3710 - val_loss: 3.2844 - val_accuracy100: 0.4061 - 9s/epoch - 28ms/step
Epoch 11/50
318/318 - 9s - loss: 3.2773 - accuracy100: 0.3726 - val_loss: 3.2846 - val_accuracy100: 0.4066 - 9s/epoch - 29ms/step
Epoch 12/50
318/318 - 9s - loss: 3.2750 - accuracy100: 0.3743 - val_loss: 3.2857 - val_accuracy100: 0.4030 - 9s/epoch - 29ms/step
Epoch 13/50
318/318 - 9s - loss: 3.2738 - accuracy100: 0.3762 - val_loss: 3.2890 - val_accuracy100: 0.4003 - 9s/epoch - 29ms/step
Epoch 14/50
318/318 - 9s - loss: 3.2713 - accuracy100: 0.3779 - val_loss: 3.2893 - val_accuracy100: 0.4011 - 9s/epoch - 29ms/step
Epoch 15/50
318/318 - 9s - loss: 3.2687 - accuracy100: 0.3791 - val_loss: 3.2900 - val_accuracy100: 0.4011 - 9s/epoch - 29ms/step
Epoch 16/50
318/318 - 9s - loss: 3.2678 - accuracy100: 0.3803 - val_loss: 3.2944 - val_accuracy100: 0.3988 - 9s/epoch - 28ms/step
Epoch 17/50
318/318 - 9s - loss: 3.2674 - accuracy100: 0.3806 - val_loss: 3.2952 - val_accuracy100: 0.3949 - 9s/epoch - 29ms/step
testing model: results/LILAK/W0/deepOF_L1/h100
Evaluating performance on  test set...
876/876 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0685271
{'0': {'precision': 0.3051565928585677, 'recall': 0.10715536564864107, 'f1-score': 0.15861371766291668, 'support': 57104}, '1': {'precision': 0.4890568101982699, 'recall': 0.8354343404730931, 'f1-score': 0.6169536934614721, 'support': 109154}, '2': {'precision': 0.3088743975049617, 'recall': 0.09408899329786499, 'f1-score': 0.14423980828048247, 'support': 57892}, 'accuracy': 0.4584296230202989, 'macro avg': {'precision': 0.3676959335205998, 'recall': 0.3455595664731997, 'f1-score': 0.3066024064682904, 'support': 224150}, 'weighted avg': {'precision': 0.3956704249803027, 'recall': 0.4584296230202989, 'f1-score': 0.378098470535313, 'support': 224150}}
[[ 6119 47362  3623]
 [ 9398 91191  8565]
 [ 4535 47910  5447]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1047097
{'0': {'precision': 0.44099756690997566, 'recall': 0.12529379234066085, 'f1-score': 0.19514427217915592, 'support': 28932}, '1': {'precision': 0.3111922422003521, 'recall': 0.8686107866435735, 'f1-score': 0.4582204515272244, 'support': 24827}, '2': {'precision': 0.4143512274076072, 'recall': 0.05592368746814243, 'f1-score': 0.09854681936291021, 'support': 27466}, 'accuracy': 0.3290366266543552, 'macro avg': {'precision': 0.388847012172645, 'recall': 0.3499427554841256, 'f1-score': 0.25063718102309684, 'support': 81225}, 'weighted avg': {'precision': 0.3923112614949202, 'recall': 0.3290366266543552, 'f1-score': 0.24289123020468364, 'support': 81225}}
[[ 3625 24199  1108]
 [ 2199 21565  1063]
 [ 2396 23534  1536]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.083164
{'0': {'precision': 0.3248673237300986, 'recall': 0.11211407639979068, 'f1-score': 0.16669908578097645, 'support': 7644}, '1': {'precision': 0.4189543626508131, 'recall': 0.8564024662675365, 'f1-score': 0.5626559427011478, 'support': 11191}, '2': {'precision': 0.35137895812053116, 'recall': 0.04492034473752938, 'f1-score': 0.07965728841032765, 'support': 7658}, 'accuracy': 0.40708866493035895, 'macro avg': {'precision': 0.36506688150048094, 'recall': 0.3378122958016188, 'f1-score': 0.269670772297484, 'support': 26493}, 'weighted avg': {'precision': 0.37227434251708563, 'recall': 0.40708866493035895, 'f1-score': 0.3087965115737975, 'support': 26493}}
[[ 857 6553  234]
 [1206 9584  401]
 [ 575 6739  344]]
training model: results/LILAK/W0/deepOF_L1/h200
Epoch 1/50
318/318 - 11s - loss: 3.3255 - accuracy200: 0.3490 - val_loss: 3.3027 - val_accuracy200: 0.3478 - 11s/epoch - 36ms/step
Epoch 2/50
318/318 - 9s - loss: 3.3063 - accuracy200: 0.3556 - val_loss: 3.3006 - val_accuracy200: 0.3466 - 9s/epoch - 28ms/step
Epoch 3/50
318/318 - 9s - loss: 3.2980 - accuracy200: 0.3596 - val_loss: 3.2942 - val_accuracy200: 0.3504 - 9s/epoch - 28ms/step
Epoch 4/50
318/318 - 9s - loss: 3.2970 - accuracy200: 0.3605 - val_loss: 3.2920 - val_accuracy200: 0.3535 - 9s/epoch - 29ms/step
Epoch 5/50
318/318 - 9s - loss: 3.2927 - accuracy200: 0.3623 - val_loss: 3.2910 - val_accuracy200: 0.3525 - 9s/epoch - 28ms/step
Epoch 6/50
318/318 - 9s - loss: 3.2904 - accuracy200: 0.3633 - val_loss: 3.2905 - val_accuracy200: 0.3552 - 9s/epoch - 28ms/step
Epoch 7/50
318/318 - 9s - loss: 3.2867 - accuracy200: 0.3667 - val_loss: 3.2891 - val_accuracy200: 0.3542 - 9s/epoch - 29ms/step
Epoch 8/50
318/318 - 9s - loss: 3.2844 - accuracy200: 0.3671 - val_loss: 3.2905 - val_accuracy200: 0.3553 - 9s/epoch - 27ms/step
Epoch 9/50
318/318 - 9s - loss: 3.2829 - accuracy200: 0.3695 - val_loss: 3.2885 - val_accuracy200: 0.3559 - 9s/epoch - 28ms/step
Epoch 10/50
318/318 - 9s - loss: 3.2811 - accuracy200: 0.3710 - val_loss: 3.2889 - val_accuracy200: 0.3544 - 9s/epoch - 27ms/step
Epoch 11/50
318/318 - 9s - loss: 3.2788 - accuracy200: 0.3724 - val_loss: 3.2883 - val_accuracy200: 0.3554 - 9s/epoch - 28ms/step
Epoch 12/50
318/318 - 9s - loss: 3.2781 - accuracy200: 0.3728 - val_loss: 3.2878 - val_accuracy200: 0.3567 - 9s/epoch - 28ms/step
Epoch 13/50
318/318 - 9s - loss: 3.2766 - accuracy200: 0.3758 - val_loss: 3.2887 - val_accuracy200: 0.3584 - 9s/epoch - 28ms/step
Epoch 14/50
318/318 - 9s - loss: 3.2750 - accuracy200: 0.3772 - val_loss: 3.2885 - val_accuracy200: 0.3597 - 9s/epoch - 27ms/step
Epoch 15/50
318/318 - 9s - loss: 3.2736 - accuracy200: 0.3771 - val_loss: 3.2881 - val_accuracy200: 0.3580 - 9s/epoch - 27ms/step
Epoch 16/50
318/318 - 9s - loss: 3.2722 - accuracy200: 0.3800 - val_loss: 3.2889 - val_accuracy200: 0.3578 - 9s/epoch - 29ms/step
Epoch 17/50
318/318 - 8s - loss: 3.2721 - accuracy200: 0.3794 - val_loss: 3.2885 - val_accuracy200: 0.3586 - 8s/epoch - 27ms/step
Epoch 18/50
318/318 - 9s - loss: 3.2694 - accuracy200: 0.3825 - val_loss: 3.2878 - val_accuracy200: 0.3614 - 9s/epoch - 27ms/step
Epoch 19/50
318/318 - 9s - loss: 3.2672 - accuracy200: 0.3851 - val_loss: 3.2888 - val_accuracy200: 0.3635 - 9s/epoch - 27ms/step
Epoch 20/50
318/318 - 9s - loss: 3.2661 - accuracy200: 0.3848 - val_loss: 3.2888 - val_accuracy200: 0.3600 - 9s/epoch - 27ms/step
Epoch 21/50
318/318 - 9s - loss: 3.2645 - accuracy200: 0.3860 - val_loss: 3.2878 - val_accuracy200: 0.3608 - 9s/epoch - 27ms/step
Epoch 22/50
318/318 - 9s - loss: 3.2630 - accuracy200: 0.3867 - val_loss: 3.2898 - val_accuracy200: 0.3607 - 9s/epoch - 28ms/step
testing model: results/LILAK/W0/deepOF_L1/h200
Evaluating performance on  test set...
876/876 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0949781
{'0': {'precision': 0.36625585835792396, 'recall': 0.17776404841472662, 'f1-score': 0.23935566815397413, 'support': 71218}, '1': {'precision': 0.3537130752030128, 'recall': 0.6846761333434581, 'f1-score': 0.4664511122607346, 'support': 79014}, '2': {'precision': 0.3803974016048911, 'recall': 0.18854676804026083, 'f1-score': 0.2521256195954991, 'support': 73918}, 'accuracy': 0.3600089225964756, 'macro avg': {'precision': 0.36678877838860924, 'recall': 0.35032898326614853, 'f1-score': 0.3193108000034026, 'support': 224150}, 'weighted avg': {'precision': 0.36649792449902213, 'recall': 0.3600089225964756, 'f1-score': 0.3236191019764422, 'support': 224150}}
[[12660 48967  9591]
 [11805 54099 13110]
 [10101 49880 13937]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0951921
{'0': {'precision': 0.4036759700476515, 'recall': 0.2151591016291136, 'f1-score': 0.28070341530377985, 'support': 27561}, '1': {'precision': 0.3400596564364264, 'recall': 0.705866994890157, 'f1-score': 0.4589937305215672, 'support': 26811}, '2': {'precision': 0.3923550491592392, 'recall': 0.15901389044054667, 'f1-score': 0.22630909476362096, 'support': 26853}, 'accuracy': 0.35857186826715914, 'macro avg': {'precision': 0.3786968918811057, 'recall': 0.3600133289866058, 'f1-score': 0.32200208019632265, 'support': 81225}, 'weighted avg': {'precision': 0.37893460134531737, 'recall': 0.35857186826715914, 'f1-score': 0.32157126327963964, 'support': 81225}}
[[ 5930 18362  3269]
 [ 4542 18925  3344]
 [ 4218 18365  4270]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0970494
{'0': {'precision': 0.3751809720785936, 'recall': 0.20793214121962403, 'f1-score': 0.267571354819677, 'support': 8724}, '1': {'precision': 0.34796001080788974, 'recall': 0.7016454178925575, 'f1-score': 0.4652120511523734, 'support': 9177}, '2': {'precision': 0.38947034570250555, 'recall': 0.14292364990689013, 'f1-score': 0.20911025968497232, 'support': 8592}, 'accuracy': 0.3578681161061412, 'macro avg': {'precision': 0.3708704428629963, 'recall': 0.35083373633969056, 'f1-score': 0.31396455521900757, 'support': 26493}, 'weighted avg': {'precision': 0.37038602762516826, 'recall': 0.3578681161061412, 'f1-score': 0.3170731455133611, 'support': 26493}}
[[1814 5976  934]
 [1747 6439  991]
 [1274 6090 1228]]
training model: results/LILAK/W0/deepOF_L1/h300
Epoch 1/50
318/318 - 12s - loss: 3.3289 - accuracy300: 0.3482 - val_loss: 3.2964 - val_accuracy300: 0.3687 - 12s/epoch - 37ms/step
Epoch 2/50
318/318 - 9s - loss: 3.3097 - accuracy300: 0.3531 - val_loss: 3.2915 - val_accuracy300: 0.3743 - 9s/epoch - 28ms/step
Epoch 3/50
318/318 - 9s - loss: 3.3019 - accuracy300: 0.3565 - val_loss: 3.2892 - val_accuracy300: 0.3733 - 9s/epoch - 29ms/step
Epoch 4/50
318/318 - 9s - loss: 3.2982 - accuracy300: 0.3596 - val_loss: 3.2860 - val_accuracy300: 0.3766 - 9s/epoch - 29ms/step
Epoch 5/50
318/318 - 9s - loss: 3.2957 - accuracy300: 0.3608 - val_loss: 3.2875 - val_accuracy300: 0.3763 - 9s/epoch - 28ms/step
Epoch 6/50
318/318 - 10s - loss: 3.2936 - accuracy300: 0.3607 - val_loss: 3.2843 - val_accuracy300: 0.3773 - 10s/epoch - 30ms/step
Epoch 7/50
318/318 - 9s - loss: 3.2913 - accuracy300: 0.3623 - val_loss: 3.2852 - val_accuracy300: 0.3758 - 9s/epoch - 29ms/step
Epoch 8/50
318/318 - 9s - loss: 3.2883 - accuracy300: 0.3642 - val_loss: 3.2848 - val_accuracy300: 0.3779 - 9s/epoch - 29ms/step
Epoch 9/50
318/318 - 9s - loss: 3.2874 - accuracy300: 0.3643 - val_loss: 3.2832 - val_accuracy300: 0.3764 - 9s/epoch - 29ms/step
Epoch 10/50
318/318 - 9s - loss: 3.2864 - accuracy300: 0.3645 - val_loss: 3.2840 - val_accuracy300: 0.3787 - 9s/epoch - 28ms/step
Epoch 11/50
318/318 - 9s - loss: 3.2842 - accuracy300: 0.3663 - val_loss: 3.2830 - val_accuracy300: 0.3753 - 9s/epoch - 28ms/step
Epoch 12/50
318/318 - 9s - loss: 3.2844 - accuracy300: 0.3669 - val_loss: 3.2836 - val_accuracy300: 0.3759 - 9s/epoch - 29ms/step
Epoch 13/50
318/318 - 9s - loss: 3.2822 - accuracy300: 0.3694 - val_loss: 3.2842 - val_accuracy300: 0.3764 - 9s/epoch - 28ms/step
Epoch 14/50
318/318 - 9s - loss: 3.2811 - accuracy300: 0.3682 - val_loss: 3.2832 - val_accuracy300: 0.3757 - 9s/epoch - 28ms/step
Epoch 15/50
318/318 - 9s - loss: 3.2806 - accuracy300: 0.3693 - val_loss: 3.2840 - val_accuracy300: 0.3779 - 9s/epoch - 28ms/step
Epoch 16/50
318/318 - 9s - loss: 3.2790 - accuracy300: 0.3709 - val_loss: 3.2835 - val_accuracy300: 0.3753 - 9s/epoch - 29ms/step
Epoch 17/50
318/318 - 9s - loss: 3.2785 - accuracy300: 0.3712 - val_loss: 3.2837 - val_accuracy300: 0.3770 - 9s/epoch - 28ms/step
Epoch 18/50
318/318 - 9s - loss: 3.2771 - accuracy300: 0.3718 - val_loss: 3.2842 - val_accuracy300: 0.3763 - 9s/epoch - 29ms/step
Epoch 19/50
318/318 - 9s - loss: 3.2767 - accuracy300: 0.3719 - val_loss: 3.2845 - val_accuracy300: 0.3757 - 9s/epoch - 27ms/step
Epoch 20/50
318/318 - 9s - loss: 3.2746 - accuracy300: 0.3737 - val_loss: 3.2849 - val_accuracy300: 0.3756 - 9s/epoch - 28ms/step
Epoch 21/50
318/318 - 9s - loss: 3.2725 - accuracy300: 0.3758 - val_loss: 3.2850 - val_accuracy300: 0.3736 - 9s/epoch - 29ms/step
testing model: results/LILAK/W0/deepOF_L1/h300
Evaluating performance on  test set...
876/876 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0853714
{'0': {'precision': 0.3339373690469449, 'recall': 0.09168649035247291, 'f1-score': 0.14387137698838684, 'support': 64317}, '1': {'precision': 0.41245560219567323, 'recall': 0.8876342276413937, 'f1-score': 0.5632067900065103, 'support': 92101}, '2': {'precision': 0.36846553181214536, 'recall': 0.04505994212484498, 'f1-score': 0.08029994080115767, 'support': 67732}, 'accuracy': 0.4046442114655365, 'macro avg': {'precision': 0.3716195010182545, 'recall': 0.3414602200395705, 'f1-score': 0.26245936926535157, 'support': 224150}, 'weighted avg': {'precision': 0.37663319466212936, 'recall': 0.4046442114655365, 'f1-score': 0.2969625675239603, 'support': 224150}}
[[ 5897 56608  1812]
 [ 6930 81752  3419]
 [ 4832 59848  3052]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1036885
{'0': {'precision': 0.4197889182058048, 'recall': 0.11374848073210839, 'f1-score': 0.17899533104573326, 'support': 27974}, '1': {'precision': 0.3220220248269678, 'recall': 0.8904385557105222, 'f1-score': 0.472989936822176, 'support': 25812}, '2': {'precision': 0.4139145750770586, 'recall': 0.03425780822916287, 'f1-score': 0.06327835745540222, 'support': 27439}, 'accuracy': 0.33371498922745463, 'macro avg': {'precision': 0.3852418393699437, 'recall': 0.3461482815572645, 'f1-score': 0.23842120844110382, 'support': 81225}, 'weighted avg': {'precision': 0.38673573072652856, 'recall': 0.33371498922745463, 'f1-score': 0.23333119717015863, 'support': 81225}}
[[ 3182 24110   682]
 [ 2179 22984   649]
 [ 2219 24280   940]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.09344
{'0': {'precision': 0.341991341991342, 'recall': 0.09580402619451855, 'f1-score': 0.14967790829859798, 'support': 8246}, '1': {'precision': 0.3784116996854009, 'recall': 0.8847912524850895, 'f1-score': 0.5301054136144363, 'support': 10060}, '2': {'precision': 0.38729198184568836, 'recall': 0.03126908513497007, 'f1-score': 0.05786618444846292, 'support': 8187}, 'accuracy': 0.375457668063262, 'macro avg': {'precision': 0.36923167450747707, 'recall': 0.337288121271526, 'f1-score': 0.24588316878716573, 'support': 26493}, 'weighted avg': {'precision': 0.3698200188829649, 'recall': 0.375457668063262, 'f1-score': 0.26576284093424807, 'support': 26493}}
[[ 790 7234  222]
 [ 976 8901  183]
 [ 544 7387  256]]
training model: results/LILAK/W0/deepOF_L1/h500
Epoch 1/50
318/318 - 12s - loss: 3.3349 - accuracy500: 0.3442 - val_loss: 3.3215 - val_accuracy500: 0.3286 - 12s/epoch - 38ms/step
Epoch 2/50
318/318 - 9s - loss: 3.3185 - accuracy500: 0.3443 - val_loss: 3.3091 - val_accuracy500: 0.3342 - 9s/epoch - 28ms/step
Epoch 3/50
318/318 - 9s - loss: 3.3109 - accuracy500: 0.3453 - val_loss: 3.3037 - val_accuracy500: 0.3290 - 9s/epoch - 29ms/step
Epoch 4/50
318/318 - 9s - loss: 3.3064 - accuracy500: 0.3471 - val_loss: 3.3018 - val_accuracy500: 0.3301 - 9s/epoch - 29ms/step
Epoch 5/50
318/318 - 9s - loss: 3.3038 - accuracy500: 0.3491 - val_loss: 3.3034 - val_accuracy500: 0.3285 - 9s/epoch - 28ms/step
Epoch 6/50
318/318 - 9s - loss: 3.2991 - accuracy500: 0.3515 - val_loss: 3.3042 - val_accuracy500: 0.3295 - 9s/epoch - 27ms/step
Epoch 7/50
318/318 - 9s - loss: 3.2983 - accuracy500: 0.3513 - val_loss: 3.3020 - val_accuracy500: 0.3287 - 9s/epoch - 28ms/step
Epoch 8/50
318/318 - 9s - loss: 3.2973 - accuracy500: 0.3546 - val_loss: 3.3046 - val_accuracy500: 0.3279 - 9s/epoch - 28ms/step
Epoch 9/50
318/318 - 9s - loss: 3.2947 - accuracy500: 0.3547 - val_loss: 3.3028 - val_accuracy500: 0.3299 - 9s/epoch - 28ms/step
Epoch 10/50
318/318 - 9s - loss: 3.2932 - accuracy500: 0.3598 - val_loss: 3.3035 - val_accuracy500: 0.3299 - 9s/epoch - 28ms/step
Epoch 11/50
318/318 - 9s - loss: 3.2924 - accuracy500: 0.3578 - val_loss: 3.3028 - val_accuracy500: 0.3284 - 9s/epoch - 28ms/step
Epoch 12/50
318/318 - 9s - loss: 3.2904 - accuracy500: 0.3583 - val_loss: 3.3019 - val_accuracy500: 0.3294 - 9s/epoch - 28ms/step
Epoch 13/50
318/318 - 9s - loss: 3.2887 - accuracy500: 0.3618 - val_loss: 3.3015 - val_accuracy500: 0.3305 - 9s/epoch - 28ms/step
Epoch 14/50
318/318 - 9s - loss: 3.2875 - accuracy500: 0.3613 - val_loss: 3.3029 - val_accuracy500: 0.3274 - 9s/epoch - 29ms/step
Epoch 15/50
318/318 - 9s - loss: 3.2858 - accuracy500: 0.3617 - val_loss: 3.3052 - val_accuracy500: 0.3274 - 9s/epoch - 27ms/step
Epoch 16/50
318/318 - 9s - loss: 3.2861 - accuracy500: 0.3626 - val_loss: 3.3073 - val_accuracy500: 0.3296 - 9s/epoch - 28ms/step
Epoch 17/50
318/318 - 9s - loss: 3.2838 - accuracy500: 0.3629 - val_loss: 3.3061 - val_accuracy500: 0.3284 - 9s/epoch - 28ms/step
Epoch 18/50
318/318 - 9s - loss: 3.2840 - accuracy500: 0.3636 - val_loss: 3.3076 - val_accuracy500: 0.3310 - 9s/epoch - 28ms/step
Epoch 19/50
318/318 - 9s - loss: 3.2818 - accuracy500: 0.3648 - val_loss: 3.3075 - val_accuracy500: 0.3290 - 9s/epoch - 29ms/step
Epoch 20/50
318/318 - 9s - loss: 3.2816 - accuracy500: 0.3647 - val_loss: 3.3074 - val_accuracy500: 0.3271 - 9s/epoch - 28ms/step
Epoch 21/50
318/318 - 9s - loss: 3.2793 - accuracy500: 0.3688 - val_loss: 3.3050 - val_accuracy500: 0.3296 - 9s/epoch - 29ms/step
Epoch 22/50
318/318 - 9s - loss: 3.2790 - accuracy500: 0.3679 - val_loss: 3.3081 - val_accuracy500: 0.3295 - 9s/epoch - 28ms/step
Epoch 23/50
318/318 - 9s - loss: 3.2771 - accuracy500: 0.3697 - val_loss: 3.3091 - val_accuracy500: 0.3280 - 9s/epoch - 27ms/step
testing model: results/LILAK/W0/deepOF_L1/h500
Evaluating performance on  test set...
876/876 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985442
{'0': {'precision': 0.3275691699604743, 'recall': 0.15435206472077526, 'f1-score': 0.20983087726238747, 'support': 68726}, '1': {'precision': 0.35608292446511325, 'recall': 0.8206164349179258, 'f1-score': 0.49665617250428185, 'support': 79684}, '2': {'precision': 0.3721244925575101, 'recall': 0.039939265909691046, 'f1-score': 0.07213630781337561, 'support': 75740}, 'accuracy': 0.35254517064465757, 'macro avg': {'precision': 0.35192552899436585, 'recall': 0.33830258851613065, 'f1-score': 0.2595411191933483, 'support': 224150}, 'weighted avg': {'precision': 0.35276082799057534, 'recall': 0.35254517064465757, 'f1-score': 0.26526875429110464, 'support': 224150}}
[[10608 55983  2135]
 [11325 65390  2969]
 [10451 62264  3025]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0980115
{'0': {'precision': 0.38921663804047496, 'recall': 0.18912152110018507, 'f1-score': 0.25455433455433457, 'support': 27559}, '1': {'precision': 0.33023691443135933, 'recall': 0.8131876441453363, 'f1-score': 0.4697198016990981, 'support': 26449}, '2': {'precision': 0.3988909426987061, 'recall': 0.0396443399345997, 'f1-score': 0.07212084753692935, 'support': 27217}, 'accuracy': 0.34224684518313325, 'macro avg': {'precision': 0.3727814983901801, 'recall': 0.3473178350600403, 'f1-score': 0.26546499459678735, 'support': 81225}, 'weighted avg': {'precision': 0.3732529672512546, 'recall': 0.34224684518313325, 'f1-score': 0.2634877814531851, 'support': 81225}}
[[ 5212 21550   797]
 [ 4112 21508   829]
 [ 4067 22071  1079]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1011823
{'0': {'precision': 0.3602439024390244, 'recall': 0.1646416230074685, 'f1-score': 0.22599648075893197, 'support': 8971}, '1': {'precision': 0.3243168004454136, 'recall': 0.8144005592450192, 'f1-score': 0.46389700026546327, 'support': 8583}, '2': {'precision': 0.39404761904761904, 'recall': 0.03702875041951001, 'f1-score': 0.06769608344411494, 'support': 8939}, 'accuracy': 0.3320877212848677, 'macro avg': {'precision': 0.3595361073106857, 'recall': 0.33869031089066587, 'f1-score': 0.25252985482283674, 'support': 26493}, 'weighted avg': {'precision': 0.360010222083952, 'recall': 0.3320877212848677, 'f1-score': 0.24965755754628746, 'support': 26493}}
[[1477 7187  307]
 [1391 6990  202]
 [1232 7376  331]]
training model: results/LILAK/W0/deepOF_L1/h1000
Epoch 1/50
318/318 - 11s - loss: 3.3506 - accuracy1000: 0.3388 - val_loss: 3.3157 - val_accuracy1000: 0.3347 - 11s/epoch - 36ms/step
Epoch 2/50
318/318 - 9s - loss: 3.3277 - accuracy1000: 0.3461 - val_loss: 3.3638 - val_accuracy1000: 0.3171 - 9s/epoch - 27ms/step
Epoch 3/50
318/318 - 9s - loss: 3.3272 - accuracy1000: 0.3420 - val_loss: 3.2939 - val_accuracy1000: 0.3526 - 9s/epoch - 29ms/step
Epoch 4/50
318/318 - 9s - loss: 3.3165 - accuracy1000: 0.3429 - val_loss: 3.2974 - val_accuracy1000: 0.3448 - 9s/epoch - 29ms/step
Epoch 5/50
318/318 - 9s - loss: 3.3126 - accuracy1000: 0.3427 - val_loss: 3.2976 - val_accuracy1000: 0.3457 - 9s/epoch - 28ms/step
Epoch 6/50
318/318 - 9s - loss: 3.3097 - accuracy1000: 0.3428 - val_loss: 3.2967 - val_accuracy1000: 0.3437 - 9s/epoch - 27ms/step
Epoch 7/50
318/318 - 9s - loss: 3.3063 - accuracy1000: 0.3427 - val_loss: 3.2992 - val_accuracy1000: 0.3407 - 9s/epoch - 28ms/step
Epoch 8/50
318/318 - 9s - loss: 3.3039 - accuracy1000: 0.3476 - val_loss: 3.3040 - val_accuracy1000: 0.3323 - 9s/epoch - 28ms/step
Epoch 9/50
318/318 - 9s - loss: 3.3020 - accuracy1000: 0.3474 - val_loss: 3.3030 - val_accuracy1000: 0.3362 - 9s/epoch - 28ms/step
Epoch 10/50
318/318 - 9s - loss: 3.2994 - accuracy1000: 0.3484 - val_loss: 3.3047 - val_accuracy1000: 0.3295 - 9s/epoch - 28ms/step
Epoch 11/50
318/318 - 9s - loss: 3.2964 - accuracy1000: 0.3516 - val_loss: 3.3063 - val_accuracy1000: 0.3288 - 9s/epoch - 29ms/step
Epoch 12/50
318/318 - 9s - loss: 3.2945 - accuracy1000: 0.3559 - val_loss: 3.3060 - val_accuracy1000: 0.3356 - 9s/epoch - 28ms/step
Epoch 13/50
318/318 - 9s - loss: 3.2922 - accuracy1000: 0.3547 - val_loss: 3.3150 - val_accuracy1000: 0.3290 - 9s/epoch - 28ms/step
testing model: results/LILAK/W0/deepOF_L1/h1000
Evaluating performance on  test set...
876/876 - 16s - 16s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.103786
{'0': {'precision': 0.30755718308811913, 'recall': 0.4788787427099463, 'f1-score': 0.3745571439890432, 'support': 69101}, '1': {'precision': 0.34998796051047437, 'recall': 0.07476082707540377, 'f1-score': 0.12320406865861412, 'support': 77768}, '2': {'precision': 0.3456300965531042, 'recall': 0.44699214554677086, 'f1-score': 0.38982993465970006, 'support': 77281}, 'accuracy': 0.32767789426723176, 'macro avg': {'precision': 0.3343917467172326, 'recall': 0.333543905110707, 'f1-score': 0.29586371576911913, 'support': 224150}, 'weighted avg': {'precision': 0.3354049168559944, 'recall': 0.32767789426723176, 'f1-score': 0.2926167941051361, 'support': 224150}}
[[33091  4936 31074]
 [37627  5814 34327]
 [36875  5862 34544]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001785
{'0': {'precision': 0.34499655665624834, 'recall': 0.47972450370152114, 'f1-score': 0.40135582774824746, 'support': 27151}, '1': {'precision': 0.33204987165383204, 'recall': 0.06606354649254004, 'f1-score': 0.11020172209206804, 'support': 27413}, '2': {'precision': 0.3357971433832233, 'recall': 0.47882675068452046, 'f1-score': 0.3947555583042147, 'support': 26661}, 'accuracy': 0.33982148353339486, 'macro avg': {'precision': 0.33761452389776786, 'recall': 0.3415382669595272, 'f1-score': 0.3021043693815101, 'support': 81225}, 'weighted avg': {'precision': 0.33760753808753974, 'recall': 0.33982148353339486, 'f1-score': 0.30092643677256015, 'support': 81225}}
[[13025  1813 12313]
 [12664  1811 12938]
 [12065  1830 12766]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0978118
{'0': {'precision': 0.3471398747390397, 'recall': 0.46173497722981227, 'f1-score': 0.3963199542377729, 'support': 9003}, '1': {'precision': 0.27882205513784464, 'recall': 0.05505381665223308, 'f1-score': 0.09195164789751008, 'support': 8083}, '2': {'precision': 0.36681628230924007, 'recall': 0.5038800892952057, 'f1-score': 0.42455998925164584, 'support': 9407}, 'accuracy': 0.3526214471747254, 'macro avg': {'precision': 0.3309260707287081, 'recall': 0.3402229610590837, 'f1-score': 0.3042771971289763, 'support': 26493}, 'weighted avg': {'precision': 0.3332827438054502, 'recall': 0.3526214471747254, 'f1-score': 0.3134846765880978, 'support': 26493}}
[[4157  578 4268]
 [3724  445 3914]
 [4094  573 4740]]
training model: results/LILAK/W0/deepLOB_L2/h10
Epoch 1/50
318/318 - 19s - loss: 3.3515 - accuracy10: 0.3457 - val_loss: 3.2758 - val_accuracy10: 0.3820 - 19s/epoch - 61ms/step
Epoch 2/50
318/318 - 16s - loss: 3.2969 - accuracy10: 0.3499 - val_loss: 3.2166 - val_accuracy10: 0.3872 - 16s/epoch - 50ms/step
Epoch 3/50
318/318 - 16s - loss: 3.2595 - accuracy10: 0.3640 - val_loss: 3.1821 - val_accuracy10: 0.4194 - 16s/epoch - 51ms/step
Epoch 4/50
318/318 - 16s - loss: 3.2243 - accuracy10: 0.3644 - val_loss: 3.1683 - val_accuracy10: 0.3800 - 16s/epoch - 51ms/step
Epoch 5/50
318/318 - 16s - loss: 3.2017 - accuracy10: 0.3704 - val_loss: 3.1636 - val_accuracy10: 0.3903 - 16s/epoch - 51ms/step
Epoch 6/50
318/318 - 16s - loss: 3.1846 - accuracy10: 0.3819 - val_loss: 3.1659 - val_accuracy10: 0.3872 - 16s/epoch - 50ms/step
Epoch 7/50
318/318 - 16s - loss: 3.1737 - accuracy10: 0.3892 - val_loss: 3.1695 - val_accuracy10: 0.3720 - 16s/epoch - 50ms/step
Epoch 8/50
318/318 - 16s - loss: 3.1628 - accuracy10: 0.3978 - val_loss: 3.1597 - val_accuracy10: 0.4061 - 16s/epoch - 50ms/step
Epoch 9/50
318/318 - 16s - loss: 3.1511 - accuracy10: 0.4055 - val_loss: 3.1541 - val_accuracy10: 0.4229 - 16s/epoch - 52ms/step
Epoch 10/50
318/318 - 16s - loss: 3.1395 - accuracy10: 0.4150 - val_loss: 3.1544 - val_accuracy10: 0.3860 - 16s/epoch - 51ms/step
Epoch 11/50
318/318 - 16s - loss: 3.1306 - accuracy10: 0.4217 - val_loss: 3.1413 - val_accuracy10: 0.4009 - 16s/epoch - 51ms/step
Epoch 12/50
318/318 - 16s - loss: 3.1159 - accuracy10: 0.4292 - val_loss: 3.1392 - val_accuracy10: 0.3970 - 16s/epoch - 51ms/step
Epoch 13/50
318/318 - 16s - loss: 3.1072 - accuracy10: 0.4373 - val_loss: 3.1318 - val_accuracy10: 0.4103 - 16s/epoch - 49ms/step
Epoch 14/50
318/318 - 16s - loss: 3.0957 - accuracy10: 0.4426 - val_loss: 3.1611 - val_accuracy10: 0.3970 - 16s/epoch - 49ms/step
Epoch 15/50
318/318 - 16s - loss: 3.0853 - accuracy10: 0.4490 - val_loss: 3.1468 - val_accuracy10: 0.4275 - 16s/epoch - 51ms/step
Epoch 16/50
318/318 - 16s - loss: 3.0747 - accuracy10: 0.4525 - val_loss: 3.1801 - val_accuracy10: 0.4235 - 16s/epoch - 50ms/step
Epoch 17/50
318/318 - 16s - loss: 3.0664 - accuracy10: 0.4592 - val_loss: 3.1477 - val_accuracy10: 0.4576 - 16s/epoch - 49ms/step
Epoch 18/50
318/318 - 16s - loss: 3.0514 - accuracy10: 0.4626 - val_loss: 3.1885 - val_accuracy10: 0.4330 - 16s/epoch - 49ms/step
Epoch 19/50
318/318 - 16s - loss: 3.0424 - accuracy10: 0.4660 - val_loss: 3.1818 - val_accuracy10: 0.4080 - 16s/epoch - 50ms/step
Epoch 20/50
318/318 - 16s - loss: 3.0336 - accuracy10: 0.4681 - val_loss: 3.1956 - val_accuracy10: 0.4268 - 16s/epoch - 50ms/step
Epoch 21/50
318/318 - 16s - loss: 3.0215 - accuracy10: 0.4734 - val_loss: 3.2499 - val_accuracy10: 0.4027 - 16s/epoch - 50ms/step
Epoch 22/50
318/318 - 16s - loss: 3.0120 - accuracy10: 0.4750 - val_loss: 3.3215 - val_accuracy10: 0.3985 - 16s/epoch - 50ms/step
Epoch 23/50
318/318 - 16s - loss: 3.0009 - accuracy10: 0.4797 - val_loss: 3.2258 - val_accuracy10: 0.4225 - 16s/epoch - 50ms/step
testing model: results/LILAK/W0/deepLOB_L2/h10
Evaluating performance on  test set...
876/876 - 16s - 16s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0392814
{'0': {'precision': 0.2801669889799552, 'recall': 0.6112512557205045, 'f1-score': 0.3842246326985953, 'support': 44795}, '1': {'precision': 0.6905703145027456, 'recall': 0.3841068051511422, 'f1-score': 0.4936417690204418, 'support': 133252}, '2': {'precision': 0.3195557000019118, 'recall': 0.36251843497874553, 'f1-score': 0.3396839912614946, 'support': 46108}, 'accuracy': 0.42505855323325376, 'macro avg': {'precision': 0.43009766782820424, 'recall': 0.45262549861679746, 'f1-score': 0.4058501309935106, 'support': 224155}, 'weighted avg': {'precision': 0.5322389865725283, 'recall': 0.42505855323325376, 'f1-score': 0.4401072690608306, 'support': 224155}}
[[27381 10313  7101]
 [53578 51183 28491]
 [16772 12621 16715]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0581664
{'0': {'precision': 0.35131396957123096, 'recall': 0.5259294117647059, 'f1-score': 0.42124307413968565, 'support': 21250}, '1': {'precision': 0.5782563025210085, 'recall': 0.3371010129359835, 'f1-score': 0.4259118969713577, 'support': 39193}, '2': {'precision': 0.3640469738030714, 'recall': 0.46533557854221796, 'f1-score': 0.40850632483686355, 'support': 20785}, 'accuracy': 0.41931353720391984, 'macro avg': {'precision': 0.43120574863177025, 'recall': 0.44278866774763576, 'f1-score': 0.418553765315969, 'support': 81228}, 'weighted avg': {'precision': 0.4640731948169521, 'recall': 0.41931353720391984, 'f1-score': 0.42023667042400337, 'support': 81228}}
[[11176  4651  5423]
 [14508 13212 11473]
 [ 6128  4985  9672]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.065444
{'0': {'precision': 0.3097734899328859, 'recall': 0.4735492144918243, 'f1-score': 0.3745403829085837, 'support': 6238}, '1': {'precision': 0.6110185778347214, 'recall': 0.3477975495915986, 'f1-score': 0.44327740856067294, 'support': 13712}, '2': {'precision': 0.3374125874125874, 'recall': 0.4719547608130827, 'f1-score': 0.3935011150047786, 'support': 6543}, 'accuracy': 0.4080700562412713, 'macro avg': {'precision': 0.41940155172673155, 'recall': 0.4311005082988352, 'f1-score': 0.40377296882467845, 'support': 26493}, 'weighted avg': {'precision': 0.47251516736162763, 'recall': 0.4080700562412713, 'f1-score': 0.41479940098305057, 'support': 26493}}
[[2954 1468 1816]
 [4695 4769 4248]
 [1887 1568 3088]]
training model: results/LILAK/W0/deepLOB_L2/h20
Epoch 1/50
318/318 - 19s - loss: 3.3524 - accuracy20: 0.3450 - val_loss: 3.3332 - val_accuracy20: 0.3733 - 19s/epoch - 61ms/step
Epoch 2/50
318/318 - 16s - loss: 3.3010 - accuracy20: 0.3608 - val_loss: 3.2814 - val_accuracy20: 0.3744 - 16s/epoch - 50ms/step
Epoch 3/50
318/318 - 16s - loss: 3.2693 - accuracy20: 0.3757 - val_loss: 3.2596 - val_accuracy20: 0.3768 - 16s/epoch - 49ms/step
Epoch 4/50
318/318 - 16s - loss: 3.2394 - accuracy20: 0.3925 - val_loss: 3.2784 - val_accuracy20: 0.3656 - 16s/epoch - 51ms/step
Epoch 5/50
318/318 - 16s - loss: 3.2196 - accuracy20: 0.4009 - val_loss: 3.2419 - val_accuracy20: 0.3863 - 16s/epoch - 51ms/step
Epoch 6/50
318/318 - 16s - loss: 3.1996 - accuracy20: 0.4138 - val_loss: 3.2371 - val_accuracy20: 0.3901 - 16s/epoch - 50ms/step
Epoch 7/50
318/318 - 16s - loss: 3.1890 - accuracy20: 0.4193 - val_loss: 3.2775 - val_accuracy20: 0.3705 - 16s/epoch - 50ms/step
Epoch 8/50
318/318 - 16s - loss: 3.1769 - accuracy20: 0.4263 - val_loss: 3.2659 - val_accuracy20: 0.3759 - 16s/epoch - 50ms/step
Epoch 9/50
318/318 - 16s - loss: 3.1643 - accuracy20: 0.4335 - val_loss: 3.2406 - val_accuracy20: 0.3863 - 16s/epoch - 50ms/step
Epoch 10/50
318/318 - 16s - loss: 3.1589 - accuracy20: 0.4345 - val_loss: 3.2624 - val_accuracy20: 0.3767 - 16s/epoch - 51ms/step
Epoch 11/50
318/318 - 16s - loss: 3.1451 - accuracy20: 0.4423 - val_loss: 3.2796 - val_accuracy20: 0.3693 - 16s/epoch - 51ms/step
Epoch 12/50
318/318 - 16s - loss: 3.1373 - accuracy20: 0.4454 - val_loss: 3.2445 - val_accuracy20: 0.3925 - 16s/epoch - 49ms/step
Epoch 13/50
318/318 - 16s - loss: 3.1309 - accuracy20: 0.4489 - val_loss: 3.2858 - val_accuracy20: 0.3823 - 16s/epoch - 50ms/step
Epoch 14/50
318/318 - 16s - loss: 3.1209 - accuracy20: 0.4536 - val_loss: 3.2993 - val_accuracy20: 0.3792 - 16s/epoch - 50ms/step
Epoch 15/50
318/318 - 16s - loss: 3.1108 - accuracy20: 0.4570 - val_loss: 3.3122 - val_accuracy20: 0.3773 - 16s/epoch - 50ms/step
Epoch 16/50
318/318 - 16s - loss: 3.0987 - accuracy20: 0.4616 - val_loss: 3.3078 - val_accuracy20: 0.3847 - 16s/epoch - 51ms/step
testing model: results/LILAK/W0/deepLOB_L2/h20
Evaluating performance on  test set...
876/876 - 17s - 17s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0676031
{'0': {'precision': 0.3356210212391749, 'recall': 0.3163984356696163, 'f1-score': 0.32572637203606813, 'support': 55487}, '1': {'precision': 0.5342685709456605, 'recall': 0.39617202606889634, 'f1-score': 0.4549721129873802, 'support': 111704}, '2': {'precision': 0.31425040723473574, 'recall': 0.4910645319851134, 'f1-score': 0.3832469053768008, 'support': 56964}, 'accuracy': 0.40053980504561576, 'macro avg': {'precision': 0.39471333313985707, 'recall': 0.40121166457454205, 'f1-score': 0.3879817968000831, 'support': 224155}, 'weighted avg': {'precision': 0.42918293257849094, 'recall': 0.40053980504561576, 'f1-score': 0.4047514480256596, 'support': 224155}}
[[17556 21102 16829]
 [23237 44254 44213]
 [11516 17475 27973]]
Evaluating performance on  train set...
318/318 - 7s - 7s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0802755
{'0': {'precision': 0.4232139919951752, 'recall': 0.2981460023174971, 'f1-score': 0.34983797502775954, 'support': 25890}, '1': {'precision': 0.4034152917763369, 'recall': 0.41890540630624623, 'f1-score': 0.41101445483681076, 'support': 30002}, '2': {'precision': 0.3910475891314591, 'recall': 0.4913561730344174, 'f1-score': 0.4355005159958721, 'support': 25336}, 'accuracy': 0.4030137391047422, 'macro avg': {'precision': 0.40589229096765705, 'recall': 0.4028025272193869, 'f1-score': 0.3987843152868141, 'support': 81228}, 'weighted avg': {'precision': 0.40586814343407934, 'recall': 0.4030137391047422, 'f1-score': 0.39915302507453226, 'support': 81228}}
[[ 7719 10043  8128]
 [ 6176 12568 11258]
 [ 4344  8543 12449]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0830692
{'0': {'precision': 0.36085928261726447, 'recall': 0.24120669213542353, 'f1-score': 0.2891433083300434, 'support': 7591}, '1': {'precision': 0.44541437654919713, 'recall': 0.38015084621044887, 'f1-score': 0.4102029675946604, 'support': 10872}, '2': {'precision': 0.36062602965403623, 'recall': 0.5452054794520548, 'f1-score': 0.43411006445215666, 'support': 8030}, 'accuracy': 0.3903672668251991, 'macro avg': {'precision': 0.38896656294016596, 'recall': 0.38885433926597573, 'f1-score': 0.37781878012562015, 'support': 26493}, 'weighted avg': {'precision': 0.3954876735104532, 'recall': 0.3903672668251991, 'f1-score': 0.3827621384808563, 'support': 26493}}
[[1831 2727 3033]
 [2010 4133 4729]
 [1233 2419 4378]]
training model: results/LILAK/W0/deepLOB_L2/h30
Epoch 1/50
318/318 - 19s - loss: 3.3565 - accuracy30: 0.3440 - val_loss: 3.3462 - val_accuracy30: 0.3453 - 19s/epoch - 60ms/step
Epoch 2/50
318/318 - 16s - loss: 3.3049 - accuracy30: 0.3584 - val_loss: 3.3653 - val_accuracy30: 0.3286 - 16s/epoch - 51ms/step
Epoch 3/50
318/318 - 16s - loss: 3.2804 - accuracy30: 0.3727 - val_loss: 3.3104 - val_accuracy30: 0.3506 - 16s/epoch - 50ms/step
Epoch 4/50
318/318 - 16s - loss: 3.2566 - accuracy30: 0.3899 - val_loss: 3.2966 - val_accuracy30: 0.3636 - 16s/epoch - 52ms/step
Epoch 5/50
318/318 - 16s - loss: 3.2365 - accuracy30: 0.4062 - val_loss: 3.2888 - val_accuracy30: 0.3743 - 16s/epoch - 51ms/step
Epoch 6/50
318/318 - 16s - loss: 3.2214 - accuracy30: 0.4139 - val_loss: 3.2746 - val_accuracy30: 0.3836 - 16s/epoch - 50ms/step
Epoch 7/50
318/318 - 16s - loss: 3.2056 - accuracy30: 0.4211 - val_loss: 3.2827 - val_accuracy30: 0.3809 - 16s/epoch - 50ms/step
Epoch 8/50
318/318 - 16s - loss: 3.1976 - accuracy30: 0.4256 - val_loss: 3.2675 - val_accuracy30: 0.3957 - 16s/epoch - 51ms/step
Epoch 9/50
318/318 - 16s - loss: 3.1828 - accuracy30: 0.4335 - val_loss: 3.3050 - val_accuracy30: 0.3871 - 16s/epoch - 51ms/step
Epoch 10/50
318/318 - 16s - loss: 3.1743 - accuracy30: 0.4384 - val_loss: 3.2737 - val_accuracy30: 0.3850 - 16s/epoch - 51ms/step
Epoch 11/50
318/318 - 16s - loss: 3.1698 - accuracy30: 0.4380 - val_loss: 3.2589 - val_accuracy30: 0.4012 - 16s/epoch - 50ms/step
Epoch 12/50
318/318 - 16s - loss: 3.1576 - accuracy30: 0.4433 - val_loss: 3.2585 - val_accuracy30: 0.4034 - 16s/epoch - 50ms/step
Epoch 13/50
318/318 - 17s - loss: 3.1514 - accuracy30: 0.4460 - val_loss: 3.2986 - val_accuracy30: 0.3914 - 17s/epoch - 53ms/step
Epoch 14/50
318/318 - 16s - loss: 3.1400 - accuracy30: 0.4505 - val_loss: 3.2652 - val_accuracy30: 0.4010 - 16s/epoch - 51ms/step
Epoch 15/50
318/318 - 16s - loss: 3.1354 - accuracy30: 0.4520 - val_loss: 3.2609 - val_accuracy30: 0.4029 - 16s/epoch - 51ms/step
Epoch 16/50
318/318 - 16s - loss: 3.1267 - accuracy30: 0.4560 - val_loss: 3.2643 - val_accuracy30: 0.4026 - 16s/epoch - 51ms/step
Epoch 17/50
318/318 - 16s - loss: 3.1140 - accuracy30: 0.4611 - val_loss: 3.2791 - val_accuracy30: 0.4016 - 16s/epoch - 51ms/step
Epoch 18/50
318/318 - 16s - loss: 3.1094 - accuracy30: 0.4626 - val_loss: 3.2729 - val_accuracy30: 0.4017 - 16s/epoch - 51ms/step
Epoch 19/50
318/318 - 16s - loss: 3.0998 - accuracy30: 0.4660 - val_loss: 3.2938 - val_accuracy30: 0.3993 - 16s/epoch - 51ms/step
Epoch 20/50
318/318 - 16s - loss: 3.0926 - accuracy30: 0.4690 - val_loss: 3.3081 - val_accuracy30: 0.3972 - 16s/epoch - 51ms/step
Epoch 21/50
318/318 - 16s - loss: 3.0792 - accuracy30: 0.4749 - val_loss: 3.3148 - val_accuracy30: 0.3997 - 16s/epoch - 50ms/step
Epoch 22/50
318/318 - 16s - loss: 3.0710 - accuracy30: 0.4748 - val_loss: 3.3237 - val_accuracy30: 0.3978 - 16s/epoch - 50ms/step
testing model: results/LILAK/W0/deepLOB_L2/h30
Evaluating performance on  test set...
876/876 - 16s - 16s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0678401
{'0': {'precision': 0.36842755256414217, 'recall': 0.2024601289446895, 'f1-score': 0.26131896768824797, 'support': 58940}, '1': {'precision': 0.5088577678815579, 'recall': 0.496678010046994, 'f1-score': 0.502694124059951, 'support': 104907}, '2': {'precision': 0.3338032896945284, 'recall': 0.49466074152682893, 'f1-score': 0.398615695025321, 'support': 60308}, 'accuracy': 0.41877272423100087, 'macro avg': {'precision': 0.40369620338007617, 'recall': 0.39793296017283747, 'f1-score': 0.38754292892450665, 'support': 224155}, 'weighted avg': {'precision': 0.42483491600980905, 'recall': 0.41877272423100087, 'f1-score': 0.41122432140210863, 'support': 224155}}
[[11933 27204 19803]
 [13067 52105 39735]
 [ 7389 23087 29832]]
Evaluating performance on  train set...
318/318 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0794327
{'0': {'precision': 0.46591982723714404, 'recall': 0.24979196063533413, 'f1-score': 0.3252231669689333, 'support': 27639}, '1': {'precision': 0.3775790501770236, 'recall': 0.464185208810176, 'f1-score': 0.41642682824202637, 'support': 26651}, '2': {'precision': 0.4143434583605778, 'recall': 0.5175217165342638, 'f1-score': 0.460220520269378, 'support': 26938}, 'accuracy': 0.40892303146698183, 'macro avg': {'precision': 0.4192807785915818, 'recall': 0.4104996286599247, 'f1-score': 0.4006235051601125, 'support': 81228}, 'weighted avg': {'precision': 0.41983061816851974, 'recall': 0.40892303146698183, 'f1-score': 0.3999169607321255, 'support': 81228}}
[[ 6904 11066  9669]
 [ 4244 12371 10036]
 [ 3670  9327 13941]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0854422
{'0': {'precision': 0.4279265723743605, 'recall': 0.17562060022230455, 'f1-score': 0.2490367775831874, 'support': 8097}, '1': {'precision': 0.4245108536941497, 'recall': 0.4338440111420613, 'f1-score': 0.4291266912669127, 'support': 10052}, '2': {'precision': 0.38094130417926647, 'recall': 0.5888063279002876, 'f1-score': 0.4625959229791441, 'support': 8344}, 'accuracy': 0.4037292869814668, 'macro avg': {'precision': 0.4111262434159255, 'recall': 0.3994236464215512, 'f1-score': 0.3802531306097481, 'support': 26493}, 'weighted avg': {'precision': 0.4118325142460495, 'recall': 0.4037292869814668, 'f1-score': 0.3846273608139529, 'support': 26493}}
[[1422 3235 3440]
 [1147 4361 4544]
 [ 754 2677 4913]]
training model: results/LILAK/W0/deepLOB_L2/h50
Epoch 1/50
318/318 - 19s - loss: 3.3562 - accuracy50: 0.3443 - val_loss: 3.3963 - val_accuracy50: 0.3266 - 19s/epoch - 60ms/step
Epoch 2/50
318/318 - 16s - loss: 3.3109 - accuracy50: 0.3557 - val_loss: 3.3410 - val_accuracy50: 0.3504 - 16s/epoch - 51ms/step
Epoch 3/50
318/318 - 16s - loss: 3.2880 - accuracy50: 0.3711 - val_loss: 3.3367 - val_accuracy50: 0.3468 - 16s/epoch - 51ms/step
Epoch 4/50
318/318 - 16s - loss: 3.2739 - accuracy50: 0.3796 - val_loss: 3.3221 - val_accuracy50: 0.3494 - 16s/epoch - 51ms/step
Epoch 5/50
318/318 - 16s - loss: 3.2560 - accuracy50: 0.3914 - val_loss: 3.3475 - val_accuracy50: 0.3568 - 16s/epoch - 50ms/step
Epoch 6/50
318/318 - 16s - loss: 3.2433 - accuracy50: 0.3989 - val_loss: 3.3194 - val_accuracy50: 0.3679 - 16s/epoch - 50ms/step
Epoch 7/50
318/318 - 16s - loss: 3.2304 - accuracy50: 0.4054 - val_loss: 3.3559 - val_accuracy50: 0.3665 - 16s/epoch - 50ms/step
Epoch 8/50
318/318 - 16s - loss: 3.2202 - accuracy50: 0.4118 - val_loss: 3.3852 - val_accuracy50: 0.3632 - 16s/epoch - 51ms/step
Epoch 9/50
318/318 - 16s - loss: 3.2114 - accuracy50: 0.4166 - val_loss: 3.3562 - val_accuracy50: 0.3694 - 16s/epoch - 51ms/step
Epoch 10/50
318/318 - 16s - loss: 3.2009 - accuracy50: 0.4229 - val_loss: 3.3632 - val_accuracy50: 0.3694 - 16s/epoch - 50ms/step
Epoch 11/50
318/318 - 16s - loss: 3.1890 - accuracy50: 0.4297 - val_loss: 3.4352 - val_accuracy50: 0.3698 - 16s/epoch - 52ms/step
Epoch 12/50
318/318 - 17s - loss: 3.1810 - accuracy50: 0.4326 - val_loss: 3.4299 - val_accuracy50: 0.3730 - 17s/epoch - 52ms/step
Epoch 13/50
318/318 - 16s - loss: 3.1697 - accuracy50: 0.4373 - val_loss: 3.4432 - val_accuracy50: 0.3696 - 16s/epoch - 51ms/step
Epoch 14/50
318/318 - 16s - loss: 3.1665 - accuracy50: 0.4371 - val_loss: 3.4300 - val_accuracy50: 0.3693 - 16s/epoch - 51ms/step
Epoch 15/50
318/318 - 16s - loss: 3.1564 - accuracy50: 0.4424 - val_loss: 3.4651 - val_accuracy50: 0.3683 - 16s/epoch - 51ms/step
Epoch 16/50
318/318 - 17s - loss: 3.1462 - accuracy50: 0.4466 - val_loss: 3.4462 - val_accuracy50: 0.3752 - 17s/epoch - 52ms/step
testing model: results/LILAK/W0/deepLOB_L2/h50
Evaluating performance on  test set...
876/876 - 16s - 16s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0958698
{'0': {'precision': 0.33273895761358147, 'recall': 0.29350372736954206, 'f1-score': 0.31189226363026995, 'support': 61035}, '1': {'precision': 0.46189108520583433, 'recall': 0.40843583486878143, 'f1-score': 0.4335218563349014, 'support': 100405}, '2': {'precision': 0.3229529509885689, 'recall': 0.41985171011719685, 'f1-score': 0.36508211609253577, 'support': 62715}, 'accuracy': 0.3803350360241797, 'macro avg': {'precision': 0.37252766460266157, 'recall': 0.3739304241185068, 'f1-score': 0.3701654120192357, 'support': 224155}, 'weighted avg': {'precision': 0.38785166964504403, 'recall': 0.3803350360241797, 'f1-score': 0.38125507442047996, 'support': 224155}}
[[17914 25631 17490]
 [21685 41009 37711]
 [14239 22145 26331]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.103454
{'0': {'precision': 0.41319565978298917, 'recall': 0.34125894341258944, 'f1-score': 0.37379774391450626, 'support': 27674}, '1': {'precision': 0.34266124778953244, 'recall': 0.41240385333432905, 'f1-score': 0.374311615690926, 'support': 26782}, '2': {'precision': 0.3927464707907724, 'recall': 0.3834603316898252, 'f1-score': 0.3880478539434144, 'support': 26772}, 'accuracy': 0.3786255970847491, 'macro avg': {'precision': 0.38286779278776467, 'recall': 0.37904104281224793, 'f1-score': 0.3787190711829489, 'support': 81228}, 'weighted avg': {'precision': 0.3831996201204543, 'recall': 0.3786255970847491, 'f1-score': 0.3786638794787206, 'support': 81228}}
[[ 9444 10893  7337]
 [ 7201 11045  8536]
 [ 6211 10295 10266]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1061372
{'0': {'precision': 0.3540952380952381, 'recall': 0.22585348074353057, 'f1-score': 0.2757955641272903, 'support': 8231}, '1': {'precision': 0.37753893797249294, 'recall': 0.4204280352976975, 'f1-score': 0.3978308858815625, 'support': 9859}, '2': {'precision': 0.3706157443491816, 'recall': 0.4526954659050339, 'f1-score': 0.40756415064016716, 'support': 8403}, 'accuracy': 0.37021099913184613, 'macro avg': {'precision': 0.36741664013897085, 'recall': 0.366325660648754, 'f1-score': 0.36039686688300665, 'support': 26493}, 'weighted avg': {'precision': 0.3680594267919407, 'recall': 0.37021099913184613, 'f1-score': 0.36300341788651247, 'support': 26493}}
[[1859 3577 2795]
 [2049 4145 3665]
 [1342 3257 3804]]
training model: results/LILAK/W0/deepLOB_L2/h100
Epoch 1/50
318/318 - 19s - loss: 3.3415 - accuracy100: 0.3563 - val_loss: 3.3498 - val_accuracy100: 0.3622 - 19s/epoch - 60ms/step
Epoch 2/50
318/318 - 16s - loss: 3.2923 - accuracy100: 0.3744 - val_loss: 3.3150 - val_accuracy100: 0.3953 - 16s/epoch - 51ms/step
Epoch 3/50
318/318 - 16s - loss: 3.2728 - accuracy100: 0.3809 - val_loss: 3.3215 - val_accuracy100: 0.3727 - 16s/epoch - 50ms/step
Epoch 4/50
318/318 - 16s - loss: 3.2667 - accuracy100: 0.3861 - val_loss: 3.2981 - val_accuracy100: 0.3978 - 16s/epoch - 50ms/step
Epoch 5/50
318/318 - 16s - loss: 3.2540 - accuracy100: 0.3920 - val_loss: 3.2814 - val_accuracy100: 0.4033 - 16s/epoch - 51ms/step
Epoch 6/50
318/318 - 16s - loss: 3.2386 - accuracy100: 0.4059 - val_loss: 3.3016 - val_accuracy100: 0.3834 - 16s/epoch - 52ms/step
Epoch 7/50
318/318 - 16s - loss: 3.2249 - accuracy100: 0.4174 - val_loss: 3.2746 - val_accuracy100: 0.4056 - 16s/epoch - 50ms/step
Epoch 8/50
318/318 - 16s - loss: 3.2136 - accuracy100: 0.4199 - val_loss: 3.3156 - val_accuracy100: 0.3722 - 16s/epoch - 50ms/step
Epoch 9/50
318/318 - 16s - loss: 3.2035 - accuracy100: 0.4283 - val_loss: 3.3586 - val_accuracy100: 0.3567 - 16s/epoch - 50ms/step
Epoch 10/50
318/318 - 16s - loss: 3.1974 - accuracy100: 0.4284 - val_loss: 3.3733 - val_accuracy100: 0.3495 - 16s/epoch - 52ms/step
Epoch 11/50
318/318 - 16s - loss: 3.1874 - accuracy100: 0.4352 - val_loss: 3.3722 - val_accuracy100: 0.3539 - 16s/epoch - 50ms/step
Epoch 12/50
318/318 - 16s - loss: 3.1771 - accuracy100: 0.4380 - val_loss: 3.4865 - val_accuracy100: 0.3299 - 16s/epoch - 52ms/step
Epoch 13/50
318/318 - 16s - loss: 3.1700 - accuracy100: 0.4412 - val_loss: 3.4323 - val_accuracy100: 0.3380 - 16s/epoch - 51ms/step
Epoch 14/50
318/318 - 17s - loss: 3.1592 - accuracy100: 0.4461 - val_loss: 3.4078 - val_accuracy100: 0.3404 - 17s/epoch - 52ms/step
Epoch 15/50
318/318 - 16s - loss: 3.1473 - accuracy100: 0.4534 - val_loss: 3.4276 - val_accuracy100: 0.3388 - 16s/epoch - 50ms/step
Epoch 16/50
318/318 - 16s - loss: 3.1357 - accuracy100: 0.4571 - val_loss: 3.5031 - val_accuracy100: 0.3284 - 16s/epoch - 50ms/step
Epoch 17/50
318/318 - 16s - loss: 3.1260 - accuracy100: 0.4615 - val_loss: 3.5067 - val_accuracy100: 0.3380 - 16s/epoch - 50ms/step
testing model: results/LILAK/W0/deepLOB_L2/h100
Evaluating performance on  test set...
876/876 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0767297
{'0': {'precision': 0.3004776506663522, 'recall': 0.1784576051553252, 'f1-score': 0.2239238865329261, 'support': 57106}, '1': {'precision': 0.4842609309992935, 'recall': 0.621669903624171, 'f1-score': 0.5444290671319976, 'support': 109156}, '2': {'precision': 0.29630812213131114, 'recall': 0.2564731487399167, 'f1-score': 0.2749553253150375, 'support': 57893}, 'accuracy': 0.41443643907117844, 'macro avg': {'precision': 0.3603489012656523, 'recall': 0.35220021917313765, 'f1-score': 0.3477694263266537, 'support': 224155}, 'weighted avg': {'precision': 0.3888970980690129, 'recall': 0.41443643907117844, 'f1-score': 0.393179207979626, 'support': 224155}}
[[10191 37683  9232]
 [15267 67859 26030]
 [ 8458 34587 14848]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0935309
{'0': {'precision': 0.43324428937469334, 'recall': 0.27489709087135494, 'f1-score': 0.3363667146364175, 'support': 28909}, '1': {'precision': 0.34348230690305187, 'recall': 0.5791591229128948, 'f1-score': 0.4312204181894435, 'support': 24855}, '2': {'precision': 0.4036517925247902, 'recall': 0.3082944946111273, 'f1-score': 0.34958711808422793, 'support': 27464}, 'accuracy': 0.37929039247550106, 'macro avg': {'precision': 0.3934594629341785, 'recall': 0.38745023613179236, 'f1-score': 0.3723914169700297, 'support': 81228}, 'weighted avg': {'precision': 0.39577245198095734, 'recall': 0.37929039247550106, 'f1-score': 0.36986100185389337, 'support': 81228}}
[[ 7947 14047  6915]
 [ 4866 14395  5594]
 [ 5530 13467  8467]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0805742
{'0': {'precision': 0.32680577849117176, 'recall': 0.13275952008346376, 'f1-score': 0.18881572846146713, 'support': 7668}, '1': {'precision': 0.4352277956741832, 'recall': 0.6794181034482759, 'f1-score': 0.5305750350631137, 'support': 11136}, '2': {'precision': 0.36736736736736736, 'recall': 0.28638314475224347, 'f1-score': 0.32185924139443106, 'support': 7689}, 'accuracy': 0.40712641075000944, 'macro avg': {'precision': 0.3764669805109075, 'recall': 0.3661869227613277, 'f1-score': 0.347083334973004, 'support': 26493}, 'weighted avg': {'precision': 0.3841517053480427, 'recall': 0.4071264107500095, 'f1-score': 0.3710828635257293, 'support': 26493}}
[[1018 5029 1621]
 [1399 7566 2171]
 [ 698 4789 2202]]
training model: results/LILAK/W0/deepLOB_L2/h200
Epoch 1/50
318/318 - 19s - loss: 3.3515 - accuracy200: 0.3453 - val_loss: 3.3529 - val_accuracy200: 0.3422 - 19s/epoch - 61ms/step
Epoch 2/50
318/318 - 16s - loss: 3.3081 - accuracy200: 0.3573 - val_loss: 3.3822 - val_accuracy200: 0.3381 - 16s/epoch - 50ms/step
Epoch 3/50
318/318 - 16s - loss: 3.2963 - accuracy200: 0.3646 - val_loss: 3.3373 - val_accuracy200: 0.3405 - 16s/epoch - 52ms/step
Epoch 4/50
318/318 - 16s - loss: 3.2818 - accuracy200: 0.3740 - val_loss: 3.3554 - val_accuracy200: 0.3366 - 16s/epoch - 51ms/step
Epoch 5/50
318/318 - 16s - loss: 3.2699 - accuracy200: 0.3787 - val_loss: 3.3464 - val_accuracy200: 0.3463 - 16s/epoch - 51ms/step
Epoch 6/50
318/318 - 16s - loss: 3.2520 - accuracy200: 0.3931 - val_loss: 3.3539 - val_accuracy200: 0.3436 - 16s/epoch - 51ms/step
Epoch 7/50
318/318 - 16s - loss: 3.2416 - accuracy200: 0.4005 - val_loss: 3.3832 - val_accuracy200: 0.3422 - 16s/epoch - 51ms/step
Epoch 8/50
318/318 - 16s - loss: 3.2242 - accuracy200: 0.4106 - val_loss: 3.3807 - val_accuracy200: 0.3411 - 16s/epoch - 51ms/step
Epoch 9/50
318/318 - 16s - loss: 3.2086 - accuracy200: 0.4204 - val_loss: 3.4451 - val_accuracy200: 0.3369 - 16s/epoch - 51ms/step
Epoch 10/50
318/318 - 16s - loss: 3.1979 - accuracy200: 0.4226 - val_loss: 3.4350 - val_accuracy200: 0.3422 - 16s/epoch - 51ms/step
Epoch 11/50
318/318 - 16s - loss: 3.1841 - accuracy200: 0.4302 - val_loss: 3.4547 - val_accuracy200: 0.3383 - 16s/epoch - 52ms/step
Epoch 12/50
318/318 - 16s - loss: 3.1704 - accuracy200: 0.4379 - val_loss: 3.4455 - val_accuracy200: 0.3501 - 16s/epoch - 51ms/step
Epoch 13/50
318/318 - 16s - loss: 3.1667 - accuracy200: 0.4395 - val_loss: 3.4680 - val_accuracy200: 0.3361 - 16s/epoch - 50ms/step
testing model: results/LILAK/W0/deepLOB_L2/h200
Evaluating performance on  test set...
876/876 - 16s - 16s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.112225
{'0': {'precision': 0.31713683739488746, 'recall': 0.238820010951826, 'f1-score': 0.2724622358915213, 'support': 71221}, '1': {'precision': 0.3587723228010998, 'recall': 0.5169018540783396, 'f1-score': 0.42355954701953785, 'support': 79015}, '2': {'precision': 0.33404491805014025, 'recall': 0.2561452400600657, 'f1-score': 0.28995405819295555, 'support': 73919}, 'accuracy': 0.3425576052285249, 'macro avg': {'precision': 0.3366513594153758, 'recall': 0.33728903503007707, 'f1-score': 0.32865861370133825, 'support': 224155}, 'weighted avg': {'precision': 0.33738914625851973, 'recall': 0.3425576052285249, 'f1-score': 0.33149251427692406, 'support': 224155}}
[[17009 36454 17758]
 [18183 40843 19989]
 [18441 36544 18934]]
Evaluating performance on  train set...
318/318 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1075189
{'0': {'precision': 0.3656540130747679, 'recall': 0.24158832710246453, 'f1-score': 0.29094723958561, 'support': 27551}, '1': {'precision': 0.3340089701569777, 'recall': 0.5783735344634456, 'f1-score': 0.4234670165942207, 'support': 26782}, '2': {'precision': 0.3598414319178329, 'recall': 0.22275515895147796, 'f1-score': 0.27516994304611425, 'support': 26895}, 'accuracy': 0.34639533165903386, 'macro avg': {'precision': 0.35316813838319283, 'recall': 0.3475723401724627, 'f1-score': 0.32986139974198164, 'support': 81228}, 'weighted avg': {'precision': 0.35329562791644786, 'recall': 0.34639533165903386, 'f1-score': 0.32941690863341216, 'support': 81228}}
[[ 6656 15647  5248]
 [ 5882 15490  5410]
 [ 5665 15239  5991]]
Evaluating performance on  val set...
104/104 - 3s - 3s/epoch - 24ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1116532
{'0': {'precision': 0.3355743373031118, 'recall': 0.20002289901534234, 'f1-score': 0.2506456241032999, 'support': 8734}, '1': {'precision': 0.35559526468617375, 'recall': 0.5207719986915277, 'f1-score': 0.4226174674807539, 'support': 9171}, '2': {'precision': 0.3331211812627291, 'recall': 0.3047275267815557, 'f1-score': 0.3182923862807103, 'support': 8588}, 'accuracy': 0.3449967916053297, 'macro avg': {'precision': 0.3414302610840049, 'recall': 0.3418408081628086, 'f1-score': 0.33051849262158806, 'support': 26493}, 'weighted avg': {'precision': 0.34170970215251556, 'recall': 0.3449967916053297, 'f1-score': 0.33210503486064075, 'support': 26493}}
[[1747 4426 2561]
 [1717 4776 2678]
 [1742 4229 2617]]
training model: results/LILAK/W0/deepLOB_L2/h300
Epoch 1/50
318/318 - 19s - loss: 3.3379 - accuracy300: 0.3585 - val_loss: 3.3902 - val_accuracy300: 0.3380 - 19s/epoch - 60ms/step
Epoch 2/50
318/318 - 16s - loss: 3.3031 - accuracy300: 0.3722 - val_loss: 3.3653 - val_accuracy300: 0.3441 - 16s/epoch - 52ms/step
Epoch 3/50
318/318 - 16s - loss: 3.2910 - accuracy300: 0.3725 - val_loss: 3.3567 - val_accuracy300: 0.3320 - 16s/epoch - 51ms/step
Epoch 4/50
318/318 - 16s - loss: 3.2640 - accuracy300: 0.3858 - val_loss: 3.3731 - val_accuracy300: 0.3330 - 16s/epoch - 52ms/step
Epoch 5/50
318/318 - 16s - loss: 3.2439 - accuracy300: 0.4008 - val_loss: 3.3736 - val_accuracy300: 0.3525 - 16s/epoch - 49ms/step
Epoch 6/50
318/318 - 16s - loss: 3.2274 - accuracy300: 0.4104 - val_loss: 3.3561 - val_accuracy300: 0.3522 - 16s/epoch - 51ms/step
Epoch 7/50
318/318 - 17s - loss: 3.2184 - accuracy300: 0.4176 - val_loss: 3.3457 - val_accuracy300: 0.3558 - 17s/epoch - 53ms/step
Epoch 8/50
318/318 - 16s - loss: 3.1932 - accuracy300: 0.4298 - val_loss: 3.4009 - val_accuracy300: 0.3486 - 16s/epoch - 50ms/step
Epoch 9/50
318/318 - 16s - loss: 3.1837 - accuracy300: 0.4326 - val_loss: 3.3843 - val_accuracy300: 0.3564 - 16s/epoch - 51ms/step
Epoch 10/50
318/318 - 16s - loss: 3.1696 - accuracy300: 0.4397 - val_loss: 3.4990 - val_accuracy300: 0.3331 - 16s/epoch - 50ms/step
Epoch 11/50
318/318 - 16s - loss: 3.1577 - accuracy300: 0.4445 - val_loss: 3.4886 - val_accuracy300: 0.3365 - 16s/epoch - 49ms/step
Epoch 12/50
318/318 - 16s - loss: 3.1464 - accuracy300: 0.4505 - val_loss: 3.4891 - val_accuracy300: 0.3241 - 16s/epoch - 51ms/step
Epoch 13/50
318/318 - 16s - loss: 3.1339 - accuracy300: 0.4548 - val_loss: 3.4678 - val_accuracy300: 0.3393 - 16s/epoch - 51ms/step
Epoch 14/50
318/318 - 16s - loss: 3.1171 - accuracy300: 0.4636 - val_loss: 3.5316 - val_accuracy300: 0.3365 - 16s/epoch - 50ms/step
Epoch 15/50
318/318 - 16s - loss: 3.1016 - accuracy300: 0.4698 - val_loss: 3.5869 - val_accuracy300: 0.3200 - 16s/epoch - 50ms/step
Epoch 16/50
318/318 - 16s - loss: 3.0837 - accuracy300: 0.4762 - val_loss: 3.5678 - val_accuracy300: 0.3239 - 16s/epoch - 51ms/step
Epoch 17/50
318/318 - 16s - loss: 3.0665 - accuracy300: 0.4826 - val_loss: 3.6206 - val_accuracy300: 0.3287 - 16s/epoch - 50ms/step
testing model: results/LILAK/W0/deepLOB_L2/h300
Evaluating performance on  test set...
876/876 - 16s - 16s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1218992
{'0': {'precision': 0.2698298556942278, 'recall': 0.3442008706467662, 'f1-score': 0.3025114779186708, 'support': 64320}, '1': {'precision': 0.42003446115288223, 'recall': 0.4076024407721874, 'f1-score': 0.4137250796239765, 'support': 92102}, '2': {'precision': 0.32011530219415524, 'recall': 0.2492138248711854, 'f1-score': 0.28024970115553194, 'support': 67733}, 'accuracy': 0.34154937431687893, 'macro avg': {'precision': 0.3366598730137551, 'recall': 0.3336723787633797, 'f1-score': 0.3321620862327264, 'support': 224155}, 'weighted avg': {'precision': 0.3467414959419696, 'recall': 0.34154937431687893, 'f1-score': 0.34148066539503485, 'support': 224155}}
[[22139 25931 16250]
 [34960 37541 19601]
 [24949 25904 16880]]
Evaluating performance on  train set...
318/318 - 7s - 7s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1176888
{'0': {'precision': 0.35778592864288095, 'recall': 0.3836390289248811, 'f1-score': 0.37026173674494034, 'support': 27969}, '1': {'precision': 0.3570085929108486, 'recall': 0.30901836212907724, 'f1-score': 0.3312845217824661, 'support': 25814}, '2': {'precision': 0.3582750744099121, 'recall': 0.3771907451266169, 'f1-score': 0.36748966080335116, 'support': 27445}, 'accuracy': 0.35774609740483576, 'macro avg': {'precision': 0.3576898653212139, 'recall': 0.35661604539352504, 'f1-score': 0.3563453064435858, 'support': 81228}, 'weighted avg': {'precision': 0.35770416448507186, 'recall': 0.35774609740483576, 'f1-score': 0.35693828360983637, 'support': 81228}}
[[10730  6974 10265]
 [ 9560  7977  8277]
 [ 9700  7393 10352]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1114643
{'0': {'precision': 0.31138366277685164, 'recall': 0.3162413834804692, 'f1-score': 0.3137937241255175, 'support': 8269}, '1': {'precision': 0.41825023518344306, 'recall': 0.4428286852589641, 'f1-score': 0.430188679245283, 'support': 10040}, '2': {'precision': 0.31788345612860014, 'recall': 0.2899560117302053, 'f1-score': 0.3032781647389609, 'support': 8184}, 'accuracy': 0.356094062582569, 'macro avg': {'precision': 0.349172451362965, 'recall': 0.34967536015654627, 'f1-score': 0.3490868560365871, 'support': 26493}, 'weighted avg': {'precision': 0.35389053990488123, 'recall': 0.356094062582569, 'f1-score': 0.35465531063451483, 'support': 26493}}
[[2615 3186 2468]
 [2970 4446 2624]
 [2813 2998 2373]]
training model: results/LILAK/W0/deepLOB_L2/h500
Epoch 1/50
318/318 - 19s - loss: 3.3466 - accuracy500: 0.3558 - val_loss: 3.4123 - val_accuracy500: 0.3264 - 19s/epoch - 60ms/step
Epoch 2/50
318/318 - 16s - loss: 3.2968 - accuracy500: 0.3771 - val_loss: 3.4185 - val_accuracy500: 0.3235 - 16s/epoch - 51ms/step
Epoch 3/50
318/318 - 16s - loss: 3.2774 - accuracy500: 0.3753 - val_loss: 3.3842 - val_accuracy500: 0.3219 - 16s/epoch - 51ms/step
Epoch 4/50
318/318 - 16s - loss: 3.2604 - accuracy500: 0.3872 - val_loss: 3.3925 - val_accuracy500: 0.3392 - 16s/epoch - 51ms/step
Epoch 5/50
318/318 - 17s - loss: 3.2455 - accuracy500: 0.3989 - val_loss: 3.4153 - val_accuracy500: 0.3223 - 17s/epoch - 53ms/step
Epoch 6/50
318/318 - 16s - loss: 3.2349 - accuracy500: 0.4056 - val_loss: 3.4000 - val_accuracy500: 0.3336 - 16s/epoch - 51ms/step
Epoch 7/50
318/318 - 16s - loss: 3.2175 - accuracy500: 0.4159 - val_loss: 3.5885 - val_accuracy500: 0.3296 - 16s/epoch - 51ms/step
Epoch 8/50
318/318 - 17s - loss: 3.2082 - accuracy500: 0.4213 - val_loss: 3.4618 - val_accuracy500: 0.3302 - 17s/epoch - 52ms/step
Epoch 9/50
318/318 - 16s - loss: 3.2043 - accuracy500: 0.4226 - val_loss: 3.3796 - val_accuracy500: 0.3284 - 16s/epoch - 51ms/step
Epoch 10/50
318/318 - 16s - loss: 3.1830 - accuracy500: 0.4329 - val_loss: 3.5357 - val_accuracy500: 0.3398 - 16s/epoch - 51ms/step
Epoch 11/50
318/318 - 16s - loss: 3.1725 - accuracy500: 0.4404 - val_loss: 3.5017 - val_accuracy500: 0.3345 - 16s/epoch - 50ms/step
Epoch 12/50
318/318 - 17s - loss: 3.1490 - accuracy500: 0.4492 - val_loss: 3.4286 - val_accuracy500: 0.3381 - 17s/epoch - 52ms/step
Epoch 13/50
318/318 - 16s - loss: 3.1384 - accuracy500: 0.4524 - val_loss: 3.5074 - val_accuracy500: 0.3270 - 16s/epoch - 51ms/step
Epoch 14/50
318/318 - 17s - loss: 3.1054 - accuracy500: 0.4655 - val_loss: 3.4842 - val_accuracy500: 0.3258 - 17s/epoch - 52ms/step
Epoch 15/50
318/318 - 16s - loss: 3.0835 - accuracy500: 0.4756 - val_loss: 3.4697 - val_accuracy500: 0.3361 - 16s/epoch - 52ms/step
Epoch 16/50
318/318 - 16s - loss: 3.0671 - accuracy500: 0.4802 - val_loss: 3.4477 - val_accuracy500: 0.3340 - 16s/epoch - 50ms/step
Epoch 17/50
318/318 - 16s - loss: 3.0628 - accuracy500: 0.4828 - val_loss: 3.5098 - val_accuracy500: 0.3388 - 16s/epoch - 51ms/step
Epoch 18/50
318/318 - 16s - loss: 3.0421 - accuracy500: 0.4877 - val_loss: 3.5026 - val_accuracy500: 0.3364 - 16s/epoch - 51ms/step
Epoch 19/50
318/318 - 17s - loss: 3.0204 - accuracy500: 0.4911 - val_loss: 3.7815 - val_accuracy500: 0.3348 - 17s/epoch - 52ms/step
testing model: results/LILAK/W0/deepLOB_L2/h500
Evaluating performance on  test set...
876/876 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1419765
{'0': {'precision': 0.3027925419724964, 'recall': 0.6266350448864381, 'f1-score': 0.40829521484606446, 'support': 68729}, '1': {'precision': 0.3676038815625778, 'recall': 0.27810754847210895, 'f1-score': 0.31665356862184757, 'support': 79685}, '2': {'precision': 0.3052602385134511, 'recall': 0.08719187758281512, 'f1-score': 0.1356405648267009, 'support': 75741}, 'accuracy': 0.32046128794807166, 'macro avg': {'precision': 0.3252188873495084, 'recall': 0.3306448236471207, 'f1-score': 0.2868631160982043, 'support': 224155}, 'weighted avg': {'precision': 0.32666618922080265, 'recall': 0.32046128794807166, 'f1-score': 0.2835886482894704, 'support': 224155}}
[[43068 17146  8515]
 [51009 22161  6515]
 [48159 20978  6604]]
Evaluating performance on  train set...
318/318 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1366792
{'0': {'precision': 0.3506497431248111, 'recall': 0.4212379742239971, 'f1-score': 0.38271625298919765, 'support': 27545}, '1': {'precision': 0.3328773369813042, 'recall': 0.30361464004839683, 'f1-score': 0.3175733127681873, 'support': 26448}, '2': {'precision': 0.36252342286071204, 'recall': 0.3196621993758032, 'f1-score': 0.33974634146341465, 'support': 27235}, 'accuracy': 0.34888215886147633, 'macro avg': {'precision': 0.34868350098894246, 'recall': 0.34817160454939905, 'f1-score': 0.34667863574026647, 'support': 81228}, 'weighted avg': {'precision': 0.34884414739333663, 'recall': 0.34888215886147633, 'f1-score': 0.34709816534245047, 'support': 81228}}
[[11603  8161  7781]
 [10890  8030  7528]
 [10597  7932  8706]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1249896
{'0': {'precision': 0.33744528452049344, 'recall': 0.5664662658650634, 'f1-score': 0.4229426433915212, 'support': 8982}, '1': {'precision': 0.31354998622968877, 'recall': 0.2662223781129428, 'f1-score': 0.2879544736010117, 'support': 8553}, '2': {'precision': 0.34168071273777995, 'recall': 0.15840589417280643, 'f1-score': 0.21645946152086035, 'support': 8958}, 'accuracy': 0.3315592798097611, 'macro avg': {'precision': 0.3308919944959874, 'recall': 0.3303648460502709, 'f1-score': 0.30911885950446444, 'support': 26493}, 'weighted avg': {'precision': 0.3311630393874092, 'recall': 0.3315592798097611, 'f1-score': 0.3095455136057058, 'support': 26493}}
[[5088 2345 1549]
 [5091 2277 1185]
 [4899 2640 1419]]
training model: results/LILAK/W0/deepLOB_L2/h1000
Epoch 1/50
318/318 - 20s - loss: 3.3500 - accuracy1000: 0.3622 - val_loss: 3.4709 - val_accuracy1000: 0.3222 - 20s/epoch - 64ms/step
Epoch 2/50
318/318 - 17s - loss: 3.3065 - accuracy1000: 0.3604 - val_loss: 3.4977 - val_accuracy1000: 0.3277 - 17s/epoch - 52ms/step
Epoch 3/50
318/318 - 16s - loss: 3.2646 - accuracy1000: 0.3796 - val_loss: 3.4218 - val_accuracy1000: 0.3299 - 16s/epoch - 51ms/step
Epoch 4/50
318/318 - 16s - loss: 3.2310 - accuracy1000: 0.4022 - val_loss: 3.4814 - val_accuracy1000: 0.3198 - 16s/epoch - 52ms/step
Epoch 5/50
318/318 - 16s - loss: 3.2019 - accuracy1000: 0.4219 - val_loss: 3.4392 - val_accuracy1000: 0.3313 - 16s/epoch - 50ms/step
Epoch 6/50
318/318 - 16s - loss: 3.1807 - accuracy1000: 0.4323 - val_loss: 3.4541 - val_accuracy1000: 0.3315 - 16s/epoch - 51ms/step
Epoch 7/50
318/318 - 16s - loss: 3.1601 - accuracy1000: 0.4441 - val_loss: 3.4393 - val_accuracy1000: 0.3191 - 16s/epoch - 51ms/step
Epoch 8/50
318/318 - 17s - loss: 3.1341 - accuracy1000: 0.4532 - val_loss: 3.5718 - val_accuracy1000: 0.3169 - 17s/epoch - 53ms/step
Epoch 9/50
318/318 - 16s - loss: 3.1187 - accuracy1000: 0.4574 - val_loss: 3.6402 - val_accuracy1000: 0.3137 - 16s/epoch - 51ms/step
Epoch 10/50
318/318 - 16s - loss: 3.0861 - accuracy1000: 0.4678 - val_loss: 3.7782 - val_accuracy1000: 0.3154 - 16s/epoch - 51ms/step
Epoch 11/50
318/318 - 16s - loss: 3.0573 - accuracy1000: 0.4802 - val_loss: 3.6661 - val_accuracy1000: 0.3250 - 16s/epoch - 50ms/step
Epoch 12/50
318/318 - 16s - loss: 3.0289 - accuracy1000: 0.4890 - val_loss: 3.9609 - val_accuracy1000: 0.3165 - 16s/epoch - 51ms/step
Epoch 13/50
318/318 - 16s - loss: 2.9984 - accuracy1000: 0.4967 - val_loss: 3.8466 - val_accuracy1000: 0.3215 - 16s/epoch - 52ms/step
testing model: results/LILAK/W0/deepLOB_L2/h1000
Evaluating performance on  test set...
876/876 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.13881
{'0': {'precision': 0.2943620072534193, 'recall': 0.7188255213232421, 'f1-score': 0.417681657844617, 'support': 69103}, '1': {'precision': 0.3882260484389512, 'recall': 0.06987270155586987, 'f1-score': 0.11843037257401899, 'support': 77770}, '2': {'precision': 0.33400144892538036, 'recall': 0.17896793561243238, 'f1-score': 0.2330569878340579, 'support': 77282}, 'accuracy': 0.30754611764181033, 'macro avg': {'precision': 0.33886316820591694, 'recall': 0.3225553861638481, 'f1-score': 0.25638967275089797, 'support': 224155}, 'weighted avg': {'precision': 0.3405943991888716, 'recall': 0.30754611764181033, 'f1-score': 0.2502040811532631, 'support': 224155}}
[[49673  3977 15453]
 [60210  5434 12126]
 [58865  4586 13831]]
Evaluating performance on  train set...
318/318 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1214913
{'0': {'precision': 0.3294811371510965, 'recall': 0.5633854645814167, 'f1-score': 0.41579533418429704, 'support': 27175}, '1': {'precision': 0.35327912321018207, 'recall': 0.1460144662818733, 'f1-score': 0.20662737799834574, 'support': 27374}, '2': {'precision': 0.3697701198447563, 'recall': 0.32497469920161925, 'f1-score': 0.3459282607828273, 'support': 26679}, 'accuracy': 0.3444255675382873, 'macro avg': {'precision': 0.3508434600686783, 'recall': 0.34479154335496975, 'f1-score': 0.32278365765515665, 'support': 81228}, 'weighted avg': {'precision': 0.3507338559139068, 'recall': 0.3444255675382873, 'f1-score': 0.3223577599006505, 'support': 81228}}
[[15310  3938  7927]
 [16527  3997  6850]
 [14630  3379  8670]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.140781
{'0': {'precision': 0.3371694679370517, 'recall': 0.700044454323183, 'f1-score': 0.45513005780346816, 'support': 8998}, '1': {'precision': 0.2865884752677206, 'recall': 0.0694770676226975, 'f1-score': 0.1118407960199005, 'support': 8089}, '2': {'precision': 0.3188034188034188, 'recall': 0.19827769508824156, 'f1-score': 0.24449396958573677, 'support': 9406}, 'accuracy': 0.3293700222700336, 'macro avg': {'precision': 0.314187120669397, 'recall': 0.322599739011374, 'f1-score': 0.2704882744697018, 'support': 26493}, 'weighted avg': {'precision': 0.31520514876394296, 'recall': 0.3293700222700336, 'f1-score': 0.27553130023191114, 'support': 26493}}
[[6299  641 2058]
 [5600  562 1927]
 [6783  758 1865]]
training model: results/LILAK/W0/deepOF_L2/h10
Epoch 1/50
318/318 - 13s - loss: 3.3191 - accuracy10: 0.3677 - val_loss: 3.2001 - val_accuracy10: 0.4933 - 13s/epoch - 41ms/step
Epoch 2/50
318/318 - 11s - loss: 3.2635 - accuracy10: 0.4054 - val_loss: 3.1722 - val_accuracy10: 0.4981 - 11s/epoch - 34ms/step
Epoch 3/50
318/318 - 10s - loss: 3.2271 - accuracy10: 0.4217 - val_loss: 3.1486 - val_accuracy10: 0.5003 - 10s/epoch - 33ms/step
Epoch 4/50
318/318 - 10s - loss: 3.2012 - accuracy10: 0.4349 - val_loss: 3.1319 - val_accuracy10: 0.5064 - 10s/epoch - 33ms/step
Epoch 5/50
318/318 - 11s - loss: 3.1802 - accuracy10: 0.4445 - val_loss: 3.1182 - val_accuracy10: 0.5051 - 11s/epoch - 33ms/step
Epoch 6/50
318/318 - 11s - loss: 3.1580 - accuracy10: 0.4544 - val_loss: 3.0956 - val_accuracy10: 0.5068 - 11s/epoch - 34ms/step
Epoch 7/50
318/318 - 10s - loss: 3.1420 - accuracy10: 0.4589 - val_loss: 3.0859 - val_accuracy10: 0.5083 - 10s/epoch - 33ms/step
Epoch 8/50
318/318 - 11s - loss: 3.1257 - accuracy10: 0.4632 - val_loss: 3.0825 - val_accuracy10: 0.5052 - 11s/epoch - 34ms/step
Epoch 9/50
318/318 - 11s - loss: 3.1128 - accuracy10: 0.4668 - val_loss: 3.0734 - val_accuracy10: 0.5006 - 11s/epoch - 34ms/step
Epoch 10/50
318/318 - 11s - loss: 3.0979 - accuracy10: 0.4724 - val_loss: 3.0699 - val_accuracy10: 0.5073 - 11s/epoch - 34ms/step
Epoch 11/50
318/318 - 11s - loss: 3.0833 - accuracy10: 0.4754 - val_loss: 3.0628 - val_accuracy10: 0.5084 - 11s/epoch - 34ms/step
Epoch 12/50
318/318 - 11s - loss: 3.0728 - accuracy10: 0.4780 - val_loss: 3.0622 - val_accuracy10: 0.5089 - 11s/epoch - 34ms/step
Epoch 13/50
318/318 - 11s - loss: 3.0596 - accuracy10: 0.4808 - val_loss: 3.0604 - val_accuracy10: 0.5048 - 11s/epoch - 34ms/step
Epoch 14/50
318/318 - 11s - loss: 3.0451 - accuracy10: 0.4847 - val_loss: 3.0634 - val_accuracy10: 0.5021 - 11s/epoch - 34ms/step
Epoch 15/50
318/318 - 11s - loss: 3.0336 - accuracy10: 0.4869 - val_loss: 3.0724 - val_accuracy10: 0.5019 - 11s/epoch - 34ms/step
Epoch 16/50
318/318 - 10s - loss: 3.0242 - accuracy10: 0.4880 - val_loss: 3.0636 - val_accuracy10: 0.4938 - 10s/epoch - 33ms/step
Epoch 17/50
318/318 - 11s - loss: 3.0107 - accuracy10: 0.4903 - val_loss: 3.0711 - val_accuracy10: 0.4975 - 11s/epoch - 34ms/step
Epoch 18/50
318/318 - 11s - loss: 2.9945 - accuracy10: 0.4939 - val_loss: 3.0754 - val_accuracy10: 0.4922 - 11s/epoch - 33ms/step
Epoch 19/50
318/318 - 11s - loss: 2.9832 - accuracy10: 0.4954 - val_loss: 3.0861 - val_accuracy10: 0.4859 - 11s/epoch - 34ms/step
Epoch 20/50
318/318 - 11s - loss: 2.9709 - accuracy10: 0.5002 - val_loss: 3.0948 - val_accuracy10: 0.4855 - 11s/epoch - 34ms/step
Epoch 21/50
318/318 - 11s - loss: 2.9590 - accuracy10: 0.5004 - val_loss: 3.1040 - val_accuracy10: 0.4863 - 11s/epoch - 34ms/step
Epoch 22/50
318/318 - 11s - loss: 2.9398 - accuracy10: 0.5036 - val_loss: 3.1073 - val_accuracy10: 0.4868 - 11s/epoch - 33ms/step
Epoch 23/50
318/318 - 11s - loss: 2.9313 - accuracy10: 0.5070 - val_loss: 3.1085 - val_accuracy10: 0.4932 - 11s/epoch - 34ms/step
testing model: results/LILAK/W0/deepOF_L2/h10
Evaluating performance on  test set...
876/876 - 17s - 17s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96693516
{'0': {'precision': 0.3579698469329037, 'recall': 0.34718935571728354, 'f1-score': 0.3524971951178051, 'support': 44794}, '1': {'precision': 0.7235075475991808, 'recall': 0.644217636022514, 'f1-score': 0.6815642901662188, 'support': 133250}, '2': {'precision': 0.3501563053917303, 'recall': 0.4713052531123932, 'f1-score': 0.4017972708109907, 'support': 46106}, 'accuracy': 0.5492928842293108, 'macro avg': {'precision': 0.4772112333079382, 'recall': 0.4875707482840636, 'f1-score': 0.4786195853650049, 'support': 224150}, 'weighted avg': {'precision': 0.573663121380747, 'recall': 0.5492928842293108, 'f1-score': 0.5582577113128135, 'support': 224150}}
[[15552 16606 12636]
 [19716 85842 27692]
 [ 8177 16199 21730]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0020154
{'0': {'precision': 0.42525895157474103, 'recall': 0.3803611738148984, 'f1-score': 0.401558970285232, 'support': 21264}, '1': {'precision': 0.600868463904469, 'recall': 0.5936263118919333, 'f1-score': 0.5972254335260115, 'support': 39161}, '2': {'precision': 0.4164221626908194, 'recall': 0.4708173076923077, 'f1-score': 0.44195229821513193, 'support': 20800}, 'accuracy': 0.506346568174823, 'macro avg': {'precision': 0.48084985939000974, 'recall': 0.48160159779971307, 'f1-score': 0.48024556734212515, 'support': 81225}, 'weighted avg': {'precision': 0.5076626315200646, 'recall': 0.506346568174823, 'f1-score': 0.5062394946055039, 'support': 81225}}
[[ 8088  8129  5047]
 [ 7237 23247  8677]
 [ 3694  7313  9793]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.011389
{'0': {'precision': 0.3549056603773585, 'recall': 0.30595315549772284, 'f1-score': 0.32861635220125784, 'support': 6148}, '1': {'precision': 0.6277483491764023, 'recall': 0.6294841009968711, 'f1-score': 0.6286150268856271, 'support': 13743}, '2': {'precision': 0.37155963302752293, 'recall': 0.41714631929718266, 'f1-score': 0.3930355358926788, 'support': 6602}, 'accuracy': 0.5014909598761937, 'macro avg': {'precision': 0.45140454752709464, 'recall': 0.4508611919305922, 'f1-score': 0.45008897165985456, 'support': 26493}, 'weighted avg': {'precision': 0.5005904299240932, 'recall': 0.5014909598761937, 'f1-score': 0.5002910299243564, 'support': 26493}}
[[1881 2509 1758]
 [2192 8651 2900]
 [1227 2621 2754]]
training model: results/LILAK/W0/deepOF_L2/h20
Epoch 1/50
318/318 - 13s - loss: 3.3276 - accuracy20: 0.3537 - val_loss: 3.2577 - val_accuracy20: 0.4165 - 13s/epoch - 42ms/step
Epoch 2/50
318/318 - 11s - loss: 3.2827 - accuracy20: 0.3789 - val_loss: 3.2410 - val_accuracy20: 0.4228 - 11s/epoch - 35ms/step
Epoch 3/50
318/318 - 11s - loss: 3.2564 - accuracy20: 0.3963 - val_loss: 3.2256 - val_accuracy20: 0.4301 - 11s/epoch - 34ms/step
Epoch 4/50
318/318 - 11s - loss: 3.2367 - accuracy20: 0.4064 - val_loss: 3.2105 - val_accuracy20: 0.4328 - 11s/epoch - 34ms/step
Epoch 5/50
318/318 - 11s - loss: 3.2238 - accuracy20: 0.4170 - val_loss: 3.1995 - val_accuracy20: 0.4380 - 11s/epoch - 34ms/step
Epoch 6/50
318/318 - 10s - loss: 3.2060 - accuracy20: 0.4249 - val_loss: 3.1895 - val_accuracy20: 0.4418 - 10s/epoch - 33ms/step
Epoch 7/50
318/318 - 11s - loss: 3.1943 - accuracy20: 0.4304 - val_loss: 3.1818 - val_accuracy20: 0.4430 - 11s/epoch - 34ms/step
Epoch 8/50
318/318 - 11s - loss: 3.1816 - accuracy20: 0.4355 - val_loss: 3.1804 - val_accuracy20: 0.4458 - 11s/epoch - 34ms/step
Epoch 9/50
318/318 - 11s - loss: 3.1692 - accuracy20: 0.4421 - val_loss: 3.1768 - val_accuracy20: 0.4450 - 11s/epoch - 34ms/step
Epoch 10/50
318/318 - 11s - loss: 3.1555 - accuracy20: 0.4475 - val_loss: 3.1714 - val_accuracy20: 0.4492 - 11s/epoch - 34ms/step
Epoch 11/50
318/318 - 11s - loss: 3.1463 - accuracy20: 0.4520 - val_loss: 3.1689 - val_accuracy20: 0.4518 - 11s/epoch - 34ms/step
Epoch 12/50
318/318 - 11s - loss: 3.1376 - accuracy20: 0.4552 - val_loss: 3.1684 - val_accuracy20: 0.4466 - 11s/epoch - 34ms/step
Epoch 13/50
318/318 - 11s - loss: 3.1245 - accuracy20: 0.4594 - val_loss: 3.1717 - val_accuracy20: 0.4476 - 11s/epoch - 34ms/step
Epoch 14/50
318/318 - 11s - loss: 3.1147 - accuracy20: 0.4634 - val_loss: 3.1681 - val_accuracy20: 0.4531 - 11s/epoch - 34ms/step
Epoch 15/50
318/318 - 11s - loss: 3.1040 - accuracy20: 0.4674 - val_loss: 3.1720 - val_accuracy20: 0.4495 - 11s/epoch - 34ms/step
Epoch 16/50
318/318 - 11s - loss: 3.0930 - accuracy20: 0.4729 - val_loss: 3.1733 - val_accuracy20: 0.4482 - 11s/epoch - 33ms/step
Epoch 17/50
318/318 - 11s - loss: 3.0806 - accuracy20: 0.4766 - val_loss: 3.1766 - val_accuracy20: 0.4477 - 11s/epoch - 33ms/step
Epoch 18/50
318/318 - 11s - loss: 3.0722 - accuracy20: 0.4779 - val_loss: 3.1788 - val_accuracy20: 0.4477 - 11s/epoch - 34ms/step
Epoch 19/50
318/318 - 11s - loss: 3.0579 - accuracy20: 0.4831 - val_loss: 3.1832 - val_accuracy20: 0.4517 - 11s/epoch - 34ms/step
Epoch 20/50
318/318 - 11s - loss: 3.0457 - accuracy20: 0.4867 - val_loss: 3.1964 - val_accuracy20: 0.4450 - 11s/epoch - 35ms/step
Epoch 21/50
318/318 - 11s - loss: 3.0357 - accuracy20: 0.4892 - val_loss: 3.1978 - val_accuracy20: 0.4469 - 11s/epoch - 34ms/step
Epoch 22/50
318/318 - 11s - loss: 3.0225 - accuracy20: 0.4931 - val_loss: 3.1983 - val_accuracy20: 0.4427 - 11s/epoch - 34ms/step
Epoch 23/50
318/318 - 10s - loss: 3.0092 - accuracy20: 0.4973 - val_loss: 3.2068 - val_accuracy20: 0.4449 - 10s/epoch - 33ms/step
Epoch 24/50
318/318 - 10s - loss: 2.9984 - accuracy20: 0.5005 - val_loss: 3.2160 - val_accuracy20: 0.4424 - 10s/epoch - 33ms/step
testing model: results/LILAK/W0/deepOF_L2/h20
Evaluating performance on  test set...
876/876 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0129807
{'0': {'precision': 0.3762976381244339, 'recall': 0.2920196085499045, 'f1-score': 0.3288446902430362, 'support': 55486}, '1': {'precision': 0.6129513125647439, 'recall': 0.6515550303486061, 'f1-score': 0.631663911056722, 'support': 111702}, '2': {'precision': 0.3865509830965135, 'recall': 0.4231417436185527, 'f1-score': 0.4040195782627644, 'support': 56962}, 'accuracy': 0.5045103725184028, 'macro avg': {'precision': 0.4585999779285637, 'recall': 0.4555721275056877, 'f1-score': 0.45484272652084085, 'support': 224150}, 'weighted avg': {'precision': 0.4968362942860716, 'recall': 0.5045103725184028, 'f1-score': 0.49885416860444637, 'support': 224150}}
[[16203 23784 15499]
 [16170 72780 22752]
 [10686 22173 24103]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0354943
{'0': {'precision': 0.4737407944955115, 'recall': 0.3396539098932439, 'f1-score': 0.395645342312009, 'support': 25947}, '1': {'precision': 0.46952076677316296, 'recall': 0.6130485566494244, 'f1-score': 0.5317701548704589, 'support': 29965}, '2': {'precision': 0.46176107588202747, 'recall': 0.4286335084739067, 'f1-score': 0.44458102847777087, 'support': 25313}, 'accuracy': 0.46824253616497385, 'macro avg': {'precision': 0.46834087905023397, 'recall': 0.460445325005525, 'f1-score': 0.4573321752200796, 'support': 81225}, 'weighted avg': {'precision': 0.46845060369263924, 'recall': 0.46824253616497385, 'f1-score': 0.461113966900841, 'support': 81225}}
[[ 8813 10950  6184]
 [ 5132 18370  6463]
 [ 4658  9805 10850]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.055558
{'0': {'precision': 0.3981290926099158, 'recall': 0.28230299814274346, 'f1-score': 0.33035783590778545, 'support': 7538}, '1': {'precision': 0.49807202619134233, 'recall': 0.6281886584694439, 'f1-score': 0.5556141703526356, 'support': 10898}, '2': {'precision': 0.4057814399567743, 'recall': 0.37284349013280377, 'f1-score': 0.38861578266494184, 'support': 8057}, 'accuracy': 0.4521194277733741, 'macro avg': {'precision': 0.4339941862526775, 'recall': 0.42777838224833037, 'f1-score': 0.4248625963084543, 'support': 26493}, 'weighted avg': {'precision': 0.4415682294665958, 'recall': 0.4521194277733741, 'f1-score': 0.44073521143348604, 'support': 26493}}
[[2128 3393 2017]
 [1670 6846 2382]
 [1547 3506 3004]]
training model: results/LILAK/W0/deepOF_L2/h30
Epoch 1/50
318/318 - 13s - loss: 3.3324 - accuracy30: 0.3486 - val_loss: 3.2953 - val_accuracy30: 0.3798 - 13s/epoch - 42ms/step
Epoch 2/50
318/318 - 11s - loss: 3.2915 - accuracy30: 0.3665 - val_loss: 3.2754 - val_accuracy30: 0.3878 - 11s/epoch - 33ms/step
Epoch 3/50
318/318 - 11s - loss: 3.2713 - accuracy30: 0.3820 - val_loss: 3.2613 - val_accuracy30: 0.3949 - 11s/epoch - 34ms/step
Epoch 4/50
318/318 - 11s - loss: 3.2566 - accuracy30: 0.3939 - val_loss: 3.2585 - val_accuracy30: 0.3982 - 11s/epoch - 34ms/step
Epoch 5/50
318/318 - 11s - loss: 3.2482 - accuracy30: 0.3992 - val_loss: 3.2484 - val_accuracy30: 0.4037 - 11s/epoch - 34ms/step
Epoch 6/50
318/318 - 11s - loss: 3.2352 - accuracy30: 0.4042 - val_loss: 3.2419 - val_accuracy30: 0.4015 - 11s/epoch - 35ms/step
Epoch 7/50
318/318 - 11s - loss: 3.2262 - accuracy30: 0.4106 - val_loss: 3.2413 - val_accuracy30: 0.4080 - 11s/epoch - 34ms/step
Epoch 8/50
318/318 - 11s - loss: 3.2157 - accuracy30: 0.4182 - val_loss: 3.2395 - val_accuracy30: 0.4080 - 11s/epoch - 34ms/step
Epoch 9/50
318/318 - 11s - loss: 3.2059 - accuracy30: 0.4226 - val_loss: 3.2392 - val_accuracy30: 0.4082 - 11s/epoch - 34ms/step
Epoch 10/50
318/318 - 11s - loss: 3.1941 - accuracy30: 0.4271 - val_loss: 3.2364 - val_accuracy30: 0.4117 - 11s/epoch - 34ms/step
Epoch 11/50
318/318 - 11s - loss: 3.1843 - accuracy30: 0.4330 - val_loss: 3.2380 - val_accuracy30: 0.4170 - 11s/epoch - 34ms/step
Epoch 12/50
318/318 - 10s - loss: 3.1767 - accuracy30: 0.4367 - val_loss: 3.2384 - val_accuracy30: 0.4126 - 10s/epoch - 32ms/step
Epoch 13/50
318/318 - 11s - loss: 3.1678 - accuracy30: 0.4399 - val_loss: 3.2394 - val_accuracy30: 0.4130 - 11s/epoch - 34ms/step
Epoch 14/50
318/318 - 11s - loss: 3.1577 - accuracy30: 0.4432 - val_loss: 3.2380 - val_accuracy30: 0.4170 - 11s/epoch - 34ms/step
Epoch 15/50
318/318 - 10s - loss: 3.1476 - accuracy30: 0.4508 - val_loss: 3.2415 - val_accuracy30: 0.4150 - 10s/epoch - 33ms/step
Epoch 16/50
318/318 - 10s - loss: 3.1386 - accuracy30: 0.4534 - val_loss: 3.2386 - val_accuracy30: 0.4173 - 10s/epoch - 33ms/step
Epoch 17/50
318/318 - 11s - loss: 3.1292 - accuracy30: 0.4557 - val_loss: 3.2399 - val_accuracy30: 0.4194 - 11s/epoch - 34ms/step
Epoch 18/50
318/318 - 10s - loss: 3.1175 - accuracy30: 0.4603 - val_loss: 3.2478 - val_accuracy30: 0.4177 - 10s/epoch - 32ms/step
Epoch 19/50
318/318 - 10s - loss: 3.1084 - accuracy30: 0.4655 - val_loss: 3.2459 - val_accuracy30: 0.4203 - 10s/epoch - 33ms/step
Epoch 20/50
318/318 - 11s - loss: 3.0941 - accuracy30: 0.4703 - val_loss: 3.2592 - val_accuracy30: 0.4189 - 11s/epoch - 33ms/step
testing model: results/LILAK/W0/deepOF_L2/h30
Evaluating performance on  test set...
876/876 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0404978
{'0': {'precision': 0.3664418000502807, 'recall': 0.29676445138193724, 'f1-score': 0.3279429273185777, 'support': 58939}, '1': {'precision': 0.5482671426446527, 'recall': 0.6675944902530861, 'f1-score': 0.602075291649831, 'support': 104905}, '2': {'precision': 0.39146689673589286, 'recall': 0.316005040957782, 'f1-score': 0.349711433473717, 'support': 60306}, 'accuracy': 0.47549408877983496, 'macro avg': {'precision': 0.43539194647694207, 'recall': 0.42678799419760177, 'f1-score': 0.42657655081404194, 'support': 224150}, 'weighted avg': {'precision': 0.45827116005735236, 'recall': 0.47549408877983496, 'f1-score': 0.46209696351024376, 'support': 224150}}
[[17491 28847 12601]
 [17848 70034 17023]
 [12393 28856 19057]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0673002
{'0': {'precision': 0.46027774941284594, 'recall': 0.3261105484010997, 'f1-score': 0.38174888841837823, 'support': 27644}, '1': {'precision': 0.3911883124352928, 'recall': 0.6379155098671869, 'f1-score': 0.48497554157931516, 'support': 26654}, '2': {'precision': 0.46175855617915706, 'recall': 0.31165744420098784, 'f1-score': 0.3721425245559965, 'support': 26927}, 'accuracy': 0.42363804247460757, 'macro avg': {'precision': 0.43774153934243193, 'recall': 0.42522783415642484, 'f1-score': 0.41295565151789665, 'support': 81225}, 'weighted avg': {'precision': 0.43809694092527135, 'recall': 0.42363804247460757, 'f1-score': 0.41243811776438327, 'support': 81225}}
[[ 9015 13450  5179]
 [ 5048 17003  4603]
 [ 5523 13012  8392]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0790249
{'0': {'precision': 0.3879546343371138, 'recall': 0.24676616915422886, 'f1-score': 0.30165729055800516, 'support': 8040}, '1': {'precision': 0.41989053364846374, 'recall': 0.6714072600696172, 'f1-score': 0.5166647533769563, 'support': 10055}, '2': {'precision': 0.40332012827768343, 'recall': 0.25458442486306265, 'f1-score': 0.31213957223154976, 'support': 8398}, 'accuracy': 0.41041029705960064, 'macro avg': {'precision': 0.403721765421087, 'recall': 0.3909192846956362, 'f1-score': 0.37682053872217036, 'support': 26493}, 'weighted avg': {'precision': 0.40494609946709254, 'recall': 0.41041029705960064, 'f1-score': 0.38658275162843814, 'support': 26493}}
[[1984 4559 1497]
 [1638 6751 1666]
 [1492 4768 2138]]
training model: results/LILAK/W0/deepOF_L2/h50
Epoch 1/50
318/318 - 13s - loss: 3.3371 - accuracy50: 0.3433 - val_loss: 3.3058 - val_accuracy50: 0.3636 - 13s/epoch - 42ms/step
Epoch 2/50
318/318 - 11s - loss: 3.3051 - accuracy50: 0.3577 - val_loss: 3.2929 - val_accuracy50: 0.3709 - 11s/epoch - 34ms/step
Epoch 3/50
318/318 - 11s - loss: 3.2871 - accuracy50: 0.3690 - val_loss: 3.2822 - val_accuracy50: 0.3738 - 11s/epoch - 34ms/step
Epoch 4/50
318/318 - 11s - loss: 3.2757 - accuracy50: 0.3732 - val_loss: 3.2811 - val_accuracy50: 0.3755 - 11s/epoch - 34ms/step
Epoch 5/50
318/318 - 11s - loss: 3.2699 - accuracy50: 0.3783 - val_loss: 3.2744 - val_accuracy50: 0.3750 - 11s/epoch - 33ms/step
Epoch 6/50
318/318 - 11s - loss: 3.2601 - accuracy50: 0.3858 - val_loss: 3.2716 - val_accuracy50: 0.3783 - 11s/epoch - 34ms/step
Epoch 7/50
318/318 - 11s - loss: 3.2520 - accuracy50: 0.3922 - val_loss: 3.2719 - val_accuracy50: 0.3794 - 11s/epoch - 34ms/step
Epoch 8/50
318/318 - 11s - loss: 3.2451 - accuracy50: 0.3972 - val_loss: 3.2724 - val_accuracy50: 0.3806 - 11s/epoch - 34ms/step
Epoch 9/50
318/318 - 11s - loss: 3.2371 - accuracy50: 0.4023 - val_loss: 3.2711 - val_accuracy50: 0.3818 - 11s/epoch - 35ms/step
Epoch 10/50
318/318 - 11s - loss: 3.2296 - accuracy50: 0.4051 - val_loss: 3.2707 - val_accuracy50: 0.3819 - 11s/epoch - 34ms/step
Epoch 11/50
318/318 - 11s - loss: 3.2237 - accuracy50: 0.4102 - val_loss: 3.2735 - val_accuracy50: 0.3841 - 11s/epoch - 34ms/step
Epoch 12/50
318/318 - 11s - loss: 3.2184 - accuracy50: 0.4108 - val_loss: 3.2718 - val_accuracy50: 0.3866 - 11s/epoch - 33ms/step
Epoch 13/50
318/318 - 11s - loss: 3.2107 - accuracy50: 0.4165 - val_loss: 3.2751 - val_accuracy50: 0.3824 - 11s/epoch - 34ms/step
Epoch 14/50
318/318 - 10s - loss: 3.2003 - accuracy50: 0.4218 - val_loss: 3.2715 - val_accuracy50: 0.3881 - 10s/epoch - 32ms/step
Epoch 15/50
318/318 - 11s - loss: 3.1951 - accuracy50: 0.4244 - val_loss: 3.2806 - val_accuracy50: 0.3864 - 11s/epoch - 33ms/step
Epoch 16/50
318/318 - 11s - loss: 3.1850 - accuracy50: 0.4310 - val_loss: 3.2808 - val_accuracy50: 0.3831 - 11s/epoch - 34ms/step
Epoch 17/50
318/318 - 10s - loss: 3.1759 - accuracy50: 0.4335 - val_loss: 3.2851 - val_accuracy50: 0.3862 - 10s/epoch - 33ms/step
Epoch 18/50
318/318 - 11s - loss: 3.1657 - accuracy50: 0.4395 - val_loss: 3.2859 - val_accuracy50: 0.3848 - 11s/epoch - 33ms/step
Epoch 19/50
318/318 - 11s - loss: 3.1605 - accuracy50: 0.4425 - val_loss: 3.2882 - val_accuracy50: 0.3847 - 11s/epoch - 34ms/step
Epoch 20/50
318/318 - 10s - loss: 3.1491 - accuracy50: 0.4467 - val_loss: 3.2943 - val_accuracy50: 0.3893 - 10s/epoch - 33ms/step
testing model: results/LILAK/W0/deepOF_L2/h50
Evaluating performance on  test set...
876/876 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0694541
{'0': {'precision': 0.3375807609475951, 'recall': 0.2773699904971, 'f1-score': 0.30452771132017775, 'support': 61034}, '1': {'precision': 0.48973508641878977, 'recall': 0.6251008436002908, 'f1-score': 0.5491997654862223, 'support': 100403}, '2': {'precision': 0.3724780247344428, 'recall': 0.2723039880088658, 'f1-score': 0.3146094325718497, 'support': 62713}, 'accuracy': 0.43171090787419136, 'macro avg': {'precision': 0.3999312907002759, 'recall': 0.3915916073687522, 'f1-score': 0.38944563645941654, 'support': 224150}, 'weighted avg': {'precision': 0.4154985072966869, 'recall': 0.43171090787419136, 'f1-score': 0.4169437864452702, 'support': 224150}}
[[16929 32924 11181]
 [20052 62762 17589]
 [13167 32469 17077]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0788387
{'0': {'precision': 0.44135029076639404, 'recall': 0.3370157767428427, 'f1-score': 0.3821903787103378, 'support': 27699}, '1': {'precision': 0.36356994451928126, 'recall': 0.5936253494874184, 'f1-score': 0.4509515178975986, 'support': 26825}, '2': {'precision': 0.4342857142857143, 'recall': 0.26470918692183815, 'f1-score': 0.328927773641102, 'support': 26701}, 'accuracy': 0.39799322868574943, 'macro avg': {'precision': 0.4130686498571299, 'recall': 0.3984501043840331, 'f1-score': 0.38735655674967945, 'support': 81225}, 'weighted avg': {'precision': 0.41334057645812156, 'recall': 0.39799322868574943, 'f1-score': 0.3873901662233523, 'support': 81225}}
[[ 9335 13900  4464]
 [ 6158 15924  4743]
 [ 5658 13975  7068]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.090876
{'0': {'precision': 0.3702113038996736, 'recall': 0.2621654501216545, 'f1-score': 0.3069581938608361, 'support': 8220}, '1': {'precision': 0.3860533759685156, 'recall': 0.6372310190824199, 'f1-score': 0.48081488856552046, 'support': 9852}, '2': {'precision': 0.3866213151927438, 'recall': 0.2024700154375965, 'f1-score': 0.26576260618813813, 'support': 8421}, 'accuracy': 0.38266711961650246, 'macro avg': {'precision': 0.3809619983536443, 'recall': 0.36728882821389025, 'f1-score': 0.35117856287149823, 'support': 26493}, 'weighted avg': {'precision': 0.3813185699367843, 'recall': 0.38266711961650246, 'f1-score': 0.35851627004846154, 'support': 26493}}
[[2155 4853 1212]
 [2081 6278 1493]
 [1585 5131 1705]]
training model: results/LILAK/W0/deepOF_L2/h100
Epoch 1/50
318/318 - 13s - loss: 3.3499 - accuracy100: 0.3378 - val_loss: 3.2893 - val_accuracy100: 0.4044 - 13s/epoch - 42ms/step
Epoch 2/50
318/318 - 11s - loss: 3.3151 - accuracy100: 0.3503 - val_loss: 3.2796 - val_accuracy100: 0.4133 - 11s/epoch - 34ms/step
Epoch 3/50
318/318 - 10s - loss: 3.2999 - accuracy100: 0.3592 - val_loss: 3.2737 - val_accuracy100: 0.4143 - 10s/epoch - 33ms/step
Epoch 4/50
318/318 - 10s - loss: 3.2910 - accuracy100: 0.3639 - val_loss: 3.2737 - val_accuracy100: 0.4142 - 10s/epoch - 33ms/step
Epoch 5/50
318/318 - 10s - loss: 3.2827 - accuracy100: 0.3700 - val_loss: 3.2703 - val_accuracy100: 0.4152 - 10s/epoch - 32ms/step
Epoch 6/50
318/318 - 10s - loss: 3.2769 - accuracy100: 0.3727 - val_loss: 3.2721 - val_accuracy100: 0.4114 - 10s/epoch - 33ms/step
Epoch 7/50
318/318 - 11s - loss: 3.2692 - accuracy100: 0.3793 - val_loss: 3.2718 - val_accuracy100: 0.4125 - 11s/epoch - 34ms/step
Epoch 8/50
318/318 - 11s - loss: 3.2643 - accuracy100: 0.3846 - val_loss: 3.2737 - val_accuracy100: 0.4101 - 11s/epoch - 34ms/step
Epoch 9/50
318/318 - 11s - loss: 3.2593 - accuracy100: 0.3863 - val_loss: 3.2729 - val_accuracy100: 0.4100 - 11s/epoch - 34ms/step
Epoch 10/50
318/318 - 10s - loss: 3.2517 - accuracy100: 0.3920 - val_loss: 3.2760 - val_accuracy100: 0.4098 - 10s/epoch - 33ms/step
Epoch 11/50
318/318 - 10s - loss: 3.2467 - accuracy100: 0.3954 - val_loss: 3.2745 - val_accuracy100: 0.4062 - 10s/epoch - 33ms/step
Epoch 12/50
318/318 - 10s - loss: 3.2428 - accuracy100: 0.3977 - val_loss: 3.2733 - val_accuracy100: 0.4052 - 10s/epoch - 32ms/step
Epoch 13/50
318/318 - 11s - loss: 3.2353 - accuracy100: 0.4028 - val_loss: 3.2757 - val_accuracy100: 0.4060 - 11s/epoch - 34ms/step
Epoch 14/50
318/318 - 10s - loss: 3.2286 - accuracy100: 0.4072 - val_loss: 3.2751 - val_accuracy100: 0.4070 - 10s/epoch - 33ms/step
Epoch 15/50
318/318 - 10s - loss: 3.2225 - accuracy100: 0.4108 - val_loss: 3.2802 - val_accuracy100: 0.3999 - 10s/epoch - 32ms/step
testing model: results/LILAK/W0/deepOF_L2/h100
Evaluating performance on  test set...
876/876 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0616994
{'0': {'precision': 0.2949117341640706, 'recall': 0.07460072849537686, 'f1-score': 0.11907923241414975, 'support': 57104}, '1': {'precision': 0.49041460746982096, 'recall': 0.8872876852886747, 'f1-score': 0.6316877661898893, 'support': 109154}, '2': {'precision': 0.32143734140951136, 'recall': 0.0678332066606785, 'f1-score': 0.11202556019911852, 'support': 57892}, 'accuracy': 0.4686058443006915, 'macro avg': {'precision': 0.3689212276811343, 'recall': 0.3432405401482434, 'f1-score': 0.2875975196010525, 'support': 224150}, 'weighted avg': {'precision': 0.3969663453060243, 'recall': 0.4686058443006915, 'f1-score': 0.36688168926841913, 'support': 224150}}
[[ 4260 50317  2527]
 [ 6540 96851  5763]
 [ 3645 50320  3927]]
Evaluating performance on  train set...
318/318 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1069655
{'0': {'precision': 0.45978732963905944, 'recall': 0.10611088068574588, 'f1-score': 0.17242831868347885, 'support': 28932}, '1': {'precision': 0.3112180588976739, 'recall': 0.8751762194385145, 'f1-score': 0.45915704278182223, 'support': 24827}, '2': {'precision': 0.4319526627218935, 'recall': 0.07441928202140828, 'f1-score': 0.126964407727188, 'support': 27466}, 'accuracy': 0.3304647583871961, 'macro avg': {'precision': 0.40098601708620896, 'recall': 0.3519021273818896, 'f1-score': 0.25284992306416304, 'support': 81225}, 'weighted avg': {'precision': 0.40496386092569214, 'recall': 0.3304647583871961, 'f1-score': 0.24469550557007885, 'support': 81225}}
[[ 3070 24506  1356]
 [ 1767 21728  1332]
 [ 1840 23582  2044]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0832336
{'0': {'precision': 0.31841909023117076, 'recall': 0.055860805860805864, 'f1-score': 0.09504730105731775, 'support': 7644}, '1': {'precision': 0.4230321669021694, 'recall': 0.9095701903315164, 'f1-score': 0.577482767424049, 'support': 11191}, '2': {'precision': 0.3697247706422018, 'recall': 0.052624706189605644, 'f1-score': 0.09213534522176499, 'support': 7658}, 'accuracy': 0.41554372853206506, 'macro avg': {'precision': 0.370392009258514, 'recall': 0.339351900793976, 'f1-score': 0.25488847123437725, 'support': 26493}, 'weighted avg': {'precision': 0.3774393537578692, 'recall': 0.41554372853206506, 'f1-score': 0.29799281671509253, 'support': 26493}}
[[  427  6967   250]
 [  575 10179   437]
 [  339  6916   403]]
training model: results/LILAK/W0/deepOF_L2/h200
Epoch 1/50
318/318 - 13s - loss: 3.3448 - accuracy200: 0.3418 - val_loss: 3.3183 - val_accuracy200: 0.3459 - 13s/epoch - 41ms/step
Epoch 2/50
318/318 - 11s - loss: 3.3147 - accuracy200: 0.3501 - val_loss: 3.3108 - val_accuracy200: 0.3459 - 11s/epoch - 34ms/step
Epoch 3/50
318/318 - 10s - loss: 3.3015 - accuracy200: 0.3559 - val_loss: 3.3045 - val_accuracy200: 0.3462 - 10s/epoch - 33ms/step
Epoch 4/50
318/318 - 10s - loss: 3.2930 - accuracy200: 0.3612 - val_loss: 3.3065 - val_accuracy200: 0.3464 - 10s/epoch - 33ms/step
Epoch 5/50
318/318 - 11s - loss: 3.2869 - accuracy200: 0.3667 - val_loss: 3.3026 - val_accuracy200: 0.3458 - 11s/epoch - 34ms/step
Epoch 6/50
318/318 - 11s - loss: 3.2795 - accuracy200: 0.3711 - val_loss: 3.3006 - val_accuracy200: 0.3497 - 11s/epoch - 33ms/step
Epoch 7/50
318/318 - 11s - loss: 3.2742 - accuracy200: 0.3738 - val_loss: 3.3000 - val_accuracy200: 0.3530 - 11s/epoch - 33ms/step
Epoch 8/50
318/318 - 10s - loss: 3.2689 - accuracy200: 0.3803 - val_loss: 3.3010 - val_accuracy200: 0.3502 - 10s/epoch - 32ms/step
Epoch 9/50
318/318 - 11s - loss: 3.2640 - accuracy200: 0.3851 - val_loss: 3.3003 - val_accuracy200: 0.3522 - 11s/epoch - 34ms/step
Epoch 10/50
318/318 - 11s - loss: 3.2560 - accuracy200: 0.3885 - val_loss: 3.3005 - val_accuracy200: 0.3541 - 11s/epoch - 34ms/step
Epoch 11/50
318/318 - 11s - loss: 3.2506 - accuracy200: 0.3922 - val_loss: 3.3023 - val_accuracy200: 0.3575 - 11s/epoch - 34ms/step
Epoch 12/50
318/318 - 11s - loss: 3.2475 - accuracy200: 0.3944 - val_loss: 3.3061 - val_accuracy200: 0.3500 - 11s/epoch - 34ms/step
Epoch 13/50
318/318 - 11s - loss: 3.2419 - accuracy200: 0.3980 - val_loss: 3.3063 - val_accuracy200: 0.3542 - 11s/epoch - 34ms/step
Epoch 14/50
318/318 - 10s - loss: 3.2330 - accuracy200: 0.4046 - val_loss: 3.3066 - val_accuracy200: 0.3571 - 10s/epoch - 33ms/step
Epoch 15/50
318/318 - 11s - loss: 3.2280 - accuracy200: 0.4075 - val_loss: 3.3112 - val_accuracy200: 0.3521 - 11s/epoch - 33ms/step
Epoch 16/50
318/318 - 11s - loss: 3.2230 - accuracy200: 0.4114 - val_loss: 3.3142 - val_accuracy200: 0.3566 - 11s/epoch - 34ms/step
Epoch 17/50
318/318 - 11s - loss: 3.2170 - accuracy200: 0.4141 - val_loss: 3.3206 - val_accuracy200: 0.3544 - 11s/epoch - 33ms/step
testing model: results/LILAK/W0/deepOF_L2/h200
Evaluating performance on  test set...
876/876 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0988075
{'0': {'precision': 0.3513464861751152, 'recall': 0.13702996433485917, 'f1-score': 0.19716346445239105, 'support': 71218}, '1': {'precision': 0.35493491124260357, 'recall': 0.7591566051585795, 'f1-score': 0.48371462901287837, 'support': 79014}, '2': {'precision': 0.36735588514648937, 'recall': 0.1360426418463703, 'f1-score': 0.19855467361687004, 'support': 73918}, 'accuracy': 0.3560071380771805, 'macro avg': {'precision': 0.3578790941880694, 'recall': 0.34407640377993637, 'f1-score': 0.2931442556940465, 'support': 224150}, 'weighted avg': {'precision': 0.357890847412896, 'recall': 0.3560071380771805, 'f1-score': 0.2986329675333739, 'support': 224150}}
[[ 9759 53781  7678]
 [ 9390 59984  9640]
 [ 8627 55235 10056]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0925705
{'0': {'precision': 0.4267716535433071, 'recall': 0.17698922390334168, 'f1-score': 0.2502115872893745, 'support': 27561}, '1': {'precision': 0.34164484547258867, 'recall': 0.7640147700570661, 'f1-score': 0.47215563341323985, 'support': 26811}, '2': {'precision': 0.41014433828013824, 'recall': 0.15026254049826834, 'f1-score': 0.21994494562699302, 'support': 26853}, 'accuracy': 0.3619205909510619, 'macro avg': {'precision': 0.3928536124320113, 'recall': 0.36375551148622537, 'f1-score': 0.31410405544320247, 'support': 81225}, 'weighted avg': {'precision': 0.3931757391333852, 'recall': 0.3619205909510619, 'f1-score': 0.31346540929081523, 'support': 81225}}
[[ 4878 19848  2835]
 [ 3359 20484  2968]
 [ 3193 19625  4035]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1014374
{'0': {'precision': 0.33775021144629264, 'recall': 0.1373223292067859, 'f1-score': 0.1952571102599625, 'support': 8724}, '1': {'precision': 0.3469828644375706, 'recall': 0.7700773673313719, 'f1-score': 0.47840509071215814, 'support': 9177}, '2': {'precision': 0.37107405971306706, 'recall': 0.11138268156424581, 'f1-score': 0.17133649628502373, 'support': 8592}, 'accuracy': 0.34809194881666855, 'macro avg': {'precision': 0.35193571186564343, 'recall': 0.3395941260341346, 'f1-score': 0.28166623241904815, 'support': 26493}, 'weighted avg': {'precision': 0.35175566801252084, 'recall': 0.34809194881666855, 'f1-score': 0.28557995408048586, 'support': 26493}}
[[1198 6714  812]
 [1300 7067  810]
 [1049 6586  957]]
training model: results/LILAK/W0/deepOF_L2/h300
Epoch 1/50
318/318 - 13s - loss: 3.3459 - accuracy300: 0.3428 - val_loss: 3.3024 - val_accuracy300: 0.3693 - 13s/epoch - 41ms/step
Epoch 2/50
318/318 - 11s - loss: 3.3163 - accuracy300: 0.3541 - val_loss: 3.2955 - val_accuracy300: 0.3739 - 11s/epoch - 34ms/step
Epoch 3/50
318/318 - 10s - loss: 3.3024 - accuracy300: 0.3602 - val_loss: 3.2900 - val_accuracy300: 0.3747 - 10s/epoch - 33ms/step
Epoch 4/50
318/318 - 11s - loss: 3.2942 - accuracy300: 0.3637 - val_loss: 3.2889 - val_accuracy300: 0.3751 - 11s/epoch - 33ms/step
Epoch 5/50
318/318 - 11s - loss: 3.2889 - accuracy300: 0.3656 - val_loss: 3.2868 - val_accuracy300: 0.3792 - 11s/epoch - 35ms/step
Epoch 6/50
318/318 - 11s - loss: 3.2827 - accuracy300: 0.3711 - val_loss: 3.2841 - val_accuracy300: 0.3798 - 11s/epoch - 33ms/step
Epoch 7/50
318/318 - 11s - loss: 3.2778 - accuracy300: 0.3752 - val_loss: 3.2827 - val_accuracy300: 0.3807 - 11s/epoch - 33ms/step
Epoch 8/50
318/318 - 11s - loss: 3.2739 - accuracy300: 0.3763 - val_loss: 3.2857 - val_accuracy300: 0.3784 - 11s/epoch - 34ms/step
Epoch 9/50
318/318 - 11s - loss: 3.2667 - accuracy300: 0.3813 - val_loss: 3.2844 - val_accuracy300: 0.3792 - 11s/epoch - 33ms/step
Epoch 10/50
318/318 - 11s - loss: 3.2622 - accuracy300: 0.3844 - val_loss: 3.2867 - val_accuracy300: 0.3789 - 11s/epoch - 33ms/step
Epoch 11/50
318/318 - 11s - loss: 3.2565 - accuracy300: 0.3898 - val_loss: 3.2848 - val_accuracy300: 0.3818 - 11s/epoch - 33ms/step
Epoch 12/50
318/318 - 11s - loss: 3.2544 - accuracy300: 0.3906 - val_loss: 3.2870 - val_accuracy300: 0.3808 - 11s/epoch - 33ms/step
Epoch 13/50
318/318 - 10s - loss: 3.2479 - accuracy300: 0.3944 - val_loss: 3.2893 - val_accuracy300: 0.3776 - 10s/epoch - 33ms/step
Epoch 14/50
318/318 - 11s - loss: 3.2423 - accuracy300: 0.3983 - val_loss: 3.2880 - val_accuracy300: 0.3755 - 11s/epoch - 33ms/step
Epoch 15/50
318/318 - 11s - loss: 3.2376 - accuracy300: 0.4031 - val_loss: 3.2923 - val_accuracy300: 0.3738 - 11s/epoch - 33ms/step
Epoch 16/50
318/318 - 10s - loss: 3.2316 - accuracy300: 0.4049 - val_loss: 3.2959 - val_accuracy300: 0.3741 - 10s/epoch - 33ms/step
Epoch 17/50
318/318 - 11s - loss: 3.2244 - accuracy300: 0.4086 - val_loss: 3.3002 - val_accuracy300: 0.3696 - 11s/epoch - 33ms/step
testing model: results/LILAK/W0/deepOF_L2/h300
Evaluating performance on  test set...
876/876 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0877097
{'0': {'precision': 0.31580882352941175, 'recall': 0.05342288974921094, 'f1-score': 0.09138662446640158, 'support': 64317}, '1': {'precision': 0.413339218671732, 'recall': 0.9048978838449094, 'f1-score': 0.567469666226356, 'support': 92101}, '2': {'precision': 0.3526076123378297, 'recall': 0.06059174393196717, 'f1-score': 0.10341308538383037, 'support': 67732}, 'accuracy': 0.40545170644657597, 'macro avg': {'precision': 0.36058521817965783, 'recall': 0.3396375058420292, 'f1-score': 0.25408979202552934, 'support': 224150}, 'weighted avg': {'precision': 0.3670026780311945, 'recall': 0.40545170644657597, 'f1-score': 0.2906384668933159, 'support': 224150}}
[[ 3436 58022  2859]
 [ 4083 83342  4676]
 [ 3361 60267  4104]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1022904
{'0': {'precision': 0.44631934191098926, 'recall': 0.075641667262458, 'f1-score': 0.1293596209689745, 'support': 27974}, '1': {'precision': 0.3230854605993341, 'recall': 0.9022160235549357, 'f1-score': 0.4757896457320312, 'support': 25812}, '2': {'precision': 0.4402815622161671, 'recall': 0.0706658405918583, 'f1-score': 0.12178500769399868, 'support': 27439}, 'accuracy': 0.33663281009541396, 'macro avg': {'precision': 0.40322878824216346, 'recall': 0.34950784380308403, 'f1-score': 0.24231142479833478, 'support': 81225}, 'weighted avg': {'precision': 0.4051179435550315, 'recall': 0.33663281009541396, 'f1-score': 0.23689070112326144, 'support': 81225}}
[[ 2116 24592  1266]
 [ 1325 23288  1199]
 [ 1300 24200  1939]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0946189
{'0': {'precision': 0.33707865168539325, 'recall': 0.04001940334707737, 'f1-score': 0.07154471544715447, 'support': 8246}, '1': {'precision': 0.3834368360843275, 'recall': 0.9329025844930418, 'f1-score': 0.5434908501274033, 'support': 10060}, '2': {'precision': 0.37957610789980734, 'recall': 0.048125076340539884, 'f1-score': 0.08542005420054201, 'support': 8187}, 'accuracy': 0.38157249084663875, 'macro avg': {'precision': 0.36669719855650934, 'recall': 0.340349021393553, 'f1-score': 0.2334852065916999, 'support': 26493}, 'weighted avg': {'precision': 0.36781469551133544, 'recall': 0.38157249084663875, 'f1-score': 0.25504131882379305, 'support': 26493}}
[[ 330 7578  338]
 [ 369 9385  306]
 [ 280 7513  394]]
training model: results/LILAK/W0/deepOF_L2/h500
Epoch 1/50
318/318 - 13s - loss: 3.3525 - accuracy500: 0.3387 - val_loss: 3.3290 - val_accuracy500: 0.3324 - 13s/epoch - 42ms/step
Epoch 2/50
318/318 - 11s - loss: 3.3227 - accuracy500: 0.3462 - val_loss: 3.3212 - val_accuracy500: 0.3287 - 11s/epoch - 33ms/step
Epoch 3/50
318/318 - 11s - loss: 3.3095 - accuracy500: 0.3525 - val_loss: 3.3157 - val_accuracy500: 0.3352 - 11s/epoch - 34ms/step
Epoch 4/50
318/318 - 10s - loss: 3.2990 - accuracy500: 0.3581 - val_loss: 3.3168 - val_accuracy500: 0.3333 - 10s/epoch - 33ms/step
Epoch 5/50
318/318 - 11s - loss: 3.2932 - accuracy500: 0.3608 - val_loss: 3.3161 - val_accuracy500: 0.3314 - 11s/epoch - 34ms/step
Epoch 6/50
318/318 - 11s - loss: 3.2878 - accuracy500: 0.3630 - val_loss: 3.3143 - val_accuracy500: 0.3335 - 11s/epoch - 34ms/step
Epoch 7/50
318/318 - 11s - loss: 3.2811 - accuracy500: 0.3722 - val_loss: 3.3136 - val_accuracy500: 0.3325 - 11s/epoch - 34ms/step
Epoch 8/50
318/318 - 10s - loss: 3.2758 - accuracy500: 0.3745 - val_loss: 3.3163 - val_accuracy500: 0.3330 - 10s/epoch - 33ms/step
Epoch 9/50
318/318 - 11s - loss: 3.2705 - accuracy500: 0.3782 - val_loss: 3.3141 - val_accuracy500: 0.3351 - 11s/epoch - 34ms/step
Epoch 10/50
318/318 - 11s - loss: 3.2654 - accuracy500: 0.3835 - val_loss: 3.3159 - val_accuracy500: 0.3361 - 11s/epoch - 33ms/step
Epoch 11/50
318/318 - 10s - loss: 3.2614 - accuracy500: 0.3878 - val_loss: 3.3158 - val_accuracy500: 0.3359 - 10s/epoch - 33ms/step
Epoch 12/50
318/318 - 10s - loss: 3.2574 - accuracy500: 0.3890 - val_loss: 3.3173 - val_accuracy500: 0.3342 - 10s/epoch - 33ms/step
Epoch 13/50
318/318 - 11s - loss: 3.2516 - accuracy500: 0.3922 - val_loss: 3.3174 - val_accuracy500: 0.3356 - 11s/epoch - 34ms/step
Epoch 14/50
318/318 - 11s - loss: 3.2468 - accuracy500: 0.3962 - val_loss: 3.3205 - val_accuracy500: 0.3369 - 11s/epoch - 33ms/step
Epoch 15/50
318/318 - 11s - loss: 3.2434 - accuracy500: 0.3986 - val_loss: 3.3214 - val_accuracy500: 0.3404 - 11s/epoch - 34ms/step
Epoch 16/50
318/318 - 11s - loss: 3.2363 - accuracy500: 0.4012 - val_loss: 3.3263 - val_accuracy500: 0.3362 - 11s/epoch - 33ms/step
Epoch 17/50
318/318 - 10s - loss: 3.2298 - accuracy500: 0.4053 - val_loss: 3.3317 - val_accuracy500: 0.3351 - 10s/epoch - 33ms/step
testing model: results/LILAK/W0/deepOF_L2/h500
Evaluating performance on  test set...
876/876 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995295
{'0': {'precision': 0.32884524677329446, 'recall': 0.11158804528126182, 'f1-score': 0.16663226395211142, 'support': 68726}, '1': {'precision': 0.36048747788437235, 'recall': 0.8233522413533457, 'f1-score': 0.5014330370449629, 'support': 79684}, '2': {'precision': 0.38617173809144495, 'recall': 0.09601267494058621, 'f1-score': 0.15378921656744665, 'support': 75740}, 'accuracy': 0.35935311175552087, 'macro avg': {'precision': 0.35850148758303724, 'recall': 0.34365098719173126, 'f1-score': 0.2739515058548403, 'support': 224150}, 'weighted avg': {'precision': 0.3594644214165773, 'recall': 0.35935311175552087, 'f1-score': 0.28131231032381016, 'support': 224150}}
[[ 7669 55814  5243]
 [ 7760 65608  6316]
 [ 7892 60576  7272]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.096121
{'0': {'precision': 0.419673855865334, 'recall': 0.14474400377372185, 'f1-score': 0.21524929851068422, 'support': 27559}, '1': {'precision': 0.33465826165264106, 'recall': 0.8149268403342281, 'f1-score': 0.47447030983435146, 'support': 26449}, '2': {'precision': 0.4165983046212743, 'recall': 0.11195208876804938, 'f1-score': 0.17647910573108222, 'support': 27217}, 'accuracy': 0.35198522622345335, 'macro avg': {'precision': 0.3903101407130831, 'recall': 0.3572076442919998, 'f1-score': 0.28873290469203927, 'support': 81225}, 'weighted avg': {'precision': 0.39095997800087, 'recall': 0.35198522622345335, 'f1-score': 0.2866673125656826, 'support': 81225}}
[[ 3989 21450  2120]
 [ 2748 21554  2147]
 [ 2768 21402  3047]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1066395
{'0': {'precision': 0.3563661873027008, 'recall': 0.11325381785754096, 'f1-score': 0.17188293013026562, 'support': 8971}, '1': {'precision': 0.32784867821330904, 'recall': 0.8380519631830362, 'f1-score': 0.47131671198768144, 'support': 8583}, '2': {'precision': 0.3683901292596945, 'recall': 0.07014207405750084, 'f1-score': 0.11784606709895686, 'support': 8939}, 'accuracy': 0.3335220624315857, 'macro avg': {'precision': 0.35086833159190145, 'recall': 0.34048261836602595, 'f1-score': 0.2536819030723013, 'support': 26493}, 'weighted avg': {'precision': 0.3511842991299502, 'recall': 0.3335220624315857, 'f1-score': 0.2506586305434061, 'support': 26493}}
[[1016 7365  590]
 [ 905 7193  485]
 [ 930 7382  627]]
training model: results/LILAK/W0/deepOF_L2/h1000
Epoch 1/50
318/318 - 13s - loss: 3.3682 - accuracy1000: 0.3323 - val_loss: 3.3159 - val_accuracy1000: 0.3419 - 13s/epoch - 40ms/step
Epoch 2/50
318/318 - 11s - loss: 3.3342 - accuracy1000: 0.3417 - val_loss: 3.3058 - val_accuracy1000: 0.3429 - 11s/epoch - 36ms/step
Epoch 3/50
318/318 - 11s - loss: 3.3166 - accuracy1000: 0.3480 - val_loss: 3.3039 - val_accuracy1000: 0.3450 - 11s/epoch - 34ms/step
Epoch 4/50
318/318 - 11s - loss: 3.3098 - accuracy1000: 0.3495 - val_loss: 3.3031 - val_accuracy1000: 0.3416 - 11s/epoch - 35ms/step
Epoch 5/50
318/318 - 11s - loss: 3.3003 - accuracy1000: 0.3552 - val_loss: 3.3032 - val_accuracy1000: 0.3454 - 11s/epoch - 34ms/step
Epoch 6/50
318/318 - 11s - loss: 3.2955 - accuracy1000: 0.3568 - val_loss: 3.3032 - val_accuracy1000: 0.3445 - 11s/epoch - 33ms/step
Epoch 7/50
318/318 - 11s - loss: 3.2902 - accuracy1000: 0.3622 - val_loss: 3.3037 - val_accuracy1000: 0.3462 - 11s/epoch - 33ms/step
Epoch 8/50
318/318 - 11s - loss: 3.2848 - accuracy1000: 0.3672 - val_loss: 3.3042 - val_accuracy1000: 0.3414 - 11s/epoch - 34ms/step
Epoch 9/50
318/318 - 11s - loss: 3.2812 - accuracy1000: 0.3686 - val_loss: 3.3046 - val_accuracy1000: 0.3428 - 11s/epoch - 34ms/step
Epoch 10/50
318/318 - 11s - loss: 3.2770 - accuracy1000: 0.3716 - val_loss: 3.3079 - val_accuracy1000: 0.3407 - 11s/epoch - 33ms/step
Epoch 11/50
318/318 - 11s - loss: 3.2708 - accuracy1000: 0.3773 - val_loss: 3.3062 - val_accuracy1000: 0.3425 - 11s/epoch - 33ms/step
Epoch 12/50
318/318 - 11s - loss: 3.2673 - accuracy1000: 0.3807 - val_loss: 3.3092 - val_accuracy1000: 0.3451 - 11s/epoch - 34ms/step
Epoch 13/50
318/318 - 11s - loss: 3.2628 - accuracy1000: 0.3828 - val_loss: 3.3104 - val_accuracy1000: 0.3423 - 11s/epoch - 33ms/step
Epoch 14/50
318/318 - 11s - loss: 3.2578 - accuracy1000: 0.3880 - val_loss: 3.3112 - val_accuracy1000: 0.3411 - 11s/epoch - 35ms/step
testing model: results/LILAK/W0/deepOF_L2/h1000
Evaluating performance on  test set...
876/876 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1021354
{'0': {'precision': 0.3090870817425917, 'recall': 0.46747514507749527, 'f1-score': 0.3721286547012879, 'support': 69101}, '1': {'precision': 0.35565120007026946, 'recall': 0.20826046703014092, 'f1-score': 0.26269392654107226, 'support': 77768}, '2': {'precision': 0.3591902834008097, 'recall': 0.3444054812955319, 'f1-score': 0.351642544308731, 'support': 77281}, 'accuracy': 0.33511041713138523, 'macro avg': {'precision': 0.34130952173789025, 'recall': 0.34004703113438933, 'f1-score': 0.3288217085170304, 'support': 224150}, 'weighted avg': {'precision': 0.3425165882402744, 'recall': 0.33511041713138523, 'f1-score': 0.32709761728522346, 'support': 224150}}
[[32303 14057 22741]
 [36829 16196 24743]
 [35379 15286 26616]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0949352
{'0': {'precision': 0.35812498356863054, 'recall': 0.5017126441015064, 'f1-score': 0.41792968030925937, 'support': 27151}, '1': {'precision': 0.37123149194267707, 'recall': 0.22773866413745303, 'f1-score': 0.28229708342753784, 'support': 27413}, '2': {'precision': 0.3597891623374161, 'recall': 0.3558756235700086, 'f1-score': 0.3578216925629808, 'support': 26661}, 'accuracy': 0.3613788858110188, 'macro avg': {'precision': 0.36304854594957453, 'recall': 0.36177564393632267, 'f1-score': 0.35268281876659263, 'support': 81225}, 'weighted avg': {'precision': 0.3630946035650888, 'recall': 0.3613788858110188, 'f1-score': 0.3524247810833786, 'support': 81225}}
[[13622  5268  8261]
 [12548  6243  8622]
 [11867  5306  9488]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993725
{'0': {'precision': 0.3445489159996892, 'recall': 0.49250249916694433, 'f1-score': 0.4054498902706657, 'support': 9003}, '1': {'precision': 0.31866048862679025, 'recall': 0.18718297661759248, 'f1-score': 0.2358350868989167, 'support': 8083}, '2': {'precision': 0.3717890941865705, 'recall': 0.3508025938131179, 'f1-score': 0.36099108461412244, 'support': 9407}, 'accuracy': 0.3490355943079304, 'macro avg': {'precision': 0.34499949960434995, 'recall': 0.3434960231992182, 'f1-score': 0.3340920205945683, 'support': 26493}, 'weighted avg': {'precision': 0.34632267502089675, 'recall': 0.3490355943079304, 'f1-score': 0.33791429820993457, 'support': 26493}}
[[4434 1590 2979]
 [3973 1513 2597]
 [4462 1645 3300]]
training model: results/LILAK/W0/deepVOL_L2/h10
Epoch 1/50
318/318 - 15s - loss: 3.3317 - accuracy10: 0.3395 - val_loss: 3.2520 - val_accuracy10: 0.3762 - 15s/epoch - 48ms/step
Epoch 2/50
318/318 - 13s - loss: 3.2860 - accuracy10: 0.3536 - val_loss: 3.2317 - val_accuracy10: 0.3444 - 13s/epoch - 42ms/step
Epoch 3/50
318/318 - 12s - loss: 3.2613 - accuracy10: 0.3567 - val_loss: 3.2116 - val_accuracy10: 0.4009 - 12s/epoch - 37ms/step
Epoch 4/50
318/318 - 12s - loss: 3.2422 - accuracy10: 0.3677 - val_loss: 3.1992 - val_accuracy10: 0.4118 - 12s/epoch - 38ms/step
Epoch 5/50
318/318 - 13s - loss: 3.2232 - accuracy10: 0.3693 - val_loss: 3.1872 - val_accuracy10: 0.4010 - 13s/epoch - 40ms/step
Epoch 6/50
318/318 - 11s - loss: 3.2106 - accuracy10: 0.3823 - val_loss: 3.1921 - val_accuracy10: 0.3996 - 11s/epoch - 36ms/step
Epoch 7/50
318/318 - 13s - loss: 3.1900 - accuracy10: 0.3946 - val_loss: 3.1848 - val_accuracy10: 0.3927 - 13s/epoch - 40ms/step
Epoch 8/50
318/318 - 12s - loss: 3.1799 - accuracy10: 0.4001 - val_loss: 3.2022 - val_accuracy10: 0.3698 - 12s/epoch - 38ms/step
Epoch 9/50
318/318 - 12s - loss: 3.1636 - accuracy10: 0.4075 - val_loss: 3.1875 - val_accuracy10: 0.3628 - 12s/epoch - 38ms/step
Epoch 10/50
318/318 - 12s - loss: 3.1520 - accuracy10: 0.4147 - val_loss: 3.1668 - val_accuracy10: 0.4070 - 12s/epoch - 37ms/step
Epoch 11/50
318/318 - 12s - loss: 3.1461 - accuracy10: 0.4241 - val_loss: 3.1629 - val_accuracy10: 0.3929 - 12s/epoch - 39ms/step
Epoch 12/50
318/318 - 12s - loss: 3.1346 - accuracy10: 0.4276 - val_loss: 3.1487 - val_accuracy10: 0.4028 - 12s/epoch - 39ms/step
Epoch 13/50
318/318 - 12s - loss: 3.1209 - accuracy10: 0.4361 - val_loss: 3.1520 - val_accuracy10: 0.4026 - 12s/epoch - 38ms/step
Epoch 14/50
318/318 - 12s - loss: 3.1157 - accuracy10: 0.4391 - val_loss: 3.1436 - val_accuracy10: 0.4248 - 12s/epoch - 39ms/step
Epoch 15/50
318/318 - 12s - loss: 3.1036 - accuracy10: 0.4448 - val_loss: 3.1553 - val_accuracy10: 0.4295 - 12s/epoch - 36ms/step
Epoch 16/50
318/318 - 12s - loss: 3.0935 - accuracy10: 0.4510 - val_loss: 3.1508 - val_accuracy10: 0.4195 - 12s/epoch - 39ms/step
Epoch 17/50
318/318 - 12s - loss: 3.0854 - accuracy10: 0.4524 - val_loss: 3.1389 - val_accuracy10: 0.4130 - 12s/epoch - 37ms/step
Epoch 18/50
318/318 - 12s - loss: 3.0792 - accuracy10: 0.4567 - val_loss: 3.1463 - val_accuracy10: 0.4275 - 12s/epoch - 39ms/step
Epoch 19/50
318/318 - 12s - loss: 3.0708 - accuracy10: 0.4594 - val_loss: 3.1295 - val_accuracy10: 0.4206 - 12s/epoch - 39ms/step
Epoch 20/50
318/318 - 12s - loss: 3.0633 - accuracy10: 0.4632 - val_loss: 3.1458 - val_accuracy10: 0.4199 - 12s/epoch - 36ms/step
Epoch 21/50
318/318 - 12s - loss: 3.0553 - accuracy10: 0.4672 - val_loss: 3.1309 - val_accuracy10: 0.4128 - 12s/epoch - 37ms/step
Epoch 22/50
318/318 - 12s - loss: 3.0549 - accuracy10: 0.4684 - val_loss: 3.1362 - val_accuracy10: 0.4261 - 12s/epoch - 37ms/step
Epoch 23/50
318/318 - 11s - loss: 3.0462 - accuracy10: 0.4705 - val_loss: 3.1251 - val_accuracy10: 0.4328 - 11s/epoch - 35ms/step
Epoch 24/50
318/318 - 11s - loss: 3.0399 - accuracy10: 0.4731 - val_loss: 3.1419 - val_accuracy10: 0.4192 - 11s/epoch - 35ms/step
Epoch 25/50
318/318 - 11s - loss: 3.0358 - accuracy10: 0.4767 - val_loss: 3.1335 - val_accuracy10: 0.4247 - 11s/epoch - 35ms/step
Epoch 26/50
318/318 - 11s - loss: 3.0295 - accuracy10: 0.4769 - val_loss: 3.1381 - val_accuracy10: 0.4365 - 11s/epoch - 36ms/step
Epoch 27/50
318/318 - 12s - loss: 3.0237 - accuracy10: 0.4780 - val_loss: 3.1333 - val_accuracy10: 0.4296 - 12s/epoch - 37ms/step
Epoch 28/50
318/318 - 11s - loss: 3.0176 - accuracy10: 0.4808 - val_loss: 3.1355 - val_accuracy10: 0.4253 - 11s/epoch - 34ms/step
Epoch 29/50
318/318 - 11s - loss: 3.0082 - accuracy10: 0.4840 - val_loss: 3.1349 - val_accuracy10: 0.4302 - 11s/epoch - 35ms/step
Epoch 30/50
318/318 - 12s - loss: 2.9996 - accuracy10: 0.4876 - val_loss: 3.1296 - val_accuracy10: 0.4295 - 12s/epoch - 38ms/step
Epoch 31/50
318/318 - 12s - loss: 3.0010 - accuracy10: 0.4887 - val_loss: 3.1334 - val_accuracy10: 0.4274 - 12s/epoch - 38ms/step
Epoch 32/50
318/318 - 13s - loss: 2.9890 - accuracy10: 0.4895 - val_loss: 3.1426 - val_accuracy10: 0.4346 - 13s/epoch - 40ms/step
Epoch 33/50
318/318 - 12s - loss: 2.9873 - accuracy10: 0.4926 - val_loss: 3.1467 - val_accuracy10: 0.4293 - 12s/epoch - 37ms/step
testing model: results/LILAK/W0/deepVOL_L2/h10
Evaluating performance on  test set...
876/876 - 18s - 18s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0069792
{'0': {'precision': 0.31520039358318835, 'recall': 0.4004688023216877, 'f1-score': 0.35275494553034176, 'support': 44795}, '1': {'precision': 0.6991998263494914, 'recall': 0.5318194098400024, 'f1-score': 0.604130346753053, 'support': 133252}, '2': {'precision': 0.3213131175158221, 'recall': 0.45916110002602584, 'f1-score': 0.3780636981347715, 'support': 46108}, 'accuracy': 0.4906247908813098, 'macro avg': {'precision': 0.44523777914950063, 'recall': 0.4638164373959053, 'f1-score': 0.44498299680605546, 'support': 224155}, 'weighted avg': {'precision': 0.5447314675724426, 'recall': 0.4906247908813098, 'f1-score': 0.5073944178990766, 'support': 224155}}
[[17939 15052 11804]
 [29472 70866 32914]
 [ 9502 15435 21171]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0388105
{'0': {'precision': 0.3889924968556187, 'recall': 0.42207058823529414, 'f1-score': 0.40485702033538723, 'support': 21250}, '1': {'precision': 0.5988173046996577, 'recall': 0.44181358916132984, 'f1-score': 0.5084715900748789, 'support': 39193}, '2': {'precision': 0.3718465850823819, 'recall': 0.5233581910031273, 'f1-score': 0.43478087092068185, 'support': 20785}, 'accuracy': 0.45751465012064807, 'macro avg': {'precision': 0.453218795545886, 'recall': 0.46241412279991706, 'f1-score': 0.449369827110316, 'support': 81228}, 'weighted avg': {'precision': 0.4858468564068164, 'recall': 0.45751465012064807, 'f1-score': 0.4625087299209396, 'support': 81228}}
[[ 8969  5878  6403]
 [ 9904 17316 11973]
 [ 4184  5723 10878]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0560468
{'0': {'precision': 0.31997063142437593, 'recall': 0.34931067649887787, 'f1-score': 0.33399754751686084, 'support': 6238}, '1': {'precision': 0.6100478468899522, 'recall': 0.44632438739789965, 'f1-score': 0.5154986522911051, 'support': 13712}, '2': {'precision': 0.327634442026733, 'recall': 0.4832645575424117, 'f1-score': 0.3905150055576139, 'support': 6543}, 'accuracy': 0.4326048390140792, 'macro avg': {'precision': 0.41921764011368706, 'recall': 0.42629987381306306, 'f1-score': 0.4133370684551933, 'support': 26493}, 'weighted avg': {'precision': 0.47199883099540235, 'recall': 0.4326048390140792, 'f1-score': 0.4418953649261797, 'support': 26493}}
[[2179 1875 2184]
 [3287 6120 4305]
 [1344 2037 3162]]
training model: results/LILAK/W0/deepVOL_L2/h20
Epoch 1/50
318/318 - 15s - loss: 3.3430 - accuracy20: 0.3495 - val_loss: 3.3249 - val_accuracy20: 0.3493 - 15s/epoch - 48ms/step
Epoch 2/50
318/318 - 13s - loss: 3.2948 - accuracy20: 0.3663 - val_loss: 3.2661 - val_accuracy20: 0.3867 - 13s/epoch - 40ms/step
Epoch 3/50
318/318 - 11s - loss: 3.2714 - accuracy20: 0.3778 - val_loss: 3.2701 - val_accuracy20: 0.3699 - 11s/epoch - 36ms/step
Epoch 4/50
318/318 - 12s - loss: 3.2547 - accuracy20: 0.3885 - val_loss: 3.2571 - val_accuracy20: 0.3866 - 12s/epoch - 37ms/step
Epoch 5/50
318/318 - 12s - loss: 3.2393 - accuracy20: 0.3989 - val_loss: 3.2558 - val_accuracy20: 0.3864 - 12s/epoch - 38ms/step
Epoch 6/50
318/318 - 11s - loss: 3.2284 - accuracy20: 0.4052 - val_loss: 3.2558 - val_accuracy20: 0.3847 - 11s/epoch - 34ms/step
Epoch 7/50
318/318 - 11s - loss: 3.2127 - accuracy20: 0.4156 - val_loss: 3.2459 - val_accuracy20: 0.4016 - 11s/epoch - 36ms/step
Epoch 8/50
318/318 - 13s - loss: 3.1992 - accuracy20: 0.4188 - val_loss: 3.2422 - val_accuracy20: 0.3956 - 13s/epoch - 40ms/step
Epoch 9/50
318/318 - 12s - loss: 3.1892 - accuracy20: 0.4246 - val_loss: 3.2276 - val_accuracy20: 0.4061 - 12s/epoch - 38ms/step
Epoch 10/50
318/318 - 12s - loss: 3.1790 - accuracy20: 0.4304 - val_loss: 3.2265 - val_accuracy20: 0.4057 - 12s/epoch - 39ms/step
Epoch 11/50
318/318 - 11s - loss: 3.1687 - accuracy20: 0.4362 - val_loss: 3.2249 - val_accuracy20: 0.4074 - 11s/epoch - 35ms/step
Epoch 12/50
318/318 - 12s - loss: 3.1610 - accuracy20: 0.4376 - val_loss: 3.2170 - val_accuracy20: 0.4107 - 12s/epoch - 38ms/step
Epoch 13/50
318/318 - 12s - loss: 3.1527 - accuracy20: 0.4422 - val_loss: 3.2247 - val_accuracy20: 0.4068 - 12s/epoch - 37ms/step
Epoch 14/50
318/318 - 13s - loss: 3.1420 - accuracy20: 0.4467 - val_loss: 3.2211 - val_accuracy20: 0.4168 - 13s/epoch - 40ms/step
Epoch 15/50
318/318 - 12s - loss: 3.1347 - accuracy20: 0.4491 - val_loss: 3.2214 - val_accuracy20: 0.4151 - 12s/epoch - 39ms/step
Epoch 16/50
318/318 - 13s - loss: 3.1245 - accuracy20: 0.4539 - val_loss: 3.2127 - val_accuracy20: 0.4160 - 13s/epoch - 41ms/step
Epoch 17/50
318/318 - 12s - loss: 3.1177 - accuracy20: 0.4568 - val_loss: 3.2257 - val_accuracy20: 0.4158 - 12s/epoch - 38ms/step
Epoch 18/50
318/318 - 12s - loss: 3.1120 - accuracy20: 0.4592 - val_loss: 3.2196 - val_accuracy20: 0.4165 - 12s/epoch - 39ms/step
Epoch 19/50
318/318 - 12s - loss: 3.1040 - accuracy20: 0.4641 - val_loss: 3.2352 - val_accuracy20: 0.4084 - 12s/epoch - 37ms/step
Epoch 20/50
318/318 - 11s - loss: 3.0982 - accuracy20: 0.4639 - val_loss: 3.2363 - val_accuracy20: 0.4195 - 11s/epoch - 35ms/step
Epoch 21/50
318/318 - 13s - loss: 3.0928 - accuracy20: 0.4656 - val_loss: 3.2429 - val_accuracy20: 0.4140 - 13s/epoch - 40ms/step
Epoch 22/50
318/318 - 12s - loss: 3.0867 - accuracy20: 0.4689 - val_loss: 3.2475 - val_accuracy20: 0.4176 - 12s/epoch - 38ms/step
Epoch 23/50
318/318 - 12s - loss: 3.0817 - accuracy20: 0.4710 - val_loss: 3.2723 - val_accuracy20: 0.4095 - 12s/epoch - 38ms/step
Epoch 24/50
318/318 - 12s - loss: 3.0725 - accuracy20: 0.4741 - val_loss: 3.2604 - val_accuracy20: 0.4175 - 12s/epoch - 37ms/step
Epoch 25/50
318/318 - 12s - loss: 3.0657 - accuracy20: 0.4754 - val_loss: 3.2586 - val_accuracy20: 0.4184 - 12s/epoch - 39ms/step
Epoch 26/50
318/318 - 13s - loss: 3.0578 - accuracy20: 0.4804 - val_loss: 3.2545 - val_accuracy20: 0.4125 - 13s/epoch - 40ms/step
testing model: results/LILAK/W0/deepVOL_L2/h20
Evaluating performance on  test set...
876/876 - 17s - 17s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0487223
{'0': {'precision': 0.3479202948442752, 'recall': 0.3096400958783138, 'f1-score': 0.327665945131545, 'support': 55487}, '1': {'precision': 0.5677236130507728, 'recall': 0.5422455775979375, 'f1-score': 0.5546921861764235, 'support': 111704}, '2': {'precision': 0.3459651596604095, 'recall': 0.4134892212625518, 'f1-score': 0.3767253650656559, 'support': 56964}, 'accuracy': 0.45194619794338736, 'macro avg': {'precision': 0.4205363558518192, 'recall': 0.42179163157960103, 'f1-score': 0.4196944987912081, 'support': 224155}, 'weighted avg': {'precision': 0.45695885091630073, 'recall': 0.45194619794338736, 'f1-score': 0.45326814016089434, 'support': 224155}}
[[17181 23306 15000]
 [21605 60571 29528]
 [10596 22814 23554]]
Evaluating performance on  train set...
318/318 - 7s - 7s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0564982
{'0': {'precision': 0.4538363497323477, 'recall': 0.34383932020084973, 'f1-score': 0.39125370838369405, 'support': 25890}, '1': {'precision': 0.45642246092493727, 'recall': 0.47303513099126726, 'f1-score': 0.4645803325913317, 'support': 30002}, '2': {'precision': 0.41338182771388315, 'recall': 0.4979475844647932, 'f1-score': 0.4517411153880584, 'support': 25336}, 'accuracy': 0.43962672969911853, 'macro avg': {'precision': 0.4412135461237227, 'recall': 0.43827401188563675, 'f1-score': 0.4358583854543614, 'support': 81228}, 'weighted avg': {'precision': 0.44217328697246505, 'recall': 0.43962672969911853, 'f1-score': 0.4372040496864483, 'support': 81228}}
[[ 8902  8703  8285]
 [ 6192 14192  9618]
 [ 4521  8199 12616]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0719274
{'0': {'precision': 0.375, 'recall': 0.2533263074693716, 'f1-score': 0.302382262756506, 'support': 7591}, '1': {'precision': 0.472632493483927, 'recall': 0.5003679175864606, 'f1-score': 0.48610490572781695, 'support': 10872}, '2': {'precision': 0.38082191780821917, 'recall': 0.46737235367372354, 'f1-score': 0.41968129717640484, 'support': 8030}, 'accuracy': 0.41958253123466577, 'macro avg': {'precision': 0.4094848037640488, 'recall': 0.4070221929098519, 'f1-score': 0.4027228218869092, 'support': 26493}, 'weighted avg': {'precision': 0.41683031250357655, 'recall': 0.41958253123466577, 'f1-score': 0.4133302045062467, 'support': 26493}}
[[1923 2990 2678]
 [2008 5440 3424]
 [1197 3080 3753]]
training model: results/LILAK/W0/deepVOL_L2/h30
Epoch 1/50
318/318 - 16s - loss: 3.3442 - accuracy30: 0.3511 - val_loss: 3.3120 - val_accuracy30: 0.3560 - 16s/epoch - 49ms/step
Epoch 2/50
318/318 - 12s - loss: 3.2911 - accuracy30: 0.3697 - val_loss: 3.2898 - val_accuracy30: 0.3707 - 12s/epoch - 39ms/step
Epoch 3/50
318/318 - 12s - loss: 3.2665 - accuracy30: 0.3863 - val_loss: 3.2883 - val_accuracy30: 0.3673 - 12s/epoch - 38ms/step
Epoch 4/50
318/318 - 11s - loss: 3.2545 - accuracy30: 0.3935 - val_loss: 3.2864 - val_accuracy30: 0.3722 - 11s/epoch - 36ms/step
Epoch 5/50
318/318 - 12s - loss: 3.2419 - accuracy30: 0.4021 - val_loss: 3.2843 - val_accuracy30: 0.3757 - 12s/epoch - 38ms/step
Epoch 6/50
318/318 - 12s - loss: 3.2290 - accuracy30: 0.4121 - val_loss: 3.2914 - val_accuracy30: 0.3763 - 12s/epoch - 36ms/step
Epoch 7/50
318/318 - 12s - loss: 3.2209 - accuracy30: 0.4132 - val_loss: 3.2791 - val_accuracy30: 0.3833 - 12s/epoch - 37ms/step
Epoch 8/50
318/318 - 12s - loss: 3.2075 - accuracy30: 0.4227 - val_loss: 3.2725 - val_accuracy30: 0.3821 - 12s/epoch - 39ms/step
Epoch 9/50
318/318 - 11s - loss: 3.1979 - accuracy30: 0.4269 - val_loss: 3.2790 - val_accuracy30: 0.3826 - 11s/epoch - 36ms/step
Epoch 10/50
318/318 - 13s - loss: 3.1875 - accuracy30: 0.4313 - val_loss: 3.2778 - val_accuracy30: 0.3842 - 13s/epoch - 40ms/step
Epoch 11/50
318/318 - 12s - loss: 3.1793 - accuracy30: 0.4342 - val_loss: 3.2792 - val_accuracy30: 0.3852 - 12s/epoch - 39ms/step
Epoch 12/50
318/318 - 12s - loss: 3.1704 - accuracy30: 0.4356 - val_loss: 3.2617 - val_accuracy30: 0.3953 - 12s/epoch - 39ms/step
Epoch 13/50
318/318 - 11s - loss: 3.1640 - accuracy30: 0.4402 - val_loss: 3.2765 - val_accuracy30: 0.3915 - 11s/epoch - 35ms/step
Epoch 14/50
318/318 - 11s - loss: 3.1571 - accuracy30: 0.4426 - val_loss: 3.2931 - val_accuracy30: 0.3882 - 11s/epoch - 36ms/step
Epoch 15/50
318/318 - 12s - loss: 3.1498 - accuracy30: 0.4453 - val_loss: 3.2920 - val_accuracy30: 0.3893 - 12s/epoch - 39ms/step
Epoch 16/50
318/318 - 13s - loss: 3.1434 - accuracy30: 0.4487 - val_loss: 3.2903 - val_accuracy30: 0.3907 - 13s/epoch - 39ms/step
Epoch 17/50
318/318 - 11s - loss: 3.1383 - accuracy30: 0.4502 - val_loss: 3.3009 - val_accuracy30: 0.3898 - 11s/epoch - 36ms/step
Epoch 18/50
318/318 - 12s - loss: 3.1324 - accuracy30: 0.4536 - val_loss: 3.2899 - val_accuracy30: 0.3926 - 12s/epoch - 36ms/step
Epoch 19/50
318/318 - 11s - loss: 3.1225 - accuracy30: 0.4544 - val_loss: 3.2847 - val_accuracy30: 0.3971 - 11s/epoch - 36ms/step
Epoch 20/50
318/318 - 12s - loss: 3.1204 - accuracy30: 0.4560 - val_loss: 3.2821 - val_accuracy30: 0.3954 - 12s/epoch - 38ms/step
Epoch 21/50
318/318 - 12s - loss: 3.1166 - accuracy30: 0.4598 - val_loss: 3.2885 - val_accuracy30: 0.3949 - 12s/epoch - 38ms/step
Epoch 22/50
318/318 - 12s - loss: 3.1073 - accuracy30: 0.4644 - val_loss: 3.2931 - val_accuracy30: 0.3939 - 12s/epoch - 38ms/step
testing model: results/LILAK/W0/deepVOL_L2/h30
Evaluating performance on  test set...
876/876 - 18s - 18s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0802867
{'0': {'precision': 0.3336884031122638, 'recall': 0.24448591788259247, 'f1-score': 0.28220594571305474, 'support': 58940}, '1': {'precision': 0.5167957742327237, 'recall': 0.41780815388868237, 'f1-score': 0.4620598777145267, 'support': 104907}, '2': {'precision': 0.3213045196447514, 'recall': 0.5123035086555681, 'f1-score': 0.3949228586402158, 'support': 60308}, 'accuracy': 0.397657870669849, 'macro avg': {'precision': 0.390596232329913, 'recall': 0.3915325268089476, 'f1-score': 0.3797295606892657, 'support': 224155}, 'weighted avg': {'precision': 0.4160528283446938, 'recall': 0.397657870669849, 'f1-score': 0.39670559117842313, 'support': 224155}}
[[14410 21030 23500]
 [19314 43831 41762]
 [ 9460 19952 30896]]
Evaluating performance on  train set...
318/318 - 7s - 7s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0763844
{'0': {'precision': 0.481673454276194, 'recall': 0.23535583776547633, 'f1-score': 0.31620649426404823, 'support': 27639}, '1': {'precision': 0.3931958838393086, 'recall': 0.40287418858579416, 'f1-score': 0.3979762037139998, 'support': 26651}, '2': {'precision': 0.3964271575613618, 'recall': 0.5947731828643552, 'f1-score': 0.47575496629747305, 'support': 26938}, 'accuracy': 0.4095139607032058, 'macro avg': {'precision': 0.4237654985589548, 'recall': 0.41100106973854195, 'f1-score': 0.39664588809184037, 'support': 81228}, 'weighted avg': {'precision': 0.42437325643040713, 'recall': 0.4095139607032058, 'f1-score': 0.39594699342920137, 'support': 81228}}
[[ 6505  8725 12409]
 [ 3929 10737 11985]
 [ 3071  7845 16022]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0881684
{'0': {'precision': 0.3813339618194674, 'recall': 0.19982709645547733, 'f1-score': 0.2622366288492707, 'support': 8097}, '1': {'precision': 0.43922030630823605, 'recall': 0.40797851173895744, 'f1-score': 0.4230233637629584, 'support': 10052}, '2': {'precision': 0.37094400991249127, 'recall': 0.574065196548418, 'f1-score': 0.4506750717410735, 'support': 8344}, 'accuracy': 0.39667081870682824, 'macro avg': {'precision': 0.39716609268006486, 'recall': 0.39395693491428424, 'f1-score': 0.37864502145110085, 'support': 26493}, 'weighted avg': {'precision': 0.4000249283422958, 'recall': 0.39667081870682824, 'f1-score': 0.3825913877229955, 'support': 26493}}
[[1618 2636 3843]
 [1671 4101 4280]
 [ 954 2600 4790]]
training model: results/LILAK/W0/deepVOL_L2/h50
Epoch 1/50
318/318 - 16s - loss: 3.3430 - accuracy50: 0.3525 - val_loss: 3.3356 - val_accuracy50: 0.3448 - 16s/epoch - 50ms/step
Epoch 2/50
318/318 - 12s - loss: 3.2899 - accuracy50: 0.3712 - val_loss: 3.3050 - val_accuracy50: 0.3660 - 12s/epoch - 38ms/step
Epoch 3/50
318/318 - 12s - loss: 3.2696 - accuracy50: 0.3855 - val_loss: 3.2930 - val_accuracy50: 0.3706 - 12s/epoch - 39ms/step
Epoch 4/50
318/318 - 12s - loss: 3.2574 - accuracy50: 0.3944 - val_loss: 3.3091 - val_accuracy50: 0.3655 - 12s/epoch - 36ms/step
Epoch 5/50
318/318 - 12s - loss: 3.2438 - accuracy50: 0.4032 - val_loss: 3.2969 - val_accuracy50: 0.3715 - 12s/epoch - 38ms/step
Epoch 6/50
318/318 - 12s - loss: 3.2342 - accuracy50: 0.4056 - val_loss: 3.3004 - val_accuracy50: 0.3684 - 12s/epoch - 38ms/step
Epoch 7/50
318/318 - 12s - loss: 3.2267 - accuracy50: 0.4142 - val_loss: 3.2982 - val_accuracy50: 0.3714 - 12s/epoch - 37ms/step
Epoch 8/50
318/318 - 12s - loss: 3.2170 - accuracy50: 0.4177 - val_loss: 3.3010 - val_accuracy50: 0.3746 - 12s/epoch - 36ms/step
Epoch 9/50
318/318 - 12s - loss: 3.2113 - accuracy50: 0.4199 - val_loss: 3.2983 - val_accuracy50: 0.3772 - 12s/epoch - 37ms/step
Epoch 10/50
318/318 - 11s - loss: 3.2039 - accuracy50: 0.4221 - val_loss: 3.3088 - val_accuracy50: 0.3732 - 11s/epoch - 35ms/step
Epoch 11/50
318/318 - 12s - loss: 3.2001 - accuracy50: 0.4250 - val_loss: 3.3067 - val_accuracy50: 0.3734 - 12s/epoch - 38ms/step
Epoch 12/50
318/318 - 11s - loss: 3.1940 - accuracy50: 0.4287 - val_loss: 3.3016 - val_accuracy50: 0.3761 - 11s/epoch - 35ms/step
Epoch 13/50
318/318 - 12s - loss: 3.1864 - accuracy50: 0.4324 - val_loss: 3.2849 - val_accuracy50: 0.3822 - 12s/epoch - 38ms/step
Epoch 14/50
318/318 - 12s - loss: 3.1830 - accuracy50: 0.4346 - val_loss: 3.2917 - val_accuracy50: 0.3793 - 12s/epoch - 37ms/step
Epoch 15/50
318/318 - 12s - loss: 3.1767 - accuracy50: 0.4354 - val_loss: 3.2810 - val_accuracy50: 0.3862 - 12s/epoch - 38ms/step
Epoch 16/50
318/318 - 12s - loss: 3.1666 - accuracy50: 0.4396 - val_loss: 3.2860 - val_accuracy50: 0.3857 - 12s/epoch - 39ms/step
Epoch 17/50
318/318 - 12s - loss: 3.1629 - accuracy50: 0.4427 - val_loss: 3.2812 - val_accuracy50: 0.3848 - 12s/epoch - 38ms/step
Epoch 18/50
318/318 - 12s - loss: 3.1561 - accuracy50: 0.4452 - val_loss: 3.2920 - val_accuracy50: 0.3823 - 12s/epoch - 37ms/step
Epoch 19/50
318/318 - 12s - loss: 3.1500 - accuracy50: 0.4464 - val_loss: 3.2905 - val_accuracy50: 0.3867 - 12s/epoch - 36ms/step
Epoch 20/50
318/318 - 13s - loss: 3.1406 - accuracy50: 0.4515 - val_loss: 3.2927 - val_accuracy50: 0.3857 - 13s/epoch - 39ms/step
Epoch 21/50
318/318 - 11s - loss: 3.1334 - accuracy50: 0.4535 - val_loss: 3.3113 - val_accuracy50: 0.3766 - 11s/epoch - 35ms/step
Epoch 22/50
318/318 - 12s - loss: 3.1260 - accuracy50: 0.4558 - val_loss: 3.3208 - val_accuracy50: 0.3771 - 12s/epoch - 38ms/step
Epoch 23/50
318/318 - 12s - loss: 3.1239 - accuracy50: 0.4545 - val_loss: 3.3156 - val_accuracy50: 0.3796 - 12s/epoch - 38ms/step
Epoch 24/50
318/318 - 12s - loss: 3.1117 - accuracy50: 0.4615 - val_loss: 3.3154 - val_accuracy50: 0.3810 - 12s/epoch - 36ms/step
Epoch 25/50
318/318 - 12s - loss: 3.1093 - accuracy50: 0.4610 - val_loss: 3.3295 - val_accuracy50: 0.3790 - 12s/epoch - 38ms/step
testing model: results/LILAK/W0/deepVOL_L2/h50
Evaluating performance on  test set...
876/876 - 17s - 17s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.083816
{'0': {'precision': 0.35952163778250734, 'recall': 0.290603751945605, 'f1-score': 0.32140980338860203, 'support': 61035}, '1': {'precision': 0.5015542012384658, 'recall': 0.40818684328469695, 'f1-score': 0.4500793437258056, 'support': 100405}, '2': {'precision': 0.3242648164457715, 'recall': 0.4813999840548513, 'f1-score': 0.3875087440075471, 'support': 62715}, 'accuracy': 0.3966541009569271, 'macro avg': {'precision': 0.3951135518222482, 'recall': 0.39339685976171773, 'f1-score': 0.3863326303739849, 'support': 224155}, 'weighted avg': {'precision': 0.4132775119930408, 'recall': 0.3966541009569271, 'f1-score': 0.39753775172111333, 'support': 224155}}
[[17737 20331 22967]
 [19473 40984 39948]
 [12125 20399 30191]]
Evaluating performance on  train set...
318/318 - 8s - 8s/epoch - 24ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0762373
{'0': {'precision': 0.4680295022939776, 'recall': 0.2912119679121197, 'f1-score': 0.35903147484017556, 'support': 27674}, '1': {'precision': 0.3924329761306047, 'recall': 0.37876185497722353, 'f1-score': 0.3854762402386426, 'support': 26782}, '2': {'precision': 0.3985587002096436, 'recall': 0.5680935305543104, 'f1-score': 0.4684593112794924, 'support': 26772}, 'accuracy': 0.41133599251489633, 'macro avg': {'precision': 0.4196737262114086, 'recall': 0.41268911781455125, 'f1-score': 0.40432234211943685, 'support': 81228}, 'weighted avg': {'precision': 0.4202073414983253, 'recall': 0.41133599251489633, 'f1-score': 0.40381708748673995, 'support': 81228}}
[[ 8059  8274 11341]
 [ 5028 10144 11610]
 [ 4132  7431 15209]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0939031
{'0': {'precision': 0.3787465940054496, 'recall': 0.21953590086259264, 'f1-score': 0.2779572373481003, 'support': 8231}, '1': {'precision': 0.41727401283585336, 'recall': 0.38908611421036615, 'f1-score': 0.4026873819021625, 'support': 9859}, '2': {'precision': 0.3621198818740522, 'recall': 0.5399262168273236, 'f1-score': 0.43349894897764185, 'support': 8403}, 'accuracy': 0.38425244404182235, 'macro avg': {'precision': 0.3860468295717851, 'recall': 0.3828494106334275, 'f1-score': 0.37138118940930154, 'support': 26493}, 'weighted avg': {'precision': 0.3878104055861999, 'recall': 0.38425244404182235, 'f1-score': 0.3737082469725874, 'support': 26493}}
[[1807 2696 3728]
 [1759 3836 4264]
 [1205 2661 4537]]
training model: results/LILAK/W0/deepVOL_L2/h100
Epoch 1/50
318/318 - 15s - loss: 3.3527 - accuracy100: 0.3530 - val_loss: 3.3806 - val_accuracy100: 0.3357 - 15s/epoch - 47ms/step
Epoch 2/50
318/318 - 12s - loss: 3.3082 - accuracy100: 0.3701 - val_loss: 3.4280 - val_accuracy100: 0.3266 - 12s/epoch - 36ms/step
Epoch 3/50
318/318 - 11s - loss: 3.2948 - accuracy100: 0.3714 - val_loss: 3.3375 - val_accuracy100: 0.3651 - 11s/epoch - 35ms/step
Epoch 4/50
318/318 - 11s - loss: 3.2813 - accuracy100: 0.3792 - val_loss: 3.3473 - val_accuracy100: 0.3475 - 11s/epoch - 34ms/step
Epoch 5/50
318/318 - 12s - loss: 3.2708 - accuracy100: 0.3867 - val_loss: 3.3439 - val_accuracy100: 0.3577 - 12s/epoch - 36ms/step
Epoch 6/50
318/318 - 12s - loss: 3.2640 - accuracy100: 0.3896 - val_loss: 3.3504 - val_accuracy100: 0.3447 - 12s/epoch - 37ms/step
Epoch 7/50
318/318 - 11s - loss: 3.2526 - accuracy100: 0.3978 - val_loss: 3.3651 - val_accuracy100: 0.3393 - 11s/epoch - 36ms/step
Epoch 8/50
318/318 - 12s - loss: 3.2465 - accuracy100: 0.4028 - val_loss: 3.3713 - val_accuracy100: 0.3468 - 12s/epoch - 37ms/step
Epoch 9/50
318/318 - 11s - loss: 3.2392 - accuracy100: 0.4070 - val_loss: 3.4003 - val_accuracy100: 0.3378 - 11s/epoch - 34ms/step
Epoch 10/50
318/318 - 13s - loss: 3.2339 - accuracy100: 0.4086 - val_loss: 3.4027 - val_accuracy100: 0.3394 - 13s/epoch - 39ms/step
Epoch 11/50
318/318 - 14s - loss: 3.2274 - accuracy100: 0.4124 - val_loss: 3.4078 - val_accuracy100: 0.3353 - 14s/epoch - 44ms/step
Epoch 12/50
318/318 - 12s - loss: 3.2233 - accuracy100: 0.4161 - val_loss: 3.4102 - val_accuracy100: 0.3339 - 12s/epoch - 37ms/step
Epoch 13/50
318/318 - 12s - loss: 3.2210 - accuracy100: 0.4170 - val_loss: 3.3958 - val_accuracy100: 0.3427 - 12s/epoch - 37ms/step
testing model: results/LILAK/W0/deepVOL_L2/h100
Evaluating performance on  test set...
876/876 - 17s - 17s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0959512
{'0': {'precision': 0.2805003182190126, 'recall': 0.378173922179806, 'f1-score': 0.3220951997434693, 'support': 57106}, '1': {'precision': 0.49695201850438114, 'recall': 0.3995565978965884, 'f1-score': 0.4429638582361276, 'support': 109156}, '2': {'precision': 0.2766283395902426, 'recall': 0.2838339695645415, 'f1-score': 0.2801848346889014, 'support': 57893}, 'accuracy': 0.36422118623274075, 'macro avg': {'precision': 0.35136022543787876, 'recall': 0.35385482988031197, 'f1-score': 0.34841463088949937, 'support': 224155}, 'weighted avg': {'precision': 0.38490504413453674, 'recall': 0.36422118623274075, 'f1-score': 0.37012991912211585, 'support': 224155}}
[[21596 21685 13825]
 [36398 43614 29144]
 [18997 22464 16432]]
Evaluating performance on  train set...
318/318 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1051601
{'0': {'precision': 0.4110134511727286, 'recall': 0.2927807949081601, 'f1-score': 0.3419659811724779, 'support': 28909}, '1': {'precision': 0.3094098025501695, 'recall': 0.4627640313820157, 'f1-score': 0.3708587918554225, 'support': 24855}, '2': {'precision': 0.36157879033289286, 'recall': 0.3088770754442179, 'f1-score': 0.3331566028473245, 'support': 27464}, 'accuracy': 0.35023637169448957, 'macro avg': {'precision': 0.36066734801859696, 'recall': 0.3548073005781312, 'f1-score': 0.348660458625075, 'support': 81228}, 'weighted avg': {'precision': 0.3632093416068282, 'recall': 0.35023637169448957, 'f1-score': 0.34782836905846026, 'support': 81228}}
[[ 8464 12784  7661]
 [ 6036 11502  7317]
 [ 6093 12888  8483]]
Evaluating performance on  val set...
104/104 - 3s - 3s/epoch - 26ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1015862
{'0': {'precision': 0.29921364787418364, 'recall': 0.2927751695357329, 'f1-score': 0.29595939621646555, 'support': 7668}, '1': {'precision': 0.4144216235440562, 'recall': 0.41855244252873564, 'f1-score': 0.4164767904213019, 'support': 11136}, '2': {'precision': 0.3292005682551982, 'recall': 0.33151255039667055, 'f1-score': 0.3303525142560912, 'support': 7689}, 'accuracy': 0.3568867247952289, 'macro avg': {'precision': 0.3476119465578127, 'recall': 0.34761338748704634, 'f1-score': 0.3475962336312863, 'support': 26493}, 'weighted avg': {'precision': 0.35634290646586153, 'recall': 0.3568867247952289, 'f1-score': 0.35659920244723364, 'support': 26493}}
[[2245 3262 2161]
 [3442 4661 3033]
 [1816 3324 2549]]
training model: results/LILAK/W0/deepVOL_L2/h200
Epoch 1/50
318/318 - 15s - loss: 3.3475 - accuracy200: 0.3557 - val_loss: 3.3588 - val_accuracy200: 0.3367 - 15s/epoch - 47ms/step
Epoch 2/50
318/318 - 13s - loss: 3.3029 - accuracy200: 0.3611 - val_loss: 3.3443 - val_accuracy200: 0.3395 - 13s/epoch - 40ms/step
Epoch 3/50
318/318 - 13s - loss: 3.2899 - accuracy200: 0.3684 - val_loss: 3.3041 - val_accuracy200: 0.3541 - 13s/epoch - 39ms/step
Epoch 4/50
318/318 - 12s - loss: 3.2806 - accuracy200: 0.3770 - val_loss: 3.3127 - val_accuracy200: 0.3479 - 12s/epoch - 37ms/step
Epoch 5/50
318/318 - 12s - loss: 3.2714 - accuracy200: 0.3800 - val_loss: 3.3125 - val_accuracy200: 0.3500 - 12s/epoch - 37ms/step
Epoch 6/50
318/318 - 12s - loss: 3.2621 - accuracy200: 0.3864 - val_loss: 3.3146 - val_accuracy200: 0.3548 - 12s/epoch - 38ms/step
Epoch 7/50
318/318 - 12s - loss: 3.2570 - accuracy200: 0.3898 - val_loss: 3.3202 - val_accuracy200: 0.3499 - 12s/epoch - 39ms/step
Epoch 8/50
318/318 - 12s - loss: 3.2524 - accuracy200: 0.3936 - val_loss: 3.3151 - val_accuracy200: 0.3516 - 12s/epoch - 38ms/step
Epoch 9/50
318/318 - 13s - loss: 3.2426 - accuracy200: 0.4015 - val_loss: 3.3234 - val_accuracy200: 0.3600 - 13s/epoch - 40ms/step
Epoch 10/50
318/318 - 12s - loss: 3.2440 - accuracy200: 0.4006 - val_loss: 3.3123 - val_accuracy200: 0.3594 - 12s/epoch - 37ms/step
Epoch 11/50
318/318 - 12s - loss: 3.2377 - accuracy200: 0.4032 - val_loss: 3.3308 - val_accuracy200: 0.3561 - 12s/epoch - 36ms/step
Epoch 12/50
318/318 - 12s - loss: 3.2327 - accuracy200: 0.4058 - val_loss: 3.3444 - val_accuracy200: 0.3619 - 12s/epoch - 36ms/step
Epoch 13/50
318/318 - 12s - loss: 3.2285 - accuracy200: 0.4077 - val_loss: 3.3447 - val_accuracy200: 0.3552 - 12s/epoch - 37ms/step
testing model: results/LILAK/W0/deepVOL_L2/h200
Evaluating performance on  test set...
876/876 - 18s - 18s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.10321
{'0': {'precision': 0.33501756484042156, 'recall': 0.31466842644725573, 'f1-score': 0.3245243128964059, 'support': 71221}, '1': {'precision': 0.3526980894771516, 'recall': 0.5217110675188256, 'f1-score': 0.4208704707648014, 'support': 79015}, '2': {'precision': 0.3552908546098413, 'recall': 0.19409082915082726, 'f1-score': 0.2510411198600175, 'support': 73919}, 'accuracy': 0.347888737703821, 'macro avg': {'precision': 0.3476688363091381, 'recall': 0.3434901077056362, 'f1-score': 0.3321453011737416, 'support': 224155}, 'weighted avg': {'precision': 0.3479354473799008, 'recall': 0.347888737703821, 'f1-score': 0.3342541316285978, 'support': 224155}}
[[22411 36735 12075]
 [23833 41223 13959]
 [20651 38921 14347]]
Evaluating performance on  train set...
318/318 - 7s - 7s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0966412
{'0': {'precision': 0.3957588273812522, 'recall': 0.2851802112446009, 'f1-score': 0.33149101341658926, 'support': 27551}, '1': {'precision': 0.33532721086922684, 'recall': 0.5630647449779703, 'f1-score': 0.4203308572463869, 'support': 26782}, '2': {'precision': 0.37832236039990247, 'recall': 0.2307492098903142, 'f1-score': 0.28665789048245915, 'support': 26895}, 'accuracy': 0.3587802235682277, 'macro avg': {'precision': 0.3698027995501272, 'recall': 0.3596647220376285, 'f1-score': 0.34615992038181176, 'support': 81228}, 'weighted avg': {'precision': 0.37006038185891427, 'recall': 0.3587802235682277, 'f1-score': 0.34593827121114545, 'support': 81228}}
[[ 7857 14919  4775]
 [ 6279 15080  5423]
 [ 5717 14972  6206]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1024077
{'0': {'precision': 0.33674339300937767, 'recall': 0.22612777650561025, 'f1-score': 0.27056647715596954, 'support': 8734}, '1': {'precision': 0.35428927508135427, 'recall': 0.5579544215461781, 'f1-score': 0.43338697382908437, 'support': 9171}, '2': {'precision': 0.3805982215036378, 'recall': 0.27410340009315326, 'f1-score': 0.3186895011169024, 'support': 8588}, 'accuracy': 0.35654701241837466, 'macro avg': {'precision': 0.3572102965314566, 'recall': 0.3527285327149805, 'f1-score': 0.3408809840339854, 'support': 26493}, 'weighted avg': {'precision': 0.35703322623290096, 'recall': 0.35654701241837466, 'f1-score': 0.34252915804396367, 'support': 26493}}
[[1975 4771 1988]
 [2211 5117 1843]
 [1679 4555 2354]]
training model: results/LILAK/W0/deepVOL_L2/h300
Epoch 1/50
318/318 - 14s - loss: 3.3481 - accuracy300: 0.3579 - val_loss: 3.3419 - val_accuracy300: 0.3475 - 14s/epoch - 44ms/step
Epoch 2/50
318/318 - 13s - loss: 3.3101 - accuracy300: 0.3647 - val_loss: 3.3126 - val_accuracy300: 0.3582 - 13s/epoch - 40ms/step
Epoch 3/50
318/318 - 12s - loss: 3.2846 - accuracy300: 0.3732 - val_loss: 3.3173 - val_accuracy300: 0.3563 - 12s/epoch - 38ms/step
Epoch 4/50
318/318 - 12s - loss: 3.2782 - accuracy300: 0.3767 - val_loss: 3.3023 - val_accuracy300: 0.3564 - 12s/epoch - 39ms/step
Epoch 5/50
318/318 - 12s - loss: 3.2714 - accuracy300: 0.3819 - val_loss: 3.3118 - val_accuracy300: 0.3461 - 12s/epoch - 38ms/step
Epoch 6/50
318/318 - 11s - loss: 3.2620 - accuracy300: 0.3889 - val_loss: 3.3099 - val_accuracy300: 0.3547 - 11s/epoch - 36ms/step
Epoch 7/50
318/318 - 12s - loss: 3.2577 - accuracy300: 0.3895 - val_loss: 3.3222 - val_accuracy300: 0.3471 - 12s/epoch - 37ms/step
Epoch 8/50
318/318 - 12s - loss: 3.2478 - accuracy300: 0.3950 - val_loss: 3.3389 - val_accuracy300: 0.3451 - 12s/epoch - 38ms/step
Epoch 9/50
318/318 - 12s - loss: 3.2442 - accuracy300: 0.3986 - val_loss: 3.3453 - val_accuracy300: 0.3455 - 12s/epoch - 38ms/step
Epoch 10/50
318/318 - 12s - loss: 3.2414 - accuracy300: 0.3990 - val_loss: 3.3419 - val_accuracy300: 0.3451 - 12s/epoch - 39ms/step
Epoch 11/50
318/318 - 12s - loss: 3.2379 - accuracy300: 0.4018 - val_loss: 3.3500 - val_accuracy300: 0.3462 - 12s/epoch - 36ms/step
Epoch 12/50
318/318 - 12s - loss: 3.2304 - accuracy300: 0.4100 - val_loss: 3.3753 - val_accuracy300: 0.3401 - 12s/epoch - 39ms/step
Epoch 13/50
318/318 - 12s - loss: 3.2269 - accuracy300: 0.4081 - val_loss: 3.3634 - val_accuracy300: 0.3462 - 12s/epoch - 39ms/step
Epoch 14/50
318/318 - 12s - loss: 3.2181 - accuracy300: 0.4149 - val_loss: 3.3736 - val_accuracy300: 0.3463 - 12s/epoch - 38ms/step
testing model: results/LILAK/W0/deepVOL_L2/h300
Evaluating performance on  test set...
876/876 - 18s - 18s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1004481
{'0': {'precision': 0.2903445004295037, 'recall': 0.35208333333333336, 'f1-score': 0.31824729301488935, 'support': 64320}, '1': {'precision': 0.4086590949828089, 'recall': 0.5445918655403792, 'f1-score': 0.4669335319307392, 'support': 92102}, '2': {'precision': 0.32916310845431257, 'recall': 0.11381453648886067, 'f1-score': 0.1691441861485634, 'support': 67733}, 'accuracy': 0.35918449287323506, 'macro avg': {'precision': 0.34272223462220835, 'recall': 0.3368299117875244, 'f1-score': 0.31810833703139735, 'support': 224155}, 'weighted avg': {'precision': 0.3506880643245446, 'recall': 0.35918449287323506, 'f1-score': 0.3342857451540375, 'support': 224155}}
[[22646 35217  6457]
 [32690 50158  9254]
 [22661 37363  7709]]
Evaluating performance on  train set...
318/318 - 7s - 7s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1018649
{'0': {'precision': 0.3938337558855487, 'recall': 0.3110229182308985, 'f1-score': 0.34756377729388493, 'support': 27969}, '1': {'precision': 0.3250649657453343, 'recall': 0.6396529015263036, 'f1-score': 0.43106644041247877, 'support': 25814}, '2': {'precision': 0.39058005752636626, 'recall': 0.1187465840772454, 'f1-score': 0.18212299868674733, 'support': 27445}, 'accuracy': 0.35049490323533755, 'macro avg': {'precision': 0.36982625971908306, 'recall': 0.35647413461148253, 'f1-score': 0.32025107213103704, 'support': 81228}, 'weighted avg': {'precision': 0.3708799062259823, 'recall': 0.35049490323533755, 'f1-score': 0.31820217263626055, 'support': 81228}}
[[ 8699 16726  2544]
 [ 6761 16512  2541]
 [ 6628 17558  3259]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979042
{'0': {'precision': 0.31088082901554404, 'recall': 0.2757286249848833, 'f1-score': 0.29225149009805806, 'support': 8269}, '1': {'precision': 0.3697883258499038, 'recall': 0.5742031872509961, 'f1-score': 0.4498634412797503, 'support': 10040}, '2': {'precision': 0.3813393107312973, 'recall': 0.16630009775171065, 'f1-score': 0.231600442440228, 'support': 8184}, 'accuracy': 0.3550371796323557, 'macro avg': {'precision': 0.3540028218655817, 'recall': 0.33874396999586337, 'f1-score': 0.3245717912726788, 'support': 26493}, 'weighted avg': {'precision': 0.35497034256926374, 'recall': 0.3550371796323557, 'f1-score': 0.33324555705282005, 'support': 26493}}
[[2280 4934 1055]
 [3122 5765 1153]
 [1932 4891 1361]]
training model: results/LILAK/W0/deepVOL_L2/h500
Epoch 1/50
318/318 - 15s - loss: 3.3461 - accuracy500: 0.3549 - val_loss: 3.3805 - val_accuracy500: 0.3279 - 15s/epoch - 47ms/step
Epoch 2/50
318/318 - 12s - loss: 3.3094 - accuracy500: 0.3674 - val_loss: 3.3573 - val_accuracy500: 0.3301 - 12s/epoch - 37ms/step
Epoch 3/50
318/318 - 11s - loss: 3.3032 - accuracy500: 0.3622 - val_loss: 3.3485 - val_accuracy500: 0.3234 - 11s/epoch - 36ms/step
Epoch 4/50
318/318 - 12s - loss: 3.2940 - accuracy500: 0.3636 - val_loss: 3.3363 - val_accuracy500: 0.3285 - 12s/epoch - 37ms/step
Epoch 5/50
318/318 - 12s - loss: 3.2854 - accuracy500: 0.3696 - val_loss: 3.3152 - val_accuracy500: 0.3502 - 12s/epoch - 39ms/step
Epoch 6/50
318/318 - 11s - loss: 3.2744 - accuracy500: 0.3748 - val_loss: 3.3241 - val_accuracy500: 0.3339 - 11s/epoch - 35ms/step
Epoch 7/50
318/318 - 12s - loss: 3.2686 - accuracy500: 0.3795 - val_loss: 3.3257 - val_accuracy500: 0.3387 - 12s/epoch - 38ms/step
Epoch 8/50
318/318 - 12s - loss: 3.2656 - accuracy500: 0.3820 - val_loss: 3.3279 - val_accuracy500: 0.3359 - 12s/epoch - 36ms/step
Epoch 9/50
318/318 - 12s - loss: 3.2646 - accuracy500: 0.3856 - val_loss: 3.3327 - val_accuracy500: 0.3345 - 12s/epoch - 37ms/step
Epoch 10/50
318/318 - 12s - loss: 3.2615 - accuracy500: 0.3861 - val_loss: 3.3247 - val_accuracy500: 0.3463 - 12s/epoch - 38ms/step
Epoch 11/50
318/318 - 12s - loss: 3.2538 - accuracy500: 0.3918 - val_loss: 3.3391 - val_accuracy500: 0.3461 - 12s/epoch - 39ms/step
Epoch 12/50
318/318 - 12s - loss: 3.2469 - accuracy500: 0.3977 - val_loss: 3.3370 - val_accuracy500: 0.3471 - 12s/epoch - 39ms/step
Epoch 13/50
318/318 - 12s - loss: 3.2406 - accuracy500: 0.4009 - val_loss: 3.3407 - val_accuracy500: 0.3512 - 12s/epoch - 37ms/step
Epoch 14/50
318/318 - 13s - loss: 3.2350 - accuracy500: 0.4052 - val_loss: 3.3369 - val_accuracy500: 0.3568 - 13s/epoch - 40ms/step
Epoch 15/50
318/318 - 11s - loss: 3.2265 - accuracy500: 0.4102 - val_loss: 3.3489 - val_accuracy500: 0.3546 - 11s/epoch - 36ms/step
testing model: results/LILAK/W0/deepVOL_L2/h500
Evaluating performance on  test set...
876/876 - 18s - 18s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1094474
{'0': {'precision': 0.3102930373030773, 'recall': 0.27654992797800054, 'f1-score': 0.2924513786312161, 'support': 68729}, '1': {'precision': 0.3643587537802531, 'recall': 0.5155800966304825, 'f1-score': 0.42697540038037435, 'support': 79685}, '2': {'precision': 0.35662006660949686, 'recall': 0.2360940573797547, 'f1-score': 0.2841028248228528, 'support': 75741}, 'accuracy': 0.34785304811402823, 'macro avg': {'precision': 0.34375728589760907, 'recall': 0.3427413606627459, 'f1-score': 0.3345098679448144, 'support': 224155}, 'weighted avg': {'precision': 0.34516659419086154, 'recall': 0.34785304811402823, 'f1-score': 0.3374524665350435, 'support': 224155}}
[[19007 34549 15173]
 [21513 41084 17088]
 [20735 37124 17882]]
Evaluating performance on  train set...
318/318 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0974679
{'0': {'precision': 0.38844586213007265, 'recall': 0.238736612815393, 'f1-score': 0.2957233439762558, 'support': 27545}, '1': {'precision': 0.3334766439519336, 'recall': 0.5865471869328494, 'f1-score': 0.4252059150026724, 'support': 26448}, '2': {'precision': 0.37305961754780653, 'recall': 0.24354690655406647, 'f1-score': 0.29470176607797405, 'support': 27235}, 'accuracy': 0.35359728172551336, 'macro avg': {'precision': 0.36499404120993756, 'recall': 0.3562769021007696, 'f1-score': 0.3385436750189674, 'support': 81228}, 'weighted avg': {'precision': 0.3653889082031824, 'recall': 0.35359728172551336, 'f1-score': 0.33754060359666954, 'support': 81228}}
[[ 6576 15504  5465]
 [ 5253 15513  5682]
 [ 5100 15502  6633]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1068437
{'0': {'precision': 0.33499643620812547, 'recall': 0.20930750389668226, 'f1-score': 0.25764012607921066, 'support': 8982}, '1': {'precision': 0.33326215388995656, 'recall': 0.5474102654039519, 'f1-score': 0.4142996195026989, 'support': 8553}, '2': {'precision': 0.38436768149882905, 'recall': 0.29314579147131054, 'f1-score': 0.332615579480684, 'support': 8958}, 'accuracy': 0.34680859094855243, 'macro avg': {'precision': 0.350875423865637, 'recall': 0.3499545202573149, 'f1-score': 0.33485177502086455, 'support': 26493}, 'weighted avg': {'precision': 0.3511302941572752, 'recall': 0.34680859094855243, 'f1-score': 0.33356730528962447, 'support': 26493}}
[[1880 4800 2302]
 [1967 4682 1904]
 [1765 4567 2626]]
training model: results/LILAK/W0/deepVOL_L2/h1000
Epoch 1/50
318/318 - 15s - loss: 3.3577 - accuracy1000: 0.3521 - val_loss: 3.3480 - val_accuracy1000: 0.3331 - 15s/epoch - 48ms/step
Epoch 2/50
318/318 - 12s - loss: 3.3151 - accuracy1000: 0.3660 - val_loss: 3.3637 - val_accuracy1000: 0.3177 - 12s/epoch - 36ms/step
Epoch 3/50
318/318 - 11s - loss: 3.3093 - accuracy1000: 0.3561 - val_loss: 3.3199 - val_accuracy1000: 0.3590 - 11s/epoch - 36ms/step
Epoch 4/50
318/318 - 11s - loss: 3.2892 - accuracy1000: 0.3674 - val_loss: 3.3275 - val_accuracy1000: 0.3530 - 11s/epoch - 36ms/step
Epoch 5/50
318/318 - 12s - loss: 3.2793 - accuracy1000: 0.3765 - val_loss: 3.3414 - val_accuracy1000: 0.3547 - 12s/epoch - 37ms/step
Epoch 6/50
318/318 - 11s - loss: 3.2698 - accuracy1000: 0.3835 - val_loss: 3.3550 - val_accuracy1000: 0.3432 - 11s/epoch - 35ms/step
Epoch 7/50
318/318 - 12s - loss: 3.2669 - accuracy1000: 0.3852 - val_loss: 3.3673 - val_accuracy1000: 0.3472 - 12s/epoch - 38ms/step
Epoch 8/50
318/318 - 12s - loss: 3.2614 - accuracy1000: 0.3876 - val_loss: 3.3854 - val_accuracy1000: 0.3530 - 12s/epoch - 37ms/step
Epoch 9/50
318/318 - 11s - loss: 3.2545 - accuracy1000: 0.3935 - val_loss: 3.3948 - val_accuracy1000: 0.3490 - 11s/epoch - 35ms/step
Epoch 10/50
318/318 - 12s - loss: 3.2467 - accuracy1000: 0.4005 - val_loss: 3.4143 - val_accuracy1000: 0.3408 - 12s/epoch - 38ms/step
Epoch 11/50
318/318 - 13s - loss: 3.2424 - accuracy1000: 0.4014 - val_loss: 3.4323 - val_accuracy1000: 0.3391 - 13s/epoch - 40ms/step
Epoch 12/50
318/318 - 12s - loss: 3.2351 - accuracy1000: 0.4042 - val_loss: 3.4729 - val_accuracy1000: 0.3296 - 12s/epoch - 36ms/step
Epoch 13/50
318/318 - 12s - loss: 3.2326 - accuracy1000: 0.4077 - val_loss: 3.4628 - val_accuracy1000: 0.3258 - 12s/epoch - 36ms/step
testing model: results/LILAK/W0/deepVOL_L2/h1000
Evaluating performance on  test set...
876/876 - 17s - 17s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.10504
{'0': {'precision': 0.31375515245721897, 'recall': 0.3271493278150008, 'f1-score': 0.32031227861373235, 'support': 69103}, '1': {'precision': 0.3771589957565178, 'recall': 0.3417127427028417, 'f1-score': 0.35856197421591973, 'support': 77770}, '2': {'precision': 0.3874523829938389, 'recall': 0.4093061773763619, 'f1-score': 0.39807957312660847, 'support': 77282}, 'accuracy': 0.3605273136891883, 'macro avg': {'precision': 0.3594555104025252, 'recall': 0.35938941596473484, 'f1-score': 0.35898460865208687, 'support': 224155}, 'weighted avg': {'precision': 0.36116157329867926, 'recall': 0.3605273136891883, 'f1-score': 0.36039477011080445, 'support': 224155}}
[[22607 21514 24982]
 [26168 26575 25027]
 [23278 22372 31632]]
Evaluating performance on  train set...
318/318 - 7s - 7s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0970261
{'0': {'precision': 0.3769179821172315, 'recall': 0.25129714811407544, 'f1-score': 0.3015477005276754, 'support': 27175}, '1': {'precision': 0.35611305176246427, 'recall': 0.40965880032147295, 'f1-score': 0.38101386246262575, 'support': 27374}, '2': {'precision': 0.3660025300442758, 'recall': 0.43378687357097345, 'f1-score': 0.39702224737988645, 'support': 26679}, 'accuracy': 0.3646033387501847, 'macro avg': {'precision': 0.3663445213079905, 'recall': 0.36491427400217397, 'f1-score': 0.35986127012339586, 'support': 81228}, 'weighted avg': {'precision': 0.3663215435814337, 'recall': 0.3646033387501847, 'f1-score': 0.35968617682005566, 'support': 81228}}
[[ 6829 10357  9989]
 [ 6102 11214 10058]
 [ 5187  9919 11573]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1075534
{'0': {'precision': 0.32588832487309644, 'recall': 0.21404756612580572, 'f1-score': 0.2583847598604776, 'support': 8998}, '1': {'precision': 0.3249863908546543, 'recall': 0.36901965632340217, 'f1-score': 0.3456061132337617, 'support': 8089}, '2': {'precision': 0.3937532900508861, 'recall': 0.4771422496278971, 'f1-score': 0.4314554893289752, 'support': 9406}, 'accuracy': 0.3547729588948024, 'macro avg': {'precision': 0.34820933525954567, 'recall': 0.353403157359035, 'f1-score': 0.34514878747440486, 'support': 26493}, 'weighted avg': {'precision': 0.3497075268580401, 'recall': 0.3547729588948024, 'f1-score': 0.34646224481186794, 'support': 26493}}
[[1926 3160 3912]
 [2106 2985 2998]
 [1878 3040 4488]]
training model: results/LILAK/W0/deepVOL_L3/h10
Epoch 1/50
318/318 - 19s - loss: 3.3452 - accuracy10: 0.3485 - val_loss: 3.2485 - val_accuracy10: 0.3744 - 19s/epoch - 60ms/step
Epoch 2/50
318/318 - 16s - loss: 3.3141 - accuracy10: 0.3515 - val_loss: 3.2211 - val_accuracy10: 0.4240 - 16s/epoch - 50ms/step
Epoch 3/50
318/318 - 15s - loss: 3.2999 - accuracy10: 0.3550 - val_loss: 3.2150 - val_accuracy10: 0.4769 - 15s/epoch - 47ms/step
Epoch 4/50
318/318 - 15s - loss: 3.2850 - accuracy10: 0.3545 - val_loss: 3.2138 - val_accuracy10: 0.3975 - 15s/epoch - 47ms/step
Epoch 5/50
318/318 - 15s - loss: 3.2724 - accuracy10: 0.3521 - val_loss: 3.2045 - val_accuracy10: 0.3906 - 15s/epoch - 48ms/step
Epoch 6/50
318/318 - 15s - loss: 3.2592 - accuracy10: 0.3566 - val_loss: 3.2018 - val_accuracy10: 0.4014 - 15s/epoch - 48ms/step
Epoch 7/50
318/318 - 15s - loss: 3.2445 - accuracy10: 0.3619 - val_loss: 3.1926 - val_accuracy10: 0.4164 - 15s/epoch - 46ms/step
Epoch 8/50
318/318 - 15s - loss: 3.2295 - accuracy10: 0.3690 - val_loss: 3.1924 - val_accuracy10: 0.3841 - 15s/epoch - 46ms/step
Epoch 9/50
318/318 - 15s - loss: 3.2137 - accuracy10: 0.3765 - val_loss: 3.1926 - val_accuracy10: 0.3626 - 15s/epoch - 46ms/step
Epoch 10/50
318/318 - 15s - loss: 3.1997 - accuracy10: 0.3829 - val_loss: 3.2347 - val_accuracy10: 0.3506 - 15s/epoch - 49ms/step
Epoch 11/50
318/318 - 15s - loss: 3.1867 - accuracy10: 0.3876 - val_loss: 3.1933 - val_accuracy10: 0.3556 - 15s/epoch - 46ms/step
Epoch 12/50
318/318 - 15s - loss: 3.1733 - accuracy10: 0.3976 - val_loss: 3.1991 - val_accuracy10: 0.3741 - 15s/epoch - 47ms/step
Epoch 13/50
318/318 - 15s - loss: 3.1617 - accuracy10: 0.4055 - val_loss: 3.2253 - val_accuracy10: 0.3471 - 15s/epoch - 47ms/step
Epoch 14/50
318/318 - 15s - loss: 3.1457 - accuracy10: 0.4165 - val_loss: 3.1832 - val_accuracy10: 0.3863 - 15s/epoch - 47ms/step
Epoch 15/50
318/318 - 15s - loss: 3.1366 - accuracy10: 0.4223 - val_loss: 3.2060 - val_accuracy10: 0.4025 - 15s/epoch - 48ms/step
Epoch 16/50
318/318 - 15s - loss: 3.1283 - accuracy10: 0.4291 - val_loss: 3.1815 - val_accuracy10: 0.4052 - 15s/epoch - 48ms/step
Epoch 17/50
318/318 - 15s - loss: 3.1165 - accuracy10: 0.4364 - val_loss: 3.1931 - val_accuracy10: 0.3929 - 15s/epoch - 46ms/step
Epoch 18/50
318/318 - 15s - loss: 3.1074 - accuracy10: 0.4407 - val_loss: 3.1712 - val_accuracy10: 0.4092 - 15s/epoch - 47ms/step
Epoch 19/50
318/318 - 15s - loss: 3.1016 - accuracy10: 0.4465 - val_loss: 3.1429 - val_accuracy10: 0.4104 - 15s/epoch - 49ms/step
Epoch 20/50
318/318 - 16s - loss: 3.0926 - accuracy10: 0.4499 - val_loss: 3.1299 - val_accuracy10: 0.4274 - 16s/epoch - 49ms/step
Epoch 21/50
318/318 - 15s - loss: 3.0836 - accuracy10: 0.4560 - val_loss: 3.1378 - val_accuracy10: 0.4195 - 15s/epoch - 46ms/step
Epoch 22/50
318/318 - 15s - loss: 3.0729 - accuracy10: 0.4583 - val_loss: 3.1400 - val_accuracy10: 0.4216 - 15s/epoch - 48ms/step
Epoch 23/50
318/318 - 15s - loss: 3.0622 - accuracy10: 0.4654 - val_loss: 3.1297 - val_accuracy10: 0.4409 - 15s/epoch - 48ms/step
Epoch 24/50
318/318 - 16s - loss: 3.0585 - accuracy10: 0.4653 - val_loss: 3.1223 - val_accuracy10: 0.4231 - 16s/epoch - 49ms/step
Epoch 25/50
318/318 - 15s - loss: 3.0496 - accuracy10: 0.4665 - val_loss: 3.1298 - val_accuracy10: 0.4428 - 15s/epoch - 48ms/step
Epoch 26/50
318/318 - 15s - loss: 3.0400 - accuracy10: 0.4731 - val_loss: 3.1384 - val_accuracy10: 0.4312 - 15s/epoch - 47ms/step
Epoch 27/50
318/318 - 15s - loss: 3.0338 - accuracy10: 0.4760 - val_loss: 3.1327 - val_accuracy10: 0.4378 - 15s/epoch - 48ms/step
Epoch 28/50
318/318 - 15s - loss: 3.0267 - accuracy10: 0.4760 - val_loss: 3.1442 - val_accuracy10: 0.4295 - 15s/epoch - 47ms/step
Epoch 29/50
318/318 - 15s - loss: 3.0204 - accuracy10: 0.4786 - val_loss: 3.1340 - val_accuracy10: 0.4469 - 15s/epoch - 46ms/step
Epoch 30/50
318/318 - 15s - loss: 3.0148 - accuracy10: 0.4824 - val_loss: 3.1551 - val_accuracy10: 0.4391 - 15s/epoch - 47ms/step
Epoch 31/50
318/318 - 15s - loss: 3.0061 - accuracy10: 0.4836 - val_loss: 3.1697 - val_accuracy10: 0.4304 - 15s/epoch - 47ms/step
Epoch 32/50
318/318 - 15s - loss: 2.9978 - accuracy10: 0.4876 - val_loss: 3.1679 - val_accuracy10: 0.4386 - 15s/epoch - 46ms/step
Epoch 33/50
318/318 - 16s - loss: 2.9918 - accuracy10: 0.4897 - val_loss: 3.1828 - val_accuracy10: 0.4347 - 16s/epoch - 50ms/step
Epoch 34/50
318/318 - 16s - loss: 2.9893 - accuracy10: 0.4907 - val_loss: 3.1531 - val_accuracy10: 0.4501 - 16s/epoch - 50ms/step
testing model: results/LILAK/W0/deepVOL_L3/h10
Evaluating performance on  test set...
876/876 - 21s - 21s/epoch - 23ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0230917
{'0': {'precision': 0.2992098982195276, 'recall': 0.48695166871302603, 'f1-score': 0.37066365327918294, 'support': 44795}, '1': {'precision': 0.7067559316120028, 'recall': 0.48643172335124424, 'f1-score': 0.5762522003520563, 'support': 133252}, '2': {'precision': 0.3188727095614786, 'recall': 0.41177236054480787, 'f1-score': 0.35941655860443544, 'support': 46108}, 'accuracy': 0.47117842564297024, 'macro avg': {'precision': 0.44161284646433635, 'recall': 0.46171858420302603, 'f1-score': 0.4354441374118916, 'support': 224155}, 'weighted avg': {'precision': 0.5455257820810019, 'recall': 0.47117842564297024, 'f1-score': 0.4905650787806942, 'support': 224155}}
[[21813 12617 10365]
 [38244 64818 30190]
 [12845 14277 18986]]
Evaluating performance on  train set...
318/318 - 8s - 8s/epoch - 24ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0358018
{'0': {'precision': 0.37609600237776786, 'recall': 0.4763764705882353, 'f1-score': 0.42033799775775443, 'support': 21250}, '1': {'precision': 0.600048166242345, 'recall': 0.4450029341974332, 'f1-score': 0.5110241872866582, 'support': 39193}, '2': {'precision': 0.3796244949695001, 'recall': 0.4611017560740919, 'f1-score': 0.4164150246572962, 'support': 20785}, 'accuracy': 0.45732998473432807, 'macro avg': {'precision': 0.4519228878632043, 'recall': 0.46082705361992016, 'f1-score': 0.44925906990056963, 'support': 81228}, 'weighted avg': {'precision': 0.48505715957557555, 'recall': 0.45732998473432807, 'f1-score': 0.4630908025826092, 'support': 81228}}
[[10123  5721  5406]
 [11496 17441 10256]
 [ 5297  5904  9584]]
Evaluating performance on  val set...
104/104 - 3s - 3s/epoch - 28ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.062464
{'0': {'precision': 0.3108528988979396, 'recall': 0.4159987175376723, 'f1-score': 0.355820649938297, 'support': 6238}, '1': {'precision': 0.6105795075798301, 'recall': 0.4141627771295216, 'f1-score': 0.4935471255377396, 'support': 13712}, '2': {'precision': 0.32903663500678426, 'recall': 0.4447501146263182, 'f1-score': 0.378241372587249, 'support': 6543}, 'accuracy': 0.42214924697089795, 'macro avg': {'precision': 0.4168230138281846, 'recall': 0.42497053643117066, 'f1-score': 0.4092030493544285, 'support': 26493}, 'weighted avg': {'precision': 0.4704734569172751, 'recall': 0.42214924697089795, 'f1-score': 0.4326411014429077, 'support': 26493}}
[[2595 1744 1899]
 [3998 5679 4035]
 [1755 1878 2910]]
training model: results/LILAK/W0/deepVOL_L3/h20
Epoch 1/50
318/318 - 18s - loss: 3.3420 - accuracy20: 0.3458 - val_loss: 3.2977 - val_accuracy20: 0.3580 - 18s/epoch - 56ms/step
Epoch 2/50
318/318 - 15s - loss: 3.3098 - accuracy20: 0.3506 - val_loss: 3.2639 - val_accuracy20: 0.3854 - 15s/epoch - 49ms/step
Epoch 3/50
318/318 - 15s - loss: 3.2893 - accuracy20: 0.3608 - val_loss: 3.2595 - val_accuracy20: 0.3875 - 15s/epoch - 48ms/step
Epoch 4/50
318/318 - 15s - loss: 3.2757 - accuracy20: 0.3701 - val_loss: 3.2557 - val_accuracy20: 0.3925 - 15s/epoch - 47ms/step
Epoch 5/50
318/318 - 15s - loss: 3.2615 - accuracy20: 0.3803 - val_loss: 3.2530 - val_accuracy20: 0.3893 - 15s/epoch - 48ms/step
Epoch 6/50
318/318 - 15s - loss: 3.2551 - accuracy20: 0.3864 - val_loss: 3.2631 - val_accuracy20: 0.3834 - 15s/epoch - 48ms/step
Epoch 7/50
318/318 - 16s - loss: 3.2429 - accuracy20: 0.3923 - val_loss: 3.2775 - val_accuracy20: 0.3786 - 16s/epoch - 49ms/step
Epoch 8/50
318/318 - 15s - loss: 3.2304 - accuracy20: 0.4005 - val_loss: 3.2760 - val_accuracy20: 0.3807 - 15s/epoch - 48ms/step
Epoch 9/50
318/318 - 16s - loss: 3.2202 - accuracy20: 0.4077 - val_loss: 3.2732 - val_accuracy20: 0.3815 - 16s/epoch - 49ms/step
Epoch 10/50
318/318 - 15s - loss: 3.2088 - accuracy20: 0.4145 - val_loss: 3.2958 - val_accuracy20: 0.3716 - 15s/epoch - 47ms/step
Epoch 11/50
318/318 - 15s - loss: 3.1964 - accuracy20: 0.4233 - val_loss: 3.2813 - val_accuracy20: 0.3789 - 15s/epoch - 47ms/step
Epoch 12/50
318/318 - 14s - loss: 3.1864 - accuracy20: 0.4288 - val_loss: 3.2552 - val_accuracy20: 0.3871 - 14s/epoch - 45ms/step
Epoch 13/50
318/318 - 15s - loss: 3.1736 - accuracy20: 0.4334 - val_loss: 3.2670 - val_accuracy20: 0.3918 - 15s/epoch - 47ms/step
Epoch 14/50
318/318 - 15s - loss: 3.1650 - accuracy20: 0.4386 - val_loss: 3.2398 - val_accuracy20: 0.3884 - 15s/epoch - 48ms/step
Epoch 15/50
318/318 - 15s - loss: 3.1506 - accuracy20: 0.4445 - val_loss: 3.2317 - val_accuracy20: 0.4061 - 15s/epoch - 48ms/step
Epoch 16/50
318/318 - 15s - loss: 3.1445 - accuracy20: 0.4468 - val_loss: 3.2296 - val_accuracy20: 0.4010 - 15s/epoch - 48ms/step
Epoch 17/50
318/318 - 15s - loss: 3.1364 - accuracy20: 0.4514 - val_loss: 3.2258 - val_accuracy20: 0.4066 - 15s/epoch - 48ms/step
Epoch 18/50
318/318 - 15s - loss: 3.1223 - accuracy20: 0.4572 - val_loss: 3.2219 - val_accuracy20: 0.4075 - 15s/epoch - 48ms/step
Epoch 19/50
318/318 - 14s - loss: 3.1119 - accuracy20: 0.4622 - val_loss: 3.2283 - val_accuracy20: 0.4052 - 14s/epoch - 45ms/step
Epoch 20/50
318/318 - 15s - loss: 3.1022 - accuracy20: 0.4653 - val_loss: 3.2342 - val_accuracy20: 0.3999 - 15s/epoch - 46ms/step
Epoch 21/50
318/318 - 15s - loss: 3.0976 - accuracy20: 0.4660 - val_loss: 3.2279 - val_accuracy20: 0.4023 - 15s/epoch - 47ms/step
Epoch 22/50
318/318 - 16s - loss: 3.0904 - accuracy20: 0.4694 - val_loss: 3.2334 - val_accuracy20: 0.4007 - 16s/epoch - 50ms/step
Epoch 23/50
318/318 - 15s - loss: 3.0829 - accuracy20: 0.4729 - val_loss: 3.2331 - val_accuracy20: 0.4017 - 15s/epoch - 48ms/step
Epoch 24/50
318/318 - 15s - loss: 3.0743 - accuracy20: 0.4751 - val_loss: 3.2334 - val_accuracy20: 0.4046 - 15s/epoch - 48ms/step
Epoch 25/50
318/318 - 15s - loss: 3.0663 - accuracy20: 0.4775 - val_loss: 3.2345 - val_accuracy20: 0.4067 - 15s/epoch - 46ms/step
Epoch 26/50
318/318 - 15s - loss: 3.0646 - accuracy20: 0.4783 - val_loss: 3.2558 - val_accuracy20: 0.4033 - 15s/epoch - 47ms/step
Epoch 27/50
318/318 - 15s - loss: 3.0500 - accuracy20: 0.4837 - val_loss: 3.2820 - val_accuracy20: 0.3986 - 15s/epoch - 47ms/step
Epoch 28/50
318/318 - 15s - loss: 3.0468 - accuracy20: 0.4854 - val_loss: 3.2651 - val_accuracy20: 0.4037 - 15s/epoch - 48ms/step
testing model: results/LILAK/W0/deepVOL_L3/h20
Evaluating performance on  test set...
876/876 - 21s - 21s/epoch - 24ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0664686
{'0': {'precision': 0.330097518715152, 'recall': 0.2678104781300124, 'f1-score': 0.29570962349757224, 'support': 55487}, '1': {'precision': 0.6001205190009744, 'recall': 0.4190270715462293, 'f1-score': 0.4934844491302055, 'support': 111704}, '2': {'precision': 0.3233572600897748, 'recall': 0.5741345411136858, 'f1-score': 0.413709789634802, 'support': 56964}, 'accuracy': 0.42101224599049764, 'macro avg': {'precision': 0.41785843260196703, 'recall': 0.42032403026330917, 'f1-score': 0.40096795408752656, 'support': 224155}, 'weighted avg': {'precision': 0.46294620436388395, 'recall': 0.42101224599049764, 'f1-score': 0.4242546061493481, 'support': 224155}}
[[14860 15748 24879]
 [21339 46807 43558]
 [ 8818 15441 32705]]
Evaluating performance on  train set...
318/318 - 8s - 8s/epoch - 24ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0615646
{'0': {'precision': 0.45646085295989813, 'recall': 0.276979528775589, 'f1-score': 0.34475961538461536, 'support': 25890}, '1': {'precision': 0.4893687707641196, 'recall': 0.3927738150789947, 'f1-score': 0.43578270034392214, 'support': 30002}, '2': {'precision': 0.3901008735942854, 'recall': 0.6380249447426587, 'f1-score': 0.48417048551831543, 'support': 25336}, 'accuracy': 0.43236322450386566, 'macro avg': {'precision': 0.4453101657727678, 'recall': 0.4359260961990808, 'f1-score': 0.421570933748951, 'support': 81228}, 'weighted avg': {'precision': 0.4479170861892659, 'recall': 0.43236322450386566, 'f1-score': 0.4218634268862717, 'support': 81228}}
[[ 7171  6350 12369]
 [ 5314 11784 12904]
 [ 3225  5946 16165]]
Evaluating performance on  val set...
104/104 - 3s - 3s/epoch - 27ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0825807
{'0': {'precision': 0.37623318385650223, 'recall': 0.22105124489527073, 'f1-score': 0.2784831134345698, 'support': 7591}, '1': {'precision': 0.5071883985498187, 'recall': 0.37316041206769685, 'f1-score': 0.42997191457792383, 'support': 10872}, '2': {'precision': 0.3625480974775545, 'recall': 0.6336239103362391, 'f1-score': 0.4612037708484409, 'support': 8030}, 'accuracy': 0.408523006077077, 'macro avg': {'precision': 0.4153232266279585, 'recall': 0.4092785224330689, 'f1-score': 0.38988626628697814, 'support': 26493}, 'weighted avg': {'precision': 0.4258256743454158, 'recall': 0.408523006077077, 'f1-score': 0.396032395322764, 'support': 26493}}
[[1678 1948 3965]
 [1834 4057 4981]
 [ 948 1994 5088]]
training model: results/LILAK/W0/deepVOL_L3/h30
Epoch 1/50
318/318 - 18s - loss: 3.3453 - accuracy30: 0.3457 - val_loss: 3.3304 - val_accuracy30: 0.3389 - 18s/epoch - 57ms/step
Epoch 2/50
318/318 - 14s - loss: 3.3157 - accuracy30: 0.3492 - val_loss: 3.2886 - val_accuracy30: 0.3688 - 14s/epoch - 45ms/step
Epoch 3/50
318/318 - 15s - loss: 3.2961 - accuracy30: 0.3573 - val_loss: 3.2827 - val_accuracy30: 0.3690 - 15s/epoch - 46ms/step
Epoch 4/50
318/318 - 15s - loss: 3.2815 - accuracy30: 0.3695 - val_loss: 3.2782 - val_accuracy30: 0.3675 - 15s/epoch - 47ms/step
Epoch 5/50
318/318 - 15s - loss: 3.2709 - accuracy30: 0.3799 - val_loss: 3.2778 - val_accuracy30: 0.3725 - 15s/epoch - 46ms/step
Epoch 6/50
318/318 - 15s - loss: 3.2615 - accuracy30: 0.3890 - val_loss: 3.2831 - val_accuracy30: 0.3789 - 15s/epoch - 46ms/step
Epoch 7/50
318/318 - 15s - loss: 3.2540 - accuracy30: 0.3956 - val_loss: 3.2810 - val_accuracy30: 0.3718 - 15s/epoch - 46ms/step
Epoch 8/50
318/318 - 15s - loss: 3.2460 - accuracy30: 0.3988 - val_loss: 3.3081 - val_accuracy30: 0.3594 - 15s/epoch - 47ms/step
Epoch 9/50
318/318 - 15s - loss: 3.2372 - accuracy30: 0.4051 - val_loss: 3.2998 - val_accuracy30: 0.3641 - 15s/epoch - 48ms/step
Epoch 10/50
318/318 - 15s - loss: 3.2263 - accuracy30: 0.4135 - val_loss: 3.3014 - val_accuracy30: 0.3667 - 15s/epoch - 47ms/step
Epoch 11/50
318/318 - 14s - loss: 3.2197 - accuracy30: 0.4174 - val_loss: 3.3017 - val_accuracy30: 0.3690 - 14s/epoch - 46ms/step
Epoch 12/50
318/318 - 15s - loss: 3.2124 - accuracy30: 0.4216 - val_loss: 3.3180 - val_accuracy30: 0.3632 - 15s/epoch - 48ms/step
Epoch 13/50
318/318 - 15s - loss: 3.2017 - accuracy30: 0.4282 - val_loss: 3.3083 - val_accuracy30: 0.3686 - 15s/epoch - 48ms/step
Epoch 14/50
318/318 - 15s - loss: 3.1938 - accuracy30: 0.4296 - val_loss: 3.2994 - val_accuracy30: 0.3770 - 15s/epoch - 46ms/step
Epoch 15/50
318/318 - 15s - loss: 3.1855 - accuracy30: 0.4334 - val_loss: 3.2960 - val_accuracy30: 0.3797 - 15s/epoch - 47ms/step
testing model: results/LILAK/W0/deepVOL_L3/h30
Evaluating performance on  test set...
876/876 - 23s - 23s/epoch - 26ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0798877
{'0': {'precision': 0.31248426881449787, 'recall': 0.2527655242619613, 'f1-score': 0.2794702483679748, 'support': 58940}, '1': {'precision': 0.5073779795686719, 'recall': 0.4473962652635191, 'f1-score': 0.475503008935627, 'support': 104907}, '2': {'precision': 0.3019267868626003, 'recall': 0.420408569344034, 'f1-score': 0.35145063140239247, 'support': 60308}, 'accuracy': 0.3889585331578595, 'macro avg': {'precision': 0.37392967841525665, 'recall': 0.3735234529565048, 'f1-score': 0.3688079629019981, 'support': 224155}, 'weighted avg': {'precision': 0.4008562163174896, 'recall': 0.3889585331578595, 'f1-score': 0.3905817638501651, 'support': 224155}}
[[14898 22584 21458]
 [20810 46935 37162]
 [11968 22986 25354]]
Evaluating performance on  train set...
318/318 - 8s - 8s/epoch - 25ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0932465
{'0': {'precision': 0.41681957186544344, 'recall': 0.24657187307789719, 'f1-score': 0.3098501898201823, 'support': 27639}, '1': {'precision': 0.3527369978377148, 'recall': 0.4651983040036021, 'f1-score': 0.4012362659589961, 'support': 26651}, '2': {'precision': 0.3784056508577195, 'recall': 0.4176256589204841, 'f1-score': 0.3970494811886779, 'support': 26938}, 'accuracy': 0.3750307775643867, 'macro avg': {'precision': 0.38265407352029257, 'recall': 0.37646527866732776, 'f1-score': 0.3693786456559521, 'support': 81228}, 'weighted avg': {'precision': 0.38305462770186605, 'recall': 0.3750307775643867, 'f1-score': 0.3687523519571309, 'support': 81228}}
[[ 6815 11748  9076]
 [ 4849 12398  9404]
 [ 4686 11002 11250]]
Evaluating performance on  val set...
104/104 - 3s - 3s/epoch - 28ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0913603
{'0': {'precision': 0.34366309098132697, 'recall': 0.21365938001729035, 'f1-score': 0.2634985911202498, 'support': 8097}, '1': {'precision': 0.4206831517183571, 'recall': 0.39942300039793077, 'f1-score': 0.4097775056133905, 'support': 10052}, '2': {'precision': 0.35627360469995806, 'recall': 0.5087488015340365, 'f1-score': 0.4190730045905524, 'support': 8344}, 'accuracy': 0.37708073830823235, 'macro avg': {'precision': 0.37353994913321403, 'recall': 0.3739437273164192, 'f1-score': 0.3641163671080642, 'support': 26493}, 'weighted avg': {'precision': 0.3768578132474684, 'recall': 0.37708073830823235, 'f1-score': 0.3679982157184929, 'support': 26493}}
[[1730 2828 3539]
 [1906 4015 4131]
 [1398 2701 4245]]
training model: results/LILAK/W0/deepVOL_L3/h50
Epoch 1/50
318/318 - 19s - loss: 3.3526 - accuracy50: 0.3395 - val_loss: 3.3201 - val_accuracy50: 0.3478 - 19s/epoch - 60ms/step
Epoch 2/50
318/318 - 16s - loss: 3.3157 - accuracy50: 0.3496 - val_loss: 3.3095 - val_accuracy50: 0.3449 - 16s/epoch - 49ms/step
Epoch 3/50
318/318 - 15s - loss: 3.3009 - accuracy50: 0.3551 - val_loss: 3.2944 - val_accuracy50: 0.3604 - 15s/epoch - 47ms/step
Epoch 4/50
318/318 - 15s - loss: 3.2851 - accuracy50: 0.3651 - val_loss: 3.3016 - val_accuracy50: 0.3507 - 15s/epoch - 47ms/step
Epoch 5/50
318/318 - 16s - loss: 3.2782 - accuracy50: 0.3738 - val_loss: 3.3048 - val_accuracy50: 0.3514 - 16s/epoch - 49ms/step
Epoch 6/50
318/318 - 15s - loss: 3.2705 - accuracy50: 0.3824 - val_loss: 3.2963 - val_accuracy50: 0.3546 - 15s/epoch - 48ms/step
Epoch 7/50
318/318 - 15s - loss: 3.2647 - accuracy50: 0.3860 - val_loss: 3.3039 - val_accuracy50: 0.3517 - 15s/epoch - 46ms/step
Epoch 8/50
318/318 - 15s - loss: 3.2537 - accuracy50: 0.3946 - val_loss: 3.2935 - val_accuracy50: 0.3592 - 15s/epoch - 47ms/step
Epoch 9/50
318/318 - 16s - loss: 3.2441 - accuracy50: 0.4002 - val_loss: 3.3007 - val_accuracy50: 0.3603 - 16s/epoch - 50ms/step
Epoch 10/50
318/318 - 15s - loss: 3.2380 - accuracy50: 0.4068 - val_loss: 3.2935 - val_accuracy50: 0.3679 - 15s/epoch - 47ms/step
Epoch 11/50
318/318 - 16s - loss: 3.2342 - accuracy50: 0.4098 - val_loss: 3.2930 - val_accuracy50: 0.3692 - 16s/epoch - 49ms/step
Epoch 12/50
318/318 - 15s - loss: 3.2249 - accuracy50: 0.4130 - val_loss: 3.2981 - val_accuracy50: 0.3678 - 15s/epoch - 47ms/step
Epoch 13/50
318/318 - 16s - loss: 3.2212 - accuracy50: 0.4156 - val_loss: 3.2899 - val_accuracy50: 0.3742 - 16s/epoch - 50ms/step
Epoch 14/50
318/318 - 15s - loss: 3.2137 - accuracy50: 0.4213 - val_loss: 3.2915 - val_accuracy50: 0.3781 - 15s/epoch - 48ms/step
Epoch 15/50
318/318 - 16s - loss: 3.2047 - accuracy50: 0.4247 - val_loss: 3.3117 - val_accuracy50: 0.3709 - 16s/epoch - 50ms/step
Epoch 16/50
318/318 - 16s - loss: 3.1960 - accuracy50: 0.4311 - val_loss: 3.3001 - val_accuracy50: 0.3757 - 16s/epoch - 50ms/step
Epoch 17/50
318/318 - 15s - loss: 3.1903 - accuracy50: 0.4325 - val_loss: 3.3023 - val_accuracy50: 0.3713 - 15s/epoch - 46ms/step
Epoch 18/50
318/318 - 16s - loss: 3.1842 - accuracy50: 0.4361 - val_loss: 3.2832 - val_accuracy50: 0.3824 - 16s/epoch - 50ms/step
Epoch 19/50
318/318 - 16s - loss: 3.1816 - accuracy50: 0.4345 - val_loss: 3.2873 - val_accuracy50: 0.3763 - 16s/epoch - 49ms/step
Epoch 20/50
318/318 - 15s - loss: 3.1723 - accuracy50: 0.4403 - val_loss: 3.2926 - val_accuracy50: 0.3783 - 15s/epoch - 46ms/step
Epoch 21/50
318/318 - 15s - loss: 3.1625 - accuracy50: 0.4432 - val_loss: 3.2936 - val_accuracy50: 0.3763 - 15s/epoch - 48ms/step
Epoch 22/50
318/318 - 15s - loss: 3.1568 - accuracy50: 0.4470 - val_loss: 3.3050 - val_accuracy50: 0.3722 - 15s/epoch - 49ms/step
Epoch 23/50
318/318 - 15s - loss: 3.1510 - accuracy50: 0.4474 - val_loss: 3.3016 - val_accuracy50: 0.3813 - 15s/epoch - 49ms/step
Epoch 24/50
318/318 - 15s - loss: 3.1437 - accuracy50: 0.4511 - val_loss: 3.3085 - val_accuracy50: 0.3772 - 15s/epoch - 46ms/step
Epoch 25/50
318/318 - 15s - loss: 3.1395 - accuracy50: 0.4540 - val_loss: 3.3098 - val_accuracy50: 0.3778 - 15s/epoch - 47ms/step
Epoch 26/50
318/318 - 15s - loss: 3.1326 - accuracy50: 0.4571 - val_loss: 3.3151 - val_accuracy50: 0.3769 - 15s/epoch - 47ms/step
Epoch 27/50
318/318 - 14s - loss: 3.1267 - accuracy50: 0.4576 - val_loss: 3.3193 - val_accuracy50: 0.3789 - 14s/epoch - 45ms/step
Epoch 28/50
318/318 - 15s - loss: 3.1253 - accuracy50: 0.4595 - val_loss: 3.3273 - val_accuracy50: 0.3796 - 15s/epoch - 47ms/step
testing model: results/LILAK/W0/deepVOL_L3/h50
Evaluating performance on  test set...
876/876 - 20s - 20s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0864035
{'0': {'precision': 0.33571817934041975, 'recall': 0.4036208732694356, 'f1-score': 0.3665513521556374, 'support': 61035}, '1': {'precision': 0.5030908079371947, 'recall': 0.32422688113141773, 'f1-score': 0.39432388727719797, 'support': 100405}, '2': {'precision': 0.3175781658475374, 'recall': 0.4358287491030854, 'f1-score': 0.36742347864661046, 'support': 62715}, 'accuracy': 0.37706943855814057, 'macro avg': {'precision': 0.38546238437505065, 'recall': 0.38789216783464625, 'f1-score': 0.3760995726931486, 'support': 224155}, 'weighted avg': {'precision': 0.4056135545408528, 'recall': 0.37706943855814057, 'f1-score': 0.37923541810001365, 'support': 224155}}
[[24635 15041 21359]
 [30476 32554 37375]
 [18269 17113 27333]]
Evaluating performance on  train set...
318/318 - 8s - 8s/epoch - 27ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0733838
{'0': {'precision': 0.44153454133635334, 'recall': 0.4508202645082027, 'f1-score': 0.44612908993384587, 'support': 27674}, '1': {'precision': 0.3955467675378267, 'recall': 0.3435889776715705, 'f1-score': 0.36774167765655597, 'support': 26782}, '2': {'precision': 0.4106301332974283, 'recall': 0.45566263260122514, 'f1-score': 0.4319759206798867, 'support': 26772}, 'accuracy': 0.41706061949081596, 'macro avg': {'precision': 0.4159038140572027, 'recall': 0.41669062492699943, 'f1-score': 0.4152822294234295, 'support': 81228}, 'weighted avg': {'precision': 0.41618592546633015, 'recall': 0.41706061949081596, 'f1-score': 0.41561891705162085, 'support': 81228}}
[[12476  6749  8449]
 [ 8520  9202  9060]
 [ 7260  7313 12199]]
Evaluating performance on  val set...
104/104 - 3s - 3s/epoch - 30ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0948731
{'0': {'precision': 0.3715676485272092, 'recall': 0.3616814481836958, 'f1-score': 0.3665579018654189, 'support': 8231}, '1': {'precision': 0.4239659367396594, 'recall': 0.2827873009433005, 'f1-score': 0.3392759355034986, 'support': 9859}, '2': {'precision': 0.3646367072658547, 'recall': 0.5166012138521956, 'f1-score': 0.4275162497537916, 'support': 8403}, 'accuracy': 0.3814592533876873, 'macro avg': {'precision': 0.3867234308442411, 'recall': 0.38702332099306397, 'f1-score': 0.3777833623742364, 'support': 26493}, 'weighted avg': {'precision': 0.38886859685572556, 'recall': 0.3814592533876873, 'f1-score': 0.37573995338634236, 'support': 26493}}
[[2977 1801 3453]
 [2960 2788 4111]
 [2075 1987 4341]]
training model: results/LILAK/W0/deepVOL_L3/h100
Epoch 1/50
318/318 - 20s - loss: 3.3364 - accuracy100: 0.3614 - val_loss: 3.4378 - val_accuracy100: 0.3066 - 20s/epoch - 62ms/step
Epoch 2/50
318/318 - 15s - loss: 3.3163 - accuracy100: 0.3529 - val_loss: 3.2811 - val_accuracy100: 0.4180 - 15s/epoch - 48ms/step
Epoch 3/50
318/318 - 16s - loss: 3.3063 - accuracy100: 0.3426 - val_loss: 3.2786 - val_accuracy100: 0.4198 - 16s/epoch - 49ms/step
Epoch 4/50
318/318 - 15s - loss: 3.3031 - accuracy100: 0.3344 - val_loss: 3.2805 - val_accuracy100: 0.4199 - 15s/epoch - 47ms/step
Epoch 5/50
318/318 - 16s - loss: 3.3002 - accuracy100: 0.3352 - val_loss: 3.2807 - val_accuracy100: 0.4205 - 16s/epoch - 49ms/step
Epoch 6/50
318/318 - 15s - loss: 3.2973 - accuracy100: 0.3402 - val_loss: 3.2787 - val_accuracy100: 0.4197 - 15s/epoch - 47ms/step
Epoch 7/50
318/318 - 15s - loss: 3.2901 - accuracy100: 0.3529 - val_loss: 3.2746 - val_accuracy100: 0.4161 - 15s/epoch - 47ms/step
Epoch 8/50
318/318 - 15s - loss: 3.2842 - accuracy100: 0.3636 - val_loss: 3.2720 - val_accuracy100: 0.4143 - 15s/epoch - 48ms/step
Epoch 9/50
318/318 - 15s - loss: 3.2760 - accuracy100: 0.3739 - val_loss: 3.2749 - val_accuracy100: 0.4086 - 15s/epoch - 46ms/step
Epoch 10/50
318/318 - 15s - loss: 3.2701 - accuracy100: 0.3824 - val_loss: 3.2765 - val_accuracy100: 0.4097 - 15s/epoch - 46ms/step
Epoch 11/50
318/318 - 15s - loss: 3.2643 - accuracy100: 0.3894 - val_loss: 3.2798 - val_accuracy100: 0.4067 - 15s/epoch - 48ms/step
Epoch 12/50
318/318 - 15s - loss: 3.2593 - accuracy100: 0.3943 - val_loss: 3.2782 - val_accuracy100: 0.4034 - 15s/epoch - 47ms/step
Epoch 13/50
318/318 - 15s - loss: 3.2573 - accuracy100: 0.3941 - val_loss: 3.2725 - val_accuracy100: 0.4105 - 15s/epoch - 47ms/step
Epoch 14/50
318/318 - 15s - loss: 3.2508 - accuracy100: 0.4007 - val_loss: 3.2714 - val_accuracy100: 0.4078 - 15s/epoch - 47ms/step
Epoch 15/50
318/318 - 15s - loss: 3.2447 - accuracy100: 0.4058 - val_loss: 3.2769 - val_accuracy100: 0.4052 - 15s/epoch - 46ms/step
Epoch 16/50
318/318 - 15s - loss: 3.2381 - accuracy100: 0.4110 - val_loss: 3.2881 - val_accuracy100: 0.3944 - 15s/epoch - 48ms/step
Epoch 17/50
318/318 - 15s - loss: 3.2353 - accuracy100: 0.4119 - val_loss: 3.2920 - val_accuracy100: 0.3947 - 15s/epoch - 47ms/step
Epoch 18/50
318/318 - 15s - loss: 3.2317 - accuracy100: 0.4115 - val_loss: 3.2917 - val_accuracy100: 0.3910 - 15s/epoch - 48ms/step
Epoch 19/50
318/318 - 16s - loss: 3.2245 - accuracy100: 0.4176 - val_loss: 3.3046 - val_accuracy100: 0.3817 - 16s/epoch - 49ms/step
Epoch 20/50
318/318 - 16s - loss: 3.2183 - accuracy100: 0.4219 - val_loss: 3.3062 - val_accuracy100: 0.3849 - 16s/epoch - 49ms/step
Epoch 21/50
318/318 - 16s - loss: 3.2147 - accuracy100: 0.4244 - val_loss: 3.3215 - val_accuracy100: 0.3769 - 16s/epoch - 49ms/step
Epoch 22/50
318/318 - 15s - loss: 3.2102 - accuracy100: 0.4247 - val_loss: 3.3275 - val_accuracy100: 0.3714 - 15s/epoch - 46ms/step
Epoch 23/50
318/318 - 15s - loss: 3.2028 - accuracy100: 0.4314 - val_loss: 3.3456 - val_accuracy100: 0.3613 - 15s/epoch - 47ms/step
Epoch 24/50
318/318 - 16s - loss: 3.1989 - accuracy100: 0.4297 - val_loss: 3.3453 - val_accuracy100: 0.3632 - 16s/epoch - 50ms/step
testing model: results/LILAK/W0/deepVOL_L3/h100
Evaluating performance on  test set...
876/876 - 20s - 20s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0630324
{'0': {'precision': 0.32116618753085346, 'recall': 0.19367492032360872, 'f1-score': 0.24163507859694355, 'support': 57106}, '1': {'precision': 0.5039279325145132, 'recall': 0.6528912748726593, 'f1-score': 0.5688186160851468, 'support': 109156}, '2': {'precision': 0.28015322497152917, 'recall': 0.2337070112103363, 'f1-score': 0.2548310543564244, 'support': 57893}, 'accuracy': 0.4276371260957819, 'macro avg': {'precision': 0.3684157816722986, 'recall': 0.36009106880220143, 'f1-score': 0.35509491634617163, 'support': 224155}, 'weighted avg': {'precision': 0.39957254738894, 'recall': 0.4276371260957819, 'f1-score': 0.4043706894140386, 'support': 224155}}
[[11060 33543 12503]
 [15627 71267 22262]
 [ 7750 36613 13530]]
Evaluating performance on  train set...
318/318 - 8s - 8s/epoch - 26ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1035143
{'0': {'precision': 0.45933085501858734, 'recall': 0.21370507454425958, 'f1-score': 0.29169715998961254, 'support': 28909}, '1': {'precision': 0.31784720776640235, 'recall': 0.675759404546369, 'f1-score': 0.432340600787665, 'support': 24855}, '2': {'precision': 0.4025443588885169, 'recall': 0.21890474803378968, 'f1-score': 0.28359159414137125, 'support': 27464}, 'accuracy': 0.3568473925247452, 'macro avg': {'precision': 0.3932408072245022, 'recall': 0.3694564090414727, 'f1-score': 0.3358764516395496, 'support': 81228}, 'weighted avg': {'precision': 0.39683811381888634, 'recall': 0.3568473925247452, 'f1-score': 0.3319921501479261, 'support': 81228}}
[[ 6178 18125  4606]
 [ 3742 16796  4317]
 [ 3530 17922  6012]]
Evaluating performance on  val set...
104/104 - 3s - 3s/epoch - 28ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0828223
{'0': {'precision': 0.35412087912087914, 'recall': 0.16810119979134064, 'f1-score': 0.22798019101521044, 'support': 7668}, '1': {'precision': 0.4490853468190048, 'recall': 0.6459231321839081, 'f1-score': 0.5298125437336575, 'support': 11136}, '2': {'precision': 0.34406085430076067, 'recall': 0.3058915333593445, 'f1-score': 0.3238554216867469, 'support': 7689}, 'accuracy': 0.40893821009323217, 'macro avg': {'precision': 0.38242236008021485, 'recall': 0.3733052884448644, 'f1-score': 0.36054938547853826, 'support': 26493}, 'weighted avg': {'precision': 0.391118304155584, 'recall': 0.40893821009323217, 'f1-score': 0.3826772705647545, 'support': 26493}}
[[1289 4335 2044]
 [1503 7193 2440]
 [ 848 4489 2352]]
training model: results/LILAK/W0/deepVOL_L3/h200
Epoch 1/50
318/318 - 18s - loss: 3.3500 - accuracy200: 0.3488 - val_loss: 3.3717 - val_accuracy200: 0.3396 - 18s/epoch - 58ms/step
Epoch 2/50
318/318 - 15s - loss: 3.3187 - accuracy200: 0.3550 - val_loss: 3.3256 - val_accuracy200: 0.3433 - 15s/epoch - 47ms/step
Epoch 3/50
318/318 - 15s - loss: 3.3093 - accuracy200: 0.3547 - val_loss: 3.3075 - val_accuracy200: 0.3440 - 15s/epoch - 48ms/step
Epoch 4/50
318/318 - 15s - loss: 3.2958 - accuracy200: 0.3575 - val_loss: 3.3076 - val_accuracy200: 0.3464 - 15s/epoch - 47ms/step
Epoch 5/50
318/318 - 15s - loss: 3.2884 - accuracy200: 0.3624 - val_loss: 3.3228 - val_accuracy200: 0.3442 - 15s/epoch - 48ms/step
Epoch 6/50
318/318 - 15s - loss: 3.2896 - accuracy200: 0.3651 - val_loss: 3.3032 - val_accuracy200: 0.3427 - 15s/epoch - 48ms/step
Epoch 7/50
318/318 - 15s - loss: 3.2776 - accuracy200: 0.3766 - val_loss: 3.3085 - val_accuracy200: 0.3471 - 15s/epoch - 47ms/step
Epoch 8/50
318/318 - 14s - loss: 3.2763 - accuracy200: 0.3783 - val_loss: 3.3086 - val_accuracy200: 0.3519 - 14s/epoch - 45ms/step
Epoch 9/50
318/318 - 15s - loss: 3.2706 - accuracy200: 0.3806 - val_loss: 3.3124 - val_accuracy200: 0.3555 - 15s/epoch - 49ms/step
Epoch 10/50
318/318 - 15s - loss: 3.2620 - accuracy200: 0.3873 - val_loss: 3.3204 - val_accuracy200: 0.3558 - 15s/epoch - 48ms/step
Epoch 11/50
318/318 - 15s - loss: 3.2551 - accuracy200: 0.3955 - val_loss: 3.3282 - val_accuracy200: 0.3522 - 15s/epoch - 46ms/step
Epoch 12/50
318/318 - 15s - loss: 3.2498 - accuracy200: 0.3975 - val_loss: 3.3306 - val_accuracy200: 0.3538 - 15s/epoch - 47ms/step
Epoch 13/50
318/318 - 15s - loss: 3.2426 - accuracy200: 0.4006 - val_loss: 3.3477 - val_accuracy200: 0.3538 - 15s/epoch - 49ms/step
Epoch 14/50
318/318 - 15s - loss: 3.2343 - accuracy200: 0.4049 - val_loss: 3.3493 - val_accuracy200: 0.3568 - 15s/epoch - 46ms/step
Epoch 15/50
318/318 - 15s - loss: 3.2312 - accuracy200: 0.4072 - val_loss: 3.3505 - val_accuracy200: 0.3629 - 15s/epoch - 48ms/step
Epoch 16/50
318/318 - 15s - loss: 3.2222 - accuracy200: 0.4121 - val_loss: 3.3448 - val_accuracy200: 0.3631 - 15s/epoch - 47ms/step
testing model: results/LILAK/W0/deepVOL_L3/h200
Evaluating performance on  test set...
876/876 - 21s - 21s/epoch - 24ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0978228
{'0': {'precision': 0.35025993049372434, 'recall': 0.171227587368894, 'f1-score': 0.23001188253267696, 'support': 71221}, '1': {'precision': 0.3609621975869732, 'recall': 0.7277352401442764, 'f1-score': 0.4825673367825208, 'support': 79015}, '2': {'precision': 0.33846051404980687, 'recall': 0.1375289167872942, 'f1-score': 0.1955846279640229, 'support': 73919}, 'accuracy': 0.35628471370257186, 'macro avg': {'precision': 0.34989421404350146, 'recall': 0.34549724810015486, 'f1-score': 0.3027212824264069, 'support': 224155}, 'weighted avg': {'precision': 0.35014143467723624, 'recall': 0.35628471370257186, 'f1-score': 0.30768510412974626, 'support': 224155}}
[[12195 49683  9343]
 [10986 57502 10527]
 [11636 52117 10166]]
Evaluating performance on  train set...
318/318 - 8s - 8s/epoch - 25ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0972159
{'0': {'precision': 0.40776610324349016, 'recall': 0.1619904903633262, 'f1-score': 0.23186824605153786, 'support': 27551}, '1': {'precision': 0.3378226711560045, 'recall': 0.7192890747516989, 'f1-score': 0.459728420399494, 'support': 26782}, '2': {'precision': 0.3783844935515499, 'recall': 0.18654024911693623, 'f1-score': 0.24988793146386412, 'support': 26895}, 'accuracy': 0.353868124292116, 'macro avg': {'precision': 0.3746577559836815, 'recall': 0.3559399380773205, 'f1-score': 0.31382819930496536, 'support': 81228}, 'weighted avg': {'precision': 0.37497638306286557, 'recall': 0.353868124292116, 'f1-score': 0.3129633195305288, 'support': 81228}}
[[ 4463 19083  4005]
 [ 3281 19264  4237]
 [ 3201 18677  5017]]
Evaluating performance on  val set...
104/104 - 3s - 3s/epoch - 27ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1014899
{'0': {'precision': 0.3345323741007194, 'recall': 0.12777650561025877, 'f1-score': 0.18492129246064626, 'support': 8734}, '1': {'precision': 0.3467992541951523, 'recall': 0.7301275760549558, 'f1-score': 0.47024123038028026, 'support': 9171}, '2': {'precision': 0.3403481423746428, 'recall': 0.15253842571029344, 'f1-score': 0.21066173514513145, 'support': 8588}, 'accuracy': 0.3443173668516212, 'macro avg': {'precision': 0.3405599235568382, 'recall': 0.33681416912516937, 'f1-score': 0.28860808599535265, 'support': 26493}, 'weighted avg': {'precision': 0.3406640079391861, 'recall': 0.3443173668516212, 'f1-score': 0.29203366449987633, 'support': 26493}}
[[1116 6354 1264]
 [1200 6696 1275]
 [1020 6258 1310]]
training model: results/LILAK/W0/deepVOL_L3/h300
Epoch 1/50
318/318 - 18s - loss: 3.3363 - accuracy300: 0.3588 - val_loss: 3.3582 - val_accuracy300: 0.3377 - 18s/epoch - 57ms/step
Epoch 2/50
318/318 - 15s - loss: 3.3088 - accuracy300: 0.3633 - val_loss: 3.3003 - val_accuracy300: 0.3618 - 15s/epoch - 48ms/step
Epoch 3/50
318/318 - 15s - loss: 3.2987 - accuracy300: 0.3599 - val_loss: 3.2920 - val_accuracy300: 0.3762 - 15s/epoch - 47ms/step
Epoch 4/50
318/318 - 15s - loss: 3.2931 - accuracy300: 0.3609 - val_loss: 3.2927 - val_accuracy300: 0.3736 - 15s/epoch - 47ms/step
Epoch 5/50
318/318 - 15s - loss: 3.2876 - accuracy300: 0.3687 - val_loss: 3.2940 - val_accuracy300: 0.3756 - 15s/epoch - 46ms/step
Epoch 6/50
318/318 - 15s - loss: 3.2845 - accuracy300: 0.3712 - val_loss: 3.2942 - val_accuracy300: 0.3761 - 15s/epoch - 48ms/step
Epoch 7/50
318/318 - 15s - loss: 3.2795 - accuracy300: 0.3758 - val_loss: 3.2989 - val_accuracy300: 0.3771 - 15s/epoch - 47ms/step
Epoch 8/50
318/318 - 15s - loss: 3.2700 - accuracy300: 0.3850 - val_loss: 3.2997 - val_accuracy300: 0.3715 - 15s/epoch - 48ms/step
Epoch 9/50
318/318 - 15s - loss: 3.2677 - accuracy300: 0.3868 - val_loss: 3.3074 - val_accuracy300: 0.3662 - 15s/epoch - 46ms/step
Epoch 10/50
318/318 - 15s - loss: 3.2659 - accuracy300: 0.3895 - val_loss: 3.3088 - val_accuracy300: 0.3670 - 15s/epoch - 48ms/step
Epoch 11/50
318/318 - 15s - loss: 3.2593 - accuracy300: 0.3917 - val_loss: 3.3034 - val_accuracy300: 0.3710 - 15s/epoch - 48ms/step
Epoch 12/50
318/318 - 15s - loss: 3.2499 - accuracy300: 0.3976 - val_loss: 3.3179 - val_accuracy300: 0.3638 - 15s/epoch - 46ms/step
Epoch 13/50
318/318 - 16s - loss: 3.2408 - accuracy300: 0.4034 - val_loss: 3.3259 - val_accuracy300: 0.3558 - 16s/epoch - 49ms/step
testing model: results/LILAK/W0/deepVOL_L3/h300
Evaluating performance on  test set...
876/876 - 20s - 20s/epoch - 23ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0897744
{'0': {'precision': 0.2860069657856997, 'recall': 0.021703980099502487, 'f1-score': 0.04034623777113048, 'support': 64320}, '1': {'precision': 0.40584752333672347, 'recall': 0.8751927211135481, 'f1-score': 0.5545412017226434, 'support': 92102}, '2': {'precision': 0.2930784123910939, 'recall': 0.08939512497600874, 'f1-score': 0.13700179878497165, 'support': 67733}, 'accuracy': 0.39284423724654816, 'macro avg': {'precision': 0.32831096717117236, 'recall': 0.3287639420630198, 'f1-score': 0.2439630794262485, 'support': 224155}, 'weighted avg': {'precision': 0.3373844738693363, 'recall': 0.39284423724654816, 'f1-score': 0.28082784953090717, 'support': 224155}}
[[ 1396 57735  5189]
 [ 2079 80607  9416]
 [ 1406 60272  6055]]
Evaluating performance on  train set...
318/318 - 8s - 8s/epoch - 24ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1060349
{'0': {'precision': 0.3630050505050505, 'recall': 0.020558475454968, 'f1-score': 0.03891313910601293, 'support': 27969}, '1': {'precision': 0.318918243534034, 'recall': 0.8899047028744093, 'f1-score': 0.46955899637181253, 'support': 25814}, '2': {'precision': 0.38460528044135034, 'recall': 0.10668609947167061, 'f1-score': 0.167037480746192, 'support': 27445}, 'accuracy': 0.32593440685477915, 'macro avg': {'precision': 0.3555095248268116, 'recall': 0.3390497592670159, 'f1-score': 0.2251698720746725, 'support': 81228}, 'weighted avg': {'precision': 0.3562926049869032, 'recall': 0.32593440685477915, 'f1-score': 0.21906117569160002, 'support': 81228}}
[[  575 25025  2369]
 [  526 22972  2316]
 [  483 24034  2928]]
Evaluating performance on  val set...
104/104 - 3s - 3s/epoch - 28ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0968289
{'0': {'precision': 0.2964426877470356, 'recall': 0.018140041117426533, 'f1-score': 0.03418803418803419, 'support': 8269}, '1': {'precision': 0.37893343580547373, 'recall': 0.8839641434262948, 'f1-score': 0.5304683063865396, 'support': 10040}, '2': {'precision': 0.31839438815276694, 'recall': 0.09982893450635386, 'f1-score': 0.152, 'support': 8184}, 'accuracy': 0.37149435699996225, 'macro avg': {'precision': 0.3312568372350921, 'recall': 0.33397770635002505, 'f1-score': 0.23888544685819127, 'support': 26493}, 'weighted avg': {'precision': 0.3344851829958645, 'recall': 0.37149435699996225, 'f1-score': 0.2586558959280456, 'support': 26493}}
[[ 150 7326  793]
 [ 209 8875  956]
 [ 147 7220  817]]
training model: results/LILAK/W0/deepVOL_L3/h500
Epoch 1/50
318/318 - 18s - loss: 3.3437 - accuracy500: 0.3541 - val_loss: 3.3919 - val_accuracy500: 0.3264 - 18s/epoch - 58ms/step
Epoch 2/50
318/318 - 16s - loss: 3.3140 - accuracy500: 0.3613 - val_loss: 3.4872 - val_accuracy500: 0.3273 - 16s/epoch - 50ms/step
Epoch 3/50
318/318 - 15s - loss: 3.3184 - accuracy500: 0.3453 - val_loss: 3.3085 - val_accuracy500: 0.3255 - 15s/epoch - 48ms/step
Epoch 4/50
318/318 - 15s - loss: 3.3011 - accuracy500: 0.3463 - val_loss: 3.3060 - val_accuracy500: 0.3237 - 15s/epoch - 49ms/step
Epoch 5/50
318/318 - 16s - loss: 3.2964 - accuracy500: 0.3485 - val_loss: 3.3065 - val_accuracy500: 0.3202 - 16s/epoch - 50ms/step
Epoch 6/50
318/318 - 15s - loss: 3.2930 - accuracy500: 0.3518 - val_loss: 3.3049 - val_accuracy500: 0.3247 - 15s/epoch - 48ms/step
Epoch 7/50
318/318 - 15s - loss: 3.2877 - accuracy500: 0.3625 - val_loss: 3.3034 - val_accuracy500: 0.3337 - 15s/epoch - 48ms/step
Epoch 8/50
318/318 - 15s - loss: 3.2820 - accuracy500: 0.3689 - val_loss: 3.3031 - val_accuracy500: 0.3391 - 15s/epoch - 49ms/step
Epoch 9/50
318/318 - 15s - loss: 3.2770 - accuracy500: 0.3769 - val_loss: 3.3018 - val_accuracy500: 0.3472 - 15s/epoch - 48ms/step
Epoch 10/50
318/318 - 15s - loss: 3.2701 - accuracy500: 0.3824 - val_loss: 3.3076 - val_accuracy500: 0.3488 - 15s/epoch - 47ms/step
Epoch 11/50
318/318 - 15s - loss: 3.2661 - accuracy500: 0.3886 - val_loss: 3.3075 - val_accuracy500: 0.3531 - 15s/epoch - 46ms/step
Epoch 12/50
318/318 - 15s - loss: 3.2590 - accuracy500: 0.3946 - val_loss: 3.3198 - val_accuracy500: 0.3468 - 15s/epoch - 46ms/step
Epoch 13/50
318/318 - 15s - loss: 3.2525 - accuracy500: 0.3972 - val_loss: 3.3198 - val_accuracy500: 0.3538 - 15s/epoch - 46ms/step
Epoch 14/50
318/318 - 15s - loss: 3.2457 - accuracy500: 0.4022 - val_loss: 3.3140 - val_accuracy500: 0.3617 - 15s/epoch - 46ms/step
Epoch 15/50
318/318 - 16s - loss: 3.2360 - accuracy500: 0.4093 - val_loss: 3.3292 - val_accuracy500: 0.3558 - 16s/epoch - 49ms/step
Epoch 16/50
318/318 - 15s - loss: 3.2304 - accuracy500: 0.4119 - val_loss: 3.3345 - val_accuracy500: 0.3533 - 15s/epoch - 48ms/step
Epoch 17/50
318/318 - 15s - loss: 3.2156 - accuracy500: 0.4208 - val_loss: 3.3463 - val_accuracy500: 0.3572 - 15s/epoch - 47ms/step
Epoch 18/50
318/318 - 15s - loss: 3.2118 - accuracy500: 0.4228 - val_loss: 3.3551 - val_accuracy500: 0.3537 - 15s/epoch - 49ms/step
Epoch 19/50
318/318 - 15s - loss: 3.2051 - accuracy500: 0.4269 - val_loss: 3.3730 - val_accuracy500: 0.3536 - 15s/epoch - 47ms/step
testing model: results/LILAK/W0/deepVOL_L3/h500
Evaluating performance on  test set...
876/876 - 22s - 22s/epoch - 25ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975105
{'0': {'precision': 0.3254431841336684, 'recall': 0.4182950428494522, 'f1-score': 0.36607307709448833, 'support': 68729}, '1': {'precision': 0.3841181797600181, 'recall': 0.42583924201543577, 'f1-score': 0.4039041809254575, 'support': 79685}, '2': {'precision': 0.37868862817785454, 'recall': 0.23737473759258526, 'f1-score': 0.2918242464574981, 'support': 75741}, 'accuracy': 0.35984475028440144, 'macro avg': {'precision': 0.3627499973571804, 'recall': 0.3605030074858244, 'f1-score': 0.3539338348258146, 'support': 224155}, 'weighted avg': {'precision': 0.3642929987879763, 'recall': 0.35984475028440144, 'f1-score': 0.3544333225830766, 'support': 224155}}
[[28749 26011 13969]
 [30223 33933 15529]
 [29366 28396 17979]]
Evaluating performance on  train set...
318/318 - 8s - 8s/epoch - 25ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0911833
{'0': {'precision': 0.4066226793983853, 'recall': 0.36021056453076783, 'f1-score': 0.38201208947753434, 'support': 27545}, '1': {'precision': 0.357299858350022, 'recall': 0.5531609195402298, 'f1-score': 0.4341632786301451, 'support': 26448}, '2': {'precision': 0.3916000251873308, 'recall': 0.2283458784652102, 'f1-score': 0.28847759532424155, 'support': 27235}, 'accuracy': 0.37882257349682374, 'macro avg': {'precision': 0.3851741876452461, 'recall': 0.3805724541787359, 'f1-score': 0.36821765447730703, 'support': 81228}, 'weighted avg': {'precision': 0.3855261122229633, 'recall': 0.37882257349682374, 'f1-score': 0.36763136734284335, 'support': 81228}}
[[ 9922 12548  5075]
 [ 7231 14630  4587]
 [ 7248 13768  6219]]
Evaluating performance on  val set...
104/104 - 3s - 3s/epoch - 26ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1008998
{'0': {'precision': 0.3411486341148634, 'recall': 0.35315074593631707, 'f1-score': 0.3470459518599562, 'support': 8982}, '1': {'precision': 0.3362600410984495, 'recall': 0.4209049456331112, 'f1-score': 0.3738511864582793, 'support': 8553}, '2': {'precision': 0.37170596393897365, 'recall': 0.2692565304755526, 'f1-score': 0.31229364925228204, 'support': 8958}, 'accuracy': 0.3466576076699506, 'macro avg': {'precision': 0.34970487971742886, 'recall': 0.3477707406816603, 'f1-score': 0.3443969291901725, 'support': 26493}, 'weighted avg': {'precision': 0.34990266063111264, 'recall': 0.3466576076699506, 'f1-score': 0.34394906003041303, 'support': 26493}}
[[3172 3607 2203]
 [3079 3600 1874]
 [3047 3499 2412]]
training model: results/LILAK/W0/deepVOL_L3/h1000
Epoch 1/50
318/318 - 18s - loss: 3.3487 - accuracy1000: 0.3567 - val_loss: 3.5789 - val_accuracy1000: 0.3082 - 18s/epoch - 57ms/step
Epoch 2/50
318/318 - 15s - loss: 3.3200 - accuracy1000: 0.3645 - val_loss: 3.5645 - val_accuracy1000: 0.3248 - 15s/epoch - 48ms/step
Epoch 3/50
318/318 - 15s - loss: 3.3361 - accuracy1000: 0.3348 - val_loss: 3.2947 - val_accuracy1000: 0.3474 - 15s/epoch - 48ms/step
Epoch 4/50
318/318 - 15s - loss: 3.3070 - accuracy1000: 0.3419 - val_loss: 3.2985 - val_accuracy1000: 0.3388 - 15s/epoch - 48ms/step
Epoch 5/50
318/318 - 14s - loss: 3.2996 - accuracy1000: 0.3448 - val_loss: 3.2973 - val_accuracy1000: 0.3412 - 14s/epoch - 45ms/step
Epoch 6/50
318/318 - 15s - loss: 3.2970 - accuracy1000: 0.3476 - val_loss: 3.2959 - val_accuracy1000: 0.3462 - 15s/epoch - 46ms/step
Epoch 7/50
318/318 - 15s - loss: 3.2941 - accuracy1000: 0.3527 - val_loss: 3.3012 - val_accuracy1000: 0.3413 - 15s/epoch - 47ms/step
Epoch 8/50
318/318 - 15s - loss: 3.2917 - accuracy1000: 0.3575 - val_loss: 3.3021 - val_accuracy1000: 0.3485 - 15s/epoch - 47ms/step
Epoch 9/50
318/318 - 15s - loss: 3.2862 - accuracy1000: 0.3667 - val_loss: 3.3046 - val_accuracy1000: 0.3495 - 15s/epoch - 46ms/step
Epoch 10/50
318/318 - 17s - loss: 3.2829 - accuracy1000: 0.3728 - val_loss: 3.3047 - val_accuracy1000: 0.3441 - 17s/epoch - 53ms/step
Epoch 11/50
318/318 - 15s - loss: 3.2822 - accuracy1000: 0.3721 - val_loss: 3.3061 - val_accuracy1000: 0.3502 - 15s/epoch - 46ms/step
Epoch 12/50
318/318 - 15s - loss: 3.2744 - accuracy1000: 0.3801 - val_loss: 3.3100 - val_accuracy1000: 0.3504 - 15s/epoch - 47ms/step
Epoch 13/50
318/318 - 16s - loss: 3.2739 - accuracy1000: 0.3839 - val_loss: 3.3096 - val_accuracy1000: 0.3498 - 16s/epoch - 49ms/step
testing model: results/LILAK/W0/deepVOL_L3/h1000
Evaluating performance on  test set...
876/876 - 21s - 21s/epoch - 24ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1002964
{'0': {'precision': 0.31487477775553696, 'recall': 0.38698754033833554, 'f1-score': 0.3472265503272047, 'support': 69103}, '1': {'precision': 0.3528443817583451, 'recall': 0.0579015044361579, 'f1-score': 0.09947863738788496, 'support': 77770}, '2': {'precision': 0.3487949139676113, 'recall': 0.5707668021013949, 'f1-score': 0.4329900955110775, 'support': 77282}, 'accuracy': 0.33617362985434185, 'macro avg': {'precision': 0.3388380244938311, 'recall': 0.33855194895862945, 'f1-score': 0.293231761075389, 'support': 224155}, 'weighted avg': {'precision': 0.33974289165011845, 'recall': 0.33617362985434185, 'f1-score': 0.2908397782704099, 'support': 224155}}
[[26742  4017 38344]
 [29257  4503 44010]
 [28930  4242 44110]]
Evaluating performance on  train set...
318/318 - 9s - 9s/epoch - 27ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0989954
{'0': {'precision': 0.343860526597835, 'recall': 0.35418583256669733, 'f1-score': 0.3489468150672516, 'support': 27175}, '1': {'precision': 0.35713147410358564, 'recall': 0.08186600423759773, 'f1-score': 0.13319860917114923, 'support': 27374}, '2': {'precision': 0.3317788850560027, 'recall': 0.5840173919562203, 'f1-score': 0.4231610108499341, 'support': 26679}, 'accuracy': 0.3379007238883144, 'macro avg': {'precision': 0.3442569619191411, 'recall': 0.3400230762535051, 'f1-score': 0.30176881169611164, 'support': 81228}, 'weighted avg': {'precision': 0.3443646976020192, 'recall': 0.3379007238883144, 'f1-score': 0.30061457915212725, 'support': 81228}}
[[ 9625  1962 15588]
 [ 9340  2241 15793]
 [ 9026  2072 15581]]
Evaluating performance on  val set...
104/104 - 3s - 3s/epoch - 29ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0976081
{'0': {'precision': 0.3421209117938553, 'recall': 0.3836408090686819, 'f1-score': 0.36169321039396474, 'support': 8998}, '1': {'precision': 0.3071748878923767, 'recall': 0.05080974162442824, 'f1-score': 0.08719635090696934, 'support': 8089}, '2': {'precision': 0.3573182874211749, 'recall': 0.5722942802466511, 'f1-score': 0.43994932777573453, 'support': 9406}, 'accuracy': 0.3489978484882799, 'macro avg': {'precision': 0.3355380290358023, 'recall': 0.3355816103132538, 'f1-score': 0.2962796296922228, 'support': 26493}, 'weighted avg': {'precision': 0.3368466177468054, 'recall': 0.3489978484882799, 'f1-score': 0.3056660312788257, 'support': 26493}}
[[3452  443 5103]
 [3099  411 4579]
 [3539  484 5383]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        11 (peak)   5.03 (ave)

============================================
