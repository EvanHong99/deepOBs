This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAPL_orderbooks/AAPL_orderbooks_2019-06-26.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-06-18.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-06-05.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-06-06.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-06-14.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-06-10.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-06-12.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-06-07.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-06-28.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-06-11.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-06-24.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-06-13.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-06-04.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-06-20.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-06-19.csv
training model: results/AAPL/W4/deepLOB_L1/h10
Epoch 1/50
5165/5165 - 96s - loss: 3.0627 - accuracy10: 0.4723 - val_loss: 3.2583 - val_accuracy10: 0.4090 - 96s/epoch - 19ms/step
Epoch 2/50
5165/5165 - 86s - loss: 3.0125 - accuracy10: 0.4905 - val_loss: 3.2917 - val_accuracy10: 0.4079 - 86s/epoch - 17ms/step
Epoch 3/50
5165/5165 - 89s - loss: 2.9932 - accuracy10: 0.4967 - val_loss: 3.2329 - val_accuracy10: 0.4057 - 89s/epoch - 17ms/step
Epoch 4/50
5165/5165 - 89s - loss: 2.9793 - accuracy10: 0.5009 - val_loss: 3.2820 - val_accuracy10: 0.3813 - 89s/epoch - 17ms/step
Epoch 5/50
5165/5165 - 91s - loss: 2.9693 - accuracy10: 0.5037 - val_loss: 3.3544 - val_accuracy10: 0.3845 - 91s/epoch - 18ms/step
Epoch 6/50
5165/5165 - 87s - loss: 2.9618 - accuracy10: 0.5056 - val_loss: 3.3324 - val_accuracy10: 0.3795 - 87s/epoch - 17ms/step
Epoch 7/50
5165/5165 - 84s - loss: 2.9544 - accuracy10: 0.5073 - val_loss: 3.3088 - val_accuracy10: 0.3952 - 84s/epoch - 16ms/step
Epoch 8/50
5165/5165 - 85s - loss: 2.9491 - accuracy10: 0.5086 - val_loss: 3.2811 - val_accuracy10: 0.3940 - 85s/epoch - 16ms/step
Epoch 9/50
5165/5165 - 87s - loss: 2.9446 - accuracy10: 0.5096 - val_loss: 3.2714 - val_accuracy10: 0.3814 - 87s/epoch - 17ms/step
Epoch 10/50
5165/5165 - 83s - loss: 2.9403 - accuracy10: 0.5105 - val_loss: 3.2621 - val_accuracy10: 0.3844 - 83s/epoch - 16ms/step
Epoch 11/50
5165/5165 - 82s - loss: 2.9368 - accuracy10: 0.5114 - val_loss: 3.2706 - val_accuracy10: 0.3818 - 82s/epoch - 16ms/step
Epoch 12/50
5165/5165 - 83s - loss: 2.9336 - accuracy10: 0.5120 - val_loss: 3.2608 - val_accuracy10: 0.3804 - 83s/epoch - 16ms/step
Epoch 13/50
5165/5165 - 82s - loss: 2.9310 - accuracy10: 0.5128 - val_loss: 3.2616 - val_accuracy10: 0.3751 - 82s/epoch - 16ms/step
testing model: results/AAPL/W4/deepLOB_L1/h10
Evaluating performance on  test set...
12724/12724 - 68s - 68s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1021025
{'0': {'precision': 0.4793090654654744, 'recall': 0.42042096480748187, 'f1-score': 0.44793787683808556, 'support': 915706}, '1': {'precision': 0.5412268254338471, 'recall': 0.21451394828282144, 'f1-score': 0.30725007113065655, 'support': 1417092}, '2': {'precision': 0.37367012562596313, 'recall': 0.7649599880564592, 'f1-score': 0.5020817408586778, 'support': 924349}, 'accuracy': 0.4286137530789983, 'macro avg': {'precision': 0.4647353388417616, 'recall': 0.4666316337155874, 'f1-score': 0.4190898962758067, 'support': 3257147}, 'weighted avg': {'precision': 0.47626834114673444, 'recall': 0.4286137530789983, 'f1-score': 0.4020941561211571, 'support': 3257147}}
[[384982 135009 395715]
 [323627 303986 789479]
 [ 94593 122666 707090]]
Evaluating performance on  train set...
5165/5165 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0624048
{'0': {'precision': 0.5213724250442983, 'recall': 0.3046248429386828, 'f1-score': 0.3845605772510907, 'support': 438523}, '1': {'precision': 0.37485839340885685, 'recall': 0.5256623469228877, 'f1-score': 0.43763332484813533, 'support': 443159}, '2': {'precision': 0.462991962991963, 'recall': 0.46722219699377865, 'f1-score': 0.4650974613047881, 'support': 440420}, 'accuracy': 0.4328796114066842, 'macro avg': {'precision': 0.453074260481706, 'recall': 0.43250312895178306, 'f1-score': 0.4290971211346714, 'support': 1322102}, 'weighted avg': {'precision': 0.4528142239050366, 'recall': 0.4328796114066842, 'f1-score': 0.4291787082480093, 'support': 1322102}}
[[133585 197414 107524]
 [ 79061 232952 131146]
 [ 43572 191074 205774]]
Evaluating performance on  val set...
1903/1903 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0774324
{'0': {'precision': 0.46932250259246455, 'recall': 0.3644032645691769, 'f1-score': 0.41026116456183004, 'support': 163942}, '1': {'precision': 0.34436432466537475, 'recall': 0.48801221132229716, 'f1-score': 0.4037932073158488, 'support': 156576}, '2': {'precision': 0.44561668287161327, 'recall': 0.3688927331483283, 'f1-score': 0.4036411436082813, 'support': 166482}, 'accuracy': 0.40567967145790557, 'macro avg': {'precision': 0.4197678367098175, 'recall': 0.4071027363466008, 'f1-score': 0.4058985051619867, 'support': 487000}, 'weighted avg': {'precision': 0.421043151574233, 'recall': 0.40567967145790557, 'f1-score': 0.40591857482438554, 'support': 487000}}
[[59741 71915 32286]
 [36047 76411 44118]
 [31504 73564 61414]]
training model: results/AAPL/W4/deepLOB_L1/h20
Epoch 1/50
5165/5165 - 87s - loss: 3.1166 - accuracy20: 0.4554 - val_loss: 3.6076 - val_accuracy20: 0.3903 - 87s/epoch - 17ms/step
Epoch 2/50
5165/5165 - 85s - loss: 3.0723 - accuracy20: 0.4714 - val_loss: 3.3397 - val_accuracy20: 0.3698 - 85s/epoch - 16ms/step
Epoch 3/50
5165/5165 - 84s - loss: 3.0583 - accuracy20: 0.4762 - val_loss: 3.3404 - val_accuracy20: 0.3660 - 84s/epoch - 16ms/step
Epoch 4/50
5165/5165 - 85s - loss: 3.0486 - accuracy20: 0.4797 - val_loss: 3.3293 - val_accuracy20: 0.3486 - 85s/epoch - 17ms/step
Epoch 5/50
5165/5165 - 85s - loss: 3.0422 - accuracy20: 0.4816 - val_loss: 3.3588 - val_accuracy20: 0.3484 - 85s/epoch - 17ms/step
Epoch 6/50
5165/5165 - 84s - loss: 3.0375 - accuracy20: 0.4830 - val_loss: 3.3576 - val_accuracy20: 0.3555 - 84s/epoch - 16ms/step
Epoch 7/50
5165/5165 - 84s - loss: 3.0330 - accuracy20: 0.4843 - val_loss: 3.3802 - val_accuracy20: 0.3483 - 84s/epoch - 16ms/step
Epoch 8/50
5165/5165 - 83s - loss: 3.0296 - accuracy20: 0.4854 - val_loss: 3.3594 - val_accuracy20: 0.3548 - 83s/epoch - 16ms/step
Epoch 9/50
5165/5165 - 86s - loss: 3.0262 - accuracy20: 0.4862 - val_loss: 3.4211 - val_accuracy20: 0.3484 - 86s/epoch - 17ms/step
Epoch 10/50
5165/5165 - 85s - loss: 3.0236 - accuracy20: 0.4872 - val_loss: 3.3789 - val_accuracy20: 0.3488 - 85s/epoch - 17ms/step
Epoch 11/50
5165/5165 - 84s - loss: 3.0211 - accuracy20: 0.4878 - val_loss: 3.3763 - val_accuracy20: 0.3497 - 84s/epoch - 16ms/step
Epoch 12/50
5165/5165 - 85s - loss: 3.0188 - accuracy20: 0.4888 - val_loss: 3.3830 - val_accuracy20: 0.3543 - 85s/epoch - 16ms/step
Epoch 13/50
5165/5165 - 84s - loss: 3.0166 - accuracy20: 0.4892 - val_loss: 3.3724 - val_accuracy20: 0.3574 - 84s/epoch - 16ms/step
Epoch 14/50
5165/5165 - 83s - loss: 3.0144 - accuracy20: 0.4898 - val_loss: 3.3486 - val_accuracy20: 0.3586 - 83s/epoch - 16ms/step
testing model: results/AAPL/W4/deepLOB_L1/h20
Evaluating performance on  test set...
12724/12724 - 66s - 66s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0562946
{'0': {'precision': 0.47213010751794504, 'recall': 0.36113709929487553, 'f1-score': 0.40924134809281926, 'support': 943805}, '1': {'precision': 0.45579905370600615, 'recall': 0.425476656118804, 'f1-score': 0.4401161976233263, 'support': 1373422}, '2': {'precision': 0.3873929013451519, 'recall': 0.5164992765341732, 'f1-score': 0.4427257103799348, 'support': 939920}, 'accuracy': 0.433099887723827, 'macro avg': {'precision': 0.4384406875230344, 'recall': 0.4343710106492842, 'f1-score': 0.4306944186986934, 'support': 3257147}, 'weighted avg': {'precision': 0.4407911401902706, 'recall': 0.433099887723827, 'f1-score': 0.43192279888174395, 'support': 3257147}}
[[340843 345125 257837]
 [279201 584359 509862]
 [101882 352570 485468]]
Evaluating performance on  train set...
5165/5165 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1122789
{'0': {'precision': 0.51223481837132, 'recall': 0.1854183236238475, 'f1-score': 0.27227777130783437, 'support': 441321}, '1': {'precision': 0.3432181098062158, 'recall': 0.70299596543625, 'f1-score': 0.46124584283098535, 'support': 438957}, '2': {'precision': 0.45455443288004255, 'recall': 0.27084540450496125, 'f1-score': 0.33943757055896884, 'support': 441824}, 'accuracy': 0.3858098694351873, 'macro avg': {'precision': 0.43666912035252614, 'recall': 0.38641989785501957, 'f1-score': 0.35765372823259617, 'support': 1322102}, 'weighted avg': {'precision': 0.4368430210811634, 'recall': 0.3858098694351873, 'f1-score': 0.3574615687122109, 'support': 1322102}}
[[ 81829 298691  60801]
 [ 47579 308585  82793]
 [ 30341 291817 119666]]
Evaluating performance on  val set...
1903/1903 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1099567
{'0': {'precision': 0.5188863165590349, 'recall': 0.1037880126490498, 'f1-score': 0.17297703489700483, 'support': 164123}, '1': {'precision': 0.3135491244361171, 'recall': 0.7161457516298857, 'f1-score': 0.4361425478780422, 'support': 159367}, '2': {'precision': 0.4278427110825257, 'recall': 0.23596110329643447, 'f1-score': 0.304168900381571, 'support': 163510}, 'accuracy': 0.34855441478439425, 'macro avg': {'precision': 0.4200927173592259, 'recall': 0.3519649558584566, 'f1-score': 0.3044294943855394, 'support': 487000}, 'weighted avg': {'precision': 0.4211234577735789, 'recall': 0.34855441478439425, 'f1-score': 0.30314352408105083, 'support': 487000}}
[[ 17034 128987  18102]
 [ 11743 114130  33494]
 [  4051 120877  38582]]
training model: results/AAPL/W4/deepLOB_L1/h30
Epoch 1/50
5165/5165 - 87s - loss: 3.1554 - accuracy30: 0.4414 - val_loss: 3.4558 - val_accuracy30: 0.3876 - 87s/epoch - 17ms/step
Epoch 2/50
5165/5165 - 85s - loss: 3.1170 - accuracy30: 0.4576 - val_loss: 3.3359 - val_accuracy30: 0.3892 - 85s/epoch - 16ms/step
Epoch 3/50
5165/5165 - 86s - loss: 3.1040 - accuracy30: 0.4625 - val_loss: 3.2752 - val_accuracy30: 0.3640 - 86s/epoch - 17ms/step
Epoch 4/50
5165/5165 - 85s - loss: 3.0969 - accuracy30: 0.4655 - val_loss: 3.2733 - val_accuracy30: 0.3737 - 85s/epoch - 16ms/step
Epoch 5/50
5165/5165 - 85s - loss: 3.0916 - accuracy30: 0.4673 - val_loss: 3.2830 - val_accuracy30: 0.3717 - 85s/epoch - 16ms/step
Epoch 6/50
5165/5165 - 84s - loss: 3.0873 - accuracy30: 0.4685 - val_loss: 3.2504 - val_accuracy30: 0.3697 - 84s/epoch - 16ms/step
Epoch 7/50
5165/5165 - 85s - loss: 3.0838 - accuracy30: 0.4698 - val_loss: 3.2906 - val_accuracy30: 0.3500 - 85s/epoch - 17ms/step
Epoch 8/50
5165/5165 - 87s - loss: 3.0809 - accuracy30: 0.4710 - val_loss: 3.2968 - val_accuracy30: 0.3516 - 87s/epoch - 17ms/step
Epoch 9/50
5165/5165 - 85s - loss: 3.0788 - accuracy30: 0.4712 - val_loss: 3.3393 - val_accuracy30: 0.3520 - 85s/epoch - 16ms/step
Epoch 10/50
5165/5165 - 85s - loss: 3.0765 - accuracy30: 0.4722 - val_loss: 3.3564 - val_accuracy30: 0.3555 - 85s/epoch - 17ms/step
Epoch 11/50
5165/5165 - 83s - loss: 3.0751 - accuracy30: 0.4724 - val_loss: 3.4573 - val_accuracy30: 0.3760 - 83s/epoch - 16ms/step
Epoch 12/50
5165/5165 - 83s - loss: 3.0727 - accuracy30: 0.4731 - val_loss: 3.4591 - val_accuracy30: 0.3796 - 83s/epoch - 16ms/step
Epoch 13/50
5165/5165 - 84s - loss: 3.0710 - accuracy30: 0.4737 - val_loss: 3.5223 - val_accuracy30: 0.3906 - 84s/epoch - 16ms/step
Epoch 14/50
5165/5165 - 84s - loss: 3.0694 - accuracy30: 0.4745 - val_loss: 3.4901 - val_accuracy30: 0.3838 - 84s/epoch - 16ms/step
Epoch 15/50
5165/5165 - 86s - loss: 3.0679 - accuracy30: 0.4745 - val_loss: 3.4520 - val_accuracy30: 0.3863 - 86s/epoch - 17ms/step
Epoch 16/50
5165/5165 - 84s - loss: 3.0666 - accuracy30: 0.4751 - val_loss: 3.4471 - val_accuracy30: 0.3847 - 84s/epoch - 16ms/step
testing model: results/AAPL/W4/deepLOB_L1/h30
Evaluating performance on  test set...
12724/12724 - 72s - 72s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.063792
{'0': {'precision': 0.4458973143037338, 'recall': 0.38463023910131955, 'f1-score': 0.4130039753940278, 'support': 963190}, '1': {'precision': 0.43854710192702545, 'recall': 0.3492595104007585, 'f1-score': 0.38884351491829344, 'support': 1333172}, '2': {'precision': 0.3900668420099944, 'recall': 0.5539949104117987, 'f1-score': 0.4577985383680536, 'support': 960785}, 'accuracy': 0.42011152705112786, 'macro avg': {'precision': 0.4248370860802512, 'recall': 0.4292948866379589, 'f1-score': 0.41988200956012495, 'support': 3257147}, 'weighted avg': {'precision': 0.42642009155099303, 'recall': 0.42011152705112786, 'f1-score': 0.4163283248242634, 'support': 3257147}}
[[370472 305870 286848]
 [322106 465623 545443]
 [138268 290247 532270]]
Evaluating performance on  train set...
5165/5165 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1026464
{'0': {'precision': 0.48070335585627977, 'recall': 0.22957889225223768, 'f1-score': 0.3107478589907181, 'support': 444993}, '1': {'precision': 0.34200851238069163, 'recall': 0.6431932940731686, 'f1-score': 0.446563496408902, 'support': 431141}, '2': {'precision': 0.45495867906908244, 'recall': 0.30478195744986186, 'f1-score': 0.36502772156776914, 'support': 445968}, 'accuracy': 0.38982695737545214, 'macro avg': {'precision': 0.4258901824353513, 'recall': 0.3925180479250894, 'f1-score': 0.37411302565579646, 'support': 1322102}, 'weighted avg': {'precision': 0.4267904690076544, 'recall': 0.38982695737545214, 'f1-score': 0.37334724352071313, 'support': 1322102}}
[[102161 271733  71099]
 [ 62097 277307  91737]
 [ 48266 261779 135923]]
Evaluating performance on  val set...
1903/1903 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0850654
{'0': {'precision': 0.431287704477031, 'recall': 0.23094274855951943, 'f1-score': 0.3008099897403961, 'support': 163140}, '1': {'precision': 0.3406379145247455, 'recall': 0.6667838161123648, 'f1-score': 0.4509171117754734, 'support': 162186}, '2': {'precision': 0.4206958659381047, 'recall': 0.21381916696562217, 'f1-score': 0.2835325719206873, 'support': 161674}, 'accuracy': 0.3704065708418891, 'macro avg': {'precision': 0.39754049497996036, 'recall': 0.3705152438791688, 'f1-score': 0.3450865578121856, 'support': 487000}, 'weighted avg': {'precision': 0.39758225943156134, 'recall': 0.3704065708418891, 'f1-score': 0.34506453685702326, 'support': 487000}}
[[ 37676 108132  17332]
 [ 23773 108143  30270]
 [ 25908 101197  34569]]
training model: results/AAPL/W4/deepLOB_L1/h50
Epoch 1/50
5165/5165 - 84s - loss: 3.1480 - accuracy50: 0.4450 - val_loss: 3.3529 - val_accuracy50: 0.3650 - 84s/epoch - 16ms/step
Epoch 2/50
5165/5165 - 83s - loss: 3.1198 - accuracy50: 0.4575 - val_loss: 3.4154 - val_accuracy50: 0.3573 - 83s/epoch - 16ms/step
Epoch 3/50
5165/5165 - 83s - loss: 3.1051 - accuracy50: 0.4639 - val_loss: 3.5092 - val_accuracy50: 0.3572 - 83s/epoch - 16ms/step
Epoch 4/50
5165/5165 - 83s - loss: 3.0973 - accuracy50: 0.4667 - val_loss: 3.5264 - val_accuracy50: 0.3565 - 83s/epoch - 16ms/step
Epoch 5/50
5165/5165 - 84s - loss: 3.0926 - accuracy50: 0.4685 - val_loss: 3.4451 - val_accuracy50: 0.3595 - 84s/epoch - 16ms/step
Epoch 6/50
5165/5165 - 84s - loss: 3.0894 - accuracy50: 0.4699 - val_loss: 3.4714 - val_accuracy50: 0.3595 - 84s/epoch - 16ms/step
Epoch 7/50
5165/5165 - 84s - loss: 3.0859 - accuracy50: 0.4708 - val_loss: 3.4787 - val_accuracy50: 0.3566 - 84s/epoch - 16ms/step
Epoch 8/50
5165/5165 - 83s - loss: 3.0828 - accuracy50: 0.4720 - val_loss: 3.5205 - val_accuracy50: 0.3568 - 83s/epoch - 16ms/step
Epoch 9/50
5165/5165 - 83s - loss: 3.0810 - accuracy50: 0.4724 - val_loss: 3.4945 - val_accuracy50: 0.3592 - 83s/epoch - 16ms/step
Epoch 10/50
5165/5165 - 83s - loss: 3.0791 - accuracy50: 0.4732 - val_loss: 3.4917 - val_accuracy50: 0.3588 - 83s/epoch - 16ms/step
Epoch 11/50
5165/5165 - 84s - loss: 3.0770 - accuracy50: 0.4738 - val_loss: 3.4473 - val_accuracy50: 0.3654 - 84s/epoch - 16ms/step
testing model: results/AAPL/W4/deepLOB_L1/h50
Evaluating performance on  test set...
12724/12724 - 68s - 68s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0649714
{'0': {'precision': 0.39577263492763437, 'recall': 0.2290028773012145, 'f1-score': 0.29013003993124953, 'support': 877906}, '1': {'precision': 0.48157988930598816, 'recall': 0.540164546898786, 'f1-score': 0.509192658134332, 'support': 1506926}, '2': {'precision': 0.35580012201041433, 'recall': 0.4319150765491824, 'f1-score': 0.3901802001925187, 'support': 872315}, 'accuracy': 0.427305552988551, 'macro avg': {'precision': 0.41105088208134566, 'recall': 0.400360833583061, 'f1-score': 0.3965009660860334, 'support': 3257147}, 'weighted avg': {'precision': 0.4247662787533415, 'recall': 0.427305552988551, 'f1-score': 0.41827482754648676, 'support': 3257147}}
[[201043 466989 209874]
 [220652 813988 472286]
 [ 86281 409268 376766]]
Evaluating performance on  train set...
5165/5165 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1241392
{'0': {'precision': 0.4220648005694735, 'recall': 0.16699260228359353, 'f1-score': 0.23930333117970534, 'support': 440271}, '1': {'precision': 0.3463033688421341, 'recall': 0.7815348146533521, 'f1-score': 0.479941436887789, 'support': 440418}, '2': {'precision': 0.40532167768584304, 'recall': 0.1413845990036542, 'f1-score': 0.20964179600831057, 'support': 441413}, 'accuracy': 0.3631588183060006, 'macro avg': {'precision': 0.39122994903248354, 'recall': 0.36330400531353324, 'f1-score': 0.30962885469193496, 'support': 1322102}, 'weighted avg': {'precision': 0.39123712589692683, 'recall': 0.3631588183060006, 'f1-score': 0.3095614247421778, 'support': 1322102}}
[[ 73522 326510  40239]
 [ 44890 344202  51326]
 [ 55784 323220  62409]]
Evaluating performance on  val set...
1903/1903 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1174576
{'0': {'precision': 0.45213137665967856, 'recall': 0.02050011406554967, 'f1-score': 0.03922186725186259, 'support': 157804}, '1': {'precision': 0.3620615524427007, 'recall': 0.8561286558490697, 'f1-score': 0.5089045505661381, 'support': 173113}, '2': {'precision': 0.3684524062805838, 'recall': 0.16643068111197248, 'f1-score': 0.22929042394499216, 'support': 156083}, 'accuracy': 0.3643100616016427, 'macro avg': {'precision': 0.39421511179432106, 'recall': 0.3476864836755306, 'f1-score': 0.259138947254331, 'support': 487000}, 'weighted avg': {'precision': 0.39329539675546105, 'recall': 0.3643100616016427, 'f1-score': 0.2670958896151438, 'support': 487000}}
[[  3235 132252  22317]
 [  2697 148207  22209]
 [  1223 128883  25977]]
training model: results/AAPL/W4/deepLOB_L1/h100
Epoch 1/50
5165/5165 - 84s - loss: 3.2400 - accuracy100: 0.4004 - val_loss: 3.3350 - val_accuracy100: 0.3478 - 84s/epoch - 16ms/step
Epoch 2/50
5165/5165 - 81s - loss: 3.2229 - accuracy100: 0.4102 - val_loss: 3.3960 - val_accuracy100: 0.3468 - 81s/epoch - 16ms/step
Epoch 3/50
5165/5165 - 83s - loss: 3.2117 - accuracy100: 0.4172 - val_loss: 3.3781 - val_accuracy100: 0.3480 - 83s/epoch - 16ms/step
Epoch 4/50
5165/5165 - 83s - loss: 3.2042 - accuracy100: 0.4218 - val_loss: 3.3700 - val_accuracy100: 0.3483 - 83s/epoch - 16ms/step
Epoch 5/50
5165/5165 - 82s - loss: 3.2000 - accuracy100: 0.4234 - val_loss: 3.3392 - val_accuracy100: 0.3538 - 82s/epoch - 16ms/step
Epoch 6/50
5165/5165 - 83s - loss: 3.1973 - accuracy100: 0.4245 - val_loss: 3.3539 - val_accuracy100: 0.3473 - 83s/epoch - 16ms/step
Epoch 7/50
5165/5165 - 82s - loss: 3.1942 - accuracy100: 0.4265 - val_loss: 3.3369 - val_accuracy100: 0.3453 - 82s/epoch - 16ms/step
Epoch 8/50
5165/5165 - 82s - loss: 3.1923 - accuracy100: 0.4273 - val_loss: 3.3365 - val_accuracy100: 0.3474 - 82s/epoch - 16ms/step
Epoch 9/50
5165/5165 - 83s - loss: 3.1898 - accuracy100: 0.4284 - val_loss: 3.3227 - val_accuracy100: 0.3518 - 83s/epoch - 16ms/step
Epoch 10/50
5165/5165 - 82s - loss: 3.1878 - accuracy100: 0.4296 - val_loss: 3.3279 - val_accuracy100: 0.3482 - 82s/epoch - 16ms/step
Epoch 11/50
5165/5165 - 83s - loss: 3.1861 - accuracy100: 0.4303 - val_loss: 3.3196 - val_accuracy100: 0.3474 - 83s/epoch - 16ms/step
Epoch 12/50
5165/5165 - 83s - loss: 3.1846 - accuracy100: 0.4309 - val_loss: 3.3223 - val_accuracy100: 0.3462 - 83s/epoch - 16ms/step
Epoch 13/50
5165/5165 - 82s - loss: 3.1829 - accuracy100: 0.4311 - val_loss: 3.3133 - val_accuracy100: 0.3503 - 82s/epoch - 16ms/step
Epoch 14/50
5165/5165 - 84s - loss: 3.1818 - accuracy100: 0.4317 - val_loss: 3.3253 - val_accuracy100: 0.3467 - 84s/epoch - 16ms/step
Epoch 15/50
5165/5165 - 82s - loss: 3.1805 - accuracy100: 0.4322 - val_loss: 3.3118 - val_accuracy100: 0.3551 - 82s/epoch - 16ms/step
Epoch 16/50
5165/5165 - 83s - loss: 3.1798 - accuracy100: 0.4324 - val_loss: 3.3065 - val_accuracy100: 0.3529 - 83s/epoch - 16ms/step
Epoch 17/50
5165/5165 - 83s - loss: 3.1785 - accuracy100: 0.4334 - val_loss: 3.3108 - val_accuracy100: 0.3497 - 83s/epoch - 16ms/step
Epoch 18/50
5165/5165 - 81s - loss: 3.1776 - accuracy100: 0.4337 - val_loss: 3.3268 - val_accuracy100: 0.3468 - 81s/epoch - 16ms/step
Epoch 19/50
5165/5165 - 82s - loss: 3.1767 - accuracy100: 0.4337 - val_loss: 3.3132 - val_accuracy100: 0.3520 - 82s/epoch - 16ms/step
Epoch 20/50
5165/5165 - 83s - loss: 3.1760 - accuracy100: 0.4344 - val_loss: 3.3404 - val_accuracy100: 0.3418 - 83s/epoch - 16ms/step
Epoch 21/50
5165/5165 - 83s - loss: 3.1754 - accuracy100: 0.4346 - val_loss: 3.3280 - val_accuracy100: 0.3449 - 83s/epoch - 16ms/step
Epoch 22/50
5165/5165 - 83s - loss: 3.1741 - accuracy100: 0.4354 - val_loss: 3.3376 - val_accuracy100: 0.3416 - 83s/epoch - 16ms/step
Epoch 23/50
5165/5165 - 81s - loss: 3.1731 - accuracy100: 0.4356 - val_loss: 3.3747 - val_accuracy100: 0.3387 - 81s/epoch - 16ms/step
Epoch 24/50
5165/5165 - 85s - loss: 3.1722 - accuracy100: 0.4359 - val_loss: 3.3492 - val_accuracy100: 0.3420 - 85s/epoch - 16ms/step
Epoch 25/50
5165/5165 - 84s - loss: 3.1714 - accuracy100: 0.4361 - val_loss: 3.3432 - val_accuracy100: 0.3418 - 84s/epoch - 16ms/step
Epoch 26/50
5165/5165 - 84s - loss: 3.1707 - accuracy100: 0.4365 - val_loss: 3.3786 - val_accuracy100: 0.3386 - 84s/epoch - 16ms/step
testing model: results/AAPL/W4/deepLOB_L1/h100
Evaluating performance on  test set...
12724/12724 - 75s - 75s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1286733
{'0': {'precision': 0.3124834436003179, 'recall': 0.510248328792405, 'f1-score': 0.38759693067073836, 'support': 936299}, '1': {'precision': 0.42186783763521474, 'recall': 0.4292342831238912, 'f1-score': 0.42551918140885486, 'support': 1376514}, '2': {'precision': 0.3778056460766724, 'recall': 0.13111780365845135, 'f1-score': 0.1946738612619157, 'support': 944334}, 'accuracy': 0.3660906308496362, 'macro avg': {'precision': 0.370718975770735, 'recall': 0.3568668051915825, 'f1-score': 0.3359299911138363, 'support': 3257147}, 'weighted avg': {'precision': 0.37764940833075766, 'recall': 0.3660906308496362, 'f1-score': 0.3476898264551216, 'support': 3257147}}
[[477745 387508  71046]
 [652800 590847 132867]
 [398320 422195 123819]]
Evaluating performance on  train set...
5165/5165 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1724404
{'0': {'precision': 0.3567748166450955, 'recall': 0.32951550826352727, 'f1-score': 0.34260379543624925, 'support': 441700}, '1': {'precision': 0.3432043863508524, 'recall': 0.5647752918399377, 'f1-score': 0.4269552769028383, 'support': 436455}, '2': {'precision': 0.37839548391706906, 'recall': 0.16699290681094817, 'f1-score': 0.23172243068503084, 'support': 443947}, 'accuracy': 0.35260668238910464, 'macro avg': {'precision': 0.3594582289710057, 'recall': 0.3537612356381377, 'f1-score': 0.3337605010080395, 'support': 1322102}, 'weighted avg': {'precision': 0.35955489580639843, 'recall': 0.35260668238910464, 'f1-score': 0.3332173612627066, 'support': 1322102}}
[[145547 242046  54107]
 [122277 246499  67679]
 [140128 229683  74136]]
Evaluating performance on  val set...
1903/1903 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.102922
{'0': {'precision': 0.35111240036323277, 'recall': 0.1734668444599529, 'f1-score': 0.23221033139539732, 'support': 160486}, '1': {'precision': 0.3536327165520519, 'recall': 0.6361396942320225, 'f1-score': 0.4545687588920648, 'support': 167251}, '2': {'precision': 0.35059757227489263, 'recall': 0.2352147077475622, 'f1-score': 0.2815431096681097, 'support': 159263}, 'accuracy': 0.3525564681724846, 'macro avg': {'precision': 0.3517808963967258, 'recall': 0.34827374881317924, 'f1-score': 0.32277406665185726, 'support': 487000}, 'weighted avg': {'precision': 0.35180959202044604, 'recall': 0.3525564681724846, 'f1-score': 0.32470839222351255, 'support': 487000}}
[[ 27839  99611  33036]
 [ 24504 106395  36352]
 [ 26945  94857  37461]]
training model: results/AAPL/W4/deepLOB_L1/h200
Epoch 1/50
5165/5165 - 85s - loss: 3.2291 - accuracy200: 0.4080 - val_loss: 3.3276 - val_accuracy200: 0.3194 - 85s/epoch - 16ms/step
Epoch 2/50
5165/5165 - 83s - loss: 3.2085 - accuracy200: 0.4195 - val_loss: 3.3606 - val_accuracy200: 0.3177 - 83s/epoch - 16ms/step
Epoch 3/50
5165/5165 - 84s - loss: 3.2030 - accuracy200: 0.4226 - val_loss: 3.3928 - val_accuracy200: 0.3067 - 84s/epoch - 16ms/step
Epoch 4/50
5165/5165 - 87s - loss: 3.1999 - accuracy200: 0.4243 - val_loss: 3.3712 - val_accuracy200: 0.3301 - 87s/epoch - 17ms/step
Epoch 5/50
5165/5165 - 85s - loss: 3.1972 - accuracy200: 0.4265 - val_loss: 3.4047 - val_accuracy200: 0.3291 - 85s/epoch - 16ms/step
Epoch 6/50
5165/5165 - 84s - loss: 3.1902 - accuracy200: 0.4298 - val_loss: 3.3724 - val_accuracy200: 0.3268 - 84s/epoch - 16ms/step
Epoch 7/50
5165/5165 - 84s - loss: 3.1861 - accuracy200: 0.4319 - val_loss: 3.4093 - val_accuracy200: 0.3295 - 84s/epoch - 16ms/step
Epoch 8/50
5165/5165 - 83s - loss: 3.1831 - accuracy200: 0.4334 - val_loss: 3.3998 - val_accuracy200: 0.3261 - 83s/epoch - 16ms/step
Epoch 9/50
5165/5165 - 83s - loss: 3.1804 - accuracy200: 0.4342 - val_loss: 3.4199 - val_accuracy200: 0.3249 - 83s/epoch - 16ms/step
Epoch 10/50
5165/5165 - 85s - loss: 3.1784 - accuracy200: 0.4348 - val_loss: 3.4882 - val_accuracy200: 0.3335 - 85s/epoch - 16ms/step
Epoch 11/50
5165/5165 - 86s - loss: 3.1757 - accuracy200: 0.4360 - val_loss: 3.5159 - val_accuracy200: 0.3341 - 86s/epoch - 17ms/step
testing model: results/AAPL/W4/deepLOB_L1/h200
Evaluating performance on  test set...
12724/12724 - 74s - 74s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.115273
{'0': {'precision': 0.274713963087129, 'recall': 0.679693298172557, 'f1-score': 0.39128210189494683, 'support': 886594}, '1': {'precision': 0.4598974314492958, 'recall': 0.1454091199856294, 'f1-score': 0.2209567388033889, 'support': 1458533}, '2': {'precision': 0.32197033834998356, 'recall': 0.21266309949343215, 'f1-score': 0.25614263999144227, 'support': 912020}, 'accuracy': 0.30967254471474576, 'macro avg': {'precision': 0.35219391096213615, 'recall': 0.34592183921720615, 'f1-score': 0.2894604935632593, 'support': 3257147}, 'weighted avg': {'precision': 0.37087018785312964, 'recall': 0.30967254471474576, 'f1-score': 0.277171484581312, 'support': 3257147}}
[[602612 128266 155716]
 [993724 212084 252725]
 [597262 120805 193953]]
Evaluating performance on  train set...
5165/5165 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1285057
{'0': {'precision': 0.3504904952912452, 'recall': 0.3672661484305578, 'f1-score': 0.3586822787168135, 'support': 437767}, '1': {'precision': 0.34777412129621027, 'recall': 0.24557144182405236, 'f1-score': 0.28787066999098193, 'support': 441961}, '2': {'precision': 0.3267295842757975, 'recall': 0.4071826101895681, 'f1-score': 0.36254638076558077, 'support': 442374}, 'accuracy': 0.3399412450779138, 'macro avg': {'precision': 0.34166473362108435, 'recall': 0.34000673348139276, 'f1-score': 0.336366443157792, 'support': 1322102}, 'weighted avg': {'precision': 0.34163207089073205, 'recall': 0.3399412450779138, 'f1-score': 0.33630383051511964, 'support': 1322102}}
[[160777 101197 175793]
 [138045 108533 195383]
 [159898 102349 180127]]
Evaluating performance on  val set...
1903/1903 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1089151
{'0': {'precision': 0.3384691209874427, 'recall': 0.09915627707258277, 'f1-score': 0.15337929695086425, 'support': 159294}, '1': {'precision': 0.3211113721804511, 'recall': 0.3225741732952534, 'f1-score': 0.321841110600869, 'support': 169468}, '2': {'precision': 0.3149162884032966, 'recall': 0.5375257523477294, 'f1-score': 0.3971545436717312, 'support': 158238}, 'accuracy': 0.3193388090349076, 'macro avg': {'precision': 0.32483226052373015, 'recall': 0.3197520675718552, 'f1-score': 0.29079165040782146, 'support': 487000}, 'weighted avg': {'precision': 0.32477602838523867, 'recall': 0.3193388090349076, 'f1-score': 0.2912096750335245, 'support': 487000}}
[[15795 58235 85264]
 [15029 54666 99773]
 [15842 57339 85057]]
training model: results/AAPL/W4/deepLOB_L1/h300
Epoch 1/50
5165/5165 - 88s - loss: 3.2367 - accuracy300: 0.4051 - val_loss: 3.3470 - val_accuracy300: 0.3208 - 88s/epoch - 17ms/step
Epoch 2/50
5165/5165 - 84s - loss: 3.2166 - accuracy300: 0.4158 - val_loss: 3.3472 - val_accuracy300: 0.3210 - 84s/epoch - 16ms/step
Epoch 3/50
5165/5165 - 87s - loss: 3.2078 - accuracy300: 0.4204 - val_loss: 3.4164 - val_accuracy300: 0.3242 - 87s/epoch - 17ms/step
Epoch 4/50
5165/5165 - 85s - loss: 3.2011 - accuracy300: 0.4244 - val_loss: 3.4255 - val_accuracy300: 0.3154 - 85s/epoch - 16ms/step
Epoch 5/50
5165/5165 - 84s - loss: 3.1957 - accuracy300: 0.4273 - val_loss: 3.4361 - val_accuracy300: 0.3222 - 84s/epoch - 16ms/step
Epoch 6/50
5165/5165 - 83s - loss: 3.1920 - accuracy300: 0.4287 - val_loss: 3.4426 - val_accuracy300: 0.3191 - 83s/epoch - 16ms/step
Epoch 7/50
5165/5165 - 82s - loss: 3.1898 - accuracy300: 0.4300 - val_loss: 3.4553 - val_accuracy300: 0.3159 - 82s/epoch - 16ms/step
Epoch 8/50
5165/5165 - 83s - loss: 3.1871 - accuracy300: 0.4305 - val_loss: 3.4412 - val_accuracy300: 0.3225 - 83s/epoch - 16ms/step
Epoch 9/50
5165/5165 - 82s - loss: 3.1844 - accuracy300: 0.4315 - val_loss: 3.4594 - val_accuracy300: 0.3152 - 82s/epoch - 16ms/step
Epoch 10/50
5165/5165 - 83s - loss: 3.1808 - accuracy300: 0.4336 - val_loss: 3.4705 - val_accuracy300: 0.3188 - 83s/epoch - 16ms/step
Epoch 11/50
5165/5165 - 82s - loss: 3.1790 - accuracy300: 0.4341 - val_loss: 3.4877 - val_accuracy300: 0.3151 - 82s/epoch - 16ms/step
testing model: results/AAPL/W4/deepLOB_L1/h300
Evaluating performance on  test set...
12724/12724 - 87s - 87s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1451892
{'0': {'precision': 0.27887326680148744, 'recall': 0.7235368054695624, 'f1-score': 0.4025798985344784, 'support': 912541}, '1': {'precision': 0.3260571833066601, 'recall': 0.030132355680827554, 'f1-score': 0.055166533231792644, 'support': 1406362}, '2': {'precision': 0.328538647772288, 'recall': 0.26598091754383724, 'f1-score': 0.2939684951717923, 'support': 938244}, 'accuracy': 0.2923383562363013, 'macro avg': {'precision': 0.31115636596014523, 'recall': 0.33988335956474236, 'f1-score': 0.2505716423126878, 'support': 3257147}, 'weighted avg': {'precision': 0.31355266963090084, 'recall': 0.2923383562363013, 'f1-score': 0.22128843309234889, 'support': 3257147}}
[[ 660257   45182  207102]
 [1061051   42377  302934]
 [ 646280   42409  249555]]
Evaluating performance on  train set...
5165/5165 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.123239
{'0': {'precision': 0.3492869745877285, 'recall': 0.4133975184758289, 'f1-score': 0.37864771040641554, 'support': 442470}, '1': {'precision': 0.35012940297988165, 'recall': 0.3021732954217357, 'f1-score': 0.32438852631370135, 'support': 432937}, '2': {'precision': 0.33193025078923394, 'recall': 0.3156449031218169, 'f1-score': 0.32358280338828244, 'support': 446695}, 'accuracy': 0.3439485001913619, 'macro avg': {'precision': 0.34378220945228133, 'recall': 0.3437385723397939, 'f1-score': 0.34220634670279976, 'support': 1322102}, 'weighted avg': {'precision': 0.34369856815890915, 'recall': 0.3439485001913619, 'f1-score': 0.34227530719999705, 'support': 1322102}}
[[182916 119833 139721]
 [158054 130822 144061]
 [182714 122984 140997]]
Evaluating performance on  val set...
1903/1903 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1154354
{'0': {'precision': 0.33456646227132214, 'recall': 0.16347249046699353, 'f1-score': 0.21963106505430896, 'support': 161544}, '1': {'precision': 0.3229569205322908, 'recall': 0.5217378102473477, 'f1-score': 0.3989579439360835, 'support': 164667}, '2': {'precision': 0.3126055981076819, 'recall': 0.2761693896970564, 'f1-score': 0.29326007059903514, 'support': 160789}, 'accuracy': 0.3218193018480493, 'macro avg': {'precision': 0.32337632697043156, 'recall': 0.3204598968037992, 'f1-score': 0.30394969319647586, 'support': 487000}, 'weighted avg': {'precision': 0.3233903353769718, 'recall': 0.3218193018480493, 'f1-score': 0.3045755277593524, 'support': 487000}}
[[26408 89940 45196]
 [26307 85913 52447]
 [26217 90167 44405]]
training model: results/AAPL/W4/deepLOB_L1/h500
Epoch 1/50
5165/5165 - 85s - loss: 3.2193 - accuracy500: 0.4187 - val_loss: 3.3491 - val_accuracy500: 0.3117 - 85s/epoch - 16ms/step
Epoch 2/50
5165/5165 - 82s - loss: 3.1894 - accuracy500: 0.4316 - val_loss: 3.3537 - val_accuracy500: 0.3074 - 82s/epoch - 16ms/step
Epoch 3/50
5165/5165 - 83s - loss: 3.1739 - accuracy500: 0.4373 - val_loss: 3.3782 - val_accuracy500: 0.3038 - 83s/epoch - 16ms/step
Epoch 4/50
5165/5165 - 80s - loss: 3.1657 - accuracy500: 0.4410 - val_loss: 3.3750 - val_accuracy500: 0.3096 - 80s/epoch - 15ms/step
Epoch 5/50
5165/5165 - 83s - loss: 3.1592 - accuracy500: 0.4432 - val_loss: 3.3716 - val_accuracy500: 0.3127 - 83s/epoch - 16ms/step
Epoch 6/50
5165/5165 - 83s - loss: 3.1534 - accuracy500: 0.4458 - val_loss: 3.3758 - val_accuracy500: 0.3151 - 83s/epoch - 16ms/step
Epoch 7/50
5165/5165 - 84s - loss: 3.1466 - accuracy500: 0.4481 - val_loss: 3.3722 - val_accuracy500: 0.3197 - 84s/epoch - 16ms/step
Epoch 8/50
5165/5165 - 83s - loss: 3.1422 - accuracy500: 0.4495 - val_loss: 3.3833 - val_accuracy500: 0.3141 - 83s/epoch - 16ms/step
Epoch 9/50
5165/5165 - 82s - loss: 3.1380 - accuracy500: 0.4509 - val_loss: 3.3869 - val_accuracy500: 0.3143 - 82s/epoch - 16ms/step
Epoch 10/50
5165/5165 - 82s - loss: 3.1355 - accuracy500: 0.4520 - val_loss: 3.3851 - val_accuracy500: 0.3124 - 82s/epoch - 16ms/step
Epoch 11/50
5165/5165 - 83s - loss: 3.1320 - accuracy500: 0.4529 - val_loss: 3.3933 - val_accuracy500: 0.3117 - 83s/epoch - 16ms/step
testing model: results/AAPL/W4/deepLOB_L1/h500
Evaluating performance on  test set...
12724/12724 - 75s - 75s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1427457
{'0': {'precision': 0.2850415081907105, 'recall': 0.689231339200341, 'f1-score': 0.4032947052646616, 'support': 933923}, '1': {'precision': 0.33205122504335455, 'recall': 0.033058857383181706, 'f1-score': 0.060131092626442374, 'support': 1355310}, '2': {'precision': 0.32414836385858997, 'recall': 0.2893428548404094, 'f1-score': 0.3057582900357989, 'support': 967914}, 'accuracy': 0.2973623849338086, 'macro avg': {'precision': 0.31374703236421836, 'recall': 0.3372110171413107, 'f1-score': 0.2563946959756343, 'support': 3257147}, 'weighted avg': {'precision': 0.3162236477884864, 'recall': 0.2973623849338086, 'f1-score': 0.23151862710345664, 'support': 3257147}}
[[643689  46003 244231]
 [970811  44805 339694]
 [643729  44126 280059]]
Evaluating performance on  train set...
5165/5165 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1219313
{'0': {'precision': 0.34849994307184334, 'recall': 0.2779253266505044, 'f1-score': 0.30923707965629943, 'support': 440532}, '1': {'precision': 0.3587515367373485, 'recall': 0.2540089020362604, 'f1-score': 0.29742809158129274, 'support': 435406}, '2': {'precision': 0.33621937542547237, 'recall': 0.499244672362629, 'f1-score': 0.40182634398369926, 'support': 446164}, 'accuracy': 0.34473663907928437, 'macro avg': {'precision': 0.3478236184115547, 'recall': 0.3437263003497979, 'f1-score': 0.3361638384070971, 'support': 1322102}, 'weighted avg': {'precision': 0.3477318164130435, 'recall': 0.34473663907928437, 'f1-score': 0.3365937376657296, 'support': 1322102}}
[[122435  97504 220593]
 [105648 110597 219161]
 [123237 100182 222745]]
Evaluating performance on  val set...
1903/1903 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1159678
{'0': {'precision': 0.33067947838023337, 'recall': 0.05939166075996179, 'f1-score': 0.10069754682968884, 'support': 162245}, '1': {'precision': 0.3081576736508365, 'recall': 0.4442179189133266, 'f1-score': 0.36388517075578225, 'support': 164318}, '2': {'precision': 0.3149404274382215, 'recall': 0.43380890941615713, 'f1-score': 0.3649391235043049, 'support': 160437}, 'accuracy': 0.31258316221765914, 'macro avg': {'precision': 0.3179258598230971, 'recall': 0.3124728296964819, 'f1-score': 0.27650728036325867, 'support': 487000}, 'weighted avg': {'precision': 0.31789536333812124, 'recall': 0.31258316221765914, 'f1-score': 0.276550914027293, 'support': 487000}}
[[ 9636 82156 70453]
 [10386 72993 80939]
 [ 9118 81720 69599]]
training model: results/AAPL/W4/deepLOB_L1/h1000
Epoch 1/50
5165/5165 - 84s - loss: 3.1661 - accuracy1000: 0.4439 - val_loss: 3.3670 - val_accuracy1000: 0.3176 - 84s/epoch - 16ms/step
Epoch 2/50
5165/5165 - 81s - loss: 3.1228 - accuracy1000: 0.4587 - val_loss: 3.4417 - val_accuracy1000: 0.3176 - 81s/epoch - 16ms/step
Epoch 3/50
5165/5165 - 81s - loss: 3.1031 - accuracy1000: 0.4657 - val_loss: 3.4155 - val_accuracy1000: 0.3170 - 81s/epoch - 16ms/step
Epoch 4/50
5165/5165 - 81s - loss: 3.0907 - accuracy1000: 0.4706 - val_loss: 3.3995 - val_accuracy1000: 0.3309 - 81s/epoch - 16ms/step
Epoch 5/50
5165/5165 - 83s - loss: 3.0769 - accuracy1000: 0.4750 - val_loss: 3.4229 - val_accuracy1000: 0.3156 - 83s/epoch - 16ms/step
Epoch 6/50
5165/5165 - 83s - loss: 3.0694 - accuracy1000: 0.4772 - val_loss: 3.4106 - val_accuracy1000: 0.3301 - 83s/epoch - 16ms/step
Epoch 7/50
5165/5165 - 81s - loss: 3.0638 - accuracy1000: 0.4789 - val_loss: 3.4071 - val_accuracy1000: 0.3147 - 81s/epoch - 16ms/step
Epoch 8/50
5165/5165 - 83s - loss: 3.0563 - accuracy1000: 0.4807 - val_loss: 3.4199 - val_accuracy1000: 0.3281 - 83s/epoch - 16ms/step
Epoch 9/50
5165/5165 - 83s - loss: 3.0509 - accuracy1000: 0.4822 - val_loss: 3.3930 - val_accuracy1000: 0.3237 - 83s/epoch - 16ms/step
Epoch 10/50
5165/5165 - 83s - loss: 3.0481 - accuracy1000: 0.4833 - val_loss: 3.3900 - val_accuracy1000: 0.3080 - 83s/epoch - 16ms/step
Epoch 11/50
5165/5165 - 84s - loss: 3.0437 - accuracy1000: 0.4839 - val_loss: 3.3996 - val_accuracy1000: 0.3259 - 84s/epoch - 16ms/step
testing model: results/AAPL/W4/deepLOB_L1/h1000
Evaluating performance on  test set...
12724/12724 - 84s - 84s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2144196
{'0': {'precision': 0.2794840000514224, 'recall': 0.8034315240616559, 'f1-score': 0.41470687438167164, 'support': 892956}, '1': {'precision': 0.41097467382962394, 'recall': 0.0007357962469582279, 'f1-score': 0.0014689625092238776, 'support': 1455566}, '2': {'precision': 0.31853761977066863, 'recall': 0.24104003301692117, 'f1-score': 0.2744223898297758, 'support': 908625}, 'accuracy': 0.2878331865279645, 'macro avg': {'precision': 0.336332097883905, 'recall': 0.34840245110851176, 'f1-score': 0.23019940890689047, 'support': 3257147}, 'weighted avg': {'precision': 0.34913957570890475, 'recall': 0.2878331865279645, 'f1-score': 0.19090332968181695, 'support': 3257147}}
[[ 717429     800  174727]
 [1160673    1071  293822]
 [ 688875     735  219015]]
Evaluating performance on  train set...
5165/5165 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1446025
{'0': {'precision': 0.3552347564887282, 'recall': 0.4288415063310457, 'f1-score': 0.38858313992547133, 'support': 439027}, '1': {'precision': 0.39190792128167556, 'recall': 0.2952880993307245, 'f1-score': 0.3368056325029102, 'support': 437488}, '2': {'precision': 0.33125682469322665, 'recall': 0.34381164621050436, 'f1-score': 0.3374174891141794, 'support': 445587}, 'accuracy': 0.3559906875566333, 'macro avg': {'precision': 0.3594665008212101, 'recall': 0.35598041729075813, 'f1-score': 0.35426875384752027, 'support': 1322102}, 'weighted avg': {'precision': 0.3592887665605493, 'recall': 0.3559906875566333, 'f1-score': 0.35420546935592934, 'support': 1322102}}
[[188273  96879 153875]
 [152901 129185 155402]
 [188822 103567 153198]]
Evaluating performance on  val set...
1903/1903 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1215911
{'0': {'precision': 0.30325919709050214, 'recall': 0.040706225473935875, 'f1-score': 0.0717777802302098, 'support': 159779}, '1': {'precision': 0.33093978478388375, 'recall': 0.6578909393164515, 'f1-score': 0.44036310879547796, 'support': 173243}, '2': {'precision': 0.2842557055012174, 'recall': 0.22366182181870137, 'f1-score': 0.25034437890038636, 'support': 153978}, 'accuracy': 0.31810677618069816, 'macro avg': {'precision': 0.3061515624585344, 'recall': 0.3074196622030296, 'f1-score': 0.254161755975358, 'support': 487000}, 'weighted avg': {'precision': 0.30709769488481353, 'recall': 0.31810677618069816, 'f1-score': 0.25935510221515684, 'support': 487000}}
[[  6504 117077  36198]
 [  8750 113975  50518]
 [  6193 113346  34439]]
training model: results/AAPL/W4/deepOF_L1/h10
Epoch 1/50
5165/5165 - 75s - loss: 3.1442 - accuracy10: 0.4529 - val_loss: 3.2124 - val_accuracy10: 0.4237 - 75s/epoch - 15ms/step
Epoch 2/50
5165/5165 - 75s - loss: 3.1386 - accuracy10: 0.4552 - val_loss: 3.2107 - val_accuracy10: 0.4253 - 75s/epoch - 15ms/step
Epoch 3/50
5165/5165 - 73s - loss: 3.1355 - accuracy10: 0.4557 - val_loss: 3.2111 - val_accuracy10: 0.4258 - 73s/epoch - 14ms/step
Epoch 4/50
5165/5165 - 75s - loss: 3.1318 - accuracy10: 0.4570 - val_loss: 3.2087 - val_accuracy10: 0.4247 - 75s/epoch - 14ms/step
Epoch 5/50
5165/5165 - 74s - loss: 3.1287 - accuracy10: 0.4582 - val_loss: 3.2084 - val_accuracy10: 0.4253 - 74s/epoch - 14ms/step
Epoch 6/50
5165/5165 - 74s - loss: 3.1268 - accuracy10: 0.4587 - val_loss: 3.2104 - val_accuracy10: 0.4253 - 74s/epoch - 14ms/step
Epoch 7/50
5165/5165 - 74s - loss: 3.1244 - accuracy10: 0.4598 - val_loss: 3.2104 - val_accuracy10: 0.4256 - 74s/epoch - 14ms/step
Epoch 8/50
5165/5165 - 72s - loss: 3.1227 - accuracy10: 0.4601 - val_loss: 3.2087 - val_accuracy10: 0.4240 - 72s/epoch - 14ms/step
Epoch 9/50
5165/5165 - 73s - loss: 3.1211 - accuracy10: 0.4606 - val_loss: 3.2063 - val_accuracy10: 0.4254 - 73s/epoch - 14ms/step
Epoch 10/50
5165/5165 - 73s - loss: 3.1191 - accuracy10: 0.4617 - val_loss: 3.2015 - val_accuracy10: 0.4282 - 73s/epoch - 14ms/step
Epoch 11/50
5165/5165 - 73s - loss: 3.1177 - accuracy10: 0.4616 - val_loss: 3.2037 - val_accuracy10: 0.4278 - 73s/epoch - 14ms/step
Epoch 12/50
5165/5165 - 73s - loss: 3.1161 - accuracy10: 0.4621 - val_loss: 3.2050 - val_accuracy10: 0.4267 - 73s/epoch - 14ms/step
Epoch 13/50
5165/5165 - 73s - loss: 3.1143 - accuracy10: 0.4629 - val_loss: 3.1983 - val_accuracy10: 0.4278 - 73s/epoch - 14ms/step
Epoch 14/50
5165/5165 - 74s - loss: 3.1121 - accuracy10: 0.4635 - val_loss: 3.2019 - val_accuracy10: 0.4274 - 74s/epoch - 14ms/step
Epoch 15/50
5165/5165 - 74s - loss: 3.1111 - accuracy10: 0.4639 - val_loss: 3.2052 - val_accuracy10: 0.4268 - 74s/epoch - 14ms/step
Epoch 16/50
5165/5165 - 73s - loss: 3.1086 - accuracy10: 0.4646 - val_loss: 3.2014 - val_accuracy10: 0.4270 - 73s/epoch - 14ms/step
Epoch 17/50
5165/5165 - 74s - loss: 3.1070 - accuracy10: 0.4655 - val_loss: 3.1966 - val_accuracy10: 0.4282 - 74s/epoch - 14ms/step
Epoch 18/50
5165/5165 - 74s - loss: 3.1052 - accuracy10: 0.4657 - val_loss: 3.1989 - val_accuracy10: 0.4276 - 74s/epoch - 14ms/step
Epoch 19/50
5165/5165 - 74s - loss: 3.1033 - accuracy10: 0.4666 - val_loss: 3.1990 - val_accuracy10: 0.4260 - 74s/epoch - 14ms/step
Epoch 20/50
5165/5165 - 75s - loss: 3.1023 - accuracy10: 0.4669 - val_loss: 3.1989 - val_accuracy10: 0.4274 - 75s/epoch - 14ms/step
Epoch 21/50
5165/5165 - 73s - loss: 3.1001 - accuracy10: 0.4674 - val_loss: 3.1990 - val_accuracy10: 0.4271 - 73s/epoch - 14ms/step
Epoch 22/50
5165/5165 - 75s - loss: 3.0988 - accuracy10: 0.4680 - val_loss: 3.1996 - val_accuracy10: 0.4275 - 75s/epoch - 14ms/step
Epoch 23/50
5165/5165 - 73s - loss: 3.0969 - accuracy10: 0.4686 - val_loss: 3.2036 - val_accuracy10: 0.4270 - 73s/epoch - 14ms/step
Epoch 24/50
5165/5165 - 75s - loss: 3.0959 - accuracy10: 0.4687 - val_loss: 3.2024 - val_accuracy10: 0.4274 - 75s/epoch - 15ms/step
Epoch 25/50
5165/5165 - 75s - loss: 3.0942 - accuracy10: 0.4694 - val_loss: 3.2023 - val_accuracy10: 0.4259 - 75s/epoch - 14ms/step
Epoch 26/50
5165/5165 - 75s - loss: 3.0933 - accuracy10: 0.4694 - val_loss: 3.2009 - val_accuracy10: 0.4286 - 75s/epoch - 14ms/step
Epoch 27/50
5165/5165 - 74s - loss: 3.0909 - accuracy10: 0.4702 - val_loss: 3.2014 - val_accuracy10: 0.4285 - 74s/epoch - 14ms/step
testing model: results/AAPL/W4/deepOF_L1/h10
Evaluating performance on  test set...
12724/12724 - 84s - 84s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0977073
{'0': {'precision': 0.3758005312366134, 'recall': 0.5776977663038849, 'f1-score': 0.4553739173550731, 'support': 915702}, '1': {'precision': 0.5508351839335714, 'recall': 0.01207755036370257, 'f1-score': 0.023636841985328998, 'support': 1417092}, '2': {'precision': 0.3560511280990622, 'recall': 0.7004367398028234, 'f1-score': 0.47211387645008934, 'support': 924349}, 'accuracy': 0.3664444576120852, 'macro avg': {'precision': 0.42756228108974903, 'recall': 0.430070685490137, 'f1-score': 0.31704154526349715, 'support': 3257143}, 'weighted avg': {'precision': 0.4463485130166105, 'recall': 0.3664444576120852, 'f1-score': 0.2722878228359371, 'support': 3257143}}
[[528999   7901 378802]
 [607814  17115 792163]
 [270846   6055 647448]]
Evaluating performance on  train set...
5165/5165 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0672485
{'0': {'precision': 0.4329628454521393, 'recall': 0.6006225840659528, 'f1-score': 0.503194521929858, 'support': 438495}, '1': {'precision': 0.47521013521744426, 'recall': 0.008806445568671538, 'f1-score': 0.017292433175229396, 'support': 442971}, '2': {'precision': 0.4201866223731427, 'recall': 0.6728501529607204, 'f1-score': 0.5173158662469727, 'support': 440636}, 'accuracy': 0.42640658587612756, 'macro avg': {'precision': 0.4427865343475754, 'recall': 0.4274263941984482, 'f1-score': 0.3459342737840201, 'support': 1322102}, 'weighted avg': {'precision': 0.4428597069363441, 'recall': 0.42640658587612756, 'f1-score': 0.3450991847446708, 'support': 1322102}}
[[263370   2464 172661]
 [202617   3901 236453]
 [142310   1844 296482]]
Evaluating performance on  val set...
1903/1903 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0658307
{'0': {'precision': 0.42943518461928004, 'recall': 0.600213557874184, 'f1-score': 0.500661651686194, 'support': 163890}, '1': {'precision': 0.48403532608695654, 'recall': 0.009104209658767832, 'f1-score': 0.01787226037061424, 'support': 156521}, '2': {'precision': 0.4273203942130837, 'recall': 0.6540807261027205, 'f1-score': 0.5169257336144998, 'support': 166588}, 'accuracy': 0.4286579643900706, 'macro avg': {'precision': 0.44693030163977343, 'recall': 0.42113283121189077, 'f1-score': 0.34515321522376935, 'support': 486999}, 'weighted avg': {'precision': 0.4462602089796478, 'recall': 0.4286579643900706, 'f1-score': 0.35105707870384034, 'support': 486999}}
[[ 98369    798  64723]
 [ 73792   1425  81304]
 [ 56905    721 108962]]
training model: results/AAPL/W4/deepOF_L1/h20
Epoch 1/50
5165/5165 - 78s - loss: 3.1586 - accuracy20: 0.4472 - val_loss: 3.2066 - val_accuracy20: 0.4223 - 78s/epoch - 15ms/step
Epoch 2/50
5165/5165 - 74s - loss: 3.1504 - accuracy20: 0.4502 - val_loss: 3.2060 - val_accuracy20: 0.4243 - 74s/epoch - 14ms/step
Epoch 3/50
5165/5165 - 74s - loss: 3.1492 - accuracy20: 0.4508 - val_loss: 3.2066 - val_accuracy20: 0.4240 - 74s/epoch - 14ms/step
Epoch 4/50
5165/5165 - 76s - loss: 3.1467 - accuracy20: 0.4513 - val_loss: 3.2074 - val_accuracy20: 0.4238 - 76s/epoch - 15ms/step
Epoch 5/50
5165/5165 - 73s - loss: 3.1447 - accuracy20: 0.4524 - val_loss: 3.2074 - val_accuracy20: 0.4239 - 73s/epoch - 14ms/step
Epoch 6/50
5165/5165 - 74s - loss: 3.1429 - accuracy20: 0.4529 - val_loss: 3.2048 - val_accuracy20: 0.4249 - 74s/epoch - 14ms/step
Epoch 7/50
5165/5165 - 74s - loss: 3.1415 - accuracy20: 0.4534 - val_loss: 3.2063 - val_accuracy20: 0.4246 - 74s/epoch - 14ms/step
Epoch 8/50
5165/5165 - 75s - loss: 3.1399 - accuracy20: 0.4542 - val_loss: 3.2067 - val_accuracy20: 0.4244 - 75s/epoch - 15ms/step
Epoch 9/50
5165/5165 - 73s - loss: 3.1387 - accuracy20: 0.4546 - val_loss: 3.2061 - val_accuracy20: 0.4252 - 73s/epoch - 14ms/step
Epoch 10/50
5165/5165 - 75s - loss: 3.1373 - accuracy20: 0.4546 - val_loss: 3.2067 - val_accuracy20: 0.4251 - 75s/epoch - 14ms/step
Epoch 11/50
5165/5165 - 76s - loss: 3.1362 - accuracy20: 0.4549 - val_loss: 3.2054 - val_accuracy20: 0.4248 - 76s/epoch - 15ms/step
Epoch 12/50
5165/5165 - 76s - loss: 3.1351 - accuracy20: 0.4555 - val_loss: 3.2053 - val_accuracy20: 0.4250 - 76s/epoch - 15ms/step
Epoch 13/50
5165/5165 - 75s - loss: 3.1343 - accuracy20: 0.4558 - val_loss: 3.2069 - val_accuracy20: 0.4249 - 75s/epoch - 15ms/step
Epoch 14/50
5165/5165 - 77s - loss: 3.1329 - accuracy20: 0.4564 - val_loss: 3.2066 - val_accuracy20: 0.4248 - 77s/epoch - 15ms/step
Epoch 15/50
5165/5165 - 75s - loss: 3.1317 - accuracy20: 0.4568 - val_loss: 3.2032 - val_accuracy20: 0.4254 - 75s/epoch - 15ms/step
Epoch 16/50
5165/5165 - 75s - loss: 3.1302 - accuracy20: 0.4571 - val_loss: 3.2034 - val_accuracy20: 0.4250 - 75s/epoch - 15ms/step
Epoch 17/50
5165/5165 - 76s - loss: 3.1287 - accuracy20: 0.4579 - val_loss: 3.2008 - val_accuracy20: 0.4245 - 76s/epoch - 15ms/step
Epoch 18/50
5165/5165 - 79s - loss: 3.1281 - accuracy20: 0.4579 - val_loss: 3.2025 - val_accuracy20: 0.4248 - 79s/epoch - 15ms/step
Epoch 19/50
5165/5165 - 79s - loss: 3.1268 - accuracy20: 0.4586 - val_loss: 3.2024 - val_accuracy20: 0.4244 - 79s/epoch - 15ms/step
Epoch 20/50
5165/5165 - 80s - loss: 3.1257 - accuracy20: 0.4583 - val_loss: 3.2008 - val_accuracy20: 0.4239 - 80s/epoch - 15ms/step
Epoch 21/50
5165/5165 - 76s - loss: 3.1247 - accuracy20: 0.4587 - val_loss: 3.2027 - val_accuracy20: 0.4243 - 76s/epoch - 15ms/step
Epoch 22/50
5165/5165 - 76s - loss: 3.1238 - accuracy20: 0.4592 - val_loss: 3.2011 - val_accuracy20: 0.4245 - 76s/epoch - 15ms/step
Epoch 23/50
5165/5165 - 77s - loss: 3.1230 - accuracy20: 0.4590 - val_loss: 3.1989 - val_accuracy20: 0.4246 - 77s/epoch - 15ms/step
Epoch 24/50
5165/5165 - 77s - loss: 3.1220 - accuracy20: 0.4595 - val_loss: 3.1974 - val_accuracy20: 0.4248 - 77s/epoch - 15ms/step
Epoch 25/50
5165/5165 - 79s - loss: 3.1211 - accuracy20: 0.4599 - val_loss: 3.1971 - val_accuracy20: 0.4253 - 79s/epoch - 15ms/step
Epoch 26/50
5165/5165 - 78s - loss: 3.1201 - accuracy20: 0.4602 - val_loss: 3.1961 - val_accuracy20: 0.4249 - 78s/epoch - 15ms/step
Epoch 27/50
5165/5165 - 77s - loss: 3.1191 - accuracy20: 0.4608 - val_loss: 3.1964 - val_accuracy20: 0.4253 - 77s/epoch - 15ms/step
Epoch 28/50
5165/5165 - 78s - loss: 3.1191 - accuracy20: 0.4607 - val_loss: 3.1961 - val_accuracy20: 0.4253 - 78s/epoch - 15ms/step
Epoch 29/50
5165/5165 - 78s - loss: 3.1175 - accuracy20: 0.4609 - val_loss: 3.1966 - val_accuracy20: 0.4253 - 78s/epoch - 15ms/step
Epoch 30/50
5165/5165 - 77s - loss: 3.1169 - accuracy20: 0.4611 - val_loss: 3.1959 - val_accuracy20: 0.4245 - 77s/epoch - 15ms/step
Epoch 31/50
5165/5165 - 76s - loss: 3.1157 - accuracy20: 0.4616 - val_loss: 3.1944 - val_accuracy20: 0.4256 - 76s/epoch - 15ms/step
Epoch 32/50
5165/5165 - 77s - loss: 3.1148 - accuracy20: 0.4618 - val_loss: 3.1917 - val_accuracy20: 0.4256 - 77s/epoch - 15ms/step
Epoch 33/50
5165/5165 - 80s - loss: 3.1135 - accuracy20: 0.4625 - val_loss: 3.1931 - val_accuracy20: 0.4262 - 80s/epoch - 15ms/step
Epoch 34/50
5165/5165 - 78s - loss: 3.1133 - accuracy20: 0.4626 - val_loss: 3.1938 - val_accuracy20: 0.4248 - 78s/epoch - 15ms/step
Epoch 35/50
5165/5165 - 77s - loss: 3.1121 - accuracy20: 0.4630 - val_loss: 3.1965 - val_accuracy20: 0.4245 - 77s/epoch - 15ms/step
Epoch 36/50
5165/5165 - 76s - loss: 3.1113 - accuracy20: 0.4633 - val_loss: 3.1939 - val_accuracy20: 0.4256 - 76s/epoch - 15ms/step
Epoch 37/50
5165/5165 - 77s - loss: 3.1106 - accuracy20: 0.4631 - val_loss: 3.1939 - val_accuracy20: 0.4249 - 77s/epoch - 15ms/step
Epoch 38/50
5165/5165 - 78s - loss: 3.1097 - accuracy20: 0.4639 - val_loss: 3.1950 - val_accuracy20: 0.4253 - 78s/epoch - 15ms/step
Epoch 39/50
5165/5165 - 77s - loss: 3.1085 - accuracy20: 0.4645 - val_loss: 3.1952 - val_accuracy20: 0.4254 - 77s/epoch - 15ms/step
Epoch 40/50
5165/5165 - 78s - loss: 3.1071 - accuracy20: 0.4645 - val_loss: 3.1968 - val_accuracy20: 0.4242 - 78s/epoch - 15ms/step
Epoch 41/50
5165/5165 - 77s - loss: 3.1072 - accuracy20: 0.4646 - val_loss: 3.1955 - val_accuracy20: 0.4262 - 77s/epoch - 15ms/step
Epoch 42/50
5165/5165 - 79s - loss: 3.1060 - accuracy20: 0.4650 - val_loss: 3.1937 - val_accuracy20: 0.4262 - 79s/epoch - 15ms/step
testing model: results/AAPL/W4/deepOF_L1/h20
Evaluating performance on  test set...
12724/12724 - 68s - 68s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0756179
{'0': {'precision': 0.3929305532290612, 'recall': 0.5318806275044977, 'f1-score': 0.4519671768055188, 'support': 943802}, '1': {'precision': 0.47917344133384576, 'recall': 0.07081144761042127, 'f1-score': 0.12338871746985505, 'support': 1373422}, '2': {'precision': 0.36282686236334355, 'recall': 0.685812288080143, 'f1-score': 0.4745791162748578, 'support': 939919}, 'accuracy': 0.3818843692155978, 'macro avg': {'precision': 0.41164361897541685, 'recall': 0.429501454398354, 'f1-score': 0.34997833685007723, 'support': 3257143}, 'weighted avg': {'precision': 0.4206090582415322, 'recall': 0.3818843692155978, 'f1-score': 0.3199424258984741, 'support': 3257143}}
[[501990  54448 387364]
 [531513  97254 744655]
 [244051  51260 644608]]
Evaluating performance on  train set...
5165/5165 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0619587
{'0': {'precision': 0.4446648456674709, 'recall': 0.5310902384336876, 'f1-score': 0.48405007108142956, 'support': 441087}, '1': {'precision': 0.3582485767287149, 'recall': 0.07646742914878414, 'f1-score': 0.12603330582852, 'support': 439442}, '2': {'precision': 0.42107836638455165, 'recall': 0.6689290332515802, 'f1-score': 0.5168250135600931, 'support': 441573}, 'accuracy': 0.4260193237738087, 'macro avg': {'precision': 0.40799726292691246, 'recall': 0.425495566944684, 'f1-score': 0.3756361301566809, 'support': 1322102}, 'weighted avg': {'precision': 0.4080639703406192, 'recall': 0.4260193237738087, 'f1-score': 0.3759985942051083, 'support': 1322102}}
[[234257  32335 174495]
 [174228  33603 231611]
 [118332  27860 295381]]
Evaluating performance on  val set...
1903/1903 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0637975
{'0': {'precision': 0.44310313762837505, 'recall': 0.5236501901140684, 'f1-score': 0.48002119175752167, 'support': 164375}, '1': {'precision': 0.36194090983561794, 'recall': 0.08331919012867173, 'f1-score': 0.13545621305100938, 'support': 159087}, '2': {'precision': 0.42115085779433237, 'recall': 0.6595816237304096, 'f1-score': 0.514064990861628, 'support': 163537}, 'accuracy': 0.4254546723915244, 'macro avg': {'precision': 0.4087316350861085, 'recall': 0.42218366799104995, 'f1-score': 0.37651413189005306, 'support': 486999}, 'weighted avg': {'precision': 0.4092183343329141, 'recall': 0.4254546723915244, 'f1-score': 0.37889493073153463, 'support': 486999}}
[[ 86075  12177  66123]
 [ 63699  13255  82133]
 [ 44481  11190 107866]]
training model: results/AAPL/W4/deepOF_L1/h30
Epoch 1/50
5165/5165 - 80s - loss: 3.1751 - accuracy30: 0.4406 - val_loss: 3.2186 - val_accuracy30: 0.4160 - 80s/epoch - 15ms/step
Epoch 2/50
5165/5165 - 78s - loss: 3.1657 - accuracy30: 0.4448 - val_loss: 3.2184 - val_accuracy30: 0.4176 - 78s/epoch - 15ms/step
Epoch 3/50
5165/5165 - 76s - loss: 3.1630 - accuracy30: 0.4462 - val_loss: 3.2143 - val_accuracy30: 0.4177 - 76s/epoch - 15ms/step
Epoch 4/50
5165/5165 - 76s - loss: 3.1612 - accuracy30: 0.4467 - val_loss: 3.2148 - val_accuracy30: 0.4168 - 76s/epoch - 15ms/step
Epoch 5/50
5165/5165 - 78s - loss: 3.1599 - accuracy30: 0.4470 - val_loss: 3.2145 - val_accuracy30: 0.4157 - 78s/epoch - 15ms/step
Epoch 6/50
5165/5165 - 76s - loss: 3.1586 - accuracy30: 0.4475 - val_loss: 3.2118 - val_accuracy30: 0.4168 - 76s/epoch - 15ms/step
Epoch 7/50
5165/5165 - 78s - loss: 3.1580 - accuracy30: 0.4477 - val_loss: 3.2122 - val_accuracy30: 0.4175 - 78s/epoch - 15ms/step
Epoch 8/50
5165/5165 - 75s - loss: 3.1569 - accuracy30: 0.4480 - val_loss: 3.2109 - val_accuracy30: 0.4172 - 75s/epoch - 15ms/step
Epoch 9/50
5165/5165 - 78s - loss: 3.1562 - accuracy30: 0.4483 - val_loss: 3.2103 - val_accuracy30: 0.4178 - 78s/epoch - 15ms/step
Epoch 10/50
5165/5165 - 77s - loss: 3.1552 - accuracy30: 0.4486 - val_loss: 3.2109 - val_accuracy30: 0.4181 - 77s/epoch - 15ms/step
Epoch 11/50
5165/5165 - 77s - loss: 3.1544 - accuracy30: 0.4486 - val_loss: 3.2112 - val_accuracy30: 0.4181 - 77s/epoch - 15ms/step
Epoch 12/50
5165/5165 - 75s - loss: 3.1535 - accuracy30: 0.4491 - val_loss: 3.2111 - val_accuracy30: 0.4181 - 75s/epoch - 15ms/step
Epoch 13/50
5165/5165 - 78s - loss: 3.1526 - accuracy30: 0.4494 - val_loss: 3.2116 - val_accuracy30: 0.4181 - 78s/epoch - 15ms/step
Epoch 14/50
5165/5165 - 75s - loss: 3.1519 - accuracy30: 0.4496 - val_loss: 3.2118 - val_accuracy30: 0.4185 - 75s/epoch - 15ms/step
Epoch 15/50
5165/5165 - 79s - loss: 3.1511 - accuracy30: 0.4499 - val_loss: 3.2124 - val_accuracy30: 0.4180 - 79s/epoch - 15ms/step
Epoch 16/50
5165/5165 - 76s - loss: 3.1505 - accuracy30: 0.4502 - val_loss: 3.2136 - val_accuracy30: 0.4179 - 76s/epoch - 15ms/step
Epoch 17/50
5165/5165 - 76s - loss: 3.1499 - accuracy30: 0.4505 - val_loss: 3.2136 - val_accuracy30: 0.4179 - 76s/epoch - 15ms/step
Epoch 18/50
5165/5165 - 81s - loss: 3.1487 - accuracy30: 0.4512 - val_loss: 3.2150 - val_accuracy30: 0.4176 - 81s/epoch - 16ms/step
Epoch 19/50
5165/5165 - 78s - loss: 3.1483 - accuracy30: 0.4507 - val_loss: 3.2184 - val_accuracy30: 0.4168 - 78s/epoch - 15ms/step
testing model: results/AAPL/W4/deepOF_L1/h30
Evaluating performance on  test set...
12724/12724 - 67s - 67s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0802972
{'0': {'precision': 0.3799545848577307, 'recall': 0.5883898055208329, 'f1-score': 0.46173945243549164, 'support': 963188}, '1': {'precision': 0.5750967620126498, 'recall': 0.004569556343484819, 'f1-score': 0.009067068324497458, 'support': 1333171}, '2': {'precision': 0.36472044932782594, 'recall': 0.6662017685556795, 'f1-score': 0.47137874061819135, 'support': 960784}, 'accuracy': 0.37238094857978293, 'macro avg': {'precision': 0.43992393206606883, 'recall': 0.41972037680666574, 'f1-score': 0.3140617537927268, 'support': 3257143}, 'weighted avg': {'precision': 0.4553338905218776, 'recall': 0.37238094857978293, 'f1-score': 0.2793009100870865, 'support': 3257143}}
[[566730   2467 393991]
 [606169   6092 720910]
 [318674   2034 640076]]
Evaluating performance on  train set...
5165/5165 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0663064
{'0': {'precision': 0.4292916287468631, 'recall': 0.6032883794111036, 'f1-score': 0.5016301864365125, 'support': 444900}, '1': {'precision': 0.47224749772520475, 'recall': 0.0024078331125766367, 'f1-score': 0.004791237297797554, 'support': 431093}, '2': {'precision': 0.42106520834742855, 'recall': 0.6556828039784, 'f1-score': 0.5128130506052823, 'support': 446109}, 'accuracy': 0.4250405793199012, 'macro avg': {'precision': 0.44086811160649875, 'recall': 0.4204596721673601, 'f1-score': 0.33974482477986406, 'support': 1322102}, 'weighted avg': {'precision': 0.44052230100022094, 'recall': 0.4250405793199012, 'f1-score': 0.343401081004715, 'support': 1322102}}
[[268403    613 175884]
 [203764   1038 226291]
 [153056    547 292506]]
Evaluating performance on  val set...
1903/1903 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0685658
{'0': {'precision': 0.42175193685447115, 'recall': 0.6029063852216869, 'f1-score': 0.4963155624285754, 'support': 163158}, '1': {'precision': 0.5352877307274702, 'recall': 0.0030412762256096433, 'f1-score': 0.006048189223672587, 'support': 162103}, '2': {'precision': 0.4144969723816342, 'recall': 0.647967700849522, 'f1-score': 0.505580386755657, 'support': 161738}, 'accuracy': 0.41820003737174, 'macro avg': {'precision': 0.45717887998785844, 'recall': 0.41797178743227287, 'f1-score': 0.3359813794693016, 'support': 486999}, 'weighted avg': {'precision': 0.45713412316345137, 'recall': 0.41820003737174, 'f1-score': 0.33620160358754936, 'support': 486999}}
[[ 98369    218  64571]
 [ 78143    493  83467]
 [ 56727    210 104801]]
training model: results/AAPL/W4/deepOF_L1/h50
Epoch 1/50
5165/5165 - 78s - loss: 3.1585 - accuracy50: 0.4499 - val_loss: 3.2420 - val_accuracy50: 0.3880 - 78s/epoch - 15ms/step
Epoch 2/50
5165/5165 - 79s - loss: 3.1547 - accuracy50: 0.4503 - val_loss: 3.2461 - val_accuracy50: 0.3859 - 79s/epoch - 15ms/step
Epoch 3/50
5165/5165 - 76s - loss: 3.1555 - accuracy50: 0.4498 - val_loss: 3.2500 - val_accuracy50: 0.3869 - 76s/epoch - 15ms/step
Epoch 4/50
5165/5165 - 72s - loss: 3.1545 - accuracy50: 0.4500 - val_loss: 3.2457 - val_accuracy50: 0.3875 - 72s/epoch - 14ms/step
Epoch 5/50
5165/5165 - 72s - loss: 3.1535 - accuracy50: 0.4505 - val_loss: 3.2446 - val_accuracy50: 0.3866 - 72s/epoch - 14ms/step
Epoch 6/50
5165/5165 - 72s - loss: 3.1511 - accuracy50: 0.4515 - val_loss: 3.2486 - val_accuracy50: 0.3866 - 72s/epoch - 14ms/step
Epoch 7/50
5165/5165 - 72s - loss: 3.1493 - accuracy50: 0.4519 - val_loss: 3.2490 - val_accuracy50: 0.3855 - 72s/epoch - 14ms/step
Epoch 8/50
5165/5165 - 74s - loss: 3.1487 - accuracy50: 0.4523 - val_loss: 3.2493 - val_accuracy50: 0.3858 - 74s/epoch - 14ms/step
Epoch 9/50
5165/5165 - 72s - loss: 3.1475 - accuracy50: 0.4530 - val_loss: 3.2494 - val_accuracy50: 0.3850 - 72s/epoch - 14ms/step
Epoch 10/50
5165/5165 - 72s - loss: 3.1465 - accuracy50: 0.4531 - val_loss: 3.2515 - val_accuracy50: 0.3837 - 72s/epoch - 14ms/step
Epoch 11/50
5165/5165 - 74s - loss: 3.1461 - accuracy50: 0.4530 - val_loss: 3.2521 - val_accuracy50: 0.3836 - 74s/epoch - 14ms/step
testing model: results/AAPL/W4/deepOF_L1/h50
Evaluating performance on  test set...
12724/12724 - 73s - 73s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0806638
{'0': {'precision': 0.32045024049831855, 'recall': 0.676007855072992, 'f1-score': 0.434793757408718, 'support': 877904}, '1': {'precision': 0.47772073432408807, 'recall': 0.09972560014599267, 'f1-score': 0.16500576447982432, 'support': 1506925}, '2': {'precision': 0.3354600304425168, 'recall': 0.41939714368908443, 'f1-score': 0.37276185061444994, 'support': 872314}, 'accuracy': 0.3406651166374949, 'macro avg': {'precision': 0.37787700175497446, 'recall': 0.3983768663026897, 'f1-score': 0.3241871241676641, 'support': 3257143}, 'weighted avg': {'precision': 0.3972316679068729, 'recall': 0.3406651166374949, 'f1-score': 0.2933625792296487, 'support': 3257143}}
[[593470  75869 208565]
 [840477 150279 516169]
 [418041  88427 365846]]
Evaluating performance on  train set...
5165/5165 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0797349
{'0': {'precision': 0.39336314585692844, 'recall': 0.6886025871622972, 'f1-score': 0.5007014023919514, 'support': 440328}, '1': {'precision': 0.3521715366827833, 'recall': 0.09510962745966323, 'f1-score': 0.14977113431554856, 'support': 440355}, '2': {'precision': 0.4253145526875752, 'recall': 0.41658605542579724, 'f1-score': 0.4209050572284296, 'support': 441419}, 'accuracy': 0.40010679962665513, 'macro avg': {'precision': 0.39028307840909565, 'recall': 0.4000994233492525, 'f1-score': 0.3571258646453099, 'support': 1322102}, 'weighted avg': {'precision': 0.39031120810469494, 'recall': 0.40010679962665513, 'f1-score': 0.3571742607005229, 'support': 1322102}}
[[303211  34654 102463]
 [252465  41882 146008]
 [215141  42389 183889]]
Evaluating performance on  val set...
1903/1903 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.080725
{'0': {'precision': 0.3791852176852644, 'recall': 0.6685880241723261, 'f1-score': 0.4839190110220464, 'support': 157701}, '1': {'precision': 0.3735897612646768, 'recall': 0.09396962271130016, 'f1-score': 0.15016740169479784, 'support': 173024}, '2': {'precision': 0.40752406055037, 'recall': 0.431364142467717, 'f1-score': 0.41910534987099385, 'support': 156274}, 'accuracy': 0.3883108589545358, 'macro avg': {'precision': 0.3867663465001037, 'recall': 0.39797392978378104, 'f1-score': 0.3510639208626127, 'support': 486999}, 'weighted avg': {'precision': 0.38629093264193937, 'recall': 0.3883108589545358, 'f1-score': 0.34454351223260854, 'support': 486999}}
[[105437  12694  39570]
 [ 98330  16259  58435]
 [ 74295  14568  67411]]
training model: results/AAPL/W4/deepOF_L1/h100
Epoch 1/50
5165/5165 - 76s - loss: 3.2397 - accuracy100: 0.4072 - val_loss: 3.2893 - val_accuracy100: 0.3746 - 76s/epoch - 15ms/step
Epoch 2/50
5165/5165 - 72s - loss: 3.2346 - accuracy100: 0.4098 - val_loss: 3.3000 - val_accuracy100: 0.3748 - 72s/epoch - 14ms/step
Epoch 3/50
5165/5165 - 73s - loss: 3.2345 - accuracy100: 0.4097 - val_loss: 3.3061 - val_accuracy100: 0.3718 - 73s/epoch - 14ms/step
Epoch 4/50
5165/5165 - 74s - loss: 3.2339 - accuracy100: 0.4102 - val_loss: 3.3084 - val_accuracy100: 0.3712 - 74s/epoch - 14ms/step
Epoch 5/50
5165/5165 - 72s - loss: 3.2331 - accuracy100: 0.4104 - val_loss: 3.3088 - val_accuracy100: 0.3717 - 72s/epoch - 14ms/step
Epoch 6/50
5165/5165 - 73s - loss: 3.2326 - accuracy100: 0.4108 - val_loss: 3.3145 - val_accuracy100: 0.3673 - 73s/epoch - 14ms/step
Epoch 7/50
5165/5165 - 73s - loss: 3.2319 - accuracy100: 0.4114 - val_loss: 3.3187 - val_accuracy100: 0.3651 - 73s/epoch - 14ms/step
Epoch 8/50
5165/5165 - 73s - loss: 3.2312 - accuracy100: 0.4116 - val_loss: 3.3183 - val_accuracy100: 0.3646 - 73s/epoch - 14ms/step
Epoch 9/50
5165/5165 - 72s - loss: 3.2306 - accuracy100: 0.4120 - val_loss: 3.3203 - val_accuracy100: 0.3626 - 72s/epoch - 14ms/step
Epoch 10/50
5165/5165 - 74s - loss: 3.2301 - accuracy100: 0.4122 - val_loss: 3.3220 - val_accuracy100: 0.3611 - 74s/epoch - 14ms/step
Epoch 11/50
5165/5165 - 74s - loss: 3.2294 - accuracy100: 0.4125 - val_loss: 3.3202 - val_accuracy100: 0.3605 - 74s/epoch - 14ms/step
testing model: results/AAPL/W4/deepOF_L1/h100
Evaluating performance on  test set...
12724/12724 - 65s - 65s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1091158
{'0': {'precision': 0.3423748750307788, 'recall': 0.4930433398804012, 'f1-score': 0.4041225074180535, 'support': 936297}, '1': {'precision': 0.4213547646383467, 'recall': 0.00026661591035893623, 'f1-score': 0.0005328946269846514, 'support': 1376512}, '2': {'precision': 0.32194356216652514, 'recall': 0.6504573593664953, 'f1-score': 0.43070826996284367, 'support': 944334}, 'accuracy': 0.33042792410403843, 'macro avg': {'precision': 0.36189106727855025, 'recall': 0.38125577171908515, 'f1-score': 0.27845455733596064, 'support': 3257143}, 'weighted avg': {'precision': 0.36982923684453417, 'recall': 0.33042792410403843, 'f1-score': 0.24126809617627265, 'support': 3257143}}
[[461635    236 474426]
 [556880    367 819265]
 [329817    268 614249]]
Evaluating performance on  train set...
5165/5165 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0917201
{'0': {'precision': 0.39446502819613205, 'recall': 0.5086349121572231, 'f1-score': 0.44433329247509956, 'support': 441869}, '1': {'precision': 0.296398891966759, 'recall': 0.0002452238641780646, 'f1-score': 0.0004900422947718898, 'support': 436336}, '2': {'precision': 0.3770263118000165, 'recall': 0.6386999686864295, 'f1-score': 0.4741566663516962, 'support': 443897}, 'accuracy': 0.3845195000083201, 'macro avg': {'precision': 0.35596341065430254, 'recall': 0.3825267015692769, 'f1-score': 0.3063266670405225, 'support': 1322102}, 'weighted avg': {'precision': 0.3562449971320642, 'recall': 0.3845195000083201, 'f1-score': 0.3078640319967221, 'support': 1322102}}
[[224750    119 217000]
 [184764    107 251465]
 [160245    135 283517]]
Evaluating performance on  val set...
1903/1903 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0955288
{'0': {'precision': 0.38702596357927177, 'recall': 0.49779675278132696, 'f1-score': 0.4354776710622092, 'support': 160445}, '1': {'precision': 0.2644628099173554, 'recall': 0.00019136581369342, 'f1-score': 0.0003824548822756065, 'support': 167219}, '2': {'precision': 0.3650574663472507, 'recall': 0.6426899300216525, 'f1-score': 0.46563009410090334, 'support': 159335}, 'accuracy': 0.374341631091645, 'macro avg': {'precision': 0.33884874661462594, 'recall': 0.3802260162055577, 'f1-score': 0.3004967400151294, 'support': 486999}, 'weighted avg': {'precision': 0.3377543254472508, 'recall': 0.374341631091645, 'f1-score': 0.295945863749418, 'support': 486999}}
[[ 79869     44  80532]
 [ 69610     32  97577]
 [ 56887     45 102403]]
training model: results/AAPL/W4/deepOF_L1/h200
Epoch 1/50
5165/5165 - 76s - loss: 3.2419 - accuracy200: 0.4028 - val_loss: 3.3303 - val_accuracy200: 0.3550 - 76s/epoch - 15ms/step
Epoch 2/50
5165/5165 - 73s - loss: 3.2402 - accuracy200: 0.4034 - val_loss: 3.3397 - val_accuracy200: 0.3543 - 73s/epoch - 14ms/step
Epoch 3/50
5165/5165 - 75s - loss: 3.2421 - accuracy200: 0.4030 - val_loss: 3.3477 - val_accuracy200: 0.3527 - 75s/epoch - 14ms/step
Epoch 4/50
5165/5165 - 72s - loss: 3.2413 - accuracy200: 0.4035 - val_loss: 3.3516 - val_accuracy200: 0.3512 - 72s/epoch - 14ms/step
Epoch 5/50
5165/5165 - 72s - loss: 3.2412 - accuracy200: 0.4036 - val_loss: 3.3524 - val_accuracy200: 0.3511 - 72s/epoch - 14ms/step
Epoch 6/50
5165/5165 - 72s - loss: 3.2400 - accuracy200: 0.4042 - val_loss: 3.3552 - val_accuracy200: 0.3516 - 72s/epoch - 14ms/step
Epoch 7/50
5165/5165 - 74s - loss: 3.2391 - accuracy200: 0.4043 - val_loss: 3.3532 - val_accuracy200: 0.3515 - 74s/epoch - 14ms/step
Epoch 8/50
5165/5165 - 72s - loss: 3.2383 - accuracy200: 0.4049 - val_loss: 3.3542 - val_accuracy200: 0.3528 - 72s/epoch - 14ms/step
Epoch 9/50
5165/5165 - 72s - loss: 3.2377 - accuracy200: 0.4052 - val_loss: 3.3514 - val_accuracy200: 0.3534 - 72s/epoch - 14ms/step
Epoch 10/50
5165/5165 - 72s - loss: 3.2368 - accuracy200: 0.4059 - val_loss: 3.3507 - val_accuracy200: 0.3532 - 72s/epoch - 14ms/step
Epoch 11/50
5165/5165 - 73s - loss: 3.2358 - accuracy200: 0.4063 - val_loss: 3.3488 - val_accuracy200: 0.3533 - 73s/epoch - 14ms/step
testing model: results/AAPL/W4/deepOF_L1/h200
Evaluating performance on  test set...
12724/12724 - 70s - 70s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1391022
{'0': {'precision': 0.309016127042212, 'recall': 0.46328404335713236, 'f1-score': 0.3707424814490208, 'support': 886590}, '1': {'precision': 0.4329268292682927, 'recall': 9.735809885686509e-05, 'f1-score': 0.00019467241909955783, 'support': 1458533}, '2': {'precision': 0.29875769018670184, 'recall': 0.6314455823337207, 'f1-score': 0.4056086002481301, 'support': 912020}, 'accuracy': 0.3029575305720381, 'macro avg': {'precision': 0.34690021549906885, 'recall': 0.36494232792990333, 'f1-score': 0.2588485847054168, 'support': 3257143}, 'weighted avg': {'precision': 0.36163031950135477, 'recall': 0.3029575305720381, 'f1-score': 0.2145756782473577, 'support': 3257143}}
[[410743     90 475757]
 [582420    142 875971]
 [336033     96 575891]]
Evaluating performance on  train set...
5165/5165 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1052747
{'0': {'precision': 0.3700353313840156, 'recall': 0.4715774427918404, 'f1-score': 0.41468076690633326, 'support': 437962}, '1': {'precision': 0.3333333333333333, 'recall': 0.00010183276344701642, 'f1-score': 0.000203603326425902, 'support': 441901}, '2': {'precision': 0.36028896747021233, 'recall': 0.6222811647095801, 'f1-score': 0.45635630672386657, 'support': 442239}, 'accuracy': 0.36440077997007797, 'macro avg': {'precision': 0.3545525440625204, 'recall': 0.3646534800882892, 'f1-score': 0.2904135589855419, 'support': 1322102}, 'weighted avg': {'precision': 0.3545078820106155, 'recall': 0.36440077997007797, 'f1-score': 0.29008574775519474, 'support': 1322102}}
[[206533     36 231393]
 [184623     45 257233]
 [166988     54 275197]]
Evaluating performance on  val set...
1903/1903 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1102374
{'0': {'precision': 0.3640435505071799, 'recall': 0.4608781382263919, 'f1-score': 0.40677731251957183, 'support': 159246}, '1': {'precision': 0.40476190476190477, 'recall': 0.00010030859644671548, 'f1-score': 0.00020056748801019355, 'support': 169477}, '2': {'precision': 0.3487201771846702, 'recall': 0.6286992342490333, 'f1-score': 0.44861009674772556, 'support': 158276}, 'accuracy': 0.355068490900392, 'macro avg': {'precision': 0.3725085441512516, 'recall': 0.3632258936906239, 'f1-score': 0.2851959922517692, 'support': 486999}, 'weighted avg': {'precision': 0.3732335124743183, 'recall': 0.355068490900392, 'f1-score': 0.2788832485456854, 'support': 486999}}
[[ 73393     12  85841]
 [ 69457     17 100003]
 [ 58755     13  99508]]
training model: results/AAPL/W4/deepOF_L1/h300
Epoch 1/50
5165/5165 - 74s - loss: 3.2587 - accuracy300: 0.3901 - val_loss: 3.3520 - val_accuracy300: 0.3526 - 74s/epoch - 14ms/step
Epoch 2/50
5165/5165 - 75s - loss: 3.2565 - accuracy300: 0.3918 - val_loss: 3.3570 - val_accuracy300: 0.3536 - 75s/epoch - 14ms/step
Epoch 3/50
5165/5165 - 71s - loss: 3.2567 - accuracy300: 0.3916 - val_loss: 3.3571 - val_accuracy300: 0.3537 - 71s/epoch - 14ms/step
Epoch 4/50
5165/5165 - 75s - loss: 3.2567 - accuracy300: 0.3918 - val_loss: 3.3575 - val_accuracy300: 0.3522 - 75s/epoch - 15ms/step
Epoch 5/50
5165/5165 - 75s - loss: 3.2562 - accuracy300: 0.3922 - val_loss: 3.3574 - val_accuracy300: 0.3524 - 75s/epoch - 15ms/step
Epoch 6/50
5165/5165 - 76s - loss: 3.2563 - accuracy300: 0.3924 - val_loss: 3.3569 - val_accuracy300: 0.3521 - 76s/epoch - 15ms/step
Epoch 7/50
5165/5165 - 72s - loss: 3.2562 - accuracy300: 0.3924 - val_loss: 3.3576 - val_accuracy300: 0.3522 - 72s/epoch - 14ms/step
Epoch 8/50
5165/5165 - 74s - loss: 3.2559 - accuracy300: 0.3927 - val_loss: 3.3581 - val_accuracy300: 0.3532 - 74s/epoch - 14ms/step
Epoch 9/50
5165/5165 - 74s - loss: 3.2554 - accuracy300: 0.3932 - val_loss: 3.3573 - val_accuracy300: 0.3528 - 74s/epoch - 14ms/step
Epoch 10/50
5165/5165 - 74s - loss: 3.2550 - accuracy300: 0.3931 - val_loss: 3.3572 - val_accuracy300: 0.3528 - 74s/epoch - 14ms/step
Epoch 11/50
5165/5165 - 73s - loss: 3.2545 - accuracy300: 0.3935 - val_loss: 3.3552 - val_accuracy300: 0.3533 - 73s/epoch - 14ms/step
testing model: results/AAPL/W4/deepOF_L1/h300
Evaluating performance on  test set...
12724/12724 - 82s - 82s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1496629
{'0': {'precision': 0.302983620073419, 'recall': 0.542042586673008, 'f1-score': 0.3886980636410715, 'support': 912539}, '1': {'precision': 0.38879456706281834, 'recall': 0.00016283159160414715, 'f1-score': 0.0003255268488574576, 'support': 1406361}, '2': {'precision': 0.30665569791263214, 'recall': 0.530791063722298, 'f1-score': 0.38872943701824564, 'support': 938243}, 'accuracy': 0.3048300304899109, 'macro avg': {'precision': 0.33281129501628987, 'recall': 0.35766549399563674, 'f1-score': 0.25925100916939153, 'support': 3257143}, 'weighted avg': {'precision': 0.34109262251729555, 'recall': 0.3048300304899109, 'f1-score': 0.22101658531355722, 'support': 3257143}}
[[494635    168 417736]
 [697872    229 708260]
 [440040    192 498011]]
Evaluating performance on  train set...
5165/5165 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1101122
{'0': {'precision': 0.3590712489816969, 'recall': 0.5538257454203597, 'f1-score': 0.4356743495613372, 'support': 442502}, '1': {'precision': 0.27626459143968873, 'recall': 0.00016397872433790702, 'f1-score': 0.00032776290277906006, 'support': 432983}, '2': {'precision': 0.36108343487081146, 'recall': 0.5168947890474389, 'f1-score': 0.4251634967963652, 'support': 446617}, 'accuracy': 0.3600281975218251, 'macro avg': {'precision': 0.33213975843073235, 'recall': 0.35696150439737884, 'f1-score': 0.2870552030868272, 'support': 1322102}, 'weighted avg': {'precision': 0.33263214021605503, 'recall': 0.3600281975218251, 'f1-score': 0.2895494691356847, 'support': 1322102}}
[[245069     89 197344]
 [221773     71 211139]
 [215666     97 230854]]
Evaluating performance on  val set...
1903/1903 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1146355
{'0': {'precision': 0.3540226104830421, 'recall': 0.5330081824146169, 'f1-score': 0.42545749179874304, 'support': 161566}, '1': {'precision': 0.34375, 'recall': 0.0002004093208553227, 'f1-score': 0.00040058509702049663, 'support': 164663}, '2': {'precision': 0.3516763594127714, 'recall': 0.5329787895751695, 'f1-score': 0.4237493911078252, 'support': 160770}, 'accuracy': 0.35284672042447723, 'macro avg': {'precision': 0.3498163232986045, 'recall': 0.3553957937702139, 'f1-score': 0.2832024893345296, 'support': 486999}, 'weighted avg': {'precision': 0.34977470515975273, 'recall': 0.35284672042447723, 'f1-score': 0.2811743274055829, 'support': 486999}}
[[86116    35 75415]
 [82079    33 82551]
 [75055    28 85687]]
training model: results/AAPL/W4/deepOF_L1/h500
Epoch 1/50
5165/5165 - 79s - loss: 3.2607 - accuracy500: 0.3879 - val_loss: 3.3461 - val_accuracy500: 0.3471 - 79s/epoch - 15ms/step
Epoch 2/50
5165/5165 - 74s - loss: 3.2596 - accuracy500: 0.3882 - val_loss: 3.3541 - val_accuracy500: 0.3473 - 74s/epoch - 14ms/step
Epoch 3/50
5165/5165 - 75s - loss: 3.2609 - accuracy500: 0.3876 - val_loss: 3.3555 - val_accuracy500: 0.3479 - 75s/epoch - 15ms/step
Epoch 4/50
5165/5165 - 75s - loss: 3.2611 - accuracy500: 0.3872 - val_loss: 3.3622 - val_accuracy500: 0.3486 - 75s/epoch - 14ms/step
Epoch 5/50
5165/5165 - 77s - loss: 3.2606 - accuracy500: 0.3879 - val_loss: 3.3656 - val_accuracy500: 0.3477 - 77s/epoch - 15ms/step
Epoch 6/50
5165/5165 - 76s - loss: 3.2603 - accuracy500: 0.3880 - val_loss: 3.3656 - val_accuracy500: 0.3476 - 76s/epoch - 15ms/step
Epoch 7/50
5165/5165 - 75s - loss: 3.2601 - accuracy500: 0.3884 - val_loss: 3.3671 - val_accuracy500: 0.3473 - 75s/epoch - 15ms/step
Epoch 8/50
5165/5165 - 76s - loss: 3.2597 - accuracy500: 0.3885 - val_loss: 3.3681 - val_accuracy500: 0.3471 - 76s/epoch - 15ms/step
Epoch 9/50
5165/5165 - 76s - loss: 3.2592 - accuracy500: 0.3890 - val_loss: 3.3704 - val_accuracy500: 0.3472 - 76s/epoch - 15ms/step
Epoch 10/50
5165/5165 - 74s - loss: 3.2588 - accuracy500: 0.3893 - val_loss: 3.3687 - val_accuracy500: 0.3473 - 74s/epoch - 14ms/step
Epoch 11/50
5165/5165 - 74s - loss: 3.2585 - accuracy500: 0.3895 - val_loss: 3.3717 - val_accuracy500: 0.3479 - 74s/epoch - 14ms/step
testing model: results/AAPL/W4/deepOF_L1/h500
Evaluating performance on  test set...
12724/12724 - 65s - 65s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1421137
{'0': {'precision': 0.3050587610868134, 'recall': 0.5021848743094973, 'f1-score': 0.3795530590171377, 'support': 933921}, '1': {'precision': 0.37185929648241206, 'recall': 0.00016380028465833252, 'f1-score': 0.0003274563280935404, 'support': 1355309}, '2': {'precision': 0.31066862734376727, 'recall': 0.5517861625993246, 'f1-score': 0.3975226335825164, 'support': 967913}, 'accuracy': 0.30803191631438964, 'macro avg': {'precision': 0.3291955616376643, 'recall': 0.3513782790644934, 'f1-score': 0.2591343829759159, 'support': 3257143}, 'weighted avg': {'precision': 0.33452176879167633, 'recall': 0.30803191631438964, 'f1-score': 0.2270958633924487, 'support': 3257143}}
[[469001    217 464703]
 [634737    222 720350]
 [433674    158 534081]]
Evaluating performance on  train set...
5165/5165 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1104442
{'0': {'precision': 0.35251819644292126, 'recall': 0.5188597218091712, 'f1-score': 0.4198120918784383, 'support': 440489}, '1': {'precision': 0.29328621908127206, 'recall': 0.00019061836137107424, 'f1-score': 0.0003809891027936141, 'support': 435425}, '2': {'precision': 0.3545787687199879, 'recall': 0.5352026500040342, 'f1-score': 0.42655756270173434, 'support': 446188}, 'accuracy': 0.35355517199126846, 'macro avg': {'precision': 0.3334610614147271, 'recall': 0.3514176633915255, 'f1-score': 0.28225021456098875, 'support': 1322102}, 'weighted avg': {'precision': 0.3337059708207406, 'recall': 0.35355517199126846, 'f1-score': 0.28395189365592577, 'support': 1322102}}
[[228552    107 211830]
 [212495     83 222847]
 [207294     93 238801]]
Evaluating performance on  val set...
1903/1903 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1136136
{'0': {'precision': 0.35016505894962485, 'recall': 0.5033773789567104, 'f1-score': 0.4130202828781359, 'support': 162256}, '1': {'precision': 0.3333333333333333, 'recall': 0.0002009205815737561, 'f1-score': 0.00040159909457658673, 'support': 164244}, '2': {'precision': 0.3453262369406663, 'recall': 0.5457479485853495, 'f1-score': 0.42299752021615405, 'support': 160499}, 'accuracy': 0.34764137092683967, 'macro avg': {'precision': 0.3429415430745415, 'recall': 0.3497754160412112, 'f1-score': 0.27880646739628884, 'support': 486999}, 'weighted avg': {'precision': 0.34289371745664843, 'recall': 0.34764137092683967, 'f1-score': 0.277149764696718, 'support': 486999}}
[[81676    38 80542]
 [78695    33 85516]
 [72879    28 87592]]
training model: results/AAPL/W4/deepOF_L1/h1000
Epoch 1/50
5165/5165 - 78s - loss: 3.2538 - accuracy1000: 0.3886 - val_loss: 3.3978 - val_accuracy1000: 0.3185 - 78s/epoch - 15ms/step
Epoch 2/50
5165/5165 - 72s - loss: 3.2513 - accuracy1000: 0.3891 - val_loss: 3.3896 - val_accuracy1000: 0.3173 - 72s/epoch - 14ms/step
Epoch 3/50
5165/5165 - 74s - loss: 3.2521 - accuracy1000: 0.3894 - val_loss: 3.3954 - val_accuracy1000: 0.3173 - 74s/epoch - 14ms/step
Epoch 4/50
5165/5165 - 73s - loss: 3.2524 - accuracy1000: 0.3898 - val_loss: 3.3992 - val_accuracy1000: 0.3169 - 73s/epoch - 14ms/step
Epoch 5/50
5165/5165 - 76s - loss: 3.2512 - accuracy1000: 0.3905 - val_loss: 3.4015 - val_accuracy1000: 0.3169 - 76s/epoch - 15ms/step
Epoch 6/50
5165/5165 - 72s - loss: 3.2503 - accuracy1000: 0.3910 - val_loss: 3.3954 - val_accuracy1000: 0.3168 - 72s/epoch - 14ms/step
Epoch 7/50
5165/5165 - 78s - loss: 3.2507 - accuracy1000: 0.3916 - val_loss: 3.4003 - val_accuracy1000: 0.3168 - 78s/epoch - 15ms/step
Epoch 8/50
5165/5165 - 75s - loss: 3.2500 - accuracy1000: 0.3923 - val_loss: 3.3988 - val_accuracy1000: 0.3169 - 75s/epoch - 15ms/step
Epoch 9/50
5165/5165 - 76s - loss: 3.2494 - accuracy1000: 0.3929 - val_loss: 3.3988 - val_accuracy1000: 0.3167 - 76s/epoch - 15ms/step
Epoch 10/50
5165/5165 - 75s - loss: 3.2491 - accuracy1000: 0.3929 - val_loss: 3.4023 - val_accuracy1000: 0.3168 - 75s/epoch - 15ms/step
Epoch 11/50
5165/5165 - 76s - loss: 3.2485 - accuracy1000: 0.3936 - val_loss: 3.3999 - val_accuracy1000: 0.3168 - 76s/epoch - 15ms/step
Epoch 12/50
5165/5165 - 76s - loss: 3.2484 - accuracy1000: 0.3936 - val_loss: 3.4016 - val_accuracy1000: 0.3171 - 76s/epoch - 15ms/step
testing model: results/AAPL/W4/deepOF_L1/h1000
Evaluating performance on  test set...
12724/12724 - 86s - 86s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1651489
{'0': {'precision': 0.31060864992769815, 'recall': 0.013230259599329415, 'f1-score': 0.025379489316725883, 'support': 892953}, '1': {'precision': 0.4426605504587156, 'recall': 0.00013259446840610458, 'f1-score': 0.0002651095259484534, 'support': 1455566}, '2': {'precision': 0.2793978386117007, 'recall': 0.9897273239535825, 'f1-score': 0.4357768379103413, 'support': 908624}, 'accuracy': 0.2797841543954318, 'macro avg': {'precision': 0.3442223463327048, 'recall': 0.33436339267377274, 'f1-score': 0.15380714558433853, 'support': 3257143}, 'weighted avg': {'precision': 0.36091389118580197, 'recall': 0.2797841543954318, 'f1-score': 0.1286421471533583, 'support': 3257143}}
[[  11814     121  881018]
 [  17009     193 1438364]
 [   9212     122  899290]]
Evaluating performance on  train set...
5165/5165 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1166842
{'0': {'precision': 0.36797536566589684, 'recall': 0.010885084928711803, 'f1-score': 0.021144688502907395, 'support': 439133}, '1': {'precision': 0.2964824120603015, 'recall': 0.00013493455673998112, 'f1-score': 0.00026974634699438566, 'support': 437249}, '2': {'precision': 0.33752816268155333, 'recall': 0.9911940231535493, 'f1-score': 0.503575391549116, 'support': 445720}, 'accuracy': 0.33782113634197664, 'macro avg': {'precision': 0.3339953134692506, 'recall': 0.3340713475463337, 'f1-score': 0.1749966087996726, 'support': 1322102}, 'weighted avg': {'precision': 0.3340663709096114, 'recall': 0.33782113634197664, 'f1-score': 0.17688264622404032, 'support': 1322102}}
[[  4780     63 434290]
 [  4362     59 432828]
 [  3848     77 441795]]
Evaluating performance on  val set...
1903/1903 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1280284
{'0': {'precision': 0.36744517739347476, 'recall': 0.012899712713821657, 'f1-score': 0.024924416495344055, 'support': 159771}, '1': {'precision': 0.3548387096774194, 'recall': 0.00012699365608963444, 'f1-score': 0.0002538964448727344, 'support': 173237}, '2': {'precision': 0.31666140345045374, 'recall': 0.9897851173120507, 'f1-score': 0.47981565166475426, 'support': 153991}, 'accuracy': 0.317251164786786, 'macro avg': {'precision': 0.3463150968404493, 'recall': 0.33427060789398727, 'f1-score': 0.16833132153499034, 'support': 486999}, 'weighted avg': {'precision': 0.3469027311441271, 'recall': 0.317251164786786, 'f1-score': 0.1599869306134206, 'support': 486999}}
[[  2061     17 157693]
 [  1998     22 171217]
 [  1550     23 152418]]
training model: results/AAPL/W4/deepLOB_L2/h10
Epoch 1/50
5165/5165 - 221s - loss: 3.0750 - accuracy10: 0.4682 - val_loss: 3.2922 - val_accuracy10: 0.3938 - 221s/epoch - 43ms/step
Epoch 2/50
5165/5165 - 216s - loss: 2.9943 - accuracy10: 0.4953 - val_loss: 3.2285 - val_accuracy10: 0.4014 - 216s/epoch - 42ms/step
Epoch 3/50
5165/5165 - 216s - loss: 2.9530 - accuracy10: 0.5072 - val_loss: 3.1447 - val_accuracy10: 0.4482 - 216s/epoch - 42ms/step
Epoch 4/50
5165/5165 - 216s - loss: 2.9315 - accuracy10: 0.5133 - val_loss: 3.1108 - val_accuracy10: 0.4556 - 216s/epoch - 42ms/step
Epoch 5/50
5165/5165 - 215s - loss: 2.9152 - accuracy10: 0.5179 - val_loss: 3.0990 - val_accuracy10: 0.4707 - 215s/epoch - 42ms/step
Epoch 6/50
5165/5165 - 215s - loss: 2.9016 - accuracy10: 0.5214 - val_loss: 3.0662 - val_accuracy10: 0.4776 - 215s/epoch - 42ms/step
Epoch 7/50
5165/5165 - 214s - loss: 2.8908 - accuracy10: 0.5243 - val_loss: 3.0740 - val_accuracy10: 0.4751 - 214s/epoch - 41ms/step
Epoch 8/50
5165/5165 - 214s - loss: 2.8827 - accuracy10: 0.5263 - val_loss: 3.0820 - val_accuracy10: 0.4766 - 214s/epoch - 42ms/step
Epoch 9/50
5165/5165 - 216s - loss: 2.8755 - accuracy10: 0.5278 - val_loss: 3.0756 - val_accuracy10: 0.4775 - 216s/epoch - 42ms/step
Epoch 10/50
5165/5165 - 216s - loss: 2.8692 - accuracy10: 0.5294 - val_loss: 3.1091 - val_accuracy10: 0.4704 - 216s/epoch - 42ms/step
Epoch 11/50
5165/5165 - 215s - loss: 2.8647 - accuracy10: 0.5306 - val_loss: 3.1386 - val_accuracy10: 0.4694 - 215s/epoch - 42ms/step
Epoch 12/50
5165/5165 - 215s - loss: 2.8605 - accuracy10: 0.5313 - val_loss: 3.0991 - val_accuracy10: 0.4759 - 215s/epoch - 42ms/step
Epoch 13/50
5165/5165 - 215s - loss: 2.8568 - accuracy10: 0.5325 - val_loss: 3.1224 - val_accuracy10: 0.4745 - 215s/epoch - 42ms/step
Epoch 14/50
5165/5165 - 216s - loss: 2.8529 - accuracy10: 0.5334 - val_loss: 3.1421 - val_accuracy10: 0.4720 - 216s/epoch - 42ms/step
Epoch 15/50
5165/5165 - 215s - loss: 2.8501 - accuracy10: 0.5341 - val_loss: 3.0860 - val_accuracy10: 0.4800 - 215s/epoch - 42ms/step
Epoch 16/50
5165/5165 - 215s - loss: 2.8473 - accuracy10: 0.5347 - val_loss: 3.1210 - val_accuracy10: 0.4732 - 215s/epoch - 42ms/step
testing model: results/AAPL/W4/deepLOB_L2/h10
Evaluating performance on  test set...
12724/12724 - 181s - 181s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0579257
{'0': {'precision': 0.48359109729055505, 'recall': 0.4877515272369079, 'f1-score': 0.48566240234003333, 'support': 915706}, '1': {'precision': 0.5924578497432397, 'recall': 0.22535516395548066, 'f1-score': 0.3265133560586387, 'support': 1417092}, '2': {'precision': 0.38967222222531805, 'recall': 0.7565129620954856, 'f1-score': 0.514388235190269, 'support': 924349}, 'accuracy': 0.4498624102627238, 'macro avg': {'precision': 0.4885737230863709, 'recall': 0.48987321776262477, 'f1-score': 0.44218799786298035, 'support': 3257147}, 'weighted avg': {'precision': 0.504302592878259, 'recall': 0.4498624102627238, 'f1-score': 0.4245733125864203, 'support': 3257147}}
[[446637 115134 353935]
 [356421 319349 741322]
 [120526 104541 699282]]
Evaluating performance on  train set...
5165/5165 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0171942
{'0': {'precision': 0.5476039634859952, 'recall': 0.4001295257033268, 'f1-score': 0.4623926803944407, 'support': 438523}, '1': {'precision': 0.4640608900534878, 'recall': 0.4359947558325567, 'f1-score': 0.44959023450406976, 'support': 443159}, '2': {'precision': 0.4765512881842411, 'recall': 0.6333386313064802, 'f1-score': 0.5438707664710356, 'support': 440420}, 'accuracy': 0.4898381516705973, 'macro avg': {'precision': 0.4960720472412414, 'recall': 0.4898209709474546, 'f1-score': 0.4852845604565153, 'support': 1322102}, 'weighted avg': {'precision': 0.49593178982944286, 'recall': 0.4898381516705973, 'f1-score': 0.4852434585881982, 'support': 1322102}}
[[175466 124944 138113]
 [ 81672 193215 168272]
 [ 63287  98198 278935]]
Evaluating performance on  val set...
1903/1903 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0219855
{'0': {'precision': 0.5320035698348952, 'recall': 0.3636103012040844, 'f1-score': 0.43197628916780195, 'support': 163942}, '1': {'precision': 0.48444074494164135, 'recall': 0.33824468628653176, 'f1-score': 0.3983527641970666, 'support': 156576}, '2': {'precision': 0.4508594791172551, 'recall': 0.7193570476087505, 'f1-score': 0.5543058679774501, 'support': 166482}, 'accuracy': 0.4770677618069815, 'macro avg': {'precision': 0.48910126463126385, 'recall': 0.4737373450331222, 'f1-score': 0.46154497378077286, 'support': 487000}, 'weighted avg': {'precision': 0.48897230211140386, 'recall': 0.4770677618069815, 'f1-score': 0.4629845764235925, 'support': 487000}}
[[ 59611  31585  72746]
 [ 30495  52961  73120]
 [ 21944  24778 119760]]
training model: results/AAPL/W4/deepLOB_L2/h20
Epoch 1/50
5165/5165 - 221s - loss: 3.1272 - accuracy20: 0.4505 - val_loss: 3.3049 - val_accuracy20: 0.3761 - 221s/epoch - 43ms/step
Epoch 2/50
5165/5165 - 215s - loss: 3.0677 - accuracy20: 0.4731 - val_loss: 3.2768 - val_accuracy20: 0.3946 - 215s/epoch - 42ms/step
Epoch 3/50
5165/5165 - 216s - loss: 3.0347 - accuracy20: 0.4833 - val_loss: 3.2891 - val_accuracy20: 0.4197 - 216s/epoch - 42ms/step
Epoch 4/50
5165/5165 - 216s - loss: 3.0168 - accuracy20: 0.4891 - val_loss: 3.2396 - val_accuracy20: 0.4289 - 216s/epoch - 42ms/step
Epoch 5/50
5165/5165 - 217s - loss: 3.0051 - accuracy20: 0.4930 - val_loss: 3.2985 - val_accuracy20: 0.4309 - 217s/epoch - 42ms/step
Epoch 6/50
5165/5165 - 216s - loss: 2.9962 - accuracy20: 0.4956 - val_loss: 3.2949 - val_accuracy20: 0.4309 - 216s/epoch - 42ms/step
Epoch 7/50
5165/5165 - 215s - loss: 2.9891 - accuracy20: 0.4976 - val_loss: 3.3341 - val_accuracy20: 0.4262 - 215s/epoch - 42ms/step
Epoch 8/50
5165/5165 - 216s - loss: 2.9834 - accuracy20: 0.4992 - val_loss: 3.2167 - val_accuracy20: 0.4406 - 216s/epoch - 42ms/step
Epoch 9/50
5165/5165 - 215s - loss: 2.9784 - accuracy20: 0.5004 - val_loss: 3.3787 - val_accuracy20: 0.4316 - 215s/epoch - 42ms/step
Epoch 10/50
5165/5165 - 215s - loss: 2.9741 - accuracy20: 0.5019 - val_loss: 3.5208 - val_accuracy20: 0.4230 - 215s/epoch - 42ms/step
Epoch 11/50
5165/5165 - 215s - loss: 2.9700 - accuracy20: 0.5024 - val_loss: 3.4576 - val_accuracy20: 0.4279 - 215s/epoch - 42ms/step
Epoch 12/50
5165/5165 - 217s - loss: 2.9662 - accuracy20: 0.5033 - val_loss: 3.3067 - val_accuracy20: 0.4356 - 217s/epoch - 42ms/step
Epoch 13/50
5165/5165 - 215s - loss: 2.9629 - accuracy20: 0.5044 - val_loss: 3.3285 - val_accuracy20: 0.4378 - 215s/epoch - 42ms/step
Epoch 14/50
5165/5165 - 215s - loss: 2.9597 - accuracy20: 0.5051 - val_loss: 3.3846 - val_accuracy20: 0.4348 - 215s/epoch - 42ms/step
Epoch 15/50
5165/5165 - 217s - loss: 2.9562 - accuracy20: 0.5059 - val_loss: 3.4388 - val_accuracy20: 0.4321 - 217s/epoch - 42ms/step
Epoch 16/50
5165/5165 - 214s - loss: 2.9536 - accuracy20: 0.5068 - val_loss: 3.4887 - val_accuracy20: 0.4323 - 214s/epoch - 42ms/step
Epoch 17/50
5165/5165 - 215s - loss: 2.9505 - accuracy20: 0.5076 - val_loss: 3.4914 - val_accuracy20: 0.4303 - 215s/epoch - 42ms/step
Epoch 18/50
5165/5165 - 215s - loss: 2.9485 - accuracy20: 0.5080 - val_loss: 3.5240 - val_accuracy20: 0.4293 - 215s/epoch - 42ms/step
testing model: results/AAPL/W4/deepLOB_L2/h20
Evaluating performance on  test set...
12724/12724 - 177s - 177s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0684015
{'0': {'precision': 0.4599544110352557, 'recall': 0.5148245665153289, 'f1-score': 0.4858451725601577, 'support': 943805}, '1': {'precision': 0.5263171050126995, 'recall': 0.19931019016733387, 'f1-score': 0.2891301443184417, 'support': 1373422}, '2': {'precision': 0.3944594121805109, 'recall': 0.7053249212698953, 'f1-score': 0.5059574779857221, 'support': 939920}, 'accuracy': 0.43675646202028956, 'macro avg': {'precision': 0.46024364274282203, 'recall': 0.473153225984186, 'f1-score': 0.42697759828810716, 'support': 3257147}, 'weighted avg': {'precision': 0.46903718334007866, 'recall': 0.43675646202028956, 'f1-score': 0.40870134411084375, 'support': 3257147}}
[[485894 124244 333667]
 [415649 273737 684036]
 [154853 122118 662949]]
Evaluating performance on  train set...
5165/5165 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0544332
{'0': {'precision': 0.5184766965570685, 'recall': 0.42448920400343515, 'f1-score': 0.4667989798677117, 'support': 441321}, '1': {'precision': 0.4117902932628284, 'recall': 0.3860400904872231, 'f1-score': 0.3984996443122291, 'support': 438957}, '2': {'precision': 0.46420911967433376, 'recall': 0.577103099876874, 'f1-score': 0.5145364030600404, 'support': 441824}, 'accuracy': 0.4627245099092203, 'macro avg': {'precision': 0.4648253698314102, 'recall': 0.4625441314558441, 'f1-score': 0.45994500907999375, 'support': 1322102}, 'weighted avg': {'precision': 0.4649199653672911, 'recall': 0.4627245099092203, 'f1-score': 0.4600756467414472, 'support': 1322102}}
[[187336 127305 126680]
 [101886 169455 167616]
 [ 72098 114748 254978]]
Evaluating performance on  val set...
1903/1903 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0719961
{'0': {'precision': 0.5432543835846545, 'recall': 0.2561676303747799, 'f1-score': 0.3481620113119737, 'support': 164123}, '1': {'precision': 0.39049252939892076, 'recall': 0.39276638199878267, 'f1-score': 0.39162615512635224, 'support': 159367}, '2': {'precision': 0.4411745830559054, 'recall': 0.6726866858296129, 'f1-score': 0.5328711509020794, 'support': 163510}, 'accuracy': 0.4407145790554415, 'macro avg': {'precision': 0.4583071653464936, 'recall': 0.44054023273439186, 'f1-score': 0.42421977244680176, 'support': 487000}, 'weighted avg': {'precision': 0.45899100247485247, 'recall': 0.4407145790554415, 'f1-score': 0.42440131648988794, 'support': 487000}}
[[ 42043  58257  63823]
 [ 21273  62594  75500]
 [ 14075  39444 109991]]
training model: results/AAPL/W4/deepLOB_L2/h30
Epoch 1/50
5165/5165 - 217s - loss: 3.1556 - accuracy30: 0.4422 - val_loss: 3.2818 - val_accuracy30: 0.3857 - 217s/epoch - 42ms/step
Epoch 2/50
5165/5165 - 215s - loss: 3.0991 - accuracy30: 0.4638 - val_loss: 3.2885 - val_accuracy30: 0.3875 - 215s/epoch - 42ms/step
Epoch 3/50
5165/5165 - 214s - loss: 3.0767 - accuracy30: 0.4717 - val_loss: 3.2732 - val_accuracy30: 0.3921 - 214s/epoch - 42ms/step
Epoch 4/50
5165/5165 - 215s - loss: 3.0652 - accuracy30: 0.4752 - val_loss: 3.2897 - val_accuracy30: 0.3930 - 215s/epoch - 42ms/step
Epoch 5/50
5165/5165 - 216s - loss: 3.0572 - accuracy30: 0.4782 - val_loss: 3.3373 - val_accuracy30: 0.3986 - 216s/epoch - 42ms/step
Epoch 6/50
5165/5165 - 215s - loss: 3.0516 - accuracy30: 0.4798 - val_loss: 3.3728 - val_accuracy30: 0.4042 - 215s/epoch - 42ms/step
Epoch 7/50
5165/5165 - 216s - loss: 3.0471 - accuracy30: 0.4814 - val_loss: 3.4081 - val_accuracy30: 0.4073 - 216s/epoch - 42ms/step
Epoch 8/50
5165/5165 - 215s - loss: 3.0435 - accuracy30: 0.4824 - val_loss: 3.3570 - val_accuracy30: 0.4051 - 215s/epoch - 42ms/step
Epoch 9/50
5165/5165 - 216s - loss: 3.0401 - accuracy30: 0.4836 - val_loss: 3.3526 - val_accuracy30: 0.4064 - 216s/epoch - 42ms/step
Epoch 10/50
5165/5165 - 216s - loss: 3.0373 - accuracy30: 0.4843 - val_loss: 3.5031 - val_accuracy30: 0.4073 - 216s/epoch - 42ms/step
Epoch 11/50
5165/5165 - 215s - loss: 3.0348 - accuracy30: 0.4850 - val_loss: 3.6279 - val_accuracy30: 0.4067 - 215s/epoch - 42ms/step
Epoch 12/50
5165/5165 - 214s - loss: 3.0327 - accuracy30: 0.4857 - val_loss: 3.5886 - val_accuracy30: 0.4044 - 214s/epoch - 41ms/step
Epoch 13/50
5165/5165 - 214s - loss: 3.0302 - accuracy30: 0.4864 - val_loss: 3.5618 - val_accuracy30: 0.4069 - 214s/epoch - 42ms/step
testing model: results/AAPL/W4/deepLOB_L2/h30
Evaluating performance on  test set...
12724/12724 - 178s - 178s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0660968
{'0': {'precision': 0.4258124636389887, 'recall': 0.5190045577715715, 'f1-score': 0.46781250628748805, 'support': 963190}, '1': {'precision': 0.4565725175185439, 'recall': 0.2738821397389084, 'f1-score': 0.34238143819482997, 'support': 1333172}, '2': {'precision': 0.3962321338411384, 'recall': 0.5292932341783021, 'f1-score': 0.4531977077083009, 'support': 960785}, 'accuracy': 0.42170924431718926, 'macro avg': {'precision': 0.42620570499955707, 'recall': 0.44072664389626065, 'f1-score': 0.42113055073020633, 'support': 3257147}, 'weighted avg': {'precision': 0.4296772279207011, 'recall': 0.42170924431718926, 'f1-score': 0.4121616968017235, 'support': 3257147}}
[[499900 194375 268915]
 [462060 365132 505980]
 [212031 240217 508537]]
Evaluating performance on  train set...
5165/5165 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0770491
{'0': {'precision': 0.4734072553516163, 'recall': 0.37159011490068383, 'f1-score': 0.41636450621946924, 'support': 444993}, '1': {'precision': 0.3641843621989369, 'recall': 0.565422912689816, 'f1-score': 0.4430218833114194, 'support': 431141}, '2': {'precision': 0.472150726509951, 'recall': 0.3212517490044129, 'f1-score': 0.3823513320567651, 'support': 445968}, 'accuracy': 0.41781950257998246, 'macro avg': {'precision': 0.4365807813535014, 'recall': 0.41942159219830427, 'f1-score': 0.41391257386255126, 'support': 1322102}, 'weighted avg': {'precision': 0.4373655285928646, 'recall': 0.41781950257998246, 'f1-score': 0.41358431298309833, 'support': 1322102}}
[[165355 209127  70511]
 [ 97706 243777  89658]
 [ 86226 216474 143268]]
Evaluating performance on  val set...
1903/1903 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0928588
{'0': {'precision': 0.5014784322820037, 'recall': 0.10603775898001716, 'f1-score': 0.1750591997409379, 'support': 163140}, '1': {'precision': 0.3598058215891772, 'recall': 0.5895268395545855, 'f1-score': 0.44687220304682407, 'support': 162186}, '2': {'precision': 0.4174729210950425, 'recall': 0.4822729690611972, 'f1-score': 0.4475394827848457, 'support': 161674}, 'accuracy': 0.39195687885010266, 'macro avg': {'precision': 0.4262523916554078, 'recall': 0.3926125225319333, 'f1-score': 0.3564902951908692, 'support': 487000}, 'weighted avg': {'precision': 0.4264089845336104, 'recall': 0.39195687885010266, 'f1-score': 0.35603916079845166, 'support': 487000}}
[[17299 91220 54621]
 [12396 95613 54177]
 [ 4801 78902 77971]]
training model: results/AAPL/W4/deepLOB_L2/h50
Epoch 1/50
5165/5165 - 220s - loss: 3.1493 - accuracy50: 0.4451 - val_loss: 3.4612 - val_accuracy50: 0.3561 - 220s/epoch - 43ms/step
Epoch 2/50
5165/5165 - 218s - loss: 3.1131 - accuracy50: 0.4602 - val_loss: 3.5004 - val_accuracy50: 0.3628 - 218s/epoch - 42ms/step
Epoch 3/50
5165/5165 - 215s - loss: 3.0935 - accuracy50: 0.4677 - val_loss: 3.4759 - val_accuracy50: 0.3587 - 215s/epoch - 42ms/step
Epoch 4/50
5165/5165 - 216s - loss: 3.0786 - accuracy50: 0.4729 - val_loss: 3.4235 - val_accuracy50: 0.3765 - 216s/epoch - 42ms/step
Epoch 5/50
5165/5165 - 215s - loss: 3.0697 - accuracy50: 0.4760 - val_loss: 3.4347 - val_accuracy50: 0.3817 - 215s/epoch - 42ms/step
Epoch 6/50
5165/5165 - 218s - loss: 3.0640 - accuracy50: 0.4780 - val_loss: 3.4973 - val_accuracy50: 0.3819 - 218s/epoch - 42ms/step
Epoch 7/50
5165/5165 - 213s - loss: 3.0599 - accuracy50: 0.4791 - val_loss: 3.4636 - val_accuracy50: 0.3815 - 213s/epoch - 41ms/step
Epoch 8/50
5165/5165 - 211s - loss: 3.0564 - accuracy50: 0.4803 - val_loss: 3.4700 - val_accuracy50: 0.3897 - 211s/epoch - 41ms/step
Epoch 9/50
5165/5165 - 212s - loss: 3.0537 - accuracy50: 0.4813 - val_loss: 3.4734 - val_accuracy50: 0.3859 - 212s/epoch - 41ms/step
Epoch 10/50
5165/5165 - 211s - loss: 3.0507 - accuracy50: 0.4823 - val_loss: 3.4749 - val_accuracy50: 0.4008 - 211s/epoch - 41ms/step
Epoch 11/50
5165/5165 - 212s - loss: 3.0484 - accuracy50: 0.4830 - val_loss: 3.5289 - val_accuracy50: 0.3904 - 212s/epoch - 41ms/step
Epoch 12/50
5165/5165 - 212s - loss: 3.0463 - accuracy50: 0.4837 - val_loss: 3.5287 - val_accuracy50: 0.4010 - 212s/epoch - 41ms/step
Epoch 13/50
5165/5165 - 212s - loss: 3.0442 - accuracy50: 0.4846 - val_loss: 3.5407 - val_accuracy50: 0.3942 - 212s/epoch - 41ms/step
Epoch 14/50
5165/5165 - 216s - loss: 3.0423 - accuracy50: 0.4853 - val_loss: 3.5398 - val_accuracy50: 0.4076 - 216s/epoch - 42ms/step
testing model: results/AAPL/W4/deepLOB_L2/h50
Evaluating performance on  test set...
12724/12724 - 175s - 175s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0435507
{'0': {'precision': 0.4219152915200896, 'recall': 0.23333933245700564, 'f1-score': 0.30049214114402645, 'support': 877906}, '1': {'precision': 0.48709125412564924, 'recall': 0.6760424864923692, 'f1-score': 0.566219293772397, 'support': 1506926}, '2': {'precision': 0.36957570125886957, 'recall': 0.28815393521835575, 'f1-score': 0.3238251304873783, 'support': 872315}, 'accuracy': 0.452837099461584, 'macro avg': {'precision': 0.42619408230153616, 'recall': 0.3991785847225769, 'f1-score': 0.39684552180126725, 'support': 3257147}, 'weighted avg': {'precision': 0.43805172716350066, 'recall': 0.452837099461584, 'f1-score': 0.4296803146592857, 'support': 3257147}}
[[ 204850  528158  144898]
 [ 204305 1018746  283875]
 [  76369  544585  251361]]
Evaluating performance on  train set...
5165/5165 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1485516
{'0': {'precision': 0.511794280359685, 'recall': 0.06450799621142432, 'f1-score': 0.11457467666066917, 'support': 440271}, '1': {'precision': 0.3408321319906632, 'recall': 0.8739402113446771, 'f1-score': 0.49040778232922005, 'support': 440418}, '2': {'precision': 0.44255991610652723, 'recall': 0.1376737884928627, 'f1-score': 0.21001503291690424, 'support': 441413}, 'accuracy': 0.3585736955242485, 'macro avg': {'precision': 0.4317287761522918, 'recall': 0.3587073320163214, 'f1-score': 0.27166583063559785, 'support': 1322102}, 'weighted avg': {'precision': 0.43172802534421195, 'recall': 0.3585736955242485, 'f1-score': 0.27163689932462803, 'support': 1322102}}
[[ 28401 376634  35236]
 [ 14209 384899  41310]
 [ 12883 367759  60771]]
Evaluating performance on  val set...
1903/1903 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1412021
{'0': {'precision': 0.4892610120131052, 'recall': 0.017033788750602012, 'f1-score': 0.0329214074881505, 'support': 157804}, '1': {'precision': 0.3712220746139502, 'recall': 0.8797259593444744, 'f1-score': 0.5221219217015965, 'support': 173113}, '2': {'precision': 0.3982823704410547, 'recall': 0.18183914968318138, 'f1-score': 0.2496832993173341, 'support': 156083}, 'accuracy': 0.37651334702258726, 'macro avg': {'precision': 0.41958848568937007, 'recall': 0.35953296592608597, 'f1-score': 0.2682422095023604, 'support': 487000}, 'weighted avg': {'precision': 0.41814336543719083, 'recall': 0.37651334702258726, 'f1-score': 0.2762885840372404, 'support': 487000}}
[[  2688 131186  23930]
 [  1872 152292  18949]
 [   934 126767  28382]]
training model: results/AAPL/W4/deepLOB_L2/h100
Epoch 1/50
5165/5165 - 217s - loss: 3.2387 - accuracy100: 0.4013 - val_loss: 3.3083 - val_accuracy100: 0.3392 - 217s/epoch - 42ms/step
Epoch 2/50
5165/5165 - 214s - loss: 3.2140 - accuracy100: 0.4162 - val_loss: 3.3938 - val_accuracy100: 0.3424 - 214s/epoch - 41ms/step
Epoch 3/50
5165/5165 - 214s - loss: 3.2034 - accuracy100: 0.4218 - val_loss: 3.5634 - val_accuracy100: 0.3439 - 214s/epoch - 42ms/step
Epoch 4/50
5165/5165 - 214s - loss: 3.1944 - accuracy100: 0.4257 - val_loss: 3.6139 - val_accuracy100: 0.3441 - 214s/epoch - 41ms/step
Epoch 5/50
5165/5165 - 214s - loss: 3.1876 - accuracy100: 0.4289 - val_loss: 3.5631 - val_accuracy100: 0.3440 - 214s/epoch - 41ms/step
Epoch 6/50
5165/5165 - 214s - loss: 3.1825 - accuracy100: 0.4311 - val_loss: 3.5790 - val_accuracy100: 0.3439 - 214s/epoch - 42ms/step
Epoch 7/50
5165/5165 - 214s - loss: 3.1786 - accuracy100: 0.4329 - val_loss: 3.5325 - val_accuracy100: 0.3436 - 214s/epoch - 42ms/step
Epoch 8/50
5165/5165 - 214s - loss: 3.1753 - accuracy100: 0.4340 - val_loss: 3.5417 - val_accuracy100: 0.3440 - 214s/epoch - 41ms/step
Epoch 9/50
5165/5165 - 213s - loss: 3.1725 - accuracy100: 0.4352 - val_loss: 3.5311 - val_accuracy100: 0.3436 - 213s/epoch - 41ms/step
Epoch 10/50
5165/5165 - 213s - loss: 3.1700 - accuracy100: 0.4364 - val_loss: 3.5279 - val_accuracy100: 0.3440 - 213s/epoch - 41ms/step
Epoch 11/50
5165/5165 - 214s - loss: 3.1676 - accuracy100: 0.4373 - val_loss: 3.5257 - val_accuracy100: 0.3442 - 214s/epoch - 41ms/step
testing model: results/AAPL/W4/deepLOB_L2/h100
Evaluating performance on  test set...
12724/12724 - 174s - 174s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0875473
{'0': {'precision': 0.3220369137133988, 'recall': 0.4968508991251726, 'f1-score': 0.3907844948268627, 'support': 936299}, '1': {'precision': 0.4204428491273442, 'recall': 0.4110019948943491, 'f1-score': 0.4156688227076039, 'support': 1376514}, '2': {'precision': 0.359913830024155, 'recall': 0.17798151925060413, 'f1-score': 0.23818019751749783, 'support': 944334}, 'accuracy': 0.36812124230192866, 'macro avg': {'precision': 0.367464530954966, 'recall': 0.3619448044233753, 'f1-score': 0.34821117168398813, 'support': 3257147}, 'weighted avg': {'precision': 0.374606112361109, 'recall': 0.36812124230192866, 'f1-score': 0.3570568795896901, 'support': 3257147}}
[[465201 363905 107193]
 [619047 565750 191717]
 [360310 415950 168074]]
Evaluating performance on  train set...
5165/5165 - 72s - 72s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1076056
{'0': {'precision': 0.37842117168061523, 'recall': 0.26892234548335975, 'f1-score': 0.3144108386680095, 'support': 441700}, '1': {'precision': 0.3398461402379992, 'recall': 0.6426183684457734, 'f1-score': 0.4445786493700823, 'support': 436455}, '2': {'precision': 0.36885640246235935, 'recall': 0.15197534840870644, 'f1-score': 0.2152598422935866, 'support': 443947}, 'accuracy': 0.3530181483728184, 'macro avg': {'precision': 0.3623745714603246, 'recall': 0.35450535411261325, 'f1-score': 0.32474977677722616, 'support': 1322102}, 'weighted avg': {'precision': 0.3624749618205409, 'recall': 0.3530181483728184, 'f1-score': 0.32408831017364015, 'support': 1322102}}
[[118783 270453  52464]
 [ 93000 280474  62981]
 [102108 274370  67469]]
Evaluating performance on  val set...
1903/1903 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1034002
{'0': {'precision': 0.3456321381548731, 'recall': 0.07033635332676993, 'f1-score': 0.11688627714929196, 'support': 160486}, '1': {'precision': 0.3388311250153355, 'recall': 0.7926230635392315, 'f1-score': 0.4747260066714533, 'support': 167251}, '2': {'precision': 0.33913429382023363, 'recall': 0.13435010014881046, 'f1-score': 0.19245714080123766, 'support': 159263}, 'accuracy': 0.3393264887063655, 'macro avg': {'precision': 0.3411991856634808, 'recall': 0.33243650567160393, 'f1-score': 0.2613564748739943, 'support': 487000}, 'weighted avg': {'precision': 0.34117147607916776, 'recall': 0.3393264887063655, 'f1-score': 0.2644934538640986, 'support': 487000}}
[[ 11288 130590  18608]
 [ 11596 132567  23088]
 [  9775 128091  21397]]
training model: results/AAPL/W4/deepLOB_L2/h200
Epoch 1/50
5165/5165 - 218s - loss: 3.2249 - accuracy200: 0.4120 - val_loss: 3.3888 - val_accuracy200: 0.3399 - 218s/epoch - 42ms/step
Epoch 2/50
5165/5165 - 217s - loss: 3.2031 - accuracy200: 0.4228 - val_loss: 3.4537 - val_accuracy200: 0.3369 - 217s/epoch - 42ms/step
Epoch 3/50
5165/5165 - 214s - loss: 3.1944 - accuracy200: 0.4279 - val_loss: 3.3803 - val_accuracy200: 0.3349 - 214s/epoch - 41ms/step
Epoch 4/50
5165/5165 - 213s - loss: 3.1867 - accuracy200: 0.4312 - val_loss: 3.3845 - val_accuracy200: 0.3280 - 213s/epoch - 41ms/step
Epoch 5/50
5165/5165 - 213s - loss: 3.1820 - accuracy200: 0.4342 - val_loss: 3.4118 - val_accuracy200: 0.3290 - 213s/epoch - 41ms/step
Epoch 6/50
5165/5165 - 215s - loss: 3.1762 - accuracy200: 0.4362 - val_loss: 3.4086 - val_accuracy200: 0.3323 - 215s/epoch - 42ms/step
Epoch 7/50
5165/5165 - 215s - loss: 3.1708 - accuracy200: 0.4379 - val_loss: 3.4164 - val_accuracy200: 0.3292 - 215s/epoch - 42ms/step
Epoch 8/50
5165/5165 - 216s - loss: 3.1670 - accuracy200: 0.4388 - val_loss: 3.4084 - val_accuracy200: 0.3340 - 216s/epoch - 42ms/step
Epoch 9/50
5165/5165 - 212s - loss: 3.1641 - accuracy200: 0.4399 - val_loss: 3.4104 - val_accuracy200: 0.3306 - 212s/epoch - 41ms/step
Epoch 10/50
5165/5165 - 214s - loss: 3.1604 - accuracy200: 0.4412 - val_loss: 3.4374 - val_accuracy200: 0.3378 - 214s/epoch - 41ms/step
Epoch 11/50
5165/5165 - 214s - loss: 3.1581 - accuracy200: 0.4419 - val_loss: 3.3937 - val_accuracy200: 0.3449 - 214s/epoch - 41ms/step
Epoch 12/50
5165/5165 - 214s - loss: 3.1550 - accuracy200: 0.4431 - val_loss: 3.3686 - val_accuracy200: 0.3486 - 214s/epoch - 41ms/step
Epoch 13/50
5165/5165 - 214s - loss: 3.1527 - accuracy200: 0.4440 - val_loss: 3.4068 - val_accuracy200: 0.3411 - 214s/epoch - 42ms/step
Epoch 14/50
5165/5165 - 215s - loss: 3.1499 - accuracy200: 0.4445 - val_loss: 3.4276 - val_accuracy200: 0.3383 - 215s/epoch - 42ms/step
Epoch 15/50
5165/5165 - 213s - loss: 3.1472 - accuracy200: 0.4457 - val_loss: 3.4554 - val_accuracy200: 0.3388 - 213s/epoch - 41ms/step
Epoch 16/50
5165/5165 - 212s - loss: 3.1453 - accuracy200: 0.4461 - val_loss: 3.4704 - val_accuracy200: 0.3361 - 212s/epoch - 41ms/step
Epoch 17/50
5165/5165 - 212s - loss: 3.1428 - accuracy200: 0.4471 - val_loss: 3.4764 - val_accuracy200: 0.3401 - 212s/epoch - 41ms/step
Epoch 18/50
5165/5165 - 212s - loss: 3.1403 - accuracy200: 0.4482 - val_loss: 3.5251 - val_accuracy200: 0.3413 - 212s/epoch - 41ms/step
Epoch 19/50
5165/5165 - 214s - loss: 3.1382 - accuracy200: 0.4487 - val_loss: 3.5236 - val_accuracy200: 0.3398 - 214s/epoch - 41ms/step
Epoch 20/50
5165/5165 - 212s - loss: 3.1356 - accuracy200: 0.4495 - val_loss: 3.6144 - val_accuracy200: 0.3362 - 212s/epoch - 41ms/step
Epoch 21/50
5165/5165 - 214s - loss: 3.1339 - accuracy200: 0.4500 - val_loss: 3.6228 - val_accuracy200: 0.3392 - 214s/epoch - 41ms/step
Epoch 22/50
5165/5165 - 214s - loss: 3.1315 - accuracy200: 0.4509 - val_loss: 3.6181 - val_accuracy200: 0.3398 - 214s/epoch - 41ms/step
testing model: results/AAPL/W4/deepLOB_L2/h200
Evaluating performance on  test set...
12724/12724 - 173s - 173s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1131581
{'0': {'precision': 0.2863530293188715, 'recall': 0.563872527898903, 'f1-score': 0.3798206373421991, 'support': 886594}, '1': {'precision': 0.46912618059605676, 'recall': 0.3066320748313545, 'f1-score': 0.3708607239625767, 'support': 1458533}, '2': {'precision': 0.3292626757016866, 'recall': 0.20144404727966492, 'f1-score': 0.24996105434228774, 'support': 912020}, 'accuracy': 0.3471995583865266, 'macro avg': {'precision': 0.36158062853887163, 'recall': 0.3573162166699741, 'f1-score': 0.3335474718823545, 'support': 3257147}, 'weighted avg': {'precision': 0.3802128177612789, 'recall': 0.3471995583865266, 'f1-score': 0.3394470016945295, 'support': 3257147}}
[[499926 250744 135924]
 [772968 447233 238332]
 [472944 255355 183721]]
Evaluating performance on  train set...
5165/5165 - 72s - 72s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.137302
{'0': {'precision': 0.35011175966460517, 'recall': 0.27622685127019625, 'f1-score': 0.3088114552621397, 'support': 437767}, '1': {'precision': 0.3520386372335599, 'recall': 0.5389796837277497, 'f1-score': 0.42589847793787666, 'support': 441961}, '2': {'precision': 0.34633496075850234, 'recall': 0.23492113008449864, 'f1-score': 0.27995027200887884, 'support': 442374}, 'accuracy': 0.3502407529827502, 'macro avg': {'precision': 0.3494951192188891, 'recall': 0.35004255502748155, 'f1-score': 0.3382200684029651, 'support': 1322102}, 'weighted avg': {'precision': 0.34949217592444326, 'recall': 0.3502407529827502, 'f1-score': 0.33829515663186266, 'support': 1322102}}
[[120923 218534  98310]
 [105921 238208  97832]
 [118540 219911 103923]]
Evaluating performance on  val set...
1903/1903 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1226003
{'0': {'precision': 0.3549547113694741, 'recall': 0.16482730046329427, 'f1-score': 0.2251183208724878, 'support': 159294}, '1': {'precision': 0.3547958639009918, 'recall': 0.6746288384827814, 'f1-score': 0.4650277402665018, 'support': 169468}, '2': {'precision': 0.32016432803929773, 'recall': 0.18370429353252696, 'f1-score': 0.23345594140512066, 'support': 158238}, 'accuracy': 0.3483634496919918, 'macro avg': {'precision': 0.3433049677699212, 'recall': 0.3410534774928676, 'f1-score': 0.3078673341813701, 'support': 487000}, 'weighted avg': {'precision': 0.34359520368941415, 'recall': 0.3483634496919918, 'f1-score': 0.31131195102383796, 'support': 487000}}
[[ 26256 104211  28827]
 [ 22242 114328  32898]
 [ 25472 103697  29069]]
training model: results/AAPL/W4/deepLOB_L2/h300
Epoch 1/50
5165/5165 - 216s - loss: 3.2343 - accuracy300: 0.4064 - val_loss: 3.3326 - val_accuracy300: 0.3213 - 216s/epoch - 42ms/step
Epoch 2/50
5165/5165 - 212s - loss: 3.2064 - accuracy300: 0.4207 - val_loss: 3.3976 - val_accuracy300: 0.3235 - 212s/epoch - 41ms/step
Epoch 3/50
5165/5165 - 214s - loss: 3.1973 - accuracy300: 0.4269 - val_loss: 3.4292 - val_accuracy300: 0.3234 - 214s/epoch - 41ms/step
Epoch 4/50
5165/5165 - 214s - loss: 3.1917 - accuracy300: 0.4295 - val_loss: 3.4419 - val_accuracy300: 0.3234 - 214s/epoch - 42ms/step
Epoch 5/50
5165/5165 - 213s - loss: 3.1857 - accuracy300: 0.4321 - val_loss: 3.5095 - val_accuracy300: 0.3215 - 213s/epoch - 41ms/step
Epoch 6/50
5165/5165 - 213s - loss: 3.1809 - accuracy300: 0.4339 - val_loss: 3.5144 - val_accuracy300: 0.3190 - 213s/epoch - 41ms/step
Epoch 7/50
5165/5165 - 213s - loss: 3.1761 - accuracy300: 0.4358 - val_loss: 3.5935 - val_accuracy300: 0.3210 - 213s/epoch - 41ms/step
Epoch 8/50
5165/5165 - 213s - loss: 3.1726 - accuracy300: 0.4371 - val_loss: 3.5866 - val_accuracy300: 0.3207 - 213s/epoch - 41ms/step
Epoch 9/50
5165/5165 - 214s - loss: 3.1696 - accuracy300: 0.4384 - val_loss: 3.6746 - val_accuracy300: 0.3219 - 214s/epoch - 41ms/step
Epoch 10/50
5165/5165 - 213s - loss: 3.1671 - accuracy300: 0.4397 - val_loss: 3.6013 - val_accuracy300: 0.3202 - 213s/epoch - 41ms/step
Epoch 11/50
5165/5165 - 215s - loss: 3.1630 - accuracy300: 0.4410 - val_loss: 3.6179 - val_accuracy300: 0.3225 - 215s/epoch - 42ms/step
testing model: results/AAPL/W4/deepLOB_L2/h300
Evaluating performance on  test set...
12724/12724 - 175s - 175s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1322446
{'0': {'precision': 0.2800268369877317, 'recall': 0.7523837285119244, 'f1-score': 0.40814699643114144, 'support': 912541}, '1': {'precision': 0.4352311413725139, 'recall': 0.06908676428970635, 'f1-score': 0.11924506720045754, 'support': 1406362}, '2': {'precision': 0.3229164340187642, 'recall': 0.2003306176218553, 'f1-score': 0.24726388219252513, 'support': 938244}, 'accuracy': 0.2983288749325714, 'macro avg': {'precision': 0.3460581374596699, 'recall': 0.340600370141162, 'f1-score': 0.2582186486080414, 'support': 3257147}, 'weighted avg': {'precision': 0.35939517467711907, 'recall': 0.2983288749325714, 'f1-score': 0.23706220608166703, 'support': 3257147}}
[[ 686581   65991  159969]
 [1075062   97161  234139]
 [ 690197   60088  187959]]
Evaluating performance on  train set...
5165/5165 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.126299
{'0': {'precision': 0.35274045592816405, 'recall': 0.3703053314348995, 'f1-score': 0.3613095428419589, 'support': 442470}, '1': {'precision': 0.3550414504978622, 'recall': 0.3954917228141739, 'f1-score': 0.37417654521038596, 'support': 432937}, '2': {'precision': 0.33460863170963695, 'recall': 0.2811560460717044, 'f1-score': 0.30556231387585886, 'support': 446695}, 'accuracy': 0.34843226921977277, 'macro avg': {'precision': 0.34746351271188775, 'recall': 0.34898436677359257, 'f1-score': 0.34701613397606784, 'support': 1322102}, 'weighted avg': {'precision': 0.34736779214483, 'recall': 0.34843226921977277, 'f1-score': 0.3466878214932034, 'support': 1322102}}
[[163849 153858 124763]
 [136731 171223 124983]
 [163923 157181 125591]]
Evaluating performance on  val set...
1903/1903 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1113389
{'0': {'precision': 0.32715844270919864, 'recall': 0.07313796860298123, 'f1-score': 0.11954992967651196, 'support': 161544}, '1': {'precision': 0.32480847893619713, 'recall': 0.701634207218204, 'f1-score': 0.44405156311254257, 'support': 164667}, '2': {'precision': 0.3066998665700087, 'recall': 0.1815547083444763, 'f1-score': 0.22808922920654764, 'support': 160789}, 'accuracy': 0.3214435318275154, 'macro avg': {'precision': 0.3195555960718015, 'recall': 0.31877562805522053, 'f1-score': 0.2638969073318674, 'support': 487000}, 'weighted avg': {'precision': 0.3196092117370158, 'recall': 0.3214435318275154, 'f1-score': 0.26510770360904945, 'support': 487000}}
[[ 11815 120284  29445]
 [ 12587 115536  36544]
 [ 11712 119885  29192]]
training model: results/AAPL/W4/deepLOB_L2/h500
Epoch 1/50
5165/5165 - 216s - loss: 3.2187 - accuracy500: 0.4158 - val_loss: 3.5771 - val_accuracy500: 0.3133 - 216s/epoch - 42ms/step
Epoch 2/50
5165/5165 - 214s - loss: 3.1825 - accuracy500: 0.4331 - val_loss: 3.4893 - val_accuracy500: 0.3034 - 214s/epoch - 41ms/step
Epoch 3/50
5165/5165 - 214s - loss: 3.1723 - accuracy500: 0.4381 - val_loss: 3.4439 - val_accuracy500: 0.3063 - 214s/epoch - 41ms/step
Epoch 4/50
5165/5165 - 213s - loss: 3.1636 - accuracy500: 0.4419 - val_loss: 3.4642 - val_accuracy500: 0.3152 - 213s/epoch - 41ms/step
Epoch 5/50
5165/5165 - 215s - loss: 3.1575 - accuracy500: 0.4445 - val_loss: 3.4091 - val_accuracy500: 0.3171 - 215s/epoch - 42ms/step
Epoch 6/50
5165/5165 - 213s - loss: 3.1526 - accuracy500: 0.4462 - val_loss: 3.4230 - val_accuracy500: 0.3143 - 213s/epoch - 41ms/step
Epoch 7/50
5165/5165 - 213s - loss: 3.1463 - accuracy500: 0.4488 - val_loss: 3.4474 - val_accuracy500: 0.3125 - 213s/epoch - 41ms/step
Epoch 8/50
5165/5165 - 214s - loss: 3.1423 - accuracy500: 0.4498 - val_loss: 3.4325 - val_accuracy500: 0.3122 - 214s/epoch - 41ms/step
Epoch 9/50
5165/5165 - 213s - loss: 3.1393 - accuracy500: 0.4510 - val_loss: 3.4413 - val_accuracy500: 0.3152 - 213s/epoch - 41ms/step
Epoch 10/50
5165/5165 - 212s - loss: 3.1360 - accuracy500: 0.4520 - val_loss: 3.4139 - val_accuracy500: 0.3196 - 212s/epoch - 41ms/step
Epoch 11/50
5165/5165 - 214s - loss: 3.1317 - accuracy500: 0.4535 - val_loss: 3.4319 - val_accuracy500: 0.3202 - 214s/epoch - 41ms/step
Epoch 12/50
5165/5165 - 213s - loss: 3.1304 - accuracy500: 0.4542 - val_loss: 3.4432 - val_accuracy500: 0.3170 - 213s/epoch - 41ms/step
Epoch 13/50
5165/5165 - 214s - loss: 3.1263 - accuracy500: 0.4553 - val_loss: 3.4527 - val_accuracy500: 0.3186 - 214s/epoch - 41ms/step
Epoch 14/50
5165/5165 - 213s - loss: 3.1231 - accuracy500: 0.4563 - val_loss: 3.5100 - val_accuracy500: 0.3197 - 213s/epoch - 41ms/step
Epoch 15/50
5165/5165 - 212s - loss: 3.1196 - accuracy500: 0.4577 - val_loss: 3.4592 - val_accuracy500: 0.3175 - 212s/epoch - 41ms/step
testing model: results/AAPL/W4/deepLOB_L2/h500
Evaluating performance on  test set...
12724/12724 - 174s - 174s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1996735
{'0': {'precision': 0.2912377368082289, 'recall': 0.7606515740591033, 'f1-score': 0.4212048561381956, 'support': 933923}, '1': {'precision': 0.42058377765420385, 'recall': 0.056921294759132594, 'f1-score': 0.10027191149099, 'support': 1355310}, '2': {'precision': 0.3335166766218395, 'recall': 0.21863512667447726, 'f1-score': 0.26412468602274675, 'support': 967914}, 'accuracy': 0.3067580308779432, 'macro avg': {'precision': 0.34844606369475734, 'recall': 0.34540266516423773, 'f1-score': 0.2618671512173108, 'support': 3257147}, 'weighted avg': {'precision': 0.3576229384493305, 'recall': 0.3067580308779432, 'f1-score': 0.2409846434837073, 'support': 3257147}}
[[ 710390   55007  168526]
 [1023799   77146  254365]
 [ 705021   51273  211620]]
Evaluating performance on  train set...
5165/5165 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1640267
{'0': {'precision': 0.3512328094493958, 'recall': 0.40918480382809874, 'f1-score': 0.3780005242463958, 'support': 440532}, '1': {'precision': 0.36324501005566456, 'recall': 0.40735773048602913, 'f1-score': 0.3840387663366851, 'support': 435406}, '2': {'precision': 0.33426803326242505, 'recall': 0.24019643001228247, 'f1-score': 0.27952986960819853, 'support': 446164}, 'accuracy': 0.3515553262910123, 'macro avg': {'precision': 0.3495819509224951, 'recall': 0.3522463214421368, 'f1-score': 0.34718972006375975, 'support': 1322102}, 'weighted avg': {'precision': 0.3494637415669551, 'recall': 0.3515553262910123, 'f1-score': 0.346758627387884, 'support': 1322102}}
[[180259 152320 107953]
 [152558 177366 105482]
 [180401 158596 107167]]
Evaluating performance on  val set...
1903/1903 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1374959
{'0': {'precision': 0.3145992959204804, 'recall': 0.04681808376221147, 'f1-score': 0.08150651859005312, 'support': 162245}, '1': {'precision': 0.32194016570505307, 'recall': 0.7772915931303935, 'f1-score': 0.45530231870057236, 'support': 164318}, '2': {'precision': 0.28840395608383995, 'recall': 0.11886908880121169, 'f1-score': 0.168350525019531, 'support': 160437}, 'accuracy': 0.31702258726899385, 'macro avg': {'precision': 0.30831447256979116, 'recall': 0.3143262552312723, 'f1-score': 0.23505312077005214, 'support': 487000}, 'weighted avg': {'precision': 0.3084463910003373, 'recall': 0.31702258726899385, 'f1-score': 0.23623828479556944, 'support': 487000}}
[[  7596 134747  19902]
 [  9442 127723  27153]
 [  7107 134259  19071]]
training model: results/AAPL/W4/deepLOB_L2/h1000
Epoch 1/50
5165/5165 - 218s - loss: 3.1569 - accuracy1000: 0.4467 - val_loss: 3.3849 - val_accuracy1000: 0.3198 - 218s/epoch - 42ms/step
Epoch 2/50
5165/5165 - 214s - loss: 3.1150 - accuracy1000: 0.4626 - val_loss: 3.4340 - val_accuracy1000: 0.3335 - 214s/epoch - 41ms/step
Epoch 3/50
5165/5165 - 214s - loss: 3.1000 - accuracy1000: 0.4665 - val_loss: 3.5301 - val_accuracy1000: 0.3354 - 214s/epoch - 41ms/step
Epoch 4/50
5165/5165 - 212s - loss: 3.0841 - accuracy1000: 0.4727 - val_loss: 3.4939 - val_accuracy1000: 0.3381 - 212s/epoch - 41ms/step
Epoch 5/50
5165/5165 - 212s - loss: 3.0732 - accuracy1000: 0.4763 - val_loss: 3.4813 - val_accuracy1000: 0.3342 - 212s/epoch - 41ms/step
Epoch 6/50
5165/5165 - 214s - loss: 3.0636 - accuracy1000: 0.4793 - val_loss: 3.5135 - val_accuracy1000: 0.3310 - 214s/epoch - 41ms/step
Epoch 7/50
5165/5165 - 213s - loss: 3.0578 - accuracy1000: 0.4808 - val_loss: 3.4708 - val_accuracy1000: 0.3358 - 213s/epoch - 41ms/step
Epoch 8/50
5165/5165 - 213s - loss: 3.0509 - accuracy1000: 0.4823 - val_loss: 3.4240 - val_accuracy1000: 0.3346 - 213s/epoch - 41ms/step
Epoch 9/50
5165/5165 - 213s - loss: 3.0451 - accuracy1000: 0.4841 - val_loss: 3.4105 - val_accuracy1000: 0.3363 - 213s/epoch - 41ms/step
Epoch 10/50
5165/5165 - 214s - loss: 3.0409 - accuracy1000: 0.4854 - val_loss: 3.4200 - val_accuracy1000: 0.3370 - 214s/epoch - 41ms/step
Epoch 11/50
5165/5165 - 213s - loss: 3.0378 - accuracy1000: 0.4863 - val_loss: 3.4202 - val_accuracy1000: 0.3341 - 213s/epoch - 41ms/step
testing model: results/AAPL/W4/deepLOB_L2/h1000
Evaluating performance on  test set...
12724/12724 - 173s - 173s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1668969
{'0': {'precision': 0.27476727788735916, 'recall': 0.6949816116359596, 'f1-score': 0.3938302124890252, 'support': 892956}, '1': {'precision': 0.3998754391309857, 'recall': 0.10189507037125077, 'f1-score': 0.16240626038547604, 'support': 1455566}, '2': {'precision': 0.31322920931922144, 'recall': 0.21636868895308844, 'f1-score': 0.25594132296712696, 'support': 908625}, 'accuracy': 0.29642536858176805, 'macro avg': {'precision': 0.3292906421125221, 'recall': 0.3377484569867663, 'f1-score': 0.27072593194720945, 'support': 3257147}, 'weighted avg': {'precision': 0.341405553125172, 'recall': 0.29642536858176805, 'f1-score': 0.2519446517484785, 'support': 3257147}}
[[ 620588  119040  153328]
 [1029528  148315  277723]
 [ 608479  103548  196598]]
Evaluating performance on  train set...
5165/5165 - 72s - 72s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1471637
{'0': {'precision': 0.35335987663463464, 'recall': 0.27715151915485836, 'f1-score': 0.3106501397806911, 'support': 439027}, '1': {'precision': 0.34968623478158145, 'recall': 0.446569963061844, 'f1-score': 0.39223398040125035, 'support': 437488}, '2': {'precision': 0.3311928335015666, 'recall': 0.31147677109071853, 'f1-score': 0.32103237386774736, 'support': 445587}, 'accuracy': 0.34478126498560624, 'macro avg': {'precision': 0.3447463149725942, 'recall': 0.34506608443580694, 'f1-score': 0.3413054980165629, 'support': 1322102}, 'weighted avg': {'precision': 0.34467331502626936, 'recall': 0.34478126498560624, 'f1-score': 0.3411456233406255, 'support': 1322102}}
[[121677 178222 139128]
 [100976 195369 141143]
 [121690 185107 138790]]
Evaluating performance on  val set...
1903/1903 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1274209
{'0': {'precision': 0.30458977642076235, 'recall': 0.038709717797708085, 'f1-score': 0.06868978537912653, 'support': 159779}, '1': {'precision': 0.3326203322941343, 'recall': 0.7180780753046299, 'f1-score': 0.45464496052071357, 'support': 173243}, '2': {'precision': 0.27415630933885726, 'recall': 0.16503006923066932, 'f1-score': 0.20603569198835675, 'support': 153978}, 'accuracy': 0.32032443531827515, 'macro avg': {'precision': 0.30378880601791797, 'recall': 0.3072726207776691, 'f1-score': 0.24312347929606562, 'support': 487000}, 'weighted avg': {'precision': 0.3049388794943414, 'recall': 0.32032443531827515, 'f1-score': 0.24941315378760703, 'support': 487000}}
[[  6185 126872  26722]
 [  8286 124402  40555]
 [  5835 122732  25411]]
training model: results/AAPL/W4/deepOF_L2/h10
Epoch 1/50
5165/5165 - 138s - loss: 3.0226 - accuracy10: 0.4881 - val_loss: 3.0906 - val_accuracy10: 0.4647 - 138s/epoch - 27ms/step
Epoch 2/50
5165/5165 - 113s - loss: 2.9442 - accuracy10: 0.5124 - val_loss: 3.0871 - val_accuracy10: 0.4734 - 113s/epoch - 22ms/step
Epoch 3/50
5165/5165 - 112s - loss: 2.9147 - accuracy10: 0.5192 - val_loss: 3.0813 - val_accuracy10: 0.4778 - 112s/epoch - 22ms/step
Epoch 4/50
5165/5165 - 113s - loss: 2.8993 - accuracy10: 0.5230 - val_loss: 3.0703 - val_accuracy10: 0.4822 - 113s/epoch - 22ms/step
Epoch 5/50
5165/5165 - 113s - loss: 2.8885 - accuracy10: 0.5258 - val_loss: 3.0421 - val_accuracy10: 0.4870 - 113s/epoch - 22ms/step
Epoch 6/50
5165/5165 - 112s - loss: 2.8799 - accuracy10: 0.5275 - val_loss: 3.0836 - val_accuracy10: 0.4824 - 112s/epoch - 22ms/step
Epoch 7/50
5165/5165 - 113s - loss: 2.8728 - accuracy10: 0.5295 - val_loss: 3.0868 - val_accuracy10: 0.4832 - 113s/epoch - 22ms/step
Epoch 8/50
5165/5165 - 112s - loss: 2.8677 - accuracy10: 0.5303 - val_loss: 3.1108 - val_accuracy10: 0.4795 - 112s/epoch - 22ms/step
Epoch 9/50
5165/5165 - 112s - loss: 2.8619 - accuracy10: 0.5318 - val_loss: 3.0851 - val_accuracy10: 0.4830 - 112s/epoch - 22ms/step
Epoch 10/50
5165/5165 - 111s - loss: 2.8573 - accuracy10: 0.5331 - val_loss: 3.0507 - val_accuracy10: 0.4908 - 111s/epoch - 21ms/step
Epoch 11/50
5165/5165 - 111s - loss: 2.8537 - accuracy10: 0.5336 - val_loss: 3.0394 - val_accuracy10: 0.4930 - 111s/epoch - 22ms/step
Epoch 12/50
5165/5165 - 111s - loss: 2.8495 - accuracy10: 0.5347 - val_loss: 3.0544 - val_accuracy10: 0.4909 - 111s/epoch - 21ms/step
Epoch 13/50
5165/5165 - 112s - loss: 2.8462 - accuracy10: 0.5356 - val_loss: 3.0706 - val_accuracy10: 0.4886 - 112s/epoch - 22ms/step
Epoch 14/50
5165/5165 - 112s - loss: 2.8424 - accuracy10: 0.5362 - val_loss: 3.0241 - val_accuracy10: 0.4951 - 112s/epoch - 22ms/step
Epoch 15/50
5165/5165 - 111s - loss: 2.8396 - accuracy10: 0.5367 - val_loss: 3.0141 - val_accuracy10: 0.4976 - 111s/epoch - 22ms/step
Epoch 16/50
5165/5165 - 111s - loss: 2.8364 - accuracy10: 0.5375 - val_loss: 3.0194 - val_accuracy10: 0.4960 - 111s/epoch - 22ms/step
Epoch 17/50
5165/5165 - 111s - loss: 2.8337 - accuracy10: 0.5382 - val_loss: 3.0063 - val_accuracy10: 0.4994 - 111s/epoch - 22ms/step
Epoch 18/50
5165/5165 - 111s - loss: 2.8309 - accuracy10: 0.5390 - val_loss: 3.0122 - val_accuracy10: 0.4987 - 111s/epoch - 22ms/step
Epoch 19/50
5165/5165 - 113s - loss: 2.8283 - accuracy10: 0.5392 - val_loss: 3.0085 - val_accuracy10: 0.4992 - 113s/epoch - 22ms/step
Epoch 20/50
5165/5165 - 113s - loss: 2.8259 - accuracy10: 0.5401 - val_loss: 2.9951 - val_accuracy10: 0.5003 - 113s/epoch - 22ms/step
Epoch 21/50
5165/5165 - 112s - loss: 2.8235 - accuracy10: 0.5405 - val_loss: 2.9854 - val_accuracy10: 0.5022 - 112s/epoch - 22ms/step
Epoch 22/50
5165/5165 - 112s - loss: 2.8213 - accuracy10: 0.5412 - val_loss: 2.9896 - val_accuracy10: 0.5018 - 112s/epoch - 22ms/step
Epoch 23/50
5165/5165 - 112s - loss: 2.8191 - accuracy10: 0.5418 - val_loss: 2.9769 - val_accuracy10: 0.5038 - 112s/epoch - 22ms/step
Epoch 24/50
5165/5165 - 111s - loss: 2.8170 - accuracy10: 0.5422 - val_loss: 3.0201 - val_accuracy10: 0.4980 - 111s/epoch - 22ms/step
Epoch 25/50
5165/5165 - 111s - loss: 2.8151 - accuracy10: 0.5426 - val_loss: 2.9868 - val_accuracy10: 0.5023 - 111s/epoch - 22ms/step
Epoch 26/50
5165/5165 - 112s - loss: 2.8129 - accuracy10: 0.5431 - val_loss: 2.9650 - val_accuracy10: 0.5064 - 112s/epoch - 22ms/step
Epoch 27/50
5165/5165 - 112s - loss: 2.8108 - accuracy10: 0.5434 - val_loss: 2.9709 - val_accuracy10: 0.5038 - 112s/epoch - 22ms/step
Epoch 28/50
5165/5165 - 111s - loss: 2.8091 - accuracy10: 0.5441 - val_loss: 2.9687 - val_accuracy10: 0.5052 - 111s/epoch - 21ms/step
Epoch 29/50
5165/5165 - 112s - loss: 2.8071 - accuracy10: 0.5445 - val_loss: 2.9657 - val_accuracy10: 0.5062 - 112s/epoch - 22ms/step
Epoch 30/50
5165/5165 - 112s - loss: 2.8058 - accuracy10: 0.5448 - val_loss: 2.9739 - val_accuracy10: 0.5057 - 112s/epoch - 22ms/step
Epoch 31/50
5165/5165 - 112s - loss: 2.8042 - accuracy10: 0.5451 - val_loss: 2.9846 - val_accuracy10: 0.5043 - 112s/epoch - 22ms/step
Epoch 32/50
5165/5165 - 112s - loss: 2.8026 - accuracy10: 0.5455 - val_loss: 2.9896 - val_accuracy10: 0.5037 - 112s/epoch - 22ms/step
Epoch 33/50
5165/5165 - 111s - loss: 2.8004 - accuracy10: 0.5460 - val_loss: 2.9855 - val_accuracy10: 0.5034 - 111s/epoch - 21ms/step
Epoch 34/50
5165/5165 - 112s - loss: 2.7988 - accuracy10: 0.5464 - val_loss: 2.9927 - val_accuracy10: 0.5035 - 112s/epoch - 22ms/step
Epoch 35/50
5165/5165 - 111s - loss: 2.7972 - accuracy10: 0.5466 - val_loss: 2.9781 - val_accuracy10: 0.5055 - 111s/epoch - 21ms/step
Epoch 36/50
5165/5165 - 112s - loss: 2.7958 - accuracy10: 0.5472 - val_loss: 2.9960 - val_accuracy10: 0.5030 - 112s/epoch - 22ms/step
testing model: results/AAPL/W4/deepOF_L2/h10
Evaluating performance on  test set...
12724/12724 - 101s - 101s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9535755
{'0': {'precision': 0.5450643468051063, 'recall': 0.41368370932901755, 'f1-score': 0.4703722513264535, 'support': 915702}, '1': {'precision': 0.5409649469209505, 'recall': 0.6080452080739994, 'f1-score': 0.5725469740739326, 'support': 1417092}, '2': {'precision': 0.4897095567526972, 'recall': 0.5135484541012106, 'f1-score': 0.5013457816596654, 'support': 924349}, 'accuracy': 0.52658572251817, 'macro avg': {'precision': 0.525246283492918, 'recall': 0.5117591238347425, 'f1-score': 0.5147550023533505, 'support': 3257143}, 'weighted avg': {'precision': 0.5275716019023519, 'recall': 0.52658572251817, 'f1-score': 0.5236156410080378, 'support': 3257143}}
[[378811 388185 148706]
 [209494 861656 345942]
 [106679 342972 474698]]
Evaluating performance on  train set...
5165/5165 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98804
{'0': {'precision': 0.5412800979999629, 'recall': 0.46554692755903715, 'f1-score': 0.5005652017193902, 'support': 438495}, '1': {'precision': 0.4652931189322775, 'recall': 0.4807086694162823, 'f1-score': 0.4728752922992878, 'support': 442971}, '2': {'precision': 0.5147769806612601, 'recall': 0.5693066385860438, 'f1-score': 0.5406703823921167, 'support': 440636}, 'accuracy': 0.5052083727276715, 'macro avg': {'precision': 0.5071167325311668, 'recall': 0.5051874118537878, 'f1-score': 0.5047036254702649, 'support': 1322102}, 'weighted avg': {'precision': 0.5069875428746788, 'recall': 0.5052083727276715, 'f1-score': 0.5046541143185508, 'support': 1322102}}
[[204140 133502 100853]
 [ 94429 212940 135602]
 [ 78574 111205 250857]]
Evaluating performance on  val set...
1903/1903 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9879103
{'0': {'precision': 0.546578360150853, 'recall': 0.4678015742266154, 'f1-score': 0.5041310630295339, 'support': 163890}, '1': {'precision': 0.4594162094523053, 'recall': 0.48789619284313285, 'f1-score': 0.4732280902879982, 'support': 156521}, '2': {'precision': 0.5177445625076175, 'recall': 0.5610007923740006, 'f1-score': 0.5385054192812322, 'support': 166588}, 'accuracy': 0.5061406696933669, 'macro avg': {'precision': 0.5079130440369252, 'recall': 0.5055661864812496, 'f1-score': 0.5052881908662548, 'support': 486999}, 'weighted avg': {'precision': 0.5087013384910987, 'recall': 0.5061406696933669, 'f1-score': 0.5059573317955478, 'support': 486999}}
[[76668 47386 39836]
 [32941 76366 47214]
 [30660 42472 93456]]
training model: results/AAPL/W4/deepOF_L2/h20
Epoch 1/50
5165/5165 - 115s - loss: 3.0888 - accuracy20: 0.4661 - val_loss: 3.1455 - val_accuracy20: 0.4314 - 115s/epoch - 22ms/step
Epoch 2/50
5165/5165 - 111s - loss: 3.0319 - accuracy20: 0.4851 - val_loss: 3.1411 - val_accuracy20: 0.4369 - 111s/epoch - 22ms/step
Epoch 3/50
5165/5165 - 112s - loss: 3.0072 - accuracy20: 0.4930 - val_loss: 3.1247 - val_accuracy20: 0.4447 - 112s/epoch - 22ms/step
Epoch 4/50
5165/5165 - 112s - loss: 2.9925 - accuracy20: 0.4970 - val_loss: 3.1111 - val_accuracy20: 0.4494 - 112s/epoch - 22ms/step
Epoch 5/50
5165/5165 - 110s - loss: 2.9831 - accuracy20: 0.4992 - val_loss: 3.1111 - val_accuracy20: 0.4490 - 110s/epoch - 21ms/step
Epoch 6/50
5165/5165 - 112s - loss: 2.9761 - accuracy20: 0.5008 - val_loss: 3.1054 - val_accuracy20: 0.4525 - 112s/epoch - 22ms/step
Epoch 7/50
5165/5165 - 111s - loss: 2.9703 - accuracy20: 0.5023 - val_loss: 3.1134 - val_accuracy20: 0.4501 - 111s/epoch - 22ms/step
Epoch 8/50
5165/5165 - 112s - loss: 2.9659 - accuracy20: 0.5031 - val_loss: 3.1138 - val_accuracy20: 0.4504 - 112s/epoch - 22ms/step
Epoch 9/50
5165/5165 - 111s - loss: 2.9619 - accuracy20: 0.5042 - val_loss: 3.1041 - val_accuracy20: 0.4531 - 111s/epoch - 21ms/step
Epoch 10/50
5165/5165 - 111s - loss: 2.9583 - accuracy20: 0.5054 - val_loss: 3.1100 - val_accuracy20: 0.4520 - 111s/epoch - 21ms/step
Epoch 11/50
5165/5165 - 112s - loss: 2.9554 - accuracy20: 0.5061 - val_loss: 3.0985 - val_accuracy20: 0.4547 - 112s/epoch - 22ms/step
Epoch 12/50
5165/5165 - 111s - loss: 2.9525 - accuracy20: 0.5066 - val_loss: 3.1035 - val_accuracy20: 0.4547 - 111s/epoch - 22ms/step
Epoch 13/50
5165/5165 - 111s - loss: 2.9496 - accuracy20: 0.5073 - val_loss: 3.1034 - val_accuracy20: 0.4532 - 111s/epoch - 21ms/step
Epoch 14/50
5165/5165 - 111s - loss: 2.9472 - accuracy20: 0.5081 - val_loss: 3.1062 - val_accuracy20: 0.4541 - 111s/epoch - 22ms/step
Epoch 15/50
5165/5165 - 114s - loss: 2.9447 - accuracy20: 0.5082 - val_loss: 3.0961 - val_accuracy20: 0.4561 - 114s/epoch - 22ms/step
Epoch 16/50
5165/5165 - 111s - loss: 2.9431 - accuracy20: 0.5089 - val_loss: 3.1002 - val_accuracy20: 0.4558 - 111s/epoch - 21ms/step
Epoch 17/50
5165/5165 - 111s - loss: 2.9408 - accuracy20: 0.5094 - val_loss: 3.1015 - val_accuracy20: 0.4561 - 111s/epoch - 22ms/step
Epoch 18/50
5165/5165 - 111s - loss: 2.9387 - accuracy20: 0.5101 - val_loss: 3.1015 - val_accuracy20: 0.4558 - 111s/epoch - 22ms/step
Epoch 19/50
5165/5165 - 110s - loss: 2.9372 - accuracy20: 0.5104 - val_loss: 3.0962 - val_accuracy20: 0.4581 - 110s/epoch - 21ms/step
Epoch 20/50
5165/5165 - 112s - loss: 2.9351 - accuracy20: 0.5110 - val_loss: 3.1004 - val_accuracy20: 0.4575 - 112s/epoch - 22ms/step
Epoch 21/50
5165/5165 - 112s - loss: 2.9332 - accuracy20: 0.5114 - val_loss: 3.0926 - val_accuracy20: 0.4584 - 112s/epoch - 22ms/step
Epoch 22/50
5165/5165 - 114s - loss: 2.9316 - accuracy20: 0.5116 - val_loss: 3.0936 - val_accuracy20: 0.4587 - 114s/epoch - 22ms/step
Epoch 23/50
5165/5165 - 112s - loss: 2.9300 - accuracy20: 0.5124 - val_loss: 3.1013 - val_accuracy20: 0.4567 - 112s/epoch - 22ms/step
Epoch 24/50
5165/5165 - 112s - loss: 2.9279 - accuracy20: 0.5130 - val_loss: 3.1046 - val_accuracy20: 0.4570 - 112s/epoch - 22ms/step
Epoch 25/50
5165/5165 - 111s - loss: 2.9266 - accuracy20: 0.5131 - val_loss: 3.0985 - val_accuracy20: 0.4588 - 111s/epoch - 21ms/step
Epoch 26/50
5165/5165 - 112s - loss: 2.9248 - accuracy20: 0.5138 - val_loss: 3.0939 - val_accuracy20: 0.4603 - 112s/epoch - 22ms/step
Epoch 27/50
5165/5165 - 112s - loss: 2.9235 - accuracy20: 0.5138 - val_loss: 3.0995 - val_accuracy20: 0.4585 - 112s/epoch - 22ms/step
Epoch 28/50
5165/5165 - 111s - loss: 2.9219 - accuracy20: 0.5144 - val_loss: 3.1004 - val_accuracy20: 0.4593 - 111s/epoch - 21ms/step
Epoch 29/50
5165/5165 - 111s - loss: 2.9207 - accuracy20: 0.5152 - val_loss: 3.0986 - val_accuracy20: 0.4606 - 111s/epoch - 22ms/step
Epoch 30/50
5165/5165 - 112s - loss: 2.9191 - accuracy20: 0.5152 - val_loss: 3.0983 - val_accuracy20: 0.4600 - 112s/epoch - 22ms/step
Epoch 31/50
5165/5165 - 113s - loss: 2.9175 - accuracy20: 0.5159 - val_loss: 3.1069 - val_accuracy20: 0.4581 - 113s/epoch - 22ms/step
testing model: results/AAPL/W4/deepOF_L2/h20
Evaluating performance on  test set...
12724/12724 - 95s - 95s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9847427
{'0': {'precision': 0.5130559723523772, 'recall': 0.4014178821405337, 'f1-score': 0.45042259180924454, 'support': 943802}, '1': {'precision': 0.48364118972573716, 'recall': 0.6490044574792015, 'f1-score': 0.5542515238144095, 'support': 1373422}, '2': {'precision': 0.5025825299617874, 'recall': 0.36129921833689926, 'f1-score': 0.4203878032672429, 'support': 939919}, 'accuracy': 0.4942392765684528, 'macro avg': {'precision': 0.49975989734663395, 'recall': 0.47057385265221147, 'f1-score': 0.475020639630299, 'support': 3257143}, 'weighted avg': {'precision': 0.4976304607666206, 'recall': 0.4942392765684528, 'f1-score': 0.48553639278168814, 'support': 3257143}}
[[378859 465825  99118]
 [245081 891357 236984]
 [114496 485831 339592]]
Evaluating performance on  train set...
5165/5165 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0273299
{'0': {'precision': 0.5035073405140215, 'recall': 0.4309149895598827, 'f1-score': 0.46439142858189963, 'support': 441087}, '1': {'precision': 0.3949863676378834, 'recall': 0.5258236581846979, 'f1-score': 0.45110972065904825, 'support': 439442}, '2': {'precision': 0.525326540657336, 'recall': 0.4278092184078284, 'f1-score': 0.47157927846066283, 'support': 441573}, 'accuracy': 0.46142355128424284, 'macro avg': {'precision': 0.4746067496030803, 'recall': 0.4615159553841363, 'f1-score': 0.46236014256720354, 'support': 1322102}, 'weighted avg': {'precision': 0.4747244601479438, 'recall': 0.46142355128424284, 'f1-score': 0.4623775296100211, 'support': 1322102}}
[[190071 182356  68660]
 [106339 231069 102034]
 [ 81084 171580 188909]]
Evaluating performance on  val set...
1903/1903 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0312617
{'0': {'precision': 0.5084946547240682, 'recall': 0.42826463878327, 'f1-score': 0.464943942671268, 'support': 164375}, '1': {'precision': 0.3931297165437453, 'recall': 0.5196779120858398, 'f1-score': 0.44763173283087515, 'support': 159087}, '2': {'precision': 0.5090986677467417, 'recall': 0.4304163583776148, 'f1-score': 0.4664627782066872, 'support': 163537}, 'accuracy': 0.45884899147636854, 'macro avg': {'precision': 0.4702410130048517, 'recall': 0.4594529697489082, 'f1-score': 0.4596794845696101, 'support': 486999}, 'weighted avg': {'precision': 0.47101144953760155, 'recall': 0.45884899147636854, 'f1-score': 0.459798630833004, 'support': 486999}}
[[70396 64676 29303]
 [37843 82674 38570]
 [30201 62947 70389]]
training model: results/AAPL/W4/deepOF_L2/h30
Epoch 1/50
5165/5165 - 115s - loss: 3.1311 - accuracy30: 0.4532 - val_loss: 3.1701 - val_accuracy30: 0.4171 - 115s/epoch - 22ms/step
Epoch 2/50
5165/5165 - 115s - loss: 3.0855 - accuracy30: 0.4701 - val_loss: 3.1655 - val_accuracy30: 0.4177 - 115s/epoch - 22ms/step
Epoch 3/50
5165/5165 - 113s - loss: 3.0659 - accuracy30: 0.4761 - val_loss: 3.1605 - val_accuracy30: 0.4206 - 113s/epoch - 22ms/step
Epoch 4/50
5165/5165 - 112s - loss: 3.0551 - accuracy30: 0.4792 - val_loss: 3.1614 - val_accuracy30: 0.4197 - 112s/epoch - 22ms/step
Epoch 5/50
5165/5165 - 111s - loss: 3.0482 - accuracy30: 0.4814 - val_loss: 3.1617 - val_accuracy30: 0.4222 - 111s/epoch - 22ms/step
Epoch 6/50
5165/5165 - 112s - loss: 3.0430 - accuracy30: 0.4825 - val_loss: 3.1594 - val_accuracy30: 0.4227 - 112s/epoch - 22ms/step
Epoch 7/50
5165/5165 - 112s - loss: 3.0388 - accuracy30: 0.4835 - val_loss: 3.1569 - val_accuracy30: 0.4261 - 112s/epoch - 22ms/step
Epoch 8/50
5165/5165 - 112s - loss: 3.0351 - accuracy30: 0.4850 - val_loss: 3.1555 - val_accuracy30: 0.4271 - 112s/epoch - 22ms/step
Epoch 9/50
5165/5165 - 111s - loss: 3.0319 - accuracy30: 0.4856 - val_loss: 3.1584 - val_accuracy30: 0.4245 - 111s/epoch - 22ms/step
Epoch 10/50
5165/5165 - 111s - loss: 3.0291 - accuracy30: 0.4866 - val_loss: 3.1480 - val_accuracy30: 0.4286 - 111s/epoch - 22ms/step
Epoch 11/50
5165/5165 - 112s - loss: 3.0263 - accuracy30: 0.4877 - val_loss: 3.1467 - val_accuracy30: 0.4296 - 112s/epoch - 22ms/step
Epoch 12/50
5165/5165 - 111s - loss: 3.0237 - accuracy30: 0.4878 - val_loss: 3.1482 - val_accuracy30: 0.4301 - 111s/epoch - 21ms/step
Epoch 13/50
5165/5165 - 111s - loss: 3.0217 - accuracy30: 0.4886 - val_loss: 3.1482 - val_accuracy30: 0.4279 - 111s/epoch - 22ms/step
Epoch 14/50
5165/5165 - 112s - loss: 3.0195 - accuracy30: 0.4891 - val_loss: 3.1469 - val_accuracy30: 0.4291 - 112s/epoch - 22ms/step
Epoch 15/50
5165/5165 - 111s - loss: 3.0173 - accuracy30: 0.4899 - val_loss: 3.1475 - val_accuracy30: 0.4308 - 111s/epoch - 22ms/step
Epoch 16/50
5165/5165 - 112s - loss: 3.0153 - accuracy30: 0.4900 - val_loss: 3.1451 - val_accuracy30: 0.4309 - 112s/epoch - 22ms/step
Epoch 17/50
5165/5165 - 112s - loss: 3.0133 - accuracy30: 0.4908 - val_loss: 3.1455 - val_accuracy30: 0.4316 - 112s/epoch - 22ms/step
Epoch 18/50
5165/5165 - 112s - loss: 3.0117 - accuracy30: 0.4911 - val_loss: 3.1516 - val_accuracy30: 0.4303 - 112s/epoch - 22ms/step
Epoch 19/50
5165/5165 - 112s - loss: 3.0103 - accuracy30: 0.4920 - val_loss: 3.1470 - val_accuracy30: 0.4314 - 112s/epoch - 22ms/step
Epoch 20/50
5165/5165 - 111s - loss: 3.0081 - accuracy30: 0.4928 - val_loss: 3.1559 - val_accuracy30: 0.4314 - 111s/epoch - 21ms/step
Epoch 21/50
5165/5165 - 111s - loss: 3.0070 - accuracy30: 0.4926 - val_loss: 3.1601 - val_accuracy30: 0.4291 - 111s/epoch - 21ms/step
Epoch 22/50
5165/5165 - 111s - loss: 3.0050 - accuracy30: 0.4931 - val_loss: 3.1541 - val_accuracy30: 0.4311 - 111s/epoch - 22ms/step
Epoch 23/50
5165/5165 - 112s - loss: 3.0033 - accuracy30: 0.4942 - val_loss: 3.1793 - val_accuracy30: 0.4270 - 112s/epoch - 22ms/step
Epoch 24/50
5165/5165 - 113s - loss: 3.0016 - accuracy30: 0.4940 - val_loss: 3.1652 - val_accuracy30: 0.4288 - 113s/epoch - 22ms/step
Epoch 25/50
5165/5165 - 116s - loss: 3.0006 - accuracy30: 0.4946 - val_loss: 3.1591 - val_accuracy30: 0.4319 - 116s/epoch - 22ms/step
Epoch 26/50
5165/5165 - 111s - loss: 2.9985 - accuracy30: 0.4954 - val_loss: 3.1624 - val_accuracy30: 0.4296 - 111s/epoch - 22ms/step
testing model: results/AAPL/W4/deepOF_L2/h30
Evaluating performance on  test set...
12724/12724 - 99s - 99s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0167814
{'0': {'precision': 0.5050561206412177, 'recall': 0.35369522876115567, 'f1-score': 0.41603647028149554, 'support': 963188}, '1': {'precision': 0.4435861066565237, 'recall': 0.6070946637753146, 'f1-score': 0.5126176586735457, 'support': 1333171}, '2': {'precision': 0.474529964592337, 'recall': 0.3743890406168296, 'f1-score': 0.41855304710462804, 'support': 960784}, 'accuracy': 0.4635175673895804, 'macro avg': {'precision': 0.4743907306300262, 'recall': 0.4450596443844333, 'f1-score': 0.4490690586865564, 'support': 3257143}, 'weighted avg': {'precision': 0.47089149160059646, 'recall': 0.4635175673895804, 'f1-score': 0.4563101476288685, 'support': 3257143}}
[[340675 507737 114776]
 [240265 809361 283545]
 [ 93589 507488 359707]]
Evaluating performance on  train set...
5165/5165 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.045043
{'0': {'precision': 0.5145524471380135, 'recall': 0.370791189031243, 'f1-score': 0.43099990986271697, 'support': 444900}, '1': {'precision': 0.357083572455585, 'recall': 0.5369212675687148, 'f1-score': 0.42891437667296395, 'support': 431093}, '2': {'precision': 0.5137886039869912, 'recall': 0.4068983140891576, 'f1-score': 0.4541385625362769, 'support': 446109}, 'accuracy': 0.43714403275995345, 'macro avg': {'precision': 0.4618082078601966, 'recall': 0.4382035902297052, 'f1-score': 0.4380176163573193, 'support': 1322102}, 'weighted avg': {'precision': 0.46294940372855525, 'recall': 0.43714403275995345, 'f1-score': 0.4381274253238379, 'support': 1322102}}
[[164965 213133  66802]
 [ 94654 231463 104976]
 [ 60980 203608 181521]]
Evaluating performance on  val set...
1903/1903 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0494438
{'0': {'precision': 0.5059299946515439, 'recall': 0.3652533127397982, 'f1-score': 0.4242335797600276, 'support': 163158}, '1': {'precision': 0.36088488920291384, 'recall': 0.5387994053163729, 'f1-score': 0.43225065697982296, 'support': 162103}, '2': {'precision': 0.49764523661637405, 'recall': 0.3913427889549766, 'f1-score': 0.4381383532864703, 'support': 161738}, 'accuracy': 0.4316846646502354, 'macro avg': {'precision': 0.45482004015694394, 'recall': 0.43179850233704925, 'f1-score': 0.43154086334210695, 'support': 486999}, 'weighted avg': {'precision': 0.4548986641485417, 'recall': 0.4316846646502354, 'f1-score': 0.4315200886218123, 'support': 486999}}
[[59594 78351 25213]
 [36081 87341 38681]
 [22116 76327 63295]]
training model: results/AAPL/W4/deepOF_L2/h50
Epoch 1/50
5165/5165 - 114s - loss: 3.1339 - accuracy50: 0.4557 - val_loss: 3.2132 - val_accuracy50: 0.3978 - 114s/epoch - 22ms/step
Epoch 2/50
5165/5165 - 112s - loss: 3.1004 - accuracy50: 0.4675 - val_loss: 3.2220 - val_accuracy50: 0.3890 - 112s/epoch - 22ms/step
Epoch 3/50
5165/5165 - 111s - loss: 3.0784 - accuracy50: 0.4748 - val_loss: 3.2273 - val_accuracy50: 0.3893 - 111s/epoch - 21ms/step
Epoch 4/50
5165/5165 - 111s - loss: 3.0685 - accuracy50: 0.4776 - val_loss: 3.2421 - val_accuracy50: 0.3858 - 111s/epoch - 22ms/step
Epoch 5/50
5165/5165 - 112s - loss: 3.0629 - accuracy50: 0.4793 - val_loss: 3.2309 - val_accuracy50: 0.3877 - 112s/epoch - 22ms/step
Epoch 6/50
5165/5165 - 111s - loss: 3.0589 - accuracy50: 0.4809 - val_loss: 3.2351 - val_accuracy50: 0.3901 - 111s/epoch - 22ms/step
Epoch 7/50
5165/5165 - 112s - loss: 3.0554 - accuracy50: 0.4814 - val_loss: 3.2373 - val_accuracy50: 0.3889 - 112s/epoch - 22ms/step
Epoch 8/50
5165/5165 - 111s - loss: 3.0523 - accuracy50: 0.4824 - val_loss: 3.2317 - val_accuracy50: 0.3923 - 111s/epoch - 22ms/step
Epoch 9/50
5165/5165 - 113s - loss: 3.0497 - accuracy50: 0.4830 - val_loss: 3.2314 - val_accuracy50: 0.3927 - 113s/epoch - 22ms/step
Epoch 10/50
5165/5165 - 116s - loss: 3.0471 - accuracy50: 0.4840 - val_loss: 3.2306 - val_accuracy50: 0.3962 - 116s/epoch - 22ms/step
Epoch 11/50
5165/5165 - 114s - loss: 3.0446 - accuracy50: 0.4848 - val_loss: 3.2229 - val_accuracy50: 0.4003 - 114s/epoch - 22ms/step
testing model: results/AAPL/W4/deepOF_L2/h50
Evaluating performance on  test set...
12724/12724 - 98s - 98s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0462782
{'0': {'precision': 0.3881626828022392, 'recall': 0.4197987479268804, 'f1-score': 0.4033613537350898, 'support': 877904}, '1': {'precision': 0.47288213053184264, 'recall': 0.5479423328964613, 'f1-score': 0.5076526808898623, 'support': 1506925}, '2': {'precision': 0.3846288085189736, 'recall': 0.24761267158385628, 'f1-score': 0.30127402216636767, 'support': 872314}, 'accuracy': 0.43297055118550215, 'macro avg': {'precision': 0.4152245406176851, 'recall': 0.405117917469066, 'f1-score': 0.4040960189304399, 'support': 3257143}, 'weighted avg': {'precision': 0.4264119109627468, 'recall': 0.43297055118550215, 'f1-score': 0.42427139656178403, 'support': 3257143}}
[[368543 423776  85585]
 [421228 825708 259989]
 [159684 496634 215996]]
Evaluating performance on  train set...
5165/5165 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0739988
{'0': {'precision': 0.4515409091137573, 'recall': 0.40801402590795954, 'f1-score': 0.4286753916083082, 'support': 440328}, '1': {'precision': 0.33553070340127666, 'recall': 0.5438316812571675, 'f1-score': 0.4150103068486171, 'support': 440355}, '2': {'precision': 0.46966097829805026, 'recall': 0.22395501779488422, 'f1-score': 0.30328865927195137, 'support': 441419}, 'accuracy': 0.39179806096655173, 'macro avg': {'precision': 0.4189108636043614, 'recall': 0.3919335749866704, 'f1-score': 0.38232478590962554, 'support': 1322102}, 'weighted avg': {'precision': 0.4189510398621731, 'recall': 0.39179806096655173, 'f1-score': 0.38226023271698506, 'support': 1322102}}
[[179660 219759  40909]
 [130155 239479  70721]
 [ 88067 254494  98858]]
Evaluating performance on  val set...
1903/1903 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0711911
{'0': {'precision': 0.43762928513345795, 'recall': 0.38904635988357716, 'f1-score': 0.4119102368284127, 'support': 157701}, '1': {'precision': 0.3597709705124535, 'recall': 0.5447278990197891, 'f1-score': 0.4333389272159246, 'support': 173024}, '2': {'precision': 0.44872097135447364, 'recall': 0.24357858632913984, 'f1-score': 0.3157558563939213, 'support': 156274}, 'accuracy': 0.3976784346579767, 'macro avg': {'precision': 0.41537374233346175, 'recall': 0.3924509484108354, 'f1-score': 0.38700167347941955, 'support': 486999}, 'weighted avg': {'precision': 0.41352653573051945, 'recall': 0.3976784346579767, 'f1-score': 0.38866839870880493, 'support': 486999}}
[[61353 79072 17276]
 [49284 94251 29489]
 [29557 88652 38065]]
training model: results/AAPL/W4/deepOF_L2/h100
Epoch 1/50
5165/5165 - 118s - loss: 3.2293 - accuracy100: 0.4104 - val_loss: 3.2560 - val_accuracy100: 0.3851 - 118s/epoch - 23ms/step
Epoch 2/50
5165/5165 - 116s - loss: 3.2095 - accuracy100: 0.4200 - val_loss: 3.2530 - val_accuracy100: 0.3855 - 116s/epoch - 22ms/step
Epoch 3/50
5165/5165 - 115s - loss: 3.1971 - accuracy100: 0.4249 - val_loss: 3.2540 - val_accuracy100: 0.3844 - 115s/epoch - 22ms/step
Epoch 4/50
5165/5165 - 112s - loss: 3.1908 - accuracy100: 0.4276 - val_loss: 3.2508 - val_accuracy100: 0.3852 - 112s/epoch - 22ms/step
Epoch 5/50
5165/5165 - 111s - loss: 3.1872 - accuracy100: 0.4291 - val_loss: 3.2512 - val_accuracy100: 0.3856 - 111s/epoch - 22ms/step
Epoch 6/50
5165/5165 - 111s - loss: 3.1848 - accuracy100: 0.4301 - val_loss: 3.2509 - val_accuracy100: 0.3860 - 111s/epoch - 22ms/step
Epoch 7/50
5165/5165 - 111s - loss: 3.1821 - accuracy100: 0.4313 - val_loss: 3.2515 - val_accuracy100: 0.3860 - 111s/epoch - 22ms/step
Epoch 8/50
5165/5165 - 112s - loss: 3.1803 - accuracy100: 0.4315 - val_loss: 3.2505 - val_accuracy100: 0.3878 - 112s/epoch - 22ms/step
Epoch 9/50
5165/5165 - 112s - loss: 3.1784 - accuracy100: 0.4324 - val_loss: 3.2487 - val_accuracy100: 0.3890 - 112s/epoch - 22ms/step
Epoch 10/50
5165/5165 - 112s - loss: 3.1770 - accuracy100: 0.4334 - val_loss: 3.2478 - val_accuracy100: 0.3902 - 112s/epoch - 22ms/step
Epoch 11/50
5165/5165 - 111s - loss: 3.1753 - accuracy100: 0.4339 - val_loss: 3.2485 - val_accuracy100: 0.3905 - 111s/epoch - 22ms/step
Epoch 12/50
5165/5165 - 112s - loss: 3.1740 - accuracy100: 0.4346 - val_loss: 3.2497 - val_accuracy100: 0.3896 - 112s/epoch - 22ms/step
Epoch 13/50
5165/5165 - 111s - loss: 3.1725 - accuracy100: 0.4350 - val_loss: 3.2483 - val_accuracy100: 0.3926 - 111s/epoch - 21ms/step
Epoch 14/50
5165/5165 - 112s - loss: 3.1711 - accuracy100: 0.4357 - val_loss: 3.2512 - val_accuracy100: 0.3911 - 112s/epoch - 22ms/step
Epoch 15/50
5165/5165 - 111s - loss: 3.1698 - accuracy100: 0.4365 - val_loss: 3.2532 - val_accuracy100: 0.3922 - 111s/epoch - 22ms/step
Epoch 16/50
5165/5165 - 111s - loss: 3.1683 - accuracy100: 0.4368 - val_loss: 3.2553 - val_accuracy100: 0.3924 - 111s/epoch - 22ms/step
Epoch 17/50
5165/5165 - 111s - loss: 3.1672 - accuracy100: 0.4373 - val_loss: 3.2533 - val_accuracy100: 0.3929 - 111s/epoch - 21ms/step
Epoch 18/50
5165/5165 - 110s - loss: 3.1654 - accuracy100: 0.4378 - val_loss: 3.2596 - val_accuracy100: 0.3920 - 110s/epoch - 21ms/step
Epoch 19/50
5165/5165 - 111s - loss: 3.1639 - accuracy100: 0.4388 - val_loss: 3.2587 - val_accuracy100: 0.3916 - 111s/epoch - 21ms/step
Epoch 20/50
5165/5165 - 111s - loss: 3.1623 - accuracy100: 0.4393 - val_loss: 3.2640 - val_accuracy100: 0.3889 - 111s/epoch - 22ms/step
testing model: results/AAPL/W4/deepOF_L2/h100
Evaluating performance on  test set...
12724/12724 - 94s - 94s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0707059
{'0': {'precision': 0.3724524372157055, 'recall': 0.4484527879508318, 'f1-score': 0.40693451260364527, 'support': 936297}, '1': {'precision': 0.44135998247905195, 'recall': 0.3952838769295146, 'f1-score': 0.41705316553495503, 'support': 1376512}, '2': {'precision': 0.370367934214883, 'recall': 0.3517960806240165, 'f1-score': 0.36084320173354373, 'support': 944334}, 'accuracy': 0.3979595000894956, 'macro avg': {'precision': 0.39472678463654676, 'recall': 0.398510915168121, 'f1-score': 0.394943626624048, 'support': 3257143}, 'weighted avg': {'precision': 0.40096932943958413, 'recall': 0.3979595000894956, 'f1-score': 0.39784767030798207, 'support': 3257143}}
[[419885 326918 189494]
 [457125 544113 375274]
 [250342 361779 332213]]
Evaluating performance on  train set...
5165/5165 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0831442
{'0': {'precision': 0.41875027222552924, 'recall': 0.45691143755275887, 'f1-score': 0.43699932684419796, 'support': 441869}, '1': {'precision': 0.3435572949654536, 'recall': 0.38164625426277, 'f1-score': 0.3616015252207542, 'support': 436336}, '2': {'precision': 0.4209523326971688, 'recall': 0.33689121575500625, 'f1-score': 0.3742596830886779, 'support': 443897}, 'accuracy': 0.3917746134564504, 'macro avg': {'precision': 0.3944199666293839, 'recall': 0.3918163025235117, 'f1-score': 0.3909535117178767, 'support': 1322102}, 'weighted avg': {'precision': 0.39467352558376256, 'recall': 0.3917746134564504, 'f1-score': 0.3910507428368286, 'support': 1322102}}
[[201895 152432  87542]
 [151643 166526 118167]
 [128599 165753 149545]]
Evaluating performance on  val set...
1903/1903 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0828769
{'0': {'precision': 0.4175799323989805, 'recall': 0.42580946741874165, 'f1-score': 0.4216545492698703, 'support': 160445}, '1': {'precision': 0.3559693742266219, 'recall': 0.3853569271434466, 'f1-score': 0.3700806620664306, 'support': 167219}, '2': {'precision': 0.40068695212407285, 'recall': 0.35801926758088304, 'f1-score': 0.37815334948608403, 'support': 159335}, 'accuracy': 0.38974002000004104, 'macro avg': {'precision': 0.39141208624989177, 'recall': 0.38972855404769047, 'f1-score': 0.3899628536074616, 'support': 486999}, 'weighted avg': {'precision': 0.39089794960409585, 'recall': 0.38974002000004104, 'f1-score': 0.3897132156904963, 'support': 486999}}
[[68319 56647 35479]
 [52936 64439 49844]
 [42352 59938 57045]]
training model: results/AAPL/W4/deepOF_L2/h200
Epoch 1/50
5165/5165 - 113s - loss: 3.2376 - accuracy200: 0.4037 - val_loss: 3.2947 - val_accuracy200: 0.3604 - 113s/epoch - 22ms/step
Epoch 2/50
5165/5165 - 111s - loss: 3.2213 - accuracy200: 0.4121 - val_loss: 3.2821 - val_accuracy200: 0.3632 - 111s/epoch - 21ms/step
Epoch 3/50
5165/5165 - 112s - loss: 3.2081 - accuracy200: 0.4186 - val_loss: 3.2781 - val_accuracy200: 0.3658 - 112s/epoch - 22ms/step
Epoch 4/50
5165/5165 - 111s - loss: 3.2022 - accuracy200: 0.4211 - val_loss: 3.2769 - val_accuracy200: 0.3653 - 111s/epoch - 22ms/step
Epoch 5/50
5165/5165 - 110s - loss: 3.1994 - accuracy200: 0.4225 - val_loss: 3.2772 - val_accuracy200: 0.3662 - 110s/epoch - 21ms/step
Epoch 6/50
5165/5165 - 111s - loss: 3.1974 - accuracy200: 0.4232 - val_loss: 3.2768 - val_accuracy200: 0.3658 - 111s/epoch - 22ms/step
Epoch 7/50
5165/5165 - 111s - loss: 3.1958 - accuracy200: 0.4240 - val_loss: 3.2773 - val_accuracy200: 0.3665 - 111s/epoch - 21ms/step
Epoch 8/50
5165/5165 - 111s - loss: 3.1945 - accuracy200: 0.4243 - val_loss: 3.2762 - val_accuracy200: 0.3666 - 111s/epoch - 22ms/step
Epoch 9/50
5165/5165 - 114s - loss: 3.1932 - accuracy200: 0.4252 - val_loss: 3.2766 - val_accuracy200: 0.3669 - 114s/epoch - 22ms/step
Epoch 10/50
5165/5165 - 111s - loss: 3.1921 - accuracy200: 0.4258 - val_loss: 3.2778 - val_accuracy200: 0.3665 - 111s/epoch - 22ms/step
Epoch 11/50
5165/5165 - 112s - loss: 3.1907 - accuracy200: 0.4266 - val_loss: 3.2791 - val_accuracy200: 0.3671 - 112s/epoch - 22ms/step
Epoch 12/50
5165/5165 - 111s - loss: 3.1898 - accuracy200: 0.4274 - val_loss: 3.2823 - val_accuracy200: 0.3654 - 111s/epoch - 22ms/step
Epoch 13/50
5165/5165 - 110s - loss: 3.1886 - accuracy200: 0.4278 - val_loss: 3.2825 - val_accuracy200: 0.3663 - 110s/epoch - 21ms/step
Epoch 14/50
5165/5165 - 110s - loss: 3.1875 - accuracy200: 0.4281 - val_loss: 3.2863 - val_accuracy200: 0.3651 - 110s/epoch - 21ms/step
Epoch 15/50
5165/5165 - 111s - loss: 3.1862 - accuracy200: 0.4291 - val_loss: 3.2837 - val_accuracy200: 0.3672 - 111s/epoch - 21ms/step
Epoch 16/50
5165/5165 - 111s - loss: 3.1852 - accuracy200: 0.4297 - val_loss: 3.2881 - val_accuracy200: 0.3643 - 111s/epoch - 22ms/step
Epoch 17/50
5165/5165 - 111s - loss: 3.1840 - accuracy200: 0.4300 - val_loss: 3.2903 - val_accuracy200: 0.3637 - 111s/epoch - 21ms/step
Epoch 18/50
5165/5165 - 111s - loss: 3.1825 - accuracy200: 0.4306 - val_loss: 3.2977 - val_accuracy200: 0.3623 - 111s/epoch - 22ms/step
testing model: results/AAPL/W4/deepOF_L2/h200
Evaluating performance on  test set...
12724/12724 - 93s - 93s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0962237
{'0': {'precision': 0.31191296127794793, 'recall': 0.5764885685604394, 'f1-score': 0.4048040227829925, 'support': 886590}, '1': {'precision': 0.46364628324619234, 'recall': 0.06991888424876229, 'f1-score': 0.1215132950408196, 'support': 1458533}, '2': {'precision': 0.3167322814940446, 'recall': 0.4857031644042894, 'f1-score': 0.3834274075927059, 'support': 912020}, 'accuracy': 0.32422862613032344, 'macro avg': {'precision': 0.36409717533939495, 'recall': 0.3773702057378303, 'f1-score': 0.30324824180550597, 'support': 3257143}, 'weighted avg': {'precision': 0.38120785367714377, 'recall': 0.32422862613032344, 'f1-score': 0.27196221154172373, 'support': 3257143}}
[[511109  56803 318678]
 [719637 101979 636917]
 [407881  61168 442971]]
Evaluating performance on  train set...
5165/5165 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0916222
{'0': {'precision': 0.371894593828784, 'recall': 0.5843794667117238, 'f1-score': 0.45452987460895766, 'support': 437962}, '1': {'precision': 0.3550295111738889, 'recall': 0.06370431386215465, 'f1-score': 0.10802524208882315, 'support': 441901}, '2': {'precision': 0.37563354759608014, 'recall': 0.47108463975361736, 'f1-score': 0.4179789618138664, 'support': 442239}, 'accuracy': 0.37245159601906663, 'macro avg': {'precision': 0.36751921753291766, 'recall': 0.37305614010916527, 'f1-score': 0.32684469283721573, 'support': 1322102}, 'weighted avg': {'precision': 0.3675082562276114, 'recall': 0.37245159601906663, 'f1-score': 0.3264875732291334, 'support': 1322102}}
[[255936  25090 156936]
 [224403  28151 189347]
 [207856  26051 208332]]
Evaluating performance on  val set...
1903/1903 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0921831
{'0': {'precision': 0.36882079952462055, 'recall': 0.5534581716338244, 'f1-score': 0.4426575727060644, 'support': 159246}, '1': {'precision': 0.3786921575761585, 'recall': 0.06755488945402621, 'f1-score': 0.11465625156476893, 'support': 169477}, '2': {'precision': 0.3628345401034899, 'recall': 0.4992860572670525, 'f1-score': 0.4202619158412551, 'support': 158276}, 'accuracy': 0.3667563999104721, 'macro avg': {'precision': 0.37011583240142293, 'recall': 0.37343303945163436, 'f1-score': 0.3258585800373628, 'support': 486999}, 'weighted avg': {'precision': 0.37031050885125494, 'recall': 0.3667563999104721, 'f1-score': 0.32123355563621847, 'support': 486999}}
[[88136  9388 61722]
 [80976 11449 77052]
 [69855  9396 79025]]
training model: results/AAPL/W4/deepOF_L2/h300
Epoch 1/50
5165/5165 - 113s - loss: 3.2562 - accuracy300: 0.3909 - val_loss: 3.3265 - val_accuracy300: 0.3566 - 113s/epoch - 22ms/step
Epoch 2/50
5165/5165 - 109s - loss: 3.2426 - accuracy300: 0.3983 - val_loss: 3.3127 - val_accuracy300: 0.3576 - 109s/epoch - 21ms/step
Epoch 3/50
5165/5165 - 110s - loss: 3.2319 - accuracy300: 0.4042 - val_loss: 3.3050 - val_accuracy300: 0.3586 - 110s/epoch - 21ms/step
Epoch 4/50
5165/5165 - 110s - loss: 3.2279 - accuracy300: 0.4063 - val_loss: 3.3028 - val_accuracy300: 0.3586 - 110s/epoch - 21ms/step
Epoch 5/50
5165/5165 - 111s - loss: 3.2254 - accuracy300: 0.4075 - val_loss: 3.3038 - val_accuracy300: 0.3590 - 111s/epoch - 21ms/step
Epoch 6/50
5165/5165 - 111s - loss: 3.2239 - accuracy300: 0.4086 - val_loss: 3.3029 - val_accuracy300: 0.3593 - 111s/epoch - 22ms/step
Epoch 7/50
5165/5165 - 111s - loss: 3.2225 - accuracy300: 0.4093 - val_loss: 3.3010 - val_accuracy300: 0.3600 - 111s/epoch - 21ms/step
Epoch 8/50
5165/5165 - 112s - loss: 3.2214 - accuracy300: 0.4098 - val_loss: 3.3034 - val_accuracy300: 0.3594 - 112s/epoch - 22ms/step
Epoch 9/50
5165/5165 - 110s - loss: 3.2203 - accuracy300: 0.4109 - val_loss: 3.3056 - val_accuracy300: 0.3591 - 110s/epoch - 21ms/step
Epoch 10/50
5165/5165 - 111s - loss: 3.2193 - accuracy300: 0.4114 - val_loss: 3.3030 - val_accuracy300: 0.3599 - 111s/epoch - 21ms/step
Epoch 11/50
5165/5165 - 112s - loss: 3.2184 - accuracy300: 0.4119 - val_loss: 3.3033 - val_accuracy300: 0.3602 - 112s/epoch - 22ms/step
Epoch 12/50
5165/5165 - 111s - loss: 3.2176 - accuracy300: 0.4124 - val_loss: 3.3034 - val_accuracy300: 0.3594 - 111s/epoch - 21ms/step
Epoch 13/50
5165/5165 - 112s - loss: 3.2166 - accuracy300: 0.4132 - val_loss: 3.3026 - val_accuracy300: 0.3597 - 112s/epoch - 22ms/step
Epoch 14/50
5165/5165 - 114s - loss: 3.2159 - accuracy300: 0.4137 - val_loss: 3.3005 - val_accuracy300: 0.3591 - 114s/epoch - 22ms/step
Epoch 15/50
5165/5165 - 111s - loss: 3.2150 - accuracy300: 0.4142 - val_loss: 3.3021 - val_accuracy300: 0.3590 - 111s/epoch - 22ms/step
Epoch 16/50
5165/5165 - 112s - loss: 3.2140 - accuracy300: 0.4147 - val_loss: 3.3048 - val_accuracy300: 0.3580 - 112s/epoch - 22ms/step
Epoch 17/50
5165/5165 - 110s - loss: 3.2133 - accuracy300: 0.4150 - val_loss: 3.3062 - val_accuracy300: 0.3578 - 110s/epoch - 21ms/step
Epoch 18/50
5165/5165 - 110s - loss: 3.2125 - accuracy300: 0.4162 - val_loss: 3.3067 - val_accuracy300: 0.3573 - 110s/epoch - 21ms/step
Epoch 19/50
5165/5165 - 112s - loss: 3.2115 - accuracy300: 0.4162 - val_loss: 3.3078 - val_accuracy300: 0.3567 - 112s/epoch - 22ms/step
Epoch 20/50
5165/5165 - 111s - loss: 3.2108 - accuracy300: 0.4168 - val_loss: 3.3080 - val_accuracy300: 0.3567 - 111s/epoch - 22ms/step
Epoch 21/50
5165/5165 - 111s - loss: 3.2098 - accuracy300: 0.4176 - val_loss: 3.3113 - val_accuracy300: 0.3553 - 111s/epoch - 22ms/step
Epoch 22/50
5165/5165 - 111s - loss: 3.2088 - accuracy300: 0.4177 - val_loss: 3.3121 - val_accuracy300: 0.3555 - 111s/epoch - 21ms/step
Epoch 23/50
5165/5165 - 110s - loss: 3.2073 - accuracy300: 0.4191 - val_loss: 3.3182 - val_accuracy300: 0.3535 - 110s/epoch - 21ms/step
Epoch 24/50
5165/5165 - 113s - loss: 3.2068 - accuracy300: 0.4190 - val_loss: 3.3204 - val_accuracy300: 0.3533 - 113s/epoch - 22ms/step
testing model: results/AAPL/W4/deepOF_L2/h300
Evaluating performance on  test set...
12724/12724 - 95s - 95s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1153101
{'0': {'precision': 0.31069782405107055, 'recall': 0.5947833462460235, 'f1-score': 0.4081761112709183, 'support': 912539}, '1': {'precision': 0.47472010967131245, 'recall': 0.010341583704326272, 'f1-score': 0.020242199362838362, 'support': 1406361}, '2': {'precision': 0.3170202556113518, 'recall': 0.4999344519490153, 'f1-score': 0.3880003292204217, 'support': 938243}, 'accuracy': 0.3151126616178657, 'macro avg': {'precision': 0.3674793964445782, 'recall': 0.36835312729978836, 'f1-score': 0.27213954661805945, 'support': 3257143}, 'weighted avg': {'precision': 0.383340174350576, 'recall': 0.3151126616178657, 'f1-score': 0.2348632077344867, 'support': 3257143}}
[[542763   8138 361638]
 [742925  14544 648892]
 [461228   7955 469060]]
Evaluating performance on  train set...
5165/5165 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0962745
{'0': {'precision': 0.3675902306974584, 'recall': 0.6223361702319989, 'f1-score': 0.462185261797569, 'support': 442502}, '1': {'precision': 0.3668227828977187, 'recall': 0.011215220920913755, 'f1-score': 0.021764999854332272, 'support': 432983}, '2': {'precision': 0.36712458973630563, 'recall': 0.46008100900771803, 'f1-score': 0.4083798560693538, 'support': 446617}, 'accuracy': 0.36738542109459027, 'macro avg': {'precision': 0.36717920111049424, 'recall': 0.3645441333868769, 'f1-score': 0.2974433725737517, 'support': 1322102}, 'weighted avg': {'precision': 0.3671815973092464, 'recall': 0.36738542109459027, 'f1-score': 0.2997735150737257, 'support': 1322102}}
[[275385   4187 162930]
 [236836   4856 191291]
 [236942   4195 205480]]
Evaluating performance on  val set...
1903/1903 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988775
{'0': {'precision': 0.3628239120716499, 'recall': 0.5827154227993514, 'f1-score': 0.4472010450065313, 'support': 161566}, '1': {'precision': 0.3953782271168081, 'recall': 0.01329989129312596, 'f1-score': 0.025734127683575983, 'support': 164663}, '2': {'precision': 0.3534616354921253, 'recall': 0.48802637307955465, 'f1-score': 0.40998468958526024, 'support': 160770}, 'accuracy': 0.35892681504479473, 'macro avg': {'precision': 0.37055459156019444, 'recall': 0.361347229057344, 'f1-score': 0.2943066207584559, 'support': 486999}, 'weighted avg': {'precision': 0.37074039233668266, 'recall': 0.35892681504479473, 'f1-score': 0.2924095968347126, 'support': 486999}}
[[94147  1706 65713]
 [84670  2190 77803]
 [80667  1643 78460]]
training model: results/AAPL/W4/deepOF_L2/h500
Epoch 1/50
5165/5165 - 114s - loss: 3.2586 - accuracy500: 0.3880 - val_loss: 3.3113 - val_accuracy500: 0.3498 - 114s/epoch - 22ms/step
Epoch 2/50
5165/5165 - 111s - loss: 3.2441 - accuracy500: 0.3965 - val_loss: 3.3038 - val_accuracy500: 0.3504 - 111s/epoch - 21ms/step
Epoch 3/50
5165/5165 - 110s - loss: 3.2351 - accuracy500: 0.4018 - val_loss: 3.2993 - val_accuracy500: 0.3500 - 110s/epoch - 21ms/step
Epoch 4/50
5165/5165 - 111s - loss: 3.2317 - accuracy500: 0.4037 - val_loss: 3.2960 - val_accuracy500: 0.3517 - 111s/epoch - 21ms/step
Epoch 5/50
5165/5165 - 110s - loss: 3.2302 - accuracy500: 0.4047 - val_loss: 3.2961 - val_accuracy500: 0.3519 - 110s/epoch - 21ms/step
Epoch 6/50
5165/5165 - 110s - loss: 3.2292 - accuracy500: 0.4053 - val_loss: 3.2942 - val_accuracy500: 0.3529 - 110s/epoch - 21ms/step
Epoch 7/50
5165/5165 - 111s - loss: 3.2281 - accuracy500: 0.4060 - val_loss: 3.2942 - val_accuracy500: 0.3527 - 111s/epoch - 21ms/step
Epoch 8/50
5165/5165 - 110s - loss: 3.2277 - accuracy500: 0.4061 - val_loss: 3.2941 - val_accuracy500: 0.3527 - 110s/epoch - 21ms/step
Epoch 9/50
5165/5165 - 110s - loss: 3.2267 - accuracy500: 0.4072 - val_loss: 3.2930 - val_accuracy500: 0.3534 - 110s/epoch - 21ms/step
Epoch 10/50
5165/5165 - 111s - loss: 3.2258 - accuracy500: 0.4075 - val_loss: 3.2937 - val_accuracy500: 0.3529 - 111s/epoch - 21ms/step
Epoch 11/50
5165/5165 - 111s - loss: 3.2254 - accuracy500: 0.4078 - val_loss: 3.2929 - val_accuracy500: 0.3530 - 111s/epoch - 22ms/step
Epoch 12/50
5165/5165 - 110s - loss: 3.2247 - accuracy500: 0.4081 - val_loss: 3.2918 - val_accuracy500: 0.3542 - 110s/epoch - 21ms/step
Epoch 13/50
5165/5165 - 112s - loss: 3.2240 - accuracy500: 0.4090 - val_loss: 3.2941 - val_accuracy500: 0.3531 - 112s/epoch - 22ms/step
Epoch 14/50
5165/5165 - 110s - loss: 3.2234 - accuracy500: 0.4093 - val_loss: 3.2922 - val_accuracy500: 0.3536 - 110s/epoch - 21ms/step
Epoch 15/50
5165/5165 - 110s - loss: 3.2228 - accuracy500: 0.4099 - val_loss: 3.2920 - val_accuracy500: 0.3534 - 110s/epoch - 21ms/step
Epoch 16/50
5165/5165 - 111s - loss: 3.2221 - accuracy500: 0.4102 - val_loss: 3.2927 - val_accuracy500: 0.3531 - 111s/epoch - 21ms/step
Epoch 17/50
5165/5165 - 110s - loss: 3.2214 - accuracy500: 0.4109 - val_loss: 3.2919 - val_accuracy500: 0.3533 - 110s/epoch - 21ms/step
Epoch 18/50
5165/5165 - 111s - loss: 3.2207 - accuracy500: 0.4112 - val_loss: 3.2921 - val_accuracy500: 0.3530 - 111s/epoch - 21ms/step
Epoch 19/50
5165/5165 - 110s - loss: 3.2200 - accuracy500: 0.4118 - val_loss: 3.2929 - val_accuracy500: 0.3522 - 110s/epoch - 21ms/step
Epoch 20/50
5165/5165 - 110s - loss: 3.2195 - accuracy500: 0.4121 - val_loss: 3.2957 - val_accuracy500: 0.3509 - 110s/epoch - 21ms/step
Epoch 21/50
5165/5165 - 110s - loss: 3.2188 - accuracy500: 0.4129 - val_loss: 3.2961 - val_accuracy500: 0.3509 - 110s/epoch - 21ms/step
Epoch 22/50
5165/5165 - 111s - loss: 3.2181 - accuracy500: 0.4134 - val_loss: 3.2975 - val_accuracy500: 0.3501 - 111s/epoch - 21ms/step
testing model: results/AAPL/W4/deepOF_L2/h500
Evaluating performance on  test set...
12724/12724 - 95s - 95s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1056169
{'0': {'precision': 0.3089526526320143, 'recall': 0.5278829793954735, 'f1-score': 0.3897798815482689, 'support': 933921}, '1': {'precision': 0.4312408614408565, 'recall': 0.012839138528556957, 'f1-score': 0.024935872633736013, 'support': 1355309}, '2': {'precision': 0.32407815801243, 'recall': 0.542770889532427, 'f1-score': 0.4058381112620066, 'support': 967913}, 'accuracy': 0.3179955562282651, 'macro avg': {'precision': 0.3547572240284336, 'recall': 0.3611643358188192, 'f1-score': 0.27351795514800387, 'support': 3257143}, 'weighted avg': {'precision': 0.3643320091053952, 'recall': 0.3179955562282651, 'f1-score': 0.2427389319857125, 'support': 3257143}}
[[493001  11641 429279]
 [671467  17401 666441]
 [431249  11309 525355]]
Evaluating performance on  train set...
5165/5165 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0955682
{'0': {'precision': 0.3593359036404232, 'recall': 0.5147915157926759, 'f1-score': 0.42324052626961894, 'support': 440489}, '1': {'precision': 0.3544720697449144, 'recall': 0.012606074524889476, 'f1-score': 0.02434632188241556, 'support': 435425}, '2': {'precision': 0.3601287220751846, 'recall': 0.545263431557998, 'f1-score': 0.43376789165519647, 'support': 446188}, 'accuracy': 0.35968404858324093, 'macro avg': {'precision': 0.3579788984868408, 'recall': 0.35755367395852106, 'f1-score': 0.293784913269077, 'support': 1322102}, 'weighted avg': {'precision': 0.35800159751110594, 'recall': 0.35968404858324093, 'f1-score': 0.29542033929566536, 'support': 1322102}}
[[226760   4891 208838]
 [206500   5489 223436]
 [197793   5105 243290]]
Evaluating performance on  val set...
1903/1903 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0966272
{'0': {'precision': 0.35581134579738666, 'recall': 0.4791379055319988, 'f1-score': 0.4083666228059808, 'support': 162256}, '1': {'precision': 0.3766194177716811, 'recall': 0.015044689608143981, 'f1-score': 0.028933579227774366, 'support': 164244}, '2': {'precision': 0.35142760066121254, 'recall': 0.5735487448519928, 'f1-score': 0.4358184082075172, 'support': 160499}, 'accuracy': 0.35373378590099774, 'macro avg': {'precision': 0.3612861214100935, 'recall': 0.3559104466640452, 'f1-score': 0.29103953674709077, 'support': 486999}, 'weighted avg': {'precision': 0.3613842818049251, 'recall': 0.35373378590099774, 'f1-score': 0.2894472478087062, 'support': 486999}}
[[77743  2090 82423]
 [74307  2471 87466]
 [66445  2000 92054]]
training model: results/AAPL/W4/deepOF_L2/h1000
Epoch 1/50
5165/5165 - 115s - loss: 3.2510 - accuracy1000: 0.3903 - val_loss: 3.3354 - val_accuracy1000: 0.3233 - 115s/epoch - 22ms/step
Epoch 2/50
5165/5165 - 112s - loss: 3.2345 - accuracy1000: 0.3983 - val_loss: 3.3341 - val_accuracy1000: 0.3272 - 112s/epoch - 22ms/step
Epoch 3/50
5165/5165 - 109s - loss: 3.2260 - accuracy1000: 0.4033 - val_loss: 3.3338 - val_accuracy1000: 0.3296 - 109s/epoch - 21ms/step
Epoch 4/50
5165/5165 - 111s - loss: 3.2228 - accuracy1000: 0.4051 - val_loss: 3.3344 - val_accuracy1000: 0.3306 - 111s/epoch - 21ms/step
Epoch 5/50
5165/5165 - 111s - loss: 3.2211 - accuracy1000: 0.4058 - val_loss: 3.3336 - val_accuracy1000: 0.3307 - 111s/epoch - 21ms/step
Epoch 6/50
5165/5165 - 110s - loss: 3.2198 - accuracy1000: 0.4061 - val_loss: 3.3303 - val_accuracy1000: 0.3312 - 110s/epoch - 21ms/step
Epoch 7/50
5165/5165 - 110s - loss: 3.2186 - accuracy1000: 0.4069 - val_loss: 3.3292 - val_accuracy1000: 0.3322 - 110s/epoch - 21ms/step
Epoch 8/50
5165/5165 - 111s - loss: 3.2181 - accuracy1000: 0.4070 - val_loss: 3.3279 - val_accuracy1000: 0.3324 - 111s/epoch - 21ms/step
Epoch 9/50
5165/5165 - 111s - loss: 3.2172 - accuracy1000: 0.4079 - val_loss: 3.3254 - val_accuracy1000: 0.3319 - 111s/epoch - 21ms/step
Epoch 10/50
5165/5165 - 110s - loss: 3.2165 - accuracy1000: 0.4083 - val_loss: 3.3262 - val_accuracy1000: 0.3311 - 110s/epoch - 21ms/step
Epoch 11/50
5165/5165 - 109s - loss: 3.2154 - accuracy1000: 0.4091 - val_loss: 3.3239 - val_accuracy1000: 0.3314 - 109s/epoch - 21ms/step
Epoch 12/50
5165/5165 - 109s - loss: 3.2145 - accuracy1000: 0.4095 - val_loss: 3.3225 - val_accuracy1000: 0.3318 - 109s/epoch - 21ms/step
Epoch 13/50
5165/5165 - 112s - loss: 3.2140 - accuracy1000: 0.4101 - val_loss: 3.3219 - val_accuracy1000: 0.3312 - 112s/epoch - 22ms/step
Epoch 14/50
5165/5165 - 110s - loss: 3.2131 - accuracy1000: 0.4107 - val_loss: 3.3201 - val_accuracy1000: 0.3309 - 110s/epoch - 21ms/step
Epoch 15/50
5165/5165 - 111s - loss: 3.2125 - accuracy1000: 0.4110 - val_loss: 3.3182 - val_accuracy1000: 0.3310 - 111s/epoch - 21ms/step
Epoch 16/50
5165/5165 - 111s - loss: 3.2119 - accuracy1000: 0.4117 - val_loss: 3.3190 - val_accuracy1000: 0.3307 - 111s/epoch - 21ms/step
Epoch 17/50
5165/5165 - 111s - loss: 3.2111 - accuracy1000: 0.4120 - val_loss: 3.3191 - val_accuracy1000: 0.3304 - 111s/epoch - 21ms/step
Epoch 18/50
5165/5165 - 111s - loss: 3.2105 - accuracy1000: 0.4124 - val_loss: 3.3193 - val_accuracy1000: 0.3313 - 111s/epoch - 21ms/step
Epoch 19/50
5165/5165 - 111s - loss: 3.2099 - accuracy1000: 0.4128 - val_loss: 3.3188 - val_accuracy1000: 0.3301 - 111s/epoch - 22ms/step
Epoch 20/50
5165/5165 - 110s - loss: 3.2093 - accuracy1000: 0.4131 - val_loss: 3.3196 - val_accuracy1000: 0.3304 - 110s/epoch - 21ms/step
Epoch 21/50
5165/5165 - 109s - loss: 3.2087 - accuracy1000: 0.4132 - val_loss: 3.3200 - val_accuracy1000: 0.3300 - 109s/epoch - 21ms/step
Epoch 22/50
5165/5165 - 111s - loss: 3.2079 - accuracy1000: 0.4142 - val_loss: 3.3205 - val_accuracy1000: 0.3299 - 111s/epoch - 21ms/step
Epoch 23/50
5165/5165 - 111s - loss: 3.2073 - accuracy1000: 0.4145 - val_loss: 3.3180 - val_accuracy1000: 0.3304 - 111s/epoch - 22ms/step
Epoch 24/50
5165/5165 - 110s - loss: 3.2067 - accuracy1000: 0.4151 - val_loss: 3.3207 - val_accuracy1000: 0.3307 - 110s/epoch - 21ms/step
Epoch 25/50
5165/5165 - 109s - loss: 3.2061 - accuracy1000: 0.4149 - val_loss: 3.3215 - val_accuracy1000: 0.3298 - 109s/epoch - 21ms/step
Epoch 26/50
5165/5165 - 110s - loss: 3.2054 - accuracy1000: 0.4159 - val_loss: 3.3209 - val_accuracy1000: 0.3302 - 110s/epoch - 21ms/step
Epoch 27/50
5165/5165 - 110s - loss: 3.2046 - accuracy1000: 0.4160 - val_loss: 3.3199 - val_accuracy1000: 0.3314 - 110s/epoch - 21ms/step
Epoch 28/50
5165/5165 - 110s - loss: 3.2038 - accuracy1000: 0.4167 - val_loss: 3.3217 - val_accuracy1000: 0.3308 - 110s/epoch - 21ms/step
Epoch 29/50
5165/5165 - 110s - loss: 3.2031 - accuracy1000: 0.4174 - val_loss: 3.3250 - val_accuracy1000: 0.3308 - 110s/epoch - 21ms/step
Epoch 30/50
5165/5165 - 110s - loss: 3.2023 - accuracy1000: 0.4179 - val_loss: 3.3202 - val_accuracy1000: 0.3317 - 110s/epoch - 21ms/step
Epoch 31/50
5165/5165 - 109s - loss: 3.2016 - accuracy1000: 0.4182 - val_loss: 3.3240 - val_accuracy1000: 0.3325 - 109s/epoch - 21ms/step
Epoch 32/50
5165/5165 - 110s - loss: 3.2007 - accuracy1000: 0.4188 - val_loss: 3.3203 - val_accuracy1000: 0.3336 - 110s/epoch - 21ms/step
Epoch 33/50
5165/5165 - 115s - loss: 3.2000 - accuracy1000: 0.4192 - val_loss: 3.3215 - val_accuracy1000: 0.3339 - 115s/epoch - 22ms/step
testing model: results/AAPL/W4/deepOF_L2/h1000
Evaluating performance on  test set...
12724/12724 - 96s - 96s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1198206
{'0': {'precision': 0.2931764027741573, 'recall': 0.35770191712217775, 'f1-score': 0.3222407572094346, 'support': 892953}, '1': {'precision': 0.5402059470091404, 'recall': 0.006415373813348209, 'f1-score': 0.0126801606678743, 'support': 1455566}, '2': {'precision': 0.2947293330040881, 'recall': 0.697514043212594, 'f1-score': 0.4143698081429959, 'support': 908624}, 'accuracy': 0.2955126624775148, 'macro avg': {'precision': 0.3760372275957953, 'recall': 0.35387711138270667, 'f1-score': 0.2497635753401016, 'support': 3257143}, 'weighted avg': {'precision': 0.40400323330053517, 'recall': 0.2955126624775148, 'f1-score': 0.20960363550794453, 'support': 3257143}}
[[319411   4387 569155]
 [498788   9338 947440]
 [271285   3561 633778]]
Evaluating performance on  train set...
5165/5165 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990863
{'0': {'precision': 0.3507390087606509, 'recall': 0.3062397952328793, 'f1-score': 0.3269823670722337, 'support': 439133}, '1': {'precision': 0.3712025316455696, 'recall': 0.005365363900203317, 'f1-score': 0.010577835691854031, 'support': 437249}, '2': {'precision': 0.34868500787783296, 'recall': 0.7293839181548954, 'f1-score': 0.4718162839248434, 'support': 445720}, 'accuracy': 0.3493883225348725, 'macro avg': {'precision': 0.35687551609468454, 'recall': 0.34699635909599263, 'f1-score': 0.26979216222964375, 'support': 1322102}, 'weighted avg': {'precision': 0.3568142931520354, 'recall': 0.3493883225348725, 'f1-score': 0.271168071713786, 'support': 1322102}}
[[134480   2023 302630]
 [130271   2346 304632]
 [118668   1951 325101]]
Evaluating performance on  val set...
1903/1903 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1048785
{'0': {'precision': 0.33749923138412347, 'recall': 0.2748308516564333, 'f1-score': 0.30295817162570077, 'support': 159771}, '1': {'precision': 0.4049733570159858, 'recall': 0.00658058036100833, 'f1-score': 0.012950719105718765, 'support': 173237}, '2': {'precision': 0.3275248531405332, 'recall': 0.7530959601535154, 'f1-score': 0.45651099944692763, 'support': 153991}, 'accuracy': 0.33063722923455696, 'macro avg': {'precision': 0.35666581384688084, 'recall': 0.34483579739031905, 'f1-score': 0.25747329672611574, 'support': 486999}, 'weighted avg': {'precision': 0.3583474274214423, 'recall': 0.33063722923455696, 'f1-score': 0.24834970724859615, 'support': 486999}}
[[ 43910    833 115028]
 [ 49015   1140 123082]
 [ 37179    842 115970]]
training model: results/AAPL/W4/deepVOL_L2/h10
Epoch 1/50
5165/5165 - 133s - loss: 3.0897 - accuracy10: 0.4644 - val_loss: 3.1101 - val_accuracy10: 0.4541 - 133s/epoch - 26ms/step
Epoch 2/50
5165/5165 - 124s - loss: 2.9880 - accuracy10: 0.4977 - val_loss: 3.0637 - val_accuracy10: 0.4699 - 124s/epoch - 24ms/step
Epoch 3/50
5165/5165 - 113s - loss: 2.9539 - accuracy10: 0.5074 - val_loss: 3.0460 - val_accuracy10: 0.4811 - 113s/epoch - 22ms/step
Epoch 4/50
5165/5165 - 109s - loss: 2.9317 - accuracy10: 0.5133 - val_loss: 3.0199 - val_accuracy10: 0.4896 - 109s/epoch - 21ms/step
Epoch 5/50
5165/5165 - 121s - loss: 2.9161 - accuracy10: 0.5171 - val_loss: 3.0226 - val_accuracy10: 0.4889 - 121s/epoch - 23ms/step
Epoch 6/50
5165/5165 - 122s - loss: 2.9039 - accuracy10: 0.5201 - val_loss: 3.0139 - val_accuracy10: 0.4932 - 122s/epoch - 24ms/step
Epoch 7/50
5165/5165 - 115s - loss: 2.8941 - accuracy10: 0.5227 - val_loss: 3.0033 - val_accuracy10: 0.4959 - 115s/epoch - 22ms/step
Epoch 8/50
5165/5165 - 122s - loss: 2.8865 - accuracy10: 0.5249 - val_loss: 2.9884 - val_accuracy10: 0.4997 - 122s/epoch - 24ms/step
Epoch 9/50
5165/5165 - 113s - loss: 2.8799 - accuracy10: 0.5264 - val_loss: 2.9684 - val_accuracy10: 0.5048 - 113s/epoch - 22ms/step
Epoch 10/50
5165/5165 - 115s - loss: 2.8745 - accuracy10: 0.5279 - val_loss: 2.9801 - val_accuracy10: 0.5026 - 115s/epoch - 22ms/step
Epoch 11/50
5165/5165 - 125s - loss: 2.8690 - accuracy10: 0.5292 - val_loss: 2.9629 - val_accuracy10: 0.5063 - 125s/epoch - 24ms/step
Epoch 12/50
5165/5165 - 117s - loss: 2.8643 - accuracy10: 0.5303 - val_loss: 2.9512 - val_accuracy10: 0.5083 - 117s/epoch - 23ms/step
Epoch 13/50
5165/5165 - 124s - loss: 2.8600 - accuracy10: 0.5314 - val_loss: 2.9507 - val_accuracy10: 0.5084 - 124s/epoch - 24ms/step
Epoch 14/50
5165/5165 - 124s - loss: 2.8560 - accuracy10: 0.5325 - val_loss: 2.9460 - val_accuracy10: 0.5108 - 124s/epoch - 24ms/step
Epoch 15/50
5165/5165 - 124s - loss: 2.8525 - accuracy10: 0.5333 - val_loss: 2.9334 - val_accuracy10: 0.5129 - 124s/epoch - 24ms/step
Epoch 16/50
5165/5165 - 125s - loss: 2.8492 - accuracy10: 0.5342 - val_loss: 2.9476 - val_accuracy10: 0.5099 - 125s/epoch - 24ms/step
Epoch 17/50
5165/5165 - 121s - loss: 2.8462 - accuracy10: 0.5348 - val_loss: 2.9336 - val_accuracy10: 0.5128 - 121s/epoch - 23ms/step
Epoch 18/50
5165/5165 - 121s - loss: 2.8432 - accuracy10: 0.5356 - val_loss: 2.9380 - val_accuracy10: 0.5112 - 121s/epoch - 23ms/step
Epoch 19/50
5165/5165 - 116s - loss: 2.8408 - accuracy10: 0.5359 - val_loss: 2.9238 - val_accuracy10: 0.5148 - 116s/epoch - 23ms/step
Epoch 20/50
5165/5165 - 113s - loss: 2.8380 - accuracy10: 0.5367 - val_loss: 2.9238 - val_accuracy10: 0.5147 - 113s/epoch - 22ms/step
Epoch 21/50
5165/5165 - 123s - loss: 2.8354 - accuracy10: 0.5377 - val_loss: 2.9235 - val_accuracy10: 0.5150 - 123s/epoch - 24ms/step
Epoch 22/50
5165/5165 - 123s - loss: 2.8328 - accuracy10: 0.5380 - val_loss: 2.9291 - val_accuracy10: 0.5139 - 123s/epoch - 24ms/step
Epoch 23/50
5165/5165 - 125s - loss: 2.8308 - accuracy10: 0.5386 - val_loss: 2.9276 - val_accuracy10: 0.5140 - 125s/epoch - 24ms/step
Epoch 24/50
5165/5165 - 122s - loss: 2.8285 - accuracy10: 0.5390 - val_loss: 2.9134 - val_accuracy10: 0.5175 - 122s/epoch - 24ms/step
Epoch 25/50
5165/5165 - 117s - loss: 2.8267 - accuracy10: 0.5394 - val_loss: 2.9206 - val_accuracy10: 0.5156 - 117s/epoch - 23ms/step
Epoch 26/50
5165/5165 - 118s - loss: 2.8247 - accuracy10: 0.5401 - val_loss: 2.9124 - val_accuracy10: 0.5175 - 118s/epoch - 23ms/step
Epoch 27/50
5165/5165 - 113s - loss: 2.8226 - accuracy10: 0.5405 - val_loss: 2.9150 - val_accuracy10: 0.5176 - 113s/epoch - 22ms/step
Epoch 28/50
5165/5165 - 117s - loss: 2.8203 - accuracy10: 0.5411 - val_loss: 2.9131 - val_accuracy10: 0.5176 - 117s/epoch - 23ms/step
Epoch 29/50
5165/5165 - 119s - loss: 2.8195 - accuracy10: 0.5412 - val_loss: 2.9144 - val_accuracy10: 0.5169 - 119s/epoch - 23ms/step
Epoch 30/50
5165/5165 - 125s - loss: 2.8171 - accuracy10: 0.5417 - val_loss: 2.9108 - val_accuracy10: 0.5184 - 125s/epoch - 24ms/step
Epoch 31/50
5165/5165 - 122s - loss: 2.8153 - accuracy10: 0.5424 - val_loss: 2.9081 - val_accuracy10: 0.5192 - 122s/epoch - 24ms/step
Epoch 32/50
5165/5165 - 111s - loss: 2.8137 - accuracy10: 0.5427 - val_loss: 2.9037 - val_accuracy10: 0.5191 - 111s/epoch - 21ms/step
Epoch 33/50
5165/5165 - 120s - loss: 2.8122 - accuracy10: 0.5432 - val_loss: 2.9085 - val_accuracy10: 0.5187 - 120s/epoch - 23ms/step
Epoch 34/50
5165/5165 - 124s - loss: 2.8106 - accuracy10: 0.5434 - val_loss: 2.9050 - val_accuracy10: 0.5198 - 124s/epoch - 24ms/step
Epoch 35/50
5165/5165 - 117s - loss: 2.8089 - accuracy10: 0.5439 - val_loss: 2.9013 - val_accuracy10: 0.5204 - 117s/epoch - 23ms/step
Epoch 36/50
5165/5165 - 122s - loss: 2.8077 - accuracy10: 0.5441 - val_loss: 2.9027 - val_accuracy10: 0.5197 - 122s/epoch - 24ms/step
Epoch 37/50
5165/5165 - 123s - loss: 2.8062 - accuracy10: 0.5443 - val_loss: 2.9037 - val_accuracy10: 0.5194 - 123s/epoch - 24ms/step
Epoch 38/50
5165/5165 - 123s - loss: 2.8050 - accuracy10: 0.5451 - val_loss: 2.9032 - val_accuracy10: 0.5198 - 123s/epoch - 24ms/step
Epoch 39/50
5165/5165 - 123s - loss: 2.8036 - accuracy10: 0.5452 - val_loss: 2.8999 - val_accuracy10: 0.5204 - 123s/epoch - 24ms/step
Epoch 40/50
5165/5165 - 121s - loss: 2.8022 - accuracy10: 0.5458 - val_loss: 2.9047 - val_accuracy10: 0.5193 - 121s/epoch - 24ms/step
Epoch 41/50
5165/5165 - 128s - loss: 2.8008 - accuracy10: 0.5463 - val_loss: 2.9029 - val_accuracy10: 0.5198 - 128s/epoch - 25ms/step
Epoch 42/50
5165/5165 - 117s - loss: 2.7994 - accuracy10: 0.5461 - val_loss: 2.9012 - val_accuracy10: 0.5208 - 117s/epoch - 23ms/step
Epoch 43/50
5165/5165 - 118s - loss: 2.7979 - accuracy10: 0.5467 - val_loss: 2.8952 - val_accuracy10: 0.5217 - 118s/epoch - 23ms/step
Epoch 44/50
5165/5165 - 118s - loss: 2.7970 - accuracy10: 0.5468 - val_loss: 2.9044 - val_accuracy10: 0.5197 - 118s/epoch - 23ms/step
Epoch 45/50
5165/5165 - 117s - loss: 2.7958 - accuracy10: 0.5471 - val_loss: 2.9135 - val_accuracy10: 0.5173 - 117s/epoch - 23ms/step
Epoch 46/50
5165/5165 - 119s - loss: 2.7945 - accuracy10: 0.5474 - val_loss: 2.8958 - val_accuracy10: 0.5218 - 119s/epoch - 23ms/step
Epoch 47/50
5165/5165 - 115s - loss: 2.7926 - accuracy10: 0.5477 - val_loss: 2.9025 - val_accuracy10: 0.5200 - 115s/epoch - 22ms/step
Epoch 48/50
5165/5165 - 110s - loss: 2.7917 - accuracy10: 0.5480 - val_loss: 2.9010 - val_accuracy10: 0.5196 - 110s/epoch - 21ms/step
Epoch 49/50
5165/5165 - 120s - loss: 2.7903 - accuracy10: 0.5483 - val_loss: 2.8985 - val_accuracy10: 0.5209 - 120s/epoch - 23ms/step
Epoch 50/50
5165/5165 - 115s - loss: 2.7894 - accuracy10: 0.5487 - val_loss: 2.9064 - val_accuracy10: 0.5189 - 115s/epoch - 22ms/step
testing model: results/AAPL/W4/deepVOL_L2/h10
Evaluating performance on  test set...
12724/12724 - 132s - 132s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9346684
{'0': {'precision': 0.5485165320116776, 'recall': 0.44114049705909975, 'f1-score': 0.4890034597217212, 'support': 915706}, '1': {'precision': 0.5447551978254048, 'recall': 0.63583027778013, 'f1-score': 0.5867797900492364, 'support': 1417092}, '2': {'precision': 0.5129954493427854, 'recall': 0.4809947325090415, 'f1-score': 0.49647997221721274, 'support': 924349}, 'accuracy': 0.5371547553733375, 'macro avg': {'precision': 0.5354223930599559, 'recall': 0.5193218357827571, 'f1-score': 0.5240877406627235, 'support': 3257147}, 'weighted avg': {'precision': 0.5367995189850622, 'recall': 0.5371547553733375, 'f1-score': 0.5336649264424969, 'support': 3257147}}
[[403955 380406 131345]
 [225326 901030 290736]
 [107169 372573 444607]]
Evaluating performance on  train set...
5165/5165 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9586951
{'0': {'precision': 0.558295413875965, 'recall': 0.4980217685275345, 'f1-score': 0.526438978767101, 'support': 438523}, '1': {'precision': 0.4810565139512639, 'recall': 0.5436039886361329, 'f1-score': 0.5104212352929959, 'support': 443159}, '2': {'precision': 0.5510957983740291, 'recall': 0.5382362290540847, 'f1-score': 0.5445901100781909, 'support': 440420}, 'accuracy': 0.526696881178608, 'macro avg': {'precision': 0.530149242067086, 'recall': 0.5266206620725841, 'f1-score': 0.527150108046096, 'support': 1322102}, 'weighted avg': {'precision': 0.5300071514642198, 'recall': 0.526696881178608, 'f1-score': 0.5271164711782684, 'support': 1322102}}
[[218394 132845  87284]
 [ 96447 240903 105809]
 [ 76339 127031 237050]]
Evaluating performance on  val set...
1903/1903 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96506095
{'0': {'precision': 0.5707297912235324, 'recall': 0.4697270986080443, 'f1-score': 0.5153260102184555, 'support': 163942}, '1': {'precision': 0.4663040452277448, 'recall': 0.5562793787042714, 'f1-score': 0.5073333255670367, 'support': 156576}, '2': {'precision': 0.5448412722421544, 'recall': 0.5409173364087408, 'f1-score': 0.5428722137657679, 'support': 166482}, 'accuracy': 0.5218911704312115, 'macro avg': {'precision': 0.5272917028978106, 'recall': 0.5223079379070188, 'f1-score': 0.52184384985042, 'support': 487000}, 'weighted avg': {'precision': 0.5283056885087599, 'recall': 0.5218911704312115, 'f1-score': 0.5221730009104126, 'support': 487000}}
[[77008 51095 35839]
 [30085 87100 39391]
 [27836 48593 90053]]
training model: results/AAPL/W4/deepVOL_L2/h20
Epoch 1/50
5165/5165 - 121s - loss: 3.1368 - accuracy20: 0.4491 - val_loss: 3.1864 - val_accuracy20: 0.4353 - 121s/epoch - 23ms/step
Epoch 2/50
5165/5165 - 111s - loss: 3.0609 - accuracy20: 0.4752 - val_loss: 3.1369 - val_accuracy20: 0.4405 - 111s/epoch - 21ms/step
Epoch 3/50
5165/5165 - 124s - loss: 3.0320 - accuracy20: 0.4849 - val_loss: 3.1237 - val_accuracy20: 0.4389 - 124s/epoch - 24ms/step
Epoch 4/50
5165/5165 - 112s - loss: 3.0159 - accuracy20: 0.4899 - val_loss: 3.1100 - val_accuracy20: 0.4431 - 112s/epoch - 22ms/step
Epoch 5/50
5165/5165 - 115s - loss: 3.0044 - accuracy20: 0.4930 - val_loss: 3.1025 - val_accuracy20: 0.4484 - 115s/epoch - 22ms/step
Epoch 6/50
5165/5165 - 124s - loss: 2.9963 - accuracy20: 0.4953 - val_loss: 3.0990 - val_accuracy20: 0.4488 - 124s/epoch - 24ms/step
Epoch 7/50
5165/5165 - 125s - loss: 2.9894 - accuracy20: 0.4970 - val_loss: 3.0906 - val_accuracy20: 0.4522 - 125s/epoch - 24ms/step
Epoch 8/50
5165/5165 - 124s - loss: 2.9838 - accuracy20: 0.4984 - val_loss: 3.0892 - val_accuracy20: 0.4551 - 124s/epoch - 24ms/step
Epoch 9/50
5165/5165 - 111s - loss: 2.9787 - accuracy20: 0.4999 - val_loss: 3.0804 - val_accuracy20: 0.4578 - 111s/epoch - 21ms/step
Epoch 10/50
5165/5165 - 124s - loss: 2.9741 - accuracy20: 0.5010 - val_loss: 3.0742 - val_accuracy20: 0.4588 - 124s/epoch - 24ms/step
Epoch 11/50
5165/5165 - 115s - loss: 2.9699 - accuracy20: 0.5020 - val_loss: 3.0736 - val_accuracy20: 0.4597 - 115s/epoch - 22ms/step
Epoch 12/50
5165/5165 - 119s - loss: 2.9666 - accuracy20: 0.5030 - val_loss: 3.0749 - val_accuracy20: 0.4605 - 119s/epoch - 23ms/step
Epoch 13/50
5165/5165 - 115s - loss: 2.9628 - accuracy20: 0.5042 - val_loss: 3.0671 - val_accuracy20: 0.4638 - 115s/epoch - 22ms/step
Epoch 14/50
5165/5165 - 128s - loss: 2.9599 - accuracy20: 0.5049 - val_loss: 3.0659 - val_accuracy20: 0.4652 - 128s/epoch - 25ms/step
Epoch 15/50
5165/5165 - 122s - loss: 2.9564 - accuracy20: 0.5059 - val_loss: 3.0635 - val_accuracy20: 0.4662 - 122s/epoch - 24ms/step
Epoch 16/50
5165/5165 - 117s - loss: 2.9536 - accuracy20: 0.5065 - val_loss: 3.0572 - val_accuracy20: 0.4684 - 117s/epoch - 23ms/step
Epoch 17/50
5165/5165 - 121s - loss: 2.9506 - accuracy20: 0.5073 - val_loss: 3.0539 - val_accuracy20: 0.4713 - 121s/epoch - 23ms/step
Epoch 18/50
5165/5165 - 124s - loss: 2.9481 - accuracy20: 0.5084 - val_loss: 3.0511 - val_accuracy20: 0.4713 - 124s/epoch - 24ms/step
Epoch 19/50
5165/5165 - 122s - loss: 2.9452 - accuracy20: 0.5090 - val_loss: 3.0463 - val_accuracy20: 0.4735 - 122s/epoch - 24ms/step
Epoch 20/50
5165/5165 - 111s - loss: 2.9427 - accuracy20: 0.5095 - val_loss: 3.0491 - val_accuracy20: 0.4732 - 111s/epoch - 22ms/step
Epoch 21/50
5165/5165 - 124s - loss: 2.9410 - accuracy20: 0.5100 - val_loss: 3.0450 - val_accuracy20: 0.4746 - 124s/epoch - 24ms/step
Epoch 22/50
5165/5165 - 124s - loss: 2.9387 - accuracy20: 0.5106 - val_loss: 3.0472 - val_accuracy20: 0.4737 - 124s/epoch - 24ms/step
Epoch 23/50
5165/5165 - 124s - loss: 2.9362 - accuracy20: 0.5111 - val_loss: 3.0410 - val_accuracy20: 0.4758 - 124s/epoch - 24ms/step
Epoch 24/50
5165/5165 - 115s - loss: 2.9346 - accuracy20: 0.5115 - val_loss: 3.0376 - val_accuracy20: 0.4782 - 115s/epoch - 22ms/step
Epoch 25/50
5165/5165 - 123s - loss: 2.9326 - accuracy20: 0.5122 - val_loss: 3.0392 - val_accuracy20: 0.4771 - 123s/epoch - 24ms/step
Epoch 26/50
5165/5165 - 111s - loss: 2.9309 - accuracy20: 0.5125 - val_loss: 3.0390 - val_accuracy20: 0.4773 - 111s/epoch - 21ms/step
Epoch 27/50
5165/5165 - 122s - loss: 2.9292 - accuracy20: 0.5129 - val_loss: 3.0351 - val_accuracy20: 0.4803 - 122s/epoch - 24ms/step
Epoch 28/50
5165/5165 - 116s - loss: 2.9277 - accuracy20: 0.5136 - val_loss: 3.0405 - val_accuracy20: 0.4769 - 116s/epoch - 23ms/step
Epoch 29/50
5165/5165 - 126s - loss: 2.9257 - accuracy20: 0.5144 - val_loss: 3.0340 - val_accuracy20: 0.4784 - 126s/epoch - 24ms/step
Epoch 30/50
5165/5165 - 113s - loss: 2.9243 - accuracy20: 0.5146 - val_loss: 3.0340 - val_accuracy20: 0.4781 - 113s/epoch - 22ms/step
Epoch 31/50
5165/5165 - 122s - loss: 2.9231 - accuracy20: 0.5152 - val_loss: 3.0284 - val_accuracy20: 0.4804 - 122s/epoch - 24ms/step
Epoch 32/50
5165/5165 - 115s - loss: 2.9214 - accuracy20: 0.5156 - val_loss: 3.0316 - val_accuracy20: 0.4801 - 115s/epoch - 22ms/step
Epoch 33/50
5165/5165 - 121s - loss: 2.9199 - accuracy20: 0.5156 - val_loss: 3.0301 - val_accuracy20: 0.4812 - 121s/epoch - 23ms/step
Epoch 34/50
5165/5165 - 117s - loss: 2.9184 - accuracy20: 0.5160 - val_loss: 3.0330 - val_accuracy20: 0.4790 - 117s/epoch - 23ms/step
Epoch 35/50
5165/5165 - 126s - loss: 2.9172 - accuracy20: 0.5165 - val_loss: 3.0355 - val_accuracy20: 0.4789 - 126s/epoch - 24ms/step
Epoch 36/50
5165/5165 - 114s - loss: 2.9157 - accuracy20: 0.5171 - val_loss: 3.0351 - val_accuracy20: 0.4800 - 114s/epoch - 22ms/step
Epoch 37/50
5165/5165 - 115s - loss: 2.9142 - accuracy20: 0.5175 - val_loss: 3.0303 - val_accuracy20: 0.4814 - 115s/epoch - 22ms/step
Epoch 38/50
5165/5165 - 120s - loss: 2.9130 - accuracy20: 0.5177 - val_loss: 3.0354 - val_accuracy20: 0.4790 - 120s/epoch - 23ms/step
Epoch 39/50
5165/5165 - 117s - loss: 2.9115 - accuracy20: 0.5183 - val_loss: 3.0317 - val_accuracy20: 0.4806 - 117s/epoch - 23ms/step
Epoch 40/50
5165/5165 - 125s - loss: 2.9107 - accuracy20: 0.5184 - val_loss: 3.0342 - val_accuracy20: 0.4804 - 125s/epoch - 24ms/step
Epoch 41/50
5165/5165 - 120s - loss: 2.9093 - accuracy20: 0.5186 - val_loss: 3.0344 - val_accuracy20: 0.4794 - 120s/epoch - 23ms/step
testing model: results/AAPL/W4/deepVOL_L2/h20
Evaluating performance on  test set...
12724/12724 - 142s - 142s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.977683
{'0': {'precision': 0.5172771318717427, 'recall': 0.41865957480623645, 'f1-score': 0.46277279765013973, 'support': 943805}, '1': {'precision': 0.49039243056572024, 'recall': 0.6000923241363543, 'f1-score': 0.5397246172000958, 'support': 1373422}, '2': {'precision': 0.5008921737289909, 'recall': 0.4330538769256958, 'f1-score': 0.46450926711028895, 'support': 939920}, 'accuracy': 0.49931704034236096, 'macro avg': {'precision': 0.5028539120554846, 'recall': 0.48393525862276215, 'f1-score': 0.48900222732017484, 'support': 3257147}, 'weighted avg': {'precision': 0.5012125851703948, 'recall': 0.49931704034236096, 'f1-score': 0.4957217140745207, 'support': 3257147}}
[[395133 432816 115856]
 [259512 824180 289730]
 [109226 423658 407036]]
Evaluating performance on  train set...
5165/5165 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.002431
{'0': {'precision': 0.5355638799749415, 'recall': 0.4746001210003603, 'f1-score': 0.5032424081517913, 'support': 441321}, '1': {'precision': 0.41527499927517325, 'recall': 0.5220830286337842, 'f1-score': 0.4625938496971678, 'support': 438957}, '2': {'precision': 0.5413425958893452, 'recall': 0.4645650756862461, 'f1-score': 0.5000237519564913, 'support': 441824}, 'accuracy': 0.48701159214644557, 'macro avg': {'precision': 0.49739382504648666, 'recall': 0.48708274177346356, 'f1-score': 0.4886200032684835, 'support': 1322102}, 'weighted avg': {'precision': 0.49755737909591496, 'recall': 0.48701159214644557, 'f1-score': 0.4886708782483509, 'support': 1322102}}
[[209451 160914  70956]
 [106836 229172 102949]
 [ 74798 161770 205256]]
Evaluating performance on  val set...
1903/1903 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0096699
{'0': {'precision': 0.5438946829033036, 'recall': 0.4397738281654613, 'f1-score': 0.4863236834924047, 'support': 164123}, '1': {'precision': 0.41001033803421305, 'recall': 0.5275872671255655, 'f1-score': 0.46142659184765455, 'support': 159367}, '2': {'precision': 0.522884445278366, 'recall': 0.4772124029111369, 'f1-score': 0.49900555736750885, 'support': 163510}, 'accuracy': 0.4810800821355236, 'macro avg': {'precision': 0.49226315540529414, 'recall': 0.48152449940072123, 'f1-score': 0.4822519442358561, 'support': 487000}, 'weighted avg': {'precision': 0.49302788548481097, 'recall': 0.4810800821355236, 'f1-score': 0.4824342346077422, 'support': 487000}}
[[72177 62059 29887]
 [33975 84080 41312]
 [26552 58929 78029]]
training model: results/AAPL/W4/deepVOL_L2/h30
Epoch 1/50
5165/5165 - 125s - loss: 3.1726 - accuracy30: 0.4377 - val_loss: 3.2127 - val_accuracy30: 0.4089 - 125s/epoch - 24ms/step
Epoch 2/50
5165/5165 - 124s - loss: 3.1214 - accuracy30: 0.4562 - val_loss: 3.1817 - val_accuracy30: 0.4220 - 124s/epoch - 24ms/step
Epoch 3/50
5165/5165 - 115s - loss: 3.0949 - accuracy30: 0.4657 - val_loss: 3.1674 - val_accuracy30: 0.4264 - 115s/epoch - 22ms/step
Epoch 4/50
5165/5165 - 116s - loss: 3.0814 - accuracy30: 0.4705 - val_loss: 3.1713 - val_accuracy30: 0.4257 - 116s/epoch - 22ms/step
Epoch 5/50
5165/5165 - 123s - loss: 3.0715 - accuracy30: 0.4739 - val_loss: 3.1626 - val_accuracy30: 0.4258 - 123s/epoch - 24ms/step
Epoch 6/50
5165/5165 - 116s - loss: 3.0643 - accuracy30: 0.4757 - val_loss: 3.1628 - val_accuracy30: 0.4254 - 116s/epoch - 23ms/step
Epoch 7/50
5165/5165 - 123s - loss: 3.0583 - accuracy30: 0.4779 - val_loss: 3.1584 - val_accuracy30: 0.4264 - 123s/epoch - 24ms/step
Epoch 8/50
5165/5165 - 119s - loss: 3.0529 - accuracy30: 0.4796 - val_loss: 3.1564 - val_accuracy30: 0.4271 - 119s/epoch - 23ms/step
Epoch 9/50
5165/5165 - 124s - loss: 3.0489 - accuracy30: 0.4805 - val_loss: 3.1507 - val_accuracy30: 0.4291 - 124s/epoch - 24ms/step
Epoch 10/50
5165/5165 - 109s - loss: 3.0451 - accuracy30: 0.4817 - val_loss: 3.1544 - val_accuracy30: 0.4292 - 109s/epoch - 21ms/step
Epoch 11/50
5165/5165 - 121s - loss: 3.0417 - accuracy30: 0.4829 - val_loss: 3.1505 - val_accuracy30: 0.4325 - 121s/epoch - 23ms/step
Epoch 12/50
5165/5165 - 117s - loss: 3.0386 - accuracy30: 0.4837 - val_loss: 3.1467 - val_accuracy30: 0.4340 - 117s/epoch - 23ms/step
Epoch 13/50
5165/5165 - 122s - loss: 3.0358 - accuracy30: 0.4843 - val_loss: 3.1484 - val_accuracy30: 0.4323 - 122s/epoch - 24ms/step
Epoch 14/50
5165/5165 - 123s - loss: 3.0333 - accuracy30: 0.4852 - val_loss: 3.1511 - val_accuracy30: 0.4313 - 123s/epoch - 24ms/step
Epoch 15/50
5165/5165 - 127s - loss: 3.0307 - accuracy30: 0.4859 - val_loss: 3.1564 - val_accuracy30: 0.4325 - 127s/epoch - 25ms/step
Epoch 16/50
5165/5165 - 127s - loss: 3.0285 - accuracy30: 0.4868 - val_loss: 3.1512 - val_accuracy30: 0.4321 - 127s/epoch - 25ms/step
Epoch 17/50
5165/5165 - 125s - loss: 3.0261 - accuracy30: 0.4872 - val_loss: 3.1515 - val_accuracy30: 0.4331 - 125s/epoch - 24ms/step
Epoch 18/50
5165/5165 - 126s - loss: 3.0242 - accuracy30: 0.4877 - val_loss: 3.1497 - val_accuracy30: 0.4333 - 126s/epoch - 24ms/step
Epoch 19/50
5165/5165 - 126s - loss: 3.0225 - accuracy30: 0.4883 - val_loss: 3.1496 - val_accuracy30: 0.4340 - 126s/epoch - 24ms/step
Epoch 20/50
5165/5165 - 126s - loss: 3.0205 - accuracy30: 0.4885 - val_loss: 3.1474 - val_accuracy30: 0.4358 - 126s/epoch - 24ms/step
Epoch 21/50
5165/5165 - 127s - loss: 3.0189 - accuracy30: 0.4891 - val_loss: 3.1554 - val_accuracy30: 0.4345 - 127s/epoch - 25ms/step
Epoch 22/50
5165/5165 - 126s - loss: 3.0173 - accuracy30: 0.4895 - val_loss: 3.1480 - val_accuracy30: 0.4378 - 126s/epoch - 24ms/step
testing model: results/AAPL/W4/deepVOL_L2/h30
Evaluating performance on  test set...
12724/12724 - 110s - 110s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0216769
{'0': {'precision': 0.4906434999358516, 'recall': 0.38910287689863887, 'f1-score': 0.43401326196668993, 'support': 963190}, '1': {'precision': 0.4422864586277833, 'recall': 0.5750833350835451, 'f1-score': 0.5000179349970489, 'support': 1333172}, '2': {'precision': 0.4800213204182487, 'recall': 0.37962395332982923, 'f1-score': 0.42395996791854096, 'support': 960785}, 'accuracy': 0.4624298504181727, 'macro avg': {'precision': 0.4709837596606279, 'recall': 0.4479367217706711, 'f1-score': 0.4526637216274267, 'support': 3257147}, 'weighted avg': {'precision': 0.4677173365718462, 'recall': 0.4624298504181727, 'f1-score': 0.4580639197451626, 'support': 3257147}}
[[374780 479194 109216]
 [280605 766685 285882]
 [108469 487579 364737]]
Evaluating performance on  train set...
5165/5165 - 53s - 53s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0500753
{'0': {'precision': 0.5240120475508432, 'recall': 0.3757272586310346, 'f1-score': 0.4376503477466488, 'support': 444993}, '1': {'precision': 0.35284426506665517, 'recall': 0.5687814427298726, 'f1-score': 0.4355157813976288, 'support': 431141}, '2': {'precision': 0.5307267285205072, 'recall': 0.3665823556847128, 'f1-score': 0.4336411116091914, 'support': 445968}, 'accuracy': 0.4355980098358523, 'macro avg': {'precision': 0.4691943470460019, 'recall': 0.43703035234854, 'f1-score': 0.43560241358448964, 'support': 1322102}, 'weighted avg': {'precision': 0.47045875433644957, 'recall': 0.4355980098358523, 'f1-score': 0.43560187486631696, 'support': 1322102}}
[[167196 222854  54943]
 [ 96305 245225  89611]
 [ 55568 226916 163484]]
Evaluating performance on  val set...
1903/1903 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0501764
{'0': {'precision': 0.5380424149939351, 'recall': 0.33715213926688736, 'f1-score': 0.41454131620994245, 'support': 163140}, '1': {'precision': 0.3589679215784729, 'recall': 0.5818504679812068, 'f1-score': 0.444008440903092, 'support': 162186}, '2': {'precision': 0.5081675349714895, 'recall': 0.3831042715588159, 'f1-score': 0.4368614644571323, 'support': 161674}, 'accuracy': 0.4338993839835729, 'macro avg': {'precision': 0.46839262384796587, 'recall': 0.43403562626897, 'f1-score': 0.43180374052338893, 'support': 487000}, 'weighted avg': {'precision': 0.4684872463248817, 'recall': 0.4338993839835729, 'f1-score': 0.4317646072432059, 'support': 487000}}
[[55003 85590 22547]
 [30418 94368 37400]
 [16807 82929 61938]]
training model: results/AAPL/W4/deepVOL_L2/h50
Epoch 1/50
5165/5165 - 119s - loss: 3.1628 - accuracy50: 0.4424 - val_loss: 3.2466 - val_accuracy50: 0.3910 - 119s/epoch - 23ms/step
Epoch 2/50
5165/5165 - 114s - loss: 3.1399 - accuracy50: 0.4511 - val_loss: 3.2594 - val_accuracy50: 0.3880 - 114s/epoch - 22ms/step
Epoch 3/50
5165/5165 - 118s - loss: 3.1167 - accuracy50: 0.4600 - val_loss: 3.2690 - val_accuracy50: 0.3878 - 118s/epoch - 23ms/step
Epoch 4/50
5165/5165 - 118s - loss: 3.0989 - accuracy50: 0.4675 - val_loss: 3.2792 - val_accuracy50: 0.3898 - 118s/epoch - 23ms/step
Epoch 5/50
5165/5165 - 117s - loss: 3.0888 - accuracy50: 0.4717 - val_loss: 3.2907 - val_accuracy50: 0.3895 - 117s/epoch - 23ms/step
Epoch 6/50
5165/5165 - 118s - loss: 3.0804 - accuracy50: 0.4747 - val_loss: 3.2819 - val_accuracy50: 0.3917 - 118s/epoch - 23ms/step
Epoch 7/50
5165/5165 - 118s - loss: 3.0749 - accuracy50: 0.4760 - val_loss: 3.2857 - val_accuracy50: 0.3907 - 118s/epoch - 23ms/step
Epoch 8/50
5165/5165 - 118s - loss: 3.0707 - accuracy50: 0.4774 - val_loss: 3.2985 - val_accuracy50: 0.3903 - 118s/epoch - 23ms/step
Epoch 9/50
5165/5165 - 124s - loss: 3.0674 - accuracy50: 0.4787 - val_loss: 3.2961 - val_accuracy50: 0.3903 - 124s/epoch - 24ms/step
Epoch 10/50
5165/5165 - 114s - loss: 3.0643 - accuracy50: 0.4794 - val_loss: 3.2895 - val_accuracy50: 0.3918 - 114s/epoch - 22ms/step
Epoch 11/50
5165/5165 - 124s - loss: 3.0618 - accuracy50: 0.4801 - val_loss: 3.2843 - val_accuracy50: 0.3919 - 124s/epoch - 24ms/step
testing model: results/AAPL/W4/deepVOL_L2/h50
Evaluating performance on  test set...
12724/12724 - 108s - 108s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0577047
{'0': {'precision': 0.36701551897018553, 'recall': 0.40900734247174525, 'f1-score': 0.38687530875304443, 'support': 877906}, '1': {'precision': 0.47331114249505263, 'recall': 0.5720128261109039, 'f1-score': 0.5180021742148218, 'support': 1506926}, '2': {'precision': 0.3807929654039124, 'recall': 0.1997672859001622, 'f1-score': 0.2620571319436455, 'support': 872315}, 'accuracy': 0.4283844112654418, 'macro avg': {'precision': 0.4070398756230502, 'recall': 0.39359581816093714, 'f1-score': 0.3889782049705039, 'support': 3257147}, 'weighted avg': {'precision': 0.41988323171439706, 'recall': 0.4283844112654418, 'f1-score': 0.41411316905206175, 'support': 3257147}}
[[359070 442216  76620]
 [438201 861981 206744]
 [181080 516975 174260]]
Evaluating performance on  train set...
5165/5165 - 50s - 50s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.087574
{'0': {'precision': 0.43271360075309273, 'recall': 0.34662514678459405, 'f1-score': 0.38491455955608805, 'support': 440271}, '1': {'precision': 0.33638401914907823, 'recall': 0.5947826837231902, 'f1-score': 0.4297305499733421, 'support': 440418}, '2': {'precision': 0.45313098153557324, 'recall': 0.19575318352653864, 'f1-score': 0.2733980484224115, 'support': 441413}, 'accuracy': 0.3789193269505681, 'macro avg': {'precision': 0.4074095338125814, 'recall': 0.3790536713447743, 'f1-score': 0.3626810526506139, 'support': 1322102}, 'weighted avg': {'precision': 0.4074411298185205, 'recall': 0.3789193269505681, 'f1-score': 0.3626113871371194, 'support': 1322102}}
[[152609 244441  43221]
 [117403 261953  61062]
 [ 82667 272338  86408]]
Evaluating performance on  val set...
1903/1903 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0822215
{'0': {'precision': 0.43995596740866394, 'recall': 0.3089845631289448, 'f1-score': 0.36301841559611514, 'support': 157804}, '1': {'precision': 0.36203759854457246, 'recall': 0.617301993495578, 'f1-score': 0.4564025249634837, 'support': 173113}, '2': {'precision': 0.42782894249524706, 'recall': 0.22202930492109968, 'f1-score': 0.29234240884071117, 'support': 156083}, 'accuracy': 0.39071252566735115, 'macro avg': {'precision': 0.4099408361494945, 'recall': 0.38277195384854085, 'f1-score': 0.3705877831334367, 'support': 487000}, 'weighted avg': {'precision': 0.4083717681915585, 'recall': 0.39071252566735115, 'f1-score': 0.3735619066895639, 'support': 487000}}
[[ 48759  91023  18022]
 [ 37925 106863  28325]
 [ 24143  97285  34655]]
training model: results/AAPL/W4/deepVOL_L2/h100
Epoch 1/50
5165/5165 - 121s - loss: 3.2441 - accuracy100: 0.4008 - val_loss: 3.2849 - val_accuracy100: 0.3672 - 121s/epoch - 23ms/step
Epoch 2/50
5165/5165 - 120s - loss: 3.2320 - accuracy100: 0.4066 - val_loss: 3.2888 - val_accuracy100: 0.3688 - 120s/epoch - 23ms/step
Epoch 3/50
5165/5165 - 120s - loss: 3.2244 - accuracy100: 0.4105 - val_loss: 3.3131 - val_accuracy100: 0.3666 - 120s/epoch - 23ms/step
Epoch 4/50
5165/5165 - 118s - loss: 3.2148 - accuracy100: 0.4160 - val_loss: 3.2985 - val_accuracy100: 0.3697 - 118s/epoch - 23ms/step
Epoch 5/50
5165/5165 - 111s - loss: 3.2060 - accuracy100: 0.4207 - val_loss: 3.3029 - val_accuracy100: 0.3709 - 111s/epoch - 22ms/step
Epoch 6/50
5165/5165 - 112s - loss: 3.1999 - accuracy100: 0.4233 - val_loss: 3.2986 - val_accuracy100: 0.3691 - 112s/epoch - 22ms/step
Epoch 7/50
5165/5165 - 120s - loss: 3.1955 - accuracy100: 0.4248 - val_loss: 3.3024 - val_accuracy100: 0.3705 - 120s/epoch - 23ms/step
Epoch 8/50
5165/5165 - 114s - loss: 3.1926 - accuracy100: 0.4264 - val_loss: 3.3014 - val_accuracy100: 0.3708 - 114s/epoch - 22ms/step
Epoch 9/50
5165/5165 - 111s - loss: 3.1897 - accuracy100: 0.4277 - val_loss: 3.3073 - val_accuracy100: 0.3703 - 111s/epoch - 21ms/step
Epoch 10/50
5165/5165 - 121s - loss: 3.1877 - accuracy100: 0.4287 - val_loss: 3.2935 - val_accuracy100: 0.3715 - 121s/epoch - 23ms/step
Epoch 11/50
5165/5165 - 114s - loss: 3.1855 - accuracy100: 0.4299 - val_loss: 3.2932 - val_accuracy100: 0.3722 - 114s/epoch - 22ms/step
testing model: results/AAPL/W4/deepVOL_L2/h100
Evaluating performance on  test set...
12724/12724 - 137s - 137s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0889016
{'0': {'precision': 0.33895498041969047, 'recall': 0.4784892432865997, 'f1-score': 0.3968131583434269, 'support': 936299}, '1': {'precision': 0.4330893412729483, 'recall': 0.12215858320365794, 'f1-score': 0.19056561221864735, 'support': 1376514}, '2': {'precision': 0.3303978225727743, 'recall': 0.5413063598260784, 'f1-score': 0.4103374659489677, 'support': 944334}, 'accuracy': 0.3461114895950352, 'macro avg': {'precision': 0.3674807147551376, 'recall': 0.3806513954387787, 'f1-score': 0.33257207883701395, 'support': 3257147}, 'weighted avg': {'precision': 0.37625647479416957, 'recall': 0.3461114895950352, 'f1-score': 0.3135712379732274, 'support': 3257147}}
[[448009 108372 379918]
 [552306 168153 656055]
 [321421 111739 511174]]
Evaluating performance on  train set...
5165/5165 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0955355
{'0': {'precision': 0.3787454657977443, 'recall': 0.38933438985736923, 'f1-score': 0.38396693716655, 'support': 441700}, '1': {'precision': 0.33819238158938747, 'recall': 0.11816567572831105, 'f1-score': 0.1751376168597208, 'support': 436455}, '2': {'precision': 0.3751778342375278, 'recall': 0.6047118237086859, 'f1-score': 0.46306126514767987, 'support': 443947}, 'accuracy': 0.3721369455609325, 'macro avg': {'precision': 0.3640385605415532, 'recall': 0.3707372964314554, 'f1-score': 0.3407219397246502, 'support': 1322102}, 'weighted avg': {'precision': 0.3641600285951519, 'recall': 0.3721369455609325, 'f1-score': 0.34158676425229795, 'support': 1322102}}
[[171969  50672 219059]
 [156846  51574 228035]
 [125234  50253 268460]]
Evaluating performance on  val set...
1903/1903 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.094635
{'0': {'precision': 0.38713850380417025, 'recall': 0.3617636429345862, 'f1-score': 0.37402118839244586, 'support': 160486}, '1': {'precision': 0.3480099360979957, 'recall': 0.10973327513736839, 'f1-score': 0.16685455570303834, 'support': 167251}, '2': {'precision': 0.3600050651433717, 'recall': 0.6426351381048957, 'f1-score': 0.4614853942767478, 'support': 159263}, 'accuracy': 0.36706160164271046, 'macro avg': {'precision': 0.36505116834851253, 'recall': 0.3713773520589501, 'f1-score': 0.33412037945741063, 'support': 487000}, 'weighted avg': {'precision': 0.36482711793382083, 'recall': 0.36706160164271046, 'f1-score': 0.3314770104413483, 'support': 487000}}
[[ 58058  17748  84680]
 [ 51630  18353  97268]
 [ 40279  16636 102348]]
training model: results/AAPL/W4/deepVOL_L2/h200
Epoch 1/50
5165/5165 - 120s - loss: 3.2478 - accuracy200: 0.3954 - val_loss: 3.3101 - val_accuracy200: 0.3513 - 120s/epoch - 23ms/step
Epoch 2/50
5165/5165 - 124s - loss: 3.2435 - accuracy200: 0.3970 - val_loss: 3.2997 - val_accuracy200: 0.3520 - 124s/epoch - 24ms/step
Epoch 3/50
5165/5165 - 131s - loss: 3.2380 - accuracy200: 0.4014 - val_loss: 3.2906 - val_accuracy200: 0.3520 - 131s/epoch - 25ms/step
Epoch 4/50
5165/5165 - 120s - loss: 3.2295 - accuracy200: 0.4065 - val_loss: 3.2840 - val_accuracy200: 0.3600 - 120s/epoch - 23ms/step
Epoch 5/50
5165/5165 - 123s - loss: 3.2206 - accuracy200: 0.4106 - val_loss: 3.2838 - val_accuracy200: 0.3642 - 123s/epoch - 24ms/step
Epoch 6/50
5165/5165 - 114s - loss: 3.2138 - accuracy200: 0.4140 - val_loss: 3.2847 - val_accuracy200: 0.3659 - 114s/epoch - 22ms/step
Epoch 7/50
5165/5165 - 119s - loss: 3.2097 - accuracy200: 0.4163 - val_loss: 3.2822 - val_accuracy200: 0.3724 - 119s/epoch - 23ms/step
Epoch 8/50
5165/5165 - 113s - loss: 3.2062 - accuracy200: 0.4180 - val_loss: 3.2859 - val_accuracy200: 0.3626 - 113s/epoch - 22ms/step
Epoch 9/50
5165/5165 - 126s - loss: 3.2032 - accuracy200: 0.4195 - val_loss: 3.2898 - val_accuracy200: 0.3627 - 126s/epoch - 24ms/step
Epoch 10/50
5165/5165 - 112s - loss: 3.2007 - accuracy200: 0.4207 - val_loss: 3.2912 - val_accuracy200: 0.3592 - 112s/epoch - 22ms/step
Epoch 11/50
5165/5165 - 111s - loss: 3.1989 - accuracy200: 0.4218 - val_loss: 3.2926 - val_accuracy200: 0.3596 - 111s/epoch - 21ms/step
Epoch 12/50
5165/5165 - 123s - loss: 3.1970 - accuracy200: 0.4227 - val_loss: 3.2961 - val_accuracy200: 0.3577 - 123s/epoch - 24ms/step
Epoch 13/50
5165/5165 - 125s - loss: 3.1949 - accuracy200: 0.4232 - val_loss: 3.2971 - val_accuracy200: 0.3584 - 125s/epoch - 24ms/step
Epoch 14/50
5165/5165 - 121s - loss: 3.1933 - accuracy200: 0.4241 - val_loss: 3.2984 - val_accuracy200: 0.3594 - 121s/epoch - 23ms/step
Epoch 15/50
5165/5165 - 120s - loss: 3.1922 - accuracy200: 0.4244 - val_loss: 3.3042 - val_accuracy200: 0.3589 - 120s/epoch - 23ms/step
Epoch 16/50
5165/5165 - 124s - loss: 3.1911 - accuracy200: 0.4248 - val_loss: 3.3040 - val_accuracy200: 0.3595 - 124s/epoch - 24ms/step
Epoch 17/50
5165/5165 - 125s - loss: 3.1896 - accuracy200: 0.4260 - val_loss: 3.3025 - val_accuracy200: 0.3611 - 125s/epoch - 24ms/step
testing model: results/AAPL/W4/deepVOL_L2/h200
Evaluating performance on  test set...
12724/12724 - 130s - 130s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0822017
{'0': {'precision': 0.3189559599089503, 'recall': 0.2563529642654924, 'f1-score': 0.2842483485203593, 'support': 886594}, '1': {'precision': 0.46657343973957194, 'recall': 0.42136722309334107, 'f1-score': 0.44281957770677394, 'support': 1458533}, '2': {'precision': 0.32588342555075844, 'recall': 0.4385583649481371, 'f1-score': 0.3739170308309958, 'support': 912020}, 'accuracy': 0.38126403260276553, 'macro avg': {'precision': 0.37047094173309353, 'recall': 0.3720928507689902, 'f1-score': 0.36699498568604305, 'support': 3257147}, 'weighted avg': {'precision': 0.3869980080340236, 'recall': 0.38126403260276553, 'f1-score': 0.38036344626077306, 'support': 3257147}}
[[227281 351457 307856]
 [324432 614578 519523]
 [160865 351181 399974]]
Evaluating performance on  train set...
5165/5165 - 51s - 51s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.095337
{'0': {'precision': 0.3847293172952947, 'recall': 0.21539083576423074, 'f1-score': 0.27616859314843206, 'support': 437767}, '1': {'precision': 0.3633486672539232, 'recall': 0.4031848964048864, 'f1-score': 0.38223165093090034, 'support': 441961}, '2': {'precision': 0.3720580563993986, 'recall': 0.49336082138642867, 'f1-score': 0.4242081447963801, 'support': 442374}, 'accuracy': 0.3711763540180712, 'macro avg': {'precision': 0.3733786803162055, 'recall': 0.3706455178518486, 'f1-score': 0.36086946295857086, 'support': 1322102}, 'weighted avg': {'precision': 0.3733422610466121, 'recall': 0.3711763540180712, 'f1-score': 0.36115793867646756, 'support': 1322102}}
[[ 94291 157372 186104]
 [ 81521 178192 182248]
 [ 69272 154852 218250]]
Evaluating performance on  val set...
1903/1903 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0936795
{'0': {'precision': 0.39916351861845656, 'recall': 0.1857320426381408, 'f1-score': 0.25350664484563906, 'support': 159294}, '1': {'precision': 0.3778295105885382, 'recall': 0.4156418910944839, 'f1-score': 0.395834738238137, 'support': 169468}, '2': {'precision': 0.3604958225142635, 'recall': 0.5159000998495936, 'f1-score': 0.4244196625854584, 'support': 158238}, 'accuracy': 0.37301642710472277, 'macro avg': {'precision': 0.37916295057375277, 'recall': 0.37242467786073946, 'f1-score': 0.35792034855641147, 'support': 487000}, 'weighted avg': {'precision': 0.37917557083827275, 'recall': 0.37301642710472277, 'f1-score': 0.35856822889523526, 'support': 487000}}
[[29586 59644 70064]
 [24277 70438 74753]
 [20257 56346 81635]]
training model: results/AAPL/W4/deepVOL_L2/h300
Epoch 1/50
5165/5165 - 126s - loss: 3.2596 - accuracy300: 0.3870 - val_loss: 3.3184 - val_accuracy300: 0.3458 - 126s/epoch - 24ms/step
Epoch 2/50
5165/5165 - 123s - loss: 3.2527 - accuracy300: 0.3904 - val_loss: 3.3083 - val_accuracy300: 0.3482 - 123s/epoch - 24ms/step
Epoch 3/50
5165/5165 - 115s - loss: 3.2447 - accuracy300: 0.3965 - val_loss: 3.3104 - val_accuracy300: 0.3475 - 115s/epoch - 22ms/step
Epoch 4/50
5165/5165 - 124s - loss: 3.2370 - accuracy300: 0.4009 - val_loss: 3.3144 - val_accuracy300: 0.3473 - 124s/epoch - 24ms/step
Epoch 5/50
5165/5165 - 124s - loss: 3.2315 - accuracy300: 0.4038 - val_loss: 3.3118 - val_accuracy300: 0.3489 - 124s/epoch - 24ms/step
Epoch 6/50
5165/5165 - 125s - loss: 3.2282 - accuracy300: 0.4061 - val_loss: 3.3152 - val_accuracy300: 0.3492 - 125s/epoch - 24ms/step
Epoch 7/50
5165/5165 - 118s - loss: 3.2263 - accuracy300: 0.4068 - val_loss: 3.3097 - val_accuracy300: 0.3497 - 118s/epoch - 23ms/step
Epoch 8/50
5165/5165 - 120s - loss: 3.2234 - accuracy300: 0.4083 - val_loss: 3.3130 - val_accuracy300: 0.3502 - 120s/epoch - 23ms/step
Epoch 9/50
5165/5165 - 118s - loss: 3.2219 - accuracy300: 0.4092 - val_loss: 3.3097 - val_accuracy300: 0.3508 - 118s/epoch - 23ms/step
Epoch 10/50
5165/5165 - 126s - loss: 3.2195 - accuracy300: 0.4105 - val_loss: 3.3100 - val_accuracy300: 0.3510 - 126s/epoch - 24ms/step
Epoch 11/50
5165/5165 - 124s - loss: 3.2180 - accuracy300: 0.4112 - val_loss: 3.3074 - val_accuracy300: 0.3505 - 124s/epoch - 24ms/step
Epoch 12/50
5165/5165 - 122s - loss: 3.2166 - accuracy300: 0.4118 - val_loss: 3.3064 - val_accuracy300: 0.3507 - 122s/epoch - 24ms/step
Epoch 13/50
5165/5165 - 114s - loss: 3.2150 - accuracy300: 0.4127 - val_loss: 3.3070 - val_accuracy300: 0.3504 - 114s/epoch - 22ms/step
Epoch 14/50
5165/5165 - 118s - loss: 3.2135 - accuracy300: 0.4131 - val_loss: 3.3064 - val_accuracy300: 0.3502 - 118s/epoch - 23ms/step
Epoch 15/50
5165/5165 - 117s - loss: 3.2118 - accuracy300: 0.4140 - val_loss: 3.3090 - val_accuracy300: 0.3495 - 117s/epoch - 23ms/step
Epoch 16/50
5165/5165 - 114s - loss: 3.2104 - accuracy300: 0.4147 - val_loss: 3.3101 - val_accuracy300: 0.3502 - 114s/epoch - 22ms/step
Epoch 17/50
5165/5165 - 122s - loss: 3.2095 - accuracy300: 0.4150 - val_loss: 3.3131 - val_accuracy300: 0.3497 - 122s/epoch - 24ms/step
Epoch 18/50
5165/5165 - 120s - loss: 3.2076 - accuracy300: 0.4157 - val_loss: 3.3133 - val_accuracy300: 0.3494 - 120s/epoch - 23ms/step
Epoch 19/50
5165/5165 - 121s - loss: 3.2058 - accuracy300: 0.4167 - val_loss: 3.3136 - val_accuracy300: 0.3499 - 121s/epoch - 23ms/step
Epoch 20/50
5165/5165 - 121s - loss: 3.2045 - accuracy300: 0.4174 - val_loss: 3.3159 - val_accuracy300: 0.3494 - 121s/epoch - 23ms/step
Epoch 21/50
5165/5165 - 126s - loss: 3.2026 - accuracy300: 0.4184 - val_loss: 3.3187 - val_accuracy300: 0.3498 - 126s/epoch - 24ms/step
Epoch 22/50
5165/5165 - 114s - loss: 3.2017 - accuracy300: 0.4187 - val_loss: 3.3213 - val_accuracy300: 0.3484 - 114s/epoch - 22ms/step
testing model: results/AAPL/W4/deepVOL_L2/h300
Evaluating performance on  test set...
12724/12724 - 142s - 142s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.108371
{'0': {'precision': 0.3033980949158482, 'recall': 0.4402103576716005, 'f1-score': 0.3592185737401395, 'support': 912541}, '1': {'precision': 0.44912254499290566, 'recall': 0.04276423851042619, 'f1-score': 0.07809270051003978, 'support': 1406362}, '2': {'precision': 0.31049893813976315, 'recall': 0.5954208073805961, 'f1-score': 0.4081543190822099, 'support': 938244}, 'accuracy': 0.313311619033467, 'macro avg': {'precision': 0.3543398593495057, 'recall': 0.3594651345208743, 'f1-score': 0.2818218644441297, 'support': 3257147}, 'weighted avg': {'precision': 0.36836404597947825, 'recall': 0.313311619033467, 'f1-score': 0.25193109918805323, 'support': 3257147}}
[[401710  37061 473770]
 [579439  60142 766781]
 [342887  36707 558650]]
Evaluating performance on  train set...
5165/5165 - 51s - 51s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0976567
{'0': {'precision': 0.3546816064652747, 'recall': 0.35469523357515764, 'f1-score': 0.3546884198893279, 'support': 442470}, '1': {'precision': 0.36881219903691814, 'recall': 0.05307238697547218, 'f1-score': 0.09279193598216612, 'support': 432937}, '2': {'precision': 0.36009494503343265, 'recall': 0.6588634303047941, 'f1-score': 0.4656782778617258, 'support': 446695}, 'accuracy': 0.3586939585599296, 'macro avg': {'precision': 0.3611962501785418, 'recall': 0.35554368361847466, 'f1-score': 0.3043862112444066, 'support': 1322102}, 'weighted avg': {'precision': 0.3611378160677811, 'recall': 0.3586939585599296, 'f1-score': 0.3064273451414381, 'support': 1322102}}
[[156942  20111 265417]
 [152373  22977 257587]
 [133172  19212 294311]]
Evaluating performance on  val set...
1903/1903 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011449
{'0': {'precision': 0.3566566045591756, 'recall': 0.318154806120933, 'f1-score': 0.33630733292109577, 'support': 161544}, '1': {'precision': 0.34380532982249057, 'recall': 0.04598978544577845, 'f1-score': 0.08112740634407105, 'support': 164667}, '2': {'precision': 0.34761023224503534, 'recall': 0.6936855133124779, 'f1-score': 0.46313870658995926, 'support': 160789}, 'accuracy': 0.35011498973305955, 'macro avg': {'precision': 0.34935738887556717, 'recall': 0.3526100349597298, 'f1-score': 0.2935244819517087, 'support': 487000}, 'weighted avg': {'precision': 0.34932449364524537, 'recall': 0.35011498973305955, 'f1-score': 0.2918994823485782, 'support': 487000}}
[[ 51396   7575 102573]
 [ 50336   7573 106758]
 [ 42373   6879 111537]]
training model: results/AAPL/W4/deepVOL_L2/h500
Epoch 1/50
5165/5165 - 116s - loss: 3.2625 - accuracy500: 0.3823 - val_loss: 3.3184 - val_accuracy500: 0.3418 - 116s/epoch - 22ms/step
Epoch 2/50
5165/5165 - 127s - loss: 3.2607 - accuracy500: 0.3831 - val_loss: 3.3083 - val_accuracy500: 0.3414 - 127s/epoch - 25ms/step
Epoch 3/50
5165/5165 - 124s - loss: 3.2576 - accuracy500: 0.3870 - val_loss: 3.3015 - val_accuracy500: 0.3439 - 124s/epoch - 24ms/step
Epoch 4/50
5165/5165 - 119s - loss: 3.2491 - accuracy500: 0.3945 - val_loss: 3.3041 - val_accuracy500: 0.3444 - 119s/epoch - 23ms/step
Epoch 5/50
5165/5165 - 117s - loss: 3.2444 - accuracy500: 0.3971 - val_loss: 3.3013 - val_accuracy500: 0.3467 - 117s/epoch - 23ms/step
Epoch 6/50
5165/5165 - 124s - loss: 3.2379 - accuracy500: 0.4013 - val_loss: 3.3024 - val_accuracy500: 0.3482 - 124s/epoch - 24ms/step
Epoch 7/50
5165/5165 - 125s - loss: 3.2334 - accuracy500: 0.4041 - val_loss: 3.2999 - val_accuracy500: 0.3474 - 125s/epoch - 24ms/step
Epoch 8/50
5165/5165 - 126s - loss: 3.2292 - accuracy500: 0.4065 - val_loss: 3.3028 - val_accuracy500: 0.3461 - 126s/epoch - 24ms/step
Epoch 9/50
5165/5165 - 122s - loss: 3.2264 - accuracy500: 0.4078 - val_loss: 3.3034 - val_accuracy500: 0.3464 - 122s/epoch - 24ms/step
Epoch 10/50
5165/5165 - 119s - loss: 3.2239 - accuracy500: 0.4089 - val_loss: 3.3060 - val_accuracy500: 0.3435 - 119s/epoch - 23ms/step
Epoch 11/50
5165/5165 - 123s - loss: 3.2216 - accuracy500: 0.4102 - val_loss: 3.3098 - val_accuracy500: 0.3423 - 123s/epoch - 24ms/step
Epoch 12/50
5165/5165 - 126s - loss: 3.2195 - accuracy500: 0.4107 - val_loss: 3.3175 - val_accuracy500: 0.3434 - 126s/epoch - 24ms/step
Epoch 13/50
5165/5165 - 125s - loss: 3.2176 - accuracy500: 0.4123 - val_loss: 3.3196 - val_accuracy500: 0.3437 - 125s/epoch - 24ms/step
Epoch 14/50
5165/5165 - 113s - loss: 3.2159 - accuracy500: 0.4129 - val_loss: 3.3213 - val_accuracy500: 0.3439 - 113s/epoch - 22ms/step
Epoch 15/50
5165/5165 - 118s - loss: 3.2137 - accuracy500: 0.4139 - val_loss: 3.3271 - val_accuracy500: 0.3431 - 118s/epoch - 23ms/step
Epoch 16/50
5165/5165 - 120s - loss: 3.2123 - accuracy500: 0.4145 - val_loss: 3.3236 - val_accuracy500: 0.3435 - 120s/epoch - 23ms/step
Epoch 17/50
5165/5165 - 112s - loss: 3.2105 - accuracy500: 0.4152 - val_loss: 3.3293 - val_accuracy500: 0.3430 - 112s/epoch - 22ms/step
testing model: results/AAPL/W4/deepVOL_L2/h500
Evaluating performance on  test set...
12724/12724 - 125s - 125s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1037197
{'0': {'precision': 0.29515947392704234, 'recall': 0.382226371981416, 'f1-score': 0.33309740838701524, 'support': 933923}, '1': {'precision': 0.4223713500065471, 'recall': 0.19040072013044987, 'f1-score': 0.26247870333168893, 'support': 1355310}, '2': {'precision': 0.3209275229977178, 'recall': 0.47638529869389223, 'f1-score': 0.3835010543991796, 'support': 967914}, 'accuracy': 0.33038791310309296, 'macro avg': {'precision': 0.3461527823104357, 'recall': 0.34967079693525277, 'f1-score': 0.32635905537262794, 'support': 3257147}, 'weighted avg': {'precision': 0.3557501636372419, 'recall': 0.33038791310309296, 'f1-score': 0.31869098383131783, 'support': 3257147}}
[[356970 177617 399336]
 [520921 258052 576337]
 [331523 175291 461100]]
Evaluating performance on  train set...
5165/5165 - 51s - 51s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0968156
{'0': {'precision': 0.3457246240744594, 'recall': 0.3092805970962382, 'f1-score': 0.3264887506499917, 'support': 440532}, '1': {'precision': 0.36917834646181324, 'recall': 0.19558297313312173, 'f1-score': 0.2557009345794392, 'support': 435406}, '2': {'precision': 0.3576395411700765, 'recall': 0.5589783129073614, 'f1-score': 0.43619649445607056, 'support': 446164}, 'accuracy': 0.3561011177654977, 'macro avg': {'precision': 0.35751417056878304, 'recall': 0.3546139610455738, 'f1-score': 0.3394620598951672, 'support': 1322102}, 'weighted avg': {'precision': 0.35746948076542356, 'recall': 0.3561011177654977, 'f1-score': 0.3401988925024966, 'support': 1322102}}
[[136248  74073 230211]
 [132516  85158 217732]
 [125330  71438 249396]]
Evaluating performance on  val set...
1903/1903 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995187
{'0': {'precision': 0.3465063213991066, 'recall': 0.28734321550741165, 'f1-score': 0.31416364543040826, 'support': 162245}, '1': {'precision': 0.3547928657713352, 'recall': 0.18231721418225635, 'f1-score': 0.24086253195902815, 'support': 164318}, '2': {'precision': 0.34561728832657385, 'recall': 0.5773730498575765, 'f1-score': 0.432399126164647, 'support': 160437}, 'accuracy': 0.34745379876796717, 'macro avg': {'precision': 0.34897215849900515, 'recall': 0.3490111598490815, 'f1-score': 0.3291417678513611, 'support': 487000}, 'weighted avg': {'precision': 0.3490093903910941, 'recall': 0.34745379876796717, 'f1-score': 0.32838264637326, 'support': 487000}}
[[46620 28162 87463]
 [46436 29958 87924]
 [41487 26318 92632]]
training model: results/AAPL/W4/deepVOL_L2/h1000
Epoch 1/50
5165/5165 - 115s - loss: 3.2553 - accuracy1000: 0.3833 - val_loss: 3.3423 - val_accuracy1000: 0.3176 - 115s/epoch - 22ms/step
Epoch 2/50
5165/5165 - 123s - loss: 3.2561 - accuracy1000: 0.3824 - val_loss: 3.3194 - val_accuracy1000: 0.3176 - 123s/epoch - 24ms/step
Epoch 3/50
5165/5165 - 124s - loss: 3.2468 - accuracy1000: 0.3890 - val_loss: 3.3134 - val_accuracy1000: 0.3203 - 124s/epoch - 24ms/step
Epoch 4/50
5165/5165 - 116s - loss: 3.2423 - accuracy1000: 0.3919 - val_loss: 3.3152 - val_accuracy1000: 0.3234 - 116s/epoch - 23ms/step
Epoch 5/50
5165/5165 - 119s - loss: 3.2362 - accuracy1000: 0.3972 - val_loss: 3.3145 - val_accuracy1000: 0.3259 - 119s/epoch - 23ms/step
Epoch 6/50
5165/5165 - 111s - loss: 3.2298 - accuracy1000: 0.4020 - val_loss: 3.3209 - val_accuracy1000: 0.3256 - 111s/epoch - 21ms/step
Epoch 7/50
5165/5165 - 121s - loss: 3.2215 - accuracy1000: 0.4077 - val_loss: 3.3328 - val_accuracy1000: 0.3254 - 121s/epoch - 23ms/step
Epoch 8/50
5165/5165 - 118s - loss: 3.2178 - accuracy1000: 0.4098 - val_loss: 3.3359 - val_accuracy1000: 0.3225 - 118s/epoch - 23ms/step
Epoch 9/50
5165/5165 - 124s - loss: 3.2151 - accuracy1000: 0.4116 - val_loss: 3.3449 - val_accuracy1000: 0.3218 - 124s/epoch - 24ms/step
Epoch 10/50
5165/5165 - 125s - loss: 3.2133 - accuracy1000: 0.4132 - val_loss: 3.3496 - val_accuracy1000: 0.3206 - 125s/epoch - 24ms/step
Epoch 11/50
5165/5165 - 125s - loss: 3.2106 - accuracy1000: 0.4140 - val_loss: 3.3489 - val_accuracy1000: 0.3214 - 125s/epoch - 24ms/step
Epoch 12/50
5165/5165 - 118s - loss: 3.2088 - accuracy1000: 0.4156 - val_loss: 3.3532 - val_accuracy1000: 0.3213 - 118s/epoch - 23ms/step
Epoch 13/50
5165/5165 - 109s - loss: 3.2066 - accuracy1000: 0.4162 - val_loss: 3.3630 - val_accuracy1000: 0.3207 - 109s/epoch - 21ms/step
testing model: results/AAPL/W4/deepVOL_L2/h1000
Evaluating performance on  test set...
12724/12724 - 125s - 125s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1101656
{'0': {'precision': 0.2754149099562075, 'recall': 0.13233798753801979, 'f1-score': 0.17877422892910497, 'support': 892956}, '1': {'precision': 0.4804004022843162, 'recall': 0.05611700190853593, 'f1-score': 0.1004948957151074, 'support': 1455566}, '2': {'precision': 0.28462906440024244, 'recall': 0.8326405282707388, 'f1-score': 0.42423725857759914, 'support': 908625}, 'accuracy': 0.293634889674921, 'macro avg': {'precision': 0.3468147922135887, 'recall': 0.3403651725724315, 'f1-score': 0.23450212774060386, 'support': 3257147}, 'weighted avg': {'precision': 0.36959000374465706, 'recall': 0.293634889674921, 'f1-score': 0.21226768482329625, 'support': 3257147}}
[[ 118172   46387  728397]
 [ 200790   81682 1173094]
 [ 110107   41960  756558]]
Evaluating performance on  train set...
5165/5165 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999227
{'0': {'precision': 0.3365397870873861, 'recall': 0.10008951613454298, 'f1-score': 0.1542915429680985, 'support': 439027}, '1': {'precision': 0.33184959167190164, 'recall': 0.042261730607468094, 'f1-score': 0.07497521304614936, 'support': 437488}, '2': {'precision': 0.33860472241567086, 'recall': 0.8631153960954875, 'f1-score': 0.48639436854845447, 'support': 445587}, 'accuracy': 0.3381161211464774, 'macro avg': {'precision': 0.33566470039165286, 'recall': 0.3351555476124995, 'f1-score': 0.2385537081875674, 'support': 1322102}, 'weighted avg': {'precision': 0.3356837291782346, 'recall': 0.3381161211464774, 'f1-score': 0.23997385734095353, 'support': 1322102}}
[[ 43942  18828 376257]
 [ 44032  18489 374967]
 [ 42596  18398 384593]]
Evaluating performance on  val set...
1903/1903 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1034727
{'0': {'precision': 0.338262700583295, 'recall': 0.08747081906883883, 'f1-score': 0.13899828937422923, 'support': 159779}, '1': {'precision': 0.35671598491441836, 'recall': 0.03548772533377972, 'f1-score': 0.06455338674282594, 'support': 173243}, '2': {'precision': 0.31713766898200013, 'recall': 0.8824442452817935, 'f1-score': 0.4665897470236562, 'support': 153978}, 'accuracy': 0.3203305954825462, 'macro avg': {'precision': 0.3373721181599045, 'recall': 0.3351342632281374, 'f1-score': 0.22338047438023712, 'support': 487000}, 'weighted avg': {'precision': 0.3381479412844708, 'recall': 0.3203305954825462, 'f1-score': 0.2160923739725275, 'support': 487000}}
[[ 13976   5715 140088]
 [ 14612   6148 152483]
 [ 12729   5372 135877]]
training model: results/AAPL/W4/deepVOL_L3/h10
Epoch 1/50
5165/5165 - 179s - loss: 3.1491 - accuracy10: 0.4370 - val_loss: 3.1979 - val_accuracy10: 0.4203 - 179s/epoch - 35ms/step
Epoch 2/50
5165/5165 - 171s - loss: 3.0393 - accuracy10: 0.4794 - val_loss: 3.0889 - val_accuracy10: 0.4676 - 171s/epoch - 33ms/step
Epoch 3/50
5165/5165 - 172s - loss: 2.9809 - accuracy10: 0.4993 - val_loss: 3.0807 - val_accuracy10: 0.4666 - 172s/epoch - 33ms/step
Epoch 4/50
5165/5165 - 173s - loss: 2.9529 - accuracy10: 0.5074 - val_loss: 3.0320 - val_accuracy10: 0.4846 - 173s/epoch - 34ms/step
Epoch 5/50
5165/5165 - 169s - loss: 2.9307 - accuracy10: 0.5135 - val_loss: 2.9990 - val_accuracy10: 0.4969 - 169s/epoch - 33ms/step
Epoch 6/50
5165/5165 - 169s - loss: 2.9143 - accuracy10: 0.5179 - val_loss: 2.9660 - val_accuracy10: 0.5063 - 169s/epoch - 33ms/step
Epoch 7/50
5165/5165 - 168s - loss: 2.9018 - accuracy10: 0.5208 - val_loss: 2.9582 - val_accuracy10: 0.5078 - 168s/epoch - 33ms/step
Epoch 8/50
5165/5165 - 168s - loss: 2.8920 - accuracy10: 0.5232 - val_loss: 2.9495 - val_accuracy10: 0.5095 - 168s/epoch - 32ms/step
Epoch 9/50
5165/5165 - 167s - loss: 2.8839 - accuracy10: 0.5254 - val_loss: 2.9333 - val_accuracy10: 0.5152 - 167s/epoch - 32ms/step
Epoch 10/50
5165/5165 - 167s - loss: 2.8771 - accuracy10: 0.5268 - val_loss: 2.9267 - val_accuracy10: 0.5161 - 167s/epoch - 32ms/step
Epoch 11/50
5165/5165 - 167s - loss: 2.8709 - accuracy10: 0.5285 - val_loss: 2.9281 - val_accuracy10: 0.5160 - 167s/epoch - 32ms/step
Epoch 12/50
5165/5165 - 168s - loss: 2.8666 - accuracy10: 0.5294 - val_loss: 2.9267 - val_accuracy10: 0.5157 - 168s/epoch - 33ms/step
Epoch 13/50
5165/5165 - 169s - loss: 2.8613 - accuracy10: 0.5309 - val_loss: 2.9161 - val_accuracy10: 0.5182 - 169s/epoch - 33ms/step
Epoch 14/50
5165/5165 - 171s - loss: 2.8570 - accuracy10: 0.5320 - val_loss: 2.9219 - val_accuracy10: 0.5154 - 171s/epoch - 33ms/step
Epoch 15/50
5165/5165 - 170s - loss: 2.8528 - accuracy10: 0.5332 - val_loss: 2.9176 - val_accuracy10: 0.5169 - 170s/epoch - 33ms/step
Epoch 16/50
5165/5165 - 166s - loss: 2.8493 - accuracy10: 0.5339 - val_loss: 2.9088 - val_accuracy10: 0.5192 - 166s/epoch - 32ms/step
Epoch 17/50
5165/5165 - 169s - loss: 2.8459 - accuracy10: 0.5349 - val_loss: 2.9080 - val_accuracy10: 0.5192 - 169s/epoch - 33ms/step
Epoch 18/50
5165/5165 - 169s - loss: 2.8427 - accuracy10: 0.5353 - val_loss: 2.9020 - val_accuracy10: 0.5207 - 169s/epoch - 33ms/step
Epoch 19/50
5165/5165 - 169s - loss: 2.8397 - accuracy10: 0.5362 - val_loss: 2.9029 - val_accuracy10: 0.5204 - 169s/epoch - 33ms/step
Epoch 20/50
5165/5165 - 171s - loss: 2.8364 - accuracy10: 0.5371 - val_loss: 2.8992 - val_accuracy10: 0.5211 - 171s/epoch - 33ms/step
Epoch 21/50
5165/5165 - 169s - loss: 2.8339 - accuracy10: 0.5376 - val_loss: 2.8908 - val_accuracy10: 0.5229 - 169s/epoch - 33ms/step
Epoch 22/50
5165/5165 - 170s - loss: 2.8313 - accuracy10: 0.5385 - val_loss: 2.9032 - val_accuracy10: 0.5188 - 170s/epoch - 33ms/step
Epoch 23/50
5165/5165 - 171s - loss: 2.8289 - accuracy10: 0.5391 - val_loss: 2.8930 - val_accuracy10: 0.5220 - 171s/epoch - 33ms/step
Epoch 24/50
5165/5165 - 168s - loss: 2.8268 - accuracy10: 0.5397 - val_loss: 2.8958 - val_accuracy10: 0.5214 - 168s/epoch - 33ms/step
Epoch 25/50
5165/5165 - 168s - loss: 2.8243 - accuracy10: 0.5400 - val_loss: 2.8949 - val_accuracy10: 0.5203 - 168s/epoch - 32ms/step
Epoch 26/50
5165/5165 - 170s - loss: 2.8221 - accuracy10: 0.5407 - val_loss: 2.8983 - val_accuracy10: 0.5194 - 170s/epoch - 33ms/step
Epoch 27/50
5165/5165 - 168s - loss: 2.8200 - accuracy10: 0.5412 - val_loss: 2.8947 - val_accuracy10: 0.5217 - 168s/epoch - 33ms/step
Epoch 28/50
5165/5165 - 169s - loss: 2.8177 - accuracy10: 0.5417 - val_loss: 2.8914 - val_accuracy10: 0.5217 - 169s/epoch - 33ms/step
Epoch 29/50
5165/5165 - 168s - loss: 2.8160 - accuracy10: 0.5421 - val_loss: 2.8963 - val_accuracy10: 0.5206 - 168s/epoch - 32ms/step
Epoch 30/50
5165/5165 - 168s - loss: 2.8139 - accuracy10: 0.5426 - val_loss: 2.8920 - val_accuracy10: 0.5213 - 168s/epoch - 32ms/step
Epoch 31/50
5165/5165 - 167s - loss: 2.8121 - accuracy10: 0.5433 - val_loss: 2.8925 - val_accuracy10: 0.5219 - 167s/epoch - 32ms/step
testing model: results/AAPL/W4/deepVOL_L3/h10
Evaluating performance on  test set...
12724/12724 - 168s - 168s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9320868
{'0': {'precision': 0.562082030652834, 'recall': 0.4095517556945133, 'f1-score': 0.473844540469512, 'support': 915706}, '1': {'precision': 0.5419904447059087, 'recall': 0.649152630880705, 'f1-score': 0.5907510697986849, 'support': 1417092}, '2': {'precision': 0.5089228301223094, 'recall': 0.4914723767754387, 'f1-score': 0.5000454044379673, 'support': 924349}, 'accuracy': 0.5370436151638228, 'macro avg': {'precision': 0.5376651018270174, 'recall': 0.5167255877835523, 'f1-score': 0.5215470049020547, 'support': 3257147}, 'weighted avg': {'precision': 0.5382546505671669, 'recall': 0.5370436151638228, 'f1-score': 0.53214281496204, 'support': 3257147}}
[[375029 401302 139375]
 [198196 919909 298987]
 [ 93989 376068 454292]]
Evaluating performance on  train set...
5165/5165 - 72s - 72s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9616834
{'0': {'precision': 0.5573428995290992, 'recall': 0.4917552785144679, 'f1-score': 0.5224988824155815, 'support': 438523}, '1': {'precision': 0.48637172817683727, 'recall': 0.5234171031164887, 'f1-score': 0.504214887530541, 'support': 443159}, '2': {'precision': 0.5379786196377253, 'recall': 0.5597838426956088, 'f1-score': 0.5486646689462784, 'support': 440420}, 'accuracy': 0.5250298388475322, 'macro avg': {'precision': 0.5272310824478873, 'recall': 0.5249854081088551, 'f1-score': 0.5251261462974669, 'support': 1322102}, 'weighted avg': {'precision': 0.5271032285543514, 'recall': 0.5250298388475322, 'f1-score': 0.5250865941160326, 'support': 1322102}}
[[215646 127232  95645]
 [ 95116 231957 116086]
 [ 76156 117724 246540]]
Evaluating performance on  val set...
1903/1903 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96325076
{'0': {'precision': 0.5741752589104044, 'recall': 0.45958326725305293, 'f1-score': 0.5105280097572543, 'support': 163942}, '1': {'precision': 0.4724178112073869, 'recall': 0.5463417126507255, 'f1-score': 0.5066977044480576, 'support': 156576}, '2': {'precision': 0.537309673726388, 'recall': 0.5638327266611406, 'f1-score': 0.5502517717816297, 'support': 166482}, 'accuracy': 0.5231149897330596, 'macro avg': {'precision': 0.5279675812813931, 'recall': 0.5232525688549731, 'f1-score': 0.5224924953289806, 'support': 487000}, 'weighted avg': {'precision': 0.5288565104829854, 'recall': 0.5231149897330596, 'f1-score': 0.5228761770370269, 'support': 487000}}
[[75345 49929 38668]
 [28868 85544 42164]
 [27010 45604 93868]]
training model: results/AAPL/W4/deepVOL_L3/h20
Epoch 1/50
5165/5165 - 180s - loss: 3.1586 - accuracy20: 0.4389 - val_loss: 3.2003 - val_accuracy20: 0.3947 - 180s/epoch - 35ms/step
Epoch 2/50
5165/5165 - 179s - loss: 3.0831 - accuracy20: 0.4673 - val_loss: 3.1787 - val_accuracy20: 0.4136 - 179s/epoch - 35ms/step
Epoch 3/50
5165/5165 - 169s - loss: 3.0498 - accuracy20: 0.4792 - val_loss: 3.1421 - val_accuracy20: 0.4261 - 169s/epoch - 33ms/step
Epoch 4/50
5165/5165 - 169s - loss: 3.0285 - accuracy20: 0.4861 - val_loss: 3.1332 - val_accuracy20: 0.4281 - 169s/epoch - 33ms/step
Epoch 5/50
5165/5165 - 167s - loss: 3.0113 - accuracy20: 0.4910 - val_loss: 3.1166 - val_accuracy20: 0.4338 - 167s/epoch - 32ms/step
Epoch 6/50
5165/5165 - 172s - loss: 2.9997 - accuracy20: 0.4942 - val_loss: 3.1207 - val_accuracy20: 0.4345 - 172s/epoch - 33ms/step
Epoch 7/50
5165/5165 - 173s - loss: 2.9909 - accuracy20: 0.4967 - val_loss: 3.1119 - val_accuracy20: 0.4391 - 173s/epoch - 33ms/step
Epoch 8/50
5165/5165 - 169s - loss: 2.9840 - accuracy20: 0.4986 - val_loss: 3.0961 - val_accuracy20: 0.4517 - 169s/epoch - 33ms/step
Epoch 9/50
5165/5165 - 170s - loss: 2.9779 - accuracy20: 0.5004 - val_loss: 3.0895 - val_accuracy20: 0.4553 - 170s/epoch - 33ms/step
Epoch 10/50
5165/5165 - 169s - loss: 2.9733 - accuracy20: 0.5016 - val_loss: 3.0792 - val_accuracy20: 0.4574 - 169s/epoch - 33ms/step
Epoch 11/50
5165/5165 - 172s - loss: 2.9687 - accuracy20: 0.5028 - val_loss: 3.0687 - val_accuracy20: 0.4632 - 172s/epoch - 33ms/step
Epoch 12/50
5165/5165 - 168s - loss: 2.9650 - accuracy20: 0.5035 - val_loss: 3.0716 - val_accuracy20: 0.4589 - 168s/epoch - 33ms/step
Epoch 13/50
5165/5165 - 171s - loss: 2.9611 - accuracy20: 0.5051 - val_loss: 3.0637 - val_accuracy20: 0.4626 - 171s/epoch - 33ms/step
Epoch 14/50
5165/5165 - 166s - loss: 2.9576 - accuracy20: 0.5056 - val_loss: 3.0647 - val_accuracy20: 0.4636 - 166s/epoch - 32ms/step
Epoch 15/50
5165/5165 - 167s - loss: 2.9547 - accuracy20: 0.5064 - val_loss: 3.0648 - val_accuracy20: 0.4637 - 167s/epoch - 32ms/step
Epoch 16/50
5165/5165 - 167s - loss: 2.9520 - accuracy20: 0.5073 - val_loss: 3.0501 - val_accuracy20: 0.4676 - 167s/epoch - 32ms/step
Epoch 17/50
5165/5165 - 167s - loss: 2.9491 - accuracy20: 0.5078 - val_loss: 3.0480 - val_accuracy20: 0.4703 - 167s/epoch - 32ms/step
Epoch 18/50
5165/5165 - 166s - loss: 2.9466 - accuracy20: 0.5086 - val_loss: 3.0459 - val_accuracy20: 0.4710 - 166s/epoch - 32ms/step
Epoch 19/50
5165/5165 - 169s - loss: 2.9443 - accuracy20: 0.5095 - val_loss: 3.0402 - val_accuracy20: 0.4739 - 169s/epoch - 33ms/step
Epoch 20/50
5165/5165 - 170s - loss: 2.9418 - accuracy20: 0.5100 - val_loss: 3.0446 - val_accuracy20: 0.4706 - 170s/epoch - 33ms/step
Epoch 21/50
5165/5165 - 166s - loss: 2.9395 - accuracy20: 0.5105 - val_loss: 3.0470 - val_accuracy20: 0.4704 - 166s/epoch - 32ms/step
Epoch 22/50
5165/5165 - 166s - loss: 2.9373 - accuracy20: 0.5110 - val_loss: 3.0426 - val_accuracy20: 0.4725 - 166s/epoch - 32ms/step
Epoch 23/50
5165/5165 - 170s - loss: 2.9354 - accuracy20: 0.5115 - val_loss: 3.0323 - val_accuracy20: 0.4774 - 170s/epoch - 33ms/step
Epoch 24/50
5165/5165 - 170s - loss: 2.9336 - accuracy20: 0.5120 - val_loss: 3.0378 - val_accuracy20: 0.4754 - 170s/epoch - 33ms/step
Epoch 25/50
5165/5165 - 168s - loss: 2.9318 - accuracy20: 0.5124 - val_loss: 3.0316 - val_accuracy20: 0.4788 - 168s/epoch - 33ms/step
Epoch 26/50
5165/5165 - 168s - loss: 2.9302 - accuracy20: 0.5125 - val_loss: 3.0327 - val_accuracy20: 0.4780 - 168s/epoch - 33ms/step
Epoch 27/50
5165/5165 - 168s - loss: 2.9282 - accuracy20: 0.5136 - val_loss: 3.0306 - val_accuracy20: 0.4803 - 168s/epoch - 32ms/step
Epoch 28/50
5165/5165 - 167s - loss: 2.9263 - accuracy20: 0.5140 - val_loss: 3.0295 - val_accuracy20: 0.4816 - 167s/epoch - 32ms/step
Epoch 29/50
5165/5165 - 168s - loss: 2.9248 - accuracy20: 0.5143 - val_loss: 3.0270 - val_accuracy20: 0.4814 - 168s/epoch - 32ms/step
Epoch 30/50
5165/5165 - 167s - loss: 2.9235 - accuracy20: 0.5147 - val_loss: 3.0316 - val_accuracy20: 0.4796 - 167s/epoch - 32ms/step
Epoch 31/50
5165/5165 - 168s - loss: 2.9220 - accuracy20: 0.5149 - val_loss: 3.0294 - val_accuracy20: 0.4810 - 168s/epoch - 33ms/step
Epoch 32/50
5165/5165 - 168s - loss: 2.9201 - accuracy20: 0.5156 - val_loss: 3.0275 - val_accuracy20: 0.4809 - 168s/epoch - 32ms/step
Epoch 33/50
5165/5165 - 171s - loss: 2.9191 - accuracy20: 0.5158 - val_loss: 3.0305 - val_accuracy20: 0.4795 - 171s/epoch - 33ms/step
Epoch 34/50
5165/5165 - 171s - loss: 2.9175 - accuracy20: 0.5164 - val_loss: 3.0292 - val_accuracy20: 0.4799 - 171s/epoch - 33ms/step
Epoch 35/50
5165/5165 - 167s - loss: 2.9162 - accuracy20: 0.5167 - val_loss: 3.0273 - val_accuracy20: 0.4811 - 167s/epoch - 32ms/step
Epoch 36/50
5165/5165 - 167s - loss: 2.9144 - accuracy20: 0.5170 - val_loss: 3.0284 - val_accuracy20: 0.4811 - 167s/epoch - 32ms/step
Epoch 37/50
5165/5165 - 168s - loss: 2.9136 - accuracy20: 0.5174 - val_loss: 3.0263 - val_accuracy20: 0.4819 - 168s/epoch - 32ms/step
Epoch 38/50
5165/5165 - 171s - loss: 2.9121 - accuracy20: 0.5176 - val_loss: 3.0238 - val_accuracy20: 0.4821 - 171s/epoch - 33ms/step
Epoch 39/50
5165/5165 - 171s - loss: 2.9109 - accuracy20: 0.5182 - val_loss: 3.0280 - val_accuracy20: 0.4805 - 171s/epoch - 33ms/step
Epoch 40/50
5165/5165 - 177s - loss: 2.9095 - accuracy20: 0.5184 - val_loss: 3.0279 - val_accuracy20: 0.4818 - 177s/epoch - 34ms/step
Epoch 41/50
5165/5165 - 171s - loss: 2.9088 - accuracy20: 0.5187 - val_loss: 3.0302 - val_accuracy20: 0.4813 - 171s/epoch - 33ms/step
Epoch 42/50
5165/5165 - 168s - loss: 2.9075 - accuracy20: 0.5190 - val_loss: 3.0310 - val_accuracy20: 0.4797 - 168s/epoch - 33ms/step
Epoch 43/50
5165/5165 - 169s - loss: 2.9063 - accuracy20: 0.5192 - val_loss: 3.0254 - val_accuracy20: 0.4811 - 169s/epoch - 33ms/step
Epoch 44/50
5165/5165 - 168s - loss: 2.9053 - accuracy20: 0.5196 - val_loss: 3.0290 - val_accuracy20: 0.4800 - 168s/epoch - 33ms/step
Epoch 45/50
5165/5165 - 168s - loss: 2.9033 - accuracy20: 0.5203 - val_loss: 3.0307 - val_accuracy20: 0.4797 - 168s/epoch - 32ms/step
Epoch 46/50
5165/5165 - 169s - loss: 2.9027 - accuracy20: 0.5204 - val_loss: 3.0290 - val_accuracy20: 0.4809 - 169s/epoch - 33ms/step
Epoch 47/50
5165/5165 - 171s - loss: 2.9015 - accuracy20: 0.5206 - val_loss: 3.0278 - val_accuracy20: 0.4818 - 171s/epoch - 33ms/step
Epoch 48/50
5165/5165 - 170s - loss: 2.9010 - accuracy20: 0.5204 - val_loss: 3.0268 - val_accuracy20: 0.4817 - 170s/epoch - 33ms/step
testing model: results/AAPL/W4/deepVOL_L3/h20
Evaluating performance on  test set...
12724/12724 - 168s - 168s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98044026
{'0': {'precision': 0.5196258576270442, 'recall': 0.40090590747029314, 'f1-score': 0.4526102930841752, 'support': 943805}, '1': {'precision': 0.48890619704743954, 'recall': 0.5987278491243041, 'f1-score': 0.5382725132816121, 'support': 1373422}, '2': {'precision': 0.4877096258168102, 'recall': 0.43951825687292534, 'f1-score': 0.46236160193400544, 'support': 939920}, 'accuracy': 0.4954627469991376, 'macro avg': {'precision': 0.4987472268304313, 'recall': 0.47971733782250753, 'f1-score': 0.4844148027665976, 'support': 3257147}, 'weighted avg': {'precision': 0.49746236231177693, 'recall': 0.4954627469991376, 'f1-score': 0.49154492759779606, 'support': 3257147}}
[[378377 439595 125833]
 [243016 822306 308100]
 [106779 420029 413112]]
Evaluating performance on  train set...
5165/5165 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9999187
{'0': {'precision': 0.5331087421973869, 'recall': 0.48012897641399344, 'f1-score': 0.5052337669769571, 'support': 441321}, '1': {'precision': 0.4256282623643002, 'recall': 0.5006276241180799, 'f1-score': 0.4600915769705065, 'support': 438957}, '2': {'precision': 0.5322187229082075, 'recall': 0.4918768559426378, 'f1-score': 0.511253202345917, 'support': 441824}, 'accuracy': 0.49086076565953307, 'macro avg': {'precision': 0.49698524248996484, 'recall': 0.4908778188249037, 'f1-score': 0.49219284876446023, 'support': 1322102}, 'weighted avg': {'precision': 0.49712623792123073, 'recall': 0.49086076565953307, 'f1-score': 0.4922574994225579, 'support': 1322102}}
[[211891 149791  79639]
 [107831 219754 111372]
 [ 77741 146760 217323]]
Evaluating performance on  val set...
1903/1903 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0081097
{'0': {'precision': 0.5404782653649026, 'recall': 0.4459094703362722, 'f1-score': 0.48866053036600804, 'support': 164123}, '1': {'precision': 0.41664306350195435, 'recall': 0.5076646984632954, 'f1-score': 0.4576721821524537, 'support': 159367}, '2': {'precision': 0.5120226667767818, 'recall': 0.4929239801846982, 'f1-score': 0.502291841294275, 'support': 163510}, 'accuracy': 0.4819034907597536, 'macro avg': {'precision': 0.48971466521454626, 'recall': 0.48216604966142196, 'f1-score': 0.48287485127091223, 'support': 487000}, 'weighted avg': {'precision': 0.4904001964933706, 'recall': 0.4819034907597536, 'f1-score': 0.4830965376763395, 'support': 487000}}
[[73184 58182 32757]
 [34406 80905 44056]
 [27816 55096 80598]]
training model: results/AAPL/W4/deepVOL_L3/h30
Epoch 1/50
5165/5165 - 184s - loss: 3.1904 - accuracy30: 0.4267 - val_loss: 3.2215 - val_accuracy30: 0.3980 - 184s/epoch - 36ms/step
Epoch 2/50
5165/5165 - 177s - loss: 3.1328 - accuracy30: 0.4505 - val_loss: 3.1985 - val_accuracy30: 0.4085 - 177s/epoch - 34ms/step
Epoch 3/50
5165/5165 - 172s - loss: 3.1055 - accuracy30: 0.4614 - val_loss: 3.1849 - val_accuracy30: 0.4094 - 172s/epoch - 33ms/step
Epoch 4/50
5165/5165 - 172s - loss: 3.0882 - accuracy30: 0.4678 - val_loss: 3.1618 - val_accuracy30: 0.4218 - 172s/epoch - 33ms/step
Epoch 5/50
5165/5165 - 174s - loss: 3.0777 - accuracy30: 0.4715 - val_loss: 3.1560 - val_accuracy30: 0.4256 - 174s/epoch - 34ms/step
Epoch 6/50
5165/5165 - 172s - loss: 3.0688 - accuracy30: 0.4747 - val_loss: 3.1569 - val_accuracy30: 0.4287 - 172s/epoch - 33ms/step
Epoch 7/50
5165/5165 - 174s - loss: 3.0621 - accuracy30: 0.4766 - val_loss: 3.1573 - val_accuracy30: 0.4278 - 174s/epoch - 34ms/step
Epoch 8/50
5165/5165 - 176s - loss: 3.0563 - accuracy30: 0.4783 - val_loss: 3.1518 - val_accuracy30: 0.4332 - 176s/epoch - 34ms/step
Epoch 9/50
5165/5165 - 172s - loss: 3.0519 - accuracy30: 0.4797 - val_loss: 3.1419 - val_accuracy30: 0.4349 - 172s/epoch - 33ms/step
Epoch 10/50
5165/5165 - 172s - loss: 3.0477 - accuracy30: 0.4812 - val_loss: 3.1485 - val_accuracy30: 0.4301 - 172s/epoch - 33ms/step
Epoch 11/50
5165/5165 - 173s - loss: 3.0443 - accuracy30: 0.4820 - val_loss: 3.1470 - val_accuracy30: 0.4302 - 173s/epoch - 33ms/step
Epoch 12/50
5165/5165 - 174s - loss: 3.0410 - accuracy30: 0.4833 - val_loss: 3.1469 - val_accuracy30: 0.4309 - 174s/epoch - 34ms/step
Epoch 13/50
5165/5165 - 175s - loss: 3.0378 - accuracy30: 0.4842 - val_loss: 3.1456 - val_accuracy30: 0.4310 - 175s/epoch - 34ms/step
Epoch 14/50
5165/5165 - 177s - loss: 3.0355 - accuracy30: 0.4850 - val_loss: 3.1395 - val_accuracy30: 0.4334 - 177s/epoch - 34ms/step
Epoch 15/50
5165/5165 - 178s - loss: 3.0328 - accuracy30: 0.4858 - val_loss: 3.1420 - val_accuracy30: 0.4332 - 178s/epoch - 34ms/step
Epoch 16/50
5165/5165 - 181s - loss: 3.0301 - accuracy30: 0.4869 - val_loss: 3.1446 - val_accuracy30: 0.4317 - 181s/epoch - 35ms/step
Epoch 17/50
5165/5165 - 181s - loss: 3.0278 - accuracy30: 0.4875 - val_loss: 3.1420 - val_accuracy30: 0.4340 - 181s/epoch - 35ms/step
Epoch 18/50
5165/5165 - 177s - loss: 3.0254 - accuracy30: 0.4882 - val_loss: 3.1392 - val_accuracy30: 0.4354 - 177s/epoch - 34ms/step
Epoch 19/50
5165/5165 - 175s - loss: 3.0233 - accuracy30: 0.4887 - val_loss: 3.1331 - val_accuracy30: 0.4384 - 175s/epoch - 34ms/step
Epoch 20/50
5165/5165 - 175s - loss: 3.0211 - accuracy30: 0.4890 - val_loss: 3.1294 - val_accuracy30: 0.4407 - 175s/epoch - 34ms/step
Epoch 21/50
5165/5165 - 176s - loss: 3.0188 - accuracy30: 0.4900 - val_loss: 3.1327 - val_accuracy30: 0.4391 - 176s/epoch - 34ms/step
Epoch 22/50
5165/5165 - 174s - loss: 3.0169 - accuracy30: 0.4906 - val_loss: 3.1256 - val_accuracy30: 0.4416 - 174s/epoch - 34ms/step
Epoch 23/50
5165/5165 - 173s - loss: 3.0155 - accuracy30: 0.4910 - val_loss: 3.1253 - val_accuracy30: 0.4414 - 173s/epoch - 33ms/step
Epoch 24/50
5165/5165 - 172s - loss: 3.0137 - accuracy30: 0.4914 - val_loss: 3.1243 - val_accuracy30: 0.4423 - 172s/epoch - 33ms/step
Epoch 25/50
5165/5165 - 174s - loss: 3.0122 - accuracy30: 0.4918 - val_loss: 3.1160 - val_accuracy30: 0.4465 - 174s/epoch - 34ms/step
Epoch 26/50
5165/5165 - 168s - loss: 3.0104 - accuracy30: 0.4923 - val_loss: 3.1169 - val_accuracy30: 0.4453 - 168s/epoch - 33ms/step
Epoch 27/50
5165/5165 - 175s - loss: 3.0089 - accuracy30: 0.4927 - val_loss: 3.1166 - val_accuracy30: 0.4459 - 175s/epoch - 34ms/step
Epoch 28/50
5165/5165 - 178s - loss: 3.0074 - accuracy30: 0.4933 - val_loss: 3.1085 - val_accuracy30: 0.4504 - 178s/epoch - 34ms/step
Epoch 29/50
5165/5165 - 177s - loss: 3.0057 - accuracy30: 0.4936 - val_loss: 3.1153 - val_accuracy30: 0.4467 - 177s/epoch - 34ms/step
Epoch 30/50
5165/5165 - 179s - loss: 3.0044 - accuracy30: 0.4939 - val_loss: 3.1084 - val_accuracy30: 0.4499 - 179s/epoch - 35ms/step
Epoch 31/50
5165/5165 - 182s - loss: 3.0028 - accuracy30: 0.4948 - val_loss: 3.1162 - val_accuracy30: 0.4474 - 182s/epoch - 35ms/step
Epoch 32/50
5165/5165 - 182s - loss: 3.0016 - accuracy30: 0.4946 - val_loss: 3.1177 - val_accuracy30: 0.4480 - 182s/epoch - 35ms/step
Epoch 33/50
5165/5165 - 183s - loss: 3.0000 - accuracy30: 0.4953 - val_loss: 3.1167 - val_accuracy30: 0.4465 - 183s/epoch - 35ms/step
Epoch 34/50
5165/5165 - 181s - loss: 2.9990 - accuracy30: 0.4957 - val_loss: 3.1122 - val_accuracy30: 0.4499 - 181s/epoch - 35ms/step
Epoch 35/50
5165/5165 - 181s - loss: 2.9974 - accuracy30: 0.4962 - val_loss: 3.1144 - val_accuracy30: 0.4489 - 181s/epoch - 35ms/step
Epoch 36/50
5165/5165 - 181s - loss: 2.9959 - accuracy30: 0.4969 - val_loss: 3.1154 - val_accuracy30: 0.4499 - 181s/epoch - 35ms/step
Epoch 37/50
5165/5165 - 179s - loss: 2.9943 - accuracy30: 0.4969 - val_loss: 3.1151 - val_accuracy30: 0.4491 - 179s/epoch - 35ms/step
Epoch 38/50
5165/5165 - 178s - loss: 2.9936 - accuracy30: 0.4972 - val_loss: 3.1147 - val_accuracy30: 0.4488 - 178s/epoch - 34ms/step
Epoch 39/50
5165/5165 - 174s - loss: 2.9918 - accuracy30: 0.4977 - val_loss: 3.1183 - val_accuracy30: 0.4479 - 174s/epoch - 34ms/step
Epoch 40/50
5165/5165 - 175s - loss: 2.9908 - accuracy30: 0.4981 - val_loss: 3.1129 - val_accuracy30: 0.4495 - 175s/epoch - 34ms/step
testing model: results/AAPL/W4/deepVOL_L3/h30
Evaluating performance on  test set...
12724/12724 - 176s - 176s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0137948
{'0': {'precision': 0.501158800990672, 'recall': 0.3794121616711137, 'f1-score': 0.43186921233378556, 'support': 963190}, '1': {'precision': 0.4512912624362831, 'recall': 0.5580337720864225, 'f1-score': 0.4990181693175816, 'support': 1333172}, '2': {'precision': 0.46879612299617257, 'recall': 0.4291064077811373, 'f1-score': 0.4480740691229941, 'support': 960785}, 'accuracy': 0.4671818619178072, 'macro avg': {'precision': 0.4737487288077092, 'recall': 0.4555174471795578, 'f1-score': 0.4596538169247871, 'support': 3257147}, 'weighted avg': {'precision': 0.4712014236642643, 'recall': 0.4671818619178072, 'f1-score': 0.4641337962196897, 'support': 3257147}}
[[365446 462105 135639]
 [257693 743955 331524]
 [106063 442443 412279]]
Evaluating performance on  train set...
5165/5165 - 87s - 87s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0317397
{'0': {'precision': 0.5236625485975447, 'recall': 0.4258808565527997, 'f1-score': 0.46973704104876235, 'support': 444993}, '1': {'precision': 0.3749421335136875, 'recall': 0.5053358414068715, 'f1-score': 0.43048151587599537, 'support': 431141}, '2': {'precision': 0.5191415955813696, 'recall': 0.44132762888817134, 'f1-score': 0.47708250009089914, 'support': 445968}, 'accuracy': 0.4570018047019065, 'macro avg': {'precision': 0.4725820925642006, 'recall': 0.4575147756159475, 'f1-score': 0.45910035233855223, 'support': 1322102}, 'weighted avg': {'precision': 0.4736394271936085, 'recall': 0.4570018047019065, 'f1-score': 0.45941346034136743, 'support': 1322102}}
[[189514 182565  72914]
 [103880 217871 109390]
 [ 68507 180643 196818]]
Evaluating performance on  val set...
1903/1903 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0369797
{'0': {'precision': 0.5301804397017443, 'recall': 0.38921171999509624, 'f1-score': 0.44888884175848254, 'support': 163140}, '1': {'precision': 0.37928439796520663, 'recall': 0.5190213705251995, 'f1-score': 0.43828441262609824, 'support': 162186}, '2': {'precision': 0.4938333631570978, 'recall': 0.44381285797345277, 'f1-score': 0.4674888914949898, 'support': 161674}, 'accuracy': 0.4505687885010267, 'macro avg': {'precision': 0.46776606694134965, 'recall': 0.45068198283124955, 'f1-score': 0.4515540486265235, 'support': 487000}, 'weighted avg': {'precision': 0.4678609270151708, 'recall': 0.4505687885010267, 'f1-score': 0.4515320748135856, 'support': 487000}}
[[63496 70452 29192]
 [33655 84178 44353]
 [22612 67309 71753]]
training model: results/AAPL/W4/deepVOL_L3/h50
Epoch 1/50
5165/5165 - 178s - loss: 3.1710 - accuracy50: 0.4358 - val_loss: 3.3364 - val_accuracy50: 0.3653 - 178s/epoch - 34ms/step
Epoch 2/50
5165/5165 - 172s - loss: 3.1494 - accuracy50: 0.4457 - val_loss: 3.3135 - val_accuracy50: 0.3707 - 172s/epoch - 33ms/step
Epoch 3/50
5165/5165 - 174s - loss: 3.1405 - accuracy50: 0.4501 - val_loss: 3.2841 - val_accuracy50: 0.3724 - 174s/epoch - 34ms/step
Epoch 4/50
5165/5165 - 172s - loss: 3.1333 - accuracy50: 0.4534 - val_loss: 3.2993 - val_accuracy50: 0.3713 - 172s/epoch - 33ms/step
Epoch 5/50
5165/5165 - 171s - loss: 3.1177 - accuracy50: 0.4601 - val_loss: 3.2864 - val_accuracy50: 0.3751 - 171s/epoch - 33ms/step
Epoch 6/50
5165/5165 - 171s - loss: 3.1021 - accuracy50: 0.4663 - val_loss: 3.2968 - val_accuracy50: 0.3764 - 171s/epoch - 33ms/step
Epoch 7/50
5165/5165 - 172s - loss: 3.0933 - accuracy50: 0.4693 - val_loss: 3.2950 - val_accuracy50: 0.3790 - 172s/epoch - 33ms/step
Epoch 8/50
5165/5165 - 172s - loss: 3.0860 - accuracy50: 0.4725 - val_loss: 3.2991 - val_accuracy50: 0.3785 - 172s/epoch - 33ms/step
Epoch 9/50
5165/5165 - 172s - loss: 3.0808 - accuracy50: 0.4742 - val_loss: 3.2811 - val_accuracy50: 0.3815 - 172s/epoch - 33ms/step
Epoch 10/50
5165/5165 - 172s - loss: 3.0772 - accuracy50: 0.4753 - val_loss: 3.2755 - val_accuracy50: 0.3819 - 172s/epoch - 33ms/step
Epoch 11/50
5165/5165 - 171s - loss: 3.0743 - accuracy50: 0.4763 - val_loss: 3.2779 - val_accuracy50: 0.3815 - 171s/epoch - 33ms/step
Epoch 12/50
5165/5165 - 172s - loss: 3.0718 - accuracy50: 0.4774 - val_loss: 3.2758 - val_accuracy50: 0.3816 - 172s/epoch - 33ms/step
Epoch 13/50
5165/5165 - 171s - loss: 3.0697 - accuracy50: 0.4784 - val_loss: 3.2700 - val_accuracy50: 0.3827 - 171s/epoch - 33ms/step
Epoch 14/50
5165/5165 - 171s - loss: 3.0678 - accuracy50: 0.4788 - val_loss: 3.2612 - val_accuracy50: 0.3838 - 171s/epoch - 33ms/step
Epoch 15/50
5165/5165 - 173s - loss: 3.0661 - accuracy50: 0.4794 - val_loss: 3.2636 - val_accuracy50: 0.3833 - 173s/epoch - 33ms/step
Epoch 16/50
5165/5165 - 172s - loss: 3.0645 - accuracy50: 0.4799 - val_loss: 3.2566 - val_accuracy50: 0.3854 - 172s/epoch - 33ms/step
Epoch 17/50
5165/5165 - 174s - loss: 3.0630 - accuracy50: 0.4805 - val_loss: 3.2635 - val_accuracy50: 0.3846 - 174s/epoch - 34ms/step
Epoch 18/50
5165/5165 - 172s - loss: 3.0614 - accuracy50: 0.4805 - val_loss: 3.2541 - val_accuracy50: 0.3858 - 172s/epoch - 33ms/step
Epoch 19/50
5165/5165 - 172s - loss: 3.0600 - accuracy50: 0.4811 - val_loss: 3.2531 - val_accuracy50: 0.3866 - 172s/epoch - 33ms/step
Epoch 20/50
5165/5165 - 174s - loss: 3.0589 - accuracy50: 0.4813 - val_loss: 3.2595 - val_accuracy50: 0.3869 - 174s/epoch - 34ms/step
Epoch 21/50
5165/5165 - 174s - loss: 3.0578 - accuracy50: 0.4820 - val_loss: 3.2505 - val_accuracy50: 0.3868 - 174s/epoch - 34ms/step
Epoch 22/50
5165/5165 - 170s - loss: 3.0562 - accuracy50: 0.4822 - val_loss: 3.2496 - val_accuracy50: 0.3892 - 170s/epoch - 33ms/step
Epoch 23/50
5165/5165 - 172s - loss: 3.0549 - accuracy50: 0.4826 - val_loss: 3.2444 - val_accuracy50: 0.3905 - 172s/epoch - 33ms/step
Epoch 24/50
5165/5165 - 174s - loss: 3.0539 - accuracy50: 0.4829 - val_loss: 3.2405 - val_accuracy50: 0.3913 - 174s/epoch - 34ms/step
Epoch 25/50
5165/5165 - 175s - loss: 3.0526 - accuracy50: 0.4834 - val_loss: 3.2439 - val_accuracy50: 0.3927 - 175s/epoch - 34ms/step
Epoch 26/50
5165/5165 - 175s - loss: 3.0512 - accuracy50: 0.4838 - val_loss: 3.2344 - val_accuracy50: 0.3950 - 175s/epoch - 34ms/step
Epoch 27/50
5165/5165 - 174s - loss: 3.0505 - accuracy50: 0.4839 - val_loss: 3.2361 - val_accuracy50: 0.3950 - 174s/epoch - 34ms/step
Epoch 28/50
5165/5165 - 176s - loss: 3.0490 - accuracy50: 0.4844 - val_loss: 3.2365 - val_accuracy50: 0.3953 - 176s/epoch - 34ms/step
Epoch 29/50
5165/5165 - 176s - loss: 3.0480 - accuracy50: 0.4847 - val_loss: 3.2307 - val_accuracy50: 0.3962 - 176s/epoch - 34ms/step
Epoch 30/50
5165/5165 - 176s - loss: 3.0469 - accuracy50: 0.4851 - val_loss: 3.2363 - val_accuracy50: 0.3954 - 176s/epoch - 34ms/step
Epoch 31/50
5165/5165 - 173s - loss: 3.0458 - accuracy50: 0.4854 - val_loss: 3.2330 - val_accuracy50: 0.3972 - 173s/epoch - 34ms/step
Epoch 32/50
5165/5165 - 175s - loss: 3.0444 - accuracy50: 0.4854 - val_loss: 3.2303 - val_accuracy50: 0.3972 - 175s/epoch - 34ms/step
Epoch 33/50
5165/5165 - 177s - loss: 3.0436 - accuracy50: 0.4860 - val_loss: 3.2368 - val_accuracy50: 0.3952 - 177s/epoch - 34ms/step
Epoch 34/50
5165/5165 - 176s - loss: 3.0426 - accuracy50: 0.4863 - val_loss: 3.2291 - val_accuracy50: 0.3985 - 176s/epoch - 34ms/step
Epoch 35/50
5165/5165 - 175s - loss: 3.0410 - accuracy50: 0.4867 - val_loss: 3.2279 - val_accuracy50: 0.3996 - 175s/epoch - 34ms/step
Epoch 36/50
5165/5165 - 176s - loss: 3.0402 - accuracy50: 0.4869 - val_loss: 3.2274 - val_accuracy50: 0.3987 - 176s/epoch - 34ms/step
Epoch 37/50
5165/5165 - 177s - loss: 3.0392 - accuracy50: 0.4873 - val_loss: 3.2289 - val_accuracy50: 0.3997 - 177s/epoch - 34ms/step
Epoch 38/50
5165/5165 - 172s - loss: 3.0378 - accuracy50: 0.4876 - val_loss: 3.2318 - val_accuracy50: 0.3979 - 172s/epoch - 33ms/step
Epoch 39/50
5165/5165 - 172s - loss: 3.0367 - accuracy50: 0.4881 - val_loss: 3.2352 - val_accuracy50: 0.3979 - 172s/epoch - 33ms/step
Epoch 40/50
5165/5165 - 176s - loss: 3.0356 - accuracy50: 0.4885 - val_loss: 3.2375 - val_accuracy50: 0.3965 - 176s/epoch - 34ms/step
Epoch 41/50
5165/5165 - 173s - loss: 3.0343 - accuracy50: 0.4885 - val_loss: 3.2263 - val_accuracy50: 0.4010 - 173s/epoch - 34ms/step
Epoch 42/50
5165/5165 - 173s - loss: 3.0330 - accuracy50: 0.4894 - val_loss: 3.2342 - val_accuracy50: 0.3986 - 173s/epoch - 33ms/step
Epoch 43/50
5165/5165 - 170s - loss: 3.0319 - accuracy50: 0.4896 - val_loss: 3.2339 - val_accuracy50: 0.4011 - 170s/epoch - 33ms/step
Epoch 44/50
5165/5165 - 170s - loss: 3.0307 - accuracy50: 0.4902 - val_loss: 3.2302 - val_accuracy50: 0.4029 - 170s/epoch - 33ms/step
Epoch 45/50
5165/5165 - 171s - loss: 3.0296 - accuracy50: 0.4905 - val_loss: 3.2315 - val_accuracy50: 0.4029 - 171s/epoch - 33ms/step
Epoch 46/50
5165/5165 - 171s - loss: 3.0283 - accuracy50: 0.4910 - val_loss: 3.2275 - val_accuracy50: 0.4029 - 171s/epoch - 33ms/step
Epoch 47/50
5165/5165 - 170s - loss: 3.0271 - accuracy50: 0.4911 - val_loss: 3.2402 - val_accuracy50: 0.4007 - 170s/epoch - 33ms/step
Epoch 48/50
5165/5165 - 171s - loss: 3.0255 - accuracy50: 0.4918 - val_loss: 3.2403 - val_accuracy50: 0.4024 - 171s/epoch - 33ms/step
Epoch 49/50
5165/5165 - 171s - loss: 3.0245 - accuracy50: 0.4925 - val_loss: 3.2407 - val_accuracy50: 0.4009 - 171s/epoch - 33ms/step
Epoch 50/50
5165/5165 - 172s - loss: 3.0229 - accuracy50: 0.4929 - val_loss: 3.2413 - val_accuracy50: 0.4036 - 172s/epoch - 33ms/step
testing model: results/AAPL/W4/deepVOL_L3/h50
Evaluating performance on  test set...
12724/12724 - 169s - 169s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0294137
{'0': {'precision': 0.42472521995851603, 'recall': 0.30578216802254454, 'f1-score': 0.35557039041509125, 'support': 877906}, '1': {'precision': 0.4861587563401055, 'recall': 0.661886515993486, 'f1-score': 0.5605735822588314, 'support': 1506926}, '2': {'precision': 0.4155968710002546, 'recall': 0.27322010970807564, 'f1-score': 0.3296940286584004, 'support': 872315}, 'accuracy': 0.46181397400854185, 'macro avg': {'precision': 0.44216028243295874, 'recall': 0.4136295979080354, 'f1-score': 0.41527933377744103, 'support': 3257147}, 'weighted avg': {'precision': 0.45070286159514994, 'recall': 0.46181397400854185, 'f1-score': 0.4434854588374045, 'support': 3257147}}
[[268448 522037  87421]
 [261793 997414 247719]
 [101810 532171 238334]]
Evaluating performance on  train set...
5165/5165 - 72s - 72s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.080014
{'0': {'precision': 0.5050892503722693, 'recall': 0.24345459955345686, 'f1-score': 0.3285480234734085, 'support': 440271}, '1': {'precision': 0.3450705157477449, 'recall': 0.710332002779178, 'f1-score': 0.46449506467590773, 'support': 440418}, '2': {'precision': 0.501524960154267, 'recall': 0.23096737069365877, 'f1-score': 0.31627881004564934, 'support': 441413}, 'accuracy': 0.3948114442002206, 'macro avg': {'precision': 0.45056157542476044, 'recall': 0.3949179910087645, 'f1-score': 0.3697739660649885, 'support': 1322102}, 'weighted avg': {'precision': 0.4505938671840865, 'recall': 0.3948114442002206, 'f1-score': 0.36973828994720165, 'support': 1322102}}
[[107186 295061  38024]
 [ 64267 312843  63308]
 [ 40759 298702 101952]]
Evaluating performance on  val set...
1903/1903 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0757912
{'0': {'precision': 0.500472849944246, 'recall': 0.22469012192339866, 'f1-score': 0.31014078224018266, 'support': 157804}, '1': {'precision': 0.3658598380843517, 'recall': 0.7173695794076701, 'f1-score': 0.4845819619197384, 'support': 173113}, '2': {'precision': 0.4634696351525737, 'recall': 0.2278018746436191, 'f1-score': 0.3054639175257732, 'support': 156083}, 'accuracy': 0.40081930184804926, 'macro avg': {'precision': 0.4432674410603905, 'recall': 0.38995385865822924, 'f1-score': 0.3667288872285647, 'support': 487000}, 'weighted avg': {'precision': 0.44076271627601094, 'recall': 0.40081930184804926, 'f1-score': 0.3706501392476729, 'support': 487000}}
[[ 35457 107950  14397]
 [ 22163 124186  26764]
 [ 13227 107300  35556]]
training model: results/AAPL/W4/deepVOL_L3/h100
Epoch 1/50
5165/5165 - 184s - loss: 3.2542 - accuracy100: 0.3911 - val_loss: 3.2940 - val_accuracy100: 0.3577 - 184s/epoch - 36ms/step
Epoch 2/50
5165/5165 - 178s - loss: 3.2345 - accuracy100: 0.4025 - val_loss: 3.3060 - val_accuracy100: 0.3563 - 178s/epoch - 34ms/step
Epoch 3/50
5165/5165 - 180s - loss: 3.2264 - accuracy100: 0.4074 - val_loss: 3.2926 - val_accuracy100: 0.3568 - 180s/epoch - 35ms/step
Epoch 4/50
5165/5165 - 181s - loss: 3.2206 - accuracy100: 0.4114 - val_loss: 3.3098 - val_accuracy100: 0.3550 - 181s/epoch - 35ms/step
Epoch 5/50
5165/5165 - 180s - loss: 3.2167 - accuracy100: 0.4141 - val_loss: 3.3128 - val_accuracy100: 0.3586 - 180s/epoch - 35ms/step
Epoch 6/50
5165/5165 - 186s - loss: 3.2111 - accuracy100: 0.4176 - val_loss: 3.3002 - val_accuracy100: 0.3656 - 186s/epoch - 36ms/step
Epoch 7/50
5165/5165 - 187s - loss: 3.2059 - accuracy100: 0.4200 - val_loss: 3.2947 - val_accuracy100: 0.3674 - 187s/epoch - 36ms/step
Epoch 8/50
5165/5165 - 184s - loss: 3.2019 - accuracy100: 0.4217 - val_loss: 3.2941 - val_accuracy100: 0.3671 - 184s/epoch - 36ms/step
Epoch 9/50
5165/5165 - 185s - loss: 3.1990 - accuracy100: 0.4230 - val_loss: 3.2925 - val_accuracy100: 0.3690 - 185s/epoch - 36ms/step
Epoch 10/50
5165/5165 - 186s - loss: 3.1956 - accuracy100: 0.4241 - val_loss: 3.2909 - val_accuracy100: 0.3706 - 186s/epoch - 36ms/step
Epoch 11/50
5165/5165 - 185s - loss: 3.1930 - accuracy100: 0.4253 - val_loss: 3.2838 - val_accuracy100: 0.3729 - 185s/epoch - 36ms/step
Epoch 12/50
5165/5165 - 186s - loss: 3.1905 - accuracy100: 0.4264 - val_loss: 3.2964 - val_accuracy100: 0.3708 - 186s/epoch - 36ms/step
Epoch 13/50
5165/5165 - 184s - loss: 3.1881 - accuracy100: 0.4274 - val_loss: 3.2910 - val_accuracy100: 0.3740 - 184s/epoch - 36ms/step
Epoch 14/50
5165/5165 - 187s - loss: 3.1858 - accuracy100: 0.4283 - val_loss: 3.2868 - val_accuracy100: 0.3753 - 187s/epoch - 36ms/step
Epoch 15/50
5165/5165 - 185s - loss: 3.1841 - accuracy100: 0.4293 - val_loss: 3.2848 - val_accuracy100: 0.3754 - 185s/epoch - 36ms/step
Epoch 16/50
5165/5165 - 183s - loss: 3.1824 - accuracy100: 0.4300 - val_loss: 3.2870 - val_accuracy100: 0.3763 - 183s/epoch - 35ms/step
Epoch 17/50
5165/5165 - 184s - loss: 3.1807 - accuracy100: 0.4308 - val_loss: 3.2916 - val_accuracy100: 0.3748 - 184s/epoch - 36ms/step
Epoch 18/50
5165/5165 - 185s - loss: 3.1791 - accuracy100: 0.4319 - val_loss: 3.2897 - val_accuracy100: 0.3782 - 185s/epoch - 36ms/step
Epoch 19/50
5165/5165 - 185s - loss: 3.1772 - accuracy100: 0.4327 - val_loss: 3.2950 - val_accuracy100: 0.3748 - 185s/epoch - 36ms/step
Epoch 20/50
5165/5165 - 183s - loss: 3.1757 - accuracy100: 0.4333 - val_loss: 3.2833 - val_accuracy100: 0.3797 - 183s/epoch - 35ms/step
Epoch 21/50
5165/5165 - 183s - loss: 3.1745 - accuracy100: 0.4336 - val_loss: 3.2860 - val_accuracy100: 0.3799 - 183s/epoch - 35ms/step
Epoch 22/50
5165/5165 - 184s - loss: 3.1733 - accuracy100: 0.4340 - val_loss: 3.2922 - val_accuracy100: 0.3796 - 184s/epoch - 36ms/step
Epoch 23/50
5165/5165 - 186s - loss: 3.1718 - accuracy100: 0.4349 - val_loss: 3.2890 - val_accuracy100: 0.3796 - 186s/epoch - 36ms/step
Epoch 24/50
5165/5165 - 184s - loss: 3.1706 - accuracy100: 0.4353 - val_loss: 3.2997 - val_accuracy100: 0.3796 - 184s/epoch - 36ms/step
Epoch 25/50
5165/5165 - 184s - loss: 3.1690 - accuracy100: 0.4361 - val_loss: 3.2812 - val_accuracy100: 0.3812 - 184s/epoch - 36ms/step
Epoch 26/50
5165/5165 - 184s - loss: 3.1677 - accuracy100: 0.4367 - val_loss: 3.2982 - val_accuracy100: 0.3819 - 184s/epoch - 36ms/step
Epoch 27/50
5165/5165 - 184s - loss: 3.1668 - accuracy100: 0.4371 - val_loss: 3.2863 - val_accuracy100: 0.3801 - 184s/epoch - 36ms/step
Epoch 28/50
5165/5165 - 182s - loss: 3.1654 - accuracy100: 0.4376 - val_loss: 3.2846 - val_accuracy100: 0.3803 - 182s/epoch - 35ms/step
Epoch 29/50
5165/5165 - 177s - loss: 3.1645 - accuracy100: 0.4382 - val_loss: 3.2914 - val_accuracy100: 0.3778 - 177s/epoch - 34ms/step
Epoch 30/50
5165/5165 - 177s - loss: 3.1625 - accuracy100: 0.4387 - val_loss: 3.2914 - val_accuracy100: 0.3781 - 177s/epoch - 34ms/step
Epoch 31/50
5165/5165 - 177s - loss: 3.1616 - accuracy100: 0.4392 - val_loss: 3.2923 - val_accuracy100: 0.3760 - 177s/epoch - 34ms/step
Epoch 32/50
5165/5165 - 175s - loss: 3.1605 - accuracy100: 0.4395 - val_loss: 3.2933 - val_accuracy100: 0.3763 - 175s/epoch - 34ms/step
Epoch 33/50
5165/5165 - 174s - loss: 3.1593 - accuracy100: 0.4404 - val_loss: 3.3002 - val_accuracy100: 0.3731 - 174s/epoch - 34ms/step
Epoch 34/50
5165/5165 - 172s - loss: 3.1577 - accuracy100: 0.4409 - val_loss: 3.2987 - val_accuracy100: 0.3741 - 172s/epoch - 33ms/step
Epoch 35/50
5165/5165 - 170s - loss: 3.1568 - accuracy100: 0.4412 - val_loss: 3.2984 - val_accuracy100: 0.3740 - 170s/epoch - 33ms/step
testing model: results/AAPL/W4/deepVOL_L3/h100
Evaluating performance on  test set...
12724/12724 - 173s - 173s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0783726
{'0': {'precision': 0.3627924326590101, 'recall': 0.4030336463031574, 'f1-score': 0.3818557790142239, 'support': 936299}, '1': {'precision': 0.4440066304080503, 'recall': 0.4236302718315978, 'f1-score': 0.43357918283388297, 'support': 1376514}, '2': {'precision': 0.3697980412770431, 'recall': 0.35386632272056284, 'f1-score': 0.36165681088147944, 'support': 944334}, 'accuracy': 0.3974831347802233, 'macro avg': {'precision': 0.3921990347813678, 'recall': 0.393510080285106, 'f1-score': 0.3923639242431955, 'support': 3257147}, 'weighted avg': {'precision': 0.39914575494044957, 'recall': 0.3974831347802233, 'f1-score': 0.3978585621593344, 'support': 3257147}}
[[377360 362579 196360]
 [420259 583133 373122]
 [242535 367631 334168]]
Evaluating performance on  train set...
5165/5165 - 89s - 89s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0957075
{'0': {'precision': 0.40921507602130297, 'recall': 0.31642970341860993, 'f1-score': 0.35689033755549004, 'support': 441700}, '1': {'precision': 0.33801710368174875, 'recall': 0.44655462762484105, 'f1-score': 0.38477833407037715, 'support': 436455}, '2': {'precision': 0.4131877054699568, 'recall': 0.3759637974803299, 'f1-score': 0.393697834293943, 'support': 443947}, 'accuracy': 0.3793776879544846, 'macro avg': {'precision': 0.3868066283910028, 'recall': 0.3796493761745936, 'f1-score': 0.37845550197327005, 'support': 1322102}, 'weighted avg': {'precision': 0.38704502099406707, 'recall': 0.3793776879544846, 'f1-score': 0.37845632359397346, 'support': 1322102}}
[[139767 191449 110484]
 [114994 194901 126560]
 [ 86788 190251 166908]]
Evaluating performance on  val set...
1903/1903 - 33s - 33s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0940857
{'0': {'precision': 0.409528490559642, 'recall': 0.30112283937539724, 'f1-score': 0.34705734496750335, 'support': 160486}, '1': {'precision': 0.3535350195103977, 'recall': 0.4474532289791989, 'f1-score': 0.3949880321851092, 'support': 167251}, '2': {'precision': 0.39773955274165046, 'recall': 0.3928721674211838, 'f1-score': 0.3952908771009897, 'support': 159263}, 'accuracy': 0.38138193018480493, 'macro avg': {'precision': 0.3869343542705634, 'recall': 0.38048274525859327, 'f1-score': 0.3791120847512008, 'support': 487000}, 'weighted avg': {'precision': 0.3864432633929809, 'recall': 0.38138193018480493, 'f1-score': 0.3792919905445203, 'support': 487000}}
[[48326 69837 42323]
 [39993 74837 52421]
 [29685 67008 62570]]
training model: results/AAPL/W4/deepVOL_L3/h200
Epoch 1/50
5165/5165 - 181s - loss: 3.2471 - accuracy200: 0.3906 - val_loss: 3.3143 - val_accuracy200: 0.3255 - 181s/epoch - 35ms/step
Epoch 2/50
5165/5165 - 174s - loss: 3.2498 - accuracy200: 0.3868 - val_loss: 3.3087 - val_accuracy200: 0.3135 - 174s/epoch - 34ms/step
Epoch 3/50
5165/5165 - 171s - loss: 3.2411 - accuracy200: 0.3927 - val_loss: 3.3089 - val_accuracy200: 0.3193 - 171s/epoch - 33ms/step
Epoch 4/50
5165/5165 - 175s - loss: 3.2326 - accuracy200: 0.3976 - val_loss: 3.3056 - val_accuracy200: 0.3140 - 175s/epoch - 34ms/step
Epoch 5/50
5165/5165 - 175s - loss: 3.2281 - accuracy200: 0.4002 - val_loss: 3.2950 - val_accuracy200: 0.3475 - 175s/epoch - 34ms/step
Epoch 6/50
5165/5165 - 176s - loss: 3.2232 - accuracy200: 0.4051 - val_loss: 3.2899 - val_accuracy200: 0.3525 - 176s/epoch - 34ms/step
Epoch 7/50
5165/5165 - 176s - loss: 3.2159 - accuracy200: 0.4111 - val_loss: 3.2845 - val_accuracy200: 0.3527 - 176s/epoch - 34ms/step
Epoch 8/50
5165/5165 - 176s - loss: 3.2110 - accuracy200: 0.4139 - val_loss: 3.2792 - val_accuracy200: 0.3581 - 176s/epoch - 34ms/step
Epoch 9/50
5165/5165 - 178s - loss: 3.2069 - accuracy200: 0.4168 - val_loss: 3.2852 - val_accuracy200: 0.3514 - 178s/epoch - 34ms/step
Epoch 10/50
5165/5165 - 176s - loss: 3.2016 - accuracy200: 0.4195 - val_loss: 3.2794 - val_accuracy200: 0.3572 - 176s/epoch - 34ms/step
Epoch 11/50
5165/5165 - 175s - loss: 3.1983 - accuracy200: 0.4208 - val_loss: 3.2799 - val_accuracy200: 0.3590 - 175s/epoch - 34ms/step
Epoch 12/50
5165/5165 - 175s - loss: 3.1957 - accuracy200: 0.4224 - val_loss: 3.2827 - val_accuracy200: 0.3527 - 175s/epoch - 34ms/step
Epoch 13/50
5165/5165 - 176s - loss: 3.1944 - accuracy200: 0.4229 - val_loss: 3.2835 - val_accuracy200: 0.3588 - 176s/epoch - 34ms/step
Epoch 14/50
5165/5165 - 176s - loss: 3.1924 - accuracy200: 0.4235 - val_loss: 3.2763 - val_accuracy200: 0.3586 - 176s/epoch - 34ms/step
Epoch 15/50
5165/5165 - 175s - loss: 3.1912 - accuracy200: 0.4241 - val_loss: 3.2836 - val_accuracy200: 0.3564 - 175s/epoch - 34ms/step
Epoch 16/50
5165/5165 - 173s - loss: 3.1895 - accuracy200: 0.4249 - val_loss: 3.2874 - val_accuracy200: 0.3519 - 173s/epoch - 34ms/step
Epoch 17/50
5165/5165 - 175s - loss: 3.1879 - accuracy200: 0.4254 - val_loss: 3.2873 - val_accuracy200: 0.3564 - 175s/epoch - 34ms/step
Epoch 18/50
5165/5165 - 177s - loss: 3.1862 - accuracy200: 0.4264 - val_loss: 3.2898 - val_accuracy200: 0.3540 - 177s/epoch - 34ms/step
Epoch 19/50
5165/5165 - 175s - loss: 3.1852 - accuracy200: 0.4267 - val_loss: 3.2904 - val_accuracy200: 0.3560 - 175s/epoch - 34ms/step
Epoch 20/50
5165/5165 - 178s - loss: 3.1833 - accuracy200: 0.4275 - val_loss: 3.2928 - val_accuracy200: 0.3574 - 178s/epoch - 34ms/step
Epoch 21/50
5165/5165 - 177s - loss: 3.1821 - accuracy200: 0.4282 - val_loss: 3.2930 - val_accuracy200: 0.3580 - 177s/epoch - 34ms/step
Epoch 22/50
5165/5165 - 177s - loss: 3.1808 - accuracy200: 0.4283 - val_loss: 3.2980 - val_accuracy200: 0.3555 - 177s/epoch - 34ms/step
Epoch 23/50
5165/5165 - 176s - loss: 3.1796 - accuracy200: 0.4292 - val_loss: 3.3022 - val_accuracy200: 0.3550 - 176s/epoch - 34ms/step
Epoch 24/50
5165/5165 - 177s - loss: 3.1782 - accuracy200: 0.4294 - val_loss: 3.3000 - val_accuracy200: 0.3576 - 177s/epoch - 34ms/step
testing model: results/AAPL/W4/deepVOL_L3/h200
Evaluating performance on  test set...
12724/12724 - 174s - 174s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0865595
{'0': {'precision': 0.3101215744692658, 'recall': 0.36560139139222686, 'f1-score': 0.33558391487304307, 'support': 886594}, '1': {'precision': 0.47068373909290895, 'recall': 0.24527796080033842, 'f1-score': 0.3224986691992072, 'support': 1458533}, '2': {'precision': 0.31843847459308156, 'recall': 0.5069373478651784, 'f1-score': 0.3911632770818493, 'support': 912020}, 'accuracy': 0.35129608826374736, 'macro avg': {'precision': 0.36641459605175214, 'recall': 0.37260556668591455, 'f1-score': 0.34974862038469984, 'support': 3257147}, 'weighted avg': {'precision': 0.3843492328788919, 'recall': 0.35129608826374736, 'f1-score': 0.3452869547706217, 'support': 3257147}}
[[324140 212377 350077]
 [461313 357746 639474]
 [259750 189933 462337]]
Evaluating performance on  train set...
5165/5165 - 90s - 90s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0943944
{'0': {'precision': 0.36148808118952086, 'recall': 0.3078875292107445, 'f1-score': 0.3325417610899271, 'support': 437767}, '1': {'precision': 0.34648007382933305, 'recall': 0.22256488694703833, 'f1-score': 0.2710305996068107, 'support': 441961}, '2': {'precision': 0.3676587289658945, 'recall': 0.5529732760062752, 'f1-score': 0.44166496648075965, 'support': 442374}, 'accuracy': 0.36137075656795015, 'macro avg': {'precision': 0.3585422946615828, 'recall': 0.3611418973880194, 'f1-score': 0.3484124423924992, 'support': 1322102}, 'weighted avg': {'precision': 0.3585357977790953, 'recall': 0.36137075656795015, 'f1-score': 0.34849191805309976, 'support': 1322102}}
[[134783  96191 206793]
 [129662  98365 213934]
 [108411  89342 244621]]
Evaluating performance on  val set...
1903/1903 - 34s - 34s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0919069
{'0': {'precision': 0.3719198653939899, 'recall': 0.29695405978881817, 'f1-score': 0.3302359676068138, 'support': 159294}, '1': {'precision': 0.3623682709974446, 'recall': 0.2024984067788609, 'f1-score': 0.25980997085210283, 'support': 169468}, '2': {'precision': 0.3530696460363922, 'recall': 0.5915330072422553, 'f1-score': 0.44220148813038856, 'support': 158238}, 'accuracy': 0.35980082135523617, 'macro avg': {'precision': 0.3624525941426089, 'recall': 0.3636618246033114, 'f1-score': 0.3440824755297684, 'support': 487000}, 'weighted avg': {'precision': 0.3624711783100037, 'recall': 0.35980082135523617, 'f1-score': 0.34210916518090434, 'support': 487000}}
[[47303 31845 80146]
 [43788 34317 91363]
 [36095 28540 93603]]
training model: results/AAPL/W4/deepVOL_L3/h300
Epoch 1/50
5165/5165 - 182s - loss: 3.2598 - accuracy300: 0.3821 - val_loss: 3.3230 - val_accuracy300: 0.3303 - 182s/epoch - 35ms/step
Epoch 2/50
5165/5165 - 173s - loss: 3.2648 - accuracy300: 0.3739 - val_loss: 3.3181 - val_accuracy300: 0.3303 - 173s/epoch - 33ms/step
Epoch 3/50
5165/5165 - 170s - loss: 3.2646 - accuracy300: 0.3738 - val_loss: 3.3208 - val_accuracy300: 0.3311 - 170s/epoch - 33ms/step
Epoch 4/50
5165/5165 - 175s - loss: 3.2601 - accuracy300: 0.3797 - val_loss: 3.3194 - val_accuracy300: 0.3307 - 175s/epoch - 34ms/step
Epoch 5/50
5165/5165 - 171s - loss: 3.2606 - accuracy300: 0.3837 - val_loss: 3.3163 - val_accuracy300: 0.3323 - 171s/epoch - 33ms/step
Epoch 6/50
5165/5165 - 174s - loss: 3.2568 - accuracy300: 0.3862 - val_loss: 3.3115 - val_accuracy300: 0.3341 - 174s/epoch - 34ms/step
Epoch 7/50
5165/5165 - 171s - loss: 3.2555 - accuracy300: 0.3839 - val_loss: 3.3208 - val_accuracy300: 0.3307 - 171s/epoch - 33ms/step
Epoch 8/50
5165/5165 - 171s - loss: 3.2467 - accuracy300: 0.3936 - val_loss: 3.2992 - val_accuracy300: 0.3437 - 171s/epoch - 33ms/step
Epoch 9/50
5165/5165 - 173s - loss: 3.2382 - accuracy300: 0.3987 - val_loss: 3.2942 - val_accuracy300: 0.3479 - 173s/epoch - 33ms/step
Epoch 10/50
5165/5165 - 175s - loss: 3.2324 - accuracy300: 0.4025 - val_loss: 3.2987 - val_accuracy300: 0.3453 - 175s/epoch - 34ms/step
Epoch 11/50
5165/5165 - 175s - loss: 3.2275 - accuracy300: 0.4054 - val_loss: 3.3067 - val_accuracy300: 0.3412 - 175s/epoch - 34ms/step
Epoch 12/50
5165/5165 - 177s - loss: 3.2246 - accuracy300: 0.4074 - val_loss: 3.3128 - val_accuracy300: 0.3411 - 177s/epoch - 34ms/step
Epoch 13/50
5165/5165 - 179s - loss: 3.2201 - accuracy300: 0.4104 - val_loss: 3.3118 - val_accuracy300: 0.3412 - 179s/epoch - 35ms/step
Epoch 14/50
5165/5165 - 176s - loss: 3.2174 - accuracy300: 0.4117 - val_loss: 3.3131 - val_accuracy300: 0.3430 - 176s/epoch - 34ms/step
Epoch 15/50
5165/5165 - 173s - loss: 3.2151 - accuracy300: 0.4131 - val_loss: 3.3135 - val_accuracy300: 0.3437 - 173s/epoch - 34ms/step
Epoch 16/50
5165/5165 - 175s - loss: 3.2129 - accuracy300: 0.4143 - val_loss: 3.3151 - val_accuracy300: 0.3458 - 175s/epoch - 34ms/step
Epoch 17/50
5165/5165 - 171s - loss: 3.2108 - accuracy300: 0.4150 - val_loss: 3.3136 - val_accuracy300: 0.3434 - 171s/epoch - 33ms/step
Epoch 18/50
5165/5165 - 174s - loss: 3.2090 - accuracy300: 0.4160 - val_loss: 3.3166 - val_accuracy300: 0.3421 - 174s/epoch - 34ms/step
Epoch 19/50
5165/5165 - 181s - loss: 3.2075 - accuracy300: 0.4170 - val_loss: 3.3185 - val_accuracy300: 0.3445 - 181s/epoch - 35ms/step
testing model: results/AAPL/W4/deepVOL_L3/h300
Evaluating performance on  test set...
12724/12724 - 183s - 183s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0946326
{'0': {'precision': 0.30120440434136597, 'recall': 0.33544246231128244, 'f1-score': 0.3174027937418441, 'support': 912541}, '1': {'precision': 0.4445828373146567, 'recall': 0.3959350437511821, 'f1-score': 0.4188511133635596, 'support': 1406362}, '2': {'precision': 0.3151909543061339, 'recall': 0.3320415584858523, 'f1-score': 0.32339690488350753, 'support': 938244}, 'accuracy': 0.36058212908413406, 'macro avg': {'precision': 0.3536593986540522, 'recall': 0.3544730215161056, 'f1-score': 0.35321693732963705, 'support': 3257147}, 'weighted avg': {'precision': 0.36714087461376294, 'recall': 0.36058212908413406, 'f1-score': 0.3629325166846017, 'support': 3257147}}
[[306105 350342 256094]
 [428760 556828 420774]
 [281405 345303 311536]]
Evaluating performance on  train set...
5165/5165 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0985367
{'0': {'precision': 0.34288475018497605, 'recall': 0.31839220738129137, 'f1-score': 0.33018489829304826, 'support': 442470}, '1': {'precision': 0.32911597487065464, 'recall': 0.3566015378680963, 'f1-score': 0.34230790550203427, 'support': 432937}, '2': {'precision': 0.3567155571136166, 'recall': 0.3530820806142894, 'f1-score': 0.3548895189235408, 'support': 446695}, 'accuracy': 0.3426248504275767, 'macro avg': {'precision': 0.3429054273897491, 'recall': 0.34269194195455904, 'f1-score': 0.34246077423954113, 'support': 1322102}, 'weighted avg': {'precision': 0.3430489886648609, 'recall': 0.3426248504275767, 'f1-score': 0.3425015946482271, 'support': 1322102}}
[[140879 157359 144232]
 [138358 154386 140193]
 [131627 157348 157720]]
Evaluating performance on  val set...
1903/1903 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0978835
{'0': {'precision': 0.3494567315647234, 'recall': 0.3137720992423117, 'f1-score': 0.330654420206659, 'support': 161544}, '1': {'precision': 0.3433447453055296, 'recall': 0.3617664741569349, 'f1-score': 0.3523149667769666, 'support': 164667}, '2': {'precision': 0.3481745325022262, 'recall': 0.36476375871483746, 'f1-score': 0.35627613982547635, 'support': 160789}, 'accuracy': 0.3468357289527721, 'macro avg': {'precision': 0.3469920031241598, 'recall': 0.346767444038028, 'f1-score': 0.346415175603034, 'support': 487000}, 'weighted avg': {'precision': 0.346966780956094, 'recall': 0.3468357289527721, 'f1-score': 0.3464377218450222, 'support': 487000}}
[[50688 57769 53087]
 [48383 59571 56713]
 [45977 56162 58650]]
training model: results/AAPL/W4/deepVOL_L3/h500
Epoch 1/50
5165/5165 - 187s - loss: 3.2624 - accuracy500: 0.3801 - val_loss: 3.3302 - val_accuracy500: 0.3299 - 187s/epoch - 36ms/step
Epoch 2/50
5165/5165 - 180s - loss: 3.2647 - accuracy500: 0.3778 - val_loss: 3.3186 - val_accuracy500: 0.3288 - 180s/epoch - 35ms/step
Epoch 3/50
5165/5165 - 173s - loss: 3.2644 - accuracy500: 0.3767 - val_loss: 3.3328 - val_accuracy500: 0.3321 - 173s/epoch - 34ms/step
Epoch 4/50
5165/5165 - 173s - loss: 3.2646 - accuracy500: 0.3775 - val_loss: 3.3288 - val_accuracy500: 0.3314 - 173s/epoch - 34ms/step
Epoch 5/50
5165/5165 - 179s - loss: 3.2620 - accuracy500: 0.3796 - val_loss: 3.3213 - val_accuracy500: 0.3329 - 179s/epoch - 35ms/step
Epoch 6/50
5165/5165 - 174s - loss: 3.2635 - accuracy500: 0.3821 - val_loss: 3.3192 - val_accuracy500: 0.3277 - 174s/epoch - 34ms/step
Epoch 7/50
5165/5165 - 174s - loss: 3.2638 - accuracy500: 0.3792 - val_loss: 3.3193 - val_accuracy500: 0.3314 - 174s/epoch - 34ms/step
Epoch 8/50
5165/5165 - 173s - loss: 3.2621 - accuracy500: 0.3823 - val_loss: 3.3289 - val_accuracy500: 0.3321 - 173s/epoch - 33ms/step
Epoch 9/50
5165/5165 - 172s - loss: 3.2569 - accuracy500: 0.3886 - val_loss: 3.3243 - val_accuracy500: 0.3323 - 172s/epoch - 33ms/step
Epoch 10/50
5165/5165 - 174s - loss: 3.2529 - accuracy500: 0.3921 - val_loss: 3.3317 - val_accuracy500: 0.3343 - 174s/epoch - 34ms/step
Epoch 11/50
5165/5165 - 175s - loss: 3.2475 - accuracy500: 0.3966 - val_loss: 3.3151 - val_accuracy500: 0.3352 - 175s/epoch - 34ms/step
Epoch 12/50
5165/5165 - 175s - loss: 3.2411 - accuracy500: 0.4008 - val_loss: 3.2995 - val_accuracy500: 0.3384 - 175s/epoch - 34ms/step
Epoch 13/50
5165/5165 - 173s - loss: 3.2338 - accuracy500: 0.4042 - val_loss: 3.2972 - val_accuracy500: 0.3430 - 173s/epoch - 33ms/step
Epoch 14/50
5165/5165 - 174s - loss: 3.2257 - accuracy500: 0.4090 - val_loss: 3.3012 - val_accuracy500: 0.3433 - 174s/epoch - 34ms/step
Epoch 15/50
5165/5165 - 173s - loss: 3.2198 - accuracy500: 0.4123 - val_loss: 3.3101 - val_accuracy500: 0.3404 - 173s/epoch - 33ms/step
Epoch 16/50
5165/5165 - 172s - loss: 3.2145 - accuracy500: 0.4153 - val_loss: 3.3153 - val_accuracy500: 0.3405 - 172s/epoch - 33ms/step
Epoch 17/50
5165/5165 - 173s - loss: 3.2102 - accuracy500: 0.4173 - val_loss: 3.3189 - val_accuracy500: 0.3412 - 173s/epoch - 34ms/step
Epoch 18/50
5165/5165 - 173s - loss: 3.2076 - accuracy500: 0.4185 - val_loss: 3.3181 - val_accuracy500: 0.3430 - 173s/epoch - 34ms/step
Epoch 19/50
5165/5165 - 174s - loss: 3.2046 - accuracy500: 0.4198 - val_loss: 3.3207 - val_accuracy500: 0.3421 - 174s/epoch - 34ms/step
Epoch 20/50
5165/5165 - 173s - loss: 3.2026 - accuracy500: 0.4208 - val_loss: 3.3239 - val_accuracy500: 0.3414 - 173s/epoch - 34ms/step
Epoch 21/50
5165/5165 - 172s - loss: 3.2001 - accuracy500: 0.4217 - val_loss: 3.3310 - val_accuracy500: 0.3394 - 172s/epoch - 33ms/step
Epoch 22/50
5165/5165 - 173s - loss: 3.1984 - accuracy500: 0.4225 - val_loss: 3.3326 - val_accuracy500: 0.3387 - 173s/epoch - 34ms/step
Epoch 23/50
5165/5165 - 173s - loss: 3.1968 - accuracy500: 0.4234 - val_loss: 3.3386 - val_accuracy500: 0.3382 - 173s/epoch - 34ms/step
testing model: results/AAPL/W4/deepVOL_L3/h500
Evaluating performance on  test set...
12724/12724 - 176s - 176s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.09743
{'0': {'precision': 0.3134422346148152, 'recall': 0.17001615764897107, 'f1-score': 0.2204543151049151, 'support': 933923}, '1': {'precision': 0.4187657565396322, 'recall': 0.2600740789929979, 'f1-score': 0.3208713241184438, 'support': 1355310}, '2': {'precision': 0.3097590286967391, 'recall': 0.6108869176393771, 'f1-score': 0.4110760254896808, 'support': 967914}, 'accuracy': 0.33850145541481547, 'macro avg': {'precision': 0.3473223399503955, 'recall': 0.34699238476044875, 'f1-score': 0.31746722157101326, 'support': 3257147}, 'weighted avg': {'precision': 0.3561731877854688, 'recall': 0.33850145541481547, 'f1-score': 0.3188845052902171, 'support': 3257147}}
[[158782 241104 534037]
 [219294 352481 783535]
 [128499 248129 591286]]
Evaluating performance on  train set...
5165/5165 - 72s - 72s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0990399
{'0': {'precision': 0.34072336316563734, 'recall': 0.11934660819191341, 'f1-score': 0.17677388335331073, 'support': 440532}, '1': {'precision': 0.34065992425575137, 'recall': 0.23571792763535643, 'f1-score': 0.27863545106918447, 'support': 435406}, '2': {'precision': 0.34755192621503533, 'recall': 0.6749984310701894, 'f1-score': 0.45884684942735554, 'support': 446164}, 'accuracy': 0.34518441088509055, 'macro avg': {'precision': 0.3429784045454747, 'recall': 0.3433543222991531, 'f1-score': 0.3047520612832836, 'support': 1322102}, 'weighted avg': {'precision': 0.34300687633056237, 'recall': 0.34518441088509055, 'f1-score': 0.30550974532792224, 'support': 1322102}}
[[ 52576  99601 288355]
 [ 55770 102633 277003]
 [ 45961  99043 301160]]
Evaluating performance on  val set...
1903/1903 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0987315
{'0': {'precision': 0.35219358351010904, 'recall': 0.11563376375234984, 'f1-score': 0.17410469853466595, 'support': 162245}, '1': {'precision': 0.3473798675330044, 'recall': 0.2352389878163074, 'f1-score': 0.2805171431577954, 'support': 164318}, '2': {'precision': 0.34057768763683954, 'recall': 0.6845179104570641, 'f1-score': 0.45484836248045646, 'support': 160437}, 'accuracy': 0.3434024640657084, 'macro avg': {'precision': 0.34671704622665106, 'recall': 0.34513022067524046, 'f1-score': 0.30315673472430593, 'support': 487000}, 'weighted avg': {'precision': 0.34674266016689426, 'recall': 0.3434024640657084, 'f1-score': 0.3024972063130113, 'support': 487000}}
[[ 18761  36939 106545]
 [ 19573  38654 106091]
 [ 14935  35680 109822]]
training model: results/AAPL/W4/deepVOL_L3/h1000
Epoch 1/50
5165/5165 - 179s - loss: 3.2520 - accuracy1000: 0.3882 - val_loss: 3.3733 - val_accuracy1000: 0.3224 - 179s/epoch - 35ms/step
Epoch 2/50
5165/5165 - 172s - loss: 3.2598 - accuracy1000: 0.3836 - val_loss: 3.3472 - val_accuracy1000: 0.3290 - 172s/epoch - 33ms/step
Epoch 3/50
5165/5165 - 172s - loss: 3.2578 - accuracy1000: 0.3832 - val_loss: 3.3385 - val_accuracy1000: 0.3198 - 172s/epoch - 33ms/step
Epoch 4/50
5165/5165 - 173s - loss: 3.2556 - accuracy1000: 0.3879 - val_loss: 3.3603 - val_accuracy1000: 0.3234 - 173s/epoch - 34ms/step
Epoch 5/50
5165/5165 - 172s - loss: 3.2577 - accuracy1000: 0.3849 - val_loss: 3.3665 - val_accuracy1000: 0.3307 - 172s/epoch - 33ms/step
Epoch 6/50
5165/5165 - 172s - loss: 3.2594 - accuracy1000: 0.3856 - val_loss: 3.3438 - val_accuracy1000: 0.3359 - 172s/epoch - 33ms/step
Epoch 7/50
5165/5165 - 173s - loss: 3.2539 - accuracy1000: 0.3895 - val_loss: 3.3450 - val_accuracy1000: 0.3326 - 173s/epoch - 34ms/step
Epoch 8/50
5165/5165 - 172s - loss: 3.2467 - accuracy1000: 0.3943 - val_loss: 3.3570 - val_accuracy1000: 0.3290 - 172s/epoch - 33ms/step
Epoch 9/50
5165/5165 - 173s - loss: 3.2417 - accuracy1000: 0.3975 - val_loss: 3.3223 - val_accuracy1000: 0.3297 - 173s/epoch - 33ms/step
Epoch 10/50
5165/5165 - 170s - loss: 3.2311 - accuracy1000: 0.4061 - val_loss: 3.3271 - val_accuracy1000: 0.3264 - 170s/epoch - 33ms/step
Epoch 11/50
5165/5165 - 174s - loss: 3.2199 - accuracy1000: 0.4131 - val_loss: 3.3235 - val_accuracy1000: 0.3259 - 174s/epoch - 34ms/step
Epoch 12/50
5165/5165 - 172s - loss: 3.2115 - accuracy1000: 0.4173 - val_loss: 3.3199 - val_accuracy1000: 0.3259 - 172s/epoch - 33ms/step
Epoch 13/50
5165/5165 - 173s - loss: 3.2052 - accuracy1000: 0.4209 - val_loss: 3.3143 - val_accuracy1000: 0.3286 - 173s/epoch - 34ms/step
Epoch 14/50
5165/5165 - 173s - loss: 3.1996 - accuracy1000: 0.4230 - val_loss: 3.3275 - val_accuracy1000: 0.3220 - 173s/epoch - 33ms/step
Epoch 15/50
5165/5165 - 170s - loss: 3.1952 - accuracy1000: 0.4252 - val_loss: 3.3803 - val_accuracy1000: 0.3172 - 170s/epoch - 33ms/step
Epoch 16/50
5165/5165 - 171s - loss: 3.1922 - accuracy1000: 0.4265 - val_loss: 3.3704 - val_accuracy1000: 0.3179 - 171s/epoch - 33ms/step
Epoch 17/50
5165/5165 - 170s - loss: 3.1886 - accuracy1000: 0.4279 - val_loss: 3.3631 - val_accuracy1000: 0.3190 - 170s/epoch - 33ms/step
Epoch 18/50
5165/5165 - 171s - loss: 3.1855 - accuracy1000: 0.4294 - val_loss: 3.3549 - val_accuracy1000: 0.3216 - 171s/epoch - 33ms/step
Epoch 19/50
5165/5165 - 173s - loss: 3.1810 - accuracy1000: 0.4316 - val_loss: 3.3558 - val_accuracy1000: 0.3241 - 173s/epoch - 34ms/step
Epoch 20/50
5165/5165 - 172s - loss: 3.1773 - accuracy1000: 0.4327 - val_loss: 3.3568 - val_accuracy1000: 0.3260 - 172s/epoch - 33ms/step
Epoch 21/50
5165/5165 - 171s - loss: 3.1739 - accuracy1000: 0.4339 - val_loss: 3.3426 - val_accuracy1000: 0.3268 - 171s/epoch - 33ms/step
Epoch 22/50
5165/5165 - 171s - loss: 3.1709 - accuracy1000: 0.4349 - val_loss: 3.3467 - val_accuracy1000: 0.3262 - 171s/epoch - 33ms/step
Epoch 23/50
5165/5165 - 170s - loss: 3.1679 - accuracy1000: 0.4361 - val_loss: 3.3490 - val_accuracy1000: 0.3277 - 170s/epoch - 33ms/step
testing model: results/AAPL/W4/deepVOL_L3/h1000
Evaluating performance on  test set...
12724/12724 - 173s - 173s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1075197
{'0': {'precision': 0.28035628810345914, 'recall': 0.18431367279014868, 'f1-score': 0.22240945832086156, 'support': 892956}, '1': {'precision': 0.46149843739055896, 'recall': 0.09505992857761174, 'f1-score': 0.15764746764954699, 'support': 1455566}, '2': {'precision': 0.2865431226334497, 'recall': 0.7474876874398129, 'f1-score': 0.41427673915032476, 'support': 908625}, 'accuracy': 0.3015325989278347, 'macro avg': {'precision': 0.34279928270915594, 'recall': 0.34228709626919107, 'f1-score': 0.2647778883735778, 'support': 3257147}, 'weighted avg': {'precision': 0.36303166818118954, 'recall': 0.3015325989278347, 'f1-score': 0.2469923390843605, 'support': 3257147}}
[[ 164584   81031  647341]
 [ 273452  138366 1043748]
 [ 149017   80422  679186]]
Evaluating performance on  train set...
5165/5165 - 72s - 72s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017828
{'0': {'precision': 0.3200885485099617, 'recall': 0.14260854116033866, 'f1-score': 0.19730991166450793, 'support': 439027}, '1': {'precision': 0.34817826459583184, 'recall': 0.07614608857842958, 'f1-score': 0.12496295712779884, 'support': 437488}, '2': {'precision': 0.34635655906676693, 'recall': 0.80126439954487, 'f1-score': 0.48364955039650176, 'support': 445587}, 'accuracy': 0.34260215928876897, 'macro avg': {'precision': 0.3382077907241869, 'recall': 0.3400063430945461, 'f1-score': 0.2686408063962695, 'support': 1322102}, 'weighted avg': {'precision': 0.33823661706363634, 'recall': 0.34260215928876897, 'f1-score': 0.2698748848339889, 'support': 1322102}}
[[ 62609  30829 345589]
 [ 75972  33313 328203]
 [ 57018  31536 357033]]
Evaluating performance on  val set...
1903/1903 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.10387
{'0': {'precision': 0.34328970101613515, 'recall': 0.146740184880366, 'f1-score': 0.20559723251358092, 'support': 159779}, '1': {'precision': 0.3535519929401383, 'recall': 0.06937654046628147, 'f1-score': 0.11599224080525772, 'support': 173243}, '2': {'precision': 0.324049211477826, 'recall': 0.8096221538141812, 'f1-score': 0.462845633347875, 'support': 153978}, 'accuracy': 0.3288069815195072, 'macro avg': {'precision': 0.3402969684780331, 'recall': 0.3419129597202762, 'f1-score': 0.2614783688889046, 'support': 487000}, 'weighted avg': {'precision': 0.34085696619408246, 'recall': 0.3288069815195072, 'f1-score': 0.25505751318121517, 'support': 487000}}
[[ 23446  11531 124802]
 [ 25983  12019 135241]
 [ 18869  10445 124664]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :        50 (peak)  24.54 (ave)

============================================
