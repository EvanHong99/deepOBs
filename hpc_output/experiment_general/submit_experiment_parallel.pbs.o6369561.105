This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/EXC_orderbooks/EXC_orderbooks_2020-01-22.csv
data/EXC_orderbooks/EXC_orderbooks_2020-01-14.csv
data/EXC_orderbooks/EXC_orderbooks_2020-01-02.csv
data/EXC_orderbooks/EXC_orderbooks_2020-01-10.csv
data/EXC_orderbooks/EXC_orderbooks_2020-01-06.csv
data/EXC_orderbooks/EXC_orderbooks_2020-01-08.csv
data/EXC_orderbooks/EXC_orderbooks_2020-01-03.csv
data/EXC_orderbooks/EXC_orderbooks_2020-01-24.csv
data/EXC_orderbooks/EXC_orderbooks_2020-01-07.csv
data/EXC_orderbooks/EXC_orderbooks_2020-01-09.csv
data/EXC_orderbooks/EXC_orderbooks_2019-12-31.csv
data/EXC_orderbooks/EXC_orderbooks_2020-01-16.csv
data/EXC_orderbooks/EXC_orderbooks_2020-01-15.csv
training model: results/EXC/W10/deepLOB_L1/h10
Epoch 1/50
1060/1060 - 28s - loss: 2.6568 - accuracy10: 0.4613 - val_loss: 2.5834 - val_accuracy10: 0.5376 - 28s/epoch - 26ms/step
Epoch 2/50
1060/1060 - 17s - loss: 2.4552 - accuracy10: 0.5306 - val_loss: 2.4379 - val_accuracy10: 0.5811 - 17s/epoch - 16ms/step
Epoch 3/50
1060/1060 - 16s - loss: 2.3376 - accuracy10: 0.5820 - val_loss: 2.3954 - val_accuracy10: 0.5561 - 16s/epoch - 15ms/step
Epoch 4/50
1060/1060 - 16s - loss: 2.2534 - accuracy10: 0.6190 - val_loss: 2.3593 - val_accuracy10: 0.5730 - 16s/epoch - 15ms/step
Epoch 5/50
1060/1060 - 16s - loss: 2.2055 - accuracy10: 0.6375 - val_loss: 2.3163 - val_accuracy10: 0.5863 - 16s/epoch - 15ms/step
Epoch 6/50
1060/1060 - 16s - loss: 2.1721 - accuracy10: 0.6451 - val_loss: 2.2974 - val_accuracy10: 0.6103 - 16s/epoch - 15ms/step
Epoch 7/50
1060/1060 - 16s - loss: 2.1485 - accuracy10: 0.6517 - val_loss: 2.2749 - val_accuracy10: 0.6473 - 16s/epoch - 15ms/step
Epoch 8/50
1060/1060 - 16s - loss: 2.1262 - accuracy10: 0.6578 - val_loss: 2.2408 - val_accuracy10: 0.6436 - 16s/epoch - 15ms/step
Epoch 9/50
1060/1060 - 16s - loss: 2.1076 - accuracy10: 0.6598 - val_loss: 2.2290 - val_accuracy10: 0.6689 - 16s/epoch - 15ms/step
Epoch 10/50
1060/1060 - 16s - loss: 2.0921 - accuracy10: 0.6615 - val_loss: 2.2354 - val_accuracy10: 0.6757 - 16s/epoch - 16ms/step
Epoch 11/50
1060/1060 - 16s - loss: 2.0772 - accuracy10: 0.6630 - val_loss: 2.2184 - val_accuracy10: 0.6522 - 16s/epoch - 15ms/step
Epoch 12/50
1060/1060 - 16s - loss: 2.0680 - accuracy10: 0.6624 - val_loss: 2.2151 - val_accuracy10: 0.6755 - 16s/epoch - 15ms/step
Epoch 13/50
1060/1060 - 16s - loss: 2.0543 - accuracy10: 0.6643 - val_loss: 2.1991 - val_accuracy10: 0.6705 - 16s/epoch - 15ms/step
Epoch 14/50
1060/1060 - 16s - loss: 2.0460 - accuracy10: 0.6639 - val_loss: 2.2297 - val_accuracy10: 0.6769 - 16s/epoch - 15ms/step
Epoch 15/50
1060/1060 - 16s - loss: 2.0350 - accuracy10: 0.6663 - val_loss: 2.2021 - val_accuracy10: 0.6731 - 16s/epoch - 15ms/step
Epoch 16/50
1060/1060 - 16s - loss: 2.0290 - accuracy10: 0.6662 - val_loss: 2.2198 - val_accuracy10: 0.6924 - 16s/epoch - 15ms/step
Epoch 17/50
1060/1060 - 16s - loss: 2.0202 - accuracy10: 0.6667 - val_loss: 2.2073 - val_accuracy10: 0.6707 - 16s/epoch - 15ms/step
Epoch 18/50
1060/1060 - 16s - loss: 2.0124 - accuracy10: 0.6674 - val_loss: 2.1568 - val_accuracy10: 0.6640 - 16s/epoch - 15ms/step
Epoch 19/50
1060/1060 - 16s - loss: 2.0054 - accuracy10: 0.6672 - val_loss: 2.1931 - val_accuracy10: 0.6760 - 16s/epoch - 15ms/step
Epoch 20/50
1060/1060 - 16s - loss: 1.9974 - accuracy10: 0.6688 - val_loss: 2.1921 - val_accuracy10: 0.6778 - 16s/epoch - 15ms/step
Epoch 21/50
1060/1060 - 16s - loss: 1.9900 - accuracy10: 0.6688 - val_loss: 2.1767 - val_accuracy10: 0.6519 - 16s/epoch - 15ms/step
Epoch 22/50
1060/1060 - 16s - loss: 1.9836 - accuracy10: 0.6703 - val_loss: 2.2037 - val_accuracy10: 0.6846 - 16s/epoch - 15ms/step
Epoch 23/50
1060/1060 - 16s - loss: 1.9776 - accuracy10: 0.6717 - val_loss: 2.2254 - val_accuracy10: 0.6902 - 16s/epoch - 15ms/step
Epoch 24/50
1060/1060 - 16s - loss: 1.9708 - accuracy10: 0.6702 - val_loss: 2.2223 - val_accuracy10: 0.6811 - 16s/epoch - 15ms/step
Epoch 25/50
1060/1060 - 16s - loss: 1.9622 - accuracy10: 0.6708 - val_loss: 2.2410 - val_accuracy10: 0.6897 - 16s/epoch - 15ms/step
Epoch 26/50
1060/1060 - 16s - loss: 1.9546 - accuracy10: 0.6721 - val_loss: 2.2136 - val_accuracy10: 0.6929 - 16s/epoch - 15ms/step
Epoch 27/50
1060/1060 - 16s - loss: 1.9542 - accuracy10: 0.6721 - val_loss: 2.2584 - val_accuracy10: 0.6950 - 16s/epoch - 15ms/step
Epoch 28/50
1060/1060 - 16s - loss: 1.9430 - accuracy10: 0.6719 - val_loss: 2.2080 - val_accuracy10: 0.6582 - 16s/epoch - 15ms/step
testing model: results/EXC/W10/deepLOB_L1/h10
Evaluating performance on  test set...
5267/5267 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99350053
{'0': {'precision': 0.2976084279827118, 'recall': 0.6258727631831003, 'f1-score': 0.4033975157262828, 'support': 151387}, '1': {'precision': 0.9146233371838742, 'recall': 0.48116028993871385, 'f1-score': 0.6305854597411119, 'support': 1046566}, '2': {'precision': 0.22571565094554188, 'recall': 0.7200271572725578, 'f1-score': 0.34369047713607154, 'support': 150236}, 'accuracy': 0.5240281592566027, 'macro avg': {'precision': 0.47931580537070934, 'recall': 0.6090200701314573, 'f1-score': 0.45922448420115547, 'support': 1348189}, 'weighted avg': {'precision': 0.7685705425023136, 'recall': 0.5240281592566027, 'f1-score': 0.5731044567903211, 'support': 1348189}}
[[ 94749  27562  29076]
 [201001 503566 341999]
 [ 22618  19444 108174]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72470385
{'0': {'precision': 0.2853012515765984, 'recall': 0.6683789435403219, 'f1-score': 0.39990208477826283, 'support': 21998}, '1': {'precision': 0.9434727831919072, 'recall': 0.6735312012274158, 'f1-score': 0.7859700571075784, 'support': 226818}, '2': {'precision': 0.26396913815174894, 'recall': 0.6797790350603644, 'f1-score': 0.38027238857114376, 'support': 22447}, 'accuracy': 0.6736303882210254, 'macro avg': {'precision': 0.4975810576400848, 'recall': 0.673896393276034, 'f1-score': 0.522048176818995, 'support': 271263}, 'weighted avg': {'precision': 0.8338696464843947, 'recall': 0.6736303882210254, 'f1-score': 0.7210905165106755, 'support': 271263}}
[[ 14703   4574   2721]
 [ 34223 152769  39826]
 [  2609   4579  15259]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73319095
{'0': {'precision': 0.28099810032345846, 'recall': 0.6846384788591443, 'f1-score': 0.39845655418441267, 'support': 7994}, '1': {'precision': 0.9504401480872069, 'recall': 0.6610929899856939, 'f1-score': 0.7797907526155923, 'support': 87375}, '2': {'precision': 0.23965621490887104, 'recall': 0.6904317531417196, 'f1-score': 0.35580776506043416, 'support': 8037}, 'accuracy': 0.665193509080711, 'macro avg': {'precision': 0.49036482110651214, 'recall': 0.6787210739955193, 'f1-score': 0.5113516906201464, 'support': 103406}, 'weighted avg': {'precision': 0.843443550203354, 'recall': 0.665193509080711, 'f1-score': 0.7173578487875779, 'support': 103406}}
[[ 5473  1588   933]
 [12940 57763 16672]
 [ 1064  1424  5549]]
training model: results/EXC/W10/deepLOB_L1/h20
Epoch 1/50
1060/1060 - 18s - loss: 2.6652 - accuracy20: 0.4672 - val_loss: 2.6030 - val_accuracy20: 0.5029 - 18s/epoch - 17ms/step
Epoch 2/50
1060/1060 - 16s - loss: 2.4809 - accuracy20: 0.5249 - val_loss: 2.5845 - val_accuracy20: 0.5455 - 16s/epoch - 15ms/step
Epoch 3/50
1060/1060 - 16s - loss: 2.3688 - accuracy20: 0.5789 - val_loss: 2.5384 - val_accuracy20: 0.5584 - 16s/epoch - 15ms/step
Epoch 4/50
1060/1060 - 16s - loss: 2.3029 - accuracy20: 0.6047 - val_loss: 2.5261 - val_accuracy20: 0.6107 - 16s/epoch - 15ms/step
Epoch 5/50
1060/1060 - 16s - loss: 2.2570 - accuracy20: 0.6175 - val_loss: 2.4383 - val_accuracy20: 0.6023 - 16s/epoch - 15ms/step
Epoch 6/50
1060/1060 - 16s - loss: 2.2216 - accuracy20: 0.6271 - val_loss: 2.4118 - val_accuracy20: 0.6195 - 16s/epoch - 15ms/step
Epoch 7/50
1060/1060 - 16s - loss: 2.1978 - accuracy20: 0.6298 - val_loss: 2.4213 - val_accuracy20: 0.6199 - 16s/epoch - 15ms/step
Epoch 8/50
1060/1060 - 16s - loss: 2.1807 - accuracy20: 0.6338 - val_loss: 2.4172 - val_accuracy20: 0.6241 - 16s/epoch - 15ms/step
Epoch 9/50
1060/1060 - 16s - loss: 2.1623 - accuracy20: 0.6346 - val_loss: 2.4347 - val_accuracy20: 0.6439 - 16s/epoch - 15ms/step
Epoch 10/50
1060/1060 - 16s - loss: 2.1513 - accuracy20: 0.6360 - val_loss: 2.4079 - val_accuracy20: 0.6497 - 16s/epoch - 16ms/step
Epoch 11/50
1060/1060 - 16s - loss: 2.1373 - accuracy20: 0.6382 - val_loss: 2.3995 - val_accuracy20: 0.6309 - 16s/epoch - 15ms/step
Epoch 12/50
1060/1060 - 16s - loss: 2.1257 - accuracy20: 0.6386 - val_loss: 2.4738 - val_accuracy20: 0.6405 - 16s/epoch - 15ms/step
Epoch 13/50
1060/1060 - 16s - loss: 2.1172 - accuracy20: 0.6393 - val_loss: 2.3983 - val_accuracy20: 0.6427 - 16s/epoch - 15ms/step
Epoch 14/50
1060/1060 - 16s - loss: 2.1102 - accuracy20: 0.6408 - val_loss: 2.4023 - val_accuracy20: 0.6376 - 16s/epoch - 15ms/step
Epoch 15/50
1060/1060 - 16s - loss: 2.1041 - accuracy20: 0.6414 - val_loss: 2.4024 - val_accuracy20: 0.6614 - 16s/epoch - 16ms/step
Epoch 16/50
1060/1060 - 16s - loss: 2.0957 - accuracy20: 0.6421 - val_loss: 2.4055 - val_accuracy20: 0.6450 - 16s/epoch - 15ms/step
Epoch 17/50
1060/1060 - 16s - loss: 2.0873 - accuracy20: 0.6438 - val_loss: 2.3928 - val_accuracy20: 0.6529 - 16s/epoch - 15ms/step
Epoch 18/50
1060/1060 - 16s - loss: 2.0831 - accuracy20: 0.6445 - val_loss: 2.4367 - val_accuracy20: 0.6692 - 16s/epoch - 15ms/step
Epoch 19/50
1060/1060 - 16s - loss: 2.0747 - accuracy20: 0.6443 - val_loss: 2.4079 - val_accuracy20: 0.6807 - 16s/epoch - 15ms/step
Epoch 20/50
1060/1060 - 16s - loss: 2.0678 - accuracy20: 0.6460 - val_loss: 2.4143 - val_accuracy20: 0.6530 - 16s/epoch - 15ms/step
Epoch 21/50
1060/1060 - 16s - loss: 2.0652 - accuracy20: 0.6476 - val_loss: 2.4063 - val_accuracy20: 0.6669 - 16s/epoch - 15ms/step
Epoch 22/50
1060/1060 - 16s - loss: 2.0583 - accuracy20: 0.6469 - val_loss: 2.3934 - val_accuracy20: 0.6701 - 16s/epoch - 15ms/step
Epoch 23/50
1060/1060 - 16s - loss: 2.0542 - accuracy20: 0.6487 - val_loss: 2.3775 - val_accuracy20: 0.6776 - 16s/epoch - 15ms/step
Epoch 24/50
1060/1060 - 16s - loss: 2.0481 - accuracy20: 0.6479 - val_loss: 2.4461 - val_accuracy20: 0.6775 - 16s/epoch - 15ms/step
Epoch 25/50
1060/1060 - 16s - loss: 2.0416 - accuracy20: 0.6490 - val_loss: 2.4236 - val_accuracy20: 0.6631 - 16s/epoch - 15ms/step
Epoch 26/50
1060/1060 - 16s - loss: 2.0373 - accuracy20: 0.6497 - val_loss: 2.4090 - val_accuracy20: 0.6741 - 16s/epoch - 15ms/step
Epoch 27/50
1060/1060 - 16s - loss: 2.0358 - accuracy20: 0.6484 - val_loss: 2.3733 - val_accuracy20: 0.6858 - 16s/epoch - 15ms/step
Epoch 28/50
1060/1060 - 16s - loss: 2.0283 - accuracy20: 0.6499 - val_loss: 2.3703 - val_accuracy20: 0.6822 - 16s/epoch - 15ms/step
Epoch 29/50
1060/1060 - 16s - loss: 2.0261 - accuracy20: 0.6501 - val_loss: 2.3538 - val_accuracy20: 0.6841 - 16s/epoch - 16ms/step
Epoch 30/50
1060/1060 - 16s - loss: 2.0195 - accuracy20: 0.6505 - val_loss: 2.3679 - val_accuracy20: 0.6874 - 16s/epoch - 15ms/step
Epoch 31/50
1060/1060 - 16s - loss: 2.0134 - accuracy20: 0.6517 - val_loss: 2.3828 - val_accuracy20: 0.6822 - 16s/epoch - 15ms/step
Epoch 32/50
1060/1060 - 16s - loss: 2.0112 - accuracy20: 0.6509 - val_loss: 2.4343 - val_accuracy20: 0.6774 - 16s/epoch - 16ms/step
Epoch 33/50
1060/1060 - 16s - loss: 2.0061 - accuracy20: 0.6508 - val_loss: 2.3903 - val_accuracy20: 0.6884 - 16s/epoch - 15ms/step
Epoch 34/50
1060/1060 - 16s - loss: 2.0007 - accuracy20: 0.6516 - val_loss: 2.4052 - val_accuracy20: 0.6813 - 16s/epoch - 15ms/step
Epoch 35/50
1060/1060 - 16s - loss: 1.9967 - accuracy20: 0.6526 - val_loss: 2.4279 - val_accuracy20: 0.6829 - 16s/epoch - 15ms/step
Epoch 36/50
1060/1060 - 16s - loss: 1.9921 - accuracy20: 0.6527 - val_loss: 2.4183 - val_accuracy20: 0.6934 - 16s/epoch - 15ms/step
Epoch 37/50
1060/1060 - 16s - loss: 1.9877 - accuracy20: 0.6532 - val_loss: 2.3697 - val_accuracy20: 0.6760 - 16s/epoch - 15ms/step
Epoch 38/50
1060/1060 - 16s - loss: 1.9830 - accuracy20: 0.6534 - val_loss: 2.3639 - val_accuracy20: 0.6759 - 16s/epoch - 15ms/step
Epoch 39/50
1060/1060 - 16s - loss: 1.9797 - accuracy20: 0.6542 - val_loss: 2.4002 - val_accuracy20: 0.6774 - 16s/epoch - 15ms/step
testing model: results/EXC/W10/deepLOB_L1/h20
Evaluating performance on  test set...
5267/5267 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94764125
{'0': {'precision': 0.41492401636266624, 'recall': 0.5181302654762433, 'f1-score': 0.4608192576465217, 'support': 202617}, '1': {'precision': 0.8227681007312787, 'recall': 0.5644095473390662, 'f1-score': 0.6695294895282443, 'support': 943090}, '2': {'precision': 0.2924803391153996, 'recall': 0.6474501437164785, 'f1-score': 0.40293711301707213, 'support': 202482}, 'accuracy': 0.5699260266921032, 'macro avg': {'precision': 0.5100574854031149, 'recall': 0.5766633188439293, 'f1-score': 0.5110952867306127, 'support': 1348189}, 'weighted avg': {'precision': 0.6818309833167162, 'recall': 0.5699260266921032, 'f1-score': 0.5981237751707512, 'support': 1348189}}
[[104982  68911  28724]
 [122397 532289 288404]
 [ 25636  45749 131097]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7102066
{'0': {'precision': 0.36590146119961964, 'recall': 0.6143620487423432, 'f1-score': 0.4586439647309212, 'support': 30692}, '1': {'precision': 0.8900457630762616, 'recall': 0.6922209641742986, 'f1-score': 0.7787667220260458, 'support': 209319}, '2': {'precision': 0.3419864758057434, 'recall': 0.6230321259439396, 'f1-score': 0.4415843605066507, 'support': 31252}, 'accuracy': 0.6754404397208613, 'macro avg': {'precision': 0.5326445666938749, 'recall': 0.6432050462868605, 'f1-score': 0.5596650157545392, 'support': 271263}, 'weighted avg': {'precision': 0.7676000710394703, 'recall': 0.6754404397208613, 'f1-score': 0.7036999756245605, 'support': 271263}}
[[ 18856   9060   2776]
 [ 29736 144895  34688]
 [  2941   8840  19471]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7003484
{'0': {'precision': 0.38129536262396807, 'recall': 0.6176628971459343, 'f1-score': 0.47151519303895034, 'support': 11142}, '1': {'precision': 0.9004757313777244, 'recall': 0.702550064121535, 'f1-score': 0.7892939522189975, 'support': 81096}, '2': {'precision': 0.3192067372996468, 'recall': 0.6312679083094556, 'f1-score': 0.4240091417573825, 'support': 11168}, 'accuracy': 0.6857048913989517, 'macro avg': {'precision': 0.5336592771004464, 'recall': 0.6504936231923083, 'f1-score': 0.5616060956717768, 'support': 103406}, 'weighted avg': {'precision': 0.7817561232842064, 'recall': 0.6857048913989517, 'f1-score': 0.7156019836870031, 'support': 103406}}
[[ 6882  3295   965]
 [10051 56974 14071]
 [ 1116  3002  7050]]
training model: results/EXC/W10/deepLOB_L1/h30
Epoch 1/50
1060/1060 - 24s - loss: 2.7052 - accuracy30: 0.4633 - val_loss: 2.7427 - val_accuracy30: 0.5039 - 24s/epoch - 23ms/step
Epoch 2/50
1060/1060 - 17s - loss: 2.5685 - accuracy30: 0.5038 - val_loss: 2.6527 - val_accuracy30: 0.5198 - 17s/epoch - 16ms/step
Epoch 3/50
1060/1060 - 16s - loss: 2.4790 - accuracy30: 0.5407 - val_loss: 2.6270 - val_accuracy30: 0.5666 - 16s/epoch - 15ms/step
Epoch 4/50
1060/1060 - 16s - loss: 2.4072 - accuracy30: 0.5739 - val_loss: 2.5691 - val_accuracy30: 0.5566 - 16s/epoch - 15ms/step
Epoch 5/50
1060/1060 - 16s - loss: 2.3551 - accuracy30: 0.5925 - val_loss: 2.5728 - val_accuracy30: 0.5863 - 16s/epoch - 15ms/step
Epoch 6/50
1060/1060 - 16s - loss: 2.3193 - accuracy30: 0.6005 - val_loss: 2.5418 - val_accuracy30: 0.5990 - 16s/epoch - 16ms/step
Epoch 7/50
1060/1060 - 16s - loss: 2.2898 - accuracy30: 0.6074 - val_loss: 2.5139 - val_accuracy30: 0.6033 - 16s/epoch - 15ms/step
Epoch 8/50
1060/1060 - 16s - loss: 2.2734 - accuracy30: 0.6095 - val_loss: 2.4712 - val_accuracy30: 0.6184 - 16s/epoch - 15ms/step
Epoch 9/50
1060/1060 - 16s - loss: 2.2564 - accuracy30: 0.6119 - val_loss: 2.4812 - val_accuracy30: 0.6275 - 16s/epoch - 15ms/step
Epoch 10/50
1060/1060 - 16s - loss: 2.2403 - accuracy30: 0.6149 - val_loss: 2.5020 - val_accuracy30: 0.6230 - 16s/epoch - 15ms/step
Epoch 11/50
1060/1060 - 16s - loss: 2.2308 - accuracy30: 0.6164 - val_loss: 2.4696 - val_accuracy30: 0.6240 - 16s/epoch - 15ms/step
Epoch 12/50
1060/1060 - 16s - loss: 2.2198 - accuracy30: 0.6180 - val_loss: 2.4712 - val_accuracy30: 0.6274 - 16s/epoch - 15ms/step
Epoch 13/50
1060/1060 - 16s - loss: 2.2084 - accuracy30: 0.6200 - val_loss: 2.4616 - val_accuracy30: 0.6355 - 16s/epoch - 15ms/step
Epoch 14/50
1060/1060 - 16s - loss: 2.2026 - accuracy30: 0.6193 - val_loss: 2.4633 - val_accuracy30: 0.6331 - 16s/epoch - 15ms/step
Epoch 15/50
1060/1060 - 16s - loss: 2.1948 - accuracy30: 0.6200 - val_loss: 2.4562 - val_accuracy30: 0.6456 - 16s/epoch - 15ms/step
Epoch 16/50
1060/1060 - 16s - loss: 2.1890 - accuracy30: 0.6207 - val_loss: 2.4498 - val_accuracy30: 0.6350 - 16s/epoch - 15ms/step
Epoch 17/50
1060/1060 - 16s - loss: 2.1802 - accuracy30: 0.6226 - val_loss: 2.4452 - val_accuracy30: 0.6278 - 16s/epoch - 15ms/step
Epoch 18/50
1060/1060 - 16s - loss: 2.1774 - accuracy30: 0.6240 - val_loss: 2.4654 - val_accuracy30: 0.6469 - 16s/epoch - 15ms/step
Epoch 19/50
1060/1060 - 16s - loss: 2.1709 - accuracy30: 0.6234 - val_loss: 2.4570 - val_accuracy30: 0.6453 - 16s/epoch - 15ms/step
Epoch 20/50
1060/1060 - 16s - loss: 2.1663 - accuracy30: 0.6248 - val_loss: 2.4794 - val_accuracy30: 0.6335 - 16s/epoch - 15ms/step
Epoch 21/50
1060/1060 - 16s - loss: 2.1615 - accuracy30: 0.6240 - val_loss: 2.4589 - val_accuracy30: 0.6460 - 16s/epoch - 15ms/step
Epoch 22/50
1060/1060 - 16s - loss: 2.1552 - accuracy30: 0.6265 - val_loss: 2.4409 - val_accuracy30: 0.6325 - 16s/epoch - 15ms/step
Epoch 23/50
1060/1060 - 16s - loss: 2.1494 - accuracy30: 0.6268 - val_loss: 2.4641 - val_accuracy30: 0.6296 - 16s/epoch - 15ms/step
Epoch 24/50
1060/1060 - 16s - loss: 2.1471 - accuracy30: 0.6259 - val_loss: 2.4820 - val_accuracy30: 0.6353 - 16s/epoch - 15ms/step
Epoch 25/50
1060/1060 - 16s - loss: 2.1414 - accuracy30: 0.6269 - val_loss: 2.4636 - val_accuracy30: 0.6398 - 16s/epoch - 15ms/step
Epoch 26/50
1060/1060 - 16s - loss: 2.1392 - accuracy30: 0.6268 - val_loss: 2.4481 - val_accuracy30: 0.6392 - 16s/epoch - 15ms/step
Epoch 27/50
1060/1060 - 16s - loss: 2.1323 - accuracy30: 0.6281 - val_loss: 2.5381 - val_accuracy30: 0.6494 - 16s/epoch - 15ms/step
Epoch 28/50
1060/1060 - 16s - loss: 2.1289 - accuracy30: 0.6288 - val_loss: 2.5285 - val_accuracy30: 0.6385 - 16s/epoch - 15ms/step
Epoch 29/50
1060/1060 - 16s - loss: 2.1245 - accuracy30: 0.6284 - val_loss: 2.4959 - val_accuracy30: 0.6406 - 16s/epoch - 15ms/step
Epoch 30/50
1060/1060 - 16s - loss: 2.1198 - accuracy30: 0.6297 - val_loss: 2.5163 - val_accuracy30: 0.6322 - 16s/epoch - 15ms/step
Epoch 31/50
1060/1060 - 16s - loss: 2.1143 - accuracy30: 0.6301 - val_loss: 2.4874 - val_accuracy30: 0.6346 - 16s/epoch - 15ms/step
Epoch 32/50
1060/1060 - 16s - loss: 2.1096 - accuracy30: 0.6301 - val_loss: 2.4967 - val_accuracy30: 0.6233 - 16s/epoch - 15ms/step
testing model: results/EXC/W10/deepLOB_L1/h30
Evaluating performance on  test set...
5267/5267 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.986951
{'0': {'precision': 0.4572403180508737, 'recall': 0.4702428422083476, 'f1-score': 0.4636504379710735, 'support': 242009}, '1': {'precision': 0.7640395105917984, 'recall': 0.514548457192525, 'f1-score': 0.6149523713888995, 'support': 862875}, '2': {'precision': 0.3230815842898716, 'recall': 0.6880951891658618, 'f1-score': 0.4397072592919436, 'support': 243305}, 'accuracy': 0.5379149362589369, 'macro avg': {'precision': 0.5147871376441812, 'recall': 0.5576288295222448, 'f1-score': 0.5061033562173055, 'support': 1348189}, 'weighted avg': {'precision': 0.6293881864476858, 'recall': 0.5379149362589369, 'f1-score': 0.5561665174743041, 'support': 1348189}}
[[113803  85435  42771]
 [110884 443991 308000]
 [ 24204  51684 167417]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76177233
{'0': {'precision': 0.4110554099730356, 'recall': 0.5759785009179682, 'f1-score': 0.4797384896670176, 'support': 37583}, '1': {'precision': 0.8449570110167486, 'recall': 0.6577345013201252, 'f1-score': 0.739682594485108, 'support': 195436}, '2': {'precision': 0.36666716815357536, 'recall': 0.6372764355192971, 'f1-score': 0.46550094066639286, 'support': 38244}, 'accuracy': 0.6435230753917784, 'macro avg': {'precision': 0.5408931963811198, 'recall': 0.6236631459191302, 'f1-score': 0.5616406749395061, 'support': 271263}, 'weighted avg': {'precision': 0.7174090571030742, 'recall': 0.6435230753917784, 'f1-score': 0.6650123207654292, 'support': 271263}}
[[ 21647  12582   3354]
 [ 28148 128545  38743]
 [  2867  11005  24372]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7751195
{'0': {'precision': 0.41922129644185924, 'recall': 0.5881920447025955, 'f1-score': 0.4895361644841514, 'support': 13601}, '1': {'precision': 0.8581719225228109, 'recall': 0.6343627973020944, 'f1-score': 0.7294870050346987, 'support': 76059}, '2': {'precision': 0.3230604982206406, 'recall': 0.6604103011785246, 'f1-score': 0.43387659513454097, 'support': 13746}, 'accuracy': 0.6317525095255594, 'macro avg': {'precision': 0.5334845723951036, 'recall': 0.6276550477277382, 'f1-score': 0.550966588217797, 'support': 103406}, 'weighted avg': {'precision': 0.7293031034621698, 'recall': 0.6317525095255594, 'f1-score': 0.6586300714252799, 'support': 103406}}
[[ 8000  4466  1135]
 [ 9923 48249 17887]
 [ 1160  3508  9078]]
training model: results/EXC/W10/deepLOB_L1/h50
Epoch 1/50
1060/1060 - 19s - loss: 2.8123 - accuracy50: 0.4622 - val_loss: 2.8209 - val_accuracy50: 0.5113 - 19s/epoch - 18ms/step
Epoch 2/50
1060/1060 - 16s - loss: 2.7182 - accuracy50: 0.4797 - val_loss: 2.7641 - val_accuracy50: 0.5006 - 16s/epoch - 15ms/step
Epoch 3/50
1060/1060 - 16s - loss: 2.6546 - accuracy50: 0.5054 - val_loss: 2.7829 - val_accuracy50: 0.5298 - 16s/epoch - 15ms/step
Epoch 4/50
1060/1060 - 16s - loss: 2.6077 - accuracy50: 0.5271 - val_loss: 2.7784 - val_accuracy50: 0.5369 - 16s/epoch - 15ms/step
Epoch 5/50
1060/1060 - 16s - loss: 2.5687 - accuracy50: 0.5430 - val_loss: 2.7752 - val_accuracy50: 0.5341 - 16s/epoch - 15ms/step
Epoch 6/50
1060/1060 - 16s - loss: 2.5424 - accuracy50: 0.5554 - val_loss: 2.7980 - val_accuracy50: 0.5445 - 16s/epoch - 15ms/step
Epoch 7/50
1060/1060 - 16s - loss: 2.5168 - accuracy50: 0.5635 - val_loss: 2.7665 - val_accuracy50: 0.5591 - 16s/epoch - 15ms/step
Epoch 8/50
1060/1060 - 16s - loss: 2.4930 - accuracy50: 0.5719 - val_loss: 2.7682 - val_accuracy50: 0.5556 - 16s/epoch - 15ms/step
Epoch 9/50
1060/1060 - 16s - loss: 2.4760 - accuracy50: 0.5752 - val_loss: 2.7376 - val_accuracy50: 0.5669 - 16s/epoch - 15ms/step
Epoch 10/50
1060/1060 - 16s - loss: 2.4545 - accuracy50: 0.5808 - val_loss: 2.7373 - val_accuracy50: 0.5678 - 16s/epoch - 15ms/step
Epoch 11/50
1060/1060 - 16s - loss: 2.4396 - accuracy50: 0.5839 - val_loss: 2.7405 - val_accuracy50: 0.5648 - 16s/epoch - 15ms/step
Epoch 12/50
1060/1060 - 16s - loss: 2.4227 - accuracy50: 0.5864 - val_loss: 2.7003 - val_accuracy50: 0.5740 - 16s/epoch - 15ms/step
Epoch 13/50
1060/1060 - 16s - loss: 2.4085 - accuracy50: 0.5896 - val_loss: 2.6984 - val_accuracy50: 0.5638 - 16s/epoch - 15ms/step
Epoch 14/50
1060/1060 - 16s - loss: 2.4011 - accuracy50: 0.5911 - val_loss: 2.7150 - val_accuracy50: 0.5709 - 16s/epoch - 15ms/step
Epoch 15/50
1060/1060 - 16s - loss: 2.3917 - accuracy50: 0.5928 - val_loss: 2.7284 - val_accuracy50: 0.5730 - 16s/epoch - 15ms/step
Epoch 16/50
1060/1060 - 16s - loss: 2.3833 - accuracy50: 0.5932 - val_loss: 2.7382 - val_accuracy50: 0.5748 - 16s/epoch - 15ms/step
Epoch 17/50
1060/1060 - 16s - loss: 2.3759 - accuracy50: 0.5953 - val_loss: 2.7223 - val_accuracy50: 0.5619 - 16s/epoch - 15ms/step
Epoch 18/50
1060/1060 - 16s - loss: 2.3699 - accuracy50: 0.5951 - val_loss: 2.7470 - val_accuracy50: 0.5693 - 16s/epoch - 15ms/step
Epoch 19/50
1060/1060 - 16s - loss: 2.3636 - accuracy50: 0.5971 - val_loss: 2.7298 - val_accuracy50: 0.5743 - 16s/epoch - 15ms/step
Epoch 20/50
1060/1060 - 16s - loss: 2.3581 - accuracy50: 0.5968 - val_loss: 2.7652 - val_accuracy50: 0.5612 - 16s/epoch - 15ms/step
Epoch 21/50
1060/1060 - 16s - loss: 2.3515 - accuracy50: 0.5985 - val_loss: 2.7823 - val_accuracy50: 0.5601 - 16s/epoch - 15ms/step
Epoch 22/50
1060/1060 - 16s - loss: 2.3477 - accuracy50: 0.5988 - val_loss: 2.7292 - val_accuracy50: 0.5566 - 16s/epoch - 15ms/step
Epoch 23/50
1060/1060 - 16s - loss: 2.3424 - accuracy50: 0.5993 - val_loss: 2.7048 - val_accuracy50: 0.5787 - 16s/epoch - 15ms/step
testing model: results/EXC/W10/deepLOB_L1/h50
Evaluating performance on  test set...
5267/5267 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3193411
{'0': {'precision': 0.38354114934965333, 'recall': 0.5638378530297979, 'f1-score': 0.4565332726495738, 'support': 305994}, '1': {'precision': 0.6321568145419313, 'recall': 0.23840388734445236, 'f1-score': 0.34623350599565966, 'support': 733457}, '2': {'precision': 0.34477157033832195, 'recall': 0.6943103861526602, 'f1-score': 0.46074995459347456, 'support': 308738}, 'accuracy': 0.4166700662889254, 'macro avg': {'precision': 0.45348984474330223, 'recall': 0.49885070884230354, 'f1-score': 0.4211722444129027, 'support': 1348189}, 'weighted avg': {'precision': 0.509917538461367, 'recall': 0.4166700662889254, 'f1-score': 0.3974923770476338, 'support': 1348189}}
[[172531  55919  77544]
 [228757 174859 329841]
 [ 48549  45829 214360]]
Evaluating performance on  train set...
1060/1060 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99783814
{'0': {'precision': 0.3876294353168577, 'recall': 0.5682365560930195, 'f1-score': 0.46087049302768407, 'support': 49409}, '1': {'precision': 0.7462069784807549, 'recall': 0.5122053504342204, 'f1-score': 0.607449876526154, 'support': 171687}, '2': {'precision': 0.3855652281286658, 'recall': 0.6224211134809735, 'f1-score': 0.47616506038794676, 'support': 50167}, 'accuracy': 0.5427942623947977, 'macro avg': {'precision': 0.5064672139754262, 'recall': 0.5676210066694045, 'f1-score': 0.5148284766472616, 'support': 271263}, 'weighted avg': {'precision': 0.6141975539735488, 'recall': 0.5427942623947977, 'f1-score': 0.5564716519600268, 'support': 271263}}
[[28076 15422  5911]
 [39899 87939 43849]
 [ 4455 14487 31225]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91020757
{'0': {'precision': 0.4417843357600039, 'recall': 0.507777840175212, 'f1-score': 0.47248785076030725, 'support': 17807}, '1': {'precision': 0.7683616990401957, 'recall': 0.5501135402288615, 'f1-score': 0.6411742319402158, 'support': 67377}, '2': {'precision': 0.34974063400576366, 'recall': 0.6660081220502689, 'f1-score': 0.4586372397112732, 'support': 18222}, 'accuracy': 0.5632458464692571, 'macro avg': {'precision': 0.519962222935321, 'recall': 0.5746331674847808, 'f1-score': 0.5240997741372654, 'support': 103406}, 'weighted avg': {'precision': 0.6383549667907344, 'recall': 0.5632458464692571, 'f1-score': 0.5799593366530331, 'support': 103406}}
[[ 9042  6390  2375]
 [10123 37065 20189]
 [ 1302  4784 12136]]
training model: results/EXC/W10/deepLOB_L1/h100
Epoch 1/50
1060/1060 - 19s - loss: 3.0165 - accuracy100: 0.4613 - val_loss: 3.0932 - val_accuracy100: 0.4393 - 19s/epoch - 18ms/step
Epoch 2/50
1060/1060 - 17s - loss: 2.9587 - accuracy100: 0.4688 - val_loss: 3.1547 - val_accuracy100: 0.4432 - 17s/epoch - 16ms/step
Epoch 3/50
1060/1060 - 16s - loss: 2.9162 - accuracy100: 0.4859 - val_loss: 3.1574 - val_accuracy100: 0.4705 - 16s/epoch - 16ms/step
Epoch 4/50
1060/1060 - 16s - loss: 2.8918 - accuracy100: 0.4961 - val_loss: 3.1278 - val_accuracy100: 0.4819 - 16s/epoch - 15ms/step
Epoch 5/50
1060/1060 - 16s - loss: 2.8716 - accuracy100: 0.5044 - val_loss: 3.1119 - val_accuracy100: 0.4862 - 16s/epoch - 15ms/step
Epoch 6/50
1060/1060 - 16s - loss: 2.8592 - accuracy100: 0.5081 - val_loss: 3.1183 - val_accuracy100: 0.4865 - 16s/epoch - 15ms/step
Epoch 7/50
1060/1060 - 16s - loss: 2.8460 - accuracy100: 0.5124 - val_loss: 3.1418 - val_accuracy100: 0.4770 - 16s/epoch - 15ms/step
Epoch 8/50
1060/1060 - 16s - loss: 2.8339 - accuracy100: 0.5166 - val_loss: 3.1038 - val_accuracy100: 0.4887 - 16s/epoch - 15ms/step
Epoch 9/50
1060/1060 - 16s - loss: 2.8220 - accuracy100: 0.5212 - val_loss: 3.0615 - val_accuracy100: 0.4859 - 16s/epoch - 15ms/step
Epoch 10/50
1060/1060 - 16s - loss: 2.8104 - accuracy100: 0.5243 - val_loss: 3.0988 - val_accuracy100: 0.4789 - 16s/epoch - 15ms/step
Epoch 11/50
1060/1060 - 16s - loss: 2.7984 - accuracy100: 0.5279 - val_loss: 3.0643 - val_accuracy100: 0.4746 - 16s/epoch - 15ms/step
Epoch 12/50
1060/1060 - 16s - loss: 2.7868 - accuracy100: 0.5312 - val_loss: 3.1015 - val_accuracy100: 0.4586 - 16s/epoch - 15ms/step
Epoch 13/50
1060/1060 - 16s - loss: 2.7768 - accuracy100: 0.5331 - val_loss: 3.1122 - val_accuracy100: 0.4518 - 16s/epoch - 15ms/step
Epoch 14/50
1060/1060 - 16s - loss: 2.7685 - accuracy100: 0.5346 - val_loss: 3.0677 - val_accuracy100: 0.4743 - 16s/epoch - 15ms/step
Epoch 15/50
1060/1060 - 16s - loss: 2.7599 - accuracy100: 0.5366 - val_loss: 3.0567 - val_accuracy100: 0.4770 - 16s/epoch - 15ms/step
Epoch 16/50
1060/1060 - 16s - loss: 2.7513 - accuracy100: 0.5390 - val_loss: 3.0390 - val_accuracy100: 0.4827 - 16s/epoch - 15ms/step
Epoch 17/50
1060/1060 - 16s - loss: 2.7465 - accuracy100: 0.5386 - val_loss: 3.0302 - val_accuracy100: 0.4845 - 16s/epoch - 15ms/step
Epoch 18/50
1060/1060 - 16s - loss: 2.7396 - accuracy100: 0.5400 - val_loss: 2.9979 - val_accuracy100: 0.4889 - 16s/epoch - 15ms/step
Epoch 19/50
1060/1060 - 16s - loss: 2.7313 - accuracy100: 0.5411 - val_loss: 3.0270 - val_accuracy100: 0.4815 - 16s/epoch - 15ms/step
Epoch 20/50
1060/1060 - 16s - loss: 2.7292 - accuracy100: 0.5419 - val_loss: 3.0154 - val_accuracy100: 0.4763 - 16s/epoch - 15ms/step
Epoch 21/50
1060/1060 - 16s - loss: 2.7232 - accuracy100: 0.5430 - val_loss: 2.9817 - val_accuracy100: 0.4918 - 16s/epoch - 15ms/step
Epoch 22/50
1060/1060 - 16s - loss: 2.7175 - accuracy100: 0.5436 - val_loss: 3.0301 - val_accuracy100: 0.4812 - 16s/epoch - 15ms/step
Epoch 23/50
1060/1060 - 16s - loss: 2.7131 - accuracy100: 0.5438 - val_loss: 2.9955 - val_accuracy100: 0.4961 - 16s/epoch - 15ms/step
Epoch 24/50
1060/1060 - 16s - loss: 2.7091 - accuracy100: 0.5458 - val_loss: 2.9803 - val_accuracy100: 0.4986 - 16s/epoch - 15ms/step
Epoch 25/50
1060/1060 - 16s - loss: 2.7040 - accuracy100: 0.5452 - val_loss: 2.9674 - val_accuracy100: 0.4973 - 16s/epoch - 15ms/step
Epoch 26/50
1060/1060 - 16s - loss: 2.7010 - accuracy100: 0.5457 - val_loss: 2.9501 - val_accuracy100: 0.5266 - 16s/epoch - 15ms/step
Epoch 27/50
1060/1060 - 16s - loss: 2.6971 - accuracy100: 0.5477 - val_loss: 2.9719 - val_accuracy100: 0.5233 - 16s/epoch - 15ms/step
Epoch 28/50
1060/1060 - 16s - loss: 2.6921 - accuracy100: 0.5470 - val_loss: 2.9724 - val_accuracy100: 0.5118 - 16s/epoch - 15ms/step
Epoch 29/50
1060/1060 - 16s - loss: 2.6889 - accuracy100: 0.5479 - val_loss: 2.9971 - val_accuracy100: 0.5211 - 16s/epoch - 15ms/step
Epoch 30/50
1060/1060 - 16s - loss: 2.6877 - accuracy100: 0.5472 - val_loss: 3.0012 - val_accuracy100: 0.5244 - 16s/epoch - 15ms/step
Epoch 31/50
1060/1060 - 16s - loss: 2.6835 - accuracy100: 0.5487 - val_loss: 3.0119 - val_accuracy100: 0.5276 - 16s/epoch - 15ms/step
Epoch 32/50
1060/1060 - 16s - loss: 2.6790 - accuracy100: 0.5509 - val_loss: 2.9934 - val_accuracy100: 0.5213 - 16s/epoch - 15ms/step
Epoch 33/50
1060/1060 - 16s - loss: 2.6760 - accuracy100: 0.5512 - val_loss: 2.9763 - val_accuracy100: 0.5213 - 16s/epoch - 15ms/step
Epoch 34/50
1060/1060 - 16s - loss: 2.6713 - accuracy100: 0.5523 - val_loss: 2.9972 - val_accuracy100: 0.5127 - 16s/epoch - 15ms/step
Epoch 35/50
1060/1060 - 16s - loss: 2.6687 - accuracy100: 0.5517 - val_loss: 2.9864 - val_accuracy100: 0.5258 - 16s/epoch - 15ms/step
Epoch 36/50
1060/1060 - 16s - loss: 2.6638 - accuracy100: 0.5524 - val_loss: 2.9667 - val_accuracy100: 0.5289 - 16s/epoch - 15ms/step
testing model: results/EXC/W10/deepLOB_L1/h100
Evaluating performance on  test set...
5267/5267 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0813094
{'0': {'precision': 0.5112023177209077, 'recall': 0.2601528923487479, 'f1-score': 0.3448236552870843, 'support': 406953}, '1': {'precision': 0.4387498553222135, 'recall': 0.5202607651398181, 'f1-score': 0.4760413087499411, 'support': 524610}, '2': {'precision': 0.40595009412023114, 'recall': 0.5057173580141422, 'f1-score': 0.45037476900912, 'support': 416626}, 'accuracy': 0.4372524920467383, 'macro avg': {'precision': 0.45196742238778415, 'recall': 0.42871033850090273, 'f1-score': 0.42374657768204843, 'support': 1348189}, 'weighted avg': {'precision': 0.45048375436752447, 'recall': 0.4372524920467383, 'f1-score': 0.42850141225491756, 'support': 1348189}}
[[105870 178659 122424]
 [ 65778 272934 185898]
 [ 35452 170479 210695]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9766781
{'0': {'precision': 0.4775876415469773, 'recall': 0.3711482231219073, 'f1-score': 0.4176936828616178, 'support': 71136}, '1': {'precision': 0.553668054487691, 'recall': 0.5954041278607198, 'f1-score': 0.5737781319061293, 'support': 128202}, '2': {'precision': 0.45304999039877103, 'recall': 0.49204031977754603, 'f1-score': 0.4717408691015729, 'support': 71925}, 'accuracy': 0.5091884997216723, 'macro avg': {'precision': 0.4947685621444798, 'recall': 0.48619755692005767, 'f1-score': 0.48773756128977336, 'support': 271263}, 'weighted avg': {'precision': 0.5070379924646868, 'recall': 0.5091884997216723, 'f1-score': 0.5057915156169631, 'support': 271263}}
[[26402 32317 12417]
 [21562 76332 30308]
 [ 7318 29217 35390]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9634241
{'0': {'precision': 0.5230028753594199, 'recall': 0.3275396359365825, 'f1-score': 0.4028115446645644, 'support': 25545}, '1': {'precision': 0.5961629094336659, 'recall': 0.592856584908608, 'f1-score': 0.5945051501977834, 'support': 51208}, '2': {'precision': 0.4328472755180353, 'recall': 0.592503658124789, 'f1-score': 0.5002454978855504, 'support': 26653}, 'accuracy': 0.5272227917142138, 'macro avg': {'precision': 0.5173376867703737, 'recall': 0.5042999596566599, 'f1-score': 0.4991873975826327, 'support': 103406}, 'weighted avg': {'precision': 0.5359949824160856, 'recall': 0.5272227917142138, 'f1-score': 0.5228544174895844, 'support': 103406}}
[[ 8367 11639  5539]
 [ 5696 30359 15153]
 [ 1935  8926 15792]]
training model: results/EXC/W10/deepLOB_L1/h200
Epoch 1/50
1060/1060 - 19s - loss: 3.1794 - accuracy200: 0.4351 - val_loss: 3.2840 - val_accuracy200: 0.4063 - 19s/epoch - 18ms/step
Epoch 2/50
1060/1060 - 16s - loss: 3.1382 - accuracy200: 0.4491 - val_loss: 3.3073 - val_accuracy200: 0.4063 - 16s/epoch - 15ms/step
Epoch 3/50
1060/1060 - 16s - loss: 3.1231 - accuracy200: 0.4541 - val_loss: 3.2961 - val_accuracy200: 0.4138 - 16s/epoch - 15ms/step
Epoch 4/50
1060/1060 - 16s - loss: 3.1080 - accuracy200: 0.4602 - val_loss: 3.2676 - val_accuracy200: 0.4173 - 16s/epoch - 15ms/step
Epoch 5/50
1060/1060 - 16s - loss: 3.0943 - accuracy200: 0.4638 - val_loss: 3.3426 - val_accuracy200: 0.4113 - 16s/epoch - 15ms/step
Epoch 6/50
1060/1060 - 16s - loss: 3.0846 - accuracy200: 0.4670 - val_loss: 3.3402 - val_accuracy200: 0.4063 - 16s/epoch - 15ms/step
Epoch 7/50
1060/1060 - 16s - loss: 3.0784 - accuracy200: 0.4690 - val_loss: 3.3768 - val_accuracy200: 0.4055 - 16s/epoch - 15ms/step
Epoch 8/50
1060/1060 - 16s - loss: 3.0739 - accuracy200: 0.4701 - val_loss: 3.3624 - val_accuracy200: 0.4034 - 16s/epoch - 15ms/step
Epoch 9/50
1060/1060 - 16s - loss: 3.0684 - accuracy200: 0.4715 - val_loss: 3.4212 - val_accuracy200: 0.3993 - 16s/epoch - 15ms/step
Epoch 10/50
1060/1060 - 16s - loss: 3.0623 - accuracy200: 0.4733 - val_loss: 3.4240 - val_accuracy200: 0.3998 - 16s/epoch - 15ms/step
Epoch 11/50
1060/1060 - 16s - loss: 3.0580 - accuracy200: 0.4747 - val_loss: 3.4235 - val_accuracy200: 0.3962 - 16s/epoch - 15ms/step
Epoch 12/50
1060/1060 - 16s - loss: 3.0540 - accuracy200: 0.4759 - val_loss: 3.4217 - val_accuracy200: 0.3969 - 16s/epoch - 15ms/step
Epoch 13/50
1060/1060 - 16s - loss: 3.0488 - accuracy200: 0.4764 - val_loss: 3.4234 - val_accuracy200: 0.3975 - 16s/epoch - 15ms/step
Epoch 14/50
1060/1060 - 16s - loss: 3.0445 - accuracy200: 0.4768 - val_loss: 3.4293 - val_accuracy200: 0.3922 - 16s/epoch - 15ms/step
testing model: results/EXC/W10/deepLOB_L1/h200
Evaluating performance on  test set...
5267/5267 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1431658
{'0': {'precision': 0.5484193074343419, 'recall': 0.060392993259238206, 'f1-score': 0.10880425214597689, 'support': 481993}, '1': {'precision': 0.26975383701578515, 'recall': 0.3944608325139299, 'f1-score': 0.32040040066689074, 'support': 366120}, '2': {'precision': 0.42648611224454874, 'recall': 0.6479335141058559, 'f1-score': 0.514388677657742, 'support': 500076}, 'accuracy': 0.36904692146279194, 'macro avg': {'precision': 0.41488641889822525, 'recall': 0.3675957799596747, 'f1-score': 0.3145311101568699, 'support': 1348189}, 'weighted avg': {'precision': 0.42751573490306255, 'recall': 0.36904692146279194, 'f1-score': 0.316707312524528, 'support': 1348189}}
[[ 29109 225666 227218]
 [ 13200 144420 208500]
 [ 10769 165291 324016]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.091393
{'0': {'precision': 0.5047717065868264, 'recall': 0.23946115691474607, 'f1-score': 0.32482633531771415, 'support': 90119}, '1': {'precision': 0.3563158205879621, 'recall': 0.4681283078322811, 'f1-score': 0.4046399662408409, 'support': 90127}, '2': {'precision': 0.44154511271366553, 'recall': 0.5341309865190019, 'f1-score': 0.4834451245282644, 'support': 91017}, 'accuracy': 0.41430641112131034, 'macro avg': {'precision': 0.434210879962818, 'recall': 0.4139068170886763, 'f1-score': 0.4043038086956065, 'support': 271263}, 'weighted avg': {'precision': 0.43423286224766794, 'recall': 0.41430641112131034, 'f1-score': 0.40456581122038165, 'support': 271263}}
[[21580 41594 26945]
 [13394 42191 34542]
 [ 7778 34624 48615]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0889815
{'0': {'precision': 0.5009959365787586, 'recall': 0.19360201976661842, 'f1-score': 0.2792804796802132, 'support': 32479}, '1': {'precision': 0.37482588020558144, 'recall': 0.43186031710894046, 'f1-score': 0.4013268704115613, 'support': 36139}, '2': {'precision': 0.43237092874413313, 'recall': 0.6117051856962171, 'f1-score': 0.5066365097315635, 'support': 34788}, 'accuracy': 0.41752896350308494, 'macro avg': {'precision': 0.43606424850949105, 'recall': 0.412389174190592, 'f1-score': 0.39574795327444595, 'support': 103406}, 'weighted avg': {'precision': 0.4338142794232628, 'recall': 0.41752896350308494, 'f1-score': 0.3984214974941366, 'support': 103406}}
[[ 6288 14649 11542]
 [ 4137 15607 16395]
 [ 2126 11382 21280]]
training model: results/EXC/W10/deepLOB_L1/h300
Epoch 1/50
1060/1060 - 20s - loss: 3.2304 - accuracy300: 0.4124 - val_loss: 3.4324 - val_accuracy300: 0.3668 - 20s/epoch - 19ms/step
Epoch 2/50
1060/1060 - 17s - loss: 3.1950 - accuracy300: 0.4224 - val_loss: 3.4736 - val_accuracy300: 0.3717 - 17s/epoch - 16ms/step
Epoch 3/50
1060/1060 - 17s - loss: 3.1769 - accuracy300: 0.4311 - val_loss: 3.4505 - val_accuracy300: 0.3722 - 17s/epoch - 16ms/step
Epoch 4/50
1060/1060 - 16s - loss: 3.1627 - accuracy300: 0.4366 - val_loss: 3.5060 - val_accuracy300: 0.3678 - 16s/epoch - 15ms/step
Epoch 5/50
1060/1060 - 16s - loss: 3.1552 - accuracy300: 0.4395 - val_loss: 3.5294 - val_accuracy300: 0.3670 - 16s/epoch - 15ms/step
Epoch 6/50
1060/1060 - 16s - loss: 3.1484 - accuracy300: 0.4417 - val_loss: 3.5374 - val_accuracy300: 0.3634 - 16s/epoch - 15ms/step
Epoch 7/50
1060/1060 - 16s - loss: 3.1403 - accuracy300: 0.4447 - val_loss: 3.4863 - val_accuracy300: 0.3640 - 16s/epoch - 15ms/step
Epoch 8/50
1060/1060 - 16s - loss: 3.1355 - accuracy300: 0.4474 - val_loss: 3.4647 - val_accuracy300: 0.3640 - 16s/epoch - 16ms/step
Epoch 9/50
1060/1060 - 16s - loss: 3.1317 - accuracy300: 0.4484 - val_loss: 3.4985 - val_accuracy300: 0.3624 - 16s/epoch - 15ms/step
Epoch 10/50
1060/1060 - 16s - loss: 3.1283 - accuracy300: 0.4490 - val_loss: 3.5682 - val_accuracy300: 0.3590 - 16s/epoch - 16ms/step
Epoch 11/50
1060/1060 - 16s - loss: 3.1241 - accuracy300: 0.4507 - val_loss: 3.5320 - val_accuracy300: 0.3611 - 16s/epoch - 15ms/step
testing model: results/EXC/W10/deepLOB_L1/h300
Evaluating performance on  test set...
5267/5267 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1955549
{'0': {'precision': 0.400285886583432, 'recall': 0.03904388024974838, 'f1-score': 0.07114798678033725, 'support': 459022}, '1': {'precision': 0.30535868582587894, 'recall': 0.1465822724112302, 'f1-score': 0.19807972370311694, 'support': 417090}, '2': {'precision': 0.3560382125074443, 'recall': 0.832027402309369, 'f1-score': 0.49868213570193415, 'support': 472077}, 'accuracy': 0.3499813453454968, 'macro avg': {'precision': 0.35389426163891846, 'recall': 0.33921785165678253, 'f1-score': 0.2559699487284628, 'support': 1348189}, 'weighted avg': {'precision': 0.3554245982931864, 'recall': 0.3499813453454968, 'f1-score': 0.2601207469597949, 'support': 1348189}}
[[ 17922  73023 368077]
 [ 13611  61138 342341]
 [ 13240  66056 392781]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.151394
{'0': {'precision': 0.38058445795130663, 'recall': 0.2458654539404359, 'f1-score': 0.2987391928408256, 'support': 90155}, '1': {'precision': 0.3354914316452778, 'recall': 0.1951761984062231, 'f1-score': 0.2467832538420774, 'support': 89473}, '2': {'precision': 0.37423354807447395, 'recall': 0.6573907349811753, 'f1-score': 0.47695206726734335, 'support': 91635}, 'accuracy': 0.36816300048292616, 'macro avg': {'precision': 0.36343647922368616, 'recall': 0.3661441291092781, 'f1-score': 0.3408248379834154, 'support': 271263}, 'weighted avg': {'precision': 0.36356564606305475, 'recall': 0.36816300048292616, 'f1-score': 0.34180397874247437, 'support': 271263}}
[[22166 19018 48971]
 [20252 17463 51758]
 [15824 15571 60240]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1419611
{'0': {'precision': 0.39165421312794574, 'recall': 0.10770057533034078, 'f1-score': 0.1689435449879751, 'support': 31634}, '1': {'precision': 0.3740537848605578, 'recall': 0.20079129574678536, 'f1-score': 0.26131125297893437, 'support': 37407}, '2': {'precision': 0.36384954507081885, 'recall': 0.79013531209079, 'f1-score': 0.49825675278919546, 'support': 34365}, 'accuracy': 0.3681701255246311, 'macro avg': {'precision': 0.3765191810197741, 'recall': 0.36620906105597206, 'f1-score': 0.309503850252035, 'support': 103406}, 'weighted avg': {'precision': 0.3760469307847418, 'recall': 0.3681701255246311, 'f1-score': 0.31179838164065243, 'support': 103406}}
[[ 3407  7114 21113]
 [ 3535  7511 26361]
 [ 1757  5455 27153]]
training model: results/EXC/W10/deepLOB_L1/h500
Epoch 1/50
1060/1060 - 19s - loss: 3.2511 - accuracy500: 0.4056 - val_loss: 3.3009 - val_accuracy500: 0.3834 - 19s/epoch - 18ms/step
Epoch 2/50
1060/1060 - 16s - loss: 3.2134 - accuracy500: 0.4191 - val_loss: 3.4102 - val_accuracy500: 0.3751 - 16s/epoch - 15ms/step
Epoch 3/50
1060/1060 - 16s - loss: 3.1981 - accuracy500: 0.4226 - val_loss: 3.4802 - val_accuracy500: 0.3686 - 16s/epoch - 15ms/step
Epoch 4/50
1060/1060 - 16s - loss: 3.1862 - accuracy500: 0.4281 - val_loss: 3.5332 - val_accuracy500: 0.3704 - 16s/epoch - 15ms/step
Epoch 5/50
1060/1060 - 16s - loss: 3.1770 - accuracy500: 0.4325 - val_loss: 3.5736 - val_accuracy500: 0.3671 - 16s/epoch - 15ms/step
Epoch 6/50
1060/1060 - 16s - loss: 3.1682 - accuracy500: 0.4360 - val_loss: 3.5708 - val_accuracy500: 0.3666 - 16s/epoch - 15ms/step
Epoch 7/50
1060/1060 - 16s - loss: 3.1626 - accuracy500: 0.4394 - val_loss: 3.5885 - val_accuracy500: 0.3668 - 16s/epoch - 15ms/step
Epoch 8/50
1060/1060 - 16s - loss: 3.1566 - accuracy500: 0.4428 - val_loss: 3.5837 - val_accuracy500: 0.3660 - 16s/epoch - 15ms/step
Epoch 9/50
1060/1060 - 16s - loss: 3.1512 - accuracy500: 0.4446 - val_loss: 3.5331 - val_accuracy500: 0.3659 - 16s/epoch - 15ms/step
Epoch 10/50
1060/1060 - 16s - loss: 3.1463 - accuracy500: 0.4462 - val_loss: 3.5368 - val_accuracy500: 0.3638 - 16s/epoch - 15ms/step
Epoch 11/50
1060/1060 - 16s - loss: 3.1377 - accuracy500: 0.4506 - val_loss: 3.5209 - val_accuracy500: 0.3640 - 16s/epoch - 15ms/step
testing model: results/EXC/W10/deepLOB_L1/h500
Evaluating performance on  test set...
5267/5267 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1433063
{'0': {'precision': 0.3063534094550606, 'recall': 0.040969703531279884, 'f1-score': 0.07227395984824218, 'support': 443352}, '1': {'precision': 0.3314098635133721, 'recall': 0.04915270396409939, 'f1-score': 0.08560847705033248, 'support': 451023}, '2': {'precision': 0.3439830442592297, 'recall': 0.9262583349125413, 'f1-score': 0.5016639625162382, 'support': 453814}, 'accuracy': 0.3417043159378989, 'macro avg': {'precision': 0.3272487724092208, 'recall': 0.33879358080264016, 'f1-score': 0.21984879980493766, 'support': 1348189}, 'weighted avg': {'precision': 0.3274023070263663, 'recall': 0.3417043159378989, 'f1-score': 0.22127188864221126, 'support': 1348189}}
[[ 18164  22482 402706]
 [ 29904  22169 398950]
 [ 11223  22242 420349]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1126869
{'0': {'precision': 0.39292174036886707, 'recall': 0.30829487423035234, 'f1-score': 0.34550167810449334, 'support': 89489}, '1': {'precision': 0.3596067838639685, 'recall': 0.09053612637822049, 'f1-score': 0.14465363994228816, 'support': 89699}, '2': {'precision': 0.36811139439105706, 'recall': 0.7134944338854194, 'f1-score': 0.4856583130036224, 'support': 92075}, 'accuracy': 0.37382540191622154, 'macro avg': {'precision': 0.3735466395412976, 'recall': 0.3707751448313308, 'f1-score': 0.3252712103501346, 'support': 271263}, 'weighted avg': {'precision': 0.373484032721898, 'recall': 0.37382540191622154, 'f1-score': 0.3266603838005362, 'support': 271263}}
[[27589  7229 54671]
 [23479  8121 58099]
 [19147  7233 65695]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0982791
{'0': {'precision': 0.41171554475003797, 'recall': 0.16470123396753997, 'f1-score': 0.2352813476901702, 'support': 32902}, '1': {'precision': 0.3545937737281701, 'recall': 0.08433408577878104, 'f1-score': 0.13626085053614415, 'support': 33225}, '2': {'precision': 0.3827087027276481, 'recall': 0.8453284691112959, 'f1-score': 0.5268807316441093, 'support': 37279}, 'accuracy': 0.38425236446627853, 'macro avg': {'precision': 0.3830060070686187, 'recall': 0.36478792961920564, 'f1-score': 0.29947430995680785, 'support': 103406}, 'weighted avg': {'precision': 0.38290467394994676, 'recall': 0.38425236446627853, 'f1-score': 0.30859022160925015, 'support': 103406}}
[[ 5419  2646 24837]
 [ 4431  2802 25992]
 [ 3312  2454 31513]]
training model: results/EXC/W10/deepLOB_L1/h1000
Epoch 1/50
1060/1060 - 18s - loss: 3.2206 - accuracy1000: 0.4296 - val_loss: 3.3276 - val_accuracy1000: 0.4447 - 18s/epoch - 17ms/step
Epoch 2/50
1060/1060 - 16s - loss: 3.1621 - accuracy1000: 0.4474 - val_loss: 3.2885 - val_accuracy1000: 0.4370 - 16s/epoch - 15ms/step
Epoch 3/50
1060/1060 - 16s - loss: 3.1380 - accuracy1000: 0.4513 - val_loss: 3.3336 - val_accuracy1000: 0.4085 - 16s/epoch - 15ms/step
Epoch 4/50
1060/1060 - 16s - loss: 3.1144 - accuracy1000: 0.4622 - val_loss: 3.3427 - val_accuracy1000: 0.4043 - 16s/epoch - 15ms/step
Epoch 5/50
1060/1060 - 16s - loss: 3.1062 - accuracy1000: 0.4667 - val_loss: 3.4613 - val_accuracy1000: 0.3429 - 16s/epoch - 15ms/step
Epoch 6/50
1060/1060 - 16s - loss: 3.0919 - accuracy1000: 0.4709 - val_loss: 3.4889 - val_accuracy1000: 0.3328 - 16s/epoch - 15ms/step
Epoch 7/50
1060/1060 - 16s - loss: 3.0796 - accuracy1000: 0.4750 - val_loss: 3.5843 - val_accuracy1000: 0.3325 - 16s/epoch - 15ms/step
Epoch 8/50
1060/1060 - 16s - loss: 3.0683 - accuracy1000: 0.4797 - val_loss: 3.5018 - val_accuracy1000: 0.3428 - 16s/epoch - 15ms/step
Epoch 9/50
1060/1060 - 16s - loss: 3.0584 - accuracy1000: 0.4825 - val_loss: 3.4915 - val_accuracy1000: 0.3408 - 16s/epoch - 15ms/step
Epoch 10/50
1060/1060 - 16s - loss: 3.0489 - accuracy1000: 0.4854 - val_loss: 3.5425 - val_accuracy1000: 0.3481 - 16s/epoch - 15ms/step
Epoch 11/50
1060/1060 - 16s - loss: 3.0436 - accuracy1000: 0.4879 - val_loss: 3.6348 - val_accuracy1000: 0.3406 - 16s/epoch - 15ms/step
Epoch 12/50
1060/1060 - 16s - loss: 3.0349 - accuracy1000: 0.4912 - val_loss: 3.6333 - val_accuracy1000: 0.3396 - 16s/epoch - 15ms/step
testing model: results/EXC/W10/deepLOB_L1/h1000
Evaluating performance on  test set...
5267/5267 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1136986
{'0': {'precision': 0.36095531701519146, 'recall': 0.02518014504882896, 'f1-score': 0.047076262770611, 'support': 385939}, '1': {'precision': 0.42445194601797503, 'recall': 0.9151558337165262, 'f1-score': 0.5799304548793638, 'support': 569774}, '2': {'precision': 0.3019195326730112, 'recall': 0.07137506497212569, 'f1-score': 0.11545586995810483, 'support': 392476}, 'accuracy': 0.41475119586348796, 'macro avg': {'precision': 0.36244226523539264, 'recall': 0.3372370145791603, 'f1-score': 0.2474875292026932, 'support': 1348189}, 'weighted avg': {'precision': 0.3706042607448543, 'recall': 0.41475119586348796, 'f1-score': 0.2921782619451268, 'support': 1348189}}
[[  9718 349640  26581]
 [ 10153 521432  38189]
 [  7052 357411  28013]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1904539
{'0': {'precision': 0.3523862568315522, 'recall': 0.1134077210907217, 'f1-score': 0.17159226707574435, 'support': 89262}, '1': {'precision': 0.3272441403656086, 'recall': 0.8536162889455098, 'f1-score': 0.47311421696298883, 'support': 89484}, '2': {'precision': 0.38093671163760007, 'recall': 0.037539046877871095, 'f1-score': 0.06834327095263396, 'support': 92517}, 'accuracy': 0.3317112912560873, 'macro avg': {'precision': 0.353522369611587, 'recall': 0.3348543523047009, 'f1-score': 0.23768325166378904, 'support': 271263}, 'weighted avg': {'precision': 0.35382982000623003, 'recall': 0.3317112912560873, 'f1-score': 0.23584394455991423, 'support': 271263}}
[[10123 76135  3004]
 [10459 76385  2640]
 [ 8145 80899  3473]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0956045
{'0': {'precision': 0.28333977580208736, 'recall': 0.027763048253920158, 'f1-score': 0.0505709062058022, 'support': 26402}, '1': {'precision': 0.44385896701317834, 'recall': 0.9448728001393971, 'f1-score': 0.6039903096458009, 'support': 45912}, '2': {'precision': 0.3710671423937723, 'recall': 0.0367940306188087, 'f1-score': 0.066949524506218, 'support': 31092}, 'accuracy': 0.43767286230973057, 'macro avg': {'precision': 0.3660886284030127, 'recall': 0.3364766263373753, 'f1-score': 0.24050358011927372, 'support': 103406}, 'weighted avg': {'precision': 0.3809876529944387, 'recall': 0.43767286230973057, 'f1-score': 0.30121241299393586, 'support': 103406}}
[[  733 24807   862]
 [ 1454 43381  1077]
 [  400 29548  1144]]
training model: results/EXC/W10/deepOF_L1/h10
Epoch 1/50
1060/1060 - 17s - loss: 2.9450 - accuracy10: 0.4458 - val_loss: 2.7596 - val_accuracy10: 0.6152 - 17s/epoch - 16ms/step
Epoch 2/50
1060/1060 - 14s - loss: 2.8157 - accuracy10: 0.4978 - val_loss: 2.6961 - val_accuracy10: 0.5908 - 14s/epoch - 14ms/step
Epoch 3/50
1060/1060 - 14s - loss: 2.7548 - accuracy10: 0.5052 - val_loss: 2.6868 - val_accuracy10: 0.5906 - 14s/epoch - 14ms/step
Epoch 4/50
1060/1060 - 14s - loss: 2.7140 - accuracy10: 0.5113 - val_loss: 2.6584 - val_accuracy10: 0.6089 - 14s/epoch - 14ms/step
Epoch 5/50
1060/1060 - 14s - loss: 2.6868 - accuracy10: 0.5191 - val_loss: 2.6469 - val_accuracy10: 0.5763 - 14s/epoch - 14ms/step
Epoch 6/50
1060/1060 - 14s - loss: 2.6629 - accuracy10: 0.5269 - val_loss: 2.6429 - val_accuracy10: 0.5935 - 14s/epoch - 14ms/step
Epoch 7/50
1060/1060 - 15s - loss: 2.6413 - accuracy10: 0.5349 - val_loss: 2.6381 - val_accuracy10: 0.6033 - 15s/epoch - 14ms/step
Epoch 8/50
1060/1060 - 15s - loss: 2.6245 - accuracy10: 0.5380 - val_loss: 2.6321 - val_accuracy10: 0.5969 - 15s/epoch - 14ms/step
Epoch 9/50
1060/1060 - 14s - loss: 2.6066 - accuracy10: 0.5416 - val_loss: 2.6370 - val_accuracy10: 0.5897 - 14s/epoch - 13ms/step
Epoch 10/50
1060/1060 - 15s - loss: 2.5931 - accuracy10: 0.5441 - val_loss: 2.6132 - val_accuracy10: 0.5974 - 15s/epoch - 14ms/step
Epoch 11/50
1060/1060 - 15s - loss: 2.5756 - accuracy10: 0.5493 - val_loss: 2.6101 - val_accuracy10: 0.5944 - 15s/epoch - 14ms/step
Epoch 12/50
1060/1060 - 15s - loss: 2.5611 - accuracy10: 0.5515 - val_loss: 2.5841 - val_accuracy10: 0.5973 - 15s/epoch - 14ms/step
Epoch 13/50
1060/1060 - 14s - loss: 2.5461 - accuracy10: 0.5490 - val_loss: 2.6090 - val_accuracy10: 0.6197 - 14s/epoch - 14ms/step
Epoch 14/50
1060/1060 - 15s - loss: 2.5349 - accuracy10: 0.5507 - val_loss: 2.6000 - val_accuracy10: 0.6036 - 15s/epoch - 14ms/step
Epoch 15/50
1060/1060 - 14s - loss: 2.5197 - accuracy10: 0.5524 - val_loss: 2.5912 - val_accuracy10: 0.5975 - 14s/epoch - 14ms/step
Epoch 16/50
1060/1060 - 14s - loss: 2.5065 - accuracy10: 0.5539 - val_loss: 2.5994 - val_accuracy10: 0.5886 - 14s/epoch - 14ms/step
Epoch 17/50
1060/1060 - 15s - loss: 2.4914 - accuracy10: 0.5573 - val_loss: 2.5905 - val_accuracy10: 0.6208 - 15s/epoch - 14ms/step
Epoch 18/50
1060/1060 - 14s - loss: 2.4807 - accuracy10: 0.5582 - val_loss: 2.5925 - val_accuracy10: 0.6048 - 14s/epoch - 14ms/step
Epoch 19/50
1060/1060 - 15s - loss: 2.4680 - accuracy10: 0.5598 - val_loss: 2.5835 - val_accuracy10: 0.5920 - 15s/epoch - 14ms/step
Epoch 20/50
1060/1060 - 14s - loss: 2.4582 - accuracy10: 0.5588 - val_loss: 2.6032 - val_accuracy10: 0.6128 - 14s/epoch - 14ms/step
Epoch 21/50
1060/1060 - 14s - loss: 2.4440 - accuracy10: 0.5641 - val_loss: 2.6035 - val_accuracy10: 0.6247 - 14s/epoch - 14ms/step
Epoch 22/50
1060/1060 - 14s - loss: 2.4275 - accuracy10: 0.5647 - val_loss: 2.5988 - val_accuracy10: 0.5992 - 14s/epoch - 14ms/step
Epoch 23/50
1060/1060 - 14s - loss: 2.4145 - accuracy10: 0.5652 - val_loss: 2.6170 - val_accuracy10: 0.6191 - 14s/epoch - 13ms/step
Epoch 24/50
1060/1060 - 14s - loss: 2.4049 - accuracy10: 0.5677 - val_loss: 2.6152 - val_accuracy10: 0.6057 - 14s/epoch - 14ms/step
Epoch 25/50
1060/1060 - 14s - loss: 2.3933 - accuracy10: 0.5696 - val_loss: 2.6396 - val_accuracy10: 0.6067 - 14s/epoch - 14ms/step
Epoch 26/50
1060/1060 - 15s - loss: 2.3881 - accuracy10: 0.5665 - val_loss: 2.6199 - val_accuracy10: 0.6254 - 15s/epoch - 14ms/step
Epoch 27/50
1060/1060 - 14s - loss: 2.3717 - accuracy10: 0.5697 - val_loss: 2.6395 - val_accuracy10: 0.6208 - 14s/epoch - 14ms/step
Epoch 28/50
1060/1060 - 14s - loss: 2.3582 - accuracy10: 0.5723 - val_loss: 2.6314 - val_accuracy10: 0.6162 - 14s/epoch - 14ms/step
Epoch 29/50
1060/1060 - 14s - loss: 2.3504 - accuracy10: 0.5735 - val_loss: 2.6416 - val_accuracy10: 0.6170 - 14s/epoch - 14ms/step
testing model: results/EXC/W10/deepOF_L1/h10
Evaluating performance on  test set...
5267/5267 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89697343
{'0': {'precision': 0.24871399712601786, 'recall': 0.4733264634774682, 'f1-score': 0.3260839886413281, 'support': 151386}, '1': {'precision': 0.8477847928760024, 'recall': 0.5795542169941036, 'f1-score': 0.6884660874776675, 'support': 1046563}, '2': {'precision': 0.21769319378715823, 'recall': 0.4993909541717975, 'f1-score': 0.30321130949975345, 'support': 150235}, 'accuracy': 0.558693027064555, 'macro avg': {'precision': 0.43806399459639284, 'recall': 0.5174238782144565, 'f1-score': 0.4392537952062497, 'support': 1348184}, 'weighted avg': {'precision': 0.7103015243647905, 'recall': 0.558693027064555, 'f1-score': 0.6048437273369522, 'support': 1348184}}
[[ 71655  56816  22915]
 [193323 606540 246700]
 [ 23124  52085  75026]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7791122
{'0': {'precision': 0.2333441663958401, 'recall': 0.5887122488953673, 'f1-score': 0.33421688927966486, 'support': 21953}, '1': {'precision': 0.9184969071648594, 'recall': 0.6463730569948186, 'f1-score': 0.7587744251238712, 'support': 226968}, '2': {'precision': 0.23064182932041602, 'recall': 0.579696522089432, 'f1-score': 0.32999120940720833, 'support': 22341}, 'accuracy': 0.6362151720476882, 'macro avg': {'precision': 0.46082763429370516, 'recall': 0.604927275993206, 'f1-score': 0.47432750793691486, 'support': 271262}, 'weighted avg': {'precision': 0.8063966925670721, 'recall': 0.6362151720476882, 'f1-score': 0.6891009824495791, 'support': 271262}}
[[ 12924   6621   2408]
 [ 39469 146706  40793]
 [  2993   6397  12951]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8290898
{'0': {'precision': 0.23334651116821506, 'recall': 0.5892923998502434, 'f1-score': 0.3343127190343021, 'support': 8013}, '1': {'precision': 0.9192916191562144, 'recall': 0.5905891240399693, 'f1-score': 0.7191609463744382, 'support': 87367}, '2': {'precision': 0.17657717624436062, 'recall': 0.5949414403189633, 'f1-score': 0.2723280483631801, 'support': 8026}, 'accuracy': 0.5908264510763399, 'macro avg': {'precision': 0.44307176885626337, 'recall': 0.591607654736392, 'f1-score': 0.4419339045906401, 'support': 103406}, 'weighted avg': {'precision': 0.808490463815921, 'recall': 0.5908264510763399, 'f1-score': 0.6546572455726002, 'support': 103406}}
[[ 4722  2323   968]
 [14470 51598 21299]
 [ 1044  2207  4775]]
training model: results/EXC/W10/deepOF_L1/h20
Epoch 1/50
1060/1060 - 17s - loss: 2.9575 - accuracy20: 0.4407 - val_loss: 2.7596 - val_accuracy20: 0.5927 - 17s/epoch - 16ms/step
Epoch 2/50
1060/1060 - 15s - loss: 2.8147 - accuracy20: 0.4789 - val_loss: 2.6956 - val_accuracy20: 0.5846 - 15s/epoch - 14ms/step
Epoch 3/50
1060/1060 - 15s - loss: 2.7568 - accuracy20: 0.4854 - val_loss: 2.6811 - val_accuracy20: 0.5718 - 15s/epoch - 14ms/step
Epoch 4/50
1060/1060 - 15s - loss: 2.7188 - accuracy20: 0.4964 - val_loss: 2.6759 - val_accuracy20: 0.5661 - 15s/epoch - 14ms/step
Epoch 5/50
1060/1060 - 15s - loss: 2.6927 - accuracy20: 0.5032 - val_loss: 2.6561 - val_accuracy20: 0.5535 - 15s/epoch - 14ms/step
Epoch 6/50
1060/1060 - 15s - loss: 2.6689 - accuracy20: 0.5108 - val_loss: 2.6613 - val_accuracy20: 0.5714 - 15s/epoch - 14ms/step
Epoch 7/50
1060/1060 - 15s - loss: 2.6507 - accuracy20: 0.5148 - val_loss: 2.6463 - val_accuracy20: 0.5607 - 15s/epoch - 14ms/step
Epoch 8/50
1060/1060 - 15s - loss: 2.6334 - accuracy20: 0.5199 - val_loss: 2.6412 - val_accuracy20: 0.5706 - 15s/epoch - 14ms/step
Epoch 9/50
1060/1060 - 14s - loss: 2.6203 - accuracy20: 0.5240 - val_loss: 2.6361 - val_accuracy20: 0.5845 - 14s/epoch - 14ms/step
Epoch 10/50
1060/1060 - 14s - loss: 2.6082 - accuracy20: 0.5267 - val_loss: 2.6353 - val_accuracy20: 0.5795 - 14s/epoch - 14ms/step
Epoch 11/50
1060/1060 - 15s - loss: 2.5925 - accuracy20: 0.5324 - val_loss: 2.6161 - val_accuracy20: 0.5897 - 15s/epoch - 14ms/step
Epoch 12/50
1060/1060 - 14s - loss: 2.5781 - accuracy20: 0.5358 - val_loss: 2.6271 - val_accuracy20: 0.5894 - 14s/epoch - 14ms/step
Epoch 13/50
1060/1060 - 14s - loss: 2.5649 - accuracy20: 0.5376 - val_loss: 2.6111 - val_accuracy20: 0.5856 - 14s/epoch - 13ms/step
Epoch 14/50
1060/1060 - 14s - loss: 2.5505 - accuracy20: 0.5429 - val_loss: 2.6202 - val_accuracy20: 0.5987 - 14s/epoch - 14ms/step
Epoch 15/50
1060/1060 - 14s - loss: 2.5391 - accuracy20: 0.5427 - val_loss: 2.6238 - val_accuracy20: 0.6015 - 14s/epoch - 14ms/step
Epoch 16/50
1060/1060 - 14s - loss: 2.5269 - accuracy20: 0.5469 - val_loss: 2.6190 - val_accuracy20: 0.5775 - 14s/epoch - 14ms/step
Epoch 17/50
1060/1060 - 14s - loss: 2.5150 - accuracy20: 0.5501 - val_loss: 2.6010 - val_accuracy20: 0.5910 - 14s/epoch - 14ms/step
Epoch 18/50
1060/1060 - 14s - loss: 2.5034 - accuracy20: 0.5521 - val_loss: 2.6051 - val_accuracy20: 0.5970 - 14s/epoch - 14ms/step
Epoch 19/50
1060/1060 - 14s - loss: 2.4913 - accuracy20: 0.5543 - val_loss: 2.6141 - val_accuracy20: 0.5942 - 14s/epoch - 14ms/step
Epoch 20/50
1060/1060 - 14s - loss: 2.4796 - accuracy20: 0.5564 - val_loss: 2.6233 - val_accuracy20: 0.6028 - 14s/epoch - 14ms/step
Epoch 21/50
1060/1060 - 15s - loss: 2.4697 - accuracy20: 0.5559 - val_loss: 2.6088 - val_accuracy20: 0.6129 - 15s/epoch - 14ms/step
Epoch 22/50
1060/1060 - 14s - loss: 2.4594 - accuracy20: 0.5585 - val_loss: 2.6032 - val_accuracy20: 0.5900 - 14s/epoch - 14ms/step
Epoch 23/50
1060/1060 - 15s - loss: 2.4490 - accuracy20: 0.5593 - val_loss: 2.6222 - val_accuracy20: 0.6103 - 15s/epoch - 14ms/step
Epoch 24/50
1060/1060 - 14s - loss: 2.4358 - accuracy20: 0.5596 - val_loss: 2.6175 - val_accuracy20: 0.6230 - 14s/epoch - 14ms/step
Epoch 25/50
1060/1060 - 15s - loss: 2.4239 - accuracy20: 0.5617 - val_loss: 2.6152 - val_accuracy20: 0.6118 - 15s/epoch - 14ms/step
Epoch 26/50
1060/1060 - 14s - loss: 2.4095 - accuracy20: 0.5639 - val_loss: 2.6133 - val_accuracy20: 0.6110 - 14s/epoch - 14ms/step
Epoch 27/50
1060/1060 - 14s - loss: 2.4058 - accuracy20: 0.5625 - val_loss: 2.6218 - val_accuracy20: 0.6158 - 14s/epoch - 14ms/step
testing model: results/EXC/W10/deepOF_L1/h20
Evaluating performance on  test set...
5267/5267 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9136024
{'0': {'precision': 0.31511442151558383, 'recall': 0.4731413116437004, 'f1-score': 0.37828751366303504, 'support': 202616}, '1': {'precision': 0.7804399112239137, 'recall': 0.5921084860495669, 'f1-score': 0.6733534426988593, 'support': 943089}, '2': {'precision': 0.29431876998021006, 'recall': 0.477427288755871, 'f1-score': 0.36415038545643574, 'support': 202479}, 'accuracy': 0.5570055719397352, 'macro avg': {'precision': 0.46329103423990253, 'recall': 0.5142256954830461, 'f1-score': 0.4719304472727767, 'support': 1348184}, 'weighted avg': {'precision': 0.6374982118856728, 'recall': 0.5570055719397352, 'f1-score': 0.5825704308066315, 'support': 1348184}}
[[ 95866  80647  26103]
 [179000 558411 205678]
 [ 29360  76450  96669]]
Evaluating performance on  train set...
1060/1060 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80363286
{'0': {'precision': 0.2942895609627951, 'recall': 0.5850442275679734, 'f1-score': 0.3915973913898387, 'support': 30637}, '1': {'precision': 0.8679959165443757, 'recall': 0.6494874891983634, 'f1-score': 0.7430097572564988, 'support': 209459}, '2': {'precision': 0.3171409390967068, 'recall': 0.5456908169158698, 'f1-score': 0.40114633455986415, 'support': 31166}, 'accuracy': 0.6302836372215791, 'macro avg': {'precision': 0.49314213886795927, 'recall': 0.5934075112274022, 'f1-score': 0.5119178277354005, 'support': 271262}, 'weighted avg': {'precision': 0.7399109365505434, 'recall': 0.6302836372215791, 'f1-score': 0.6640427951135515, 'support': 271262}}
[[ 17924  10028   2685]
 [ 39484 136041  33934]
 [  3498  10661  17007]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84116703
{'0': {'precision': 0.2949650157771985, 'recall': 0.5788906838987614, 'f1-score': 0.39080250840679814, 'support': 11142}, '1': {'precision': 0.872475935441847, 'recall': 0.5945599368696209, 'f1-score': 0.7071936642956661, 'support': 81102}, '2': {'precision': 0.24593658406608046, 'recall': 0.5788389177566744, 'f1-score': 0.34520343012849625, 'support': 11162}, 'accuracy': 0.5911745933504826, 'macro avg': {'precision': 0.471125845095042, 'recall': 0.5840965128416856, 'f1-score': 0.48106653427698687, 'support': 103406}, 'weighted avg': {'precision': 0.7426182975198713, 'recall': 0.5911745933504826, 'f1-score': 0.6340280331650961, 'support': 103406}}
[[ 6450  3613  1079]
 [14151 48220 18731]
 [ 1266  3435  6461]]
training model: results/EXC/W10/deepOF_L1/h30
Epoch 1/50
1060/1060 - 17s - loss: 2.9840 - accuracy30: 0.4234 - val_loss: 2.7950 - val_accuracy30: 0.5706 - 17s/epoch - 16ms/step
Epoch 2/50
1060/1060 - 15s - loss: 2.8443 - accuracy30: 0.4653 - val_loss: 2.7377 - val_accuracy30: 0.5592 - 15s/epoch - 14ms/step
Epoch 3/50
1060/1060 - 15s - loss: 2.7844 - accuracy30: 0.4747 - val_loss: 2.7330 - val_accuracy30: 0.5583 - 15s/epoch - 14ms/step
Epoch 4/50
1060/1060 - 15s - loss: 2.7519 - accuracy30: 0.4852 - val_loss: 2.7324 - val_accuracy30: 0.5590 - 15s/epoch - 14ms/step
Epoch 5/50
1060/1060 - 14s - loss: 2.7268 - accuracy30: 0.4960 - val_loss: 2.7124 - val_accuracy30: 0.5512 - 14s/epoch - 14ms/step
Epoch 6/50
1060/1060 - 15s - loss: 2.7066 - accuracy30: 0.5039 - val_loss: 2.7058 - val_accuracy30: 0.5719 - 15s/epoch - 14ms/step
Epoch 7/50
1060/1060 - 14s - loss: 2.6910 - accuracy30: 0.5080 - val_loss: 2.6971 - val_accuracy30: 0.5588 - 14s/epoch - 14ms/step
Epoch 8/50
1060/1060 - 15s - loss: 2.6748 - accuracy30: 0.5133 - val_loss: 2.6886 - val_accuracy30: 0.5662 - 15s/epoch - 14ms/step
Epoch 9/50
1060/1060 - 15s - loss: 2.6637 - accuracy30: 0.5170 - val_loss: 2.6974 - val_accuracy30: 0.5663 - 15s/epoch - 14ms/step
Epoch 10/50
1060/1060 - 14s - loss: 2.6504 - accuracy30: 0.5200 - val_loss: 2.6988 - val_accuracy30: 0.5734 - 14s/epoch - 14ms/step
Epoch 11/50
1060/1060 - 15s - loss: 2.6399 - accuracy30: 0.5202 - val_loss: 2.6818 - val_accuracy30: 0.5732 - 15s/epoch - 14ms/step
Epoch 12/50
1060/1060 - 14s - loss: 2.6292 - accuracy30: 0.5240 - val_loss: 2.6827 - val_accuracy30: 0.5801 - 14s/epoch - 14ms/step
Epoch 13/50
1060/1060 - 14s - loss: 2.6184 - accuracy30: 0.5244 - val_loss: 2.6880 - val_accuracy30: 0.5801 - 14s/epoch - 14ms/step
Epoch 14/50
1060/1060 - 14s - loss: 2.6049 - accuracy30: 0.5307 - val_loss: 2.6920 - val_accuracy30: 0.5757 - 14s/epoch - 13ms/step
Epoch 15/50
1060/1060 - 14s - loss: 2.5945 - accuracy30: 0.5297 - val_loss: 2.7065 - val_accuracy30: 0.5650 - 14s/epoch - 13ms/step
Epoch 16/50
1060/1060 - 14s - loss: 2.5852 - accuracy30: 0.5315 - val_loss: 2.6971 - val_accuracy30: 0.5658 - 14s/epoch - 14ms/step
Epoch 17/50
1060/1060 - 14s - loss: 2.5731 - accuracy30: 0.5346 - val_loss: 2.7036 - val_accuracy30: 0.5728 - 14s/epoch - 14ms/step
Epoch 18/50
1060/1060 - 14s - loss: 2.5650 - accuracy30: 0.5355 - val_loss: 2.6964 - val_accuracy30: 0.5656 - 14s/epoch - 13ms/step
Epoch 19/50
1060/1060 - 15s - loss: 2.5508 - accuracy30: 0.5386 - val_loss: 2.7165 - val_accuracy30: 0.5715 - 15s/epoch - 14ms/step
Epoch 20/50
1060/1060 - 15s - loss: 2.5452 - accuracy30: 0.5374 - val_loss: 2.6956 - val_accuracy30: 0.5757 - 15s/epoch - 14ms/step
Epoch 21/50
1060/1060 - 15s - loss: 2.5342 - accuracy30: 0.5385 - val_loss: 2.7120 - val_accuracy30: 0.5810 - 15s/epoch - 14ms/step
testing model: results/EXC/W10/deepOF_L1/h30
Evaluating performance on  test set...
5267/5267 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9454626
{'0': {'precision': 0.3524313445432708, 'recall': 0.44862524069651166, 'f1-score': 0.39475262968443786, 'support': 242006}, '1': {'precision': 0.7088275563282298, 'recall': 0.5915862668405041, 'f1-score': 0.6449218555061215, 'support': 862875}, '2': {'precision': 0.33666906272463043, 'recall': 0.4427565628044044, 'f1-score': 0.38249303623642533, 'support': 243303}, 'accuracy': 0.5390651424434647, 'macro avg': {'precision': 0.46597598786537703, 'recall': 0.4943226901138067, 'f1-score': 0.47405584047566157, 'support': 1348184}, 'weighted avg': {'precision': 0.577690189619778, 'recall': 0.5390651424434647, 'f1-score': 0.5526553898909108, 'support': 1348184}}
[[108570 106155  27281]
 [167445 510465 184965]
 [ 32045 103534 107724]]
Evaluating performance on  train set...
1060/1060 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85112035
{'0': {'precision': 0.33432272876352903, 'recall': 0.5429149689755266, 'f1-score': 0.413819001126549, 'support': 37551}, '1': {'precision': 0.8104087762831396, 'recall': 0.6346087961424196, 'f1-score': 0.7118149255957075, 'support': 195563}, '2': {'precision': 0.34482517237758564, 'recall': 0.5165146272412708, 'f1-score': 0.4135586105572463, 'support': 38148}, 'accuracy': 0.6053077836187892, 'macro avg': {'precision': 0.49651889247475145, 'recall': 0.564679464119739, 'f1-score': 0.5130641790931675, 'support': 271262}, 'weighted avg': {'precision': 0.67902807978972, 'recall': 0.6053077836187892, 'f1-score': 0.6286188757773452, 'support': 271262}}
[[ 20387  14287   2877]
 [ 36896 124106  34561]
 [  3697  14747  19704]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8746303
{'0': {'precision': 0.3334556631038121, 'recall': 0.5345639064568319, 'f1-score': 0.41071277226883635, 'support': 13598}, '1': {'precision': 0.8174253910728153, 'recall': 0.5812024243061673, 'f1-score': 0.6793653232932498, 'support': 76063}, '2': {'precision': 0.27869209809264306, 'recall': 0.5580938523099309, 'f1-score': 0.3717470317421856, 'support': 13745}, 'accuracy': 0.5719977564164556, 'macro avg': {'precision': 0.47652438408975684, 'recall': 0.5579533943576434, 'f1-score': 0.4872750424347572, 'support': 103406}, 'weighted avg': {'precision': 0.6821729930211068, 'recall': 0.5719977564164556, 'f1-score': 0.6031477845991765, 'support': 103406}}
[[ 7269  5080  1249]
 [13250 44208 18605]
 [ 1280  4794  7671]]
training model: results/EXC/W10/deepOF_L1/h50
Epoch 1/50
1060/1060 - 17s - loss: 3.0496 - accuracy50: 0.4189 - val_loss: 2.8780 - val_accuracy50: 0.5326 - 17s/epoch - 16ms/step
Epoch 2/50
1060/1060 - 15s - loss: 2.9197 - accuracy50: 0.4471 - val_loss: 2.8282 - val_accuracy50: 0.5075 - 15s/epoch - 14ms/step
Epoch 3/50
1060/1060 - 15s - loss: 2.8638 - accuracy50: 0.4575 - val_loss: 2.8094 - val_accuracy50: 0.5106 - 15s/epoch - 14ms/step
Epoch 4/50
1060/1060 - 15s - loss: 2.8320 - accuracy50: 0.4706 - val_loss: 2.8157 - val_accuracy50: 0.5044 - 15s/epoch - 14ms/step
Epoch 5/50
1060/1060 - 14s - loss: 2.8100 - accuracy50: 0.4793 - val_loss: 2.8139 - val_accuracy50: 0.5119 - 14s/epoch - 14ms/step
Epoch 6/50
1060/1060 - 15s - loss: 2.7930 - accuracy50: 0.4839 - val_loss: 2.8153 - val_accuracy50: 0.5102 - 15s/epoch - 14ms/step
Epoch 7/50
1060/1060 - 14s - loss: 2.7804 - accuracy50: 0.4903 - val_loss: 2.8093 - val_accuracy50: 0.5111 - 14s/epoch - 14ms/step
Epoch 8/50
1060/1060 - 14s - loss: 2.7657 - accuracy50: 0.4937 - val_loss: 2.8062 - val_accuracy50: 0.5154 - 14s/epoch - 14ms/step
Epoch 9/50
1060/1060 - 15s - loss: 2.7546 - accuracy50: 0.4980 - val_loss: 2.7842 - val_accuracy50: 0.5206 - 15s/epoch - 14ms/step
Epoch 10/50
1060/1060 - 14s - loss: 2.7444 - accuracy50: 0.4995 - val_loss: 2.8036 - val_accuracy50: 0.5281 - 14s/epoch - 14ms/step
Epoch 11/50
1060/1060 - 14s - loss: 2.7347 - accuracy50: 0.5016 - val_loss: 2.7875 - val_accuracy50: 0.5292 - 14s/epoch - 13ms/step
Epoch 12/50
1060/1060 - 14s - loss: 2.7229 - accuracy50: 0.5054 - val_loss: 2.7842 - val_accuracy50: 0.5293 - 14s/epoch - 14ms/step
Epoch 13/50
1060/1060 - 14s - loss: 2.7129 - accuracy50: 0.5072 - val_loss: 2.7857 - val_accuracy50: 0.5403 - 14s/epoch - 14ms/step
Epoch 14/50
1060/1060 - 14s - loss: 2.7034 - accuracy50: 0.5108 - val_loss: 2.7827 - val_accuracy50: 0.5362 - 14s/epoch - 14ms/step
Epoch 15/50
1060/1060 - 14s - loss: 2.6926 - accuracy50: 0.5115 - val_loss: 2.7991 - val_accuracy50: 0.5395 - 14s/epoch - 14ms/step
Epoch 16/50
1060/1060 - 14s - loss: 2.6842 - accuracy50: 0.5136 - val_loss: 2.7856 - val_accuracy50: 0.5409 - 14s/epoch - 13ms/step
Epoch 17/50
1060/1060 - 14s - loss: 2.6733 - accuracy50: 0.5150 - val_loss: 2.7857 - val_accuracy50: 0.5512 - 14s/epoch - 14ms/step
Epoch 18/50
1060/1060 - 14s - loss: 2.6642 - accuracy50: 0.5151 - val_loss: 2.8056 - val_accuracy50: 0.5429 - 14s/epoch - 14ms/step
Epoch 19/50
1060/1060 - 14s - loss: 2.6536 - accuracy50: 0.5175 - val_loss: 2.8063 - val_accuracy50: 0.5495 - 14s/epoch - 13ms/step
Epoch 20/50
1060/1060 - 14s - loss: 2.6445 - accuracy50: 0.5207 - val_loss: 2.7980 - val_accuracy50: 0.5487 - 14s/epoch - 14ms/step
Epoch 21/50
1060/1060 - 14s - loss: 2.6367 - accuracy50: 0.5224 - val_loss: 2.8366 - val_accuracy50: 0.5501 - 14s/epoch - 14ms/step
Epoch 22/50
1060/1060 - 14s - loss: 2.6262 - accuracy50: 0.5241 - val_loss: 2.8301 - val_accuracy50: 0.5489 - 14s/epoch - 14ms/step
Epoch 23/50
1060/1060 - 14s - loss: 2.6193 - accuracy50: 0.5260 - val_loss: 2.8377 - val_accuracy50: 0.5458 - 14s/epoch - 14ms/step
Epoch 24/50
1060/1060 - 14s - loss: 2.6043 - accuracy50: 0.5274 - val_loss: 2.8390 - val_accuracy50: 0.5552 - 14s/epoch - 14ms/step
testing model: results/EXC/W10/deepOF_L1/h50
Evaluating performance on  test set...
5267/5267 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9994995
{'0': {'precision': 0.3901960403349589, 'recall': 0.45943004673355337, 'f1-score': 0.42199218638606095, 'support': 305990}, '1': {'precision': 0.6065432538486595, 'recall': 0.5433011069496917, 'f1-score': 0.5731830019152225, 'support': 733457}, '2': {'precision': 0.39392721481691895, 'recall': 0.42222992385104474, 'f1-score': 0.40758782845779606, 'support': 308737}, 'accuracy': 0.49653978982097396, 'macro avg': {'precision': 0.46355550300017906, 'recall': 0.47498702584476327, 'f1-score': 0.46758767225302655, 'support': 1348184}, 'weighted avg': {'precision': 0.5087505772513998, 'recall': 0.49653978982097396, 'f1-score': 0.5009463971850865, 'support': 1348184}}
[[140581 128458  36951]
 [171359 398488 163610]
 [ 48343 130036 130358]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8993027
{'0': {'precision': 0.3789035969228637, 'recall': 0.5529573590096286, 'f1-score': 0.4496755249586696, 'support': 49436}, '1': {'precision': 0.7243208361993774, 'recall': 0.5947294567008449, 'f1-score': 0.6531592308626898, 'support': 171747}, '2': {'precision': 0.41667527281489897, 'recall': 0.4833962339503584, 'f1-score': 0.4475627906116827, 'support': 50079}, 'accuracy': 0.5665629538969704, 'macro avg': {'precision': 0.50663323531238, 'recall': 0.543694349886944, 'f1-score': 0.5167991821443474, 'support': 271262}, 'weighted avg': {'precision': 0.6045745067849919, 'recall': 0.5665629538969704, 'f1-score': 0.5781192893434157, 'support': 271262}}
[[ 27336  18405   3695]
 [ 39409 102143  30195]
 [  5400  20471  24208]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9209389
{'0': {'precision': 0.370264670237304, 'recall': 0.5317798989331836, 'f1-score': 0.4365622623245523, 'support': 17810}, '1': {'precision': 0.7363469342432012, 'recall': 0.5412560845304524, 'f1-score': 0.623906256682205, 'support': 67384}, '2': {'precision': 0.34312270285552726, 'recall': 0.5331100373380189, 'f1-score': 0.417519566526189, 'support': 18212}, 'accuracy': 0.5381892733497089, 'macro avg': {'precision': 0.4832447691120108, 'recall': 0.5353820069338849, 'f1-score': 0.49266269517764877, 'support': 103406}, 'weighted avg': {'precision': 0.604040058201411, 'recall': 0.5381892733497089, 'f1-score': 0.5552902098316242, 'support': 103406}}
[[ 9471  6498  1841]
 [14166 36472 16746]
 [ 1942  6561  9709]]
training model: results/EXC/W10/deepOF_L1/h100
Epoch 1/50
1060/1060 - 17s - loss: 3.1772 - accuracy100: 0.4115 - val_loss: 3.0799 - val_accuracy100: 0.4846 - 17s/epoch - 16ms/step
Epoch 2/50
1060/1060 - 15s - loss: 3.0952 - accuracy100: 0.4337 - val_loss: 3.0322 - val_accuracy100: 0.4673 - 15s/epoch - 14ms/step
Epoch 3/50
1060/1060 - 15s - loss: 3.0576 - accuracy100: 0.4440 - val_loss: 3.0143 - val_accuracy100: 0.4699 - 15s/epoch - 14ms/step
Epoch 4/50
1060/1060 - 15s - loss: 3.0314 - accuracy100: 0.4517 - val_loss: 3.0185 - val_accuracy100: 0.4692 - 15s/epoch - 14ms/step
Epoch 5/50
1060/1060 - 15s - loss: 3.0134 - accuracy100: 0.4576 - val_loss: 3.0161 - val_accuracy100: 0.4683 - 15s/epoch - 14ms/step
Epoch 6/50
1060/1060 - 14s - loss: 3.0008 - accuracy100: 0.4619 - val_loss: 3.0229 - val_accuracy100: 0.4729 - 14s/epoch - 14ms/step
Epoch 7/50
1060/1060 - 14s - loss: 2.9896 - accuracy100: 0.4660 - val_loss: 3.0149 - val_accuracy100: 0.4784 - 14s/epoch - 14ms/step
Epoch 8/50
1060/1060 - 14s - loss: 2.9787 - accuracy100: 0.4701 - val_loss: 3.0236 - val_accuracy100: 0.4780 - 14s/epoch - 14ms/step
Epoch 9/50
1060/1060 - 15s - loss: 2.9684 - accuracy100: 0.4720 - val_loss: 3.0292 - val_accuracy100: 0.4805 - 15s/epoch - 14ms/step
Epoch 10/50
1060/1060 - 14s - loss: 2.9606 - accuracy100: 0.4740 - val_loss: 3.0330 - val_accuracy100: 0.4841 - 14s/epoch - 14ms/step
Epoch 11/50
1060/1060 - 15s - loss: 2.9516 - accuracy100: 0.4762 - val_loss: 3.0372 - val_accuracy100: 0.4833 - 15s/epoch - 14ms/step
Epoch 12/50
1060/1060 - 14s - loss: 2.9425 - accuracy100: 0.4805 - val_loss: 3.0419 - val_accuracy100: 0.4828 - 14s/epoch - 13ms/step
Epoch 13/50
1060/1060 - 14s - loss: 2.9340 - accuracy100: 0.4818 - val_loss: 3.0417 - val_accuracy100: 0.4876 - 14s/epoch - 14ms/step
testing model: results/EXC/W10/deepOF_L1/h100
Evaluating performance on  test set...
5267/5267 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0703008
{'0': {'precision': 0.43652946610554716, 'recall': 0.4389237007003317, 'f1-score': 0.4377233094646454, 'support': 406950}, '1': {'precision': 0.4299701382358196, 'recall': 0.4174605897714493, 'f1-score': 0.42362303267930873, 'support': 524610}, '2': {'precision': 0.4349350059931806, 'recall': 0.44853873036598946, 'f1-score': 0.4416321331381258, 'support': 416624}, 'accuracy': 0.43354319588424134, 'macro avg': {'precision': 0.43381153677818246, 'recall': 0.4349743402792568, 'f1-score': 0.43432615842735994, 'support': 1348184}, 'weighted avg': {'precision': 0.43348434812195413, 'recall': 0.43354319588424134, 'f1-score': 0.43344448962238696, 'support': 1348184}}
[[178620 145908  82422]
 [145245 219004 160361]
 [ 85317 144435 186872]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0117298
{'0': {'precision': 0.4188593338126048, 'recall': 0.49104521638971216, 'f1-score': 0.452088896935681, 'support': 71191}, '1': {'precision': 0.5281123266793382, 'recall': 0.470568494005994, 'f1-score': 0.49768257702387586, 'support': 128128}, '2': {'precision': 0.4465267875331025, 'recall': 0.4570284808806972, 'f1-score': 0.4517166055310555, 'support': 71943}, 'accuracy': 0.4723514535762473, 'macro avg': {'precision': 0.4644994826750151, 'recall': 0.4728807304254678, 'f1-score': 0.4671626931635375, 'support': 271262}, 'weighted avg': {'precision': 0.47780178462784084, 'recall': 0.4723514535762473, 'f1-score': 0.473525896153475, 'support': 271262}}
[[34958 26752  9481]
 [36561 60293 31274]
 [11941 27122 32880]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.010115
{'0': {'precision': 0.416357778778536, 'recall': 0.47048461598684727, 'f1-score': 0.44176943009942476, 'support': 25546}, '1': {'precision': 0.5533342921520686, 'recall': 0.4507537295946263, 'f1-score': 0.49680404605617134, 'support': 51212}, '2': {'precision': 0.41625788367203925, 'recall': 0.5126838787151006, 'f1-score': 0.4594662765474449, 'support': 26648}, 'accuracy': 0.47158772218246525, 'macro avg': {'precision': 0.4619833182008813, 'recall': 0.4779740747655247, 'f1-score': 0.4660132509010137, 'support': 103406}, 'weighted avg': {'precision': 0.4841698902429329, 'recall': 0.47158772218246525, 'f1-score': 0.4735859428406946, 'support': 103406}}
[[12019  9444  4083]
 [13052 23084 15076]
 [ 3796  9190 13662]]
training model: results/EXC/W10/deepOF_L1/h200
Epoch 1/50
1060/1060 - 17s - loss: 3.2688 - accuracy200: 0.3902 - val_loss: 3.2295 - val_accuracy200: 0.4041 - 17s/epoch - 16ms/step
Epoch 2/50
1060/1060 - 15s - loss: 3.2245 - accuracy200: 0.4101 - val_loss: 3.2103 - val_accuracy200: 0.4118 - 15s/epoch - 14ms/step
Epoch 3/50
1060/1060 - 15s - loss: 3.2081 - accuracy200: 0.4160 - val_loss: 3.2010 - val_accuracy200: 0.4163 - 15s/epoch - 14ms/step
Epoch 4/50
1060/1060 - 15s - loss: 3.1964 - accuracy200: 0.4211 - val_loss: 3.1951 - val_accuracy200: 0.4172 - 15s/epoch - 14ms/step
Epoch 5/50
1060/1060 - 15s - loss: 3.1856 - accuracy200: 0.4261 - val_loss: 3.1910 - val_accuracy200: 0.4208 - 15s/epoch - 14ms/step
Epoch 6/50
1060/1060 - 14s - loss: 3.1767 - accuracy200: 0.4310 - val_loss: 3.1957 - val_accuracy200: 0.4215 - 14s/epoch - 13ms/step
Epoch 7/50
1060/1060 - 15s - loss: 3.1689 - accuracy200: 0.4351 - val_loss: 3.1903 - val_accuracy200: 0.4248 - 15s/epoch - 14ms/step
Epoch 8/50
1060/1060 - 14s - loss: 3.1628 - accuracy200: 0.4375 - val_loss: 3.1893 - val_accuracy200: 0.4230 - 14s/epoch - 14ms/step
Epoch 9/50
1060/1060 - 14s - loss: 3.1555 - accuracy200: 0.4405 - val_loss: 3.1971 - val_accuracy200: 0.4242 - 14s/epoch - 13ms/step
Epoch 10/50
1060/1060 - 14s - loss: 3.1500 - accuracy200: 0.4432 - val_loss: 3.1944 - val_accuracy200: 0.4230 - 14s/epoch - 14ms/step
Epoch 11/50
1060/1060 - 14s - loss: 3.1463 - accuracy200: 0.4446 - val_loss: 3.1987 - val_accuracy200: 0.4226 - 14s/epoch - 14ms/step
Epoch 12/50
1060/1060 - 14s - loss: 3.1402 - accuracy200: 0.4470 - val_loss: 3.2032 - val_accuracy200: 0.4213 - 14s/epoch - 13ms/step
Epoch 13/50
1060/1060 - 14s - loss: 3.1356 - accuracy200: 0.4496 - val_loss: 3.2058 - val_accuracy200: 0.4236 - 14s/epoch - 13ms/step
Epoch 14/50
1060/1060 - 15s - loss: 3.1312 - accuracy200: 0.4513 - val_loss: 3.2070 - val_accuracy200: 0.4242 - 15s/epoch - 14ms/step
Epoch 15/50
1060/1060 - 15s - loss: 3.1265 - accuracy200: 0.4535 - val_loss: 3.2148 - val_accuracy200: 0.4208 - 15s/epoch - 14ms/step
Epoch 16/50
1060/1060 - 14s - loss: 3.1200 - accuracy200: 0.4550 - val_loss: 3.2168 - val_accuracy200: 0.4199 - 14s/epoch - 14ms/step
Epoch 17/50
1060/1060 - 14s - loss: 3.1151 - accuracy200: 0.4575 - val_loss: 3.2231 - val_accuracy200: 0.4209 - 14s/epoch - 14ms/step
Epoch 18/50
1060/1060 - 14s - loss: 3.1092 - accuracy200: 0.4600 - val_loss: 3.2308 - val_accuracy200: 0.4210 - 14s/epoch - 13ms/step
testing model: results/EXC/W10/deepOF_L1/h200
Evaluating performance on  test set...
5267/5267 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.090042
{'0': {'precision': 0.46812521214951697, 'recall': 0.40344198012406896, 'f1-score': 0.43338336782258596, 'support': 481990}, '1': {'precision': 0.2914969912808547, 'recall': 0.32416420845624383, 'f1-score': 0.30696393239101477, 'support': 366120}, '2': {'precision': 0.4644578164267383, 'recall': 0.4882057455496587, 'f1-score': 0.4760357876490299, 'support': 500074}, 'accuracy': 0.413353815206233, 'macro avg': {'precision': 0.40802667328570336, 'recall': 0.4052706447099905, 'f1-score': 0.4054610292875435, 'support': 1348184}, 'weighted avg': {'precision': 0.41879878973751133, 'recall': 0.413353815206233, 'f1-score': 0.41487304763786514, 'support': 1348184}}
[[194455 146537 140998]
 [106931 118683 140506]
 [114005 141930 244139]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0594937
{'0': {'precision': 0.4670189375132988, 'recall': 0.438250856933675, 'f1-score': 0.4521777945645269, 'support': 90147}, '1': {'precision': 0.3667855149395696, 'recall': 0.3572863150653011, 'f1-score': 0.3619736043348248, 'support': 90121}, '2': {'precision': 0.4609581213782223, 'recall': 0.5009121480537179, 'f1-score': 0.4801053324555629, 'support': 90994}, 'accuracy': 0.43237165544750095, 'macro avg': {'precision': 0.4315875246103636, 'recall': 0.43214977335089805, 'f1-score': 0.43141891045163816, 'support': 271262}, 'weighted avg': {'precision': 0.43168544377233176, 'recall': 0.43237165544750095, 'f1-score': 0.4315775872194728, 'support': 271262}}
[[39507 28560 22080]
 [26701 32199 31221]
 [18386 27028 45580]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0637312
{'0': {'precision': 0.4471067532108825, 'recall': 0.3983634797588286, 'f1-score': 0.4213300364393545, 'support': 32508}, '1': {'precision': 0.37659140237779004, 'recall': 0.3220221606648199, 'f1-score': 0.3471755588406576, 'support': 36100}, '2': {'precision': 0.4389874463543938, 'recall': 0.5496867636071039, 'f1-score': 0.4881397455691519, 'support': 34798}, 'accuracy': 0.4226350501905112, 'macro avg': {'precision': 0.42089520064768876, 'recall': 0.42335746801025076, 'f1-score': 0.41888178028305467, 'support': 103406}, 'weighted avg': {'precision': 0.4197568914517319, 'recall': 0.4226350501905112, 'f1-score': 0.4179246984220802, 'support': 103406}}
[[12950  9974  9584]
 [ 9614 11625 14861]
 [ 6400  9270 19128]]
training model: results/EXC/W10/deepOF_L1/h300
Epoch 1/50
1060/1060 - 17s - loss: 3.2965 - accuracy300: 0.3684 - val_loss: 3.2506 - val_accuracy300: 0.3768 - 17s/epoch - 16ms/step
Epoch 2/50
1060/1060 - 14s - loss: 3.2614 - accuracy300: 0.3862 - val_loss: 3.2401 - val_accuracy300: 0.3848 - 14s/epoch - 13ms/step
Epoch 3/50
1060/1060 - 14s - loss: 3.2497 - accuracy300: 0.3913 - val_loss: 3.2336 - val_accuracy300: 0.3890 - 14s/epoch - 13ms/step
Epoch 4/50
1060/1060 - 14s - loss: 3.2430 - accuracy300: 0.3944 - val_loss: 3.2317 - val_accuracy300: 0.3887 - 14s/epoch - 14ms/step
Epoch 5/50
1060/1060 - 14s - loss: 3.2376 - accuracy300: 0.3968 - val_loss: 3.2285 - val_accuracy300: 0.3891 - 14s/epoch - 14ms/step
Epoch 6/50
1060/1060 - 14s - loss: 3.2319 - accuracy300: 0.4006 - val_loss: 3.2271 - val_accuracy300: 0.3929 - 14s/epoch - 14ms/step
Epoch 7/50
1060/1060 - 14s - loss: 3.2279 - accuracy300: 0.4027 - val_loss: 3.2262 - val_accuracy300: 0.3937 - 14s/epoch - 14ms/step
Epoch 8/50
1060/1060 - 15s - loss: 3.2221 - accuracy300: 0.4067 - val_loss: 3.2277 - val_accuracy300: 0.3946 - 15s/epoch - 14ms/step
Epoch 9/50
1060/1060 - 14s - loss: 3.2186 - accuracy300: 0.4094 - val_loss: 3.2263 - val_accuracy300: 0.3956 - 14s/epoch - 14ms/step
Epoch 10/50
1060/1060 - 15s - loss: 3.2147 - accuracy300: 0.4113 - val_loss: 3.2258 - val_accuracy300: 0.3942 - 15s/epoch - 14ms/step
Epoch 11/50
1060/1060 - 15s - loss: 3.2111 - accuracy300: 0.4150 - val_loss: 3.2297 - val_accuracy300: 0.3951 - 15s/epoch - 14ms/step
Epoch 12/50
1060/1060 - 14s - loss: 3.2081 - accuracy300: 0.4148 - val_loss: 3.2344 - val_accuracy300: 0.3944 - 14s/epoch - 14ms/step
Epoch 13/50
1060/1060 - 15s - loss: 3.2045 - accuracy300: 0.4180 - val_loss: 3.2334 - val_accuracy300: 0.3937 - 15s/epoch - 14ms/step
Epoch 14/50
1060/1060 - 15s - loss: 3.2016 - accuracy300: 0.4195 - val_loss: 3.2373 - val_accuracy300: 0.3938 - 15s/epoch - 14ms/step
Epoch 15/50
1060/1060 - 15s - loss: 3.1990 - accuracy300: 0.4209 - val_loss: 3.2379 - val_accuracy300: 0.3938 - 15s/epoch - 14ms/step
Epoch 16/50
1060/1060 - 14s - loss: 3.1943 - accuracy300: 0.4232 - val_loss: 3.2321 - val_accuracy300: 0.3977 - 14s/epoch - 14ms/step
Epoch 17/50
1060/1060 - 15s - loss: 3.1914 - accuracy300: 0.4247 - val_loss: 3.2420 - val_accuracy300: 0.3951 - 15s/epoch - 14ms/step
Epoch 18/50
1060/1060 - 14s - loss: 3.1884 - accuracy300: 0.4265 - val_loss: 3.2433 - val_accuracy300: 0.3944 - 14s/epoch - 14ms/step
Epoch 19/50
1060/1060 - 14s - loss: 3.1841 - accuracy300: 0.4287 - val_loss: 3.2430 - val_accuracy300: 0.3943 - 14s/epoch - 14ms/step
Epoch 20/50
1060/1060 - 14s - loss: 3.1802 - accuracy300: 0.4299 - val_loss: 3.2435 - val_accuracy300: 0.3939 - 14s/epoch - 14ms/step
testing model: results/EXC/W10/deepOF_L1/h300
Evaluating performance on  test set...
5267/5267 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0903337
{'0': {'precision': 0.42415873127423076, 'recall': 0.3944651528585963, 'f1-score': 0.4087734111145226, 'support': 459019}, '1': {'precision': 0.3073759713090257, 'recall': 0.2157621035318601, 'f1-score': 0.25354715832891933, 'support': 417089}, '2': {'precision': 0.41421489075993917, 'recall': 0.551487472356146, 'f1-score': 0.4730946756314737, 'support': 472076}, 'accuracy': 0.3941620728327884, 'macro avg': {'precision': 0.38191653111439855, 'recall': 0.38723824291553416, 'f1-score': 0.37847174835830527, 'support': 1348184}, 'weighted avg': {'precision': 0.3845476299514498, 'recall': 0.3941620728327884, 'f1-score': 0.38327345170246147, 'support': 1348184}}
[[181067 103395 174557]
 [133474  89992 193623]
 [112344  99388 260344]]
Evaluating performance on  train set...
1060/1060 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0755082
{'0': {'precision': 0.4364845158401176, 'recall': 0.4215843934033516, 'f1-score': 0.42890508642866815, 'support': 90167}, '1': {'precision': 0.34044546211490423, 'recall': 0.2194860095282829, 'f1-score': 0.2669005752519277, 'support': 89418}, '2': {'precision': 0.4183442007508398, 'recall': 0.5773640062392966, 'f1-score': 0.48515595640736564, 'support': 91677}, 'accuracy': 0.40761330374324456, 'macro avg': {'precision': 0.3984247262352872, 'recall': 0.40614480305697703, 'f1-score': 0.39365387269598723, 'support': 271262}, 'weighted avg': {'precision': 0.39869569996306575, 'recall': 0.40761330374324456, 'f1-score': 0.3945132129876232, 'support': 271262}}
[[38013 19710 32444]
 [28642 19626 41150]
 [20434 18312 52931]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0752872
{'0': {'precision': 0.4069833808964244, 'recall': 0.38317107093184977, 'f1-score': 0.3947184187818498, 'support': 31636}, '1': {'precision': 0.3680984652182579, 'recall': 0.19743418415074168, 'f1-score': 0.2570151175130038, 'support': 37415}, '2': {'precision': 0.39857711052602096, 'recall': 0.6213069422209285, 'f1-score': 0.4856213313919097, 'support': 34355}, 'accuracy': 0.395083457439607, 'macro avg': {'precision': 0.39121965221356775, 'recall': 0.4006373991011733, 'f1-score': 0.3791182892289211, 'support': 103406}, 'weighted avg': {'precision': 0.39012094990911406, 'recall': 0.395083457439607, 'f1-score': 0.37509480454036226, 'support': 103406}}
[[12122  6417 13097]
 [10917  7387 19111]
 [ 6746  6264 21345]]
training model: results/EXC/W10/deepOF_L1/h500
Epoch 1/50
1060/1060 - 17s - loss: 3.3010 - accuracy500: 0.3674 - val_loss: 3.2764 - val_accuracy500: 0.3683 - 17s/epoch - 16ms/step
Epoch 2/50
1060/1060 - 15s - loss: 3.2752 - accuracy500: 0.3795 - val_loss: 3.2612 - val_accuracy500: 0.3894 - 15s/epoch - 14ms/step
Epoch 3/50
1060/1060 - 14s - loss: 3.2659 - accuracy500: 0.3818 - val_loss: 3.2551 - val_accuracy500: 0.3935 - 14s/epoch - 14ms/step
Epoch 4/50
1060/1060 - 14s - loss: 3.2613 - accuracy500: 0.3844 - val_loss: 3.2537 - val_accuracy500: 0.3963 - 14s/epoch - 14ms/step
Epoch 5/50
1060/1060 - 15s - loss: 3.2577 - accuracy500: 0.3865 - val_loss: 3.2509 - val_accuracy500: 0.3974 - 15s/epoch - 14ms/step
Epoch 6/50
1060/1060 - 15s - loss: 3.2547 - accuracy500: 0.3872 - val_loss: 3.2514 - val_accuracy500: 0.3977 - 15s/epoch - 14ms/step
Epoch 7/50
1060/1060 - 14s - loss: 3.2526 - accuracy500: 0.3890 - val_loss: 3.2499 - val_accuracy500: 0.3983 - 14s/epoch - 14ms/step
Epoch 8/50
1060/1060 - 14s - loss: 3.2496 - accuracy500: 0.3912 - val_loss: 3.2498 - val_accuracy500: 0.3985 - 14s/epoch - 14ms/step
Epoch 9/50
1060/1060 - 14s - loss: 3.2482 - accuracy500: 0.3923 - val_loss: 3.2487 - val_accuracy500: 0.3995 - 14s/epoch - 14ms/step
Epoch 10/50
1060/1060 - 14s - loss: 3.2457 - accuracy500: 0.3937 - val_loss: 3.2490 - val_accuracy500: 0.3993 - 14s/epoch - 14ms/step
Epoch 11/50
1060/1060 - 14s - loss: 3.2431 - accuracy500: 0.3950 - val_loss: 3.2494 - val_accuracy500: 0.3997 - 14s/epoch - 14ms/step
Epoch 12/50
1060/1060 - 14s - loss: 3.2409 - accuracy500: 0.3969 - val_loss: 3.2487 - val_accuracy500: 0.4004 - 14s/epoch - 14ms/step
Epoch 13/50
1060/1060 - 14s - loss: 3.2381 - accuracy500: 0.3991 - val_loss: 3.2507 - val_accuracy500: 0.4007 - 14s/epoch - 14ms/step
Epoch 14/50
1060/1060 - 14s - loss: 3.2359 - accuracy500: 0.4017 - val_loss: 3.2512 - val_accuracy500: 0.4001 - 14s/epoch - 13ms/step
Epoch 15/50
1060/1060 - 15s - loss: 3.2339 - accuracy500: 0.4020 - val_loss: 3.2512 - val_accuracy500: 0.4023 - 15s/epoch - 14ms/step
Epoch 16/50
1060/1060 - 14s - loss: 3.2318 - accuracy500: 0.4040 - val_loss: 3.2517 - val_accuracy500: 0.4009 - 14s/epoch - 14ms/step
Epoch 17/50
1060/1060 - 14s - loss: 3.2287 - accuracy500: 0.4066 - val_loss: 3.2520 - val_accuracy500: 0.3994 - 14s/epoch - 13ms/step
Epoch 18/50
1060/1060 - 14s - loss: 3.2262 - accuracy500: 0.4086 - val_loss: 3.2544 - val_accuracy500: 0.4004 - 14s/epoch - 14ms/step
Epoch 19/50
1060/1060 - 14s - loss: 3.2222 - accuracy500: 0.4112 - val_loss: 3.2599 - val_accuracy500: 0.3995 - 14s/epoch - 13ms/step
testing model: results/EXC/W10/deepOF_L1/h500
Evaluating performance on  test set...
5267/5267 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0936903
{'0': {'precision': 0.3850524431973311, 'recall': 0.43580015788880117, 'f1-score': 0.4088576080987715, 'support': 443350}, '1': {'precision': 0.3720917019402858, 'recall': 0.02904071198300748, 'f1-score': 0.05387651345164667, 'support': 451022}, '2': {'precision': 0.37125648112307413, 'recall': 0.6636316360078622, 'f1-score': 0.47614334703015143, 'support': 453812}, 'accuracy': 0.37641301187375015, 'macro avg': {'precision': 0.376133542086897, 'recall': 0.37615750195989034, 'f1-score': 0.3129591561935232, 'support': 1348184}, 'weighted avg': {'precision': 0.37607269519255004, 'recall': 0.37641301187375015, 'f1-score': 0.31275113634565166, 'support': 1348184}}
[[193212   9732 240406]
 [168292  13098 269632]
 [140277  12371 301164]]
Evaluating performance on  train set...
1060/1060 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0846865
{'0': {'precision': 0.3987671743007781, 'recall': 0.4548055751154031, 'f1-score': 0.42494686989259106, 'support': 89469}, '1': {'precision': 0.3831506058857473, 'recall': 0.0221875696146135, 'f1-score': 0.04194611440423673, 'support': 89780}, '2': {'precision': 0.3836459965492224, 'recall': 0.6838816254224946, 'f1-score': 0.49154409180030784, 'support': 92013}, 'accuracy': 0.3893247119021463, 'macro avg': {'precision': 0.38852125891191597, 'recall': 0.3869582567175038, 'f1-score': 0.3194790253657119, 'support': 271262}, 'weighted avg': {'precision': 0.3884693793985973, 'recall': 0.3893247119021463, 'f1-score': 0.32077452858289884, 'support': 271262}}
[[40691  1467 47311]
 [34004  1992 53784]
 [27347  1740 62926]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0824918
{'0': {'precision': 0.3917551917495562, 'recall': 0.4226606675989542, 'f1-score': 0.4066215287425237, 'support': 32894}, '1': {'precision': 0.3609979633401222, 'recall': 0.021338068438318234, 'f1-score': 0.04029439345287147, 'support': 33227}, '2': {'precision': 0.4048943944930481, 'recall': 0.7162129542711546, 'f1-score': 0.5173288905248068, 'support': 37285}, 'accuracy': 0.39955128329110495, 'macro avg': {'precision': 0.3858825165275755, 'recall': 0.3867372301028091, 'f1-score': 0.3214149375734006, 'support': 103406}, 'weighted avg': {'precision': 0.3866096948338147, 'recall': 0.39955128329110495, 'f1-score': 0.328828869320277, 'support': 103406}}
[[13903   543 18448]
 [11717   709 20801]
 [ 9869   712 26704]]
training model: results/EXC/W10/deepOF_L1/h1000
Epoch 1/50
1060/1060 - 18s - loss: 3.2812 - accuracy1000: 0.3870 - val_loss: 3.2742 - val_accuracy1000: 0.4423 - 18s/epoch - 17ms/step
Epoch 2/50
1060/1060 - 16s - loss: 3.2642 - accuracy1000: 0.3946 - val_loss: 3.2409 - val_accuracy1000: 0.4430 - 16s/epoch - 15ms/step
Epoch 3/50
1060/1060 - 15s - loss: 3.2631 - accuracy1000: 0.3917 - val_loss: 3.2206 - val_accuracy1000: 0.4434 - 15s/epoch - 14ms/step
Epoch 4/50
1060/1060 - 15s - loss: 3.2664 - accuracy1000: 0.3863 - val_loss: 3.2089 - val_accuracy1000: 0.4431 - 15s/epoch - 14ms/step
Epoch 5/50
1060/1060 - 14s - loss: 3.2669 - accuracy1000: 0.3839 - val_loss: 3.2030 - val_accuracy1000: 0.4432 - 14s/epoch - 14ms/step
Epoch 6/50
1060/1060 - 15s - loss: 3.2693 - accuracy1000: 0.3817 - val_loss: 3.2006 - val_accuracy1000: 0.4438 - 15s/epoch - 14ms/step
Epoch 7/50
1060/1060 - 14s - loss: 3.2684 - accuracy1000: 0.3824 - val_loss: 3.2000 - val_accuracy1000: 0.4436 - 14s/epoch - 14ms/step
Epoch 8/50
1060/1060 - 15s - loss: 3.2681 - accuracy1000: 0.3827 - val_loss: 3.1974 - val_accuracy1000: 0.4438 - 15s/epoch - 14ms/step
Epoch 9/50
1060/1060 - 15s - loss: 3.2685 - accuracy1000: 0.3821 - val_loss: 3.1972 - val_accuracy1000: 0.4437 - 15s/epoch - 14ms/step
Epoch 10/50
1060/1060 - 15s - loss: 3.2681 - accuracy1000: 0.3820 - val_loss: 3.1956 - val_accuracy1000: 0.4435 - 15s/epoch - 14ms/step
Epoch 11/50
1060/1060 - 14s - loss: 3.2671 - accuracy1000: 0.3822 - val_loss: 3.1954 - val_accuracy1000: 0.4439 - 14s/epoch - 14ms/step
Epoch 12/50
1060/1060 - 14s - loss: 3.2666 - accuracy1000: 0.3832 - val_loss: 3.1943 - val_accuracy1000: 0.4438 - 14s/epoch - 14ms/step
Epoch 13/50
1060/1060 - 14s - loss: 3.2664 - accuracy1000: 0.3828 - val_loss: 3.1945 - val_accuracy1000: 0.4438 - 14s/epoch - 14ms/step
Epoch 14/50
1060/1060 - 14s - loss: 3.2657 - accuracy1000: 0.3836 - val_loss: 3.1947 - val_accuracy1000: 0.4436 - 14s/epoch - 14ms/step
Epoch 15/50
1060/1060 - 15s - loss: 3.2647 - accuracy1000: 0.3846 - val_loss: 3.1949 - val_accuracy1000: 0.4436 - 15s/epoch - 14ms/step
Epoch 16/50
1060/1060 - 15s - loss: 3.2634 - accuracy1000: 0.3868 - val_loss: 3.1946 - val_accuracy1000: 0.4434 - 15s/epoch - 14ms/step
Epoch 17/50
1060/1060 - 15s - loss: 3.2619 - accuracy1000: 0.3880 - val_loss: 3.1947 - val_accuracy1000: 0.4434 - 15s/epoch - 14ms/step
Epoch 18/50
1060/1060 - 15s - loss: 3.2614 - accuracy1000: 0.3886 - val_loss: 3.1941 - val_accuracy1000: 0.4437 - 15s/epoch - 14ms/step
Epoch 19/50
1060/1060 - 14s - loss: 3.2599 - accuracy1000: 0.3889 - val_loss: 3.1942 - val_accuracy1000: 0.4434 - 14s/epoch - 14ms/step
Epoch 20/50
1060/1060 - 15s - loss: 3.2582 - accuracy1000: 0.3908 - val_loss: 3.1950 - val_accuracy1000: 0.4427 - 15s/epoch - 14ms/step
Epoch 21/50
1060/1060 - 14s - loss: 3.2582 - accuracy1000: 0.3912 - val_loss: 3.1949 - val_accuracy1000: 0.4433 - 14s/epoch - 14ms/step
Epoch 22/50
1060/1060 - 14s - loss: 3.2564 - accuracy1000: 0.3927 - val_loss: 3.1958 - val_accuracy1000: 0.4428 - 14s/epoch - 13ms/step
Epoch 23/50
1060/1060 - 14s - loss: 3.2550 - accuracy1000: 0.3937 - val_loss: 3.1956 - val_accuracy1000: 0.4431 - 14s/epoch - 14ms/step
Epoch 24/50
1060/1060 - 14s - loss: 3.2533 - accuracy1000: 0.3949 - val_loss: 3.1975 - val_accuracy1000: 0.4426 - 14s/epoch - 13ms/step
Epoch 25/50
1060/1060 - 14s - loss: 3.2514 - accuracy1000: 0.3961 - val_loss: 3.1985 - val_accuracy1000: 0.4420 - 14s/epoch - 14ms/step
Epoch 26/50
1060/1060 - 14s - loss: 3.2503 - accuracy1000: 0.3970 - val_loss: 3.1990 - val_accuracy1000: 0.4424 - 14s/epoch - 13ms/step
Epoch 27/50
1060/1060 - 14s - loss: 3.2493 - accuracy1000: 0.3973 - val_loss: 3.1984 - val_accuracy1000: 0.4420 - 14s/epoch - 14ms/step
Epoch 28/50
1060/1060 - 14s - loss: 3.2477 - accuracy1000: 0.3993 - val_loss: 3.1999 - val_accuracy1000: 0.4426 - 14s/epoch - 14ms/step
testing model: results/EXC/W10/deepOF_L1/h1000
Evaluating performance on  test set...
5267/5267 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0804621
{'0': {'precision': 0.34950018511662345, 'recall': 0.0024459950717345058, 'f1-score': 0.00485799124120647, 'support': 385937}, '1': {'precision': 0.4222730866242518, 'recall': 0.9843253365814105, 'f1-score': 0.5910060629435441, 'support': 569773}, '2': {'precision': 0.3302948133617954, 'recall': 0.01458695353067974, 'f1-score': 0.027939981503488226, 'support': 392474}, 'accuracy': 0.42094476718311447, 'macro avg': {'precision': 0.3673560283675568, 'recall': 0.33378609506127493, 'f1-score': 0.20793467856274625, 'support': 1348184}, 'weighted avg': {'precision': 0.37466472151269514, 'recall': 0.42094476718311447, 'f1-score': 0.2592968707296552, 'support': 1348184}}
[[   944 381225   3768]
 [  1091 560842   7840]
 [   666 386083   5725]]
Evaluating performance on  train set...
1060/1060 - 5s - 5s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1190372
{'0': {'precision': 0.48015122873345933, 'recall': 0.0028462572837292693, 'f1-score': 0.005658969131882944, 'support': 89240}, '1': {'precision': 0.33029207294547, 'recall': 0.988651595031722, 'f1-score': 0.4951595624166105, 'support': 89528}, '2': {'precision': 0.4680232558139535, 'recall': 0.013925227582329665, 'f1-score': 0.02704575520231821, 'support': 92494}, 'accuracy': 0.3319816266192832, 'macro avg': {'precision': 0.4261555191642943, 'recall': 0.3351410266325936, 'f1-score': 0.17595476225027054, 'support': 271262}, 'weighted avg': {'precision': 0.4265559768124241, 'recall': 0.3319816266192832, 'f1-score': 0.17450738323483111, 'support': 271262}}
[[  254 88387   599]
 [  151 88512   865]
 [  124 91082  1288]]
Evaluating performance on  val set...
404/404 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.065161
{'0': {'precision': 0.39106145251396646, 'recall': 0.002651213877210923, 'f1-score': 0.005266721841847867, 'support': 26403}, '1': {'precision': 0.44411444702561237, 'recall': 0.9869951640308456, 'f1-score': 0.6125859376584396, 'support': 45906}, '2': {'precision': 0.37976782752902155, 'recall': 0.01472810882078657, 'f1-score': 0.028356499396340898, 'support': 31097}, 'accuracy': 0.4432721505521923, 'macro avg': {'precision': 0.4049812423562001, 'recall': 0.334791495576281, 'f1-score': 0.21540305296554277, 'support': 103406}, 'weighted avg': {'precision': 0.41121746773450285, 'recall': 0.4432721505521923, 'f1-score': 0.28182338909412075, 'support': 103406}}
[[   70 26116   217]
 [   66 45309   531]
 [   43 30596   458]]
training model: results/EXC/W10/deepLOB_L2/h10
Epoch 1/50
1060/1060 - 46s - loss: 2.7120 - accuracy10: 0.4531 - val_loss: 2.4679 - val_accuracy10: 0.5139 - 46s/epoch - 43ms/step
Epoch 2/50
1060/1060 - 43s - loss: 2.4188 - accuracy10: 0.5328 - val_loss: 2.3242 - val_accuracy10: 0.5649 - 43s/epoch - 41ms/step
Epoch 3/50
1060/1060 - 43s - loss: 2.3033 - accuracy10: 0.5767 - val_loss: 2.2652 - val_accuracy10: 0.6148 - 43s/epoch - 41ms/step
Epoch 4/50
1060/1060 - 43s - loss: 2.1965 - accuracy10: 0.6286 - val_loss: 2.2154 - val_accuracy10: 0.6175 - 43s/epoch - 41ms/step
Epoch 5/50
1060/1060 - 43s - loss: 2.1074 - accuracy10: 0.6621 - val_loss: 2.1730 - val_accuracy10: 0.6091 - 43s/epoch - 41ms/step
Epoch 6/50
1060/1060 - 43s - loss: 2.0582 - accuracy10: 0.6742 - val_loss: 2.1567 - val_accuracy10: 0.6610 - 43s/epoch - 41ms/step
Epoch 7/50
1060/1060 - 44s - loss: 2.0260 - accuracy10: 0.6761 - val_loss: 2.1426 - val_accuracy10: 0.6699 - 44s/epoch - 41ms/step
Epoch 8/50
1060/1060 - 43s - loss: 1.9921 - accuracy10: 0.6822 - val_loss: 2.0803 - val_accuracy10: 0.6428 - 43s/epoch - 41ms/step
Epoch 9/50
1060/1060 - 43s - loss: 1.9696 - accuracy10: 0.6824 - val_loss: 2.0756 - val_accuracy10: 0.6419 - 43s/epoch - 41ms/step
Epoch 10/50
1060/1060 - 43s - loss: 1.9508 - accuracy10: 0.6828 - val_loss: 2.0528 - val_accuracy10: 0.6167 - 43s/epoch - 41ms/step
Epoch 11/50
1060/1060 - 43s - loss: 1.9372 - accuracy10: 0.6821 - val_loss: 2.0484 - val_accuracy10: 0.6518 - 43s/epoch - 41ms/step
Epoch 12/50
1060/1060 - 43s - loss: 1.9196 - accuracy10: 0.6843 - val_loss: 2.0511 - val_accuracy10: 0.6393 - 43s/epoch - 41ms/step
Epoch 13/50
1060/1060 - 43s - loss: 1.9069 - accuracy10: 0.6856 - val_loss: 2.0629 - val_accuracy10: 0.6249 - 43s/epoch - 41ms/step
Epoch 14/50
1060/1060 - 43s - loss: 1.8920 - accuracy10: 0.6845 - val_loss: 2.0854 - val_accuracy10: 0.6407 - 43s/epoch - 41ms/step
Epoch 15/50
1060/1060 - 43s - loss: 1.8832 - accuracy10: 0.6848 - val_loss: 2.0526 - val_accuracy10: 0.6390 - 43s/epoch - 40ms/step
Epoch 16/50
1060/1060 - 43s - loss: 1.8695 - accuracy10: 0.6856 - val_loss: 2.0584 - val_accuracy10: 0.6437 - 43s/epoch - 41ms/step
Epoch 17/50
1060/1060 - 43s - loss: 1.8573 - accuracy10: 0.6845 - val_loss: 2.0628 - val_accuracy10: 0.6520 - 43s/epoch - 40ms/step
Epoch 18/50
1060/1060 - 43s - loss: 1.8435 - accuracy10: 0.6864 - val_loss: 2.0605 - val_accuracy10: 0.6647 - 43s/epoch - 41ms/step
Epoch 19/50
1060/1060 - 43s - loss: 1.8346 - accuracy10: 0.6863 - val_loss: 2.0686 - val_accuracy10: 0.6696 - 43s/epoch - 41ms/step
Epoch 20/50
1060/1060 - 43s - loss: 1.8265 - accuracy10: 0.6858 - val_loss: 2.0892 - val_accuracy10: 0.6753 - 43s/epoch - 41ms/step
Epoch 21/50
1060/1060 - 43s - loss: 1.8113 - accuracy10: 0.6865 - val_loss: 2.1343 - val_accuracy10: 0.6773 - 43s/epoch - 41ms/step
testing model: results/EXC/W10/deepLOB_L2/h10
Evaluating performance on  test set...
5267/5267 - 70s - 70s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8034213
{'0': {'precision': 0.3362711710140091, 'recall': 0.5857173997767312, 'f1-score': 0.427250146359797, 'support': 151387}, '1': {'precision': 0.9132507352836703, 'recall': 0.6141562022844236, 'f1-score': 0.7344193476144555, 'support': 1046566}, '2': {'precision': 0.27248202619958867, 'recall': 0.6904603423946325, 'f1-score': 0.39075657950498094, 'support': 150236}, 'accuracy': 0.6194658167363775, 'macro avg': {'precision': 0.507334644165756, 'recall': 0.6301113148185958, 'f1-score': 0.5174753578264112, 'support': 1348189}, 'weighted avg': {'precision': 0.7770578624193706, 'recall': 0.6194658167363775, 'f1-score': 0.6616313753790835, 'support': 1348189}}
[[ 88670  32733  29984]
 [156834 642755 246977]
 [ 18182  28322 103732]]
Evaluating performance on  train set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6576297
{'0': {'precision': 0.3009285772723554, 'recall': 0.6688335303209383, 'f1-score': 0.4150938073070955, 'support': 21998}, '1': {'precision': 0.9488149449603787, 'recall': 0.6999841282437902, 'f1-score': 0.8056232113499361, 'support': 226818}, '2': {'precision': 0.28320947726075185, 'recall': 0.6943912326814273, 'f1-score': 0.40232822260079504, 'support': 22447}, 'accuracy': 0.6969951670519017, 'macro avg': {'precision': 0.5109843331644953, 'recall': 0.687736297082052, 'f1-score': 0.5410150804192755, 'support': 271263}, 'weighted avg': {'precision': 0.8411959543503262, 'recall': 0.6969951670519017, 'f1-score': 0.7405806937836392, 'support': 271263}}
[[ 14713   4083   3202]
 [ 31801 158769  36248]
 [  2378   4482  15587]]
Evaluating performance on  val set...
404/404 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7256499
{'0': {'precision': 0.2867996692164565, 'recall': 0.6941456092069052, 'f1-score': 0.40589569160997735, 'support': 7994}, '1': {'precision': 0.9576104606443894, 'recall': 0.6412017167381975, 'f1-score': 0.7680970660817109, 'support': 87375}, '2': {'precision': 0.22842719054514146, 'recall': 0.7262660196590768, 'f1-score': 0.3475439118785353, 'support': 8037}, 'accuracy': 0.6519060789509313, 'macro avg': {'precision': 0.4909457734686624, 'recall': 0.6872044485347265, 'f1-score': 0.5071788898567412, 'support': 103406}, 'weighted avg': {'precision': 0.8490780020978587, 'recall': 0.6519060789509313, 'f1-score': 0.7074098381852836, 'support': 103406}}
[[ 5549  1214  1231]
 [12865 56025 18485]
 [  934  1266  5837]]
training model: results/EXC/W10/deepLOB_L2/h20
Epoch 1/50
1060/1060 - 46s - loss: 2.7329 - accuracy20: 0.4574 - val_loss: 2.5261 - val_accuracy20: 0.5283 - 46s/epoch - 43ms/step
Epoch 2/50
1060/1060 - 43s - loss: 2.4710 - accuracy20: 0.5271 - val_loss: 2.4386 - val_accuracy20: 0.6112 - 43s/epoch - 41ms/step
Epoch 3/50
1060/1060 - 43s - loss: 2.3491 - accuracy20: 0.5748 - val_loss: 2.3779 - val_accuracy20: 0.5527 - 43s/epoch - 41ms/step
Epoch 4/50
1060/1060 - 43s - loss: 2.2761 - accuracy20: 0.6041 - val_loss: 2.3677 - val_accuracy20: 0.5975 - 43s/epoch - 41ms/step
Epoch 5/50
1060/1060 - 43s - loss: 2.2036 - accuracy20: 0.6306 - val_loss: 2.3041 - val_accuracy20: 0.5915 - 43s/epoch - 41ms/step
Epoch 6/50
1060/1060 - 43s - loss: 2.1476 - accuracy20: 0.6466 - val_loss: 2.2614 - val_accuracy20: 0.6364 - 43s/epoch - 41ms/step
Epoch 7/50
1060/1060 - 43s - loss: 2.1100 - accuracy20: 0.6534 - val_loss: 2.2007 - val_accuracy20: 0.6412 - 43s/epoch - 41ms/step
Epoch 8/50
1060/1060 - 44s - loss: 2.0845 - accuracy20: 0.6553 - val_loss: 2.2082 - val_accuracy20: 0.6378 - 44s/epoch - 41ms/step
Epoch 9/50
1060/1060 - 43s - loss: 2.0642 - accuracy20: 0.6584 - val_loss: 2.1833 - val_accuracy20: 0.6566 - 43s/epoch - 41ms/step
Epoch 10/50
1060/1060 - 43s - loss: 2.0485 - accuracy20: 0.6589 - val_loss: 2.1833 - val_accuracy20: 0.6496 - 43s/epoch - 41ms/step
Epoch 11/50
1060/1060 - 44s - loss: 2.0336 - accuracy20: 0.6611 - val_loss: 2.1687 - val_accuracy20: 0.6625 - 44s/epoch - 41ms/step
Epoch 12/50
1060/1060 - 43s - loss: 2.0182 - accuracy20: 0.6612 - val_loss: 2.1773 - val_accuracy20: 0.6743 - 43s/epoch - 41ms/step
Epoch 13/50
1060/1060 - 43s - loss: 2.0039 - accuracy20: 0.6614 - val_loss: 2.1906 - val_accuracy20: 0.6428 - 43s/epoch - 41ms/step
Epoch 14/50
1060/1060 - 43s - loss: 1.9941 - accuracy20: 0.6617 - val_loss: 2.1716 - val_accuracy20: 0.6654 - 43s/epoch - 40ms/step
Epoch 15/50
1060/1060 - 43s - loss: 1.9842 - accuracy20: 0.6612 - val_loss: 2.1564 - val_accuracy20: 0.6579 - 43s/epoch - 41ms/step
Epoch 16/50
1060/1060 - 43s - loss: 1.9697 - accuracy20: 0.6635 - val_loss: 2.1711 - val_accuracy20: 0.6518 - 43s/epoch - 40ms/step
Epoch 17/50
1060/1060 - 43s - loss: 1.9560 - accuracy20: 0.6634 - val_loss: 2.1576 - val_accuracy20: 0.6455 - 43s/epoch - 40ms/step
Epoch 18/50
1060/1060 - 43s - loss: 1.9472 - accuracy20: 0.6624 - val_loss: 2.1918 - val_accuracy20: 0.6419 - 43s/epoch - 41ms/step
Epoch 19/50
1060/1060 - 43s - loss: 1.9346 - accuracy20: 0.6642 - val_loss: 2.1833 - val_accuracy20: 0.6393 - 43s/epoch - 41ms/step
Epoch 20/50
1060/1060 - 43s - loss: 1.9202 - accuracy20: 0.6639 - val_loss: 2.1893 - val_accuracy20: 0.6383 - 43s/epoch - 41ms/step
Epoch 21/50
1060/1060 - 43s - loss: 1.9122 - accuracy20: 0.6644 - val_loss: 2.1957 - val_accuracy20: 0.6039 - 43s/epoch - 41ms/step
Epoch 22/50
1060/1060 - 43s - loss: 1.9008 - accuracy20: 0.6641 - val_loss: 2.1863 - val_accuracy20: 0.6163 - 43s/epoch - 40ms/step
Epoch 23/50
1060/1060 - 43s - loss: 1.8903 - accuracy20: 0.6660 - val_loss: 2.2071 - val_accuracy20: 0.6363 - 43s/epoch - 40ms/step
Epoch 24/50
1060/1060 - 43s - loss: 1.8779 - accuracy20: 0.6665 - val_loss: 2.2467 - val_accuracy20: 0.6262 - 43s/epoch - 40ms/step
Epoch 25/50
1060/1060 - 43s - loss: 1.8700 - accuracy20: 0.6666 - val_loss: 2.2362 - val_accuracy20: 0.6079 - 43s/epoch - 40ms/step
testing model: results/EXC/W10/deepLOB_L2/h20
Evaluating performance on  test set...
5267/5267 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8483693
{'0': {'precision': 0.406570788487188, 'recall': 0.5400978200249732, 'f1-score': 0.46391735095744185, 'support': 202617}, '1': {'precision': 0.8482445694895203, 'recall': 0.5778260823463296, 'f1-score': 0.6873962882956749, 'support': 943090}, '2': {'precision': 0.3194050293980893, 'recall': 0.6887031933702749, 'f1-score': 0.43641200172123773, 'support': 202482}, 'accuracy': 0.5888083940753114, 'macro avg': {'precision': 0.5247401291249325, 'recall': 0.6022090319138592, 'f1-score': 0.5292418803247848, 'support': 1348189}, 'weighted avg': {'precision': 0.7024407510025406, 'recall': 0.5888083940753114, 'f1-score': 0.616115160678682, 'support': 1348189}}
[[109433  56823  36361]
 [137366 544942 260782]
 [ 22362  40670 139450]]
Evaluating performance on  train set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6857512
{'0': {'precision': 0.35837668340251216, 'recall': 0.6442069594682653, 'f1-score': 0.460547616551949, 'support': 30692}, '1': {'precision': 0.9065753824483036, 'recall': 0.6825897314625046, 'f1-score': 0.7787976736200064, 'support': 209319}, '2': {'precision': 0.35832378737882337, 'recall': 0.6706130807628312, 'f1-score': 0.46707747852152304, 'support': 31252}, 'accuracy': 0.6768670994569845, 'macro avg': {'precision': 0.5410919510765464, 'recall': 0.6658032572312004, 'f1-score': 0.5688075895644928, 'support': 271263}, 'weighted avg': {'precision': 0.78138590463443, 'recall': 0.6768670994569845, 'f1-score': 0.7068762899858556, 'support': 271263}}
[[ 19772   7246   3674]
 [ 32583 142879  33857]
 [  2816   7478  20958]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71807414
{'0': {'precision': 0.3569750367107195, 'recall': 0.6545503500269252, 'f1-score': 0.46199163816039523, 'support': 11142}, '1': {'precision': 0.9161678712504097, 'recall': 0.6549398244056427, 'f1-score': 0.7638366566236904, 'support': 81096}, '2': {'precision': 0.306123265208175, 'recall': 0.6853510028653295, 'f1-score': 0.42321196538663564, 'support': 11168}, 'accuracy': 0.658182310504226, 'macro avg': {'precision': 0.5264220577231015, 'recall': 0.6649470590992991, 'f1-score': 0.5496800867235737, 'support': 103406}, 'weighted avg': {'precision': 0.790029110223768, 'recall': 0.658182310504226, 'f1-score': 0.6945248783182395, 'support': 103406}}
[[ 7293  2491  1358]
 [11992 53113 15991]
 [ 1145  2369  7654]]
training model: results/EXC/W10/deepLOB_L2/h30
Epoch 1/50
1060/1060 - 47s - loss: 2.7522 - accuracy30: 0.4649 - val_loss: 2.5535 - val_accuracy30: 0.5477 - 47s/epoch - 45ms/step
Epoch 2/50
1060/1060 - 44s - loss: 2.5180 - accuracy30: 0.5272 - val_loss: 2.4681 - val_accuracy30: 0.5600 - 44s/epoch - 42ms/step
Epoch 3/50
1060/1060 - 43s - loss: 2.4282 - accuracy30: 0.5607 - val_loss: 2.4564 - val_accuracy30: 0.6063 - 43s/epoch - 41ms/step
Epoch 4/50
1060/1060 - 43s - loss: 2.3601 - accuracy30: 0.5830 - val_loss: 2.4418 - val_accuracy30: 0.6207 - 43s/epoch - 41ms/step
Epoch 5/50
1060/1060 - 43s - loss: 2.2961 - accuracy30: 0.6044 - val_loss: 2.4020 - val_accuracy30: 0.6140 - 43s/epoch - 41ms/step
Epoch 6/50
1060/1060 - 43s - loss: 2.2459 - accuracy30: 0.6175 - val_loss: 2.3749 - val_accuracy30: 0.6168 - 43s/epoch - 41ms/step
Epoch 7/50
1060/1060 - 43s - loss: 2.2131 - accuracy30: 0.6237 - val_loss: 2.3584 - val_accuracy30: 0.6102 - 43s/epoch - 41ms/step
Epoch 8/50
1060/1060 - 43s - loss: 2.1858 - accuracy30: 0.6291 - val_loss: 2.3657 - val_accuracy30: 0.6379 - 43s/epoch - 41ms/step
Epoch 9/50
1060/1060 - 43s - loss: 2.1672 - accuracy30: 0.6308 - val_loss: 2.3652 - val_accuracy30: 0.6372 - 43s/epoch - 41ms/step
Epoch 10/50
1060/1060 - 43s - loss: 2.1502 - accuracy30: 0.6335 - val_loss: 2.3890 - val_accuracy30: 0.6469 - 43s/epoch - 40ms/step
Epoch 11/50
1060/1060 - 43s - loss: 2.1361 - accuracy30: 0.6342 - val_loss: 2.3823 - val_accuracy30: 0.6507 - 43s/epoch - 41ms/step
Epoch 12/50
1060/1060 - 43s - loss: 2.1195 - accuracy30: 0.6364 - val_loss: 2.4245 - val_accuracy30: 0.6624 - 43s/epoch - 41ms/step
Epoch 13/50
1060/1060 - 43s - loss: 2.1081 - accuracy30: 0.6368 - val_loss: 2.4512 - val_accuracy30: 0.6626 - 43s/epoch - 41ms/step
Epoch 14/50
1060/1060 - 43s - loss: 2.0954 - accuracy30: 0.6385 - val_loss: 2.4179 - val_accuracy30: 0.6546 - 43s/epoch - 41ms/step
Epoch 15/50
1060/1060 - 43s - loss: 2.0806 - accuracy30: 0.6390 - val_loss: 2.4586 - val_accuracy30: 0.6579 - 43s/epoch - 41ms/step
Epoch 16/50
1060/1060 - 43s - loss: 2.0692 - accuracy30: 0.6415 - val_loss: 2.4613 - val_accuracy30: 0.6618 - 43s/epoch - 41ms/step
Epoch 17/50
1060/1060 - 43s - loss: 2.0561 - accuracy30: 0.6426 - val_loss: 2.4508 - val_accuracy30: 0.6529 - 43s/epoch - 41ms/step
testing model: results/EXC/W10/deepLOB_L2/h30
Evaluating performance on  test set...
5267/5267 - 71s - 71s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9455442
{'0': {'precision': 0.4585751840398217, 'recall': 0.43320289741290613, 'f1-score': 0.44552810287530703, 'support': 242009}, '1': {'precision': 0.7752951022001244, 'recall': 0.5110554831232798, 'f1-score': 0.616035500024098, 'support': 862875}, '2': {'precision': 0.3251201923076923, 'recall': 0.7359939170999363, 'f1-score': 0.4510098993941485, 'support': 243305}, 'accuracy': 0.5376746138709039, 'macro avg': {'precision': 0.5196634928492129, 'recall': 0.5600840992120407, 'f1-score': 0.5041911674311845, 'support': 1348189}, 'weighted avg': {'precision': 0.6371995702491628, 'recall': 0.5376746138709039, 'f1-score': 0.555646431104346, 'support': 1348189}}
[[104839  81858  55312]
 [105497 440977 316401]
 [ 18283  45951 179071]]
Evaluating performance on  train set...
1060/1060 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7652724
{'0': {'precision': 0.41078537111481517, 'recall': 0.5573796663385041, 'f1-score': 0.47298426245794667, 'support': 37583}, '1': {'precision': 0.8549836904769944, 'recall': 0.6477823942364764, 'f1-score': 0.7370985913032847, 'support': 195436}, '2': {'precision': 0.3591522958653646, 'recall': 0.6779887041104486, 'f1-score': 0.46956238285388313, 'support': 38244}, 'accuracy': 0.6395158941691274, 'macro avg': {'precision': 0.5416404524857247, 'recall': 0.6277169215618098, 'f1-score': 0.5598817455383714, 'support': 271263}, 'weighted avg': {'precision': 0.7235360500243121, 'recall': 0.6395158941691274, 'f1-score': 0.6627874483278945, 'support': 271263}}
[[ 20948  11802   4833]
 [ 27403 126600  41433]
 [  2644   9671  25929]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.79525155
{'0': {'precision': 0.40075058322345064, 'recall': 0.5809866921549885, 'f1-score': 0.47432395930250004, 'support': 13601}, '1': {'precision': 0.8724195039285164, 'recall': 0.5956297085157575, 'f1-score': 0.707931274270043, 'support': 76059}, '2': {'precision': 0.31067380352644836, 'recall': 0.7178088171104321, 'f1-score': 0.4336571001626159, 'support': 13746}, 'accuracy': 0.6099452642980098, 'macro avg': {'precision': 0.5279479635594718, 'recall': 0.631475072593726, 'f1-score': 0.5386374445783864, 'support': 103406}, 'weighted avg': {'precision': 0.7357066885383415, 'recall': 0.6099452642980098, 'f1-score': 0.6407449805525195, 'support': 103406}}
[[ 7902  3832  1867]
 [10730 45303 20026]
 [ 1086  2793  9867]]
training model: results/EXC/W10/deepLOB_L2/h50
Epoch 1/50
1060/1060 - 47s - loss: 2.8470 - accuracy50: 0.4570 - val_loss: 2.9676 - val_accuracy50: 0.4528 - 47s/epoch - 44ms/step
Epoch 2/50
1060/1060 - 44s - loss: 2.6701 - accuracy50: 0.5095 - val_loss: 2.7508 - val_accuracy50: 0.4888 - 44s/epoch - 41ms/step
Epoch 3/50
1060/1060 - 43s - loss: 2.6057 - accuracy50: 0.5335 - val_loss: 2.6709 - val_accuracy50: 0.5073 - 43s/epoch - 41ms/step
Epoch 4/50
1060/1060 - 43s - loss: 2.5622 - accuracy50: 0.5469 - val_loss: 2.6556 - val_accuracy50: 0.5078 - 43s/epoch - 41ms/step
Epoch 5/50
1060/1060 - 43s - loss: 2.5225 - accuracy50: 0.5588 - val_loss: 2.6177 - val_accuracy50: 0.5229 - 43s/epoch - 40ms/step
Epoch 6/50
1060/1060 - 43s - loss: 2.4932 - accuracy50: 0.5681 - val_loss: 2.6099 - val_accuracy50: 0.5074 - 43s/epoch - 40ms/step
Epoch 7/50
1060/1060 - 43s - loss: 2.4642 - accuracy50: 0.5758 - val_loss: 2.6162 - val_accuracy50: 0.5269 - 43s/epoch - 41ms/step
Epoch 8/50
1060/1060 - 43s - loss: 2.4385 - accuracy50: 0.5840 - val_loss: 2.5949 - val_accuracy50: 0.5207 - 43s/epoch - 41ms/step
Epoch 9/50
1060/1060 - 43s - loss: 2.4131 - accuracy50: 0.5906 - val_loss: 2.5830 - val_accuracy50: 0.5219 - 43s/epoch - 41ms/step
Epoch 10/50
1060/1060 - 43s - loss: 2.3916 - accuracy50: 0.5962 - val_loss: 2.6125 - val_accuracy50: 0.5180 - 43s/epoch - 41ms/step
Epoch 11/50
1060/1060 - 43s - loss: 2.3732 - accuracy50: 0.5997 - val_loss: 2.5971 - val_accuracy50: 0.5152 - 43s/epoch - 41ms/step
Epoch 12/50
1060/1060 - 43s - loss: 2.3548 - accuracy50: 0.6023 - val_loss: 2.6062 - val_accuracy50: 0.5233 - 43s/epoch - 41ms/step
Epoch 13/50
1060/1060 - 43s - loss: 2.3410 - accuracy50: 0.6070 - val_loss: 2.6088 - val_accuracy50: 0.5486 - 43s/epoch - 41ms/step
Epoch 14/50
1060/1060 - 43s - loss: 2.3269 - accuracy50: 0.6078 - val_loss: 2.6324 - val_accuracy50: 0.5256 - 43s/epoch - 41ms/step
Epoch 15/50
1060/1060 - 43s - loss: 2.3140 - accuracy50: 0.6098 - val_loss: 2.6208 - val_accuracy50: 0.5234 - 43s/epoch - 41ms/step
Epoch 16/50
1060/1060 - 43s - loss: 2.3013 - accuracy50: 0.6113 - val_loss: 2.6599 - val_accuracy50: 0.5204 - 43s/epoch - 41ms/step
Epoch 17/50
1060/1060 - 43s - loss: 2.2897 - accuracy50: 0.6121 - val_loss: 2.6449 - val_accuracy50: 0.5338 - 43s/epoch - 41ms/step
Epoch 18/50
1060/1060 - 43s - loss: 2.2774 - accuracy50: 0.6139 - val_loss: 2.6333 - val_accuracy50: 0.5281 - 43s/epoch - 40ms/step
Epoch 19/50
1060/1060 - 43s - loss: 2.2605 - accuracy50: 0.6158 - val_loss: 2.6501 - val_accuracy50: 0.5217 - 43s/epoch - 41ms/step
testing model: results/EXC/W10/deepLOB_L2/h50
Evaluating performance on  test set...
5267/5267 - 71s - 71s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0297436
{'0': {'precision': 0.4679096867204135, 'recall': 0.4603358235782401, 'f1-score': 0.4640918563180047, 'support': 305994}, '1': {'precision': 0.6878614651546994, 'recall': 0.3922615777066686, 'f1-score': 0.49961275309971176, 'support': 733457}, '2': {'precision': 0.3549949513822082, 'recall': 0.723108266556109, 'f1-score': 0.476206321730589, 'support': 308738}, 'accuracy': 0.48347672321907387, 'macro avg': {'precision': 0.5035887010857737, 'recall': 0.5252352226136726, 'f1-score': 0.47997031038276844, 'support': 1348189}, 'weighted avg': {'precision': 0.5617126342272016, 'recall': 0.48347672321907387, 'f1-score': 0.48619057260583304, 'support': 1348189}}
[[140860  82353  82781]
 [122897 287707 322853]
 [ 37284  48203 223251]]
Evaluating performance on  train set...
1060/1060 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88342834
{'0': {'precision': 0.4106272576113755, 'recall': 0.5797931550932016, 'f1-score': 0.48076326013442644, 'support': 49409}, '1': {'precision': 0.7879557327217459, 'recall': 0.5042839585990786, 'f1-score': 0.6149841066893967, 'support': 171687}, '2': {'precision': 0.37632202224380873, 'recall': 0.6872844698706321, 'f1-score': 0.4863458120574379, 'support': 50167}, 'accuracy': 0.5518813844866421, 'macro avg': {'precision': 0.5249683375256433, 'recall': 0.5904538611876374, 'f1-score': 0.5273643929604203, 'support': 271263}, 'weighted avg': {'precision': 0.6431005516602853, 'recall': 0.5518813844866421, 'f1-score': 0.5667463627499874, 'support': 271263}}
[[28647 12729  8033]
 [35999 86579 49109]
 [ 5118 10570 34479]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9214844
{'0': {'precision': 0.40122199592668023, 'recall': 0.5974055146852362, 'f1-score': 0.4800433203221949, 'support': 17807}, '1': {'precision': 0.8219970259404087, 'recall': 0.443029520459504, 'f1-score': 0.5757491006934065, 'support': 67377}, '2': {'precision': 0.3305732170141456, 'recall': 0.7361431236966305, 'f1-score': 0.4562585034013606, 'support': 18222}, 'accuracy': 0.5212656905788833, 'macro avg': {'precision': 0.5179307462937448, 'recall': 0.5921927196137903, 'f1-score': 0.504016974805654, 'support': 103406}, 'weighted avg': {'precision': 0.662939857055539, 'recall': 0.5212656905788833, 'f1-score': 0.5382117189657908, 'support': 103406}}
[[10638  3734  3435]
 [13798 29850 23729]
 [ 2078  2730 13414]]
training model: results/EXC/W10/deepLOB_L2/h100
Epoch 1/50
1060/1060 - 46s - loss: 3.0561 - accuracy100: 0.4483 - val_loss: 3.1525 - val_accuracy100: 0.4667 - 46s/epoch - 44ms/step
Epoch 2/50
1060/1060 - 44s - loss: 2.9208 - accuracy100: 0.4885 - val_loss: 3.0268 - val_accuracy100: 0.4837 - 44s/epoch - 41ms/step
Epoch 3/50
1060/1060 - 44s - loss: 2.8764 - accuracy100: 0.5043 - val_loss: 3.0500 - val_accuracy100: 0.4916 - 44s/epoch - 41ms/step
Epoch 4/50
1060/1060 - 44s - loss: 2.8493 - accuracy100: 0.5123 - val_loss: 3.0216 - val_accuracy100: 0.4982 - 44s/epoch - 41ms/step
Epoch 5/50
1060/1060 - 43s - loss: 2.8253 - accuracy100: 0.5195 - val_loss: 3.0004 - val_accuracy100: 0.4799 - 43s/epoch - 41ms/step
Epoch 6/50
1060/1060 - 43s - loss: 2.8030 - accuracy100: 0.5273 - val_loss: 3.0292 - val_accuracy100: 0.4769 - 43s/epoch - 41ms/step
Epoch 7/50
1060/1060 - 43s - loss: 2.7838 - accuracy100: 0.5317 - val_loss: 3.0441 - val_accuracy100: 0.4927 - 43s/epoch - 41ms/step
Epoch 8/50
1060/1060 - 43s - loss: 2.7620 - accuracy100: 0.5377 - val_loss: 3.0801 - val_accuracy100: 0.4867 - 43s/epoch - 41ms/step
Epoch 9/50
1060/1060 - 43s - loss: 2.7429 - accuracy100: 0.5419 - val_loss: 3.0437 - val_accuracy100: 0.4829 - 43s/epoch - 41ms/step
Epoch 10/50
1060/1060 - 43s - loss: 2.7269 - accuracy100: 0.5459 - val_loss: 3.0972 - val_accuracy100: 0.4871 - 43s/epoch - 41ms/step
Epoch 11/50
1060/1060 - 43s - loss: 2.7075 - accuracy100: 0.5518 - val_loss: 3.0830 - val_accuracy100: 0.4820 - 43s/epoch - 41ms/step
Epoch 12/50
1060/1060 - 43s - loss: 2.6922 - accuracy100: 0.5542 - val_loss: 3.0735 - val_accuracy100: 0.4813 - 43s/epoch - 41ms/step
Epoch 13/50
1060/1060 - 43s - loss: 2.6751 - accuracy100: 0.5581 - val_loss: 3.0880 - val_accuracy100: 0.4860 - 43s/epoch - 41ms/step
Epoch 14/50
1060/1060 - 43s - loss: 2.6595 - accuracy100: 0.5621 - val_loss: 3.1567 - val_accuracy100: 0.4843 - 43s/epoch - 41ms/step
Epoch 15/50
1060/1060 - 43s - loss: 2.6441 - accuracy100: 0.5652 - val_loss: 3.1097 - val_accuracy100: 0.4857 - 43s/epoch - 41ms/step
testing model: results/EXC/W10/deepLOB_L2/h100
Evaluating performance on  test set...
5267/5267 - 71s - 71s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1208128
{'0': {'precision': 0.5319697168450049, 'recall': 0.13951242526778276, 'f1-score': 0.22105244715084715, 'support': 406953}, '1': {'precision': 0.4444081879049544, 'recall': 0.4153714187682278, 'f1-score': 0.4293994835177936, 'support': 524610}, '2': {'precision': 0.38908178344627425, 'recall': 0.7014708635562831, 'f1-score': 0.5005343582049675, 'support': 416626}, 'accuracy': 0.4205152244974555, 'macro avg': {'precision': 0.45515322939874453, 'recall': 0.41878490253076456, 'f1-score': 0.38366209629120274, 'support': 1348189}, 'weighted avg': {'precision': 0.45374145520111114, 'recall': 0.4205152244974555, 'f1-score': 0.3884921528770456, 'support': 1348189}}
[[ 56775 169895 180283]
 [ 28106 217908 278596]
 [ 21845 102530 292251]]
Evaluating performance on  train set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0040646
{'0': {'precision': 0.4905576208178439, 'recall': 0.3246316914080072, 'f1-score': 0.39070814052837716, 'support': 71136}, '1': {'precision': 0.5602280580511403, 'recall': 0.5058579429338076, 'f1-score': 0.5316565694657365, 'support': 128202}, '2': {'precision': 0.4086859482790423, 'recall': 0.6161001042752867, 'f1-score': 0.4914029708405183, 'support': 71925}, 'accuracy': 0.48756372966456907, 'macro avg': {'precision': 0.48649054238267553, 'recall': 0.4821965795390339, 'f1-score': 0.471255893611544, 'support': 271263}, 'weighted avg': {'precision': 0.5017765093018236, 'recall': 0.48756372966456907, 'f1-score': 0.4840210735742702, 'support': 271263}}
[[23093 29651 18392]
 [17627 64852 45723]
 [ 6355 21257 44313]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9990376
{'0': {'precision': 0.4878422245360446, 'recall': 0.3118027011156782, 'f1-score': 0.38044516622086355, 'support': 25545}, '1': {'precision': 0.6052624605845411, 'recall': 0.44606311513825964, 'f1-score': 0.5136092279672163, 'support': 51208}, '2': {'precision': 0.3823469801378192, 'recall': 0.7078002476269087, 'f1-score': 0.49649309804850444, 'support': 26653}, 'accuracy': 0.480358973367116, 'macro avg': {'precision': 0.4918172217528016, 'recall': 0.4885553546269488, 'f1-score': 0.4635158307455281, 'support': 103406}, 'weighted avg': {'precision': 0.5187987521903926, 'recall': 0.480358973367116, 'f1-score': 0.47630121713579443, 'support': 103406}}
[[ 7965  9350  8230]
 [ 6121 22842 22245]
 [ 2241  5547 18865]]
training model: results/EXC/W10/deepLOB_L2/h200
Epoch 1/50
1060/1060 - 47s - loss: 3.2138 - accuracy200: 0.4210 - val_loss: 3.2870 - val_accuracy200: 0.4045 - 47s/epoch - 44ms/step
Epoch 2/50
1060/1060 - 45s - loss: 3.1231 - accuracy200: 0.4558 - val_loss: 3.3907 - val_accuracy200: 0.4011 - 45s/epoch - 42ms/step
Epoch 3/50
1060/1060 - 44s - loss: 3.0935 - accuracy200: 0.4641 - val_loss: 3.3238 - val_accuracy200: 0.4129 - 44s/epoch - 41ms/step
Epoch 4/50
1060/1060 - 43s - loss: 3.0714 - accuracy200: 0.4701 - val_loss: 3.3318 - val_accuracy200: 0.4154 - 43s/epoch - 41ms/step
Epoch 5/50
1060/1060 - 43s - loss: 3.0547 - accuracy200: 0.4767 - val_loss: 3.3393 - val_accuracy200: 0.4092 - 43s/epoch - 40ms/step
Epoch 6/50
1060/1060 - 43s - loss: 3.0371 - accuracy200: 0.4822 - val_loss: 3.3926 - val_accuracy200: 0.4099 - 43s/epoch - 41ms/step
Epoch 7/50
1060/1060 - 43s - loss: 3.0185 - accuracy200: 0.4869 - val_loss: 3.3610 - val_accuracy200: 0.4040 - 43s/epoch - 41ms/step
Epoch 8/50
1060/1060 - 43s - loss: 2.9981 - accuracy200: 0.4932 - val_loss: 3.4409 - val_accuracy200: 0.4092 - 43s/epoch - 40ms/step
Epoch 9/50
1060/1060 - 43s - loss: 2.9803 - accuracy200: 0.4996 - val_loss: 3.4319 - val_accuracy200: 0.4072 - 43s/epoch - 40ms/step
Epoch 10/50
1060/1060 - 43s - loss: 2.9598 - accuracy200: 0.5059 - val_loss: 3.5232 - val_accuracy200: 0.3970 - 43s/epoch - 40ms/step
Epoch 11/50
1060/1060 - 43s - loss: 2.9392 - accuracy200: 0.5094 - val_loss: 3.4712 - val_accuracy200: 0.4042 - 43s/epoch - 41ms/step
testing model: results/EXC/W10/deepLOB_L2/h200
Evaluating performance on  test set...
5267/5267 - 70s - 70s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1586343
{'0': {'precision': 0.4826326518255394, 'recall': 0.049612753712190844, 'f1-score': 0.08997629529292245, 'support': 481993}, '1': {'precision': 0.2842127792227128, 'recall': 0.166844204086092, 'f1-score': 0.21025837841000813, 'support': 366120}, '2': {'precision': 0.38695321186843407, 'recall': 0.8385665378862412, 'f1-score': 0.5295484063238142, 'support': 500076}, 'accuracy': 0.3740907246684256, 'macro avg': {'precision': 0.3845995476388954, 'recall': 0.35167449856150806, 'f1-score': 0.2765943600089149, 'support': 1348189}, 'weighted avg': {'precision': 0.393259073363368, 'recall': 0.3740907246684256, 'f1-score': 0.2856885724786224, 'support': 1348189}}
[[ 23913  86116 371964]
 [ 12631  61085 292404]
 [ 13003  67726 419347]]
Evaluating performance on  train set...
1060/1060 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1033205
{'0': {'precision': 0.4407480130902291, 'recall': 0.26153197438941844, 'f1-score': 0.328272769057203, 'support': 90119}, '1': {'precision': 0.36357382818749, 'recall': 0.2521663874310695, 'f1-score': 0.29779149223320694, 'support': 90127}, '2': {'precision': 0.3948595422403689, 'recall': 0.6736433853016469, 'f1-score': 0.49788262043484444, 'support': 91017}, 'accuracy': 0.39669619520539107, 'macro avg': {'precision': 0.39972712783936265, 'recall': 0.39578058237404495, 'f1-score': 0.37464896057508473, 'support': 271263}, 'weighted avg': {'precision': 0.39970994776590957, 'recall': 0.39669619520539107, 'f1-score': 0.3750546516085369, 'support': 271263}}
[[23569 22356 44194]
 [17629 22727 49771]
 [12277 17427 61313]]
Evaluating performance on  val set...
404/404 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0947359
{'0': {'precision': 0.46647277427694295, 'recall': 0.17777640937220973, 'f1-score': 0.25744031031945963, 'support': 32479}, '1': {'precision': 0.40714350139803374, 'recall': 0.24981322117380117, 'f1-score': 0.30963936000548764, 'support': 36139}, '2': {'precision': 0.39291834897028494, 'recall': 0.7776819592963091, 'f1-score': 0.5220663437602516, 'support': 34788}, 'accuracy': 0.40477341740324546, 'macro avg': {'precision': 0.42217820821508717, 'recall': 0.4017571966141067, 'f1-score': 0.3630486713617329, 'support': 103406}, 'weighted avg': {'precision': 0.4209927060010313, 'recall': 0.40477341740324546, 'f1-score': 0.364709055923599, 'support': 103406}}
[[ 5774  7689 19016]
 [ 4327  9028 22784]
 [ 2277  5457 27054]]
training model: results/EXC/W10/deepLOB_L2/h300
Epoch 1/50
1060/1060 - 45s - loss: 3.2603 - accuracy300: 0.3998 - val_loss: 3.3168 - val_accuracy300: 0.3746 - 45s/epoch - 43ms/step
Epoch 2/50
1060/1060 - 43s - loss: 3.1996 - accuracy300: 0.4208 - val_loss: 3.3177 - val_accuracy300: 0.3732 - 43s/epoch - 41ms/step
Epoch 3/50
1060/1060 - 43s - loss: 3.1775 - accuracy300: 0.4294 - val_loss: 3.4162 - val_accuracy300: 0.3620 - 43s/epoch - 41ms/step
Epoch 4/50
1060/1060 - 43s - loss: 3.1590 - accuracy300: 0.4377 - val_loss: 3.5090 - val_accuracy300: 0.3583 - 43s/epoch - 40ms/step
Epoch 5/50
1060/1060 - 43s - loss: 3.1457 - accuracy300: 0.4419 - val_loss: 3.4780 - val_accuracy300: 0.3616 - 43s/epoch - 40ms/step
Epoch 6/50
1060/1060 - 43s - loss: 3.1278 - accuracy300: 0.4493 - val_loss: 3.4458 - val_accuracy300: 0.3629 - 43s/epoch - 40ms/step
Epoch 7/50
1060/1060 - 43s - loss: 3.1090 - accuracy300: 0.4568 - val_loss: 3.4967 - val_accuracy300: 0.3576 - 43s/epoch - 40ms/step
Epoch 8/50
1060/1060 - 43s - loss: 3.0944 - accuracy300: 0.4634 - val_loss: 3.5059 - val_accuracy300: 0.3583 - 43s/epoch - 41ms/step
Epoch 9/50
1060/1060 - 43s - loss: 3.0774 - accuracy300: 0.4689 - val_loss: 3.5955 - val_accuracy300: 0.3571 - 43s/epoch - 41ms/step
Epoch 10/50
1060/1060 - 43s - loss: 3.0593 - accuracy300: 0.4748 - val_loss: 3.5740 - val_accuracy300: 0.3582 - 43s/epoch - 41ms/step
Epoch 11/50
1060/1060 - 43s - loss: 3.0405 - accuracy300: 0.4804 - val_loss: 3.7145 - val_accuracy300: 0.3559 - 43s/epoch - 41ms/step
testing model: results/EXC/W10/deepLOB_L2/h300
Evaluating performance on  test set...
5267/5267 - 70s - 70s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.161795
{'0': {'precision': 0.4244188787778773, 'recall': 0.03922034238010379, 'f1-score': 0.07180520102105935, 'support': 459022}, '1': {'precision': 0.31136979863345504, 'recall': 0.20649739864297872, 'f1-score': 0.24831483350151362, 'support': 417090}, '2': {'precision': 0.35847938272048785, 'recall': 0.7815102197311032, 'f1-score': 0.491505011197425, 'support': 472077}, 'accuracy': 0.35088848818674534, 'macro avg': {'precision': 0.3647560200439401, 'recall': 0.3424093202513953, 'f1-score': 0.270541681906666, 'support': 1348189}, 'weighted avg': {'precision': 0.36635568413846004, 'recall': 0.35088848818674534, 'f1-score': 0.27337265921861237, 'support': 1348189}}
[[ 18003  98937 342082]
 [ 12816  86128 318146]
 [ 11599  91545 368933]]
Evaluating performance on  train set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1132022
{'0': {'precision': 0.4347734011012283, 'recall': 0.20494703566080638, 'f1-score': 0.2785764362660475, 'support': 90155}, '1': {'precision': 0.3365241647107976, 'recall': 0.3060811641500788, 'f1-score': 0.3205815559665675, 'support': 89473}, '2': {'precision': 0.3779531298766504, 'recall': 0.6079009112238773, 'f1-score': 0.46610967237188367, 'support': 91635}, 'accuracy': 0.37442629477665584, 'macro avg': {'precision': 0.3830835652295588, 'recall': 0.37297637034492087, 'f1-score': 0.3550892215348329, 'support': 271263}, 'weighted avg': {'precision': 0.38317263180639194, 'recall': 0.37442629477665584, 'f1-score': 0.35578170261465725, 'support': 271263}}
[[18477 27910 43768]
 [14174 27386 47913]
 [ 9847 26083 55705]]
Evaluating performance on  val set...
404/404 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1039543
{'0': {'precision': 0.41349093132260034, 'recall': 0.1282796990579756, 'f1-score': 0.19581161937849834, 'support': 31634}, '1': {'precision': 0.37165411788119007, 'recall': 0.29954286630844495, 'f1-score': 0.3317247912842679, 'support': 37407}, '2': {'precision': 0.3708841006888073, 'recall': 0.6847082787720064, 'f1-score': 0.4811467364632749, 'support': 34365}, 'accuracy': 0.37515231224493745, 'macro avg': {'precision': 0.3853430499641992, 'recall': 0.37084361471280897, 'f1-score': 0.3362277157086804, 'support': 103406}, 'weighted avg': {'precision': 0.3841969501693488, 'recall': 0.37515231224493745, 'f1-score': 0.33980370223730216, 'support': 103406}}
[[ 4058 10040 17536]
 [ 3825 11205 22377]
 [ 1931  8904 23530]]
training model: results/EXC/W10/deepLOB_L2/h500
Epoch 1/50
1060/1060 - 47s - loss: 3.2658 - accuracy500: 0.3989 - val_loss: 3.3213 - val_accuracy500: 0.3738 - 47s/epoch - 45ms/step
Epoch 2/50
1060/1060 - 45s - loss: 3.2181 - accuracy500: 0.4162 - val_loss: 3.3748 - val_accuracy500: 0.3736 - 45s/epoch - 42ms/step
Epoch 3/50
1060/1060 - 45s - loss: 3.1898 - accuracy500: 0.4282 - val_loss: 3.4368 - val_accuracy500: 0.3697 - 45s/epoch - 42ms/step
Epoch 4/50
1060/1060 - 46s - loss: 3.1728 - accuracy500: 0.4359 - val_loss: 3.4209 - val_accuracy500: 0.3704 - 46s/epoch - 43ms/step
Epoch 5/50
1060/1060 - 45s - loss: 3.1508 - accuracy500: 0.4442 - val_loss: 3.4905 - val_accuracy500: 0.3667 - 45s/epoch - 43ms/step
Epoch 6/50
1060/1060 - 45s - loss: 3.1267 - accuracy500: 0.4530 - val_loss: 3.5889 - val_accuracy500: 0.3649 - 45s/epoch - 42ms/step
Epoch 7/50
1060/1060 - 44s - loss: 3.1112 - accuracy500: 0.4575 - val_loss: 3.6719 - val_accuracy500: 0.3630 - 44s/epoch - 42ms/step
Epoch 8/50
1060/1060 - 44s - loss: 3.0860 - accuracy500: 0.4673 - val_loss: 3.7051 - val_accuracy500: 0.3608 - 44s/epoch - 42ms/step
Epoch 9/50
1060/1060 - 43s - loss: 3.0673 - accuracy500: 0.4721 - val_loss: 3.7443 - val_accuracy500: 0.3608 - 43s/epoch - 41ms/step
Epoch 10/50
1060/1060 - 43s - loss: 3.0501 - accuracy500: 0.4789 - val_loss: 3.7732 - val_accuracy500: 0.3611 - 43s/epoch - 41ms/step
Epoch 11/50
1060/1060 - 44s - loss: 3.0253 - accuracy500: 0.4867 - val_loss: 3.7232 - val_accuracy500: 0.3611 - 44s/epoch - 41ms/step
testing model: results/EXC/W10/deepLOB_L2/h500
Evaluating performance on  test set...
5267/5267 - 77s - 77s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.135112
{'0': {'precision': 0.36272476360013717, 'recall': 0.15028690521301358, 'f1-score': 0.2125206324904911, 'support': 443352}, '1': {'precision': 0.351038230840562, 'recall': 0.13261407954804966, 'f1-score': 0.1925044535885383, 'support': 451023}, '2': {'precision': 0.3534991097564656, 'recall': 0.7743635057534585, 'f1-score': 0.4854080739044314, 'support': 453814}, 'accuracy': 0.35444511118248256, 'macro avg': {'precision': 0.3557540347323882, 'recall': 0.35242149683817386, 'f1-score': 0.29681105332782026, 'support': 1348189}, 'weighted avg': {'precision': 0.35570970418470366, 'recall': 0.35444511118248256, 'f1-score': 0.2976810842379319, 'support': 1348189}}
[[ 66630  56205 320517]
 [ 69035  59812 322176]
 [ 48028  54369 351417]]
Evaluating performance on  train set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1157184
{'0': {'precision': 0.3741607799638041, 'recall': 0.3580887036395535, 'f1-score': 0.3659483595418366, 'support': 89489}, '1': {'precision': 0.33503360051817666, 'recall': 0.18452825561043043, 'f1-score': 0.23798192706124238, 'support': 89699}, '2': {'precision': 0.37739145755942854, 'recall': 0.5583057290252511, 'f1-score': 0.4503589748082474, 'support': 92075}, 'accuracy': 0.3686569860246329, 'macro avg': {'precision': 0.3621952793471364, 'recall': 0.36697422942507835, 'f1-score': 0.3514297538037754, 'support': 271263}, 'weighted avg': {'precision': 0.3623191199162627, 'recall': 0.3686569860246329, 'f1-score': 0.35228503787090454, 'support': 271263}}
[[32045 16851 40593]
 [28932 16552 44215]
 [24668 16001 51406]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1058294
{'0': {'precision': 0.37513140111127796, 'recall': 0.22776730897817762, 'f1-score': 0.2834395506722896, 'support': 32902}, '1': {'precision': 0.3275699777062175, 'recall': 0.19900677200902936, 'f1-score': 0.24759408350496162, 'support': 33225}, '2': {'precision': 0.39059831762696856, 'recall': 0.6626518951688618, 'f1-score': 0.49148950986341433, 'support': 37279}, 'accuracy': 0.3753070421445564, 'macro avg': {'precision': 0.36443323214815465, 'recall': 0.3631419920520229, 'f1-score': 0.34084104801355525, 'support': 103406}, 'weighted avg': {'precision': 0.36542560926317724, 'recall': 0.3753070421445564, 'f1-score': 0.3469264738880746, 'support': 103406}}
[[ 7494  6760 18648]
 [ 6720  6612 19893]
 [ 5763  6813 24703]]
training model: results/EXC/W10/deepLOB_L2/h1000
Epoch 1/50
1060/1060 - 46s - loss: 3.2112 - accuracy1000: 0.4334 - val_loss: 3.2336 - val_accuracy1000: 0.4533 - 46s/epoch - 44ms/step
Epoch 2/50
1060/1060 - 43s - loss: 3.1786 - accuracy1000: 0.4444 - val_loss: 3.3993 - val_accuracy1000: 0.3850 - 43s/epoch - 41ms/step
Epoch 3/50
1060/1060 - 43s - loss: 3.1476 - accuracy1000: 0.4539 - val_loss: 3.3988 - val_accuracy1000: 0.3907 - 43s/epoch - 41ms/step
Epoch 4/50
1060/1060 - 43s - loss: 3.1214 - accuracy1000: 0.4613 - val_loss: 3.3793 - val_accuracy1000: 0.4040 - 43s/epoch - 41ms/step
Epoch 5/50
1060/1060 - 43s - loss: 3.1184 - accuracy1000: 0.4650 - val_loss: 3.6720 - val_accuracy1000: 0.3540 - 43s/epoch - 41ms/step
Epoch 6/50
1060/1060 - 43s - loss: 3.0987 - accuracy1000: 0.4714 - val_loss: 3.4805 - val_accuracy1000: 0.3674 - 43s/epoch - 41ms/step
Epoch 7/50
1060/1060 - 43s - loss: 3.0830 - accuracy1000: 0.4775 - val_loss: 3.6758 - val_accuracy1000: 0.3494 - 43s/epoch - 41ms/step
Epoch 8/50
1060/1060 - 43s - loss: 3.0698 - accuracy1000: 0.4809 - val_loss: 3.5003 - val_accuracy1000: 0.3609 - 43s/epoch - 41ms/step
Epoch 9/50
1060/1060 - 43s - loss: 3.0464 - accuracy1000: 0.4886 - val_loss: 3.8215 - val_accuracy1000: 0.3534 - 43s/epoch - 41ms/step
Epoch 10/50
1060/1060 - 43s - loss: 3.0247 - accuracy1000: 0.4967 - val_loss: 3.9363 - val_accuracy1000: 0.3508 - 43s/epoch - 41ms/step
Epoch 11/50
1060/1060 - 43s - loss: 3.0013 - accuracy1000: 0.5039 - val_loss: 4.0726 - val_accuracy1000: 0.3423 - 43s/epoch - 40ms/step
testing model: results/EXC/W10/deepLOB_L2/h1000
Evaluating performance on  test set...
5267/5267 - 70s - 70s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1259431
{'0': {'precision': 0.33640552995391704, 'recall': 0.005485322810081386, 'f1-score': 0.010794631748556974, 'support': 385939}, '1': {'precision': 0.43776009301801333, 'recall': 0.5180510167189096, 'f1-score': 0.4745332188686646, 'support': 569774}, '2': {'precision': 0.31086938938135283, 'recall': 0.528801761126795, 'f1-score': 0.3915539565359299, 'support': 392476}, 'accuracy': 0.3744512082504753, 'macro avg': {'precision': 0.3616783374510944, 'recall': 0.35077936688526207, 'f1-score': 0.29229393571771717, 'support': 1348189}, 'weighted avg': {'precision': 0.37180625827014324, 'recall': 0.3744512082504753, 'f1-score': 0.3176248213532943, 'support': 1348189}}
[[  2117 195591 188231]
 [  2757 295172 271845]
 [  1419 183515 207542]]
Evaluating performance on  train set...
1060/1060 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1677626
{'0': {'precision': 0.36262916799829553, 'recall': 0.038134928637046, 'f1-score': 0.06901235694229034, 'support': 89262}, '1': {'precision': 0.3471757667122062, 'recall': 0.8235550489472978, 'f1-score': 0.4884442294054097, 'support': 89484}, '2': {'precision': 0.4025722694835302, 'recall': 0.21585222175383983, 'f1-score': 0.28102418327786494, 'support': 92517}, 'accuracy': 0.3578409145368148, 'macro avg': {'precision': 0.3707924013980106, 'recall': 0.3591807331127279, 'f1-score': 0.2794935898751883, 'support': 271263}, 'weighted avg': {'precision': 0.37115441382771214, 'recall': 0.3578409145368148, 'f1-score': 0.27968296005653054, 'support': 271263}}
[[ 3404 69156 16702]
 [ 2855 73695 12934]
 [ 3128 69419 19970]]
Evaluating performance on  val set...
404/404 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0779793
{'0': {'precision': 0.2540192926045016, 'recall': 0.0029921975607908493, 'f1-score': 0.005914723168494742, 'support': 26402}, '1': {'precision': 0.4580670797847776, 'recall': 0.928994598362084, 'f1-score': 0.6135874842654199, 'support': 45912}, '2': {'precision': 0.40122219995992786, 'recall': 0.12881126978000773, 'f1-score': 0.19501387739202417, 'support': 31092}, 'accuracy': 0.4519660367870336, 'macro avg': {'precision': 0.3711028574497357, 'recall': 0.3535993552342942, 'f1-score': 0.27150536160864625, 'support': 103406}, 'weighted avg': {'precision': 0.3888767941084351, 'recall': 0.4519660367870336, 'f1-score': 0.33257799909639063, 'support': 103406}}
[[   79 23448  2875]
 [  158 42652  3102]
 [   74 27013  4005]]
training model: results/EXC/W10/deepOF_L2/h10
Epoch 1/50
1060/1060 - 26s - loss: 2.6790 - accuracy10: 0.5280 - val_loss: 2.3705 - val_accuracy10: 0.6745 - 26s/epoch - 25ms/step
Epoch 2/50
1060/1060 - 24s - loss: 2.2744 - accuracy10: 0.6108 - val_loss: 2.2125 - val_accuracy10: 0.6873 - 24s/epoch - 22ms/step
Epoch 3/50
1060/1060 - 24s - loss: 2.1304 - accuracy10: 0.6361 - val_loss: 2.1334 - val_accuracy10: 0.6886 - 24s/epoch - 22ms/step
Epoch 4/50
1060/1060 - 24s - loss: 2.0749 - accuracy10: 0.6475 - val_loss: 2.1045 - val_accuracy10: 0.6940 - 24s/epoch - 22ms/step
Epoch 5/50
1060/1060 - 24s - loss: 2.0453 - accuracy10: 0.6509 - val_loss: 2.0983 - val_accuracy10: 0.7103 - 24s/epoch - 22ms/step
Epoch 6/50
1060/1060 - 24s - loss: 2.0220 - accuracy10: 0.6554 - val_loss: 2.0726 - val_accuracy10: 0.7016 - 24s/epoch - 22ms/step
Epoch 7/50
1060/1060 - 24s - loss: 2.0041 - accuracy10: 0.6553 - val_loss: 2.0921 - val_accuracy10: 0.7246 - 24s/epoch - 22ms/step
Epoch 8/50
1060/1060 - 24s - loss: 1.9891 - accuracy10: 0.6547 - val_loss: 2.0842 - val_accuracy10: 0.7192 - 24s/epoch - 22ms/step
Epoch 9/50
1060/1060 - 24s - loss: 1.9752 - accuracy10: 0.6570 - val_loss: 2.0888 - val_accuracy10: 0.7128 - 24s/epoch - 22ms/step
Epoch 10/50
1060/1060 - 23s - loss: 1.9603 - accuracy10: 0.6576 - val_loss: 2.0908 - val_accuracy10: 0.7045 - 23s/epoch - 22ms/step
Epoch 11/50
1060/1060 - 24s - loss: 1.9476 - accuracy10: 0.6599 - val_loss: 2.1139 - val_accuracy10: 0.7158 - 24s/epoch - 22ms/step
Epoch 12/50
1060/1060 - 24s - loss: 1.9385 - accuracy10: 0.6609 - val_loss: 2.0995 - val_accuracy10: 0.7127 - 24s/epoch - 22ms/step
Epoch 13/50
1060/1060 - 24s - loss: 1.9292 - accuracy10: 0.6614 - val_loss: 2.1045 - val_accuracy10: 0.7182 - 24s/epoch - 22ms/step
Epoch 14/50
1060/1060 - 24s - loss: 1.9180 - accuracy10: 0.6625 - val_loss: 2.0901 - val_accuracy10: 0.7185 - 24s/epoch - 22ms/step
Epoch 15/50
1060/1060 - 24s - loss: 1.9074 - accuracy10: 0.6636 - val_loss: 2.1264 - val_accuracy10: 0.7245 - 24s/epoch - 22ms/step
Epoch 16/50
1060/1060 - 24s - loss: 1.9002 - accuracy10: 0.6629 - val_loss: 2.0914 - val_accuracy10: 0.7100 - 24s/epoch - 22ms/step
testing model: results/EXC/W10/deepOF_L2/h10
Evaluating performance on  test set...
5267/5267 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73170596
{'0': {'precision': 0.3552163674295107, 'recall': 0.5938528001268281, 'f1-score': 0.4445328995188813, 'support': 151386}, '1': {'precision': 0.9025095814369097, 'recall': 0.6909961464336117, 'f1-score': 0.7827152823927457, 'support': 1046563}, '2': {'precision': 0.30051019887204866, 'recall': 0.5876926149033181, 'f1-score': 0.3976740938920192, 'support': 150235}, 'accuracy': 0.6685763961002356, 'macro avg': {'precision': 0.5194120492461564, 'recall': 0.6241805204879193, 'f1-score': 0.5416407586012154, 'support': 1348184}, 'weighted avg': {'precision': 0.773970815411385, 'recall': 0.6685763961002356, 'f1-score': 0.7018340813340256, 'support': 1348184}}
[[ 89901  39628  21857]
 [139734 723171 183658]
 [ 23453  38490  88292]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6386539
{'0': {'precision': 0.2885735854900215, 'recall': 0.679087140709698, 'f1-score': 0.4050316515880132, 'support': 21953}, '1': {'precision': 0.9437013570003031, 'recall': 0.7270892813083782, 'f1-score': 0.8213538257859492, 'support': 226968}, '2': {'precision': 0.31336910350994857, 'recall': 0.6274114856094176, 'f1-score': 0.4179749817357726, 'support': 22341}, 'accuracy': 0.7149950969911009, 'macro avg': {'precision': 0.515214682000091, 'recall': 0.6778626358758313, 'f1-score': 0.5481201530365784, 'support': 271262}, 'weighted avg': {'precision': 0.838768587783851, 'recall': 0.7149950969911009, 'f1-score': 0.7544391549323379, 'support': 271262}}
[[ 14908   4566   2479]
 [ 33708 165026  28234]
 [  3045   5279  14017]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6489009
{'0': {'precision': 0.28957731688107113, 'recall': 0.6882565830525397, 'f1-score': 0.4076428413038658, 'support': 8013}, '1': {'precision': 0.9462197143682793, 'recall': 0.7120880881797474, 'f1-score': 0.8126257216750699, 'support': 87367}, '2': {'precision': 0.26751558134536857, 'recall': 0.6203588337901819, 'f1-score': 0.3738268638786696, 'support': 8026}, 'accuracy': 0.7031216757248129, 'macro avg': {'precision': 0.5011042041982398, 'recall': 0.6735678350074896, 'f1-score': 0.5313651422858684, 'support': 103406}, 'weighted avg': {'precision': 0.8426574945482798, 'recall': 0.7031216757248129, 'f1-score': 0.7471853463284905, 'support': 103406}}
[[ 5515  1617   881]
 [12402 62213 12752]
 [ 1128  1919  4979]]
training model: results/EXC/W10/deepOF_L2/h20
Epoch 1/50
1060/1060 - 27s - loss: 2.7109 - accuracy20: 0.5052 - val_loss: 2.4087 - val_accuracy20: 0.6403 - 27s/epoch - 26ms/step
Epoch 2/50
1060/1060 - 25s - loss: 2.3421 - accuracy20: 0.5831 - val_loss: 2.2842 - val_accuracy20: 0.6753 - 25s/epoch - 23ms/step
Epoch 3/50
1060/1060 - 24s - loss: 2.1997 - accuracy20: 0.6125 - val_loss: 2.2179 - val_accuracy20: 0.6594 - 24s/epoch - 23ms/step
Epoch 4/50
1060/1060 - 24s - loss: 2.1410 - accuracy20: 0.6258 - val_loss: 2.2024 - val_accuracy20: 0.6789 - 24s/epoch - 23ms/step
Epoch 5/50
1060/1060 - 24s - loss: 2.1118 - accuracy20: 0.6304 - val_loss: 2.1957 - val_accuracy20: 0.6841 - 24s/epoch - 22ms/step
Epoch 6/50
1060/1060 - 24s - loss: 2.0900 - accuracy20: 0.6339 - val_loss: 2.2137 - val_accuracy20: 0.6808 - 24s/epoch - 23ms/step
Epoch 7/50
1060/1060 - 24s - loss: 2.0742 - accuracy20: 0.6355 - val_loss: 2.2289 - val_accuracy20: 0.6856 - 24s/epoch - 23ms/step
Epoch 8/50
1060/1060 - 24s - loss: 2.0603 - accuracy20: 0.6376 - val_loss: 2.2239 - val_accuracy20: 0.6826 - 24s/epoch - 23ms/step
Epoch 9/50
1060/1060 - 24s - loss: 2.0448 - accuracy20: 0.6396 - val_loss: 2.2223 - val_accuracy20: 0.6897 - 24s/epoch - 22ms/step
Epoch 10/50
1060/1060 - 24s - loss: 2.0309 - accuracy20: 0.6405 - val_loss: 2.2389 - val_accuracy20: 0.6895 - 24s/epoch - 22ms/step
Epoch 11/50
1060/1060 - 23s - loss: 2.0257 - accuracy20: 0.6418 - val_loss: 2.2563 - val_accuracy20: 0.6900 - 23s/epoch - 22ms/step
Epoch 12/50
1060/1060 - 24s - loss: 2.0109 - accuracy20: 0.6424 - val_loss: 2.2435 - val_accuracy20: 0.6874 - 24s/epoch - 22ms/step
Epoch 13/50
1060/1060 - 24s - loss: 1.9994 - accuracy20: 0.6425 - val_loss: 2.2843 - val_accuracy20: 0.6933 - 24s/epoch - 22ms/step
Epoch 14/50
1060/1060 - 23s - loss: 1.9881 - accuracy20: 0.6426 - val_loss: 2.3391 - val_accuracy20: 0.6716 - 23s/epoch - 22ms/step
Epoch 15/50
1060/1060 - 23s - loss: 1.9781 - accuracy20: 0.6459 - val_loss: 2.3135 - val_accuracy20: 0.6821 - 23s/epoch - 22ms/step
testing model: results/EXC/W10/deepOF_L2/h20
Evaluating performance on  test set...
5267/5267 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77851737
{'0': {'precision': 0.4206931779484657, 'recall': 0.5487473842144747, 'f1-score': 0.4762628880331373, 'support': 202616}, '1': {'precision': 0.8389933463040604, 'recall': 0.6817543201118876, 'f1-score': 0.7522449003468992, 'support': 943089}, '2': {'precision': 0.36688363832179194, 'recall': 0.5753930037189042, 'f1-score': 0.44806858039505265, 'support': 202479}, 'accuracy': 0.6457909306148122, 'macro avg': {'precision': 0.5421900541914394, 'recall': 0.6019649026817556, 'f1-score': 0.5588587895916963, 'support': 1348184}, 'weighted avg': {'precision': 0.7052233204959519, 'recall': 0.6457909306148122, 'f1-score': 0.665084921816895, 'support': 1348184}}
[[111185  63560  27871]
 [126957 642955 173177]
 [ 26148  59826 116505]]
Evaluating performance on  train set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.67942506
{'0': {'precision': 0.354162564662502, 'recall': 0.645820413225838, 'f1-score': 0.45745861463053733, 'support': 30637}, '1': {'precision': 0.9002968363651752, 'recall': 0.7109696885786717, 'f1-score': 0.794510096833569, 'support': 209459}, '2': {'precision': 0.3843830025608195, 'recall': 0.6164730796380671, 'f1-score': 0.4735181762168823, 'support': 31166}, 'accuracy': 0.6927546062478342, 'macro avg': {'precision': 0.5462808011961656, 'recall': 0.6577543938141923, 'f1-score': 0.5751622958936629, 'support': 271262}, 'weighted avg': {'precision': 0.7793403948934565, 'recall': 0.6927546062478342, 'f1-score': 0.7195630697593974, 'support': 271262}}
[[ 19786   7886   2965]
 [ 32734 148919  27806]
 [  3347   8606  19213]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6909671
{'0': {'precision': 0.3564497857459489, 'recall': 0.6495243223837731, 'f1-score': 0.4602957544919701, 'support': 11142}, '1': {'precision': 0.9035904467332037, 'recall': 0.6988113733323469, 'f1-score': 0.7881160307041939, 'support': 81102}, '2': {'precision': 0.3354104312840391, 'recall': 0.61243504748253, 'f1-score': 0.43344006594173035, 'support': 11162}, 'accuracy': 0.6841769336402143, 'macro avg': {'precision': 0.5318168879210639, 'recall': 0.6535902477328833, 'f1-score': 0.5606172837126314, 'support': 103406}, 'weighted avg': {'precision': 0.783304713050791, 'recall': 0.6841769336402143, 'f1-score': 0.7145084389180769, 'support': 103406}}
[[ 7237  2899  1006]
 [11888 56675 12539]
 [ 1178  3148  6836]]
training model: results/EXC/W10/deepOF_L2/h30
Epoch 1/50
1060/1060 - 26s - loss: 2.7742 - accuracy30: 0.4816 - val_loss: 2.4865 - val_accuracy30: 0.6323 - 26s/epoch - 25ms/step
Epoch 2/50
1060/1060 - 25s - loss: 2.4354 - accuracy30: 0.5609 - val_loss: 2.3606 - val_accuracy30: 0.6437 - 25s/epoch - 24ms/step
Epoch 3/50
1060/1060 - 25s - loss: 2.2986 - accuracy30: 0.5907 - val_loss: 2.3482 - val_accuracy30: 0.6332 - 25s/epoch - 23ms/step
Epoch 4/50
1060/1060 - 25s - loss: 2.2376 - accuracy30: 0.6065 - val_loss: 2.3805 - val_accuracy30: 0.6367 - 25s/epoch - 23ms/step
Epoch 5/50
1060/1060 - 25s - loss: 2.2080 - accuracy30: 0.6118 - val_loss: 2.3523 - val_accuracy30: 0.6289 - 25s/epoch - 23ms/step
Epoch 6/50
1060/1060 - 25s - loss: 2.1893 - accuracy30: 0.6164 - val_loss: 2.3225 - val_accuracy30: 0.6488 - 25s/epoch - 23ms/step
Epoch 7/50
1060/1060 - 24s - loss: 2.1713 - accuracy30: 0.6184 - val_loss: 2.3473 - val_accuracy30: 0.6436 - 24s/epoch - 23ms/step
Epoch 8/50
1060/1060 - 24s - loss: 2.1569 - accuracy30: 0.6205 - val_loss: 2.3422 - val_accuracy30: 0.6489 - 24s/epoch - 22ms/step
Epoch 9/50
1060/1060 - 24s - loss: 2.1417 - accuracy30: 0.6235 - val_loss: 2.3543 - val_accuracy30: 0.6519 - 24s/epoch - 23ms/step
Epoch 10/50
1060/1060 - 24s - loss: 2.1299 - accuracy30: 0.6244 - val_loss: 2.3749 - val_accuracy30: 0.6529 - 24s/epoch - 22ms/step
Epoch 11/50
1060/1060 - 24s - loss: 2.1202 - accuracy30: 0.6268 - val_loss: 2.3718 - val_accuracy30: 0.6555 - 24s/epoch - 22ms/step
Epoch 12/50
1060/1060 - 23s - loss: 2.1079 - accuracy30: 0.6272 - val_loss: 2.3923 - val_accuracy30: 0.6475 - 23s/epoch - 22ms/step
Epoch 13/50
1060/1060 - 23s - loss: 2.0925 - accuracy30: 0.6289 - val_loss: 2.3922 - val_accuracy30: 0.6571 - 23s/epoch - 22ms/step
Epoch 14/50
1060/1060 - 24s - loss: 2.0823 - accuracy30: 0.6308 - val_loss: 2.4272 - val_accuracy30: 0.6522 - 24s/epoch - 22ms/step
Epoch 15/50
1060/1060 - 24s - loss: 2.0703 - accuracy30: 0.6315 - val_loss: 2.4632 - val_accuracy30: 0.6602 - 24s/epoch - 22ms/step
Epoch 16/50
1060/1060 - 23s - loss: 2.0592 - accuracy30: 0.6321 - val_loss: 2.4350 - val_accuracy30: 0.6476 - 23s/epoch - 22ms/step
testing model: results/EXC/W10/deepOF_L2/h30
Evaluating performance on  test set...
5267/5267 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84290653
{'0': {'precision': 0.4523512484584175, 'recall': 0.5228919944133616, 'f1-score': 0.48507046464692927, 'support': 242006}, '1': {'precision': 0.7820776233124291, 'recall': 0.6414092423583949, 'f1-score': 0.7047930373391724, 'support': 862875}, '2': {'precision': 0.3923246434659681, 'recall': 0.5817314213141638, 'f1-score': 0.4686128051808736, 'support': 243303}, 'accuracy': 0.609364893812714, 'macro avg': {'precision': 0.542251171745605, 'recall': 0.58201088602864, 'f1-score': 0.5528254357223251, 'support': 1348184}, 'weighted avg': {'precision': 0.6525524024757307, 'recall': 0.609364893812714, 'f1-score': 0.6227289125967266, 'support': 1348184}}
[[126543  80639  34824]
 [125015 553456 184404]
 [ 28187  73579 141537]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7281274
{'0': {'precision': 0.3991487883262399, 'recall': 0.611887832547735, 'f1-score': 0.4831363808402372, 'support': 37551}, '1': {'precision': 0.8594778027225892, 'recall': 0.6773316015810762, 'f1-score': 0.7576105078628806, 'support': 195563}, '2': {'precision': 0.4030614813944511, 'recall': 0.6294956485267904, 'f1-score': 0.49145067381583396, 'support': 38148}, 'accuracy': 0.6615449270447021, 'macro avg': {'precision': 0.5538960241477601, 'recall': 0.6395716942185339, 'f1-score': 0.5773991875063172, 'support': 271262}, 'weighted avg': {'precision': 0.7315675733295186, 'recall': 0.6615449270447021, 'f1-score': 0.6821843763256434, 'support': 271262}}
[[ 22977  10935   3639]
 [ 31176 132461  31926]
 [  3412  10722  24014]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74641657
{'0': {'precision': 0.39519115171916325, 'recall': 0.6043535814090307, 'f1-score': 0.47788794231384296, 'support': 13598}, '1': {'precision': 0.8645265565088808, 'recall': 0.6610309874709123, 'f1-score': 0.7492065384214212, 'support': 76063}, '2': {'precision': 0.35547194503517093, 'recall': 0.6323754092397236, 'f1-score': 0.455114275990261, 'support': 13745}, 'accuracy': 0.6497688722124442, 'macro avg': {'precision': 0.5383965510877383, 'recall': 0.6325866593732222, 'f1-score': 0.5607362522418416, 'support': 103406}, 'weighted avg': {'precision': 0.7351435567889736, 'recall': 0.6497688722124442, 'f1-score': 0.6744363276310691, 'support': 103406}}
[[ 8218  4081  1299]
 [11322 50280 14461]
 [ 1255  3798  8692]]
training model: results/EXC/W10/deepOF_L2/h50
Epoch 1/50
1060/1060 - 26s - loss: 2.8820 - accuracy50: 0.4661 - val_loss: 2.6545 - val_accuracy50: 0.5700 - 26s/epoch - 25ms/step
Epoch 2/50
1060/1060 - 24s - loss: 2.6079 - accuracy50: 0.5365 - val_loss: 2.5433 - val_accuracy50: 0.5911 - 24s/epoch - 22ms/step
Epoch 3/50
1060/1060 - 24s - loss: 2.4944 - accuracy50: 0.5614 - val_loss: 2.5132 - val_accuracy50: 0.5830 - 24s/epoch - 22ms/step
Epoch 4/50
1060/1060 - 23s - loss: 2.4390 - accuracy50: 0.5754 - val_loss: 2.5171 - val_accuracy50: 0.5855 - 23s/epoch - 22ms/step
Epoch 5/50
1060/1060 - 23s - loss: 2.4082 - accuracy50: 0.5816 - val_loss: 2.5182 - val_accuracy50: 0.5941 - 23s/epoch - 22ms/step
Epoch 6/50
1060/1060 - 23s - loss: 2.3866 - accuracy50: 0.5890 - val_loss: 2.5206 - val_accuracy50: 0.5866 - 23s/epoch - 22ms/step
Epoch 7/50
1060/1060 - 23s - loss: 2.3674 - accuracy50: 0.5918 - val_loss: 2.5139 - val_accuracy50: 0.6094 - 23s/epoch - 22ms/step
Epoch 8/50
1060/1060 - 24s - loss: 2.3546 - accuracy50: 0.5932 - val_loss: 2.5086 - val_accuracy50: 0.6117 - 24s/epoch - 22ms/step
Epoch 9/50
1060/1060 - 24s - loss: 2.3415 - accuracy50: 0.5969 - val_loss: 2.5122 - val_accuracy50: 0.6129 - 24s/epoch - 22ms/step
Epoch 10/50
1060/1060 - 24s - loss: 2.3296 - accuracy50: 0.5975 - val_loss: 2.5292 - val_accuracy50: 0.6159 - 24s/epoch - 22ms/step
Epoch 11/50
1060/1060 - 24s - loss: 2.3172 - accuracy50: 0.5993 - val_loss: 2.5470 - val_accuracy50: 0.6164 - 24s/epoch - 22ms/step
Epoch 12/50
1060/1060 - 23s - loss: 2.3060 - accuracy50: 0.6006 - val_loss: 2.6750 - val_accuracy50: 0.5514 - 23s/epoch - 22ms/step
Epoch 13/50
1060/1060 - 24s - loss: 2.2946 - accuracy50: 0.6039 - val_loss: 2.5769 - val_accuracy50: 0.6163 - 24s/epoch - 22ms/step
Epoch 14/50
1060/1060 - 24s - loss: 2.2820 - accuracy50: 0.6047 - val_loss: 2.5842 - val_accuracy50: 0.6267 - 24s/epoch - 22ms/step
Epoch 15/50
1060/1060 - 24s - loss: 2.2688 - accuracy50: 0.6069 - val_loss: 2.5760 - val_accuracy50: 0.6073 - 24s/epoch - 22ms/step
Epoch 16/50
1060/1060 - 24s - loss: 2.2580 - accuracy50: 0.6084 - val_loss: 2.6364 - val_accuracy50: 0.6086 - 24s/epoch - 22ms/step
Epoch 17/50
1060/1060 - 24s - loss: 2.2490 - accuracy50: 0.6099 - val_loss: 2.6325 - val_accuracy50: 0.6188 - 24s/epoch - 22ms/step
Epoch 18/50
1060/1060 - 24s - loss: 2.2326 - accuracy50: 0.6130 - val_loss: 2.6514 - val_accuracy50: 0.6164 - 24s/epoch - 22ms/step
testing model: results/EXC/W10/deepOF_L2/h50
Evaluating performance on  test set...
5267/5267 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9127803
{'0': {'precision': 0.48873006432069993, 'recall': 0.49142455635805093, 'f1-score': 0.490073606695488, 'support': 305990}, '1': {'precision': 0.6771267333412346, 'recall': 0.6075775403329711, 'f1-score': 0.6404695673044793, 'support': 733457}, '2': {'precision': 0.4449913045752318, 'recall': 0.5511422343288949, 'f1-score': 0.49241089127534654, 'support': 308737}, 'accuracy': 0.5682911234668265, 'macro avg': {'precision': 0.5369493674123887, 'recall': 0.5500481103399723, 'f1-score': 0.5409846884251047, 'support': 1348184}, 'weighted avg': {'precision': 0.5812078583030181, 'recall': 0.5682911234668265, 'f1-score': 0.5724292616429735, 'support': 1348184}}
[[150371 109012  46607]
 [122205 445632 165620]
 [ 35101 103478 170158]]
Evaluating performance on  train set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.79598117
{'0': {'precision': 0.44467698324193033, 'recall': 0.5888219111578606, 'f1-score': 0.5066973028016397, 'support': 49436}, '1': {'precision': 0.7754505943562486, 'recall': 0.6430505336337753, 'f1-score': 0.7030715854473693, 'support': 171747}, '2': {'precision': 0.4692322256934583, 'recall': 0.593841730066495, 'f1-score': 0.5242338507099605, 'support': 50079}, 'accuracy': 0.6240829898769455, 'macro avg': {'precision': 0.5631199344305458, 'recall': 0.608571391619377, 'f1-score': 0.5780009129863232, 'support': 271262}, 'weighted avg': {'precision': 0.6586364666003841, 'recall': 0.6240829898769455, 'f1-score': 0.6342673520686101, 'support': 271262}}
[[ 29109  15729   4598]
 [ 32264 110442  29041]
 [  4088  16252  29739]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81464213
{'0': {'precision': 0.432840313010577, 'recall': 0.5652442448062887, 'f1-score': 0.49026005649167237, 'support': 17810}, '1': {'precision': 0.7838922698433252, 'recall': 0.6289030036803989, 'f1-score': 0.6978961669891719, 'support': 67384}, '2': {'precision': 0.41756430405949324, 'recall': 0.5981221172853064, 'f1-score': 0.49179439716472156, 'support': 18212}, 'accuracy': 0.6125176488791753, 'macro avg': {'precision': 0.5447656289711318, 'recall': 0.5974231219239979, 'f1-score': 0.5599835402151886, 'support': 103406}, 'weighted avg': {'precision': 0.6589111249963493, 'recall': 0.6125176488791753, 'f1-score': 0.6258353140405678, 'support': 103406}}
[[10067  5948  1795]
 [11607 42378 13399]
 [ 1584  5735 10893]]
training model: results/EXC/W10/deepOF_L2/h100
Epoch 1/50
1060/1060 - 27s - loss: 3.0861 - accuracy100: 0.4378 - val_loss: 2.9400 - val_accuracy100: 0.4969 - 27s/epoch - 25ms/step
Epoch 2/50
1060/1060 - 24s - loss: 2.9178 - accuracy100: 0.4880 - val_loss: 2.8847 - val_accuracy100: 0.5223 - 24s/epoch - 22ms/step
Epoch 3/50
1060/1060 - 23s - loss: 2.8357 - accuracy100: 0.5084 - val_loss: 2.8414 - val_accuracy100: 0.5314 - 23s/epoch - 22ms/step
Epoch 4/50
1060/1060 - 23s - loss: 2.7922 - accuracy100: 0.5179 - val_loss: 2.8332 - val_accuracy100: 0.5363 - 23s/epoch - 22ms/step
Epoch 5/50
1060/1060 - 23s - loss: 2.7680 - accuracy100: 0.5249 - val_loss: 2.8263 - val_accuracy100: 0.5385 - 23s/epoch - 22ms/step
Epoch 6/50
1060/1060 - 24s - loss: 2.7489 - accuracy100: 0.5297 - val_loss: 2.8224 - val_accuracy100: 0.5390 - 24s/epoch - 22ms/step
Epoch 7/50
1060/1060 - 23s - loss: 2.7358 - accuracy100: 0.5332 - val_loss: 2.8242 - val_accuracy100: 0.5424 - 23s/epoch - 22ms/step
Epoch 8/50
1060/1060 - 24s - loss: 2.7230 - accuracy100: 0.5360 - val_loss: 2.8324 - val_accuracy100: 0.5427 - 24s/epoch - 22ms/step
Epoch 9/50
1060/1060 - 24s - loss: 2.7119 - accuracy100: 0.5380 - val_loss: 2.8396 - val_accuracy100: 0.5388 - 24s/epoch - 22ms/step
Epoch 10/50
1060/1060 - 23s - loss: 2.7017 - accuracy100: 0.5412 - val_loss: 2.8363 - val_accuracy100: 0.5386 - 23s/epoch - 22ms/step
Epoch 11/50
1060/1060 - 23s - loss: 2.6916 - accuracy100: 0.5433 - val_loss: 2.8489 - val_accuracy100: 0.5377 - 23s/epoch - 22ms/step
Epoch 12/50
1060/1060 - 23s - loss: 2.6798 - accuracy100: 0.5451 - val_loss: 2.8595 - val_accuracy100: 0.5346 - 23s/epoch - 22ms/step
Epoch 13/50
1060/1060 - 23s - loss: 2.6673 - accuracy100: 0.5487 - val_loss: 2.8670 - val_accuracy100: 0.5323 - 23s/epoch - 22ms/step
Epoch 14/50
1060/1060 - 23s - loss: 2.6574 - accuracy100: 0.5503 - val_loss: 2.8903 - val_accuracy100: 0.5299 - 23s/epoch - 22ms/step
Epoch 15/50
1060/1060 - 24s - loss: 2.6468 - accuracy100: 0.5527 - val_loss: 2.9056 - val_accuracy100: 0.5300 - 24s/epoch - 22ms/step
Epoch 16/50
1060/1060 - 24s - loss: 2.6328 - accuracy100: 0.5555 - val_loss: 2.9145 - val_accuracy100: 0.5270 - 24s/epoch - 22ms/step
testing model: results/EXC/W10/deepOF_L2/h100
Evaluating performance on  test set...
5267/5267 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0028678
{'0': {'precision': 0.5282033932602743, 'recall': 0.410509890649957, 'f1-score': 0.4619785847814785, 'support': 406950}, '1': {'precision': 0.47448109850481973, 'recall': 0.5883932826290006, 'f1-score': 0.5253329952253595, 'support': 524610}, '2': {'precision': 0.505473930977336, 'recall': 0.4626809785322017, 'f1-score': 0.48313171933526905, 'support': 416624}, 'accuracy': 0.4958507147392344, 'macro avg': {'precision': 0.5027194742474766, 'recall': 0.4871947172703865, 'f1-score': 0.490147766447369, 'support': 1348184}, 'weighted avg': {'precision': 0.5002747926050033, 'recall': 0.4958507147392344, 'f1-score': 0.49316814109819995, 'support': 1348184}}
[[167057 173714  66179]
 [ 93523 308677 122410]
 [ 55694 168166 192764]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9240552
{'0': {'precision': 0.4912229697926184, 'recall': 0.49841974406877276, 'f1-score': 0.49479518912323517, 'support': 71191}, '1': {'precision': 0.5713969383386723, 'recall': 0.6041926823176823, 'f1-score': 0.5873373544250977, 'support': 128128}, '2': {'precision': 0.5391527397475844, 'recall': 0.47622423307340533, 'f1-score': 0.5057384732339895, 'support': 71943}, 'accuracy': 0.5424939726168796, 'macro avg': {'precision': 0.533924215959625, 'recall': 0.5262788864866201, 'f1-score': 0.5292903389274408, 'support': 271262}, 'weighted avg': {'precision': 0.541804111573402, 'recall': 0.5424939726168796, 'f1-score': 0.5414089250854306, 'support': 271262}}
[[35483 28319  7389]
 [28818 77414 21896]
 [ 7933 29749 34261]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9311948
{'0': {'precision': 0.47768405211674786, 'recall': 0.47216785406717293, 'f1-score': 0.4749099356261196, 'support': 25546}, '1': {'precision': 0.5879690268895909, 'recall': 0.5960517066312583, 'f1-score': 0.5919827786828019, 'support': 51212}, '2': {'precision': 0.49708449254925874, 'recall': 0.4894551185830081, 'f1-score': 0.4932403048008017, 'support': 26648}, 'accuracy': 0.5379765197377329, 'macro avg': {'precision': 0.5209125238518658, 'recall': 0.5192248930938131, 'f1-score': 0.520044339703241, 'support': 103406}, 'weighted avg': {'precision': 0.5373024211157652, 'recall': 0.5379765197377329, 'f1-score': 0.5376142479134699, 'support': 103406}}
[[12062 10507  2977]
 [10468 30525 10219]
 [ 2721 10884 13043]]
training model: results/EXC/W10/deepOF_L2/h200
Epoch 1/50
1060/1060 - 26s - loss: 3.2199 - accuracy200: 0.4064 - val_loss: 3.1620 - val_accuracy200: 0.4225 - 26s/epoch - 24ms/step
Epoch 2/50
1060/1060 - 24s - loss: 3.1333 - accuracy200: 0.4392 - val_loss: 3.1223 - val_accuracy200: 0.4359 - 24s/epoch - 23ms/step
Epoch 3/50
1060/1060 - 24s - loss: 3.0933 - accuracy200: 0.4503 - val_loss: 3.0990 - val_accuracy200: 0.4422 - 24s/epoch - 22ms/step
Epoch 4/50
1060/1060 - 24s - loss: 3.0661 - accuracy200: 0.4590 - val_loss: 3.0907 - val_accuracy200: 0.4453 - 24s/epoch - 22ms/step
Epoch 5/50
1060/1060 - 24s - loss: 3.0463 - accuracy200: 0.4647 - val_loss: 3.0792 - val_accuracy200: 0.4486 - 24s/epoch - 22ms/step
Epoch 6/50
1060/1060 - 24s - loss: 3.0328 - accuracy200: 0.4685 - val_loss: 3.0817 - val_accuracy200: 0.4485 - 24s/epoch - 22ms/step
Epoch 7/50
1060/1060 - 24s - loss: 3.0209 - accuracy200: 0.4726 - val_loss: 3.0816 - val_accuracy200: 0.4485 - 24s/epoch - 22ms/step
Epoch 8/50
1060/1060 - 24s - loss: 3.0119 - accuracy200: 0.4747 - val_loss: 3.0853 - val_accuracy200: 0.4487 - 24s/epoch - 22ms/step
Epoch 9/50
1060/1060 - 24s - loss: 3.0040 - accuracy200: 0.4769 - val_loss: 3.0848 - val_accuracy200: 0.4493 - 24s/epoch - 22ms/step
Epoch 10/50
1060/1060 - 24s - loss: 2.9942 - accuracy200: 0.4801 - val_loss: 3.0874 - val_accuracy200: 0.4482 - 24s/epoch - 22ms/step
Epoch 11/50
1060/1060 - 24s - loss: 2.9850 - accuracy200: 0.4827 - val_loss: 3.0888 - val_accuracy200: 0.4468 - 24s/epoch - 22ms/step
Epoch 12/50
1060/1060 - 23s - loss: 2.9775 - accuracy200: 0.4840 - val_loss: 3.1160 - val_accuracy200: 0.4449 - 23s/epoch - 22ms/step
Epoch 13/50
1060/1060 - 24s - loss: 2.9681 - accuracy200: 0.4880 - val_loss: 3.1239 - val_accuracy200: 0.4445 - 24s/epoch - 22ms/step
Epoch 14/50
1060/1060 - 24s - loss: 2.9551 - accuracy200: 0.4904 - val_loss: 3.1359 - val_accuracy200: 0.4405 - 24s/epoch - 22ms/step
Epoch 15/50
1060/1060 - 24s - loss: 2.9459 - accuracy200: 0.4944 - val_loss: 3.1478 - val_accuracy200: 0.4436 - 24s/epoch - 22ms/step
testing model: results/EXC/W10/deepOF_L2/h200
Evaluating performance on  test set...
5267/5267 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0533994
{'0': {'precision': 0.5193425366019303, 'recall': 0.3300026971513932, 'f1-score': 0.4035683748214417, 'support': 481990}, '1': {'precision': 0.3154132487163617, 'recall': 0.4941276084343931, 'f1-score': 0.3850439242937793, 'support': 366120}, '2': {'precision': 0.4975883472011376, 'recall': 0.4660230285917684, 'f1-score': 0.4812886903993598, 'support': 500074}, 'accuracy': 0.4250265542388873, 'macro avg': {'precision': 0.44411471083980986, 'recall': 0.4300511113925182, 'f1-score': 0.4233003298381936, 'support': 1348184}, 'weighted avg': {'precision': 0.4558932630672522, 'recall': 0.4250265542388873, 'f1-score': 0.4273661185011799, 'support': 1348184}}
[[159058 202479 120453]
 [ 70358 180910 114852]
 [ 76852 190176 233046]]
Evaluating performance on  train set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0210752
{'0': {'precision': 0.5150252314779736, 'recall': 0.37700644502867536, 'f1-score': 0.4353384229133576, 'support': 90147}, '1': {'precision': 0.3809941154375861, 'recall': 0.506485724747839, 'f1-score': 0.43486752474681556, 'support': 90121}, '2': {'precision': 0.5038025927832639, 'recall': 0.4732070246389872, 'f1-score': 0.4880257505865285, 'support': 90994}, 'accuracy': 0.4522933547640289, 'macro avg': {'precision': 0.4666073132329412, 'recall': 0.4522330648051672, 'f1-score': 0.4527438994155672, 'support': 271262}, 'weighted avg': {'precision': 0.4667316592339358, 'recall': 0.4522933547640289, 'f1-score': 0.4528557783874954, 'support': 271262}}
[[33986 38768 17393]
 [19460 45645 25016]
 [12543 35392 43059]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0268276
{'0': {'precision': 0.4884874540118226, 'recall': 0.3635105204872647, 'f1-score': 0.4168327483729871, 'support': 32508}, '1': {'precision': 0.39623229020706835, 'recall': 0.4934903047091413, 'f1-score': 0.4395455274422966, 'support': 36100}, '2': {'precision': 0.4876218835756408, 'recall': 0.47999885050864993, 'f1-score': 0.4837803394543243, 'support': 34798}, 'accuracy': 0.448088118677833, 'macro avg': {'precision': 0.4574472092648439, 'recall': 0.44566655856835197, 'f1-score': 0.4467195384232026, 'support': 103406}, 'weighted avg': {'precision': 0.4559890348350835, 'recall': 0.448088118677833, 'f1-score': 0.4472910737975316, 'support': 103406}}
[[11817 13800  6891]
 [ 7625 17815 10660]
 [ 4749 13346 16703]]
training model: results/EXC/W10/deepOF_L2/h300
Epoch 1/50
1060/1060 - 27s - loss: 3.2744 - accuracy300: 0.3808 - val_loss: 3.2345 - val_accuracy300: 0.3910 - 27s/epoch - 25ms/step
Epoch 2/50
1060/1060 - 24s - loss: 3.2310 - accuracy300: 0.4031 - val_loss: 3.2170 - val_accuracy300: 0.4003 - 24s/epoch - 23ms/step
Epoch 3/50
1060/1060 - 24s - loss: 3.2124 - accuracy300: 0.4115 - val_loss: 3.2087 - val_accuracy300: 0.4033 - 24s/epoch - 22ms/step
Epoch 4/50
1060/1060 - 23s - loss: 3.1987 - accuracy300: 0.4183 - val_loss: 3.2022 - val_accuracy300: 0.4052 - 23s/epoch - 22ms/step
Epoch 5/50
1060/1060 - 23s - loss: 3.1859 - accuracy300: 0.4246 - val_loss: 3.1965 - val_accuracy300: 0.4096 - 23s/epoch - 22ms/step
Epoch 6/50
1060/1060 - 24s - loss: 3.1757 - accuracy300: 0.4294 - val_loss: 3.1942 - val_accuracy300: 0.4106 - 24s/epoch - 22ms/step
Epoch 7/50
1060/1060 - 23s - loss: 3.1671 - accuracy300: 0.4332 - val_loss: 3.1934 - val_accuracy300: 0.4112 - 23s/epoch - 22ms/step
Epoch 8/50
1060/1060 - 23s - loss: 3.1592 - accuracy300: 0.4371 - val_loss: 3.1942 - val_accuracy300: 0.4115 - 23s/epoch - 22ms/step
Epoch 9/50
1060/1060 - 23s - loss: 3.1534 - accuracy300: 0.4395 - val_loss: 3.1973 - val_accuracy300: 0.4108 - 23s/epoch - 22ms/step
Epoch 10/50
1060/1060 - 23s - loss: 3.1464 - accuracy300: 0.4417 - val_loss: 3.1997 - val_accuracy300: 0.4105 - 23s/epoch - 22ms/step
Epoch 11/50
1060/1060 - 23s - loss: 3.1379 - accuracy300: 0.4451 - val_loss: 3.2057 - val_accuracy300: 0.4108 - 23s/epoch - 22ms/step
Epoch 12/50
1060/1060 - 23s - loss: 3.1279 - accuracy300: 0.4492 - val_loss: 3.2063 - val_accuracy300: 0.4117 - 23s/epoch - 22ms/step
Epoch 13/50
1060/1060 - 23s - loss: 3.1197 - accuracy300: 0.4513 - val_loss: 3.2081 - val_accuracy300: 0.4112 - 23s/epoch - 22ms/step
Epoch 14/50
1060/1060 - 23s - loss: 3.1100 - accuracy300: 0.4550 - val_loss: 3.2146 - val_accuracy300: 0.4090 - 23s/epoch - 22ms/step
Epoch 15/50
1060/1060 - 24s - loss: 3.1007 - accuracy300: 0.4582 - val_loss: 3.2158 - val_accuracy300: 0.4095 - 24s/epoch - 22ms/step
Epoch 16/50
1060/1060 - 24s - loss: 3.0898 - accuracy300: 0.4610 - val_loss: 3.2348 - val_accuracy300: 0.4052 - 24s/epoch - 22ms/step
Epoch 17/50
1060/1060 - 23s - loss: 3.0820 - accuracy300: 0.4636 - val_loss: 3.2561 - val_accuracy300: 0.4014 - 23s/epoch - 22ms/step
testing model: results/EXC/W10/deepOF_L2/h300
Evaluating performance on  test set...
5267/5267 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0802643
{'0': {'precision': 0.43871866960062245, 'recall': 0.4004714401800361, 'f1-score': 0.41872347016757, 'support': 459019}, '1': {'precision': 0.32315985084361964, 'recall': 0.25183114395248973, 'f1-score': 0.283071267738106, 'support': 417089}, '2': {'precision': 0.4308123425484231, 'recall': 0.5513455460561435, 'f1-score': 0.4836828558951154, 'support': 472076}, 'accuracy': 0.40731606368270207, 'macro avg': {'precision': 0.39756362099755505, 'recall': 0.40121604339622313, 'f1-score': 0.3951591979335971, 'support': 1348184}, 'weighted avg': {'precision': 0.40019966966735404, 'recall': 0.40731606368270207, 'f1-score': 0.39950259639782787, 'support': 1348184}}
[[183824 115845 159350]
 [127526 105036 184527]
 [107652 104147 260277]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.06185
{'0': {'precision': 0.44215946229265585, 'recall': 0.47714795878758304, 'f1-score': 0.4589878859971515, 'support': 90167}, '1': {'precision': 0.34760546026393435, 'recall': 0.23978393612024423, 'f1-score': 0.2837988087359365, 'support': 89418}, '2': {'precision': 0.44893033363615314, 'recall': 0.5498107486065207, 'f1-score': 0.49427569807065286, 'support': 91677}, 'accuracy': 0.42346145055333956, 'macro avg': {'precision': 0.41289841873091443, 'recall': 0.42224754783811597, 'f1-score': 0.41235413093458034, 'support': 271262}, 'weighted avg': {'precision': 0.4132792778906887, 'recall': 0.42346145055333956, 'f1-score': 0.4131651162650072, 'support': 271262}}
[[43023 20831 26313]
 [32417 21441 35560]
 [21862 19410 50405]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0640165
{'0': {'precision': 0.41162450104815784, 'recall': 0.4530914148438488, 'f1-score': 0.4313636979190178, 'support': 31636}, '1': {'precision': 0.38309978768577496, 'recall': 0.24113323533342243, 'f1-score': 0.2959730993192816, 'support': 37415}, '2': {'precision': 0.42824151178025005, 'recall': 0.5613447824188619, 'f1-score': 0.4858416889202399, 'support': 34355}, 'accuracy': 0.41236485310330157, 'macro avg': {'precision': 0.4076552668380609, 'recall': 0.418523144198711, 'f1-score': 0.4043928287195131, 'support': 103406}, 'weighted avg': {'precision': 0.40682425012700696, 'recall': 0.41236485310330157, 'f1-score': 0.40047527881604367, 'support': 103406}}
[[14334  7299 10003]
 [12648  9022 15745]
 [ 7841  7229 19285]]
training model: results/EXC/W10/deepOF_L2/h500
Epoch 1/50
1060/1060 - 26s - loss: 3.2841 - accuracy500: 0.3779 - val_loss: 3.2600 - val_accuracy500: 0.3850 - 26s/epoch - 25ms/step
Epoch 2/50
1060/1060 - 24s - loss: 3.2551 - accuracy500: 0.3923 - val_loss: 3.2433 - val_accuracy500: 0.4009 - 24s/epoch - 22ms/step
Epoch 3/50
1060/1060 - 24s - loss: 3.2415 - accuracy500: 0.3990 - val_loss: 3.2335 - val_accuracy500: 0.4061 - 24s/epoch - 23ms/step
Epoch 4/50
1060/1060 - 24s - loss: 3.2330 - accuracy500: 0.4038 - val_loss: 3.2298 - val_accuracy500: 0.4088 - 24s/epoch - 22ms/step
Epoch 5/50
1060/1060 - 24s - loss: 3.2251 - accuracy500: 0.4096 - val_loss: 3.2246 - val_accuracy500: 0.4119 - 24s/epoch - 22ms/step
Epoch 6/50
1060/1060 - 24s - loss: 3.2188 - accuracy500: 0.4126 - val_loss: 3.2223 - val_accuracy500: 0.4137 - 24s/epoch - 23ms/step
Epoch 7/50
1060/1060 - 24s - loss: 3.2124 - accuracy500: 0.4163 - val_loss: 3.2204 - val_accuracy500: 0.4147 - 24s/epoch - 22ms/step
Epoch 8/50
1060/1060 - 23s - loss: 3.2060 - accuracy500: 0.4199 - val_loss: 3.2210 - val_accuracy500: 0.4141 - 23s/epoch - 22ms/step
Epoch 9/50
1060/1060 - 23s - loss: 3.2012 - accuracy500: 0.4225 - val_loss: 3.2216 - val_accuracy500: 0.4145 - 23s/epoch - 22ms/step
Epoch 10/50
1060/1060 - 24s - loss: 3.1955 - accuracy500: 0.4251 - val_loss: 3.2200 - val_accuracy500: 0.4149 - 24s/epoch - 22ms/step
Epoch 11/50
1060/1060 - 23s - loss: 3.1908 - accuracy500: 0.4268 - val_loss: 3.2216 - val_accuracy500: 0.4134 - 23s/epoch - 22ms/step
Epoch 12/50
1060/1060 - 23s - loss: 3.1849 - accuracy500: 0.4304 - val_loss: 3.2239 - val_accuracy500: 0.4134 - 23s/epoch - 22ms/step
Epoch 13/50
1060/1060 - 24s - loss: 3.1780 - accuracy500: 0.4335 - val_loss: 3.2243 - val_accuracy500: 0.4132 - 24s/epoch - 22ms/step
Epoch 14/50
1060/1060 - 23s - loss: 3.1733 - accuracy500: 0.4355 - val_loss: 3.2267 - val_accuracy500: 0.4132 - 23s/epoch - 22ms/step
Epoch 15/50
1060/1060 - 23s - loss: 3.1651 - accuracy500: 0.4387 - val_loss: 3.2326 - val_accuracy500: 0.4113 - 23s/epoch - 22ms/step
Epoch 16/50
1060/1060 - 23s - loss: 3.1617 - accuracy500: 0.4413 - val_loss: 3.2343 - val_accuracy500: 0.4100 - 23s/epoch - 22ms/step
Epoch 17/50
1060/1060 - 23s - loss: 3.1548 - accuracy500: 0.4435 - val_loss: 3.2372 - val_accuracy500: 0.4067 - 23s/epoch - 22ms/step
Epoch 18/50
1060/1060 - 23s - loss: 3.1492 - accuracy500: 0.4459 - val_loss: 3.2390 - val_accuracy500: 0.4088 - 23s/epoch - 22ms/step
Epoch 19/50
1060/1060 - 23s - loss: 3.1407 - accuracy500: 0.4486 - val_loss: 3.2429 - val_accuracy500: 0.4068 - 23s/epoch - 22ms/step
Epoch 20/50
1060/1060 - 23s - loss: 3.1305 - accuracy500: 0.4522 - val_loss: 3.2422 - val_accuracy500: 0.4063 - 23s/epoch - 22ms/step
testing model: results/EXC/W10/deepOF_L2/h500
Evaluating performance on  test set...
5267/5267 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0883099
{'0': {'precision': 0.39787018031737625, 'recall': 0.4066110296605391, 'f1-score': 0.40219311945027, 'support': 443350}, '1': {'precision': 0.4084831802094877, 'recall': 0.10133873735649258, 'f1-score': 0.16239070266506073, 'support': 451022}, '2': {'precision': 0.3818580647138286, 'recall': 0.6590217975725631, 'f1-score': 0.483538585658691, 'support': 453812}, 'accuracy': 0.38944906629955556, 'macro avg': {'precision': 0.39607047508023085, 'recall': 0.38899052152986496, 'f1-score': 0.349374135924674, 'support': 1348184}, 'weighted avg': {'precision': 0.39603082176621607, 'recall': 0.38944906629955556, 'f1-score': 0.34935120995399743, 'support': 1348184}}
[[180271  33903 229176]
 [150362  45706 254954]
 [122457  32283 299072]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0689068
{'0': {'precision': 0.42015210912748774, 'recall': 0.499524975131051, 'f1-score': 0.4564133986928105, 'support': 89469}, '1': {'precision': 0.4711377504184891, 'recall': 0.09718200044553353, 'f1-score': 0.1611279882547392, 'support': 89780}, '2': {'precision': 0.4099417921460389, 'recall': 0.6521252431721605, 'f1-score': 0.5034209367200118, 'support': 92013}, 'accuracy': 0.4181234378571271, 'macro avg': {'precision': 0.4337438838973386, 'recall': 0.4162774062495817, 'f1-score': 0.3736541078891871, 'support': 271262}, 'weighted avg': {'precision': 0.43356353047914054, 'recall': 0.4181234378571271, 'f1-score': 0.374627451701956, 'support': 271262}}
[[44692  4891 39886]
 [34573  8725 46482]
 [27106  4903 60004]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0730422
{'0': {'precision': 0.39518059882089435, 'recall': 0.4666504529701465, 'f1-score': 0.42795210282002316, 'support': 32894}, '1': {'precision': 0.44426541672769887, 'recall': 0.09128118698648689, 'f1-score': 0.15144554850951217, 'support': 33227}, '2': {'precision': 0.42446653734238604, 'recall': 0.657288453801797, 'f1-score': 0.5158228181138906, 'support': 37285}, 'accuracy': 0.4147728371661219, 'macro avg': {'precision': 0.42130418429699307, 'recall': 0.40507336458614346, 'f1-score': 0.36507348981447535, 'support': 103406}, 'weighted avg': {'precision': 0.42151241189134686, 'recall': 0.4147728371661219, 'f1-score': 0.37078691259563096, 'support': 103406}}
[[15350  1868 15676]
 [12641  3033 17553]
 [10852  1926 24507]]
training model: results/EXC/W10/deepOF_L2/h1000
Epoch 1/50
1060/1060 - 26s - loss: 3.2678 - accuracy1000: 0.3930 - val_loss: 3.2727 - val_accuracy1000: 0.4403 - 26s/epoch - 25ms/step
Epoch 2/50
1060/1060 - 24s - loss: 3.2522 - accuracy1000: 0.4017 - val_loss: 3.2349 - val_accuracy1000: 0.4418 - 24s/epoch - 22ms/step
Epoch 3/50
1060/1060 - 24s - loss: 3.2501 - accuracy1000: 0.4035 - val_loss: 3.2100 - val_accuracy1000: 0.4413 - 24s/epoch - 22ms/step
Epoch 4/50
1060/1060 - 23s - loss: 3.2485 - accuracy1000: 0.4017 - val_loss: 3.2192 - val_accuracy1000: 0.4424 - 23s/epoch - 22ms/step
Epoch 5/50
1060/1060 - 24s - loss: 3.2497 - accuracy1000: 0.3993 - val_loss: 3.2102 - val_accuracy1000: 0.4424 - 24s/epoch - 22ms/step
Epoch 6/50
1060/1060 - 24s - loss: 3.2507 - accuracy1000: 0.3967 - val_loss: 3.2230 - val_accuracy1000: 0.4422 - 24s/epoch - 22ms/step
Epoch 7/50
1060/1060 - 23s - loss: 3.2484 - accuracy1000: 0.3982 - val_loss: 3.2192 - val_accuracy1000: 0.4427 - 23s/epoch - 22ms/step
Epoch 8/50
1060/1060 - 24s - loss: 3.2454 - accuracy1000: 0.4007 - val_loss: 3.2359 - val_accuracy1000: 0.4424 - 24s/epoch - 22ms/step
Epoch 9/50
1060/1060 - 24s - loss: 3.2417 - accuracy1000: 0.4037 - val_loss: 3.2360 - val_accuracy1000: 0.4424 - 24s/epoch - 22ms/step
Epoch 10/50
1060/1060 - 23s - loss: 3.2377 - accuracy1000: 0.4055 - val_loss: 3.2694 - val_accuracy1000: 0.4422 - 23s/epoch - 22ms/step
Epoch 11/50
1060/1060 - 23s - loss: 3.2323 - accuracy1000: 0.4087 - val_loss: 3.2787 - val_accuracy1000: 0.4428 - 23s/epoch - 22ms/step
Epoch 12/50
1060/1060 - 24s - loss: 3.2261 - accuracy1000: 0.4125 - val_loss: 3.2930 - val_accuracy1000: 0.4424 - 24s/epoch - 22ms/step
Epoch 13/50
1060/1060 - 23s - loss: 3.2212 - accuracy1000: 0.4163 - val_loss: 3.3004 - val_accuracy1000: 0.4424 - 23s/epoch - 22ms/step
testing model: results/EXC/W10/deepOF_L2/h1000
Evaluating performance on  test set...
5267/5267 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0853877
{'0': {'precision': 0.3402069530261297, 'recall': 0.02368262177505655, 'f1-score': 0.044282623915039385, 'support': 385937}, '1': {'precision': 0.42537250806556887, 'recall': 0.9607931579769488, 'f1-score': 0.5896769850139358, 'support': 569773}, '2': {'precision': 0.3444392713728685, 'recall': 0.030159959640638615, 'f1-score': 0.05546340549151907, 'support': 392474}, 'accuracy': 0.42161233184787833, 'macro avg': {'precision': 0.3700062441548557, 'recall': 0.33821191313088134, 'f1-score': 0.2298076714734981, 'support': 1348184}, 'weighted avg': {'precision': 0.3774319228390813, 'recall': 0.42161233184787833, 'f1-score': 0.2780334675497724, 'support': 1348184}}
[[  9140 366423  10374]
 [ 10184 547434  12155]
 [  7542 373095  11837]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1442592
{'0': {'precision': 0.37897683889030287, 'recall': 0.01668534289556253, 'f1-score': 0.031963421309663086, 'support': 89240}, '1': {'precision': 0.3308590294933968, 'recall': 0.9693392011437763, 'f1-score': 0.4933318932193369, 'support': 89528}, '2': {'precision': 0.4200913242009132, 'recall': 0.02287715959954159, 'f1-score': 0.04339133198675293, 'support': 92494}, 'accuracy': 0.33321290855335434, 'macro avg': {'precision': 0.3766423975282043, 'recall': 0.33630056787962676, 'f1-score': 0.18956221550525099, 'support': 271262}, 'weighted avg': {'precision': 0.37711499301669504, 'recall': 0.33321290855335434, 'f1-score': 0.18813129489054067, 'support': 271262}}
[[ 1489 86263  1488]
 [ 1312 86783  1433]
 [ 1128 89250  2116]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0714066
{'0': {'precision': 0.3018736988202637, 'recall': 0.01647540052266788, 'f1-score': 0.03124551070248528, 'support': 26403}, '1': {'precision': 0.44534630955467364, 'recall': 0.9729011458197185, 'f1-score': 0.6110047061398708, 'support': 45906}, '2': {'precision': 0.35318642048838594, 'recall': 0.019069363604206194, 'f1-score': 0.03618501342445692, 'support': 31097}, 'accuracy': 0.44185056959944297, 'macro avg': {'precision': 0.3668021429544411, 'recall': 0.3361486366488642, 'f1-score': 0.22614507675560433, 'support': 103406}, 'weighted avg': {'precision': 0.38099797955917075, 'recall': 0.44185056959944297, 'f1-score': 0.2901089165193022, 'support': 103406}}
[[  435 25534   434]
 [  592 44662   652]
 [  414 30090   593]]
training model: results/EXC/W10/deepVOL_L2/h10
Epoch 1/50
1060/1060 - 26s - loss: 2.4372 - accuracy10: 0.5642 - val_loss: 2.1524 - val_accuracy10: 0.6136 - 26s/epoch - 25ms/step
Epoch 2/50
1060/1060 - 23s - loss: 2.1659 - accuracy10: 0.6465 - val_loss: 2.0769 - val_accuracy10: 0.6698 - 23s/epoch - 22ms/step
Epoch 3/50
1060/1060 - 22s - loss: 2.1032 - accuracy10: 0.6635 - val_loss: 2.0347 - val_accuracy10: 0.6939 - 22s/epoch - 21ms/step
Epoch 4/50
1060/1060 - 23s - loss: 2.0673 - accuracy10: 0.6744 - val_loss: 2.0492 - val_accuracy10: 0.7097 - 23s/epoch - 22ms/step
Epoch 5/50
1060/1060 - 25s - loss: 2.0472 - accuracy10: 0.6779 - val_loss: 2.0423 - val_accuracy10: 0.7091 - 25s/epoch - 23ms/step
Epoch 6/50
1060/1060 - 24s - loss: 2.0319 - accuracy10: 0.6802 - val_loss: 2.0415 - val_accuracy10: 0.7220 - 24s/epoch - 22ms/step
Epoch 7/50
1060/1060 - 23s - loss: 2.0179 - accuracy10: 0.6822 - val_loss: 2.0393 - val_accuracy10: 0.7305 - 23s/epoch - 21ms/step
Epoch 8/50
1060/1060 - 24s - loss: 2.0045 - accuracy10: 0.6829 - val_loss: 2.0277 - val_accuracy10: 0.7222 - 24s/epoch - 23ms/step
Epoch 9/50
1060/1060 - 25s - loss: 1.9942 - accuracy10: 0.6831 - val_loss: 2.0306 - val_accuracy10: 0.7353 - 25s/epoch - 24ms/step
Epoch 10/50
1060/1060 - 23s - loss: 1.9829 - accuracy10: 0.6866 - val_loss: 2.0137 - val_accuracy10: 0.7212 - 23s/epoch - 22ms/step
Epoch 11/50
1060/1060 - 23s - loss: 1.9757 - accuracy10: 0.6864 - val_loss: 2.0164 - val_accuracy10: 0.7167 - 23s/epoch - 22ms/step
Epoch 12/50
1060/1060 - 24s - loss: 1.9664 - accuracy10: 0.6873 - val_loss: 2.0111 - val_accuracy10: 0.7107 - 24s/epoch - 23ms/step
Epoch 13/50
1060/1060 - 24s - loss: 1.9607 - accuracy10: 0.6863 - val_loss: 2.0405 - val_accuracy10: 0.7231 - 24s/epoch - 22ms/step
Epoch 14/50
1060/1060 - 22s - loss: 1.9525 - accuracy10: 0.6864 - val_loss: 2.0299 - val_accuracy10: 0.7293 - 22s/epoch - 21ms/step
Epoch 15/50
1060/1060 - 23s - loss: 1.9444 - accuracy10: 0.6869 - val_loss: 2.0629 - val_accuracy10: 0.7390 - 23s/epoch - 21ms/step
Epoch 16/50
1060/1060 - 23s - loss: 1.9367 - accuracy10: 0.6867 - val_loss: 2.0758 - val_accuracy10: 0.7474 - 23s/epoch - 22ms/step
Epoch 17/50
1060/1060 - 23s - loss: 1.9275 - accuracy10: 0.6874 - val_loss: 2.0389 - val_accuracy10: 0.7217 - 23s/epoch - 22ms/step
Epoch 18/50
1060/1060 - 24s - loss: 1.9208 - accuracy10: 0.6875 - val_loss: 2.0274 - val_accuracy10: 0.7227 - 24s/epoch - 23ms/step
Epoch 19/50
1060/1060 - 24s - loss: 1.9128 - accuracy10: 0.6857 - val_loss: 2.0547 - val_accuracy10: 0.7473 - 24s/epoch - 23ms/step
Epoch 20/50
1060/1060 - 25s - loss: 1.9030 - accuracy10: 0.6858 - val_loss: 2.0638 - val_accuracy10: 0.7238 - 25s/epoch - 24ms/step
Epoch 21/50
1060/1060 - 24s - loss: 1.9015 - accuracy10: 0.6850 - val_loss: 2.0667 - val_accuracy10: 0.7391 - 24s/epoch - 23ms/step
Epoch 22/50
1060/1060 - 23s - loss: 1.8953 - accuracy10: 0.6833 - val_loss: 2.0659 - val_accuracy10: 0.7347 - 23s/epoch - 22ms/step
testing model: results/EXC/W10/deepVOL_L2/h10
Evaluating performance on  test set...
5267/5267 - 49s - 49s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73495924
{'0': {'precision': 0.3625989216355345, 'recall': 0.5299596398633964, 'f1-score': 0.430588652025504, 'support': 151387}, '1': {'precision': 0.9081551890922578, 'recall': 0.6808495594162242, 'f1-score': 0.7782444463497095, 'support': 1046566}, '2': {'precision': 0.302613705081052, 'recall': 0.6895018504220027, 'f1-score': 0.42062178837755587, 'support': 150236}, 'accuracy': 0.6648704298877977, 'macro avg': {'precision': 0.524455938602948, 'recall': 0.6334370165672077, 'f1-score': 0.5431516289175898, 'support': 1348189}, 'weighted avg': {'precision': 0.7794163720173681, 'recall': 0.6648704298877977, 'f1-score': 0.6993546427847324, 'support': 1348189}}
[[ 80229  40430  30728]
 [126017 712554 207995]
 [ 15015  31633 103588]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6468727
{'0': {'precision': 0.3111488573193329, 'recall': 0.64119465405946, 'f1-score': 0.4189811376800832, 'support': 21998}, '1': {'precision': 0.9474930136954665, 'recall': 0.7234963715401775, 'f1-score': 0.8204812831550896, 'support': 226818}, '2': {'precision': 0.2994974874371859, 'recall': 0.7036129549605737, 'f1-score': 0.4201537602085605, 'support': 22447}, 'accuracy': 0.7151767841541234, 'macro avg': {'precision': 0.5193797861506617, 'recall': 0.6894346601867372, 'f1-score': 0.5532053936812444, 'support': 271263}, 'weighted avg': {'precision': 0.8422672574003514, 'recall': 0.7151767841541234, 'f1-score': 0.7547946539143163, 'support': 271263}}
[[ 14105   4644   3249]
 [ 29024 164102  33692]
 [  2203   4450  15794]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65510994
{'0': {'precision': 0.32109564551142894, 'recall': 0.6290968226169628, 'f1-score': 0.42517754480892794, 'support': 7994}, '1': {'precision': 0.9497696131926762, 'recall': 0.7171616595135909, 'f1-score': 0.8172362749509297, 'support': 87375}, '2': {'precision': 0.2613009922822492, 'recall': 0.7077267637178052, 'f1-score': 0.38168092601912434, 'support': 8037}, 'accuracy': 0.70962033150881, 'macro avg': {'precision': 0.5107220836621181, 'recall': 0.6846617486161196, 'f1-score': 0.5413649152596606, 'support': 103406}, 'weighted avg': {'precision': 0.847659077982911, 'recall': 0.70962033150881, 'f1-score': 0.7530748546453373, 'support': 103406}}
[[ 5029  1776  1189]
 [ 9822 62662 14891]
 [  811  1538  5688]]
training model: results/EXC/W10/deepVOL_L2/h20
Epoch 1/50
1060/1060 - 26s - loss: 2.4991 - accuracy20: 0.5524 - val_loss: 2.2343 - val_accuracy20: 0.6284 - 26s/epoch - 24ms/step
Epoch 2/50
1060/1060 - 24s - loss: 2.2519 - accuracy20: 0.6261 - val_loss: 2.1877 - val_accuracy20: 0.6282 - 24s/epoch - 23ms/step
Epoch 3/50
1060/1060 - 23s - loss: 2.1920 - accuracy20: 0.6406 - val_loss: 2.1666 - val_accuracy20: 0.6812 - 23s/epoch - 22ms/step
Epoch 4/50
1060/1060 - 23s - loss: 2.1564 - accuracy20: 0.6496 - val_loss: 2.1544 - val_accuracy20: 0.6848 - 23s/epoch - 22ms/step
Epoch 5/50
1060/1060 - 22s - loss: 2.1384 - accuracy20: 0.6516 - val_loss: 2.1369 - val_accuracy20: 0.6879 - 22s/epoch - 21ms/step
Epoch 6/50
1060/1060 - 23s - loss: 2.1233 - accuracy20: 0.6545 - val_loss: 2.1283 - val_accuracy20: 0.6868 - 23s/epoch - 22ms/step
Epoch 7/50
1060/1060 - 23s - loss: 2.1120 - accuracy20: 0.6557 - val_loss: 2.1235 - val_accuracy20: 0.6995 - 23s/epoch - 22ms/step
Epoch 8/50
1060/1060 - 25s - loss: 2.1010 - accuracy20: 0.6551 - val_loss: 2.1163 - val_accuracy20: 0.7032 - 25s/epoch - 24ms/step
Epoch 9/50
1060/1060 - 22s - loss: 2.0912 - accuracy20: 0.6576 - val_loss: 2.1210 - val_accuracy20: 0.7040 - 22s/epoch - 21ms/step
Epoch 10/50
1060/1060 - 23s - loss: 2.0835 - accuracy20: 0.6566 - val_loss: 2.1189 - val_accuracy20: 0.7016 - 23s/epoch - 22ms/step
Epoch 11/50
1060/1060 - 23s - loss: 2.0752 - accuracy20: 0.6599 - val_loss: 2.1093 - val_accuracy20: 0.7014 - 23s/epoch - 21ms/step
Epoch 12/50
1060/1060 - 23s - loss: 2.0671 - accuracy20: 0.6578 - val_loss: 2.1107 - val_accuracy20: 0.7094 - 23s/epoch - 22ms/step
Epoch 13/50
1060/1060 - 23s - loss: 2.0569 - accuracy20: 0.6591 - val_loss: 2.1101 - val_accuracy20: 0.6983 - 23s/epoch - 22ms/step
Epoch 14/50
1060/1060 - 23s - loss: 2.0464 - accuracy20: 0.6596 - val_loss: 2.1023 - val_accuracy20: 0.6937 - 23s/epoch - 22ms/step
Epoch 15/50
1060/1060 - 25s - loss: 2.0391 - accuracy20: 0.6602 - val_loss: 2.0975 - val_accuracy20: 0.6992 - 25s/epoch - 23ms/step
Epoch 16/50
1060/1060 - 25s - loss: 2.0312 - accuracy20: 0.6592 - val_loss: 2.1055 - val_accuracy20: 0.7020 - 25s/epoch - 24ms/step
Epoch 17/50
1060/1060 - 23s - loss: 2.0217 - accuracy20: 0.6597 - val_loss: 2.0992 - val_accuracy20: 0.6981 - 23s/epoch - 22ms/step
Epoch 18/50
1060/1060 - 23s - loss: 2.0149 - accuracy20: 0.6613 - val_loss: 2.0997 - val_accuracy20: 0.7059 - 23s/epoch - 22ms/step
Epoch 19/50
1060/1060 - 24s - loss: 2.0110 - accuracy20: 0.6612 - val_loss: 2.0979 - val_accuracy20: 0.7101 - 24s/epoch - 23ms/step
Epoch 20/50
1060/1060 - 22s - loss: 2.0025 - accuracy20: 0.6606 - val_loss: 2.1118 - val_accuracy20: 0.7094 - 22s/epoch - 21ms/step
Epoch 21/50
1060/1060 - 24s - loss: 1.9956 - accuracy20: 0.6608 - val_loss: 2.1161 - val_accuracy20: 0.7076 - 24s/epoch - 22ms/step
Epoch 22/50
1060/1060 - 23s - loss: 1.9882 - accuracy20: 0.6610 - val_loss: 2.1045 - val_accuracy20: 0.7101 - 23s/epoch - 22ms/step
Epoch 23/50
1060/1060 - 25s - loss: 1.9815 - accuracy20: 0.6619 - val_loss: 2.1041 - val_accuracy20: 0.7016 - 25s/epoch - 23ms/step
Epoch 24/50
1060/1060 - 24s - loss: 1.9783 - accuracy20: 0.6614 - val_loss: 2.1008 - val_accuracy20: 0.7062 - 24s/epoch - 22ms/step
Epoch 25/50
1060/1060 - 22s - loss: 1.9728 - accuracy20: 0.6621 - val_loss: 2.1249 - val_accuracy20: 0.7192 - 22s/epoch - 21ms/step
testing model: results/EXC/W10/deepVOL_L2/h20
Evaluating performance on  test set...
5267/5267 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.75298184
{'0': {'precision': 0.43493368131975146, 'recall': 0.551059387909208, 'f1-score': 0.4861581601107695, 'support': 202617}, '1': {'precision': 0.8478532103344295, 'recall': 0.6845253369243657, 'f1-score': 0.7574851599231684, 'support': 943090}, '2': {'precision': 0.37798205163940884, 'recall': 0.6161337797927717, 'f1-score': 0.4685319412626282, 'support': 202482}, 'accuracy': 0.6541953687502271, 'macro avg': {'precision': 0.5535896477645299, 'recall': 0.6172395015421152, 'f1-score': 0.5707250870988555, 'support': 1348189}, 'weighted avg': {'precision': 0.7152271703910298, 'recall': 0.6541953687502271, 'f1-score': 0.6733105461695981, 'support': 1348189}}
[[111654  62186  28777]
 [120996 645569 176525]
 [ 24065  53661 124756]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6589378
{'0': {'precision': 0.3901569043945254, 'recall': 0.6343672618271863, 'f1-score': 0.4831565233575284, 'support': 30692}, '1': {'precision': 0.9074718107317777, 'recall': 0.7205270424567287, 'f1-score': 0.8032658974160957, 'support': 209319}, '2': {'precision': 0.3760197237228527, 'recall': 0.6637015231025214, 'f1-score': 0.48006110121045203, 'support': 31252}, 'accuracy': 0.704231686591979, 'macro avg': {'precision': 0.5578828129497185, 'recall': 0.6728652757954787, 'f1-score': 0.5888278406613587, 'support': 271263}, 'weighted avg': {'precision': 0.7877121320122109, 'recall': 0.704231686591979, 'f1-score': 0.7298110097254622, 'support': 271263}}
[[ 19470   7998   3224]
 [ 27303 150820  31196]
 [  3130   7380  20742]]
Evaluating performance on  val set...
404/404 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.66942334
{'0': {'precision': 0.4016271341812765, 'recall': 0.6291509603302818, 'f1-score': 0.4902783606098755, 'support': 11142}, '1': {'precision': 0.9119301222232695, 'recall': 0.715793627305909, 'f1-score': 0.8020449050086355, 'support': 81096}, '2': {'precision': 0.3302089873531258, 'recall': 0.6592944126074498, 'f1-score': 0.440028685830395, 'support': 11168}, 'accuracy': 0.7003558787691236, 'macro avg': {'precision': 0.5479220812525573, 'recall': 0.6680796667478802, 'f1-score': 0.5774506504829686, 'support': 103406}, 'weighted avg': {'precision': 0.7941182203317579, 'recall': 0.7003558787691236, 'f1-score': 0.7293537654860394, 'support': 103406}}
[[ 7010  2976  1156]
 [ 9269 58048 13779]
 [ 1175  2630  7363]]
training model: results/EXC/W10/deepVOL_L2/h30
Epoch 1/50
1060/1060 - 25s - loss: 2.5795 - accuracy30: 0.5369 - val_loss: 2.3665 - val_accuracy30: 0.5673 - 25s/epoch - 24ms/step
Epoch 2/50
1060/1060 - 24s - loss: 2.3582 - accuracy30: 0.6042 - val_loss: 2.3372 - val_accuracy30: 0.5952 - 24s/epoch - 22ms/step
Epoch 3/50
1060/1060 - 23s - loss: 2.3010 - accuracy30: 0.6167 - val_loss: 2.2943 - val_accuracy30: 0.6192 - 23s/epoch - 21ms/step
Epoch 4/50
1060/1060 - 25s - loss: 2.2633 - accuracy30: 0.6243 - val_loss: 2.2874 - val_accuracy30: 0.6245 - 25s/epoch - 24ms/step
Epoch 5/50
1060/1060 - 23s - loss: 2.2432 - accuracy30: 0.6283 - val_loss: 2.2635 - val_accuracy30: 0.6356 - 23s/epoch - 21ms/step
Epoch 6/50
1060/1060 - 23s - loss: 2.2292 - accuracy30: 0.6299 - val_loss: 2.2811 - val_accuracy30: 0.6191 - 23s/epoch - 22ms/step
Epoch 7/50
1060/1060 - 23s - loss: 2.2176 - accuracy30: 0.6323 - val_loss: 2.2673 - val_accuracy30: 0.6393 - 23s/epoch - 22ms/step
Epoch 8/50
1060/1060 - 22s - loss: 2.2058 - accuracy30: 0.6326 - val_loss: 2.2984 - val_accuracy30: 0.6486 - 22s/epoch - 21ms/step
Epoch 9/50
1060/1060 - 25s - loss: 2.1991 - accuracy30: 0.6330 - val_loss: 2.2828 - val_accuracy30: 0.6379 - 25s/epoch - 23ms/step
Epoch 10/50
1060/1060 - 25s - loss: 2.1916 - accuracy30: 0.6330 - val_loss: 2.2811 - val_accuracy30: 0.6412 - 25s/epoch - 23ms/step
Epoch 11/50
1060/1060 - 24s - loss: 2.1807 - accuracy30: 0.6344 - val_loss: 2.2819 - val_accuracy30: 0.6557 - 24s/epoch - 22ms/step
Epoch 12/50
1060/1060 - 24s - loss: 2.1703 - accuracy30: 0.6357 - val_loss: 2.2830 - val_accuracy30: 0.6403 - 24s/epoch - 23ms/step
Epoch 13/50
1060/1060 - 23s - loss: 2.1618 - accuracy30: 0.6353 - val_loss: 2.2742 - val_accuracy30: 0.6325 - 23s/epoch - 21ms/step
Epoch 14/50
1060/1060 - 23s - loss: 2.1520 - accuracy30: 0.6350 - val_loss: 2.2783 - val_accuracy30: 0.6345 - 23s/epoch - 22ms/step
Epoch 15/50
1060/1060 - 24s - loss: 2.1462 - accuracy30: 0.6349 - val_loss: 2.2903 - val_accuracy30: 0.6425 - 24s/epoch - 22ms/step
testing model: results/EXC/W10/deepVOL_L2/h30
Evaluating performance on  test set...
5267/5267 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84101003
{'0': {'precision': 0.44914961597318903, 'recall': 0.5105843171121736, 'f1-score': 0.47790068069306935, 'support': 242009}, '1': {'precision': 0.7921440709238599, 'recall': 0.6045302042590178, 'f1-score': 0.6857361455096149, 'support': 862875}, '2': {'precision': 0.38116453473366313, 'recall': 0.6494687737613284, 'f1-score': 0.48039290198427054, 'support': 243305}, 'accuracy': 0.5957762598567412, 'macro avg': {'precision': 0.5408194072102374, 'recall': 0.58819443171084, 'f1-score': 0.5480099093956516, 'support': 1348189}, 'weighted avg': {'precision': 0.6564055942704287, 'recall': 0.5957762598567412, 'f1-score': 0.6113703919908418, 'support': 1348189}}
[[123566  76543  41900]
 [126591 521634 214650]
 [ 24954  60332 158019]]
Evaluating performance on  train set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74964285
{'0': {'precision': 0.40696204817101794, 'recall': 0.5997392438070405, 'f1-score': 0.48489281373361015, 'support': 37583}, '1': {'precision': 0.8659991507663649, 'recall': 0.6470046460222272, 'f1-score': 0.740653097085957, 'support': 195436}, '2': {'precision': 0.37479066172365916, 'recall': 0.6846564166928145, 'f1-score': 0.48440896519189314, 'support': 38244}, 'accuracy': 0.6457644426257912, 'macro avg': {'precision': 0.5492506202203473, 'recall': 0.6438001021740273, 'f1-score': 0.5699849586704868, 'support': 271263}, 'weighted avg': {'precision': 0.7331473837292454, 'recall': 0.6457644426257912, 'f1-score': 0.6690914048928166, 'support': 271263}}
[[ 22540  10710   4333]
 [ 29642 126448  39346]
 [  3204   8856  26184]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76167214
{'0': {'precision': 0.41840497260851245, 'recall': 0.5840011763840894, 'f1-score': 0.48752493478594444, 'support': 13601}, '1': {'precision': 0.871393537218696, 'recall': 0.6353488739005246, 'f1-score': 0.7348819526289778, 'support': 76059}, '2': {'precision': 0.32921356072636887, 'recall': 0.6937290848246763, 'f1-score': 0.44652556658550296, 'support': 13746}, 'accuracy': 0.636355724039224, 'macro avg': {'precision': 0.5396706901845257, 'recall': 0.6376930450364302, 'f1-score': 0.5563108180001418, 'support': 103406}, 'weighted avg': {'precision': 0.7397386678288479, 'recall': 0.636355724039224, 'f1-score': 0.6640151781455175, 'support': 103406}}
[[ 7943  4092  1566]
 [ 9871 48324 17864]
 [ 1170  3040  9536]]
training model: results/EXC/W10/deepVOL_L2/h50
Epoch 1/50
1060/1060 - 25s - loss: 2.7354 - accuracy50: 0.5100 - val_loss: 2.6337 - val_accuracy50: 0.5389 - 25s/epoch - 24ms/step
Epoch 2/50
1060/1060 - 22s - loss: 2.5558 - accuracy50: 0.5661 - val_loss: 2.5562 - val_accuracy50: 0.5435 - 22s/epoch - 21ms/step
Epoch 3/50
1060/1060 - 26s - loss: 2.4954 - accuracy50: 0.5804 - val_loss: 2.5263 - val_accuracy50: 0.5675 - 26s/epoch - 25ms/step
Epoch 4/50
1060/1060 - 23s - loss: 2.4641 - accuracy50: 0.5852 - val_loss: 2.5280 - val_accuracy50: 0.5842 - 23s/epoch - 22ms/step
Epoch 5/50
1060/1060 - 22s - loss: 2.4460 - accuracy50: 0.5923 - val_loss: 2.5402 - val_accuracy50: 0.5848 - 22s/epoch - 21ms/step
Epoch 6/50
1060/1060 - 24s - loss: 2.4299 - accuracy50: 0.5925 - val_loss: 2.5410 - val_accuracy50: 0.5791 - 24s/epoch - 23ms/step
Epoch 7/50
1060/1060 - 25s - loss: 2.4176 - accuracy50: 0.5947 - val_loss: 2.5674 - val_accuracy50: 0.5825 - 25s/epoch - 24ms/step
Epoch 8/50
1060/1060 - 23s - loss: 2.4082 - accuracy50: 0.5965 - val_loss: 2.5497 - val_accuracy50: 0.5897 - 23s/epoch - 22ms/step
Epoch 9/50
1060/1060 - 23s - loss: 2.3981 - accuracy50: 0.5973 - val_loss: 2.5401 - val_accuracy50: 0.6066 - 23s/epoch - 22ms/step
Epoch 10/50
1060/1060 - 25s - loss: 2.3901 - accuracy50: 0.5990 - val_loss: 2.5510 - val_accuracy50: 0.6014 - 25s/epoch - 24ms/step
Epoch 11/50
1060/1060 - 23s - loss: 2.3785 - accuracy50: 0.6005 - val_loss: 2.5514 - val_accuracy50: 0.5924 - 23s/epoch - 22ms/step
Epoch 12/50
1060/1060 - 24s - loss: 2.3763 - accuracy50: 0.6010 - val_loss: 2.5447 - val_accuracy50: 0.5983 - 24s/epoch - 23ms/step
Epoch 13/50
1060/1060 - 24s - loss: 2.3675 - accuracy50: 0.6006 - val_loss: 2.5250 - val_accuracy50: 0.5958 - 24s/epoch - 22ms/step
Epoch 14/50
1060/1060 - 25s - loss: 2.3611 - accuracy50: 0.6002 - val_loss: 2.4932 - val_accuracy50: 0.6032 - 25s/epoch - 23ms/step
Epoch 15/50
1060/1060 - 22s - loss: 2.3488 - accuracy50: 0.6026 - val_loss: 2.5130 - val_accuracy50: 0.6038 - 22s/epoch - 21ms/step
Epoch 16/50
1060/1060 - 23s - loss: 2.3427 - accuracy50: 0.6030 - val_loss: 2.5037 - val_accuracy50: 0.6026 - 23s/epoch - 22ms/step
Epoch 17/50
1060/1060 - 25s - loss: 2.3361 - accuracy50: 0.6027 - val_loss: 2.4836 - val_accuracy50: 0.6046 - 25s/epoch - 24ms/step
Epoch 18/50
1060/1060 - 23s - loss: 2.3282 - accuracy50: 0.6046 - val_loss: 2.5012 - val_accuracy50: 0.6076 - 23s/epoch - 22ms/step
Epoch 19/50
1060/1060 - 22s - loss: 2.3237 - accuracy50: 0.6045 - val_loss: 2.5042 - val_accuracy50: 0.6093 - 22s/epoch - 21ms/step
Epoch 20/50
1060/1060 - 23s - loss: 2.3171 - accuracy50: 0.6067 - val_loss: 2.4922 - val_accuracy50: 0.5994 - 23s/epoch - 22ms/step
Epoch 21/50
1060/1060 - 23s - loss: 2.3115 - accuracy50: 0.6069 - val_loss: 2.5108 - val_accuracy50: 0.6027 - 23s/epoch - 22ms/step
Epoch 22/50
1060/1060 - 22s - loss: 2.3014 - accuracy50: 0.6078 - val_loss: 2.5050 - val_accuracy50: 0.6073 - 22s/epoch - 21ms/step
Epoch 23/50
1060/1060 - 23s - loss: 2.3032 - accuracy50: 0.6069 - val_loss: 2.4912 - val_accuracy50: 0.6188 - 23s/epoch - 22ms/step
Epoch 24/50
1060/1060 - 23s - loss: 2.2887 - accuracy50: 0.6092 - val_loss: 2.5234 - val_accuracy50: 0.6031 - 23s/epoch - 21ms/step
Epoch 25/50
1060/1060 - 24s - loss: 2.2846 - accuracy50: 0.6097 - val_loss: 2.5113 - val_accuracy50: 0.5982 - 24s/epoch - 23ms/step
Epoch 26/50
1060/1060 - 23s - loss: 2.2773 - accuracy50: 0.6113 - val_loss: 2.5184 - val_accuracy50: 0.6103 - 23s/epoch - 22ms/step
Epoch 27/50
1060/1060 - 22s - loss: 2.2709 - accuracy50: 0.6119 - val_loss: 2.5075 - val_accuracy50: 0.6058 - 22s/epoch - 21ms/step
testing model: results/EXC/W10/deepVOL_L2/h50
Evaluating performance on  test set...
5267/5267 - 51s - 51s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9067549
{'0': {'precision': 0.49782495837883317, 'recall': 0.4544043347255175, 'f1-score': 0.47512467986447954, 'support': 305994}, '1': {'precision': 0.6805930817463823, 'recall': 0.5986090527461051, 'f1-score': 0.6369738901841193, 'support': 733457}, '2': {'precision': 0.4405645395359374, 'recall': 0.604726337541864, 'f1-score': 0.5097547224159986, 'support': 308738}, 'accuracy': 0.5672802552164422, 'macro avg': {'precision': 0.539660859887051, 'recall': 0.5525799083378288, 'f1-score': 0.5406177641548658, 'support': 1348189}, 'weighted avg': {'precision': 0.5841437847956594, 'recall': 0.5672802552164422, 'f1-score': 0.5711060640255156, 'support': 1348189}}
[[139045 113712  53237]
 [110563 439054 183840]
 [ 29697  92339 186702]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.79426
{'0': {'precision': 0.47244883849557523, 'recall': 0.553219049161084, 'f1-score': 0.5096536614925651, 'support': 49409}, '1': {'precision': 0.7828949732958589, 'recall': 0.6343753458328237, 'f1-score': 0.7008532708716748, 'support': 171687}, '2': {'precision': 0.4396150222102571, 'recall': 0.6510056411585305, 'f1-score': 0.5248238347381023, 'support': 50167}, 'accuracy': 0.6226687753213671, 'macro avg': {'precision': 0.5649862780005638, 'recall': 0.6128666787174794, 'f1-score': 0.5784435890341141, 'support': 271263}, 'weighted avg': {'precision': 0.6628632757165407, 'recall': 0.6226687753213671, 'f1-score': 0.6334727205484632, 'support': 271263}}
[[ 27334  16356   5719]
 [ 26861 108914  35912]
 [  3661  13847  32659]]
Evaluating performance on  val set...
404/404 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8206354
{'0': {'precision': 0.4595472440944882, 'recall': 0.5244005166507553, 'f1-score': 0.48983659873580404, 'support': 17807}, '1': {'precision': 0.786986758121368, 'recall': 0.6130430265520875, 'f1-score': 0.6892092573125761, 'support': 67377}, '2': {'precision': 0.38720956831476094, 'recall': 0.6502579299747558, 'f1-score': 0.48538598611310246, 'support': 18222}, 'accuracy': 0.6043363054368218, 'macro avg': {'precision': 0.5445811901768723, 'recall': 0.5959004910591995, 'f1-score': 0.5548106140538275, 'support': 103406}, 'weighted avg': {'precision': 0.6601521897314037, 'recall': 0.6043363054368218, 'f1-score': 0.6189590147824193, 'support': 103406}}
[[ 9338  6269  2200]
 [ 9520 41305 16552]
 [ 1462  4911 11849]]
training model: results/EXC/W10/deepVOL_L2/h100
Epoch 1/50
1060/1060 - 26s - loss: 3.0028 - accuracy100: 0.4722 - val_loss: 2.9222 - val_accuracy100: 0.5024 - 26s/epoch - 24ms/step
Epoch 2/50
1060/1060 - 23s - loss: 2.8604 - accuracy100: 0.5124 - val_loss: 2.8950 - val_accuracy100: 0.5178 - 23s/epoch - 21ms/step
Epoch 3/50
1060/1060 - 23s - loss: 2.8174 - accuracy100: 0.5212 - val_loss: 2.8923 - val_accuracy100: 0.5299 - 23s/epoch - 21ms/step
Epoch 4/50
1060/1060 - 23s - loss: 2.7934 - accuracy100: 0.5261 - val_loss: 2.8871 - val_accuracy100: 0.5338 - 23s/epoch - 22ms/step
Epoch 5/50
1060/1060 - 24s - loss: 2.7775 - accuracy100: 0.5313 - val_loss: 2.8821 - val_accuracy100: 0.5370 - 24s/epoch - 23ms/step
Epoch 6/50
1060/1060 - 23s - loss: 2.7644 - accuracy100: 0.5343 - val_loss: 2.8843 - val_accuracy100: 0.5374 - 23s/epoch - 22ms/step
Epoch 7/50
1060/1060 - 23s - loss: 2.7542 - accuracy100: 0.5374 - val_loss: 2.9011 - val_accuracy100: 0.5336 - 23s/epoch - 21ms/step
Epoch 8/50
1060/1060 - 24s - loss: 2.7451 - accuracy100: 0.5391 - val_loss: 2.9028 - val_accuracy100: 0.5398 - 24s/epoch - 23ms/step
Epoch 9/50
1060/1060 - 23s - loss: 2.7359 - accuracy100: 0.5421 - val_loss: 2.9245 - val_accuracy100: 0.5348 - 23s/epoch - 22ms/step
Epoch 10/50
1060/1060 - 23s - loss: 2.7278 - accuracy100: 0.5448 - val_loss: 2.9292 - val_accuracy100: 0.5338 - 23s/epoch - 21ms/step
Epoch 11/50
1060/1060 - 23s - loss: 2.7220 - accuracy100: 0.5459 - val_loss: 2.9330 - val_accuracy100: 0.5319 - 23s/epoch - 21ms/step
Epoch 12/50
1060/1060 - 23s - loss: 2.7148 - accuracy100: 0.5471 - val_loss: 2.9379 - val_accuracy100: 0.5303 - 23s/epoch - 21ms/step
Epoch 13/50
1060/1060 - 25s - loss: 2.7077 - accuracy100: 0.5488 - val_loss: 2.9610 - val_accuracy100: 0.5227 - 25s/epoch - 23ms/step
Epoch 14/50
1060/1060 - 24s - loss: 2.7002 - accuracy100: 0.5508 - val_loss: 2.9743 - val_accuracy100: 0.5223 - 24s/epoch - 23ms/step
Epoch 15/50
1060/1060 - 24s - loss: 2.6939 - accuracy100: 0.5521 - val_loss: 2.9679 - val_accuracy100: 0.5231 - 24s/epoch - 23ms/step
testing model: results/EXC/W10/deepVOL_L2/h100
Evaluating performance on  test set...
5267/5267 - 50s - 50s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0186421
{'0': {'precision': 0.5435724167942755, 'recall': 0.3253569822559362, 'f1-score': 0.40706432849219726, 'support': 406953}, '1': {'precision': 0.4774548841938519, 'recall': 0.5871809534701969, 'f1-score': 0.5266634922887408, 'support': 524610}, '2': {'precision': 0.479797924833436, 'recall': 0.5290956397344381, 'f1-score': 0.5032423615304449, 'support': 416626}, 'accuracy': 0.49019907446211175, 'macro avg': {'precision': 0.5002750752738545, 'recall': 0.4805445251535237, 'f1-score': 0.47899006077046097, 'support': 1348189}, 'weighted avg': {'precision': 0.4981366282919328, 'recall': 0.49019907446211175, 'f1-score': 0.4833245460966263, 'support': 1348189}}
[[132405 182574  91974]
 [ 69545 308041 147024]
 [ 41633 154558 220435]]
Evaluating performance on  train set...
1060/1060 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9361709
{'0': {'precision': 0.5324132162275199, 'recall': 0.3936965811965812, 'f1-score': 0.4526661171184277, 'support': 71136}, '1': {'precision': 0.5761103369421517, 'recall': 0.6288357435921437, 'f1-score': 0.6013194747461187, 'support': 128202}, '2': {'precision': 0.4931661712775957, 'recall': 0.5397984011122697, 'f1-score': 0.5154297017610238, 'support': 71925}, 'accuracy': 0.5435647323814895, 'macro avg': {'precision': 0.5338965748157558, 'recall': 0.5207769086336649, 'f1-score': 0.5231384312085234, 'support': 271263}, 'weighted avg': {'precision': 0.5426586775024964, 'recall': 0.5435647323814895, 'f1-score': 0.5395630716607132, 'support': 271263}}
[[28006 32279 10851]
 [18534 80618 29050]
 [ 6062 27038 38825]]
Evaluating performance on  val set...
404/404 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.94465876
{'0': {'precision': 0.5275877537288326, 'recall': 0.3683303973380309, 'f1-score': 0.4338043753890131, 'support': 25545}, '1': {'precision': 0.5950771561109534, 'recall': 0.6137517575378847, 'f1-score': 0.6042702094729051, 'support': 51208}, '2': {'precision': 0.4497969899563452, 'recall': 0.5528083142610588, 'f1-score': 0.4960107725972058, 'support': 26653}, 'accuracy': 0.537415623851614, 'macro avg': {'precision': 0.5241539665987104, 'recall': 0.5116301563789915, 'f1-score': 0.511361785819708, 'support': 103406}, 'weighted avg': {'precision': 0.5409587388782005, 'recall': 0.537415623851614, 'f1-score': 0.534255041081119, 'support': 103406}}
[[ 9409 11660  4476]
 [ 6232 31429 13547]
 [ 2193  9726 14734]]
training model: results/EXC/W10/deepVOL_L2/h200
Epoch 1/50
1060/1060 - 26s - loss: 3.1920 - accuracy200: 0.4281 - val_loss: 3.1940 - val_accuracy200: 0.4219 - 26s/epoch - 24ms/step
Epoch 2/50
1060/1060 - 26s - loss: 3.1048 - accuracy200: 0.4553 - val_loss: 3.1514 - val_accuracy200: 0.4413 - 26s/epoch - 24ms/step
Epoch 3/50
1060/1060 - 23s - loss: 3.0647 - accuracy200: 0.4634 - val_loss: 3.1360 - val_accuracy200: 0.4483 - 23s/epoch - 21ms/step
Epoch 4/50
1060/1060 - 26s - loss: 3.0456 - accuracy200: 0.4678 - val_loss: 3.1268 - val_accuracy200: 0.4497 - 26s/epoch - 25ms/step
Epoch 5/50
1060/1060 - 23s - loss: 3.0337 - accuracy200: 0.4707 - val_loss: 3.1238 - val_accuracy200: 0.4479 - 23s/epoch - 22ms/step
Epoch 6/50
1060/1060 - 25s - loss: 3.0219 - accuracy200: 0.4739 - val_loss: 3.1350 - val_accuracy200: 0.4447 - 25s/epoch - 23ms/step
Epoch 7/50
1060/1060 - 26s - loss: 3.0132 - accuracy200: 0.4770 - val_loss: 3.1277 - val_accuracy200: 0.4463 - 26s/epoch - 25ms/step
Epoch 8/50
1060/1060 - 26s - loss: 3.0065 - accuracy200: 0.4778 - val_loss: 3.1276 - val_accuracy200: 0.4470 - 26s/epoch - 25ms/step
Epoch 9/50
1060/1060 - 26s - loss: 2.9993 - accuracy200: 0.4800 - val_loss: 3.1384 - val_accuracy200: 0.4431 - 26s/epoch - 24ms/step
Epoch 10/50
1060/1060 - 25s - loss: 2.9916 - accuracy200: 0.4818 - val_loss: 3.1381 - val_accuracy200: 0.4422 - 25s/epoch - 24ms/step
Epoch 11/50
1060/1060 - 23s - loss: 2.9841 - accuracy200: 0.4854 - val_loss: 3.1646 - val_accuracy200: 0.4385 - 23s/epoch - 21ms/step
Epoch 12/50
1060/1060 - 23s - loss: 2.9785 - accuracy200: 0.4861 - val_loss: 3.1868 - val_accuracy200: 0.4340 - 23s/epoch - 22ms/step
Epoch 13/50
1060/1060 - 25s - loss: 2.9701 - accuracy200: 0.4896 - val_loss: 3.1881 - val_accuracy200: 0.4318 - 25s/epoch - 24ms/step
Epoch 14/50
1060/1060 - 26s - loss: 2.9631 - accuracy200: 0.4916 - val_loss: 3.2183 - val_accuracy200: 0.4298 - 26s/epoch - 24ms/step
Epoch 15/50
1060/1060 - 23s - loss: 2.9561 - accuracy200: 0.4939 - val_loss: 3.2363 - val_accuracy200: 0.4319 - 23s/epoch - 22ms/step
testing model: results/EXC/W10/deepVOL_L2/h200
Evaluating performance on  test set...
5267/5267 - 51s - 51s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0637983
{'0': {'precision': 0.5157715231342581, 'recall': 0.31814362449247185, 'f1-score': 0.3935398517389302, 'support': 481993}, '1': {'precision': 0.3282266838097122, 'recall': 0.45322571834371245, 'f1-score': 0.3807289455872062, 'support': 366120}, '2': {'precision': 0.47704788467921316, 'recall': 0.5202189267231381, 'f1-score': 0.49769898231023896, 'support': 500076}, 'accuracy': 0.4297817294162762, 'macro avg': {'precision': 0.4403486972077278, 'recall': 0.4305294231864408, 'f1-score': 0.42398925987879177, 'support': 1348189}, 'weighted avg': {'precision': 0.45047750367738093, 'recall': 0.4297817294162762, 'f1-score': 0.4286960148728147, 'support': 1348189}}
[[153343 175532 153118]
 [ 68121 165935 132064]
 [ 75844 164083 260149]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0299498
{'0': {'precision': 0.5120718516610868, 'recall': 0.3530221152032313, 'f1-score': 0.41792613319145866, 'support': 90119}, '1': {'precision': 0.3972475027746948, 'recall': 0.49641062056875296, 'f1-score': 0.44132733585858586, 'support': 90127}, '2': {'precision': 0.48208475805615997, 'recall': 0.5111792302536888, 'f1-score': 0.4962058796866584, 'support': 91017}, 'accuracy': 0.4537294065169227, 'macro avg': {'precision': 0.4638013708306472, 'recall': 0.4535373220085577, 'f1-score': 0.4518197829122343, 'support': 271263}, 'weighted avg': {'precision': 0.4638599341097677, 'recall': 0.4537294065169227, 'f1-score': 0.4519664110013103, 'support': 271263}}
[[31814 35969 22336]
 [17739 44740 27648]
 [12575 31916 46526]]
Evaluating performance on  val set...
404/404 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0405624
{'0': {'precision': 0.4943253467843632, 'recall': 0.3258721019735829, 'f1-score': 0.3928001484505474, 'support': 32479}, '1': {'precision': 0.41276190033253496, 'recall': 0.4911591355599214, 'f1-score': 0.44856081473806575, 'support': 36139}, '2': {'precision': 0.45914546573656134, 'recall': 0.5146314821202713, 'f1-score': 0.48530767145567905, 'support': 34788}, 'accuracy': 0.44714039804266675, 'macro avg': {'precision': 0.4554109042844865, 'recall': 0.4438875732179252, 'f1-score': 0.4422228782147641, 'support': 103406}, 'weighted avg': {'precision': 0.4539847563620129, 'recall': 0.44714039804266675, 'f1-score': 0.4434092661929138, 'support': 103406}}
[[10584 13092  8803]
 [ 6103 17750 12286]
 [ 4724 12161 17903]]
training model: results/EXC/W10/deepVOL_L2/h300
Epoch 1/50
1060/1060 - 26s - loss: 3.2577 - accuracy300: 0.3975 - val_loss: 3.2533 - val_accuracy300: 0.3925 - 26s/epoch - 24ms/step
Epoch 2/50
1060/1060 - 23s - loss: 3.2128 - accuracy300: 0.4130 - val_loss: 3.2276 - val_accuracy300: 0.3960 - 23s/epoch - 22ms/step
Epoch 3/50
1060/1060 - 23s - loss: 3.1966 - accuracy300: 0.4213 - val_loss: 3.2296 - val_accuracy300: 0.3977 - 23s/epoch - 21ms/step
Epoch 4/50
1060/1060 - 24s - loss: 3.1818 - accuracy300: 0.4278 - val_loss: 3.2258 - val_accuracy300: 0.4008 - 24s/epoch - 22ms/step
Epoch 5/50
1060/1060 - 22s - loss: 3.1683 - accuracy300: 0.4321 - val_loss: 3.2385 - val_accuracy300: 0.3993 - 22s/epoch - 21ms/step
Epoch 6/50
1060/1060 - 23s - loss: 3.1588 - accuracy300: 0.4363 - val_loss: 3.2441 - val_accuracy300: 0.4014 - 23s/epoch - 22ms/step
Epoch 7/50
1060/1060 - 25s - loss: 3.1518 - accuracy300: 0.4403 - val_loss: 3.2543 - val_accuracy300: 0.3979 - 25s/epoch - 23ms/step
Epoch 8/50
1060/1060 - 25s - loss: 3.1385 - accuracy300: 0.4452 - val_loss: 3.2597 - val_accuracy300: 0.3971 - 25s/epoch - 24ms/step
Epoch 9/50
1060/1060 - 23s - loss: 3.1292 - accuracy300: 0.4481 - val_loss: 3.2747 - val_accuracy300: 0.3964 - 23s/epoch - 22ms/step
Epoch 10/50
1060/1060 - 23s - loss: 3.1184 - accuracy300: 0.4518 - val_loss: 3.2743 - val_accuracy300: 0.3953 - 23s/epoch - 22ms/step
Epoch 11/50
1060/1060 - 24s - loss: 3.1078 - accuracy300: 0.4557 - val_loss: 3.2845 - val_accuracy300: 0.3917 - 24s/epoch - 22ms/step
Epoch 12/50
1060/1060 - 25s - loss: 3.1007 - accuracy300: 0.4585 - val_loss: 3.2826 - val_accuracy300: 0.3950 - 25s/epoch - 23ms/step
Epoch 13/50
1060/1060 - 26s - loss: 3.0937 - accuracy300: 0.4609 - val_loss: 3.3098 - val_accuracy300: 0.3904 - 26s/epoch - 24ms/step
Epoch 14/50
1060/1060 - 26s - loss: 3.0845 - accuracy300: 0.4644 - val_loss: 3.3068 - val_accuracy300: 0.3917 - 26s/epoch - 24ms/step
testing model: results/EXC/W10/deepVOL_L2/h300
Evaluating performance on  test set...
5267/5267 - 50s - 50s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0870892
{'0': {'precision': 0.48171644218882165, 'recall': 0.19354627882759431, 'f1-score': 0.2761426684280053, 'support': 459022}, '1': {'precision': 0.32064783235831706, 'recall': 0.41092569948931884, 'f1-score': 0.36021651704320357, 'support': 417090}, '2': {'precision': 0.42516527874896703, 'recall': 0.5667105154455735, 'f1-score': 0.4858383190307604, 'support': 472077}, 'accuracy': 0.39146291803300576, 'macro avg': {'precision': 0.40917651776536856, 'recall': 0.39039416458749554, 'f1-score': 0.37406583483398975, 'support': 1348189}, 'weighted avg': {'precision': 0.41208480296212463, 'recall': 0.39146291803300576, 'f1-score': 0.3755789159930795, 'support': 1348189}}
[[ 88842 200261 169919]
 [ 53907 171393 191790]
 [ 41679 162867 267531]]
Evaluating performance on  train set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0734801
{'0': {'precision': 0.47206246682003183, 'recall': 0.23671454716876492, 'f1-score': 0.3153151156519876, 'support': 90155}, '1': {'precision': 0.3452993345883206, 'recall': 0.38336704927743565, 'f1-score': 0.3633388062072983, 'support': 89473}, '2': {'precision': 0.4288341040736123, 'recall': 0.5930157690838653, 'f1-score': 0.4977353184980284, 'support': 91635}, 'accuracy': 0.4054478495039869, 'macro avg': {'precision': 0.4153986351606549, 'recall': 0.404365788510022, 'f1-score': 0.39212974678577145, 'support': 271263}, 'weighted avg': {'precision': 0.4156481797612142, 'recall': 0.4054478495039869, 'f1-score': 0.3927783117120926, 'support': 271263}}
[[21341 36873 31941]
 [14736 34301 40436]
 [ 9131 28163 54341]]
Evaluating performance on  val set...
404/404 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0742124
{'0': {'precision': 0.44438696326952926, 'recall': 0.19008029335525067, 'f1-score': 0.266268127975202, 'support': 31634}, '1': {'precision': 0.3778379772961816, 'recall': 0.3915042639078247, 'f1-score': 0.3845497393884491, 'support': 37407}, '2': {'precision': 0.4088036779810232, 'recall': 0.6080605266986759, 'f1-score': 0.4889096864763687, 'support': 34365}, 'accuracy': 0.40185289054793727, 'macro avg': {'precision': 0.41034287284891136, 'recall': 0.3965483613205838, 'f1-score': 0.37990918461333995, 'support': 103406}, 'weighted avg': {'precision': 0.40848752303158825, 'recall': 0.40185289054793727, 'f1-score': 0.3830470131078629, 'support': 103406}}
[[ 6013 13484 12137]
 [ 4680 14645 18082]
 [ 2838 10631 20896]]
training model: results/EXC/W10/deepVOL_L2/h500
Epoch 1/50
1060/1060 - 25s - loss: 3.2737 - accuracy500: 0.3923 - val_loss: 3.2588 - val_accuracy500: 0.3923 - 25s/epoch - 24ms/step
Epoch 2/50
1060/1060 - 24s - loss: 3.2457 - accuracy500: 0.4008 - val_loss: 3.2559 - val_accuracy500: 0.3993 - 24s/epoch - 23ms/step
Epoch 3/50
1060/1060 - 23s - loss: 3.2352 - accuracy500: 0.4057 - val_loss: 3.2620 - val_accuracy500: 0.3968 - 23s/epoch - 22ms/step
Epoch 4/50
1060/1060 - 23s - loss: 3.2312 - accuracy500: 0.4077 - val_loss: 3.2577 - val_accuracy500: 0.3992 - 23s/epoch - 21ms/step
Epoch 5/50
1060/1060 - 25s - loss: 3.2229 - accuracy500: 0.4116 - val_loss: 3.2671 - val_accuracy500: 0.3974 - 25s/epoch - 24ms/step
Epoch 6/50
1060/1060 - 23s - loss: 3.2121 - accuracy500: 0.4180 - val_loss: 3.2680 - val_accuracy500: 0.3948 - 23s/epoch - 22ms/step
Epoch 7/50
1060/1060 - 23s - loss: 3.2029 - accuracy500: 0.4222 - val_loss: 3.2713 - val_accuracy500: 0.3956 - 23s/epoch - 22ms/step
Epoch 8/50
1060/1060 - 23s - loss: 3.2011 - accuracy500: 0.4240 - val_loss: 3.2684 - val_accuracy500: 0.3939 - 23s/epoch - 22ms/step
Epoch 9/50
1060/1060 - 23s - loss: 3.1918 - accuracy500: 0.4284 - val_loss: 3.2726 - val_accuracy500: 0.3919 - 23s/epoch - 21ms/step
Epoch 10/50
1060/1060 - 23s - loss: 3.1842 - accuracy500: 0.4308 - val_loss: 3.2826 - val_accuracy500: 0.3893 - 23s/epoch - 21ms/step
Epoch 11/50
1060/1060 - 25s - loss: 3.1755 - accuracy500: 0.4354 - val_loss: 3.2814 - val_accuracy500: 0.3938 - 25s/epoch - 24ms/step
Epoch 12/50
1060/1060 - 25s - loss: 3.1666 - accuracy500: 0.4385 - val_loss: 3.2995 - val_accuracy500: 0.3907 - 25s/epoch - 24ms/step
testing model: results/EXC/W10/deepVOL_L2/h500
Evaluating performance on  test set...
5267/5267 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0925955
{'0': {'precision': 0.4008696100195561, 'recall': 0.40363187715404464, 'f1-score': 0.40224600144533523, 'support': 443352}, '1': {'precision': 0.3367517290722633, 'recall': 0.02191462519649774, 'f1-score': 0.04115126963574215, 'support': 451023}, '2': {'precision': 0.371034500149582, 'recall': 0.7132922298562847, 'f1-score': 0.4881481174292834, 'support': 453814}, 'accuracy': 0.380167024059683, 'macro avg': {'precision': 0.36955194641380046, 'recall': 0.379612910735609, 'f1-score': 0.3105151295034536, 'support': 1348189}, 'weighted avg': {'precision': 0.36937682260694316, 'recall': 0.380167024059683, 'f1-score': 0.31036092719994485, 'support': 1348189}}
[[178951   9518 254883]
 [147293   9884 293846]
 [120163   9949 323702]]
Evaluating performance on  train set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0819368
{'0': {'precision': 0.41348819071909615, 'recall': 0.43841142486786083, 'f1-score': 0.42558522986136726, 'support': 89489}, '1': {'precision': 0.3431818181818182, 'recall': 0.021884301943165475, 'f1-score': 0.04114484536622685, 'support': 89699}, '2': {'precision': 0.3914449783194656, 'recall': 0.7255389628020635, 'f1-score': 0.5085276038594021, 'support': 92075}, 'accuracy': 0.3981376007785802, 'macro avg': {'precision': 0.3827049957401267, 'recall': 0.39527822987102995, 'f1-score': 0.32508589302899876, 'support': 271263}, 'weighted avg': {'precision': 0.3827577184765962, 'recall': 0.3981376007785802, 'f1-score': 0.32661486175749554, 'support': 271263}}
[[39233  1916 48340]
 [32220  1963 55516]
 [23430  1841 66804]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0848665
{'0': {'precision': 0.40195161491457787, 'recall': 0.3918606771624825, 'f1-score': 0.3968420080642679, 'support': 32902}, '1': {'precision': 0.3205699020480855, 'recall': 0.02167042889390519, 'f1-score': 0.04059654365538045, 'support': 33225}, '2': {'precision': 0.4004689942678478, 'recall': 0.7421336409238445, 'f1-score': 0.520218497033743, 'support': 37279}, 'accuracy': 0.3991934703982361, 'macro avg': {'precision': 0.3743301704101704, 'recall': 0.385221582326744, 'f1-score': 0.3192190162511304, 'support': 103406}, 'weighted avg': {'precision': 0.37526865623637107, 'recall': 0.3991934703982361, 'f1-score': 0.3268566743051801, 'support': 103406}}
[[12893   766 19243]
 [10330   720 22175]
 [ 8853   760 27666]]
training model: results/EXC/W10/deepVOL_L2/h1000
Epoch 1/50
1060/1060 - 26s - loss: 3.2520 - accuracy1000: 0.4124 - val_loss: 3.2991 - val_accuracy1000: 0.4440 - 26s/epoch - 24ms/step
Epoch 2/50
1060/1060 - 23s - loss: 3.2466 - accuracy1000: 0.4033 - val_loss: 3.2475 - val_accuracy1000: 0.4436 - 23s/epoch - 22ms/step
Epoch 3/50
1060/1060 - 24s - loss: 3.2472 - accuracy1000: 0.4015 - val_loss: 3.2177 - val_accuracy1000: 0.4418 - 24s/epoch - 23ms/step
Epoch 4/50
1060/1060 - 24s - loss: 3.2355 - accuracy1000: 0.4058 - val_loss: 3.2263 - val_accuracy1000: 0.4415 - 24s/epoch - 23ms/step
Epoch 5/50
1060/1060 - 24s - loss: 3.2347 - accuracy1000: 0.4105 - val_loss: 3.2268 - val_accuracy1000: 0.4434 - 24s/epoch - 23ms/step
Epoch 6/50
1060/1060 - 25s - loss: 3.2382 - accuracy1000: 0.4071 - val_loss: 3.2309 - val_accuracy1000: 0.4424 - 25s/epoch - 24ms/step
Epoch 7/50
1060/1060 - 22s - loss: 3.2310 - accuracy1000: 0.4107 - val_loss: 3.2136 - val_accuracy1000: 0.4430 - 22s/epoch - 21ms/step
Epoch 8/50
1060/1060 - 24s - loss: 3.2254 - accuracy1000: 0.4130 - val_loss: 3.2179 - val_accuracy1000: 0.4321 - 24s/epoch - 22ms/step
Epoch 9/50
1060/1060 - 22s - loss: 3.2159 - accuracy1000: 0.4177 - val_loss: 3.2212 - val_accuracy1000: 0.4266 - 22s/epoch - 21ms/step
Epoch 10/50
1060/1060 - 24s - loss: 3.2058 - accuracy1000: 0.4260 - val_loss: 3.2210 - val_accuracy1000: 0.4361 - 24s/epoch - 22ms/step
Epoch 11/50
1060/1060 - 24s - loss: 3.2003 - accuracy1000: 0.4277 - val_loss: 3.2347 - val_accuracy1000: 0.4301 - 24s/epoch - 22ms/step
Epoch 12/50
1060/1060 - 22s - loss: 3.1926 - accuracy1000: 0.4315 - val_loss: 3.2501 - val_accuracy1000: 0.4245 - 22s/epoch - 21ms/step
Epoch 13/50
1060/1060 - 25s - loss: 3.1821 - accuracy1000: 0.4375 - val_loss: 3.2557 - val_accuracy1000: 0.4271 - 25s/epoch - 24ms/step
Epoch 14/50
1060/1060 - 23s - loss: 3.1975 - accuracy1000: 0.4293 - val_loss: 3.2430 - val_accuracy1000: 0.4337 - 23s/epoch - 22ms/step
Epoch 15/50
1060/1060 - 22s - loss: 3.1888 - accuracy1000: 0.4325 - val_loss: 3.2537 - val_accuracy1000: 0.4213 - 22s/epoch - 21ms/step
Epoch 16/50
1060/1060 - 23s - loss: 3.1714 - accuracy1000: 0.4414 - val_loss: 3.2386 - val_accuracy1000: 0.4368 - 23s/epoch - 21ms/step
Epoch 17/50
1060/1060 - 25s - loss: 3.1630 - accuracy1000: 0.4441 - val_loss: 3.2468 - val_accuracy1000: 0.4253 - 25s/epoch - 23ms/step
testing model: results/EXC/W10/deepVOL_L2/h1000
Evaluating performance on  test set...
5267/5267 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0907489
{'0': {'precision': 0.29252414951700967, 'recall': 0.003609378684196207, 'f1-score': 0.007130772636875769, 'support': 385939}, '1': {'precision': 0.4224986311929648, 'recall': 0.9927146552843759, 'f1-score': 0.5927312681847977, 'support': 569774}, '2': {'precision': 0.35224839400428265, 'recall': 0.0041913390882499825, 'f1-score': 0.008284107104188384, 'support': 392476}, 'accuracy': 0.4217962021645333, 'macro avg': {'precision': 0.35575705823808573, 'recall': 0.33350512435227403, 'f1-score': 0.20271538264195396, 'support': 1348189}, 'weighted avg': {'precision': 0.36484072597759687, 'recall': 0.4217962021645333, 'f1-score': 0.25495403246818626, 'support': 1348189}}
[[  1393 383389   1157]
 [  2283 565623   1868]
 [  1086 389745   1645]]
Evaluating performance on  train set...
1060/1060 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1417452
{'0': {'precision': 0.4461436170212766, 'recall': 0.007517196567408304, 'f1-score': 0.01478527201815658, 'support': 89262}, '1': {'precision': 0.33030934134101314, 'recall': 0.9907692995395825, 'f1-score': 0.495444169067291, 'support': 89484}, '2': {'precision': 0.43037037037037035, 'recall': 0.006279926932347569, 'f1-score': 0.01237921740334729, 'support': 92517}, 'accuracy': 0.331449552648168, 'macro avg': {'precision': 0.40227444291088665, 'recall': 0.3348554743464461, 'f1-score': 0.1742028861629316, 'support': 271263}, 'weighted avg': {'precision': 0.4025526820785288, 'recall': 0.331449552648168, 'f1-score': 0.17252399712532726, 'support': 271263}}
[[  671 88212   379]
 [  436 88658   390]
 [  397 91539   581]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.071905
{'0': {'precision': 0.30237154150197626, 'recall': 0.005795015529126582, 'f1-score': 0.011372082651999406, 'support': 26402}, '1': {'precision': 0.44396821057564634, 'recall': 0.9904382296567347, 'f1-score': 0.6131080789558839, 'support': 45912}, '2': {'precision': 0.40756302521008403, 'recall': 0.006239547150392384, 'f1-score': 0.0122909275215408, 'support': 31092}, 'accuracy': 0.44310775003384717, 'macro avg': {'precision': 0.3846342590959022, 'recall': 0.33415759744541784, 'f1-score': 0.21225702970980806, 'support': 103406}, 'weighted avg': {'precision': 0.3968689583052839, 'recall': 0.44310775003384717, 'f1-score': 0.2788176059967543, 'support': 103406}}
[[  153 26148   101]
 [  258 45473   181]
 [   95 30803   194]]
training model: results/EXC/W10/deepVOL_L3/h10
Epoch 1/50
1060/1060 - 39s - loss: 2.7632 - accuracy10: 0.4071 - val_loss: 2.2294 - val_accuracy10: 0.6283 - 39s/epoch - 37ms/step
Epoch 2/50
1060/1060 - 37s - loss: 2.1885 - accuracy10: 0.6456 - val_loss: 2.0522 - val_accuracy10: 0.6585 - 37s/epoch - 35ms/step
Epoch 3/50
1060/1060 - 36s - loss: 2.0832 - accuracy10: 0.6695 - val_loss: 2.0013 - val_accuracy10: 0.6742 - 36s/epoch - 34ms/step
Epoch 4/50
1060/1060 - 36s - loss: 2.0357 - accuracy10: 0.6806 - val_loss: 2.0003 - val_accuracy10: 0.6863 - 36s/epoch - 34ms/step
Epoch 5/50
1060/1060 - 39s - loss: 2.0117 - accuracy10: 0.6849 - val_loss: 1.9850 - val_accuracy10: 0.6935 - 39s/epoch - 37ms/step
Epoch 6/50
1060/1060 - 37s - loss: 1.9971 - accuracy10: 0.6859 - val_loss: 1.9731 - val_accuracy10: 0.6898 - 37s/epoch - 35ms/step
Epoch 7/50
1060/1060 - 37s - loss: 1.9851 - accuracy10: 0.6877 - val_loss: 2.0018 - val_accuracy10: 0.7053 - 37s/epoch - 35ms/step
Epoch 8/50
1060/1060 - 37s - loss: 1.9737 - accuracy10: 0.6882 - val_loss: 1.9720 - val_accuracy10: 0.7260 - 37s/epoch - 34ms/step
Epoch 9/50
1060/1060 - 36s - loss: 1.9666 - accuracy10: 0.6910 - val_loss: 1.9560 - val_accuracy10: 0.7320 - 36s/epoch - 34ms/step
Epoch 10/50
1060/1060 - 36s - loss: 1.9591 - accuracy10: 0.6908 - val_loss: 1.9542 - val_accuracy10: 0.7224 - 36s/epoch - 34ms/step
Epoch 11/50
1060/1060 - 37s - loss: 1.9498 - accuracy10: 0.6921 - val_loss: 1.9563 - val_accuracy10: 0.7245 - 37s/epoch - 35ms/step
Epoch 12/50
1060/1060 - 36s - loss: 1.9426 - accuracy10: 0.6930 - val_loss: 1.9454 - val_accuracy10: 0.7230 - 36s/epoch - 34ms/step
Epoch 13/50
1060/1060 - 40s - loss: 1.9340 - accuracy10: 0.6903 - val_loss: 1.9696 - val_accuracy10: 0.6988 - 40s/epoch - 38ms/step
Epoch 14/50
1060/1060 - 38s - loss: 1.9323 - accuracy10: 0.6910 - val_loss: 1.9592 - val_accuracy10: 0.7204 - 38s/epoch - 36ms/step
Epoch 15/50
1060/1060 - 37s - loss: 1.9326 - accuracy10: 0.6907 - val_loss: 1.9449 - val_accuracy10: 0.7206 - 37s/epoch - 35ms/step
Epoch 16/50
1060/1060 - 37s - loss: 1.9173 - accuracy10: 0.6940 - val_loss: 1.9499 - val_accuracy10: 0.7191 - 37s/epoch - 35ms/step
Epoch 17/50
1060/1060 - 40s - loss: 1.9111 - accuracy10: 0.6929 - val_loss: 1.9469 - val_accuracy10: 0.7308 - 40s/epoch - 38ms/step
Epoch 18/50
1060/1060 - 40s - loss: 1.9095 - accuracy10: 0.6917 - val_loss: 1.9887 - val_accuracy10: 0.7332 - 40s/epoch - 38ms/step
Epoch 19/50
1060/1060 - 37s - loss: 1.9011 - accuracy10: 0.6934 - val_loss: 1.9522 - val_accuracy10: 0.7334 - 37s/epoch - 35ms/step
Epoch 20/50
1060/1060 - 37s - loss: 1.8962 - accuracy10: 0.6931 - val_loss: 1.9552 - val_accuracy10: 0.7197 - 37s/epoch - 34ms/step
Epoch 21/50
1060/1060 - 37s - loss: 1.8942 - accuracy10: 0.6925 - val_loss: 1.9812 - val_accuracy10: 0.7281 - 37s/epoch - 35ms/step
Epoch 22/50
1060/1060 - 37s - loss: 1.8833 - accuracy10: 0.6907 - val_loss: 1.9593 - val_accuracy10: 0.7161 - 37s/epoch - 35ms/step
Epoch 23/50
1060/1060 - 37s - loss: 1.8788 - accuracy10: 0.6918 - val_loss: 1.9648 - val_accuracy10: 0.7240 - 37s/epoch - 35ms/step
Epoch 24/50
1060/1060 - 37s - loss: 1.8750 - accuracy10: 0.6924 - val_loss: 2.0023 - val_accuracy10: 0.7140 - 37s/epoch - 35ms/step
Epoch 25/50
1060/1060 - 37s - loss: 1.8635 - accuracy10: 0.6936 - val_loss: 1.9821 - val_accuracy10: 0.7291 - 37s/epoch - 35ms/step
testing model: results/EXC/W10/deepVOL_L3/h10
Evaluating performance on  test set...
5267/5267 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7421461
{'0': {'precision': 0.3357119399293716, 'recall': 0.5469492096415148, 'f1-score': 0.4160540662764113, 'support': 151387}, '1': {'precision': 0.9157201533980176, 'recall': 0.6680476912110656, 'f1-score': 0.772518189904258, 'support': 1046566}, '2': {'precision': 0.31606723424899863, 'recall': 0.7111744189142416, 'f1-score': 0.4376359369047961, 'support': 150236}, 'accuracy': 0.6592554901427026, 'macro avg': {'precision': 0.522499775858796, 'recall': 0.6420571065889407, 'f1-score': 0.5420693976951552, 'support': 1348189}, 'weighted avg': {'precision': 0.7837689511751469, 'recall': 0.6592554901427026, 'f1-score': 0.6951733929616364, 'support': 1348189}}
[[ 82801  33648  34938]
 [151150 699156 196260]
 [ 12692  30700 106844]]
Evaluating performance on  train set...
1060/1060 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6336451
{'0': {'precision': 0.2990107544536573, 'recall': 0.6622874806800618, 'f1-score': 0.4120075789711829, 'support': 21998}, '1': {'precision': 0.9517443002576873, 'recall': 0.7262474759498805, 'f1-score': 0.8238441994918678, 'support': 226818}, '2': {'precision': 0.32120256363599603, 'recall': 0.707756047578741, 'f1-score': 0.4418701674361684, 'support': 22447}, 'accuracy': 0.7195304925478226, 'macro avg': {'precision': 0.5239858727824469, 'recall': 0.698763668069561, 'f1-score': 0.5592406486330731, 'support': 271263}, 'weighted avg': {'precision': 0.8466337510764715, 'recall': 0.7195304925478226, 'f1-score': 0.7588380870630872, 'support': 271263}}
[[ 14569   3837   3592]
 [ 32110 164726  29982]
 [  2045   4515  15887]]
Evaluating performance on  val set...
404/404 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.63870347
{'0': {'precision': 0.3089378238341969, 'recall': 0.6563672754565925, 'f1-score': 0.42012971414845063, 'support': 7994}, '1': {'precision': 0.9546519310469097, 'recall': 0.7276223175965665, 'f1-score': 0.8258178488156861, 'support': 87375}, '2': {'precision': 0.28563502471502067, 'recall': 0.7046161503048401, 'f1-score': 0.40648889207910127, 'support': 8037}, 'accuracy': 0.720325706438698, 'macro avg': {'precision': 0.5164082598653758, 'recall': 0.6962019144526663, 'f1-score': 0.5508121516810793, 'support': 103406}, 'weighted avg': {'precision': 0.8527359160260422, 'recall': 0.720325706438698, 'f1-score': 0.7618639411718182, 'support': 103406}}
[[ 5247  1435  1312]
 [10948 63576 12851]
 [  789  1585  5663]]
training model: results/EXC/W10/deepVOL_L3/h20
Epoch 1/50
1060/1060 - 39s - loss: 2.7206 - accuracy20: 0.4521 - val_loss: 2.2866 - val_accuracy20: 0.6281 - 39s/epoch - 37ms/step
Epoch 2/50
1060/1060 - 41s - loss: 2.2664 - accuracy20: 0.6168 - val_loss: 2.1809 - val_accuracy20: 0.6169 - 41s/epoch - 38ms/step
Epoch 3/50
1060/1060 - 39s - loss: 2.1734 - accuracy20: 0.6430 - val_loss: 2.1487 - val_accuracy20: 0.6257 - 39s/epoch - 36ms/step
Epoch 4/50
1060/1060 - 40s - loss: 2.1304 - accuracy20: 0.6536 - val_loss: 2.1400 - val_accuracy20: 0.6368 - 40s/epoch - 38ms/step
Epoch 5/50
1060/1060 - 39s - loss: 2.1058 - accuracy20: 0.6570 - val_loss: 2.1511 - val_accuracy20: 0.6400 - 39s/epoch - 37ms/step
Epoch 6/50
1060/1060 - 39s - loss: 2.0895 - accuracy20: 0.6592 - val_loss: 2.1308 - val_accuracy20: 0.6471 - 39s/epoch - 36ms/step
Epoch 7/50
1060/1060 - 39s - loss: 2.0753 - accuracy20: 0.6618 - val_loss: 2.1191 - val_accuracy20: 0.6334 - 39s/epoch - 37ms/step
Epoch 8/50
1060/1060 - 39s - loss: 2.0677 - accuracy20: 0.6631 - val_loss: 2.1084 - val_accuracy20: 0.6316 - 39s/epoch - 37ms/step
Epoch 9/50
1060/1060 - 39s - loss: 2.0583 - accuracy20: 0.6643 - val_loss: 2.1006 - val_accuracy20: 0.6268 - 39s/epoch - 37ms/step
Epoch 10/50
1060/1060 - 40s - loss: 2.0484 - accuracy20: 0.6649 - val_loss: 2.0945 - val_accuracy20: 0.6394 - 40s/epoch - 38ms/step
Epoch 11/50
1060/1060 - 39s - loss: 2.0406 - accuracy20: 0.6653 - val_loss: 2.1011 - val_accuracy20: 0.6540 - 39s/epoch - 37ms/step
Epoch 12/50
1060/1060 - 39s - loss: 2.0313 - accuracy20: 0.6648 - val_loss: 2.0968 - val_accuracy20: 0.6513 - 39s/epoch - 37ms/step
Epoch 13/50
1060/1060 - 39s - loss: 2.0266 - accuracy20: 0.6664 - val_loss: 2.1007 - val_accuracy20: 0.6549 - 39s/epoch - 37ms/step
Epoch 14/50
1060/1060 - 39s - loss: 2.0180 - accuracy20: 0.6664 - val_loss: 2.0890 - val_accuracy20: 0.6590 - 39s/epoch - 37ms/step
Epoch 15/50
1060/1060 - 39s - loss: 2.0089 - accuracy20: 0.6676 - val_loss: 2.1036 - val_accuracy20: 0.6501 - 39s/epoch - 37ms/step
Epoch 16/50
1060/1060 - 39s - loss: 2.0035 - accuracy20: 0.6666 - val_loss: 2.1121 - val_accuracy20: 0.6331 - 39s/epoch - 37ms/step
Epoch 17/50
1060/1060 - 39s - loss: 1.9955 - accuracy20: 0.6684 - val_loss: 2.1036 - val_accuracy20: 0.6464 - 39s/epoch - 37ms/step
Epoch 18/50
1060/1060 - 39s - loss: 1.9888 - accuracy20: 0.6676 - val_loss: 2.1128 - val_accuracy20: 0.6407 - 39s/epoch - 37ms/step
Epoch 19/50
1060/1060 - 39s - loss: 1.9828 - accuracy20: 0.6684 - val_loss: 2.1192 - val_accuracy20: 0.6555 - 39s/epoch - 37ms/step
Epoch 20/50
1060/1060 - 39s - loss: 1.9784 - accuracy20: 0.6687 - val_loss: 2.1124 - val_accuracy20: 0.6554 - 39s/epoch - 36ms/step
Epoch 21/50
1060/1060 - 39s - loss: 1.9715 - accuracy20: 0.6680 - val_loss: 2.1045 - val_accuracy20: 0.6619 - 39s/epoch - 37ms/step
Epoch 22/50
1060/1060 - 40s - loss: 1.9641 - accuracy20: 0.6679 - val_loss: 2.0979 - val_accuracy20: 0.6535 - 40s/epoch - 38ms/step
Epoch 23/50
1060/1060 - 39s - loss: 1.9552 - accuracy20: 0.6693 - val_loss: 2.1096 - val_accuracy20: 0.6718 - 39s/epoch - 37ms/step
Epoch 24/50
1060/1060 - 40s - loss: 1.9504 - accuracy20: 0.6697 - val_loss: 2.1117 - val_accuracy20: 0.6707 - 40s/epoch - 38ms/step
testing model: results/EXC/W10/deepVOL_L3/h20
Evaluating performance on  test set...
5267/5267 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8089437
{'0': {'precision': 0.41000653830048267, 'recall': 0.5508965190482537, 'f1-score': 0.4701227101097379, 'support': 202617}, '1': {'precision': 0.8602343470125445, 'recall': 0.5932615126870182, 'f1-score': 0.7022296301270228, 'support': 943090}, '2': {'precision': 0.3343767037016149, 'recall': 0.7027390088995565, 'f1-score': 0.45314047507587263, 'support': 202482}, 'accuracy': 0.6033367725148329, 'macro avg': {'precision': 0.5348725296715474, 'recall': 0.6156323468782761, 'f1-score': 0.5418309384375445, 'support': 1348189}, 'weighted avg': {'precision': 0.713592803986533, 'recall': 0.6033367725148329, 'f1-score': 0.6299364441522008, 'support': 1348189}}
[[111621  52889  38107]
 [138446 559499 245145]
 [ 22175  38015 142292]]
Evaluating performance on  train set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6913693
{'0': {'precision': 0.3744578672077136, 'recall': 0.6554476736608889, 'f1-score': 0.47662145353313984, 'support': 30692}, '1': {'precision': 0.91616322549179, 'recall': 0.67305404669428, 'f1-score': 0.7760139247687926, 'support': 209319}, '2': {'precision': 0.34658511722731905, 'recall': 0.7071547420965059, 'f1-score': 0.4651799151730743, 'support': 31252}, 'accuracy': 0.6749906916903522, 'macro avg': {'precision': 0.5457354033089409, 'recall': 0.6785521541505583, 'f1-score': 0.5726050978250022, 'support': 271263}, 'weighted avg': {'precision': 0.7892514244133675, 'recall': 0.6749906916903522, 'f1-score': 0.7063282758043189, 'support': 271263}}
[[ 20117   6768   3807]
 [ 30578 140883  37858]
 [  3028   6124  22100]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7157245
{'0': {'precision': 0.3778428399644482, 'recall': 0.648626817447496, 'f1-score': 0.4775182529981169, 'support': 11142}, '1': {'precision': 0.9209068010075567, 'recall': 0.6536943868994771, 'f1-score': 0.7646274006389684, 'support': 81096}, '2': {'precision': 0.2973347308527364, 'recall': 0.7112285100286533, 'f1-score': 0.41935483870967744, 'support': 11168}, 'accuracy': 0.6593621259888207, 'macro avg': {'precision': 0.5320281239415804, 'recall': 0.6711832381252089, 'f1-score': 0.5538334974489209, 'support': 103406}, 'weighted avg': {'precision': 0.7950449406374491, 'recall': 0.6593621259888207, 'f1-score': 0.6964014360465784, 'support': 103406}}
[[ 7227  2519  1396]
 [10709 53012 17375]
 [ 1191  2034  7943]]
training model: results/EXC/W10/deepVOL_L3/h30
Epoch 1/50
1060/1060 - 39s - loss: 2.7610 - accuracy30: 0.4518 - val_loss: 2.4483 - val_accuracy30: 0.5343 - 39s/epoch - 37ms/step
Epoch 2/50
1060/1060 - 37s - loss: 2.3677 - accuracy30: 0.5992 - val_loss: 2.3341 - val_accuracy30: 0.6112 - 37s/epoch - 35ms/step
Epoch 3/50
1060/1060 - 37s - loss: 2.2783 - accuracy30: 0.6189 - val_loss: 2.2947 - val_accuracy30: 0.6184 - 37s/epoch - 35ms/step
Epoch 4/50
1060/1060 - 39s - loss: 2.2354 - accuracy30: 0.6268 - val_loss: 2.2812 - val_accuracy30: 0.6311 - 39s/epoch - 37ms/step
Epoch 5/50
1060/1060 - 39s - loss: 2.2122 - accuracy30: 0.6312 - val_loss: 2.2759 - val_accuracy30: 0.6167 - 39s/epoch - 37ms/step
Epoch 6/50
1060/1060 - 40s - loss: 2.1992 - accuracy30: 0.6323 - val_loss: 2.2646 - val_accuracy30: 0.6221 - 40s/epoch - 37ms/step
Epoch 7/50
1060/1060 - 37s - loss: 2.1868 - accuracy30: 0.6336 - val_loss: 2.2454 - val_accuracy30: 0.6064 - 37s/epoch - 35ms/step
Epoch 8/50
1060/1060 - 36s - loss: 2.1754 - accuracy30: 0.6364 - val_loss: 2.2478 - val_accuracy30: 0.6003 - 36s/epoch - 34ms/step
Epoch 9/50
1060/1060 - 38s - loss: 2.1642 - accuracy30: 0.6374 - val_loss: 2.2506 - val_accuracy30: 0.5831 - 38s/epoch - 36ms/step
Epoch 10/50
1060/1060 - 36s - loss: 2.1604 - accuracy30: 0.6376 - val_loss: 2.2639 - val_accuracy30: 0.5925 - 36s/epoch - 34ms/step
Epoch 11/50
1060/1060 - 36s - loss: 2.1487 - accuracy30: 0.6398 - val_loss: 2.2575 - val_accuracy30: 0.5920 - 36s/epoch - 34ms/step
Epoch 12/50
1060/1060 - 37s - loss: 2.1396 - accuracy30: 0.6393 - val_loss: 2.2573 - val_accuracy30: 0.5893 - 37s/epoch - 35ms/step
Epoch 13/50
1060/1060 - 36s - loss: 2.1336 - accuracy30: 0.6400 - val_loss: 2.2638 - val_accuracy30: 0.5938 - 36s/epoch - 34ms/step
Epoch 14/50
1060/1060 - 36s - loss: 2.1264 - accuracy30: 0.6406 - val_loss: 2.2770 - val_accuracy30: 0.5761 - 36s/epoch - 34ms/step
Epoch 15/50
1060/1060 - 36s - loss: 2.1194 - accuracy30: 0.6419 - val_loss: 2.2621 - val_accuracy30: 0.5985 - 36s/epoch - 34ms/step
Epoch 16/50
1060/1060 - 36s - loss: 2.1123 - accuracy30: 0.6414 - val_loss: 2.2731 - val_accuracy30: 0.5877 - 36s/epoch - 34ms/step
Epoch 17/50
1060/1060 - 37s - loss: 2.1066 - accuracy30: 0.6429 - val_loss: 2.2586 - val_accuracy30: 0.6096 - 37s/epoch - 35ms/step
testing model: results/EXC/W10/deepVOL_L3/h30
Evaluating performance on  test set...
5267/5267 - 72s - 72s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90144104
{'0': {'precision': 0.4316645686708892, 'recall': 0.5370296146011099, 'f1-score': 0.4786168038446666, 'support': 242009}, '1': {'precision': 0.8071792216451245, 'recall': 0.527532956685499, 'f1-score': 0.6380606220318361, 'support': 862875}, '2': {'precision': 0.3534557872406478, 'recall': 0.7019214566079612, 'f1-score': 0.4701602246448629, 'support': 243305}, 'accuracy': 0.5607092180695733, 'macro avg': {'precision': 0.5307665258522205, 'recall': 0.58882800929819, 'f1-score': 0.5289458835071218, 'support': 1348189}, 'weighted avg': {'precision': 0.6578892438605387, 'recall': 0.5607092180695733, 'f1-score': 0.5791387311234425, 'support': 1348189}}
[[129966  64079  47964]
 [143250 455195 264430]
 [ 27865  44659 170781]]
Evaluating performance on  train set...
1060/1060 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7877311
{'0': {'precision': 0.39230032933694575, 'recall': 0.6434026022403746, 'f1-score': 0.4874120658724879, 'support': 37583}, '1': {'precision': 0.8797617346439933, 'recall': 0.5985284185104075, 'f1-score': 0.7123938403822203, 'support': 195436}, '2': {'precision': 0.3586606315954241, 'recall': 0.7189624516263989, 'f1-score': 0.4785783285613583, 'support': 38244}, 'accuracy': 0.6217250417491512, 'macro avg': {'precision': 0.5435742318587877, 'recall': 0.6536311574590603, 'f1-score': 0.5594614116053555, 'support': 271263}, 'weighted avg': {'precision': 0.7387574230325894, 'recall': 0.6217250417491512, 'f1-score': 0.6482585529841001, 'support': 271263}}
[[ 24181   8650   4752]
 [ 34047 116974  44415]
 [  3411   7337  27496]]
Evaluating performance on  val set...
404/404 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8120703
{'0': {'precision': 0.39908106334099114, 'recall': 0.6258363355635616, 'f1-score': 0.48737474949899795, 'support': 13601}, '1': {'precision': 0.8839038020157669, 'recall': 0.5822848052170025, 'f1-score': 0.7020703211692718, 'support': 76059}, '2': {'precision': 0.3113036406855999, 'recall': 0.7240651825985741, 'f1-score': 0.4354083730696881, 'support': 13746}, 'accuracy': 0.6068603369243564, 'macro avg': {'precision': 0.5314295020141193, 'recall': 0.6440621077930461, 'f1-score': 0.5416178145793192, 'support': 103406}, 'weighted avg': {'precision': 0.7440179550981789, 'recall': 0.6068603369243564, 'f1-score': 0.6383834015624378, 'support': 103406}}
[[ 8512  3362  1727]
 [11479 44288 20292]
 [ 1338  2455  9953]]
training model: results/EXC/W10/deepVOL_L3/h50
Epoch 1/50
1060/1060 - 39s - loss: 2.9525 - accuracy50: 0.4032 - val_loss: 2.8445 - val_accuracy50: 0.5160 - 39s/epoch - 37ms/step
Epoch 2/50
1060/1060 - 39s - loss: 2.6813 - accuracy50: 0.5016 - val_loss: 2.5787 - val_accuracy50: 0.5481 - 39s/epoch - 37ms/step
Epoch 3/50
1060/1060 - 35s - loss: 2.5215 - accuracy50: 0.5695 - val_loss: 2.5608 - val_accuracy50: 0.5598 - 35s/epoch - 33ms/step
Epoch 4/50
1060/1060 - 36s - loss: 2.4563 - accuracy50: 0.5870 - val_loss: 2.5546 - val_accuracy50: 0.5563 - 36s/epoch - 34ms/step
Epoch 5/50
1060/1060 - 35s - loss: 2.4238 - accuracy50: 0.5942 - val_loss: 2.5352 - val_accuracy50: 0.5561 - 35s/epoch - 33ms/step
Epoch 6/50
1060/1060 - 39s - loss: 2.4068 - accuracy50: 0.5993 - val_loss: 2.5138 - val_accuracy50: 0.5646 - 39s/epoch - 37ms/step
Epoch 7/50
1060/1060 - 39s - loss: 2.3922 - accuracy50: 0.6002 - val_loss: 2.5200 - val_accuracy50: 0.5658 - 39s/epoch - 36ms/step
Epoch 8/50
1060/1060 - 37s - loss: 2.3787 - accuracy50: 0.6029 - val_loss: 2.5215 - val_accuracy50: 0.5598 - 37s/epoch - 35ms/step
Epoch 9/50
1060/1060 - 38s - loss: 2.3695 - accuracy50: 0.6047 - val_loss: 2.5197 - val_accuracy50: 0.5548 - 38s/epoch - 36ms/step
Epoch 10/50
1060/1060 - 36s - loss: 2.3623 - accuracy50: 0.6063 - val_loss: 2.4921 - val_accuracy50: 0.5687 - 36s/epoch - 34ms/step
Epoch 11/50
1060/1060 - 36s - loss: 2.3503 - accuracy50: 0.6072 - val_loss: 2.5332 - val_accuracy50: 0.5515 - 36s/epoch - 34ms/step
Epoch 12/50
1060/1060 - 39s - loss: 2.3447 - accuracy50: 0.6070 - val_loss: 2.5162 - val_accuracy50: 0.5662 - 39s/epoch - 36ms/step
Epoch 13/50
1060/1060 - 39s - loss: 2.3340 - accuracy50: 0.6080 - val_loss: 2.5436 - val_accuracy50: 0.5556 - 39s/epoch - 36ms/step
Epoch 14/50
1060/1060 - 36s - loss: 2.3268 - accuracy50: 0.6097 - val_loss: 2.5209 - val_accuracy50: 0.5734 - 36s/epoch - 34ms/step
Epoch 15/50
1060/1060 - 35s - loss: 2.3197 - accuracy50: 0.6107 - val_loss: 2.5439 - val_accuracy50: 0.5669 - 35s/epoch - 33ms/step
Epoch 16/50
1060/1060 - 40s - loss: 2.3108 - accuracy50: 0.6112 - val_loss: 2.5335 - val_accuracy50: 0.5721 - 40s/epoch - 38ms/step
Epoch 17/50
1060/1060 - 35s - loss: 2.3000 - accuracy50: 0.6132 - val_loss: 2.5559 - val_accuracy50: 0.5696 - 35s/epoch - 33ms/step
Epoch 18/50
1060/1060 - 35s - loss: 2.2909 - accuracy50: 0.6143 - val_loss: 2.5500 - val_accuracy50: 0.5654 - 35s/epoch - 33ms/step
Epoch 19/50
1060/1060 - 36s - loss: 2.2875 - accuracy50: 0.6143 - val_loss: 2.5775 - val_accuracy50: 0.5660 - 36s/epoch - 34ms/step
Epoch 20/50
1060/1060 - 36s - loss: 2.2791 - accuracy50: 0.6147 - val_loss: 2.6041 - val_accuracy50: 0.5659 - 36s/epoch - 34ms/step
testing model: results/EXC/W10/deepVOL_L3/h50
Evaluating performance on  test set...
5267/5267 - 78s - 78s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9509927
{'0': {'precision': 0.46789662828759127, 'recall': 0.46761374406034106, 'f1-score': 0.4677551434040042, 'support': 305994}, '1': {'precision': 0.7015918992065001, 'recall': 0.48810223366877675, 'f1-score': 0.5756917911311799, 'support': 733457}, '2': {'precision': 0.39992745847185446, 'recall': 0.68927375314992, 'f1-score': 0.5061681851751866, 'support': 308738}, 'accuracy': 0.5295207126003847, 'macro avg': {'precision': 0.5231386619886486, 'recall': 0.5483299102930126, 'f1-score': 0.5165383732367902, 'support': 1348189}, 'weighted avg': {'precision': 0.5794690908813368, 'recall': 0.5295207126003847, 'f1-score': 0.5352727210747776, 'support': 1348189}}
[[143087  87423  75484]
 [131635 358002 243820]
 [ 31087  64846 212805]]
Evaluating performance on  train set...
1060/1060 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83791614
{'0': {'precision': 0.43660682118409994, 'recall': 0.5886579368131312, 'f1-score': 0.5013574660633484, 'support': 49409}, '1': {'precision': 0.7986523489047243, 'recall': 0.5640205723205601, 'f1-score': 0.6611364295833547, 'support': 171687}, '2': {'precision': 0.41016079329488364, 'recall': 0.6818625789861862, 'f1-score': 0.5122111914708833, 'support': 50167}, 'accuracy': 0.5903016629617751, 'macro avg': {'precision': 0.5484733211279026, 'recall': 0.6115136960399591, 'f1-score': 0.5582350290391954, 'support': 271263}, 'weighted avg': {'precision': 0.6608607468453678, 'recall': 0.5903016629617751, 'f1-score': 0.6044915822250775, 'support': 271263}}
[[29085 13028  7296]
 [32956 96835 41896]
 [ 4575 11385 34207]]
Evaluating performance on  val set...
404/404 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8662493
{'0': {'precision': 0.4223922878525221, 'recall': 0.5610153310495872, 'f1-score': 0.4819335230836027, 'support': 17807}, '1': {'precision': 0.8053067771688277, 'recall': 0.5364887127654838, 'f1-score': 0.6439699633895406, 'support': 67377}, '2': {'precision': 0.36163927844216925, 'recall': 0.6920206343979804, 'f1-score': 0.4750334331619294, 'support': 18222}, 'accuracy': 0.5681198383072549, 'macro avg': {'precision': 0.529779447821173, 'recall': 0.5965082260710172, 'f1-score': 0.5336456398783576, 'support': 103406}, 'weighted avg': {'precision': 0.6611848937863101, 'recall': 0.5681198383072549, 'f1-score': 0.5862968656356833, 'support': 103406}}
[[ 9990  4948  2869]
 [11840 36147 19390]
 [ 1821  3791 12610]]
training model: results/EXC/W10/deepVOL_L3/h100
Epoch 1/50
1060/1060 - 39s - loss: 3.1074 - accuracy100: 0.4252 - val_loss: 3.0729 - val_accuracy100: 0.4574 - 39s/epoch - 37ms/step
Epoch 2/50
1060/1060 - 39s - loss: 3.0014 - accuracy100: 0.4446 - val_loss: 3.0207 - val_accuracy100: 0.4650 - 39s/epoch - 37ms/step
Epoch 3/50
1060/1060 - 39s - loss: 2.9033 - accuracy100: 0.4997 - val_loss: 2.9078 - val_accuracy100: 0.5104 - 39s/epoch - 37ms/step
Epoch 4/50
1060/1060 - 39s - loss: 2.8195 - accuracy100: 0.5245 - val_loss: 2.8527 - val_accuracy100: 0.5185 - 39s/epoch - 37ms/step
Epoch 5/50
1060/1060 - 39s - loss: 2.7875 - accuracy100: 0.5293 - val_loss: 2.8527 - val_accuracy100: 0.5090 - 39s/epoch - 37ms/step
Epoch 6/50
1060/1060 - 39s - loss: 2.7648 - accuracy100: 0.5341 - val_loss: 2.8304 - val_accuracy100: 0.5133 - 39s/epoch - 37ms/step
Epoch 7/50
1060/1060 - 36s - loss: 2.7503 - accuracy100: 0.5391 - val_loss: 2.8242 - val_accuracy100: 0.5282 - 36s/epoch - 34ms/step
Epoch 8/50
1060/1060 - 35s - loss: 2.7399 - accuracy100: 0.5416 - val_loss: 2.8298 - val_accuracy100: 0.5176 - 35s/epoch - 33ms/step
Epoch 9/50
1060/1060 - 36s - loss: 2.7272 - accuracy100: 0.5444 - val_loss: 2.8609 - val_accuracy100: 0.4998 - 36s/epoch - 34ms/step
Epoch 10/50
1060/1060 - 36s - loss: 2.7195 - accuracy100: 0.5472 - val_loss: 2.8625 - val_accuracy100: 0.5089 - 36s/epoch - 34ms/step
Epoch 11/50
1060/1060 - 38s - loss: 2.7106 - accuracy100: 0.5480 - val_loss: 2.8696 - val_accuracy100: 0.5094 - 38s/epoch - 36ms/step
Epoch 12/50
1060/1060 - 39s - loss: 2.7030 - accuracy100: 0.5505 - val_loss: 2.8891 - val_accuracy100: 0.5092 - 39s/epoch - 37ms/step
Epoch 13/50
1060/1060 - 36s - loss: 2.6968 - accuracy100: 0.5521 - val_loss: 2.8983 - val_accuracy100: 0.5083 - 36s/epoch - 34ms/step
Epoch 14/50
1060/1060 - 36s - loss: 2.6873 - accuracy100: 0.5552 - val_loss: 2.9267 - val_accuracy100: 0.5105 - 36s/epoch - 34ms/step
Epoch 15/50
1060/1060 - 39s - loss: 2.6819 - accuracy100: 0.5569 - val_loss: 2.9300 - val_accuracy100: 0.5165 - 39s/epoch - 37ms/step
Epoch 16/50
1060/1060 - 36s - loss: 2.6734 - accuracy100: 0.5582 - val_loss: 2.9516 - val_accuracy100: 0.5057 - 36s/epoch - 34ms/step
Epoch 17/50
1060/1060 - 36s - loss: 2.6671 - accuracy100: 0.5599 - val_loss: 2.9580 - val_accuracy100: 0.5043 - 36s/epoch - 34ms/step
testing model: results/EXC/W10/deepVOL_L3/h100
Evaluating performance on  test set...
5267/5267 - 71s - 71s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0114541
{'0': {'precision': 0.5041901459326686, 'recall': 0.4287350136256521, 'f1-score': 0.4634111683485988, 'support': 406953}, '1': {'precision': 0.5049488849449499, 'recall': 0.479424715502945, 'f1-score': 0.49185588763882343, 'support': 524610}, '2': {'precision': 0.4666509273936756, 'recall': 0.564568701905306, 'f1-score': 0.5109610035267679, 'support': 416626}, 'accuracy': 0.4904356881713172, 'macro avg': {'precision': 0.49192998609043137, 'recall': 0.490909477011301, 'f1-score': 0.48874268650473, 'support': 1348189}, 'weighted avg': {'precision': 0.4928847782210246, 'recall': 0.4904356881713172, 'f1-score': 0.48917378903292763, 'support': 1348189}}
[[174475 134895  97583]
 [101849 251511 171250]
 [ 69726 111686 235214]]
Evaluating performance on  train set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9310402
{'0': {'precision': 0.501378636872792, 'recall': 0.4907922852001799, 'f1-score': 0.49602898344817786, 'support': 71136}, '1': {'precision': 0.6033916107609948, 'recall': 0.555638757585685, 'f1-score': 0.5785314588764628, 'support': 128202}, '2': {'precision': 0.4849652399698467, 'recall': 0.5635036496350365, 'f1-score': 0.5212928783649949, 'support': 71925}, 'accuracy': 0.540718785827776, 'macro avg': {'precision': 0.5299118292012112, 'recall': 0.5366448974736339, 'f1-score': 0.5319511068965452, 'support': 271263}, 'weighted avg': {'precision': 0.5452391475438788, 'recall': 0.540718785827776, 'f1-score': 0.5417192839932174, 'support': 271263}}
[[34913 25163 11060]
 [24985 71234 31983]
 [ 9736 21659 40530]]
Evaluating performance on  val set...
404/404 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.94630766
{'0': {'precision': 0.4806070826306914, 'recall': 0.46858485026423957, 'f1-score': 0.4745198311232681, 'support': 25545}, '1': {'precision': 0.6255635968461698, 'recall': 0.5283354163411967, 'f1-score': 0.5728532559789111, 'support': 51208}, '2': {'precision': 0.4442427165186803, 'recall': 0.5875511199489738, 'f1-score': 0.5059446885500128, 'support': 26653}, 'accuracy': 0.5288377850414869, 'macro avg': {'precision': 0.5168044653318472, 'recall': 0.52815712885147, 'f1-score': 0.517772591884064, 'support': 103406}, 'weighted avg': {'precision': 0.5430184874811139, 'recall': 0.5288377850414869, 'f1-score': 0.5313156142016465, 'support': 103406}}
[[11970  8901  4674]
 [ 9236 27055 14917]
 [ 3700  7293 15660]]
training model: results/EXC/W10/deepVOL_L3/h200
Epoch 1/50
1060/1060 - 39s - loss: 3.2441 - accuracy200: 0.4077 - val_loss: 3.2153 - val_accuracy200: 0.4028 - 39s/epoch - 37ms/step
Epoch 2/50
1060/1060 - 37s - loss: 3.1744 - accuracy200: 0.4304 - val_loss: 3.2012 - val_accuracy200: 0.4113 - 37s/epoch - 35ms/step
Epoch 3/50
1060/1060 - 37s - loss: 3.1536 - accuracy200: 0.4359 - val_loss: 3.1884 - val_accuracy200: 0.4139 - 37s/epoch - 35ms/step
Epoch 4/50
1060/1060 - 36s - loss: 3.1394 - accuracy200: 0.4434 - val_loss: 3.1899 - val_accuracy200: 0.4231 - 36s/epoch - 34ms/step
Epoch 5/50
1060/1060 - 37s - loss: 3.0951 - accuracy200: 0.4592 - val_loss: 3.1507 - val_accuracy200: 0.4474 - 37s/epoch - 35ms/step
Epoch 6/50
1060/1060 - 37s - loss: 3.0544 - accuracy200: 0.4676 - val_loss: 3.1185 - val_accuracy200: 0.4507 - 37s/epoch - 35ms/step
Epoch 7/50
1060/1060 - 36s - loss: 3.0324 - accuracy200: 0.4706 - val_loss: 3.1240 - val_accuracy200: 0.4520 - 36s/epoch - 34ms/step
Epoch 8/50
1060/1060 - 37s - loss: 3.0166 - accuracy200: 0.4750 - val_loss: 3.1211 - val_accuracy200: 0.4486 - 37s/epoch - 35ms/step
Epoch 9/50
1060/1060 - 37s - loss: 3.0065 - accuracy200: 0.4790 - val_loss: 3.1215 - val_accuracy200: 0.4462 - 37s/epoch - 35ms/step
Epoch 10/50
1060/1060 - 36s - loss: 2.9951 - accuracy200: 0.4816 - val_loss: 3.1284 - val_accuracy200: 0.4500 - 36s/epoch - 34ms/step
Epoch 11/50
1060/1060 - 36s - loss: 2.9855 - accuracy200: 0.4849 - val_loss: 3.1375 - val_accuracy200: 0.4482 - 36s/epoch - 34ms/step
Epoch 12/50
1060/1060 - 36s - loss: 2.9772 - accuracy200: 0.4878 - val_loss: 3.1718 - val_accuracy200: 0.4426 - 36s/epoch - 34ms/step
Epoch 13/50
1060/1060 - 37s - loss: 2.9701 - accuracy200: 0.4896 - val_loss: 3.1502 - val_accuracy200: 0.4446 - 37s/epoch - 35ms/step
Epoch 14/50
1060/1060 - 36s - loss: 2.9616 - accuracy200: 0.4926 - val_loss: 3.1822 - val_accuracy200: 0.4409 - 36s/epoch - 34ms/step
Epoch 15/50
1060/1060 - 36s - loss: 2.9555 - accuracy200: 0.4939 - val_loss: 3.2023 - val_accuracy200: 0.4385 - 36s/epoch - 34ms/step
Epoch 16/50
1060/1060 - 36s - loss: 2.9467 - accuracy200: 0.4977 - val_loss: 3.2210 - val_accuracy200: 0.4335 - 36s/epoch - 34ms/step
testing model: results/EXC/W10/deepVOL_L3/h200
Evaluating performance on  test set...
5267/5267 - 72s - 72s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0549715
{'0': {'precision': 0.48281212539161306, 'recall': 0.37185187336745557, 'f1-score': 0.420129064923923, 'support': 481993}, '1': {'precision': 0.3295195837892061, 'recall': 0.35619742161040097, 'f1-score': 0.34233955171476904, 'support': 366120}, '2': {'precision': 0.47311887158964017, 'recall': 0.5498764187843448, 'f1-score': 0.5086180028725135, 'support': 500076}, 'accuracy': 0.43363430498246164, 'macro avg': {'precision': 0.4284835269234864, 'recall': 0.4259752379207338, 'f1-score': 0.4236955398370685, 'support': 1348189}, 'weighted avg': {'precision': 0.4375878809275589, 'recall': 0.43363430498246164, 'f1-score': 0.4318269036968576, 'support': 1348189}}
[[179230 145443 157320]
 [ 86802 130411 148907]
 [105189 119907 274980]]
Evaluating performance on  train set...
1060/1060 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0270598
{'0': {'precision': 0.4865312659643503, 'recall': 0.39101632286199356, 'f1-score': 0.4335757262559522, 'support': 90119}, '1': {'precision': 0.4040098413861697, 'recall': 0.42816248183119376, 'f1-score': 0.41573566326585576, 'support': 90127}, '2': {'precision': 0.4752470456151218, 'recall': 0.5394926222573805, 'f1-score': 0.5053360639710196, 'support': 91017}, 'accuracy': 0.4531764376269524, 'macro avg': {'precision': 0.455262717655214, 'recall': 0.4528904756501893, 'f1-score': 0.4515491511642759, 'support': 271263}, 'weighted avg': {'precision': 0.4553273630491594, 'recall': 0.4531764376269524, 'f1-score': 0.451726153334853, 'support': 271263}}
[[35238 31789 23092]
 [20412 38589 31126]
 [16777 25137 49103]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0387189
{'0': {'precision': 0.46749820100743583, 'recall': 0.3600480310354383, 'f1-score': 0.40679734924251654, 'support': 32479}, '1': {'precision': 0.4314204873224734, 'recall': 0.43457206895597555, 'f1-score': 0.43299054340933524, 'support': 36139}, '2': {'precision': 0.45862011479196935, 'recall': 0.5535529492928596, 'f1-score': 0.501634604113211, 'support': 34788}, 'accuracy': 0.45119238728893873, 'macro avg': {'precision': 0.4525129343739595, 'recall': 0.4493910164280912, 'f1-score': 0.447140832255021, 'support': 103406}, 'weighted avg': {'precision': 0.4519027485373229, 'recall': 0.45119238728893873, 'f1-score': 0.44785680678304973, 'support': 103406}}
[[11694 11585  9200]
 [ 6902 15705 13532]
 [ 6418  9113 19257]]
training model: results/EXC/W10/deepVOL_L3/h300
Epoch 1/50
1060/1060 - 39s - loss: 3.2730 - accuracy300: 0.3892 - val_loss: 3.2491 - val_accuracy300: 0.3930 - 39s/epoch - 37ms/step
Epoch 2/50
1060/1060 - 39s - loss: 3.2228 - accuracy300: 0.4093 - val_loss: 3.2197 - val_accuracy300: 0.3994 - 39s/epoch - 37ms/step
Epoch 3/50
1060/1060 - 41s - loss: 3.2067 - accuracy300: 0.4136 - val_loss: 3.2237 - val_accuracy300: 0.4017 - 41s/epoch - 39ms/step
Epoch 4/50
1060/1060 - 35s - loss: 3.1975 - accuracy300: 0.4195 - val_loss: 3.2234 - val_accuracy300: 0.4004 - 35s/epoch - 33ms/step
Epoch 5/50
1060/1060 - 36s - loss: 3.1885 - accuracy300: 0.4232 - val_loss: 3.2253 - val_accuracy300: 0.3997 - 36s/epoch - 34ms/step
Epoch 6/50
1060/1060 - 36s - loss: 3.1794 - accuracy300: 0.4269 - val_loss: 3.2333 - val_accuracy300: 0.3978 - 36s/epoch - 34ms/step
Epoch 7/50
1060/1060 - 38s - loss: 3.1693 - accuracy300: 0.4328 - val_loss: 3.2397 - val_accuracy300: 0.3990 - 38s/epoch - 35ms/step
Epoch 8/50
1060/1060 - 36s - loss: 3.1617 - accuracy300: 0.4351 - val_loss: 3.2392 - val_accuracy300: 0.4008 - 36s/epoch - 34ms/step
Epoch 9/50
1060/1060 - 36s - loss: 3.1531 - accuracy300: 0.4379 - val_loss: 3.2311 - val_accuracy300: 0.4034 - 36s/epoch - 34ms/step
Epoch 10/50
1060/1060 - 36s - loss: 3.1425 - accuracy300: 0.4446 - val_loss: 3.2412 - val_accuracy300: 0.4047 - 36s/epoch - 34ms/step
Epoch 11/50
1060/1060 - 35s - loss: 3.1318 - accuracy300: 0.4482 - val_loss: 3.2611 - val_accuracy300: 0.4059 - 35s/epoch - 33ms/step
Epoch 12/50
1060/1060 - 37s - loss: 3.1247 - accuracy300: 0.4516 - val_loss: 3.2833 - val_accuracy300: 0.4015 - 37s/epoch - 35ms/step
testing model: results/EXC/W10/deepVOL_L3/h300
Evaluating performance on  test set...
5267/5267 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0847455
{'0': {'precision': 0.4443766795631706, 'recall': 0.3047697060271621, 'f1-score': 0.3615649827612052, 'support': 459022}, '1': {'precision': 0.3242434691842422, 'recall': 0.33365460691936993, 'f1-score': 0.32888172556322565, 'support': 417090}, '2': {'precision': 0.4271813485738498, 'recall': 0.546720132520754, 'f1-score': 0.47961451550560463, 'support': 472077}, 'accuracy': 0.3984263333998423, 'macro avg': {'precision': 0.39860049910708756, 'recall': 0.3950481484890953, 'f1-score': 0.39002040794334514, 'support': 1348189}, 'weighted avg': {'precision': 0.4011899446288307, 'recall': 0.3984263333998423, 'f1-score': 0.39278954365338914, 'support': 1348189}}
[[139896 154303 164823]
 [ 96664 139164 181262]
 [ 78254 135729 258094]]
Evaluating performance on  train set...
1060/1060 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.072286
{'0': {'precision': 0.4380838038946646, 'recall': 0.36831013254949807, 'f1-score': 0.4001783659031882, 'support': 90155}, '1': {'precision': 0.33111089441993125, 'recall': 0.3036111452616991, 'f1-score': 0.3167652974958458, 'support': 89473}, '2': {'precision': 0.4337491734626405, 'recall': 0.5368909259562394, 'f1-score': 0.4798400468155662, 'support': 91635}, 'accuracy': 0.40391796890840254, 'macro avg': {'precision': 0.40098129059241217, 'recall': 0.40293740125581223, 'f1-score': 0.3989279034048667, 'support': 271263}, 'weighted avg': {'precision': 0.40133573656122307, 'recall': 0.40391796890840254, 'f1-score': 0.39957592716585805, 'support': 271263}}
[[33205 29337 27613]
 [25694 27165 36614]
 [16897 25540 49198]]
Evaluating performance on  val set...
404/404 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.07256
{'0': {'precision': 0.40933861778548425, 'recall': 0.3134285894923184, 'f1-score': 0.35502005156115723, 'support': 31634}, '1': {'precision': 0.37604363459077333, 'recall': 0.329911513887775, 'f1-score': 0.35147027411890347, 'support': 37407}, '2': {'precision': 0.4143984816460337, 'recall': 0.559115379019351, 'f1-score': 0.47600054501988076, 'support': 34365}, 'accuracy': 0.40104055857493764, 'macro avg': {'precision': 0.39992691134076375, 'recall': 0.40081849413314813, 'f1-score': 0.3941636235666472, 'support': 103406}, 'weighted avg': {'precision': 0.3989757450818039, 'recall': 0.40104055857493764, 'f1-score': 0.39394146939887115, 'support': 103406}}
[[ 9915 11048 10671]
 [ 8585 12341 16481]
 [ 5722  9429 19214]]
training model: results/EXC/W10/deepVOL_L3/h500
Epoch 1/50
1060/1060 - 39s - loss: 3.2805 - accuracy500: 0.3900 - val_loss: 3.2769 - val_accuracy500: 0.3769 - 39s/epoch - 36ms/step
Epoch 2/50
1060/1060 - 36s - loss: 3.2470 - accuracy500: 0.4001 - val_loss: 3.2540 - val_accuracy500: 0.3998 - 36s/epoch - 34ms/step
Epoch 3/50
1060/1060 - 36s - loss: 3.2302 - accuracy500: 0.4099 - val_loss: 3.2548 - val_accuracy500: 0.3978 - 36s/epoch - 34ms/step
Epoch 4/50
1060/1060 - 36s - loss: 3.2210 - accuracy500: 0.4132 - val_loss: 3.2555 - val_accuracy500: 0.4002 - 36s/epoch - 34ms/step
Epoch 5/50
1060/1060 - 36s - loss: 3.2132 - accuracy500: 0.4161 - val_loss: 3.2584 - val_accuracy500: 0.3964 - 36s/epoch - 34ms/step
Epoch 6/50
1060/1060 - 36s - loss: 3.2058 - accuracy500: 0.4200 - val_loss: 3.2707 - val_accuracy500: 0.3931 - 36s/epoch - 34ms/step
Epoch 7/50
1060/1060 - 36s - loss: 3.1999 - accuracy500: 0.4220 - val_loss: 3.2686 - val_accuracy500: 0.3929 - 36s/epoch - 34ms/step
Epoch 8/50
1060/1060 - 36s - loss: 3.1909 - accuracy500: 0.4260 - val_loss: 3.2634 - val_accuracy500: 0.3958 - 36s/epoch - 34ms/step
Epoch 9/50
1060/1060 - 36s - loss: 3.1792 - accuracy500: 0.4308 - val_loss: 3.2698 - val_accuracy500: 0.3926 - 36s/epoch - 34ms/step
Epoch 10/50
1060/1060 - 36s - loss: 3.1665 - accuracy500: 0.4357 - val_loss: 3.2791 - val_accuracy500: 0.3896 - 36s/epoch - 34ms/step
Epoch 11/50
1060/1060 - 35s - loss: 3.1587 - accuracy500: 0.4395 - val_loss: 3.2896 - val_accuracy500: 0.3894 - 35s/epoch - 33ms/step
Epoch 12/50
1060/1060 - 38s - loss: 3.1393 - accuracy500: 0.4471 - val_loss: 3.3135 - val_accuracy500: 0.3789 - 38s/epoch - 36ms/step
testing model: results/EXC/W10/deepVOL_L3/h500
Evaluating performance on  test set...
5267/5267 - 89s - 89s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0952804
{'0': {'precision': 0.3953856991898556, 'recall': 0.38484093902813116, 'f1-score': 0.390042062911485, 'support': 443352}, '1': {'precision': 0.36399647125979484, 'recall': 0.04665615722479785, 'f1-score': 0.0827106679192035, 'support': 451023}, '2': {'precision': 0.3679571520055889, 'recall': 0.6963645898980639, 'f1-score': 0.4814941218773426, 'support': 453814}, 'accuracy': 0.37656663865377926, 'macro avg': {'precision': 0.3757797741517464, 'recall': 0.3759538953836643, 'f1-score': 0.31808228423601037, 'support': 1348189}, 'weighted avg': {'precision': 0.37565202500872774, 'recall': 0.37656663865377926, 'f1-score': 0.3180111361823157, 'support': 1348189}}
[[170620  20104 252628]
 [139778  21043 290202]
 [121130  16664 316020]]
Evaluating performance on  train set...
1060/1060 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0813279
{'0': {'precision': 0.40847379218794, 'recall': 0.45387701281721776, 'f1-score': 0.4299801508535133, 'support': 89489}, '1': {'precision': 0.3629191321499014, 'recall': 0.03897479347595848, 'f1-score': 0.0703902065799541, 'support': 89699}, '2': {'precision': 0.396716278037412, 'recall': 0.698832473527016, 'f1-score': 0.5061175369392259, 'support': 92075}, 'accuracy': 0.3998259991226227, 'macro avg': {'precision': 0.3893697341250845, 'recall': 0.3972280932733974, 'f1-score': 0.33549596479089777, 'support': 271263}, 'weighted avg': {'precision': 0.38941929317347107, 'recall': 0.3998259991226227, 'f1-score': 0.3369172982434928, 'support': 271263}}
[[40617  3334 45538]
 [33892  3496 52311]
 [24927  2803 64345]]
Evaluating performance on  val set...
404/404 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0841699
{'0': {'precision': 0.3951668105115919, 'recall': 0.40356209348975747, 'f1-score': 0.39932033141362044, 'support': 32902}, '1': {'precision': 0.3298786653185035, 'recall': 0.03927765237020316, 'f1-score': 0.07019714370242866, 'support': 33225}, '2': {'precision': 0.4046986286807696, 'recall': 0.7148528662249524, 'f1-score': 0.5168140563183616, 'support': 37279}, 'accuracy': 0.39873895131810533, 'macro avg': {'precision': 0.37658136817028837, 'recall': 0.3858975373616376, 'f1-score': 0.3287771771448036, 'support': 103406}, 'weighted avg': {'precision': 0.37762564293416323, 'recall': 0.39873895131810533, 'f1-score': 0.33592875509328607, 'support': 103406}}
[[13278  1442 18182]
 [10902  1305 21018]
 [ 9421  1209 26649]]
training model: results/EXC/W10/deepVOL_L3/h1000
Epoch 1/50
1060/1060 - 39s - loss: 3.2472 - accuracy1000: 0.4114 - val_loss: 3.3154 - val_accuracy1000: 0.4441 - 39s/epoch - 36ms/step
Epoch 2/50
1060/1060 - 36s - loss: 3.2266 - accuracy1000: 0.4220 - val_loss: 3.2811 - val_accuracy1000: 0.4440 - 36s/epoch - 34ms/step
Epoch 3/50
1060/1060 - 39s - loss: 3.2258 - accuracy1000: 0.4226 - val_loss: 3.2834 - val_accuracy1000: 0.4440 - 39s/epoch - 37ms/step
Epoch 4/50
1060/1060 - 35s - loss: 3.2224 - accuracy1000: 0.4243 - val_loss: 3.2300 - val_accuracy1000: 0.4440 - 35s/epoch - 33ms/step
Epoch 5/50
1060/1060 - 36s - loss: 3.2129 - accuracy1000: 0.4303 - val_loss: 3.2173 - val_accuracy1000: 0.4430 - 36s/epoch - 34ms/step
Epoch 6/50
1060/1060 - 35s - loss: 3.2100 - accuracy1000: 0.4296 - val_loss: 3.2662 - val_accuracy1000: 0.4439 - 35s/epoch - 33ms/step
Epoch 7/50
1060/1060 - 36s - loss: 3.2110 - accuracy1000: 0.4310 - val_loss: 3.2808 - val_accuracy1000: 0.4431 - 36s/epoch - 34ms/step
Epoch 8/50
1060/1060 - 35s - loss: 3.1994 - accuracy1000: 0.4360 - val_loss: 3.2584 - val_accuracy1000: 0.4428 - 35s/epoch - 33ms/step
Epoch 9/50
1060/1060 - 36s - loss: 3.1853 - accuracy1000: 0.4413 - val_loss: 3.2641 - val_accuracy1000: 0.4412 - 36s/epoch - 34ms/step
Epoch 10/50
1060/1060 - 36s - loss: 3.1811 - accuracy1000: 0.4420 - val_loss: 3.2613 - val_accuracy1000: 0.4418 - 36s/epoch - 34ms/step
Epoch 11/50
1060/1060 - 36s - loss: 3.1808 - accuracy1000: 0.4416 - val_loss: 3.2460 - val_accuracy1000: 0.4332 - 36s/epoch - 34ms/step
Epoch 12/50
1060/1060 - 36s - loss: 3.1674 - accuracy1000: 0.4459 - val_loss: 3.2581 - val_accuracy1000: 0.4371 - 36s/epoch - 34ms/step
Epoch 13/50
1060/1060 - 37s - loss: 3.1578 - accuracy1000: 0.4488 - val_loss: 3.3007 - val_accuracy1000: 0.4343 - 37s/epoch - 34ms/step
Epoch 14/50
1060/1060 - 37s - loss: 3.1350 - accuracy1000: 0.4592 - val_loss: 3.3059 - val_accuracy1000: 0.4224 - 37s/epoch - 35ms/step
Epoch 15/50
1060/1060 - 38s - loss: 3.1232 - accuracy1000: 0.4656 - val_loss: 3.3500 - val_accuracy1000: 0.4080 - 38s/epoch - 36ms/step
testing model: results/EXC/W10/deepVOL_L3/h1000
Evaluating performance on  test set...
5267/5267 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.094952
{'0': {'precision': 0.33909348441926346, 'recall': 0.0031015264070228714, 'f1-score': 0.006146830684855534, 'support': 385939}, '1': {'precision': 0.4233745143879875, 'recall': 0.9856048187526985, 'f1-score': 0.5923152337341189, 'support': 569774}, '2': {'precision': 0.3461074561403509, 'recall': 0.01608505997818975, 'f1-score': 0.030741436905306833, 'support': 392476}, 'accuracy': 0.4221084729218233, 'macro avg': {'precision': 0.36952515164920063, 'recall': 0.3349304683793037, 'f1-score': 0.20973450044142708, 'support': 1348189}, 'weighted avg': {'precision': 0.376754342900237, 'recall': 0.4221084729218233, 'f1-score': 0.2610341709242202, 'support': 1348189}}
[[  1197 379387   5355]
 [  1630 561572   6572]
 [   703 385460   6313]]
Evaluating performance on  train set...
1060/1060 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1457508
{'0': {'precision': 0.49491525423728816, 'recall': 0.006542537698012592, 'f1-score': 0.012914353950598175, 'support': 89262}, '1': {'precision': 0.33058847233001015, 'recall': 0.9901546645210317, 'f1-score': 0.49568111888111893, 'support': 89484}, '2': {'precision': 0.4784712143202709, 'recall': 0.010689927256612297, 'f1-score': 0.02091262792861372, 'support': 92517}, 'accuracy': 0.3324301508130486, 'macro avg': {'precision': 0.4346583136291897, 'recall': 0.3357957098252189, 'f1-score': 0.1765027002534436, 'support': 271263}, 'weighted avg': {'precision': 0.43509887311198336, 'recall': 0.3324301508130486, 'f1-score': 0.1748969225525335, 'support': 271263}}
[[  584 88131   547]
 [  350 88603   531]
 [  246 91282   989]]
Evaluating performance on  val set...
404/404 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0736784
{'0': {'precision': 0.30612244897959184, 'recall': 0.003976971441557457, 'f1-score': 0.007851934941110488, 'support': 26402}, '1': {'precision': 0.44428574223717937, 'recall': 0.9891531625718767, 'f1-score': 0.613164112603794, 'support': 45912}, '2': {'precision': 0.33254437869822484, 'recall': 0.009037694583815772, 'f1-score': 0.017597144377994176, 'support': 31092}, 'accuracy': 0.4429143376593234, 'macro avg': {'precision': 0.3609841899716654, 'recall': 0.33405594286574997, 'f1-score': 0.21287106397429956, 'support': 103406}, 'weighted avg': {'precision': 0.3754111146165384, 'recall': 0.4429143376593234, 'f1-score': 0.279539175068963, 'support': 103406}}
[[  105 26052   245]
 [  179 45414   319]
 [   59 30752   281]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        20 (peak)  17.47 (ave)

============================================
