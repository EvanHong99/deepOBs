This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/LILAK_orderbooks/LILAK_orderbooks_2019-06-26.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-06-18.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-06-05.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-06-06.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-06-14.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-06-10.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-06-12.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-06-07.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-06-28.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-06-11.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-06-24.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-06-13.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-06-04.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-06-20.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-06-19.csv
training model: results/LILAK/W4/deepLOB_L1/h10
Epoch 1/50
254/254 - 17s - loss: 3.3406 - accuracy10: 0.3584 - val_loss: 3.4148 - val_accuracy10: 0.3505 - 17s/epoch - 69ms/step
Epoch 2/50
254/254 - 5s - loss: 3.2992 - accuracy10: 0.3620 - val_loss: 3.3888 - val_accuracy10: 0.3367 - 5s/epoch - 19ms/step
Epoch 3/50
254/254 - 5s - loss: 3.2608 - accuracy10: 0.3718 - val_loss: 3.3860 - val_accuracy10: 0.3909 - 5s/epoch - 19ms/step
Epoch 4/50
254/254 - 5s - loss: 3.2448 - accuracy10: 0.3798 - val_loss: 3.3569 - val_accuracy10: 0.3755 - 5s/epoch - 19ms/step
Epoch 5/50
254/254 - 5s - loss: 3.2263 - accuracy10: 0.3919 - val_loss: 3.3632 - val_accuracy10: 0.3646 - 5s/epoch - 18ms/step
Epoch 6/50
254/254 - 5s - loss: 3.2104 - accuracy10: 0.4019 - val_loss: 3.3559 - val_accuracy10: 0.3951 - 5s/epoch - 19ms/step
Epoch 7/50
254/254 - 5s - loss: 3.1997 - accuracy10: 0.4054 - val_loss: 3.3581 - val_accuracy10: 0.3911 - 5s/epoch - 18ms/step
Epoch 8/50
254/254 - 5s - loss: 3.1868 - accuracy10: 0.4171 - val_loss: 3.3317 - val_accuracy10: 0.3885 - 5s/epoch - 18ms/step
Epoch 9/50
254/254 - 5s - loss: 3.1798 - accuracy10: 0.4205 - val_loss: 3.3857 - val_accuracy10: 0.4148 - 5s/epoch - 18ms/step
Epoch 10/50
254/254 - 4s - loss: 3.1725 - accuracy10: 0.4261 - val_loss: 3.3482 - val_accuracy10: 0.3975 - 4s/epoch - 18ms/step
Epoch 11/50
254/254 - 4s - loss: 3.1604 - accuracy10: 0.4344 - val_loss: 3.3815 - val_accuracy10: 0.4129 - 4s/epoch - 18ms/step
Epoch 12/50
254/254 - 5s - loss: 3.1532 - accuracy10: 0.4393 - val_loss: 3.3655 - val_accuracy10: 0.4044 - 5s/epoch - 18ms/step
Epoch 13/50
254/254 - 5s - loss: 3.1494 - accuracy10: 0.4425 - val_loss: 3.3580 - val_accuracy10: 0.4151 - 5s/epoch - 18ms/step
Epoch 14/50
254/254 - 4s - loss: 3.1507 - accuracy10: 0.4420 - val_loss: 3.3511 - val_accuracy10: 0.4140 - 4s/epoch - 17ms/step
Epoch 15/50
254/254 - 4s - loss: 3.1433 - accuracy10: 0.4465 - val_loss: 3.3631 - val_accuracy10: 0.4159 - 4s/epoch - 18ms/step
Epoch 16/50
254/254 - 5s - loss: 3.1355 - accuracy10: 0.4500 - val_loss: 3.3371 - val_accuracy10: 0.4158 - 5s/epoch - 18ms/step
Epoch 17/50
254/254 - 4s - loss: 3.1317 - accuracy10: 0.4521 - val_loss: 3.3849 - val_accuracy10: 0.4252 - 4s/epoch - 17ms/step
Epoch 18/50
254/254 - 4s - loss: 3.1294 - accuracy10: 0.4517 - val_loss: 3.3207 - val_accuracy10: 0.4210 - 4s/epoch - 18ms/step
Epoch 19/50
254/254 - 4s - loss: 3.1263 - accuracy10: 0.4538 - val_loss: 3.3894 - val_accuracy10: 0.4299 - 4s/epoch - 17ms/step
Epoch 20/50
254/254 - 4s - loss: 3.1219 - accuracy10: 0.4546 - val_loss: 3.3361 - val_accuracy10: 0.4031 - 4s/epoch - 17ms/step
Epoch 21/50
254/254 - 5s - loss: 3.1174 - accuracy10: 0.4572 - val_loss: 3.3188 - val_accuracy10: 0.4046 - 5s/epoch - 18ms/step
Epoch 22/50
254/254 - 4s - loss: 3.1141 - accuracy10: 0.4589 - val_loss: 3.3456 - val_accuracy10: 0.4037 - 4s/epoch - 18ms/step
Epoch 23/50
254/254 - 4s - loss: 3.1085 - accuracy10: 0.4595 - val_loss: 3.3620 - val_accuracy10: 0.4194 - 4s/epoch - 18ms/step
Epoch 24/50
254/254 - 5s - loss: 3.1017 - accuracy10: 0.4628 - val_loss: 3.3505 - val_accuracy10: 0.4133 - 5s/epoch - 18ms/step
Epoch 25/50
254/254 - 5s - loss: 3.0962 - accuracy10: 0.4629 - val_loss: 3.3693 - val_accuracy10: 0.4006 - 5s/epoch - 18ms/step
Epoch 26/50
254/254 - 5s - loss: 3.0912 - accuracy10: 0.4645 - val_loss: 3.3816 - val_accuracy10: 0.4156 - 5s/epoch - 18ms/step
Epoch 27/50
254/254 - 5s - loss: 3.0881 - accuracy10: 0.4664 - val_loss: 3.3585 - val_accuracy10: 0.4073 - 5s/epoch - 18ms/step
Epoch 28/50
254/254 - 4s - loss: 3.0842 - accuracy10: 0.4671 - val_loss: 3.3707 - val_accuracy10: 0.4156 - 4s/epoch - 18ms/step
Epoch 29/50
254/254 - 4s - loss: 3.0819 - accuracy10: 0.4675 - val_loss: 3.3505 - val_accuracy10: 0.4147 - 4s/epoch - 17ms/step
Epoch 30/50
254/254 - 4s - loss: 3.0802 - accuracy10: 0.4704 - val_loss: 3.3377 - val_accuracy10: 0.4141 - 4s/epoch - 18ms/step
Epoch 31/50
254/254 - 4s - loss: 3.0727 - accuracy10: 0.4707 - val_loss: 3.3556 - val_accuracy10: 0.4046 - 4s/epoch - 17ms/step
testing model: results/LILAK/W4/deepLOB_L1/h10
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0746477
{'0': {'precision': 0.4322245802777836, 'recall': 0.4473586916335008, 'f1-score': 0.439661437182063, 'support': 45981}, '1': {'precision': 0.3821829035467477, 'recall': 0.31353128033177446, 'f1-score': 0.34446989251220905, 'support': 45332}, '2': {'precision': 0.42769017234067164, 'recall': 0.4893143071392338, 'f1-score': 0.4564316206346757, 'support': 45341}, 'accuracy': 0.4168849795834736, 'macro avg': {'precision': 0.4140325520550676, 'recall': 0.41673475970150303, 'f1-score': 0.41352098344298255, 'support': 136654}, 'weighted avg': {'precision': 0.41411984949897057, 'recall': 0.4168849795834736, 'f1-score': 0.41364795631030726, 'support': 136654}}
[[20570 11829 13582]
 [15013 14213 16106]
 [12008 11147 22186]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0581996
{'0': {'precision': 0.3691559262067223, 'recall': 0.3389014558320283, 'f1-score': 0.3533823218119689, 'support': 17241}, '1': {'precision': 0.546983758700696, 'recall': 0.43967096280014656, 'f1-score': 0.4874914609604343, 'support': 30027}, '2': {'precision': 0.36412782316194137, 'recall': 0.5146592709984152, 'f1-score': 0.42650093808630396, 'support': 17668}, 'accuracy': 0.433318960206973, 'macro avg': {'precision': 0.4267558360231199, 'recall': 0.4310772298768633, 'f1-score': 0.42245824028623574, 'support': 64936}, 'weighted avg': {'precision': 0.45001707875232666, 'recall': 0.433318960206973, 'f1-score': 0.4352899667784886, 'support': 64936}}
[[ 5843  5769  5629]
 [ 6575 13202 10250]
 [ 3410  5165  9093]]
Evaluating performance on  val set...
81/81 - 1s - 627ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0803902
{'0': {'precision': 0.37525110486139013, 'recall': 0.3209070606425013, 'f1-score': 0.3459579590702843, 'support': 5821}, '1': {'precision': 0.48628723090533765, 'recall': 0.36820363961147706, 'f1-score': 0.41908634601944217, 'support': 8957}, '2': {'precision': 0.3553121824545557, 'recall': 0.5389621510532625, 'f1-score': 0.42827980402830695, 'support': 5839}, 'accuracy': 0.4032109424261532, 'macro avg': {'precision': 0.4056168394070945, 'recall': 0.4093576171024136, 'f1-score': 0.3977747030393444, 'support': 20617}, 'weighted avg': {'precision': 0.4178434904190431, 'recall': 0.4032109424261532, 'f1-score': 0.4010429963993574, 'support': 20617}}
[[1868 1837 2116]
 [2065 3298 3594]
 [1045 1647 3147]]
training model: results/LILAK/W4/deepLOB_L1/h20
Epoch 1/50
254/254 - 7s - loss: 3.3469 - accuracy20: 0.3517 - val_loss: 3.3603 - val_accuracy20: 0.3512 - 7s/epoch - 27ms/step
Epoch 2/50
254/254 - 5s - loss: 3.2981 - accuracy20: 0.3690 - val_loss: 3.3658 - val_accuracy20: 0.3499 - 5s/epoch - 18ms/step
Epoch 3/50
254/254 - 5s - loss: 3.2751 - accuracy20: 0.3829 - val_loss: 3.3371 - val_accuracy20: 0.3555 - 5s/epoch - 18ms/step
Epoch 4/50
254/254 - 5s - loss: 3.2553 - accuracy20: 0.3936 - val_loss: 3.3268 - val_accuracy20: 0.3586 - 5s/epoch - 18ms/step
Epoch 5/50
254/254 - 5s - loss: 3.2392 - accuracy20: 0.4038 - val_loss: 3.3181 - val_accuracy20: 0.3734 - 5s/epoch - 19ms/step
Epoch 6/50
254/254 - 5s - loss: 3.2272 - accuracy20: 0.4158 - val_loss: 3.3508 - val_accuracy20: 0.3689 - 5s/epoch - 18ms/step
Epoch 7/50
254/254 - 5s - loss: 3.2198 - accuracy20: 0.4159 - val_loss: 3.2918 - val_accuracy20: 0.3837 - 5s/epoch - 18ms/step
Epoch 8/50
254/254 - 4s - loss: 3.2107 - accuracy20: 0.4237 - val_loss: 3.3045 - val_accuracy20: 0.3760 - 4s/epoch - 18ms/step
Epoch 9/50
254/254 - 5s - loss: 3.1980 - accuracy20: 0.4307 - val_loss: 3.2786 - val_accuracy20: 0.3917 - 5s/epoch - 18ms/step
Epoch 10/50
254/254 - 4s - loss: 3.1947 - accuracy20: 0.4323 - val_loss: 3.2920 - val_accuracy20: 0.3837 - 4s/epoch - 18ms/step
Epoch 11/50
254/254 - 5s - loss: 3.1835 - accuracy20: 0.4390 - val_loss: 3.3061 - val_accuracy20: 0.3846 - 5s/epoch - 18ms/step
Epoch 12/50
254/254 - 5s - loss: 3.1769 - accuracy20: 0.4421 - val_loss: 3.2999 - val_accuracy20: 0.3873 - 5s/epoch - 19ms/step
Epoch 13/50
254/254 - 5s - loss: 3.1702 - accuracy20: 0.4437 - val_loss: 3.3822 - val_accuracy20: 0.3715 - 5s/epoch - 18ms/step
Epoch 14/50
254/254 - 5s - loss: 3.1666 - accuracy20: 0.4460 - val_loss: 3.3255 - val_accuracy20: 0.3789 - 5s/epoch - 18ms/step
Epoch 15/50
254/254 - 5s - loss: 3.1620 - accuracy20: 0.4479 - val_loss: 3.3409 - val_accuracy20: 0.3776 - 5s/epoch - 18ms/step
Epoch 16/50
254/254 - 5s - loss: 3.1605 - accuracy20: 0.4491 - val_loss: 3.3026 - val_accuracy20: 0.3801 - 5s/epoch - 18ms/step
Epoch 17/50
254/254 - 5s - loss: 3.1532 - accuracy20: 0.4485 - val_loss: 3.3168 - val_accuracy20: 0.3826 - 5s/epoch - 18ms/step
Epoch 18/50
254/254 - 5s - loss: 3.1482 - accuracy20: 0.4522 - val_loss: 3.3410 - val_accuracy20: 0.3782 - 5s/epoch - 18ms/step
Epoch 19/50
254/254 - 5s - loss: 3.1405 - accuracy20: 0.4548 - val_loss: 3.3250 - val_accuracy20: 0.3803 - 5s/epoch - 18ms/step
testing model: results/LILAK/W4/deepLOB_L1/h20
Evaluating performance on  test set...
534/534 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0896715
{'0': {'precision': 0.4621889807279604, 'recall': 0.41257136354152835, 'f1-score': 0.4359729821818692, 'support': 52723}, '1': {'precision': 0.2688638334778838, 'recall': 0.331321513894128, 'f1-score': 0.29684287605260934, 'support': 31812}, '2': {'precision': 0.453412451130207, 'recall': 0.43836220955889404, 'f1-score': 0.44576033090100287, 'support': 52119}, 'accuracy': 0.4034934945190042, 'macro avg': {'precision': 0.39482175511201706, 'recall': 0.39408502899818343, 'f1-score': 0.39285872971182717, 'support': 136654}, 'weighted avg': {'precision': 0.4138370588638017, 'recall': 0.4034934945190042, 'f1-score': 0.40731739867687494, 'support': 136654}}
[[21752 14178 16793]
 [10523 10540 10749]
 [14788 14484 22847]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0814689
{'0': {'precision': 0.41546729260609055, 'recall': 0.32517888222780894, 'f1-score': 0.3648197868358962, 'support': 20684}, '1': {'precision': 0.43283582089552236, 'recall': 0.40432206343673754, 'f1-score': 0.4180933501531807, 'support': 22952}, '2': {'precision': 0.39107188632951256, 'recall': 0.5013615023474178, 'f1-score': 0.43940173226078544, 'support': 21300}, 'accuracy': 0.41094308241961314, 'macro avg': {'precision': 0.4131249999437085, 'recall': 0.4102874826706548, 'f1-score': 0.40743828974995416, 'support': 64936}, 'weighted avg': {'precision': 0.4136042321713229, 'recall': 0.41094308241961314, 'f1-score': 0.40811364945152473, 'support': 64936}}
[[ 6726  6304  7654]
 [ 4698  9280  8974]
 [ 4765  5856 10679]]
Evaluating performance on  val set...
81/81 - 1s - 621ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0912762
{'0': {'precision': 0.3991914449660929, 'recall': 0.4384130621598396, 'f1-score': 0.4178839590443686, 'support': 6982}, '1': {'precision': 0.380293571790113, 'recall': 0.3350178359096314, 'f1-score': 0.35622283682339, 'support': 6728}, '2': {'precision': 0.4013101680432925, 'recall': 0.407991892283191, 'f1-score': 0.40462344748366713, 'support': 6907}, 'accuracy': 0.39448028326138623, 'macro avg': {'precision': 0.3935983949331661, 'recall': 0.39380759678422067, 'f1-score': 0.39291008111714193, 'support': 20617}, 'weighted avg': {'precision': 0.39373425573226767, 'recall': 0.39448028326138623, 'f1-score': 0.39331945481715275, 'support': 20617}}
[[3061 1868 2053]
 [2323 2254 2151]
 [2284 1805 2818]]
training model: results/LILAK/W4/deepLOB_L1/h30
Epoch 1/50
254/254 - 7s - loss: 3.3526 - accuracy30: 0.3485 - val_loss: 3.4009 - val_accuracy30: 0.3309 - 7s/epoch - 27ms/step
Epoch 2/50
254/254 - 5s - loss: 3.3230 - accuracy30: 0.3532 - val_loss: 3.3445 - val_accuracy30: 0.3427 - 5s/epoch - 19ms/step
Epoch 3/50
254/254 - 5s - loss: 3.2917 - accuracy30: 0.3719 - val_loss: 3.4002 - val_accuracy30: 0.3330 - 5s/epoch - 19ms/step
Epoch 4/50
254/254 - 5s - loss: 3.2801 - accuracy30: 0.3791 - val_loss: 3.3281 - val_accuracy30: 0.3625 - 5s/epoch - 19ms/step
Epoch 5/50
254/254 - 5s - loss: 3.2641 - accuracy30: 0.3895 - val_loss: 3.3356 - val_accuracy30: 0.3561 - 5s/epoch - 18ms/step
Epoch 6/50
254/254 - 5s - loss: 3.2532 - accuracy30: 0.3959 - val_loss: 3.3206 - val_accuracy30: 0.3646 - 5s/epoch - 19ms/step
Epoch 7/50
254/254 - 5s - loss: 3.2430 - accuracy30: 0.4017 - val_loss: 3.3024 - val_accuracy30: 0.3804 - 5s/epoch - 18ms/step
Epoch 8/50
254/254 - 4s - loss: 3.2371 - accuracy30: 0.4065 - val_loss: 3.3125 - val_accuracy30: 0.3823 - 4s/epoch - 17ms/step
Epoch 9/50
254/254 - 4s - loss: 3.2321 - accuracy30: 0.4093 - val_loss: 3.2983 - val_accuracy30: 0.3730 - 4s/epoch - 18ms/step
Epoch 10/50
254/254 - 4s - loss: 3.2265 - accuracy30: 0.4121 - val_loss: 3.3291 - val_accuracy30: 0.3709 - 4s/epoch - 18ms/step
Epoch 11/50
254/254 - 4s - loss: 3.2198 - accuracy30: 0.4164 - val_loss: 3.3693 - val_accuracy30: 0.3582 - 4s/epoch - 17ms/step
Epoch 12/50
254/254 - 4s - loss: 3.2178 - accuracy30: 0.4173 - val_loss: 3.3910 - val_accuracy30: 0.3513 - 4s/epoch - 17ms/step
Epoch 13/50
254/254 - 4s - loss: 3.2165 - accuracy30: 0.4181 - val_loss: 3.3595 - val_accuracy30: 0.3509 - 4s/epoch - 18ms/step
Epoch 14/50
254/254 - 5s - loss: 3.2111 - accuracy30: 0.4220 - val_loss: 3.3166 - val_accuracy30: 0.3757 - 5s/epoch - 18ms/step
Epoch 15/50
254/254 - 5s - loss: 3.2074 - accuracy30: 0.4226 - val_loss: 3.3269 - val_accuracy30: 0.3657 - 5s/epoch - 18ms/step
Epoch 16/50
254/254 - 5s - loss: 3.2030 - accuracy30: 0.4234 - val_loss: 3.3870 - val_accuracy30: 0.3530 - 5s/epoch - 18ms/step
Epoch 17/50
254/254 - 4s - loss: 3.1974 - accuracy30: 0.4287 - val_loss: 3.4518 - val_accuracy30: 0.3501 - 4s/epoch - 17ms/step
Epoch 18/50
254/254 - 5s - loss: 3.1956 - accuracy30: 0.4292 - val_loss: 3.4038 - val_accuracy30: 0.3561 - 5s/epoch - 18ms/step
Epoch 19/50
254/254 - 4s - loss: 3.1918 - accuracy30: 0.4307 - val_loss: 3.3695 - val_accuracy30: 0.3620 - 4s/epoch - 17ms/step
testing model: results/LILAK/W4/deepLOB_L1/h30
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1006572
{'0': {'precision': 0.4668242608723811, 'recall': 0.2768899815611555, 'f1-score': 0.3476038338658148, 'support': 52064}, '1': {'precision': 0.25982745199792423, 'recall': 0.48285214875534926, 'f1-score': 0.3378529405562702, 'support': 33182}, '2': {'precision': 0.457072252828221, 'recall': 0.3921763149704326, 'f1-score': 0.422144749102254, 'support': 51408}, 'accuracy': 0.37027090315687794, 'macro avg': {'precision': 0.39457465523284213, 'recall': 0.3839728150956458, 'f1-score': 0.36920050784144637, 'support': 136654}, 'weighted avg': {'precision': 0.41289316963753686, 'recall': 0.37027090315687794, 'f1-score': 0.3732777638545276, 'support': 136654}}
[[14416 23939 13709]
 [ 6921 16022 10239]
 [ 9544 21703 20161]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0867217
{'0': {'precision': 0.40691400785985476, 'recall': 0.28629674758646545, 'f1-score': 0.33611179885010034, 'support': 21338}, '1': {'precision': 0.3680316410378806, 'recall': 0.4982689378202465, 'f1-score': 0.42336052714151245, 'support': 21663}, '2': {'precision': 0.4101194522676508, 'recall': 0.3850467289719626, 'f1-score': 0.3971878012650192, 'support': 21935}, 'accuracy': 0.3903689786867069, 'macro avg': {'precision': 0.395021700388462, 'recall': 0.38987080479289155, 'f1-score': 0.38555337575221066, 'support': 64936}, 'weighted avg': {'precision': 0.39502542079906533, 'recall': 0.3903689786867069, 'f1-score': 0.3858495608611282, 'support': 64936}}
[[ 6109  9612  5617]
 [ 4338 10794  6531]
 [ 4566  8923  8446]]
Evaluating performance on  val set...
81/81 - 1s - 628ms/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0991992
{'0': {'precision': 0.41241628026790317, 'recall': 0.22357212679793326, 'f1-score': 0.2899574391016934, 'support': 7161}, '1': {'precision': 0.3263416477702192, 'recall': 0.5471249801995881, 'f1-score': 0.40882996981712727, 'support': 6313}, '2': {'precision': 0.41863111689156235, 'recall': 0.3604927901441971, 'f1-score': 0.3873928087859185, 'support': 7143}, 'accuracy': 0.3700829412620653, 'macro avg': {'precision': 0.3857963483098949, 'recall': 0.3770632990472395, 'f1-score': 0.36206007256824635, 'support': 20617}, 'weighted avg': {'precision': 0.38821311894690197, 'recall': 0.3700829412620653, 'f1-score': 0.3601142578464649, 'support': 20617}}
[[1601 3715 1845]
 [1128 3454 1731]
 [1153 3415 2575]]
training model: results/LILAK/W4/deepLOB_L1/h50
Epoch 1/50
254/254 - 7s - loss: 3.3502 - accuracy50: 0.3521 - val_loss: 3.4674 - val_accuracy50: 0.3366 - 7s/epoch - 27ms/step
Epoch 2/50
254/254 - 5s - loss: 3.3091 - accuracy50: 0.3643 - val_loss: 3.4145 - val_accuracy50: 0.3171 - 5s/epoch - 19ms/step
Epoch 3/50
254/254 - 5s - loss: 3.2922 - accuracy50: 0.3706 - val_loss: 3.3491 - val_accuracy50: 0.3364 - 5s/epoch - 18ms/step
Epoch 4/50
254/254 - 5s - loss: 3.2802 - accuracy50: 0.3784 - val_loss: 3.3379 - val_accuracy50: 0.3412 - 5s/epoch - 18ms/step
Epoch 5/50
254/254 - 5s - loss: 3.2727 - accuracy50: 0.3797 - val_loss: 3.3280 - val_accuracy50: 0.3430 - 5s/epoch - 18ms/step
Epoch 6/50
254/254 - 5s - loss: 3.2679 - accuracy50: 0.3858 - val_loss: 3.3275 - val_accuracy50: 0.3387 - 5s/epoch - 19ms/step
Epoch 7/50
254/254 - 5s - loss: 3.2614 - accuracy50: 0.3898 - val_loss: 3.3495 - val_accuracy50: 0.3258 - 5s/epoch - 19ms/step
Epoch 8/50
254/254 - 5s - loss: 3.2517 - accuracy50: 0.3961 - val_loss: 3.3329 - val_accuracy50: 0.3418 - 5s/epoch - 19ms/step
Epoch 9/50
254/254 - 5s - loss: 3.2464 - accuracy50: 0.4006 - val_loss: 3.3306 - val_accuracy50: 0.3404 - 5s/epoch - 18ms/step
Epoch 10/50
254/254 - 5s - loss: 3.2418 - accuracy50: 0.4033 - val_loss: 3.3309 - val_accuracy50: 0.3431 - 5s/epoch - 18ms/step
Epoch 11/50
254/254 - 5s - loss: 3.2338 - accuracy50: 0.4084 - val_loss: 3.3390 - val_accuracy50: 0.3359 - 5s/epoch - 18ms/step
Epoch 12/50
254/254 - 5s - loss: 3.2333 - accuracy50: 0.4072 - val_loss: 3.3377 - val_accuracy50: 0.3371 - 5s/epoch - 18ms/step
Epoch 13/50
254/254 - 4s - loss: 3.2264 - accuracy50: 0.4102 - val_loss: 3.3295 - val_accuracy50: 0.3493 - 4s/epoch - 17ms/step
Epoch 14/50
254/254 - 5s - loss: 3.2220 - accuracy50: 0.4139 - val_loss: 3.3366 - val_accuracy50: 0.3356 - 5s/epoch - 18ms/step
Epoch 15/50
254/254 - 5s - loss: 3.2159 - accuracy50: 0.4171 - val_loss: 3.3378 - val_accuracy50: 0.3378 - 5s/epoch - 18ms/step
Epoch 16/50
254/254 - 5s - loss: 3.2163 - accuracy50: 0.4147 - val_loss: 3.3223 - val_accuracy50: 0.3580 - 5s/epoch - 18ms/step
Epoch 17/50
254/254 - 5s - loss: 3.2134 - accuracy50: 0.4175 - val_loss: 3.3355 - val_accuracy50: 0.3514 - 5s/epoch - 18ms/step
Epoch 18/50
254/254 - 5s - loss: 3.2087 - accuracy50: 0.4203 - val_loss: 3.3591 - val_accuracy50: 0.3421 - 5s/epoch - 18ms/step
Epoch 19/50
254/254 - 5s - loss: 3.2042 - accuracy50: 0.4210 - val_loss: 3.3438 - val_accuracy50: 0.3531 - 5s/epoch - 18ms/step
Epoch 20/50
254/254 - 4s - loss: 3.2079 - accuracy50: 0.4229 - val_loss: 3.3627 - val_accuracy50: 0.3493 - 4s/epoch - 18ms/step
Epoch 21/50
254/254 - 5s - loss: 3.2055 - accuracy50: 0.4218 - val_loss: 3.3460 - val_accuracy50: 0.3575 - 5s/epoch - 18ms/step
Epoch 22/50
254/254 - 5s - loss: 3.1978 - accuracy50: 0.4253 - val_loss: 3.3362 - val_accuracy50: 0.3630 - 5s/epoch - 18ms/step
Epoch 23/50
254/254 - 5s - loss: 3.1938 - accuracy50: 0.4266 - val_loss: 3.3427 - val_accuracy50: 0.3661 - 5s/epoch - 18ms/step
Epoch 24/50
254/254 - 5s - loss: 3.1911 - accuracy50: 0.4289 - val_loss: 3.3227 - val_accuracy50: 0.3664 - 5s/epoch - 18ms/step
Epoch 25/50
254/254 - 5s - loss: 3.1876 - accuracy50: 0.4318 - val_loss: 3.3757 - val_accuracy50: 0.3513 - 5s/epoch - 19ms/step
Epoch 26/50
254/254 - 5s - loss: 3.1828 - accuracy50: 0.4330 - val_loss: 3.3416 - val_accuracy50: 0.3674 - 5s/epoch - 18ms/step
testing model: results/LILAK/W4/deepLOB_L1/h50
Evaluating performance on  test set...
534/534 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0994574
{'0': {'precision': 0.426317862399204, 'recall': 0.410302449924188, 'f1-score': 0.41815686473847413, 'support': 50124}, '1': {'precision': 0.2786959603118356, 'recall': 0.265681160986947, 'f1-score': 0.27203298375715984, 'support': 37003}, '2': {'precision': 0.3961195378072189, 'recall': 0.42500050477517315, 'f1-score': 0.41005211123557195, 'support': 49527}, 'accuracy': 0.3764690385938209, 'macro avg': {'precision': 0.36704445350608617, 'recall': 0.36699470522876937, 'f1-score': 0.36674731991040194, 'support': 136654}, 'weighted avg': {'precision': 0.3754003212733962, 'recall': 0.3764690385938209, 'f1-score': 0.37565224654442336, 'support': 136654}}
[[20566 12359 17199]
 [12282  9831 14890]
 [15393 13085 21049]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0970273
{'0': {'precision': 0.3659021808490672, 'recall': 0.4567733470783937, 'f1-score': 0.40631903630528116, 'support': 21341}, '1': {'precision': 0.37393436228896193, 'recall': 0.30735058392489123, 'f1-score': 0.337388768789905, 'support': 21835}, '2': {'precision': 0.38534499705130726, 'recall': 0.3603400735294118, 'f1-score': 0.37242329248598843, 'support': 21760}, 'accuracy': 0.37421461130959716, 'macro avg': {'precision': 0.37506051339644547, 'recall': 0.3748213348442322, 'f1-score': 0.3720436991937249, 'support': 64936}, 'weighted avg': {'precision': 0.37511830691628484, 'recall': 0.37421461130959716, 'f1-score': 0.37178251146996566, 'support': 64936}}
[[9748 5667 5926]
 [8543 6711 6581]
 [8350 5569 7841]]
Evaluating performance on  val set...
81/81 - 1s - 599ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.103235
{'0': {'precision': 0.369305001391853, 'recall': 0.5466282104106579, 'f1-score': 0.4408018606711706, 'support': 7281}, '1': {'precision': 0.30935251798561153, 'recall': 0.17516701971647386, 'f1-score': 0.22367873491468998, 'support': 6137}, '2': {'precision': 0.38413197172034563, 'recall': 0.33963050423669955, 'f1-score': 0.36051312297257454, 'support': 7199}, 'accuracy': 0.3637774651986225, 'macro avg': {'precision': 0.3542631636992701, 'recall': 0.35380857812127714, 'f1-score': 0.34166457285281177, 'support': 20617}, 'weighted avg': {'precision': 0.35663637689414307, 'recall': 0.3637774651986225, 'f1-score': 0.3481364270261343, 'support': 20617}}
[[3980 1216 2085]
 [3227 1075 1835]
 [3570 1184 2445]]
training model: results/LILAK/W4/deepLOB_L1/h100
Epoch 1/50
254/254 - 7s - loss: 3.3518 - accuracy100: 0.3648 - val_loss: 3.4299 - val_accuracy100: 0.3205 - 7s/epoch - 26ms/step
Epoch 2/50
254/254 - 5s - loss: 3.3062 - accuracy100: 0.3741 - val_loss: 3.3794 - val_accuracy100: 0.3120 - 5s/epoch - 18ms/step
Epoch 3/50
254/254 - 5s - loss: 3.2921 - accuracy100: 0.3734 - val_loss: 3.3730 - val_accuracy100: 0.2991 - 5s/epoch - 18ms/step
Epoch 4/50
254/254 - 5s - loss: 3.2792 - accuracy100: 0.3775 - val_loss: 3.3786 - val_accuracy100: 0.3013 - 5s/epoch - 18ms/step
Epoch 5/50
254/254 - 5s - loss: 3.2758 - accuracy100: 0.3815 - val_loss: 3.3682 - val_accuracy100: 0.3046 - 5s/epoch - 18ms/step
Epoch 6/50
254/254 - 5s - loss: 3.2702 - accuracy100: 0.3860 - val_loss: 3.3396 - val_accuracy100: 0.3243 - 5s/epoch - 18ms/step
Epoch 7/50
254/254 - 4s - loss: 3.2642 - accuracy100: 0.3877 - val_loss: 3.3527 - val_accuracy100: 0.3214 - 4s/epoch - 17ms/step
Epoch 8/50
254/254 - 5s - loss: 3.2605 - accuracy100: 0.3932 - val_loss: 3.3431 - val_accuracy100: 0.3237 - 5s/epoch - 18ms/step
Epoch 9/50
254/254 - 5s - loss: 3.2612 - accuracy100: 0.3908 - val_loss: 3.3402 - val_accuracy100: 0.3188 - 5s/epoch - 18ms/step
Epoch 10/50
254/254 - 5s - loss: 3.2553 - accuracy100: 0.3921 - val_loss: 3.3587 - val_accuracy100: 0.3215 - 5s/epoch - 18ms/step
Epoch 11/50
254/254 - 5s - loss: 3.2529 - accuracy100: 0.3949 - val_loss: 3.3299 - val_accuracy100: 0.3326 - 5s/epoch - 19ms/step
Epoch 12/50
254/254 - 5s - loss: 3.2517 - accuracy100: 0.3955 - val_loss: 3.3592 - val_accuracy100: 0.3196 - 5s/epoch - 18ms/step
Epoch 13/50
254/254 - 5s - loss: 3.2451 - accuracy100: 0.4000 - val_loss: 3.3549 - val_accuracy100: 0.3306 - 5s/epoch - 18ms/step
Epoch 14/50
254/254 - 4s - loss: 3.2496 - accuracy100: 0.3988 - val_loss: 3.3847 - val_accuracy100: 0.3257 - 4s/epoch - 18ms/step
Epoch 15/50
254/254 - 5s - loss: 3.2460 - accuracy100: 0.4023 - val_loss: 3.3621 - val_accuracy100: 0.3301 - 5s/epoch - 18ms/step
Epoch 16/50
254/254 - 4s - loss: 3.2407 - accuracy100: 0.4058 - val_loss: 3.3639 - val_accuracy100: 0.3392 - 4s/epoch - 18ms/step
Epoch 17/50
254/254 - 5s - loss: 3.2393 - accuracy100: 0.4041 - val_loss: 3.3728 - val_accuracy100: 0.3489 - 5s/epoch - 18ms/step
Epoch 18/50
254/254 - 4s - loss: 3.2338 - accuracy100: 0.4084 - val_loss: 3.3801 - val_accuracy100: 0.3580 - 4s/epoch - 17ms/step
Epoch 19/50
254/254 - 5s - loss: 3.2316 - accuracy100: 0.4107 - val_loss: 3.3763 - val_accuracy100: 0.3296 - 5s/epoch - 18ms/step
Epoch 20/50
254/254 - 5s - loss: 3.2272 - accuracy100: 0.4128 - val_loss: 3.3735 - val_accuracy100: 0.3416 - 5s/epoch - 18ms/step
Epoch 21/50
254/254 - 5s - loss: 3.2259 - accuracy100: 0.4127 - val_loss: 3.3940 - val_accuracy100: 0.3606 - 5s/epoch - 18ms/step
testing model: results/LILAK/W4/deepLOB_L1/h100
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.12583
{'0': {'precision': 0.41613987895090787, 'recall': 0.06009984266039898, 'f1-score': 0.10503089143865843, 'support': 51481}, '1': {'precision': 0.2330415123937391, 'recall': 0.608921036769138, 'f1-score': 0.3370788391434554, 'support': 33180}, '2': {'precision': 0.3802972578900334, 'recall': 0.3110226376627623, 'f1-score': 0.3421890705179072, 'support': 51993}, 'accuracy': 0.2888243300598592, 'macro avg': {'precision': 0.34315954974489343, 'recall': 0.32668117236409977, 'f1-score': 0.261432933700007, 'support': 136654}, 'weighted avg': {'precision': 0.35804593951858316, 'recall': 0.2888243300598592, 'f1-score': 0.25160483811941814, 'support': 136654}}
[[ 3094 33346 15041]
 [ 1666 20204 11310]
 [ 2675 33147 16171]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1103247
{'0': {'precision': 0.3415780998389694, 'recall': 0.24539565016196205, 'f1-score': 0.2856065706207082, 'support': 21610}, '1': {'precision': 0.3387345874370205, 'recall': 0.6267978449285547, 'f1-score': 0.43979487853785215, 'support': 21345}, '2': {'precision': 0.35777688117813194, 'recall': 0.16136663482098176, 'f1-score': 0.22241730678789778, 'support': 21981}, 'accuracy': 0.3423216705679438, 'macro avg': {'precision': 0.34602985615137394, 'recall': 0.34452004330383285, 'f1-score': 0.31593958531548605, 'support': 64936}, 'weighted avg': {'precision': 0.346126742200626, 'recall': 0.3423216705679438, 'f1-score': 0.31489981665037486, 'support': 64936}}
[[ 5303 13058  3249]
 [ 4848 13379  3118]
 [ 5374 13060  3547]]
Evaluating performance on  val set...
81/81 - 1s - 626ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1094226
{'0': {'precision': 0.33012721067328576, 'recall': 0.29457364341085274, 'f1-score': 0.31133869787856616, 'support': 7224}, '1': {'precision': 0.30460801915020946, 'recall': 0.39592408214063474, 'f1-score': 0.3443144152066563, 'support': 6428}, '2': {'precision': 0.3732806052269601, 'recall': 0.3117013639626705, 'f1-score': 0.3397230263672639, 'support': 6965}, 'accuracy': 0.33195906290924965, 'macro avg': {'precision': 0.33600527835015176, 'recall': 0.334066363171386, 'f1-score': 0.3317920464841621, 'support': 20617}, 'weighted avg': {'precision': 0.33674922308808947, 'recall': 0.33195906290924965, 'f1-score': 0.33120893888883646, 'support': 20617}}
[[2128 3059 2037]
 [2275 2545 1608]
 [2043 2751 2171]]
training model: results/LILAK/W4/deepLOB_L1/h200
Epoch 1/50
254/254 - 7s - loss: 3.3571 - accuracy200: 0.3508 - val_loss: 3.3877 - val_accuracy200: 0.3274 - 7s/epoch - 26ms/step
Epoch 2/50
254/254 - 5s - loss: 3.3219 - accuracy200: 0.3580 - val_loss: 3.3774 - val_accuracy200: 0.3253 - 5s/epoch - 18ms/step
Epoch 3/50
254/254 - 4s - loss: 3.3049 - accuracy200: 0.3611 - val_loss: 3.4084 - val_accuracy200: 0.3070 - 4s/epoch - 18ms/step
Epoch 4/50
254/254 - 5s - loss: 3.2963 - accuracy200: 0.3670 - val_loss: 3.3987 - val_accuracy200: 0.3021 - 5s/epoch - 18ms/step
Epoch 5/50
254/254 - 5s - loss: 3.2884 - accuracy200: 0.3710 - val_loss: 3.4181 - val_accuracy200: 0.2886 - 5s/epoch - 18ms/step
Epoch 6/50
254/254 - 5s - loss: 3.2832 - accuracy200: 0.3715 - val_loss: 3.3515 - val_accuracy200: 0.3260 - 5s/epoch - 18ms/step
Epoch 7/50
254/254 - 5s - loss: 3.2780 - accuracy200: 0.3751 - val_loss: 3.3794 - val_accuracy200: 0.3038 - 5s/epoch - 18ms/step
Epoch 8/50
254/254 - 4s - loss: 3.2710 - accuracy200: 0.3785 - val_loss: 3.3559 - val_accuracy200: 0.3210 - 4s/epoch - 18ms/step
Epoch 9/50
254/254 - 4s - loss: 3.2650 - accuracy200: 0.3839 - val_loss: 3.3844 - val_accuracy200: 0.3062 - 4s/epoch - 18ms/step
Epoch 10/50
254/254 - 5s - loss: 3.2620 - accuracy200: 0.3845 - val_loss: 3.3810 - val_accuracy200: 0.3137 - 5s/epoch - 18ms/step
Epoch 11/50
254/254 - 4s - loss: 3.2567 - accuracy200: 0.3904 - val_loss: 3.3731 - val_accuracy200: 0.3206 - 4s/epoch - 18ms/step
Epoch 12/50
254/254 - 4s - loss: 3.2551 - accuracy200: 0.3917 - val_loss: 3.4028 - val_accuracy200: 0.3290 - 4s/epoch - 18ms/step
Epoch 13/50
254/254 - 4s - loss: 3.2539 - accuracy200: 0.3923 - val_loss: 3.3755 - val_accuracy200: 0.3291 - 4s/epoch - 18ms/step
Epoch 14/50
254/254 - 5s - loss: 3.2480 - accuracy200: 0.3975 - val_loss: 3.4078 - val_accuracy200: 0.3292 - 5s/epoch - 18ms/step
Epoch 15/50
254/254 - 5s - loss: 3.2448 - accuracy200: 0.3993 - val_loss: 3.3988 - val_accuracy200: 0.3315 - 5s/epoch - 18ms/step
Epoch 16/50
254/254 - 4s - loss: 3.2412 - accuracy200: 0.4004 - val_loss: 3.4069 - val_accuracy200: 0.3276 - 4s/epoch - 18ms/step
testing model: results/LILAK/W4/deepLOB_L1/h200
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1108747
{'0': {'precision': 0.40030807740444785, 'recall': 0.16768495553807997, 'f1-score': 0.23636079412224478, 'support': 49593}, '1': {'precision': 0.2897966476454232, 'recall': 0.6657175106459392, 'f1-score': 0.40380919778108004, 'support': 38982}, '2': {'precision': 0.36394364057574724, 'recall': 0.19931778947149484, 'f1-score': 0.25757290686735657, 'support': 48079}, 'accuracy': 0.3208833989491709, 'macro avg': {'precision': 0.35134945520853944, 'recall': 0.34424008521850463, 'f1-score': 0.29924763292356044, 'support': 136654}, 'weighted avg': {'precision': 0.35598941631034603, 'recall': 0.3208833989491709, 'f1-score': 0.291590284953841, 'support': 136654}}
[[ 8316 31808  9469]
 [ 5752 25951  7279]
 [ 6706 31790  9583]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1063131
{'0': {'precision': 0.35312389066382677, 'recall': 0.18427268096142269, 'f1-score': 0.24217157116338517, 'support': 21593}, '1': {'precision': 0.3383901902216633, 'recall': 0.6017892922044639, 'f1-score': 0.4331930165864457, 'support': 21461}, '2': {'precision': 0.364598116372081, 'recall': 0.2582944886207842, 'f1-score': 0.3023753477423497, 'support': 21882}, 'accuracy': 0.3472034002710361, 'macro avg': {'precision': 0.352037399085857, 'recall': 0.34811882059555693, 'f1-score': 0.32591331183072686, 'support': 64936}, 'weighted avg': {'precision': 0.3521210426559228, 'recall': 0.3472034002710361, 'f1-score': 0.3255904802327027, 'support': 64936}}
[[ 3979 12633  4981]
 [ 3677 12915  4869]
 [ 3612 12618  5652]]
Evaluating performance on  val set...
81/81 - 1s - 604ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1172276
{'0': {'precision': 0.3706043018094913, 'recall': 0.2912139503688799, 'f1-score': 0.3261473747464884, 'support': 7455}, '1': {'precision': 0.28398259428097805, 'recall': 0.46253796827539656, 'f1-score': 0.35190653485684936, 'support': 5926}, '2': {'precision': 0.34051302134325434, 'recall': 0.24032614704256494, 'f1-score': 0.2817791460746982, 'support': 7236}, 'accuracy': 0.3225978561381384, 'macro avg': {'precision': 0.3316999724779079, 'recall': 0.33135935522894716, 'f1-score': 0.3199443518926786, 'support': 20617}, 'weighted avg': {'precision': 0.33514517854870357, 'recall': 0.3225978561381384, 'f1-score': 0.3179793716492834, 'support': 20617}}
[[2171 3432 1852]
 [1669 2741 1516]
 [2018 3479 1739]]
training model: results/LILAK/W4/deepLOB_L1/h300
Epoch 1/50
254/254 - 7s - loss: 3.3578 - accuracy300: 0.3548 - val_loss: 3.4711 - val_accuracy300: 0.3073 - 7s/epoch - 27ms/step
Epoch 2/50
254/254 - 5s - loss: 3.3132 - accuracy300: 0.3691 - val_loss: 3.4402 - val_accuracy300: 0.3146 - 5s/epoch - 18ms/step
Epoch 3/50
254/254 - 4s - loss: 3.2945 - accuracy300: 0.3763 - val_loss: 3.4014 - val_accuracy300: 0.3183 - 4s/epoch - 18ms/step
Epoch 4/50
254/254 - 5s - loss: 3.2812 - accuracy300: 0.3828 - val_loss: 3.4427 - val_accuracy300: 0.3084 - 5s/epoch - 18ms/step
Epoch 5/50
254/254 - 5s - loss: 3.2847 - accuracy300: 0.3752 - val_loss: 3.3975 - val_accuracy300: 0.3112 - 5s/epoch - 18ms/step
Epoch 6/50
254/254 - 5s - loss: 3.2722 - accuracy300: 0.3886 - val_loss: 3.3984 - val_accuracy300: 0.3180 - 5s/epoch - 18ms/step
Epoch 7/50
254/254 - 5s - loss: 3.2642 - accuracy300: 0.3896 - val_loss: 3.3914 - val_accuracy300: 0.3174 - 5s/epoch - 18ms/step
Epoch 8/50
254/254 - 4s - loss: 3.2503 - accuracy300: 0.3995 - val_loss: 3.4200 - val_accuracy300: 0.3208 - 4s/epoch - 17ms/step
Epoch 9/50
254/254 - 4s - loss: 3.2458 - accuracy300: 0.3965 - val_loss: 3.4112 - val_accuracy300: 0.3318 - 4s/epoch - 17ms/step
Epoch 10/50
254/254 - 4s - loss: 3.2408 - accuracy300: 0.4029 - val_loss: 3.3994 - val_accuracy300: 0.3376 - 4s/epoch - 18ms/step
Epoch 11/50
254/254 - 5s - loss: 3.2303 - accuracy300: 0.4073 - val_loss: 3.4010 - val_accuracy300: 0.3475 - 5s/epoch - 18ms/step
Epoch 12/50
254/254 - 5s - loss: 3.2256 - accuracy300: 0.4121 - val_loss: 3.4384 - val_accuracy300: 0.3391 - 5s/epoch - 18ms/step
Epoch 13/50
254/254 - 5s - loss: 3.2204 - accuracy300: 0.4149 - val_loss: 3.4119 - val_accuracy300: 0.3508 - 5s/epoch - 18ms/step
Epoch 14/50
254/254 - 4s - loss: 3.2144 - accuracy300: 0.4164 - val_loss: 3.4247 - val_accuracy300: 0.3400 - 4s/epoch - 17ms/step
Epoch 15/50
254/254 - 5s - loss: 3.2022 - accuracy300: 0.4260 - val_loss: 3.4089 - val_accuracy300: 0.3486 - 5s/epoch - 18ms/step
Epoch 16/50
254/254 - 4s - loss: 3.1973 - accuracy300: 0.4259 - val_loss: 3.4254 - val_accuracy300: 0.3380 - 4s/epoch - 18ms/step
Epoch 17/50
254/254 - 4s - loss: 3.1920 - accuracy300: 0.4285 - val_loss: 3.4668 - val_accuracy300: 0.3321 - 4s/epoch - 18ms/step
testing model: results/LILAK/W4/deepLOB_L1/h300
Evaluating performance on  test set...
534/534 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1432136
{'0': {'precision': 0.4206233005647354, 'recall': 0.03898722397782129, 'f1-score': 0.07136013626202051, 'support': 51581}, '1': {'precision': 0.28124240596902084, 'recall': 0.8209978718373138, 'f1-score': 0.41896385283706966, 'support': 38061}, '2': {'precision': 0.3776365212366368, 'recall': 0.1668084744320599, 'f1-score': 0.2314025199917377, 'support': 47012}, 'accuracy': 0.30076690034686143, 'macro avg': {'precision': 0.35983407592346434, 'recall': 0.3422645234157316, 'f1-score': 0.24057550303027594, 'support': 136654}, 'weighted avg': {'precision': 0.3670143999911696, 'recall': 0.30076690034686143, 'f1-score': 0.22323317035150497, 'support': 136654}}
[[ 2011 42258  7312]
 [ 1201 31248  5612]
 [ 1569 37601  7842]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1192288
{'0': {'precision': 0.3260981380516408, 'recall': 0.14694974967550528, 'f1-score': 0.20260122072028888, 'support': 21572}, '1': {'precision': 0.3382831661092531, 'recall': 0.7024074074074074, 'f1-score': 0.45664409330323547, 'support': 21600}, '2': {'precision': 0.3695127834056922, 'recall': 0.17597868038963427, 'f1-score': 0.23841389398985335, 'support': 21764}, 'accuracy': 0.3414438832080818, 'macro avg': {'precision': 0.34463136252219534, 'recall': 0.341778612490849, 'f1-score': 0.2992197360044592, 'support': 64936}, 'weighted avg': {'precision': 0.3447021935452037, 'recall': 0.3414438832080818, 'f1-score': 0.29910782828512883, 'support': 64936}}
[[ 3170 15117  3285]
 [ 3178 15172  3250]
 [ 3373 14561  3830]]
Evaluating performance on  val set...
81/81 - 1s - 626ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1299367
{'0': {'precision': 0.27522421524663676, 'recall': 0.06730637422892392, 'f1-score': 0.10816169181627933, 'support': 7295}, '1': {'precision': 0.300879861853466, 'recall': 0.5876023767464269, 'f1-score': 0.39797694148357626, 'support': 6227}, '2': {'precision': 0.3657074340527578, 'recall': 0.3439041578576462, 'f1-score': 0.3544708360572383, 'support': 7095}, 'accuracy': 0.319639132754523, 'macro avg': {'precision': 0.3139371703842868, 'recall': 0.3329376362776657, 'f1-score': 0.2868698231190313, 'support': 20617}, 'weighted avg': {'precision': 0.3141113544448787, 'recall': 0.319639132754523, 'f1-score': 0.2804584827202839, 'support': 20617}}
[[ 491 4450 2354]
 [ 690 3659 1878]
 [ 603 4052 2440]]
training model: results/LILAK/W4/deepLOB_L1/h500
Epoch 1/50
254/254 - 7s - loss: 3.3544 - accuracy500: 0.3517 - val_loss: 3.5290 - val_accuracy500: 0.2963 - 7s/epoch - 26ms/step
Epoch 2/50
254/254 - 4s - loss: 3.3041 - accuracy500: 0.3680 - val_loss: 3.4045 - val_accuracy500: 0.3157 - 4s/epoch - 18ms/step
Epoch 3/50
254/254 - 4s - loss: 3.2849 - accuracy500: 0.3786 - val_loss: 3.3228 - val_accuracy500: 0.3408 - 4s/epoch - 17ms/step
Epoch 4/50
254/254 - 4s - loss: 3.2719 - accuracy500: 0.3744 - val_loss: 3.4308 - val_accuracy500: 0.3231 - 4s/epoch - 18ms/step
Epoch 5/50
254/254 - 4s - loss: 3.2639 - accuracy500: 0.3817 - val_loss: 3.3742 - val_accuracy500: 0.3257 - 4s/epoch - 17ms/step
Epoch 6/50
254/254 - 4s - loss: 3.2517 - accuracy500: 0.3896 - val_loss: 3.4349 - val_accuracy500: 0.3391 - 4s/epoch - 17ms/step
Epoch 7/50
254/254 - 4s - loss: 3.2429 - accuracy500: 0.3961 - val_loss: 3.4104 - val_accuracy500: 0.3316 - 4s/epoch - 17ms/step
Epoch 8/50
254/254 - 5s - loss: 3.2301 - accuracy500: 0.4063 - val_loss: 3.4455 - val_accuracy500: 0.3369 - 5s/epoch - 18ms/step
Epoch 9/50
254/254 - 5s - loss: 3.2306 - accuracy500: 0.4043 - val_loss: 3.4195 - val_accuracy500: 0.3251 - 5s/epoch - 19ms/step
Epoch 10/50
254/254 - 5s - loss: 3.2194 - accuracy500: 0.4159 - val_loss: 3.4389 - val_accuracy500: 0.3307 - 5s/epoch - 18ms/step
Epoch 11/50
254/254 - 5s - loss: 3.2090 - accuracy500: 0.4165 - val_loss: 3.4384 - val_accuracy500: 0.3368 - 5s/epoch - 18ms/step
Epoch 12/50
254/254 - 5s - loss: 3.2030 - accuracy500: 0.4182 - val_loss: 3.4763 - val_accuracy500: 0.3188 - 5s/epoch - 18ms/step
Epoch 13/50
254/254 - 5s - loss: 3.1984 - accuracy500: 0.4217 - val_loss: 3.4710 - val_accuracy500: 0.3312 - 5s/epoch - 18ms/step
testing model: results/LILAK/W4/deepLOB_L1/h500
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1185359
{'0': {'precision': 0.362972590695363, 'recall': 0.18690944881889765, 'f1-score': 0.24675476552450007, 'support': 50800}, '1': {'precision': 0.3039213439369285, 'recall': 0.31791048354230095, 'f1-score': 0.3107585592763574, 'support': 41713}, '2': {'precision': 0.31132780951811195, 'recall': 0.47157971047325614, 'f1-score': 0.3750529264974821, 'support': 44141}, 'accuracy': 0.3188490640595958, 'macro avg': {'precision': 0.3260739147168012, 'recall': 0.3254665476114849, 'f1-score': 0.31085541709944653, 'support': 136654}, 'weighted avg': {'precision': 0.3282655426617919, 'recall': 0.3188490640595958, 'f1-score': 0.30773358335844286, 'support': 136654}}
[[ 9495 15906 25399]
 [ 7805 13261 20647]
 [ 8859 14466 20816]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1096823
{'0': {'precision': 0.32725109083696946, 'recall': 0.3073197988452226, 'f1-score': 0.316972433003554, 'support': 21476}, '1': {'precision': 0.342218846034322, 'recall': 0.4568123156342183, 'f1-score': 0.3912983398148331, 'support': 21696}, '2': {'precision': 0.3480103751502499, 'recall': 0.25275684616798383, 'f1-score': 0.29283223763008703, 'support': 21764}, 'accuracy': 0.3389799186891709, 'macro avg': {'precision': 0.3391601040071805, 'recall': 0.3389629868824749, 'f1-score': 0.3337010034828247, 'support': 64936}, 'weighted avg': {'precision': 0.33920971903328573, 'recall': 0.3389799186891709, 'f1-score': 0.3337148819081582, 'support': 64936}}
[[6600 9612 5264]
 [6743 9911 5042]
 [6825 9438 5501]]
Evaluating performance on  val set...
81/81 - 1s - 712ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.105176
{'0': {'precision': 0.37641277641277643, 'recall': 0.30388786035440357, 'f1-score': 0.33628448086632035, 'support': 7562}, '1': {'precision': 0.29837565052830783, 'recall': 0.3340395480225989, 'f1-score': 0.31520199916701375, 'support': 5664}, '2': {'precision': 0.35197650226410476, 'recall': 0.38912190501961846, 'f1-score': 0.36961830098959003, 'support': 7391}, 'accuracy': 0.34272687587912887, 'macro avg': {'precision': 0.3422549764017297, 'recall': 0.342349771132207, 'f1-score': 0.3403682603409747, 'support': 20617}, 'weighted avg': {'precision': 0.34621387340834014, 'recall': 0.34272687587912887, 'f1-score': 0.3424424615708949, 'support': 20617}}
[[2298 2135 3129]
 [1606 1892 2166]
 [2201 2314 2876]]
training model: results/LILAK/W4/deepLOB_L1/h1000
Epoch 1/50
254/254 - 7s - loss: 3.3438 - accuracy1000: 0.3675 - val_loss: 3.4415 - val_accuracy1000: 0.3003 - 7s/epoch - 26ms/step
Epoch 2/50
254/254 - 5s - loss: 3.2903 - accuracy1000: 0.3850 - val_loss: 3.4997 - val_accuracy1000: 0.3454 - 5s/epoch - 18ms/step
Epoch 3/50
254/254 - 5s - loss: 3.2724 - accuracy1000: 0.3911 - val_loss: 3.5328 - val_accuracy1000: 0.3473 - 5s/epoch - 18ms/step
Epoch 4/50
254/254 - 5s - loss: 3.2520 - accuracy1000: 0.3988 - val_loss: 3.6867 - val_accuracy1000: 0.3502 - 5s/epoch - 18ms/step
Epoch 5/50
254/254 - 5s - loss: 3.2218 - accuracy1000: 0.4067 - val_loss: 3.6327 - val_accuracy1000: 0.3510 - 5s/epoch - 18ms/step
Epoch 6/50
254/254 - 5s - loss: 3.2048 - accuracy1000: 0.4097 - val_loss: 3.6722 - val_accuracy1000: 0.3539 - 5s/epoch - 18ms/step
Epoch 7/50
254/254 - 5s - loss: 3.1860 - accuracy1000: 0.4196 - val_loss: 3.6741 - val_accuracy1000: 0.3542 - 5s/epoch - 19ms/step
Epoch 8/50
254/254 - 5s - loss: 3.1732 - accuracy1000: 0.4248 - val_loss: 3.8331 - val_accuracy1000: 0.3514 - 5s/epoch - 18ms/step
Epoch 9/50
254/254 - 5s - loss: 3.1550 - accuracy1000: 0.4336 - val_loss: 3.7905 - val_accuracy1000: 0.3476 - 5s/epoch - 19ms/step
Epoch 10/50
254/254 - 5s - loss: 3.1393 - accuracy1000: 0.4410 - val_loss: 3.9855 - val_accuracy1000: 0.3480 - 5s/epoch - 18ms/step
Epoch 11/50
254/254 - 5s - loss: 3.1512 - accuracy1000: 0.4357 - val_loss: 3.7520 - val_accuracy1000: 0.3474 - 5s/epoch - 18ms/step
testing model: results/LILAK/W4/deepLOB_L1/h1000
Evaluating performance on  test set...
534/534 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1686714
{'0': {'precision': 0.4134704314237528, 'recall': 0.13750429700928155, 'f1-score': 0.20637593004942162, 'support': 55271}, '1': {'precision': 0.25869131619019026, 'recall': 0.3151404310907903, 'f1-score': 0.28413936067466017, 'support': 38275}, '2': {'precision': 0.26215001535326465, 'recall': 0.4356963904611673, 'f1-score': 0.32734370915175065, 'support': 43108}, 'accuracy': 0.28132363487347606, 'macro avg': {'precision': 0.31143725432240255, 'recall': 0.2961137061870797, 'f1-score': 0.2726196666252775, 'support': 136654}, 'weighted avg': {'precision': 0.3223842493029864, 'recall': 0.28132363487347606, 'f1-score': 0.2663161756970002, 'support': 136654}}
[[ 7600 16676 30995]
 [ 4344 12062 21869]
 [ 6437 17889 18782]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1234744
{'0': {'precision': 0.3448586349720872, 'recall': 0.269011050758569, 'f1-score': 0.3022491121925555, 'support': 21356}, '1': {'precision': 0.3470763863262773, 'recall': 0.4831418698048006, 'f1-score': 0.40395915897155577, 'support': 21414}, '2': {'precision': 0.37876326619016676, 'recall': 0.31557340070378054, 'f1-score': 0.3442929566372988, 'support': 22166}, 'accuracy': 0.3555192805223605, 'macro avg': {'precision': 0.3568994291628438, 'recall': 0.3559087737557167, 'f1-score': 0.35016707593380336, 'support': 64936}, 'weighted avg': {'precision': 0.3571633809231556, 'recall': 0.3555192805223605, 'f1-score': 0.350141849621527, 'support': 64936}}
[[ 5745  9717  5894]
 [ 5489 10346  5579]
 [ 5425  9746  6995]]
Evaluating performance on  val set...
81/81 - 1s - 625ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1504221
{'0': {'precision': 0.3601249178172255, 'recall': 0.29476658146105206, 'f1-score': 0.3241843604350078, 'support': 7433}, '1': {'precision': 0.2629672006102212, 'recall': 0.49945671858022456, 'f1-score': 0.34453466583385384, 'support': 5522}, '2': {'precision': 0.32904820766378245, 'recall': 0.1737144348734012, 'f1-score': 0.22738532501921932, 'support': 7662}, 'accuracy': 0.30460299752631326, 'macro avg': {'precision': 0.3173801086970764, 'recall': 0.3226459116382259, 'f1-score': 0.2987014504293603, 'support': 20617}, 'weighted avg': {'precision': 0.32255326977857984, 'recall': 0.30460299752631326, 'f1-score': 0.2936610145096383, 'support': 20617}}
[[2191 3613 1629]
 [1679 2758 1085]
 [2214 4117 1331]]
training model: results/LILAK/W4/deepOF_L1/h10
Epoch 1/50
254/254 - 7s - loss: 3.3001 - accuracy10: 0.3892 - val_loss: 3.3163 - val_accuracy10: 0.3870 - 7s/epoch - 28ms/step
Epoch 2/50
254/254 - 4s - loss: 3.2731 - accuracy10: 0.4082 - val_loss: 3.3065 - val_accuracy10: 0.4008 - 4s/epoch - 17ms/step
Epoch 3/50
254/254 - 5s - loss: 3.2627 - accuracy10: 0.4133 - val_loss: 3.3007 - val_accuracy10: 0.4039 - 5s/epoch - 19ms/step
Epoch 4/50
254/254 - 4s - loss: 3.2554 - accuracy10: 0.4165 - val_loss: 3.2976 - val_accuracy10: 0.4031 - 4s/epoch - 16ms/step
Epoch 5/50
254/254 - 4s - loss: 3.2488 - accuracy10: 0.4187 - val_loss: 3.2946 - val_accuracy10: 0.3974 - 4s/epoch - 16ms/step
Epoch 6/50
254/254 - 4s - loss: 3.2440 - accuracy10: 0.4191 - val_loss: 3.2912 - val_accuracy10: 0.3993 - 4s/epoch - 16ms/step
Epoch 7/50
254/254 - 4s - loss: 3.2405 - accuracy10: 0.4212 - val_loss: 3.2945 - val_accuracy10: 0.3994 - 4s/epoch - 16ms/step
Epoch 8/50
254/254 - 4s - loss: 3.2346 - accuracy10: 0.4232 - val_loss: 3.2913 - val_accuracy10: 0.4078 - 4s/epoch - 16ms/step
Epoch 9/50
254/254 - 4s - loss: 3.2302 - accuracy10: 0.4256 - val_loss: 3.2938 - val_accuracy10: 0.3993 - 4s/epoch - 15ms/step
Epoch 10/50
254/254 - 4s - loss: 3.2260 - accuracy10: 0.4255 - val_loss: 3.2903 - val_accuracy10: 0.4031 - 4s/epoch - 16ms/step
Epoch 11/50
254/254 - 4s - loss: 3.2259 - accuracy10: 0.4265 - val_loss: 3.2916 - val_accuracy10: 0.4058 - 4s/epoch - 15ms/step
Epoch 12/50
254/254 - 4s - loss: 3.2207 - accuracy10: 0.4276 - val_loss: 3.2941 - val_accuracy10: 0.4017 - 4s/epoch - 15ms/step
Epoch 13/50
254/254 - 4s - loss: 3.2183 - accuracy10: 0.4275 - val_loss: 3.2950 - val_accuracy10: 0.4004 - 4s/epoch - 16ms/step
Epoch 14/50
254/254 - 4s - loss: 3.2139 - accuracy10: 0.4318 - val_loss: 3.2904 - val_accuracy10: 0.4042 - 4s/epoch - 17ms/step
Epoch 15/50
254/254 - 4s - loss: 3.2121 - accuracy10: 0.4309 - val_loss: 3.2930 - val_accuracy10: 0.4117 - 4s/epoch - 16ms/step
Epoch 16/50
254/254 - 4s - loss: 3.2095 - accuracy10: 0.4329 - val_loss: 3.2934 - val_accuracy10: 0.4043 - 4s/epoch - 16ms/step
Epoch 17/50
254/254 - 4s - loss: 3.2049 - accuracy10: 0.4326 - val_loss: 3.2910 - val_accuracy10: 0.4055 - 4s/epoch - 16ms/step
Epoch 18/50
254/254 - 4s - loss: 3.2011 - accuracy10: 0.4357 - val_loss: 3.2890 - val_accuracy10: 0.4058 - 4s/epoch - 16ms/step
Epoch 19/50
254/254 - 4s - loss: 3.2010 - accuracy10: 0.4369 - val_loss: 3.2950 - val_accuracy10: 0.4101 - 4s/epoch - 16ms/step
Epoch 20/50
254/254 - 4s - loss: 3.1969 - accuracy10: 0.4379 - val_loss: 3.2968 - val_accuracy10: 0.4073 - 4s/epoch - 16ms/step
Epoch 21/50
254/254 - 4s - loss: 3.1940 - accuracy10: 0.4387 - val_loss: 3.2994 - val_accuracy10: 0.4117 - 4s/epoch - 16ms/step
Epoch 22/50
254/254 - 4s - loss: 3.1909 - accuracy10: 0.4407 - val_loss: 3.2986 - val_accuracy10: 0.4028 - 4s/epoch - 16ms/step
Epoch 23/50
254/254 - 4s - loss: 3.1882 - accuracy10: 0.4405 - val_loss: 3.3040 - val_accuracy10: 0.4087 - 4s/epoch - 16ms/step
Epoch 24/50
254/254 - 4s - loss: 3.1861 - accuracy10: 0.4419 - val_loss: 3.3076 - val_accuracy10: 0.4141 - 4s/epoch - 16ms/step
Epoch 25/50
254/254 - 4s - loss: 3.1840 - accuracy10: 0.4430 - val_loss: 3.3062 - val_accuracy10: 0.4194 - 4s/epoch - 16ms/step
Epoch 26/50
254/254 - 4s - loss: 3.1785 - accuracy10: 0.4460 - val_loss: 3.3060 - val_accuracy10: 0.4200 - 4s/epoch - 16ms/step
Epoch 27/50
254/254 - 4s - loss: 3.1741 - accuracy10: 0.4479 - val_loss: 3.3030 - val_accuracy10: 0.4065 - 4s/epoch - 16ms/step
Epoch 28/50
254/254 - 4s - loss: 3.1699 - accuracy10: 0.4483 - val_loss: 3.3092 - val_accuracy10: 0.4006 - 4s/epoch - 15ms/step
testing model: results/LILAK/W4/deepOF_L1/h10
Evaluating performance on  test set...
534/534 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0956463
{'0': {'precision': 0.3727515259307167, 'recall': 0.4011179016507536, 'f1-score': 0.3864148255235341, 'support': 45979}, '1': {'precision': 0.4337481297668139, 'recall': 0.2621988882025942, 'f1-score': 0.32683027428335737, 'support': 45332}, '2': {'precision': 0.371731164985193, 'recall': 0.4900416859657249, 'f1-score': 0.4227651558397077, 'support': 45339}, 'accuracy': 0.3845371386754482, 'macro avg': {'precision': 0.3927436068942412, 'recall': 0.3844528252730242, 'f1-score': 0.3786700852155331, 'support': 136650}, 'weighted avg': {'precision': 0.392647873535465, 'recall': 0.3845371386754482, 'f1-score': 0.37870901322485356, 'support': 136650}}
[[18443  7759 19777]
 [15672 11886 17774]
 [15363  7758 22218]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0720632
{'0': {'precision': 0.34189852700490997, 'recall': 0.36141868512110725, 'f1-score': 0.3513877207737595, 'support': 17340}, '1': {'precision': 0.5652104971061603, 'recall': 0.47623501118941847, 'f1-score': 0.5169219613885616, 'support': 29939}, '2': {'precision': 0.34717934325007016, 'recall': 0.42039082412914186, 'f1-score': 0.3802935977250019, 'support': 17655}, 'accuracy': 0.4303908584100779, 'macro avg': {'precision': 0.41809612245371347, 'recall': 0.4193481734798892, 'f1-score': 0.4162010932957743, 'support': 64934}, 'weighted avg': {'precision': 0.44629637533813504, 'recall': 0.4303908584100779, 'f1-score': 0.43556954982080337, 'support': 64934}}
[[ 6267  5429  5644]
 [ 7369 14258  8312]
 [ 4694  5539  7422]]
Evaluating performance on  val set...
81/81 - 1s - 564ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0863184
{'0': {'precision': 0.3287581699346405, 'recall': 0.347135955831608, 'f1-score': 0.33769721383014434, 'support': 5796}, '1': {'precision': 0.5388780894196057, 'recall': 0.4318459997774563, 'f1-score': 0.47946136265365374, 'support': 8987}, '2': {'precision': 0.33561831642445844, 'recall': 0.41968112463569346, 'f1-score': 0.37297173763997865, 'support': 5833}, 'accuracy': 0.4045886689949554, 'macro avg': {'precision': 0.4010848585929015, 'recall': 0.3995543600815859, 'f1-score': 0.39671010470792556, 'support': 20616}, 'weighted avg': {'precision': 0.4222953716656499, 'recall': 0.4045886689949554, 'f1-score': 0.40947596348379406, 'support': 20616}}
[[2012 1709 2075]
 [2335 3881 2771]
 [1773 1612 2448]]
training model: results/LILAK/W4/deepOF_L1/h20
Epoch 1/50
254/254 - 6s - loss: 3.3067 - accuracy20: 0.3705 - val_loss: 3.2923 - val_accuracy20: 0.3768 - 6s/epoch - 23ms/step
Epoch 2/50
254/254 - 4s - loss: 3.2845 - accuracy20: 0.3829 - val_loss: 3.2864 - val_accuracy20: 0.3808 - 4s/epoch - 18ms/step
Epoch 3/50
254/254 - 4s - loss: 3.2714 - accuracy20: 0.3892 - val_loss: 3.2828 - val_accuracy20: 0.3813 - 4s/epoch - 16ms/step
Epoch 4/50
254/254 - 4s - loss: 3.2660 - accuracy20: 0.3925 - val_loss: 3.2813 - val_accuracy20: 0.3827 - 4s/epoch - 18ms/step
Epoch 5/50
254/254 - 4s - loss: 3.2592 - accuracy20: 0.3964 - val_loss: 3.2786 - val_accuracy20: 0.3794 - 4s/epoch - 17ms/step
Epoch 6/50
254/254 - 4s - loss: 3.2551 - accuracy20: 0.3954 - val_loss: 3.2720 - val_accuracy20: 0.3855 - 4s/epoch - 17ms/step
Epoch 7/50
254/254 - 4s - loss: 3.2515 - accuracy20: 0.4002 - val_loss: 3.2750 - val_accuracy20: 0.3836 - 4s/epoch - 16ms/step
Epoch 8/50
254/254 - 4s - loss: 3.2478 - accuracy20: 0.4019 - val_loss: 3.2725 - val_accuracy20: 0.3850 - 4s/epoch - 16ms/step
Epoch 9/50
254/254 - 4s - loss: 3.2445 - accuracy20: 0.4036 - val_loss: 3.2718 - val_accuracy20: 0.3875 - 4s/epoch - 16ms/step
Epoch 10/50
254/254 - 4s - loss: 3.2398 - accuracy20: 0.4052 - val_loss: 3.2686 - val_accuracy20: 0.3869 - 4s/epoch - 16ms/step
Epoch 11/50
254/254 - 4s - loss: 3.2376 - accuracy20: 0.4067 - val_loss: 3.2702 - val_accuracy20: 0.3867 - 4s/epoch - 16ms/step
Epoch 12/50
254/254 - 4s - loss: 3.2337 - accuracy20: 0.4085 - val_loss: 3.2691 - val_accuracy20: 0.3872 - 4s/epoch - 17ms/step
Epoch 13/50
254/254 - 4s - loss: 3.2333 - accuracy20: 0.4094 - val_loss: 3.2691 - val_accuracy20: 0.3872 - 4s/epoch - 16ms/step
Epoch 14/50
254/254 - 4s - loss: 3.2301 - accuracy20: 0.4114 - val_loss: 3.2695 - val_accuracy20: 0.3897 - 4s/epoch - 16ms/step
Epoch 15/50
254/254 - 4s - loss: 3.2277 - accuracy20: 0.4138 - val_loss: 3.2683 - val_accuracy20: 0.3898 - 4s/epoch - 16ms/step
Epoch 16/50
254/254 - 4s - loss: 3.2251 - accuracy20: 0.4139 - val_loss: 3.2724 - val_accuracy20: 0.3916 - 4s/epoch - 16ms/step
Epoch 17/50
254/254 - 4s - loss: 3.2214 - accuracy20: 0.4168 - val_loss: 3.2715 - val_accuracy20: 0.3906 - 4s/epoch - 16ms/step
Epoch 18/50
254/254 - 4s - loss: 3.2210 - accuracy20: 0.4152 - val_loss: 3.2705 - val_accuracy20: 0.3905 - 4s/epoch - 16ms/step
Epoch 19/50
254/254 - 4s - loss: 3.2173 - accuracy20: 0.4184 - val_loss: 3.2729 - val_accuracy20: 0.3913 - 4s/epoch - 16ms/step
Epoch 20/50
254/254 - 4s - loss: 3.2159 - accuracy20: 0.4189 - val_loss: 3.2751 - val_accuracy20: 0.3890 - 4s/epoch - 16ms/step
Epoch 21/50
254/254 - 4s - loss: 3.2129 - accuracy20: 0.4203 - val_loss: 3.2712 - val_accuracy20: 0.3896 - 4s/epoch - 16ms/step
Epoch 22/50
254/254 - 4s - loss: 3.2087 - accuracy20: 0.4207 - val_loss: 3.2752 - val_accuracy20: 0.3883 - 4s/epoch - 16ms/step
Epoch 23/50
254/254 - 4s - loss: 3.2061 - accuracy20: 0.4238 - val_loss: 3.2697 - val_accuracy20: 0.3950 - 4s/epoch - 16ms/step
Epoch 24/50
254/254 - 4s - loss: 3.2044 - accuracy20: 0.4240 - val_loss: 3.2712 - val_accuracy20: 0.3925 - 4s/epoch - 16ms/step
Epoch 25/50
254/254 - 4s - loss: 3.2010 - accuracy20: 0.4262 - val_loss: 3.2786 - val_accuracy20: 0.3906 - 4s/epoch - 16ms/step
testing model: results/LILAK/W4/deepOF_L1/h20
Evaluating performance on  test set...
534/534 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0819182
{'0': {'precision': 0.4211356777972821, 'recall': 0.4049999051611312, 'f1-score': 0.4129102125273152, 'support': 52721}, '1': {'precision': 0.28839006986769733, 'recall': 0.24393310700364643, 'f1-score': 0.26430517711171664, 'support': 31812}, '2': {'precision': 0.4093765349502888, 'recall': 0.46376422280637797, 'f1-score': 0.4348764821245435, 'support': 52117}, 'accuracy': 0.38991584339553603, 'macro avg': {'precision': 0.37296742753842277, 'recall': 0.37089907832371855, 'f1-score': 0.37069729058785844, 'support': 136650}, 'weighted avg': {'precision': 0.3857477924902005, 'recall': 0.38991584339553603, 'f1-score': 0.3866928154249202, 'support': 136650}}
[[21352  9413 21956]
 [11137  7760 12915]
 [18212  9735 24170]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0773338
{'0': {'precision': 0.38575830948712303, 'recall': 0.3369058489931273, 'f1-score': 0.3596808537930681, 'support': 20807}, '1': {'precision': 0.43859927740501053, 'recall': 0.48246495174040266, 'f1-score': 0.459487563430663, 'support': 22897}, '2': {'precision': 0.3908227114716107, 'recall': 0.39717381064531326, 'f1-score': 0.39397266674453923, 'support': 21230}, 'accuracy': 0.40793729017155883, 'macro avg': {'precision': 0.40506009945458143, 'recall': 0.4055148704596144, 'f1-score': 0.4043803613227568, 'support': 64934}, 'weighted avg': {'precision': 0.4060468624262079, 'recall': 0.40793729017155883, 'f1-score': 0.4060862719027139, 'support': 64934}}
[[ 7010  7030  6767]
 [ 5474 11047  6376]
 [ 5688  7110  8432]]
Evaluating performance on  val set...
81/81 - 1s - 628ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0869601
{'0': {'precision': 0.3836286919831224, 'recall': 0.32681524083393243, 'f1-score': 0.3529503105590062, 'support': 6955}, '1': {'precision': 0.4057087432451157, 'recall': 0.43545508625817964, 'f1-score': 0.4200559500753174, 'support': 6724}, '2': {'precision': 0.3827936847738828, 'recall': 0.4124261208014992, 'f1-score': 0.3970578030671015, 'support': 6937}, 'accuracy': 0.3910554908808692, 'macro avg': {'precision': 0.3907103733340403, 'recall': 0.3915654826312038, 'f1-score': 0.39002135456714165, 'support': 20616}, 'weighted avg': {'precision': 0.3905492303841288, 'recall': 0.3910554908808692, 'f1-score': 0.38967867666476547, 'support': 20616}}
[[2273 2206 2476]
 [1659 2928 2137]
 [1993 2083 2861]]
training model: results/LILAK/W4/deepOF_L1/h30
Epoch 1/50
254/254 - 6s - loss: 3.3164 - accuracy30: 0.3567 - val_loss: 3.2917 - val_accuracy30: 0.3686 - 6s/epoch - 24ms/step
Epoch 2/50
254/254 - 4s - loss: 3.2944 - accuracy30: 0.3679 - val_loss: 3.2899 - val_accuracy30: 0.3721 - 4s/epoch - 16ms/step
Epoch 3/50
254/254 - 4s - loss: 3.2843 - accuracy30: 0.3747 - val_loss: 3.2865 - val_accuracy30: 0.3705 - 4s/epoch - 16ms/step
Epoch 4/50
254/254 - 4s - loss: 3.2775 - accuracy30: 0.3781 - val_loss: 3.2815 - val_accuracy30: 0.3742 - 4s/epoch - 16ms/step
Epoch 5/50
254/254 - 4s - loss: 3.2737 - accuracy30: 0.3814 - val_loss: 3.2851 - val_accuracy30: 0.3698 - 4s/epoch - 16ms/step
Epoch 6/50
254/254 - 4s - loss: 3.2691 - accuracy30: 0.3873 - val_loss: 3.2782 - val_accuracy30: 0.3781 - 4s/epoch - 16ms/step
Epoch 7/50
254/254 - 4s - loss: 3.2675 - accuracy30: 0.3851 - val_loss: 3.2812 - val_accuracy30: 0.3716 - 4s/epoch - 16ms/step
Epoch 8/50
254/254 - 4s - loss: 3.2621 - accuracy30: 0.3905 - val_loss: 3.2799 - val_accuracy30: 0.3734 - 4s/epoch - 16ms/step
Epoch 9/50
254/254 - 4s - loss: 3.2604 - accuracy30: 0.3918 - val_loss: 3.2806 - val_accuracy30: 0.3725 - 4s/epoch - 16ms/step
Epoch 10/50
254/254 - 4s - loss: 3.2555 - accuracy30: 0.3942 - val_loss: 3.2778 - val_accuracy30: 0.3778 - 4s/epoch - 16ms/step
Epoch 11/50
254/254 - 4s - loss: 3.2534 - accuracy30: 0.3968 - val_loss: 3.2802 - val_accuracy30: 0.3749 - 4s/epoch - 16ms/step
Epoch 12/50
254/254 - 4s - loss: 3.2496 - accuracy30: 0.3984 - val_loss: 3.2837 - val_accuracy30: 0.3738 - 4s/epoch - 16ms/step
Epoch 13/50
254/254 - 4s - loss: 3.2496 - accuracy30: 0.3958 - val_loss: 3.2806 - val_accuracy30: 0.3749 - 4s/epoch - 16ms/step
Epoch 14/50
254/254 - 4s - loss: 3.2452 - accuracy30: 0.3995 - val_loss: 3.2798 - val_accuracy30: 0.3749 - 4s/epoch - 16ms/step
Epoch 15/50
254/254 - 4s - loss: 3.2437 - accuracy30: 0.4019 - val_loss: 3.2782 - val_accuracy30: 0.3769 - 4s/epoch - 16ms/step
Epoch 16/50
254/254 - 4s - loss: 3.2411 - accuracy30: 0.4014 - val_loss: 3.2812 - val_accuracy30: 0.3773 - 4s/epoch - 16ms/step
Epoch 17/50
254/254 - 4s - loss: 3.2387 - accuracy30: 0.4030 - val_loss: 3.2792 - val_accuracy30: 0.3757 - 4s/epoch - 16ms/step
Epoch 18/50
254/254 - 4s - loss: 3.2371 - accuracy30: 0.4044 - val_loss: 3.2789 - val_accuracy30: 0.3808 - 4s/epoch - 16ms/step
Epoch 19/50
254/254 - 4s - loss: 3.2349 - accuracy30: 0.4046 - val_loss: 3.2857 - val_accuracy30: 0.3744 - 4s/epoch - 16ms/step
Epoch 20/50
254/254 - 4s - loss: 3.2329 - accuracy30: 0.4035 - val_loss: 3.2848 - val_accuracy30: 0.3730 - 4s/epoch - 16ms/step
testing model: results/LILAK/W4/deepOF_L1/h30
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0899751
{'0': {'precision': 0.4100019953200675, 'recall': 0.43416376942432916, 'f1-score': 0.42173710234163636, 'support': 52061}, '1': {'precision': 0.27595765158806546, 'recall': 0.21602073413296366, 'f1-score': 0.2423381848301976, 'support': 33182}, '2': {'precision': 0.40227919202102763, 'recall': 0.43466843036940495, 'f1-score': 0.4178470917131824, 'support': 51407}, 'accuracy': 0.38138309549945115, 'macro avg': {'precision': 0.36274627964305356, 'recall': 0.3616176446422326, 'f1-score': 0.3606407929616721, 'support': 136650}, 'weighted avg': {'precision': 0.37454743576712907, 'recall': 0.38138309549945115, 'f1-score': 0.37671120656965323, 'support': 136650}}
[[22603  9428 20030]
 [12843  7168 13171]
 [19683  9379 22345]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0856832
{'0': {'precision': 0.3829133087995528, 'recall': 0.38441752794275824, 'f1-score': 0.3836639439906651, 'support': 21383}, '1': {'precision': 0.40806767019873574, 'recall': 0.4141703207939072, 'f1-score': 0.411096348559124, 'support': 21665}, '2': {'precision': 0.3897476487568675, 'recall': 0.38248195193274237, 'f1-score': 0.38608061986901576, 'support': 21886}, 'accuracy': 0.39369205654972744, 'macro avg': {'precision': 0.3935762092517187, 'recall': 0.39368993355646925, 'f1-score': 0.39361363747293493, 'support': 64934}, 'weighted avg': {'precision': 0.3936094865187613, 'recall': 0.39369205654972744, 'f1-score': 0.3936312094178565, 'support': 64934}}
[[8220 6424 6739]
 [6324 8973 6368]
 [6923 6592 8371]]
Evaluating performance on  val set...
81/81 - 1s - 758ms/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0925953
{'0': {'precision': 0.37251821168404514, 'recall': 0.3634336677814939, 'f1-score': 0.3679198702123157, 'support': 7176}, '1': {'precision': 0.36943691178816396, 'recall': 0.3680864589955499, 'f1-score': 0.3687604490088369, 'support': 6292}, '2': {'precision': 0.3768037026953444, 'recall': 0.387241186345831, 'f1-score': 0.38195115220091075, 'support': 7148}, 'accuracy': 0.3731082654249127, 'macro avg': {'precision': 0.3729196087225178, 'recall': 0.37292043770762495, 'f1-score': 0.37287715714068775, 'support': 20616}, 'weighted avg': {'precision': 0.37306366913475736, 'recall': 0.3731082654249127, 'f1-score': 0.3730413547603458, 'support': 20616}}
[[2608 2015 2553]
 [1951 2316 2025]
 [2442 1938 2768]]
training model: results/LILAK/W4/deepOF_L1/h50
Epoch 1/50
254/254 - 6s - loss: 3.3283 - accuracy50: 0.3445 - val_loss: 3.3233 - val_accuracy50: 0.3364 - 6s/epoch - 24ms/step
Epoch 2/50
254/254 - 4s - loss: 3.3076 - accuracy50: 0.3477 - val_loss: 3.3252 - val_accuracy50: 0.3346 - 4s/epoch - 16ms/step
Epoch 3/50
254/254 - 4s - loss: 3.2998 - accuracy50: 0.3533 - val_loss: 3.3223 - val_accuracy50: 0.3330 - 4s/epoch - 16ms/step
Epoch 4/50
254/254 - 4s - loss: 3.2936 - accuracy50: 0.3596 - val_loss: 3.3153 - val_accuracy50: 0.3413 - 4s/epoch - 16ms/step
Epoch 5/50
254/254 - 4s - loss: 3.2911 - accuracy50: 0.3618 - val_loss: 3.3180 - val_accuracy50: 0.3335 - 4s/epoch - 17ms/step
Epoch 6/50
254/254 - 4s - loss: 3.2878 - accuracy50: 0.3662 - val_loss: 3.3142 - val_accuracy50: 0.3369 - 4s/epoch - 16ms/step
Epoch 7/50
254/254 - 4s - loss: 3.2837 - accuracy50: 0.3695 - val_loss: 3.3170 - val_accuracy50: 0.3382 - 4s/epoch - 16ms/step
Epoch 8/50
254/254 - 4s - loss: 3.2823 - accuracy50: 0.3712 - val_loss: 3.3186 - val_accuracy50: 0.3367 - 4s/epoch - 16ms/step
Epoch 9/50
254/254 - 4s - loss: 3.2812 - accuracy50: 0.3715 - val_loss: 3.3166 - val_accuracy50: 0.3339 - 4s/epoch - 16ms/step
Epoch 10/50
254/254 - 4s - loss: 3.2767 - accuracy50: 0.3738 - val_loss: 3.3155 - val_accuracy50: 0.3374 - 4s/epoch - 16ms/step
Epoch 11/50
254/254 - 4s - loss: 3.2761 - accuracy50: 0.3760 - val_loss: 3.3114 - val_accuracy50: 0.3424 - 4s/epoch - 16ms/step
Epoch 12/50
254/254 - 4s - loss: 3.2748 - accuracy50: 0.3793 - val_loss: 3.3124 - val_accuracy50: 0.3420 - 4s/epoch - 16ms/step
Epoch 13/50
254/254 - 4s - loss: 3.2731 - accuracy50: 0.3775 - val_loss: 3.3116 - val_accuracy50: 0.3436 - 4s/epoch - 16ms/step
Epoch 14/50
254/254 - 4s - loss: 3.2692 - accuracy50: 0.3810 - val_loss: 3.3186 - val_accuracy50: 0.3407 - 4s/epoch - 16ms/step
Epoch 15/50
254/254 - 4s - loss: 3.2664 - accuracy50: 0.3822 - val_loss: 3.3175 - val_accuracy50: 0.3448 - 4s/epoch - 16ms/step
Epoch 16/50
254/254 - 4s - loss: 3.2671 - accuracy50: 0.3817 - val_loss: 3.3208 - val_accuracy50: 0.3430 - 4s/epoch - 16ms/step
Epoch 17/50
254/254 - 4s - loss: 3.2660 - accuracy50: 0.3844 - val_loss: 3.3192 - val_accuracy50: 0.3431 - 4s/epoch - 16ms/step
Epoch 18/50
254/254 - 4s - loss: 3.2611 - accuracy50: 0.3873 - val_loss: 3.3150 - val_accuracy50: 0.3505 - 4s/epoch - 16ms/step
Epoch 19/50
254/254 - 4s - loss: 3.2617 - accuracy50: 0.3862 - val_loss: 3.3171 - val_accuracy50: 0.3463 - 4s/epoch - 16ms/step
Epoch 20/50
254/254 - 4s - loss: 3.2608 - accuracy50: 0.3865 - val_loss: 3.3144 - val_accuracy50: 0.3554 - 4s/epoch - 16ms/step
Epoch 21/50
254/254 - 4s - loss: 3.2587 - accuracy50: 0.3884 - val_loss: 3.3195 - val_accuracy50: 0.3487 - 4s/epoch - 16ms/step
testing model: results/LILAK/W4/deepOF_L1/h50
Evaluating performance on  test set...
534/534 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.104493
{'0': {'precision': 0.3983821318634118, 'recall': 0.22206260848746034, 'f1-score': 0.28516891069575573, 'support': 50121}, '1': {'precision': 0.2842836586677519, 'recall': 0.5285787638840094, 'f1-score': 0.36972137159275636, 'support': 37003}, '2': {'precision': 0.38302723559920826, 'recall': 0.30866615515082985, 'f1-score': 0.34184957008844213, 'support': 49526}, 'accuracy': 0.33645078668130257, 'macro avg': {'precision': 0.35523100871012403, 'recall': 0.35310250917409985, 'f1-score': 0.3322466174589847, 'support': 136650}, 'weighted avg': {'precision': 0.3619207165978432, 'recall': 0.33645078668130257, 'f1-score': 0.32860733768188016, 'support': 136650}}
[[11130 24699 14292]
 [ 7112 19559 10332]
 [ 9696 24543 15287]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0938793
{'0': {'precision': 0.38755937976158467, 'recall': 0.20200887643074047, 'f1-score': 0.2655856519869787, 'support': 21405}, '1': {'precision': 0.3584218115087167, 'recall': 0.6273574083421282, 'f1-score': 0.4562047449030665, 'support': 21793}, '2': {'precision': 0.3794779938587513, 'recall': 0.2729112992270887, 'f1-score': 0.3174909013059302, 'support': 21736}, 'accuracy': 0.368497243354791, 'macro avg': {'precision': 0.37515306170968427, 'recall': 0.36742586133331906, 'f1-score': 0.34642709939865846, 'support': 64934}, 'weighted avg': {'precision': 0.37507513377460194, 'recall': 0.368497243354791, 'f1-score': 0.3469355517485371, 'support': 64934}}
[[ 4324 12193  4888]
 [ 3309 13672  4812]
 [ 3524 12280  5932]]
Evaluating performance on  val set...
81/81 - 1s - 575ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1029885
{'0': {'precision': 0.3964388583398796, 'recall': 0.20782429649965684, 'f1-score': 0.2726945244956772, 'support': 7285}, '1': {'precision': 0.31654926515349163, 'recall': 0.592158776639011, 'f1-score': 0.41255808681854245, 'support': 6147}, '2': {'precision': 0.3769346923367308, 'recall': 0.27797884187082406, 'f1-score': 0.3199807723121294, 'support': 7184}, 'accuracy': 0.3468665114474195, 'macro avg': {'precision': 0.36330760527670075, 'recall': 0.3593206383364973, 'f1-score': 0.33507779454211634, 'support': 20616}, 'weighted avg': {'precision': 0.3658218978294339, 'recall': 0.3468665114474195, 'f1-score': 0.33087485636956376, 'support': 20616}}
[[1514 3963 1808]
 [1014 3640 1493]
 [1291 3896 1997]]
training model: results/LILAK/W4/deepOF_L1/h100
Epoch 1/50
254/254 - 6s - loss: 3.3223 - accuracy100: 0.3553 - val_loss: 3.4258 - val_accuracy100: 0.3137 - 6s/epoch - 24ms/step
Epoch 2/50
254/254 - 4s - loss: 3.3186 - accuracy100: 0.3523 - val_loss: 3.3966 - val_accuracy100: 0.3133 - 4s/epoch - 16ms/step
Epoch 3/50
254/254 - 4s - loss: 3.3044 - accuracy100: 0.3576 - val_loss: 3.3970 - val_accuracy100: 0.3121 - 4s/epoch - 16ms/step
Epoch 4/50
254/254 - 4s - loss: 3.2985 - accuracy100: 0.3597 - val_loss: 3.3910 - val_accuracy100: 0.3133 - 4s/epoch - 16ms/step
Epoch 5/50
254/254 - 4s - loss: 3.2932 - accuracy100: 0.3610 - val_loss: 3.4170 - val_accuracy100: 0.3127 - 4s/epoch - 16ms/step
Epoch 6/50
254/254 - 4s - loss: 3.2908 - accuracy100: 0.3647 - val_loss: 3.3716 - val_accuracy100: 0.3155 - 4s/epoch - 17ms/step
Epoch 7/50
254/254 - 4s - loss: 3.2868 - accuracy100: 0.3672 - val_loss: 3.3879 - val_accuracy100: 0.3156 - 4s/epoch - 16ms/step
Epoch 8/50
254/254 - 4s - loss: 3.2862 - accuracy100: 0.3684 - val_loss: 3.3825 - val_accuracy100: 0.3166 - 4s/epoch - 16ms/step
Epoch 9/50
254/254 - 4s - loss: 3.2816 - accuracy100: 0.3691 - val_loss: 3.3830 - val_accuracy100: 0.3156 - 4s/epoch - 16ms/step
Epoch 10/50
254/254 - 4s - loss: 3.2793 - accuracy100: 0.3748 - val_loss: 3.3902 - val_accuracy100: 0.3127 - 4s/epoch - 16ms/step
Epoch 11/50
254/254 - 4s - loss: 3.2765 - accuracy100: 0.3770 - val_loss: 3.4052 - val_accuracy100: 0.3156 - 4s/epoch - 16ms/step
Epoch 12/50
254/254 - 4s - loss: 3.2739 - accuracy100: 0.3794 - val_loss: 3.3976 - val_accuracy100: 0.3129 - 4s/epoch - 16ms/step
Epoch 13/50
254/254 - 4s - loss: 3.2741 - accuracy100: 0.3798 - val_loss: 3.4004 - val_accuracy100: 0.3159 - 4s/epoch - 16ms/step
Epoch 14/50
254/254 - 4s - loss: 3.2693 - accuracy100: 0.3802 - val_loss: 3.4172 - val_accuracy100: 0.3140 - 4s/epoch - 16ms/step
Epoch 15/50
254/254 - 4s - loss: 3.2697 - accuracy100: 0.3809 - val_loss: 3.4042 - val_accuracy100: 0.3168 - 4s/epoch - 17ms/step
Epoch 16/50
254/254 - 4s - loss: 3.2701 - accuracy100: 0.3798 - val_loss: 3.3949 - val_accuracy100: 0.3188 - 4s/epoch - 16ms/step
testing model: results/LILAK/W4/deepOF_L1/h100
Evaluating performance on  test set...
534/534 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1540039
{'0': {'precision': 0.39088283828382836, 'recall': 0.036811841951901784, 'f1-score': 0.06728686574583674, 'support': 51478}, '1': {'precision': 0.24303461958754097, 'recall': 0.9451175406871609, 'f1-score': 0.3866445555480208, 'support': 33180}, '2': {'precision': 0.43630458318296644, 'recall': 0.023253577473457455, 'f1-score': 0.04415389953070504, 'support': 51992}, 'accuracy': 0.2521990486644713, 'macro avg': {'precision': 0.35674068035144524, 'recall': 0.3350609867041734, 'f1-score': 0.1660284402748542, 'support': 136650}, 'weighted avg': {'precision': 0.37226566641740444, 'recall': 0.2521990486644713, 'f1-score': 0.13602860718878837, 'support': 136650}}
[[ 1895 48643   940]
 [ 1199 31359   622]
 [ 1754 49029  1209]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1186156
{'0': {'precision': 0.39891940567312023, 'recall': 0.040887904379528356, 'f1-score': 0.074173294265383, 'support': 21669}, '1': {'precision': 0.3304325024173591, 'recall': 0.9475514616035342, 'f1-score': 0.48999331672641117, 'support': 21278}, '2': {'precision': 0.4257075471698113, 'recall': 0.032837585846181835, 'f1-score': 0.06097200523582316, 'support': 21987}, 'accuracy': 0.3352634983213725, 'macro avg': {'precision': 0.38501981842009686, 'recall': 0.3404256506097481, 'f1-score': 0.20837953874253912, 'support': 64934}, 'weighted avg': {'precision': 0.38554777508839816, 'recall': 0.3352634983213725, 'f1-score': 0.2059619057175163, 'support': 64934}}
[[  886 20327   456]
 [  598 20162   518]
 [  737 20528   722]]
Evaluating performance on  val set...
81/81 - 1s - 594ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1269137
{'0': {'precision': 0.3995067817509248, 'recall': 0.04458511077473511, 'f1-score': 0.08021787571180986, 'support': 7267}, '1': {'precision': 0.3109970978441128, 'recall': 0.9407430631760464, 'f1-score': 0.46745861733203503, 'support': 6379}, '2': {'precision': 0.4066797642436149, 'recall': 0.0296987087517934, 'f1-score': 0.05535499398315283, 'support': 6970}, 'accuracy': 0.31684128831975167, 'macro avg': {'precision': 0.37239454794621746, 'recall': 0.33834229423419165, 'f1-score': 0.2010104956756659, 'support': 20616}, 'weighted avg': {'precision': 0.3745452186122217, 'recall': 0.31684128831975167, 'f1-score': 0.19163203971776044, 'support': 20616}}
[[ 324 6786  157]
 [ 233 6001  145]
 [ 254 6509  207]]
training model: results/LILAK/W4/deepOF_L1/h200
Epoch 1/50
254/254 - 6s - loss: 3.3309 - accuracy200: 0.3418 - val_loss: 3.3517 - val_accuracy200: 0.3076 - 6s/epoch - 23ms/step
Epoch 2/50
254/254 - 4s - loss: 3.3130 - accuracy200: 0.3477 - val_loss: 3.3460 - val_accuracy200: 0.3049 - 4s/epoch - 16ms/step
Epoch 3/50
254/254 - 4s - loss: 3.3031 - accuracy200: 0.3515 - val_loss: 3.3389 - val_accuracy200: 0.3072 - 4s/epoch - 17ms/step
Epoch 4/50
254/254 - 4s - loss: 3.2992 - accuracy200: 0.3537 - val_loss: 3.3417 - val_accuracy200: 0.3066 - 4s/epoch - 17ms/step
Epoch 5/50
254/254 - 4s - loss: 3.2952 - accuracy200: 0.3567 - val_loss: 3.3436 - val_accuracy200: 0.3012 - 4s/epoch - 16ms/step
Epoch 6/50
254/254 - 4s - loss: 3.2921 - accuracy200: 0.3614 - val_loss: 3.3524 - val_accuracy200: 0.3026 - 4s/epoch - 16ms/step
Epoch 7/50
254/254 - 4s - loss: 3.2899 - accuracy200: 0.3632 - val_loss: 3.3506 - val_accuracy200: 0.3014 - 4s/epoch - 16ms/step
Epoch 8/50
254/254 - 4s - loss: 3.2864 - accuracy200: 0.3648 - val_loss: 3.3580 - val_accuracy200: 0.3036 - 4s/epoch - 16ms/step
Epoch 9/50
254/254 - 4s - loss: 3.2858 - accuracy200: 0.3686 - val_loss: 3.3539 - val_accuracy200: 0.3044 - 4s/epoch - 17ms/step
Epoch 10/50
254/254 - 4s - loss: 3.2849 - accuracy200: 0.3669 - val_loss: 3.3568 - val_accuracy200: 0.3060 - 4s/epoch - 16ms/step
Epoch 11/50
254/254 - 4s - loss: 3.2843 - accuracy200: 0.3695 - val_loss: 3.3542 - val_accuracy200: 0.3038 - 4s/epoch - 16ms/step
Epoch 12/50
254/254 - 4s - loss: 3.2804 - accuracy200: 0.3703 - val_loss: 3.3561 - val_accuracy200: 0.3029 - 4s/epoch - 16ms/step
Epoch 13/50
254/254 - 4s - loss: 3.2801 - accuracy200: 0.3713 - val_loss: 3.3648 - val_accuracy200: 0.3035 - 4s/epoch - 16ms/step
testing model: results/LILAK/W4/deepOF_L1/h200
Evaluating performance on  test set...
534/534 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1145606
{'0': {'precision': 0.3701509495211816, 'recall': 0.09197233368958077, 'f1-score': 0.14733577762343933, 'support': 49591}, '1': {'precision': 0.28457975489723053, 'recall': 0.7565480618762987, 'f1-score': 0.4135866097285623, 'support': 38981}, '2': {'precision': 0.35708764131800175, 'recall': 0.15372935646241523, 'f1-score': 0.21492962661393505, 'support': 48078}, 'accuracy': 0.3032784485912916, 'macro avg': {'precision': 0.33727278191213794, 'recall': 0.33408325067609823, 'f1-score': 0.25861733798864556, 'support': 136650}, 'weighted avg': {'precision': 0.3411446672714288, 'recall': 0.3032784485912916, 'f1-score': 0.2470686774262557, 'support': 136650}}
[[ 4561 37679  7351]
 [ 3534 29491  5956]
 [ 4227 36460  7391]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1045603
{'0': {'precision': 0.36952645135724194, 'recall': 0.08631462026195215, 'f1-score': 0.13994147219929468, 'support': 21607}, '1': {'precision': 0.3332694996074226, 'recall': 0.8115556799104645, 'f1-score': 0.47250315626569644, 'support': 21444}, '2': {'precision': 0.3620239958268127, 'recall': 0.12685646392176575, 'f1-score': 0.18787858278907651, 'support': 21883}, 'accuracy': 0.3394831675239474, 'macro avg': {'precision': 0.3549399822638257, 'recall': 0.34157558803139415, 'f1-score': 0.2667744037513559, 'support': 64934}, 'weighted avg': {'precision': 0.3550244907865778, 'recall': 0.3394831675239474, 'f1-score': 0.2659226306702978, 'support': 64934}}
[[ 1865 17337  2405]
 [ 1554 17403  2487]
 [ 1628 17479  2776]]
Evaluating performance on  val set...
81/81 - 1s - 586ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1138456
{'0': {'precision': 0.3902439024390244, 'recall': 0.09629530560385181, 'f1-score': 0.15447328899377819, 'support': 7477}, '1': {'precision': 0.2867962008814948, 'recall': 0.7811971592830571, 'f1-score': 0.4195613676610816, 'support': 5914}, '2': {'precision': 0.35274229902329074, 'recall': 0.12996539792387543, 'f1-score': 0.18994639425508242, 'support': 7225}, 'accuracy': 0.30456926658905703, 'macro avg': {'precision': 0.34326080078127, 'recall': 0.3358192876035948, 'f1-score': 0.2546603503033141, 'support': 20616}, 'weighted avg': {'precision': 0.347425761592599, 'recall': 0.30456926658905703, 'f1-score': 0.2429494280484617, 'support': 20616}}
[[ 720 5812  945]
 [ 516 4620  778]
 [ 609 5677  939]]
training model: results/LILAK/W4/deepOF_L1/h300
Epoch 1/50
254/254 - 7s - loss: 3.3313 - accuracy300: 0.3452 - val_loss: 3.3824 - val_accuracy300: 0.3103 - 7s/epoch - 26ms/step
Epoch 2/50
254/254 - 4s - loss: 3.3178 - accuracy300: 0.3478 - val_loss: 3.3817 - val_accuracy300: 0.3068 - 4s/epoch - 17ms/step
Epoch 3/50
254/254 - 4s - loss: 3.3101 - accuracy300: 0.3508 - val_loss: 3.3643 - val_accuracy300: 0.3079 - 4s/epoch - 17ms/step
Epoch 4/50
254/254 - 4s - loss: 3.3040 - accuracy300: 0.3521 - val_loss: 3.3636 - val_accuracy300: 0.3056 - 4s/epoch - 17ms/step
Epoch 5/50
254/254 - 4s - loss: 3.3001 - accuracy300: 0.3530 - val_loss: 3.3568 - val_accuracy300: 0.3057 - 4s/epoch - 17ms/step
Epoch 6/50
254/254 - 4s - loss: 3.2978 - accuracy300: 0.3554 - val_loss: 3.3566 - val_accuracy300: 0.3089 - 4s/epoch - 16ms/step
Epoch 7/50
254/254 - 4s - loss: 3.2964 - accuracy300: 0.3574 - val_loss: 3.3587 - val_accuracy300: 0.3058 - 4s/epoch - 17ms/step
Epoch 8/50
254/254 - 4s - loss: 3.2936 - accuracy300: 0.3570 - val_loss: 3.3540 - val_accuracy300: 0.3092 - 4s/epoch - 16ms/step
Epoch 9/50
254/254 - 4s - loss: 3.2930 - accuracy300: 0.3596 - val_loss: 3.3561 - val_accuracy300: 0.3061 - 4s/epoch - 16ms/step
Epoch 10/50
254/254 - 4s - loss: 3.2909 - accuracy300: 0.3600 - val_loss: 3.3524 - val_accuracy300: 0.3060 - 4s/epoch - 16ms/step
Epoch 11/50
254/254 - 4s - loss: 3.2910 - accuracy300: 0.3590 - val_loss: 3.3541 - val_accuracy300: 0.3073 - 4s/epoch - 16ms/step
Epoch 12/50
254/254 - 4s - loss: 3.2897 - accuracy300: 0.3611 - val_loss: 3.3592 - val_accuracy300: 0.3085 - 4s/epoch - 16ms/step
Epoch 13/50
254/254 - 4s - loss: 3.2863 - accuracy300: 0.3635 - val_loss: 3.3546 - val_accuracy300: 0.3080 - 4s/epoch - 16ms/step
Epoch 14/50
254/254 - 4s - loss: 3.2856 - accuracy300: 0.3634 - val_loss: 3.3551 - val_accuracy300: 0.3060 - 4s/epoch - 16ms/step
Epoch 15/50
254/254 - 4s - loss: 3.2846 - accuracy300: 0.3670 - val_loss: 3.3536 - val_accuracy300: 0.3072 - 4s/epoch - 17ms/step
Epoch 16/50
254/254 - 4s - loss: 3.2838 - accuracy300: 0.3644 - val_loss: 3.3570 - val_accuracy300: 0.3087 - 4s/epoch - 16ms/step
Epoch 17/50
254/254 - 4s - loss: 3.2837 - accuracy300: 0.3666 - val_loss: 3.3593 - val_accuracy300: 0.3065 - 4s/epoch - 16ms/step
Epoch 18/50
254/254 - 4s - loss: 3.2807 - accuracy300: 0.3673 - val_loss: 3.3579 - val_accuracy300: 0.3062 - 4s/epoch - 16ms/step
Epoch 19/50
254/254 - 4s - loss: 3.2812 - accuracy300: 0.3682 - val_loss: 3.3542 - val_accuracy300: 0.3085 - 4s/epoch - 16ms/step
Epoch 20/50
254/254 - 4s - loss: 3.2798 - accuracy300: 0.3717 - val_loss: 3.3596 - val_accuracy300: 0.3088 - 4s/epoch - 17ms/step
testing model: results/LILAK/W4/deepOF_L1/h300
Evaluating performance on  test set...
534/534 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.123162
{'0': {'precision': 0.38608822103732426, 'recall': 0.030884662362589427, 'f1-score': 0.05719414774257248, 'support': 51579}, '1': {'precision': 0.28006823314593243, 'recall': 0.9188145345629385, 'f1-score': 0.42928428069012503, 'support': 38061}, '2': {'precision': 0.3487855837033168, 'recall': 0.056817698362050625, 'f1-score': 0.09771712885051584, 'support': 47010}, 'accuracy': 0.2871203805342115, 'macro avg': {'precision': 0.3383140126288578, 'recall': 0.3355056317625262, 'f1-score': 0.1947318524277378, 'support': 136650}, 'weighted avg': {'precision': 0.34372580800983826, 'recall': 0.2871203805342115, 'f1-score': 0.1747726906770856, 'support': 136650}}
[[ 1593 47015  2971]
 [ 1074 34971  2016]
 [ 1459 42880  2671]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1063639
{'0': {'precision': 0.39123711340206185, 'recall': 0.035150280183392765, 'f1-score': 0.06450516296264819, 'support': 21593}, '1': {'precision': 0.3353774757603381, 'recall': 0.9376737720111215, 'f1-score': 0.49404870902765063, 'support': 21580}, '2': {'precision': 0.4027830011282437, 'recall': 0.049216488212857866, 'f1-score': 0.08771498771498773, 'support': 21761}, 'accuracy': 0.33980657282779436, 'macro avg': {'precision': 0.37646586343021454, 'recall': 0.34068018013579066, 'f1-score': 0.21542295323509553, 'support': 64934}, 'weighted avg': {'precision': 0.3765421782756419, 'recall': 0.33980657282779436, 'f1-score': 0.2150367599768228, 'support': 64934}}
[[  759 20009   825]
 [  582 20235   763]
 [  599 20091  1071]]
Evaluating performance on  val set...
81/81 - 1s - 590ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1191001
{'0': {'precision': 0.3245341614906832, 'recall': 0.028532423208191125, 'f1-score': 0.05245325636842765, 'support': 7325}, '1': {'precision': 0.30097699338165773, 'recall': 0.9241935483870968, 'f1-score': 0.4540771851969252, 'support': 6200}, '2': {'precision': 0.3468950749464668, 'recall': 0.04569172190100127, 'f1-score': 0.08074766355140188, 'support': 7091}, 'accuracy': 0.3037931703531238, 'macro avg': {'precision': 0.32413540993960255, 'recall': 0.3328058978320964, 'f1-score': 0.19575936837225158, 'support': 20616}, 'weighted avg': {'precision': 0.3251408162752682, 'recall': 0.3037931703531238, 'f1-score': 0.18296858427253876, 'support': 20616}}
[[ 209 6778  338]
 [ 198 5730  272]
 [ 237 6530  324]]
training model: results/LILAK/W4/deepOF_L1/h500
Epoch 1/50
254/254 - 6s - loss: 3.3296 - accuracy500: 0.3463 - val_loss: 3.3488 - val_accuracy500: 0.3063 - 6s/epoch - 25ms/step
Epoch 2/50
254/254 - 4s - loss: 3.3106 - accuracy500: 0.3495 - val_loss: 3.3411 - val_accuracy500: 0.3099 - 4s/epoch - 17ms/step
Epoch 3/50
254/254 - 4s - loss: 3.3040 - accuracy500: 0.3514 - val_loss: 3.3364 - val_accuracy500: 0.3102 - 4s/epoch - 17ms/step
Epoch 4/50
254/254 - 4s - loss: 3.3004 - accuracy500: 0.3537 - val_loss: 3.3376 - val_accuracy500: 0.3056 - 4s/epoch - 17ms/step
Epoch 5/50
254/254 - 4s - loss: 3.2964 - accuracy500: 0.3546 - val_loss: 3.3368 - val_accuracy500: 0.3026 - 4s/epoch - 16ms/step
Epoch 6/50
254/254 - 4s - loss: 3.2955 - accuracy500: 0.3574 - val_loss: 3.3396 - val_accuracy500: 0.2963 - 4s/epoch - 16ms/step
Epoch 7/50
254/254 - 4s - loss: 3.2939 - accuracy500: 0.3568 - val_loss: 3.3403 - val_accuracy500: 0.2987 - 4s/epoch - 16ms/step
Epoch 8/50
254/254 - 4s - loss: 3.2919 - accuracy500: 0.3600 - val_loss: 3.3385 - val_accuracy500: 0.2986 - 4s/epoch - 16ms/step
Epoch 9/50
254/254 - 4s - loss: 3.2907 - accuracy500: 0.3602 - val_loss: 3.3414 - val_accuracy500: 0.2967 - 4s/epoch - 16ms/step
Epoch 10/50
254/254 - 4s - loss: 3.2894 - accuracy500: 0.3625 - val_loss: 3.3424 - val_accuracy500: 0.2972 - 4s/epoch - 16ms/step
Epoch 11/50
254/254 - 4s - loss: 3.2888 - accuracy500: 0.3612 - val_loss: 3.3459 - val_accuracy500: 0.3044 - 4s/epoch - 16ms/step
Epoch 12/50
254/254 - 4s - loss: 3.2866 - accuracy500: 0.3634 - val_loss: 3.3463 - val_accuracy500: 0.3078 - 4s/epoch - 16ms/step
Epoch 13/50
254/254 - 4s - loss: 3.2851 - accuracy500: 0.3660 - val_loss: 3.3496 - val_accuracy500: 0.3004 - 4s/epoch - 17ms/step
testing model: results/LILAK/W4/deepOF_L1/h500
Evaluating performance on  test set...
534/534 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1117669
{'0': {'precision': 0.3671836330638508, 'recall': 0.08761983503612276, 'f1-score': 0.14147899747302176, 'support': 50799}, '1': {'precision': 0.304857063558146, 'recall': 0.5266589950134254, 'f1-score': 0.3861758604929157, 'support': 41712}, '2': {'precision': 0.3249980940763894, 'recall': 0.3863250186909536, 'f1-score': 0.35301789725382227, 'support': 44139}, 'accuracy': 0.31811928283937063, 'macro avg': {'precision': 0.33234626356612873, 'recall': 0.33353461624683395, 'f1-score': 0.29355758507325325, 'support': 136650}, 'weighted avg': {'precision': 0.33453238262411783, 'recall': 0.31811928283937063, 'f1-score': 0.2845006663183241, 'support': 136650}}
[[ 4451 26918 19430]
 [ 3758 21968 15986]
 [ 3913 23174 17052]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1035566
{'0': {'precision': 0.3457174231332357, 'recall': 0.08784412202380952, 'f1-score': 0.14009196084247996, 'support': 21504}, '1': {'precision': 0.33693850161837846, 'recall': 0.5905086934464788, 'f1-score': 0.42905971449634744, 'support': 21683}, '2': {'precision': 0.3459406586240626, 'recall': 0.3415183703499333, 'f1-score': 0.34371529063309886, 'support': 21747}, 'accuracy': 0.3406535867188222, 'macro avg': {'precision': 0.3428655277918922, 'recall': 0.33995706194007386, 'f1-score': 0.30428898865730875, 'support': 64934}, 'weighted avg': {'precision': 0.34286069702691796, 'recall': 0.3406535867188222, 'f1-score': 0.3047804808078818, 'support': 64934}}
[[ 1889 12648  6967]
 [ 1804 12804  7075]
 [ 1771 12549  7427]]
Evaluating performance on  val set...
81/81 - 1s - 590ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1123621
{'0': {'precision': 0.3721058434399118, 'recall': 0.08930934109552792, 'f1-score': 0.14404609475032012, 'support': 7558}, '1': {'precision': 0.2781819738080972, 'recall': 0.5734956767248985, 'f1-score': 0.3746397694524496, 'support': 5667}, '2': {'precision': 0.3577749683944374, 'recall': 0.344608307400893, 'f1-score': 0.3510682288077189, 'support': 7391}, 'accuracy': 0.31393092743500195, 'macro avg': {'precision': 0.33602092854748217, 'recall': 0.3358044417404398, 'f1-score': 0.28991803100349617, 'support': 20616}, 'weighted avg': {'precision': 0.3411499806796967, 'recall': 0.31393092743500195, 'f1-score': 0.281651592778803, 'support': 20616}}
[[ 675 4264 2619]
 [ 464 3250 1953]
 [ 675 4169 2547]]
training model: results/LILAK/W4/deepOF_L1/h1000
Epoch 1/50
254/254 - 6s - loss: 3.3311 - accuracy1000: 0.3536 - val_loss: 3.3521 - val_accuracy1000: 0.3052 - 6s/epoch - 25ms/step
Epoch 2/50
254/254 - 4s - loss: 3.3232 - accuracy1000: 0.3470 - val_loss: 3.3239 - val_accuracy1000: 0.3228 - 4s/epoch - 17ms/step
Epoch 3/50
254/254 - 4s - loss: 3.3125 - accuracy1000: 0.3515 - val_loss: 3.3193 - val_accuracy1000: 0.3196 - 4s/epoch - 17ms/step
Epoch 4/50
254/254 - 4s - loss: 3.3087 - accuracy1000: 0.3509 - val_loss: 3.3177 - val_accuracy1000: 0.3193 - 4s/epoch - 18ms/step
Epoch 5/50
254/254 - 4s - loss: 3.3046 - accuracy1000: 0.3499 - val_loss: 3.3231 - val_accuracy1000: 0.3079 - 4s/epoch - 17ms/step
Epoch 6/50
254/254 - 4s - loss: 3.3052 - accuracy1000: 0.3507 - val_loss: 3.3193 - val_accuracy1000: 0.3242 - 4s/epoch - 16ms/step
Epoch 7/50
254/254 - 4s - loss: 3.3007 - accuracy1000: 0.3526 - val_loss: 3.3212 - val_accuracy1000: 0.3200 - 4s/epoch - 16ms/step
Epoch 8/50
254/254 - 4s - loss: 3.2991 - accuracy1000: 0.3515 - val_loss: 3.3186 - val_accuracy1000: 0.3412 - 4s/epoch - 16ms/step
Epoch 9/50
254/254 - 4s - loss: 3.2990 - accuracy1000: 0.3550 - val_loss: 3.3196 - val_accuracy1000: 0.3363 - 4s/epoch - 16ms/step
Epoch 10/50
254/254 - 4s - loss: 3.2972 - accuracy1000: 0.3520 - val_loss: 3.3243 - val_accuracy1000: 0.3443 - 4s/epoch - 16ms/step
Epoch 11/50
254/254 - 4s - loss: 3.2953 - accuracy1000: 0.3520 - val_loss: 3.3251 - val_accuracy1000: 0.3465 - 4s/epoch - 17ms/step
Epoch 12/50
254/254 - 4s - loss: 3.2941 - accuracy1000: 0.3536 - val_loss: 3.3294 - val_accuracy1000: 0.3413 - 4s/epoch - 16ms/step
Epoch 13/50
254/254 - 4s - loss: 3.2923 - accuracy1000: 0.3583 - val_loss: 3.3265 - val_accuracy1000: 0.3400 - 4s/epoch - 16ms/step
Epoch 14/50
254/254 - 4s - loss: 3.2922 - accuracy1000: 0.3539 - val_loss: 3.3268 - val_accuracy1000: 0.3411 - 4s/epoch - 16ms/step
testing model: results/LILAK/W4/deepOF_L1/h1000
Evaluating performance on  test set...
534/534 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1118906
{'0': {'precision': 0.39292427497314714, 'recall': 0.1059002334038973, 'f1-score': 0.16683531675336707, 'support': 55269}, '1': {'precision': 0.2809914918088385, 'recall': 0.4978706727629001, 'f1-score': 0.3592353806130528, 'support': 38275}, '2': {'precision': 0.31095537386209837, 'recall': 0.38908736602793115, 'f1-score': 0.34566120173531323, 'support': 43106}, 'accuracy': 0.3050201244054153, 'macro avg': {'precision': 0.32829038021469464, 'recall': 0.33095275739824287, 'f1-score': 0.2905772997005777, 'support': 136650}, 'weighted avg': {'precision': 0.3357155027308728, 'recall': 0.3050201244054153, 'f1-score': 0.27713594640767547, 'support': 136650}}
[[ 5853 27308 22108]
 [ 4162 19056 15057]
 [ 4881 21453 16772]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1015273
{'0': {'precision': 0.3324712643678161, 'recall': 0.10840438489646773, 'f1-score': 0.16349890482583201, 'support': 21346}, '1': {'precision': 0.33161179255433615, 'recall': 0.4311494520867335, 'f1-score': 0.37488596509011296, 'support': 21445}, '2': {'precision': 0.34391200319021664, 'recall': 0.4673711782504629, 'f1-score': 0.3962477266200823, 'support': 22143}, 'accuracy': 0.3374041334277882, 'macro avg': {'precision': 0.3359983533707897, 'recall': 0.3356416717445547, 'f1-score': 0.31154419884534246, 'support': 64934}, 'weighted avg': {'precision': 0.3360887976586089, 'recall': 0.3374041334277882, 'f1-score': 0.31268042249542866, 'support': 64934}}
[[ 2314  9253  9779]
 [ 2235  9246  9964]
 [ 2411  9383 10349]]
Evaluating performance on  val set...
81/81 - 1s - 594ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.10712
{'0': {'precision': 0.36557231588287487, 'recall': 0.11093161012385568, 'f1-score': 0.1702127659574468, 'support': 7428}, '1': {'precision': 0.2677898470405675, 'recall': 0.4368107033086241, 'f1-score': 0.33202776059918915, 'support': 5531}, '2': {'precision': 0.3708779443254818, 'recall': 0.45239649993470027, 'f1-score': 0.4076013414131906, 'support': 7657}, 'accuracy': 0.32518432285603416, 'macro avg': {'precision': 0.33474670241630805, 'recall': 0.3333796044557267, 'f1-score': 0.3032806226566089, 'support': 20616}, 'weighted avg': {'precision': 0.3413091397972248, 'recall': 0.32518432285603416, 'f1-score': 0.3017942103515148, 'support': 20616}}
[[ 824 3263 3341]
 [ 580 2416 2535]
 [ 850 3343 3464]]
training model: results/LILAK/W4/deepLOB_L2/h10
Epoch 1/50
254/254 - 14s - loss: 3.3443 - accuracy10: 0.3562 - val_loss: 3.4461 - val_accuracy10: 0.3635 - 14s/epoch - 54ms/step
Epoch 2/50
254/254 - 11s - loss: 3.3020 - accuracy10: 0.3647 - val_loss: 3.4418 - val_accuracy10: 0.3824 - 11s/epoch - 43ms/step
Epoch 3/50
254/254 - 11s - loss: 3.2810 - accuracy10: 0.3730 - val_loss: 3.4038 - val_accuracy10: 0.3735 - 11s/epoch - 42ms/step
Epoch 4/50
254/254 - 11s - loss: 3.2563 - accuracy10: 0.3877 - val_loss: 3.4447 - val_accuracy10: 0.4040 - 11s/epoch - 42ms/step
Epoch 5/50
254/254 - 11s - loss: 3.2324 - accuracy10: 0.3962 - val_loss: 3.4881 - val_accuracy10: 0.3972 - 11s/epoch - 42ms/step
Epoch 6/50
254/254 - 11s - loss: 3.2179 - accuracy10: 0.4048 - val_loss: 3.4759 - val_accuracy10: 0.3955 - 11s/epoch - 42ms/step
Epoch 7/50
254/254 - 11s - loss: 3.1944 - accuracy10: 0.4156 - val_loss: 3.4137 - val_accuracy10: 0.3971 - 11s/epoch - 42ms/step
Epoch 8/50
254/254 - 11s - loss: 3.1853 - accuracy10: 0.4200 - val_loss: 3.4820 - val_accuracy10: 0.3925 - 11s/epoch - 42ms/step
Epoch 9/50
254/254 - 11s - loss: 3.1676 - accuracy10: 0.4287 - val_loss: 3.4074 - val_accuracy10: 0.4009 - 11s/epoch - 42ms/step
Epoch 10/50
254/254 - 11s - loss: 3.1527 - accuracy10: 0.4348 - val_loss: 3.3910 - val_accuracy10: 0.3856 - 11s/epoch - 42ms/step
Epoch 11/50
254/254 - 11s - loss: 3.1398 - accuracy10: 0.4412 - val_loss: 3.4069 - val_accuracy10: 0.3872 - 11s/epoch - 42ms/step
Epoch 12/50
254/254 - 11s - loss: 3.1282 - accuracy10: 0.4435 - val_loss: 3.4078 - val_accuracy10: 0.3908 - 11s/epoch - 42ms/step
Epoch 13/50
254/254 - 11s - loss: 3.1107 - accuracy10: 0.4523 - val_loss: 3.4098 - val_accuracy10: 0.3730 - 11s/epoch - 43ms/step
Epoch 14/50
254/254 - 11s - loss: 3.0998 - accuracy10: 0.4546 - val_loss: 3.4840 - val_accuracy10: 0.3809 - 11s/epoch - 42ms/step
Epoch 15/50
254/254 - 11s - loss: 3.0829 - accuracy10: 0.4626 - val_loss: 3.5149 - val_accuracy10: 0.3917 - 11s/epoch - 43ms/step
Epoch 16/50
254/254 - 11s - loss: 3.0756 - accuracy10: 0.4654 - val_loss: 3.5521 - val_accuracy10: 0.3921 - 11s/epoch - 42ms/step
Epoch 17/50
254/254 - 11s - loss: 3.0629 - accuracy10: 0.4697 - val_loss: 3.4473 - val_accuracy10: 0.3784 - 11s/epoch - 42ms/step
Epoch 18/50
254/254 - 11s - loss: 3.0548 - accuracy10: 0.4715 - val_loss: 3.5399 - val_accuracy10: 0.3941 - 11s/epoch - 42ms/step
Epoch 19/50
254/254 - 11s - loss: 3.0426 - accuracy10: 0.4757 - val_loss: 3.4541 - val_accuracy10: 0.3820 - 11s/epoch - 42ms/step
Epoch 20/50
254/254 - 11s - loss: 3.0311 - accuracy10: 0.4793 - val_loss: 3.4730 - val_accuracy10: 0.3870 - 11s/epoch - 42ms/step
testing model: results/LILAK/W4/deepLOB_L2/h10
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0968426
{'0': {'precision': 0.42111939724763586, 'recall': 0.23825058176203215, 'f1-score': 0.3043266893534273, 'support': 45981}, '1': {'precision': 0.37640189268096247, 'recall': 0.4123797758757611, 'f1-score': 0.3935703232733666, 'support': 45332}, '2': {'precision': 0.3881262812628126, 'recall': 0.521955845702565, 'f1-score': 0.44520109861168594, 'support': 45341}, 'accuracy': 0.3901459159629429, 'macro avg': {'precision': 0.39521585706380363, 'recall': 0.3908620677801194, 'f1-score': 0.38103270374616, 'support': 136654}, 'weighted avg': {'precision': 0.395338411774219, 'recall': 0.3901459159629429, 'f1-score': 0.38067263607315294, 'support': 136654}}
[[10955 16893 18133]
 [ 7462 18694 19176]
 [ 7597 14078 23666]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0693446
{'0': {'precision': 0.39308304427667823, 'recall': 0.2234789165361638, 'f1-score': 0.2849535924268757, 'support': 17241}, '1': {'precision': 0.5482575582737134, 'recall': 0.39557731375095745, 'f1-score': 0.45956821171554596, 'support': 30027}, '2': {'precision': 0.3372972003943948, 'recall': 0.6389517772243605, 'f1-score': 0.44151983886422747, 'support': 17668}, 'accuracy': 0.4161020081310829, 'macro avg': {'precision': 0.42621260098159547, 'recall': 0.41933600250382724, 'f1-score': 0.3953472143355497, 'support': 64936}, 'weighted avg': {'precision': 0.44965876255431764, 'recall': 0.4161020081310829, 'f1-score': 0.40829604677324804, 'support': 64936}}
[[ 3853  5326  8062]
 [ 4031 11878 14118]
 [ 1918  4461 11289]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0964984
{'0': {'precision': 0.36833731105807477, 'recall': 0.15907919601443052, 'f1-score': 0.2221955608878224, 'support': 5821}, '1': {'precision': 0.4637383854229516, 'recall': 0.42904990510215474, 'f1-score': 0.44572025052192066, 'support': 8957}, '2': {'precision': 0.32008964955175223, 'recall': 0.538105840041103, 'f1-score': 0.4014053018205046, 'support': 5839}, 'accuracy': 0.383712470291507, 'macro avg': {'precision': 0.3840551153442595, 'recall': 0.37541164705256275, 'f1-score': 0.35644037107674925, 'support': 20617}, 'weighted avg': {'precision': 0.39611969101397443, 'recall': 0.383712470291507, 'f1-score': 0.37005976626971837, 'support': 20617}}
[[ 926 2314 2581]
 [1021 3843 4093]
 [ 567 2130 3142]]
training model: results/LILAK/W4/deepLOB_L2/h20
Epoch 1/50
254/254 - 13s - loss: 3.3537 - accuracy20: 0.3488 - val_loss: 3.3814 - val_accuracy20: 0.3372 - 13s/epoch - 52ms/step
Epoch 2/50
254/254 - 11s - loss: 3.3075 - accuracy20: 0.3651 - val_loss: 3.3891 - val_accuracy20: 0.3371 - 11s/epoch - 44ms/step
Epoch 3/50
254/254 - 11s - loss: 3.2809 - accuracy20: 0.3794 - val_loss: 3.3508 - val_accuracy20: 0.3485 - 11s/epoch - 44ms/step
Epoch 4/50
254/254 - 11s - loss: 3.2616 - accuracy20: 0.3915 - val_loss: 3.4073 - val_accuracy20: 0.3370 - 11s/epoch - 44ms/step
Epoch 5/50
254/254 - 11s - loss: 3.2411 - accuracy20: 0.4048 - val_loss: 3.4547 - val_accuracy20: 0.3421 - 11s/epoch - 43ms/step
Epoch 6/50
254/254 - 11s - loss: 3.2227 - accuracy20: 0.4148 - val_loss: 3.4489 - val_accuracy20: 0.3501 - 11s/epoch - 43ms/step
Epoch 7/50
254/254 - 11s - loss: 3.2119 - accuracy20: 0.4190 - val_loss: 3.4853 - val_accuracy20: 0.3461 - 11s/epoch - 43ms/step
Epoch 8/50
254/254 - 11s - loss: 3.2004 - accuracy20: 0.4246 - val_loss: 3.3926 - val_accuracy20: 0.3574 - 11s/epoch - 44ms/step
Epoch 9/50
254/254 - 11s - loss: 3.1833 - accuracy20: 0.4336 - val_loss: 3.4019 - val_accuracy20: 0.3539 - 11s/epoch - 43ms/step
Epoch 10/50
254/254 - 11s - loss: 3.1719 - accuracy20: 0.4384 - val_loss: 3.3611 - val_accuracy20: 0.3573 - 11s/epoch - 43ms/step
Epoch 11/50
254/254 - 11s - loss: 3.1615 - accuracy20: 0.4455 - val_loss: 3.3549 - val_accuracy20: 0.3647 - 11s/epoch - 42ms/step
Epoch 12/50
254/254 - 11s - loss: 3.1467 - accuracy20: 0.4470 - val_loss: 3.3201 - val_accuracy20: 0.3766 - 11s/epoch - 42ms/step
Epoch 13/50
254/254 - 11s - loss: 3.1335 - accuracy20: 0.4551 - val_loss: 3.4409 - val_accuracy20: 0.3575 - 11s/epoch - 42ms/step
Epoch 14/50
254/254 - 11s - loss: 3.1232 - accuracy20: 0.4572 - val_loss: 3.3601 - val_accuracy20: 0.3705 - 11s/epoch - 42ms/step
Epoch 15/50
254/254 - 11s - loss: 3.1127 - accuracy20: 0.4632 - val_loss: 3.3472 - val_accuracy20: 0.3715 - 11s/epoch - 42ms/step
Epoch 16/50
254/254 - 11s - loss: 3.1007 - accuracy20: 0.4647 - val_loss: 3.4301 - val_accuracy20: 0.3744 - 11s/epoch - 42ms/step
Epoch 17/50
254/254 - 11s - loss: 3.0876 - accuracy20: 0.4709 - val_loss: 3.3804 - val_accuracy20: 0.3710 - 11s/epoch - 42ms/step
Epoch 18/50
254/254 - 11s - loss: 3.0763 - accuracy20: 0.4750 - val_loss: 3.4255 - val_accuracy20: 0.3748 - 11s/epoch - 43ms/step
Epoch 19/50
254/254 - 11s - loss: 3.0695 - accuracy20: 0.4776 - val_loss: 3.4583 - val_accuracy20: 0.3757 - 11s/epoch - 43ms/step
Epoch 20/50
254/254 - 11s - loss: 3.0545 - accuracy20: 0.4840 - val_loss: 3.4505 - val_accuracy20: 0.3708 - 11s/epoch - 43ms/step
Epoch 21/50
254/254 - 11s - loss: 3.0516 - accuracy20: 0.4820 - val_loss: 3.4851 - val_accuracy20: 0.3689 - 11s/epoch - 43ms/step
Epoch 22/50
254/254 - 11s - loss: 3.0376 - accuracy20: 0.4866 - val_loss: 3.4359 - val_accuracy20: 0.3772 - 11s/epoch - 43ms/step
testing model: results/LILAK/W4/deepLOB_L2/h20
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0931033
{'0': {'precision': 0.42756859190903845, 'recall': 0.49213815602298805, 'f1-score': 0.4575867663656885, 'support': 52723}, '1': {'precision': 0.2548798193256977, 'recall': 0.14900037721614484, 'f1-score': 0.18806165565672794, 'support': 31812}, '2': {'precision': 0.41837481698389456, 'recall': 0.46054222068727335, 'f1-score': 0.43844699564347756, 'support': 52119}, 'accuracy': 0.40020782413979833, 'macro avg': {'precision': 0.3669410760728769, 'recall': 0.36722691797546875, 'f1-score': 0.3613651392219646, 'support': 136654}, 'weighted avg': {'precision': 0.38386152450709765, 'recall': 0.40020782413979833, 'f1-score': 0.3875436023738232, 'support': 136654}}
[[25947  6887 19889]
 [13592  4740 13480]
 [21146  6970 24003]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0867316
{'0': {'precision': 0.4069400630914827, 'recall': 0.36172887255849934, 'f1-score': 0.3830048630662913, 'support': 20684}, '1': {'precision': 0.43629501173110274, 'recall': 0.3726908330428721, 'f1-score': 0.4019925748390432, 'support': 22952}, '2': {'precision': 0.4048767814726841, 'recall': 0.5121596244131456, 'f1-score': 0.452242765939806, 'support': 21300}, 'accuracy': 0.4149470247628434, 'macro avg': {'precision': 0.4160372854317565, 'recall': 0.4155264433381724, 'f1-score': 0.4124134012817135, 'support': 64936}, 'weighted avg': {'precision': 0.4166389494210402, 'recall': 0.4149470247628434, 'f1-score': 0.4124272680775957, 'support': 64936}}
[[ 7482  5613  7589]
 [ 5952  8554  8446]
 [ 4952  5439 10909]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1088222
{'0': {'precision': 0.371341983142343, 'recall': 0.5615869378401604, 'f1-score': 0.44706687190011973, 'support': 6982}, '1': {'precision': 0.39312221672439385, 'recall': 0.23617717003567182, 'f1-score': 0.2950789229340761, 'support': 6728}, '2': {'precision': 0.36868351063829785, 'recall': 0.32112349790068045, 'f1-score': 0.3432639479996905, 'support': 6907}, 'accuracy': 0.3748363001406606, 'macro avg': {'precision': 0.3777159035016782, 'recall': 0.37296253525883755, 'f1-score': 0.3618032476112954, 'support': 20617}, 'weighted avg': {'precision': 0.3775589566086377, 'recall': 0.3748363001406606, 'f1-score': 0.3626927284251328, 'support': 20617}}
[[3921 1214 1847]
 [3188 1589 1951]
 [3450 1239 2218]]
training model: results/LILAK/W4/deepLOB_L2/h30
Epoch 1/50
254/254 - 13s - loss: 3.3554 - accuracy30: 0.3411 - val_loss: 3.4051 - val_accuracy30: 0.3349 - 13s/epoch - 51ms/step
Epoch 2/50
254/254 - 11s - loss: 3.3056 - accuracy30: 0.3619 - val_loss: 3.4142 - val_accuracy30: 0.3300 - 11s/epoch - 44ms/step
Epoch 3/50
254/254 - 11s - loss: 3.2826 - accuracy30: 0.3750 - val_loss: 3.4043 - val_accuracy30: 0.3272 - 11s/epoch - 44ms/step
Epoch 4/50
254/254 - 11s - loss: 3.2719 - accuracy30: 0.3835 - val_loss: 3.3838 - val_accuracy30: 0.3364 - 11s/epoch - 43ms/step
Epoch 5/50
254/254 - 11s - loss: 3.2515 - accuracy30: 0.3963 - val_loss: 3.3779 - val_accuracy30: 0.3328 - 11s/epoch - 42ms/step
Epoch 6/50
254/254 - 11s - loss: 3.2349 - accuracy30: 0.4069 - val_loss: 3.3758 - val_accuracy30: 0.3419 - 11s/epoch - 43ms/step
Epoch 7/50
254/254 - 11s - loss: 3.2233 - accuracy30: 0.4125 - val_loss: 3.3478 - val_accuracy30: 0.3539 - 11s/epoch - 43ms/step
Epoch 8/50
254/254 - 11s - loss: 3.2077 - accuracy30: 0.4212 - val_loss: 3.3625 - val_accuracy30: 0.3514 - 11s/epoch - 42ms/step
Epoch 9/50
254/254 - 11s - loss: 3.2006 - accuracy30: 0.4241 - val_loss: 3.3823 - val_accuracy30: 0.3467 - 11s/epoch - 42ms/step
Epoch 10/50
254/254 - 11s - loss: 3.1850 - accuracy30: 0.4310 - val_loss: 3.3547 - val_accuracy30: 0.3508 - 11s/epoch - 42ms/step
Epoch 11/50
254/254 - 11s - loss: 3.1712 - accuracy30: 0.4370 - val_loss: 3.3582 - val_accuracy30: 0.3552 - 11s/epoch - 42ms/step
Epoch 12/50
254/254 - 11s - loss: 3.1566 - accuracy30: 0.4433 - val_loss: 3.3670 - val_accuracy30: 0.3517 - 11s/epoch - 42ms/step
Epoch 13/50
254/254 - 11s - loss: 3.1489 - accuracy30: 0.4457 - val_loss: 3.3769 - val_accuracy30: 0.3548 - 11s/epoch - 42ms/step
Epoch 14/50
254/254 - 11s - loss: 3.1375 - accuracy30: 0.4514 - val_loss: 3.4009 - val_accuracy30: 0.3575 - 11s/epoch - 42ms/step
Epoch 15/50
254/254 - 11s - loss: 3.1266 - accuracy30: 0.4549 - val_loss: 3.3839 - val_accuracy30: 0.3616 - 11s/epoch - 42ms/step
Epoch 16/50
254/254 - 11s - loss: 3.1121 - accuracy30: 0.4593 - val_loss: 3.4093 - val_accuracy30: 0.3586 - 11s/epoch - 42ms/step
Epoch 17/50
254/254 - 11s - loss: 3.0973 - accuracy30: 0.4661 - val_loss: 3.4200 - val_accuracy30: 0.3589 - 11s/epoch - 42ms/step
testing model: results/LILAK/W4/deepLOB_L2/h30
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1179167
{'0': {'precision': 0.4237782340862423, 'recall': 0.19819837123540257, 'f1-score': 0.27008139869657394, 'support': 52064}, '1': {'precision': 0.2404046725073008, 'recall': 0.2778614911699114, 'f1-score': 0.25777951743227, 'support': 33182}, '2': {'precision': 0.38926601038511466, 'recall': 0.5599712107065048, 'f1-score': 0.4592693044033184, 'support': 51408}, 'accuracy': 0.3536376542216108, 'macro avg': {'precision': 0.3511496389928859, 'recall': 0.3453436910372729, 'f1-score': 0.32904340684405414, 'support': 136654}, 'weighted avg': {'precision': 0.36626871430387214, 'recall': 0.3536376542216108, 'f1-score': 0.3382650657129817, 'support': 136654}}
[[10319 14705 27040]
 [ 5837  9220 18125]
 [ 8194 14427 28787]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0888656
{'0': {'precision': 0.39000057009292516, 'recall': 0.3206017433686381, 'f1-score': 0.3519123434244708, 'support': 21338}, '1': {'precision': 0.40284775465498357, 'recall': 0.33956515718044594, 'f1-score': 0.3685093805575734, 'support': 21663}, '2': {'precision': 0.39107602539900466, 'recall': 0.5194438112605425, 'f1-score': 0.44621108282749167, 'support': 21935}, 'accuracy': 0.3940957250215597, 'macro avg': {'precision': 0.39464145004897117, 'recall': 0.3932035706032089, 'f1-score': 0.3888776022698453, 'support': 64936}, 'weighted avg': {'precision': 0.39464974268296343, 'recall': 0.3940957250215597, 'f1-score': 0.38930276575137207, 'support': 64936}}
[[ 6841  5592  8905]
 [ 5471  7356  8836]
 [ 5229  5312 11394]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.118009
{'0': {'precision': 0.3535587673847832, 'recall': 0.36210026532607176, 'f1-score': 0.35777854432562956, 'support': 7161}, '1': {'precision': 0.3235715748515257, 'recall': 0.2502772057658799, 'f1-score': 0.28224365844944627, 'support': 6313}, '2': {'precision': 0.3547619047619048, 'recall': 0.41719165616687665, 'f1-score': 0.38345235797465094, 'support': 7143}, 'accuracy': 0.3469466944754329, 'macro avg': {'precision': 0.3439640823327379, 'recall': 0.3431897090862761, 'f1-score': 0.3411581869165756, 'support': 20617}, 'weighted avg': {'precision': 0.3447934214965514, 'recall': 0.3469466944754329, 'f1-score': 0.3435444809972411, 'support': 20617}}
[[2593 1679 2889]
 [2202 1580 2531]
 [2539 1624 2980]]
training model: results/LILAK/W4/deepLOB_L2/h50
Epoch 1/50
254/254 - 13s - loss: 3.3496 - accuracy50: 0.3514 - val_loss: 3.4599 - val_accuracy50: 0.3220 - 13s/epoch - 50ms/step
Epoch 2/50
254/254 - 11s - loss: 3.3133 - accuracy50: 0.3575 - val_loss: 3.3391 - val_accuracy50: 0.3295 - 11s/epoch - 43ms/step
Epoch 3/50
254/254 - 11s - loss: 3.2909 - accuracy50: 0.3678 - val_loss: 3.3325 - val_accuracy50: 0.3295 - 11s/epoch - 42ms/step
Epoch 4/50
254/254 - 11s - loss: 3.2733 - accuracy50: 0.3808 - val_loss: 3.3522 - val_accuracy50: 0.3233 - 11s/epoch - 42ms/step
Epoch 5/50
254/254 - 11s - loss: 3.2630 - accuracy50: 0.3866 - val_loss: 3.3748 - val_accuracy50: 0.3232 - 11s/epoch - 42ms/step
Epoch 6/50
254/254 - 11s - loss: 3.2545 - accuracy50: 0.3935 - val_loss: 3.4281 - val_accuracy50: 0.3144 - 11s/epoch - 43ms/step
Epoch 7/50
254/254 - 11s - loss: 3.2438 - accuracy50: 0.4001 - val_loss: 3.3959 - val_accuracy50: 0.3228 - 11s/epoch - 42ms/step
Epoch 8/50
254/254 - 11s - loss: 3.2334 - accuracy50: 0.4063 - val_loss: 3.4025 - val_accuracy50: 0.3270 - 11s/epoch - 42ms/step
Epoch 9/50
254/254 - 11s - loss: 3.2241 - accuracy50: 0.4128 - val_loss: 3.4439 - val_accuracy50: 0.3256 - 11s/epoch - 42ms/step
Epoch 10/50
254/254 - 11s - loss: 3.2143 - accuracy50: 0.4188 - val_loss: 3.4350 - val_accuracy50: 0.3273 - 11s/epoch - 42ms/step
Epoch 11/50
254/254 - 11s - loss: 3.2059 - accuracy50: 0.4241 - val_loss: 3.4910 - val_accuracy50: 0.3259 - 11s/epoch - 42ms/step
Epoch 12/50
254/254 - 11s - loss: 3.1956 - accuracy50: 0.4272 - val_loss: 3.4853 - val_accuracy50: 0.3336 - 11s/epoch - 42ms/step
Epoch 13/50
254/254 - 11s - loss: 3.1857 - accuracy50: 0.4332 - val_loss: 3.4837 - val_accuracy50: 0.3361 - 11s/epoch - 42ms/step
testing model: results/LILAK/W4/deepLOB_L2/h50
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1094948
{'0': {'precision': 0.3790149500137577, 'recall': 0.4122177001037427, 'f1-score': 0.39491967622014734, 'support': 50124}, '1': {'precision': 0.2712837229766214, 'recall': 0.3665918979542199, 'f1-score': 0.31181757579937014, 'support': 37003}, '2': {'precision': 0.37375529001742597, 'recall': 0.24251418418236517, 'f1-score': 0.29416014596573725, 'support': 49527}, 'accuracy': 0.33835818929559325, 'macro avg': {'precision': 0.3413513210026016, 'recall': 0.34044126074677594, 'f1-score': 0.3336324659950849, 'support': 136654}, 'weighted avg': {'precision': 0.34793738349764053, 'recall': 0.33835818929559325, 'f1-score': 0.33589949183637385, 'support': 136654}}
[[20662 18333 11129]
 [14442 13565  8996]
 [19411 18105 12011]]
Evaluating performance on  train set...
254/254 - 6s - 6s/epoch - 24ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1070335
{'0': {'precision': 0.33650905669254294, 'recall': 0.4021835902722459, 'f1-score': 0.36642687898904946, 'support': 21341}, '1': {'precision': 0.36361040867933764, 'recall': 0.40828944355392716, 'f1-score': 0.38465687226285245, 'support': 21835}, '2': {'precision': 0.3623927038626609, 'recall': 0.24834558823529412, 'f1-score': 0.2947207678883072, 'support': 21760}, 'accuracy': 0.35268572132561293, 'macro avg': {'precision': 0.3541707230781805, 'recall': 0.3529395406871558, 'f1-score': 0.34860150638006976, 'support': 64936}, 'weighted avg': {'precision': 0.35429558778551795, 'recall': 0.35268572132561293, 'f1-score': 0.3485281313849675, 'support': 64936}}
[[8583 7989 4769]
 [8181 8915 4739]
 [8742 7614 5404]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1097171
{'0': {'precision': 0.35335781741867783, 'recall': 0.3700041203131438, 'f1-score': 0.36148943307614895, 'support': 7281}, '1': {'precision': 0.3040374749051974, 'recall': 0.4441909727880072, 'f1-score': 0.3609878832020128, 'support': 6137}, '2': {'precision': 0.3635460640675441, 'recall': 0.20336157799694402, 'f1-score': 0.2608230892570818, 'support': 7199}, 'accuracy': 0.333899209390309, 'macro avg': {'precision': 0.3403137854638065, 'recall': 0.3391855570326983, 'f1-score': 0.32776680184508117, 'support': 20617}, 'weighted avg': {'precision': 0.34223429050496385, 'recall': 0.333899209390309, 'f1-score': 0.32618967943929406, 'support': 20617}}
[[2694 3181 1406]
 [2254 2726 1157]
 [2676 3059 1464]]
training model: results/LILAK/W4/deepLOB_L2/h100
Epoch 1/50
254/254 - 13s - loss: 3.3362 - accuracy100: 0.3616 - val_loss: 3.4312 - val_accuracy100: 0.3262 - 13s/epoch - 52ms/step
Epoch 2/50
254/254 - 11s - loss: 3.3123 - accuracy100: 0.3697 - val_loss: 3.4876 - val_accuracy100: 0.3105 - 11s/epoch - 42ms/step
Epoch 3/50
254/254 - 11s - loss: 3.2958 - accuracy100: 0.3708 - val_loss: 3.4570 - val_accuracy100: 0.3118 - 11s/epoch - 43ms/step
Epoch 4/50
254/254 - 11s - loss: 3.2870 - accuracy100: 0.3700 - val_loss: 3.4529 - val_accuracy100: 0.3100 - 11s/epoch - 43ms/step
Epoch 5/50
254/254 - 11s - loss: 3.2718 - accuracy100: 0.3787 - val_loss: 3.5883 - val_accuracy100: 0.3088 - 11s/epoch - 43ms/step
Epoch 6/50
254/254 - 11s - loss: 3.2606 - accuracy100: 0.3863 - val_loss: 3.5350 - val_accuracy100: 0.3119 - 11s/epoch - 42ms/step
Epoch 7/50
254/254 - 11s - loss: 3.2495 - accuracy100: 0.3952 - val_loss: 3.5978 - val_accuracy100: 0.3139 - 11s/epoch - 42ms/step
Epoch 8/50
254/254 - 11s - loss: 3.2407 - accuracy100: 0.4002 - val_loss: 3.5395 - val_accuracy100: 0.3086 - 11s/epoch - 43ms/step
Epoch 9/50
254/254 - 11s - loss: 3.2233 - accuracy100: 0.4124 - val_loss: 3.4393 - val_accuracy100: 0.3102 - 11s/epoch - 42ms/step
Epoch 10/50
254/254 - 11s - loss: 3.2077 - accuracy100: 0.4195 - val_loss: 3.4560 - val_accuracy100: 0.3193 - 11s/epoch - 42ms/step
Epoch 11/50
254/254 - 11s - loss: 3.1954 - accuracy100: 0.4259 - val_loss: 3.4497 - val_accuracy100: 0.3265 - 11s/epoch - 43ms/step
testing model: results/LILAK/W4/deepLOB_L2/h100
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2120186
{'0': {'precision': 0.39003383574284833, 'recall': 0.07389133855208718, 'f1-score': 0.12424470065649804, 'support': 51481}, '1': {'precision': 0.24197621758597368, 'recall': 0.8518685955394816, 'f1-score': 0.3768943055824094, 'support': 33180}, '2': {'precision': 0.3522592152199762, 'recall': 0.06837458888696556, 'f1-score': 0.11452041555931383, 'support': 51993}, 'accuracy': 0.2606875759216708, 'macro avg': {'precision': 0.32808975618293273, 'recall': 0.3313781743261781, 'f1-score': 0.20521980726607372, 'support': 136654}, 'weighted avg': {'precision': 0.3397128234395803, 'recall': 0.2606875759216708, 'f1-score': 0.18188896380564729, 'support': 136654}}
[[ 3804 43744  3933]
 [ 2311 28265  2604]
 [ 3638 44800  3555]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1748861
{'0': {'precision': 0.3290167865707434, 'recall': 0.12697825080981026, 'f1-score': 0.18323873121869783, 'support': 21610}, '1': {'precision': 0.3342916128036427, 'recall': 0.8117123448114313, 'f1-score': 0.4735561811572416, 'support': 21345}, '2': {'precision': 0.36521921543947977, 'recall': 0.07920476775396934, 'f1-score': 0.13017795723044714, 'support': 21981}, 'accuracy': 0.33588456326228905, 'macro avg': {'precision': 0.3428425382712887, 'recall': 0.3392984544584037, 'f1-score': 0.26232428986879547, 'support': 64936}, 'weighted avg': {'precision': 0.343005279161986, 'recall': 0.33588456326228905, 'f1-score': 0.2607072709486239, 'support': 64936}}
[[ 2744 17103  1763]
 [ 2756 17326  1263]
 [ 2840 17400  1741]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1470249
{'0': {'precision': 0.3402607986960065, 'recall': 0.11558693244739757, 'f1-score': 0.1725563132878694, 'support': 7224}, '1': {'precision': 0.31523981433728726, 'recall': 0.7607342874922215, 'f1-score': 0.4457611668185961, 'support': 6428}, '2': {'precision': 0.36967182195397963, 'recall': 0.1407035175879397, 'f1-score': 0.20382695507487522, 'support': 6965}, 'accuracy': 0.3252170538875685, 'macro avg': {'precision': 0.34172414499575776, 'recall': 0.3390082458425196, 'f1-score': 0.2740481450604469, 'support': 20617}, 'weighted avg': {'precision': 0.3423955850147694, 'recall': 0.3252170538875685, 'f1-score': 0.2683006416839506, 'support': 20617}}
[[ 835 5436  953]
 [ 820 4890  718]
 [ 799 5186  980]]
training model: results/LILAK/W4/deepLOB_L2/h200
Epoch 1/50
254/254 - 13s - loss: 3.3464 - accuracy200: 0.3532 - val_loss: 3.4363 - val_accuracy200: 0.3215 - 13s/epoch - 51ms/step
Epoch 2/50
254/254 - 11s - loss: 3.3133 - accuracy200: 0.3599 - val_loss: 3.3916 - val_accuracy200: 0.3208 - 11s/epoch - 42ms/step
Epoch 3/50
254/254 - 11s - loss: 3.2909 - accuracy200: 0.3697 - val_loss: 3.3477 - val_accuracy200: 0.3281 - 11s/epoch - 44ms/step
Epoch 4/50
254/254 - 11s - loss: 3.2848 - accuracy200: 0.3719 - val_loss: 3.3476 - val_accuracy200: 0.3191 - 11s/epoch - 42ms/step
Epoch 5/50
254/254 - 11s - loss: 3.2696 - accuracy200: 0.3851 - val_loss: 3.3683 - val_accuracy200: 0.3152 - 11s/epoch - 42ms/step
Epoch 6/50
254/254 - 11s - loss: 3.2583 - accuracy200: 0.3935 - val_loss: 3.3652 - val_accuracy200: 0.3147 - 11s/epoch - 42ms/step
Epoch 7/50
254/254 - 11s - loss: 3.2514 - accuracy200: 0.3967 - val_loss: 3.3722 - val_accuracy200: 0.3197 - 11s/epoch - 42ms/step
Epoch 8/50
254/254 - 11s - loss: 3.2390 - accuracy200: 0.4043 - val_loss: 3.3726 - val_accuracy200: 0.3225 - 11s/epoch - 42ms/step
Epoch 9/50
254/254 - 11s - loss: 3.2239 - accuracy200: 0.4130 - val_loss: 3.3844 - val_accuracy200: 0.3274 - 11s/epoch - 42ms/step
Epoch 10/50
254/254 - 11s - loss: 3.2117 - accuracy200: 0.4203 - val_loss: 3.3865 - val_accuracy200: 0.3234 - 11s/epoch - 42ms/step
Epoch 11/50
254/254 - 11s - loss: 3.2006 - accuracy200: 0.4252 - val_loss: 3.3974 - val_accuracy200: 0.3403 - 11s/epoch - 42ms/step
Epoch 12/50
254/254 - 11s - loss: 3.1906 - accuracy200: 0.4311 - val_loss: 3.4025 - val_accuracy200: 0.3462 - 11s/epoch - 42ms/step
Epoch 13/50
254/254 - 11s - loss: 3.1653 - accuracy200: 0.4403 - val_loss: 3.4348 - val_accuracy200: 0.3312 - 11s/epoch - 42ms/step
Epoch 14/50
254/254 - 11s - loss: 3.1618 - accuracy200: 0.4401 - val_loss: 3.4260 - val_accuracy200: 0.3368 - 11s/epoch - 43ms/step
testing model: results/LILAK/W4/deepLOB_L2/h200
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1142895
{'0': {'precision': 0.3639604960085823, 'recall': 0.23259330953965277, 'f1-score': 0.2838127106758851, 'support': 49593}, '1': {'precision': 0.29179164486196024, 'recall': 0.5864501564824791, 'f1-score': 0.3896905283433763, 'support': 38982}, '2': {'precision': 0.34741113699556625, 'recall': 0.1923084922731338, 'f1-score': 0.24757340045251894, 'support': 48079}, 'accuracy': 0.31936130665769025, 'macro avg': {'precision': 0.33438775928870296, 'recall': 0.3371173194317552, 'f1-score': 0.3070255464905935, 'support': 136654}, 'weighted avg': {'precision': 0.3375510035137822, 'recall': 0.31936130665769025, 'f1-score': 0.3012653962327288, 'support': 136654}}
[[11535 28358  9700]
 [ 8453 22861  7668]
 [11705 27128  9246]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1053616
{'0': {'precision': 0.3485642044428391, 'recall': 0.44690408928819525, 'f1-score': 0.39165550549941147, 'support': 21593}, '1': {'precision': 0.36674816625916873, 'recall': 0.454312473789665, 'f1-score': 0.40586104982724897, 'support': 21461}, '2': {'precision': 0.37483592724545284, 'recall': 0.18270724796636506, 'f1-score': 0.2456679365859654, 'support': 21882}, 'accuracy': 0.3603240113342368, 'macro avg': {'precision': 0.36338276598248687, 'recall': 0.3613079370147418, 'f1-score': 0.3477281639708753, 'support': 64936}, 'weighted avg': {'precision': 0.36342689760082614, 'recall': 0.3603240113342368, 'f1-score': 0.34715577043497403, 'support': 64936}}
[[9650 8549 3394]
 [8437 9750 3274]
 [9598 8286 3998]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1157436
{'0': {'precision': 0.35073300755219905, 'recall': 0.42360831656606307, 'f1-score': 0.3837414180691415, 'support': 7455}, '1': {'precision': 0.28103731518422903, 'recall': 0.40415119811002365, 'f1-score': 0.33153377630121816, 'support': 5926}, '2': {'precision': 0.3477838887091556, 'recall': 0.14856274184632393, 'f1-score': 0.20819211774958846, 'support': 7236}, 'accuracy': 0.32148227191152934, 'macro avg': {'precision': 0.32651807048186127, 'recall': 0.32544075217413687, 'f1-score': 0.30782243737331605, 'support': 20617}, 'weighted avg': {'precision': 0.3296651268265429, 'recall': 0.32148227191152934, 'f1-score': 0.30712225804445314, 'support': 20617}}
[[3158 3209 1088]
 [2603 2395  928]
 [3243 2918 1075]]
training model: results/LILAK/W4/deepLOB_L2/h300
Epoch 1/50
254/254 - 13s - loss: 3.3429 - accuracy300: 0.3606 - val_loss: 3.4440 - val_accuracy300: 0.3351 - 13s/epoch - 50ms/step
Epoch 2/50
254/254 - 11s - loss: 3.3082 - accuracy300: 0.3691 - val_loss: 3.4176 - val_accuracy300: 0.3201 - 11s/epoch - 42ms/step
Epoch 3/50
254/254 - 11s - loss: 3.2974 - accuracy300: 0.3707 - val_loss: 3.4056 - val_accuracy300: 0.3193 - 11s/epoch - 43ms/step
Epoch 4/50
254/254 - 11s - loss: 3.2783 - accuracy300: 0.3792 - val_loss: 3.3655 - val_accuracy300: 0.3259 - 11s/epoch - 42ms/step
Epoch 5/50
254/254 - 11s - loss: 3.2671 - accuracy300: 0.3881 - val_loss: 3.4066 - val_accuracy300: 0.2996 - 11s/epoch - 42ms/step
Epoch 6/50
254/254 - 11s - loss: 3.2558 - accuracy300: 0.3944 - val_loss: 3.4277 - val_accuracy300: 0.2921 - 11s/epoch - 42ms/step
Epoch 7/50
254/254 - 11s - loss: 3.2335 - accuracy300: 0.4097 - val_loss: 3.4251 - val_accuracy300: 0.2998 - 11s/epoch - 42ms/step
Epoch 8/50
254/254 - 11s - loss: 3.2221 - accuracy300: 0.4175 - val_loss: 3.4698 - val_accuracy300: 0.2931 - 11s/epoch - 42ms/step
Epoch 9/50
254/254 - 11s - loss: 3.2074 - accuracy300: 0.4256 - val_loss: 3.4227 - val_accuracy300: 0.3135 - 11s/epoch - 42ms/step
Epoch 10/50
254/254 - 11s - loss: 3.1901 - accuracy300: 0.4321 - val_loss: 3.4376 - val_accuracy300: 0.3132 - 11s/epoch - 42ms/step
Epoch 11/50
254/254 - 11s - loss: 3.1721 - accuracy300: 0.4397 - val_loss: 3.5476 - val_accuracy300: 0.2943 - 11s/epoch - 42ms/step
Epoch 12/50
254/254 - 11s - loss: 3.1538 - accuracy300: 0.4464 - val_loss: 3.5223 - val_accuracy300: 0.3114 - 11s/epoch - 42ms/step
Epoch 13/50
254/254 - 11s - loss: 3.1391 - accuracy300: 0.4538 - val_loss: 3.5706 - val_accuracy300: 0.3055 - 11s/epoch - 42ms/step
Epoch 14/50
254/254 - 11s - loss: 3.1205 - accuracy300: 0.4600 - val_loss: 3.5904 - val_accuracy300: 0.3208 - 11s/epoch - 42ms/step
testing model: results/LILAK/W4/deepLOB_L2/h300
Evaluating performance on  test set...
534/534 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1462606
{'0': {'precision': 0.3700792782941498, 'recall': 0.10498051608150288, 'f1-score': 0.16356304653164785, 'support': 51581}, '1': {'precision': 0.2794581752420127, 'recall': 0.8282493891384882, 'f1-score': 0.4179100520332748, 'support': 38061}, '2': {'precision': 0.32751139075721414, 'recall': 0.06421764655832553, 'f1-score': 0.1073804019206829, 'support': 47012}, 'accuracy': 0.29240271049511907, 'macro avg': {'precision': 0.32568294809779225, 'recall': 0.33248251725943884, 'f1-score': 0.22961783349520185, 'support': 136654}, 'weighted avg': {'precision': 0.3301951085504628, 'recall': 0.29240271049511907, 'f1-score': 0.2150759395896391, 'support': 136654}}
[[ 5415 42605  3561]
 [ 3899 31524  2638]
 [ 5318 38675  3019]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1175374
{'0': {'precision': 0.34661640639023517, 'recall': 0.26854255516410164, 'f1-score': 0.30262504897479436, 'support': 21572}, '1': {'precision': 0.34777551613841234, 'recall': 0.6644444444444444, 'f1-score': 0.456575682382134, 'support': 21600}, '2': {'precision': 0.35514018691588783, 'recall': 0.11349016724866752, 'f1-score': 0.1720115602910965, 'support': 21764}, 'accuracy': 0.3482659849698164, 'macro avg': {'precision': 0.3498440364815118, 'recall': 0.3488257222857378, 'f1-score': 0.31040409721600826, 'support': 64936}, 'weighted avg': {'precision': 0.3498588039804922, 'recall': 0.3482659849698164, 'f1-score': 0.31005793233512663, 'support': 64936}}
[[ 5793 13381  2398]
 [ 5161 14352  2087]
 [ 5759 13535  2470]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1228198
{'0': {'precision': 0.3563022827165745, 'recall': 0.34448252227553117, 'f1-score': 0.3502927237245609, 'support': 7295}, '1': {'precision': 0.30164870590402504, 'recall': 0.5259354424281355, 'f1-score': 0.3833996722079138, 'support': 6227}, '2': {'precision': 0.3494643516808275, 'recall': 0.13333333333333333, 'f1-score': 0.1930218322791267, 'support': 7095}, 'accuracy': 0.32662366008633653, 'macro avg': {'precision': 0.335805113433809, 'recall': 0.33458376601233336, 'f1-score': 0.3089047427372005, 'support': 20617}, 'weighted avg': {'precision': 0.33744197600316467, 'recall': 0.32662366008633653, 'f1-score': 0.3061699121322091, 'support': 20617}}
[[2513 3819  963]
 [2154 3275  798]
 [2386 3763  946]]
training model: results/LILAK/W4/deepLOB_L2/h500
Epoch 1/50
254/254 - 13s - loss: 3.3410 - accuracy500: 0.3584 - val_loss: 3.4094 - val_accuracy500: 0.3188 - 13s/epoch - 50ms/step
Epoch 2/50
254/254 - 11s - loss: 3.3101 - accuracy500: 0.3652 - val_loss: 3.3771 - val_accuracy500: 0.3263 - 11s/epoch - 42ms/step
Epoch 3/50
254/254 - 11s - loss: 3.2918 - accuracy500: 0.3692 - val_loss: 3.4152 - val_accuracy500: 0.3084 - 11s/epoch - 43ms/step
Epoch 4/50
254/254 - 11s - loss: 3.2699 - accuracy500: 0.3838 - val_loss: 3.3811 - val_accuracy500: 0.3226 - 11s/epoch - 43ms/step
Epoch 5/50
254/254 - 11s - loss: 3.2434 - accuracy500: 0.3986 - val_loss: 3.4205 - val_accuracy500: 0.3211 - 11s/epoch - 43ms/step
Epoch 6/50
254/254 - 11s - loss: 3.2202 - accuracy500: 0.4111 - val_loss: 3.5312 - val_accuracy500: 0.2940 - 11s/epoch - 42ms/step
Epoch 7/50
254/254 - 11s - loss: 3.2086 - accuracy500: 0.4190 - val_loss: 3.4801 - val_accuracy500: 0.3094 - 11s/epoch - 42ms/step
Epoch 8/50
254/254 - 11s - loss: 3.1960 - accuracy500: 0.4243 - val_loss: 3.5277 - val_accuracy500: 0.3209 - 11s/epoch - 42ms/step
Epoch 9/50
254/254 - 11s - loss: 3.1706 - accuracy500: 0.4351 - val_loss: 3.5507 - val_accuracy500: 0.3249 - 11s/epoch - 42ms/step
Epoch 10/50
254/254 - 11s - loss: 3.1597 - accuracy500: 0.4410 - val_loss: 3.5910 - val_accuracy500: 0.3290 - 11s/epoch - 42ms/step
Epoch 11/50
254/254 - 11s - loss: 3.1371 - accuracy500: 0.4507 - val_loss: 3.5882 - val_accuracy500: 0.3214 - 11s/epoch - 42ms/step
Epoch 12/50
254/254 - 11s - loss: 3.1146 - accuracy500: 0.4601 - val_loss: 3.5386 - val_accuracy500: 0.3245 - 11s/epoch - 42ms/step
testing model: results/LILAK/W4/deepLOB_L2/h500
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1312761
{'0': {'precision': 0.35912000721305565, 'recall': 0.23521653543307086, 'f1-score': 0.28425297063266447, 'support': 50800}, '1': {'precision': 0.30413452027695353, 'recall': 0.3685661544362669, 'f1-score': 0.3332646889869178, 'support': 41713}, '2': {'precision': 0.301906077870947, 'recall': 0.36134206293468657, 'f1-score': 0.32896093717774205, 'support': 44141}, 'accuracy': 0.3166610563905923, 'macro avg': {'precision': 0.3217202017869854, 'recall': 0.32170825093467476, 'f1-score': 0.3154928655991081, 'support': 136654}, 'weighted avg': {'precision': 0.32385510701506914, 'recall': 0.3166610563905923, 'f1-score': 0.3136548187964741, 'support': 136654}}
[[11949 18785 20066]
 [ 9524 15374 16815]
 [11800 16391 15950]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1197498
{'0': {'precision': 0.33573336808496773, 'recall': 0.47983795865151796, 'f1-score': 0.3950546290971823, 'support': 21476}, '1': {'precision': 0.34089714804375865, 'recall': 0.32890855457227136, 'f1-score': 0.3347955617068193, 'support': 21696}, '2': {'precision': 0.36501615448192953, 'recall': 0.22321264473442382, 'f1-score': 0.27702221081743794, 'support': 21764}, 'accuracy': 0.34339965504496733, 'macro avg': {'precision': 0.34721555687021866, 'recall': 0.34398638598607106, 'f1-score': 0.33562413387381324, 'support': 64936}, 'weighted avg': {'precision': 0.3472730984830429, 'recall': 0.34339965504496733, 'f1-score': 0.335361419205263, 'support': 64936}}
[[10305  6907  4264]
 [10373  7136  4187]
 [10016  6890  4858]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1235813
{'0': {'precision': 0.34682002706359943, 'recall': 0.33893149960327956, 'f1-score': 0.3428303905831996, 'support': 7562}, '1': {'precision': 0.2678125, 'recall': 0.3026129943502825, 'f1-score': 0.2841511936339523, 'support': 5664}, '2': {'precision': 0.360773399736341, 'recall': 0.3332431335407929, 'f1-score': 0.34646223097482065, 'support': 7391}, 'accuracy': 0.32691468205849544, 'macro avg': {'precision': 0.3251353089333135, 'recall': 0.324929209164785, 'f1-score': 0.3244812717306575, 'support': 20617}, 'weighted avg': {'precision': 0.33011685706486077, 'recall': 0.32691468205849544, 'f1-score': 0.32801174387484894, 'support': 20617}}
[[2563 2396 2603]
 [2189 1714 1761]
 [2638 2290 2463]]
training model: results/LILAK/W4/deepLOB_L2/h1000
Epoch 1/50
254/254 - 13s - loss: 3.3275 - accuracy1000: 0.3752 - val_loss: 3.4643 - val_accuracy1000: 0.3030 - 13s/epoch - 53ms/step
Epoch 2/50
254/254 - 11s - loss: 3.2994 - accuracy1000: 0.3808 - val_loss: 3.4873 - val_accuracy1000: 0.3136 - 11s/epoch - 43ms/step
Epoch 3/50
254/254 - 11s - loss: 3.2818 - accuracy1000: 0.3873 - val_loss: 3.4466 - val_accuracy1000: 0.3383 - 11s/epoch - 43ms/step
Epoch 4/50
254/254 - 11s - loss: 3.2552 - accuracy1000: 0.4009 - val_loss: 3.5275 - val_accuracy1000: 0.3175 - 11s/epoch - 42ms/step
Epoch 5/50
254/254 - 11s - loss: 3.2232 - accuracy1000: 0.4086 - val_loss: 3.4869 - val_accuracy1000: 0.3387 - 11s/epoch - 42ms/step
Epoch 6/50
254/254 - 11s - loss: 3.1930 - accuracy1000: 0.4245 - val_loss: 3.4512 - val_accuracy1000: 0.3447 - 11s/epoch - 42ms/step
Epoch 7/50
254/254 - 11s - loss: 3.1656 - accuracy1000: 0.4439 - val_loss: 3.4351 - val_accuracy1000: 0.3351 - 11s/epoch - 42ms/step
Epoch 8/50
254/254 - 11s - loss: 3.1429 - accuracy1000: 0.4527 - val_loss: 3.4129 - val_accuracy1000: 0.3538 - 11s/epoch - 43ms/step
Epoch 9/50
254/254 - 11s - loss: 3.1218 - accuracy1000: 0.4601 - val_loss: 3.4841 - val_accuracy1000: 0.3537 - 11s/epoch - 42ms/step
Epoch 10/50
254/254 - 11s - loss: 3.0942 - accuracy1000: 0.4695 - val_loss: 3.5851 - val_accuracy1000: 0.3461 - 11s/epoch - 42ms/step
Epoch 11/50
254/254 - 11s - loss: 3.0705 - accuracy1000: 0.4772 - val_loss: 3.6647 - val_accuracy1000: 0.3498 - 11s/epoch - 42ms/step
Epoch 12/50
254/254 - 11s - loss: 3.0570 - accuracy1000: 0.4816 - val_loss: 3.7731 - val_accuracy1000: 0.3440 - 11s/epoch - 42ms/step
Epoch 13/50
254/254 - 11s - loss: 3.0220 - accuracy1000: 0.4917 - val_loss: 3.6990 - val_accuracy1000: 0.3457 - 11s/epoch - 42ms/step
Epoch 14/50
254/254 - 11s - loss: 3.0064 - accuracy1000: 0.4966 - val_loss: 3.9860 - val_accuracy1000: 0.3468 - 11s/epoch - 42ms/step
Epoch 15/50
254/254 - 11s - loss: 2.9811 - accuracy1000: 0.5051 - val_loss: 4.1188 - val_accuracy1000: 0.3464 - 11s/epoch - 42ms/step
Epoch 16/50
254/254 - 11s - loss: 2.9829 - accuracy1000: 0.5044 - val_loss: 4.0815 - val_accuracy1000: 0.3481 - 11s/epoch - 42ms/step
Epoch 17/50
254/254 - 11s - loss: 2.9513 - accuracy1000: 0.5142 - val_loss: 3.8344 - val_accuracy1000: 0.3358 - 11s/epoch - 42ms/step
Epoch 18/50
254/254 - 11s - loss: 2.9191 - accuracy1000: 0.5219 - val_loss: 4.0959 - val_accuracy1000: 0.3402 - 11s/epoch - 42ms/step
testing model: results/LILAK/W4/deepLOB_L2/h1000
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.186208
{'0': {'precision': 0.3927230987865758, 'recall': 0.3899875160572452, 'f1-score': 0.39135052697513545, 'support': 55271}, '1': {'precision': 0.29541414859580517, 'recall': 0.06513389941214892, 'f1-score': 0.10673459776512394, 'support': 38275}, '2': {'precision': 0.27930286789673936, 'recall': 0.4751090284865918, 'f1-score': 0.3517953914992657, 'support': 43108}, 'accuracy': 0.32585215215068714, 'macro avg': {'precision': 0.32248003842637346, 'recall': 0.31007681465199527, 'f1-score': 0.28329350541317505, 'support': 136654}, 'weighted avg': {'precision': 0.3296893099347982, 'recall': 0.32585215215068714, 'f1-score': 0.29915551277425595, 'support': 136654}}
[[21555  2507 31209]
 [14143  2493 21639]
 [19188  3439 20481]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1526436
{'0': {'precision': 0.33751651254953763, 'recall': 0.64604794905413, 'f1-score': 0.44339107240415204, 'support': 21356}, '1': {'precision': 0.37143284028089046, 'recall': 0.11609227608106847, 'f1-score': 0.17689543530081472, 'support': 21414}, '2': {'precision': 0.37103368845378637, 'recall': 0.2906703961021384, 'f1-score': 0.3259720219574511, 'support': 22166}, 'accuracy': 0.3499753603548109, 'macro avg': {'precision': 0.35999434709473815, 'recall': 0.3509368737457789, 'f1-score': 0.31541950988747264, 'support': 64936}, 'weighted avg': {'precision': 0.3601422665709243, 'recall': 0.3499753603548109, 'f1-score': 0.31542741210582076, 'support': 64936}}
[[13797  1958  5601]
 [13607  2486  5321]
 [13474  2249  6443]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1359893
{'0': {'precision': 0.3364262990455992, 'recall': 0.341450289250639, 'f1-score': 0.338919676837818, 'support': 7433}, '1': {'precision': 0.28738621586475943, 'recall': 0.04002173125679102, 'f1-score': 0.07025910030201875, 'support': 5522}, '2': {'precision': 0.37256176853055917, 'recall': 0.5982772122161315, 'f1-score': 0.4591806070319543, 'support': 7662}, 'accuracy': 0.35616239026046465, 'macro avg': {'precision': 0.3321247611469726, 'recall': 0.3265830775745205, 'f1-score': 0.2894531280572637, 'support': 20617}, 'weighted avg': {'precision': 0.3367207467280538, 'recall': 0.35616239026046465, 'f1-score': 0.3116555522569764, 'support': 20617}}
[[2538  280 4615]
 [2196  221 3105]
 [2810  268 4584]]
training model: results/LILAK/W4/deepOF_L2/h10
Epoch 1/50
254/254 - 13s - loss: 3.3306 - accuracy10: 0.3630 - val_loss: 3.3527 - val_accuracy10: 0.3662 - 13s/epoch - 52ms/step
Epoch 2/50
254/254 - 7s - loss: 3.2793 - accuracy10: 0.3898 - val_loss: 3.3243 - val_accuracy10: 0.3872 - 7s/epoch - 26ms/step
Epoch 3/50
254/254 - 6s - loss: 3.2538 - accuracy10: 0.4059 - val_loss: 3.3178 - val_accuracy10: 0.3951 - 6s/epoch - 24ms/step
Epoch 4/50
254/254 - 6s - loss: 3.2306 - accuracy10: 0.4179 - val_loss: 3.3062 - val_accuracy10: 0.3962 - 6s/epoch - 24ms/step
Epoch 5/50
254/254 - 6s - loss: 3.2084 - accuracy10: 0.4253 - val_loss: 3.2927 - val_accuracy10: 0.4061 - 6s/epoch - 24ms/step
Epoch 6/50
254/254 - 6s - loss: 3.1924 - accuracy10: 0.4352 - val_loss: 3.2806 - val_accuracy10: 0.4094 - 6s/epoch - 24ms/step
Epoch 7/50
254/254 - 6s - loss: 3.1740 - accuracy10: 0.4445 - val_loss: 3.2808 - val_accuracy10: 0.4113 - 6s/epoch - 24ms/step
Epoch 8/50
254/254 - 6s - loss: 3.1589 - accuracy10: 0.4494 - val_loss: 3.2707 - val_accuracy10: 0.4190 - 6s/epoch - 24ms/step
Epoch 9/50
254/254 - 6s - loss: 3.1403 - accuracy10: 0.4587 - val_loss: 3.2673 - val_accuracy10: 0.4254 - 6s/epoch - 25ms/step
Epoch 10/50
254/254 - 6s - loss: 3.1265 - accuracy10: 0.4623 - val_loss: 3.2638 - val_accuracy10: 0.4264 - 6s/epoch - 24ms/step
Epoch 11/50
254/254 - 6s - loss: 3.1125 - accuracy10: 0.4699 - val_loss: 3.2666 - val_accuracy10: 0.4336 - 6s/epoch - 24ms/step
Epoch 12/50
254/254 - 6s - loss: 3.0981 - accuracy10: 0.4738 - val_loss: 3.2616 - val_accuracy10: 0.4345 - 6s/epoch - 25ms/step
Epoch 13/50
254/254 - 6s - loss: 3.0832 - accuracy10: 0.4796 - val_loss: 3.2668 - val_accuracy10: 0.4327 - 6s/epoch - 25ms/step
Epoch 14/50
254/254 - 6s - loss: 3.0645 - accuracy10: 0.4860 - val_loss: 3.2671 - val_accuracy10: 0.4359 - 6s/epoch - 24ms/step
Epoch 15/50
254/254 - 6s - loss: 3.0561 - accuracy10: 0.4843 - val_loss: 3.2661 - val_accuracy10: 0.4429 - 6s/epoch - 24ms/step
Epoch 16/50
254/254 - 6s - loss: 3.0375 - accuracy10: 0.4912 - val_loss: 3.2666 - val_accuracy10: 0.4408 - 6s/epoch - 24ms/step
Epoch 17/50
254/254 - 6s - loss: 3.0261 - accuracy10: 0.4930 - val_loss: 3.2781 - val_accuracy10: 0.4372 - 6s/epoch - 24ms/step
Epoch 18/50
254/254 - 6s - loss: 3.0144 - accuracy10: 0.4967 - val_loss: 3.2848 - val_accuracy10: 0.4388 - 6s/epoch - 24ms/step
Epoch 19/50
254/254 - 6s - loss: 3.0017 - accuracy10: 0.4987 - val_loss: 3.2882 - val_accuracy10: 0.4401 - 6s/epoch - 24ms/step
Epoch 20/50
254/254 - 6s - loss: 2.9848 - accuracy10: 0.5035 - val_loss: 3.3036 - val_accuracy10: 0.4369 - 6s/epoch - 25ms/step
Epoch 21/50
254/254 - 6s - loss: 2.9683 - accuracy10: 0.5073 - val_loss: 3.3047 - val_accuracy10: 0.4374 - 6s/epoch - 25ms/step
Epoch 22/50
254/254 - 6s - loss: 2.9530 - accuracy10: 0.5099 - val_loss: 3.3211 - val_accuracy10: 0.4351 - 6s/epoch - 24ms/step
testing model: results/LILAK/W4/deepOF_L2/h10
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.061716
{'0': {'precision': 0.4497318330003155, 'recall': 0.37203940929554796, 'f1-score': 0.40721299767898594, 'support': 45979}, '1': {'precision': 0.43627075351213285, 'recall': 0.45213094502779494, 'f1-score': 0.4440592772337291, 'support': 45332}, '2': {'precision': 0.4419181159700972, 'recall': 0.5032753258783829, 'f1-score': 0.47060522000969346, 'support': 45339}, 'accuracy': 0.4421514818880351, 'macro avg': {'precision': 0.4426402341608486, 'recall': 0.44248189340057525, 'f1-score': 0.4406258316408029, 'support': 136650}, 'weighted avg': {'precision': 0.442673773931224, 'recall': 0.4421514818880351, 'f1-score': 0.44046916681932674, 'support': 136650}}
[[17106 14030 14843]
 [10863 20496 13973]
 [10067 12454 22818]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0305821
{'0': {'precision': 0.4217566053897345, 'recall': 0.36914648212226064, 'f1-score': 0.39370175600455143, 'support': 17340}, '1': {'precision': 0.594371438539365, 'recall': 0.5121413540866429, 'f1-score': 0.5502009473230945, 'support': 29939}, '2': {'precision': 0.39657762938230384, 'recall': 0.5382044746530728, 'f1-score': 0.4566622612038928, 'support': 17655}, 'accuracy': 0.48104228909354113, 'macro avg': {'precision': 0.47090189110380115, 'recall': 0.4731641036206587, 'f1-score': 0.4668549881771796, 'support': 64934}, 'weighted avg': {'precision': 0.49449786063745677, 'recall': 0.48104228909354113, 'f1-score': 0.4829769740441029, 'support': 64934}}
[[ 6401  5374  5565]
 [ 5713 15333  8893]
 [ 3063  5090  9502]]
Evaluating performance on  val set...
81/81 - 1s - 826ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0763389
{'0': {'precision': 0.3719278033794163, 'recall': 0.3341959972394755, 'f1-score': 0.35205379861868413, 'support': 5796}, '1': {'precision': 0.534549327652776, 'recall': 0.4467564259485924, 'f1-score': 0.4867256637168142, 'support': 8987}, '2': {'precision': 0.3641889325060149, 'recall': 0.4930567460997771, 'f1-score': 0.41893663510560814, 'support': 5833}, 'accuracy': 0.42821109817617387, 'macro avg': {'precision': 0.4235553545127357, 'recall': 0.42466972309594836, 'f1-score': 0.41923869914703543, 'support': 20616}, 'weighted avg': {'precision': 0.4406287543320808, 'recall': 0.42821109817617387, 'f1-score': 0.4296839711480362, 'support': 20616}}
[[1937 1802 2057]
 [2008 4015 2964]
 [1263 1694 2876]]
training model: results/LILAK/W4/deepOF_L2/h20
Epoch 1/50
254/254 - 8s - loss: 3.3316 - accuracy20: 0.3553 - val_loss: 3.3252 - val_accuracy20: 0.3526 - 8s/epoch - 32ms/step
Epoch 2/50
254/254 - 6s - loss: 3.2845 - accuracy20: 0.3784 - val_loss: 3.3069 - val_accuracy20: 0.3653 - 6s/epoch - 25ms/step
Epoch 3/50
254/254 - 6s - loss: 3.2663 - accuracy20: 0.3883 - val_loss: 3.2986 - val_accuracy20: 0.3744 - 6s/epoch - 24ms/step
Epoch 4/50
254/254 - 6s - loss: 3.2456 - accuracy20: 0.4025 - val_loss: 3.2877 - val_accuracy20: 0.3822 - 6s/epoch - 24ms/step
Epoch 5/50
254/254 - 6s - loss: 3.2296 - accuracy20: 0.4129 - val_loss: 3.2835 - val_accuracy20: 0.3856 - 6s/epoch - 25ms/step
Epoch 6/50
254/254 - 6s - loss: 3.2156 - accuracy20: 0.4191 - val_loss: 3.2698 - val_accuracy20: 0.3937 - 6s/epoch - 24ms/step
Epoch 7/50
254/254 - 6s - loss: 3.2024 - accuracy20: 0.4262 - val_loss: 3.2740 - val_accuracy20: 0.3938 - 6s/epoch - 24ms/step
Epoch 8/50
254/254 - 6s - loss: 3.1900 - accuracy20: 0.4336 - val_loss: 3.2683 - val_accuracy20: 0.3996 - 6s/epoch - 24ms/step
Epoch 9/50
254/254 - 6s - loss: 3.1745 - accuracy20: 0.4417 - val_loss: 3.2602 - val_accuracy20: 0.4018 - 6s/epoch - 24ms/step
Epoch 10/50
254/254 - 6s - loss: 3.1626 - accuracy20: 0.4451 - val_loss: 3.2570 - val_accuracy20: 0.4082 - 6s/epoch - 25ms/step
Epoch 11/50
254/254 - 6s - loss: 3.1474 - accuracy20: 0.4530 - val_loss: 3.2629 - val_accuracy20: 0.4103 - 6s/epoch - 24ms/step
Epoch 12/50
254/254 - 6s - loss: 3.1381 - accuracy20: 0.4542 - val_loss: 3.2608 - val_accuracy20: 0.4128 - 6s/epoch - 24ms/step
Epoch 13/50
254/254 - 6s - loss: 3.1224 - accuracy20: 0.4620 - val_loss: 3.2612 - val_accuracy20: 0.4122 - 6s/epoch - 24ms/step
Epoch 14/50
254/254 - 6s - loss: 3.1097 - accuracy20: 0.4661 - val_loss: 3.2706 - val_accuracy20: 0.4114 - 6s/epoch - 24ms/step
Epoch 15/50
254/254 - 6s - loss: 3.0971 - accuracy20: 0.4685 - val_loss: 3.2731 - val_accuracy20: 0.4132 - 6s/epoch - 24ms/step
Epoch 16/50
254/254 - 6s - loss: 3.0856 - accuracy20: 0.4753 - val_loss: 3.2709 - val_accuracy20: 0.4161 - 6s/epoch - 24ms/step
Epoch 17/50
254/254 - 6s - loss: 3.0713 - accuracy20: 0.4793 - val_loss: 3.2771 - val_accuracy20: 0.4131 - 6s/epoch - 24ms/step
Epoch 18/50
254/254 - 6s - loss: 3.0590 - accuracy20: 0.4832 - val_loss: 3.2781 - val_accuracy20: 0.4175 - 6s/epoch - 24ms/step
Epoch 19/50
254/254 - 6s - loss: 3.0459 - accuracy20: 0.4868 - val_loss: 3.2909 - val_accuracy20: 0.4169 - 6s/epoch - 24ms/step
Epoch 20/50
254/254 - 6s - loss: 3.0341 - accuracy20: 0.4912 - val_loss: 3.2978 - val_accuracy20: 0.4152 - 6s/epoch - 24ms/step
testing model: results/LILAK/W4/deepOF_L2/h20
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0716137
{'0': {'precision': 0.4719851487535561, 'recall': 0.37133210675063066, 'f1-score': 0.41565197082771577, 'support': 52721}, '1': {'precision': 0.3146281148944265, 'recall': 0.41594366905570224, 'f1-score': 0.35826068121514054, 'support': 31812}, '2': {'precision': 0.4640033135025228, 'recall': 0.47289751904369015, 'f1-score': 0.4684081989489989, 'support': 52117}, 'accuracy': 0.4204537138675448, 'macro avg': {'precision': 0.41687219238350176, 'recall': 0.4200577649500077, 'f1-score': 0.41410695033061834, 'support': 136650}, 'weighted avg': {'precision': 0.4323083740085526, 'recall': 0.4204537138675448, 'f1-score': 0.4224120486604393, 'support': 136650}}
[[19577 14862 18282]
 [ 8392 13232 10188]
 [13509 13962 24646]]
Evaluating performance on  train set...
254/254 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0520978
{'0': {'precision': 0.45242413251118363, 'recall': 0.3596866439179122, 'f1-score': 0.40076039519130363, 'support': 20807}, '1': {'precision': 0.47161776604352085, 'recall': 0.4836878193649823, 'f1-score': 0.47757654161276414, 'support': 22897}, '2': {'precision': 0.42635192099241237, 'recall': 0.5002355157795573, 'f1-score': 0.4603480786319599, 'support': 21230}, 'accuracy': 0.4493639695691009, 'macro avg': {'precision': 0.4501312731823723, 'recall': 0.44786999302081726, 'f1-score': 0.4462283384786759, 'support': 64934}, 'weighted avg': {'precision': 0.45066794278694694, 'recall': 0.4493639695691009, 'f1-score': 0.44732930861196635, 'support': 64934}}
[[ 7484  6174  7149]
 [ 4682 11075  7140]
 [ 4376  6234 10620]]
Evaluating performance on  val set...
81/81 - 1s - 825ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0838027
{'0': {'precision': 0.4054621848739496, 'recall': 0.33299784327821713, 'f1-score': 0.36567458751085496, 'support': 6955}, '1': {'precision': 0.40331087020216816, 'recall': 0.4094289113622844, 'f1-score': 0.4063468634686347, 'support': 6724}, '2': {'precision': 0.4048031691012627, 'recall': 0.4713853250684734, 'f1-score': 0.4355644355644355, 'support': 6937}, 'accuracy': 0.40449165696546374, 'macro avg': {'precision': 0.4045254080591268, 'recall': 0.40460402656965827, 'f1-score': 0.402528628847975, 'support': 20616}, 'weighted avg': {'precision': 0.4045387743060321, 'recall': 0.40449165696546374, 'f1-score': 0.4024570021154242, 'support': 20616}}
[[2316 2105 2534]
 [1697 2753 2274]
 [1699 1968 3270]]
training model: results/LILAK/W4/deepOF_L2/h30
Epoch 1/50
254/254 - 9s - loss: 3.3369 - accuracy30: 0.3469 - val_loss: 3.3256 - val_accuracy30: 0.3447 - 9s/epoch - 37ms/step
Epoch 2/50
254/254 - 7s - loss: 3.2976 - accuracy30: 0.3662 - val_loss: 3.3088 - val_accuracy30: 0.3532 - 7s/epoch - 26ms/step
Epoch 3/50
254/254 - 7s - loss: 3.2802 - accuracy30: 0.3762 - val_loss: 3.2999 - val_accuracy30: 0.3579 - 7s/epoch - 26ms/step
Epoch 4/50
254/254 - 7s - loss: 3.2625 - accuracy30: 0.3891 - val_loss: 3.2963 - val_accuracy30: 0.3622 - 7s/epoch - 26ms/step
Epoch 5/50
254/254 - 7s - loss: 3.2526 - accuracy30: 0.3975 - val_loss: 3.2925 - val_accuracy30: 0.3670 - 7s/epoch - 26ms/step
Epoch 6/50
254/254 - 7s - loss: 3.2416 - accuracy30: 0.4018 - val_loss: 3.2830 - val_accuracy30: 0.3738 - 7s/epoch - 26ms/step
Epoch 7/50
254/254 - 6s - loss: 3.2325 - accuracy30: 0.4055 - val_loss: 3.2878 - val_accuracy30: 0.3731 - 6s/epoch - 26ms/step
Epoch 8/50
254/254 - 6s - loss: 3.2208 - accuracy30: 0.4134 - val_loss: 3.2848 - val_accuracy30: 0.3771 - 6s/epoch - 25ms/step
Epoch 9/50
254/254 - 6s - loss: 3.2104 - accuracy30: 0.4206 - val_loss: 3.2805 - val_accuracy30: 0.3812 - 6s/epoch - 25ms/step
Epoch 10/50
254/254 - 6s - loss: 3.1997 - accuracy30: 0.4246 - val_loss: 3.2827 - val_accuracy30: 0.3815 - 6s/epoch - 25ms/step
Epoch 11/50
254/254 - 6s - loss: 3.1910 - accuracy30: 0.4302 - val_loss: 3.2816 - val_accuracy30: 0.3885 - 6s/epoch - 25ms/step
Epoch 12/50
254/254 - 6s - loss: 3.1801 - accuracy30: 0.4350 - val_loss: 3.2859 - val_accuracy30: 0.3888 - 6s/epoch - 25ms/step
Epoch 13/50
254/254 - 6s - loss: 3.1708 - accuracy30: 0.4367 - val_loss: 3.2830 - val_accuracy30: 0.3914 - 6s/epoch - 25ms/step
Epoch 14/50
254/254 - 6s - loss: 3.1590 - accuracy30: 0.4414 - val_loss: 3.2925 - val_accuracy30: 0.3873 - 6s/epoch - 25ms/step
Epoch 15/50
254/254 - 6s - loss: 3.1486 - accuracy30: 0.4473 - val_loss: 3.2992 - val_accuracy30: 0.3908 - 6s/epoch - 25ms/step
Epoch 16/50
254/254 - 6s - loss: 3.1373 - accuracy30: 0.4514 - val_loss: 3.2902 - val_accuracy30: 0.3947 - 6s/epoch - 25ms/step
Epoch 17/50
254/254 - 6s - loss: 3.1274 - accuracy30: 0.4576 - val_loss: 3.2958 - val_accuracy30: 0.3963 - 6s/epoch - 24ms/step
Epoch 18/50
254/254 - 6s - loss: 3.1183 - accuracy30: 0.4588 - val_loss: 3.3026 - val_accuracy30: 0.3937 - 6s/epoch - 24ms/step
Epoch 19/50
254/254 - 6s - loss: 3.1043 - accuracy30: 0.4666 - val_loss: 3.3095 - val_accuracy30: 0.3979 - 6s/epoch - 24ms/step
testing model: results/LILAK/W4/deepOF_L2/h30
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0924035
{'0': {'precision': 0.45414919903384326, 'recall': 0.31420833253299013, 'f1-score': 0.37143505903723883, 'support': 52061}, '1': {'precision': 0.2876757110166721, 'recall': 0.37128563679103127, 'f1-score': 0.324176402483949, 'support': 33182}, '2': {'precision': 0.4306547876481273, 'recall': 0.4842531172797479, 'f1-score': 0.45588396879463794, 'support': 51407}, 'accuracy': 0.39203805342114895, 'macro avg': {'precision': 0.39082656589954756, 'recall': 0.38991569553458977, 'f1-score': 0.3838318101052753, 'support': 136650}, 'weighted avg': {'precision': 0.40488684641407546, 'recall': 0.39203805342114895, 'f1-score': 0.3917287170112407, 'support': 136650}}
[[16358 15924 19779]
 [ 7730 12320 13132]
 [11931 14582 24894]]
Evaluating performance on  train set...
254/254 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.06817
{'0': {'precision': 0.4345355583467911, 'recall': 0.3397558808399196, 'f1-score': 0.381344811295995, 'support': 21383}, '1': {'precision': 0.4261506862104379, 'recall': 0.4213708746826679, 'f1-score': 0.4237473019704319, 'support': 21665}, '2': {'precision': 0.4148471615720524, 'recall': 0.5078589052362241, 'f1-score': 0.4566650917233305, 'support': 21886}, 'accuracy': 0.4236455477869837, 'macro avg': {'precision': 0.4251778020430938, 'recall': 0.4229952202529372, 'f1-score': 0.4205857349965858, 'support': 64934}, 'weighted avg': {'precision': 0.4251020026341287, 'recall': 0.4236455477869837, 'f1-score': 0.42087894777140605, 'support': 64934}}
[[ 7265  6195  7923]
 [ 4781  9129  7755]
 [ 4673  6098 11115]]
Evaluating performance on  val set...
81/81 - 1s - 814ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0925882
{'0': {'precision': 0.40043800539083557, 'recall': 0.33124303232998886, 'f1-score': 0.36256863941427697, 'support': 7176}, '1': {'precision': 0.35646636185499675, 'recall': 0.3469485060394151, 'f1-score': 0.3516430412371134, 'support': 6292}, '2': {'precision': 0.3952781673679289, 'recall': 0.4731393396754337, 'f1-score': 0.43071828833418235, 'support': 7148}, 'accuracy': 0.38523476911136983, 'macro avg': {'precision': 0.38406084487125375, 'recall': 0.3837769593482792, 'f1-score': 0.3816433229951908, 'support': 20616}, 'weighted avg': {'precision': 0.3852288424438413, 'recall': 0.38523476911136983, 'f1-score': 0.3828630625200575, 'support': 20616}}
[[2377 1951 2848]
 [1783 2183 2326]
 [1776 1990 3382]]
training model: results/LILAK/W4/deepOF_L2/h50
Epoch 1/50
254/254 - 8s - loss: 3.3422 - accuracy50: 0.3390 - val_loss: 3.3425 - val_accuracy50: 0.3290 - 8s/epoch - 32ms/step
Epoch 2/50
254/254 - 6s - loss: 3.3075 - accuracy50: 0.3555 - val_loss: 3.3312 - val_accuracy50: 0.3316 - 6s/epoch - 25ms/step
Epoch 3/50
254/254 - 6s - loss: 3.2927 - accuracy50: 0.3622 - val_loss: 3.3314 - val_accuracy50: 0.3300 - 6s/epoch - 24ms/step
Epoch 4/50
254/254 - 6s - loss: 3.2802 - accuracy50: 0.3713 - val_loss: 3.3281 - val_accuracy50: 0.3351 - 6s/epoch - 25ms/step
Epoch 5/50
254/254 - 6s - loss: 3.2701 - accuracy50: 0.3788 - val_loss: 3.3290 - val_accuracy50: 0.3302 - 6s/epoch - 24ms/step
Epoch 6/50
254/254 - 6s - loss: 3.2613 - accuracy50: 0.3847 - val_loss: 3.3202 - val_accuracy50: 0.3367 - 6s/epoch - 24ms/step
Epoch 7/50
254/254 - 6s - loss: 3.2556 - accuracy50: 0.3878 - val_loss: 3.3247 - val_accuracy50: 0.3443 - 6s/epoch - 25ms/step
Epoch 8/50
254/254 - 6s - loss: 3.2473 - accuracy50: 0.3961 - val_loss: 3.3285 - val_accuracy50: 0.3396 - 6s/epoch - 24ms/step
Epoch 9/50
254/254 - 6s - loss: 3.2405 - accuracy50: 0.4009 - val_loss: 3.3238 - val_accuracy50: 0.3394 - 6s/epoch - 25ms/step
Epoch 10/50
254/254 - 6s - loss: 3.2335 - accuracy50: 0.4053 - val_loss: 3.3289 - val_accuracy50: 0.3440 - 6s/epoch - 24ms/step
Epoch 11/50
254/254 - 6s - loss: 3.2269 - accuracy50: 0.4084 - val_loss: 3.3302 - val_accuracy50: 0.3507 - 6s/epoch - 24ms/step
Epoch 12/50
254/254 - 6s - loss: 3.2202 - accuracy50: 0.4124 - val_loss: 3.3276 - val_accuracy50: 0.3539 - 6s/epoch - 24ms/step
Epoch 13/50
254/254 - 6s - loss: 3.2088 - accuracy50: 0.4174 - val_loss: 3.3320 - val_accuracy50: 0.3467 - 6s/epoch - 24ms/step
Epoch 14/50
254/254 - 6s - loss: 3.2021 - accuracy50: 0.4221 - val_loss: 3.3408 - val_accuracy50: 0.3449 - 6s/epoch - 24ms/step
Epoch 15/50
254/254 - 6s - loss: 3.1929 - accuracy50: 0.4235 - val_loss: 3.3407 - val_accuracy50: 0.3531 - 6s/epoch - 24ms/step
Epoch 16/50
254/254 - 6s - loss: 3.1846 - accuracy50: 0.4313 - val_loss: 3.3475 - val_accuracy50: 0.3542 - 6s/epoch - 24ms/step
testing model: results/LILAK/W4/deepOF_L2/h50
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1101245
{'0': {'precision': 0.4087152856175209, 'recall': 0.18058298916621776, 'f1-score': 0.25049124069410234, 'support': 50121}, '1': {'precision': 0.28419367950411545, 'recall': 0.6046536767289139, 'f1-score': 0.38665526090675795, 'support': 37003}, '2': {'precision': 0.39897140621069405, 'recall': 0.28821225215038565, 'f1-score': 0.33466583824718943, 'support': 49526}, 'accuracy': 0.33442371020856204, 'macro avg': {'precision': 0.36396012377744347, 'recall': 0.35781630601517245, 'f1-score': 0.3239374466160166, 'support': 136650}, 'weighted avg': {'precision': 0.3714650231768561, 'recall': 0.33442371020856204, 'f1-score': 0.3178700065802574, 'support': 136650}}
[[ 9051 28618 12452]
 [ 5578 22374  9051]
 [ 7516 27736 14274]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0878757
{'0': {'precision': 0.40731550408969763, 'recall': 0.2070544265358561, 'f1-score': 0.2745462429536022, 'support': 21405}, '1': {'precision': 0.3695761293920803, 'recall': 0.6081310512549901, 'f1-score': 0.4597505767262761, 'support': 21793}, '2': {'precision': 0.39229373935029954, 'recall': 0.3283492822966507, 'f1-score': 0.35748453504971317, 'support': 21736}, 'accuracy': 0.38226506914713404, 'macro avg': {'precision': 0.38972845761069247, 'recall': 0.381178253362499, 'f1-score': 0.3639271182431971, 'support': 64934}, 'weighted avg': {'precision': 0.3896211179258892, 'recall': 0.38226506914713404, 'f1-score': 0.364466851000372, 'support': 64934}}
[[ 4432 11306  5667]
 [ 3151 13253  5389]
 [ 3298 11301  7137]]
Evaluating performance on  val set...
81/81 - 1s - 813ms/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1057822
{'0': {'precision': 0.3913612565445026, 'recall': 0.2052161976664379, 'f1-score': 0.26924808644754616, 'support': 7285}, '1': {'precision': 0.3071122695959784, 'recall': 0.5366845615747519, 'f1-score': 0.3906684824441945, 'support': 6147}, '2': {'precision': 0.3733069045259333, 'recall': 0.3145879732739421, 'f1-score': 0.3414413053331319, 'support': 7184}, 'accuracy': 0.3421614280170741, 'macro avg': {'precision': 0.3572601435554715, 'recall': 0.35216291083837725, 'f1-score': 0.33378595807495753, 'support': 20616}, 'weighted avg': {'precision': 0.35994968360727037, 'recall': 0.3421614280170741, 'f1-score': 0.33060854718995225, 'support': 20616}}
[[1495 3721 2069]
 [1123 3299 1725]
 [1202 3722 2260]]
training model: results/LILAK/W4/deepOF_L2/h100
Epoch 1/50
254/254 - 8s - loss: 3.3393 - accuracy100: 0.3492 - val_loss: 3.4485 - val_accuracy100: 0.3131 - 8s/epoch - 32ms/step
Epoch 2/50
254/254 - 6s - loss: 3.3174 - accuracy100: 0.3543 - val_loss: 3.4314 - val_accuracy100: 0.3134 - 6s/epoch - 24ms/step
Epoch 3/50
254/254 - 6s - loss: 3.3045 - accuracy100: 0.3591 - val_loss: 3.4159 - val_accuracy100: 0.3126 - 6s/epoch - 24ms/step
Epoch 4/50
254/254 - 6s - loss: 3.2927 - accuracy100: 0.3660 - val_loss: 3.4089 - val_accuracy100: 0.3147 - 6s/epoch - 25ms/step
Epoch 5/50
254/254 - 6s - loss: 3.2846 - accuracy100: 0.3696 - val_loss: 3.4087 - val_accuracy100: 0.3135 - 6s/epoch - 25ms/step
Epoch 6/50
254/254 - 6s - loss: 3.2777 - accuracy100: 0.3743 - val_loss: 3.3997 - val_accuracy100: 0.3140 - 6s/epoch - 25ms/step
Epoch 7/50
254/254 - 6s - loss: 3.2708 - accuracy100: 0.3801 - val_loss: 3.3966 - val_accuracy100: 0.3169 - 6s/epoch - 25ms/step
Epoch 8/50
254/254 - 6s - loss: 3.2636 - accuracy100: 0.3852 - val_loss: 3.4025 - val_accuracy100: 0.3141 - 6s/epoch - 25ms/step
Epoch 9/50
254/254 - 6s - loss: 3.2572 - accuracy100: 0.3876 - val_loss: 3.3954 - val_accuracy100: 0.3181 - 6s/epoch - 24ms/step
Epoch 10/50
254/254 - 6s - loss: 3.2512 - accuracy100: 0.3914 - val_loss: 3.4061 - val_accuracy100: 0.3162 - 6s/epoch - 25ms/step
Epoch 11/50
254/254 - 6s - loss: 3.2446 - accuracy100: 0.3955 - val_loss: 3.4078 - val_accuracy100: 0.3158 - 6s/epoch - 25ms/step
Epoch 12/50
254/254 - 6s - loss: 3.2374 - accuracy100: 0.3998 - val_loss: 3.4073 - val_accuracy100: 0.3180 - 6s/epoch - 24ms/step
Epoch 13/50
254/254 - 6s - loss: 3.2306 - accuracy100: 0.4047 - val_loss: 3.4183 - val_accuracy100: 0.3168 - 6s/epoch - 24ms/step
Epoch 14/50
254/254 - 6s - loss: 3.2217 - accuracy100: 0.4091 - val_loss: 3.4171 - val_accuracy100: 0.3179 - 6s/epoch - 24ms/step
Epoch 15/50
254/254 - 6s - loss: 3.2134 - accuracy100: 0.4156 - val_loss: 3.4264 - val_accuracy100: 0.3198 - 6s/epoch - 24ms/step
Epoch 16/50
254/254 - 6s - loss: 3.2060 - accuracy100: 0.4185 - val_loss: 3.4256 - val_accuracy100: 0.3210 - 6s/epoch - 24ms/step
Epoch 17/50
254/254 - 6s - loss: 3.1975 - accuracy100: 0.4211 - val_loss: 3.4404 - val_accuracy100: 0.3181 - 6s/epoch - 24ms/step
Epoch 18/50
254/254 - 6s - loss: 3.1896 - accuracy100: 0.4245 - val_loss: 3.4598 - val_accuracy100: 0.3187 - 6s/epoch - 24ms/step
Epoch 19/50
254/254 - 6s - loss: 3.1811 - accuracy100: 0.4285 - val_loss: 3.4696 - val_accuracy100: 0.3201 - 6s/epoch - 24ms/step
testing model: results/LILAK/W4/deepOF_L2/h100
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1667076
{'0': {'precision': 0.37420718816067655, 'recall': 0.044698706243443805, 'f1-score': 0.07985839970846999, 'support': 51478}, '1': {'precision': 0.24394852799772573, 'recall': 0.8793248945147679, 'f1-score': 0.38193730813789856, 'support': 33180}, '2': {'precision': 0.40176114474408364, 'recall': 0.08424372980458532, 'f1-score': 0.13928196648328936, 'support': 51992}, 'accuracy': 0.2624002927186242, 'macro avg': {'precision': 0.3399722869674953, 'recall': 0.33608911018759907, 'f1-score': 0.20035922477655263, 'support': 136650}, 'weighted avg': {'precision': 0.3530626800485492, 'recall': 0.2624002927186242, 'f1-score': 0.1758154305569504, 'support': 136650}}
[[ 2301 45290  3887]
 [ 1369 29176  2635]
 [ 2479 45133  4380]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1093374
{'0': {'precision': 0.4486426999266324, 'recall': 0.05644007568415709, 'f1-score': 0.10026644804263168, 'support': 21669}, '1': {'precision': 0.3366509124780074, 'recall': 0.9172384622614908, 'f1-score': 0.49253015696764746, 'support': 21278}, '2': {'precision': 0.45040151157298064, 'recall': 0.08673306954109246, 'f1-score': 0.14545593226802944, 'support': 21987}, 'accuracy': 0.34876951982012505, 'macro avg': {'precision': 0.4118983746592068, 'recall': 0.3534705358289134, 'f1-score': 0.2460841790927695, 'support': 64934}, 'weighted avg': {'precision': 0.4125400378133546, 'recall': 0.34876951982012505, 'f1-score': 0.24410740021207, 'support': 64934}}
[[ 1223 19194  1252]
 [  686 19517  1075]
 [  817 19263  1907]]
Evaluating performance on  val set...
81/81 - 1s - 840ms/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1336251
{'0': {'precision': 0.3931372549019608, 'recall': 0.05518095500206412, 'f1-score': 0.09677808615904429, 'support': 7267}, '1': {'precision': 0.3106185002736727, 'recall': 0.8896378742749648, 'f1-score': 0.4604649275832691, 'support': 6379}, '2': {'precision': 0.3559577677224736, 'recall': 0.06771879483500717, 'f1-score': 0.11378977820636452, 'support': 6970}, 'accuracy': 0.3176173845556849, 'macro avg': {'precision': 0.3532378409660357, 'recall': 0.3375125413706787, 'f1-score': 0.22367759731622597, 'support': 20616}, 'weighted avg': {'precision': 0.3550344143211073, 'recall': 0.3176173845556849, 'f1-score': 0.2150614512645426, 'support': 20616}}
[[ 401 6399  467]
 [ 317 5675  387]
 [ 302 6196  472]]
training model: results/LILAK/W4/deepOF_L2/h200
Epoch 1/50
254/254 - 9s - loss: 3.3448 - accuracy200: 0.3431 - val_loss: 3.3571 - val_accuracy200: 0.3194 - 9s/epoch - 34ms/step
Epoch 2/50
254/254 - 7s - loss: 3.3135 - accuracy200: 0.3535 - val_loss: 3.3473 - val_accuracy200: 0.3136 - 7s/epoch - 26ms/step
Epoch 3/50
254/254 - 7s - loss: 3.3046 - accuracy200: 0.3557 - val_loss: 3.3429 - val_accuracy200: 0.3132 - 7s/epoch - 26ms/step
Epoch 4/50
254/254 - 7s - loss: 3.2954 - accuracy200: 0.3589 - val_loss: 3.3423 - val_accuracy200: 0.3111 - 7s/epoch - 26ms/step
Epoch 5/50
254/254 - 6s - loss: 3.2855 - accuracy200: 0.3684 - val_loss: 3.3459 - val_accuracy200: 0.3117 - 6s/epoch - 25ms/step
Epoch 6/50
254/254 - 6s - loss: 3.2787 - accuracy200: 0.3722 - val_loss: 3.3449 - val_accuracy200: 0.3125 - 6s/epoch - 24ms/step
Epoch 7/50
254/254 - 6s - loss: 3.2747 - accuracy200: 0.3764 - val_loss: 3.3423 - val_accuracy200: 0.3154 - 6s/epoch - 24ms/step
Epoch 8/50
254/254 - 6s - loss: 3.2670 - accuracy200: 0.3823 - val_loss: 3.3475 - val_accuracy200: 0.3152 - 6s/epoch - 24ms/step
Epoch 9/50
254/254 - 6s - loss: 3.2611 - accuracy200: 0.3866 - val_loss: 3.3467 - val_accuracy200: 0.3141 - 6s/epoch - 24ms/step
Epoch 10/50
254/254 - 6s - loss: 3.2530 - accuracy200: 0.3923 - val_loss: 3.3487 - val_accuracy200: 0.3162 - 6s/epoch - 25ms/step
Epoch 11/50
254/254 - 6s - loss: 3.2498 - accuracy200: 0.3957 - val_loss: 3.3543 - val_accuracy200: 0.3127 - 6s/epoch - 25ms/step
Epoch 12/50
254/254 - 6s - loss: 3.2415 - accuracy200: 0.4005 - val_loss: 3.3546 - val_accuracy200: 0.3196 - 6s/epoch - 24ms/step
Epoch 13/50
254/254 - 6s - loss: 3.2369 - accuracy200: 0.4011 - val_loss: 3.3578 - val_accuracy200: 0.3195 - 6s/epoch - 24ms/step
Epoch 14/50
254/254 - 6s - loss: 3.2274 - accuracy200: 0.4081 - val_loss: 3.3638 - val_accuracy200: 0.3202 - 6s/epoch - 24ms/step
testing model: results/LILAK/W4/deepOF_L2/h200
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1165805
{'0': {'precision': 0.35584608711816096, 'recall': 0.11580730374463108, 'f1-score': 0.17474516963334857, 'support': 49591}, '1': {'precision': 0.28627196528102794, 'recall': 0.6904132782637695, 'f1-score': 0.40472806839457715, 'support': 38981}, '2': {'precision': 0.36499490546813085, 'recall': 0.20117309372270062, 'f1-score': 0.25938291966692145, 'support': 48078}, 'accuracy': 0.30975484815221366, 'macro avg': {'precision': 0.33570431928910666, 'recall': 0.3357978919103671, 'f1-score': 0.27961871923161574, 'support': 136650}, 'weighted avg': {'precision': 0.33921811818509523, 'recall': 0.30975484815221366, 'f1-score': 0.2701288295142528, 'support': 136650}}
[[ 5743 34559  9289]
 [ 4530 26913  7538]
 [ 5866 32540  9672]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0989043
{'0': {'precision': 0.3854616348697953, 'recall': 0.12810663210996437, 'f1-score': 0.19230234820063916, 'support': 21607}, '1': {'precision': 0.3430168562363758, 'recall': 0.7411397127401604, 'f1-score': 0.4689791522197796, 'support': 21444}, '2': {'precision': 0.3746935201401051, 'recall': 0.1955399168304163, 'f1-score': 0.25697384620004204, 'support': 21883}, 'accuracy': 0.35328179382141867, 'macro avg': {'precision': 0.36772400374875874, 'recall': 0.35492875389351375, 'f1-score': 0.3060851155401536, 'support': 64934}, 'weighted avg': {'precision': 0.3678156483658858, 'recall': 0.35328179382141867, 'f1-score': 0.30546746626062904, 'support': 64934}}
[[ 2768 15140  3699]
 [ 2109 15893  3442]
 [ 2304 15300  4279]]
Evaluating performance on  val set...
81/81 - 1s - 811ms/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1142205
{'0': {'precision': 0.37864460204885736, 'recall': 0.1285274842851411, 'f1-score': 0.19191213180229655, 'support': 7477}, '1': {'precision': 0.28812852075944084, 'recall': 0.7005410889414948, 'f1-score': 0.40831813925984334, 'support': 5914}, '2': {'precision': 0.36036766693701, 'recall': 0.18449826989619378, 'f1-score': 0.24404979860856826, 'support': 7225}, 'accuracy': 0.31223321691889794, 'macro avg': {'precision': 0.34238026324843607, 'recall': 0.3378556143742766, 'f1-score': 0.28142668989023606, 'support': 20616}, 'weighted avg': {'precision': 0.34627348442522976, 'recall': 0.31223321691889794, 'f1-score': 0.272263304230471, 'support': 20616}}
[[ 961 5181 1335]
 [ 740 4143 1031]
 [ 837 5055 1333]]
training model: results/LILAK/W4/deepOF_L2/h300
Epoch 1/50
254/254 - 8s - loss: 3.3448 - accuracy300: 0.3427 - val_loss: 3.3965 - val_accuracy300: 0.3120 - 8s/epoch - 31ms/step
Epoch 2/50
254/254 - 6s - loss: 3.3220 - accuracy300: 0.3498 - val_loss: 3.3889 - val_accuracy300: 0.3127 - 6s/epoch - 24ms/step
Epoch 3/50
254/254 - 6s - loss: 3.3098 - accuracy300: 0.3531 - val_loss: 3.3743 - val_accuracy300: 0.3114 - 6s/epoch - 25ms/step
Epoch 4/50
254/254 - 6s - loss: 3.3009 - accuracy300: 0.3574 - val_loss: 3.3733 - val_accuracy300: 0.3090 - 6s/epoch - 25ms/step
Epoch 5/50
254/254 - 6s - loss: 3.2927 - accuracy300: 0.3595 - val_loss: 3.3642 - val_accuracy300: 0.3100 - 6s/epoch - 24ms/step
Epoch 6/50
254/254 - 6s - loss: 3.2860 - accuracy300: 0.3652 - val_loss: 3.3601 - val_accuracy300: 0.3121 - 6s/epoch - 25ms/step
Epoch 7/50
254/254 - 6s - loss: 3.2831 - accuracy300: 0.3656 - val_loss: 3.3564 - val_accuracy300: 0.3127 - 6s/epoch - 24ms/step
Epoch 8/50
254/254 - 6s - loss: 3.2766 - accuracy300: 0.3722 - val_loss: 3.3582 - val_accuracy300: 0.3117 - 6s/epoch - 24ms/step
Epoch 9/50
254/254 - 6s - loss: 3.2718 - accuracy300: 0.3758 - val_loss: 3.3600 - val_accuracy300: 0.3129 - 6s/epoch - 24ms/step
Epoch 10/50
254/254 - 6s - loss: 3.2668 - accuracy300: 0.3800 - val_loss: 3.3604 - val_accuracy300: 0.3136 - 6s/epoch - 24ms/step
Epoch 11/50
254/254 - 6s - loss: 3.2640 - accuracy300: 0.3789 - val_loss: 3.3611 - val_accuracy300: 0.3141 - 6s/epoch - 24ms/step
Epoch 12/50
254/254 - 6s - loss: 3.2568 - accuracy300: 0.3877 - val_loss: 3.3663 - val_accuracy300: 0.3166 - 6s/epoch - 24ms/step
Epoch 13/50
254/254 - 6s - loss: 3.2513 - accuracy300: 0.3914 - val_loss: 3.3674 - val_accuracy300: 0.3144 - 6s/epoch - 24ms/step
Epoch 14/50
254/254 - 6s - loss: 3.2436 - accuracy300: 0.3945 - val_loss: 3.3783 - val_accuracy300: 0.3146 - 6s/epoch - 24ms/step
Epoch 15/50
254/254 - 6s - loss: 3.2402 - accuracy300: 0.3971 - val_loss: 3.3804 - val_accuracy300: 0.3148 - 6s/epoch - 24ms/step
Epoch 16/50
254/254 - 6s - loss: 3.2331 - accuracy300: 0.4015 - val_loss: 3.3874 - val_accuracy300: 0.3152 - 6s/epoch - 25ms/step
Epoch 17/50
254/254 - 6s - loss: 3.2233 - accuracy300: 0.4059 - val_loss: 3.3904 - val_accuracy300: 0.3187 - 6s/epoch - 25ms/step
testing model: results/LILAK/W4/deepOF_L2/h300
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1291536
{'0': {'precision': 0.37832005312084993, 'recall': 0.0441846487911747, 'f1-score': 0.07912782320365258, 'support': 51579}, '1': {'precision': 0.27728515291303607, 'recall': 0.8528152176768871, 'f1-score': 0.41849910714861305, 'support': 38061}, '2': {'precision': 0.357437711926876, 'recall': 0.10314826632631355, 'f1-score': 0.16009640781827786, 'support': 47010}, 'accuracy': 0.2896963044273692, 'macro avg': {'precision': 0.3376809726535874, 'recall': 0.33338271093145844, 'f1-score': 0.21924111272351451, 'support': 136650}, 'weighted avg': {'precision': 0.34299500228778507, 'recall': 0.2896963044273692, 'f1-score': 0.20150721289236587, 'support': 136650}}
[[ 2279 44514  4786]
 [ 1671 32459  3931]
 [ 2074 40087  4849]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1004664
{'0': {'precision': 0.40408805031446543, 'recall': 0.05951002639744361, 'f1-score': 0.1037419771525451, 'support': 21593}, '1': {'precision': 0.3408537344213914, 'recall': 0.8884151992585727, 'f1-score': 0.49268248808254206, 'support': 21580}, '2': {'precision': 0.4221899400762666, 'recall': 0.10684251642847295, 'f1-score': 0.17052955845679918, 'support': 21761}, 'accuracy': 0.3508485539162842, 'macro avg': {'precision': 0.3890439082707078, 'recall': 0.3515892473614964, 'f1-score': 0.25565134123062877, 'support': 64934}, 'weighted avg': {'precision': 0.38913931292163606, 'recall': 0.3508485539162842, 'f1-score': 0.25538365612860087, 'support': 64934}}
[[ 1285 18622  1686]
 [  912 19172  1496]
 [  983 18453  2325]]
Evaluating performance on  val set...
81/81 - 1s - 828ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.12007
{'0': {'precision': 0.3905109489051095, 'recall': 0.05843003412969283, 'f1-score': 0.10165063531647073, 'support': 7325}, '1': {'precision': 0.3020534458509142, 'recall': 0.8659677419354839, 'f1-score': 0.44788321167883216, 'support': 6200}, '2': {'precision': 0.3535816618911175, 'recall': 0.0870117049781413, 'f1-score': 0.13965595291987323, 'support': 7091}, 'accuracy': 0.31111757857974387, 'macro avg': {'precision': 0.34871535221571376, 'recall': 0.33713649368110604, 'f1-score': 0.22972993330505867, 'support': 20616}, 'weighted avg': {'precision': 0.3512064236260919, 'recall': 0.31111757857974387, 'f1-score': 0.21884784527826584, 'support': 20616}}
[[ 428 6291  606]
 [ 309 5369  522]
 [ 359 6115  617]]
training model: results/LILAK/W4/deepOF_L2/h500
Epoch 1/50
254/254 - 8s - loss: 3.3437 - accuracy500: 0.3398 - val_loss: 3.3550 - val_accuracy500: 0.3166 - 8s/epoch - 33ms/step
Epoch 2/50
254/254 - 6s - loss: 3.3199 - accuracy500: 0.3459 - val_loss: 3.3463 - val_accuracy500: 0.3116 - 6s/epoch - 25ms/step
Epoch 3/50
254/254 - 6s - loss: 3.3056 - accuracy500: 0.3561 - val_loss: 3.3411 - val_accuracy500: 0.3098 - 6s/epoch - 24ms/step
Epoch 4/50
254/254 - 6s - loss: 3.2947 - accuracy500: 0.3614 - val_loss: 3.3369 - val_accuracy500: 0.3117 - 6s/epoch - 25ms/step
Epoch 5/50
254/254 - 6s - loss: 3.2904 - accuracy500: 0.3625 - val_loss: 3.3364 - val_accuracy500: 0.3124 - 6s/epoch - 25ms/step
Epoch 6/50
254/254 - 6s - loss: 3.2837 - accuracy500: 0.3667 - val_loss: 3.3360 - val_accuracy500: 0.3092 - 6s/epoch - 25ms/step
Epoch 7/50
254/254 - 6s - loss: 3.2789 - accuracy500: 0.3717 - val_loss: 3.3335 - val_accuracy500: 0.3100 - 6s/epoch - 25ms/step
Epoch 8/50
254/254 - 6s - loss: 3.2731 - accuracy500: 0.3773 - val_loss: 3.3327 - val_accuracy500: 0.3116 - 6s/epoch - 25ms/step
Epoch 9/50
254/254 - 6s - loss: 3.2691 - accuracy500: 0.3786 - val_loss: 3.3374 - val_accuracy500: 0.3091 - 6s/epoch - 25ms/step
Epoch 10/50
254/254 - 6s - loss: 3.2646 - accuracy500: 0.3823 - val_loss: 3.3400 - val_accuracy500: 0.3120 - 6s/epoch - 24ms/step
Epoch 11/50
254/254 - 6s - loss: 3.2604 - accuracy500: 0.3866 - val_loss: 3.3429 - val_accuracy500: 0.3097 - 6s/epoch - 24ms/step
Epoch 12/50
254/254 - 6s - loss: 3.2534 - accuracy500: 0.3901 - val_loss: 3.3424 - val_accuracy500: 0.3111 - 6s/epoch - 24ms/step
Epoch 13/50
254/254 - 6s - loss: 3.2482 - accuracy500: 0.3938 - val_loss: 3.3406 - val_accuracy500: 0.3229 - 6s/epoch - 24ms/step
Epoch 14/50
254/254 - 6s - loss: 3.2411 - accuracy500: 0.4000 - val_loss: 3.3448 - val_accuracy500: 0.3182 - 6s/epoch - 24ms/step
Epoch 15/50
254/254 - 6s - loss: 3.2350 - accuracy500: 0.4034 - val_loss: 3.3538 - val_accuracy500: 0.3176 - 6s/epoch - 24ms/step
Epoch 16/50
254/254 - 6s - loss: 3.2278 - accuracy500: 0.4086 - val_loss: 3.3529 - val_accuracy500: 0.3214 - 6s/epoch - 24ms/step
Epoch 17/50
254/254 - 6s - loss: 3.2200 - accuracy500: 0.4115 - val_loss: 3.3615 - val_accuracy500: 0.3193 - 6s/epoch - 24ms/step
Epoch 18/50
254/254 - 6s - loss: 3.2109 - accuracy500: 0.4150 - val_loss: 3.3646 - val_accuracy500: 0.3226 - 6s/epoch - 24ms/step
testing model: results/LILAK/W4/deepOF_L2/h500
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1106001
{'0': {'precision': 0.3654463001880323, 'recall': 0.13008130081300814, 'f1-score': 0.19186713317170193, 'support': 50799}, '1': {'precision': 0.3077817804026967, 'recall': 0.6534090909090909, 'f1-score': 0.41845468851955636, 'support': 41712}, '2': {'precision': 0.33549891720806263, 'recall': 0.22814291216384602, 'f1-score': 0.27159694689430103, 'support': 44139}, 'accuracy': 0.3215001829491401, 'macro avg': {'precision': 0.3362423325995972, 'recall': 0.337211101295315, 'f1-score': 0.2939729228618531, 'support': 136650}, 'weighted avg': {'precision': 0.33817114477904, 'recall': 0.3215001829491401, 'f1-score': 0.2867856429160964, 'support': 136650}}
[[ 6608 33274 10917]
 [ 5429 27255  9028]
 [ 6045 28024 10070]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0925639
{'0': {'precision': 0.3921254801536492, 'recall': 0.1708984375, 'f1-score': 0.2380489700738438, 'support': 21504}, '1': {'precision': 0.35267043820116983, 'recall': 0.6785038970622146, 'f1-score': 0.4641082666919037, 'support': 21683}, '2': {'precision': 0.38848764986277623, 'recall': 0.2473444613050076, 'f1-score': 0.3022504425027393, 'support': 21747}, 'accuracy': 0.3660024024394, 'macro avg': {'precision': 0.37776118940586506, 'recall': 0.36558226528907406, 'f1-score': 0.3348025597561623, 'support': 64934}, 'weighted avg': {'precision': 0.37773216432540474, 'recall': 0.3660024024394, 'f1-score': 0.33503719118267095, 'support': 64934}}
[[ 3675 13547  4282]
 [ 2786 14712  4185]
 [ 2911 13457  5379]]
Evaluating performance on  val set...
81/81 - 1s - 817ms/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1113691
{'0': {'precision': 0.3722857142857143, 'recall': 0.17240010584810797, 'f1-score': 0.23566648580213417, 'support': 7558}, '1': {'precision': 0.27669452181987003, 'recall': 0.6310217046056115, 'f1-score': 0.3847022752944974, 'support': 5667}, '2': {'precision': 0.36498091603053434, 'recall': 0.20700852388039506, 'f1-score': 0.26418026418026413, 'support': 7391}, 'accuracy': 0.3108750485060148, 'macro avg': {'precision': 0.33798705071203955, 'recall': 0.33681011144470485, 'f1-score': 0.2948496750922986, 'support': 20616}, 'weighted avg': {'precision': 0.3433904362682534, 'recall': 0.3108750485060148, 'f1-score': 0.2868563943705267, 'support': 20616}}
[[1303 4752 1503]
 [ 932 3576 1159]
 [1265 4596 1530]]
training model: results/LILAK/W4/deepOF_L2/h1000
Epoch 1/50
254/254 - 8s - loss: 3.3559 - accuracy1000: 0.3393 - val_loss: 3.3428 - val_accuracy1000: 0.3231 - 8s/epoch - 33ms/step
Epoch 2/50
254/254 - 6s - loss: 3.3298 - accuracy1000: 0.3438 - val_loss: 3.3302 - val_accuracy1000: 0.3224 - 6s/epoch - 24ms/step
Epoch 3/50
254/254 - 6s - loss: 3.3158 - accuracy1000: 0.3478 - val_loss: 3.3259 - val_accuracy1000: 0.3207 - 6s/epoch - 24ms/step
Epoch 4/50
254/254 - 6s - loss: 3.3050 - accuracy1000: 0.3533 - val_loss: 3.3247 - val_accuracy1000: 0.3184 - 6s/epoch - 24ms/step
Epoch 5/50
254/254 - 6s - loss: 3.2995 - accuracy1000: 0.3569 - val_loss: 3.3207 - val_accuracy1000: 0.3240 - 6s/epoch - 24ms/step
Epoch 6/50
254/254 - 6s - loss: 3.2933 - accuracy1000: 0.3583 - val_loss: 3.3211 - val_accuracy1000: 0.3196 - 6s/epoch - 24ms/step
Epoch 7/50
254/254 - 6s - loss: 3.2884 - accuracy1000: 0.3615 - val_loss: 3.3216 - val_accuracy1000: 0.3186 - 6s/epoch - 24ms/step
Epoch 8/50
254/254 - 6s - loss: 3.2810 - accuracy1000: 0.3683 - val_loss: 3.3235 - val_accuracy1000: 0.3141 - 6s/epoch - 24ms/step
Epoch 9/50
254/254 - 6s - loss: 3.2782 - accuracy1000: 0.3678 - val_loss: 3.3224 - val_accuracy1000: 0.3219 - 6s/epoch - 24ms/step
Epoch 10/50
254/254 - 6s - loss: 3.2717 - accuracy1000: 0.3749 - val_loss: 3.3249 - val_accuracy1000: 0.3203 - 6s/epoch - 24ms/step
Epoch 11/50
254/254 - 6s - loss: 3.2683 - accuracy1000: 0.3760 - val_loss: 3.3290 - val_accuracy1000: 0.3185 - 6s/epoch - 24ms/step
Epoch 12/50
254/254 - 6s - loss: 3.2633 - accuracy1000: 0.3827 - val_loss: 3.3282 - val_accuracy1000: 0.3216 - 6s/epoch - 24ms/step
Epoch 13/50
254/254 - 6s - loss: 3.2572 - accuracy1000: 0.3822 - val_loss: 3.3339 - val_accuracy1000: 0.3219 - 6s/epoch - 24ms/step
Epoch 14/50
254/254 - 6s - loss: 3.2506 - accuracy1000: 0.3889 - val_loss: 3.3322 - val_accuracy1000: 0.3255 - 6s/epoch - 24ms/step
Epoch 15/50
254/254 - 6s - loss: 3.2463 - accuracy1000: 0.3938 - val_loss: 3.3373 - val_accuracy1000: 0.3257 - 6s/epoch - 24ms/step
testing model: results/LILAK/W4/deepOF_L2/h1000
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1049095
{'0': {'precision': 0.40408026410811926, 'recall': 0.28346812860735676, 'f1-score': 0.3331950957561064, 'support': 55269}, '1': {'precision': 0.2827850455303322, 'recall': 0.4608491182233834, 'f1-score': 0.35049825635115395, 'support': 38275}, '2': {'precision': 0.33412202129457497, 'recall': 0.2751821092191342, 'f1-score': 0.3018013433747201, 'support': 43106}, 'accuracy': 0.3305378704720088, 'macro avg': {'precision': 0.3403291103110088, 'recall': 0.33983311868329147, 'f1-score': 0.3284982318273268, 'support': 136650}, 'weighted avg': {'precision': 0.34803786011408017, 'recall': 0.3305378704720088, 'f1-score': 0.3281385233567168, 'support': 136650}}
[[15667 25697 13905]
 [10901 17639  9735]
 [12204 19040 11862]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.095798
{'0': {'precision': 0.3581510047746472, 'recall': 0.31977888128923454, 'f1-score': 0.33787897537433487, 'support': 21346}, '1': {'precision': 0.34741454864154253, 'recall': 0.46211238050827697, 'f1-score': 0.3966379827896738, 'support': 21445}, '2': {'precision': 0.3775792507204611, 'recall': 0.2958497041954568, 'f1-score': 0.3317549945559973, 'support': 22143}, 'accuracy': 0.35862568146117596, 'macro avg': {'precision': 0.3610482680455503, 'recall': 0.3592469886643228, 'f1-score': 0.355423984240002, 'support': 64934}, 'weighted avg': {'precision': 0.3612303830387881, 'recall': 0.35862568146117596, 'f1-score': 0.3551963069226992, 'support': 64934}}
[[6826 9146 5374]
 [6110 9910 5425]
 [6123 9469 6551]]
Evaluating performance on  val set...
81/81 - 1s - 849ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.107843
{'0': {'precision': 0.3577059823774927, 'recall': 0.3115239633817986, 'f1-score': 0.333021515434986, 'support': 7428}, '1': {'precision': 0.2754817867884594, 'recall': 0.44711625384198156, 'f1-score': 0.3409153570443893, 'support': 5531}, '2': {'precision': 0.3758220502901354, 'recall': 0.25375473423011624, 'f1-score': 0.30295470491931087, 'support': 7657}, 'accuracy': 0.3264454792394257, 'macro avg': {'precision': 0.3363366064853625, 'recall': 0.33746498381796547, 'f1-score': 0.32563052579956203, 'support': 20616}, 'weighted avg': {'precision': 0.34237481756395766, 'recall': 0.3264454792394257, 'f1-score': 0.3239721979060321, 'support': 20616}}
[[2314 3236 1878]
 [1709 2473 1349]
 [2446 3268 1943]]
training model: results/LILAK/W4/deepVOL_L2/h10
Epoch 1/50
254/254 - 8s - loss: 3.3555 - accuracy10: 0.3493 - val_loss: 3.3769 - val_accuracy10: 0.3288 - 8s/epoch - 32ms/step
Epoch 2/50
254/254 - 6s - loss: 3.3048 - accuracy10: 0.3644 - val_loss: 3.3643 - val_accuracy10: 0.3357 - 6s/epoch - 22ms/step
Epoch 3/50
254/254 - 6s - loss: 3.2806 - accuracy10: 0.3789 - val_loss: 3.3528 - val_accuracy10: 0.3502 - 6s/epoch - 22ms/step
Epoch 4/50
254/254 - 6s - loss: 3.2652 - accuracy10: 0.3864 - val_loss: 3.3383 - val_accuracy10: 0.3564 - 6s/epoch - 22ms/step
Epoch 5/50
254/254 - 6s - loss: 3.2416 - accuracy10: 0.3997 - val_loss: 3.3288 - val_accuracy10: 0.3698 - 6s/epoch - 22ms/step
Epoch 6/50
254/254 - 6s - loss: 3.2260 - accuracy10: 0.4054 - val_loss: 3.3220 - val_accuracy10: 0.3579 - 6s/epoch - 22ms/step
Epoch 7/50
254/254 - 6s - loss: 3.2073 - accuracy10: 0.4182 - val_loss: 3.3276 - val_accuracy10: 0.3675 - 6s/epoch - 22ms/step
Epoch 8/50
254/254 - 6s - loss: 3.1977 - accuracy10: 0.4211 - val_loss: 3.3007 - val_accuracy10: 0.3762 - 6s/epoch - 22ms/step
Epoch 9/50
254/254 - 6s - loss: 3.1837 - accuracy10: 0.4281 - val_loss: 3.3012 - val_accuracy10: 0.3782 - 6s/epoch - 22ms/step
Epoch 10/50
254/254 - 6s - loss: 3.1671 - accuracy10: 0.4337 - val_loss: 3.2876 - val_accuracy10: 0.3841 - 6s/epoch - 23ms/step
Epoch 11/50
254/254 - 6s - loss: 3.1582 - accuracy10: 0.4382 - val_loss: 3.2880 - val_accuracy10: 0.3980 - 6s/epoch - 23ms/step
Epoch 12/50
254/254 - 6s - loss: 3.1436 - accuracy10: 0.4417 - val_loss: 3.2850 - val_accuracy10: 0.3907 - 6s/epoch - 22ms/step
Epoch 13/50
254/254 - 6s - loss: 3.1335 - accuracy10: 0.4492 - val_loss: 3.2879 - val_accuracy10: 0.3912 - 6s/epoch - 22ms/step
Epoch 14/50
254/254 - 6s - loss: 3.1222 - accuracy10: 0.4534 - val_loss: 3.2867 - val_accuracy10: 0.3937 - 6s/epoch - 22ms/step
Epoch 15/50
254/254 - 6s - loss: 3.1110 - accuracy10: 0.4572 - val_loss: 3.2793 - val_accuracy10: 0.3978 - 6s/epoch - 23ms/step
Epoch 16/50
254/254 - 6s - loss: 3.1040 - accuracy10: 0.4578 - val_loss: 3.2744 - val_accuracy10: 0.3958 - 6s/epoch - 23ms/step
Epoch 17/50
254/254 - 6s - loss: 3.0883 - accuracy10: 0.4654 - val_loss: 3.2646 - val_accuracy10: 0.4121 - 6s/epoch - 23ms/step
Epoch 18/50
254/254 - 6s - loss: 3.0814 - accuracy10: 0.4658 - val_loss: 3.2748 - val_accuracy10: 0.4066 - 6s/epoch - 22ms/step
Epoch 19/50
254/254 - 6s - loss: 3.0672 - accuracy10: 0.4716 - val_loss: 3.2752 - val_accuracy10: 0.4076 - 6s/epoch - 22ms/step
Epoch 20/50
254/254 - 6s - loss: 3.0631 - accuracy10: 0.4708 - val_loss: 3.2764 - val_accuracy10: 0.4091 - 6s/epoch - 23ms/step
Epoch 21/50
254/254 - 6s - loss: 3.0500 - accuracy10: 0.4759 - val_loss: 3.2791 - val_accuracy10: 0.4118 - 6s/epoch - 22ms/step
Epoch 22/50
254/254 - 6s - loss: 3.0377 - accuracy10: 0.4811 - val_loss: 3.2866 - val_accuracy10: 0.4075 - 6s/epoch - 22ms/step
Epoch 23/50
254/254 - 6s - loss: 3.0381 - accuracy10: 0.4807 - val_loss: 3.2802 - val_accuracy10: 0.4064 - 6s/epoch - 22ms/step
Epoch 24/50
254/254 - 6s - loss: 3.0238 - accuracy10: 0.4834 - val_loss: 3.2867 - val_accuracy10: 0.4109 - 6s/epoch - 22ms/step
Epoch 25/50
254/254 - 6s - loss: 3.0171 - accuracy10: 0.4867 - val_loss: 3.2852 - val_accuracy10: 0.4099 - 6s/epoch - 22ms/step
Epoch 26/50
254/254 - 6s - loss: 3.0127 - accuracy10: 0.4872 - val_loss: 3.2828 - val_accuracy10: 0.4105 - 6s/epoch - 22ms/step
Epoch 27/50
254/254 - 6s - loss: 3.0037 - accuracy10: 0.4902 - val_loss: 3.3040 - val_accuracy10: 0.4079 - 6s/epoch - 22ms/step
testing model: results/LILAK/W4/deepVOL_L2/h10
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0793949
{'0': {'precision': 0.42962962962962964, 'recall': 0.3796785628846698, 'f1-score': 0.40311258889812507, 'support': 45981}, '1': {'precision': 0.4103094061963913, 'recall': 0.4379246448424954, 'f1-score': 0.42366750253427954, 'support': 45332}, '2': {'precision': 0.4131749097321354, 'recall': 0.43408835270505725, 'f1-score': 0.42337352248405524, 'support': 45341}, 'accuracy': 0.4170532878657046, 'macro avg': {'precision': 0.41770464851938544, 'recall': 0.4172305201440741, 'f1-score': 0.41671787130548665, 'support': 136654}, 'weighted avg': {'precision': 0.41776098455851685, 'recall': 0.4170532878657046, 'f1-score': 0.4166536951568062, 'support': 136654}}
[[17458 14878 13645]
 [11171 19852 14309]
 [12006 13653 19682]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0428437
{'0': {'precision': 0.36639790804096756, 'recall': 0.4876167275680065, 'f1-score': 0.4184044194495596, 'support': 17241}, '1': {'precision': 0.5881725124921167, 'recall': 0.40376994038698505, 'f1-score': 0.47883096366508693, 'support': 30027}, '2': {'precision': 0.3925998690242305, 'recall': 0.47503961965134706, 'f1-score': 0.42990319110792397, 'support': 17668}, 'accuracy': 0.44542318590612295, 'macro avg': {'precision': 0.4490567631857716, 'recall': 0.45547542920211287, 'f1-score': 0.44237952474085684, 'support': 64936}, 'weighted avg': {'precision': 0.4760776279884073, 'recall': 0.44542318590612295, 'f1-score': 0.4494748294042784, 'support': 64936}}
[[ 8407  4382  4452]
 [ 9370 12124  8533]
 [ 5168  4107  8393]]
Evaluating performance on  val set...
81/81 - 1s - 731ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0764045
{'0': {'precision': 0.35217282089927154, 'recall': 0.48170417454045694, 'f1-score': 0.40687803816295437, 'support': 5821}, '1': {'precision': 0.5385393826952268, 'recall': 0.35648096460868595, 'f1-score': 0.428993685341932, 'support': 8957}, '2': {'precision': 0.3706512042818912, 'recall': 0.4269566706627847, 'f1-score': 0.39681655391961795, 'support': 5839}, 'accuracy': 0.4117960906048407, 'macro avg': {'precision': 0.4204544692921299, 'recall': 0.4217139366039759, 'f1-score': 0.4108960924748348, 'support': 20617}, 'weighted avg': {'precision': 0.43837258684860886, 'recall': 0.4117960906048407, 'f1-score': 0.41363657942915516, 'support': 20617}}
[[2804 1397 1620]
 [3151 3193 2613]
 [2007 1339 2493]]
training model: results/LILAK/W4/deepVOL_L2/h20
Epoch 1/50
254/254 - 8s - loss: 3.3494 - accuracy20: 0.3519 - val_loss: 3.3482 - val_accuracy20: 0.3524 - 8s/epoch - 31ms/step
Epoch 2/50
254/254 - 6s - loss: 3.3104 - accuracy20: 0.3626 - val_loss: 3.3256 - val_accuracy20: 0.3540 - 6s/epoch - 23ms/step
Epoch 3/50
254/254 - 6s - loss: 3.2851 - accuracy20: 0.3777 - val_loss: 3.3108 - val_accuracy20: 0.3660 - 6s/epoch - 24ms/step
Epoch 4/50
254/254 - 6s - loss: 3.2640 - accuracy20: 0.3882 - val_loss: 3.2998 - val_accuracy20: 0.3682 - 6s/epoch - 23ms/step
Epoch 5/50
254/254 - 6s - loss: 3.2515 - accuracy20: 0.3974 - val_loss: 3.2917 - val_accuracy20: 0.3746 - 6s/epoch - 22ms/step
Epoch 6/50
254/254 - 6s - loss: 3.2358 - accuracy20: 0.4050 - val_loss: 3.2867 - val_accuracy20: 0.3784 - 6s/epoch - 23ms/step
Epoch 7/50
254/254 - 6s - loss: 3.2215 - accuracy20: 0.4122 - val_loss: 3.2787 - val_accuracy20: 0.3873 - 6s/epoch - 22ms/step
Epoch 8/50
254/254 - 6s - loss: 3.2065 - accuracy20: 0.4216 - val_loss: 3.2791 - val_accuracy20: 0.3927 - 6s/epoch - 22ms/step
Epoch 9/50
254/254 - 6s - loss: 3.1976 - accuracy20: 0.4261 - val_loss: 3.2710 - val_accuracy20: 0.3987 - 6s/epoch - 23ms/step
Epoch 10/50
254/254 - 6s - loss: 3.1779 - accuracy20: 0.4339 - val_loss: 3.2715 - val_accuracy20: 0.4022 - 6s/epoch - 22ms/step
Epoch 11/50
254/254 - 6s - loss: 3.1687 - accuracy20: 0.4381 - val_loss: 3.2715 - val_accuracy20: 0.4026 - 6s/epoch - 22ms/step
Epoch 12/50
254/254 - 6s - loss: 3.1535 - accuracy20: 0.4448 - val_loss: 3.2649 - val_accuracy20: 0.4067 - 6s/epoch - 23ms/step
Epoch 13/50
254/254 - 6s - loss: 3.1420 - accuracy20: 0.4505 - val_loss: 3.2659 - val_accuracy20: 0.4018 - 6s/epoch - 22ms/step
Epoch 14/50
254/254 - 6s - loss: 3.1337 - accuracy20: 0.4547 - val_loss: 3.2650 - val_accuracy20: 0.4075 - 6s/epoch - 22ms/step
Epoch 15/50
254/254 - 6s - loss: 3.1219 - accuracy20: 0.4597 - val_loss: 3.2712 - val_accuracy20: 0.4036 - 6s/epoch - 22ms/step
Epoch 16/50
254/254 - 6s - loss: 3.1146 - accuracy20: 0.4620 - val_loss: 3.2661 - val_accuracy20: 0.4086 - 6s/epoch - 22ms/step
Epoch 17/50
254/254 - 6s - loss: 3.1100 - accuracy20: 0.4621 - val_loss: 3.2629 - val_accuracy20: 0.4100 - 6s/epoch - 22ms/step
Epoch 18/50
254/254 - 6s - loss: 3.1012 - accuracy20: 0.4666 - val_loss: 3.2801 - val_accuracy20: 0.4101 - 6s/epoch - 22ms/step
Epoch 19/50
254/254 - 6s - loss: 3.0926 - accuracy20: 0.4695 - val_loss: 3.2619 - val_accuracy20: 0.4101 - 6s/epoch - 22ms/step
Epoch 20/50
254/254 - 6s - loss: 3.0841 - accuracy20: 0.4728 - val_loss: 3.2657 - val_accuracy20: 0.4156 - 6s/epoch - 22ms/step
Epoch 21/50
254/254 - 6s - loss: 3.0783 - accuracy20: 0.4732 - val_loss: 3.2759 - val_accuracy20: 0.4140 - 6s/epoch - 22ms/step
Epoch 22/50
254/254 - 6s - loss: 3.0710 - accuracy20: 0.4760 - val_loss: 3.2803 - val_accuracy20: 0.4126 - 6s/epoch - 22ms/step
Epoch 23/50
254/254 - 6s - loss: 3.0624 - accuracy20: 0.4810 - val_loss: 3.2908 - val_accuracy20: 0.4090 - 6s/epoch - 22ms/step
Epoch 24/50
254/254 - 6s - loss: 3.0520 - accuracy20: 0.4829 - val_loss: 3.2895 - val_accuracy20: 0.4080 - 6s/epoch - 22ms/step
Epoch 25/50
254/254 - 6s - loss: 3.0452 - accuracy20: 0.4859 - val_loss: 3.3040 - val_accuracy20: 0.4068 - 6s/epoch - 22ms/step
Epoch 26/50
254/254 - 6s - loss: 3.0354 - accuracy20: 0.4875 - val_loss: 3.2964 - val_accuracy20: 0.4090 - 6s/epoch - 22ms/step
Epoch 27/50
254/254 - 6s - loss: 3.0324 - accuracy20: 0.4906 - val_loss: 3.3011 - val_accuracy20: 0.4096 - 6s/epoch - 22ms/step
Epoch 28/50
254/254 - 6s - loss: 3.0241 - accuracy20: 0.4933 - val_loss: 3.3084 - val_accuracy20: 0.4088 - 6s/epoch - 22ms/step
Epoch 29/50
254/254 - 6s - loss: 3.0114 - accuracy20: 0.4954 - val_loss: 3.3082 - val_accuracy20: 0.4087 - 6s/epoch - 23ms/step
testing model: results/LILAK/W4/deepVOL_L2/h20
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0824862
{'0': {'precision': 0.4686776986977503, 'recall': 0.4034292434042069, 'f1-score': 0.4336126230811571, 'support': 52723}, '1': {'precision': 0.32179901377316783, 'recall': 0.3569407770652584, 'f1-score': 0.3384601627470267, 'support': 31812}, '2': {'precision': 0.4413682236313298, 'recall': 0.4741073312995261, 'f1-score': 0.45715237179012796, 'support': 52119}, 'accuracy': 0.4195632765963675, 'macro avg': {'precision': 0.4106149787007493, 'recall': 0.41149245058966377, 'f1-score': 0.4097417192061039, 'support': 136654}, 'weighted avg': {'precision': 0.42406980389915244, 'recall': 0.4195632765963675, 'f1-score': 0.4204397784868788, 'support': 136654}}
[[21270 12277 19176]
 [ 8358 11355 12099]
 [15755 11654 24710]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.041389
{'0': {'precision': 0.4247588021551184, 'recall': 0.49168439373428735, 'f1-score': 0.4557778923073476, 'support': 20684}, '1': {'precision': 0.5132540634886004, 'recall': 0.4099860578598815, 'f1-score': 0.45584459623116796, 'support': 22952}, '2': {'precision': 0.4492696058961119, 'recall': 0.4779342723004695, 'f1-score': 0.4631588525671648, 'support': 21300}, 'accuracy': 0.45829740051743256, 'macro avg': {'precision': 0.46242749051327686, 'recall': 0.45986824129821285, 'f1-score': 0.4582604470352268, 'support': 64936}, 'weighted avg': {'precision': 0.4640778756707221, 'recall': 0.45829740051743256, 'f1-score': 0.45822253691116727, 'support': 64936}}
[[10170  4520  5994]
 [ 7057  9410  6485]
 [ 6716  4404 10180]]
Evaluating performance on  val set...
81/81 - 1s - 809ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0870922
{'0': {'precision': 0.40260192821465907, 'recall': 0.49641936407906045, 'f1-score': 0.4446154832916426, 'support': 6982}, '1': {'precision': 0.4411706933804754, 'recall': 0.3338287752675386, 'f1-score': 0.38006599543108555, 'support': 6728}, '2': {'precision': 0.4104380511782565, 'recall': 0.4110322860865788, 'f1-score': 0.4107349537037037, 'support': 6907}, 'accuracy': 0.41475481398845615, 'macro avg': {'precision': 0.41807022425779694, 'recall': 0.41376014181105925, 'f1-score': 0.4118054774754773, 'support': 20617}, 'weighted avg': {'precision': 0.41781339221743247, 'recall': 0.41475481398845615, 'f1-score': 0.4122004000016527, 'support': 20617}}
[[3466 1444 2072]
 [2476 2246 2006]
 [2667 1401 2839]]
training model: results/LILAK/W4/deepVOL_L2/h30
Epoch 1/50
254/254 - 8s - loss: 3.3482 - accuracy30: 0.3538 - val_loss: 3.3370 - val_accuracy30: 0.3521 - 8s/epoch - 32ms/step
Epoch 2/50
254/254 - 6s - loss: 3.3066 - accuracy30: 0.3653 - val_loss: 3.3039 - val_accuracy30: 0.3610 - 6s/epoch - 22ms/step
Epoch 3/50
254/254 - 6s - loss: 3.2806 - accuracy30: 0.3778 - val_loss: 3.2983 - val_accuracy30: 0.3683 - 6s/epoch - 22ms/step
Epoch 4/50
254/254 - 6s - loss: 3.2678 - accuracy30: 0.3861 - val_loss: 3.2952 - val_accuracy30: 0.3667 - 6s/epoch - 22ms/step
Epoch 5/50
254/254 - 6s - loss: 3.2599 - accuracy30: 0.3906 - val_loss: 3.2936 - val_accuracy30: 0.3755 - 6s/epoch - 22ms/step
Epoch 6/50
254/254 - 6s - loss: 3.2458 - accuracy30: 0.3994 - val_loss: 3.2929 - val_accuracy30: 0.3750 - 6s/epoch - 23ms/step
Epoch 7/50
254/254 - 6s - loss: 3.2297 - accuracy30: 0.4072 - val_loss: 3.2889 - val_accuracy30: 0.3793 - 6s/epoch - 24ms/step
Epoch 8/50
254/254 - 6s - loss: 3.2224 - accuracy30: 0.4119 - val_loss: 3.2923 - val_accuracy30: 0.3816 - 6s/epoch - 22ms/step
Epoch 9/50
254/254 - 6s - loss: 3.2155 - accuracy30: 0.4174 - val_loss: 3.2904 - val_accuracy30: 0.3843 - 6s/epoch - 23ms/step
Epoch 10/50
254/254 - 6s - loss: 3.2067 - accuracy30: 0.4218 - val_loss: 3.2935 - val_accuracy30: 0.3879 - 6s/epoch - 23ms/step
Epoch 11/50
254/254 - 6s - loss: 3.1949 - accuracy30: 0.4273 - val_loss: 3.2919 - val_accuracy30: 0.3856 - 6s/epoch - 22ms/step
Epoch 12/50
254/254 - 6s - loss: 3.1841 - accuracy30: 0.4327 - val_loss: 3.2992 - val_accuracy30: 0.3872 - 6s/epoch - 22ms/step
Epoch 13/50
254/254 - 6s - loss: 3.1736 - accuracy30: 0.4345 - val_loss: 3.2961 - val_accuracy30: 0.3870 - 6s/epoch - 22ms/step
Epoch 14/50
254/254 - 6s - loss: 3.1670 - accuracy30: 0.4392 - val_loss: 3.2933 - val_accuracy30: 0.3905 - 6s/epoch - 22ms/step
Epoch 15/50
254/254 - 6s - loss: 3.1564 - accuracy30: 0.4429 - val_loss: 3.3022 - val_accuracy30: 0.3860 - 6s/epoch - 22ms/step
Epoch 16/50
254/254 - 6s - loss: 3.1464 - accuracy30: 0.4473 - val_loss: 3.3067 - val_accuracy30: 0.3889 - 6s/epoch - 22ms/step
Epoch 17/50
254/254 - 6s - loss: 3.1365 - accuracy30: 0.4508 - val_loss: 3.3056 - val_accuracy30: 0.3896 - 6s/epoch - 22ms/step
testing model: results/LILAK/W4/deepVOL_L2/h30
Evaluating performance on  test set...
534/534 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0975412
{'0': {'precision': 0.4200889102487084, 'recall': 0.33577904118008606, 'f1-score': 0.3732319943637315, 'support': 52064}, '1': {'precision': 0.313823642664613, 'recall': 0.2947381110240492, 'f1-score': 0.303981599477823, 'support': 33182}, '2': {'precision': 0.3997651663405088, 'recall': 0.49671257391845625, 'f1-score': 0.44299679918114554, 'support': 51408}, 'accuracy': 0.38635532073704393, 'macro avg': {'precision': 0.3778925730846101, 'recall': 0.3757432420408639, 'f1-score': 0.37340346434089994, 'support': 136654}, 'weighted avg': {'precision': 0.3866402213277242, 'recall': 0.38635532073704393, 'f1-score': 0.3826616669891168, 'support': 136654}}
[[17482 10813 23769]
 [ 8831  9780 14571]
 [15302 10571 25535]]
Evaluating performance on  train set...
254/254 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0765015
{'0': {'precision': 0.3875593715747168, 'recall': 0.39769425438185396, 'f1-score': 0.3925614100013878, 'support': 21338}, '1': {'precision': 0.44910649996727103, 'recall': 0.31671513640769977, 'f1-score': 0.3714672441797509, 'support': 21663}, '2': {'precision': 0.4018657926016641, 'recall': 0.5086391611579667, 'f1-score': 0.44899191114330556, 'support': 21935}, 'accuracy': 0.4081557225575952, 'macro avg': {'precision': 0.412843888047884, 'recall': 0.4076828506491735, 'f1-score': 0.40434018844148145, 'support': 64936}, 'weighted avg': {'precision': 0.4129244508465228, 'recall': 0.4081557225575952, 'f1-score': 0.4045861748214236, 'support': 64936}}
[[ 8486  4414  8438]
 [ 6634  6861  8168]
 [ 6776  4002 11157]]
Evaluating performance on  val set...
81/81 - 1s - 742ms/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0964559
{'0': {'precision': 0.37553956834532376, 'recall': 0.4373690825303729, 'f1-score': 0.40410296109928395, 'support': 7161}, '1': {'precision': 0.385012285012285, 'recall': 0.24821796293362902, 'f1-score': 0.30183954541076763, 'support': 6313}, '2': {'precision': 0.3819909833069331, 'recall': 0.4388912221755565, 'f1-score': 0.4084690553745928, 'support': 7143}, 'accuracy': 0.3799776883154678, 'macro avg': {'precision': 0.3808476122215139, 'recall': 0.3748260892131861, 'f1-score': 0.3714705206282148, 'support': 20617}, 'weighted avg': {'precision': 0.3806753163876821, 'recall': 0.3799776883154678, 'f1-score': 0.37430221744923436, 'support': 20617}}
[[3132 1289 2740]
 [2414 1567 2332]
 [2794 1214 3135]]
training model: results/LILAK/W4/deepVOL_L2/h50
Epoch 1/50
254/254 - 8s - loss: 3.3518 - accuracy50: 0.3521 - val_loss: 3.3447 - val_accuracy50: 0.3454 - 8s/epoch - 31ms/step
Epoch 2/50
254/254 - 6s - loss: 3.3148 - accuracy50: 0.3559 - val_loss: 3.3156 - val_accuracy50: 0.3503 - 6s/epoch - 22ms/step
Epoch 3/50
254/254 - 6s - loss: 3.2984 - accuracy50: 0.3586 - val_loss: 3.3084 - val_accuracy50: 0.3523 - 6s/epoch - 24ms/step
Epoch 4/50
254/254 - 6s - loss: 3.2862 - accuracy50: 0.3676 - val_loss: 3.3097 - val_accuracy50: 0.3487 - 6s/epoch - 23ms/step
Epoch 5/50
254/254 - 6s - loss: 3.2718 - accuracy50: 0.3803 - val_loss: 3.3082 - val_accuracy50: 0.3551 - 6s/epoch - 22ms/step
Epoch 6/50
254/254 - 6s - loss: 3.2641 - accuracy50: 0.3888 - val_loss: 3.2997 - val_accuracy50: 0.3652 - 6s/epoch - 22ms/step
Epoch 7/50
254/254 - 6s - loss: 3.2569 - accuracy50: 0.3914 - val_loss: 3.3079 - val_accuracy50: 0.3603 - 6s/epoch - 22ms/step
Epoch 8/50
254/254 - 6s - loss: 3.2542 - accuracy50: 0.3953 - val_loss: 3.2995 - val_accuracy50: 0.3630 - 6s/epoch - 22ms/step
Epoch 9/50
254/254 - 6s - loss: 3.2420 - accuracy50: 0.4028 - val_loss: 3.3048 - val_accuracy50: 0.3627 - 6s/epoch - 22ms/step
Epoch 10/50
254/254 - 6s - loss: 3.2351 - accuracy50: 0.4079 - val_loss: 3.3129 - val_accuracy50: 0.3695 - 6s/epoch - 22ms/step
Epoch 11/50
254/254 - 6s - loss: 3.2253 - accuracy50: 0.4130 - val_loss: 3.3102 - val_accuracy50: 0.3705 - 6s/epoch - 22ms/step
Epoch 12/50
254/254 - 6s - loss: 3.2204 - accuracy50: 0.4139 - val_loss: 3.3130 - val_accuracy50: 0.3695 - 6s/epoch - 22ms/step
Epoch 13/50
254/254 - 6s - loss: 3.2118 - accuracy50: 0.4194 - val_loss: 3.3147 - val_accuracy50: 0.3699 - 6s/epoch - 22ms/step
Epoch 14/50
254/254 - 6s - loss: 3.2039 - accuracy50: 0.4233 - val_loss: 3.3048 - val_accuracy50: 0.3775 - 6s/epoch - 22ms/step
Epoch 15/50
254/254 - 6s - loss: 3.1973 - accuracy50: 0.4244 - val_loss: 3.3062 - val_accuracy50: 0.3747 - 6s/epoch - 22ms/step
Epoch 16/50
254/254 - 6s - loss: 3.1869 - accuracy50: 0.4321 - val_loss: 3.3084 - val_accuracy50: 0.3750 - 6s/epoch - 22ms/step
Epoch 17/50
254/254 - 6s - loss: 3.1795 - accuracy50: 0.4343 - val_loss: 3.3179 - val_accuracy50: 0.3746 - 6s/epoch - 22ms/step
Epoch 18/50
254/254 - 6s - loss: 3.1746 - accuracy50: 0.4385 - val_loss: 3.3097 - val_accuracy50: 0.3737 - 6s/epoch - 22ms/step
testing model: results/LILAK/W4/deepVOL_L2/h50
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1014731
{'0': {'precision': 0.40310153125914366, 'recall': 0.32982204133748305, 'f1-score': 0.3627984550561798, 'support': 50124}, '1': {'precision': 0.3011833475905332, 'recall': 0.342539794070751, 'f1-score': 0.3205330838190853, 'support': 37003}, '2': {'precision': 0.37738526457298627, 'recall': 0.40810063197851676, 'f1-score': 0.39214240675170975, 'support': 49527}, 'accuracy': 0.36163595650328567, 'macro avg': {'precision': 0.36055671447422105, 'recall': 0.36015415579558363, 'f1-score': 0.35849131520899163, 'support': 136654}, 'weighted avg': {'precision': 0.3661840016555103, 'recall': 0.36163595650328567, 'f1-score': 0.36198890951589774, 'support': 136654}}
[[16532 14368 19224]
 [10206 12675 14122]
 [14274 15041 20212]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.084341
{'0': {'precision': 0.3864037363777893, 'recall': 0.3489058619558596, 'f1-score': 0.3666986776981606, 'support': 21341}, '1': {'precision': 0.39410392535392536, 'recall': 0.4487749026791848, 'f1-score': 0.41966637401229157, 'support': 21835}, '2': {'precision': 0.40145178348235744, 'recall': 0.3837775735294118, 'f1-score': 0.39241576993562327, 'support': 21760}, 'accuracy': 0.39417272391277564, 'macro avg': {'precision': 0.39398648173802403, 'recall': 0.3938194460548187, 'f1-score': 0.39292694054869176, 'support': 64936}, 'weighted avg': {'precision': 0.3940355451015994, 'recall': 0.39417272391277564, 'f1-score': 0.3931270622014598, 'support': 64936}}
[[7446 7661 6234]
 [5819 9799 6217]
 [6005 7404 8351]]
Evaluating performance on  val set...
81/81 - 1s - 750ms/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1007237
{'0': {'precision': 0.37413884472708003, 'recall': 0.38785881060293914, 'f1-score': 0.3808753118888664, 'support': 7281}, '1': {'precision': 0.3303099017384732, 'recall': 0.3560371517027864, 'f1-score': 0.3426913425345044, 'support': 6137}, '2': {'precision': 0.38286334056399135, 'recall': 0.34324211696068896, 'f1-score': 0.3619717278253863, 'support': 7199}, 'accuracy': 0.36280739195809286, 'macro avg': {'precision': 0.3624373623431815, 'recall': 0.3623793597554715, 'f1-score': 0.36184612741625233, 'support': 20617}, 'weighted avg': {'precision': 0.3641388167117938, 'recall': 0.36280739195809286, 'f1-score': 0.362908492196345, 'support': 20617}}
[[2824 2295 2162]
 [2131 2185 1821]
 [2593 2135 2471]]
training model: results/LILAK/W4/deepVOL_L2/h100
Epoch 1/50
254/254 - 8s - loss: 3.3452 - accuracy100: 0.3624 - val_loss: 3.4865 - val_accuracy100: 0.3149 - 8s/epoch - 31ms/step
Epoch 2/50
254/254 - 6s - loss: 3.3219 - accuracy100: 0.3576 - val_loss: 3.4487 - val_accuracy100: 0.3150 - 6s/epoch - 23ms/step
Epoch 3/50
254/254 - 6s - loss: 3.2974 - accuracy100: 0.3657 - val_loss: 3.4111 - val_accuracy100: 0.3171 - 6s/epoch - 23ms/step
Epoch 4/50
254/254 - 6s - loss: 3.2830 - accuracy100: 0.3757 - val_loss: 3.3886 - val_accuracy100: 0.3176 - 6s/epoch - 22ms/step
Epoch 5/50
254/254 - 6s - loss: 3.2705 - accuracy100: 0.3857 - val_loss: 3.4137 - val_accuracy100: 0.3198 - 6s/epoch - 23ms/step
Epoch 6/50
254/254 - 6s - loss: 3.2572 - accuracy100: 0.3919 - val_loss: 3.4115 - val_accuracy100: 0.3216 - 6s/epoch - 22ms/step
Epoch 7/50
254/254 - 6s - loss: 3.2561 - accuracy100: 0.3947 - val_loss: 3.3872 - val_accuracy100: 0.3283 - 6s/epoch - 23ms/step
Epoch 8/50
254/254 - 6s - loss: 3.2488 - accuracy100: 0.3969 - val_loss: 3.3935 - val_accuracy100: 0.3263 - 6s/epoch - 22ms/step
Epoch 9/50
254/254 - 6s - loss: 3.2466 - accuracy100: 0.3996 - val_loss: 3.3934 - val_accuracy100: 0.3261 - 6s/epoch - 22ms/step
Epoch 10/50
254/254 - 6s - loss: 3.2384 - accuracy100: 0.4044 - val_loss: 3.4006 - val_accuracy100: 0.3296 - 6s/epoch - 22ms/step
Epoch 11/50
254/254 - 6s - loss: 3.2304 - accuracy100: 0.4110 - val_loss: 3.4022 - val_accuracy100: 0.3294 - 6s/epoch - 22ms/step
Epoch 12/50
254/254 - 6s - loss: 3.2216 - accuracy100: 0.4120 - val_loss: 3.4384 - val_accuracy100: 0.3237 - 6s/epoch - 22ms/step
Epoch 13/50
254/254 - 6s - loss: 3.2138 - accuracy100: 0.4181 - val_loss: 3.4481 - val_accuracy100: 0.3252 - 6s/epoch - 22ms/step
Epoch 14/50
254/254 - 6s - loss: 3.2115 - accuracy100: 0.4192 - val_loss: 3.4225 - val_accuracy100: 0.3282 - 6s/epoch - 22ms/step
Epoch 15/50
254/254 - 6s - loss: 3.2027 - accuracy100: 0.4249 - val_loss: 3.4511 - val_accuracy100: 0.3258 - 6s/epoch - 22ms/step
Epoch 16/50
254/254 - 6s - loss: 3.1949 - accuracy100: 0.4289 - val_loss: 3.4793 - val_accuracy100: 0.3266 - 6s/epoch - 22ms/step
Epoch 17/50
254/254 - 6s - loss: 3.1994 - accuracy100: 0.4246 - val_loss: 3.4598 - val_accuracy100: 0.3261 - 6s/epoch - 22ms/step
testing model: results/LILAK/W4/deepVOL_L2/h100
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1668937
{'0': {'precision': 0.40958459299070654, 'recall': 0.07105534080534566, 'f1-score': 0.12110176786068992, 'support': 51481}, '1': {'precision': 0.24520573755048208, 'recall': 0.9021398432790838, 'f1-score': 0.3856028546952394, 'support': 33180}, '2': {'precision': 0.40601769911504426, 'recall': 0.0441213240243879, 'f1-score': 0.07959335912426486, 'support': 51993}, 'accuracy': 0.26259750903742296, 'macro avg': {'precision': 0.3536026765520776, 'recall': 0.3391055027029391, 'f1-score': 0.19543266056006472, 'support': 136654}, 'weighted avg': {'precision': 0.3683158124443343, 'recall': 0.26259750903742296, 'f1-score': 0.1695306419934442, 'support': 136654}}
[[ 3658 45731  2092]
 [ 1983 29933  1264]
 [ 3290 46409  2294]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1202123
{'0': {'precision': 0.4098939929328622, 'recall': 0.06978250809810273, 'f1-score': 0.11926133892206096, 'support': 21610}, '1': {'precision': 0.33707233085013893, 'recall': 0.9263527758257203, 'f1-score': 0.49428792840536956, 'support': 21345}, '2': {'precision': 0.4083204930662558, 'recall': 0.04822346572039489, 'f1-score': 0.08625951092484845, 'support': 21981}, 'accuracy': 0.3440464457311815, 'macro avg': {'precision': 0.385095605616419, 'recall': 0.3481195832147393, 'f1-score': 0.23326959275075965, 'support': 64936}, 'weighted avg': {'precision': 0.385424276939829, 'recall': 0.3440464457311815, 'f1-score': 0.2313644769551165, 'support': 64936}}
[[ 1508 19258   844]
 [  880 19773   692]
 [ 1291 19630  1060]]
Evaluating performance on  val set...
81/81 - 1s - 764ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1327047
{'0': {'precision': 0.37635782747603835, 'recall': 0.08153377630121816, 'f1-score': 0.13403117533280237, 'support': 7224}, '1': {'precision': 0.31916881974602823, 'recall': 0.903235843186061, 'f1-score': 0.4716682237296397, 'support': 6428}, '2': {'precision': 0.38559814169570267, 'recall': 0.047666905958363245, 'f1-score': 0.08484538717096857, 'support': 6965}, 'accuracy': 0.32628413445215115, 'macro avg': {'precision': 0.36037492963925644, 'recall': 0.3441455084818808, 'f1-score': 0.2301815954111369, 'support': 20617}, 'weighted avg': {'precision': 0.3616489875309181, 'recall': 0.32628413445215115, 'f1-score': 0.22268383733734706, 'support': 20617}}
[[ 589 6340  295]
 [ 388 5806  234]
 [ 588 6045  332]]
training model: results/LILAK/W4/deepVOL_L2/h200
Epoch 1/50
254/254 - 8s - loss: 3.3533 - accuracy200: 0.3473 - val_loss: 3.3891 - val_accuracy200: 0.3264 - 8s/epoch - 33ms/step
Epoch 2/50
254/254 - 6s - loss: 3.3269 - accuracy200: 0.3511 - val_loss: 3.3453 - val_accuracy200: 0.3228 - 6s/epoch - 23ms/step
Epoch 3/50
254/254 - 6s - loss: 3.3021 - accuracy200: 0.3545 - val_loss: 3.3348 - val_accuracy200: 0.3210 - 6s/epoch - 22ms/step
Epoch 4/50
254/254 - 6s - loss: 3.2866 - accuracy200: 0.3696 - val_loss: 3.3212 - val_accuracy200: 0.3249 - 6s/epoch - 22ms/step
Epoch 5/50
254/254 - 6s - loss: 3.2779 - accuracy200: 0.3740 - val_loss: 3.3265 - val_accuracy200: 0.3316 - 6s/epoch - 22ms/step
Epoch 6/50
254/254 - 6s - loss: 3.2707 - accuracy200: 0.3825 - val_loss: 3.3343 - val_accuracy200: 0.3338 - 6s/epoch - 22ms/step
Epoch 7/50
254/254 - 6s - loss: 3.2634 - accuracy200: 0.3865 - val_loss: 3.3250 - val_accuracy200: 0.3407 - 6s/epoch - 22ms/step
Epoch 8/50
254/254 - 6s - loss: 3.2583 - accuracy200: 0.3902 - val_loss: 3.3176 - val_accuracy200: 0.3393 - 6s/epoch - 23ms/step
Epoch 9/50
254/254 - 6s - loss: 3.2506 - accuracy200: 0.3960 - val_loss: 3.3218 - val_accuracy200: 0.3411 - 6s/epoch - 22ms/step
Epoch 10/50
254/254 - 6s - loss: 3.2430 - accuracy200: 0.3980 - val_loss: 3.3366 - val_accuracy200: 0.3353 - 6s/epoch - 22ms/step
Epoch 11/50
254/254 - 6s - loss: 3.2374 - accuracy200: 0.4025 - val_loss: 3.3341 - val_accuracy200: 0.3427 - 6s/epoch - 22ms/step
Epoch 12/50
254/254 - 6s - loss: 3.2338 - accuracy200: 0.4066 - val_loss: 3.3320 - val_accuracy200: 0.3395 - 6s/epoch - 23ms/step
Epoch 13/50
254/254 - 6s - loss: 3.2304 - accuracy200: 0.4079 - val_loss: 3.3445 - val_accuracy200: 0.3436 - 6s/epoch - 22ms/step
Epoch 14/50
254/254 - 6s - loss: 3.2251 - accuracy200: 0.4117 - val_loss: 3.3493 - val_accuracy200: 0.3417 - 6s/epoch - 22ms/step
Epoch 15/50
254/254 - 6s - loss: 3.2132 - accuracy200: 0.4178 - val_loss: 3.3534 - val_accuracy200: 0.3402 - 6s/epoch - 22ms/step
Epoch 16/50
254/254 - 6s - loss: 3.2046 - accuracy200: 0.4230 - val_loss: 3.3650 - val_accuracy200: 0.3360 - 6s/epoch - 22ms/step
Epoch 17/50
254/254 - 6s - loss: 3.1970 - accuracy200: 0.4273 - val_loss: 3.3734 - val_accuracy200: 0.3380 - 6s/epoch - 22ms/step
Epoch 18/50
254/254 - 6s - loss: 3.1898 - accuracy200: 0.4298 - val_loss: 3.3604 - val_accuracy200: 0.3412 - 6s/epoch - 22ms/step
testing model: results/LILAK/W4/deepVOL_L2/h200
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1123506
{'0': {'precision': 0.36233878452331425, 'recall': 0.22829834855725606, 'f1-score': 0.2801088570014844, 'support': 49593}, '1': {'precision': 0.2896321927463796, 'recall': 0.40582833102457544, 'f1-score': 0.3380233539523306, 'support': 38982}, '2': {'precision': 0.3438939865317213, 'recall': 0.36325630732752345, 'f1-score': 0.35331006928640063, 'support': 48079}, 'accuracy': 0.3264229367599924, 'macro avg': {'precision': 0.331954987933805, 'recall': 0.33246099563645165, 'f1-score': 0.3238140934134052, 'support': 136654}, 'weighted avg': {'precision': 0.3351090232043169, 'recall': 0.3264229367599924, 'f1-score': 0.3223839752240346, 'support': 136654}}
[[11322 19519 18752]
 [ 8593 15820 14569]
 [11332 19282 17465]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0933161
{'0': {'precision': 0.3730458221024259, 'recall': 0.2243319594312972, 'f1-score': 0.2801781479553473, 'support': 21593}, '1': {'precision': 0.3648174762862892, 'recall': 0.591398350496249, 'f1-score': 0.4512630886562017, 'support': 21461}, '2': {'precision': 0.38325272420022144, 'recall': 0.300566675806599, 'f1-score': 0.3369105857644136, 'support': 21882}, 'accuracy': 0.37133485277812, 'macro avg': {'precision': 0.37370534086297885, 'recall': 0.37209899524471507, 'f1-score': 0.3561172741253209, 'support': 64936}, 'weighted avg': {'precision': 0.3737658988263364, 'recall': 0.37133485277812, 'f1-score': 0.35583838444233484, 'support': 64936}}
[[ 4844 11157  5592]
 [ 3777 12692  4992]
 [ 4364 10941  6577]]
Evaluating performance on  val set...
81/81 - 1s - 755ms/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1061846
{'0': {'precision': 0.3668447157573445, 'recall': 0.2579476861167002, 'f1-score': 0.3029061983145625, 'support': 7455}, '1': {'precision': 0.31145584725536996, 'recall': 0.528518393520081, 'f1-score': 0.39194093355024406, 'support': 5926}, '2': {'precision': 0.36717428087986465, 'recall': 0.26990049751243783, 'f1-score': 0.3111111111111111, 'support': 7236}, 'accuracy': 0.33991366348159285, 'macro avg': {'precision': 0.3484916146308597, 'recall': 0.3521221923830731, 'f1-score': 0.33531941432530593, 'support': 20617}, 'weighted avg': {'precision': 0.351039811963575, 'recall': 0.33991366348159285, 'f1-score': 0.3313773915047684, 'support': 20617}}
[[1923 3615 1917]
 [1345 3132 1449]
 [1974 3309 1953]]
training model: results/LILAK/W4/deepVOL_L2/h300
Epoch 1/50
254/254 - 8s - loss: 3.3523 - accuracy300: 0.3556 - val_loss: 3.4400 - val_accuracy300: 0.3258 - 8s/epoch - 31ms/step
Epoch 2/50
254/254 - 6s - loss: 3.3200 - accuracy300: 0.3595 - val_loss: 3.4251 - val_accuracy300: 0.3104 - 6s/epoch - 22ms/step
Epoch 3/50
254/254 - 6s - loss: 3.3051 - accuracy300: 0.3619 - val_loss: 3.3832 - val_accuracy300: 0.3150 - 6s/epoch - 22ms/step
Epoch 4/50
254/254 - 6s - loss: 3.2962 - accuracy300: 0.3631 - val_loss: 3.3578 - val_accuracy300: 0.3219 - 6s/epoch - 23ms/step
Epoch 5/50
254/254 - 6s - loss: 3.2873 - accuracy300: 0.3669 - val_loss: 3.3398 - val_accuracy300: 0.3263 - 6s/epoch - 22ms/step
Epoch 6/50
254/254 - 6s - loss: 3.2796 - accuracy300: 0.3749 - val_loss: 3.3438 - val_accuracy300: 0.3296 - 6s/epoch - 22ms/step
Epoch 7/50
254/254 - 6s - loss: 3.2711 - accuracy300: 0.3828 - val_loss: 3.3452 - val_accuracy300: 0.3321 - 6s/epoch - 22ms/step
Epoch 8/50
254/254 - 6s - loss: 3.2697 - accuracy300: 0.3833 - val_loss: 3.3374 - val_accuracy300: 0.3290 - 6s/epoch - 23ms/step
Epoch 9/50
254/254 - 6s - loss: 3.2563 - accuracy300: 0.3933 - val_loss: 3.3635 - val_accuracy300: 0.3228 - 6s/epoch - 22ms/step
Epoch 10/50
254/254 - 6s - loss: 3.2519 - accuracy300: 0.3987 - val_loss: 3.3737 - val_accuracy300: 0.3222 - 6s/epoch - 22ms/step
Epoch 11/50
254/254 - 6s - loss: 3.2425 - accuracy300: 0.4057 - val_loss: 3.3827 - val_accuracy300: 0.3247 - 6s/epoch - 22ms/step
Epoch 12/50
254/254 - 6s - loss: 3.2395 - accuracy300: 0.4057 - val_loss: 3.3787 - val_accuracy300: 0.3283 - 6s/epoch - 22ms/step
Epoch 13/50
254/254 - 6s - loss: 3.2452 - accuracy300: 0.4035 - val_loss: 3.3608 - val_accuracy300: 0.3331 - 6s/epoch - 22ms/step
Epoch 14/50
254/254 - 6s - loss: 3.2421 - accuracy300: 0.4063 - val_loss: 3.3606 - val_accuracy300: 0.3366 - 6s/epoch - 22ms/step
Epoch 15/50
254/254 - 6s - loss: 3.2334 - accuracy300: 0.4116 - val_loss: 3.3607 - val_accuracy300: 0.3392 - 6s/epoch - 22ms/step
Epoch 16/50
254/254 - 6s - loss: 3.2229 - accuracy300: 0.4191 - val_loss: 3.3817 - val_accuracy300: 0.3355 - 6s/epoch - 22ms/step
Epoch 17/50
254/254 - 6s - loss: 3.2130 - accuracy300: 0.4237 - val_loss: 3.3698 - val_accuracy300: 0.3449 - 6s/epoch - 22ms/step
Epoch 18/50
254/254 - 6s - loss: 3.2016 - accuracy300: 0.4290 - val_loss: 3.3753 - val_accuracy300: 0.3474 - 6s/epoch - 22ms/step
testing model: results/LILAK/W4/deepVOL_L2/h300
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1189615
{'0': {'precision': 0.3868768193858016, 'recall': 0.28599678176072585, 'f1-score': 0.3288746210094525, 'support': 51581}, '1': {'precision': 0.2742491328641692, 'recall': 0.6460681537531857, 'f1-score': 0.3850490119319783, 'support': 38061}, '2': {'precision': 0.3343115124153499, 'recall': 0.0630051901642134, 'f1-score': 0.10602806414662086, 'support': 47012}, 'accuracy': 0.3095701552826847, 'macro avg': {'precision': 0.3318124882217736, 'recall': 0.3316900418927083, 'f1-score': 0.27331723236268385, 'support': 136654}, 'weighted avg': {'precision': 0.3374240218972925, 'recall': 0.3095701552826847, 'f1-score': 0.26785621804771564, 'support': 136654}}
[[14752 33319  3510]
 [11083 24590  2388]
 [12296 31754  2962]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988475
{'0': {'precision': 0.37582869770631716, 'recall': 0.2286297051733729, 'f1-score': 0.2843060959792478, 'support': 21572}, '1': {'precision': 0.35290258407229474, 'recall': 0.7719907407407407, 'f1-score': 0.48437931184732236, 'support': 21600}, '2': {'precision': 0.41341516878562035, 'recall': 0.08665686454695828, 'f1-score': 0.1432804072020056, 'support': 21764}, 'accuracy': 0.3617869902673401, 'macro avg': {'precision': 0.38071548352141077, 'recall': 0.36242577015369065, 'f1-score': 0.30398860500952524, 'support': 64936}, 'weighted avg': {'precision': 0.38080017580898856, 'recall': 0.3617869902673401, 'f1-score': 0.30359121320547844, 'support': 64936}}
[[ 4932 15152  1488]
 [ 3737 16675  1188]
 [ 4454 15424  1886]]
Evaluating performance on  val set...
81/81 - 1s - 735ms/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.11294
{'0': {'precision': 0.3538834047308624, 'recall': 0.2604523646333105, 'f1-score': 0.3000631711939356, 'support': 7295}, '1': {'precision': 0.3185163804300765, 'recall': 0.7088485627107757, 'f1-score': 0.43953198904655216, 'support': 6227}, '2': {'precision': 0.3647482014388489, 'recall': 0.07145877378435518, 'f1-score': 0.11950500883912787, 'support': 7095}, 'accuracy': 0.3308434786826405, 'macro avg': {'precision': 0.34571599553326254, 'recall': 0.34691990037614717, 'f1-score': 0.28636672302653854, 'support': 20617}, 'weighted avg': {'precision': 0.34694036123870403, 'recall': 0.3308434786826405, 'f1-score': 0.2800511503791169, 'support': 20617}}
[[1900 4907  488]
 [1418 4414  395]
 [2051 4537  507]]
training model: results/LILAK/W4/deepVOL_L2/h500
Epoch 1/50
254/254 - 8s - loss: 3.3460 - accuracy500: 0.3548 - val_loss: 3.3894 - val_accuracy500: 0.3168 - 8s/epoch - 31ms/step
Epoch 2/50
254/254 - 6s - loss: 3.3151 - accuracy500: 0.3573 - val_loss: 3.3620 - val_accuracy500: 0.3067 - 6s/epoch - 24ms/step
Epoch 3/50
254/254 - 6s - loss: 3.2985 - accuracy500: 0.3611 - val_loss: 3.3473 - val_accuracy500: 0.3200 - 6s/epoch - 25ms/step
Epoch 4/50
254/254 - 6s - loss: 3.2854 - accuracy500: 0.3709 - val_loss: 3.3364 - val_accuracy500: 0.3161 - 6s/epoch - 24ms/step
Epoch 5/50
254/254 - 6s - loss: 3.2804 - accuracy500: 0.3742 - val_loss: 3.3289 - val_accuracy500: 0.3238 - 6s/epoch - 23ms/step
Epoch 6/50
254/254 - 6s - loss: 3.2719 - accuracy500: 0.3781 - val_loss: 3.3363 - val_accuracy500: 0.3243 - 6s/epoch - 23ms/step
Epoch 7/50
254/254 - 6s - loss: 3.2676 - accuracy500: 0.3813 - val_loss: 3.3349 - val_accuracy500: 0.3250 - 6s/epoch - 22ms/step
Epoch 8/50
254/254 - 6s - loss: 3.2557 - accuracy500: 0.3927 - val_loss: 3.3387 - val_accuracy500: 0.3315 - 6s/epoch - 22ms/step
Epoch 9/50
254/254 - 6s - loss: 3.2455 - accuracy500: 0.3978 - val_loss: 3.3463 - val_accuracy500: 0.3274 - 6s/epoch - 22ms/step
Epoch 10/50
254/254 - 6s - loss: 3.2338 - accuracy500: 0.4054 - val_loss: 3.3456 - val_accuracy500: 0.3356 - 6s/epoch - 22ms/step
Epoch 11/50
254/254 - 6s - loss: 3.2314 - accuracy500: 0.4076 - val_loss: 3.3472 - val_accuracy500: 0.3317 - 6s/epoch - 22ms/step
Epoch 12/50
254/254 - 6s - loss: 3.2242 - accuracy500: 0.4118 - val_loss: 3.3583 - val_accuracy500: 0.3300 - 6s/epoch - 22ms/step
Epoch 13/50
254/254 - 6s - loss: 3.2095 - accuracy500: 0.4179 - val_loss: 3.3536 - val_accuracy500: 0.3404 - 6s/epoch - 22ms/step
Epoch 14/50
254/254 - 6s - loss: 3.2000 - accuracy500: 0.4224 - val_loss: 3.3738 - val_accuracy500: 0.3318 - 6s/epoch - 22ms/step
Epoch 15/50
254/254 - 6s - loss: 3.1936 - accuracy500: 0.4252 - val_loss: 3.3671 - val_accuracy500: 0.3336 - 6s/epoch - 22ms/step
testing model: results/LILAK/W4/deepVOL_L2/h500
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1058408
{'0': {'precision': 0.38322332987328384, 'recall': 0.3851771653543307, 'f1-score': 0.3841977635751382, 'support': 50800}, '1': {'precision': 0.2995396251233147, 'recall': 0.43674633807206387, 'f1-score': 0.3553587625447417, 'support': 41713}, '2': {'precision': 0.31503531786074673, 'recall': 0.17681973675267892, 'f1-score': 0.22650763248012074, 'support': 44141}, 'accuracy': 0.33361628638751883, 'macro avg': {'precision': 0.33259942428578176, 'recall': 0.33291441339302447, 'f1-score': 0.3220213862000002, 'support': 136654}, 'weighted avg': {'precision': 0.33565366184687506, 'recall': 0.33361628638751883, 'f1-score': 0.324458851237072, 'support': 136654}}
[[19567 21500  9733]
 [16258 18218  7237]
 [15234 21102  7805]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0939596
{'0': {'precision': 0.37172322022621423, 'recall': 0.2601508660830695, 'f1-score': 0.30608667068427103, 'support': 21476}, '1': {'precision': 0.363593343323606, 'recall': 0.6374446902654868, 'f1-score': 0.4630606197579228, 'support': 21696}, '2': {'precision': 0.3810767545707305, 'recall': 0.20782025362984746, 'f1-score': 0.26896203133826896, 'support': 21764}, 'accuracy': 0.36867069114204754, 'macro avg': {'precision': 0.37213110604018357, 'recall': 0.3684719366594679, 'f1-score': 0.34603644059348765, 'support': 64936}, 'weighted avg': {'precision': 0.37214185568566754, 'recall': 0.36867069114204754, 'f1-score': 0.3460910773057993, 'support': 64936}}
[[ 5587 11988  3901]
 [ 4421 13830  3445]
 [ 5022 12219  4523]]
Evaluating performance on  val set...
81/81 - 1s - 732ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1092931
{'0': {'precision': 0.3779242174629325, 'recall': 0.3033588997619677, 'f1-score': 0.33656103286384975, 'support': 7562}, '1': {'precision': 0.2856484893146647, 'recall': 0.5474929378531074, 'f1-score': 0.37542372881355934, 'support': 5664}, '2': {'precision': 0.3660254673530209, 'recall': 0.18278987958327697, 'f1-score': 0.2438188052698069, 'support': 7391}, 'accuracy': 0.3272057040306543, 'macro avg': {'precision': 0.34319939137687266, 'recall': 0.34454723906611734, 'f1-score': 0.31860118898240536, 'support': 20617}, 'weighted avg': {'precision': 0.3483082022185155, 'recall': 0.3272057040306543, 'f1-score': 0.31399036330530994, 'support': 20617}}
[[2294 3885 1383]
 [1606 3101  957]
 [2170 3870 1351]]
training model: results/LILAK/W4/deepVOL_L2/h1000
Epoch 1/50
254/254 - 8s - loss: 3.3519 - accuracy1000: 0.3589 - val_loss: 3.4500 - val_accuracy1000: 0.2957 - 8s/epoch - 33ms/step
Epoch 2/50
254/254 - 6s - loss: 3.3172 - accuracy1000: 0.3641 - val_loss: 3.3502 - val_accuracy1000: 0.3110 - 6s/epoch - 22ms/step
Epoch 3/50
254/254 - 6s - loss: 3.3042 - accuracy1000: 0.3629 - val_loss: 3.3448 - val_accuracy1000: 0.3096 - 6s/epoch - 23ms/step
Epoch 4/50
254/254 - 6s - loss: 3.2993 - accuracy1000: 0.3660 - val_loss: 3.3305 - val_accuracy1000: 0.3230 - 6s/epoch - 23ms/step
Epoch 5/50
254/254 - 6s - loss: 3.2937 - accuracy1000: 0.3642 - val_loss: 3.3280 - val_accuracy1000: 0.3248 - 6s/epoch - 22ms/step
Epoch 6/50
254/254 - 6s - loss: 3.2854 - accuracy1000: 0.3673 - val_loss: 3.3308 - val_accuracy1000: 0.3284 - 6s/epoch - 22ms/step
Epoch 7/50
254/254 - 6s - loss: 3.2787 - accuracy1000: 0.3738 - val_loss: 3.3329 - val_accuracy1000: 0.3258 - 6s/epoch - 22ms/step
Epoch 8/50
254/254 - 6s - loss: 3.2683 - accuracy1000: 0.3851 - val_loss: 3.3427 - val_accuracy1000: 0.3289 - 6s/epoch - 22ms/step
Epoch 9/50
254/254 - 6s - loss: 3.2586 - accuracy1000: 0.3896 - val_loss: 3.3452 - val_accuracy1000: 0.3314 - 6s/epoch - 22ms/step
Epoch 10/50
254/254 - 6s - loss: 3.2512 - accuracy1000: 0.3956 - val_loss: 3.3544 - val_accuracy1000: 0.3327 - 6s/epoch - 22ms/step
Epoch 11/50
254/254 - 6s - loss: 3.2401 - accuracy1000: 0.4031 - val_loss: 3.3737 - val_accuracy1000: 0.3274 - 6s/epoch - 22ms/step
Epoch 12/50
254/254 - 6s - loss: 3.2348 - accuracy1000: 0.4067 - val_loss: 3.3680 - val_accuracy1000: 0.3283 - 6s/epoch - 22ms/step
Epoch 13/50
254/254 - 6s - loss: 3.2254 - accuracy1000: 0.4120 - val_loss: 3.3695 - val_accuracy1000: 0.3307 - 6s/epoch - 22ms/step
Epoch 14/50
254/254 - 6s - loss: 3.2168 - accuracy1000: 0.4169 - val_loss: 3.3729 - val_accuracy1000: 0.3339 - 6s/epoch - 22ms/step
Epoch 15/50
254/254 - 6s - loss: 3.2077 - accuracy1000: 0.4201 - val_loss: 3.3856 - val_accuracy1000: 0.3338 - 6s/epoch - 22ms/step
testing model: results/LILAK/W4/deepVOL_L2/h1000
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099419
{'0': {'precision': 0.4152016624448253, 'recall': 0.4952506739519821, 'f1-score': 0.45170712387993206, 'support': 55271}, '1': {'precision': 0.26528031060650625, 'recall': 0.23563683866753757, 'f1-score': 0.24958144812032154, 'support': 38275}, '2': {'precision': 0.3213264722698685, 'recall': 0.2737774890971513, 'f1-score': 0.2956523917481869, 'support': 43108}, 'accuracy': 0.35267171103663264, 'macro avg': {'precision': 0.33393614844040004, 'recall': 0.334888333905557, 'f1-score': 0.33231365458281353, 'support': 136654}, 'weighted avg': {'precision': 0.3435973812699333, 'recall': 0.35267171103663264, 'f1-score': 0.3458663315691738, 'support': 136654}}
[[27373 12913 14985]
 [19314  9019  9942]
 [19240 12066 11802]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0936111
{'0': {'precision': 0.36475770925110135, 'recall': 0.3683274021352313, 'f1-score': 0.3665338645418327, 'support': 21356}, '1': {'precision': 0.3668057729090593, 'recall': 0.3940412814046885, 'f1-score': 0.37993606195686436, 'support': 21414}, '2': {'precision': 0.3746747189080375, 'recall': 0.34426599296219434, 'f1-score': 0.3588272635365481, 'support': 22166}, 'accuracy': 0.3685936922508316, 'macro avg': {'precision': 0.3687460670227327, 'recall': 0.36887822550070476, 'f1-score': 0.36843239667841504, 'support': 64936}, 'weighted avg': {'precision': 0.3688182869156812, 'recall': 0.3685936922508316, 'f1-score': 0.36832285889877414, 'support': 64936}}
[[7866 7132 6358]
 [6598 8438 6378]
 [7101 7434 7631]]
Evaluating performance on  val set...
81/81 - 1s - 777ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1112912
{'0': {'precision': 0.3315166975881262, 'recall': 0.38463608233553076, 'f1-score': 0.3561063710531233, 'support': 7433}, '1': {'precision': 0.2876374979477918, 'recall': 0.3172763491488591, 'f1-score': 0.30173081890984244, 'support': 5522}, '2': {'precision': 0.362419518807184, 'recall': 0.27916992952231795, 'f1-score': 0.31539368917723387, 'support': 7662}, 'accuracy': 0.3273997186787602, 'macro avg': {'precision': 0.32719123811436734, 'recall': 0.3270274536689026, 'f1-score': 0.32441029304673324, 'support': 20617}, 'weighted avg': {'precision': 0.3312487864355091, 'recall': 0.3273997186787602, 'f1-score': 0.32641231432962997, 'support': 20617}}
[[2859 2251 2323]
 [2330 1752 1440]
 [3435 2088 2139]]
training model: results/LILAK/W4/deepVOL_L3/h10
Epoch 1/50
254/254 - 11s - loss: 3.3539 - accuracy10: 0.3428 - val_loss: 3.3763 - val_accuracy10: 0.3157 - 11s/epoch - 44ms/step
Epoch 2/50
254/254 - 9s - loss: 3.3166 - accuracy10: 0.3553 - val_loss: 3.3517 - val_accuracy10: 0.3175 - 9s/epoch - 35ms/step
Epoch 3/50
254/254 - 9s - loss: 3.2938 - accuracy10: 0.3643 - val_loss: 3.3484 - val_accuracy10: 0.3400 - 9s/epoch - 34ms/step
Epoch 4/50
254/254 - 9s - loss: 3.2797 - accuracy10: 0.3714 - val_loss: 3.3406 - val_accuracy10: 0.3446 - 9s/epoch - 35ms/step
Epoch 5/50
254/254 - 9s - loss: 3.2644 - accuracy10: 0.3841 - val_loss: 3.3368 - val_accuracy10: 0.3430 - 9s/epoch - 35ms/step
Epoch 6/50
254/254 - 9s - loss: 3.2507 - accuracy10: 0.3921 - val_loss: 3.3337 - val_accuracy10: 0.3578 - 9s/epoch - 34ms/step
Epoch 7/50
254/254 - 9s - loss: 3.2377 - accuracy10: 0.4013 - val_loss: 3.3396 - val_accuracy10: 0.3468 - 9s/epoch - 34ms/step
Epoch 8/50
254/254 - 9s - loss: 3.2249 - accuracy10: 0.4108 - val_loss: 3.3324 - val_accuracy10: 0.3633 - 9s/epoch - 35ms/step
Epoch 9/50
254/254 - 9s - loss: 3.2105 - accuracy10: 0.4167 - val_loss: 3.3279 - val_accuracy10: 0.3704 - 9s/epoch - 35ms/step
Epoch 10/50
254/254 - 9s - loss: 3.1971 - accuracy10: 0.4258 - val_loss: 3.3361 - val_accuracy10: 0.3789 - 9s/epoch - 35ms/step
Epoch 11/50
254/254 - 9s - loss: 3.1852 - accuracy10: 0.4284 - val_loss: 3.3182 - val_accuracy10: 0.3823 - 9s/epoch - 35ms/step
Epoch 12/50
254/254 - 9s - loss: 3.1695 - accuracy10: 0.4350 - val_loss: 3.3172 - val_accuracy10: 0.3894 - 9s/epoch - 35ms/step
Epoch 13/50
254/254 - 9s - loss: 3.1564 - accuracy10: 0.4415 - val_loss: 3.3133 - val_accuracy10: 0.3826 - 9s/epoch - 34ms/step
Epoch 14/50
254/254 - 9s - loss: 3.1402 - accuracy10: 0.4468 - val_loss: 3.3093 - val_accuracy10: 0.3842 - 9s/epoch - 35ms/step
Epoch 15/50
254/254 - 9s - loss: 3.1268 - accuracy10: 0.4516 - val_loss: 3.3054 - val_accuracy10: 0.3889 - 9s/epoch - 34ms/step
Epoch 16/50
254/254 - 9s - loss: 3.1141 - accuracy10: 0.4567 - val_loss: 3.3055 - val_accuracy10: 0.3823 - 9s/epoch - 35ms/step
Epoch 17/50
254/254 - 9s - loss: 3.1044 - accuracy10: 0.4625 - val_loss: 3.2973 - val_accuracy10: 0.3991 - 9s/epoch - 34ms/step
Epoch 18/50
254/254 - 9s - loss: 3.0934 - accuracy10: 0.4656 - val_loss: 3.2995 - val_accuracy10: 0.3976 - 9s/epoch - 34ms/step
Epoch 19/50
254/254 - 9s - loss: 3.0824 - accuracy10: 0.4702 - val_loss: 3.2969 - val_accuracy10: 0.3894 - 9s/epoch - 35ms/step
Epoch 20/50
254/254 - 9s - loss: 3.0682 - accuracy10: 0.4728 - val_loss: 3.3081 - val_accuracy10: 0.3954 - 9s/epoch - 34ms/step
Epoch 21/50
254/254 - 9s - loss: 3.0617 - accuracy10: 0.4784 - val_loss: 3.3046 - val_accuracy10: 0.4059 - 9s/epoch - 34ms/step
Epoch 22/50
254/254 - 9s - loss: 3.0493 - accuracy10: 0.4808 - val_loss: 3.3088 - val_accuracy10: 0.3903 - 9s/epoch - 35ms/step
Epoch 23/50
254/254 - 9s - loss: 3.0419 - accuracy10: 0.4830 - val_loss: 3.3136 - val_accuracy10: 0.3972 - 9s/epoch - 34ms/step
Epoch 24/50
254/254 - 9s - loss: 3.0342 - accuracy10: 0.4848 - val_loss: 3.3122 - val_accuracy10: 0.4027 - 9s/epoch - 34ms/step
Epoch 25/50
254/254 - 9s - loss: 3.0240 - accuracy10: 0.4875 - val_loss: 3.3312 - val_accuracy10: 0.3963 - 9s/epoch - 34ms/step
Epoch 26/50
254/254 - 9s - loss: 3.0114 - accuracy10: 0.4950 - val_loss: 3.3313 - val_accuracy10: 0.4028 - 9s/epoch - 35ms/step
Epoch 27/50
254/254 - 9s - loss: 3.0027 - accuracy10: 0.4955 - val_loss: 3.3438 - val_accuracy10: 0.3907 - 9s/epoch - 35ms/step
Epoch 28/50
254/254 - 9s - loss: 2.9954 - accuracy10: 0.4974 - val_loss: 3.3446 - val_accuracy10: 0.3952 - 9s/epoch - 35ms/step
Epoch 29/50
254/254 - 9s - loss: 2.9862 - accuracy10: 0.4998 - val_loss: 3.3434 - val_accuracy10: 0.3891 - 9s/epoch - 35ms/step
testing model: results/LILAK/W4/deepVOL_L3/h10
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0992886
{'0': {'precision': 0.40658058296760446, 'recall': 0.34855701267915007, 'f1-score': 0.3753395784543326, 'support': 45981}, '1': {'precision': 0.42740012413027145, 'recall': 0.2886261360628254, 'f1-score': 0.3445651458292185, 'support': 45332}, '2': {'precision': 0.3804749181951908, 'recall': 0.5590525131779185, 'f1-score': 0.4527924403597618, 'support': 45341}, 'accuracy': 0.3985174235660866, 'macro avg': {'precision': 0.40481854176435556, 'recall': 0.39874522063996465, 'f1-score': 0.39089905488110427, 'support': 136654}, 'weighted avg': {'precision': 0.40482530682157153, 'recall': 0.3985174235660866, 'f1-score': 0.39082923577788253, 'support': 136654}}
[[16027  9072 20882]
 [11856 13084 20392]
 [11536  8457 25348]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0493597
{'0': {'precision': 0.3680021583704303, 'recall': 0.4746824430137463, 'f1-score': 0.41458966565349537, 'support': 17241}, '1': {'precision': 0.6224581895407486, 'recall': 0.390448596263363, 'f1-score': 0.4798821169825222, 'support': 30027}, '2': {'precision': 0.3869331992288995, 'recall': 0.5225832012678289, 'f1-score': 0.44464242716108837, 'support': 17668}, 'accuracy': 0.4487649377848959, 'macro avg': {'precision': 0.45913118238002615, 'recall': 0.4625714135149794, 'f1-score': 0.44637140326570196, 'support': 64936}, 'weighted avg': {'precision': 0.49081577297309414, 'recall': 0.4487649377848959, 'f1-score': 0.4529583459906403, 'support': 64936}}
[[ 8184  3640  5417]
 [ 9091 11724  9212]
 [ 4964  3471  9233]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1007671
{'0': {'precision': 0.3405391658189217, 'recall': 0.46005840920803986, 'f1-score': 0.3913774205334308, 'support': 5821}, '1': {'precision': 0.53596757852077, 'recall': 0.29529976554649995, 'f1-score': 0.38079470198675497, 'support': 8957}, '2': {'precision': 0.34727551803530315, 'recall': 0.4649768796026717, 'f1-score': 0.39759830123746065, 'support': 5839}, 'accuracy': 0.38987243536887034, 'macro avg': {'precision': 0.40792742079166494, 'recall': 0.4067783514524039, 'f1-score': 0.38992347458588217, 'support': 20617}, 'weighted avg': {'precision': 0.4273503339404674, 'recall': 0.38987243536887034, 'f1-score': 0.3885416205823348, 'support': 20617}}
[[2678 1161 1982]
 [3191 2645 3121]
 [1995 1129 2715]]
training model: results/LILAK/W4/deepVOL_L3/h20
Epoch 1/50
254/254 - 11s - loss: 3.3595 - accuracy20: 0.3422 - val_loss: 3.3279 - val_accuracy20: 0.3427 - 11s/epoch - 44ms/step
Epoch 2/50
254/254 - 10s - loss: 3.3050 - accuracy20: 0.3570 - val_loss: 3.3065 - val_accuracy20: 0.3435 - 10s/epoch - 38ms/step
Epoch 3/50
254/254 - 10s - loss: 3.2912 - accuracy20: 0.3642 - val_loss: 3.3037 - val_accuracy20: 0.3506 - 10s/epoch - 38ms/step
Epoch 4/50
254/254 - 9s - loss: 3.2852 - accuracy20: 0.3697 - val_loss: 3.2941 - val_accuracy20: 0.3580 - 9s/epoch - 37ms/step
Epoch 5/50
254/254 - 9s - loss: 3.2724 - accuracy20: 0.3768 - val_loss: 3.3008 - val_accuracy20: 0.3614 - 9s/epoch - 35ms/step
Epoch 6/50
254/254 - 9s - loss: 3.2640 - accuracy20: 0.3853 - val_loss: 3.2964 - val_accuracy20: 0.3606 - 9s/epoch - 35ms/step
Epoch 7/50
254/254 - 9s - loss: 3.2544 - accuracy20: 0.3931 - val_loss: 3.2935 - val_accuracy20: 0.3640 - 9s/epoch - 35ms/step
Epoch 8/50
254/254 - 9s - loss: 3.2402 - accuracy20: 0.3994 - val_loss: 3.2948 - val_accuracy20: 0.3737 - 9s/epoch - 35ms/step
Epoch 9/50
254/254 - 9s - loss: 3.2298 - accuracy20: 0.4084 - val_loss: 3.2933 - val_accuracy20: 0.3728 - 9s/epoch - 35ms/step
Epoch 10/50
254/254 - 9s - loss: 3.2206 - accuracy20: 0.4155 - val_loss: 3.2962 - val_accuracy20: 0.3779 - 9s/epoch - 35ms/step
Epoch 11/50
254/254 - 9s - loss: 3.2104 - accuracy20: 0.4184 - val_loss: 3.2891 - val_accuracy20: 0.3793 - 9s/epoch - 34ms/step
Epoch 12/50
254/254 - 9s - loss: 3.2039 - accuracy20: 0.4229 - val_loss: 3.2812 - val_accuracy20: 0.3865 - 9s/epoch - 35ms/step
Epoch 13/50
254/254 - 9s - loss: 3.1863 - accuracy20: 0.4308 - val_loss: 3.2938 - val_accuracy20: 0.3845 - 9s/epoch - 34ms/step
Epoch 14/50
254/254 - 9s - loss: 3.1743 - accuracy20: 0.4374 - val_loss: 3.3077 - val_accuracy20: 0.3795 - 9s/epoch - 35ms/step
Epoch 15/50
254/254 - 9s - loss: 3.1599 - accuracy20: 0.4411 - val_loss: 3.3107 - val_accuracy20: 0.3865 - 9s/epoch - 34ms/step
Epoch 16/50
254/254 - 9s - loss: 3.1498 - accuracy20: 0.4464 - val_loss: 3.3094 - val_accuracy20: 0.3839 - 9s/epoch - 35ms/step
Epoch 17/50
254/254 - 9s - loss: 3.1360 - accuracy20: 0.4530 - val_loss: 3.3204 - val_accuracy20: 0.3839 - 9s/epoch - 34ms/step
Epoch 18/50
254/254 - 9s - loss: 3.1286 - accuracy20: 0.4552 - val_loss: 3.3219 - val_accuracy20: 0.3923 - 9s/epoch - 34ms/step
Epoch 19/50
254/254 - 9s - loss: 3.1142 - accuracy20: 0.4624 - val_loss: 3.3278 - val_accuracy20: 0.3903 - 9s/epoch - 34ms/step
Epoch 20/50
254/254 - 9s - loss: 3.0992 - accuracy20: 0.4678 - val_loss: 3.3295 - val_accuracy20: 0.3903 - 9s/epoch - 35ms/step
Epoch 21/50
254/254 - 9s - loss: 3.0895 - accuracy20: 0.4699 - val_loss: 3.3356 - val_accuracy20: 0.3910 - 9s/epoch - 34ms/step
Epoch 22/50
254/254 - 9s - loss: 3.0785 - accuracy20: 0.4751 - val_loss: 3.3342 - val_accuracy20: 0.3857 - 9s/epoch - 35ms/step
testing model: results/LILAK/W4/deepVOL_L3/h20
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0895567
{'0': {'precision': 0.41555173155517316, 'recall': 0.3664245206077044, 'f1-score': 0.3894449316117848, 'support': 52723}, '1': {'precision': 0.3149491536652423, 'recall': 0.29888092543694206, 'f1-score': 0.3067047305688618, 'support': 31812}, '2': {'precision': 0.39848270112546896, 'recall': 0.45854678716015274, 'f1-score': 0.4264099773404464, 'support': 52119}, 'accuracy': 0.38583576038754813, 'macro avg': {'precision': 0.3763278621152948, 'recall': 0.37461741106826646, 'f1-score': 0.37418654650703104, 'support': 136654}, 'weighted avg': {'precision': 0.38562220146604126, 'recall': 0.38583576038754813, 'f1-score': 0.38428189169165544, 'support': 136654}}
[[19319 10482 22922]
 [ 9150  9508 13154]
 [18021 10199 23899]]
Evaluating performance on  train set...
254/254 - 5s - 5s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.066226
{'0': {'precision': 0.38265599433953923, 'recall': 0.41834268033262423, 'f1-score': 0.3997043675081415, 'support': 20684}, '1': {'precision': 0.4977692467316871, 'recall': 0.41804635761589404, 'f1-score': 0.45443781377285214, 'support': 22952}, '2': {'precision': 0.39935783399140884, 'recall': 0.432112676056338, 'f1-score': 0.41509008501138744, 'support': 21300}, 'accuracy': 0.4227547123321424, 'macro avg': {'precision': 0.4265943583542117, 'recall': 0.4228339046682854, 'f1-score': 0.4230774220974604, 'support': 64936}, 'weighted avg': {'precision': 0.4288218892743889, 'recall': 0.4227547123321424, 'f1-score': 0.42409696701360494, 'support': 64936}}
[[8653 4868 7163]
 [6677 9595 6680]
 [7283 4813 9204]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.095082
{'0': {'precision': 0.3735835262580724, 'recall': 0.4391291893440275, 'f1-score': 0.40371321350977685, 'support': 6982}, '1': {'precision': 0.4207132782591175, 'recall': 0.3103448275862069, 'f1-score': 0.35719784449576597, 'support': 6728}, '2': {'precision': 0.3651134685108097, 'recall': 0.3936586072100767, 'f1-score': 0.378849101295806, 'support': 6907}, 'accuracy': 0.38186933113450067, 'macro avg': {'precision': 0.3864700910093332, 'recall': 0.38104420804677036, 'f1-score': 0.37992005310044963, 'support': 20617}, 'weighted avg': {'precision': 0.38612590791411777, 'recall': 0.38186933113450067, 'f1-score': 0.38020388500474883, 'support': 20617}}
[[3066 1476 2440]
 [2352 2088 2288]
 [2789 1399 2719]]
training model: results/LILAK/W4/deepVOL_L3/h30
Epoch 1/50
254/254 - 11s - loss: 3.3561 - accuracy30: 0.3416 - val_loss: 3.3243 - val_accuracy30: 0.3533 - 11s/epoch - 45ms/step
Epoch 2/50
254/254 - 9s - loss: 3.3120 - accuracy30: 0.3526 - val_loss: 3.3111 - val_accuracy30: 0.3517 - 9s/epoch - 36ms/step
Epoch 3/50
254/254 - 9s - loss: 3.3002 - accuracy30: 0.3603 - val_loss: 3.2991 - val_accuracy30: 0.3582 - 9s/epoch - 35ms/step
Epoch 4/50
254/254 - 9s - loss: 3.2857 - accuracy30: 0.3697 - val_loss: 3.2999 - val_accuracy30: 0.3614 - 9s/epoch - 34ms/step
Epoch 5/50
254/254 - 9s - loss: 3.2762 - accuracy30: 0.3772 - val_loss: 3.3046 - val_accuracy30: 0.3630 - 9s/epoch - 34ms/step
Epoch 6/50
254/254 - 9s - loss: 3.2655 - accuracy30: 0.3861 - val_loss: 3.3018 - val_accuracy30: 0.3636 - 9s/epoch - 34ms/step
Epoch 7/50
254/254 - 9s - loss: 3.2525 - accuracy30: 0.3968 - val_loss: 3.3020 - val_accuracy30: 0.3681 - 9s/epoch - 35ms/step
Epoch 8/50
254/254 - 9s - loss: 3.2391 - accuracy30: 0.4031 - val_loss: 3.2951 - val_accuracy30: 0.3742 - 9s/epoch - 35ms/step
Epoch 9/50
254/254 - 9s - loss: 3.2338 - accuracy30: 0.4081 - val_loss: 3.3015 - val_accuracy30: 0.3726 - 9s/epoch - 35ms/step
Epoch 10/50
254/254 - 9s - loss: 3.2190 - accuracy30: 0.4164 - val_loss: 3.3033 - val_accuracy30: 0.3735 - 9s/epoch - 35ms/step
Epoch 11/50
254/254 - 9s - loss: 3.2089 - accuracy30: 0.4223 - val_loss: 3.3006 - val_accuracy30: 0.3760 - 9s/epoch - 34ms/step
Epoch 12/50
254/254 - 9s - loss: 3.1971 - accuracy30: 0.4282 - val_loss: 3.3128 - val_accuracy30: 0.3783 - 9s/epoch - 37ms/step
Epoch 13/50
254/254 - 9s - loss: 3.1875 - accuracy30: 0.4320 - val_loss: 3.3140 - val_accuracy30: 0.3756 - 9s/epoch - 34ms/step
Epoch 14/50
254/254 - 9s - loss: 3.1816 - accuracy30: 0.4337 - val_loss: 3.3156 - val_accuracy30: 0.3803 - 9s/epoch - 37ms/step
Epoch 15/50
254/254 - 9s - loss: 3.1714 - accuracy30: 0.4386 - val_loss: 3.3139 - val_accuracy30: 0.3766 - 9s/epoch - 34ms/step
Epoch 16/50
254/254 - 9s - loss: 3.1597 - accuracy30: 0.4435 - val_loss: 3.3148 - val_accuracy30: 0.3797 - 9s/epoch - 34ms/step
Epoch 17/50
254/254 - 9s - loss: 3.1471 - accuracy30: 0.4482 - val_loss: 3.3125 - val_accuracy30: 0.3796 - 9s/epoch - 35ms/step
Epoch 18/50
254/254 - 9s - loss: 3.1380 - accuracy30: 0.4507 - val_loss: 3.3171 - val_accuracy30: 0.3745 - 9s/epoch - 37ms/step
testing model: results/LILAK/W4/deepVOL_L3/h30
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0872768
{'0': {'precision': 0.3961115697796772, 'recall': 0.46997925629993853, 'f1-score': 0.4298953767228581, 'support': 52064}, '1': {'precision': 0.2835566900659434, 'recall': 0.12051714785124465, 'f1-score': 0.16914454901131437, 'support': 33182}, '2': {'precision': 0.3958175655664879, 'recall': 0.4679621848739496, 'f1-score': 0.4288770434813613, 'support': 51408}, 'accuracy': 0.3843648923558769, 'macro avg': {'precision': 0.3584952751373695, 'recall': 0.35281952967504426, 'f1-score': 0.3426389897385113, 'support': 136654}, 'weighted avg': {'precision': 0.368670659251974, 'recall': 0.3843648923558769, 'f1-score': 0.3661973917359327, 'support': 136654}}
[[24469  5297 22298]
 [14760  3999 14423]
 [22544  4807 24057]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0807582
{'0': {'precision': 0.37718012604426204, 'recall': 0.48242571937388695, 'f1-score': 0.4233600658030023, 'support': 21338}, '1': {'precision': 0.4533708676194601, 'recall': 0.289941374694179, 'f1-score': 0.3536897823577442, 'support': 21663}, '2': {'precision': 0.4007566204287516, 'recall': 0.43464782311374517, 'f1-score': 0.41701476216511757, 'support': 21935}, 'accuracy': 0.40207281015153384, 'macro avg': {'precision': 0.4104358713641579, 'recall': 0.4023383057272704, 'f1-score': 0.398021536775288, 'support': 64936}, 'weighted avg': {'precision': 0.4105617701102238, 'recall': 0.40207281015153384, 'f1-score': 0.39797427694055887, 'support': 64936}}
[[10294  3705  7339]
 [ 8465  6281  6917]
 [ 8533  3868  9534]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0995032
{'0': {'precision': 0.3681462140992167, 'recall': 0.5513196480938416, 'f1-score': 0.44148727984344427, 'support': 7161}, '1': {'precision': 0.3795156808257245, 'recall': 0.15143354981783622, 'f1-score': 0.21648550724637683, 'support': 6313}, '2': {'precision': 0.36682940059669106, 'recall': 0.37869242615147697, 'f1-score': 0.37266652889715507, 'support': 7143}, 'accuracy': 0.3690643643595091, 'macro avg': {'precision': 0.37149709850721074, 'recall': 0.36048187468771825, 'f1-score': 0.3435464386623254, 'support': 20617}, 'weighted avg': {'precision': 0.3711713605606759, 'recall': 0.3690643643595091, 'f1-score': 0.3487471714661522, 'support': 20617}}
[[3948  720 2493]
 [3181  956 2176]
 [3595  843 2705]]
training model: results/LILAK/W4/deepVOL_L3/h50
Epoch 1/50
254/254 - 12s - loss: 3.3576 - accuracy50: 0.3419 - val_loss: 3.3373 - val_accuracy50: 0.3374 - 12s/epoch - 46ms/step
Epoch 2/50
254/254 - 9s - loss: 3.3237 - accuracy50: 0.3484 - val_loss: 3.3240 - val_accuracy50: 0.3442 - 9s/epoch - 37ms/step
Epoch 3/50
254/254 - 9s - loss: 3.3102 - accuracy50: 0.3557 - val_loss: 3.3050 - val_accuracy50: 0.3536 - 9s/epoch - 37ms/step
Epoch 4/50
254/254 - 9s - loss: 3.3010 - accuracy50: 0.3579 - val_loss: 3.3114 - val_accuracy50: 0.3452 - 9s/epoch - 37ms/step
Epoch 5/50
254/254 - 9s - loss: 3.2867 - accuracy50: 0.3688 - val_loss: 3.3102 - val_accuracy50: 0.3530 - 9s/epoch - 36ms/step
Epoch 6/50
254/254 - 9s - loss: 3.2781 - accuracy50: 0.3761 - val_loss: 3.3063 - val_accuracy50: 0.3475 - 9s/epoch - 37ms/step
Epoch 7/50
254/254 - 9s - loss: 3.2711 - accuracy50: 0.3813 - val_loss: 3.3089 - val_accuracy50: 0.3528 - 9s/epoch - 37ms/step
Epoch 8/50
254/254 - 9s - loss: 3.2623 - accuracy50: 0.3901 - val_loss: 3.3110 - val_accuracy50: 0.3549 - 9s/epoch - 37ms/step
Epoch 9/50
254/254 - 9s - loss: 3.2553 - accuracy50: 0.3917 - val_loss: 3.3051 - val_accuracy50: 0.3604 - 9s/epoch - 37ms/step
Epoch 10/50
254/254 - 9s - loss: 3.2477 - accuracy50: 0.3998 - val_loss: 3.3114 - val_accuracy50: 0.3587 - 9s/epoch - 37ms/step
Epoch 11/50
254/254 - 9s - loss: 3.2399 - accuracy50: 0.4050 - val_loss: 3.3087 - val_accuracy50: 0.3613 - 9s/epoch - 36ms/step
Epoch 12/50
254/254 - 9s - loss: 3.2321 - accuracy50: 0.4106 - val_loss: 3.3085 - val_accuracy50: 0.3614 - 9s/epoch - 37ms/step
Epoch 13/50
254/254 - 9s - loss: 3.2228 - accuracy50: 0.4147 - val_loss: 3.3177 - val_accuracy50: 0.3624 - 9s/epoch - 37ms/step
testing model: results/LILAK/W4/deepVOL_L3/h50
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1007662
{'0': {'precision': 0.3670718264962612, 'recall': 0.4916407309871519, 'f1-score': 0.42032100155213287, 'support': 50124}, '1': {'precision': 0.27463120491008935, 'recall': 0.1378536875388482, 'f1-score': 0.18356514385447217, 'support': 37003}, '2': {'precision': 0.3623248145094806, 'recall': 0.3727057968380883, 'f1-score': 0.3674419993431071, 'support': 49527}, 'accuracy': 0.3527375707992448, 'macro avg': {'precision': 0.3346759486386104, 'recall': 0.3340667384546961, 'f1-score': 0.3237760482499041, 'support': 136654}, 'weighted avg': {'precision': 0.34032042819674274, 'recall': 0.3527375707992448, 'f1-score': 0.33704780541595714, 'support': 136654}}
[[24643  6625 18856]
 [18271  5101 13631]
 [24220  6848 18459]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0986227
{'0': {'precision': 0.34801420013312623, 'recall': 0.44098214704090716, 'f1-score': 0.3890209371060083, 'support': 21341}, '1': {'precision': 0.3766169699627275, 'recall': 0.3146782688344401, 'f1-score': 0.34287282616831755, 'support': 21835}, '2': {'precision': 0.360763358778626, 'recall': 0.32578125, 'f1-score': 0.3423810673750302, 'support': 21760}, 'accuracy': 0.35990821732167055, 'macro avg': {'precision': 0.36179817629149325, 'recall': 0.3604805552917824, 'f1-score': 0.358091610216452, 'support': 64936}, 'weighted avg': {'precision': 0.361904232955527, 'recall': 0.35990821732167055, 'f1-score': 0.35787446107313653, 'support': 64936}}
[[9411 5628 6302]
 [8705 6871 6259]
 [8926 5745 7089]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1015995
{'0': {'precision': 0.3612702240980806, 'recall': 0.49375085839857163, 'f1-score': 0.41724698235840296, 'support': 7281}, '1': {'precision': 0.33370312846682937, 'recall': 0.24507088153821086, 'f1-score': 0.28260052611800074, 'support': 6137}, '2': {'precision': 0.35411592791037505, 'recall': 0.3029587442700375, 'f1-score': 0.3265458901033088, 'support': 7199}, 'accuracy': 0.35310665955279624, 'macro avg': {'precision': 0.34969642682509505, 'recall': 0.3472601614022733, 'f1-score': 0.34213113285990415, 'support': 20617}, 'weighted avg': {'precision': 0.350566288309931, 'recall': 0.35310665955279624, 'f1-score': 0.3454963656298891, 'support': 20617}}
[[3595 1477 2209]
 [2864 1504 1769]
 [3492 1526 2181]]
training model: results/LILAK/W4/deepVOL_L3/h100
Epoch 1/50
254/254 - 11s - loss: 3.3341 - accuracy100: 0.3639 - val_loss: 3.4567 - val_accuracy100: 0.3161 - 11s/epoch - 44ms/step
Epoch 2/50
254/254 - 9s - loss: 3.3019 - accuracy100: 0.3802 - val_loss: 3.4952 - val_accuracy100: 0.3127 - 9s/epoch - 35ms/step
Epoch 3/50
254/254 - 9s - loss: 3.3079 - accuracy100: 0.3703 - val_loss: 3.4911 - val_accuracy100: 0.3117 - 9s/epoch - 35ms/step
Epoch 4/50
254/254 - 9s - loss: 3.3101 - accuracy100: 0.3556 - val_loss: 3.3928 - val_accuracy100: 0.3120 - 9s/epoch - 35ms/step
Epoch 5/50
254/254 - 9s - loss: 3.2973 - accuracy100: 0.3558 - val_loss: 3.3813 - val_accuracy100: 0.3114 - 9s/epoch - 35ms/step
Epoch 6/50
254/254 - 9s - loss: 3.2956 - accuracy100: 0.3542 - val_loss: 3.3776 - val_accuracy100: 0.3119 - 9s/epoch - 34ms/step
Epoch 7/50
254/254 - 9s - loss: 3.2927 - accuracy100: 0.3540 - val_loss: 3.3877 - val_accuracy100: 0.3114 - 9s/epoch - 34ms/step
Epoch 8/50
254/254 - 9s - loss: 3.2882 - accuracy100: 0.3614 - val_loss: 3.3902 - val_accuracy100: 0.3118 - 9s/epoch - 35ms/step
Epoch 9/50
254/254 - 9s - loss: 3.2839 - accuracy100: 0.3666 - val_loss: 3.3822 - val_accuracy100: 0.3131 - 9s/epoch - 35ms/step
Epoch 10/50
254/254 - 9s - loss: 3.2814 - accuracy100: 0.3652 - val_loss: 3.4058 - val_accuracy100: 0.3128 - 9s/epoch - 35ms/step
Epoch 11/50
254/254 - 9s - loss: 3.2773 - accuracy100: 0.3737 - val_loss: 3.4153 - val_accuracy100: 0.3102 - 9s/epoch - 35ms/step
Epoch 12/50
254/254 - 9s - loss: 3.2743 - accuracy100: 0.3748 - val_loss: 3.4201 - val_accuracy100: 0.3131 - 9s/epoch - 35ms/step
Epoch 13/50
254/254 - 9s - loss: 3.2719 - accuracy100: 0.3760 - val_loss: 3.4077 - val_accuracy100: 0.3133 - 9s/epoch - 35ms/step
Epoch 14/50
254/254 - 9s - loss: 3.2657 - accuracy100: 0.3830 - val_loss: 3.4062 - val_accuracy100: 0.3158 - 9s/epoch - 35ms/step
Epoch 15/50
254/254 - 9s - loss: 3.2606 - accuracy100: 0.3905 - val_loss: 3.4372 - val_accuracy100: 0.3135 - 9s/epoch - 35ms/step
Epoch 16/50
254/254 - 9s - loss: 3.2535 - accuracy100: 0.3936 - val_loss: 3.4226 - val_accuracy100: 0.3160 - 9s/epoch - 36ms/step
testing model: results/LILAK/W4/deepVOL_L3/h100
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1529654
{'0': {'precision': 0.39980353634577603, 'recall': 0.0079058293350945, 'f1-score': 0.015505057239185509, 'support': 51481}, '1': {'precision': 0.2430543266678464, 'recall': 0.993490054249548, 'f1-score': 0.3905594654155115, 'support': 33180}, '2': {'precision': 0.4166666666666667, 'recall': 9.616679168349586e-05, 'f1-score': 0.0001922892029612537, 'support': 51993}, 'accuracy': 0.24423727077143736, 'macro avg': {'precision': 0.353174843226763, 'recall': 0.33383068345877526, 'f1-score': 0.13541893728588608, 'support': 136654}, 'weighted avg': {'precision': 0.3681603056877665, 'recall': 0.24423727077143736, 'f1-score': 0.10074331235636531, 'support': 136654}}
[[  407 51069     5]
 [  214 32964     2]
 [  397 51591     5]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.115102
{'0': {'precision': 0.4090121317157712, 'recall': 0.01092086996760759, 'f1-score': 0.021273718844368322, 'support': 21610}, '1': {'precision': 0.32898724144897357, 'recall': 0.9918013586319981, 'f1-score': 0.49408359978528255, 'support': 21345}, '2': {'precision': 0.3, 'recall': 0.0001364815067558346, 'f1-score': 0.00027283888863626035, 'support': 21981}, 'accuracy': 0.32969385240852533, 'macro avg': {'precision': 0.3459997910549149, 'recall': 0.3342862367021206, 'f1-score': 0.17187671917276237, 'support': 64936}, 'weighted avg': {'precision': 0.34580640684837616, 'recall': 0.32969385240852533, 'f1-score': 0.169581384336189, 'support': 64936}}
[[  236 21371     3]
 [  171 21170     4]
 [  170 21808     3]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.129794
{'0': {'precision': 0.30124223602484473, 'recall': 0.013427464008859358, 'f1-score': 0.025708984892658365, 'support': 7224}, '1': {'precision': 0.3110432168728133, 'recall': 0.9819539514623522, 'f1-score': 0.4724374087796115, 'support': 6428}, '2': {'precision': 0.5, 'recall': 0.00014357501794687725, 'f1-score': 0.0002870676044208411, 'support': 6965}, 'accuracy': 0.31090847358975604, 'macro avg': {'precision': 0.37076181763255267, 'recall': 0.33184166349638616, 'f1-score': 0.16614448709223023, 'support': 20617}, 'weighted avg': {'precision': 0.3714439400059137, 'recall': 0.31090847358975604, 'f1-score': 0.15640242500677587, 'support': 20617}}
[[  97 7127    0]
 [ 115 6312    1]
 [ 110 6854    1]]
training model: results/LILAK/W4/deepVOL_L3/h200
Epoch 1/50
254/254 - 12s - loss: 3.3577 - accuracy200: 0.3431 - val_loss: 3.3530 - val_accuracy200: 0.3260 - 12s/epoch - 46ms/step
Epoch 2/50
254/254 - 10s - loss: 3.3209 - accuracy200: 0.3479 - val_loss: 3.3253 - val_accuracy200: 0.3299 - 10s/epoch - 38ms/step
Epoch 3/50
254/254 - 9s - loss: 3.3097 - accuracy200: 0.3484 - val_loss: 3.3302 - val_accuracy200: 0.3110 - 9s/epoch - 37ms/step
Epoch 4/50
254/254 - 9s - loss: 3.2961 - accuracy200: 0.3565 - val_loss: 3.3237 - val_accuracy200: 0.3217 - 9s/epoch - 37ms/step
Epoch 5/50
254/254 - 9s - loss: 3.2911 - accuracy200: 0.3607 - val_loss: 3.3216 - val_accuracy200: 0.3279 - 9s/epoch - 37ms/step
Epoch 6/50
254/254 - 9s - loss: 3.2848 - accuracy200: 0.3678 - val_loss: 3.3393 - val_accuracy200: 0.3168 - 9s/epoch - 37ms/step
Epoch 7/50
254/254 - 9s - loss: 3.2768 - accuracy200: 0.3756 - val_loss: 3.3387 - val_accuracy200: 0.3249 - 9s/epoch - 37ms/step
Epoch 8/50
254/254 - 9s - loss: 3.2700 - accuracy200: 0.3807 - val_loss: 3.3383 - val_accuracy200: 0.3320 - 9s/epoch - 37ms/step
Epoch 9/50
254/254 - 9s - loss: 3.2679 - accuracy200: 0.3831 - val_loss: 3.3464 - val_accuracy200: 0.3296 - 9s/epoch - 37ms/step
Epoch 10/50
254/254 - 9s - loss: 3.2580 - accuracy200: 0.3910 - val_loss: 3.3379 - val_accuracy200: 0.3355 - 9s/epoch - 37ms/step
Epoch 11/50
254/254 - 9s - loss: 3.2493 - accuracy200: 0.3975 - val_loss: 3.3510 - val_accuracy200: 0.3353 - 9s/epoch - 37ms/step
Epoch 12/50
254/254 - 9s - loss: 3.2398 - accuracy200: 0.4038 - val_loss: 3.3587 - val_accuracy200: 0.3352 - 9s/epoch - 36ms/step
Epoch 13/50
254/254 - 9s - loss: 3.2267 - accuracy200: 0.4105 - val_loss: 3.3699 - val_accuracy200: 0.3328 - 9s/epoch - 37ms/step
Epoch 14/50
254/254 - 9s - loss: 3.2174 - accuracy200: 0.4162 - val_loss: 3.3925 - val_accuracy200: 0.3298 - 9s/epoch - 37ms/step
Epoch 15/50
254/254 - 9s - loss: 3.2051 - accuracy200: 0.4226 - val_loss: 3.4100 - val_accuracy200: 0.3271 - 9s/epoch - 37ms/step
testing model: results/LILAK/W4/deepVOL_L3/h200
Evaluating performance on  test set...
534/534 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.104942
{'0': {'precision': 0.37392687320469337, 'recall': 0.46460185913334545, 'f1-score': 0.41436175952235377, 'support': 49593}, '1': {'precision': 0.2865862681266647, 'recall': 0.3974654968960033, 'f1-score': 0.33303957182468885, 'support': 38982}, '2': {'precision': 0.36602927852749034, 'recall': 0.1596539029513925, 'f1-score': 0.22233164373642292, 'support': 48079}, 'accuracy': 0.3381606100077568, 'macro avg': {'precision': 0.34218080661961614, 'recall': 0.34057375299358045, 'f1-score': 0.32324432502782185, 'support': 136654}, 'weighted avg': {'precision': 0.34623342901983994, 'recall': 0.3381606100077568, 'f1-score': 0.3236017564657133, 'support': 136654}}
[[23041 19213  7339]
 [17532 15494  5956]
 [21046 19357  7676]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0944685
{'0': {'precision': 0.3793235551663748, 'recall': 0.32098365210947993, 'f1-score': 0.3477235670387558, 'support': 21593}, '1': {'precision': 0.35605350822402665, 'recall': 0.6374819439914263, 'f1-score': 0.4569090757284796, 'support': 21461}, '2': {'precision': 0.39053398058252425, 'recall': 0.14706151174481308, 'f1-score': 0.21366443131266183, 'support': 21882}, 'accuracy': 0.3669767155352963, 'macro avg': {'precision': 0.3753036813243085, 'recall': 0.36850903594857315, 'f1-score': 0.33943235802663246, 'support': 64936}, 'weighted avg': {'precision': 0.3754105955065012, 'recall': 0.3669767155352963, 'f1-score': 0.33863382011920073, 'support': 64936}}
[[ 6931 12067  2595]
 [ 5353 13681  2427]
 [ 5988 12676  3218]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1088578
{'0': {'precision': 0.36413121329322445, 'recall': 0.3409792085848424, 'f1-score': 0.3521751177611527, 'support': 7455}, '1': {'precision': 0.29757412398921834, 'recall': 0.558893013837327, 'f1-score': 0.3883677298311445, 'support': 5926}, '2': {'precision': 0.3304070231444533, 'recall': 0.11442786069651742, 'f1-score': 0.1699856292342435, 'support': 7236}, 'accuracy': 0.32410146966095943, 'macro avg': {'precision': 0.3307041201422987, 'recall': 0.33810002770622893, 'f1-score': 0.30350949227551355, 'support': 20617}, 'weighted avg': {'precision': 0.33316426605880395, 'recall': 0.32410146966095943, 'f1-score': 0.29863455803597716, 'support': 20617}}
[[2542 3950  963]
 [1899 3312  715]
 [2540 3868  828]]
training model: results/LILAK/W4/deepVOL_L3/h300
Epoch 1/50
254/254 - 12s - loss: 3.3521 - accuracy300: 0.3482 - val_loss: 3.4219 - val_accuracy300: 0.3183 - 12s/epoch - 48ms/step
Epoch 2/50
254/254 - 9s - loss: 3.3215 - accuracy300: 0.3611 - val_loss: 3.3877 - val_accuracy300: 0.3165 - 9s/epoch - 36ms/step
Epoch 3/50
254/254 - 9s - loss: 3.3140 - accuracy300: 0.3557 - val_loss: 3.3815 - val_accuracy300: 0.3085 - 9s/epoch - 35ms/step
Epoch 4/50
254/254 - 9s - loss: 3.2983 - accuracy300: 0.3615 - val_loss: 3.3462 - val_accuracy300: 0.3243 - 9s/epoch - 36ms/step
Epoch 5/50
254/254 - 9s - loss: 3.2913 - accuracy300: 0.3681 - val_loss: 3.3527 - val_accuracy300: 0.3343 - 9s/epoch - 35ms/step
Epoch 6/50
254/254 - 9s - loss: 3.2813 - accuracy300: 0.3723 - val_loss: 3.3376 - val_accuracy300: 0.3295 - 9s/epoch - 35ms/step
Epoch 7/50
254/254 - 9s - loss: 3.2739 - accuracy300: 0.3760 - val_loss: 3.3482 - val_accuracy300: 0.3304 - 9s/epoch - 35ms/step
Epoch 8/50
254/254 - 9s - loss: 3.2621 - accuracy300: 0.3877 - val_loss: 3.3702 - val_accuracy300: 0.3362 - 9s/epoch - 35ms/step
Epoch 9/50
254/254 - 9s - loss: 3.2518 - accuracy300: 0.3932 - val_loss: 3.3941 - val_accuracy300: 0.3375 - 9s/epoch - 35ms/step
Epoch 10/50
254/254 - 9s - loss: 3.2452 - accuracy300: 0.3991 - val_loss: 3.4313 - val_accuracy300: 0.3312 - 9s/epoch - 35ms/step
Epoch 11/50
254/254 - 9s - loss: 3.2345 - accuracy300: 0.4053 - val_loss: 3.4431 - val_accuracy300: 0.3327 - 9s/epoch - 35ms/step
Epoch 12/50
254/254 - 9s - loss: 3.2285 - accuracy300: 0.4086 - val_loss: 3.4562 - val_accuracy300: 0.3333 - 9s/epoch - 34ms/step
Epoch 13/50
254/254 - 9s - loss: 3.2073 - accuracy300: 0.4195 - val_loss: 3.4689 - val_accuracy300: 0.3288 - 9s/epoch - 34ms/step
Epoch 14/50
254/254 - 9s - loss: 3.2027 - accuracy300: 0.4224 - val_loss: 3.4801 - val_accuracy300: 0.3312 - 9s/epoch - 35ms/step
Epoch 15/50
254/254 - 9s - loss: 3.1916 - accuracy300: 0.4253 - val_loss: 3.4801 - val_accuracy300: 0.3312 - 9s/epoch - 34ms/step
Epoch 16/50
254/254 - 9s - loss: 3.1811 - accuracy300: 0.4329 - val_loss: 3.5032 - val_accuracy300: 0.3269 - 9s/epoch - 34ms/step
testing model: results/LILAK/W4/deepVOL_L3/h300
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1164229
{'0': {'precision': 0.390149336401014, 'recall': 0.35505321726992495, 'f1-score': 0.3717748320172144, 'support': 51581}, '1': {'precision': 0.2777732372823968, 'recall': 0.6250755366385539, 'f1-score': 0.38462533344111227, 'support': 38061}, '2': {'precision': 0.35359251968503935, 'recall': 0.03056666383051136, 'f1-score': 0.056269089200407234, 'support': 47012}, 'accuracy': 0.3186295315175553, 'macro avg': {'precision': 0.34050503112281677, 'recall': 0.3368984725796634, 'f1-score': 0.2708897515529113, 'support': 136654}, 'weighted avg': {'precision': 0.34627388616900406, 'recall': 0.3186295315175553, 'f1-score': 0.2668130083852039, 'support': 136654}}
[[18314 31706  1561]
 [13204 23791  1066]
 [15423 30152  1437]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.098524
{'0': {'precision': 0.39464882943143814, 'recall': 0.19692193584275913, 'f1-score': 0.2627412172191984, 'support': 21572}, '1': {'precision': 0.3464337988053325, 'recall': 0.8108796296296297, 'f1-score': 0.4854624573851825, 'support': 21600}, '2': {'precision': 0.4070282235749862, 'recall': 0.06758867855173681, 'f1-score': 0.11592718102293324, 'support': 21764}, 'accuracy': 0.3577984477023531, 'macro avg': {'precision': 0.3827036172705856, 'recall': 0.35846341467470855, 'f1-score': 0.28804361854243804, 'support': 64936}, 'weighted avg': {'precision': 0.38275989991031417, 'recall': 0.3577984477023531, 'f1-score': 0.2876198377657325, 'support': 64936}}
[[ 4248 16219  1105]
 [ 3047 17515  1038]
 [ 3469 16824  1471]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1129012
{'0': {'precision': 0.37021366617304846, 'recall': 0.23989033584647018, 'f1-score': 0.2911329229745467, 'support': 7295}, '1': {'precision': 0.3207862539279267, 'recall': 0.770515497029067, 'f1-score': 0.4529833836858006, 'support': 6227}, '2': {'precision': 0.3461950696677385, 'recall': 0.045525017618040876, 'f1-score': 0.08046836073741903, 'support': 7095}, 'accuracy': 0.3332686617839647, 'macro avg': {'precision': 0.3457316632562379, 'recall': 0.351976950164526, 'f1-score': 0.2748615557992555, 'support': 20617}, 'weighted avg': {'precision': 0.3470193877496334, 'recall': 0.3332686617839647, 'f1-score': 0.2675202610827369, 'support': 20617}}
[[1750 5174  371]
 [1190 4798  239]
 [1787 4985  323]]
training model: results/LILAK/W4/deepVOL_L3/h500
Epoch 1/50
254/254 - 11s - loss: 3.3426 - accuracy500: 0.3520 - val_loss: 3.3717 - val_accuracy500: 0.3165 - 11s/epoch - 44ms/step
Epoch 2/50
254/254 - 9s - loss: 3.3135 - accuracy500: 0.3583 - val_loss: 3.3664 - val_accuracy500: 0.3043 - 9s/epoch - 35ms/step
Epoch 3/50
254/254 - 9s - loss: 3.2987 - accuracy500: 0.3653 - val_loss: 3.3600 - val_accuracy500: 0.2982 - 9s/epoch - 35ms/step
Epoch 4/50
254/254 - 9s - loss: 3.2829 - accuracy500: 0.3732 - val_loss: 3.3685 - val_accuracy500: 0.3019 - 9s/epoch - 34ms/step
Epoch 5/50
254/254 - 9s - loss: 3.2758 - accuracy500: 0.3753 - val_loss: 3.3765 - val_accuracy500: 0.3171 - 9s/epoch - 35ms/step
Epoch 6/50
254/254 - 9s - loss: 3.2710 - accuracy500: 0.3802 - val_loss: 3.3449 - val_accuracy500: 0.3278 - 9s/epoch - 35ms/step
Epoch 7/50
254/254 - 9s - loss: 3.2637 - accuracy500: 0.3863 - val_loss: 3.3833 - val_accuracy500: 0.3277 - 9s/epoch - 34ms/step
Epoch 8/50
254/254 - 9s - loss: 3.2603 - accuracy500: 0.3866 - val_loss: 3.4037 - val_accuracy500: 0.3215 - 9s/epoch - 35ms/step
Epoch 9/50
254/254 - 9s - loss: 3.2513 - accuracy500: 0.3927 - val_loss: 3.4149 - val_accuracy500: 0.3177 - 9s/epoch - 35ms/step
Epoch 10/50
254/254 - 9s - loss: 3.2434 - accuracy500: 0.3992 - val_loss: 3.4224 - val_accuracy500: 0.3183 - 9s/epoch - 37ms/step
Epoch 11/50
254/254 - 9s - loss: 3.2362 - accuracy500: 0.4040 - val_loss: 3.3892 - val_accuracy500: 0.3283 - 9s/epoch - 37ms/step
Epoch 12/50
254/254 - 9s - loss: 3.2321 - accuracy500: 0.4065 - val_loss: 3.4100 - val_accuracy500: 0.3108 - 9s/epoch - 34ms/step
Epoch 13/50
254/254 - 9s - loss: 3.2231 - accuracy500: 0.4118 - val_loss: 3.4048 - val_accuracy500: 0.3157 - 9s/epoch - 35ms/step
Epoch 14/50
254/254 - 9s - loss: 3.2154 - accuracy500: 0.4153 - val_loss: 3.4082 - val_accuracy500: 0.3188 - 9s/epoch - 35ms/step
Epoch 15/50
254/254 - 9s - loss: 3.2071 - accuracy500: 0.4197 - val_loss: 3.4081 - val_accuracy500: 0.3192 - 9s/epoch - 35ms/step
Epoch 16/50
254/254 - 9s - loss: 3.1994 - accuracy500: 0.4241 - val_loss: 3.4239 - val_accuracy500: 0.3193 - 9s/epoch - 35ms/step
testing model: results/LILAK/W4/deepVOL_L3/h500
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1131468
{'0': {'precision': 0.35844814470458963, 'recall': 0.4174015748031496, 'f1-score': 0.3856850529762176, 'support': 50800}, '1': {'precision': 0.29763325894015674, 'recall': 0.2749502553160885, 'f1-score': 0.28584246140042624, 'support': 41713}, '2': {'precision': 0.29449505966893363, 'recall': 0.25996239323984505, 'f1-score': 0.2761533463287849, 'support': 44141}, 'accuracy': 0.323064088866773, 'macro avg': {'precision': 0.31685882110456004, 'recall': 0.31743807445302774, 'f1-score': 0.31589362023514295, 'support': 136654}, 'weighted avg': {'precision': 0.31922701355255106, 'recall': 0.323064088866773, 'f1-score': 0.3198284144180685, 'support': 136654}}
[[21204 14189 15407]
 [18161 11469 12083]
 [19790 12876 11475]]
Evaluating performance on  train set...
254/254 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0927002
{'0': {'precision': 0.3686094295435465, 'recall': 0.38843360029800705, 'f1-score': 0.3782619538848709, 'support': 21476}, '1': {'precision': 0.3730431174318156, 'recall': 0.45579830383480824, 'f1-score': 0.41028938906752416, 'support': 21696}, '2': {'precision': 0.37756394023803497, 'recall': 0.27403050909759236, 'f1-score': 0.31757188498402555, 'support': 21764}, 'accuracy': 0.37259763459406187, 'macro avg': {'precision': 0.37307216240446567, 'recall': 0.37275413774346916, 'f1-score': 0.3687077426454735, 'support': 64936}, 'weighted avg': {'precision': 0.37309198564769114, 'recall': 0.37259763459406187, 'f1-score': 0.36862182474486915, 'support': 64936}}
[[8342 7964 5170]
 [7145 9889 4662]
 [7144 8656 5964]]
Evaluating performance on  val set...
81/81 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1146244
{'0': {'precision': 0.34444705329889647, 'recall': 0.38799259455170587, 'f1-score': 0.3649253731343284, 'support': 7562}, '1': {'precision': 0.2906114453616902, 'recall': 0.3667019774011299, 'f1-score': 0.3242525954258059, 'support': 5664}, '2': {'precision': 0.37176898222940225, 'recall': 0.24908672710052768, 'f1-score': 0.2983067325609657, 'support': 7391}, 'accuracy': 0.3323470922054615, 'macro avg': {'precision': 0.33560916029666304, 'recall': 0.33459376635112115, 'f1-score': 0.32916156704036664, 'support': 20617}, 'weighted avg': {'precision': 0.3394517335806558, 'recall': 0.3323470922054615, 'f1-score': 0.32986940061559167, 'support': 20617}}
[[2934 2798 1830]
 [2306 2077 1281]
 [3278 2272 1841]]
training model: results/LILAK/W4/deepVOL_L3/h1000
Epoch 1/50
254/254 - 11s - loss: 3.3454 - accuracy1000: 0.3600 - val_loss: 3.4119 - val_accuracy1000: 0.3015 - 11s/epoch - 45ms/step
Epoch 2/50
254/254 - 9s - loss: 3.3121 - accuracy1000: 0.3728 - val_loss: 3.4112 - val_accuracy1000: 0.2766 - 9s/epoch - 36ms/step
Epoch 3/50
254/254 - 9s - loss: 3.3079 - accuracy1000: 0.3689 - val_loss: 3.3920 - val_accuracy1000: 0.2792 - 9s/epoch - 36ms/step
Epoch 4/50
254/254 - 9s - loss: 3.2936 - accuracy1000: 0.3707 - val_loss: 3.3586 - val_accuracy1000: 0.2901 - 9s/epoch - 37ms/step
Epoch 5/50
254/254 - 9s - loss: 3.2966 - accuracy1000: 0.3664 - val_loss: 3.3502 - val_accuracy1000: 0.2849 - 9s/epoch - 36ms/step
Epoch 6/50
254/254 - 9s - loss: 3.2889 - accuracy1000: 0.3718 - val_loss: 3.3393 - val_accuracy1000: 0.3077 - 9s/epoch - 36ms/step
Epoch 7/50
254/254 - 9s - loss: 3.2949 - accuracy1000: 0.3596 - val_loss: 3.3112 - val_accuracy1000: 0.3297 - 9s/epoch - 35ms/step
Epoch 8/50
254/254 - 9s - loss: 3.2799 - accuracy1000: 0.3792 - val_loss: 3.3566 - val_accuracy1000: 0.3049 - 9s/epoch - 35ms/step
Epoch 9/50
254/254 - 9s - loss: 3.2837 - accuracy1000: 0.3678 - val_loss: 3.3289 - val_accuracy1000: 0.3239 - 9s/epoch - 36ms/step
Epoch 10/50
254/254 - 9s - loss: 3.2751 - accuracy1000: 0.3803 - val_loss: 3.3302 - val_accuracy1000: 0.3340 - 9s/epoch - 37ms/step
Epoch 11/50
254/254 - 9s - loss: 3.2740 - accuracy1000: 0.3797 - val_loss: 3.3381 - val_accuracy1000: 0.3281 - 9s/epoch - 36ms/step
Epoch 12/50
254/254 - 9s - loss: 3.2680 - accuracy1000: 0.3839 - val_loss: 3.3378 - val_accuracy1000: 0.3315 - 9s/epoch - 35ms/step
Epoch 13/50
254/254 - 9s - loss: 3.2559 - accuracy1000: 0.3938 - val_loss: 3.3540 - val_accuracy1000: 0.3319 - 9s/epoch - 36ms/step
Epoch 14/50
254/254 - 9s - loss: 3.2497 - accuracy1000: 0.3980 - val_loss: 3.3498 - val_accuracy1000: 0.3386 - 9s/epoch - 35ms/step
Epoch 15/50
254/254 - 9s - loss: 3.2471 - accuracy1000: 0.3992 - val_loss: 3.3382 - val_accuracy1000: 0.3346 - 9s/epoch - 36ms/step
Epoch 16/50
254/254 - 9s - loss: 3.2408 - accuracy1000: 0.4007 - val_loss: 3.3553 - val_accuracy1000: 0.3346 - 9s/epoch - 36ms/step
Epoch 17/50
254/254 - 9s - loss: 3.2333 - accuracy1000: 0.4067 - val_loss: 3.3507 - val_accuracy1000: 0.3372 - 9s/epoch - 35ms/step
testing model: results/LILAK/W4/deepVOL_L3/h1000
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0939624
{'0': {'precision': 0.4111673073032571, 'recall': 0.7354308769517468, 'f1-score': 0.5274474310813528, 'support': 55271}, '1': {'precision': 0.28082978025582156, 'recall': 0.08948399738732854, 'f1-score': 0.13572150343761763, 'support': 38275}, '2': {'precision': 0.34518321743886243, 'recall': 0.2049735547926139, 'f1-score': 0.25721188833580766, 'support': 43108}, 'accuracy': 0.38717490889399503, 'macro avg': {'precision': 0.34572676833264704, 'recall': 0.3432961430438964, 'f1-score': 0.30679360761825936, 'support': 136654}, 'weighted avg': {'precision': 0.3538465483528062, 'recall': 0.38717490889399503, 'f1-score': 0.33248333447796813, 'support': 136654}}
[[40648  4473 10150]
 [28238  3425  6612]
 [29974  4298  8836]]
Evaluating performance on  train set...
254/254 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0958624
{'0': {'precision': 0.35774282654039125, 'recall': 0.594306049822064, 'f1-score': 0.44663405707850934, 'support': 21356}, '1': {'precision': 0.36279471670164176, 'recall': 0.13724666106285607, 'f1-score': 0.19915297306454344, 'support': 21414}, '2': {'precision': 0.3645174884112937, 'recall': 0.35121357033294237, 'f1-score': 0.35774188360177384, 'support': 22166}, 'accuracy': 0.36060120734261425, 'macro avg': {'precision': 0.3616850105511089, 'recall': 0.36092209373928746, 'f1-score': 0.3345096379149422, 'support': 64936}, 'weighted avg': {'precision': 0.3617213335464194, 'recall': 0.36060120734261425, 'f1-score': 0.33467853394249253, 'support': 64936}}
[[12692  2536  6128]
 [11031  2939  7444]
 [11755  2626  7785]]
Evaluating performance on  val set...
81/81 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.104772
{'0': {'precision': 0.33445790522925933, 'recall': 0.5868424593031077, 'f1-score': 0.42608058608058613, 'support': 7433}, '1': {'precision': 0.2904739558892539, 'recall': 0.11209706628033321, 'f1-score': 0.16176662746635304, 'support': 5522}, '2': {'precision': 0.3453343130051433, 'recall': 0.2453667449752023, 'f1-score': 0.28689150007630093, 'support': 7662}, 'accuracy': 0.33278362516369986, 'macro avg': {'precision': 0.3234220580412189, 'recall': 0.3147687568528811, 'f1-score': 0.2915795712077467, 'support': 20617}, 'weighted avg': {'precision': 0.3267194208776715, 'recall': 0.33278362516369986, 'f1-score': 0.30355992563373996, 'support': 20617}}
[[4362  807 2264]
 [3603  619 1300]
 [5077  705 1880]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        14 (peak)  10.69 (ave)

============================================
