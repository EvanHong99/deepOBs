This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/CHTR_orderbooks/CHTR_orderbooks_2019-10-09.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-10-01.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-09-18.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-09-19.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-09-27.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-09-23.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-09-25.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-09-20.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-10-11.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-09-24.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-10-07.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-09-26.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-09-17.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-10-03.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-10-02.csv
training model: results/CHTR/W7/deepLOB_L1/h10
Epoch 1/50
401/401 - 36s - loss: 3.3191 - accuracy10: 0.3667 - val_loss: 3.3624 - val_accuracy10: 0.3670 - 36s/epoch - 90ms/step
Epoch 2/50
401/401 - 10s - loss: 3.2811 - accuracy10: 0.3792 - val_loss: 3.3464 - val_accuracy10: 0.3750 - 10s/epoch - 24ms/step
Epoch 3/50
401/401 - 10s - loss: 3.2621 - accuracy10: 0.3887 - val_loss: 3.3327 - val_accuracy10: 0.3710 - 10s/epoch - 24ms/step
Epoch 4/50
401/401 - 10s - loss: 3.2488 - accuracy10: 0.3968 - val_loss: 3.3131 - val_accuracy10: 0.3744 - 10s/epoch - 24ms/step
Epoch 5/50
401/401 - 10s - loss: 3.2428 - accuracy10: 0.3979 - val_loss: 3.3079 - val_accuracy10: 0.3733 - 10s/epoch - 24ms/step
Epoch 6/50
401/401 - 10s - loss: 3.2318 - accuracy10: 0.4025 - val_loss: 3.2925 - val_accuracy10: 0.3828 - 10s/epoch - 24ms/step
Epoch 7/50
401/401 - 10s - loss: 3.2263 - accuracy10: 0.4057 - val_loss: 3.3007 - val_accuracy10: 0.3789 - 10s/epoch - 24ms/step
Epoch 8/50
401/401 - 10s - loss: 3.2202 - accuracy10: 0.4087 - val_loss: 3.3074 - val_accuracy10: 0.3736 - 10s/epoch - 24ms/step
Epoch 9/50
401/401 - 9s - loss: 3.2114 - accuracy10: 0.4141 - val_loss: 3.3177 - val_accuracy10: 0.3762 - 9s/epoch - 23ms/step
Epoch 10/50
401/401 - 10s - loss: 3.2067 - accuracy10: 0.4138 - val_loss: 3.3100 - val_accuracy10: 0.3754 - 10s/epoch - 24ms/step
Epoch 11/50
401/401 - 10s - loss: 3.1993 - accuracy10: 0.4179 - val_loss: 3.3130 - val_accuracy10: 0.3772 - 10s/epoch - 24ms/step
Epoch 12/50
401/401 - 9s - loss: 3.1961 - accuracy10: 0.4207 - val_loss: 3.3129 - val_accuracy10: 0.3746 - 9s/epoch - 24ms/step
Epoch 13/50
401/401 - 9s - loss: 3.1910 - accuracy10: 0.4217 - val_loss: 3.3205 - val_accuracy10: 0.3756 - 9s/epoch - 24ms/step
Epoch 14/50
401/401 - 10s - loss: 3.1876 - accuracy10: 0.4228 - val_loss: 3.3195 - val_accuracy10: 0.3742 - 10s/epoch - 24ms/step
Epoch 15/50
401/401 - 10s - loss: 3.1856 - accuracy10: 0.4242 - val_loss: 3.3337 - val_accuracy10: 0.3706 - 10s/epoch - 24ms/step
Epoch 16/50
401/401 - 9s - loss: 3.1793 - accuracy10: 0.4269 - val_loss: 3.3167 - val_accuracy10: 0.3784 - 9s/epoch - 24ms/step
testing model: results/CHTR/W7/deepLOB_L1/h10
Evaluating performance on  test set...
1065/1065 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1259491
{'0': {'precision': 0.35257901627080607, 'recall': 0.5344377919898399, 'f1-score': 0.4248657955585203, 'support': 88188}, '1': {'precision': 0.371674966597838, 'recall': 0.06340983266849712, 'f1-score': 0.10833679999291915, 'support': 96515}, '2': {'precision': 0.3561898065634351, 'recall': 0.49647871273589206, 'f1-score': 0.41479344586939343, 'support': 87752}, 'accuracy': 0.3553540951716797, 'macro avg': {'precision': 0.36014792981069305, 'recall': 0.36477544579807636, 'f1-score': 0.31599868047361096, 'support': 272455}, 'weighted avg': {'precision': 0.3605065628952845, 'recall': 0.3553540951716797, 'f1-score': 0.309493844825613, 'support': 272455}}
[[47131  5468 35589]
 [47237  6120 43158]
 [39307  4878 43567]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0886122
{'0': {'precision': 0.39354933850172746, 'recall': 0.5280549509568364, 'f1-score': 0.45098678254571795, 'support': 35377}, '1': {'precision': 0.4282883874518437, 'recall': 0.1147787610619469, 'f1-score': 0.1810398976387112, 'support': 33900}, '2': {'precision': 0.3858156644024393, 'recall': 0.5329935541897767, 'f1-score': 0.44761688949316414, 'support': 33355}, 'accuracy': 0.3931522332216073, 'macro avg': {'precision': 0.40255113011867016, 'recall': 0.39194242206952, 'f1-score': 0.35988118989253115, 'support': 102632}, 'weighted avg': {'precision': 0.4025104525775243, 'recall': 0.3931522332216073, 'f1-score': 0.36072641364405517, 'support': 102632}}
[[18681  2616 14080]
 [15788  3891 14221]
 [12999  2578 17778]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0948384
{'0': {'precision': 0.3714911407525383, 'recall': 0.5576252614802271, 'f1-score': 0.4459136530189581, 'support': 10039}, '1': {'precision': 0.4309192200557103, 'recall': 0.14332036316472113, 'f1-score': 0.2151001112347052, 'support': 10794}, '2': {'precision': 0.3871246659330294, 'recall': 0.4669131588926811, 'f1-score': 0.42329179200687583, 'support': 10548}, 'accuracy': 0.3846276409292247, 'macro avg': {'precision': 0.39651167558042605, 'recall': 0.3892862611792098, 'f1-score': 0.36143518542017966, 'support': 31381}, 'weighted avg': {'precision': 0.397187234299661, 'recall': 0.3846276409292247, 'f1-score': 0.3589178033017831, 'support': 31381}}
[[5598 1026 3415]
 [4865 1547 4382]
 [4606 1017 4925]]
training model: results/CHTR/W7/deepLOB_L1/h20
Epoch 1/50
401/401 - 12s - loss: 3.3178 - accuracy20: 0.3650 - val_loss: 3.3467 - val_accuracy20: 0.3562 - 12s/epoch - 31ms/step
Epoch 2/50
401/401 - 10s - loss: 3.2820 - accuracy20: 0.3799 - val_loss: 3.3273 - val_accuracy20: 0.3758 - 10s/epoch - 26ms/step
Epoch 3/50
401/401 - 10s - loss: 3.2698 - accuracy20: 0.3857 - val_loss: 3.3077 - val_accuracy20: 0.3758 - 10s/epoch - 25ms/step
Epoch 4/50
401/401 - 10s - loss: 3.2553 - accuracy20: 0.3918 - val_loss: 3.2868 - val_accuracy20: 0.3918 - 10s/epoch - 26ms/step
Epoch 5/50
401/401 - 10s - loss: 3.2404 - accuracy20: 0.3973 - val_loss: 3.2765 - val_accuracy20: 0.3910 - 10s/epoch - 24ms/step
Epoch 6/50
401/401 - 10s - loss: 3.2312 - accuracy20: 0.4015 - val_loss: 3.2986 - val_accuracy20: 0.3940 - 10s/epoch - 24ms/step
Epoch 7/50
401/401 - 9s - loss: 3.2261 - accuracy20: 0.4028 - val_loss: 3.2859 - val_accuracy20: 0.3878 - 9s/epoch - 23ms/step
Epoch 8/50
401/401 - 10s - loss: 3.2189 - accuracy20: 0.4076 - val_loss: 3.2813 - val_accuracy20: 0.3915 - 10s/epoch - 24ms/step
Epoch 9/50
401/401 - 10s - loss: 3.2147 - accuracy20: 0.4088 - val_loss: 3.2796 - val_accuracy20: 0.3930 - 10s/epoch - 24ms/step
Epoch 10/50
401/401 - 9s - loss: 3.2111 - accuracy20: 0.4101 - val_loss: 3.2785 - val_accuracy20: 0.3926 - 9s/epoch - 23ms/step
Epoch 11/50
401/401 - 10s - loss: 3.2063 - accuracy20: 0.4121 - val_loss: 3.2724 - val_accuracy20: 0.3924 - 10s/epoch - 24ms/step
Epoch 12/50
401/401 - 9s - loss: 3.2031 - accuracy20: 0.4150 - val_loss: 3.2699 - val_accuracy20: 0.3918 - 9s/epoch - 24ms/step
Epoch 13/50
401/401 - 10s - loss: 3.2002 - accuracy20: 0.4158 - val_loss: 3.2725 - val_accuracy20: 0.3940 - 10s/epoch - 24ms/step
Epoch 14/50
401/401 - 9s - loss: 3.1955 - accuracy20: 0.4179 - val_loss: 3.2709 - val_accuracy20: 0.3941 - 9s/epoch - 23ms/step
Epoch 15/50
401/401 - 9s - loss: 3.1930 - accuracy20: 0.4185 - val_loss: 3.2758 - val_accuracy20: 0.3966 - 9s/epoch - 23ms/step
Epoch 16/50
401/401 - 10s - loss: 3.1905 - accuracy20: 0.4190 - val_loss: 3.2796 - val_accuracy20: 0.3933 - 10s/epoch - 24ms/step
Epoch 17/50
401/401 - 9s - loss: 3.1870 - accuracy20: 0.4221 - val_loss: 3.2758 - val_accuracy20: 0.3925 - 9s/epoch - 24ms/step
Epoch 18/50
401/401 - 9s - loss: 3.1842 - accuracy20: 0.4231 - val_loss: 3.2859 - val_accuracy20: 0.3946 - 9s/epoch - 23ms/step
Epoch 19/50
401/401 - 10s - loss: 3.1815 - accuracy20: 0.4230 - val_loss: 3.2802 - val_accuracy20: 0.3928 - 10s/epoch - 24ms/step
Epoch 20/50
401/401 - 9s - loss: 3.1788 - accuracy20: 0.4251 - val_loss: 3.2839 - val_accuracy20: 0.3893 - 9s/epoch - 24ms/step
Epoch 21/50
401/401 - 10s - loss: 3.1777 - accuracy20: 0.4246 - val_loss: 3.2896 - val_accuracy20: 0.3908 - 10s/epoch - 24ms/step
Epoch 22/50
401/401 - 10s - loss: 3.1751 - accuracy20: 0.4267 - val_loss: 3.2878 - val_accuracy20: 0.3892 - 10s/epoch - 24ms/step
testing model: results/CHTR/W7/deepLOB_L1/h20
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0949367
{'0': {'precision': 0.36922778424524644, 'recall': 0.2627424810732448, 'f1-score': 0.3070138879552574, 'support': 86914}, '1': {'precision': 0.36348023625624715, 'recall': 0.4129092860976919, 'f1-score': 0.386621304234364, 'support': 96876}, '2': {'precision': 0.3878198434718617, 'recall': 0.4398353352506626, 'f1-score': 0.4121930853706228, 'support': 88665}, 'accuracy': 0.3737681451982896, 'macro avg': {'precision': 0.3735092879911184, 'recall': 0.3718290341405331, 'f1-score': 0.3686094258534148, 'support': 272455}, 'weighted avg': {'precision': 0.37323455773938513, 'recall': 0.3737681451982896, 'f1-score': 0.3695481104811355, 'support': 272455}}
[[22836 37357 26721]
 [22037 40001 34838]
 [16975 32692 38998]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0781262
{'0': {'precision': 0.41551684562217855, 'recall': 0.4587486624992961, 'f1-score': 0.4360638625322859, 'support': 35514}, '1': {'precision': 0.4366411109503833, 'recall': 0.1779041669122414, 'f1-score': 0.25280569514237855, 'support': 33934}, '2': {'precision': 0.3845998749924391, 'recall': 0.5748252169720347, 'f1-score': 0.4608545439170824, 'support': 33184}, 'accuracy': 0.40342193467924237, 'macro avg': {'precision': 0.412252610521667, 'recall': 0.40382601546119073, 'f1-score': 0.38324136719724894, 'support': 102632}, 'weighted avg': {'precision': 0.41250493965006485, 'recall': 0.40342193467924237, 'f1-score': 0.3834873885170078, 'support': 102632}}
[[16292  3984 15238]
 [12613  6037 15284]
 [10304  3805 19075]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0897515
{'0': {'precision': 0.38827772768259694, 'recall': 0.4249481890851673, 'f1-score': 0.4057861753757716, 'support': 10133}, '1': {'precision': 0.3803236797274276, 'recall': 0.2547062179121506, 'f1-score': 0.30509053638537753, 'support': 10518}, '2': {'precision': 0.3990337434890919, 'recall': 0.49263746505125816, 'f1-score': 0.44092255077782877, 'support': 10730}, 'accuracy': 0.39103279054204776, 'macro avg': {'precision': 0.3892117169663721, 'recall': 0.39076395734952535, 'f1-score': 0.38393308751299265, 'support': 31381}, 'weighted avg': {'precision': 0.3892895301494151, 'recall': 0.39103279054204776, 'f1-score': 0.38404998395940854, 'support': 31381}}
[[4306 2158 3669]
 [3547 2679 4292]
 [3237 2207 5286]]
training model: results/CHTR/W7/deepLOB_L1/h30
Epoch 1/50
401/401 - 12s - loss: 3.3194 - accuracy30: 0.3644 - val_loss: 3.3264 - val_accuracy30: 0.3683 - 12s/epoch - 31ms/step
Epoch 2/50
401/401 - 10s - loss: 3.2859 - accuracy30: 0.3759 - val_loss: 3.3221 - val_accuracy30: 0.3630 - 10s/epoch - 25ms/step
Epoch 3/50
401/401 - 10s - loss: 3.2807 - accuracy30: 0.3765 - val_loss: 3.3036 - val_accuracy30: 0.3689 - 10s/epoch - 24ms/step
Epoch 4/50
401/401 - 10s - loss: 3.2721 - accuracy30: 0.3822 - val_loss: 3.2846 - val_accuracy30: 0.3802 - 10s/epoch - 24ms/step
Epoch 5/50
401/401 - 10s - loss: 3.2642 - accuracy30: 0.3871 - val_loss: 3.2903 - val_accuracy30: 0.3782 - 10s/epoch - 25ms/step
Epoch 6/50
401/401 - 10s - loss: 3.2569 - accuracy30: 0.3890 - val_loss: 3.2912 - val_accuracy30: 0.3797 - 10s/epoch - 24ms/step
Epoch 7/50
401/401 - 10s - loss: 3.2450 - accuracy30: 0.3955 - val_loss: 3.2898 - val_accuracy30: 0.3861 - 10s/epoch - 24ms/step
Epoch 8/50
401/401 - 9s - loss: 3.2338 - accuracy30: 0.4006 - val_loss: 3.2941 - val_accuracy30: 0.3858 - 9s/epoch - 24ms/step
Epoch 9/50
401/401 - 9s - loss: 3.2291 - accuracy30: 0.4020 - val_loss: 3.3099 - val_accuracy30: 0.3740 - 9s/epoch - 24ms/step
Epoch 10/50
401/401 - 10s - loss: 3.2223 - accuracy30: 0.4056 - val_loss: 3.3123 - val_accuracy30: 0.3768 - 10s/epoch - 24ms/step
Epoch 11/50
401/401 - 10s - loss: 3.2154 - accuracy30: 0.4073 - val_loss: 3.3112 - val_accuracy30: 0.3805 - 10s/epoch - 24ms/step
Epoch 12/50
401/401 - 10s - loss: 3.2120 - accuracy30: 0.4074 - val_loss: 3.3261 - val_accuracy30: 0.3773 - 10s/epoch - 24ms/step
Epoch 13/50
401/401 - 10s - loss: 3.2074 - accuracy30: 0.4089 - val_loss: 3.3191 - val_accuracy30: 0.3782 - 10s/epoch - 24ms/step
Epoch 14/50
401/401 - 9s - loss: 3.2058 - accuracy30: 0.4123 - val_loss: 3.3361 - val_accuracy30: 0.3812 - 9s/epoch - 23ms/step
testing model: results/CHTR/W7/deepLOB_L1/h30
Evaluating performance on  test set...
1065/1065 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0985253
{'0': {'precision': 0.3507319237024989, 'recall': 0.3299141138426232, 'f1-score': 0.3400046585798499, 'support': 86277}, '1': {'precision': 0.3470824949698189, 'recall': 0.32234622372177524, 'f1-score': 0.334257340474204, 'support': 96325}, '2': {'precision': 0.3605396753699467, 'recall': 0.40863410236719977, 'f1-score': 0.38308327942741477, 'support': 89853}, 'accuracy': 0.3531996109449267, 'macro avg': {'precision': 0.35278469801408824, 'recall': 0.3536314799771994, 'f1-score': 0.3524484261604896, 'support': 272455}, 'weighted avg': {'precision': 0.35267618858257005, 'recall': 0.3531996109449267, 'f1-score': 0.35217963390601353, 'support': 272455}}
[[28464 28474 29339]
 [29492 31050 35783]
 [23200 29936 36717]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0950077
{'0': {'precision': 0.3881876512043757, 'recall': 0.41671136203246295, 'f1-score': 0.4019441003090411, 'support': 35425}, '1': {'precision': 0.3839889579020014, 'recall': 0.16310975609756098, 'f1-score': 0.22896177112053004, 'support': 34112}, '2': {'precision': 0.3632717404318155, 'recall': 0.5500830941229793, 'f1-score': 0.43757285870518814, 'support': 33095}, 'accuracy': 0.37542871618988227, 'macro avg': {'precision': 0.37848278317939754, 'recall': 0.37663473741766773, 'f1-score': 0.3561595767115864, 'support': 102632}, 'weighted avg': {'precision': 0.37875766939608513, 'recall': 0.37542871618988227, 'f1-score': 0.35593857129121037, 'support': 102632}}
[[14762  4567 16096]
 [12735  5564 15813]
 [10531  4359 18205]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0938292
{'0': {'precision': 0.3671509281678773, 'recall': 0.44932832872382455, 'f1-score': 0.4041041129963578, 'support': 10124}, '1': {'precision': 0.3793299261783078, 'recall': 0.2549618320610687, 'f1-score': 0.30495320703035833, 'support': 10480}, '2': {'precision': 0.3852850087888173, 'recall': 0.42711329683585414, 'f1-score': 0.4051223376166168, 'support': 10777}, 'accuracy': 0.3767885025971129, 'macro avg': {'precision': 0.3772552877116675, 'recall': 0.3771344858735825, 'f1-score': 0.3713932192144443, 'support': 31381}, 'weighted avg': {'precision': 0.3774459119479093, 'recall': 0.3767885025971129, 'f1-score': 0.37134135566577103, 'support': 31381}}
[[4549 2130 3445]
 [3909 2672 3899]
 [3932 2242 4603]]
training model: results/CHTR/W7/deepLOB_L1/h50
Epoch 1/50
401/401 - 12s - loss: 3.3242 - accuracy50: 0.3600 - val_loss: 3.3507 - val_accuracy50: 0.3628 - 12s/epoch - 30ms/step
Epoch 2/50
401/401 - 10s - loss: 3.2959 - accuracy50: 0.3660 - val_loss: 3.3487 - val_accuracy50: 0.3583 - 10s/epoch - 25ms/step
Epoch 3/50
401/401 - 10s - loss: 3.2834 - accuracy50: 0.3710 - val_loss: 3.3367 - val_accuracy50: 0.3607 - 10s/epoch - 24ms/step
Epoch 4/50
401/401 - 10s - loss: 3.2758 - accuracy50: 0.3792 - val_loss: 3.3244 - val_accuracy50: 0.3586 - 10s/epoch - 24ms/step
Epoch 5/50
401/401 - 10s - loss: 3.2688 - accuracy50: 0.3798 - val_loss: 3.3234 - val_accuracy50: 0.3585 - 10s/epoch - 24ms/step
Epoch 6/50
401/401 - 10s - loss: 3.2567 - accuracy50: 0.3868 - val_loss: 3.3314 - val_accuracy50: 0.3560 - 10s/epoch - 24ms/step
Epoch 7/50
401/401 - 9s - loss: 3.2437 - accuracy50: 0.3889 - val_loss: 3.3261 - val_accuracy50: 0.3612 - 9s/epoch - 23ms/step
Epoch 8/50
401/401 - 10s - loss: 3.2375 - accuracy50: 0.3932 - val_loss: 3.3154 - val_accuracy50: 0.3654 - 10s/epoch - 24ms/step
Epoch 9/50
401/401 - 9s - loss: 3.2306 - accuracy50: 0.3958 - val_loss: 3.3201 - val_accuracy50: 0.3645 - 9s/epoch - 24ms/step
Epoch 10/50
401/401 - 9s - loss: 3.2253 - accuracy50: 0.3974 - val_loss: 3.3203 - val_accuracy50: 0.3665 - 9s/epoch - 24ms/step
Epoch 11/50
401/401 - 10s - loss: 3.2228 - accuracy50: 0.3994 - val_loss: 3.3151 - val_accuracy50: 0.3682 - 10s/epoch - 24ms/step
Epoch 12/50
401/401 - 10s - loss: 3.2188 - accuracy50: 0.4014 - val_loss: 3.3138 - val_accuracy50: 0.3603 - 10s/epoch - 24ms/step
Epoch 13/50
401/401 - 10s - loss: 3.2160 - accuracy50: 0.4023 - val_loss: 3.3104 - val_accuracy50: 0.3644 - 10s/epoch - 24ms/step
Epoch 14/50
401/401 - 10s - loss: 3.2118 - accuracy50: 0.4049 - val_loss: 3.3193 - val_accuracy50: 0.3687 - 10s/epoch - 24ms/step
Epoch 15/50
401/401 - 10s - loss: 3.2093 - accuracy50: 0.4054 - val_loss: 3.3284 - val_accuracy50: 0.3656 - 10s/epoch - 24ms/step
Epoch 16/50
401/401 - 10s - loss: 3.2054 - accuracy50: 0.4094 - val_loss: 3.3223 - val_accuracy50: 0.3681 - 10s/epoch - 24ms/step
Epoch 17/50
401/401 - 10s - loss: 3.2024 - accuracy50: 0.4099 - val_loss: 3.3393 - val_accuracy50: 0.3624 - 10s/epoch - 24ms/step
Epoch 18/50
401/401 - 10s - loss: 3.1989 - accuracy50: 0.4134 - val_loss: 3.3432 - val_accuracy50: 0.3615 - 10s/epoch - 24ms/step
Epoch 19/50
401/401 - 10s - loss: 3.1955 - accuracy50: 0.4138 - val_loss: 3.3403 - val_accuracy50: 0.3620 - 10s/epoch - 24ms/step
Epoch 20/50
401/401 - 10s - loss: 3.1938 - accuracy50: 0.4148 - val_loss: 3.3375 - val_accuracy50: 0.3662 - 10s/epoch - 24ms/step
Epoch 21/50
401/401 - 10s - loss: 3.1906 - accuracy50: 0.4156 - val_loss: 3.3398 - val_accuracy50: 0.3636 - 10s/epoch - 24ms/step
Epoch 22/50
401/401 - 10s - loss: 3.1882 - accuracy50: 0.4166 - val_loss: 3.3454 - val_accuracy50: 0.3579 - 10s/epoch - 24ms/step
Epoch 23/50
401/401 - 10s - loss: 3.1854 - accuracy50: 0.4184 - val_loss: 3.3497 - val_accuracy50: 0.3624 - 10s/epoch - 24ms/step
testing model: results/CHTR/W7/deepLOB_L1/h50
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1129403
{'0': {'precision': 0.3319373282839534, 'recall': 0.26164778048323656, 'f1-score': 0.29263087608586075, 'support': 85424}, '1': {'precision': 0.3413496977738464, 'recall': 0.583309715005511, 'f1-score': 0.4306722933305433, 'support': 95265}, '2': {'precision': 0.3565252315252315, 'recall': 0.1644508859490443, 'f1-score': 0.22508091338911507, 'support': 91766}, 'accuracy': 0.34138114551026777, 'macro avg': {'precision': 0.3432707525276771, 'recall': 0.33646946047926396, 'f1-score': 0.3161280276018397, 'support': 272455}, 'weighted avg': {'precision': 0.3435098922240308, 'recall': 0.34138114551026777, 'f1-score': 0.3181460097298941, 'support': 272455}}
[[22351 51347 11726]
 [24185 55569 15511]
 [20799 55876 15091]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0963109
{'0': {'precision': 0.3993417443773999, 'recall': 0.2662615349988746, 'f1-score': 0.3194976621710582, 'support': 35544}, '1': {'precision': 0.3626301441849772, 'recall': 0.3247066435314531, 'f1-score': 0.342622187742436, 'support': 34003}, '2': {'precision': 0.3561646660891804, 'recall': 0.5219585915067251, 'f1-score': 0.42341028061443403, 'support': 33085}, 'accuracy': 0.36805284901395274, 'macro avg': {'precision': 0.37271218488385244, 'recall': 0.370975590012351, 'f1-score': 0.3618433768426427, 'support': 102632}, 'weighted avg': {'precision': 0.37326003324920703, 'recall': 0.36805284901395274, 'f1-score': 0.3606568739588305, 'support': 102632}}
[[ 9464 10250 15830]
 [ 7575 11041 15387]
 [ 6660  9156 17269]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1011748
{'0': {'precision': 0.35642488454224397, 'recall': 0.3953792064289302, 'f1-score': 0.37489284693780367, 'support': 9955}, '1': {'precision': 0.35515223643756816, 'recall': 0.336180998873451, 'f1-score': 0.34540631782011094, 'support': 10652}, '2': {'precision': 0.3902486591906387, 'recall': 0.37144978652311117, 'f1-score': 0.3806172428551049, 'support': 10774}, 'accuracy': 0.36706924572193367, 'macro avg': {'precision': 0.36727526005681693, 'recall': 0.3676699972751641, 'f1-score': 0.3669721358710065, 'support': 31381}, 'weighted avg': {'precision': 0.3676055703218813, 'recall': 0.36706924572193367, 'f1-score': 0.36684925793335327, 'support': 31381}}
[[3936 3173 2846]
 [3664 3581 3407]
 [3443 3329 4002]]
training model: results/CHTR/W7/deepLOB_L1/h100
Epoch 1/50
401/401 - 12s - loss: 3.3312 - accuracy100: 0.3544 - val_loss: 3.3646 - val_accuracy100: 0.3458 - 12s/epoch - 30ms/step
Epoch 2/50
401/401 - 10s - loss: 3.2997 - accuracy100: 0.3629 - val_loss: 3.3510 - val_accuracy100: 0.3476 - 10s/epoch - 25ms/step
Epoch 3/50
401/401 - 9s - loss: 3.2869 - accuracy100: 0.3702 - val_loss: 3.3664 - val_accuracy100: 0.3515 - 9s/epoch - 24ms/step
Epoch 4/50
401/401 - 9s - loss: 3.2787 - accuracy100: 0.3728 - val_loss: 3.3405 - val_accuracy100: 0.3491 - 9s/epoch - 23ms/step
Epoch 5/50
401/401 - 10s - loss: 3.2738 - accuracy100: 0.3764 - val_loss: 3.3269 - val_accuracy100: 0.3495 - 10s/epoch - 25ms/step
Epoch 6/50
401/401 - 10s - loss: 3.2596 - accuracy100: 0.3817 - val_loss: 3.3746 - val_accuracy100: 0.3495 - 10s/epoch - 24ms/step
Epoch 7/50
401/401 - 10s - loss: 3.2551 - accuracy100: 0.3838 - val_loss: 3.3510 - val_accuracy100: 0.3544 - 10s/epoch - 24ms/step
Epoch 8/50
401/401 - 10s - loss: 3.2463 - accuracy100: 0.3879 - val_loss: 3.3504 - val_accuracy100: 0.3515 - 10s/epoch - 24ms/step
Epoch 9/50
401/401 - 9s - loss: 3.2404 - accuracy100: 0.3895 - val_loss: 3.3870 - val_accuracy100: 0.3527 - 9s/epoch - 23ms/step
Epoch 10/50
401/401 - 9s - loss: 3.2349 - accuracy100: 0.3952 - val_loss: 3.3560 - val_accuracy100: 0.3538 - 9s/epoch - 23ms/step
Epoch 11/50
401/401 - 9s - loss: 3.2292 - accuracy100: 0.3978 - val_loss: 3.3851 - val_accuracy100: 0.3501 - 9s/epoch - 24ms/step
Epoch 12/50
401/401 - 9s - loss: 3.2253 - accuracy100: 0.3980 - val_loss: 3.3636 - val_accuracy100: 0.3505 - 9s/epoch - 24ms/step
Epoch 13/50
401/401 - 9s - loss: 3.2206 - accuracy100: 0.4001 - val_loss: 3.3542 - val_accuracy100: 0.3470 - 9s/epoch - 24ms/step
Epoch 14/50
401/401 - 9s - loss: 3.2183 - accuracy100: 0.4020 - val_loss: 3.3582 - val_accuracy100: 0.3426 - 9s/epoch - 24ms/step
Epoch 15/50
401/401 - 10s - loss: 3.2134 - accuracy100: 0.4032 - val_loss: 3.3687 - val_accuracy100: 0.3377 - 10s/epoch - 24ms/step
testing model: results/CHTR/W7/deepLOB_L1/h100
Evaluating performance on  test set...
1065/1065 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1214684
{'0': {'precision': 0.31417419256084494, 'recall': 0.09679435032245133, 'f1-score': 0.14799325828518897, 'support': 84819}, '1': {'precision': 0.3432556839521701, 'recall': 0.8368611584327087, 'f1-score': 0.4868286579662928, 'support': 93920}, '2': {'precision': 0.340213317959066, 'recall': 0.0629668359725127, 'f1-score': 0.10626592593259561, 'support': 93716}, 'accuracy': 0.3402727055844084, 'macro avg': {'precision': 0.3325477314906937, 'recall': 0.3322074482425576, 'f1-score': 0.2470292807280258, 'support': 272455}, 'weighted avg': {'precision': 0.33315573574152774, 'recall': 0.3402727055844084, 'f1-score': 0.2504428446730095, 'support': 272455}}
[[ 8210 71123  5486]
 [ 9364 78598  5958]
 [ 8558 79257  5901]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1060724
{'0': {'precision': 0.3814854299928927, 'recall': 0.24094492607244059, 'f1-score': 0.2953486372624882, 'support': 35643}, '1': {'precision': 0.3488987518493051, 'recall': 0.49573661771672195, 'f1-score': 0.40955397654310416, 'support': 33776}, '2': {'precision': 0.3414360857792026, 'recall': 0.33029235540300483, 'f1-score': 0.33577178537540936, 'support': 33213}, 'accuracy': 0.3537103437524359, 'macro avg': {'precision': 0.3572734225404668, 'recall': 0.3556579663973891, 'f1-score': 0.34689146639366725, 'support': 102632}, 'weighted avg': {'precision': 0.35780074577795873, 'recall': 0.3537103437524359, 'f1-score': 0.34601483842602915, 'support': 102632}}
[[ 8588 16009 11046]
 [ 6919 16744 10113]
 [ 7005 15238 10970]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1071
{'0': {'precision': 0.3470579646663747, 'recall': 0.2437948717948718, 'f1-score': 0.28640279534911744, 'support': 9750}, '1': {'precision': 0.3462176225055749, 'recall': 0.5702580523639104, 'f1-score': 0.43085352403315896, 'support': 10618}, '2': {'precision': 0.36390742581286384, 'recall': 0.23272496140924362, 'f1-score': 0.28389455028799293, 'support': 11013}, 'accuracy': 0.35037124374621587, 'macro avg': {'precision': 0.3523943376616045, 'recall': 0.3489259618560086, 'f1-score': 0.33371695655675643, 'support': 31381}, 'weighted avg': {'precision': 0.35268685993876603, 'recall': 0.35037124374621587, 'f1-score': 0.33439854227588806, 'support': 31381}}
[[2377 5257 2116]
 [2199 6055 2364]
 [2273 6177 2563]]
training model: results/CHTR/W7/deepLOB_L1/h200
Epoch 1/50
401/401 - 12s - loss: 3.3328 - accuracy200: 0.3563 - val_loss: 3.4255 - val_accuracy200: 0.3427 - 12s/epoch - 29ms/step
Epoch 2/50
401/401 - 9s - loss: 3.3021 - accuracy200: 0.3638 - val_loss: 3.4236 - val_accuracy200: 0.3345 - 9s/epoch - 24ms/step
Epoch 3/50
401/401 - 10s - loss: 3.2909 - accuracy200: 0.3684 - val_loss: 3.4120 - val_accuracy200: 0.3378 - 10s/epoch - 24ms/step
Epoch 4/50
401/401 - 10s - loss: 3.2842 - accuracy200: 0.3686 - val_loss: 3.3729 - val_accuracy200: 0.3391 - 10s/epoch - 24ms/step
Epoch 5/50
401/401 - 9s - loss: 3.2751 - accuracy200: 0.3734 - val_loss: 3.3638 - val_accuracy200: 0.3490 - 9s/epoch - 24ms/step
Epoch 6/50
401/401 - 10s - loss: 3.2662 - accuracy200: 0.3797 - val_loss: 3.3514 - val_accuracy200: 0.3534 - 10s/epoch - 24ms/step
Epoch 7/50
401/401 - 9s - loss: 3.2571 - accuracy200: 0.3811 - val_loss: 3.3978 - val_accuracy200: 0.3485 - 9s/epoch - 24ms/step
Epoch 8/50
401/401 - 9s - loss: 3.2508 - accuracy200: 0.3862 - val_loss: 3.3708 - val_accuracy200: 0.3544 - 9s/epoch - 24ms/step
Epoch 9/50
401/401 - 9s - loss: 3.2448 - accuracy200: 0.3890 - val_loss: 3.3859 - val_accuracy200: 0.3539 - 9s/epoch - 24ms/step
Epoch 10/50
401/401 - 10s - loss: 3.2368 - accuracy200: 0.3956 - val_loss: 3.4043 - val_accuracy200: 0.3566 - 10s/epoch - 24ms/step
Epoch 11/50
401/401 - 9s - loss: 3.2307 - accuracy200: 0.3990 - val_loss: 3.4498 - val_accuracy200: 0.3540 - 9s/epoch - 24ms/step
Epoch 12/50
401/401 - 10s - loss: 3.2252 - accuracy200: 0.4011 - val_loss: 3.4614 - val_accuracy200: 0.3507 - 10s/epoch - 24ms/step
Epoch 13/50
401/401 - 10s - loss: 3.2239 - accuracy200: 0.4013 - val_loss: 3.4635 - val_accuracy200: 0.3562 - 10s/epoch - 24ms/step
Epoch 14/50
401/401 - 10s - loss: 3.2231 - accuracy200: 0.4028 - val_loss: 3.4395 - val_accuracy200: 0.3582 - 10s/epoch - 24ms/step
Epoch 15/50
401/401 - 10s - loss: 3.2165 - accuracy200: 0.4052 - val_loss: 3.4537 - val_accuracy200: 0.3491 - 10s/epoch - 24ms/step
Epoch 16/50
401/401 - 10s - loss: 3.2160 - accuracy200: 0.4061 - val_loss: 3.5548 - val_accuracy200: 0.3520 - 10s/epoch - 25ms/step
testing model: results/CHTR/W7/deepLOB_L1/h200
Evaluating performance on  test set...
1065/1065 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1310881
{'0': {'precision': 0.2964144046044956, 'recall': 0.046365914786967416, 'f1-score': 0.08018853036790774, 'support': 82194}, '1': {'precision': 0.3485370598781837, 'recall': 0.8714959461607757, 'f1-score': 0.4979351103898463, 'support': 94355}, '2': {'precision': 0.357598546622164, 'recall': 0.08825308114195149, 'f1-score': 0.14156805352289356, 'support': 95906}, 'accuracy': 0.34686461984547906, 'macro avg': {'precision': 0.3341833370349478, 'recall': 0.33537164736323155, 'f1-score': 0.23989723142688255, 'support': 272455}, 'weighted avg': {'precision': 0.3360024446944016, 'recall': 0.34686461984547906, 'f1-score': 0.24646605548461356, 'support': 272455}}
[[ 3811 71159  7224]
 [ 4144 82230  7981]
 [ 4902 82540  8464]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1133624
{'0': {'precision': 0.3798507462686567, 'recall': 0.12935562207036766, 'f1-score': 0.19298984707418795, 'support': 35414}, '1': {'precision': 0.35110258032150415, 'recall': 0.47551104809169326, 'f1-score': 0.4039448424697926, 'support': 33852}, '2': {'precision': 0.32979318054779205, 'recall': 0.4420667745609303, 'f1-score': 0.37776440306821524, 'support': 33366}, 'accuracy': 0.34519448125341023, 'macro avg': {'precision': 0.35358216904598433, 'recall': 0.3489778149076637, 'f1-score': 0.3248996975373986, 'support': 102632}, 'weighted avg': {'precision': 0.3540946112280711, 'recall': 0.34519448125341023, 'f1-score': 0.32264177180944326, 'support': 102632}}
[[ 4581 14898 15935]
 [ 3715 16097 14040]
 [ 3764 14852 14750]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1157507
{'0': {'precision': 0.32516875602700096, 'recall': 0.17881005408845052, 'f1-score': 0.23073764882988917, 'support': 9429}, '1': {'precision': 0.34690928200748866, 'recall': 0.4913929468688936, 'f1-score': 0.4067000385059684, 'support': 10747}, '2': {'precision': 0.366991706916978, 'recall': 0.35939312806782686, 'f1-score': 0.36315267382090355, 'support': 11205}, 'accuracy': 0.3503393773302317, 'macro avg': {'precision': 0.3463565816504892, 'recall': 0.343198709675057, 'f1-score': 0.3335301203855871, 'support': 31381}, 'weighted avg': {'precision': 0.34754763488473317, 'recall': 0.3503393773302317, 'f1-score': 0.338279733431181, 'support': 31381}}
[[1686 4452 3291]
 [1811 5281 3655]
 [1688 5490 4027]]
training model: results/CHTR/W7/deepLOB_L1/h300
Epoch 1/50
401/401 - 11s - loss: 3.3330 - accuracy300: 0.3600 - val_loss: 3.4100 - val_accuracy300: 0.3395 - 11s/epoch - 29ms/step
Epoch 2/50
401/401 - 10s - loss: 3.3028 - accuracy300: 0.3673 - val_loss: 3.3978 - val_accuracy300: 0.3397 - 10s/epoch - 24ms/step
Epoch 3/50
401/401 - 10s - loss: 3.2946 - accuracy300: 0.3708 - val_loss: 3.3987 - val_accuracy300: 0.3434 - 10s/epoch - 24ms/step
Epoch 4/50
401/401 - 9s - loss: 3.2910 - accuracy300: 0.3636 - val_loss: 3.3790 - val_accuracy300: 0.3413 - 9s/epoch - 23ms/step
Epoch 5/50
401/401 - 10s - loss: 3.2777 - accuracy300: 0.3761 - val_loss: 3.3754 - val_accuracy300: 0.3386 - 10s/epoch - 24ms/step
Epoch 6/50
401/401 - 9s - loss: 3.2706 - accuracy300: 0.3801 - val_loss: 3.3799 - val_accuracy300: 0.3375 - 9s/epoch - 24ms/step
Epoch 7/50
401/401 - 10s - loss: 3.2614 - accuracy300: 0.3863 - val_loss: 3.3697 - val_accuracy300: 0.3410 - 10s/epoch - 24ms/step
Epoch 8/50
401/401 - 9s - loss: 3.2542 - accuracy300: 0.3944 - val_loss: 3.3743 - val_accuracy300: 0.3390 - 9s/epoch - 23ms/step
Epoch 9/50
401/401 - 9s - loss: 3.2459 - accuracy300: 0.3962 - val_loss: 3.3815 - val_accuracy300: 0.3456 - 9s/epoch - 24ms/step
Epoch 10/50
401/401 - 9s - loss: 3.2447 - accuracy300: 0.3989 - val_loss: 3.3924 - val_accuracy300: 0.3432 - 9s/epoch - 23ms/step
Epoch 11/50
401/401 - 10s - loss: 3.2371 - accuracy300: 0.4022 - val_loss: 3.3789 - val_accuracy300: 0.3458 - 10s/epoch - 24ms/step
Epoch 12/50
401/401 - 9s - loss: 3.2298 - accuracy300: 0.4064 - val_loss: 3.4045 - val_accuracy300: 0.3467 - 9s/epoch - 24ms/step
Epoch 13/50
401/401 - 9s - loss: 3.2211 - accuracy300: 0.4112 - val_loss: 3.4001 - val_accuracy300: 0.3469 - 9s/epoch - 23ms/step
Epoch 14/50
401/401 - 9s - loss: 3.2177 - accuracy300: 0.4114 - val_loss: 3.4362 - val_accuracy300: 0.3436 - 9s/epoch - 24ms/step
Epoch 15/50
401/401 - 9s - loss: 3.2085 - accuracy300: 0.4154 - val_loss: 3.4357 - val_accuracy300: 0.3454 - 9s/epoch - 23ms/step
Epoch 16/50
401/401 - 9s - loss: 3.2040 - accuracy300: 0.4182 - val_loss: 3.4487 - val_accuracy300: 0.3490 - 9s/epoch - 23ms/step
Epoch 17/50
401/401 - 10s - loss: 3.2007 - accuracy300: 0.4210 - val_loss: 3.4466 - val_accuracy300: 0.3430 - 10s/epoch - 24ms/step
testing model: results/CHTR/W7/deepLOB_L1/h300
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1221812
{'0': {'precision': 0.28563306024345486, 'recall': 0.13544781606941517, 'f1-score': 0.1837574508059756, 'support': 81596}, '1': {'precision': 0.33939045014573066, 'recall': 0.8112763280972809, 'f1-score': 0.4785737163732769, 'support': 93009}, '2': {'precision': 0.416127339513731, 'recall': 0.048625447112927954, 'f1-score': 0.08707587570001099, 'support': 97850}, 'accuracy': 0.3349764181240939, 'macro avg': {'precision': 0.34705028330097215, 'recall': 0.33178319709320797, 'f1-score': 0.24980234762642115, 'support': 272455}, 'weighted avg': {'precision': 0.35085038532105406, 'recall': 0.3349764181240939, 'f1-score': 0.2496775987938286, 'support': 272455}}
[[11052 67234  3310]
 [14187 75456  3366]
 [13454 79638  4758]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.116902
{'0': {'precision': 0.3686664810690423, 'recall': 0.14991226580630554, 'f1-score': 0.21315037624240474, 'support': 35334}, '1': {'precision': 0.34586100761380206, 'recall': 0.5053702991389768, 'f1-score': 0.41067070605066064, 'support': 33797}, '2': {'precision': 0.33271604938271604, 'recall': 0.38613772723202294, 'f1-score': 0.35744187010403283, 'support': 33501}, 'accuracy': 0.34407397302985426, 'macro avg': {'precision': 0.34908117935518684, 'recall': 0.34714009739243507, 'f1-score': 0.32708765079903274, 'support': 102632}, 'weighted avg': {'precision': 0.3494216841412774, 'recall': 0.34407397302985426, 'f1-score': 0.3252938005388038, 'support': 102632}}
[[ 5297 16328 13709]
 [ 4482 17080 12235]
 [ 4589 15976 12936]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1219343
{'0': {'precision': 0.32, 'recall': 0.18779739875224702, 'f1-score': 0.23668954487905644, 'support': 9457}, '1': {'precision': 0.3350223546944858, 'recall': 0.5362595419847328, 'f1-score': 0.41240139423958905, 'support': 10480}, '2': {'precision': 0.36042402826855124, 'recall': 0.28521495980426426, 'f1-score': 0.3184390243902439, 'support': 11444}, 'accuracy': 0.33969599439151077, 'macro avg': {'precision': 0.3384821276543457, 'recall': 0.33642396684708137, 'f1-score': 0.3225099878362965, 'support': 31381}, 'weighted avg': {'precision': 0.3397586710654062, 'recall': 0.33969599439151077, 'f1-score': 0.32518262109792806, 'support': 31381}}
[[1776 4986 2695]
 [1763 5620 3097]
 [2011 6169 3264]]
training model: results/CHTR/W7/deepLOB_L1/h500
Epoch 1/50
401/401 - 12s - loss: 3.3288 - accuracy500: 0.3647 - val_loss: 3.3805 - val_accuracy500: 0.3406 - 12s/epoch - 31ms/step
Epoch 2/50
401/401 - 9s - loss: 3.2987 - accuracy500: 0.3747 - val_loss: 3.4657 - val_accuracy500: 0.3370 - 9s/epoch - 24ms/step
Epoch 3/50
401/401 - 9s - loss: 3.2883 - accuracy500: 0.3741 - val_loss: 3.4137 - val_accuracy500: 0.3389 - 9s/epoch - 23ms/step
Epoch 4/50
401/401 - 9s - loss: 3.2828 - accuracy500: 0.3790 - val_loss: 3.4471 - val_accuracy500: 0.3360 - 9s/epoch - 23ms/step
Epoch 5/50
401/401 - 9s - loss: 3.2774 - accuracy500: 0.3808 - val_loss: 3.3891 - val_accuracy500: 0.3342 - 9s/epoch - 23ms/step
Epoch 6/50
401/401 - 10s - loss: 3.2680 - accuracy500: 0.3828 - val_loss: 3.4085 - val_accuracy500: 0.3379 - 10s/epoch - 24ms/step
Epoch 7/50
401/401 - 9s - loss: 3.2559 - accuracy500: 0.3919 - val_loss: 3.4765 - val_accuracy500: 0.3383 - 9s/epoch - 23ms/step
Epoch 8/50
401/401 - 9s - loss: 3.2446 - accuracy500: 0.3995 - val_loss: 3.4768 - val_accuracy500: 0.3353 - 9s/epoch - 23ms/step
Epoch 9/50
401/401 - 9s - loss: 3.2348 - accuracy500: 0.4032 - val_loss: 3.4677 - val_accuracy500: 0.3315 - 9s/epoch - 23ms/step
Epoch 10/50
401/401 - 10s - loss: 3.2162 - accuracy500: 0.4140 - val_loss: 3.4978 - val_accuracy500: 0.3308 - 10s/epoch - 24ms/step
Epoch 11/50
401/401 - 9s - loss: 3.2112 - accuracy500: 0.4168 - val_loss: 3.5079 - val_accuracy500: 0.3297 - 9s/epoch - 23ms/step
testing model: results/CHTR/W7/deepLOB_L1/h500
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1380395
{'0': {'precision': 0.267715184443809, 'recall': 0.11699136498256751, 'f1-score': 0.1628273025314584, 'support': 80023}, '1': {'precision': 0.3430838266396607, 'recall': 0.6532642972811727, 'f1-score': 0.4498917788620272, 'support': 93864}, '2': {'precision': 0.3594853554349121, 'recall': 0.21429875821767713, 'f1-score': 0.26852352107394156, 'support': 98568}, 'accuracy': 0.3369473858068305, 'macro avg': {'precision': 0.32342812217279393, 'recall': 0.32818480682713913, 'f1-score': 0.29374753415580906, 'support': 272455}, 'weighted avg': {'precision': 0.3268809345505146, 'recall': 0.3369473858068305, 'f1-score': 0.2999629208008533, 'support': 272455}}
[[ 9362 52165 18496]
 [13406 61318 19140]
 [12202 65243 21123]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1322894
{'0': {'precision': 0.36444273042807557, 'recall': 0.16228283579953634, 'f1-score': 0.2245677961066994, 'support': 34939}, '1': {'precision': 0.3444550365427391, 'recall': 0.41481219828093724, 'f1-score': 0.3763738098099702, 'support': 33972}, '2': {'precision': 0.32575872451963694, 'recall': 0.44595356009608256, 'f1-score': 0.3764959190826698, 'support': 33721}, 'accuracy': 0.3390755319978174, 'macro avg': {'precision': 0.3448854971634839, 'recall': 0.341016198058852, 'f1-score': 0.32581250833311315, 'support': 102632}, 'weighted avg': {'precision': 0.34511654269022474, 'recall': 0.3390755319978174, 'f1-score': 0.32473462645591034, 'support': 102632}}
[[ 5670 13294 15975]
 [ 4730 14092 15150]
 [ 5158 13525 15038]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1271117
{'0': {'precision': 0.30053842388644153, 'recall': 0.2587442056468605, 'f1-score': 0.27807971014492755, 'support': 9492}, '1': {'precision': 0.3211611209758357, 'recall': 0.4181745074386811, 'f1-score': 0.36330291253657043, 'support': 9948}, '2': {'precision': 0.3952808112324493, 'recall': 0.3395025542249393, 'f1-score': 0.36527458665585444, 'support': 11941}, 'accuracy': 0.3400146585513527, 'macro avg': {'precision': 0.33899345203157555, 'recall': 0.3388070891034936, 'f1-score': 0.3355524031124508, 'support': 31381}, 'weighted avg': {'precision': 0.3431270424117904, 'recall': 0.3400146585513527, 'f1-score': 0.33827519269197964, 'support': 31381}}
[[2456 3987 3049]
 [2635 4160 3153]
 [3081 4806 4054]]
training model: results/CHTR/W7/deepLOB_L1/h1000
Epoch 1/50
401/401 - 12s - loss: 3.3229 - accuracy1000: 0.3754 - val_loss: 3.4500 - val_accuracy1000: 0.3257 - 12s/epoch - 30ms/step
Epoch 2/50
401/401 - 11s - loss: 3.3019 - accuracy1000: 0.3768 - val_loss: 3.3711 - val_accuracy1000: 0.3392 - 11s/epoch - 27ms/step
Epoch 3/50
401/401 - 10s - loss: 3.2894 - accuracy1000: 0.3771 - val_loss: 3.3869 - val_accuracy1000: 0.3381 - 10s/epoch - 25ms/step
Epoch 4/50
401/401 - 10s - loss: 3.2830 - accuracy1000: 0.3783 - val_loss: 3.3579 - val_accuracy1000: 0.3490 - 10s/epoch - 25ms/step
Epoch 5/50
401/401 - 10s - loss: 3.2637 - accuracy1000: 0.3884 - val_loss: 3.4331 - val_accuracy1000: 0.3339 - 10s/epoch - 25ms/step
Epoch 6/50
401/401 - 10s - loss: 3.2453 - accuracy1000: 0.3985 - val_loss: 3.4185 - val_accuracy1000: 0.3435 - 10s/epoch - 25ms/step
Epoch 7/50
401/401 - 10s - loss: 3.2303 - accuracy1000: 0.4013 - val_loss: 3.4545 - val_accuracy1000: 0.3434 - 10s/epoch - 24ms/step
Epoch 8/50
401/401 - 10s - loss: 3.2365 - accuracy1000: 0.3992 - val_loss: 3.3765 - val_accuracy1000: 0.3557 - 10s/epoch - 24ms/step
Epoch 9/50
401/401 - 10s - loss: 3.2083 - accuracy1000: 0.4183 - val_loss: 3.5008 - val_accuracy1000: 0.3234 - 10s/epoch - 25ms/step
Epoch 10/50
401/401 - 10s - loss: 3.2104 - accuracy1000: 0.4159 - val_loss: 3.5393 - val_accuracy1000: 0.3257 - 10s/epoch - 24ms/step
Epoch 11/50
401/401 - 10s - loss: 3.2012 - accuracy1000: 0.4178 - val_loss: 3.5130 - val_accuracy1000: 0.3291 - 10s/epoch - 24ms/step
Epoch 12/50
401/401 - 10s - loss: 3.1873 - accuracy1000: 0.4288 - val_loss: 3.5691 - val_accuracy1000: 0.3300 - 10s/epoch - 24ms/step
Epoch 13/50
401/401 - 10s - loss: 3.1702 - accuracy1000: 0.4407 - val_loss: 3.5071 - val_accuracy1000: 0.3214 - 10s/epoch - 25ms/step
Epoch 14/50
401/401 - 10s - loss: 3.1674 - accuracy1000: 0.4383 - val_loss: 3.6212 - val_accuracy1000: 0.3360 - 10s/epoch - 25ms/step
testing model: results/CHTR/W7/deepLOB_L1/h1000
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1456223
{'0': {'precision': 0.20713577799801783, 'recall': 0.005484268807893149, 'f1-score': 0.010685617874124444, 'support': 76218}, '1': {'precision': 0.34914346502329335, 'recall': 0.798515053955137, 'f1-score': 0.4858523823956356, 'support': 95357}, '2': {'precision': 0.36378918412959177, 'recall': 0.1887787470261697, 'f1-score': 0.2485691350853951, 'support': 100880}, 'accuracy': 0.35090565414472114, 'macro avg': {'precision': 0.30668947571696764, 'recall': 0.3309260232630666, 'f1-score': 0.24836904511838506, 'support': 272455}, 'weighted avg': {'precision': 0.3148402525799575, 'recall': 0.35090565414472114, 'f1-score': 0.2650695212003645, 'support': 272455}}
[[  418 61115 14685]
 [  593 76144 18620]
 [ 1007 80829 19044]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.128849
{'0': {'precision': 0.3790983606557377, 'recall': 0.015514060490859283, 'f1-score': 0.029808260379182553, 'support': 35774}, '1': {'precision': 0.3421458697664849, 'recall': 0.49030013562120406, 'f1-score': 0.40303915272105956, 'support': 33918}, '2': {'precision': 0.31179727184521433, 'recall': 0.49754098360655735, 'f1-score': 0.3833549700010527, 'support': 32940}, 'accuracy': 0.32712993997973344, 'macro avg': {'precision': 0.34434716742247895, 'recall': 0.33445172657287353, 'f1-score': 0.27206746103376495, 'support': 102632}, 'weighted avg': {'precision': 0.34528578318087294, 'recall': 0.32712993997973344, 'f1-score': 0.26662595877145967, 'support': 102632}}
[[  555 15893 19326]
 [  440 16630 16848]
 [  469 16082 16389]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1211867
{'0': {'precision': 0.3282392026578073, 'recall': 0.051054154609342706, 'f1-score': 0.0883641892496199, 'support': 9676}, '1': {'precision': 0.30756084222039926, 'recall': 0.4752297454314989, 'f1-score': 0.37343847271218095, 'support': 9467}, '2': {'precision': 0.3930351521511018, 'recall': 0.48970420003268506, 'f1-score': 0.43607654806083096, 'support': 12238}, 'accuracy': 0.3500844460023581, 'macro avg': {'precision': 0.3429450656764361, 'recall': 0.3386627000245089, 'f1-score': 0.29929307000754396, 'support': 31381}, 'weighted avg': {'precision': 0.3472701701743936, 'recall': 0.3500844460023581, 'f1-score': 0.30996649920378533, 'support': 31381}}
[[ 494 4464 4718]
 [ 431 4499 4537]
 [ 580 5665 5993]]
training model: results/CHTR/W7/deepOF_L1/h10
Epoch 1/50
401/401 - 11s - loss: 3.3000 - accuracy10: 0.3740 - val_loss: 3.3029 - val_accuracy10: 0.3704 - 11s/epoch - 28ms/step
Epoch 2/50
401/401 - 9s - loss: 3.2619 - accuracy10: 0.3918 - val_loss: 3.2902 - val_accuracy10: 0.3776 - 9s/epoch - 22ms/step
Epoch 3/50
401/401 - 9s - loss: 3.2447 - accuracy10: 0.4007 - val_loss: 3.2813 - val_accuracy10: 0.3827 - 9s/epoch - 22ms/step
Epoch 4/50
401/401 - 9s - loss: 3.2320 - accuracy10: 0.4083 - val_loss: 3.2714 - val_accuracy10: 0.3919 - 9s/epoch - 22ms/step
Epoch 5/50
401/401 - 9s - loss: 3.2272 - accuracy10: 0.4106 - val_loss: 3.2691 - val_accuracy10: 0.3911 - 9s/epoch - 22ms/step
Epoch 6/50
401/401 - 9s - loss: 3.2197 - accuracy10: 0.4140 - val_loss: 3.2682 - val_accuracy10: 0.3924 - 9s/epoch - 22ms/step
Epoch 7/50
401/401 - 9s - loss: 3.2122 - accuracy10: 0.4176 - val_loss: 3.2654 - val_accuracy10: 0.3948 - 9s/epoch - 23ms/step
Epoch 8/50
401/401 - 9s - loss: 3.2075 - accuracy10: 0.4207 - val_loss: 3.2629 - val_accuracy10: 0.3963 - 9s/epoch - 23ms/step
Epoch 9/50
401/401 - 9s - loss: 3.2030 - accuracy10: 0.4218 - val_loss: 3.2649 - val_accuracy10: 0.3962 - 9s/epoch - 23ms/step
Epoch 10/50
401/401 - 9s - loss: 3.2000 - accuracy10: 0.4222 - val_loss: 3.2653 - val_accuracy10: 0.3956 - 9s/epoch - 23ms/step
Epoch 11/50
401/401 - 9s - loss: 3.1962 - accuracy10: 0.4240 - val_loss: 3.2644 - val_accuracy10: 0.3965 - 9s/epoch - 23ms/step
Epoch 12/50
401/401 - 9s - loss: 3.1917 - accuracy10: 0.4275 - val_loss: 3.2611 - val_accuracy10: 0.3972 - 9s/epoch - 23ms/step
Epoch 13/50
401/401 - 9s - loss: 3.1866 - accuracy10: 0.4287 - val_loss: 3.2618 - val_accuracy10: 0.3963 - 9s/epoch - 22ms/step
Epoch 14/50
401/401 - 9s - loss: 3.1834 - accuracy10: 0.4280 - val_loss: 3.2614 - val_accuracy10: 0.3965 - 9s/epoch - 23ms/step
Epoch 15/50
401/401 - 9s - loss: 3.1798 - accuracy10: 0.4300 - val_loss: 3.2659 - val_accuracy10: 0.3957 - 9s/epoch - 22ms/step
Epoch 16/50
401/401 - 9s - loss: 3.1753 - accuracy10: 0.4329 - val_loss: 3.2651 - val_accuracy10: 0.3965 - 9s/epoch - 22ms/step
Epoch 17/50
401/401 - 9s - loss: 3.1707 - accuracy10: 0.4344 - val_loss: 3.2684 - val_accuracy10: 0.3959 - 9s/epoch - 22ms/step
Epoch 18/50
401/401 - 9s - loss: 3.1683 - accuracy10: 0.4355 - val_loss: 3.2683 - val_accuracy10: 0.3972 - 9s/epoch - 22ms/step
Epoch 19/50
401/401 - 9s - loss: 3.1652 - accuracy10: 0.4350 - val_loss: 3.2664 - val_accuracy10: 0.3953 - 9s/epoch - 23ms/step
Epoch 20/50
401/401 - 9s - loss: 3.1616 - accuracy10: 0.4369 - val_loss: 3.2677 - val_accuracy10: 0.3933 - 9s/epoch - 23ms/step
Epoch 21/50
401/401 - 9s - loss: 3.1577 - accuracy10: 0.4393 - val_loss: 3.2613 - val_accuracy10: 0.3978 - 9s/epoch - 22ms/step
Epoch 22/50
401/401 - 9s - loss: 3.1556 - accuracy10: 0.4395 - val_loss: 3.2672 - val_accuracy10: 0.3985 - 9s/epoch - 22ms/step
testing model: results/CHTR/W7/deepOF_L1/h10
Evaluating performance on  test set...
1065/1065 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0848927
{'0': {'precision': 0.38028954091507317, 'recall': 0.5570271925248905, 'f1-score': 0.45199580411858886, 'support': 88186}, '1': {'precision': 0.41784254761354, 'recall': 0.2245915058075078, 'f1-score': 0.29215103545411053, 'support': 96513}, '2': {'precision': 0.40471970592096623, 'recall': 0.42156784538067943, 'f1-score': 0.4129720074795568, 'support': 87751}, 'accuracy': 0.39563589649476966, 'macro avg': {'precision': 0.4009505981498598, 'recall': 0.4010621812376926, 'f1-score': 0.38570628235075205, 'support': 272450}, 'weighted avg': {'precision': 0.401460855816601, 'recall': 0.39563589649476966, 'f1-score': 0.38280338225407606, 'support': 272450}}
[[49122 16564 22500]
 [42926 21676 31911]
 [37122 13636 36993]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0682886
{'0': {'precision': 0.41727887814572495, 'recall': 0.525668795184112, 'f1-score': 0.4652442364188617, 'support': 35549}, '1': {'precision': 0.4267389340560072, 'recall': 0.2802978609784318, 'f1-score': 0.3383530001611546, 'support': 33707}, '2': {'precision': 0.42196645103475316, 'recall': 0.4514621284755513, 'f1-score': 0.43621625533762753, 'support': 33376}, 'accuracy': 0.4209505807155663, 'macro avg': {'precision': 0.4219947544121618, 'recall': 0.4191429282126984, 'f1-score': 0.41327116397254793, 'support': 102632}, 'weighted avg': {'precision': 0.4219102069448528, 'recall': 0.4209505807155663, 'f1-score': 0.41412995630051846, 'support': 102632}}
[[18687  6971  9891]
 [13509  9448 10750]
 [12587  5721 15068]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0841862
{'0': {'precision': 0.38216422752505225, 'recall': 0.5240731586752349, 'f1-score': 0.4420078379054449, 'support': 10115}, '1': {'precision': 0.40445301542777, 'recall': 0.21574862059291125, 'f1-score': 0.28139293773251206, 'support': 10693}, '2': {'precision': 0.41216330679315605, 'recall': 0.4602288848954885, 'f1-score': 0.4348719781938425, 'support': 10573}, 'accuracy': 0.3975016729868392, 'macro avg': {'precision': 0.39959351658199277, 'recall': 0.4000168880545449, 'f1-score': 0.38609091794393313, 'support': 31381}, 'weighted avg': {'precision': 0.3998664764701281, 'recall': 0.3975016729868392, 'f1-score': 0.3848744587180404, 'support': 31381}}
[[5301 1779 3035]
 [4481 2307 3905]
 [4089 1618 4866]]
training model: results/CHTR/W7/deepOF_L1/h20
Epoch 1/50
401/401 - 11s - loss: 3.3017 - accuracy20: 0.3712 - val_loss: 3.2958 - val_accuracy20: 0.3735 - 11s/epoch - 27ms/step
Epoch 2/50
401/401 - 9s - loss: 3.2607 - accuracy20: 0.3916 - val_loss: 3.2842 - val_accuracy20: 0.3804 - 9s/epoch - 22ms/step
Epoch 3/50
401/401 - 9s - loss: 3.2445 - accuracy20: 0.4003 - val_loss: 3.2738 - val_accuracy20: 0.3842 - 9s/epoch - 22ms/step
Epoch 4/50
401/401 - 9s - loss: 3.2371 - accuracy20: 0.4024 - val_loss: 3.2692 - val_accuracy20: 0.3899 - 9s/epoch - 22ms/step
Epoch 5/50
401/401 - 9s - loss: 3.2301 - accuracy20: 0.4062 - val_loss: 3.2664 - val_accuracy20: 0.3901 - 9s/epoch - 23ms/step
Epoch 6/50
401/401 - 9s - loss: 3.2215 - accuracy20: 0.4103 - val_loss: 3.2625 - val_accuracy20: 0.3903 - 9s/epoch - 22ms/step
Epoch 7/50
401/401 - 9s - loss: 3.2166 - accuracy20: 0.4107 - val_loss: 3.2640 - val_accuracy20: 0.3936 - 9s/epoch - 22ms/step
Epoch 8/50
401/401 - 9s - loss: 3.2128 - accuracy20: 0.4146 - val_loss: 3.2604 - val_accuracy20: 0.3928 - 9s/epoch - 22ms/step
Epoch 9/50
401/401 - 9s - loss: 3.2069 - accuracy20: 0.4155 - val_loss: 3.2623 - val_accuracy20: 0.3916 - 9s/epoch - 22ms/step
Epoch 10/50
401/401 - 9s - loss: 3.2041 - accuracy20: 0.4182 - val_loss: 3.2612 - val_accuracy20: 0.3904 - 9s/epoch - 23ms/step
Epoch 11/50
401/401 - 9s - loss: 3.2012 - accuracy20: 0.4190 - val_loss: 3.2622 - val_accuracy20: 0.3920 - 9s/epoch - 22ms/step
Epoch 12/50
401/401 - 9s - loss: 3.1981 - accuracy20: 0.4204 - val_loss: 3.2611 - val_accuracy20: 0.3911 - 9s/epoch - 22ms/step
Epoch 13/50
401/401 - 9s - loss: 3.1944 - accuracy20: 0.4225 - val_loss: 3.2605 - val_accuracy20: 0.3910 - 9s/epoch - 23ms/step
Epoch 14/50
401/401 - 9s - loss: 3.1908 - accuracy20: 0.4243 - val_loss: 3.2648 - val_accuracy20: 0.3932 - 9s/epoch - 22ms/step
Epoch 15/50
401/401 - 9s - loss: 3.1879 - accuracy20: 0.4252 - val_loss: 3.2568 - val_accuracy20: 0.3977 - 9s/epoch - 22ms/step
Epoch 16/50
401/401 - 9s - loss: 3.1853 - accuracy20: 0.4269 - val_loss: 3.2627 - val_accuracy20: 0.3943 - 9s/epoch - 22ms/step
Epoch 17/50
401/401 - 9s - loss: 3.1814 - accuracy20: 0.4295 - val_loss: 3.2652 - val_accuracy20: 0.3898 - 9s/epoch - 23ms/step
Epoch 18/50
401/401 - 9s - loss: 3.1786 - accuracy20: 0.4296 - val_loss: 3.2604 - val_accuracy20: 0.3916 - 9s/epoch - 22ms/step
Epoch 19/50
401/401 - 9s - loss: 3.1754 - accuracy20: 0.4329 - val_loss: 3.2601 - val_accuracy20: 0.3932 - 9s/epoch - 22ms/step
Epoch 20/50
401/401 - 9s - loss: 3.1726 - accuracy20: 0.4321 - val_loss: 3.2568 - val_accuracy20: 0.3973 - 9s/epoch - 22ms/step
Epoch 21/50
401/401 - 8s - loss: 3.1685 - accuracy20: 0.4347 - val_loss: 3.2602 - val_accuracy20: 0.3944 - 8s/epoch - 21ms/step
Epoch 22/50
401/401 - 9s - loss: 3.1653 - accuracy20: 0.4348 - val_loss: 3.2626 - val_accuracy20: 0.3941 - 9s/epoch - 22ms/step
Epoch 23/50
401/401 - 9s - loss: 3.1618 - accuracy20: 0.4366 - val_loss: 3.2658 - val_accuracy20: 0.3929 - 9s/epoch - 21ms/step
Epoch 24/50
401/401 - 9s - loss: 3.1592 - accuracy20: 0.4370 - val_loss: 3.2654 - val_accuracy20: 0.3931 - 9s/epoch - 22ms/step
Epoch 25/50
401/401 - 9s - loss: 3.1548 - accuracy20: 0.4395 - val_loss: 3.2681 - val_accuracy20: 0.3900 - 9s/epoch - 23ms/step
testing model: results/CHTR/W7/deepOF_L1/h20
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.081138
{'0': {'precision': 0.3824259598264664, 'recall': 0.5263945139911634, 'f1-score': 0.4430070251715139, 'support': 86912}, '1': {'precision': 0.4230524669611095, 'recall': 0.25411359084997004, 'f1-score': 0.317509657365071, 'support': 96874}, '2': {'precision': 0.409193701785903, 'recall': 0.43672742037354506, 'f1-score': 0.42251246631095396, 'support': 88664}, 'accuracy': 0.40040007340796474, 'macro avg': {'precision': 0.4048907095244929, 'recall': 0.4057451750715595, 'f1-score': 0.39434304961584626, 'support': 272450}, 'weighted avg': {'precision': 0.4055824557899566, 'recall': 0.40040007340796474, 'f1-score': 0.39171481898434546, 'support': 272450}}
[[45750 17742 23420]
 [39769 24617 32488]
 [34112 15830 38722]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.067709
{'0': {'precision': 0.4197438001458789, 'recall': 0.5171300196573996, 'f1-score': 0.46337535542638586, 'support': 35610}, '1': {'precision': 0.4295572683276573, 'recall': 0.2847213971723892, 'f1-score': 0.3424549871391826, 'support': 33668}, '2': {'precision': 0.4184776643617605, 'recall': 0.45724650716555737, 'f1-score': 0.43700392561391443, 'support': 33354}, 'accuracy': 0.42142801465429885, 'macro avg': {'precision': 0.42259291094509893, 'recall': 0.41969930799844873, 'f1-score': 0.41427808939316096, 'support': 102632}, 'weighted avg': {'precision': 0.4225515906381292, 'recall': 0.42142801465429885, 'f1-score': 0.41513757744818475, 'support': 102632}}
[[18415  6917 10278]
 [13167  9586 10915]
 [12290  5813 15251]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0841038
{'0': {'precision': 0.384927797833935, 'recall': 0.503046982504423, 'f1-score': 0.43613123135918197, 'support': 10174}, '1': {'precision': 0.3779436152570481, 'recall': 0.21708896932749094, 'f1-score': 0.27577444336882867, 'support': 10498}, '2': {'precision': 0.40788054749066777, 'recall': 0.4591465122793912, 'f1-score': 0.4319978914074855, 'support': 10709}, 'accuracy': 0.3924030464293681, 'macro avg': {'precision': 0.39025065352721694, 'recall': 0.39309415470376835, 'f1-score': 0.38130118871183205, 'support': 31381}, 'weighted avg': {'precision': 0.3904241506391927, 'recall': 0.3924030464293681, 'f1-score': 0.381075959128678, 'support': 31381}}
[[5118 1869 3187]
 [4268 2279 3951]
 [3910 1882 4917]]
training model: results/CHTR/W7/deepOF_L1/h30
Epoch 1/50
401/401 - 11s - loss: 3.3002 - accuracy30: 0.3728 - val_loss: 3.2998 - val_accuracy30: 0.3726 - 11s/epoch - 27ms/step
Epoch 2/50
401/401 - 9s - loss: 3.2603 - accuracy30: 0.3911 - val_loss: 3.2831 - val_accuracy30: 0.3781 - 9s/epoch - 22ms/step
Epoch 3/50
401/401 - 9s - loss: 3.2445 - accuracy30: 0.3989 - val_loss: 3.2787 - val_accuracy30: 0.3817 - 9s/epoch - 22ms/step
Epoch 4/50
401/401 - 9s - loss: 3.2339 - accuracy30: 0.4024 - val_loss: 3.2735 - val_accuracy30: 0.3870 - 9s/epoch - 23ms/step
Epoch 5/50
401/401 - 9s - loss: 3.2274 - accuracy30: 0.4052 - val_loss: 3.2714 - val_accuracy30: 0.3884 - 9s/epoch - 22ms/step
Epoch 6/50
401/401 - 9s - loss: 3.2221 - accuracy30: 0.4072 - val_loss: 3.2663 - val_accuracy30: 0.3908 - 9s/epoch - 22ms/step
Epoch 7/50
401/401 - 9s - loss: 3.2159 - accuracy30: 0.4101 - val_loss: 3.2638 - val_accuracy30: 0.3894 - 9s/epoch - 22ms/step
Epoch 8/50
401/401 - 9s - loss: 3.2132 - accuracy30: 0.4109 - val_loss: 3.2671 - val_accuracy30: 0.3916 - 9s/epoch - 22ms/step
Epoch 9/50
401/401 - 9s - loss: 3.2086 - accuracy30: 0.4129 - val_loss: 3.2630 - val_accuracy30: 0.3926 - 9s/epoch - 22ms/step
Epoch 10/50
401/401 - 9s - loss: 3.2060 - accuracy30: 0.4129 - val_loss: 3.2632 - val_accuracy30: 0.3919 - 9s/epoch - 22ms/step
Epoch 11/50
401/401 - 9s - loss: 3.2010 - accuracy30: 0.4171 - val_loss: 3.2663 - val_accuracy30: 0.3928 - 9s/epoch - 22ms/step
Epoch 12/50
401/401 - 9s - loss: 3.1998 - accuracy30: 0.4173 - val_loss: 3.2610 - val_accuracy30: 0.3920 - 9s/epoch - 22ms/step
Epoch 13/50
401/401 - 9s - loss: 3.1958 - accuracy30: 0.4177 - val_loss: 3.2642 - val_accuracy30: 0.3920 - 9s/epoch - 22ms/step
Epoch 14/50
401/401 - 9s - loss: 3.1945 - accuracy30: 0.4181 - val_loss: 3.2622 - val_accuracy30: 0.3913 - 9s/epoch - 22ms/step
Epoch 15/50
401/401 - 9s - loss: 3.1896 - accuracy30: 0.4208 - val_loss: 3.2663 - val_accuracy30: 0.3900 - 9s/epoch - 22ms/step
Epoch 16/50
401/401 - 9s - loss: 3.1871 - accuracy30: 0.4219 - val_loss: 3.2631 - val_accuracy30: 0.3934 - 9s/epoch - 22ms/step
Epoch 17/50
401/401 - 9s - loss: 3.1843 - accuracy30: 0.4237 - val_loss: 3.2685 - val_accuracy30: 0.3899 - 9s/epoch - 23ms/step
Epoch 18/50
401/401 - 9s - loss: 3.1824 - accuracy30: 0.4244 - val_loss: 3.2663 - val_accuracy30: 0.3931 - 9s/epoch - 22ms/step
Epoch 19/50
401/401 - 9s - loss: 3.1821 - accuracy30: 0.4249 - val_loss: 3.2647 - val_accuracy30: 0.3911 - 9s/epoch - 22ms/step
Epoch 20/50
401/401 - 9s - loss: 3.1778 - accuracy30: 0.4267 - val_loss: 3.2639 - val_accuracy30: 0.3934 - 9s/epoch - 22ms/step
Epoch 21/50
401/401 - 9s - loss: 3.1750 - accuracy30: 0.4270 - val_loss: 3.2680 - val_accuracy30: 0.3948 - 9s/epoch - 22ms/step
Epoch 22/50
401/401 - 9s - loss: 3.1723 - accuracy30: 0.4287 - val_loss: 3.2645 - val_accuracy30: 0.3947 - 9s/epoch - 22ms/step
testing model: results/CHTR/W7/deepOF_L1/h30
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.082447
{'0': {'precision': 0.38038355830649645, 'recall': 0.5791133004926108, 'f1-score': 0.4591681064588464, 'support': 86275}, '1': {'precision': 0.4217408721529129, 'recall': 0.15301482496574062, 'f1-score': 0.2245566457431897, 'support': 96324}, '2': {'precision': 0.4066959954028619, 'recall': 0.48048435743619994, 'f1-score': 0.44052162200771416, 'support': 89851}, 'accuracy': 0.395940539548541, 'macro avg': {'precision': 0.4029401419540904, 'recall': 0.4042041609648504, 'f1-score': 0.37474879140325007, 'support': 272450}, 'weighted avg': {'precision': 0.403682881795165, 'recall': 0.395940539548541, 'f1-score': 0.3700724205847646, 'support': 272450}}
[[49963 10355 25957]
 [44561 14739 37024]
 [36825  9854 43172]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0719706
{'0': {'precision': 0.4096138211382114, 'recall': 0.5666685412214599, 'f1-score': 0.47550847057713186, 'support': 35564}, '1': {'precision': 0.4546595982142857, 'recall': 0.19244737075201512, 'f1-score': 0.27042837879887976, 'support': 33869}, '2': {'precision': 0.4091211377122979, 'recall': 0.481791620229525, 'f1-score': 0.4424925651843143, 'support': 33199}, 'accuracy': 0.41571829448904823, 'macro avg': {'precision': 0.42446485235493164, 'recall': 0.4136358440676667, 'f1-score': 0.3961431381867753, 'support': 102632}, 'weighted avg': {'precision': 0.4243197493743625, 'recall': 0.41571829448904823, 'f1-score': 0.39715130447324837, 'support': 102632}}
[[20153  4268 11143]
 [15393  6518 11958]
 [13654  3550 15995]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.084803
{'0': {'precision': 0.3844485119652905, 'recall': 0.5598775792279593, 'f1-score': 0.45586816720257234, 'support': 10129}, '1': {'precision': 0.3808504129703273, 'recall': 0.1186505289240446, 'f1-score': 0.18093300392384828, 'support': 10493}, '2': {'precision': 0.4064815507821271, 'recall': 0.5047866902128451, 'f1-score': 0.4503316749585406, 'support': 10759}, 'accuracy': 0.3934546381568465, 'macro avg': {'precision': 0.3905934919059149, 'recall': 0.39443826612161637, 'f1-score': 0.36237761536165375, 'support': 31381}, 'weighted avg': {'precision': 0.39079944443640985, 'recall': 0.3934546381568465, 'f1-score': 0.36203872300585493, 'support': 31381}}
[[5671  981 3477]
 [4795 1245 4453]
 [4285 1043 5431]]
training model: results/CHTR/W7/deepOF_L1/h50
Epoch 1/50
401/401 - 11s - loss: 3.3078 - accuracy50: 0.3661 - val_loss: 3.2973 - val_accuracy50: 0.3710 - 11s/epoch - 29ms/step
Epoch 2/50
401/401 - 9s - loss: 3.2728 - accuracy50: 0.3854 - val_loss: 3.2847 - val_accuracy50: 0.3741 - 9s/epoch - 23ms/step
Epoch 3/50
401/401 - 9s - loss: 3.2576 - accuracy50: 0.3913 - val_loss: 3.2833 - val_accuracy50: 0.3747 - 9s/epoch - 23ms/step
Epoch 4/50
401/401 - 9s - loss: 3.2499 - accuracy50: 0.3957 - val_loss: 3.2795 - val_accuracy50: 0.3814 - 9s/epoch - 22ms/step
Epoch 5/50
401/401 - 9s - loss: 3.2420 - accuracy50: 0.3989 - val_loss: 3.2762 - val_accuracy50: 0.3818 - 9s/epoch - 22ms/step
Epoch 6/50
401/401 - 9s - loss: 3.2360 - accuracy50: 0.4019 - val_loss: 3.2753 - val_accuracy50: 0.3836 - 9s/epoch - 22ms/step
Epoch 7/50
401/401 - 9s - loss: 3.2316 - accuracy50: 0.4044 - val_loss: 3.2741 - val_accuracy50: 0.3833 - 9s/epoch - 22ms/step
Epoch 8/50
401/401 - 9s - loss: 3.2271 - accuracy50: 0.4047 - val_loss: 3.2731 - val_accuracy50: 0.3838 - 9s/epoch - 23ms/step
Epoch 9/50
401/401 - 9s - loss: 3.2228 - accuracy50: 0.4058 - val_loss: 3.2732 - val_accuracy50: 0.3858 - 9s/epoch - 22ms/step
Epoch 10/50
401/401 - 9s - loss: 3.2182 - accuracy50: 0.4079 - val_loss: 3.2729 - val_accuracy50: 0.3840 - 9s/epoch - 22ms/step
Epoch 11/50
401/401 - 9s - loss: 3.2147 - accuracy50: 0.4093 - val_loss: 3.2731 - val_accuracy50: 0.3857 - 9s/epoch - 22ms/step
Epoch 12/50
401/401 - 9s - loss: 3.2125 - accuracy50: 0.4114 - val_loss: 3.2724 - val_accuracy50: 0.3827 - 9s/epoch - 22ms/step
Epoch 13/50
401/401 - 9s - loss: 3.2091 - accuracy50: 0.4111 - val_loss: 3.2721 - val_accuracy50: 0.3862 - 9s/epoch - 22ms/step
Epoch 14/50
401/401 - 9s - loss: 3.2056 - accuracy50: 0.4134 - val_loss: 3.2734 - val_accuracy50: 0.3863 - 9s/epoch - 22ms/step
Epoch 15/50
401/401 - 9s - loss: 3.2032 - accuracy50: 0.4144 - val_loss: 3.2730 - val_accuracy50: 0.3835 - 9s/epoch - 21ms/step
Epoch 16/50
401/401 - 9s - loss: 3.1994 - accuracy50: 0.4158 - val_loss: 3.2731 - val_accuracy50: 0.3845 - 9s/epoch - 22ms/step
Epoch 17/50
401/401 - 9s - loss: 3.1981 - accuracy50: 0.4162 - val_loss: 3.2773 - val_accuracy50: 0.3826 - 9s/epoch - 22ms/step
Epoch 18/50
401/401 - 9s - loss: 3.1937 - accuracy50: 0.4189 - val_loss: 3.2752 - val_accuracy50: 0.3850 - 9s/epoch - 23ms/step
Epoch 19/50
401/401 - 9s - loss: 3.1919 - accuracy50: 0.4189 - val_loss: 3.2756 - val_accuracy50: 0.3830 - 9s/epoch - 23ms/step
Epoch 20/50
401/401 - 9s - loss: 3.1904 - accuracy50: 0.4202 - val_loss: 3.2778 - val_accuracy50: 0.3826 - 9s/epoch - 23ms/step
Epoch 21/50
401/401 - 9s - loss: 3.1867 - accuracy50: 0.4234 - val_loss: 3.2772 - val_accuracy50: 0.3818 - 9s/epoch - 22ms/step
Epoch 22/50
401/401 - 9s - loss: 3.1848 - accuracy50: 0.4225 - val_loss: 3.2814 - val_accuracy50: 0.3802 - 9s/epoch - 23ms/step
Epoch 23/50
401/401 - 9s - loss: 3.1801 - accuracy50: 0.4243 - val_loss: 3.2833 - val_accuracy50: 0.3797 - 9s/epoch - 24ms/step
testing model: results/CHTR/W7/deepOF_L1/h50
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0847497
{'0': {'precision': 0.37858760146412623, 'recall': 0.49522371286085554, 'f1-score': 0.42912137796014427, 'support': 85422}, '1': {'precision': 0.39868929198361613, 'recall': 0.178808364124958, 'f1-score': 0.24688924479487495, 'support': 95264}, '2': {'precision': 0.4065397589544522, 'recall': 0.5227104311058803, 'f1-score': 0.45736352800953517, 'support': 91764}, 'accuracy': 0.39384474215452375, 'macro avg': {'precision': 0.3946055508007315, 'recall': 0.398914169363898, 'f1-score': 0.3777913835881848, 'support': 272450}, 'weighted avg': {'precision': 0.3950308726169652, 'recall': 0.39384474215452375, 'f1-score': 0.3749149207139563, 'support': 272450}}
[[42303 13304 29815]
 [38025 17034 40205]
 [31411 12387 47966]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0757929
{'0': {'precision': 0.41119951609901356, 'recall': 0.49657245603191547, 'f1-score': 0.4498714652956298, 'support': 35594}, '1': {'precision': 0.433071795174326, 'recall': 0.2168044890726521, 'f1-score': 0.28895317942965104, 'support': 33860}, '2': {'precision': 0.3942431552568096, 'recall': 0.5073542709024053, 'f1-score': 0.4437034596375618, 'support': 33178}, 'accuracy': 0.4077578143269156, 'macro avg': {'precision': 0.4128381555100497, 'recall': 0.4069104053356576, 'f1-score': 0.3941760347876142, 'support': 102632}, 'weighted avg': {'precision': 0.4129340358342563, 'recall': 0.4077578143269156, 'f1-score': 0.3947879119093037, 'support': 102632}}
[[17675  5279 12640]
 [13295  7341 13224]
 [12014  4331 16833]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.088522
{'0': {'precision': 0.38218996331850463, 'recall': 0.49161730749924704, 'f1-score': 0.4300518134715026, 'support': 9961}, '1': {'precision': 0.36947988223748773, 'recall': 0.14152805187482378, 'f1-score': 0.20466127607528709, 'support': 10641}, '2': {'precision': 0.39511454595638973, 'recall': 0.5312181092865758, 'f1-score': 0.45316766253808716, 'support': 10779}, 'accuracy': 0.38650775947229216, 'macro avg': {'precision': 0.3822614638374607, 'recall': 0.38812115622021554, 'f1-score': 0.3626269173616256, 'support': 31381}, 'weighted avg': {'precision': 0.3823195354631356, 'recall': 0.38650775947229216, 'f1-score': 0.3615640351551833, 'support': 31381}}
[[4897 1285 3779]
 [4148 1506 4987]
 [3768 1285 5726]]
training model: results/CHTR/W7/deepOF_L1/h100
Epoch 1/50
401/401 - 12s - loss: 3.3215 - accuracy100: 0.3550 - val_loss: 3.3031 - val_accuracy100: 0.3609 - 12s/epoch - 29ms/step
Epoch 2/50
401/401 - 10s - loss: 3.2894 - accuracy100: 0.3705 - val_loss: 3.2990 - val_accuracy100: 0.3606 - 10s/epoch - 24ms/step
Epoch 3/50
401/401 - 10s - loss: 3.2761 - accuracy100: 0.3772 - val_loss: 3.2966 - val_accuracy100: 0.3624 - 10s/epoch - 24ms/step
Epoch 4/50
401/401 - 9s - loss: 3.2680 - accuracy100: 0.3798 - val_loss: 3.2892 - val_accuracy100: 0.3658 - 9s/epoch - 24ms/step
Epoch 5/50
401/401 - 9s - loss: 3.2602 - accuracy100: 0.3821 - val_loss: 3.2872 - val_accuracy100: 0.3714 - 9s/epoch - 23ms/step
Epoch 6/50
401/401 - 9s - loss: 3.2557 - accuracy100: 0.3860 - val_loss: 3.2847 - val_accuracy100: 0.3715 - 9s/epoch - 22ms/step
Epoch 7/50
401/401 - 9s - loss: 3.2533 - accuracy100: 0.3852 - val_loss: 3.2854 - val_accuracy100: 0.3734 - 9s/epoch - 23ms/step
Epoch 8/50
401/401 - 9s - loss: 3.2478 - accuracy100: 0.3908 - val_loss: 3.2865 - val_accuracy100: 0.3723 - 9s/epoch - 23ms/step
Epoch 9/50
401/401 - 9s - loss: 3.2441 - accuracy100: 0.3924 - val_loss: 3.2875 - val_accuracy100: 0.3709 - 9s/epoch - 23ms/step
Epoch 10/50
401/401 - 9s - loss: 3.2403 - accuracy100: 0.3919 - val_loss: 3.2860 - val_accuracy100: 0.3692 - 9s/epoch - 23ms/step
Epoch 11/50
401/401 - 9s - loss: 3.2378 - accuracy100: 0.3959 - val_loss: 3.2857 - val_accuracy100: 0.3734 - 9s/epoch - 23ms/step
Epoch 12/50
401/401 - 9s - loss: 3.2347 - accuracy100: 0.3962 - val_loss: 3.2854 - val_accuracy100: 0.3739 - 9s/epoch - 23ms/step
Epoch 13/50
401/401 - 9s - loss: 3.2326 - accuracy100: 0.3975 - val_loss: 3.2846 - val_accuracy100: 0.3730 - 9s/epoch - 23ms/step
Epoch 14/50
401/401 - 9s - loss: 3.2307 - accuracy100: 0.3989 - val_loss: 3.2855 - val_accuracy100: 0.3747 - 9s/epoch - 23ms/step
Epoch 15/50
401/401 - 9s - loss: 3.2275 - accuracy100: 0.3998 - val_loss: 3.2873 - val_accuracy100: 0.3734 - 9s/epoch - 22ms/step
Epoch 16/50
401/401 - 9s - loss: 3.2250 - accuracy100: 0.4000 - val_loss: 3.2872 - val_accuracy100: 0.3702 - 9s/epoch - 23ms/step
Epoch 17/50
401/401 - 9s - loss: 3.2217 - accuracy100: 0.4037 - val_loss: 3.2879 - val_accuracy100: 0.3710 - 9s/epoch - 22ms/step
Epoch 18/50
401/401 - 9s - loss: 3.2204 - accuracy100: 0.4041 - val_loss: 3.2866 - val_accuracy100: 0.3732 - 9s/epoch - 23ms/step
Epoch 19/50
401/401 - 9s - loss: 3.2154 - accuracy100: 0.4053 - val_loss: 3.2866 - val_accuracy100: 0.3709 - 9s/epoch - 23ms/step
Epoch 20/50
401/401 - 9s - loss: 3.2146 - accuracy100: 0.4055 - val_loss: 3.2865 - val_accuracy100: 0.3742 - 9s/epoch - 23ms/step
Epoch 21/50
401/401 - 9s - loss: 3.2122 - accuracy100: 0.4059 - val_loss: 3.2900 - val_accuracy100: 0.3689 - 9s/epoch - 23ms/step
Epoch 22/50
401/401 - 9s - loss: 3.2092 - accuracy100: 0.4082 - val_loss: 3.2908 - val_accuracy100: 0.3695 - 9s/epoch - 22ms/step
Epoch 23/50
401/401 - 9s - loss: 3.2074 - accuracy100: 0.4080 - val_loss: 3.2914 - val_accuracy100: 0.3677 - 9s/epoch - 22ms/step
testing model: results/CHTR/W7/deepOF_L1/h100
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0921142
{'0': {'precision': 0.3631036265752841, 'recall': 0.4222502564344412, 'f1-score': 0.3904497138184791, 'support': 84817}, '1': {'precision': 0.3510386071693974, 'recall': 0.21124586079494032, 'f1-score': 0.26376489826306027, 'support': 93919}, '2': {'precision': 0.39649954390063, 'recall': 0.49628657404443305, 'f1-score': 0.4408164425888452, 'support': 93714}, 'accuracy': 0.3749788952101303, 'macro avg': {'precision': 0.3702139258817705, 'recall': 0.3765942304246048, 'f1-score': 0.36501035155679484, 'support': 272450}, 'weighted avg': {'precision': 0.3704316883798207, 'recall': 0.3749788952101303, 'f1-score': 0.3641034353374246, 'support': 272450}}
[[35814 17821 31182]
 [34471 19840 39608]
 [28348 18857 46509]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0832487
{'0': {'precision': 0.4056894991750492, 'recall': 0.4279418369638446, 'f1-score': 0.4165186743531597, 'support': 35624}, '1': {'precision': 0.39149158818320856, 'recall': 0.28839539848197343, 'f1-score': 0.3321268822344385, 'support': 33728}, '2': {'precision': 0.387858137684043, 'recall': 0.46859975961538464, 'f1-score': 0.424423035053342, 'support': 33280}, 'accuracy': 0.3952665835217086, 'macro avg': {'precision': 0.39501307501410027, 'recall': 0.3949789983537342, 'f1-score': 0.39102286388031343, 'support': 102632}, 'weighted avg': {'precision': 0.39524154091297214, 'recall': 0.3952665835217086, 'f1-score': 0.3913480721971249, 'support': 102632}}
[[15245  8113 12266]
 [11654  9727 12347]
 [10679  7006 15595]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0931358
{'0': {'precision': 0.3682373472949389, 'recall': 0.3892589935430973, 'f1-score': 0.3784564794977829, 'support': 9757}, '1': {'precision': 0.3497601395551679, 'recall': 0.22708824917413875, 'f1-score': 0.27538056541146844, 'support': 10595}, '2': {'precision': 0.392232872850296, 'recall': 0.5045788376099375, 'f1-score': 0.4413689177935519, 'support': 11029}, 'accuracy': 0.3750358497179822, 'macro avg': {'precision': 0.37007678656680093, 'recall': 0.37364202677572456, 'f1-score': 0.36506865423426776, 'support': 31381}, 'weighted avg': {'precision': 0.37043232627416706, 'recall': 0.3750358497179822, 'f1-score': 0.36576637950796526, 'support': 31381}}
[[3798 2160 3799]
 [3365 2406 4824]
 [3151 2313 5565]]
training model: results/CHTR/W7/deepOF_L1/h200
Epoch 1/50
401/401 - 12s - loss: 3.3333 - accuracy200: 0.3456 - val_loss: 3.3128 - val_accuracy200: 0.3557 - 12s/epoch - 29ms/step
Epoch 2/50
401/401 - 9s - loss: 3.2999 - accuracy200: 0.3629 - val_loss: 3.3008 - val_accuracy200: 0.3590 - 9s/epoch - 23ms/step
Epoch 3/50
401/401 - 9s - loss: 3.2877 - accuracy200: 0.3668 - val_loss: 3.3017 - val_accuracy200: 0.3578 - 9s/epoch - 23ms/step
Epoch 4/50
401/401 - 9s - loss: 3.2846 - accuracy200: 0.3666 - val_loss: 3.2951 - val_accuracy200: 0.3599 - 9s/epoch - 23ms/step
Epoch 5/50
401/401 - 10s - loss: 3.2777 - accuracy200: 0.3700 - val_loss: 3.2935 - val_accuracy200: 0.3610 - 10s/epoch - 24ms/step
Epoch 6/50
401/401 - 9s - loss: 3.2720 - accuracy200: 0.3735 - val_loss: 3.2933 - val_accuracy200: 0.3603 - 9s/epoch - 23ms/step
Epoch 7/50
401/401 - 9s - loss: 3.2694 - accuracy200: 0.3750 - val_loss: 3.2903 - val_accuracy200: 0.3642 - 9s/epoch - 23ms/step
Epoch 8/50
401/401 - 9s - loss: 3.2646 - accuracy200: 0.3781 - val_loss: 3.2906 - val_accuracy200: 0.3667 - 9s/epoch - 22ms/step
Epoch 9/50
401/401 - 9s - loss: 3.2614 - accuracy200: 0.3782 - val_loss: 3.2921 - val_accuracy200: 0.3639 - 9s/epoch - 21ms/step
Epoch 10/50
401/401 - 9s - loss: 3.2587 - accuracy200: 0.3812 - val_loss: 3.2897 - val_accuracy200: 0.3675 - 9s/epoch - 22ms/step
Epoch 11/50
401/401 - 9s - loss: 3.2558 - accuracy200: 0.3829 - val_loss: 3.2901 - val_accuracy200: 0.3675 - 9s/epoch - 23ms/step
Epoch 12/50
401/401 - 9s - loss: 3.2528 - accuracy200: 0.3846 - val_loss: 3.2915 - val_accuracy200: 0.3612 - 9s/epoch - 23ms/step
Epoch 13/50
401/401 - 9s - loss: 3.2502 - accuracy200: 0.3857 - val_loss: 3.2916 - val_accuracy200: 0.3649 - 9s/epoch - 23ms/step
Epoch 14/50
401/401 - 9s - loss: 3.2475 - accuracy200: 0.3864 - val_loss: 3.2925 - val_accuracy200: 0.3635 - 9s/epoch - 22ms/step
Epoch 15/50
401/401 - 9s - loss: 3.2459 - accuracy200: 0.3876 - val_loss: 3.2893 - val_accuracy200: 0.3681 - 9s/epoch - 23ms/step
Epoch 16/50
401/401 - 9s - loss: 3.2424 - accuracy200: 0.3899 - val_loss: 3.2905 - val_accuracy200: 0.3631 - 9s/epoch - 22ms/step
Epoch 17/50
401/401 - 9s - loss: 3.2390 - accuracy200: 0.3918 - val_loss: 3.2917 - val_accuracy200: 0.3634 - 9s/epoch - 23ms/step
Epoch 18/50
401/401 - 9s - loss: 3.2369 - accuracy200: 0.3920 - val_loss: 3.2908 - val_accuracy200: 0.3656 - 9s/epoch - 23ms/step
Epoch 19/50
401/401 - 9s - loss: 3.2349 - accuracy200: 0.3941 - val_loss: 3.2932 - val_accuracy200: 0.3658 - 9s/epoch - 23ms/step
Epoch 20/50
401/401 - 9s - loss: 3.2330 - accuracy200: 0.3943 - val_loss: 3.2925 - val_accuracy200: 0.3616 - 9s/epoch - 22ms/step
Epoch 21/50
401/401 - 9s - loss: 3.2312 - accuracy200: 0.3964 - val_loss: 3.2963 - val_accuracy200: 0.3646 - 9s/epoch - 22ms/step
Epoch 22/50
401/401 - 9s - loss: 3.2274 - accuracy200: 0.3972 - val_loss: 3.2961 - val_accuracy200: 0.3616 - 9s/epoch - 22ms/step
Epoch 23/50
401/401 - 9s - loss: 3.2265 - accuracy200: 0.3986 - val_loss: 3.2958 - val_accuracy200: 0.3635 - 9s/epoch - 22ms/step
Epoch 24/50
401/401 - 9s - loss: 3.2240 - accuracy200: 0.3974 - val_loss: 3.2944 - val_accuracy200: 0.3659 - 9s/epoch - 23ms/step
Epoch 25/50
401/401 - 9s - loss: 3.2194 - accuracy200: 0.4015 - val_loss: 3.3011 - val_accuracy200: 0.3606 - 9s/epoch - 22ms/step
testing model: results/CHTR/W7/deepOF_L1/h200
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0974698
{'0': {'precision': 0.33320664631756475, 'recall': 0.3413307702602411, 'f1-score': 0.3372197848428391, 'support': 82193}, '1': {'precision': 0.3452038442703232, 'recall': 0.2390702998314839, 'f1-score': 0.2824974796019962, 'support': 94353}, '2': {'precision': 0.38239673254196194, 'recall': 0.4900734067400734, 'f1-score': 0.42959056363195974, 'support': 95904}, 'accuracy': 0.35827491282804186, 'macro avg': {'precision': 0.35360240770994994, 'recall': 0.35682482561059947, 'f1-score': 0.3497692760255984, 'support': 272450}, 'weighted avg': {'precision': 0.35467663217809403, 'recall': 0.35827491282804186, 'f1-score': 0.3507837910920686, 'support': 272450}}
[[28055 19749 34389]
 [30276 22557 41520]
 [25866 23038 47000]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0879272
{'0': {'precision': 0.40039162814586543, 'recall': 0.35216556553165057, 'f1-score': 0.37473336337689656, 'support': 35418}, '1': {'precision': 0.38367166488597426, 'recall': 0.307578711087483, 'f1-score': 0.3414370256225308, 'support': 33858}, '2': {'precision': 0.3692175835081309, 'recall': 0.49076627893032737, 'f1-score': 0.42140218552507946, 'support': 33356}, 'accuracy': 0.3825025333229402, 'macro avg': {'precision': 0.38442695884665684, 'recall': 0.383503518516487, 'f1-score': 0.37919085817483555, 'support': 102632}, 'weighted avg': {'precision': 0.3847440138638709, 'recall': 0.3825025333229402, 'f1-score': 0.37891663787108426, 'support': 102632}}
[[12473  8726 14219]
 [ 9696 10414 13748]
 [ 8983  8003 16370]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0952882
{'0': {'precision': 0.35352544451256895, 'recall': 0.30546726001271457, 'f1-score': 0.32774398908656854, 'support': 9438}, '1': {'precision': 0.33596435391470403, 'recall': 0.24732895970009372, 'f1-score': 0.2849122807017544, 'support': 10670}, '2': {'precision': 0.38533602237980613, 'recall': 0.5254147077086845, 'f1-score': 0.4446029124756043, 'support': 11273}, 'accuracy': 0.3647111309391033, 'macro avg': {'precision': 0.3582752736023597, 'recall': 0.35940364247383094, 'f1-score': 0.35241972742130906, 'support': 31381}, 'weighted avg': {'precision': 0.35898173359252644, 'recall': 0.3647111309391033, 'f1-score': 0.3551598239834371, 'support': 31381}}
[[2883 2461 4094]
 [2677 2639 5354]
 [2595 2755 5923]]
training model: results/CHTR/W7/deepOF_L1/h300
Epoch 1/50
401/401 - 11s - loss: 3.3363 - accuracy300: 0.3454 - val_loss: 3.3083 - val_accuracy300: 0.3521 - 11s/epoch - 27ms/step
Epoch 2/50
401/401 - 9s - loss: 3.3074 - accuracy300: 0.3568 - val_loss: 3.3026 - val_accuracy300: 0.3566 - 9s/epoch - 23ms/step
Epoch 3/50
401/401 - 9s - loss: 3.2941 - accuracy300: 0.3640 - val_loss: 3.2975 - val_accuracy300: 0.3549 - 9s/epoch - 23ms/step
Epoch 4/50
401/401 - 9s - loss: 3.2885 - accuracy300: 0.3652 - val_loss: 3.2908 - val_accuracy300: 0.3615 - 9s/epoch - 23ms/step
Epoch 5/50
401/401 - 9s - loss: 3.2830 - accuracy300: 0.3653 - val_loss: 3.2909 - val_accuracy300: 0.3597 - 9s/epoch - 22ms/step
Epoch 6/50
401/401 - 9s - loss: 3.2789 - accuracy300: 0.3678 - val_loss: 3.2888 - val_accuracy300: 0.3641 - 9s/epoch - 23ms/step
Epoch 7/50
401/401 - 9s - loss: 3.2752 - accuracy300: 0.3684 - val_loss: 3.2871 - val_accuracy300: 0.3637 - 9s/epoch - 23ms/step
Epoch 8/50
401/401 - 9s - loss: 3.2730 - accuracy300: 0.3712 - val_loss: 3.2857 - val_accuracy300: 0.3646 - 9s/epoch - 23ms/step
Epoch 9/50
401/401 - 9s - loss: 3.2693 - accuracy300: 0.3735 - val_loss: 3.2854 - val_accuracy300: 0.3659 - 9s/epoch - 23ms/step
Epoch 10/50
401/401 - 9s - loss: 3.2672 - accuracy300: 0.3754 - val_loss: 3.2861 - val_accuracy300: 0.3646 - 9s/epoch - 22ms/step
Epoch 11/50
401/401 - 9s - loss: 3.2642 - accuracy300: 0.3771 - val_loss: 3.2870 - val_accuracy300: 0.3672 - 9s/epoch - 22ms/step
Epoch 12/50
401/401 - 9s - loss: 3.2616 - accuracy300: 0.3787 - val_loss: 3.2854 - val_accuracy300: 0.3644 - 9s/epoch - 23ms/step
Epoch 13/50
401/401 - 9s - loss: 3.2592 - accuracy300: 0.3797 - val_loss: 3.2875 - val_accuracy300: 0.3658 - 9s/epoch - 23ms/step
Epoch 14/50
401/401 - 9s - loss: 3.2583 - accuracy300: 0.3797 - val_loss: 3.2858 - val_accuracy300: 0.3668 - 9s/epoch - 23ms/step
Epoch 15/50
401/401 - 8s - loss: 3.2555 - accuracy300: 0.3824 - val_loss: 3.2867 - val_accuracy300: 0.3652 - 8s/epoch - 21ms/step
Epoch 16/50
401/401 - 9s - loss: 3.2534 - accuracy300: 0.3833 - val_loss: 3.2879 - val_accuracy300: 0.3646 - 9s/epoch - 22ms/step
Epoch 17/50
401/401 - 9s - loss: 3.2510 - accuracy300: 0.3853 - val_loss: 3.2869 - val_accuracy300: 0.3679 - 9s/epoch - 23ms/step
Epoch 18/50
401/401 - 9s - loss: 3.2476 - accuracy300: 0.3861 - val_loss: 3.2875 - val_accuracy300: 0.3653 - 9s/epoch - 23ms/step
Epoch 19/50
401/401 - 9s - loss: 3.2453 - accuracy300: 0.3892 - val_loss: 3.2902 - val_accuracy300: 0.3634 - 9s/epoch - 23ms/step
Epoch 20/50
401/401 - 9s - loss: 3.2445 - accuracy300: 0.3893 - val_loss: 3.2890 - val_accuracy300: 0.3641 - 9s/epoch - 22ms/step
Epoch 21/50
401/401 - 9s - loss: 3.2430 - accuracy300: 0.3905 - val_loss: 3.2870 - val_accuracy300: 0.3659 - 9s/epoch - 22ms/step
Epoch 22/50
401/401 - 9s - loss: 3.2395 - accuracy300: 0.3916 - val_loss: 3.2907 - val_accuracy300: 0.3661 - 9s/epoch - 22ms/step
testing model: results/CHTR/W7/deepOF_L1/h300
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991012
{'0': {'precision': 0.32140459350164724, 'recall': 0.2522826153563331, 'f1-score': 0.2826794468628555, 'support': 81595}, '1': {'precision': 0.3357571321739407, 'recall': 0.22688126955455923, 'f1-score': 0.2707849452706951, 'support': 93009}, '2': {'precision': 0.37518034543880624, 'recall': 0.5581117265907651, 'f1-score': 0.4487181594083813, 'support': 97846}, 'accuracy': 0.353444668746559, 'macro avg': {'precision': 0.3441140237047981, 'recall': 0.34575853716721916, 'f1-score': 0.33406085051397727, 'support': 272450}, 'weighted avg': {'precision': 0.3456169535435433, 'recall': 0.353444668746559, 'f1-score': 0.3382490125414911, 'support': 272450}}
[[20585 19042 41968]
 [22930 21102 48977]
 [20532 22705 54609]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0929253
{'0': {'precision': 0.4017747996559062, 'recall': 0.25169469892503615, 'f1-score': 0.30950055803571425, 'support': 35257}, '1': {'precision': 0.3761294770838625, 'recall': 0.3062309805891216, 'f1-score': 0.3376001563416064, 'support': 33847}, '2': {'precision': 0.3593832565863969, 'recall': 0.5679730374612264, 'f1-score': 0.4402191502149891, 'support': 33528}, 'accuracy': 0.3730025722971393, 'macro avg': {'precision': 0.3790958444420552, 'recall': 0.37529957232512806, 'f1-score': 0.36243995486410324, 'support': 102632}, 'weighted avg': {'precision': 0.37946868763304326, 'recall': 0.3730025722971393, 'f1-score': 0.36147089927866244, 'support': 102632}}
[[ 8874  9022 17361]
 [ 6898 10365 16584]
 [ 6315  8170 19043]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0939437
{'0': {'precision': 0.3624930645459589, 'recall': 0.20771513353115728, 'f1-score': 0.2640975544027488, 'support': 9436}, '1': {'precision': 0.34270021714139737, 'recall': 0.2558893657606104, 'f1-score': 0.29299989079392813, 'support': 10485}, '2': {'precision': 0.38297051529346926, 'recall': 0.606369982547993, 'f1-score': 0.46944772842425264, 'support': 11460}, 'accuracy': 0.3693954940887798, 'macro avg': {'precision': 0.3627212656602752, 'recall': 0.35665816061325356, 'f1-score': 0.3421817245403099, 'support': 31381}, 'weighted avg': {'precision': 0.3633580331744169, 'recall': 0.3693954940887798, 'f1-score': 0.3487460356923173, 'support': 31381}}
[[1960 2357 5119]
 [1725 2683 6077]
 [1722 2789 6949]]
training model: results/CHTR/W7/deepOF_L1/h500
Epoch 1/50
401/401 - 11s - loss: 3.3421 - accuracy500: 0.3451 - val_loss: 3.2998 - val_accuracy500: 0.3524 - 11s/epoch - 28ms/step
Epoch 2/50
401/401 - 9s - loss: 3.3121 - accuracy500: 0.3559 - val_loss: 3.2917 - val_accuracy500: 0.3601 - 9s/epoch - 23ms/step
Epoch 3/50
401/401 - 9s - loss: 3.3027 - accuracy500: 0.3552 - val_loss: 3.2919 - val_accuracy500: 0.3595 - 9s/epoch - 23ms/step
Epoch 4/50
401/401 - 9s - loss: 3.2960 - accuracy500: 0.3569 - val_loss: 3.2865 - val_accuracy500: 0.3685 - 9s/epoch - 22ms/step
Epoch 5/50
401/401 - 9s - loss: 3.2899 - accuracy500: 0.3621 - val_loss: 3.2861 - val_accuracy500: 0.3709 - 9s/epoch - 23ms/step
Epoch 6/50
401/401 - 9s - loss: 3.2863 - accuracy500: 0.3636 - val_loss: 3.2842 - val_accuracy500: 0.3748 - 9s/epoch - 23ms/step
Epoch 7/50
401/401 - 9s - loss: 3.2847 - accuracy500: 0.3650 - val_loss: 3.2841 - val_accuracy500: 0.3736 - 9s/epoch - 23ms/step
Epoch 8/50
401/401 - 9s - loss: 3.2826 - accuracy500: 0.3657 - val_loss: 3.2824 - val_accuracy500: 0.3736 - 9s/epoch - 23ms/step
Epoch 9/50
401/401 - 9s - loss: 3.2795 - accuracy500: 0.3670 - val_loss: 3.2826 - val_accuracy500: 0.3764 - 9s/epoch - 22ms/step
Epoch 10/50
401/401 - 9s - loss: 3.2779 - accuracy500: 0.3671 - val_loss: 3.2824 - val_accuracy500: 0.3755 - 9s/epoch - 23ms/step
Epoch 11/50
401/401 - 9s - loss: 3.2764 - accuracy500: 0.3683 - val_loss: 3.2827 - val_accuracy500: 0.3762 - 9s/epoch - 22ms/step
Epoch 12/50
401/401 - 9s - loss: 3.2742 - accuracy500: 0.3704 - val_loss: 3.2819 - val_accuracy500: 0.3747 - 9s/epoch - 22ms/step
Epoch 13/50
401/401 - 9s - loss: 3.2714 - accuracy500: 0.3737 - val_loss: 3.2816 - val_accuracy500: 0.3755 - 9s/epoch - 23ms/step
Epoch 14/50
401/401 - 9s - loss: 3.2703 - accuracy500: 0.3719 - val_loss: 3.2826 - val_accuracy500: 0.3756 - 9s/epoch - 23ms/step
Epoch 15/50
401/401 - 9s - loss: 3.2680 - accuracy500: 0.3731 - val_loss: 3.2827 - val_accuracy500: 0.3731 - 9s/epoch - 23ms/step
Epoch 16/50
401/401 - 9s - loss: 3.2672 - accuracy500: 0.3759 - val_loss: 3.2830 - val_accuracy500: 0.3741 - 9s/epoch - 23ms/step
Epoch 17/50
401/401 - 9s - loss: 3.2640 - accuracy500: 0.3794 - val_loss: 3.2845 - val_accuracy500: 0.3718 - 9s/epoch - 23ms/step
Epoch 18/50
401/401 - 9s - loss: 3.2623 - accuracy500: 0.3788 - val_loss: 3.2858 - val_accuracy500: 0.3722 - 9s/epoch - 23ms/step
Epoch 19/50
401/401 - 9s - loss: 3.2600 - accuracy500: 0.3792 - val_loss: 3.2846 - val_accuracy500: 0.3728 - 9s/epoch - 22ms/step
Epoch 20/50
401/401 - 9s - loss: 3.2578 - accuracy500: 0.3811 - val_loss: 3.2859 - val_accuracy500: 0.3704 - 9s/epoch - 22ms/step
Epoch 21/50
401/401 - 9s - loss: 3.2555 - accuracy500: 0.3849 - val_loss: 3.2869 - val_accuracy500: 0.3697 - 9s/epoch - 22ms/step
Epoch 22/50
401/401 - 9s - loss: 3.2533 - accuracy500: 0.3841 - val_loss: 3.2908 - val_accuracy500: 0.3667 - 9s/epoch - 22ms/step
Epoch 23/50
401/401 - 9s - loss: 3.2516 - accuracy500: 0.3848 - val_loss: 3.2867 - val_accuracy500: 0.3695 - 9s/epoch - 22ms/step
testing model: results/CHTR/W7/deepOF_L1/h500
Evaluating performance on  test set...
1065/1065 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0979801
{'0': {'precision': 0.3035467526485491, 'recall': 0.07411711779260703, 'f1-score': 0.11914303793654141, 'support': 80022}, '1': {'precision': 0.35347040928606877, 'recall': 0.1745416191683624, 'f1-score': 0.23368898525090576, 'support': 93863}, '2': {'precision': 0.3646701716675865, 'recall': 0.7642367980520469, 'f1-score': 0.49374195007324817, 'support': 98565}, 'accuracy': 0.3583813543769499, 'macro avg': {'precision': 0.3405624445340681, 'recall': 0.3376318450043388, 'f1-score': 0.2821913244202318, 'support': 272450}, 'weighted avg': {'precision': 0.3428589713256603, 'recall': 0.3583813543769499, 'f1-score': 0.29412548619318546, 'support': 272450}}
[[ 5931 13347 60744]
 [ 6989 16383 70491]
 [ 6619 16619 75327]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0973964
{'0': {'precision': 0.4213410237923576, 'recall': 0.0836985477356707, 'f1-score': 0.1396549252019309, 'support': 34911}, '1': {'precision': 0.38250600480384306, 'recall': 0.22517453677791852, 'f1-score': 0.2834733270289815, 'support': 33947}, '2': {'precision': 0.34482849708768637, 'recall': 0.773020666785101, 'f1-score': 0.47691506754226526, 'support': 33774}, 'accuracy': 0.3573349442668953, 'macro avg': {'precision': 0.382891841894629, 'recall': 0.36063125043289673, 'f1-score': 0.30001443992439253, 'support': 102632}, 'weighted avg': {'precision': 0.3833171475497952, 'recall': 0.3573349442668953, 'f1-score': 0.29821002823242176, 'support': 102632}}
[[ 2922  6649 25340]
 [ 2038  7644 24265]
 [ 1975  5691 26108]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.09372
{'0': {'precision': 0.34765875561257215, 'recall': 0.057221283783783786, 'f1-score': 0.09826851600036261, 'support': 9472}, '1': {'precision': 0.3244125326370757, 'recall': 0.14954864593781345, 'f1-score': 0.20472332829877796, 'support': 9970}, '2': {'precision': 0.3862284944105288, 'recall': 0.8160649970684312, 'f1-score': 0.5243105071976321, 'support': 11939}, 'accuracy': 0.3752589146298716, 'macro avg': {'precision': 0.35276659422005885, 'recall': 0.3409449755966761, 'f1-score': 0.2757674504989242, 'support': 31381}, 'weighted avg': {'precision': 0.35494721896438075, 'recall': 0.3752589146298716, 'f1-score': 0.29417909283090976, 'support': 31381}}
[[ 542 1424 7506]
 [ 502 1491 7977]
 [ 515 1681 9743]]
training model: results/CHTR/W7/deepOF_L1/h1000
Epoch 1/50
401/401 - 11s - loss: 3.3418 - accuracy1000: 0.3491 - val_loss: 3.3245 - val_accuracy1000: 0.3400 - 11s/epoch - 29ms/step
Epoch 2/50
401/401 - 9s - loss: 3.3192 - accuracy1000: 0.3540 - val_loss: 3.3114 - val_accuracy1000: 0.3491 - 9s/epoch - 23ms/step
Epoch 3/50
401/401 - 9s - loss: 3.3095 - accuracy1000: 0.3545 - val_loss: 3.3083 - val_accuracy1000: 0.3530 - 9s/epoch - 23ms/step
Epoch 4/50
401/401 - 9s - loss: 3.3024 - accuracy1000: 0.3552 - val_loss: 3.3045 - val_accuracy1000: 0.3553 - 9s/epoch - 23ms/step
Epoch 5/50
401/401 - 9s - loss: 3.2995 - accuracy1000: 0.3552 - val_loss: 3.2998 - val_accuracy1000: 0.3662 - 9s/epoch - 22ms/step
Epoch 6/50
401/401 - 9s - loss: 3.2964 - accuracy1000: 0.3570 - val_loss: 3.2953 - val_accuracy1000: 0.3769 - 9s/epoch - 23ms/step
Epoch 7/50
401/401 - 9s - loss: 3.2930 - accuracy1000: 0.3594 - val_loss: 3.2942 - val_accuracy1000: 0.3800 - 9s/epoch - 22ms/step
Epoch 8/50
401/401 - 9s - loss: 3.2912 - accuracy1000: 0.3602 - val_loss: 3.2900 - val_accuracy1000: 0.3840 - 9s/epoch - 22ms/step
Epoch 9/50
401/401 - 9s - loss: 3.2881 - accuracy1000: 0.3624 - val_loss: 3.2882 - val_accuracy1000: 0.3857 - 9s/epoch - 22ms/step
Epoch 10/50
401/401 - 9s - loss: 3.2867 - accuracy1000: 0.3620 - val_loss: 3.2875 - val_accuracy1000: 0.3832 - 9s/epoch - 22ms/step
Epoch 11/50
401/401 - 9s - loss: 3.2855 - accuracy1000: 0.3622 - val_loss: 3.2864 - val_accuracy1000: 0.3843 - 9s/epoch - 22ms/step
Epoch 12/50
401/401 - 9s - loss: 3.2849 - accuracy1000: 0.3645 - val_loss: 3.2851 - val_accuracy1000: 0.3838 - 9s/epoch - 22ms/step
Epoch 13/50
401/401 - 9s - loss: 3.2838 - accuracy1000: 0.3642 - val_loss: 3.2853 - val_accuracy1000: 0.3840 - 9s/epoch - 22ms/step
Epoch 14/50
401/401 - 9s - loss: 3.2817 - accuracy1000: 0.3655 - val_loss: 3.2871 - val_accuracy1000: 0.3802 - 9s/epoch - 22ms/step
Epoch 15/50
401/401 - 9s - loss: 3.2796 - accuracy1000: 0.3678 - val_loss: 3.2870 - val_accuracy1000: 0.3817 - 9s/epoch - 23ms/step
Epoch 16/50
401/401 - 9s - loss: 3.2793 - accuracy1000: 0.3680 - val_loss: 3.2852 - val_accuracy1000: 0.3820 - 9s/epoch - 22ms/step
Epoch 17/50
401/401 - 9s - loss: 3.2764 - accuracy1000: 0.3719 - val_loss: 3.2855 - val_accuracy1000: 0.3812 - 9s/epoch - 22ms/step
Epoch 18/50
401/401 - 9s - loss: 3.2760 - accuracy1000: 0.3697 - val_loss: 3.2852 - val_accuracy1000: 0.3794 - 9s/epoch - 22ms/step
Epoch 19/50
401/401 - 9s - loss: 3.2743 - accuracy1000: 0.3725 - val_loss: 3.2860 - val_accuracy1000: 0.3809 - 9s/epoch - 23ms/step
Epoch 20/50
401/401 - 9s - loss: 3.2737 - accuracy1000: 0.3717 - val_loss: 3.2869 - val_accuracy1000: 0.3808 - 9s/epoch - 23ms/step
Epoch 21/50
401/401 - 9s - loss: 3.2720 - accuracy1000: 0.3743 - val_loss: 3.2894 - val_accuracy1000: 0.3780 - 9s/epoch - 23ms/step
Epoch 22/50
401/401 - 9s - loss: 3.2715 - accuracy1000: 0.3743 - val_loss: 3.2879 - val_accuracy1000: 0.3811 - 9s/epoch - 23ms/step
testing model: results/CHTR/W7/deepOF_L1/h1000
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0950924
{'0': {'precision': 0.27372699019842217, 'recall': 0.015022895154624296, 'f1-score': 0.02848258706467661, 'support': 76217}, '1': {'precision': 0.35831167223666294, 'recall': 0.15178908511263056, 'f1-score': 0.21324336468976288, 'support': 95356}, '2': {'precision': 0.3713093315545569, 'recall': 0.8387541263122417, 'f1-score': 0.5147452920008883, 'support': 100877}, 'accuracy': 0.3678840154156726, 'macro avg': {'precision': 0.33444933132988064, 'recall': 0.3351887021931655, 'f1-score': 0.2521570812517759, 'support': 272450}, 'weighted avg': {'precision': 0.33946188023116686, 'recall': 0.3678840154156726, 'f1-score': 0.2731908696745792, 'support': 272450}}
[[ 1145 11082 63990]
 [ 1611 14474 79271]
 [ 1427 14839 84611]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1109644
{'0': {'precision': 0.4465795541890853, 'recall': 0.016243115546982025, 'f1-score': 0.03134610196924737, 'support': 35769}, '1': {'precision': 0.3708107442089699, 'recall': 0.17769839395370807, 'f1-score': 0.24026025866198306, 'support': 33872}, '2': {'precision': 0.3313317430287077, 'recall': 0.8546573307871844, 'f1-score': 0.47753408417308824, 'support': 32991}, 'accuracy': 0.33903655779873726, 'macro avg': {'precision': 0.38290734714225433, 'recall': 0.34953294676262486, 'f1-score': 0.24971348160143955, 'support': 102632}, 'weighted avg': {'precision': 0.3845269617263204, 'recall': 0.33903655779873726, 'f1-score': 0.24372165770608634, 'support': 102632}}
[[  581  5760 29428]
 [  378  6019 27475]
 [  342  4453 28196]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0965886
{'0': {'precision': 0.40977443609022557, 'recall': 0.011281308217760298, 'f1-score': 0.021958098307816278, 'support': 9662}, '1': {'precision': 0.30357679591223324, 'recall': 0.10652884716802025, 'f1-score': 0.1577139287945034, 'support': 9481}, '2': {'precision': 0.3922916366777026, 'recall': 0.8907501225690472, 'f1-score': 0.5446959476340378, 'support': 12238}, 'accuracy': 0.383034320130015, 'macro avg': {'precision': 0.3685476228933872, 'recall': 0.3361867593182759, 'f1-score': 0.24145599157878583, 'support': 31381}, 'weighted avg': {'precision': 0.3708714589467948, 'recall': 0.383034320130015, 'f1-score': 0.2668313282526421, 'support': 31381}}
[[  109  1069  8484]
 [   68  1010  8403]
 [   89  1248 10901]]
training model: results/CHTR/W7/deepLOB_L2/h10
Epoch 1/50
401/401 - 22s - loss: 3.3354 - accuracy10: 0.3534 - val_loss: 3.3622 - val_accuracy10: 0.3429 - 22s/epoch - 56ms/step
Epoch 2/50
401/401 - 20s - loss: 3.2954 - accuracy10: 0.3658 - val_loss: 3.3266 - val_accuracy10: 0.3538 - 20s/epoch - 49ms/step
Epoch 3/50
401/401 - 19s - loss: 3.2763 - accuracy10: 0.3783 - val_loss: 3.3271 - val_accuracy10: 0.3572 - 19s/epoch - 48ms/step
Epoch 4/50
401/401 - 19s - loss: 3.2596 - accuracy10: 0.3866 - val_loss: 3.3086 - val_accuracy10: 0.3685 - 19s/epoch - 48ms/step
Epoch 5/50
401/401 - 19s - loss: 3.2423 - accuracy10: 0.3975 - val_loss: 3.3098 - val_accuracy10: 0.3667 - 19s/epoch - 48ms/step
Epoch 6/50
401/401 - 19s - loss: 3.2339 - accuracy10: 0.4018 - val_loss: 3.3000 - val_accuracy10: 0.3742 - 19s/epoch - 48ms/step
Epoch 7/50
401/401 - 19s - loss: 3.2220 - accuracy10: 0.4077 - val_loss: 3.3034 - val_accuracy10: 0.3727 - 19s/epoch - 47ms/step
Epoch 8/50
401/401 - 19s - loss: 3.2123 - accuracy10: 0.4109 - val_loss: 3.3007 - val_accuracy10: 0.3784 - 19s/epoch - 47ms/step
Epoch 9/50
401/401 - 19s - loss: 3.2009 - accuracy10: 0.4168 - val_loss: 3.2902 - val_accuracy10: 0.3789 - 19s/epoch - 48ms/step
Epoch 10/50
401/401 - 19s - loss: 3.1918 - accuracy10: 0.4211 - val_loss: 3.2984 - val_accuracy10: 0.3779 - 19s/epoch - 47ms/step
Epoch 11/50
401/401 - 19s - loss: 3.1811 - accuracy10: 0.4257 - val_loss: 3.2981 - val_accuracy10: 0.3829 - 19s/epoch - 48ms/step
Epoch 12/50
401/401 - 19s - loss: 3.1735 - accuracy10: 0.4297 - val_loss: 3.2994 - val_accuracy10: 0.3829 - 19s/epoch - 47ms/step
Epoch 13/50
401/401 - 19s - loss: 3.1630 - accuracy10: 0.4331 - val_loss: 3.3105 - val_accuracy10: 0.3788 - 19s/epoch - 47ms/step
Epoch 14/50
401/401 - 19s - loss: 3.1562 - accuracy10: 0.4362 - val_loss: 3.3243 - val_accuracy10: 0.3812 - 19s/epoch - 47ms/step
Epoch 15/50
401/401 - 19s - loss: 3.1442 - accuracy10: 0.4396 - val_loss: 3.3364 - val_accuracy10: 0.3783 - 19s/epoch - 48ms/step
Epoch 16/50
401/401 - 19s - loss: 3.1406 - accuracy10: 0.4420 - val_loss: 3.3483 - val_accuracy10: 0.3755 - 19s/epoch - 47ms/step
Epoch 17/50
401/401 - 19s - loss: 3.1312 - accuracy10: 0.4436 - val_loss: 3.3969 - val_accuracy10: 0.3746 - 19s/epoch - 47ms/step
Epoch 18/50
401/401 - 19s - loss: 3.1243 - accuracy10: 0.4475 - val_loss: 3.3894 - val_accuracy10: 0.3740 - 19s/epoch - 47ms/step
Epoch 19/50
401/401 - 19s - loss: 3.1154 - accuracy10: 0.4512 - val_loss: 3.3704 - val_accuracy10: 0.3784 - 19s/epoch - 47ms/step
testing model: results/CHTR/W7/deepLOB_L2/h10
Evaluating performance on  test set...
1065/1065 - 19s - 19s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0990696
{'0': {'precision': 0.36782512215124014, 'recall': 0.6052297364720823, 'f1-score': 0.45756660022718015, 'support': 88188}, '1': {'precision': 0.37378034944406624, 'recall': 0.06826918095632803, 'f1-score': 0.11545167027325372, 'support': 96515}, '2': {'precision': 0.38186292380605175, 'recall': 0.47745920320904367, 'f1-score': 0.42434370442391833, 'support': 87752}, 'accuracy': 0.3738635738011782, 'macro avg': {'precision': 0.37448946513378606, 'recall': 0.3836527068791513, 'f1-score': 0.33245399164145073, 'support': 272455}, 'weighted avg': {'precision': 0.3744559930582896, 'recall': 0.3738635738011782, 'f1-score': 0.3256747354530668, 'support': 272455}}
[[53374  5856 28958]
 [51062  6589 38864]
 [40671  5183 41898]]
Evaluating performance on  train set...
401/401 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0753994
{'0': {'precision': 0.4078010906738146, 'recall': 0.4988551883992424, 'f1-score': 0.44875592793663305, 'support': 35377}, '1': {'precision': 0.4774774774774775, 'recall': 0.14852507374631269, 'f1-score': 0.22657216784790193, 'support': 33900}, '2': {'precision': 0.39023990493946037, 'recall': 0.5710688052765702, 'f1-score': 0.4636467638682667, 'support': 33355}, 'accuracy': 0.4066080754540494, 'macro avg': {'precision': 0.4251728243635841, 'recall': 0.4061496891407084, 'f1-score': 0.3796582865509339, 'support': 102632}, 'weighted avg': {'precision': 0.42510832586824504, 'recall': 0.4066080754540494, 'f1-score': 0.3802066875972813, 'support': 102632}}
[[17648  2967 14762]
 [13864  5035 15001]
 [11764  2543 19048]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0942731
{'0': {'precision': 0.3787490704783938, 'recall': 0.45661918517780653, 'f1-score': 0.41405473760274586, 'support': 10039}, '1': {'precision': 0.3973227867356252, 'recall': 0.12099314433944784, 'f1-score': 0.18549818904907325, 'support': 10794}, '2': {'precision': 0.3815271089988118, 'recall': 0.5784034888130452, 'f1-score': 0.4597761784543502, 'support': 10548}, 'accuracy': 0.38211019406647334, 'macro avg': {'precision': 0.38586632207094357, 'recall': 0.38533860611009985, 'f1-score': 0.3531097017020564, 'support': 31381}, 'weighted avg': {'precision': 0.3860715727439024, 'recall': 0.38211019406647334, 'f1-score': 0.350807243036428, 'support': 31381}}
[[4584 1051 4404]
 [4002 1306 5486]
 [3517  930 6101]]
training model: results/CHTR/W7/deepLOB_L2/h20
Epoch 1/50
401/401 - 21s - loss: 3.3294 - accuracy20: 0.3556 - val_loss: 3.3649 - val_accuracy20: 0.3377 - 21s/epoch - 52ms/step
Epoch 2/50
401/401 - 19s - loss: 3.2897 - accuracy20: 0.3698 - val_loss: 3.3245 - val_accuracy20: 0.3534 - 19s/epoch - 48ms/step
Epoch 3/50
401/401 - 19s - loss: 3.2743 - accuracy20: 0.3815 - val_loss: 3.3209 - val_accuracy20: 0.3546 - 19s/epoch - 47ms/step
Epoch 4/50
401/401 - 19s - loss: 3.2639 - accuracy20: 0.3882 - val_loss: 3.3061 - val_accuracy20: 0.3647 - 19s/epoch - 48ms/step
Epoch 5/50
401/401 - 19s - loss: 3.2533 - accuracy20: 0.3958 - val_loss: 3.2903 - val_accuracy20: 0.3747 - 19s/epoch - 47ms/step
Epoch 6/50
401/401 - 19s - loss: 3.2420 - accuracy20: 0.4005 - val_loss: 3.2862 - val_accuracy20: 0.3794 - 19s/epoch - 48ms/step
Epoch 7/50
401/401 - 19s - loss: 3.2307 - accuracy20: 0.4059 - val_loss: 3.2942 - val_accuracy20: 0.3767 - 19s/epoch - 47ms/step
Epoch 8/50
401/401 - 19s - loss: 3.2210 - accuracy20: 0.4090 - val_loss: 3.3068 - val_accuracy20: 0.3775 - 19s/epoch - 47ms/step
Epoch 9/50
401/401 - 19s - loss: 3.2111 - accuracy20: 0.4141 - val_loss: 3.3027 - val_accuracy20: 0.3825 - 19s/epoch - 47ms/step
Epoch 10/50
401/401 - 19s - loss: 3.2009 - accuracy20: 0.4182 - val_loss: 3.3098 - val_accuracy20: 0.3862 - 19s/epoch - 47ms/step
Epoch 11/50
401/401 - 19s - loss: 3.1902 - accuracy20: 0.4226 - val_loss: 3.3451 - val_accuracy20: 0.3881 - 19s/epoch - 47ms/step
Epoch 12/50
401/401 - 19s - loss: 3.1824 - accuracy20: 0.4261 - val_loss: 3.3578 - val_accuracy20: 0.3807 - 19s/epoch - 47ms/step
Epoch 13/50
401/401 - 19s - loss: 3.1752 - accuracy20: 0.4283 - val_loss: 3.3723 - val_accuracy20: 0.3887 - 19s/epoch - 47ms/step
Epoch 14/50
401/401 - 19s - loss: 3.1678 - accuracy20: 0.4301 - val_loss: 3.4927 - val_accuracy20: 0.3841 - 19s/epoch - 47ms/step
Epoch 15/50
401/401 - 19s - loss: 3.1638 - accuracy20: 0.4345 - val_loss: 3.4358 - val_accuracy20: 0.3840 - 19s/epoch - 47ms/step
Epoch 16/50
401/401 - 19s - loss: 3.1536 - accuracy20: 0.4377 - val_loss: 3.4902 - val_accuracy20: 0.3818 - 19s/epoch - 47ms/step
testing model: results/CHTR/W7/deepLOB_L2/h20
Evaluating performance on  test set...
1065/1065 - 19s - 19s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.098365
{'0': {'precision': 0.35529008351308, 'recall': 0.5173850012656189, 'f1-score': 0.42128339290147604, 'support': 86914}, '1': {'precision': 0.35788917807702464, 'recall': 0.19587926834303646, 'f1-score': 0.253185499472975, 'support': 96876}, '2': {'precision': 0.3785992720694334, 'recall': 0.3965375289009192, 'f1-score': 0.3873608364411589, 'support': 88665}, 'accuracy': 0.36374080123323116, 'macro avg': {'precision': 0.36392617788651266, 'recall': 0.3699339328365248, 'f1-score': 0.3539432429385367, 'support': 272455}, 'weighted avg': {'precision': 0.3637997423129764, 'recall': 0.36374080123323116, 'f1-score': 0.35047391980561254, 'support': 272455}}
[[44968 16796 25150]
 [45343 18976 32557]
 [36256 17250 35159]]
Evaluating performance on  train set...
401/401 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0899228
{'0': {'precision': 0.39327396695217526, 'recall': 0.45638339809652534, 'f1-score': 0.422484914045903, 'support': 35514}, '1': {'precision': 0.3591068740592072, 'recall': 0.21090941238875463, 'f1-score': 0.26574335363136786, 'support': 33934}, '2': {'precision': 0.3798838246282147, 'recall': 0.47495781099324974, 'f1-score': 0.42213383686205186, 'support': 33184}, 'accuracy': 0.38122612830306335, 'macro avg': {'precision': 0.37742155521319903, 'recall': 0.3807502071595099, 'f1-score': 0.3701207015131076, 'support': 102632}, 'weighted avg': {'precision': 0.37764760662490615, 'recall': 0.38122612830306335, 'f1-score': 0.3705467441147339, 'support': 102632}}
[[16208  6721 12585]
 [13634  7157 13143]
 [11371  6052 15761]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0940039
{'0': {'precision': 0.3688868188169539, 'recall': 0.4689627948287773, 'f1-score': 0.4129480773408647, 'support': 10133}, '1': {'precision': 0.3777665995975855, 'recall': 0.21420422133485453, 'f1-score': 0.27338915180196577, 'support': 10518}, '2': {'precision': 0.38835261268448346, 'recall': 0.45368126747437093, 'f1-score': 0.41848269933376314, 'support': 10730}, 'accuracy': 0.3783499569803384, 'macro avg': {'precision': 0.3783353436996743, 'recall': 0.3789494278793342, 'f1-score': 0.3682733094921979, 'support': 31381}, 'weighted avg': {'precision': 0.37851893705567397, 'recall': 0.3783499569803384, 'f1-score': 0.36806441254897343, 'support': 31381}}
[[4752 1839 3542]
 [4140 2253 4125]
 [3990 1872 4868]]
training model: results/CHTR/W7/deepLOB_L2/h30
Epoch 1/50
401/401 - 21s - loss: 3.3225 - accuracy30: 0.3614 - val_loss: 3.3529 - val_accuracy30: 0.3511 - 21s/epoch - 53ms/step
Epoch 2/50
401/401 - 19s - loss: 3.2920 - accuracy30: 0.3684 - val_loss: 3.3693 - val_accuracy30: 0.3469 - 19s/epoch - 47ms/step
Epoch 3/50
401/401 - 19s - loss: 3.2786 - accuracy30: 0.3761 - val_loss: 3.3363 - val_accuracy30: 0.3570 - 19s/epoch - 47ms/step
Epoch 4/50
401/401 - 19s - loss: 3.2682 - accuracy30: 0.3852 - val_loss: 3.3180 - val_accuracy30: 0.3660 - 19s/epoch - 47ms/step
Epoch 5/50
401/401 - 19s - loss: 3.2555 - accuracy30: 0.3949 - val_loss: 3.3061 - val_accuracy30: 0.3707 - 19s/epoch - 47ms/step
Epoch 6/50
401/401 - 19s - loss: 3.2437 - accuracy30: 0.4025 - val_loss: 3.2928 - val_accuracy30: 0.3786 - 19s/epoch - 47ms/step
Epoch 7/50
401/401 - 19s - loss: 3.2331 - accuracy30: 0.4024 - val_loss: 3.3029 - val_accuracy30: 0.3722 - 19s/epoch - 47ms/step
Epoch 8/50
401/401 - 19s - loss: 3.2214 - accuracy30: 0.4074 - val_loss: 3.2998 - val_accuracy30: 0.3809 - 19s/epoch - 47ms/step
Epoch 9/50
401/401 - 19s - loss: 3.2088 - accuracy30: 0.4144 - val_loss: 3.3026 - val_accuracy30: 0.3799 - 19s/epoch - 47ms/step
Epoch 10/50
401/401 - 19s - loss: 3.1981 - accuracy30: 0.4184 - val_loss: 3.2992 - val_accuracy30: 0.3800 - 19s/epoch - 47ms/step
Epoch 11/50
401/401 - 19s - loss: 3.1871 - accuracy30: 0.4215 - val_loss: 3.3237 - val_accuracy30: 0.3748 - 19s/epoch - 47ms/step
Epoch 12/50
401/401 - 19s - loss: 3.1799 - accuracy30: 0.4269 - val_loss: 3.3196 - val_accuracy30: 0.3755 - 19s/epoch - 47ms/step
Epoch 13/50
401/401 - 19s - loss: 3.1703 - accuracy30: 0.4294 - val_loss: 3.3204 - val_accuracy30: 0.3772 - 19s/epoch - 47ms/step
Epoch 14/50
401/401 - 19s - loss: 3.1636 - accuracy30: 0.4333 - val_loss: 3.3247 - val_accuracy30: 0.3771 - 19s/epoch - 47ms/step
Epoch 15/50
401/401 - 19s - loss: 3.1562 - accuracy30: 0.4361 - val_loss: 3.3368 - val_accuracy30: 0.3762 - 19s/epoch - 47ms/step
Epoch 16/50
401/401 - 19s - loss: 3.1462 - accuracy30: 0.4399 - val_loss: 3.3423 - val_accuracy30: 0.3765 - 19s/epoch - 47ms/step
testing model: results/CHTR/W7/deepLOB_L2/h30
Evaluating performance on  test set...
1065/1065 - 19s - 19s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1032892
{'0': {'precision': 0.3455009898460949, 'recall': 0.6270732640216976, 'f1-score': 0.4455277991657986, 'support': 86277}, '1': {'precision': 0.34500019864129355, 'recall': 0.09015312743316896, 'f1-score': 0.1429512082702311, 'support': 96325}, '2': {'precision': 0.37537213046067, 'recall': 0.3788855130045741, 'f1-score': 0.3771206389471993, 'support': 89853}, 'accuracy': 0.35539813914224366, 'macro avg': {'precision': 0.3552911063160195, 'recall': 0.3653706348198136, 'f1-score': 0.3218665487944097, 'support': 272455}, 'weighted avg': {'precision': 0.35517514845885273, 'recall': 0.35539813914224366, 'f1-score': 0.31599345887056696, 'support': 272455}}
[[54102  7895 24280]
 [55271  8684 32370]
 [47217  8592 34044]]
Evaluating performance on  train set...
401/401 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0897278
{'0': {'precision': 0.3853979151839913, 'recall': 0.5197459421312632, 'f1-score': 0.4426014735754035, 'support': 35425}, '1': {'precision': 0.4014407334643091, 'recall': 0.08985107879924953, 'f1-score': 0.14683689845976955, 'support': 34112}, '2': {'precision': 0.37403383944264446, 'recall': 0.5337059978848768, 'f1-score': 0.43982668891157645, 'support': 33095}, 'accuracy': 0.3813625379998441, 'macro avg': {'precision': 0.386957496030315, 'recall': 0.38110100627179655, 'f1-score': 0.3430883536489165, 'support': 102632}, 'weighted avg': {'precision': 0.3870656068446656, 'recall': 0.3813625379998441, 'f1-score': 0.3434028543845677, 'support': 102632}}
[[18412  2322 14691]
 [16178  3065 14869]
 [13184  2248 17663]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0966431
{'0': {'precision': 0.3715922107674685, 'recall': 0.48064006321612013, 'f1-score': 0.4191394978250571, 'support': 10124}, '1': {'precision': 0.39336701076213487, 'recall': 0.1708969465648855, 'f1-score': 0.23827579325483933, 'support': 10480}, '2': {'precision': 0.3739168426418117, 'recall': 0.4764776839565742, 'f1-score': 0.41901264789881676, 'support': 10777}, 'accuracy': 0.3757687772856187, 'macro avg': {'precision': 0.37962535472380504, 'recall': 0.37600489791252656, 'f1-score': 0.3588093129929044, 'support': 31381}, 'weighted avg': {'precision': 0.3796624590595529, 'recall': 0.3757687772856187, 'f1-score': 0.35869468454469716, 'support': 31381}}
[[4866 1302 3956]
 [4047 1791 4642]
 [4182 1460 5135]]
training model: results/CHTR/W7/deepLOB_L2/h50
Epoch 1/50
401/401 - 21s - loss: 3.3207 - accuracy50: 0.3610 - val_loss: 3.3504 - val_accuracy50: 0.3490 - 21s/epoch - 54ms/step
Epoch 2/50
401/401 - 19s - loss: 3.2896 - accuracy50: 0.3691 - val_loss: 3.3379 - val_accuracy50: 0.3517 - 19s/epoch - 47ms/step
Epoch 3/50
401/401 - 19s - loss: 3.2775 - accuracy50: 0.3807 - val_loss: 3.3317 - val_accuracy50: 0.3532 - 19s/epoch - 47ms/step
Epoch 4/50
401/401 - 19s - loss: 3.2663 - accuracy50: 0.3865 - val_loss: 3.3285 - val_accuracy50: 0.3516 - 19s/epoch - 47ms/step
Epoch 5/50
401/401 - 19s - loss: 3.2519 - accuracy50: 0.3967 - val_loss: 3.3295 - val_accuracy50: 0.3565 - 19s/epoch - 47ms/step
Epoch 6/50
401/401 - 19s - loss: 3.2392 - accuracy50: 0.4023 - val_loss: 3.3373 - val_accuracy50: 0.3544 - 19s/epoch - 47ms/step
Epoch 7/50
401/401 - 19s - loss: 3.2301 - accuracy50: 0.4040 - val_loss: 3.3391 - val_accuracy50: 0.3541 - 19s/epoch - 47ms/step
Epoch 8/50
401/401 - 19s - loss: 3.2196 - accuracy50: 0.4092 - val_loss: 3.3376 - val_accuracy50: 0.3581 - 19s/epoch - 46ms/step
Epoch 9/50
401/401 - 19s - loss: 3.2135 - accuracy50: 0.4092 - val_loss: 3.3364 - val_accuracy50: 0.3601 - 19s/epoch - 47ms/step
Epoch 10/50
401/401 - 19s - loss: 3.2048 - accuracy50: 0.4131 - val_loss: 3.3489 - val_accuracy50: 0.3587 - 19s/epoch - 47ms/step
Epoch 11/50
401/401 - 19s - loss: 3.1959 - accuracy50: 0.4153 - val_loss: 3.3588 - val_accuracy50: 0.3586 - 19s/epoch - 47ms/step
Epoch 12/50
401/401 - 19s - loss: 3.1890 - accuracy50: 0.4183 - val_loss: 3.3570 - val_accuracy50: 0.3572 - 19s/epoch - 47ms/step
Epoch 13/50
401/401 - 19s - loss: 3.1813 - accuracy50: 0.4222 - val_loss: 3.3600 - val_accuracy50: 0.3567 - 19s/epoch - 47ms/step
Epoch 14/50
401/401 - 19s - loss: 3.1747 - accuracy50: 0.4246 - val_loss: 3.3564 - val_accuracy50: 0.3578 - 19s/epoch - 47ms/step
testing model: results/CHTR/W7/deepLOB_L2/h50
Evaluating performance on  test set...
1065/1065 - 19s - 19s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.109921
{'0': {'precision': 0.3259084642276823, 'recall': 0.6198609290129238, 'f1-score': 0.42720334333752863, 'support': 85424}, '1': {'precision': 0.346902548964857, 'recall': 0.18257492258436991, 'f1-score': 0.23923853015412333, 'support': 95265}, '2': {'precision': 0.3698721697719108, 'recall': 0.2412113418913323, 'f1-score': 0.2919972825190784, 'support': 91766}, 'accuracy': 0.3394285294819328, 'macro avg': {'precision': 0.34756106098815004, 'recall': 0.347882397829542, 'f1-score': 0.31947971867024344, 'support': 272455}, 'weighted avg': {'precision': 0.34805661671326205, 'recall': 0.3394285294819328, 'f1-score': 0.3159417136923285, 'support': 272455}}
[[52951 15707 16766]
 [56928 17393 20944]
 [52593 17038 22135]]
Evaluating performance on  train set...
401/401 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0970712
{'0': {'precision': 0.3741060666934512, 'recall': 0.5239421562007652, 'f1-score': 0.43652430734611597, 'support': 35544}, '1': {'precision': 0.3603198104826769, 'recall': 0.17892538893627033, 'f1-score': 0.23911334695802547, 'support': 34003}, '2': {'precision': 0.3585230906108377, 'recall': 0.38975366480278073, 'f1-score': 0.3734866477437293, 'support': 33085}, 'accuracy': 0.36637695845350376, 'macro avg': {'precision': 0.3643163225956552, 'recall': 0.36420706997993874, 'f1-score': 0.34970810068262353, 'support': 102632}, 'weighted avg': {'precision': 0.36451513176449896, 'recall': 0.36637695845350376, 'f1-score': 0.3507989404622863, 'support': 102632}}
[[18623  5569 11352]
 [16199  6084 11720]
 [14958  5232 12895]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1074831
{'0': {'precision': 0.34230799777618937, 'recall': 0.43294826720241086, 'f1-score': 0.3823294597711346, 'support': 9955}, '1': {'precision': 0.34787574234810414, 'recall': 0.14297784453623733, 'f1-score': 0.20266134397870927, 'support': 10652}, '2': {'precision': 0.3627532611712462, 'recall': 0.48524224986077596, 'f1-score': 0.41515127451758915, 'support': 10774}, 'accuracy': 0.35247442720117267, 'macro avg': {'precision': 0.35097900043184654, 'recall': 0.35372278719980804, 'f1-score': 0.333380692755811, 'support': 31381}, 'weighted avg': {'precision': 0.351217365960708, 'recall': 0.35247442720117267, 'f1-score': 0.3326113966965795, 'support': 31381}}
[[4310 1385 4260]
 [4205 1523 4924]
 [4076 1470 5228]]
training model: results/CHTR/W7/deepLOB_L2/h100
Epoch 1/50
401/401 - 21s - loss: 3.3286 - accuracy100: 0.3549 - val_loss: 3.3552 - val_accuracy100: 0.3443 - 21s/epoch - 53ms/step
Epoch 2/50
401/401 - 19s - loss: 3.2947 - accuracy100: 0.3671 - val_loss: 3.3551 - val_accuracy100: 0.3435 - 19s/epoch - 48ms/step
Epoch 3/50
401/401 - 19s - loss: 3.2763 - accuracy100: 0.3782 - val_loss: 3.3394 - val_accuracy100: 0.3505 - 19s/epoch - 48ms/step
Epoch 4/50
401/401 - 19s - loss: 3.2681 - accuracy100: 0.3847 - val_loss: 3.3250 - val_accuracy100: 0.3562 - 19s/epoch - 47ms/step
Epoch 5/50
401/401 - 19s - loss: 3.2659 - accuracy100: 0.3833 - val_loss: 3.3357 - val_accuracy100: 0.3531 - 19s/epoch - 47ms/step
Epoch 6/50
401/401 - 19s - loss: 3.2549 - accuracy100: 0.3905 - val_loss: 3.3375 - val_accuracy100: 0.3591 - 19s/epoch - 47ms/step
Epoch 7/50
401/401 - 19s - loss: 3.2442 - accuracy100: 0.3973 - val_loss: 3.3536 - val_accuracy100: 0.3565 - 19s/epoch - 47ms/step
Epoch 8/50
401/401 - 19s - loss: 3.2329 - accuracy100: 0.4009 - val_loss: 3.3616 - val_accuracy100: 0.3518 - 19s/epoch - 47ms/step
Epoch 9/50
401/401 - 19s - loss: 3.2271 - accuracy100: 0.4025 - val_loss: 3.3489 - val_accuracy100: 0.3608 - 19s/epoch - 47ms/step
Epoch 10/50
401/401 - 19s - loss: 3.2218 - accuracy100: 0.4040 - val_loss: 3.3474 - val_accuracy100: 0.3614 - 19s/epoch - 47ms/step
Epoch 11/50
401/401 - 19s - loss: 3.2133 - accuracy100: 0.4084 - val_loss: 3.3851 - val_accuracy100: 0.3576 - 19s/epoch - 47ms/step
Epoch 12/50
401/401 - 19s - loss: 3.2082 - accuracy100: 0.4102 - val_loss: 3.3621 - val_accuracy100: 0.3613 - 19s/epoch - 47ms/step
Epoch 13/50
401/401 - 19s - loss: 3.2049 - accuracy100: 0.4139 - val_loss: 3.3554 - val_accuracy100: 0.3595 - 19s/epoch - 47ms/step
Epoch 14/50
401/401 - 19s - loss: 3.1992 - accuracy100: 0.4164 - val_loss: 3.3647 - val_accuracy100: 0.3569 - 19s/epoch - 47ms/step
testing model: results/CHTR/W7/deepLOB_L2/h100
Evaluating performance on  test set...
1065/1065 - 19s - 19s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1085529
{'0': {'precision': 0.3338092178837414, 'recall': 0.33079852391563214, 'f1-score': 0.33229705163051526, 'support': 84819}, '1': {'precision': 0.34630072682240504, 'recall': 0.5686861158432709, 'f1-score': 0.4304682997989144, 'support': 93920}, '2': {'precision': 0.3602493561226879, 'recall': 0.1313436339579154, 'f1-score': 0.19250258046354507, 'support': 93716}, 'accuracy': 0.34419628929547996, 'macro avg': {'precision': 0.3467864336096114, 'recall': 0.3436094245722728, 'f1-score': 0.3184226439643249, 'support': 272455}, 'weighted avg': {'precision': 0.34720984005885436, 'recall': 0.34419628929547996, 'f1-score': 0.31805347000453027, 'support': 272455}}
[[28058 46254 10507]
 [29157 53411 11352]
 [26839 54568 12309]]
Evaluating performance on  train set...
401/401 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0997347
{'0': {'precision': 0.37808839452702037, 'recall': 0.43105238055158096, 'f1-score': 0.402836953814287, 'support': 35643}, '1': {'precision': 0.35459353574926544, 'recall': 0.2679713405968735, 'f1-score': 0.3052562351393737, 'support': 33776}, '2': {'precision': 0.35683145512873243, 'recall': 0.39183452262668234, 'f1-score': 0.3735147236094369, 'support': 33213}, 'accuracy': 0.3646913243432848, 'macro avg': {'precision': 0.36317112846833943, 'recall': 0.36361941459171226, 'f1-score': 0.3605359708543659, 'support': 102632}, 'weighted avg': {'precision': 0.3634772685788483, 'recall': 0.3646913243432848, 'f1-score': 0.3612342803230021, 'support': 102632}}
[[15364  8137 12142]
 [13410  9051 11315]
 [11862  8337 13014]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1050247
{'0': {'precision': 0.35470433758942316, 'recall': 0.40174358974358976, 'f1-score': 0.37676141008993413, 'support': 9750}, '1': {'precision': 0.3541540327471195, 'recall': 0.38500659257864006, 'f1-score': 0.36893641983665, 'support': 10618}, '2': {'precision': 0.3688459351904491, 'recall': 0.29456097339507853, 'f1-score': 0.32754442649434573, 'support': 11013}, 'accuracy': 0.3584653134062012, 'macro avg': {'precision': 0.3592347685089972, 'recall': 0.3604370519057694, 'f1-score': 0.35774741880697664, 'support': 31381}, 'weighted avg': {'precision': 0.3594810584576083, 'recall': 0.3584653134062012, 'f1-score': 0.3568413187337764, 'support': 31381}}
[[3917 3377 2456]
 [3435 4088 3095]
 [3691 4078 3244]]
training model: results/CHTR/W7/deepLOB_L2/h200
Epoch 1/50
401/401 - 21s - loss: 3.3266 - accuracy200: 0.3591 - val_loss: 3.4118 - val_accuracy200: 0.3507 - 21s/epoch - 52ms/step
Epoch 2/50
401/401 - 19s - loss: 3.2939 - accuracy200: 0.3723 - val_loss: 3.3810 - val_accuracy200: 0.3507 - 19s/epoch - 47ms/step
Epoch 3/50
401/401 - 19s - loss: 3.2799 - accuracy200: 0.3755 - val_loss: 3.3533 - val_accuracy200: 0.3509 - 19s/epoch - 46ms/step
Epoch 4/50
401/401 - 19s - loss: 3.2690 - accuracy200: 0.3816 - val_loss: 3.3385 - val_accuracy200: 0.3555 - 19s/epoch - 46ms/step
Epoch 5/50
401/401 - 19s - loss: 3.2575 - accuracy200: 0.3876 - val_loss: 3.3349 - val_accuracy200: 0.3566 - 19s/epoch - 47ms/step
Epoch 6/50
401/401 - 19s - loss: 3.2539 - accuracy200: 0.3903 - val_loss: 3.3325 - val_accuracy200: 0.3542 - 19s/epoch - 46ms/step
Epoch 7/50
401/401 - 19s - loss: 3.2471 - accuracy200: 0.3933 - val_loss: 3.3340 - val_accuracy200: 0.3534 - 19s/epoch - 47ms/step
Epoch 8/50
401/401 - 19s - loss: 3.2359 - accuracy200: 0.3998 - val_loss: 3.3467 - val_accuracy200: 0.3596 - 19s/epoch - 47ms/step
Epoch 9/50
401/401 - 19s - loss: 3.2285 - accuracy200: 0.4033 - val_loss: 3.3634 - val_accuracy200: 0.3593 - 19s/epoch - 47ms/step
Epoch 10/50
401/401 - 19s - loss: 3.2213 - accuracy200: 0.4042 - val_loss: 3.3538 - val_accuracy200: 0.3589 - 19s/epoch - 46ms/step
Epoch 11/50
401/401 - 19s - loss: 3.2110 - accuracy200: 0.4097 - val_loss: 3.3834 - val_accuracy200: 0.3579 - 19s/epoch - 47ms/step
Epoch 12/50
401/401 - 19s - loss: 3.2032 - accuracy200: 0.4137 - val_loss: 3.3824 - val_accuracy200: 0.3559 - 19s/epoch - 46ms/step
Epoch 13/50
401/401 - 19s - loss: 3.1958 - accuracy200: 0.4174 - val_loss: 3.3890 - val_accuracy200: 0.3564 - 19s/epoch - 47ms/step
Epoch 14/50
401/401 - 19s - loss: 3.1870 - accuracy200: 0.4202 - val_loss: 3.3996 - val_accuracy200: 0.3552 - 19s/epoch - 47ms/step
Epoch 15/50
401/401 - 19s - loss: 3.1788 - accuracy200: 0.4269 - val_loss: 3.4036 - val_accuracy200: 0.3596 - 19s/epoch - 46ms/step
Epoch 16/50
401/401 - 19s - loss: 3.1710 - accuracy200: 0.4278 - val_loss: 3.4164 - val_accuracy200: 0.3566 - 19s/epoch - 47ms/step
testing model: results/CHTR/W7/deepLOB_L2/h200
Evaluating performance on  test set...
1065/1065 - 19s - 19s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1163745
{'0': {'precision': 0.3026195338356454, 'recall': 0.10456967661873129, 'f1-score': 0.1554305761510362, 'support': 82194}, '1': {'precision': 0.3508097155555097, 'recall': 0.7211276561920407, 'f1-score': 0.472002552790033, 'support': 94355}, '2': {'precision': 0.3553577131906739, 'recall': 0.1856192521844306, 'f1-score': 0.24385967315516227, 'support': 95906}, 'accuracy': 0.3466223780073774, 'macro avg': {'precision': 0.3362623208606097, 'recall': 0.3371055283317342, 'f1-score': 0.29043093403207715, 'support': 272455}, 'weighted avg': {'precision': 0.33787266710683206, 'recall': 0.3466223780073774, 'f1-score': 0.296191545239694, 'support': 272455}}
[[ 8595 57936 15663]
 [ 9682 68042 16631]
 [10125 67979 17802]]
Evaluating performance on  train set...
401/401 - 8s - 8s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1140978
{'0': {'precision': 0.3878787878787879, 'recall': 0.15722595583667476, 'f1-score': 0.22375374228937694, 'support': 35414}, '1': {'precision': 0.36999101527403416, 'recall': 0.24329434006853362, 'f1-score': 0.29355574565155407, 'support': 33852}, '2': {'precision': 0.33006649802323645, 'recall': 0.6530600011988251, 'f1-score': 0.4385055794250526, 'support': 33366}, 'accuracy': 0.3468119105152389, 'macro avg': {'precision': 0.36264543372535285, 'recall': 0.3511934323680112, 'f1-score': 0.31860502245532785, 'support': 102632}, 'weighted avg': {'precision': 0.3631837440178434, 'recall': 0.3468119105152389, 'f1-score': 0.3165936676117459, 'support': 102632}}
[[ 5568  6691 23155]
 [ 4544  8236 21072]
 [ 4243  7333 21790]]
Evaluating performance on  val set...
123/123 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1088549
{'0': {'precision': 0.3385554425228891, 'recall': 0.17647682681090254, 'f1-score': 0.23201338538761854, 'support': 9429}, '1': {'precision': 0.3514760881674226, 'recall': 0.4109984181632083, 'f1-score': 0.37891395727888827, 'support': 10747}, '2': {'precision': 0.3638391251169149, 'recall': 0.45131637661758145, 'f1-score': 0.40288400254939455, 'support': 11205}, 'accuracy': 0.35492814123195565, 'macro avg': {'precision': 0.3512902186024089, 'recall': 0.34626387386389745, 'f1-score': 0.33793711507196716, 'support': 31381}, 'weighted avg': {'precision': 0.35200822739933857, 'recall': 0.35492814123195565, 'f1-score': 0.3433337930041118, 'support': 31381}}
[[1664 3629 4136]
 [1624 4417 4706]
 [1627 4521 5057]]
training model: results/CHTR/W7/deepLOB_L2/h300
Epoch 1/50
401/401 - 21s - loss: 3.3313 - accuracy300: 0.3589 - val_loss: 3.4264 - val_accuracy300: 0.3379 - 21s/epoch - 53ms/step
Epoch 2/50
401/401 - 19s - loss: 3.2925 - accuracy300: 0.3713 - val_loss: 3.4069 - val_accuracy300: 0.3293 - 19s/epoch - 47ms/step
Epoch 3/50
401/401 - 19s - loss: 3.2754 - accuracy300: 0.3798 - val_loss: 3.3985 - val_accuracy300: 0.3400 - 19s/epoch - 47ms/step
Epoch 4/50
401/401 - 19s - loss: 3.2681 - accuracy300: 0.3788 - val_loss: 3.4063 - val_accuracy300: 0.3361 - 19s/epoch - 47ms/step
Epoch 5/50
401/401 - 19s - loss: 3.2484 - accuracy300: 0.3920 - val_loss: 3.4146 - val_accuracy300: 0.3433 - 19s/epoch - 47ms/step
Epoch 6/50
401/401 - 19s - loss: 3.2433 - accuracy300: 0.3950 - val_loss: 3.4165 - val_accuracy300: 0.3402 - 19s/epoch - 47ms/step
Epoch 7/50
401/401 - 19s - loss: 3.2294 - accuracy300: 0.4049 - val_loss: 3.4383 - val_accuracy300: 0.3421 - 19s/epoch - 47ms/step
Epoch 8/50
401/401 - 19s - loss: 3.2196 - accuracy300: 0.4077 - val_loss: 3.4273 - val_accuracy300: 0.3427 - 19s/epoch - 47ms/step
Epoch 9/50
401/401 - 19s - loss: 3.2059 - accuracy300: 0.4151 - val_loss: 3.4375 - val_accuracy300: 0.3454 - 19s/epoch - 47ms/step
Epoch 10/50
401/401 - 19s - loss: 3.1936 - accuracy300: 0.4209 - val_loss: 3.4612 - val_accuracy300: 0.3429 - 19s/epoch - 47ms/step
Epoch 11/50
401/401 - 19s - loss: 3.1809 - accuracy300: 0.4277 - val_loss: 3.4581 - val_accuracy300: 0.3416 - 19s/epoch - 47ms/step
Epoch 12/50
401/401 - 19s - loss: 3.1723 - accuracy300: 0.4310 - val_loss: 3.4517 - val_accuracy300: 0.3445 - 19s/epoch - 47ms/step
Epoch 13/50
401/401 - 19s - loss: 3.1648 - accuracy300: 0.4320 - val_loss: 3.4822 - val_accuracy300: 0.3387 - 19s/epoch - 47ms/step
testing model: results/CHTR/W7/deepLOB_L2/h300
Evaluating performance on  test set...
1065/1065 - 19s - 19s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1325074
{'0': {'precision': 0.31253763699867515, 'recall': 0.09540908868081768, 'f1-score': 0.1461903197033003, 'support': 81596}, '1': {'precision': 0.34742600645251787, 'recall': 0.7988904299583911, 'f1-score': 0.4842560096976333, 'support': 93009}, '2': {'precision': 0.35972205725145506, 'recall': 0.12380173735309147, 'f1-score': 0.1842069248665663, 'support': 97850}, 'accuracy': 0.34575617991961977, 'macro avg': {'precision': 0.33989523356754936, 'recall': 0.3393670853307667, 'f1-score': 0.2715510847558333, 'support': 272455}, 'weighted avg': {'precision': 0.34139351366185616, 'recall': 0.34575617991961977, 'f1-score': 0.2752504455072257, 'support': 272455}}
[[ 7785 62975 10836]
 [ 7979 74304 10726]
 [ 9145 76591 12114]]
Evaluating performance on  train set...
401/401 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1175573
{'0': {'precision': 0.37063251320076396, 'recall': 0.1867323258051735, 'f1-score': 0.24834387232761215, 'support': 35334}, '1': {'precision': 0.3406552494415488, 'recall': 0.35195431547178746, 'f1-score': 0.34621261733246017, 'support': 33797}, '2': {'precision': 0.3277768873216862, 'recall': 0.48834363153338706, 'f1-score': 0.3922649946651002, 'support': 33501}, 'accuracy': 0.3395919401356302, 'macro avg': {'precision': 0.34635488332133296, 'recall': 0.342343424270116, 'f1-score': 0.32894049477505755, 'support': 102632}, 'weighted avg': {'precision': 0.3467720417508733, 'recall': 0.3395919401356302, 'f1-score': 0.32755085937216977, 'support': 102632}}
[[ 6598 11185 17551]
 [ 5901 11895 16001]
 [ 5303 11838 16360]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1291382
{'0': {'precision': 0.30766926303175557, 'recall': 0.10859680659828698, 'f1-score': 0.16053145760062526, 'support': 9457}, '1': {'precision': 0.3349540788762831, 'recall': 0.5916030534351145, 'f1-score': 0.42773370127630217, 'support': 10480}, '2': {'precision': 0.3722857442567922, 'recall': 0.3101188395665851, 'f1-score': 0.33837059636745004, 'support': 11444}, 'accuracy': 0.34339249864567734, 'macro avg': {'precision': 0.3383030287216103, 'recall': 0.3367728998666622, 'f1-score': 0.30887858508145916, 'support': 31381}, 'weighted avg': {'precision': 0.3403455920585542, 'recall': 0.34339249864567734, 'f1-score': 0.31462057578578945, 'support': 31381}}
[[1027 5622 2808]
 [1104 6200 3176]
 [1207 6688 3549]]
training model: results/CHTR/W7/deepLOB_L2/h500
Epoch 1/50
401/401 - 21s - loss: 3.3234 - accuracy500: 0.3669 - val_loss: 3.5164 - val_accuracy500: 0.3362 - 21s/epoch - 53ms/step
Epoch 2/50
401/401 - 19s - loss: 3.2929 - accuracy500: 0.3746 - val_loss: 3.4833 - val_accuracy500: 0.3359 - 19s/epoch - 48ms/step
Epoch 3/50
401/401 - 19s - loss: 3.2817 - accuracy500: 0.3788 - val_loss: 3.3914 - val_accuracy500: 0.3382 - 19s/epoch - 49ms/step
Epoch 4/50
401/401 - 19s - loss: 3.2713 - accuracy500: 0.3827 - val_loss: 3.3541 - val_accuracy500: 0.3354 - 19s/epoch - 47ms/step
Epoch 5/50
401/401 - 19s - loss: 3.2601 - accuracy500: 0.3901 - val_loss: 3.3767 - val_accuracy500: 0.3400 - 19s/epoch - 47ms/step
Epoch 6/50
401/401 - 19s - loss: 3.2463 - accuracy500: 0.4003 - val_loss: 3.4155 - val_accuracy500: 0.3353 - 19s/epoch - 47ms/step
Epoch 7/50
401/401 - 19s - loss: 3.2370 - accuracy500: 0.4050 - val_loss: 3.4143 - val_accuracy500: 0.3335 - 19s/epoch - 46ms/step
Epoch 8/50
401/401 - 19s - loss: 3.2219 - accuracy500: 0.4151 - val_loss: 3.3955 - val_accuracy500: 0.3367 - 19s/epoch - 46ms/step
Epoch 9/50
401/401 - 19s - loss: 3.2142 - accuracy500: 0.4206 - val_loss: 3.4084 - val_accuracy500: 0.3382 - 19s/epoch - 47ms/step
Epoch 10/50
401/401 - 19s - loss: 3.2061 - accuracy500: 0.4213 - val_loss: 3.4811 - val_accuracy500: 0.3385 - 19s/epoch - 47ms/step
Epoch 11/50
401/401 - 19s - loss: 3.2009 - accuracy500: 0.4249 - val_loss: 3.5935 - val_accuracy500: 0.3350 - 19s/epoch - 47ms/step
Epoch 12/50
401/401 - 19s - loss: 3.1860 - accuracy500: 0.4331 - val_loss: 3.5436 - val_accuracy500: 0.3326 - 19s/epoch - 47ms/step
Epoch 13/50
401/401 - 19s - loss: 3.1760 - accuracy500: 0.4377 - val_loss: 3.4990 - val_accuracy500: 0.3343 - 19s/epoch - 47ms/step
Epoch 14/50
401/401 - 19s - loss: 3.1730 - accuracy500: 0.4398 - val_loss: 3.5815 - val_accuracy500: 0.3294 - 19s/epoch - 46ms/step
testing model: results/CHTR/W7/deepLOB_L2/h500
Evaluating performance on  test set...
1065/1065 - 19s - 19s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1182095
{'0': {'precision': 0.2836453122478619, 'recall': 0.08786223960611324, 'f1-score': 0.1341653070765473, 'support': 80023}, '1': {'precision': 0.3475991130740294, 'recall': 0.8200375010653712, 'f1-score': 0.4882414693168159, 'support': 93864}, '2': {'precision': 0.34707183163031874, 'recall': 0.0923524876227579, 'f1-score': 0.14588608609250298, 'support': 98568}, 'accuracy': 0.341729826943899, 'macro avg': {'precision': 0.32610541898407003, 'recall': 0.3334174094314141, 'f1-score': 0.25609762082862203, 'support': 272455}, 'weighted avg': {'precision': 0.32862442704934247, 'recall': 0.341729826943899, 'f1-score': 0.2603890821534051, 'support': 272455}}
[[ 7031 63986  9006]
 [ 8773 76972  8119]
 [ 8984 80481  9103]]
Evaluating performance on  train set...
401/401 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.113848
{'0': {'precision': 0.36182148160369576, 'recall': 0.06276653596267781, 'f1-score': 0.10697560975609757, 'support': 34939}, '1': {'precision': 0.34850823045267487, 'recall': 0.3988578829624397, 'f1-score': 0.37198704222258827, 'support': 33972}, '2': {'precision': 0.3256487147042, 'recall': 0.5571305714539901, 'f1-score': 0.4110401260228417, 'support': 33721}, 'accuracy': 0.3364447735599033, 'macro avg': {'precision': 0.3453261422535235, 'recall': 0.33958499679303583, 'f1-score': 0.29666759266717585, 'support': 102632}, 'weighted avg': {'precision': 0.3455296852758411, 'recall': 0.3364447735599033, 'f1-score': 0.29460059939658495, 'support': 102632}}
[[ 2193 12350 20396]
 [ 1914 13550 18508]
 [ 1954 12980 18787]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1164023
{'0': {'precision': 0.30647678501755754, 'recall': 0.1655077960387695, 'f1-score': 0.2149404843343823, 'support': 9492}, '1': {'precision': 0.3136713355691458, 'recall': 0.4794933655006031, 'f1-score': 0.3792486583184258, 'support': 9948}, '2': {'precision': 0.37862056480811007, 'recall': 0.3503056695419144, 'f1-score': 0.36391317586671884, 'support': 11941}, 'accuracy': 0.3353621618176604, 'macro avg': {'precision': 0.3329228951316045, 'recall': 0.3317689436937623, 'f1-score': 0.319367439506509, 'support': 31381}, 'weighted avg': {'precision': 0.33620943417998667, 'recall': 0.3353621618176604, 'f1-score': 0.323713965879932, 'support': 31381}}
[[1571 4565 3356]
 [1669 4770 3509]
 [1886 5872 4183]]
training model: results/CHTR/W7/deepLOB_L2/h1000
Epoch 1/50
401/401 - 21s - loss: 3.3214 - accuracy1000: 0.3710 - val_loss: 3.5021 - val_accuracy1000: 0.3282 - 21s/epoch - 52ms/step
Epoch 2/50
401/401 - 19s - loss: 3.2775 - accuracy1000: 0.3903 - val_loss: 3.4291 - val_accuracy1000: 0.3439 - 19s/epoch - 47ms/step
Epoch 3/50
401/401 - 19s - loss: 3.2703 - accuracy1000: 0.3911 - val_loss: 3.4552 - val_accuracy1000: 0.3444 - 19s/epoch - 47ms/step
Epoch 4/50
401/401 - 19s - loss: 3.2528 - accuracy1000: 0.4001 - val_loss: 3.3976 - val_accuracy1000: 0.3497 - 19s/epoch - 47ms/step
Epoch 5/50
401/401 - 19s - loss: 3.2361 - accuracy1000: 0.4076 - val_loss: 3.4072 - val_accuracy1000: 0.3599 - 19s/epoch - 47ms/step
Epoch 6/50
401/401 - 19s - loss: 3.2229 - accuracy1000: 0.4145 - val_loss: 3.3892 - val_accuracy1000: 0.3541 - 19s/epoch - 47ms/step
Epoch 7/50
401/401 - 19s - loss: 3.2026 - accuracy1000: 0.4244 - val_loss: 3.4803 - val_accuracy1000: 0.3476 - 19s/epoch - 47ms/step
Epoch 8/50
401/401 - 19s - loss: 3.1971 - accuracy1000: 0.4262 - val_loss: 3.4374 - val_accuracy1000: 0.3446 - 19s/epoch - 47ms/step
Epoch 9/50
401/401 - 19s - loss: 3.1781 - accuracy1000: 0.4369 - val_loss: 3.5123 - val_accuracy1000: 0.3432 - 19s/epoch - 47ms/step
Epoch 10/50
401/401 - 19s - loss: 3.1598 - accuracy1000: 0.4452 - val_loss: 3.5398 - val_accuracy1000: 0.3445 - 19s/epoch - 46ms/step
Epoch 11/50
401/401 - 19s - loss: 3.1466 - accuracy1000: 0.4508 - val_loss: 3.5798 - val_accuracy1000: 0.3397 - 19s/epoch - 47ms/step
Epoch 12/50
401/401 - 19s - loss: 3.1357 - accuracy1000: 0.4556 - val_loss: 3.6568 - val_accuracy1000: 0.3429 - 19s/epoch - 47ms/step
Epoch 13/50
401/401 - 19s - loss: 3.1249 - accuracy1000: 0.4583 - val_loss: 3.6551 - val_accuracy1000: 0.3395 - 19s/epoch - 47ms/step
Epoch 14/50
401/401 - 19s - loss: 3.1293 - accuracy1000: 0.4542 - val_loss: 3.6542 - val_accuracy1000: 0.3456 - 19s/epoch - 47ms/step
Epoch 15/50
401/401 - 19s - loss: 3.1072 - accuracy1000: 0.4623 - val_loss: 3.6943 - val_accuracy1000: 0.3448 - 19s/epoch - 46ms/step
Epoch 16/50
401/401 - 19s - loss: 3.1056 - accuracy1000: 0.4628 - val_loss: 3.6598 - val_accuracy1000: 0.3445 - 19s/epoch - 47ms/step
testing model: results/CHTR/W7/deepLOB_L2/h1000
Evaluating performance on  test set...
1065/1065 - 19s - 19s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1202817
{'0': {'precision': 0.20423964519281365, 'recall': 0.1069432417539164, 'f1-score': 0.14038078999715828, 'support': 76218}, '1': {'precision': 0.34563174209547426, 'recall': 0.7308115817401973, 'f1-score': 0.46930790418274504, 'support': 95357}, '2': {'precision': 0.3599495488502959, 'recall': 0.11032910388580491, 'f1-score': 0.16889097958285595, 'support': 100880}, 'accuracy': 0.3265456680919785, 'macro avg': {'precision': 0.30327364537952795, 'recall': 0.3160279757933062, 'f1-score': 0.2595265579209198, 'support': 272455}, 'weighted avg': {'precision': 0.31137932427858495, 'recall': 0.3265456680919785, 'f1-score': 0.26605883133536157, 'support': 272455}}
[[ 8151 58504  9563]
 [15441 69688 10228]
 [16317 73433 11130]]
Evaluating performance on  train set...
401/401 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.128669
{'0': {'precision': 0.39440831277565974, 'recall': 0.1474814110806731, 'f1-score': 0.21468535736811054, 'support': 35774}, '1': {'precision': 0.3545187461254414, 'recall': 0.3877881950586709, 'f1-score': 0.37040791900758946, 'support': 33918}, '2': {'precision': 0.3169267937262722, 'recall': 0.5017911353976928, 'f1-score': 0.3884880250076386, 'support': 32940}, 'accuracy': 0.3406150128614857, 'macro avg': {'precision': 0.35528461754245777, 'recall': 0.345686913845679, 'f1-score': 0.3245271004611128, 'support': 102632}, 'weighted avg': {'precision': 0.3563576506125047, 'recall': 0.3406150128614857, 'f1-score': 0.3219312233527342, 'support': 102632}}
[[ 5276 11805 18693]
 [ 3833 13153 16932]
 [ 4268 12143 16529]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1257128
{'0': {'precision': 0.3370316301703163, 'recall': 0.3578958247209591, 'f1-score': 0.3471505187709889, 'support': 9676}, '1': {'precision': 0.3280858676207513, 'recall': 0.3874511460864054, 'f1-score': 0.35530585557223804, 'support': 9467}, '2': {'precision': 0.3979447914567802, 'recall': 0.32276515770550745, 'f1-score': 0.35643385670456595, 'support': 12238}, 'accuracy': 0.35311175552085655, 'macro avg': {'precision': 0.3543540964159493, 'recall': 0.3560373761709574, 'f1-score': 0.35296341034926426, 'support': 31381}, 'weighted avg': {'precision': 0.35808786591063735, 'recall': 0.35311175552085655, 'f1-score': 0.35323114281510926, 'support': 31381}}
[[3463 3135 3078]
 [2901 3668 2898]
 [3911 4377 3950]]
training model: results/CHTR/W7/deepOF_L2/h10
Epoch 1/50
401/401 - 14s - loss: 3.3232 - accuracy10: 0.3573 - val_loss: 3.3247 - val_accuracy10: 0.3550 - 14s/epoch - 35ms/step
Epoch 2/50
401/401 - 12s - loss: 3.2753 - accuracy10: 0.3827 - val_loss: 3.3077 - val_accuracy10: 0.3672 - 12s/epoch - 29ms/step
Epoch 3/50
401/401 - 12s - loss: 3.2501 - accuracy10: 0.3984 - val_loss: 3.3013 - val_accuracy10: 0.3707 - 12s/epoch - 29ms/step
Epoch 4/50
401/401 - 12s - loss: 3.2302 - accuracy10: 0.4092 - val_loss: 3.2944 - val_accuracy10: 0.3750 - 12s/epoch - 29ms/step
Epoch 5/50
401/401 - 12s - loss: 3.2174 - accuracy10: 0.4130 - val_loss: 3.2878 - val_accuracy10: 0.3783 - 12s/epoch - 29ms/step
Epoch 6/50
401/401 - 11s - loss: 3.2046 - accuracy10: 0.4192 - val_loss: 3.2857 - val_accuracy10: 0.3829 - 11s/epoch - 29ms/step
Epoch 7/50
401/401 - 11s - loss: 3.1927 - accuracy10: 0.4243 - val_loss: 3.2845 - val_accuracy10: 0.3835 - 11s/epoch - 29ms/step
Epoch 8/50
401/401 - 12s - loss: 3.1820 - accuracy10: 0.4294 - val_loss: 3.2811 - val_accuracy10: 0.3851 - 12s/epoch - 29ms/step
Epoch 9/50
401/401 - 11s - loss: 3.1694 - accuracy10: 0.4344 - val_loss: 3.2837 - val_accuracy10: 0.3879 - 11s/epoch - 28ms/step
Epoch 10/50
401/401 - 11s - loss: 3.1618 - accuracy10: 0.4346 - val_loss: 3.2797 - val_accuracy10: 0.3874 - 11s/epoch - 28ms/step
Epoch 11/50
401/401 - 11s - loss: 3.1532 - accuracy10: 0.4380 - val_loss: 3.2774 - val_accuracy10: 0.3911 - 11s/epoch - 28ms/step
Epoch 12/50
401/401 - 11s - loss: 3.1416 - accuracy10: 0.4433 - val_loss: 3.2783 - val_accuracy10: 0.3935 - 11s/epoch - 28ms/step
Epoch 13/50
401/401 - 11s - loss: 3.1331 - accuracy10: 0.4466 - val_loss: 3.2790 - val_accuracy10: 0.3938 - 11s/epoch - 28ms/step
Epoch 14/50
401/401 - 11s - loss: 3.1223 - accuracy10: 0.4504 - val_loss: 3.2881 - val_accuracy10: 0.3935 - 11s/epoch - 28ms/step
Epoch 15/50
401/401 - 11s - loss: 3.1138 - accuracy10: 0.4527 - val_loss: 3.2919 - val_accuracy10: 0.3902 - 11s/epoch - 28ms/step
Epoch 16/50
401/401 - 11s - loss: 3.1055 - accuracy10: 0.4545 - val_loss: 3.2904 - val_accuracy10: 0.3909 - 11s/epoch - 29ms/step
Epoch 17/50
401/401 - 11s - loss: 3.0963 - accuracy10: 0.4600 - val_loss: 3.2989 - val_accuracy10: 0.3908 - 11s/epoch - 28ms/step
Epoch 18/50
401/401 - 12s - loss: 3.0885 - accuracy10: 0.4618 - val_loss: 3.2954 - val_accuracy10: 0.3914 - 12s/epoch - 29ms/step
Epoch 19/50
401/401 - 12s - loss: 3.0796 - accuracy10: 0.4635 - val_loss: 3.3011 - val_accuracy10: 0.3910 - 12s/epoch - 29ms/step
Epoch 20/50
401/401 - 12s - loss: 3.0712 - accuracy10: 0.4681 - val_loss: 3.3148 - val_accuracy10: 0.3918 - 12s/epoch - 29ms/step
Epoch 21/50
401/401 - 11s - loss: 3.0618 - accuracy10: 0.4702 - val_loss: 3.3173 - val_accuracy10: 0.3911 - 11s/epoch - 28ms/step
testing model: results/CHTR/W7/deepOF_L2/h10
Evaluating performance on  test set...
1065/1065 - 13s - 13s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0887765
{'0': {'precision': 0.3787823246062524, 'recall': 0.6678837910779489, 'f1-score': 0.483406448647606, 'support': 88186}, '1': {'precision': 0.42573307755549467, 'recall': 0.12877021748365505, 'f1-score': 0.19773278708086392, 'support': 96513}, '2': {'precision': 0.40614140033042784, 'recall': 0.40620619708037514, 'f1-score': 0.40617379612115134, 'support': 87751}, 'accuracy': 0.39262616993943844, 'macro avg': {'precision': 0.40355226749739165, 'recall': 0.4009534018806597, 'f1-score': 0.362437677283207, 'support': 272450}, 'weighted avg': {'precision': 0.40422605473384404, 'recall': 0.39262616993943844, 'f1-score': 0.3573339047289424, 'support': 272450}}
[[58898  7880 21408]
 [53373 12428 30712]
 [43222  8884 35645]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0531151
{'0': {'precision': 0.41655434594781404, 'recall': 0.6781062758446088, 'f1-score': 0.5160834519744377, 'support': 35549}, '1': {'precision': 0.5023857662757784, 'recall': 0.18429406354763106, 'f1-score': 0.26966487237367603, 'support': 33707}, '2': {'precision': 0.44334351946167855, 'recall': 0.43033916586768933, 'f1-score': 0.43674456083803387, 'support': 33376}, 'accuracy': 0.43535154727570347, 'macro avg': {'precision': 0.4540945438950903, 'recall': 0.43091316841997646, 'f1-score': 0.40749762839538256, 'support': 102632}, 'weighted avg': {'precision': 0.4534554600271795, 'recall': 0.43535154727570347, 'f1-score': 0.40935216063088514, 'support': 102632}}
[[24106  2987  8456]
 [17917  6212  9578]
 [15847  3166 14363]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.089574
{'0': {'precision': 0.3694781481917776, 'recall': 0.6201680672268908, 'f1-score': 0.46307164212158125, 'support': 10115}, '1': {'precision': 0.40638561686298824, 'recall': 0.12260357243056205, 'f1-score': 0.18837560169552411, 'support': 10693}, '2': {'precision': 0.41567504697145924, 'recall': 0.4394211671238059, 'f1-score': 0.42721839080459767, 'support': 10573}, 'accuracy': 0.38972626748669575, 'macro avg': {'precision': 0.3971796040087417, 'recall': 0.3940642689270863, 'f1-score': 0.35955521154056774, 'support': 31381}, 'weighted avg': {'precision': 0.3976191052453715, 'recall': 0.38972626748669575, 'f1-score': 0.3573898223436807, 'support': 31381}}
[[6273  862 2980]
 [5831 1311 3551]
 [4874 1053 4646]]
training model: results/CHTR/W7/deepOF_L2/h20
Epoch 1/50
401/401 - 14s - loss: 3.3252 - accuracy20: 0.3565 - val_loss: 3.3141 - val_accuracy20: 0.3588 - 14s/epoch - 35ms/step
Epoch 2/50
401/401 - 11s - loss: 3.2789 - accuracy20: 0.3799 - val_loss: 3.2971 - val_accuracy20: 0.3719 - 11s/epoch - 28ms/step
Epoch 3/50
401/401 - 12s - loss: 3.2563 - accuracy20: 0.3932 - val_loss: 3.2901 - val_accuracy20: 0.3738 - 12s/epoch - 29ms/step
Epoch 4/50
401/401 - 11s - loss: 3.2393 - accuracy20: 0.3999 - val_loss: 3.2869 - val_accuracy20: 0.3769 - 11s/epoch - 28ms/step
Epoch 5/50
401/401 - 11s - loss: 3.2230 - accuracy20: 0.4075 - val_loss: 3.2844 - val_accuracy20: 0.3804 - 11s/epoch - 28ms/step
Epoch 6/50
401/401 - 11s - loss: 3.2095 - accuracy20: 0.4124 - val_loss: 3.2793 - val_accuracy20: 0.3815 - 11s/epoch - 28ms/step
Epoch 7/50
401/401 - 11s - loss: 3.1996 - accuracy20: 0.4177 - val_loss: 3.2796 - val_accuracy20: 0.3849 - 11s/epoch - 28ms/step
Epoch 8/50
401/401 - 11s - loss: 3.1927 - accuracy20: 0.4193 - val_loss: 3.2830 - val_accuracy20: 0.3860 - 11s/epoch - 28ms/step
Epoch 9/50
401/401 - 11s - loss: 3.1812 - accuracy20: 0.4245 - val_loss: 3.2813 - val_accuracy20: 0.3847 - 11s/epoch - 28ms/step
Epoch 10/50
401/401 - 11s - loss: 3.1750 - accuracy20: 0.4274 - val_loss: 3.2866 - val_accuracy20: 0.3797 - 11s/epoch - 28ms/step
Epoch 11/50
401/401 - 11s - loss: 3.1662 - accuracy20: 0.4308 - val_loss: 3.2813 - val_accuracy20: 0.3847 - 11s/epoch - 28ms/step
Epoch 12/50
401/401 - 11s - loss: 3.1584 - accuracy20: 0.4357 - val_loss: 3.2837 - val_accuracy20: 0.3853 - 11s/epoch - 28ms/step
Epoch 13/50
401/401 - 11s - loss: 3.1516 - accuracy20: 0.4377 - val_loss: 3.2875 - val_accuracy20: 0.3844 - 11s/epoch - 28ms/step
Epoch 14/50
401/401 - 11s - loss: 3.1458 - accuracy20: 0.4412 - val_loss: 3.2888 - val_accuracy20: 0.3849 - 11s/epoch - 29ms/step
Epoch 15/50
401/401 - 12s - loss: 3.1351 - accuracy20: 0.4452 - val_loss: 3.2897 - val_accuracy20: 0.3865 - 12s/epoch - 29ms/step
Epoch 16/50
401/401 - 12s - loss: 3.1270 - accuracy20: 0.4493 - val_loss: 3.2967 - val_accuracy20: 0.3850 - 12s/epoch - 29ms/step
testing model: results/CHTR/W7/deepOF_L2/h20
Evaluating performance on  test set...
1065/1065 - 13s - 13s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0850391
{'0': {'precision': 0.36990219954385556, 'recall': 0.6605992268041238, 'f1-score': 0.4742489447642963, 'support': 86912}, '1': {'precision': 0.39711772043857924, 'recall': 0.12487354708177632, 'f1-score': 0.1900012565181881, 'support': 96874}, '2': {'precision': 0.4028741328047572, 'recall': 0.39428629432464135, 'f1-score': 0.39853395501544703, 'support': 88664}, 'accuracy': 0.3834465039456781, 'macro avg': {'precision': 0.38996468426239733, 'recall': 0.39325302273684715, 'f1-score': 0.3542613854326438, 'support': 272450}, 'weighted avg': {'precision': 0.39030924620122404, 'recall': 0.3834465039456781, 'f1-score': 0.3485399911865923, 'support': 272450}}
[[57414  9160 20338]
 [53300 12097 31477]
 [44500  9205 34959]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0689209
{'0': {'precision': 0.4056659138197791, 'recall': 0.6405784891884302, 'f1-score': 0.49674981761958176, 'support': 35610}, '1': {'precision': 0.45486712339080027, 'recall': 0.17945823927765236, 'f1-score': 0.25737470980383803, 'support': 33668}, '2': {'precision': 0.42203635485234614, 'recall': 0.4190501888828926, 'f1-score': 0.42053797087495487, 'support': 33354}, 'accuracy': 0.4173162366513368, 'macro avg': {'precision': 0.42752313068764186, 'recall': 0.41302897244965836, 'f1-score': 0.3915541660994582, 'support': 102632}, 'weighted avg': {'precision': 0.42712633565738706, 'recall': 0.4173162366513368, 'f1-score': 0.3934560002306509, 'support': 102632}}
[[22811  3796  9003]
 [17488  6042 10138]
 [15932  3445 13977]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0907459
{'0': {'precision': 0.3683993884511349, 'recall': 0.6157853351680754, 'f1-score': 0.4610007358351729, 'support': 10174}, '1': {'precision': 0.36455525606469, 'recall': 0.10306725090493428, 'f1-score': 0.16070102480320808, 'support': 10498}, '2': {'precision': 0.404225475585167, 'recall': 0.43057241572509103, 'f1-score': 0.41698317959848075, 'support': 10709}, 'accuracy': 0.3810586023389949, 'macro avg': {'precision': 0.37906004003366395, 'recall': 0.38314166726603355, 'f1-score': 0.3462283134122872, 'support': 31381}, 'weighted avg': {'precision': 0.37933931596540954, 'recall': 0.3810586023389949, 'f1-score': 0.34551906297094603, 'support': 31381}}
[[6265  904 3005]
 [5625 1082 3791]
 [5116  982 4611]]
training model: results/CHTR/W7/deepOF_L2/h30
Epoch 1/50
401/401 - 14s - loss: 3.3233 - accuracy30: 0.3568 - val_loss: 3.3149 - val_accuracy30: 0.3582 - 14s/epoch - 34ms/step
Epoch 2/50
401/401 - 11s - loss: 3.2753 - accuracy30: 0.3814 - val_loss: 3.2961 - val_accuracy30: 0.3692 - 11s/epoch - 29ms/step
Epoch 3/50
401/401 - 12s - loss: 3.2530 - accuracy30: 0.3944 - val_loss: 3.2953 - val_accuracy30: 0.3739 - 12s/epoch - 29ms/step
Epoch 4/50
401/401 - 12s - loss: 3.2370 - accuracy30: 0.4008 - val_loss: 3.2899 - val_accuracy30: 0.3776 - 12s/epoch - 29ms/step
Epoch 5/50
401/401 - 12s - loss: 3.2234 - accuracy30: 0.4066 - val_loss: 3.2901 - val_accuracy30: 0.3780 - 12s/epoch - 29ms/step
Epoch 6/50
401/401 - 12s - loss: 3.2111 - accuracy30: 0.4115 - val_loss: 3.2858 - val_accuracy30: 0.3815 - 12s/epoch - 29ms/step
Epoch 7/50
401/401 - 12s - loss: 3.2019 - accuracy30: 0.4146 - val_loss: 3.2853 - val_accuracy30: 0.3820 - 12s/epoch - 29ms/step
Epoch 8/50
401/401 - 11s - loss: 3.1941 - accuracy30: 0.4195 - val_loss: 3.2842 - val_accuracy30: 0.3846 - 11s/epoch - 29ms/step
Epoch 9/50
401/401 - 12s - loss: 3.1839 - accuracy30: 0.4232 - val_loss: 3.2842 - val_accuracy30: 0.3842 - 12s/epoch - 29ms/step
Epoch 10/50
401/401 - 11s - loss: 3.1769 - accuracy30: 0.4261 - val_loss: 3.2877 - val_accuracy30: 0.3821 - 11s/epoch - 29ms/step
Epoch 11/50
401/401 - 12s - loss: 3.1686 - accuracy30: 0.4285 - val_loss: 3.2901 - val_accuracy30: 0.3816 - 12s/epoch - 29ms/step
Epoch 12/50
401/401 - 12s - loss: 3.1606 - accuracy30: 0.4342 - val_loss: 3.2915 - val_accuracy30: 0.3816 - 12s/epoch - 30ms/step
Epoch 13/50
401/401 - 12s - loss: 3.1552 - accuracy30: 0.4348 - val_loss: 3.2980 - val_accuracy30: 0.3819 - 12s/epoch - 30ms/step
Epoch 14/50
401/401 - 12s - loss: 3.1477 - accuracy30: 0.4392 - val_loss: 3.2991 - val_accuracy30: 0.3805 - 12s/epoch - 29ms/step
Epoch 15/50
401/401 - 12s - loss: 3.1405 - accuracy30: 0.4416 - val_loss: 3.3012 - val_accuracy30: 0.3813 - 12s/epoch - 29ms/step
Epoch 16/50
401/401 - 12s - loss: 3.1301 - accuracy30: 0.4461 - val_loss: 3.3072 - val_accuracy30: 0.3784 - 12s/epoch - 30ms/step
Epoch 17/50
401/401 - 12s - loss: 3.1258 - accuracy30: 0.4475 - val_loss: 3.3157 - val_accuracy30: 0.3781 - 12s/epoch - 29ms/step
Epoch 18/50
401/401 - 12s - loss: 3.1161 - accuracy30: 0.4517 - val_loss: 3.3195 - val_accuracy30: 0.3805 - 12s/epoch - 29ms/step
testing model: results/CHTR/W7/deepOF_L2/h30
Evaluating performance on  test set...
1065/1065 - 13s - 13s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0876598
{'0': {'precision': 0.36625829339317334, 'recall': 0.6545696899449435, 'f1-score': 0.469700246190698, 'support': 86275}, '1': {'precision': 0.4057754256787851, 'recall': 0.10984801295627258, 'f1-score': 0.17289215686274512, 'support': 96324}, '2': {'precision': 0.40823344361881, 'recall': 0.41883785378014715, 'f1-score': 0.4134676657364477, 'support': 89851}, 'accuracy': 0.3842429803633694, 'macro avg': {'precision': 0.39342238756358944, 'recall': 0.3944185188937877, 'f1-score': 0.35202002292996365, 'support': 272450}, 'weighted avg': {'precision': 0.394072415152039, 'recall': 0.3842429803633694, 'f1-score': 0.34621962228605285, 'support': 272450}}
[[56473  7989 21813]
 [53004 10581 32739]
 [44712  7506 37633]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0641857
{'0': {'precision': 0.4086440830263276, 'recall': 0.6393825216511079, 'f1-score': 0.4986130754640442, 'support': 35564}, '1': {'precision': 0.49412842508536686, 'recall': 0.17517493873453602, 'f1-score': 0.25865376231580783, 'support': 33869}, '2': {'precision': 0.42112635791881076, 'recall': 0.44371818428265913, 'f1-score': 0.43212719459070975, 'support': 33199}, 'accuracy': 0.42289929066957677, 'macro avg': {'precision': 0.44129962201016837, 'recall': 0.41942521488943435, 'f1-score': 0.39646467745685393, 'support': 102632}, 'weighted avg': {'precision': 0.4408920001024164, 'recall': 0.42289929066957677, 'f1-score': 0.39791887934459363, 'support': 102632}}
[[22739  3331  9494]
 [17181  5933 10755]
 [15725  2743 14731]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.092252
{'0': {'precision': 0.36781471258850357, 'recall': 0.6051930101688222, 'f1-score': 0.45754805000933013, 'support': 10129}, '1': {'precision': 0.3672406888265919, 'recall': 0.08739159439626418, 'f1-score': 0.1411855273287144, 'support': 10493}, '2': {'precision': 0.4020297921100016, 'recall': 0.45654800632028997, 'f1-score': 0.42755799277538403, 'support': 10759}, 'accuracy': 0.38109046875497915, 'macro avg': {'precision': 0.379028397841699, 'recall': 0.38304420362845876, 'f1-score': 0.34209719003780953, 'support': 31381}, 'weighted avg': {'precision': 0.3793534401382329, 'recall': 0.38109046875497915, 'f1-score': 0.34148243781508114, 'support': 31381}}
[[6130  817 3182]
 [5452  917 4124]
 [5084  763 4912]]
training model: results/CHTR/W7/deepOF_L2/h50
Epoch 1/50
401/401 - 14s - loss: 3.3284 - accuracy50: 0.3521 - val_loss: 3.3173 - val_accuracy50: 0.3535 - 14s/epoch - 35ms/step
Epoch 2/50
401/401 - 12s - loss: 3.2830 - accuracy50: 0.3751 - val_loss: 3.2980 - val_accuracy50: 0.3668 - 12s/epoch - 29ms/step
Epoch 3/50
401/401 - 11s - loss: 3.2608 - accuracy50: 0.3882 - val_loss: 3.2981 - val_accuracy50: 0.3691 - 11s/epoch - 29ms/step
Epoch 4/50
401/401 - 11s - loss: 3.2451 - accuracy50: 0.3955 - val_loss: 3.2974 - val_accuracy50: 0.3685 - 11s/epoch - 28ms/step
Epoch 5/50
401/401 - 11s - loss: 3.2300 - accuracy50: 0.4019 - val_loss: 3.2968 - val_accuracy50: 0.3714 - 11s/epoch - 28ms/step
Epoch 6/50
401/401 - 11s - loss: 3.2195 - accuracy50: 0.4052 - val_loss: 3.2947 - val_accuracy50: 0.3714 - 11s/epoch - 29ms/step
Epoch 7/50
401/401 - 12s - loss: 3.2124 - accuracy50: 0.4078 - val_loss: 3.2935 - val_accuracy50: 0.3737 - 12s/epoch - 29ms/step
Epoch 8/50
401/401 - 11s - loss: 3.2012 - accuracy50: 0.4137 - val_loss: 3.2985 - val_accuracy50: 0.3691 - 11s/epoch - 28ms/step
Epoch 9/50
401/401 - 11s - loss: 3.1920 - accuracy50: 0.4186 - val_loss: 3.2973 - val_accuracy50: 0.3730 - 11s/epoch - 28ms/step
Epoch 10/50
401/401 - 11s - loss: 3.1853 - accuracy50: 0.4201 - val_loss: 3.3011 - val_accuracy50: 0.3752 - 11s/epoch - 29ms/step
Epoch 11/50
401/401 - 11s - loss: 3.1789 - accuracy50: 0.4231 - val_loss: 3.3019 - val_accuracy50: 0.3735 - 11s/epoch - 28ms/step
Epoch 12/50
401/401 - 11s - loss: 3.1704 - accuracy50: 0.4271 - val_loss: 3.3065 - val_accuracy50: 0.3763 - 11s/epoch - 28ms/step
Epoch 13/50
401/401 - 11s - loss: 3.1631 - accuracy50: 0.4307 - val_loss: 3.3063 - val_accuracy50: 0.3722 - 11s/epoch - 28ms/step
Epoch 14/50
401/401 - 12s - loss: 3.1573 - accuracy50: 0.4339 - val_loss: 3.3123 - val_accuracy50: 0.3727 - 12s/epoch - 29ms/step
Epoch 15/50
401/401 - 11s - loss: 3.1502 - accuracy50: 0.4370 - val_loss: 3.3192 - val_accuracy50: 0.3740 - 11s/epoch - 28ms/step
Epoch 16/50
401/401 - 11s - loss: 3.1416 - accuracy50: 0.4396 - val_loss: 3.3208 - val_accuracy50: 0.3738 - 11s/epoch - 28ms/step
Epoch 17/50
401/401 - 11s - loss: 3.1343 - accuracy50: 0.4427 - val_loss: 3.3307 - val_accuracy50: 0.3731 - 11s/epoch - 29ms/step
testing model: results/CHTR/W7/deepOF_L2/h50
Evaluating performance on  test set...
1065/1065 - 12s - 12s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0882427
{'0': {'precision': 0.3641428772532952, 'recall': 0.5753552948889045, 'f1-score': 0.4460073233480496, 'support': 85422}, '1': {'precision': 0.3903856936288252, 'recall': 0.13886672824991603, 'f1-score': 0.20486097668620454, 'support': 95264}, '2': {'precision': 0.4062783558893372, 'recall': 0.4586548101652064, 'f1-score': 0.43088074202233845, 'support': 91764}, 'accuracy': 0.38342815195448704, 'macro avg': {'precision': 0.38693564225715255, 'recall': 0.39095894443467566, 'f1-score': 0.36058301401886417, 'support': 272450}, 'weighted avg': {'precision': 0.3875105253382878, 'recall': 0.38342815195448704, 'f1-score': 0.3565940688897396, 'support': 272450}}
[[49148 10650 25624]
 [46153 13229 35882]
 [39668 10008 42088]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.070694
{'0': {'precision': 0.4103550598587946, 'recall': 0.563353374164185, 'f1-score': 0.47483394309665045, 'support': 35594}, '1': {'precision': 0.45402974749221725, 'recall': 0.19382752510336682, 'f1-score': 0.2716754631066957, 'support': 33860}, '2': {'precision': 0.4033119658119658, 'recall': 0.47787690638374825, 'f1-score': 0.4374396468478411, 'support': 33178}, 'accuracy': 0.41380855873411804, 'macro avg': {'precision': 0.42256559105432584, 'recall': 0.4116859352171, 'f1-score': 0.3946496843503957, 'support': 102632}, 'weighted avg': {'precision': 0.422487232563039, 'recall': 0.41380855873411804, 'f1-score': 0.3957200790639621, 'support': 102632}}
[[20052  4338 11204]
 [15044  6563 12253]
 [13769  3554 15855]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0954317
{'0': {'precision': 0.3647560723869814, 'recall': 0.5321754843891175, 'f1-score': 0.43284069568057487, 'support': 9961}, '1': {'precision': 0.3443178318447798, 'recall': 0.10506531341039375, 'f1-score': 0.16100230414746544, 'support': 10641}, '2': {'precision': 0.38754503345342256, 'recall': 0.489006401335931, 'f1-score': 0.43240360951599677, 'support': 10779}, 'accuracy': 0.37251840285523086, 'macro avg': {'precision': 0.36553964589506127, 'recall': 0.37541573304514736, 'f1-score': 0.342082203114679, 'support': 31381}, 'weighted avg': {'precision': 0.36565339540809616, 'recall': 0.37251840285523086, 'f1-score': 0.3405127368496962, 'support': 31381}}
[[5301 1078 3582]
 [4775 1118 4748]
 [4457 1051 5271]]
training model: results/CHTR/W7/deepOF_L2/h100
Epoch 1/50
401/401 - 14s - loss: 3.3332 - accuracy100: 0.3476 - val_loss: 3.3132 - val_accuracy100: 0.3514 - 14s/epoch - 36ms/step
Epoch 2/50
401/401 - 12s - loss: 3.2914 - accuracy100: 0.3690 - val_loss: 3.3019 - val_accuracy100: 0.3568 - 12s/epoch - 29ms/step
Epoch 3/50
401/401 - 12s - loss: 3.2734 - accuracy100: 0.3763 - val_loss: 3.2985 - val_accuracy100: 0.3604 - 12s/epoch - 29ms/step
Epoch 4/50
401/401 - 12s - loss: 3.2587 - accuracy100: 0.3840 - val_loss: 3.2962 - val_accuracy100: 0.3623 - 12s/epoch - 29ms/step
Epoch 5/50
401/401 - 12s - loss: 3.2456 - accuracy100: 0.3908 - val_loss: 3.2952 - val_accuracy100: 0.3605 - 12s/epoch - 29ms/step
Epoch 6/50
401/401 - 11s - loss: 3.2348 - accuracy100: 0.3941 - val_loss: 3.2908 - val_accuracy100: 0.3675 - 11s/epoch - 28ms/step
Epoch 7/50
401/401 - 12s - loss: 3.2251 - accuracy100: 0.3993 - val_loss: 3.2927 - val_accuracy100: 0.3697 - 12s/epoch - 29ms/step
Epoch 8/50
401/401 - 12s - loss: 3.2197 - accuracy100: 0.4017 - val_loss: 3.2984 - val_accuracy100: 0.3673 - 12s/epoch - 29ms/step
Epoch 9/50
401/401 - 12s - loss: 3.2081 - accuracy100: 0.4093 - val_loss: 3.2972 - val_accuracy100: 0.3678 - 12s/epoch - 29ms/step
Epoch 10/50
401/401 - 12s - loss: 3.2021 - accuracy100: 0.4126 - val_loss: 3.3000 - val_accuracy100: 0.3681 - 12s/epoch - 29ms/step
Epoch 11/50
401/401 - 11s - loss: 3.1960 - accuracy100: 0.4154 - val_loss: 3.3012 - val_accuracy100: 0.3671 - 11s/epoch - 29ms/step
Epoch 12/50
401/401 - 11s - loss: 3.1892 - accuracy100: 0.4179 - val_loss: 3.3033 - val_accuracy100: 0.3672 - 11s/epoch - 28ms/step
Epoch 13/50
401/401 - 11s - loss: 3.1812 - accuracy100: 0.4208 - val_loss: 3.3110 - val_accuracy100: 0.3645 - 11s/epoch - 28ms/step
Epoch 14/50
401/401 - 11s - loss: 3.1725 - accuracy100: 0.4258 - val_loss: 3.3148 - val_accuracy100: 0.3657 - 11s/epoch - 28ms/step
Epoch 15/50
401/401 - 11s - loss: 3.1668 - accuracy100: 0.4287 - val_loss: 3.3218 - val_accuracy100: 0.3655 - 11s/epoch - 28ms/step
Epoch 16/50
401/401 - 12s - loss: 3.1579 - accuracy100: 0.4335 - val_loss: 3.3282 - val_accuracy100: 0.3645 - 12s/epoch - 29ms/step
testing model: results/CHTR/W7/deepOF_L2/h100
Evaluating performance on  test set...
1065/1065 - 12s - 12s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0945656
{'0': {'precision': 0.34843371059013745, 'recall': 0.40653406746289067, 'f1-score': 0.3752482628402901, 'support': 84817}, '1': {'precision': 0.3475435816164818, 'recall': 0.25684898689296093, 'f1-score': 0.2953915103870103, 'support': 93919}, '2': {'precision': 0.393380092236741, 'recall': 0.4368931002838423, 'f1-score': 0.4139963800721963, 'support': 93714}, 'accuracy': 0.365377133418976, 'macro avg': {'precision': 0.36311912814778674, 'recall': 0.3667587182132313, 'f1-score': 0.3615453844331656, 'support': 272450}, 'weighted avg': {'precision': 0.3635869687532978, 'recall': 0.365377133418976, 'f1-score': 0.3610481333655654, 'support': 272450}}
[[34481 22453 27883]
 [34542 24123 35254]
 [29937 22834 40943]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0788783
{'0': {'precision': 0.4117079538038081, 'recall': 0.4072816079047833, 'f1-score': 0.4094828194454244, 'support': 35624}, '1': {'precision': 0.39234760051880674, 'recall': 0.3228771347248577, 'f1-score': 0.35423850107345, 'support': 33728}, '2': {'precision': 0.38836886590134984, 'recall': 0.46253004807692305, 'f1-score': 0.4222176506891586, 'support': 33280}, 'accuracy': 0.3974588822199704, 'macro avg': {'precision': 0.3974748067413216, 'recall': 0.3975629302355213, 'f1-score': 0.3953129904026777, 'support': 102632}, 'weighted avg': {'precision': 0.39777749506783555, 'recall': 0.3974588822199704, 'f1-score': 0.3954573187608575, 'support': 102632}}
[[14509  9073 12042]
 [10638 10890 12200]
 [10094  7793 15393]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0958711
{'0': {'precision': 0.3533518119289601, 'recall': 0.3527723685559086, 'f1-score': 0.3530618524976921, 'support': 9757}, '1': {'precision': 0.3412175782824889, 'recall': 0.2396413402548372, 'f1-score': 0.28154801508094923, 'support': 10595}, '2': {'precision': 0.3860130995140503, 'recall': 0.49696255326865535, 'f1-score': 0.4345172031076581, 'support': 11029}, 'accuracy': 0.36525286001083457, 'macro avg': {'precision': 0.36019416324183307, 'recall': 0.36312542069313364, 'f1-score': 0.3563756902287665, 'support': 31381}, 'weighted avg': {'precision': 0.3607339583007009, 'recall': 0.36525286001083457, 'f1-score': 0.35754488217956726, 'support': 31381}}
[[3442 2453 3862]
 [3200 2539 4856]
 [3099 2449 5481]]
training model: results/CHTR/W7/deepOF_L2/h200
Epoch 1/50
401/401 - 14s - loss: 3.3425 - accuracy200: 0.3412 - val_loss: 3.3182 - val_accuracy200: 0.3462 - 14s/epoch - 34ms/step
Epoch 2/50
401/401 - 11s - loss: 3.3053 - accuracy200: 0.3582 - val_loss: 3.3080 - val_accuracy200: 0.3512 - 11s/epoch - 28ms/step
Epoch 3/50
401/401 - 11s - loss: 3.2903 - accuracy200: 0.3656 - val_loss: 3.3009 - val_accuracy200: 0.3522 - 11s/epoch - 29ms/step
Epoch 4/50
401/401 - 11s - loss: 3.2806 - accuracy200: 0.3710 - val_loss: 3.2998 - val_accuracy200: 0.3521 - 11s/epoch - 28ms/step
Epoch 5/50
401/401 - 11s - loss: 3.2693 - accuracy200: 0.3754 - val_loss: 3.2946 - val_accuracy200: 0.3559 - 11s/epoch - 29ms/step
Epoch 6/50
401/401 - 11s - loss: 3.2606 - accuracy200: 0.3797 - val_loss: 3.2967 - val_accuracy200: 0.3588 - 11s/epoch - 28ms/step
Epoch 7/50
401/401 - 11s - loss: 3.2530 - accuracy200: 0.3841 - val_loss: 3.2939 - val_accuracy200: 0.3596 - 11s/epoch - 29ms/step
Epoch 8/50
401/401 - 11s - loss: 3.2427 - accuracy200: 0.3887 - val_loss: 3.3001 - val_accuracy200: 0.3573 - 11s/epoch - 29ms/step
Epoch 9/50
401/401 - 11s - loss: 3.2352 - accuracy200: 0.3928 - val_loss: 3.2994 - val_accuracy200: 0.3589 - 11s/epoch - 28ms/step
Epoch 10/50
401/401 - 11s - loss: 3.2295 - accuracy200: 0.3955 - val_loss: 3.3034 - val_accuracy200: 0.3573 - 11s/epoch - 29ms/step
Epoch 11/50
401/401 - 11s - loss: 3.2218 - accuracy200: 0.3996 - val_loss: 3.3026 - val_accuracy200: 0.3589 - 11s/epoch - 28ms/step
Epoch 12/50
401/401 - 12s - loss: 3.2145 - accuracy200: 0.4030 - val_loss: 3.3082 - val_accuracy200: 0.3589 - 12s/epoch - 30ms/step
Epoch 13/50
401/401 - 12s - loss: 3.2070 - accuracy200: 0.4093 - val_loss: 3.3122 - val_accuracy200: 0.3593 - 12s/epoch - 29ms/step
Epoch 14/50
401/401 - 12s - loss: 3.2012 - accuracy200: 0.4126 - val_loss: 3.3138 - val_accuracy200: 0.3557 - 12s/epoch - 29ms/step
Epoch 15/50
401/401 - 12s - loss: 3.1939 - accuracy200: 0.4163 - val_loss: 3.3153 - val_accuracy200: 0.3617 - 12s/epoch - 29ms/step
Epoch 16/50
401/401 - 12s - loss: 3.1864 - accuracy200: 0.4202 - val_loss: 3.3197 - val_accuracy200: 0.3602 - 12s/epoch - 29ms/step
Epoch 17/50
401/401 - 12s - loss: 3.1809 - accuracy200: 0.4216 - val_loss: 3.3241 - val_accuracy200: 0.3612 - 12s/epoch - 29ms/step
testing model: results/CHTR/W7/deepOF_L2/h200
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0990947
{'0': {'precision': 0.32140830389715674, 'recall': 0.33764432494251334, 'f1-score': 0.32932632403374906, 'support': 82193}, '1': {'precision': 0.34283887658157275, 'recall': 0.24439074539230338, 'f1-score': 0.2853624730836819, 'support': 94353}, '2': {'precision': 0.37727815828887806, 'recall': 0.46753003003003, 'f1-score': 0.4175832363213039, 'support': 95904}, 'accuracy': 0.35106992108643786, 'macro avg': {'precision': 0.34717511292253583, 'recall': 0.3498550334549489, 'f1-score': 0.3440906778129116, 'support': 272450}, 'weighted avg': {'precision': 0.3484965084854348, 'recall': 0.35106992108643786, 'f1-score': 0.3451680186101263, 'support': 272450}}
[[27752 20658 33783]
 [31069 23059 40225]
 [27524 23542 44838]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0841547
{'0': {'precision': 0.4079535149296342, 'recall': 0.3429329719351742, 'f1-score': 0.372628123513982, 'support': 35418}, '1': {'precision': 0.3899540307209328, 'recall': 0.3081694134325713, 'f1-score': 0.3442712199950507, 'support': 33858}, '2': {'precision': 0.371827686434428, 'recall': 0.5139105408322341, 'f1-score': 0.43147323114098013, 'support': 33356}, 'accuracy': 0.3870332839660145, 'macro avg': {'precision': 0.3899117440283317, 'recall': 0.38833764206665994, 'f1-score': 0.38279085821667097, 'support': 102632}, 'weighted avg': {'precision': 0.3902744316844055, 'recall': 0.3870332839660145, 'f1-score': 0.382398267042922, 'support': 102632}}
[[12146  8537 14735]
 [ 9199 10434 14225]
 [ 8428  7786 17142]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0962293
{'0': {'precision': 0.34398742467906734, 'recall': 0.27823691460055094, 'f1-score': 0.3076382380506092, 'support': 9438}, '1': {'precision': 0.33939818054583626, 'recall': 0.22727272727272727, 'f1-score': 0.272242492281785, 'support': 10670}, '2': {'precision': 0.37772557523189976, 'recall': 0.5562849285904373, 'f1-score': 0.4499372197309417, 'support': 11273}, 'accuracy': 0.3607915617730474, 'macro avg': {'precision': 0.35370372681893447, 'recall': 0.3539315234879052, 'f1-score': 0.343272650021112, 'support': 31381}, 'weighted avg': {'precision': 0.35454677384832595, 'recall': 0.3607915617730474, 'f1-score': 0.34672124410934013, 'support': 31381}}
[[2626 2225 4587]
 [2501 2425 5744]
 [2507 2495 6271]]
training model: results/CHTR/W7/deepOF_L2/h300
Epoch 1/50
401/401 - 14s - loss: 3.3434 - accuracy300: 0.3431 - val_loss: 3.3135 - val_accuracy300: 0.3507 - 14s/epoch - 35ms/step
Epoch 2/50
401/401 - 12s - loss: 3.3088 - accuracy300: 0.3571 - val_loss: 3.3030 - val_accuracy300: 0.3520 - 12s/epoch - 29ms/step
Epoch 3/50
401/401 - 12s - loss: 3.2916 - accuracy300: 0.3652 - val_loss: 3.2979 - val_accuracy300: 0.3542 - 12s/epoch - 29ms/step
Epoch 4/50
401/401 - 11s - loss: 3.2816 - accuracy300: 0.3703 - val_loss: 3.2960 - val_accuracy300: 0.3547 - 11s/epoch - 29ms/step
Epoch 5/50
401/401 - 11s - loss: 3.2700 - accuracy300: 0.3757 - val_loss: 3.2938 - val_accuracy300: 0.3566 - 11s/epoch - 29ms/step
Epoch 6/50
401/401 - 11s - loss: 3.2625 - accuracy300: 0.3792 - val_loss: 3.2935 - val_accuracy300: 0.3580 - 11s/epoch - 29ms/step
Epoch 7/50
401/401 - 12s - loss: 3.2556 - accuracy300: 0.3835 - val_loss: 3.2925 - val_accuracy300: 0.3606 - 12s/epoch - 29ms/step
Epoch 8/50
401/401 - 12s - loss: 3.2498 - accuracy300: 0.3864 - val_loss: 3.2961 - val_accuracy300: 0.3600 - 12s/epoch - 29ms/step
Epoch 9/50
401/401 - 11s - loss: 3.2420 - accuracy300: 0.3900 - val_loss: 3.2952 - val_accuracy300: 0.3609 - 11s/epoch - 29ms/step
Epoch 10/50
401/401 - 11s - loss: 3.2353 - accuracy300: 0.3948 - val_loss: 3.2970 - val_accuracy300: 0.3560 - 11s/epoch - 29ms/step
Epoch 11/50
401/401 - 11s - loss: 3.2297 - accuracy300: 0.3957 - val_loss: 3.2991 - val_accuracy300: 0.3585 - 11s/epoch - 29ms/step
Epoch 12/50
401/401 - 11s - loss: 3.2229 - accuracy300: 0.4002 - val_loss: 3.3047 - val_accuracy300: 0.3553 - 11s/epoch - 29ms/step
Epoch 13/50
401/401 - 11s - loss: 3.2153 - accuracy300: 0.4044 - val_loss: 3.3064 - val_accuracy300: 0.3537 - 11s/epoch - 28ms/step
Epoch 14/50
401/401 - 11s - loss: 3.2097 - accuracy300: 0.4074 - val_loss: 3.3101 - val_accuracy300: 0.3540 - 11s/epoch - 29ms/step
Epoch 15/50
401/401 - 11s - loss: 3.2008 - accuracy300: 0.4123 - val_loss: 3.3129 - val_accuracy300: 0.3593 - 11s/epoch - 29ms/step
Epoch 16/50
401/401 - 11s - loss: 3.1963 - accuracy300: 0.4164 - val_loss: 3.3155 - val_accuracy300: 0.3562 - 11s/epoch - 28ms/step
Epoch 17/50
401/401 - 11s - loss: 3.1900 - accuracy300: 0.4174 - val_loss: 3.3225 - val_accuracy300: 0.3547 - 11s/epoch - 28ms/step
testing model: results/CHTR/W7/deepOF_L2/h300
Evaluating performance on  test set...
1065/1065 - 12s - 12s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0995032
{'0': {'precision': 0.31175798423488854, 'recall': 0.19727924505178013, 'f1-score': 0.24164590026120633, 'support': 81595}, '1': {'precision': 0.34144441822043897, 'recall': 0.31108817426270574, 'f1-score': 0.32556020005738434, 'support': 93009}, '2': {'precision': 0.3738177649419079, 'recall': 0.5198781759090816, 'f1-score': 0.43491234295045805, 'support': 97846}, 'accuracy': 0.3519875206459901, 'macro avg': {'precision': 0.3423400557990785, 'recall': 0.34274853174118913, 'f1-score': 0.3340394810896829, 'support': 272450}, 'weighted avg': {'precision': 0.34418010514375647, 'recall': 0.3519875206459901, 'f1-score': 0.33970107905039787, 'support': 272450}}
[[16097 25813 39685]
 [18551 28934 45524]
 [16985 29993 50868]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0859358
{'0': {'precision': 0.41956484495459995, 'recall': 0.20838415066511615, 'f1-score': 0.27846422073984234, 'support': 35257}, '1': {'precision': 0.384937616780182, 'recall': 0.3773746565426773, 'f1-score': 0.3811186202986767, 'support': 33847}, '2': {'precision': 0.36465854175090007, 'recall': 0.5649009782868051, 'f1-score': 0.44321199995319827, 'support': 33528}, 'accuracy': 0.38058305401823994, 'macro avg': {'precision': 0.38972033449522736, 'recall': 0.3835532618315329, 'f1-score': 0.36759828033057246, 'support': 102632}, 'weighted avg': {'precision': 0.3902082473453439, 'recall': 0.38058305401823994, 'f1-score': 0.3661386985180525, 'support': 102632}}
[[ 7347 10861 17049]
 [ 5124 12773 15950]
 [ 5040  9548 18940]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965953
{'0': {'precision': 0.33539094650205764, 'recall': 0.15546841882153456, 'f1-score': 0.21245474293989863, 'support': 9436}, '1': {'precision': 0.33413225841594946, 'recall': 0.2925131139723414, 'f1-score': 0.3119406021155411, 'support': 10485}, '2': {'precision': 0.37760825667489345, 'recall': 0.587434554973822, 'f1-score': 0.4597104616225075, 'support': 11460}, 'accuracy': 0.3590070424779325, 'macro avg': {'precision': 0.3490438205309669, 'recall': 0.345138695922566, 'f1-score': 0.32803526889264906, 'support': 31381}, 'weighted avg': {'precision': 0.3503876970835514, 'recall': 0.3590070424779325, 'f1-score': 0.33598999578586625, 'support': 31381}}
[[1467 2878 5091]
 [1413 3067 6005]
 [1494 3234 6732]]
training model: results/CHTR/W7/deepOF_L2/h500
Epoch 1/50
401/401 - 14s - loss: 3.3471 - accuracy500: 0.3435 - val_loss: 3.3071 - val_accuracy500: 0.3539 - 14s/epoch - 36ms/step
Epoch 2/50
401/401 - 12s - loss: 3.3126 - accuracy500: 0.3561 - val_loss: 3.2982 - val_accuracy500: 0.3616 - 12s/epoch - 29ms/step
Epoch 3/50
401/401 - 12s - loss: 3.2973 - accuracy500: 0.3605 - val_loss: 3.2929 - val_accuracy500: 0.3658 - 12s/epoch - 29ms/step
Epoch 4/50
401/401 - 12s - loss: 3.2882 - accuracy500: 0.3647 - val_loss: 3.2930 - val_accuracy500: 0.3658 - 12s/epoch - 29ms/step
Epoch 5/50
401/401 - 12s - loss: 3.2813 - accuracy500: 0.3678 - val_loss: 3.2917 - val_accuracy500: 0.3697 - 12s/epoch - 29ms/step
Epoch 6/50
401/401 - 12s - loss: 3.2729 - accuracy500: 0.3737 - val_loss: 3.2913 - val_accuracy500: 0.3686 - 12s/epoch - 29ms/step
Epoch 7/50
401/401 - 11s - loss: 3.2674 - accuracy500: 0.3749 - val_loss: 3.2920 - val_accuracy500: 0.3668 - 11s/epoch - 29ms/step
Epoch 8/50
401/401 - 11s - loss: 3.2620 - accuracy500: 0.3778 - val_loss: 3.2946 - val_accuracy500: 0.3682 - 11s/epoch - 29ms/step
Epoch 9/50
401/401 - 12s - loss: 3.2552 - accuracy500: 0.3828 - val_loss: 3.2949 - val_accuracy500: 0.3666 - 12s/epoch - 29ms/step
Epoch 10/50
401/401 - 12s - loss: 3.2486 - accuracy500: 0.3866 - val_loss: 3.2956 - val_accuracy500: 0.3662 - 12s/epoch - 29ms/step
Epoch 11/50
401/401 - 12s - loss: 3.2441 - accuracy500: 0.3886 - val_loss: 3.3008 - val_accuracy500: 0.3649 - 12s/epoch - 29ms/step
Epoch 12/50
401/401 - 12s - loss: 3.2361 - accuracy500: 0.3929 - val_loss: 3.3017 - val_accuracy500: 0.3622 - 12s/epoch - 29ms/step
Epoch 13/50
401/401 - 12s - loss: 3.2297 - accuracy500: 0.3967 - val_loss: 3.3039 - val_accuracy500: 0.3614 - 12s/epoch - 30ms/step
Epoch 14/50
401/401 - 12s - loss: 3.2241 - accuracy500: 0.4008 - val_loss: 3.3051 - val_accuracy500: 0.3640 - 12s/epoch - 29ms/step
Epoch 15/50
401/401 - 12s - loss: 3.2169 - accuracy500: 0.4035 - val_loss: 3.3111 - val_accuracy500: 0.3620 - 12s/epoch - 29ms/step
Epoch 16/50
401/401 - 11s - loss: 3.2108 - accuracy500: 0.4065 - val_loss: 3.3119 - val_accuracy500: 0.3613 - 11s/epoch - 29ms/step
testing model: results/CHTR/W7/deepOF_L2/h500
Evaluating performance on  test set...
1065/1065 - 13s - 13s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985996
{'0': {'precision': 0.28779709507042256, 'recall': 0.0653695233810702, 'f1-score': 0.10653984806207865, 'support': 80022}, '1': {'precision': 0.3551528917798083, 'recall': 0.21988429945772028, 'f1-score': 0.27160867505395586, 'support': 93863}, '2': {'precision': 0.3664234990645439, 'recall': 0.7292446608836808, 'f1-score': 0.4877615140842681, 'support': 98565}, 'accuracy': 0.35877408698843827, 'macro avg': {'precision': 0.33645782863825824, 'recall': 0.33816616124082377, 'f1-score': 0.28863667906676754, 'support': 272450}, 'weighted avg': {'precision': 0.3394470442582135, 'recall': 0.35877408698843827, 'f1-score': 0.3013240977204221, 'support': 272450}}
[[ 5231 17140 57651]
 [ 6592 20639 66632]
 [ 6353 20334 71878]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.095334
{'0': {'precision': 0.42353313300648426, 'recall': 0.07670934662427316, 'f1-score': 0.12989280690692148, 'support': 34911}, '1': {'precision': 0.3898889822637003, 'recall': 0.2596694847851062, 'f1-score': 0.3117264304406252, 'support': 33947}, '2': {'precision': 0.3482089552238806, 'recall': 0.7598448510688696, 'f1-score': 0.4775666672869717, 'support': 33774}, 'accuracy': 0.36203133525606046, 'macro avg': {'precision': 0.387210356831355, 'recall': 0.3654078941594163, 'f1-score': 0.30639530154483946, 'support': 102632}, 'weighted avg': {'precision': 0.38761727084171166, 'recall': 0.36203133525606046, 'f1-score': 0.30444891980128636, 'support': 102632}}
[[ 2678  7469 24764]
 [ 1859  8815 23273]
 [ 1786  6325 25663]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0968982
{'0': {'precision': 0.3008298755186722, 'recall': 0.04592483108108108, 'f1-score': 0.07968492397875068, 'support': 9472}, '1': {'precision': 0.3237996186514127, 'recall': 0.18736208625877632, 'f1-score': 0.23737213291822856, 'support': 9970}, '2': {'precision': 0.38355540842506003, 'recall': 0.7763631794957702, 'f1-score': 0.5134468910123252, 'support': 11939}, 'accuracy': 0.3687581657690959, 'macro avg': {'precision': 0.3360616341983817, 'recall': 0.3365500322785426, 'f1-score': 0.2768346493031015, 'support': 31381}, 'weighted avg': {'precision': 0.3396007393025792, 'recall': 0.3687581657690959, 'f1-score': 0.2948095407067211, 'support': 31381}}
[[ 435 1761 7276]
 [ 481 1868 7621]
 [ 530 2140 9269]]
training model: results/CHTR/W7/deepOF_L2/h1000
Epoch 1/50
401/401 - 14s - loss: 3.3461 - accuracy1000: 0.3501 - val_loss: 3.3355 - val_accuracy1000: 0.3472 - 14s/epoch - 34ms/step
Epoch 2/50
401/401 - 12s - loss: 3.3168 - accuracy1000: 0.3530 - val_loss: 3.3222 - val_accuracy1000: 0.3551 - 12s/epoch - 29ms/step
Epoch 3/50
401/401 - 12s - loss: 3.3023 - accuracy1000: 0.3570 - val_loss: 3.3146 - val_accuracy1000: 0.3662 - 12s/epoch - 29ms/step
Epoch 4/50
401/401 - 11s - loss: 3.2935 - accuracy1000: 0.3612 - val_loss: 3.3118 - val_accuracy1000: 0.3710 - 11s/epoch - 28ms/step
Epoch 5/50
401/401 - 12s - loss: 3.2873 - accuracy1000: 0.3643 - val_loss: 3.3049 - val_accuracy1000: 0.3767 - 12s/epoch - 29ms/step
Epoch 6/50
401/401 - 12s - loss: 3.2806 - accuracy1000: 0.3686 - val_loss: 3.3043 - val_accuracy1000: 0.3753 - 12s/epoch - 29ms/step
Epoch 7/50
401/401 - 11s - loss: 3.2758 - accuracy1000: 0.3727 - val_loss: 3.3065 - val_accuracy1000: 0.3768 - 11s/epoch - 29ms/step
Epoch 8/50
401/401 - 12s - loss: 3.2716 - accuracy1000: 0.3733 - val_loss: 3.3065 - val_accuracy1000: 0.3758 - 12s/epoch - 29ms/step
Epoch 9/50
401/401 - 11s - loss: 3.2669 - accuracy1000: 0.3775 - val_loss: 3.3062 - val_accuracy1000: 0.3757 - 11s/epoch - 29ms/step
Epoch 10/50
401/401 - 11s - loss: 3.2625 - accuracy1000: 0.3821 - val_loss: 3.3064 - val_accuracy1000: 0.3755 - 11s/epoch - 29ms/step
Epoch 11/50
401/401 - 12s - loss: 3.2567 - accuracy1000: 0.3863 - val_loss: 3.3101 - val_accuracy1000: 0.3755 - 12s/epoch - 29ms/step
Epoch 12/50
401/401 - 11s - loss: 3.2515 - accuracy1000: 0.3900 - val_loss: 3.3128 - val_accuracy1000: 0.3720 - 11s/epoch - 29ms/step
Epoch 13/50
401/401 - 11s - loss: 3.2454 - accuracy1000: 0.3921 - val_loss: 3.3163 - val_accuracy1000: 0.3720 - 11s/epoch - 29ms/step
Epoch 14/50
401/401 - 11s - loss: 3.2387 - accuracy1000: 0.3965 - val_loss: 3.3181 - val_accuracy1000: 0.3717 - 11s/epoch - 28ms/step
Epoch 15/50
401/401 - 11s - loss: 3.2326 - accuracy1000: 0.3998 - val_loss: 3.3263 - val_accuracy1000: 0.3695 - 11s/epoch - 29ms/step
Epoch 16/50
401/401 - 12s - loss: 3.2278 - accuracy1000: 0.4020 - val_loss: 3.3286 - val_accuracy1000: 0.3682 - 12s/epoch - 29ms/step
testing model: results/CHTR/W7/deepOF_L2/h1000
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993702
{'0': {'precision': 0.2683818155240462, 'recall': 0.024089113977196687, 'f1-score': 0.04421007007151628, 'support': 76217}, '1': {'precision': 0.3506540818016228, 'recall': 0.22207307353496372, 'f1-score': 0.27192993720544995, 'support': 95356}, '2': {'precision': 0.3697513388136576, 'recall': 0.752203178127819, 'f1-score': 0.49579216977680207, 'support': 100877}, 'accuracy': 0.36297302257294917, 'macro avg': {'precision': 0.32959574537977554, 'recall': 0.33278845521332645, 'f1-score': 0.27064405901792277, 'support': 272450}, 'weighted avg': {'precision': 0.3347096100700206, 'recall': 0.36297302257294917, 'f1-score': 0.29111299949854325, 'support': 272450}}
[[ 1836 16802 57579]
 [ 2420 21176 71760]
 [ 2585 22412 75880]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.110251
{'0': {'precision': 0.4608043626448534, 'recall': 0.03779809332103218, 'f1-score': 0.0698653851122652, 'support': 35769}, '1': {'precision': 0.3731671877063978, 'recall': 0.2502066603684459, 'f1-score': 0.29955993849742857, 'support': 33872}, '2': {'precision': 0.3382519126605791, 'recall': 0.7893364857082235, 'f1-score': 0.4735674407608795, 'support': 32991}, 'accuracy': 0.34948164315223323, 'macro avg': {'precision': 0.3907411543372768, 'recall': 0.3591137464659005, 'f1-score': 0.28099758812352443, 'support': 102632}, 'weighted avg': {'precision': 0.3924867398084421, 'recall': 0.34948164315223323, 'f1-score': 0.2754420905273958, 'support': 102632}}
[[ 1352  7996 26421]
 [  872  8475 24525]
 [  710  6240 26041]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1036582
{'0': {'precision': 0.28433268858800775, 'recall': 0.015214241357896915, 'f1-score': 0.02888299440023578, 'support': 9662}, '1': {'precision': 0.30826811840762164, 'recall': 0.19111908026579474, 'f1-score': 0.23595286151442152, 'support': 9481}, '2': {'precision': 0.3912991275114064, 'recall': 0.7989050498447459, 'f1-score': 0.5253062540296582, 'support': 12238}, 'accuracy': 0.37398425799050383, 'macro avg': {'precision': 0.3279666448356786, 'recall': 0.3350794571561459, 'f1-score': 0.26338070331477187, 'support': 31381}, 'weighted avg': {'precision': 0.3332790921336026, 'recall': 0.37398425799050383, 'f1-score': 0.28503981736491085, 'support': 31381}}
[[ 147 1835 7680]
 [ 140 1812 7529]
 [ 230 2231 9777]]
training model: results/CHTR/W7/deepVOL_L2/h10
Epoch 1/50
401/401 - 14s - loss: 3.3254 - accuracy10: 0.3547 - val_loss: 3.3412 - val_accuracy10: 0.3389 - 14s/epoch - 34ms/step
Epoch 2/50
401/401 - 11s - loss: 3.2968 - accuracy10: 0.3634 - val_loss: 3.3219 - val_accuracy10: 0.3442 - 11s/epoch - 28ms/step
Epoch 3/50
401/401 - 11s - loss: 3.2789 - accuracy10: 0.3719 - val_loss: 3.3123 - val_accuracy10: 0.3490 - 11s/epoch - 28ms/step
Epoch 4/50
401/401 - 11s - loss: 3.2679 - accuracy10: 0.3771 - val_loss: 3.3000 - val_accuracy10: 0.3597 - 11s/epoch - 28ms/step
Epoch 5/50
401/401 - 11s - loss: 3.2611 - accuracy10: 0.3810 - val_loss: 3.2930 - val_accuracy10: 0.3633 - 11s/epoch - 27ms/step
Epoch 6/50
401/401 - 11s - loss: 3.2549 - accuracy10: 0.3841 - val_loss: 3.2891 - val_accuracy10: 0.3655 - 11s/epoch - 28ms/step
Epoch 7/50
401/401 - 11s - loss: 3.2448 - accuracy10: 0.3888 - val_loss: 3.2812 - val_accuracy10: 0.3778 - 11s/epoch - 28ms/step
Epoch 8/50
401/401 - 11s - loss: 3.2372 - accuracy10: 0.3926 - val_loss: 3.2853 - val_accuracy10: 0.3719 - 11s/epoch - 28ms/step
Epoch 9/50
401/401 - 11s - loss: 3.2319 - accuracy10: 0.3943 - val_loss: 3.2813 - val_accuracy10: 0.3749 - 11s/epoch - 28ms/step
Epoch 10/50
401/401 - 11s - loss: 3.2255 - accuracy10: 0.3973 - val_loss: 3.2790 - val_accuracy10: 0.3750 - 11s/epoch - 28ms/step
Epoch 11/50
401/401 - 11s - loss: 3.2214 - accuracy10: 0.3990 - val_loss: 3.2766 - val_accuracy10: 0.3783 - 11s/epoch - 28ms/step
Epoch 12/50
401/401 - 11s - loss: 3.2156 - accuracy10: 0.4019 - val_loss: 3.2756 - val_accuracy10: 0.3805 - 11s/epoch - 27ms/step
Epoch 13/50
401/401 - 11s - loss: 3.2121 - accuracy10: 0.4046 - val_loss: 3.2776 - val_accuracy10: 0.3759 - 11s/epoch - 28ms/step
Epoch 14/50
401/401 - 11s - loss: 3.2096 - accuracy10: 0.4025 - val_loss: 3.2741 - val_accuracy10: 0.3835 - 11s/epoch - 27ms/step
Epoch 15/50
401/401 - 11s - loss: 3.2051 - accuracy10: 0.4041 - val_loss: 3.2765 - val_accuracy10: 0.3838 - 11s/epoch - 27ms/step
Epoch 16/50
401/401 - 11s - loss: 3.1994 - accuracy10: 0.4077 - val_loss: 3.2825 - val_accuracy10: 0.3748 - 11s/epoch - 28ms/step
Epoch 17/50
401/401 - 11s - loss: 3.1966 - accuracy10: 0.4090 - val_loss: 3.2805 - val_accuracy10: 0.3819 - 11s/epoch - 27ms/step
Epoch 18/50
401/401 - 11s - loss: 3.1940 - accuracy10: 0.4099 - val_loss: 3.2849 - val_accuracy10: 0.3770 - 11s/epoch - 27ms/step
Epoch 19/50
401/401 - 11s - loss: 3.1897 - accuracy10: 0.4119 - val_loss: 3.2825 - val_accuracy10: 0.3815 - 11s/epoch - 27ms/step
Epoch 20/50
401/401 - 11s - loss: 3.1881 - accuracy10: 0.4115 - val_loss: 3.2771 - val_accuracy10: 0.3822 - 11s/epoch - 27ms/step
Epoch 21/50
401/401 - 11s - loss: 3.1845 - accuracy10: 0.4137 - val_loss: 3.2767 - val_accuracy10: 0.3856 - 11s/epoch - 27ms/step
Epoch 22/50
401/401 - 11s - loss: 3.1799 - accuracy10: 0.4157 - val_loss: 3.2804 - val_accuracy10: 0.3864 - 11s/epoch - 27ms/step
Epoch 23/50
401/401 - 11s - loss: 3.1760 - accuracy10: 0.4184 - val_loss: 3.2830 - val_accuracy10: 0.3849 - 11s/epoch - 27ms/step
Epoch 24/50
401/401 - 11s - loss: 3.1715 - accuracy10: 0.4182 - val_loss: 3.2759 - val_accuracy10: 0.3868 - 11s/epoch - 27ms/step
testing model: results/CHTR/W7/deepVOL_L2/h10
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0868843
{'0': {'precision': 0.38621867881548977, 'recall': 0.3845194357508958, 'f1-score': 0.3853671841261904, 'support': 88188}, '1': {'precision': 0.3967090741260986, 'recall': 0.512086204216961, 'f1-score': 0.44707372229760284, 'support': 96515}, '2': {'precision': 0.3986349259197603, 'recall': 0.27288266934086974, 'f1-score': 0.3239842513293015, 'support': 87752}, 'accuracy': 0.39375309684168025, 'macro avg': {'precision': 0.39385422628711625, 'recall': 0.3898294364362422, 'f1-score': 0.3854750525843649, 'support': 272455}, 'weighted avg': {'precision': 0.39393382817702605, 'recall': 0.39375309684168025, 'f1-score': 0.38745608472563353, 'support': 272455}}
[[33910 38014 16264]
 [27231 49424 19860]
 [26659 37147 23946]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0718191
{'0': {'precision': 0.4110943100358423, 'recall': 0.4149871385363372, 'f1-score': 0.41303155199819946, 'support': 35377}, '1': {'precision': 0.38670299727520435, 'recall': 0.5233038348082596, 'f1-score': 0.4447508617988091, 'support': 33900}, '2': {'precision': 0.4233784746970777, 'recall': 0.26712636786089045, 'f1-score': 0.32757352941176476, 'support': 33355}, 'accuracy': 0.40271065554602853, 'macro avg': {'precision': 0.4070585940027081, 'recall': 0.40180578040182907, 'f1-score': 0.39511864773625777, 'support': 102632}, 'weighted avg': {'precision': 0.4070300104966136, 'recall': 0.40271065554602853, 'f1-score': 0.3957351167623095, 'support': 102632}}
[[14681 14463  6233]
 [10258 17740  5902]
 [10773 13672  8910]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0892881
{'0': {'precision': 0.36888400219901046, 'recall': 0.4010359597569479, 'f1-score': 0.3842886460172768, 'support': 10039}, '1': {'precision': 0.38091883853799796, 'recall': 0.4508986473967019, 'f1-score': 0.41296508421365236, 'support': 10794}, '2': {'precision': 0.40208062418725615, 'recall': 0.2931361395525218, 'f1-score': 0.3390722666959097, 'support': 10548}, 'accuracy': 0.3819189955705682, 'macro avg': {'precision': 0.38396115497475486, 'recall': 0.3816902489020572, 'f1-score': 0.3787753323089463, 'support': 31381}, 'weighted avg': {'precision': 0.3841818573398615, 'recall': 0.3819189955705682, 'f1-score': 0.3789539245236946, 'support': 31381}}
[[4026 3949 2064]
 [3393 4867 2534]
 [3495 3961 3092]]
training model: results/CHTR/W7/deepVOL_L2/h20
Epoch 1/50
401/401 - 14s - loss: 3.3297 - accuracy20: 0.3499 - val_loss: 3.3330 - val_accuracy20: 0.3492 - 14s/epoch - 34ms/step
Epoch 2/50
401/401 - 11s - loss: 3.2977 - accuracy20: 0.3640 - val_loss: 3.3216 - val_accuracy20: 0.3438 - 11s/epoch - 27ms/step
Epoch 3/50
401/401 - 11s - loss: 3.2880 - accuracy20: 0.3667 - val_loss: 3.3034 - val_accuracy20: 0.3497 - 11s/epoch - 27ms/step
Epoch 4/50
401/401 - 11s - loss: 3.2820 - accuracy20: 0.3719 - val_loss: 3.2924 - val_accuracy20: 0.3606 - 11s/epoch - 27ms/step
Epoch 5/50
401/401 - 11s - loss: 3.2715 - accuracy20: 0.3773 - val_loss: 3.2883 - val_accuracy20: 0.3656 - 11s/epoch - 27ms/step
Epoch 6/50
401/401 - 11s - loss: 3.2653 - accuracy20: 0.3781 - val_loss: 3.2806 - val_accuracy20: 0.3681 - 11s/epoch - 27ms/step
Epoch 7/50
401/401 - 11s - loss: 3.2585 - accuracy20: 0.3830 - val_loss: 3.2810 - val_accuracy20: 0.3694 - 11s/epoch - 27ms/step
Epoch 8/50
401/401 - 11s - loss: 3.2495 - accuracy20: 0.3871 - val_loss: 3.2820 - val_accuracy20: 0.3709 - 11s/epoch - 27ms/step
Epoch 9/50
401/401 - 11s - loss: 3.2433 - accuracy20: 0.3899 - val_loss: 3.2746 - val_accuracy20: 0.3773 - 11s/epoch - 27ms/step
Epoch 10/50
401/401 - 11s - loss: 3.2410 - accuracy20: 0.3886 - val_loss: 3.2811 - val_accuracy20: 0.3761 - 11s/epoch - 27ms/step
Epoch 11/50
401/401 - 11s - loss: 3.2348 - accuracy20: 0.3946 - val_loss: 3.2736 - val_accuracy20: 0.3780 - 11s/epoch - 27ms/step
Epoch 12/50
401/401 - 11s - loss: 3.2308 - accuracy20: 0.3941 - val_loss: 3.2867 - val_accuracy20: 0.3688 - 11s/epoch - 27ms/step
Epoch 13/50
401/401 - 11s - loss: 3.2251 - accuracy20: 0.3962 - val_loss: 3.2739 - val_accuracy20: 0.3762 - 11s/epoch - 28ms/step
Epoch 14/50
401/401 - 11s - loss: 3.2222 - accuracy20: 0.3990 - val_loss: 3.2774 - val_accuracy20: 0.3746 - 11s/epoch - 27ms/step
Epoch 15/50
401/401 - 11s - loss: 3.2178 - accuracy20: 0.3992 - val_loss: 3.2742 - val_accuracy20: 0.3785 - 11s/epoch - 27ms/step
Epoch 16/50
401/401 - 11s - loss: 3.2115 - accuracy20: 0.4011 - val_loss: 3.2743 - val_accuracy20: 0.3768 - 11s/epoch - 27ms/step
Epoch 17/50
401/401 - 11s - loss: 3.2071 - accuracy20: 0.4021 - val_loss: 3.2809 - val_accuracy20: 0.3747 - 11s/epoch - 27ms/step
Epoch 18/50
401/401 - 11s - loss: 3.2053 - accuracy20: 0.4051 - val_loss: 3.2763 - val_accuracy20: 0.3783 - 11s/epoch - 27ms/step
Epoch 19/50
401/401 - 11s - loss: 3.2013 - accuracy20: 0.4055 - val_loss: 3.2785 - val_accuracy20: 0.3784 - 11s/epoch - 28ms/step
Epoch 20/50
401/401 - 11s - loss: 3.1978 - accuracy20: 0.4072 - val_loss: 3.2787 - val_accuracy20: 0.3804 - 11s/epoch - 27ms/step
Epoch 21/50
401/401 - 11s - loss: 3.1949 - accuracy20: 0.4072 - val_loss: 3.2820 - val_accuracy20: 0.3753 - 11s/epoch - 28ms/step
testing model: results/CHTR/W7/deepVOL_L2/h20
Evaluating performance on  test set...
1065/1065 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0892997
{'0': {'precision': 0.376755096721553, 'recall': 0.38251605034862046, 'f1-score': 0.37961371797872767, 'support': 86914}, '1': {'precision': 0.4007414505715751, 'recall': 0.42736074982451794, 'f1-score': 0.41362326224979645, 'support': 96876}, '2': {'precision': 0.38491489598398043, 'recall': 0.3512096092031805, 'f1-score': 0.36729061250486533, 'support': 88665}, 'accuracy': 0.3882732928373493, 'macro avg': {'precision': 0.3874704810923695, 'recall': 0.38702880312543964, 'f1-score': 0.38684253091112986, 'support': 272455}, 'weighted avg': {'precision': 0.3879392945420293, 'recall': 0.3882732928373493, 'f1-score': 0.38769608190658383, 'support': 272455}}
[[33246 30790 22878]
 [28592 41401 26883]
 [26405 31120 31140]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0803657
{'0': {'precision': 0.40301302707317743, 'recall': 0.412034690544574, 'f1-score': 0.4074739289642593, 'support': 35514}, '1': {'precision': 0.37952855560828985, 'recall': 0.42417634231154594, 'f1-score': 0.40061230169774564, 'support': 33934}, '2': {'precision': 0.3920484558227982, 'recall': 0.3354930086788814, 'f1-score': 0.36157256296584983, 'support': 33184}, 'accuracy': 0.39130095876529736, 'macro avg': {'precision': 0.39153001283475514, 'recall': 0.39056801384500045, 'f1-score': 0.3898862645426182, 'support': 102632}, 'weighted avg': {'precision': 0.3917030030352353, 'recall': 0.39130095876529736, 'f1-score': 0.39036393024112137, 'support': 102632}}
[[14633 12149  8732]
 [11008 14394  8532]
 [10668 11383 11133]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0900443
{'0': {'precision': 0.36660929432013767, 'recall': 0.3993881377676897, 'f1-score': 0.3822973738900434, 'support': 10133}, '1': {'precision': 0.3635752042287362, 'recall': 0.3596691386195094, 'f1-score': 0.36161162357214544, 'support': 10518}, '2': {'precision': 0.3949884270906712, 'recall': 0.3657968313140727, 'f1-score': 0.37983258334542996, 'support': 10730}, 'accuracy': 0.3745897198942035, 'macro avg': {'precision': 0.37505764187984836, 'recall': 0.3749513692337573, 'f1-score': 0.3745805269358729, 'support': 31381}, 'weighted avg': {'precision': 0.3752959370353623, 'recall': 0.3745897198942035, 'f1-score': 0.37452133347108435, 'support': 31381}}
[[4047 3346 2740]
 [3463 3783 3272]
 [3529 3276 3925]]
training model: results/CHTR/W7/deepVOL_L2/h30
Epoch 1/50
401/401 - 13s - loss: 3.3289 - accuracy30: 0.3565 - val_loss: 3.3299 - val_accuracy30: 0.3446 - 13s/epoch - 33ms/step
Epoch 2/50
401/401 - 11s - loss: 3.2951 - accuracy30: 0.3641 - val_loss: 3.3148 - val_accuracy30: 0.3506 - 11s/epoch - 27ms/step
Epoch 3/50
401/401 - 11s - loss: 3.2841 - accuracy30: 0.3699 - val_loss: 3.3021 - val_accuracy30: 0.3558 - 11s/epoch - 28ms/step
Epoch 4/50
401/401 - 11s - loss: 3.2819 - accuracy30: 0.3710 - val_loss: 3.2977 - val_accuracy30: 0.3593 - 11s/epoch - 27ms/step
Epoch 5/50
401/401 - 11s - loss: 3.2758 - accuracy30: 0.3732 - val_loss: 3.2924 - val_accuracy30: 0.3592 - 11s/epoch - 28ms/step
Epoch 6/50
401/401 - 11s - loss: 3.2718 - accuracy30: 0.3764 - val_loss: 3.2870 - val_accuracy30: 0.3687 - 11s/epoch - 27ms/step
Epoch 7/50
401/401 - 11s - loss: 3.2664 - accuracy30: 0.3814 - val_loss: 3.2882 - val_accuracy30: 0.3641 - 11s/epoch - 27ms/step
Epoch 8/50
401/401 - 11s - loss: 3.2678 - accuracy30: 0.3793 - val_loss: 3.2895 - val_accuracy30: 0.3609 - 11s/epoch - 27ms/step
Epoch 9/50
401/401 - 11s - loss: 3.2611 - accuracy30: 0.3794 - val_loss: 3.2869 - val_accuracy30: 0.3672 - 11s/epoch - 27ms/step
Epoch 10/50
401/401 - 11s - loss: 3.2532 - accuracy30: 0.3834 - val_loss: 3.2840 - val_accuracy30: 0.3728 - 11s/epoch - 27ms/step
Epoch 11/50
401/401 - 11s - loss: 3.2520 - accuracy30: 0.3840 - val_loss: 3.2810 - val_accuracy30: 0.3740 - 11s/epoch - 27ms/step
Epoch 12/50
401/401 - 11s - loss: 3.2462 - accuracy30: 0.3883 - val_loss: 3.2853 - val_accuracy30: 0.3707 - 11s/epoch - 27ms/step
Epoch 13/50
401/401 - 11s - loss: 3.2418 - accuracy30: 0.3883 - val_loss: 3.2772 - val_accuracy30: 0.3775 - 11s/epoch - 27ms/step
Epoch 14/50
401/401 - 11s - loss: 3.2361 - accuracy30: 0.3924 - val_loss: 3.2845 - val_accuracy30: 0.3723 - 11s/epoch - 27ms/step
Epoch 15/50
401/401 - 11s - loss: 3.2328 - accuracy30: 0.3916 - val_loss: 3.2774 - val_accuracy30: 0.3756 - 11s/epoch - 27ms/step
Epoch 16/50
401/401 - 11s - loss: 3.2289 - accuracy30: 0.3934 - val_loss: 3.2784 - val_accuracy30: 0.3775 - 11s/epoch - 27ms/step
Epoch 17/50
401/401 - 11s - loss: 3.2278 - accuracy30: 0.3941 - val_loss: 3.2785 - val_accuracy30: 0.3768 - 11s/epoch - 28ms/step
Epoch 18/50
401/401 - 11s - loss: 3.2280 - accuracy30: 0.3938 - val_loss: 3.2736 - val_accuracy30: 0.3824 - 11s/epoch - 28ms/step
Epoch 19/50
401/401 - 11s - loss: 3.2226 - accuracy30: 0.3954 - val_loss: 3.2769 - val_accuracy30: 0.3748 - 11s/epoch - 28ms/step
Epoch 20/50
401/401 - 11s - loss: 3.2175 - accuracy30: 0.3967 - val_loss: 3.2772 - val_accuracy30: 0.3757 - 11s/epoch - 27ms/step
Epoch 21/50
401/401 - 11s - loss: 3.2148 - accuracy30: 0.3976 - val_loss: 3.2786 - val_accuracy30: 0.3776 - 11s/epoch - 27ms/step
Epoch 22/50
401/401 - 11s - loss: 3.2115 - accuracy30: 0.4004 - val_loss: 3.2804 - val_accuracy30: 0.3767 - 11s/epoch - 27ms/step
Epoch 23/50
401/401 - 11s - loss: 3.2062 - accuracy30: 0.4003 - val_loss: 3.2804 - val_accuracy30: 0.3784 - 11s/epoch - 27ms/step
Epoch 24/50
401/401 - 11s - loss: 3.2043 - accuracy30: 0.4030 - val_loss: 3.2791 - val_accuracy30: 0.3806 - 11s/epoch - 27ms/step
Epoch 25/50
401/401 - 11s - loss: 3.2007 - accuracy30: 0.4040 - val_loss: 3.2801 - val_accuracy30: 0.3758 - 11s/epoch - 28ms/step
Epoch 26/50
401/401 - 11s - loss: 3.1969 - accuracy30: 0.4058 - val_loss: 3.2814 - val_accuracy30: 0.3745 - 11s/epoch - 28ms/step
Epoch 27/50
401/401 - 11s - loss: 3.1960 - accuracy30: 0.4044 - val_loss: 3.2852 - val_accuracy30: 0.3727 - 11s/epoch - 28ms/step
Epoch 28/50
401/401 - 12s - loss: 3.1942 - accuracy30: 0.4063 - val_loss: 3.2874 - val_accuracy30: 0.3747 - 12s/epoch - 29ms/step
testing model: results/CHTR/W7/deepVOL_L2/h30
Evaluating performance on  test set...
1065/1065 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0885068
{'0': {'precision': 0.39986523461428514, 'recall': 0.22697822131043036, 'f1-score': 0.28958011401024764, 'support': 86277}, '1': {'precision': 0.3935127490653486, 'recall': 0.5835141448222164, 'f1-score': 0.47003876082438883, 'support': 96325}, '2': {'precision': 0.3933810309124952, 'recall': 0.35307669193015256, 'f1-score': 0.37214076246334316, 'support': 89853}, 'accuracy': 0.39461562459855754, 'macro avg': {'precision': 0.3955863381973763, 'recall': 0.38785635268759977, 'f1-score': 0.3772532124326598, 'support': 272455}, 'weighted avg': {'precision': 0.3954809204129739, 'recall': 0.39461562459855754, 'f1-score': 0.3806079942100169, 'support': 272455}}
[[19583 42983 23711]
 [14907 56207 25211]
 [14484 43644 31725]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.08075
{'0': {'precision': 0.4276981759499242, 'recall': 0.2468877911079746, 'f1-score': 0.31306153130257364, 'support': 35425}, '1': {'precision': 0.3709167143129407, 'recall': 0.570532363977486, 'f1-score': 0.44956226467395066, 'support': 34112}, '2': {'precision': 0.39450745464948, 'recall': 0.35419247620486477, 'f1-score': 0.37326455228633293, 'support': 33095}, 'accuracy': 0.38905994231818536, 'macro avg': {'precision': 0.397707448304115, 'recall': 0.39053754376344174, 'f1-score': 0.3786294494209524, 'support': 102632}, 'weighted avg': {'precision': 0.3981228374512203, 'recall': 0.38905994231818536, 'f1-score': 0.3778437824155007, 'support': 102632}}
[[ 8746 17283  9396]
 [ 6055 19462  8595]
 [ 5648 15725 11722]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0915538
{'0': {'precision': 0.38790089679282563, 'recall': 0.25207427894113, 'f1-score': 0.30557384900916007, 'support': 10124}, '1': {'precision': 0.3579517821163065, 'recall': 0.4916030534351145, 'f1-score': 0.4142644634744502, 'support': 10480}, '2': {'precision': 0.3906234988951869, 'recall': 0.3772849587083604, 'f1-score': 0.3838383838383838, 'support': 10777}, 'accuracy': 0.3750677161339664, 'macro avg': {'precision': 0.3788253926014397, 'recall': 0.3736540970282016, 'f1-score': 0.3678922321073314, 'support': 31381}, 'weighted avg': {'precision': 0.3788340971703543, 'recall': 0.3750677161339664, 'f1-score': 0.3687501190914005, 'support': 31381}}
[[2552 4560 3012]
 [1997 5152 3331]
 [2030 4681 4066]]
training model: results/CHTR/W7/deepVOL_L2/h50
Epoch 1/50
401/401 - 13s - loss: 3.3366 - accuracy50: 0.3490 - val_loss: 3.3403 - val_accuracy50: 0.3396 - 13s/epoch - 33ms/step
Epoch 2/50
401/401 - 11s - loss: 3.3029 - accuracy50: 0.3633 - val_loss: 3.3339 - val_accuracy50: 0.3367 - 11s/epoch - 28ms/step
Epoch 3/50
401/401 - 11s - loss: 3.2893 - accuracy50: 0.3655 - val_loss: 3.3145 - val_accuracy50: 0.3397 - 11s/epoch - 27ms/step
Epoch 4/50
401/401 - 11s - loss: 3.2861 - accuracy50: 0.3663 - val_loss: 3.3087 - val_accuracy50: 0.3449 - 11s/epoch - 27ms/step
Epoch 5/50
401/401 - 11s - loss: 3.2802 - accuracy50: 0.3686 - val_loss: 3.3098 - val_accuracy50: 0.3437 - 11s/epoch - 27ms/step
Epoch 6/50
401/401 - 11s - loss: 3.2778 - accuracy50: 0.3689 - val_loss: 3.3027 - val_accuracy50: 0.3521 - 11s/epoch - 27ms/step
Epoch 7/50
401/401 - 11s - loss: 3.2733 - accuracy50: 0.3701 - val_loss: 3.3009 - val_accuracy50: 0.3563 - 11s/epoch - 27ms/step
Epoch 8/50
401/401 - 11s - loss: 3.2703 - accuracy50: 0.3708 - val_loss: 3.2975 - val_accuracy50: 0.3587 - 11s/epoch - 27ms/step
Epoch 9/50
401/401 - 11s - loss: 3.2590 - accuracy50: 0.3746 - val_loss: 3.2967 - val_accuracy50: 0.3600 - 11s/epoch - 27ms/step
Epoch 10/50
401/401 - 11s - loss: 3.2556 - accuracy50: 0.3735 - val_loss: 3.2946 - val_accuracy50: 0.3613 - 11s/epoch - 28ms/step
Epoch 11/50
401/401 - 11s - loss: 3.2482 - accuracy50: 0.3755 - val_loss: 3.2954 - val_accuracy50: 0.3577 - 11s/epoch - 27ms/step
Epoch 12/50
401/401 - 11s - loss: 3.2468 - accuracy50: 0.3749 - val_loss: 3.2934 - val_accuracy50: 0.3656 - 11s/epoch - 27ms/step
Epoch 13/50
401/401 - 11s - loss: 3.2449 - accuracy50: 0.3757 - val_loss: 3.2944 - val_accuracy50: 0.3626 - 11s/epoch - 27ms/step
Epoch 14/50
401/401 - 11s - loss: 3.2410 - accuracy50: 0.3794 - val_loss: 3.2926 - val_accuracy50: 0.3624 - 11s/epoch - 27ms/step
Epoch 15/50
401/401 - 11s - loss: 3.2395 - accuracy50: 0.3805 - val_loss: 3.2930 - val_accuracy50: 0.3644 - 11s/epoch - 27ms/step
Epoch 16/50
401/401 - 11s - loss: 3.2412 - accuracy50: 0.3799 - val_loss: 3.2927 - val_accuracy50: 0.3619 - 11s/epoch - 27ms/step
Epoch 17/50
401/401 - 11s - loss: 3.2383 - accuracy50: 0.3812 - val_loss: 3.2926 - val_accuracy50: 0.3625 - 11s/epoch - 27ms/step
Epoch 18/50
401/401 - 11s - loss: 3.2310 - accuracy50: 0.3849 - val_loss: 3.2954 - val_accuracy50: 0.3616 - 11s/epoch - 27ms/step
Epoch 19/50
401/401 - 11s - loss: 3.2285 - accuracy50: 0.3882 - val_loss: 3.2939 - val_accuracy50: 0.3600 - 11s/epoch - 27ms/step
Epoch 20/50
401/401 - 11s - loss: 3.2234 - accuracy50: 0.3884 - val_loss: 3.2977 - val_accuracy50: 0.3612 - 11s/epoch - 27ms/step
Epoch 21/50
401/401 - 11s - loss: 3.2224 - accuracy50: 0.3876 - val_loss: 3.2979 - val_accuracy50: 0.3612 - 11s/epoch - 27ms/step
Epoch 22/50
401/401 - 11s - loss: 3.2207 - accuracy50: 0.3897 - val_loss: 3.2984 - val_accuracy50: 0.3626 - 11s/epoch - 27ms/step
Epoch 23/50
401/401 - 11s - loss: 3.2183 - accuracy50: 0.3901 - val_loss: 3.2984 - val_accuracy50: 0.3616 - 11s/epoch - 27ms/step
Epoch 24/50
401/401 - 11s - loss: 3.2148 - accuracy50: 0.3910 - val_loss: 3.2973 - val_accuracy50: 0.3621 - 11s/epoch - 28ms/step
testing model: results/CHTR/W7/deepVOL_L2/h50
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0936033
{'0': {'precision': 0.36043898419357256, 'recall': 0.22529968158831243, 'f1-score': 0.27727993084569946, 'support': 85424}, '1': {'precision': 0.382527528622475, 'recall': 0.5506324463339106, 'f1-score': 0.45143828395619523, 'support': 95265}, '2': {'precision': 0.38438159870131455, 'recall': 0.3431772116034261, 'f1-score': 0.36261262557932006, 'support': 91766}, 'accuracy': 0.37875612486465654, 'macro avg': {'precision': 0.37578270383912077, 'recall': 0.3730364465085498, 'f1-score': 0.36377694679373823, 'support': 272455}, 'weighted avg': {'precision': 0.37622648358957134, 'recall': 0.37875612486465654, 'f1-score': 0.36691614810725387, 'support': 272455}}
[[19246 41308 24870]
 [17242 52456 25567]
 [16908 43366 31492]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0863495
{'0': {'precision': 0.3978049002641406, 'recall': 0.245751744316903, 'f1-score': 0.3038155194601927, 'support': 35544}, '1': {'precision': 0.35946175200493524, 'recall': 0.548363379701791, 'f1-score': 0.4342590975254731, 'support': 34003}, '2': {'precision': 0.37334212901881814, 'recall': 0.32501133444158986, 'f1-score': 0.3475043223940407, 'support': 33085}, 'accuracy': 0.3715605269311716, 'macro avg': {'precision': 0.37686959376263135, 'recall': 0.3730421528200947, 'f1-score': 0.36185964645990215, 'support': 102632}, 'weighted avg': {'precision': 0.37721548510211267, 'recall': 0.3715605269311716, 'f1-score': 0.36111652723574117, 'support': 102632}}
[[ 8735 17397  9412]
 [ 6720 18646  8637]
 [ 6503 15829 10753]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0958109
{'0': {'precision': 0.35327798454050957, 'recall': 0.2479156202913109, 'f1-score': 0.29136414615430023, 'support': 9955}, '1': {'precision': 0.35077464788732393, 'recall': 0.46761171610965074, 'f1-score': 0.40085305005633354, 'support': 10652}, '2': {'precision': 0.3758705247670427, 'recall': 0.35567105995916093, 'f1-score': 0.3654919166388478, 'support': 10774}, 'accuracy': 0.35948503871769544, 'macro avg': {'precision': 0.3599743857316254, 'recall': 0.35706613212004085, 'f1-score': 0.35256970428316053, 'support': 31381}, 'weighted avg': {'precision': 0.3601849182383182, 'recall': 0.35948503871769544, 'f1-score': 0.35397937204146046, 'support': 31381}}
[[2468 4478 3009]
 [2317 4981 3354]
 [2201 4741 3832]]
training model: results/CHTR/W7/deepVOL_L2/h100
Epoch 1/50
401/401 - 14s - loss: 3.3408 - accuracy100: 0.3495 - val_loss: 3.3497 - val_accuracy100: 0.3326 - 14s/epoch - 34ms/step
Epoch 2/50
401/401 - 11s - loss: 3.3068 - accuracy100: 0.3570 - val_loss: 3.3246 - val_accuracy100: 0.3287 - 11s/epoch - 28ms/step
Epoch 3/50
401/401 - 11s - loss: 3.2959 - accuracy100: 0.3607 - val_loss: 3.3224 - val_accuracy100: 0.3274 - 11s/epoch - 28ms/step
Epoch 4/50
401/401 - 11s - loss: 3.2933 - accuracy100: 0.3641 - val_loss: 3.3295 - val_accuracy100: 0.3269 - 11s/epoch - 27ms/step
Epoch 5/50
401/401 - 11s - loss: 3.2905 - accuracy100: 0.3621 - val_loss: 3.3099 - val_accuracy100: 0.3330 - 11s/epoch - 28ms/step
Epoch 6/50
401/401 - 11s - loss: 3.2860 - accuracy100: 0.3619 - val_loss: 3.3037 - val_accuracy100: 0.3423 - 11s/epoch - 28ms/step
Epoch 7/50
401/401 - 11s - loss: 3.2860 - accuracy100: 0.3602 - val_loss: 3.2973 - val_accuracy100: 0.3472 - 11s/epoch - 27ms/step
Epoch 8/50
401/401 - 11s - loss: 3.2840 - accuracy100: 0.3624 - val_loss: 3.3003 - val_accuracy100: 0.3442 - 11s/epoch - 27ms/step
Epoch 9/50
401/401 - 11s - loss: 3.2843 - accuracy100: 0.3595 - val_loss: 3.3037 - val_accuracy100: 0.3471 - 11s/epoch - 27ms/step
Epoch 10/50
401/401 - 11s - loss: 3.2788 - accuracy100: 0.3622 - val_loss: 3.3021 - val_accuracy100: 0.3443 - 11s/epoch - 28ms/step
Epoch 11/50
401/401 - 11s - loss: 3.2736 - accuracy100: 0.3613 - val_loss: 3.3034 - val_accuracy100: 0.3462 - 11s/epoch - 27ms/step
Epoch 12/50
401/401 - 11s - loss: 3.2691 - accuracy100: 0.3630 - val_loss: 3.3029 - val_accuracy100: 0.3473 - 11s/epoch - 27ms/step
Epoch 13/50
401/401 - 11s - loss: 3.2634 - accuracy100: 0.3662 - val_loss: 3.3070 - val_accuracy100: 0.3435 - 11s/epoch - 28ms/step
Epoch 14/50
401/401 - 11s - loss: 3.2623 - accuracy100: 0.3672 - val_loss: 3.3058 - val_accuracy100: 0.3422 - 11s/epoch - 27ms/step
Epoch 15/50
401/401 - 11s - loss: 3.2583 - accuracy100: 0.3694 - val_loss: 3.3057 - val_accuracy100: 0.3428 - 11s/epoch - 27ms/step
Epoch 16/50
401/401 - 11s - loss: 3.2540 - accuracy100: 0.3671 - val_loss: 3.3064 - val_accuracy100: 0.3451 - 11s/epoch - 27ms/step
Epoch 17/50
401/401 - 11s - loss: 3.2505 - accuracy100: 0.3719 - val_loss: 3.3066 - val_accuracy100: 0.3416 - 11s/epoch - 27ms/step
testing model: results/CHTR/W7/deepVOL_L2/h100
Evaluating performance on  test set...
1065/1065 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0976399
{'0': {'precision': 0.3331758034026465, 'recall': 0.04987090156686592, 'f1-score': 0.08675588371019843, 'support': 84819}, '1': {'precision': 0.35431014765305346, 'recall': 0.5937712947189097, 'f1-score': 0.44379983765458625, 'support': 93920}, '2': {'precision': 0.357003995584342, 'recall': 0.3899440863886636, 'f1-score': 0.3727477190316148, 'support': 93716}, 'accuracy': 0.35433741351782866, 'macro avg': {'precision': 0.3481633155466806, 'recall': 0.3445287608914797, 'f1-score': 0.30110114679879985, 'support': 272455}, 'weighted avg': {'precision': 0.3486573341893746, 'recall': 0.35433741351782866, 'f1-score': 0.3082074224723381, 'support': 272455}}
[[ 4230 48920 31669]
 [ 4003 55767 34150]
 [ 4463 52709 36544]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0988665
{'0': {'precision': 0.3780743565300286, 'recall': 0.05563504755491962, 'f1-score': 0.09699667384073565, 'support': 35643}, '1': {'precision': 0.33924544812035135, 'recall': 0.5968735196589294, 'f1-score': 0.43260874230166735, 'support': 33776}, '2': {'precision': 0.34469587207923924, 'recall': 0.3939722397856261, 'f1-score': 0.36769044875937845, 'support': 33213}, 'accuracy': 0.3432457712993998, 'macro avg': {'precision': 0.35400522557653974, 'recall': 0.3488269356664917, 'f1-score': 0.29909862163392714, 'support': 102632}, 'weighted avg': {'precision': 0.3544941396921094, 'recall': 0.3432457712993998, 'f1-score': 0.29504587458425924, 'support': 102632}}
[[ 1983 20780 12880]
 [ 1620 20160 11996]
 [ 1642 18486 13085]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0981889
{'0': {'precision': 0.3248369887374037, 'recall': 0.056205128205128206, 'f1-score': 0.09582932587216929, 'support': 9750}, '1': {'precision': 0.34128251939753534, 'recall': 0.5633829346392918, 'f1-score': 0.4250692816030697, 'support': 10618}, '2': {'precision': 0.3582936051290482, 'recall': 0.39580495777717245, 'f1-score': 0.37611631217912767, 'support': 11013}, 'accuracy': 0.3469934036518913, 'macro avg': {'precision': 0.34147103775466237, 'recall': 0.33846434020719746, 'f1-score': 0.2990049732181222, 'support': 31381}, 'weighted avg': {'precision': 0.34214288596408415, 'recall': 0.3469934036518913, 'f1-score': 0.3055954400861597, 'support': 31381}}
[[ 548 5484 3718]
 [ 547 5982 4089]
 [ 592 6062 4359]]
training model: results/CHTR/W7/deepVOL_L2/h200
Epoch 1/50
401/401 - 14s - loss: 3.3364 - accuracy200: 0.3511 - val_loss: 3.3609 - val_accuracy200: 0.3127 - 14s/epoch - 35ms/step
Epoch 2/50
401/401 - 11s - loss: 3.3051 - accuracy200: 0.3543 - val_loss: 3.3376 - val_accuracy200: 0.3226 - 11s/epoch - 27ms/step
Epoch 3/50
401/401 - 11s - loss: 3.2999 - accuracy200: 0.3521 - val_loss: 3.3012 - val_accuracy200: 0.3442 - 11s/epoch - 28ms/step
Epoch 4/50
401/401 - 11s - loss: 3.2956 - accuracy200: 0.3552 - val_loss: 3.2978 - val_accuracy200: 0.3523 - 11s/epoch - 28ms/step
Epoch 5/50
401/401 - 11s - loss: 3.2925 - accuracy200: 0.3549 - val_loss: 3.2990 - val_accuracy200: 0.3498 - 11s/epoch - 28ms/step
Epoch 6/50
401/401 - 11s - loss: 3.2909 - accuracy200: 0.3545 - val_loss: 3.2965 - val_accuracy200: 0.3537 - 11s/epoch - 28ms/step
Epoch 7/50
401/401 - 11s - loss: 3.2886 - accuracy200: 0.3560 - val_loss: 3.2967 - val_accuracy200: 0.3543 - 11s/epoch - 28ms/step
Epoch 8/50
401/401 - 11s - loss: 3.2854 - accuracy200: 0.3579 - val_loss: 3.2963 - val_accuracy200: 0.3564 - 11s/epoch - 29ms/step
Epoch 9/50
401/401 - 11s - loss: 3.2798 - accuracy200: 0.3610 - val_loss: 3.2973 - val_accuracy200: 0.3524 - 11s/epoch - 28ms/step
Epoch 10/50
401/401 - 11s - loss: 3.2794 - accuracy200: 0.3599 - val_loss: 3.2967 - val_accuracy200: 0.3552 - 11s/epoch - 29ms/step
Epoch 11/50
401/401 - 11s - loss: 3.2763 - accuracy200: 0.3636 - val_loss: 3.2966 - val_accuracy200: 0.3582 - 11s/epoch - 28ms/step
Epoch 12/50
401/401 - 11s - loss: 3.2738 - accuracy200: 0.3633 - val_loss: 3.2972 - val_accuracy200: 0.3575 - 11s/epoch - 27ms/step
Epoch 13/50
401/401 - 11s - loss: 3.2704 - accuracy200: 0.3619 - val_loss: 3.2972 - val_accuracy200: 0.3547 - 11s/epoch - 27ms/step
Epoch 14/50
401/401 - 11s - loss: 3.2673 - accuracy200: 0.3660 - val_loss: 3.2991 - val_accuracy200: 0.3549 - 11s/epoch - 27ms/step
Epoch 15/50
401/401 - 11s - loss: 3.2630 - accuracy200: 0.3672 - val_loss: 3.3011 - val_accuracy200: 0.3494 - 11s/epoch - 27ms/step
Epoch 16/50
401/401 - 11s - loss: 3.2594 - accuracy200: 0.3683 - val_loss: 3.3018 - val_accuracy200: 0.3487 - 11s/epoch - 27ms/step
Epoch 17/50
401/401 - 11s - loss: 3.2565 - accuracy200: 0.3688 - val_loss: 3.3059 - val_accuracy200: 0.3462 - 11s/epoch - 27ms/step
Epoch 18/50
401/401 - 11s - loss: 3.2526 - accuracy200: 0.3716 - val_loss: 3.3064 - val_accuracy200: 0.3491 - 11s/epoch - 27ms/step
testing model: results/CHTR/W7/deepVOL_L2/h200
Evaluating performance on  test set...
1065/1065 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0969998
{'0': {'precision': 0.2949703492202943, 'recall': 0.01633939216974475, 'f1-score': 0.030963606810610167, 'support': 82194}, '1': {'precision': 0.35194358073976717, 'recall': 0.3802766149117694, 'f1-score': 0.3655619288254052, 'support': 94355}, '2': {'precision': 0.35577369223445476, 'recall': 0.6156132045961671, 'f1-score': 0.45094078065509036, 'support': 95906}, 'accuracy': 0.3533244021948579, 'macro avg': {'precision': 0.3342292073981721, 'recall': 0.33740973722589374, 'f1-score': 0.28248877209703527, 'support': 272455}, 'weighted avg': {'precision': 0.3361041682918325, 'recall': 0.3533244021948579, 'f1-score': 0.2946745150649447, 'support': 272455}}
[[ 1343 30891 49960]
 [ 1524 35881 56950]
 [ 1686 35179 59041]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0984215
{'0': {'precision': 0.36327000575705237, 'recall': 0.017817812164680636, 'f1-score': 0.0339694759225862, 'support': 35414}, '1': {'precision': 0.3509584623653162, 'recall': 0.40508684863523575, 'f1-score': 0.376085018854988, 'support': 33852}, '2': {'precision': 0.3345572773446346, 'recall': 0.6198825151351676, 'f1-score': 0.4345715846535278, 'support': 33366}, 'accuracy': 0.3412873177956193, 'macro avg': {'precision': 0.34959524848900103, 'recall': 0.34759572531169464, 'f1-score': 0.281542026477034, 'support': 102632}, 'weighted avg': {'precision': 0.3498745807131501, 'recall': 0.3412873177956193, 'f1-score': 0.2770494638334158, 'support': 102632}}
[[  631 13245 21538]
 [  538 13713 19601]
 [  568 12115 20683]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0972574
{'0': {'precision': 0.33955223880597013, 'recall': 0.019302152932442463, 'f1-score': 0.036527847466131455, 'support': 9429}, '1': {'precision': 0.3550986151909358, 'recall': 0.3936912626779566, 'f1-score': 0.37340040596593416, 'support': 10747}, '2': {'precision': 0.36318013734812465, 'recall': 0.6135653726015172, 'f1-score': 0.4562800730048117, 'support': 11205}, 'accuracy': 0.3597081036295848, 'macro avg': {'precision': 0.3526103304483435, 'recall': 0.3421862627373054, 'f1-score': 0.28873610881229245, 'support': 31381}, 'weighted avg': {'precision': 0.35331303387859586, 'recall': 0.3597081036295848, 'f1-score': 0.30177411346652316, 'support': 31381}}
[[ 182 3533 5714]
 [ 175 4231 6341]
 [ 179 4151 6875]]
training model: results/CHTR/W7/deepVOL_L2/h300
Epoch 1/50
401/401 - 13s - loss: 3.3348 - accuracy300: 0.3538 - val_loss: 3.3659 - val_accuracy300: 0.3317 - 13s/epoch - 34ms/step
Epoch 2/50
401/401 - 12s - loss: 3.3059 - accuracy300: 0.3633 - val_loss: 3.3576 - val_accuracy300: 0.3269 - 12s/epoch - 29ms/step
Epoch 3/50
401/401 - 11s - loss: 3.3033 - accuracy300: 0.3611 - val_loss: 3.3903 - val_accuracy300: 0.3304 - 11s/epoch - 27ms/step
Epoch 4/50
401/401 - 11s - loss: 3.2952 - accuracy300: 0.3604 - val_loss: 3.3004 - val_accuracy300: 0.3468 - 11s/epoch - 28ms/step
Epoch 5/50
401/401 - 11s - loss: 3.2918 - accuracy300: 0.3574 - val_loss: 3.2977 - val_accuracy300: 0.3506 - 11s/epoch - 27ms/step
Epoch 6/50
401/401 - 11s - loss: 3.2889 - accuracy300: 0.3608 - val_loss: 3.2951 - val_accuracy300: 0.3516 - 11s/epoch - 27ms/step
Epoch 7/50
401/401 - 11s - loss: 3.2833 - accuracy300: 0.3648 - val_loss: 3.2943 - val_accuracy300: 0.3584 - 11s/epoch - 27ms/step
Epoch 8/50
401/401 - 11s - loss: 3.2797 - accuracy300: 0.3638 - val_loss: 3.2936 - val_accuracy300: 0.3542 - 11s/epoch - 28ms/step
Epoch 9/50
401/401 - 11s - loss: 3.2767 - accuracy300: 0.3665 - val_loss: 3.2984 - val_accuracy300: 0.3432 - 11s/epoch - 27ms/step
Epoch 10/50
401/401 - 11s - loss: 3.2726 - accuracy300: 0.3675 - val_loss: 3.2976 - val_accuracy300: 0.3482 - 11s/epoch - 27ms/step
Epoch 11/50
401/401 - 11s - loss: 3.2687 - accuracy300: 0.3721 - val_loss: 3.3041 - val_accuracy300: 0.3414 - 11s/epoch - 27ms/step
Epoch 12/50
401/401 - 11s - loss: 3.2673 - accuracy300: 0.3690 - val_loss: 3.2996 - val_accuracy300: 0.3480 - 11s/epoch - 27ms/step
Epoch 13/50
401/401 - 11s - loss: 3.2633 - accuracy300: 0.3728 - val_loss: 3.2986 - val_accuracy300: 0.3529 - 11s/epoch - 27ms/step
Epoch 14/50
401/401 - 11s - loss: 3.2599 - accuracy300: 0.3741 - val_loss: 3.2992 - val_accuracy300: 0.3487 - 11s/epoch - 27ms/step
Epoch 15/50
401/401 - 11s - loss: 3.2562 - accuracy300: 0.3743 - val_loss: 3.3036 - val_accuracy300: 0.3474 - 11s/epoch - 27ms/step
Epoch 16/50
401/401 - 11s - loss: 3.2534 - accuracy300: 0.3777 - val_loss: 3.3028 - val_accuracy300: 0.3493 - 11s/epoch - 27ms/step
Epoch 17/50
401/401 - 11s - loss: 3.2502 - accuracy300: 0.3794 - val_loss: 3.3076 - val_accuracy300: 0.3467 - 11s/epoch - 27ms/step
Epoch 18/50
401/401 - 11s - loss: 3.2471 - accuracy300: 0.3792 - val_loss: 3.3246 - val_accuracy300: 0.3370 - 11s/epoch - 28ms/step
testing model: results/CHTR/W7/deepVOL_L2/h300
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977902
{'0': {'precision': 0.311088426693888, 'recall': 0.02987891563311927, 'f1-score': 0.0545212617266557, 'support': 81596}, '1': {'precision': 0.3465301211122446, 'recall': 0.56972981109355, 'f1-score': 0.4309443936159398, 'support': 93009}, '2': {'precision': 0.3629120338042291, 'recall': 0.41428717424629535, 'f1-score': 0.38690158051462165, 'support': 97850}, 'accuracy': 0.35222697326163954, 'macro avg': {'precision': 0.3401768605367872, 'recall': 0.33796530032432154, 'f1-score': 0.2907890786190724, 'support': 272455}, 'weighted avg': {'precision': 0.3417993202796318, 'recall': 0.35222697326163954, 'f1-score': 0.30239394994046304, 'support': 272455}}
[[ 2438 45439 33719]
 [ 2574 52990 37445]
 [ 2825 54487 40538]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0976167
{'0': {'precision': 0.3930274135876043, 'recall': 0.0373294843493519, 'f1-score': 0.06818299302145257, 'support': 35334}, '1': {'precision': 0.34912652196929594, 'recall': 0.585406988785987, 'f1-score': 0.4373970619120785, 'support': 33797}, '2': {'precision': 0.3431676289724452, 'recall': 0.43643473329154353, 'f1-score': 0.38422221346262503, 'support': 33501}, 'accuracy': 0.34808831553511577, 'macro avg': {'precision': 0.36177385484311514, 'recall': 0.35305706880896076, 'f1-score': 0.29660075613205206, 'support': 102632}, 'weighted avg': {'precision': 0.36229556505677163, 'recall': 0.34808831553511577, 'f1-score': 0.29292730093999847, 'support': 102632}}
[[ 1319 19045 14970]
 [  997 19785 13015]
 [ 1040 17840 14621]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971348
{'0': {'precision': 0.3230174081237911, 'recall': 0.03531775404462303, 'f1-score': 0.06367362501191498, 'support': 9457}, '1': {'precision': 0.34295126661365444, 'recall': 0.5761450381679389, 'f1-score': 0.4299651071708324, 'support': 10480}, '2': {'precision': 0.3720273133976925, 'recall': 0.41419084236281023, 'f1-score': 0.39197849906967125, 'support': 11444}, 'accuracy': 0.3540996144163666, 'macro avg': {'precision': 0.3459986627117127, 'recall': 0.3418845448584574, 'f1-score': 0.2952057437508062, 'support': 31381}, 'weighted avg': {'precision': 0.3475474165023736, 'recall': 0.3540996144163666, 'f1-score': 0.3057263228782168, 'support': 31381}}
[[ 334 5228 3895]
 [ 336 6038 4106]
 [ 364 6340 4740]]
training model: results/CHTR/W7/deepVOL_L2/h500
Epoch 1/50
401/401 - 13s - loss: 3.3362 - accuracy500: 0.3552 - val_loss: 3.4010 - val_accuracy500: 0.3185 - 13s/epoch - 33ms/step
Epoch 2/50
401/401 - 11s - loss: 3.3107 - accuracy500: 0.3599 - val_loss: 3.3297 - val_accuracy500: 0.3161 - 11s/epoch - 27ms/step
Epoch 3/50
401/401 - 11s - loss: 3.2996 - accuracy500: 0.3628 - val_loss: 3.3005 - val_accuracy500: 0.3462 - 11s/epoch - 27ms/step
Epoch 4/50
401/401 - 11s - loss: 3.2942 - accuracy500: 0.3641 - val_loss: 3.2925 - val_accuracy500: 0.3624 - 11s/epoch - 27ms/step
Epoch 5/50
401/401 - 11s - loss: 3.2913 - accuracy500: 0.3599 - val_loss: 3.2944 - val_accuracy500: 0.3573 - 11s/epoch - 27ms/step
Epoch 6/50
401/401 - 11s - loss: 3.2978 - accuracy500: 0.3516 - val_loss: 3.2853 - val_accuracy500: 0.3738 - 11s/epoch - 27ms/step
Epoch 7/50
401/401 - 11s - loss: 3.2925 - accuracy500: 0.3575 - val_loss: 3.2858 - val_accuracy500: 0.3729 - 11s/epoch - 27ms/step
Epoch 8/50
401/401 - 11s - loss: 3.2904 - accuracy500: 0.3589 - val_loss: 3.2857 - val_accuracy500: 0.3708 - 11s/epoch - 28ms/step
Epoch 9/50
401/401 - 11s - loss: 3.2877 - accuracy500: 0.3609 - val_loss: 3.2867 - val_accuracy500: 0.3740 - 11s/epoch - 27ms/step
Epoch 10/50
401/401 - 11s - loss: 3.2854 - accuracy500: 0.3621 - val_loss: 3.2872 - val_accuracy500: 0.3722 - 11s/epoch - 27ms/step
Epoch 11/50
401/401 - 11s - loss: 3.2827 - accuracy500: 0.3643 - val_loss: 3.2911 - val_accuracy500: 0.3693 - 11s/epoch - 27ms/step
Epoch 12/50
401/401 - 11s - loss: 3.2797 - accuracy500: 0.3662 - val_loss: 3.2882 - val_accuracy500: 0.3700 - 11s/epoch - 27ms/step
Epoch 13/50
401/401 - 11s - loss: 3.2780 - accuracy500: 0.3652 - val_loss: 3.2903 - val_accuracy500: 0.3731 - 11s/epoch - 27ms/step
Epoch 14/50
401/401 - 11s - loss: 3.2755 - accuracy500: 0.3662 - val_loss: 3.2913 - val_accuracy500: 0.3701 - 11s/epoch - 27ms/step
Epoch 15/50
401/401 - 11s - loss: 3.2720 - accuracy500: 0.3660 - val_loss: 3.2951 - val_accuracy500: 0.3696 - 11s/epoch - 27ms/step
Epoch 16/50
401/401 - 11s - loss: 3.2689 - accuracy500: 0.3680 - val_loss: 3.2922 - val_accuracy500: 0.3692 - 11s/epoch - 27ms/step
testing model: results/CHTR/W7/deepVOL_L2/h500
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0957669
{'0': {'precision': 0.3333333333333333, 'recall': 0.003186583857141072, 'f1-score': 0.006312818735455762, 'support': 80023}, '1': {'precision': 0.3482860203535083, 'recall': 0.1939721298900537, 'f1-score': 0.24917202682359385, 'support': 93864}, '2': {'precision': 0.3628574293345001, 'recall': 0.8077266455644834, 'f1-score': 0.5007579045354769, 'support': 98568}, 'accuracy': 0.3599787120808941, 'macro avg': {'precision': 0.3481589276737806, 'recall': 0.3349617864372261, 'f1-score': 0.2520809166981755, 'support': 272455}, 'weighted avg': {'precision': 0.3491658565357143, 'recall': 0.3599787120808941, 'f1-score': 0.26885966105848697, 'support': 272455}}
[[  255 15358 64410]
 [  269 18207 75388]
 [  241 18711 79616]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1026199
{'0': {'precision': 0.33589743589743587, 'recall': 0.0037493917971321445, 'f1-score': 0.0074160038495287165, 'support': 34939}, '1': {'precision': 0.3726205509564567, 'recall': 0.23451666077946545, 'f1-score': 0.2878615431864578, 'support': 33972}, '2': {'precision': 0.33683728868057533, 'recall': 0.8077162598973933, 'f1-score': 0.4754149866471174, 'support': 33721}, 'accuracy': 0.3442883311247954, 'macro avg': {'precision': 0.3484517585114893, 'recall': 0.3486607708246636, 'f1-score': 0.25689751122770127, 'support': 102632}, 'weighted avg': {'precision': 0.3483618762326656, 'recall': 0.3442883311247954, 'f1-score': 0.25401248020458017, 'support': 102632}}
[[  131  7058 27750]
 [  131  7967 25874]
 [  128  6356 27237]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0947648
{'0': {'precision': 0.30275229357798167, 'recall': 0.00347661188369153, 'f1-score': 0.006874283928757421, 'support': 9492}, '1': {'precision': 0.32856698787690397, 'recall': 0.21250502613590672, 'f1-score': 0.25808814552557685, 'support': 9948}, '2': {'precision': 0.3845720267332313, 'recall': 0.7999330039360187, 'f1-score': 0.5194268468419478, 'support': 11941}, 'accuracy': 0.3728052005990886, 'macro avg': {'precision': 0.33863043606270565, 'recall': 0.3386382139852057, 'f1-score': 0.2614630920987607, 'support': 31381}, 'weighted avg': {'precision': 0.34206952414719605, 'recall': 0.3728052005990886, 'f1-score': 0.28154576185844626, 'support': 31381}}
[[  33 1979 7480]
 [  28 2114 7806]
 [  48 2341 9552]]
training model: results/CHTR/W7/deepVOL_L2/h1000
Epoch 1/50
401/401 - 14s - loss: 3.3353 - accuracy1000: 0.3625 - val_loss: 3.4066 - val_accuracy1000: 0.3187 - 14s/epoch - 34ms/step
Epoch 2/50
401/401 - 11s - loss: 3.3138 - accuracy1000: 0.3655 - val_loss: 3.3143 - val_accuracy1000: 0.3394 - 11s/epoch - 27ms/step
Epoch 3/50
401/401 - 11s - loss: 3.3045 - accuracy1000: 0.3501 - val_loss: 3.3047 - val_accuracy1000: 0.3624 - 11s/epoch - 27ms/step
Epoch 4/50
401/401 - 11s - loss: 3.3004 - accuracy1000: 0.3514 - val_loss: 3.2939 - val_accuracy1000: 0.3829 - 11s/epoch - 27ms/step
Epoch 5/50
401/401 - 11s - loss: 3.2991 - accuracy1000: 0.3495 - val_loss: 3.2891 - val_accuracy1000: 0.3847 - 11s/epoch - 27ms/step
Epoch 6/50
401/401 - 11s - loss: 3.2932 - accuracy1000: 0.3511 - val_loss: 3.2892 - val_accuracy1000: 0.3877 - 11s/epoch - 27ms/step
Epoch 7/50
401/401 - 11s - loss: 3.2893 - accuracy1000: 0.3505 - val_loss: 3.2864 - val_accuracy1000: 0.3872 - 11s/epoch - 27ms/step
Epoch 8/50
401/401 - 11s - loss: 3.2871 - accuracy1000: 0.3532 - val_loss: 3.2844 - val_accuracy1000: 0.3899 - 11s/epoch - 27ms/step
Epoch 9/50
401/401 - 11s - loss: 3.2852 - accuracy1000: 0.3536 - val_loss: 3.2863 - val_accuracy1000: 0.3853 - 11s/epoch - 27ms/step
Epoch 10/50
401/401 - 11s - loss: 3.2822 - accuracy1000: 0.3515 - val_loss: 3.2857 - val_accuracy1000: 0.3903 - 11s/epoch - 28ms/step
Epoch 11/50
401/401 - 11s - loss: 3.2829 - accuracy1000: 0.3528 - val_loss: 3.2848 - val_accuracy1000: 0.3872 - 11s/epoch - 28ms/step
Epoch 12/50
401/401 - 11s - loss: 3.2783 - accuracy1000: 0.3550 - val_loss: 3.2853 - val_accuracy1000: 0.3884 - 11s/epoch - 28ms/step
Epoch 13/50
401/401 - 11s - loss: 3.2766 - accuracy1000: 0.3578 - val_loss: 3.2868 - val_accuracy1000: 0.3862 - 11s/epoch - 28ms/step
Epoch 14/50
401/401 - 11s - loss: 3.2734 - accuracy1000: 0.3563 - val_loss: 3.2883 - val_accuracy1000: 0.3859 - 11s/epoch - 28ms/step
Epoch 15/50
401/401 - 11s - loss: 3.2699 - accuracy1000: 0.3595 - val_loss: 3.2908 - val_accuracy1000: 0.3812 - 11s/epoch - 27ms/step
Epoch 16/50
401/401 - 11s - loss: 3.2672 - accuracy1000: 0.3636 - val_loss: 3.2932 - val_accuracy1000: 0.3816 - 11s/epoch - 28ms/step
Epoch 17/50
401/401 - 11s - loss: 3.2674 - accuracy1000: 0.3624 - val_loss: 3.2917 - val_accuracy1000: 0.3768 - 11s/epoch - 27ms/step
Epoch 18/50
401/401 - 11s - loss: 3.2644 - accuracy1000: 0.3634 - val_loss: 3.2941 - val_accuracy1000: 0.3806 - 11s/epoch - 27ms/step
testing model: results/CHTR/W7/deepVOL_L2/h1000
Evaluating performance on  test set...
1065/1065 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0930057
{'0': {'precision': 0.32, 'recall': 0.001364507071820305, 'f1-score': 0.0027174268058476935, 'support': 76218}, '1': {'precision': 0.37576896787423103, 'recall': 0.046121417410363165, 'f1-score': 0.08215876929974501, 'support': 95357}, '2': {'precision': 0.3704929615322587, 'recall': 0.9564432989690722, 'f1-score': 0.534095752630734, 'support': 100880}, 'accuracy': 0.37065937494265105, 'macro avg': {'precision': 0.35542064313549654, 'recall': 0.33464307448375186, 'f1-score': 0.20632398291210893, 'support': 272455}, 'weighted avg': {'precision': 0.35821435256815737, 'recall': 0.37065937494265105, 'f1-score': 0.22727096263893978, 'support': 272455}}
[[  104  3014 73100]
 [  119  4398 90840]
 [  102  4292 96486]]
Evaluating performance on  train set...
401/401 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1097492
{'0': {'precision': 0.5142857142857142, 'recall': 0.0025157935931123163, 'f1-score': 0.00500709338229158, 'support': 35774}, '1': {'precision': 0.43593489148580966, 'recall': 0.061589716374786246, 'f1-score': 0.10793076724360628, 'support': 33918}, '2': {'precision': 0.3244970050683459, 'recall': 0.9621129326047358, 'f1-score': 0.48531066957620306, 'support': 32940}, 'accuracy': 0.3300237742614389, 'macro avg': {'precision': 0.4249058702799566, 'recall': 0.34207281419087815, 'f1-score': 0.19941617673403364, 'support': 102632}, 'weighted avg': {'precision': 0.42747903323743225, 'recall': 0.3300237742614389, 'f1-score': 0.1931761339335379, 'support': 102632}}
[[   90  1491 34193]
 [   49  2089 31780]
 [   36  1212 31692]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0950376
{'0': {'precision': 0.3333333333333333, 'recall': 0.0018602728400165358, 'f1-score': 0.0036998972250770813, 'support': 9676}, '1': {'precision': 0.30972865651886167, 'recall': 0.049434879053554454, 'f1-score': 0.08526143195481874, 'support': 9467}, '2': {'precision': 0.39129997316876847, 'recall': 0.9533420493544696, 'f1-score': 0.5548580396632902, 'support': 12238}, 'accuracy': 0.3872725534559128, 'macro avg': {'precision': 0.34478732100698783, 'recall': 0.3348790670826802, 'f1-score': 0.214606456281062, 'support': 31381}, 'weighted avg': {'precision': 0.34881818923032365, 'recall': 0.3872725534559128, 'f1-score': 0.24324664195740925, 'support': 31381}}
[[   18   494  9164]
 [   14   468  8985]
 [   22   549 11667]]
training model: results/CHTR/W7/deepVOL_L3/h10
Epoch 1/50
401/401 - 19s - loss: 3.3189 - accuracy10: 0.3556 - val_loss: 3.3467 - val_accuracy10: 0.3315 - 19s/epoch - 48ms/step
Epoch 2/50
401/401 - 16s - loss: 3.2972 - accuracy10: 0.3581 - val_loss: 3.3254 - val_accuracy10: 0.3335 - 16s/epoch - 39ms/step
Epoch 3/50
401/401 - 15s - loss: 3.2834 - accuracy10: 0.3652 - val_loss: 3.3154 - val_accuracy10: 0.3399 - 15s/epoch - 39ms/step
Epoch 4/50
401/401 - 15s - loss: 3.2767 - accuracy10: 0.3688 - val_loss: 3.3125 - val_accuracy10: 0.3409 - 15s/epoch - 39ms/step
Epoch 5/50
401/401 - 16s - loss: 3.2657 - accuracy10: 0.3727 - val_loss: 3.3042 - val_accuracy10: 0.3515 - 16s/epoch - 39ms/step
Epoch 6/50
401/401 - 16s - loss: 3.2624 - accuracy10: 0.3799 - val_loss: 3.2971 - val_accuracy10: 0.3559 - 16s/epoch - 39ms/step
Epoch 7/50
401/401 - 15s - loss: 3.2578 - accuracy10: 0.3783 - val_loss: 3.2970 - val_accuracy10: 0.3576 - 15s/epoch - 39ms/step
Epoch 8/50
401/401 - 16s - loss: 3.2507 - accuracy10: 0.3837 - val_loss: 3.2864 - val_accuracy10: 0.3622 - 16s/epoch - 39ms/step
Epoch 9/50
401/401 - 16s - loss: 3.2459 - accuracy10: 0.3851 - val_loss: 3.2797 - val_accuracy10: 0.3677 - 16s/epoch - 39ms/step
Epoch 10/50
401/401 - 15s - loss: 3.2449 - accuracy10: 0.3843 - val_loss: 3.2811 - val_accuracy10: 0.3689 - 15s/epoch - 38ms/step
Epoch 11/50
401/401 - 16s - loss: 3.2404 - accuracy10: 0.3903 - val_loss: 3.2806 - val_accuracy10: 0.3666 - 16s/epoch - 39ms/step
Epoch 12/50
401/401 - 16s - loss: 3.2350 - accuracy10: 0.3890 - val_loss: 3.2758 - val_accuracy10: 0.3741 - 16s/epoch - 39ms/step
Epoch 13/50
401/401 - 15s - loss: 3.2286 - accuracy10: 0.3931 - val_loss: 3.2738 - val_accuracy10: 0.3716 - 15s/epoch - 38ms/step
Epoch 14/50
401/401 - 15s - loss: 3.2280 - accuracy10: 0.3950 - val_loss: 3.2747 - val_accuracy10: 0.3722 - 15s/epoch - 39ms/step
Epoch 15/50
401/401 - 16s - loss: 3.2249 - accuracy10: 0.3960 - val_loss: 3.2683 - val_accuracy10: 0.3755 - 16s/epoch - 39ms/step
Epoch 16/50
401/401 - 16s - loss: 3.2198 - accuracy10: 0.3974 - val_loss: 3.2706 - val_accuracy10: 0.3774 - 16s/epoch - 39ms/step
Epoch 17/50
401/401 - 16s - loss: 3.2168 - accuracy10: 0.3975 - val_loss: 3.2668 - val_accuracy10: 0.3815 - 16s/epoch - 39ms/step
Epoch 18/50
401/401 - 16s - loss: 3.2117 - accuracy10: 0.4000 - val_loss: 3.2658 - val_accuracy10: 0.3803 - 16s/epoch - 39ms/step
Epoch 19/50
401/401 - 16s - loss: 3.2067 - accuracy10: 0.4031 - val_loss: 3.2671 - val_accuracy10: 0.3783 - 16s/epoch - 39ms/step
Epoch 20/50
401/401 - 15s - loss: 3.2001 - accuracy10: 0.4055 - val_loss: 3.2686 - val_accuracy10: 0.3797 - 15s/epoch - 39ms/step
Epoch 21/50
401/401 - 16s - loss: 3.1967 - accuracy10: 0.4073 - val_loss: 3.2689 - val_accuracy10: 0.3800 - 16s/epoch - 39ms/step
Epoch 22/50
401/401 - 16s - loss: 3.1929 - accuracy10: 0.4087 - val_loss: 3.2665 - val_accuracy10: 0.3826 - 16s/epoch - 39ms/step
Epoch 23/50
401/401 - 16s - loss: 3.1923 - accuracy10: 0.4108 - val_loss: 3.2632 - val_accuracy10: 0.3850 - 16s/epoch - 39ms/step
Epoch 24/50
401/401 - 16s - loss: 3.1875 - accuracy10: 0.4109 - val_loss: 3.2656 - val_accuracy10: 0.3831 - 16s/epoch - 39ms/step
Epoch 25/50
401/401 - 16s - loss: 3.1812 - accuracy10: 0.4120 - val_loss: 3.2715 - val_accuracy10: 0.3841 - 16s/epoch - 40ms/step
Epoch 26/50
401/401 - 15s - loss: 3.1812 - accuracy10: 0.4138 - val_loss: 3.2714 - val_accuracy10: 0.3828 - 15s/epoch - 39ms/step
Epoch 27/50
401/401 - 15s - loss: 3.1791 - accuracy10: 0.4141 - val_loss: 3.2693 - val_accuracy10: 0.3827 - 15s/epoch - 39ms/step
Epoch 28/50
401/401 - 16s - loss: 3.1779 - accuracy10: 0.4126 - val_loss: 3.2663 - val_accuracy10: 0.3895 - 16s/epoch - 39ms/step
Epoch 29/50
401/401 - 15s - loss: 3.1758 - accuracy10: 0.4163 - val_loss: 3.2672 - val_accuracy10: 0.3839 - 15s/epoch - 38ms/step
Epoch 30/50
401/401 - 16s - loss: 3.1714 - accuracy10: 0.4155 - val_loss: 3.2666 - val_accuracy10: 0.3841 - 16s/epoch - 39ms/step
Epoch 31/50
401/401 - 16s - loss: 3.1695 - accuracy10: 0.4175 - val_loss: 3.2672 - val_accuracy10: 0.3856 - 16s/epoch - 39ms/step
Epoch 32/50
401/401 - 15s - loss: 3.1643 - accuracy10: 0.4191 - val_loss: 3.2642 - val_accuracy10: 0.3856 - 15s/epoch - 39ms/step
Epoch 33/50
401/401 - 15s - loss: 3.1620 - accuracy10: 0.4190 - val_loss: 3.2677 - val_accuracy10: 0.3845 - 15s/epoch - 39ms/step
testing model: results/CHTR/W7/deepVOL_L3/h10
Evaluating performance on  test set...
1065/1065 - 20s - 20s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0860924
{'0': {'precision': 0.3748798787699586, 'recall': 0.4600512541388851, 'f1-score': 0.41312139787793006, 'support': 88188}, '1': {'precision': 0.4028132738979693, 'recall': 0.42132311039734754, 'f1-score': 0.4118603296786772, 'support': 96515}, '2': {'precision': 0.3939097043346344, 'recall': 0.28406190172303764, 'f1-score': 0.33008680222203096, 'support': 87752}, 'accuracy': 0.3896496669174726, 'macro avg': {'precision': 0.39053428566752074, 'recall': 0.3884787554197568, 'f1-score': 0.3850228432595461, 'support': 272455}, 'weighted avg': {'precision': 0.3909041649226494, 'recall': 0.3896496669174726, 'f1-score': 0.38593098538688625, 'support': 272455}}
[[40571 29957 17660]
 [35157 40664 20694]
 [32496 30329 24927]]
Evaluating performance on  train set...
401/401 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0710152
{'0': {'precision': 0.39860287891617274, 'recall': 0.47904005427255, 'f1-score': 0.43513537801856395, 'support': 35377}, '1': {'precision': 0.39285714285714285, 'recall': 0.4318879056047198, 'f1-score': 0.41144896582733814, 'support': 33900}, '2': {'precision': 0.41924894957983194, 'recall': 0.2871833308349573, 'f1-score': 0.3408714837286266, 'support': 33355}, 'accuracy': 0.40111271338373994, 'macro avg': {'precision': 0.40356965711771586, 'recall': 0.39937043023740904, 'f1-score': 0.3958186091915095, 'support': 102632}, 'weighted avg': {'precision': 0.4034149183832516, 'recall': 0.40111271338373994, 'f1-score': 0.3966762077079063, 'support': 102632}}
[[16947 11578  6852]
 [12842 14641  6417]
 [12727 11049  9579]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0853119
{'0': {'precision': 0.35866190624029803, 'recall': 0.4603048112361789, 'f1-score': 0.40317584958338787, 'support': 10039}, '1': {'precision': 0.3881548554005359, 'recall': 0.3891977024272744, 'f1-score': 0.3886755794050979, 'support': 10794}, '2': {'precision': 0.4068282512379463, 'recall': 0.29598028062191883, 'f1-score': 0.3426627153989683, 'support': 10548}, 'accuracy': 0.38061247251521624, 'macro avg': {'precision': 0.3845483376262601, 'recall': 0.381827598095124, 'f1-score': 0.3781713814624847, 'support': 31381}, 'weighted avg': {'precision': 0.38499648768355355, 'recall': 0.38061247251521624, 'f1-score': 0.3778481527068792, 'support': 31381}}
[[4621 3297 2121]
 [4162 4201 2431]
 [4101 3325 3122]]
training model: results/CHTR/W7/deepVOL_L3/h20
Epoch 1/50
401/401 - 18s - loss: 3.3157 - accuracy20: 0.3560 - val_loss: 3.3215 - val_accuracy20: 0.3345 - 18s/epoch - 46ms/step
Epoch 2/50
401/401 - 16s - loss: 3.2980 - accuracy20: 0.3568 - val_loss: 3.3188 - val_accuracy20: 0.3399 - 16s/epoch - 40ms/step
Epoch 3/50
401/401 - 16s - loss: 3.2914 - accuracy20: 0.3610 - val_loss: 3.3077 - val_accuracy20: 0.3436 - 16s/epoch - 39ms/step
Epoch 4/50
401/401 - 16s - loss: 3.2841 - accuracy20: 0.3634 - val_loss: 3.2957 - val_accuracy20: 0.3493 - 16s/epoch - 39ms/step
Epoch 5/50
401/401 - 16s - loss: 3.2766 - accuracy20: 0.3685 - val_loss: 3.2933 - val_accuracy20: 0.3518 - 16s/epoch - 39ms/step
Epoch 6/50
401/401 - 16s - loss: 3.2806 - accuracy20: 0.3700 - val_loss: 3.2913 - val_accuracy20: 0.3588 - 16s/epoch - 39ms/step
Epoch 7/50
401/401 - 15s - loss: 3.2739 - accuracy20: 0.3742 - val_loss: 3.2831 - val_accuracy20: 0.3595 - 15s/epoch - 39ms/step
Epoch 8/50
401/401 - 16s - loss: 3.2661 - accuracy20: 0.3782 - val_loss: 3.2837 - val_accuracy20: 0.3623 - 16s/epoch - 39ms/step
Epoch 9/50
401/401 - 16s - loss: 3.2639 - accuracy20: 0.3812 - val_loss: 3.2843 - val_accuracy20: 0.3624 - 16s/epoch - 39ms/step
Epoch 10/50
401/401 - 16s - loss: 3.2628 - accuracy20: 0.3817 - val_loss: 3.2796 - val_accuracy20: 0.3668 - 16s/epoch - 39ms/step
Epoch 11/50
401/401 - 16s - loss: 3.2603 - accuracy20: 0.3825 - val_loss: 3.2793 - val_accuracy20: 0.3688 - 16s/epoch - 39ms/step
Epoch 12/50
401/401 - 15s - loss: 3.2562 - accuracy20: 0.3841 - val_loss: 3.2759 - val_accuracy20: 0.3690 - 15s/epoch - 38ms/step
Epoch 13/50
401/401 - 16s - loss: 3.2496 - accuracy20: 0.3884 - val_loss: 3.2734 - val_accuracy20: 0.3738 - 16s/epoch - 39ms/step
Epoch 14/50
401/401 - 16s - loss: 3.2414 - accuracy20: 0.3911 - val_loss: 3.2738 - val_accuracy20: 0.3726 - 16s/epoch - 39ms/step
Epoch 15/50
401/401 - 16s - loss: 3.2342 - accuracy20: 0.3935 - val_loss: 3.2693 - val_accuracy20: 0.3750 - 16s/epoch - 39ms/step
Epoch 16/50
401/401 - 16s - loss: 3.2292 - accuracy20: 0.3946 - val_loss: 3.2701 - val_accuracy20: 0.3801 - 16s/epoch - 39ms/step
Epoch 17/50
401/401 - 16s - loss: 3.2234 - accuracy20: 0.3973 - val_loss: 3.2690 - val_accuracy20: 0.3771 - 16s/epoch - 39ms/step
Epoch 18/50
401/401 - 15s - loss: 3.2161 - accuracy20: 0.3996 - val_loss: 3.2723 - val_accuracy20: 0.3775 - 15s/epoch - 39ms/step
Epoch 19/50
401/401 - 16s - loss: 3.2143 - accuracy20: 0.3995 - val_loss: 3.2667 - val_accuracy20: 0.3791 - 16s/epoch - 39ms/step
Epoch 20/50
401/401 - 15s - loss: 3.2130 - accuracy20: 0.4026 - val_loss: 3.2687 - val_accuracy20: 0.3808 - 15s/epoch - 38ms/step
Epoch 21/50
401/401 - 15s - loss: 3.2122 - accuracy20: 0.4001 - val_loss: 3.2669 - val_accuracy20: 0.3814 - 15s/epoch - 39ms/step
Epoch 22/50
401/401 - 16s - loss: 3.2078 - accuracy20: 0.4016 - val_loss: 3.2778 - val_accuracy20: 0.3796 - 16s/epoch - 40ms/step
Epoch 23/50
401/401 - 16s - loss: 3.2027 - accuracy20: 0.4035 - val_loss: 3.2735 - val_accuracy20: 0.3801 - 16s/epoch - 39ms/step
Epoch 24/50
401/401 - 16s - loss: 3.1976 - accuracy20: 0.4059 - val_loss: 3.2717 - val_accuracy20: 0.3816 - 16s/epoch - 39ms/step
Epoch 25/50
401/401 - 16s - loss: 3.1941 - accuracy20: 0.4078 - val_loss: 3.2689 - val_accuracy20: 0.3807 - 16s/epoch - 40ms/step
Epoch 26/50
401/401 - 16s - loss: 3.1910 - accuracy20: 0.4066 - val_loss: 3.2708 - val_accuracy20: 0.3821 - 16s/epoch - 39ms/step
Epoch 27/50
401/401 - 16s - loss: 3.1886 - accuracy20: 0.4079 - val_loss: 3.2777 - val_accuracy20: 0.3803 - 16s/epoch - 40ms/step
Epoch 28/50
401/401 - 16s - loss: 3.1871 - accuracy20: 0.4088 - val_loss: 3.2740 - val_accuracy20: 0.3788 - 16s/epoch - 39ms/step
Epoch 29/50
401/401 - 16s - loss: 3.1828 - accuracy20: 0.4111 - val_loss: 3.2727 - val_accuracy20: 0.3812 - 16s/epoch - 40ms/step
testing model: results/CHTR/W7/deepVOL_L3/h20
Evaluating performance on  test set...
1065/1065 - 19s - 19s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0862063
{'0': {'precision': 0.3857736108634175, 'recall': 0.3484363853924569, 'f1-score': 0.36615563186148864, 'support': 86914}, '1': {'precision': 0.39724045756515586, 'recall': 0.5215636483752426, 'f1-score': 0.450990980537419, 'support': 96876}, '2': {'precision': 0.40251355642769404, 'recall': 0.3030620876332262, 'f1-score': 0.3457789387671065, 'support': 88665}, 'accuracy': 0.3952285698555725, 'macro avg': {'precision': 0.3951758749520891, 'recall': 0.39102070713364184, 'f1-score': 0.3876418503886714, 'support': 272455}, 'weighted avg': {'precision': 0.39529852145244754, 'recall': 0.3952285698555725, 'f1-score': 0.38968909516778155, 'support': 272455}}
[[30284 38263 18367]
 [24829 50527 21520]
 [23389 38405 26871]]
Evaluating performance on  train set...
401/401 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0793287
{'0': {'precision': 0.41255188650021685, 'recall': 0.3750070394773892, 'f1-score': 0.3928845359608236, 'support': 35514}, '1': {'precision': 0.37064671344087163, 'recall': 0.5152943950020629, 'f1-score': 0.43116223446881435, 'support': 33934}, '2': {'precision': 0.4084494886290079, 'recall': 0.2852278206364513, 'f1-score': 0.3358943875649875, 'support': 33184}, 'accuracy': 0.3923630056902331, 'macro avg': {'precision': 0.3972160295233655, 'recall': 0.39184308503863446, 'f1-score': 0.38664705266487515, 'support': 102632}, 'weighted avg': {'precision': 0.39737003178088937, 'recall': 0.3923630056902331, 'f1-score': 0.3871139608653635, 'support': 102632}}
[[13318 15334  6862]
 [ 9602 17486  6846]
 [ 9362 14357  9465]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.088024
{'0': {'precision': 0.37870416875941737, 'recall': 0.3720517122273759, 'f1-score': 0.37534846674631617, 'support': 10133}, '1': {'precision': 0.36156084458703275, 'recall': 0.4607339798440768, 'f1-score': 0.40516700806822453, 'support': 10518}, '2': {'precision': 0.41181602891686403, 'recall': 0.3079217148182665, 'f1-score': 0.3523702874206794, 'support': 10730}, 'accuracy': 0.37984767853159557, 'macro avg': {'precision': 0.38402701408777135, 'recall': 0.38023580229657306, 'f1-score': 0.37762858741174, 'support': 31381}, 'weighted avg': {'precision': 0.3842800514860437, 'recall': 0.37984767853159557, 'f1-score': 0.37748592423523464, 'support': 31381}}
[[3770 4270 2093]
 [3046 4846 2626]
 [3139 4287 3304]]
training model: results/CHTR/W7/deepVOL_L3/h30
Epoch 1/50
401/401 - 18s - loss: 3.3158 - accuracy30: 0.3565 - val_loss: 3.3221 - val_accuracy30: 0.3426 - 18s/epoch - 45ms/step
Epoch 2/50
401/401 - 15s - loss: 3.2956 - accuracy30: 0.3651 - val_loss: 3.3234 - val_accuracy30: 0.3385 - 15s/epoch - 39ms/step
Epoch 3/50
401/401 - 16s - loss: 3.2891 - accuracy30: 0.3627 - val_loss: 3.3163 - val_accuracy30: 0.3412 - 16s/epoch - 40ms/step
Epoch 4/50
401/401 - 16s - loss: 3.2894 - accuracy30: 0.3672 - val_loss: 3.3154 - val_accuracy30: 0.3411 - 16s/epoch - 40ms/step
Epoch 5/50
401/401 - 16s - loss: 3.2826 - accuracy30: 0.3699 - val_loss: 3.2987 - val_accuracy30: 0.3538 - 16s/epoch - 39ms/step
Epoch 6/50
401/401 - 16s - loss: 3.2761 - accuracy30: 0.3709 - val_loss: 3.2980 - val_accuracy30: 0.3503 - 16s/epoch - 40ms/step
Epoch 7/50
401/401 - 16s - loss: 3.2726 - accuracy30: 0.3738 - val_loss: 3.2894 - val_accuracy30: 0.3611 - 16s/epoch - 40ms/step
Epoch 8/50
401/401 - 16s - loss: 3.2695 - accuracy30: 0.3745 - val_loss: 3.2869 - val_accuracy30: 0.3645 - 16s/epoch - 39ms/step
Epoch 9/50
401/401 - 16s - loss: 3.2670 - accuracy30: 0.3747 - val_loss: 3.2897 - val_accuracy30: 0.3614 - 16s/epoch - 41ms/step
Epoch 10/50
401/401 - 16s - loss: 3.2649 - accuracy30: 0.3767 - val_loss: 3.2890 - val_accuracy30: 0.3628 - 16s/epoch - 40ms/step
Epoch 11/50
401/401 - 16s - loss: 3.2647 - accuracy30: 0.3794 - val_loss: 3.2915 - val_accuracy30: 0.3611 - 16s/epoch - 39ms/step
Epoch 12/50
401/401 - 16s - loss: 3.2600 - accuracy30: 0.3787 - val_loss: 3.2911 - val_accuracy30: 0.3604 - 16s/epoch - 39ms/step
Epoch 13/50
401/401 - 16s - loss: 3.2587 - accuracy30: 0.3810 - val_loss: 3.2879 - val_accuracy30: 0.3652 - 16s/epoch - 39ms/step
Epoch 14/50
401/401 - 16s - loss: 3.2502 - accuracy30: 0.3817 - val_loss: 3.2873 - val_accuracy30: 0.3620 - 16s/epoch - 39ms/step
Epoch 15/50
401/401 - 16s - loss: 3.2523 - accuracy30: 0.3823 - val_loss: 3.2879 - val_accuracy30: 0.3612 - 16s/epoch - 39ms/step
Epoch 16/50
401/401 - 16s - loss: 3.2476 - accuracy30: 0.3834 - val_loss: 3.2854 - val_accuracy30: 0.3692 - 16s/epoch - 39ms/step
Epoch 17/50
401/401 - 15s - loss: 3.2385 - accuracy30: 0.3867 - val_loss: 3.2858 - val_accuracy30: 0.3686 - 15s/epoch - 38ms/step
Epoch 18/50
401/401 - 16s - loss: 3.2390 - accuracy30: 0.3875 - val_loss: 3.2905 - val_accuracy30: 0.3670 - 16s/epoch - 39ms/step
Epoch 19/50
401/401 - 15s - loss: 3.2360 - accuracy30: 0.3890 - val_loss: 3.2897 - val_accuracy30: 0.3625 - 15s/epoch - 39ms/step
Epoch 20/50
401/401 - 16s - loss: 3.2286 - accuracy30: 0.3924 - val_loss: 3.2907 - val_accuracy30: 0.3640 - 16s/epoch - 39ms/step
Epoch 21/50
401/401 - 16s - loss: 3.2262 - accuracy30: 0.3906 - val_loss: 3.2864 - val_accuracy30: 0.3690 - 16s/epoch - 39ms/step
Epoch 22/50
401/401 - 15s - loss: 3.2269 - accuracy30: 0.3923 - val_loss: 3.2845 - val_accuracy30: 0.3696 - 15s/epoch - 39ms/step
Epoch 23/50
401/401 - 16s - loss: 3.2238 - accuracy30: 0.3927 - val_loss: 3.2837 - val_accuracy30: 0.3705 - 16s/epoch - 39ms/step
Epoch 24/50
401/401 - 16s - loss: 3.2199 - accuracy30: 0.3938 - val_loss: 3.2829 - val_accuracy30: 0.3690 - 16s/epoch - 39ms/step
Epoch 25/50
401/401 - 16s - loss: 3.2174 - accuracy30: 0.3943 - val_loss: 3.2855 - val_accuracy30: 0.3678 - 16s/epoch - 39ms/step
Epoch 26/50
401/401 - 15s - loss: 3.2138 - accuracy30: 0.3969 - val_loss: 3.2843 - val_accuracy30: 0.3697 - 15s/epoch - 39ms/step
Epoch 27/50
401/401 - 16s - loss: 3.2100 - accuracy30: 0.3993 - val_loss: 3.2795 - val_accuracy30: 0.3723 - 16s/epoch - 40ms/step
Epoch 28/50
401/401 - 16s - loss: 3.2058 - accuracy30: 0.4001 - val_loss: 3.2775 - val_accuracy30: 0.3739 - 16s/epoch - 40ms/step
Epoch 29/50
401/401 - 16s - loss: 3.2036 - accuracy30: 0.4031 - val_loss: 3.2798 - val_accuracy30: 0.3754 - 16s/epoch - 39ms/step
Epoch 30/50
401/401 - 16s - loss: 3.2006 - accuracy30: 0.4018 - val_loss: 3.2807 - val_accuracy30: 0.3718 - 16s/epoch - 39ms/step
Epoch 31/50
401/401 - 16s - loss: 3.1982 - accuracy30: 0.4031 - val_loss: 3.2804 - val_accuracy30: 0.3763 - 16s/epoch - 39ms/step
Epoch 32/50
401/401 - 17s - loss: 3.1952 - accuracy30: 0.4041 - val_loss: 3.2847 - val_accuracy30: 0.3736 - 17s/epoch - 42ms/step
Epoch 33/50
401/401 - 16s - loss: 3.1929 - accuracy30: 0.4058 - val_loss: 3.2842 - val_accuracy30: 0.3739 - 16s/epoch - 40ms/step
Epoch 34/50
401/401 - 16s - loss: 3.1897 - accuracy30: 0.4067 - val_loss: 3.2843 - val_accuracy30: 0.3740 - 16s/epoch - 39ms/step
Epoch 35/50
401/401 - 16s - loss: 3.1873 - accuracy30: 0.4088 - val_loss: 3.2857 - val_accuracy30: 0.3720 - 16s/epoch - 39ms/step
Epoch 36/50
401/401 - 15s - loss: 3.1835 - accuracy30: 0.4111 - val_loss: 3.2888 - val_accuracy30: 0.3735 - 15s/epoch - 39ms/step
Epoch 37/50
401/401 - 16s - loss: 3.1808 - accuracy30: 0.4102 - val_loss: 3.2919 - val_accuracy30: 0.3716 - 16s/epoch - 39ms/step
Epoch 38/50
401/401 - 16s - loss: 3.1781 - accuracy30: 0.4115 - val_loss: 3.2978 - val_accuracy30: 0.3752 - 16s/epoch - 39ms/step
testing model: results/CHTR/W7/deepVOL_L3/h30
Evaluating performance on  test set...
1065/1065 - 19s - 19s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0926331
{'0': {'precision': 0.36599206437168885, 'recall': 0.38274395261773125, 'f1-score': 0.3741806088281785, 'support': 86277}, '1': {'precision': 0.39519419825908253, 'recall': 0.4152400726706463, 'f1-score': 0.40496922080025927, 'support': 96325}, '2': {'precision': 0.3824335332888988, 'recall': 0.3448298888184034, 'f1-score': 0.3626595501869831, 'support': 89853}, 'accuracy': 0.38172909287772294, 'macro avg': {'precision': 0.38120659863989004, 'recall': 0.38093797136892693, 'f1-score': 0.38060312660514034, 'support': 272455}, 'weighted avg': {'precision': 0.3817385577497559, 'recall': 0.38172909287772294, 'f1-score': 0.3812662243100869, 'support': 272455}}
[[33022 29810 23445]
 [29738 39998 26589]
 [27466 31403 30984]]
Evaluating performance on  train set...
401/401 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0734041
{'0': {'precision': 0.401299160166336, 'recall': 0.41679604798870856, 'f1-score': 0.408900828048409, 'support': 35425}, '1': {'precision': 0.3925106290199499, 'recall': 0.42219746716697937, 'f1-score': 0.4068131743969267, 'support': 34112}, '2': {'precision': 0.3884104710604865, 'recall': 0.3420758422722466, 'f1-score': 0.3637736576588156, 'support': 33095}, 'accuracy': 0.3944968430898745, 'macro avg': {'precision': 0.3940734200822575, 'recall': 0.3936897858093115, 'f1-score': 0.39316255336805045, 'support': 102632}, 'weighted avg': {'precision': 0.39422197624296307, 'recall': 0.3944968430898745, 'f1-score': 0.39365511769098677, 'support': 102632}}
[[14765 11469  9191]
 [11075 14402  8635]
 [10953 10821 11321]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0916976
{'0': {'precision': 0.3626049669465785, 'recall': 0.40092848676412485, 'f1-score': 0.38080495356037153, 'support': 10124}, '1': {'precision': 0.36726546906187624, 'recall': 0.36870229007633587, 'f1-score': 0.3679824770249036, 'support': 10480}, '2': {'precision': 0.3968549555141734, 'recall': 0.3559432123967709, 'f1-score': 0.3752873844347698, 'support': 10777}, 'accuracy': 0.37471718555814026, 'macro avg': {'precision': 0.3755751305075427, 'recall': 0.3751913297457439, 'f1-score': 0.3746916050066816, 'support': 31381}, 'weighted avg': {'precision': 0.3759236689943555, 'recall': 0.37471718555814026, 'f1-score': 0.37462789111627115, 'support': 31381}}
[[4059 3299 2766]
 [3552 3864 3064]
 [3583 3358 3836]]
training model: results/CHTR/W7/deepVOL_L3/h50
Epoch 1/50
401/401 - 18s - loss: 3.3191 - accuracy50: 0.3558 - val_loss: 3.3345 - val_accuracy50: 0.3286 - 18s/epoch - 45ms/step
Epoch 2/50
401/401 - 16s - loss: 3.2949 - accuracy50: 0.3538 - val_loss: 3.3110 - val_accuracy50: 0.3301 - 16s/epoch - 39ms/step
Epoch 3/50
401/401 - 16s - loss: 3.2959 - accuracy50: 0.3513 - val_loss: 3.3031 - val_accuracy50: 0.3335 - 16s/epoch - 39ms/step
Epoch 4/50
401/401 - 16s - loss: 3.2946 - accuracy50: 0.3541 - val_loss: 3.3040 - val_accuracy50: 0.3370 - 16s/epoch - 39ms/step
Epoch 5/50
401/401 - 16s - loss: 3.2918 - accuracy50: 0.3562 - val_loss: 3.3000 - val_accuracy50: 0.3402 - 16s/epoch - 39ms/step
Epoch 6/50
401/401 - 16s - loss: 3.2896 - accuracy50: 0.3569 - val_loss: 3.3011 - val_accuracy50: 0.3489 - 16s/epoch - 39ms/step
Epoch 7/50
401/401 - 16s - loss: 3.2864 - accuracy50: 0.3651 - val_loss: 3.2999 - val_accuracy50: 0.3481 - 16s/epoch - 39ms/step
Epoch 8/50
401/401 - 16s - loss: 3.2853 - accuracy50: 0.3634 - val_loss: 3.2980 - val_accuracy50: 0.3529 - 16s/epoch - 40ms/step
Epoch 9/50
401/401 - 16s - loss: 3.2862 - accuracy50: 0.3604 - val_loss: 3.2996 - val_accuracy50: 0.3532 - 16s/epoch - 40ms/step
Epoch 10/50
401/401 - 16s - loss: 3.2834 - accuracy50: 0.3628 - val_loss: 3.2934 - val_accuracy50: 0.3561 - 16s/epoch - 39ms/step
Epoch 11/50
401/401 - 15s - loss: 3.2782 - accuracy50: 0.3681 - val_loss: 3.2940 - val_accuracy50: 0.3545 - 15s/epoch - 38ms/step
Epoch 12/50
401/401 - 15s - loss: 3.2728 - accuracy50: 0.3709 - val_loss: 3.2943 - val_accuracy50: 0.3576 - 15s/epoch - 38ms/step
Epoch 13/50
401/401 - 16s - loss: 3.2626 - accuracy50: 0.3750 - val_loss: 3.2944 - val_accuracy50: 0.3524 - 16s/epoch - 39ms/step
Epoch 14/50
401/401 - 15s - loss: 3.2707 - accuracy50: 0.3707 - val_loss: 3.2967 - val_accuracy50: 0.3563 - 15s/epoch - 39ms/step
Epoch 15/50
401/401 - 16s - loss: 3.2719 - accuracy50: 0.3726 - val_loss: 3.2950 - val_accuracy50: 0.3612 - 16s/epoch - 39ms/step
Epoch 16/50
401/401 - 16s - loss: 3.2711 - accuracy50: 0.3744 - val_loss: 3.2932 - val_accuracy50: 0.3601 - 16s/epoch - 39ms/step
Epoch 17/50
401/401 - 16s - loss: 3.2657 - accuracy50: 0.3765 - val_loss: 3.2955 - val_accuracy50: 0.3587 - 16s/epoch - 39ms/step
Epoch 18/50
401/401 - 16s - loss: 3.2638 - accuracy50: 0.3745 - val_loss: 3.2939 - val_accuracy50: 0.3604 - 16s/epoch - 39ms/step
Epoch 19/50
401/401 - 16s - loss: 3.2592 - accuracy50: 0.3779 - val_loss: 3.2952 - val_accuracy50: 0.3612 - 16s/epoch - 39ms/step
Epoch 20/50
401/401 - 16s - loss: 3.2551 - accuracy50: 0.3790 - val_loss: 3.2942 - val_accuracy50: 0.3611 - 16s/epoch - 39ms/step
Epoch 21/50
401/401 - 16s - loss: 3.2505 - accuracy50: 0.3820 - val_loss: 3.2929 - val_accuracy50: 0.3654 - 16s/epoch - 39ms/step
Epoch 22/50
401/401 - 15s - loss: 3.2474 - accuracy50: 0.3839 - val_loss: 3.2965 - val_accuracy50: 0.3601 - 15s/epoch - 39ms/step
Epoch 23/50
401/401 - 16s - loss: 3.2455 - accuracy50: 0.3819 - val_loss: 3.2958 - val_accuracy50: 0.3646 - 16s/epoch - 39ms/step
Epoch 24/50
401/401 - 15s - loss: 3.2381 - accuracy50: 0.3850 - val_loss: 3.2943 - val_accuracy50: 0.3658 - 15s/epoch - 38ms/step
Epoch 25/50
401/401 - 16s - loss: 3.2334 - accuracy50: 0.3896 - val_loss: 3.2924 - val_accuracy50: 0.3681 - 16s/epoch - 40ms/step
Epoch 26/50
401/401 - 15s - loss: 3.2337 - accuracy50: 0.3875 - val_loss: 3.2974 - val_accuracy50: 0.3594 - 15s/epoch - 39ms/step
Epoch 27/50
401/401 - 15s - loss: 3.2303 - accuracy50: 0.3892 - val_loss: 3.3001 - val_accuracy50: 0.3624 - 15s/epoch - 39ms/step
Epoch 28/50
401/401 - 16s - loss: 3.2252 - accuracy50: 0.3910 - val_loss: 3.3018 - val_accuracy50: 0.3650 - 16s/epoch - 39ms/step
Epoch 29/50
401/401 - 15s - loss: 3.2268 - accuracy50: 0.3892 - val_loss: 3.2985 - val_accuracy50: 0.3667 - 15s/epoch - 38ms/step
Epoch 30/50
401/401 - 16s - loss: 3.2214 - accuracy50: 0.3929 - val_loss: 3.2967 - val_accuracy50: 0.3721 - 16s/epoch - 39ms/step
Epoch 31/50
401/401 - 16s - loss: 3.2160 - accuracy50: 0.3965 - val_loss: 3.2975 - val_accuracy50: 0.3666 - 16s/epoch - 39ms/step
Epoch 32/50
401/401 - 15s - loss: 3.2148 - accuracy50: 0.3955 - val_loss: 3.3031 - val_accuracy50: 0.3643 - 15s/epoch - 39ms/step
Epoch 33/50
401/401 - 16s - loss: 3.2118 - accuracy50: 0.3961 - val_loss: 3.3015 - val_accuracy50: 0.3646 - 16s/epoch - 39ms/step
Epoch 34/50
401/401 - 15s - loss: 3.2088 - accuracy50: 0.3984 - val_loss: 3.3022 - val_accuracy50: 0.3671 - 15s/epoch - 38ms/step
Epoch 35/50
401/401 - 16s - loss: 3.2040 - accuracy50: 0.3995 - val_loss: 3.3084 - val_accuracy50: 0.3659 - 16s/epoch - 39ms/step
testing model: results/CHTR/W7/deepVOL_L3/h50
Evaluating performance on  test set...
1065/1065 - 19s - 19s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0967038
{'0': {'precision': 0.354446685537043, 'recall': 0.2448023974527065, 'f1-score': 0.28959376276631843, 'support': 85424}, '1': {'precision': 0.37928732370858714, 'recall': 0.38167217760982525, 'f1-score': 0.38047601358244953, 'support': 95265}, '2': {'precision': 0.3593016531736853, 'recall': 0.4604210709848964, 'f1-score': 0.4036244136837379, 'support': 91766}, 'accuracy': 0.3652823402029693, 'macro avg': {'precision': 0.36434522080643844, 'recall': 0.3622985486824761, 'f1-score': 0.3578980633441686, 'support': 272455}, 'weighted avg': {'precision': 0.3647675251456252, 'recall': 0.3652823402029693, 'f1-score': 0.3597779558847661, 'support': 272455}}
[[20912 28820 35692]
 [19256 36360 39649]
 [18831 30684 42251]]
Evaluating performance on  train set...
401/401 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0792671
{'0': {'precision': 0.40318302387267907, 'recall': 0.27368894890839524, 'f1-score': 0.3260490682397104, 'support': 35544}, '1': {'precision': 0.38360573155714767, 'recall': 0.4031114901626327, 'f1-score': 0.39311679931167987, 'support': 34003}, '2': {'precision': 0.35728981576732444, 'recall': 0.46190116366933653, 'f1-score': 0.40291601302450664, 'support': 33085}, 'accuracy': 0.377241016447112, 'macro avg': {'precision': 0.38135952373238374, 'recall': 0.3795672009134548, 'f1-score': 0.374027293525299, 'support': 102632}, 'weighted avg': {'precision': 0.3819024928417076, 'recall': 0.377241016447112, 'f1-score': 0.3730485121543292, 'support': 102632}}
[[ 9728 11498 14318]
 [ 7124 13707 13172]
 [ 7276 10527 15282]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0966228
{'0': {'precision': 0.3566612729234088, 'recall': 0.26569563033651433, 'f1-score': 0.30453053940475505, 'support': 9955}, '1': {'precision': 0.36062530532486564, 'recall': 0.3465076980848667, 'f1-score': 0.35342557571695316, 'support': 10652}, '2': {'precision': 0.37319737800437, 'recall': 0.47558938184518285, 'f1-score': 0.41821743388834476, 'support': 10774}, 'accuracy': 0.3651891271788662, 'macro avg': {'precision': 0.36349465208421483, 'recall': 0.3625975700888546, 'f1-score': 0.3587245163366843, 'support': 31381}, 'weighted avg': {'precision': 0.3636841488445902, 'recall': 0.3651891271788662, 'f1-score': 0.3601595036813469, 'support': 31381}}
[[2645 3221 4089]
 [2444 3691 4517]
 [2327 3323 5124]]
training model: results/CHTR/W7/deepVOL_L3/h100
Epoch 1/50
401/401 - 19s - loss: 3.3217 - accuracy100: 0.3603 - val_loss: 3.3765 - val_accuracy100: 0.3216 - 19s/epoch - 47ms/step
Epoch 2/50
401/401 - 16s - loss: 3.3047 - accuracy100: 0.3548 - val_loss: 3.3104 - val_accuracy100: 0.3405 - 16s/epoch - 39ms/step
Epoch 3/50
401/401 - 16s - loss: 3.2964 - accuracy100: 0.3566 - val_loss: 3.3095 - val_accuracy100: 0.3313 - 16s/epoch - 39ms/step
Epoch 4/50
401/401 - 16s - loss: 3.2945 - accuracy100: 0.3530 - val_loss: 3.3056 - val_accuracy100: 0.3347 - 16s/epoch - 39ms/step
Epoch 5/50
401/401 - 16s - loss: 3.2957 - accuracy100: 0.3513 - val_loss: 3.3021 - val_accuracy100: 0.3400 - 16s/epoch - 40ms/step
Epoch 6/50
401/401 - 16s - loss: 3.2947 - accuracy100: 0.3533 - val_loss: 3.3031 - val_accuracy100: 0.3424 - 16s/epoch - 39ms/step
Epoch 7/50
401/401 - 16s - loss: 3.2947 - accuracy100: 0.3535 - val_loss: 3.3029 - val_accuracy100: 0.3432 - 16s/epoch - 40ms/step
Epoch 8/50
401/401 - 15s - loss: 3.2929 - accuracy100: 0.3518 - val_loss: 3.3046 - val_accuracy100: 0.3412 - 15s/epoch - 39ms/step
Epoch 9/50
401/401 - 16s - loss: 3.2923 - accuracy100: 0.3522 - val_loss: 3.3040 - val_accuracy100: 0.3387 - 16s/epoch - 39ms/step
Epoch 10/50
401/401 - 16s - loss: 3.2903 - accuracy100: 0.3538 - val_loss: 3.3010 - val_accuracy100: 0.3433 - 16s/epoch - 39ms/step
Epoch 11/50
401/401 - 16s - loss: 3.2925 - accuracy100: 0.3535 - val_loss: 3.3012 - val_accuracy100: 0.3440 - 16s/epoch - 39ms/step
Epoch 12/50
401/401 - 16s - loss: 3.2938 - accuracy100: 0.3532 - val_loss: 3.3040 - val_accuracy100: 0.3381 - 16s/epoch - 39ms/step
Epoch 13/50
401/401 - 16s - loss: 3.2927 - accuracy100: 0.3519 - val_loss: 3.3020 - val_accuracy100: 0.3421 - 16s/epoch - 39ms/step
Epoch 14/50
401/401 - 15s - loss: 3.2907 - accuracy100: 0.3524 - val_loss: 3.3025 - val_accuracy100: 0.3455 - 15s/epoch - 39ms/step
Epoch 15/50
401/401 - 17s - loss: 3.2893 - accuracy100: 0.3555 - val_loss: 3.3034 - val_accuracy100: 0.3422 - 17s/epoch - 42ms/step
Epoch 16/50
401/401 - 17s - loss: 3.2874 - accuracy100: 0.3584 - val_loss: 3.3023 - val_accuracy100: 0.3478 - 17s/epoch - 42ms/step
Epoch 17/50
401/401 - 17s - loss: 3.2844 - accuracy100: 0.3609 - val_loss: 3.3031 - val_accuracy100: 0.3438 - 17s/epoch - 42ms/step
Epoch 18/50
401/401 - 17s - loss: 3.2821 - accuracy100: 0.3600 - val_loss: 3.3036 - val_accuracy100: 0.3443 - 17s/epoch - 42ms/step
Epoch 19/50
401/401 - 17s - loss: 3.2797 - accuracy100: 0.3634 - val_loss: 3.2999 - val_accuracy100: 0.3444 - 17s/epoch - 42ms/step
Epoch 20/50
401/401 - 16s - loss: 3.2776 - accuracy100: 0.3659 - val_loss: 3.3041 - val_accuracy100: 0.3429 - 16s/epoch - 39ms/step
Epoch 21/50
401/401 - 17s - loss: 3.2756 - accuracy100: 0.3680 - val_loss: 3.3040 - val_accuracy100: 0.3422 - 17s/epoch - 42ms/step
Epoch 22/50
401/401 - 17s - loss: 3.2752 - accuracy100: 0.3630 - val_loss: 3.3054 - val_accuracy100: 0.3433 - 17s/epoch - 41ms/step
Epoch 23/50
401/401 - 17s - loss: 3.2700 - accuracy100: 0.3686 - val_loss: 3.3052 - val_accuracy100: 0.3435 - 17s/epoch - 42ms/step
Epoch 24/50
401/401 - 17s - loss: 3.2652 - accuracy100: 0.3698 - val_loss: 3.3076 - val_accuracy100: 0.3448 - 17s/epoch - 42ms/step
Epoch 25/50
401/401 - 17s - loss: 3.2628 - accuracy100: 0.3703 - val_loss: 3.3098 - val_accuracy100: 0.3384 - 17s/epoch - 42ms/step
Epoch 26/50
401/401 - 17s - loss: 3.2592 - accuracy100: 0.3720 - val_loss: 3.3057 - val_accuracy100: 0.3431 - 17s/epoch - 42ms/step
Epoch 27/50
401/401 - 17s - loss: 3.2573 - accuracy100: 0.3715 - val_loss: 3.3041 - val_accuracy100: 0.3447 - 17s/epoch - 42ms/step
Epoch 28/50
401/401 - 17s - loss: 3.2516 - accuracy100: 0.3733 - val_loss: 3.3055 - val_accuracy100: 0.3469 - 17s/epoch - 42ms/step
Epoch 29/50
401/401 - 17s - loss: 3.2476 - accuracy100: 0.3752 - val_loss: 3.3081 - val_accuracy100: 0.3468 - 17s/epoch - 42ms/step
testing model: results/CHTR/W7/deepVOL_L3/h100
Evaluating performance on  test set...
1065/1065 - 20s - 20s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0975322
{'0': {'precision': 0.32742489270386266, 'recall': 0.08994446998903548, 'f1-score': 0.14112228193009554, 'support': 84819}, '1': {'precision': 0.3582488972555968, 'recall': 0.4133517887563884, 'f1-score': 0.3838327911966226, 'support': 93920}, '2': {'precision': 0.3519309036927601, 'recall': 0.5287037432242093, 'f1-score': 0.422575211615957, 'support': 93716}, 'accuracy': 0.3523480941806904, 'macro avg': {'precision': 0.34586823121740645, 'recall': 0.3440000006565444, 'f1-score': 0.3158434282475584, 'support': 272455}, 'weighted avg': {'precision': 0.3464797672091365, 'recall': 0.3523480941806904, 'f1-score': 0.3215998425869101, 'support': 272455}}
[[ 7629 33382 43808]
 [ 7665 38822 47433]
 [ 8006 36162 49548]]
Evaluating performance on  train set...
401/401 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0963796
{'0': {'precision': 0.3821727588319379, 'recall': 0.10501360715989114, 'f1-score': 0.1647555956599247, 'support': 35643}, '1': {'precision': 0.3464971209213052, 'recall': 0.42758171482709617, 'f1-score': 0.38279262086513993, 'support': 33776}, '2': {'precision': 0.3393799601235388, 'recall': 0.5227471170927047, 'f1-score': 0.411563214848704, 'support': 33213}, 'accuracy': 0.3463539636760465, 'macro avg': {'precision': 0.35601661329226064, 'recall': 0.35178081302656405, 'f1-score': 0.3197038104579229, 'support': 102632}, 'weighted avg': {'precision': 0.35658368749384073, 'recall': 0.3463539636760465, 'f1-score': 0.31638120969305544, 'support': 102632}}
[[ 3743 14396 17504]
 [ 3042 14442 16292]
 [ 3009 12842 17362]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0983218
{'0': {'precision': 0.34634296250768287, 'recall': 0.1155897435897436, 'f1-score': 0.17333128268225162, 'support': 9750}, '1': {'precision': 0.3353898886032562, 'recall': 0.36861932567338485, 'f1-score': 0.3512203876525485, 'support': 10618}, '2': {'precision': 0.36057604666707177, 'recall': 0.5388177608281123, 'f1-score': 0.4320349472151438, 'support': 11013}, 'accuracy': 0.349733915426532, 'macro avg': {'precision': 0.34743629925933694, 'recall': 0.34100894336374693, 'f1-score': 0.3188622058499813, 'support': 31381}, 'weighted avg': {'precision': 0.34763193408698717, 'recall': 0.349733915426532, 'f1-score': 0.32431213014011956, 'support': 31381}}
[[1127 3695 4928]
 [1109 3914 5595]
 [1018 4061 5934]]
training model: results/CHTR/W7/deepVOL_L3/h200
Epoch 1/50
401/401 - 19s - loss: 3.3251 - accuracy200: 0.3561 - val_loss: 3.3661 - val_accuracy200: 0.3156 - 19s/epoch - 46ms/step
Epoch 2/50
401/401 - 16s - loss: 3.3067 - accuracy200: 0.3516 - val_loss: 3.3022 - val_accuracy200: 0.3458 - 16s/epoch - 39ms/step
Epoch 3/50
401/401 - 16s - loss: 3.3013 - accuracy200: 0.3499 - val_loss: 3.2956 - val_accuracy200: 0.3580 - 16s/epoch - 40ms/step
Epoch 4/50
401/401 - 16s - loss: 3.2996 - accuracy200: 0.3494 - val_loss: 3.2940 - val_accuracy200: 0.3577 - 16s/epoch - 40ms/step
Epoch 5/50
401/401 - 16s - loss: 3.2989 - accuracy200: 0.3498 - val_loss: 3.2950 - val_accuracy200: 0.3587 - 16s/epoch - 39ms/step
Epoch 6/50
401/401 - 16s - loss: 3.2983 - accuracy200: 0.3509 - val_loss: 3.2929 - val_accuracy200: 0.3575 - 16s/epoch - 39ms/step
Epoch 7/50
401/401 - 16s - loss: 3.2971 - accuracy200: 0.3532 - val_loss: 3.2959 - val_accuracy200: 0.3569 - 16s/epoch - 39ms/step
Epoch 8/50
401/401 - 16s - loss: 3.2959 - accuracy200: 0.3547 - val_loss: 3.2944 - val_accuracy200: 0.3602 - 16s/epoch - 39ms/step
Epoch 9/50
401/401 - 16s - loss: 3.2961 - accuracy200: 0.3537 - val_loss: 3.2953 - val_accuracy200: 0.3586 - 16s/epoch - 39ms/step
Epoch 10/50
401/401 - 16s - loss: 3.2946 - accuracy200: 0.3550 - val_loss: 3.2976 - val_accuracy200: 0.3533 - 16s/epoch - 39ms/step
Epoch 11/50
401/401 - 16s - loss: 3.2934 - accuracy200: 0.3538 - val_loss: 3.2960 - val_accuracy200: 0.3602 - 16s/epoch - 39ms/step
Epoch 12/50
401/401 - 16s - loss: 3.2911 - accuracy200: 0.3563 - val_loss: 3.2974 - val_accuracy200: 0.3585 - 16s/epoch - 39ms/step
Epoch 13/50
401/401 - 16s - loss: 3.2894 - accuracy200: 0.3564 - val_loss: 3.2970 - val_accuracy200: 0.3598 - 16s/epoch - 39ms/step
Epoch 14/50
401/401 - 16s - loss: 3.2868 - accuracy200: 0.3575 - val_loss: 3.2981 - val_accuracy200: 0.3605 - 16s/epoch - 39ms/step
Epoch 15/50
401/401 - 16s - loss: 3.2843 - accuracy200: 0.3575 - val_loss: 3.2981 - val_accuracy200: 0.3593 - 16s/epoch - 39ms/step
Epoch 16/50
401/401 - 15s - loss: 3.2826 - accuracy200: 0.3589 - val_loss: 3.3023 - val_accuracy200: 0.3538 - 15s/epoch - 38ms/step
testing model: results/CHTR/W7/deepVOL_L3/h200
Evaluating performance on  test set...
1065/1065 - 20s - 20s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.097148
{'0': {'precision': 0.2972027972027972, 'recall': 0.0010341387449205538, 'f1-score': 0.0020611057225994184, 'support': 82194}, '1': {'precision': 0.3637304437815791, 'recall': 0.06332467807747337, 'f1-score': 0.10786950948710079, 'support': 94355}, '2': {'precision': 0.3521987002525983, 'recall': 0.9391696035701624, 'f1-score': 0.5122850122850122, 'support': 95906}, 'accuracy': 0.35283624818777415, 'macro avg': {'precision': 0.3377106470789915, 'recall': 0.3345094734641854, 'f1-score': 0.20740520916490413, 'support': 272455}, 'weighted avg': {'precision': 0.3396011865545624, 'recall': 0.35283624818777415, 'f1-score': 0.21830630555366984, 'support': 272455}}
[[   85  4706 77403]
 [  113  5975 88267]
 [   88  5746 90072]]
Evaluating performance on  train set...
401/401 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1011649
{'0': {'precision': 0.4262295081967213, 'recall': 0.0014683458519229684, 'f1-score': 0.0029266096352994152, 'support': 35414}, '1': {'precision': 0.3932759968725567, 'recall': 0.07429398558430816, 'f1-score': 0.1249782592491366, 'support': 33852}, '2': {'precision': 0.32776361650106645, 'recall': 0.9441647185757958, 'f1-score': 0.48660421220101796, 'support': 33366}, 'accuracy': 0.3319627406656793, 'macro avg': {'precision': 0.38242304052344817, 'recall': 0.33997568333734235, 'f1-score': 0.204836360361818, 'support': 102632}, 'weighted avg': {'precision': 0.3833485820950879, 'recall': 0.3319627406656793, 'f1-score': 0.20042913642943164, 'support': 102632}}
[[   52  2051 33311]
 [   36  2515 31301]
 [   34  1829 31503]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0964168
{'0': {'precision': 0.2413793103448276, 'recall': 0.0007423904974016332, 'f1-score': 0.00148022837809262, 'support': 9429}, '1': {'precision': 0.3435358611238008, 'recall': 0.0699730157253187, 'f1-score': 0.11626468769325912, 'support': 10747}, '2': {'precision': 0.35761067105578986, 'recall': 0.9307452030343597, 'f1-score': 0.516696393182719, 'support': 11205}, 'accuracy': 0.35652146203116536, 'macro avg': {'precision': 0.3141752808414728, 'recall': 0.3338202030856934, 'f1-score': 0.21148043641802358, 'support': 31381}, 'weighted avg': {'precision': 0.3178666386003949, 'recall': 0.35652146203116536, 'f1-score': 0.2247550032704139, 'support': 31381}}
[[    7   676  8746]
 [    7   752  9988]
 [   15   761 10429]]
training model: results/CHTR/W7/deepVOL_L3/h300
Epoch 1/50
401/401 - 18s - loss: 3.3182 - accuracy300: 0.3667 - val_loss: 3.3965 - val_accuracy300: 0.3238 - 18s/epoch - 46ms/step
Epoch 2/50
401/401 - 16s - loss: 3.3048 - accuracy300: 0.3628 - val_loss: 3.3900 - val_accuracy300: 0.3229 - 16s/epoch - 40ms/step
Epoch 3/50
401/401 - 16s - loss: 3.3004 - accuracy300: 0.3621 - val_loss: 3.3016 - val_accuracy300: 0.3421 - 16s/epoch - 41ms/step
Epoch 4/50
401/401 - 16s - loss: 3.3013 - accuracy300: 0.3496 - val_loss: 3.2909 - val_accuracy300: 0.3651 - 16s/epoch - 40ms/step
Epoch 5/50
401/401 - 16s - loss: 3.2980 - accuracy300: 0.3460 - val_loss: 3.2908 - val_accuracy300: 0.3678 - 16s/epoch - 39ms/step
Epoch 6/50
401/401 - 16s - loss: 3.2970 - accuracy300: 0.3489 - val_loss: 3.2902 - val_accuracy300: 0.3678 - 16s/epoch - 41ms/step
Epoch 7/50
401/401 - 16s - loss: 3.2955 - accuracy300: 0.3498 - val_loss: 3.2910 - val_accuracy300: 0.3689 - 16s/epoch - 39ms/step
Epoch 8/50
401/401 - 16s - loss: 3.2950 - accuracy300: 0.3485 - val_loss: 3.2908 - val_accuracy300: 0.3714 - 16s/epoch - 40ms/step
Epoch 9/50
401/401 - 16s - loss: 3.2946 - accuracy300: 0.3475 - val_loss: 3.2906 - val_accuracy300: 0.3704 - 16s/epoch - 39ms/step
Epoch 10/50
401/401 - 16s - loss: 3.2940 - accuracy300: 0.3471 - val_loss: 3.2907 - val_accuracy300: 0.3715 - 16s/epoch - 40ms/step
Epoch 11/50
401/401 - 16s - loss: 3.2925 - accuracy300: 0.3515 - val_loss: 3.2897 - val_accuracy300: 0.3731 - 16s/epoch - 39ms/step
Epoch 12/50
401/401 - 16s - loss: 3.2916 - accuracy300: 0.3518 - val_loss: 3.2908 - val_accuracy300: 0.3722 - 16s/epoch - 39ms/step
Epoch 13/50
401/401 - 16s - loss: 3.2911 - accuracy300: 0.3529 - val_loss: 3.2901 - val_accuracy300: 0.3716 - 16s/epoch - 39ms/step
Epoch 14/50
401/401 - 16s - loss: 3.2901 - accuracy300: 0.3528 - val_loss: 3.2901 - val_accuracy300: 0.3717 - 16s/epoch - 40ms/step
Epoch 15/50
401/401 - 16s - loss: 3.2885 - accuracy300: 0.3554 - val_loss: 3.2904 - val_accuracy300: 0.3726 - 16s/epoch - 40ms/step
Epoch 16/50
401/401 - 16s - loss: 3.2871 - accuracy300: 0.3565 - val_loss: 3.2911 - val_accuracy300: 0.3720 - 16s/epoch - 40ms/step
Epoch 17/50
401/401 - 16s - loss: 3.2846 - accuracy300: 0.3599 - val_loss: 3.2911 - val_accuracy300: 0.3711 - 16s/epoch - 40ms/step
Epoch 18/50
401/401 - 16s - loss: 3.2833 - accuracy300: 0.3603 - val_loss: 3.2901 - val_accuracy300: 0.3710 - 16s/epoch - 39ms/step
Epoch 19/50
401/401 - 16s - loss: 3.2825 - accuracy300: 0.3545 - val_loss: 3.2937 - val_accuracy300: 0.3604 - 16s/epoch - 39ms/step
Epoch 20/50
401/401 - 16s - loss: 3.2825 - accuracy300: 0.3593 - val_loss: 3.2932 - val_accuracy300: 0.3687 - 16s/epoch - 39ms/step
Epoch 21/50
401/401 - 15s - loss: 3.2808 - accuracy300: 0.3582 - val_loss: 3.2936 - val_accuracy300: 0.3704 - 15s/epoch - 39ms/step
testing model: results/CHTR/W7/deepVOL_L3/h300
Evaluating performance on  test set...
1065/1065 - 20s - 20s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0966626
{'0': {'precision': 0.3333333333333333, 'recall': 0.00040443158978381295, 'f1-score': 0.0008078829793745028, 'support': 81596}, '1': {'precision': 0.365599294947121, 'recall': 0.13380425550215572, 'f1-score': 0.19590866516068603, 'support': 93009}, '2': {'precision': 0.36010590980043305, 'recall': 0.8770464997445069, 'f1-score': 0.5105751325238127, 'support': 97850}, 'accuracy': 0.3607825145436861, 'macro avg': {'precision': 0.3530128460269624, 'recall': 0.33708506227881546, 'f1-score': 0.23576389355462443, 'support': 272455}, 'weighted avg': {'precision': 0.3539632407714148, 'recall': 0.3607825145436861, 'f1-score': 0.25048894597262067, 'support': 272455}}
[[   33  9592 71971]
 [   38 12445 80526]
 [   28 12003 85819]]
Evaluating performance on  train set...
401/401 - 9s - 9s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988958
{'0': {'precision': 0.43243243243243246, 'recall': 0.000452821644874625, 'f1-score': 0.0009046959373498063, 'support': 35334}, '1': {'precision': 0.40958301320108964, 'recall': 0.1735065242477143, 'f1-score': 0.2437544165939228, 'support': 33797}, '2': {'precision': 0.3325177280862729, 'recall': 0.8762126503686457, 'f1-score': 0.48208640241749395, 'support': 33501}, 'accuracy': 0.3433042325980201, 'macro avg': {'precision': 0.3915110579065983, 'recall': 0.3500573320870782, 'f1-score': 0.2422485049829222, 'support': 102632}, 'weighted avg': {'precision': 0.3922940318160323, 'recall': 0.3433042325980201, 'f1-score': 0.2379424654227102, 'support': 102632}}
[[   16  4318 31000]
 [    9  5864 27924]
 [   12  4135 29354]]
Evaluating performance on  val set...
123/123 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0950607
{'0': {'precision': 0.42105263157894735, 'recall': 0.0008459342286137253, 'f1-score': 0.0016884761502743773, 'support': 9457}, '1': {'precision': 0.38307724689539047, 'recall': 0.1736641221374046, 'f1-score': 0.2389862779856871, 'support': 10480}, '2': {'precision': 0.37266543910412986, 'recall': 0.8665676336945124, 'f1-score': 0.521193010116936, 'support': 11444}, 'accuracy': 0.37427105573436154, 'macro avg': {'precision': 0.39226510585948926, 'recall': 0.3470258966868436, 'f1-score': 0.2539559214176325, 'support': 31381}, 'weighted avg': {'precision': 0.3907245648453988, 'recall': 0.37427105573436154, 'f1-score': 0.2703889907912865, 'support': 31381}}
[[   8 1410 8039]
 [   5 1820 8655]
 [   6 1521 9917]]
training model: results/CHTR/W7/deepVOL_L3/h500
Epoch 1/50
401/401 - 19s - loss: 3.3180 - accuracy500: 0.3676 - val_loss: 3.3579 - val_accuracy500: 0.3227 - 19s/epoch - 47ms/step
Epoch 2/50
401/401 - 16s - loss: 3.3069 - accuracy500: 0.3681 - val_loss: 3.3527 - val_accuracy500: 0.3156 - 16s/epoch - 41ms/step
Epoch 3/50
401/401 - 16s - loss: 3.3070 - accuracy500: 0.3597 - val_loss: 3.2868 - val_accuracy500: 0.3764 - 16s/epoch - 41ms/step
Epoch 4/50
401/401 - 16s - loss: 3.3013 - accuracy500: 0.3498 - val_loss: 3.2838 - val_accuracy500: 0.3804 - 16s/epoch - 40ms/step
Epoch 5/50
401/401 - 16s - loss: 3.3008 - accuracy500: 0.3470 - val_loss: 3.2813 - val_accuracy500: 0.3816 - 16s/epoch - 39ms/step
Epoch 6/50
401/401 - 16s - loss: 3.2990 - accuracy500: 0.3503 - val_loss: 3.2805 - val_accuracy500: 0.3812 - 16s/epoch - 39ms/step
Epoch 7/50
401/401 - 16s - loss: 3.2983 - accuracy500: 0.3499 - val_loss: 3.2801 - val_accuracy500: 0.3803 - 16s/epoch - 41ms/step
Epoch 8/50
401/401 - 16s - loss: 3.2972 - accuracy500: 0.3493 - val_loss: 3.2802 - val_accuracy500: 0.3805 - 16s/epoch - 40ms/step
Epoch 9/50
401/401 - 16s - loss: 3.2956 - accuracy500: 0.3508 - val_loss: 3.2798 - val_accuracy500: 0.3832 - 16s/epoch - 40ms/step
Epoch 10/50
401/401 - 16s - loss: 3.2944 - accuracy500: 0.3526 - val_loss: 3.2810 - val_accuracy500: 0.3816 - 16s/epoch - 40ms/step
Epoch 11/50
401/401 - 16s - loss: 3.2919 - accuracy500: 0.3543 - val_loss: 3.2819 - val_accuracy500: 0.3824 - 16s/epoch - 40ms/step
Epoch 12/50
401/401 - 16s - loss: 3.2897 - accuracy500: 0.3626 - val_loss: 3.3521 - val_accuracy500: 0.3126 - 16s/epoch - 40ms/step
Epoch 13/50
401/401 - 16s - loss: 3.3008 - accuracy500: 0.3468 - val_loss: 3.2831 - val_accuracy500: 0.3804 - 16s/epoch - 39ms/step
Epoch 14/50
401/401 - 16s - loss: 3.2974 - accuracy500: 0.3442 - val_loss: 3.2817 - val_accuracy500: 0.3807 - 16s/epoch - 39ms/step
Epoch 15/50
401/401 - 16s - loss: 3.2959 - accuracy500: 0.3449 - val_loss: 3.2817 - val_accuracy500: 0.3814 - 16s/epoch - 40ms/step
Epoch 16/50
401/401 - 16s - loss: 3.2942 - accuracy500: 0.3490 - val_loss: 3.2823 - val_accuracy500: 0.3795 - 16s/epoch - 39ms/step
Epoch 17/50
401/401 - 16s - loss: 3.2936 - accuracy500: 0.3490 - val_loss: 3.2821 - val_accuracy500: 0.3800 - 16s/epoch - 39ms/step
Epoch 18/50
401/401 - 16s - loss: 3.2912 - accuracy500: 0.3520 - val_loss: 3.2823 - val_accuracy500: 0.3805 - 16s/epoch - 39ms/step
Epoch 19/50
401/401 - 16s - loss: 3.2897 - accuracy500: 0.3553 - val_loss: 3.2821 - val_accuracy500: 0.3810 - 16s/epoch - 39ms/step
testing model: results/CHTR/W7/deepVOL_L3/h500
Evaluating performance on  test set...
1065/1065 - 23s - 23s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0958388
{'0': {'precision': 0.28087649402390436, 'recall': 0.001761993426889769, 'f1-score': 0.0035020180068301766, 'support': 80023}, '1': {'precision': 0.34833964787162913, 'recall': 0.04995525441063667, 'f1-score': 0.08737945492662473, 'support': 93864}, '2': {'precision': 0.3628352134688888, 'recall': 0.9515258501744989, 'f1-score': 0.5253458802442166, 'support': 98568}, 'accuracy': 0.36196803141803235, 'macro avg': {'precision': 0.3306837851214741, 'recall': 0.3344143660040084, 'f1-score': 0.20540911772589052, 'support': 272455}, 'weighted avg': {'precision': 0.33376914980565203, 'recall': 0.36196803141803235, 'f1-score': 0.2211899941939227, 'support': 272455}}
[[  141  4194 75688]
 [  161  4689 89014]
 [  200  4578 93790]]
Evaluating performance on  train set...
401/401 - 9s - 9s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1025
{'0': {'precision': 0.4469026548672566, 'recall': 0.002890752454277455, 'f1-score': 0.005744348073368406, 'support': 34939}, '1': {'precision': 0.42104296731546087, 'recall': 0.0674967620393265, 'f1-score': 0.11634278755898318, 'support': 33972}, '2': {'precision': 0.3319203795379538, 'recall': 0.9543904391921948, 'f1-score': 0.4925429098338702, 'support': 33721}, 'accuracy': 0.3369027203990958, 'macro avg': {'precision': 0.3999553339068904, 'recall': 0.3415926512285996, 'f1-score': 0.20487668182207394, 'support': 102632}, 'weighted avg': {'precision': 0.4005640605507761, 'recall': 0.3369027203990958, 'f1-score': 0.20229692901626328, 'support': 102632}}
[[  101  1674 33164]
 [   66  2293 31613]
 [   59  1479 32183]]
Evaluating performance on  val set...
123/123 - 3s - 3s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0929577
{'0': {'precision': 0.42105263157894735, 'recall': 0.004214075010535188, 'f1-score': 0.008344633357671848, 'support': 9492}, '1': {'precision': 0.33754607688256977, 'recall': 0.06443506232408525, 'f1-score': 0.108213049717228, 'support': 9948}, '2': {'precision': 0.38425153979650867, 'recall': 0.9456494430952181, 'f1-score': 0.5464576074332173, 'support': 11941}, 'accuracy': 0.3815365985787578, 'macro avg': {'precision': 0.3809500827526753, 'recall': 0.3380995268099462, 'f1-score': 0.22100509683603906, 'support': 31381}, 'weighted avg': {'precision': 0.3805770239471426, 'recall': 0.3815365985787578, 'f1-score': 0.24476469738944112, 'support': 31381}}
[[   40   635  8817]
 [   29   641  9278]
 [   26   623 11292]]
training model: results/CHTR/W7/deepVOL_L3/h1000
Epoch 1/50
401/401 - 19s - loss: 3.3283 - accuracy1000: 0.3644 - val_loss: 3.3934 - val_accuracy1000: 0.3073 - 19s/epoch - 47ms/step
Epoch 2/50
401/401 - 16s - loss: 3.3097 - accuracy1000: 0.3629 - val_loss: 3.3567 - val_accuracy1000: 0.3093 - 16s/epoch - 39ms/step
Epoch 3/50
401/401 - 16s - loss: 3.2995 - accuracy1000: 0.3619 - val_loss: 3.2987 - val_accuracy1000: 0.3886 - 16s/epoch - 40ms/step
Epoch 4/50
401/401 - 16s - loss: 3.3043 - accuracy1000: 0.3494 - val_loss: 3.2967 - val_accuracy1000: 0.3891 - 16s/epoch - 39ms/step
Epoch 5/50
401/401 - 16s - loss: 3.3047 - accuracy1000: 0.3464 - val_loss: 3.2929 - val_accuracy1000: 0.3897 - 16s/epoch - 39ms/step
Epoch 6/50
401/401 - 16s - loss: 3.3047 - accuracy1000: 0.3424 - val_loss: 3.2887 - val_accuracy1000: 0.3902 - 16s/epoch - 39ms/step
Epoch 7/50
401/401 - 16s - loss: 3.3027 - accuracy1000: 0.3424 - val_loss: 3.2836 - val_accuracy1000: 0.3907 - 16s/epoch - 39ms/step
Epoch 8/50
401/401 - 16s - loss: 3.3018 - accuracy1000: 0.3399 - val_loss: 3.2838 - val_accuracy1000: 0.3903 - 16s/epoch - 39ms/step
Epoch 9/50
401/401 - 16s - loss: 3.3003 - accuracy1000: 0.3384 - val_loss: 3.2819 - val_accuracy1000: 0.3923 - 16s/epoch - 40ms/step
Epoch 10/50
401/401 - 16s - loss: 3.2995 - accuracy1000: 0.3394 - val_loss: 3.2831 - val_accuracy1000: 0.3926 - 16s/epoch - 39ms/step
Epoch 11/50
401/401 - 16s - loss: 3.2991 - accuracy1000: 0.3383 - val_loss: 3.2844 - val_accuracy1000: 0.3919 - 16s/epoch - 39ms/step
Epoch 12/50
401/401 - 16s - loss: 3.2982 - accuracy1000: 0.3402 - val_loss: 3.2850 - val_accuracy1000: 0.3931 - 16s/epoch - 39ms/step
Epoch 13/50
401/401 - 15s - loss: 3.2972 - accuracy1000: 0.3446 - val_loss: 3.2842 - val_accuracy1000: 0.3919 - 15s/epoch - 39ms/step
Epoch 14/50
401/401 - 16s - loss: 3.2961 - accuracy1000: 0.3454 - val_loss: 3.2847 - val_accuracy1000: 0.3932 - 16s/epoch - 39ms/step
Epoch 15/50
401/401 - 16s - loss: 3.2957 - accuracy1000: 0.3482 - val_loss: 3.2857 - val_accuracy1000: 0.3908 - 16s/epoch - 39ms/step
Epoch 16/50
401/401 - 16s - loss: 3.2942 - accuracy1000: 0.3501 - val_loss: 3.2867 - val_accuracy1000: 0.3899 - 16s/epoch - 39ms/step
Epoch 17/50
401/401 - 16s - loss: 3.2939 - accuracy1000: 0.3503 - val_loss: 3.2871 - val_accuracy1000: 0.3885 - 16s/epoch - 40ms/step
Epoch 18/50
401/401 - 16s - loss: 3.2929 - accuracy1000: 0.3499 - val_loss: 3.2874 - val_accuracy1000: 0.3892 - 16s/epoch - 39ms/step
Epoch 19/50
401/401 - 15s - loss: 3.2911 - accuracy1000: 0.3514 - val_loss: 3.2898 - val_accuracy1000: 0.3844 - 15s/epoch - 39ms/step
testing model: results/CHTR/W7/deepVOL_L3/h1000
Evaluating performance on  test set...
1065/1065 - 19s - 19s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.092041
{'0': {'precision': 0.08695652173913043, 'recall': 5.248104122385788e-05, 'f1-score': 0.00010489877268435958, 'support': 76218}, '1': {'precision': 0.44587628865979384, 'recall': 0.039913168409241064, 'f1-score': 0.07326768887220506, 'support': 95357}, '2': {'precision': 0.37184933661268865, 'recall': 0.9726506740681998, 'f1-score': 0.5380133953661793, 'support': 100880}, 'accuracy': 0.3741204969628012, 'macro avg': {'precision': 0.3015607156705376, 'recall': 0.33753877450622155, 'f1-score': 0.20379532767035624, 'support': 272455}, 'weighted avg': {'precision': 0.3180607385040944, 'recall': 0.3741204969628012, 'f1-score': 0.22487887360108455, 'support': 272455}}
[[    4  1991 74223]
 [   22  3806 91529]
 [   20  2739 98121]]
Evaluating performance on  train set...
401/401 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1075327
{'0': {'precision': 0.4375, 'recall': 0.0001956728350198468, 'f1-score': 0.0003911707180776753, 'support': 35774}, '1': {'precision': 0.40289581366068616, 'recall': 0.037738074178902056, 'f1-score': 0.06901199622590645, 'support': 33918}, '2': {'precision': 0.32325345186496246, 'recall': 0.9758348512446873, 'f1-score': 0.4856359392350751, 'support': 32940}, 'accuracy': 0.325736612362616, 'macro avg': {'precision': 0.3878830885085495, 'recall': 0.33792286608620303, 'f1-score': 0.18501303539301972, 'support': 102632}, 'weighted avg': {'precision': 0.3893962303392219, 'recall': 0.325736612362616, 'f1-score': 0.17880963508128245, 'support': 102632}}
[[    7  1105 34662]
 [    5  1280 32633]
 [    4   792 32144]]
Evaluating performance on  val set...
123/123 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0935986
{'0': {'precision': 0.3333333333333333, 'recall': 0.0003100454733360893, 'f1-score': 0.000619514713474445, 'support': 9676}, '1': {'precision': 0.33416046319272125, 'recall': 0.04267455371289743, 'f1-score': 0.07568377669539153, 'support': 9467}, '2': {'precision': 0.3929648907602029, 'recall': 0.9685406112109822, 'f1-score': 0.5590905874861442, 'support': 12238}, 'accuracy': 0.3906822599662216, 'macro avg': {'precision': 0.3534862290954191, 'recall': 0.3371750701324052, 'f1-score': 0.21179795963167003, 'support': 31381}, 'weighted avg': {'precision': 0.356838047592562, 'recall': 0.3906822599662216, 'f1-score': 0.24105807169938123, 'support': 31381}}
[[    3   423  9250]
 [    3   404  9060]
 [    3   382 11853]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        17 (peak)  11.38 (ave)

============================================
