This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/LILAK_orderbooks/LILAK_orderbooks_2020-01-22.csv
data/LILAK_orderbooks/LILAK_orderbooks_2020-01-14.csv
data/LILAK_orderbooks/LILAK_orderbooks_2020-01-02.csv
data/LILAK_orderbooks/LILAK_orderbooks_2020-01-10.csv
data/LILAK_orderbooks/LILAK_orderbooks_2020-01-06.csv
data/LILAK_orderbooks/LILAK_orderbooks_2020-01-08.csv
data/LILAK_orderbooks/LILAK_orderbooks_2020-01-03.csv
data/LILAK_orderbooks/LILAK_orderbooks_2020-01-24.csv
data/LILAK_orderbooks/LILAK_orderbooks_2020-01-07.csv
data/LILAK_orderbooks/LILAK_orderbooks_2020-01-09.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-12-31.csv
data/LILAK_orderbooks/LILAK_orderbooks_2020-01-16.csv
data/LILAK_orderbooks/LILAK_orderbooks_2020-01-15.csv
training model: results/LILAK/W10/deepLOB_L1/h10
Epoch 1/50
135/135 - 31s - loss: 3.3652 - accuracy10: 0.3487 - val_loss: 3.3842 - val_accuracy10: 0.3451 - 31s/epoch - 230ms/step
Epoch 2/50
135/135 - 4s - loss: 3.2972 - accuracy10: 0.3744 - val_loss: 3.2811 - val_accuracy10: 0.3753 - 4s/epoch - 28ms/step
Epoch 3/50
135/135 - 4s - loss: 3.2481 - accuracy10: 0.3975 - val_loss: 3.2713 - val_accuracy10: 0.3832 - 4s/epoch - 28ms/step
Epoch 4/50
135/135 - 4s - loss: 3.2271 - accuracy10: 0.4114 - val_loss: 3.2666 - val_accuracy10: 0.4037 - 4s/epoch - 28ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2075 - accuracy10: 0.4182 - val_loss: 3.2840 - val_accuracy10: 0.3957 - 4s/epoch - 27ms/step
Epoch 6/50
135/135 - 4s - loss: 3.1781 - accuracy10: 0.4341 - val_loss: 3.2278 - val_accuracy10: 0.4270 - 4s/epoch - 28ms/step
Epoch 7/50
135/135 - 4s - loss: 3.1500 - accuracy10: 0.4456 - val_loss: 3.2093 - val_accuracy10: 0.4304 - 4s/epoch - 28ms/step
Epoch 8/50
135/135 - 4s - loss: 3.1274 - accuracy10: 0.4592 - val_loss: 3.2043 - val_accuracy10: 0.4255 - 4s/epoch - 28ms/step
Epoch 9/50
135/135 - 4s - loss: 3.1063 - accuracy10: 0.4664 - val_loss: 3.1945 - val_accuracy10: 0.4330 - 4s/epoch - 28ms/step
Epoch 10/50
135/135 - 4s - loss: 3.0963 - accuracy10: 0.4717 - val_loss: 3.1842 - val_accuracy10: 0.4431 - 4s/epoch - 28ms/step
Epoch 11/50
135/135 - 4s - loss: 3.0772 - accuracy10: 0.4760 - val_loss: 3.1677 - val_accuracy10: 0.4441 - 4s/epoch - 28ms/step
Epoch 12/50
135/135 - 4s - loss: 3.0654 - accuracy10: 0.4788 - val_loss: 3.1764 - val_accuracy10: 0.4402 - 4s/epoch - 27ms/step
Epoch 13/50
135/135 - 4s - loss: 3.0426 - accuracy10: 0.4869 - val_loss: 3.1647 - val_accuracy10: 0.4487 - 4s/epoch - 28ms/step
Epoch 14/50
135/135 - 4s - loss: 3.0296 - accuracy10: 0.4911 - val_loss: 3.1463 - val_accuracy10: 0.4516 - 4s/epoch - 28ms/step
Epoch 15/50
135/135 - 4s - loss: 3.0204 - accuracy10: 0.4965 - val_loss: 3.1592 - val_accuracy10: 0.4550 - 4s/epoch - 27ms/step
Epoch 16/50
135/135 - 4s - loss: 3.0103 - accuracy10: 0.4962 - val_loss: 3.1818 - val_accuracy10: 0.4373 - 4s/epoch - 27ms/step
Epoch 17/50
135/135 - 4s - loss: 2.9990 - accuracy10: 0.5011 - val_loss: 3.1643 - val_accuracy10: 0.4528 - 4s/epoch - 28ms/step
Epoch 18/50
135/135 - 4s - loss: 2.9853 - accuracy10: 0.5038 - val_loss: 3.1910 - val_accuracy10: 0.4397 - 4s/epoch - 28ms/step
Epoch 19/50
135/135 - 4s - loss: 2.9843 - accuracy10: 0.5065 - val_loss: 3.1901 - val_accuracy10: 0.4454 - 4s/epoch - 28ms/step
Epoch 20/50
135/135 - 4s - loss: 2.9777 - accuracy10: 0.5072 - val_loss: 3.1550 - val_accuracy10: 0.4566 - 4s/epoch - 27ms/step
Epoch 21/50
135/135 - 4s - loss: 2.9770 - accuracy10: 0.5097 - val_loss: 3.2030 - val_accuracy10: 0.4358 - 4s/epoch - 28ms/step
Epoch 22/50
135/135 - 4s - loss: 2.9583 - accuracy10: 0.5136 - val_loss: 3.1871 - val_accuracy10: 0.4426 - 4s/epoch - 28ms/step
Epoch 23/50
135/135 - 4s - loss: 2.9564 - accuracy10: 0.5123 - val_loss: 3.1834 - val_accuracy10: 0.4418 - 4s/epoch - 28ms/step
Epoch 24/50
135/135 - 4s - loss: 2.9370 - accuracy10: 0.5186 - val_loss: 3.1674 - val_accuracy10: 0.4515 - 4s/epoch - 27ms/step
testing model: results/LILAK/W10/deepLOB_L1/h10
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0589036
{'0': {'precision': 0.5235818122199147, 'recall': 0.3767697026899481, 'f1-score': 0.4382061016328957, 'support': 50856}, '1': {'precision': 0.3342648517082845, 'recall': 0.4243169789729652, 'f1-score': 0.3739458192040541, 'support': 34955}, '2': {'precision': 0.4681073544789125, 'recall': 0.5165494989209171, 'f1-score': 0.49113682307168754, 'support': 46799}, 'accuracy': 0.43863207902873086, 'macro avg': {'precision': 0.4419846728023706, 'recall': 0.4392120601946101, 'f1-score': 0.4344295813028791, 'support': 132610}, 'weighted avg': {'precision': 0.45410195774057527, 'recall': 0.43863207902873086, 'f1-score': 0.4399471970277668, 'support': 132610}}
[[19161 16536 15159]
 [ 7814 14832 12309]
 [ 9621 13004 24174]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.027262
{'0': {'precision': 0.48653846153846153, 'recall': 0.4094955489614243, 'f1-score': 0.4447048483960744, 'support': 11121}, '1': {'precision': 0.43845896147403685, 'recall': 0.5683022145028224, 'f1-score': 0.4950075642965203, 'support': 11515}, '2': {'precision': 0.5079697150826858, 'recall': 0.43629673996748525, 'f1-score': 0.46941311852704254, 'support': 11687}, 'accuracy': 0.47189930950091774, 'macro avg': {'precision': 0.47765571269839474, 'recall': 0.47136483447724403, 'f1-score': 0.4697085104065457, 'support': 34323}, 'weighted avg': {'precision': 0.4777056560415499, 'recall': 0.47189930950091774, 'f1-score': 0.4699940517470128, 'support': 34323}}
[[4554 4145 2422]
 [2454 6544 2517]
 [2352 4236 5099]]
Evaluating performance on  val set...
46/46 - 1s - 603ms/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0480176
{'0': {'precision': 0.4719504240052185, 'recall': 0.382399577167019, 'f1-score': 0.4224817518248175, 'support': 3784}, '1': {'precision': 0.42558425584255843, 'recall': 0.5923208608461726, 'f1-score': 0.49529652351738246, 'support': 4089}, '2': {'precision': 0.49264957264957265, 'recall': 0.37831451824625884, 'f1-score': 0.427977427977428, 'support': 3809}, 'accuracy': 0.45454545454545453, 'macro avg': {'precision': 0.4633947508324499, 'recall': 0.45101165208648347, 'f1-score': 0.44858523443987597, 'support': 11682}, 'weighted avg': {'precision': 0.4624701805168799, 'recall': 0.45454545454545453, 'f1-score': 0.4497606965188931, 'support': 11682}}
[[1447 1636  701]
 [ 884 2422  783]
 [ 735 1633 1441]]
training model: results/LILAK/W10/deepLOB_L1/h20
Epoch 1/50
135/135 - 6s - loss: 3.3667 - accuracy20: 0.3476 - val_loss: 3.3869 - val_accuracy20: 0.3485 - 6s/epoch - 45ms/step
Epoch 2/50
135/135 - 4s - loss: 3.2981 - accuracy20: 0.3749 - val_loss: 3.3273 - val_accuracy20: 0.3628 - 4s/epoch - 28ms/step
Epoch 3/50
135/135 - 4s - loss: 3.2828 - accuracy20: 0.3822 - val_loss: 3.3367 - val_accuracy20: 0.3583 - 4s/epoch - 27ms/step
Epoch 4/50
135/135 - 4s - loss: 3.2596 - accuracy20: 0.3929 - val_loss: 3.3549 - val_accuracy20: 0.3630 - 4s/epoch - 27ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2400 - accuracy20: 0.4049 - val_loss: 3.3106 - val_accuracy20: 0.3712 - 4s/epoch - 28ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2213 - accuracy20: 0.4135 - val_loss: 3.3389 - val_accuracy20: 0.3567 - 4s/epoch - 27ms/step
Epoch 7/50
135/135 - 4s - loss: 3.2131 - accuracy20: 0.4152 - val_loss: 3.3342 - val_accuracy20: 0.3717 - 4s/epoch - 27ms/step
Epoch 8/50
135/135 - 4s - loss: 3.2023 - accuracy20: 0.4221 - val_loss: 3.3022 - val_accuracy20: 0.3788 - 4s/epoch - 28ms/step
Epoch 9/50
135/135 - 4s - loss: 3.1860 - accuracy20: 0.4297 - val_loss: 3.3203 - val_accuracy20: 0.3749 - 4s/epoch - 27ms/step
Epoch 10/50
135/135 - 4s - loss: 3.1798 - accuracy20: 0.4325 - val_loss: 3.3208 - val_accuracy20: 0.3805 - 4s/epoch - 27ms/step
Epoch 11/50
135/135 - 4s - loss: 3.1726 - accuracy20: 0.4361 - val_loss: 3.2941 - val_accuracy20: 0.3806 - 4s/epoch - 29ms/step
Epoch 12/50
135/135 - 4s - loss: 3.1610 - accuracy20: 0.4412 - val_loss: 3.3140 - val_accuracy20: 0.3749 - 4s/epoch - 27ms/step
Epoch 13/50
135/135 - 4s - loss: 3.1539 - accuracy20: 0.4439 - val_loss: 3.3130 - val_accuracy20: 0.3802 - 4s/epoch - 28ms/step
Epoch 14/50
135/135 - 4s - loss: 3.1441 - accuracy20: 0.4453 - val_loss: 3.3012 - val_accuracy20: 0.3813 - 4s/epoch - 28ms/step
Epoch 15/50
135/135 - 4s - loss: 3.1345 - accuracy20: 0.4548 - val_loss: 3.3104 - val_accuracy20: 0.3841 - 4s/epoch - 28ms/step
Epoch 16/50
135/135 - 4s - loss: 3.1271 - accuracy20: 0.4584 - val_loss: 3.3139 - val_accuracy20: 0.3936 - 4s/epoch - 27ms/step
Epoch 17/50
135/135 - 4s - loss: 3.1168 - accuracy20: 0.4592 - val_loss: 3.3099 - val_accuracy20: 0.3842 - 4s/epoch - 28ms/step
Epoch 18/50
135/135 - 4s - loss: 3.1126 - accuracy20: 0.4620 - val_loss: 3.3032 - val_accuracy20: 0.3861 - 4s/epoch - 28ms/step
Epoch 19/50
135/135 - 4s - loss: 3.1041 - accuracy20: 0.4646 - val_loss: 3.3352 - val_accuracy20: 0.3911 - 4s/epoch - 27ms/step
Epoch 20/50
135/135 - 4s - loss: 3.0972 - accuracy20: 0.4648 - val_loss: 3.3166 - val_accuracy20: 0.3794 - 4s/epoch - 27ms/step
Epoch 21/50
135/135 - 4s - loss: 3.0945 - accuracy20: 0.4663 - val_loss: 3.3272 - val_accuracy20: 0.3801 - 4s/epoch - 28ms/step
testing model: results/LILAK/W10/deepLOB_L1/h20
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1200906
{'0': {'precision': 0.4754973622322507, 'recall': 0.13988406881077037, 'f1-score': 0.21617326224842154, 'support': 53480}, '1': {'precision': 0.2143215208421702, 'recall': 0.18629126864420983, 'f1-score': 0.1993257782240712, 'support': 29835}, '2': {'precision': 0.3859737860661506, 'recall': 0.7120803326909423, 'f1-score': 0.500602542801931, 'support': 49295}, 'accuracy': 0.3630269210466782, 'macro avg': {'precision': 0.3585975563801906, 'recall': 0.34608522338197417, 'f1-score': 0.3053671944248079, 'support': 132610}, 'weighted avg': {'precision': 0.3834587081716146, 'recall': 0.3630269210466782, 'f1-score': 0.31811351335330623, 'support': 132610}}
[[ 7481 11241 34758]
 [ 3193  5558 21084]
 [ 5059  9134 35102]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0838885
{'0': {'precision': 0.4604694835680751, 'recall': 0.21469223360476317, 'f1-score': 0.2928460527887257, 'support': 11421}, '1': {'precision': 0.3789156160569263, 'recall': 0.42902180576232596, 'f1-score': 0.4024149827501232, 'support': 11419}, '2': {'precision': 0.3913746966208227, 'recall': 0.547679177915179, 'f1-score': 0.45651858304297327, 'support': 11483}, 'accuracy': 0.39740115957229843, 'macro avg': {'precision': 0.4102532654152747, 'recall': 0.3971310724274227, 'f1-score': 0.383926539527274, 'support': 34323}, 'weighted avg': {'precision': 0.41022098979931626, 'recall': 0.39740115957229843, 'f1-score': 0.3840565902166523, 'support': 34323}}
[[2452 4174 4795]
 [1535 4899 4985]
 [1338 3856 6289]]
Evaluating performance on  val set...
46/46 - 1s - 587ms/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0971336
{'0': {'precision': 0.4664804469273743, 'recall': 0.20895895895895897, 'f1-score': 0.28862772208779813, 'support': 3996}, '1': {'precision': 0.34744923229321445, 'recall': 0.3735356762513312, 'f1-score': 0.3600205286117526, 'support': 3756}, '2': {'precision': 0.3874274000683294, 'recall': 0.5770992366412214, 'f1-score': 0.46361406377759606, 'support': 3930}, 'accuracy': 0.3857216230097586, 'macro avg': {'precision': 0.4004523597629727, 'recall': 0.3865312906171705, 'f1-score': 0.37075410482571564, 'support': 11682}, 'weighted avg': {'precision': 0.40161486600613217, 'recall': 0.3857216230097586, 'f1-score': 0.3704499874657196, 'support': 11682}}
[[ 835 1374 1787]
 [ 554 1403 1799]
 [ 401 1261 2268]]
training model: results/LILAK/W10/deepLOB_L1/h30
Epoch 1/50
135/135 - 6s - loss: 3.3675 - accuracy30: 0.3465 - val_loss: 3.4034 - val_accuracy30: 0.3466 - 6s/epoch - 47ms/step
Epoch 2/50
135/135 - 4s - loss: 3.3180 - accuracy30: 0.3624 - val_loss: 3.3225 - val_accuracy30: 0.3624 - 4s/epoch - 28ms/step
Epoch 3/50
135/135 - 4s - loss: 3.3060 - accuracy30: 0.3703 - val_loss: 3.3061 - val_accuracy30: 0.3716 - 4s/epoch - 28ms/step
Epoch 4/50
135/135 - 4s - loss: 3.2803 - accuracy30: 0.3801 - val_loss: 3.2973 - val_accuracy30: 0.3761 - 4s/epoch - 28ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2515 - accuracy30: 0.3997 - val_loss: 3.2909 - val_accuracy30: 0.3852 - 4s/epoch - 28ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2392 - accuracy30: 0.4042 - val_loss: 3.2812 - val_accuracy30: 0.3903 - 4s/epoch - 28ms/step
Epoch 7/50
135/135 - 4s - loss: 3.2238 - accuracy30: 0.4142 - val_loss: 3.2977 - val_accuracy30: 0.3841 - 4s/epoch - 27ms/step
Epoch 8/50
135/135 - 4s - loss: 3.2125 - accuracy30: 0.4196 - val_loss: 3.3034 - val_accuracy30: 0.3852 - 4s/epoch - 28ms/step
Epoch 9/50
135/135 - 4s - loss: 3.1979 - accuracy30: 0.4270 - val_loss: 3.3439 - val_accuracy30: 0.3715 - 4s/epoch - 28ms/step
Epoch 10/50
135/135 - 4s - loss: 3.1902 - accuracy30: 0.4277 - val_loss: 3.3256 - val_accuracy30: 0.3774 - 4s/epoch - 28ms/step
Epoch 11/50
135/135 - 4s - loss: 3.1843 - accuracy30: 0.4310 - val_loss: 3.2876 - val_accuracy30: 0.3853 - 4s/epoch - 27ms/step
Epoch 12/50
135/135 - 4s - loss: 3.1770 - accuracy30: 0.4342 - val_loss: 3.3252 - val_accuracy30: 0.3796 - 4s/epoch - 27ms/step
Epoch 13/50
135/135 - 4s - loss: 3.1698 - accuracy30: 0.4384 - val_loss: 3.2961 - val_accuracy30: 0.3872 - 4s/epoch - 27ms/step
Epoch 14/50
135/135 - 4s - loss: 3.1661 - accuracy30: 0.4404 - val_loss: 3.3283 - val_accuracy30: 0.3779 - 4s/epoch - 28ms/step
Epoch 15/50
135/135 - 4s - loss: 3.1605 - accuracy30: 0.4403 - val_loss: 3.3352 - val_accuracy30: 0.3784 - 4s/epoch - 28ms/step
Epoch 16/50
135/135 - 4s - loss: 3.1556 - accuracy30: 0.4439 - val_loss: 3.3569 - val_accuracy30: 0.3735 - 4s/epoch - 28ms/step
testing model: results/LILAK/W10/deepLOB_L1/h30
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0996128
{'0': {'precision': 0.44074089352749474, 'recall': 0.4136435789229161, 'f1-score': 0.4267625324545636, 'support': 51658}, '1': {'precision': 0.2650589610113673, 'recall': 0.22714168664461507, 'f1-score': 0.24463982219898026, 'support': 32953}, '2': {'precision': 0.40235108876523107, 'recall': 0.46848892685264276, 'f1-score': 0.4329085168643154, 'support': 47999}, 'accuracy': 0.3871502903250132, 'macro avg': {'precision': 0.369383647768031, 'recall': 0.36975806414005796, 'f1-score': 0.36810362383928635, 'support': 132610}, 'weighted avg': {'precision': 0.3831892838375178, 'recall': 0.3871502903250132, 'f1-score': 0.38373041899880184, 'support': 132610}}
[[21368 10818 19472]
 [11538  7485 13930]
 [15576  9936 22487]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0864727
{'0': {'precision': 0.4064769527197273, 'recall': 0.4790393013100437, 'f1-score': 0.43978511866581144, 'support': 11450}, '1': {'precision': 0.3484914735461303, 'recall': 0.2099762887503293, 'f1-score': 0.2620561157387111, 'support': 11387}, '2': {'precision': 0.39819587628865977, 'recall': 0.4842416855302107, 'f1-score': 0.4370236505067966, 'support': 11486}, 'accuracy': 0.39151589313288465, 'macro avg': {'precision': 0.38438810085150577, 'recall': 0.39108575853019456, 'f1-score': 0.37962162830377305, 'support': 34323}, 'weighted avg': {'precision': 0.3844684716651286, 'recall': 0.39151589313288465, 'f1-score': 0.3798976269079425, 'support': 34323}}
[[5485 2248 3717]
 [4307 2391 4689]
 [3702 2222 5562]]
Evaluating performance on  val set...
46/46 - 1s - 566ms/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0942708
{'0': {'precision': 0.40208728652751424, 'recall': 0.5290886392009988, 'f1-score': 0.45692722371967653, 'support': 4005}, '1': {'precision': 0.342798353909465, 'recall': 0.2188074599422117, 'f1-score': 0.26711560044893373, 'support': 3807}, '2': {'precision': 0.40431943746860877, 'recall': 0.4160206718346253, 'f1-score': 0.41008660213958226, 'support': 3870}, 'accuracy': 0.39051532271871253, 'macro avg': {'precision': 0.38306835930186267, 'recall': 0.3879722569926119, 'f1-score': 0.3780431421027308, 'support': 11682}, 'weighted avg': {'precision': 0.38350531919872827, 'recall': 0.39051532271871253, 'f1-score': 0.37955296800090554, 'support': 11682}}
[[2119  802 1084]
 [1686  833 1288]
 [1465  795 1610]]
training model: results/LILAK/W10/deepLOB_L1/h50
Epoch 1/50
135/135 - 6s - loss: 3.3688 - accuracy50: 0.3502 - val_loss: 3.4660 - val_accuracy50: 0.3469 - 6s/epoch - 44ms/step
Epoch 2/50
135/135 - 4s - loss: 3.3253 - accuracy50: 0.3635 - val_loss: 3.3953 - val_accuracy50: 0.3508 - 4s/epoch - 28ms/step
Epoch 3/50
135/135 - 4s - loss: 3.3060 - accuracy50: 0.3673 - val_loss: 3.3329 - val_accuracy50: 0.3603 - 4s/epoch - 28ms/step
Epoch 4/50
135/135 - 4s - loss: 3.2945 - accuracy50: 0.3773 - val_loss: 3.3208 - val_accuracy50: 0.3683 - 4s/epoch - 30ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2819 - accuracy50: 0.3797 - val_loss: 3.3206 - val_accuracy50: 0.3640 - 4s/epoch - 27ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2679 - accuracy50: 0.3869 - val_loss: 3.3303 - val_accuracy50: 0.3652 - 4s/epoch - 27ms/step
Epoch 7/50
135/135 - 4s - loss: 3.2555 - accuracy50: 0.3983 - val_loss: 3.3348 - val_accuracy50: 0.3597 - 4s/epoch - 28ms/step
Epoch 8/50
135/135 - 4s - loss: 3.2484 - accuracy50: 0.3985 - val_loss: 3.3102 - val_accuracy50: 0.3686 - 4s/epoch - 28ms/step
Epoch 9/50
135/135 - 4s - loss: 3.2340 - accuracy50: 0.4098 - val_loss: 3.3293 - val_accuracy50: 0.3677 - 4s/epoch - 27ms/step
Epoch 10/50
135/135 - 4s - loss: 3.2256 - accuracy50: 0.4104 - val_loss: 3.3302 - val_accuracy50: 0.3660 - 4s/epoch - 27ms/step
Epoch 11/50
135/135 - 4s - loss: 3.2223 - accuracy50: 0.4152 - val_loss: 3.3132 - val_accuracy50: 0.3719 - 4s/epoch - 28ms/step
Epoch 12/50
135/135 - 4s - loss: 3.2073 - accuracy50: 0.4195 - val_loss: 3.3365 - val_accuracy50: 0.3657 - 4s/epoch - 27ms/step
Epoch 13/50
135/135 - 4s - loss: 3.2030 - accuracy50: 0.4223 - val_loss: 3.3142 - val_accuracy50: 0.3743 - 4s/epoch - 28ms/step
Epoch 14/50
135/135 - 4s - loss: 3.1925 - accuracy50: 0.4287 - val_loss: 3.3163 - val_accuracy50: 0.3721 - 4s/epoch - 28ms/step
Epoch 15/50
135/135 - 4s - loss: 3.1892 - accuracy50: 0.4306 - val_loss: 3.3213 - val_accuracy50: 0.3682 - 4s/epoch - 28ms/step
Epoch 16/50
135/135 - 4s - loss: 3.1870 - accuracy50: 0.4309 - val_loss: 3.3393 - val_accuracy50: 0.3713 - 4s/epoch - 28ms/step
Epoch 17/50
135/135 - 4s - loss: 3.1802 - accuracy50: 0.4363 - val_loss: 3.3634 - val_accuracy50: 0.3689 - 4s/epoch - 28ms/step
Epoch 18/50
135/135 - 4s - loss: 3.1741 - accuracy50: 0.4376 - val_loss: 3.3623 - val_accuracy50: 0.3657 - 4s/epoch - 28ms/step
testing model: results/LILAK/W10/deepLOB_L1/h50
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1222516
{'0': {'precision': 0.48449167145318783, 'recall': 0.09803010052879307, 'f1-score': 0.1630660673722875, 'support': 51627}, '1': {'precision': 0.24285199113904488, 'recall': 0.14326961067379873, 'f1-score': 0.1802194441258554, 'support': 32903}, '2': {'precision': 0.37527858067404357, 'recall': 0.8020174708818636, 'f1-score': 0.5113072073087453, 'support': 48080}, 'accuracy': 0.3644973983862454, 'macro avg': {'precision': 0.3675407477554254, 'recall': 0.3477723940281518, 'f1-score': 0.28486423960229607, 'support': 132610}, 'weighted avg': {'precision': 0.3849393314634623, 'recall': 0.3644973983862454, 'f1-score': 0.29358285768574455, 'support': 132610}}
[[ 5061  8079 38487]
 [ 2484  4714 25705]
 [ 2901  6618 38561]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0935533
{'0': {'precision': 0.427069800401559, 'recall': 0.312829829570032, 'f1-score': 0.3611305303105962, 'support': 11559}, '1': {'precision': 0.3514719000892061, 'recall': 0.2128195894850558, 'f1-score': 0.2651115846136593, 'support': 11108}, '2': {'precision': 0.3756926293779404, 'recall': 0.61659231297186, 'f1-score': 0.46690053920613267, 'support': 11656}, 'accuracy': 0.3836203129097107, 'macro avg': {'precision': 0.3847447766229018, 'recall': 0.3807472440089826, 'f1-score': 0.36438088471012936, 'support': 34323}, 'weighted avg': {'precision': 0.3851563959170759, 'recall': 0.3836203129097107, 'f1-score': 0.3659750012159599, 'support': 34323}}
[[3616 2207 5736]
 [2537 2364 6207]
 [2314 2155 7187]]
Evaluating performance on  val set...
46/46 - 1s - 581ms/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.100794
{'0': {'precision': 0.41664117467115325, 'recall': 0.34058514628657166, 'f1-score': 0.3747936158503027, 'support': 3999}, '1': {'precision': 0.3286595625350533, 'recall': 0.15543766578249338, 'f1-score': 0.21105708625967948, 'support': 3770}, '2': {'precision': 0.36380090497737555, 'recall': 0.6164068489649885, 'f1-score': 0.4575547756805463, 'support': 3913}, 'accuracy': 0.3732237630542715, 'macro avg': {'precision': 0.3697005473945274, 'recall': 0.3708098870113512, 'f1-score': 0.3478018259301761, 'support': 11682}, 'weighted avg': {'precision': 0.37054849764112, 'recall': 0.3732237630542715, 'f1-score': 0.3496744326504306, 'support': 11682}}
[[1362  613 2024]
 [ 990  586 2194]
 [ 917  584 2412]]
training model: results/LILAK/W10/deepLOB_L1/h100
Epoch 1/50
135/135 - 6s - loss: 3.3646 - accuracy100: 0.3496 - val_loss: 3.4074 - val_accuracy100: 0.3517 - 6s/epoch - 43ms/step
Epoch 2/50
135/135 - 4s - loss: 3.3166 - accuracy100: 0.3636 - val_loss: 3.3553 - val_accuracy100: 0.3624 - 4s/epoch - 28ms/step
Epoch 3/50
135/135 - 4s - loss: 3.2935 - accuracy100: 0.3790 - val_loss: 3.3243 - val_accuracy100: 0.3744 - 4s/epoch - 28ms/step
Epoch 4/50
135/135 - 4s - loss: 3.2832 - accuracy100: 0.3786 - val_loss: 3.3499 - val_accuracy100: 0.3682 - 4s/epoch - 28ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2890 - accuracy100: 0.3747 - val_loss: 3.3440 - val_accuracy100: 0.3726 - 4s/epoch - 28ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2699 - accuracy100: 0.3834 - val_loss: 3.3144 - val_accuracy100: 0.3597 - 4s/epoch - 28ms/step
Epoch 7/50
135/135 - 4s - loss: 3.2572 - accuracy100: 0.3919 - val_loss: 3.3135 - val_accuracy100: 0.3720 - 4s/epoch - 28ms/step
Epoch 8/50
135/135 - 4s - loss: 3.2502 - accuracy100: 0.3969 - val_loss: 3.3330 - val_accuracy100: 0.3675 - 4s/epoch - 27ms/step
Epoch 9/50
135/135 - 4s - loss: 3.2432 - accuracy100: 0.4002 - val_loss: 3.3281 - val_accuracy100: 0.3641 - 4s/epoch - 28ms/step
Epoch 10/50
135/135 - 4s - loss: 3.2449 - accuracy100: 0.3959 - val_loss: 3.3224 - val_accuracy100: 0.3650 - 4s/epoch - 28ms/step
Epoch 11/50
135/135 - 4s - loss: 3.2408 - accuracy100: 0.4012 - val_loss: 3.3044 - val_accuracy100: 0.3687 - 4s/epoch - 28ms/step
Epoch 12/50
135/135 - 4s - loss: 3.2316 - accuracy100: 0.4097 - val_loss: 3.3281 - val_accuracy100: 0.3673 - 4s/epoch - 28ms/step
Epoch 13/50
135/135 - 4s - loss: 3.2278 - accuracy100: 0.4092 - val_loss: 3.3334 - val_accuracy100: 0.3634 - 4s/epoch - 27ms/step
Epoch 14/50
135/135 - 4s - loss: 3.2185 - accuracy100: 0.4151 - val_loss: 3.3452 - val_accuracy100: 0.3594 - 4s/epoch - 28ms/step
Epoch 15/50
135/135 - 4s - loss: 3.2187 - accuracy100: 0.4094 - val_loss: 3.3422 - val_accuracy100: 0.3749 - 4s/epoch - 28ms/step
Epoch 16/50
135/135 - 4s - loss: 3.2030 - accuracy100: 0.4202 - val_loss: 3.3112 - val_accuracy100: 0.3679 - 4s/epoch - 28ms/step
Epoch 17/50
135/135 - 4s - loss: 3.2086 - accuracy100: 0.4189 - val_loss: 3.3336 - val_accuracy100: 0.3686 - 4s/epoch - 27ms/step
Epoch 18/50
135/135 - 4s - loss: 3.1996 - accuracy100: 0.4248 - val_loss: 3.3170 - val_accuracy100: 0.3709 - 4s/epoch - 28ms/step
Epoch 19/50
135/135 - 4s - loss: 3.1930 - accuracy100: 0.4257 - val_loss: 3.3309 - val_accuracy100: 0.3637 - 4s/epoch - 28ms/step
Epoch 20/50
135/135 - 4s - loss: 3.1988 - accuracy100: 0.4234 - val_loss: 3.3305 - val_accuracy100: 0.3651 - 4s/epoch - 27ms/step
Epoch 21/50
135/135 - 4s - loss: 3.1929 - accuracy100: 0.4264 - val_loss: 3.3461 - val_accuracy100: 0.3656 - 4s/epoch - 28ms/step
testing model: results/LILAK/W10/deepLOB_L1/h100
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0943959
{'0': {'precision': 0.4464858957721467, 'recall': 0.23651790075438248, 'f1-score': 0.30922787639399707, 'support': 55277}, '1': {'precision': 0.20688917415489944, 'recall': 0.03523795641717076, 'f1-score': 0.060219205380495695, 'support': 27442}, '2': {'precision': 0.3859650901129199, 'recall': 0.7632037842496643, 'f1-score': 0.5126661954289946, 'support': 49891}, 'accuracy': 0.39301711786441446, 'macro avg': {'precision': 0.34644672001332205, 'recall': 0.3449865471404059, 'f1-score': 0.29403775906782914, 'support': 132610}, 'weighted avg': {'precision': 0.37413496635683124, 'recall': 0.39301711786441446, 'f1-score': 0.334236889477645, 'support': 132610}}
[[13074  1866 40337]
 [ 6235   967 20240]
 [ 9973  1841 38077]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0960451
{'0': {'precision': 0.37236665172568356, 'recall': 0.2905990380411019, 'f1-score': 0.3264403949113414, 'support': 11435}, '1': {'precision': 0.40344287949921753, 'recall': 0.2280810404317438, 'f1-score': 0.29141468377324364, 'support': 11303}, '2': {'precision': 0.36829922668209797, 'recall': 0.6043159257660768, 'f1-score': 0.45767143884421785, 'support': 11585}, 'accuracy': 0.37589954258077674, 'macro avg': {'precision': 0.38136958596899967, 'recall': 0.37433200141297424, 'f1-score': 0.35850883917626764, 'support': 34323}, 'weighted avg': {'precision': 0.3812275754035181, 'recall': 0.37589954258077674, 'f1-score': 0.3592002361539034, 'support': 34323}}
[[3323 1915 6197]
 [2914 2578 5811]
 [2687 1897 7001]]
Evaluating performance on  val set...
46/46 - 1s - 614ms/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1024086
{'0': {'precision': 0.385554965480616, 'recall': 0.33379310344827584, 'f1-score': 0.3578117299162149, 'support': 4350}, '1': {'precision': 0.3362760834670947, 'recall': 0.12666263603385733, 'f1-score': 0.184014053579271, 'support': 3308}, '2': {'precision': 0.3631184407796102, 'recall': 0.6018886679920478, 'f1-score': 0.4529642790349729, 'support': 4024}, 'accuracy': 0.3674884437596302, 'macro avg': {'precision': 0.36164982990910693, 'recall': 0.35411480249139365, 'f1-score': 0.331596687510153, 'support': 11682}, 'weighted avg': {'precision': 0.36387211005367065, 'recall': 0.3674884437596302, 'f1-score': 0.34137371796032306, 'support': 11682}}
[[1452  446 2452]
 [1093  419 1796]
 [1221  381 2422]]
training model: results/LILAK/W10/deepLOB_L1/h200
Epoch 1/50
135/135 - 6s - loss: 3.3643 - accuracy200: 0.3444 - val_loss: 3.4041 - val_accuracy200: 0.3441 - 6s/epoch - 44ms/step
Epoch 2/50
135/135 - 4s - loss: 3.3303 - accuracy200: 0.3567 - val_loss: 3.4016 - val_accuracy200: 0.3505 - 4s/epoch - 28ms/step
Epoch 3/50
135/135 - 4s - loss: 3.3227 - accuracy200: 0.3554 - val_loss: 3.3675 - val_accuracy200: 0.3552 - 4s/epoch - 28ms/step
Epoch 4/50
135/135 - 4s - loss: 3.3047 - accuracy200: 0.3613 - val_loss: 3.3980 - val_accuracy200: 0.3518 - 4s/epoch - 27ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2968 - accuracy200: 0.3600 - val_loss: 3.3700 - val_accuracy200: 0.3440 - 4s/epoch - 27ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2893 - accuracy200: 0.3684 - val_loss: 3.3362 - val_accuracy200: 0.3443 - 4s/epoch - 28ms/step
Epoch 7/50
135/135 - 4s - loss: 3.2800 - accuracy200: 0.3698 - val_loss: 3.3705 - val_accuracy200: 0.3590 - 4s/epoch - 28ms/step
Epoch 8/50
135/135 - 4s - loss: 3.2745 - accuracy200: 0.3759 - val_loss: 3.3629 - val_accuracy200: 0.3559 - 4s/epoch - 27ms/step
Epoch 9/50
135/135 - 4s - loss: 3.2711 - accuracy200: 0.3749 - val_loss: 3.3609 - val_accuracy200: 0.3525 - 4s/epoch - 28ms/step
Epoch 10/50
135/135 - 4s - loss: 3.2637 - accuracy200: 0.3808 - val_loss: 3.3488 - val_accuracy200: 0.3544 - 4s/epoch - 28ms/step
Epoch 11/50
135/135 - 4s - loss: 3.2562 - accuracy200: 0.3888 - val_loss: 3.3492 - val_accuracy200: 0.3588 - 4s/epoch - 27ms/step
Epoch 12/50
135/135 - 4s - loss: 3.2459 - accuracy200: 0.3968 - val_loss: 3.3594 - val_accuracy200: 0.3636 - 4s/epoch - 27ms/step
Epoch 13/50
135/135 - 4s - loss: 3.2379 - accuracy200: 0.4018 - val_loss: 3.3601 - val_accuracy200: 0.3596 - 4s/epoch - 27ms/step
Epoch 14/50
135/135 - 4s - loss: 3.2334 - accuracy200: 0.4025 - val_loss: 3.3887 - val_accuracy200: 0.3618 - 4s/epoch - 28ms/step
Epoch 15/50
135/135 - 4s - loss: 3.2395 - accuracy200: 0.4001 - val_loss: 3.3649 - val_accuracy200: 0.3601 - 4s/epoch - 28ms/step
Epoch 16/50
135/135 - 4s - loss: 3.2253 - accuracy200: 0.4072 - val_loss: 3.4040 - val_accuracy200: 0.3621 - 4s/epoch - 27ms/step
testing model: results/LILAK/W10/deepLOB_L1/h200
Evaluating performance on  test set...
519/519 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1295149
{'0': {'precision': 0.37555479685899623, 'recall': 0.02116890864653696, 'f1-score': 0.04007869999271296, 'support': 51963}, '1': {'precision': 0.28510674491792126, 'recall': 0.09103995219859312, 'f1-score': 0.13801054018445322, 'support': 36819}, '2': {'precision': 0.3297717173772938, 'recall': 0.8872866660582276, 'f1-score': 0.4808348583015975, 'support': 43828}, 'accuracy': 0.32682301485559156, 'macro avg': {'precision': 0.33014441971807046, 'recall': 0.3331651756344525, 'f1-score': 0.21964136615958788, 'support': 132610}, 'weighted avg': {'precision': 0.33531056465974657, 'recall': 0.32682301485559156, 'f1-score': 0.21294057564599309, 'support': 132610}}
[[ 1100  4487 46376]
 [  807  3352 32660]
 [ 1022  3918 38888]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1106806
{'0': {'precision': 0.3390804597701149, 'recall': 0.16819281271596406, 'f1-score': 0.22485275435962582, 'support': 11576}, '1': {'precision': 0.34968570647717956, 'recall': 0.22702271114265438, 'f1-score': 0.2753093060785368, 'support': 11272}, '2': {'precision': 0.34595306400790105, 'recall': 0.6410457516339869, 'f1-score': 0.4493860345775551, 'support': 11475}, 'accuracy': 0.34559916091250764, 'macro avg': {'precision': 0.3449064100850652, 'recall': 0.34542042516420174, 'f1-score': 0.31651603167190595, 'support': 34323}, 'weighted avg': {'precision': 0.3448609997727554, 'recall': 0.34559916091250764, 'f1-score': 0.3164900133834962, 'support': 34323}}
[[1947 2462 7167]
 [1973 2559 6740]
 [1822 2297 7356]]
Evaluating performance on  val set...
46/46 - 1s - 601ms/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1141703
{'0': {'precision': 0.3972530375066033, 'recall': 0.17149372862029647, 'f1-score': 0.23956674100031858, 'support': 4385}, '1': {'precision': 0.30077519379844964, 'recall': 0.17042459736456808, 'f1-score': 0.21757009345794395, 'support': 3415}, '2': {'precision': 0.3396995161701044, 'recall': 0.6872746007212777, 'f1-score': 0.45466939331970013, 'support': 3882}, 'accuracy': 0.34257832562917306, 'macro avg': {'precision': 0.3459092491583858, 'recall': 0.34306430890204737, 'f1-score': 0.3039354092593209, 'support': 11682}, 'weighted avg': {'precision': 0.3499242747868949, 'recall': 0.34257832562917306, 'f1-score': 0.3046163853203519, 'support': 11682}}
[[ 752  748 2885]
 [ 532  582 2301]
 [ 609  605 2668]]
training model: results/LILAK/W10/deepLOB_L1/h300
Epoch 1/50
135/135 - 6s - loss: 3.3569 - accuracy300: 0.3499 - val_loss: 3.4061 - val_accuracy300: 0.3532 - 6s/epoch - 47ms/step
Epoch 2/50
135/135 - 4s - loss: 3.3261 - accuracy300: 0.3555 - val_loss: 3.4847 - val_accuracy300: 0.3677 - 4s/epoch - 27ms/step
Epoch 3/50
135/135 - 4s - loss: 3.2958 - accuracy300: 0.3745 - val_loss: 3.3967 - val_accuracy300: 0.3684 - 4s/epoch - 28ms/step
Epoch 4/50
135/135 - 4s - loss: 3.2953 - accuracy300: 0.3696 - val_loss: 3.4199 - val_accuracy300: 0.3610 - 4s/epoch - 28ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2763 - accuracy300: 0.3753 - val_loss: 3.3976 - val_accuracy300: 0.3682 - 4s/epoch - 28ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2833 - accuracy300: 0.3729 - val_loss: 3.3648 - val_accuracy300: 0.3672 - 4s/epoch - 28ms/step
Epoch 7/50
135/135 - 4s - loss: 3.2545 - accuracy300: 0.3894 - val_loss: 3.4231 - val_accuracy300: 0.3715 - 4s/epoch - 27ms/step
Epoch 8/50
135/135 - 4s - loss: 3.2398 - accuracy300: 0.3983 - val_loss: 3.3906 - val_accuracy300: 0.3691 - 4s/epoch - 27ms/step
Epoch 9/50
135/135 - 4s - loss: 3.2223 - accuracy300: 0.4123 - val_loss: 3.4157 - val_accuracy300: 0.3772 - 4s/epoch - 28ms/step
Epoch 10/50
135/135 - 4s - loss: 3.2124 - accuracy300: 0.4188 - val_loss: 3.4033 - val_accuracy300: 0.3762 - 4s/epoch - 28ms/step
Epoch 11/50
135/135 - 4s - loss: 3.2016 - accuracy300: 0.4231 - val_loss: 3.4296 - val_accuracy300: 0.3754 - 4s/epoch - 28ms/step
Epoch 12/50
135/135 - 4s - loss: 3.2026 - accuracy300: 0.4216 - val_loss: 3.4076 - val_accuracy300: 0.3792 - 4s/epoch - 28ms/step
Epoch 13/50
135/135 - 4s - loss: 3.1884 - accuracy300: 0.4298 - val_loss: 3.4365 - val_accuracy300: 0.3767 - 4s/epoch - 28ms/step
Epoch 14/50
135/135 - 4s - loss: 3.1902 - accuracy300: 0.4297 - val_loss: 3.4519 - val_accuracy300: 0.3790 - 4s/epoch - 27ms/step
Epoch 15/50
135/135 - 4s - loss: 3.1810 - accuracy300: 0.4324 - val_loss: 3.4604 - val_accuracy300: 0.3808 - 4s/epoch - 27ms/step
Epoch 16/50
135/135 - 4s - loss: 3.1738 - accuracy300: 0.4363 - val_loss: 3.5252 - val_accuracy300: 0.3757 - 4s/epoch - 28ms/step
testing model: results/LILAK/W10/deepLOB_L1/h300
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1439579
{'0': {'precision': 0.35614973262032085, 'recall': 0.006199385646467467, 'f1-score': 0.012186642268984447, 'support': 53715}, '1': {'precision': 0.26711749788672867, 'recall': 0.018758718945712505, 'f1-score': 0.035055606400976234, 'support': 33691}, '2': {'precision': 0.3406878098198888, 'recall': 0.9745597734713742, 'f1-score': 0.5048792926601455, 'support': 45204}, 'accuracy': 0.33948420179473643, 'macro avg': {'precision': 0.3213183467756461, 'recall': 0.33317262602118475, 'f1-score': 0.18404051377670205, 'support': 132610}, 'weighted avg': {'precision': 0.32825948468517124, 'recall': 0.33948420179473643, 'f1-score': 0.18594546014737204, 'support': 132610}}
[[  333   944 52438]
 [  242   632 32817]
 [  360   790 44054]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1263198
{'0': {'precision': 0.30701859628074385, 'recall': 0.2201100980560812, 'f1-score': 0.2563999799609238, 'support': 11626}, '1': {'precision': 0.37607186606778276, 'recall': 0.16206229104346295, 'f1-score': 0.22651254303984258, 'support': 11366}, '2': {'precision': 0.35296348980559505, 'recall': 0.6569587856323361, 'f1-score': 0.45920853767619757, 'support': 11331}, 'accuracy': 0.34510386621216094, 'macro avg': {'precision': 0.3453513173847072, 'recall': 0.3463770582439601, 'f1-score': 0.31404035355898796, 'support': 34323}, 'weighted avg': {'precision': 0.3450531810469232, 'recall': 0.34510386621216094, 'f1-score': 0.31345569069211743, 'support': 34323}}
[[2559 1739 7328]
 [3206 1842 6318]
 [2570 1317 7444]]
Evaluating performance on  val set...
46/46 - 1s - 624ms/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1234883
{'0': {'precision': 0.4123456790123457, 'recall': 0.2874354561101549, 'f1-score': 0.3387423935091278, 'support': 4648}, '1': {'precision': 0.2576769025367156, 'recall': 0.06317512274959083, 'f1-score': 0.101472134595163, 'support': 3055}, '2': {'precision': 0.36110750032497074, 'recall': 0.6981653681829605, 'f1-score': 0.4760109664153529, 'support': 3979}, 'accuracy': 0.3686868686868687, 'macro avg': {'precision': 0.34371002729134403, 'recall': 0.3495919823475688, 'f1-score': 0.3054084981732146, 'support': 11682}, 'weighted avg': {'precision': 0.3544455056576021, 'recall': 0.3686868686868687, 'f1-score': 0.3234480098943108, 'support': 11682}}
[[1336  322 2990]
 [ 937  193 1925]
 [ 967  234 2778]]
training model: results/LILAK/W10/deepLOB_L1/h500
Epoch 1/50
135/135 - 6s - loss: 3.3617 - accuracy500: 0.3512 - val_loss: 3.5866 - val_accuracy500: 0.3532 - 6s/epoch - 45ms/step
Epoch 2/50
135/135 - 4s - loss: 3.3418 - accuracy500: 0.3598 - val_loss: 3.5038 - val_accuracy500: 0.3355 - 4s/epoch - 28ms/step
Epoch 3/50
135/135 - 4s - loss: 3.3224 - accuracy500: 0.3615 - val_loss: 3.5283 - val_accuracy500: 0.3478 - 4s/epoch - 28ms/step
Epoch 4/50
135/135 - 4s - loss: 3.2985 - accuracy500: 0.3702 - val_loss: 3.4272 - val_accuracy500: 0.3614 - 4s/epoch - 28ms/step
Epoch 5/50
135/135 - 4s - loss: 3.3003 - accuracy500: 0.3621 - val_loss: 3.4569 - val_accuracy500: 0.3502 - 4s/epoch - 28ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2897 - accuracy500: 0.3661 - val_loss: 3.3711 - val_accuracy500: 0.3500 - 4s/epoch - 29ms/step
Epoch 7/50
135/135 - 4s - loss: 3.2655 - accuracy500: 0.3850 - val_loss: 3.5409 - val_accuracy500: 0.3512 - 4s/epoch - 28ms/step
Epoch 8/50
135/135 - 4s - loss: 3.2687 - accuracy500: 0.3869 - val_loss: 3.4613 - val_accuracy500: 0.3441 - 4s/epoch - 28ms/step
Epoch 9/50
135/135 - 4s - loss: 3.2357 - accuracy500: 0.4057 - val_loss: 3.4593 - val_accuracy500: 0.3513 - 4s/epoch - 28ms/step
Epoch 10/50
135/135 - 4s - loss: 3.2221 - accuracy500: 0.4141 - val_loss: 3.4954 - val_accuracy500: 0.3497 - 4s/epoch - 28ms/step
Epoch 11/50
135/135 - 4s - loss: 3.2351 - accuracy500: 0.4053 - val_loss: 3.4371 - val_accuracy500: 0.3480 - 4s/epoch - 28ms/step
Epoch 12/50
135/135 - 4s - loss: 3.2110 - accuracy500: 0.4190 - val_loss: 3.5005 - val_accuracy500: 0.3556 - 4s/epoch - 28ms/step
Epoch 13/50
135/135 - 4s - loss: 3.1999 - accuracy500: 0.4240 - val_loss: 3.5571 - val_accuracy500: 0.3547 - 4s/epoch - 27ms/step
Epoch 14/50
135/135 - 4s - loss: 3.1999 - accuracy500: 0.4225 - val_loss: 3.6044 - val_accuracy500: 0.3520 - 4s/epoch - 28ms/step
Epoch 15/50
135/135 - 4s - loss: 3.1982 - accuracy500: 0.4269 - val_loss: 3.5927 - val_accuracy500: 0.3480 - 4s/epoch - 28ms/step
Epoch 16/50
135/135 - 4s - loss: 3.1812 - accuracy500: 0.4337 - val_loss: 3.5967 - val_accuracy500: 0.3522 - 4s/epoch - 28ms/step
testing model: results/LILAK/W10/deepLOB_L1/h500
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1505481
{'0': {'precision': 0.38945362134688694, 'recall': 0.011598425792779837, 'f1-score': 0.022525998603608564, 'support': 52852}, '1': {'precision': 0.2641916167664671, 'recall': 0.030638037832282437, 'f1-score': 0.0549084030266826, 'support': 36001}, '2': {'precision': 0.3293920117293731, 'recall': 0.9549786319903101, 'f1-score': 0.4898310846452309, 'support': 43757}, 'accuracy': 0.32805218309328105, 'macro avg': {'precision': 0.32767908328090906, 'recall': 0.33240503187179077, 'f1-score': 0.18908849542517403, 'support': 132610}, 'weighted avg': {'precision': 0.33562907358326993, 'recall': 0.32805218309328105, 'f1-score': 0.185512708441165, 'support': 132610}}
[[  613  1629 50610]
 [  434  1103 34464]
 [  527  1443 41787]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1178769
{'0': {'precision': 0.334453781512605, 'recall': 0.23779446910208263, 'f1-score': 0.2779606904120523, 'support': 11716}, '1': {'precision': 0.35241657077100114, 'recall': 0.1082729361852572, 'f1-score': 0.1656524678837052, 'support': 11314}, '2': {'precision': 0.3511124927832304, 'recall': 0.7000796953865226, 'f1-score': 0.46767228630582663, 'support': 11293}, 'accuracy': 0.3472015849430411, 'macro avg': {'precision': 0.34599428168894547, 'recall': 0.34871570022462084, 'f1-score': 0.3037618148671947, 'support': 34323}, 'weighted avg': {'precision': 0.34585598481792995, 'recall': 0.3472015849430411, 'f1-score': 0.3033593392114776, 'support': 34323}}
[[2786 1240 7690]
 [3168 1225 6921]
 [2376 1011 7906]]
Evaluating performance on  val set...
46/46 - 1s - 582ms/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1273935
{'0': {'precision': 0.4165942658557776, 'recall': 0.20780065005417117, 'f1-score': 0.2772878415498048, 'support': 4615}, '1': {'precision': 0.2820738137082601, 'recall': 0.0964253529588465, 'f1-score': 0.14372061786433848, 'support': 3329}, '2': {'precision': 0.3369327833050231, 'recall': 0.7429106474050294, 'f1-score': 0.46360601001669455, 'support': 3738}, 'accuracy': 0.34728642355761, 'macro avg': {'precision': 0.34520028762302024, 'recall': 0.349045550139349, 'f1-score': 0.2948714898102793, 'support': 11682}, 'weighted avg': {'precision': 0.3527701597974137, 'recall': 0.34728642355761, 'f1-score': 0.2988433993378819, 'support': 11682}}
[[ 959  485 3171]
 [ 714  321 2294]
 [ 629  332 2777]]
training model: results/LILAK/W10/deepLOB_L1/h1000
Epoch 1/50
135/135 - 6s - loss: 3.3394 - accuracy1000: 0.3594 - val_loss: 3.5568 - val_accuracy1000: 0.3371 - 6s/epoch - 44ms/step
Epoch 2/50
135/135 - 4s - loss: 3.3115 - accuracy1000: 0.3807 - val_loss: 3.7150 - val_accuracy1000: 0.3273 - 4s/epoch - 27ms/step
Epoch 3/50
135/135 - 4s - loss: 3.3051 - accuracy1000: 0.3742 - val_loss: 3.6056 - val_accuracy1000: 0.3357 - 4s/epoch - 28ms/step
Epoch 4/50
135/135 - 4s - loss: 3.2825 - accuracy1000: 0.3844 - val_loss: 3.6971 - val_accuracy1000: 0.3407 - 4s/epoch - 28ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2805 - accuracy1000: 0.3838 - val_loss: 3.5745 - val_accuracy1000: 0.3335 - 4s/epoch - 28ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2354 - accuracy1000: 0.4138 - val_loss: 3.6221 - val_accuracy1000: 0.3375 - 4s/epoch - 27ms/step
Epoch 7/50
135/135 - 4s - loss: 3.2330 - accuracy1000: 0.4146 - val_loss: 3.7413 - val_accuracy1000: 0.3321 - 4s/epoch - 27ms/step
Epoch 8/50
135/135 - 4s - loss: 3.1889 - accuracy1000: 0.4363 - val_loss: 3.7311 - val_accuracy1000: 0.3328 - 4s/epoch - 27ms/step
Epoch 9/50
135/135 - 4s - loss: 3.1639 - accuracy1000: 0.4394 - val_loss: 3.6747 - val_accuracy1000: 0.3367 - 4s/epoch - 28ms/step
Epoch 10/50
135/135 - 4s - loss: 3.1549 - accuracy1000: 0.4506 - val_loss: 3.6000 - val_accuracy1000: 0.3334 - 4s/epoch - 28ms/step
Epoch 11/50
135/135 - 4s - loss: 3.1436 - accuracy1000: 0.4456 - val_loss: 3.6806 - val_accuracy1000: 0.3238 - 4s/epoch - 28ms/step
testing model: results/LILAK/W10/deepLOB_L1/h1000
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2636894
{'0': {'precision': 0.4124903623747109, 'recall': 0.030104662940315864, 'f1-score': 0.056113976051044484, 'support': 53314}, '1': {'precision': 0.27465735017468423, 'recall': 0.026006412540078374, 'f1-score': 0.047513889211743654, 'support': 39298}, '2': {'precision': 0.3016848269572313, 'recall': 0.9427971398569929, 'f1-score': 0.45710199035128124, 'support': 39998}, 'accuracy': 0.30417766382625744, 'macro avg': {'precision': 0.3296108465022088, 'recall': 0.33296940511246237, 'f1-score': 0.18690995187135648, 'support': 132610}, 'weighted avg': {'precision': 0.33822325190743846, 'recall': 0.30417766382625744, 'f1-score': 0.17451192781463715, 'support': 132610}}
[[ 1605  1589 50120]
 [ 1108  1022 37168]
 [ 1178  1110 37710]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.172088
{'0': {'precision': 0.3229855581050074, 'recall': 0.20668509241665228, 'f1-score': 0.2520672038763364, 'support': 11578}, '1': {'precision': 0.38250627534273024, 'recall': 0.1757608020583799, 'f1-score': 0.24085106382978724, 'support': 11271}, '2': {'precision': 0.35909822866344604, 'recall': 0.6802335715530765, 'f1-score': 0.4700532988045409, 'support': 11474}, 'accuracy': 0.35483495032485507, 'macro avg': {'precision': 0.3548633540370612, 'recall': 0.35422648867603623, 'f1-score': 0.32099052217022156, 'support': 34323}, 'weighted avg': {'precision': 0.3546032717656402, 'recall': 0.35483495032485507, 'f1-score': 0.32125565881155665, 'support': 34323}}
[[2393 1725 7460]
 [2820 1981 6470]
 [2196 1473 7805]]
Evaluating performance on  val set...
46/46 - 1s - 597ms/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1831697
{'0': {'precision': 0.42851796407185627, 'recall': 0.24671407024348202, 'f1-score': 0.3131409818132094, 'support': 4641}, '1': {'precision': 0.32566765578635015, 'recall': 0.1166622375764018, 'f1-score': 0.1717863431813735, 'support': 3763}, '2': {'precision': 0.31036282954842076, 'recall': 0.7254423428920074, 'f1-score': 0.4347349177330896, 'support': 3278}, 'accuracy': 0.3391542544084917, 'macro avg': {'precision': 0.35484948313554243, 'recall': 0.3629395502372971, 'f1-score': 0.30655408090922415, 'support': 11682}, 'weighted avg': {'precision': 0.3622332319158743, 'recall': 0.3391542544084917, 'f1-score': 0.3017274752881083, 'support': 11682}}
[[1145  611 2885]
 [ 925  439 2399]
 [ 602  298 2378]]
training model: results/LILAK/W10/deepOF_L1/h10
Epoch 1/50
135/135 - 6s - loss: 3.3167 - accuracy10: 0.3640 - val_loss: 3.2953 - val_accuracy10: 0.3790 - 6s/epoch - 45ms/step
Epoch 2/50
135/135 - 4s - loss: 3.2719 - accuracy10: 0.3918 - val_loss: 3.2742 - val_accuracy10: 0.3938 - 4s/epoch - 26ms/step
Epoch 3/50
135/135 - 4s - loss: 3.2449 - accuracy10: 0.4081 - val_loss: 3.2570 - val_accuracy10: 0.4035 - 4s/epoch - 26ms/step
Epoch 4/50
135/135 - 4s - loss: 3.2261 - accuracy10: 0.4160 - val_loss: 3.2495 - val_accuracy10: 0.4074 - 4s/epoch - 26ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2074 - accuracy10: 0.4254 - val_loss: 3.2457 - val_accuracy10: 0.4066 - 4s/epoch - 26ms/step
Epoch 6/50
135/135 - 4s - loss: 3.1930 - accuracy10: 0.4303 - val_loss: 3.2353 - val_accuracy10: 0.4098 - 4s/epoch - 26ms/step
Epoch 7/50
135/135 - 4s - loss: 3.1859 - accuracy10: 0.4335 - val_loss: 3.2270 - val_accuracy10: 0.4135 - 4s/epoch - 26ms/step
Epoch 8/50
135/135 - 4s - loss: 3.1735 - accuracy10: 0.4380 - val_loss: 3.2241 - val_accuracy10: 0.4185 - 4s/epoch - 26ms/step
Epoch 9/50
135/135 - 4s - loss: 3.1632 - accuracy10: 0.4458 - val_loss: 3.2235 - val_accuracy10: 0.4183 - 4s/epoch - 27ms/step
Epoch 10/50
135/135 - 4s - loss: 3.1504 - accuracy10: 0.4454 - val_loss: 3.2202 - val_accuracy10: 0.4238 - 4s/epoch - 27ms/step
Epoch 11/50
135/135 - 4s - loss: 3.1450 - accuracy10: 0.4500 - val_loss: 3.2077 - val_accuracy10: 0.4244 - 4s/epoch - 27ms/step
Epoch 12/50
135/135 - 4s - loss: 3.1378 - accuracy10: 0.4539 - val_loss: 3.2123 - val_accuracy10: 0.4205 - 4s/epoch - 26ms/step
Epoch 13/50
135/135 - 3s - loss: 3.1318 - accuracy10: 0.4541 - val_loss: 3.2171 - val_accuracy10: 0.4262 - 3s/epoch - 25ms/step
Epoch 14/50
135/135 - 3s - loss: 3.1202 - accuracy10: 0.4583 - val_loss: 3.2191 - val_accuracy10: 0.4247 - 3s/epoch - 26ms/step
Epoch 15/50
135/135 - 4s - loss: 3.1167 - accuracy10: 0.4609 - val_loss: 3.2089 - val_accuracy10: 0.4298 - 4s/epoch - 26ms/step
Epoch 16/50
135/135 - 4s - loss: 3.1080 - accuracy10: 0.4632 - val_loss: 3.2150 - val_accuracy10: 0.4284 - 4s/epoch - 27ms/step
Epoch 17/50
135/135 - 3s - loss: 3.1067 - accuracy10: 0.4675 - val_loss: 3.2070 - val_accuracy10: 0.4261 - 3s/epoch - 26ms/step
Epoch 18/50
135/135 - 3s - loss: 3.0936 - accuracy10: 0.4694 - val_loss: 3.2118 - val_accuracy10: 0.4267 - 3s/epoch - 26ms/step
Epoch 19/50
135/135 - 4s - loss: 3.0897 - accuracy10: 0.4706 - val_loss: 3.2115 - val_accuracy10: 0.4301 - 4s/epoch - 26ms/step
Epoch 20/50
135/135 - 4s - loss: 3.0823 - accuracy10: 0.4743 - val_loss: 3.2115 - val_accuracy10: 0.4326 - 4s/epoch - 26ms/step
Epoch 21/50
135/135 - 3s - loss: 3.0740 - accuracy10: 0.4787 - val_loss: 3.2145 - val_accuracy10: 0.4295 - 3s/epoch - 26ms/step
Epoch 22/50
135/135 - 4s - loss: 3.0651 - accuracy10: 0.4799 - val_loss: 3.2068 - val_accuracy10: 0.4310 - 4s/epoch - 26ms/step
Epoch 23/50
135/135 - 4s - loss: 3.0599 - accuracy10: 0.4833 - val_loss: 3.2056 - val_accuracy10: 0.4327 - 4s/epoch - 26ms/step
Epoch 24/50
135/135 - 4s - loss: 3.0523 - accuracy10: 0.4826 - val_loss: 3.2052 - val_accuracy10: 0.4319 - 4s/epoch - 27ms/step
Epoch 25/50
135/135 - 4s - loss: 3.0417 - accuracy10: 0.4877 - val_loss: 3.2024 - val_accuracy10: 0.4325 - 4s/epoch - 26ms/step
Epoch 26/50
135/135 - 4s - loss: 3.0369 - accuracy10: 0.4873 - val_loss: 3.2126 - val_accuracy10: 0.4319 - 4s/epoch - 26ms/step
Epoch 27/50
135/135 - 4s - loss: 3.0279 - accuracy10: 0.4926 - val_loss: 3.2110 - val_accuracy10: 0.4292 - 4s/epoch - 26ms/step
Epoch 28/50
135/135 - 3s - loss: 3.0183 - accuracy10: 0.4962 - val_loss: 3.2078 - val_accuracy10: 0.4355 - 3s/epoch - 25ms/step
Epoch 29/50
135/135 - 3s - loss: 3.0171 - accuracy10: 0.4947 - val_loss: 3.2181 - val_accuracy10: 0.4331 - 3s/epoch - 26ms/step
Epoch 30/50
135/135 - 3s - loss: 3.0113 - accuracy10: 0.4979 - val_loss: 3.2132 - val_accuracy10: 0.4334 - 3s/epoch - 26ms/step
Epoch 31/50
135/135 - 4s - loss: 2.9992 - accuracy10: 0.5006 - val_loss: 3.2180 - val_accuracy10: 0.4295 - 4s/epoch - 26ms/step
Epoch 32/50
135/135 - 3s - loss: 2.9947 - accuracy10: 0.5020 - val_loss: 3.2155 - val_accuracy10: 0.4399 - 3s/epoch - 26ms/step
Epoch 33/50
135/135 - 4s - loss: 2.9798 - accuracy10: 0.5079 - val_loss: 3.2162 - val_accuracy10: 0.4347 - 4s/epoch - 26ms/step
Epoch 34/50
135/135 - 3s - loss: 2.9764 - accuracy10: 0.5074 - val_loss: 3.2257 - val_accuracy10: 0.4331 - 3s/epoch - 26ms/step
Epoch 35/50
135/135 - 4s - loss: 2.9700 - accuracy10: 0.5094 - val_loss: 3.2338 - val_accuracy10: 0.4323 - 4s/epoch - 26ms/step
testing model: results/LILAK/W10/deepOF_L1/h10
Evaluating performance on  test set...
518/518 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1062396
{'0': {'precision': 0.47221392787233335, 'recall': 0.2798686487336794, 'f1-score': 0.3514451152511821, 'support': 50856}, '1': {'precision': 0.3258157298234252, 'recall': 0.489371441650216, 'f1-score': 0.3911860220463798, 'support': 34953}, '2': {'precision': 0.413029120384269, 'recall': 0.4409992307034789, 'f1-score': 0.42655615382230444, 'support': 46796}, 'accuracy': 0.3919535462463708, 'macro avg': {'precision': 0.4036862593600092, 'recall': 0.40341310702912475, 'f1-score': 0.38972909703995545, 'support': 132605}, 'weighted avg': {'precision': 0.4127390327506189, 'recall': 0.3919535462463708, 'f1-score': 0.3884268284308268, 'support': 132605}}
[[14233 18900 17723]
 [ 6243 17105 11605]
 [ 9665 16494 20637]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0254753
{'0': {'precision': 0.5264361630566393, 'recall': 0.34949982136477314, 'f1-score': 0.4200976971388695, 'support': 11196}, '1': {'precision': 0.4575405707890319, 'recall': 0.5684860073005389, 'f1-score': 0.5070149600806139, 'support': 11506}, '2': {'precision': 0.46267471410419314, 'recall': 0.501420087787245, 'f1-score': 0.4812688447399942, 'support': 11619}, 'accuracy': 0.47434515311325426, 'macro avg': {'precision': 0.48221714931662146, 'recall': 0.47313530548418564, 'f1-score': 0.4694605006531592, 'support': 34321}, 'weighted avg': {'precision': 0.48175340439548253, 'recall': 0.47434515311325426, 'f1-score': 0.46994524212255817, 'support': 34321}}
[[3913 3814 3469]
 [1668 6541 3297]
 [1852 3941 5826]]
Evaluating performance on  val set...
46/46 - 1s - 578ms/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0693741
{'0': {'precision': 0.4409177820267686, 'recall': 0.3047040169133192, 'f1-score': 0.36036880762619156, 'support': 3784}, '1': {'precision': 0.4451442503047542, 'recall': 0.5370098039215686, 'f1-score': 0.4867807153965785, 'support': 4080}, '2': {'precision': 0.40506634499396865, 'recall': 0.4397590361445783, 'f1-score': 0.4217003641843527, 'support': 3818}, 'accuracy': 0.4299777435370656, 'macro avg': {'precision': 0.43037612577516376, 'recall': 0.42715761899315535, 'f1-score': 0.42294996240237426, 'support': 11682}, 'weighted avg': {'precision': 0.43067665927235593, 'recall': 0.4299777435370656, 'f1-score': 0.4245636772240548, 'support': 11682}}
[[1153 1318 1313]
 [ 736 2191 1153]
 [ 726 1413 1679]]
training model: results/LILAK/W10/deepOF_L1/h20
Epoch 1/50
135/135 - 6s - loss: 3.3328 - accuracy20: 0.3495 - val_loss: 3.3185 - val_accuracy20: 0.3552 - 6s/epoch - 41ms/step
Epoch 2/50
135/135 - 4s - loss: 3.3014 - accuracy20: 0.3662 - val_loss: 3.3033 - val_accuracy20: 0.3638 - 4s/epoch - 27ms/step
Epoch 3/50
135/135 - 3s - loss: 3.2812 - accuracy20: 0.3805 - val_loss: 3.2959 - val_accuracy20: 0.3661 - 3s/epoch - 26ms/step
Epoch 4/50
135/135 - 3s - loss: 3.2693 - accuracy20: 0.3878 - val_loss: 3.2883 - val_accuracy20: 0.3740 - 3s/epoch - 26ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2568 - accuracy20: 0.3984 - val_loss: 3.2884 - val_accuracy20: 0.3751 - 4s/epoch - 26ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2495 - accuracy20: 0.3988 - val_loss: 3.2858 - val_accuracy20: 0.3746 - 4s/epoch - 27ms/step
Epoch 7/50
135/135 - 4s - loss: 3.2431 - accuracy20: 0.4024 - val_loss: 3.2803 - val_accuracy20: 0.3820 - 4s/epoch - 26ms/step
Epoch 8/50
135/135 - 3s - loss: 3.2348 - accuracy20: 0.4083 - val_loss: 3.2766 - val_accuracy20: 0.3872 - 3s/epoch - 26ms/step
Epoch 9/50
135/135 - 3s - loss: 3.2284 - accuracy20: 0.4121 - val_loss: 3.2791 - val_accuracy20: 0.3834 - 3s/epoch - 26ms/step
Epoch 10/50
135/135 - 3s - loss: 3.2231 - accuracy20: 0.4122 - val_loss: 3.2801 - val_accuracy20: 0.3867 - 3s/epoch - 25ms/step
Epoch 11/50
135/135 - 4s - loss: 3.2164 - accuracy20: 0.4158 - val_loss: 3.2654 - val_accuracy20: 0.3920 - 4s/epoch - 26ms/step
Epoch 12/50
135/135 - 3s - loss: 3.2085 - accuracy20: 0.4212 - val_loss: 3.2701 - val_accuracy20: 0.3903 - 3s/epoch - 26ms/step
Epoch 13/50
135/135 - 4s - loss: 3.2065 - accuracy20: 0.4199 - val_loss: 3.2747 - val_accuracy20: 0.3918 - 4s/epoch - 26ms/step
Epoch 14/50
135/135 - 3s - loss: 3.2004 - accuracy20: 0.4233 - val_loss: 3.2679 - val_accuracy20: 0.3938 - 3s/epoch - 25ms/step
Epoch 15/50
135/135 - 3s - loss: 3.1966 - accuracy20: 0.4261 - val_loss: 3.2760 - val_accuracy20: 0.3893 - 3s/epoch - 25ms/step
Epoch 16/50
135/135 - 3s - loss: 3.1912 - accuracy20: 0.4294 - val_loss: 3.2748 - val_accuracy20: 0.3885 - 3s/epoch - 25ms/step
Epoch 17/50
135/135 - 4s - loss: 3.1859 - accuracy20: 0.4298 - val_loss: 3.2627 - val_accuracy20: 0.3974 - 4s/epoch - 26ms/step
Epoch 18/50
135/135 - 3s - loss: 3.1813 - accuracy20: 0.4333 - val_loss: 3.2653 - val_accuracy20: 0.3937 - 3s/epoch - 25ms/step
Epoch 19/50
135/135 - 3s - loss: 3.1775 - accuracy20: 0.4347 - val_loss: 3.2734 - val_accuracy20: 0.3949 - 3s/epoch - 25ms/step
Epoch 20/50
135/135 - 3s - loss: 3.1674 - accuracy20: 0.4377 - val_loss: 3.2730 - val_accuracy20: 0.3986 - 3s/epoch - 25ms/step
Epoch 21/50
135/135 - 3s - loss: 3.1679 - accuracy20: 0.4366 - val_loss: 3.2711 - val_accuracy20: 0.3988 - 3s/epoch - 25ms/step
Epoch 22/50
135/135 - 3s - loss: 3.1624 - accuracy20: 0.4408 - val_loss: 3.2695 - val_accuracy20: 0.3956 - 3s/epoch - 26ms/step
Epoch 23/50
135/135 - 3s - loss: 3.1567 - accuracy20: 0.4423 - val_loss: 3.2724 - val_accuracy20: 0.3927 - 3s/epoch - 25ms/step
Epoch 24/50
135/135 - 3s - loss: 3.1531 - accuracy20: 0.4468 - val_loss: 3.2670 - val_accuracy20: 0.3998 - 3s/epoch - 25ms/step
Epoch 25/50
135/135 - 3s - loss: 3.1487 - accuracy20: 0.4447 - val_loss: 3.2746 - val_accuracy20: 0.3953 - 3s/epoch - 25ms/step
Epoch 26/50
135/135 - 3s - loss: 3.1418 - accuracy20: 0.4489 - val_loss: 3.2716 - val_accuracy20: 0.3961 - 3s/epoch - 26ms/step
Epoch 27/50
135/135 - 3s - loss: 3.1349 - accuracy20: 0.4534 - val_loss: 3.2756 - val_accuracy20: 0.3970 - 3s/epoch - 26ms/step
testing model: results/LILAK/W10/deepOF_L1/h20
Evaluating performance on  test set...
518/518 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1065555
{'0': {'precision': 0.46481930787894266, 'recall': 0.27225130890052357, 'f1-score': 0.3433800292439036, 'support': 53480}, '1': {'precision': 0.25603582161802374, 'recall': 0.4255019609157644, 'f1-score': 0.3196997934820934, 'support': 29833}, '2': {'precision': 0.4136010212370895, 'recall': 0.4338229327274203, 'f1-score': 0.42347070122977604, 'support': 49292}, 'accuracy': 0.36678858263263076, 'macro avg': {'precision': 0.3781520502446853, 'recall': 0.37719206751456946, 'f1-score': 0.3621835079852576, 'support': 132605}, 'weighted avg': {'precision': 0.3988090553939518, 'recall': 0.36678858263263076, 'f1-score': 0.36782388075814165, 'support': 132605}}
[[14560 19587 19333]
 [ 6154 12694 10985]
 [10610 17298 21384]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0644418
{'0': {'precision': 0.4738707833047456, 'recall': 0.36103850845094965, 'f1-score': 0.4098303911388023, 'support': 11478}, '1': {'precision': 0.4051586726561368, 'recall': 0.48846960167714887, 'f1-score': 0.44293069306930694, 'support': 11448}, '2': {'precision': 0.4160862918294547, 'recall': 0.42992540587977185, 'f1-score': 0.4228926582934093, 'support': 11395}, 'accuracy': 0.4264153142390956, 'macro avg': {'precision': 0.4317052492634457, 'recall': 0.4264778386692902, 'f1-score': 0.42521791416717286, 'support': 34321}, 'weighted avg': {'precision': 0.4317662256558946, 'recall': 0.4264153142390956, 'f1-score': 0.4252080546896068, 'support': 34321}}
[[4144 4001 3333]
 [2314 5592 3542]
 [2287 4209 4899]]
Evaluating performance on  val set...
46/46 - 1s - 559ms/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0907762
{'0': {'precision': 0.4360205831903945, 'recall': 0.3171157684630739, 'f1-score': 0.3671818575761953, 'support': 4008}, '1': {'precision': 0.3709506669489731, 'recall': 0.46583355490561024, 'f1-score': 0.413012729844413, 'support': 3761}, '2': {'precision': 0.39861523244312563, 'recall': 0.4119601328903654, 'f1-score': 0.40517783084076914, 'support': 3913}, 'accuracy': 0.3967642526964561, 'macro avg': {'precision': 0.40186216086083104, 'recall': 0.39830315208634987, 'f1-score': 0.39512413942045915, 'support': 11682}, 'weighted avg': {'precision': 0.40254214692451123, 'recall': 0.3967642526964561, 'f1-score': 0.39466415118902226, 'support': 11682}}
[[1271 1491 1246]
 [ 823 1752 1186]
 [ 821 1480 1612]]
training model: results/LILAK/W10/deepOF_L1/h30
Epoch 1/50
135/135 - 6s - loss: 3.3422 - accuracy30: 0.3395 - val_loss: 3.3124 - val_accuracy30: 0.3486 - 6s/epoch - 43ms/step
Epoch 2/50
135/135 - 3s - loss: 3.3072 - accuracy30: 0.3544 - val_loss: 3.3006 - val_accuracy30: 0.3624 - 3s/epoch - 26ms/step
Epoch 3/50
135/135 - 4s - loss: 3.2887 - accuracy30: 0.3704 - val_loss: 3.2970 - val_accuracy30: 0.3624 - 4s/epoch - 26ms/step
Epoch 4/50
135/135 - 4s - loss: 3.2783 - accuracy30: 0.3757 - val_loss: 3.2963 - val_accuracy30: 0.3667 - 4s/epoch - 26ms/step
Epoch 5/50
135/135 - 3s - loss: 3.2701 - accuracy30: 0.3811 - val_loss: 3.2978 - val_accuracy30: 0.3623 - 3s/epoch - 26ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2649 - accuracy30: 0.3848 - val_loss: 3.2896 - val_accuracy30: 0.3673 - 4s/epoch - 26ms/step
Epoch 7/50
135/135 - 3s - loss: 3.2563 - accuracy30: 0.3891 - val_loss: 3.2886 - val_accuracy30: 0.3673 - 3s/epoch - 26ms/step
Epoch 8/50
135/135 - 4s - loss: 3.2524 - accuracy30: 0.3947 - val_loss: 3.2873 - val_accuracy30: 0.3651 - 4s/epoch - 26ms/step
Epoch 9/50
135/135 - 3s - loss: 3.2464 - accuracy30: 0.3973 - val_loss: 3.2912 - val_accuracy30: 0.3624 - 3s/epoch - 25ms/step
Epoch 10/50
135/135 - 3s - loss: 3.2421 - accuracy30: 0.3970 - val_loss: 3.2922 - val_accuracy30: 0.3671 - 3s/epoch - 25ms/step
Epoch 11/50
135/135 - 3s - loss: 3.2372 - accuracy30: 0.4028 - val_loss: 3.2827 - val_accuracy30: 0.3707 - 3s/epoch - 26ms/step
Epoch 12/50
135/135 - 3s - loss: 3.2306 - accuracy30: 0.4095 - val_loss: 3.2886 - val_accuracy30: 0.3700 - 3s/epoch - 26ms/step
Epoch 13/50
135/135 - 4s - loss: 3.2252 - accuracy30: 0.4084 - val_loss: 3.2946 - val_accuracy30: 0.3675 - 4s/epoch - 26ms/step
Epoch 14/50
135/135 - 4s - loss: 3.2232 - accuracy30: 0.4072 - val_loss: 3.2876 - val_accuracy30: 0.3754 - 4s/epoch - 26ms/step
Epoch 15/50
135/135 - 3s - loss: 3.2172 - accuracy30: 0.4147 - val_loss: 3.2990 - val_accuracy30: 0.3671 - 3s/epoch - 25ms/step
Epoch 16/50
135/135 - 4s - loss: 3.2123 - accuracy30: 0.4144 - val_loss: 3.2960 - val_accuracy30: 0.3761 - 4s/epoch - 26ms/step
Epoch 17/50
135/135 - 4s - loss: 3.2125 - accuracy30: 0.4160 - val_loss: 3.2946 - val_accuracy30: 0.3712 - 4s/epoch - 26ms/step
Epoch 18/50
135/135 - 3s - loss: 3.2051 - accuracy30: 0.4185 - val_loss: 3.2960 - val_accuracy30: 0.3719 - 3s/epoch - 26ms/step
Epoch 19/50
135/135 - 3s - loss: 3.2004 - accuracy30: 0.4206 - val_loss: 3.2938 - val_accuracy30: 0.3766 - 3s/epoch - 26ms/step
Epoch 20/50
135/135 - 3s - loss: 3.1952 - accuracy30: 0.4252 - val_loss: 3.2957 - val_accuracy30: 0.3708 - 3s/epoch - 26ms/step
Epoch 21/50
135/135 - 3s - loss: 3.1898 - accuracy30: 0.4252 - val_loss: 3.3059 - val_accuracy30: 0.3671 - 3s/epoch - 26ms/step
testing model: results/LILAK/W10/deepOF_L1/h30
Evaluating performance on  test set...
518/518 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0998822
{'0': {'precision': 0.42967412617884154, 'recall': 0.2672383754694336, 'f1-score': 0.3295260601286596, 'support': 51658}, '1': {'precision': 0.269295062584091, 'recall': 0.2004430687059966, 'f1-score': 0.2298230658153413, 'support': 32952}, '2': {'precision': 0.3805711727606683, 'recall': 0.6022293988957182, 'f1-score': 0.4664041825340476, 'support': 47995}, 'accuracy': 0.3718864296218091, 'macro avg': {'precision': 0.35984678717453367, 'recall': 0.3566369476903828, 'f1-score': 0.34191776949268277, 'support': 132605}, 'weighted avg': {'precision': 0.3720480400366942, 'recall': 0.3718864296218091, 'f1-score': 0.35429173575351636, 'support': 132605}}
[[13805  9592 28261]
 [ 7563  6605 18784]
 [10761  8330 28904]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0801265
{'0': {'precision': 0.43120144727040544, 'recall': 0.35240911462863106, 'f1-score': 0.38784398181383106, 'support': 11498}, '1': {'precision': 0.3953488372093023, 'recall': 0.24219505760267346, 'f1-score': 0.30037628837868785, 'support': 11371}, '2': {'precision': 0.37648958681367634, 'recall': 0.5903772266852951, 'f1-score': 0.459775586535192, 'support': 11452}, 'accuracy': 0.39529733982110077, 'macro avg': {'precision': 0.40101329043112804, 'recall': 0.39499379963886655, 'f1-score': 0.3826652855759036, 'support': 34321}, 'weighted avg': {'precision': 0.4010671197462871, 'recall': 0.39529733982110077, 'f1-score': 0.38286643440023627, 'support': 34321}}
[[4052 2112 5334]
 [2754 2754 5863]
 [2591 2100 6761]]
Evaluating performance on  val set...
46/46 - 1s - 595ms/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0961124
{'0': {'precision': 0.39666666666666667, 'recall': 0.327168207948013, 'f1-score': 0.35858101629913713, 'support': 4001}, '1': {'precision': 0.3692373976734166, 'recall': 0.22335157675267137, 'f1-score': 0.2783371224423514, 'support': 3837}, '2': {'precision': 0.3550569213001155, 'recall': 0.5598335067637877, 'f1-score': 0.43452801615345793, 'support': 3844}, 'accuracy': 0.36962848827255607, 'macro avg': {'precision': 0.37365366188006627, 'recall': 0.3701177638214907, 'f1-score': 0.3571487182983155, 'support': 11682}, 'weighted avg': {'precision': 0.373965590967632, 'recall': 0.36962848827255607, 'f1-score': 0.357215192528509, 'support': 11682}}
[[1309  752 1940]
 [1011  857 1969]
 [ 980  712 2152]]
training model: results/LILAK/W10/deepOF_L1/h50
Epoch 1/50
135/135 - 6s - loss: 3.3448 - accuracy50: 0.3359 - val_loss: 3.3201 - val_accuracy50: 0.3400 - 6s/epoch - 44ms/step
Epoch 2/50
135/135 - 4s - loss: 3.3158 - accuracy50: 0.3475 - val_loss: 3.3086 - val_accuracy50: 0.3552 - 4s/epoch - 27ms/step
Epoch 3/50
135/135 - 4s - loss: 3.2948 - accuracy50: 0.3625 - val_loss: 3.3007 - val_accuracy50: 0.3628 - 4s/epoch - 26ms/step
Epoch 4/50
135/135 - 3s - loss: 3.2879 - accuracy50: 0.3699 - val_loss: 3.3076 - val_accuracy50: 0.3571 - 3s/epoch - 26ms/step
Epoch 5/50
135/135 - 3s - loss: 3.2752 - accuracy50: 0.3748 - val_loss: 3.3014 - val_accuracy50: 0.3614 - 3s/epoch - 26ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2730 - accuracy50: 0.3806 - val_loss: 3.2959 - val_accuracy50: 0.3671 - 4s/epoch - 26ms/step
Epoch 7/50
135/135 - 3s - loss: 3.2665 - accuracy50: 0.3837 - val_loss: 3.2960 - val_accuracy50: 0.3680 - 3s/epoch - 25ms/step
Epoch 8/50
135/135 - 4s - loss: 3.2602 - accuracy50: 0.3864 - val_loss: 3.2938 - val_accuracy50: 0.3750 - 4s/epoch - 26ms/step
Epoch 9/50
135/135 - 3s - loss: 3.2567 - accuracy50: 0.3912 - val_loss: 3.2920 - val_accuracy50: 0.3741 - 3s/epoch - 26ms/step
Epoch 10/50
135/135 - 3s - loss: 3.2536 - accuracy50: 0.3939 - val_loss: 3.2977 - val_accuracy50: 0.3666 - 3s/epoch - 25ms/step
Epoch 11/50
135/135 - 4s - loss: 3.2489 - accuracy50: 0.3936 - val_loss: 3.2898 - val_accuracy50: 0.3749 - 4s/epoch - 26ms/step
Epoch 12/50
135/135 - 3s - loss: 3.2423 - accuracy50: 0.3997 - val_loss: 3.2949 - val_accuracy50: 0.3746 - 3s/epoch - 25ms/step
Epoch 13/50
135/135 - 3s - loss: 3.2384 - accuracy50: 0.3986 - val_loss: 3.2935 - val_accuracy50: 0.3748 - 3s/epoch - 25ms/step
Epoch 14/50
135/135 - 3s - loss: 3.2340 - accuracy50: 0.4060 - val_loss: 3.2945 - val_accuracy50: 0.3739 - 3s/epoch - 26ms/step
Epoch 15/50
135/135 - 3s - loss: 3.2295 - accuracy50: 0.4065 - val_loss: 3.2963 - val_accuracy50: 0.3734 - 3s/epoch - 25ms/step
Epoch 16/50
135/135 - 3s - loss: 3.2239 - accuracy50: 0.4102 - val_loss: 3.2958 - val_accuracy50: 0.3752 - 3s/epoch - 26ms/step
Epoch 17/50
135/135 - 4s - loss: 3.2250 - accuracy50: 0.4091 - val_loss: 3.2977 - val_accuracy50: 0.3745 - 4s/epoch - 26ms/step
Epoch 18/50
135/135 - 3s - loss: 3.2196 - accuracy50: 0.4143 - val_loss: 3.3011 - val_accuracy50: 0.3695 - 3s/epoch - 26ms/step
Epoch 19/50
135/135 - 3s - loss: 3.2152 - accuracy50: 0.4146 - val_loss: 3.3079 - val_accuracy50: 0.3701 - 3s/epoch - 26ms/step
Epoch 20/50
135/135 - 3s - loss: 3.2132 - accuracy50: 0.4151 - val_loss: 3.2991 - val_accuracy50: 0.3719 - 3s/epoch - 25ms/step
Epoch 21/50
135/135 - 4s - loss: 3.2049 - accuracy50: 0.4181 - val_loss: 3.3030 - val_accuracy50: 0.3749 - 4s/epoch - 26ms/step
testing model: results/LILAK/W10/deepOF_L1/h50
Evaluating performance on  test set...
518/518 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0958917
{'0': {'precision': 0.42635317295727915, 'recall': 0.31857978537945997, 'f1-score': 0.3646704064211437, 'support': 51626}, '1': {'precision': 0.27059513339196717, 'recall': 0.11221202358519239, 'f1-score': 0.1586387659519615, 'support': 32902}, '2': {'precision': 0.38008334888349815, 'recall': 0.6355013831977869, 'f1-score': 0.47567374009434704, 'support': 48077}, 'accuracy': 0.3822781946382112, 'macro avg': {'precision': 0.3590105517442481, 'recall': 0.35543106405414643, 'f1-score': 0.3329943041558174, 'support': 132605}, 'weighted avg': {'precision': 0.37093093888033585, 'recall': 0.3822781946382112, 'f1-score': 0.35379490578609646, 'support': 132605}}
[[16447  5372 29807]
 [ 9185  3692 20025]
 [12944  4580 30553]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0849764
{'0': {'precision': 0.40786011374246667, 'recall': 0.4148320814987482, 'f1-score': 0.41131655538435197, 'support': 11583}, '1': {'precision': 0.4179419525065963, 'recall': 0.14189733942488578, 'f1-score': 0.21186384003210057, 'support': 11163}, '2': {'precision': 0.3784, 'recall': 0.6129589632829374, 'f1-score': 0.46793075020610064, 'support': 11575}, 'accuracy': 0.39287899536726784, 'macro avg': {'precision': 0.4014006887496877, 'recall': 0.3898961280688571, 'f1-score': 0.36370371520751776, 'support': 34321}, 'weighted avg': {'precision': 0.40120362790449365, 'recall': 0.39287899536726784, 'f1-score': 0.36553754671865335, 'support': 34321}}
[[4805 1132 5646]
 [3570 1584 6009]
 [3406 1074 7095]]
Evaluating performance on  val set...
46/46 - 1s - 544ms/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0974414
{'0': {'precision': 0.382091761223483, 'recall': 0.3849403578528827, 'f1-score': 0.3835107699925724, 'support': 4024}, '1': {'precision': 0.3764523625096824, 'recall': 0.12867355043685463, 'f1-score': 0.191791633780584, 'support': 3777}, '2': {'precision': 0.3534795644626795, 'recall': 0.5771708322597269, 'f1-score': 0.43844196515952244, 'support': 3881}, 'accuracy': 0.3659476117103236, 'macro avg': {'precision': 0.3706745627319483, 'recall': 0.36359491351648804, 'f1-score': 0.3379147896442263, 'support': 11682}, 'weighted avg': {'precision': 0.370762883927583, 'recall': 0.3659476117103236, 'f1-score': 0.3397738063707827, 'support': 11682}}
[[1549  405 2070]
 [1264  486 2027]
 [1241  400 2240]]
training model: results/LILAK/W10/deepOF_L1/h100
Epoch 1/50
135/135 - 6s - loss: 3.3423 - accuracy100: 0.3427 - val_loss: 3.3367 - val_accuracy100: 0.3346 - 6s/epoch - 41ms/step
Epoch 2/50
135/135 - 4s - loss: 3.3217 - accuracy100: 0.3480 - val_loss: 3.3169 - val_accuracy100: 0.3496 - 4s/epoch - 26ms/step
Epoch 3/50
135/135 - 3s - loss: 3.3076 - accuracy100: 0.3554 - val_loss: 3.3138 - val_accuracy100: 0.3541 - 3s/epoch - 26ms/step
Epoch 4/50
135/135 - 4s - loss: 3.2988 - accuracy100: 0.3623 - val_loss: 3.3168 - val_accuracy100: 0.3544 - 4s/epoch - 26ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2932 - accuracy100: 0.3607 - val_loss: 3.3111 - val_accuracy100: 0.3554 - 4s/epoch - 26ms/step
Epoch 6/50
135/135 - 3s - loss: 3.2854 - accuracy100: 0.3701 - val_loss: 3.3104 - val_accuracy100: 0.3580 - 3s/epoch - 26ms/step
Epoch 7/50
135/135 - 3s - loss: 3.2816 - accuracy100: 0.3730 - val_loss: 3.3144 - val_accuracy100: 0.3481 - 3s/epoch - 26ms/step
Epoch 8/50
135/135 - 3s - loss: 3.2755 - accuracy100: 0.3783 - val_loss: 3.3136 - val_accuracy100: 0.3522 - 3s/epoch - 25ms/step
Epoch 9/50
135/135 - 3s - loss: 3.2702 - accuracy100: 0.3781 - val_loss: 3.3134 - val_accuracy100: 0.3550 - 3s/epoch - 25ms/step
Epoch 10/50
135/135 - 3s - loss: 3.2678 - accuracy100: 0.3822 - val_loss: 3.3066 - val_accuracy100: 0.3658 - 3s/epoch - 26ms/step
Epoch 11/50
135/135 - 3s - loss: 3.2650 - accuracy100: 0.3836 - val_loss: 3.3068 - val_accuracy100: 0.3596 - 3s/epoch - 26ms/step
Epoch 12/50
135/135 - 4s - loss: 3.2607 - accuracy100: 0.3865 - val_loss: 3.3189 - val_accuracy100: 0.3511 - 4s/epoch - 26ms/step
Epoch 13/50
135/135 - 3s - loss: 3.2602 - accuracy100: 0.3835 - val_loss: 3.3192 - val_accuracy100: 0.3558 - 3s/epoch - 26ms/step
Epoch 14/50
135/135 - 3s - loss: 3.2551 - accuracy100: 0.3910 - val_loss: 3.3189 - val_accuracy100: 0.3576 - 3s/epoch - 25ms/step
Epoch 15/50
135/135 - 3s - loss: 3.2528 - accuracy100: 0.3916 - val_loss: 3.3162 - val_accuracy100: 0.3601 - 3s/epoch - 25ms/step
Epoch 16/50
135/135 - 3s - loss: 3.2466 - accuracy100: 0.3948 - val_loss: 3.3167 - val_accuracy100: 0.3590 - 3s/epoch - 25ms/step
Epoch 17/50
135/135 - 3s - loss: 3.2459 - accuracy100: 0.3920 - val_loss: 3.3229 - val_accuracy100: 0.3545 - 3s/epoch - 25ms/step
Epoch 18/50
135/135 - 3s - loss: 3.2423 - accuracy100: 0.3975 - val_loss: 3.3229 - val_accuracy100: 0.3582 - 3s/epoch - 25ms/step
Epoch 19/50
135/135 - 3s - loss: 3.2333 - accuracy100: 0.4030 - val_loss: 3.3326 - val_accuracy100: 0.3588 - 3s/epoch - 25ms/step
Epoch 20/50
135/135 - 3s - loss: 3.2344 - accuracy100: 0.4006 - val_loss: 3.3321 - val_accuracy100: 0.3546 - 3s/epoch - 26ms/step
testing model: results/LILAK/W10/deepOF_L1/h100
Evaluating performance on  test set...
518/518 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1087762
{'0': {'precision': 0.44751928073576114, 'recall': 0.19630936227951154, 'f1-score': 0.2729056110258797, 'support': 55275}, '1': {'precision': 0.2147436951303719, 'recall': 0.2380015305564666, 'f1-score': 0.22577522729629756, 'support': 27441}, '2': {'precision': 0.3857976778497659, 'recall': 0.6027581230331336, 'f1-score': 0.4704695151524634, 'support': 49889}, 'accuracy': 0.35785226801402664, 'macro avg': {'precision': 0.349353551238633, 'recall': 0.3456896719563705, 'f1-score': 0.3230501178248802, 'support': 132605}, 'weighted avg': {'precision': 0.3761281273782188, 'recall': 0.35785226801402664, 'f1-score': 0.33748055731785714, 'support': 132605}}
[[10851 12567 31857]
 [ 4893  6531 16017]
 [ 8503 11315 30071]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0906905
{'0': {'precision': 0.42030620467365026, 'recall': 0.22795210208897823, 'f1-score': 0.29559106879746117, 'support': 11441}, '1': {'precision': 0.3685710584272574, 'recall': 0.25194828196953595, 'f1-score': 0.2993004050286676, 'support': 11292}, '2': {'precision': 0.3705937147619748, 'recall': 0.6523127373144633, 'f1-score': 0.47265905893387533, 'support': 11588}, 'accuracy': 0.37912648232860346, 'macro avg': {'precision': 0.38649032595429417, 'recall': 0.3774043737909925, 'f1-score': 0.35585017758666804, 'support': 34321}, 'weighted avg': {'precision': 0.38650003339336225, 'recall': 0.37912648232860346, 'f1-score': 0.356595983992926, 'support': 34321}}
[[2608 2542 6291]
 [1900 2845 6547]
 [1697 2332 7559]]
Evaluating performance on  val set...
46/46 - 1s - 556ms/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1028646
{'0': {'precision': 0.4272237196765499, 'recall': 0.21877156659765357, 'f1-score': 0.2893655864901871, 'support': 4347}, '1': {'precision': 0.29168309026409145, 'recall': 0.2222222222222222, 'f1-score': 0.25225839440940856, 'support': 3330}, '2': {'precision': 0.362191068073421, 'recall': 0.6257178526841448, 'f1-score': 0.45880629805931894, 'support': 4005}, 'accuracy': 0.35927067282999486, 'macro avg': {'precision': 0.3603659593380208, 'recall': 0.35557054716800685, 'f1-score': 0.3334767596529716, 'support': 11682}, 'weighted avg': {'precision': 0.3662918530771647, 'recall': 0.35927067282999486, 'f1-score': 0.33687826413146266, 'support': 11682}}
[[ 951  962 2434]
 [ 611  740 1979]
 [ 664  835 2506]]
training model: results/LILAK/W10/deepOF_L1/h200
Epoch 1/50
135/135 - 6s - loss: 3.3430 - accuracy200: 0.3400 - val_loss: 3.3372 - val_accuracy200: 0.3327 - 6s/epoch - 41ms/step
Epoch 2/50
135/135 - 4s - loss: 3.3224 - accuracy200: 0.3422 - val_loss: 3.3213 - val_accuracy200: 0.3394 - 4s/epoch - 26ms/step
Epoch 3/50
135/135 - 3s - loss: 3.3096 - accuracy200: 0.3493 - val_loss: 3.3121 - val_accuracy200: 0.3386 - 3s/epoch - 26ms/step
Epoch 4/50
135/135 - 3s - loss: 3.3037 - accuracy200: 0.3528 - val_loss: 3.3164 - val_accuracy200: 0.3377 - 3s/epoch - 26ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2956 - accuracy200: 0.3599 - val_loss: 3.3119 - val_accuracy200: 0.3452 - 4s/epoch - 27ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2898 - accuracy200: 0.3618 - val_loss: 3.3094 - val_accuracy200: 0.3441 - 4s/epoch - 27ms/step
Epoch 7/50
135/135 - 4s - loss: 3.2871 - accuracy200: 0.3628 - val_loss: 3.3095 - val_accuracy200: 0.3391 - 4s/epoch - 26ms/step
Epoch 8/50
135/135 - 3s - loss: 3.2822 - accuracy200: 0.3702 - val_loss: 3.3114 - val_accuracy200: 0.3474 - 3s/epoch - 26ms/step
Epoch 9/50
135/135 - 3s - loss: 3.2829 - accuracy200: 0.3676 - val_loss: 3.3130 - val_accuracy200: 0.3427 - 3s/epoch - 25ms/step
Epoch 10/50
135/135 - 4s - loss: 3.2750 - accuracy200: 0.3748 - val_loss: 3.3062 - val_accuracy200: 0.3487 - 4s/epoch - 26ms/step
Epoch 11/50
135/135 - 4s - loss: 3.2732 - accuracy200: 0.3796 - val_loss: 3.3100 - val_accuracy200: 0.3498 - 4s/epoch - 26ms/step
Epoch 12/50
135/135 - 4s - loss: 3.2663 - accuracy200: 0.3818 - val_loss: 3.3080 - val_accuracy200: 0.3522 - 4s/epoch - 26ms/step
Epoch 13/50
135/135 - 3s - loss: 3.2658 - accuracy200: 0.3824 - val_loss: 3.3097 - val_accuracy200: 0.3507 - 3s/epoch - 25ms/step
Epoch 14/50
135/135 - 4s - loss: 3.2649 - accuracy200: 0.3794 - val_loss: 3.3068 - val_accuracy200: 0.3500 - 4s/epoch - 26ms/step
Epoch 15/50
135/135 - 3s - loss: 3.2624 - accuracy200: 0.3826 - val_loss: 3.3130 - val_accuracy200: 0.3485 - 3s/epoch - 25ms/step
Epoch 16/50
135/135 - 3s - loss: 3.2574 - accuracy200: 0.3871 - val_loss: 3.3163 - val_accuracy200: 0.3452 - 3s/epoch - 25ms/step
Epoch 17/50
135/135 - 3s - loss: 3.2558 - accuracy200: 0.3896 - val_loss: 3.3131 - val_accuracy200: 0.3494 - 3s/epoch - 25ms/step
Epoch 18/50
135/135 - 3s - loss: 3.2505 - accuracy200: 0.3928 - val_loss: 3.3125 - val_accuracy200: 0.3524 - 3s/epoch - 25ms/step
Epoch 19/50
135/135 - 3s - loss: 3.2451 - accuracy200: 0.3985 - val_loss: 3.3127 - val_accuracy200: 0.3520 - 3s/epoch - 26ms/step
Epoch 20/50
135/135 - 3s - loss: 3.2442 - accuracy200: 0.3990 - val_loss: 3.3207 - val_accuracy200: 0.3495 - 3s/epoch - 25ms/step
testing model: results/LILAK/W10/deepOF_L1/h200
Evaluating performance on  test set...
518/518 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1061664
{'0': {'precision': 0.40108784506068035, 'recall': 0.24551105636919998, 'f1-score': 0.3045829503265009, 'support': 51961}, '1': {'precision': 0.27365106626592245, 'recall': 0.15578913061191232, 'f1-score': 0.19854620976116305, 'support': 36819}, '2': {'precision': 0.33540419349182093, 'recall': 0.6110211066742727, 'f1-score': 0.4330802260983479, 'support': 43825}, 'accuracy': 0.34139738320576146, 'macro avg': {'precision': 0.33671436827280793, 'recall': 0.3374404312184616, 'f1-score': 0.3120697953953373, 'support': 132605}, 'weighted avg': {'precision': 0.3439958742567932, 'recall': 0.34139738320576146, 'f1-score': 0.31760829899228293, 'support': 132605}}
[[12757  8328 30876]
 [ 8899  5736 22184]
 [10150  6897 26778]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.094156
{'0': {'precision': 0.389919406421901, 'recall': 0.2643767889669529, 'f1-score': 0.3151038974465006, 'support': 11529}, '1': {'precision': 0.36808957312806156, 'recall': 0.18635961027457928, 'f1-score': 0.24744207926614137, 'support': 11290}, '2': {'precision': 0.35765826438329806, 'recall': 0.6464093201182403, 'f1-score': 0.46051409104986063, 'support': 11502}, 'accuracy': 0.3667433932577722, 'macro avg': {'precision': 0.37188908131108683, 'recall': 0.3657152397865908, 'f1-score': 0.34102002258750086, 'support': 34321}, 'weighted avg': {'precision': 0.3719267350657209, 'recall': 0.3667433932577722, 'f1-score': 0.34157766334987144, 'support': 34321}}
[[3048 1858 6623]
 [2456 2104 6730]
 [2313 1754 7435]]
Evaluating performance on  val set...
46/46 - 1s - 571ms/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1029699
{'0': {'precision': 0.40460411580048833, 'recall': 0.2642369020501139, 'f1-score': 0.3196913325065454, 'support': 4390}, '1': {'precision': 0.30011135857461024, 'recall': 0.1574642126789366, 'f1-score': 0.2065529794979881, 'support': 3423}, '2': {'precision': 0.34264140190910386, 'recall': 0.6216076505556991, 'f1-score': 0.44177075679647315, 'support': 3869}, 'accuracy': 0.35130970724191063, 'macro avg': {'precision': 0.34911895876140076, 'recall': 0.34776958842824984, 'f1-score': 0.32267168960033554, 'support': 11682}, 'weighted avg': {'precision': 0.35346454654608433, 'recall': 0.35130970724191063, 'f1-score': 0.32697199593998477, 'support': 11682}}
[[1160  680 2550]
 [ 820  539 2064]
 [ 887  577 2405]]
training model: results/LILAK/W10/deepOF_L1/h300
Epoch 1/50
135/135 - 6s - loss: 3.3433 - accuracy300: 0.3413 - val_loss: 3.3570 - val_accuracy300: 0.3189 - 6s/epoch - 44ms/step
Epoch 2/50
135/135 - 4s - loss: 3.3271 - accuracy300: 0.3445 - val_loss: 3.3337 - val_accuracy300: 0.3291 - 4s/epoch - 26ms/step
Epoch 3/50
135/135 - 3s - loss: 3.3121 - accuracy300: 0.3488 - val_loss: 3.3308 - val_accuracy300: 0.3270 - 3s/epoch - 26ms/step
Epoch 4/50
135/135 - 3s - loss: 3.3060 - accuracy300: 0.3549 - val_loss: 3.3276 - val_accuracy300: 0.3315 - 3s/epoch - 26ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2996 - accuracy300: 0.3538 - val_loss: 3.3251 - val_accuracy300: 0.3377 - 4s/epoch - 27ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2929 - accuracy300: 0.3628 - val_loss: 3.3201 - val_accuracy300: 0.3361 - 4s/epoch - 27ms/step
Epoch 7/50
135/135 - 4s - loss: 3.2890 - accuracy300: 0.3632 - val_loss: 3.3249 - val_accuracy300: 0.3300 - 4s/epoch - 26ms/step
Epoch 8/50
135/135 - 3s - loss: 3.2846 - accuracy300: 0.3681 - val_loss: 3.3265 - val_accuracy300: 0.3244 - 3s/epoch - 26ms/step
Epoch 9/50
135/135 - 4s - loss: 3.2840 - accuracy300: 0.3660 - val_loss: 3.3294 - val_accuracy300: 0.3279 - 4s/epoch - 26ms/step
Epoch 10/50
135/135 - 4s - loss: 3.2779 - accuracy300: 0.3725 - val_loss: 3.3253 - val_accuracy300: 0.3273 - 4s/epoch - 26ms/step
Epoch 11/50
135/135 - 3s - loss: 3.2756 - accuracy300: 0.3744 - val_loss: 3.3259 - val_accuracy300: 0.3260 - 3s/epoch - 26ms/step
Epoch 12/50
135/135 - 4s - loss: 3.2710 - accuracy300: 0.3801 - val_loss: 3.3241 - val_accuracy300: 0.3267 - 4s/epoch - 26ms/step
Epoch 13/50
135/135 - 4s - loss: 3.2707 - accuracy300: 0.3758 - val_loss: 3.3181 - val_accuracy300: 0.3333 - 4s/epoch - 26ms/step
Epoch 14/50
135/135 - 4s - loss: 3.2668 - accuracy300: 0.3818 - val_loss: 3.3318 - val_accuracy300: 0.3263 - 4s/epoch - 26ms/step
Epoch 15/50
135/135 - 3s - loss: 3.2651 - accuracy300: 0.3801 - val_loss: 3.3352 - val_accuracy300: 0.3336 - 3s/epoch - 26ms/step
Epoch 16/50
135/135 - 4s - loss: 3.2620 - accuracy300: 0.3838 - val_loss: 3.3307 - val_accuracy300: 0.3289 - 4s/epoch - 26ms/step
Epoch 17/50
135/135 - 4s - loss: 3.2584 - accuracy300: 0.3845 - val_loss: 3.3322 - val_accuracy300: 0.3347 - 4s/epoch - 26ms/step
Epoch 18/50
135/135 - 3s - loss: 3.2547 - accuracy300: 0.3901 - val_loss: 3.3330 - val_accuracy300: 0.3333 - 3s/epoch - 26ms/step
Epoch 19/50
135/135 - 3s - loss: 3.2517 - accuracy300: 0.3884 - val_loss: 3.3434 - val_accuracy300: 0.3289 - 3s/epoch - 26ms/step
Epoch 20/50
135/135 - 4s - loss: 3.2488 - accuracy300: 0.3949 - val_loss: 3.3427 - val_accuracy300: 0.3298 - 4s/epoch - 26ms/step
Epoch 21/50
135/135 - 4s - loss: 3.2457 - accuracy300: 0.3950 - val_loss: 3.3401 - val_accuracy300: 0.3340 - 4s/epoch - 26ms/step
Epoch 22/50
135/135 - 3s - loss: 3.2401 - accuracy300: 0.3969 - val_loss: 3.3500 - val_accuracy300: 0.3283 - 3s/epoch - 25ms/step
Epoch 23/50
135/135 - 4s - loss: 3.2407 - accuracy300: 0.3974 - val_loss: 3.3524 - val_accuracy300: 0.3307 - 4s/epoch - 26ms/step
testing model: results/LILAK/W10/deepOF_L1/h300
Evaluating performance on  test set...
518/518 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1139547
{'0': {'precision': 0.4169599648042235, 'recall': 0.1411576340923054, 'f1-score': 0.21091283363700847, 'support': 53713}, '1': {'precision': 0.25661395677284304, 'recall': 0.3020094387225075, 'f1-score': 0.277467208420823, 'support': 33691}, '2': {'precision': 0.34422896883776916, 'recall': 0.5694121811464348, 'f1-score': 0.429070358670012, 'support': 45201}, 'accuracy': 0.32800422306851174, 'macro avg': {'precision': 0.3392676301382786, 'recall': 0.33752641798708255, 'f1-score': 0.3058168002426145, 'support': 132605}, 'weighted avg': {'precision': 0.35142901872176097, 'recall': 0.32800422306851174, 'f1-score': 0.30218557395493234, 'support': 132605}}
[[ 7582 16077 30054]
 [ 4538 10175 18978]
 [ 6064 13399 25738]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0930527
{'0': {'precision': 0.42328941776455586, 'recall': 0.17185747562764214, 'f1-score': 0.24446217095170894, 'support': 11591}, '1': {'precision': 0.36878154289834175, 'recall': 0.35828736537956396, 'f1-score': 0.36345872007816316, 'support': 11421}, '2': {'precision': 0.36362654570981157, 'recall': 0.5954549473870369, 'f1-score': 0.4515220598095749, 'support': 11309}, 'accuracy': 0.37347396637627106, 'macro avg': {'precision': 0.3852325021242364, 'recall': 0.3751999294647477, 'f1-score': 0.35314765027981565, 'support': 34321}, 'weighted avg': {'precision': 0.38549151388896563, 'recall': 0.37347396637627106, 'f1-score': 0.3522882794761354, 'support': 34321}}
[[1992 3766 5833]
 [1377 4092 5952]
 [1337 3238 6734]]
Evaluating performance on  val set...
46/46 - 1s - 569ms/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1100398
{'0': {'precision': 0.4145896656534954, 'recall': 0.14676135140951152, 'f1-score': 0.21678321678321677, 'support': 4647}, '1': {'precision': 0.26414573557825005, 'recall': 0.31142206313049137, 'f1-score': 0.28584229390681, 'support': 3073}, '2': {'precision': 0.34471468662301213, 'recall': 0.5580514891468955, 'f1-score': 0.42617579028527364, 'support': 3962}, 'accuracy': 0.3295668549905838, 'macro avg': {'precision': 0.3411500292849192, 'recall': 0.33874496789563285, 'f1-score': 0.3096004336584335, 'support': 11682}, 'weighted avg': {'precision': 0.3513163508067223, 'recall': 0.3295668549905838, 'f1-score': 0.3059658841531835, 'support': 11682}}
[[ 682 1449 2516]
 [ 429  957 1687]
 [ 534 1217 2211]]
training model: results/LILAK/W10/deepOF_L1/h500
Epoch 1/50
135/135 - 6s - loss: 3.3464 - accuracy500: 0.3408 - val_loss: 3.3369 - val_accuracy500: 0.3315 - 6s/epoch - 41ms/step
Epoch 2/50
135/135 - 3s - loss: 3.3267 - accuracy500: 0.3439 - val_loss: 3.3407 - val_accuracy500: 0.3258 - 3s/epoch - 26ms/step
Epoch 3/50
135/135 - 4s - loss: 3.3121 - accuracy500: 0.3495 - val_loss: 3.3296 - val_accuracy500: 0.3314 - 4s/epoch - 27ms/step
Epoch 4/50
135/135 - 3s - loss: 3.3075 - accuracy500: 0.3519 - val_loss: 3.3214 - val_accuracy500: 0.3282 - 3s/epoch - 26ms/step
Epoch 5/50
135/135 - 3s - loss: 3.3010 - accuracy500: 0.3567 - val_loss: 3.3215 - val_accuracy500: 0.3299 - 3s/epoch - 25ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2917 - accuracy500: 0.3611 - val_loss: 3.3197 - val_accuracy500: 0.3328 - 4s/epoch - 26ms/step
Epoch 7/50
135/135 - 4s - loss: 3.2917 - accuracy500: 0.3629 - val_loss: 3.3188 - val_accuracy500: 0.3273 - 4s/epoch - 26ms/step
Epoch 8/50
135/135 - 3s - loss: 3.2873 - accuracy500: 0.3660 - val_loss: 3.3234 - val_accuracy500: 0.3249 - 3s/epoch - 26ms/step
Epoch 9/50
135/135 - 3s - loss: 3.2839 - accuracy500: 0.3699 - val_loss: 3.3263 - val_accuracy500: 0.3232 - 3s/epoch - 26ms/step
Epoch 10/50
135/135 - 3s - loss: 3.2804 - accuracy500: 0.3698 - val_loss: 3.3226 - val_accuracy500: 0.3294 - 3s/epoch - 26ms/step
Epoch 11/50
135/135 - 3s - loss: 3.2779 - accuracy500: 0.3731 - val_loss: 3.3201 - val_accuracy500: 0.3302 - 3s/epoch - 26ms/step
Epoch 12/50
135/135 - 3s - loss: 3.2733 - accuracy500: 0.3771 - val_loss: 3.3268 - val_accuracy500: 0.3269 - 3s/epoch - 26ms/step
Epoch 13/50
135/135 - 4s - loss: 3.2698 - accuracy500: 0.3806 - val_loss: 3.3189 - val_accuracy500: 0.3343 - 4s/epoch - 26ms/step
Epoch 14/50
135/135 - 4s - loss: 3.2686 - accuracy500: 0.3800 - val_loss: 3.3242 - val_accuracy500: 0.3265 - 4s/epoch - 26ms/step
Epoch 15/50
135/135 - 3s - loss: 3.2648 - accuracy500: 0.3824 - val_loss: 3.3303 - val_accuracy500: 0.3263 - 3s/epoch - 26ms/step
Epoch 16/50
135/135 - 3s - loss: 3.2624 - accuracy500: 0.3831 - val_loss: 3.3317 - val_accuracy500: 0.3225 - 3s/epoch - 25ms/step
Epoch 17/50
135/135 - 4s - loss: 3.2606 - accuracy500: 0.3853 - val_loss: 3.3300 - val_accuracy500: 0.3227 - 4s/epoch - 26ms/step
testing model: results/LILAK/W10/deepOF_L1/h500
Evaluating performance on  test set...
518/518 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1078479
{'0': {'precision': 0.3955234191498181, 'recall': 0.16249456017861535, 'f1-score': 0.23035244890295586, 'support': 52851}, '1': {'precision': 0.2707298433320596, 'recall': 0.11808333333333333, 'f1-score': 0.1644423813392132, 'support': 36000}, '2': {'precision': 0.3295094022481353, 'recall': 0.7168716003108287, 'f1-score': 0.45149124827268544, 'support': 43754}, 'accuracy': 0.33335847064590324, 'macro avg': {'precision': 0.3319208882433377, 'recall': 0.3324831646075925, 'f1-score': 0.2820953595049515, 'support': 132605}, 'weighted avg': {'precision': 0.3398622749625285, 'recall': 0.33335847064590324, 'f1-score': 0.2854253691950143, 'support': 132605}}
[[ 8588  6188 38075]
 [ 6000  4251 25749]
 [ 7125  5263 31366]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018068
{'0': {'precision': 0.37896253602305474, 'recall': 0.17985980509488803, 'f1-score': 0.24394202898550726, 'support': 11698}, '1': {'precision': 0.38340399757722593, 'recall': 0.11193633952254642, 'f1-score': 0.17328223378045443, 'support': 11310}, '2': {'precision': 0.3387521105744689, 'recall': 0.7625740298771325, 'f1-score': 0.4691136487221316, 'support': 11313}, 'accuracy': 0.34955275195944174, 'macro avg': {'precision': 0.36703954805824984, 'recall': 0.3514567248315223, 'f1-score': 0.2954459704960311, 'support': 34321}, 'weighted avg': {'precision': 0.36717186521153483, 'recall': 0.34955275195944174, 'f1-score': 0.2948788970928259, 'support': 34321}}
[[2104 1038 8556]
 [1760 1266 8284]
 [1688  998 8627]]
Evaluating performance on  val set...
46/46 - 1s - 572ms/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.107496
{'0': {'precision': 0.40928495197438636, 'recall': 0.16706599869309519, 'f1-score': 0.23727764887857697, 'support': 4591}, '1': {'precision': 0.2906857727737973, 'recall': 0.08432304038004751, 'f1-score': 0.13072497123130034, 'support': 3368}, '2': {'precision': 0.3198958215377647, 'recall': 0.7587966693526725, 'f1-score': 0.45005575912059903, 'support': 3723}, 'accuracy': 0.3317925012840267, 'macro avg': {'precision': 0.3399555154286495, 'recall': 0.33672856947527174, 'f1-score': 0.27268612641015877, 'support': 11682}, 'weighted avg': {'precision': 0.346604095257803, 'recall': 0.3317925012840267, 'f1-score': 0.2743691987942609, 'support': 11682}}
[[ 767  373 3451]
 [ 529  284 2555]
 [ 578  320 2825]]
training model: results/LILAK/W10/deepOF_L1/h1000
Epoch 1/50
135/135 - 6s - loss: 3.3492 - accuracy1000: 0.3399 - val_loss: 3.3616 - val_accuracy1000: 0.3121 - 6s/epoch - 42ms/step
Epoch 2/50
135/135 - 3s - loss: 3.3292 - accuracy1000: 0.3404 - val_loss: 3.3627 - val_accuracy1000: 0.3029 - 3s/epoch - 26ms/step
Epoch 3/50
135/135 - 4s - loss: 3.3163 - accuracy1000: 0.3480 - val_loss: 3.3575 - val_accuracy1000: 0.3029 - 4s/epoch - 26ms/step
Epoch 4/50
135/135 - 4s - loss: 3.3088 - accuracy1000: 0.3473 - val_loss: 3.3539 - val_accuracy1000: 0.3040 - 4s/epoch - 27ms/step
Epoch 5/50
135/135 - 4s - loss: 3.3028 - accuracy1000: 0.3568 - val_loss: 3.3532 - val_accuracy1000: 0.3034 - 4s/epoch - 26ms/step
Epoch 6/50
135/135 - 4s - loss: 3.3036 - accuracy1000: 0.3548 - val_loss: 3.3470 - val_accuracy1000: 0.3026 - 4s/epoch - 26ms/step
Epoch 7/50
135/135 - 3s - loss: 3.2957 - accuracy1000: 0.3601 - val_loss: 3.3479 - val_accuracy1000: 0.3042 - 3s/epoch - 26ms/step
Epoch 8/50
135/135 - 3s - loss: 3.2922 - accuracy1000: 0.3616 - val_loss: 3.3517 - val_accuracy1000: 0.3024 - 3s/epoch - 26ms/step
Epoch 9/50
135/135 - 4s - loss: 3.2860 - accuracy1000: 0.3657 - val_loss: 3.3527 - val_accuracy1000: 0.2974 - 4s/epoch - 26ms/step
Epoch 10/50
135/135 - 3s - loss: 3.2872 - accuracy1000: 0.3641 - val_loss: 3.3495 - val_accuracy1000: 0.3012 - 3s/epoch - 26ms/step
Epoch 11/50
135/135 - 4s - loss: 3.2811 - accuracy1000: 0.3688 - val_loss: 3.3440 - val_accuracy1000: 0.3059 - 4s/epoch - 26ms/step
Epoch 12/50
135/135 - 3s - loss: 3.2781 - accuracy1000: 0.3730 - val_loss: 3.3481 - val_accuracy1000: 0.3038 - 3s/epoch - 25ms/step
Epoch 13/50
135/135 - 3s - loss: 3.2755 - accuracy1000: 0.3748 - val_loss: 3.3509 - val_accuracy1000: 0.2992 - 3s/epoch - 26ms/step
Epoch 14/50
135/135 - 4s - loss: 3.2703 - accuracy1000: 0.3793 - val_loss: 3.3531 - val_accuracy1000: 0.2959 - 4s/epoch - 26ms/step
Epoch 15/50
135/135 - 3s - loss: 3.2691 - accuracy1000: 0.3794 - val_loss: 3.3529 - val_accuracy1000: 0.3023 - 3s/epoch - 26ms/step
Epoch 16/50
135/135 - 3s - loss: 3.2655 - accuracy1000: 0.3833 - val_loss: 3.3580 - val_accuracy1000: 0.3019 - 3s/epoch - 25ms/step
Epoch 17/50
135/135 - 4s - loss: 3.2636 - accuracy1000: 0.3845 - val_loss: 3.3548 - val_accuracy1000: 0.3030 - 4s/epoch - 26ms/step
Epoch 18/50
135/135 - 4s - loss: 3.2642 - accuracy1000: 0.3825 - val_loss: 3.3563 - val_accuracy1000: 0.2973 - 4s/epoch - 26ms/step
Epoch 19/50
135/135 - 3s - loss: 3.2574 - accuracy1000: 0.3883 - val_loss: 3.3565 - val_accuracy1000: 0.3050 - 3s/epoch - 26ms/step
Epoch 20/50
135/135 - 4s - loss: 3.2578 - accuracy1000: 0.3888 - val_loss: 3.3614 - val_accuracy1000: 0.2998 - 4s/epoch - 26ms/step
Epoch 21/50
135/135 - 4s - loss: 3.2524 - accuracy1000: 0.3937 - val_loss: 3.3601 - val_accuracy1000: 0.3081 - 4s/epoch - 26ms/step
testing model: results/LILAK/W10/deepOF_L1/h1000
Evaluating performance on  test set...
518/518 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1139528
{'0': {'precision': 0.40372062663185376, 'recall': 0.1160129799486054, 'f1-score': 0.18023399822242944, 'support': 53313}, '1': {'precision': 0.29815692940860694, 'recall': 0.16960582232740412, 'f1-score': 0.21621709299119235, 'support': 39297}, '2': {'precision': 0.3048740664271945, 'recall': 0.7236404550568821, 'f1-score': 0.4290055289566132, 'support': 39995}, 'accuracy': 0.3151615700765431, 'macro avg': {'precision': 0.33558387415588503, 'recall': 0.33641975244429717, 'f1-score': 0.2751522067234116, 'support': 132605}, 'weighted avg': {'precision': 0.3426241009716805, 'recall': 0.3151615700765431, 'f1-score': 0.2659294474652314, 'support': 132605}}
[[ 6185  9246 37882]
 [ 4525  6665 28107]
 [ 4610  6443 28942]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0967721
{'0': {'precision': 0.39404594467885606, 'recall': 0.14481392143349414, 'f1-score': 0.21179286884213175, 'support': 11608}, '1': {'precision': 0.37316798196166856, 'recall': 0.17659612306597902, 'f1-score': 0.2397392563978754, 'support': 11246}, '2': {'precision': 0.3483604900335584, 'recall': 0.751373506584111, 'f1-score': 0.4760220994475138, 'support': 11467}, 'accuracy': 0.35788584248710703, 'macro avg': {'precision': 0.37185813889136105, 'recall': 0.3575945170278614, 'f1-score': 0.309184741562507, 'support': 34321}, 'weighted avg': {'precision': 0.3719408580807057, 'recall': 0.35788584248710703, 'f1-score': 0.30923180307492826, 'support': 34321}}
[[1681 1728 8199]
 [1342 1986 7918]
 [1243 1608 8616]]
Evaluating performance on  val set...
46/46 - 1s - 572ms/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1160295
{'0': {'precision': 0.41631799163179917, 'recall': 0.12797427652733118, 'f1-score': 0.19576979832759467, 'support': 4665}, '1': {'precision': 0.3109919571045576, 'recall': 0.15512169029152179, 'f1-score': 0.20699500356887934, 'support': 3739}, '2': {'precision': 0.2834307527138256, 'recall': 0.7248322147651006, 'f1-score': 0.4075122202212503, 'support': 3278}, 'accuracy': 0.3041431261770245, 'macro avg': {'precision': 0.33691356715006077, 'recall': 0.3359760605279845, 'f1-score': 0.2700923407059081, 'support': 11682}, 'weighted avg': {'precision': 0.3453182987478346, 'recall': 0.3041431261770245, 'f1-score': 0.25877807613658, 'support': 11682}}
[[ 597  775 3293]
 [ 445  580 2714]
 [ 392  510 2376]]
training model: results/LILAK/W10/deepLOB_L2/h10
Epoch 1/50
135/135 - 10s - loss: 3.3750 - accuracy10: 0.3367 - val_loss: 3.3760 - val_accuracy10: 0.3343 - 10s/epoch - 74ms/step
Epoch 2/50
135/135 - 7s - loss: 3.3225 - accuracy10: 0.3563 - val_loss: 3.3644 - val_accuracy10: 0.3398 - 7s/epoch - 53ms/step
Epoch 3/50
135/135 - 7s - loss: 3.2879 - accuracy10: 0.3736 - val_loss: 3.3829 - val_accuracy10: 0.3412 - 7s/epoch - 51ms/step
Epoch 4/50
135/135 - 7s - loss: 3.2618 - accuracy10: 0.3914 - val_loss: 3.3478 - val_accuracy10: 0.3497 - 7s/epoch - 52ms/step
Epoch 5/50
135/135 - 7s - loss: 3.2245 - accuracy10: 0.4145 - val_loss: 3.3907 - val_accuracy10: 0.3439 - 7s/epoch - 51ms/step
Epoch 6/50
135/135 - 7s - loss: 3.1917 - accuracy10: 0.4323 - val_loss: 3.3440 - val_accuracy10: 0.3697 - 7s/epoch - 51ms/step
Epoch 7/50
135/135 - 7s - loss: 3.1590 - accuracy10: 0.4458 - val_loss: 3.3817 - val_accuracy10: 0.3737 - 7s/epoch - 50ms/step
Epoch 8/50
135/135 - 7s - loss: 3.1293 - accuracy10: 0.4621 - val_loss: 3.3138 - val_accuracy10: 0.3856 - 7s/epoch - 51ms/step
Epoch 9/50
135/135 - 7s - loss: 3.0667 - accuracy10: 0.4859 - val_loss: 3.3852 - val_accuracy10: 0.4036 - 7s/epoch - 51ms/step
Epoch 10/50
135/135 - 7s - loss: 3.0261 - accuracy10: 0.4987 - val_loss: 3.3142 - val_accuracy10: 0.4015 - 7s/epoch - 51ms/step
Epoch 11/50
135/135 - 7s - loss: 2.9848 - accuracy10: 0.5127 - val_loss: 3.3300 - val_accuracy10: 0.4081 - 7s/epoch - 52ms/step
Epoch 12/50
135/135 - 7s - loss: 2.9695 - accuracy10: 0.5155 - val_loss: 3.3756 - val_accuracy10: 0.3997 - 7s/epoch - 51ms/step
Epoch 13/50
135/135 - 7s - loss: 2.9413 - accuracy10: 0.5281 - val_loss: 3.3460 - val_accuracy10: 0.4002 - 7s/epoch - 52ms/step
Epoch 14/50
135/135 - 7s - loss: 2.9050 - accuracy10: 0.5355 - val_loss: 3.2783 - val_accuracy10: 0.4217 - 7s/epoch - 53ms/step
Epoch 15/50
135/135 - 7s - loss: 2.8848 - accuracy10: 0.5411 - val_loss: 3.3014 - val_accuracy10: 0.4176 - 7s/epoch - 53ms/step
Epoch 16/50
135/135 - 7s - loss: 2.8570 - accuracy10: 0.5473 - val_loss: 3.2944 - val_accuracy10: 0.4296 - 7s/epoch - 52ms/step
Epoch 17/50
135/135 - 7s - loss: 2.8315 - accuracy10: 0.5531 - val_loss: 3.2932 - val_accuracy10: 0.4225 - 7s/epoch - 53ms/step
Epoch 18/50
135/135 - 7s - loss: 2.8035 - accuracy10: 0.5600 - val_loss: 3.3063 - val_accuracy10: 0.4248 - 7s/epoch - 53ms/step
Epoch 19/50
135/135 - 7s - loss: 2.7793 - accuracy10: 0.5663 - val_loss: 3.3216 - val_accuracy10: 0.4213 - 7s/epoch - 52ms/step
Epoch 20/50
135/135 - 7s - loss: 2.7573 - accuracy10: 0.5677 - val_loss: 3.3379 - val_accuracy10: 0.4194 - 7s/epoch - 52ms/step
Epoch 21/50
135/135 - 7s - loss: 2.7386 - accuracy10: 0.5750 - val_loss: 3.3468 - val_accuracy10: 0.4200 - 7s/epoch - 52ms/step
Epoch 22/50
135/135 - 7s - loss: 2.7132 - accuracy10: 0.5816 - val_loss: 3.3652 - val_accuracy10: 0.4245 - 7s/epoch - 52ms/step
Epoch 23/50
135/135 - 7s - loss: 2.6915 - accuracy10: 0.5845 - val_loss: 3.4019 - val_accuracy10: 0.4220 - 7s/epoch - 53ms/step
Epoch 24/50
135/135 - 7s - loss: 2.6691 - accuracy10: 0.5863 - val_loss: 3.3974 - val_accuracy10: 0.4198 - 7s/epoch - 53ms/step
testing model: results/LILAK/W10/deepLOB_L2/h10
Evaluating performance on  test set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0607693
{'0': {'precision': 0.4659957252730608, 'recall': 0.5444588642441404, 'f1-score': 0.5021809113579687, 'support': 50856}, '1': {'precision': 0.39433266420802016, 'recall': 0.24165355457016163, 'f1-score': 0.2996665247623102, 'support': 34955}, '2': {'precision': 0.45151632219432103, 'recall': 0.49947648454026794, 'f1-score': 0.47428704765189866, 'support': 46799}, 'accuracy': 0.4487670613075937, 'macro avg': {'precision': 0.43728157055846734, 'recall': 0.4285296344515233, 'f1-score': 0.4253781612573926, 'support': 132610}, 'weighted avg': {'precision': 0.44199599761895897, 'recall': 0.4487670613075937, 'f1-score': 0.43895569975227067, 'support': 132610}}
[[27689  7227 15940]
 [14053  8447 12455]
 [17677  5747 23375]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9931182
{'0': {'precision': 0.49978258979041656, 'recall': 0.5167700746335762, 'f1-score': 0.5081343943412909, 'support': 11121}, '1': {'precision': 0.512124849939976, 'recall': 0.5557099435518889, 'f1-score': 0.5330279050395669, 'support': 11515}, '2': {'precision': 0.5139897376319101, 'recall': 0.45426542311970564, 'f1-score': 0.48228561046511625, 'support': 11687}, 'accuracy': 0.508551117326574, 'macro avg': {'precision': 0.5086323924541009, 'recall': 0.5089151471017236, 'f1-score': 0.5078159699486581, 'support': 34323}, 'weighted avg': {'precision': 0.5087608277779384, 'recall': 0.508551117326574, 'f1-score': 0.5076843765261172, 'support': 34323}}
[[5747 2921 2453]
 [2549 6399 2567]
 [3203 3175 5309]]
Evaluating performance on  val set...
46/46 - 1s - 989ms/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0968704
{'0': {'precision': 0.4121863799283154, 'recall': 0.48625792811839325, 'f1-score': 0.446168768186227, 'support': 3784}, '1': {'precision': 0.42227848101265825, 'recall': 0.40792369772560527, 'f1-score': 0.4149769871874611, 'support': 4089}, '2': {'precision': 0.44369645042839656, 'recall': 0.38067734313468105, 'f1-score': 0.4097781545852763, 'support': 3809}, 'accuracy': 0.4244136278034583, 'macro avg': {'precision': 0.4260537704564567, 'recall': 0.42495298965955985, 'f1-score': 0.4236413033196548, 'support': 11682}, 'weighted avg': {'precision': 0.4259929592699253, 'recall': 0.4244136278034583, 'f1-score': 0.42338542289347103, 'support': 11682}}
[[1840 1160  784]
 [1387 1668 1034]
 [1237 1122 1450]]
training model: results/LILAK/W10/deepLOB_L2/h20
Epoch 1/50
135/135 - 9s - loss: 3.3851 - accuracy20: 0.3312 - val_loss: 3.3892 - val_accuracy20: 0.3382 - 9s/epoch - 68ms/step
Epoch 2/50
135/135 - 7s - loss: 3.3224 - accuracy20: 0.3558 - val_loss: 3.3630 - val_accuracy20: 0.3419 - 7s/epoch - 52ms/step
Epoch 3/50
135/135 - 7s - loss: 3.3045 - accuracy20: 0.3642 - val_loss: 3.3369 - val_accuracy20: 0.3501 - 7s/epoch - 52ms/step
Epoch 4/50
135/135 - 7s - loss: 3.2779 - accuracy20: 0.3816 - val_loss: 3.3320 - val_accuracy20: 0.3617 - 7s/epoch - 52ms/step
Epoch 5/50
135/135 - 7s - loss: 3.2520 - accuracy20: 0.3965 - val_loss: 3.3225 - val_accuracy20: 0.3697 - 7s/epoch - 53ms/step
Epoch 6/50
135/135 - 7s - loss: 3.2269 - accuracy20: 0.4118 - val_loss: 3.3246 - val_accuracy20: 0.3792 - 7s/epoch - 53ms/step
Epoch 7/50
135/135 - 7s - loss: 3.2120 - accuracy20: 0.4225 - val_loss: 3.3262 - val_accuracy20: 0.3793 - 7s/epoch - 52ms/step
Epoch 8/50
135/135 - 7s - loss: 3.1706 - accuracy20: 0.4429 - val_loss: 3.3284 - val_accuracy20: 0.3874 - 7s/epoch - 52ms/step
Epoch 9/50
135/135 - 7s - loss: 3.1428 - accuracy20: 0.4518 - val_loss: 3.3542 - val_accuracy20: 0.3889 - 7s/epoch - 52ms/step
Epoch 10/50
135/135 - 7s - loss: 3.1105 - accuracy20: 0.4643 - val_loss: 3.3309 - val_accuracy20: 0.3960 - 7s/epoch - 52ms/step
Epoch 11/50
135/135 - 7s - loss: 3.0846 - accuracy20: 0.4727 - val_loss: 3.3222 - val_accuracy20: 0.4026 - 7s/epoch - 53ms/step
Epoch 12/50
135/135 - 7s - loss: 3.0569 - accuracy20: 0.4845 - val_loss: 3.3836 - val_accuracy20: 0.3858 - 7s/epoch - 52ms/step
Epoch 13/50
135/135 - 7s - loss: 3.0380 - accuracy20: 0.4908 - val_loss: 3.4049 - val_accuracy20: 0.3860 - 7s/epoch - 52ms/step
Epoch 14/50
135/135 - 7s - loss: 3.0207 - accuracy20: 0.4903 - val_loss: 3.4317 - val_accuracy20: 0.3831 - 7s/epoch - 52ms/step
Epoch 15/50
135/135 - 7s - loss: 2.9991 - accuracy20: 0.5020 - val_loss: 3.4370 - val_accuracy20: 0.3856 - 7s/epoch - 52ms/step
Epoch 16/50
135/135 - 7s - loss: 2.9762 - accuracy20: 0.5088 - val_loss: 3.4586 - val_accuracy20: 0.3838 - 7s/epoch - 52ms/step
Epoch 17/50
135/135 - 7s - loss: 2.9567 - accuracy20: 0.5135 - val_loss: 3.4515 - val_accuracy20: 0.3795 - 7s/epoch - 53ms/step
Epoch 18/50
135/135 - 7s - loss: 2.9420 - accuracy20: 0.5187 - val_loss: 3.4815 - val_accuracy20: 0.3783 - 7s/epoch - 51ms/step
Epoch 19/50
135/135 - 7s - loss: 2.9183 - accuracy20: 0.5244 - val_loss: 3.4752 - val_accuracy20: 0.3871 - 7s/epoch - 51ms/step
Epoch 20/50
135/135 - 7s - loss: 2.9065 - accuracy20: 0.5268 - val_loss: 3.5041 - val_accuracy20: 0.3813 - 7s/epoch - 52ms/step
Epoch 21/50
135/135 - 7s - loss: 2.8883 - accuracy20: 0.5340 - val_loss: 3.5060 - val_accuracy20: 0.3856 - 7s/epoch - 52ms/step
testing model: results/LILAK/W10/deepLOB_L2/h20
Evaluating performance on  test set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0851477
{'0': {'precision': 0.4854989923771138, 'recall': 0.41443530291697833, 'f1-score': 0.44716136061009565, 'support': 53480}, '1': {'precision': 0.3012179887570269, 'recall': 0.06465560583207643, 'f1-score': 0.10645989127735316, 'support': 29835}, '2': {'precision': 0.4112520793504978, 'recall': 0.6720357034181965, 'f1-score': 0.5102542183613274, 'support': 49295}, 'accuracy': 0.4314983787044718, 'macro avg': {'precision': 0.39932302016154614, 'recall': 0.38370887072241705, 'f1-score': 0.3546251567495921, 'support': 132610}, 'weighted avg': {'precision': 0.4164391528427474, 'recall': 0.4314983787044718, 'f1-score': 0.39396276386252455, 'support': 132610}}
[[22164  2560 28756]
 [ 9236  1929 18670]
 [14252  1915 33128]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0560805
{'0': {'precision': 0.4570296027662984, 'recall': 0.47447684090710096, 'f1-score': 0.4655898273047513, 'support': 11421}, '1': {'precision': 0.4548964218455744, 'recall': 0.4230668184604606, 'f1-score': 0.4384046463088162, 'support': 11419}, '2': {'precision': 0.43263548877258146, 'recall': 0.4463119393886615, 'f1-score': 0.43936731107205623, 'support': 11483}, 'accuracy': 0.44795035399003585, 'macro avg': {'precision': 0.4481871711281514, 'recall': 0.44795186625207434, 'f1-score': 0.44778726156187454, 'support': 34323}, 'weighted avg': {'precision': 0.4481586881048877, 'recall': 0.44795035399003585, 'f1-score': 0.44777259874977005, 'support': 34323}}
[[5419 2781 3221]
 [3088 4831 3500]
 [3350 3008 5125]]
Evaluating performance on  val set...
46/46 - 1s - 1s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1040171
{'0': {'precision': 0.4318131747080855, 'recall': 0.4904904904904905, 'f1-score': 0.45928529584065614, 'support': 3996}, '1': {'precision': 0.369211898190739, 'recall': 0.32055378061767836, 'f1-score': 0.3431665954111443, 'support': 3756}, '2': {'precision': 0.4142194744976816, 'recall': 0.40916030534351144, 'f1-score': 0.4116743471582181, 'support': 3930}, 'accuracy': 0.40849169662728985, 'macro avg': {'precision': 0.4050815157988354, 'recall': 0.4067348588172268, 'f1-score': 0.4047087461366728, 'support': 11682}, 'weighted avg': {'precision': 0.4057668096656235, 'recall': 0.40849169662728985, 'f1-score': 0.4059337407015337, 'support': 11682}}
[[1960 1012 1024]
 [1302 1204 1250]
 [1277 1045 1608]]
training model: results/LILAK/W10/deepLOB_L2/h30
Epoch 1/50
135/135 - 9s - loss: 3.3795 - accuracy30: 0.3334 - val_loss: 3.3890 - val_accuracy30: 0.3410 - 9s/epoch - 69ms/step
Epoch 2/50
135/135 - 7s - loss: 3.3315 - accuracy30: 0.3503 - val_loss: 3.3708 - val_accuracy30: 0.3403 - 7s/epoch - 53ms/step
Epoch 3/50
135/135 - 7s - loss: 3.3128 - accuracy30: 0.3571 - val_loss: 3.3529 - val_accuracy30: 0.3469 - 7s/epoch - 52ms/step
Epoch 4/50
135/135 - 7s - loss: 3.2950 - accuracy30: 0.3624 - val_loss: 3.3445 - val_accuracy30: 0.3436 - 7s/epoch - 52ms/step
Epoch 5/50
135/135 - 7s - loss: 3.2711 - accuracy30: 0.3845 - val_loss: 3.3389 - val_accuracy30: 0.3540 - 7s/epoch - 52ms/step
Epoch 6/50
135/135 - 7s - loss: 3.2533 - accuracy30: 0.3964 - val_loss: 3.3493 - val_accuracy30: 0.3548 - 7s/epoch - 52ms/step
Epoch 7/50
135/135 - 7s - loss: 3.2321 - accuracy30: 0.4080 - val_loss: 3.3280 - val_accuracy30: 0.3612 - 7s/epoch - 52ms/step
Epoch 8/50
135/135 - 7s - loss: 3.1982 - accuracy30: 0.4262 - val_loss: 3.3323 - val_accuracy30: 0.3700 - 7s/epoch - 52ms/step
Epoch 9/50
135/135 - 7s - loss: 3.1778 - accuracy30: 0.4364 - val_loss: 3.3279 - val_accuracy30: 0.3659 - 7s/epoch - 52ms/step
Epoch 10/50
135/135 - 7s - loss: 3.1625 - accuracy30: 0.4446 - val_loss: 3.3056 - val_accuracy30: 0.3796 - 7s/epoch - 52ms/step
Epoch 11/50
135/135 - 7s - loss: 3.1424 - accuracy30: 0.4528 - val_loss: 3.3209 - val_accuracy30: 0.3824 - 7s/epoch - 51ms/step
Epoch 12/50
135/135 - 7s - loss: 3.1108 - accuracy30: 0.4625 - val_loss: 3.3320 - val_accuracy30: 0.3749 - 7s/epoch - 52ms/step
Epoch 13/50
135/135 - 7s - loss: 3.0982 - accuracy30: 0.4663 - val_loss: 3.3359 - val_accuracy30: 0.3743 - 7s/epoch - 52ms/step
Epoch 14/50
135/135 - 7s - loss: 3.0773 - accuracy30: 0.4727 - val_loss: 3.3389 - val_accuracy30: 0.3724 - 7s/epoch - 53ms/step
Epoch 15/50
135/135 - 7s - loss: 3.0542 - accuracy30: 0.4858 - val_loss: 3.3300 - val_accuracy30: 0.3796 - 7s/epoch - 52ms/step
Epoch 16/50
135/135 - 7s - loss: 3.0335 - accuracy30: 0.4888 - val_loss: 3.3656 - val_accuracy30: 0.3778 - 7s/epoch - 52ms/step
Epoch 17/50
135/135 - 7s - loss: 3.0157 - accuracy30: 0.4972 - val_loss: 3.3954 - val_accuracy30: 0.3813 - 7s/epoch - 53ms/step
Epoch 18/50
135/135 - 7s - loss: 3.0001 - accuracy30: 0.5011 - val_loss: 3.4035 - val_accuracy30: 0.3781 - 7s/epoch - 52ms/step
Epoch 19/50
135/135 - 7s - loss: 2.9821 - accuracy30: 0.5058 - val_loss: 3.4105 - val_accuracy30: 0.3722 - 7s/epoch - 52ms/step
Epoch 20/50
135/135 - 7s - loss: 2.9565 - accuracy30: 0.5139 - val_loss: 3.4172 - val_accuracy30: 0.3838 - 7s/epoch - 52ms/step
testing model: results/LILAK/W10/deepLOB_L2/h30
Evaluating performance on  test set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0934764
{'0': {'precision': 0.45192483959670027, 'recall': 0.38178016957683225, 'f1-score': 0.413901655858465, 'support': 51658}, '1': {'precision': 0.266602192134107, 'recall': 0.10038539738415318, 'f1-score': 0.14585216375300367, 'support': 32953}, '2': {'precision': 0.39260991092186726, 'recall': 0.6262422133794454, 'f1-score': 0.4826390282672747, 'support': 47999}, 'accuracy': 0.4003393409245155, 'macro avg': {'precision': 0.37037898088422483, 'recall': 0.36946926011347697, 'f1-score': 0.34746428262624773, 'support': 132610}, 'weighted avg': {'precision': 0.38440357827931737, 'recall': 0.4003393409245155, 'f1-score': 0.3721724516121728, 'support': 132610}}
[[19722  4972 26964]
 [10106  3308 19539]
 [13812  4128 30059]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0697204
{'0': {'precision': 0.42351973684210525, 'recall': 0.4497816593886463, 'f1-score': 0.4362558238034731, 'support': 11450}, '1': {'precision': 0.4223959314371821, 'recall': 0.39387020286291385, 'f1-score': 0.40763462849352416, 'support': 11387}, '2': {'precision': 0.418796015591165, 'recall': 0.420947240118405, 'f1-score': 0.4198688723893882, 'support': 11486}, 'accuracy': 0.42158319494216706, 'macro avg': {'precision': 0.4215705612901508, 'recall': 0.42153303412332166, 'f1-score': 0.42125310822879514, 'support': 34323}, 'weighted avg': {'precision': 0.4215661362117944, 'recall': 0.42158319494216706, 'f1-score': 0.42127665313259444, 'support': 34323}}
[[5150 3076 3224]
 [3416 4485 3486]
 [3594 3057 4835]]
Evaluating performance on  val set...
46/46 - 1s - 956ms/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1033434
{'0': {'precision': 0.40601503759398494, 'recall': 0.4314606741573034, 'f1-score': 0.41835128919017067, 'support': 4005}, '1': {'precision': 0.33914125700062225, 'recall': 0.28631468347780403, 'f1-score': 0.31049708018800737, 'support': 3807}, '2': {'precision': 0.3682336182336182, 'recall': 0.4007751937984496, 'f1-score': 0.38381588715664444, 'support': 3870}, 'accuracy': 0.37399417907892485, 'macro avg': {'precision': 0.3711299709427418, 'recall': 0.3728501838111857, 'f1-score': 0.37088808551160746, 'support': 11682}, 'weighted avg': {'precision': 0.3717056234830835, 'recall': 0.37399417907892485, 'f1-score': 0.37176226508976135, 'support': 11682}}
[[1728 1082 1195]
 [1251 1090 1466]
 [1277 1042 1551]]
training model: results/LILAK/W10/deepLOB_L2/h50
Epoch 1/50
135/135 - 10s - loss: 3.3853 - accuracy50: 0.3367 - val_loss: 3.4127 - val_accuracy50: 0.3350 - 10s/epoch - 72ms/step
Epoch 2/50
135/135 - 7s - loss: 3.3443 - accuracy50: 0.3438 - val_loss: 3.3821 - val_accuracy50: 0.3317 - 7s/epoch - 53ms/step
Epoch 3/50
135/135 - 7s - loss: 3.3092 - accuracy50: 0.3559 - val_loss: 3.3559 - val_accuracy50: 0.3334 - 7s/epoch - 53ms/step
Epoch 4/50
135/135 - 7s - loss: 3.3010 - accuracy50: 0.3631 - val_loss: 3.3872 - val_accuracy50: 0.3343 - 7s/epoch - 52ms/step
Epoch 5/50
135/135 - 7s - loss: 3.2983 - accuracy50: 0.3609 - val_loss: 3.3313 - val_accuracy50: 0.3393 - 7s/epoch - 52ms/step
Epoch 6/50
135/135 - 7s - loss: 3.2730 - accuracy50: 0.3779 - val_loss: 3.3310 - val_accuracy50: 0.3527 - 7s/epoch - 53ms/step
Epoch 7/50
135/135 - 7s - loss: 3.2563 - accuracy50: 0.3876 - val_loss: 3.3346 - val_accuracy50: 0.3518 - 7s/epoch - 52ms/step
Epoch 8/50
135/135 - 7s - loss: 3.2467 - accuracy50: 0.3938 - val_loss: 3.3367 - val_accuracy50: 0.3508 - 7s/epoch - 52ms/step
Epoch 9/50
135/135 - 7s - loss: 3.2283 - accuracy50: 0.4108 - val_loss: 3.3435 - val_accuracy50: 0.3554 - 7s/epoch - 52ms/step
Epoch 10/50
135/135 - 7s - loss: 3.2118 - accuracy50: 0.4201 - val_loss: 3.3570 - val_accuracy50: 0.3496 - 7s/epoch - 52ms/step
Epoch 11/50
135/135 - 7s - loss: 3.1905 - accuracy50: 0.4286 - val_loss: 3.3575 - val_accuracy50: 0.3538 - 7s/epoch - 52ms/step
Epoch 12/50
135/135 - 7s - loss: 3.1639 - accuracy50: 0.4403 - val_loss: 3.3776 - val_accuracy50: 0.3492 - 7s/epoch - 52ms/step
Epoch 13/50
135/135 - 7s - loss: 3.1477 - accuracy50: 0.4500 - val_loss: 3.3986 - val_accuracy50: 0.3559 - 7s/epoch - 52ms/step
Epoch 14/50
135/135 - 7s - loss: 3.1278 - accuracy50: 0.4554 - val_loss: 3.4157 - val_accuracy50: 0.3600 - 7s/epoch - 52ms/step
Epoch 15/50
135/135 - 7s - loss: 3.1042 - accuracy50: 0.4677 - val_loss: 3.4215 - val_accuracy50: 0.3554 - 7s/epoch - 52ms/step
Epoch 16/50
135/135 - 7s - loss: 3.0776 - accuracy50: 0.4769 - val_loss: 3.4545 - val_accuracy50: 0.3544 - 7s/epoch - 52ms/step
testing model: results/LILAK/W10/deepLOB_L2/h50
Evaluating performance on  test set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1051867
{'0': {'precision': 0.4017390362163773, 'recall': 0.28727216379026477, 'f1-score': 0.3349972894831948, 'support': 51627}, '1': {'precision': 0.2593595888032229, 'recall': 0.2269701850895055, 'f1-score': 0.24208632510494837, 'support': 32903}, '2': {'precision': 0.36448975321006294, 'recall': 0.5071547420965058, 'f1-score': 0.42414701815114064, 'support': 48080}, 'accuracy': 0.35203227509237617, 'macro avg': {'precision': 0.341862792743221, 'recall': 0.34046569699209206, 'f1-score': 0.3337435442464279, 'support': 132610}, 'weighted avg': {'precision': 0.3529066971380377, 'recall': 0.35203227509237617, 'f1-score': 0.3442670994026382, 'support': 132610}}
[[14831 10985 25811]
 [ 8731  7468 16704]
 [13355 10341 24384]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0989814
{'0': {'precision': 0.3742814394834239, 'recall': 0.4111947400294143, 'f1-score': 0.3918707230604337, 'support': 11559}, '1': {'precision': 0.36894724162852327, 'recall': 0.2757472092185812, 'f1-score': 0.31561051004636786, 'support': 11108}, '2': {'precision': 0.3672871941149978, 'recall': 0.4197838023335621, 'f1-score': 0.3917847705981264, 'support': 11656}, 'accuracy': 0.37027649098272297, 'macro avg': {'precision': 0.3701719584089817, 'recall': 0.3689085838605192, 'f1-score': 0.366422001234976, 'support': 34323}, 'weighted avg': {'precision': 0.3701798984238833, 'recall': 0.37027649098272297, 'f1-score': 0.3671613355342589, 'support': 34323}}
[[4753 2575 4231]
 [3847 3063 4198]
 [4099 2664 4893]]
Evaluating performance on  val set...
46/46 - 1s - 1s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1126643
{'0': {'precision': 0.3706134814440798, 'recall': 0.3670917729432358, 'f1-score': 0.3688442211055276, 'support': 3999}, '1': {'precision': 0.3217492035910802, 'recall': 0.2946949602122016, 'f1-score': 0.3076284092482348, 'support': 3770}, '2': {'precision': 0.3446579194001874, 'recall': 0.37592639918221316, 'f1-score': 0.3596137391516929, 'support': 3913}, 'accuracy': 0.34668721109399075, 'macro avg': {'precision': 0.34567353481178253, 'recall': 0.3459043774458836, 'f1-score': 0.34536212316848514, 'support': 11682}, 'weighted avg': {'precision': 0.34614999558690135, 'recall': 0.34668721109399075, 'f1-score': 0.34599689302922654, 'support': 11682}}
[[1468 1164 1367]
 [1229 1111 1430]
 [1264 1178 1471]]
training model: results/LILAK/W10/deepLOB_L2/h100
Epoch 1/50
135/135 - 9s - loss: 3.3771 - accuracy100: 0.3331 - val_loss: 3.3698 - val_accuracy100: 0.3434 - 9s/epoch - 66ms/step
Epoch 2/50
135/135 - 7s - loss: 3.3233 - accuracy100: 0.3540 - val_loss: 3.3389 - val_accuracy100: 0.3491 - 7s/epoch - 51ms/step
Epoch 3/50
135/135 - 7s - loss: 3.3091 - accuracy100: 0.3631 - val_loss: 3.3372 - val_accuracy100: 0.3422 - 7s/epoch - 52ms/step
Epoch 4/50
135/135 - 7s - loss: 3.2847 - accuracy100: 0.3709 - val_loss: 3.3254 - val_accuracy100: 0.3592 - 7s/epoch - 53ms/step
Epoch 5/50
135/135 - 7s - loss: 3.2698 - accuracy100: 0.3773 - val_loss: 3.3299 - val_accuracy100: 0.3517 - 7s/epoch - 53ms/step
Epoch 6/50
135/135 - 7s - loss: 3.2534 - accuracy100: 0.3894 - val_loss: 3.3229 - val_accuracy100: 0.3630 - 7s/epoch - 53ms/step
Epoch 7/50
135/135 - 7s - loss: 3.2374 - accuracy100: 0.3990 - val_loss: 3.3128 - val_accuracy100: 0.3590 - 7s/epoch - 52ms/step
Epoch 8/50
135/135 - 7s - loss: 3.2286 - accuracy100: 0.4034 - val_loss: 3.3109 - val_accuracy100: 0.3621 - 7s/epoch - 52ms/step
Epoch 9/50
135/135 - 7s - loss: 3.2091 - accuracy100: 0.4161 - val_loss: 3.3186 - val_accuracy100: 0.3629 - 7s/epoch - 51ms/step
Epoch 10/50
135/135 - 7s - loss: 3.2009 - accuracy100: 0.4194 - val_loss: 3.3115 - val_accuracy100: 0.3633 - 7s/epoch - 52ms/step
Epoch 11/50
135/135 - 7s - loss: 3.1762 - accuracy100: 0.4328 - val_loss: 3.3622 - val_accuracy100: 0.3637 - 7s/epoch - 51ms/step
Epoch 12/50
135/135 - 7s - loss: 3.1679 - accuracy100: 0.4389 - val_loss: 3.3458 - val_accuracy100: 0.3632 - 7s/epoch - 52ms/step
Epoch 13/50
135/135 - 7s - loss: 3.1390 - accuracy100: 0.4456 - val_loss: 3.3396 - val_accuracy100: 0.3648 - 7s/epoch - 52ms/step
Epoch 14/50
135/135 - 7s - loss: 3.1186 - accuracy100: 0.4541 - val_loss: 3.3737 - val_accuracy100: 0.3718 - 7s/epoch - 52ms/step
Epoch 15/50
135/135 - 7s - loss: 3.1008 - accuracy100: 0.4641 - val_loss: 3.3784 - val_accuracy100: 0.3639 - 7s/epoch - 52ms/step
Epoch 16/50
135/135 - 7s - loss: 3.0861 - accuracy100: 0.4688 - val_loss: 3.3807 - val_accuracy100: 0.3672 - 7s/epoch - 52ms/step
Epoch 17/50
135/135 - 7s - loss: 3.0641 - accuracy100: 0.4743 - val_loss: 3.3857 - val_accuracy100: 0.3711 - 7s/epoch - 52ms/step
Epoch 18/50
135/135 - 7s - loss: 3.0335 - accuracy100: 0.4838 - val_loss: 3.3951 - val_accuracy100: 0.3721 - 7s/epoch - 52ms/step
testing model: results/LILAK/W10/deepLOB_L2/h100
Evaluating performance on  test set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0890119
{'0': {'precision': 0.43456511942316356, 'recall': 0.1744486857101507, 'f1-score': 0.24895762066428287, 'support': 55277}, '1': {'precision': 0.217804960924227, 'recall': 0.023358355804970483, 'f1-score': 0.042191870988974825, 'support': 27442}, '2': {'precision': 0.37868567228337224, 'recall': 0.8157783969052534, 'f1-score': 0.5172589090539372, 'support': 49891}, 'accuracy': 0.3844657265666239, 'macro avg': {'precision': 0.343685250876921, 'recall': 0.33786181280679156, 'f1-score': 0.2694694669023983, 'support': 132610}, 'weighted avg': {'precision': 0.3686861226146337, 'recall': 0.3844657265666239, 'f1-score': 0.30711125822146895, 'support': 132610}}
[[ 9643  1209 44425]
 [ 4449   641 22352]
 [ 8098  1093 40700]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0963942
{'0': {'precision': 0.36313786929274844, 'recall': 0.28377787494534323, 'f1-score': 0.3185901526680084, 'support': 11435}, '1': {'precision': 0.4302768605537211, 'recall': 0.299743430947536, 'f1-score': 0.3533399384679564, 'support': 11303}, '2': {'precision': 0.3716096613943927, 'recall': 0.5617608977125593, 'f1-score': 0.44731596673310875, 'support': 11585}, 'accuracy': 0.382862803368004, 'macro avg': {'precision': 0.38834146374695405, 'recall': 0.3817607345351462, 'f1-score': 0.37308201928969115, 'support': 34323}, 'weighted avg': {'precision': 0.38810706574178616, 'recall': 0.382862803368004, 'f1-score': 0.3734823644455628, 'support': 34323}}
[[3245 2151 6039]
 [2949 3388 4966]
 [2742 2335 6508]]
Evaluating performance on  val set...
46/46 - 1s - 945ms/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.105647
{'0': {'precision': 0.3782811938151744, 'recall': 0.24183908045977012, 'f1-score': 0.295049782639181, 'support': 4350}, '1': {'precision': 0.33579676674364894, 'recall': 0.219770253929867, 'f1-score': 0.2656678238625982, 'support': 3308}, '2': {'precision': 0.35644299287410924, 'recall': 0.5966699801192843, 'f1-score': 0.44628252788104084, 'support': 4024}, 'accuracy': 0.3578154425612053, 'macro avg': {'precision': 0.3568403178109775, 'recall': 0.3527597715029738, 'f1-score': 0.33566671146094, 'support': 11682}, 'weighted avg': {'precision': 0.35872842842059705, 'recall': 0.3578154425612053, 'f1-score': 0.33882354117541696, 'support': 11682}}
[[1052  756 2542]
 [ 788  727 1793]
 [ 941  682 2401]]
training model: results/LILAK/W10/deepLOB_L2/h200
Epoch 1/50
135/135 - 9s - loss: 3.3738 - accuracy200: 0.3415 - val_loss: 3.4456 - val_accuracy200: 0.3381 - 9s/epoch - 69ms/step
Epoch 2/50
135/135 - 7s - loss: 3.3396 - accuracy200: 0.3500 - val_loss: 3.3984 - val_accuracy200: 0.3392 - 7s/epoch - 53ms/step
Epoch 3/50
135/135 - 7s - loss: 3.2976 - accuracy200: 0.3650 - val_loss: 3.4063 - val_accuracy200: 0.3301 - 7s/epoch - 52ms/step
Epoch 4/50
135/135 - 7s - loss: 3.2807 - accuracy200: 0.3744 - val_loss: 3.3964 - val_accuracy200: 0.3394 - 7s/epoch - 53ms/step
Epoch 5/50
135/135 - 7s - loss: 3.2647 - accuracy200: 0.3820 - val_loss: 3.3927 - val_accuracy200: 0.3387 - 7s/epoch - 54ms/step
Epoch 6/50
135/135 - 7s - loss: 3.2466 - accuracy200: 0.3971 - val_loss: 3.4012 - val_accuracy200: 0.3367 - 7s/epoch - 53ms/step
Epoch 7/50
135/135 - 7s - loss: 3.2305 - accuracy200: 0.4086 - val_loss: 3.4751 - val_accuracy200: 0.3421 - 7s/epoch - 53ms/step
Epoch 8/50
135/135 - 7s - loss: 3.2139 - accuracy200: 0.4145 - val_loss: 3.5546 - val_accuracy200: 0.3503 - 7s/epoch - 52ms/step
Epoch 9/50
135/135 - 7s - loss: 3.1952 - accuracy200: 0.4223 - val_loss: 3.5685 - val_accuracy200: 0.3394 - 7s/epoch - 52ms/step
Epoch 10/50
135/135 - 7s - loss: 3.1866 - accuracy200: 0.4259 - val_loss: 3.4146 - val_accuracy200: 0.3441 - 7s/epoch - 52ms/step
Epoch 11/50
135/135 - 7s - loss: 3.1891 - accuracy200: 0.4254 - val_loss: 3.5167 - val_accuracy200: 0.3393 - 7s/epoch - 52ms/step
Epoch 12/50
135/135 - 7s - loss: 3.1491 - accuracy200: 0.4433 - val_loss: 3.6516 - val_accuracy200: 0.3391 - 7s/epoch - 52ms/step
Epoch 13/50
135/135 - 7s - loss: 3.1162 - accuracy200: 0.4581 - val_loss: 3.7228 - val_accuracy200: 0.3297 - 7s/epoch - 52ms/step
Epoch 14/50
135/135 - 7s - loss: 3.0886 - accuracy200: 0.4674 - val_loss: 3.6666 - val_accuracy200: 0.3278 - 7s/epoch - 52ms/step
Epoch 15/50
135/135 - 7s - loss: 3.0636 - accuracy200: 0.4744 - val_loss: 3.6972 - val_accuracy200: 0.3291 - 7s/epoch - 52ms/step
testing model: results/LILAK/W10/deepLOB_L2/h200
Evaluating performance on  test set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1524221
{'0': {'precision': 0.3609891379708805, 'recall': 0.060119700556164966, 'f1-score': 0.103073395252157, 'support': 51963}, '1': {'precision': 0.28334020052190634, 'recall': 0.11206170727070262, 'f1-score': 0.16060411436133978, 'support': 36819}, '2': {'precision': 0.32859206172184946, 'recall': 0.8201606279090992, 'f1-score': 0.46920155069115405, 'support': 43828}, 'accuracy': 0.325737123897142, 'macro avg': {'precision': 0.32430713340487877, 'recall': 0.33078067857865556, 'f1-score': 0.2442930201015503, 'support': 132610}, 'weighted avg': {'precision': 0.3287226777810282, 'recall': 0.325737123897142, 'f1-score': 0.2400531731230669, 'support': 132610}}
[[ 3124  5593 43246]
 [ 2491  4126 30202]
 [ 3039  4843 35946]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1201277
{'0': {'precision': 0.3691129971709103, 'recall': 0.1916033172080166, 'f1-score': 0.2522604492465169, 'support': 11576}, '1': {'precision': 0.35748723766307433, 'recall': 0.2236515259048971, 'f1-score': 0.27515826238812485, 'support': 11272}, '2': {'precision': 0.3526479164706989, 'recall': 0.6534204793028322, 'f1-score': 0.4580749610532425, 'support': 11475}, 'accuracy': 0.35652477930250853, 'macro avg': {'precision': 0.3597493837682278, 'recall': 0.3562251074719153, 'f1-score': 0.32849789089596143, 'support': 34323}, 'weighted avg': {'precision': 0.35979031668822364, 'recall': 0.35652477930250853, 'f1-score': 0.32858902404226265, 'support': 34323}}
[[2218 2336 7022]
 [2009 2521 6742]
 [1782 2195 7498]]
Evaluating performance on  val set...
46/46 - 1s - 989ms/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1315053
{'0': {'precision': 0.37641083521444696, 'recall': 0.15210946408209805, 'f1-score': 0.21666395972064315, 'support': 4385}, '1': {'precision': 0.31204379562043794, 'recall': 0.20029282576866764, 'f1-score': 0.2439807383627608, 'support': 3415}, '2': {'precision': 0.33441306037833635, 'recall': 0.6648634724368881, 'f1-score': 0.445, 'support': 3882}, 'accuracy': 0.33658620099298064, 'macro avg': {'precision': 0.34095589707107377, 'recall': 0.339088587429218, 'f1-score': 0.3018815660278013, 'support': 11682}, 'weighted avg': {'precision': 0.3436382960835343, 'recall': 0.33658620099298064, 'f1-score': 0.30052693758635923, 'support': 11682}}
[[ 667  803 2915]
 [ 509  684 2222]
 [ 596  705 2581]]
training model: results/LILAK/W10/deepLOB_L2/h300
Epoch 1/50
135/135 - 10s - loss: 3.3663 - accuracy300: 0.3426 - val_loss: 3.3560 - val_accuracy300: 0.3523 - 10s/epoch - 71ms/step
Epoch 2/50
135/135 - 7s - loss: 3.3138 - accuracy300: 0.3620 - val_loss: 3.4121 - val_accuracy300: 0.3436 - 7s/epoch - 52ms/step
Epoch 3/50
135/135 - 7s - loss: 3.3046 - accuracy300: 0.3702 - val_loss: 3.4125 - val_accuracy300: 0.3462 - 7s/epoch - 52ms/step
Epoch 4/50
135/135 - 7s - loss: 3.2806 - accuracy300: 0.3763 - val_loss: 3.3979 - val_accuracy300: 0.3560 - 7s/epoch - 52ms/step
Epoch 5/50
135/135 - 7s - loss: 3.2461 - accuracy300: 0.3972 - val_loss: 3.4385 - val_accuracy300: 0.3643 - 7s/epoch - 52ms/step
Epoch 6/50
135/135 - 7s - loss: 3.2295 - accuracy300: 0.4073 - val_loss: 3.4266 - val_accuracy300: 0.3595 - 7s/epoch - 53ms/step
Epoch 7/50
135/135 - 7s - loss: 3.1989 - accuracy300: 0.4264 - val_loss: 3.4454 - val_accuracy300: 0.3618 - 7s/epoch - 53ms/step
Epoch 8/50
135/135 - 7s - loss: 3.1704 - accuracy300: 0.4403 - val_loss: 3.4622 - val_accuracy300: 0.3666 - 7s/epoch - 52ms/step
Epoch 9/50
135/135 - 7s - loss: 3.1356 - accuracy300: 0.4549 - val_loss: 3.5524 - val_accuracy300: 0.3601 - 7s/epoch - 53ms/step
Epoch 10/50
135/135 - 7s - loss: 3.1280 - accuracy300: 0.4563 - val_loss: 3.6126 - val_accuracy300: 0.3711 - 7s/epoch - 53ms/step
Epoch 11/50
135/135 - 7s - loss: 3.1026 - accuracy300: 0.4680 - val_loss: 3.5358 - val_accuracy300: 0.3686 - 7s/epoch - 52ms/step
testing model: results/LILAK/W10/deepLOB_L2/h300
Evaluating performance on  test set...
519/519 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1195338
{'0': {'precision': 0.39840421255727954, 'recall': 0.3690403053150889, 'f1-score': 0.3831604990770361, 'support': 53715}, '1': {'precision': 0.2333861223532172, 'recall': 0.11810275741295895, 'f1-score': 0.15683878596767836, 'support': 33691}, '2': {'precision': 0.32783223159334396, 'recall': 0.47723652774090786, 'f1-score': 0.3886711888225279, 'support': 45204}, 'accuracy': 0.3421687655531257, 'macro avg': {'precision': 0.31987418883461355, 'recall': 0.3214598634896519, 'f1-score': 0.3095568246224141, 'support': 132610}, 'weighted avg': {'precision': 0.3324230625342134, 'recall': 0.3421687655531257, 'f1-score': 0.3275395080724953, 'support': 132610}}
[[19823  6819 27073]
 [12553  3979 17159]
 [17380  6251 21573]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1128964
{'0': {'precision': 0.3591289782244556, 'recall': 0.368828487872011, 'f1-score': 0.3639141135534244, 'support': 11626}, '1': {'precision': 0.3662152812098448, 'recall': 0.3259721977828612, 'f1-score': 0.34492389331099005, 'support': 11366}, '2': {'precision': 0.3509701614218164, 'recall': 0.3799311622981202, 'f1-score': 0.3648768911302284, 'support': 11331}, 'accuracy': 0.358302013227282, 'macro avg': {'precision': 0.3587714736187056, 'recall': 0.3582439493176641, 'f1-score': 0.3579049659982143, 'support': 34323}, 'weighted avg': {'precision': 0.35878213693847333, 'recall': 0.358302013227282, 'f1-score': 0.3579433764222662, 'support': 34323}}
[[4288 3166 4172]
 [3872 3705 3789]
 [3780 3246 4305]]
Evaluating performance on  val set...
46/46 - 1s - 1s/epoch - 23ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1210347
{'0': {'precision': 0.4158415841584158, 'recall': 0.3704819277108434, 'f1-score': 0.3918534531801115, 'support': 4648}, '1': {'precision': 0.2799772144688123, 'recall': 0.32176759410801964, 'f1-score': 0.29942126104173006, 'support': 3055}, '2': {'precision': 0.3436724565756824, 'recall': 0.3480774063835134, 'f1-score': 0.34586090648020973, 'support': 3979}, 'accuracy': 0.35011128231467215, 'macro avg': {'precision': 0.3464970850676368, 'recall': 0.3467756427341255, 'f1-score': 0.3457118735673504, 'support': 11682}, 'weighted avg': {'precision': 0.35572973618260384, 'recall': 0.35011128231467215, 'f1-score': 0.3520156950649202, 'support': 11682}}
[[1722 1335 1591]
 [1018  983 1054]
 [1401 1193 1385]]
training model: results/LILAK/W10/deepLOB_L2/h500
Epoch 1/50
135/135 - 9s - loss: 3.3662 - accuracy500: 0.3462 - val_loss: 3.4662 - val_accuracy500: 0.3529 - 9s/epoch - 69ms/step
Epoch 2/50
135/135 - 7s - loss: 3.3236 - accuracy500: 0.3573 - val_loss: 3.5730 - val_accuracy500: 0.3454 - 7s/epoch - 53ms/step
Epoch 3/50
135/135 - 7s - loss: 3.2966 - accuracy500: 0.3733 - val_loss: 3.5842 - val_accuracy500: 0.3481 - 7s/epoch - 52ms/step
Epoch 4/50
135/135 - 7s - loss: 3.2828 - accuracy500: 0.3841 - val_loss: 3.5290 - val_accuracy500: 0.3544 - 7s/epoch - 52ms/step
Epoch 5/50
135/135 - 7s - loss: 3.2752 - accuracy500: 0.3836 - val_loss: 3.4124 - val_accuracy500: 0.3504 - 7s/epoch - 52ms/step
Epoch 6/50
135/135 - 7s - loss: 3.2582 - accuracy500: 0.3912 - val_loss: 3.4039 - val_accuracy500: 0.3517 - 7s/epoch - 52ms/step
Epoch 7/50
135/135 - 7s - loss: 3.2210 - accuracy500: 0.4094 - val_loss: 3.3704 - val_accuracy500: 0.3534 - 7s/epoch - 53ms/step
Epoch 8/50
135/135 - 7s - loss: 3.1970 - accuracy500: 0.4159 - val_loss: 3.3847 - val_accuracy500: 0.3536 - 7s/epoch - 52ms/step
Epoch 9/50
135/135 - 7s - loss: 3.1672 - accuracy500: 0.4351 - val_loss: 3.4082 - val_accuracy500: 0.3556 - 7s/epoch - 53ms/step
Epoch 10/50
135/135 - 7s - loss: 3.1461 - accuracy500: 0.4450 - val_loss: 3.4833 - val_accuracy500: 0.3465 - 7s/epoch - 52ms/step
Epoch 11/50
135/135 - 7s - loss: 3.1258 - accuracy500: 0.4505 - val_loss: 3.5183 - val_accuracy500: 0.3505 - 7s/epoch - 52ms/step
Epoch 12/50
135/135 - 7s - loss: 3.0847 - accuracy500: 0.4653 - val_loss: 3.5467 - val_accuracy500: 0.3511 - 7s/epoch - 52ms/step
Epoch 13/50
135/135 - 7s - loss: 3.0424 - accuracy500: 0.4841 - val_loss: 3.5729 - val_accuracy500: 0.3570 - 7s/epoch - 53ms/step
Epoch 14/50
135/135 - 7s - loss: 3.0255 - accuracy500: 0.4891 - val_loss: 3.6368 - val_accuracy500: 0.3517 - 7s/epoch - 51ms/step
Epoch 15/50
135/135 - 7s - loss: 2.9939 - accuracy500: 0.4988 - val_loss: 3.6257 - val_accuracy500: 0.3475 - 7s/epoch - 51ms/step
Epoch 16/50
135/135 - 7s - loss: 2.9764 - accuracy500: 0.5043 - val_loss: 3.6724 - val_accuracy500: 0.3487 - 7s/epoch - 51ms/step
Epoch 17/50
135/135 - 7s - loss: 2.9284 - accuracy500: 0.5183 - val_loss: 3.6591 - val_accuracy500: 0.3469 - 7s/epoch - 53ms/step
testing model: results/LILAK/W10/deepLOB_L2/h500
Evaluating performance on  test set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1600237
{'0': {'precision': 0.37790697674418605, 'recall': 0.002459698781503065, 'f1-score': 0.004887585532746823, 'support': 52852}, '1': {'precision': 0.27436140018921473, 'recall': 0.00805533179633899, 'f1-score': 0.01565114145393707, 'support': 36001}, '2': {'precision': 0.3299011500735468, 'recall': 0.9892360079530133, 'f1-score': 0.4947932741218294, 'support': 43757}, 'accuracy': 0.3295829877083176, 'macro avg': {'precision': 0.3273898423356492, 'recall': 0.33325034617695176, 'f1-score': 0.17177733370283776, 'support': 132610}, 'weighted avg': {'precision': 0.33395602840557903, 'recall': 0.3295829877083176, 'f1-score': 0.16946267030999784, 'support': 132610}}
[[  130   431 52291]
 [   79   290 35632]
 [  135   336 43286]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1173061
{'0': {'precision': 0.3677463660295296, 'recall': 0.2742403550699898, 'f1-score': 0.31418373832689583, 'support': 11716}, '1': {'precision': 0.4365079365079365, 'recall': 0.13611454834718048, 'f1-score': 0.20751920226384582, 'support': 11314}, '2': {'precision': 0.3533865264303201, 'recall': 0.6902505977153989, 'f1-score': 0.4674522503073371, 'support': 11293}, 'accuracy': 0.3655857588206159, 'macro avg': {'precision': 0.3858802763225954, 'recall': 0.366868500377523, 'f1-score': 0.32971839696602623, 'support': 34323}, 'weighted avg': {'precision': 0.3856877679990201, 'recall': 0.3655857588206159, 'f1-score': 0.3294521806185887, 'support': 34323}}
[[3213  944 7559]
 [3070 1540 6704]
 [2454 1044 7795]]
Evaluating performance on  val set...
46/46 - 1s - 1s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1290121
{'0': {'precision': 0.4238921001926782, 'recall': 0.23835319609967498, 'f1-score': 0.30513176144244103, 'support': 4615}, '1': {'precision': 0.27931488801054016, 'recall': 0.06368278762391108, 'f1-score': 0.10371819960861056, 'support': 3329}, '2': {'precision': 0.33753602305475505, 'recall': 0.7520064205457464, 'f1-score': 0.4659373446046743, 'support': 3738}, 'accuracy': 0.35293614107173427, 'macro avg': {'precision': 0.3469143370859911, 'recall': 0.3513474680897775, 'f1-score': 0.2915957685519086, 'support': 11682}, 'weighted avg': {'precision': 0.35506000331749465, 'recall': 0.35293614107173427, 'f1-score': 0.2991897585761173, 'support': 11682}}
[[1100  354 3161]
 [ 761  212 2356]
 [ 734  193 2811]]
training model: results/LILAK/W10/deepLOB_L2/h1000
Epoch 1/50
135/135 - 9s - loss: 3.3630 - accuracy1000: 0.3487 - val_loss: 3.5395 - val_accuracy1000: 0.3242 - 9s/epoch - 69ms/step
Epoch 2/50
135/135 - 7s - loss: 3.3009 - accuracy1000: 0.3772 - val_loss: 3.9383 - val_accuracy1000: 0.3166 - 7s/epoch - 52ms/step
Epoch 3/50
135/135 - 7s - loss: 3.2849 - accuracy1000: 0.3857 - val_loss: 3.7757 - val_accuracy1000: 0.3261 - 7s/epoch - 53ms/step
Epoch 4/50
135/135 - 7s - loss: 3.2382 - accuracy1000: 0.4048 - val_loss: 3.7687 - val_accuracy1000: 0.3191 - 7s/epoch - 53ms/step
Epoch 5/50
135/135 - 7s - loss: 3.2043 - accuracy1000: 0.4211 - val_loss: 3.8227 - val_accuracy1000: 0.3149 - 7s/epoch - 52ms/step
Epoch 6/50
135/135 - 7s - loss: 3.1807 - accuracy1000: 0.4298 - val_loss: 3.7740 - val_accuracy1000: 0.3268 - 7s/epoch - 51ms/step
Epoch 7/50
135/135 - 7s - loss: 3.1764 - accuracy1000: 0.4317 - val_loss: 3.7054 - val_accuracy1000: 0.3273 - 7s/epoch - 51ms/step
Epoch 8/50
135/135 - 7s - loss: 3.1197 - accuracy1000: 0.4510 - val_loss: 3.8096 - val_accuracy1000: 0.3249 - 7s/epoch - 52ms/step
Epoch 9/50
135/135 - 7s - loss: 3.0968 - accuracy1000: 0.4602 - val_loss: 3.8668 - val_accuracy1000: 0.3302 - 7s/epoch - 52ms/step
Epoch 10/50
135/135 - 7s - loss: 3.1087 - accuracy1000: 0.4560 - val_loss: 3.8628 - val_accuracy1000: 0.3276 - 7s/epoch - 52ms/step
Epoch 11/50
135/135 - 7s - loss: 3.0896 - accuracy1000: 0.4637 - val_loss: 3.8912 - val_accuracy1000: 0.3277 - 7s/epoch - 51ms/step
testing model: results/LILAK/W10/deepLOB_L2/h1000
Evaluating performance on  test set...
519/519 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2422585
{'0': {'precision': 0.458, 'recall': 0.02577184229283115, 'f1-score': 0.04879781226693185, 'support': 53314}, '1': {'precision': 0.3054191590036604, 'recall': 0.17410555244541706, 'f1-score': 0.22178282009724473, 'support': 39298}, '2': {'precision': 0.30243078874710844, 'recall': 0.8106155307765388, 'f1-score': 0.4405119356547966, 'support': 39998}, 'accuracy': 0.3064550184752281, 'macro avg': {'precision': 0.3552833159169229, 'recall': 0.33683097517159566, 'f1-score': 0.23703085600632443, 'support': 132610}, 'weighted avg': {'precision': 0.3658608008357793, 'recall': 0.3064550184752281, 'f1-score': 0.2182099708144279, 'support': 132610}}
[[ 1374  8729 43211]
 [  882  6842 31574]
 [  744  6831 32423]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1457291
{'0': {'precision': 0.33775137111517367, 'recall': 0.19148384867852825, 'f1-score': 0.24440524749200748, 'support': 11578}, '1': {'precision': 0.35585990121239336, 'recall': 0.28125277260225356, 'f1-score': 0.31418801724565143, 'support': 11271}, '2': {'precision': 0.364383852315527, 'recall': 0.5986578351054558, 'f1-score': 0.45302555647155807, 'support': 11474}, 'accuracy': 0.3570783439676019, 'macro avg': {'precision': 0.352665041547698, 'recall': 0.35713148546207923, 'f1-score': 0.33720627373640566, 'support': 34323}, 'weighted avg': {'precision': 0.35260095687453674, 'recall': 0.3570783439676019, 'f1-score': 0.33706122229388036, 'support': 34323}}
[[2217 2956 6405]
 [2524 3170 5577]
 [1823 2782 6869]]
Evaluating performance on  val set...
46/46 - 1s - 1s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.187293
{'0': {'precision': 0.4084199015855659, 'recall': 0.16095669036845509, 'f1-score': 0.23091190108191653, 'support': 4641}, '1': {'precision': 0.3221317040054311, 'recall': 0.2521923996811055, 'f1-score': 0.282903562378894, 'support': 3763}, '2': {'precision': 0.2978138120747068, 'recall': 0.62751677852349, 'f1-score': 0.4039273441335297, 'support': 3278}, 'accuracy': 0.32126348228043144, 'macro avg': {'precision': 0.3427884725552346, 'recall': 0.3468886228576835, 'f1-score': 0.30591426919811343, 'support': 11682}, 'weighted avg': {'precision': 0.3495884301842097, 'recall': 0.32126348228043144, 'f1-score': 0.296208018509045, 'support': 11682}}
[[ 747 1261 2633]
 [ 597  949 2217]
 [ 485  736 2057]]
training model: results/LILAK/W10/deepOF_L2/h10
Epoch 1/50
135/135 - 7s - loss: 3.2625 - accuracy10: 0.4053 - val_loss: 3.1966 - val_accuracy10: 0.4467 - 7s/epoch - 51ms/step
Epoch 2/50
135/135 - 5s - loss: 3.1468 - accuracy10: 0.4655 - val_loss: 3.1442 - val_accuracy10: 0.4717 - 5s/epoch - 34ms/step
Epoch 3/50
135/135 - 5s - loss: 3.0819 - accuracy10: 0.4874 - val_loss: 3.1149 - val_accuracy10: 0.4826 - 5s/epoch - 34ms/step
Epoch 4/50
135/135 - 5s - loss: 3.0425 - accuracy10: 0.4991 - val_loss: 3.0995 - val_accuracy10: 0.4835 - 5s/epoch - 34ms/step
Epoch 5/50
135/135 - 5s - loss: 3.0084 - accuracy10: 0.5082 - val_loss: 3.0790 - val_accuracy10: 0.4958 - 5s/epoch - 34ms/step
Epoch 6/50
135/135 - 5s - loss: 2.9804 - accuracy10: 0.5171 - val_loss: 3.0668 - val_accuracy10: 0.4967 - 5s/epoch - 34ms/step
Epoch 7/50
135/135 - 5s - loss: 2.9538 - accuracy10: 0.5245 - val_loss: 3.0496 - val_accuracy10: 0.5037 - 5s/epoch - 34ms/step
Epoch 8/50
135/135 - 4s - loss: 2.9345 - accuracy10: 0.5288 - val_loss: 3.0577 - val_accuracy10: 0.5013 - 4s/epoch - 33ms/step
Epoch 9/50
135/135 - 5s - loss: 2.9187 - accuracy10: 0.5312 - val_loss: 3.0418 - val_accuracy10: 0.5066 - 5s/epoch - 34ms/step
Epoch 10/50
135/135 - 4s - loss: 2.8973 - accuracy10: 0.5349 - val_loss: 3.0439 - val_accuracy10: 0.5022 - 4s/epoch - 32ms/step
Epoch 11/50
135/135 - 4s - loss: 2.8764 - accuracy10: 0.5417 - val_loss: 3.0425 - val_accuracy10: 0.5054 - 4s/epoch - 33ms/step
Epoch 12/50
135/135 - 5s - loss: 2.8633 - accuracy10: 0.5459 - val_loss: 3.0340 - val_accuracy10: 0.5044 - 5s/epoch - 34ms/step
Epoch 13/50
135/135 - 5s - loss: 2.8427 - accuracy10: 0.5487 - val_loss: 3.0429 - val_accuracy10: 0.5068 - 5s/epoch - 34ms/step
Epoch 14/50
135/135 - 5s - loss: 2.8272 - accuracy10: 0.5518 - val_loss: 3.0288 - val_accuracy10: 0.5070 - 5s/epoch - 34ms/step
Epoch 15/50
135/135 - 4s - loss: 2.8162 - accuracy10: 0.5521 - val_loss: 3.0415 - val_accuracy10: 0.5090 - 4s/epoch - 33ms/step
Epoch 16/50
135/135 - 4s - loss: 2.7960 - accuracy10: 0.5584 - val_loss: 3.0403 - val_accuracy10: 0.5050 - 4s/epoch - 33ms/step
Epoch 17/50
135/135 - 4s - loss: 2.7852 - accuracy10: 0.5606 - val_loss: 3.0424 - val_accuracy10: 0.5044 - 4s/epoch - 33ms/step
Epoch 18/50
135/135 - 4s - loss: 2.7650 - accuracy10: 0.5663 - val_loss: 3.0423 - val_accuracy10: 0.5092 - 4s/epoch - 33ms/step
Epoch 19/50
135/135 - 5s - loss: 2.7494 - accuracy10: 0.5688 - val_loss: 3.0540 - val_accuracy10: 0.5074 - 5s/epoch - 34ms/step
Epoch 20/50
135/135 - 4s - loss: 2.7362 - accuracy10: 0.5730 - val_loss: 3.0541 - val_accuracy10: 0.5060 - 4s/epoch - 33ms/step
Epoch 21/50
135/135 - 4s - loss: 2.7130 - accuracy10: 0.5788 - val_loss: 3.0717 - val_accuracy10: 0.5021 - 4s/epoch - 33ms/step
Epoch 22/50
135/135 - 4s - loss: 2.6976 - accuracy10: 0.5812 - val_loss: 3.0778 - val_accuracy10: 0.4938 - 4s/epoch - 33ms/step
Epoch 23/50
135/135 - 4s - loss: 2.6858 - accuracy10: 0.5852 - val_loss: 3.0842 - val_accuracy10: 0.4992 - 4s/epoch - 33ms/step
Epoch 24/50
135/135 - 4s - loss: 2.6624 - accuracy10: 0.5893 - val_loss: 3.0680 - val_accuracy10: 0.5039 - 4s/epoch - 33ms/step
testing model: results/LILAK/W10/deepOF_L2/h10
Evaluating performance on  test set...
518/518 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0550748
{'0': {'precision': 0.5314452832075188, 'recall': 0.4180627654554035, 'f1-score': 0.4679844159274504, 'support': 50856}, '1': {'precision': 0.4021462077237775, 'recall': 0.5371498869911023, 'f1-score': 0.4599461048505635, 'support': 34953}, '2': {'precision': 0.48823836905384216, 'recall': 0.47901530045303015, 'f1-score': 0.4835828623204038, 'support': 46796}, 'accuracy': 0.4709626333848648, 'macro avg': {'precision': 0.4739432866617128, 'recall': 0.4780759842998454, 'f1-score': 0.4705044610328059, 'support': 132605}, 'weighted avg': {'precision': 0.4821160622873524, 'recall': 0.4709626333848648, 'f1-score': 0.47137027475882337, 'support': 132605}}
[[21261 15399 14196]
 [ 6878 18775  9300]
 [11867 12513 22416]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94759345
{'0': {'precision': 0.5900391244580734, 'recall': 0.4983922829581994, 'f1-score': 0.5403573330750981, 'support': 11196}, '1': {'precision': 0.519742551345097, 'recall': 0.6246306274986964, 'f1-score': 0.5673798057945844, 'support': 11506}, '2': {'precision': 0.5590793765857195, 'recall': 0.5310267665031414, 'f1-score': 0.544692120944604, 'support': 11619}, 'accuracy': 0.5517613123160747, 'macro avg': {'precision': 0.5562870174629633, 'recall': 0.5513498923200124, 'f1-score': 0.5508097532714289, 'support': 34321}, 'weighted avg': {'precision': 0.5559913496039961, 'recall': 0.5517613123160747, 'f1-score': 0.5508840214398368, 'support': 34321}}
[[5580 3295 2321]
 [1774 7187 2545]
 [2103 3346 6170]]
Evaluating performance on  val set...
46/46 - 1s - 722ms/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.012513
{'0': {'precision': 0.5083163116428363, 'recall': 0.46035940803382663, 'f1-score': 0.48315074192206353, 'support': 3784}, '1': {'precision': 0.5026683087027914, 'recall': 0.6002450980392157, 'f1-score': 0.5471403038427166, 'support': 4080}, '2': {'precision': 0.506355305941472, 'recall': 0.4486642221058146, 'f1-score': 0.47576725454797947, 'support': 3818}, 'accuracy': 0.5053929121725732, 'macro avg': {'precision': 0.5057799754290333, 'recall': 0.5030895760596189, 'f1-score': 0.5020194334375865, 'support': 11682}, 'weighted avg': {'precision': 0.5057028060989918, 'recall': 0.5053929121725732, 'f1-score': 0.5030863058530696, 'support': 11682}}
[[1742 1228  814]
 [ 775 2449  856]
 [ 910 1195 1713]]
training model: results/LILAK/W10/deepOF_L2/h20
Epoch 1/50
135/135 - 7s - loss: 3.3104 - accuracy20: 0.3756 - val_loss: 3.2744 - val_accuracy20: 0.4023 - 7s/epoch - 48ms/step
Epoch 2/50
135/135 - 4s - loss: 3.2388 - accuracy20: 0.4154 - val_loss: 3.2500 - val_accuracy20: 0.4183 - 4s/epoch - 33ms/step
Epoch 3/50
135/135 - 4s - loss: 3.1964 - accuracy20: 0.4350 - val_loss: 3.2337 - val_accuracy20: 0.4323 - 4s/epoch - 33ms/step
Epoch 4/50
135/135 - 5s - loss: 3.1671 - accuracy20: 0.4449 - val_loss: 3.2184 - val_accuracy20: 0.4361 - 5s/epoch - 34ms/step
Epoch 5/50
135/135 - 4s - loss: 3.1432 - accuracy20: 0.4555 - val_loss: 3.2137 - val_accuracy20: 0.4407 - 4s/epoch - 33ms/step
Epoch 6/50
135/135 - 4s - loss: 3.1258 - accuracy20: 0.4639 - val_loss: 3.1972 - val_accuracy20: 0.4450 - 4s/epoch - 33ms/step
Epoch 7/50
135/135 - 5s - loss: 3.1031 - accuracy20: 0.4681 - val_loss: 3.1919 - val_accuracy20: 0.4456 - 5s/epoch - 34ms/step
Epoch 8/50
135/135 - 4s - loss: 3.0879 - accuracy20: 0.4762 - val_loss: 3.1935 - val_accuracy20: 0.4449 - 4s/epoch - 33ms/step
Epoch 9/50
135/135 - 4s - loss: 3.0770 - accuracy20: 0.4792 - val_loss: 3.1940 - val_accuracy20: 0.4470 - 4s/epoch - 33ms/step
Epoch 10/50
135/135 - 4s - loss: 3.0634 - accuracy20: 0.4843 - val_loss: 3.1964 - val_accuracy20: 0.4457 - 4s/epoch - 33ms/step
Epoch 11/50
135/135 - 4s - loss: 3.0470 - accuracy20: 0.4890 - val_loss: 3.1945 - val_accuracy20: 0.4448 - 4s/epoch - 33ms/step
Epoch 12/50
135/135 - 4s - loss: 3.0341 - accuracy20: 0.4925 - val_loss: 3.1938 - val_accuracy20: 0.4442 - 4s/epoch - 33ms/step
Epoch 13/50
135/135 - 4s - loss: 3.0188 - accuracy20: 0.4960 - val_loss: 3.1936 - val_accuracy20: 0.4476 - 4s/epoch - 32ms/step
Epoch 14/50
135/135 - 4s - loss: 3.0051 - accuracy20: 0.4994 - val_loss: 3.1957 - val_accuracy20: 0.4488 - 4s/epoch - 33ms/step
Epoch 15/50
135/135 - 4s - loss: 2.9954 - accuracy20: 0.5022 - val_loss: 3.2117 - val_accuracy20: 0.4491 - 4s/epoch - 33ms/step
Epoch 16/50
135/135 - 5s - loss: 2.9808 - accuracy20: 0.5086 - val_loss: 3.2019 - val_accuracy20: 0.4457 - 5s/epoch - 33ms/step
Epoch 17/50
135/135 - 4s - loss: 2.9671 - accuracy20: 0.5080 - val_loss: 3.1970 - val_accuracy20: 0.4493 - 4s/epoch - 33ms/step
testing model: results/LILAK/W10/deepOF_L2/h20
Evaluating performance on  test set...
518/518 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0770711
{'0': {'precision': 0.5024164920234379, 'recall': 0.4393044128646223, 'f1-score': 0.46874563556194015, 'support': 53480}, '1': {'precision': 0.31158168697503846, 'recall': 0.4414239265243187, 'f1-score': 0.36530833032816445, 'support': 29833}, '2': {'precision': 0.45899306989765476, 'recall': 0.4057859287511158, 'f1-score': 0.43075266501561316, 'support': 49292}, 'accuracy': 0.4273217450322386, 'macro avg': {'precision': 0.4243304162987103, 'recall': 0.42883808938001894, 'f1-score': 0.4216022103019059, 'support': 132605}, 'weighted avg': {'precision': 0.4433417809459295, 'recall': 0.4273217450322386, 'f1-score': 0.43135191261628364, 'support': 132605}}
[[23494 15321 14665]
 [ 7753 13169  8911]
 [15515 13775 20002]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0297287
{'0': {'precision': 0.5052445929638912, 'recall': 0.47421153511064645, 'f1-score': 0.4892364388117388, 'support': 11478}, '1': {'precision': 0.45844207196520365, 'recall': 0.5063766596785465, 'f1-score': 0.4812186112148757, 'support': 11448}, '2': {'precision': 0.4654682197560305, 'recall': 0.44537077665642827, 'f1-score': 0.45519777558525426, 'support': 11395}, 'accuracy': 0.47536493691908743, 'macro avg': {'precision': 0.47638496156170845, 'recall': 0.47531965714854046, 'f1-score': 0.4752176085372896, 'support': 34321}, 'weighted avg': {'precision': 0.4764270458907714, 'recall': 0.47536493691908743, 'f1-score': 0.47526077791040494, 'support': 34321}}
[[5443 3368 2667]
 [2490 5797 3161]
 [2840 3480 5075]]
Evaluating performance on  val set...
46/46 - 1s - 666ms/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0656184
{'0': {'precision': 0.4548369855692143, 'recall': 0.4246506986027944, 'f1-score': 0.4392258064516129, 'support': 4008}, '1': {'precision': 0.42850709299707274, 'recall': 0.5059824514756713, 'f1-score': 0.4640331626432577, 'support': 3761}, '2': {'precision': 0.45841669048299516, 'recall': 0.40991566572961924, 'f1-score': 0.4328116567728009, 'support': 3913}, 'accuracy': 0.44589967471323405, 'macro avg': {'precision': 0.4472535896830941, 'recall': 0.4468496052693616, 'f1-score': 0.44535687528922385, 'support': 11682}, 'weighted avg': {'precision': 0.4475591786323713, 'recall': 0.44589967471323405, 'f1-score': 0.4450640104358266, 'support': 11682}}
[[1702 1329  977]
 [ 940 1903  918]
 [1100 1209 1604]]
training model: results/LILAK/W10/deepOF_L2/h30
Epoch 1/50
135/135 - 7s - loss: 3.3363 - accuracy30: 0.3561 - val_loss: 3.3119 - val_accuracy30: 0.3631 - 7s/epoch - 50ms/step
Epoch 2/50
135/135 - 4s - loss: 3.2815 - accuracy30: 0.3822 - val_loss: 3.2907 - val_accuracy30: 0.3731 - 4s/epoch - 33ms/step
Epoch 3/50
135/135 - 5s - loss: 3.2488 - accuracy30: 0.3993 - val_loss: 3.2814 - val_accuracy30: 0.3775 - 5s/epoch - 33ms/step
Epoch 4/50
135/135 - 4s - loss: 3.2280 - accuracy30: 0.4102 - val_loss: 3.2763 - val_accuracy30: 0.3871 - 4s/epoch - 33ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2070 - accuracy30: 0.4213 - val_loss: 3.2699 - val_accuracy30: 0.3954 - 4s/epoch - 33ms/step
Epoch 6/50
135/135 - 5s - loss: 3.1969 - accuracy30: 0.4255 - val_loss: 3.2541 - val_accuracy30: 0.4031 - 5s/epoch - 33ms/step
Epoch 7/50
135/135 - 4s - loss: 3.1726 - accuracy30: 0.4340 - val_loss: 3.2520 - val_accuracy30: 0.4023 - 4s/epoch - 33ms/step
Epoch 8/50
135/135 - 5s - loss: 3.1582 - accuracy30: 0.4417 - val_loss: 3.2469 - val_accuracy30: 0.4092 - 5s/epoch - 34ms/step
Epoch 9/50
135/135 - 5s - loss: 3.1489 - accuracy30: 0.4474 - val_loss: 3.2586 - val_accuracy30: 0.4030 - 5s/epoch - 34ms/step
Epoch 10/50
135/135 - 4s - loss: 3.1335 - accuracy30: 0.4512 - val_loss: 3.2584 - val_accuracy30: 0.4025 - 4s/epoch - 33ms/step
Epoch 11/50
135/135 - 4s - loss: 3.1168 - accuracy30: 0.4567 - val_loss: 3.2512 - val_accuracy30: 0.4124 - 4s/epoch - 33ms/step
Epoch 12/50
135/135 - 4s - loss: 3.1078 - accuracy30: 0.4619 - val_loss: 3.2473 - val_accuracy30: 0.4124 - 4s/epoch - 33ms/step
Epoch 13/50
135/135 - 4s - loss: 3.0919 - accuracy30: 0.4651 - val_loss: 3.2539 - val_accuracy30: 0.4057 - 4s/epoch - 33ms/step
Epoch 14/50
135/135 - 4s - loss: 3.0829 - accuracy30: 0.4696 - val_loss: 3.2572 - val_accuracy30: 0.4132 - 4s/epoch - 33ms/step
Epoch 15/50
135/135 - 4s - loss: 3.0705 - accuracy30: 0.4740 - val_loss: 3.2696 - val_accuracy30: 0.4107 - 4s/epoch - 33ms/step
Epoch 16/50
135/135 - 4s - loss: 3.0591 - accuracy30: 0.4781 - val_loss: 3.2723 - val_accuracy30: 0.4067 - 4s/epoch - 33ms/step
Epoch 17/50
135/135 - 4s - loss: 3.0436 - accuracy30: 0.4842 - val_loss: 3.2770 - val_accuracy30: 0.4087 - 4s/epoch - 33ms/step
Epoch 18/50
135/135 - 4s - loss: 3.0274 - accuracy30: 0.4885 - val_loss: 3.2628 - val_accuracy30: 0.4138 - 4s/epoch - 33ms/step
testing model: results/LILAK/W10/deepOF_L2/h30
Evaluating performance on  test set...
518/518 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0874842
{'0': {'precision': 0.4515656437403551, 'recall': 0.4475008711138643, 'f1-score': 0.4495240687985533, 'support': 51658}, '1': {'precision': 0.29032139577594124, 'recall': 0.23986404467103667, 'f1-score': 0.26269172607474617, 'support': 32952}, '2': {'precision': 0.41305110081753926, 'recall': 0.4663402437753933, 'f1-score': 0.4380810710301227, 'support': 47995}, 'accuracy': 0.4027223709513216, 'macro avg': {'precision': 0.3849793801112786, 'recall': 0.3845683865200981, 'f1-score': 0.3834322886344741, 'support': 132605}, 'weighted avg': {'precision': 0.39755692652378016, 'recall': 0.4027223709513216, 'f1-score': 0.39895504021493483, 'support': 132605}}
[[23117  9990 18551]
 [11794  7904 13254]
 [16282  9331 22382]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0483874
{'0': {'precision': 0.4747006240512734, 'recall': 0.48956340233084017, 'f1-score': 0.482017468744648, 'support': 11498}, '1': {'precision': 0.4328455994758681, 'recall': 0.34860610324509717, 'f1-score': 0.3861853962686931, 'support': 11371}, '2': {'precision': 0.42577978203682826, 'recall': 0.4946734194900454, 'f1-score': 0.4576483418831038, 'support': 11452}, 'accuracy': 0.4445674659829259, 'macro avg': {'precision': 0.4444420018546566, 'recall': 0.44428097502199426, 'f1-score': 0.441950402298815, 'support': 34321}, 'weighted avg': {'precision': 0.4445099254353718, 'recall': 0.4445674659829259, 'f1-score': 0.44213571305738686, 'support': 34321}}
[[5629 2526 3343]
 [3110 3964 4297]
 [3119 2668 5665]]
Evaluating performance on  val set...
46/46 - 1s - 687ms/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0849515
{'0': {'precision': 0.4218225419664269, 'recall': 0.43964008997750564, 'f1-score': 0.43054705666381105, 'support': 4001}, '1': {'precision': 0.3861776295847226, 'recall': 0.3320302319520459, 'f1-score': 0.35706278026905824, 'support': 3837}, '2': {'precision': 0.3997151673391882, 'recall': 0.4380853277835588, 'f1-score': 0.4180215961275909, 'support': 3844}, 'accuracy': 0.40378359869885294, 'macro avg': {'precision': 0.40257177963011265, 'recall': 0.40325188323770345, 'f1-score': 0.4018771443534867, 'support': 11682}, 'weighted avg': {'precision': 0.4028403234357212, 'recall': 0.40378359869885294, 'f1-score': 0.4022893063789371, 'support': 11682}}
[[1759 1032 1210]
 [1244 1274 1319]
 [1167  993 1684]]
training model: results/LILAK/W10/deepOF_L2/h50
Epoch 1/50
135/135 - 7s - loss: 3.3459 - accuracy50: 0.3412 - val_loss: 3.3357 - val_accuracy50: 0.3460 - 7s/epoch - 48ms/step
Epoch 2/50
135/135 - 4s - loss: 3.3071 - accuracy50: 0.3644 - val_loss: 3.3229 - val_accuracy50: 0.3527 - 4s/epoch - 33ms/step
Epoch 3/50
135/135 - 5s - loss: 3.2860 - accuracy50: 0.3760 - val_loss: 3.3101 - val_accuracy50: 0.3634 - 5s/epoch - 36ms/step
Epoch 4/50
135/135 - 4s - loss: 3.2698 - accuracy50: 0.3811 - val_loss: 3.3089 - val_accuracy50: 0.3647 - 4s/epoch - 33ms/step
Epoch 5/50
135/135 - 5s - loss: 3.2505 - accuracy50: 0.3927 - val_loss: 3.3067 - val_accuracy50: 0.3712 - 5s/epoch - 34ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2463 - accuracy50: 0.3978 - val_loss: 3.3015 - val_accuracy50: 0.3731 - 4s/epoch - 33ms/step
Epoch 7/50
135/135 - 4s - loss: 3.2285 - accuracy50: 0.4056 - val_loss: 3.2944 - val_accuracy50: 0.3734 - 4s/epoch - 33ms/step
Epoch 8/50
135/135 - 4s - loss: 3.2197 - accuracy50: 0.4113 - val_loss: 3.2986 - val_accuracy50: 0.3850 - 4s/epoch - 32ms/step
Epoch 9/50
135/135 - 4s - loss: 3.2120 - accuracy50: 0.4167 - val_loss: 3.3018 - val_accuracy50: 0.3803 - 4s/epoch - 32ms/step
Epoch 10/50
135/135 - 4s - loss: 3.2010 - accuracy50: 0.4260 - val_loss: 3.3071 - val_accuracy50: 0.3765 - 4s/epoch - 32ms/step
Epoch 11/50
135/135 - 4s - loss: 3.1872 - accuracy50: 0.4278 - val_loss: 3.2965 - val_accuracy50: 0.3820 - 4s/epoch - 32ms/step
Epoch 12/50
135/135 - 4s - loss: 3.1788 - accuracy50: 0.4307 - val_loss: 3.3060 - val_accuracy50: 0.3834 - 4s/epoch - 33ms/step
Epoch 13/50
135/135 - 4s - loss: 3.1658 - accuracy50: 0.4410 - val_loss: 3.3090 - val_accuracy50: 0.3848 - 4s/epoch - 33ms/step
Epoch 14/50
135/135 - 4s - loss: 3.1565 - accuracy50: 0.4419 - val_loss: 3.3074 - val_accuracy50: 0.3866 - 4s/epoch - 32ms/step
Epoch 15/50
135/135 - 4s - loss: 3.1462 - accuracy50: 0.4480 - val_loss: 3.3144 - val_accuracy50: 0.3867 - 4s/epoch - 32ms/step
Epoch 16/50
135/135 - 4s - loss: 3.1332 - accuracy50: 0.4505 - val_loss: 3.3105 - val_accuracy50: 0.3847 - 4s/epoch - 32ms/step
Epoch 17/50
135/135 - 4s - loss: 3.1240 - accuracy50: 0.4576 - val_loss: 3.3267 - val_accuracy50: 0.3840 - 4s/epoch - 32ms/step
testing model: results/LILAK/W10/deepOF_L2/h50
Evaluating performance on  test set...
518/518 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0920582
{'0': {'precision': 0.4243807366194133, 'recall': 0.49347228140859256, 'f1-score': 0.4563260700180016, 'support': 51626}, '1': {'precision': 0.2763763579451298, 'recall': 0.13686098109537415, 'f1-score': 0.18306738489683913, 'support': 32902}, '2': {'precision': 0.3962793838062579, 'recall': 0.4639016577573476, 'f1-score': 0.42743249199869676, 'support': 48077}, 'accuracy': 0.3942686927340598, 'macro avg': {'precision': 0.36567882612360036, 'recall': 0.36474497342043816, 'f1-score': 0.35560864897117916, 'support': 132605}, 'weighted avg': {'precision': 0.3774694677657551, 'recall': 0.3942686927340598, 'f1-score': 0.37804943031142485, 'support': 132605}}
[[25476  6091 20059]
 [14480  4503 13919]
 [20075  5699 22303]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0723823
{'0': {'precision': 0.4217860790894499, 'recall': 0.4990934990934991, 'f1-score': 0.45719482779073906, 'support': 11583}, '1': {'precision': 0.4128768523249872, 'recall': 0.21714592851384037, 'f1-score': 0.28460725607608317, 'support': 11163}, '2': {'precision': 0.39568638090070535, 'recall': 0.5040172786177106, 'f1-score': 0.4433299137505224, 'support': 11575}, 'accuracy': 0.40904985285976514, 'macro avg': {'precision': 0.41011643743838083, 'recall': 0.40675223540835, 'f1-score': 0.39504399920578154, 'support': 34321}, 'weighted avg': {'precision': 0.41008602067313293, 'recall': 0.40904985285976514, 'f1-score': 0.39638420330234386, 'support': 34321}}
[[5781 1612 4190]
 [4019 2424 4720]
 [3906 1835 5834]]
Evaluating performance on  val set...
46/46 - 1s - 694ms/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0971621
{'0': {'precision': 0.3915599412135209, 'recall': 0.4634691848906561, 'f1-score': 0.42449072493456247, 'support': 4024}, '1': {'precision': 0.3484848484848485, 'recall': 0.1887741593857559, 'f1-score': 0.24489094968229436, 'support': 3777}, '2': {'precision': 0.36630412476913604, 'recall': 0.45993300695696987, 'f1-score': 0.40781357093899934, 'support': 3881}, 'accuracy': 0.3734805683958226, 'macro avg': {'precision': 0.36878297148916844, 'recall': 0.37072545041112726, 'f1-score': 0.3590650818519521, 'support': 11682}, 'weighted avg': {'precision': 0.3692424913884179, 'recall': 0.3734805683958226, 'f1-score': 0.36088240565836005, 'support': 11682}}
[[1865  655 1504]
 [1480  713 1584]
 [1418  678 1785]]
training model: results/LILAK/W10/deepOF_L2/h100
Epoch 1/50
135/135 - 7s - loss: 3.3455 - accuracy100: 0.3434 - val_loss: 3.3544 - val_accuracy100: 0.3407 - 7s/epoch - 49ms/step
Epoch 2/50
135/135 - 4s - loss: 3.3232 - accuracy100: 0.3514 - val_loss: 3.3355 - val_accuracy100: 0.3492 - 4s/epoch - 33ms/step
Epoch 3/50
135/135 - 5s - loss: 3.3008 - accuracy100: 0.3617 - val_loss: 3.3247 - val_accuracy100: 0.3505 - 5s/epoch - 34ms/step
Epoch 4/50
135/135 - 5s - loss: 3.2900 - accuracy100: 0.3667 - val_loss: 3.3203 - val_accuracy100: 0.3610 - 5s/epoch - 34ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2774 - accuracy100: 0.3763 - val_loss: 3.3245 - val_accuracy100: 0.3556 - 4s/epoch - 33ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2709 - accuracy100: 0.3818 - val_loss: 3.3202 - val_accuracy100: 0.3605 - 4s/epoch - 33ms/step
Epoch 7/50
135/135 - 4s - loss: 3.2618 - accuracy100: 0.3878 - val_loss: 3.3137 - val_accuracy100: 0.3668 - 4s/epoch - 33ms/step
Epoch 8/50
135/135 - 5s - loss: 3.2521 - accuracy100: 0.3950 - val_loss: 3.3130 - val_accuracy100: 0.3643 - 5s/epoch - 34ms/step
Epoch 9/50
135/135 - 4s - loss: 3.2432 - accuracy100: 0.3974 - val_loss: 3.3139 - val_accuracy100: 0.3700 - 4s/epoch - 33ms/step
Epoch 10/50
135/135 - 4s - loss: 3.2396 - accuracy100: 0.4026 - val_loss: 3.3189 - val_accuracy100: 0.3701 - 4s/epoch - 33ms/step
Epoch 11/50
135/135 - 4s - loss: 3.2275 - accuracy100: 0.4088 - val_loss: 3.3136 - val_accuracy100: 0.3745 - 4s/epoch - 33ms/step
Epoch 12/50
135/135 - 4s - loss: 3.2164 - accuracy100: 0.4139 - val_loss: 3.3317 - val_accuracy100: 0.3686 - 4s/epoch - 33ms/step
Epoch 13/50
135/135 - 4s - loss: 3.2119 - accuracy100: 0.4178 - val_loss: 3.3329 - val_accuracy100: 0.3626 - 4s/epoch - 33ms/step
Epoch 14/50
135/135 - 4s - loss: 3.2005 - accuracy100: 0.4226 - val_loss: 3.3398 - val_accuracy100: 0.3671 - 4s/epoch - 33ms/step
Epoch 15/50
135/135 - 4s - loss: 3.1932 - accuracy100: 0.4227 - val_loss: 3.3332 - val_accuracy100: 0.3671 - 4s/epoch - 33ms/step
Epoch 16/50
135/135 - 4s - loss: 3.1834 - accuracy100: 0.4290 - val_loss: 3.3351 - val_accuracy100: 0.3743 - 4s/epoch - 33ms/step
Epoch 17/50
135/135 - 4s - loss: 3.1683 - accuracy100: 0.4337 - val_loss: 3.3553 - val_accuracy100: 0.3694 - 4s/epoch - 32ms/step
Epoch 18/50
135/135 - 5s - loss: 3.1629 - accuracy100: 0.4401 - val_loss: 3.3400 - val_accuracy100: 0.3763 - 5s/epoch - 34ms/step
testing model: results/LILAK/W10/deepOF_L2/h100
Evaluating performance on  test set...
518/518 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1039811
{'0': {'precision': 0.44571488239747303, 'recall': 0.3088919041157847, 'f1-score': 0.36489923275843644, 'support': 55275}, '1': {'precision': 0.21805017013531694, 'recall': 0.20083087351044057, 'f1-score': 0.209086597742578, 'support': 27441}, '2': {'precision': 0.3917333101529903, 'recall': 0.5419832027100162, 'f1-score': 0.4547694532977891, 'support': 49889}, 'accuracy': 0.37422419969081105, 'macro avg': {'precision': 0.3518327875619267, 'recall': 0.35056866011208054, 'f1-score': 0.34291842793293453, 'support': 132605}, 'weighted avg': {'precision': 0.37829333700408047, 'recall': 0.37422419969081105, 'f1-score': 0.36646690301987145, 'support': 132605}}
[[17074 10314 27887]
 [ 7832  5511 14098]
 [13401  9449 27039]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0840116
{'0': {'precision': 0.41781358397672597, 'recall': 0.3263700725461061, 'f1-score': 0.36647364805182053, 'support': 11441}, '1': {'precision': 0.3897687280040221, 'recall': 0.27461919943322705, 'f1-score': 0.3222152950955943, 'support': 11292}, '2': {'precision': 0.38352077117282535, 'recall': 0.5768035899206075, 'f1-score': 0.46071133167907363, 'support': 11588}, 'accuracy': 0.393898779173101, 'macro avg': {'precision': 0.3970343610511911, 'recall': 0.39259762063331355, 'f1-score': 0.3831334249421628, 'support': 34321}, 'weighted avg': {'precision': 0.39700802387022055, 'recall': 0.393898779173101, 'f1-score': 0.38373016611046984, 'support': 34321}}
[[3734 2469 5238]
 [2685 3101 5506]
 [2518 2386 6684]]
Evaluating performance on  val set...
46/46 - 1s - 692ms/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1041789
{'0': {'precision': 0.4150477952513105, 'recall': 0.30963883137796183, 'f1-score': 0.35467720685111986, 'support': 4347}, '1': {'precision': 0.30836501901140684, 'recall': 0.24354354354354354, 'f1-score': 0.2721476510067114, 'support': 3330}, '2': {'precision': 0.3647787915303839, 'recall': 0.5290886392009988, 'f1-score': 0.43183207662522927, 'support': 4005}, 'accuracy': 0.3660332134908406, 'macro avg': {'precision': 0.3627305352643671, 'recall': 0.3607570047075013, 'f1-score': 0.35288564482768686, 'support': 11682}, 'weighted avg': {'precision': 0.3674034702400804, 'recall': 0.3660332134908406, 'f1-score': 0.3576032325730363, 'support': 11682}}
[[1346  936 2065]
 [ 894  811 1625]
 [1003  883 2119]]
training model: results/LILAK/W10/deepOF_L2/h200
Epoch 1/50
135/135 - 7s - loss: 3.3455 - accuracy200: 0.3430 - val_loss: 3.3439 - val_accuracy200: 0.3354 - 7s/epoch - 52ms/step
Epoch 2/50
135/135 - 5s - loss: 3.3268 - accuracy200: 0.3458 - val_loss: 3.3382 - val_accuracy200: 0.3338 - 5s/epoch - 34ms/step
Epoch 3/50
135/135 - 5s - loss: 3.3039 - accuracy200: 0.3569 - val_loss: 3.3325 - val_accuracy200: 0.3336 - 5s/epoch - 34ms/step
Epoch 4/50
135/135 - 4s - loss: 3.2952 - accuracy200: 0.3569 - val_loss: 3.3193 - val_accuracy200: 0.3496 - 4s/epoch - 33ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2828 - accuracy200: 0.3685 - val_loss: 3.3267 - val_accuracy200: 0.3471 - 4s/epoch - 33ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2794 - accuracy200: 0.3729 - val_loss: 3.3204 - val_accuracy200: 0.3505 - 4s/epoch - 33ms/step
Epoch 7/50
135/135 - 4s - loss: 3.2658 - accuracy200: 0.3817 - val_loss: 3.3201 - val_accuracy200: 0.3512 - 4s/epoch - 33ms/step
Epoch 8/50
135/135 - 4s - loss: 3.2601 - accuracy200: 0.3873 - val_loss: 3.3205 - val_accuracy200: 0.3527 - 4s/epoch - 33ms/step
Epoch 9/50
135/135 - 5s - loss: 3.2508 - accuracy200: 0.3926 - val_loss: 3.3249 - val_accuracy200: 0.3511 - 5s/epoch - 34ms/step
Epoch 10/50
135/135 - 4s - loss: 3.2420 - accuracy200: 0.3960 - val_loss: 3.3325 - val_accuracy200: 0.3522 - 4s/epoch - 33ms/step
Epoch 11/50
135/135 - 5s - loss: 3.2323 - accuracy200: 0.4035 - val_loss: 3.3354 - val_accuracy200: 0.3526 - 5s/epoch - 34ms/step
Epoch 12/50
135/135 - 4s - loss: 3.2254 - accuracy200: 0.4075 - val_loss: 3.3484 - val_accuracy200: 0.3495 - 4s/epoch - 33ms/step
Epoch 13/50
135/135 - 4s - loss: 3.2150 - accuracy200: 0.4115 - val_loss: 3.3412 - val_accuracy200: 0.3543 - 4s/epoch - 33ms/step
Epoch 14/50
135/135 - 4s - loss: 3.2069 - accuracy200: 0.4176 - val_loss: 3.3560 - val_accuracy200: 0.3485 - 4s/epoch - 33ms/step
testing model: results/LILAK/W10/deepOF_L2/h200
Evaluating performance on  test set...
518/518 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1132926
{'0': {'precision': 0.3965113556544135, 'recall': 0.2607340120474972, 'f1-score': 0.31459787063590666, 'support': 51961}, '1': {'precision': 0.27451077410257047, 'recall': 0.30136614248078436, 'f1-score': 0.28731227343345417, 'support': 36819}, '2': {'precision': 0.3359418091560949, 'recall': 0.4447233314318311, 'f1-score': 0.38275350791920737, 'support': 43825}, 'accuracy': 0.3328230458881641, 'macro avg': {'precision': 0.33565464630435965, 'recall': 0.33560782865337085, 'f1-score': 0.32822121732952275, 'support': 132605}, 'weighted avg': {'precision': 0.34261897009243525, 'recall': 0.3328230458881641, 'f1-score': 0.3295467217391347, 'support': 132605}}
[[13548 16211 22202]
 [ 9399 11096 16324]
 [11221 13114 19490]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0952355
{'0': {'precision': 0.3764153216092508, 'recall': 0.27105559892445136, 'f1-score': 0.3151631284352781, 'support': 11529}, '1': {'precision': 0.36800282535758433, 'recall': 0.3691762621789194, 'f1-score': 0.36858860983374603, 'support': 11290}, '2': {'precision': 0.36793030694888723, 'recall': 0.4700052164840897, 'f1-score': 0.41275052490933384, 'support': 11502}, 'accuracy': 0.3700067014364383, 'macro avg': {'precision': 0.3707828179719075, 'recall': 0.37007902586248687, 'f1-score': 0.36550075439278595, 'support': 34321}, 'weighted avg': {'precision': 0.3708044209564489, 'recall': 0.3700067014364383, 'f1-score': 0.36544208065792, 'support': 34321}}
[[3125 3653 4751]
 [2586 4168 4536]
 [2591 3505 5406]]
Evaluating performance on  val set...
46/46 - 1s - 715ms/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1081628
{'0': {'precision': 0.40218504609081596, 'recall': 0.2683371298405467, 'f1-score': 0.3219018991665528, 'support': 4390}, '1': {'precision': 0.3107996702390767, 'recall': 0.33041191936897457, 'f1-score': 0.32030586236193714, 'support': 3423}, '2': {'precision': 0.3377004301916308, 'recall': 0.4463685706901008, 'f1-score': 0.3845040632305466, 'support': 3869}, 'accuracy': 0.34548878616675227, 'macro avg': {'precision': 0.35022838217384117, 'recall': 0.3483725399665407, 'f1-score': 0.34223727491967887, 'support': 11682}, 'weighted avg': {'precision': 0.3540508977896303, 'recall': 0.34548878616675227, 'f1-score': 0.34216765321392417, 'support': 11682}}
[[1178 1294 1918]
 [ 823 1131 1469]
 [ 928 1214 1727]]
training model: results/LILAK/W10/deepOF_L2/h300
Epoch 1/50
135/135 - 7s - loss: 3.3508 - accuracy300: 0.3381 - val_loss: 3.3589 - val_accuracy300: 0.3292 - 7s/epoch - 48ms/step
Epoch 2/50
135/135 - 4s - loss: 3.3308 - accuracy300: 0.3448 - val_loss: 3.3484 - val_accuracy300: 0.3240 - 4s/epoch - 33ms/step
Epoch 3/50
135/135 - 4s - loss: 3.3104 - accuracy300: 0.3528 - val_loss: 3.3487 - val_accuracy300: 0.3220 - 4s/epoch - 33ms/step
Epoch 4/50
135/135 - 5s - loss: 3.2993 - accuracy300: 0.3568 - val_loss: 3.3383 - val_accuracy300: 0.3276 - 5s/epoch - 34ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2886 - accuracy300: 0.3644 - val_loss: 3.3344 - val_accuracy300: 0.3294 - 4s/epoch - 33ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2803 - accuracy300: 0.3713 - val_loss: 3.3408 - val_accuracy300: 0.3327 - 4s/epoch - 33ms/step
Epoch 7/50
135/135 - 5s - loss: 3.2707 - accuracy300: 0.3765 - val_loss: 3.3335 - val_accuracy300: 0.3329 - 5s/epoch - 33ms/step
Epoch 8/50
135/135 - 4s - loss: 3.2635 - accuracy300: 0.3808 - val_loss: 3.3332 - val_accuracy300: 0.3338 - 4s/epoch - 33ms/step
Epoch 9/50
135/135 - 4s - loss: 3.2579 - accuracy300: 0.3841 - val_loss: 3.3371 - val_accuracy300: 0.3350 - 4s/epoch - 33ms/step
Epoch 10/50
135/135 - 4s - loss: 3.2468 - accuracy300: 0.3919 - val_loss: 3.3385 - val_accuracy300: 0.3340 - 4s/epoch - 33ms/step
Epoch 11/50
135/135 - 4s - loss: 3.2407 - accuracy300: 0.3965 - val_loss: 3.3423 - val_accuracy300: 0.3363 - 4s/epoch - 33ms/step
Epoch 12/50
135/135 - 4s - loss: 3.2293 - accuracy300: 0.4046 - val_loss: 3.3427 - val_accuracy300: 0.3390 - 4s/epoch - 33ms/step
Epoch 13/50
135/135 - 4s - loss: 3.2212 - accuracy300: 0.4056 - val_loss: 3.3397 - val_accuracy300: 0.3433 - 4s/epoch - 33ms/step
Epoch 14/50
135/135 - 5s - loss: 3.2167 - accuracy300: 0.4111 - val_loss: 3.3584 - val_accuracy300: 0.3395 - 5s/epoch - 33ms/step
Epoch 15/50
135/135 - 4s - loss: 3.2045 - accuracy300: 0.4181 - val_loss: 3.3590 - val_accuracy300: 0.3422 - 4s/epoch - 33ms/step
Epoch 16/50
135/135 - 4s - loss: 3.1954 - accuracy300: 0.4187 - val_loss: 3.3640 - val_accuracy300: 0.3450 - 4s/epoch - 32ms/step
Epoch 17/50
135/135 - 4s - loss: 3.1858 - accuracy300: 0.4269 - val_loss: 3.3667 - val_accuracy300: 0.3501 - 4s/epoch - 33ms/step
Epoch 18/50
135/135 - 4s - loss: 3.1733 - accuracy300: 0.4324 - val_loss: 3.3803 - val_accuracy300: 0.3414 - 4s/epoch - 32ms/step
testing model: results/LILAK/W10/deepOF_L2/h300
Evaluating performance on  test set...
518/518 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1173948
{'0': {'precision': 0.4178098773402195, 'recall': 0.1927838698266714, 'f1-score': 0.26383173879256533, 'support': 53713}, '1': {'precision': 0.24788386568739365, 'recall': 0.3416045828262741, 'f1-score': 0.2872940589116325, 'support': 33691}, '2': {'precision': 0.34227586656241854, 'recall': 0.4648790955952302, 'f1-score': 0.39426603998386384, 'support': 45201}, 'accuracy': 0.32334376531804987, 'macro avg': {'precision': 0.3359898698633439, 'recall': 0.33308918274939187, 'f1-score': 0.3151306125626872, 'support': 132605}, 'weighted avg': {'precision': 0.3488894740389659, 'recall': 0.32334376531804987, 'f1-score': 0.314253893879322, 'support': 132605}}
[[10355 18992 24366]
 [ 6169 11509 16013]
 [ 8260 15928 21013]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0842719
{'0': {'precision': 0.42285430792128326, 'recall': 0.2206021913553619, 'f1-score': 0.2899421703140945, 'support': 11591}, '1': {'precision': 0.37516485041993475, 'recall': 0.4732510288065844, 'f1-score': 0.41853802075267155, 'support': 11421}, '2': {'precision': 0.3842215331362227, 'recall': 0.4711291891413918, 'f1-score': 0.4232602478551001, 'support': 11309}, 'accuracy': 0.3872264794149355, 'macro avg': {'precision': 0.3940802304924802, 'recall': 0.3883274697677794, 'f1-score': 0.3772468129739554, 'support': 34321}, 'weighted avg': {'precision': 0.39425492724568667, 'recall': 0.3872264794149355, 'f1-score': 0.3766642164890376, 'support': 34321}}
[[2557 4739 4295]
 [1772 5405 4244]
 [1718 4263 5328]]
Evaluating performance on  val set...
46/46 - 1s - 712ms/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1135293
{'0': {'precision': 0.41305340027384757, 'recall': 0.19474930062405854, 'f1-score': 0.2646972799064054, 'support': 4647}, '1': {'precision': 0.2688916876574307, 'recall': 0.4168564920273349, 'f1-score': 0.3269108077070308, 'support': 3073}, '2': {'precision': 0.3503279035328961, 'recall': 0.41797072185764766, 'f1-score': 0.38117159627114744, 'support': 3962}, 'accuracy': 0.3288820407464475, 'macro avg': {'precision': 0.3440909971547248, 'recall': 0.3431921715030137, 'f1-score': 0.32425989462819454, 'support': 11682}, 'weighted avg': {'precision': 0.35385742689960525, 'recall': 0.3288820407464475, 'f1-score': 0.3205655740656615, 'support': 11682}}
[[ 905 1906 1836]
 [ 557 1281 1235]
 [ 729 1577 1656]]
training model: results/LILAK/W10/deepOF_L2/h500
Epoch 1/50
135/135 - 7s - loss: 3.3534 - accuracy500: 0.3370 - val_loss: 3.3360 - val_accuracy500: 0.3450 - 7s/epoch - 48ms/step
Epoch 2/50
135/135 - 5s - loss: 3.3244 - accuracy500: 0.3471 - val_loss: 3.3297 - val_accuracy500: 0.3428 - 5s/epoch - 33ms/step
Epoch 3/50
135/135 - 4s - loss: 3.3073 - accuracy500: 0.3542 - val_loss: 3.3327 - val_accuracy500: 0.3318 - 4s/epoch - 32ms/step
Epoch 4/50
135/135 - 4s - loss: 3.2972 - accuracy500: 0.3612 - val_loss: 3.3208 - val_accuracy500: 0.3396 - 4s/epoch - 33ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2903 - accuracy500: 0.3610 - val_loss: 3.3265 - val_accuracy500: 0.3359 - 4s/epoch - 32ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2810 - accuracy500: 0.3728 - val_loss: 3.3330 - val_accuracy500: 0.3350 - 4s/epoch - 32ms/step
Epoch 7/50
135/135 - 4s - loss: 3.2712 - accuracy500: 0.3767 - val_loss: 3.3285 - val_accuracy500: 0.3392 - 4s/epoch - 32ms/step
Epoch 8/50
135/135 - 4s - loss: 3.2641 - accuracy500: 0.3818 - val_loss: 3.3341 - val_accuracy500: 0.3338 - 4s/epoch - 33ms/step
Epoch 9/50
135/135 - 4s - loss: 3.2556 - accuracy500: 0.3852 - val_loss: 3.3326 - val_accuracy500: 0.3404 - 4s/epoch - 33ms/step
Epoch 10/50
135/135 - 4s - loss: 3.2526 - accuracy500: 0.3898 - val_loss: 3.3361 - val_accuracy500: 0.3345 - 4s/epoch - 32ms/step
Epoch 11/50
135/135 - 4s - loss: 3.2444 - accuracy500: 0.3971 - val_loss: 3.3379 - val_accuracy500: 0.3420 - 4s/epoch - 32ms/step
Epoch 12/50
135/135 - 4s - loss: 3.2327 - accuracy500: 0.4029 - val_loss: 3.3423 - val_accuracy500: 0.3336 - 4s/epoch - 32ms/step
Epoch 13/50
135/135 - 5s - loss: 3.2261 - accuracy500: 0.4058 - val_loss: 3.3557 - val_accuracy500: 0.3311 - 5s/epoch - 33ms/step
Epoch 14/50
135/135 - 4s - loss: 3.2222 - accuracy500: 0.4090 - val_loss: 3.3628 - val_accuracy500: 0.3309 - 4s/epoch - 32ms/step
testing model: results/LILAK/W10/deepOF_L2/h500
Evaluating performance on  test set...
518/518 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1117885
{'0': {'precision': 0.3966859086692094, 'recall': 0.291252767213487, 'f1-score': 0.33589002236648297, 'support': 52851}, '1': {'precision': 0.2607988852763586, 'recall': 0.15597222222222223, 'f1-score': 0.1952025030418912, 'support': 36000}, '2': {'precision': 0.32888710547799255, 'recall': 0.5432417607533025, 'f1-score': 0.40972204266321915, 'support': 43754}, 'accuracy': 0.33767203348290037, 'macro avg': {'precision': 0.3287906331411868, 'recall': 0.33015558339633727, 'f1-score': 0.31360485602386445, 'support': 132605}, 'weighted avg': {'precision': 0.3374241788930235, 'recall': 0.33767203348290037, 'f1-score': 0.32205717685068863, 'support': 132605}}
[[15393  8681 28777]
 [10660  5615 19725]
 [12751  7234 23769]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0977179
{'0': {'precision': 0.36976908339215486, 'recall': 0.3134723884424688, 'f1-score': 0.3393014110571363, 'support': 11698}, '1': {'precision': 0.35910855985142665, 'recall': 0.18806366047745357, 'f1-score': 0.2468519700574479, 'support': 11310}, '2': {'precision': 0.3537146258319355, 'recall': 0.5778308141076638, 'f1-score': 0.4388131838625227, 'support': 11313}, 'accuracy': 0.3592844031351068, 'macro avg': {'precision': 0.360864089691839, 'recall': 0.3597889543425287, 'f1-score': 0.3416555216590356, 'support': 34321}, 'weighted avg': {'precision': 0.36096413599480637, 'recall': 0.3592844031351068, 'f1-score': 0.34163740091876216, 'support': 34321}}
[[3667 1975 6056]
 [3295 2127 5888]
 [2955 1821 6537]]
Evaluating performance on  val set...
46/46 - 1s - 699ms/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1089884
{'0': {'precision': 0.4174418604651163, 'recall': 0.31278588542801133, 'f1-score': 0.3576142448013946, 'support': 4591}, '1': {'precision': 0.29420432220039294, 'recall': 0.17785035629453683, 'f1-score': 0.2216876387860844, 'support': 3368}, '2': {'precision': 0.324041250402836, 'recall': 0.5401557883427344, 'f1-score': 0.40507603988317054, 'support': 3723}, 'accuracy': 0.34634480397192263, 'macro avg': {'precision': 0.34522914435611507, 'recall': 0.34359734335509423, 'f1-score': 0.3281259744902165, 'support': 11682}, 'weighted avg': {'precision': 0.35214529308474835, 'recall': 0.34634480397192263, 'f1-score': 0.3335515375620423, 'support': 11682}}
[[1436  768 2387]
 [ 961  599 1808]
 [1043  669 2011]]
training model: results/LILAK/W10/deepOF_L2/h1000
Epoch 1/50
135/135 - 7s - loss: 3.3550 - accuracy1000: 0.3368 - val_loss: 3.3559 - val_accuracy1000: 0.3316 - 7s/epoch - 48ms/step
Epoch 2/50
135/135 - 4s - loss: 3.3311 - accuracy1000: 0.3405 - val_loss: 3.3512 - val_accuracy1000: 0.3291 - 4s/epoch - 33ms/step
Epoch 3/50
135/135 - 4s - loss: 3.3142 - accuracy1000: 0.3528 - val_loss: 3.3501 - val_accuracy1000: 0.3252 - 4s/epoch - 33ms/step
Epoch 4/50
135/135 - 4s - loss: 3.3017 - accuracy1000: 0.3582 - val_loss: 3.3434 - val_accuracy1000: 0.3315 - 4s/epoch - 33ms/step
Epoch 5/50
135/135 - 4s - loss: 3.2923 - accuracy1000: 0.3637 - val_loss: 3.3460 - val_accuracy1000: 0.3221 - 4s/epoch - 33ms/step
Epoch 6/50
135/135 - 4s - loss: 3.2864 - accuracy1000: 0.3701 - val_loss: 3.3468 - val_accuracy1000: 0.3320 - 4s/epoch - 33ms/step
Epoch 7/50
135/135 - 4s - loss: 3.2749 - accuracy1000: 0.3762 - val_loss: 3.3432 - val_accuracy1000: 0.3267 - 4s/epoch - 33ms/step
Epoch 8/50
135/135 - 4s - loss: 3.2695 - accuracy1000: 0.3787 - val_loss: 3.3517 - val_accuracy1000: 0.3258 - 4s/epoch - 32ms/step
Epoch 9/50
135/135 - 4s - loss: 3.2620 - accuracy1000: 0.3841 - val_loss: 3.3495 - val_accuracy1000: 0.3254 - 4s/epoch - 33ms/step
Epoch 10/50
135/135 - 4s - loss: 3.2574 - accuracy1000: 0.3867 - val_loss: 3.3560 - val_accuracy1000: 0.3288 - 4s/epoch - 33ms/step
Epoch 11/50
135/135 - 5s - loss: 3.2467 - accuracy1000: 0.3934 - val_loss: 3.3556 - val_accuracy1000: 0.3266 - 5s/epoch - 33ms/step
Epoch 12/50
135/135 - 4s - loss: 3.2395 - accuracy1000: 0.3979 - val_loss: 3.3597 - val_accuracy1000: 0.3255 - 4s/epoch - 33ms/step
Epoch 13/50
135/135 - 4s - loss: 3.2298 - accuracy1000: 0.4011 - val_loss: 3.3640 - val_accuracy1000: 0.3279 - 4s/epoch - 32ms/step
Epoch 14/50
135/135 - 4s - loss: 3.2256 - accuracy1000: 0.4046 - val_loss: 3.3773 - val_accuracy1000: 0.3179 - 4s/epoch - 33ms/step
Epoch 15/50
135/135 - 5s - loss: 3.2117 - accuracy1000: 0.4105 - val_loss: 3.3917 - val_accuracy1000: 0.3186 - 5s/epoch - 34ms/step
Epoch 16/50
135/135 - 4s - loss: 3.2030 - accuracy1000: 0.4179 - val_loss: 3.3920 - val_accuracy1000: 0.3214 - 4s/epoch - 33ms/step
Epoch 17/50
135/135 - 4s - loss: 3.1932 - accuracy1000: 0.4215 - val_loss: 3.4051 - val_accuracy1000: 0.3290 - 4s/epoch - 33ms/step
testing model: results/LILAK/W10/deepOF_L2/h1000
Evaluating performance on  test set...
518/518 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1130258
{'0': {'precision': 0.40172832838239264, 'recall': 0.27903138071389716, 'f1-score': 0.3293226924056097, 'support': 53313}, '1': {'precision': 0.2958472741586302, 'recall': 0.1912614194467771, 'f1-score': 0.23232666687273962, 'support': 39297}, '2': {'precision': 0.30558643294855353, 'recall': 0.536142017752219, 'f1-score': 0.3892887940816049, 'support': 39995}, 'accuracy': 0.33056822895064286, 'macro avg': {'precision': 0.3343873451631922, 'recall': 0.3354782726376311, 'f1-score': 0.3169793844533181, 'support': 132605}, 'weighted avg': {'precision': 0.3413535092148832, 'recall': 0.33056822895064286, 'f1-score': 0.3186646585544445, 'support': 132605}}
[[14876 10264 28173]
 [11227  7516 20554]
 [10927  7625 21443]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0890876
{'0': {'precision': 0.39932652113330236, 'recall': 0.29626119917298416, 'f1-score': 0.34015825914935705, 'support': 11608}, '1': {'precision': 0.3743574680569834, 'recall': 0.22665836741952694, 'f1-score': 0.2823594572140682, 'support': 11246}, '2': {'precision': 0.3702116402116402, 'recall': 0.6101857504142322, 'f1-score': 0.460829189580795, 'support': 11467}, 'accuracy': 0.3783397919641036, 'macro avg': {'precision': 0.3812985431339753, 'recall': 0.37770177233558105, 'f1-score': 0.36111563531474006, 'support': 34321}, 'weighted avg': {'precision': 0.38141730198394824, 'recall': 0.3783397919641036, 'f1-score': 0.36153666399458423, 'support': 34321}}
[[3439 2226 5943]
 [2737 2549 5960]
 [2436 2034 6997]]
Evaluating performance on  val set...
46/46 - 1s - 735ms/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1146225
{'0': {'precision': 0.43013324222753674, 'recall': 0.269882100750268, 'f1-score': 0.3316649104320338, 'support': 4665}, '1': {'precision': 0.32138228941684666, 'recall': 0.19898368547740036, 'f1-score': 0.24578790882061444, 'support': 3739}, '2': {'precision': 0.28633540372670807, 'recall': 0.5625381330079317, 'f1-score': 0.3795019551348014, 'support': 3278}, 'accuracy': 0.3293100496490327, 'macro avg': {'precision': 0.3459503117903638, 'recall': 0.3438013064118666, 'f1-score': 0.3189849247958165, 'support': 11682}, 'weighted avg': {'precision': 0.3549758096676252, 'recall': 0.3293100496490327, 'f1-score': 0.3176018838535862, 'support': 11682}}
[[1259  937 2469]
 [ 868  744 2127]
 [ 800  634 1844]]
training model: results/LILAK/W10/deepVOL_L2/h10
Epoch 1/50
135/135 - 7s - loss: 3.3419 - accuracy10: 0.3614 - val_loss: 3.3552 - val_accuracy10: 0.3583 - 7s/epoch - 53ms/step
Epoch 2/50
135/135 - 5s - loss: 3.2672 - accuracy10: 0.3950 - val_loss: 3.3245 - val_accuracy10: 0.3674 - 5s/epoch - 35ms/step
Epoch 3/50
135/135 - 5s - loss: 3.2071 - accuracy10: 0.4227 - val_loss: 3.2845 - val_accuracy10: 0.3811 - 5s/epoch - 35ms/step
Epoch 4/50
135/135 - 5s - loss: 3.1859 - accuracy10: 0.4261 - val_loss: 3.2667 - val_accuracy10: 0.3931 - 5s/epoch - 34ms/step
Epoch 5/50
135/135 - 5s - loss: 3.1659 - accuracy10: 0.4364 - val_loss: 3.2362 - val_accuracy10: 0.4067 - 5s/epoch - 34ms/step
Epoch 6/50
135/135 - 5s - loss: 3.1448 - accuracy10: 0.4408 - val_loss: 3.2518 - val_accuracy10: 0.4021 - 5s/epoch - 34ms/step
Epoch 7/50
135/135 - 5s - loss: 3.1249 - accuracy10: 0.4583 - val_loss: 3.2436 - val_accuracy10: 0.4046 - 5s/epoch - 34ms/step
Epoch 8/50
135/135 - 5s - loss: 3.1078 - accuracy10: 0.4579 - val_loss: 3.2375 - val_accuracy10: 0.4110 - 5s/epoch - 34ms/step
Epoch 9/50
135/135 - 5s - loss: 3.0878 - accuracy10: 0.4691 - val_loss: 3.2314 - val_accuracy10: 0.4158 - 5s/epoch - 35ms/step
Epoch 10/50
135/135 - 5s - loss: 3.0688 - accuracy10: 0.4753 - val_loss: 3.2278 - val_accuracy10: 0.4113 - 5s/epoch - 34ms/step
Epoch 11/50
135/135 - 5s - loss: 3.0556 - accuracy10: 0.4808 - val_loss: 3.2300 - val_accuracy10: 0.4126 - 5s/epoch - 34ms/step
Epoch 12/50
135/135 - 5s - loss: 3.0290 - accuracy10: 0.4930 - val_loss: 3.2173 - val_accuracy10: 0.4165 - 5s/epoch - 35ms/step
Epoch 13/50
135/135 - 5s - loss: 3.0129 - accuracy10: 0.4986 - val_loss: 3.2058 - val_accuracy10: 0.4285 - 5s/epoch - 34ms/step
Epoch 14/50
135/135 - 5s - loss: 3.0017 - accuracy10: 0.5023 - val_loss: 3.2010 - val_accuracy10: 0.4301 - 5s/epoch - 35ms/step
Epoch 15/50
135/135 - 5s - loss: 2.9732 - accuracy10: 0.5112 - val_loss: 3.1720 - val_accuracy10: 0.4415 - 5s/epoch - 34ms/step
Epoch 16/50
135/135 - 5s - loss: 2.9554 - accuracy10: 0.5139 - val_loss: 3.2052 - val_accuracy10: 0.4251 - 5s/epoch - 34ms/step
Epoch 17/50
135/135 - 5s - loss: 2.9349 - accuracy10: 0.5220 - val_loss: 3.1863 - val_accuracy10: 0.4375 - 5s/epoch - 34ms/step
Epoch 18/50
135/135 - 5s - loss: 2.9329 - accuracy10: 0.5228 - val_loss: 3.2156 - val_accuracy10: 0.4278 - 5s/epoch - 34ms/step
Epoch 19/50
135/135 - 5s - loss: 2.9171 - accuracy10: 0.5266 - val_loss: 3.1646 - val_accuracy10: 0.4493 - 5s/epoch - 34ms/step
Epoch 20/50
135/135 - 5s - loss: 2.9079 - accuracy10: 0.5303 - val_loss: 3.1520 - val_accuracy10: 0.4583 - 5s/epoch - 35ms/step
Epoch 21/50
135/135 - 5s - loss: 2.9023 - accuracy10: 0.5307 - val_loss: 3.1614 - val_accuracy10: 0.4516 - 5s/epoch - 34ms/step
Epoch 22/50
135/135 - 5s - loss: 2.8880 - accuracy10: 0.5365 - val_loss: 3.1517 - val_accuracy10: 0.4565 - 5s/epoch - 35ms/step
Epoch 23/50
135/135 - 5s - loss: 2.8762 - accuracy10: 0.5374 - val_loss: 3.1780 - val_accuracy10: 0.4483 - 5s/epoch - 34ms/step
Epoch 24/50
135/135 - 5s - loss: 2.8629 - accuracy10: 0.5402 - val_loss: 3.1696 - val_accuracy10: 0.4499 - 5s/epoch - 34ms/step
Epoch 25/50
135/135 - 5s - loss: 2.8515 - accuracy10: 0.5460 - val_loss: 3.1703 - val_accuracy10: 0.4589 - 5s/epoch - 34ms/step
Epoch 26/50
135/135 - 5s - loss: 2.8451 - accuracy10: 0.5490 - val_loss: 3.1618 - val_accuracy10: 0.4581 - 5s/epoch - 34ms/step
Epoch 27/50
135/135 - 5s - loss: 2.8310 - accuracy10: 0.5479 - val_loss: 3.1446 - val_accuracy10: 0.4628 - 5s/epoch - 35ms/step
Epoch 28/50
135/135 - 5s - loss: 2.8249 - accuracy10: 0.5517 - val_loss: 3.1499 - val_accuracy10: 0.4680 - 5s/epoch - 34ms/step
Epoch 29/50
135/135 - 5s - loss: 2.8119 - accuracy10: 0.5565 - val_loss: 3.1547 - val_accuracy10: 0.4627 - 5s/epoch - 34ms/step
Epoch 30/50
135/135 - 5s - loss: 2.8008 - accuracy10: 0.5562 - val_loss: 3.1496 - val_accuracy10: 0.4619 - 5s/epoch - 34ms/step
Epoch 31/50
135/135 - 5s - loss: 2.7877 - accuracy10: 0.5618 - val_loss: 3.1535 - val_accuracy10: 0.4672 - 5s/epoch - 34ms/step
Epoch 32/50
135/135 - 5s - loss: 2.7832 - accuracy10: 0.5628 - val_loss: 3.1459 - val_accuracy10: 0.4700 - 5s/epoch - 34ms/step
Epoch 33/50
135/135 - 5s - loss: 2.7653 - accuracy10: 0.5665 - val_loss: 3.1606 - val_accuracy10: 0.4611 - 5s/epoch - 34ms/step
Epoch 34/50
135/135 - 5s - loss: 2.7632 - accuracy10: 0.5686 - val_loss: 3.1429 - val_accuracy10: 0.4668 - 5s/epoch - 34ms/step
Epoch 35/50
135/135 - 5s - loss: 2.7491 - accuracy10: 0.5700 - val_loss: 3.1865 - val_accuracy10: 0.4605 - 5s/epoch - 34ms/step
Epoch 36/50
135/135 - 5s - loss: 2.7340 - accuracy10: 0.5767 - val_loss: 3.2410 - val_accuracy10: 0.4469 - 5s/epoch - 34ms/step
Epoch 37/50
135/135 - 5s - loss: 2.7320 - accuracy10: 0.5733 - val_loss: 3.2175 - val_accuracy10: 0.4536 - 5s/epoch - 34ms/step
Epoch 38/50
135/135 - 5s - loss: 2.7208 - accuracy10: 0.5773 - val_loss: 3.2113 - val_accuracy10: 0.4540 - 5s/epoch - 34ms/step
Epoch 39/50
135/135 - 5s - loss: 2.7082 - accuracy10: 0.5803 - val_loss: 3.2159 - val_accuracy10: 0.4519 - 5s/epoch - 35ms/step
Epoch 40/50
135/135 - 5s - loss: 2.7021 - accuracy10: 0.5812 - val_loss: 3.2287 - val_accuracy10: 0.4497 - 5s/epoch - 34ms/step
Epoch 41/50
135/135 - 5s - loss: 2.6928 - accuracy10: 0.5826 - val_loss: 3.2201 - val_accuracy10: 0.4526 - 5s/epoch - 34ms/step
Epoch 42/50
135/135 - 5s - loss: 2.6866 - accuracy10: 0.5834 - val_loss: 3.2116 - val_accuracy10: 0.4549 - 5s/epoch - 34ms/step
Epoch 43/50
135/135 - 5s - loss: 2.6802 - accuracy10: 0.5835 - val_loss: 3.2458 - val_accuracy10: 0.4521 - 5s/epoch - 34ms/step
Epoch 44/50
135/135 - 5s - loss: 2.6747 - accuracy10: 0.5845 - val_loss: 3.2532 - val_accuracy10: 0.4517 - 5s/epoch - 34ms/step
testing model: results/LILAK/W10/deepVOL_L2/h10
Evaluating performance on  test set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0514354
{'0': {'precision': 0.4972068107901282, 'recall': 0.5110311467673431, 'f1-score': 0.5040242034016639, 'support': 50856}, '1': {'precision': 0.44742849469585066, 'recall': 0.381290230296095, 'f1-score': 0.41172018596605037, 'support': 34955}, '2': {'precision': 0.4650063301155246, 'recall': 0.5022970576294365, 'f1-score': 0.48293289231749037, 'support': 46799}, 'accuracy': 0.47375009426136794, 'macro avg': {'precision': 0.4698805452005012, 'recall': 0.4648728115642915, 'f1-score': 0.46622576056173487, 'support': 132610}, 'weighted avg': {'precision': 0.47272184484362156, 'recall': 0.47375009426136794, 'f1-score': 0.4722502859226645, 'support': 132610}}
[[25989  8757 16110]
 [10692 13328 10935]
 [15589  7703 23507]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93861574
{'0': {'precision': 0.5323037323037323, 'recall': 0.5578635014836796, 'f1-score': 0.5447839831401475, 'support': 11121}, '1': {'precision': 0.5930165448249327, 'recall': 0.5353886235345202, 'f1-score': 0.562731048331888, 'support': 11515}, '2': {'precision': 0.5428617992177314, 'recall': 0.5700350817147257, 'f1-score': 0.5561166993614091, 'support': 11687}, 'accuracy': 0.554467849546951, 'macro avg': {'precision': 0.5560606921154655, 'recall': 0.5544290689109752, 'f1-score': 0.5545439102778148, 'support': 34323}, 'weighted avg': {'precision': 0.5562672600899261, 'recall': 0.554467849546951, 'f1-score': 0.5546638278553756, 'support': 34323}}
[[6204 1982 2935]
 [2675 6165 2675]
 [2776 2249 6662]]
Evaluating performance on  val set...
46/46 - 1s - 771ms/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0523413
{'0': {'precision': 0.43047183537726047, 'recall': 0.5473044397463002, 'f1-score': 0.48190808609656777, 'support': 3784}, '1': {'precision': 0.5442994505494505, 'recall': 0.3876253362680362, 'f1-score': 0.45279245822025427, 'support': 4089}, '2': {'precision': 0.4594594594594595, 'recall': 0.4775531635599895, 'f1-score': 0.46833161688980435, 'support': 3809}, 'accuracy': 0.4686697483307653, 'macro avg': {'precision': 0.47807691512872347, 'recall': 0.4708276465247753, 'f1-score': 0.46767738706887546, 'support': 11682}, 'weighted avg': {'precision': 0.4797660468622957, 'recall': 0.4686697483307653, 'f1-score': 0.46729016334405893, 'support': 11682}}
[[2071  681 1032]
 [1396 1585 1108]
 [1344  646 1819]]
training model: results/LILAK/W10/deepVOL_L2/h20
Epoch 1/50
135/135 - 7s - loss: 3.3567 - accuracy20: 0.3523 - val_loss: 3.3783 - val_accuracy20: 0.3437 - 7s/epoch - 52ms/step
Epoch 2/50
135/135 - 5s - loss: 3.2996 - accuracy20: 0.3721 - val_loss: 3.3478 - val_accuracy20: 0.3529 - 5s/epoch - 35ms/step
Epoch 3/50
135/135 - 5s - loss: 3.2682 - accuracy20: 0.3897 - val_loss: 3.3124 - val_accuracy20: 0.3678 - 5s/epoch - 35ms/step
Epoch 4/50
135/135 - 5s - loss: 3.2487 - accuracy20: 0.3992 - val_loss: 3.3047 - val_accuracy20: 0.3709 - 5s/epoch - 35ms/step
Epoch 5/50
135/135 - 5s - loss: 3.2210 - accuracy20: 0.4103 - val_loss: 3.2885 - val_accuracy20: 0.3865 - 5s/epoch - 34ms/step
Epoch 6/50
135/135 - 5s - loss: 3.2059 - accuracy20: 0.4229 - val_loss: 3.2775 - val_accuracy20: 0.3897 - 5s/epoch - 34ms/step
Epoch 7/50
135/135 - 5s - loss: 3.1851 - accuracy20: 0.4308 - val_loss: 3.2884 - val_accuracy20: 0.3935 - 5s/epoch - 34ms/step
Epoch 8/50
135/135 - 5s - loss: 3.1679 - accuracy20: 0.4368 - val_loss: 3.2695 - val_accuracy20: 0.3970 - 5s/epoch - 35ms/step
Epoch 9/50
135/135 - 5s - loss: 3.1440 - accuracy20: 0.4476 - val_loss: 3.2661 - val_accuracy20: 0.4010 - 5s/epoch - 35ms/step
Epoch 10/50
135/135 - 5s - loss: 3.1238 - accuracy20: 0.4547 - val_loss: 3.2815 - val_accuracy20: 0.4028 - 5s/epoch - 34ms/step
Epoch 11/50
135/135 - 5s - loss: 3.1110 - accuracy20: 0.4620 - val_loss: 3.2572 - val_accuracy20: 0.4133 - 5s/epoch - 35ms/step
Epoch 12/50
135/135 - 5s - loss: 3.0989 - accuracy20: 0.4680 - val_loss: 3.2580 - val_accuracy20: 0.4160 - 5s/epoch - 34ms/step
Epoch 13/50
135/135 - 5s - loss: 3.0825 - accuracy20: 0.4742 - val_loss: 3.2596 - val_accuracy20: 0.4115 - 5s/epoch - 34ms/step
Epoch 14/50
135/135 - 5s - loss: 3.0689 - accuracy20: 0.4755 - val_loss: 3.2629 - val_accuracy20: 0.4070 - 5s/epoch - 34ms/step
Epoch 15/50
135/135 - 5s - loss: 3.0477 - accuracy20: 0.4841 - val_loss: 3.2472 - val_accuracy20: 0.4158 - 5s/epoch - 34ms/step
Epoch 16/50
135/135 - 5s - loss: 3.0462 - accuracy20: 0.4865 - val_loss: 3.2684 - val_accuracy20: 0.4089 - 5s/epoch - 34ms/step
Epoch 17/50
135/135 - 5s - loss: 3.0372 - accuracy20: 0.4881 - val_loss: 3.2669 - val_accuracy20: 0.4195 - 5s/epoch - 34ms/step
Epoch 18/50
135/135 - 5s - loss: 3.0180 - accuracy20: 0.4942 - val_loss: 3.2601 - val_accuracy20: 0.4171 - 5s/epoch - 34ms/step
Epoch 19/50
135/135 - 5s - loss: 3.0123 - accuracy20: 0.4930 - val_loss: 3.2852 - val_accuracy20: 0.4138 - 5s/epoch - 34ms/step
Epoch 20/50
135/135 - 5s - loss: 3.0104 - accuracy20: 0.4961 - val_loss: 3.2512 - val_accuracy20: 0.4198 - 5s/epoch - 34ms/step
Epoch 21/50
135/135 - 5s - loss: 2.9922 - accuracy20: 0.5035 - val_loss: 3.2651 - val_accuracy20: 0.4182 - 5s/epoch - 34ms/step
Epoch 22/50
135/135 - 5s - loss: 2.9803 - accuracy20: 0.5032 - val_loss: 3.2642 - val_accuracy20: 0.4153 - 5s/epoch - 34ms/step
Epoch 23/50
135/135 - 5s - loss: 2.9749 - accuracy20: 0.5081 - val_loss: 3.2598 - val_accuracy20: 0.4197 - 5s/epoch - 34ms/step
Epoch 24/50
135/135 - 5s - loss: 2.9618 - accuracy20: 0.5115 - val_loss: 3.2660 - val_accuracy20: 0.4254 - 5s/epoch - 34ms/step
Epoch 25/50
135/135 - 5s - loss: 2.9580 - accuracy20: 0.5140 - val_loss: 3.2636 - val_accuracy20: 0.4308 - 5s/epoch - 34ms/step
testing model: results/LILAK/W10/deepVOL_L2/h20
Evaluating performance on  test set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0525274
{'0': {'precision': 0.4600182426269383, 'recall': 0.7072737471952132, 'f1-score': 0.5574591945764711, 'support': 53480}, '1': {'precision': 0.37234857014185996, 'recall': 0.27712418300653596, 'f1-score': 0.3177555726364335, 'support': 29835}, '2': {'precision': 0.4832860184528034, 'recall': 0.2762754843290395, 'f1-score': 0.35157147466924815, 'support': 49295}, 'accuracy': 0.45028278410376293, 'macro avg': {'precision': 0.4385509437405339, 'recall': 0.4202244715102628, 'f1-score': 0.4089287472940509, 'support': 132610}, 'weighted avg': {'precision': 0.4489433638903702, 'recall': 0.45028278410376293, 'f1-score': 0.42699548359383344, 'support': 132610}}
[[37825  6776  8879]
 [15885  8268  5682]
 [28515  7161 13619]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0242895
{'0': {'precision': 0.4494987945692171, 'recall': 0.6203484808685754, 'f1-score': 0.5212816834050693, 'support': 11421}, '1': {'precision': 0.5003275620028077, 'recall': 0.4681670899378229, 'f1-score': 0.48371335504886, 'support': 11419}, '2': {'precision': 0.4954291518537329, 'recall': 0.3398066707306453, 'f1-score': 0.4031199958675552, 'support': 11483}, 'accuracy': 0.4758616671036914, 'macro avg': {'precision': 0.48175183614191924, 'recall': 0.47610741384568117, 'f1-score': 0.46937167810716146, 'support': 34323}, 'weighted avg': {'precision': 0.48177546001286314, 'recall': 0.4758616671036914, 'f1-score': 0.4692511674393079, 'support': 34323}}
[[7085 2501 1835]
 [3934 5346 2139]
 [4743 2838 3902]]
Evaluating performance on  val set...
46/46 - 1s - 717ms/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0868458
{'0': {'precision': 0.3977200759974667, 'recall': 0.6286286286286287, 'f1-score': 0.48719937936384805, 'support': 3996}, '1': {'precision': 0.4262169413568417, 'recall': 0.29605963791267303, 'f1-score': 0.3494108405341712, 'support': 3756}, '2': {'precision': 0.4214726151614073, 'recall': 0.2956743002544529, 'f1-score': 0.3475400029908778, 'support': 3930}, 'accuracy': 0.40969012155452833, 'macro avg': {'precision': 0.41513654417190526, 'recall': 0.4067875222652515, 'f1-score': 0.39471674096296566, 'support': 11682}, 'weighted avg': {'precision': 0.4148731067459771, 'recall': 0.40969012155452833, 'f1-score': 0.39591405998445767, 'support': 11682}}
[[2512  735  749]
 [1798 1112  846]
 [2006  762 1162]]
training model: results/LILAK/W10/deepVOL_L2/h30
Epoch 1/50
135/135 - 7s - loss: 3.3645 - accuracy30: 0.3453 - val_loss: 3.3662 - val_accuracy30: 0.3409 - 7s/epoch - 55ms/step
Epoch 2/50
135/135 - 5s - loss: 3.3207 - accuracy30: 0.3603 - val_loss: 3.3561 - val_accuracy30: 0.3495 - 5s/epoch - 34ms/step
Epoch 3/50
135/135 - 5s - loss: 3.2885 - accuracy30: 0.3731 - val_loss: 3.3293 - val_accuracy30: 0.3463 - 5s/epoch - 34ms/step
Epoch 4/50
135/135 - 5s - loss: 3.2796 - accuracy30: 0.3777 - val_loss: 3.3246 - val_accuracy30: 0.3541 - 5s/epoch - 35ms/step
Epoch 5/50
135/135 - 5s - loss: 3.2647 - accuracy30: 0.3888 - val_loss: 3.3242 - val_accuracy30: 0.3608 - 5s/epoch - 34ms/step
Epoch 6/50
135/135 - 5s - loss: 3.2436 - accuracy30: 0.3992 - val_loss: 3.3098 - val_accuracy30: 0.3681 - 5s/epoch - 34ms/step
Epoch 7/50
135/135 - 5s - loss: 3.2354 - accuracy30: 0.4056 - val_loss: 3.3124 - val_accuracy30: 0.3659 - 5s/epoch - 34ms/step
Epoch 8/50
135/135 - 5s - loss: 3.2206 - accuracy30: 0.4134 - val_loss: 3.3073 - val_accuracy30: 0.3753 - 5s/epoch - 35ms/step
Epoch 9/50
135/135 - 5s - loss: 3.2041 - accuracy30: 0.4210 - val_loss: 3.3079 - val_accuracy30: 0.3817 - 5s/epoch - 33ms/step
Epoch 10/50
135/135 - 5s - loss: 3.2018 - accuracy30: 0.4236 - val_loss: 3.2992 - val_accuracy30: 0.3846 - 5s/epoch - 34ms/step
Epoch 11/50
135/135 - 5s - loss: 3.1849 - accuracy30: 0.4310 - val_loss: 3.3077 - val_accuracy30: 0.3826 - 5s/epoch - 34ms/step
Epoch 12/50
135/135 - 5s - loss: 3.1732 - accuracy30: 0.4387 - val_loss: 3.2850 - val_accuracy30: 0.3881 - 5s/epoch - 35ms/step
Epoch 13/50
135/135 - 5s - loss: 3.1603 - accuracy30: 0.4408 - val_loss: 3.2919 - val_accuracy30: 0.3889 - 5s/epoch - 34ms/step
Epoch 14/50
135/135 - 5s - loss: 3.1499 - accuracy30: 0.4466 - val_loss: 3.2887 - val_accuracy30: 0.3939 - 5s/epoch - 34ms/step
Epoch 15/50
135/135 - 5s - loss: 3.1331 - accuracy30: 0.4549 - val_loss: 3.2726 - val_accuracy30: 0.4026 - 5s/epoch - 34ms/step
Epoch 16/50
135/135 - 5s - loss: 3.1206 - accuracy30: 0.4614 - val_loss: 3.2973 - val_accuracy30: 0.3975 - 5s/epoch - 34ms/step
Epoch 17/50
135/135 - 5s - loss: 3.1143 - accuracy30: 0.4612 - val_loss: 3.2750 - val_accuracy30: 0.4058 - 5s/epoch - 34ms/step
Epoch 18/50
135/135 - 5s - loss: 3.1004 - accuracy30: 0.4659 - val_loss: 3.2870 - val_accuracy30: 0.4022 - 5s/epoch - 34ms/step
Epoch 19/50
135/135 - 5s - loss: 3.0866 - accuracy30: 0.4706 - val_loss: 3.2887 - val_accuracy30: 0.3994 - 5s/epoch - 34ms/step
Epoch 20/50
135/135 - 5s - loss: 3.0794 - accuracy30: 0.4729 - val_loss: 3.2965 - val_accuracy30: 0.4002 - 5s/epoch - 34ms/step
Epoch 21/50
135/135 - 5s - loss: 3.0715 - accuracy30: 0.4797 - val_loss: 3.2877 - val_accuracy30: 0.4046 - 5s/epoch - 34ms/step
Epoch 22/50
135/135 - 5s - loss: 3.0607 - accuracy30: 0.4824 - val_loss: 3.3039 - val_accuracy30: 0.4013 - 5s/epoch - 34ms/step
Epoch 23/50
135/135 - 5s - loss: 3.0551 - accuracy30: 0.4818 - val_loss: 3.3116 - val_accuracy30: 0.3994 - 5s/epoch - 34ms/step
Epoch 24/50
135/135 - 5s - loss: 3.0488 - accuracy30: 0.4843 - val_loss: 3.3209 - val_accuracy30: 0.3945 - 5s/epoch - 34ms/step
Epoch 25/50
135/135 - 5s - loss: 3.0287 - accuracy30: 0.4917 - val_loss: 3.3329 - val_accuracy30: 0.3998 - 5s/epoch - 34ms/step
testing model: results/LILAK/W10/deepVOL_L2/h30
Evaluating performance on  test set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0800793
{'0': {'precision': 0.44464586770117653, 'recall': 0.4748151302799179, 'f1-score': 0.45923554357289303, 'support': 51658}, '1': {'precision': 0.35079350085017946, 'recall': 0.2253816041028131, 'f1-score': 0.27443879907621244, 'support': 32953}, '2': {'precision': 0.409240337627721, 'recall': 0.47980166253463613, 'f1-score': 0.4417208508352993, 'support': 47999}, 'accuracy': 0.4146369052107684, 'macro avg': {'precision': 0.40155990205969233, 'recall': 0.3933327989724557, 'f1-score': 0.3917983978281349, 'support': 132610}, 'weighted avg': {'precision': 0.40850872055664217, 'recall': 0.4146369052107684, 'f1-score': 0.40697481769919663, 'support': 132610}}
[[24528  7068 20062]
 [12343  7427 13183]
 [18292  6677 23030]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0451751
{'0': {'precision': 0.46083203232620074, 'recall': 0.4382532751091703, 'f1-score': 0.44925914320247096, 'support': 11450}, '1': {'precision': 0.4931554931554932, 'recall': 0.37015895319223674, 'f1-score': 0.42289555533259754, 'support': 11387}, '2': {'precision': 0.42735272385302614, 'recall': 0.5538916942364618, 'f1-score': 0.48246312516588935, 'support': 11486}, 'accuracy': 0.4543600501121697, 'macro avg': {'precision': 0.46044674977824, 'recall': 0.45410130751262295, 'f1-score': 0.45153927456698595, 'support': 34323}, 'weighted avg': {'precision': 0.460352001773518, 'recall': 0.4543600501121697, 'f1-score': 0.4516242849953671, 'support': 34323}}
[[5018 2056 4376]
 [3023 4215 4149]
 [2848 2276 6362]]
Evaluating performance on  val set...
46/46 - 1s - 722ms/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.092516
{'0': {'precision': 0.39500480307396735, 'recall': 0.5133583021223471, 'f1-score': 0.446471226927253, 'support': 4005}, '1': {'precision': 0.41932319764590487, 'recall': 0.22458628841607564, 'f1-score': 0.2925076975709887, 'support': 3807}, '2': {'precision': 0.39634970707525913, 'recall': 0.4545219638242894, 'f1-score': 0.4234472797303804, 'support': 3870}, 'accuracy': 0.3997603150145523, 'macro avg': {'precision': 0.40355923593171045, 'recall': 0.3974888514542374, 'f1-score': 0.3874754014095407, 'support': 11682}, 'weighted avg': {'precision': 0.40337536518836264, 'recall': 0.3997603150145523, 'f1-score': 0.3886693238360704, 'support': 11682}}
[[2056  608 1341]
 [1614  855 1338]
 [1535  576 1759]]
training model: results/LILAK/W10/deepVOL_L2/h50
Epoch 1/50
135/135 - 7s - loss: 3.3725 - accuracy50: 0.3447 - val_loss: 3.3797 - val_accuracy50: 0.3404 - 7s/epoch - 52ms/step
Epoch 2/50
135/135 - 5s - loss: 3.3239 - accuracy50: 0.3550 - val_loss: 3.3426 - val_accuracy50: 0.3413 - 5s/epoch - 34ms/step
Epoch 3/50
135/135 - 5s - loss: 3.3110 - accuracy50: 0.3548 - val_loss: 3.3161 - val_accuracy50: 0.3458 - 5s/epoch - 35ms/step
Epoch 4/50
135/135 - 5s - loss: 3.2950 - accuracy50: 0.3677 - val_loss: 3.3278 - val_accuracy50: 0.3489 - 5s/epoch - 34ms/step
Epoch 5/50
135/135 - 5s - loss: 3.2838 - accuracy50: 0.3724 - val_loss: 3.3318 - val_accuracy50: 0.3541 - 5s/epoch - 34ms/step
Epoch 6/50
135/135 - 5s - loss: 3.2710 - accuracy50: 0.3786 - val_loss: 3.3317 - val_accuracy50: 0.3553 - 5s/epoch - 34ms/step
Epoch 7/50
135/135 - 5s - loss: 3.2536 - accuracy50: 0.3950 - val_loss: 3.3347 - val_accuracy50: 0.3517 - 5s/epoch - 34ms/step
Epoch 8/50
135/135 - 5s - loss: 3.2500 - accuracy50: 0.3954 - val_loss: 3.3180 - val_accuracy50: 0.3596 - 5s/epoch - 33ms/step
Epoch 9/50
135/135 - 5s - loss: 3.2413 - accuracy50: 0.4035 - val_loss: 3.3190 - val_accuracy50: 0.3630 - 5s/epoch - 34ms/step
Epoch 10/50
135/135 - 5s - loss: 3.2305 - accuracy50: 0.4082 - val_loss: 3.3237 - val_accuracy50: 0.3655 - 5s/epoch - 34ms/step
Epoch 11/50
135/135 - 5s - loss: 3.2185 - accuracy50: 0.4123 - val_loss: 3.3236 - val_accuracy50: 0.3641 - 5s/epoch - 34ms/step
Epoch 12/50
135/135 - 5s - loss: 3.2063 - accuracy50: 0.4228 - val_loss: 3.3332 - val_accuracy50: 0.3642 - 5s/epoch - 34ms/step
Epoch 13/50
135/135 - 5s - loss: 3.1943 - accuracy50: 0.4276 - val_loss: 3.3688 - val_accuracy50: 0.3654 - 5s/epoch - 34ms/step
testing model: results/LILAK/W10/deepVOL_L2/h50
Evaluating performance on  test set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0978552
{'0': {'precision': 0.3990933908530215, 'recall': 0.4587328335948244, 'f1-score': 0.4268399282682552, 'support': 51627}, '1': {'precision': 0.26253553623666104, 'recall': 0.1936601525696745, 'f1-score': 0.222898520306433, 'support': 32903}, '2': {'precision': 0.371451313345715, 'recall': 0.3785357737104825, 'f1-score': 0.3749600832328976, 'support': 48080}, 'accuracy': 0.3638865847221175, 'macro avg': {'precision': 0.3443600801451325, 'recall': 0.34364291995832713, 'f1-score': 0.3415661772691953, 'support': 132610}, 'weighted avg': {'precision': 0.35518875185902854, 'recall': 0.3638865847221175, 'f1-score': 0.35742836733417915, 'support': 132610}}
[[23683  9179 18765]
 [14499  6372 12032]
 [21160  8720 18200]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0976313
{'0': {'precision': 0.35321909597348566, 'recall': 0.433341984600744, 'f1-score': 0.3891996891996892, 'support': 11559}, '1': {'precision': 0.3749596644078735, 'recall': 0.31382787180410515, 'f1-score': 0.341680960548885, 'support': 11108}, '2': {'precision': 0.3682803135085293, 'recall': 0.342656142759094, 'f1-score': 0.35500644415803745, 'support': 11656}, 'accuracy': 0.3638667948605891, 'macro avg': {'precision': 0.36548635796329615, 'recall': 0.3632753330546477, 'f1-score': 0.3619623646355372, 'support': 34323}, 'weighted avg': {'precision': 0.36536977586037345, 'recall': 0.3638667948605891, 'f1-score': 0.3622092017114561, 'support': 34323}}
[[5009 2847 3703]
 [4474 3486 3148]
 [4698 2964 3994]]
Evaluating performance on  val set...
46/46 - 1s - 737ms/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1077704
{'0': {'precision': 0.34416102032682344, 'recall': 0.4318579644911228, 'f1-score': 0.3830542308971942, 'support': 3999}, '1': {'precision': 0.347427203829278, 'recall': 0.23103448275862068, 'f1-score': 0.2775211088099411, 'support': 3770}, '2': {'precision': 0.337021890786625, 'recall': 0.35803731152568363, 'f1-score': 0.3472118959107807, 'support': 3913}, 'accuracy': 0.34232152028762197, 'macro avg': {'precision': 0.3428700383142422, 'recall': 0.34030991959180906, 'f1-score': 0.33592907853930526, 'support': 11682}, 'weighted avg': {'precision': 0.3428237576931526, 'recall': 0.34232152028762197, 'f1-score': 0.33699097742426315, 'support': 11682}}
[[1727  854 1418]
 [1561  871 1338]
 [1730  782 1401]]
training model: results/LILAK/W10/deepVOL_L2/h100
Epoch 1/50
135/135 - 7s - loss: 3.3733 - accuracy100: 0.3428 - val_loss: 3.3658 - val_accuracy100: 0.3413 - 7s/epoch - 52ms/step
Epoch 2/50
135/135 - 5s - loss: 3.3356 - accuracy100: 0.3476 - val_loss: 3.3342 - val_accuracy100: 0.3487 - 5s/epoch - 34ms/step
Epoch 3/50
135/135 - 5s - loss: 3.3101 - accuracy100: 0.3603 - val_loss: 3.3091 - val_accuracy100: 0.3596 - 5s/epoch - 34ms/step
Epoch 4/50
135/135 - 5s - loss: 3.2964 - accuracy100: 0.3634 - val_loss: 3.3084 - val_accuracy100: 0.3506 - 5s/epoch - 34ms/step
Epoch 5/50
135/135 - 5s - loss: 3.2949 - accuracy100: 0.3661 - val_loss: 3.2951 - val_accuracy100: 0.3550 - 5s/epoch - 34ms/step
Epoch 6/50
135/135 - 5s - loss: 3.2834 - accuracy100: 0.3730 - val_loss: 3.2851 - val_accuracy100: 0.3660 - 5s/epoch - 35ms/step
Epoch 7/50
135/135 - 5s - loss: 3.2709 - accuracy100: 0.3811 - val_loss: 3.2948 - val_accuracy100: 0.3580 - 5s/epoch - 34ms/step
Epoch 8/50
135/135 - 5s - loss: 3.2670 - accuracy100: 0.3859 - val_loss: 3.3074 - val_accuracy100: 0.3640 - 5s/epoch - 34ms/step
Epoch 9/50
135/135 - 5s - loss: 3.2592 - accuracy100: 0.3920 - val_loss: 3.3107 - val_accuracy100: 0.3585 - 5s/epoch - 34ms/step
Epoch 10/50
135/135 - 5s - loss: 3.2529 - accuracy100: 0.3944 - val_loss: 3.3113 - val_accuracy100: 0.3639 - 5s/epoch - 34ms/step
Epoch 11/50
135/135 - 5s - loss: 3.2554 - accuracy100: 0.3931 - val_loss: 3.3215 - val_accuracy100: 0.3564 - 5s/epoch - 34ms/step
Epoch 12/50
135/135 - 5s - loss: 3.2415 - accuracy100: 0.3987 - val_loss: 3.3115 - val_accuracy100: 0.3639 - 5s/epoch - 34ms/step
Epoch 13/50
135/135 - 5s - loss: 3.2322 - accuracy100: 0.4084 - val_loss: 3.3092 - val_accuracy100: 0.3635 - 5s/epoch - 34ms/step
Epoch 14/50
135/135 - 5s - loss: 3.2222 - accuracy100: 0.4146 - val_loss: 3.3129 - val_accuracy100: 0.3651 - 5s/epoch - 34ms/step
Epoch 15/50
135/135 - 5s - loss: 3.2105 - accuracy100: 0.4211 - val_loss: 3.3193 - val_accuracy100: 0.3648 - 5s/epoch - 34ms/step
Epoch 16/50
135/135 - 5s - loss: 3.1977 - accuracy100: 0.4256 - val_loss: 3.3336 - val_accuracy100: 0.3638 - 5s/epoch - 34ms/step
testing model: results/LILAK/W10/deepVOL_L2/h100
Evaluating performance on  test set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0853033
{'0': {'precision': 0.4237233599576031, 'recall': 0.4049966532192413, 'f1-score': 0.41414842152972403, 'support': 55277}, '1': {'precision': 0.21953022339027595, 'recall': 0.09740543692150717, 'f1-score': 0.13493866424352569, 'support': 27442}, '2': {'precision': 0.38131656804733727, 'recall': 0.5166663326050791, 'f1-score': 0.43879105633623, 'support': 49891}, 'accuracy': 0.3833572128798733, 'macro avg': {'precision': 0.34152338379840536, 'recall': 0.3396894742486092, 'f1-score': 0.32929271403649324, 'support': 132610}, 'weighted avg': {'precision': 0.3655136826415963, 'recall': 0.3833572128798733, 'f1-score': 0.3656405528447345, 'support': 132610}}
[[22387  5258 27632]
 [10578  2673 14191]
 [19869  4245 25777]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0959752
{'0': {'precision': 0.3712149074414613, 'recall': 0.26480104940970706, 'f1-score': 0.30910575745202123, 'support': 11435}, '1': {'precision': 0.3935467479674797, 'recall': 0.2740865257011413, 'f1-score': 0.32312907431551496, 'support': 11303}, '2': {'precision': 0.3547611238657483, 'recall': 0.5602071644367717, 'f1-score': 0.4344188225844238, 'support': 11585}, 'accuracy': 0.36756693762200277, 'macro avg': {'precision': 0.3731742597582297, 'recall': 0.36636491318254, 'f1-score': 0.35555121811732, 'support': 34323}, 'weighted avg': {'precision': 0.37301544092457606, 'recall': 0.36756693762200277, 'f1-score': 0.356020578710855, 'support': 34323}}
[[3028 2303 6104]
 [2505 3098 5700]
 [2624 2471 6490]]
Evaluating performance on  val set...
46/46 - 1s - 751ms/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0969104
{'0': {'precision': 0.38662033014769764, 'recall': 0.30689655172413793, 'f1-score': 0.3421760861207228, 'support': 4350}, '1': {'precision': 0.3360995850622407, 'recall': 0.19588875453446192, 'f1-score': 0.24751718869365927, 'support': 3308}, '2': {'precision': 0.3477225837168703, 'recall': 0.5444831013916501, 'f1-score': 0.4244067796610169, 'support': 4024}, 'accuracy': 0.35730183187810305, 'macro avg': {'precision': 0.3568141663089362, 'recall': 0.34908946921674994, 'f1-score': 0.33803335149179964, 'support': 11682}, 'weighted avg': {'precision': 0.35891555730226526, 'recall': 0.35730183187810305, 'f1-score': 0.3436967741978858, 'support': 11682}}
[[1335  678 2337]
 [ 887  648 1773]
 [1231  602 2191]]
training model: results/LILAK/W10/deepVOL_L2/h200
Epoch 1/50
135/135 - 8s - loss: 3.3751 - accuracy200: 0.3390 - val_loss: 3.3890 - val_accuracy200: 0.3387 - 8s/epoch - 56ms/step
Epoch 2/50
135/135 - 5s - loss: 3.3329 - accuracy200: 0.3447 - val_loss: 3.3376 - val_accuracy200: 0.3404 - 5s/epoch - 34ms/step
Epoch 3/50
135/135 - 5s - loss: 3.3129 - accuracy200: 0.3554 - val_loss: 3.3367 - val_accuracy200: 0.3382 - 5s/epoch - 34ms/step
Epoch 4/50
135/135 - 5s - loss: 3.2919 - accuracy200: 0.3649 - val_loss: 3.3366 - val_accuracy200: 0.3380 - 5s/epoch - 34ms/step
Epoch 5/50
135/135 - 5s - loss: 3.2920 - accuracy200: 0.3661 - val_loss: 3.3444 - val_accuracy200: 0.3304 - 5s/epoch - 34ms/step
Epoch 6/50
135/135 - 5s - loss: 3.2851 - accuracy200: 0.3698 - val_loss: 3.3259 - val_accuracy200: 0.3411 - 5s/epoch - 34ms/step
Epoch 7/50
135/135 - 5s - loss: 3.2739 - accuracy200: 0.3763 - val_loss: 3.3253 - val_accuracy200: 0.3419 - 5s/epoch - 34ms/step
Epoch 8/50
135/135 - 5s - loss: 3.2605 - accuracy200: 0.3861 - val_loss: 3.3286 - val_accuracy200: 0.3415 - 5s/epoch - 34ms/step
Epoch 9/50
135/135 - 5s - loss: 3.2513 - accuracy200: 0.3914 - val_loss: 3.3315 - val_accuracy200: 0.3436 - 5s/epoch - 33ms/step
Epoch 10/50
135/135 - 5s - loss: 3.2439 - accuracy200: 0.3974 - val_loss: 3.3380 - val_accuracy200: 0.3409 - 5s/epoch - 34ms/step
Epoch 11/50
135/135 - 5s - loss: 3.2333 - accuracy200: 0.4045 - val_loss: 3.3276 - val_accuracy200: 0.3482 - 5s/epoch - 34ms/step
Epoch 12/50
135/135 - 5s - loss: 3.2241 - accuracy200: 0.4082 - val_loss: 3.3360 - val_accuracy200: 0.3452 - 5s/epoch - 34ms/step
Epoch 13/50
135/135 - 5s - loss: 3.2143 - accuracy200: 0.4156 - val_loss: 3.3448 - val_accuracy200: 0.3456 - 5s/epoch - 34ms/step
Epoch 14/50
135/135 - 5s - loss: 3.1996 - accuracy200: 0.4244 - val_loss: 3.3436 - val_accuracy200: 0.3523 - 5s/epoch - 34ms/step
Epoch 15/50
135/135 - 5s - loss: 3.1874 - accuracy200: 0.4322 - val_loss: 3.3526 - val_accuracy200: 0.3496 - 5s/epoch - 34ms/step
Epoch 16/50
135/135 - 5s - loss: 3.1793 - accuracy200: 0.4306 - val_loss: 3.3939 - val_accuracy200: 0.3368 - 5s/epoch - 34ms/step
Epoch 17/50
135/135 - 5s - loss: 3.1663 - accuracy200: 0.4378 - val_loss: 3.3782 - val_accuracy200: 0.3425 - 5s/epoch - 34ms/step
testing model: results/LILAK/W10/deepVOL_L2/h200
Evaluating performance on  test set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1122234
{'0': {'precision': 0.4005050390154014, 'recall': 0.33879876065662107, 'f1-score': 0.3670767306088407, 'support': 51963}, '1': {'precision': 0.27351455376473416, 'recall': 0.2470463619326978, 'f1-score': 0.2596075633250089, 'support': 36819}, '2': {'precision': 0.33861039406466054, 'recall': 0.4279912384776855, 'f1-score': 0.37809019904258, 'support': 43828}, 'accuracy': 0.3428022019455546, 'macro avg': {'precision': 0.3375433289482654, 'recall': 0.3379454536890014, 'f1-score': 0.33492483099214326, 'support': 132610}, 'weighted avg': {'precision': 0.3447899257106326, 'recall': 0.3428022019455546, 'f1-score': 0.34087803536934536, 'support': 132610}}
[[17605 13300 21058]
 [12142  9096 15581]
 [14210 10860 18758]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0918787
{'0': {'precision': 0.394946084304542, 'recall': 0.3132342778161714, 'f1-score': 0.3493761140819964, 'support': 11576}, '1': {'precision': 0.3660160387350583, 'recall': 0.4292051100070972, 'f1-score': 0.3951000408329931, 'support': 11272}, '2': {'precision': 0.3643072794364307, 'recall': 0.378562091503268, 'f1-score': 0.37129791871447493, 'support': 11475}, 'accuracy': 0.3731608542376832, 'macro avg': {'precision': 0.37508980082534366, 'recall': 0.3736671597755122, 'f1-score': 0.37192469120982147, 'support': 34323}, 'weighted avg': {'precision': 0.3752018964561372, 'recall': 0.3731608542376832, 'f1-score': 0.3717212706969463, 'support': 34323}}
[[3626 4121 3829]
 [2683 4838 3751]
 [2872 4259 4344]]
Evaluating performance on  val set...
46/46 - 1s - 733ms/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1100798
{'0': {'precision': 0.37523553162853296, 'recall': 0.3179019384264538, 'f1-score': 0.34419753086419747, 'support': 4385}, '1': {'precision': 0.31662870159453305, 'recall': 0.3256222547584187, 'f1-score': 0.321062509022665, 'support': 3415}, '2': {'precision': 0.32951739618406284, 'recall': 0.3781555899021123, 'f1-score': 0.35216504737915316, 'support': 3882}, 'accuracy': 0.3401814757746961, 'macro avg': {'precision': 0.34046054313570967, 'recall': 0.3405599276956616, 'f1-score': 0.33914169575533853, 'support': 11682}, 'weighted avg': {'precision': 0.3429105764529172, 'recall': 0.3401814757746961, 'f1-score': 0.34008212250280595, 'support': 11682}}
[[1394 1279 1712]
 [1028 1112 1275]
 [1293 1121 1468]]
training model: results/LILAK/W10/deepVOL_L2/h300
Epoch 1/50
135/135 - 7s - loss: 3.3760 - accuracy300: 0.3435 - val_loss: 3.4389 - val_accuracy300: 0.3166 - 7s/epoch - 51ms/step
Epoch 2/50
135/135 - 5s - loss: 3.3252 - accuracy300: 0.3557 - val_loss: 3.3851 - val_accuracy300: 0.3256 - 5s/epoch - 34ms/step
Epoch 3/50
135/135 - 5s - loss: 3.3114 - accuracy300: 0.3582 - val_loss: 3.3929 - val_accuracy300: 0.3358 - 5s/epoch - 34ms/step
Epoch 4/50
135/135 - 5s - loss: 3.2909 - accuracy300: 0.3646 - val_loss: 3.3390 - val_accuracy300: 0.3433 - 5s/epoch - 34ms/step
Epoch 5/50
135/135 - 5s - loss: 3.2860 - accuracy300: 0.3721 - val_loss: 3.3661 - val_accuracy300: 0.3276 - 5s/epoch - 34ms/step
Epoch 6/50
135/135 - 5s - loss: 3.2856 - accuracy300: 0.3742 - val_loss: 3.3273 - val_accuracy300: 0.3475 - 5s/epoch - 35ms/step
Epoch 7/50
135/135 - 5s - loss: 3.2817 - accuracy300: 0.3724 - val_loss: 3.3300 - val_accuracy300: 0.3458 - 5s/epoch - 34ms/step
Epoch 8/50
135/135 - 5s - loss: 3.2643 - accuracy300: 0.3827 - val_loss: 3.3439 - val_accuracy300: 0.3405 - 5s/epoch - 34ms/step
Epoch 9/50
135/135 - 5s - loss: 3.2509 - accuracy300: 0.3930 - val_loss: 3.3560 - val_accuracy300: 0.3378 - 5s/epoch - 34ms/step
Epoch 10/50
135/135 - 5s - loss: 3.2382 - accuracy300: 0.4034 - val_loss: 3.3379 - val_accuracy300: 0.3457 - 5s/epoch - 34ms/step
Epoch 11/50
135/135 - 5s - loss: 3.2273 - accuracy300: 0.4056 - val_loss: 3.3465 - val_accuracy300: 0.3481 - 5s/epoch - 34ms/step
Epoch 12/50
135/135 - 5s - loss: 3.2079 - accuracy300: 0.4171 - val_loss: 3.3612 - val_accuracy300: 0.3525 - 5s/epoch - 34ms/step
Epoch 13/50
135/135 - 5s - loss: 3.1952 - accuracy300: 0.4262 - val_loss: 3.3692 - val_accuracy300: 0.3527 - 5s/epoch - 34ms/step
Epoch 14/50
135/135 - 5s - loss: 3.1873 - accuracy300: 0.4316 - val_loss: 3.3976 - val_accuracy300: 0.3517 - 5s/epoch - 34ms/step
Epoch 15/50
135/135 - 5s - loss: 3.1683 - accuracy300: 0.4385 - val_loss: 3.4045 - val_accuracy300: 0.3551 - 5s/epoch - 34ms/step
Epoch 16/50
135/135 - 5s - loss: 3.1554 - accuracy300: 0.4443 - val_loss: 3.4215 - val_accuracy300: 0.3587 - 5s/epoch - 34ms/step
testing model: results/LILAK/W10/deepVOL_L2/h300
Evaluating performance on  test set...
519/519 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1138856
{'0': {'precision': 0.4010828153198316, 'recall': 0.3723727078097366, 'f1-score': 0.38619491239079023, 'support': 53715}, '1': {'precision': 0.24073251563087225, 'recall': 0.20913597103083909, 'f1-score': 0.22382465057179163, 'support': 33691}, '2': {'precision': 0.35071347085335974, 'recall': 0.4148526679054951, 'f1-score': 0.38009627565239423, 'support': 45204}, 'accuracy': 0.3453811929718724, 'macro avg': {'precision': 0.3308429339346879, 'recall': 0.3321204489153569, 'f1-score': 0.3300386128716587, 'support': 132610}, 'weighted avg': {'precision': 0.34317422777678713, 'recall': 0.3453811929718724, 'f1-score': 0.3428640982284621, 'support': 132610}}
[[20002 12435 21278]
 [13205  7046 13440]
 [16663  9788 18753]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0939448
{'0': {'precision': 0.3985626024460976, 'recall': 0.2718905900567693, 'f1-score': 0.3232602137342128, 'support': 11626}, '1': {'precision': 0.3801129426129426, 'recall': 0.4382368467358789, 'f1-score': 0.4071107478545157, 'support': 11366}, '2': {'precision': 0.352423239012643, 'recall': 0.41329097167063805, 'f1-score': 0.3804378731873756, 'support': 11331}, 'accuracy': 0.3736561489380299, 'macro avg': {'precision': 0.3770329280238944, 'recall': 0.37447280282109546, 'f1-score': 0.3702696115920347, 'support': 34323}, 'weighted avg': {'precision': 0.3772211124618855, 'recall': 0.3736561489380299, 'f1-score': 0.36990314209348063, 'support': 34323}}
[[3161 4004 4461]
 [2241 4981 4144]
 [2529 4119 4683]]
Evaluating performance on  val set...
46/46 - 1s - 741ms/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.109493
{'0': {'precision': 0.40130759651307596, 'recall': 0.2773235800344234, 'f1-score': 0.32798982188295167, 'support': 4648}, '1': {'precision': 0.29560765292374025, 'recall': 0.3590834697217676, 'f1-score': 0.3242684008276677, 'support': 3055}, '2': {'precision': 0.3513343139314982, 'recall': 0.4202060819301332, 'f1-score': 0.3826962691691463, 'support': 3979}, 'accuracy': 0.34737202533812706, 'macro avg': {'precision': 0.3494165211227715, 'recall': 0.3522043772287747, 'f1-score': 0.3449848306265886, 'support': 11682}, 'weighted avg': {'precision': 0.356644266684492, 'recall': 0.34737202533812706, 'f1-score': 0.3456501550817084, 'support': 11682}}
[[1289 1436 1923]
 [ 794 1097 1164]
 [1129 1178 1672]]
training model: results/LILAK/W10/deepVOL_L2/h500
Epoch 1/50
135/135 - 7s - loss: 3.3662 - accuracy500: 0.3495 - val_loss: 3.4092 - val_accuracy500: 0.3323 - 7s/epoch - 52ms/step
Epoch 2/50
135/135 - 5s - loss: 3.3312 - accuracy500: 0.3569 - val_loss: 3.4007 - val_accuracy500: 0.3243 - 5s/epoch - 34ms/step
Epoch 3/50
135/135 - 5s - loss: 3.3014 - accuracy500: 0.3679 - val_loss: 3.3623 - val_accuracy500: 0.3302 - 5s/epoch - 35ms/step
Epoch 4/50
135/135 - 5s - loss: 3.2892 - accuracy500: 0.3728 - val_loss: 3.3916 - val_accuracy500: 0.3285 - 5s/epoch - 34ms/step
Epoch 5/50
135/135 - 5s - loss: 3.2671 - accuracy500: 0.3838 - val_loss: 3.3770 - val_accuracy500: 0.3297 - 5s/epoch - 34ms/step
Epoch 6/50
135/135 - 5s - loss: 3.2502 - accuracy500: 0.3991 - val_loss: 3.3903 - val_accuracy500: 0.3258 - 5s/epoch - 34ms/step
Epoch 7/50
135/135 - 5s - loss: 3.2457 - accuracy500: 0.4008 - val_loss: 3.3985 - val_accuracy500: 0.3315 - 5s/epoch - 34ms/step
Epoch 8/50
135/135 - 5s - loss: 3.2281 - accuracy500: 0.4114 - val_loss: 3.3854 - val_accuracy500: 0.3316 - 5s/epoch - 34ms/step
Epoch 9/50
135/135 - 5s - loss: 3.2132 - accuracy500: 0.4172 - val_loss: 3.3887 - val_accuracy500: 0.3353 - 5s/epoch - 34ms/step
Epoch 10/50
135/135 - 5s - loss: 3.2124 - accuracy500: 0.4203 - val_loss: 3.4110 - val_accuracy500: 0.3360 - 5s/epoch - 34ms/step
Epoch 11/50
135/135 - 5s - loss: 3.1945 - accuracy500: 0.4256 - val_loss: 3.4050 - val_accuracy500: 0.3409 - 5s/epoch - 34ms/step
Epoch 12/50
135/135 - 5s - loss: 3.1764 - accuracy500: 0.4315 - val_loss: 3.4013 - val_accuracy500: 0.3459 - 5s/epoch - 34ms/step
Epoch 13/50
135/135 - 5s - loss: 3.1612 - accuracy500: 0.4384 - val_loss: 3.4071 - val_accuracy500: 0.3451 - 5s/epoch - 34ms/step
testing model: results/LILAK/W10/deepVOL_L2/h500
Evaluating performance on  test set...
519/519 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1209804
{'0': {'precision': 0.39500273754417403, 'recall': 0.3003103004616665, 'f1-score': 0.3412085904078079, 'support': 52852}, '1': {'precision': 0.2765544317842359, 'recall': 0.36001777728396434, 'f1-score': 0.3128145099979485, 'support': 36001}, '2': {'precision': 0.3519599666388657, 'recall': 0.3664785062961355, 'f1-score': 0.3590725377579238, 'support': 43757}, 'accuracy': 0.3383530653796848, 'macro avg': {'precision': 0.34117237865575856, 'recall': 0.3422688613472555, 'f1-score': 0.33769854605456007, 'support': 132610}, 'weighted avg': {'precision': 0.34864363957141853, 'recall': 0.3383530653796848, 'f1-score': 0.33939468086375896, 'support': 132610}}
[[15872 19093 17887]
 [11401 12961 11639]
 [12909 14812 16036]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1023204
{'0': {'precision': 0.3774018944519621, 'recall': 0.23805052919085012, 'f1-score': 0.2919501727206113, 'support': 11716}, '1': {'precision': 0.3701657458563536, 'recall': 0.4500618702492487, 'f1-score': 0.40622257678500195, 'support': 11314}, '2': {'precision': 0.3533429460423465, 'recall': 0.4122907996103781, 'f1-score': 0.3805476093175317, 'support': 11293}, 'accuracy': 0.3652652740145092, 'macro avg': {'precision': 0.3669701954502207, 'recall': 0.366801066350159, 'f1-score': 0.3595734529410483, 'support': 34323}, 'weighted avg': {'precision': 0.3671007118746669, 'recall': 0.3652652740145092, 'f1-score': 0.3587685985887912, 'support': 34323}}
[[2789 4382 4545]
 [2246 5092 3976]
 [2355 4282 4656]]
Evaluating performance on  val set...
46/46 - 1s - 737ms/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1244369
{'0': {'precision': 0.39411052843888666, 'recall': 0.21170097508125676, 'f1-score': 0.27544403721454747, 'support': 4615}, '1': {'precision': 0.29588688946015423, 'recall': 0.34574947431661157, 'f1-score': 0.3188807314032414, 'support': 3329}, '2': {'precision': 0.323734236777715, 'recall': 0.46013911182450506, 'f1-score': 0.38006850071815274, 'support': 3738}, 'accuracy': 0.32939565142954974, 'macro avg': {'precision': 0.33791055155891864, 'recall': 0.33919652040745785, 'f1-score': 0.3247977564453139, 'support': 11682}, 'weighted avg': {'precision': 0.343600934842785, 'recall': 0.32939565142954974, 'f1-score': 0.32129979817419807, 'support': 11682}}
[[ 977 1533 2105]
 [ 690 1151 1488]
 [ 812 1206 1720]]
training model: results/LILAK/W10/deepVOL_L2/h1000
Epoch 1/50
135/135 - 8s - loss: 3.3695 - accuracy1000: 0.3500 - val_loss: 3.5338 - val_accuracy1000: 0.3114 - 8s/epoch - 57ms/step
Epoch 2/50
135/135 - 5s - loss: 3.3322 - accuracy1000: 0.3562 - val_loss: 3.5513 - val_accuracy1000: 0.3118 - 5s/epoch - 34ms/step
Epoch 3/50
135/135 - 5s - loss: 3.3115 - accuracy1000: 0.3639 - val_loss: 3.5604 - val_accuracy1000: 0.3144 - 5s/epoch - 34ms/step
Epoch 4/50
135/135 - 5s - loss: 3.3033 - accuracy1000: 0.3721 - val_loss: 3.5362 - val_accuracy1000: 0.3136 - 5s/epoch - 34ms/step
Epoch 5/50
135/135 - 5s - loss: 3.2886 - accuracy1000: 0.3760 - val_loss: 3.4489 - val_accuracy1000: 0.3226 - 5s/epoch - 34ms/step
Epoch 6/50
135/135 - 5s - loss: 3.2699 - accuracy1000: 0.3893 - val_loss: 3.4217 - val_accuracy1000: 0.3246 - 5s/epoch - 34ms/step
Epoch 7/50
135/135 - 5s - loss: 3.2697 - accuracy1000: 0.3894 - val_loss: 3.4010 - val_accuracy1000: 0.3237 - 5s/epoch - 34ms/step
Epoch 8/50
135/135 - 5s - loss: 3.2521 - accuracy1000: 0.3989 - val_loss: 3.4084 - val_accuracy1000: 0.3293 - 5s/epoch - 34ms/step
Epoch 9/50
135/135 - 5s - loss: 3.2314 - accuracy1000: 0.4132 - val_loss: 3.4099 - val_accuracy1000: 0.3416 - 5s/epoch - 34ms/step
Epoch 10/50
135/135 - 5s - loss: 3.2253 - accuracy1000: 0.4126 - val_loss: 3.4255 - val_accuracy1000: 0.3337 - 5s/epoch - 34ms/step
Epoch 11/50
135/135 - 5s - loss: 3.2199 - accuracy1000: 0.4190 - val_loss: 3.3909 - val_accuracy1000: 0.3360 - 5s/epoch - 34ms/step
Epoch 12/50
135/135 - 5s - loss: 3.1970 - accuracy1000: 0.4259 - val_loss: 3.4160 - val_accuracy1000: 0.3410 - 5s/epoch - 33ms/step
Epoch 13/50
135/135 - 5s - loss: 3.1799 - accuracy1000: 0.4363 - val_loss: 3.4477 - val_accuracy1000: 0.3283 - 5s/epoch - 34ms/step
Epoch 14/50
135/135 - 5s - loss: 3.1677 - accuracy1000: 0.4419 - val_loss: 3.4022 - val_accuracy1000: 0.3477 - 5s/epoch - 34ms/step
Epoch 15/50
135/135 - 5s - loss: 3.1445 - accuracy1000: 0.4514 - val_loss: 3.4459 - val_accuracy1000: 0.3427 - 5s/epoch - 34ms/step
Epoch 16/50
135/135 - 5s - loss: 3.1412 - accuracy1000: 0.4456 - val_loss: 3.4301 - val_accuracy1000: 0.3411 - 5s/epoch - 34ms/step
Epoch 17/50
135/135 - 5s - loss: 3.1141 - accuracy1000: 0.4594 - val_loss: 3.4506 - val_accuracy1000: 0.3458 - 5s/epoch - 34ms/step
Epoch 18/50
135/135 - 5s - loss: 3.1004 - accuracy1000: 0.4654 - val_loss: 3.4580 - val_accuracy1000: 0.3440 - 5s/epoch - 34ms/step
Epoch 19/50
135/135 - 5s - loss: 3.0816 - accuracy1000: 0.4726 - val_loss: 3.5237 - val_accuracy1000: 0.3338 - 5s/epoch - 34ms/step
Epoch 20/50
135/135 - 5s - loss: 3.0584 - accuracy1000: 0.4812 - val_loss: 3.5311 - val_accuracy1000: 0.3374 - 5s/epoch - 34ms/step
Epoch 21/50
135/135 - 5s - loss: 3.0390 - accuracy1000: 0.4862 - val_loss: 3.5417 - val_accuracy1000: 0.3320 - 5s/epoch - 34ms/step
testing model: results/LILAK/W10/deepVOL_L2/h1000
Evaluating performance on  test set...
519/519 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1449759
{'0': {'precision': 0.4000106371662589, 'recall': 0.28213977566867987, 'f1-score': 0.3308915726258827, 'support': 53314}, '1': {'precision': 0.2829657080488362, 'recall': 0.28367855870527764, 'f1-score': 0.28332168498633964, 'support': 39298}, '2': {'precision': 0.3025409556007121, 'recall': 0.4206210310515526, 'f1-score': 0.35194075747591697, 'support': 39998}, 'accuracy': 0.32436467838021266, 'macro avg': {'precision': 0.3285057669386024, 'recall': 0.32881312180850336, 'f1-score': 0.3220513383627131, 'support': 132610}, 'weighted avg': {'precision': 0.33592630002942747, 'recall': 0.32436467838021266, 'f1-score': 0.32314346804231364, 'support': 132610}}
[[15042 16010 22262]
 [11627 11148 16523]
 [10935 12239 16824]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0989408
{'0': {'precision': 0.4034140647796907, 'recall': 0.23881499395405079, 'f1-score': 0.3000217013888889, 'support': 11578}, '1': {'precision': 0.3670718232044199, 'recall': 0.4421080649454352, 'f1-score': 0.40111084279159626, 'support': 11271}, '2': {'precision': 0.3787246293364042, 'recall': 0.4586020568241241, 'f1-score': 0.41485335856196787, 'support': 11474}, 'accuracy': 0.379046120677097, 'macro avg': {'precision': 0.38307017244017155, 'recall': 0.37984170524120336, 'f1-score': 0.371995300914151, 'support': 34323}, 'weighted avg': {'precision': 0.38322643586988836, 'recall': 0.379046120677097, 'f1-score': 0.3716050171583095, 'support': 34323}}
[[2765 4441 4372]
 [2028 4983 4260]
 [2061 4151 5262]]
Evaluating performance on  val set...
46/46 - 1s - 747ms/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1336905
{'0': {'precision': 0.39800995024875624, 'recall': 0.22408963585434175, 'f1-score': 0.2867383512544803, 'support': 4641}, '1': {'precision': 0.347528043207312, 'recall': 0.44459208078660645, 'f1-score': 0.3901130931561152, 'support': 3763}, '2': {'precision': 0.2827262044653349, 'recall': 0.3669920683343502, 'f1-score': 0.319394663480685, 'support': 3278}, 'accuracy': 0.3352165725047081, 'macro avg': {'precision': 0.3427547326404677, 'recall': 0.3452245949917661, 'f1-score': 0.3320820359637602, 'support': 11682}, 'weighted avg': {'precision': 0.34939982057275815, 'recall': 0.3352165725047081, 'f1-score': 0.329200818747491, 'support': 11682}}
[[1040 1788 1813]
 [ 851 1673 1239]
 [ 722 1353 1203]]
training model: results/LILAK/W10/deepVOL_L3/h10
Epoch 1/50
135/135 - 9s - loss: 3.3429 - accuracy10: 0.3563 - val_loss: 3.3712 - val_accuracy10: 0.3350 - 9s/epoch - 68ms/step
Epoch 2/50
135/135 - 7s - loss: 3.3137 - accuracy10: 0.3617 - val_loss: 3.3260 - val_accuracy10: 0.3470 - 7s/epoch - 49ms/step
Epoch 3/50
135/135 - 7s - loss: 3.2701 - accuracy10: 0.3871 - val_loss: 3.3210 - val_accuracy10: 0.3555 - 7s/epoch - 49ms/step
Epoch 4/50
135/135 - 6s - loss: 3.2498 - accuracy10: 0.3914 - val_loss: 3.2979 - val_accuracy10: 0.3573 - 6s/epoch - 48ms/step
Epoch 5/50
135/135 - 7s - loss: 3.2272 - accuracy10: 0.4003 - val_loss: 3.2939 - val_accuracy10: 0.3678 - 7s/epoch - 49ms/step
Epoch 6/50
135/135 - 6s - loss: 3.2082 - accuracy10: 0.4129 - val_loss: 3.3096 - val_accuracy10: 0.3606 - 6s/epoch - 48ms/step
Epoch 7/50
135/135 - 7s - loss: 3.1876 - accuracy10: 0.4204 - val_loss: 3.2738 - val_accuracy10: 0.3709 - 7s/epoch - 49ms/step
Epoch 8/50
135/135 - 7s - loss: 3.1763 - accuracy10: 0.4253 - val_loss: 3.3119 - val_accuracy10: 0.3566 - 7s/epoch - 48ms/step
Epoch 9/50
135/135 - 6s - loss: 3.1618 - accuracy10: 0.4313 - val_loss: 3.3126 - val_accuracy10: 0.3696 - 6s/epoch - 48ms/step
Epoch 10/50
135/135 - 6s - loss: 3.1557 - accuracy10: 0.4313 - val_loss: 3.2861 - val_accuracy10: 0.3699 - 6s/epoch - 48ms/step
Epoch 11/50
135/135 - 7s - loss: 3.1337 - accuracy10: 0.4425 - val_loss: 3.2859 - val_accuracy10: 0.3784 - 7s/epoch - 48ms/step
Epoch 12/50
135/135 - 7s - loss: 3.1173 - accuracy10: 0.4466 - val_loss: 3.3147 - val_accuracy10: 0.3744 - 7s/epoch - 49ms/step
Epoch 13/50
135/135 - 7s - loss: 3.1097 - accuracy10: 0.4527 - val_loss: 3.3224 - val_accuracy10: 0.3766 - 7s/epoch - 49ms/step
Epoch 14/50
135/135 - 6s - loss: 3.0982 - accuracy10: 0.4561 - val_loss: 3.3147 - val_accuracy10: 0.3796 - 6s/epoch - 48ms/step
Epoch 15/50
135/135 - 7s - loss: 3.0764 - accuracy10: 0.4685 - val_loss: 3.2851 - val_accuracy10: 0.3902 - 7s/epoch - 48ms/step
Epoch 16/50
135/135 - 6s - loss: 3.0596 - accuracy10: 0.4730 - val_loss: 3.2861 - val_accuracy10: 0.3919 - 6s/epoch - 48ms/step
Epoch 17/50
135/135 - 7s - loss: 3.0457 - accuracy10: 0.4778 - val_loss: 3.3348 - val_accuracy10: 0.3804 - 7s/epoch - 49ms/step
testing model: results/LILAK/W10/deepVOL_L3/h10
Evaluating performance on  test set...
519/519 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0820116
{'0': {'precision': 0.404794534557876, 'recall': 0.38913795815636304, 'f1-score': 0.3968118702691864, 'support': 50856}, '1': {'precision': 0.36252972972972974, 'recall': 0.4796738663996567, 'f1-score': 0.4129548673111262, 'support': 34955}, '2': {'precision': 0.37879960502788823, 'recall': 0.3032970789974145, 'f1-score': 0.33686958585498994, 'support': 46799}, 'accuracy': 0.38270869466857704, 'macro avg': {'precision': 0.3820412897718313, 'recall': 0.3907029678511447, 'f1-score': 0.3822121078117675, 'support': 132610}, 'weighted avg': {'precision': 0.38448005631459303, 'recall': 0.38270869466857704, 'f1-score': 0.3799129900437209, 'support': 132610}}
[[19790 15635 15431]
 [10342 16767  7846]
 [18757 13848 14194]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 24ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0591416
{'0': {'precision': 0.3871690427698574, 'recall': 0.3418757305997662, 'f1-score': 0.3631154195119622, 'support': 11121}, '1': {'precision': 0.4527668734962644, 'recall': 0.6210160660008684, 'f1-score': 0.5237101321908528, 'support': 11515}, '2': {'precision': 0.41083936157997475, 'recall': 0.3061521348506888, 'f1-score': 0.3508531084526378, 'support': 11687}, 'accuracy': 0.42336042886694053, 'macro avg': {'precision': 0.41692509261536553, 'recall': 0.42301464381710785, 'f1-score': 0.41255955338515093, 'support': 34323}, 'weighted avg': {'precision': 0.4172361708399101, 'recall': 0.42336042886694053, 'f1-score': 0.41281790726498785, 'support': 34323}}
[[3802 4188 3131]
 [2364 7151 2000]
 [3654 4455 3578]]
Evaluating performance on  val set...
46/46 - 1s - 1s/epoch - 24ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0925187
{'0': {'precision': 0.32897435897435895, 'recall': 0.33905919661733613, 'f1-score': 0.333940655908381, 'support': 3784}, '1': {'precision': 0.4131403118040089, 'recall': 0.45365615064808024, 'f1-score': 0.43245133465438856, 'support': 4089}, '2': {'precision': 0.35571081409477523, 'recall': 0.30742977159359414, 'f1-score': 0.3298127024362766, 'support': 3809}, 'accuracy': 0.36885807224790274, 'macro avg': {'precision': 0.36594182829104777, 'recall': 0.36671503961967017, 'f1-score': 0.36540156433301546, 'support': 11682}, 'weighted avg': {'precision': 0.3671522171043114, 'recall': 0.36885807224790274, 'f1-score': 0.3670759743998362, 'support': 11682}}
[[1283 1389 1112]
 [1225 1855 1009]
 [1392 1246 1171]]
training model: results/LILAK/W10/deepVOL_L3/h20
Epoch 1/50
135/135 - 9s - loss: 3.3493 - accuracy20: 0.3471 - val_loss: 3.3521 - val_accuracy20: 0.3346 - 9s/epoch - 67ms/step
Epoch 2/50
135/135 - 7s - loss: 3.3291 - accuracy20: 0.3586 - val_loss: 3.3352 - val_accuracy20: 0.3398 - 7s/epoch - 49ms/step
Epoch 3/50
135/135 - 7s - loss: 3.3096 - accuracy20: 0.3627 - val_loss: 3.3223 - val_accuracy20: 0.3459 - 7s/epoch - 48ms/step
Epoch 4/50
135/135 - 7s - loss: 3.2876 - accuracy20: 0.3766 - val_loss: 3.3186 - val_accuracy20: 0.3450 - 7s/epoch - 49ms/step
Epoch 5/50
135/135 - 7s - loss: 3.2739 - accuracy20: 0.3781 - val_loss: 3.2930 - val_accuracy20: 0.3576 - 7s/epoch - 49ms/step
Epoch 6/50
135/135 - 7s - loss: 3.2640 - accuracy20: 0.3850 - val_loss: 3.2960 - val_accuracy20: 0.3563 - 7s/epoch - 49ms/step
Epoch 7/50
135/135 - 7s - loss: 3.2538 - accuracy20: 0.3907 - val_loss: 3.3066 - val_accuracy20: 0.3511 - 7s/epoch - 48ms/step
Epoch 8/50
135/135 - 7s - loss: 3.2438 - accuracy20: 0.3981 - val_loss: 3.3006 - val_accuracy20: 0.3593 - 7s/epoch - 48ms/step
Epoch 9/50
135/135 - 7s - loss: 3.2381 - accuracy20: 0.4001 - val_loss: 3.2958 - val_accuracy20: 0.3648 - 7s/epoch - 49ms/step
Epoch 10/50
135/135 - 6s - loss: 3.2259 - accuracy20: 0.4106 - val_loss: 3.2980 - val_accuracy20: 0.3665 - 6s/epoch - 48ms/step
Epoch 11/50
135/135 - 7s - loss: 3.2089 - accuracy20: 0.4167 - val_loss: 3.2941 - val_accuracy20: 0.3698 - 7s/epoch - 49ms/step
Epoch 12/50
135/135 - 7s - loss: 3.1992 - accuracy20: 0.4171 - val_loss: 3.2846 - val_accuracy20: 0.3768 - 7s/epoch - 49ms/step
Epoch 13/50
135/135 - 7s - loss: 3.1862 - accuracy20: 0.4268 - val_loss: 3.2863 - val_accuracy20: 0.3780 - 7s/epoch - 48ms/step
Epoch 14/50
135/135 - 7s - loss: 3.1751 - accuracy20: 0.4313 - val_loss: 3.2795 - val_accuracy20: 0.3765 - 7s/epoch - 49ms/step
Epoch 15/50
135/135 - 7s - loss: 3.1691 - accuracy20: 0.4308 - val_loss: 3.2676 - val_accuracy20: 0.3869 - 7s/epoch - 49ms/step
Epoch 16/50
135/135 - 7s - loss: 3.1561 - accuracy20: 0.4378 - val_loss: 3.2784 - val_accuracy20: 0.3845 - 7s/epoch - 49ms/step
Epoch 17/50
135/135 - 6s - loss: 3.1394 - accuracy20: 0.4476 - val_loss: 3.2849 - val_accuracy20: 0.3797 - 6s/epoch - 48ms/step
Epoch 18/50
135/135 - 6s - loss: 3.1343 - accuracy20: 0.4489 - val_loss: 3.2935 - val_accuracy20: 0.3782 - 6s/epoch - 48ms/step
Epoch 19/50
135/135 - 7s - loss: 3.1216 - accuracy20: 0.4521 - val_loss: 3.3016 - val_accuracy20: 0.3754 - 7s/epoch - 49ms/step
Epoch 20/50
135/135 - 7s - loss: 3.1112 - accuracy20: 0.4586 - val_loss: 3.3033 - val_accuracy20: 0.3808 - 7s/epoch - 49ms/step
Epoch 21/50
135/135 - 7s - loss: 3.1012 - accuracy20: 0.4607 - val_loss: 3.3047 - val_accuracy20: 0.3806 - 7s/epoch - 49ms/step
Epoch 22/50
135/135 - 7s - loss: 3.0887 - accuracy20: 0.4662 - val_loss: 3.3203 - val_accuracy20: 0.3814 - 7s/epoch - 49ms/step
Epoch 23/50
135/135 - 7s - loss: 3.0761 - accuracy20: 0.4727 - val_loss: 3.3192 - val_accuracy20: 0.3824 - 7s/epoch - 48ms/step
Epoch 24/50
135/135 - 7s - loss: 3.0674 - accuracy20: 0.4705 - val_loss: 3.3213 - val_accuracy20: 0.3824 - 7s/epoch - 49ms/step
Epoch 25/50
135/135 - 7s - loss: 3.0484 - accuracy20: 0.4820 - val_loss: 3.3171 - val_accuracy20: 0.3883 - 7s/epoch - 48ms/step
testing model: results/LILAK/W10/deepVOL_L3/h20
Evaluating performance on  test set...
519/519 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.082651
{'0': {'precision': 0.4340917176303173, 'recall': 0.47913238593866864, 'f1-score': 0.4555013376707641, 'support': 53480}, '1': {'precision': 0.30674407507555274, 'recall': 0.387833081950729, 'f1-score': 0.34255517562946847, 'support': 29835}, '2': {'precision': 0.4056164421763016, 'recall': 0.295060350948372, 'f1-score': 0.3416163656434225, 'support': 49295}, 'accuracy': 0.3901666540984843, 'macro avg': {'precision': 0.3821507449607238, 'recall': 0.3873419396125899, 'f1-score': 0.37989095964788505, 'support': 132610}, 'weighted avg': {'precision': 0.3948555693826203, 'recall': 0.3901666540984843, 'f1-score': 0.38775600594171006, 'support': 132610}}
[[25624 13571 14285]
 [11235 11571  7029]
 [22170 12580 14545]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 25ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0546094
{'0': {'precision': 0.42112590272339684, 'recall': 0.4237807547500219, 'f1-score': 0.42244915772017105, 'support': 11421}, '1': {'precision': 0.458600100712179, 'recall': 0.558280059549873, 'f1-score': 0.5035545023696683, 'support': 11419}, '2': {'precision': 0.42927539478105053, 'recall': 0.3337977880344858, 'f1-score': 0.37556339408191264, 'support': 11483}, 'accuracy': 0.43842321475395507, 'macro avg': {'precision': 0.4363337994055421, 'recall': 0.43861953411146026, 'f1-score': 0.4338556847239173, 'support': 34323}, 'weighted avg': {'precision': 0.4363197518663022, 'recall': 0.43842321475395507, 'f1-score': 0.43374632599492813, 'support': 34323}}
[[4840 3663 2918]
 [2866 6375 2178]
 [3787 3863 3833]]
Evaluating performance on  val set...
46/46 - 1s - 1s/epoch - 25ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0885025
{'0': {'precision': 0.35857198901530013, 'recall': 0.4574574574574575, 'f1-score': 0.40202331207389497, 'support': 3996}, '1': {'precision': 0.41467304625199364, 'recall': 0.41533546325878595, 'f1-score': 0.4150039904229848, 'support': 3756}, '2': {'precision': 0.38341601700921335, 'recall': 0.27531806615776083, 'f1-score': 0.3204976303317536, 'support': 3930}, 'accuracy': 0.38263995891114533, 'macro avg': {'precision': 0.385553684092169, 'recall': 0.38270366229133473, 'f1-score': 0.3791749776095445, 'support': 11682}, 'weighted avg': {'precision': 0.3849675206877106, 'recall': 0.38263995891114533, 'f1-score': 0.3787704014963026, 'support': 11682}}
[[1828 1146 1022]
 [1478 1560  718]
 [1792 1056 1082]]
training model: results/LILAK/W10/deepVOL_L3/h30
Epoch 1/50
135/135 - 10s - loss: 3.3614 - accuracy30: 0.3428 - val_loss: 3.3476 - val_accuracy30: 0.3335 - 10s/epoch - 71ms/step
Epoch 2/50
135/135 - 7s - loss: 3.3400 - accuracy30: 0.3494 - val_loss: 3.3398 - val_accuracy30: 0.3267 - 7s/epoch - 49ms/step
Epoch 3/50
135/135 - 7s - loss: 3.3309 - accuracy30: 0.3459 - val_loss: 3.3173 - val_accuracy30: 0.3374 - 7s/epoch - 50ms/step
Epoch 4/50
135/135 - 7s - loss: 3.3070 - accuracy30: 0.3562 - val_loss: 3.3241 - val_accuracy30: 0.3441 - 7s/epoch - 48ms/step
Epoch 5/50
135/135 - 7s - loss: 3.2982 - accuracy30: 0.3598 - val_loss: 3.3183 - val_accuracy30: 0.3439 - 7s/epoch - 49ms/step
Epoch 6/50
135/135 - 7s - loss: 3.2838 - accuracy30: 0.3687 - val_loss: 3.3330 - val_accuracy30: 0.3415 - 7s/epoch - 48ms/step
Epoch 7/50
135/135 - 7s - loss: 3.2738 - accuracy30: 0.3719 - val_loss: 3.3113 - val_accuracy30: 0.3419 - 7s/epoch - 49ms/step
Epoch 8/50
135/135 - 7s - loss: 3.2674 - accuracy30: 0.3809 - val_loss: 3.3036 - val_accuracy30: 0.3520 - 7s/epoch - 49ms/step
Epoch 9/50
135/135 - 7s - loss: 3.2609 - accuracy30: 0.3802 - val_loss: 3.3048 - val_accuracy30: 0.3561 - 7s/epoch - 48ms/step
Epoch 10/50
135/135 - 7s - loss: 3.2510 - accuracy30: 0.3916 - val_loss: 3.3187 - val_accuracy30: 0.3498 - 7s/epoch - 49ms/step
Epoch 11/50
135/135 - 7s - loss: 3.2487 - accuracy30: 0.3907 - val_loss: 3.3095 - val_accuracy30: 0.3583 - 7s/epoch - 48ms/step
Epoch 12/50
135/135 - 7s - loss: 3.2403 - accuracy30: 0.3979 - val_loss: 3.3084 - val_accuracy30: 0.3587 - 7s/epoch - 48ms/step
Epoch 13/50
135/135 - 6s - loss: 3.2304 - accuracy30: 0.4033 - val_loss: 3.3185 - val_accuracy30: 0.3596 - 6s/epoch - 48ms/step
Epoch 14/50
135/135 - 7s - loss: 3.2188 - accuracy30: 0.4113 - val_loss: 3.3240 - val_accuracy30: 0.3564 - 7s/epoch - 48ms/step
Epoch 15/50
135/135 - 7s - loss: 3.2122 - accuracy30: 0.4107 - val_loss: 3.3159 - val_accuracy30: 0.3578 - 7s/epoch - 48ms/step
Epoch 16/50
135/135 - 6s - loss: 3.2006 - accuracy30: 0.4160 - val_loss: 3.3207 - val_accuracy30: 0.3631 - 6s/epoch - 48ms/step
Epoch 17/50
135/135 - 6s - loss: 3.1938 - accuracy30: 0.4232 - val_loss: 3.3241 - val_accuracy30: 0.3592 - 6s/epoch - 48ms/step
Epoch 18/50
135/135 - 7s - loss: 3.1834 - accuracy30: 0.4282 - val_loss: 3.3344 - val_accuracy30: 0.3581 - 7s/epoch - 49ms/step
testing model: results/LILAK/W10/deepVOL_L3/h30
Evaluating performance on  test set...
519/519 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0867771
{'0': {'precision': 0.39403397753833874, 'recall': 0.5351930001161486, 'f1-score': 0.45389174369161567, 'support': 51658}, '1': {'precision': 0.30928032724018917, 'recall': 0.1468455072375808, 'f1-score': 0.19913989999794235, 'support': 32953}, '2': {'precision': 0.36324786324786323, 'recall': 0.35417404529261026, 'f1-score': 0.35865357229506645, 'support': 47999}, 'accuracy': 0.3731694442349747, 'macro avg': {'precision': 0.35552072267546375, 'recall': 0.34540418421544655, 'f1-score': 0.33722840532820814, 'support': 132610}, 'weighted avg': {'precision': 0.3618298470949072, 'recall': 0.3731694442349747, 'f1-score': 0.35611499613034137, 'support': 132610}}
[[27647  5703 18308]
 [16622  4839 11492]
 [25895  5104 17000]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 26ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0852685
{'0': {'precision': 0.3590933191940615, 'recall': 0.4731877729257642, 'f1-score': 0.40832014469816863, 'support': 11450}, '1': {'precision': 0.4273533041624593, 'recall': 0.3345042592429964, 'f1-score': 0.37527093596059113, 'support': 11387}, '2': {'precision': 0.3739585351676032, 'recall': 0.3360612920076615, 'f1-score': 0.35399853264856934, 'support': 11486}, 'accuracy': 0.3812895143198438, 'macro avg': {'precision': 0.3868017195080413, 'recall': 0.3812511080588074, 'f1-score': 0.3791965377691097, 'support': 34323}, 'weighted avg': {'precision': 0.3867138162225044, 'recall': 0.3812895143198438, 'f1-score': 0.3791773140628369, 'support': 34323}}
[[5418 2533 3499]
 [4615 3809 2963]
 [5055 2571 3860]]
Evaluating performance on  val set...
46/46 - 1s - 1s/epoch - 26ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1016548
{'0': {'precision': 0.34668138104997637, 'recall': 0.549063670411985, 'f1-score': 0.42500966370313104, 'support': 4005}, '1': {'precision': 0.3599419448476052, 'recall': 0.1954294720252167, 'f1-score': 0.2533197139938713, 'support': 3807}, '2': {'precision': 0.343520782396088, 'recall': 0.2904392764857881, 'f1-score': 0.3147577709325119, 'support': 3870}, 'accuracy': 0.34814244136278033, 'macro avg': {'precision': 0.35004803609788987, 'recall': 0.34497747297432996, 'f1-score': 0.3310290495431714, 'support': 11682}, 'weighted avg': {'precision': 0.3499557732419833, 'recall': 0.34814244136278033, 'f1-score': 0.3325341917321117, 'support': 11682}}
[[2199  688 1118]
 [2033  744 1030]
 [2111  635 1124]]
training model: results/LILAK/W10/deepVOL_L3/h50
Epoch 1/50
135/135 - 9s - loss: 3.3720 - accuracy50: 0.3355 - val_loss: 3.3474 - val_accuracy50: 0.3404 - 9s/epoch - 66ms/step
Epoch 2/50
135/135 - 7s - loss: 3.3315 - accuracy50: 0.3473 - val_loss: 3.3155 - val_accuracy50: 0.3421 - 7s/epoch - 49ms/step
Epoch 3/50
135/135 - 7s - loss: 3.3130 - accuracy50: 0.3522 - val_loss: 3.3448 - val_accuracy50: 0.3395 - 7s/epoch - 49ms/step
Epoch 4/50
135/135 - 7s - loss: 3.3135 - accuracy50: 0.3541 - val_loss: 3.3191 - val_accuracy50: 0.3438 - 7s/epoch - 49ms/step
Epoch 5/50
135/135 - 7s - loss: 3.3092 - accuracy50: 0.3556 - val_loss: 3.3217 - val_accuracy50: 0.3364 - 7s/epoch - 48ms/step
Epoch 6/50
135/135 - 7s - loss: 3.2933 - accuracy50: 0.3629 - val_loss: 3.3150 - val_accuracy50: 0.3395 - 7s/epoch - 49ms/step
Epoch 7/50
135/135 - 7s - loss: 3.2901 - accuracy50: 0.3614 - val_loss: 3.3216 - val_accuracy50: 0.3385 - 7s/epoch - 49ms/step
Epoch 8/50
135/135 - 7s - loss: 3.2771 - accuracy50: 0.3712 - val_loss: 3.3075 - val_accuracy50: 0.3446 - 7s/epoch - 49ms/step
Epoch 9/50
135/135 - 7s - loss: 3.2688 - accuracy50: 0.3778 - val_loss: 3.3193 - val_accuracy50: 0.3409 - 7s/epoch - 48ms/step
Epoch 10/50
135/135 - 6s - loss: 3.2649 - accuracy50: 0.3785 - val_loss: 3.3184 - val_accuracy50: 0.3455 - 6s/epoch - 48ms/step
Epoch 11/50
135/135 - 7s - loss: 3.2481 - accuracy50: 0.3968 - val_loss: 3.3241 - val_accuracy50: 0.3478 - 7s/epoch - 49ms/step
Epoch 12/50
135/135 - 7s - loss: 3.2465 - accuracy50: 0.3990 - val_loss: 3.3282 - val_accuracy50: 0.3432 - 7s/epoch - 48ms/step
Epoch 13/50
135/135 - 6s - loss: 3.2342 - accuracy50: 0.4062 - val_loss: 3.3382 - val_accuracy50: 0.3433 - 6s/epoch - 48ms/step
Epoch 14/50
135/135 - 6s - loss: 3.2248 - accuracy50: 0.4112 - val_loss: 3.3305 - val_accuracy50: 0.3472 - 6s/epoch - 48ms/step
Epoch 15/50
135/135 - 7s - loss: 3.2136 - accuracy50: 0.4200 - val_loss: 3.3373 - val_accuracy50: 0.3512 - 7s/epoch - 48ms/step
Epoch 16/50
135/135 - 7s - loss: 3.2050 - accuracy50: 0.4212 - val_loss: 3.3484 - val_accuracy50: 0.3488 - 7s/epoch - 48ms/step
Epoch 17/50
135/135 - 7s - loss: 3.1960 - accuracy50: 0.4265 - val_loss: 3.3486 - val_accuracy50: 0.3502 - 7s/epoch - 49ms/step
Epoch 18/50
135/135 - 7s - loss: 3.1770 - accuracy50: 0.4336 - val_loss: 3.3486 - val_accuracy50: 0.3551 - 7s/epoch - 48ms/step
testing model: results/LILAK/W10/deepVOL_L3/h50
Evaluating performance on  test set...
519/519 - 12s - 12s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0935141
{'0': {'precision': 0.3957880461879026, 'recall': 0.3844112576752475, 'f1-score': 0.3900167043333006, 'support': 51627}, '1': {'precision': 0.27926885701064325, 'recall': 0.18341792541713522, 'f1-score': 0.2214150753031387, 'support': 32903}, '2': {'precision': 0.37402435216984076, 'recall': 0.47341930116472547, 'f1-score': 0.4178929105813452, 'support': 48080}, 'accuracy': 0.36681245758238445, 'macro avg': {'precision': 0.3496937517894622, 'recall': 0.34708282808570273, 'f1-score': 0.3431082300725948, 'support': 132610}, 'weighted avg': {'precision': 0.3589866790972776, 'recall': 0.36681245758238445, 'f1-score': 0.35829050417061725, 'support': 132610}}
[[19846  8095 23686]
 [12459  6035 14409]
 [17838  7480 22762]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 24ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0908388
{'0': {'precision': 0.3746659030164185, 'recall': 0.3395622458690198, 'f1-score': 0.3562514181983209, 'support': 11559}, '1': {'precision': 0.3825136612021858, 'recall': 0.3339935181850918, 'f1-score': 0.3566107559955784, 'support': 11108}, '2': {'precision': 0.36761379700311, 'recall': 0.4462079615648593, 'f1-score': 0.4031157960006201, 'support': 11656}, 'accuracy': 0.3739766337441366, 'macro avg': {'precision': 0.3749311204072381, 'recall': 0.37325457520632366, 'f1-score': 0.37199265673150644, 'support': 34323}, 'weighted avg': {'precision': 0.37481080731488825, 'recall': 0.3739766337441366, 'f1-score': 0.3722827299110365, 'support': 34323}}
[[3925 2921 4713]
 [3164 3710 4234]
 [3387 3068 5201]]
Evaluating performance on  val set...
46/46 - 1s - 1s/epoch - 24ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1030054
{'0': {'precision': 0.3420101229211858, 'recall': 0.3548387096774194, 'f1-score': 0.3483063328424153, 'support': 3999}, '1': {'precision': 0.3271179570328334, 'recall': 0.21405835543766577, 'f1-score': 0.2587782587782588, 'support': 3770}, '2': {'precision': 0.3401105408606396, 'recall': 0.4403271147457194, 'f1-score': 0.3837843857890633, 'support': 3913}, 'accuracy': 0.3380414312617702, 'macro avg': {'precision': 0.3364128736048863, 'recall': 0.3364080599536015, 'f1-score': 0.33028965913657915, 'support': 11682}, 'weighted avg': {'precision': 0.3365678587539194, 'recall': 0.3380414312617702, 'f1-score': 0.33129766839783076, 'support': 11682}}
[[1419  856 1724]
 [1344  807 1619]
 [1386  804 1723]]
training model: results/LILAK/W10/deepVOL_L3/h100
Epoch 1/50
135/135 - 9s - loss: 3.3658 - accuracy100: 0.3399 - val_loss: 3.3378 - val_accuracy100: 0.3398 - 9s/epoch - 67ms/step
Epoch 2/50
135/135 - 7s - loss: 3.3387 - accuracy100: 0.3501 - val_loss: 3.3238 - val_accuracy100: 0.3519 - 7s/epoch - 49ms/step
Epoch 3/50
135/135 - 7s - loss: 3.3246 - accuracy100: 0.3500 - val_loss: 3.3062 - val_accuracy100: 0.3532 - 7s/epoch - 48ms/step
Epoch 4/50
135/135 - 7s - loss: 3.3077 - accuracy100: 0.3601 - val_loss: 3.3041 - val_accuracy100: 0.3543 - 7s/epoch - 49ms/step
Epoch 5/50
135/135 - 7s - loss: 3.3013 - accuracy100: 0.3549 - val_loss: 3.2941 - val_accuracy100: 0.3626 - 7s/epoch - 49ms/step
Epoch 6/50
135/135 - 7s - loss: 3.2890 - accuracy100: 0.3607 - val_loss: 3.2936 - val_accuracy100: 0.3618 - 7s/epoch - 48ms/step
Epoch 7/50
135/135 - 7s - loss: 3.2807 - accuracy100: 0.3702 - val_loss: 3.2984 - val_accuracy100: 0.3592 - 7s/epoch - 48ms/step
Epoch 8/50
135/135 - 7s - loss: 3.2732 - accuracy100: 0.3763 - val_loss: 3.3049 - val_accuracy100: 0.3669 - 7s/epoch - 48ms/step
Epoch 9/50
135/135 - 6s - loss: 3.2681 - accuracy100: 0.3812 - val_loss: 3.3097 - val_accuracy100: 0.3540 - 6s/epoch - 48ms/step
Epoch 10/50
135/135 - 7s - loss: 3.2738 - accuracy100: 0.3782 - val_loss: 3.3223 - val_accuracy100: 0.3571 - 7s/epoch - 48ms/step
Epoch 11/50
135/135 - 6s - loss: 3.2623 - accuracy100: 0.3855 - val_loss: 3.3176 - val_accuracy100: 0.3567 - 6s/epoch - 48ms/step
Epoch 12/50
135/135 - 7s - loss: 3.2549 - accuracy100: 0.3913 - val_loss: 3.3035 - val_accuracy100: 0.3627 - 7s/epoch - 48ms/step
Epoch 13/50
135/135 - 6s - loss: 3.2417 - accuracy100: 0.3955 - val_loss: 3.3174 - val_accuracy100: 0.3582 - 6s/epoch - 48ms/step
Epoch 14/50
135/135 - 6s - loss: 3.2282 - accuracy100: 0.4069 - val_loss: 3.3305 - val_accuracy100: 0.3562 - 6s/epoch - 48ms/step
Epoch 15/50
135/135 - 6s - loss: 3.2207 - accuracy100: 0.4087 - val_loss: 3.3332 - val_accuracy100: 0.3620 - 6s/epoch - 48ms/step
Epoch 16/50
135/135 - 7s - loss: 3.2117 - accuracy100: 0.4162 - val_loss: 3.3287 - val_accuracy100: 0.3628 - 7s/epoch - 49ms/step
testing model: results/LILAK/W10/deepVOL_L3/h100
Evaluating performance on  test set...
519/519 - 11s - 11s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0892229
{'0': {'precision': 0.414453732760212, 'recall': 0.5686451869674548, 'f1-score': 0.47945759195845, 'support': 55277}, '1': {'precision': 0.22578753351206435, 'recall': 0.09820712776036732, 'f1-score': 0.13687846005383716, 'support': 27442}, '2': {'precision': 0.3805540685224839, 'recall': 0.34196548475676974, 'f1-score': 0.36022930016996924, 'support': 49891}, 'accuracy': 0.3860116130005279, 'macro avg': {'precision': 0.3402651115982534, 'recall': 0.3362725998281973, 'f1-score': 0.3255217840607521, 'support': 132610}, 'weighted avg': {'precision': 0.3626577446126201, 'recall': 0.3860116130005279, 'f1-score': 0.3637085892939037, 'support': 132610}}
[[31433  4926 18918]
 [15894  2695  8853]
 [28515  4315 17061]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 24ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.097406
{'0': {'precision': 0.3645352279455299, 'recall': 0.5384346305203324, 'f1-score': 0.4347396293027361, 'support': 11435}, '1': {'precision': 0.36910750885038196, 'recall': 0.17526320445899318, 'f1-score': 0.23767246550689863, 'support': 11303}, '2': {'precision': 0.3707110890104426, 'recall': 0.3861027190332326, 'f1-score': 0.3782503911039702, 'support': 11585}, 'accuracy': 0.3674212627101361, 'macro avg': {'precision': 0.3681179419354515, 'recall': 0.3666001846708527, 'f1-score': 0.3502208286378683, 'support': 34323}, 'weighted avg': {'precision': 0.36812546893566933, 'recall': 0.3674212627101361, 'f1-score': 0.35077616524315347, 'support': 34323}}
[[6157 1633 3645]
 [5374 1981 3948]
 [5359 1753 4473]]
Evaluating performance on  val set...
46/46 - 1s - 1s/epoch - 25ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.099011
{'0': {'precision': 0.3832857142857143, 'recall': 0.6167816091954023, 'f1-score': 0.47277533039647573, 'support': 4350}, '1': {'precision': 0.2901023890784983, 'recall': 0.10278113663845223, 'f1-score': 0.15178571428571427, 'support': 3308}, '2': {'precision': 0.33475783475783477, 'recall': 0.29199801192842945, 'f1-score': 0.311919299177064, 'support': 4024}, 'accuracy': 0.3593562746105119, 'macro avg': {'precision': 0.33604864604068246, 'recall': 0.3371869192540946, 'f1-score': 0.3121601146197513, 'support': 11682}, 'weighted avg': {'precision': 0.3401829384762931, 'recall': 0.3593562746105119, 'f1-score': 0.3264717591140488, 'support': 11682}}
[[2683  423 1244]
 [1877  340 1091]
 [2440  409 1175]]
training model: results/LILAK/W10/deepVOL_L3/h200
Epoch 1/50
135/135 - 9s - loss: 3.3636 - accuracy200: 0.3419 - val_loss: 3.3493 - val_accuracy200: 0.3367 - 9s/epoch - 68ms/step
Epoch 2/50
135/135 - 7s - loss: 3.3419 - accuracy200: 0.3382 - val_loss: 3.3674 - val_accuracy200: 0.3073 - 7s/epoch - 48ms/step
Epoch 3/50
135/135 - 7s - loss: 3.3152 - accuracy200: 0.3557 - val_loss: 3.3290 - val_accuracy200: 0.3444 - 7s/epoch - 49ms/step
Epoch 4/50
135/135 - 7s - loss: 3.3097 - accuracy200: 0.3573 - val_loss: 3.3309 - val_accuracy200: 0.3296 - 7s/epoch - 48ms/step
Epoch 5/50
135/135 - 7s - loss: 3.2946 - accuracy200: 0.3602 - val_loss: 3.3290 - val_accuracy200: 0.3290 - 7s/epoch - 48ms/step
Epoch 6/50
135/135 - 7s - loss: 3.2857 - accuracy200: 0.3687 - val_loss: 3.3333 - val_accuracy200: 0.3256 - 7s/epoch - 48ms/step
Epoch 7/50
135/135 - 6s - loss: 3.2732 - accuracy200: 0.3768 - val_loss: 3.3635 - val_accuracy200: 0.3207 - 6s/epoch - 48ms/step
Epoch 8/50
135/135 - 7s - loss: 3.2639 - accuracy200: 0.3820 - val_loss: 3.3382 - val_accuracy200: 0.3264 - 7s/epoch - 48ms/step
Epoch 9/50
135/135 - 7s - loss: 3.2511 - accuracy200: 0.3893 - val_loss: 3.3769 - val_accuracy200: 0.3173 - 7s/epoch - 48ms/step
Epoch 10/50
135/135 - 7s - loss: 3.2354 - accuracy200: 0.3998 - val_loss: 3.3966 - val_accuracy200: 0.3186 - 7s/epoch - 48ms/step
Epoch 11/50
135/135 - 7s - loss: 3.2103 - accuracy200: 0.4152 - val_loss: 3.4008 - val_accuracy200: 0.3252 - 7s/epoch - 48ms/step
Epoch 12/50
135/135 - 6s - loss: 3.2025 - accuracy200: 0.4188 - val_loss: 3.4007 - val_accuracy200: 0.3211 - 6s/epoch - 48ms/step
Epoch 13/50
135/135 - 6s - loss: 3.1805 - accuracy200: 0.4272 - val_loss: 3.4126 - val_accuracy200: 0.3284 - 6s/epoch - 48ms/step
Epoch 14/50
135/135 - 6s - loss: 3.1574 - accuracy200: 0.4426 - val_loss: 3.4216 - val_accuracy200: 0.3225 - 6s/epoch - 48ms/step
Epoch 15/50
135/135 - 6s - loss: 3.1324 - accuracy200: 0.4520 - val_loss: 3.4508 - val_accuracy200: 0.3217 - 6s/epoch - 48ms/step
testing model: results/LILAK/W10/deepVOL_L3/h200
Evaluating performance on  test set...
519/519 - 11s - 11s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1151932
{'0': {'precision': 0.38641652541155513, 'recall': 0.2588380193599292, 'f1-score': 0.31001498213668316, 'support': 51963}, '1': {'precision': 0.2778787761575059, 'recall': 0.39023330345745405, 'f1-score': 0.3246088675515391, 'support': 36819}, '2': {'precision': 0.3224070980757967, 'recall': 0.3390982933284658, 'f1-score': 0.3305421184320267, 'support': 43828}, 'accuracy': 0.3218460146293643, 'macro avg': {'precision': 0.32890079988161924, 'recall': 0.32938987204861636, 'f1-score': 0.3217219893734163, 'support': 132610}, 'weighted avg': {'precision': 0.3351258492102395, 'recall': 0.3218460146293643, 'f1-score': 0.3208512357875533, 'support': 132610}}
[[13450 19975 18538]
 [ 9754 14368 12697]
 [11603 17363 14862]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 24ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0969635
{'0': {'precision': 0.4063590538968592, 'recall': 0.18106427090532135, 'f1-score': 0.2505079478905223, 'support': 11576}, '1': {'precision': 0.35354860794157916, 'recall': 0.5497693399574166, 'f1-score': 0.43034722222222216, 'support': 11272}, '2': {'precision': 0.36444100713242245, 'recall': 0.3695860566448802, 'f1-score': 0.3669955001730703, 'support': 11475}, 'accuracy': 0.3651778690673892, 'macro avg': {'precision': 0.3747828896569536, 'recall': 0.3668065558358727, 'f1-score': 0.3492835567619383, 'support': 34323}, 'weighted avg': {'precision': 0.37500139479276495, 'recall': 0.3651778690673892, 'f1-score': 0.34851345331572287, 'support': 34323}}
[[2096 5692 3788]
 [1467 6197 3608]
 [1595 5639 4241]]
Evaluating performance on  val set...
46/46 - 1s - 1s/epoch - 25ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1110052
{'0': {'precision': 0.35538005923000987, 'recall': 0.16419612314709237, 'f1-score': 0.22461394478240523, 'support': 4385}, '1': {'precision': 0.29856714428523823, 'recall': 0.5247437774524158, 'f1-score': 0.38058829775937136, 'support': 3415}, '2': {'precision': 0.34537493158182814, 'recall': 0.3250901597114889, 'f1-score': 0.33492569002123146, 'support': 3882}, 'accuracy': 0.32306111967128914, 'macro avg': {'precision': 0.3331073783656921, 'recall': 0.3380100201036657, 'f1-score': 0.3133759775210027, 'support': 11682}, 'weighted avg': {'precision': 0.3354471701642132, 'recall': 0.32306111967128914, 'f1-score': 0.3068672071033659, 'support': 11682}}
[[ 720 2306 1359]
 [ 590 1792 1033]
 [ 716 1904 1262]]
training model: results/LILAK/W10/deepVOL_L3/h300
Epoch 1/50
135/135 - 10s - loss: 3.3690 - accuracy300: 0.3358 - val_loss: 3.3262 - val_accuracy300: 0.3565 - 10s/epoch - 71ms/step
Epoch 2/50
135/135 - 7s - loss: 3.3445 - accuracy300: 0.3459 - val_loss: 3.3333 - val_accuracy300: 0.3397 - 7s/epoch - 49ms/step
Epoch 3/50
135/135 - 7s - loss: 3.3415 - accuracy300: 0.3455 - val_loss: 3.2902 - val_accuracy300: 0.3612 - 7s/epoch - 49ms/step
Epoch 4/50
135/135 - 7s - loss: 3.3185 - accuracy300: 0.3518 - val_loss: 3.3244 - val_accuracy300: 0.3470 - 7s/epoch - 49ms/step
Epoch 5/50
135/135 - 7s - loss: 3.3104 - accuracy300: 0.3477 - val_loss: 3.2965 - val_accuracy300: 0.3445 - 7s/epoch - 49ms/step
Epoch 6/50
135/135 - 6s - loss: 3.2921 - accuracy300: 0.3575 - val_loss: 3.3149 - val_accuracy300: 0.3341 - 6s/epoch - 48ms/step
Epoch 7/50
135/135 - 7s - loss: 3.2836 - accuracy300: 0.3671 - val_loss: 3.3103 - val_accuracy300: 0.3528 - 7s/epoch - 49ms/step
Epoch 8/50
135/135 - 6s - loss: 3.2869 - accuracy300: 0.3685 - val_loss: 3.3291 - val_accuracy300: 0.3352 - 6s/epoch - 48ms/step
Epoch 9/50
135/135 - 7s - loss: 3.2730 - accuracy300: 0.3751 - val_loss: 3.3190 - val_accuracy300: 0.3364 - 7s/epoch - 48ms/step
Epoch 10/50
135/135 - 7s - loss: 3.2570 - accuracy300: 0.3903 - val_loss: 3.3674 - val_accuracy300: 0.3152 - 7s/epoch - 49ms/step
Epoch 11/50
135/135 - 7s - loss: 3.2455 - accuracy300: 0.3944 - val_loss: 3.3497 - val_accuracy300: 0.3312 - 7s/epoch - 49ms/step
Epoch 12/50
135/135 - 7s - loss: 3.2398 - accuracy300: 0.3994 - val_loss: 3.3786 - val_accuracy300: 0.3273 - 7s/epoch - 48ms/step
Epoch 13/50
135/135 - 7s - loss: 3.2276 - accuracy300: 0.4074 - val_loss: 3.4088 - val_accuracy300: 0.3367 - 7s/epoch - 49ms/step
testing model: results/LILAK/W10/deepVOL_L3/h300
Evaluating performance on  test set...
519/519 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1063198
{'0': {'precision': 0.3983457607906342, 'recall': 0.4187098575816811, 'f1-score': 0.4082740342724368, 'support': 53715}, '1': {'precision': 0.24900692840646652, 'recall': 0.16001305986762043, 'f1-score': 0.19482842738656694, 'support': 33691}, '2': {'precision': 0.3334006128552818, 'recall': 0.4019555791522874, 'f1-score': 0.3644825130637995, 'support': 45204}, 'accuracy': 0.34727396123972554, 'macro avg': {'precision': 0.3269177673507942, 'recall': 0.32689283220052967, 'f1-score': 0.322528324907601, 'support': 132610}, 'weighted avg': {'precision': 0.33826616597029896, 'recall': 0.34727396123972554, 'f1-score': 0.33911825517352207, 'support': 132610}}
[[22491  8996 22228]
 [14199  5391 14101]
 [19771  7263 18170]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 25ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1043508
{'0': {'precision': 0.3576294277929155, 'recall': 0.3612592465164287, 'f1-score': 0.3594351732991014, 'support': 11626}, '1': {'precision': 0.35543705077672155, 'recall': 0.26975189160654583, 'f1-score': 0.3067226890756303, 'support': 11366}, '2': {'precision': 0.3311832580806995, 'recall': 0.40781925690583354, 'f1-score': 0.36552760639139376, 'support': 11331}, 'accuracy': 0.34632753547184103, 'macro avg': {'precision': 0.34808324555011216, 'recall': 0.34627679834293607, 'f1-score': 0.34389515625537515, 'support': 34323}, 'weighted avg': {'precision': 0.34817279212076624, 'recall': 0.34632753547184103, 'f1-score': 0.34399081423039507, 'support': 34323}}
[[4200 2805 4621]
 [3589 3066 4711]
 [3955 2755 4621]]
Evaluating performance on  val set...
46/46 - 1s - 1s/epoch - 26ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001581
{'0': {'precision': 0.41127098321342925, 'recall': 0.4427710843373494, 'f1-score': 0.4264401160381268, 'support': 4648}, '1': {'precision': 0.27481949458483756, 'recall': 0.19934533551554828, 'f1-score': 0.2310756972111554, 'support': 3055}, '2': {'precision': 0.3307933662034962, 'recall': 0.3709474742397587, 'f1-score': 0.34972159696718397, 'support': 3979}, 'accuracy': 0.354648176682075, 'macro avg': {'precision': 0.33896128133392106, 'recall': 0.33768796469755213, 'f1-score': 0.3357458034054887, 'support': 11682}, 'weighted avg': {'precision': 0.3481756454422539, 'recall': 0.354648176682075, 'f1-score': 0.3492186396728059, 'support': 11682}}
[[2058  845 1745]
 [1205  609 1241]
 [1741  762 1476]]
training model: results/LILAK/W10/deepVOL_L3/h500
Epoch 1/50
135/135 - 9s - loss: 3.3536 - accuracy500: 0.3446 - val_loss: 3.3438 - val_accuracy500: 0.3396 - 9s/epoch - 66ms/step
Epoch 2/50
135/135 - 6s - loss: 3.3228 - accuracy500: 0.3578 - val_loss: 3.4218 - val_accuracy500: 0.3096 - 6s/epoch - 48ms/step
Epoch 3/50
135/135 - 6s - loss: 3.3050 - accuracy500: 0.3646 - val_loss: 3.3810 - val_accuracy500: 0.3182 - 6s/epoch - 48ms/step
Epoch 4/50
135/135 - 7s - loss: 3.3101 - accuracy500: 0.3587 - val_loss: 3.3474 - val_accuracy500: 0.3378 - 7s/epoch - 48ms/step
Epoch 5/50
135/135 - 6s - loss: 3.2852 - accuracy500: 0.3699 - val_loss: 3.3607 - val_accuracy500: 0.3196 - 6s/epoch - 48ms/step
Epoch 6/50
135/135 - 7s - loss: 3.2518 - accuracy500: 0.3911 - val_loss: 3.3386 - val_accuracy500: 0.3371 - 7s/epoch - 49ms/step
Epoch 7/50
135/135 - 6s - loss: 3.2345 - accuracy500: 0.4022 - val_loss: 3.3682 - val_accuracy500: 0.3379 - 6s/epoch - 48ms/step
Epoch 8/50
135/135 - 6s - loss: 3.2155 - accuracy500: 0.4171 - val_loss: 3.4096 - val_accuracy500: 0.3309 - 6s/epoch - 48ms/step
Epoch 9/50
135/135 - 6s - loss: 3.1783 - accuracy500: 0.4360 - val_loss: 3.3994 - val_accuracy500: 0.3374 - 6s/epoch - 48ms/step
Epoch 10/50
135/135 - 6s - loss: 3.1625 - accuracy500: 0.4391 - val_loss: 3.4065 - val_accuracy500: 0.3395 - 6s/epoch - 48ms/step
Epoch 11/50
135/135 - 6s - loss: 3.1242 - accuracy500: 0.4547 - val_loss: 3.4567 - val_accuracy500: 0.3415 - 6s/epoch - 48ms/step
Epoch 12/50
135/135 - 6s - loss: 3.1144 - accuracy500: 0.4586 - val_loss: 3.4602 - val_accuracy500: 0.3451 - 6s/epoch - 48ms/step
Epoch 13/50
135/135 - 7s - loss: 3.0774 - accuracy500: 0.4714 - val_loss: 3.5297 - val_accuracy500: 0.3355 - 7s/epoch - 48ms/step
Epoch 14/50
135/135 - 6s - loss: 3.0514 - accuracy500: 0.4801 - val_loss: 3.5863 - val_accuracy500: 0.3313 - 6s/epoch - 48ms/step
Epoch 15/50
135/135 - 7s - loss: 3.0161 - accuracy500: 0.4907 - val_loss: 3.6342 - val_accuracy500: 0.3329 - 7s/epoch - 48ms/step
Epoch 16/50
135/135 - 7s - loss: 2.9851 - accuracy500: 0.5027 - val_loss: 3.6355 - val_accuracy500: 0.3310 - 7s/epoch - 49ms/step
testing model: results/LILAK/W10/deepVOL_L3/h500
Evaluating performance on  test set...
519/519 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1191796
{'0': {'precision': 0.40070414472177696, 'recall': 0.26487171724816466, 'f1-score': 0.3189274160477513, 'support': 52852}, '1': {'precision': 0.2525782130167259, 'recall': 0.1619121691064137, 'f1-score': 0.19732900015233837, 'support': 36001}, '2': {'precision': 0.3330339428387581, 'recall': 0.5677491601343785, 'f1-score': 0.41981191858254546, 'support': 43757}, 'accuracy': 0.3368599653118166, 'macro avg': {'precision': 0.3287721001924203, 'recall': 0.33151101549631895, 'f1-score': 0.3120227782608784, 'support': 132610}, 'weighted avg': {'precision': 0.33816190287645004, 'recall': 0.3368599653118166, 'f1-score': 0.31920445855407986, 'support': 132610}}
[[13999  9299 29554]
 [ 9973  5829 20199]
 [10964  7950 24843]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 25ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0860277
{'0': {'precision': 0.4444444444444444, 'recall': 0.22430863776032775, 'f1-score': 0.29814510182086335, 'support': 11716}, '1': {'precision': 0.4302393461762989, 'recall': 0.26056213540745976, 'f1-score': 0.32456236926125726, 'support': 11314}, '2': {'precision': 0.36070136376287226, 'recall': 0.6885681395554768, 'f1-score': 0.47341024626343187, 'support': 11293}, 'accuracy': 0.3890102846487778, 'macro avg': {'precision': 0.4117950514612052, 'recall': 0.3911463042410881, 'f1-score': 0.36537257244851745, 'support': 34323}, 'weighted avg': {'precision': 0.41220871062331005, 'recall': 0.3890102846487778, 'f1-score': 0.3645190854473104, 'support': 34323}}
[[2628 1992 7096]
 [1680 2948 6686]
 [1605 1912 7776]]
Evaluating performance on  val set...
46/46 - 1s - 1s/epoch - 25ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1152192
{'0': {'precision': 0.4066892874454678, 'recall': 0.1817984832069339, 'f1-score': 0.25127283617849655, 'support': 4615}, '1': {'precision': 0.2927335640138408, 'recall': 0.1270651847401622, 'f1-score': 0.17720988688730624, 'support': 3329}, '2': {'precision': 0.320650844139956, 'recall': 0.7011771000535045, 'f1-score': 0.4400604432505037, 'support': 3738}, 'accuracy': 0.332391713747646, 'macro avg': {'precision': 0.3400245651997549, 'recall': 0.3366802560002002, 'f1-score': 0.28951438877210217, 'support': 11682}, 'weighted avg': {'precision': 0.3466849813009814, 'recall': 0.332391713747646, 'f1-score': 0.2905753971307984, 'support': 11682}}
[[ 839  550 3226]
 [ 579  423 2327]
 [ 645  472 2621]]
training model: results/LILAK/W10/deepVOL_L3/h1000
Epoch 1/50
135/135 - 9s - loss: 3.3599 - accuracy1000: 0.3434 - val_loss: 3.4209 - val_accuracy1000: 0.3154 - 9s/epoch - 67ms/step
Epoch 2/50
135/135 - 7s - loss: 3.3485 - accuracy1000: 0.3511 - val_loss: 3.4283 - val_accuracy1000: 0.3137 - 7s/epoch - 49ms/step
Epoch 3/50
135/135 - 7s - loss: 3.3225 - accuracy1000: 0.3549 - val_loss: 3.4220 - val_accuracy1000: 0.3154 - 7s/epoch - 48ms/step
Epoch 4/50
135/135 - 6s - loss: 3.3081 - accuracy1000: 0.3639 - val_loss: 3.4567 - val_accuracy1000: 0.2982 - 6s/epoch - 48ms/step
Epoch 5/50
135/135 - 7s - loss: 3.3006 - accuracy1000: 0.3650 - val_loss: 3.4260 - val_accuracy1000: 0.3162 - 7s/epoch - 48ms/step
Epoch 6/50
135/135 - 7s - loss: 3.2999 - accuracy1000: 0.3653 - val_loss: 3.4096 - val_accuracy1000: 0.3085 - 7s/epoch - 49ms/step
Epoch 7/50
135/135 - 7s - loss: 3.2648 - accuracy1000: 0.3915 - val_loss: 3.3980 - val_accuracy1000: 0.3240 - 7s/epoch - 50ms/step
Epoch 8/50
135/135 - 6s - loss: 3.2443 - accuracy1000: 0.4048 - val_loss: 3.4146 - val_accuracy1000: 0.3126 - 6s/epoch - 48ms/step
Epoch 9/50
135/135 - 7s - loss: 3.2409 - accuracy1000: 0.4054 - val_loss: 3.4701 - val_accuracy1000: 0.3255 - 7s/epoch - 49ms/step
Epoch 10/50
135/135 - 7s - loss: 3.2127 - accuracy1000: 0.4196 - val_loss: 3.4558 - val_accuracy1000: 0.3134 - 7s/epoch - 48ms/step
Epoch 11/50
135/135 - 7s - loss: 3.1875 - accuracy1000: 0.4380 - val_loss: 3.4647 - val_accuracy1000: 0.3203 - 7s/epoch - 48ms/step
Epoch 12/50
135/135 - 7s - loss: 3.1739 - accuracy1000: 0.4389 - val_loss: 3.4642 - val_accuracy1000: 0.3271 - 7s/epoch - 48ms/step
Epoch 13/50
135/135 - 7s - loss: 3.1534 - accuracy1000: 0.4507 - val_loss: 3.4830 - val_accuracy1000: 0.3122 - 7s/epoch - 48ms/step
Epoch 14/50
135/135 - 7s - loss: 3.1117 - accuracy1000: 0.4660 - val_loss: 3.5764 - val_accuracy1000: 0.3097 - 7s/epoch - 49ms/step
Epoch 15/50
135/135 - 7s - loss: 3.0932 - accuracy1000: 0.4722 - val_loss: 3.5210 - val_accuracy1000: 0.3137 - 7s/epoch - 49ms/step
Epoch 16/50
135/135 - 6s - loss: 3.0532 - accuracy1000: 0.4888 - val_loss: 3.6119 - val_accuracy1000: 0.3096 - 6s/epoch - 48ms/step
Epoch 17/50
135/135 - 6s - loss: 3.0581 - accuracy1000: 0.4880 - val_loss: 3.6087 - val_accuracy1000: 0.3131 - 6s/epoch - 48ms/step
testing model: results/LILAK/W10/deepVOL_L3/h1000
Evaluating performance on  test set...
519/519 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1261809
{'0': {'precision': 0.4079795903904755, 'recall': 0.21596578759800428, 'f1-score': 0.28242739403453687, 'support': 53314}, '1': {'precision': 0.2931854584283842, 'recall': 0.3074202249478345, 'f1-score': 0.300134154824605, 'support': 39298}, '2': {'precision': 0.30844227786394857, 'recall': 0.4872243612180609, 'f1-score': 0.3777476255088195, 'support': 39998}, 'accuracy': 0.32488500113113644, 'macro avg': {'precision': 0.3365357755609361, 'recall': 0.33687012458796656, 'f1-score': 0.32010305812265377, 'support': 132610}, 'weighted avg': {'precision': 0.3439386189382299, 'recall': 0.32488500113113644, 'f1-score': 0.31642527431533357, 'support': 132610}}
[[11514 16483 25317]
 [ 8840 12081 18377]
 [ 7868 12642 19488]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 24ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0878694
{'0': {'precision': 0.47493928019430337, 'recall': 0.18578338227673175, 'f1-score': 0.2670888433600298, 'support': 11578}, '1': {'precision': 0.37552208581192253, 'recall': 0.5264838967261113, 'f1-score': 0.4383703320651572, 'support': 11271}, '2': {'precision': 0.3847913093196112, 'recall': 0.46923479170298066, 'f1-score': 0.4228382941961832, 'support': 11474}, 'accuracy': 0.39241907758645805, 'macro avg': {'precision': 0.411750891775279, 'recall': 0.3938340235686079, 'f1-score': 0.3760991565404567, 'support': 34323}, 'weighted avg': {'precision': 0.41215662670538833, 'recall': 0.39241907758645805, 'f1-score': 0.37540055440188264, 'support': 34323}}
[[2151 4920 4507]
 [1236 5934 4101]
 [1142 4948 5384]]
Evaluating performance on  val set...
46/46 - 1s - 1s/epoch - 24ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.135711
{'0': {'precision': 0.3857777777777778, 'recall': 0.09351432880844646, 'f1-score': 0.15053763440860216, 'support': 4641}, '1': {'precision': 0.32476722532588453, 'recall': 0.46346000531490833, 'f1-score': 0.3819117486039636, 'support': 3763}, '2': {'precision': 0.3001735106998265, 'recall': 0.47498474679682734, 'f1-score': 0.36786769049025403, 'support': 3278}, 'accuracy': 0.3197226502311248, 'macro avg': {'precision': 0.3369061712678296, 'recall': 0.3439863603067274, 'f1-score': 0.3001056911676066, 'support': 11682}, 'weighted avg': {'precision': 0.3421043060813218, 'recall': 0.3197226502311248, 'f1-score': 0.28605113514073705, 'support': 11682}}
[[ 434 2240 1967]
 [ 356 1744 1663]
 [ 335 1386 1557]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :         7 (peak)   6.32 (ave)

============================================
