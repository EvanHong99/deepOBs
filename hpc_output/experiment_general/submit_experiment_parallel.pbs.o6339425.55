This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/EXC_orderbooks/EXC_orderbooks_2019-07-31.csv
data/EXC_orderbooks/EXC_orderbooks_2019-07-23.csv
data/EXC_orderbooks/EXC_orderbooks_2019-07-10.csv
data/EXC_orderbooks/EXC_orderbooks_2019-07-11.csv
data/EXC_orderbooks/EXC_orderbooks_2019-07-19.csv
data/EXC_orderbooks/EXC_orderbooks_2019-07-15.csv
data/EXC_orderbooks/EXC_orderbooks_2019-07-17.csv
data/EXC_orderbooks/EXC_orderbooks_2019-07-12.csv
data/EXC_orderbooks/EXC_orderbooks_2019-08-02.csv
data/EXC_orderbooks/EXC_orderbooks_2019-07-16.csv
data/EXC_orderbooks/EXC_orderbooks_2019-07-29.csv
data/EXC_orderbooks/EXC_orderbooks_2019-07-18.csv
data/EXC_orderbooks/EXC_orderbooks_2019-07-09.csv
data/EXC_orderbooks/EXC_orderbooks_2019-07-25.csv
data/EXC_orderbooks/EXC_orderbooks_2019-07-24.csv
training model: results/EXC/W5/deepLOB_L1/h10
Epoch 1/50
1570/1570 - 50s - loss: 2.6549 - accuracy10: 0.4890 - val_loss: 3.5010 - val_accuracy10: 0.5204 - 50s/epoch - 32ms/step
Epoch 2/50
1570/1570 - 42s - loss: 2.4158 - accuracy10: 0.5746 - val_loss: 3.0898 - val_accuracy10: 0.4695 - 42s/epoch - 27ms/step
Epoch 3/50
1570/1570 - 44s - loss: 2.2628 - accuracy10: 0.6296 - val_loss: 3.0655 - val_accuracy10: 0.5328 - 44s/epoch - 28ms/step
Epoch 4/50
1570/1570 - 45s - loss: 2.2109 - accuracy10: 0.6401 - val_loss: 3.1382 - val_accuracy10: 0.5569 - 45s/epoch - 29ms/step
Epoch 5/50
1570/1570 - 48s - loss: 2.1771 - accuracy10: 0.6453 - val_loss: 3.0342 - val_accuracy10: 0.5608 - 48s/epoch - 31ms/step
Epoch 6/50
1570/1570 - 40s - loss: 2.1521 - accuracy10: 0.6490 - val_loss: 3.0998 - val_accuracy10: 0.5909 - 40s/epoch - 25ms/step
Epoch 7/50
1570/1570 - 41s - loss: 2.1306 - accuracy10: 0.6512 - val_loss: 3.2823 - val_accuracy10: 0.6169 - 41s/epoch - 26ms/step
Epoch 8/50
1570/1570 - 41s - loss: 2.1151 - accuracy10: 0.6538 - val_loss: 3.2163 - val_accuracy10: 0.6151 - 41s/epoch - 26ms/step
Epoch 9/50
1570/1570 - 42s - loss: 2.1036 - accuracy10: 0.6538 - val_loss: 3.2531 - val_accuracy10: 0.6354 - 42s/epoch - 27ms/step
Epoch 10/50
1570/1570 - 42s - loss: 2.0918 - accuracy10: 0.6552 - val_loss: 3.2241 - val_accuracy10: 0.6334 - 42s/epoch - 27ms/step
Epoch 11/50
1570/1570 - 42s - loss: 2.0839 - accuracy10: 0.6567 - val_loss: 3.2813 - val_accuracy10: 0.6364 - 42s/epoch - 27ms/step
Epoch 12/50
1570/1570 - 41s - loss: 2.0735 - accuracy10: 0.6577 - val_loss: 3.2037 - val_accuracy10: 0.6317 - 41s/epoch - 26ms/step
Epoch 13/50
1570/1570 - 43s - loss: 2.0662 - accuracy10: 0.6603 - val_loss: 3.1775 - val_accuracy10: 0.6183 - 43s/epoch - 27ms/step
Epoch 14/50
1570/1570 - 40s - loss: 2.0582 - accuracy10: 0.6606 - val_loss: 3.3281 - val_accuracy10: 0.6283 - 40s/epoch - 26ms/step
Epoch 15/50
1570/1570 - 44s - loss: 2.0545 - accuracy10: 0.6602 - val_loss: 3.2576 - val_accuracy10: 0.6335 - 44s/epoch - 28ms/step
testing model: results/EXC/W5/deepLOB_L1/h10
Evaluating performance on  test set...
7167/7167 - 117s - 117s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7896971
{'0': {'precision': 0.34760018406258125, 'recall': 0.6445355393975367, 'f1-score': 0.45163311194582717, 'support': 269560}, '1': {'precision': 0.8266144231119974, 'recall': 0.6303875288515852, 'f1-score': 0.7152872002626874, 'support': 1294123}, '2': {'precision': 0.3609516279738374, 'recall': 0.4634682968606952, 'f1-score': 0.40583598534377, 'support': 270888}, 'accuracy': 0.6078194847732794, 'macro avg': {'precision': 0.5117220783828054, 'recall': 0.5794637883699391, 'f1-score': 0.5242520991840949, 'support': 1834571}, 'weighted avg': {'precision': 0.6874726065633076, 'recall': 0.6078194847732794, 'f1-score': 0.6308548088460301, 'support': 1834571}}
[[173741  73791  22028]
 [278075 815799 200249]
 [ 48014  97326 125548]]
Evaluating performance on  train set...
1570/1570 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79838145
{'0': {'precision': 0.2922495141721669, 'recall': 0.6631311325626663, 'f1-score': 0.40570164779079376, 'support': 50346}, '1': {'precision': 0.8668431193196193, 'recall': 0.5919797450184906, 'f1-score': 0.7035173101412648, 'support': 300963}, '2': {'precision': 0.3305667102002954, 'recall': 0.5374677515380035, 'f1-score': 0.4093592001148739, 'support': 50390}, 'accuracy': 0.5940592334061076, 'macro avg': {'precision': 0.4965531145640272, 'recall': 0.5975262097063868, 'f1-score': 0.5061927193489776, 'support': 401699}, 'weighted avg': {'precision': 0.7275560961996306, 'recall': 0.5940592334061076, 'f1-score': 0.6292914482373849, 'support': 401699}}
[[ 33386  11903   5057]
 [ 73010 178164  49789]
 [  7842  15465  27083]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8391495
{'0': {'precision': 0.3130896930610295, 'recall': 0.566351606805293, 'f1-score': 0.4032534081950507, 'support': 18515}, '1': {'precision': 0.8335734387563656, 'recall': 0.5600625780819143, 'f1-score': 0.669978794304756, 'support': 88849}, '2': {'precision': 0.32227750138197897, 'recall': 0.5707603611443489, 'f1-score': 0.4119494386433226, 'support': 18386}, 'accuracy': 0.5625526838966203, 'macro avg': {'precision': 0.48964687773312465, 'recall': 0.5657248486771854, 'f1-score': 0.4950605470477098, 'support': 125750}, 'weighted avg': {'precision': 0.6821822367196689, 'recall': 0.5625526838966203, 'f1-score': 0.5929803986227496, 'support': 125750}}
[[10486  4667  3362]
 [20382 49761 18706]
 [ 2624  5268 10494]]
training model: results/EXC/W5/deepLOB_L1/h20
Epoch 1/50
1570/1570 - 44s - loss: 2.7173 - accuracy20: 0.5001 - val_loss: 3.2599 - val_accuracy20: 0.5206 - 44s/epoch - 28ms/step
Epoch 2/50
1570/1570 - 41s - loss: 2.4822 - accuracy20: 0.5793 - val_loss: 3.0425 - val_accuracy20: 0.5318 - 41s/epoch - 26ms/step
Epoch 3/50
1570/1570 - 46s - loss: 2.3671 - accuracy20: 0.6161 - val_loss: 3.4835 - val_accuracy20: 0.6035 - 46s/epoch - 29ms/step
Epoch 4/50
1570/1570 - 42s - loss: 2.3243 - accuracy20: 0.6248 - val_loss: 3.2399 - val_accuracy20: 0.6049 - 42s/epoch - 26ms/step
Epoch 5/50
1570/1570 - 40s - loss: 2.2964 - accuracy20: 0.6305 - val_loss: 3.4099 - val_accuracy20: 0.6030 - 40s/epoch - 26ms/step
Epoch 6/50
1570/1570 - 41s - loss: 2.2783 - accuracy20: 0.6323 - val_loss: 3.1693 - val_accuracy20: 0.5986 - 41s/epoch - 26ms/step
Epoch 7/50
1570/1570 - 43s - loss: 2.2610 - accuracy20: 0.6345 - val_loss: 3.1794 - val_accuracy20: 0.6043 - 43s/epoch - 27ms/step
Epoch 8/50
1570/1570 - 41s - loss: 2.2455 - accuracy20: 0.6367 - val_loss: 3.1026 - val_accuracy20: 0.5877 - 41s/epoch - 26ms/step
Epoch 9/50
1570/1570 - 41s - loss: 2.2337 - accuracy20: 0.6368 - val_loss: 3.0666 - val_accuracy20: 0.5889 - 41s/epoch - 26ms/step
Epoch 10/50
1570/1570 - 41s - loss: 2.2242 - accuracy20: 0.6380 - val_loss: 3.0121 - val_accuracy20: 0.5877 - 41s/epoch - 26ms/step
Epoch 11/50
1570/1570 - 39s - loss: 2.2160 - accuracy20: 0.6391 - val_loss: 3.0240 - val_accuracy20: 0.5825 - 39s/epoch - 25ms/step
Epoch 12/50
1570/1570 - 41s - loss: 2.2086 - accuracy20: 0.6405 - val_loss: 2.9703 - val_accuracy20: 0.5781 - 41s/epoch - 26ms/step
Epoch 13/50
1570/1570 - 43s - loss: 2.2008 - accuracy20: 0.6405 - val_loss: 3.0441 - val_accuracy20: 0.5797 - 43s/epoch - 28ms/step
Epoch 14/50
1570/1570 - 45s - loss: 2.1959 - accuracy20: 0.6414 - val_loss: 3.0199 - val_accuracy20: 0.5866 - 45s/epoch - 28ms/step
Epoch 15/50
1570/1570 - 42s - loss: 2.1903 - accuracy20: 0.6425 - val_loss: 3.0020 - val_accuracy20: 0.5782 - 42s/epoch - 27ms/step
Epoch 16/50
1570/1570 - 42s - loss: 2.1831 - accuracy20: 0.6429 - val_loss: 2.8896 - val_accuracy20: 0.5438 - 42s/epoch - 26ms/step
Epoch 17/50
1570/1570 - 43s - loss: 2.1778 - accuracy20: 0.6428 - val_loss: 2.9761 - val_accuracy20: 0.5739 - 43s/epoch - 27ms/step
Epoch 18/50
1570/1570 - 39s - loss: 2.1739 - accuracy20: 0.6436 - val_loss: 2.9507 - val_accuracy20: 0.5775 - 39s/epoch - 25ms/step
Epoch 19/50
1570/1570 - 38s - loss: 2.1685 - accuracy20: 0.6441 - val_loss: 3.0072 - val_accuracy20: 0.5762 - 38s/epoch - 24ms/step
Epoch 20/50
1570/1570 - 40s - loss: 2.1644 - accuracy20: 0.6443 - val_loss: 2.9740 - val_accuracy20: 0.5663 - 40s/epoch - 26ms/step
Epoch 21/50
1570/1570 - 41s - loss: 2.1615 - accuracy20: 0.6447 - val_loss: 3.0116 - val_accuracy20: 0.5652 - 41s/epoch - 26ms/step
Epoch 22/50
1570/1570 - 44s - loss: 2.1550 - accuracy20: 0.6453 - val_loss: 2.9824 - val_accuracy20: 0.5676 - 44s/epoch - 28ms/step
Epoch 23/50
1570/1570 - 43s - loss: 2.1517 - accuracy20: 0.6458 - val_loss: 2.9904 - val_accuracy20: 0.5704 - 43s/epoch - 28ms/step
Epoch 24/50
1570/1570 - 40s - loss: 2.1491 - accuracy20: 0.6463 - val_loss: 3.0575 - val_accuracy20: 0.5641 - 40s/epoch - 25ms/step
Epoch 25/50
1570/1570 - 43s - loss: 2.1447 - accuracy20: 0.6468 - val_loss: 2.9732 - val_accuracy20: 0.5601 - 43s/epoch - 27ms/step
Epoch 26/50
1570/1570 - 40s - loss: 2.1412 - accuracy20: 0.6466 - val_loss: 3.0284 - val_accuracy20: 0.5624 - 40s/epoch - 26ms/step
testing model: results/EXC/W5/deepLOB_L1/h20
Evaluating performance on  test set...
7167/7167 - 118s - 118s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8462331
{'0': {'precision': 0.38282103855985405, 'recall': 0.7118024940168787, 'f1-score': 0.4978752272346823, 'support': 357255}, '1': {'precision': 0.7721054071564016, 'recall': 0.5833498135572138, 'f1-score': 0.6645849135083556, 'support': 1117501}, '2': {'precision': 0.4633034558494224, 'recall': 0.4197601545238525, 'f1-score': 0.4404582590297938, 'support': 359815}, 'accuracy': 0.5762791410089879, 'macro avg': {'precision': 0.5394099671885594, 'recall': 0.5716374873659816, 'f1-score': 0.5343061332576106, 'support': 1834571}, 'weighted avg': {'precision': 0.6357327286323868, 'recall': 0.5762791410089879, 'f1-score': 0.5881626866493761, 'support': 1834571}}
[[254295  79015  23945]
 [314590 651894 151017]
 [ 95381 113398 151036]]
Evaluating performance on  train set...
1570/1570 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83955747
{'0': {'precision': 0.3427843174872898, 'recall': 0.7350681026756197, 'f1-score': 0.46754047802621435, 'support': 68059}, '1': {'precision': 0.8317650509973824, 'recall': 0.5552220820545649, 'f1-score': 0.6659244522028187, 'support': 265555}, '2': {'precision': 0.4237409063690453, 'recall': 0.488492325769259, 'f1-score': 0.4538185489923179, 'support': 68085}, 'accuracy': 0.5743828090186931, 'macro avg': {'precision': 0.5327634249512392, 'recall': 0.5929275034998146, 'f1-score': 0.5290944930737836, 'support': 401699}, 'weighted avg': {'precision': 0.6797610290083216, 'recall': 0.5743828090186931, 'f1-score': 0.5963623041303255, 'support': 401699}}
[[ 50028  12042   5989]
 [ 78872 147442  39241]
 [ 17046  17780  33259]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8848817
{'0': {'precision': 0.35014874093937237, 'recall': 0.691003803538945, 'f1-score': 0.4647812908428575, 'support': 24188}, '1': {'precision': 0.8074550439480687, 'recall': 0.5164530520669469, 'f1-score': 0.6299721606190724, 'support': 77554}, '2': {'precision': 0.4147191327608053, 'recall': 0.4907947350883039, 'f1-score': 0.44956123616940097, 'support': 24008}, 'accuracy': 0.5451292246520875, 'macro avg': {'precision': 0.524107639216082, 'recall': 0.566083863564732, 'f1-score': 0.514771562543777, 'support': 125750}, 'weighted avg': {'precision': 0.6445116752565524, 'recall': 0.5451292246520875, 'f1-score': 0.5637539321313205, 'support': 125750}}
[[16714  4209  3265]
 [24137 40053 13364]
 [ 6883  5342 11783]]
training model: results/EXC/W5/deepLOB_L1/h30
Epoch 1/50
1570/1570 - 47s - loss: 2.8065 - accuracy30: 0.5025 - val_loss: 3.2916 - val_accuracy30: 0.5189 - 47s/epoch - 30ms/step
Epoch 2/50
1570/1570 - 42s - loss: 2.6186 - accuracy30: 0.5627 - val_loss: 3.5469 - val_accuracy30: 0.5450 - 42s/epoch - 27ms/step
Epoch 3/50
1570/1570 - 43s - loss: 2.4939 - accuracy30: 0.5967 - val_loss: 3.6728 - val_accuracy30: 0.5447 - 43s/epoch - 27ms/step
Epoch 4/50
1570/1570 - 43s - loss: 2.4457 - accuracy30: 0.6051 - val_loss: 3.1468 - val_accuracy30: 0.5555 - 43s/epoch - 27ms/step
Epoch 5/50
1570/1570 - 41s - loss: 2.4176 - accuracy30: 0.6086 - val_loss: 3.4181 - val_accuracy30: 0.5463 - 41s/epoch - 26ms/step
Epoch 6/50
1570/1570 - 41s - loss: 2.4000 - accuracy30: 0.6101 - val_loss: 3.2824 - val_accuracy30: 0.5402 - 41s/epoch - 26ms/step
Epoch 7/50
1570/1570 - 40s - loss: 2.3834 - accuracy30: 0.6126 - val_loss: 3.2751 - val_accuracy30: 0.5334 - 40s/epoch - 26ms/step
Epoch 8/50
1570/1570 - 40s - loss: 2.3722 - accuracy30: 0.6144 - val_loss: 3.3477 - val_accuracy30: 0.5431 - 40s/epoch - 26ms/step
Epoch 9/50
1570/1570 - 39s - loss: 2.3611 - accuracy30: 0.6163 - val_loss: 3.3587 - val_accuracy30: 0.5428 - 39s/epoch - 25ms/step
Epoch 10/50
1570/1570 - 41s - loss: 2.3539 - accuracy30: 0.6167 - val_loss: 3.3953 - val_accuracy30: 0.5313 - 41s/epoch - 26ms/step
Epoch 11/50
1570/1570 - 41s - loss: 2.3479 - accuracy30: 0.6183 - val_loss: 3.2761 - val_accuracy30: 0.5507 - 41s/epoch - 26ms/step
Epoch 12/50
1570/1570 - 41s - loss: 2.3402 - accuracy30: 0.6189 - val_loss: 3.3074 - val_accuracy30: 0.5386 - 41s/epoch - 26ms/step
Epoch 13/50
1570/1570 - 41s - loss: 2.3342 - accuracy30: 0.6197 - val_loss: 3.3468 - val_accuracy30: 0.5319 - 41s/epoch - 26ms/step
Epoch 14/50
1570/1570 - 41s - loss: 2.3298 - accuracy30: 0.6212 - val_loss: 3.3280 - val_accuracy30: 0.5356 - 41s/epoch - 26ms/step
testing model: results/EXC/W5/deepLOB_L1/h30
Evaluating performance on  test set...
7167/7167 - 110s - 110s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89350414
{'0': {'precision': 0.4559892609961472, 'recall': 0.5587973480127899, 'f1-score': 0.5021855580372858, 'support': 421269}, '1': {'precision': 0.6406695146450335, 'recall': 0.6749631260986402, 'f1-score': 0.6573693674192763, 'support': 989860}, '2': {'precision': 0.5210562043292181, 'recall': 0.3389814897908096, 'f1-score': 0.4107457373458155, 'support': 423442}, 'accuracy': 0.5707394262745895, 'macro avg': {'precision': 0.5392383266567996, 'recall': 0.5242473213007466, 'f1-score': 0.5234335542674592, 'support': 1834571}, 'weighted avg': {'precision': 0.5706534917594858, 'recall': 0.5707394262745895, 'f1-score': 0.5648109810934769, 'support': 1834571}}
[[235404 165671  20194]
 [209997 668119 111744]
 [ 70848 209055 143539]]
Evaluating performance on  train set...
1570/1570 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8507024
{'0': {'precision': 0.41559450241448015, 'recall': 0.6095365452001535, 'f1-score': 0.4942198127651032, 'support': 80763}, '1': {'precision': 0.7067897534268474, 'recall': 0.6631200059990502, 'f1-score': 0.6842588313684189, 'support': 240038}, '2': {'precision': 0.4929359062715369, 'recall': 0.3536552201537739, 'f1-score': 0.41183837395097095, 'support': 80898}, 'accuracy': 0.5900238735968972, 'macro avg': {'precision': 0.5384400540376214, 'recall': 0.5421039237843258, 'f1-score': 0.5301056726948311, 'support': 401699}, 'weighted avg': {'precision': 0.6051759814615646, 'recall': 0.5900238735968972, 'f1-score': 0.5911881704416645, 'support': 401699}}
[[ 49228  27755   3780]
 [ 55214 159174  25650]
 [ 14010  38278  28610]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89724505
{'0': {'precision': 0.4238362876495172, 'recall': 0.5231606660025615, 'f1-score': 0.46828973138225877, 'support': 28108}, '1': {'precision': 0.6363179961736252, 'recall': 0.6728167458142638, 'f1-score': 0.6540585774058577, 'support': 69701}, '2': {'precision': 0.47839363908734733, 'recall': 0.2971618768118536, 'f1-score': 0.36660264476676163, 'support': 27941}, 'accuracy': 0.55589662027833, 'macro avg': {'precision': 0.5128493076368299, 'recall': 0.49771309620955956, 'f1-score': 0.4963169845182927, 'support': 125750}, 'weighted avg': {'precision': 0.5537335005510143, 'recall': 0.55589662027833, 'f1-score': 0.5486637707426345, 'support': 125750}}
[[14705 11887  1516]
 [15268 46896  7537]
 [ 4722 14916  8303]]
training model: results/EXC/W5/deepLOB_L1/h50
Epoch 1/50
1570/1570 - 42s - loss: 2.9475 - accuracy50: 0.4819 - val_loss: 3.4444 - val_accuracy50: 0.3842 - 42s/epoch - 27ms/step
Epoch 2/50
1570/1570 - 38s - loss: 2.8328 - accuracy50: 0.5171 - val_loss: 3.2230 - val_accuracy50: 0.4538 - 38s/epoch - 24ms/step
Epoch 3/50
1570/1570 - 39s - loss: 2.7335 - accuracy50: 0.5525 - val_loss: 3.0947 - val_accuracy50: 0.4830 - 39s/epoch - 25ms/step
Epoch 4/50
1570/1570 - 41s - loss: 2.6794 - accuracy50: 0.5657 - val_loss: 3.1546 - val_accuracy50: 0.5068 - 41s/epoch - 26ms/step
Epoch 5/50
1570/1570 - 40s - loss: 2.6484 - accuracy50: 0.5717 - val_loss: 3.1357 - val_accuracy50: 0.4922 - 40s/epoch - 26ms/step
Epoch 6/50
1570/1570 - 41s - loss: 2.6279 - accuracy50: 0.5755 - val_loss: 3.2388 - val_accuracy50: 0.4864 - 41s/epoch - 26ms/step
Epoch 7/50
1570/1570 - 40s - loss: 2.6126 - accuracy50: 0.5771 - val_loss: 3.2282 - val_accuracy50: 0.4951 - 40s/epoch - 25ms/step
Epoch 8/50
1570/1570 - 40s - loss: 2.6023 - accuracy50: 0.5791 - val_loss: 3.2043 - val_accuracy50: 0.5004 - 40s/epoch - 26ms/step
Epoch 9/50
1570/1570 - 38s - loss: 2.5927 - accuracy50: 0.5807 - val_loss: 3.1705 - val_accuracy50: 0.5158 - 38s/epoch - 24ms/step
Epoch 10/50
1570/1570 - 39s - loss: 2.5854 - accuracy50: 0.5818 - val_loss: 3.2246 - val_accuracy50: 0.5066 - 39s/epoch - 25ms/step
Epoch 11/50
1570/1570 - 41s - loss: 2.5796 - accuracy50: 0.5824 - val_loss: 3.1448 - val_accuracy50: 0.5051 - 41s/epoch - 26ms/step
Epoch 12/50
1570/1570 - 39s - loss: 2.5733 - accuracy50: 0.5838 - val_loss: 3.1328 - val_accuracy50: 0.5053 - 39s/epoch - 25ms/step
Epoch 13/50
1570/1570 - 40s - loss: 2.5688 - accuracy50: 0.5848 - val_loss: 3.1789 - val_accuracy50: 0.5022 - 40s/epoch - 25ms/step
testing model: results/EXC/W5/deepLOB_L1/h50
Evaluating performance on  test set...
7167/7167 - 123s - 123s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.022502
{'0': {'precision': 0.4253182169129474, 'recall': 0.6131503228062988, 'f1-score': 0.5022472843829762, 'support': 517493}, '1': {'precision': 0.5254944078793577, 'recall': 0.5068016177091305, 'f1-score': 0.5159787685098107, 'support': 798413}, '2': {'precision': 0.4915124934463954, 'recall': 0.3018518697039515, 'f1-score': 0.3740121740293744, 'support': 518665}, 'accuracy': 0.47885745495813464, 'macro avg': {'precision': 0.48077503941290023, 'recall': 0.4739346034064602, 'f1-score': 0.4640794089740538, 'support': 1834571}, 'weighted avg': {'precision': 0.4876295843096224, 'recall': 0.47885745495813464, 'f1-score': 0.4719689969384496, 'support': 1834571}}
[[317301 148806  51386]
 [283195 404637 110581]
 [145536 216569 156560]]
Evaluating performance on  train set...
1570/1570 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9832403
{'0': {'precision': 0.39690406265296135, 'recall': 0.6431432423857868, 'f1-score': 0.49087414492402687, 'support': 100864}, '1': {'precision': 0.6145876064391821, 'recall': 0.49285005806679927, 'f1-score': 0.5470276968696147, 'support': 200631}, '2': {'precision': 0.4576897723894583, 'recall': 0.3533890862640214, 'f1-score': 0.3988331559415001, 'support': 100204}, 'accuracy': 0.49579909335099165, 'macro avg': {'precision': 0.48972714716053395, 'recall': 0.49646079557220246, 'f1-score': 0.4789116659117139, 'support': 401699}, 'weighted avg': {'precision': 0.5207904510477773, 'recall': 0.49579909335099165, 'f1-score': 0.49596070979073087, 'support': 401699}}
[[64870 24907 11087]
 [70879 98881 30871]
 [27691 37102 35411]]
Evaluating performance on  val set...
492/492 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9917916
{'0': {'precision': 0.3996820033787141, 'recall': 0.4713189195523525, 'f1-score': 0.43255451294598446, 'support': 34134}, '1': {'precision': 0.5857361469072165, 'recall': 0.5019238400883413, 'f1-score': 0.5406008121091609, 'support': 57957}, '2': {'precision': 0.43121058212870456, 'recall': 0.45907483882468286, 'f1-score': 0.4447066611025571, 'support': 33659}, 'accuracy': 0.48214711729622267, 'macro avg': {'precision': 0.4722095774715451, 'recall': 0.47743919948845887, 'f1-score': 0.4726206620525675, 'support': 125750}, 'weighted avg': {'precision': 0.4938717483379773, 'recall': 0.48214711729622267, 'f1-score': 0.4856047595893426, 'support': 125750}}
[[16088  9133  8913]
 [17398 29090 11469]
 [ 6766 11441 15452]]
training model: results/EXC/W5/deepLOB_L1/h100
Epoch 1/50
1570/1570 - 45s - loss: 3.1156 - accuracy100: 0.4586 - val_loss: 3.3562 - val_accuracy100: 0.4032 - 45s/epoch - 29ms/step
Epoch 2/50
1570/1570 - 39s - loss: 3.0523 - accuracy100: 0.4797 - val_loss: 3.3007 - val_accuracy100: 0.4067 - 39s/epoch - 25ms/step
Epoch 3/50
1570/1570 - 41s - loss: 3.0059 - accuracy100: 0.4933 - val_loss: 3.2951 - val_accuracy100: 0.3988 - 41s/epoch - 26ms/step
Epoch 4/50
1570/1570 - 44s - loss: 2.9731 - accuracy100: 0.5010 - val_loss: 3.3590 - val_accuracy100: 0.4034 - 44s/epoch - 28ms/step
Epoch 5/50
1570/1570 - 43s - loss: 2.9558 - accuracy100: 0.5035 - val_loss: 3.3055 - val_accuracy100: 0.4158 - 43s/epoch - 27ms/step
Epoch 6/50
1570/1570 - 45s - loss: 2.9414 - accuracy100: 0.5064 - val_loss: 3.3785 - val_accuracy100: 0.4118 - 45s/epoch - 28ms/step
Epoch 7/50
1570/1570 - 43s - loss: 2.9300 - accuracy100: 0.5088 - val_loss: 3.3889 - val_accuracy100: 0.3901 - 43s/epoch - 28ms/step
Epoch 8/50
1570/1570 - 43s - loss: 2.9221 - accuracy100: 0.5104 - val_loss: 3.6319 - val_accuracy100: 0.3666 - 43s/epoch - 27ms/step
Epoch 9/50
1570/1570 - 42s - loss: 2.9150 - accuracy100: 0.5113 - val_loss: 3.6619 - val_accuracy100: 0.3448 - 42s/epoch - 27ms/step
Epoch 10/50
1570/1570 - 40s - loss: 2.9105 - accuracy100: 0.5130 - val_loss: 3.7506 - val_accuracy100: 0.3542 - 40s/epoch - 26ms/step
Epoch 11/50
1570/1570 - 39s - loss: 2.9059 - accuracy100: 0.5138 - val_loss: 3.8028 - val_accuracy100: 0.3659 - 39s/epoch - 25ms/step
Epoch 12/50
1570/1570 - 40s - loss: 2.9014 - accuracy100: 0.5150 - val_loss: 3.8787 - val_accuracy100: 0.3605 - 40s/epoch - 26ms/step
Epoch 13/50
1570/1570 - 42s - loss: 2.8981 - accuracy100: 0.5153 - val_loss: 3.9416 - val_accuracy100: 0.3709 - 42s/epoch - 27ms/step
testing model: results/EXC/W5/deepLOB_L1/h100
Evaluating performance on  test set...
7167/7167 - 109s - 109s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1317166
{'0': {'precision': 0.40261573937208067, 'recall': 0.7905268290417702, 'f1-score': 0.5335130137737594, 'support': 646035}, '1': {'precision': 0.3320280040646345, 'recall': 0.2565210924747864, 'f1-score': 0.28943103246842905, 'support': 531161}, '2': {'precision': 0.5459104715303063, 'recall': 0.12932192432021297, 'f1-score': 0.2091078364092082, 'support': 657375}, 'accuracy': 0.3989897365651152, 'macro avg': {'precision': 0.42685140498900714, 'recall': 0.3921232819455898, 'f1-score': 0.34401729421713223, 'support': 1834571}, 'weighted avg': {'precision': 0.43352483064130665, 'recall': 0.3989897365651152, 'f1-score': 0.3466013691755713, 'support': 1834571}}
[[510708 103056  32271]
 [356464 136254  38443]
 [401303 171059  85013]]
Evaluating performance on  train set...
1570/1570 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0813626
{'0': {'precision': 0.4030190611357634, 'recall': 0.6796358430974544, 'f1-score': 0.5059898557303282, 'support': 132031}, '1': {'precision': 0.4122308231396534, 'recall': 0.36836224932750744, 'f1-score': 0.38906385057687254, 'support': 140522}, '2': {'precision': 0.5117148787374484, 'recall': 0.21189971040527775, 'f1-score': 0.29969609856262835, 'support': 129146}, 'accuracy': 0.42036948063101975, 'macro avg': {'precision': 0.44232158767095503, 'recall': 0.41996593427674656, 'f1-score': 0.3982499349566097, 'support': 401699}, 'weighted avg': {'precision': 0.44118715535630626, 'recall': 0.42036948063101975, 'f1-score': 0.3987635752084607, 'support': 401699}}
[[89733 31671 10627]
 [73273 51763 15486]
 [59646 42134 27366]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0953243
{'0': {'precision': 0.3772288232439456, 'recall': 0.5592378565295086, 'f1-score': 0.45054595766958344, 'support': 43089}, '1': {'precision': 0.3805031446540881, 'recall': 0.2896999902276947, 'f1-score': 0.32895028850421665, 'support': 40932}, '2': {'precision': 0.45758296153971406, 'recall': 0.3367202664813439, 'f1-score': 0.38795626484068696, 'support': 41729}, 'accuracy': 0.397662027833002, 'macro avg': {'precision': 0.4051049764792492, 'recall': 0.3952193710795157, 'f1-score': 0.38915083700482905, 'support': 125750}, 'weighted avg': {'precision': 0.40495941855928613, 'recall': 0.397662027833002, 'f1-score': 0.3901963813488374, 'support': 125750}}
[[24097  9203  9789]
 [22207 11858  6867]
 [17575 10103 14051]]
training model: results/EXC/W5/deepLOB_L1/h200
Epoch 1/50
1570/1570 - 44s - loss: 3.2195 - accuracy200: 0.4166 - val_loss: 3.4083 - val_accuracy200: 0.3501 - 44s/epoch - 28ms/step
Epoch 2/50
1570/1570 - 40s - loss: 3.1917 - accuracy200: 0.4272 - val_loss: 3.3100 - val_accuracy200: 0.3681 - 40s/epoch - 25ms/step
Epoch 3/50
1570/1570 - 41s - loss: 3.1821 - accuracy200: 0.4295 - val_loss: 3.4506 - val_accuracy200: 0.3516 - 41s/epoch - 26ms/step
Epoch 4/50
1570/1570 - 43s - loss: 3.1725 - accuracy200: 0.4343 - val_loss: 3.4901 - val_accuracy200: 0.3733 - 43s/epoch - 27ms/step
Epoch 5/50
1570/1570 - 42s - loss: 3.1654 - accuracy200: 0.4373 - val_loss: 3.4717 - val_accuracy200: 0.3709 - 42s/epoch - 27ms/step
Epoch 6/50
1570/1570 - 43s - loss: 3.1571 - accuracy200: 0.4406 - val_loss: 3.4359 - val_accuracy200: 0.3671 - 43s/epoch - 28ms/step
Epoch 7/50
1570/1570 - 43s - loss: 3.1531 - accuracy200: 0.4434 - val_loss: 3.5186 - val_accuracy200: 0.3700 - 43s/epoch - 27ms/step
Epoch 8/50
1570/1570 - 45s - loss: 3.1478 - accuracy200: 0.4440 - val_loss: 3.6073 - val_accuracy200: 0.3591 - 45s/epoch - 29ms/step
Epoch 9/50
1570/1570 - 45s - loss: 3.1455 - accuracy200: 0.4460 - val_loss: 3.6677 - val_accuracy200: 0.3530 - 45s/epoch - 28ms/step
Epoch 10/50
1570/1570 - 46s - loss: 3.1414 - accuracy200: 0.4473 - val_loss: 3.6658 - val_accuracy200: 0.3534 - 46s/epoch - 29ms/step
Epoch 11/50
1570/1570 - 45s - loss: 3.1388 - accuracy200: 0.4483 - val_loss: 3.7633 - val_accuracy200: 0.3541 - 45s/epoch - 28ms/step
Epoch 12/50
1570/1570 - 45s - loss: 3.1362 - accuracy200: 0.4484 - val_loss: 3.7376 - val_accuracy200: 0.3582 - 45s/epoch - 29ms/step
testing model: results/EXC/W5/deepLOB_L1/h200
Evaluating performance on  test set...
7167/7167 - 124s - 124s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1187868
{'0': {'precision': 0.41082121448114584, 'recall': 0.5799761098273253, 'f1-score': 0.48095909014613203, 'support': 652151}, '1': {'precision': 0.27453007755262926, 'recall': 0.46059386595803703, 'f1-score': 0.3440151034609596, 'support': 497486}, '2': {'precision': 0.49909766655308624, 'recall': 0.05773986982687383, 'f1-score': 0.10350535807991124, 'support': 684934}, 'accuracy': 0.3526268539075348, 'macro avg': {'precision': 0.3948163195289538, 'recall': 0.3661032818707454, 'f1-score': 0.3094931838956676, 'support': 1834571}, 'weighted avg': {'precision': 0.4068206120936789, 'recall': 0.3526268539075348, 'f1-score': 0.3029018709493255, 'support': 1834571}}
[[378232 254812  19107]
 [247763 229139  20584]
 [294678 350708  39548]]
Evaluating performance on  train set...
1570/1570 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0930096
{'0': {'precision': 0.3961228249961504, 'recall': 0.5514669465778639, 'f1-score': 0.4610616351579351, 'support': 135281}, '1': {'precision': 0.34659547689936404, 'recall': 0.4599520277826829, 'f1-score': 0.3953078807999368, 'support': 135912}, '2': {'precision': 0.4582916704542011, 'recall': 0.11589505463350344, 'f1-score': 0.1850051067525335, 'support': 130506}, 'accuracy': 0.3789927283861797, 'macro avg': {'precision': 0.4003366574499052, 'recall': 0.37577134299801673, 'f1-score': 0.34712487423680183, 'support': 401699}, 'weighted avg': {'precision': 0.3995633274888575, 'recall': 0.3789927283861797, 'f1-score': 0.3491276807334043, 'support': 401699}}
[[74603 53165  7513]
 [63034 62513 10365]
 [50696 64685 15125]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.101328
{'0': {'precision': 0.4170482221139795, 'recall': 0.3801363020844895, 'f1-score': 0.39773769844495804, 'support': 45047}, '1': {'precision': 0.3130733054990765, 'recall': 0.5300068316779653, 'f1-score': 0.3936304116619669, 'support': 38058}, '2': {'precision': 0.4401559646611717, 'recall': 0.20912181967405322, 'f1-score': 0.2835341620831081, 'support': 42645}, 'accuracy': 0.3674990059642147, 'macro avg': {'precision': 0.39009249742474256, 'recall': 0.37308831781216933, 'f1-score': 0.35830075739667766, 'support': 125750}, 'weighted avg': {'precision': 0.3934168289083734, 'recall': 0.3674990059642147, 'f1-score': 0.35776533320807397, 'support': 125750}}
[[17124 21610  6313]
 [12857 20171  5030]
 [11079 22648  8918]]
training model: results/EXC/W5/deepLOB_L1/h300
Epoch 1/50
1570/1570 - 43s - loss: 3.2575 - accuracy300: 0.3962 - val_loss: 3.3926 - val_accuracy300: 0.3397 - 43s/epoch - 27ms/step
Epoch 2/50
1570/1570 - 37s - loss: 3.2312 - accuracy300: 0.4085 - val_loss: 3.6079 - val_accuracy300: 0.3463 - 37s/epoch - 24ms/step
Epoch 3/50
1570/1570 - 40s - loss: 3.2158 - accuracy300: 0.4158 - val_loss: 3.5108 - val_accuracy300: 0.3516 - 40s/epoch - 25ms/step
Epoch 4/50
1570/1570 - 43s - loss: 3.2097 - accuracy300: 0.4179 - val_loss: 3.5737 - val_accuracy300: 0.3464 - 43s/epoch - 27ms/step
Epoch 5/50
1570/1570 - 42s - loss: 3.2016 - accuracy300: 0.4217 - val_loss: 3.5807 - val_accuracy300: 0.3413 - 42s/epoch - 27ms/step
Epoch 6/50
1570/1570 - 42s - loss: 3.1965 - accuracy300: 0.4227 - val_loss: 3.5992 - val_accuracy300: 0.3405 - 42s/epoch - 27ms/step
Epoch 7/50
1570/1570 - 39s - loss: 3.1951 - accuracy300: 0.4234 - val_loss: 3.6139 - val_accuracy300: 0.3406 - 39s/epoch - 25ms/step
Epoch 8/50
1570/1570 - 40s - loss: 3.1911 - accuracy300: 0.4262 - val_loss: 3.5873 - val_accuracy300: 0.3426 - 40s/epoch - 26ms/step
Epoch 9/50
1570/1570 - 42s - loss: 3.1886 - accuracy300: 0.4272 - val_loss: 3.7608 - val_accuracy300: 0.3419 - 42s/epoch - 27ms/step
Epoch 10/50
1570/1570 - 40s - loss: 3.1838 - accuracy300: 0.4291 - val_loss: 3.6624 - val_accuracy300: 0.3400 - 40s/epoch - 26ms/step
Epoch 11/50
1570/1570 - 41s - loss: 3.1810 - accuracy300: 0.4307 - val_loss: 3.7275 - val_accuracy300: 0.3425 - 41s/epoch - 26ms/step
testing model: results/EXC/W5/deepLOB_L1/h300
Evaluating performance on  test set...
7167/7167 - 117s - 117s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1346258
{'0': {'precision': 0.3522848927024793, 'recall': 0.4945132543164392, 'f1-score': 0.4114547235373877, 'support': 618855}, '1': {'precision': 0.30278371073376437, 'recall': 0.5051253479898102, 'f1-score': 0.37861619596561136, 'support': 558206}, '2': {'precision': 0.43499104718997283, 'recall': 0.022907636385758393, 'f1-score': 0.04352323820751991, 'support': 657510}, 'accuracy': 0.32871881219097, 'macro avg': {'precision': 0.3633532168754055, 'recall': 0.3408487462306693, 'f1-score': 0.2778647192368397, 'support': 1834571}, 'weighted avg': {'precision': 0.36686501353456674, 'recall': 0.32871881219097, 'f1-score': 0.26959633046294557, 'support': 1834571}}
[[306032 302520  10303]
 [266981 281964   9261]
 [295693 346755  15062]]
Evaluating performance on  train set...
1570/1570 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1087716
{'0': {'precision': 0.3632888476111638, 'recall': 0.3953362335398632, 'f1-score': 0.37863563509849923, 'support': 136542}, '1': {'precision': 0.33673460711036285, 'recall': 0.5918193502107182, 'f1-score': 0.4292395822607131, 'support': 133828}, '2': {'precision': 0.4051156037082542, 'recall': 0.05523532502341448, 'f1-score': 0.09721580058297316, 'support': 131329}, 'accuracy': 0.34960505253933916, 'macro avg': {'precision': 0.3683796861432603, 'recall': 0.34746363625799864, 'f1-score': 0.3016970059807285, 'support': 401699}, 'weighted avg': {'precision': 0.36811675396326726, 'recall': 0.34960505253933916, 'f1-score': 0.30348891975625353, 'support': 401699}}
[[53980 77702  4860]
 [48834 79202  5792]
 [45773 78302  7254]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1309625
{'0': {'precision': 0.3532713994733966, 'recall': 0.32191036668175643, 'f1-score': 0.3368625500367133, 'support': 44180}, '1': {'precision': 0.3295021600165787, 'recall': 0.5101436398637642, 'f1-score': 0.4003912870826836, 'support': 40518}, '2': {'precision': 0.34770001318044025, 'recall': 0.19277988892136802, 'f1-score': 0.2480372337924874, 'support': 41052}, 'accuracy': 0.3404055666003976, 'macro avg': {'precision': 0.3434911908901385, 'recall': 0.34161129848896293, 'f1-score': 0.3284303569706281, 'support': 125750}, 'weighted avg': {'precision': 0.34379387585979987, 'recall': 0.3404055666003976, 'f1-score': 0.3283345220857842, 'support': 125750}}
[[14222 21468  8490]
 [13491 20670  6357]
 [12545 20593  7914]]
training model: results/EXC/W5/deepLOB_L1/h500
Epoch 1/50
1570/1570 - 41s - loss: 3.2174 - accuracy500: 0.4221 - val_loss: 3.4846 - val_accuracy500: 0.3389 - 41s/epoch - 26ms/step
Epoch 2/50
1570/1570 - 40s - loss: 3.1897 - accuracy500: 0.4329 - val_loss: 3.5905 - val_accuracy500: 0.3314 - 40s/epoch - 26ms/step
Epoch 3/50
1570/1570 - 41s - loss: 3.1677 - accuracy500: 0.4443 - val_loss: 3.5407 - val_accuracy500: 0.3397 - 41s/epoch - 26ms/step
Epoch 4/50
1570/1570 - 40s - loss: 3.1556 - accuracy500: 0.4493 - val_loss: 3.6473 - val_accuracy500: 0.3356 - 40s/epoch - 25ms/step
Epoch 5/50
1570/1570 - 41s - loss: 3.1457 - accuracy500: 0.4523 - val_loss: 3.4884 - val_accuracy500: 0.3368 - 41s/epoch - 26ms/step
Epoch 6/50
1570/1570 - 41s - loss: 3.1378 - accuracy500: 0.4549 - val_loss: 3.5162 - val_accuracy500: 0.3418 - 41s/epoch - 26ms/step
Epoch 7/50
1570/1570 - 40s - loss: 3.1333 - accuracy500: 0.4571 - val_loss: 3.6802 - val_accuracy500: 0.3217 - 40s/epoch - 25ms/step
Epoch 8/50
1570/1570 - 40s - loss: 3.1281 - accuracy500: 0.4583 - val_loss: 3.7264 - val_accuracy500: 0.3304 - 40s/epoch - 25ms/step
Epoch 9/50
1570/1570 - 39s - loss: 3.1236 - accuracy500: 0.4606 - val_loss: 3.7213 - val_accuracy500: 0.3233 - 39s/epoch - 25ms/step
Epoch 10/50
1570/1570 - 40s - loss: 3.1159 - accuracy500: 0.4628 - val_loss: 3.7560 - val_accuracy500: 0.3226 - 40s/epoch - 26ms/step
Epoch 11/50
1570/1570 - 42s - loss: 3.1128 - accuracy500: 0.4639 - val_loss: 3.7131 - val_accuracy500: 0.3392 - 42s/epoch - 27ms/step
testing model: results/EXC/W5/deepLOB_L1/h500
Evaluating performance on  test set...
7167/7167 - 115s - 115s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1915599
{'0': {'precision': 0.3584813555744172, 'recall': 0.8748725481327247, 'f1-score': 0.5085734047085542, 'support': 652207}, '1': {'precision': 0.28154142972335156, 'recall': 0.1370498392943749, 'f1-score': 0.18435744151491065, 'support': 486604}, '2': {'precision': 0.4071106659989985, 'recall': 0.0035055191445325976, 'f1-score': 0.006951183539460578, 'support': 695760}, 'accuracy': 0.3487060462636769, 'macro avg': {'precision': 0.34904448376558905, 'recall': 0.33847596885721076, 'f1-score': 0.23329400992097513, 'support': 1834571}, 'weighted avg': {'precision': 0.35651634759280987, 'recall': 0.3487060462636769, 'f1-score': 0.23233800081604294, 'support': 1834571}}
[[570598  79923   1686]
 [418049  66689   1866]
 [603062  90259   2439]]
Evaluating performance on  train set...
1570/1570 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1594758
{'0': {'precision': 0.3394393551611594, 'recall': 0.7343221630407964, 'f1-score': 0.4642703938962258, 'support': 137806}, '1': {'precision': 0.315536924533722, 'recall': 0.22145806731034895, 'f1-score': 0.2602564215071126, 'support': 133917}, '2': {'precision': 0.3507143602044009, 'recall': 0.0258740075090786, 'f1-score': 0.04819259843083868, 'support': 129976}, 'accuracy': 0.33411584295704, 'macro avg': {'precision': 0.3352302132997608, 'recall': 0.32721807928674135, 'f1-score': 0.2575731379447257, 'support': 401699}, 'weighted avg': {'precision': 0.33511905128478886, 'recall': 0.33411584295704, 'f1-score': 0.2616284488482122, 'support': 401699}}
[[101194  33265   3347]
 [101381  29657   2879]
 [ 95546  31067   3363]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1591172
{'0': {'precision': 0.3659029547956983, 'recall': 0.5119228496665823, 'f1-score': 0.426768232075787, 'support': 47388}, '1': {'precision': 0.26349067234255663, 'recall': 0.2395287958115183, 'f1-score': 0.2509390091218029, 'support': 35144}, '2': {'precision': 0.3624331891066429, 'recall': 0.23064463880790412, 'f1-score': 0.28189646639612, 'support': 43218}, 'accuracy': 0.3391252485089463, 'macro avg': {'precision': 0.3306089387482993, 'recall': 0.3273654280953349, 'f1-score': 0.31986790253123665, 'support': 125750}, 'weighted avg': {'precision': 0.3360887711926541, 'recall': 0.3391252485089463, 'f1-score': 0.3278385288500322, 'support': 125750}}
[[24259 12351 10778]
 [19969  8418  6757]
 [22071 11179  9968]]
training model: results/EXC/W5/deepLOB_L1/h1000
Epoch 1/50
1570/1570 - 48s - loss: 3.2108 - accuracy1000: 0.4301 - val_loss: 3.3506 - val_accuracy1000: 0.3580 - 48s/epoch - 30ms/step
Epoch 2/50
1570/1570 - 43s - loss: 3.1639 - accuracy1000: 0.4434 - val_loss: 3.4603 - val_accuracy1000: 0.3514 - 43s/epoch - 28ms/step
Epoch 3/50
1570/1570 - 42s - loss: 3.1340 - accuracy1000: 0.4555 - val_loss: 3.4030 - val_accuracy1000: 0.3225 - 42s/epoch - 26ms/step
Epoch 4/50
1570/1570 - 41s - loss: 3.1425 - accuracy1000: 0.4502 - val_loss: 3.3885 - val_accuracy1000: 0.3282 - 41s/epoch - 26ms/step
Epoch 5/50
1570/1570 - 43s - loss: 3.1264 - accuracy1000: 0.4585 - val_loss: 3.4642 - val_accuracy1000: 0.3404 - 43s/epoch - 27ms/step
Epoch 6/50
1570/1570 - 41s - loss: 3.1184 - accuracy1000: 0.4611 - val_loss: 3.4824 - val_accuracy1000: 0.3490 - 41s/epoch - 26ms/step
Epoch 7/50
1570/1570 - 43s - loss: 3.1227 - accuracy1000: 0.4601 - val_loss: 3.4146 - val_accuracy1000: 0.3439 - 43s/epoch - 27ms/step
Epoch 8/50
1570/1570 - 44s - loss: 3.1109 - accuracy1000: 0.4609 - val_loss: 3.4268 - val_accuracy1000: 0.3399 - 44s/epoch - 28ms/step
Epoch 9/50
1570/1570 - 42s - loss: 3.1058 - accuracy1000: 0.4651 - val_loss: 3.5194 - val_accuracy1000: 0.3503 - 42s/epoch - 27ms/step
Epoch 10/50
1570/1570 - 42s - loss: 3.1012 - accuracy1000: 0.4668 - val_loss: 3.5997 - val_accuracy1000: 0.3538 - 42s/epoch - 27ms/step
Epoch 11/50
1570/1570 - 41s - loss: 3.0889 - accuracy1000: 0.4723 - val_loss: 3.6752 - val_accuracy1000: 0.3537 - 41s/epoch - 26ms/step
testing model: results/EXC/W5/deepLOB_L1/h1000
Evaluating performance on  test set...
7167/7167 - 107s - 107s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1240124
{'0': {'precision': 0.3865832691558986, 'recall': 0.9592709128116313, 'f1-score': 0.551082116398001, 'support': 709051}, '1': {'precision': 0.20485135606603133, 'recall': 0.030490204652789926, 'f1-score': 0.053079955370206044, 'support': 365888}, '2': {'precision': 0.4056708762761891, 'recall': 0.011036923141731787, 'f1-score': 0.02148919837139353, 'support': 759632}, 'accuracy': 0.3814036088000955, 'macro avg': {'precision': 0.332368500499373, 'recall': 0.3335993468687177, 'f1-score': 0.20855042337986684, 'support': 1834571}, 'weighted avg': {'precision': 0.35824205530011166, 'recall': 0.3814036088000955, 'f1-score': 0.2324742553773451, 'support': 1834571}}
[[680172  20847   8032]
 [350481  11156   4251]
 [728792  22456   8384]]
Evaluating performance on  train set...
1570/1570 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1248174
{'0': {'precision': 0.34678442415450694, 'recall': 0.873764629155827, 'f1-score': 0.4965109152255229, 'support': 139533}, '1': {'precision': 0.364950634696756, 'recall': 0.02358060694431787, 'f1-score': 0.044298921417565494, 'support': 131676}, '2': {'precision': 0.34542658753994376, 'recall': 0.11017702505939152, 'f1-score': 0.16706660236707704, 'support': 130490}, 'accuracy': 0.3470284964612807, 'macro avg': {'precision': 0.3523872154637356, 'recall': 0.3358407537198454, 'f1-score': 0.23595881300338847, 'support': 401699}, 'weighted avg': {'precision': 0.352298179079281, 'recall': 0.3470284964612807, 'f1-score': 0.24125846281325597, 'support': 401699}}
[[121919   2830  14784]
 [116111   3105  12460]
 [113540   2573  14377]]
Evaluating performance on  val set...
492/492 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1163456
{'0': {'precision': 0.3708573690758964, 'recall': 0.5605060153428638, 'f1-score': 0.4463731121038077, 'support': 46797}, '1': {'precision': 0.2990531299316149, 'recall': 0.03157456262149403, 'f1-score': 0.05711845674670954, 'support': 36010}, '2': {'precision': 0.34670050761421317, 'recall': 0.4135249051067694, 'f1-score': 0.37717574843622226, 'support': 42943}, 'accuracy': 0.3588469184890656, 'macro avg': {'precision': 0.33887033554057483, 'recall': 0.3352018276903757, 'f1-score': 0.2935557724289132, 'support': 125750}, 'weighted avg': {'precision': 0.3420459276974897, 'recall': 0.3588469184890656, 'f1-score': 0.31127488126972236, 'support': 125750}}
[[26230  1361 19206]
 [20617  1137 14256]
 [23881  1304 17758]]
training model: results/EXC/W5/deepOF_L1/h10
Epoch 1/50
1570/1570 - 43s - loss: 3.0598 - accuracy10: 0.3898 - val_loss: 3.6261 - val_accuracy10: 0.6463 - 43s/epoch - 27ms/step
Epoch 2/50
1570/1570 - 40s - loss: 2.9690 - accuracy10: 0.4160 - val_loss: 3.5775 - val_accuracy10: 0.6412 - 40s/epoch - 25ms/step
Epoch 3/50
1570/1570 - 37s - loss: 2.9244 - accuracy10: 0.4325 - val_loss: 3.5513 - val_accuracy10: 0.6148 - 37s/epoch - 24ms/step
Epoch 4/50
1570/1570 - 39s - loss: 2.8916 - accuracy10: 0.4485 - val_loss: 3.5645 - val_accuracy10: 0.6062 - 39s/epoch - 25ms/step
Epoch 5/50
1570/1570 - 40s - loss: 2.8670 - accuracy10: 0.4582 - val_loss: 3.5941 - val_accuracy10: 0.5772 - 40s/epoch - 25ms/step
Epoch 6/50
1570/1570 - 40s - loss: 2.8426 - accuracy10: 0.4681 - val_loss: 3.5441 - val_accuracy10: 0.5641 - 40s/epoch - 26ms/step
Epoch 7/50
1570/1570 - 41s - loss: 2.8230 - accuracy10: 0.4741 - val_loss: 3.4819 - val_accuracy10: 0.5530 - 41s/epoch - 26ms/step
Epoch 8/50
1570/1570 - 40s - loss: 2.8040 - accuracy10: 0.4800 - val_loss: 3.4870 - val_accuracy10: 0.5299 - 40s/epoch - 25ms/step
Epoch 9/50
1570/1570 - 40s - loss: 2.7804 - accuracy10: 0.4890 - val_loss: 3.4527 - val_accuracy10: 0.4978 - 40s/epoch - 25ms/step
Epoch 10/50
1570/1570 - 39s - loss: 2.7629 - accuracy10: 0.4954 - val_loss: 3.5116 - val_accuracy10: 0.4988 - 39s/epoch - 25ms/step
Epoch 11/50
1570/1570 - 38s - loss: 2.7452 - accuracy10: 0.5025 - val_loss: 3.4732 - val_accuracy10: 0.4768 - 38s/epoch - 24ms/step
Epoch 12/50
1570/1570 - 40s - loss: 2.7248 - accuracy10: 0.5084 - val_loss: 3.4165 - val_accuracy10: 0.4351 - 40s/epoch - 26ms/step
Epoch 13/50
1570/1570 - 40s - loss: 2.7088 - accuracy10: 0.5143 - val_loss: 3.4955 - val_accuracy10: 0.4801 - 40s/epoch - 25ms/step
Epoch 14/50
1570/1570 - 37s - loss: 2.6915 - accuracy10: 0.5213 - val_loss: 3.4573 - val_accuracy10: 0.4425 - 37s/epoch - 24ms/step
Epoch 15/50
1570/1570 - 38s - loss: 2.6769 - accuracy10: 0.5255 - val_loss: 3.4161 - val_accuracy10: 0.4450 - 38s/epoch - 24ms/step
Epoch 16/50
1570/1570 - 39s - loss: 2.6606 - accuracy10: 0.5319 - val_loss: 3.4210 - val_accuracy10: 0.4663 - 39s/epoch - 25ms/step
Epoch 17/50
1570/1570 - 40s - loss: 2.6490 - accuracy10: 0.5359 - val_loss: 3.6249 - val_accuracy10: 0.4919 - 40s/epoch - 25ms/step
Epoch 18/50
1570/1570 - 39s - loss: 2.6356 - accuracy10: 0.5399 - val_loss: 3.4494 - val_accuracy10: 0.4629 - 39s/epoch - 25ms/step
Epoch 19/50
1570/1570 - 38s - loss: 2.6257 - accuracy10: 0.5423 - val_loss: 3.5678 - val_accuracy10: 0.4703 - 38s/epoch - 24ms/step
Epoch 20/50
1570/1570 - 41s - loss: 2.6155 - accuracy10: 0.5447 - val_loss: 3.4701 - val_accuracy10: 0.4704 - 41s/epoch - 26ms/step
Epoch 21/50
1570/1570 - 39s - loss: 2.6048 - accuracy10: 0.5479 - val_loss: 3.4033 - val_accuracy10: 0.4393 - 39s/epoch - 25ms/step
Epoch 22/50
1570/1570 - 41s - loss: 2.5935 - accuracy10: 0.5495 - val_loss: 3.4302 - val_accuracy10: 0.4352 - 41s/epoch - 26ms/step
Epoch 23/50
1570/1570 - 38s - loss: 2.5846 - accuracy10: 0.5521 - val_loss: 3.3946 - val_accuracy10: 0.4400 - 38s/epoch - 24ms/step
Epoch 24/50
1570/1570 - 37s - loss: 2.5778 - accuracy10: 0.5543 - val_loss: 3.4229 - val_accuracy10: 0.4296 - 37s/epoch - 23ms/step
Epoch 25/50
1570/1570 - 37s - loss: 2.5651 - accuracy10: 0.5576 - val_loss: 3.3814 - val_accuracy10: 0.4386 - 37s/epoch - 24ms/step
Epoch 26/50
1570/1570 - 39s - loss: 2.5588 - accuracy10: 0.5597 - val_loss: 3.4040 - val_accuracy10: 0.4396 - 39s/epoch - 25ms/step
Epoch 27/50
1570/1570 - 39s - loss: 2.5480 - accuracy10: 0.5611 - val_loss: 3.4768 - val_accuracy10: 0.4451 - 39s/epoch - 25ms/step
Epoch 28/50
1570/1570 - 40s - loss: 2.5403 - accuracy10: 0.5622 - val_loss: 3.4061 - val_accuracy10: 0.4173 - 40s/epoch - 25ms/step
Epoch 29/50
1570/1570 - 41s - loss: 2.5314 - accuracy10: 0.5634 - val_loss: 3.4293 - val_accuracy10: 0.4085 - 41s/epoch - 26ms/step
Epoch 30/50
1570/1570 - 41s - loss: 2.5243 - accuracy10: 0.5656 - val_loss: 3.5283 - val_accuracy10: 0.4610 - 41s/epoch - 26ms/step
Epoch 31/50
1570/1570 - 41s - loss: 2.5159 - accuracy10: 0.5669 - val_loss: 3.3866 - val_accuracy10: 0.4270 - 41s/epoch - 26ms/step
Epoch 32/50
1570/1570 - 41s - loss: 2.5101 - accuracy10: 0.5682 - val_loss: 3.4784 - val_accuracy10: 0.4563 - 41s/epoch - 26ms/step
Epoch 33/50
1570/1570 - 42s - loss: 2.5023 - accuracy10: 0.5680 - val_loss: 3.4097 - val_accuracy10: 0.4127 - 42s/epoch - 26ms/step
Epoch 34/50
1570/1570 - 40s - loss: 2.4954 - accuracy10: 0.5694 - val_loss: 3.5260 - val_accuracy10: 0.4506 - 40s/epoch - 25ms/step
Epoch 35/50
1570/1570 - 38s - loss: 2.4889 - accuracy10: 0.5711 - val_loss: 3.4973 - val_accuracy10: 0.4200 - 38s/epoch - 24ms/step
testing model: results/EXC/W5/deepOF_L1/h10
Evaluating performance on  test set...
7167/7167 - 98s - 98s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0452077
{'0': {'precision': 0.29049899399784973, 'recall': 0.3819058006499577, 'f1-score': 0.3299894699557161, 'support': 269556}, '1': {'precision': 0.813958198808465, 'recall': 0.41299860986938647, 'f1-score': 0.5479632244951314, 'support': 1294123}, '2': {'precision': 0.22025569447800467, 'recall': 0.6696297718236756, 'f1-score': 0.3314803444293379, 'support': 270887}, 'accuracy': 0.44632354464216606, 'macro avg': {'precision': 0.4415709624281065, 'recall': 0.4881780607810066, 'f1-score': 0.4031443462933951, 'support': 1834566}, 'weighted avg': {'precision': 0.6493809311045526, 'recall': 0.44632354464216606, 'f1-score': 0.4839706882162462, 'support': 1834566}}
[[102945  68441  98170]
 [215655 534471 543997]
 [ 35773  53720 181394]]
Evaluating performance on  train set...
1570/1570 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.974635
{'0': {'precision': 0.2865072751746683, 'recall': 0.44457927193156954, 'f1-score': 0.34845449230169556, 'support': 50270}, '1': {'precision': 0.8861440139625014, 'recall': 0.458963110667996, 'f1-score': 0.6047212236122483, 'support': 300900}, '2': {'precision': 0.22414327248462895, 'recall': 0.7445625284490095, 'f1-score': 0.34456009561446493, 'support': 50529}, 'accuracy': 0.49308810826016497, 'macro avg': {'precision': 0.46559818720726626, 'recall': 0.5493683036828584, 'f1-score': 0.43257860384280294, 'support': 401699}, 'weighted avg': {'precision': 0.7278315105084231, 'recall': 0.49308810826016497, 'f1-score': 0.5399259161318177, 'support': 401699}}
[[ 22349  10293  17628]
 [ 50200 138102 112598]
 [  5456   7451  37622]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0514776
{'0': {'precision': 0.28167726004847043, 'recall': 0.3324338909875877, 'f1-score': 0.3049580435159286, 'support': 18530}, '1': {'precision': 0.8103812606779965, 'recall': 0.4059937832237138, 'f1-score': 0.5409676160749122, 'support': 88792}, '2': {'precision': 0.21709850665858546, 'recall': 0.6997503798567397, 'f1-score': 0.3313845165435272, 'support': 18428}, 'accuracy': 0.4382027833001988, 'macro avg': {'precision': 0.4363856757950175, 'recall': 0.4793926846893471, 'f1-score': 0.39243672537812263, 'support': 125750}, 'weighted avg': {'precision': 0.64553116347931, 'recall': 0.4382027833001988, 'f1-score': 0.4754769223358876, 'support': 125750}}
[[ 6160  4870  7500]
 [13741 36049 39002]
 [ 1968  3565 12895]]
training model: results/EXC/W5/deepOF_L1/h20
Epoch 1/50
1570/1570 - 40s - loss: 3.0676 - accuracy20: 0.4128 - val_loss: 3.5066 - val_accuracy20: 0.5848 - 40s/epoch - 26ms/step
Epoch 2/50
1570/1570 - 36s - loss: 2.9760 - accuracy20: 0.4387 - val_loss: 3.4755 - val_accuracy20: 0.5600 - 36s/epoch - 23ms/step
Epoch 3/50
1570/1570 - 37s - loss: 2.9280 - accuracy20: 0.4588 - val_loss: 3.5650 - val_accuracy20: 0.5622 - 37s/epoch - 23ms/step
Epoch 4/50
1570/1570 - 37s - loss: 2.8981 - accuracy20: 0.4702 - val_loss: 3.5412 - val_accuracy20: 0.5650 - 37s/epoch - 23ms/step
Epoch 5/50
1570/1570 - 36s - loss: 2.8728 - accuracy20: 0.4816 - val_loss: 3.4786 - val_accuracy20: 0.5648 - 36s/epoch - 23ms/step
Epoch 6/50
1570/1570 - 37s - loss: 2.8513 - accuracy20: 0.4867 - val_loss: 3.4990 - val_accuracy20: 0.5638 - 37s/epoch - 24ms/step
Epoch 7/50
1570/1570 - 39s - loss: 2.8331 - accuracy20: 0.4933 - val_loss: 3.4819 - val_accuracy20: 0.5555 - 39s/epoch - 25ms/step
Epoch 8/50
1570/1570 - 38s - loss: 2.8134 - accuracy20: 0.5010 - val_loss: 3.4766 - val_accuracy20: 0.5569 - 38s/epoch - 24ms/step
Epoch 9/50
1570/1570 - 39s - loss: 2.7942 - accuracy20: 0.5077 - val_loss: 3.4591 - val_accuracy20: 0.5472 - 39s/epoch - 25ms/step
Epoch 10/50
1570/1570 - 39s - loss: 2.7779 - accuracy20: 0.5114 - val_loss: 3.4108 - val_accuracy20: 0.5054 - 39s/epoch - 25ms/step
Epoch 11/50
1570/1570 - 39s - loss: 2.7613 - accuracy20: 0.5183 - val_loss: 3.3693 - val_accuracy20: 0.4950 - 39s/epoch - 25ms/step
Epoch 12/50
1570/1570 - 39s - loss: 2.7437 - accuracy20: 0.5234 - val_loss: 3.2987 - val_accuracy20: 0.4577 - 39s/epoch - 25ms/step
Epoch 13/50
1570/1570 - 38s - loss: 2.7285 - accuracy20: 0.5276 - val_loss: 3.2910 - val_accuracy20: 0.4605 - 38s/epoch - 24ms/step
Epoch 14/50
1570/1570 - 36s - loss: 2.7182 - accuracy20: 0.5315 - val_loss: 3.2808 - val_accuracy20: 0.4299 - 36s/epoch - 23ms/step
Epoch 15/50
1570/1570 - 37s - loss: 2.7053 - accuracy20: 0.5337 - val_loss: 3.2709 - val_accuracy20: 0.4667 - 37s/epoch - 24ms/step
Epoch 16/50
1570/1570 - 38s - loss: 2.6926 - accuracy20: 0.5395 - val_loss: 3.2886 - val_accuracy20: 0.4419 - 38s/epoch - 24ms/step
Epoch 17/50
1570/1570 - 35s - loss: 2.6799 - accuracy20: 0.5438 - val_loss: 3.2755 - val_accuracy20: 0.4227 - 35s/epoch - 22ms/step
Epoch 18/50
1570/1570 - 37s - loss: 2.6707 - accuracy20: 0.5447 - val_loss: 3.2714 - val_accuracy20: 0.4167 - 37s/epoch - 24ms/step
Epoch 19/50
1570/1570 - 39s - loss: 2.6604 - accuracy20: 0.5486 - val_loss: 3.2766 - val_accuracy20: 0.4217 - 39s/epoch - 25ms/step
Epoch 20/50
1570/1570 - 39s - loss: 2.6506 - accuracy20: 0.5505 - val_loss: 3.2545 - val_accuracy20: 0.4128 - 39s/epoch - 25ms/step
Epoch 21/50
1570/1570 - 39s - loss: 2.6409 - accuracy20: 0.5536 - val_loss: 3.2811 - val_accuracy20: 0.4203 - 39s/epoch - 25ms/step
Epoch 22/50
1570/1570 - 36s - loss: 2.6351 - accuracy20: 0.5547 - val_loss: 3.2510 - val_accuracy20: 0.4012 - 36s/epoch - 23ms/step
Epoch 23/50
1570/1570 - 36s - loss: 2.6286 - accuracy20: 0.5579 - val_loss: 3.2653 - val_accuracy20: 0.4193 - 36s/epoch - 23ms/step
Epoch 24/50
1570/1570 - 37s - loss: 2.6197 - accuracy20: 0.5589 - val_loss: 3.3125 - val_accuracy20: 0.4125 - 37s/epoch - 23ms/step
Epoch 25/50
1570/1570 - 37s - loss: 2.6105 - accuracy20: 0.5619 - val_loss: 3.2800 - val_accuracy20: 0.4132 - 37s/epoch - 24ms/step
Epoch 26/50
1570/1570 - 37s - loss: 2.6044 - accuracy20: 0.5634 - val_loss: 3.2854 - val_accuracy20: 0.4298 - 37s/epoch - 23ms/step
Epoch 27/50
1570/1570 - 37s - loss: 2.5968 - accuracy20: 0.5651 - val_loss: 3.2655 - val_accuracy20: 0.4259 - 37s/epoch - 23ms/step
Epoch 28/50
1570/1570 - 38s - loss: 2.5885 - accuracy20: 0.5669 - val_loss: 3.2827 - val_accuracy20: 0.4257 - 38s/epoch - 24ms/step
Epoch 29/50
1570/1570 - 38s - loss: 2.5818 - accuracy20: 0.5690 - val_loss: 3.2722 - val_accuracy20: 0.4356 - 38s/epoch - 24ms/step
Epoch 30/50
1570/1570 - 37s - loss: 2.5752 - accuracy20: 0.5687 - val_loss: 3.3009 - val_accuracy20: 0.4153 - 37s/epoch - 24ms/step
Epoch 31/50
1570/1570 - 38s - loss: 2.5681 - accuracy20: 0.5704 - val_loss: 3.2854 - val_accuracy20: 0.4296 - 38s/epoch - 24ms/step
Epoch 32/50
1570/1570 - 39s - loss: 2.5608 - accuracy20: 0.5724 - val_loss: 3.3234 - val_accuracy20: 0.4245 - 39s/epoch - 25ms/step
testing model: results/EXC/W5/deepOF_L1/h20
Evaluating performance on  test set...
7167/7167 - 118s - 118s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0899675
{'0': {'precision': 0.3518064966872453, 'recall': 0.3791591905970872, 'f1-score': 0.3649710755269589, 'support': 357251}, '1': {'precision': 0.7458438354419719, 'recall': 0.32490530209816365, 'f1-score': 0.4526337835378244, 'support': 1117501}, '2': {'precision': 0.2678658235105928, 'recall': 0.7167119678500559, 'f1-score': 0.38997963019811793, 'support': 359814}, 'accuracy': 0.4123155013229287, 'macro avg': {'precision': 0.4551720518799367, 'recall': 0.47359215351510225, 'f1-score': 0.4025281630876338, 'support': 1834566}, 'weighted avg': {'precision': 0.5753656876443227, 'recall': 0.4123155013229287, 'f1-score': 0.4232745609045897, 'support': 1834566}}
[[135455  66961 154835]
 [204405 363082 550014]
 [ 45167  56764 257883]]
Evaluating performance on  train set...
1570/1570 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0268376
{'0': {'precision': 0.35254619802024445, 'recall': 0.46375086342459915, 'f1-score': 0.40057378974160424, 'support': 68043}, '1': {'precision': 0.8391963114787901, 'recall': 0.3832520962188957, 'f1-score': 0.5261960234692373, 'support': 265478}, '2': {'precision': 0.27136662616783275, 'recall': 0.7600398955674851, 'f1-score': 0.3999382549299579, 'support': 68178}, 'accuracy': 0.46083759232659277, 'macro avg': {'precision': 0.4877030452222891, 'recall': 0.5356809517369934, 'f1-score': 0.4422360227135998, 'support': 401699}, 'weighted avg': {'precision': 0.6603892296707938, 'recall': 0.46083759232659277, 'f1-score': 0.48348813573986704, 'support': 401699}}
[[ 31555  10412  26076]
 [ 50675 101745 113058]
 [  7276   9084  51818]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1007686
{'0': {'precision': 0.34870061951886716, 'recall': 0.3585818888842924, 'f1-score': 0.35357222981379133, 'support': 24173}, '1': {'precision': 0.7676522863144288, 'recall': 0.306437048503612, 'f1-score': 0.4380214815839211, 'support': 77520}, '2': {'precision': 0.261011909016827, 'recall': 0.758905931745438, 'f1-score': 0.3884302795625718, 'support': 24057}, 'accuracy': 0.40302186878727636, 'macro avg': {'precision': 0.459121604950041, 'recall': 0.4746416230444474, 'f1-score': 0.3933413303200948, 'support': 125750}, 'weighted avg': {'precision': 0.5901925153554028, 'recall': 0.40302186878727636, 'f1-score': 0.41230054870068494, 'support': 125750}}
[[ 8668  3969 11536]
 [13611 23755 40154]
 [ 2579  3221 18257]]
training model: results/EXC/W5/deepOF_L1/h30
Epoch 1/50
1570/1570 - 39s - loss: 3.0887 - accuracy30: 0.4164 - val_loss: 3.4762 - val_accuracy30: 0.5402 - 39s/epoch - 25ms/step
Epoch 2/50
1570/1570 - 38s - loss: 3.0004 - accuracy30: 0.4437 - val_loss: 3.4721 - val_accuracy30: 0.5216 - 38s/epoch - 24ms/step
Epoch 3/50
1570/1570 - 37s - loss: 2.9520 - accuracy30: 0.4645 - val_loss: 3.4987 - val_accuracy30: 0.5213 - 37s/epoch - 24ms/step
Epoch 4/50
1570/1570 - 37s - loss: 2.9223 - accuracy30: 0.4788 - val_loss: 3.5236 - val_accuracy30: 0.5240 - 37s/epoch - 23ms/step
Epoch 5/50
1570/1570 - 37s - loss: 2.9023 - accuracy30: 0.4856 - val_loss: 3.5163 - val_accuracy30: 0.5356 - 37s/epoch - 24ms/step
Epoch 6/50
1570/1570 - 37s - loss: 2.8862 - accuracy30: 0.4915 - val_loss: 3.5015 - val_accuracy30: 0.5375 - 37s/epoch - 24ms/step
Epoch 7/50
1570/1570 - 35s - loss: 2.8702 - accuracy30: 0.4960 - val_loss: 3.5533 - val_accuracy30: 0.5339 - 35s/epoch - 22ms/step
Epoch 8/50
1570/1570 - 38s - loss: 2.8552 - accuracy30: 0.5005 - val_loss: 3.5141 - val_accuracy30: 0.5344 - 38s/epoch - 24ms/step
Epoch 9/50
1570/1570 - 39s - loss: 2.8394 - accuracy30: 0.5064 - val_loss: 3.5127 - val_accuracy30: 0.5290 - 39s/epoch - 25ms/step
Epoch 10/50
1570/1570 - 39s - loss: 2.8252 - accuracy30: 0.5119 - val_loss: 3.4396 - val_accuracy30: 0.5049 - 39s/epoch - 25ms/step
Epoch 11/50
1570/1570 - 39s - loss: 2.8112 - accuracy30: 0.5172 - val_loss: 3.4054 - val_accuracy30: 0.4851 - 39s/epoch - 25ms/step
Epoch 12/50
1570/1570 - 38s - loss: 2.7972 - accuracy30: 0.5225 - val_loss: 3.3413 - val_accuracy30: 0.4629 - 38s/epoch - 24ms/step
Epoch 13/50
1570/1570 - 37s - loss: 2.7857 - accuracy30: 0.5265 - val_loss: 3.2928 - val_accuracy30: 0.4249 - 37s/epoch - 23ms/step
Epoch 14/50
1570/1570 - 39s - loss: 2.7720 - accuracy30: 0.5309 - val_loss: 3.2646 - val_accuracy30: 0.4069 - 39s/epoch - 25ms/step
Epoch 15/50
1570/1570 - 39s - loss: 2.7617 - accuracy30: 0.5331 - val_loss: 3.2618 - val_accuracy30: 0.4004 - 39s/epoch - 25ms/step
Epoch 16/50
1570/1570 - 40s - loss: 2.7483 - accuracy30: 0.5378 - val_loss: 3.2479 - val_accuracy30: 0.3969 - 40s/epoch - 25ms/step
Epoch 17/50
1570/1570 - 37s - loss: 2.7383 - accuracy30: 0.5396 - val_loss: 3.2591 - val_accuracy30: 0.3856 - 37s/epoch - 23ms/step
Epoch 18/50
1570/1570 - 38s - loss: 2.7296 - accuracy30: 0.5426 - val_loss: 3.2510 - val_accuracy30: 0.4008 - 38s/epoch - 24ms/step
Epoch 19/50
1570/1570 - 38s - loss: 2.7209 - accuracy30: 0.5445 - val_loss: 3.2576 - val_accuracy30: 0.3930 - 38s/epoch - 24ms/step
Epoch 20/50
1570/1570 - 38s - loss: 2.7119 - accuracy30: 0.5468 - val_loss: 3.2164 - val_accuracy30: 0.4143 - 38s/epoch - 24ms/step
Epoch 21/50
1570/1570 - 36s - loss: 2.7051 - accuracy30: 0.5491 - val_loss: 3.2253 - val_accuracy30: 0.4207 - 36s/epoch - 23ms/step
Epoch 22/50
1570/1570 - 32s - loss: 2.6969 - accuracy30: 0.5507 - val_loss: 3.2385 - val_accuracy30: 0.4122 - 32s/epoch - 21ms/step
Epoch 23/50
1570/1570 - 36s - loss: 2.6893 - accuracy30: 0.5519 - val_loss: 3.2383 - val_accuracy30: 0.4029 - 36s/epoch - 23ms/step
Epoch 24/50
1570/1570 - 39s - loss: 2.6814 - accuracy30: 0.5540 - val_loss: 3.2406 - val_accuracy30: 0.4125 - 39s/epoch - 25ms/step
Epoch 25/50
1570/1570 - 40s - loss: 2.6734 - accuracy30: 0.5558 - val_loss: 3.2163 - val_accuracy30: 0.4215 - 40s/epoch - 25ms/step
Epoch 26/50
1570/1570 - 39s - loss: 2.6676 - accuracy30: 0.5581 - val_loss: 3.2214 - val_accuracy30: 0.4139 - 39s/epoch - 25ms/step
Epoch 27/50
1570/1570 - 38s - loss: 2.6600 - accuracy30: 0.5593 - val_loss: 3.2365 - val_accuracy30: 0.4184 - 38s/epoch - 24ms/step
Epoch 28/50
1570/1570 - 37s - loss: 2.6530 - accuracy30: 0.5613 - val_loss: 3.2145 - val_accuracy30: 0.4197 - 37s/epoch - 24ms/step
Epoch 29/50
1570/1570 - 38s - loss: 2.6488 - accuracy30: 0.5620 - val_loss: 3.2420 - val_accuracy30: 0.4206 - 38s/epoch - 24ms/step
Epoch 30/50
1570/1570 - 39s - loss: 2.6397 - accuracy30: 0.5645 - val_loss: 3.2126 - val_accuracy30: 0.4255 - 39s/epoch - 25ms/step
Epoch 31/50
1570/1570 - 38s - loss: 2.6319 - accuracy30: 0.5655 - val_loss: 3.2469 - val_accuracy30: 0.4358 - 38s/epoch - 24ms/step
Epoch 32/50
1570/1570 - 37s - loss: 2.6257 - accuracy30: 0.5676 - val_loss: 3.2430 - val_accuracy30: 0.4228 - 37s/epoch - 24ms/step
Epoch 33/50
1570/1570 - 38s - loss: 2.6197 - accuracy30: 0.5680 - val_loss: 3.2135 - val_accuracy30: 0.4177 - 38s/epoch - 24ms/step
Epoch 34/50
1570/1570 - 37s - loss: 2.6137 - accuracy30: 0.5699 - val_loss: 3.2087 - val_accuracy30: 0.4377 - 37s/epoch - 24ms/step
Epoch 35/50
1570/1570 - 37s - loss: 2.6091 - accuracy30: 0.5701 - val_loss: 3.2303 - val_accuracy30: 0.4236 - 37s/epoch - 24ms/step
Epoch 36/50
1570/1570 - 39s - loss: 2.6026 - accuracy30: 0.5715 - val_loss: 3.2297 - val_accuracy30: 0.4244 - 39s/epoch - 25ms/step
Epoch 37/50
1570/1570 - 39s - loss: 2.5959 - accuracy30: 0.5738 - val_loss: 3.2384 - val_accuracy30: 0.4228 - 39s/epoch - 25ms/step
Epoch 38/50
1570/1570 - 37s - loss: 2.5906 - accuracy30: 0.5742 - val_loss: 3.2075 - val_accuracy30: 0.4282 - 37s/epoch - 23ms/step
Epoch 39/50
1570/1570 - 38s - loss: 2.5869 - accuracy30: 0.5752 - val_loss: 3.2122 - val_accuracy30: 0.4285 - 38s/epoch - 24ms/step
Epoch 40/50
1570/1570 - 39s - loss: 2.5810 - accuracy30: 0.5764 - val_loss: 3.2428 - val_accuracy30: 0.4293 - 39s/epoch - 25ms/step
Epoch 41/50
1570/1570 - 40s - loss: 2.5740 - accuracy30: 0.5777 - val_loss: 3.2310 - val_accuracy30: 0.4313 - 40s/epoch - 26ms/step
Epoch 42/50
1570/1570 - 40s - loss: 2.5698 - accuracy30: 0.5786 - val_loss: 3.2290 - val_accuracy30: 0.4103 - 40s/epoch - 26ms/step
Epoch 43/50
1570/1570 - 38s - loss: 2.5634 - accuracy30: 0.5786 - val_loss: 3.2069 - val_accuracy30: 0.4171 - 38s/epoch - 24ms/step
Epoch 44/50
1570/1570 - 36s - loss: 2.5564 - accuracy30: 0.5806 - val_loss: 3.2452 - val_accuracy30: 0.4253 - 36s/epoch - 23ms/step
Epoch 45/50
1570/1570 - 36s - loss: 2.5520 - accuracy30: 0.5812 - val_loss: 3.2127 - val_accuracy30: 0.4420 - 36s/epoch - 23ms/step
Epoch 46/50
1570/1570 - 37s - loss: 2.5454 - accuracy30: 0.5827 - val_loss: 3.2023 - val_accuracy30: 0.4220 - 37s/epoch - 24ms/step
Epoch 47/50
1570/1570 - 36s - loss: 2.5422 - accuracy30: 0.5825 - val_loss: 3.2122 - val_accuracy30: 0.4300 - 36s/epoch - 23ms/step
Epoch 48/50
1570/1570 - 36s - loss: 2.5353 - accuracy30: 0.5846 - val_loss: 3.2277 - val_accuracy30: 0.4292 - 36s/epoch - 23ms/step
Epoch 49/50
1570/1570 - 38s - loss: 2.5302 - accuracy30: 0.5844 - val_loss: 3.2360 - val_accuracy30: 0.4227 - 38s/epoch - 24ms/step
Epoch 50/50
1570/1570 - 37s - loss: 2.5235 - accuracy30: 0.5870 - val_loss: 3.2517 - val_accuracy30: 0.4121 - 37s/epoch - 24ms/step
testing model: results/EXC/W5/deepOF_L1/h30
Evaluating performance on  test set...
7167/7167 - 108s - 108s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0916882
{'0': {'precision': 0.3881950916433675, 'recall': 0.3707879838106655, 'f1-score': 0.3792919236559662, 'support': 421265}, '1': {'precision': 0.6835939275262949, 'recall': 0.3495019497706746, 'f1-score': 0.4625270815075667, 'support': 989860}, '2': {'precision': 0.31355981617615303, 'recall': 0.6857838518235126, 'f1-score': 0.4303509701417885, 'support': 423441}, 'accuracy': 0.4320078972356405, 'macro avg': {'precision': 0.4617829451152718, 'recall': 0.46869126180161763, 'f1-score': 0.42405665843510715, 'support': 1834566}, 'weighted avg': {'precision': 0.5303539760923116, 'recall': 0.4320078972356405, 'f1-score': 0.4359874293254207, 'support': 1834566}}
[[156200  89516 175549]
 [183736 345958 460166]
 [ 62439  70613 290389]]
Evaluating performance on  train set...
1570/1570 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0083947
{'0': {'precision': 0.3967820150158453, 'recall': 0.46209578539316104, 'f1-score': 0.42695549185533566, 'support': 80743}, '1': {'precision': 0.7866598738096171, 'recall': 0.41822651887657303, 'f1-score': 0.546112932406513, 'support': 239980}, '2': {'precision': 0.3215792980897379, 'recall': 0.7151501679509978, 'f1-score': 0.4436595979406717, 'support': 80976}, 'accuracy': 0.48689939482049993, 'macro avg': {'precision': 0.5016737289717333, 'recall': 0.5318241574069106, 'f1-score': 0.4722426740675068, 'support': 401699}, 'weighted avg': {'precision': 0.6145402701957707, 'recall': 0.48689939482049993, 'f1-score': 0.5015089118982975, 'support': 401699}}
[[ 37311  14663  28769]
 [ 46213 100366  93401]
 [ 10510  12556  57910]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0933656
{'0': {'precision': 0.37027568575969044, 'recall': 0.3814913685709201, 'f1-score': 0.37579986325625425, 'support': 28095}, '1': {'precision': 0.7424623970598244, 'recall': 0.31291951121565026, 'f1-score': 0.44027847845827867, 'support': 69724}, '2': {'precision': 0.3051262274170103, 'recall': 0.7364935018438294, 'f1-score': 0.43148853160494605, 'support': 27931}, 'accuracy': 0.4223220675944334, 'macro avg': {'precision': 0.4726214367455084, 'recall': 0.4769681272101332, 'f1-score': 0.4158556244398263, 'support': 125750}, 'weighted avg': {'precision': 0.5621695763181092, 'recall': 0.4223220675944334, 'f1-score': 0.4239203178247891, 'support': 125750}}
[[10718  4351 13026]
 [14085 21818 33821]
 [ 4143  3217 20571]]
training model: results/EXC/W5/deepOF_L1/h50
Epoch 1/50
1570/1570 - 41s - loss: 3.1497 - accuracy50: 0.4202 - val_loss: 3.4292 - val_accuracy50: 0.4731 - 41s/epoch - 26ms/step
Epoch 2/50
1570/1570 - 39s - loss: 3.0761 - accuracy50: 0.4422 - val_loss: 3.3794 - val_accuracy50: 0.4762 - 39s/epoch - 25ms/step
Epoch 3/50
1570/1570 - 38s - loss: 3.0400 - accuracy50: 0.4574 - val_loss: 3.4033 - val_accuracy50: 0.4762 - 38s/epoch - 25ms/step
Epoch 4/50
1570/1570 - 40s - loss: 3.0157 - accuracy50: 0.4683 - val_loss: 3.4585 - val_accuracy50: 0.4765 - 40s/epoch - 26ms/step
Epoch 5/50
1570/1570 - 39s - loss: 2.9949 - accuracy50: 0.4780 - val_loss: 3.4648 - val_accuracy50: 0.4795 - 39s/epoch - 25ms/step
Epoch 6/50
1570/1570 - 40s - loss: 2.9773 - accuracy50: 0.4837 - val_loss: 3.5004 - val_accuracy50: 0.4796 - 40s/epoch - 26ms/step
Epoch 7/50
1570/1570 - 40s - loss: 2.9614 - accuracy50: 0.4900 - val_loss: 3.5075 - val_accuracy50: 0.4803 - 40s/epoch - 25ms/step
Epoch 8/50
1570/1570 - 40s - loss: 2.9490 - accuracy50: 0.4942 - val_loss: 3.5037 - val_accuracy50: 0.4805 - 40s/epoch - 26ms/step
Epoch 9/50
1570/1570 - 37s - loss: 2.9355 - accuracy50: 0.4989 - val_loss: 3.4915 - val_accuracy50: 0.4836 - 37s/epoch - 23ms/step
Epoch 10/50
1570/1570 - 40s - loss: 2.9261 - accuracy50: 0.5010 - val_loss: 3.5095 - val_accuracy50: 0.4803 - 40s/epoch - 25ms/step
Epoch 11/50
1570/1570 - 40s - loss: 2.9171 - accuracy50: 0.5038 - val_loss: 3.4937 - val_accuracy50: 0.4824 - 40s/epoch - 25ms/step
Epoch 12/50
1570/1570 - 39s - loss: 2.9056 - accuracy50: 0.5075 - val_loss: 3.4602 - val_accuracy50: 0.4829 - 39s/epoch - 25ms/step
testing model: results/EXC/W5/deepOF_L1/h50
Evaluating performance on  test set...
7167/7167 - 113s - 113s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0549957
{'0': {'precision': 0.454554270143421, 'recall': 0.18116292102262846, 'f1-score': 0.2590723689301071, 'support': 517490}, '1': {'precision': 0.45249501724256425, 'recall': 0.7009279658522595, 'f1-score': 0.5499568096746328, 'support': 798413}, '2': {'precision': 0.42231870363039675, 'recall': 0.31882166262100825, 'f1-score': 0.3633437264479499, 'support': 518663}, 'accuracy': 0.44628593356684904, 'macro avg': {'precision': 0.4431226636721273, 'recall': 0.4003041831652987, 'f1-score': 0.3907909683508966, 'support': 1834566}, 'weighted avg': {'precision': 0.44454452946324025, 'recall': 0.44628593356684904, 'f1-score': 0.4151461292049819, 'support': 1834566}}
[[ 93750 356049  67691]
 [ 80280 559630 158503]
 [ 32216 321086 165361]]
Evaluating performance on  train set...
1570/1570 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0036203
{'0': {'precision': 0.479036007192667, 'recall': 0.2166281571979651, 'f1-score': 0.2983413341709744, 'support': 100841}, '1': {'precision': 0.5371708285627328, 'recall': 0.7391488597951918, 'f1-score': 0.6221782975991137, 'support': 200578}, '2': {'precision': 0.44612426811150924, 'recall': 0.3563522138013562, 'f1-score': 0.3962168964580527, 'support': 100280}, 'accuracy': 0.5124160129848468, 'macro avg': {'precision': 0.48744370128896963, 'recall': 0.4373764102648377, 'f1-score': 0.438912176076047, 'support': 401699}, 'weighted avg': {'precision': 0.4998480505527614, 'recall': 0.5124160129848468, 'f1-score': 0.4844745628736536, 'support': 401699}}
[[ 21845  67997  10999]
 [ 18954 148257  33367]
 [  4803  59742  35735]]
Evaluating performance on  val set...
492/492 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.037671
{'0': {'precision': 0.4730971128608924, 'recall': 0.1267320931595137, 'f1-score': 0.19991219760160817, 'support': 34135}, '1': {'precision': 0.4837730038388742, 'recall': 0.7801921120251091, 'f1-score': 0.5972251557714648, 'support': 57987}, '2': {'precision': 0.4497812811295422, 'recall': 0.30882003092660876, 'f1-score': 0.36620413632596927, 'support': 33628}, 'accuracy': 0.4767554671968191, 'macro avg': {'precision': 0.46888379927643625, 'recall': 0.40524807870374385, 'f1-score': 0.3877804965663474, 'support': 125750}, 'weighted avg': {'precision': 0.47178497052036267, 'recall': 0.4767554671968191, 'f1-score': 0.4275945182442984, 'support': 125750}}
[[ 4326 26196  3613]
 [ 3655 45241  9091]
 [ 1163 22080 10385]]
training model: results/EXC/W5/deepOF_L1/h100
Epoch 1/50
1570/1570 - 41s - loss: 3.2373 - accuracy100: 0.4087 - val_loss: 3.3932 - val_accuracy100: 0.3485 - 41s/epoch - 26ms/step
Epoch 2/50
1570/1570 - 40s - loss: 3.1941 - accuracy100: 0.4259 - val_loss: 3.3503 - val_accuracy100: 0.3682 - 40s/epoch - 26ms/step
Epoch 3/50
1570/1570 - 40s - loss: 3.1730 - accuracy100: 0.4361 - val_loss: 3.3564 - val_accuracy100: 0.3733 - 40s/epoch - 25ms/step
Epoch 4/50
1570/1570 - 40s - loss: 3.1569 - accuracy100: 0.4438 - val_loss: 3.3854 - val_accuracy100: 0.3687 - 40s/epoch - 25ms/step
Epoch 5/50
1570/1570 - 39s - loss: 3.1433 - accuracy100: 0.4499 - val_loss: 3.3800 - val_accuracy100: 0.3715 - 39s/epoch - 25ms/step
Epoch 6/50
1570/1570 - 40s - loss: 3.1332 - accuracy100: 0.4550 - val_loss: 3.4070 - val_accuracy100: 0.3715 - 40s/epoch - 26ms/step
Epoch 7/50
1570/1570 - 39s - loss: 3.1241 - accuracy100: 0.4588 - val_loss: 3.4166 - val_accuracy100: 0.3716 - 39s/epoch - 25ms/step
Epoch 8/50
1570/1570 - 40s - loss: 3.1166 - accuracy100: 0.4617 - val_loss: 3.4137 - val_accuracy100: 0.3719 - 40s/epoch - 25ms/step
Epoch 9/50
1570/1570 - 39s - loss: 3.1099 - accuracy100: 0.4640 - val_loss: 3.4240 - val_accuracy100: 0.3733 - 39s/epoch - 25ms/step
Epoch 10/50
1570/1570 - 40s - loss: 3.1041 - accuracy100: 0.4665 - val_loss: 3.4255 - val_accuracy100: 0.3733 - 40s/epoch - 26ms/step
Epoch 11/50
1570/1570 - 40s - loss: 3.1005 - accuracy100: 0.4680 - val_loss: 3.4337 - val_accuracy100: 0.3737 - 40s/epoch - 25ms/step
Epoch 12/50
1570/1570 - 40s - loss: 3.0932 - accuracy100: 0.4704 - val_loss: 3.4320 - val_accuracy100: 0.3734 - 40s/epoch - 26ms/step
testing model: results/EXC/W5/deepOF_L1/h100
Evaluating performance on  test set...
7167/7167 - 112s - 112s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1223286
{'0': {'precision': 0.4727427160493827, 'recall': 0.1852273800254786, 'f1-score': 0.26616679159836204, 'support': 646033}, '1': {'precision': 0.29527104175215, 'recall': 0.7356507725529547, 'f1-score': 0.42140221879755274, 'support': 531161}, '2': {'precision': 0.4869887323507075, 'recall': 0.19119159319228687, 'f1-score': 0.27458228467561524, 'support': 657372}, 'accuracy': 0.3467283270266646, 'macro avg': {'precision': 0.4183341633840801, 'recall': 0.37068991525690675, 'f1-score': 0.3207170983571767, 'support': 1834566}, 'weighted avg': {'precision': 0.4264641413001734, 'recall': 0.3467283270266646, 'f1-score': 0.3141275159668118, 'support': 1834566}}
[[119663 463313  63057]
 [ 71069 390749  69343]
 [ 62393 469295 125684]]
Evaluating performance on  train set...
1570/1570 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.084882
{'0': {'precision': 0.4939474896361124, 'recall': 0.2030830997651693, 'f1-score': 0.2878277907507314, 'support': 132010}, '1': {'precision': 0.3680881521816379, 'recall': 0.7743060746499227, 'f1-score': 0.49897467187206107, 'support': 140469}, '2': {'precision': 0.509309714065659, 'recall': 0.20469741526079555, 'f1-score': 0.2920261654384367, 'support': 129220}, 'accuracy': 0.4033517633850221, 'macro avg': {'precision': 0.4571151186278031, 'recall': 0.3940288632252959, 'f1-score': 0.3596095426870764, 'support': 401699}, 'weighted avg': {'precision': 0.4548778662810466, 'recall': 0.4033517633850221, 'f1-score': 0.36301370164764013, 'support': 401699}}
[[ 26809  94823  10378]
 [ 16597 108766  15106]
 [ 10869  91900  26451]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1091998
{'0': {'precision': 0.4960594256726153, 'recall': 0.1273103480343152, 'f1-score': 0.20261969954858286, 'support': 43013}, '1': {'precision': 0.3356791689794624, 'recall': 0.8269075814918814, 'f1-score': 0.47751387097001613, 'support': 40955}, '2': {'precision': 0.5043767633654055, 'recall': 0.16686611459480158, 'f1-score': 0.25076881575397897, 'support': 41782}, 'accuracy': 0.3683021868787276, 'macro avg': {'precision': 0.4453717860058277, 'recall': 0.37369468137366607, 'f1-score': 0.3103007954241927, 'support': 125750}, 'weighted avg': {'precision': 0.4465893786794708, 'recall': 0.3683021868787276, 'f1-score': 0.3081469930981547, 'support': 125750}}
[[ 5476 34536  3001]
 [ 3239 33866  3850]
 [ 2324 32486  6972]]
training model: results/EXC/W5/deepOF_L1/h200
Epoch 1/50
1570/1570 - 43s - loss: 3.2761 - accuracy200: 0.3828 - val_loss: 3.3351 - val_accuracy200: 0.3290 - 43s/epoch - 27ms/step
Epoch 2/50
1570/1570 - 40s - loss: 3.2509 - accuracy200: 0.3929 - val_loss: 3.2853 - val_accuracy200: 0.3645 - 40s/epoch - 25ms/step
Epoch 3/50
1570/1570 - 41s - loss: 3.2425 - accuracy200: 0.3957 - val_loss: 3.2773 - val_accuracy200: 0.3788 - 41s/epoch - 26ms/step
Epoch 4/50
1570/1570 - 41s - loss: 3.2356 - accuracy200: 0.4002 - val_loss: 3.2797 - val_accuracy200: 0.3800 - 41s/epoch - 26ms/step
Epoch 5/50
1570/1570 - 39s - loss: 3.2307 - accuracy200: 0.4021 - val_loss: 3.2805 - val_accuracy200: 0.3831 - 39s/epoch - 25ms/step
Epoch 6/50
1570/1570 - 40s - loss: 3.2263 - accuracy200: 0.4050 - val_loss: 3.2865 - val_accuracy200: 0.3805 - 40s/epoch - 26ms/step
Epoch 7/50
1570/1570 - 41s - loss: 3.2241 - accuracy200: 0.4067 - val_loss: 3.2900 - val_accuracy200: 0.3816 - 41s/epoch - 26ms/step
Epoch 8/50
1570/1570 - 41s - loss: 3.2207 - accuracy200: 0.4083 - val_loss: 3.2942 - val_accuracy200: 0.3794 - 41s/epoch - 26ms/step
Epoch 9/50
1570/1570 - 42s - loss: 3.2176 - accuracy200: 0.4107 - val_loss: 3.2948 - val_accuracy200: 0.3783 - 42s/epoch - 27ms/step
Epoch 10/50
1570/1570 - 42s - loss: 3.2145 - accuracy200: 0.4123 - val_loss: 3.2958 - val_accuracy200: 0.3778 - 42s/epoch - 27ms/step
Epoch 11/50
1570/1570 - 42s - loss: 3.2119 - accuracy200: 0.4132 - val_loss: 3.2941 - val_accuracy200: 0.3782 - 42s/epoch - 27ms/step
Epoch 12/50
1570/1570 - 41s - loss: 3.2090 - accuracy200: 0.4140 - val_loss: 3.2987 - val_accuracy200: 0.3761 - 41s/epoch - 26ms/step
Epoch 13/50
1570/1570 - 40s - loss: 3.2064 - accuracy200: 0.4157 - val_loss: 3.3020 - val_accuracy200: 0.3742 - 40s/epoch - 26ms/step
testing model: results/EXC/W5/deepOF_L1/h200
Evaluating performance on  test set...
7167/7167 - 118s - 118s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0962
{'0': {'precision': 0.41267921202184443, 'recall': 0.4106555240358813, 'f1-score': 0.4116648810008746, 'support': 652150}, '1': {'precision': 0.27180188822393275, 'recall': 0.21243856598691419, 'f1-score': 0.2384815348024858, 'support': 497485}, '2': {'precision': 0.422403590438049, 'recall': 0.4913838036240147, 'f1-score': 0.4542900991689354, 'support': 684931}, 'accuracy': 0.38704412923819587, 'macro avg': {'precision': 0.36896156356127535, 'recall': 0.37149263121560344, 'f1-score': 0.3681455049907653, 'support': 1834566}, 'weighted avg': {'precision': 0.37810764185396023, 'recall': 0.38704412923819587, 'f1-score': 0.3806162386089207, 'support': 1834566}}
[[267809 139885 244456]
 [176037 105685 215763]
 [205106 143261 336564]]
Evaluating performance on  train set...
1570/1570 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0876607
{'0': {'precision': 0.3987227107072657, 'recall': 0.42150838195384194, 'f1-score': 0.40979905819763474, 'support': 135231}, '1': {'precision': 0.3369330973621796, 'recall': 0.2057869774624067, 'f1-score': 0.25551457161639035, 'support': 135995}, '2': {'precision': 0.38531640093579766, 'recall': 0.518819985744177, 'f1-score': 0.44221171182941804, 'support': 130473}, 'accuracy': 0.3800830970453001, 'macro avg': {'precision': 0.37365740300174766, 'recall': 0.3820384483868085, 'f1-score': 0.3691751138811477, 'support': 401699}, 'weighted avg': {'precision': 0.3734494590395301, 'recall': 0.3800830970453001, 'f1-score': 0.36809384460408173, 'support': 401699}}
[[57001 29366 48864]
 [48886 27986 59123]
 [37072 25709 67692]]
Evaluating performance on  val set...
492/492 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0923116
{'0': {'precision': 0.41952435852749553, 'recall': 0.34726352700963203, 'f1-score': 0.3799890717017789, 'support': 45058}, '1': {'precision': 0.3042572379264235, 'recall': 0.25718942221754904, 'f1-score': 0.27875040954999364, 'support': 38042}, '2': {'precision': 0.3926921983799915, 'recall': 0.518335287221571, 'f1-score': 0.4468497968588927, 'support': 42650}, 'accuracy': 0.37803578528827037, 'macro avg': {'precision': 0.3721579316113035, 'recall': 0.3742627454829173, 'f1-score': 0.36852975937022175, 'support': 125750}, 'weighted avg': {'precision': 0.3755531185100241, 'recall': 0.37803578528827037, 'f1-score': 0.3720390815814822, 'support': 125750}}
[[15647 12151 17260]
 [11329  9784 16929]
 [10321 10222 22107]]
training model: results/EXC/W5/deepOF_L1/h300
Epoch 1/50
1570/1570 - 42s - loss: 3.2992 - accuracy300: 0.3650 - val_loss: 3.3630 - val_accuracy300: 0.3226 - 42s/epoch - 27ms/step
Epoch 2/50
1570/1570 - 41s - loss: 3.2764 - accuracy300: 0.3728 - val_loss: 3.3156 - val_accuracy300: 0.3247 - 41s/epoch - 26ms/step
Epoch 3/50
1570/1570 - 41s - loss: 3.2700 - accuracy300: 0.3756 - val_loss: 3.2955 - val_accuracy300: 0.3362 - 41s/epoch - 26ms/step
Epoch 4/50
1570/1570 - 38s - loss: 3.2651 - accuracy300: 0.3799 - val_loss: 3.2905 - val_accuracy300: 0.3442 - 38s/epoch - 24ms/step
Epoch 5/50
1570/1570 - 40s - loss: 3.2621 - accuracy300: 0.3810 - val_loss: 3.2887 - val_accuracy300: 0.3495 - 40s/epoch - 25ms/step
Epoch 6/50
1570/1570 - 41s - loss: 3.2586 - accuracy300: 0.3844 - val_loss: 3.2910 - val_accuracy300: 0.3558 - 41s/epoch - 26ms/step
Epoch 7/50
1570/1570 - 42s - loss: 3.2561 - accuracy300: 0.3861 - val_loss: 3.2936 - val_accuracy300: 0.3577 - 42s/epoch - 27ms/step
Epoch 8/50
1570/1570 - 41s - loss: 3.2536 - accuracy300: 0.3882 - val_loss: 3.2895 - val_accuracy300: 0.3609 - 41s/epoch - 26ms/step
Epoch 9/50
1570/1570 - 38s - loss: 3.2513 - accuracy300: 0.3900 - val_loss: 3.2936 - val_accuracy300: 0.3603 - 38s/epoch - 24ms/step
Epoch 10/50
1570/1570 - 40s - loss: 3.2492 - accuracy300: 0.3910 - val_loss: 3.2926 - val_accuracy300: 0.3641 - 40s/epoch - 25ms/step
Epoch 11/50
1570/1570 - 40s - loss: 3.2476 - accuracy300: 0.3919 - val_loss: 3.2965 - val_accuracy300: 0.3581 - 40s/epoch - 26ms/step
Epoch 12/50
1570/1570 - 41s - loss: 3.2454 - accuracy300: 0.3936 - val_loss: 3.2976 - val_accuracy300: 0.3601 - 41s/epoch - 26ms/step
Epoch 13/50
1570/1570 - 40s - loss: 3.2435 - accuracy300: 0.3957 - val_loss: 3.2972 - val_accuracy300: 0.3632 - 40s/epoch - 25ms/step
Epoch 14/50
1570/1570 - 41s - loss: 3.2409 - accuracy300: 0.3971 - val_loss: 3.2976 - val_accuracy300: 0.3593 - 41s/epoch - 26ms/step
Epoch 15/50
1570/1570 - 40s - loss: 3.2397 - accuracy300: 0.3984 - val_loss: 3.2978 - val_accuracy300: 0.3618 - 40s/epoch - 25ms/step
testing model: results/EXC/W5/deepOF_L1/h300
Evaluating performance on  test set...
7167/7167 - 106s - 106s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1019593
{'0': {'precision': 0.39011100601741977, 'recall': 0.2172696908635815, 'f1-score': 0.27909776558635585, 'support': 618853}, '1': {'precision': 0.3016903237067332, 'recall': 0.4520812246396933, 'f1-score': 0.361882937350144, 'support': 558205}, '2': {'precision': 0.40110309702754526, 'recall': 0.39861720313669186, 'f1-score': 0.39985628643852006, 'support': 657508}, 'accuracy': 0.35371090492247215, 'macro avg': {'precision': 0.3643014755838994, 'recall': 0.35598937287998894, 'f1-score': 0.3469456631250066, 'support': 1834566}, 'weighted avg': {'precision': 0.36714673043760904, 'recall': 0.35371090492247215, 'f1-score': 0.3475667061057322, 'support': 1834566}}
[[134458 290856 193539]
 [108051 252354 197800]
 [102157 293257 262094]]
Evaluating performance on  train set...
1570/1570 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.093154
{'0': {'precision': 0.40474637302995514, 'recall': 0.22726973033559703, 'f1-score': 0.2910894154847972, 'support': 136503}, '1': {'precision': 0.3301250724757724, 'recall': 0.4464291048119717, 'f1-score': 0.3795676976359556, 'support': 133916}, '2': {'precision': 0.37932423796159936, 'recall': 0.4159506398537477, 'f1-score': 0.3967940240375532, 'support': 131280}, 'accuracy': 0.36199492654948107, 'macro avg': {'precision': 0.3713985611557756, 'recall': 0.36321649166710546, 'f1-score': 0.35581704571943534, 'support': 401699}, 'weighted avg': {'precision': 0.371561316615108, 'recall': 0.36199492654948107, 'f1-score': 0.3551312942132987, 'support': 401699}}
[[31023 64150 41330]
 [26112 59784 48020]
 [19513 57161 54606]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0968671
{'0': {'precision': 0.4048740104516997, 'recall': 0.17724070760379623, 'f1-score': 0.24654987711891105, 'support': 44149}, '1': {'precision': 0.31498223816017645, 'recall': 0.46114219516403343, 'f1-score': 0.37429977592829705, 'support': 40571}, '2': {'precision': 0.37151788372389744, 'recall': 0.4258103826468438, 'f1-score': 0.3968156627600618, 'support': 41030}, 'accuracy': 0.3499403578528827, 'macro avg': {'precision': 0.36379137744525786, 'recall': 0.3547310951382245, 'f1-score': 0.33922177193575664, 'support': 125750}, 'weighted avg': {'precision': 0.3649885156343548, 'recall': 0.3499403578528827, 'f1-score': 0.3367951759614718, 'support': 125750}}
[[ 7825 22055 14269]
 [ 6576 18709 15286]
 [ 4926 18633 17471]]
training model: results/EXC/W5/deepOF_L1/h500
Epoch 1/50
1570/1570 - 42s - loss: 3.2612 - accuracy500: 0.3944 - val_loss: 3.3424 - val_accuracy500: 0.2849 - 42s/epoch - 27ms/step
Epoch 2/50
1570/1570 - 41s - loss: 3.2480 - accuracy500: 0.3987 - val_loss: 3.2803 - val_accuracy500: 0.3840 - 41s/epoch - 26ms/step
Epoch 3/50
1570/1570 - 40s - loss: 3.2493 - accuracy500: 0.3992 - val_loss: 3.2704 - val_accuracy500: 0.3808 - 40s/epoch - 25ms/step
Epoch 4/50
1570/1570 - 39s - loss: 3.2520 - accuracy500: 0.3987 - val_loss: 3.2670 - val_accuracy500: 0.3806 - 39s/epoch - 25ms/step
Epoch 5/50
1570/1570 - 38s - loss: 3.2563 - accuracy500: 0.3962 - val_loss: 3.2687 - val_accuracy500: 0.3765 - 38s/epoch - 24ms/step
Epoch 6/50
1570/1570 - 40s - loss: 3.2550 - accuracy500: 0.3965 - val_loss: 3.2691 - val_accuracy500: 0.3765 - 40s/epoch - 26ms/step
Epoch 7/50
1570/1570 - 40s - loss: 3.2529 - accuracy500: 0.3971 - val_loss: 3.2704 - val_accuracy500: 0.3756 - 40s/epoch - 25ms/step
Epoch 8/50
1570/1570 - 39s - loss: 3.2527 - accuracy500: 0.3969 - val_loss: 3.2715 - val_accuracy500: 0.3752 - 39s/epoch - 25ms/step
Epoch 9/50
1570/1570 - 37s - loss: 3.2519 - accuracy500: 0.3975 - val_loss: 3.2737 - val_accuracy500: 0.3752 - 37s/epoch - 24ms/step
Epoch 10/50
1570/1570 - 38s - loss: 3.2503 - accuracy500: 0.3989 - val_loss: 3.2741 - val_accuracy500: 0.3767 - 38s/epoch - 24ms/step
Epoch 11/50
1570/1570 - 40s - loss: 3.2493 - accuracy500: 0.3993 - val_loss: 3.2735 - val_accuracy500: 0.3781 - 40s/epoch - 25ms/step
Epoch 12/50
1570/1570 - 40s - loss: 3.2477 - accuracy500: 0.3997 - val_loss: 3.2750 - val_accuracy500: 0.3780 - 40s/epoch - 25ms/step
Epoch 13/50
1570/1570 - 38s - loss: 3.2452 - accuracy500: 0.4016 - val_loss: 3.2776 - val_accuracy500: 0.3784 - 38s/epoch - 24ms/step
Epoch 14/50
1570/1570 - 39s - loss: 3.2439 - accuracy500: 0.4022 - val_loss: 3.2786 - val_accuracy500: 0.3762 - 39s/epoch - 25ms/step
testing model: results/EXC/W5/deepOF_L1/h500
Evaluating performance on  test set...
7167/7167 - 111s - 111s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0881625
{'0': {'precision': 0.38461641995547624, 'recall': 0.438145120238453, 'f1-score': 0.4096394868611747, 'support': 652204}, '1': {'precision': 0.28713298791019, 'recall': 0.0013666143311604508, 'f1-score': 0.00272028143663585, 'support': 486604}, '2': {'precision': 0.4021065368189513, 'recall': 0.6295364192722183, 'f1-score': 0.49075255709415067, 'support': 695758}, 'accuracy': 0.3948781346650925, 'macro avg': {'precision': 0.35795198156153923, 'recall': 0.3563493846139439, 'f1-score': 0.3010374417973204, 'support': 1834566}, 'weighted avg': {'precision': 0.3653928328846013, 'recall': 0.3948781346650925, 'f1-score': 0.33246949378529334, 'support': 1834566}}
[[285760    860 365584]
 [200252    665 285687]
 [256962    791 438005]]
Evaluating performance on  train set...
1570/1570 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0973507
{'0': {'precision': 0.378501722676191, 'recall': 0.4568407454714352, 'f1-score': 0.4139978888731778, 'support': 137792}, '1': {'precision': 0.418018018018018, 'recall': 0.0017326751159473326, 'f1-score': 0.003451045726355874, 'support': 133897}, '2': {'precision': 0.349099147053438, 'recall': 0.6305668794708099, 'f1-score': 0.4493987824900026, 'support': 130010}, 'accuracy': 0.3613675911565625, 'macro avg': {'precision': 0.381872962582549, 'recall': 0.36304676668606417, 'f1-score': 0.28894923902984543, 'support': 401699}, 'weighted avg': {'precision': 0.3821574065107798, 'recall': 0.3613675911565625, 'f1-score': 0.28860917623583837, 'support': 401699}}
[[62949   172 74671]
 [55483   232 78182]
 [47879   151 81980]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.08966
{'0': {'precision': 0.4087831301992648, 'recall': 0.40140577507598785, 'f1-score': 0.4050608645643631, 'support': 47376}, '1': {'precision': 0.23809523809523808, 'recall': 0.0002843494085532302, 'f1-score': 0.0005680204487361545, 'support': 35168}, '2': {'precision': 0.3646305580461439, 'recall': 0.6682868120168495, 'f1-score': 0.47182436904071307, 'support': 43206}, 'accuracy': 0.3809224652087475, 'macro avg': {'precision': 0.337169642113549, 'recall': 0.3566589788337968, 'f1-score': 0.2924844180179374, 'support': 125750}, 'weighted avg': {'precision': 0.34587730258922783, 'recall': 0.3809224652087475, 'f1-score': 0.3148770047834232, 'support': 125750}}
[[19017    18 28341]
 [13186    10 21972]
 [14318    14 28874]]
training model: results/EXC/W5/deepOF_L1/h1000
Epoch 1/50
1570/1570 - 41s - loss: 3.2544 - accuracy1000: 0.4079 - val_loss: 3.2857 - val_accuracy1000: 0.3633 - 41s/epoch - 26ms/step
Epoch 2/50
1570/1570 - 39s - loss: 3.2464 - accuracy1000: 0.4044 - val_loss: 3.2810 - val_accuracy1000: 0.3761 - 39s/epoch - 25ms/step
Epoch 3/50
1570/1570 - 39s - loss: 3.2519 - accuracy1000: 0.3974 - val_loss: 3.2902 - val_accuracy1000: 0.3633 - 39s/epoch - 25ms/step
Epoch 4/50
1570/1570 - 38s - loss: 3.2582 - accuracy1000: 0.3889 - val_loss: 3.2910 - val_accuracy1000: 0.3612 - 38s/epoch - 24ms/step
Epoch 5/50
1570/1570 - 39s - loss: 3.2585 - accuracy1000: 0.3891 - val_loss: 3.2909 - val_accuracy1000: 0.3600 - 39s/epoch - 25ms/step
Epoch 6/50
1570/1570 - 39s - loss: 3.2569 - accuracy1000: 0.3913 - val_loss: 3.2918 - val_accuracy1000: 0.3616 - 39s/epoch - 25ms/step
Epoch 7/50
1570/1570 - 39s - loss: 3.2571 - accuracy1000: 0.3901 - val_loss: 3.2928 - val_accuracy1000: 0.3587 - 39s/epoch - 25ms/step
Epoch 8/50
1570/1570 - 39s - loss: 3.2554 - accuracy1000: 0.3934 - val_loss: 3.2935 - val_accuracy1000: 0.3593 - 39s/epoch - 25ms/step
Epoch 9/50
1570/1570 - 40s - loss: 3.2555 - accuracy1000: 0.3921 - val_loss: 3.2938 - val_accuracy1000: 0.3609 - 40s/epoch - 25ms/step
Epoch 10/50
1570/1570 - 41s - loss: 3.2547 - accuracy1000: 0.3928 - val_loss: 3.2950 - val_accuracy1000: 0.3595 - 41s/epoch - 26ms/step
Epoch 11/50
1570/1570 - 40s - loss: 3.2530 - accuracy1000: 0.3948 - val_loss: 3.2935 - val_accuracy1000: 0.3602 - 40s/epoch - 25ms/step
Epoch 12/50
1570/1570 - 39s - loss: 3.2531 - accuracy1000: 0.3943 - val_loss: 3.2947 - val_accuracy1000: 0.3604 - 39s/epoch - 25ms/step
testing model: results/EXC/W5/deepOF_L1/h1000
Evaluating performance on  test set...
7167/7167 - 117s - 117s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0865916
{'0': {'precision': 0.3988721539764427, 'recall': 0.6230748835057711, 'f1-score': 0.4863798450551181, 'support': 709048}, '1': {'precision': 0.20742739247738454, 'recall': 0.003572131362602764, 'f1-score': 0.007023313424093673, 'support': 365888}, '2': {'precision': 0.43444753263296365, 'recall': 0.4121638165949212, 'f1-score': 0.4230124089963027, 'support': 759630}, 'accuracy': 0.412189585983824, 'macro avg': {'precision': 0.3469156930289303, 'recall': 0.3462702771544317, 'f1-score': 0.3054718558251715, 'support': 1834566}, 'weighted avg': {'precision': 0.3754207131416543, 'recall': 0.412189585983824, 'f1-score': 0.364538162554314, 'support': 1834566}}
[[441790   2275 264983]
 [221989   1307 142592]
 [443819   2719 313092]]
Evaluating performance on  train set...
1570/1570 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0978317
{'0': {'precision': 0.36382939516027707, 'recall': 0.6226116247401993, 'f1-score': 0.45927613770935544, 'support': 139530}, '1': {'precision': 0.33504023408924655, 'recall': 0.003479000660858204, 'f1-score': 0.006886493151096877, 'support': 131647}, '2': {'precision': 0.34750368288787925, 'recall': 0.43013438347558264, 'f1-score': 0.38442892358258013, 'support': 130522}, 'accuracy': 0.35716543979447296, 'macro avg': {'precision': 0.34879110404580094, 'recall': 0.35207500295888, 'f1-score': 0.2835305181476775, 'support': 401699}, 'weighted avg': {'precision': 0.34908982323021037, 'recall': 0.35716543979447296, 'f1-score': 0.28669679940028314, 'support': 401699}}
[[86873   460 52197]
 [77970   458 53219]
 [73931   449 56142]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0941851
{'0': {'precision': 0.3889358822534258, 'recall': 0.6388158597841188, 'f1-score': 0.4834988837480182, 'support': 46785}, '1': {'precision': 0.35, 'recall': 0.0031093836757357025, 'f1-score': 0.006164006604292791, 'support': 36020}, '2': {'precision': 0.35886142383765207, 'recall': 0.40600768424729305, 'f1-score': 0.3809815146615391, 'support': 42945}, 'accuracy': 0.3772166998011928, 'macro avg': {'precision': 0.3659324353636926, 'recall': 0.34931097590238247, 'f1-score': 0.2902148016712834, 'support': 125750}, 'weighted avg': {'precision': 0.367512279108823, 'recall': 0.3772166998011928, 'f1-score': 0.3117596337270573, 'support': 125750}}
[[29887   114 16784]
 [21541   112 14367]
 [25415    94 17436]]
training model: results/EXC/W5/deepLOB_L2/h10
Epoch 1/50
1570/1570 - 77s - loss: 2.6817 - accuracy10: 0.4826 - val_loss: 3.2253 - val_accuracy10: 0.5354 - 77s/epoch - 49ms/step
Epoch 2/50
1570/1570 - 74s - loss: 2.4046 - accuracy10: 0.5664 - val_loss: 3.1346 - val_accuracy10: 0.5403 - 74s/epoch - 47ms/step
Epoch 3/50
1570/1570 - 75s - loss: 2.2651 - accuracy10: 0.6196 - val_loss: 2.9694 - val_accuracy10: 0.4601 - 75s/epoch - 48ms/step
Epoch 4/50
1570/1570 - 76s - loss: 2.1622 - accuracy10: 0.6509 - val_loss: 2.7673 - val_accuracy10: 0.4569 - 76s/epoch - 49ms/step
Epoch 5/50
1570/1570 - 76s - loss: 2.1139 - accuracy10: 0.6585 - val_loss: 2.7850 - val_accuracy10: 0.5026 - 76s/epoch - 48ms/step
Epoch 6/50
1570/1570 - 75s - loss: 2.0845 - accuracy10: 0.6612 - val_loss: 3.0220 - val_accuracy10: 0.3971 - 75s/epoch - 48ms/step
Epoch 7/50
1570/1570 - 74s - loss: 2.0634 - accuracy10: 0.6632 - val_loss: 2.6961 - val_accuracy10: 0.4971 - 74s/epoch - 47ms/step
Epoch 8/50
1570/1570 - 74s - loss: 2.0454 - accuracy10: 0.6648 - val_loss: 2.7138 - val_accuracy10: 0.4704 - 74s/epoch - 47ms/step
Epoch 9/50
1570/1570 - 74s - loss: 2.0323 - accuracy10: 0.6661 - val_loss: 2.7245 - val_accuracy10: 0.5132 - 74s/epoch - 47ms/step
Epoch 10/50
1570/1570 - 73s - loss: 2.0185 - accuracy10: 0.6666 - val_loss: 2.7743 - val_accuracy10: 0.4518 - 73s/epoch - 47ms/step
Epoch 11/50
1570/1570 - 73s - loss: 2.0089 - accuracy10: 0.6675 - val_loss: 2.7852 - val_accuracy10: 0.4398 - 73s/epoch - 46ms/step
Epoch 12/50
1570/1570 - 73s - loss: 1.9998 - accuracy10: 0.6682 - val_loss: 2.6932 - val_accuracy10: 0.4802 - 73s/epoch - 47ms/step
Epoch 13/50
1570/1570 - 73s - loss: 1.9908 - accuracy10: 0.6687 - val_loss: 2.7690 - val_accuracy10: 0.4838 - 73s/epoch - 47ms/step
Epoch 14/50
1570/1570 - 74s - loss: 1.9819 - accuracy10: 0.6700 - val_loss: 2.7209 - val_accuracy10: 0.4819 - 74s/epoch - 47ms/step
Epoch 15/50
1570/1570 - 73s - loss: 1.9753 - accuracy10: 0.6700 - val_loss: 2.7247 - val_accuracy10: 0.4681 - 73s/epoch - 47ms/step
Epoch 16/50
1570/1570 - 74s - loss: 1.9667 - accuracy10: 0.6703 - val_loss: 2.7721 - val_accuracy10: 0.4555 - 74s/epoch - 47ms/step
Epoch 17/50
1570/1570 - 73s - loss: 1.9614 - accuracy10: 0.6704 - val_loss: 2.7920 - val_accuracy10: 0.4974 - 73s/epoch - 47ms/step
Epoch 18/50
1570/1570 - 74s - loss: 1.9539 - accuracy10: 0.6705 - val_loss: 2.8139 - val_accuracy10: 0.4863 - 74s/epoch - 47ms/step
Epoch 19/50
1570/1570 - 72s - loss: 1.9469 - accuracy10: 0.6710 - val_loss: 2.8554 - val_accuracy10: 0.4567 - 72s/epoch - 46ms/step
Epoch 20/50
1570/1570 - 73s - loss: 1.9413 - accuracy10: 0.6720 - val_loss: 2.8873 - val_accuracy10: 0.4819 - 73s/epoch - 47ms/step
Epoch 21/50
1570/1570 - 74s - loss: 1.9379 - accuracy10: 0.6711 - val_loss: 2.9329 - val_accuracy10: 0.5149 - 74s/epoch - 47ms/step
Epoch 22/50
1570/1570 - 73s - loss: 1.9286 - accuracy10: 0.6728 - val_loss: 2.9410 - val_accuracy10: 0.5501 - 73s/epoch - 47ms/step
testing model: results/EXC/W5/deepLOB_L2/h10
Evaluating performance on  test set...
7167/7167 - 132s - 132s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8452481
{'0': {'precision': 0.32639821400789376, 'recall': 0.8016359994064401, 'f1-score': 0.4639089052072721, 'support': 269560}, '1': {'precision': 0.8946184402529319, 'recall': 0.5116399291257477, 'f1-score': 0.650979258623478, 'support': 1294123}, '2': {'precision': 0.3338891329987743, 'recall': 0.5329767283895928, 'f1-score': 0.41057133675909785, 'support': 270888}, 'accuracy': 0.5574006130043482, 'macro avg': {'precision': 0.5183019290865333, 'recall': 0.6154175523072603, 'f1-score': 0.508486500196616, 'support': 1834571}, 'weighted avg': {'precision': 0.7283319979347677, 'recall': 0.5574006130043482, 'f1-score': 0.5879943397487817, 'support': 1834571}}
[[216089  29393  24078]
 [368043 662125 263955]
 [ 77909  48602 144377]]
Evaluating performance on  train set...
1570/1570 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92874724
{'0': {'precision': 0.2742593059853123, 'recall': 0.8204028125372422, 'f1-score': 0.4110914266377371, 'support': 50346}, '1': {'precision': 0.9320869710747259, 'recall': 0.44412436080182616, 'f1-score': 0.6015973283344623, 'support': 300963}, '2': {'precision': 0.2856174496021097, 'recall': 0.610418733875769, 'f1-score': 0.389150003479185, 'support': 50390}, 'accuracy': 0.512144665533148, 'macro avg': {'precision': 0.497321242220716, 'recall': 0.6249819690716124, 'f1-score': 0.4672795861504615, 'support': 401699}, 'weighted avg': {'precision': 0.7685451379768173, 'recall': 0.512144665533148, 'f1-score': 0.5510708624326782, 'support': 401699}}
[[ 41304   3830   5212]
 [ 95576 133665  71722]
 [ 13722   5909  30759]]
Evaluating performance on  val set...
492/492 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97183484
{'0': {'precision': 0.29232359782889633, 'recall': 0.794112881447475, 'f1-score': 0.42733825495553096, 'support': 18515}, '1': {'precision': 0.9215227786243497, 'recall': 0.39477090344292, 'f1-score': 0.552749564655546, 'support': 88849}, '2': {'precision': 0.28284881388569444, 'recall': 0.5752202762971826, 'f1-score': 0.37922441149577785, 'support': 18386}, 'accuracy': 0.4799522862823062, 'macro avg': {'precision': 0.4988983967796468, 'recall': 0.5880346870625259, 'f1-score': 0.4531040770356183, 'support': 125750}, 'weighted avg': {'precision': 0.7355006525956203, 'recall': 0.4799522862823062, 'f1-score': 0.5089131919709236, 'support': 125750}}
[[14703  1128  2684]
 [29643 35075 24131]
 [ 5951  1859 10576]]
training model: results/EXC/W5/deepLOB_L2/h20
Epoch 1/50
1570/1570 - 76s - loss: 2.7784 - accuracy20: 0.4844 - val_loss: 3.1735 - val_accuracy20: 0.4001 - 76s/epoch - 49ms/step
Epoch 2/50
1570/1570 - 73s - loss: 2.5241 - accuracy20: 0.5579 - val_loss: 3.1077 - val_accuracy20: 0.4524 - 73s/epoch - 47ms/step
Epoch 3/50
1570/1570 - 74s - loss: 2.4032 - accuracy20: 0.6003 - val_loss: 2.8760 - val_accuracy20: 0.4885 - 74s/epoch - 47ms/step
Epoch 4/50
1570/1570 - 75s - loss: 2.2932 - accuracy20: 0.6307 - val_loss: 2.9296 - val_accuracy20: 0.4535 - 75s/epoch - 48ms/step
Epoch 5/50
1570/1570 - 75s - loss: 2.2436 - accuracy20: 0.6404 - val_loss: 2.9074 - val_accuracy20: 0.4755 - 75s/epoch - 48ms/step
Epoch 6/50
1570/1570 - 74s - loss: 2.2204 - accuracy20: 0.6448 - val_loss: 2.9566 - val_accuracy20: 0.4441 - 74s/epoch - 47ms/step
Epoch 7/50
1570/1570 - 75s - loss: 2.2019 - accuracy20: 0.6465 - val_loss: 2.7255 - val_accuracy20: 0.5290 - 75s/epoch - 48ms/step
Epoch 8/50
1570/1570 - 75s - loss: 2.1872 - accuracy20: 0.6475 - val_loss: 2.9321 - val_accuracy20: 0.5034 - 75s/epoch - 48ms/step
Epoch 9/50
1570/1570 - 74s - loss: 2.1738 - accuracy20: 0.6488 - val_loss: 2.7302 - val_accuracy20: 0.4957 - 74s/epoch - 47ms/step
Epoch 10/50
1570/1570 - 74s - loss: 2.1628 - accuracy20: 0.6501 - val_loss: 2.7485 - val_accuracy20: 0.5059 - 74s/epoch - 47ms/step
Epoch 11/50
1570/1570 - 74s - loss: 2.1524 - accuracy20: 0.6510 - val_loss: 2.7153 - val_accuracy20: 0.5075 - 74s/epoch - 47ms/step
Epoch 12/50
1570/1570 - 74s - loss: 2.1436 - accuracy20: 0.6521 - val_loss: 2.7493 - val_accuracy20: 0.4970 - 74s/epoch - 47ms/step
Epoch 13/50
1570/1570 - 73s - loss: 2.1365 - accuracy20: 0.6520 - val_loss: 2.7681 - val_accuracy20: 0.4852 - 73s/epoch - 46ms/step
Epoch 14/50
1570/1570 - 74s - loss: 2.1302 - accuracy20: 0.6525 - val_loss: 2.8261 - val_accuracy20: 0.4693 - 74s/epoch - 47ms/step
Epoch 15/50
1570/1570 - 75s - loss: 2.1236 - accuracy20: 0.6529 - val_loss: 2.8110 - val_accuracy20: 0.4899 - 75s/epoch - 48ms/step
Epoch 16/50
1570/1570 - 74s - loss: 2.1153 - accuracy20: 0.6538 - val_loss: 2.7549 - val_accuracy20: 0.5006 - 74s/epoch - 47ms/step
Epoch 17/50
1570/1570 - 75s - loss: 2.1100 - accuracy20: 0.6548 - val_loss: 2.8182 - val_accuracy20: 0.4855 - 75s/epoch - 48ms/step
Epoch 18/50
1570/1570 - 74s - loss: 2.1054 - accuracy20: 0.6540 - val_loss: 2.8122 - val_accuracy20: 0.4826 - 74s/epoch - 47ms/step
Epoch 19/50
1570/1570 - 73s - loss: 2.0993 - accuracy20: 0.6547 - val_loss: 2.8494 - val_accuracy20: 0.4906 - 73s/epoch - 46ms/step
Epoch 20/50
1570/1570 - 74s - loss: 2.0930 - accuracy20: 0.6552 - val_loss: 2.8517 - val_accuracy20: 0.4793 - 74s/epoch - 47ms/step
Epoch 21/50
1570/1570 - 73s - loss: 2.0878 - accuracy20: 0.6558 - val_loss: 2.8640 - val_accuracy20: 0.4683 - 73s/epoch - 47ms/step
testing model: results/EXC/W5/deepLOB_L2/h20
Evaluating performance on  test set...
7167/7167 - 135s - 135s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8810321
{'0': {'precision': 0.36783838722741147, 'recall': 0.7856125176694518, 'f1-score': 0.501067605492991, 'support': 357255}, '1': {'precision': 0.8187797762045071, 'recall': 0.5062787415850187, 'f1-score': 0.6256792272444014, 'support': 1117501}, '2': {'precision': 0.4509320132221329, 'recall': 0.47694787599182914, 'f1-score': 0.46357522869734696, 'support': 359815}, 'accuracy': 0.55492210440479, 'macro avg': {'precision': 0.5458500588846839, 'recall': 0.5896130450820999, 'f1-score': 0.5301073538115798, 'support': 1834571}, 'weighted avg': {'precision': 0.6588196499643587, 'recall': 0.55492210440479, 'f1-score': 0.5696194862117521, 'support': 1834571}}
[[280664  45763  30828]
 [373601 565767 178133]
 [108744  79458 171613]]
Evaluating performance on  train set...
1570/1570 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87617856
{'0': {'precision': 0.3351760759842747, 'recall': 0.7679072569388324, 'f1-score': 0.46666309501486697, 'support': 68059}, '1': {'precision': 0.873210410667249, 'recall': 0.48186628005497917, 'f1-score': 0.621028544250504, 'support': 265555}, '2': {'precision': 0.402106217877658, 'recall': 0.5860468531982082, 'f1-score': 0.47695663867555216, 'support': 68085}, 'accuracy': 0.5479874234190277, 'macro avg': {'precision': 0.5368309015097272, 'recall': 0.6119401300640066, 'f1-score': 0.5215494259803077, 'support': 401699}, 'weighted avg': {'precision': 0.7022037421162498, 'recall': 0.5479874234190277, 'f1-score': 0.5704556182521848, 'support': 401699}}
[[ 52263   7644   8152]
 [ 86416 127962  51177]
 [ 17248  10936  39901]]
Evaluating performance on  val set...
492/492 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93208796
{'0': {'precision': 0.34224305296805446, 'recall': 0.7215148007276335, 'f1-score': 0.4642662374802144, 'support': 24188}, '1': {'precision': 0.8752598176426573, 'recall': 0.4072259328983676, 'f1-score': 0.5558400872955113, 'support': 77554}, '2': {'precision': 0.3841340435434659, 'recall': 0.6187937354215262, 'f1-score': 0.4740116779936824, 'support': 24008}, 'accuracy': 0.5080715705765407, 'macro avg': {'precision': 0.5338789713847258, 'recall': 0.5825114896825091, 'f1-score': 0.49803933425646935, 'support': 125750}, 'weighted avg': {'precision': 0.6789691052090773, 'recall': 0.5080715705765407, 'f1-score': 0.5226033101197601, 'support': 125750}}
[[17452  1926  4810]
 [26964 31582 19008]
 [ 6577  2575 14856]]
training model: results/EXC/W5/deepLOB_L2/h30
Epoch 1/50
1570/1570 - 76s - loss: 2.8438 - accuracy30: 0.4832 - val_loss: 3.3213 - val_accuracy30: 0.4042 - 76s/epoch - 48ms/step
Epoch 2/50
1570/1570 - 73s - loss: 2.6535 - accuracy30: 0.5422 - val_loss: 3.1023 - val_accuracy30: 0.4771 - 73s/epoch - 47ms/step
Epoch 3/50
1570/1570 - 74s - loss: 2.5707 - accuracy30: 0.5693 - val_loss: 3.2156 - val_accuracy30: 0.4592 - 74s/epoch - 47ms/step
Epoch 4/50
1570/1570 - 74s - loss: 2.4899 - accuracy30: 0.5957 - val_loss: 3.2671 - val_accuracy30: 0.4365 - 74s/epoch - 47ms/step
Epoch 5/50
1570/1570 - 73s - loss: 2.4255 - accuracy30: 0.6119 - val_loss: 3.1872 - val_accuracy30: 0.4901 - 73s/epoch - 47ms/step
Epoch 6/50
1570/1570 - 73s - loss: 2.3908 - accuracy30: 0.6167 - val_loss: 3.2310 - val_accuracy30: 0.4678 - 73s/epoch - 47ms/step
Epoch 7/50
1570/1570 - 74s - loss: 2.3670 - accuracy30: 0.6226 - val_loss: 3.1833 - val_accuracy30: 0.4757 - 74s/epoch - 47ms/step
Epoch 8/50
1570/1570 - 75s - loss: 2.3498 - accuracy30: 0.6251 - val_loss: 3.0621 - val_accuracy30: 0.4844 - 75s/epoch - 48ms/step
Epoch 9/50
1570/1570 - 76s - loss: 2.3373 - accuracy30: 0.6270 - val_loss: 3.0574 - val_accuracy30: 0.4730 - 76s/epoch - 48ms/step
Epoch 10/50
1570/1570 - 75s - loss: 2.3245 - accuracy30: 0.6280 - val_loss: 3.0963 - val_accuracy30: 0.4659 - 75s/epoch - 48ms/step
Epoch 11/50
1570/1570 - 74s - loss: 2.3159 - accuracy30: 0.6297 - val_loss: 3.0371 - val_accuracy30: 0.4829 - 74s/epoch - 47ms/step
Epoch 12/50
1570/1570 - 73s - loss: 2.3067 - accuracy30: 0.6302 - val_loss: 3.0301 - val_accuracy30: 0.4874 - 73s/epoch - 47ms/step
Epoch 13/50
1570/1570 - 73s - loss: 2.2975 - accuracy30: 0.6311 - val_loss: 2.9837 - val_accuracy30: 0.4934 - 73s/epoch - 47ms/step
Epoch 14/50
1570/1570 - 74s - loss: 2.2886 - accuracy30: 0.6317 - val_loss: 2.9529 - val_accuracy30: 0.5067 - 74s/epoch - 47ms/step
Epoch 15/50
1570/1570 - 75s - loss: 2.2805 - accuracy30: 0.6322 - val_loss: 2.9776 - val_accuracy30: 0.5147 - 75s/epoch - 48ms/step
Epoch 16/50
1570/1570 - 74s - loss: 2.2741 - accuracy30: 0.6330 - val_loss: 3.0124 - val_accuracy30: 0.5074 - 74s/epoch - 47ms/step
Epoch 17/50
1570/1570 - 75s - loss: 2.2682 - accuracy30: 0.6333 - val_loss: 2.9958 - val_accuracy30: 0.5109 - 75s/epoch - 48ms/step
Epoch 18/50
1570/1570 - 75s - loss: 2.2622 - accuracy30: 0.6341 - val_loss: 3.0451 - val_accuracy30: 0.5356 - 75s/epoch - 48ms/step
Epoch 19/50
1570/1570 - 74s - loss: 2.2573 - accuracy30: 0.6346 - val_loss: 3.1457 - val_accuracy30: 0.5444 - 74s/epoch - 47ms/step
Epoch 20/50
1570/1570 - 74s - loss: 2.2506 - accuracy30: 0.6352 - val_loss: 3.1102 - val_accuracy30: 0.5432 - 74s/epoch - 47ms/step
Epoch 21/50
1570/1570 - 75s - loss: 2.2445 - accuracy30: 0.6355 - val_loss: 3.0069 - val_accuracy30: 0.5403 - 75s/epoch - 47ms/step
Epoch 22/50
1570/1570 - 73s - loss: 2.2404 - accuracy30: 0.6363 - val_loss: 3.0736 - val_accuracy30: 0.5373 - 73s/epoch - 47ms/step
Epoch 23/50
1570/1570 - 73s - loss: 2.2342 - accuracy30: 0.6361 - val_loss: 3.0831 - val_accuracy30: 0.5167 - 73s/epoch - 47ms/step
Epoch 24/50
1570/1570 - 74s - loss: 2.2281 - accuracy30: 0.6366 - val_loss: 3.0530 - val_accuracy30: 0.5469 - 74s/epoch - 47ms/step
testing model: results/EXC/W5/deepLOB_L2/h30
Evaluating performance on  test set...
7167/7167 - 135s - 135s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9400891
{'0': {'precision': 0.3690264078374375, 'recall': 0.7871265153619184, 'f1-score': 0.5024775955654828, 'support': 421269}, '1': {'precision': 0.7009862347626655, 'recall': 0.4782939001474956, 'f1-score': 0.5686137334957907, 'support': 989860}, '2': {'precision': 0.5421982618038103, 'recall': 0.33370567869979834, 'f1-score': 0.4131380864460126, 'support': 423442}, 'accuracy': 0.5158377626158922, 'macro avg': {'precision': 0.5374036348013044, 'recall': 0.5330420314030707, 'f1-score': 0.4947431385024286, 'support': 1834571}, 'weighted avg': {'precision': 0.588108684003056, 'recall': 0.5158377626158922, 'f1-score': 0.5175412900592515, 'support': 1834571}}
[[331592  67466  22211]
 [419317 473444  97099]
 [147650 134487 141305]]
Evaluating performance on  train set...
1570/1570 - 31s - 31s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9045918
{'0': {'precision': 0.3420159749313205, 'recall': 0.800044574867204, 'f1-score': 0.4791830438587384, 'support': 80763}, '1': {'precision': 0.7848905756203738, 'recall': 0.46870495504878396, 'f1-score': 0.5869231230714254, 'support': 240038}, '2': {'precision': 0.5099730691130089, 'recall': 0.43772404756607086, 'f1-score': 0.4710945554927329, 'support': 80898}, 'accuracy': 0.5290827211419495, 'macro avg': {'precision': 0.5456265398882344, 'recall': 0.568824525827353, 'f1-score': 0.5124002408076321, 'support': 401699}, 'weighted avg': {'precision': 0.6404835499198298, 'recall': 0.5290827211419495, 'f1-score': 0.5419349317205998, 'support': 401699}}
[[ 64614  10632   5517]
 [ 99022 112507  28509]
 [ 25285  20202  35411]]
Evaluating performance on  val set...
492/492 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93964845
{'0': {'precision': 0.35476732834363817, 'recall': 0.7757222143162089, 'f1-score': 0.48687031082529475, 'support': 28108}, '1': {'precision': 0.733538780023054, 'recall': 0.44736804350009324, 'f1-score': 0.5557793423046075, 'support': 69701}, '2': {'precision': 0.49667141086267846, 'recall': 0.3871729716187681, 'f1-score': 0.4351393749245807, 'support': 27941}, 'accuracy': 0.5073876739562624, 'macro avg': {'precision': 0.5283258397431235, 'recall': 0.5367544098116901, 'f1-score': 0.4925963426848276, 'support': 125750}, 'weighted avg': {'precision': 0.5962439957247234, 'recall': 0.5073876739562624, 'f1-score': 0.5135710211484577, 'support': 125750}}
[[21804  3951  2353]
 [29909 31182  8610]
 [ 9747  7376 10818]]
training model: results/EXC/W5/deepLOB_L2/h50
Epoch 1/50
1570/1570 - 77s - loss: 2.9629 - accuracy50: 0.4749 - val_loss: 3.4547 - val_accuracy50: 0.4410 - 77s/epoch - 49ms/step
Epoch 2/50
1570/1570 - 74s - loss: 2.8124 - accuracy50: 0.5256 - val_loss: 3.2353 - val_accuracy50: 0.4619 - 74s/epoch - 47ms/step
Epoch 3/50
1570/1570 - 73s - loss: 2.7531 - accuracy50: 0.5466 - val_loss: 3.2139 - val_accuracy50: 0.4596 - 73s/epoch - 47ms/step
Epoch 4/50
1570/1570 - 74s - loss: 2.7042 - accuracy50: 0.5608 - val_loss: 3.2623 - val_accuracy50: 0.4073 - 74s/epoch - 47ms/step
Epoch 5/50
1570/1570 - 73s - loss: 2.6615 - accuracy50: 0.5706 - val_loss: 3.5989 - val_accuracy50: 0.3520 - 73s/epoch - 47ms/step
Epoch 6/50
1570/1570 - 75s - loss: 2.6291 - accuracy50: 0.5774 - val_loss: 3.5496 - val_accuracy50: 0.3604 - 75s/epoch - 47ms/step
Epoch 7/50
1570/1570 - 74s - loss: 2.6033 - accuracy50: 0.5821 - val_loss: 3.5638 - val_accuracy50: 0.3724 - 74s/epoch - 47ms/step
Epoch 8/50
1570/1570 - 74s - loss: 2.5853 - accuracy50: 0.5861 - val_loss: 3.9883 - val_accuracy50: 0.3724 - 74s/epoch - 47ms/step
Epoch 9/50
1570/1570 - 73s - loss: 2.5702 - accuracy50: 0.5889 - val_loss: 4.0036 - val_accuracy50: 0.3605 - 73s/epoch - 47ms/step
Epoch 10/50
1570/1570 - 74s - loss: 2.5582 - accuracy50: 0.5916 - val_loss: 3.5491 - val_accuracy50: 0.3845 - 74s/epoch - 47ms/step
Epoch 11/50
1570/1570 - 74s - loss: 2.5481 - accuracy50: 0.5923 - val_loss: 3.5804 - val_accuracy50: 0.3926 - 74s/epoch - 47ms/step
Epoch 12/50
1570/1570 - 74s - loss: 2.5375 - accuracy50: 0.5937 - val_loss: 3.4812 - val_accuracy50: 0.3974 - 74s/epoch - 47ms/step
Epoch 13/50
1570/1570 - 74s - loss: 2.5304 - accuracy50: 0.5949 - val_loss: 3.6172 - val_accuracy50: 0.3891 - 74s/epoch - 47ms/step
testing model: results/EXC/W5/deepLOB_L2/h50
Evaluating performance on  test set...
7167/7167 - 135s - 135s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0257596
{'0': {'precision': 0.4179206153728447, 'recall': 0.548878922033728, 'f1-score': 0.47453025779645924, 'support': 517493}, '1': {'precision': 0.5048883475592952, 'recall': 0.6562518395867802, 'f1-score': 0.5707043999331223, 'support': 798413}, '2': {'precision': 0.5696151744861025, 'recall': 0.12865144168201054, 'f1-score': 0.2098963682489553, 'support': 518665}, 'accuracy': 0.4768024786176169, 'macro avg': {'precision': 0.49747471247274744, 'recall': 0.44459406776750626, 'f1-score': 0.4183770086595122, 'support': 1834571}, 'weighted avg': {'precision': 0.49865601697935563, 'recall': 0.4768024786176169, 'f1-score': 0.44156906361188064, 'support': 1834571}}
[[284041 219498  13954]
 [237990 523960  36463]
 [157622 294316  66727]]
Evaluating performance on  train set...
1570/1570 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0221739
{'0': {'precision': 0.34667305548132654, 'recall': 0.7459946065989848, 'f1-score': 0.4733666761032997, 'support': 100864}, '1': {'precision': 0.6077738754103665, 'recall': 0.4493772148870314, 'f1-score': 0.5167089811848448, 'support': 200631}, '2': {'precision': 0.5219498760671991, 'recall': 0.18913416630074648, 'f1-score': 0.27765650409481807, 'support': 100204}, 'accuracy': 0.45893816016470046, 'macro avg': {'precision': 0.4921322689862974, 'recall': 0.4615019959289209, 'f1-score': 0.42257738712765414, 'support': 401699}, 'weighted avg': {'precision': 0.5208043257438116, 'recall': 0.45893816016470046, 'f1-score': 0.4461942607746023, 'support': 401699}}
[[75244 22222  3398]
 [96512 90159 13960]
 [45290 35962 18952]]
Evaluating performance on  val set...
492/492 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0209662
{'0': {'precision': 0.3650396393595523, 'recall': 0.6879650788070546, 'f1-score': 0.4769865128371791, 'support': 34134}, '1': {'precision': 0.5722689415379639, 'recall': 0.4884483323843539, 'f1-score': 0.5270467768210378, 'support': 57957}, '2': {'precision': 0.4907128514056225, 'recall': 0.17424760093882766, 'f1-score': 0.25717480432351847, 'support': 33659}, 'accuracy': 0.45850497017892644, 'macro avg': {'precision': 0.4760071441010463, 'recall': 0.45022033737674544, 'f1-score': 0.4204026979939118, 'support': 125750}, 'weighted avg': {'precision': 0.49418813487138435, 'recall': 0.45850497017892644, 'f1-score': 0.44122269910239736, 'support': 125750}}
[[23483  8860  1791]
 [25352 28309  4296]
 [15495 12299  5865]]
training model: results/EXC/W5/deepLOB_L2/h100
Epoch 1/50
1570/1570 - 76s - loss: 3.1408 - accuracy100: 0.4445 - val_loss: 3.5022 - val_accuracy100: 0.3384 - 76s/epoch - 49ms/step
Epoch 2/50
1570/1570 - 74s - loss: 3.0425 - accuracy100: 0.4789 - val_loss: 3.2823 - val_accuracy100: 0.3952 - 74s/epoch - 47ms/step
Epoch 3/50
1570/1570 - 75s - loss: 3.0177 - accuracy100: 0.4862 - val_loss: 3.2715 - val_accuracy100: 0.4081 - 75s/epoch - 48ms/step
Epoch 4/50
1570/1570 - 74s - loss: 2.9926 - accuracy100: 0.4933 - val_loss: 3.3189 - val_accuracy100: 0.4093 - 74s/epoch - 47ms/step
Epoch 5/50
1570/1570 - 74s - loss: 2.9720 - accuracy100: 0.4990 - val_loss: 3.2897 - val_accuracy100: 0.4207 - 74s/epoch - 47ms/step
Epoch 6/50
1570/1570 - 75s - loss: 2.9509 - accuracy100: 0.5041 - val_loss: 3.3082 - val_accuracy100: 0.4255 - 75s/epoch - 47ms/step
Epoch 7/50
1570/1570 - 73s - loss: 2.9269 - accuracy100: 0.5094 - val_loss: 3.3103 - val_accuracy100: 0.4139 - 73s/epoch - 47ms/step
Epoch 8/50
1570/1570 - 73s - loss: 2.9094 - accuracy100: 0.5132 - val_loss: 3.2504 - val_accuracy100: 0.4339 - 73s/epoch - 47ms/step
Epoch 9/50
1570/1570 - 73s - loss: 2.8961 - accuracy100: 0.5162 - val_loss: 3.2081 - val_accuracy100: 0.4318 - 73s/epoch - 46ms/step
Epoch 10/50
1570/1570 - 73s - loss: 2.8835 - accuracy100: 0.5186 - val_loss: 3.2335 - val_accuracy100: 0.4412 - 73s/epoch - 47ms/step
Epoch 11/50
1570/1570 - 73s - loss: 2.8725 - accuracy100: 0.5212 - val_loss: 3.2140 - val_accuracy100: 0.4389 - 73s/epoch - 47ms/step
Epoch 12/50
1570/1570 - 74s - loss: 2.8628 - accuracy100: 0.5240 - val_loss: 3.2122 - val_accuracy100: 0.4383 - 74s/epoch - 47ms/step
Epoch 13/50
1570/1570 - 75s - loss: 2.8530 - accuracy100: 0.5259 - val_loss: 3.2108 - val_accuracy100: 0.4387 - 75s/epoch - 48ms/step
Epoch 14/50
1570/1570 - 76s - loss: 2.8448 - accuracy100: 0.5287 - val_loss: 3.1623 - val_accuracy100: 0.4417 - 76s/epoch - 48ms/step
Epoch 15/50
1570/1570 - 75s - loss: 2.8363 - accuracy100: 0.5301 - val_loss: 3.2348 - val_accuracy100: 0.4349 - 75s/epoch - 48ms/step
Epoch 16/50
1570/1570 - 73s - loss: 2.8265 - accuracy100: 0.5326 - val_loss: 3.2820 - val_accuracy100: 0.4237 - 73s/epoch - 47ms/step
Epoch 17/50
1570/1570 - 74s - loss: 2.8195 - accuracy100: 0.5344 - val_loss: 3.2752 - val_accuracy100: 0.4220 - 74s/epoch - 47ms/step
Epoch 18/50
1570/1570 - 74s - loss: 2.8107 - accuracy100: 0.5360 - val_loss: 3.3572 - val_accuracy100: 0.4160 - 74s/epoch - 47ms/step
Epoch 19/50
1570/1570 - 75s - loss: 2.8014 - accuracy100: 0.5381 - val_loss: 3.2687 - val_accuracy100: 0.4207 - 75s/epoch - 48ms/step
Epoch 20/50
1570/1570 - 75s - loss: 2.7925 - accuracy100: 0.5403 - val_loss: 3.4868 - val_accuracy100: 0.4058 - 75s/epoch - 47ms/step
Epoch 21/50
1570/1570 - 74s - loss: 2.7848 - accuracy100: 0.5427 - val_loss: 3.3746 - val_accuracy100: 0.4111 - 74s/epoch - 47ms/step
Epoch 22/50
1570/1570 - 73s - loss: 2.7758 - accuracy100: 0.5441 - val_loss: 3.3288 - val_accuracy100: 0.4221 - 73s/epoch - 46ms/step
Epoch 23/50
1570/1570 - 73s - loss: 2.7679 - accuracy100: 0.5470 - val_loss: 3.4457 - val_accuracy100: 0.4122 - 73s/epoch - 47ms/step
Epoch 24/50
1570/1570 - 73s - loss: 2.7579 - accuracy100: 0.5496 - val_loss: 3.4753 - val_accuracy100: 0.4092 - 73s/epoch - 46ms/step
testing model: results/EXC/W5/deepLOB_L2/h100
Evaluating performance on  test set...
7167/7167 - 133s - 133s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1278105
{'0': {'precision': 0.4347902792322017, 'recall': 0.6523284342179603, 'f1-score': 0.5217940939763511, 'support': 646035}, '1': {'precision': 0.3579154593689132, 'recall': 0.51650817736995, 'f1-score': 0.4228299734911535, 'support': 531161}, '2': {'precision': 0.5571380849706945, 'recall': 0.08372390188248717, 'f1-score': 0.1455719806073302, 'support': 657375}, 'accuracy': 0.4092586223155168, 'macro avg': {'precision': 0.4499479411906031, 'recall': 0.4175201711567991, 'f1-score': 0.3633986826916116, 'support': 1834571}, 'weighted avg': {'precision': 0.4563732447341842, 'recall': 0.4092586223155168, 'f1-score': 0.35833086852636953, 'support': 1834571}}
[[421427 199983  24625]
 [237688 274349  19124]
 [310150 292187  55038]]
Evaluating performance on  train set...
1570/1570 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0795244
{'0': {'precision': 0.4107421745382148, 'recall': 0.7031530473903856, 'f1-score': 0.5185669280782894, 'support': 132031}, '1': {'precision': 0.4557658558413682, 'recall': 0.46387754230654277, 'f1-score': 0.45978592463277435, 'support': 140522}, '2': {'precision': 0.5311322777250314, 'recall': 0.13428213030213867, 'f1-score': 0.2143673862927001, 'support': 129146}, 'accuracy': 0.4365582189649464, 'macro avg': {'precision': 0.46588010270153807, 'recall': 0.4337709066663557, 'f1-score': 0.39757341300125465, 'support': 401699}, 'weighted avg': {'precision': 0.4651976698475044, 'recall': 0.4365582189649464, 'f1-score': 0.40020422817210993, 'support': 401699}}
[[92838 30837  8356]
 [68384 65185  6953]
 [64803 47001 17342]]
Evaluating performance on  val set...
492/492 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0504632
{'0': {'precision': 0.4233919625553077, 'recall': 0.5374225440367612, 'f1-score': 0.4736406123763845, 'support': 43089}, '1': {'precision': 0.46801026210690577, 'recall': 0.43230235512557413, 'f1-score': 0.44944819090435734, 'support': 40932}, '2': {'precision': 0.44689746443288114, 'recall': 0.3560593352344892, 'f1-score': 0.3963401621852326, 'support': 41729}, 'accuracy': 0.44302186878727634, 'macro avg': {'precision': 0.44609989636503156, 'recall': 0.4419280781322748, 'f1-score': 0.43980965515532483, 'support': 125750}, 'weighted avg': {'precision': 0.44571544028966376, 'recall': 0.44302186878727634, 'f1-score': 0.4401144518855727, 'support': 125750}}
[[23157  8206 11726]
 [16574 17695  6663]
 [14963 11908 14858]]
training model: results/EXC/W5/deepLOB_L2/h200
Epoch 1/50
1570/1570 - 77s - loss: 3.2366 - accuracy200: 0.4048 - val_loss: 3.5139 - val_accuracy200: 0.3485 - 77s/epoch - 49ms/step
Epoch 2/50
1570/1570 - 73s - loss: 3.1857 - accuracy200: 0.4264 - val_loss: 3.5151 - val_accuracy200: 0.3251 - 73s/epoch - 47ms/step
Epoch 3/50
1570/1570 - 73s - loss: 3.1703 - accuracy200: 0.4356 - val_loss: 3.5662 - val_accuracy200: 0.3392 - 73s/epoch - 47ms/step
Epoch 4/50
1570/1570 - 74s - loss: 3.1617 - accuracy200: 0.4382 - val_loss: 3.6924 - val_accuracy200: 0.3300 - 74s/epoch - 47ms/step
Epoch 5/50
1570/1570 - 74s - loss: 3.1498 - accuracy200: 0.4445 - val_loss: 3.7209 - val_accuracy200: 0.3415 - 74s/epoch - 47ms/step
Epoch 6/50
1570/1570 - 75s - loss: 3.1393 - accuracy200: 0.4472 - val_loss: 3.6406 - val_accuracy200: 0.3395 - 75s/epoch - 48ms/step
Epoch 7/50
1570/1570 - 75s - loss: 3.1324 - accuracy200: 0.4489 - val_loss: 3.5259 - val_accuracy200: 0.3379 - 75s/epoch - 48ms/step
Epoch 8/50
1570/1570 - 74s - loss: 3.1243 - accuracy200: 0.4531 - val_loss: 3.6027 - val_accuracy200: 0.3558 - 74s/epoch - 47ms/step
Epoch 9/50
1570/1570 - 75s - loss: 3.1150 - accuracy200: 0.4565 - val_loss: 3.9183 - val_accuracy200: 0.3567 - 75s/epoch - 48ms/step
Epoch 10/50
1570/1570 - 75s - loss: 3.1081 - accuracy200: 0.4587 - val_loss: 3.5300 - val_accuracy200: 0.3530 - 75s/epoch - 48ms/step
Epoch 11/50
1570/1570 - 75s - loss: 3.0977 - accuracy200: 0.4629 - val_loss: 3.6179 - val_accuracy200: 0.3435 - 75s/epoch - 48ms/step
testing model: results/EXC/W5/deepLOB_L2/h200
Evaluating performance on  test set...
7167/7167 - 136s - 136s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.2226825
{'0': {'precision': 0.3578811564689567, 'recall': 0.9081409060171647, 'f1-score': 0.5134294690630667, 'support': 652151}, '1': {'precision': 0.2597231630475071, 'recall': 0.08169476125961334, 'f1-score': 0.12429354341496832, 'support': 497486}, '2': {'precision': 0.4863503272476748, 'recall': 0.016490639974070496, 'f1-score': 0.03189966081015819, 'support': 684934}, 'accuracy': 0.35113495198605016, 'macro avg': {'precision': 0.3679848822547129, 'recall': 0.33544210241694955, 'f1-score': 0.22320755776273107, 'support': 1834571}, 'weighted avg': {'precision': 0.3792271144628895, 'recall': 0.35113495198605016, 'f1-score': 0.22812799379017323, 'support': 1834571}}
[[592245  54158   5748]
 [450663  40642   6181]
 [611957  61682  11295]]
Evaluating performance on  train set...
1570/1570 - 31s - 31s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1594987
{'0': {'precision': 0.34676009671898506, 'recall': 0.8417072611822799, 'f1-score': 0.4911712372345817, 'support': 135281}, '1': {'precision': 0.3243336476324081, 'recall': 0.10376567190535052, 'f1-score': 0.15722846233172608, 'support': 135912}, '2': {'precision': 0.41930835734870314, 'recall': 0.09588064916555561, 'f1-score': 0.15607304113553022, 'support': 130506}, 'accuracy': 0.3497220555689708, 'macro avg': {'precision': 0.3634673672333654, 'recall': 0.34711786075106205, 'f1-score': 0.26815758023394604, 'support': 401699}, 'weighted avg': {'precision': 0.3627421124907125, 'recall': 0.3497220555689708, 'f1-score': 0.26931567970842474, 'support': 401699}}
[[113867  13775   7639]
 [112119  14103   9690]
 [102388  15605  12513]]
Evaluating performance on  val set...
492/492 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1667145
{'0': {'precision': 0.35539840056778577, 'recall': 0.6225053832663663, 'f1-score': 0.45247277127874147, 'support': 45047}, '1': {'precision': 0.2734641638225256, 'recall': 0.1515844237742393, 'f1-score': 0.19505020793183891, 'support': 38058}, '2': {'precision': 0.39474195176886334, 'recall': 0.23836323132840895, 'f1-score': 0.297239604655243, 'support': 42645}, 'accuracy': 0.34970974155069584, 'macro avg': {'precision': 0.34120150538639155, 'recall': 0.3374843461230048, 'f1-score': 0.3149208612886078, 'support': 125750}, 'weighted avg': {'precision': 0.34394355014169303, 'recall': 0.34970974155069584, 'f1-score': 0.3219208324595327, 'support': 125750}}
[[28042  7788  9217]
 [25920  5769  6369]
 [24941  7539 10165]]
training model: results/EXC/W5/deepLOB_L2/h300
Epoch 1/50
1570/1570 - 78s - loss: 3.2703 - accuracy300: 0.3854 - val_loss: 3.4458 - val_accuracy300: 0.3423 - 78s/epoch - 50ms/step
Epoch 2/50
1570/1570 - 74s - loss: 3.2273 - accuracy300: 0.4086 - val_loss: 3.5114 - val_accuracy300: 0.3398 - 74s/epoch - 47ms/step
Epoch 3/50
1570/1570 - 73s - loss: 3.2079 - accuracy300: 0.4178 - val_loss: 3.5065 - val_accuracy300: 0.3310 - 73s/epoch - 47ms/step
Epoch 4/50
1570/1570 - 74s - loss: 3.1924 - accuracy300: 0.4260 - val_loss: 3.5858 - val_accuracy300: 0.3301 - 74s/epoch - 47ms/step
Epoch 5/50
1570/1570 - 74s - loss: 3.1825 - accuracy300: 0.4304 - val_loss: 3.6267 - val_accuracy300: 0.3300 - 74s/epoch - 47ms/step
Epoch 6/50
1570/1570 - 73s - loss: 3.1718 - accuracy300: 0.4364 - val_loss: 3.6684 - val_accuracy300: 0.3346 - 73s/epoch - 47ms/step
Epoch 7/50
1570/1570 - 73s - loss: 3.1639 - accuracy300: 0.4390 - val_loss: 3.7268 - val_accuracy300: 0.3368 - 73s/epoch - 47ms/step
Epoch 8/50
1570/1570 - 73s - loss: 3.1542 - accuracy300: 0.4433 - val_loss: 3.7870 - val_accuracy300: 0.3331 - 73s/epoch - 47ms/step
Epoch 9/50
1570/1570 - 74s - loss: 3.1468 - accuracy300: 0.4451 - val_loss: 3.8906 - val_accuracy300: 0.3350 - 74s/epoch - 47ms/step
Epoch 10/50
1570/1570 - 73s - loss: 3.1350 - accuracy300: 0.4508 - val_loss: 3.9453 - val_accuracy300: 0.3352 - 73s/epoch - 47ms/step
Epoch 11/50
1570/1570 - 75s - loss: 3.1253 - accuracy300: 0.4538 - val_loss: 4.0402 - val_accuracy300: 0.3374 - 75s/epoch - 47ms/step
testing model: results/EXC/W5/deepLOB_L2/h300
Evaluating performance on  test set...
7167/7167 - 136s - 136s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1819812
{'0': {'precision': 0.34698070556929544, 'recall': 0.4955765082289066, 'f1-score': 0.4081752162886786, 'support': 618855}, '1': {'precision': 0.2942979488206666, 'recall': 0.4869492624586622, 'f1-score': 0.36687022251675466, 'support': 558206}, '2': {'precision': 0.4740341286843466, 'recall': 0.01951909476661952, 'f1-score': 0.0374943031096257, 'support': 657510}, 'accuracy': 0.3223325780250533, 'macro avg': {'precision': 0.3717709276914362, 'recall': 0.33401495515139606, 'f1-score': 0.270846580638353, 'support': 1834571}, 'weighted avg': {'precision': 0.3764868218868172, 'recall': 0.3223325780250533, 'f1-score': 0.26275533197904455, 'support': 1834571}}
[[306690 306351   5814]
 [277962 271818   8426]
 [299230 345446  12834]]
Evaluating performance on  train set...
1570/1570 - 31s - 31s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1369514
{'0': {'precision': 0.3657479331964712, 'recall': 0.3862181599800794, 'f1-score': 0.37570442353041755, 'support': 136542}, '1': {'precision': 0.33111767298006317, 'recall': 0.6007786113518845, 'f1-score': 0.4269325226672331, 'support': 133828}, '2': {'precision': 0.4199891141651925, 'recall': 0.04700408896740248, 'f1-score': 0.0845460086148452, 'support': 131329}, 'accuracy': 0.3467994692543422, 'macro avg': {'precision': 0.37228490678057563, 'recall': 0.3446669534331221, 'f1-score': 0.29572765160416525, 'support': 401699}, 'weighted avg': {'precision': 0.37194396951022796, 'recall': 0.3467994692543422, 'f1-score': 0.2975817759232155, 'support': 401699}}
[[52735 80285  3522]
 [48424 80401  5003]
 [43025 82131  6173]]
Evaluating performance on  val set...
492/492 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.144564
{'0': {'precision': 0.36341593141855955, 'recall': 0.5258261656858307, 'f1-score': 0.42978983201361654, 'support': 44180}, '1': {'precision': 0.3196245563994561, 'recall': 0.4756898168715139, 'f1-score': 0.38234477286252727, 'support': 40518}, '2': {'precision': 0.3937007874015748, 'recall': 0.014615609470914937, 'f1-score': 0.02818489289740699, 'support': 41052}, 'accuracy': 0.34278330019880715, 'macro avg': {'precision': 0.3589137584065301, 'recall': 0.33871053067608653, 'f1-score': 0.28010649925785025, 'support': 125750}, 'weighted avg': {'precision': 0.35919259125784947, 'recall': 0.34278330019880715, 'f1-score': 0.2833956779994418, 'support': 125750}}
[[23231 20570   379]
 [20699 19274   545]
 [19994 20458   600]]
training model: results/EXC/W5/deepLOB_L2/h500
Epoch 1/50
1570/1570 - 78s - loss: 3.2238 - accuracy500: 0.4167 - val_loss: 3.4780 - val_accuracy500: 0.3284 - 78s/epoch - 50ms/step
Epoch 2/50
1570/1570 - 74s - loss: 3.1944 - accuracy500: 0.4312 - val_loss: 3.3994 - val_accuracy500: 0.3489 - 74s/epoch - 47ms/step
Epoch 3/50
1570/1570 - 73s - loss: 3.1621 - accuracy500: 0.4470 - val_loss: 3.4362 - val_accuracy500: 0.3336 - 73s/epoch - 47ms/step
Epoch 4/50
1570/1570 - 73s - loss: 3.1534 - accuracy500: 0.4508 - val_loss: 3.5506 - val_accuracy500: 0.2966 - 73s/epoch - 47ms/step
Epoch 5/50
1570/1570 - 74s - loss: 3.1266 - accuracy500: 0.4637 - val_loss: 3.5061 - val_accuracy500: 0.3148 - 74s/epoch - 47ms/step
Epoch 6/50
1570/1570 - 75s - loss: 3.1086 - accuracy500: 0.4688 - val_loss: 3.5701 - val_accuracy500: 0.3205 - 75s/epoch - 48ms/step
Epoch 7/50
1570/1570 - 76s - loss: 3.0944 - accuracy500: 0.4736 - val_loss: 3.5438 - val_accuracy500: 0.3087 - 76s/epoch - 48ms/step
Epoch 8/50
1570/1570 - 75s - loss: 3.0849 - accuracy500: 0.4769 - val_loss: 3.6483 - val_accuracy500: 0.3006 - 75s/epoch - 48ms/step
Epoch 9/50
1570/1570 - 73s - loss: 3.0759 - accuracy500: 0.4795 - val_loss: 3.6165 - val_accuracy500: 0.3029 - 73s/epoch - 47ms/step
Epoch 10/50
1570/1570 - 74s - loss: 3.0611 - accuracy500: 0.4833 - val_loss: 3.5846 - val_accuracy500: 0.3158 - 74s/epoch - 47ms/step
Epoch 11/50
1570/1570 - 74s - loss: 3.0512 - accuracy500: 0.4866 - val_loss: 3.5360 - val_accuracy500: 0.3244 - 74s/epoch - 47ms/step
Epoch 12/50
1570/1570 - 74s - loss: 3.0417 - accuracy500: 0.4890 - val_loss: 3.5710 - val_accuracy500: 0.3206 - 74s/epoch - 47ms/step
testing model: results/EXC/W5/deepLOB_L2/h500
Evaluating performance on  test set...
7167/7167 - 135s - 135s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1678257
{'0': {'precision': 0.3553959391278759, 'recall': 0.8647760603612044, 'f1-score': 0.503761601210429, 'support': 652207}, '1': {'precision': 0.25800994577631403, 'recall': 0.12976054450847097, 'f1-score': 0.17267694108413292, 'support': 486604}, '2': {'precision': 0.3613356766256591, 'recall': 0.0014775209842474415, 'f1-score': 0.0029430078513609263, 'support': 695760}, 'accuracy': 0.34241411207306777, 'macro avg': {'precision': 0.324913853843283, 'recall': 0.33200470861797426, 'f1-score': 0.22646051671530762, 'support': 1834571}, 'weighted avg': {'precision': 0.33181779353013896, 'recall': 0.34241411207306777, 'f1-score': 0.22600911058913314, 'support': 1834571}}
[[564013  87144   1050]
 [422695  63142    767]
 [600291  94441   1028]]
Evaluating performance on  train set...
1570/1570 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1326386
{'0': {'precision': 0.34149373591160614, 'recall': 0.6936853257477904, 'f1-score': 0.45767771434043114, 'support': 137806}, '1': {'precision': 0.33460813657022503, 'recall': 0.22540080796314135, 'f1-score': 0.26935621321839853, 'support': 133917}, '2': {'precision': 0.3540557667934094, 'recall': 0.08596971748630516, 'f1-score': 0.1383468700475436, 'support': 129976}, 'accuracy': 0.34093438121578595, 'macro avg': {'precision': 0.3433858797584135, 'recall': 0.33501861706574565, 'f1-score': 0.2884602658687911, 'support': 401699}, 'weighted avg': {'precision': 0.34326288076607064, 'recall': 0.34093438121578595, 'f1-score': 0.2915712607929451, 'support': 401699}}
[[95594 31447 10765]
 [94111 30185  9621]
 [90224 28578 11174]]
Evaluating performance on  val set...
492/492 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1310139
{'0': {'precision': 0.37016194210794146, 'recall': 0.5219042795644467, 'f1-score': 0.43312726572214144, 'support': 47388}, '1': {'precision': 0.27141209770416186, 'recall': 0.14733667197814707, 'f1-score': 0.1909925860351887, 'support': 35144}, '2': {'precision': 0.35270209242811984, 'recall': 0.3252811328613078, 'f1-score': 0.3384370937454861, 'support': 43218}, 'accuracy': 0.34964612326043737, 'macro avg': {'precision': 0.3314253774134077, 'recall': 0.33150736146796717, 'f1-score': 0.32085231516760543, 'support': 125750}, 'weighted avg': {'precision': 0.3365631801581287, 'recall': 0.34964612326043737, 'f1-score': 0.3329133409873076, 'support': 125750}}
[[24732  7134 15522]
 [19688  5178 10278]
 [22394  6766 14058]]
training model: results/EXC/W5/deepLOB_L2/h1000
Epoch 1/50
1570/1570 - 77s - loss: 3.2114 - accuracy1000: 0.4290 - val_loss: 3.3576 - val_accuracy1000: 0.3473 - 77s/epoch - 49ms/step
Epoch 2/50
1570/1570 - 74s - loss: 3.1881 - accuracy1000: 0.4334 - val_loss: 3.3755 - val_accuracy1000: 0.3517 - 74s/epoch - 47ms/step
Epoch 3/50
1570/1570 - 74s - loss: 3.1497 - accuracy1000: 0.4459 - val_loss: 3.4332 - val_accuracy1000: 0.3559 - 74s/epoch - 47ms/step
Epoch 4/50
1570/1570 - 75s - loss: 3.1196 - accuracy1000: 0.4593 - val_loss: 3.4780 - val_accuracy1000: 0.3593 - 75s/epoch - 48ms/step
Epoch 5/50
1570/1570 - 75s - loss: 3.1005 - accuracy1000: 0.4655 - val_loss: 3.4508 - val_accuracy1000: 0.3475 - 75s/epoch - 48ms/step
Epoch 6/50
1570/1570 - 75s - loss: 3.0739 - accuracy1000: 0.4775 - val_loss: 3.5442 - val_accuracy1000: 0.3401 - 75s/epoch - 48ms/step
Epoch 7/50
1570/1570 - 74s - loss: 3.0566 - accuracy1000: 0.4843 - val_loss: 3.5275 - val_accuracy1000: 0.3489 - 74s/epoch - 47ms/step
Epoch 8/50
1570/1570 - 74s - loss: 3.0308 - accuracy1000: 0.4931 - val_loss: 3.5972 - val_accuracy1000: 0.3551 - 74s/epoch - 47ms/step
Epoch 9/50
1570/1570 - 75s - loss: 3.0192 - accuracy1000: 0.4956 - val_loss: 3.5770 - val_accuracy1000: 0.3538 - 75s/epoch - 47ms/step
Epoch 10/50
1570/1570 - 75s - loss: 3.0034 - accuracy1000: 0.5007 - val_loss: 3.6579 - val_accuracy1000: 0.3557 - 75s/epoch - 48ms/step
Epoch 11/50
1570/1570 - 75s - loss: 2.9861 - accuracy1000: 0.5067 - val_loss: 3.6456 - val_accuracy1000: 0.3556 - 75s/epoch - 48ms/step
testing model: results/EXC/W5/deepLOB_L2/h1000
Evaluating performance on  test set...
7167/7167 - 135s - 135s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1451856
{'0': {'precision': 0.38539500212001815, 'recall': 0.6486486867658321, 'f1-score': 0.48351141194163066, 'support': 709051}, '1': {'precision': 0.18730100224934304, 'recall': 0.3111033977610635, 'f1-score': 0.2338260986564587, 'support': 365888}, '2': {'precision': 0.393728327155327, 'recall': 0.017338658718958653, 'f1-score': 0.03321464056770783, 'support': 759632}, 'accuracy': 0.31992493067861644, 'macro avg': {'precision': 0.32214144384156274, 'recall': 0.32569691441528476, 'f1-score': 0.2501840503885991, 'support': 1834571}, 'weighted avg': {'precision': 0.34933754941774614, 'recall': 0.31992493067861644, 'f1-score': 0.2472617944890487, 'support': 1834571}}
[[459925 236004  13122]
 [244900 113829   7159]
 [488561 257900  13171]]
Evaluating performance on  train set...
1570/1570 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1218985
{'0': {'precision': 0.33727083372426864, 'recall': 0.5152472891717371, 'f1-score': 0.4076813809020208, 'support': 139533}, '1': {'precision': 0.3073726045366877, 'recall': 0.35945806373219114, 'f1-score': 0.33138116325066075, 'support': 131676}, '2': {'precision': 0.3286632316331847, 'recall': 0.08701049888880374, 'f1-score': 0.13759422186674422, 'support': 130490}, 'accuracy': 0.3250692682829681, 'macro avg': {'precision': 0.32443555663138035, 'recall': 0.3205719505975773, 'f1-score': 0.2922189220064752, 'support': 401699}, 'weighted avg': {'precision': 0.32467412518536404, 'recall': 0.3250692682829681, 'f1-score': 0.29493382404483737, 'support': 401699}}
[[71894 54953 12686]
 [73838 47332 10506]
 [67432 51704 11354]]
Evaluating performance on  val set...
492/492 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1191562
{'0': {'precision': 0.36740363855462016, 'recall': 0.4690898989251448, 'f1-score': 0.41206614983199746, 'support': 46797}, '1': {'precision': 0.26975390649712155, 'recall': 0.1184115523465704, 'f1-score': 0.1645791921570141, 'support': 36010}, '2': {'precision': 0.3465752878830139, 'recall': 0.4050951260973849, 'f1-score': 0.37355723289347953, 'support': 42943}, 'accuracy': 0.3468151093439364, 'macro avg': {'precision': 0.32791094431158524, 'recall': 0.3308655257897, 'f1-score': 0.31673419162749705, 'support': 125750}, 'weighted avg': {'precision': 0.3323277044450272, 'recall': 0.3468151093439364, 'f1-score': 0.32804472823385095, 'support': 125750}}
[[21952  5912 18933]
 [17881  4264 13865]
 [19916  5631 17396]]
training model: results/EXC/W5/deepOF_L2/h10
Epoch 1/50
1570/1570 - 48s - loss: 2.6223 - accuracy10: 0.5397 - val_loss: 3.0402 - val_accuracy10: 0.6546 - 48s/epoch - 30ms/step
Epoch 2/50
1570/1570 - 45s - loss: 2.2383 - accuracy10: 0.6263 - val_loss: 2.8345 - val_accuracy10: 0.6262 - 45s/epoch - 29ms/step
Epoch 3/50
1570/1570 - 45s - loss: 2.1639 - accuracy10: 0.6359 - val_loss: 2.7250 - val_accuracy10: 0.6257 - 45s/epoch - 28ms/step
Epoch 4/50
1570/1570 - 45s - loss: 2.1282 - accuracy10: 0.6416 - val_loss: 2.7371 - val_accuracy10: 0.6358 - 45s/epoch - 29ms/step
Epoch 5/50
1570/1570 - 44s - loss: 2.1045 - accuracy10: 0.6450 - val_loss: 2.7079 - val_accuracy10: 0.6452 - 44s/epoch - 28ms/step
Epoch 6/50
1570/1570 - 45s - loss: 2.0885 - accuracy10: 0.6463 - val_loss: 2.7414 - val_accuracy10: 0.6400 - 45s/epoch - 29ms/step
Epoch 7/50
1570/1570 - 45s - loss: 2.0758 - accuracy10: 0.6483 - val_loss: 2.7158 - val_accuracy10: 0.6408 - 45s/epoch - 28ms/step
Epoch 8/50
1570/1570 - 45s - loss: 2.0671 - accuracy10: 0.6496 - val_loss: 2.7366 - val_accuracy10: 0.6612 - 45s/epoch - 28ms/step
Epoch 9/50
1570/1570 - 44s - loss: 2.0560 - accuracy10: 0.6506 - val_loss: 2.7245 - val_accuracy10: 0.6513 - 44s/epoch - 28ms/step
Epoch 10/50
1570/1570 - 46s - loss: 2.0476 - accuracy10: 0.6535 - val_loss: 2.7228 - val_accuracy10: 0.6518 - 46s/epoch - 29ms/step
Epoch 11/50
1570/1570 - 47s - loss: 2.0394 - accuracy10: 0.6533 - val_loss: 2.7152 - val_accuracy10: 0.6637 - 47s/epoch - 30ms/step
Epoch 12/50
1570/1570 - 48s - loss: 2.0337 - accuracy10: 0.6544 - val_loss: 2.7314 - val_accuracy10: 0.6470 - 48s/epoch - 31ms/step
Epoch 13/50
1570/1570 - 45s - loss: 2.0270 - accuracy10: 0.6551 - val_loss: 2.7770 - val_accuracy10: 0.6520 - 45s/epoch - 29ms/step
Epoch 14/50
1570/1570 - 45s - loss: 2.0223 - accuracy10: 0.6566 - val_loss: 2.7199 - val_accuracy10: 0.6431 - 45s/epoch - 29ms/step
Epoch 15/50
1570/1570 - 45s - loss: 2.0165 - accuracy10: 0.6570 - val_loss: 2.7439 - val_accuracy10: 0.6541 - 45s/epoch - 29ms/step
testing model: results/EXC/W5/deepOF_L2/h10
Evaluating performance on  test set...
7167/7167 - 108s - 108s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77890426
{'0': {'precision': 0.39597879305849293, 'recall': 0.5577616524952144, 'f1-score': 0.46314862077835267, 'support': 269556}, '1': {'precision': 0.8683767847165258, 'recall': 0.6773258801520412, 'f1-score': 0.7610442595202921, 'support': 1294123}, '2': {'precision': 0.3529109377630619, 'recall': 0.5803637679179879, 'f1-score': 0.4389205457575918, 'support': 270887}, 'accuracy': 0.6454409380747272, 'macro avg': {'precision': 0.5390888385126935, 'recall': 0.6051504335217479, 'f1-score': 0.5543711420187455, 'support': 1834566}, 'weighted avg': {'precision': 0.7228542415520631, 'recall': 0.6454409380747272, 'f1-score': 0.669710023931734, 'support': 1834566}}
[[150348  67612  51596]
 [180914 876543 236666]
 [ 48425  65249 157213]]
Evaluating performance on  train set...
1570/1570 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69635636
{'0': {'precision': 0.37763024930606187, 'recall': 0.5872687487567138, 'f1-score': 0.4596759753049896, 'support': 50270}, '1': {'precision': 0.9004156241599636, 'recall': 0.7235792622133599, 'f1-score': 0.8023696114832184, 'support': 300900}, '2': {'precision': 0.3644162169438428, 'recall': 0.5893447327277405, 'f1-score': 0.45035766677253, 'support': 50529}, 'accuracy': 0.6896357720581828, 'macro avg': {'precision': 0.5474873634699561, 'recall': 0.6333975812326047, 'f1-score': 0.5708010845202459, 'support': 401699}, 'weighted avg': {'precision': 0.7675700486391656, 'recall': 0.6896357720581828, 'f1-score': 0.715204792439691, 'support': 401699}}
[[ 29522  11297   9451]
 [ 40688 217725  42487]
 [  7967  12783  29779]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7907358
{'0': {'precision': 0.3895633565167291, 'recall': 0.5108472746896924, 'f1-score': 0.44203693758901674, 'support': 18530}, '1': {'precision': 0.8946252929148196, 'recall': 0.6750495540138751, 'f1-score': 0.7694796233415281, 'support': 88792}, '2': {'precision': 0.34616277719725996, 'recall': 0.6471673540264814, 'f1-score': 0.4510590015128593, 'support': 18428}, 'accuracy': 0.6467673956262425, 'macro avg': {'precision': 0.5434504755429362, 'recall': 0.6110213942433497, 'f1-score': 0.5541918541478014, 'support': 125750}, 'weighted avg': {'precision': 0.7398271623295329, 'recall': 0.6467673956262425, 'f1-score': 0.6745661586413075, 'support': 125750}}
[[ 9466  3590  5474]
 [11801 59939 17052]
 [ 3032  3470 11926]]
training model: results/EXC/W5/deepOF_L2/h20
Epoch 1/50
1570/1570 - 50s - loss: 2.6826 - accuracy20: 0.5373 - val_loss: 2.9331 - val_accuracy20: 0.6325 - 50s/epoch - 32ms/step
Epoch 2/50
1570/1570 - 48s - loss: 2.3437 - accuracy20: 0.6149 - val_loss: 2.7626 - val_accuracy20: 0.6042 - 48s/epoch - 30ms/step
Epoch 3/50
1570/1570 - 46s - loss: 2.2766 - accuracy20: 0.6279 - val_loss: 2.7126 - val_accuracy20: 0.6121 - 46s/epoch - 29ms/step
Epoch 4/50
1570/1570 - 46s - loss: 2.2438 - accuracy20: 0.6330 - val_loss: 2.6987 - val_accuracy20: 0.6222 - 46s/epoch - 29ms/step
Epoch 5/50
1570/1570 - 46s - loss: 2.2239 - accuracy20: 0.6362 - val_loss: 2.6701 - val_accuracy20: 0.6251 - 46s/epoch - 29ms/step
Epoch 6/50
1570/1570 - 46s - loss: 2.2081 - accuracy20: 0.6374 - val_loss: 2.6803 - val_accuracy20: 0.6222 - 46s/epoch - 29ms/step
Epoch 7/50
1570/1570 - 45s - loss: 2.1966 - accuracy20: 0.6392 - val_loss: 2.6651 - val_accuracy20: 0.6205 - 45s/epoch - 29ms/step
Epoch 8/50
1570/1570 - 46s - loss: 2.1861 - accuracy20: 0.6404 - val_loss: 2.6595 - val_accuracy20: 0.6279 - 46s/epoch - 30ms/step
Epoch 9/50
1570/1570 - 48s - loss: 2.1777 - accuracy20: 0.6416 - val_loss: 2.6599 - val_accuracy20: 0.6324 - 48s/epoch - 30ms/step
Epoch 10/50
1570/1570 - 46s - loss: 2.1705 - accuracy20: 0.6427 - val_loss: 2.6459 - val_accuracy20: 0.6267 - 46s/epoch - 29ms/step
Epoch 11/50
1570/1570 - 46s - loss: 2.1620 - accuracy20: 0.6432 - val_loss: 2.6559 - val_accuracy20: 0.6284 - 46s/epoch - 29ms/step
Epoch 12/50
1570/1570 - 46s - loss: 2.1576 - accuracy20: 0.6431 - val_loss: 2.6818 - val_accuracy20: 0.6321 - 46s/epoch - 29ms/step
Epoch 13/50
1570/1570 - 44s - loss: 2.1517 - accuracy20: 0.6444 - val_loss: 2.6645 - val_accuracy20: 0.6247 - 44s/epoch - 28ms/step
Epoch 14/50
1570/1570 - 45s - loss: 2.1448 - accuracy20: 0.6455 - val_loss: 2.6817 - val_accuracy20: 0.6308 - 45s/epoch - 29ms/step
Epoch 15/50
1570/1570 - 45s - loss: 2.1391 - accuracy20: 0.6462 - val_loss: 2.6949 - val_accuracy20: 0.6203 - 45s/epoch - 29ms/step
Epoch 16/50
1570/1570 - 45s - loss: 2.1325 - accuracy20: 0.6472 - val_loss: 2.6724 - val_accuracy20: 0.6271 - 45s/epoch - 29ms/step
Epoch 17/50
1570/1570 - 46s - loss: 2.1274 - accuracy20: 0.6477 - val_loss: 2.6737 - val_accuracy20: 0.6236 - 46s/epoch - 30ms/step
Epoch 18/50
1570/1570 - 46s - loss: 2.1221 - accuracy20: 0.6483 - val_loss: 2.7062 - val_accuracy20: 0.6141 - 46s/epoch - 29ms/step
Epoch 19/50
1570/1570 - 46s - loss: 2.1167 - accuracy20: 0.6484 - val_loss: 2.6944 - val_accuracy20: 0.6303 - 46s/epoch - 29ms/step
Epoch 20/50
1570/1570 - 47s - loss: 2.1114 - accuracy20: 0.6492 - val_loss: 2.7101 - val_accuracy20: 0.6224 - 47s/epoch - 30ms/step
testing model: results/EXC/W5/deepOF_L2/h20
Evaluating performance on  test set...
7167/7167 - 104s - 104s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8364573
{'0': {'precision': 0.45531218070354695, 'recall': 0.5588171901548211, 'f1-score': 0.5017826734446378, 'support': 357251}, '1': {'precision': 0.7903763188477462, 'recall': 0.6493676515725713, 'f1-score': 0.7129667837801724, 'support': 1117501}, '2': {'precision': 0.42041253548855473, 'recall': 0.5584690979228156, 'f1-score': 0.47970541368012076, 'support': 359814}, 'accuracy': 0.6139065043176424, 'macro avg': {'precision': 0.5553670116799493, 'recall': 0.5888846465500693, 'f1-score': 0.5648182903016438, 'support': 1834566}, 'weighted avg': {'precision': 0.6525670783179656, 'recall': 0.6139065043176424, 'f1-score': 0.6260925905253862, 'support': 1834566}}
[[199638 109113  48500]
 [163306 725669 228526]
 [ 75520  83349 200945]]
Evaluating performance on  train set...
1570/1570 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.73376817
{'0': {'precision': 0.4618342270142564, 'recall': 0.5860705730200021, 'f1-score': 0.5165878619081546, 'support': 68043}, '1': {'precision': 0.8409787422497785, 'recall': 0.7152871424374148, 'f1-score': 0.7730572099707295, 'support': 265478}, '2': {'precision': 0.4397891727711274, 'recall': 0.5776643492035554, 'f1-score': 0.4993850250427946, 'support': 68178}, 'accuracy': 0.6700414987341268, 'macro avg': {'precision': 0.5808673806783874, 'recall': 0.6263406882203241, 'f1-score': 0.5963433656405596, 'support': 401699}, 'weighted avg': {'precision': 0.7086646644998064, 'recall': 0.6700414987341268, 'f1-score': 0.6831656093587326, 'support': 401699}}
[[ 39878  19028   9137]
 [ 34554 189893  41031]
 [ 11915  16879  39384]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8202752
{'0': {'precision': 0.44796806024409247, 'recall': 0.5709262400198568, 'f1-score': 0.5020279732998673, 'support': 24173}, '1': {'precision': 0.8344159544159544, 'recall': 0.661171310629515, 'f1-score': 0.737759545143762, 'support': 77520}, '2': {'precision': 0.41179103141689294, 'recall': 0.5737207465602527, 'f1-score': 0.47945253065619897, 'support': 24057}, 'accuracy': 0.6270934393638171, 'macro avg': {'precision': 0.5647250153589799, 'recall': 0.6019394324032082, 'f1-score': 0.5730800163666093, 'support': 125750}, 'weighted avg': {'precision': 0.6792772449256576, 'recall': 0.6270934393638171, 'f1-score': 0.6430284824502449, 'support': 125750}}
[[13801  5792  4580]
 [11131 51254 15135]
 [ 5876  4379 13802]]
training model: results/EXC/W5/deepOF_L2/h30
Epoch 1/50
1570/1570 - 49s - loss: 2.7724 - accuracy30: 0.5259 - val_loss: 3.1093 - val_accuracy30: 0.5962 - 49s/epoch - 31ms/step
Epoch 2/50
1570/1570 - 48s - loss: 2.4738 - accuracy30: 0.5962 - val_loss: 2.8541 - val_accuracy30: 0.6015 - 48s/epoch - 31ms/step
Epoch 3/50
1570/1570 - 48s - loss: 2.4062 - accuracy30: 0.6081 - val_loss: 2.8102 - val_accuracy30: 0.6080 - 48s/epoch - 31ms/step
Epoch 4/50
1570/1570 - 48s - loss: 2.3761 - accuracy30: 0.6140 - val_loss: 2.7809 - val_accuracy30: 0.6067 - 48s/epoch - 31ms/step
Epoch 5/50
1570/1570 - 48s - loss: 2.3574 - accuracy30: 0.6174 - val_loss: 2.7677 - val_accuracy30: 0.6076 - 48s/epoch - 31ms/step
Epoch 6/50
1570/1570 - 48s - loss: 2.3413 - accuracy30: 0.6191 - val_loss: 2.7523 - val_accuracy30: 0.6164 - 48s/epoch - 31ms/step
Epoch 7/50
1570/1570 - 48s - loss: 2.3306 - accuracy30: 0.6206 - val_loss: 2.7495 - val_accuracy30: 0.6116 - 48s/epoch - 30ms/step
Epoch 8/50
1570/1570 - 48s - loss: 2.3219 - accuracy30: 0.6222 - val_loss: 2.7279 - val_accuracy30: 0.6083 - 48s/epoch - 30ms/step
Epoch 9/50
1570/1570 - 49s - loss: 2.3127 - accuracy30: 0.6234 - val_loss: 2.7250 - val_accuracy30: 0.6121 - 49s/epoch - 31ms/step
Epoch 10/50
1570/1570 - 46s - loss: 2.3057 - accuracy30: 0.6234 - val_loss: 2.7239 - val_accuracy30: 0.6191 - 46s/epoch - 30ms/step
Epoch 11/50
1570/1570 - 47s - loss: 2.2997 - accuracy30: 0.6252 - val_loss: 2.7115 - val_accuracy30: 0.6148 - 47s/epoch - 30ms/step
Epoch 12/50
1570/1570 - 46s - loss: 2.2933 - accuracy30: 0.6256 - val_loss: 2.7520 - val_accuracy30: 0.6108 - 46s/epoch - 30ms/step
Epoch 13/50
1570/1570 - 46s - loss: 2.2894 - accuracy30: 0.6268 - val_loss: 2.7512 - val_accuracy30: 0.6183 - 46s/epoch - 29ms/step
Epoch 14/50
1570/1570 - 46s - loss: 2.2816 - accuracy30: 0.6271 - val_loss: 2.7608 - val_accuracy30: 0.6193 - 46s/epoch - 29ms/step
Epoch 15/50
1570/1570 - 46s - loss: 2.2778 - accuracy30: 0.6272 - val_loss: 2.7386 - val_accuracy30: 0.6113 - 46s/epoch - 29ms/step
Epoch 16/50
1570/1570 - 47s - loss: 2.2730 - accuracy30: 0.6286 - val_loss: 2.7826 - val_accuracy30: 0.6057 - 47s/epoch - 30ms/step
Epoch 17/50
1570/1570 - 47s - loss: 2.2668 - accuracy30: 0.6293 - val_loss: 2.7597 - val_accuracy30: 0.6168 - 47s/epoch - 30ms/step
Epoch 18/50
1570/1570 - 46s - loss: 2.2612 - accuracy30: 0.6297 - val_loss: 2.7543 - val_accuracy30: 0.6145 - 46s/epoch - 29ms/step
Epoch 19/50
1570/1570 - 47s - loss: 2.2577 - accuracy30: 0.6293 - val_loss: 2.7562 - val_accuracy30: 0.6126 - 47s/epoch - 30ms/step
Epoch 20/50
1570/1570 - 47s - loss: 2.2515 - accuracy30: 0.6315 - val_loss: 2.7613 - val_accuracy30: 0.6092 - 47s/epoch - 30ms/step
Epoch 21/50
1570/1570 - 48s - loss: 2.2442 - accuracy30: 0.6321 - val_loss: 2.7824 - val_accuracy30: 0.6051 - 48s/epoch - 31ms/step
testing model: results/EXC/W5/deepOF_L2/h30
Evaluating performance on  test set...
7167/7167 - 110s - 110s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.861686
{'0': {'precision': 0.48426015963471375, 'recall': 0.5166035630778726, 'f1-score': 0.49990926486161175, 'support': 421265}, '1': {'precision': 0.7060130769870504, 'recall': 0.6775210635847494, 'f1-score': 0.691473693055837, 'support': 989860}, '2': {'precision': 0.4754211353422845, 'recall': 0.48868201237008224, 'f1-score': 0.48196037466242303, 'support': 423441}, 'accuracy': 0.5969837007771865, 'macro avg': {'precision': 0.5552314573213496, 'recall': 0.5609355463442348, 'f1-score': 0.5577811108599572, 'support': 1834566}, 'weighted avg': {'precision': 0.6018691949514989, 'recall': 0.5969837007771865, 'f1-score': 0.5991271010569305, 'support': 1834566}}
[[217627 141647  61991]
 [152876 670651 166333]
 [ 78898 137615 206928]]
Evaluating performance on  train set...
1570/1570 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77262455
{'0': {'precision': 0.4880643767552387, 'recall': 0.5596150749910209, 'f1-score': 0.5213964678663536, 'support': 80743}, '1': {'precision': 0.7712080793520346, 'recall': 0.7312401033419451, 'f1-score': 0.7506924793004837, 'support': 239980}, '2': {'precision': 0.49948514268902616, 'recall': 0.5031861292234736, 'f1-score': 0.5013288055514543, 'support': 80976}, 'accuracy': 0.6507708508111795, 'macro avg': {'precision': 0.5862525329320999, 'recall': 0.5980137691854799, 'f1-score': 0.5911392509060972, 'support': 401699}, 'weighted avg': {'precision': 0.6595202023645469, 'recall': 0.6507708508111795, 'f1-score': 0.6543354540235291, 'support': 401699}}
[[ 45185  24826  10732]
 [ 34399 175483  30098]
 [ 12996  27234  40746]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.834281
{'0': {'precision': 0.4688919796012981, 'recall': 0.5399893219434063, 'f1-score': 0.5019354838709678, 'support': 28095}, '1': {'precision': 0.7644456511323346, 'recall': 0.6864924559692502, 'f1-score': 0.7233749943326936, 'support': 69724}, '2': {'precision': 0.46632663006400055, 'recall': 0.5139092764312054, 'f1-score': 0.48896307398828176, 'support': 27931}, 'accuracy': 0.615427435387674, 'macro avg': {'precision': 0.5665547535992111, 'recall': 0.580130351447954, 'f1-score': 0.5714245173973144, 'support': 125750}, 'weighted avg': {'precision': 0.6321964043798566, 'recall': 0.615427435387674, 'f1-score': 0.6218346174455209, 'support': 125750}}
[[15171  7397  5527]
 [10959 47865 10900]
 [ 6225  7352 14354]]
training model: results/EXC/W5/deepOF_L2/h50
Epoch 1/50
1570/1570 - 50s - loss: 2.9163 - accuracy50: 0.5008 - val_loss: 3.1666 - val_accuracy50: 0.5489 - 50s/epoch - 32ms/step
Epoch 2/50
1570/1570 - 48s - loss: 2.6787 - accuracy50: 0.5621 - val_loss: 3.0726 - val_accuracy50: 0.5580 - 48s/epoch - 30ms/step
Epoch 3/50
1570/1570 - 48s - loss: 2.6174 - accuracy50: 0.5735 - val_loss: 2.9743 - val_accuracy50: 0.5656 - 48s/epoch - 31ms/step
Epoch 4/50
1570/1570 - 48s - loss: 2.5909 - accuracy50: 0.5780 - val_loss: 2.9350 - val_accuracy50: 0.5711 - 48s/epoch - 31ms/step
Epoch 5/50
1570/1570 - 48s - loss: 2.5741 - accuracy50: 0.5827 - val_loss: 2.9262 - val_accuracy50: 0.5742 - 48s/epoch - 31ms/step
Epoch 6/50
1570/1570 - 48s - loss: 2.5609 - accuracy50: 0.5855 - val_loss: 2.9102 - val_accuracy50: 0.5748 - 48s/epoch - 30ms/step
Epoch 7/50
1570/1570 - 50s - loss: 2.5508 - accuracy50: 0.5874 - val_loss: 2.9486 - val_accuracy50: 0.5744 - 50s/epoch - 32ms/step
Epoch 8/50
1570/1570 - 47s - loss: 2.5426 - accuracy50: 0.5894 - val_loss: 2.9478 - val_accuracy50: 0.5754 - 47s/epoch - 30ms/step
Epoch 9/50
1570/1570 - 48s - loss: 2.5408 - accuracy50: 0.5889 - val_loss: 2.9299 - val_accuracy50: 0.5754 - 48s/epoch - 30ms/step
Epoch 10/50
1570/1570 - 47s - loss: 2.5300 - accuracy50: 0.5911 - val_loss: 2.9413 - val_accuracy50: 0.5756 - 47s/epoch - 30ms/step
Epoch 11/50
1570/1570 - 47s - loss: 2.5236 - accuracy50: 0.5919 - val_loss: 2.9546 - val_accuracy50: 0.5755 - 47s/epoch - 30ms/step
Epoch 12/50
1570/1570 - 47s - loss: 2.5183 - accuracy50: 0.5927 - val_loss: 2.9746 - val_accuracy50: 0.5736 - 47s/epoch - 30ms/step
Epoch 13/50
1570/1570 - 46s - loss: 2.5122 - accuracy50: 0.5943 - val_loss: 2.9756 - val_accuracy50: 0.5768 - 46s/epoch - 30ms/step
Epoch 14/50
1570/1570 - 46s - loss: 2.5052 - accuracy50: 0.5953 - val_loss: 2.9676 - val_accuracy50: 0.5767 - 46s/epoch - 30ms/step
Epoch 15/50
1570/1570 - 48s - loss: 2.5013 - accuracy50: 0.5954 - val_loss: 2.9693 - val_accuracy50: 0.5754 - 48s/epoch - 30ms/step
Epoch 16/50
1570/1570 - 47s - loss: 2.4950 - accuracy50: 0.5962 - val_loss: 3.0019 - val_accuracy50: 0.5738 - 47s/epoch - 30ms/step
testing model: results/EXC/W5/deepOF_L2/h50
Evaluating performance on  test set...
7167/7167 - 105s - 105s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9569827
{'0': {'precision': 0.49419556605410186, 'recall': 0.4018570407157626, 'f1-score': 0.44326854519236614, 'support': 517490}, '1': {'precision': 0.5532431179219922, 'recall': 0.7307533820215854, 'f1-score': 0.6297280086346465, 'support': 798413}, '2': {'precision': 0.5420541232808063, 'recall': 0.3753786177151638, 'f1-score': 0.44357590138555525, 'support': 518663}, 'accuracy': 0.5375085987639583, 'macro avg': {'precision': 0.5298309357523001, 'recall': 0.5026630134841706, 'f1-score': 0.5055241517375225, 'support': 1834566}, 'weighted avg': {'precision': 0.5334238063552805, 'recall': 0.5375085987639583, 'f1-score': 0.5245036023506092, 'support': 1834566}}
[[207957 236082  73451]
 [123936 583443  91034]
 [ 88906 235062 194695]]
Evaluating performance on  train set...
1570/1570 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8702818
{'0': {'precision': 0.527125211915718, 'recall': 0.43166965817475034, 'f1-score': 0.47464576030007466, 'support': 100841}, '1': {'precision': 0.6319701714663175, 'recall': 0.7917917219236407, 'f1-score': 0.7029107220706335, 'support': 200578}, '2': {'precision': 0.561902795800401, 'recall': 0.37999601116872755, 'f1-score': 0.45338378069674473, 'support': 100280}, 'accuracy': 0.5985874995954682, 'macro avg': {'precision': 0.5736660597274789, 'recall': 0.5344857970890394, 'f1-score': 0.5436467543558177, 'support': 401699}, 'weighted avg': {'precision': 0.5881586932255948, 'recall': 0.5985874995954682, 'f1-score': 0.5833161283801378, 'support': 401699}}
[[ 43530  44697  12614]
 [ 24666 158816  17096]
 [ 14384  47790  38106]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9024425
{'0': {'precision': 0.4994139143625457, 'recall': 0.4243738098725648, 'f1-score': 0.4588460746583044, 'support': 34135}, '1': {'precision': 0.6279411764705882, 'recall': 0.751099384344767, 'f1-score': 0.684020824989988, 'support': 57987}, '2': {'precision': 0.5160677768039731, 'recall': 0.42024503390032114, 'f1-score': 0.46325313053169864, 'support': 33628}, 'accuracy': 0.5739324055666004, 'macro avg': {'precision': 0.5478076225457024, 'recall': 0.5319060760392177, 'f1-score': 0.5353733433933304, 'support': 125750}, 'weighted avg': {'precision': 0.5631351583708112, 'recall': 0.5739324055666004, 'f1-score': 0.563859265293643, 'support': 125750}}
[[14486 12979  6670]
 [ 7851 43554  6582]
 [ 6669 12827 14132]]
training model: results/EXC/W5/deepOF_L2/h100
Epoch 1/50
1570/1570 - 50s - loss: 3.1052 - accuracy100: 0.4530 - val_loss: 3.2742 - val_accuracy100: 0.4227 - 50s/epoch - 32ms/step
Epoch 2/50
1570/1570 - 47s - loss: 2.9693 - accuracy100: 0.4944 - val_loss: 3.1816 - val_accuracy100: 0.4435 - 47s/epoch - 30ms/step
Epoch 3/50
1570/1570 - 45s - loss: 2.9245 - accuracy100: 0.5051 - val_loss: 3.1496 - val_accuracy100: 0.4539 - 45s/epoch - 29ms/step
Epoch 4/50
1570/1570 - 46s - loss: 2.9063 - accuracy100: 0.5088 - val_loss: 3.1326 - val_accuracy100: 0.4587 - 46s/epoch - 29ms/step
Epoch 5/50
1570/1570 - 47s - loss: 2.8930 - accuracy100: 0.5126 - val_loss: 3.1164 - val_accuracy100: 0.4624 - 47s/epoch - 30ms/step
Epoch 6/50
1570/1570 - 45s - loss: 2.8844 - accuracy100: 0.5156 - val_loss: 3.1352 - val_accuracy100: 0.4607 - 45s/epoch - 29ms/step
Epoch 7/50
1570/1570 - 46s - loss: 2.8770 - accuracy100: 0.5177 - val_loss: 3.1295 - val_accuracy100: 0.4638 - 46s/epoch - 29ms/step
Epoch 8/50
1570/1570 - 46s - loss: 2.8696 - accuracy100: 0.5190 - val_loss: 3.1191 - val_accuracy100: 0.4675 - 46s/epoch - 29ms/step
Epoch 9/50
1570/1570 - 46s - loss: 2.8641 - accuracy100: 0.5207 - val_loss: 3.1261 - val_accuracy100: 0.4685 - 46s/epoch - 29ms/step
Epoch 10/50
1570/1570 - 46s - loss: 2.8582 - accuracy100: 0.5220 - val_loss: 3.1299 - val_accuracy100: 0.4647 - 46s/epoch - 29ms/step
Epoch 11/50
1570/1570 - 46s - loss: 2.8534 - accuracy100: 0.5244 - val_loss: 3.1270 - val_accuracy100: 0.4669 - 46s/epoch - 29ms/step
Epoch 12/50
1570/1570 - 46s - loss: 2.8469 - accuracy100: 0.5254 - val_loss: 3.1353 - val_accuracy100: 0.4681 - 46s/epoch - 30ms/step
Epoch 13/50
1570/1570 - 46s - loss: 2.8425 - accuracy100: 0.5265 - val_loss: 3.1310 - val_accuracy100: 0.4683 - 46s/epoch - 29ms/step
Epoch 14/50
1570/1570 - 47s - loss: 2.8382 - accuracy100: 0.5280 - val_loss: 3.1526 - val_accuracy100: 0.4694 - 47s/epoch - 30ms/step
Epoch 15/50
1570/1570 - 46s - loss: 2.8306 - accuracy100: 0.5292 - val_loss: 3.1964 - val_accuracy100: 0.4651 - 46s/epoch - 29ms/step
testing model: results/EXC/W5/deepOF_L2/h100
Evaluating performance on  test set...
7167/7167 - 104s - 104s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0872753
{'0': {'precision': 0.5327266642719204, 'recall': 0.26858689881167064, 'f1-score': 0.3571221286220885, 'support': 646033}, '1': {'precision': 0.3510303134956509, 'recall': 0.7807482100530724, 'f1-score': 0.484310813880362, 'support': 531161}, '2': {'precision': 0.5452888094910906, 'recall': 0.2716315875942389, 'f1-score': 0.3626244749131074, 'support': 657372}, 'accuracy': 0.41796370367705493, 'macro avg': {'precision': 0.4763485957528873, 'recall': 0.440322232152994, 'f1-score': 0.40135247247185263, 'support': 1834566}, 'weighted avg': {'precision': 0.48462154685032977, 'recall': 0.41796370367705493, 'f1-score': 0.3959186383341891, 'support': 1834566}}
[[173516 376512  96005]
 [ 63561 414703  52897]
 [ 88636 390173 178563]]
Evaluating performance on  train set...
1570/1570 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0249109
{'0': {'precision': 0.5754889099983413, 'recall': 0.2891220362093781, 'f1-score': 0.3848818389460044, 'support': 132010}, '1': {'precision': 0.4265981392006921, 'recall': 0.8284390150139889, 'f1-score': 0.5631873782531367, 'support': 140469}, '2': {'precision': 0.5675485685071575, 'recall': 0.2749110044884693, 'f1-score': 0.37040435426354973, 'support': 129220}, 'accuracy': 0.47314282584721395, 'macro avg': {'precision': 0.5232118725687304, 'recall': 0.4641573519039454, 'f1-score': 0.43949119048756363, 'support': 401699}, 'weighted avg': {'precision': 0.5208694346930363, 'recall': 0.47314282584721395, 'f1-score': 0.44257583427650504, 'support': 401699}}
[[ 38167  77186  16657]
 [ 13688 116370  10411]
 [ 14466  79230  35524]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0304093
{'0': {'precision': 0.5436810455040485, 'recall': 0.26694255225164487, 'f1-score': 0.35807397243185934, 'support': 43013}, '1': {'precision': 0.42125768706790084, 'recall': 0.8078622878769381, 'f1-score': 0.5537591216442391, 'support': 40955}, '2': {'precision': 0.5183595247221158, 'recall': 0.32368005361160307, 'f1-score': 0.3985148514851485, 'support': 41782}, 'accuracy': 0.4619642147117296, 'macro avg': {'precision': 0.49443275243135504, 'recall': 0.4661616312467287, 'f1-score': 0.43678264852041565, 'support': 125750}, 'weighted avg': {'precision': 0.49539609579380484, 'recall': 0.4619642147117296, 'f1-score': 0.4352428479356171, 'support': 125750}}
[[11482 22989  8542]
 [ 3845 33086  4024]
 [ 5792 22466 13524]]
training model: results/EXC/W5/deepOF_L2/h200
Epoch 1/50
1570/1570 - 50s - loss: 3.2440 - accuracy200: 0.3984 - val_loss: 3.3160 - val_accuracy200: 0.3499 - 50s/epoch - 32ms/step
Epoch 2/50
1570/1570 - 50s - loss: 3.2020 - accuracy200: 0.4185 - val_loss: 3.3029 - val_accuracy200: 0.3609 - 50s/epoch - 32ms/step
Epoch 3/50
1570/1570 - 48s - loss: 3.1814 - accuracy200: 0.4272 - val_loss: 3.2966 - val_accuracy200: 0.3651 - 48s/epoch - 31ms/step
Epoch 4/50
1570/1570 - 49s - loss: 3.1699 - accuracy200: 0.4320 - val_loss: 3.2795 - val_accuracy200: 0.3769 - 49s/epoch - 31ms/step
Epoch 5/50
1570/1570 - 51s - loss: 3.1603 - accuracy200: 0.4349 - val_loss: 3.2632 - val_accuracy200: 0.3804 - 51s/epoch - 32ms/step
Epoch 6/50
1570/1570 - 50s - loss: 3.1530 - accuracy200: 0.4378 - val_loss: 3.2701 - val_accuracy200: 0.3812 - 50s/epoch - 32ms/step
Epoch 7/50
1570/1570 - 49s - loss: 3.1483 - accuracy200: 0.4393 - val_loss: 3.2755 - val_accuracy200: 0.3809 - 49s/epoch - 31ms/step
Epoch 8/50
1570/1570 - 46s - loss: 3.1434 - accuracy200: 0.4414 - val_loss: 3.2741 - val_accuracy200: 0.3819 - 46s/epoch - 29ms/step
Epoch 9/50
1570/1570 - 47s - loss: 3.1396 - accuracy200: 0.4433 - val_loss: 3.2854 - val_accuracy200: 0.3817 - 47s/epoch - 30ms/step
Epoch 10/50
1570/1570 - 48s - loss: 3.1350 - accuracy200: 0.4447 - val_loss: 3.2810 - val_accuracy200: 0.3830 - 48s/epoch - 30ms/step
Epoch 11/50
1570/1570 - 49s - loss: 3.1317 - accuracy200: 0.4458 - val_loss: 3.2890 - val_accuracy200: 0.3842 - 49s/epoch - 31ms/step
Epoch 12/50
1570/1570 - 48s - loss: 3.1275 - accuracy200: 0.4472 - val_loss: 3.2941 - val_accuracy200: 0.3874 - 48s/epoch - 31ms/step
Epoch 13/50
1570/1570 - 46s - loss: 3.1232 - accuracy200: 0.4486 - val_loss: 3.3100 - val_accuracy200: 0.3871 - 46s/epoch - 29ms/step
Epoch 14/50
1570/1570 - 47s - loss: 3.1195 - accuracy200: 0.4500 - val_loss: 3.3206 - val_accuracy200: 0.3835 - 47s/epoch - 30ms/step
Epoch 15/50
1570/1570 - 47s - loss: 3.1167 - accuracy200: 0.4508 - val_loss: 3.3220 - val_accuracy200: 0.3859 - 47s/epoch - 30ms/step
testing model: results/EXC/W5/deepOF_L2/h200
Evaluating performance on  test set...
7167/7167 - 109s - 109s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.09384
{'0': {'precision': 0.47041415423675026, 'recall': 0.27274860078202867, 'f1-score': 0.3452939520708164, 'support': 652150}, '1': {'precision': 0.29438620659008596, 'recall': 0.6658210800325638, 'f1-score': 0.4082629756079523, 'support': 497485}, '2': {'precision': 0.48195887958801104, 'recall': 0.23310231249571126, 'f1-score': 0.3142268958337024, 'support': 684931}, 'accuracy': 0.3645374437332862, 'macro avg': {'precision': 0.4155864134716158, 'recall': 0.39055733110343455, 'f1-score': 0.35592794117082377, 'support': 1834566}, 'weighted avg': {'precision': 0.4269903018076545, 'recall': 0.3645374437332862, 'f1-score': 0.35077064507549943, 'support': 1834566}}
[[177873 375205  99072]
 [ 93709 331236  72540]
 [106538 418734 159659]]
Evaluating performance on  train set...
1570/1570 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.088704
{'0': {'precision': 0.4595562352826937, 'recall': 0.27997278730468605, 'f1-score': 0.3479599479820051, 'support': 135231}, '1': {'precision': 0.34659702437480217, 'recall': 0.6440825030331998, 'f1-score': 0.4506746588117258, 'support': 135995}, '2': {'precision': 0.4392353550673494, 'recall': 0.22418431399599917, 'f1-score': 0.2968548608080541, 'support': 130473}, 'accuracy': 0.38512169559794773, 'macro avg': {'precision': 0.4151295382416151, 'recall': 0.38274653477796167, 'f1-score': 0.36516315586726167, 'support': 401699}, 'weighted avg': {'precision': 0.4147136688542103, 'recall': 0.38512169559794773, 'f1-score': 0.36613488259832466, 'support': 401699}}
[[37861 81035 16335]
 [27395 87592 21008]
 [17130 84093 29250]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0867361
{'0': {'precision': 0.4751203852327448, 'recall': 0.2299258733188335, 'f1-score': 0.3098873816610083, 'support': 45058}, '1': {'precision': 0.33171014785285363, 'recall': 0.6911834288418064, 'f1-score': 0.44828232887221886, 'support': 38042}, '2': {'precision': 0.4505409895854439, 'recall': 0.2606799531066823, 'f1-score': 0.33026868863903036, 'support': 42650}, 'accuracy': 0.37989662027833004, 'macro avg': {'precision': 0.4191238408903475, 'recall': 0.39392975175577405, 'f1-score': 0.3628127997240858, 'support': 125750}, 'weighted avg': {'precision': 0.4233993238032163, 'recall': 0.37989662027833004, 'f1-score': 0.3586673683363285, 'support': 125750}}
[[10360 26966  7732]
 [ 5921 26294  5827]
 [ 5524 26008 11118]]
training model: results/EXC/W5/deepOF_L2/h300
Epoch 1/50
1570/1570 - 48s - loss: 3.2666 - accuracy300: 0.3846 - val_loss: 3.3285 - val_accuracy300: 0.3294 - 48s/epoch - 31ms/step
Epoch 2/50
1570/1570 - 47s - loss: 3.2363 - accuracy300: 0.4017 - val_loss: 3.3108 - val_accuracy300: 0.3361 - 47s/epoch - 30ms/step
Epoch 3/50
1570/1570 - 46s - loss: 3.2218 - accuracy300: 0.4091 - val_loss: 3.3073 - val_accuracy300: 0.3445 - 46s/epoch - 29ms/step
Epoch 4/50
1570/1570 - 47s - loss: 3.2109 - accuracy300: 0.4147 - val_loss: 3.3017 - val_accuracy300: 0.3514 - 47s/epoch - 30ms/step
Epoch 5/50
1570/1570 - 48s - loss: 3.2030 - accuracy300: 0.4189 - val_loss: 3.3091 - val_accuracy300: 0.3584 - 48s/epoch - 30ms/step
Epoch 6/50
1570/1570 - 47s - loss: 3.1961 - accuracy300: 0.4222 - val_loss: 3.3132 - val_accuracy300: 0.3623 - 47s/epoch - 30ms/step
Epoch 7/50
1570/1570 - 46s - loss: 3.1909 - accuracy300: 0.4250 - val_loss: 3.3069 - val_accuracy300: 0.3643 - 46s/epoch - 29ms/step
Epoch 8/50
1570/1570 - 47s - loss: 3.1860 - accuracy300: 0.4272 - val_loss: 3.3254 - val_accuracy300: 0.3664 - 47s/epoch - 30ms/step
Epoch 9/50
1570/1570 - 48s - loss: 3.1822 - accuracy300: 0.4288 - val_loss: 3.3283 - val_accuracy300: 0.3667 - 48s/epoch - 31ms/step
Epoch 10/50
1570/1570 - 48s - loss: 3.1768 - accuracy300: 0.4313 - val_loss: 3.3491 - val_accuracy300: 0.3645 - 48s/epoch - 31ms/step
Epoch 11/50
1570/1570 - 49s - loss: 3.1725 - accuracy300: 0.4338 - val_loss: 3.3391 - val_accuracy300: 0.3719 - 49s/epoch - 31ms/step
Epoch 12/50
1570/1570 - 47s - loss: 3.1688 - accuracy300: 0.4349 - val_loss: 3.3697 - val_accuracy300: 0.3723 - 47s/epoch - 30ms/step
Epoch 13/50
1570/1570 - 48s - loss: 3.1647 - accuracy300: 0.4362 - val_loss: 3.3632 - val_accuracy300: 0.3714 - 48s/epoch - 31ms/step
Epoch 14/50
1570/1570 - 46s - loss: 3.1616 - accuracy300: 0.4378 - val_loss: 3.3604 - val_accuracy300: 0.3723 - 46s/epoch - 29ms/step
testing model: results/EXC/W5/deepOF_L2/h300
Evaluating performance on  test set...
7167/7167 - 105s - 105s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1066633
{'0': {'precision': 0.4210090495061217, 'recall': 0.11501923720172642, 'f1-score': 0.18067755351728532, 'support': 618853}, '1': {'precision': 0.3108593588658321, 'recall': 0.7900986196827331, 'f1-score': 0.4461742503181633, 'support': 558205}, '2': {'precision': 0.44747881278649854, 'recall': 0.16791582764011997, 'f1-score': 0.24419704126241243, 'support': 657508}, 'accuracy': 0.3393843557549851, 'macro avg': {'precision': 0.39311574038615077, 'recall': 0.3576778948415265, 'f1-score': 0.29034961503262036, 'support': 1834566}, 'weighted avg': {'precision': 0.3969804634814658, 'recall': 0.3393843557549851, 'f1-score': 0.2842258341384552, 'support': 1834566}}
[[ 71180 478604  69069]
 [ 49914 441037  67254]
 [ 47976 499126 110406]]
Evaluating performance on  train set...
1570/1570 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0929306
{'0': {'precision': 0.44027036435367833, 'recall': 0.11118436957429507, 'f1-score': 0.17753472729931277, 'support': 136503}, '1': {'precision': 0.34078742228149594, 'recall': 0.8128603004868724, 'f1-score': 0.4802377034354058, 'support': 133916}, '2': {'precision': 0.4368580692396193, 'recall': 0.15907982937233395, 'f1-score': 0.23323003043247623, 'support': 131280}, 'accuracy': 0.3607576817467805, 'macro avg': {'precision': 0.4059719519582645, 'recall': 0.3610414998111671, 'f1-score': 0.29700082038906495, 'support': 401699}, 'weighted avg': {'precision': 0.4059901600885145, 'recall': 0.3607576817467805, 'f1-score': 0.2966499134151924, 'support': 401699}}
[[ 15177 108753  12573]
 [ 10713 108855  14348]
 [  8582 101814  20884]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1017852
{'0': {'precision': 0.42939449940210894, 'recall': 0.08946975016421663, 'f1-score': 0.14808427682387343, 'support': 44149}, '1': {'precision': 0.3334694294171685, 'recall': 0.8052549850878706, 'f1-score': 0.4716293371637278, 'support': 40571}, '2': {'precision': 0.41607017921532746, 'recall': 0.18842310504508897, 'f1-score': 0.2593816577477311, 'support': 41030}, 'accuracy': 0.35269184890656063, 'macro avg': {'precision': 0.39297803601153497, 'recall': 0.36104928009905873, 'f1-score': 0.2930317572451107, 'support': 125750}, 'weighted avg': {'precision': 0.39409849247071593, 'recall': 0.35269184890656063, 'f1-score': 0.2887846997451785, 'support': 125750}}
[[ 3950 34491  5708]
 [ 2759 32670  5142]
 [ 2490 30809  7731]]
training model: results/EXC/W5/deepOF_L2/h500
Epoch 1/50
1570/1570 - 53s - loss: 3.2394 - accuracy500: 0.4069 - val_loss: 3.3647 - val_accuracy500: 0.2918 - 53s/epoch - 34ms/step
Epoch 2/50
1570/1570 - 49s - loss: 3.2298 - accuracy500: 0.4105 - val_loss: 3.2979 - val_accuracy500: 0.3396 - 49s/epoch - 31ms/step
Epoch 3/50
1570/1570 - 49s - loss: 3.2227 - accuracy500: 0.4156 - val_loss: 3.2940 - val_accuracy500: 0.3573 - 49s/epoch - 31ms/step
Epoch 4/50
1570/1570 - 47s - loss: 3.2175 - accuracy500: 0.4172 - val_loss: 3.2909 - val_accuracy500: 0.3720 - 47s/epoch - 30ms/step
Epoch 5/50
1570/1570 - 46s - loss: 3.2128 - accuracy500: 0.4198 - val_loss: 3.2876 - val_accuracy500: 0.3795 - 46s/epoch - 30ms/step
Epoch 6/50
1570/1570 - 47s - loss: 3.2088 - accuracy500: 0.4215 - val_loss: 3.2841 - val_accuracy500: 0.3831 - 47s/epoch - 30ms/step
Epoch 7/50
1570/1570 - 47s - loss: 3.2052 - accuracy500: 0.4238 - val_loss: 3.2859 - val_accuracy500: 0.3808 - 47s/epoch - 30ms/step
Epoch 8/50
1570/1570 - 47s - loss: 3.2008 - accuracy500: 0.4258 - val_loss: 3.2872 - val_accuracy500: 0.3781 - 47s/epoch - 30ms/step
Epoch 9/50
1570/1570 - 47s - loss: 3.1981 - accuracy500: 0.4264 - val_loss: 3.2844 - val_accuracy500: 0.3777 - 47s/epoch - 30ms/step
Epoch 10/50
1570/1570 - 48s - loss: 3.1958 - accuracy500: 0.4278 - val_loss: 3.2862 - val_accuracy500: 0.3766 - 48s/epoch - 30ms/step
Epoch 11/50
1570/1570 - 48s - loss: 3.1918 - accuracy500: 0.4302 - val_loss: 3.2908 - val_accuracy500: 0.3768 - 48s/epoch - 31ms/step
Epoch 12/50
1570/1570 - 48s - loss: 3.1882 - accuracy500: 0.4314 - val_loss: 3.2903 - val_accuracy500: 0.3764 - 48s/epoch - 31ms/step
Epoch 13/50
1570/1570 - 48s - loss: 3.1862 - accuracy500: 0.4312 - val_loss: 3.2924 - val_accuracy500: 0.3748 - 48s/epoch - 31ms/step
Epoch 14/50
1570/1570 - 48s - loss: 3.1835 - accuracy500: 0.4331 - val_loss: 3.2942 - val_accuracy500: 0.3728 - 48s/epoch - 31ms/step
Epoch 15/50
1570/1570 - 49s - loss: 3.1816 - accuracy500: 0.4328 - val_loss: 3.3047 - val_accuracy500: 0.3666 - 49s/epoch - 31ms/step
Epoch 16/50
1570/1570 - 48s - loss: 3.1783 - accuracy500: 0.4350 - val_loss: 3.3186 - val_accuracy500: 0.3599 - 48s/epoch - 30ms/step
testing model: results/EXC/W5/deepOF_L2/h500
Evaluating performance on  test set...
7167/7167 - 110s - 110s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0964947
{'0': {'precision': 0.4028747381279391, 'recall': 0.39038705681044583, 'f1-score': 0.39653260571627924, 'support': 652204}, '1': {'precision': 0.29370829147099703, 'recall': 0.18803996679024423, 'f1-score': 0.22928530171987158, 'support': 486604}, '2': {'precision': 0.4233452781634066, 'recall': 0.5421683976325101, 'f1-score': 0.47544522022007824, 'support': 695758}, 'accuracy': 0.39427908290026087, 'macro avg': {'precision': 0.3733094359207809, 'recall': 0.37353180707773337, 'f1-score': 0.367087709218743, 'support': 1834566}, 'weighted avg': {'precision': 0.38168264821944964, 'recall': 0.39427908290026087, 'f1-score': 0.3820991515522243, 'support': 1834566}}
[[254612 110766 286826]
 [168106  91501 226997]
 [209270 109270 377218]]
Evaluating performance on  train set...
1570/1570 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0897431
{'0': {'precision': 0.39251202926790474, 'recall': 0.4297999883882954, 'f1-score': 0.4103105925715513, 'support': 137792}, '1': {'precision': 0.36105962531010294, 'recall': 0.18913045101832004, 'f1-score': 0.2482319209939471, 'support': 133897}, '2': {'precision': 0.3752123932499073, 'recall': 0.5214445042689024, 'f1-score': 0.43640424990907306, 'support': 130010}, 'accuracy': 0.37923918157625486, 'macro avg': {'precision': 0.37626134927597166, 'recall': 0.38012498122517263, 'f1-score': 0.3649822544915238, 'support': 401699}, 'weighted avg': {'precision': 0.3764290711041114, 'recall': 0.37923918157625486, 'f1-score': 0.3647306645712942, 'support': 401699}}
[[59223 24183 54386]
 [50073 25324 58500]
 [41586 20631 67793]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0958067
{'0': {'precision': 0.42344227208234136, 'recall': 0.3716649780479568, 'f1-score': 0.3958677593048483, 'support': 47376}, '1': {'precision': 0.3079122001020929, 'recall': 0.17151956323930848, 'f1-score': 0.2203148398407539, 'support': 35168}, '2': {'precision': 0.3813432026882636, 'recall': 0.5699671341943249, 'f1-score': 0.4569551784604251, 'support': 43206}, 'accuracy': 0.38382504970178927, 'macro avg': {'precision': 0.370899224957566, 'recall': 0.3710505584938633, 'f1-score': 0.35771259253534243, 'support': 125750}, 'weighted avg': {'precision': 0.37666776740129243, 'recall': 0.38382504970178927, 'f1-score': 0.3677603872199384, 'support': 125750}}
[[17608  7395 22373]
 [11558  6032 17578]
 [12417  6163 24626]]
training model: results/EXC/W5/deepOF_L2/h1000
Epoch 1/50
1570/1570 - 50s - loss: 3.2354 - accuracy1000: 0.4142 - val_loss: 3.2824 - val_accuracy1000: 0.3632 - 50s/epoch - 32ms/step
Epoch 2/50
1570/1570 - 48s - loss: 3.2243 - accuracy1000: 0.4147 - val_loss: 3.2751 - val_accuracy1000: 0.3675 - 48s/epoch - 30ms/step
Epoch 3/50
1570/1570 - 47s - loss: 3.2177 - accuracy1000: 0.4153 - val_loss: 3.2762 - val_accuracy1000: 0.3655 - 47s/epoch - 30ms/step
Epoch 4/50
1570/1570 - 47s - loss: 3.2120 - accuracy1000: 0.4187 - val_loss: 3.2759 - val_accuracy1000: 0.3682 - 47s/epoch - 30ms/step
Epoch 5/50
1570/1570 - 47s - loss: 3.2077 - accuracy1000: 0.4219 - val_loss: 3.2753 - val_accuracy1000: 0.3687 - 47s/epoch - 30ms/step
Epoch 6/50
1570/1570 - 48s - loss: 3.2069 - accuracy1000: 0.4219 - val_loss: 3.2746 - val_accuracy1000: 0.3668 - 48s/epoch - 30ms/step
Epoch 7/50
1570/1570 - 47s - loss: 3.2057 - accuracy1000: 0.4226 - val_loss: 3.2808 - val_accuracy1000: 0.3657 - 47s/epoch - 30ms/step
Epoch 8/50
1570/1570 - 47s - loss: 3.2039 - accuracy1000: 0.4229 - val_loss: 3.2853 - val_accuracy1000: 0.3639 - 47s/epoch - 30ms/step
Epoch 9/50
1570/1570 - 48s - loss: 3.2005 - accuracy1000: 0.4250 - val_loss: 3.2868 - val_accuracy1000: 0.3642 - 48s/epoch - 30ms/step
Epoch 10/50
1570/1570 - 48s - loss: 3.1981 - accuracy1000: 0.4258 - val_loss: 3.2822 - val_accuracy1000: 0.3675 - 48s/epoch - 31ms/step
Epoch 11/50
1570/1570 - 48s - loss: 3.1955 - accuracy1000: 0.4282 - val_loss: 3.2854 - val_accuracy1000: 0.3650 - 48s/epoch - 31ms/step
Epoch 12/50
1570/1570 - 50s - loss: 3.1943 - accuracy1000: 0.4282 - val_loss: 3.2891 - val_accuracy1000: 0.3630 - 50s/epoch - 32ms/step
Epoch 13/50
1570/1570 - 50s - loss: 3.1921 - accuracy1000: 0.4293 - val_loss: 3.2932 - val_accuracy1000: 0.3617 - 50s/epoch - 32ms/step
Epoch 14/50
1570/1570 - 49s - loss: 3.1903 - accuracy1000: 0.4306 - val_loss: 3.2941 - val_accuracy1000: 0.3584 - 49s/epoch - 31ms/step
Epoch 15/50
1570/1570 - 50s - loss: 3.1886 - accuracy1000: 0.4319 - val_loss: 3.3026 - val_accuracy1000: 0.3554 - 50s/epoch - 32ms/step
Epoch 16/50
1570/1570 - 48s - loss: 3.1871 - accuracy1000: 0.4323 - val_loss: 3.3008 - val_accuracy1000: 0.3574 - 48s/epoch - 31ms/step
testing model: results/EXC/W5/deepOF_L2/h1000
Evaluating performance on  test set...
7167/7167 - 113s - 113s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.080728
{'0': {'precision': 0.4326227949268626, 'recall': 0.2855208674165924, 'f1-score': 0.34400592012084935, 'support': 709048}, '1': {'precision': 0.25446060938786713, 'recall': 0.0076006865488892775, 'f1-score': 0.01476048055156747, 'support': 365888}, '2': {'precision': 0.43178119942582405, 'recall': 0.7705830470097285, 'f1-score': 0.5534483801916691, 'support': 759630}, 'accuracy': 0.43093952466141855, 'macro avg': {'precision': 0.37295486791351795, 'recall': 0.35456820032507, 'f1-score': 0.304071593621362, 'support': 1834566}, 'weighted avg': {'precision': 0.39674144373374887, 'recall': 0.43093952466141855, 'f1-score': 0.3650636637781892, 'support': 1834566}}
[[202448   3961 502639]
 [ 95422   2781 267685]
 [170085   4187 585358]]
Evaluating performance on  train set...
1570/1570 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981323
{'0': {'precision': 0.3860097586251565, 'recall': 0.3203468788074249, 'f1-score': 0.35012630960540486, 'support': 139530}, '1': {'precision': 0.3550670640834575, 'recall': 0.007239055960257355, 'f1-score': 0.014188832064080517, 'support': 131647}, '2': {'precision': 0.34455546924652214, 'recall': 0.747651736871945, 'f1-score': 0.4717190906410275, 'support': 130522}, 'accuracy': 0.35657544579399003, 'macro avg': {'precision': 0.361877430651712, 'recall': 0.3584125572132091, 'f1-score': 0.27867807743683765, 'support': 401699}, 'weighted avg': {'precision': 0.3623995189516468, 'recall': 0.35657544579399003, 'f1-score': 0.2795395564903829, 'support': 401699}}
[[44698   914 93918]
 [38977   953 91717]
 [32120   817 97585]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.094269
{'0': {'precision': 0.4054396639142402, 'recall': 0.23928609597093087, 'f1-score': 0.30095299541648185, 'support': 46785}, '1': {'precision': 0.34724857685009486, 'recall': 0.005080510827318157, 'f1-score': 0.010014501874298849, 'support': 36020}, '2': {'precision': 0.35527758142012683, 'recall': 0.8075212481080452, 'f1-score': 0.49345456615156946, 'support': 42945}, 'accuracy': 0.36625844930417495, 'macro avg': {'precision': 0.369321940728154, 'recall': 0.3506292849687647, 'f1-score': 0.26814068781411676, 'support': 125750}, 'weighted avg': {'precision': 0.37164043060401986, 'recall': 0.36625844930417495, 'f1-score': 0.28335757130378925, 'support': 125750}}
[[11195   200 35390]
 [ 8295   183 27542]
 [ 8122   144 34679]]
training model: results/EXC/W5/deepVOL_L2/h10
Epoch 1/50
1570/1570 - 51s - loss: 2.4094 - accuracy10: 0.5886 - val_loss: 2.8027 - val_accuracy10: 0.6531 - 51s/epoch - 33ms/step
Epoch 2/50
1570/1570 - 48s - loss: 2.2014 - accuracy10: 0.6386 - val_loss: 2.6653 - val_accuracy10: 0.6261 - 48s/epoch - 31ms/step
Epoch 3/50
1570/1570 - 48s - loss: 2.1524 - accuracy10: 0.6506 - val_loss: 2.7260 - val_accuracy10: 0.6501 - 48s/epoch - 30ms/step
Epoch 4/50
1570/1570 - 48s - loss: 2.1293 - accuracy10: 0.6561 - val_loss: 2.6748 - val_accuracy10: 0.6605 - 48s/epoch - 31ms/step
Epoch 5/50
1570/1570 - 52s - loss: 2.1158 - accuracy10: 0.6580 - val_loss: 2.7380 - val_accuracy10: 0.6703 - 52s/epoch - 33ms/step
Epoch 6/50
1570/1570 - 48s - loss: 2.1020 - accuracy10: 0.6608 - val_loss: 2.7198 - val_accuracy10: 0.6740 - 48s/epoch - 30ms/step
Epoch 7/50
1570/1570 - 50s - loss: 2.0897 - accuracy10: 0.6616 - val_loss: 2.7186 - val_accuracy10: 0.6742 - 50s/epoch - 32ms/step
Epoch 8/50
1570/1570 - 49s - loss: 2.0823 - accuracy10: 0.6630 - val_loss: 2.6879 - val_accuracy10: 0.6697 - 49s/epoch - 31ms/step
Epoch 9/50
1570/1570 - 48s - loss: 2.0732 - accuracy10: 0.6634 - val_loss: 2.7061 - val_accuracy10: 0.6737 - 48s/epoch - 30ms/step
Epoch 10/50
1570/1570 - 47s - loss: 2.0635 - accuracy10: 0.6644 - val_loss: 2.6816 - val_accuracy10: 0.6654 - 47s/epoch - 30ms/step
Epoch 11/50
1570/1570 - 48s - loss: 2.0541 - accuracy10: 0.6650 - val_loss: 2.6639 - val_accuracy10: 0.6696 - 48s/epoch - 30ms/step
Epoch 12/50
1570/1570 - 47s - loss: 2.0480 - accuracy10: 0.6652 - val_loss: 2.7098 - val_accuracy10: 0.6768 - 47s/epoch - 30ms/step
Epoch 13/50
1570/1570 - 48s - loss: 2.0403 - accuracy10: 0.6651 - val_loss: 2.7240 - val_accuracy10: 0.6776 - 48s/epoch - 30ms/step
Epoch 14/50
1570/1570 - 45s - loss: 2.0346 - accuracy10: 0.6661 - val_loss: 2.6866 - val_accuracy10: 0.6845 - 45s/epoch - 28ms/step
Epoch 15/50
1570/1570 - 46s - loss: 2.0280 - accuracy10: 0.6662 - val_loss: 2.7194 - val_accuracy10: 0.6895 - 46s/epoch - 29ms/step
Epoch 16/50
1570/1570 - 48s - loss: 2.0224 - accuracy10: 0.6671 - val_loss: 2.7034 - val_accuracy10: 0.6870 - 48s/epoch - 30ms/step
Epoch 17/50
1570/1570 - 49s - loss: 2.0179 - accuracy10: 0.6667 - val_loss: 2.7024 - val_accuracy10: 0.6720 - 49s/epoch - 31ms/step
Epoch 18/50
1570/1570 - 49s - loss: 2.0107 - accuracy10: 0.6681 - val_loss: 2.7450 - val_accuracy10: 0.6855 - 49s/epoch - 31ms/step
Epoch 19/50
1570/1570 - 51s - loss: 2.0062 - accuracy10: 0.6684 - val_loss: 2.7599 - val_accuracy10: 0.6847 - 51s/epoch - 32ms/step
Epoch 20/50
1570/1570 - 51s - loss: 2.0016 - accuracy10: 0.6682 - val_loss: 2.7476 - val_accuracy10: 0.6831 - 51s/epoch - 33ms/step
Epoch 21/50
1570/1570 - 50s - loss: 1.9965 - accuracy10: 0.6693 - val_loss: 2.7338 - val_accuracy10: 0.6804 - 50s/epoch - 32ms/step
testing model: results/EXC/W5/deepVOL_L2/h10
Evaluating performance on  test set...
7167/7167 - 119s - 119s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72111523
{'0': {'precision': 0.3857175424142317, 'recall': 0.7155549784834545, 'f1-score': 0.5012421585493252, 'support': 269560}, '1': {'precision': 0.8715291218414769, 'recall': 0.7028705926716394, 'f1-score': 0.7781660333808565, 'support': 1294123}, '2': {'precision': 0.4012151888287904, 'recall': 0.4307352116003662, 'f1-score': 0.41545147203079186, 'support': 270888}, 'accuracy': 0.6645515491087562, 'macro avg': {'precision': 0.552820617694833, 'recall': 0.6163869275851533, 'f1-score': 0.5649532213203244, 'support': 1834571}, 'weighted avg': {'precision': 0.7307017730845474, 'recall': 0.6645515491087562, 'f1-score': 0.6839191376245278, 'support': 1834571}}
[[192885  62978  13697]
 [224081 909601 160441]
 [ 83102  71105 116681]]
Evaluating performance on  train set...
1570/1570 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6427605
{'0': {'precision': 0.3822365165759525, 'recall': 0.705815754975569, 'f1-score': 0.4959110193145026, 'support': 50346}, '1': {'precision': 0.8941495179414524, 'recall': 0.7632964849499773, 'f1-score': 0.8235576699015204, 'support': 300963}, '2': {'precision': 0.41029451499594705, 'recall': 0.4218892637428061, 'f1-score': 0.4160111150248522, 'support': 50390}, 'accuracy': 0.7132654051914493, 'macro avg': {'precision': 0.562226849837784, 'recall': 0.6303338345561175, 'f1-score': 0.5784932680802918, 'support': 401699}, 'weighted avg': {'precision': 0.7692942766658418, 'recall': 0.7132654051914493, 'f1-score': 0.7313693170037305, 'support': 401699}}
[[ 35535  12256   2555]
 [ 43239 229724  28000]
 [ 14192  14939  21259]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7185708
{'0': {'precision': 0.37516188974604425, 'recall': 0.7196867404806914, 'f1-score': 0.4932171080635908, 'support': 18515}, '1': {'precision': 0.8825665691751106, 'recall': 0.7166203333746018, 'f1-score': 0.7909834029020076, 'support': 88849}, '2': {'precision': 0.4041129968489137, 'recall': 0.3975851191123681, 'f1-score': 0.4008224811514737, 'support': 18386}, 'accuracy': 0.6704254473161034, 'macro avg': {'precision': 0.5539471519233562, 'recall': 0.6112973976558871, 'f1-score': 0.5616743307056907, 'support': 125750}, 'weighted avg': {'precision': 0.7379029904839088, 'recall': 0.6704254473161034, 'f1-score': 0.6900955964905674, 'support': 125750}}
[[13325  3979  1211]
 [15610 63671  9568]
 [ 6583  4493  7310]]
training model: results/EXC/W5/deepVOL_L2/h20
Epoch 1/50
1570/1570 - 49s - loss: 2.5242 - accuracy20: 0.5838 - val_loss: 2.9313 - val_accuracy20: 0.6294 - 49s/epoch - 31ms/step
Epoch 2/50
1570/1570 - 47s - loss: 2.3311 - accuracy20: 0.6262 - val_loss: 2.8467 - val_accuracy20: 0.6418 - 47s/epoch - 30ms/step
Epoch 3/50
1570/1570 - 47s - loss: 2.2890 - accuracy20: 0.6351 - val_loss: 2.8524 - val_accuracy20: 0.6422 - 47s/epoch - 30ms/step
Epoch 4/50
1570/1570 - 47s - loss: 2.2661 - accuracy20: 0.6390 - val_loss: 2.8116 - val_accuracy20: 0.6470 - 47s/epoch - 30ms/step
Epoch 5/50
1570/1570 - 48s - loss: 2.2482 - accuracy20: 0.6414 - val_loss: 2.8337 - val_accuracy20: 0.6513 - 48s/epoch - 30ms/step
Epoch 6/50
1570/1570 - 46s - loss: 2.2348 - accuracy20: 0.6425 - val_loss: 2.8207 - val_accuracy20: 0.6415 - 46s/epoch - 30ms/step
Epoch 7/50
1570/1570 - 47s - loss: 2.2214 - accuracy20: 0.6433 - val_loss: 2.8262 - val_accuracy20: 0.6409 - 47s/epoch - 30ms/step
Epoch 8/50
1570/1570 - 48s - loss: 2.2082 - accuracy20: 0.6430 - val_loss: 2.8148 - val_accuracy20: 0.6419 - 48s/epoch - 30ms/step
Epoch 9/50
1570/1570 - 48s - loss: 2.1978 - accuracy20: 0.6444 - val_loss: 2.8341 - val_accuracy20: 0.6522 - 48s/epoch - 31ms/step
Epoch 10/50
1570/1570 - 48s - loss: 2.1882 - accuracy20: 0.6451 - val_loss: 2.7504 - val_accuracy20: 0.6504 - 48s/epoch - 30ms/step
Epoch 11/50
1570/1570 - 47s - loss: 2.1813 - accuracy20: 0.6458 - val_loss: 2.7855 - val_accuracy20: 0.6536 - 47s/epoch - 30ms/step
Epoch 12/50
1570/1570 - 48s - loss: 2.1738 - accuracy20: 0.6468 - val_loss: 2.7664 - val_accuracy20: 0.6437 - 48s/epoch - 30ms/step
Epoch 13/50
1570/1570 - 48s - loss: 2.1679 - accuracy20: 0.6470 - val_loss: 2.7860 - val_accuracy20: 0.6477 - 48s/epoch - 30ms/step
Epoch 14/50
1570/1570 - 49s - loss: 2.1628 - accuracy20: 0.6490 - val_loss: 2.7265 - val_accuracy20: 0.6364 - 49s/epoch - 31ms/step
Epoch 15/50
1570/1570 - 51s - loss: 2.1572 - accuracy20: 0.6487 - val_loss: 2.7420 - val_accuracy20: 0.6403 - 51s/epoch - 32ms/step
Epoch 16/50
1570/1570 - 53s - loss: 2.1523 - accuracy20: 0.6494 - val_loss: 2.7745 - val_accuracy20: 0.6376 - 53s/epoch - 34ms/step
Epoch 17/50
1570/1570 - 51s - loss: 2.1484 - accuracy20: 0.6492 - val_loss: 2.7517 - val_accuracy20: 0.6494 - 51s/epoch - 32ms/step
Epoch 18/50
1570/1570 - 50s - loss: 2.1437 - accuracy20: 0.6514 - val_loss: 2.7801 - val_accuracy20: 0.6498 - 50s/epoch - 32ms/step
Epoch 19/50
1570/1570 - 50s - loss: 2.1384 - accuracy20: 0.6512 - val_loss: 2.7517 - val_accuracy20: 0.6486 - 50s/epoch - 32ms/step
Epoch 20/50
1570/1570 - 47s - loss: 2.1339 - accuracy20: 0.6514 - val_loss: 2.8223 - val_accuracy20: 0.6468 - 47s/epoch - 30ms/step
Epoch 21/50
1570/1570 - 49s - loss: 2.1300 - accuracy20: 0.6525 - val_loss: 2.8140 - val_accuracy20: 0.6430 - 49s/epoch - 32ms/step
Epoch 22/50
1570/1570 - 48s - loss: 2.1266 - accuracy20: 0.6527 - val_loss: 2.8370 - val_accuracy20: 0.6402 - 48s/epoch - 31ms/step
Epoch 23/50
1570/1570 - 49s - loss: 2.1233 - accuracy20: 0.6528 - val_loss: 2.8648 - val_accuracy20: 0.6501 - 49s/epoch - 31ms/step
Epoch 24/50
1570/1570 - 48s - loss: 2.1197 - accuracy20: 0.6521 - val_loss: 2.8341 - val_accuracy20: 0.6508 - 48s/epoch - 30ms/step
testing model: results/EXC/W5/deepVOL_L2/h20
Evaluating performance on  test set...
7167/7167 - 113s - 113s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7914871
{'0': {'precision': 0.45522684696881444, 'recall': 0.6475458705966327, 'f1-score': 0.5346165356541593, 'support': 357255}, '1': {'precision': 0.7902057926829268, 'recall': 0.6531287220324635, 'f1-score': 0.7151579820973382, 'support': 1117501}, '2': {'precision': 0.45045302292551753, 'recall': 0.5041896530161333, 'f1-score': 0.4758089263186607, 'support': 359815}, 'accuracy': 0.622830078530621, 'macro avg': {'precision': 0.5652952208590862, 'recall': 0.6016214152150766, 'f1-score': 0.5751944813567195, 'support': 1834571}, 'weighted avg': {'precision': 0.6583378812740157, 'recall': 0.622830078530621, 'f1-score': 0.6330566543460205, 'support': 1834571}}
[[231339  97876  28040]
 [194345 729872 193284]
 [ 82500  95900 181415]]
Evaluating performance on  train set...
1570/1570 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7161619
{'0': {'precision': 0.452725090528605, 'recall': 0.6484520783437899, 'f1-score': 0.5331939930652039, 'support': 68059}, '1': {'precision': 0.8290465168891287, 'recall': 0.7175839279998494, 'f1-score': 0.7692987785800361, 'support': 265555}, '2': {'precision': 0.4655747404658168, 'recall': 0.5085114195490931, 'f1-score': 0.48609677849616356, 'support': 68085}, 'accuracy': 0.6704348280677821, 'macro avg': {'precision': 0.5824487826278502, 'recall': 0.6248491419642441, 'f1-score': 0.5961965167138013, 'support': 401699}, 'weighted avg': {'precision': 0.7036814155210595, 'recall': 0.6704348280677821, 'f1-score': 0.6812954134408039, 'support': 401699}}
[[ 44133  18972   4954]
 [ 40209 190558  34788]
 [ 13141  20322  34622]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7822833
{'0': {'precision': 0.44504484429836777, 'recall': 0.660575491979494, 'f1-score': 0.5318022965551672, 'support': 24188}, '1': {'precision': 0.8130457508301562, 'recall': 0.6819377466023674, 'f1-score': 0.7417427525560651, 'support': 77554}, '2': {'precision': 0.45661290322580644, 'recall': 0.471676107964012, 'f1-score': 0.4640222914276348, 'support': 24008}, 'accuracy': 0.637685884691849, 'macro avg': {'precision': 0.5715678327847767, 'recall': 0.6047297821819577, 'f1-score': 0.5791891135129558, 'support': 125750}, 'weighted avg': {'precision': 0.6742111923213997, 'recall': 0.637685884691849, 'f1-score': 0.6483387558918816, 'support': 125750}}
[[15978  6173  2037]
 [13228 52887 11439]
 [ 6696  5988 11324]]
training model: results/EXC/W5/deepVOL_L2/h30
Epoch 1/50
1570/1570 - 49s - loss: 2.6413 - accuracy30: 0.5662 - val_loss: 3.0195 - val_accuracy30: 0.6073 - 49s/epoch - 31ms/step
Epoch 2/50
1570/1570 - 48s - loss: 2.4616 - accuracy30: 0.6062 - val_loss: 2.9306 - val_accuracy30: 0.6107 - 48s/epoch - 30ms/step
Epoch 3/50
1570/1570 - 49s - loss: 2.4203 - accuracy30: 0.6146 - val_loss: 2.9211 - val_accuracy30: 0.6103 - 49s/epoch - 31ms/step
Epoch 4/50
1570/1570 - 50s - loss: 2.3998 - accuracy30: 0.6164 - val_loss: 2.8394 - val_accuracy30: 0.6115 - 50s/epoch - 32ms/step
Epoch 5/50
1570/1570 - 50s - loss: 2.3805 - accuracy30: 0.6172 - val_loss: 2.8531 - val_accuracy30: 0.6190 - 50s/epoch - 32ms/step
Epoch 6/50
1570/1570 - 49s - loss: 2.3652 - accuracy30: 0.6188 - val_loss: 2.8668 - val_accuracy30: 0.6161 - 49s/epoch - 31ms/step
Epoch 7/50
1570/1570 - 51s - loss: 2.3511 - accuracy30: 0.6196 - val_loss: 2.8525 - val_accuracy30: 0.6109 - 51s/epoch - 32ms/step
Epoch 8/50
1570/1570 - 51s - loss: 2.3417 - accuracy30: 0.6216 - val_loss: 2.8166 - val_accuracy30: 0.6172 - 51s/epoch - 33ms/step
Epoch 9/50
1570/1570 - 52s - loss: 2.3335 - accuracy30: 0.6222 - val_loss: 2.7997 - val_accuracy30: 0.6202 - 52s/epoch - 33ms/step
Epoch 10/50
1570/1570 - 47s - loss: 2.3285 - accuracy30: 0.6229 - val_loss: 2.8250 - val_accuracy30: 0.6211 - 47s/epoch - 30ms/step
Epoch 11/50
1570/1570 - 48s - loss: 2.3204 - accuracy30: 0.6241 - val_loss: 2.7987 - val_accuracy30: 0.6206 - 48s/epoch - 31ms/step
Epoch 12/50
1570/1570 - 47s - loss: 2.3160 - accuracy30: 0.6248 - val_loss: 2.7814 - val_accuracy30: 0.6274 - 47s/epoch - 30ms/step
Epoch 13/50
1570/1570 - 48s - loss: 2.3101 - accuracy30: 0.6254 - val_loss: 2.7838 - val_accuracy30: 0.6203 - 48s/epoch - 30ms/step
Epoch 14/50
1570/1570 - 48s - loss: 2.3059 - accuracy30: 0.6254 - val_loss: 2.7973 - val_accuracy30: 0.6201 - 48s/epoch - 31ms/step
Epoch 15/50
1570/1570 - 50s - loss: 2.3010 - accuracy30: 0.6269 - val_loss: 2.8038 - val_accuracy30: 0.6248 - 50s/epoch - 32ms/step
Epoch 16/50
1570/1570 - 50s - loss: 2.2967 - accuracy30: 0.6274 - val_loss: 2.8001 - val_accuracy30: 0.6260 - 50s/epoch - 32ms/step
Epoch 17/50
1570/1570 - 51s - loss: 2.2920 - accuracy30: 0.6279 - val_loss: 2.7930 - val_accuracy30: 0.6243 - 51s/epoch - 33ms/step
Epoch 18/50
1570/1570 - 52s - loss: 2.2884 - accuracy30: 0.6284 - val_loss: 2.8002 - val_accuracy30: 0.6284 - 52s/epoch - 33ms/step
Epoch 19/50
1570/1570 - 52s - loss: 2.2851 - accuracy30: 0.6289 - val_loss: 2.8042 - val_accuracy30: 0.6285 - 52s/epoch - 33ms/step
Epoch 20/50
1570/1570 - 50s - loss: 2.2801 - accuracy30: 0.6293 - val_loss: 2.8077 - val_accuracy30: 0.6295 - 50s/epoch - 32ms/step
Epoch 21/50
1570/1570 - 50s - loss: 2.2771 - accuracy30: 0.6304 - val_loss: 2.8189 - val_accuracy30: 0.6295 - 50s/epoch - 32ms/step
Epoch 22/50
1570/1570 - 47s - loss: 2.2729 - accuracy30: 0.6306 - val_loss: 2.8008 - val_accuracy30: 0.6324 - 47s/epoch - 30ms/step
testing model: results/EXC/W5/deepVOL_L2/h30
Evaluating performance on  test set...
7167/7167 - 121s - 121s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82496196
{'0': {'precision': 0.49621335447248843, 'recall': 0.5824734314654058, 'f1-score': 0.5358943839610383, 'support': 421269}, '1': {'precision': 0.7043654822335026, 'recall': 0.6938981270078597, 'f1-score': 0.699092625482822, 'support': 989860}, '2': {'precision': 0.5193275238408418, 'recall': 0.4475536200943695, 'f1-score': 0.48077659755290086, 'support': 423442}, 'accuracy': 0.6114524867121524, 'macro avg': {'precision': 0.5733021201822776, 'recall': 0.5746417261892117, 'f1-score': 0.5719212023322536, 'support': 1834571}, 'weighted avg': {'precision': 0.613858828695722, 'recall': 0.6114524867121524, 'f1-score': 0.6112276502344713, 'support': 1834571}}
[[245378 139879  36012]
 [163603 686862 139395]
 [ 85520 148409 189513]]
Evaluating performance on  train set...
1570/1570 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7553462
{'0': {'precision': 0.49798502566879443, 'recall': 0.592127583175464, 'f1-score': 0.5409912101089402, 'support': 80763}, '1': {'precision': 0.754446627815776, 'recall': 0.7453569851440188, 'f1-score': 0.7498742623390557, 'support': 240038}, '2': {'precision': 0.5261084031405971, 'recall': 0.44562288313678955, 'f1-score': 0.4825324588408513, 'support': 80898}, 'accuracy': 0.6541863435059584, 'macro avg': {'precision': 0.5928466855417226, 'recall': 0.5943691504854242, 'f1-score': 0.591132643762949, 'support': 401699}, 'weighted avg': {'precision': 0.6568991754348408, 'recall': 0.6541863435059584, 'f1-score': 0.6540377300931239, 'support': 401699}}
[[ 47822  27131   5810]
 [ 34462 178914  26662]
 [ 13747  31101  36050]]
Evaluating performance on  val set...
492/492 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80623704
{'0': {'precision': 0.4844071181065367, 'recall': 0.5868791803045397, 'f1-score': 0.5307422541102281, 'support': 28108}, '1': {'precision': 0.7391014531395814, 'recall': 0.7158577351831394, 'f1-score': 0.7272939290139203, 'support': 69701}, '2': {'precision': 0.5112250382436846, 'recall': 0.4425396370924448, 'f1-score': 0.47440914671577655, 'support': 27941}, 'accuracy': 0.6262982107355864, 'macro avg': {'precision': 0.578244536496601, 'recall': 0.5817588508600413, 'f1-score': 0.5774817766133084, 'support': 125750}, 'weighted avg': {'precision': 0.6315384847283283, 'recall': 0.6262982107355864, 'f1-score': 0.6271704444780521, 'support': 125750}}
[[16496  8716  2896]
 [10879 49896  8926]
 [ 6679  8897 12365]]
training model: results/EXC/W5/deepVOL_L2/h50
Epoch 1/50
1570/1570 - 53s - loss: 2.8346 - accuracy50: 0.5338 - val_loss: 3.1855 - val_accuracy50: 0.5515 - 53s/epoch - 33ms/step
Epoch 2/50
1570/1570 - 48s - loss: 2.6857 - accuracy50: 0.5685 - val_loss: 3.1308 - val_accuracy50: 0.5623 - 48s/epoch - 31ms/step
Epoch 3/50
1570/1570 - 47s - loss: 2.6445 - accuracy50: 0.5740 - val_loss: 3.1366 - val_accuracy50: 0.5660 - 47s/epoch - 30ms/step
Epoch 4/50
1570/1570 - 51s - loss: 2.6246 - accuracy50: 0.5782 - val_loss: 3.0826 - val_accuracy50: 0.5743 - 51s/epoch - 32ms/step
Epoch 5/50
1570/1570 - 49s - loss: 2.6110 - accuracy50: 0.5810 - val_loss: 3.0759 - val_accuracy50: 0.5725 - 49s/epoch - 31ms/step
Epoch 6/50
1570/1570 - 50s - loss: 2.6000 - accuracy50: 0.5824 - val_loss: 3.1278 - val_accuracy50: 0.5712 - 50s/epoch - 32ms/step
Epoch 7/50
1570/1570 - 50s - loss: 2.5876 - accuracy50: 0.5846 - val_loss: 3.0574 - val_accuracy50: 0.5770 - 50s/epoch - 32ms/step
Epoch 8/50
1570/1570 - 49s - loss: 2.5798 - accuracy50: 0.5845 - val_loss: 3.0448 - val_accuracy50: 0.5791 - 49s/epoch - 31ms/step
Epoch 9/50
1570/1570 - 50s - loss: 2.5716 - accuracy50: 0.5860 - val_loss: 3.0598 - val_accuracy50: 0.5768 - 50s/epoch - 32ms/step
Epoch 10/50
1570/1570 - 50s - loss: 2.5645 - accuracy50: 0.5862 - val_loss: 3.0621 - val_accuracy50: 0.5761 - 50s/epoch - 32ms/step
Epoch 11/50
1570/1570 - 50s - loss: 2.5581 - accuracy50: 0.5872 - val_loss: 3.0425 - val_accuracy50: 0.5763 - 50s/epoch - 32ms/step
Epoch 12/50
1570/1570 - 51s - loss: 2.5522 - accuracy50: 0.5881 - val_loss: 3.0394 - val_accuracy50: 0.5747 - 51s/epoch - 32ms/step
Epoch 13/50
1570/1570 - 49s - loss: 2.5478 - accuracy50: 0.5884 - val_loss: 3.0037 - val_accuracy50: 0.5792 - 49s/epoch - 31ms/step
Epoch 14/50
1570/1570 - 48s - loss: 2.5423 - accuracy50: 0.5893 - val_loss: 3.0186 - val_accuracy50: 0.5750 - 48s/epoch - 31ms/step
Epoch 15/50
1570/1570 - 47s - loss: 2.5382 - accuracy50: 0.5898 - val_loss: 3.0481 - val_accuracy50: 0.5715 - 47s/epoch - 30ms/step
Epoch 16/50
1570/1570 - 51s - loss: 2.5353 - accuracy50: 0.5905 - val_loss: 3.0300 - val_accuracy50: 0.5701 - 51s/epoch - 32ms/step
Epoch 17/50
1570/1570 - 51s - loss: 2.5304 - accuracy50: 0.5912 - val_loss: 3.0481 - val_accuracy50: 0.5706 - 51s/epoch - 32ms/step
Epoch 18/50
1570/1570 - 53s - loss: 2.5258 - accuracy50: 0.5920 - val_loss: 3.0388 - val_accuracy50: 0.5680 - 53s/epoch - 34ms/step
Epoch 19/50
1570/1570 - 50s - loss: 2.5226 - accuracy50: 0.5919 - val_loss: 3.0301 - val_accuracy50: 0.5709 - 50s/epoch - 32ms/step
Epoch 20/50
1570/1570 - 49s - loss: 2.5189 - accuracy50: 0.5929 - val_loss: 3.0313 - val_accuracy50: 0.5698 - 49s/epoch - 31ms/step
Epoch 21/50
1570/1570 - 50s - loss: 2.5151 - accuracy50: 0.5935 - val_loss: 3.0325 - val_accuracy50: 0.5665 - 50s/epoch - 32ms/step
Epoch 22/50
1570/1570 - 52s - loss: 2.5113 - accuracy50: 0.5942 - val_loss: 3.0478 - val_accuracy50: 0.5689 - 52s/epoch - 33ms/step
Epoch 23/50
1570/1570 - 52s - loss: 2.5089 - accuracy50: 0.5945 - val_loss: 3.0674 - val_accuracy50: 0.5643 - 52s/epoch - 33ms/step
testing model: results/EXC/W5/deepVOL_L2/h50
Evaluating performance on  test set...
7167/7167 - 128s - 128s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93260324
{'0': {'precision': 0.5410591994758036, 'recall': 0.42763283754562864, 'f1-score': 0.47770534268753373, 'support': 517493}, '1': {'precision': 0.54758064445166, 'recall': 0.7794111568824655, 'f1-score': 0.6432450647388017, 'support': 798413}, '2': {'precision': 0.5952269779507133, 'recall': 0.3318037654362643, 'f1-score': 0.42608846358583297, 'support': 518665}, 'accuracy': 0.5536357001173572, 'macro avg': {'precision': 0.5612889406260589, 'recall': 0.5129492532881195, 'f1-score': 0.5156796236707227, 'support': 1834571}, 'weighted avg': {'precision': 0.5592115289687464, 'recall': 0.5536357001173572, 'f1-score': 0.5351559387684897, 'support': 1834571}}
[[221297 245941  50255]
 [109346 622292  66775]
 [ 78364 268206 172095]]
Evaluating performance on  train set...
1570/1570 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8648097
{'0': {'precision': 0.5527516517210751, 'recall': 0.4503985564720812, 'f1-score': 0.4963534752609929, 'support': 100864}, '1': {'precision': 0.6137625234405935, 'recall': 0.8189312718373531, 'f1-score': 0.701656314257712, 'support': 200631}, '2': {'precision': 0.6207974678658278, 'recall': 0.3210051494950301, 'f1-score': 0.423186727887487, 'support': 100204}, 'accuracy': 0.602187209826263, 'macro avg': {'precision': 0.5957705476758322, 'recall': 0.5301116592681548, 'f1-score': 0.5403988391353973, 'support': 401699}, 'weighted avg': {'precision': 0.600197961432893, 'recall': 0.602187209826263, 'f1-score': 0.5806417436832094, 'support': 401699}}
[[ 45429  47669   7766]
 [ 24446 164303  11882]
 [ 12312  55726  32166]]
Evaluating performance on  val set...
492/492 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8981763
{'0': {'precision': 0.5298786828422877, 'recall': 0.4478525810042773, 'f1-score': 0.48542486980820526, 'support': 34134}, '1': {'precision': 0.5963582562199063, 'recall': 0.7928291664509896, 'f1-score': 0.6807004029390852, 'support': 57957}, '2': {'precision': 0.5808856869363695, 'recall': 0.3425532547015657, 'f1-score': 0.43096359422890035, 'support': 33659}, 'accuracy': 0.5786640159045726, 'macro avg': {'precision': 0.5690408753328545, 'recall': 0.5277450007189443, 'f1-score': 0.5323629556587303, 'support': 125750}, 'weighted avg': {'precision': 0.5741713379917854, 'recall': 0.5786640159045726, 'f1-score': 0.5608481063803133, 'support': 125750}}
[[15287 14772  4075]
 [ 7763 45950  4244]
 [ 5800 16329 11530]]
training model: results/EXC/W5/deepVOL_L2/h100
Epoch 1/50
1570/1570 - 53s - loss: 3.0552 - accuracy100: 0.4728 - val_loss: 3.1507 - val_accuracy100: 0.4549 - 53s/epoch - 34ms/step
Epoch 2/50
1570/1570 - 52s - loss: 2.9617 - accuracy100: 0.4943 - val_loss: 3.0893 - val_accuracy100: 0.4601 - 52s/epoch - 33ms/step
Epoch 3/50
1570/1570 - 49s - loss: 2.9289 - accuracy100: 0.5018 - val_loss: 3.0929 - val_accuracy100: 0.4683 - 49s/epoch - 31ms/step
Epoch 4/50
1570/1570 - 51s - loss: 2.9143 - accuracy100: 0.5053 - val_loss: 3.1112 - val_accuracy100: 0.4679 - 51s/epoch - 33ms/step
Epoch 5/50
1570/1570 - 50s - loss: 2.9045 - accuracy100: 0.5085 - val_loss: 3.0916 - val_accuracy100: 0.4687 - 50s/epoch - 32ms/step
Epoch 6/50
1570/1570 - 51s - loss: 2.8958 - accuracy100: 0.5109 - val_loss: 3.1127 - val_accuracy100: 0.4655 - 51s/epoch - 32ms/step
Epoch 7/50
1570/1570 - 50s - loss: 2.8902 - accuracy100: 0.5122 - val_loss: 3.1180 - val_accuracy100: 0.4719 - 50s/epoch - 32ms/step
Epoch 8/50
1570/1570 - 50s - loss: 2.8854 - accuracy100: 0.5141 - val_loss: 3.1282 - val_accuracy100: 0.4660 - 50s/epoch - 32ms/step
Epoch 9/50
1570/1570 - 50s - loss: 2.8805 - accuracy100: 0.5157 - val_loss: 3.1236 - val_accuracy100: 0.4692 - 50s/epoch - 32ms/step
Epoch 10/50
1570/1570 - 51s - loss: 2.8767 - accuracy100: 0.5156 - val_loss: 3.1100 - val_accuracy100: 0.4728 - 51s/epoch - 33ms/step
Epoch 11/50
1570/1570 - 49s - loss: 2.8726 - accuracy100: 0.5169 - val_loss: 3.1232 - val_accuracy100: 0.4691 - 49s/epoch - 31ms/step
Epoch 12/50
1570/1570 - 52s - loss: 2.8701 - accuracy100: 0.5181 - val_loss: 3.1232 - val_accuracy100: 0.4673 - 52s/epoch - 33ms/step
testing model: results/EXC/W5/deepVOL_L2/h100
Evaluating performance on  test set...
7167/7167 - 125s - 125s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0643435
{'0': {'precision': 0.5160375823469775, 'recall': 0.3829126904889054, 'f1-score': 0.43961795222892297, 'support': 646035}, '1': {'precision': 0.35274506580932985, 'recall': 0.7151202742671243, 'f1-score': 0.472447487039672, 'support': 531161}, '2': {'precision': 0.565756859476819, 'recall': 0.2395771059136718, 'f1-score': 0.3366116341027348, 'support': 657375}, 'accuracy': 0.42773542152361504, 'macro avg': {'precision': 0.47817983587770874, 'recall': 0.44587002355656713, 'f1-score': 0.41622569112377655, 'support': 1834571}, 'weighted avg': {'precision': 0.48657543202768005, 'recall': 0.42773542152361504, 'f1-score': 0.41221317485121955, 'support': 1834571}}
[[247375 329096  69564]
 [ 99999 379844  51318]
 [132000 367883 157492]]
Evaluating performance on  train set...
1570/1570 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0238644
{'0': {'precision': 0.531164623556535, 'recall': 0.3961115192644152, 'f1-score': 0.45380316887354005, 'support': 132031}, '1': {'precision': 0.41909150059769695, 'recall': 0.7883890067035767, 'f1-score': 0.5472670239830069, 'support': 140522}, '2': {'precision': 0.6035741835947545, 'recall': 0.18175553249810292, 'f1-score': 0.2793806089171368, 'support': 129146}, 'accuracy': 0.46442236600041326, 'macro avg': {'precision': 0.5179434359163287, 'recall': 0.4554186861553649, 'f1-score': 0.42681693392456116, 'support': 401699}, 'weighted avg': {'precision': 0.5152389320718015, 'recall': 0.46442236600041326, 'f1-score': 0.4304218607785805, 'support': 401699}}
[[ 52299  71111   8621]
 [ 22940 110786   6796]
 [ 23222  82451  23473]]
Evaluating performance on  val set...
492/492 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0210583
{'0': {'precision': 0.5133247459567769, 'recall': 0.41618510524727886, 'f1-score': 0.45967907310571104, 'support': 43089}, '1': {'precision': 0.4158437155235046, 'recall': 0.7551060295123619, 'f1-score': 0.5363271963768241, 'support': 40932}, '2': {'precision': 0.5455758384377464, 'recall': 0.21558149009082414, 'f1-score': 0.30904531244632244, 'support': 41729}, 'accuracy': 0.45993638170974155, 'macro avg': {'precision': 0.49158143330600934, 'recall': 0.46229087495015503, 'f1-score': 0.43501719397628585, 'support': 125750}, 'weighted avg': {'precision': 0.49229661315712414, 'recall': 0.45993638170974155, 'f1-score': 0.43464181492024445, 'support': 125750}}
[[17933 20252  4904]
 [ 7435 30908  2589]
 [ 9567 23166  8996]]
training model: results/EXC/W5/deepVOL_L2/h200
Epoch 1/50
1570/1570 - 56s - loss: 3.2272 - accuracy200: 0.4102 - val_loss: 3.2741 - val_accuracy200: 0.3813 - 56s/epoch - 36ms/step
Epoch 2/50
1570/1570 - 51s - loss: 3.1805 - accuracy200: 0.4283 - val_loss: 3.2379 - val_accuracy200: 0.4148 - 51s/epoch - 33ms/step
Epoch 3/50
1570/1570 - 51s - loss: 3.1592 - accuracy200: 0.4345 - val_loss: 3.2385 - val_accuracy200: 0.4113 - 51s/epoch - 32ms/step
Epoch 4/50
1570/1570 - 53s - loss: 3.1484 - accuracy200: 0.4386 - val_loss: 3.2513 - val_accuracy200: 0.4082 - 53s/epoch - 34ms/step
Epoch 5/50
1570/1570 - 52s - loss: 3.1435 - accuracy200: 0.4405 - val_loss: 3.2420 - val_accuracy200: 0.4116 - 52s/epoch - 33ms/step
Epoch 6/50
1570/1570 - 53s - loss: 3.1393 - accuracy200: 0.4433 - val_loss: 3.2185 - val_accuracy200: 0.4180 - 53s/epoch - 34ms/step
Epoch 7/50
1570/1570 - 54s - loss: 3.1342 - accuracy200: 0.4444 - val_loss: 3.2342 - val_accuracy200: 0.4156 - 54s/epoch - 35ms/step
Epoch 8/50
1570/1570 - 51s - loss: 3.1319 - accuracy200: 0.4454 - val_loss: 3.2354 - val_accuracy200: 0.4155 - 51s/epoch - 33ms/step
Epoch 9/50
1570/1570 - 51s - loss: 3.1276 - accuracy200: 0.4468 - val_loss: 3.2622 - val_accuracy200: 0.4106 - 51s/epoch - 32ms/step
Epoch 10/50
1570/1570 - 53s - loss: 3.1239 - accuracy200: 0.4492 - val_loss: 3.2540 - val_accuracy200: 0.4102 - 53s/epoch - 34ms/step
Epoch 11/50
1570/1570 - 51s - loss: 3.1208 - accuracy200: 0.4496 - val_loss: 3.2742 - val_accuracy200: 0.4094 - 51s/epoch - 33ms/step
Epoch 12/50
1570/1570 - 47s - loss: 3.1177 - accuracy200: 0.4516 - val_loss: 3.2866 - val_accuracy200: 0.4072 - 47s/epoch - 30ms/step
Epoch 13/50
1570/1570 - 49s - loss: 3.1123 - accuracy200: 0.4523 - val_loss: 3.3043 - val_accuracy200: 0.3991 - 49s/epoch - 31ms/step
Epoch 14/50
1570/1570 - 49s - loss: 3.1105 - accuracy200: 0.4535 - val_loss: 3.3299 - val_accuracy200: 0.3983 - 49s/epoch - 31ms/step
Epoch 15/50
1570/1570 - 49s - loss: 3.1067 - accuracy200: 0.4545 - val_loss: 3.3577 - val_accuracy200: 0.3883 - 49s/epoch - 31ms/step
Epoch 16/50
1570/1570 - 50s - loss: 3.1043 - accuracy200: 0.4550 - val_loss: 3.3633 - val_accuracy200: 0.3950 - 50s/epoch - 32ms/step
testing model: results/EXC/W5/deepVOL_L2/h200
Evaluating performance on  test set...
7167/7167 - 126s - 126s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0748943
{'0': {'precision': 0.4234453507713941, 'recall': 0.5679574209040544, 'f1-score': 0.4851689670213365, 'support': 652151}, '1': {'precision': 0.3126506170243737, 'recall': 0.31085698894039226, 'f1-score': 0.31175122314079573, 'support': 497486}, '2': {'precision': 0.4841452719550152, 'recall': 0.32884336301015865, 'f1-score': 0.3916609717969184, 'support': 684934}, 'accuracy': 0.4089659108314696, 'macro avg': {'precision': 0.40674707991692766, 'recall': 0.4025525909515351, 'f1-score': 0.3961937206530169, 'support': 1834571}, 'weighted avg': {'precision': 0.41606303136435685, 'recall': 0.4089659108314696, 'f1-score': 0.40323171578756234, 'support': 1834571}}
[[370394 153179 128578]
 [231429 154647 111410]
 [272892 186806 225236]]
Evaluating performance on  train set...
1570/1570 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0966184
{'0': {'precision': 0.41762673433029207, 'recall': 0.5718245725563826, 'f1-score': 0.4827104217951958, 'support': 135281}, '1': {'precision': 0.3642126483984171, 'recall': 0.3589013479310142, 'f1-score': 0.3615374923103149, 'support': 135912}, '2': {'precision': 0.4511079610850628, 'recall': 0.2853048901966193, 'f1-score': 0.3495411767466967, 'support': 130506}, 'accuracy': 0.40669755214725456, 'macro avg': {'precision': 0.410982447937924, 'recall': 0.4053436035613387, 'f1-score': 0.39792969695073577, 'support': 401699}, 'weighted avg': {'precision': 0.41043200825849485, 'recall': 0.40669755214725456, 'f1-score': 0.3984477258799743, 'support': 401699}}
[[77357 38552 19372]
 [61200 48779 25933]
 [46673 46599 37234]]
Evaluating performance on  val set...
492/492 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0711545
{'0': {'precision': 0.43121322047561467, 'recall': 0.5937354318822563, 'f1-score': 0.49958906156604904, 'support': 45047}, '1': {'precision': 0.36789043758161005, 'recall': 0.31832991749435074, 'f1-score': 0.34132048627252115, 'support': 38058}, '2': {'precision': 0.44927583295447165, 'recall': 0.3244225583304022, 'f1-score': 0.3767752828878389, 'support': 42645}, 'accuracy': 0.41905367793240555, 'macro avg': {'precision': 0.41612649700389875, 'recall': 0.4121626359023364, 'f1-score': 0.40589494357546974, 'support': 125750}, 'weighted avg': {'precision': 0.4181741877740706, 'recall': 0.41905367793240555, 'f1-score': 0.4100401229556843, 'support': 125750}}
[[26746  9410  8891]
 [17875 12115  8068]
 [17404 11406 13835]]
training model: results/EXC/W5/deepVOL_L2/h300
Epoch 1/50
1570/1570 - 53s - loss: 3.2616 - accuracy300: 0.3944 - val_loss: 3.3550 - val_accuracy300: 0.3572 - 53s/epoch - 34ms/step
Epoch 2/50
1570/1570 - 49s - loss: 3.2212 - accuracy300: 0.4111 - val_loss: 3.4026 - val_accuracy300: 0.3506 - 49s/epoch - 31ms/step
Epoch 3/50
1570/1570 - 51s - loss: 3.2042 - accuracy300: 0.4179 - val_loss: 3.4530 - val_accuracy300: 0.3592 - 51s/epoch - 33ms/step
Epoch 4/50
1570/1570 - 52s - loss: 3.1950 - accuracy300: 0.4220 - val_loss: 3.4629 - val_accuracy300: 0.3563 - 52s/epoch - 33ms/step
Epoch 5/50
1570/1570 - 53s - loss: 3.1875 - accuracy300: 0.4254 - val_loss: 3.4802 - val_accuracy300: 0.3488 - 53s/epoch - 34ms/step
Epoch 6/50
1570/1570 - 55s - loss: 3.1824 - accuracy300: 0.4274 - val_loss: 3.4899 - val_accuracy300: 0.3566 - 55s/epoch - 35ms/step
Epoch 7/50
1570/1570 - 53s - loss: 3.1793 - accuracy300: 0.4288 - val_loss: 3.4807 - val_accuracy300: 0.3544 - 53s/epoch - 34ms/step
Epoch 8/50
1570/1570 - 53s - loss: 3.1758 - accuracy300: 0.4303 - val_loss: 3.5026 - val_accuracy300: 0.3508 - 53s/epoch - 34ms/step
Epoch 9/50
1570/1570 - 54s - loss: 3.1712 - accuracy300: 0.4334 - val_loss: 3.4771 - val_accuracy300: 0.3549 - 54s/epoch - 34ms/step
Epoch 10/50
1570/1570 - 54s - loss: 3.1670 - accuracy300: 0.4346 - val_loss: 3.4909 - val_accuracy300: 0.3521 - 54s/epoch - 35ms/step
Epoch 11/50
1570/1570 - 49s - loss: 3.1636 - accuracy300: 0.4363 - val_loss: 3.5157 - val_accuracy300: 0.3505 - 49s/epoch - 31ms/step
testing model: results/EXC/W5/deepVOL_L2/h300
Evaluating performance on  test set...
7167/7167 - 124s - 124s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1267788
{'0': {'precision': 0.4141046845356813, 'recall': 0.22009032810593757, 'f1-score': 0.2874208534376065, 'support': 618855}, '1': {'precision': 0.31046467048119797, 'recall': 0.6905389766501973, 'f1-score': 0.4283460034426545, 'support': 558206}, '2': {'precision': 0.444255957226865, 'recall': 0.17843682985810103, 'f1-score': 0.2546090987314467, 'support': 657510}, 'accuracy': 0.3483054076402603, 'macro avg': {'precision': 0.3896084374145814, 'recall': 0.36302204487141193, 'f1-score': 0.32345865187056927, 'support': 1834571}, 'weighted avg': {'precision': 0.39337628842666356, 'recall': 0.3483054076402603, 'f1-score': 0.31854050345217155, 'support': 1834571}}
[[136204 411653  70998]
 [ 96974 385463  75769]
 [ 95734 444452 117324]]
Evaluating performance on  train set...
1570/1570 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1060594
{'0': {'precision': 0.43564172447968286, 'recall': 0.2575398046022469, 'f1-score': 0.32371054303099484, 'support': 136542}, '1': {'precision': 0.3408509631454614, 'recall': 0.6781540484801387, 'f1-score': 0.4536767885306092, 'support': 133828}, '2': {'precision': 0.4172454126763652, 'recall': 0.17383822308857907, 'f1-score': 0.24542449407401437, 'support': 131329}, 'accuracy': 0.37030463107948985, 'macro avg': {'precision': 0.39791270010050317, 'recall': 0.3698440253903215, 'f1-score': 0.34093727521187284, 'support': 401699}, 'weighted avg': {'precision': 0.3980473385323589, 'recall': 0.37030463107948985, 'f1-score': 0.34141507846486724, 'support': 401699}}
[[35165 86800 14577]
 [25763 90756 17309]
 [19792 88707 22830]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.117218
{'0': {'precision': 0.4371094093829769, 'recall': 0.2248076052512449, 'f1-score': 0.29691190098950704, 'support': 44180}, '1': {'precision': 0.3243181599923173, 'recall': 0.6667900686114813, 'f1-score': 0.4363844874093456, 'support': 40518}, '2': {'precision': 0.40255526262421415, 'recall': 0.19341323199844102, 'f1-score': 0.2612873502698434, 'support': 41052}, 'accuracy': 0.35697017892644134, 'macro avg': {'precision': 0.38799427733316944, 'recall': 0.3616703019537224, 'f1-score': 0.33152791288956535, 'support': 125750}, 'weighted avg': {'precision': 0.38948640599886974, 'recall': 0.35697017892644134, 'f1-score': 0.33022157256338686, 'support': 125750}}
[[ 9932 28763  5485]
 [ 7202 27017  6299]
 [ 5588 27524  7940]]
training model: results/EXC/W5/deepVOL_L2/h500
Epoch 1/50
1570/1570 - 54s - loss: 3.2324 - accuracy500: 0.4126 - val_loss: 3.3676 - val_accuracy500: 0.2987 - 54s/epoch - 34ms/step
Epoch 2/50
1570/1570 - 52s - loss: 3.2164 - accuracy500: 0.4191 - val_loss: 3.2954 - val_accuracy500: 0.3812 - 52s/epoch - 33ms/step
Epoch 3/50
1570/1570 - 52s - loss: 3.2111 - accuracy500: 0.4209 - val_loss: 3.3197 - val_accuracy500: 0.3679 - 52s/epoch - 33ms/step
Epoch 4/50
1570/1570 - 52s - loss: 3.2022 - accuracy500: 0.4248 - val_loss: 3.3310 - val_accuracy500: 0.3498 - 52s/epoch - 33ms/step
Epoch 5/50
1570/1570 - 51s - loss: 3.1956 - accuracy500: 0.4284 - val_loss: 3.3412 - val_accuracy500: 0.3383 - 51s/epoch - 32ms/step
Epoch 6/50
1570/1570 - 50s - loss: 3.1857 - accuracy500: 0.4322 - val_loss: 3.3209 - val_accuracy500: 0.3540 - 50s/epoch - 32ms/step
Epoch 7/50
1570/1570 - 51s - loss: 3.1812 - accuracy500: 0.4351 - val_loss: 3.3683 - val_accuracy500: 0.3305 - 51s/epoch - 33ms/step
Epoch 8/50
1570/1570 - 53s - loss: 3.1758 - accuracy500: 0.4376 - val_loss: 3.3682 - val_accuracy500: 0.3340 - 53s/epoch - 34ms/step
Epoch 9/50
1570/1570 - 51s - loss: 3.1701 - accuracy500: 0.4392 - val_loss: 3.3959 - val_accuracy500: 0.3396 - 51s/epoch - 33ms/step
Epoch 10/50
1570/1570 - 52s - loss: 3.1658 - accuracy500: 0.4398 - val_loss: 3.3985 - val_accuracy500: 0.3309 - 52s/epoch - 33ms/step
Epoch 11/50
1570/1570 - 51s - loss: 3.1597 - accuracy500: 0.4423 - val_loss: 3.4152 - val_accuracy500: 0.3459 - 51s/epoch - 33ms/step
Epoch 12/50
1570/1570 - 50s - loss: 3.1559 - accuracy500: 0.4442 - val_loss: 3.4316 - val_accuracy500: 0.3579 - 50s/epoch - 32ms/step
testing model: results/EXC/W5/deepVOL_L2/h500
Evaluating performance on  test set...
7167/7167 - 121s - 121s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1046524
{'0': {'precision': 0.38427725972097854, 'recall': 0.6060008555565948, 'f1-score': 0.4703170646088307, 'support': 652207}, '1': {'precision': 0.258772405339446, 'recall': 0.24034738719780355, 'f1-score': 0.2492198162932404, 'support': 486604}, '2': {'precision': 0.44790745881708377, 'recall': 0.22795216741405083, 'f1-score': 0.30213811293221615, 'support': 695760}, 'accuracy': 0.36563970541341817, 'macro avg': {'precision': 0.36365237462583605, 'recall': 0.35810013672281643, 'f1-score': 0.34055833127809576, 'support': 1834571}, 'weighted avg': {'precision': 0.3751199053104024, 'recall': 0.36563970541341817, 'f1-score': 0.3478911716682572, 'support': 1834571}}
[[395238 150441 106528]
 [280687 116954  88963]
 [352598 184562 158600]]
Evaluating performance on  train set...
1570/1570 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0946616
{'0': {'precision': 0.37621538090495354, 'recall': 0.6112578552457802, 'f1-score': 0.4657637258886336, 'support': 137806}, '1': {'precision': 0.3306280835966517, 'recall': 0.22268270645250415, 'f1-score': 0.2661258656386093, 'support': 133917}, '2': {'precision': 0.38317180918461696, 'recall': 0.25825537022219486, 'f1-score': 0.3085499979317857, 'support': 129976}, 'accuracy': 0.3674965583683305, 'macro avg': {'precision': 0.3633384245620741, 'recall': 0.36406531064015973, 'f1-score': 0.34681319648634285, 'support': 401699}, 'weighted avg': {'precision': 0.363268509313144, 'recall': 0.3674965583683305, 'f1-score': 0.34834019524498805, 'support': 401699}}
[[84235 28314 25257]
 [75317 29821 28779]
 [64349 32060 33567]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0971724
{'0': {'precision': 0.4121252740194641, 'recall': 0.6228581075377733, 'f1-score': 0.4960380481820397, 'support': 47388}, '1': {'precision': 0.27742386861582646, 'recall': 0.21437514227179605, 'f1-score': 0.24185807611434806, 'support': 35144}, '2': {'precision': 0.4050567212871654, 'recall': 0.25281132861307787, 'f1-score': 0.3113175290631411, 'support': 43218}, 'accuracy': 0.38151888667992045, 'macro avg': {'precision': 0.36486862130748526, 'recall': 0.3633481928075491, 'f1-score': 0.3497378844531763, 'support': 125750}, 'weighted avg': {'precision': 0.3720502449658663, 'recall': 0.38151888667992045, 'f1-score': 0.36151596202993225, 'support': 125750}}
[[29516  9811  8061]
 [19623  7534  7987]
 [22480  9812 10926]]
training model: results/EXC/W5/deepVOL_L2/h1000
Epoch 1/50
1570/1570 - 56s - loss: 3.2241 - accuracy1000: 0.4231 - val_loss: 3.3010 - val_accuracy1000: 0.3600 - 56s/epoch - 36ms/step
Epoch 2/50
1570/1570 - 51s - loss: 3.2052 - accuracy1000: 0.4294 - val_loss: 3.2985 - val_accuracy1000: 0.3627 - 51s/epoch - 33ms/step
Epoch 3/50
1570/1570 - 51s - loss: 3.2050 - accuracy1000: 0.4284 - val_loss: 3.2908 - val_accuracy1000: 0.3756 - 51s/epoch - 32ms/step
Epoch 4/50
1570/1570 - 48s - loss: 3.1869 - accuracy1000: 0.4366 - val_loss: 3.3069 - val_accuracy1000: 0.3691 - 48s/epoch - 30ms/step
Epoch 5/50
1570/1570 - 48s - loss: 3.1810 - accuracy1000: 0.4365 - val_loss: 3.3813 - val_accuracy1000: 0.3609 - 48s/epoch - 30ms/step
Epoch 6/50
1570/1570 - 48s - loss: 3.1728 - accuracy1000: 0.4424 - val_loss: 3.3612 - val_accuracy1000: 0.3607 - 48s/epoch - 31ms/step
Epoch 7/50
1570/1570 - 49s - loss: 3.1637 - accuracy1000: 0.4464 - val_loss: 3.3893 - val_accuracy1000: 0.3619 - 49s/epoch - 31ms/step
Epoch 8/50
1570/1570 - 50s - loss: 3.1546 - accuracy1000: 0.4507 - val_loss: 3.3935 - val_accuracy1000: 0.3578 - 50s/epoch - 32ms/step
Epoch 9/50
1570/1570 - 52s - loss: 3.1477 - accuracy1000: 0.4537 - val_loss: 3.4265 - val_accuracy1000: 0.3605 - 52s/epoch - 33ms/step
Epoch 10/50
1570/1570 - 49s - loss: 3.1402 - accuracy1000: 0.4566 - val_loss: 3.4912 - val_accuracy1000: 0.3639 - 49s/epoch - 31ms/step
Epoch 11/50
1570/1570 - 49s - loss: 3.1349 - accuracy1000: 0.4577 - val_loss: 3.5390 - val_accuracy1000: 0.3628 - 49s/epoch - 31ms/step
Epoch 12/50
1570/1570 - 48s - loss: 3.1311 - accuracy1000: 0.4591 - val_loss: 3.5372 - val_accuracy1000: 0.3709 - 48s/epoch - 30ms/step
Epoch 13/50
1570/1570 - 49s - loss: 3.1269 - accuracy1000: 0.4607 - val_loss: 3.4953 - val_accuracy1000: 0.3720 - 49s/epoch - 31ms/step
testing model: results/EXC/W5/deepVOL_L2/h1000
Evaluating performance on  test set...
7167/7167 - 116s - 116s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0873352
{'0': {'precision': 0.40851683484397316, 'recall': 0.6172193537559357, 'f1-score': 0.49163615284936996, 'support': 709051}, '1': {'precision': 0.18103930516708377, 'recall': 0.03361137834528599, 'f1-score': 0.05669658704802475, 'support': 365888}, '2': {'precision': 0.4436521986737633, 'recall': 0.4061098005349959, 'f1-score': 0.42405168995101655, 'support': 759632}, 'accuracy': 0.4134110917484251, 'macro avg': {'precision': 0.34440277956160675, 'recall': 0.3523135108787392, 'f1-score': 0.32412814328280376, 'support': 1834571}, 'weighted avg': {'precision': 0.37769690381831833, 'recall': 0.4134110917484251, 'f1-score': 0.3769071570392734, 'support': 1834571}}
[[437640  25235 246176]
 [212909  12298 140681]
 [420741  30397 308494]]
Evaluating performance on  train set...
1570/1570 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1048311
{'0': {'precision': 0.35903754544586847, 'recall': 0.5930926734177578, 'f1-score': 0.4472970891313337, 'support': 139533}, '1': {'precision': 0.30487008747878314, 'recall': 0.03546584039612382, 'f1-score': 0.06354000843571847, 'support': 131676}, '2': {'precision': 0.3431716563921302, 'recall': 0.40996244922982605, 'f1-score': 0.3736054222231534, 'support': 130490}, 'accuracy': 0.35081491365425355, 'macro avg': {'precision': 0.33569309643892725, 'recall': 0.34617365434790254, 'f1-score': 0.29481417326340187, 'support': 401699}, 'weighted avg': {'precision': 0.33612762020857334, 'recall': 0.35081491365425355, 'f1-score': 0.2975640228988455, 'support': 401699}}
[[82756  5353 51424]
 [76039  4670 50967]
 [71699  5295 53496]]
Evaluating performance on  val set...
492/492 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0969876
{'0': {'precision': 0.3969188543096197, 'recall': 0.5747804346432464, 'f1-score': 0.46957159317062946, 'support': 46797}, '1': {'precision': 0.2536764705882353, 'recall': 0.030658150513746183, 'f1-score': 0.05470492046974877, 'support': 36010}, '2': {'precision': 0.36035128936622474, 'recall': 0.4500384230258715, 'f1-score': 0.400231946486632, 'support': 42943}, 'accuracy': 0.3763658051689861, 'macro avg': {'precision': 0.33698220475469326, 'recall': 0.351825669394288, 'f1-score': 0.3081694867090034, 'support': 125750}, 'weighted avg': {'precision': 0.34341206163231347, 'recall': 0.3763658051689861, 'f1-score': 0.32709046926200436, 'support': 125750}}
[[26898  1675 18224]
 [18825  1104 16081]
 [22044  1573 19326]]
training model: results/EXC/W5/deepVOL_L3/h10
Epoch 1/50
1570/1570 - 70s - loss: 2.5892 - accuracy10: 0.5566 - val_loss: 2.8255 - val_accuracy10: 0.6140 - 70s/epoch - 45ms/step
Epoch 2/50
1570/1570 - 71s - loss: 2.2178 - accuracy10: 0.6320 - val_loss: 2.6469 - val_accuracy10: 0.5775 - 71s/epoch - 45ms/step
Epoch 3/50
1570/1570 - 70s - loss: 2.1464 - accuracy10: 0.6500 - val_loss: 2.6164 - val_accuracy10: 0.6295 - 70s/epoch - 45ms/step
Epoch 4/50
1570/1570 - 71s - loss: 2.1147 - accuracy10: 0.6567 - val_loss: 2.6523 - val_accuracy10: 0.6302 - 71s/epoch - 45ms/step
Epoch 5/50
1570/1570 - 71s - loss: 2.0935 - accuracy10: 0.6602 - val_loss: 2.5739 - val_accuracy10: 0.6232 - 71s/epoch - 45ms/step
Epoch 6/50
1570/1570 - 72s - loss: 2.0758 - accuracy10: 0.6630 - val_loss: 2.6063 - val_accuracy10: 0.6257 - 72s/epoch - 46ms/step
Epoch 7/50
1570/1570 - 72s - loss: 2.0603 - accuracy10: 0.6660 - val_loss: 2.5952 - val_accuracy10: 0.6316 - 72s/epoch - 46ms/step
Epoch 8/50
1570/1570 - 71s - loss: 2.0457 - accuracy10: 0.6678 - val_loss: 2.6442 - val_accuracy10: 0.6409 - 71s/epoch - 45ms/step
Epoch 9/50
1570/1570 - 69s - loss: 2.0361 - accuracy10: 0.6683 - val_loss: 2.6211 - val_accuracy10: 0.6350 - 69s/epoch - 44ms/step
Epoch 10/50
1570/1570 - 70s - loss: 2.0259 - accuracy10: 0.6694 - val_loss: 2.6589 - val_accuracy10: 0.6227 - 70s/epoch - 44ms/step
Epoch 11/50
1570/1570 - 70s - loss: 2.0199 - accuracy10: 0.6689 - val_loss: 2.6052 - val_accuracy10: 0.6239 - 70s/epoch - 45ms/step
Epoch 12/50
1570/1570 - 70s - loss: 2.0118 - accuracy10: 0.6700 - val_loss: 2.6669 - val_accuracy10: 0.6346 - 70s/epoch - 45ms/step
Epoch 13/50
1570/1570 - 71s - loss: 2.0037 - accuracy10: 0.6704 - val_loss: 2.6828 - val_accuracy10: 0.6371 - 71s/epoch - 45ms/step
Epoch 14/50
1570/1570 - 72s - loss: 1.9993 - accuracy10: 0.6689 - val_loss: 2.6707 - val_accuracy10: 0.6391 - 72s/epoch - 46ms/step
Epoch 15/50
1570/1570 - 71s - loss: 1.9951 - accuracy10: 0.6698 - val_loss: 2.6667 - val_accuracy10: 0.6529 - 71s/epoch - 45ms/step
testing model: results/EXC/W5/deepVOL_L3/h10
Evaluating performance on  test set...
7167/7167 - 149s - 149s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7757738
{'0': {'precision': 0.3639177671224562, 'recall': 0.7785094227630213, 'f1-score': 0.495985062897727, 'support': 269560}, '1': {'precision': 0.8909816767325213, 'recall': 0.6187727132583224, 'f1-score': 0.7303375346748623, 'support': 1294123}, '2': {'precision': 0.35133976300784037, 'recall': 0.4658382800271699, 'f1-score': 0.40056756859707715, 'support': 270888}, 'accuracy': 0.6196614903429739, 'macro avg': {'precision': 0.5354130689542725, 'recall': 0.6210401386828378, 'f1-score': 0.5422967220565554, 'support': 1834571}, 'weighted avg': {'precision': 0.7338561873404288, 'recall': 0.6196614903429739, 'f1-score': 0.6472103191770027, 'support': 1834571}}
[[209855  46387  13318]
 [273695 800768 219660]
 [ 93105  51593 126190]]
Evaluating performance on  train set...
1570/1570 - 32s - 32s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6948255
{'0': {'precision': 0.34893198806207004, 'recall': 0.7686608668017321, 'f1-score': 0.4799786670635585, 'support': 50346}, '1': {'precision': 0.9109530508407725, 'recall': 0.6906629718603283, 'f1-score': 0.7856584005170595, 'support': 300963}, '2': {'precision': 0.3748023447108243, 'recall': 0.46568763643580074, 'f1-score': 0.41533110912485943, 'support': 50390}, 'accuracy': 0.6722172572000428, 'macro avg': {'precision': 0.5448957945378888, 'recall': 0.641670491699287, 'f1-score': 0.5603227255684925, 'support': 401699}, 'weighted avg': {'precision': 0.7732575462252651, 'recall': 0.6722172572000428, 'f1-score': 0.7008920852568697, 'support': 401699}}
[[ 38699   8858   2789]
 [ 56745 207864  36354]
 [ 15463  11461  23466]]
Evaluating performance on  val set...
492/492 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7868767
{'0': {'precision': 0.34962441760958446, 'recall': 0.7943829327572238, 'f1-score': 0.4855487512998696, 'support': 18515}, '1': {'precision': 0.906267727766342, 'recall': 0.6293149050636473, 'f1-score': 0.7428161492168506, 'support': 88849}, '2': {'precision': 0.3504662269729361, 'recall': 0.419068856738823, 'f1-score': 0.3817096430606128, 'support': 18386}, 'accuracy': 0.6228787276341948, 'macro avg': {'precision': 0.5354527907829542, 'recall': 0.6142555648532314, 'f1-score': 0.5366915145257777, 'support': 125750}, 'weighted avg': {'precision': 0.7430453239401796, 'recall': 0.6228787276341948, 'f1-score': 0.6521393293789064, 'support': 125750}}
[[14708  2622  1185]
 [19840 55914 13095]
 [ 7520  3161  7705]]
training model: results/EXC/W5/deepVOL_L3/h20
Epoch 1/50
1570/1570 - 71s - loss: 2.7839 - accuracy20: 0.4912 - val_loss: 2.7919 - val_accuracy20: 0.5925 - 71s/epoch - 45ms/step
Epoch 2/50
1570/1570 - 68s - loss: 2.3671 - accuracy20: 0.6195 - val_loss: 2.7226 - val_accuracy20: 0.5789 - 68s/epoch - 43ms/step
Epoch 3/50
1570/1570 - 71s - loss: 2.2788 - accuracy20: 0.6364 - val_loss: 2.7657 - val_accuracy20: 0.6130 - 71s/epoch - 45ms/step
Epoch 4/50
1570/1570 - 70s - loss: 2.2446 - accuracy20: 0.6422 - val_loss: 2.8001 - val_accuracy20: 0.6411 - 70s/epoch - 44ms/step
Epoch 5/50
1570/1570 - 70s - loss: 2.2232 - accuracy20: 0.6456 - val_loss: 2.6932 - val_accuracy20: 0.6368 - 70s/epoch - 45ms/step
Epoch 6/50
1570/1570 - 71s - loss: 2.2064 - accuracy20: 0.6473 - val_loss: 2.6708 - val_accuracy20: 0.6283 - 71s/epoch - 45ms/step
Epoch 7/50
1570/1570 - 69s - loss: 2.1951 - accuracy20: 0.6486 - val_loss: 2.6631 - val_accuracy20: 0.6328 - 69s/epoch - 44ms/step
Epoch 8/50
1570/1570 - 68s - loss: 2.1830 - accuracy20: 0.6483 - val_loss: 2.6123 - val_accuracy20: 0.6314 - 68s/epoch - 44ms/step
Epoch 9/50
1570/1570 - 71s - loss: 2.1709 - accuracy20: 0.6487 - val_loss: 2.6137 - val_accuracy20: 0.6234 - 71s/epoch - 45ms/step
Epoch 10/50
1570/1570 - 72s - loss: 2.1644 - accuracy20: 0.6501 - val_loss: 2.6019 - val_accuracy20: 0.6308 - 72s/epoch - 46ms/step
Epoch 11/50
1570/1570 - 71s - loss: 2.1564 - accuracy20: 0.6507 - val_loss: 2.6103 - val_accuracy20: 0.6329 - 71s/epoch - 45ms/step
Epoch 12/50
1570/1570 - 71s - loss: 2.1491 - accuracy20: 0.6500 - val_loss: 2.5951 - val_accuracy20: 0.6393 - 71s/epoch - 45ms/step
Epoch 13/50
1570/1570 - 71s - loss: 2.1423 - accuracy20: 0.6516 - val_loss: 2.5884 - val_accuracy20: 0.6313 - 71s/epoch - 45ms/step
Epoch 14/50
1570/1570 - 72s - loss: 2.1382 - accuracy20: 0.6514 - val_loss: 2.6086 - val_accuracy20: 0.6370 - 72s/epoch - 46ms/step
Epoch 15/50
1570/1570 - 73s - loss: 2.1322 - accuracy20: 0.6520 - val_loss: 2.6196 - val_accuracy20: 0.6407 - 73s/epoch - 47ms/step
Epoch 16/50
1570/1570 - 74s - loss: 2.1277 - accuracy20: 0.6520 - val_loss: 2.6471 - val_accuracy20: 0.6496 - 74s/epoch - 47ms/step
Epoch 17/50
1570/1570 - 73s - loss: 2.1239 - accuracy20: 0.6528 - val_loss: 2.6156 - val_accuracy20: 0.6401 - 73s/epoch - 46ms/step
Epoch 18/50
1570/1570 - 71s - loss: 2.1193 - accuracy20: 0.6530 - val_loss: 2.6276 - val_accuracy20: 0.6544 - 71s/epoch - 45ms/step
Epoch 19/50
1570/1570 - 72s - loss: 2.1156 - accuracy20: 0.6529 - val_loss: 2.6298 - val_accuracy20: 0.6468 - 72s/epoch - 46ms/step
Epoch 20/50
1570/1570 - 72s - loss: 2.1115 - accuracy20: 0.6537 - val_loss: 2.6440 - val_accuracy20: 0.6529 - 72s/epoch - 46ms/step
Epoch 21/50
1570/1570 - 73s - loss: 2.1086 - accuracy20: 0.6539 - val_loss: 2.6496 - val_accuracy20: 0.6516 - 73s/epoch - 46ms/step
Epoch 22/50
1570/1570 - 73s - loss: 2.1037 - accuracy20: 0.6543 - val_loss: 2.6294 - val_accuracy20: 0.6476 - 73s/epoch - 47ms/step
Epoch 23/50
1570/1570 - 72s - loss: 2.1000 - accuracy20: 0.6540 - val_loss: 2.6364 - val_accuracy20: 0.6433 - 72s/epoch - 46ms/step
testing model: results/EXC/W5/deepVOL_L3/h20
Evaluating performance on  test set...
7167/7167 - 148s - 148s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77774656
{'0': {'precision': 0.45106214016279533, 'recall': 0.686837133140194, 'f1-score': 0.5445231128731064, 'support': 357255}, '1': {'precision': 0.8056469944104494, 'recall': 0.64257481648786, 'f1-score': 0.7149298065966516, 'support': 1117501}, '2': {'precision': 0.4499873518855709, 'recall': 0.49932882175562443, 'f1-score': 0.4733758055761945, 'support': 359815}, 'accuracy': 0.623099351292482, 'macro avg': {'precision': 0.5688988288196052, 'recall': 0.6095802571278928, 'f1-score': 0.5776095750153175, 'support': 1834571}, 'weighted avg': {'precision': 0.6668413082967287, 'recall': 0.623099351292482, 'f1-score': 0.634369612282351, 'support': 1834571}}
[[245376  84943  26936]
 [206756 718078 192667]
 [ 91864  88285 179666]]
Evaluating performance on  train set...
1570/1570 - 32s - 32s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7011949
{'0': {'precision': 0.4415903339962837, 'recall': 0.6948823814631423, 'f1-score': 0.5400100481856174, 'support': 68059}, '1': {'precision': 0.84098562261029, 'recall': 0.7081659166650977, 'f1-score': 0.768881983768424, 'support': 265555}, '2': {'precision': 0.4690718018792173, 'recall': 0.48906513916427996, 'f1-score': 0.4788598711458813, 'support': 68085}, 'accuracy': 0.6687793596698025, 'macro avg': {'precision': 0.5838825861619303, 'recall': 0.6307044790975066, 'f1-score': 0.5959173010333075, 'support': 401699}, 'weighted avg': {'precision': 0.7102803023773401, 'recall': 0.6687793596698025, 'f1-score': 0.6809481064081716, 'support': 401699}}
[[ 47293  15845   4921]
 [ 44730 188057  32768]
 [ 15074  19713  33298]]
Evaluating performance on  val set...
492/492 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7747091
{'0': {'precision': 0.4296301860337014, 'recall': 0.7094013560443195, 'f1-score': 0.5351567982285154, 'support': 24188}, '1': {'precision': 0.8407473604077715, 'recall': 0.655066147458545, 'f1-score': 0.736382084360052, 'support': 77554}, '2': {'precision': 0.4461296040969076, 'recall': 0.47171776074641786, 'f1-score': 0.4585670034215375, 'support': 24008}, 'accuracy': 0.6305129224652087, 'macro avg': {'precision': 0.5721690501794602, 'recall': 0.6120617547497608, 'f1-score': 0.5767019620033683, 'support': 125750}, 'weighted avg': {'precision': 0.6863291869901077, 'recall': 0.6305129224652087, 'f1-score': 0.6446363850827441, 'support': 125750}}
[[17159  4612  2417]
 [15108 50803 11643]
 [ 7672  5011 11325]]
training model: results/EXC/W5/deepVOL_L3/h30
Epoch 1/50
1570/1570 - 70s - loss: 3.0084 - accuracy30: 0.4019 - val_loss: 3.1416 - val_accuracy30: 0.5134 - 70s/epoch - 44ms/step
Epoch 2/50
1570/1570 - 69s - loss: 2.5620 - accuracy30: 0.5859 - val_loss: 2.8646 - val_accuracy30: 0.5625 - 69s/epoch - 44ms/step
Epoch 3/50
1570/1570 - 72s - loss: 2.4394 - accuracy30: 0.6096 - val_loss: 2.8552 - val_accuracy30: 0.6041 - 72s/epoch - 46ms/step
Epoch 4/50
1570/1570 - 71s - loss: 2.4026 - accuracy30: 0.6171 - val_loss: 2.7800 - val_accuracy30: 0.6067 - 71s/epoch - 45ms/step
Epoch 5/50
1570/1570 - 71s - loss: 2.3783 - accuracy30: 0.6198 - val_loss: 2.7565 - val_accuracy30: 0.6097 - 71s/epoch - 45ms/step
Epoch 6/50
1570/1570 - 70s - loss: 2.3635 - accuracy30: 0.6219 - val_loss: 2.7174 - val_accuracy30: 0.6137 - 70s/epoch - 44ms/step
Epoch 7/50
1570/1570 - 72s - loss: 2.3518 - accuracy30: 0.6239 - val_loss: 2.7341 - val_accuracy30: 0.6126 - 72s/epoch - 46ms/step
Epoch 8/50
1570/1570 - 70s - loss: 2.3403 - accuracy30: 0.6253 - val_loss: 2.7366 - val_accuracy30: 0.6243 - 70s/epoch - 45ms/step
Epoch 9/50
1570/1570 - 70s - loss: 2.3301 - accuracy30: 0.6263 - val_loss: 2.7589 - val_accuracy30: 0.6242 - 70s/epoch - 45ms/step
Epoch 10/50
1570/1570 - 72s - loss: 2.3214 - accuracy30: 0.6271 - val_loss: 2.7596 - val_accuracy30: 0.6240 - 72s/epoch - 46ms/step
Epoch 11/50
1570/1570 - 70s - loss: 2.3133 - accuracy30: 0.6281 - val_loss: 2.7880 - val_accuracy30: 0.6100 - 70s/epoch - 45ms/step
Epoch 12/50
1570/1570 - 70s - loss: 2.3049 - accuracy30: 0.6276 - val_loss: 2.7418 - val_accuracy30: 0.6257 - 70s/epoch - 45ms/step
Epoch 13/50
1570/1570 - 70s - loss: 2.2974 - accuracy30: 0.6287 - val_loss: 2.7461 - val_accuracy30: 0.6217 - 70s/epoch - 45ms/step
Epoch 14/50
1570/1570 - 70s - loss: 2.2897 - accuracy30: 0.6292 - val_loss: 2.7277 - val_accuracy30: 0.6188 - 70s/epoch - 45ms/step
Epoch 15/50
1570/1570 - 72s - loss: 2.2827 - accuracy30: 0.6291 - val_loss: 2.7259 - val_accuracy30: 0.6200 - 72s/epoch - 46ms/step
Epoch 16/50
1570/1570 - 72s - loss: 2.2769 - accuracy30: 0.6296 - val_loss: 2.7306 - val_accuracy30: 0.6251 - 72s/epoch - 46ms/step
testing model: results/EXC/W5/deepVOL_L3/h30
Evaluating performance on  test set...
7167/7167 - 153s - 153s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8606934
{'0': {'precision': 0.4670506397942295, 'recall': 0.6504300102784681, 'f1-score': 0.5436939823918439, 'support': 421269}, '1': {'precision': 0.7280877684188329, 'recall': 0.6278695977208898, 'f1-score': 0.6742751441574856, 'support': 989860}, '2': {'precision': 0.4883435458345169, 'recall': 0.45472107159894387, 'f1-score': 0.4709329485282428, 'support': 423442}, 'accuracy': 0.5930852499031108, 'macro avg': {'precision': 0.5611606513491931, 'recall': 0.5776735598661006, 'f1-score': 0.5629673583591907, 'support': 1834571}, 'weighted avg': {'precision': 0.6128103421223823, 'recall': 0.5930852499031108, 'f1-score': 0.5973561143475257, 'support': 1834571}}
[[274006 113765  33498]
 [200115 621503 168242]
 [112552 118342 192548]]
Evaluating performance on  train set...
1570/1570 - 32s - 32s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77144
{'0': {'precision': 0.4774280293960547, 'recall': 0.6419028515533103, 'f1-score': 0.547581450126486, 'support': 80763}, '1': {'precision': 0.7728267409470753, 'recall': 0.7223981202976195, 'f1-score': 0.746762041544918, 'support': 240038}, '2': {'precision': 0.5155372574122029, 'recall': 0.4380454399367104, 'f1-score': 0.4736427063006229, 'support': 80898}, 'accuracy': 0.6489485908603208, 'macro avg': {'precision': 0.588597342585111, 'recall': 0.6007821372625467, 'f1-score': 0.5893287326573423, 'support': 401699}, 'weighted avg': {'precision': 0.6616203630870379, 'recall': 0.6489485908603208, 'f1-score': 0.6517126884538728, 'support': 401699}}
[[ 51842  23453   5468]
 [ 38802 173403  27833]
 [ 17942  27519  35437]]
Evaluating performance on  val set...
492/492 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8481833
{'0': {'precision': 0.45407189157336475, 'recall': 0.685356482140316, 'f1-score': 0.5462407667333021, 'support': 28108}, '1': {'precision': 0.7763096507597974, 'recall': 0.6684409118950948, 'f1-score': 0.7183484046038684, 'support': 69701}, '2': {'precision': 0.4902398215281651, 'recall': 0.4089688987509395, 'f1-score': 0.4459317073170732, 'support': 27941}, 'accuracy': 0.6145685884691849, 'macro avg': {'precision': 0.5735404546204425, 'recall': 0.5875887642621167, 'f1-score': 0.5701736262180813, 'support': 125750}, 'weighted avg': {'precision': 0.6407189069524551, 'recall': 0.6145685884691849, 'f1-score': 0.6193488306543159, 'support': 125750}}
[[19264  6527  2317]
 [13545 46591  9565]
 [ 9616  6898 11427]]
training model: results/EXC/W5/deepVOL_L3/h50
Epoch 1/50
1570/1570 - 69s - loss: 3.0853 - accuracy50: 0.4192 - val_loss: 3.2287 - val_accuracy50: 0.4929 - 69s/epoch - 44ms/step
Epoch 2/50
1570/1570 - 67s - loss: 2.8015 - accuracy50: 0.5368 - val_loss: 3.0222 - val_accuracy50: 0.5628 - 67s/epoch - 42ms/step
Epoch 3/50
1570/1570 - 68s - loss: 2.6622 - accuracy50: 0.5746 - val_loss: 2.9918 - val_accuracy50: 0.5605 - 68s/epoch - 44ms/step
Epoch 4/50
1570/1570 - 66s - loss: 2.6229 - accuracy50: 0.5801 - val_loss: 2.9741 - val_accuracy50: 0.5665 - 66s/epoch - 42ms/step
Epoch 5/50
1570/1570 - 66s - loss: 2.5991 - accuracy50: 0.5857 - val_loss: 2.9476 - val_accuracy50: 0.5627 - 66s/epoch - 42ms/step
Epoch 6/50
1570/1570 - 68s - loss: 2.5838 - accuracy50: 0.5881 - val_loss: 2.8786 - val_accuracy50: 0.5697 - 68s/epoch - 43ms/step
Epoch 7/50
1570/1570 - 66s - loss: 2.5735 - accuracy50: 0.5884 - val_loss: 2.8954 - val_accuracy50: 0.5703 - 66s/epoch - 42ms/step
Epoch 8/50
1570/1570 - 68s - loss: 2.5650 - accuracy50: 0.5905 - val_loss: 2.8651 - val_accuracy50: 0.5790 - 68s/epoch - 43ms/step
Epoch 9/50
1570/1570 - 68s - loss: 2.5581 - accuracy50: 0.5910 - val_loss: 2.8761 - val_accuracy50: 0.5728 - 68s/epoch - 43ms/step
Epoch 10/50
1570/1570 - 68s - loss: 2.5524 - accuracy50: 0.5917 - val_loss: 2.8410 - val_accuracy50: 0.5803 - 68s/epoch - 43ms/step
Epoch 11/50
1570/1570 - 69s - loss: 2.5456 - accuracy50: 0.5926 - val_loss: 2.8086 - val_accuracy50: 0.5832 - 69s/epoch - 44ms/step
Epoch 12/50
1570/1570 - 67s - loss: 2.5406 - accuracy50: 0.5924 - val_loss: 2.8373 - val_accuracy50: 0.5843 - 67s/epoch - 43ms/step
Epoch 13/50
1570/1570 - 67s - loss: 2.5350 - accuracy50: 0.5932 - val_loss: 2.8230 - val_accuracy50: 0.5848 - 67s/epoch - 42ms/step
Epoch 14/50
1570/1570 - 67s - loss: 2.5272 - accuracy50: 0.5941 - val_loss: 2.8590 - val_accuracy50: 0.5868 - 67s/epoch - 43ms/step
Epoch 15/50
1570/1570 - 67s - loss: 2.5217 - accuracy50: 0.5947 - val_loss: 2.8543 - val_accuracy50: 0.5853 - 67s/epoch - 43ms/step
Epoch 16/50
1570/1570 - 67s - loss: 2.5151 - accuracy50: 0.5948 - val_loss: 2.8526 - val_accuracy50: 0.5845 - 67s/epoch - 43ms/step
Epoch 17/50
1570/1570 - 65s - loss: 2.5101 - accuracy50: 0.5948 - val_loss: 2.8670 - val_accuracy50: 0.5843 - 65s/epoch - 42ms/step
Epoch 18/50
1570/1570 - 67s - loss: 2.5062 - accuracy50: 0.5958 - val_loss: 2.8811 - val_accuracy50: 0.5823 - 67s/epoch - 43ms/step
Epoch 19/50
1570/1570 - 66s - loss: 2.5014 - accuracy50: 0.5953 - val_loss: 2.8694 - val_accuracy50: 0.5812 - 66s/epoch - 42ms/step
Epoch 20/50
1570/1570 - 66s - loss: 2.4966 - accuracy50: 0.5971 - val_loss: 2.8521 - val_accuracy50: 0.5873 - 66s/epoch - 42ms/step
Epoch 21/50
1570/1570 - 65s - loss: 2.4921 - accuracy50: 0.5977 - val_loss: 2.8500 - val_accuracy50: 0.5853 - 65s/epoch - 42ms/step
testing model: results/EXC/W5/deepVOL_L3/h50
Evaluating performance on  test set...
7167/7167 - 143s - 143s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91209775
{'0': {'precision': 0.5120091405452485, 'recall': 0.5282274349604729, 'f1-score': 0.5199918583040543, 'support': 517493}, '1': {'precision': 0.5759969479562964, 'recall': 0.6807604585596677, 'f1-score': 0.6240121512499978, 'support': 798413}, '2': {'precision': 0.5653931036027962, 'recall': 0.389224258432707, 'f1-score': 0.4610532349915098, 'support': 518665}, 'accuracy': 0.5553118412969572, 'macro avg': {'precision': 0.5511330640347804, 'recall': 0.5327373839842825, 'f1-score': 0.5350190815151873, 'support': 1834571}, 'weighted avg': {'precision': 0.5549494739952594, 'recall': 0.5553118412969572, 'f1-score': 0.5485989566891529, 'support': 1834571}}
[[273354 184923  59216]
 [158922 543528  95963]
 [101609 215179 201877]]
Evaluating performance on  train set...
1570/1570 - 38s - 38s/epoch - 24ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8437263
{'0': {'precision': 0.5252969259431766, 'recall': 0.5367128013959391, 'f1-score': 0.5309435072577481, 'support': 100864}, '1': {'precision': 0.6402163734867233, 'recall': 0.763341657071938, 'f1-score': 0.6963785134376272, 'support': 200631}, '2': {'precision': 0.602217847106534, 'recall': 0.35715141112131255, 'f1-score': 0.44838408579787137, 'support': 100204}, 'accuracy': 0.605112285567054, 'macro avg': {'precision': 0.5892437155121446, 'recall': 0.5524019565297299, 'f1-score': 0.5585687021644156, 'support': 401699}, 'weighted avg': {'precision': 0.6018820995790641, 'recall': 0.605112285567054, 'f1-score': 0.5929765381015137, 'support': 401699}}
[[ 54135  37867   8862]
 [ 32704 153150  14777]
 [ 16217  48199  35788]]
Evaluating performance on  val set...
492/492 - 12s - 12s/epoch - 25ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87286294
{'0': {'precision': 0.4942099945597264, 'recall': 0.5588855686412375, 'f1-score': 0.5245617653124356, 'support': 34134}, '1': {'precision': 0.6452970142741382, 'recall': 0.7144952292216643, 'f1-score': 0.6781354141931891, 'support': 57957}, '2': {'precision': 0.5544239892065979, 'recall': 0.3784723253810274, 'f1-score': 0.4498552157638251, 'support': 33659}, 'accuracy': 0.5823141153081511, 'macro avg': {'precision': 0.5646436660134875, 'recall': 0.5506177077479765, 'f1-score': 0.55085079842315, 'support': 125750}, 'weighted avg': {'precision': 0.5799618295291674, 'recall': 0.5823141153081511, 'f1-score': 0.5753460215106475, 'support': 125750}}
[[19077 10292  4765]
 [11074 41410  5473]
 [ 8450 12470 12739]]
training model: results/EXC/W5/deepVOL_L3/h100
Epoch 1/50
1570/1570 - 74s - loss: 3.1861 - accuracy100: 0.4283 - val_loss: 3.3218 - val_accuracy100: 0.3780 - 74s/epoch - 47ms/step
Epoch 2/50
1570/1570 - 71s - loss: 3.0709 - accuracy100: 0.4702 - val_loss: 3.1592 - val_accuracy100: 0.4601 - 71s/epoch - 45ms/step
Epoch 3/50
1570/1570 - 70s - loss: 2.9592 - accuracy100: 0.4995 - val_loss: 3.2080 - val_accuracy100: 0.4584 - 70s/epoch - 44ms/step
Epoch 4/50
1570/1570 - 70s - loss: 2.9153 - accuracy100: 0.5081 - val_loss: 3.1518 - val_accuracy100: 0.4565 - 70s/epoch - 44ms/step
Epoch 5/50
1570/1570 - 69s - loss: 2.8973 - accuracy100: 0.5115 - val_loss: 3.1088 - val_accuracy100: 0.4571 - 69s/epoch - 44ms/step
Epoch 6/50
1570/1570 - 70s - loss: 2.8867 - accuracy100: 0.5149 - val_loss: 3.1029 - val_accuracy100: 0.4602 - 70s/epoch - 44ms/step
Epoch 7/50
1570/1570 - 71s - loss: 2.8796 - accuracy100: 0.5167 - val_loss: 3.0871 - val_accuracy100: 0.4632 - 71s/epoch - 45ms/step
Epoch 8/50
1570/1570 - 71s - loss: 2.8744 - accuracy100: 0.5178 - val_loss: 3.0865 - val_accuracy100: 0.4660 - 71s/epoch - 45ms/step
Epoch 9/50
1570/1570 - 71s - loss: 2.8688 - accuracy100: 0.5190 - val_loss: 3.0925 - val_accuracy100: 0.4676 - 71s/epoch - 46ms/step
Epoch 10/50
1570/1570 - 71s - loss: 2.8651 - accuracy100: 0.5199 - val_loss: 3.1098 - val_accuracy100: 0.4692 - 71s/epoch - 45ms/step
Epoch 11/50
1570/1570 - 72s - loss: 2.8607 - accuracy100: 0.5216 - val_loss: 3.0941 - val_accuracy100: 0.4718 - 72s/epoch - 46ms/step
Epoch 12/50
1570/1570 - 72s - loss: 2.8564 - accuracy100: 0.5227 - val_loss: 3.0881 - val_accuracy100: 0.4717 - 72s/epoch - 46ms/step
Epoch 13/50
1570/1570 - 74s - loss: 2.8523 - accuracy100: 0.5229 - val_loss: 3.1096 - val_accuracy100: 0.4654 - 74s/epoch - 47ms/step
Epoch 14/50
1570/1570 - 74s - loss: 2.8489 - accuracy100: 0.5238 - val_loss: 3.1005 - val_accuracy100: 0.4747 - 74s/epoch - 47ms/step
Epoch 15/50
1570/1570 - 73s - loss: 2.8451 - accuracy100: 0.5248 - val_loss: 3.0860 - val_accuracy100: 0.4718 - 73s/epoch - 47ms/step
Epoch 16/50
1570/1570 - 73s - loss: 2.8410 - accuracy100: 0.5255 - val_loss: 3.1016 - val_accuracy100: 0.4657 - 73s/epoch - 46ms/step
Epoch 17/50
1570/1570 - 71s - loss: 2.8373 - accuracy100: 0.5264 - val_loss: 3.0783 - val_accuracy100: 0.4770 - 71s/epoch - 45ms/step
Epoch 18/50
1570/1570 - 70s - loss: 2.8331 - accuracy100: 0.5271 - val_loss: 3.0965 - val_accuracy100: 0.4657 - 70s/epoch - 45ms/step
Epoch 19/50
1570/1570 - 71s - loss: 2.8308 - accuracy100: 0.5277 - val_loss: 3.1030 - val_accuracy100: 0.4745 - 71s/epoch - 45ms/step
Epoch 20/50
1570/1570 - 70s - loss: 2.8265 - accuracy100: 0.5285 - val_loss: 3.0838 - val_accuracy100: 0.4778 - 70s/epoch - 45ms/step
Epoch 21/50
1570/1570 - 70s - loss: 2.8235 - accuracy100: 0.5303 - val_loss: 3.0958 - val_accuracy100: 0.4725 - 70s/epoch - 44ms/step
Epoch 22/50
1570/1570 - 70s - loss: 2.8183 - accuracy100: 0.5309 - val_loss: 3.0818 - val_accuracy100: 0.4796 - 70s/epoch - 45ms/step
Epoch 23/50
1570/1570 - 71s - loss: 2.8155 - accuracy100: 0.5325 - val_loss: 3.0856 - val_accuracy100: 0.4815 - 71s/epoch - 45ms/step
Epoch 24/50
1570/1570 - 71s - loss: 2.8097 - accuracy100: 0.5338 - val_loss: 3.0898 - val_accuracy100: 0.4790 - 71s/epoch - 45ms/step
Epoch 25/50
1570/1570 - 71s - loss: 2.8074 - accuracy100: 0.5346 - val_loss: 3.1004 - val_accuracy100: 0.4793 - 71s/epoch - 45ms/step
Epoch 26/50
1570/1570 - 71s - loss: 2.8035 - accuracy100: 0.5359 - val_loss: 3.1126 - val_accuracy100: 0.4785 - 71s/epoch - 45ms/step
Epoch 27/50
1570/1570 - 71s - loss: 2.7978 - accuracy100: 0.5370 - val_loss: 3.1058 - val_accuracy100: 0.4776 - 71s/epoch - 45ms/step
testing model: results/EXC/W5/deepVOL_L3/h100
Evaluating performance on  test set...
7167/7167 - 173s - 173s/epoch - 24ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0722663
{'0': {'precision': 0.5145621074386837, 'recall': 0.3946334176940878, 'f1-score': 0.4466880829505764, 'support': 646035}, '1': {'precision': 0.35820416082586953, 'recall': 0.7326912179169781, 'f1-score': 0.48116995996607376, 'support': 531161}, '2': {'precision': 0.5608098480050665, 'recall': 0.21552842745769157, 'f1-score': 0.3113860760536914, 'support': 657375}, 'accuracy': 0.4283328363960839, 'macro avg': {'precision': 0.4778587054232066, 'recall': 0.4476176876895858, 'f1-score': 0.41308137299011377, 'support': 1834571}, 'weighted avg': {'precision': 0.4858637715192872, 'recall': 0.4283328363960839, 'f1-score': 0.4081893121172801, 'support': 1834571}}
[[254947 316458  74630]
 [105657 389177  36327]
 [134860 380832 141683]]
Evaluating performance on  train set...
1570/1570 - 39s - 39s/epoch - 25ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0259348
{'0': {'precision': 0.5360065060647234, 'recall': 0.4093356863160924, 'f1-score': 0.464184488533883, 'support': 132031}, '1': {'precision': 0.4295567272017184, 'recall': 0.7827101806122885, 'f1-score': 0.5546937252251797, 'support': 140522}, '2': {'precision': 0.5915885765283355, 'recall': 0.20531026899787838, 'f1-score': 0.30482967936263405, 'support': 129146}, 'accuracy': 0.4743551763882907, 'macro avg': {'precision': 0.5190506032649258, 'recall': 0.4657853786420864, 'f1-score': 0.44123596437389895, 'support': 401699}, 'weighted avg': {'precision': 0.5166379396672628, 'recall': 0.4743551763882907, 'f1-score': 0.4446138716618079, 'support': 401699}}
[[ 54045  66503  11483]
 [ 23712 109988   6822]
 [ 23072  79559  26515]]
Evaluating performance on  val set...
492/492 - 12s - 12s/epoch - 24ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0186495
{'0': {'precision': 0.5193062151558951, 'recall': 0.4085729536540648, 'f1-score': 0.45733212105468246, 'support': 43089}, '1': {'precision': 0.4368098506029541, 'recall': 0.7557412293560051, 'f1-score': 0.5536286353467561, 'support': 40932}, '2': {'precision': 0.5311207265465265, 'recall': 0.2676795513911189, 'f1-score': 0.3559592096876991, 'support': 41729}, 'accuracy': 0.4748230616302187, 'macro avg': {'precision': 0.49574559743512525, 'recall': 0.4773312448003962, 'f1-score': 0.4556399886963793, 'support': 125750}, 'weighted avg': {'precision': 0.4963739412150496, 'recall': 0.4748230616302187, 'f1-score': 0.4550372399777068, 'support': 125750}}
[[17605 18555  6929]
 [ 7066 30934  2932]
 [ 9230 21329 11170]]
training model: results/EXC/W5/deepVOL_L3/h200
Epoch 1/50
1570/1570 - 70s - loss: 3.2465 - accuracy200: 0.4010 - val_loss: 3.3626 - val_accuracy200: 0.3553 - 70s/epoch - 45ms/step
Epoch 2/50
1570/1570 - 66s - loss: 3.2119 - accuracy200: 0.4147 - val_loss: 3.3272 - val_accuracy200: 0.3663 - 66s/epoch - 42ms/step
Epoch 3/50
1570/1570 - 65s - loss: 3.1988 - accuracy200: 0.4205 - val_loss: 3.3387 - val_accuracy200: 0.3768 - 65s/epoch - 42ms/step
Epoch 4/50
1570/1570 - 66s - loss: 3.1802 - accuracy200: 0.4299 - val_loss: 3.3613 - val_accuracy200: 0.3809 - 66s/epoch - 42ms/step
Epoch 5/50
1570/1570 - 70s - loss: 3.1707 - accuracy200: 0.4347 - val_loss: 3.3494 - val_accuracy200: 0.3846 - 70s/epoch - 44ms/step
Epoch 6/50
1570/1570 - 69s - loss: 3.1597 - accuracy200: 0.4378 - val_loss: 3.4299 - val_accuracy200: 0.3813 - 69s/epoch - 44ms/step
Epoch 7/50
1570/1570 - 69s - loss: 3.1495 - accuracy200: 0.4401 - val_loss: 3.3942 - val_accuracy200: 0.3869 - 69s/epoch - 44ms/step
Epoch 8/50
1570/1570 - 69s - loss: 3.1364 - accuracy200: 0.4445 - val_loss: 3.3778 - val_accuracy200: 0.3899 - 69s/epoch - 44ms/step
Epoch 9/50
1570/1570 - 72s - loss: 3.1253 - accuracy200: 0.4484 - val_loss: 3.4127 - val_accuracy200: 0.3820 - 72s/epoch - 46ms/step
Epoch 10/50
1570/1570 - 75s - loss: 3.1170 - accuracy200: 0.4504 - val_loss: 3.4205 - val_accuracy200: 0.3842 - 75s/epoch - 48ms/step
Epoch 11/50
1570/1570 - 75s - loss: 3.1119 - accuracy200: 0.4528 - val_loss: 3.4226 - val_accuracy200: 0.3875 - 75s/epoch - 48ms/step
Epoch 12/50
1570/1570 - 72s - loss: 3.1056 - accuracy200: 0.4550 - val_loss: 3.4596 - val_accuracy200: 0.3869 - 72s/epoch - 46ms/step
testing model: results/EXC/W5/deepVOL_L3/h200
Evaluating performance on  test set...
7167/7167 - 155s - 155s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1190544
{'0': {'precision': 0.4078876626043382, 'recall': 0.48277776159202396, 'f1-score': 0.4421842083087554, 'support': 652151}, '1': {'precision': 0.26782467579283775, 'recall': 0.4106909541173018, 'f1-score': 0.32421706085704965, 'support': 497486}, '2': {'precision': 0.43723421641579474, 'recall': 0.19139362332721108, 'f1-score': 0.2662428725926753, 'support': 684934}, 'accuracy': 0.35444199216056504, 'macro avg': {'precision': 0.3709821849376569, 'recall': 0.3616207796788456, 'f1-score': 0.3442147139194935, 'support': 1834571}, 'weighted avg': {'precision': 0.3808628581303713, 'recall': 0.35444199216056504, 'f1-score': 0.3445073088295219, 'support': 1834571}}
[[314844 248303  89004]
 [213448 204313  79725]
 [243597 310245 131092]]
Evaluating performance on  train set...
1570/1570 - 32s - 32s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0973319
{'0': {'precision': 0.3949819247894899, 'recall': 0.5298231089362142, 'f1-score': 0.4525722584413329, 'support': 135281}, '1': {'precision': 0.33912089676021295, 'recall': 0.373064924362823, 'f1-score': 0.35528399456255166, 'support': 135912}, '2': {'precision': 0.4004440108033202, 'recall': 0.21699385468867333, 'f1-score': 0.2814660206236799, 'support': 130506}, 'accuracy': 0.3751515438176346, 'macro avg': {'precision': 0.3781822774510077, 'recall': 0.3732939626625702, 'f1-score': 0.3631074245425215, 'support': 401699}, 'weighted avg': {'precision': 0.3778562932987614, 'recall': 0.3751515438176346, 'f1-score': 0.36406560745907124, 'support': 401699}}
[[71675 44502 19104]
 [61912 50704 23296]
 [47877 54310 28319]]
Evaluating performance on  val set...
492/492 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1061976
{'0': {'precision': 0.40952171038130925, 'recall': 0.4949497191821875, 'f1-score': 0.44820134484526236, 'support': 45047}, '1': {'precision': 0.2936484301880371, 'recall': 0.3627358242682222, 'f1-score': 0.3245562477959328, 'support': 38058}, '2': {'precision': 0.40314480941796327, 'recall': 0.22966350099659982, 'f1-score': 0.2926246283930145, 'support': 42645}, 'accuracy': 0.36497017892644135, 'macro avg': {'precision': 0.36877164999576983, 'recall': 0.3624496814823365, 'f1-score': 0.3551274070114032, 'support': 125750}, 'weighted avg': {'precision': 0.37229031285305925, 'recall': 0.36497017892644135, 'f1-score': 0.35802039711874556, 'support': 125750}}
[[22296 16012  6739]
 [16492 13805  7761]
 [15656 17195  9794]]
training model: results/EXC/W5/deepVOL_L3/h300
Epoch 1/50
1570/1570 - 72s - loss: 3.2813 - accuracy300: 0.3772 - val_loss: 3.3835 - val_accuracy300: 0.3287 - 72s/epoch - 46ms/step
Epoch 2/50
1570/1570 - 67s - loss: 3.2426 - accuracy300: 0.3971 - val_loss: 3.3850 - val_accuracy300: 0.3494 - 67s/epoch - 43ms/step
Epoch 3/50
1570/1570 - 67s - loss: 3.2297 - accuracy300: 0.4049 - val_loss: 3.4418 - val_accuracy300: 0.3521 - 67s/epoch - 43ms/step
Epoch 4/50
1570/1570 - 67s - loss: 3.2178 - accuracy300: 0.4115 - val_loss: 3.4251 - val_accuracy300: 0.3640 - 67s/epoch - 43ms/step
Epoch 5/50
1570/1570 - 69s - loss: 3.2018 - accuracy300: 0.4212 - val_loss: 3.4480 - val_accuracy300: 0.3713 - 69s/epoch - 44ms/step
Epoch 6/50
1570/1570 - 68s - loss: 3.1911 - accuracy300: 0.4260 - val_loss: 3.5243 - val_accuracy300: 0.3605 - 68s/epoch - 43ms/step
Epoch 7/50
1570/1570 - 71s - loss: 3.1819 - accuracy300: 0.4294 - val_loss: 3.5355 - val_accuracy300: 0.3603 - 71s/epoch - 45ms/step
Epoch 8/50
1570/1570 - 69s - loss: 3.1728 - accuracy300: 0.4340 - val_loss: 3.5346 - val_accuracy300: 0.3595 - 69s/epoch - 44ms/step
Epoch 9/50
1570/1570 - 68s - loss: 3.1661 - accuracy300: 0.4361 - val_loss: 3.5936 - val_accuracy300: 0.3603 - 68s/epoch - 43ms/step
Epoch 10/50
1570/1570 - 70s - loss: 3.1614 - accuracy300: 0.4383 - val_loss: 3.6251 - val_accuracy300: 0.3600 - 70s/epoch - 44ms/step
Epoch 11/50
1570/1570 - 68s - loss: 3.1535 - accuracy300: 0.4413 - val_loss: 3.6144 - val_accuracy300: 0.3579 - 68s/epoch - 43ms/step
testing model: results/EXC/W5/deepVOL_L3/h300
Evaluating performance on  test set...
7167/7167 - 159s - 159s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1418228
{'0': {'precision': 0.44611943636770296, 'recall': 0.03223049017944429, 'f1-score': 0.0601176975880283, 'support': 618855}, '1': {'precision': 0.30485569298357545, 'recall': 0.9586980433746681, 'f1-score': 0.4626072448922256, 'support': 558206}, '2': {'precision': 0.48096524087464065, 'recall': 0.02519049139937035, 'f1-score': 0.04787360881686025, 'support': 657510}, 'accuracy': 0.31160418430248815, 'macro avg': {'precision': 0.41064679007530636, 'recall': 0.3387063416511609, 'f1-score': 0.19019951709903804, 'support': 1834571}, 'weighted avg': {'precision': 0.4156257655214269, 'recall': 0.31160418430248815, 'f1-score': 0.17819514971964712, 'support': 1834571}}
[[ 19946 590847   8062]
 [ 13243 535151   9812]
 [ 11521 629426  16563]]
Evaluating performance on  train set...
1570/1570 - 38s - 38s/epoch - 24ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1178714
{'0': {'precision': 0.4607277121374866, 'recall': 0.05026292276369176, 'f1-score': 0.09063775274369708, 'support': 136542}, '1': {'precision': 0.33304101619419124, 'recall': 0.9307842902830499, 'f1-score': 0.4905572697503795, 'support': 133828}, '2': {'precision': 0.45179968701095463, 'recall': 0.04396591765718158, 'f1-score': 0.08013378761909387, 'support': 131329}, 'accuracy': 0.3415542483302174, 'macro avg': {'precision': 0.4151894717808775, 'recall': 0.3416710435679744, 'f1-score': 0.22044293670439016, 'support': 401699}, 'weighted avg': {'precision': 0.4152693869822294, 'recall': 0.3415542483302174, 'f1-score': 0.220438807479012, 'support': 401699}}
[[  6863 127032   2647]
 [  4904 124565   4359]
 [  3129 122426   5774]]
Evaluating performance on  val set...
492/492 - 12s - 12s/epoch - 25ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1266986
{'0': {'precision': 0.458210158559527, 'recall': 0.038592123132639204, 'f1-score': 0.07118849293334169, 'support': 44180}, '1': {'precision': 0.32201457560992086, 'recall': 0.9411125919344488, 'f1-score': 0.4798439613678547, 'support': 40518}, '2': {'precision': 0.4374307862679956, 'recall': 0.03848777160674267, 'f1-score': 0.0707504925667204, 'support': 41052}, 'accuracy': 0.32935984095427434, 'macro avg': {'precision': 0.4058851734791478, 'recall': 0.3393974955579436, 'f1-score': 0.2072609822893056, 'support': 125750}, 'weighted avg': {'precision': 0.4075429027244249, 'recall': 0.32935984095427434, 'f1-score': 0.20271868362104792, 'support': 125750}}
[[ 1705 41681   794]
 [ 1148 38132  1238]
 [  868 38604  1580]]
training model: results/EXC/W5/deepVOL_L3/h500
Epoch 1/50
1570/1570 - 72s - loss: 3.2532 - accuracy500: 0.3939 - val_loss: 3.4065 - val_accuracy500: 0.2920 - 72s/epoch - 46ms/step
Epoch 2/50
1570/1570 - 71s - loss: 3.2397 - accuracy500: 0.4026 - val_loss: 3.3344 - val_accuracy500: 0.3303 - 71s/epoch - 45ms/step
Epoch 3/50
1570/1570 - 73s - loss: 3.2304 - accuracy500: 0.4087 - val_loss: 3.3189 - val_accuracy500: 0.3663 - 73s/epoch - 46ms/step
Epoch 4/50
1570/1570 - 68s - loss: 3.2183 - accuracy500: 0.4181 - val_loss: 3.3753 - val_accuracy500: 0.3596 - 68s/epoch - 43ms/step
Epoch 5/50
1570/1570 - 67s - loss: 3.2106 - accuracy500: 0.4225 - val_loss: 3.3608 - val_accuracy500: 0.3638 - 67s/epoch - 42ms/step
Epoch 6/50
1570/1570 - 68s - loss: 3.2076 - accuracy500: 0.4248 - val_loss: 3.3567 - val_accuracy500: 0.3674 - 68s/epoch - 43ms/step
Epoch 7/50
1570/1570 - 67s - loss: 3.2045 - accuracy500: 0.4253 - val_loss: 3.3422 - val_accuracy500: 0.3662 - 67s/epoch - 43ms/step
Epoch 8/50
1570/1570 - 71s - loss: 3.2002 - accuracy500: 0.4287 - val_loss: 3.3547 - val_accuracy500: 0.3617 - 71s/epoch - 45ms/step
Epoch 9/50
1570/1570 - 71s - loss: 3.1913 - accuracy500: 0.4329 - val_loss: 3.3672 - val_accuracy500: 0.3585 - 71s/epoch - 45ms/step
Epoch 10/50
1570/1570 - 71s - loss: 3.1848 - accuracy500: 0.4362 - val_loss: 3.3700 - val_accuracy500: 0.3543 - 71s/epoch - 45ms/step
Epoch 11/50
1570/1570 - 68s - loss: 3.1779 - accuracy500: 0.4383 - val_loss: 3.4122 - val_accuracy500: 0.3527 - 68s/epoch - 43ms/step
Epoch 12/50
1570/1570 - 68s - loss: 3.1715 - accuracy500: 0.4408 - val_loss: 3.3780 - val_accuracy500: 0.3572 - 68s/epoch - 43ms/step
Epoch 13/50
1570/1570 - 68s - loss: 3.1617 - accuracy500: 0.4439 - val_loss: 3.4123 - val_accuracy500: 0.3581 - 68s/epoch - 43ms/step
testing model: results/EXC/W5/deepVOL_L3/h500
Evaluating performance on  test set...
7167/7167 - 153s - 153s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1016649
{'0': {'precision': 0.3755502015154181, 'recall': 0.41561191462219815, 'f1-score': 0.39456676477523817, 'support': 652207}, '1': {'precision': 0.26363170332212205, 'recall': 0.043330922063937, 'f1-score': 0.07442863622805485, 'support': 486604}, '2': {'precision': 0.40115858564635737, 'recall': 0.5954941359089341, 'f1-score': 0.47937978827598055, 'support': 695760}, 'accuracy': 0.38508784887584074, 'macro avg': {'precision': 0.34678016349463253, 'recall': 0.3514789908650231, 'f1-score': 0.3161250630930912, 'support': 1834571}, 'weighted avg': {'precision': 0.35557675837699043, 'recall': 0.38508784887584074, 'f1-score': 0.3418182013930104, 'support': 1834571}}
[[271065  29049 352093]
 [199122  21085 266397]
 [251594  29845 414321]]
Evaluating performance on  train set...
1570/1570 - 33s - 33s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1011124
{'0': {'precision': 0.3673609123409605, 'recall': 0.4749865753305371, 'f1-score': 0.41429814706394297, 'support': 137806}, '1': {'precision': 0.3317261330761813, 'recall': 0.04110008438062382, 'f1-score': 0.07313848341295207, 'support': 133917}, '2': {'precision': 0.352702389236836, 'recall': 0.5615190496707084, 'f1-score': 0.4332628879443402, 'support': 129976}, 'accuracy': 0.35833795951695174, 'macro avg': {'precision': 0.3505964782179926, 'recall': 0.3592019031272898, 'f1-score': 0.30689983947374505, 'support': 401699}, 'weighted avg': {'precision': 0.3507381203156303, 'recall': 0.35833795951695174, 'f1-score': 0.3066998769251594, 'support': 401699}}
[[65456  5623 66727]
 [61196  5504 67217]
 [51527  5465 72984]]
Evaluating performance on  val set...
492/492 - 11s - 11s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1080756
{'0': {'precision': 0.3872043723752688, 'recall': 0.4066430319912214, 'f1-score': 0.39668570840409656, 'support': 47388}, '1': {'precision': 0.2805088400172488, 'recall': 0.037019121329387665, 'f1-score': 0.06540646523553366, 'support': 35144}, '2': {'precision': 0.35769850725348656, 'recall': 0.5904947012818733, 'f1-score': 0.44551905938217395, 'support': 43218}, 'accuracy': 0.36652882703777334, 'macro avg': {'precision': 0.34180390654866805, 'recall': 0.3447189515341608, 'f1-score': 0.30253707767393473, 'support': 125750}, 'weighted avg': {'precision': 0.3472449905221997, 'recall': 0.36652882703777334, 'f1-score': 0.3208845317890236, 'support': 125750}}
[[19270  1777 26341]
 [14359  1301 19484]
 [16138  1560 25520]]
training model: results/EXC/W5/deepVOL_L3/h1000
Epoch 1/50
1570/1570 - 68s - loss: 3.2318 - accuracy1000: 0.4175 - val_loss: 3.3693 - val_accuracy1000: 0.3352 - 68s/epoch - 43ms/step
Epoch 2/50
1570/1570 - 67s - loss: 3.2353 - accuracy1000: 0.4131 - val_loss: 3.3505 - val_accuracy1000: 0.3323 - 67s/epoch - 43ms/step
Epoch 3/50
1570/1570 - 68s - loss: 3.2163 - accuracy1000: 0.4233 - val_loss: 3.3409 - val_accuracy1000: 0.3472 - 68s/epoch - 44ms/step
Epoch 4/50
1570/1570 - 69s - loss: 3.2097 - accuracy1000: 0.4256 - val_loss: 3.4301 - val_accuracy1000: 0.3509 - 69s/epoch - 44ms/step
Epoch 5/50
1570/1570 - 72s - loss: 3.1864 - accuracy1000: 0.4370 - val_loss: 3.4000 - val_accuracy1000: 0.3492 - 72s/epoch - 46ms/step
Epoch 6/50
1570/1570 - 70s - loss: 3.1867 - accuracy1000: 0.4360 - val_loss: 3.4095 - val_accuracy1000: 0.3654 - 70s/epoch - 45ms/step
Epoch 7/50
1570/1570 - 70s - loss: 3.1737 - accuracy1000: 0.4412 - val_loss: 3.4195 - val_accuracy1000: 0.3561 - 70s/epoch - 44ms/step
Epoch 8/50
1570/1570 - 67s - loss: 3.1544 - accuracy1000: 0.4484 - val_loss: 3.4721 - val_accuracy1000: 0.3521 - 67s/epoch - 43ms/step
Epoch 9/50
1570/1570 - 68s - loss: 3.1354 - accuracy1000: 0.4552 - val_loss: 3.5542 - val_accuracy1000: 0.3479 - 68s/epoch - 43ms/step
Epoch 10/50
1570/1570 - 69s - loss: 3.1260 - accuracy1000: 0.4582 - val_loss: 3.5856 - val_accuracy1000: 0.3440 - 69s/epoch - 44ms/step
Epoch 11/50
1570/1570 - 68s - loss: 3.1138 - accuracy1000: 0.4626 - val_loss: 3.6529 - val_accuracy1000: 0.3422 - 68s/epoch - 44ms/step
Epoch 12/50
1570/1570 - 68s - loss: 3.1056 - accuracy1000: 0.4655 - val_loss: 3.6340 - val_accuracy1000: 0.3476 - 68s/epoch - 43ms/step
Epoch 13/50
1570/1570 - 67s - loss: 3.0969 - accuracy1000: 0.4681 - val_loss: 3.7451 - val_accuracy1000: 0.3454 - 67s/epoch - 43ms/step
testing model: results/EXC/W5/deepVOL_L3/h1000
Evaluating performance on  test set...
7167/7167 - 146s - 146s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982122
{'0': {'precision': 0.39167604641953535, 'recall': 0.5663471315885599, 'f1-score': 0.46308818094122783, 'support': 709051}, '1': {'precision': 0.19869497375762446, 'recall': 0.05742467640370824, 'f1-score': 0.08909893921756959, 'support': 365888}, '2': {'precision': 0.422821958929343, 'recall': 0.39161594035006425, 'f1-score': 0.40662110442864957, 'support': 759632}, 'accuracy': 0.3924972105195165, 'macro avg': {'precision': 0.33773099303550097, 'recall': 0.33846258278077745, 'f1-score': 0.31960274152914897, 'support': 1834571}, 'weighted avg': {'precision': 0.3660842176473204, 'recall': 0.3924972105195165, 'f1-score': 0.36511847906477346, 'support': 1834571}}
[[401569  40955 266527]
 [205320  21011 139557]
 [418369  43779 297484]]
Evaluating performance on  train set...
1570/1570 - 38s - 38s/epoch - 24ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1174821
{'0': {'precision': 0.33919470521705536, 'recall': 0.5222922176116044, 'f1-score': 0.4112859988825744, 'support': 139533}, '1': {'precision': 0.3064254325191021, 'recall': 0.058780643397430055, 'f1-score': 0.09863956415076305, 'support': 131676}, '2': {'precision': 0.3210901867105646, 'recall': 0.39760901218484174, 'f1-score': 0.35527617717245796, 'support': 130490}, 'accuracy': 0.32985145594089105, 'macro avg': {'precision': 0.32223677481557406, 'recall': 0.3262272910646254, 'f1-score': 0.2884005800685985, 'support': 401699}, 'weighted avg': {'precision': 0.3225718473765139, 'recall': 0.32985145594089105, 'f1-score': 0.2906067002666976, 'support': 401699}}
[[72877  9150 57506]
 [71739  7740 52197]
 [70237  8369 51884]]
Evaluating performance on  val set...
492/492 - 12s - 12s/epoch - 25ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1146605
{'0': {'precision': 0.3622023312007051, 'recall': 0.5093061521037673, 'f1-score': 0.42333925399644756, 'support': 46797}, '1': {'precision': 0.2555970149253731, 'recall': 0.05706748125520689, 'f1-score': 0.09330306469920545, 'support': 36010}, '2': {'precision': 0.3452906159092223, 'recall': 0.41736720769391983, 'f1-score': 0.3779230363732209, 'support': 42943}, 'accuracy': 0.3484055666003976, 'macro avg': {'precision': 0.3210299873451002, 'recall': 0.327913613684298, 'f1-score': 0.29818845168962466, 'support': 125750}, 'weighted avg': {'precision': 0.32589937113043194, 'recall': 0.3484055666003976, 'f1-score': 0.3133200745929652, 'support': 125750}}
[[23834  2920 20043]
 [20014  2055 13941]
 [21955  3065 17923]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        28 (peak)  17.04 (ave)

============================================
