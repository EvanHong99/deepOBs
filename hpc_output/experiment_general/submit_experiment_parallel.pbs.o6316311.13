This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/CHTR_orderbooks/CHTR_orderbooks_2019-03-13.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-03-05.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-02-20.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-02-21.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-03-01.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-02-25.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-02-27.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-02-22.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-03-15.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-02-26.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-03-11.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-02-28.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-02-19.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-03-07.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-03-06.csv
training model: results/CHTR/W1/deepLOB_L1/h10
Epoch 1/50
384/384 - 20s - loss: 3.3191 - accuracy10: 0.3617 - val_loss: 3.4898 - val_accuracy10: 0.3297 - 20s/epoch - 53ms/step
Epoch 2/50
384/384 - 9s - loss: 3.2710 - accuracy10: 0.3835 - val_loss: 3.3376 - val_accuracy10: 0.3571 - 9s/epoch - 24ms/step
Epoch 3/50
384/384 - 9s - loss: 3.2563 - accuracy10: 0.3912 - val_loss: 3.4043 - val_accuracy10: 0.3210 - 9s/epoch - 24ms/step
Epoch 4/50
384/384 - 9s - loss: 3.2476 - accuracy10: 0.4003 - val_loss: 3.3399 - val_accuracy10: 0.3471 - 9s/epoch - 24ms/step
Epoch 5/50
384/384 - 9s - loss: 3.2327 - accuracy10: 0.4088 - val_loss: 3.3527 - val_accuracy10: 0.3598 - 9s/epoch - 24ms/step
Epoch 6/50
384/384 - 9s - loss: 3.2250 - accuracy10: 0.4131 - val_loss: 3.2998 - val_accuracy10: 0.3774 - 9s/epoch - 24ms/step
Epoch 7/50
384/384 - 9s - loss: 3.2154 - accuracy10: 0.4201 - val_loss: 3.2939 - val_accuracy10: 0.3703 - 9s/epoch - 23ms/step
Epoch 8/50
384/384 - 9s - loss: 3.2087 - accuracy10: 0.4226 - val_loss: 3.3097 - val_accuracy10: 0.3676 - 9s/epoch - 24ms/step
Epoch 9/50
384/384 - 9s - loss: 3.2034 - accuracy10: 0.4253 - val_loss: 3.2786 - val_accuracy10: 0.3889 - 9s/epoch - 24ms/step
Epoch 10/50
384/384 - 9s - loss: 3.1990 - accuracy10: 0.4268 - val_loss: 3.2916 - val_accuracy10: 0.3840 - 9s/epoch - 24ms/step
Epoch 11/50
384/384 - 9s - loss: 3.1935 - accuracy10: 0.4291 - val_loss: 3.2934 - val_accuracy10: 0.3856 - 9s/epoch - 24ms/step
Epoch 12/50
384/384 - 9s - loss: 3.1913 - accuracy10: 0.4299 - val_loss: 3.2734 - val_accuracy10: 0.3862 - 9s/epoch - 24ms/step
Epoch 13/50
384/384 - 9s - loss: 3.1849 - accuracy10: 0.4330 - val_loss: 3.2689 - val_accuracy10: 0.3954 - 9s/epoch - 24ms/step
Epoch 14/50
384/384 - 9s - loss: 3.1812 - accuracy10: 0.4351 - val_loss: 3.2855 - val_accuracy10: 0.3873 - 9s/epoch - 24ms/step
Epoch 15/50
384/384 - 9s - loss: 3.1777 - accuracy10: 0.4367 - val_loss: 3.3091 - val_accuracy10: 0.3837 - 9s/epoch - 24ms/step
Epoch 16/50
384/384 - 9s - loss: 3.1745 - accuracy10: 0.4382 - val_loss: 3.3147 - val_accuracy10: 0.3810 - 9s/epoch - 24ms/step
Epoch 17/50
384/384 - 9s - loss: 3.1719 - accuracy10: 0.4393 - val_loss: 3.3161 - val_accuracy10: 0.3793 - 9s/epoch - 24ms/step
Epoch 18/50
384/384 - 9s - loss: 3.1677 - accuracy10: 0.4406 - val_loss: 3.3130 - val_accuracy10: 0.3861 - 9s/epoch - 24ms/step
Epoch 19/50
384/384 - 9s - loss: 3.1652 - accuracy10: 0.4418 - val_loss: 3.3169 - val_accuracy10: 0.3810 - 9s/epoch - 24ms/step
Epoch 20/50
384/384 - 9s - loss: 3.1637 - accuracy10: 0.4414 - val_loss: 3.3120 - val_accuracy10: 0.3843 - 9s/epoch - 24ms/step
Epoch 21/50
384/384 - 9s - loss: 3.1616 - accuracy10: 0.4429 - val_loss: 3.3087 - val_accuracy10: 0.3879 - 9s/epoch - 25ms/step
Epoch 22/50
384/384 - 9s - loss: 3.1554 - accuracy10: 0.4446 - val_loss: 3.3299 - val_accuracy10: 0.3769 - 9s/epoch - 25ms/step
Epoch 23/50
384/384 - 9s - loss: 3.1557 - accuracy10: 0.4466 - val_loss: 3.3362 - val_accuracy10: 0.3762 - 9s/epoch - 25ms/step
testing model: results/CHTR/W1/deepLOB_L1/h10
Evaluating performance on  test set...
1304/1304 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0893952
{'0': {'precision': 0.417870844885043, 'recall': 0.5100493924219378, 'f1-score': 0.45938166229248284, 'support': 117022}, '1': {'precision': 0.35937809582638897, 'recall': 0.2972105486370822, 'f1-score': 0.32535122844224973, 'support': 103748}, '2': {'precision': 0.3865599786877759, 'recall': 0.35964096980641047, 'f1-score': 0.37261492605754903, 'support': 112971}, 'accuracy': 0.39297239476120704, 'macro avg': {'precision': 0.3879363064664026, 'recall': 0.3889669702884768, 'f1-score': 0.3857826055974272, 'support': 333741}, 'weighted avg': {'precision': 0.38908886845868634, 'recall': 0.39297239476120704, 'f1-score': 0.3883459956818755, 'support': 333741}}
[[59687 26120 31215]
 [39653 30835 33260]
 [43496 28846 40629]]
Evaluating performance on  train set...
384/384 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0829514
{'0': {'precision': 0.4069504899792835, 'recall': 0.5157987903820622, 'f1-score': 0.45495472051629016, 'support': 33895}, '1': {'precision': 0.37766484060458055, 'recall': 0.3548527131782946, 'f1-score': 0.3659035682312316, 'support': 32250}, '2': {'precision': 0.41724372573349877, 'recall': 0.3247250864459051, 'f1-score': 0.36521617265783757, 'support': 32101}, 'accuracy': 0.40053539075382205, 'macro avg': {'precision': 0.400619685439121, 'recall': 0.39845886333542063, 'f1-score': 0.39535815380178646, 'support': 98246}, 'weighted avg': {'precision': 0.4007004743920015, 'recall': 0.40053539075382205, 'f1-score': 0.39640173325983874, 'support': 98246}}
[[17483  9249  7163]
 [13410 11444  7396]
 [12068  9609 10424]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0886316
{'0': {'precision': 0.4021749876421157, 'recall': 0.4987127620448694, 'f1-score': 0.4452714535901926, 'support': 8157}, '1': {'precision': 0.3579701310576044, 'recall': 0.3197223356472029, 'f1-score': 0.3377669135092386, 'support': 7347}, '2': {'precision': 0.42052836725855347, 'recall': 0.35962962962962963, 'f1-score': 0.3877021361549211, 'support': 8100}, 'accuracy': 0.39527198779867817, 'macro avg': {'precision': 0.3935578286527579, 'recall': 0.3926882424405673, 'f1-score': 0.3902468344181174, 'support': 23604}, 'weighted avg': {'precision': 0.39471393415824607, 'recall': 0.39527198779867817, 'f1-score': 0.39205389185487366, 'support': 23604}}
[[4068 2038 2051]
 [3035 2349 1963]
 [3012 2175 2913]]
training model: results/CHTR/W1/deepLOB_L1/h20
Epoch 1/50
384/384 - 12s - loss: 3.3250 - accuracy20: 0.3602 - val_loss: 3.4547 - val_accuracy20: 0.3262 - 12s/epoch - 30ms/step
Epoch 2/50
384/384 - 9s - loss: 3.2903 - accuracy20: 0.3715 - val_loss: 3.3681 - val_accuracy20: 0.3379 - 9s/epoch - 24ms/step
Epoch 3/50
384/384 - 9s - loss: 3.2782 - accuracy20: 0.3777 - val_loss: 3.3661 - val_accuracy20: 0.3467 - 9s/epoch - 24ms/step
Epoch 4/50
384/384 - 9s - loss: 3.2651 - accuracy20: 0.3847 - val_loss: 3.3615 - val_accuracy20: 0.3434 - 9s/epoch - 24ms/step
Epoch 5/50
384/384 - 10s - loss: 3.2599 - accuracy20: 0.3885 - val_loss: 3.3598 - val_accuracy20: 0.3407 - 10s/epoch - 25ms/step
Epoch 6/50
384/384 - 9s - loss: 3.2513 - accuracy20: 0.3947 - val_loss: 3.3750 - val_accuracy20: 0.3491 - 9s/epoch - 24ms/step
Epoch 7/50
384/384 - 9s - loss: 3.2475 - accuracy20: 0.3964 - val_loss: 3.3308 - val_accuracy20: 0.3559 - 9s/epoch - 24ms/step
Epoch 8/50
384/384 - 9s - loss: 3.2390 - accuracy20: 0.4029 - val_loss: 3.3395 - val_accuracy20: 0.3512 - 9s/epoch - 24ms/step
Epoch 9/50
384/384 - 9s - loss: 3.2325 - accuracy20: 0.4083 - val_loss: 3.3198 - val_accuracy20: 0.3561 - 9s/epoch - 24ms/step
Epoch 10/50
384/384 - 9s - loss: 3.2277 - accuracy20: 0.4121 - val_loss: 3.3345 - val_accuracy20: 0.3466 - 9s/epoch - 24ms/step
Epoch 11/50
384/384 - 9s - loss: 3.2242 - accuracy20: 0.4142 - val_loss: 3.3277 - val_accuracy20: 0.3553 - 9s/epoch - 24ms/step
Epoch 12/50
384/384 - 9s - loss: 3.2194 - accuracy20: 0.4166 - val_loss: 3.3375 - val_accuracy20: 0.3589 - 9s/epoch - 24ms/step
Epoch 13/50
384/384 - 9s - loss: 3.2153 - accuracy20: 0.4178 - val_loss: 3.3539 - val_accuracy20: 0.3516 - 9s/epoch - 24ms/step
Epoch 14/50
384/384 - 9s - loss: 3.2117 - accuracy20: 0.4197 - val_loss: 3.3565 - val_accuracy20: 0.3574 - 9s/epoch - 24ms/step
Epoch 15/50
384/384 - 9s - loss: 3.2090 - accuracy20: 0.4210 - val_loss: 3.3611 - val_accuracy20: 0.3566 - 9s/epoch - 23ms/step
Epoch 16/50
384/384 - 9s - loss: 3.2044 - accuracy20: 0.4247 - val_loss: 3.3859 - val_accuracy20: 0.3515 - 9s/epoch - 24ms/step
Epoch 17/50
384/384 - 9s - loss: 3.2031 - accuracy20: 0.4239 - val_loss: 3.3935 - val_accuracy20: 0.3530 - 9s/epoch - 24ms/step
Epoch 18/50
384/384 - 9s - loss: 3.1987 - accuracy20: 0.4257 - val_loss: 3.3909 - val_accuracy20: 0.3506 - 9s/epoch - 24ms/step
Epoch 19/50
384/384 - 9s - loss: 3.1958 - accuracy20: 0.4283 - val_loss: 3.4075 - val_accuracy20: 0.3526 - 9s/epoch - 24ms/step
testing model: results/CHTR/W1/deepLOB_L1/h20
Evaluating performance on  test set...
1304/1304 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1079789
{'0': {'precision': 0.36076652363525824, 'recall': 0.532601472352398, 'f1-score': 0.43015819354748774, 'support': 115869}, '1': {'precision': 0.3171469683828747, 'recall': 0.3011351406994264, 'f1-score': 0.3089337231126664, 'support': 106859}, '2': {'precision': 0.36393929989055684, 'recall': 0.20069721564141135, 'f1-score': 0.2587207952064657, 'support': 111013}, 'accuracy': 0.34808728924525306, 'macro avg': {'precision': 0.34728426396956324, 'recall': 0.3448112762310786, 'f1-score': 0.3326042372888733, 'support': 333741}, 'weighted avg': {'precision': 0.3478555458282612, 'recall': 0.34808728924525306, 'f1-score': 0.33431828898608695, 'support': 333741}}
[[61712 34802 19355]
 [55096 32179 19584]
 [54250 34483 22280]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1006358
{'0': {'precision': 0.3616366036075671, 'recall': 0.5847585736728221, 'f1-score': 0.4468959893078413, 'support': 33737}, '1': {'precision': 0.34368818228441644, 'recall': 0.287174778083869, 'f1-score': 0.31290021344717184, 'support': 32670}, '2': {'precision': 0.39253476457672604, 'recall': 0.20214202707371462, 'f1-score': 0.26686016378148647, 'support': 31839}, 'accuracy': 0.36180607861897685, 'macro avg': {'precision': 0.3659531834895699, 'recall': 0.35802512627680194, 'f1-score': 0.3422187888454999, 'support': 98246}, 'weighted avg': {'precision': 0.36568146673145735, 'recall': 0.36180607861897685, 'f1-score': 0.3439930452052653, 'support': 98246}}
[[19728  9004  5005]
 [18333  9382  4955]
 [16491  8912  6436]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1057863
{'0': {'precision': 0.35852415243951774, 'recall': 0.5452196382428941, 'f1-score': 0.4325881089524553, 'support': 8127}, '1': {'precision': 0.3257493188010899, 'recall': 0.3202518081971605, 'f1-score': 0.3229771714169931, 'support': 7466}, '2': {'precision': 0.395134443021767, 'recall': 0.1926101610285857, 'f1-score': 0.2589795233299765, 'support': 8011}, 'accuracy': 0.3543890865954923, 'macro avg': {'precision': 0.3598026380874582, 'recall': 0.3526938691562134, 'f1-score': 0.3381816012331416, 'support': 23604}, 'weighted avg': {'precision': 0.3605826226102471, 'recall': 0.3543890865954923, 'f1-score': 0.33899661433029643, 'support': 23604}}
[[4431 2516 1180]
 [3893 2391 1182]
 [4035 2433 1543]]
training model: results/CHTR/W1/deepLOB_L1/h30
Epoch 1/50
384/384 - 11s - loss: 3.3295 - accuracy30: 0.3590 - val_loss: 3.5059 - val_accuracy30: 0.3298 - 11s/epoch - 30ms/step
Epoch 2/50
384/384 - 9s - loss: 3.2960 - accuracy30: 0.3693 - val_loss: 3.3567 - val_accuracy30: 0.3609 - 9s/epoch - 24ms/step
Epoch 3/50
384/384 - 9s - loss: 3.2820 - accuracy30: 0.3740 - val_loss: 3.4480 - val_accuracy30: 0.3477 - 9s/epoch - 25ms/step
Epoch 4/50
384/384 - 9s - loss: 3.2738 - accuracy30: 0.3774 - val_loss: 3.3437 - val_accuracy30: 0.3528 - 9s/epoch - 25ms/step
Epoch 5/50
384/384 - 9s - loss: 3.2645 - accuracy30: 0.3848 - val_loss: 3.3719 - val_accuracy30: 0.3445 - 9s/epoch - 24ms/step
Epoch 6/50
384/384 - 9s - loss: 3.2578 - accuracy30: 0.3907 - val_loss: 3.3755 - val_accuracy30: 0.3394 - 9s/epoch - 25ms/step
Epoch 7/50
384/384 - 9s - loss: 3.2536 - accuracy30: 0.3943 - val_loss: 3.3565 - val_accuracy30: 0.3462 - 9s/epoch - 25ms/step
Epoch 8/50
384/384 - 9s - loss: 3.2520 - accuracy30: 0.3954 - val_loss: 3.3489 - val_accuracy30: 0.3480 - 9s/epoch - 24ms/step
Epoch 9/50
384/384 - 9s - loss: 3.2463 - accuracy30: 0.3988 - val_loss: 3.3742 - val_accuracy30: 0.3568 - 9s/epoch - 24ms/step
Epoch 10/50
384/384 - 9s - loss: 3.2407 - accuracy30: 0.4043 - val_loss: 3.3749 - val_accuracy30: 0.3525 - 9s/epoch - 24ms/step
Epoch 11/50
384/384 - 9s - loss: 3.2363 - accuracy30: 0.4069 - val_loss: 3.3726 - val_accuracy30: 0.3548 - 9s/epoch - 24ms/step
Epoch 12/50
384/384 - 9s - loss: 3.2324 - accuracy30: 0.4086 - val_loss: 3.3769 - val_accuracy30: 0.3560 - 9s/epoch - 23ms/step
Epoch 13/50
384/384 - 9s - loss: 3.2315 - accuracy30: 0.4088 - val_loss: 3.3997 - val_accuracy30: 0.3564 - 9s/epoch - 24ms/step
Epoch 14/50
384/384 - 9s - loss: 3.2278 - accuracy30: 0.4117 - val_loss: 3.3727 - val_accuracy30: 0.3559 - 9s/epoch - 24ms/step
testing model: results/CHTR/W1/deepLOB_L1/h30
Evaluating performance on  test set...
1304/1304 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1112796
{'0': {'precision': 0.3370240131787366, 'recall': 0.36734200599086697, 'f1-score': 0.3515305216288666, 'support': 115843}, '1': {'precision': 0.31189866351426787, 'recall': 0.3558796530470784, 'f1-score': 0.3324408277551735, 'support': 106758}, '2': {'precision': 0.3589330531722407, 'recall': 0.2766600683822206, 'f1-score': 0.31247173598231753, 'support': 111140}, 'accuracy': 0.33347715743645523, 'macro avg': {'precision': 0.3359519099550818, 'recall': 0.33329390914005536, 'f1-score': 0.33214769512211917, 'support': 333741}, 'weighted avg': {'precision': 0.33628283551521515, 'recall': 0.33347715743645523, 'f1-score': 0.3324169845587278, 'support': 333741}}
[[42554 43169 30120]
 [43968 37993 24797]
 [39742 40650 30748]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1069568
{'0': {'precision': 0.3524340198034713, 'recall': 0.5553512102515424, 'f1-score': 0.4312135799341272, 'support': 33712}, '1': {'precision': 0.3430541644194468, 'recall': 0.2736631837738168, 'f1-score': 0.30445485315737286, 'support': 32540}, '2': {'precision': 0.36752582698528646, 'recall': 0.22016628117772083, 'f1-score': 0.27537138389366694, 'support': 31994}, 'accuracy': 0.35289986360767867, 'macro avg': {'precision': 0.35433800373606816, 'recall': 0.34972689173436006, 'f1-score': 0.33701327232838896, 'support': 98246}, 'weighted avg': {'precision': 0.3542419996171923, 'recall': 0.35289986360767867, 'f1-score': 0.33847958374665826, 'support': 98246}}
[[18722  8853  6137]
 [17650  8905  5985]
 [16750  8200  7044]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1128143
{'0': {'precision': 0.353956737874513, 'recall': 0.6512174020516623, 'f1-score': 0.4586325455890673, 'support': 8091}, '1': {'precision': 0.32800871301506623, 'recall': 0.24119060331019754, 'f1-score': 0.27797861702945925, 'support': 7492}, '2': {'precision': 0.39139918977874727, 'recall': 0.15658895399576112, 'f1-score': 0.22368655387355293, 'support': 8021}, 'accuracy': 0.35299101847144554, 'macro avg': {'precision': 0.3577882135561088, 'recall': 0.34966565311920705, 'f1-score': 0.3200992388306932, 'support': 23604}, 'weighted avg': {'precision': 0.35844425289217474, 'recall': 0.35299101847144554, 'f1-score': 0.3214540575226919, 'support': 23604}}
[[5269 1914  908]
 [4640 1807 1045]
 [4977 1788 1256]]
training model: results/CHTR/W1/deepLOB_L1/h50
Epoch 1/50
384/384 - 12s - loss: 3.3408 - accuracy50: 0.3519 - val_loss: 3.4851 - val_accuracy50: 0.3265 - 12s/epoch - 30ms/step
Epoch 2/50
384/384 - 9s - loss: 3.3078 - accuracy50: 0.3594 - val_loss: 3.4374 - val_accuracy50: 0.3189 - 9s/epoch - 24ms/step
Epoch 3/50
384/384 - 9s - loss: 3.2939 - accuracy50: 0.3636 - val_loss: 3.3996 - val_accuracy50: 0.3274 - 9s/epoch - 24ms/step
Epoch 4/50
384/384 - 9s - loss: 3.2900 - accuracy50: 0.3670 - val_loss: 3.3759 - val_accuracy50: 0.3296 - 9s/epoch - 24ms/step
Epoch 5/50
384/384 - 9s - loss: 3.2830 - accuracy50: 0.3696 - val_loss: 3.3618 - val_accuracy50: 0.3334 - 9s/epoch - 24ms/step
Epoch 6/50
384/384 - 9s - loss: 3.2794 - accuracy50: 0.3750 - val_loss: 3.3534 - val_accuracy50: 0.3392 - 9s/epoch - 25ms/step
Epoch 7/50
384/384 - 9s - loss: 3.2755 - accuracy50: 0.3777 - val_loss: 3.3494 - val_accuracy50: 0.3414 - 9s/epoch - 23ms/step
Epoch 8/50
384/384 - 9s - loss: 3.2707 - accuracy50: 0.3815 - val_loss: 3.3678 - val_accuracy50: 0.3427 - 9s/epoch - 24ms/step
Epoch 9/50
384/384 - 9s - loss: 3.2683 - accuracy50: 0.3834 - val_loss: 3.3503 - val_accuracy50: 0.3415 - 9s/epoch - 24ms/step
Epoch 10/50
384/384 - 9s - loss: 3.2650 - accuracy50: 0.3866 - val_loss: 3.3636 - val_accuracy50: 0.3426 - 9s/epoch - 25ms/step
Epoch 11/50
384/384 - 9s - loss: 3.2621 - accuracy50: 0.3888 - val_loss: 3.3754 - val_accuracy50: 0.3495 - 9s/epoch - 24ms/step
Epoch 12/50
384/384 - 9s - loss: 3.2584 - accuracy50: 0.3896 - val_loss: 3.4017 - val_accuracy50: 0.3368 - 9s/epoch - 24ms/step
Epoch 13/50
384/384 - 9s - loss: 3.2552 - accuracy50: 0.3914 - val_loss: 3.3904 - val_accuracy50: 0.3376 - 9s/epoch - 24ms/step
Epoch 14/50
384/384 - 9s - loss: 3.2523 - accuracy50: 0.3942 - val_loss: 3.4428 - val_accuracy50: 0.3356 - 9s/epoch - 24ms/step
Epoch 15/50
384/384 - 9s - loss: 3.2520 - accuracy50: 0.3943 - val_loss: 3.4210 - val_accuracy50: 0.3408 - 9s/epoch - 23ms/step
Epoch 16/50
384/384 - 9s - loss: 3.2485 - accuracy50: 0.3973 - val_loss: 3.4178 - val_accuracy50: 0.3254 - 9s/epoch - 24ms/step
Epoch 17/50
384/384 - 9s - loss: 3.2463 - accuracy50: 0.3971 - val_loss: 3.4352 - val_accuracy50: 0.3307 - 9s/epoch - 24ms/step
testing model: results/CHTR/W1/deepLOB_L1/h50
Evaluating performance on  test set...
1304/1304 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1228982
{'0': {'precision': 0.34916624947048175, 'recall': 0.39436301161323994, 'f1-score': 0.37039094734262024, 'support': 114955}, '1': {'precision': 0.3081274662599065, 'recall': 0.4356031839788485, 'f1-score': 0.3609406317490406, 'support': 106659}, '2': {'precision': 0.3502946104177256, 'recall': 0.1659546763937321, 'f1-score': 0.22521301316808676, 'support': 112127}, 'accuracy': 0.3308044261867736, 'macro avg': {'precision': 0.3358627753827046, 'recall': 0.3319736239952735, 'f1-score': 0.3188481974199158, 'support': 333741}, 'weighted avg': {'precision': 0.33642991845174225, 'recall': 0.3308044261867736, 'f1-score': 0.31859531109749745, 'support': 333741}}
[[45334 52769 16852]
 [42537 46461 17661]
 [41964 51555 18608]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.116137
{'0': {'precision': 0.34602853117294824, 'recall': 0.46616050774067264, 'f1-score': 0.3972100780874883, 'support': 33718}, '1': {'precision': 0.31838835844932706, 'recall': 0.3464993270946136, 'f1-score': 0.3318495870989014, 'support': 31951}, '2': {'precision': 0.3464265927977839, 'recall': 0.19194523743745587, 'f1-score': 0.24702233985817842, 'support': 32577}, 'accuracy': 0.33631903588950185, 'macro avg': {'precision': 0.33694782747335306, 'recall': 0.3348683574242474, 'f1-score': 0.3253606683481894, 'support': 98246}, 'weighted avg': {'precision': 0.33717154457664766, 'recall': 0.33631903588950185, 'f1-score': 0.3261537603150338, 'support': 98246}}
[[15718 12049  5951]
 [15034 11071  5846]
 [14672 11652  6253]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.116042
{'0': {'precision': 0.3614726332679622, 'recall': 0.4986473192326611, 'f1-score': 0.41912144702842374, 'support': 8132}, '1': {'precision': 0.32394702302827827, 'recall': 0.37100300628587046, 'f1-score': 0.34588190330594304, 'support': 7318}, '2': {'precision': 0.35181023720349563, 'recall': 0.17279862644101054, 'f1-score': 0.23176248046714368, 'support': 8154}, 'accuracy': 0.3465090662599559, 'macro avg': {'precision': 0.34574329783324537, 'recall': 0.34748298398651406, 'f1-score': 0.3322552769338368, 'support': 23604}, 'weighted avg': {'precision': 0.3465006118629602, 'recall': 0.3465090662599559, 'f1-score': 0.3316916896016405, 'support': 23604}}
[[4055 2708 1369]
 [3376 2715 1227]
 [3787 2958 1409]]
training model: results/CHTR/W1/deepLOB_L1/h100
Epoch 1/50
384/384 - 11s - loss: 3.3391 - accuracy100: 0.3535 - val_loss: 3.4045 - val_accuracy100: 0.3383 - 11s/epoch - 29ms/step
Epoch 2/50
384/384 - 9s - loss: 3.3177 - accuracy100: 0.3543 - val_loss: 3.4033 - val_accuracy100: 0.3382 - 9s/epoch - 24ms/step
Epoch 3/50
384/384 - 9s - loss: 3.2991 - accuracy100: 0.3561 - val_loss: 3.5264 - val_accuracy100: 0.3310 - 9s/epoch - 24ms/step
Epoch 4/50
384/384 - 9s - loss: 3.2906 - accuracy100: 0.3617 - val_loss: 3.4600 - val_accuracy100: 0.3417 - 9s/epoch - 24ms/step
Epoch 5/50
384/384 - 9s - loss: 3.2849 - accuracy100: 0.3663 - val_loss: 3.4750 - val_accuracy100: 0.3409 - 9s/epoch - 24ms/step
Epoch 6/50
384/384 - 9s - loss: 3.2809 - accuracy100: 0.3702 - val_loss: 3.4461 - val_accuracy100: 0.3444 - 9s/epoch - 24ms/step
Epoch 7/50
384/384 - 9s - loss: 3.2790 - accuracy100: 0.3724 - val_loss: 3.4399 - val_accuracy100: 0.3406 - 9s/epoch - 23ms/step
Epoch 8/50
384/384 - 9s - loss: 3.2740 - accuracy100: 0.3774 - val_loss: 3.5554 - val_accuracy100: 0.3362 - 9s/epoch - 24ms/step
Epoch 9/50
384/384 - 9s - loss: 3.2713 - accuracy100: 0.3786 - val_loss: 3.4431 - val_accuracy100: 0.3382 - 9s/epoch - 24ms/step
Epoch 10/50
384/384 - 9s - loss: 3.2666 - accuracy100: 0.3828 - val_loss: 3.4289 - val_accuracy100: 0.3318 - 9s/epoch - 23ms/step
Epoch 11/50
384/384 - 9s - loss: 3.2620 - accuracy100: 0.3886 - val_loss: 3.4233 - val_accuracy100: 0.3281 - 9s/epoch - 24ms/step
Epoch 12/50
384/384 - 9s - loss: 3.2614 - accuracy100: 0.3873 - val_loss: 3.4454 - val_accuracy100: 0.3285 - 9s/epoch - 24ms/step
testing model: results/CHTR/W1/deepLOB_L1/h100
Evaluating performance on  test set...
1304/1304 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1555072
{'0': {'precision': 0.33240220330046333, 'recall': 0.5232671081677704, 'f1-score': 0.40654757004472986, 'support': 113250}, '1': {'precision': 0.3025253717252773, 'recall': 0.358181428664574, 'f1-score': 0.3280092464249005, 'support': 107359}, '2': {'precision': 0.3368955666067083, 'recall': 0.08443234451790828, 'f1-score': 0.13502491430186944, 'support': 113132}, 'accuracy': 0.32140492178066227, 'macro avg': {'precision': 0.3239410472108163, 'recall': 0.32196029378341756, 'f1-score': 0.28986057692383327, 'support': 333741}, 'weighted avg': {'precision': 0.32431448383081984, 'recall': 0.32140492178066227, 'f1-score': 0.2892419439004966, 'support': 333741}}
[[59260 44455  9535]
 [59639 38454  9266]
 [59379 44201  9552]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1317751
{'0': {'precision': 0.34107432651736447, 'recall': 0.6352617579494619, 'f1-score': 0.4438460888663625, 'support': 33084}, '1': {'precision': 0.3313107247887429, 'recall': 0.2769738275293312, 'f1-score': 0.30171537053359554, 'support': 32133}, '2': {'precision': 0.34354194407456723, 'recall': 0.10154712525356505, 'f1-score': 0.15675827257431293, 'support': 33029}, 'accuracy': 0.3386499195896016, 'macro avg': {'precision': 0.33864233179355824, 'recall': 0.3379275702441194, 'f1-score': 0.30077324399142363, 'support': 98246}, 'weighted avg': {'precision': 0.33871055726417404, 'recall': 0.3386499195896016, 'f1-score': 0.300844746760863, 'support': 98246}}
[[21017  8858  3209]
 [20033  8900  3200]
 [20570  9105  3354]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1346372
{'0': {'precision': 0.3392423506556581, 'recall': 0.7123008285532186, 'f1-score': 0.459596167290373, 'support': 7845}, '1': {'precision': 0.334232325178193, 'recall': 0.22922446822565729, 'f1-score': 0.27194357366771155, 'support': 7569}, '2': {'precision': 0.32457496136012365, 'recall': 0.07692307692307693, 'f1-score': 0.12437074326325141, 'support': 8190}, 'accuracy': 0.336934417895272, 'macro avg': {'precision': 0.3326832123979916, 'recall': 0.3394827912339842, 'f1-score': 0.2853034947404453, 'support': 23604}, 'weighted avg': {'precision': 0.3325465871761902, 'recall': 0.336934417895272, 'f1-score': 0.283107491476441, 'support': 23604}}
[[5588 1623  634]
 [5157 1735  677]
 [5727 1833  630]]
training model: results/CHTR/W1/deepLOB_L1/h200
Epoch 1/50
384/384 - 11s - loss: 3.3486 - accuracy200: 0.3484 - val_loss: 3.4587 - val_accuracy200: 0.3202 - 11s/epoch - 30ms/step
Epoch 2/50
384/384 - 9s - loss: 3.3143 - accuracy200: 0.3526 - val_loss: 3.3393 - val_accuracy200: 0.3391 - 9s/epoch - 24ms/step
Epoch 3/50
384/384 - 9s - loss: 3.3002 - accuracy200: 0.3585 - val_loss: 3.3492 - val_accuracy200: 0.3304 - 9s/epoch - 24ms/step
Epoch 4/50
384/384 - 9s - loss: 3.2966 - accuracy200: 0.3569 - val_loss: 3.3399 - val_accuracy200: 0.3397 - 9s/epoch - 24ms/step
Epoch 5/50
384/384 - 9s - loss: 3.2859 - accuracy200: 0.3658 - val_loss: 3.3273 - val_accuracy200: 0.3386 - 9s/epoch - 24ms/step
Epoch 6/50
384/384 - 10s - loss: 3.2829 - accuracy200: 0.3674 - val_loss: 3.3105 - val_accuracy200: 0.3480 - 10s/epoch - 25ms/step
Epoch 7/50
384/384 - 9s - loss: 3.2762 - accuracy200: 0.3734 - val_loss: 3.3177 - val_accuracy200: 0.3325 - 9s/epoch - 25ms/step
Epoch 8/50
384/384 - 9s - loss: 3.2720 - accuracy200: 0.3768 - val_loss: 3.3128 - val_accuracy200: 0.3362 - 9s/epoch - 24ms/step
Epoch 9/50
384/384 - 9s - loss: 3.2679 - accuracy200: 0.3804 - val_loss: 3.3198 - val_accuracy200: 0.3300 - 9s/epoch - 24ms/step
Epoch 10/50
384/384 - 9s - loss: 3.2669 - accuracy200: 0.3832 - val_loss: 3.3240 - val_accuracy200: 0.3258 - 9s/epoch - 23ms/step
Epoch 11/50
384/384 - 9s - loss: 3.2603 - accuracy200: 0.3853 - val_loss: 3.3162 - val_accuracy200: 0.3330 - 9s/epoch - 24ms/step
Epoch 12/50
384/384 - 9s - loss: 3.2572 - accuracy200: 0.3894 - val_loss: 3.3300 - val_accuracy200: 0.3325 - 9s/epoch - 24ms/step
Epoch 13/50
384/384 - 9s - loss: 3.2517 - accuracy200: 0.3918 - val_loss: 3.3325 - val_accuracy200: 0.3310 - 9s/epoch - 24ms/step
Epoch 14/50
384/384 - 9s - loss: 3.2491 - accuracy200: 0.3951 - val_loss: 3.3281 - val_accuracy200: 0.3332 - 9s/epoch - 24ms/step
Epoch 15/50
384/384 - 9s - loss: 3.2452 - accuracy200: 0.3981 - val_loss: 3.3315 - val_accuracy200: 0.3272 - 9s/epoch - 25ms/step
Epoch 16/50
384/384 - 9s - loss: 3.2423 - accuracy200: 0.3997 - val_loss: 3.3345 - val_accuracy200: 0.3312 - 9s/epoch - 24ms/step
testing model: results/CHTR/W1/deepLOB_L1/h200
Evaluating performance on  test set...
1304/1304 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1127101
{'0': {'precision': 0.3433234421364985, 'recall': 0.174784285498476, 'f1-score': 0.2316411793455539, 'support': 112533}, '1': {'precision': 0.32114886386716135, 'recall': 0.6068804118886029, 'f1-score': 0.4200276001477191, 'support': 106825}, '2': {'precision': 0.34434582070740927, 'recall': 0.22452637192589808, 'f1-score': 0.2718175323472601, 'support': 114383}, 'accuracy': 0.3301392397098349, 'macro avg': {'precision': 0.3362727089036897, 'recall': 0.3353970231043257, 'f1-score': 0.307828770613511, 'support': 333741}, 'weighted avg': {'precision': 0.3365761243195522, 'recall': 0.3301392397098349, 'f1-score': 0.3057102064881149, 'support': 333741}}
[[19669 67849 25015]
 [18110 64830 23885]
 [19511 69190 25682]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1085496
{'0': {'precision': 0.3371977109100978, 'recall': 0.2799987736832424, 'f1-score': 0.3059477748186858, 'support': 32618}, '1': {'precision': 0.3332662183385012, 'recall': 0.5099513217080535, 'f1-score': 0.40309775461497244, 'support': 32458}, '2': {'precision': 0.35036054896487556, 'recall': 0.22704250829062406, 'f1-score': 0.2755327906338608, 'support': 33170}, 'accuracy': 0.33809010036032, 'macro avg': {'precision': 0.34027482607115817, 'recall': 0.33899753456063997, 'f1-score': 0.3281927733558397, 'support': 98246}, 'weighted avg': {'precision': 0.34034290717649135, 'recall': 0.33809010036032, 'f1-score': 0.32777491301074685, 'support': 98246}}
[[ 9133 16565  6920]
 [ 8862 16552  7044]
 [ 9090 16549  7531]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1033218
{'0': {'precision': 0.3311652109273369, 'recall': 0.24545454545454545, 'f1-score': 0.281939719958864, 'support': 7260}, '1': {'precision': 0.35281454313506616, 'recall': 0.5450178593422835, 'f1-score': 0.42834325540874113, 'support': 8119}, '2': {'precision': 0.35961978524907584, 'recall': 0.24838905775075987, 'f1-score': 0.2938300014382281, 'support': 8225}, 'accuracy': 0.34951703101169296, 'macro avg': {'precision': 0.3478665131038263, 'recall': 0.34628715418252964, 'f1-score': 0.3347043256019444, 'support': 23604}, 'weighted avg': {'precision': 0.3485270903541653, 'recall': 0.34951703101169296, 'f1-score': 0.33644098540054007, 'support': 23604}}
[[1782 3767 1711]
 [1767 4425 1927]
 [1832 4350 2043]]
training model: results/CHTR/W1/deepLOB_L1/h300
Epoch 1/50
384/384 - 12s - loss: 3.3394 - accuracy300: 0.3546 - val_loss: 3.5194 - val_accuracy300: 0.3266 - 12s/epoch - 31ms/step
Epoch 2/50
384/384 - 9s - loss: 3.3109 - accuracy300: 0.3560 - val_loss: 3.5422 - val_accuracy300: 0.3125 - 9s/epoch - 25ms/step
Epoch 3/50
384/384 - 9s - loss: 3.3002 - accuracy300: 0.3600 - val_loss: 3.3886 - val_accuracy300: 0.3222 - 9s/epoch - 24ms/step
Epoch 4/50
384/384 - 9s - loss: 3.2879 - accuracy300: 0.3695 - val_loss: 3.3887 - val_accuracy300: 0.3225 - 9s/epoch - 24ms/step
Epoch 5/50
384/384 - 9s - loss: 3.2752 - accuracy300: 0.3771 - val_loss: 3.4092 - val_accuracy300: 0.3202 - 9s/epoch - 25ms/step
Epoch 6/50
384/384 - 9s - loss: 3.2700 - accuracy300: 0.3798 - val_loss: 3.4614 - val_accuracy300: 0.3150 - 9s/epoch - 24ms/step
Epoch 7/50
384/384 - 9s - loss: 3.2679 - accuracy300: 0.3794 - val_loss: 3.4682 - val_accuracy300: 0.3153 - 9s/epoch - 24ms/step
Epoch 8/50
384/384 - 9s - loss: 3.2589 - accuracy300: 0.3872 - val_loss: 3.4807 - val_accuracy300: 0.3111 - 9s/epoch - 24ms/step
Epoch 9/50
384/384 - 9s - loss: 3.2491 - accuracy300: 0.3935 - val_loss: 3.4518 - val_accuracy300: 0.3184 - 9s/epoch - 24ms/step
Epoch 10/50
384/384 - 9s - loss: 3.2437 - accuracy300: 0.3966 - val_loss: 3.4447 - val_accuracy300: 0.3229 - 9s/epoch - 24ms/step
Epoch 11/50
384/384 - 10s - loss: 3.2340 - accuracy300: 0.4041 - val_loss: 3.4303 - val_accuracy300: 0.3156 - 10s/epoch - 25ms/step
Epoch 12/50
384/384 - 10s - loss: 3.2308 - accuracy300: 0.4045 - val_loss: 3.4644 - val_accuracy300: 0.3177 - 10s/epoch - 25ms/step
Epoch 13/50
384/384 - 10s - loss: 3.2242 - accuracy300: 0.4124 - val_loss: 3.5201 - val_accuracy300: 0.3065 - 10s/epoch - 26ms/step
testing model: results/CHTR/W1/deepLOB_L1/h300
Evaluating performance on  test set...
1304/1304 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1525912
{'0': {'precision': 0.33320748701685504, 'recall': 0.7155198039869205, 'f1-score': 0.4546778897478242, 'support': 111013}, '1': {'precision': 0.3305323993927611, 'recall': 0.2287544352794802, 'f1-score': 0.27038273628941334, 'support': 108505}, '2': {'precision': 0.32737772074428706, 'recall': 0.058070616250667555, 'f1-score': 0.09864370482734006, 'support': 114223}, 'accuracy': 0.33225165622443753, 'macro avg': {'precision': 0.3303725357179677, 'recall': 0.33411495183902273, 'f1-score': 0.27456811028819256, 'support': 333741}, 'weighted avg': {'precision': 0.3303425295330462, 'recall': 0.33225165622443753, 'f1-score': 0.2729074799684524, 'support': 333741}}
[[79432 24652  6929]
 [76985 24821  6699]
 [81969 25621  6633]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1364838
{'0': {'precision': 0.3306179504482792, 'recall': 0.635799035965888, 'f1-score': 0.4350225153802246, 'support': 32364}, '1': {'precision': 0.33480433276195337, 'recall': 0.2824267782426778, 'f1-score': 0.3063932046125861, 'support': 32504}, '2': {'precision': 0.34928396786587496, 'recall': 0.08987956138774043, 'f1-score': 0.1429694760168704, 'support': 33378}, 'accuracy': 0.333418154428679, 'macro avg': {'precision': 0.3382354170253692, 'recall': 0.33603512519876877, 'f1-score': 0.29479506533656036, 'support': 98246}, 'weighted avg': {'precision': 0.33834456018392417, 'recall': 0.333418154428679, 'f1-score': 0.2932445960241047, 'support': 98246}}
[[20577  9010  2777]
 [20512  9180  2812]
 [21149  9229  3000]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1293056
{'0': {'precision': 0.29828417470221213, 'recall': 0.6034136546184738, 'f1-score': 0.3992218637312583, 'support': 6972}, '1': {'precision': 0.36736214605067063, 'recall': 0.29303376129339037, 'f1-score': 0.3260150773707181, 'support': 8412}, '2': {'precision': 0.3648745519713262, 'recall': 0.12384428223844282, 'f1-score': 0.18492279745685739, 'support': 8220}, 'accuracy': 0.3257922386036265, 'macro avg': {'precision': 0.3435069575747363, 'recall': 0.34009723271676906, 'f1-score': 0.30338657951961123, 'support': 23604}, 'weighted avg': {'precision': 0.34609203761253876, 'recall': 0.3257922386036265, 'f1-score': 0.29850360362108885, 'support': 23604}}
[[4207 1996  769]
 [4944 2465 1003]
 [4953 2249 1018]]
training model: results/CHTR/W1/deepLOB_L1/h500
Epoch 1/50
384/384 - 12s - loss: 3.3468 - accuracy500: 0.3544 - val_loss: 3.4469 - val_accuracy500: 0.3195 - 12s/epoch - 31ms/step
Epoch 2/50
384/384 - 10s - loss: 3.3112 - accuracy500: 0.3533 - val_loss: 3.3845 - val_accuracy500: 0.3107 - 10s/epoch - 26ms/step
Epoch 3/50
384/384 - 10s - loss: 3.2984 - accuracy500: 0.3528 - val_loss: 3.3756 - val_accuracy500: 0.3184 - 10s/epoch - 26ms/step
Epoch 4/50
384/384 - 10s - loss: 3.2809 - accuracy500: 0.3698 - val_loss: 3.4745 - val_accuracy500: 0.3127 - 10s/epoch - 26ms/step
Epoch 5/50
384/384 - 10s - loss: 3.2724 - accuracy500: 0.3799 - val_loss: 3.3804 - val_accuracy500: 0.3249 - 10s/epoch - 25ms/step
Epoch 6/50
384/384 - 10s - loss: 3.2607 - accuracy500: 0.3895 - val_loss: 3.5292 - val_accuracy500: 0.3012 - 10s/epoch - 26ms/step
Epoch 7/50
384/384 - 10s - loss: 3.2569 - accuracy500: 0.3929 - val_loss: 3.4905 - val_accuracy500: 0.3031 - 10s/epoch - 25ms/step
Epoch 8/50
384/384 - 10s - loss: 3.2468 - accuracy500: 0.3980 - val_loss: 3.4406 - val_accuracy500: 0.3126 - 10s/epoch - 25ms/step
Epoch 9/50
384/384 - 10s - loss: 3.2419 - accuracy500: 0.4012 - val_loss: 3.4322 - val_accuracy500: 0.3104 - 10s/epoch - 25ms/step
Epoch 10/50
384/384 - 10s - loss: 3.2235 - accuracy500: 0.4113 - val_loss: 3.4534 - val_accuracy500: 0.3095 - 10s/epoch - 26ms/step
Epoch 11/50
384/384 - 10s - loss: 3.2117 - accuracy500: 0.4170 - val_loss: 3.3898 - val_accuracy500: 0.3361 - 10s/epoch - 26ms/step
Epoch 12/50
384/384 - 10s - loss: 3.2059 - accuracy500: 0.4225 - val_loss: 3.5133 - val_accuracy500: 0.3114 - 10s/epoch - 26ms/step
Epoch 13/50
384/384 - 10s - loss: 3.1992 - accuracy500: 0.4259 - val_loss: 3.5536 - val_accuracy500: 0.3216 - 10s/epoch - 26ms/step
testing model: results/CHTR/W1/deepLOB_L1/h500
Evaluating performance on  test set...
1304/1304 - 21s - 21s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1255672
{'0': {'precision': 0.34840628209800867, 'recall': 0.3663499142068269, 'f1-score': 0.35715286475470737, 'support': 114811}, '1': {'precision': 0.30794799624715186, 'recall': 0.4446551774188866, 'f1-score': 0.3638854464034716, 'support': 103343}, '2': {'precision': 0.36316754706334153, 'recall': 0.200446416984609, 'f1-score': 0.2583173527181912, 'support': 115587}, 'accuracy': 0.3331385715270225, 'macro avg': {'precision': 0.3398406084695007, 'recall': 0.33715050287010745, 'f1-score': 0.32645188795879004, 'support': 333741}, 'weighted avg': {'precision': 0.34099074040209126, 'recall': 0.3331385715270225, 'f1-score': 0.3250071735018, 'support': 333741}}
[[42061 51067 21683]
 [38446 45952 18945]
 [40217 52201 23169]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1245353
{'0': {'precision': 0.32157977321846226, 'recall': 0.33814830956976527, 'f1-score': 0.32965598870999563, 'support': 32122}, '1': {'precision': 0.3346795849534899, 'recall': 0.480107245215569, 'f1-score': 0.39441504848224007, 'support': 32449}, '2': {'precision': 0.34268973214285714, 'recall': 0.1823608017817372, 'f1-score': 0.23804632231805406, 'support': 33675}, 'accuracy': 0.3316369114264194, 'macro avg': {'precision': 0.3329830301049364, 'recall': 0.3335387855223571, 'f1-score': 0.3207057865034299, 'support': 98246}, 'weighted avg': {'precision': 0.33314211324013143, 'recall': 0.3316369114264194, 'f1-score': 0.3196444993343562, 'support': 98246}}
[[10862 15259  6001]
 [11092 15579  5778]
 [11823 15711  6141]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1254482
{'0': {'precision': 0.27826488232579605, 'recall': 0.3432474740287463, 'f1-score': 0.3073590315387066, 'support': 7027}, '1': {'precision': 0.3595515536723164, 'recall': 0.4845348560551987, 'f1-score': 0.41279010844228237, 'support': 8406}, '2': {'precision': 0.3026607538802661, 'recall': 0.1336433729041733, 'f1-score': 0.1854147211138467, 'support': 8171}, 'accuracy': 0.32100491442128454, 'macro avg': {'precision': 0.3134923966261262, 'recall': 0.32047523432937275, 'f1-score': 0.3018546203649452, 'support': 23604}, 'weighted avg': {'precision': 0.31565830826251967, 'recall': 0.32100491442128454, 'f1-score': 0.30269230860911533, 'support': 23604}}
[[2412 3507 1108]
 [2925 4073 1408]
 [3331 3748 1092]]
training model: results/CHTR/W1/deepLOB_L1/h1000
Epoch 1/50
384/384 - 11s - loss: 3.3265 - accuracy1000: 0.3698 - val_loss: 3.6055 - val_accuracy1000: 0.3128 - 11s/epoch - 30ms/step
Epoch 2/50
384/384 - 10s - loss: 3.3014 - accuracy1000: 0.3781 - val_loss: 3.4789 - val_accuracy1000: 0.3141 - 10s/epoch - 25ms/step
Epoch 3/50
384/384 - 9s - loss: 3.2903 - accuracy1000: 0.3703 - val_loss: 3.5226 - val_accuracy1000: 0.2847 - 9s/epoch - 25ms/step
Epoch 4/50
384/384 - 10s - loss: 3.2522 - accuracy1000: 0.3944 - val_loss: 3.5667 - val_accuracy1000: 0.2895 - 10s/epoch - 25ms/step
Epoch 5/50
384/384 - 10s - loss: 3.2220 - accuracy1000: 0.4174 - val_loss: 3.5988 - val_accuracy1000: 0.3032 - 10s/epoch - 26ms/step
Epoch 6/50
384/384 - 10s - loss: 3.2122 - accuracy1000: 0.4202 - val_loss: 3.4908 - val_accuracy1000: 0.3069 - 10s/epoch - 25ms/step
Epoch 7/50
384/384 - 10s - loss: 3.1914 - accuracy1000: 0.4282 - val_loss: 3.5623 - val_accuracy1000: 0.2933 - 10s/epoch - 26ms/step
Epoch 8/50
384/384 - 10s - loss: 3.1730 - accuracy1000: 0.4362 - val_loss: 3.5703 - val_accuracy1000: 0.3012 - 10s/epoch - 25ms/step
Epoch 9/50
384/384 - 10s - loss: 3.1545 - accuracy1000: 0.4424 - val_loss: 3.5965 - val_accuracy1000: 0.3501 - 10s/epoch - 26ms/step
Epoch 10/50
384/384 - 10s - loss: 3.1420 - accuracy1000: 0.4473 - val_loss: 3.4390 - val_accuracy1000: 0.3360 - 10s/epoch - 26ms/step
Epoch 11/50
384/384 - 10s - loss: 3.1227 - accuracy1000: 0.4565 - val_loss: 3.6133 - val_accuracy1000: 0.3241 - 10s/epoch - 25ms/step
Epoch 12/50
384/384 - 10s - loss: 3.1100 - accuracy1000: 0.4604 - val_loss: 3.5694 - val_accuracy1000: 0.3729 - 10s/epoch - 26ms/step
Epoch 13/50
384/384 - 9s - loss: 3.0970 - accuracy1000: 0.4646 - val_loss: 3.5965 - val_accuracy1000: 0.3751 - 9s/epoch - 25ms/step
Epoch 14/50
384/384 - 10s - loss: 3.0863 - accuracy1000: 0.4684 - val_loss: 3.4421 - val_accuracy1000: 0.3504 - 10s/epoch - 25ms/step
Epoch 15/50
384/384 - 10s - loss: 3.0776 - accuracy1000: 0.4722 - val_loss: 3.5916 - val_accuracy1000: 0.3493 - 10s/epoch - 26ms/step
Epoch 16/50
384/384 - 10s - loss: 3.0669 - accuracy1000: 0.4754 - val_loss: 3.6779 - val_accuracy1000: 0.3475 - 10s/epoch - 25ms/step
Epoch 17/50
384/384 - 10s - loss: 3.0588 - accuracy1000: 0.4763 - val_loss: 3.6198 - val_accuracy1000: 0.3299 - 10s/epoch - 25ms/step
Epoch 18/50
384/384 - 9s - loss: 3.0530 - accuracy1000: 0.4790 - val_loss: 3.6452 - val_accuracy1000: 0.3564 - 9s/epoch - 24ms/step
Epoch 19/50
384/384 - 9s - loss: 3.1016 - accuracy1000: 0.4609 - val_loss: 3.6116 - val_accuracy1000: 0.3665 - 9s/epoch - 24ms/step
Epoch 20/50
384/384 - 9s - loss: 3.0658 - accuracy1000: 0.4793 - val_loss: 3.4674 - val_accuracy1000: 0.3671 - 9s/epoch - 25ms/step
testing model: results/CHTR/W1/deepLOB_L1/h1000
Evaluating performance on  test set...
1304/1304 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1717459
{'0': {'precision': 0.33787915481019554, 'recall': 0.39362386817488515, 'f1-score': 0.36362747852858174, 'support': 113423}, '1': {'precision': 0.30031153908399416, 'recall': 0.5797922199656304, 'f1-score': 0.39567674183058793, 'support': 102416}, '2': {'precision': 0.3456280629352592, 'recall': 0.011365371240521789, 'f1-score': 0.022007078396110987, 'support': 117902}, 'accuracy': 0.3157118843654211, 'macro avg': {'precision': 0.32793958560981634, 'recall': 0.3282604864603458, 'f1-score': 0.26043709958509353, 'support': 333741}, 'weighted avg': {'precision': 0.32908816668930724, 'recall': 0.3157118843654211, 'f1-score': 0.2527769355444105, 'support': 333741}}
[[44646 67689  1088]
 [41587 59380  1449]
 [45903 70659  1340]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1515459
{'0': {'precision': 0.33340332164528524, 'recall': 0.4925095375453615, 'f1-score': 0.39763109130064606, 'support': 32241}, '1': {'precision': 0.3378728647913657, 'recall': 0.48960931005818786, 'f1-score': 0.3998290361915297, 'support': 32481}, '2': {'precision': 0.4680371726274289, 'recall': 0.049576422861233746, 'f1-score': 0.0896561024949427, 'support': 33524}, 'accuracy': 0.3404108055289783, 'macro avg': {'precision': 0.3797711196880266, 'recall': 0.343898423488261, 'f1-score': 0.29570540999570616, 'support': 98246}, 'weighted avg': {'precision': 0.3808214399529336, 'recall': 0.3404108055289783, 'f1-score': 0.29326895872810765, 'support': 98246}}
[[15879 15330  1032]
 [15721 15903   857]
 [16027 15835  1662]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1520274
{'0': {'precision': 0.2833910034602076, 'recall': 0.5019151218017466, 'f1-score': 0.362249129208824, 'support': 6527}, '1': {'precision': 0.39269805223163595, 'recall': 0.5026271660145333, 'f1-score': 0.4409139943120526, 'support': 8945}, '2': {'precision': 0.28739495798319326, 'recall': 0.02102803738317757, 'f1-score': 0.03918872464764524, 'support': 8132}, 'accuracy': 0.3365107608879851, 'macro avg': {'precision': 0.32116133789167894, 'recall': 0.3418567750664858, 'f1-score': 0.2807839493895073, 'support': 23604}, 'weighted avg': {'precision': 0.32619356698509094, 'recall': 0.3365107608879851, 'f1-score': 0.28075997518649193, 'support': 23604}}
[[3276 3068  183]
 [4208 4496  241]
 [4076 3885  171]]
training model: results/CHTR/W1/deepOF_L1/h10
Epoch 1/50
384/384 - 11s - loss: 3.2963 - accuracy10: 0.3775 - val_loss: 3.3023 - val_accuracy10: 0.3671 - 11s/epoch - 30ms/step
Epoch 2/50
384/384 - 9s - loss: 3.2567 - accuracy10: 0.3966 - val_loss: 3.2800 - val_accuracy10: 0.3790 - 9s/epoch - 23ms/step
Epoch 3/50
384/384 - 9s - loss: 3.2412 - accuracy10: 0.4065 - val_loss: 3.2665 - val_accuracy10: 0.3907 - 9s/epoch - 23ms/step
Epoch 4/50
384/384 - 9s - loss: 3.2303 - accuracy10: 0.4111 - val_loss: 3.2607 - val_accuracy10: 0.3936 - 9s/epoch - 23ms/step
Epoch 5/50
384/384 - 9s - loss: 3.2240 - accuracy10: 0.4131 - val_loss: 3.2575 - val_accuracy10: 0.3908 - 9s/epoch - 23ms/step
Epoch 6/50
384/384 - 9s - loss: 3.2174 - accuracy10: 0.4177 - val_loss: 3.2544 - val_accuracy10: 0.3934 - 9s/epoch - 24ms/step
Epoch 7/50
384/384 - 9s - loss: 3.2128 - accuracy10: 0.4189 - val_loss: 3.2534 - val_accuracy10: 0.3991 - 9s/epoch - 24ms/step
Epoch 8/50
384/384 - 9s - loss: 3.2063 - accuracy10: 0.4219 - val_loss: 3.2494 - val_accuracy10: 0.3994 - 9s/epoch - 24ms/step
Epoch 9/50
384/384 - 9s - loss: 3.2013 - accuracy10: 0.4259 - val_loss: 3.2476 - val_accuracy10: 0.4023 - 9s/epoch - 23ms/step
Epoch 10/50
384/384 - 9s - loss: 3.1979 - accuracy10: 0.4260 - val_loss: 3.2452 - val_accuracy10: 0.4040 - 9s/epoch - 23ms/step
Epoch 11/50
384/384 - 9s - loss: 3.1956 - accuracy10: 0.4264 - val_loss: 3.2465 - val_accuracy10: 0.4041 - 9s/epoch - 24ms/step
Epoch 12/50
384/384 - 9s - loss: 3.1915 - accuracy10: 0.4277 - val_loss: 3.2469 - val_accuracy10: 0.4052 - 9s/epoch - 24ms/step
Epoch 13/50
384/384 - 9s - loss: 3.1887 - accuracy10: 0.4304 - val_loss: 3.2485 - val_accuracy10: 0.4058 - 9s/epoch - 23ms/step
Epoch 14/50
384/384 - 9s - loss: 3.1854 - accuracy10: 0.4315 - val_loss: 3.2473 - val_accuracy10: 0.4081 - 9s/epoch - 24ms/step
Epoch 15/50
384/384 - 9s - loss: 3.1831 - accuracy10: 0.4338 - val_loss: 3.2471 - val_accuracy10: 0.4047 - 9s/epoch - 24ms/step
Epoch 16/50
384/384 - 9s - loss: 3.1786 - accuracy10: 0.4341 - val_loss: 3.2436 - val_accuracy10: 0.4042 - 9s/epoch - 24ms/step
Epoch 17/50
384/384 - 9s - loss: 3.1750 - accuracy10: 0.4368 - val_loss: 3.2449 - val_accuracy10: 0.4065 - 9s/epoch - 24ms/step
Epoch 18/50
384/384 - 9s - loss: 3.1748 - accuracy10: 0.4351 - val_loss: 3.2468 - val_accuracy10: 0.4059 - 9s/epoch - 24ms/step
Epoch 19/50
384/384 - 9s - loss: 3.1717 - accuracy10: 0.4371 - val_loss: 3.2427 - val_accuracy10: 0.4107 - 9s/epoch - 24ms/step
Epoch 20/50
384/384 - 9s - loss: 3.1694 - accuracy10: 0.4377 - val_loss: 3.2459 - val_accuracy10: 0.4077 - 9s/epoch - 23ms/step
Epoch 21/50
384/384 - 9s - loss: 3.1658 - accuracy10: 0.4388 - val_loss: 3.2473 - val_accuracy10: 0.4048 - 9s/epoch - 23ms/step
Epoch 22/50
384/384 - 9s - loss: 3.1643 - accuracy10: 0.4388 - val_loss: 3.2504 - val_accuracy10: 0.4021 - 9s/epoch - 23ms/step
Epoch 23/50
384/384 - 9s - loss: 3.1613 - accuracy10: 0.4415 - val_loss: 3.2462 - val_accuracy10: 0.4059 - 9s/epoch - 23ms/step
Epoch 24/50
384/384 - 9s - loss: 3.1579 - accuracy10: 0.4441 - val_loss: 3.2479 - val_accuracy10: 0.4009 - 9s/epoch - 23ms/step
Epoch 25/50
384/384 - 9s - loss: 3.1556 - accuracy10: 0.4434 - val_loss: 3.2471 - val_accuracy10: 0.4059 - 9s/epoch - 23ms/step
Epoch 26/50
384/384 - 9s - loss: 3.1520 - accuracy10: 0.4458 - val_loss: 3.2477 - val_accuracy10: 0.4044 - 9s/epoch - 23ms/step
Epoch 27/50
384/384 - 9s - loss: 3.1514 - accuracy10: 0.4457 - val_loss: 3.2503 - val_accuracy10: 0.4036 - 9s/epoch - 24ms/step
Epoch 28/50
384/384 - 9s - loss: 3.1495 - accuracy10: 0.4452 - val_loss: 3.2536 - val_accuracy10: 0.4048 - 9s/epoch - 24ms/step
Epoch 29/50
384/384 - 9s - loss: 3.1474 - accuracy10: 0.4480 - val_loss: 3.2492 - val_accuracy10: 0.4076 - 9s/epoch - 24ms/step
testing model: results/CHTR/W1/deepOF_L1/h10
Evaluating performance on  test set...
1304/1304 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0710967
{'0': {'precision': 0.41584538414090877, 'recall': 0.5185052255578059, 'f1-score': 0.4615355359390867, 'support': 117021}, '1': {'precision': 0.44987155106262305, 'recall': 0.2599425520020049, 'f1-score': 0.32949685995650374, 'support': 103746}, '2': {'precision': 0.4113074757585236, 'recall': 0.46559675663235045, 'f1-score': 0.43677158717702796, 'support': 112969}, 'accuracy': 0.4202183762015485, 'macro avg': {'precision': 0.4256748036540185, 'recall': 0.4146815113973871, 'f1-score': 0.40926799435753947, 'support': 333736}, 'weighted avg': {'precision': 0.4248867693717814, 'recall': 0.4202183762015485, 'f1-score': 0.41210711645125775, 'support': 333736}}
[[60676 16567 39778]
 [41274 26968 35504]
 [43960 16411 52598]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0665678
{'0': {'precision': 0.4222429060173073, 'recall': 0.49495753715498936, 'f1-score': 0.4557178540399652, 'support': 33912}, '1': {'precision': 0.43509709882852426, 'recall': 0.3422598800173171, 'f1-score': 0.383134865688175, 'support': 32338}, '2': {'precision': 0.4132808954772349, 'recall': 0.42697296452570715, 'f1-score': 0.42001537279016143, 'support': 31995}, 'accuracy': 0.42255585525980965, 'macro avg': {'precision': 0.4235403001076888, 'recall': 0.4213967938993379, 'f1-score': 0.41962269750610054, 'support': 98245}, 'weighted avg': {'precision': 0.4235553327046656, 'recall': 0.42255585525980965, 'f1-score': 0.42019961326529304, 'support': 98245}}
[[16785  7246  9881]
 [11757 11068  9513]
 [11210  7124 13661]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0791804
{'0': {'precision': 0.3945438282647585, 'recall': 0.5467278135845315, 'f1-score': 0.45833333333333337, 'support': 8068}, '1': {'precision': 0.3858807402330363, 'recall': 0.23045435939418749, 'f1-score': 0.28856996412096364, 'support': 7329}, '2': {'precision': 0.4355660494594259, 'recall': 0.4270744486414037, 'f1-score': 0.43127845453426855, 'support': 8207}, 'accuracy': 0.406922555499068, 'macro avg': {'precision': 0.4053302059857402, 'recall': 0.4014188738733742, 'f1-score': 0.3927272506628552, 'support': 23604}, 'weighted avg': {'precision': 0.40611718859182777, 'recall': 0.406922555499068, 'f1-score': 0.39621525490334764, 'support': 23604}}
[[4411 1285 2372]
 [3470 1689 2170]
 [3299 1403 3505]]
training model: results/CHTR/W1/deepOF_L1/h20
Epoch 1/50
384/384 - 12s - loss: 3.3079 - accuracy20: 0.3678 - val_loss: 3.3039 - val_accuracy20: 0.3708 - 12s/epoch - 30ms/step
Epoch 2/50
384/384 - 9s - loss: 3.2733 - accuracy20: 0.3848 - val_loss: 3.2807 - val_accuracy20: 0.3816 - 9s/epoch - 24ms/step
Epoch 3/50
384/384 - 9s - loss: 3.2594 - accuracy20: 0.3935 - val_loss: 3.2761 - val_accuracy20: 0.3835 - 9s/epoch - 24ms/step
Epoch 4/50
384/384 - 9s - loss: 3.2506 - accuracy20: 0.3985 - val_loss: 3.2734 - val_accuracy20: 0.3871 - 9s/epoch - 24ms/step
Epoch 5/50
384/384 - 9s - loss: 3.2447 - accuracy20: 0.4011 - val_loss: 3.2682 - val_accuracy20: 0.3883 - 9s/epoch - 24ms/step
Epoch 6/50
384/384 - 9s - loss: 3.2395 - accuracy20: 0.4037 - val_loss: 3.2676 - val_accuracy20: 0.3897 - 9s/epoch - 24ms/step
Epoch 7/50
384/384 - 9s - loss: 3.2356 - accuracy20: 0.4062 - val_loss: 3.2649 - val_accuracy20: 0.3946 - 9s/epoch - 24ms/step
Epoch 8/50
384/384 - 9s - loss: 3.2296 - accuracy20: 0.4075 - val_loss: 3.2653 - val_accuracy20: 0.3911 - 9s/epoch - 24ms/step
Epoch 9/50
384/384 - 9s - loss: 3.2278 - accuracy20: 0.4096 - val_loss: 3.2602 - val_accuracy20: 0.3966 - 9s/epoch - 24ms/step
Epoch 10/50
384/384 - 9s - loss: 3.2243 - accuracy20: 0.4130 - val_loss: 3.2623 - val_accuracy20: 0.3921 - 9s/epoch - 24ms/step
Epoch 11/50
384/384 - 9s - loss: 3.2207 - accuracy20: 0.4130 - val_loss: 3.2620 - val_accuracy20: 0.3924 - 9s/epoch - 24ms/step
Epoch 12/50
384/384 - 9s - loss: 3.2174 - accuracy20: 0.4150 - val_loss: 3.2657 - val_accuracy20: 0.3921 - 9s/epoch - 24ms/step
Epoch 13/50
384/384 - 9s - loss: 3.2155 - accuracy20: 0.4158 - val_loss: 3.2652 - val_accuracy20: 0.3934 - 9s/epoch - 24ms/step
Epoch 14/50
384/384 - 9s - loss: 3.2122 - accuracy20: 0.4184 - val_loss: 3.2608 - val_accuracy20: 0.3946 - 9s/epoch - 23ms/step
Epoch 15/50
384/384 - 9s - loss: 3.2086 - accuracy20: 0.4200 - val_loss: 3.2636 - val_accuracy20: 0.3968 - 9s/epoch - 23ms/step
Epoch 16/50
384/384 - 9s - loss: 3.2048 - accuracy20: 0.4212 - val_loss: 3.2620 - val_accuracy20: 0.3984 - 9s/epoch - 24ms/step
Epoch 17/50
384/384 - 9s - loss: 3.2023 - accuracy20: 0.4235 - val_loss: 3.2660 - val_accuracy20: 0.3951 - 9s/epoch - 24ms/step
Epoch 18/50
384/384 - 9s - loss: 3.2019 - accuracy20: 0.4235 - val_loss: 3.2671 - val_accuracy20: 0.3928 - 9s/epoch - 24ms/step
Epoch 19/50
384/384 - 9s - loss: 3.1979 - accuracy20: 0.4243 - val_loss: 3.2678 - val_accuracy20: 0.3958 - 9s/epoch - 24ms/step
testing model: results/CHTR/W1/deepOF_L1/h20
Evaluating performance on  test set...
1304/1304 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.080199
{'0': {'precision': 0.39872459824844825, 'recall': 0.6070839842232905, 'f1-score': 0.4813228320594494, 'support': 115867}, '1': {'precision': 0.42569222515104155, 'recall': 0.17077964007973273, 'f1-score': 0.24376527790764463, 'support': 106857}, '2': {'precision': 0.41597350854506693, 'recall': 0.4288635462832847, 'f1-score': 0.42232019302416346, 'support': 111012}, 'accuracy': 0.40810401035549054, 'macro avg': {'precision': 0.41346344398151885, 'recall': 0.402242390195436, 'f1-score': 0.38246943433041913, 'support': 333736}, 'weighted avg': {'precision': 0.4130967838615635, 'recall': 0.40810401035549054, 'f1-score': 0.3856343581501781, 'support': 333736}}
[[70341 12654 32872]
 [54637 18249 33971]
 [51437 11966 47609]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0807157
{'0': {'precision': 0.39569614968594036, 'recall': 0.6178736517719569, 'f1-score': 0.48243391751981024, 'support': 33748}, '1': {'precision': 0.41756548536209553, 'recall': 0.19124911785462245, 'f1-score': 0.2623426911907067, 'support': 32591}, '2': {'precision': 0.4048528787433461, 'recall': 0.3885476086002633, 'f1-score': 0.39653269787451817, 'support': 31906}, 'accuracy': 0.40187286884828743, 'macro avg': {'precision': 0.406038171263794, 'recall': 0.3992234594089475, 'f1-score': 0.3804364355283451, 'support': 98245}, 'weighted avg': {'precision': 0.40592464086948316, 'recall': 0.40187286884828743, 'f1-score': 0.38152539829446036, 'support': 98245}}
[[20852  4238  8658]
 [16792  6233  9566]
 [15053  4456 12397]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0856739
{'0': {'precision': 0.38333816705336426, 'recall': 0.6550613306901252, 'f1-score': 0.48364817271188765, 'support': 8071}, '1': {'precision': 0.36920152091254754, 'recall': 0.1309684380900998, 'f1-score': 0.19334926324173635, 'support': 7414}, '2': {'precision': 0.4287106655527708, 'recall': 0.37923389579997535, 'f1-score': 0.4024573557283838, 'support': 8119}, 'accuracy': 0.395568547703779, 'macro avg': {'precision': 0.3937501178395609, 'recall': 0.3884212215267335, 'f1-score': 0.35981826389400257, 'support': 23604}, 'weighted avg': {'precision': 0.3945045041499863, 'recall': 0.395568547703779, 'f1-score': 0.3645385151156849, 'support': 23604}}
[[5287  767 2017]
 [4357  971 2086]
 [4148  892 3079]]
training model: results/CHTR/W1/deepOF_L1/h30
Epoch 1/50
384/384 - 12s - loss: 3.3120 - accuracy30: 0.3635 - val_loss: 3.3052 - val_accuracy30: 0.3712 - 12s/epoch - 30ms/step
Epoch 2/50
384/384 - 9s - loss: 3.2809 - accuracy30: 0.3796 - val_loss: 3.2836 - val_accuracy30: 0.3790 - 9s/epoch - 24ms/step
Epoch 3/50
384/384 - 9s - loss: 3.2656 - accuracy30: 0.3907 - val_loss: 3.2806 - val_accuracy30: 0.3805 - 9s/epoch - 24ms/step
Epoch 4/50
384/384 - 9s - loss: 3.2581 - accuracy30: 0.3946 - val_loss: 3.2747 - val_accuracy30: 0.3842 - 9s/epoch - 25ms/step
Epoch 5/50
384/384 - 9s - loss: 3.2537 - accuracy30: 0.3964 - val_loss: 3.2719 - val_accuracy30: 0.3880 - 9s/epoch - 24ms/step
Epoch 6/50
384/384 - 9s - loss: 3.2481 - accuracy30: 0.4001 - val_loss: 3.2719 - val_accuracy30: 0.3866 - 9s/epoch - 24ms/step
Epoch 7/50
384/384 - 9s - loss: 3.2421 - accuracy30: 0.4029 - val_loss: 3.2708 - val_accuracy30: 0.3881 - 9s/epoch - 24ms/step
Epoch 8/50
384/384 - 9s - loss: 3.2388 - accuracy30: 0.4063 - val_loss: 3.2698 - val_accuracy30: 0.3877 - 9s/epoch - 24ms/step
Epoch 9/50
384/384 - 9s - loss: 3.2353 - accuracy30: 0.4081 - val_loss: 3.2677 - val_accuracy30: 0.3911 - 9s/epoch - 24ms/step
Epoch 10/50
384/384 - 9s - loss: 3.2344 - accuracy30: 0.4089 - val_loss: 3.2687 - val_accuracy30: 0.3915 - 9s/epoch - 25ms/step
Epoch 11/50
384/384 - 9s - loss: 3.2302 - accuracy30: 0.4113 - val_loss: 3.2699 - val_accuracy30: 0.3918 - 9s/epoch - 24ms/step
Epoch 12/50
384/384 - 9s - loss: 3.2273 - accuracy30: 0.4112 - val_loss: 3.2723 - val_accuracy30: 0.3903 - 9s/epoch - 24ms/step
Epoch 13/50
384/384 - 9s - loss: 3.2251 - accuracy30: 0.4136 - val_loss: 3.2699 - val_accuracy30: 0.3912 - 9s/epoch - 24ms/step
Epoch 14/50
384/384 - 9s - loss: 3.2218 - accuracy30: 0.4152 - val_loss: 3.2670 - val_accuracy30: 0.3935 - 9s/epoch - 25ms/step
Epoch 15/50
384/384 - 9s - loss: 3.2197 - accuracy30: 0.4171 - val_loss: 3.2686 - val_accuracy30: 0.3924 - 9s/epoch - 24ms/step
Epoch 16/50
384/384 - 9s - loss: 3.2182 - accuracy30: 0.4174 - val_loss: 3.2690 - val_accuracy30: 0.3957 - 9s/epoch - 24ms/step
Epoch 17/50
384/384 - 9s - loss: 3.2145 - accuracy30: 0.4181 - val_loss: 3.2717 - val_accuracy30: 0.3960 - 9s/epoch - 25ms/step
Epoch 18/50
384/384 - 9s - loss: 3.2128 - accuracy30: 0.4195 - val_loss: 3.2712 - val_accuracy30: 0.3927 - 9s/epoch - 24ms/step
Epoch 19/50
384/384 - 9s - loss: 3.2122 - accuracy30: 0.4209 - val_loss: 3.2722 - val_accuracy30: 0.3935 - 9s/epoch - 24ms/step
Epoch 20/50
384/384 - 10s - loss: 3.2081 - accuracy30: 0.4232 - val_loss: 3.2781 - val_accuracy30: 0.3929 - 10s/epoch - 25ms/step
Epoch 21/50
384/384 - 10s - loss: 3.2066 - accuracy30: 0.4223 - val_loss: 3.2730 - val_accuracy30: 0.3926 - 10s/epoch - 25ms/step
Epoch 22/50
384/384 - 9s - loss: 3.2038 - accuracy30: 0.4227 - val_loss: 3.2736 - val_accuracy30: 0.3953 - 9s/epoch - 24ms/step
Epoch 23/50
384/384 - 9s - loss: 3.2012 - accuracy30: 0.4248 - val_loss: 3.2755 - val_accuracy30: 0.3928 - 9s/epoch - 23ms/step
Epoch 24/50
384/384 - 9s - loss: 3.1987 - accuracy30: 0.4267 - val_loss: 3.2775 - val_accuracy30: 0.3933 - 9s/epoch - 23ms/step
testing model: results/CHTR/W1/deepOF_L1/h30
Evaluating performance on  test set...
1304/1304 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0814755
{'0': {'precision': 0.4055538818692516, 'recall': 0.5926709254143646, 'f1-score': 0.4815748771600024, 'support': 115840}, '1': {'precision': 0.40812799367932445, 'recall': 0.15483617152812904, 'f1-score': 0.22450088279234004, 'support': 106758}, '2': {'precision': 0.4156534647873688, 'recall': 0.46355881876585864, 'f1-score': 0.43830104004934384, 'support': 111138}, 'accuracy': 0.4096171824436081, 'macro avg': {'precision': 0.4097784467786483, 'recall': 0.40368863856945075, 'f1-score': 0.3814589333338954, 'support': 333736}, 'weighted avg': {'precision': 0.4097405877534639, 'recall': 0.4096171824436081, 'f1-score': 0.3849294052914978, 'support': 333736}}
[[68655 12091 35094]
 [52894 16530 37334]
 [47738 11881 51519]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0797311
{'0': {'precision': 0.40036829586434436, 'recall': 0.6183197061263183, 'f1-score': 0.48602831594634877, 'support': 33756}, '1': {'precision': 0.41438175088752927, 'recall': 0.16895075605925286, 'f1-score': 0.24003500328155766, 'support': 32471}, '2': {'precision': 0.4048183975177952, 'recall': 0.415641201823974, 'f1-score': 0.4101584170621957, 'support': 32018}, 'accuracy': 0.4037457376965749, 'macro avg': {'precision': 0.40652281475655627, 'recall': 0.4009705546698483, 'f1-score': 0.37874057876336736, 'support': 98245}, 'weighted avg': {'precision': 0.4064501753777855, 'recall': 0.4037457376965749, 'f1-score': 0.37999898846900904, 'support': 98245}}
[[20872  3692  9192]
 [16611  5486 10374]
 [14649  4061 13308]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0870678
{'0': {'precision': 0.38482666468710564, 'recall': 0.6444554947787171, 'f1-score': 0.48189635138275616, 'support': 8044}, '1': {'precision': 0.3520169851380042, 'recall': 0.1106513614522157, 'f1-score': 0.1683761551741647, 'support': 7492}, '2': {'precision': 0.4265878117768064, 'recall': 0.4112543381259296, 'f1-score': 0.4187807648617948, 'support': 8068}, 'accuracy': 0.39531435349940686, 'macro avg': {'precision': 0.38781048720063876, 'recall': 0.3887870647856208, 'f1-score': 0.3563510904729052, 'support': 23604}, 'weighted avg': {'precision': 0.3886869771569344, 'recall': 0.39531435349940686, 'f1-score': 0.36081052431760263, 'support': 23604}}
[[5184  683 2177]
 [4380  829 2283]
 [3907  843 3318]]
training model: results/CHTR/W1/deepOF_L1/h50
Epoch 1/50
384/384 - 11s - loss: 3.3216 - accuracy50: 0.3579 - val_loss: 3.3018 - val_accuracy50: 0.3651 - 11s/epoch - 28ms/step
Epoch 2/50
384/384 - 9s - loss: 3.2884 - accuracy50: 0.3756 - val_loss: 3.2875 - val_accuracy50: 0.3771 - 9s/epoch - 22ms/step
Epoch 3/50
384/384 - 10s - loss: 3.2752 - accuracy50: 0.3829 - val_loss: 3.2846 - val_accuracy50: 0.3774 - 10s/epoch - 25ms/step
Epoch 4/50
384/384 - 9s - loss: 3.2667 - accuracy50: 0.3875 - val_loss: 3.2837 - val_accuracy50: 0.3832 - 9s/epoch - 24ms/step
Epoch 5/50
384/384 - 9s - loss: 3.2608 - accuracy50: 0.3922 - val_loss: 3.2755 - val_accuracy50: 0.3858 - 9s/epoch - 24ms/step
Epoch 6/50
384/384 - 9s - loss: 3.2566 - accuracy50: 0.3945 - val_loss: 3.2771 - val_accuracy50: 0.3861 - 9s/epoch - 23ms/step
Epoch 7/50
384/384 - 9s - loss: 3.2535 - accuracy50: 0.3971 - val_loss: 3.2762 - val_accuracy50: 0.3865 - 9s/epoch - 24ms/step
Epoch 8/50
384/384 - 9s - loss: 3.2500 - accuracy50: 0.3986 - val_loss: 3.2730 - val_accuracy50: 0.3899 - 9s/epoch - 24ms/step
Epoch 9/50
384/384 - 9s - loss: 3.2467 - accuracy50: 0.4009 - val_loss: 3.2706 - val_accuracy50: 0.3879 - 9s/epoch - 24ms/step
Epoch 10/50
384/384 - 9s - loss: 3.2446 - accuracy50: 0.4044 - val_loss: 3.2725 - val_accuracy50: 0.3895 - 9s/epoch - 23ms/step
Epoch 11/50
384/384 - 9s - loss: 3.2425 - accuracy50: 0.4065 - val_loss: 3.2725 - val_accuracy50: 0.3911 - 9s/epoch - 23ms/step
Epoch 12/50
384/384 - 9s - loss: 3.2379 - accuracy50: 0.4065 - val_loss: 3.2766 - val_accuracy50: 0.3874 - 9s/epoch - 24ms/step
Epoch 13/50
384/384 - 9s - loss: 3.2375 - accuracy50: 0.4086 - val_loss: 3.2754 - val_accuracy50: 0.3866 - 9s/epoch - 24ms/step
Epoch 14/50
384/384 - 9s - loss: 3.2343 - accuracy50: 0.4089 - val_loss: 3.2733 - val_accuracy50: 0.3896 - 9s/epoch - 24ms/step
Epoch 15/50
384/384 - 9s - loss: 3.2322 - accuracy50: 0.4129 - val_loss: 3.2735 - val_accuracy50: 0.3923 - 9s/epoch - 24ms/step
Epoch 16/50
384/384 - 9s - loss: 3.2291 - accuracy50: 0.4136 - val_loss: 3.2731 - val_accuracy50: 0.3913 - 9s/epoch - 24ms/step
Epoch 17/50
384/384 - 9s - loss: 3.2271 - accuracy50: 0.4134 - val_loss: 3.2755 - val_accuracy50: 0.3898 - 9s/epoch - 24ms/step
Epoch 18/50
384/384 - 9s - loss: 3.2248 - accuracy50: 0.4152 - val_loss: 3.2778 - val_accuracy50: 0.3908 - 9s/epoch - 24ms/step
Epoch 19/50
384/384 - 9s - loss: 3.2220 - accuracy50: 0.4172 - val_loss: 3.2772 - val_accuracy50: 0.3885 - 9s/epoch - 24ms/step
testing model: results/CHTR/W1/deepOF_L1/h50
Evaluating performance on  test set...
1304/1304 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0830972
{'0': {'precision': 0.40469719533382975, 'recall': 0.5673759482218665, 'f1-score': 0.47242423364431824, 'support': 114952}, '1': {'precision': 0.4049644222502698, 'recall': 0.20756999006169252, 'f1-score': 0.27446118752595666, 'support': 106658}, '2': {'precision': 0.41719321159897205, 'recall': 0.4387028878226281, 'f1-score': 0.42767776797242135, 'support': 112126}, 'accuracy': 0.4091557398662416, 'macro avg': {'precision': 0.40895160972769057, 'recall': 0.40454960870206236, 'f1-score': 0.3915210630475654, 'support': 333736}, 'weighted avg': {'precision': 0.4089809112296247, 'recall': 0.4091557398662416, 'f1-score': 0.39412406589849724, 'support': 333736}}
[[65221 16640 33091]
 [48893 22139 35626]
 [47046 15890 49190]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0834062
{'0': {'precision': 0.40205520770494874, 'recall': 0.5738546955256673, 'f1-score': 0.47283313354698236, 'support': 33681}, '1': {'precision': 0.39056449413689664, 'recall': 0.22441240990285177, 'f1-score': 0.28504328788934225, 'support': 31910}, '2': {'precision': 0.4043722712567139, 'recall': 0.3942549151711888, 'f1-score': 0.3992495076832427, 'support': 32654}, 'accuracy': 0.40066161127792765, 'macro avg': {'precision': 0.3989973243661864, 'recall': 0.3975073401999027, 'f1-score': 0.38570864303985575, 'support': 98245}, 'weighted avg': {'precision': 0.3990931508395896, 'recall': 0.40066161127792765, 'f1-score': 0.38738172437715335, 'support': 98245}}
[[19328  5278  9075]
 [14861  7161  9888]
 [13884  5896 12874]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0891441
{'0': {'precision': 0.38671875, 'recall': 0.6377601585728444, 'f1-score': 0.4814814814814815, 'support': 8072}, '1': {'precision': 0.3252260679763018, 'recall': 0.14217557251908397, 'f1-score': 0.1978563976097885, 'support': 7336}, '2': {'precision': 0.4199011997177135, 'recall': 0.3629819424109322, 'f1-score': 0.38937242327072835, 'support': 8196}, 'accuracy': 0.388324012879173, 'macro avg': {'precision': 0.3772820058980051, 'recall': 0.38097255783428685, 'f1-score': 0.35623676745399946, 'support': 23604}, 'weighted avg': {'precision': 0.37912906361466403, 'recall': 0.388324012879173, 'f1-score': 0.3613493235261319, 'support': 23604}}
[[5148  999 1925]
 [4108 1043 2185]
 [4056 1165 2975]]
training model: results/CHTR/W1/deepOF_L1/h100
Epoch 1/50
384/384 - 12s - loss: 3.3313 - accuracy100: 0.3466 - val_loss: 3.3128 - val_accuracy100: 0.3504 - 12s/epoch - 31ms/step
Epoch 2/50
384/384 - 9s - loss: 3.3019 - accuracy100: 0.3586 - val_loss: 3.3083 - val_accuracy100: 0.3525 - 9s/epoch - 24ms/step
Epoch 3/50
384/384 - 10s - loss: 3.2886 - accuracy100: 0.3680 - val_loss: 3.2987 - val_accuracy100: 0.3608 - 10s/epoch - 25ms/step
Epoch 4/50
384/384 - 9s - loss: 3.2842 - accuracy100: 0.3711 - val_loss: 3.2990 - val_accuracy100: 0.3590 - 9s/epoch - 24ms/step
Epoch 5/50
384/384 - 9s - loss: 3.2807 - accuracy100: 0.3743 - val_loss: 3.2943 - val_accuracy100: 0.3641 - 9s/epoch - 24ms/step
Epoch 6/50
384/384 - 9s - loss: 3.2757 - accuracy100: 0.3784 - val_loss: 3.2957 - val_accuracy100: 0.3634 - 9s/epoch - 24ms/step
Epoch 7/50
384/384 - 9s - loss: 3.2745 - accuracy100: 0.3799 - val_loss: 3.2940 - val_accuracy100: 0.3656 - 9s/epoch - 24ms/step
Epoch 8/50
384/384 - 9s - loss: 3.2712 - accuracy100: 0.3810 - val_loss: 3.2903 - val_accuracy100: 0.3738 - 9s/epoch - 24ms/step
Epoch 9/50
384/384 - 9s - loss: 3.2672 - accuracy100: 0.3827 - val_loss: 3.2908 - val_accuracy100: 0.3698 - 9s/epoch - 24ms/step
Epoch 10/50
384/384 - 9s - loss: 3.2667 - accuracy100: 0.3838 - val_loss: 3.2906 - val_accuracy100: 0.3693 - 9s/epoch - 24ms/step
Epoch 11/50
384/384 - 9s - loss: 3.2648 - accuracy100: 0.3869 - val_loss: 3.2905 - val_accuracy100: 0.3735 - 9s/epoch - 24ms/step
Epoch 12/50
384/384 - 9s - loss: 3.2614 - accuracy100: 0.3906 - val_loss: 3.2944 - val_accuracy100: 0.3730 - 9s/epoch - 24ms/step
Epoch 13/50
384/384 - 9s - loss: 3.2597 - accuracy100: 0.3919 - val_loss: 3.2928 - val_accuracy100: 0.3709 - 9s/epoch - 24ms/step
Epoch 14/50
384/384 - 9s - loss: 3.2570 - accuracy100: 0.3929 - val_loss: 3.2901 - val_accuracy100: 0.3737 - 9s/epoch - 25ms/step
Epoch 15/50
384/384 - 9s - loss: 3.2559 - accuracy100: 0.3936 - val_loss: 3.2932 - val_accuracy100: 0.3716 - 9s/epoch - 24ms/step
Epoch 16/50
384/384 - 9s - loss: 3.2539 - accuracy100: 0.3955 - val_loss: 3.2895 - val_accuracy100: 0.3791 - 9s/epoch - 24ms/step
Epoch 17/50
384/384 - 9s - loss: 3.2516 - accuracy100: 0.3963 - val_loss: 3.2921 - val_accuracy100: 0.3727 - 9s/epoch - 24ms/step
Epoch 18/50
384/384 - 9s - loss: 3.2489 - accuracy100: 0.3980 - val_loss: 3.2948 - val_accuracy100: 0.3732 - 9s/epoch - 24ms/step
Epoch 19/50
384/384 - 9s - loss: 3.2489 - accuracy100: 0.3973 - val_loss: 3.2942 - val_accuracy100: 0.3723 - 9s/epoch - 24ms/step
Epoch 20/50
384/384 - 9s - loss: 3.2453 - accuracy100: 0.4015 - val_loss: 3.2959 - val_accuracy100: 0.3709 - 9s/epoch - 24ms/step
Epoch 21/50
384/384 - 9s - loss: 3.2443 - accuracy100: 0.4022 - val_loss: 3.2936 - val_accuracy100: 0.3746 - 9s/epoch - 24ms/step
Epoch 22/50
384/384 - 9s - loss: 3.2411 - accuracy100: 0.4021 - val_loss: 3.2970 - val_accuracy100: 0.3713 - 9s/epoch - 24ms/step
Epoch 23/50
384/384 - 9s - loss: 3.2384 - accuracy100: 0.4040 - val_loss: 3.3003 - val_accuracy100: 0.3729 - 9s/epoch - 24ms/step
Epoch 24/50
384/384 - 9s - loss: 3.2363 - accuracy100: 0.4055 - val_loss: 3.3004 - val_accuracy100: 0.3708 - 9s/epoch - 24ms/step
Epoch 25/50
384/384 - 9s - loss: 3.2346 - accuracy100: 0.4056 - val_loss: 3.3062 - val_accuracy100: 0.3724 - 9s/epoch - 24ms/step
Epoch 26/50
384/384 - 9s - loss: 3.2336 - accuracy100: 0.4066 - val_loss: 3.3067 - val_accuracy100: 0.3690 - 9s/epoch - 24ms/step
testing model: results/CHTR/W1/deepOF_L1/h100
Evaluating performance on  test set...
1304/1304 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.089869
{'0': {'precision': 0.3916766920090786, 'recall': 0.5577228736931337, 'f1-score': 0.46017937677136384, 'support': 113248}, '1': {'precision': 0.39666256643535175, 'recall': 0.15919633376180628, 'f1-score': 0.2272059556648609, 'support': 107358}, '2': {'precision': 0.38776267282886756, 'recall': 0.44349862989481126, 'f1-score': 0.4137621071989642, 'support': 113130}, 'accuracy': 0.39080291008461776, 'macro avg': {'precision': 0.3920339770910994, 'recall': 0.3868059457832504, 'f1-score': 0.36704914654506293, 'support': 333736}, 'weighted avg': {'precision': 0.3919537988144534, 'recall': 0.39080291008461776, 'f1-score': 0.36950067788998, 'support': 333736}}
[[63161 12732 37355]
 [48404 17091 41863]
 [49693 13264 50173]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0861051
{'0': {'precision': 0.3901859753643024, 'recall': 0.5855913004077934, 'f1-score': 0.46832308640036724, 'support': 33105}, '1': {'precision': 0.3955867755974651, 'recall': 0.16116589417363983, 'f1-score': 0.22902484307311463, 'support': 32147}, '2': {'precision': 0.3954996616286939, 'recall': 0.4251204801018398, 'f1-score': 0.4097754794980791, 'support': 32993}, 'accuracy': 0.39282406229324646, 'macro avg': {'precision': 0.39375747086348706, 'recall': 0.390625891561091, 'f1-score': 0.36904113632385366, 'support': 98245}, 'weighted avg': {'precision': 0.39373764696098973, 'recall': 0.39282406229324646, 'f1-score': 0.3703600162922866, 'support': 98245}}
[[19386  3757  9962]
 [15490  5181 11476]
 [14808  4159 14026]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0968065
{'0': {'precision': 0.36712576202303004, 'recall': 0.6229885057471264, 'f1-score': 0.4619974428185822, 'support': 7830}, '1': {'precision': 0.35894405043341215, 'recall': 0.1209345546263109, 'f1-score': 0.1809154999503525, 'support': 7533}, '2': {'precision': 0.3915670394652269, 'recall': 0.3696153379444242, 'f1-score': 0.38027465667915106, 'support': 8241}, 'accuracy': 0.3743009659379766, 'macro avg': {'precision': 0.372545617307223, 'recall': 0.3711794661059538, 'f1-score': 0.3410625331493619, 'support': 23604}, 'weighted avg': {'precision': 0.37304796732706974, 'recall': 0.3743009659379766, 'f1-score': 0.34376037468600185, 'support': 23604}}
[[4878  759 2193]
 [4082  911 2540]
 [4327  868 3046]]
training model: results/CHTR/W1/deepOF_L1/h200
Epoch 1/50
384/384 - 11s - loss: 3.3354 - accuracy200: 0.3447 - val_loss: 3.3171 - val_accuracy200: 0.3374 - 11s/epoch - 29ms/step
Epoch 2/50
384/384 - 9s - loss: 3.3130 - accuracy200: 0.3497 - val_loss: 3.3095 - val_accuracy200: 0.3391 - 9s/epoch - 24ms/step
Epoch 3/50
384/384 - 9s - loss: 3.3016 - accuracy200: 0.3557 - val_loss: 3.3042 - val_accuracy200: 0.3407 - 9s/epoch - 24ms/step
Epoch 4/50
384/384 - 9s - loss: 3.2968 - accuracy200: 0.3598 - val_loss: 3.3019 - val_accuracy200: 0.3421 - 9s/epoch - 24ms/step
Epoch 5/50
384/384 - 9s - loss: 3.2927 - accuracy200: 0.3598 - val_loss: 3.2971 - val_accuracy200: 0.3460 - 9s/epoch - 24ms/step
Epoch 6/50
384/384 - 9s - loss: 3.2880 - accuracy200: 0.3632 - val_loss: 3.3014 - val_accuracy200: 0.3419 - 9s/epoch - 24ms/step
Epoch 7/50
384/384 - 9s - loss: 3.2864 - accuracy200: 0.3643 - val_loss: 3.2978 - val_accuracy200: 0.3499 - 9s/epoch - 24ms/step
Epoch 8/50
384/384 - 9s - loss: 3.2847 - accuracy200: 0.3657 - val_loss: 3.2961 - val_accuracy200: 0.3520 - 9s/epoch - 24ms/step
Epoch 9/50
384/384 - 9s - loss: 3.2809 - accuracy200: 0.3684 - val_loss: 3.2979 - val_accuracy200: 0.3437 - 9s/epoch - 24ms/step
Epoch 10/50
384/384 - 9s - loss: 3.2804 - accuracy200: 0.3700 - val_loss: 3.2969 - val_accuracy200: 0.3471 - 9s/epoch - 25ms/step
Epoch 11/50
384/384 - 9s - loss: 3.2795 - accuracy200: 0.3722 - val_loss: 3.2986 - val_accuracy200: 0.3446 - 9s/epoch - 24ms/step
Epoch 12/50
384/384 - 9s - loss: 3.2771 - accuracy200: 0.3708 - val_loss: 3.2974 - val_accuracy200: 0.3530 - 9s/epoch - 24ms/step
Epoch 13/50
384/384 - 9s - loss: 3.2757 - accuracy200: 0.3732 - val_loss: 3.2981 - val_accuracy200: 0.3495 - 9s/epoch - 24ms/step
Epoch 14/50
384/384 - 9s - loss: 3.2742 - accuracy200: 0.3754 - val_loss: 3.3001 - val_accuracy200: 0.3497 - 9s/epoch - 24ms/step
Epoch 15/50
384/384 - 9s - loss: 3.2741 - accuracy200: 0.3757 - val_loss: 3.2971 - val_accuracy200: 0.3524 - 9s/epoch - 24ms/step
Epoch 16/50
384/384 - 9s - loss: 3.2714 - accuracy200: 0.3788 - val_loss: 3.2991 - val_accuracy200: 0.3485 - 9s/epoch - 24ms/step
Epoch 17/50
384/384 - 9s - loss: 3.2693 - accuracy200: 0.3793 - val_loss: 3.2993 - val_accuracy200: 0.3507 - 9s/epoch - 24ms/step
Epoch 18/50
384/384 - 9s - loss: 3.2682 - accuracy200: 0.3810 - val_loss: 3.3001 - val_accuracy200: 0.3506 - 9s/epoch - 24ms/step
testing model: results/CHTR/W1/deepOF_L1/h200
Evaluating performance on  test set...
1304/1304 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096058
{'0': {'precision': 0.36692294572219525, 'recall': 0.49704084171613405, 'f1-score': 0.4221836434313319, 'support': 112532}, '1': {'precision': 0.33749682086641986, 'recall': 0.22360143787912828, 'f1-score': 0.2689895156476987, 'support': 106824}, '2': {'precision': 0.3742083167456842, 'recall': 0.36159293582794194, 'f1-score': 0.3677924803471704, 'support': 114380}, 'accuracy': 0.36309538078001774, 'macro avg': {'precision': 0.35954269444476644, 'recall': 0.36074507180773474, 'f1-score': 0.35298854647540034, 'support': 333736}, 'weighted avg': {'precision': 0.3600009606084326, 'recall': 0.36309538078001774, 'f1-score': 0.35450718437409734, 'support': 333736}}
[[55933 22866 33733]
 [47506 23886 35432]
 [48999 24022 41359]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0945212
{'0': {'precision': 0.3610406364222748, 'recall': 0.5146026784346174, 'f1-score': 0.4243565282217814, 'support': 32631}, '1': {'precision': 0.3512377393741242, 'recall': 0.23223495259565793, 'f1-score': 0.2796006766931271, 'support': 32381}, '2': {'precision': 0.37942291838417147, 'recall': 0.3462221286071074, 'f1-score': 0.36206299757701627, 'support': 33233}, 'accuracy': 0.3645783500432592, 'macro avg': {'precision': 0.3639004313935235, 'recall': 0.3643532532124609, 'f1-score': 0.35534006749730823, 'support': 98245}, 'weighted avg': {'precision': 0.36402776825721345, 'recall': 0.3645783500432592, 'f1-score': 0.3555739934132228, 'support': 98245}}
[[16792  6778  9061]
 [15103  7520  9758]
 [14615  7112 11506]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0990684
{'0': {'precision': 0.3317422434367542, 'recall': 0.554546705186408, 'f1-score': 0.41513903192584967, 'support': 7269}, '1': {'precision': 0.3515541264737406, 'recall': 0.20231926967678263, 'f1-score': 0.2568318847388615, 'support': 8106}, '2': {'precision': 0.37551561579257514, 'recall': 0.30975817231741404, 'f1-score': 0.3394819204901112, 'support': 8229}, 'accuracy': 0.3482460599898322, 'macro avg': {'precision': 0.35293732856769, 'recall': 0.3555413823935349, 'f1-score': 0.33715094571827414, 'support': 23604}, 'weighted avg': {'precision': 0.35380656325601634, 'recall': 0.3482460599898322, 'f1-score': 0.33439762771035997, 'support': 23604}}
[[4031 1373 1865]
 [4092 1640 2374]
 [4028 1652 2549]]
training model: results/CHTR/W1/deepOF_L1/h300
Epoch 1/50
384/384 - 11s - loss: 3.3358 - accuracy300: 0.3427 - val_loss: 3.3180 - val_accuracy300: 0.3348 - 11s/epoch - 30ms/step
Epoch 2/50
384/384 - 9s - loss: 3.3151 - accuracy300: 0.3482 - val_loss: 3.3126 - val_accuracy300: 0.3306 - 9s/epoch - 25ms/step
Epoch 3/50
384/384 - 9s - loss: 3.3049 - accuracy300: 0.3513 - val_loss: 3.3098 - val_accuracy300: 0.3335 - 9s/epoch - 24ms/step
Epoch 4/50
384/384 - 9s - loss: 3.2992 - accuracy300: 0.3537 - val_loss: 3.3086 - val_accuracy300: 0.3357 - 9s/epoch - 24ms/step
Epoch 5/50
384/384 - 9s - loss: 3.2962 - accuracy300: 0.3555 - val_loss: 3.3053 - val_accuracy300: 0.3333 - 9s/epoch - 24ms/step
Epoch 6/50
384/384 - 9s - loss: 3.2929 - accuracy300: 0.3589 - val_loss: 3.3056 - val_accuracy300: 0.3343 - 9s/epoch - 24ms/step
Epoch 7/50
384/384 - 9s - loss: 3.2902 - accuracy300: 0.3603 - val_loss: 3.3024 - val_accuracy300: 0.3363 - 9s/epoch - 24ms/step
Epoch 8/50
384/384 - 9s - loss: 3.2882 - accuracy300: 0.3610 - val_loss: 3.3023 - val_accuracy300: 0.3365 - 9s/epoch - 23ms/step
Epoch 9/50
384/384 - 9s - loss: 3.2860 - accuracy300: 0.3641 - val_loss: 3.3014 - val_accuracy300: 0.3393 - 9s/epoch - 24ms/step
Epoch 10/50
384/384 - 9s - loss: 3.2830 - accuracy300: 0.3665 - val_loss: 3.3023 - val_accuracy300: 0.3358 - 9s/epoch - 23ms/step
Epoch 11/50
384/384 - 9s - loss: 3.2830 - accuracy300: 0.3676 - val_loss: 3.3040 - val_accuracy300: 0.3343 - 9s/epoch - 24ms/step
Epoch 12/50
384/384 - 9s - loss: 3.2796 - accuracy300: 0.3688 - val_loss: 3.3001 - val_accuracy300: 0.3425 - 9s/epoch - 24ms/step
Epoch 13/50
384/384 - 9s - loss: 3.2791 - accuracy300: 0.3701 - val_loss: 3.3012 - val_accuracy300: 0.3412 - 9s/epoch - 24ms/step
Epoch 14/50
384/384 - 9s - loss: 3.2774 - accuracy300: 0.3718 - val_loss: 3.3028 - val_accuracy300: 0.3434 - 9s/epoch - 24ms/step
Epoch 15/50
384/384 - 9s - loss: 3.2772 - accuracy300: 0.3733 - val_loss: 3.3023 - val_accuracy300: 0.3418 - 9s/epoch - 24ms/step
Epoch 16/50
384/384 - 9s - loss: 3.2746 - accuracy300: 0.3756 - val_loss: 3.3056 - val_accuracy300: 0.3413 - 9s/epoch - 24ms/step
Epoch 17/50
384/384 - 9s - loss: 3.2732 - accuracy300: 0.3761 - val_loss: 3.3045 - val_accuracy300: 0.3424 - 9s/epoch - 23ms/step
Epoch 18/50
384/384 - 9s - loss: 3.2728 - accuracy300: 0.3750 - val_loss: 3.3047 - val_accuracy300: 0.3419 - 9s/epoch - 24ms/step
Epoch 19/50
384/384 - 9s - loss: 3.2711 - accuracy300: 0.3771 - val_loss: 3.3066 - val_accuracy300: 0.3435 - 9s/epoch - 24ms/step
Epoch 20/50
384/384 - 9s - loss: 3.2689 - accuracy300: 0.3792 - val_loss: 3.3062 - val_accuracy300: 0.3422 - 9s/epoch - 25ms/step
Epoch 21/50
384/384 - 9s - loss: 3.2676 - accuracy300: 0.3808 - val_loss: 3.3086 - val_accuracy300: 0.3390 - 9s/epoch - 24ms/step
Epoch 22/50
384/384 - 10s - loss: 3.2663 - accuracy300: 0.3822 - val_loss: 3.3079 - val_accuracy300: 0.3419 - 10s/epoch - 25ms/step
testing model: results/CHTR/W1/deepOF_L1/h300
Evaluating performance on  test set...
1304/1304 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0981696
{'0': {'precision': 0.3534334648332505, 'recall': 0.5318343962814831, 'f1-score': 0.4246580761636919, 'support': 111012}, '1': {'precision': 0.331512340826914, 'recall': 0.1554795719934011, 'f1-score': 0.2116807097013006, 'support': 108503}, '2': {'precision': 0.3606359185153841, 'recall': 0.3656245348928831, 'f1-score': 0.363113093530184, 'support': 114221}, 'accuracy': 0.35259007119399766, 'macro avg': {'precision': 0.3485272413918496, 'recall': 0.35097950105592246, 'f1-score': 0.33315062646505883, 'support': 333736}, 'weighted avg': {'precision': 0.34877158761283517, 'recall': 0.35259007119399766, 'f1-score': 0.33435192802668917, 'support': 333736}}
[[59040 16218 35754]
 [53348 16870 38285]
 [54659 17800 41762]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0942458
{'0': {'precision': 0.3545724921707274, 'recall': 0.5560978623501792, 'f1-score': 0.43303705663735975, 'support': 32372}, '1': {'precision': 0.3708389240304134, 'recall': 0.1785516520027072, 'f1-score': 0.24104491558859567, 'support': 32506}, '2': {'precision': 0.37636300788737703, 'recall': 0.35894746306230707, 'f1-score': 0.36744899524466945, 'support': 33367}, 'accuracy': 0.3642220978166828, 'macro avg': {'precision': 0.3672581413628393, 'recall': 0.3645323258050645, 'f1-score': 0.34717698915687495, 'support': 98245}, 'weighted avg': {'precision': 0.3673552370630721, 'recall': 0.3642220978166828, 'f1-score': 0.3472375413294965, 'support': 98245}}
[[18002  4785  9585]
 [16441  5804 10261]
 [16328  5062 11977]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1014733
{'0': {'precision': 0.31184737379288685, 'recall': 0.5709357481673135, 'f1-score': 0.4033715852543922, 'support': 6957}, '1': {'precision': 0.3766163793103448, 'recall': 0.16577730345072927, 'f1-score': 0.23021819678880198, 'support': 8433}, '2': {'precision': 0.36491963661774984, 'recall': 0.3178719259800341, 'f1-score': 0.33977487149456703, 'support': 8214}, 'accuracy': 0.3381206575156753, 'macro avg': {'precision': 0.3511277965736605, 'recall': 0.3515283258660256, 'f1-score': 0.324454884512587, 'support': 23604}, 'weighted avg': {'precision': 0.3534561091924864, 'recall': 0.3381206575156753, 'f1-score': 0.3193779430008112, 'support': 23604}}
[[3972 1020 1965]
 [4456 1398 2579]
 [4309 1294 2611]]
training model: results/CHTR/W1/deepOF_L1/h500
Epoch 1/50
384/384 - 12s - loss: 3.3417 - accuracy500: 0.3393 - val_loss: 3.3181 - val_accuracy500: 0.3383 - 12s/epoch - 30ms/step
Epoch 2/50
384/384 - 9s - loss: 3.3209 - accuracy500: 0.3436 - val_loss: 3.3148 - val_accuracy500: 0.3336 - 9s/epoch - 24ms/step
Epoch 3/50
384/384 - 9s - loss: 3.3119 - accuracy500: 0.3461 - val_loss: 3.3066 - val_accuracy500: 0.3346 - 9s/epoch - 24ms/step
Epoch 4/50
384/384 - 9s - loss: 3.3040 - accuracy500: 0.3512 - val_loss: 3.3079 - val_accuracy500: 0.3304 - 9s/epoch - 24ms/step
Epoch 5/50
384/384 - 9s - loss: 3.3015 - accuracy500: 0.3519 - val_loss: 3.3056 - val_accuracy500: 0.3291 - 9s/epoch - 25ms/step
Epoch 6/50
384/384 - 9s - loss: 3.2961 - accuracy500: 0.3566 - val_loss: 3.3051 - val_accuracy500: 0.3345 - 9s/epoch - 24ms/step
Epoch 7/50
384/384 - 9s - loss: 3.2948 - accuracy500: 0.3571 - val_loss: 3.3060 - val_accuracy500: 0.3315 - 9s/epoch - 24ms/step
Epoch 8/50
384/384 - 10s - loss: 3.2928 - accuracy500: 0.3573 - val_loss: 3.3019 - val_accuracy500: 0.3335 - 10s/epoch - 25ms/step
Epoch 9/50
384/384 - 9s - loss: 3.2899 - accuracy500: 0.3619 - val_loss: 3.3044 - val_accuracy500: 0.3299 - 9s/epoch - 24ms/step
Epoch 10/50
384/384 - 9s - loss: 3.2898 - accuracy500: 0.3605 - val_loss: 3.3047 - val_accuracy500: 0.3269 - 9s/epoch - 24ms/step
Epoch 11/50
384/384 - 9s - loss: 3.2870 - accuracy500: 0.3620 - val_loss: 3.3052 - val_accuracy500: 0.3281 - 9s/epoch - 24ms/step
Epoch 12/50
384/384 - 9s - loss: 3.2861 - accuracy500: 0.3640 - val_loss: 3.3056 - val_accuracy500: 0.3297 - 9s/epoch - 23ms/step
Epoch 13/50
384/384 - 9s - loss: 3.2847 - accuracy500: 0.3649 - val_loss: 3.3046 - val_accuracy500: 0.3285 - 9s/epoch - 23ms/step
Epoch 14/50
384/384 - 9s - loss: 3.2831 - accuracy500: 0.3659 - val_loss: 3.3065 - val_accuracy500: 0.3324 - 9s/epoch - 24ms/step
Epoch 15/50
384/384 - 9s - loss: 3.2828 - accuracy500: 0.3656 - val_loss: 3.3051 - val_accuracy500: 0.3344 - 9s/epoch - 23ms/step
Epoch 16/50
384/384 - 9s - loss: 3.2815 - accuracy500: 0.3672 - val_loss: 3.3073 - val_accuracy500: 0.3315 - 9s/epoch - 23ms/step
Epoch 17/50
384/384 - 9s - loss: 3.2801 - accuracy500: 0.3680 - val_loss: 3.3065 - val_accuracy500: 0.3314 - 9s/epoch - 24ms/step
Epoch 18/50
384/384 - 9s - loss: 3.2781 - accuracy500: 0.3722 - val_loss: 3.3071 - val_accuracy500: 0.3333 - 9s/epoch - 24ms/step
testing model: results/CHTR/W1/deepOF_L1/h500
Evaluating performance on  test set...
1304/1304 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1003652
{'0': {'precision': 0.3565565550694171, 'recall': 0.4180856901462429, 'f1-score': 0.3848775207473038, 'support': 114809}, '1': {'precision': 0.3115487322720968, 'recall': 0.31949255868862614, 'f1-score': 0.3154706452830369, 'support': 103342}, '2': {'precision': 0.34845068607872187, 'recall': 0.28078037807674006, 'f1-score': 0.31097674908850487, 'support': 115585}, 'accuracy': 0.3400022772490831, 'macro avg': {'precision': 0.33885199114007863, 'recall': 0.339452875637203, 'f1-score': 0.33710830503961525, 'support': 333736}, 'weighted avg': {'precision': 0.3398124360927104, 'recall': 0.3400022772490831, 'f1-score': 0.33779100321125577, 'support': 333736}}
[[48000 35905 30904]
 [40545 33017 29780]
 [46076 37055 32454]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0973197
{'0': {'precision': 0.3445211764137731, 'recall': 0.4442645410387346, 'f1-score': 0.38808649530803757, 'support': 32116}, '1': {'precision': 0.34592009564610937, 'recall': 0.3209169054441261, 'f1-score': 0.3329497506712697, 'support': 32457}, '2': {'precision': 0.36699101796407185, 'recall': 0.29122119268234736, 'f1-score': 0.3247449993376606, 'support': 33672}, 'accuracy': 0.35106112270344547, 'macro avg': {'precision': 0.35247743000798476, 'recall': 0.35213421305506937, 'f1-score': 0.3485937484389893, 'support': 98245}, 'weighted avg': {'precision': 0.35268453563007524, 'recall': 0.35106112270344547, 'f1-score': 0.34816173401748735, 'support': 98245}}
[[14268  9563  8285]
 [13412 10416  8629]
 [13734 10132  9806]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1015364
{'0': {'precision': 0.2996927213366622, 'recall': 0.4445235721407207, 'f1-score': 0.3580154860911959, 'support': 7021}, '1': {'precision': 0.36187668247660554, 'recall': 0.33487544483985765, 'f1-score': 0.3478528741297517, 'support': 8430}, '2': {'precision': 0.35331230283911674, 'recall': 0.23353366858824973, 'f1-score': 0.2811992320189041, 'support': 8153}, 'accuracy': 0.33248601931875954, 'macro avg': {'precision': 0.33829390221746153, 'recall': 0.3376442285229427, 'f1-score': 0.32902253074661725, 'support': 23604}, 'weighted avg': {'precision': 0.3404218875965857, 'recall': 0.33248601931875954, 'f1-score': 0.32785306708228346, 'support': 23604}}
[[3121 2330 1570]
 [3692 2823 1915]
 [3601 2648 1904]]
training model: results/CHTR/W1/deepOF_L1/h1000
Epoch 1/50
384/384 - 11s - loss: 3.3482 - accuracy1000: 0.3354 - val_loss: 3.3328 - val_accuracy1000: 0.3209 - 11s/epoch - 28ms/step
Epoch 2/50
384/384 - 9s - loss: 3.3322 - accuracy1000: 0.3344 - val_loss: 3.3182 - val_accuracy1000: 0.3172 - 9s/epoch - 23ms/step
Epoch 3/50
384/384 - 9s - loss: 3.3178 - accuracy1000: 0.3393 - val_loss: 3.3116 - val_accuracy1000: 0.3220 - 9s/epoch - 24ms/step
Epoch 4/50
384/384 - 9s - loss: 3.3119 - accuracy1000: 0.3399 - val_loss: 3.3111 - val_accuracy1000: 0.3234 - 9s/epoch - 23ms/step
Epoch 5/50
384/384 - 9s - loss: 3.3079 - accuracy1000: 0.3387 - val_loss: 3.3052 - val_accuracy1000: 0.3242 - 9s/epoch - 24ms/step
Epoch 6/50
384/384 - 9s - loss: 3.3032 - accuracy1000: 0.3419 - val_loss: 3.3023 - val_accuracy1000: 0.3266 - 9s/epoch - 25ms/step
Epoch 7/50
384/384 - 9s - loss: 3.3010 - accuracy1000: 0.3421 - val_loss: 3.3033 - val_accuracy1000: 0.3223 - 9s/epoch - 24ms/step
Epoch 8/50
384/384 - 9s - loss: 3.2984 - accuracy1000: 0.3438 - val_loss: 3.3025 - val_accuracy1000: 0.3244 - 9s/epoch - 23ms/step
Epoch 9/50
384/384 - 9s - loss: 3.2959 - accuracy1000: 0.3463 - val_loss: 3.3022 - val_accuracy1000: 0.3221 - 9s/epoch - 23ms/step
Epoch 10/50
384/384 - 9s - loss: 3.2946 - accuracy1000: 0.3479 - val_loss: 3.3026 - val_accuracy1000: 0.3206 - 9s/epoch - 23ms/step
Epoch 11/50
384/384 - 9s - loss: 3.2913 - accuracy1000: 0.3497 - val_loss: 3.3014 - val_accuracy1000: 0.3215 - 9s/epoch - 24ms/step
Epoch 12/50
384/384 - 9s - loss: 3.2904 - accuracy1000: 0.3509 - val_loss: 3.3020 - val_accuracy1000: 0.3236 - 9s/epoch - 23ms/step
Epoch 13/50
384/384 - 9s - loss: 3.2885 - accuracy1000: 0.3531 - val_loss: 3.3001 - val_accuracy1000: 0.3256 - 9s/epoch - 23ms/step
Epoch 14/50
384/384 - 9s - loss: 3.2880 - accuracy1000: 0.3519 - val_loss: 3.3002 - val_accuracy1000: 0.3298 - 9s/epoch - 23ms/step
Epoch 15/50
384/384 - 9s - loss: 3.2871 - accuracy1000: 0.3547 - val_loss: 3.2992 - val_accuracy1000: 0.3291 - 9s/epoch - 23ms/step
Epoch 16/50
384/384 - 9s - loss: 3.2848 - accuracy1000: 0.3568 - val_loss: 3.3003 - val_accuracy1000: 0.3285 - 9s/epoch - 23ms/step
Epoch 17/50
384/384 - 9s - loss: 3.2838 - accuracy1000: 0.3570 - val_loss: 3.3008 - val_accuracy1000: 0.3305 - 9s/epoch - 23ms/step
Epoch 18/50
384/384 - 8s - loss: 3.2830 - accuracy1000: 0.3578 - val_loss: 3.3003 - val_accuracy1000: 0.3321 - 8s/epoch - 22ms/step
Epoch 19/50
384/384 - 8s - loss: 3.2810 - accuracy1000: 0.3614 - val_loss: 3.3014 - val_accuracy1000: 0.3306 - 8s/epoch - 21ms/step
Epoch 20/50
384/384 - 9s - loss: 3.2811 - accuracy1000: 0.3599 - val_loss: 3.3009 - val_accuracy1000: 0.3340 - 9s/epoch - 23ms/step
Epoch 21/50
384/384 - 8s - loss: 3.2790 - accuracy1000: 0.3626 - val_loss: 3.3017 - val_accuracy1000: 0.3343 - 8s/epoch - 22ms/step
Epoch 22/50
384/384 - 8s - loss: 3.2774 - accuracy1000: 0.3655 - val_loss: 3.3023 - val_accuracy1000: 0.3378 - 8s/epoch - 22ms/step
Epoch 23/50
384/384 - 9s - loss: 3.2766 - accuracy1000: 0.3658 - val_loss: 3.3017 - val_accuracy1000: 0.3344 - 9s/epoch - 23ms/step
Epoch 24/50
384/384 - 9s - loss: 3.2750 - accuracy1000: 0.3650 - val_loss: 3.3031 - val_accuracy1000: 0.3343 - 9s/epoch - 22ms/step
Epoch 25/50
384/384 - 8s - loss: 3.2752 - accuracy1000: 0.3633 - val_loss: 3.3041 - val_accuracy1000: 0.3395 - 8s/epoch - 22ms/step
testing model: results/CHTR/W1/deepOF_L1/h1000
Evaluating performance on  test set...
1304/1304 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017343
{'0': {'precision': 0.3438638471775982, 'recall': 0.4510452209026547, 'f1-score': 0.3902286466179752, 'support': 113421}, '1': {'precision': 0.30384734239802225, 'recall': 0.307217622246524, 'f1-score': 0.30552318806804935, 'support': 102416}, '2': {'precision': 0.3500184252548827, 'recall': 0.24168992103410547, 'f1-score': 0.28593791549804576, 'support': 117899}, 'accuracy': 0.33294879785219456, 'macro avg': {'precision': 0.33257653827683437, 'recall': 0.33331758806109474, 'f1-score': 0.32722991672802343, 'support': 333736}, 'weighted avg': {'precision': 0.3337579198794605, 'recall': 0.33294879785219456, 'f1-score': 0.327391652253694, 'support': 333736}}
[[51158 34830 27433]
 [45470 31464 25482]
 [52146 37258 28495]]
Evaluating performance on  train set...
384/384 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0961843
{'0': {'precision': 0.345072428831277, 'recall': 0.48805132814679353, 'f1-score': 0.40429301358256087, 'support': 32263}, '1': {'precision': 0.35310047913339354, 'recall': 0.31336661120354964, 'f1-score': 0.33204910539375737, 'support': 32454}, '2': {'precision': 0.37476902402150175, 'recall': 0.26616559293724645, 'f1-score': 0.3112661318451343, 'support': 33528}, 'accuracy': 0.3546236449692096, 'macro avg': {'precision': 0.35764731066205746, 'recall': 0.3558611774291965, 'f1-score': 0.3492027502738175, 'support': 98245}, 'weighted avg': {'precision': 0.3578589298037717, 'recall': 0.3546236449692096, 'f1-score': 0.34868093065465744, 'support': 98245}}
[[15746  9133  7384]
 [14780 10170  7504]
 [15105  9499  8924]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006821
{'0': {'precision': 0.2743752199929602, 'recall': 0.47778118296046584, 'f1-score': 0.34857462269424266, 'support': 6526}, '1': {'precision': 0.38814713896457764, 'recall': 0.3187157400156617, 'f1-score': 0.3500215000921432, 'support': 8939}, '2': {'precision': 0.36142857142857143, 'recall': 0.21759429905393782, 'f1-score': 0.27164659866554186, 'support': 8139}, 'accuracy': 0.32782579223860364, 'macro avg': {'precision': 0.3413169767953697, 'recall': 0.33803040734335515, 'f1-score': 0.32341424048397593, 'support': 23604}, 'weighted avg': {'precision': 0.3474786944473632, 'recall': 0.32782579223860364, 'f1-score': 0.32259667190159047, 'support': 23604}}
[[3118 2026 1382]
 [4343 2849 1747]
 [3903 2465 1771]]
training model: results/CHTR/W1/deepLOB_L2/h10
Epoch 1/50
384/384 - 21s - loss: 3.3405 - accuracy10: 0.3451 - val_loss: 3.4662 - val_accuracy10: 0.3277 - 21s/epoch - 55ms/step
Epoch 2/50
384/384 - 18s - loss: 3.3068 - accuracy10: 0.3551 - val_loss: 3.4103 - val_accuracy10: 0.3304 - 18s/epoch - 47ms/step
Epoch 3/50
384/384 - 18s - loss: 3.2819 - accuracy10: 0.3688 - val_loss: 3.3909 - val_accuracy10: 0.3380 - 18s/epoch - 47ms/step
Epoch 4/50
384/384 - 18s - loss: 3.2624 - accuracy10: 0.3856 - val_loss: 3.3923 - val_accuracy10: 0.3398 - 18s/epoch - 48ms/step
Epoch 5/50
384/384 - 18s - loss: 3.2476 - accuracy10: 0.3958 - val_loss: 3.3468 - val_accuracy10: 0.3491 - 18s/epoch - 48ms/step
Epoch 6/50
384/384 - 19s - loss: 3.2345 - accuracy10: 0.4068 - val_loss: 3.3334 - val_accuracy10: 0.3413 - 19s/epoch - 48ms/step
Epoch 7/50
384/384 - 19s - loss: 3.2238 - accuracy10: 0.4143 - val_loss: 3.3177 - val_accuracy10: 0.3507 - 19s/epoch - 48ms/step
Epoch 8/50
384/384 - 18s - loss: 3.2105 - accuracy10: 0.4208 - val_loss: 3.3053 - val_accuracy10: 0.3696 - 18s/epoch - 48ms/step
Epoch 9/50
384/384 - 18s - loss: 3.2008 - accuracy10: 0.4250 - val_loss: 3.3244 - val_accuracy10: 0.3689 - 18s/epoch - 48ms/step
Epoch 10/50
384/384 - 18s - loss: 3.1915 - accuracy10: 0.4288 - val_loss: 3.3222 - val_accuracy10: 0.3621 - 18s/epoch - 48ms/step
Epoch 11/50
384/384 - 18s - loss: 3.1835 - accuracy10: 0.4341 - val_loss: 3.3885 - val_accuracy10: 0.3354 - 18s/epoch - 47ms/step
Epoch 12/50
384/384 - 18s - loss: 3.1762 - accuracy10: 0.4359 - val_loss: 3.3425 - val_accuracy10: 0.3495 - 18s/epoch - 48ms/step
Epoch 13/50
384/384 - 18s - loss: 3.1681 - accuracy10: 0.4413 - val_loss: 3.3701 - val_accuracy10: 0.3510 - 18s/epoch - 48ms/step
Epoch 14/50
384/384 - 19s - loss: 3.1619 - accuracy10: 0.4430 - val_loss: 3.3702 - val_accuracy10: 0.3469 - 19s/epoch - 48ms/step
Epoch 15/50
384/384 - 18s - loss: 3.1540 - accuracy10: 0.4464 - val_loss: 3.3640 - val_accuracy10: 0.3438 - 18s/epoch - 48ms/step
Epoch 16/50
384/384 - 18s - loss: 3.1469 - accuracy10: 0.4494 - val_loss: 3.3699 - val_accuracy10: 0.3418 - 18s/epoch - 47ms/step
Epoch 17/50
384/384 - 18s - loss: 3.1406 - accuracy10: 0.4526 - val_loss: 3.3789 - val_accuracy10: 0.3356 - 18s/epoch - 47ms/step
Epoch 18/50
384/384 - 18s - loss: 3.1315 - accuracy10: 0.4552 - val_loss: 3.3696 - val_accuracy10: 0.3466 - 18s/epoch - 47ms/step
testing model: results/CHTR/W1/deepLOB_L2/h10
Evaluating performance on  test set...
1304/1304 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0900278
{'0': {'precision': 0.39109795599240477, 'recall': 0.538591034164516, 'f1-score': 0.4531447716553549, 'support': 117022}, '1': {'precision': 0.39350470138955745, 'recall': 0.11819023017311177, 'f1-score': 0.18178179365349975, 'support': 103748}, '2': {'precision': 0.3800432735140639, 'recall': 0.47576811748147757, 'f1-score': 0.42255215273765023, 'support': 112971}, 'accuracy': 0.38663814155288084, 'macro avg': {'precision': 0.3882153102986754, 'recall': 0.3775164606063685, 'f1-score': 0.3524929060155016, 'support': 333741}, 'weighted avg': {'precision': 0.3881041269069857, 'recall': 0.38663814155288084, 'f1-score': 0.3584322700643353, 'support': 333741}}
[[63027  9624 44371]
 [48179 12262 43307]
 [49948  9275 53748]]
Evaluating performance on  train set...
384/384 - 8s - 8s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0901165
{'0': {'precision': 0.38026303339956474, 'recall': 0.5928603038796283, 'f1-score': 0.46333871339635696, 'support': 33895}, '1': {'precision': 0.3666973499345962, 'recall': 0.23469767441860465, 'f1-score': 0.28621126467641, 'support': 32250}, '2': {'precision': 0.3979402261712439, 'recall': 0.3069374785832217, 'f1-score': 0.34656442904627066, 'support': 32101}, 'accuracy': 0.38186796409014107, 'macro avg': {'precision': 0.3816335365018016, 'recall': 0.37816515229381825, 'f1-score': 0.3653714690396792, 'support': 98246}, 'weighted avg': {'precision': 0.381585858485761, 'recall': 0.38186796409014107, 'f1-score': 0.36704032442234874, 'support': 98246}}
[[20095  6409  7391]
 [17165  7569  7516]
 [15585  6663  9853]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.09962
{'0': {'precision': 0.3698093300173336, 'recall': 0.6015692043643497, 'f1-score': 0.45804163166246614, 'support': 8157}, '1': {'precision': 0.31704456606724, 'recall': 0.220770382469035, 'f1-score': 0.26029045976089227, 'support': 7347}, '2': {'precision': 0.4092738072427668, 'recall': 0.2637037037037037, 'f1-score': 0.32074480066071026, 'support': 8100}, 'accuracy': 0.3670987968140993, 'macro avg': {'precision': 0.3653759011091135, 'recall': 0.3620144301790295, 'f1-score': 0.3463589640280229, 'support': 23604}, 'weighted avg': {'precision': 0.3669284430822663, 'recall': 0.3670987968140993, 'f1-score': 0.3493743637809594, 'support': 23604}}
[[4907 1677 1573]
 [4215 1622 1510]
 [4147 1817 2136]]
training model: results/CHTR/W1/deepLOB_L2/h20
Epoch 1/50
384/384 - 22s - loss: 3.3435 - accuracy20: 0.3446 - val_loss: 3.4550 - val_accuracy20: 0.3334 - 22s/epoch - 56ms/step
Epoch 2/50
384/384 - 19s - loss: 3.3022 - accuracy20: 0.3594 - val_loss: 3.4670 - val_accuracy20: 0.3396 - 19s/epoch - 48ms/step
Epoch 3/50
384/384 - 19s - loss: 3.2820 - accuracy20: 0.3744 - val_loss: 3.3711 - val_accuracy20: 0.3438 - 19s/epoch - 48ms/step
Epoch 4/50
384/384 - 18s - loss: 3.2694 - accuracy20: 0.3808 - val_loss: 3.3808 - val_accuracy20: 0.3495 - 18s/epoch - 48ms/step
Epoch 5/50
384/384 - 18s - loss: 3.2542 - accuracy20: 0.3933 - val_loss: 3.3817 - val_accuracy20: 0.3499 - 18s/epoch - 48ms/step
Epoch 6/50
384/384 - 18s - loss: 3.2413 - accuracy20: 0.4019 - val_loss: 3.4906 - val_accuracy20: 0.3457 - 18s/epoch - 48ms/step
Epoch 7/50
384/384 - 18s - loss: 3.2304 - accuracy20: 0.4108 - val_loss: 3.3901 - val_accuracy20: 0.3578 - 18s/epoch - 48ms/step
Epoch 8/50
384/384 - 18s - loss: 3.2216 - accuracy20: 0.4145 - val_loss: 3.3473 - val_accuracy20: 0.3610 - 18s/epoch - 48ms/step
Epoch 9/50
384/384 - 19s - loss: 3.2095 - accuracy20: 0.4217 - val_loss: 3.3108 - val_accuracy20: 0.3718 - 19s/epoch - 48ms/step
Epoch 10/50
384/384 - 19s - loss: 3.2006 - accuracy20: 0.4270 - val_loss: 3.3398 - val_accuracy20: 0.3670 - 19s/epoch - 48ms/step
Epoch 11/50
384/384 - 18s - loss: 3.1921 - accuracy20: 0.4317 - val_loss: 3.3048 - val_accuracy20: 0.3754 - 18s/epoch - 48ms/step
Epoch 12/50
384/384 - 18s - loss: 3.1885 - accuracy20: 0.4324 - val_loss: 3.3276 - val_accuracy20: 0.3801 - 18s/epoch - 47ms/step
Epoch 13/50
384/384 - 18s - loss: 3.1765 - accuracy20: 0.4365 - val_loss: 3.3802 - val_accuracy20: 0.3668 - 18s/epoch - 48ms/step
Epoch 14/50
384/384 - 18s - loss: 3.1716 - accuracy20: 0.4413 - val_loss: 3.4709 - val_accuracy20: 0.3522 - 18s/epoch - 48ms/step
Epoch 15/50
384/384 - 18s - loss: 3.1649 - accuracy20: 0.4433 - val_loss: 3.4919 - val_accuracy20: 0.3533 - 18s/epoch - 48ms/step
Epoch 16/50
384/384 - 18s - loss: 3.1593 - accuracy20: 0.4457 - val_loss: 3.4589 - val_accuracy20: 0.3529 - 18s/epoch - 48ms/step
Epoch 17/50
384/384 - 18s - loss: 3.1533 - accuracy20: 0.4478 - val_loss: 3.4126 - val_accuracy20: 0.3628 - 18s/epoch - 47ms/step
Epoch 18/50
384/384 - 18s - loss: 3.1451 - accuracy20: 0.4503 - val_loss: 3.4098 - val_accuracy20: 0.3615 - 18s/epoch - 48ms/step
Epoch 19/50
384/384 - 18s - loss: 3.1366 - accuracy20: 0.4520 - val_loss: 3.4085 - val_accuracy20: 0.3618 - 18s/epoch - 48ms/step
Epoch 20/50
384/384 - 18s - loss: 3.1310 - accuracy20: 0.4554 - val_loss: 3.4554 - val_accuracy20: 0.3586 - 18s/epoch - 48ms/step
Epoch 21/50
384/384 - 19s - loss: 3.1238 - accuracy20: 0.4587 - val_loss: 3.3848 - val_accuracy20: 0.3660 - 19s/epoch - 49ms/step
testing model: results/CHTR/W1/deepLOB_L2/h20
Evaluating performance on  test set...
1304/1304 - 26s - 26s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1006016
{'0': {'precision': 0.36602371602371603, 'recall': 0.8205041900767246, 'f1-score': 0.506223226812989, 'support': 115869}, '1': {'precision': 0.3889709502708026, 'recall': 0.06653627677593839, 'f1-score': 0.11363454745960459, 'support': 106859}, '2': {'precision': 0.39316607444097484, 'recall': 0.19734625674470557, 'f1-score': 0.26278825681470597, 'support': 111013}, 'accuracy': 0.37181227358940017, 'macro avg': {'precision': 0.38272024691183115, 'recall': 0.36146224119912285, 'f1-score': 0.2942153436957665, 'support': 333741}, 'weighted avg': {'precision': 0.3823995078484681, 'recall': 0.37181227358940017, 'f1-score': 0.29954775088572, 'support': 333741}}
[[95071  5549 15249]
 [81184  7110 18565]
 [83485  5620 21908]]
Evaluating performance on  train set...
384/384 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0992024
{'0': {'precision': 0.3605644262903825, 'recall': 0.8058807837092806, 'f1-score': 0.4982179016135091, 'support': 33737}, '1': {'precision': 0.38895321908290875, 'recall': 0.10281603917967555, 'f1-score': 0.1626398101970658, 'support': 32670}, '2': {'precision': 0.4106011544417852, 'recall': 0.18320299004365714, 'f1-score': 0.2533608426539255, 'support': 31839}, 'accuracy': 0.3702949738411742, 'macro avg': {'precision': 0.38670626660502544, 'recall': 0.36396660431087113, 'f1-score': 0.3047395181548335, 'support': 98246}, 'weighted avg': {'precision': 0.38622024177543374, 'recall': 0.3702949738411742, 'f1-score': 0.3072753681079273, 'support': 98246}}
[[27188  2483  4066]
 [25004  3359  4307]
 [23212  2794  5833]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0980697
{'0': {'precision': 0.36648449759212165, 'recall': 0.8333948566506706, 'f1-score': 0.5090950090198437, 'support': 8127}, '1': {'precision': 0.37153593236261157, 'recall': 0.10594695954995982, 'f1-score': 0.16487754038561753, 'support': 7466}, '2': {'precision': 0.4218436873747495, 'recall': 0.1576582199475721, 'f1-score': 0.22953203089504773, 'support': 8011}, 'accuracy': 0.3739620403321471, 'macro avg': {'precision': 0.3866213724431609, 'recall': 0.36566667871606745, 'f1-score': 0.301168193433503, 'support': 23604}, 'weighted avg': {'precision': 0.38687072371248726, 'recall': 0.3739620403321471, 'f1-score': 0.3053368901170784, 'support': 23604}}
[[6773  600  754]
 [5698  791  977]
 [6010  738 1263]]
training model: results/CHTR/W1/deepLOB_L2/h30
Epoch 1/50
384/384 - 20s - loss: 3.3440 - accuracy30: 0.3444 - val_loss: 3.5348 - val_accuracy30: 0.3324 - 20s/epoch - 52ms/step
Epoch 2/50
384/384 - 18s - loss: 3.3120 - accuracy30: 0.3509 - val_loss: 3.3521 - val_accuracy30: 0.3432 - 18s/epoch - 48ms/step
Epoch 3/50
384/384 - 18s - loss: 3.2902 - accuracy30: 0.3658 - val_loss: 3.3723 - val_accuracy30: 0.3439 - 18s/epoch - 48ms/step
Epoch 4/50
384/384 - 18s - loss: 3.2781 - accuracy30: 0.3752 - val_loss: 3.4100 - val_accuracy30: 0.3403 - 18s/epoch - 48ms/step
Epoch 5/50
384/384 - 18s - loss: 3.2702 - accuracy30: 0.3797 - val_loss: 3.3964 - val_accuracy30: 0.3434 - 18s/epoch - 48ms/step
Epoch 6/50
384/384 - 18s - loss: 3.2605 - accuracy30: 0.3894 - val_loss: 3.4182 - val_accuracy30: 0.3437 - 18s/epoch - 48ms/step
Epoch 7/50
384/384 - 18s - loss: 3.2511 - accuracy30: 0.3965 - val_loss: 3.4282 - val_accuracy30: 0.3454 - 18s/epoch - 47ms/step
Epoch 8/50
384/384 - 19s - loss: 3.2458 - accuracy30: 0.3996 - val_loss: 3.4707 - val_accuracy30: 0.3461 - 19s/epoch - 49ms/step
Epoch 9/50
384/384 - 18s - loss: 3.2398 - accuracy30: 0.4046 - val_loss: 3.4195 - val_accuracy30: 0.3470 - 18s/epoch - 48ms/step
Epoch 10/50
384/384 - 18s - loss: 3.2322 - accuracy30: 0.4093 - val_loss: 3.4279 - val_accuracy30: 0.3447 - 18s/epoch - 48ms/step
Epoch 11/50
384/384 - 18s - loss: 3.2229 - accuracy30: 0.4145 - val_loss: 3.4352 - val_accuracy30: 0.3477 - 18s/epoch - 48ms/step
Epoch 12/50
384/384 - 18s - loss: 3.2155 - accuracy30: 0.4190 - val_loss: 3.4306 - val_accuracy30: 0.3427 - 18s/epoch - 48ms/step
testing model: results/CHTR/W1/deepLOB_L2/h30
Evaluating performance on  test set...
1304/1304 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1152799
{'0': {'precision': 0.3505018106570098, 'recall': 0.4386454080091158, 'f1-score': 0.389651021018488, 'support': 115843}, '1': {'precision': 0.31971962941115234, 'recall': 0.25892204799640306, 'f1-score': 0.28612685350516265, 'support': 106758}, '2': {'precision': 0.3398137016293777, 'recall': 0.3128126687061364, 'f1-score': 0.3257546299115948, 'support': 111140}, 'accuracy': 0.3392510959097024, 'macro avg': {'precision': 0.3366783805658466, 'recall': 0.3367933749038851, 'f1-score': 0.33384416814508183, 'support': 333741}, 'weighted avg': {'precision': 0.3370958445252601, 'recall': 0.3392510959097024, 'f1-score': 0.3352571108216357, 'support': 333741}}
[[50814 29671 35358]
 [46931 27642 32185]
 [47230 29144 34766]]
Evaluating performance on  train set...
384/384 - 8s - 8s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1132057
{'0': {'precision': 0.3470831331090822, 'recall': 0.53562529663028, 'f1-score': 0.4212183771300606, 'support': 33712}, '1': {'precision': 0.3354180029933718, 'recall': 0.19283958205285803, 'f1-score': 0.24488760536996568, 'support': 32540}, '2': {'precision': 0.3319885145204085, 'recall': 0.285491029568044, 'f1-score': 0.30698909372006655, 'support': 31994}, 'accuracy': 0.34063473322069093, 'macro avg': {'precision': 0.33816321687428746, 'recall': 0.337985302750394, 'f1-score': 0.3243650254066976, 'support': 98246}, 'weighted avg': {'precision': 0.3383039404590889, 'recall': 0.34063473322069093, 'f1-score': 0.32561697853375293, 'support': 98246}}
[[18057  6336  9319]
 [17205  6275  9060]
 [16763  6097  9134]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1170348
{'0': {'precision': 0.34828148033206613, 'recall': 0.5548139908540354, 'f1-score': 0.4279313632030506, 'support': 8091}, '1': {'precision': 0.324400871459695, 'recall': 0.19874532835024025, 'f1-score': 0.24648237046846547, 'support': 7492}, '2': {'precision': 0.33338775510204083, 'recall': 0.2545817229771849, 'f1-score': 0.2887035204298035, 'support': 8021}, 'accuracy': 0.33977291984409425, 'macro avg': {'precision': 0.33535670229793396, 'recall': 0.3360470140604868, 'f1-score': 0.32103908470043985, 'support': 23604}, 'weighted avg': {'precision': 0.33564056812473525, 'recall': 0.33977291984409425, 'f1-score': 0.323027008837192, 'support': 23604}}
[[4489 1547 2055]
 [3975 1489 2028]
 [4425 1554 2042]]
training model: results/CHTR/W1/deepLOB_L2/h50
Epoch 1/50
384/384 - 20s - loss: 3.3454 - accuracy50: 0.3457 - val_loss: 3.4044 - val_accuracy50: 0.3404 - 20s/epoch - 53ms/step
Epoch 2/50
384/384 - 18s - loss: 3.3094 - accuracy50: 0.3533 - val_loss: 3.4292 - val_accuracy50: 0.3491 - 18s/epoch - 48ms/step
Epoch 3/50
384/384 - 18s - loss: 3.2909 - accuracy50: 0.3630 - val_loss: 3.4675 - val_accuracy50: 0.3519 - 18s/epoch - 48ms/step
Epoch 4/50
384/384 - 18s - loss: 3.2786 - accuracy50: 0.3748 - val_loss: 3.4914 - val_accuracy50: 0.3493 - 18s/epoch - 48ms/step
Epoch 5/50
384/384 - 18s - loss: 3.2729 - accuracy50: 0.3802 - val_loss: 3.4669 - val_accuracy50: 0.3477 - 18s/epoch - 48ms/step
Epoch 6/50
384/384 - 18s - loss: 3.2652 - accuracy50: 0.3891 - val_loss: 3.4445 - val_accuracy50: 0.3525 - 18s/epoch - 48ms/step
Epoch 7/50
384/384 - 18s - loss: 3.2599 - accuracy50: 0.3930 - val_loss: 3.4831 - val_accuracy50: 0.3478 - 18s/epoch - 47ms/step
Epoch 8/50
384/384 - 18s - loss: 3.2529 - accuracy50: 0.3975 - val_loss: 3.4878 - val_accuracy50: 0.3474 - 18s/epoch - 48ms/step
Epoch 9/50
384/384 - 18s - loss: 3.2459 - accuracy50: 0.4011 - val_loss: 3.4830 - val_accuracy50: 0.3507 - 18s/epoch - 48ms/step
Epoch 10/50
384/384 - 18s - loss: 3.2416 - accuracy50: 0.4050 - val_loss: 3.5236 - val_accuracy50: 0.3505 - 18s/epoch - 47ms/step
Epoch 11/50
384/384 - 18s - loss: 3.2366 - accuracy50: 0.4084 - val_loss: 3.4737 - val_accuracy50: 0.3478 - 18s/epoch - 48ms/step
testing model: results/CHTR/W1/deepLOB_L2/h50
Evaluating performance on  test set...
1304/1304 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1317664
{'0': {'precision': 0.34058614564831263, 'recall': 0.47372450089165324, 'f1-score': 0.39627138007691554, 'support': 114955}, '1': {'precision': 0.31197546921662805, 'recall': 0.40254455789009835, 'f1-score': 0.3515199646310411, 'support': 106659}, '2': {'precision': 0.342544029150334, 'recall': 0.11066915194377804, 'f1-score': 0.16729017950429045, 'support': 112127}, 'accuracy': 0.32900063222678666, 'macro avg': {'precision': 0.3317018813384249, 'recall': 0.3289794035751766, 'f1-score': 0.30502717473741575, 'support': 333741}, 'weighted avg': {'precision': 0.33210036016167516, 'recall': 0.32900063222678666, 'f1-score': 0.3050386088661615, 'support': 333741}}
[[54457 47712 12786]
 [52693 42935 11031]
 [52742 46976 12409]]
Evaluating performance on  train set...
384/384 - 8s - 8s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1262294
{'0': {'precision': 0.3482664514145141, 'recall': 0.5374280799572928, 'f1-score': 0.4226472303206996, 'support': 33718}, '1': {'precision': 0.3282453597112078, 'recall': 0.3614284372946074, 'f1-score': 0.344038610498719, 'support': 31951}, '2': {'precision': 0.33934559956494154, 'recall': 0.11492770973386131, 'f1-score': 0.1717037376748452, 'support': 32577}, 'accuracy': 0.34009527105429227, 'macro avg': {'precision': 0.33861913689688783, 'recall': 0.3379280756619205, 'f1-score': 0.31279652616475456, 'support': 98246}, 'weighted avg': {'precision': 0.3387972771813049, 'recall': 0.34009527105429227, 'f1-score': 0.3138732326835835, 'support': 98246}}
[[18121 11929  3668]
 [16782 11548  3621]
 [17129 11704  3744]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1356225
{'0': {'precision': 0.3500838798230898, 'recall': 0.5645597638957206, 'f1-score': 0.4321754683234491, 'support': 8132}, '1': {'precision': 0.32213812677388837, 'recall': 0.3722328505056026, 'f1-score': 0.34537847090148344, 'support': 7318}, '2': {'precision': 0.3254670599803343, 'recall': 0.08118714741231298, 'f1-score': 0.1299568119356105, 'support': 8154}, 'accuracy': 0.3379511947127605, 'macro avg': {'precision': 0.3325630221924375, 'recall': 0.33932658727121207, 'f1-score': 0.302503583720181, 'support': 23604}, 'weighted avg': {'precision': 0.3329159180449215, 'recall': 0.3379511947127605, 'f1-score': 0.3008641926362613, 'support': 23604}}
[[4591 2813  728]
 [3950 2724  644]
 [4573 2919  662]]
training model: results/CHTR/W1/deepLOB_L2/h100
Epoch 1/50
384/384 - 21s - loss: 3.3439 - accuracy100: 0.3461 - val_loss: 3.4272 - val_accuracy100: 0.3297 - 21s/epoch - 55ms/step
Epoch 2/50
384/384 - 19s - loss: 3.3173 - accuracy100: 0.3499 - val_loss: 3.3522 - val_accuracy100: 0.3385 - 19s/epoch - 49ms/step
Epoch 3/50
384/384 - 19s - loss: 3.2983 - accuracy100: 0.3572 - val_loss: 3.4208 - val_accuracy100: 0.3375 - 19s/epoch - 48ms/step
Epoch 4/50
384/384 - 19s - loss: 3.2884 - accuracy100: 0.3621 - val_loss: 3.3817 - val_accuracy100: 0.3417 - 19s/epoch - 48ms/step
Epoch 5/50
384/384 - 19s - loss: 3.2828 - accuracy100: 0.3682 - val_loss: 3.4695 - val_accuracy100: 0.3454 - 19s/epoch - 49ms/step
Epoch 6/50
384/384 - 19s - loss: 3.2739 - accuracy100: 0.3776 - val_loss: 3.4254 - val_accuracy100: 0.3395 - 19s/epoch - 48ms/step
Epoch 7/50
384/384 - 19s - loss: 3.2699 - accuracy100: 0.3823 - val_loss: 3.3892 - val_accuracy100: 0.3394 - 19s/epoch - 48ms/step
Epoch 8/50
384/384 - 18s - loss: 3.2618 - accuracy100: 0.3858 - val_loss: 3.3950 - val_accuracy100: 0.3348 - 18s/epoch - 48ms/step
Epoch 9/50
384/384 - 18s - loss: 3.2558 - accuracy100: 0.3923 - val_loss: 3.3786 - val_accuracy100: 0.3377 - 18s/epoch - 47ms/step
Epoch 10/50
384/384 - 18s - loss: 3.2497 - accuracy100: 0.3991 - val_loss: 3.4530 - val_accuracy100: 0.3410 - 18s/epoch - 48ms/step
Epoch 11/50
384/384 - 18s - loss: 3.2436 - accuracy100: 0.4022 - val_loss: 3.5216 - val_accuracy100: 0.3438 - 18s/epoch - 48ms/step
Epoch 12/50
384/384 - 19s - loss: 3.2384 - accuracy100: 0.4061 - val_loss: 3.4561 - val_accuracy100: 0.3401 - 19s/epoch - 49ms/step
testing model: results/CHTR/W1/deepLOB_L2/h100
Evaluating performance on  test set...
1304/1304 - 26s - 26s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.119643
{'0': {'precision': 0.3419263941511338, 'recall': 0.6343134657836644, 'f1-score': 0.4443344817561591, 'support': 113250}, '1': {'precision': 0.3171545490478737, 'recall': 0.254110042008588, 'f1-score': 0.28215351360296204, 'support': 107359}, '2': {'precision': 0.306741782041402, 'recall': 0.10203125552452003, 'f1-score': 0.15312775681035798, 'support': 113132}, 'accuracy': 0.33157448440557197, 'macro avg': {'precision': 0.32194090841346984, 'recall': 0.33015158777225745, 'f1-score': 0.29320525072315967, 'support': 333741}, 'weighted avg': {'precision': 0.32203076833459016, 'recall': 0.33157448440557197, 'f1-score': 0.2934498563534442, 'support': 333741}}
[[71836 29849 11565]
 [65555 27281 14523]
 [72701 28888 11543]]
Evaluating performance on  train set...
384/384 - 8s - 8s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1127625
{'0': {'precision': 0.3395550595773786, 'recall': 0.5702152097690727, 'f1-score': 0.4256447282326662, 'support': 33084}, '1': {'precision': 0.32589208757110844, 'recall': 0.2353343914355958, 'f1-score': 0.27330719048737734, 'support': 32133}, '2': {'precision': 0.34274276329295833, 'recall': 0.2021859577946653, 'f1-score': 0.2543370213090092, 'support': 33029}, 'accuracy': 0.3369602833703153, 'macro avg': {'precision': 0.3360633034804818, 'recall': 0.33591185299977794, 'f1-score': 0.3177629800096842, 'support': 98246}, 'weighted avg': {'precision': 0.3361580193573636, 'recall': 0.3369602833703153, 'f1-score': 0.31822880949449023, 'support': 98246}}
[[18865  7754  6465]
 [18230  7562  6341]
 [18463  7888  6678]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1156931
{'0': {'precision': 0.3416893732970027, 'recall': 0.5594646271510516, 'f1-score': 0.42426292895118417, 'support': 7845}, '1': {'precision': 0.3291037584323803, 'recall': 0.27070947284978203, 'f1-score': 0.2970641536788692, 'support': 7569}, '2': {'precision': 0.3454665784248842, 'recall': 0.1912087912087912, 'f1-score': 0.2461683565196887, 'support': 8190}, 'accuracy': 0.33909506863243516, 'macro avg': {'precision': 0.33875323671808905, 'recall': 0.3404609637365416, 'f1-score': 0.3224984797165807, 'support': 23604}, 'weighted avg': {'precision': 0.338964190746885, 'recall': 0.33909506863243516, 'f1-score': 0.32168022778824146, 'support': 23604}}
[[4389 1954 1502]
 [4055 2049 1465]
 [4401 2223 1566]]
training model: results/CHTR/W1/deepLOB_L2/h200
Epoch 1/50
384/384 - 23s - loss: 3.3438 - accuracy200: 0.3510 - val_loss: 3.4349 - val_accuracy200: 0.3404 - 23s/epoch - 59ms/step
Epoch 2/50
384/384 - 19s - loss: 3.3115 - accuracy200: 0.3558 - val_loss: 3.4618 - val_accuracy200: 0.3312 - 19s/epoch - 49ms/step
Epoch 3/50
384/384 - 19s - loss: 3.2989 - accuracy200: 0.3572 - val_loss: 3.4248 - val_accuracy200: 0.3375 - 19s/epoch - 49ms/step
Epoch 4/50
384/384 - 19s - loss: 3.2907 - accuracy200: 0.3622 - val_loss: 3.4029 - val_accuracy200: 0.3448 - 19s/epoch - 49ms/step
Epoch 5/50
384/384 - 19s - loss: 3.2818 - accuracy200: 0.3690 - val_loss: 3.4048 - val_accuracy200: 0.3475 - 19s/epoch - 49ms/step
Epoch 6/50
384/384 - 19s - loss: 3.2715 - accuracy200: 0.3781 - val_loss: 3.4060 - val_accuracy200: 0.3470 - 19s/epoch - 49ms/step
Epoch 7/50
384/384 - 19s - loss: 3.2659 - accuracy200: 0.3812 - val_loss: 3.4108 - val_accuracy200: 0.3485 - 19s/epoch - 49ms/step
Epoch 8/50
384/384 - 19s - loss: 3.2541 - accuracy200: 0.3929 - val_loss: 3.4518 - val_accuracy200: 0.3463 - 19s/epoch - 49ms/step
Epoch 9/50
384/384 - 19s - loss: 3.2467 - accuracy200: 0.3966 - val_loss: 3.4377 - val_accuracy200: 0.3470 - 19s/epoch - 48ms/step
Epoch 10/50
384/384 - 18s - loss: 3.2394 - accuracy200: 0.4015 - val_loss: 3.4310 - val_accuracy200: 0.3460 - 18s/epoch - 48ms/step
Epoch 11/50
384/384 - 19s - loss: 3.2324 - accuracy200: 0.4063 - val_loss: 3.4346 - val_accuracy200: 0.3412 - 19s/epoch - 49ms/step
Epoch 12/50
384/384 - 19s - loss: 3.2255 - accuracy200: 0.4107 - val_loss: 3.4254 - val_accuracy200: 0.3398 - 19s/epoch - 49ms/step
Epoch 13/50
384/384 - 19s - loss: 3.2198 - accuracy200: 0.4134 - val_loss: 3.4503 - val_accuracy200: 0.3438 - 19s/epoch - 48ms/step
Epoch 14/50
384/384 - 19s - loss: 3.2055 - accuracy200: 0.4209 - val_loss: 3.4447 - val_accuracy200: 0.3424 - 19s/epoch - 49ms/step
testing model: results/CHTR/W1/deepLOB_L2/h200
Evaluating performance on  test set...
1304/1304 - 26s - 26s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1726285
{'0': {'precision': 0.31899600943225104, 'recall': 0.12502110492033447, 'f1-score': 0.1796382719280885, 'support': 112533}, '1': {'precision': 0.31718788262917563, 'recall': 0.8245073718698807, 'f1-score': 0.4581323193995459, 'support': 106825}, '2': {'precision': 0.35003764745252236, 'recall': 0.036578862243515205, 'f1-score': 0.06623606889564336, 'support': 114383}, 'accuracy': 0.31860334810526725, 'macro avg': {'precision': 0.32874051317131636, 'recall': 0.3287024463445768, 'f1-score': 0.23466888674109257, 'support': 333741}, 'weighted avg': {'precision': 0.3290561534838784, 'recall': 0.31860334810526725, 'f1-score': 0.22991331284807812, 'support': 333741}}
[[14069 94399  4065]
 [15043 88078  3704]
 [14992 95207  4184]]
Evaluating performance on  train set...
384/384 - 8s - 8s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1409397
{'0': {'precision': 0.3367136978248089, 'recall': 0.35118646146299587, 'f1-score': 0.3437978330682193, 'support': 32618}, '1': {'precision': 0.3365407064002935, 'recall': 0.6217573479573603, 'f1-score': 0.4367047520124642, 'support': 32458}, '2': {'precision': 0.36666666666666664, 'recall': 0.04709074464877902, 'f1-score': 0.0834624632647609, 'support': 33170}, 'accuracy': 0.3379068867943733, 'macro avg': {'precision': 0.346640356963923, 'recall': 0.340011518023045, 'f1-score': 0.28798834944848145, 'support': 98246}, 'weighted avg': {'precision': 0.34676932371112995, 'recall': 0.3379068867943733, 'f1-score': 0.28659701632974227, 'support': 98246}}
[[11455 19873  1290]
 [10869 20181  1408]
 [11696 19912  1562]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1372125
{'0': {'precision': 0.32588026329537145, 'recall': 0.42961432506887054, 'f1-score': 0.3706256312756224, 'support': 7260}, '1': {'precision': 0.3570040364777994, 'recall': 0.5882497844562138, 'f1-score': 0.44434107084709495, 'support': 8119}, '2': {'precision': 0.3297709923664122, 'recall': 0.026261398176291792, 'f1-score': 0.048648648648648644, 'support': 8225}, 'accuracy': 0.343628198610405, 'macro avg': {'precision': 0.3375517640465277, 'recall': 0.34804183590045873, 'f1-score': 0.28787178359045534, 'support': 23604}, 'weighted avg': {'precision': 0.33794157328848456, 'recall': 0.343628198610405, 'f1-score': 0.28378589952566163, 'support': 23604}}
[[3119 3959  182]
 [3086 4776  257]
 [3366 4643  216]]
training model: results/CHTR/W1/deepLOB_L2/h300
Epoch 1/50
384/384 - 21s - loss: 3.3417 - accuracy300: 0.3497 - val_loss: 3.5401 - val_accuracy300: 0.3281 - 21s/epoch - 54ms/step
Epoch 2/50
384/384 - 19s - loss: 3.3138 - accuracy300: 0.3560 - val_loss: 3.4278 - val_accuracy300: 0.3194 - 19s/epoch - 49ms/step
Epoch 3/50
384/384 - 19s - loss: 3.2970 - accuracy300: 0.3602 - val_loss: 3.4659 - val_accuracy300: 0.3220 - 19s/epoch - 48ms/step
Epoch 4/50
384/384 - 18s - loss: 3.2872 - accuracy300: 0.3671 - val_loss: 3.4014 - val_accuracy300: 0.3533 - 18s/epoch - 47ms/step
Epoch 5/50
384/384 - 18s - loss: 3.2824 - accuracy300: 0.3714 - val_loss: 3.4426 - val_accuracy300: 0.3371 - 18s/epoch - 47ms/step
Epoch 6/50
384/384 - 17s - loss: 3.2701 - accuracy300: 0.3799 - val_loss: 3.5632 - val_accuracy300: 0.3254 - 17s/epoch - 45ms/step
Epoch 7/50
384/384 - 17s - loss: 3.2591 - accuracy300: 0.3876 - val_loss: 3.6172 - val_accuracy300: 0.3277 - 17s/epoch - 45ms/step
Epoch 8/50
384/384 - 18s - loss: 3.2470 - accuracy300: 0.3953 - val_loss: 3.5796 - val_accuracy300: 0.3112 - 18s/epoch - 46ms/step
Epoch 9/50
384/384 - 18s - loss: 3.2393 - accuracy300: 0.4010 - val_loss: 3.5622 - val_accuracy300: 0.3165 - 18s/epoch - 47ms/step
Epoch 10/50
384/384 - 18s - loss: 3.2266 - accuracy300: 0.4128 - val_loss: 3.4635 - val_accuracy300: 0.3161 - 18s/epoch - 47ms/step
Epoch 11/50
384/384 - 18s - loss: 3.2190 - accuracy300: 0.4159 - val_loss: 3.4442 - val_accuracy300: 0.3199 - 18s/epoch - 47ms/step
Epoch 12/50
384/384 - 18s - loss: 3.2092 - accuracy300: 0.4228 - val_loss: 3.4467 - val_accuracy300: 0.3241 - 18s/epoch - 48ms/step
Epoch 13/50
384/384 - 19s - loss: 3.2009 - accuracy300: 0.4245 - val_loss: 3.4119 - val_accuracy300: 0.3187 - 19s/epoch - 48ms/step
Epoch 14/50
384/384 - 18s - loss: 3.1931 - accuracy300: 0.4289 - val_loss: 3.4764 - val_accuracy300: 0.3244 - 18s/epoch - 48ms/step
testing model: results/CHTR/W1/deepLOB_L2/h300
Evaluating performance on  test set...
1304/1304 - 26s - 26s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1597415
{'0': {'precision': 0.34283615970089465, 'recall': 0.09251168782034537, 'f1-score': 0.1457057934723237, 'support': 111013}, '1': {'precision': 0.32615333683176195, 'recall': 0.8534814063868025, 'f1-score': 0.4719525433057623, 'support': 108505}, '2': {'precision': 0.33408907698508666, 'recall': 0.058053106642269946, 'f1-score': 0.09891773761663597, 'support': 114223}, 'accuracy': 0.3281227059306468, 'macro avg': {'precision': 0.3343595245059144, 'recall': 0.3346820669498059, 'f1-score': 0.23885869146490735, 'support': 333741}, 'weighted avg': {'precision': 0.33441859121376544, 'recall': 0.3281227059306468, 'f1-score': 0.23576105035317754, 'support': 333741}}
[[10270 94125  6618]
 [ 9299 92607  6599]
 [10387 97205  6631]]
Evaluating performance on  train set...
384/384 - 8s - 8s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1517531
{'0': {'precision': 0.32879330943847074, 'recall': 0.17006550488196762, 'f1-score': 0.22417725643532097, 'support': 32364}, '1': {'precision': 0.3307579054344569, 'recall': 0.7810115678070392, 'f1-score': 0.4647109972083658, 'support': 32504}, '2': {'precision': 0.35562565720294426, 'recall': 0.05066211276888969, 'f1-score': 0.08868958644743398, 'support': 33378}, 'accuracy': 0.3316267328949779, 'macro avg': {'precision': 0.33839229069195725, 'recall': 0.33391306181929886, 'f1-score': 0.2591926133637069, 'support': 98246}, 'weighted avg': {'precision': 0.338559277843659, 'recall': 0.3316267328949779, 'f1-score': 0.25772570890393404, 'support': 98246}}
[[ 5504 25383  1477]
 [ 5531 25386  1587]
 [ 5705 25982  1691]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1382381
{'0': {'precision': 0.2898217366302473, 'recall': 0.14457831325301204, 'f1-score': 0.19291866028708135, 'support': 6972}, '1': {'precision': 0.3573664385378535, 'recall': 0.8007608178792202, 'f1-score': 0.49418583324162724, 'support': 8412}, '2': {'precision': 0.3727486296006265, 'recall': 0.057907542579075426, 'f1-score': 0.10024218174160261, 'support': 8220}, 'accuracy': 0.3482460599898322, 'macro avg': {'precision': 0.33997893492290904, 'recall': 0.33441555790376926, 'f1-score': 0.2624488917567704, 'support': 23604}, 'weighted avg': {'precision': 0.3427722997832426, 'recall': 0.3482460599898322, 'f1-score': 0.2680101195842261, 'support': 23604}}
[[1008 5638  326]
 [1201 6736  475]
 [1269 6475  476]]
training model: results/CHTR/W1/deepLOB_L2/h500
Epoch 1/50
384/384 - 21s - loss: 3.3430 - accuracy500: 0.3459 - val_loss: 3.5423 - val_accuracy500: 0.3410 - 21s/epoch - 55ms/step
Epoch 2/50
384/384 - 18s - loss: 3.3053 - accuracy500: 0.3617 - val_loss: 3.5096 - val_accuracy500: 0.3294 - 18s/epoch - 48ms/step
Epoch 3/50
384/384 - 18s - loss: 3.2900 - accuracy500: 0.3715 - val_loss: 3.6351 - val_accuracy500: 0.3463 - 18s/epoch - 47ms/step
Epoch 4/50
384/384 - 19s - loss: 3.2673 - accuracy500: 0.3847 - val_loss: 3.5488 - val_accuracy500: 0.3289 - 19s/epoch - 49ms/step
Epoch 5/50
384/384 - 18s - loss: 3.2513 - accuracy500: 0.3971 - val_loss: 3.5077 - val_accuracy500: 0.3189 - 18s/epoch - 48ms/step
Epoch 6/50
384/384 - 18s - loss: 3.2451 - accuracy500: 0.4008 - val_loss: 3.5321 - val_accuracy500: 0.3187 - 18s/epoch - 48ms/step
Epoch 7/50
384/384 - 18s - loss: 3.2233 - accuracy500: 0.4112 - val_loss: 3.5220 - val_accuracy500: 0.3201 - 18s/epoch - 47ms/step
Epoch 8/50
384/384 - 18s - loss: 3.2102 - accuracy500: 0.4207 - val_loss: 3.5022 - val_accuracy500: 0.3230 - 18s/epoch - 48ms/step
Epoch 9/50
384/384 - 18s - loss: 3.2016 - accuracy500: 0.4243 - val_loss: 3.4811 - val_accuracy500: 0.3285 - 18s/epoch - 48ms/step
Epoch 10/50
384/384 - 18s - loss: 3.1908 - accuracy500: 0.4306 - val_loss: 3.6387 - val_accuracy500: 0.3058 - 18s/epoch - 47ms/step
Epoch 11/50
384/384 - 18s - loss: 3.1803 - accuracy500: 0.4310 - val_loss: 3.5359 - val_accuracy500: 0.3133 - 18s/epoch - 48ms/step
Epoch 12/50
384/384 - 18s - loss: 3.1677 - accuracy500: 0.4386 - val_loss: 3.5832 - val_accuracy500: 0.3194 - 18s/epoch - 48ms/step
Epoch 13/50
384/384 - 18s - loss: 3.1625 - accuracy500: 0.4371 - val_loss: 3.6831 - val_accuracy500: 0.3236 - 18s/epoch - 48ms/step
Epoch 14/50
384/384 - 18s - loss: 3.1558 - accuracy500: 0.4443 - val_loss: 3.6803 - val_accuracy500: 0.3124 - 18s/epoch - 48ms/step
Epoch 15/50
384/384 - 18s - loss: 3.1315 - accuracy500: 0.4513 - val_loss: 3.6535 - val_accuracy500: 0.3144 - 18s/epoch - 48ms/step
Epoch 16/50
384/384 - 18s - loss: 3.1201 - accuracy500: 0.4562 - val_loss: 3.6713 - val_accuracy500: 0.3140 - 18s/epoch - 48ms/step
Epoch 17/50
384/384 - 19s - loss: 3.1014 - accuracy500: 0.4633 - val_loss: 3.5984 - val_accuracy500: 0.3231 - 19s/epoch - 49ms/step
Epoch 18/50
384/384 - 19s - loss: 3.0904 - accuracy500: 0.4664 - val_loss: 3.6596 - val_accuracy500: 0.3121 - 19s/epoch - 48ms/step
Epoch 19/50
384/384 - 18s - loss: 3.0790 - accuracy500: 0.4702 - val_loss: 3.6567 - val_accuracy500: 0.3224 - 18s/epoch - 48ms/step
testing model: results/CHTR/W1/deepLOB_L2/h500
Evaluating performance on  test set...
1304/1304 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1740069
{'0': {'precision': 0.3431048189387195, 'recall': 0.6277708581930302, 'f1-score': 0.44370502157733055, 'support': 114811}, '1': {'precision': 0.31118938209978775, 'recall': 0.2581887500846695, 'f1-score': 0.2822222809847423, 'support': 103343}, '2': {'precision': 0.3462775492987451, 'recall': 0.11363734676044884, 'f1-score': 0.17111888430747985, 'support': 115587}, 'accuracy': 0.3352659697190336, 'macro avg': {'precision': 0.33352391677908416, 'recall': 0.33319898501271616, 'f1-score': 0.29901539562318424, 'support': 333741}, 'weighted avg': {'precision': 0.3343210296975971, 'recall': 0.3352659697190336, 'f1-score': 0.2992950608303139, 'support': 333741}}
[[72075 29891 12845]
 [64709 26682 11952]
 [73283 29169 13135]]
Evaluating performance on  train set...
384/384 - 8s - 8s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1658876
{'0': {'precision': 0.32932131252574254, 'recall': 0.6720627607247369, 'f1-score': 0.4420373688251855, 'support': 32122}, '1': {'precision': 0.3426337492636427, 'recall': 0.19717094517550618, 'f1-score': 0.25030319627557607, 'support': 32449}, '2': {'precision': 0.36269614835948644, 'recall': 0.1510022271714922, 'f1-score': 0.21322989831219205, 'support': 33675}, 'accuracy': 0.33661421330130487, 'macro avg': {'precision': 0.3448837367162905, 'recall': 0.34007864435724505, 'f1-score': 0.3018568211376512, 'support': 98246}, 'weighted avg': {'precision': 0.3451578133136571, 'recall': 0.33661421330130487, 'f1-score': 0.30028428234240423, 'support': 98246}}
[[21588  6089  4445]
 [21561  6398  4490]
 [22404  6186  5085]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1647052
{'0': {'precision': 0.3038476046774802, 'recall': 0.6877757222143162, 'f1-score': 0.4214886844285527, 'support': 7027}, '1': {'precision': 0.404830224772836, 'recall': 0.20140375921960504, 'f1-score': 0.2689863361931999, 'support': 8406}, '2': {'precision': 0.3492605233219568, 'recall': 0.15028760249663445, 'f1-score': 0.21014802772311117, 'support': 8171}, 'accuracy': 0.3285036434502627, 'macro avg': {'precision': 0.35264611759075765, 'recall': 0.34648902797685194, 'f1-score': 0.30020768278162124, 'support': 23604}, 'weighted avg': {'precision': 0.3555307457876979, 'recall': 0.3285036434502627, 'f1-score': 0.294018796053424, 'support': 23604}}
[[4833 1154 1040]
 [5465 1693 1248]
 [5608 1335 1228]]
training model: results/CHTR/W1/deepLOB_L2/h1000
Epoch 1/50
384/384 - 21s - loss: 3.3281 - accuracy1000: 0.3606 - val_loss: 3.6956 - val_accuracy1000: 0.3482 - 21s/epoch - 55ms/step
Epoch 2/50
384/384 - 18s - loss: 3.2872 - accuracy1000: 0.3810 - val_loss: 3.4278 - val_accuracy1000: 0.3619 - 18s/epoch - 48ms/step
Epoch 3/50
384/384 - 18s - loss: 3.2560 - accuracy1000: 0.3982 - val_loss: 3.4967 - val_accuracy1000: 0.2992 - 18s/epoch - 48ms/step
Epoch 4/50
384/384 - 18s - loss: 3.2199 - accuracy1000: 0.4085 - val_loss: 3.5975 - val_accuracy1000: 0.3099 - 18s/epoch - 47ms/step
Epoch 5/50
384/384 - 18s - loss: 3.1971 - accuracy1000: 0.4191 - val_loss: 3.6283 - val_accuracy1000: 0.2951 - 18s/epoch - 47ms/step
Epoch 6/50
384/384 - 18s - loss: 3.1787 - accuracy1000: 0.4272 - val_loss: 3.7816 - val_accuracy1000: 0.2880 - 18s/epoch - 48ms/step
Epoch 7/50
384/384 - 18s - loss: 3.1591 - accuracy1000: 0.4343 - val_loss: 3.6978 - val_accuracy1000: 0.2843 - 18s/epoch - 48ms/step
Epoch 8/50
384/384 - 18s - loss: 3.1411 - accuracy1000: 0.4432 - val_loss: 3.8492 - val_accuracy1000: 0.2822 - 18s/epoch - 48ms/step
Epoch 9/50
384/384 - 18s - loss: 3.1258 - accuracy1000: 0.4457 - val_loss: 3.8019 - val_accuracy1000: 0.2849 - 18s/epoch - 47ms/step
Epoch 10/50
384/384 - 18s - loss: 3.1076 - accuracy1000: 0.4509 - val_loss: 4.0221 - val_accuracy1000: 0.2835 - 18s/epoch - 48ms/step
Epoch 11/50
384/384 - 18s - loss: 3.1043 - accuracy1000: 0.4568 - val_loss: 3.9337 - val_accuracy1000: 0.2805 - 18s/epoch - 48ms/step
Epoch 12/50
384/384 - 18s - loss: 3.0897 - accuracy1000: 0.4598 - val_loss: 3.9411 - val_accuracy1000: 0.2799 - 18s/epoch - 48ms/step
testing model: results/CHTR/W1/deepLOB_L2/h1000
Evaluating performance on  test set...
1304/1304 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1673957
{'0': {'precision': 0.33676139634688856, 'recall': 0.11346023293335566, 'f1-score': 0.16973429967620038, 'support': 113423}, '1': {'precision': 0.30978200338183326, 'recall': 0.5974652398062803, 'f1-score': 0.4080122156950344, 'support': 102416}, '2': {'precision': 0.35619024295670454, 'recall': 0.29606792081559263, 'f1-score': 0.32335817473587675, 'support': 117902}, 'accuracy': 0.3264986920995622, 'macro avg': {'precision': 0.33424454756180877, 'recall': 0.3356644645184095, 'f1-score': 0.30036823003570384, 'support': 333741}, 'weighted avg': {'precision': 0.33534586263386384, 'recall': 0.3264986920995622, 'f1-score': 0.29712659838768885, 'support': 333741}}
[[12869 66518 34036]
 [12168 61190 29058]
 [13177 69818 34907]]
Evaluating performance on  train set...
384/384 - 8s - 8s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1639308
{'0': {'precision': 0.329449483891148, 'recall': 0.2613442511088366, 'f1-score': 0.29147136655308997, 'support': 32241}, '1': {'precision': 0.33213474640423923, 'recall': 0.5403158769742311, 'f1-score': 0.41138758336165776, 'support': 32481}, '2': {'precision': 0.3631366616238023, 'recall': 0.21480133635604343, 'f1-score': 0.26993290100086215, 'support': 33524}, 'accuracy': 0.33769313763410214, 'macro avg': {'precision': 0.34157363063972984, 'recall': 0.3388204881463704, 'f1-score': 0.32426395030520333, 'support': 98246}, 'weighted avg': {'precision': 0.3418321657102268, 'recall': 0.33769313763410214, 'f1-score': 0.32376726785173016, 'support': 98246}}
[[ 8426 17383  6432]
 [ 8734 17550  6197]
 [ 8416 17907  7201]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1408441
{'0': {'precision': 0.3001915375239422, 'recall': 0.26413359889688987, 'f1-score': 0.28101059494702524, 'support': 6527}, '1': {'precision': 0.394852770693253, 'recall': 0.5711570709893795, 'f1-score': 0.4669164686528971, 'support': 8945}, '2': {'precision': 0.37017472572125154, 'recall': 0.22405312346286277, 'f1-score': 0.2791481538225831, 'support': 8132}, 'accuracy': 0.3666751398068124, 'macro avg': {'precision': 0.35507301131281555, 'recall': 0.3531145977830441, 'f1-score': 0.3423584058075018, 'support': 23604}, 'weighted avg': {'precision': 0.3601749308945575, 'recall': 0.3666751398068124, 'f1-score': 0.3508200623709814, 'support': 23604}}
[[1724 3579 1224]
 [1960 5109 1876]
 [2059 4251 1822]]
training model: results/CHTR/W1/deepOF_L2/h10
Epoch 1/50
384/384 - 14s - loss: 3.3217 - accuracy10: 0.3571 - val_loss: 3.2869 - val_accuracy10: 0.3743 - 14s/epoch - 37ms/step
Epoch 2/50
384/384 - 12s - loss: 3.2690 - accuracy10: 0.3867 - val_loss: 3.2611 - val_accuracy10: 0.3931 - 12s/epoch - 31ms/step
Epoch 3/50
384/384 - 12s - loss: 3.2405 - accuracy10: 0.4054 - val_loss: 3.2600 - val_accuracy10: 0.3910 - 12s/epoch - 32ms/step
Epoch 4/50
384/384 - 12s - loss: 3.2172 - accuracy10: 0.4179 - val_loss: 3.2467 - val_accuracy10: 0.4034 - 12s/epoch - 33ms/step
Epoch 5/50
384/384 - 12s - loss: 3.2008 - accuracy10: 0.4254 - val_loss: 3.2381 - val_accuracy10: 0.4065 - 12s/epoch - 32ms/step
Epoch 6/50
384/384 - 12s - loss: 3.1881 - accuracy10: 0.4317 - val_loss: 3.2365 - val_accuracy10: 0.4053 - 12s/epoch - 31ms/step
Epoch 7/50
384/384 - 12s - loss: 3.1771 - accuracy10: 0.4360 - val_loss: 3.2303 - val_accuracy10: 0.4115 - 12s/epoch - 32ms/step
Epoch 8/50
384/384 - 12s - loss: 3.1674 - accuracy10: 0.4397 - val_loss: 3.2260 - val_accuracy10: 0.4107 - 12s/epoch - 31ms/step
Epoch 9/50
384/384 - 12s - loss: 3.1579 - accuracy10: 0.4437 - val_loss: 3.2288 - val_accuracy10: 0.4127 - 12s/epoch - 32ms/step
Epoch 10/50
384/384 - 12s - loss: 3.1495 - accuracy10: 0.4465 - val_loss: 3.2263 - val_accuracy10: 0.4148 - 12s/epoch - 31ms/step
Epoch 11/50
384/384 - 12s - loss: 3.1391 - accuracy10: 0.4499 - val_loss: 3.2273 - val_accuracy10: 0.4152 - 12s/epoch - 32ms/step
Epoch 12/50
384/384 - 12s - loss: 3.1319 - accuracy10: 0.4538 - val_loss: 3.2275 - val_accuracy10: 0.4143 - 12s/epoch - 32ms/step
Epoch 13/50
384/384 - 12s - loss: 3.1213 - accuracy10: 0.4589 - val_loss: 3.2323 - val_accuracy10: 0.4134 - 12s/epoch - 32ms/step
Epoch 14/50
384/384 - 12s - loss: 3.1149 - accuracy10: 0.4610 - val_loss: 3.2269 - val_accuracy10: 0.4193 - 12s/epoch - 32ms/step
Epoch 15/50
384/384 - 12s - loss: 3.1043 - accuracy10: 0.4640 - val_loss: 3.2377 - val_accuracy10: 0.4147 - 12s/epoch - 31ms/step
Epoch 16/50
384/384 - 12s - loss: 3.0956 - accuracy10: 0.4670 - val_loss: 3.2406 - val_accuracy10: 0.4138 - 12s/epoch - 31ms/step
Epoch 17/50
384/384 - 12s - loss: 3.0877 - accuracy10: 0.4702 - val_loss: 3.2470 - val_accuracy10: 0.4127 - 12s/epoch - 31ms/step
Epoch 18/50
384/384 - 12s - loss: 3.0774 - accuracy10: 0.4759 - val_loss: 3.2467 - val_accuracy10: 0.4170 - 12s/epoch - 30ms/step
testing model: results/CHTR/W1/deepOF_L2/h10
Evaluating performance on  test set...
1304/1304 - 21s - 21s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0613265
{'0': {'precision': 0.43802381282693675, 'recall': 0.45867835687611624, 'f1-score': 0.4481132075471698, 'support': 117021}, '1': {'precision': 0.40940276785956414, 'recall': 0.4365565901335955, 'f1-score': 0.4225438837913357, 'support': 103746}, '2': {'precision': 0.4472009545590136, 'recall': 0.39811806778850833, 'f1-score': 0.4212345285872838, 'support': 112969}, 'accuracy': 0.43130198719946305, 'macro avg': {'precision': 0.43154251174850483, 'recall': 0.4311176715994067, 'f1-score': 0.43063053997526307, 'support': 333736}, 'weighted avg': {'precision': 0.43223304884925967, 'recall': 0.43130198719946305, 'f1-score': 0.4310662825951354, 'support': 333736}}
[[53675 32551 30795]
 [33655 45291 24800]
 [35209 32785 44975]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0525728
{'0': {'precision': 0.44480734881347284, 'recall': 0.5140363293229535, 'f1-score': 0.47692265601488326, 'support': 33912}, '1': {'precision': 0.43596840403035203, 'recall': 0.4335147504483889, 'f1-score': 0.43473811517350447, 'support': 32338}, '2': {'precision': 0.4526934086769025, 'recall': 0.38059071729957805, 'f1-score': 0.4135225999252895, 'support': 31995}, 'accuracy': 0.4440734897450252, 'macro avg': {'precision': 0.44448972050690916, 'recall': 0.4427139323569735, 'f1-score': 0.4417277903712257, 'support': 98245}, 'weighted avg': {'precision': 0.4444661679791695, 'recall': 0.4440734897450252, 'f1-score': 0.4423901253383597, 'support': 98245}}
[[17432  8775  7705]
 [11302 14019  7017]
 [10456  9362 12177]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.074544
{'0': {'precision': 0.4077689243027888, 'recall': 0.507436787307883, 'f1-score': 0.4521758338855755, 'support': 8068}, '1': {'precision': 0.38039555363072036, 'recall': 0.35953063173693545, 'f1-score': 0.36966891133557805, 'support': 7329}, '2': {'precision': 0.449299382251017, 'recall': 0.3633483611551115, 'f1-score': 0.4017784963621665, 'support': 8207}, 'accuracy': 0.4114133197763091, 'macro avg': {'precision': 0.41248795339484207, 'recall': 0.41010526006664333, 'f1-score': 0.4078744138611066, 'support': 23604}, 'weighted avg': {'precision': 0.4137094866958374, 'recall': 0.4114133197763091, 'f1-score': 0.4090346635575146, 'support': 23604}}
[[4094 1997 1977]
 [3016 2635 1678]
 [2930 2295 2982]]
training model: results/CHTR/W1/deepOF_L2/h20
Epoch 1/50
384/384 - 15s - loss: 3.3282 - accuracy20: 0.3522 - val_loss: 3.2954 - val_accuracy20: 0.3686 - 15s/epoch - 39ms/step
Epoch 2/50
384/384 - 13s - loss: 3.2802 - accuracy20: 0.3793 - val_loss: 3.2812 - val_accuracy20: 0.3779 - 13s/epoch - 34ms/step
Epoch 3/50
384/384 - 12s - loss: 3.2567 - accuracy20: 0.3935 - val_loss: 3.2758 - val_accuracy20: 0.3865 - 12s/epoch - 30ms/step
Epoch 4/50
384/384 - 12s - loss: 3.2391 - accuracy20: 0.4043 - val_loss: 3.2764 - val_accuracy20: 0.3865 - 12s/epoch - 30ms/step
Epoch 5/50
384/384 - 11s - loss: 3.2263 - accuracy20: 0.4108 - val_loss: 3.2682 - val_accuracy20: 0.3934 - 11s/epoch - 29ms/step
Epoch 6/50
384/384 - 11s - loss: 3.2168 - accuracy20: 0.4158 - val_loss: 3.2674 - val_accuracy20: 0.3921 - 11s/epoch - 29ms/step
Epoch 7/50
384/384 - 11s - loss: 3.2079 - accuracy20: 0.4201 - val_loss: 3.2641 - val_accuracy20: 0.3974 - 11s/epoch - 29ms/step
Epoch 8/50
384/384 - 11s - loss: 3.2015 - accuracy20: 0.4234 - val_loss: 3.2641 - val_accuracy20: 0.3955 - 11s/epoch - 29ms/step
Epoch 9/50
384/384 - 11s - loss: 3.1915 - accuracy20: 0.4285 - val_loss: 3.2662 - val_accuracy20: 0.3986 - 11s/epoch - 29ms/step
Epoch 10/50
384/384 - 11s - loss: 3.1862 - accuracy20: 0.4306 - val_loss: 3.2658 - val_accuracy20: 0.3968 - 11s/epoch - 29ms/step
Epoch 11/50
384/384 - 11s - loss: 3.1773 - accuracy20: 0.4351 - val_loss: 3.2673 - val_accuracy20: 0.3975 - 11s/epoch - 30ms/step
Epoch 12/50
384/384 - 12s - loss: 3.1690 - accuracy20: 0.4380 - val_loss: 3.2740 - val_accuracy20: 0.3997 - 12s/epoch - 31ms/step
Epoch 13/50
384/384 - 12s - loss: 3.1632 - accuracy20: 0.4413 - val_loss: 3.2743 - val_accuracy20: 0.4002 - 12s/epoch - 31ms/step
Epoch 14/50
384/384 - 12s - loss: 3.1563 - accuracy20: 0.4440 - val_loss: 3.2727 - val_accuracy20: 0.4033 - 12s/epoch - 31ms/step
Epoch 15/50
384/384 - 12s - loss: 3.1485 - accuracy20: 0.4481 - val_loss: 3.2734 - val_accuracy20: 0.4037 - 12s/epoch - 31ms/step
Epoch 16/50
384/384 - 12s - loss: 3.1412 - accuracy20: 0.4513 - val_loss: 3.2776 - val_accuracy20: 0.4007 - 12s/epoch - 31ms/step
Epoch 17/50
384/384 - 12s - loss: 3.1319 - accuracy20: 0.4551 - val_loss: 3.2833 - val_accuracy20: 0.4043 - 12s/epoch - 31ms/step
Epoch 18/50
384/384 - 12s - loss: 3.1240 - accuracy20: 0.4584 - val_loss: 3.2842 - val_accuracy20: 0.4046 - 12s/epoch - 31ms/step
testing model: results/CHTR/W1/deepOF_L2/h20
Evaluating performance on  test set...
1304/1304 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0752989
{'0': {'precision': 0.4164994218423956, 'recall': 0.5409132885118282, 'f1-score': 0.47062268861814566, 'support': 115867}, '1': {'precision': 0.40071469636677226, 'recall': 0.3326595356410904, 'f1-score': 0.36352944785903485, 'support': 106857}, '2': {'precision': 0.4271859036055379, 'recall': 0.36383454041004576, 'f1-score': 0.3929733752997894, 'support': 111012}, 'accuracy': 0.4153312798139847, 'macro avg': {'precision': 0.41480000727156857, 'recall': 0.41246912152098814, 'f1-score': 0.4090418372589899, 'support': 333736}, 'weighted avg': {'precision': 0.41500009094414453, 'recall': 0.4153312798139847, 'f1-score': 0.4105043076286998, 'support': 333736}}
[[62674 25338 27855]
 [45006 35547 26304]
 [42798 27824 40390]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0648217
{'0': {'precision': 0.42475209437510686, 'recall': 0.5889237880763305, 'f1-score': 0.49354358082940153, 'support': 33748}, '1': {'precision': 0.43345359394203703, 'recall': 0.3354607100119665, 'f1-score': 0.3782128896115127, 'support': 32591}, '2': {'precision': 0.43438810522302707, 'recall': 0.3571115150755344, 'f1-score': 0.39197743222787945, 'support': 31906}, 'accuracy': 0.4295587561707975, 'macro avg': {'precision': 0.43086459784672365, 'recall': 0.4271653377212771, 'f1-score': 0.42124463422293124, 'support': 98245}, 'weighted avg': {'precision': 0.4307680456652444, 'recall': 0.4295587561707975, 'f1-score': 0.4223001374504777, 'support': 98245}}
[[19875  6606  7267]
 [14089 10933  7569]
 [12828  7684 11394]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0864431
{'0': {'precision': 0.39158226797277107, 'recall': 0.5844381117581464, 'f1-score': 0.46895660386737587, 'support': 8071}, '1': {'precision': 0.3677966101694915, 'recall': 0.26342055570542217, 'f1-score': 0.3069789374410562, 'support': 7414}, '2': {'precision': 0.4361395646606914, 'recall': 0.3356324670525927, 'f1-score': 0.37934154659984687, 'support': 8119}, 'accuracy': 0.39802575834604303, 'macro avg': {'precision': 0.39850614760098463, 'recall': 0.39449704483872045, 'f1-score': 0.385092362636093, 'support': 23604}, 'weighted avg': {'precision': 0.3994374545875698, 'recall': 0.39802575834604303, 'f1-score': 0.3872548978497601, 'support': 23604}}
[[4717 1565 1789]
 [3727 1953 1734]
 [3602 1792 2725]]
training model: results/CHTR/W1/deepOF_L2/h30
Epoch 1/50
384/384 - 15s - loss: 3.3284 - accuracy30: 0.3510 - val_loss: 3.2972 - val_accuracy30: 0.3629 - 15s/epoch - 40ms/step
Epoch 2/50
384/384 - 12s - loss: 3.2849 - accuracy30: 0.3756 - val_loss: 3.2858 - val_accuracy30: 0.3745 - 12s/epoch - 31ms/step
Epoch 3/50
384/384 - 12s - loss: 3.2626 - accuracy30: 0.3922 - val_loss: 3.2850 - val_accuracy30: 0.3801 - 12s/epoch - 32ms/step
Epoch 4/50
384/384 - 12s - loss: 3.2467 - accuracy30: 0.4014 - val_loss: 3.2861 - val_accuracy30: 0.3839 - 12s/epoch - 32ms/step
Epoch 5/50
384/384 - 12s - loss: 3.2361 - accuracy30: 0.4077 - val_loss: 3.2779 - val_accuracy30: 0.3876 - 12s/epoch - 31ms/step
Epoch 6/50
384/384 - 12s - loss: 3.2273 - accuracy30: 0.4110 - val_loss: 3.2805 - val_accuracy30: 0.3862 - 12s/epoch - 31ms/step
Epoch 7/50
384/384 - 12s - loss: 3.2206 - accuracy30: 0.4138 - val_loss: 3.2794 - val_accuracy30: 0.3868 - 12s/epoch - 30ms/step
Epoch 8/50
384/384 - 12s - loss: 3.2129 - accuracy30: 0.4195 - val_loss: 3.2802 - val_accuracy30: 0.3886 - 12s/epoch - 31ms/step
Epoch 9/50
384/384 - 12s - loss: 3.2066 - accuracy30: 0.4225 - val_loss: 3.2803 - val_accuracy30: 0.3914 - 12s/epoch - 31ms/step
Epoch 10/50
384/384 - 12s - loss: 3.1986 - accuracy30: 0.4276 - val_loss: 3.2875 - val_accuracy30: 0.3887 - 12s/epoch - 31ms/step
Epoch 11/50
384/384 - 12s - loss: 3.1910 - accuracy30: 0.4287 - val_loss: 3.2858 - val_accuracy30: 0.3877 - 12s/epoch - 31ms/step
Epoch 12/50
384/384 - 12s - loss: 3.1824 - accuracy30: 0.4338 - val_loss: 3.2933 - val_accuracy30: 0.3877 - 12s/epoch - 31ms/step
Epoch 13/50
384/384 - 12s - loss: 3.1766 - accuracy30: 0.4365 - val_loss: 3.2965 - val_accuracy30: 0.3880 - 12s/epoch - 31ms/step
Epoch 14/50
384/384 - 12s - loss: 3.1688 - accuracy30: 0.4391 - val_loss: 3.2945 - val_accuracy30: 0.3937 - 12s/epoch - 31ms/step
Epoch 15/50
384/384 - 12s - loss: 3.1619 - accuracy30: 0.4436 - val_loss: 3.3097 - val_accuracy30: 0.3882 - 12s/epoch - 31ms/step
testing model: results/CHTR/W1/deepOF_L2/h30
Evaluating performance on  test set...
1304/1304 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0818169
{'0': {'precision': 0.4139237542482918, 'recall': 0.5036084254143647, 'f1-score': 0.4543829518769058, 'support': 115840}, '1': {'precision': 0.39276264301419894, 'recall': 0.2961557916034396, 'f1-score': 0.33768564059020495, 'support': 106758}, '2': {'precision': 0.41209104347361486, 'recall': 0.4163922330795947, 'f1-score': 0.414230473155624, 'support': 111138}, 'accuracy': 0.4082028909077834, 'macro avg': {'precision': 0.4062591469120352, 'recall': 0.4053854833657997, 'f1-score': 0.4020996885409116, 'support': 333736}, 'weighted avg': {'precision': 0.40654426350349554, 'recall': 0.4082028909077834, 'f1-score': 0.40368168579092345, 'support': 333736}}
[[58338 24193 33309]
 [42429 31617 32712]
 [40172 24689 46277]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0761408
{'0': {'precision': 0.41661057431332105, 'recall': 0.5684026543429316, 'f1-score': 0.48081091578855045, 'support': 33756}, '1': {'precision': 0.4106437369277248, 'recall': 0.27208894090111174, 'f1-score': 0.3273070796132331, 'support': 32471}, '2': {'precision': 0.40981255093724533, 'recall': 0.39262289961896435, 'f1-score': 0.40103360821782336, 'support': 32018}, 'accuracy': 0.4131813323833274, 'macro avg': {'precision': 0.41235562072609705, 'recall': 0.4110381649543358, 'f1-score': 0.40305053453986894, 'support': 98245}, 'weighted avg': {'precision': 0.4124229994830204, 'recall': 0.4131813323833274, 'f1-score': 0.4040769049152411, 'support': 98245}}
[[19187  6072  8497]
 [14029  8835  9607]
 [12839  6608 12571]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0912559
{'0': {'precision': 0.3876663254861822, 'recall': 0.5650174042764794, 'f1-score': 0.4598340752731688, 'support': 8044}, '1': {'precision': 0.35722136733347987, 'recall': 0.21689802455953017, 'f1-score': 0.2699111369487584, 'support': 7492}, '2': {'precision': 0.408675487655163, 'recall': 0.3713435795736242, 'f1-score': 0.3891161763750892, 'support': 8068}, 'accuracy': 0.388324012879173, 'macro avg': {'precision': 0.384521060158275, 'recall': 0.3844196694698779, 'f1-score': 0.3729537961990055, 'support': 23604}, 'weighted avg': {'precision': 0.3851840468003362, 'recall': 0.388324012879173, 'f1-score': 0.3753799716366585, 'support': 23604}}
[[4545 1346 2153]
 [3685 1625 2182]
 [3494 1578 2996]]
training model: results/CHTR/W1/deepOF_L2/h50
Epoch 1/50
384/384 - 14s - loss: 3.3343 - accuracy50: 0.3436 - val_loss: 3.3085 - val_accuracy50: 0.3543 - 14s/epoch - 36ms/step
Epoch 2/50
384/384 - 12s - loss: 3.2962 - accuracy50: 0.3660 - val_loss: 3.2957 - val_accuracy50: 0.3685 - 12s/epoch - 31ms/step
Epoch 3/50
384/384 - 12s - loss: 3.2778 - accuracy50: 0.3807 - val_loss: 3.2923 - val_accuracy50: 0.3676 - 12s/epoch - 32ms/step
Epoch 4/50
384/384 - 13s - loss: 3.2634 - accuracy50: 0.3908 - val_loss: 3.2953 - val_accuracy50: 0.3688 - 13s/epoch - 33ms/step
Epoch 5/50
384/384 - 12s - loss: 3.2546 - accuracy50: 0.3950 - val_loss: 3.2886 - val_accuracy50: 0.3768 - 12s/epoch - 32ms/step
Epoch 6/50
384/384 - 12s - loss: 3.2471 - accuracy50: 0.4005 - val_loss: 3.2929 - val_accuracy50: 0.3764 - 12s/epoch - 31ms/step
Epoch 7/50
384/384 - 12s - loss: 3.2408 - accuracy50: 0.4042 - val_loss: 3.2930 - val_accuracy50: 0.3794 - 12s/epoch - 31ms/step
Epoch 8/50
384/384 - 12s - loss: 3.2339 - accuracy50: 0.4103 - val_loss: 3.2919 - val_accuracy50: 0.3794 - 12s/epoch - 31ms/step
Epoch 9/50
384/384 - 12s - loss: 3.2269 - accuracy50: 0.4103 - val_loss: 3.2936 - val_accuracy50: 0.3807 - 12s/epoch - 31ms/step
Epoch 10/50
384/384 - 12s - loss: 3.2220 - accuracy50: 0.4158 - val_loss: 3.2989 - val_accuracy50: 0.3803 - 12s/epoch - 32ms/step
Epoch 11/50
384/384 - 12s - loss: 3.2127 - accuracy50: 0.4211 - val_loss: 3.3008 - val_accuracy50: 0.3789 - 12s/epoch - 31ms/step
Epoch 12/50
384/384 - 12s - loss: 3.2045 - accuracy50: 0.4244 - val_loss: 3.3053 - val_accuracy50: 0.3813 - 12s/epoch - 31ms/step
Epoch 13/50
384/384 - 12s - loss: 3.1986 - accuracy50: 0.4279 - val_loss: 3.3090 - val_accuracy50: 0.3812 - 12s/epoch - 31ms/step
Epoch 14/50
384/384 - 12s - loss: 3.1934 - accuracy50: 0.4303 - val_loss: 3.3094 - val_accuracy50: 0.3799 - 12s/epoch - 31ms/step
Epoch 15/50
384/384 - 12s - loss: 3.1840 - accuracy50: 0.4349 - val_loss: 3.3217 - val_accuracy50: 0.3801 - 12s/epoch - 32ms/step
testing model: results/CHTR/W1/deepOF_L2/h50
Evaluating performance on  test set...
1304/1304 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0856047
{'0': {'precision': 0.4011935640328125, 'recall': 0.4965115874451945, 'f1-score': 0.4437921583111405, 'support': 114952}, '1': {'precision': 0.3862151078184945, 'recall': 0.2737159894241407, 'f1-score': 0.3203766296475133, 'support': 106658}, '2': {'precision': 0.4072383352174176, 'recall': 0.4208836487522965, 'f1-score': 0.41394857220548315, 'support': 112126}, 'accuracy': 0.39989992089555815, 'macro avg': {'precision': 0.39821566902290817, 'recall': 0.39703707520721054, 'f1-score': 0.392705786721379, 'support': 333736}, 'weighted avg': {'precision': 0.39843750484512613, 'recall': 0.39989992089555815, 'f1-score': 0.3943234303588426, 'support': 333736}}
[[57075 23105 34772]
 [43545 29194 33919]
 [41643 23291 47192]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0820146
{'0': {'precision': 0.40551189672812765, 'recall': 0.5530714646239719, 'f1-score': 0.4679343866964757, 'support': 33681}, '1': {'precision': 0.3886766422583042, 'recall': 0.22955186461924162, 'f1-score': 0.2886358263062495, 'support': 31910}, '2': {'precision': 0.4015898631283247, 'recall': 0.4115269186010902, 'f1-score': 0.40649767076048154, 'support': 32654}, 'accuracy': 0.4009466130591888, 'macro avg': {'precision': 0.3985928007049188, 'recall': 0.39805008261476793, 'f1-score': 0.38768929458773554, 'support': 98245}, 'weighted avg': {'precision': 0.39874022330657916, 'recall': 0.4009466130591888, 'f1-score': 0.3892782557562134, 'support': 98245}}
[[18628  5555  9498]
 [14059  7325 10526]
 [13250  5966 13438]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0964185
{'0': {'precision': 0.37700971541569944, 'recall': 0.5432358771060456, 'f1-score': 0.4451098817438969, 'support': 8072}, '1': {'precision': 0.3399907106363214, 'recall': 0.19956379498364232, 'f1-score': 0.25150317814808454, 'support': 7336}, '2': {'precision': 0.40041737315768877, 'recall': 0.37457296242069305, 'f1-score': 0.38706423753388386, 'support': 8196}, 'accuracy': 0.3778596847991866, 'macro avg': {'precision': 0.3724725997365699, 'recall': 0.37245754483679366, 'f1-score': 0.36122576580862176, 'support': 23604}, 'weighted avg': {'precision': 0.3736322261677681, 'recall': 0.3778596847991866, 'f1-score': 0.36478278135734604, 'support': 23604}}
[[4385 1384 2303]
 [3578 1464 2294]
 [3668 1458 3070]]
training model: results/CHTR/W1/deepOF_L2/h100
Epoch 1/50
384/384 - 14s - loss: 3.3371 - accuracy100: 0.3407 - val_loss: 3.3185 - val_accuracy100: 0.3429 - 14s/epoch - 37ms/step
Epoch 2/50
384/384 - 12s - loss: 3.3027 - accuracy100: 0.3578 - val_loss: 3.3101 - val_accuracy100: 0.3471 - 12s/epoch - 32ms/step
Epoch 3/50
384/384 - 12s - loss: 3.2893 - accuracy100: 0.3667 - val_loss: 3.3066 - val_accuracy100: 0.3513 - 12s/epoch - 31ms/step
Epoch 4/50
384/384 - 12s - loss: 3.2810 - accuracy100: 0.3720 - val_loss: 3.3058 - val_accuracy100: 0.3568 - 12s/epoch - 31ms/step
Epoch 5/50
384/384 - 12s - loss: 3.2733 - accuracy100: 0.3785 - val_loss: 3.3020 - val_accuracy100: 0.3563 - 12s/epoch - 30ms/step
Epoch 6/50
384/384 - 12s - loss: 3.2676 - accuracy100: 0.3821 - val_loss: 3.3006 - val_accuracy100: 0.3589 - 12s/epoch - 31ms/step
Epoch 7/50
384/384 - 12s - loss: 3.2609 - accuracy100: 0.3879 - val_loss: 3.3036 - val_accuracy100: 0.3577 - 12s/epoch - 32ms/step
Epoch 8/50
384/384 - 12s - loss: 3.2566 - accuracy100: 0.3911 - val_loss: 3.3049 - val_accuracy100: 0.3604 - 12s/epoch - 31ms/step
Epoch 9/50
384/384 - 12s - loss: 3.2504 - accuracy100: 0.3935 - val_loss: 3.3061 - val_accuracy100: 0.3629 - 12s/epoch - 31ms/step
Epoch 10/50
384/384 - 12s - loss: 3.2452 - accuracy100: 0.3969 - val_loss: 3.3078 - val_accuracy100: 0.3617 - 12s/epoch - 31ms/step
Epoch 11/50
384/384 - 12s - loss: 3.2423 - accuracy100: 0.3989 - val_loss: 3.3108 - val_accuracy100: 0.3623 - 12s/epoch - 32ms/step
Epoch 12/50
384/384 - 12s - loss: 3.2350 - accuracy100: 0.4053 - val_loss: 3.3146 - val_accuracy100: 0.3605 - 12s/epoch - 31ms/step
Epoch 13/50
384/384 - 12s - loss: 3.2282 - accuracy100: 0.4092 - val_loss: 3.3141 - val_accuracy100: 0.3613 - 12s/epoch - 31ms/step
Epoch 14/50
384/384 - 12s - loss: 3.2239 - accuracy100: 0.4120 - val_loss: 3.3162 - val_accuracy100: 0.3596 - 12s/epoch - 31ms/step
Epoch 15/50
384/384 - 12s - loss: 3.2172 - accuracy100: 0.4157 - val_loss: 3.3222 - val_accuracy100: 0.3603 - 12s/epoch - 32ms/step
Epoch 16/50
384/384 - 12s - loss: 3.2128 - accuracy100: 0.4165 - val_loss: 3.3276 - val_accuracy100: 0.3589 - 12s/epoch - 31ms/step
testing model: results/CHTR/W1/deepOF_L2/h100
Evaluating performance on  test set...
1304/1304 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0918242
{'0': {'precision': 0.38107921677901396, 'recall': 0.49270627295846287, 'f1-score': 0.429762505343341, 'support': 113248}, '1': {'precision': 0.37714848780050836, 'recall': 0.31373535274502135, 'f1-score': 0.3425317163704777, 'support': 107358}, '2': {'precision': 0.3916925148967431, 'recall': 0.3393352779987625, 'f1-score': 0.36363894703937716, 'support': 113130}, 'accuracy': 0.3831441618524822, 'macro avg': {'precision': 0.3833067398254218, 'recall': 0.3819256345674156, 'f1-score': 0.37864438958439867, 'support': 333736}, 'weighted avg': {'precision': 0.3834124598645195, 'recall': 0.3831441618524822, 'f1-score': 0.37928703612972275, 'support': 333736}}
[[55798 27540 29910]
 [43967 33682 29709]
 [46656 28085 38389]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0877868
{'0': {'precision': 0.3839763592403546, 'recall': 0.5612747319136082, 'f1-score': 0.4559978403848042, 'support': 33105}, '1': {'precision': 0.37250482936252416, 'recall': 0.25193641708402026, 'f1-score': 0.30058082354469373, 'support': 32147}, '2': {'precision': 0.39420887877063177, 'recall': 0.33588943109144365, 'f1-score': 0.36271990835447177, 'support': 32993}, 'accuracy': 0.38436561657081786, 'macro avg': {'precision': 0.3835633557911702, 'recall': 0.3830335266963574, 'f1-score': 0.3730995240946566, 'support': 98245}, 'weighted avg': {'precision': 0.38365905297418146, 'recall': 0.38436561657081786, 'f1-score': 0.373818496379147, 'support': 98245}}
[[18581  6493  8031]
 [15049  8099  8999]
 [14761  7150 11082]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1003972
{'0': {'precision': 0.35607278882776133, 'recall': 0.5372924648786718, 'f1-score': 0.4283023670145075, 'support': 7830}, '1': {'precision': 0.34486034581037434, 'recall': 0.24093986459577857, 'f1-score': 0.28368240075023443, 'support': 7533}, '2': {'precision': 0.37250996015936255, 'recall': 0.2949884722727824, 'f1-score': 0.3292476467799824, 'support': 8241}, 'accuracy': 0.35811726825961704, 'macro avg': {'precision': 0.3578143649324994, 'recall': 0.35774026724907754, 'f1-score': 0.3470774715149081, 'support': 23604}, 'weighted avg': {'precision': 0.35823324450026384, 'recall': 0.35811726825961704, 'f1-score': 0.3475646888531158, 'support': 23604}}
[[4207 1674 1949]
 [3572 1815 2146]
 [4036 1774 2431]]
training model: results/CHTR/W1/deepOF_L2/h200
Epoch 1/50
384/384 - 14s - loss: 3.3416 - accuracy200: 0.3386 - val_loss: 3.3257 - val_accuracy200: 0.3346 - 14s/epoch - 37ms/step
Epoch 2/50
384/384 - 12s - loss: 3.3117 - accuracy200: 0.3479 - val_loss: 3.3146 - val_accuracy200: 0.3358 - 12s/epoch - 30ms/step
Epoch 3/50
384/384 - 12s - loss: 3.2981 - accuracy200: 0.3543 - val_loss: 3.3072 - val_accuracy200: 0.3410 - 12s/epoch - 30ms/step
Epoch 4/50
384/384 - 12s - loss: 3.2912 - accuracy200: 0.3608 - val_loss: 3.3036 - val_accuracy200: 0.3471 - 12s/epoch - 30ms/step
Epoch 5/50
384/384 - 12s - loss: 3.2851 - accuracy200: 0.3646 - val_loss: 3.3035 - val_accuracy200: 0.3450 - 12s/epoch - 30ms/step
Epoch 6/50
384/384 - 12s - loss: 3.2793 - accuracy200: 0.3686 - val_loss: 3.2999 - val_accuracy200: 0.3487 - 12s/epoch - 30ms/step
Epoch 7/50
384/384 - 12s - loss: 3.2732 - accuracy200: 0.3753 - val_loss: 3.3015 - val_accuracy200: 0.3526 - 12s/epoch - 30ms/step
Epoch 8/50
384/384 - 12s - loss: 3.2688 - accuracy200: 0.3811 - val_loss: 3.3026 - val_accuracy200: 0.3458 - 12s/epoch - 31ms/step
Epoch 9/50
384/384 - 12s - loss: 3.2632 - accuracy200: 0.3829 - val_loss: 3.3060 - val_accuracy200: 0.3483 - 12s/epoch - 30ms/step
Epoch 10/50
384/384 - 12s - loss: 3.2595 - accuracy200: 0.3882 - val_loss: 3.3077 - val_accuracy200: 0.3490 - 12s/epoch - 30ms/step
Epoch 11/50
384/384 - 12s - loss: 3.2554 - accuracy200: 0.3908 - val_loss: 3.3064 - val_accuracy200: 0.3504 - 12s/epoch - 30ms/step
Epoch 12/50
384/384 - 12s - loss: 3.2512 - accuracy200: 0.3934 - val_loss: 3.3082 - val_accuracy200: 0.3529 - 12s/epoch - 31ms/step
Epoch 13/50
384/384 - 12s - loss: 3.2450 - accuracy200: 0.3959 - val_loss: 3.3115 - val_accuracy200: 0.3508 - 12s/epoch - 32ms/step
Epoch 14/50
384/384 - 12s - loss: 3.2388 - accuracy200: 0.4011 - val_loss: 3.3164 - val_accuracy200: 0.3483 - 12s/epoch - 31ms/step
Epoch 15/50
384/384 - 12s - loss: 3.2344 - accuracy200: 0.4027 - val_loss: 3.3175 - val_accuracy200: 0.3505 - 12s/epoch - 32ms/step
Epoch 16/50
384/384 - 12s - loss: 3.2277 - accuracy200: 0.4072 - val_loss: 3.3237 - val_accuracy200: 0.3457 - 12s/epoch - 31ms/step
testing model: results/CHTR/W1/deepOF_L2/h200
Evaluating performance on  test set...
1304/1304 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0971478
{'0': {'precision': 0.36753132053253085, 'recall': 0.4992268865744855, 'f1-score': 0.4233741667828492, 'support': 112532}, '1': {'precision': 0.35569237017482325, 'recall': 0.36073354302403954, 'f1-score': 0.35819522034560003, 'support': 106824}, '2': {'precision': 0.3777759397874364, 'recall': 0.23959608323133416, 'f1-score': 0.293222342889853, 'support': 114380}, 'accuracy': 0.3659149747105497, 'macro avg': {'precision': 0.3669998768315968, 'recall': 0.3665188376099531, 'f1-score': 0.35826391000610075, 'support': 333736}, 'weighted avg': {'precision': 0.36725294336424313, 'recall': 0.3659149747105497, 'f1-score': 0.35790492944826857, 'support': 333736}}
[[56179 33774 22579]
 [45730 38535 22559]
 [50946 36029 27405]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0922596
{'0': {'precision': 0.36686825760052305, 'recall': 0.5502742790597898, 'f1-score': 0.4402329144958627, 'support': 32631}, '1': {'precision': 0.3641678251880369, 'recall': 0.3154936536858034, 'f1-score': 0.3380878313532118, 'support': 32381}, '2': {'precision': 0.39151920180722893, 'recall': 0.2503234736557037, 'f1-score': 0.3053908702116334, 'support': 33233}, 'accuracy': 0.37142857142857144, 'macro avg': {'precision': 0.37418509486526297, 'recall': 0.3720304688004323, 'f1-score': 0.3612372053535693, 'support': 98245}, 'weighted avg': {'precision': 0.37431680080244417, 'recall': 0.37142857142857144, 'f1-score': 0.36095391205360133, 'support': 98245}}
[[17956  8543  6132]
 [15368 10216  6797]
 [15620  9294  8319]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1019335
{'0': {'precision': 0.3252526983039232, 'recall': 0.5223552070436098, 'f1-score': 0.400886871139735, 'support': 7269}, '1': {'precision': 0.36449686908402507, 'recall': 0.3087836170737725, 'f1-score': 0.33433513657917585, 'support': 8106}, '2': {'precision': 0.37606162354335376, 'recall': 0.23137683801190911, 'f1-score': 0.2864881131507674, 'support': 8229}, 'accuracy': 0.3475682087781732, 'macro avg': {'precision': 0.3552703969771007, 'recall': 0.3541718873764304, 'f1-score': 0.3405700402898928, 'support': 23604}, 'weighted avg': {'precision': 0.35644317000951464, 'recall': 0.3475682087781732, 'f1-score': 0.33814938004334855, 'support': 23604}}
[[3797 2092 1380]
 [3824 2503 1779]
 [4053 2272 1904]]
training model: results/CHTR/W1/deepOF_L2/h300
Epoch 1/50
384/384 - 14s - loss: 3.3451 - accuracy300: 0.3361 - val_loss: 3.3242 - val_accuracy300: 0.3338 - 14s/epoch - 36ms/step
Epoch 2/50
384/384 - 12s - loss: 3.3168 - accuracy300: 0.3452 - val_loss: 3.3153 - val_accuracy300: 0.3369 - 12s/epoch - 32ms/step
Epoch 3/50
384/384 - 12s - loss: 3.3042 - accuracy300: 0.3509 - val_loss: 3.3086 - val_accuracy300: 0.3421 - 12s/epoch - 31ms/step
Epoch 4/50
384/384 - 12s - loss: 3.2957 - accuracy300: 0.3552 - val_loss: 3.3052 - val_accuracy300: 0.3450 - 12s/epoch - 32ms/step
Epoch 5/50
384/384 - 12s - loss: 3.2902 - accuracy300: 0.3600 - val_loss: 3.3029 - val_accuracy300: 0.3441 - 12s/epoch - 31ms/step
Epoch 6/50
384/384 - 12s - loss: 3.2837 - accuracy300: 0.3677 - val_loss: 3.3017 - val_accuracy300: 0.3458 - 12s/epoch - 30ms/step
Epoch 7/50
384/384 - 12s - loss: 3.2789 - accuracy300: 0.3713 - val_loss: 3.2998 - val_accuracy300: 0.3512 - 12s/epoch - 30ms/step
Epoch 8/50
384/384 - 11s - loss: 3.2745 - accuracy300: 0.3754 - val_loss: 3.3021 - val_accuracy300: 0.3478 - 11s/epoch - 30ms/step
Epoch 9/50
384/384 - 12s - loss: 3.2698 - accuracy300: 0.3784 - val_loss: 3.3016 - val_accuracy300: 0.3464 - 12s/epoch - 30ms/step
Epoch 10/50
384/384 - 11s - loss: 3.2662 - accuracy300: 0.3844 - val_loss: 3.3023 - val_accuracy300: 0.3504 - 11s/epoch - 30ms/step
Epoch 11/50
384/384 - 11s - loss: 3.2625 - accuracy300: 0.3856 - val_loss: 3.3044 - val_accuracy300: 0.3460 - 11s/epoch - 30ms/step
Epoch 12/50
384/384 - 11s - loss: 3.2567 - accuracy300: 0.3886 - val_loss: 3.3041 - val_accuracy300: 0.3511 - 11s/epoch - 30ms/step
Epoch 13/50
384/384 - 12s - loss: 3.2507 - accuracy300: 0.3937 - val_loss: 3.3112 - val_accuracy300: 0.3506 - 12s/epoch - 30ms/step
Epoch 14/50
384/384 - 12s - loss: 3.2471 - accuracy300: 0.3947 - val_loss: 3.3094 - val_accuracy300: 0.3519 - 12s/epoch - 30ms/step
Epoch 15/50
384/384 - 12s - loss: 3.2422 - accuracy300: 0.3992 - val_loss: 3.3094 - val_accuracy300: 0.3485 - 12s/epoch - 31ms/step
Epoch 16/50
384/384 - 12s - loss: 3.2343 - accuracy300: 0.4041 - val_loss: 3.3203 - val_accuracy300: 0.3431 - 12s/epoch - 31ms/step
Epoch 17/50
384/384 - 12s - loss: 3.2302 - accuracy300: 0.4081 - val_loss: 3.3232 - val_accuracy300: 0.3492 - 12s/epoch - 32ms/step
testing model: results/CHTR/W1/deepOF_L2/h300
Evaluating performance on  test set...
1304/1304 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989274
{'0': {'precision': 0.35581502534951603, 'recall': 0.4172521889525457, 'f1-score': 0.38409234137118975, 'support': 111012}, '1': {'precision': 0.3479825091542536, 'recall': 0.45106586914647523, 'f1-score': 0.3928749177195883, 'support': 108503}, '2': {'precision': 0.36991940996010236, 'recall': 0.20374537081622468, 'f1-score': 0.26276449201725266, 'support': 114221}, 'accuracy': 0.3551729510751013, 'macro avg': {'precision': 0.35790564815462406, 'recall': 0.3573544763050818, 'f1-score': 0.3465772503693436, 'support': 333736}, 'weighted avg': {'precision': 0.3580957664438877, 'recall': 0.3551729510751013, 'f1-score': 0.34542329637896313, 'support': 333736}}
[[46320 44869 19823]
 [39745 48942 19816]
 [44115 46834 23272]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0931685
{'0': {'precision': 0.3663437304908784, 'recall': 0.48943531446929445, 'f1-score': 0.41903703997566816, 'support': 32372}, '1': {'precision': 0.36083904886445517, 'recall': 0.41595397772718884, 'f1-score': 0.3864412592709033, 'support': 32506}, '2': {'precision': 0.39663338088445077, 'recall': 0.2083195972068211, 'f1-score': 0.2731667059655742, 'support': 33367}, 'accuracy': 0.36964731029568937, 'macro avg': {'precision': 0.37460538674659477, 'recall': 0.37123629646776807, 'f1-score': 0.3595483350707152, 'support': 98245}, 'weighted avg': {'precision': 0.3748097041662188, 'recall': 0.36964731029568937, 'f1-score': 0.35871016448578175, 'support': 98245}}
[[15844 11487  5041]
 [13452 13521  5533]
 [13953 12463  6951]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1006895
{'0': {'precision': 0.31333859510655093, 'recall': 0.45651861434526375, 'f1-score': 0.37161411103960684, 'support': 6957}, '1': {'precision': 0.3732245071019716, 'recall': 0.4175263844420728, 'f1-score': 0.3941344377903397, 'support': 8433}, '2': {'precision': 0.37159147248388696, 'recall': 0.18249330411492573, 'f1-score': 0.24477465708687132, 'support': 8214}, 'accuracy': 0.3472292831723437, 'macro avg': {'precision': 0.3527181915641365, 'recall': 0.3521794343007541, 'f1-score': 0.3368410686389393, 'support': 23604}, 'weighted avg': {'precision': 0.35500555963098834, 'recall': 0.3472292831723437, 'f1-score': 0.3355208489112032, 'support': 23604}}
[[3176 2704 1077]
 [3454 3521 1458]
 [3506 3209 1499]]
training model: results/CHTR/W1/deepOF_L2/h500
Epoch 1/50
384/384 - 14s - loss: 3.3471 - accuracy500: 0.3374 - val_loss: 3.3283 - val_accuracy500: 0.3355 - 14s/epoch - 36ms/step
Epoch 2/50
384/384 - 12s - loss: 3.3218 - accuracy500: 0.3392 - val_loss: 3.3175 - val_accuracy500: 0.3321 - 12s/epoch - 32ms/step
Epoch 3/50
384/384 - 12s - loss: 3.3087 - accuracy500: 0.3461 - val_loss: 3.3112 - val_accuracy500: 0.3350 - 12s/epoch - 32ms/step
Epoch 4/50
384/384 - 12s - loss: 3.2997 - accuracy500: 0.3520 - val_loss: 3.3060 - val_accuracy500: 0.3355 - 12s/epoch - 32ms/step
Epoch 5/50
384/384 - 12s - loss: 3.2927 - accuracy500: 0.3570 - val_loss: 3.3055 - val_accuracy500: 0.3344 - 12s/epoch - 31ms/step
Epoch 6/50
384/384 - 12s - loss: 3.2894 - accuracy500: 0.3603 - val_loss: 3.3057 - val_accuracy500: 0.3358 - 12s/epoch - 32ms/step
Epoch 7/50
384/384 - 12s - loss: 3.2830 - accuracy500: 0.3650 - val_loss: 3.3046 - val_accuracy500: 0.3349 - 12s/epoch - 31ms/step
Epoch 8/50
384/384 - 12s - loss: 3.2801 - accuracy500: 0.3695 - val_loss: 3.3050 - val_accuracy500: 0.3387 - 12s/epoch - 31ms/step
Epoch 9/50
384/384 - 12s - loss: 3.2750 - accuracy500: 0.3724 - val_loss: 3.3065 - val_accuracy500: 0.3346 - 12s/epoch - 32ms/step
Epoch 10/50
384/384 - 12s - loss: 3.2716 - accuracy500: 0.3763 - val_loss: 3.3075 - val_accuracy500: 0.3352 - 12s/epoch - 32ms/step
Epoch 11/50
384/384 - 12s - loss: 3.2667 - accuracy500: 0.3788 - val_loss: 3.3077 - val_accuracy500: 0.3368 - 12s/epoch - 31ms/step
Epoch 12/50
384/384 - 12s - loss: 3.2642 - accuracy500: 0.3813 - val_loss: 3.3116 - val_accuracy500: 0.3304 - 12s/epoch - 31ms/step
Epoch 13/50
384/384 - 12s - loss: 3.2580 - accuracy500: 0.3859 - val_loss: 3.3113 - val_accuracy500: 0.3397 - 12s/epoch - 31ms/step
Epoch 14/50
384/384 - 12s - loss: 3.2529 - accuracy500: 0.3897 - val_loss: 3.3124 - val_accuracy500: 0.3396 - 12s/epoch - 31ms/step
Epoch 15/50
384/384 - 12s - loss: 3.2493 - accuracy500: 0.3924 - val_loss: 3.3167 - val_accuracy500: 0.3389 - 12s/epoch - 31ms/step
Epoch 16/50
384/384 - 12s - loss: 3.2442 - accuracy500: 0.3952 - val_loss: 3.3182 - val_accuracy500: 0.3393 - 12s/epoch - 31ms/step
Epoch 17/50
384/384 - 12s - loss: 3.2369 - accuracy500: 0.4003 - val_loss: 3.3204 - val_accuracy500: 0.3428 - 12s/epoch - 31ms/step
testing model: results/CHTR/W1/deepOF_L2/h500
Evaluating performance on  test set...
1304/1304 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1029648
{'0': {'precision': 0.34774039038932963, 'recall': 0.4287381651264274, 'f1-score': 0.3840146668747074, 'support': 114809}, '1': {'precision': 0.3131297794219143, 'recall': 0.4390276944514331, 'f1-score': 0.3655421900303745, 'support': 103342}, '2': {'precision': 0.36248493434546336, 'recall': 0.14831509278885668, 'f1-score': 0.21050111126118934, 'support': 115585}, 'accuracy': 0.3348035573027782, 'macro avg': {'precision': 0.3411183680522358, 'recall': 0.33869365078890573, 'f1-score': 0.3200193227220904, 'support': 333736}, 'weighted avg': {'precision': 0.3421297231390932, 'recall': 0.3348035573027782, 'f1-score': 0.31820052927002723, 'support': 333736}}
[[49223 49849 15737]
 [43559 45370 14413]
 [48769 49673 17143]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0954884
{'0': {'precision': 0.3527359017308766, 'recall': 0.472101133391456, 'f1-score': 0.40378162450066574, 'support': 32116}, '1': {'precision': 0.35143499601054184, 'recall': 0.44782327387004345, 'f1-score': 0.3938170586322749, 'support': 32457}, '2': {'precision': 0.4020284851100561, 'recall': 0.16598360655737704, 'f1-score': 0.23496027241770714, 'support': 33672}, 'accuracy': 0.3591633161992977, 'macro avg': {'precision': 0.3687331276171582, 'recall': 0.36196933793962544, 'f1-score': 0.3441863185168826, 'support': 98245}, 'weighted avg': {'precision': 0.3692004176917787, 'recall': 0.3591633161992977, 'f1-score': 0.34262866524851304, 'support': 98245}}
[[15162 12947  4007]
 [13616 14535  4306]
 [14206 13877  5589]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1034173
{'0': {'precision': 0.2988676996424315, 'recall': 0.42857142857142855, 'f1-score': 0.352156357891041, 'support': 7021}, '1': {'precision': 0.3562797147385103, 'recall': 0.4266903914590747, 'f1-score': 0.38831911907589334, 'support': 8430}, '2': {'precision': 0.3427325581395349, 'recall': 0.14460934625291305, 'f1-score': 0.2033986026050203, 'support': 8153}, 'accuracy': 0.32981698017285205, 'macro avg': {'precision': 0.3326266575068255, 'recall': 0.33329038876113876, 'f1-score': 0.31462469319065156, 'support': 23604}, 'weighted avg': {'precision': 0.3345232444054729, 'recall': 0.32981698017285205, 'f1-score': 0.3136895767497674, 'support': 23604}}
[[3009 3003 1009]
 [3581 3597 1252]
 [3478 3496 1179]]
training model: results/CHTR/W1/deepOF_L2/h1000
Epoch 1/50
384/384 - 14s - loss: 3.3549 - accuracy1000: 0.3329 - val_loss: 3.3457 - val_accuracy1000: 0.3184 - 14s/epoch - 38ms/step
Epoch 2/50
384/384 - 12s - loss: 3.3297 - accuracy1000: 0.3356 - val_loss: 3.3306 - val_accuracy1000: 0.3186 - 12s/epoch - 31ms/step
Epoch 3/50
384/384 - 12s - loss: 3.3137 - accuracy1000: 0.3399 - val_loss: 3.3227 - val_accuracy1000: 0.3149 - 12s/epoch - 31ms/step
Epoch 4/50
384/384 - 12s - loss: 3.3072 - accuracy1000: 0.3420 - val_loss: 3.3202 - val_accuracy1000: 0.3178 - 12s/epoch - 31ms/step
Epoch 5/50
384/384 - 12s - loss: 3.2984 - accuracy1000: 0.3492 - val_loss: 3.3146 - val_accuracy1000: 0.3247 - 12s/epoch - 31ms/step
Epoch 6/50
384/384 - 12s - loss: 3.2928 - accuracy1000: 0.3535 - val_loss: 3.3141 - val_accuracy1000: 0.3248 - 12s/epoch - 31ms/step
Epoch 7/50
384/384 - 12s - loss: 3.2879 - accuracy1000: 0.3570 - val_loss: 3.3141 - val_accuracy1000: 0.3233 - 12s/epoch - 32ms/step
Epoch 8/50
384/384 - 12s - loss: 3.2847 - accuracy1000: 0.3634 - val_loss: 3.3146 - val_accuracy1000: 0.3237 - 12s/epoch - 32ms/step
Epoch 9/50
384/384 - 12s - loss: 3.2789 - accuracy1000: 0.3669 - val_loss: 3.3126 - val_accuracy1000: 0.3238 - 12s/epoch - 31ms/step
Epoch 10/50
384/384 - 12s - loss: 3.2753 - accuracy1000: 0.3716 - val_loss: 3.3162 - val_accuracy1000: 0.3231 - 12s/epoch - 32ms/step
Epoch 11/50
384/384 - 12s - loss: 3.2696 - accuracy1000: 0.3741 - val_loss: 3.3192 - val_accuracy1000: 0.3190 - 12s/epoch - 31ms/step
Epoch 12/50
384/384 - 12s - loss: 3.2651 - accuracy1000: 0.3800 - val_loss: 3.3203 - val_accuracy1000: 0.3246 - 12s/epoch - 31ms/step
Epoch 13/50
384/384 - 12s - loss: 3.2607 - accuracy1000: 0.3824 - val_loss: 3.3217 - val_accuracy1000: 0.3269 - 12s/epoch - 31ms/step
Epoch 14/50
384/384 - 12s - loss: 3.2555 - accuracy1000: 0.3878 - val_loss: 3.3252 - val_accuracy1000: 0.3269 - 12s/epoch - 31ms/step
Epoch 15/50
384/384 - 12s - loss: 3.2511 - accuracy1000: 0.3907 - val_loss: 3.3265 - val_accuracy1000: 0.3288 - 12s/epoch - 31ms/step
Epoch 16/50
384/384 - 12s - loss: 3.2467 - accuracy1000: 0.3936 - val_loss: 3.3284 - val_accuracy1000: 0.3260 - 12s/epoch - 32ms/step
Epoch 17/50
384/384 - 12s - loss: 3.2392 - accuracy1000: 0.3968 - val_loss: 3.3321 - val_accuracy1000: 0.3292 - 12s/epoch - 32ms/step
Epoch 18/50
384/384 - 12s - loss: 3.2349 - accuracy1000: 0.4026 - val_loss: 3.3429 - val_accuracy1000: 0.3245 - 12s/epoch - 32ms/step
Epoch 19/50
384/384 - 12s - loss: 3.2288 - accuracy1000: 0.4048 - val_loss: 3.3424 - val_accuracy1000: 0.3336 - 12s/epoch - 32ms/step
testing model: results/CHTR/W1/deepOF_L2/h1000
Evaluating performance on  test set...
1304/1304 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1050458
{'0': {'precision': 0.33951414981647593, 'recall': 0.5513000238051154, 'f1-score': 0.42023165867476725, 'support': 113421}, '1': {'precision': 0.3222247067322577, 'recall': 0.3658315107014529, 'f1-score': 0.34264627878477494, 'support': 102416}, '2': {'precision': 0.3583273251622206, 'recall': 0.10117134157202351, 'f1-score': 0.1577913444939049, 'support': 117899}, 'accuracy': 0.33536687681281013, 'macro avg': {'precision': 0.3400220605703181, 'recall': 0.3394342920261973, 'f1-score': 0.30688976065114904, 'support': 333736}, 'weighted avg': {'precision': 0.3408545474876132, 'recall': 0.33536687681281013, 'f1-score': 0.30371011209776344, 'support': 333736}}
[[62529 39691 11201]
 [54790 37467 10159]
 [66853 39118 11928]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0939885
{'0': {'precision': 0.3506113369127068, 'recall': 0.6497225924433562, 'f1-score': 0.4554481260184683, 'support': 32263}, '1': {'precision': 0.37872028995608836, 'recall': 0.33484316263018427, 'f1-score': 0.3554327206122849, 'support': 32454}, '2': {'precision': 0.41919295370749693, 'recall': 0.12207706991171557, 'f1-score': 0.18908805321999447, 'support': 33528}, 'accuracy': 0.3656369280879434, 'macro avg': {'precision': 0.382841526858764, 'recall': 0.368880941661752, 'f1-score': 0.3333229666169159, 'support': 98245}, 'weighted avg': {'precision': 0.38330157468527165, 'recall': 0.3656369280879434, 'f1-score': 0.3315087857177964, 'support': 98245}}
[[20962  8539  2762]
 [18678 10867  2909]
 [20147  9288  4093]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1062732
{'0': {'precision': 0.27710233029381964, 'recall': 0.5867300030646644, 'f1-score': 0.3764254817145104, 'support': 6526}, '1': {'precision': 0.39332384525811875, 'recall': 0.34008278330909497, 'f1-score': 0.3647708183345333, 'support': 8939}, '2': {'precision': 0.35391346621293146, 'recall': 0.08944587787197444, 'f1-score': 0.14280109846998823, 'support': 8139}, 'accuracy': 0.3218522284358583, 'macro avg': {'precision': 0.3414465472549566, 'recall': 0.3387528880819113, 'f1-score': 0.294665799506344, 'support': 23604}, 'weighted avg': {'precision': 0.34760182010535673, 'recall': 0.3218522284358583, 'f1-score': 0.29145471865821565, 'support': 23604}}
[[3829 2100  597]
 [5167 3040  732]
 [4822 2589  728]]
training model: results/CHTR/W1/deepVOL_L2/h10
Epoch 1/50
384/384 - 14s - loss: 3.3291 - accuracy10: 0.3536 - val_loss: 3.2926 - val_accuracy10: 0.3727 - 14s/epoch - 37ms/step
Epoch 2/50
384/384 - 12s - loss: 3.2948 - accuracy10: 0.3671 - val_loss: 3.2790 - val_accuracy10: 0.3750 - 12s/epoch - 31ms/step
Epoch 3/50
384/384 - 11s - loss: 3.2757 - accuracy10: 0.3773 - val_loss: 3.2679 - val_accuracy10: 0.3765 - 11s/epoch - 30ms/step
Epoch 4/50
384/384 - 11s - loss: 3.2607 - accuracy10: 0.3867 - val_loss: 3.2565 - val_accuracy10: 0.3847 - 11s/epoch - 30ms/step
Epoch 5/50
384/384 - 11s - loss: 3.2498 - accuracy10: 0.3966 - val_loss: 3.2490 - val_accuracy10: 0.3934 - 11s/epoch - 30ms/step
Epoch 6/50
384/384 - 12s - loss: 3.2418 - accuracy10: 0.4025 - val_loss: 3.2394 - val_accuracy10: 0.4039 - 12s/epoch - 30ms/step
Epoch 7/50
384/384 - 12s - loss: 3.2333 - accuracy10: 0.4058 - val_loss: 3.2364 - val_accuracy10: 0.4028 - 12s/epoch - 31ms/step
Epoch 8/50
384/384 - 12s - loss: 3.2253 - accuracy10: 0.4093 - val_loss: 3.2349 - val_accuracy10: 0.4038 - 12s/epoch - 31ms/step
Epoch 9/50
384/384 - 12s - loss: 3.2185 - accuracy10: 0.4142 - val_loss: 3.2276 - val_accuracy10: 0.4063 - 12s/epoch - 31ms/step
Epoch 10/50
384/384 - 12s - loss: 3.2125 - accuracy10: 0.4174 - val_loss: 3.2240 - val_accuracy10: 0.4057 - 12s/epoch - 31ms/step
Epoch 11/50
384/384 - 11s - loss: 3.2070 - accuracy10: 0.4187 - val_loss: 3.2279 - val_accuracy10: 0.4065 - 11s/epoch - 30ms/step
Epoch 12/50
384/384 - 11s - loss: 3.2031 - accuracy10: 0.4208 - val_loss: 3.2235 - val_accuracy10: 0.4102 - 11s/epoch - 29ms/step
Epoch 13/50
384/384 - 11s - loss: 3.1997 - accuracy10: 0.4233 - val_loss: 3.2175 - val_accuracy10: 0.4111 - 11s/epoch - 30ms/step
Epoch 14/50
384/384 - 11s - loss: 3.1967 - accuracy10: 0.4243 - val_loss: 3.2224 - val_accuracy10: 0.4061 - 11s/epoch - 30ms/step
Epoch 15/50
384/384 - 12s - loss: 3.1927 - accuracy10: 0.4258 - val_loss: 3.2194 - val_accuracy10: 0.4063 - 12s/epoch - 31ms/step
Epoch 16/50
384/384 - 12s - loss: 3.1885 - accuracy10: 0.4279 - val_loss: 3.2176 - val_accuracy10: 0.4087 - 12s/epoch - 30ms/step
Epoch 17/50
384/384 - 12s - loss: 3.1861 - accuracy10: 0.4294 - val_loss: 3.2140 - val_accuracy10: 0.4121 - 12s/epoch - 30ms/step
Epoch 18/50
384/384 - 11s - loss: 3.1816 - accuracy10: 0.4301 - val_loss: 3.2162 - val_accuracy10: 0.4095 - 11s/epoch - 29ms/step
Epoch 19/50
384/384 - 11s - loss: 3.1763 - accuracy10: 0.4347 - val_loss: 3.2187 - val_accuracy10: 0.4065 - 11s/epoch - 29ms/step
Epoch 20/50
384/384 - 11s - loss: 3.1736 - accuracy10: 0.4337 - val_loss: 3.2160 - val_accuracy10: 0.4131 - 11s/epoch - 30ms/step
Epoch 21/50
384/384 - 11s - loss: 3.1688 - accuracy10: 0.4361 - val_loss: 3.2149 - val_accuracy10: 0.4115 - 11s/epoch - 30ms/step
Epoch 22/50
384/384 - 12s - loss: 3.1681 - accuracy10: 0.4369 - val_loss: 3.2128 - val_accuracy10: 0.4113 - 12s/epoch - 30ms/step
Epoch 23/50
384/384 - 12s - loss: 3.1653 - accuracy10: 0.4372 - val_loss: 3.2165 - val_accuracy10: 0.4118 - 12s/epoch - 30ms/step
Epoch 24/50
384/384 - 11s - loss: 3.1604 - accuracy10: 0.4381 - val_loss: 3.2154 - val_accuracy10: 0.4132 - 11s/epoch - 30ms/step
Epoch 25/50
384/384 - 12s - loss: 3.1580 - accuracy10: 0.4397 - val_loss: 3.2176 - val_accuracy10: 0.4095 - 12s/epoch - 30ms/step
Epoch 26/50
384/384 - 12s - loss: 3.1538 - accuracy10: 0.4420 - val_loss: 3.2212 - val_accuracy10: 0.4089 - 12s/epoch - 30ms/step
Epoch 27/50
384/384 - 12s - loss: 3.1517 - accuracy10: 0.4411 - val_loss: 3.2173 - val_accuracy10: 0.4143 - 12s/epoch - 30ms/step
Epoch 28/50
384/384 - 12s - loss: 3.1507 - accuracy10: 0.4412 - val_loss: 3.2169 - val_accuracy10: 0.4116 - 12s/epoch - 30ms/step
Epoch 29/50
384/384 - 11s - loss: 3.1461 - accuracy10: 0.4426 - val_loss: 3.2198 - val_accuracy10: 0.4110 - 11s/epoch - 30ms/step
Epoch 30/50
384/384 - 12s - loss: 3.1433 - accuracy10: 0.4441 - val_loss: 3.2168 - val_accuracy10: 0.4140 - 12s/epoch - 30ms/step
Epoch 31/50
384/384 - 12s - loss: 3.1391 - accuracy10: 0.4472 - val_loss: 3.2163 - val_accuracy10: 0.4121 - 12s/epoch - 30ms/step
Epoch 32/50
384/384 - 12s - loss: 3.1362 - accuracy10: 0.4465 - val_loss: 3.2155 - val_accuracy10: 0.4145 - 12s/epoch - 30ms/step
testing model: results/CHTR/W1/deepVOL_L2/h10
Evaluating performance on  test set...
1304/1304 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0764828
{'0': {'precision': 0.4634573380022883, 'recall': 0.22846131496641658, 'f1-score': 0.30605352931748975, 'support': 117022}, '1': {'precision': 0.39015379328120975, 'recall': 0.4814647029340325, 'f1-score': 0.43102637448927206, 'support': 103748}, '2': {'precision': 0.3970721359761123, 'recall': 0.5202839666817147, 'f1-score': 0.45040364448633513, 'support': 112971}, 'accuracy': 0.4058925933583228, 'macro avg': {'precision': 0.41689442241987007, 'recall': 0.4100699948607212, 'f1-score': 0.39582784943103233, 'support': 333741}, 'weighted avg': {'precision': 0.41819859299996137, 'recall': 0.4058925933583228, 'f1-score': 0.3937654364599197, 'support': 333741}}
[[26735 40677 49610]
 [14158 49951 39639]
 [16793 37401 58777]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0623955
{'0': {'precision': 0.4707587469487388, 'recall': 0.27310812804248413, 'f1-score': 0.3456748632349372, 'support': 33895}, '1': {'precision': 0.4206461027524782, 'recall': 0.5184186046511627, 'f1-score': 0.46444246902605696, 'support': 32250}, '2': {'precision': 0.40722525491811723, 'recall': 0.49266377994455, 'f1-score': 0.4458886053822406, 'support': 32101}, 'accuracy': 0.42537100747104206, 'macro avg': {'precision': 0.4328767015397781, 'recall': 0.4280635042127323, 'f1-score': 0.4186686458810782, 'support': 98246}, 'weighted avg': {'precision': 0.43354988956009816, 'recall': 0.42537100747104206, 'f1-score': 0.41740517921150827, 'support': 98246}}
[[ 9257 11999 12639]
 [ 5149 16719 10382]
 [ 5258 11028 15815]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0725513
{'0': {'precision': 0.449135934437912, 'recall': 0.3090597033222999, 'f1-score': 0.366158315177923, 'support': 8157}, '1': {'precision': 0.3839460784313726, 'recall': 0.42643255750646525, 'f1-score': 0.40407557877087774, 'support': 7347}, '2': {'precision': 0.4144034177601465, 'recall': 0.502962962962963, 'f1-score': 0.4544085661703196, 'support': 8100}, 'accuracy': 0.41213353668869684, 'macro avg': {'precision': 0.41582847687647706, 'recall': 0.41281840793057595, 'f1-score': 0.4082141533730401, 'support': 23604}, 'weighted avg': {'precision': 0.41692600149561637, 'recall': 0.41213353668869684, 'f1-score': 0.4082446212555307, 'support': 23604}}
[[2521 2524 3112]
 [1569 3133 2645]
 [1523 2503 4074]]
training model: results/CHTR/W1/deepVOL_L2/h20
Epoch 1/50
384/384 - 14s - loss: 3.3304 - accuracy20: 0.3538 - val_loss: 3.2982 - val_accuracy20: 0.3678 - 14s/epoch - 36ms/step
Epoch 2/50
384/384 - 12s - loss: 3.2965 - accuracy20: 0.3654 - val_loss: 3.2770 - val_accuracy20: 0.3765 - 12s/epoch - 30ms/step
Epoch 3/50
384/384 - 11s - loss: 3.2772 - accuracy20: 0.3797 - val_loss: 3.2704 - val_accuracy20: 0.3841 - 11s/epoch - 30ms/step
Epoch 4/50
384/384 - 11s - loss: 3.2692 - accuracy20: 0.3840 - val_loss: 3.2757 - val_accuracy20: 0.3807 - 11s/epoch - 30ms/step
Epoch 5/50
384/384 - 11s - loss: 3.2609 - accuracy20: 0.3879 - val_loss: 3.2658 - val_accuracy20: 0.3839 - 11s/epoch - 30ms/step
Epoch 6/50
384/384 - 11s - loss: 3.2532 - accuracy20: 0.3931 - val_loss: 3.2666 - val_accuracy20: 0.3888 - 11s/epoch - 30ms/step
Epoch 7/50
384/384 - 12s - loss: 3.2453 - accuracy20: 0.3991 - val_loss: 3.2579 - val_accuracy20: 0.3929 - 12s/epoch - 30ms/step
Epoch 8/50
384/384 - 11s - loss: 3.2403 - accuracy20: 0.4042 - val_loss: 3.2495 - val_accuracy20: 0.3944 - 11s/epoch - 29ms/step
Epoch 9/50
384/384 - 11s - loss: 3.2327 - accuracy20: 0.4084 - val_loss: 3.2498 - val_accuracy20: 0.3935 - 11s/epoch - 28ms/step
Epoch 10/50
384/384 - 11s - loss: 3.2262 - accuracy20: 0.4116 - val_loss: 3.2475 - val_accuracy20: 0.3962 - 11s/epoch - 29ms/step
Epoch 11/50
384/384 - 12s - loss: 3.2220 - accuracy20: 0.4147 - val_loss: 3.2450 - val_accuracy20: 0.3976 - 12s/epoch - 30ms/step
Epoch 12/50
384/384 - 11s - loss: 3.2185 - accuracy20: 0.4162 - val_loss: 3.2434 - val_accuracy20: 0.3940 - 11s/epoch - 30ms/step
Epoch 13/50
384/384 - 11s - loss: 3.2147 - accuracy20: 0.4171 - val_loss: 3.2437 - val_accuracy20: 0.3973 - 11s/epoch - 29ms/step
Epoch 14/50
384/384 - 11s - loss: 3.2067 - accuracy20: 0.4222 - val_loss: 3.2355 - val_accuracy20: 0.4033 - 11s/epoch - 29ms/step
Epoch 15/50
384/384 - 11s - loss: 3.2044 - accuracy20: 0.4221 - val_loss: 3.2431 - val_accuracy20: 0.3991 - 11s/epoch - 29ms/step
Epoch 16/50
384/384 - 11s - loss: 3.2026 - accuracy20: 0.4219 - val_loss: 3.2439 - val_accuracy20: 0.3987 - 11s/epoch - 29ms/step
Epoch 17/50
384/384 - 11s - loss: 3.1987 - accuracy20: 0.4248 - val_loss: 3.2478 - val_accuracy20: 0.3956 - 11s/epoch - 29ms/step
Epoch 18/50
384/384 - 12s - loss: 3.1980 - accuracy20: 0.4245 - val_loss: 3.2448 - val_accuracy20: 0.3964 - 12s/epoch - 30ms/step
Epoch 19/50
384/384 - 11s - loss: 3.1954 - accuracy20: 0.4260 - val_loss: 3.2427 - val_accuracy20: 0.3960 - 11s/epoch - 30ms/step
Epoch 20/50
384/384 - 11s - loss: 3.1889 - accuracy20: 0.4293 - val_loss: 3.2376 - val_accuracy20: 0.4002 - 11s/epoch - 29ms/step
Epoch 21/50
384/384 - 11s - loss: 3.1879 - accuracy20: 0.4283 - val_loss: 3.2454 - val_accuracy20: 0.3956 - 11s/epoch - 29ms/step
Epoch 22/50
384/384 - 11s - loss: 3.1826 - accuracy20: 0.4307 - val_loss: 3.2447 - val_accuracy20: 0.3950 - 11s/epoch - 30ms/step
Epoch 23/50
384/384 - 11s - loss: 3.1834 - accuracy20: 0.4323 - val_loss: 3.2475 - val_accuracy20: 0.3997 - 11s/epoch - 29ms/step
Epoch 24/50
384/384 - 11s - loss: 3.1795 - accuracy20: 0.4336 - val_loss: 3.2527 - val_accuracy20: 0.3970 - 11s/epoch - 29ms/step
testing model: results/CHTR/W1/deepVOL_L2/h20
Evaluating performance on  test set...
1304/1304 - 21s - 21s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0816367
{'0': {'precision': 0.41317062294182216, 'recall': 0.4158057806660971, 'f1-score': 0.4144840134723005, 'support': 115869}, '1': {'precision': 0.4009045680687472, 'recall': 0.3318017200235825, 'f1-score': 0.363094537094404, 'support': 106859}, '2': {'precision': 0.3892519406649934, 'recall': 0.4512444488483331, 'f1-score': 0.4179620034542314, 'support': 111013}, 'accuracy': 0.4006969476330448, 'macro avg': {'precision': 0.40110904389185426, 'recall': 0.3996173165126709, 'f1-score': 0.3985135180069787, 'support': 333741}, 'weighted avg': {'precision': 0.40128708740594404, 'recall': 0.4006969476330448, 'f1-score': 0.39918674416945327, 'support': 333741}}
[[48179 27034 40656]
 [33460 35456 37943]
 [34969 25950 50094]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0751208
{'0': {'precision': 0.4064695354862836, 'recall': 0.45104781100868485, 'f1-score': 0.4275999662798213, 'support': 33737}, '1': {'precision': 0.41568001246300046, 'recall': 0.3266911539638812, 'f1-score': 0.36585198642580463, 'support': 32670}, '2': {'precision': 0.4028690974297669, 'recall': 0.4445491378498068, 'f1-score': 0.4226841067908977, 'support': 31839}, 'accuracy': 0.4075891130427702, 'macro avg': {'precision': 0.4083395484596837, 'recall': 0.4074293676074576, 'f1-score': 0.4053786864988412, 'support': 98246}, 'weighted avg': {'precision': 0.408365510238924, 'recall': 0.4075891130427702, 'f1-score': 0.40547364508507994, 'support': 98246}}
[[15217  7803 10717]
 [11735 10673 10262]
 [10485  7200 14154]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0787921
{'0': {'precision': 0.41358284272497897, 'recall': 0.48406546080964685, 'f1-score': 0.44605703271160496, 'support': 8127}, '1': {'precision': 0.37217017954722875, 'recall': 0.25542459148138225, 'f1-score': 0.30293884034948376, 'support': 7466}, '2': {'precision': 0.4088983050847458, 'recall': 0.4577455998002746, 'f1-score': 0.43194534424877795, 'support': 8011}, 'accuracy': 0.40281308252838505, 'macro avg': {'precision': 0.3982171091189845, 'recall': 0.39907855069710124, 'f1-score': 0.3936470724366223, 'support': 23604}, 'weighted avg': {'precision': 0.3988940283578805, 'recall': 0.40281308252838505, 'f1-score': 0.39599902726967545, 'support': 23604}}
[[3934 1581 2612]
 [2870 1907 2689]
 [2708 1636 3667]]
training model: results/CHTR/W1/deepVOL_L2/h30
Epoch 1/50
384/384 - 15s - loss: 3.3341 - accuracy30: 0.3535 - val_loss: 3.3009 - val_accuracy30: 0.3635 - 15s/epoch - 39ms/step
Epoch 2/50
384/384 - 11s - loss: 3.3010 - accuracy30: 0.3612 - val_loss: 3.2827 - val_accuracy30: 0.3720 - 11s/epoch - 30ms/step
Epoch 3/50
384/384 - 11s - loss: 3.2830 - accuracy30: 0.3725 - val_loss: 3.2739 - val_accuracy30: 0.3806 - 11s/epoch - 30ms/step
Epoch 4/50
384/384 - 11s - loss: 3.2753 - accuracy30: 0.3786 - val_loss: 3.2652 - val_accuracy30: 0.3851 - 11s/epoch - 29ms/step
Epoch 5/50
384/384 - 11s - loss: 3.2676 - accuracy30: 0.3838 - val_loss: 3.2697 - val_accuracy30: 0.3815 - 11s/epoch - 29ms/step
Epoch 6/50
384/384 - 11s - loss: 3.2612 - accuracy30: 0.3911 - val_loss: 3.2667 - val_accuracy30: 0.3844 - 11s/epoch - 30ms/step
Epoch 7/50
384/384 - 12s - loss: 3.2540 - accuracy30: 0.3952 - val_loss: 3.2607 - val_accuracy30: 0.3851 - 12s/epoch - 31ms/step
Epoch 8/50
384/384 - 12s - loss: 3.2494 - accuracy30: 0.3993 - val_loss: 3.2645 - val_accuracy30: 0.3878 - 12s/epoch - 31ms/step
Epoch 9/50
384/384 - 11s - loss: 3.2448 - accuracy30: 0.4009 - val_loss: 3.2589 - val_accuracy30: 0.3882 - 11s/epoch - 30ms/step
Epoch 10/50
384/384 - 11s - loss: 3.2417 - accuracy30: 0.4032 - val_loss: 3.2628 - val_accuracy30: 0.3844 - 11s/epoch - 30ms/step
Epoch 11/50
384/384 - 11s - loss: 3.2382 - accuracy30: 0.4071 - val_loss: 3.2570 - val_accuracy30: 0.3879 - 11s/epoch - 30ms/step
Epoch 12/50
384/384 - 11s - loss: 3.2342 - accuracy30: 0.4076 - val_loss: 3.2533 - val_accuracy30: 0.3883 - 11s/epoch - 30ms/step
Epoch 13/50
384/384 - 11s - loss: 3.2302 - accuracy30: 0.4110 - val_loss: 3.2610 - val_accuracy30: 0.3877 - 11s/epoch - 29ms/step
Epoch 14/50
384/384 - 11s - loss: 3.2271 - accuracy30: 0.4119 - val_loss: 3.2580 - val_accuracy30: 0.3850 - 11s/epoch - 29ms/step
Epoch 15/50
384/384 - 11s - loss: 3.2251 - accuracy30: 0.4123 - val_loss: 3.2544 - val_accuracy30: 0.3887 - 11s/epoch - 30ms/step
Epoch 16/50
384/384 - 12s - loss: 3.2204 - accuracy30: 0.4121 - val_loss: 3.2550 - val_accuracy30: 0.3908 - 12s/epoch - 30ms/step
Epoch 17/50
384/384 - 12s - loss: 3.2171 - accuracy30: 0.4165 - val_loss: 3.2608 - val_accuracy30: 0.3857 - 12s/epoch - 30ms/step
Epoch 18/50
384/384 - 12s - loss: 3.2149 - accuracy30: 0.4149 - val_loss: 3.2581 - val_accuracy30: 0.3871 - 12s/epoch - 30ms/step
Epoch 19/50
384/384 - 12s - loss: 3.2126 - accuracy30: 0.4175 - val_loss: 3.2543 - val_accuracy30: 0.3868 - 12s/epoch - 30ms/step
Epoch 20/50
384/384 - 11s - loss: 3.2094 - accuracy30: 0.4178 - val_loss: 3.2545 - val_accuracy30: 0.3914 - 11s/epoch - 30ms/step
Epoch 21/50
384/384 - 11s - loss: 3.2071 - accuracy30: 0.4191 - val_loss: 3.2539 - val_accuracy30: 0.3894 - 11s/epoch - 30ms/step
Epoch 22/50
384/384 - 11s - loss: 3.2041 - accuracy30: 0.4192 - val_loss: 3.2542 - val_accuracy30: 0.3935 - 11s/epoch - 30ms/step
testing model: results/CHTR/W1/deepVOL_L2/h30
Evaluating performance on  test set...
1304/1304 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0873812
{'0': {'precision': 0.4151624182840926, 'recall': 0.35359926797475894, 'f1-score': 0.3819158259831801, 'support': 115843}, '1': {'precision': 0.3646358342255765, 'recall': 0.3923734052717361, 'f1-score': 0.3779964536607155, 'support': 106758}, '2': {'precision': 0.38397796950007074, 'recall': 0.4152690300521864, 'f1-score': 0.3990109666849661, 'support': 111140}, 'accuracy': 0.38653926248198456, 'macro avg': {'precision': 0.38792540733657993, 'recall': 0.3870805677662272, 'f1-score': 0.3863077487762872, 'support': 333741}, 'weighted avg': {'precision': 0.3886150156611747, 'recall': 0.38653926248198456, 'f1-score': 0.386354985652489, 'support': 333741}}
[[40962 37347 37534]
 [28359 41889 36510]
 [29344 35643 46153]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0795578
{'0': {'precision': 0.4121251915079886, 'recall': 0.39098837209302323, 'f1-score': 0.4012786361214704, 'support': 33712}, '1': {'precision': 0.3897138925520326, 'recall': 0.41776275353411185, 'f1-score': 0.40325116430838603, 'support': 32540}, '2': {'precision': 0.4067429336222555, 'recall': 0.39894980308807904, 'f1-score': 0.4028086785009862, 'support': 31994}, 'accuracy': 0.40244895466482095, 'macro avg': {'precision': 0.40286067256075886, 'recall': 0.4025669762384047, 'f1-score': 0.4024461596436142, 'support': 98246}, 'weighted avg': {'precision': 0.4029496156390174, 'recall': 0.40244895466482095, 'f1-score': 0.4024302172860212, 'support': 98246}}
[[13181 11149  9382]
 [ 9711 13594  9235]
 [ 9091 10139 12764]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0843598
{'0': {'precision': 0.4100127477112064, 'recall': 0.43727598566308246, 'f1-score': 0.42320574162679425, 'support': 8091}, '1': {'precision': 0.34846500800232794, 'recall': 0.31967431927389217, 'f1-score': 0.33344935607379045, 'support': 7492}, '2': {'precision': 0.40644285361639104, 'recall': 0.4105473133025807, 'f1-score': 0.4084847733052162, 'support': 8021}, 'accuracy': 0.39086595492289444, 'macro avg': {'precision': 0.3883068697766418, 'recall': 0.3891658727465184, 'f1-score': 0.3883799570019337, 'support': 23604}, 'weighted avg': {'precision': 0.38926415482722776, 'recall': 0.39086595492289444, 'f1-score': 0.3897143110442455, 'support': 23604}}
[[3538 2222 2331]
 [2619 2395 2478]
 [2472 2256 3293]]
training model: results/CHTR/W1/deepVOL_L2/h50
Epoch 1/50
384/384 - 15s - loss: 3.3347 - accuracy50: 0.3489 - val_loss: 3.3145 - val_accuracy50: 0.3530 - 15s/epoch - 39ms/step
Epoch 2/50
384/384 - 11s - loss: 3.3048 - accuracy50: 0.3554 - val_loss: 3.2931 - val_accuracy50: 0.3579 - 11s/epoch - 30ms/step
Epoch 3/50
384/384 - 11s - loss: 3.2915 - accuracy50: 0.3645 - val_loss: 3.2962 - val_accuracy50: 0.3562 - 11s/epoch - 30ms/step
Epoch 4/50
384/384 - 11s - loss: 3.2802 - accuracy50: 0.3739 - val_loss: 3.2915 - val_accuracy50: 0.3571 - 11s/epoch - 30ms/step
Epoch 5/50
384/384 - 12s - loss: 3.2776 - accuracy50: 0.3752 - val_loss: 3.2862 - val_accuracy50: 0.3621 - 12s/epoch - 30ms/step
Epoch 6/50
384/384 - 11s - loss: 3.2707 - accuracy50: 0.3813 - val_loss: 3.2879 - val_accuracy50: 0.3618 - 11s/epoch - 30ms/step
Epoch 7/50
384/384 - 11s - loss: 3.2659 - accuracy50: 0.3846 - val_loss: 3.2853 - val_accuracy50: 0.3623 - 11s/epoch - 30ms/step
Epoch 8/50
384/384 - 11s - loss: 3.2626 - accuracy50: 0.3881 - val_loss: 3.2806 - val_accuracy50: 0.3668 - 11s/epoch - 29ms/step
Epoch 9/50
384/384 - 11s - loss: 3.2567 - accuracy50: 0.3923 - val_loss: 3.2828 - val_accuracy50: 0.3659 - 11s/epoch - 29ms/step
Epoch 10/50
384/384 - 11s - loss: 3.2532 - accuracy50: 0.3930 - val_loss: 3.2842 - val_accuracy50: 0.3637 - 11s/epoch - 29ms/step
Epoch 11/50
384/384 - 11s - loss: 3.2497 - accuracy50: 0.3962 - val_loss: 3.2790 - val_accuracy50: 0.3671 - 11s/epoch - 30ms/step
Epoch 12/50
384/384 - 11s - loss: 3.2465 - accuracy50: 0.3975 - val_loss: 3.2793 - val_accuracy50: 0.3656 - 11s/epoch - 29ms/step
Epoch 13/50
384/384 - 11s - loss: 3.2431 - accuracy50: 0.4001 - val_loss: 3.2796 - val_accuracy50: 0.3647 - 11s/epoch - 30ms/step
Epoch 14/50
384/384 - 11s - loss: 3.2401 - accuracy50: 0.4021 - val_loss: 3.2771 - val_accuracy50: 0.3726 - 11s/epoch - 30ms/step
Epoch 15/50
384/384 - 11s - loss: 3.2360 - accuracy50: 0.4040 - val_loss: 3.2780 - val_accuracy50: 0.3635 - 11s/epoch - 29ms/step
Epoch 16/50
384/384 - 11s - loss: 3.2356 - accuracy50: 0.4037 - val_loss: 3.2756 - val_accuracy50: 0.3691 - 11s/epoch - 29ms/step
Epoch 17/50
384/384 - 11s - loss: 3.2295 - accuracy50: 0.4084 - val_loss: 3.2775 - val_accuracy50: 0.3651 - 11s/epoch - 30ms/step
Epoch 18/50
384/384 - 11s - loss: 3.2281 - accuracy50: 0.4079 - val_loss: 3.2830 - val_accuracy50: 0.3640 - 11s/epoch - 30ms/step
Epoch 19/50
384/384 - 12s - loss: 3.2232 - accuracy50: 0.4101 - val_loss: 3.2775 - val_accuracy50: 0.3627 - 12s/epoch - 30ms/step
Epoch 20/50
384/384 - 12s - loss: 3.2198 - accuracy50: 0.4107 - val_loss: 3.2791 - val_accuracy50: 0.3676 - 12s/epoch - 30ms/step
Epoch 21/50
384/384 - 12s - loss: 3.2169 - accuracy50: 0.4126 - val_loss: 3.2782 - val_accuracy50: 0.3690 - 12s/epoch - 30ms/step
Epoch 22/50
384/384 - 12s - loss: 3.2152 - accuracy50: 0.4150 - val_loss: 3.2829 - val_accuracy50: 0.3627 - 12s/epoch - 30ms/step
Epoch 23/50
384/384 - 12s - loss: 3.2124 - accuracy50: 0.4157 - val_loss: 3.2782 - val_accuracy50: 0.3690 - 12s/epoch - 31ms/step
Epoch 24/50
384/384 - 12s - loss: 3.2087 - accuracy50: 0.4173 - val_loss: 3.2834 - val_accuracy50: 0.3702 - 12s/epoch - 31ms/step
Epoch 25/50
384/384 - 12s - loss: 3.2052 - accuracy50: 0.4184 - val_loss: 3.2862 - val_accuracy50: 0.3649 - 12s/epoch - 30ms/step
Epoch 26/50
384/384 - 11s - loss: 3.2036 - accuracy50: 0.4190 - val_loss: 3.2849 - val_accuracy50: 0.3680 - 11s/epoch - 30ms/step
testing model: results/CHTR/W1/deepVOL_L2/h50
Evaluating performance on  test set...
1304/1304 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.094381
{'0': {'precision': 0.40589802896218824, 'recall': 0.28089252316123703, 'f1-score': 0.3320188990627587, 'support': 114955}, '1': {'precision': 0.3411552890028964, 'recall': 0.5311881791503764, 'f1-score': 0.41547317860154737, 'support': 106659}, '2': {'precision': 0.3872988492702967, 'recall': 0.3043691528356239, 'f1-score': 0.3408624435067043, 'support': 112127}, 'accuracy': 0.3687709930754687, 'macro avg': {'precision': 0.37811738907846043, 'recall': 0.3721499517157458, 'f1-score': 0.3627848403903368, 'support': 333741}, 'weighted avg': {'precision': 0.37895837778768215, 'recall': 0.3687709930754687, 'f1-score': 0.3616608972265862, 'support': 333741}}
[[32290 55126 27539]
 [23552 56656 26451]
 [23710 54289 34128]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0834002
{'0': {'precision': 0.41402924301314087, 'recall': 0.33172192894003205, 'f1-score': 0.3683335254309849, 'support': 33718}, '1': {'precision': 0.3619919223167483, 'recall': 0.5273700353666552, 'f1-score': 0.42930483190868673, 'support': 31951}, '2': {'precision': 0.41773690394198437, 'recall': 0.3165116493231421, 'f1-score': 0.3601466992665037, 'support': 32577}, 'accuracy': 0.390305966655131, 'macro avg': {'precision': 0.3979193564239578, 'recall': 0.3918678712099431, 'f1-score': 0.38592835220205846, 'support': 98246}, 'weighted avg': {'precision': 0.3983353728963778, 'recall': 0.390305966655131, 'f1-score': 0.3854476265374803, 'support': 98246}}
[[11185 15202  7331]
 [ 8060 16850  7041]
 [ 7770 14496 10311]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0921468
{'0': {'precision': 0.411402789171452, 'recall': 0.37001967535661584, 'f1-score': 0.3896154344166775, 'support': 8132}, '1': {'precision': 0.31625676089396876, 'recall': 0.4234763596611096, 'f1-score': 0.36209616171058007, 'support': 7318}, '2': {'precision': 0.40147897088276074, 'recall': 0.31959774343880304, 'f1-score': 0.3558893820416525, 'support': 8154}, 'accuracy': 0.3691747161498051, 'macro avg': {'precision': 0.3763795069827272, 'recall': 0.37103125948550947, 'f1-score': 0.3692003260563033, 'support': 23604}, 'weighted avg': {'precision': 0.37847627462897565, 'recall': 0.3691747161498051, 'f1-score': 0.3694329115930385, 'support': 23604}}
[[3009 3274 1849]
 [2183 3099 2036]
 [2122 3426 2606]]
training model: results/CHTR/W1/deepVOL_L2/h100
Epoch 1/50
384/384 - 16s - loss: 3.3450 - accuracy100: 0.3441 - val_loss: 3.3380 - val_accuracy100: 0.3349 - 16s/epoch - 42ms/step
Epoch 2/50
384/384 - 13s - loss: 3.3141 - accuracy100: 0.3499 - val_loss: 3.3239 - val_accuracy100: 0.3360 - 13s/epoch - 34ms/step
Epoch 3/50
384/384 - 12s - loss: 3.3068 - accuracy100: 0.3540 - val_loss: 3.3059 - val_accuracy100: 0.3427 - 12s/epoch - 32ms/step
Epoch 4/50
384/384 - 12s - loss: 3.2972 - accuracy100: 0.3550 - val_loss: 3.3102 - val_accuracy100: 0.3395 - 12s/epoch - 30ms/step
Epoch 5/50
384/384 - 13s - loss: 3.2940 - accuracy100: 0.3605 - val_loss: 3.2985 - val_accuracy100: 0.3419 - 13s/epoch - 35ms/step
Epoch 6/50
384/384 - 14s - loss: 3.2902 - accuracy100: 0.3628 - val_loss: 3.3034 - val_accuracy100: 0.3405 - 14s/epoch - 37ms/step
Epoch 7/50
384/384 - 12s - loss: 3.2862 - accuracy100: 0.3638 - val_loss: 3.3006 - val_accuracy100: 0.3409 - 12s/epoch - 31ms/step
Epoch 8/50
384/384 - 12s - loss: 3.2824 - accuracy100: 0.3679 - val_loss: 3.3017 - val_accuracy100: 0.3407 - 12s/epoch - 30ms/step
Epoch 9/50
384/384 - 12s - loss: 3.2804 - accuracy100: 0.3677 - val_loss: 3.3003 - val_accuracy100: 0.3389 - 12s/epoch - 30ms/step
Epoch 10/50
384/384 - 11s - loss: 3.2772 - accuracy100: 0.3729 - val_loss: 3.2987 - val_accuracy100: 0.3458 - 11s/epoch - 29ms/step
Epoch 11/50
384/384 - 12s - loss: 3.2744 - accuracy100: 0.3752 - val_loss: 3.2966 - val_accuracy100: 0.3468 - 12s/epoch - 30ms/step
Epoch 12/50
384/384 - 12s - loss: 3.2713 - accuracy100: 0.3771 - val_loss: 3.3019 - val_accuracy100: 0.3417 - 12s/epoch - 30ms/step
Epoch 13/50
384/384 - 12s - loss: 3.2698 - accuracy100: 0.3792 - val_loss: 3.2986 - val_accuracy100: 0.3466 - 12s/epoch - 30ms/step
Epoch 14/50
384/384 - 12s - loss: 3.2680 - accuracy100: 0.3794 - val_loss: 3.2976 - val_accuracy100: 0.3471 - 12s/epoch - 30ms/step
Epoch 15/50
384/384 - 12s - loss: 3.2638 - accuracy100: 0.3821 - val_loss: 3.3007 - val_accuracy100: 0.3449 - 12s/epoch - 30ms/step
Epoch 16/50
384/384 - 11s - loss: 3.2635 - accuracy100: 0.3845 - val_loss: 3.3034 - val_accuracy100: 0.3379 - 11s/epoch - 29ms/step
Epoch 17/50
384/384 - 11s - loss: 3.2594 - accuracy100: 0.3862 - val_loss: 3.3006 - val_accuracy100: 0.3452 - 11s/epoch - 30ms/step
Epoch 18/50
384/384 - 12s - loss: 3.2564 - accuracy100: 0.3877 - val_loss: 3.3009 - val_accuracy100: 0.3438 - 12s/epoch - 30ms/step
Epoch 19/50
384/384 - 11s - loss: 3.2536 - accuracy100: 0.3892 - val_loss: 3.3060 - val_accuracy100: 0.3440 - 11s/epoch - 30ms/step
Epoch 20/50
384/384 - 11s - loss: 3.2510 - accuracy100: 0.3916 - val_loss: 3.3027 - val_accuracy100: 0.3451 - 11s/epoch - 29ms/step
Epoch 21/50
384/384 - 11s - loss: 3.2501 - accuracy100: 0.3917 - val_loss: 3.3056 - val_accuracy100: 0.3469 - 11s/epoch - 30ms/step
testing model: results/CHTR/W1/deepVOL_L2/h100
Evaluating performance on  test set...
1304/1304 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1008632
{'0': {'precision': 0.35334626895122834, 'recall': 0.47435761589403974, 'f1-score': 0.405005937011139, 'support': 113250}, '1': {'precision': 0.32981872744231316, 'recall': 0.37877588278579344, 'f1-score': 0.35260606796326965, 'support': 107359}, '2': {'precision': 0.35279313827874886, 'recall': 0.1821500548032387, 'f1-score': 0.24025463003445202, 'support': 113132}, 'accuracy': 0.34455760604780356, 'macro avg': {'precision': 0.3453193782240968, 'recall': 0.3450945178276906, 'f1-score': 0.3326222116696202, 'support': 333741}, 'weighted avg': {'precision': 0.34559034412300954, 'recall': 0.34455760604780356, 'f1-score': 0.33230212656532393, 'support': 333741}}
[[53721 41091 18438]
 [47328 40665 19366]
 [50986 41539 20607]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0944115
{'0': {'precision': 0.3625941624755672, 'recall': 0.49903276508281946, 'f1-score': 0.4200109391098617, 'support': 33084}, '1': {'precision': 0.347419658166934, 'recall': 0.3909376653284785, 'f1-score': 0.36789620887086144, 'support': 32133}, '2': {'precision': 0.3923286016309272, 'recall': 0.19664537224863, 'f1-score': 0.2619796708615682, 'support': 33029}, 'accuracy': 0.362019827779248, 'macro avg': {'precision': 0.3674474740911428, 'recall': 0.36220526755330934, 'f1-score': 0.3499622729474305, 'support': 98246}, 'weighted avg': {'precision': 0.3676274100776382, 'recall': 0.362019827779248, 'f1-score': 0.3498379306846568, 'support': 98246}}
[[16510 11607  4967]
 [14478 12562  5093]
 [14545 11989  6495]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0991862
{'0': {'precision': 0.3544968493412259, 'recall': 0.4732950924155513, 'f1-score': 0.4053714722419346, 'support': 7845}, '1': {'precision': 0.33811748998664887, 'recall': 0.40150614347998415, 'f1-score': 0.3670954883131001, 'support': 7569}, '2': {'precision': 0.36335103814582326, 'recall': 0.18376068376068377, 'f1-score': 0.24408044112877067, 'support': 8190}, 'accuracy': 0.34981359091679376, 'macro avg': {'precision': 0.3519884591578994, 'recall': 0.35285397321873974, 'f1-score': 0.3388491338946018, 'support': 23604}, 'weighted avg': {'precision': 0.35231672882584114, 'recall': 0.34981359091679376, 'f1-score': 0.33713369613728456, 'support': 23604}}
[[3713 2913 1219]
 [3112 3039 1418]
 [3649 3036 1505]]
training model: results/CHTR/W1/deepVOL_L2/h200
Epoch 1/50
384/384 - 16s - loss: 3.3420 - accuracy200: 0.3465 - val_loss: 3.3374 - val_accuracy200: 0.3310 - 16s/epoch - 41ms/step
Epoch 2/50
384/384 - 12s - loss: 3.3159 - accuracy200: 0.3452 - val_loss: 3.3228 - val_accuracy200: 0.3393 - 12s/epoch - 30ms/step
Epoch 3/50
384/384 - 11s - loss: 3.3039 - accuracy200: 0.3518 - val_loss: 3.3091 - val_accuracy200: 0.3324 - 11s/epoch - 30ms/step
Epoch 4/50
384/384 - 11s - loss: 3.2967 - accuracy200: 0.3539 - val_loss: 3.3110 - val_accuracy200: 0.3389 - 11s/epoch - 30ms/step
Epoch 5/50
384/384 - 11s - loss: 3.2909 - accuracy200: 0.3608 - val_loss: 3.3034 - val_accuracy200: 0.3429 - 11s/epoch - 29ms/step
Epoch 6/50
384/384 - 11s - loss: 3.2866 - accuracy200: 0.3621 - val_loss: 3.3005 - val_accuracy200: 0.3464 - 11s/epoch - 29ms/step
Epoch 7/50
384/384 - 11s - loss: 3.2847 - accuracy200: 0.3629 - val_loss: 3.2996 - val_accuracy200: 0.3459 - 11s/epoch - 29ms/step
Epoch 8/50
384/384 - 11s - loss: 3.2811 - accuracy200: 0.3657 - val_loss: 3.2986 - val_accuracy200: 0.3440 - 11s/epoch - 29ms/step
Epoch 9/50
384/384 - 11s - loss: 3.2784 - accuracy200: 0.3706 - val_loss: 3.3014 - val_accuracy200: 0.3451 - 11s/epoch - 29ms/step
Epoch 10/50
384/384 - 11s - loss: 3.2745 - accuracy200: 0.3739 - val_loss: 3.2995 - val_accuracy200: 0.3500 - 11s/epoch - 28ms/step
Epoch 11/50
384/384 - 11s - loss: 3.2726 - accuracy200: 0.3745 - val_loss: 3.2974 - val_accuracy200: 0.3460 - 11s/epoch - 28ms/step
Epoch 12/50
384/384 - 11s - loss: 3.2706 - accuracy200: 0.3740 - val_loss: 3.2970 - val_accuracy200: 0.3480 - 11s/epoch - 30ms/step
Epoch 13/50
384/384 - 11s - loss: 3.2682 - accuracy200: 0.3775 - val_loss: 3.2996 - val_accuracy200: 0.3481 - 11s/epoch - 29ms/step
Epoch 14/50
384/384 - 11s - loss: 3.2656 - accuracy200: 0.3803 - val_loss: 3.2987 - val_accuracy200: 0.3485 - 11s/epoch - 29ms/step
Epoch 15/50
384/384 - 11s - loss: 3.2647 - accuracy200: 0.3797 - val_loss: 3.3032 - val_accuracy200: 0.3507 - 11s/epoch - 29ms/step
Epoch 16/50
384/384 - 11s - loss: 3.2623 - accuracy200: 0.3824 - val_loss: 3.2991 - val_accuracy200: 0.3514 - 11s/epoch - 29ms/step
Epoch 17/50
384/384 - 11s - loss: 3.2584 - accuracy200: 0.3843 - val_loss: 3.2985 - val_accuracy200: 0.3512 - 11s/epoch - 30ms/step
Epoch 18/50
384/384 - 11s - loss: 3.2559 - accuracy200: 0.3859 - val_loss: 3.2952 - val_accuracy200: 0.3510 - 11s/epoch - 29ms/step
Epoch 19/50
384/384 - 11s - loss: 3.2551 - accuracy200: 0.3863 - val_loss: 3.2991 - val_accuracy200: 0.3497 - 11s/epoch - 29ms/step
Epoch 20/50
384/384 - 11s - loss: 3.2502 - accuracy200: 0.3893 - val_loss: 3.2991 - val_accuracy200: 0.3496 - 11s/epoch - 30ms/step
Epoch 21/50
384/384 - 11s - loss: 3.2488 - accuracy200: 0.3890 - val_loss: 3.3048 - val_accuracy200: 0.3443 - 11s/epoch - 30ms/step
Epoch 22/50
384/384 - 11s - loss: 3.2454 - accuracy200: 0.3938 - val_loss: 3.3035 - val_accuracy200: 0.3490 - 11s/epoch - 29ms/step
Epoch 23/50
384/384 - 11s - loss: 3.2423 - accuracy200: 0.3947 - val_loss: 3.3058 - val_accuracy200: 0.3463 - 11s/epoch - 29ms/step
Epoch 24/50
384/384 - 11s - loss: 3.2384 - accuracy200: 0.3965 - val_loss: 3.3048 - val_accuracy200: 0.3485 - 11s/epoch - 29ms/step
Epoch 25/50
384/384 - 11s - loss: 3.2355 - accuracy200: 0.3994 - val_loss: 3.3081 - val_accuracy200: 0.3441 - 11s/epoch - 29ms/step
Epoch 26/50
384/384 - 11s - loss: 3.2319 - accuracy200: 0.3995 - val_loss: 3.3114 - val_accuracy200: 0.3480 - 11s/epoch - 29ms/step
Epoch 27/50
384/384 - 11s - loss: 3.2297 - accuracy200: 0.4013 - val_loss: 3.3082 - val_accuracy200: 0.3474 - 11s/epoch - 29ms/step
Epoch 28/50
384/384 - 11s - loss: 3.2269 - accuracy200: 0.4036 - val_loss: 3.3170 - val_accuracy200: 0.3446 - 11s/epoch - 29ms/step
testing model: results/CHTR/W1/deepVOL_L2/h200
Evaluating performance on  test set...
1304/1304 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1033859
{'0': {'precision': 0.3471357430580224, 'recall': 0.46024721637208643, 'f1-score': 0.3957682226993818, 'support': 112533}, '1': {'precision': 0.3347917341852246, 'recall': 0.406150245728996, 'f1-score': 0.3670347983876084, 'support': 106825}, '2': {'precision': 0.33916936628689986, 'recall': 0.1629263089794812, 'f1-score': 0.22011586910688657, 'support': 114383}, 'accuracy': 0.3410309191858357, 'macro avg': {'precision': 0.34036561451004904, 'recall': 0.3431079236935212, 'f1-score': 0.3276396300646256, 'support': 333741}, 'weighted avg': {'precision': 0.34045431397964143, 'recall': 0.3410309191858357, 'f1-score': 0.3263698233026173, 'support': 333741}}
[[51793 42634 18106]
 [45234 43387 18204]
 [52174 43573 18636]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0914394
{'0': {'precision': 0.3611072949580986, 'recall': 0.48350603961003125, 'f1-score': 0.413437844072773, 'support': 32618}, '1': {'precision': 0.36687341486075886, 'recall': 0.4501201552775895, 'f1-score': 0.40425561350839084, 'support': 32458}, '2': {'precision': 0.39636585531222457, 'recall': 0.17624359360868255, 'f1-score': 0.24399507502243367, 'support': 33170}, 'accuracy': 0.3687376585306272, 'macro avg': {'precision': 0.3747821883770273, 'recall': 0.36995659616543447, 'f1-score': 0.35389617753453245, 'support': 98246}, 'weighted avg': {'precision': 0.37491633722696355, 'recall': 0.3687376585306272, 'f1-score': 0.353196679149433, 'support': 98246}}
[[15771 12316  4531]
 [13476 14610  4372]
 [14427 12897  5846]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0990691
{'0': {'precision': 0.3224773091297384, 'recall': 0.41597796143250687, 'f1-score': 0.36330827067669175, 'support': 7260}, '1': {'precision': 0.3770476631189264, 'recall': 0.5017859342283533, 'f1-score': 0.43056436271401394, 'support': 8119}, '2': {'precision': 0.3541059988351776, 'recall': 0.1478419452887538, 'f1-score': 0.20859421905823827, 'support': 8225}, 'accuracy': 0.35205897305541434, 'macro avg': {'precision': 0.3512103236946141, 'recall': 0.3552019469832046, 'f1-score': 0.33415561748298134, 'support': 23604}, 'weighted avg': {'precision': 0.352268983289434, 'recall': 0.35205897305541434, 'f1-score': 0.33253082349355495, 'support': 23604}}
[[3020 3172 1068]
 [2895 4074 1150]
 [3450 3559 1216]]
training model: results/CHTR/W1/deepVOL_L2/h300
Epoch 1/50
384/384 - 14s - loss: 3.3425 - accuracy300: 0.3458 - val_loss: 3.3328 - val_accuracy300: 0.3516 - 14s/epoch - 36ms/step
Epoch 2/50
384/384 - 11s - loss: 3.3151 - accuracy300: 0.3541 - val_loss: 3.3193 - val_accuracy300: 0.3391 - 11s/epoch - 29ms/step
Epoch 3/50
384/384 - 11s - loss: 3.3024 - accuracy300: 0.3535 - val_loss: 3.3062 - val_accuracy300: 0.3519 - 11s/epoch - 29ms/step
Epoch 4/50
384/384 - 11s - loss: 3.2952 - accuracy300: 0.3557 - val_loss: 3.2967 - val_accuracy300: 0.3593 - 11s/epoch - 29ms/step
Epoch 5/50
384/384 - 11s - loss: 3.2920 - accuracy300: 0.3563 - val_loss: 3.2803 - val_accuracy300: 0.3744 - 11s/epoch - 29ms/step
Epoch 6/50
384/384 - 11s - loss: 3.2859 - accuracy300: 0.3641 - val_loss: 3.2845 - val_accuracy300: 0.3662 - 11s/epoch - 29ms/step
Epoch 7/50
384/384 - 12s - loss: 3.2845 - accuracy300: 0.3622 - val_loss: 3.2858 - val_accuracy300: 0.3598 - 12s/epoch - 30ms/step
Epoch 8/50
384/384 - 11s - loss: 3.2819 - accuracy300: 0.3653 - val_loss: 3.2871 - val_accuracy300: 0.3618 - 11s/epoch - 29ms/step
Epoch 9/50
384/384 - 11s - loss: 3.2799 - accuracy300: 0.3692 - val_loss: 3.2815 - val_accuracy300: 0.3644 - 11s/epoch - 29ms/step
Epoch 10/50
384/384 - 11s - loss: 3.2774 - accuracy300: 0.3725 - val_loss: 3.2834 - val_accuracy300: 0.3633 - 11s/epoch - 29ms/step
Epoch 11/50
384/384 - 11s - loss: 3.2739 - accuracy300: 0.3742 - val_loss: 3.2871 - val_accuracy300: 0.3577 - 11s/epoch - 29ms/step
Epoch 12/50
384/384 - 12s - loss: 3.2718 - accuracy300: 0.3730 - val_loss: 3.2764 - val_accuracy300: 0.3686 - 12s/epoch - 30ms/step
Epoch 13/50
384/384 - 11s - loss: 3.2696 - accuracy300: 0.3776 - val_loss: 3.2823 - val_accuracy300: 0.3636 - 11s/epoch - 29ms/step
Epoch 14/50
384/384 - 11s - loss: 3.2667 - accuracy300: 0.3800 - val_loss: 3.2802 - val_accuracy300: 0.3711 - 11s/epoch - 29ms/step
Epoch 15/50
384/384 - 11s - loss: 3.2646 - accuracy300: 0.3836 - val_loss: 3.2877 - val_accuracy300: 0.3629 - 11s/epoch - 29ms/step
Epoch 16/50
384/384 - 11s - loss: 3.2639 - accuracy300: 0.3811 - val_loss: 3.2874 - val_accuracy300: 0.3596 - 11s/epoch - 29ms/step
Epoch 17/50
384/384 - 11s - loss: 3.2591 - accuracy300: 0.3828 - val_loss: 3.2836 - val_accuracy300: 0.3666 - 11s/epoch - 30ms/step
Epoch 18/50
384/384 - 11s - loss: 3.2584 - accuracy300: 0.3846 - val_loss: 3.2852 - val_accuracy300: 0.3688 - 11s/epoch - 29ms/step
Epoch 19/50
384/384 - 11s - loss: 3.2573 - accuracy300: 0.3856 - val_loss: 3.2852 - val_accuracy300: 0.3663 - 11s/epoch - 30ms/step
Epoch 20/50
384/384 - 11s - loss: 3.2540 - accuracy300: 0.3865 - val_loss: 3.2851 - val_accuracy300: 0.3647 - 11s/epoch - 29ms/step
Epoch 21/50
384/384 - 11s - loss: 3.2510 - accuracy300: 0.3898 - val_loss: 3.2860 - val_accuracy300: 0.3619 - 11s/epoch - 29ms/step
Epoch 22/50
384/384 - 11s - loss: 3.2491 - accuracy300: 0.3904 - val_loss: 3.2940 - val_accuracy300: 0.3596 - 11s/epoch - 30ms/step
testing model: results/CHTR/W1/deepVOL_L2/h300
Evaluating performance on  test set...
1304/1304 - 24s - 24s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1012344
{'0': {'precision': 0.34456293156265005, 'recall': 0.3748840225919487, 'f1-score': 0.3590845359045709, 'support': 111013}, '1': {'precision': 0.34933320973103255, 'recall': 0.4862172250126722, 'f1-score': 0.4065627083116593, 'support': 108505}, '2': {'precision': 0.3429291053812745, 'recall': 0.18595204118259895, 'f1-score': 0.24114441416893737, 'support': 114223}, 'accuracy': 0.34641833038194286, 'macro avg': {'precision': 0.34560841555831906, 'recall': 0.3490177629290733, 'f1-score': 0.3355972194617225, 'support': 333741}, 'weighted avg': {'precision': 0.34555465420009973, 'recall': 0.34641833038194286, 'f1-score': 0.3341554578830568, 'support': 333741}}
[[41617 48413 20983]
 [36034 52757 19714]
 [43131 49852 21240]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.094554
{'0': {'precision': 0.3535447498238196, 'recall': 0.3875293536027685, 'f1-score': 0.3697578089299665, 'support': 32364}, '1': {'precision': 0.3653317755998356, 'recall': 0.5195052916564116, 'f1-score': 0.4289869799936488, 'support': 32504}, '2': {'precision': 0.3789728096676737, 'recall': 0.18790820300796932, 'f1-score': 0.25124178817497195, 'support': 33378}, 'accuracy': 0.36337357246096536, 'macro avg': {'precision': 0.36594977836377635, 'recall': 0.3649809494223832, 'f1-score': 0.3499955256995291, 'support': 98246}, 'weighted avg': {'precision': 0.3660833088215578, 'recall': 0.36337357246096536, 'f1-score': 0.34908884770501813, 'support': 98246}}
[[12542 14477  5345]
 [10685 16886  4933]
 [12248 14858  6272]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0933162
{'0': {'precision': 0.3185375067458176, 'recall': 0.3386402753872633, 'f1-score': 0.3282814238042269, 'support': 6972}, '1': {'precision': 0.39748357996359895, 'recall': 0.5971231573941987, 'f1-score': 0.4772673286141859, 'support': 8412}, '2': {'precision': 0.37355836849507734, 'recall': 0.16155717761557178, 'f1-score': 0.22556263269639065, 'support': 8220}, 'accuracy': 0.36908998474834775, 'macro avg': {'precision': 0.3631931517348313, 'recall': 0.3657735367990113, 'f1-score': 0.3437037950382678, 'support': 23604}, 'weighted avg': {'precision': 0.36583312831364057, 'recall': 0.36908998474834775, 'f1-score': 0.34560564717123926, 'support': 23604}}
[[2361 3536 1075]
 [2237 5023 1152]
 [2814 4078 1328]]
training model: results/CHTR/W1/deepVOL_L2/h500
Epoch 1/50
384/384 - 14s - loss: 3.3423 - accuracy500: 0.3477 - val_loss: 3.3103 - val_accuracy500: 0.3548 - 14s/epoch - 37ms/step
Epoch 2/50
384/384 - 11s - loss: 3.3160 - accuracy500: 0.3552 - val_loss: 3.3070 - val_accuracy500: 0.3440 - 11s/epoch - 29ms/step
Epoch 3/50
384/384 - 11s - loss: 3.3086 - accuracy500: 0.3514 - val_loss: 3.2997 - val_accuracy500: 0.3479 - 11s/epoch - 30ms/step
Epoch 4/50
384/384 - 11s - loss: 3.2987 - accuracy500: 0.3511 - val_loss: 3.2880 - val_accuracy500: 0.3546 - 11s/epoch - 30ms/step
Epoch 5/50
384/384 - 11s - loss: 3.2926 - accuracy500: 0.3558 - val_loss: 3.2840 - val_accuracy500: 0.3635 - 11s/epoch - 29ms/step
Epoch 6/50
384/384 - 11s - loss: 3.2884 - accuracy500: 0.3594 - val_loss: 3.2939 - val_accuracy500: 0.3529 - 11s/epoch - 29ms/step
Epoch 7/50
384/384 - 11s - loss: 3.2857 - accuracy500: 0.3621 - val_loss: 3.3019 - val_accuracy500: 0.3541 - 11s/epoch - 29ms/step
Epoch 8/50
384/384 - 11s - loss: 3.2832 - accuracy500: 0.3622 - val_loss: 3.2841 - val_accuracy500: 0.3584 - 11s/epoch - 30ms/step
Epoch 9/50
384/384 - 12s - loss: 3.2800 - accuracy500: 0.3665 - val_loss: 3.2767 - val_accuracy500: 0.3659 - 12s/epoch - 32ms/step
Epoch 10/50
384/384 - 12s - loss: 3.2770 - accuracy500: 0.3663 - val_loss: 3.2798 - val_accuracy500: 0.3649 - 12s/epoch - 30ms/step
Epoch 11/50
384/384 - 11s - loss: 3.2755 - accuracy500: 0.3698 - val_loss: 3.2830 - val_accuracy500: 0.3557 - 11s/epoch - 29ms/step
Epoch 12/50
384/384 - 11s - loss: 3.2737 - accuracy500: 0.3718 - val_loss: 3.2857 - val_accuracy500: 0.3590 - 11s/epoch - 29ms/step
Epoch 13/50
384/384 - 11s - loss: 3.2698 - accuracy500: 0.3766 - val_loss: 3.2843 - val_accuracy500: 0.3621 - 11s/epoch - 29ms/step
Epoch 14/50
384/384 - 11s - loss: 3.2694 - accuracy500: 0.3766 - val_loss: 3.2812 - val_accuracy500: 0.3635 - 11s/epoch - 29ms/step
Epoch 15/50
384/384 - 11s - loss: 3.2663 - accuracy500: 0.3780 - val_loss: 3.2915 - val_accuracy500: 0.3575 - 11s/epoch - 29ms/step
Epoch 16/50
384/384 - 11s - loss: 3.2648 - accuracy500: 0.3795 - val_loss: 3.2813 - val_accuracy500: 0.3610 - 11s/epoch - 29ms/step
Epoch 17/50
384/384 - 11s - loss: 3.2622 - accuracy500: 0.3796 - val_loss: 3.2837 - val_accuracy500: 0.3599 - 11s/epoch - 29ms/step
Epoch 18/50
384/384 - 11s - loss: 3.2596 - accuracy500: 0.3827 - val_loss: 3.2820 - val_accuracy500: 0.3598 - 11s/epoch - 29ms/step
Epoch 19/50
384/384 - 11s - loss: 3.2576 - accuracy500: 0.3858 - val_loss: 3.2889 - val_accuracy500: 0.3596 - 11s/epoch - 30ms/step
testing model: results/CHTR/W1/deepVOL_L2/h500
Evaluating performance on  test set...
1304/1304 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1016747
{'0': {'precision': 0.35357041299366043, 'recall': 0.3682138471052425, 'f1-score': 0.36074358832137965, 'support': 114811}, '1': {'precision': 0.3280851589214492, 'recall': 0.5914091907531231, 'f1-score': 0.4220419155474226, 'support': 103343}, '2': {'precision': 0.3661431440045898, 'recall': 0.0883403842992724, 'f1-score': 0.1423383864784806, 'support': 115587}, 'accuracy': 0.34039569606371406, 'macro avg': {'precision': 0.34926623863989975, 'recall': 0.3493211407192127, 'f1-score': 0.308374630115761, 'support': 333741}, 'weighted avg': {'precision': 0.35003330382150527, 'recall': 0.34039569606371406, 'f1-score': 0.3040827374373282, 'support': 333741}}
[[42275 63025  9511]
 [34059 61118  8166]
 [43232 62144 10211]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0968987
{'0': {'precision': 0.3464928544941096, 'recall': 0.3781520453271901, 'f1-score': 0.36163086678872863, 'support': 32122}, '1': {'precision': 0.35467096348921523, 'recall': 0.5969367314863324, 'f1-score': 0.44496514018584243, 'support': 32449}, '2': {'precision': 0.38262390670553936, 'recall': 0.09743132887899035, 'f1-score': 0.15531360946745562, 'support': 33675}, 'accuracy': 0.3541925371007471, 'macro avg': {'precision': 0.36126257489628805, 'recall': 0.3575067018975043, 'f1-score': 0.3206365388140089, 'support': 98246}, 'weighted avg': {'precision': 0.36157829962166776, 'recall': 0.3541925371007471, 'f1-score': 0.31843704919991156, 'support': 98246}}
[[12147 17124  2851]
 [10636 19370  2443]
 [12274 18120  3281]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0933897
{'0': {'precision': 0.31890690376569036, 'recall': 0.3470897964992173, 'f1-score': 0.33240204429301534, 'support': 7027}, '1': {'precision': 0.3903343124912575, 'recall': 0.6639305258148941, 'f1-score': 0.4916314305849189, 'support': 8406}, '2': {'precision': 0.37876960193003617, 'recall': 0.07685717782401175, 'f1-score': 0.1277851256485909, 'support': 8171}, 'accuracy': 0.3663785799017116, 'macro avg': {'precision': 0.3626702727289947, 'recall': 0.3626258333793744, 'f1-score': 0.3172728668421751, 'support': 23604}, 'weighted avg': {'precision': 0.3650667455064117, 'recall': 0.3663785799017116, 'f1-score': 0.3182755139984106, 'support': 23604}}
[[2439 4064  524]
 [2319 5581  506]
 [2890 4653  628]]
training model: results/CHTR/W1/deepVOL_L2/h1000
Epoch 1/50
384/384 - 14s - loss: 3.3453 - accuracy1000: 0.3537 - val_loss: 3.3134 - val_accuracy1000: 0.3491 - 14s/epoch - 36ms/step
Epoch 2/50
384/384 - 13s - loss: 3.3194 - accuracy1000: 0.3542 - val_loss: 3.3419 - val_accuracy1000: 0.3286 - 13s/epoch - 33ms/step
Epoch 3/50
384/384 - 13s - loss: 3.3190 - accuracy1000: 0.3483 - val_loss: 3.3229 - val_accuracy1000: 0.3347 - 13s/epoch - 33ms/step
Epoch 4/50
384/384 - 12s - loss: 3.3029 - accuracy1000: 0.3486 - val_loss: 3.3005 - val_accuracy1000: 0.3420 - 12s/epoch - 30ms/step
Epoch 5/50
384/384 - 11s - loss: 3.2968 - accuracy1000: 0.3547 - val_loss: 3.2907 - val_accuracy1000: 0.3538 - 11s/epoch - 30ms/step
Epoch 6/50
384/384 - 11s - loss: 3.2899 - accuracy1000: 0.3589 - val_loss: 3.2829 - val_accuracy1000: 0.3588 - 11s/epoch - 29ms/step
Epoch 7/50
384/384 - 11s - loss: 3.2881 - accuracy1000: 0.3605 - val_loss: 3.2832 - val_accuracy1000: 0.3585 - 11s/epoch - 30ms/step
Epoch 8/50
384/384 - 11s - loss: 3.2861 - accuracy1000: 0.3615 - val_loss: 3.2863 - val_accuracy1000: 0.3532 - 11s/epoch - 30ms/step
Epoch 9/50
384/384 - 11s - loss: 3.2838 - accuracy1000: 0.3650 - val_loss: 3.2819 - val_accuracy1000: 0.3643 - 11s/epoch - 30ms/step
Epoch 10/50
384/384 - 11s - loss: 3.2792 - accuracy1000: 0.3686 - val_loss: 3.2740 - val_accuracy1000: 0.3685 - 11s/epoch - 30ms/step
Epoch 11/50
384/384 - 12s - loss: 3.2735 - accuracy1000: 0.3752 - val_loss: 3.2730 - val_accuracy1000: 0.3713 - 12s/epoch - 30ms/step
Epoch 12/50
384/384 - 12s - loss: 3.2834 - accuracy1000: 0.3655 - val_loss: 3.2891 - val_accuracy1000: 0.3465 - 12s/epoch - 30ms/step
Epoch 13/50
384/384 - 12s - loss: 3.2758 - accuracy1000: 0.3743 - val_loss: 3.2742 - val_accuracy1000: 0.3707 - 12s/epoch - 31ms/step
Epoch 14/50
384/384 - 12s - loss: 3.2710 - accuracy1000: 0.3748 - val_loss: 3.2730 - val_accuracy1000: 0.3727 - 12s/epoch - 31ms/step
Epoch 15/50
384/384 - 12s - loss: 3.2746 - accuracy1000: 0.3723 - val_loss: 3.2818 - val_accuracy1000: 0.3595 - 12s/epoch - 30ms/step
Epoch 16/50
384/384 - 11s - loss: 3.2699 - accuracy1000: 0.3762 - val_loss: 3.2750 - val_accuracy1000: 0.3707 - 11s/epoch - 29ms/step
Epoch 17/50
384/384 - 11s - loss: 3.2688 - accuracy1000: 0.3743 - val_loss: 3.2756 - val_accuracy1000: 0.3700 - 11s/epoch - 29ms/step
Epoch 18/50
384/384 - 11s - loss: 3.2675 - accuracy1000: 0.3770 - val_loss: 3.2776 - val_accuracy1000: 0.3663 - 11s/epoch - 29ms/step
Epoch 19/50
384/384 - 12s - loss: 3.2660 - accuracy1000: 0.3769 - val_loss: 3.2748 - val_accuracy1000: 0.3712 - 12s/epoch - 30ms/step
Epoch 20/50
384/384 - 11s - loss: 3.2635 - accuracy1000: 0.3818 - val_loss: 3.2725 - val_accuracy1000: 0.3740 - 11s/epoch - 30ms/step
Epoch 21/50
384/384 - 12s - loss: 3.2643 - accuracy1000: 0.3808 - val_loss: 3.2817 - val_accuracy1000: 0.3643 - 12s/epoch - 30ms/step
Epoch 22/50
384/384 - 12s - loss: 3.2648 - accuracy1000: 0.3782 - val_loss: 3.2832 - val_accuracy1000: 0.3600 - 12s/epoch - 30ms/step
Epoch 23/50
384/384 - 12s - loss: 3.2590 - accuracy1000: 0.3820 - val_loss: 3.2789 - val_accuracy1000: 0.3684 - 12s/epoch - 31ms/step
Epoch 24/50
384/384 - 12s - loss: 3.2572 - accuracy1000: 0.3839 - val_loss: 3.2744 - val_accuracy1000: 0.3729 - 12s/epoch - 30ms/step
Epoch 25/50
384/384 - 12s - loss: 3.2551 - accuracy1000: 0.3849 - val_loss: 3.2793 - val_accuracy1000: 0.3724 - 12s/epoch - 30ms/step
Epoch 26/50
384/384 - 11s - loss: 3.2529 - accuracy1000: 0.3857 - val_loss: 3.2767 - val_accuracy1000: 0.3715 - 11s/epoch - 30ms/step
Epoch 27/50
384/384 - 11s - loss: 3.2486 - accuracy1000: 0.3882 - val_loss: 3.2780 - val_accuracy1000: 0.3710 - 11s/epoch - 29ms/step
Epoch 28/50
384/384 - 11s - loss: 3.2451 - accuracy1000: 0.3895 - val_loss: 3.2741 - val_accuracy1000: 0.3765 - 11s/epoch - 29ms/step
Epoch 29/50
384/384 - 11s - loss: 3.2424 - accuracy1000: 0.3918 - val_loss: 3.2729 - val_accuracy1000: 0.3760 - 11s/epoch - 30ms/step
Epoch 30/50
384/384 - 11s - loss: 3.2391 - accuracy1000: 0.3938 - val_loss: 3.2749 - val_accuracy1000: 0.3754 - 11s/epoch - 29ms/step
testing model: results/CHTR/W1/deepVOL_L2/h1000
Evaluating performance on  test set...
1304/1304 - 24s - 24s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1021055
{'0': {'precision': 0.3391407932493413, 'recall': 0.5095439196635603, 'f1-score': 0.40723516396792514, 'support': 113423}, '1': {'precision': 0.32327845373291625, 'recall': 0.4672316825496016, 'f1-score': 0.38214800528675874, 'support': 102416}, '2': {'precision': 0.3666949761547005, 'recall': 0.0476073349052603, 'f1-score': 0.08427358511812265, 'support': 117902}, 'accuracy': 0.3333692893591138, 'macro avg': {'precision': 0.34303807437898604, 'recall': 0.3414609790394741, 'f1-score': 0.29121891812426887, 'support': 333741}, 'weighted avg': {'precision': 0.344007249300571, 'recall': 0.3333692893591138, 'f1-score': 0.2854426886261489, 'support': 333741}}
[[57794 50408  5221]
 [50091 47852  4473]
 [62528 49761  5613]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0929743
{'0': {'precision': 0.3474017743979721, 'recall': 0.5100958406997301, 'f1-score': 0.41331473592943035, 'support': 32241}, '1': {'precision': 0.3728245144886239, 'recall': 0.5236599858378744, 'f1-score': 0.43555305173936987, 'support': 32481}, '2': {'precision': 0.4227857683573051, 'recall': 0.06663882591576184, 'f1-score': 0.11513090084518654, 'support': 33524}, 'accuracy': 0.36326160861510903, 'macro avg': {'precision': 0.3810040190813004, 'recall': 0.36679821748445546, 'f1-score': 0.32133289617132893, 'support': 98246}, 'weighted avg': {'precision': 0.38152966799544313, 'recall': 0.36326160861510903, 'f1-score': 0.31891911522689237, 'support': 98246}}
[[16446 14204  1591]
 [14013 17009  1459]
 [16881 14409  2234]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0931141
{'0': {'precision': 0.2999003984063745, 'recall': 0.46131453960471885, 'f1-score': 0.36349369227983347, 'support': 6527}, '1': {'precision': 0.43097669964889884, 'recall': 0.6038010061486864, 'f1-score': 0.5029566513013921, 'support': 8945}, '2': {'precision': 0.3372093023255814, 'recall': 0.04279390063944909, 'f1-score': 0.07594936708860758, 'support': 8132}, 'accuracy': 0.37112353838332485, 'macro avg': {'precision': 0.3560288001269516, 'recall': 0.3693031487976181, 'f1-score': 0.3141332368899444, 'support': 23604}, 'weighted avg': {'precision': 0.3624268143225484, 'recall': 0.37112353838332485, 'f1-score': 0.3172805807730038, 'support': 23604}}
[[3011 3199  317]
 [3177 5401  367]
 [3852 3932  348]]
training model: results/CHTR/W1/deepVOL_L3/h10
Epoch 1/50
384/384 - 18s - loss: 3.3301 - accuracy10: 0.3513 - val_loss: 3.3115 - val_accuracy10: 0.3487 - 18s/epoch - 46ms/step
Epoch 2/50
384/384 - 15s - loss: 3.3061 - accuracy10: 0.3556 - val_loss: 3.3036 - val_accuracy10: 0.3518 - 15s/epoch - 39ms/step
Epoch 3/50
384/384 - 17s - loss: 3.2944 - accuracy10: 0.3566 - val_loss: 3.2868 - val_accuracy10: 0.3602 - 17s/epoch - 45ms/step
Epoch 4/50
384/384 - 16s - loss: 3.2873 - accuracy10: 0.3638 - val_loss: 3.2794 - val_accuracy10: 0.3641 - 16s/epoch - 43ms/step
Epoch 5/50
384/384 - 17s - loss: 3.2761 - accuracy10: 0.3737 - val_loss: 3.2759 - val_accuracy10: 0.3716 - 17s/epoch - 43ms/step
Epoch 6/50
384/384 - 17s - loss: 3.2719 - accuracy10: 0.3781 - val_loss: 3.2692 - val_accuracy10: 0.3754 - 17s/epoch - 43ms/step
Epoch 7/50
384/384 - 17s - loss: 3.2598 - accuracy10: 0.3870 - val_loss: 3.2520 - val_accuracy10: 0.3901 - 17s/epoch - 44ms/step
Epoch 8/50
384/384 - 16s - loss: 3.2515 - accuracy10: 0.3928 - val_loss: 3.2513 - val_accuracy10: 0.3911 - 16s/epoch - 42ms/step
Epoch 9/50
384/384 - 16s - loss: 3.2398 - accuracy10: 0.4007 - val_loss: 3.2394 - val_accuracy10: 0.3962 - 16s/epoch - 42ms/step
Epoch 10/50
384/384 - 16s - loss: 3.2343 - accuracy10: 0.4050 - val_loss: 3.2471 - val_accuracy10: 0.3959 - 16s/epoch - 42ms/step
Epoch 11/50
384/384 - 16s - loss: 3.2280 - accuracy10: 0.4090 - val_loss: 3.2415 - val_accuracy10: 0.4008 - 16s/epoch - 42ms/step
Epoch 12/50
384/384 - 17s - loss: 3.2217 - accuracy10: 0.4129 - val_loss: 3.2369 - val_accuracy10: 0.4026 - 17s/epoch - 43ms/step
Epoch 13/50
384/384 - 16s - loss: 3.2130 - accuracy10: 0.4167 - val_loss: 3.2481 - val_accuracy10: 0.3980 - 16s/epoch - 42ms/step
Epoch 14/50
384/384 - 16s - loss: 3.2087 - accuracy10: 0.4179 - val_loss: 3.2372 - val_accuracy10: 0.3999 - 16s/epoch - 42ms/step
Epoch 15/50
384/384 - 16s - loss: 3.2027 - accuracy10: 0.4217 - val_loss: 3.2370 - val_accuracy10: 0.4057 - 16s/epoch - 41ms/step
Epoch 16/50
384/384 - 16s - loss: 3.1992 - accuracy10: 0.4238 - val_loss: 3.2239 - val_accuracy10: 0.4065 - 16s/epoch - 41ms/step
Epoch 17/50
384/384 - 16s - loss: 3.1957 - accuracy10: 0.4245 - val_loss: 3.2312 - val_accuracy10: 0.4043 - 16s/epoch - 40ms/step
Epoch 18/50
384/384 - 16s - loss: 3.1905 - accuracy10: 0.4281 - val_loss: 3.2295 - val_accuracy10: 0.4063 - 16s/epoch - 41ms/step
Epoch 19/50
384/384 - 15s - loss: 3.1909 - accuracy10: 0.4281 - val_loss: 3.2218 - val_accuracy10: 0.4068 - 15s/epoch - 40ms/step
Epoch 20/50
384/384 - 16s - loss: 3.1838 - accuracy10: 0.4313 - val_loss: 3.2263 - val_accuracy10: 0.4083 - 16s/epoch - 41ms/step
Epoch 21/50
384/384 - 16s - loss: 3.1792 - accuracy10: 0.4330 - val_loss: 3.2211 - val_accuracy10: 0.4093 - 16s/epoch - 40ms/step
Epoch 22/50
384/384 - 15s - loss: 3.1753 - accuracy10: 0.4339 - val_loss: 3.2204 - val_accuracy10: 0.4112 - 15s/epoch - 40ms/step
Epoch 23/50
384/384 - 16s - loss: 3.1726 - accuracy10: 0.4345 - val_loss: 3.2152 - val_accuracy10: 0.4110 - 16s/epoch - 41ms/step
Epoch 24/50
384/384 - 15s - loss: 3.1687 - accuracy10: 0.4363 - val_loss: 3.2169 - val_accuracy10: 0.4126 - 15s/epoch - 40ms/step
Epoch 25/50
384/384 - 15s - loss: 3.1640 - accuracy10: 0.4375 - val_loss: 3.2207 - val_accuracy10: 0.4122 - 15s/epoch - 40ms/step
Epoch 26/50
384/384 - 15s - loss: 3.1611 - accuracy10: 0.4394 - val_loss: 3.2295 - val_accuracy10: 0.4104 - 15s/epoch - 40ms/step
Epoch 27/50
384/384 - 15s - loss: 3.1577 - accuracy10: 0.4388 - val_loss: 3.2331 - val_accuracy10: 0.4070 - 15s/epoch - 40ms/step
Epoch 28/50
384/384 - 16s - loss: 3.1555 - accuracy10: 0.4394 - val_loss: 3.2280 - val_accuracy10: 0.4059 - 16s/epoch - 42ms/step
Epoch 29/50
384/384 - 16s - loss: 3.1511 - accuracy10: 0.4431 - val_loss: 3.2247 - val_accuracy10: 0.4157 - 16s/epoch - 41ms/step
Epoch 30/50
384/384 - 15s - loss: 3.1479 - accuracy10: 0.4435 - val_loss: 3.2291 - val_accuracy10: 0.4099 - 15s/epoch - 40ms/step
Epoch 31/50
384/384 - 16s - loss: 3.1447 - accuracy10: 0.4438 - val_loss: 3.2629 - val_accuracy10: 0.3973 - 16s/epoch - 40ms/step
Epoch 32/50
384/384 - 15s - loss: 3.1400 - accuracy10: 0.4445 - val_loss: 3.2523 - val_accuracy10: 0.4071 - 15s/epoch - 40ms/step
Epoch 33/50
384/384 - 15s - loss: 3.1388 - accuracy10: 0.4452 - val_loss: 3.2474 - val_accuracy10: 0.4051 - 15s/epoch - 40ms/step
testing model: results/CHTR/W1/deepVOL_L3/h10
Evaluating performance on  test set...
1304/1304 - 27s - 27s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0730401
{'0': {'precision': 0.4307260043921974, 'recall': 0.34191006819230574, 'f1-score': 0.38121325876311246, 'support': 117022}, '1': {'precision': 0.40943265164361453, 'recall': 0.38633033889809926, 'f1-score': 0.397546146140189, 'support': 103748}, '2': {'precision': 0.3957329229477808, 'recall': 0.5007656832284392, 'f1-score': 0.4420965435321148, 'support': 112971}, 'accuracy': 0.40949119227185155, 'macro avg': {'precision': 0.4119638596611976, 'recall': 0.409668696772948, 'f1-score': 0.4069519828118054, 'support': 333741}, 'weighted avg': {'precision': 0.41226154792800157, 'recall': 0.40949119227185155, 'f1-score': 0.4068994943866526, 'support': 333741}}
[[40011 30243 46768]
 [24052 40081 39615]
 [28829 27570 56572]]
Evaluating performance on  train set...
384/384 - 8s - 8s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0627033
{'0': {'precision': 0.4408015887344286, 'recall': 0.3601711166838767, 'f1-score': 0.3964279915570709, 'support': 33895}, '1': {'precision': 0.4329678784381612, 'recall': 0.4187906976744186, 'f1-score': 0.42576130130508794, 'support': 32250}, '2': {'precision': 0.39855680056914905, 'recall': 0.4886452135447494, 'f1-score': 0.4390271208262196, 'support': 32101}, 'accuracy': 0.421391201677422, 'macro avg': {'precision': 0.42410875591391295, 'recall': 0.42253567596768155, 'f1-score': 0.4204054712294594, 'support': 98246}, 'weighted avg': {'precision': 0.42442700756116697, 'recall': 0.421391201677422, 'f1-score': 0.4199757582655628, 'support': 98246}}
[[12208  9123 12564]
 [ 7637 13506 11107]
 [ 7850  8565 15686]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.072721
{'0': {'precision': 0.4211142931528248, 'recall': 0.39659188427117814, 'f1-score': 0.40848538417829416, 'support': 8157}, '1': {'precision': 0.3948933700855941, 'recall': 0.3704913570164693, 'f1-score': 0.3823033707865168, 'support': 7347}, '2': {'precision': 0.419758555764758, 'recall': 0.4679012345679012, 'f1-score': 0.4425243738688773, 'support': 8100}, 'accuracy': 0.41293848500254193, 'macro avg': {'precision': 0.41192207300105893, 'recall': 0.41166149195184953, 'f1-score': 0.4111043762778961, 'support': 23604}, 'weighted avg': {'precision': 0.4124875097848243, 'recall': 0.41293848500254193, 'f1-score': 0.4120168434269103, 'support': 23604}}
[[3235 2123 2799]
 [2185 2722 2440]
 [2262 2048 3790]]
training model: results/CHTR/W1/deepVOL_L3/h20
Epoch 1/50
384/384 - 18s - loss: 3.3302 - accuracy20: 0.3478 - val_loss: 3.3148 - val_accuracy20: 0.3491 - 18s/epoch - 48ms/step
Epoch 2/50
384/384 - 15s - loss: 3.3032 - accuracy20: 0.3528 - val_loss: 3.2983 - val_accuracy20: 0.3563 - 15s/epoch - 40ms/step
Epoch 3/50
384/384 - 16s - loss: 3.2940 - accuracy20: 0.3540 - val_loss: 3.2916 - val_accuracy20: 0.3563 - 16s/epoch - 41ms/step
Epoch 4/50
384/384 - 16s - loss: 3.2884 - accuracy20: 0.3605 - val_loss: 3.2863 - val_accuracy20: 0.3713 - 16s/epoch - 41ms/step
Epoch 5/50
384/384 - 16s - loss: 3.2772 - accuracy20: 0.3760 - val_loss: 3.2736 - val_accuracy20: 0.3758 - 16s/epoch - 41ms/step
Epoch 6/50
384/384 - 16s - loss: 3.2696 - accuracy20: 0.3809 - val_loss: 3.2717 - val_accuracy20: 0.3800 - 16s/epoch - 41ms/step
Epoch 7/50
384/384 - 16s - loss: 3.2608 - accuracy20: 0.3889 - val_loss: 3.2583 - val_accuracy20: 0.3882 - 16s/epoch - 41ms/step
Epoch 8/50
384/384 - 16s - loss: 3.2538 - accuracy20: 0.3934 - val_loss: 3.2595 - val_accuracy20: 0.3850 - 16s/epoch - 42ms/step
Epoch 9/50
384/384 - 16s - loss: 3.2476 - accuracy20: 0.3981 - val_loss: 3.2616 - val_accuracy20: 0.3840 - 16s/epoch - 43ms/step
Epoch 10/50
384/384 - 15s - loss: 3.2406 - accuracy20: 0.4025 - val_loss: 3.2521 - val_accuracy20: 0.3915 - 15s/epoch - 40ms/step
Epoch 11/50
384/384 - 16s - loss: 3.2352 - accuracy20: 0.4062 - val_loss: 3.2628 - val_accuracy20: 0.3877 - 16s/epoch - 42ms/step
Epoch 12/50
384/384 - 16s - loss: 3.2305 - accuracy20: 0.4088 - val_loss: 3.2627 - val_accuracy20: 0.3869 - 16s/epoch - 42ms/step
Epoch 13/50
384/384 - 16s - loss: 3.2288 - accuracy20: 0.4102 - val_loss: 3.2595 - val_accuracy20: 0.3910 - 16s/epoch - 43ms/step
Epoch 14/50
384/384 - 15s - loss: 3.2258 - accuracy20: 0.4117 - val_loss: 3.2538 - val_accuracy20: 0.3955 - 15s/epoch - 40ms/step
Epoch 15/50
384/384 - 15s - loss: 3.2209 - accuracy20: 0.4155 - val_loss: 3.2647 - val_accuracy20: 0.3894 - 15s/epoch - 40ms/step
Epoch 16/50
384/384 - 16s - loss: 3.2160 - accuracy20: 0.4170 - val_loss: 3.2545 - val_accuracy20: 0.3928 - 16s/epoch - 41ms/step
Epoch 17/50
384/384 - 16s - loss: 3.2151 - accuracy20: 0.4181 - val_loss: 3.2535 - val_accuracy20: 0.3902 - 16s/epoch - 41ms/step
Epoch 18/50
384/384 - 16s - loss: 3.2120 - accuracy20: 0.4177 - val_loss: 3.2505 - val_accuracy20: 0.3883 - 16s/epoch - 43ms/step
Epoch 19/50
384/384 - 16s - loss: 3.2089 - accuracy20: 0.4205 - val_loss: 3.2488 - val_accuracy20: 0.3929 - 16s/epoch - 41ms/step
Epoch 20/50
384/384 - 16s - loss: 3.2061 - accuracy20: 0.4224 - val_loss: 3.2578 - val_accuracy20: 0.3872 - 16s/epoch - 41ms/step
Epoch 21/50
384/384 - 16s - loss: 3.2059 - accuracy20: 0.4237 - val_loss: 3.2578 - val_accuracy20: 0.3900 - 16s/epoch - 43ms/step
Epoch 22/50
384/384 - 16s - loss: 3.2003 - accuracy20: 0.4247 - val_loss: 3.2495 - val_accuracy20: 0.3958 - 16s/epoch - 40ms/step
Epoch 23/50
384/384 - 17s - loss: 3.1964 - accuracy20: 0.4262 - val_loss: 3.2526 - val_accuracy20: 0.3929 - 17s/epoch - 43ms/step
Epoch 24/50
384/384 - 16s - loss: 3.1943 - accuracy20: 0.4265 - val_loss: 3.2500 - val_accuracy20: 0.3936 - 16s/epoch - 41ms/step
Epoch 25/50
384/384 - 16s - loss: 3.1903 - accuracy20: 0.4292 - val_loss: 3.2463 - val_accuracy20: 0.3976 - 16s/epoch - 41ms/step
Epoch 26/50
384/384 - 16s - loss: 3.1875 - accuracy20: 0.4296 - val_loss: 3.2592 - val_accuracy20: 0.3906 - 16s/epoch - 41ms/step
Epoch 27/50
384/384 - 16s - loss: 3.1851 - accuracy20: 0.4308 - val_loss: 3.2609 - val_accuracy20: 0.3900 - 16s/epoch - 41ms/step
Epoch 28/50
384/384 - 16s - loss: 3.1817 - accuracy20: 0.4309 - val_loss: 3.2602 - val_accuracy20: 0.3882 - 16s/epoch - 41ms/step
Epoch 29/50
384/384 - 16s - loss: 3.1801 - accuracy20: 0.4325 - val_loss: 3.2621 - val_accuracy20: 0.3918 - 16s/epoch - 42ms/step
Epoch 30/50
384/384 - 16s - loss: 3.1757 - accuracy20: 0.4337 - val_loss: 3.2623 - val_accuracy20: 0.3863 - 16s/epoch - 41ms/step
Epoch 31/50
384/384 - 16s - loss: 3.1722 - accuracy20: 0.4342 - val_loss: 3.2605 - val_accuracy20: 0.3911 - 16s/epoch - 41ms/step
Epoch 32/50
384/384 - 16s - loss: 3.1713 - accuracy20: 0.4340 - val_loss: 3.2604 - val_accuracy20: 0.3881 - 16s/epoch - 42ms/step
Epoch 33/50
384/384 - 16s - loss: 3.1662 - accuracy20: 0.4372 - val_loss: 3.2657 - val_accuracy20: 0.3883 - 16s/epoch - 43ms/step
Epoch 34/50
384/384 - 16s - loss: 3.1647 - accuracy20: 0.4370 - val_loss: 3.2632 - val_accuracy20: 0.3904 - 16s/epoch - 41ms/step
Epoch 35/50
384/384 - 16s - loss: 3.1645 - accuracy20: 0.4377 - val_loss: 3.2669 - val_accuracy20: 0.3895 - 16s/epoch - 41ms/step
testing model: results/CHTR/W1/deepVOL_L3/h20
Evaluating performance on  test set...
1304/1304 - 27s - 27s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0831399
{'0': {'precision': 0.41406319449245876, 'recall': 0.36179651157773, 'f1-score': 0.38616935038136996, 'support': 115869}, '1': {'precision': 0.3792204935576931, 'recall': 0.4194780037245342, 'f1-score': 0.39833468111009407, 'support': 106859}, '2': {'precision': 0.3941992213132683, 'recall': 0.40585336852440707, 'f1-score': 0.3999414135316989, 'support': 111013}, 'accuracy': 0.3949200128243159, 'macro avg': {'precision': 0.39582763645447344, 'recall': 0.3957092946088904, 'f1-score': 0.3948151483410543, 'support': 333741}, 'weighted avg': {'precision': 0.3962996729780821, 'recall': 0.3949200128243159, 'f1-score': 0.39464554336589447, 'support': 333741}}
[[41921 37708 36240]
 [29034 44825 33000]
 [30288 35670 45055]]
Evaluating performance on  train set...
384/384 - 8s - 8s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0689737
{'0': {'precision': 0.4193123765944777, 'recall': 0.3965675667664582, 'f1-score': 0.40762293583571996, 'support': 33737}, '1': {'precision': 0.4100090273076055, 'recall': 0.44487297214569943, 'f1-score': 0.4267300860271881, 'support': 32670}, '2': {'precision': 0.4170470363536305, 'recall': 0.40462954238512516, 'f1-score': 0.4107444603857803, 'support': 31839}, 'accuracy': 0.41524336868676587, 'macro avg': {'precision': 0.4154561467519045, 'recall': 0.4153566937657609, 'f1-score': 0.41503249408289616, 'support': 98246}, 'weighted avg': {'precision': 0.4154845709929219, 'recall': 0.41524336868676587, 'f1-score': 0.4149882923581701, 'support': 98246}}
[[13379 10797  9561]
 [ 9689 14534  8447]
 [ 8839 10117 12883]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0825547
{'0': {'precision': 0.40931579582478583, 'recall': 0.41737418481604527, 'f1-score': 0.41330571463384913, 'support': 8127}, '1': {'precision': 0.35453442932219376, 'recall': 0.3523975354942406, 'f1-score': 0.3534627527372876, 'support': 7466}, '2': {'precision': 0.41324721377912865, 'recall': 0.40731494195481216, 'f1-score': 0.41025963412334193, 'support': 8011}, 'accuracy': 0.3934078969666158, 'macro avg': {'precision': 0.3923658129753694, 'recall': 0.39236222075503263, 'f1-score': 0.3923427004981596, 'support': 23604}, 'weighted avg': {'precision': 0.3933226127593685, 'recall': 0.3934078969666158, 'f1-score': 0.39334343262701127, 'support': 23604}}
[[3392 2383 2352]
 [2554 2631 2281]
 [2341 2407 3263]]
training model: results/CHTR/W1/deepVOL_L3/h30
Epoch 1/50
384/384 - 18s - loss: 3.3358 - accuracy30: 0.3481 - val_loss: 3.3176 - val_accuracy30: 0.3452 - 18s/epoch - 48ms/step
Epoch 2/50
384/384 - 17s - loss: 3.3032 - accuracy30: 0.3536 - val_loss: 3.2937 - val_accuracy30: 0.3638 - 17s/epoch - 45ms/step
Epoch 3/50
384/384 - 16s - loss: 3.2937 - accuracy30: 0.3608 - val_loss: 3.2876 - val_accuracy30: 0.3642 - 16s/epoch - 41ms/step
Epoch 4/50
384/384 - 15s - loss: 3.2840 - accuracy30: 0.3666 - val_loss: 3.2775 - val_accuracy30: 0.3778 - 15s/epoch - 40ms/step
Epoch 5/50
384/384 - 15s - loss: 3.2809 - accuracy30: 0.3724 - val_loss: 3.2806 - val_accuracy30: 0.3721 - 15s/epoch - 40ms/step
Epoch 6/50
384/384 - 16s - loss: 3.2754 - accuracy30: 0.3755 - val_loss: 3.2757 - val_accuracy30: 0.3719 - 16s/epoch - 41ms/step
Epoch 7/50
384/384 - 16s - loss: 3.2718 - accuracy30: 0.3779 - val_loss: 3.2741 - val_accuracy30: 0.3724 - 16s/epoch - 41ms/step
Epoch 8/50
384/384 - 17s - loss: 3.2675 - accuracy30: 0.3832 - val_loss: 3.2692 - val_accuracy30: 0.3710 - 17s/epoch - 43ms/step
Epoch 9/50
384/384 - 16s - loss: 3.2631 - accuracy30: 0.3846 - val_loss: 3.2678 - val_accuracy30: 0.3767 - 16s/epoch - 43ms/step
Epoch 10/50
384/384 - 16s - loss: 3.2587 - accuracy30: 0.3885 - val_loss: 3.2656 - val_accuracy30: 0.3813 - 16s/epoch - 40ms/step
Epoch 11/50
384/384 - 16s - loss: 3.2557 - accuracy30: 0.3906 - val_loss: 3.2613 - val_accuracy30: 0.3823 - 16s/epoch - 41ms/step
Epoch 12/50
384/384 - 16s - loss: 3.2508 - accuracy30: 0.3946 - val_loss: 3.2571 - val_accuracy30: 0.3890 - 16s/epoch - 42ms/step
Epoch 13/50
384/384 - 16s - loss: 3.2458 - accuracy30: 0.3988 - val_loss: 3.2554 - val_accuracy30: 0.3867 - 16s/epoch - 42ms/step
Epoch 14/50
384/384 - 16s - loss: 3.2411 - accuracy30: 0.4025 - val_loss: 3.2569 - val_accuracy30: 0.3849 - 16s/epoch - 41ms/step
Epoch 15/50
384/384 - 16s - loss: 3.2355 - accuracy30: 0.4054 - val_loss: 3.2587 - val_accuracy30: 0.3828 - 16s/epoch - 41ms/step
Epoch 16/50
384/384 - 16s - loss: 3.2333 - accuracy30: 0.4092 - val_loss: 3.2520 - val_accuracy30: 0.3870 - 16s/epoch - 41ms/step
Epoch 17/50
384/384 - 20s - loss: 3.2283 - accuracy30: 0.4107 - val_loss: 3.2501 - val_accuracy30: 0.3901 - 20s/epoch - 52ms/step
Epoch 18/50
384/384 - 16s - loss: 3.2236 - accuracy30: 0.4125 - val_loss: 3.2535 - val_accuracy30: 0.3865 - 16s/epoch - 42ms/step
Epoch 19/50
384/384 - 16s - loss: 3.2205 - accuracy30: 0.4150 - val_loss: 3.2507 - val_accuracy30: 0.3928 - 16s/epoch - 41ms/step
Epoch 20/50
384/384 - 16s - loss: 3.2183 - accuracy30: 0.4154 - val_loss: 3.2565 - val_accuracy30: 0.3894 - 16s/epoch - 42ms/step
Epoch 21/50
384/384 - 18s - loss: 3.2144 - accuracy30: 0.4158 - val_loss: 3.2537 - val_accuracy30: 0.3915 - 18s/epoch - 47ms/step
Epoch 22/50
384/384 - 16s - loss: 3.2112 - accuracy30: 0.4183 - val_loss: 3.2533 - val_accuracy30: 0.3926 - 16s/epoch - 42ms/step
Epoch 23/50
384/384 - 16s - loss: 3.2071 - accuracy30: 0.4209 - val_loss: 3.2593 - val_accuracy30: 0.3885 - 16s/epoch - 41ms/step
Epoch 24/50
384/384 - 16s - loss: 3.2020 - accuracy30: 0.4228 - val_loss: 3.2562 - val_accuracy30: 0.3883 - 16s/epoch - 41ms/step
Epoch 25/50
384/384 - 16s - loss: 3.2013 - accuracy30: 0.4239 - val_loss: 3.2619 - val_accuracy30: 0.3881 - 16s/epoch - 41ms/step
Epoch 26/50
384/384 - 16s - loss: 3.1955 - accuracy30: 0.4263 - val_loss: 3.2619 - val_accuracy30: 0.3866 - 16s/epoch - 43ms/step
Epoch 27/50
384/384 - 16s - loss: 3.1932 - accuracy30: 0.4281 - val_loss: 3.2638 - val_accuracy30: 0.3876 - 16s/epoch - 41ms/step
testing model: results/CHTR/W1/deepVOL_L3/h30
Evaluating performance on  test set...
1304/1304 - 27s - 27s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0870343
{'0': {'precision': 0.42103928105522537, 'recall': 0.30089863004238493, 'f1-score': 0.3509724061198906, 'support': 115843}, '1': {'precision': 0.3609423529813304, 'recall': 0.3962326008355346, 'f1-score': 0.37776507675683396, 'support': 106758}, '2': {'precision': 0.38129593217551233, 'recall': 0.45888968868094293, 'f1-score': 0.4165097979967088, 'support': 111140}, 'accuracy': 0.3840073589999431, 'macro avg': {'precision': 0.387759188737356, 'recall': 0.3853403065196208, 'f1-score': 0.3817490936244778, 'support': 333741}, 'weighted avg': {'precision': 0.3885802675033867, 'recall': 0.3840073589999431, 'f1-score': 0.38136770566369366, 'support': 333741}}
[[34857 38293 42693]
 [24394 42301 40063]
 [23537 36602 51001]]
Evaluating performance on  train set...
384/384 - 8s - 8s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.079491
{'0': {'precision': 0.42417558576800696, 'recall': 0.3479769814902705, 'f1-score': 0.3823165167514014, 'support': 33712}, '1': {'precision': 0.38474456425667314, 'recall': 0.40132145052243395, 'f1-score': 0.39285821726181525, 'support': 32540}, '2': {'precision': 0.3932274612530015, 'recall': 0.4504282052884916, 'f1-score': 0.41988869788176336, 'support': 31994}, 'accuracy': 0.3990086110375995, 'macro avg': {'precision': 0.4007158704258939, 'recall': 0.3999088791003987, 'f1-score': 0.3983544772983267, 'support': 98246}, 'weighted avg': {'precision': 0.40103734364403354, 'recall': 0.3990086110375995, 'f1-score': 0.3980434806755679, 'support': 98246}}
[[11731 10719 11262]
 [ 8506 13059 10975]
 [ 7419 10164 14411]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0828526
{'0': {'precision': 0.41568328892272555, 'recall': 0.40489432703003336, 'f1-score': 0.4102178812922615, 'support': 8091}, '1': {'precision': 0.33971082225792315, 'recall': 0.310464495461826, 'f1-score': 0.3244298765604296, 'support': 7492}, '2': {'precision': 0.4059260928346102, 'recall': 0.4491958608652288, 'f1-score': 0.4264662366100491, 'support': 8021}, 'accuracy': 0.3899762752075919, 'macro avg': {'precision': 0.38710673467175294, 'recall': 0.3881848944523627, 'f1-score': 0.3870379981542467, 'support': 23604}, 'weighted avg': {'precision': 0.38825369266465604, 'recall': 0.3899762752075919, 'f1-score': 0.3885098795363341, 'support': 23604}}
[[3276 2233 2582]
 [2475 2326 2691]
 [2130 2288 3603]]
training model: results/CHTR/W1/deepVOL_L3/h50
Epoch 1/50
384/384 - 18s - loss: 3.3380 - accuracy50: 0.3461 - val_loss: 3.3187 - val_accuracy50: 0.3353 - 18s/epoch - 47ms/step
Epoch 2/50
384/384 - 16s - loss: 3.3021 - accuracy50: 0.3538 - val_loss: 3.3010 - val_accuracy50: 0.3428 - 16s/epoch - 41ms/step
Epoch 3/50
384/384 - 16s - loss: 3.2972 - accuracy50: 0.3551 - val_loss: 3.2981 - val_accuracy50: 0.3457 - 16s/epoch - 42ms/step
Epoch 4/50
384/384 - 17s - loss: 3.2930 - accuracy50: 0.3562 - val_loss: 3.2936 - val_accuracy50: 0.3430 - 17s/epoch - 43ms/step
Epoch 5/50
384/384 - 16s - loss: 3.2888 - accuracy50: 0.3602 - val_loss: 3.2950 - val_accuracy50: 0.3464 - 16s/epoch - 41ms/step
Epoch 6/50
384/384 - 16s - loss: 3.2842 - accuracy50: 0.3660 - val_loss: 3.2842 - val_accuracy50: 0.3628 - 16s/epoch - 43ms/step
Epoch 7/50
384/384 - 16s - loss: 3.2796 - accuracy50: 0.3714 - val_loss: 3.2891 - val_accuracy50: 0.3543 - 16s/epoch - 41ms/step
Epoch 8/50
384/384 - 16s - loss: 3.2762 - accuracy50: 0.3733 - val_loss: 3.2925 - val_accuracy50: 0.3484 - 16s/epoch - 41ms/step
Epoch 9/50
384/384 - 16s - loss: 3.2738 - accuracy50: 0.3770 - val_loss: 3.2873 - val_accuracy50: 0.3535 - 16s/epoch - 43ms/step
Epoch 10/50
384/384 - 16s - loss: 3.2689 - accuracy50: 0.3811 - val_loss: 3.2857 - val_accuracy50: 0.3550 - 16s/epoch - 41ms/step
Epoch 11/50
384/384 - 16s - loss: 3.2631 - accuracy50: 0.3849 - val_loss: 3.2825 - val_accuracy50: 0.3582 - 16s/epoch - 42ms/step
Epoch 12/50
384/384 - 16s - loss: 3.2632 - accuracy50: 0.3852 - val_loss: 3.2830 - val_accuracy50: 0.3588 - 16s/epoch - 40ms/step
Epoch 13/50
384/384 - 16s - loss: 3.2589 - accuracy50: 0.3863 - val_loss: 3.2713 - val_accuracy50: 0.3775 - 16s/epoch - 41ms/step
Epoch 14/50
384/384 - 16s - loss: 3.2568 - accuracy50: 0.3901 - val_loss: 3.2787 - val_accuracy50: 0.3640 - 16s/epoch - 42ms/step
Epoch 15/50
384/384 - 16s - loss: 3.2533 - accuracy50: 0.3921 - val_loss: 3.2736 - val_accuracy50: 0.3750 - 16s/epoch - 41ms/step
Epoch 16/50
384/384 - 16s - loss: 3.2518 - accuracy50: 0.3932 - val_loss: 3.2707 - val_accuracy50: 0.3787 - 16s/epoch - 41ms/step
Epoch 17/50
384/384 - 16s - loss: 3.2482 - accuracy50: 0.3961 - val_loss: 3.2669 - val_accuracy50: 0.3817 - 16s/epoch - 41ms/step
Epoch 18/50
384/384 - 16s - loss: 3.2520 - accuracy50: 0.3925 - val_loss: 3.2784 - val_accuracy50: 0.3671 - 16s/epoch - 41ms/step
Epoch 19/50
384/384 - 16s - loss: 3.2447 - accuracy50: 0.3976 - val_loss: 3.2761 - val_accuracy50: 0.3625 - 16s/epoch - 41ms/step
Epoch 20/50
384/384 - 16s - loss: 3.2399 - accuracy50: 0.3988 - val_loss: 3.2763 - val_accuracy50: 0.3648 - 16s/epoch - 41ms/step
Epoch 21/50
384/384 - 16s - loss: 3.2365 - accuracy50: 0.4012 - val_loss: 3.2746 - val_accuracy50: 0.3691 - 16s/epoch - 41ms/step
Epoch 22/50
384/384 - 15s - loss: 3.2328 - accuracy50: 0.4033 - val_loss: 3.2735 - val_accuracy50: 0.3671 - 15s/epoch - 40ms/step
Epoch 23/50
384/384 - 16s - loss: 3.2310 - accuracy50: 0.4061 - val_loss: 3.2784 - val_accuracy50: 0.3699 - 16s/epoch - 40ms/step
Epoch 24/50
384/384 - 15s - loss: 3.2298 - accuracy50: 0.4045 - val_loss: 3.2765 - val_accuracy50: 0.3690 - 15s/epoch - 40ms/step
Epoch 25/50
384/384 - 16s - loss: 3.2257 - accuracy50: 0.4072 - val_loss: 3.2773 - val_accuracy50: 0.3694 - 16s/epoch - 40ms/step
Epoch 26/50
384/384 - 16s - loss: 3.2212 - accuracy50: 0.4114 - val_loss: 3.2868 - val_accuracy50: 0.3708 - 16s/epoch - 41ms/step
Epoch 27/50
384/384 - 16s - loss: 3.2193 - accuracy50: 0.4101 - val_loss: 3.2889 - val_accuracy50: 0.3634 - 16s/epoch - 42ms/step
testing model: results/CHTR/W1/deepVOL_L3/h50
Evaluating performance on  test set...
1304/1304 - 27s - 27s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0924592
{'0': {'precision': 0.36747730708933785, 'recall': 0.5729807315906225, 'f1-score': 0.4477763123903792, 'support': 114955}, '1': {'precision': 0.3649513828668426, 'recall': 0.18545082927835438, 'f1-score': 0.2459311939723234, 'support': 106659}, '2': {'precision': 0.37691548439198014, 'recall': 0.33716232486377057, 'f1-score': 0.35593236296533415, 'support': 112127}, 'accuracy': 0.3699036078875535, 'macro avg': {'precision': 0.3697813914493869, 'recall': 0.3651979619109158, 'f1-score': 0.3498799564426789, 'support': 333741}, 'weighted avg': {'precision': 0.3698410021545718, 'recall': 0.3699036078875535, 'f1-score': 0.35241258721866386, 'support': 333741}}
[[65867 17773 31315]
 [55698 19780 31181]
 [57676 16646 37805]]
Evaluating performance on  train set...
384/384 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0872688
{'0': {'precision': 0.37254758418740846, 'recall': 0.6037131502461593, 'f1-score': 0.46076190045044024, 'support': 33718}, '1': {'precision': 0.37997256515775035, 'recall': 0.19939907984100655, 'f1-score': 0.2615460404778521, 'support': 31951}, '2': {'precision': 0.40333097358321846, 'recall': 0.33228965220861345, 'f1-score': 0.3643799649925946, 'support': 32577}, 'accuracy': 0.382224212690593, 'macro avg': {'precision': 0.3852837076427924, 'recall': 0.37846729409859314, 'f1-score': 0.36222930197362907, 'support': 98246}, 'weighted avg': {'precision': 0.3851696353989661, 'recall': 0.382224212690593, 'f1-score': 0.3640151600905844, 'support': 98246}}
[[20356  5360  8002]
 [17568  6371  8012]
 [16716  5036 10825]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.088702
{'0': {'precision': 0.37878317553934504, 'recall': 0.6002213477619281, 'f1-score': 0.4644590351127605, 'support': 8132}, '1': {'precision': 0.3618526123659594, 'recall': 0.21672588138835747, 'f1-score': 0.27108794120160673, 'support': 7318}, '2': {'precision': 0.40031570639305447, 'recall': 0.31101299975472163, 'f1-score': 0.3500586651942853, 'support': 8154}, 'accuracy': 0.38141840366039653, 'macro avg': {'precision': 0.38031716476611965, 'recall': 0.37598674296833573, 'f1-score': 0.36186854716955086, 'support': 23604}, 'weighted avg': {'precision': 0.3809725669678449, 'recall': 0.38141840366039653, 'f1-score': 0.36498817078649926, 'support': 23604}}
[[4881 1426 1825]
 [3758 1586 1974]
 [4247 1371 2536]]
training model: results/CHTR/W1/deepVOL_L3/h100
Epoch 1/50
384/384 - 18s - loss: 3.3382 - accuracy100: 0.3489 - val_loss: 3.3690 - val_accuracy100: 0.3256 - 18s/epoch - 47ms/step
Epoch 2/50
384/384 - 16s - loss: 3.3146 - accuracy100: 0.3481 - val_loss: 3.3035 - val_accuracy100: 0.3334 - 16s/epoch - 42ms/step
Epoch 3/50
384/384 - 16s - loss: 3.3016 - accuracy100: 0.3473 - val_loss: 3.2995 - val_accuracy100: 0.3382 - 16s/epoch - 42ms/step
Epoch 4/50
384/384 - 15s - loss: 3.3003 - accuracy100: 0.3443 - val_loss: 3.2985 - val_accuracy100: 0.3327 - 15s/epoch - 40ms/step
Epoch 5/50
384/384 - 16s - loss: 3.2972 - accuracy100: 0.3454 - val_loss: 3.2988 - val_accuracy100: 0.3360 - 16s/epoch - 42ms/step
Epoch 6/50
384/384 - 16s - loss: 3.2965 - accuracy100: 0.3446 - val_loss: 3.2965 - val_accuracy100: 0.3410 - 16s/epoch - 42ms/step
Epoch 7/50
384/384 - 16s - loss: 3.2936 - accuracy100: 0.3494 - val_loss: 3.2943 - val_accuracy100: 0.3433 - 16s/epoch - 40ms/step
Epoch 8/50
384/384 - 16s - loss: 3.2924 - accuracy100: 0.3520 - val_loss: 3.2958 - val_accuracy100: 0.3394 - 16s/epoch - 41ms/step
Epoch 9/50
384/384 - 16s - loss: 3.2919 - accuracy100: 0.3540 - val_loss: 3.2934 - val_accuracy100: 0.3461 - 16s/epoch - 43ms/step
Epoch 10/50
384/384 - 16s - loss: 3.2958 - accuracy100: 0.3512 - val_loss: 3.3037 - val_accuracy100: 0.3271 - 16s/epoch - 43ms/step
Epoch 11/50
384/384 - 16s - loss: 3.2948 - accuracy100: 0.3512 - val_loss: 3.2918 - val_accuracy100: 0.3545 - 16s/epoch - 42ms/step
Epoch 12/50
384/384 - 15s - loss: 3.2901 - accuracy100: 0.3572 - val_loss: 3.2960 - val_accuracy100: 0.3465 - 15s/epoch - 40ms/step
Epoch 13/50
384/384 - 16s - loss: 3.2900 - accuracy100: 0.3577 - val_loss: 3.2921 - val_accuracy100: 0.3460 - 16s/epoch - 42ms/step
Epoch 14/50
384/384 - 16s - loss: 3.2874 - accuracy100: 0.3601 - val_loss: 3.3002 - val_accuracy100: 0.3425 - 16s/epoch - 43ms/step
Epoch 15/50
384/384 - 16s - loss: 3.2848 - accuracy100: 0.3635 - val_loss: 3.2933 - val_accuracy100: 0.3477 - 16s/epoch - 41ms/step
Epoch 16/50
384/384 - 16s - loss: 3.2845 - accuracy100: 0.3634 - val_loss: 3.2976 - val_accuracy100: 0.3427 - 16s/epoch - 42ms/step
Epoch 17/50
384/384 - 16s - loss: 3.2822 - accuracy100: 0.3655 - val_loss: 3.2963 - val_accuracy100: 0.3399 - 16s/epoch - 41ms/step
Epoch 18/50
384/384 - 16s - loss: 3.2806 - accuracy100: 0.3674 - val_loss: 3.2996 - val_accuracy100: 0.3413 - 16s/epoch - 42ms/step
Epoch 19/50
384/384 - 16s - loss: 3.2797 - accuracy100: 0.3658 - val_loss: 3.2993 - val_accuracy100: 0.3447 - 16s/epoch - 43ms/step
Epoch 20/50
384/384 - 16s - loss: 3.2772 - accuracy100: 0.3696 - val_loss: 3.2989 - val_accuracy100: 0.3414 - 16s/epoch - 43ms/step
Epoch 21/50
384/384 - 16s - loss: 3.2779 - accuracy100: 0.3675 - val_loss: 3.2916 - val_accuracy100: 0.3457 - 16s/epoch - 42ms/step
Epoch 22/50
384/384 - 16s - loss: 3.2740 - accuracy100: 0.3726 - val_loss: 3.2895 - val_accuracy100: 0.3523 - 16s/epoch - 41ms/step
Epoch 23/50
384/384 - 16s - loss: 3.2733 - accuracy100: 0.3739 - val_loss: 3.3037 - val_accuracy100: 0.3375 - 16s/epoch - 41ms/step
Epoch 24/50
384/384 - 16s - loss: 3.2705 - accuracy100: 0.3758 - val_loss: 3.2954 - val_accuracy100: 0.3419 - 16s/epoch - 41ms/step
Epoch 25/50
384/384 - 16s - loss: 3.2680 - accuracy100: 0.3772 - val_loss: 3.2949 - val_accuracy100: 0.3426 - 16s/epoch - 43ms/step
Epoch 26/50
384/384 - 16s - loss: 3.2670 - accuracy100: 0.3783 - val_loss: 3.3014 - val_accuracy100: 0.3447 - 16s/epoch - 42ms/step
Epoch 27/50
384/384 - 16s - loss: 3.2641 - accuracy100: 0.3817 - val_loss: 3.3016 - val_accuracy100: 0.3374 - 16s/epoch - 43ms/step
Epoch 28/50
384/384 - 16s - loss: 3.2617 - accuracy100: 0.3822 - val_loss: 3.3059 - val_accuracy100: 0.3453 - 16s/epoch - 43ms/step
Epoch 29/50
384/384 - 16s - loss: 3.2575 - accuracy100: 0.3859 - val_loss: 3.3043 - val_accuracy100: 0.3423 - 16s/epoch - 43ms/step
Epoch 30/50
384/384 - 17s - loss: 3.2559 - accuracy100: 0.3868 - val_loss: 3.2996 - val_accuracy100: 0.3463 - 17s/epoch - 43ms/step
Epoch 31/50
384/384 - 17s - loss: 3.2538 - accuracy100: 0.3871 - val_loss: 3.3027 - val_accuracy100: 0.3388 - 17s/epoch - 43ms/step
Epoch 32/50
384/384 - 16s - loss: 3.2507 - accuracy100: 0.3900 - val_loss: 3.3058 - val_accuracy100: 0.3432 - 16s/epoch - 42ms/step
testing model: results/CHTR/W1/deepVOL_L3/h100
Evaluating performance on  test set...
1304/1304 - 26s - 26s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.097943
{'0': {'precision': 0.3548237511499368, 'recall': 0.41890507726269316, 'f1-score': 0.38421076075204597, 'support': 113250}, '1': {'precision': 0.33339527968779037, 'recall': 0.21723376708054284, 'f1-score': 0.2630617217108825, 'support': 107359}, '2': {'precision': 0.3534304493215974, 'recall': 0.4063925326167663, 'f1-score': 0.3780656779748126, 'support': 113132}, 'accuracy': 0.34978920779886197, 'macro avg': {'precision': 0.3472164933864415, 'recall': 0.3475104589866674, 'f1-score': 0.3417793868125803, 'support': 333741}, 'weighted avg': {'precision': 0.34745826027483223, 'recall': 0.34978920779886197, 'f1-score': 0.3431560351199713, 'support': 333741}}
[[47441 23892 41917]
 [41845 23322 42192]
 [44417 22739 45976]]
Evaluating performance on  train set...
384/384 - 9s - 9s/epoch - 24ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0932769
{'0': {'precision': 0.36191475660075845, 'recall': 0.4586507072905332, 'f1-score': 0.40458066150297955, 'support': 33084}, '1': {'precision': 0.35285109449599134, 'recall': 0.24379920953536863, 'f1-score': 0.2883592527836569, 'support': 32133}, '2': {'precision': 0.3737726060321834, 'recall': 0.3860849556450392, 'f1-score': 0.3798290292794806, 'support': 33029}, 'accuracy': 0.36398428434745433, 'macro avg': {'precision': 0.36284615237631107, 'recall': 0.36284495749031365, 'f1-score': 0.3575896478553724, 'support': 98246}, 'weighted avg': {'precision': 0.3629367855328071, 'recall': 0.36398428434745433, 'f1-score': 0.35824733305105333, 'support': 98246}}
[[15174  7360 10550]
 [13484  7834 10815]
 [13269  7008 12752]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 25ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0972407
{'0': {'precision': 0.3464969429688283, 'recall': 0.44066284257488847, 'f1-score': 0.3879474806419033, 'support': 7845}, '1': {'precision': 0.32449013430608525, 'recall': 0.2585546307306117, 'f1-score': 0.2877941176470588, 'support': 7569}, '2': {'precision': 0.3737493417588204, 'recall': 0.34664224664224663, 'f1-score': 0.35968579754212593, 'support': 8190}, 'accuracy': 0.349644128113879, 'macro avg': {'precision': 0.3482454730112447, 'recall': 0.34861990664924897, 'f1-score': 0.34514246527702935, 'support': 23604}, 'weighted avg': {'precision': 0.3488960114030654, 'recall': 0.349644128113879, 'f1-score': 0.34602560345603844, 'support': 23604}}
[[3457 2081 2307]
 [3162 1957 2450]
 [3358 1993 2839]]
training model: results/CHTR/W1/deepVOL_L3/h200
Epoch 1/50
384/384 - 18s - loss: 3.3332 - accuracy200: 0.3553 - val_loss: 3.3343 - val_accuracy200: 0.3358 - 18s/epoch - 48ms/step
Epoch 2/50
384/384 - 17s - loss: 3.3117 - accuracy200: 0.3546 - val_loss: 3.3055 - val_accuracy200: 0.3358 - 17s/epoch - 44ms/step
Epoch 3/50
384/384 - 17s - loss: 3.3048 - accuracy200: 0.3516 - val_loss: 3.3240 - val_accuracy200: 0.3331 - 17s/epoch - 44ms/step
Epoch 4/50
384/384 - 16s - loss: 3.2999 - accuracy200: 0.3569 - val_loss: 3.3098 - val_accuracy200: 0.3330 - 16s/epoch - 43ms/step
Epoch 5/50
384/384 - 17s - loss: 3.2967 - accuracy200: 0.3520 - val_loss: 3.2992 - val_accuracy200: 0.3366 - 17s/epoch - 43ms/step
Epoch 6/50
384/384 - 17s - loss: 3.2939 - accuracy200: 0.3523 - val_loss: 3.2977 - val_accuracy200: 0.3360 - 17s/epoch - 43ms/step
Epoch 7/50
384/384 - 17s - loss: 3.2905 - accuracy200: 0.3547 - val_loss: 3.2975 - val_accuracy200: 0.3384 - 17s/epoch - 43ms/step
Epoch 8/50
384/384 - 17s - loss: 3.2889 - accuracy200: 0.3589 - val_loss: 3.2982 - val_accuracy200: 0.3345 - 17s/epoch - 44ms/step
Epoch 9/50
384/384 - 17s - loss: 3.2860 - accuracy200: 0.3616 - val_loss: 3.2955 - val_accuracy200: 0.3381 - 17s/epoch - 43ms/step
Epoch 10/50
384/384 - 17s - loss: 3.2833 - accuracy200: 0.3630 - val_loss: 3.2928 - val_accuracy200: 0.3405 - 17s/epoch - 43ms/step
Epoch 11/50
384/384 - 17s - loss: 3.2814 - accuracy200: 0.3652 - val_loss: 3.2942 - val_accuracy200: 0.3376 - 17s/epoch - 43ms/step
Epoch 12/50
384/384 - 16s - loss: 3.2799 - accuracy200: 0.3665 - val_loss: 3.2943 - val_accuracy200: 0.3389 - 16s/epoch - 43ms/step
Epoch 13/50
384/384 - 17s - loss: 3.2778 - accuracy200: 0.3682 - val_loss: 3.2972 - val_accuracy200: 0.3402 - 17s/epoch - 43ms/step
Epoch 14/50
384/384 - 17s - loss: 3.2743 - accuracy200: 0.3726 - val_loss: 3.2951 - val_accuracy200: 0.3376 - 17s/epoch - 43ms/step
Epoch 15/50
384/384 - 17s - loss: 3.2731 - accuracy200: 0.3729 - val_loss: 3.2979 - val_accuracy200: 0.3437 - 17s/epoch - 43ms/step
Epoch 16/50
384/384 - 16s - loss: 3.2716 - accuracy200: 0.3758 - val_loss: 3.2977 - val_accuracy200: 0.3399 - 16s/epoch - 43ms/step
Epoch 17/50
384/384 - 16s - loss: 3.2690 - accuracy200: 0.3754 - val_loss: 3.2997 - val_accuracy200: 0.3325 - 16s/epoch - 43ms/step
Epoch 18/50
384/384 - 17s - loss: 3.2686 - accuracy200: 0.3753 - val_loss: 3.3007 - val_accuracy200: 0.3352 - 17s/epoch - 43ms/step
Epoch 19/50
384/384 - 16s - loss: 3.2651 - accuracy200: 0.3786 - val_loss: 3.3023 - val_accuracy200: 0.3432 - 16s/epoch - 42ms/step
Epoch 20/50
384/384 - 16s - loss: 3.2630 - accuracy200: 0.3785 - val_loss: 3.3060 - val_accuracy200: 0.3402 - 16s/epoch - 42ms/step
testing model: results/CHTR/W1/deepVOL_L3/h200
Evaluating performance on  test set...
1304/1304 - 28s - 28s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0993937
{'0': {'precision': 0.3467040312260961, 'recall': 0.4309669163711978, 'f1-score': 0.38427041075050716, 'support': 112533}, '1': {'precision': 0.33316077155285434, 'recall': 0.4638801778609876, 'f1-score': 0.3878010987463023, 'support': 106825}, '2': {'precision': 0.3378842616192735, 'recall': 0.1332802951487546, 'f1-score': 0.19115747764918306, 'support': 114383}, 'accuracy': 0.33947582107083035, 'macro avg': {'precision': 0.3392496881327413, 'recall': 0.34270912979364665, 'f1-score': 0.3210763290486642, 'support': 333741}, 'weighted avg': {'precision': 0.339346258517525, 'recall': 0.33947582107083035, 'f1-score': 0.3192149609203157, 'support': 333741}}
[[48498 48957 15078]
 [42475 49554 14796]
 [48910 50228 15245]]
Evaluating performance on  train set...
384/384 - 8s - 8s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0962044
{'0': {'precision': 0.3498971193415638, 'recall': 0.4170703292660494, 'f1-score': 0.3805421130660998, 'support': 32618}, '1': {'precision': 0.3512340425531915, 'recall': 0.5085957237044796, 'f1-score': 0.41551511490347104, 'support': 32458}, '2': {'precision': 0.36568009057092027, 'recall': 0.1363280072354537, 'f1-score': 0.19861208713984538, 'support': 33170}, 'accuracy': 0.3525232579443438, 'macro avg': {'precision': 0.3556037508218919, 'recall': 0.35399802006866093, 'f1-score': 0.33155643836980536, 'support': 98246}, 'weighted avg': {'precision': 0.35566748158817707, 'recall': 0.3525232579443438, 'f1-score': 0.3306727518062372, 'support': 98246}}
[[13604 15045  3969]
 [12075 16508  3875]
 [13201 15447  4522]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0982032
{'0': {'precision': 0.31229314420803783, 'recall': 0.36391184573002755, 'f1-score': 0.33613231552162853, 'support': 7260}, '1': {'precision': 0.36096760967609676, 'recall': 0.5421849981524818, 'f1-score': 0.4333956877030619, 'support': 8119}, '2': {'precision': 0.36012207527975587, 'recall': 0.12911854103343465, 'f1-score': 0.1900841238589583, 'support': 8225}, 'accuracy': 0.34341637010676157, 'macro avg': {'precision': 0.34446094305463015, 'recall': 0.3450717949719813, 'f1-score': 0.31987070902788295, 'support': 23604}, 'weighted avg': {'precision': 0.3457019284479993, 'recall': 0.34341637010676157, 'f1-score': 0.31869607345738493, 'support': 23604}}
[[2642 3727  891]
 [2721 4402  996]
 [3097 4066 1062]]
training model: results/CHTR/W1/deepVOL_L3/h300
Epoch 1/50
384/384 - 19s - loss: 3.3416 - accuracy300: 0.3500 - val_loss: 3.3124 - val_accuracy300: 0.3490 - 19s/epoch - 49ms/step
Epoch 2/50
384/384 - 15s - loss: 3.3127 - accuracy300: 0.3511 - val_loss: 3.2988 - val_accuracy300: 0.3466 - 15s/epoch - 40ms/step
Epoch 3/50
384/384 - 15s - loss: 3.3018 - accuracy300: 0.3466 - val_loss: 3.2875 - val_accuracy300: 0.3527 - 15s/epoch - 40ms/step
Epoch 4/50
384/384 - 15s - loss: 3.2974 - accuracy300: 0.3494 - val_loss: 3.2803 - val_accuracy300: 0.3604 - 15s/epoch - 40ms/step
Epoch 5/50
384/384 - 15s - loss: 3.2936 - accuracy300: 0.3514 - val_loss: 3.2772 - val_accuracy300: 0.3666 - 15s/epoch - 40ms/step
Epoch 6/50
384/384 - 17s - loss: 3.2902 - accuracy300: 0.3542 - val_loss: 3.2751 - val_accuracy300: 0.3690 - 17s/epoch - 43ms/step
Epoch 7/50
384/384 - 16s - loss: 3.2882 - accuracy300: 0.3552 - val_loss: 3.2727 - val_accuracy300: 0.3720 - 16s/epoch - 42ms/step
Epoch 8/50
384/384 - 16s - loss: 3.2866 - accuracy300: 0.3566 - val_loss: 3.2727 - val_accuracy300: 0.3702 - 16s/epoch - 41ms/step
Epoch 9/50
384/384 - 16s - loss: 3.2842 - accuracy300: 0.3591 - val_loss: 3.2720 - val_accuracy300: 0.3711 - 16s/epoch - 41ms/step
Epoch 10/50
384/384 - 16s - loss: 3.2819 - accuracy300: 0.3615 - val_loss: 3.2719 - val_accuracy300: 0.3691 - 16s/epoch - 41ms/step
Epoch 11/50
384/384 - 16s - loss: 3.2800 - accuracy300: 0.3624 - val_loss: 3.2735 - val_accuracy300: 0.3697 - 16s/epoch - 42ms/step
Epoch 12/50
384/384 - 16s - loss: 3.2799 - accuracy300: 0.3641 - val_loss: 3.2729 - val_accuracy300: 0.3704 - 16s/epoch - 42ms/step
Epoch 13/50
384/384 - 16s - loss: 3.2780 - accuracy300: 0.3631 - val_loss: 3.2736 - val_accuracy300: 0.3674 - 16s/epoch - 40ms/step
Epoch 14/50
384/384 - 16s - loss: 3.2772 - accuracy300: 0.3652 - val_loss: 3.2754 - val_accuracy300: 0.3688 - 16s/epoch - 42ms/step
Epoch 15/50
384/384 - 16s - loss: 3.2793 - accuracy300: 0.3693 - val_loss: 3.2663 - val_accuracy300: 0.3822 - 16s/epoch - 41ms/step
Epoch 16/50
384/384 - 16s - loss: 3.2758 - accuracy300: 0.3687 - val_loss: 3.2715 - val_accuracy300: 0.3772 - 16s/epoch - 41ms/step
Epoch 17/50
384/384 - 16s - loss: 3.2727 - accuracy300: 0.3702 - val_loss: 3.2701 - val_accuracy300: 0.3832 - 16s/epoch - 41ms/step
Epoch 18/50
384/384 - 16s - loss: 3.2733 - accuracy300: 0.3725 - val_loss: 3.2729 - val_accuracy300: 0.3726 - 16s/epoch - 41ms/step
Epoch 19/50
384/384 - 16s - loss: 3.2701 - accuracy300: 0.3722 - val_loss: 3.2790 - val_accuracy300: 0.3690 - 16s/epoch - 41ms/step
Epoch 20/50
384/384 - 15s - loss: 3.2712 - accuracy300: 0.3732 - val_loss: 3.2744 - val_accuracy300: 0.3719 - 15s/epoch - 40ms/step
Epoch 21/50
384/384 - 15s - loss: 3.2680 - accuracy300: 0.3744 - val_loss: 3.2750 - val_accuracy300: 0.3724 - 15s/epoch - 40ms/step
Epoch 22/50
384/384 - 15s - loss: 3.2642 - accuracy300: 0.3783 - val_loss: 3.2776 - val_accuracy300: 0.3659 - 15s/epoch - 40ms/step
Epoch 23/50
384/384 - 16s - loss: 3.2623 - accuracy300: 0.3783 - val_loss: 3.2776 - val_accuracy300: 0.3727 - 16s/epoch - 41ms/step
Epoch 24/50
384/384 - 16s - loss: 3.2589 - accuracy300: 0.3828 - val_loss: 3.2773 - val_accuracy300: 0.3693 - 16s/epoch - 42ms/step
Epoch 25/50
384/384 - 16s - loss: 3.2561 - accuracy300: 0.3855 - val_loss: 3.2775 - val_accuracy300: 0.3660 - 16s/epoch - 40ms/step
testing model: results/CHTR/W1/deepVOL_L3/h300
Evaluating performance on  test set...
1304/1304 - 27s - 27s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971369
{'0': {'precision': 0.34725405702759693, 'recall': 0.20470575518182554, 'f1-score': 0.25757275225978293, 'support': 111013}, '1': {'precision': 0.3561505951406448, 'recall': 0.5413206764665223, 'f1-score': 0.42963309731406163, 'support': 108505}, '2': {'precision': 0.3606597020700329, 'recall': 0.32642287455241065, 'f1-score': 0.34268829014305874, 'support': 114223}, 'accuracy': 0.3558028531106457, 'macro avg': {'precision': 0.35468811807942485, 'recall': 0.3574831020669195, 'f1-score': 0.34329804657230106, 'support': 333741}, 'weighted avg': {'precision': 0.354734563952543, 'recall': 0.3558028531106457, 'f1-score': 0.34264339034067776, 'support': 333741}}
[[22725 53018 35270]
 [18944 58736 30825]
 [23773 53165 37285]]
Evaluating performance on  train set...
384/384 - 8s - 8s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0949972
{'0': {'precision': 0.34507870707523386, 'recall': 0.19033494005685328, 'f1-score': 0.24534501642935375, 'support': 32364}, '1': {'precision': 0.35765637614855256, 'recall': 0.5724218557715973, 'f1-score': 0.44024323876676996, 'support': 32504}, '2': {'precision': 0.3707397878264547, 'recall': 0.31514770207921383, 'f1-score': 0.3406908390147528, 'support': 33378}, 'accuracy': 0.35914948191274965, 'macro avg': {'precision': 0.35782495701674705, 'recall': 0.3593014993025548, 'f1-score': 0.34209303140362546, 'support': 98246}, 'weighted avg': {'precision': 0.35795801115757203, 'recall': 0.35914948191274965, 'f1-score': 0.3422184228287066, 'support': 98246}}
[[ 6160 16853  9351]
 [ 5395 18606  8503]
 [ 6296 16563 10519]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0901091
{'0': {'precision': 0.3131768953068592, 'recall': 0.14931153184165233, 'f1-score': 0.20221445221445222, 'support': 6972}, '1': {'precision': 0.3926029309141661, 'recall': 0.6688064669519733, 'f1-score': 0.49476739073080644, 'support': 8412}, '2': {'precision': 0.38907563025210085, 'recall': 0.2816301703163017, 'f1-score': 0.3267466478475653, 'support': 8220}, 'accuracy': 0.38052872394509407, 'macro avg': {'precision': 0.3649518188243754, 'recall': 0.36658272303664247, 'f1-score': 0.34124283026427465, 'support': 23604}, 'weighted avg': {'precision': 0.36791420308429323, 'recall': 0.38052872394509407, 'f1-score': 0.3498423952285075, 'support': 23604}}
[[1041 4128 1803]
 [ 954 5626 1832]
 [1329 4576 2315]]
training model: results/CHTR/W1/deepVOL_L3/h500
Epoch 1/50
384/384 - 18s - loss: 3.3458 - accuracy500: 0.3548 - val_loss: 3.3067 - val_accuracy500: 0.3598 - 18s/epoch - 47ms/step
Epoch 2/50
384/384 - 17s - loss: 3.3135 - accuracy500: 0.3488 - val_loss: 3.2930 - val_accuracy500: 0.3535 - 17s/epoch - 44ms/step
Epoch 3/50
384/384 - 16s - loss: 3.3039 - accuracy500: 0.3403 - val_loss: 3.2881 - val_accuracy500: 0.3554 - 16s/epoch - 42ms/step
Epoch 4/50
384/384 - 16s - loss: 3.3000 - accuracy500: 0.3429 - val_loss: 3.2845 - val_accuracy500: 0.3608 - 16s/epoch - 42ms/step
Epoch 5/50
384/384 - 16s - loss: 3.2969 - accuracy500: 0.3424 - val_loss: 3.2827 - val_accuracy500: 0.3761 - 16s/epoch - 41ms/step
Epoch 6/50
384/384 - 17s - loss: 3.2946 - accuracy500: 0.3467 - val_loss: 3.2792 - val_accuracy500: 0.3805 - 17s/epoch - 44ms/step
Epoch 7/50
384/384 - 16s - loss: 3.2934 - accuracy500: 0.3468 - val_loss: 3.2768 - val_accuracy500: 0.3852 - 16s/epoch - 41ms/step
Epoch 8/50
384/384 - 16s - loss: 3.2918 - accuracy500: 0.3491 - val_loss: 3.2714 - val_accuracy500: 0.3993 - 16s/epoch - 41ms/step
Epoch 9/50
384/384 - 16s - loss: 3.2910 - accuracy500: 0.3531 - val_loss: 3.2735 - val_accuracy500: 0.3952 - 16s/epoch - 41ms/step
Epoch 10/50
384/384 - 17s - loss: 3.2901 - accuracy500: 0.3544 - val_loss: 3.2794 - val_accuracy500: 0.3822 - 17s/epoch - 43ms/step
Epoch 11/50
384/384 - 16s - loss: 3.2934 - accuracy500: 0.3523 - val_loss: 3.2856 - val_accuracy500: 0.3585 - 16s/epoch - 43ms/step
Epoch 12/50
384/384 - 16s - loss: 3.2952 - accuracy500: 0.3478 - val_loss: 3.2805 - val_accuracy500: 0.3762 - 16s/epoch - 41ms/step
Epoch 13/50
384/384 - 16s - loss: 3.2923 - accuracy500: 0.3505 - val_loss: 3.2753 - val_accuracy500: 0.3873 - 16s/epoch - 41ms/step
Epoch 14/50
384/384 - 16s - loss: 3.2908 - accuracy500: 0.3545 - val_loss: 3.2739 - val_accuracy500: 0.3893 - 16s/epoch - 41ms/step
Epoch 15/50
384/384 - 16s - loss: 3.2882 - accuracy500: 0.3557 - val_loss: 3.2683 - val_accuracy500: 0.3996 - 16s/epoch - 40ms/step
Epoch 16/50
384/384 - 16s - loss: 3.2875 - accuracy500: 0.3572 - val_loss: 3.2688 - val_accuracy500: 0.4001 - 16s/epoch - 41ms/step
Epoch 17/50
384/384 - 17s - loss: 3.2859 - accuracy500: 0.3605 - val_loss: 3.2686 - val_accuracy500: 0.3959 - 17s/epoch - 44ms/step
Epoch 18/50
384/384 - 16s - loss: 3.2852 - accuracy500: 0.3620 - val_loss: 3.2682 - val_accuracy500: 0.3933 - 16s/epoch - 41ms/step
Epoch 19/50
384/384 - 15s - loss: 3.2819 - accuracy500: 0.3636 - val_loss: 3.2694 - val_accuracy500: 0.3966 - 15s/epoch - 40ms/step
Epoch 20/50
384/384 - 15s - loss: 3.2812 - accuracy500: 0.3653 - val_loss: 3.2692 - val_accuracy500: 0.3896 - 15s/epoch - 40ms/step
Epoch 21/50
384/384 - 16s - loss: 3.2790 - accuracy500: 0.3665 - val_loss: 3.2715 - val_accuracy500: 0.3819 - 16s/epoch - 41ms/step
Epoch 22/50
384/384 - 16s - loss: 3.2758 - accuracy500: 0.3696 - val_loss: 3.2753 - val_accuracy500: 0.3736 - 16s/epoch - 41ms/step
Epoch 23/50
384/384 - 16s - loss: 3.2738 - accuracy500: 0.3733 - val_loss: 3.2745 - val_accuracy500: 0.3771 - 16s/epoch - 41ms/step
Epoch 24/50
384/384 - 17s - loss: 3.2713 - accuracy500: 0.3743 - val_loss: 3.2784 - val_accuracy500: 0.3693 - 17s/epoch - 43ms/step
Epoch 25/50
384/384 - 16s - loss: 3.2692 - accuracy500: 0.3756 - val_loss: 3.2820 - val_accuracy500: 0.3655 - 16s/epoch - 41ms/step
Epoch 26/50
384/384 - 16s - loss: 3.2692 - accuracy500: 0.3760 - val_loss: 3.2808 - val_accuracy500: 0.3704 - 16s/epoch - 40ms/step
Epoch 27/50
384/384 - 16s - loss: 3.2644 - accuracy500: 0.3798 - val_loss: 3.2759 - val_accuracy500: 0.3756 - 16s/epoch - 41ms/step
Epoch 28/50
384/384 - 15s - loss: 3.2620 - accuracy500: 0.3824 - val_loss: 3.2927 - val_accuracy500: 0.3577 - 15s/epoch - 40ms/step
testing model: results/CHTR/W1/deepVOL_L3/h500
Evaluating performance on  test set...
1304/1304 - 27s - 27s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097842
{'0': {'precision': 0.35378106821787414, 'recall': 0.06409664579177954, 'f1-score': 0.10853021856472879, 'support': 114811}, '1': {'precision': 0.34437384640247687, 'recall': 0.39177302768450695, 'f1-score': 0.3665474627676429, 'support': 103343}, '2': {'precision': 0.362219958745579, 'recall': 0.6122487823025081, 'f1-score': 0.4551582197067147, 'support': 115587}, 'accuracy': 0.3554073368270605, 'macro avg': {'precision': 0.35345829112197663, 'recall': 0.3560394852595982, 'f1-score': 0.31007863367969546, 'support': 333741}, 'weighted avg': {'precision': 0.3537908228340502, 'recall': 0.3554073368270605, 'f1-score': 0.30847558588747453, 'support': 333741}}
[[ 7359 39180 68272]
 [ 6523 40487 56333]
 [ 6919 37900 70768]]
Evaluating performance on  train set...
384/384 - 8s - 8s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0949323
{'0': {'precision': 0.36197848333770666, 'recall': 0.0858912894589378, 'f1-score': 0.13883856682769727, 'support': 32122}, '1': {'precision': 0.3698182293709952, 'recall': 0.4357607322259546, 'f1-score': 0.4000905438288722, 'support': 32449}, '2': {'precision': 0.3623852335413923, 'recall': 0.5637713437268003, 'f1-score': 0.4411833054471091, 'support': 33675}, 'accuracy': 0.3652464222461983, 'macro avg': {'precision': 0.36472731541669806, 'recall': 0.36180778847056416, 'f1-score': 0.32670413870122617, 'support': 98246}, 'weighted avg': {'precision': 0.36470723801620036, 'recall': 0.3652464222461983, 'f1-score': 0.32875799840475706, 'support': 98246}}
[[ 2759 11825 17538]
 [ 2443 14140 15866]
 [ 2420 12270 18985]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0899593
{'0': {'precision': 0.2955209347614411, 'recall': 0.08638110146577486, 'f1-score': 0.13368571743200086, 'support': 7027}, '1': {'precision': 0.4119088681129164, 'recall': 0.5398524863192957, 'f1-score': 0.4672810585388457, 'support': 8406}, '2': {'precision': 0.39333523212759897, 'recall': 0.5070370823644597, 'f1-score': 0.44300684345594527, 'support': 8171}, 'accuracy': 0.3934926283680732, 'macro avg': {'precision': 0.3669216783339855, 'recall': 0.37775689004984336, 'f1-score': 0.3479912064755973, 'support': 23604}, 'weighted avg': {'precision': 0.3708301023402996, 'recall': 0.3934926283680732, 'f1-score': 0.35956545637818743, 'support': 23604}}
[[ 607 3087 3333]
 [ 811 4538 3057]
 [ 636 3392 4143]]
training model: results/CHTR/W1/deepVOL_L3/h1000
Epoch 1/50
384/384 - 18s - loss: 3.3353 - accuracy1000: 0.3618 - val_loss: 3.2988 - val_accuracy1000: 0.3638 - 18s/epoch - 48ms/step
Epoch 2/50
384/384 - 16s - loss: 3.3200 - accuracy1000: 0.3472 - val_loss: 3.2933 - val_accuracy1000: 0.3457 - 16s/epoch - 42ms/step
Epoch 3/50
384/384 - 16s - loss: 3.3091 - accuracy1000: 0.3378 - val_loss: 3.3073 - val_accuracy1000: 0.3113 - 16s/epoch - 42ms/step
Epoch 4/50
384/384 - 16s - loss: 3.3010 - accuracy1000: 0.3366 - val_loss: 3.2843 - val_accuracy1000: 0.3361 - 16s/epoch - 41ms/step
Epoch 5/50
384/384 - 16s - loss: 3.2965 - accuracy1000: 0.3417 - val_loss: 3.2786 - val_accuracy1000: 0.3503 - 16s/epoch - 41ms/step
Epoch 6/50
384/384 - 16s - loss: 3.2943 - accuracy1000: 0.3463 - val_loss: 3.2782 - val_accuracy1000: 0.3577 - 16s/epoch - 41ms/step
Epoch 7/50
384/384 - 16s - loss: 3.2918 - accuracy1000: 0.3506 - val_loss: 3.2745 - val_accuracy1000: 0.3678 - 16s/epoch - 41ms/step
Epoch 8/50
384/384 - 16s - loss: 3.2910 - accuracy1000: 0.3521 - val_loss: 3.2701 - val_accuracy1000: 0.3746 - 16s/epoch - 40ms/step
Epoch 9/50
384/384 - 15s - loss: 3.2885 - accuracy1000: 0.3567 - val_loss: 3.2705 - val_accuracy1000: 0.3690 - 15s/epoch - 40ms/step
Epoch 10/50
384/384 - 16s - loss: 3.2877 - accuracy1000: 0.3579 - val_loss: 3.2701 - val_accuracy1000: 0.3767 - 16s/epoch - 41ms/step
Epoch 11/50
384/384 - 16s - loss: 3.2856 - accuracy1000: 0.3592 - val_loss: 3.2649 - val_accuracy1000: 0.3857 - 16s/epoch - 41ms/step
Epoch 12/50
384/384 - 16s - loss: 3.2874 - accuracy1000: 0.3541 - val_loss: 3.2727 - val_accuracy1000: 0.3699 - 16s/epoch - 41ms/step
Epoch 13/50
384/384 - 16s - loss: 3.2845 - accuracy1000: 0.3596 - val_loss: 3.2694 - val_accuracy1000: 0.3759 - 16s/epoch - 42ms/step
Epoch 14/50
384/384 - 16s - loss: 3.2814 - accuracy1000: 0.3631 - val_loss: 3.2661 - val_accuracy1000: 0.3807 - 16s/epoch - 40ms/step
Epoch 15/50
384/384 - 15s - loss: 3.2803 - accuracy1000: 0.3637 - val_loss: 3.2651 - val_accuracy1000: 0.3758 - 15s/epoch - 40ms/step
Epoch 16/50
384/384 - 15s - loss: 3.2794 - accuracy1000: 0.3616 - val_loss: 3.2693 - val_accuracy1000: 0.3674 - 15s/epoch - 40ms/step
Epoch 17/50
384/384 - 16s - loss: 3.2777 - accuracy1000: 0.3641 - val_loss: 3.2652 - val_accuracy1000: 0.3834 - 16s/epoch - 40ms/step
Epoch 18/50
384/384 - 16s - loss: 3.2751 - accuracy1000: 0.3687 - val_loss: 3.2662 - val_accuracy1000: 0.3820 - 16s/epoch - 41ms/step
Epoch 19/50
384/384 - 16s - loss: 3.2735 - accuracy1000: 0.3694 - val_loss: 3.2634 - val_accuracy1000: 0.3849 - 16s/epoch - 42ms/step
Epoch 20/50
384/384 - 16s - loss: 3.2712 - accuracy1000: 0.3726 - val_loss: 3.2669 - val_accuracy1000: 0.3762 - 16s/epoch - 41ms/step
Epoch 21/50
384/384 - 16s - loss: 3.2698 - accuracy1000: 0.3750 - val_loss: 3.2629 - val_accuracy1000: 0.3927 - 16s/epoch - 42ms/step
Epoch 22/50
384/384 - 16s - loss: 3.2659 - accuracy1000: 0.3772 - val_loss: 3.2686 - val_accuracy1000: 0.3777 - 16s/epoch - 41ms/step
Epoch 23/50
384/384 - 16s - loss: 3.2637 - accuracy1000: 0.3829 - val_loss: 3.2751 - val_accuracy1000: 0.3723 - 16s/epoch - 41ms/step
Epoch 24/50
384/384 - 16s - loss: 3.2614 - accuracy1000: 0.3795 - val_loss: 3.2683 - val_accuracy1000: 0.3847 - 16s/epoch - 41ms/step
Epoch 25/50
384/384 - 16s - loss: 3.2579 - accuracy1000: 0.3828 - val_loss: 3.2668 - val_accuracy1000: 0.3844 - 16s/epoch - 41ms/step
Epoch 26/50
384/384 - 16s - loss: 3.2562 - accuracy1000: 0.3854 - val_loss: 3.2761 - val_accuracy1000: 0.3762 - 16s/epoch - 41ms/step
Epoch 27/50
384/384 - 16s - loss: 3.2532 - accuracy1000: 0.3870 - val_loss: 3.2825 - val_accuracy1000: 0.3717 - 16s/epoch - 41ms/step
Epoch 28/50
384/384 - 16s - loss: 3.2475 - accuracy1000: 0.3923 - val_loss: 3.2861 - val_accuracy1000: 0.3582 - 16s/epoch - 41ms/step
Epoch 29/50
384/384 - 16s - loss: 3.2465 - accuracy1000: 0.3900 - val_loss: 3.2980 - val_accuracy1000: 0.3554 - 16s/epoch - 41ms/step
Epoch 30/50
384/384 - 16s - loss: 3.2442 - accuracy1000: 0.3909 - val_loss: 3.2951 - val_accuracy1000: 0.3563 - 16s/epoch - 41ms/step
Epoch 31/50
384/384 - 16s - loss: 3.2403 - accuracy1000: 0.3935 - val_loss: 3.2831 - val_accuracy1000: 0.3760 - 16s/epoch - 41ms/step
testing model: results/CHTR/W1/deepVOL_L3/h1000
Evaluating performance on  test set...
1304/1304 - 28s - 28s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984387
{'0': {'precision': 0.3429654537667332, 'recall': 0.3318198249032383, 'f1-score': 0.3373005915038537, 'support': 113423}, '1': {'precision': 0.3320139220637412, 'recall': 0.3800187470707702, 'f1-score': 0.3543981059916227, 'support': 102416}, '2': {'precision': 0.3712773927701817, 'recall': 0.33625383793319874, 'f1-score': 0.352898763585868, 'support': 117902}, 'accuracy': 0.3481771793097042, 'macro avg': {'precision': 0.3487522562002187, 'recall': 0.3493641366357358, 'f1-score': 0.34819915369378146, 'support': 333741}, 'weighted avg': {'precision': 0.3496065981316478, 'recall': 0.3481771793097042, 'f1-score': 0.3480577796485318, 'support': 333741}}
[[37636 40047 35740]
 [32101 38920 31395]
 [40000 38257 39645]]
Evaluating performance on  train set...
384/384 - 8s - 8s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0907942
{'0': {'precision': 0.34171264405340995, 'recall': 0.32464873918302783, 'f1-score': 0.33296220893243417, 'support': 32241}, '1': {'precision': 0.3868405978232568, 'recall': 0.4574058680459345, 'f1-score': 0.4191741786223144, 'support': 32481}, '2': {'precision': 0.37478174535245984, 'recall': 0.3265421787376208, 'f1-score': 0.3490029171249582, 'support': 33524}, 'accuracy': 0.36918551391405247, 'macro avg': {'precision': 0.3677783290763755, 'recall': 0.3695322619888611, 'f1-score': 0.3670464348932356, 'support': 98246}, 'weighted avg': {'precision': 0.3679163532970203, 'recall': 0.36918551391405247, 'f1-score': 0.36693814371800487, 'support': 98246}}
[[10467 11902  9872]
 [ 9234 14857  8390]
 [10930 11647 10947]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 25ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0884244
{'0': {'precision': 0.2972763850201176, 'recall': 0.2943159184924161, 'f1-score': 0.29578874432211877, 'support': 6527}, '1': {'precision': 0.44822433192686356, 'recall': 0.5700391280044718, 'f1-score': 0.5018453816249201, 'support': 8945}, '2': {'precision': 0.3924731182795699, 'recall': 0.2782833251352681, 'f1-score': 0.3256583681105195, 'support': 8132}, 'accuracy': 0.39328079986442976, 'macro avg': {'precision': 0.37932461174218374, 'recall': 0.38087945721071864, 'f1-score': 0.3744308313525195, 'support': 23604}, 'weighted avg': {'precision': 0.3872767756296206, 'recall': 0.39328079986442976, 'f1-score': 0.3841668328376599, 'support': 23604}}
[[1921 2920 1686]
 [2029 5099 1817]
 [2512 3357 2263]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        16 (peak)  12.49 (ave)

============================================
