This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/ATVI_orderbooks/ATVI_orderbooks_2019-02-06.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-01-29.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-01-16.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-01-17.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-01-25.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-01-23.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-01-18.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-02-08.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-01-22.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-02-04.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-01-24.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-01-15.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-01-31.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-01-30.csv
training model: results/ATVI/W0/deepLOB_L1/h10
Epoch 1/50
2538/2538 - 84s - loss: 3.0078 - accuracy10: 0.4370 - val_loss: 3.0905 - val_accuracy10: 0.3574 - 84s/epoch - 33ms/step
Epoch 2/50
2538/2538 - 65s - loss: 2.9223 - accuracy10: 0.4592 - val_loss: 3.0980 - val_accuracy10: 0.4754 - 65s/epoch - 26ms/step
Epoch 3/50
2538/2538 - 66s - loss: 2.8509 - accuracy10: 0.4964 - val_loss: 3.2337 - val_accuracy10: 0.5517 - 66s/epoch - 26ms/step
Epoch 4/50
2538/2538 - 65s - loss: 2.8034 - accuracy10: 0.5162 - val_loss: 3.2121 - val_accuracy10: 0.5764 - 65s/epoch - 25ms/step
Epoch 5/50
2538/2538 - 64s - loss: 2.7708 - accuracy10: 0.5291 - val_loss: 3.2467 - val_accuracy10: 0.5852 - 64s/epoch - 25ms/step
Epoch 6/50
2538/2538 - 65s - loss: 2.7487 - accuracy10: 0.5371 - val_loss: 3.3779 - val_accuracy10: 0.5985 - 65s/epoch - 25ms/step
Epoch 7/50
2538/2538 - 65s - loss: 2.7306 - accuracy10: 0.5440 - val_loss: 3.3421 - val_accuracy10: 0.5988 - 65s/epoch - 26ms/step
Epoch 8/50
2538/2538 - 65s - loss: 2.7179 - accuracy10: 0.5479 - val_loss: 3.3301 - val_accuracy10: 0.6023 - 65s/epoch - 26ms/step
Epoch 9/50
2538/2538 - 65s - loss: 2.7045 - accuracy10: 0.5515 - val_loss: 3.3514 - val_accuracy10: 0.6032 - 65s/epoch - 26ms/step
Epoch 10/50
2538/2538 - 65s - loss: 2.6960 - accuracy10: 0.5547 - val_loss: 3.3203 - val_accuracy10: 0.6025 - 65s/epoch - 26ms/step
Epoch 11/50
2538/2538 - 64s - loss: 2.6875 - accuracy10: 0.5566 - val_loss: 3.3349 - val_accuracy10: 0.6001 - 64s/epoch - 25ms/step
testing model: results/ATVI/W0/deepLOB_L1/h10
Evaluating performance on  test set...
11876/11876 - 181s - 181s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0755675
{'0': {'precision': 0.32222127029392145, 'recall': 0.6705017190882465, 'f1-score': 0.43526727590610936, 'support': 785300}, '1': {'precision': 0.6050023040117521, 'recall': 0.11964723866479109, 'f1-score': 0.1997844497175193, 'support': 1459457}, '2': {'precision': 0.3721136687840404, 'recall': 0.522764589478025, 'f1-score': 0.4347582422637943, 'support': 795402}, 'accuracy': 0.3674061126408191, 'macro avg': {'precision': 0.43311241436323805, 'recall': 0.4376378490770209, 'f1-score': 0.35660332262914096, 'support': 3040159}, 'weighted avg': {'precision': 0.4710264060353618, 'recall': 0.3674061126408191, 'f1-score': 0.32208834498904687, 'support': 3040159}}
[[526545  59606 199149]
 [782372 174620 502465]
 [325193  54401 415808]]
Evaluating performance on  train set...
2538/2538 - 40s - 40s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0602558
{'0': {'precision': 0.27849843982506256, 'recall': 0.5504285202202888, 'f1-score': 0.3698600516218739, 'support': 122748}, '1': {'precision': 0.7161377380178919, 'recall': 0.17806309228234207, 'f1-score': 0.2852104265855639, 'support': 402363}, '2': {'precision': 0.27571918600295137, 'recall': 0.6797629182260629, 'f1-score': 0.392312273895521, 'support': 124514}, 'accuracy': 0.344583413507793, 'macro avg': {'precision': 0.42345178794863525, 'recall': 0.4694181769095646, 'f1-score': 0.3491275840343196, 'support': 649625}, 'weighted avg': {'precision': 0.5490295999995556, 'recall': 0.344583413507793, 'f1-score': 0.3217334230680099, 'support': 649625}}
[[ 67564  14960  40224]
 [148602  71646 182115]
 [ 26435  13439  84640]]
Evaluating performance on  val set...
795/795 - 12s - 12s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0503343
{'0': {'precision': 0.2652819553324018, 'recall': 0.5831728015827563, 'f1-score': 0.36467524011069513, 'support': 38414}, '1': {'precision': 0.7225556044924025, 'recall': 0.2083005991350236, 'f1-score': 0.3233770473626827, 'support': 126015}, '2': {'precision': 0.2919862566236783, 'recall': 0.6187985539573879, 'f1-score': 0.3967582051766795, 'support': 39003}, 'accuracy': 0.3577903181407055, 'macro avg': {'precision': 0.4266079388161608, 'recall': 0.4700906515583893, 'f1-score': 0.3616034975500191, 'support': 203432}, 'weighted avg': {'precision': 0.5536578586424078, 'recall': 0.3577903181407055, 'f1-score': 0.34524437440288025, 'support': 203432}}
[[22402  5095 10917]
 [52160 26249 47606]
 [ 9884  4984 24135]]
training model: results/ATVI/W0/deepLOB_L1/h20
Epoch 1/50
2538/2538 - 66s - loss: 3.0791 - accuracy20: 0.4511 - val_loss: 3.3568 - val_accuracy20: 0.4102 - 66s/epoch - 26ms/step
Epoch 2/50
2538/2538 - 64s - loss: 3.0327 - accuracy20: 0.4580 - val_loss: 3.3267 - val_accuracy20: 0.4894 - 64s/epoch - 25ms/step
Epoch 3/50
2538/2538 - 64s - loss: 2.9821 - accuracy20: 0.4814 - val_loss: 3.2564 - val_accuracy20: 0.4872 - 64s/epoch - 25ms/step
Epoch 4/50
2538/2538 - 64s - loss: 2.9332 - accuracy20: 0.5016 - val_loss: 3.4112 - val_accuracy20: 0.5156 - 64s/epoch - 25ms/step
Epoch 5/50
2538/2538 - 65s - loss: 2.8894 - accuracy20: 0.5173 - val_loss: 3.4260 - val_accuracy20: 0.5202 - 65s/epoch - 25ms/step
Epoch 6/50
2538/2538 - 63s - loss: 2.8588 - accuracy20: 0.5276 - val_loss: 3.5032 - val_accuracy20: 0.5207 - 63s/epoch - 25ms/step
Epoch 7/50
2538/2538 - 63s - loss: 2.8391 - accuracy20: 0.5346 - val_loss: 3.6277 - val_accuracy20: 0.5230 - 63s/epoch - 25ms/step
Epoch 8/50
2538/2538 - 64s - loss: 2.8250 - accuracy20: 0.5388 - val_loss: 3.7172 - val_accuracy20: 0.5239 - 64s/epoch - 25ms/step
Epoch 9/50
2538/2538 - 63s - loss: 2.8129 - accuracy20: 0.5430 - val_loss: 3.6971 - val_accuracy20: 0.5244 - 63s/epoch - 25ms/step
Epoch 10/50
2538/2538 - 64s - loss: 2.8009 - accuracy20: 0.5467 - val_loss: 3.7533 - val_accuracy20: 0.5244 - 64s/epoch - 25ms/step
Epoch 11/50
2538/2538 - 65s - loss: 2.7911 - accuracy20: 0.5491 - val_loss: 3.7307 - val_accuracy20: 0.5243 - 65s/epoch - 25ms/step
Epoch 12/50
2538/2538 - 63s - loss: 2.7840 - accuracy20: 0.5507 - val_loss: 3.7822 - val_accuracy20: 0.5220 - 63s/epoch - 25ms/step
Epoch 13/50
2538/2538 - 64s - loss: 2.7752 - accuracy20: 0.5525 - val_loss: 3.7726 - val_accuracy20: 0.5221 - 64s/epoch - 25ms/step
testing model: results/ATVI/W0/deepLOB_L1/h20
Evaluating performance on  test set...
11876/11876 - 183s - 183s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1147087
{'0': {'precision': 0.4589025872032718, 'recall': 0.12627340652171698, 'f1-score': 0.19805047906671125, 'support': 981030}, '1': {'precision': 0.36069130200287647, 'recall': 0.8130026621041316, 'f1-score': 0.4996924201604027, 'support': 1066074}, '2': {'precision': 0.4654982288283039, 'recall': 0.17215964876064266, 'f1-score': 0.25135739521261813, 'support': 993055}, 'accuracy': 0.38207310867622385, 'macro avg': {'precision': 0.42836403934481737, 'recall': 0.37047857246216376, 'f1-score': 0.31636676481324405, 'support': 3040159}, 'weighted avg': {'precision': 0.4266178735534989, 'recall': 0.38207310867622385, 'f1-score': 0.3212378946995086, 'support': 3040159}}
[[123878 774750  82402]
 [ 85448 866721 113905]
 [ 60618 761473 170964]]
Evaluating performance on  train set...
2538/2538 - 41s - 41s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0190227
{'0': {'precision': 0.40403988221315285, 'recall': 0.1940634595701126, 'f1-score': 0.2621934099642547, 'support': 161205}, '1': {'precision': 0.5427523804179972, 'recall': 0.6845224176338105, 'f1-score': 0.6054490358801446, 'support': 325012}, '2': {'precision': 0.3752849836712059, 'recall': 0.3727173700186037, 'f1-score': 0.37399677001393933, 'support': 163408}, 'accuracy': 0.4843825283817587, 'macro avg': {'precision': 0.4406924154341187, 'recall': 0.417101082407509, 'f1-score': 0.4138797386194462, 'support': 649625}, 'weighted avg': {'precision': 0.46620566401897995, 'recall': 0.4843825283817587, 'f1-score': 0.4620498824663507, 'support': 649625}}
[[ 31284  96646  33275]
 [ 34424 222478  68110]
 [ 11720  90783  60905]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0058731
{'0': {'precision': 0.39135251479758176, 'recall': 0.24576608094140098, 'f1-score': 0.30192549541519637, 'support': 50308}, '1': {'precision': 0.5428890795594984, 'recall': 0.6779482743367181, 'f1-score': 0.6029479905230672, 'support': 101729}, '2': {'precision': 0.39384402482032055, 'recall': 0.34332133476019067, 'f1-score': 0.36685135711092864, 'support': 51395}, 'accuracy': 0.4865311258799009, 'macro avg': {'precision': 0.4426952063924669, 'recall': 0.4223452300127699, 'f1-score': 0.42390828101639744, 'support': 203432}, 'weighted avg': {'precision': 0.467759935234306, 'recall': 0.4865311258799009, 'f1-score': 0.4688588297317285, 'support': 203432}}
[[12364 29245  8699]
 [14304 68967 18458]
 [ 4925 28825 17645]]
training model: results/ATVI/W0/deepLOB_L1/h30
Epoch 1/50
2538/2538 - 68s - loss: 3.1177 - accuracy30: 0.4517 - val_loss: 3.2467 - val_accuracy30: 0.4376 - 68s/epoch - 27ms/step
Epoch 2/50
2538/2538 - 64s - loss: 3.0831 - accuracy30: 0.4587 - val_loss: 3.3529 - val_accuracy30: 0.4448 - 64s/epoch - 25ms/step
Epoch 3/50
2538/2538 - 64s - loss: 3.0371 - accuracy30: 0.4785 - val_loss: 3.3257 - val_accuracy30: 0.4595 - 64s/epoch - 25ms/step
Epoch 4/50
2538/2538 - 65s - loss: 2.9945 - accuracy30: 0.4935 - val_loss: 3.3262 - val_accuracy30: 0.4502 - 65s/epoch - 25ms/step
Epoch 5/50
2538/2538 - 65s - loss: 2.9590 - accuracy30: 0.5058 - val_loss: 3.3489 - val_accuracy30: 0.4560 - 65s/epoch - 26ms/step
Epoch 6/50
2538/2538 - 65s - loss: 2.9300 - accuracy30: 0.5165 - val_loss: 3.3829 - val_accuracy30: 0.4609 - 65s/epoch - 26ms/step
Epoch 7/50
2538/2538 - 65s - loss: 2.9084 - accuracy30: 0.5241 - val_loss: 3.4589 - val_accuracy30: 0.4574 - 65s/epoch - 26ms/step
Epoch 8/50
2538/2538 - 65s - loss: 2.8985 - accuracy30: 0.5266 - val_loss: 3.4017 - val_accuracy30: 0.4614 - 65s/epoch - 26ms/step
Epoch 9/50
2538/2538 - 65s - loss: 2.8859 - accuracy30: 0.5301 - val_loss: 3.4842 - val_accuracy30: 0.4548 - 65s/epoch - 26ms/step
Epoch 10/50
2538/2538 - 65s - loss: 2.8755 - accuracy30: 0.5333 - val_loss: 3.5077 - val_accuracy30: 0.4537 - 65s/epoch - 26ms/step
Epoch 11/50
2538/2538 - 65s - loss: 2.8664 - accuracy30: 0.5352 - val_loss: 3.5561 - val_accuracy30: 0.4511 - 65s/epoch - 25ms/step
testing model: results/ATVI/W0/deepLOB_L1/h30
Evaluating performance on  test set...
11876/11876 - 190s - 190s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.144561
{'0': {'precision': 0.5363873286479062, 'recall': 0.10483258524278771, 'f1-score': 0.1753871616757625, 'support': 1087658}, '1': {'precision': 0.28689039994150767, 'recall': 0.7418416770749264, 'f1-score': 0.41376614997085287, 'support': 846283}, '2': {'precision': 0.4621526284091887, 'recall': 0.26707032429412647, 'f1-score': 0.33851718979789547, 'support': 1106218}, 'accuracy': 0.34118873387872145, 'macro avg': {'precision': 0.42847678566620084, 'recall': 0.37124819553728017, 'f1-score': 0.3092235004815036, 'support': 3040159}, 'weighted avg': {'precision': 0.43992369929657593, 'recall': 0.34118873387872145, 'f1-score': 0.3011021189528469, 'support': 3040159}}
[[114022 792640 180996]
 [ 55644 627808 162831]
 [ 42908 767872 295438]]
Evaluating performance on  train set...
2538/2538 - 41s - 41s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0516756
{'0': {'precision': 0.44663460546141304, 'recall': 0.23243873226955117, 'f1-score': 0.3057554338035035, 'support': 186191}, '1': {'precision': 0.46333495494392557, 'recall': 0.5219898879544704, 'f1-score': 0.4909166006717824, 'support': 275513}, '2': {'precision': 0.38380182886570713, 'recall': 0.49493670212482904, 'f1-score': 0.43234160048529136, 'support': 187921}, 'accuracy': 0.431174908601116, 'macro avg': {'precision': 0.4312571297570152, 'recall': 0.41645510744961683, 'f1-score': 0.4096712116535257, 'support': 649625}, 'weighted avg': {'precision': 0.43554138271957554, 'recall': 0.431174908601116, 'f1-score': 0.4209026458048711, 'support': 649625}}
[[ 43278  87462  55451]
 [ 37822 143815  93876]
 [ 15798  79114  93009]]
Evaluating performance on  val set...
795/795 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0551256
{'0': {'precision': 0.4292400070642256, 'recall': 0.25136602602775143, 'f1-score': 0.31705964843622614, 'support': 58015}, '1': {'precision': 0.4587037871334921, 'recall': 0.5799881421546402, 'f1-score': 0.5122649936852481, 'support': 86019}, '2': {'precision': 0.4031304061290057, 'recall': 0.4119330617192498, 'f1-score': 0.40748419974519745, 'support': 59398}, 'accuracy': 0.43720260332691024, 'macro avg': {'precision': 0.4303580667755745, 'recall': 0.4144290766338805, 'f1-score': 0.4122696139555573, 'support': 203432}, 'weighted avg': {'precision': 0.43407497315327764, 'recall': 0.43720260332691024, 'f1-score': 0.4260022242926593, 'support': 203432}}
[[14583 29981 13451]
 [13353 49890 22776]
 [ 6038 28892 24468]]
training model: results/ATVI/W0/deepLOB_L1/h50
Epoch 1/50
2538/2538 - 67s - loss: 3.1766 - accuracy50: 0.4354 - val_loss: 3.2968 - val_accuracy50: 0.3646 - 67s/epoch - 26ms/step
Epoch 2/50
2538/2538 - 66s - loss: 3.1921 - accuracy50: 0.4243 - val_loss: 3.2865 - val_accuracy50: 0.3775 - 66s/epoch - 26ms/step
Epoch 3/50
2538/2538 - 64s - loss: 3.1668 - accuracy50: 0.4381 - val_loss: 3.3450 - val_accuracy50: 0.3876 - 64s/epoch - 25ms/step
Epoch 4/50
2538/2538 - 65s - loss: 3.1266 - accuracy50: 0.4591 - val_loss: 3.3555 - val_accuracy50: 0.3813 - 65s/epoch - 26ms/step
Epoch 5/50
2538/2538 - 65s - loss: 3.0908 - accuracy50: 0.4717 - val_loss: 3.6370 - val_accuracy50: 0.3482 - 65s/epoch - 25ms/step
Epoch 6/50
2538/2538 - 65s - loss: 3.0620 - accuracy50: 0.4810 - val_loss: 3.5714 - val_accuracy50: 0.3516 - 65s/epoch - 26ms/step
Epoch 7/50
2538/2538 - 66s - loss: 3.0379 - accuracy50: 0.4867 - val_loss: 3.5832 - val_accuracy50: 0.3457 - 66s/epoch - 26ms/step
Epoch 8/50
2538/2538 - 65s - loss: 3.0211 - accuracy50: 0.4916 - val_loss: 3.5612 - val_accuracy50: 0.3445 - 65s/epoch - 25ms/step
Epoch 9/50
2538/2538 - 68s - loss: 3.0077 - accuracy50: 0.4945 - val_loss: 3.5622 - val_accuracy50: 0.3490 - 68s/epoch - 27ms/step
Epoch 10/50
2538/2538 - 65s - loss: 2.9999 - accuracy50: 0.4966 - val_loss: 3.5684 - val_accuracy50: 0.3492 - 65s/epoch - 26ms/step
Epoch 11/50
2538/2538 - 64s - loss: 2.9893 - accuracy50: 0.4993 - val_loss: 3.5613 - val_accuracy50: 0.3519 - 64s/epoch - 25ms/step
Epoch 12/50
2538/2538 - 65s - loss: 2.9815 - accuracy50: 0.5008 - val_loss: 3.5765 - val_accuracy50: 0.3515 - 65s/epoch - 25ms/step
testing model: results/ATVI/W0/deepLOB_L1/h50
Evaluating performance on  test set...
11876/11876 - 192s - 192s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.144537
{'0': {'precision': 0.4744705443106352, 'recall': 0.19913100590275867, 'f1-score': 0.2805272545167832, 'support': 1199778}, '1': {'precision': 0.18566358692662288, 'recall': 0.5879083495758325, 'f1-score': 0.28220561738543243, 'support': 608486}, '2': {'precision': 0.4653489375029721, 'recall': 0.2303662243941245, 'f1-score': 0.30817404486646266, 'support': 1231895}, 'accuracy': 0.2896013004582984, 'macro avg': {'precision': 0.3751610229134101, 'recall': 0.33913519329090525, 'f1-score': 0.29030230558955944, 'support': 3040159}, 'weighted avg': {'precision': 0.41296986224463333, 'recall': 0.2896013004582984, 'f1-score': 0.2920658625653462, 'support': 3040159}}
[[238913 768118 192747]
 [117449 357734 133303]
 [147174 800934 283787]]
Evaluating performance on  train set...
2538/2538 - 40s - 40s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1015832
{'0': {'precision': 0.4212482165964365, 'recall': 0.2916877268758903, 'f1-score': 0.34469558134799433, 'support': 217630}, '1': {'precision': 0.32399760957010704, 'recall': 0.4343257361036284, 'f1-score': 0.3711358777892537, 'support': 213455}, '2': {'precision': 0.4125730183421136, 'recall': 0.40171593300997527, 'f1-score': 0.40707209577839654, 'support': 218540}, 'accuracy': 0.3755705214546854, 'macro avg': {'precision': 0.385939614836219, 'recall': 0.3759097986631647, 'f1-score': 0.37430118497188153, 'support': 649625}, 'weighted avg': {'precision': 0.3863750110558479, 'recall': 0.3755705214546854, 'f1-score': 0.3743674334788223, 'support': 649625}}
[[63480 99387 54763]
 [50511 92709 70235]
 [36704 94045 87791]]
Evaluating performance on  val set...
795/795 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0961766
{'0': {'precision': 0.4346362689675692, 'recall': 0.3466364121729845, 'f1-score': 0.385680340582819, 'support': 67428}, '1': {'precision': 0.3167991038610985, 'recall': 0.40733961471523733, 'f1-score': 0.35640912879956416, 'support': 66652}, '2': {'precision': 0.41199280744273314, 'recall': 0.3799313646325989, 'f1-score': 0.3953130743321806, 'support': 69352}, 'accuracy': 0.37787565378111604, 'macro avg': {'precision': 0.3878093934238003, 'recall': 0.3779691305069403, 'f1-score': 0.37913418123818793, 'support': 203432}, 'weighted avg': {'precision': 0.38830898480211384, 'recall': 0.37787565378111604, 'f1-score': 0.37937388212597944, 'support': 203432}}
[[23373 28762 15293]
 [17189 27150 22313]
 [13214 29789 26349]]
training model: results/ATVI/W0/deepLOB_L1/h100
Epoch 1/50
2538/2538 - 69s - loss: 3.2435 - accuracy100: 0.4031 - val_loss: 3.3404 - val_accuracy100: 0.3496 - 69s/epoch - 27ms/step
Epoch 2/50
2538/2538 - 67s - loss: 3.2232 - accuracy100: 0.4110 - val_loss: 3.3948 - val_accuracy100: 0.3456 - 67s/epoch - 26ms/step
Epoch 3/50
2538/2538 - 65s - loss: 3.2056 - accuracy100: 0.4226 - val_loss: 3.4212 - val_accuracy100: 0.3395 - 65s/epoch - 26ms/step
Epoch 4/50
2538/2538 - 64s - loss: 3.1937 - accuracy100: 0.4270 - val_loss: 3.4701 - val_accuracy100: 0.3392 - 64s/epoch - 25ms/step
Epoch 5/50
2538/2538 - 66s - loss: 3.1869 - accuracy100: 0.4301 - val_loss: 3.5069 - val_accuracy100: 0.3387 - 66s/epoch - 26ms/step
Epoch 6/50
2538/2538 - 66s - loss: 3.1817 - accuracy100: 0.4313 - val_loss: 3.5369 - val_accuracy100: 0.3348 - 66s/epoch - 26ms/step
Epoch 7/50
2538/2538 - 65s - loss: 3.1771 - accuracy100: 0.4343 - val_loss: 3.5487 - val_accuracy100: 0.3334 - 65s/epoch - 26ms/step
Epoch 8/50
2538/2538 - 66s - loss: 3.1725 - accuracy100: 0.4357 - val_loss: 3.5685 - val_accuracy100: 0.3327 - 66s/epoch - 26ms/step
Epoch 9/50
2538/2538 - 66s - loss: 3.1700 - accuracy100: 0.4369 - val_loss: 3.5765 - val_accuracy100: 0.3340 - 66s/epoch - 26ms/step
Epoch 10/50
2538/2538 - 65s - loss: 3.1670 - accuracy100: 0.4384 - val_loss: 3.5538 - val_accuracy100: 0.3316 - 65s/epoch - 26ms/step
Epoch 11/50
2538/2538 - 66s - loss: 3.1652 - accuracy100: 0.4385 - val_loss: 3.5786 - val_accuracy100: 0.3307 - 66s/epoch - 26ms/step
testing model: results/ATVI/W0/deepLOB_L1/h100
Evaluating performance on  test set...
11876/11876 - 188s - 188s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1482028
{'0': {'precision': 0.4052991119352006, 'recall': 0.035784447194008556, 'f1-score': 0.06576261739365888, 'support': 1160588}, '1': {'precision': 0.22732857043715735, 'recall': 0.6968380685166606, 'f1-score': 0.34281956362633514, 'support': 695714}, '2': {'precision': 0.40028170658545037, 'recall': 0.2722153097882599, 'f1-score': 0.3240544005631112, 'support': 1183857}, 'accuracy': 0.27912849295053316, 'macro avg': {'precision': 0.34430312965260274, 'recall': 0.3349459418329763, 'f1-score': 0.24421219386103507, 'support': 3040159}, 'weighted avg': {'precision': 0.36261828907267635, 'recall': 0.27912849295053316, 'f1-score': 0.22974513667602486, 'support': 3040159}}
[[ 41531 823360 295697]
 [ 23782 484800 187132]
 [ 37157 824436 322264]]
Evaluating performance on  train set...
2538/2538 - 41s - 41s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1228087
{'0': {'precision': 0.4076256238976245, 'recall': 0.048828511319295845, 'f1-score': 0.0872103059426172, 'support': 222452}, '1': {'precision': 0.32664045759022725, 'recall': 0.6492853754713456, 'f1-score': 0.4346290772635428, 'support': 208711}, '2': {'precision': 0.373972293365496, 'recall': 0.35624959947267715, 'f1-score': 0.364895878997869, 'support': 218462}, 'accuracy': 0.34512526457571674, 'macro avg': {'precision': 0.36941279161778257, 'recall': 0.35145449542110624, 'f1-score': 0.29557842073467633, 'support': 649625}, 'weighted avg': {'precision': 0.3702895162356764, 'recall': 0.34512526457571674, 'f1-score': 0.2922114448180579, 'support': 649625}}
[[ 10862 145932  65658]
 [  8574 135513  64624]
 [  7211 133424  77827]]
Evaluating performance on  val set...
795/795 - 15s - 15s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1177262
{'0': {'precision': 0.4308936097015567, 'recall': 0.07287802749290857, 'f1-score': 0.12467028318319812, 'support': 68745}, '1': {'precision': 0.32517071423565963, 'recall': 0.6385626911314984, 'f1-score': 0.43091146411048803, 'support': 65400}, '2': {'precision': 0.38261747719885125, 'recall': 0.3499646398314258, 'f1-score': 0.36556335320855404, 'support': 69287}, 'accuracy': 0.34910928467497737, 'macro avg': {'precision': 0.37956060037868916, 'recall': 0.35380178615194424, 'f1-score': 0.30704836683408004, 'support': 203432}, 'weighted avg': {'precision': 0.380463068999088, 'recall': 0.34910928467497737, 'f1-score': 0.3051676060011009, 'support': 203432}}
[[ 5010 44779 18956]
 [ 3468 41762 20170]
 [ 3149 41890 24248]]
training model: results/ATVI/W0/deepLOB_L1/h200
Epoch 1/50
2538/2538 - 69s - loss: 3.2734 - accuracy200: 0.3834 - val_loss: 3.3757 - val_accuracy200: 0.3561 - 69s/epoch - 27ms/step
Epoch 2/50
2538/2538 - 66s - loss: 3.2559 - accuracy200: 0.3904 - val_loss: 3.3630 - val_accuracy200: 0.3600 - 66s/epoch - 26ms/step
Epoch 3/50
2538/2538 - 68s - loss: 3.2461 - accuracy200: 0.3989 - val_loss: 3.3903 - val_accuracy200: 0.3545 - 68s/epoch - 27ms/step
Epoch 4/50
2538/2538 - 65s - loss: 3.2355 - accuracy200: 0.4045 - val_loss: 3.4445 - val_accuracy200: 0.3483 - 65s/epoch - 26ms/step
Epoch 5/50
2538/2538 - 66s - loss: 3.2292 - accuracy200: 0.4084 - val_loss: 3.4356 - val_accuracy200: 0.3462 - 66s/epoch - 26ms/step
Epoch 6/50
2538/2538 - 65s - loss: 3.2231 - accuracy200: 0.4114 - val_loss: 3.4525 - val_accuracy200: 0.3482 - 65s/epoch - 26ms/step
Epoch 7/50
2538/2538 - 66s - loss: 3.2207 - accuracy200: 0.4120 - val_loss: 3.4609 - val_accuracy200: 0.3448 - 66s/epoch - 26ms/step
Epoch 8/50
2538/2538 - 66s - loss: 3.2183 - accuracy200: 0.4133 - val_loss: 3.4755 - val_accuracy200: 0.3504 - 66s/epoch - 26ms/step
Epoch 9/50
2538/2538 - 66s - loss: 3.2142 - accuracy200: 0.4152 - val_loss: 3.5007 - val_accuracy200: 0.3451 - 66s/epoch - 26ms/step
Epoch 10/50
2538/2538 - 65s - loss: 3.2111 - accuracy200: 0.4171 - val_loss: 3.4936 - val_accuracy200: 0.3452 - 65s/epoch - 26ms/step
Epoch 11/50
2538/2538 - 66s - loss: 3.2081 - accuracy200: 0.4180 - val_loss: 3.4778 - val_accuracy200: 0.3443 - 66s/epoch - 26ms/step
Epoch 12/50
2538/2538 - 66s - loss: 3.2064 - accuracy200: 0.4193 - val_loss: 3.4894 - val_accuracy200: 0.3452 - 66s/epoch - 26ms/step
testing model: results/ATVI/W0/deepLOB_L1/h200
Evaluating performance on  test set...
11876/11876 - 193s - 193s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1757985
{'0': {'precision': 0.36603346761260314, 'recall': 0.45930479956029147, 'f1-score': 0.4073988452033004, 'support': 1128020}, '1': {'precision': 0.24507177626887422, 'recall': 0.3181470569294178, 'f1-score': 0.27686881105751887, 'support': 745344}, '2': {'precision': 0.38672461730209967, 'recall': 0.2177940426553079, 'f1-score': 0.27865580791992567, 'support': 1166795}, 'accuracy': 0.33200730619681407, 'macro avg': {'precision': 0.332609953727859, 'recall': 0.33174863304833907, 'f1-score': 0.3209744880602483, 'support': 3040159}, 'weighted avg': {'precision': 0.3443188991078163, 'recall': 0.33200730619681407, 'f1-score': 0.32598648816624787, 'support': 3040159}}
[[518105 370746 239169]
 [344394 237129 163821]
 [552959 359715 254121]]
Evaluating performance on  train set...
2538/2538 - 40s - 40s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.129406
{'0': {'precision': 0.3465747367839279, 'recall': 0.23213715554938572, 'f1-score': 0.2780411968308425, 'support': 216105}, '1': {'precision': 0.3400389929523588, 'recall': 0.43665396003295875, 'f1-score': 0.38233737609583707, 'support': 220882}, '2': {'precision': 0.3371422372489107, 'recall': 0.35077455581786887, 'f1-score': 0.3438233219782702, 'support': 212638}, 'accuracy': 0.34050875505099093, 'macro avg': {'precision': 0.34125198899506576, 'recall': 0.3398552238000711, 'f1-score': 0.3347339649683166, 'support': 649625}, 'weighted avg': {'precision': 0.34126500269867616, 'recall': 0.34050875505099093, 'f1-score': 0.3350355061562368, 'support': 649625}}
[[50166 94696 71243]
 [49028 96449 75405]
 [45554 92496 74588]]
Evaluating performance on  val set...
795/795 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1201174
{'0': {'precision': 0.35544574113702043, 'recall': 0.2424826174638052, 'f1-score': 0.288293446656229, 'support': 66446}, '1': {'precision': 0.3674076434812631, 'recall': 0.39634425853770344, 'f1-score': 0.38132778367352566, 'support': 69808}, '2': {'precision': 0.35556843846999286, 'recall': 0.43823870910119384, 'f1-score': 0.39259876646107683, 'support': 67178}, 'accuracy': 0.3599237091509694, 'macro avg': {'precision': 0.3594739410294254, 'recall': 0.35902186170090084, 'f1-score': 0.3540733322636105, 'support': 203432}, 'weighted avg': {'precision': 0.3595910036339792, 'recall': 0.3599237091509694, 'f1-score': 0.35466237471255013, 'support': 203432}}
[[16112 24305 26029]
 [14812 27668 27328]
 [14405 23333 29440]]
training model: results/ATVI/W0/deepLOB_L1/h300
Epoch 1/50
2538/2538 - 67s - loss: 3.2855 - accuracy300: 0.3757 - val_loss: 3.3301 - val_accuracy300: 0.3512 - 67s/epoch - 26ms/step
Epoch 2/50
2538/2538 - 65s - loss: 3.2705 - accuracy300: 0.3839 - val_loss: 3.3702 - val_accuracy300: 0.3453 - 65s/epoch - 25ms/step
Epoch 3/50
2538/2538 - 64s - loss: 3.2580 - accuracy300: 0.3946 - val_loss: 3.3825 - val_accuracy300: 0.3530 - 64s/epoch - 25ms/step
Epoch 4/50
2538/2538 - 65s - loss: 3.2451 - accuracy300: 0.4031 - val_loss: 3.4124 - val_accuracy300: 0.3588 - 65s/epoch - 26ms/step
Epoch 5/50
2538/2538 - 65s - loss: 3.2384 - accuracy300: 0.4067 - val_loss: 3.4181 - val_accuracy300: 0.3574 - 65s/epoch - 25ms/step
Epoch 6/50
2538/2538 - 64s - loss: 3.2327 - accuracy300: 0.4091 - val_loss: 3.4346 - val_accuracy300: 0.3519 - 64s/epoch - 25ms/step
Epoch 7/50
2538/2538 - 64s - loss: 3.2262 - accuracy300: 0.4133 - val_loss: 3.4534 - val_accuracy300: 0.3488 - 64s/epoch - 25ms/step
Epoch 8/50
2538/2538 - 65s - loss: 3.2215 - accuracy300: 0.4153 - val_loss: 3.5041 - val_accuracy300: 0.3457 - 65s/epoch - 26ms/step
Epoch 9/50
2538/2538 - 65s - loss: 3.2160 - accuracy300: 0.4186 - val_loss: 3.4963 - val_accuracy300: 0.3495 - 65s/epoch - 26ms/step
Epoch 10/50
2538/2538 - 65s - loss: 3.2146 - accuracy300: 0.4186 - val_loss: 3.5135 - val_accuracy300: 0.3473 - 65s/epoch - 26ms/step
Epoch 11/50
2538/2538 - 65s - loss: 3.2101 - accuracy300: 0.4209 - val_loss: 3.5438 - val_accuracy300: 0.3444 - 65s/epoch - 26ms/step
testing model: results/ATVI/W0/deepLOB_L1/h300
Evaluating performance on  test set...
11876/11876 - 174s - 174s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1415862
{'0': {'precision': 0.3722924521327715, 'recall': 0.12527763858829885, 'f1-score': 0.18747075090406295, 'support': 1125564}, '1': {'precision': 0.24863076035361983, 'recall': 0.6733111642504858, 'f1-score': 0.3631592451857868, 'support': 749392}, '2': {'precision': 0.39118691375840203, 'recall': 0.2121750458932907, 'f1-score': 0.2751254037541836, 'support': 1165203}, 'accuracy': 0.293671811244083, 'macro avg': {'precision': 0.33737004208159777, 'recall': 0.3369212829106918, 'f1-score': 0.27525179994801113, 'support': 3040159}, 'weighted avg': {'precision': 0.34905182585099065, 'recall': 0.293671811244083, 'f1-score': 0.26437298416610244, 'support': 3040159}}
[[141008 759129 225427]
 [ 85480 504574 159338]
 [152268 765708 247227]]
Evaluating performance on  train set...
2538/2538 - 39s - 39s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.111021
{'0': {'precision': 0.35290148448043185, 'recall': 0.058930639876324534, 'f1-score': 0.10099605671227904, 'support': 221871}, '1': {'precision': 0.32246789097154177, 'recall': 0.5838758447678051, 'f1-score': 0.4154741845220823, 'support': 209673}, '2': {'precision': 0.3522545303115515, 'recall': 0.3762409380001009, 'f1-score': 0.36385284648745486, 'support': 218081}, 'accuracy': 0.3348839715220319, 'macro avg': {'precision': 0.3425413019211751, 'recall': 0.3396824742147435, 'f1-score': 0.2934410292406054, 'support': 649625}, 'weighted avg': {'precision': 0.3428615518055916, 'recall': 0.3348839715220319, 'f1-score': 0.29073882225120534, 'support': 649625}}
[[ 13075 133689  75107]
 [ 11477 122423  75773]
 [ 12498 123532  82051]]
Evaluating performance on  val set...
795/795 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1114835
{'0': {'precision': 0.3091617933723197, 'recall': 0.04631535911924891, 'f1-score': 0.0805617991796513, 'support': 68487}, '1': {'precision': 0.33867345092236784, 'recall': 0.48480046322397796, 'f1-score': 0.3987716989409037, 'support': 65627}, '2': {'precision': 0.3663949047153554, 'recall': 0.5244958019562018, 'f1-score': 0.43141675615703634, 'support': 69318}, 'accuracy': 0.35070687010893076, 'macro avg': {'precision': 0.33807671633668096, 'recall': 0.3518705414331429, 'f1-score': 0.3035834180925305, 'support': 203432}, 'weighted avg': {'precision': 0.33818400404769805, 'recall': 0.35070687010893076, 'f1-score': 0.3027673764702943, 'support': 203432}}
[[ 3172 32881 32434]
 [ 3373 31816 30438]
 [ 3715 29246 36357]]
training model: results/ATVI/W0/deepLOB_L1/h500
Epoch 1/50
2538/2538 - 70s - loss: 3.2459 - accuracy500: 0.4059 - val_loss: 3.3052 - val_accuracy500: 0.3783 - 70s/epoch - 28ms/step
Epoch 2/50
2538/2538 - 64s - loss: 3.2366 - accuracy500: 0.4069 - val_loss: 3.3583 - val_accuracy500: 0.3489 - 64s/epoch - 25ms/step
Epoch 3/50
2538/2538 - 65s - loss: 3.2016 - accuracy500: 0.4284 - val_loss: 3.3784 - val_accuracy500: 0.3434 - 65s/epoch - 26ms/step
Epoch 4/50
2538/2538 - 66s - loss: 3.1904 - accuracy500: 0.4322 - val_loss: 3.4391 - val_accuracy500: 0.3430 - 66s/epoch - 26ms/step
Epoch 5/50
2538/2538 - 66s - loss: 3.1753 - accuracy500: 0.4387 - val_loss: 3.4460 - val_accuracy500: 0.3559 - 66s/epoch - 26ms/step
Epoch 6/50
2538/2538 - 65s - loss: 3.1719 - accuracy500: 0.4405 - val_loss: 3.4318 - val_accuracy500: 0.3607 - 65s/epoch - 26ms/step
Epoch 7/50
2538/2538 - 66s - loss: 3.1650 - accuracy500: 0.4438 - val_loss: 3.4151 - val_accuracy500: 0.3608 - 66s/epoch - 26ms/step
Epoch 8/50
2538/2538 - 66s - loss: 3.1597 - accuracy500: 0.4468 - val_loss: 3.3923 - val_accuracy500: 0.3705 - 66s/epoch - 26ms/step
Epoch 9/50
2538/2538 - 66s - loss: 3.1520 - accuracy500: 0.4491 - val_loss: 3.4396 - val_accuracy500: 0.3404 - 66s/epoch - 26ms/step
Epoch 10/50
2538/2538 - 66s - loss: 3.1451 - accuracy500: 0.4516 - val_loss: 3.4389 - val_accuracy500: 0.3513 - 66s/epoch - 26ms/step
Epoch 11/50
2538/2538 - 66s - loss: 3.1409 - accuracy500: 0.4529 - val_loss: 3.4589 - val_accuracy500: 0.3476 - 66s/epoch - 26ms/step
testing model: results/ATVI/W0/deepLOB_L1/h500
Evaluating performance on  test set...
11876/11876 - 180s - 180s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1757122
{'0': {'precision': 0.3773576872312343, 'recall': 0.01491915494593637, 'f1-score': 0.028703493046373967, 'support': 1188137}, '1': {'precision': 0.19948293587865185, 'recall': 0.6070657380942797, 'f1-score': 0.3002900125292422, 'support': 621025}, '2': {'precision': 0.39358950188709346, 'recall': 0.3527555306796036, 'f1-score': 0.37205546375950455, 'support': 1230997}, 'accuracy': 0.27267323847206676, 'macro avg': {'precision': 0.3234767083323265, 'recall': 0.3249134745732732, 'f1-score': 0.23368298977837357, 'support': 3040159}, 'weighted avg': {'precision': 0.34759498326975763, 'recall': 0.27267323847206676, 'f1-score': 0.22320886732245615, 'support': 3040159}}
[[ 17726 735462 434949]
 [  9928 377003 234094]
 [ 19320 777436 434241]]
Evaluating performance on  train set...
2538/2538 - 39s - 39s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1114168
{'0': {'precision': 0.30136497212380875, 'recall': 0.05033994256301095, 'f1-score': 0.08626945347479648, 'support': 217978}, '1': {'precision': 0.3736547624830534, 'recall': 0.3894048451824307, 'f1-score': 0.38136725748475997, 'support': 217288}, '2': {'precision': 0.34598349910928283, 'recall': 0.6242565042755378, 'f1-score': 0.4452144808243197, 'support': 214359}, 'accuracy': 0.35312834327496634, 'macro avg': {'precision': 0.340334411238715, 'recall': 0.3546670973403265, 'f1-score': 0.3042837305946254, 'support': 649625}, 'weighted avg': {'precision': 0.3402675494471242, 'recall': 0.35312834327496634, 'f1-score': 0.3034167442276668, 'support': 649625}}
[[ 10973  71836 135169]
 [ 14892  84613 117783]
 [ 10546  69998 133815]]
Evaluating performance on  val set...
795/795 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1024998
{'0': {'precision': 0.36153032779006056, 'recall': 0.05477397180473028, 'f1-score': 0.09513450617830449, 'support': 68664}, '1': {'precision': 0.41049519586104954, 'recall': 0.38257129299392306, 'f1-score': 0.396041643557767, 'support': 65329}, '2': {'precision': 0.36408766194454534, 'recall': 0.6928671207822693, 'f1-score': 0.4773418393416111, 'support': 69439}, 'accuracy': 0.37784615989618153, 'macro avg': {'precision': 0.3787043951985518, 'recall': 0.3767374618603075, 'f1-score': 0.32283932969256085, 'support': 203432}, 'weighted avg': {'precision': 0.37812754254763514, 'recall': 0.37784615989618153, 'f1-score': 0.3222278709655049, 'support': 203432}}
[[ 3761 17765 47138]
 [ 3442 24993 36894]
 [ 3200 18127 48112]]
training model: results/ATVI/W0/deepLOB_L1/h1000
Epoch 1/50
2538/2538 - 68s - loss: 3.2577 - accuracy1000: 0.4026 - val_loss: 3.4750 - val_accuracy1000: 0.3321 - 68s/epoch - 27ms/step
Epoch 2/50
2538/2538 - 65s - loss: 3.1935 - accuracy1000: 0.4309 - val_loss: 3.5957 - val_accuracy1000: 0.3428 - 65s/epoch - 26ms/step
Epoch 3/50
2538/2538 - 65s - loss: 3.1654 - accuracy1000: 0.4408 - val_loss: 3.6810 - val_accuracy1000: 0.3386 - 65s/epoch - 26ms/step
Epoch 4/50
2538/2538 - 66s - loss: 3.1478 - accuracy1000: 0.4504 - val_loss: 3.6442 - val_accuracy1000: 0.3493 - 66s/epoch - 26ms/step
Epoch 5/50
2538/2538 - 65s - loss: 3.1320 - accuracy1000: 0.4579 - val_loss: 3.5423 - val_accuracy1000: 0.3244 - 65s/epoch - 26ms/step
Epoch 6/50
2538/2538 - 65s - loss: 3.1179 - accuracy1000: 0.4636 - val_loss: 3.5984 - val_accuracy1000: 0.3266 - 65s/epoch - 26ms/step
Epoch 7/50
2538/2538 - 66s - loss: 3.1050 - accuracy1000: 0.4682 - val_loss: 3.5062 - val_accuracy1000: 0.3404 - 66s/epoch - 26ms/step
Epoch 8/50
2538/2538 - 65s - loss: 3.0994 - accuracy1000: 0.4686 - val_loss: 3.6064 - val_accuracy1000: 0.3453 - 65s/epoch - 26ms/step
Epoch 9/50
2538/2538 - 63s - loss: 3.0893 - accuracy1000: 0.4723 - val_loss: 3.5643 - val_accuracy1000: 0.3316 - 63s/epoch - 25ms/step
Epoch 10/50
2538/2538 - 65s - loss: 3.0795 - accuracy1000: 0.4753 - val_loss: 3.5303 - val_accuracy1000: 0.3263 - 65s/epoch - 26ms/step
Epoch 11/50
2538/2538 - 65s - loss: 3.0729 - accuracy1000: 0.4776 - val_loss: 3.6478 - val_accuracy1000: 0.3326 - 65s/epoch - 26ms/step
testing model: results/ATVI/W0/deepLOB_L1/h1000
Evaluating performance on  test set...
11876/11876 - 177s - 177s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1426799
{'0': {'precision': 0.37092310645400356, 'recall': 0.5103164227656495, 'f1-score': 0.4295952383669079, 'support': 1143565}, '1': {'precision': 0.23765344076563527, 'recall': 0.22132741371139886, 'f1-score': 0.22920006745904503, 'support': 715361}, '2': {'precision': 0.37706511054516295, 'recall': 0.2555693923214133, 'f1-score': 0.30465079198488687, 'support': 1181233}, 'accuracy': 0.34333598999262865, 'macro avg': {'precision': 0.3285472192549339, 'recall': 0.3290710762661539, 'f1-score': 0.32114869927027995, 'support': 3040159}, 'weighted avg': {'precision': 0.3419506798809578, 'recall': 0.34333598999262865, 'f1-score': 0.33389518021567516, 'support': 3040159}}
[[583580 250890 309095]
 [367391 158329 189641]
 [622347 256999 301887]]
Evaluating performance on  train set...
2538/2538 - 37s - 37s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1468657
{'0': {'precision': 0.3314895545996412, 'recall': 0.31743077747196924, 'f1-score': 0.32430787521938514, 'support': 216548}, '1': {'precision': 0.3451010548961144, 'recall': 0.32727394747438593, 'f1-score': 0.3359511704487524, 'support': 223510}, '2': {'precision': 0.32516272465555346, 'recall': 0.35732725095076995, 'f1-score': 0.34048705963661496, 'support': 209567}, 'accuracy': 0.33368789686357514, 'macro avg': {'precision': 0.3339177780504364, 'recall': 0.334010658632375, 'f1-score': 0.33358203510158413, 'support': 649625}, 'weighted avg': {'precision': 0.33413171224500904, 'recall': 0.33368789686357514, 'f1-score': 0.3335332222387909, 'support': 649625}}
[[68739 70347 77462]
 [72410 73149 77951]
 [66215 68468 74884]]
Evaluating performance on  val set...
795/795 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1566586
{'0': {'precision': 0.31367976095036804, 'recall': 0.25521821631878555, 'f1-score': 0.28144515285270555, 'support': 67456}, '1': {'precision': 0.3249433327307366, 'recall': 0.34516019438987283, 'f1-score': 0.3347467946422176, 'support': 67699}, '2': {'precision': 0.35151428161331993, 'recall': 0.3945545352021911, 'f1-score': 0.371792925459238, 'support': 68277}, 'accuracy': 0.33191434975815015, 'macro avg': {'precision': 0.33004579176480814, 'recall': 0.3316443153036165, 'f1-score': 0.3293282909847204, 'support': 203432}, 'weighted avg': {'precision': 0.33012633825022025, 'recall': 0.33191434975815015, 'f1-score': 0.3295061399037319, 'support': 203432}}
[[17216 24564 25676]
 [20310 23367 24022]
 [17358 23980 26939]]
training model: results/ATVI/W0/deepOF_L1/h10
Epoch 1/50
2538/2538 - 66s - loss: 3.1452 - accuracy10: 0.4071 - val_loss: 3.1720 - val_accuracy10: 0.4738 - 66s/epoch - 26ms/step
Epoch 2/50
2538/2538 - 62s - loss: 3.1247 - accuracy10: 0.3943 - val_loss: 3.1769 - val_accuracy10: 0.5357 - 62s/epoch - 24ms/step
Epoch 3/50
2538/2538 - 62s - loss: 3.1093 - accuracy10: 0.4093 - val_loss: 3.1707 - val_accuracy10: 0.5411 - 62s/epoch - 25ms/step
Epoch 4/50
2538/2538 - 62s - loss: 3.0981 - accuracy10: 0.4196 - val_loss: 3.1659 - val_accuracy10: 0.5385 - 62s/epoch - 25ms/step
Epoch 5/50
2538/2538 - 61s - loss: 3.0873 - accuracy10: 0.4286 - val_loss: 3.1690 - val_accuracy10: 0.5429 - 61s/epoch - 24ms/step
Epoch 6/50
2538/2538 - 62s - loss: 3.0772 - accuracy10: 0.4354 - val_loss: 3.1633 - val_accuracy10: 0.5461 - 62s/epoch - 25ms/step
Epoch 7/50
2538/2538 - 62s - loss: 3.0677 - accuracy10: 0.4424 - val_loss: 3.1691 - val_accuracy10: 0.5475 - 62s/epoch - 24ms/step
Epoch 8/50
2538/2538 - 61s - loss: 3.0590 - accuracy10: 0.4457 - val_loss: 3.1587 - val_accuracy10: 0.5421 - 61s/epoch - 24ms/step
Epoch 9/50
2538/2538 - 61s - loss: 3.0513 - accuracy10: 0.4487 - val_loss: 3.1666 - val_accuracy10: 0.5494 - 61s/epoch - 24ms/step
Epoch 10/50
2538/2538 - 62s - loss: 3.0410 - accuracy10: 0.4543 - val_loss: 3.1725 - val_accuracy10: 0.5555 - 62s/epoch - 24ms/step
Epoch 11/50
2538/2538 - 61s - loss: 3.0321 - accuracy10: 0.4583 - val_loss: 3.1833 - val_accuracy10: 0.5625 - 61s/epoch - 24ms/step
Epoch 12/50
2538/2538 - 63s - loss: 3.0218 - accuracy10: 0.4610 - val_loss: 3.1865 - val_accuracy10: 0.5635 - 63s/epoch - 25ms/step
Epoch 13/50
2538/2538 - 61s - loss: 3.0130 - accuracy10: 0.4640 - val_loss: 3.2103 - val_accuracy10: 0.5704 - 61s/epoch - 24ms/step
Epoch 14/50
2538/2538 - 63s - loss: 3.0031 - accuracy10: 0.4682 - val_loss: 3.2297 - val_accuracy10: 0.5742 - 63s/epoch - 25ms/step
Epoch 15/50
2538/2538 - 61s - loss: 2.9933 - accuracy10: 0.4716 - val_loss: 3.2486 - val_accuracy10: 0.5775 - 61s/epoch - 24ms/step
Epoch 16/50
2538/2538 - 60s - loss: 2.9857 - accuracy10: 0.4751 - val_loss: 3.2780 - val_accuracy10: 0.5805 - 60s/epoch - 24ms/step
Epoch 17/50
2538/2538 - 60s - loss: 2.9781 - accuracy10: 0.4775 - val_loss: 3.2889 - val_accuracy10: 0.5856 - 60s/epoch - 24ms/step
Epoch 18/50
2538/2538 - 61s - loss: 2.9710 - accuracy10: 0.4788 - val_loss: 3.3199 - val_accuracy10: 0.5864 - 61s/epoch - 24ms/step
testing model: results/ATVI/W0/deepOF_L1/h10
Evaluating performance on  test set...
11876/11876 - 191s - 191s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0309347
{'0': {'precision': 0.41751573475669634, 'recall': 0.2896581934501298, 'f1-score': 0.3420285976132819, 'support': 785298}, '1': {'precision': 0.5160668620757246, 'recall': 0.6241732370326772, 'f1-score': 0.5649952568392843, 'support': 1459457}, '2': {'precision': 0.38876950784422487, 'recall': 0.3568800061352856, 'f1-score': 0.37214284122358177, 'support': 795399}, 'accuracy': 0.4678328795186033, 'macro avg': {'precision': 0.44078403489221524, 'recall': 0.42357047887269755, 'f1-score': 0.4263888985587159, 'support': 3040154}, 'weighted avg': {'precision': 0.4573053021548262, 'recall': 0.4678328795186033, 'f1-score': 0.45694484554920645, 'support': 3040154}}
[[227468 426723 131107]
 [233317 910954 315186]
 [ 84028 427509 283862]]
Evaluating performance on  train set...
2538/2538 - 40s - 40s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97037333
{'0': {'precision': 0.34037401831040914, 'recall': 0.31904180901252643, 'f1-score': 0.32936286344074733, 'support': 122940}, '1': {'precision': 0.6667748693452656, 'recall': 0.6637336634204783, 'f1-score': 0.6652507906691696, 'support': 402318}, '2': {'precision': 0.3312921004286589, 'recall': 0.35670520881913065, 'f1-score': 0.34352930244083757, 'support': 124366}, 'accuracy': 0.5397229782150905, 'macro avg': {'precision': 0.4461469960281112, 'recall': 0.4464935604173785, 'f1-score': 0.44604765218358483, 'support': 649624}, 'weighted avg': {'precision': 0.5407783380205179, 'recall': 0.5397229782150905, 'f1-score': 0.5400933513219981, 'support': 649624}}
[[ 39223  67428  16289]
 [ 62031 267032  73255]
 [ 13981  66023  44362]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97117233
{'0': {'precision': 0.3389368599213976, 'recall': 0.30867100347467147, 'f1-score': 0.323096696565303, 'support': 38277}, '1': {'precision': 0.6629382097218355, 'recall': 0.6793658343242172, 'f1-score': 0.6710514982813026, 'support': 126150}, '2': {'precision': 0.325775504491437, 'recall': 0.3282143314959621, 'f1-score': 0.3269903706163317, 'support': 39005}, 'accuracy': 0.5422893153486177, 'macro avg': {'precision': 0.4425501913782233, 'recall': 0.43875038976495023, 'f1-score': 0.4403795218209791, 'support': 203432}, 'weighted avg': {'precision': 0.5373295002571344, 'recall': 0.5422893153486177, 'f1-score': 0.5396131295396321, 'support': 203432}}
[[11815 21360  5102]
 [19055 85702 21393]
 [ 3989 22214 12802]]
training model: results/ATVI/W0/deepOF_L1/h20
Epoch 1/50
2538/2538 - 64s - loss: 3.1767 - accuracy20: 0.4244 - val_loss: 3.2142 - val_accuracy20: 0.4661 - 64s/epoch - 25ms/step
Epoch 2/50
2538/2538 - 60s - loss: 3.1637 - accuracy20: 0.4147 - val_loss: 3.2025 - val_accuracy20: 0.4872 - 60s/epoch - 24ms/step
Epoch 3/50
2538/2538 - 61s - loss: 3.1511 - accuracy20: 0.4237 - val_loss: 3.1968 - val_accuracy20: 0.4914 - 61s/epoch - 24ms/step
Epoch 4/50
2538/2538 - 60s - loss: 3.1406 - accuracy20: 0.4300 - val_loss: 3.1922 - val_accuracy20: 0.4921 - 60s/epoch - 24ms/step
Epoch 5/50
2538/2538 - 61s - loss: 3.1305 - accuracy20: 0.4367 - val_loss: 3.1936 - val_accuracy20: 0.4953 - 61s/epoch - 24ms/step
Epoch 6/50
2538/2538 - 60s - loss: 3.1223 - accuracy20: 0.4401 - val_loss: 3.1949 - val_accuracy20: 0.4962 - 60s/epoch - 24ms/step
Epoch 7/50
2538/2538 - 60s - loss: 3.1128 - accuracy20: 0.4452 - val_loss: 3.1909 - val_accuracy20: 0.4963 - 60s/epoch - 24ms/step
Epoch 8/50
2538/2538 - 61s - loss: 3.1036 - accuracy20: 0.4498 - val_loss: 3.1919 - val_accuracy20: 0.4964 - 61s/epoch - 24ms/step
Epoch 9/50
2538/2538 - 60s - loss: 3.0945 - accuracy20: 0.4537 - val_loss: 3.1918 - val_accuracy20: 0.4991 - 60s/epoch - 23ms/step
Epoch 10/50
2538/2538 - 61s - loss: 3.0869 - accuracy20: 0.4570 - val_loss: 3.1936 - val_accuracy20: 0.5011 - 61s/epoch - 24ms/step
Epoch 11/50
2538/2538 - 61s - loss: 3.0761 - accuracy20: 0.4618 - val_loss: 3.2079 - val_accuracy20: 0.5040 - 61s/epoch - 24ms/step
Epoch 12/50
2538/2538 - 60s - loss: 3.0653 - accuracy20: 0.4663 - val_loss: 3.2084 - val_accuracy20: 0.5024 - 60s/epoch - 24ms/step
Epoch 13/50
2538/2538 - 61s - loss: 3.0562 - accuracy20: 0.4703 - val_loss: 3.2383 - val_accuracy20: 0.5092 - 61s/epoch - 24ms/step
Epoch 14/50
2538/2538 - 60s - loss: 3.0466 - accuracy20: 0.4736 - val_loss: 3.2590 - val_accuracy20: 0.5073 - 60s/epoch - 24ms/step
Epoch 15/50
2538/2538 - 60s - loss: 3.0367 - accuracy20: 0.4778 - val_loss: 3.2977 - val_accuracy20: 0.5126 - 60s/epoch - 24ms/step
Epoch 16/50
2538/2538 - 60s - loss: 3.0302 - accuracy20: 0.4800 - val_loss: 3.2979 - val_accuracy20: 0.5124 - 60s/epoch - 24ms/step
Epoch 17/50
2538/2538 - 61s - loss: 3.0222 - accuracy20: 0.4830 - val_loss: 3.3218 - val_accuracy20: 0.5152 - 61s/epoch - 24ms/step
testing model: results/ATVI/W0/deepOF_L1/h20
Evaluating performance on  test set...
11876/11876 - 195s - 195s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.074796
{'0': {'precision': 0.5193502748974731, 'recall': 0.20692558527831492, 'f1-score': 0.2959395058830733, 'support': 981029}, '1': {'precision': 0.37756855774249054, 'recall': 0.6853951977067257, 'f1-score': 0.48690968992144734, 'support': 1066074}, '2': {'precision': 0.44991184103096277, 'recall': 0.3235080574915085, 'f1-score': 0.3763805560534754, 'support': 993051}, 'accuracy': 0.41278895740150007, 'macro avg': {'precision': 0.44894355789030876, 'recall': 0.4052762801588497, 'f1-score': 0.3864099172859987, 'support': 3040154}, 'weighted avg': {'precision': 0.44695074891166686, 'recall': 0.41278895740150007, 'f1-score': 0.38918162891081914, 'support': 3040154}}
[[203000 608099 169930]
 [112531 730682 222861]
 [ 75342 596449 321260]]
Evaluating performance on  train set...
2538/2538 - 43s - 43s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0187705
{'0': {'precision': 0.4370045598035777, 'recall': 0.23166891866764183, 'f1-score': 0.3028095986519111, 'support': 161338}, '1': {'precision': 0.5423324414463643, 'recall': 0.7085092372641452, 'f1-score': 0.6143823810362401, 'support': 324988}, '2': {'precision': 0.3932170348178834, 'recall': 0.3359747210621073, 'f1-score': 0.3623490872586056, 'support': 163298}, 'accuracy': 0.4964379394849944, 'macro avg': {'precision': 0.4575180120226085, 'recall': 0.4253842923312981, 'f1-score': 0.4265136889822522, 'support': 649624}, 'weighted avg': {'precision': 0.47869003069783655, 'recall': 0.4964379394849944, 'f1-score': 0.47364702893776006, 'support': 649624}}
[[ 37377  99545  24416]
 [ 34485 230257  60246]
 [ 13668  94766  54864]]
Evaluating performance on  val set...
795/795 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0198857
{'0': {'precision': 0.43852959121415497, 'recall': 0.2288784953726739, 'f1-score': 0.3007754776445357, 'support': 50245}, '1': {'precision': 0.5396834731216783, 'recall': 0.7214890083432424, 'f1-score': 0.6174820646094585, 'support': 101759}, '2': {'precision': 0.38774320483859215, 'recall': 0.31039511550128335, 'f1-score': 0.3447843882631187, 'support': 51428}, 'accuracy': 0.49589543434661215, 'macro avg': {'precision': 0.4553187563914752, 'recall': 0.42025420640573324, 'f1-score': 0.4210139768390377, 'support': 203432}, 'weighted avg': {'precision': 0.47628901741310703, 'recall': 0.49589543434661215, 'f1-score': 0.470321251358878, 'support': 203432}}
[[11500 31149  7596]
 [10731 73418 17610]
 [ 3993 31472 15963]]
training model: results/ATVI/W0/deepOF_L1/h30
Epoch 1/50
2538/2538 - 64s - loss: 3.2068 - accuracy30: 0.4224 - val_loss: 3.2504 - val_accuracy30: 0.4371 - 64s/epoch - 25ms/step
Epoch 2/50
2538/2538 - 60s - loss: 3.1970 - accuracy30: 0.4169 - val_loss: 3.2435 - val_accuracy30: 0.4411 - 60s/epoch - 24ms/step
Epoch 3/50
2538/2538 - 60s - loss: 3.1863 - accuracy30: 0.4225 - val_loss: 3.2430 - val_accuracy30: 0.4436 - 60s/epoch - 24ms/step
Epoch 4/50
2538/2538 - 60s - loss: 3.1757 - accuracy30: 0.4300 - val_loss: 3.2379 - val_accuracy30: 0.4473 - 60s/epoch - 24ms/step
Epoch 5/50
2538/2538 - 61s - loss: 3.1638 - accuracy30: 0.4377 - val_loss: 3.2321 - val_accuracy30: 0.4500 - 61s/epoch - 24ms/step
Epoch 6/50
2538/2538 - 61s - loss: 3.1516 - accuracy30: 0.4433 - val_loss: 3.2354 - val_accuracy30: 0.4508 - 61s/epoch - 24ms/step
Epoch 7/50
2538/2538 - 60s - loss: 3.1415 - accuracy30: 0.4479 - val_loss: 3.2366 - val_accuracy30: 0.4521 - 60s/epoch - 24ms/step
Epoch 8/50
2538/2538 - 60s - loss: 3.1308 - accuracy30: 0.4520 - val_loss: 3.2407 - val_accuracy30: 0.4533 - 60s/epoch - 24ms/step
Epoch 9/50
2538/2538 - 60s - loss: 3.1209 - accuracy30: 0.4561 - val_loss: 3.2498 - val_accuracy30: 0.4530 - 60s/epoch - 24ms/step
Epoch 10/50
2538/2538 - 60s - loss: 3.1121 - accuracy30: 0.4597 - val_loss: 3.2636 - val_accuracy30: 0.4531 - 60s/epoch - 24ms/step
Epoch 11/50
2538/2538 - 60s - loss: 3.1013 - accuracy30: 0.4645 - val_loss: 3.2757 - val_accuracy30: 0.4524 - 60s/epoch - 24ms/step
Epoch 12/50
2538/2538 - 61s - loss: 3.0924 - accuracy30: 0.4676 - val_loss: 3.2936 - val_accuracy30: 0.4520 - 61s/epoch - 24ms/step
Epoch 13/50
2538/2538 - 60s - loss: 3.0855 - accuracy30: 0.4703 - val_loss: 3.3247 - val_accuracy30: 0.4516 - 60s/epoch - 24ms/step
Epoch 14/50
2538/2538 - 60s - loss: 3.0770 - accuracy30: 0.4738 - val_loss: 3.3293 - val_accuracy30: 0.4524 - 60s/epoch - 24ms/step
Epoch 15/50
2538/2538 - 60s - loss: 3.0693 - accuracy30: 0.4767 - val_loss: 3.3583 - val_accuracy30: 0.4505 - 60s/epoch - 24ms/step
testing model: results/ATVI/W0/deepOF_L1/h30
Evaluating performance on  test set...
11876/11876 - 187s - 187s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1003277
{'0': {'precision': 0.5626569647304004, 'recall': 0.14645347426024405, 'f1-score': 0.23241250662952914, 'support': 1087656}, '1': {'precision': 0.2960702671876733, 'recall': 0.7128486721920116, 'f1-score': 0.4183751312469746, 'support': 846282}, '2': {'precision': 0.4729830218707216, 'recall': 0.3076162340808667, 'f1-score': 0.3727834861812452, 'support': 1106216}, 'accuracy': 0.36276188640443874, 'macro avg': {'precision': 0.4439034179295984, 'recall': 0.38897279351104075, 'f1-score': 0.34119037468591634, 'support': 3040154}, 'weighted avg': {'precision': 0.4558182078962675, 'recall': 0.36276188640443874, 'f1-score': 0.33525514072052653, 'support': 3040154}}
[[159291 729916 198449]
 [ 62295 603271 180716]
 [ 61519 704407 340290]]
Evaluating performance on  train set...
2538/2538 - 40s - 40s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0513167
{'0': {'precision': 0.48303628114402514, 'recall': 0.16743242372844966, 'f1-score': 0.24866971983402889, 'support': 186308}, '1': {'precision': 0.45600712908967866, 'recall': 0.7411949206072619, 'f1-score': 0.5646334600371399, 'support': 275466}, '2': {'precision': 0.4230892485178657, 'recall': 0.3092414160234229, 'f1-score': 0.3573159629957681, 'support': 187850}, 'accuracy': 0.4517366969200645, 'macro avg': {'precision': 0.4540442195838565, 'recall': 0.4059562534530448, 'f1-score': 0.3902063809556456, 'support': 649624}, 'weighted avg': {'precision': 0.45424014294927456, 'recall': 0.4517366969200645, 'f1-score': 0.4140676491542555, 'support': 649624}}
[[ 31194 125713  29401]
 [ 21482 204174  49810]
 [ 11903 117856  58091]]
Evaluating performance on  val set...
795/795 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0529305
{'0': {'precision': 0.4868961322045927, 'recall': 0.16577780079048654, 'f1-score': 0.24734117889423943, 'support': 57939}, '1': {'precision': 0.45369695707990704, 'recall': 0.7598791259879126, 'f1-score': 0.5681635490668926, 'support': 86040}, '2': {'precision': 0.41878787878787876, 'recall': 0.27894303062923653, 'f1-score': 0.33485103934257415, 'support': 59453}, 'accuracy': 0.4501209249282315, 'macro avg': {'precision': 0.4531269893574595, 'recall': 0.4015333191358786, 'f1-score': 0.3834519224345687, 'support': 203432}, 'weighted avg': {'precision': 0.4529501599971138, 'recall': 0.4501209249282315, 'f1-score': 0.4086052890779368, 'support': 203432}}
[[ 9605 39369  8965]
 [ 6609 65380 14051]
 [ 3513 39356 16584]]
training model: results/ATVI/W0/deepOF_L1/h50
Epoch 1/50
2538/2538 - 63s - loss: 3.2368 - accuracy50: 0.4147 - val_loss: 3.2790 - val_accuracy50: 0.3628 - 63s/epoch - 25ms/step
Epoch 2/50
2538/2538 - 60s - loss: 3.2328 - accuracy50: 0.4131 - val_loss: 3.2776 - val_accuracy50: 0.3661 - 60s/epoch - 24ms/step
Epoch 3/50
2538/2538 - 60s - loss: 3.2255 - accuracy50: 0.4165 - val_loss: 3.2707 - val_accuracy50: 0.3727 - 60s/epoch - 24ms/step
Epoch 4/50
2538/2538 - 59s - loss: 3.2163 - accuracy50: 0.4213 - val_loss: 3.2716 - val_accuracy50: 0.3738 - 59s/epoch - 23ms/step
Epoch 5/50
2538/2538 - 60s - loss: 3.2074 - accuracy50: 0.4259 - val_loss: 3.2727 - val_accuracy50: 0.3736 - 60s/epoch - 24ms/step
Epoch 6/50
2538/2538 - 60s - loss: 3.1990 - accuracy50: 0.4295 - val_loss: 3.2752 - val_accuracy50: 0.3745 - 60s/epoch - 24ms/step
Epoch 7/50
2538/2538 - 60s - loss: 3.1881 - accuracy50: 0.4348 - val_loss: 3.2829 - val_accuracy50: 0.3715 - 60s/epoch - 24ms/step
Epoch 8/50
2538/2538 - 60s - loss: 3.1778 - accuracy50: 0.4395 - val_loss: 3.2911 - val_accuracy50: 0.3701 - 60s/epoch - 24ms/step
Epoch 9/50
2538/2538 - 60s - loss: 3.1699 - accuracy50: 0.4422 - val_loss: 3.3076 - val_accuracy50: 0.3665 - 60s/epoch - 24ms/step
Epoch 10/50
2538/2538 - 60s - loss: 3.1606 - accuracy50: 0.4468 - val_loss: 3.3310 - val_accuracy50: 0.3632 - 60s/epoch - 24ms/step
Epoch 11/50
2538/2538 - 60s - loss: 3.1535 - accuracy50: 0.4492 - val_loss: 3.3508 - val_accuracy50: 0.3601 - 60s/epoch - 24ms/step
Epoch 12/50
2538/2538 - 61s - loss: 3.1463 - accuracy50: 0.4517 - val_loss: 3.3561 - val_accuracy50: 0.3613 - 61s/epoch - 24ms/step
Epoch 13/50
2538/2538 - 59s - loss: 3.1401 - accuracy50: 0.4536 - val_loss: 3.3816 - val_accuracy50: 0.3598 - 59s/epoch - 23ms/step
testing model: results/ATVI/W0/deepOF_L1/h50
Evaluating performance on  test set...
11876/11876 - 181s - 181s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1265578
{'0': {'precision': 0.5653520668114831, 'recall': 0.11865818062401752, 'f1-score': 0.19614807793125727, 'support': 1199774}, '1': {'precision': 0.20640858243446658, 'recall': 0.7614649498344248, 'f1-score': 0.32477983048138687, 'support': 608485}, '2': {'precision': 0.5003513806869401, 'recall': 0.22077855661399715, 'f1-score': 0.30637157026469125, 'support': 1231895}, 'accuracy': 0.28869557265849033, 'macro avg': {'precision': 0.42403734331096327, 'recall': 0.3669672290241465, 'f1-score': 0.2757664928924451, 'support': 3040154}, 'weighted avg': {'precision': 0.4671709396960334, 'recall': 0.28869557265849033, 'f1-score': 0.26655709702652725, 'support': 3040154}}
[[142363 888504 168907]
 [ 42458 463340 102687]
 [ 66992 892927 271976]]
Evaluating performance on  train set...
2538/2538 - 37s - 37s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0901412
{'0': {'precision': 0.4992337594378411, 'recall': 0.12279129203669994, 'f1-score': 0.1971031816303642, 'support': 217548}, '1': {'precision': 0.34520615842136243, 'recall': 0.7826331240430942, 'f1-score': 0.47909268351404577, 'support': 213579}, '2': {'precision': 0.4556527644971895, 'recall': 0.23335789507407426, 'f1-score': 0.30864593611341473, 'support': 218497}, 'accuracy': 0.376918032585003, 'macro avg': {'precision': 0.433364227452131, 'recall': 0.37959410371795616, 'f1-score': 0.3282806004192749, 'support': 649624}, 'weighted avg': {'precision': 0.43393540585323515, 'recall': 0.376918032585003, 'f1-score': 0.3273305024330099, 'support': 649624}}
[[ 26713 161744  29091]
 [ 14603 167154  31822]
 [ 12192 155317  50988]]
Evaluating performance on  val set...
795/795 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0916078
{'0': {'precision': 0.4982837528604119, 'recall': 0.12926300792496512, 'f1-score': 0.20527444557045554, 'support': 67382}, '1': {'precision': 0.34301281049835963, 'recall': 0.7903617710583153, 'f1-score': 0.478401786687003, 'support': 66672}, '2': {'precision': 0.4487750556792873, 'recall': 0.20911528150134048, 'f1-score': 0.285292903073565, 'support': 69378}, 'accuracy': 0.37316154783908134, 'macro avg': {'precision': 0.43002387301268624, 'recall': 0.376246686828207, 'f1-score': 0.3229897117770078, 'support': 203432}, 'weighted avg': {'precision': 0.430511530878645, 'recall': 0.37316154783908134, 'f1-score': 0.322077439354979, 'support': 203432}}
[[ 8710 49910  8762]
 [ 4919 52695  9058]
 [ 3851 51019 14508]]
training model: results/ATVI/W0/deepOF_L1/h100
Epoch 1/50
2538/2538 - 62s - loss: 3.2747 - accuracy100: 0.3864 - val_loss: 3.2896 - val_accuracy100: 0.3416 - 62s/epoch - 24ms/step
Epoch 2/50
2538/2538 - 58s - loss: 3.2622 - accuracy100: 0.3928 - val_loss: 3.2838 - val_accuracy100: 0.3461 - 58s/epoch - 23ms/step
Epoch 3/50
2538/2538 - 59s - loss: 3.2597 - accuracy100: 0.3941 - val_loss: 3.2829 - val_accuracy100: 0.3511 - 59s/epoch - 23ms/step
Epoch 4/50
2538/2538 - 58s - loss: 3.2570 - accuracy100: 0.3963 - val_loss: 3.2820 - val_accuracy100: 0.3525 - 58s/epoch - 23ms/step
Epoch 5/50
2538/2538 - 60s - loss: 3.2537 - accuracy100: 0.3987 - val_loss: 3.2818 - val_accuracy100: 0.3537 - 60s/epoch - 24ms/step
Epoch 6/50
2538/2538 - 60s - loss: 3.2505 - accuracy100: 0.4008 - val_loss: 3.2815 - val_accuracy100: 0.3552 - 60s/epoch - 24ms/step
Epoch 7/50
2538/2538 - 60s - loss: 3.2465 - accuracy100: 0.4038 - val_loss: 3.2816 - val_accuracy100: 0.3536 - 60s/epoch - 24ms/step
Epoch 8/50
2538/2538 - 59s - loss: 3.2432 - accuracy100: 0.4052 - val_loss: 3.2830 - val_accuracy100: 0.3526 - 59s/epoch - 23ms/step
Epoch 9/50
2538/2538 - 59s - loss: 3.2401 - accuracy100: 0.4067 - val_loss: 3.2861 - val_accuracy100: 0.3506 - 59s/epoch - 23ms/step
Epoch 10/50
2538/2538 - 59s - loss: 3.2365 - accuracy100: 0.4099 - val_loss: 3.2894 - val_accuracy100: 0.3499 - 59s/epoch - 23ms/step
Epoch 11/50
2538/2538 - 59s - loss: 3.2337 - accuracy100: 0.4110 - val_loss: 3.2930 - val_accuracy100: 0.3483 - 59s/epoch - 23ms/step
Epoch 12/50
2538/2538 - 60s - loss: 3.2312 - accuracy100: 0.4124 - val_loss: 3.2991 - val_accuracy100: 0.3448 - 60s/epoch - 24ms/step
Epoch 13/50
2538/2538 - 59s - loss: 3.2290 - accuracy100: 0.4132 - val_loss: 3.3021 - val_accuracy100: 0.3459 - 59s/epoch - 23ms/step
Epoch 14/50
2538/2538 - 59s - loss: 3.2266 - accuracy100: 0.4153 - val_loss: 3.3068 - val_accuracy100: 0.3435 - 59s/epoch - 23ms/step
Epoch 15/50
2538/2538 - 60s - loss: 3.2249 - accuracy100: 0.4158 - val_loss: 3.3100 - val_accuracy100: 0.3428 - 60s/epoch - 23ms/step
Epoch 16/50
2538/2538 - 58s - loss: 3.2228 - accuracy100: 0.4169 - val_loss: 3.3156 - val_accuracy100: 0.3411 - 58s/epoch - 23ms/step
testing model: results/ATVI/W0/deepOF_L1/h100
Evaluating performance on  test set...
11876/11876 - 181s - 181s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.115034
{'0': {'precision': 0.5116195801451835, 'recall': 0.08987614877311978, 'f1-score': 0.15289351292007275, 'support': 1160586}, '1': {'precision': 0.23238641800810333, 'recall': 0.72952744813946, 'f1-score': 0.3524895034327621, 'support': 695712}, '2': {'precision': 0.47084716398230697, 'recall': 0.25940908353718695, 'f1-score': 0.33451827823348623, 'support': 1183856}, 'accuracy': 0.30227185859663686, 'macro avg': {'precision': 0.40495105404519793, 'recall': 0.35960422681658893, 'f1-score': 0.27996709819544036, 'support': 3040154}, 'weighted avg': {'precision': 0.43184252569148457, 'recall': 0.30227185859663686, 'f1-score': 0.26929514715190456, 'support': 3040154}}
[[104309 854409 201868]
 [ 44907 507541 143264]
 [ 54664 822089 307103]]
Evaluating performance on  train set...
2538/2538 - 37s - 37s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0974972
{'0': {'precision': 0.45013254530441965, 'recall': 0.0931407812387598, 'f1-score': 0.1543447648991573, 'support': 222416}, '1': {'precision': 0.32788026599169146, 'recall': 0.7491531108502432, 'f1-score': 0.4561279650855794, 'support': 208705}, '2': {'precision': 0.4191486843662472, 'recall': 0.24313167324933754, 'f1-score': 0.307749791454259, 'support': 218503}, 'accuracy': 0.3543480536433383, 'macro avg': {'precision': 0.39905383188745275, 'recall': 0.36180852177944683, 'f1-score': 0.30607417381299856, 'support': 649624}, 'weighted avg': {'precision': 0.4004349840681715, 'recall': 0.3543480536433383, 'f1-score': 0.3028970371555343, 'support': 649624}}
[[ 20716 166337  35363]
 [ 14096 156352  38257]
 [ 11210 154168  53125]]
Evaluating performance on  val set...
795/795 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0964562
{'0': {'precision': 0.4534746760895171, 'recall': 0.09526374010246856, 'f1-score': 0.15745095444868112, 'support': 68704}, '1': {'precision': 0.3298625490544085, 'recall': 0.7682450741744362, 'f1-score': 0.4615490742529179, 'support': 65319}, '2': {'precision': 0.4275602082881319, 'recall': 0.22713192813612068, 'f1-score': 0.29666638439608206, 'support': 69409}, 'accuracy': 0.35634020213142475, 'macro avg': {'precision': 0.40363247781068584, 'recall': 0.3635469141376751, 'f1-score': 0.30522213769922707, 'support': 203432}, 'weighted avg': {'precision': 0.40494289239062703, 'recall': 0.35634020213142475, 'f1-score': 0.30259129060381945, 'support': 203432}}
[[ 6545 51809 10350]
 [ 4381 50181 10757]
 [ 3507 50137 15765]]
training model: results/ATVI/W0/deepOF_L1/h200
Epoch 1/50
2538/2538 - 64s - loss: 3.2905 - accuracy200: 0.3704 - val_loss: 3.2934 - val_accuracy200: 0.3467 - 64s/epoch - 25ms/step
Epoch 2/50
2538/2538 - 60s - loss: 3.2794 - accuracy200: 0.3735 - val_loss: 3.2861 - val_accuracy200: 0.3552 - 60s/epoch - 24ms/step
Epoch 3/50
2538/2538 - 60s - loss: 3.2766 - accuracy200: 0.3747 - val_loss: 3.2861 - val_accuracy200: 0.3535 - 60s/epoch - 24ms/step
Epoch 4/50
2538/2538 - 62s - loss: 3.2748 - accuracy200: 0.3761 - val_loss: 3.2852 - val_accuracy200: 0.3538 - 62s/epoch - 24ms/step
Epoch 5/50
2538/2538 - 61s - loss: 3.2733 - accuracy200: 0.3769 - val_loss: 3.2849 - val_accuracy200: 0.3535 - 61s/epoch - 24ms/step
Epoch 6/50
2538/2538 - 61s - loss: 3.2719 - accuracy200: 0.3784 - val_loss: 3.2850 - val_accuracy200: 0.3551 - 61s/epoch - 24ms/step
Epoch 7/50
2538/2538 - 60s - loss: 3.2706 - accuracy200: 0.3796 - val_loss: 3.2852 - val_accuracy200: 0.3540 - 60s/epoch - 24ms/step
Epoch 8/50
2538/2538 - 61s - loss: 3.2690 - accuracy200: 0.3810 - val_loss: 3.2850 - val_accuracy200: 0.3543 - 61s/epoch - 24ms/step
Epoch 9/50
2538/2538 - 61s - loss: 3.2679 - accuracy200: 0.3818 - val_loss: 3.2850 - val_accuracy200: 0.3567 - 61s/epoch - 24ms/step
Epoch 10/50
2538/2538 - 61s - loss: 3.2666 - accuracy200: 0.3830 - val_loss: 3.2844 - val_accuracy200: 0.3581 - 61s/epoch - 24ms/step
Epoch 11/50
2538/2538 - 61s - loss: 3.2653 - accuracy200: 0.3846 - val_loss: 3.2850 - val_accuracy200: 0.3547 - 61s/epoch - 24ms/step
Epoch 12/50
2538/2538 - 61s - loss: 3.2644 - accuracy200: 0.3851 - val_loss: 3.2855 - val_accuracy200: 0.3543 - 61s/epoch - 24ms/step
Epoch 13/50
2538/2538 - 60s - loss: 3.2630 - accuracy200: 0.3859 - val_loss: 3.2848 - val_accuracy200: 0.3557 - 60s/epoch - 24ms/step
Epoch 14/50
2538/2538 - 60s - loss: 3.2622 - accuracy200: 0.3870 - val_loss: 3.2853 - val_accuracy200: 0.3544 - 60s/epoch - 23ms/step
Epoch 15/50
2538/2538 - 61s - loss: 3.2609 - accuracy200: 0.3875 - val_loss: 3.2843 - val_accuracy200: 0.3557 - 61s/epoch - 24ms/step
Epoch 16/50
2538/2538 - 60s - loss: 3.2601 - accuracy200: 0.3886 - val_loss: 3.2849 - val_accuracy200: 0.3553 - 60s/epoch - 23ms/step
Epoch 17/50
2538/2538 - 59s - loss: 3.2588 - accuracy200: 0.3890 - val_loss: 3.2861 - val_accuracy200: 0.3542 - 59s/epoch - 23ms/step
Epoch 18/50
2538/2538 - 60s - loss: 3.2580 - accuracy200: 0.3904 - val_loss: 3.2865 - val_accuracy200: 0.3531 - 60s/epoch - 24ms/step
Epoch 19/50
2538/2538 - 60s - loss: 3.2571 - accuracy200: 0.3912 - val_loss: 3.2874 - val_accuracy200: 0.3533 - 60s/epoch - 24ms/step
Epoch 20/50
2538/2538 - 60s - loss: 3.2559 - accuracy200: 0.3919 - val_loss: 3.2859 - val_accuracy200: 0.3559 - 60s/epoch - 24ms/step
Epoch 21/50
2538/2538 - 60s - loss: 3.2549 - accuracy200: 0.3923 - val_loss: 3.2870 - val_accuracy200: 0.3546 - 60s/epoch - 24ms/step
Epoch 22/50
2538/2538 - 60s - loss: 3.2537 - accuracy200: 0.3934 - val_loss: 3.2867 - val_accuracy200: 0.3554 - 60s/epoch - 24ms/step
Epoch 23/50
2538/2538 - 60s - loss: 3.2526 - accuracy200: 0.3941 - val_loss: 3.2884 - val_accuracy200: 0.3544 - 60s/epoch - 24ms/step
Epoch 24/50
2538/2538 - 60s - loss: 3.2518 - accuracy200: 0.3950 - val_loss: 3.2895 - val_accuracy200: 0.3543 - 60s/epoch - 24ms/step
Epoch 25/50
2538/2538 - 60s - loss: 3.2507 - accuracy200: 0.3949 - val_loss: 3.2915 - val_accuracy200: 0.3542 - 60s/epoch - 24ms/step
testing model: results/ATVI/W0/deepOF_L1/h200
Evaluating performance on  test set...
11876/11876 - 180s - 180s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1101968
{'0': {'precision': 0.4419916801880304, 'recall': 0.058681687703565015, 'f1-score': 0.10360773872831103, 'support': 1128018}, '1': {'precision': 0.24636418453488135, 'recall': 0.7762037075547767, 'f1-score': 0.3740168157517648, 'support': 745343}, '2': {'precision': 0.43354664472676896, 'recall': 0.20142390295450863, 'f1-score': 0.27505734750245775, 'support': 1166793}, 'accuracy': 0.28937744601095866, 'macro avg': {'precision': 0.3739675031498935, 'recall': 0.34543643273761676, 'f1-score': 0.2508939673275112, 'support': 3040154}, 'weighted avg': {'precision': 0.3907892763777114, 'recall': 0.28937744601095866, 'f1-score': 0.23570424307194132, 'support': 3040154}}
[[ 66194 885830 175994]
 [ 35732 578538 131073]
 [ 47837 883936 235020]]
Evaluating performance on  train set...
2538/2538 - 38s - 38s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0958915
{'0': {'precision': 0.40399430918315304, 'recall': 0.06959408843304632, 'f1-score': 0.11873439392206131, 'support': 216254}, '1': {'precision': 0.3421458922814524, 'recall': 0.7862551145709198, 'f1-score': 0.4768055967729526, 'support': 220693}, '2': {'precision': 0.3743061891727494, 'recall': 0.18517752272225016, 'f1-score': 0.24777519479824972, 'support': 212677}, 'accuracy': 0.35090144452791155, 'macro avg': {'precision': 0.3734821302124516, 'recall': 0.3470089085754054, 'f1-score': 0.28110506183108785, 'support': 649624}, 'weighted avg': {'precision': 0.3732634664637651, 'recall': 0.35090144452791155, 'f1-score': 0.2826258424810999, 'support': 649624}}
[[ 15050 170226  30978]
 [ 12317 173521  34855]
 [  9886 163408  39383]]
Evaluating performance on  val set...
795/795 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0940789
{'0': {'precision': 0.39578606158833063, 'recall': 0.07351214666305428, 'f1-score': 0.12399400847952474, 'support': 66438}, '1': {'precision': 0.34587466129713873, 'recall': 0.7977466888366492, 'f1-score': 0.48253797600055487, 'support': 69764}, '2': {'precision': 0.38656241717466205, 'recall': 0.17355347315186673, 'f1-score': 0.23955488944094278, 'support': 67230}, 'accuracy': 0.35493924259703485, 'macro avg': {'precision': 0.37607438002004384, 'recall': 0.3482707695505234, 'f1-score': 0.2820289579736741, 'support': 203432}, 'weighted avg': {'precision': 0.3756214633744525, 'recall': 0.35493924259703485, 'f1-score': 0.28514180910663006, 'support': 203432}}
[[ 4884 53018  8536]
 [ 4130 55654  9980]
 [ 3326 52236 11668]]
training model: results/ATVI/W0/deepOF_L1/h300
Epoch 1/50
2538/2538 - 62s - loss: 3.2976 - accuracy300: 0.3632 - val_loss: 3.3060 - val_accuracy300: 0.3257 - 62s/epoch - 25ms/step
Epoch 2/50
2538/2538 - 59s - loss: 3.2858 - accuracy300: 0.3666 - val_loss: 3.2965 - val_accuracy300: 0.3282 - 59s/epoch - 23ms/step
Epoch 3/50
2538/2538 - 58s - loss: 3.2829 - accuracy300: 0.3690 - val_loss: 3.2947 - val_accuracy300: 0.3286 - 58s/epoch - 23ms/step
Epoch 4/50
2538/2538 - 60s - loss: 3.2815 - accuracy300: 0.3702 - val_loss: 3.2936 - val_accuracy300: 0.3279 - 60s/epoch - 24ms/step
Epoch 5/50
2538/2538 - 59s - loss: 3.2808 - accuracy300: 0.3705 - val_loss: 3.2933 - val_accuracy300: 0.3287 - 59s/epoch - 23ms/step
Epoch 6/50
2538/2538 - 59s - loss: 3.2800 - accuracy300: 0.3712 - val_loss: 3.2919 - val_accuracy300: 0.3300 - 59s/epoch - 23ms/step
Epoch 7/50
2538/2538 - 60s - loss: 3.2789 - accuracy300: 0.3725 - val_loss: 3.2920 - val_accuracy300: 0.3308 - 60s/epoch - 24ms/step
Epoch 8/50
2538/2538 - 60s - loss: 3.2777 - accuracy300: 0.3740 - val_loss: 3.2923 - val_accuracy300: 0.3295 - 60s/epoch - 24ms/step
Epoch 9/50
2538/2538 - 60s - loss: 3.2770 - accuracy300: 0.3752 - val_loss: 3.2923 - val_accuracy300: 0.3299 - 60s/epoch - 23ms/step
Epoch 10/50
2538/2538 - 61s - loss: 3.2765 - accuracy300: 0.3754 - val_loss: 3.2920 - val_accuracy300: 0.3297 - 61s/epoch - 24ms/step
Epoch 11/50
2538/2538 - 61s - loss: 3.2757 - accuracy300: 0.3761 - val_loss: 3.2924 - val_accuracy300: 0.3300 - 61s/epoch - 24ms/step
Epoch 12/50
2538/2538 - 61s - loss: 3.2752 - accuracy300: 0.3764 - val_loss: 3.2919 - val_accuracy300: 0.3306 - 61s/epoch - 24ms/step
Epoch 13/50
2538/2538 - 60s - loss: 3.2744 - accuracy300: 0.3772 - val_loss: 3.2927 - val_accuracy300: 0.3307 - 60s/epoch - 24ms/step
Epoch 14/50
2538/2538 - 61s - loss: 3.2739 - accuracy300: 0.3778 - val_loss: 3.2942 - val_accuracy300: 0.3290 - 61s/epoch - 24ms/step
Epoch 15/50
2538/2538 - 60s - loss: 3.2732 - accuracy300: 0.3780 - val_loss: 3.2928 - val_accuracy300: 0.3306 - 60s/epoch - 24ms/step
Epoch 16/50
2538/2538 - 61s - loss: 3.2725 - accuracy300: 0.3792 - val_loss: 3.2941 - val_accuracy300: 0.3295 - 61s/epoch - 24ms/step
Epoch 17/50
2538/2538 - 61s - loss: 3.2720 - accuracy300: 0.3791 - val_loss: 3.2943 - val_accuracy300: 0.3288 - 61s/epoch - 24ms/step
Epoch 18/50
2538/2538 - 61s - loss: 3.2713 - accuracy300: 0.3801 - val_loss: 3.2951 - val_accuracy300: 0.3291 - 61s/epoch - 24ms/step
Epoch 19/50
2538/2538 - 61s - loss: 3.2703 - accuracy300: 0.3808 - val_loss: 3.2950 - val_accuracy300: 0.3302 - 61s/epoch - 24ms/step
Epoch 20/50
2538/2538 - 60s - loss: 3.2699 - accuracy300: 0.3813 - val_loss: 3.2949 - val_accuracy300: 0.3292 - 60s/epoch - 24ms/step
Epoch 21/50
2538/2538 - 60s - loss: 3.2693 - accuracy300: 0.3820 - val_loss: 3.2962 - val_accuracy300: 0.3287 - 60s/epoch - 24ms/step
Epoch 22/50
2538/2538 - 61s - loss: 3.2684 - accuracy300: 0.3826 - val_loss: 3.2960 - val_accuracy300: 0.3288 - 61s/epoch - 24ms/step
testing model: results/ATVI/W0/deepOF_L1/h300
Evaluating performance on  test set...
11876/11876 - 181s - 181s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.110686
{'0': {'precision': 0.43086816720257237, 'recall': 0.007500259870411289, 'f1-score': 0.014743868510261502, 'support': 1125561}, '1': {'precision': 0.24644726772474823, 'recall': 0.8620228131605355, 'f1-score': 0.3833087977442685, 'support': 749392}, '2': {'precision': 0.42597893018212596, 'recall': 0.14599197906627268, 'f1-score': 0.2174568882866529, 'support': 1165201}, 'accuracy': 0.27121816855330355, 'macro avg': {'precision': 0.3677647883698156, 'recall': 0.3385050173657398, 'f1-score': 0.20516985151372766, 'support': 3040154}, 'weighted avg': {'precision': 0.38353487732089314, 'recall': 0.27121816855330355, 'f1-score': 0.18328829843223324, 'support': 3040154}}
[[  8442 986470 130649]
 [  4819 645993  98580]
 [  6332 988759 170110]]
Evaluating performance on  train set...
2538/2538 - 40s - 40s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0996501
{'0': {'precision': 0.41868686868686866, 'recall': 0.011207498704400532, 'f1-score': 0.02183063047247032, 'support': 221905}, '1': {'precision': 0.32325013134372566, 'recall': 0.8743496692910382, 'f1-score': 0.4720001544570513, 'support': 209701}, '2': {'precision': 0.3790767621289394, 'recall': 0.13296149859185938, 'f1-score': 0.1968705006655619, 'support': 218018}, 'accuracy': 0.33069437089762693, 'macro avg': {'precision': 0.3736712540531779, 'recall': 0.33950622219576604, 'f1-score': 0.23023376186502784, 'support': 649624}, 'weighted avg': {'precision': 0.3745861343095349, 'recall': 0.33069437089762693, 'f1-score': 0.22589150533061603, 'support': 649624}}
[[  2487 196475  22943]
 [  1810 183352  24539]
 [  1643 187387  28988]]
Evaluating performance on  val set...
795/795 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0990593
{'0': {'precision': 0.41986062717770034, 'recall': 0.0105562855891371, 'f1-score': 0.020594770124765, 'support': 68490}, '1': {'precision': 0.3228052640346493, 'recall': 0.8863781904674778, 'f1-score': 0.47325746104625604, 'support': 65586}, '2': {'precision': 0.38959296947271044, 'recall': 0.12144587346444431, 'f1-score': 0.18516971508969396, 'support': 69356}, 'accuracy': 0.330724763065791, 'macro avg': {'precision': 0.37741962022835335, 'recall': 0.33946011650701974, 'f1-score': 0.22634064875357165, 'support': 203432}, 'weighted avg': {'precision': 0.37825106371232897, 'recall': 0.330724763065791, 'f1-score': 0.2226406386693623, 'support': 203432}}
[[  723 61470  6297]
 [  552 58134  6900]
 [  447 60486  8423]]
training model: results/ATVI/W0/deepOF_L1/h500
Epoch 1/50
2538/2538 - 65s - loss: 3.2713 - accuracy500: 0.3879 - val_loss: 3.2985 - val_accuracy500: 0.3499 - 65s/epoch - 26ms/step
Epoch 2/50
2538/2538 - 61s - loss: 3.2672 - accuracy500: 0.3845 - val_loss: 3.2917 - val_accuracy500: 0.3552 - 61s/epoch - 24ms/step
Epoch 3/50
2538/2538 - 61s - loss: 3.2714 - accuracy500: 0.3793 - val_loss: 3.2900 - val_accuracy500: 0.3588 - 61s/epoch - 24ms/step
Epoch 4/50
2538/2538 - 62s - loss: 3.2699 - accuracy500: 0.3801 - val_loss: 3.2893 - val_accuracy500: 0.3605 - 62s/epoch - 24ms/step
Epoch 5/50
2538/2538 - 60s - loss: 3.2693 - accuracy500: 0.3803 - val_loss: 3.2893 - val_accuracy500: 0.3605 - 60s/epoch - 24ms/step
Epoch 6/50
2538/2538 - 62s - loss: 3.2675 - accuracy500: 0.3829 - val_loss: 3.2887 - val_accuracy500: 0.3606 - 62s/epoch - 25ms/step
Epoch 7/50
2538/2538 - 60s - loss: 3.2670 - accuracy500: 0.3830 - val_loss: 3.2893 - val_accuracy500: 0.3606 - 60s/epoch - 24ms/step
Epoch 8/50
2538/2538 - 61s - loss: 3.2643 - accuracy500: 0.3847 - val_loss: 3.2891 - val_accuracy500: 0.3602 - 61s/epoch - 24ms/step
Epoch 9/50
2538/2538 - 60s - loss: 3.2629 - accuracy500: 0.3856 - val_loss: 3.2896 - val_accuracy500: 0.3596 - 60s/epoch - 24ms/step
Epoch 10/50
2538/2538 - 61s - loss: 3.2608 - accuracy500: 0.3871 - val_loss: 3.2896 - val_accuracy500: 0.3589 - 61s/epoch - 24ms/step
Epoch 11/50
2538/2538 - 61s - loss: 3.2603 - accuracy500: 0.3876 - val_loss: 3.2902 - val_accuracy500: 0.3577 - 61s/epoch - 24ms/step
Epoch 12/50
2538/2538 - 61s - loss: 3.2601 - accuracy500: 0.3878 - val_loss: 3.2906 - val_accuracy500: 0.3573 - 61s/epoch - 24ms/step
Epoch 13/50
2538/2538 - 61s - loss: 3.2591 - accuracy500: 0.3892 - val_loss: 3.2912 - val_accuracy500: 0.3563 - 61s/epoch - 24ms/step
Epoch 14/50
2538/2538 - 60s - loss: 3.2585 - accuracy500: 0.3895 - val_loss: 3.2912 - val_accuracy500: 0.3565 - 60s/epoch - 24ms/step
Epoch 15/50
2538/2538 - 61s - loss: 3.2586 - accuracy500: 0.3902 - val_loss: 3.2917 - val_accuracy500: 0.3562 - 61s/epoch - 24ms/step
Epoch 16/50
2538/2538 - 60s - loss: 3.2568 - accuracy500: 0.3906 - val_loss: 3.2920 - val_accuracy500: 0.3564 - 60s/epoch - 24ms/step
testing model: results/ATVI/W0/deepOF_L1/h500
Evaluating performance on  test set...
11876/11876 - 187s - 187s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0932074
{'0': {'precision': 0.42000672644493486, 'recall': 0.25436082600041243, 'f1-score': 0.31683985232347306, 'support': 1188135}, '1': {'precision': 0.22277284775844186, 'recall': 0.012450404493224095, 'f1-score': 0.023582805170404984, 'support': 621024}, '2': {'precision': 0.41641446818711947, 'recall': 0.773261467349583, 'f1-score': 0.5413192838110229, 'support': 1230995}, 'accuracy': 0.4150539742394629, 'macro avg': {'precision': 0.35306468079683206, 'recall': 0.34669089928107316, 'f1-score': 0.293913980434967, 'support': 3040154}, 'weighted avg': {'precision': 0.3782624515721883, 'recall': 0.4150539742394629, 'f1-score': 0.34782953025190344, 'support': 3040154}}
[[302215  14284 871636]
 [150911   7732 462381]
 [266422  12692 951881]]
Evaluating performance on  train set...
2538/2538 - 40s - 40s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0974671
{'0': {'precision': 0.36884442184776295, 'recall': 0.2795584976810118, 'f1-score': 0.3180540659030947, 'support': 217983}, '1': {'precision': 0.3759128456841853, 'recall': 0.014449603556259117, 'f1-score': 0.027829477975715677, 'support': 217307}, '2': {'precision': 0.34277131844009623, 'recall': 0.76132578125729, 'f1-score': 0.4727132095094215, 'support': 214334}, 'accuracy': 0.34982851618782557, 'macro avg': {'precision': 0.36250952865734815, 'recall': 0.35177796083152035, 'f1-score': 0.27286558446274395, 'support': 649624}, 'weighted avg': {'precision': 0.3626064525498962, 'recall': 0.34982851618782557, 'f1-score': 0.27199800633168647, 'support': 649624}}
[[ 60939   2714 154330]
 [ 55620   3140 158547]
 [ 48657   2499 163178]]
Evaluating performance on  val set...
795/795 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0963454
{'0': {'precision': 0.37707289927657206, 'recall': 0.2960762037927117, 'f1-score': 0.33170158605835126, 'support': 68658}, '1': {'precision': 0.3513606613847744, 'recall': 0.015607307892401383, 'f1-score': 0.029887044552207098, 'support': 65354}, '2': {'precision': 0.3554450651007032, 'recall': 0.7507202535292423, 'f1-score': 0.4824591856100056, 'support': 69420}, 'accuracy': 0.3611182114908176, 'macro avg': {'precision': 0.36129287525401654, 'recall': 0.3541345884047851, 'f1-score': 0.28134927207352134, 'support': 203432}, 'weighted avg': {'precision': 0.36143228303296554, 'recall': 0.3611182114908176, 'f1-score': 0.2861866474807592, 'support': 203432}}
[[20328   969 47361]
 [17191  1020 47143]
 [16391   914 52115]]
training model: results/ATVI/W0/deepOF_L1/h1000
Epoch 1/50
2538/2538 - 64s - loss: 3.2927 - accuracy1000: 0.3762 - val_loss: 3.3448 - val_accuracy1000: 0.3324 - 64s/epoch - 25ms/step
Epoch 2/50
2538/2538 - 61s - loss: 3.2887 - accuracy1000: 0.3655 - val_loss: 3.3424 - val_accuracy1000: 0.3330 - 61s/epoch - 24ms/step
Epoch 3/50
2538/2538 - 61s - loss: 3.2883 - accuracy1000: 0.3637 - val_loss: 3.3446 - val_accuracy1000: 0.3329 - 61s/epoch - 24ms/step
Epoch 4/50
2538/2538 - 61s - loss: 3.2868 - accuracy1000: 0.3641 - val_loss: 3.3468 - val_accuracy1000: 0.3329 - 61s/epoch - 24ms/step
Epoch 5/50
2538/2538 - 61s - loss: 3.2852 - accuracy1000: 0.3654 - val_loss: 3.3490 - val_accuracy1000: 0.3329 - 61s/epoch - 24ms/step
Epoch 6/50
2538/2538 - 60s - loss: 3.2828 - accuracy1000: 0.3677 - val_loss: 3.3555 - val_accuracy1000: 0.3330 - 60s/epoch - 24ms/step
Epoch 7/50
2538/2538 - 60s - loss: 3.2810 - accuracy1000: 0.3705 - val_loss: 3.3637 - val_accuracy1000: 0.3329 - 60s/epoch - 24ms/step
Epoch 8/50
2538/2538 - 61s - loss: 3.2795 - accuracy1000: 0.3723 - val_loss: 3.3689 - val_accuracy1000: 0.3330 - 61s/epoch - 24ms/step
Epoch 9/50
2538/2538 - 61s - loss: 3.2781 - accuracy1000: 0.3742 - val_loss: 3.3743 - val_accuracy1000: 0.3330 - 61s/epoch - 24ms/step
Epoch 10/50
2538/2538 - 61s - loss: 3.2764 - accuracy1000: 0.3763 - val_loss: 3.3805 - val_accuracy1000: 0.3331 - 61s/epoch - 24ms/step
Epoch 11/50
2538/2538 - 61s - loss: 3.2743 - accuracy1000: 0.3777 - val_loss: 3.3856 - val_accuracy1000: 0.3331 - 61s/epoch - 24ms/step
Epoch 12/50
2538/2538 - 61s - loss: 3.2729 - accuracy1000: 0.3788 - val_loss: 3.3912 - val_accuracy1000: 0.3330 - 61s/epoch - 24ms/step
testing model: results/ATVI/W0/deepOF_L1/h1000
Evaluating performance on  test set...
11876/11876 - 181s - 181s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1395104
{'0': {'precision': 0.39225806451612905, 'recall': 0.00026583581315589957, 'f1-score': 0.0005313115530551287, 'support': 1143563}, '1': {'precision': 0.23525643964493353, 'recall': 0.9970783940952807, 'f1-score': 0.38069055035929084, 'support': 715360}, '2': {'precision': 0.42275880469583776, 'recall': 0.002682794474577792, 'f1-score': 0.005331754052864955, 'support': 1181231}, 'accuracy': 0.23575878064071754, 'macro avg': {'precision': 0.3500911029523001, 'recall': 0.3333423414610048, 'f1-score': 0.12885120532173697, 'support': 3040154}, 'weighted avg': {'precision': 0.3671658282199938, 'recall': 0.23575878064071754, 'f1-score': 0.09184943049272778, 'support': 3040154}}
[[    304 1140838    2421]
 [    184  713270    1906]
 [    287 1177775    3169]]
Evaluating performance on  train set...
2538/2538 - 39s - 39s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1093384
{'0': {'precision': 0.36212624584717606, 'recall': 0.0005031597509128425, 'f1-score': 0.0010049232017406374, 'support': 216631}, '1': {'precision': 0.3439709574016143, 'recall': 0.9963887446972274, 'f1-score': 0.5113982312673621, 'support': 223468}, '2': {'precision': 0.34734734734734735, 'recall': 0.003312253907648252, 'f1-score': 0.006561934163187928, 'support': 209525}, 'accuracy': 0.3439897540731254, 'macro avg': {'precision': 0.35114818353204597, 'recall': 0.3334013861185962, 'f1-score': 0.17298836287743022, 'support': 649624}, 'weighted avg': {'precision': 0.35111422242050244, 'recall': 0.3439897540731254, 'f1-score': 0.17837045232090112, 'support': 649624}}
[[   109 215926    596]
 [    99 222661    708]
 [    93 208738    694]]
Evaluating performance on  val set...
795/795 - 12s - 12s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1111577
{'0': {'precision': 0.30952380952380953, 'recall': 0.00038571089484927605, 'f1-score': 0.0007704616843477745, 'support': 67408}, '1': {'precision': 0.3328402804484809, 'recall': 0.9965897515390407, 'f1-score': 0.4990186838165992, 'support': 67737}, '2': {'precision': 0.30566037735849055, 'recall': 0.002372340269743875, 'f1-score': 0.004708138977287588, 'support': 68287}, 'accuracy': 0.33275984112627316, 'macro avg': {'precision': 0.316008155776927, 'recall': 0.3331159342345446, 'f1-score': 0.16816576149274487, 'support': 203432}, 'weighted avg': {'precision': 0.3159906662560411, 'recall': 0.33275984112627316, 'f1-score': 0.1679945561821421, 'support': 203432}}
[[   26 67206   176]
 [   39 67506   192]
 [   19 68106   162]]
training model: results/ATVI/W0/deepLOB_L2/h10
Epoch 1/50
2538/2538 - 121s - loss: 3.0313 - accuracy10: 0.4283 - val_loss: 3.1667 - val_accuracy10: 0.4683 - 121s/epoch - 48ms/step
Epoch 2/50
2538/2538 - 117s - loss: 2.9334 - accuracy10: 0.4561 - val_loss: 3.0828 - val_accuracy10: 0.4821 - 117s/epoch - 46ms/step
Epoch 3/50
2538/2538 - 117s - loss: 2.8352 - accuracy10: 0.5026 - val_loss: 3.0436 - val_accuracy10: 0.5262 - 117s/epoch - 46ms/step
Epoch 4/50
2538/2538 - 117s - loss: 2.7577 - accuracy10: 0.5388 - val_loss: 2.9858 - val_accuracy10: 0.5546 - 117s/epoch - 46ms/step
Epoch 5/50
2538/2538 - 117s - loss: 2.6983 - accuracy10: 0.5597 - val_loss: 2.9407 - val_accuracy10: 0.5527 - 117s/epoch - 46ms/step
Epoch 6/50
2538/2538 - 117s - loss: 2.6590 - accuracy10: 0.5727 - val_loss: 2.9138 - val_accuracy10: 0.5440 - 117s/epoch - 46ms/step
Epoch 7/50
2538/2538 - 117s - loss: 2.6286 - accuracy10: 0.5811 - val_loss: 2.8699 - val_accuracy10: 0.5594 - 117s/epoch - 46ms/step
Epoch 8/50
2538/2538 - 117s - loss: 2.6089 - accuracy10: 0.5860 - val_loss: 2.8423 - val_accuracy10: 0.5547 - 117s/epoch - 46ms/step
Epoch 9/50
2538/2538 - 117s - loss: 2.5928 - accuracy10: 0.5894 - val_loss: 2.8286 - val_accuracy10: 0.5616 - 117s/epoch - 46ms/step
Epoch 10/50
2538/2538 - 116s - loss: 2.5790 - accuracy10: 0.5919 - val_loss: 2.8326 - val_accuracy10: 0.5762 - 116s/epoch - 46ms/step
Epoch 11/50
2538/2538 - 117s - loss: 2.5677 - accuracy10: 0.5937 - val_loss: 2.8475 - val_accuracy10: 0.5659 - 117s/epoch - 46ms/step
Epoch 12/50
2538/2538 - 116s - loss: 2.5598 - accuracy10: 0.5959 - val_loss: 2.8489 - val_accuracy10: 0.5694 - 116s/epoch - 46ms/step
Epoch 13/50
2538/2538 - 117s - loss: 2.5509 - accuracy10: 0.5967 - val_loss: 2.8425 - val_accuracy10: 0.5643 - 117s/epoch - 46ms/step
Epoch 14/50
2538/2538 - 116s - loss: 2.5449 - accuracy10: 0.5975 - val_loss: 2.8585 - val_accuracy10: 0.5777 - 116s/epoch - 46ms/step
Epoch 15/50
2538/2538 - 117s - loss: 2.5382 - accuracy10: 0.5989 - val_loss: 2.8428 - val_accuracy10: 0.5617 - 117s/epoch - 46ms/step
Epoch 16/50
2538/2538 - 116s - loss: 2.5315 - accuracy10: 0.5999 - val_loss: 2.8239 - val_accuracy10: 0.5683 - 116s/epoch - 46ms/step
Epoch 17/50
2538/2538 - 116s - loss: 2.5263 - accuracy10: 0.6004 - val_loss: 2.8457 - val_accuracy10: 0.5635 - 116s/epoch - 46ms/step
Epoch 18/50
2538/2538 - 117s - loss: 2.5198 - accuracy10: 0.6017 - val_loss: 2.8585 - val_accuracy10: 0.5634 - 117s/epoch - 46ms/step
Epoch 19/50
2538/2538 - 116s - loss: 2.5151 - accuracy10: 0.6024 - val_loss: 2.8491 - val_accuracy10: 0.5666 - 116s/epoch - 46ms/step
Epoch 20/50
2538/2538 - 116s - loss: 2.5093 - accuracy10: 0.6033 - val_loss: 2.8750 - val_accuracy10: 0.5675 - 116s/epoch - 46ms/step
Epoch 21/50
2538/2538 - 117s - loss: 2.5048 - accuracy10: 0.6032 - val_loss: 2.8688 - val_accuracy10: 0.5654 - 117s/epoch - 46ms/step
Epoch 22/50
2538/2538 - 116s - loss: 2.5000 - accuracy10: 0.6039 - val_loss: 2.8468 - val_accuracy10: 0.5641 - 116s/epoch - 46ms/step
Epoch 23/50
2538/2538 - 117s - loss: 2.4970 - accuracy10: 0.6045 - val_loss: 2.8512 - val_accuracy10: 0.5695 - 117s/epoch - 46ms/step
Epoch 24/50
2538/2538 - 118s - loss: 2.4914 - accuracy10: 0.6057 - val_loss: 2.8663 - val_accuracy10: 0.5600 - 118s/epoch - 47ms/step
Epoch 25/50
2538/2538 - 117s - loss: 2.4870 - accuracy10: 0.6058 - val_loss: 2.8598 - val_accuracy10: 0.5625 - 117s/epoch - 46ms/step
Epoch 26/50
2538/2538 - 117s - loss: 2.4835 - accuracy10: 0.6066 - val_loss: 2.8924 - val_accuracy10: 0.5565 - 117s/epoch - 46ms/step
testing model: results/ATVI/W0/deepLOB_L2/h10
Evaluating performance on  test set...
11876/11876 - 190s - 190s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99443483
{'0': {'precision': 0.4682298794056875, 'recall': 0.329828091175347, 'f1-score': 0.38702794295307286, 'support': 785300}, '1': {'precision': 0.5917336366020617, 'recall': 0.7080359339124072, 'f1-score': 0.6446814689669822, 'support': 1459457}, '2': {'precision': 0.4561279155798217, 'recall': 0.4247449717249894, 'f1-score': 0.43987740205901, 'support': 795402}, 'accuracy': 0.5362235988315085, 'macro avg': {'precision': 0.5053638105291903, 'recall': 0.48753633227091453, 'f1-score': 0.4905289379930217, 'support': 3040159}, 'weighted avg': {'precision': 0.5243527653256435, 'recall': 0.5362235988315085, 'f1-score': 0.5245440424687439, 'support': 3040159}}
[[ 259014  379023  147263]
 [ 170539 1033348  255570]
 [ 123624  333935  337843]]
Evaluating performance on  train set...
2538/2538 - 43s - 43s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9097267
{'0': {'precision': 0.4289272241145662, 'recall': 0.3816273992244273, 'f1-score': 0.4038972236592516, 'support': 122748}, '1': {'precision': 0.7265090988687355, 'recall': 0.7259042208155323, 'f1-score': 0.726206533887127, 'support': 402363}, '2': {'precision': 0.4046031000469704, 'recall': 0.4496763416162038, 'f1-score': 0.4259506502497156, 'support': 124514}, 'accuracy': 0.607907639022513, 'macro avg': {'precision': 0.5200131410100908, 'recall': 0.5190693205520545, 'f1-score': 0.5186848025986981, 'support': 649625}, 'weighted avg': {'precision': 0.608580473123701, 'recall': 0.607907639022513, 'f1-score': 0.6077552977015124, 'support': 649625}}
[[ 46844  58015  17889]
 [ 45781 292077  64505]
 [ 16587  51936  55991]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9322839
{'0': {'precision': 0.37886200785884894, 'recall': 0.5120268652053939, 'f1-score': 0.43549208457876676, 'support': 38414}, '1': {'precision': 0.7854598132846872, 'recall': 0.5808594214974407, 'f1-score': 0.6678406058255971, 'support': 126015}, '2': {'precision': 0.38704865754552, 'recall': 0.5788016306437966, 'f1-score': 0.463890515673643, 'support': 39003}, 'accuracy': 0.5674672617877227, 'macro avg': {'precision': 0.517123492896352, 'recall': 0.5572293057822104, 'f1-score': 0.5224077353593356, 'support': 203432}, 'weighted avg': {'precision': 0.6322967002792461, 'recall': 0.5674672617877227, 'f1-score': 0.5848639774614637, 'support': 203432}}
[[19669 10953  7792]
 [24859 73197 27959]
 [ 7388  9040 22575]]
training model: results/ATVI/W0/deepLOB_L2/h20
Epoch 1/50
2538/2538 - 119s - loss: 3.0877 - accuracy20: 0.4469 - val_loss: 3.3755 - val_accuracy20: 0.4641 - 119s/epoch - 47ms/step
Epoch 2/50
2538/2538 - 116s - loss: 2.9899 - accuracy20: 0.4773 - val_loss: 3.2516 - val_accuracy20: 0.4781 - 116s/epoch - 46ms/step
Epoch 3/50
2538/2538 - 116s - loss: 2.8853 - accuracy20: 0.5205 - val_loss: 3.1518 - val_accuracy20: 0.5140 - 116s/epoch - 46ms/step
Epoch 4/50
2538/2538 - 116s - loss: 2.8235 - accuracy20: 0.5417 - val_loss: 3.0911 - val_accuracy20: 0.5155 - 116s/epoch - 46ms/step
Epoch 5/50
2538/2538 - 116s - loss: 2.7747 - accuracy20: 0.5565 - val_loss: 3.0146 - val_accuracy20: 0.5291 - 116s/epoch - 46ms/step
Epoch 6/50
2538/2538 - 116s - loss: 2.7389 - accuracy20: 0.5674 - val_loss: 3.0136 - val_accuracy20: 0.5234 - 116s/epoch - 46ms/step
Epoch 7/50
2538/2538 - 114s - loss: 2.7160 - accuracy20: 0.5735 - val_loss: 3.0116 - val_accuracy20: 0.5239 - 114s/epoch - 45ms/step
Epoch 8/50
2538/2538 - 115s - loss: 2.6980 - accuracy20: 0.5778 - val_loss: 2.9304 - val_accuracy20: 0.5394 - 115s/epoch - 45ms/step
Epoch 9/50
2538/2538 - 114s - loss: 2.6838 - accuracy20: 0.5813 - val_loss: 2.9507 - val_accuracy20: 0.5284 - 114s/epoch - 45ms/step
Epoch 10/50
2538/2538 - 115s - loss: 2.6712 - accuracy20: 0.5835 - val_loss: 2.9160 - val_accuracy20: 0.5366 - 115s/epoch - 45ms/step
Epoch 11/50
2538/2538 - 115s - loss: 2.6614 - accuracy20: 0.5858 - val_loss: 2.9095 - val_accuracy20: 0.5374 - 115s/epoch - 45ms/step
Epoch 12/50
2538/2538 - 115s - loss: 2.6534 - accuracy20: 0.5867 - val_loss: 2.9216 - val_accuracy20: 0.5363 - 115s/epoch - 45ms/step
Epoch 13/50
2538/2538 - 116s - loss: 2.6465 - accuracy20: 0.5876 - val_loss: 2.9311 - val_accuracy20: 0.5248 - 116s/epoch - 46ms/step
Epoch 14/50
2538/2538 - 115s - loss: 2.6406 - accuracy20: 0.5888 - val_loss: 2.9231 - val_accuracy20: 0.5371 - 115s/epoch - 45ms/step
Epoch 15/50
2538/2538 - 116s - loss: 2.6356 - accuracy20: 0.5900 - val_loss: 2.9203 - val_accuracy20: 0.5382 - 116s/epoch - 46ms/step
Epoch 16/50
2538/2538 - 115s - loss: 2.6303 - accuracy20: 0.5911 - val_loss: 2.9220 - val_accuracy20: 0.5369 - 115s/epoch - 45ms/step
Epoch 17/50
2538/2538 - 115s - loss: 2.6255 - accuracy20: 0.5914 - val_loss: 2.9065 - val_accuracy20: 0.5390 - 115s/epoch - 45ms/step
Epoch 18/50
2538/2538 - 116s - loss: 2.6204 - accuracy20: 0.5922 - val_loss: 2.9210 - val_accuracy20: 0.5395 - 116s/epoch - 46ms/step
Epoch 19/50
2538/2538 - 115s - loss: 2.6163 - accuracy20: 0.5928 - val_loss: 2.9375 - val_accuracy20: 0.5339 - 115s/epoch - 45ms/step
Epoch 20/50
2538/2538 - 116s - loss: 2.6126 - accuracy20: 0.5934 - val_loss: 2.9288 - val_accuracy20: 0.5358 - 116s/epoch - 46ms/step
Epoch 21/50
2538/2538 - 116s - loss: 2.6085 - accuracy20: 0.5944 - val_loss: 2.9339 - val_accuracy20: 0.5367 - 116s/epoch - 46ms/step
Epoch 22/50
2538/2538 - 116s - loss: 2.6051 - accuracy20: 0.5951 - val_loss: 2.9524 - val_accuracy20: 0.5328 - 116s/epoch - 46ms/step
Epoch 23/50
2538/2538 - 116s - loss: 2.6016 - accuracy20: 0.5960 - val_loss: 2.9563 - val_accuracy20: 0.5272 - 116s/epoch - 46ms/step
Epoch 24/50
2538/2538 - 116s - loss: 2.5982 - accuracy20: 0.5955 - val_loss: 2.9424 - val_accuracy20: 0.5357 - 116s/epoch - 46ms/step
Epoch 25/50
2538/2538 - 116s - loss: 2.5951 - accuracy20: 0.5964 - val_loss: 2.9805 - val_accuracy20: 0.5262 - 116s/epoch - 46ms/step
Epoch 26/50
2538/2538 - 115s - loss: 2.5915 - accuracy20: 0.5973 - val_loss: 2.9670 - val_accuracy20: 0.5351 - 115s/epoch - 45ms/step
Epoch 27/50
2538/2538 - 115s - loss: 2.5889 - accuracy20: 0.5973 - val_loss: 2.9394 - val_accuracy20: 0.5431 - 115s/epoch - 45ms/step
testing model: results/ATVI/W0/deepLOB_L2/h20
Evaluating performance on  test set...
11876/11876 - 183s - 183s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0075352
{'0': {'precision': 0.5151777446757115, 'recall': 0.3913183083086144, 'f1-score': 0.444786235662148, 'support': 981030}, '1': {'precision': 0.5143000440177576, 'recall': 0.5896354286850631, 'f1-score': 0.5493971965312361, 'support': 1066074}, '2': {'precision': 0.4934668214084297, 'recall': 0.53307117934052, 'f1-score': 0.512505022243091, 'support': 993055}, 'accuracy': 0.5071639345178985, 'macro avg': {'precision': 0.5076482033672997, 'recall': 0.5046749721113991, 'f1-score': 0.5022294848121583, 'support': 3040159}, 'weighted avg': {'precision': 0.5077781860485416, 'recall': 0.5071639345178985, 'f1-score': 0.5035895762458775, 'support': 3040159}}
[[383895 312643 284492]
 [178585 628595 258894]
 [182690 280996 529369]]
Evaluating performance on  train set...
2538/2538 - 41s - 41s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93072695
{'0': {'precision': 0.508929141398021, 'recall': 0.3956390930802394, 'f1-score': 0.44518977401622895, 'support': 161205}, '1': {'precision': 0.6573186013446756, 'recall': 0.6714029020466936, 'f1-score': 0.6642861056822955, 'support': 325012}, '2': {'precision': 0.45532914953023207, 'recall': 0.5359162342112993, 'f1-score': 0.4923468742357416, 'support': 163408}, 'accuracy': 0.5688912834327496, 'macro avg': {'precision': 0.5405256307576428, 'recall': 0.5343194097794107, 'f1-score': 0.5339409179780886, 'support': 649625}, 'weighted avg': {'precision': 0.5696867903263264, 'recall': 0.5688912834327496, 'f1-score': 0.5666672177416424, 'support': 649625}}
[[ 63779  61084  36342]
 [ 38384 218214  68414]
 [ 23157  52678  87573]]
Evaluating performance on  val set...
795/795 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9803575
{'0': {'precision': 0.4599656146383397, 'recall': 0.4467082770135962, 'f1-score': 0.453240021781659, 'support': 50308}, '1': {'precision': 0.6974849094567405, 'recall': 0.5452132626881223, 'f1-score': 0.6120199283858118, 'support': 101729}, '2': {'precision': 0.4235350547605724, 'recall': 0.6185037455005351, 'f1-score': 0.5027797768270212, 'support': 51395}, 'accuracy': 0.5393694207400999, 'macro avg': {'precision': 0.5269951929518841, 'recall': 0.5368084284007512, 'f1-score': 0.522679908998164, 'support': 203432}, 'weighted avg': {'precision': 0.569536634525394, 'recall': 0.5393694207400999, 'f1-score': 0.5451558306489476, 'support': 203432}}
[[22473 12820 15015]
 [18014 55464 28251]
 [ 8371 11236 31788]]
training model: results/ATVI/W0/deepLOB_L2/h30
Epoch 1/50
2538/2538 - 118s - loss: 3.1289 - accuracy30: 0.4469 - val_loss: 3.4626 - val_accuracy30: 0.4309 - 118s/epoch - 46ms/step
Epoch 2/50
2538/2538 - 115s - loss: 3.0663 - accuracy30: 0.4669 - val_loss: 3.4246 - val_accuracy30: 0.4389 - 115s/epoch - 45ms/step
Epoch 3/50
2538/2538 - 115s - loss: 3.0135 - accuracy30: 0.4853 - val_loss: 3.5670 - val_accuracy30: 0.4490 - 115s/epoch - 45ms/step
Epoch 4/50
2538/2538 - 116s - loss: 2.9478 - accuracy30: 0.5094 - val_loss: 3.5173 - val_accuracy30: 0.4634 - 116s/epoch - 46ms/step
Epoch 5/50
2538/2538 - 116s - loss: 2.9013 - accuracy30: 0.5244 - val_loss: 3.5739 - val_accuracy30: 0.4659 - 116s/epoch - 46ms/step
Epoch 6/50
2538/2538 - 116s - loss: 2.8615 - accuracy30: 0.5349 - val_loss: 3.4001 - val_accuracy30: 0.4774 - 116s/epoch - 46ms/step
Epoch 7/50
2538/2538 - 116s - loss: 2.8312 - accuracy30: 0.5435 - val_loss: 3.3112 - val_accuracy30: 0.4837 - 116s/epoch - 46ms/step
Epoch 8/50
2538/2538 - 115s - loss: 2.8057 - accuracy30: 0.5505 - val_loss: 3.3491 - val_accuracy30: 0.4865 - 115s/epoch - 45ms/step
Epoch 9/50
2538/2538 - 115s - loss: 2.7854 - accuracy30: 0.5557 - val_loss: 3.3249 - val_accuracy30: 0.4963 - 115s/epoch - 45ms/step
Epoch 10/50
2538/2538 - 116s - loss: 2.7696 - accuracy30: 0.5592 - val_loss: 3.2665 - val_accuracy30: 0.4959 - 116s/epoch - 46ms/step
Epoch 11/50
2538/2538 - 115s - loss: 2.7564 - accuracy30: 0.5626 - val_loss: 3.2412 - val_accuracy30: 0.4984 - 115s/epoch - 45ms/step
Epoch 12/50
2538/2538 - 115s - loss: 2.7459 - accuracy30: 0.5649 - val_loss: 3.2231 - val_accuracy30: 0.5023 - 115s/epoch - 45ms/step
Epoch 13/50
2538/2538 - 116s - loss: 2.7373 - accuracy30: 0.5666 - val_loss: 3.1775 - val_accuracy30: 0.5049 - 116s/epoch - 46ms/step
Epoch 14/50
2538/2538 - 116s - loss: 2.7290 - accuracy30: 0.5681 - val_loss: 3.1199 - val_accuracy30: 0.5097 - 116s/epoch - 46ms/step
Epoch 15/50
2538/2538 - 115s - loss: 2.7235 - accuracy30: 0.5692 - val_loss: 3.1649 - val_accuracy30: 0.5038 - 115s/epoch - 45ms/step
Epoch 16/50
2538/2538 - 115s - loss: 2.7165 - accuracy30: 0.5705 - val_loss: 3.1453 - val_accuracy30: 0.5108 - 115s/epoch - 45ms/step
Epoch 17/50
2538/2538 - 115s - loss: 2.7124 - accuracy30: 0.5710 - val_loss: 3.0974 - val_accuracy30: 0.5142 - 115s/epoch - 45ms/step
Epoch 18/50
2538/2538 - 115s - loss: 2.7076 - accuracy30: 0.5719 - val_loss: 3.1040 - val_accuracy30: 0.5122 - 115s/epoch - 45ms/step
Epoch 19/50
2538/2538 - 115s - loss: 2.7035 - accuracy30: 0.5726 - val_loss: 3.1300 - val_accuracy30: 0.5100 - 115s/epoch - 45ms/step
Epoch 20/50
2538/2538 - 115s - loss: 2.6994 - accuracy30: 0.5738 - val_loss: 3.1235 - val_accuracy30: 0.5116 - 115s/epoch - 45ms/step
Epoch 21/50
2538/2538 - 115s - loss: 2.6950 - accuracy30: 0.5742 - val_loss: 3.1483 - val_accuracy30: 0.5068 - 115s/epoch - 45ms/step
Epoch 22/50
2538/2538 - 116s - loss: 2.6914 - accuracy30: 0.5753 - val_loss: 3.1104 - val_accuracy30: 0.5073 - 116s/epoch - 46ms/step
Epoch 23/50
2538/2538 - 115s - loss: 2.6889 - accuracy30: 0.5749 - val_loss: 3.1418 - val_accuracy30: 0.5076 - 115s/epoch - 45ms/step
Epoch 24/50
2538/2538 - 115s - loss: 2.6855 - accuracy30: 0.5760 - val_loss: 3.1403 - val_accuracy30: 0.5073 - 115s/epoch - 45ms/step
Epoch 25/50
2538/2538 - 114s - loss: 2.6815 - accuracy30: 0.5765 - val_loss: 3.1523 - val_accuracy30: 0.5076 - 114s/epoch - 45ms/step
Epoch 26/50
2538/2538 - 117s - loss: 2.6789 - accuracy30: 0.5768 - val_loss: 3.1447 - val_accuracy30: 0.5036 - 117s/epoch - 46ms/step
Epoch 27/50
2538/2538 - 118s - loss: 2.6741 - accuracy30: 0.5783 - val_loss: 3.1620 - val_accuracy30: 0.5045 - 118s/epoch - 46ms/step
testing model: results/ATVI/W0/deepLOB_L2/h30
Evaluating performance on  test set...
11876/11876 - 190s - 190s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1608465
{'0': {'precision': 0.541419045581618, 'recall': 0.2745688442506744, 'f1-score': 0.36436031331592694, 'support': 1087658}, '1': {'precision': 0.3303634699647727, 'recall': 0.7635129147105637, 'f1-score': 0.4611796714883164, 'support': 846283}, '2': {'precision': 0.5228596583112293, 'recall': 0.25178671835027094, 'f1-score': 0.33989474808182196, 'support': 1106218}, 'accuracy': 0.4023855331250767, 'macro avg': {'precision': 0.46488072461920665, 'recall': 0.42995615910383633, 'f1-score': 0.3884782442953551, 'support': 3040159}, 'weighted avg': {'precision': 0.4759147499289151, 'recall': 0.4023855331250767, 'f1-score': 0.3824094772741486, 'support': 3040159}}
[[298637 638800 150221]
 [ 96180 646148 103955]
 [156765 670922 278531]]
Evaluating performance on  train set...
2538/2538 - 43s - 43s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0425565
{'0': {'precision': 0.5195722515981375, 'recall': 0.28287081545294884, 'f1-score': 0.3663109135864292, 'support': 186191}, '1': {'precision': 0.5199152989935468, 'recall': 0.7503674962705934, 'f1-score': 0.6142373062644563, 'support': 275513}, '2': {'precision': 0.46809584193649045, 'recall': 0.37518957434240985, 'f1-score': 0.4165248830284985, 'support': 187921}, 'accuracy': 0.507846834712334, 'macro avg': {'precision': 0.5025277975093916, 'recall': 0.469475962021984, 'f1-score': 0.46569103429312797, 'support': 649625}, 'weighted avg': {'precision': 0.5048268456131847, 'recall': 0.507846834712334, 'f1-score': 0.48598488484280694, 'support': 649625}}
[[ 52668  99520  34003]
 [ 22663 206736  46114]
 [ 26037  91378  70506]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0097661
{'0': {'precision': 0.47474391366511937, 'recall': 0.41780573989485476, 'f1-score': 0.4444587061757371, 'support': 58015}, '1': {'precision': 0.5539714466004102, 'recall': 0.6531812739046025, 'f1-score': 0.5994995812060199, 'support': 86019}, '2': {'precision': 0.4723361661203902, 'recall': 0.4051651570759958, 'f1-score': 0.43617975695294026, 'support': 59398}, 'accuracy': 0.5136409217822172, 'macro avg': {'precision': 0.5003505087953065, 'recall': 0.492050723625151, 'f1-score': 0.49337934811156575, 'support': 203432}, 'weighted avg': {'precision': 0.5075413976740214, 'recall': 0.5136409217822172, 'f1-score': 0.5075987628201893, 'support': 203432}}
[[24239 22679 11097]
 [14045 56186 15788]
 [12773 22559 24066]]
training model: results/ATVI/W0/deepLOB_L2/h50
Epoch 1/50
2538/2538 - 121s - loss: 3.1522 - accuracy50: 0.4411 - val_loss: 3.3224 - val_accuracy50: 0.3921 - 121s/epoch - 48ms/step
Epoch 2/50
2538/2538 - 117s - loss: 3.1127 - accuracy50: 0.4601 - val_loss: 3.2821 - val_accuracy50: 0.3976 - 117s/epoch - 46ms/step
Epoch 3/50
2538/2538 - 117s - loss: 3.0659 - accuracy50: 0.4739 - val_loss: 3.3148 - val_accuracy50: 0.3950 - 117s/epoch - 46ms/step
Epoch 4/50
2538/2538 - 118s - loss: 3.0341 - accuracy50: 0.4840 - val_loss: 3.3126 - val_accuracy50: 0.3969 - 118s/epoch - 46ms/step
Epoch 5/50
2538/2538 - 116s - loss: 3.0111 - accuracy50: 0.4914 - val_loss: 3.3498 - val_accuracy50: 0.4036 - 116s/epoch - 46ms/step
Epoch 6/50
2538/2538 - 117s - loss: 2.9874 - accuracy50: 0.4973 - val_loss: 3.3279 - val_accuracy50: 0.4113 - 117s/epoch - 46ms/step
Epoch 7/50
2538/2538 - 116s - loss: 2.9688 - accuracy50: 0.5018 - val_loss: 3.3480 - val_accuracy50: 0.4186 - 116s/epoch - 46ms/step
Epoch 8/50
2538/2538 - 117s - loss: 2.9514 - accuracy50: 0.5059 - val_loss: 3.3453 - val_accuracy50: 0.4226 - 117s/epoch - 46ms/step
Epoch 9/50
2538/2538 - 117s - loss: 2.9357 - accuracy50: 0.5100 - val_loss: 3.3454 - val_accuracy50: 0.4257 - 117s/epoch - 46ms/step
Epoch 10/50
2538/2538 - 117s - loss: 2.9219 - accuracy50: 0.5128 - val_loss: 3.3325 - val_accuracy50: 0.4303 - 117s/epoch - 46ms/step
Epoch 11/50
2538/2538 - 117s - loss: 2.9095 - accuracy50: 0.5157 - val_loss: 3.3542 - val_accuracy50: 0.4303 - 117s/epoch - 46ms/step
Epoch 12/50
2538/2538 - 117s - loss: 2.8968 - accuracy50: 0.5179 - val_loss: 3.3361 - val_accuracy50: 0.4293 - 117s/epoch - 46ms/step
testing model: results/ATVI/W0/deepLOB_L2/h50
Evaluating performance on  test set...
11876/11876 - 188s - 188s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1600991
{'0': {'precision': 0.5225476695572345, 'recall': 0.28085862551238644, 'f1-score': 0.36534944059363533, 'support': 1199778}, '1': {'precision': 0.2138008943526379, 'recall': 0.6733811459918552, 'f1-score': 0.3245545664954161, 'support': 608486}, '2': {'precision': 0.4796641000098155, 'recall': 0.18644364982405157, 'f1-score': 0.2685160937331943, 'support': 1231895}, 'accuracy': 0.321164123323813, 'macro avg': {'precision': 0.405337554639896, 'recall': 0.3802278071094311, 'f1-score': 0.31947336694074857, 'support': 3040159}, 'weighted avg': {'precision': 0.44337544693178566, 'recall': 0.321164123323813, 'f1-score': 0.3179467798804384, 'support': 3040159}}
[[336968 704143 158667]
 [108256 409743  90487]
 [199632 802584 229679]]
Evaluating performance on  train set...
2538/2538 - 44s - 44s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1116384
{'0': {'precision': 0.4556642087677862, 'recall': 0.2907641409732114, 'f1-score': 0.3549994109429961, 'support': 217630}, '1': {'precision': 0.35579107977375324, 'recall': 0.7122672225996112, 'f1-score': 0.4745402449529945, 'support': 213455}, '2': {'precision': 0.45808562661808416, 'recall': 0.1748833165553217, 'f1-score': 0.2531294292186031, 'support': 218540}, 'accuracy': 0.39027900711949204, 'macro avg': {'precision': 0.42318030505320786, 'recall': 0.39263822670938137, 'f1-score': 0.3608896950381979, 'support': 649625}, 'weighted avg': {'precision': 0.4236622967532899, 'recall': 0.39027900711949204, 'f1-score': 0.3600083359652095, 'support': 649625}}
[[ 63279 132515  21836]
 [ 38041 152037  23377]
 [ 37552 142769  38219]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0954164
{'0': {'precision': 0.42898189828560485, 'recall': 0.4649848727531589, 'f1-score': 0.4462584065758104, 'support': 67428}, '1': {'precision': 0.3597328244274809, 'recall': 0.5373432155074116, 'f1-score': 0.4309556470050297, 'support': 66652}, '2': {'precision': 0.4516810134805912, 'recall': 0.20049890414119276, 'f1-score': 0.2777195242517751, 'support': 69352}, 'accuracy': 0.39852628888277164, 'macro avg': {'precision': 0.41346524539789237, 'recall': 0.4009423308005878, 'f1-score': 0.3849778592775384, 'support': 203432}, 'weighted avg': {'precision': 0.4140316434889702, 'recall': 0.39852628888277164, 'f1-score': 0.3837880572804775, 'support': 203432}}
[[31353 28438  7637]
 [21594 35815  9243]
 [20140 35307 13905]]
training model: results/ATVI/W0/deepLOB_L2/h100
Epoch 1/50
2538/2538 - 119s - loss: 3.2457 - accuracy100: 0.3987 - val_loss: 3.3665 - val_accuracy100: 0.3483 - 119s/epoch - 47ms/step
Epoch 2/50
2538/2538 - 117s - loss: 3.2174 - accuracy100: 0.4162 - val_loss: 3.3508 - val_accuracy100: 0.3523 - 117s/epoch - 46ms/step
Epoch 3/50
2538/2538 - 118s - loss: 3.1950 - accuracy100: 0.4261 - val_loss: 3.3579 - val_accuracy100: 0.3471 - 118s/epoch - 46ms/step
Epoch 4/50
2538/2538 - 117s - loss: 3.1822 - accuracy100: 0.4308 - val_loss: 3.3802 - val_accuracy100: 0.3505 - 117s/epoch - 46ms/step
Epoch 5/50
2538/2538 - 117s - loss: 3.1749 - accuracy100: 0.4341 - val_loss: 3.4060 - val_accuracy100: 0.3632 - 117s/epoch - 46ms/step
Epoch 6/50
2538/2538 - 117s - loss: 3.1680 - accuracy100: 0.4371 - val_loss: 3.4254 - val_accuracy100: 0.3677 - 117s/epoch - 46ms/step
Epoch 7/50
2538/2538 - 117s - loss: 3.1606 - accuracy100: 0.4396 - val_loss: 3.4507 - val_accuracy100: 0.3681 - 117s/epoch - 46ms/step
Epoch 8/50
2538/2538 - 117s - loss: 3.1545 - accuracy100: 0.4426 - val_loss: 3.4400 - val_accuracy100: 0.3706 - 117s/epoch - 46ms/step
Epoch 9/50
2538/2538 - 117s - loss: 3.1483 - accuracy100: 0.4449 - val_loss: 3.4460 - val_accuracy100: 0.3545 - 117s/epoch - 46ms/step
Epoch 10/50
2538/2538 - 117s - loss: 3.1422 - accuracy100: 0.4473 - val_loss: 3.4159 - val_accuracy100: 0.3618 - 117s/epoch - 46ms/step
Epoch 11/50
2538/2538 - 116s - loss: 3.1370 - accuracy100: 0.4496 - val_loss: 3.3768 - val_accuracy100: 0.3614 - 116s/epoch - 46ms/step
Epoch 12/50
2538/2538 - 117s - loss: 3.1307 - accuracy100: 0.4521 - val_loss: 3.4449 - val_accuracy100: 0.3571 - 117s/epoch - 46ms/step
testing model: results/ATVI/W0/deepLOB_L2/h100
Evaluating performance on  test set...
11876/11876 - 191s - 191s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1734174
{'0': {'precision': 0.4172769676437374, 'recall': 0.1830684101507167, 'f1-score': 0.25448761291273075, 'support': 1160588}, '1': {'precision': 0.2345828958835114, 'recall': 0.7862081257528237, 'f1-score': 0.36134914002398083, 'support': 695714}, '2': {'precision': 0.428871783549436, 'recall': 0.07219537494815674, 'f1-score': 0.12358646418126805, 'support': 1183857}, 'accuracy': 0.27791704315465077, 'macro avg': {'precision': 0.36024388235889493, 'recall': 0.3471573036172324, 'f1-score': 0.24647440570599322, 'support': 3040159}, 'weighted avg': {'precision': 0.3799841091232057, 'recall': 0.27791704315465077, 'f1-score': 0.22796821680183424, 'support': 3040159}}
[[212467 877254  70867]
 [105786 546976  42952]
 [190922 907466  85469]]
Evaluating performance on  train set...
2538/2538 - 42s - 42s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1340748
{'0': {'precision': 0.39510359680174273, 'recall': 0.14350062035854927, 'f1-score': 0.21053534094431584, 'support': 222452}, '1': {'precision': 0.328591827233076, 'recall': 0.8081941057251415, 'f1-score': 0.4672224915172079, 'support': 208711}, '2': {'precision': 0.39041663663230736, 'recall': 0.09917056513260887, 'f1-score': 0.1581652394197566, 'support': 218462}, 'accuracy': 0.34214508370213587, 'macro avg': {'precision': 0.37137068688904207, 'recall': 0.3502884304054332, 'f1-score': 0.2786410239604268, 'support': 649625}, 'weighted avg': {'precision': 0.3721585737022913, 'recall': 0.34214508370213587, 'f1-score': 0.2753920733113901, 'support': 649625}}
[[ 31922 172161  18369]
 [ 24574 168679  15458]
 [ 24298 172499  21665]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1211865
{'0': {'precision': 0.4036670926684228, 'recall': 0.22513637355444033, 'f1-score': 0.2890573931232841, 'support': 68745}, '1': {'precision': 0.33384366938612864, 'recall': 0.7301834862385321, 'f1-score': 0.45819720499129263, 'support': 65400}, '2': {'precision': 0.38044267053701014, 'recall': 0.12106167102053776, 'f1-score': 0.18367548037444573, 'support': 69287}, 'accuracy': 0.35205375752094065, 'macro avg': {'precision': 0.3726511441971872, 'recall': 0.35879384360450334, 'f1-score': 0.31031002616300746, 'support': 203432}, 'weighted avg': {'precision': 0.37331000814444804, 'recall': 0.35205375752094065, 'f1-score': 0.30754095081105687, 'support': 203432}}
[[15477 46513  6755]
 [10741 47754  6905]
 [12123 48776  8388]]
training model: results/ATVI/W0/deepLOB_L2/h200
Epoch 1/50
2538/2538 - 121s - loss: 3.2787 - accuracy200: 0.3779 - val_loss: 3.3496 - val_accuracy200: 0.3473 - 121s/epoch - 48ms/step
Epoch 2/50
2538/2538 - 116s - loss: 3.2539 - accuracy200: 0.3908 - val_loss: 3.4077 - val_accuracy200: 0.3535 - 116s/epoch - 46ms/step
Epoch 3/50
2538/2538 - 117s - loss: 3.2358 - accuracy200: 0.4014 - val_loss: 3.4820 - val_accuracy200: 0.3469 - 117s/epoch - 46ms/step
Epoch 4/50
2538/2538 - 116s - loss: 3.2242 - accuracy200: 0.4087 - val_loss: 3.4990 - val_accuracy200: 0.3438 - 116s/epoch - 46ms/step
Epoch 5/50
2538/2538 - 116s - loss: 3.2169 - accuracy200: 0.4118 - val_loss: 3.5168 - val_accuracy200: 0.3442 - 116s/epoch - 46ms/step
Epoch 6/50
2538/2538 - 118s - loss: 3.2098 - accuracy200: 0.4153 - val_loss: 3.5815 - val_accuracy200: 0.3457 - 118s/epoch - 47ms/step
Epoch 7/50
2538/2538 - 116s - loss: 3.2036 - accuracy200: 0.4182 - val_loss: 3.6235 - val_accuracy200: 0.3483 - 116s/epoch - 46ms/step
Epoch 8/50
2538/2538 - 117s - loss: 3.1980 - accuracy200: 0.4211 - val_loss: 3.7004 - val_accuracy200: 0.3439 - 117s/epoch - 46ms/step
Epoch 9/50
2538/2538 - 116s - loss: 3.1920 - accuracy200: 0.4241 - val_loss: 3.7405 - val_accuracy200: 0.3460 - 116s/epoch - 46ms/step
Epoch 10/50
2538/2538 - 117s - loss: 3.1883 - accuracy200: 0.4243 - val_loss: 3.7342 - val_accuracy200: 0.3453 - 117s/epoch - 46ms/step
Epoch 11/50
2538/2538 - 117s - loss: 3.1812 - accuracy200: 0.4280 - val_loss: 3.7582 - val_accuracy200: 0.3444 - 117s/epoch - 46ms/step
testing model: results/ATVI/W0/deepLOB_L2/h200
Evaluating performance on  test set...
11876/11876 - 187s - 187s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1331773
{'0': {'precision': 0.39029723377919306, 'recall': 0.06345366216911048, 'f1-score': 0.1091602861345528, 'support': 1128020}, '1': {'precision': 0.2479819860590641, 'recall': 0.6028437875665464, 'f1-score': 0.35141013438528684, 'support': 745344}, '2': {'precision': 0.37706228142544584, 'recall': 0.3376505727227148, 'f1-score': 0.3562697789371021, 'support': 1166795}, 'accuracy': 0.3009289974636195, 'macro avg': {'precision': 0.338447167087901, 'recall': 0.3346493408194573, 'f1-score': 0.27228006648564723, 'support': 3040159}, 'weighted avg': {'precision': 0.3503268597861544, 'recall': 0.3009289974636195, 'f1-score': 0.26339090089817063, 'support': 3040159}}
[[ 71577 659486 396957]
 [ 42106 449326 253912]
 [ 69708 703118 393969]]
Evaluating performance on  train set...
2538/2538 - 43s - 43s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1232796
{'0': {'precision': 0.35385175496554794, 'recall': 0.12143171143657018, 'f1-score': 0.18081346075668525, 'support': 216105}, '1': {'precision': 0.35252852197047496, 'recall': 0.3683369400856566, 'f1-score': 0.3602593934939081, 'support': 220882}, '2': {'precision': 0.3360073344029338, 'recall': 0.5446533545274128, 'f1-score': 0.41561414998699125, 'support': 212638}, 'accuracy': 0.3439137964210121, 'macro avg': {'precision': 0.3474625371129856, 'recall': 0.3448073353498799, 'f1-score': 0.31889566807919484, 'support': 649625}, 'weighted avg': {'precision': 0.34756092525608345, 'recall': 0.3439137964210121, 'f1-score': 0.3186836558252511, 'support': 649625}}
[[ 26242  77020 112843]
 [ 23503  81359 116020]
 [ 24416  72408 115814]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1175638
{'0': {'precision': 0.3518354860639021, 'recall': 0.15578063389820304, 'f1-score': 0.21594725971668785, 'support': 66446}, '1': {'precision': 0.3476141496355261, 'recall': 0.33404480861792346, 'f1-score': 0.34069442110876536, 'support': 69808}, '2': {'precision': 0.3458556612331547, 'recall': 0.5505076066569412, 'f1-score': 0.4248192203644885, 'support': 67178}, 'accuracy': 0.3473003263989933, 'macro avg': {'precision': 0.3484350989775276, 'recall': 0.34677768305768925, 'f1-score': 0.3271536337299806, 'support': 203432}, 'weighted avg': {'precision': 0.3484122501626082, 'recall': 0.3473003263989933, 'f1-score': 0.32772883987544404, 'support': 203432}}
[[10351 21952 34143]
 [10685 23319 35804]
 [ 8384 21812 36982]]
training model: results/ATVI/W0/deepLOB_L2/h300
Epoch 1/50
2538/2538 - 120s - loss: 3.2885 - accuracy300: 0.3716 - val_loss: 3.3371 - val_accuracy300: 0.3563 - 120s/epoch - 47ms/step
Epoch 2/50
2538/2538 - 116s - loss: 3.2694 - accuracy300: 0.3802 - val_loss: 3.3921 - val_accuracy300: 0.3464 - 116s/epoch - 46ms/step
Epoch 3/50
2538/2538 - 116s - loss: 3.2596 - accuracy300: 0.3890 - val_loss: 3.4054 - val_accuracy300: 0.3455 - 116s/epoch - 46ms/step
Epoch 4/50
2538/2538 - 117s - loss: 3.2502 - accuracy300: 0.3955 - val_loss: 3.5077 - val_accuracy300: 0.3446 - 117s/epoch - 46ms/step
Epoch 5/50
2538/2538 - 116s - loss: 3.2391 - accuracy300: 0.4031 - val_loss: 3.5284 - val_accuracy300: 0.3441 - 116s/epoch - 46ms/step
Epoch 6/50
2538/2538 - 118s - loss: 3.2319 - accuracy300: 0.4071 - val_loss: 3.5506 - val_accuracy300: 0.3474 - 118s/epoch - 46ms/step
Epoch 7/50
2538/2538 - 115s - loss: 3.2250 - accuracy300: 0.4099 - val_loss: 3.5643 - val_accuracy300: 0.3484 - 115s/epoch - 45ms/step
Epoch 8/50
2538/2538 - 116s - loss: 3.2211 - accuracy300: 0.4120 - val_loss: 3.6186 - val_accuracy300: 0.3471 - 116s/epoch - 46ms/step
Epoch 9/50
2538/2538 - 116s - loss: 3.2149 - accuracy300: 0.4156 - val_loss: 3.6262 - val_accuracy300: 0.3477 - 116s/epoch - 46ms/step
Epoch 10/50
2538/2538 - 116s - loss: 3.2089 - accuracy300: 0.4191 - val_loss: 3.6287 - val_accuracy300: 0.3477 - 116s/epoch - 46ms/step
Epoch 11/50
2538/2538 - 116s - loss: 3.2041 - accuracy300: 0.4200 - val_loss: 3.6654 - val_accuracy300: 0.3482 - 116s/epoch - 46ms/step
testing model: results/ATVI/W0/deepLOB_L2/h300
Evaluating performance on  test set...
11876/11876 - 182s - 182s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.141045
{'0': {'precision': 0.40016570008285, 'recall': 0.0008582364041493864, 'f1-score': 0.0017127993631081456, 'support': 1125564}, '1': {'precision': 0.2446965002484271, 'recall': 0.7018769882784978, 'f1-score': 0.36288115971625257, 'support': 749392}, '2': {'precision': 0.3823350269808978, 'recall': 0.29144964439672744, 'f1-score': 0.3307626676224686, 'support': 1165203}, 'accuracy': 0.28503278940344895, 'macro avg': {'precision': 0.342399075770725, 'recall': 0.33139495635979155, 'f1-score': 0.2317855422339431, 'support': 3040159}, 'weighted avg': {'precision': 0.35500894071837863, 'recall': 0.28503278940344895, 'f1-score': 0.21685502499906176, 'support': 3040159}}
[[   966 798807 325791]
 [   579 525981 222832]
 [   869 824736 339598]]
Evaluating performance on  train set...
2538/2538 - 42s - 42s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.119391
{'0': {'precision': 0.3884418434528164, 'recall': 0.014359695498735751, 'f1-score': 0.02769555749696835, 'support': 221871}, '1': {'precision': 0.33344508356189334, 'recall': 0.6024428514877929, 'f1-score': 0.4292856001930351, 'support': 209673}, '2': {'precision': 0.3572402342708738, 'recall': 0.43017044125806464, 'f1-score': 0.39032792921738435, 'support': 218081}, 'accuracy': 0.343758322108909, 'macro avg': {'precision': 0.3597090537618612, 'recall': 0.3489909960815311, 'f1-score': 0.2824363623024626, 'support': 649625}, 'weighted avg': {'precision': 0.36021661540799554, 'recall': 0.343758322108909, 'f1-score': 0.2790495221371414, 'support': 649625}}
[[  3186 130624  88061]
 [  2628 126316  80729]
 [  2388 121881  93812]]
Evaluating performance on  val set...
795/795 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1163454
{'0': {'precision': 0.39186295503211993, 'recall': 0.013360199745937185, 'f1-score': 0.02583942842619525, 'support': 68487}, '1': {'precision': 0.3418013856812933, 'recall': 0.6427232693860758, 'f1-score': 0.44627364678996145, 'support': 65627}, '2': {'precision': 0.37550841785512024, 'recall': 0.42087192359848813, 'f1-score': 0.39689817019250395, 'support': 69318}, 'accuracy': 0.35524892838884736, 'macro avg': {'precision': 0.36972425285617777, 'recall': 0.35898513091016704, 'f1-score': 0.2896704151362202, 'support': 203432}, 'weighted avg': {'precision': 0.37014044126918216, 'recall': 0.35524892838884736, 'f1-score': 0.2879067841534942, 'support': 203432}}
[[  915 41786 25786]
 [  715 42180 22732]
 [  705 39439 29174]]
training model: results/ATVI/W0/deepLOB_L2/h500
Epoch 1/50
2538/2538 - 119s - loss: 3.2454 - accuracy500: 0.4041 - val_loss: 3.2912 - val_accuracy500: 0.3637 - 119s/epoch - 47ms/step
Epoch 2/50
2538/2538 - 123s - loss: 3.2129 - accuracy500: 0.4207 - val_loss: 3.4106 - val_accuracy500: 0.3734 - 123s/epoch - 48ms/step
Epoch 3/50
2538/2538 - 115s - loss: 3.1832 - accuracy500: 0.4346 - val_loss: 3.4238 - val_accuracy500: 0.3647 - 115s/epoch - 45ms/step
Epoch 4/50
2538/2538 - 116s - loss: 3.1732 - accuracy500: 0.4406 - val_loss: 3.3957 - val_accuracy500: 0.3770 - 116s/epoch - 46ms/step
Epoch 5/50
2538/2538 - 115s - loss: 3.1652 - accuracy500: 0.4433 - val_loss: 3.3754 - val_accuracy500: 0.3647 - 115s/epoch - 45ms/step
Epoch 6/50
2538/2538 - 116s - loss: 3.1573 - accuracy500: 0.4478 - val_loss: 3.4004 - val_accuracy500: 0.3527 - 116s/epoch - 46ms/step
Epoch 7/50
2538/2538 - 116s - loss: 3.1505 - accuracy500: 0.4511 - val_loss: 3.3886 - val_accuracy500: 0.3663 - 116s/epoch - 46ms/step
Epoch 8/50
2538/2538 - 116s - loss: 3.1430 - accuracy500: 0.4529 - val_loss: 3.4166 - val_accuracy500: 0.3680 - 116s/epoch - 46ms/step
Epoch 9/50
2538/2538 - 116s - loss: 3.1366 - accuracy500: 0.4561 - val_loss: 3.4284 - val_accuracy500: 0.3514 - 116s/epoch - 46ms/step
Epoch 10/50
2538/2538 - 115s - loss: 3.1274 - accuracy500: 0.4595 - val_loss: 3.4738 - val_accuracy500: 0.3380 - 115s/epoch - 45ms/step
Epoch 11/50
2538/2538 - 115s - loss: 3.1200 - accuracy500: 0.4619 - val_loss: 3.5089 - val_accuracy500: 0.3361 - 115s/epoch - 45ms/step
testing model: results/ATVI/W0/deepLOB_L2/h500
Evaluating performance on  test set...
11876/11876 - 187s - 187s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1031889
{'0': {'precision': 0.39358803853521557, 'recall': 0.1900496323235452, 'f1-score': 0.2563277380656425, 'support': 1188137}, '1': {'precision': 0.20072019726313603, 'recall': 0.3390958496034781, 'f1-score': 0.25217251772561317, 'support': 621025}, '2': {'precision': 0.39704140216596, 'recall': 0.4571286526287229, 'f1-score': 0.4249715854381506, 'support': 1230997}, 'accuracy': 0.32863939024241823, 'macro avg': {'precision': 0.3304498793214372, 'recall': 0.3287580448519154, 'f1-score': 0.3111572804098021, 'support': 3040159}, 'weighted avg': {'precision': 0.35558848954562733, 'recall': 0.32863939024241823, 'f1-score': 0.32376486042416014, 'support': 3040159}}
[[225805 406311 556021]
 [111890 210587 298548]
 [236014 432259 562724]]
Evaluating performance on  train set...
2538/2538 - 42s - 42s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0962979
{'0': {'precision': 0.33042820205587436, 'recall': 0.24037288166695722, 'f1-score': 0.27829652527698995, 'support': 217978}, '1': {'precision': 0.4281724736767996, 'recall': 0.25190070321416735, 'f1-score': 0.31719218131559274, 'support': 217288}, '2': {'precision': 0.3534046764917227, 'recall': 0.5988272010972248, 'f1-score': 0.4444890751064788, 'support': 214359}, 'accuracy': 0.36250913988839717, 'macro avg': {'precision': 0.37066845074146554, 'recall': 0.36370026199278316, 'f1-score': 0.3466592605663538, 'support': 649625}, 'weighted avg': {'precision': 0.37070354764072966, 'recall': 0.36250913988839717, 'f1-score': 0.34614555833177585, 'support': 649625}}
[[ 52396  37524 128058]
 [ 55754  54735 106799]
 [ 50420  35575 128364]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0969285
{'0': {'precision': 0.3403926535782141, 'recall': 0.19569206571128975, 'f1-score': 0.24851348727101227, 'support': 68664}, '1': {'precision': 0.4228654843618971, 'recall': 0.20840668003490026, 'f1-score': 0.27920759592313843, 'support': 65329}, '2': {'precision': 0.3554341226472374, 'recall': 0.6744336756001671, 'f1-score': 0.46552915272938733, 'support': 69439}, 'accuracy': 0.3631876990837233, 'macro avg': {'precision': 0.3728974201957828, 'recall': 0.3595108071154523, 'f1-score': 0.3310834119745127, 'support': 203432}, 'weighted avg': {'precision': 0.37201173087653067, 'recall': 0.3631876990837233, 'f1-score': 0.332446035827281, 'support': 203432}}
[[13437  8896 46331]
 [13117 13615 38597]
 [12921  9686 46832]]
training model: results/ATVI/W0/deepLOB_L2/h1000
Epoch 1/50
2538/2538 - 120s - loss: 3.2551 - accuracy1000: 0.4034 - val_loss: 3.4274 - val_accuracy1000: 0.3389 - 120s/epoch - 47ms/step
Epoch 2/50
2538/2538 - 115s - loss: 3.1795 - accuracy1000: 0.4384 - val_loss: 3.5292 - val_accuracy1000: 0.3187 - 115s/epoch - 45ms/step
Epoch 3/50
2538/2538 - 115s - loss: 3.1468 - accuracy1000: 0.4506 - val_loss: 3.7378 - val_accuracy1000: 0.3267 - 115s/epoch - 45ms/step
Epoch 4/50
2538/2538 - 116s - loss: 3.1290 - accuracy1000: 0.4579 - val_loss: 3.7917 - val_accuracy1000: 0.3254 - 116s/epoch - 46ms/step
Epoch 5/50
2538/2538 - 115s - loss: 3.1125 - accuracy1000: 0.4647 - val_loss: 3.7610 - val_accuracy1000: 0.3226 - 115s/epoch - 45ms/step
Epoch 6/50
2538/2538 - 116s - loss: 3.0996 - accuracy1000: 0.4700 - val_loss: 3.8625 - val_accuracy1000: 0.3150 - 116s/epoch - 46ms/step
Epoch 7/50
2538/2538 - 115s - loss: 3.0870 - accuracy1000: 0.4743 - val_loss: 3.8702 - val_accuracy1000: 0.3192 - 115s/epoch - 45ms/step
Epoch 8/50
2538/2538 - 115s - loss: 3.0786 - accuracy1000: 0.4758 - val_loss: 4.0248 - val_accuracy1000: 0.3303 - 115s/epoch - 45ms/step
Epoch 9/50
2538/2538 - 115s - loss: 3.0668 - accuracy1000: 0.4787 - val_loss: 3.9295 - val_accuracy1000: 0.3234 - 115s/epoch - 45ms/step
Epoch 10/50
2538/2538 - 115s - loss: 3.0567 - accuracy1000: 0.4829 - val_loss: 3.9900 - val_accuracy1000: 0.3253 - 115s/epoch - 45ms/step
Epoch 11/50
2538/2538 - 115s - loss: 3.0473 - accuracy1000: 0.4854 - val_loss: 3.9165 - val_accuracy1000: 0.3325 - 115s/epoch - 45ms/step
testing model: results/ATVI/W0/deepLOB_L2/h1000
Evaluating performance on  test set...
11876/11876 - 185s - 185s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1644593
{'0': {'precision': 0.3740920158134779, 'recall': 0.06462509783003152, 'f1-score': 0.11021103288450383, 'support': 1143565}, '1': {'precision': 0.22798517684170766, 'recall': 0.7492357005763524, 'f1-score': 0.34959268193969434, 'support': 715361}, '2': {'precision': 0.3768248286521996, 'recall': 0.15685389757990167, 'f1-score': 0.22150571185882437, 'support': 1181233}, 'accuracy': 0.26155145174972755, 'macro avg': {'precision': 0.32630067376912836, 'recall': 0.32357156532876186, 'f1-score': 0.22710314222767417, 'support': 3040159}, 'weighted avg': {'precision': 0.3407743354797313, 'recall': 0.26155145174972755, 'f1-score': 0.20978123410708582, 'support': 3040159}}
[[ 73903 897325 172337]
 [ 45315 535974 134072]
 [ 78335 917617 185281]]
Evaluating performance on  train set...
2538/2538 - 44s - 44s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1351928
{'0': {'precision': 0.33022879125329013, 'recall': 0.03765908713079779, 'f1-score': 0.06760817930468449, 'support': 216548}, '1': {'precision': 0.34314160424522666, 'recall': 0.7198067200572681, 'f1-score': 0.46473685882900084, 'support': 223510}, '2': {'precision': 0.3172213180926996, 'recall': 0.23624902775723278, 'f1-score': 0.2708120807021095, 'support': 209567}, 'accuracy': 0.33642332114681545, 'macro avg': {'precision': 0.33019723786373884, 'recall': 0.33123827831509955, 'f1-score': 0.2677190396119316, 'support': 649625}, 'weighted avg': {'precision': 0.3304754038436034, 'recall': 0.33642332114681545, 'f1-score': 0.2697972317035825, 'support': 649625}}
[[  8155 155687  52706]
 [  8768 160884  53858]
 [  7772 152285  49510]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1403663
{'0': {'precision': 0.33494710417787343, 'recall': 0.02769212523719165, 'f1-score': 0.05115495734804814, 'support': 67456}, '1': {'precision': 0.3414274215186477, 'recall': 0.5263002407716509, 'f1-score': 0.4141698875359623, 'support': 67699}, '2': {'precision': 0.33709451437983295, 'recall': 0.4616195790676216, 'f1-score': 0.38964988626248637, 'support': 68277}, 'accuracy': 0.3392583271068465, 'macro avg': {'precision': 0.3378230133587847, 'recall': 0.33853731502548806, 'f1-score': 0.28499157704883227, 'support': 203432}, 'weighted avg': {'precision': 0.33782437879549637, 'recall': 0.3392583271068465, 'f1-score': 0.2855682552573382, 'support': 203432}}
[[ 1868 33767 31821]
 [ 1909 35630 30160]
 [ 1800 34959 31518]]
training model: results/ATVI/W0/deepOF_L2/h10
Epoch 1/50
2538/2538 - 79s - loss: 2.9054 - accuracy10: 0.5098 - val_loss: 3.0523 - val_accuracy10: 0.6232 - 79s/epoch - 31ms/step
Epoch 2/50
2538/2538 - 76s - loss: 2.6935 - accuracy10: 0.5790 - val_loss: 2.9455 - val_accuracy10: 0.6161 - 76s/epoch - 30ms/step
Epoch 3/50
2538/2538 - 76s - loss: 2.6484 - accuracy10: 0.5862 - val_loss: 2.9172 - val_accuracy10: 0.6064 - 76s/epoch - 30ms/step
Epoch 4/50
2538/2538 - 76s - loss: 2.6276 - accuracy10: 0.5879 - val_loss: 2.9004 - val_accuracy10: 0.6060 - 76s/epoch - 30ms/step
Epoch 5/50
2538/2538 - 75s - loss: 2.6140 - accuracy10: 0.5894 - val_loss: 2.8952 - val_accuracy10: 0.6050 - 75s/epoch - 30ms/step
Epoch 6/50
2538/2538 - 74s - loss: 2.6033 - accuracy10: 0.5904 - val_loss: 2.8911 - val_accuracy10: 0.6040 - 74s/epoch - 29ms/step
Epoch 7/50
2538/2538 - 76s - loss: 2.5932 - accuracy10: 0.5918 - val_loss: 2.8875 - val_accuracy10: 0.6052 - 76s/epoch - 30ms/step
Epoch 8/50
2538/2538 - 73s - loss: 2.5849 - accuracy10: 0.5926 - val_loss: 2.9003 - val_accuracy10: 0.6063 - 73s/epoch - 29ms/step
Epoch 9/50
2538/2538 - 75s - loss: 2.5785 - accuracy10: 0.5932 - val_loss: 2.8924 - val_accuracy10: 0.6073 - 75s/epoch - 29ms/step
Epoch 10/50
2538/2538 - 75s - loss: 2.5726 - accuracy10: 0.5946 - val_loss: 2.9000 - val_accuracy10: 0.6085 - 75s/epoch - 30ms/step
Epoch 11/50
2538/2538 - 74s - loss: 2.5669 - accuracy10: 0.5952 - val_loss: 2.8943 - val_accuracy10: 0.6070 - 74s/epoch - 29ms/step
Epoch 12/50
2538/2538 - 76s - loss: 2.5605 - accuracy10: 0.5957 - val_loss: 2.8888 - val_accuracy10: 0.6084 - 76s/epoch - 30ms/step
Epoch 13/50
2538/2538 - 76s - loss: 2.5564 - accuracy10: 0.5967 - val_loss: 2.8917 - val_accuracy10: 0.6106 - 76s/epoch - 30ms/step
Epoch 14/50
2538/2538 - 74s - loss: 2.5510 - accuracy10: 0.5974 - val_loss: 2.8967 - val_accuracy10: 0.6091 - 74s/epoch - 29ms/step
Epoch 15/50
2538/2538 - 75s - loss: 2.5462 - accuracy10: 0.5977 - val_loss: 2.9038 - val_accuracy10: 0.6090 - 75s/epoch - 29ms/step
Epoch 16/50
2538/2538 - 74s - loss: 2.5429 - accuracy10: 0.5986 - val_loss: 2.8977 - val_accuracy10: 0.6084 - 74s/epoch - 29ms/step
Epoch 17/50
2538/2538 - 76s - loss: 2.5377 - accuracy10: 0.5985 - val_loss: 2.9086 - val_accuracy10: 0.6119 - 76s/epoch - 30ms/step
testing model: results/ATVI/W0/deepOF_L2/h10
Evaluating performance on  test set...
11876/11876 - 182s - 182s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.083413
{'0': {'precision': 0.4470339347659871, 'recall': 0.4630891712445467, 'f1-score': 0.45491993995496627, 'support': 785298}, '1': {'precision': 0.7146861008376962, 'recall': 0.3772238579142791, 'f1-score': 0.4938074719345013, 'support': 1459457}, '2': {'precision': 0.38356548160609755, 'recall': 0.7022840109177909, 'f1-score': 0.49614961691574994, 'support': 795399}, 'accuracy': 0.4844494719675385, 'macro avg': {'precision': 0.5150951724032603, 'recall': 0.5141990133588722, 'f1-score': 0.48162567626840586, 'support': 3040154}, 'weighted avg': {'precision': 0.5589177680071964, 'recall': 0.4844494719675385, 'f1-score': 0.48437526510796397, 'support': 3040154}}
[[363663 110703 310932]
 [322118 550542 586797]
 [127721 109082 558596]]
Evaluating performance on  train set...
2538/2538 - 40s - 40s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8719086
{'0': {'precision': 0.44184507272430135, 'recall': 0.4398324385879291, 'f1-score': 0.4408364585031796, 'support': 122940}, '1': {'precision': 0.7761663280419785, 'recall': 0.7007640722015918, 'f1-score': 0.7365404309570088, 'support': 402318}, '2': {'precision': 0.4051094445460643, 'recall': 0.5342456941607835, 'f1-score': 0.46080117624212835, 'support': 124366}, 'accuracy': 0.6195045133800475, 'macro avg': {'precision': 0.5410402817707815, 'recall': 0.5582807349834348, 'f1-score': 0.5460593552341056, 'support': 649624}, 'weighted avg': {'precision': 0.6418604595678948, 'recall': 0.6195045133800475, 'f1-score': 0.6277907010742696, 'support': 649624}}
[[ 54073  40383  28484]
 [ 51304 281930  69084]
 [ 17003  40921  66442]]
Evaluating performance on  val set...
795/795 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8906915
{'0': {'precision': 0.4217253985227923, 'recall': 0.44303367557541085, 'f1-score': 0.4321170115176842, 'support': 38277}, '1': {'precision': 0.7760978795189465, 'recall': 0.6783273880301228, 'f1-score': 0.7239264322696356, 'support': 126150}, '2': {'precision': 0.39304797688952664, 'recall': 0.5337008075887707, 'f1-score': 0.4527009394572025, 'support': 39005}, 'accuracy': 0.6063254551889575, 'macro avg': {'precision': 0.5302904183104218, 'recall': 0.5516872903981014, 'f1-score': 0.5362481277481741, 'support': 203432}, 'weighted avg': {'precision': 0.6359764782293248, 'recall': 0.6063254551889575, 'f1-score': 0.6170172953331095, 'support': 203432}}
[[16958 12013  9306]
 [17739 85571 22840]
 [ 5514 12674 20817]]
training model: results/ATVI/W0/deepOF_L2/h20
Epoch 1/50
2538/2538 - 77s - loss: 2.9528 - accuracy20: 0.5074 - val_loss: 3.1403 - val_accuracy20: 0.5677 - 77s/epoch - 30ms/step
Epoch 2/50
2538/2538 - 73s - loss: 2.7650 - accuracy20: 0.5671 - val_loss: 3.0515 - val_accuracy20: 0.5672 - 73s/epoch - 29ms/step
Epoch 3/50
2538/2538 - 75s - loss: 2.7265 - accuracy20: 0.5751 - val_loss: 3.0149 - val_accuracy20: 0.5692 - 75s/epoch - 29ms/step
Epoch 4/50
2538/2538 - 75s - loss: 2.7094 - accuracy20: 0.5771 - val_loss: 3.0304 - val_accuracy20: 0.5707 - 75s/epoch - 30ms/step
Epoch 5/50
2538/2538 - 74s - loss: 2.6977 - accuracy20: 0.5792 - val_loss: 3.0210 - val_accuracy20: 0.5732 - 74s/epoch - 29ms/step
Epoch 6/50
2538/2538 - 73s - loss: 2.6883 - accuracy20: 0.5803 - val_loss: 3.0090 - val_accuracy20: 0.5756 - 73s/epoch - 29ms/step
Epoch 7/50
2538/2538 - 75s - loss: 2.6813 - accuracy20: 0.5816 - val_loss: 3.0014 - val_accuracy20: 0.5748 - 75s/epoch - 30ms/step
Epoch 8/50
2538/2538 - 74s - loss: 2.6742 - accuracy20: 0.5825 - val_loss: 3.0000 - val_accuracy20: 0.5754 - 74s/epoch - 29ms/step
Epoch 9/50
2538/2538 - 75s - loss: 2.6687 - accuracy20: 0.5830 - val_loss: 2.9988 - val_accuracy20: 0.5767 - 75s/epoch - 30ms/step
Epoch 10/50
2538/2538 - 73s - loss: 2.6634 - accuracy20: 0.5843 - val_loss: 2.9952 - val_accuracy20: 0.5773 - 73s/epoch - 29ms/step
Epoch 11/50
2538/2538 - 75s - loss: 2.6585 - accuracy20: 0.5849 - val_loss: 2.9815 - val_accuracy20: 0.5770 - 75s/epoch - 29ms/step
Epoch 12/50
2538/2538 - 73s - loss: 2.6542 - accuracy20: 0.5857 - val_loss: 2.9868 - val_accuracy20: 0.5778 - 73s/epoch - 29ms/step
Epoch 13/50
2538/2538 - 75s - loss: 2.6512 - accuracy20: 0.5867 - val_loss: 2.9981 - val_accuracy20: 0.5770 - 75s/epoch - 29ms/step
Epoch 14/50
2538/2538 - 75s - loss: 2.6460 - accuracy20: 0.5876 - val_loss: 3.0017 - val_accuracy20: 0.5780 - 75s/epoch - 30ms/step
Epoch 15/50
2538/2538 - 75s - loss: 2.6426 - accuracy20: 0.5877 - val_loss: 2.9857 - val_accuracy20: 0.5766 - 75s/epoch - 29ms/step
Epoch 16/50
2538/2538 - 74s - loss: 2.6383 - accuracy20: 0.5885 - val_loss: 2.9802 - val_accuracy20: 0.5769 - 74s/epoch - 29ms/step
Epoch 17/50
2538/2538 - 74s - loss: 2.6351 - accuracy20: 0.5892 - val_loss: 2.9973 - val_accuracy20: 0.5778 - 74s/epoch - 29ms/step
Epoch 18/50
2538/2538 - 75s - loss: 2.6309 - accuracy20: 0.5896 - val_loss: 2.9894 - val_accuracy20: 0.5785 - 75s/epoch - 30ms/step
Epoch 19/50
2538/2538 - 76s - loss: 2.6282 - accuracy20: 0.5907 - val_loss: 2.9840 - val_accuracy20: 0.5780 - 76s/epoch - 30ms/step
Epoch 20/50
2538/2538 - 75s - loss: 2.6245 - accuracy20: 0.5909 - val_loss: 3.0047 - val_accuracy20: 0.5791 - 75s/epoch - 30ms/step
Epoch 21/50
2538/2538 - 76s - loss: 2.6207 - accuracy20: 0.5911 - val_loss: 2.9905 - val_accuracy20: 0.5782 - 76s/epoch - 30ms/step
Epoch 22/50
2538/2538 - 76s - loss: 2.6175 - accuracy20: 0.5913 - val_loss: 2.9719 - val_accuracy20: 0.5799 - 76s/epoch - 30ms/step
Epoch 23/50
2538/2538 - 74s - loss: 2.6139 - accuracy20: 0.5925 - val_loss: 2.9936 - val_accuracy20: 0.5768 - 74s/epoch - 29ms/step
Epoch 24/50
2538/2538 - 74s - loss: 2.6117 - accuracy20: 0.5926 - val_loss: 3.0055 - val_accuracy20: 0.5784 - 74s/epoch - 29ms/step
Epoch 25/50
2538/2538 - 74s - loss: 2.6080 - accuracy20: 0.5928 - val_loss: 2.9954 - val_accuracy20: 0.5752 - 74s/epoch - 29ms/step
Epoch 26/50
2538/2538 - 74s - loss: 2.6054 - accuracy20: 0.5933 - val_loss: 3.0061 - val_accuracy20: 0.5745 - 74s/epoch - 29ms/step
Epoch 27/50
2538/2538 - 74s - loss: 2.6015 - accuracy20: 0.5936 - val_loss: 2.9876 - val_accuracy20: 0.5743 - 74s/epoch - 29ms/step
Epoch 28/50
2538/2538 - 76s - loss: 2.5981 - accuracy20: 0.5946 - val_loss: 2.9964 - val_accuracy20: 0.5753 - 76s/epoch - 30ms/step
Epoch 29/50
2538/2538 - 74s - loss: 2.5961 - accuracy20: 0.5950 - val_loss: 3.0165 - val_accuracy20: 0.5734 - 74s/epoch - 29ms/step
Epoch 30/50
2538/2538 - 74s - loss: 2.5928 - accuracy20: 0.5955 - val_loss: 2.9935 - val_accuracy20: 0.5745 - 74s/epoch - 29ms/step
Epoch 31/50
2538/2538 - 74s - loss: 2.5906 - accuracy20: 0.5962 - val_loss: 3.0008 - val_accuracy20: 0.5733 - 74s/epoch - 29ms/step
Epoch 32/50
2538/2538 - 74s - loss: 2.5879 - accuracy20: 0.5964 - val_loss: 3.0097 - val_accuracy20: 0.5746 - 74s/epoch - 29ms/step
testing model: results/ATVI/W0/deepOF_L2/h20
Evaluating performance on  test set...
11876/11876 - 188s - 188s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0134425
{'0': {'precision': 0.5458190882064012, 'recall': 0.3868285239274272, 'f1-score': 0.4527720641223268, 'support': 981029}, '1': {'precision': 0.5813111272961162, 'recall': 0.4611865592820011, 'f1-score': 0.5143280069043074, 'support': 1066074}, '2': {'precision': 0.4497085272538191, 'recall': 0.6788805408785652, 'f1-score': 0.541026626679967, 'support': 993051}, 'accuracy': 0.5083005663528887, 'macro avg': {'precision': 0.5256129142521121, 'recall': 0.5089652080293311, 'f1-score': 0.5027088992355337, 'support': 3040154}, 'weighted avg': {'precision': 0.5268708544708754, 'recall': 0.5083005663528887, 'f1-score': 0.5031854549399579, 'support': 3040154}}
[[379490 188160 413379]
 [162846 491659 411569]
 [152931 165957 674163]]
Evaluating performance on  train set...
2538/2538 - 40s - 40s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89847386
{'0': {'precision': 0.5498607396989017, 'recall': 0.3683199246302793, 'f1-score': 0.44114339164615884, 'support': 161338}, '1': {'precision': 0.6605990819754878, 'recall': 0.7731977796103241, 'f1-score': 0.7124771396572012, 'support': 324988}, '2': {'precision': 0.4877800596881573, 'recall': 0.48142659432448653, 'f1-score': 0.4845825024886815, 'support': 163298}, 'accuracy': 0.5993005184537518, 'macro avg': {'precision': 0.5660799604541823, 'recall': 0.54098143285503, 'f1-score': 0.5460676779306805, 'support': 649624}, 'weighted avg': {'precision': 0.5896544996206234, 'recall': 0.5993005184537518, 'f1-score': 0.5878032010450955, 'support': 649624}}
[[ 59424  65332  36582]
 [ 27735 251280  45973]
 [ 20912  63770  78616]]
Evaluating performance on  val set...
795/795 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92891365
{'0': {'precision': 0.510137741046832, 'recall': 0.36855408498358044, 'f1-score': 0.4279392223698654, 'support': 50245}, '1': {'precision': 0.6579054280818893, 'recall': 0.7320433573443135, 'f1-score': 0.6929971858501757, 'support': 101759}, '2': {'precision': 0.4638073683819983, 'recall': 0.48615540172668587, 'f1-score': 0.4747185144397821, 'support': 51428}, 'accuracy': 0.580105391482166, 'macro avg': {'precision': 0.5439501791702398, 'recall': 0.5289176146848599, 'f1-score': 0.5318849742199411, 'support': 203432}, 'weighted avg': {'precision': 0.5723404115194879, 'recall': 0.580105391482166, 'f1-score': 0.5723501249730181, 'support': 203432}}
[[18518 19364 12363]
 [10726 74492 16541]
 [ 7056 19370 25002]]
training model: results/ATVI/W0/deepOF_L2/h30
Epoch 1/50
2538/2538 - 77s - loss: 2.9959 - accuracy30: 0.4952 - val_loss: 3.2231 - val_accuracy30: 0.5148 - 77s/epoch - 30ms/step
Epoch 2/50
2538/2538 - 74s - loss: 2.8305 - accuracy30: 0.5453 - val_loss: 3.1102 - val_accuracy30: 0.5226 - 74s/epoch - 29ms/step
Epoch 3/50
2538/2538 - 75s - loss: 2.7960 - accuracy30: 0.5537 - val_loss: 3.1277 - val_accuracy30: 0.5262 - 75s/epoch - 29ms/step
Epoch 4/50
2538/2538 - 75s - loss: 2.7808 - accuracy30: 0.5563 - val_loss: 3.1147 - val_accuracy30: 0.5294 - 75s/epoch - 29ms/step
Epoch 5/50
2538/2538 - 76s - loss: 2.7706 - accuracy30: 0.5589 - val_loss: 3.0930 - val_accuracy30: 0.5319 - 76s/epoch - 30ms/step
Epoch 6/50
2538/2538 - 75s - loss: 2.7630 - accuracy30: 0.5598 - val_loss: 3.0967 - val_accuracy30: 0.5333 - 75s/epoch - 30ms/step
Epoch 7/50
2538/2538 - 75s - loss: 2.7562 - accuracy30: 0.5612 - val_loss: 3.0910 - val_accuracy30: 0.5344 - 75s/epoch - 29ms/step
Epoch 8/50
2538/2538 - 76s - loss: 2.7502 - accuracy30: 0.5625 - val_loss: 3.0802 - val_accuracy30: 0.5351 - 76s/epoch - 30ms/step
Epoch 9/50
2538/2538 - 74s - loss: 2.7451 - accuracy30: 0.5630 - val_loss: 3.0833 - val_accuracy30: 0.5354 - 74s/epoch - 29ms/step
Epoch 10/50
2538/2538 - 75s - loss: 2.7410 - accuracy30: 0.5641 - val_loss: 3.0756 - val_accuracy30: 0.5355 - 75s/epoch - 30ms/step
Epoch 11/50
2538/2538 - 75s - loss: 2.7370 - accuracy30: 0.5648 - val_loss: 3.0811 - val_accuracy30: 0.5365 - 75s/epoch - 30ms/step
Epoch 12/50
2538/2538 - 75s - loss: 2.7324 - accuracy30: 0.5654 - val_loss: 3.0685 - val_accuracy30: 0.5372 - 75s/epoch - 30ms/step
Epoch 13/50
2538/2538 - 75s - loss: 2.7291 - accuracy30: 0.5660 - val_loss: 3.0738 - val_accuracy30: 0.5374 - 75s/epoch - 29ms/step
Epoch 14/50
2538/2538 - 75s - loss: 2.7252 - accuracy30: 0.5672 - val_loss: 3.0904 - val_accuracy30: 0.5359 - 75s/epoch - 30ms/step
Epoch 15/50
2538/2538 - 74s - loss: 2.7216 - accuracy30: 0.5680 - val_loss: 3.0983 - val_accuracy30: 0.5366 - 74s/epoch - 29ms/step
Epoch 16/50
2538/2538 - 76s - loss: 2.7180 - accuracy30: 0.5686 - val_loss: 3.0941 - val_accuracy30: 0.5345 - 76s/epoch - 30ms/step
Epoch 17/50
2538/2538 - 74s - loss: 2.7149 - accuracy30: 0.5693 - val_loss: 3.0903 - val_accuracy30: 0.5371 - 74s/epoch - 29ms/step
Epoch 18/50
2538/2538 - 74s - loss: 2.7121 - accuracy30: 0.5697 - val_loss: 3.1078 - val_accuracy30: 0.5367 - 74s/epoch - 29ms/step
Epoch 19/50
2538/2538 - 73s - loss: 2.7086 - accuracy30: 0.5705 - val_loss: 3.0978 - val_accuracy30: 0.5360 - 73s/epoch - 29ms/step
Epoch 20/50
2538/2538 - 72s - loss: 2.7054 - accuracy30: 0.5711 - val_loss: 3.1010 - val_accuracy30: 0.5372 - 72s/epoch - 28ms/step
Epoch 21/50
2538/2538 - 73s - loss: 2.7027 - accuracy30: 0.5719 - val_loss: 3.0921 - val_accuracy30: 0.5380 - 73s/epoch - 29ms/step
Epoch 22/50
2538/2538 - 74s - loss: 2.7002 - accuracy30: 0.5720 - val_loss: 3.0991 - val_accuracy30: 0.5368 - 74s/epoch - 29ms/step
testing model: results/ATVI/W0/deepOF_L2/h30
Evaluating performance on  test set...
11876/11876 - 178s - 178s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0274861
{'0': {'precision': 0.5149469229146264, 'recall': 0.45103874754517975, 'f1-score': 0.48087880030995034, 'support': 1087656}, '1': {'precision': 0.47239781073480747, 'recall': 0.4581357041742587, 'f1-score': 0.46515746118508905, 'support': 846282}, '2': {'precision': 0.48819302293820965, 'recall': 0.5590400066533119, 'f1-score': 0.5212200591074382, 'support': 1106216}, 'accuracy': 0.49231256048213345, 'macro avg': {'precision': 0.49184591886254786, 'recall': 0.48940481945758346, 'f1-score': 0.48908544020082584, 'support': 3040154}, 'weighted avg': {'precision': 0.49336770687159925, 'recall': 0.49231256048213345, 'f1-score': 0.49118139012107703, 'support': 3040154}}
[[490575 219609 377472]
 [187710 387712 270860]
 [274386 213411 618419]]
Evaluating performance on  train set...
2538/2538 - 38s - 38s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96239424
{'0': {'precision': 0.5446180705741721, 'recall': 0.37170706571913176, 'f1-score': 0.4418483722265644, 'support': 186308}, '1': {'precision': 0.5672964679767578, 'recall': 0.7885982299085913, 'f1-score': 0.659887513650703, 'support': 275466}, '2': {'precision': 0.523591463502028, 'recall': 0.38894330582911896, 'f1-score': 0.44633344736584885, 'support': 187850}, 'accuracy': 0.5534693915249437, 'macro avg': {'precision': 0.545168667350986, 'recall': 0.516416200485614, 'f1-score': 0.5160231110810388, 'support': 649624}, 'weighted avg': {'precision': 0.5481543920161114, 'recall': 0.5534693915249437, 'f1-score': 0.5356024384194026, 'support': 649624}}
[[ 69252  81694  35362]
 [ 27117 217232  31117]
 [ 30788  83999  73063]]
Evaluating performance on  val set...
795/795 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98497146
{'0': {'precision': 0.5063021809015009, 'recall': 0.3778456652686446, 'f1-score': 0.4327422957559944, 'support': 57939}, '1': {'precision': 0.5633166091773806, 'recall': 0.7516387726638772, 'f1-score': 0.6439923522734062, 'support': 86040}, '2': {'precision': 0.5013769856132543, 'recall': 0.3827729466973912, 'f1-score': 0.4341199137750138, 'support': 59453}, 'accuracy': 0.5373785835070195, 'macro avg': {'precision': 0.5236652585640452, 'recall': 0.5040857948766377, 'f1-score': 0.5036181872681381, 'support': 203432}, 'weighted avg': {'precision': 0.528976606623042, 'recall': 0.5373785835070195, 'f1-score': 0.5224914914913894, 'support': 203432}}
[[21892 24194 11853]
 [10590 64671 10779]
 [10757 25939 22757]]
training model: results/ATVI/W0/deepOF_L2/h50
Epoch 1/50
2538/2538 - 77s - loss: 3.0801 - accuracy50: 0.4640 - val_loss: 3.3273 - val_accuracy50: 0.4260 - 77s/epoch - 30ms/step
Epoch 2/50
2538/2538 - 75s - loss: 2.9469 - accuracy50: 0.5028 - val_loss: 3.2067 - val_accuracy50: 0.4540 - 75s/epoch - 30ms/step
Epoch 3/50
2538/2538 - 75s - loss: 2.9132 - accuracy50: 0.5103 - val_loss: 3.1813 - val_accuracy50: 0.4616 - 75s/epoch - 29ms/step
Epoch 4/50
2538/2538 - 74s - loss: 2.8983 - accuracy50: 0.5144 - val_loss: 3.1816 - val_accuracy50: 0.4647 - 74s/epoch - 29ms/step
Epoch 5/50
2538/2538 - 74s - loss: 2.8887 - accuracy50: 0.5165 - val_loss: 3.1788 - val_accuracy50: 0.4663 - 74s/epoch - 29ms/step
Epoch 6/50
2538/2538 - 74s - loss: 2.8814 - accuracy50: 0.5186 - val_loss: 3.1633 - val_accuracy50: 0.4694 - 74s/epoch - 29ms/step
Epoch 7/50
2538/2538 - 74s - loss: 2.8760 - accuracy50: 0.5198 - val_loss: 3.1770 - val_accuracy50: 0.4675 - 74s/epoch - 29ms/step
Epoch 8/50
2538/2538 - 73s - loss: 2.8719 - accuracy50: 0.5210 - val_loss: 3.1616 - val_accuracy50: 0.4698 - 73s/epoch - 29ms/step
Epoch 9/50
2538/2538 - 74s - loss: 2.8670 - accuracy50: 0.5226 - val_loss: 3.1667 - val_accuracy50: 0.4692 - 74s/epoch - 29ms/step
Epoch 10/50
2538/2538 - 73s - loss: 2.8638 - accuracy50: 0.5231 - val_loss: 3.1701 - val_accuracy50: 0.4712 - 73s/epoch - 29ms/step
Epoch 11/50
2538/2538 - 74s - loss: 2.8608 - accuracy50: 0.5239 - val_loss: 3.1557 - val_accuracy50: 0.4702 - 74s/epoch - 29ms/step
Epoch 12/50
2538/2538 - 74s - loss: 2.8566 - accuracy50: 0.5252 - val_loss: 3.1732 - val_accuracy50: 0.4719 - 74s/epoch - 29ms/step
Epoch 13/50
2538/2538 - 74s - loss: 2.8531 - accuracy50: 0.5266 - val_loss: 3.1508 - val_accuracy50: 0.4734 - 74s/epoch - 29ms/step
Epoch 14/50
2538/2538 - 73s - loss: 2.8498 - accuracy50: 0.5268 - val_loss: 3.1450 - val_accuracy50: 0.4748 - 73s/epoch - 29ms/step
Epoch 15/50
2538/2538 - 74s - loss: 2.8471 - accuracy50: 0.5276 - val_loss: 3.1660 - val_accuracy50: 0.4740 - 74s/epoch - 29ms/step
Epoch 16/50
2538/2538 - 73s - loss: 2.8440 - accuracy50: 0.5288 - val_loss: 3.1758 - val_accuracy50: 0.4724 - 73s/epoch - 29ms/step
Epoch 17/50
2538/2538 - 74s - loss: 2.8414 - accuracy50: 0.5291 - val_loss: 3.1594 - val_accuracy50: 0.4745 - 74s/epoch - 29ms/step
Epoch 18/50
2538/2538 - 74s - loss: 2.8381 - accuracy50: 0.5299 - val_loss: 3.1631 - val_accuracy50: 0.4746 - 74s/epoch - 29ms/step
Epoch 19/50
2538/2538 - 73s - loss: 2.8345 - accuracy50: 0.5305 - val_loss: 3.1710 - val_accuracy50: 0.4750 - 73s/epoch - 29ms/step
Epoch 20/50
2538/2538 - 74s - loss: 2.8318 - accuracy50: 0.5318 - val_loss: 3.1712 - val_accuracy50: 0.4729 - 74s/epoch - 29ms/step
Epoch 21/50
2538/2538 - 73s - loss: 2.8282 - accuracy50: 0.5326 - val_loss: 3.1806 - val_accuracy50: 0.4719 - 73s/epoch - 29ms/step
Epoch 22/50
2538/2538 - 73s - loss: 2.8252 - accuracy50: 0.5334 - val_loss: 3.1719 - val_accuracy50: 0.4738 - 73s/epoch - 29ms/step
Epoch 23/50
2538/2538 - 74s - loss: 2.8227 - accuracy50: 0.5338 - val_loss: 3.1750 - val_accuracy50: 0.4752 - 74s/epoch - 29ms/step
Epoch 24/50
2538/2538 - 74s - loss: 2.8191 - accuracy50: 0.5348 - val_loss: 3.1886 - val_accuracy50: 0.4737 - 74s/epoch - 29ms/step
testing model: results/ATVI/W0/deepOF_L2/h50
Evaluating performance on  test set...
11876/11876 - 175s - 175s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0348086
{'0': {'precision': 0.516968642684893, 'recall': 0.43991201676315705, 'f1-score': 0.4753376838821353, 'support': 1199774}, '1': {'precision': 0.34114207216403897, 'recall': 0.4448523792698259, 'f1-score': 0.38615504777257476, 'support': 608485}, '2': {'precision': 0.5028439916393499, 'recall': 0.5003324146944342, 'f1-score': 0.5015850591442105, 'support': 1231895}, 'accuracy': 0.4653836614855695, 'macro avg': {'precision': 0.4536515688294273, 'recall': 0.46169893690913905, 'f1-score': 0.45435926359964024, 'support': 3040154}, 'weighted avg': {'precision': 0.47605363714138066, 'recall': 0.4653836614855695, 'f1-score': 0.46812348158032696, 'support': 3040154}}
[[527795 264934 407045]
 [135459 270686 202340]
 [357688 257850 616357]]
Evaluating performance on  train set...
2538/2538 - 40s - 40s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0358773
{'0': {'precision': 0.5561536234832067, 'recall': 0.32676466802728593, 'f1-score': 0.4116606392620024, 'support': 217548}, '1': {'precision': 0.44811419718218937, 'recall': 0.7800345539589566, 'f1-score': 0.5692218594806245, 'support': 213579}, '2': {'precision': 0.5237457257693615, 'recall': 0.35962049822194353, 'f1-score': 0.42643627009367097, 'support': 218497}, 'accuracy': 0.486838540448013, 'macro avg': {'precision': 0.5093378488115858, 'recall': 0.4888065734027287, 'f1-score': 0.469106256278766, 'support': 649624}, 'weighted avg': {'precision': 0.5097329539009144, 'recall': 0.486838540448013, 'f1-score': 0.4684322469349027, 'support': 649624}}
[[ 71087 103243  43218]
 [ 18747 166599  28233]
 [ 37985 101936  78576]]
Evaluating performance on  val set...
795/795 - 12s - 12s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0503193
{'0': {'precision': 0.5213589981447124, 'recall': 0.33363509542607817, 'f1-score': 0.40688856310293026, 'support': 67382}, '1': {'precision': 0.44275420336269017, 'recall': 0.7547846172306215, 'f1-score': 0.5581181272216091, 'support': 66672}, '2': {'precision': 0.5100207918033138, 'recall': 0.3429617457983799, 'f1-score': 0.4101317751290604, 'support': 69378}, 'accuracy': 0.4748417161508514, 'macro avg': {'precision': 0.49137799777023883, 'recall': 0.4771271528183599, 'f1-score': 0.4583794884845333, 'support': 203432}, 'weighted avg': {'precision': 0.49173061638933213, 'recall': 0.4748417161508514, 'f1-score': 0.45755800086527554, 'support': 203432}}
[[22481 30991 13910]
 [ 7400 50323  8949]
 [13239 32345 23794]]
training model: results/ATVI/W0/deepOF_L2/h100
Epoch 1/50
2538/2538 - 76s - loss: 3.2266 - accuracy100: 0.4086 - val_loss: 3.2943 - val_accuracy100: 0.3715 - 76s/epoch - 30ms/step
Epoch 2/50
2538/2538 - 72s - loss: 3.1719 - accuracy100: 0.4348 - val_loss: 3.2811 - val_accuracy100: 0.3848 - 72s/epoch - 28ms/step
Epoch 3/50
2538/2538 - 72s - loss: 3.1518 - accuracy100: 0.4420 - val_loss: 3.2556 - val_accuracy100: 0.3996 - 72s/epoch - 29ms/step
Epoch 4/50
2538/2538 - 73s - loss: 3.1388 - accuracy100: 0.4462 - val_loss: 3.2436 - val_accuracy100: 0.4085 - 73s/epoch - 29ms/step
Epoch 5/50
2538/2538 - 72s - loss: 3.1324 - accuracy100: 0.4484 - val_loss: 3.2416 - val_accuracy100: 0.4113 - 72s/epoch - 29ms/step
Epoch 6/50
2538/2538 - 72s - loss: 3.1271 - accuracy100: 0.4501 - val_loss: 3.2487 - val_accuracy100: 0.4120 - 72s/epoch - 28ms/step
Epoch 7/50
2538/2538 - 72s - loss: 3.1230 - accuracy100: 0.4513 - val_loss: 3.2555 - val_accuracy100: 0.4113 - 72s/epoch - 28ms/step
Epoch 8/50
2538/2538 - 73s - loss: 3.1197 - accuracy100: 0.4528 - val_loss: 3.2592 - val_accuracy100: 0.4124 - 73s/epoch - 29ms/step
Epoch 9/50
2538/2538 - 73s - loss: 3.1165 - accuracy100: 0.4541 - val_loss: 3.2602 - val_accuracy100: 0.4118 - 73s/epoch - 29ms/step
Epoch 10/50
2538/2538 - 73s - loss: 3.1138 - accuracy100: 0.4553 - val_loss: 3.2634 - val_accuracy100: 0.4113 - 73s/epoch - 29ms/step
Epoch 11/50
2538/2538 - 74s - loss: 3.1115 - accuracy100: 0.4561 - val_loss: 3.2697 - val_accuracy100: 0.4119 - 74s/epoch - 29ms/step
Epoch 12/50
2538/2538 - 72s - loss: 3.1084 - accuracy100: 0.4575 - val_loss: 3.2743 - val_accuracy100: 0.4128 - 72s/epoch - 28ms/step
Epoch 13/50
2538/2538 - 72s - loss: 3.1062 - accuracy100: 0.4581 - val_loss: 3.2827 - val_accuracy100: 0.4113 - 72s/epoch - 29ms/step
Epoch 14/50
2538/2538 - 72s - loss: 3.1036 - accuracy100: 0.4591 - val_loss: 3.2827 - val_accuracy100: 0.4107 - 72s/epoch - 28ms/step
Epoch 15/50
2538/2538 - 73s - loss: 3.1013 - accuracy100: 0.4601 - val_loss: 3.2974 - val_accuracy100: 0.4099 - 73s/epoch - 29ms/step
testing model: results/ATVI/W0/deepOF_L2/h100
Evaluating performance on  test set...
11876/11876 - 176s - 176s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0833825
{'0': {'precision': 0.48392524679944465, 'recall': 0.2606889967654271, 'f1-score': 0.33884387301978397, 'support': 1160586}, '1': {'precision': 0.2852140685286924, 'recall': 0.33086967020836205, 'f1-score': 0.3063501886491127, 'support': 695712}, '2': {'precision': 0.43489407116984435, 'recall': 0.5906579854306605, 'f1-score': 0.5009470836700423, 'support': 1183856}, 'accuracy': 0.4052413134334642, 'macro avg': {'precision': 0.40134446216599384, 'recall': 0.39407221746814985, 'f1-score': 0.382047048446313, 'support': 3040154}, 'weighted avg': {'precision': 0.4193589114383881, 'recall': 0.4052413134334642, 'f1-score': 0.3945320428975874, 'support': 3040154}}
[[302552 290951 567083]
 [123987 230190 341535]
 [198665 285937 699254]]
Evaluating performance on  train set...
2538/2538 - 40s - 40s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0886242
{'0': {'precision': 0.4914689355506518, 'recall': 0.19426210344579525, 'f1-score': 0.27845841523539455, 'support': 222416}, '1': {'precision': 0.38034512629142925, 'recall': 0.7173953666658681, 'f1-score': 0.49712629366589306, 'support': 208705}, '2': {'precision': 0.4326448764407314, 'recall': 0.3327597332759733, 'f1-score': 0.376184809602649, 'support': 218503}, 'accuracy': 0.4089134637882837, 'macro avg': {'precision': 0.4348196460942708, 'recall': 0.41480573446254554, 'f1-score': 0.3839231728346455, 'support': 649624}, 'weighted avg': {'precision': 0.4359824880069327, 'recall': 0.4089134637882837, 'f1-score': 0.3815805134279881, 'support': 649624}}
[[ 43207 123304  55905]
 [ 19538 149724  39443]
 [ 25169 120625  72709]]
Evaluating performance on  val set...
795/795 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0838797
{'0': {'precision': 0.4801510989010989, 'recall': 0.2035107126222636, 'f1-score': 0.2858603205757278, 'support': 68704}, '1': {'precision': 0.38543023284750855, 'recall': 0.7113397326964589, 'f1-score': 0.4999623392693818, 'support': 65319}, '2': {'precision': 0.43341827718978443, 'recall': 0.33570574421184574, 'f1-score': 0.3783551189413007, 'support': 69409}, 'accuracy': 0.41167073026859097, 'macro avg': {'precision': 0.43299986964613063, 'recall': 0.416852063176856, 'f1-score': 0.3880592595954701, 'support': 203432}, 'weighted avg': {'precision': 0.43379285304049153, 'recall': 0.41167073026859097, 'f1-score': 0.38616362201702925, 'support': 203432}}
[[13982 36670 18052]
 [ 6447 46464 12408]
 [ 8691 37417 23301]]
training model: results/ATVI/W0/deepOF_L2/h200
Epoch 1/50
2538/2538 - 77s - loss: 3.2741 - accuracy200: 0.3794 - val_loss: 3.2864 - val_accuracy200: 0.3559 - 77s/epoch - 30ms/step
Epoch 2/50
2538/2538 - 74s - loss: 3.2442 - accuracy200: 0.3954 - val_loss: 3.2914 - val_accuracy200: 0.3574 - 74s/epoch - 29ms/step
Epoch 3/50
2538/2538 - 74s - loss: 3.2328 - accuracy200: 0.4013 - val_loss: 3.2933 - val_accuracy200: 0.3586 - 74s/epoch - 29ms/step
Epoch 4/50
2538/2538 - 74s - loss: 3.2260 - accuracy200: 0.4048 - val_loss: 3.2968 - val_accuracy200: 0.3616 - 74s/epoch - 29ms/step
Epoch 5/50
2538/2538 - 75s - loss: 3.2206 - accuracy200: 0.4077 - val_loss: 3.3057 - val_accuracy200: 0.3620 - 75s/epoch - 30ms/step
Epoch 6/50
2538/2538 - 75s - loss: 3.2156 - accuracy200: 0.4102 - val_loss: 3.3128 - val_accuracy200: 0.3608 - 75s/epoch - 30ms/step
Epoch 7/50
2538/2538 - 75s - loss: 3.2119 - accuracy200: 0.4116 - val_loss: 3.3159 - val_accuracy200: 0.3629 - 75s/epoch - 30ms/step
Epoch 8/50
2538/2538 - 73s - loss: 3.2103 - accuracy200: 0.4130 - val_loss: 3.3223 - val_accuracy200: 0.3648 - 73s/epoch - 29ms/step
Epoch 9/50
2538/2538 - 75s - loss: 3.2090 - accuracy200: 0.4132 - val_loss: 3.3188 - val_accuracy200: 0.3659 - 75s/epoch - 30ms/step
Epoch 10/50
2538/2538 - 73s - loss: 3.2043 - accuracy200: 0.4158 - val_loss: 3.3268 - val_accuracy200: 0.3691 - 73s/epoch - 29ms/step
Epoch 11/50
2538/2538 - 74s - loss: 3.2023 - accuracy200: 0.4171 - val_loss: 3.3322 - val_accuracy200: 0.3677 - 74s/epoch - 29ms/step
testing model: results/ATVI/W0/deepOF_L2/h200
Evaluating performance on  test set...
11876/11876 - 178s - 178s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.116567
{'0': {'precision': 0.448563484708063, 'recall': 0.06307346159369798, 'f1-score': 0.11059581185281563, 'support': 1128018}, '1': {'precision': 0.2472889557634761, 'recall': 0.784091351230239, 'f1-score': 0.3759954114967997, 'support': 745343}, '2': {'precision': 0.4206099431735955, 'recall': 0.18681891303770248, 'f1-score': 0.25872294868127604, 'support': 1166793}, 'accuracy': 0.287335444191314, 'macro avg': {'precision': 0.37215412788171154, 'recall': 0.34466124195387976, 'f1-score': 0.24843805734363045, 'support': 3040154}, 'weighted avg': {'precision': 0.3884893707602922, 'recall': 0.287335444191314, 'f1-score': 0.2325131358301325, 'support': 3040154}}
[[ 71148 877679 179191]
 [ 39851 584417 121075]
 [ 47614 901200 217979]]
Evaluating performance on  train set...
2538/2538 - 40s - 40s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0965916
{'0': {'precision': 0.4050654142905065, 'recall': 0.0781719644492125, 'f1-score': 0.13105260709800454, 'support': 216254}, '1': {'precision': 0.34474585451772577, 'recall': 0.8132745488076196, 'f1-score': 0.4842281335995252, 'support': 220693}, '2': {'precision': 0.37872867079976624, 'recall': 0.1553952707627059, 'f1-score': 0.22037074081482966, 'support': 212677}, 'accuracy': 0.35318584288757804, 'macro avg': {'precision': 0.3761799798693328, 'recall': 0.34894726133984605, 'f1-score': 0.2785504938374532, 'support': 649624}, 'weighted avg': {'precision': 0.3759511509623129, 'recall': 0.35318584288757804, 'f1-score': 0.28027627986054615, 'support': 649624}}
[[ 16905 172655  26694]
 [ 13689 179484  27520]
 [ 11140 168488  33049]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0940913
{'0': {'precision': 0.3972690877895339, 'recall': 0.08364189168849152, 'f1-score': 0.13818914281451272, 'support': 66438}, '1': {'precision': 0.348375033498185, 'recall': 0.8198927813772147, 'f1-score': 0.48898064560251675, 'support': 69764}, '2': {'precision': 0.38957079505859993, 'recall': 0.14634835638851704, 'f1-score': 0.2127673377592284, 'support': 67230}, 'accuracy': 0.3568514294702898, 'macro avg': {'precision': 0.3784049721154396, 'recall': 0.3499610098180744, 'f1-score': 0.2799790420587526, 'support': 203432}, 'weighted avg': {'precision': 0.377957470030861, 'recall': 0.3568514294702898, 'f1-score': 0.2831344338534621, 'support': 203432}}
[[ 5557 53352  7529]
 [ 4677 57199  7888]
 [ 3754 53637  9839]]
training model: results/ATVI/W0/deepOF_L2/h300
Epoch 1/50
2538/2538 - 78s - loss: 3.2866 - accuracy300: 0.3705 - val_loss: 3.3007 - val_accuracy300: 0.3326 - 78s/epoch - 31ms/step
Epoch 2/50
2538/2538 - 73s - loss: 3.2649 - accuracy300: 0.3827 - val_loss: 3.3007 - val_accuracy300: 0.3346 - 73s/epoch - 29ms/step
Epoch 3/50
2538/2538 - 75s - loss: 3.2574 - accuracy300: 0.3873 - val_loss: 3.3004 - val_accuracy300: 0.3365 - 75s/epoch - 30ms/step
Epoch 4/50
2538/2538 - 74s - loss: 3.2527 - accuracy300: 0.3905 - val_loss: 3.3045 - val_accuracy300: 0.3379 - 74s/epoch - 29ms/step
Epoch 5/50
2538/2538 - 73s - loss: 3.2495 - accuracy300: 0.3918 - val_loss: 3.3055 - val_accuracy300: 0.3422 - 73s/epoch - 29ms/step
Epoch 6/50
2538/2538 - 75s - loss: 3.2460 - accuracy300: 0.3943 - val_loss: 3.3079 - val_accuracy300: 0.3429 - 75s/epoch - 29ms/step
Epoch 7/50
2538/2538 - 75s - loss: 3.2432 - accuracy300: 0.3961 - val_loss: 3.3144 - val_accuracy300: 0.3429 - 75s/epoch - 30ms/step
Epoch 8/50
2538/2538 - 74s - loss: 3.2406 - accuracy300: 0.3981 - val_loss: 3.3196 - val_accuracy300: 0.3438 - 74s/epoch - 29ms/step
Epoch 9/50
2538/2538 - 75s - loss: 3.2379 - accuracy300: 0.4005 - val_loss: 3.3264 - val_accuracy300: 0.3452 - 75s/epoch - 30ms/step
Epoch 10/50
2538/2538 - 74s - loss: 3.2362 - accuracy300: 0.4019 - val_loss: 3.3316 - val_accuracy300: 0.3482 - 74s/epoch - 29ms/step
Epoch 11/50
2538/2538 - 74s - loss: 3.2355 - accuracy300: 0.4022 - val_loss: 3.3355 - val_accuracy300: 0.3476 - 74s/epoch - 29ms/step
Epoch 12/50
2538/2538 - 75s - loss: 3.2352 - accuracy300: 0.4026 - val_loss: 3.3428 - val_accuracy300: 0.3457 - 75s/epoch - 30ms/step
Epoch 13/50
2538/2538 - 74s - loss: 3.2305 - accuracy300: 0.4055 - val_loss: 3.3523 - val_accuracy300: 0.3466 - 74s/epoch - 29ms/step
testing model: results/ATVI/W0/deepOF_L2/h300
Evaluating performance on  test set...
11876/11876 - 186s - 186s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1218259
{'0': {'precision': 0.4264792899408284, 'recall': 0.010245557548635747, 'f1-score': 0.02001039388305233, 'support': 1125561}, '1': {'precision': 0.24963245095705647, 'recall': 0.8159054273330913, 'f1-score': 0.3822979468381933, 'support': 749392}, '2': {'precision': 0.4164879625244554, 'recall': 0.20151716313322765, 'f1-score': 0.27161416371020636, 'support': 1165201}, 'accuracy': 0.28214787803512587, 'macro avg': {'precision': 0.3641999011407801, 'recall': 0.34255604933831824, 'f1-score': 0.224640834810484, 'support': 3040154}, 'weighted avg': {'precision': 0.37905751095969387, 'recall': 0.28214787803512587, 'f1-score': 0.20574583955143907, 'support': 3040154}}
[[ 11532 916281 197748]
 [  6734 611433 131225]
 [  8774 921619 234808]]
Evaluating performance on  train set...
2538/2538 - 42s - 42s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1059664
{'0': {'precision': 0.409739093693884, 'recall': 0.01748045334715306, 'f1-score': 0.033530418546755876, 'support': 221905}, '1': {'precision': 0.32620549537320453, 'recall': 0.8766672548056519, 'f1-score': 0.4754845033921057, 'support': 209701}, '2': {'precision': 0.3935397952788803, 'recall': 0.13825463952517683, 'f1-score': 0.2046230609958929, 'support': 218018}, 'accuracy': 0.33536168614460055, 'macro avg': {'precision': 0.37649479478198966, 'recall': 0.3441341158926606, 'f1-score': 0.23787932764491815, 'support': 649624}, 'weighted avg': {'precision': 0.37733755412132036, 'recall': 0.33536168614460055, 'f1-score': 0.2336146045799546, 'support': 649624}}
[[  3879 194614  23412]
 [  2825 183838  23038]
 [  2763 185113  30142]]
Evaluating performance on  val set...
795/795 - 15s - 15s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033443
{'0': {'precision': 0.4030736989172197, 'recall': 0.016849175062052853, 'f1-score': 0.03234622230319678, 'support': 68490}, '1': {'precision': 0.32679716427345795, 'recall': 0.8827798615558199, 'f1-score': 0.47700964762681564, 'support': 65586}, '2': {'precision': 0.3978462458869279, 'recall': 0.13423496164715382, 'f1-score': 0.20073956682514527, 'support': 69356}, 'accuracy': 0.33604349364898345, 'macro avg': {'precision': 0.3759057030258685, 'recall': 0.3446213327550089, 'f1-score': 0.2366984789183859, 'support': 203432}, 'weighted avg': {'precision': 0.3767001292058927, 'recall': 0.33604349364898345, 'f1-score': 0.23311495198161084, 'support': 203432}}
[[ 1154 60039  7297]
 [  894 57898  6794]
 [  815 59231  9310]]
training model: results/ATVI/W0/deepOF_L2/h500
Epoch 1/50
2538/2538 - 77s - loss: 3.2630 - accuracy500: 0.3930 - val_loss: 3.2920 - val_accuracy500: 0.3575 - 77s/epoch - 30ms/step
Epoch 2/50
2538/2538 - 75s - loss: 3.2437 - accuracy500: 0.3973 - val_loss: 3.2866 - val_accuracy500: 0.3635 - 75s/epoch - 29ms/step
Epoch 3/50
2538/2538 - 76s - loss: 3.2337 - accuracy500: 0.4026 - val_loss: 3.2863 - val_accuracy500: 0.3632 - 76s/epoch - 30ms/step
Epoch 4/50
2538/2538 - 74s - loss: 3.2289 - accuracy500: 0.4049 - val_loss: 3.2902 - val_accuracy500: 0.3605 - 74s/epoch - 29ms/step
Epoch 5/50
2538/2538 - 75s - loss: 3.2258 - accuracy500: 0.4068 - val_loss: 3.2928 - val_accuracy500: 0.3564 - 75s/epoch - 30ms/step
Epoch 6/50
2538/2538 - 74s - loss: 3.2235 - accuracy500: 0.4081 - val_loss: 3.2921 - val_accuracy500: 0.3626 - 74s/epoch - 29ms/step
Epoch 7/50
2538/2538 - 74s - loss: 3.2232 - accuracy500: 0.4084 - val_loss: 3.2920 - val_accuracy500: 0.3617 - 74s/epoch - 29ms/step
Epoch 8/50
2538/2538 - 75s - loss: 3.2218 - accuracy500: 0.4088 - val_loss: 3.2944 - val_accuracy500: 0.3628 - 75s/epoch - 29ms/step
Epoch 9/50
2538/2538 - 74s - loss: 3.2202 - accuracy500: 0.4099 - val_loss: 3.2950 - val_accuracy500: 0.3634 - 74s/epoch - 29ms/step
Epoch 10/50
2538/2538 - 75s - loss: 3.2193 - accuracy500: 0.4104 - val_loss: 3.2935 - val_accuracy500: 0.3622 - 75s/epoch - 29ms/step
Epoch 11/50
2538/2538 - 74s - loss: 3.2182 - accuracy500: 0.4110 - val_loss: 3.2946 - val_accuracy500: 0.3614 - 74s/epoch - 29ms/step
Epoch 12/50
2538/2538 - 76s - loss: 3.2174 - accuracy500: 0.4113 - val_loss: 3.2995 - val_accuracy500: 0.3573 - 76s/epoch - 30ms/step
Epoch 13/50
2538/2538 - 73s - loss: 3.2165 - accuracy500: 0.4115 - val_loss: 3.3018 - val_accuracy500: 0.3557 - 73s/epoch - 29ms/step
testing model: results/ATVI/W0/deepOF_L2/h500
Evaluating performance on  test set...
11876/11876 - 186s - 186s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0992094
{'0': {'precision': 0.4252831409149451, 'recall': 0.2479061722784027, 'f1-score': 0.3132263496538299, 'support': 1188135}, '1': {'precision': 0.21100437618951134, 'recall': 0.19619692636677488, 'f1-score': 0.20333142255898576, 'support': 621024}, '2': {'precision': 0.4221265979821741, 'recall': 0.6070016531342531, 'f1-score': 0.4979584274926877, 'support': 1230995}, 'accuracy': 0.3827454135547081, 'macro avg': {'precision': 0.3528047050288768, 'recall': 0.3503682505931436, 'f1-score': 0.3381720665685011, 'support': 3040154}, 'weighted avg': {'precision': 0.3802334677232666, 'recall': 0.3827454135547081, 'f1-score': 0.3655779334732997, 'support': 3040154}}
[[294546 224432 669157]
 [145431 121843 353750]
 [252611 231168 747216]]
Evaluating performance on  train set...
2538/2538 - 39s - 39s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0968989
{'0': {'precision': 0.36843280939279194, 'recall': 0.3102260268002551, 'f1-score': 0.33683329680620033, 'support': 217983}, '1': {'precision': 0.3371946213729653, 'recall': 0.27406848375800136, 'f1-score': 0.3023719829818344, 'support': 217307}, '2': {'precision': 0.35398370725572975, 'recall': 0.4780482797876212, 'f1-score': 0.4067663382216329, 'support': 214334}, 'accuracy': 0.3535014100464269, 'macro avg': {'precision': 0.353203712673829, 'recall': 0.3541142634486259, 'f1-score': 0.34865720600322253, 'support': 649624}, 'weighted avg': {'precision': 0.3532159904614262, 'recall': 0.3535014100464269, 'f1-score': 0.34837896595559115, 'support': 649624}}
[[ 67624  58408  91951]
 [ 62709  59557  95041]
 [ 53212  58660 102462]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0953817
{'0': {'precision': 0.37738935055923606, 'recall': 0.33270704069445656, 'f1-score': 0.3536423943585655, 'support': 68658}, '1': {'precision': 0.33408093239020836, 'recall': 0.26667074700859933, 'f1-score': 0.29659380025697535, 'support': 65354}, '2': {'precision': 0.3689053958737436, 'recall': 0.4821809276865457, 'f1-score': 0.41800494517845105, 'support': 69420}, 'accuracy': 0.3624995084352511, 'macro avg': {'precision': 0.36012522627439597, 'recall': 0.3605195717965339, 'f1-score': 0.3560803799313306, 'support': 203432}, 'weighted avg': {'precision': 0.3605811075331364, 'recall': 0.3624995084352511, 'f1-score': 0.35727847156864617, 'support': 203432}}
[[22843 17156 28659]
 [19322 17428 28604]
 [18364 17583 33473]]
training model: results/ATVI/W0/deepOF_L2/h1000
Epoch 1/50
2538/2538 - 79s - loss: 3.2779 - accuracy1000: 0.3876 - val_loss: 3.4099 - val_accuracy1000: 0.3425 - 79s/epoch - 31ms/step
Epoch 2/50
2538/2538 - 74s - loss: 3.2488 - accuracy1000: 0.3947 - val_loss: 3.4250 - val_accuracy1000: 0.3444 - 74s/epoch - 29ms/step
Epoch 3/50
2538/2538 - 76s - loss: 3.2396 - accuracy1000: 0.3966 - val_loss: 3.4302 - val_accuracy1000: 0.3431 - 76s/epoch - 30ms/step
Epoch 4/50
2538/2538 - 74s - loss: 3.2358 - accuracy1000: 0.3981 - val_loss: 3.4280 - val_accuracy1000: 0.3418 - 74s/epoch - 29ms/step
Epoch 5/50
2538/2538 - 75s - loss: 3.2335 - accuracy1000: 0.3992 - val_loss: 3.4270 - val_accuracy1000: 0.3405 - 75s/epoch - 30ms/step
Epoch 6/50
2538/2538 - 74s - loss: 3.2312 - accuracy1000: 0.4004 - val_loss: 3.4282 - val_accuracy1000: 0.3405 - 74s/epoch - 29ms/step
Epoch 7/50
2538/2538 - 74s - loss: 3.2300 - accuracy1000: 0.4001 - val_loss: 3.4302 - val_accuracy1000: 0.3392 - 74s/epoch - 29ms/step
Epoch 8/50
2538/2538 - 74s - loss: 3.2287 - accuracy1000: 0.4014 - val_loss: 3.4331 - val_accuracy1000: 0.3387 - 74s/epoch - 29ms/step
Epoch 9/50
2538/2538 - 75s - loss: 3.2273 - accuracy1000: 0.4024 - val_loss: 3.4385 - val_accuracy1000: 0.3379 - 75s/epoch - 30ms/step
Epoch 10/50
2538/2538 - 75s - loss: 3.2261 - accuracy1000: 0.4033 - val_loss: 3.4390 - val_accuracy1000: 0.3379 - 75s/epoch - 29ms/step
Epoch 11/50
2538/2538 - 73s - loss: 3.2253 - accuracy1000: 0.4038 - val_loss: 3.4374 - val_accuracy1000: 0.3383 - 73s/epoch - 29ms/step
testing model: results/ATVI/W0/deepOF_L2/h1000
Evaluating performance on  test set...
11876/11876 - 190s - 190s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1757236
{'0': {'precision': 0.39675967287471653, 'recall': 0.0201939027408197, 'f1-score': 0.03843174259236608, 'support': 1143563}, '1': {'precision': 0.23931462731426822, 'recall': 0.8868765376873182, 'f1-score': 0.37692096099885514, 'support': 715360}, '2': {'precision': 0.403377496252599, 'recall': 0.11299737307944001, 'f1-score': 0.1765407270685597, 'support': 1181231}, 'accuracy': 0.26018583269137024, 'macro avg': {'precision': 0.34648393214719464, 'recall': 0.3400226045025259, 'f1-score': 0.19729781021992698, 'support': 3040154}, 'weighted avg': {'precision': 0.36228355434070714, 'recall': 0.26018583269137024, 'f1-score': 0.171740864801657, 'support': 3040154}}
[[  23093  991285  129185]
 [  12689  634436   68235]
 [  22422 1025333  133476]]
Evaluating performance on  train set...
2538/2538 - 42s - 42s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1252695
{'0': {'precision': 0.3808063863018453, 'recall': 0.03038807926843342, 'f1-score': 0.05628468095657453, 'support': 216631}, '1': {'precision': 0.3517500807177646, 'recall': 0.9214070918431274, 'f1-score': 0.5091359117552152, 'support': 223468}, '2': {'precision': 0.35846605910910484, 'recall': 0.08034840711132323, 'f1-score': 0.13127268615808085, 'support': 209525}, 'accuracy': 0.3530088174082238, 'macro avg': {'precision': 0.36367417537623825, 'recall': 0.344047859407628, 'f1-score': 0.23223109295662356, 'support': 649624}, 'weighted avg': {'precision': 0.3636056493350425, 'recall': 0.3530088174082238, 'f1-score': 0.23624973864218382, 'support': 649624}}
[[  6583 192815  17233]
 [  4667 205905  12896]
 [  6037 186653  16835]]
Evaluating performance on  val set...
795/795 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1313229
{'0': {'precision': 0.3616460571660247, 'recall': 0.026465701400427248, 'f1-score': 0.04932196126677818, 'support': 67408}, '1': {'precision': 0.339654702902892, 'recall': 0.9206785065769078, 'f1-score': 0.4962382682108798, 'support': 67737}, '2': {'precision': 0.37275841225065487, 'recall': 0.08127462035233646, 'f1-score': 0.13345195729537365, 'support': 68287}, 'accuracy': 0.34261079869440403, 'macro avg': {'precision': 0.3580197241065239, 'recall': 0.34280627610989045, 'f1-score': 0.22633739559101054, 'support': 203432}, 'weighted avg': {'precision': 0.35805370703400186, 'recall': 0.34261079869440403, 'f1-score': 0.22637254781303107, 'support': 203432}}
[[ 1784 60232  5392]
 [ 1426 62364  3947]
 [ 1723 61014  5550]]
training model: results/ATVI/W0/deepVOL_L2/h10
Epoch 1/50
2538/2538 - 92s - loss: 2.9298 - accuracy10: 0.4900 - val_loss: 2.9596 - val_accuracy10: 0.5712 - 92s/epoch - 36ms/step
Epoch 2/50
2538/2538 - 93s - loss: 2.7698 - accuracy10: 0.5487 - val_loss: 2.8912 - val_accuracy10: 0.5433 - 93s/epoch - 37ms/step
Epoch 3/50
2538/2538 - 92s - loss: 2.7101 - accuracy10: 0.5688 - val_loss: 2.8573 - val_accuracy10: 0.5822 - 92s/epoch - 36ms/step
Epoch 4/50
2538/2538 - 92s - loss: 2.6783 - accuracy10: 0.5770 - val_loss: 2.8364 - val_accuracy10: 0.5832 - 92s/epoch - 36ms/step
Epoch 5/50
2538/2538 - 93s - loss: 2.6577 - accuracy10: 0.5819 - val_loss: 2.8389 - val_accuracy10: 0.5887 - 93s/epoch - 37ms/step
Epoch 6/50
2538/2538 - 93s - loss: 2.6403 - accuracy10: 0.5853 - val_loss: 2.8132 - val_accuracy10: 0.5741 - 93s/epoch - 37ms/step
Epoch 7/50
2538/2538 - 92s - loss: 2.6274 - accuracy10: 0.5886 - val_loss: 2.8086 - val_accuracy10: 0.5736 - 92s/epoch - 36ms/step
Epoch 8/50
2538/2538 - 94s - loss: 2.6173 - accuracy10: 0.5905 - val_loss: 2.8018 - val_accuracy10: 0.5793 - 94s/epoch - 37ms/step
Epoch 9/50
2538/2538 - 91s - loss: 2.6078 - accuracy10: 0.5926 - val_loss: 2.8047 - val_accuracy10: 0.5784 - 91s/epoch - 36ms/step
Epoch 10/50
2538/2538 - 93s - loss: 2.5985 - accuracy10: 0.5939 - val_loss: 2.8064 - val_accuracy10: 0.5806 - 93s/epoch - 37ms/step
Epoch 11/50
2538/2538 - 93s - loss: 2.5935 - accuracy10: 0.5957 - val_loss: 2.7977 - val_accuracy10: 0.5778 - 93s/epoch - 36ms/step
Epoch 12/50
2538/2538 - 91s - loss: 2.5864 - accuracy10: 0.5967 - val_loss: 2.7980 - val_accuracy10: 0.5729 - 91s/epoch - 36ms/step
Epoch 13/50
2538/2538 - 98s - loss: 2.5804 - accuracy10: 0.5973 - val_loss: 2.7962 - val_accuracy10: 0.5788 - 98s/epoch - 38ms/step
Epoch 14/50
2538/2538 - 93s - loss: 2.5748 - accuracy10: 0.5982 - val_loss: 2.7996 - val_accuracy10: 0.5789 - 93s/epoch - 37ms/step
Epoch 15/50
2538/2538 - 92s - loss: 2.5692 - accuracy10: 0.5989 - val_loss: 2.7941 - val_accuracy10: 0.5806 - 92s/epoch - 36ms/step
Epoch 16/50
2538/2538 - 92s - loss: 2.5645 - accuracy10: 0.5994 - val_loss: 2.7923 - val_accuracy10: 0.5810 - 92s/epoch - 36ms/step
Epoch 17/50
2538/2538 - 94s - loss: 2.5603 - accuracy10: 0.6002 - val_loss: 2.7849 - val_accuracy10: 0.5788 - 94s/epoch - 37ms/step
Epoch 18/50
2538/2538 - 92s - loss: 2.5548 - accuracy10: 0.6008 - val_loss: 2.7949 - val_accuracy10: 0.5780 - 92s/epoch - 36ms/step
Epoch 19/50
2538/2538 - 92s - loss: 2.5513 - accuracy10: 0.6016 - val_loss: 2.7992 - val_accuracy10: 0.5812 - 92s/epoch - 36ms/step
Epoch 20/50
2538/2538 - 90s - loss: 2.5466 - accuracy10: 0.6016 - val_loss: 2.7888 - val_accuracy10: 0.5834 - 90s/epoch - 35ms/step
Epoch 21/50
2538/2538 - 93s - loss: 2.5435 - accuracy10: 0.6027 - val_loss: 2.8007 - val_accuracy10: 0.5812 - 93s/epoch - 37ms/step
Epoch 22/50
2538/2538 - 90s - loss: 2.5401 - accuracy10: 0.6034 - val_loss: 2.7966 - val_accuracy10: 0.5835 - 90s/epoch - 35ms/step
Epoch 23/50
2538/2538 - 91s - loss: 2.5375 - accuracy10: 0.6031 - val_loss: 2.7970 - val_accuracy10: 0.5805 - 91s/epoch - 36ms/step
Epoch 24/50
2538/2538 - 91s - loss: 2.5335 - accuracy10: 0.6038 - val_loss: 2.7937 - val_accuracy10: 0.5822 - 91s/epoch - 36ms/step
Epoch 25/50
2538/2538 - 90s - loss: 2.5314 - accuracy10: 0.6037 - val_loss: 2.7970 - val_accuracy10: 0.5867 - 90s/epoch - 35ms/step
Epoch 26/50
2538/2538 - 90s - loss: 2.5264 - accuracy10: 0.6045 - val_loss: 2.7854 - val_accuracy10: 0.5779 - 90s/epoch - 35ms/step
Epoch 27/50
2538/2538 - 94s - loss: 2.5237 - accuracy10: 0.6049 - val_loss: 2.7862 - val_accuracy10: 0.5772 - 94s/epoch - 37ms/step
testing model: results/ATVI/W0/deepVOL_L2/h10
Evaluating performance on  test set...
11876/11876 - 202s - 202s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0236382
{'0': {'precision': 0.46289696481022863, 'recall': 0.5117330956322425, 'f1-score': 0.4860915056397229, 'support': 785300}, '1': {'precision': 0.7133551297849505, 'recall': 0.4918507362669815, 'f1-score': 0.5822478228618867, 'support': 1459457}, '2': {'precision': 0.4285327035700407, 'recall': 0.6280509729671285, 'f1-score': 0.5094539834411878, 'support': 795402}, 'accuracy': 0.532620826739654, 'macro avg': {'precision': 0.5349282660550733, 'recall': 0.5438782682887843, 'f1-score': 0.5259311039809325, 'support': 3040159}, 'weighted avg': {'precision': 0.5741409885473242, 'recall': 0.532620826739654, 'f1-score': 0.5383646176158887, 'support': 3040159}}
[[401864 153060 230376]
 [305822 717835 435800]
 [160464 135385 499553]]
Evaluating performance on  train set...
2538/2538 - 46s - 46s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9336854
{'0': {'precision': 0.42789469440412836, 'recall': 0.5187946035780624, 'f1-score': 0.4689806018293491, 'support': 122748}, '1': {'precision': 0.816893155829882, 'recall': 0.5578569600087483, 'f1-score': 0.6629707134597577, 'support': 402363}, '2': {'precision': 0.36760652488419526, 'recall': 0.6673064876238817, 'f1-score': 0.4740615220473497, 'support': 124514}, 'accuracy': 0.5714543005580143, 'macro avg': {'precision': 0.5374647917060685, 'recall': 0.5813193504035641, 'f1-score': 0.5353376124454855, 'support': 649625}, 'weighted avg': {'precision': 0.657276055643375, 'recall': 0.5714543005580143, 'f1-score': 0.5901075427352104, 'support': 649625}}
[[ 63681  28220  30847]
 [ 65811 224461 112091]
 [ 19332  22093  83089]]
Evaluating performance on  val set...
795/795 - 15s - 15s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93100536
{'0': {'precision': 0.4110291624279417, 'recall': 0.5048680168688499, 'f1-score': 0.4531414285380499, 'support': 38414}, '1': {'precision': 0.8017069361905175, 'recall': 0.5866523826528588, 'f1-score': 0.677523862766752, 'support': 126015}, '2': {'precision': 0.3790367918046099, 'recall': 0.6223111042740302, 'f1-score': 0.4711225846524132, 'support': 39003}, 'accuracy': 0.5780457351842385, 'macro avg': {'precision': 0.5305909634743564, 'recall': 0.571277167931913, 'f1-score': 0.5339292919857384, 'support': 203432}, 'weighted avg': {'precision': 0.6468989431373147, 'recall': 0.5780457351842385, 'f1-score': 0.5955815140765021, 'support': 203432}}
[[19394  9879  9141]
 [21465 73927 30623]
 [ 6325  8406 24272]]
training model: results/ATVI/W0/deepVOL_L2/h20
Epoch 1/50
2538/2538 - 91s - loss: 2.9776 - accuracy20: 0.5033 - val_loss: 3.0205 - val_accuracy20: 0.5347 - 91s/epoch - 36ms/step
Epoch 2/50
2538/2538 - 93s - loss: 2.8663 - accuracy20: 0.5404 - val_loss: 2.9903 - val_accuracy20: 0.5222 - 93s/epoch - 37ms/step
Epoch 3/50
2538/2538 - 93s - loss: 2.8094 - accuracy20: 0.5551 - val_loss: 2.9754 - val_accuracy20: 0.5566 - 93s/epoch - 37ms/step
Epoch 4/50
2538/2538 - 91s - loss: 2.7719 - accuracy20: 0.5644 - val_loss: 2.9899 - val_accuracy20: 0.5469 - 91s/epoch - 36ms/step
Epoch 5/50
2538/2538 - 93s - loss: 2.7538 - accuracy20: 0.5692 - val_loss: 2.9732 - val_accuracy20: 0.5632 - 93s/epoch - 36ms/step
Epoch 6/50
2538/2538 - 92s - loss: 2.7417 - accuracy20: 0.5721 - val_loss: 2.9721 - val_accuracy20: 0.5538 - 92s/epoch - 36ms/step
Epoch 7/50
2538/2538 - 91s - loss: 2.7311 - accuracy20: 0.5744 - val_loss: 2.9484 - val_accuracy20: 0.5571 - 91s/epoch - 36ms/step
Epoch 8/50
2538/2538 - 94s - loss: 2.7205 - accuracy20: 0.5767 - val_loss: 2.9386 - val_accuracy20: 0.5600 - 94s/epoch - 37ms/step
Epoch 9/50
2538/2538 - 92s - loss: 2.7121 - accuracy20: 0.5774 - val_loss: 2.9380 - val_accuracy20: 0.5528 - 92s/epoch - 36ms/step
Epoch 10/50
2538/2538 - 94s - loss: 2.7039 - accuracy20: 0.5793 - val_loss: 2.9263 - val_accuracy20: 0.5603 - 94s/epoch - 37ms/step
Epoch 11/50
2538/2538 - 92s - loss: 2.6961 - accuracy20: 0.5809 - val_loss: 2.9085 - val_accuracy20: 0.5595 - 92s/epoch - 36ms/step
Epoch 12/50
2538/2538 - 94s - loss: 2.6883 - accuracy20: 0.5821 - val_loss: 2.9020 - val_accuracy20: 0.5616 - 94s/epoch - 37ms/step
Epoch 13/50
2538/2538 - 93s - loss: 2.6827 - accuracy20: 0.5833 - val_loss: 2.8990 - val_accuracy20: 0.5631 - 93s/epoch - 37ms/step
Epoch 14/50
2538/2538 - 94s - loss: 2.6771 - accuracy20: 0.5843 - val_loss: 2.8950 - val_accuracy20: 0.5692 - 94s/epoch - 37ms/step
Epoch 15/50
2538/2538 - 92s - loss: 2.6716 - accuracy20: 0.5855 - val_loss: 2.9093 - val_accuracy20: 0.5677 - 92s/epoch - 36ms/step
Epoch 16/50
2538/2538 - 91s - loss: 2.6669 - accuracy20: 0.5864 - val_loss: 2.8928 - val_accuracy20: 0.5687 - 91s/epoch - 36ms/step
Epoch 17/50
2538/2538 - 92s - loss: 2.6622 - accuracy20: 0.5872 - val_loss: 2.8935 - val_accuracy20: 0.5687 - 92s/epoch - 36ms/step
Epoch 18/50
2538/2538 - 93s - loss: 2.6573 - accuracy20: 0.5878 - val_loss: 2.8989 - val_accuracy20: 0.5653 - 93s/epoch - 37ms/step
Epoch 19/50
2538/2538 - 91s - loss: 2.6540 - accuracy20: 0.5887 - val_loss: 2.9072 - val_accuracy20: 0.5701 - 91s/epoch - 36ms/step
Epoch 20/50
2538/2538 - 94s - loss: 2.6506 - accuracy20: 0.5895 - val_loss: 2.9010 - val_accuracy20: 0.5734 - 94s/epoch - 37ms/step
Epoch 21/50
2538/2538 - 92s - loss: 2.6471 - accuracy20: 0.5903 - val_loss: 2.8918 - val_accuracy20: 0.5693 - 92s/epoch - 36ms/step
Epoch 22/50
2538/2538 - 91s - loss: 2.6436 - accuracy20: 0.5906 - val_loss: 2.8982 - val_accuracy20: 0.5676 - 91s/epoch - 36ms/step
Epoch 23/50
2538/2538 - 93s - loss: 2.6410 - accuracy20: 0.5911 - val_loss: 2.8916 - val_accuracy20: 0.5679 - 93s/epoch - 37ms/step
Epoch 24/50
2538/2538 - 91s - loss: 2.6380 - accuracy20: 0.5911 - val_loss: 2.8910 - val_accuracy20: 0.5713 - 91s/epoch - 36ms/step
Epoch 25/50
2538/2538 - 90s - loss: 2.6348 - accuracy20: 0.5918 - val_loss: 2.9015 - val_accuracy20: 0.5660 - 90s/epoch - 36ms/step
Epoch 26/50
2538/2538 - 92s - loss: 2.6319 - accuracy20: 0.5924 - val_loss: 2.9068 - val_accuracy20: 0.5675 - 92s/epoch - 36ms/step
Epoch 27/50
2538/2538 - 92s - loss: 2.6292 - accuracy20: 0.5926 - val_loss: 2.9005 - val_accuracy20: 0.5648 - 92s/epoch - 36ms/step
Epoch 28/50
2538/2538 - 92s - loss: 2.6274 - accuracy20: 0.5928 - val_loss: 2.9056 - val_accuracy20: 0.5669 - 92s/epoch - 36ms/step
Epoch 29/50
2538/2538 - 94s - loss: 2.6253 - accuracy20: 0.5935 - val_loss: 2.9104 - val_accuracy20: 0.5666 - 94s/epoch - 37ms/step
Epoch 30/50
2538/2538 - 93s - loss: 2.6223 - accuracy20: 0.5936 - val_loss: 2.9002 - val_accuracy20: 0.5622 - 93s/epoch - 37ms/step
Epoch 31/50
2538/2538 - 92s - loss: 2.6196 - accuracy20: 0.5941 - val_loss: 2.9033 - val_accuracy20: 0.5638 - 92s/epoch - 36ms/step
Epoch 32/50
2538/2538 - 94s - loss: 2.6170 - accuracy20: 0.5947 - val_loss: 2.9137 - val_accuracy20: 0.5618 - 94s/epoch - 37ms/step
Epoch 33/50
2538/2538 - 93s - loss: 2.6154 - accuracy20: 0.5945 - val_loss: 2.9130 - val_accuracy20: 0.5636 - 93s/epoch - 37ms/step
Epoch 34/50
2538/2538 - 94s - loss: 2.6131 - accuracy20: 0.5953 - val_loss: 2.9159 - val_accuracy20: 0.5620 - 94s/epoch - 37ms/step
testing model: results/ATVI/W0/deepVOL_L2/h20
Evaluating performance on  test set...
11876/11876 - 211s - 211s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0125405
{'0': {'precision': 0.5475837852684414, 'recall': 0.4145724391710753, 'f1-score': 0.4718841696243449, 'support': 981030}, '1': {'precision': 0.567523516250872, 'recall': 0.5310757039380005, 'f1-score': 0.5486950024276996, 'support': 1066074}, '2': {'precision': 0.47831351903611197, 'recall': 0.6260690495491187, 'f1-score': 0.5423071655921783, 'support': 993055}, 'accuracy': 0.5245103956733842, 'macro avg': {'precision': 0.5311402735184751, 'recall': 0.5239057308860647, 'f1-score': 0.5209621125480742, 'support': 3040159}, 'weighted avg': {'precision': 0.5319490913376363, 'recall': 0.5245103956733842, 'f1-score': 0.5218223274742602, 'support': 3040159}}
[[406708 230022 344300]
 [166110 566166 333798]
 [169914 201420 621721]]
Evaluating performance on  train set...
2538/2538 - 46s - 46s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.925476
{'0': {'precision': 0.5318579648941829, 'recall': 0.40937936168232997, 'f1-score': 0.4626498929148542, 'support': 161205}, '1': {'precision': 0.7019699476386212, 'recall': 0.633164313933024, 'f1-score': 0.6657941947726099, 'support': 325012}, '2': {'precision': 0.4396397404341016, 'recall': 0.6252264271027123, 'f1-score': 0.5162609020808699, 'support': 163408}, 'accuracy': 0.5756351741389263, 'macro avg': {'precision': 0.5578225509889686, 'recall': 0.5559233675726887, 'f1-score': 0.5482349965894447, 'support': 649625}, 'weighted avg': {'precision': 0.5937694370714581, 'recall': 0.5756351741389263, 'f1-score': 0.5777698523086479, 'support': 649625}}
[[ 65994  47283  47928]
 [ 36933 205786  82293]
 [ 21155  40086 102167]]
Evaluating performance on  val set...
795/795 - 15s - 15s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94261724
{'0': {'precision': 0.5078162008526764, 'recall': 0.40486602528424903, 'f1-score': 0.45053474457237025, 'support': 50308}, '1': {'precision': 0.6866652732782945, 'recall': 0.6459023483962292, 'f1-score': 0.6656603467751331, 'support': 101729}, '2': {'precision': 0.44521165703133087, 'recall': 0.5858741122677303, 'f1-score': 0.5059481802601069, 'support': 51395}, 'accuracy': 0.5711294191670927, 'macro avg': {'precision': 0.5465643770541007, 'recall': 0.5455474953160695, 'f1-score': 0.5407144238692034, 'support': 203432}, 'weighted avg': {'precision': 0.5814357727936081, 'recall': 0.5711294191670927, 'f1-score': 0.5721109268527199, 'support': 203432}}
[[20368 15806 14134]
 [12634 65707 23388]
 [ 7107 14177 30111]]
training model: results/ATVI/W0/deepVOL_L2/h30
Epoch 1/50
2538/2538 - 95s - loss: 3.0327 - accuracy30: 0.4867 - val_loss: 3.0917 - val_accuracy30: 0.5021 - 95s/epoch - 37ms/step
Epoch 2/50
2538/2538 - 94s - loss: 2.9215 - accuracy30: 0.5227 - val_loss: 3.0684 - val_accuracy30: 0.5235 - 94s/epoch - 37ms/step
Epoch 3/50
2538/2538 - 94s - loss: 2.8751 - accuracy30: 0.5356 - val_loss: 3.0666 - val_accuracy30: 0.5269 - 94s/epoch - 37ms/step
Epoch 4/50
2538/2538 - 94s - loss: 2.8452 - accuracy30: 0.5444 - val_loss: 3.0400 - val_accuracy30: 0.5326 - 94s/epoch - 37ms/step
Epoch 5/50
2538/2538 - 93s - loss: 2.8279 - accuracy30: 0.5484 - val_loss: 3.0544 - val_accuracy30: 0.5347 - 93s/epoch - 37ms/step
Epoch 6/50
2538/2538 - 94s - loss: 2.8166 - accuracy30: 0.5518 - val_loss: 3.0423 - val_accuracy30: 0.5364 - 94s/epoch - 37ms/step
Epoch 7/50
2538/2538 - 94s - loss: 2.8072 - accuracy30: 0.5534 - val_loss: 3.0319 - val_accuracy30: 0.5390 - 94s/epoch - 37ms/step
Epoch 8/50
2538/2538 - 93s - loss: 2.7985 - accuracy30: 0.5560 - val_loss: 3.0279 - val_accuracy30: 0.5397 - 93s/epoch - 37ms/step
Epoch 9/50
2538/2538 - 95s - loss: 2.7918 - accuracy30: 0.5569 - val_loss: 3.0171 - val_accuracy30: 0.5411 - 95s/epoch - 37ms/step
Epoch 10/50
2538/2538 - 92s - loss: 2.7847 - accuracy30: 0.5584 - val_loss: 3.0313 - val_accuracy30: 0.5415 - 92s/epoch - 36ms/step
Epoch 11/50
2538/2538 - 93s - loss: 2.7771 - accuracy30: 0.5601 - val_loss: 3.0065 - val_accuracy30: 0.5418 - 93s/epoch - 37ms/step
Epoch 12/50
2538/2538 - 94s - loss: 2.7703 - accuracy30: 0.5613 - val_loss: 3.0031 - val_accuracy30: 0.5437 - 94s/epoch - 37ms/step
Epoch 13/50
2538/2538 - 93s - loss: 2.7640 - accuracy30: 0.5621 - val_loss: 3.0114 - val_accuracy30: 0.5436 - 93s/epoch - 37ms/step
Epoch 14/50
2538/2538 - 94s - loss: 2.7593 - accuracy30: 0.5630 - val_loss: 3.0138 - val_accuracy30: 0.5431 - 94s/epoch - 37ms/step
Epoch 15/50
2538/2538 - 94s - loss: 2.7544 - accuracy30: 0.5641 - val_loss: 3.0230 - val_accuracy30: 0.5440 - 94s/epoch - 37ms/step
Epoch 16/50
2538/2538 - 92s - loss: 2.7492 - accuracy30: 0.5653 - val_loss: 3.0095 - val_accuracy30: 0.5437 - 92s/epoch - 36ms/step
Epoch 17/50
2538/2538 - 92s - loss: 2.7456 - accuracy30: 0.5660 - val_loss: 2.9962 - val_accuracy30: 0.5431 - 92s/epoch - 36ms/step
Epoch 18/50
2538/2538 - 94s - loss: 2.7417 - accuracy30: 0.5666 - val_loss: 3.0031 - val_accuracy30: 0.5445 - 94s/epoch - 37ms/step
Epoch 19/50
2538/2538 - 93s - loss: 2.7380 - accuracy30: 0.5673 - val_loss: 3.0064 - val_accuracy30: 0.5435 - 93s/epoch - 37ms/step
Epoch 20/50
2538/2538 - 95s - loss: 2.7344 - accuracy30: 0.5680 - val_loss: 3.0060 - val_accuracy30: 0.5436 - 95s/epoch - 37ms/step
Epoch 21/50
2538/2538 - 93s - loss: 2.7307 - accuracy30: 0.5687 - val_loss: 3.0025 - val_accuracy30: 0.5440 - 93s/epoch - 37ms/step
Epoch 22/50
2538/2538 - 93s - loss: 2.7277 - accuracy30: 0.5700 - val_loss: 2.9949 - val_accuracy30: 0.5445 - 93s/epoch - 36ms/step
Epoch 23/50
2538/2538 - 94s - loss: 2.7241 - accuracy30: 0.5702 - val_loss: 3.0018 - val_accuracy30: 0.5438 - 94s/epoch - 37ms/step
Epoch 24/50
2538/2538 - 92s - loss: 2.7224 - accuracy30: 0.5706 - val_loss: 2.9856 - val_accuracy30: 0.5414 - 92s/epoch - 36ms/step
Epoch 25/50
2538/2538 - 93s - loss: 2.7188 - accuracy30: 0.5710 - val_loss: 2.9994 - val_accuracy30: 0.5423 - 93s/epoch - 37ms/step
Epoch 26/50
2538/2538 - 95s - loss: 2.7164 - accuracy30: 0.5710 - val_loss: 2.9868 - val_accuracy30: 0.5413 - 95s/epoch - 37ms/step
Epoch 27/50
2538/2538 - 92s - loss: 2.7133 - accuracy30: 0.5718 - val_loss: 2.9972 - val_accuracy30: 0.5415 - 92s/epoch - 36ms/step
Epoch 28/50
2538/2538 - 93s - loss: 2.7107 - accuracy30: 0.5725 - val_loss: 3.0011 - val_accuracy30: 0.5421 - 93s/epoch - 37ms/step
Epoch 29/50
2538/2538 - 91s - loss: 2.7082 - accuracy30: 0.5730 - val_loss: 3.0064 - val_accuracy30: 0.5426 - 91s/epoch - 36ms/step
Epoch 30/50
2538/2538 - 94s - loss: 2.7058 - accuracy30: 0.5731 - val_loss: 3.0023 - val_accuracy30: 0.5413 - 94s/epoch - 37ms/step
Epoch 31/50
2538/2538 - 94s - loss: 2.7028 - accuracy30: 0.5736 - val_loss: 3.0073 - val_accuracy30: 0.5412 - 94s/epoch - 37ms/step
Epoch 32/50
2538/2538 - 95s - loss: 2.7009 - accuracy30: 0.5740 - val_loss: 2.9943 - val_accuracy30: 0.5430 - 95s/epoch - 37ms/step
Epoch 33/50
2538/2538 - 95s - loss: 2.6983 - accuracy30: 0.5750 - val_loss: 2.9859 - val_accuracy30: 0.5401 - 95s/epoch - 37ms/step
Epoch 34/50
2538/2538 - 93s - loss: 2.6966 - accuracy30: 0.5750 - val_loss: 3.0068 - val_accuracy30: 0.5419 - 93s/epoch - 37ms/step
testing model: results/ATVI/W0/deepVOL_L2/h30
Evaluating performance on  test set...
11876/11876 - 199s - 199s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0352559
{'0': {'precision': 0.5355259897656881, 'recall': 0.457038885384928, 'f1-score': 0.49317925222778025, 'support': 1087658}, '1': {'precision': 0.4338690938890584, 'recall': 0.6080861839361065, 'f1-score': 0.5064129089714793, 'support': 846283}, '2': {'precision': 0.5297562018865704, 'recall': 0.4433592655335567, 'f1-score': 0.4827224074506958, 'support': 1106218}, 'accuracy': 0.49410803842825324, 'macro avg': {'precision': 0.4997170951804389, 'recall': 0.5028281116181971, 'f1-score': 0.49410485621665173, 'support': 3040159}, 'weighted avg': {'precision': 0.5051285184422397, 'recall': 0.49410803842825324, 'f1-score': 0.493058162776344, 'support': 3040159}}
[[497102 327480 263076]
 [159391 514613 172279]
 [271757 344009 490452]]
Evaluating performance on  train set...
2538/2538 - 47s - 47s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94796556
{'0': {'precision': 0.5344555427328319, 'recall': 0.43279213280985657, 'f1-score': 0.47828112712002735, 'support': 186191}, '1': {'precision': 0.5913044018244424, 'recall': 0.6912269112528265, 'f1-score': 0.6373731559077886, 'support': 275513}, '2': {'precision': 0.49701323679149223, 'recall': 0.46754753327196, 'f1-score': 0.4818303212768816, 'support': 187921}, 'accuracy': 0.5524510294400615, 'macro avg': {'precision': 0.5409243937829222, 'recall': 0.5305221924448811, 'f1-score': 0.5324948681015659, 'support': 649625}, 'weighted avg': {'precision': 0.5477345947091328, 'recall': 0.5524510294400615, 'f1-score': 0.5467804771181842, 'support': 649625}}
[[ 80582  65186  40423]
 [ 36576 190442  48495]
 [ 33616  66443  87862]]
Evaluating performance on  val set...
795/795 - 15s - 15s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9725694
{'0': {'precision': 0.5111480460515648, 'recall': 0.4346806860294751, 'f1-score': 0.4698232899553801, 'support': 58015}, '1': {'precision': 0.5757761888766255, 'recall': 0.6974389379090666, 'f1-score': 0.6307947890270958, 'support': 86019}, '2': {'precision': 0.5032364080880143, 'recall': 0.42277517761540795, 'f1-score': 0.4595101510535321, 'support': 59398}, 'accuracy': 0.542308977938574, 'macro avg': {'precision': 0.5300535476720682, 'recall': 0.51829826718465, 'f1-score': 0.5200427433453361, 'support': 203432}, 'weighted avg': {'precision': 0.5361653134721768, 'recall': 0.542308977938574, 'f1-score': 0.5348771042724882, 'support': 203432}}
[[25218 21424 11373]
 [12610 59993 13416]
 [11508 22778 25112]]
training model: results/ATVI/W0/deepVOL_L2/h50
Epoch 1/50
2538/2538 - 95s - loss: 3.1395 - accuracy50: 0.4463 - val_loss: 3.1253 - val_accuracy50: 0.4581 - 95s/epoch - 37ms/step
Epoch 2/50
2538/2538 - 93s - loss: 3.0161 - accuracy50: 0.4862 - val_loss: 3.1268 - val_accuracy50: 0.4530 - 93s/epoch - 37ms/step
Epoch 3/50
2538/2538 - 93s - loss: 2.9740 - accuracy50: 0.4972 - val_loss: 3.1146 - val_accuracy50: 0.4507 - 93s/epoch - 37ms/step
Epoch 4/50
2538/2538 - 92s - loss: 2.9472 - accuracy50: 0.5035 - val_loss: 3.1395 - val_accuracy50: 0.4588 - 92s/epoch - 36ms/step
Epoch 5/50
2538/2538 - 93s - loss: 2.9343 - accuracy50: 0.5067 - val_loss: 3.1311 - val_accuracy50: 0.4592 - 93s/epoch - 37ms/step
Epoch 6/50
2538/2538 - 92s - loss: 2.9258 - accuracy50: 0.5088 - val_loss: 3.1086 - val_accuracy50: 0.4608 - 92s/epoch - 36ms/step
Epoch 7/50
2538/2538 - 94s - loss: 2.9189 - accuracy50: 0.5108 - val_loss: 3.1098 - val_accuracy50: 0.4646 - 94s/epoch - 37ms/step
Epoch 8/50
2538/2538 - 95s - loss: 2.9127 - accuracy50: 0.5121 - val_loss: 3.1003 - val_accuracy50: 0.4664 - 95s/epoch - 37ms/step
Epoch 9/50
2538/2538 - 94s - loss: 2.9075 - accuracy50: 0.5132 - val_loss: 3.1007 - val_accuracy50: 0.4672 - 94s/epoch - 37ms/step
Epoch 10/50
2538/2538 - 92s - loss: 2.9029 - accuracy50: 0.5148 - val_loss: 3.0900 - val_accuracy50: 0.4698 - 92s/epoch - 36ms/step
Epoch 11/50
2538/2538 - 93s - loss: 2.8998 - accuracy50: 0.5150 - val_loss: 3.0878 - val_accuracy50: 0.4717 - 93s/epoch - 37ms/step
Epoch 12/50
2538/2538 - 91s - loss: 2.8949 - accuracy50: 0.5164 - val_loss: 3.0953 - val_accuracy50: 0.4702 - 91s/epoch - 36ms/step
Epoch 13/50
2538/2538 - 94s - loss: 2.8924 - accuracy50: 0.5169 - val_loss: 3.0766 - val_accuracy50: 0.4746 - 94s/epoch - 37ms/step
Epoch 14/50
2538/2538 - 93s - loss: 2.8876 - accuracy50: 0.5183 - val_loss: 3.0780 - val_accuracy50: 0.4766 - 93s/epoch - 37ms/step
Epoch 15/50
2538/2538 - 93s - loss: 2.8849 - accuracy50: 0.5188 - val_loss: 3.0678 - val_accuracy50: 0.4828 - 93s/epoch - 37ms/step
Epoch 16/50
2538/2538 - 94s - loss: 2.8817 - accuracy50: 0.5198 - val_loss: 3.0686 - val_accuracy50: 0.4830 - 94s/epoch - 37ms/step
Epoch 17/50
2538/2538 - 93s - loss: 2.8779 - accuracy50: 0.5205 - val_loss: 3.0709 - val_accuracy50: 0.4850 - 93s/epoch - 36ms/step
Epoch 18/50
2538/2538 - 94s - loss: 2.8754 - accuracy50: 0.5214 - val_loss: 3.0640 - val_accuracy50: 0.4844 - 94s/epoch - 37ms/step
Epoch 19/50
2538/2538 - 94s - loss: 2.8725 - accuracy50: 0.5217 - val_loss: 3.0639 - val_accuracy50: 0.4862 - 94s/epoch - 37ms/step
Epoch 20/50
2538/2538 - 95s - loss: 2.8693 - accuracy50: 0.5221 - val_loss: 3.0706 - val_accuracy50: 0.4872 - 95s/epoch - 37ms/step
Epoch 21/50
2538/2538 - 94s - loss: 2.8673 - accuracy50: 0.5228 - val_loss: 3.0638 - val_accuracy50: 0.4872 - 94s/epoch - 37ms/step
Epoch 22/50
2538/2538 - 96s - loss: 2.8644 - accuracy50: 0.5231 - val_loss: 3.0699 - val_accuracy50: 0.4867 - 96s/epoch - 38ms/step
Epoch 23/50
2538/2538 - 92s - loss: 2.8616 - accuracy50: 0.5239 - val_loss: 3.0769 - val_accuracy50: 0.4867 - 92s/epoch - 36ms/step
Epoch 24/50
2538/2538 - 94s - loss: 2.8592 - accuracy50: 0.5247 - val_loss: 3.0655 - val_accuracy50: 0.4881 - 94s/epoch - 37ms/step
Epoch 25/50
2538/2538 - 95s - loss: 2.8568 - accuracy50: 0.5253 - val_loss: 3.0790 - val_accuracy50: 0.4888 - 95s/epoch - 37ms/step
Epoch 26/50
2538/2538 - 93s - loss: 2.8538 - accuracy50: 0.5259 - val_loss: 3.0763 - val_accuracy50: 0.4885 - 93s/epoch - 37ms/step
Epoch 27/50
2538/2538 - 92s - loss: 2.8515 - accuracy50: 0.5261 - val_loss: 3.0825 - val_accuracy50: 0.4883 - 92s/epoch - 36ms/step
Epoch 28/50
2538/2538 - 94s - loss: 2.8488 - accuracy50: 0.5266 - val_loss: 3.0786 - val_accuracy50: 0.4887 - 94s/epoch - 37ms/step
Epoch 29/50
2538/2538 - 89s - loss: 2.8471 - accuracy50: 0.5276 - val_loss: 3.0831 - val_accuracy50: 0.4886 - 89s/epoch - 35ms/step
Epoch 30/50
2538/2538 - 90s - loss: 2.8449 - accuracy50: 0.5283 - val_loss: 3.0846 - val_accuracy50: 0.4885 - 90s/epoch - 35ms/step
Epoch 31/50
2538/2538 - 88s - loss: 2.8431 - accuracy50: 0.5285 - val_loss: 3.0896 - val_accuracy50: 0.4883 - 88s/epoch - 35ms/step
testing model: results/ATVI/W0/deepVOL_L2/h50
Evaluating performance on  test set...
11876/11876 - 196s - 196s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0526919
{'0': {'precision': 0.5238267805745905, 'recall': 0.43854029662154165, 'f1-score': 0.47740442742654415, 'support': 1199778}, '1': {'precision': 0.32174995344413454, 'recall': 0.5025818178232532, 'f1-score': 0.3923315396127027, 'support': 608486}, '2': {'precision': 0.5189278793569414, 'recall': 0.45715503350529063, 'f1-score': 0.4860867636307768, 'support': 1231895}, 'accuracy': 0.4589009982701563, 'macro avg': {'precision': 0.45483487112522214, 'recall': 0.46609238265002845, 'f1-score': 0.4519409102233412, 'support': 3040159}, 'weighted avg': {'precision': 0.4813961537064502, 'recall': 0.4589009982701563, 'f1-score': 0.4638952870638263, 'support': 3040159}}
[[526151 317605 356022]
 [136610 305814 166062]
 [341676 327052 563167]]
Evaluating performance on  train set...
2538/2538 - 44s - 44s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0054586
{'0': {'precision': 0.5157753337251281, 'recall': 0.42342967421770894, 'f1-score': 0.46506264272827064, 'support': 217630}, '1': {'precision': 0.48297556676842535, 'recall': 0.6085123328101942, 'f1-score': 0.5385246853181647, 'support': 213455}, '2': {'precision': 0.49150344267731894, 'recall': 0.45435618193465727, 'f1-score': 0.47220035999362764, 'support': 218540}, 'accuracy': 0.49464845102944005, 'macro avg': {'precision': 0.4967514477236241, 'recall': 0.4954327296541868, 'f1-score': 0.4919292293466877, 'support': 649625}, 'weighted avg': {'precision': 0.4968326308960633, 'recall': 0.49464845102944005, 'f1-score': 0.49160213402278197, 'support': 649625}}
[[ 92151  69938  55541]
 [ 36378 129890  47187]
 [ 50136  69109  99295]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0224509
{'0': {'precision': 0.5021040379622168, 'recall': 0.41585098178798124, 'f1-score': 0.45492524721552974, 'support': 67428}, '1': {'precision': 0.46978945650399867, 'recall': 0.6477825121526736, 'f1-score': 0.5446117169219902, 'support': 66652}, '2': {'precision': 0.5031248877554686, 'recall': 0.40395374322297845, 'f1-score': 0.44811811187357037, 'support': 69352}, 'accuracy': 0.48778461598961814, 'macro avg': {'precision': 0.4916727940738947, 'recall': 0.4891957457212111, 'f1-score': 0.48255169200369674, 'support': 203432}, 'weighted avg': {'precision': 0.49186457952651563, 'recall': 0.48778461598961814, 'f1-score': 0.4819892987346587, 'support': 203432}}
[[28040 23767 15621]
 [11430 43176 12046]
 [16375 24962 28015]]
training model: results/ATVI/W0/deepVOL_L2/h100
Epoch 1/50
2538/2538 - 91s - loss: 3.2398 - accuracy100: 0.4028 - val_loss: 3.2390 - val_accuracy100: 0.4060 - 91s/epoch - 36ms/step
Epoch 2/50
2538/2538 - 92s - loss: 3.1911 - accuracy100: 0.4251 - val_loss: 3.2215 - val_accuracy100: 0.4111 - 92s/epoch - 36ms/step
Epoch 3/50
2538/2538 - 91s - loss: 3.1689 - accuracy100: 0.4336 - val_loss: 3.2237 - val_accuracy100: 0.4073 - 91s/epoch - 36ms/step
Epoch 4/50
2538/2538 - 91s - loss: 3.1589 - accuracy100: 0.4381 - val_loss: 3.2210 - val_accuracy100: 0.4089 - 91s/epoch - 36ms/step
Epoch 5/50
2538/2538 - 90s - loss: 3.1507 - accuracy100: 0.4408 - val_loss: 3.2426 - val_accuracy100: 0.4069 - 90s/epoch - 35ms/step
Epoch 6/50
2538/2538 - 91s - loss: 3.1456 - accuracy100: 0.4436 - val_loss: 3.2435 - val_accuracy100: 0.4050 - 91s/epoch - 36ms/step
Epoch 7/50
2538/2538 - 88s - loss: 3.1426 - accuracy100: 0.4445 - val_loss: 3.2353 - val_accuracy100: 0.4063 - 88s/epoch - 35ms/step
Epoch 8/50
2538/2538 - 89s - loss: 3.1398 - accuracy100: 0.4456 - val_loss: 3.2290 - val_accuracy100: 0.4098 - 89s/epoch - 35ms/step
Epoch 9/50
2538/2538 - 90s - loss: 3.1369 - accuracy100: 0.4467 - val_loss: 3.2518 - val_accuracy100: 0.4051 - 90s/epoch - 35ms/step
Epoch 10/50
2538/2538 - 91s - loss: 3.1336 - accuracy100: 0.4476 - val_loss: 3.2442 - val_accuracy100: 0.4069 - 91s/epoch - 36ms/step
Epoch 11/50
2538/2538 - 89s - loss: 3.1305 - accuracy100: 0.4487 - val_loss: 3.2429 - val_accuracy100: 0.4088 - 89s/epoch - 35ms/step
Epoch 12/50
2538/2538 - 89s - loss: 3.1281 - accuracy100: 0.4499 - val_loss: 3.2534 - val_accuracy100: 0.4083 - 89s/epoch - 35ms/step
Epoch 13/50
2538/2538 - 79s - loss: 3.1264 - accuracy100: 0.4507 - val_loss: 3.2516 - val_accuracy100: 0.4088 - 79s/epoch - 31ms/step
Epoch 14/50
2538/2538 - 90s - loss: 3.1241 - accuracy100: 0.4516 - val_loss: 3.2551 - val_accuracy100: 0.4082 - 90s/epoch - 35ms/step
testing model: results/ATVI/W0/deepVOL_L2/h100
Evaluating performance on  test set...
11876/11876 - 197s - 197s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0903852
{'0': {'precision': 0.48825661671043735, 'recall': 0.21401393086952475, 'f1-score': 0.297588210627209, 'support': 1160588}, '1': {'precision': 0.28296491862083734, 'recall': 0.4861969142492461, 'f1-score': 0.35773140162423467, 'support': 695714}, '2': {'precision': 0.44551833569725796, 'recall': 0.502794678749207, 'f1-score': 0.47242681490464744, 'support': 1183857}, 'accuracy': 0.3887536803173781, 'macro avg': {'precision': 0.4055799570095109, 'recall': 0.401001841289326, 'f1-score': 0.37591547571869705, 'support': 3040159}, 'weighted avg': {'precision': 0.4246348385106368, 'recall': 0.3887536803173781, 'f1-score': 0.379434707973361, 'support': 3040159}}
[[248382 429660 482546]
 [ 99188 338254 258272]
 [161142 427478 595237]]
Evaluating performance on  train set...
2538/2538 - 41s - 41s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.076557
{'0': {'precision': 0.48969339806329343, 'recall': 0.16958714689011561, 'f1-score': 0.2519282780727236, 'support': 222452}, '1': {'precision': 0.38490747160151456, 'recall': 0.6916166373597942, 'f1-score': 0.49457027295106826, 'support': 208711}, '2': {'precision': 0.4196804122145905, 'recall': 0.37953969111332864, 'f1-score': 0.3986020205322225, 'support': 218462}, 'accuracy': 0.40790917837213775, 'macro avg': {'precision': 0.4314270939597995, 'recall': 0.41358115845441284, 'f1-score': 0.38170019051867143, 'support': 649625}, 'weighted avg': {'precision': 0.4324832346424835, 'recall': 0.40790917837213775, 'f1-score': 0.3792089284760197, 'support': 649625}}
[[ 37725 116257  68470]
 [ 18181 144348  46182]
 [ 21132 114415  82915]]
Evaluating performance on  val set...
795/795 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0770673
{'0': {'precision': 0.48196831816649816, 'recall': 0.1872136155356753, 'f1-score': 0.26967563490067886, 'support': 68745}, '1': {'precision': 0.38443445060087295, 'recall': 0.7097400611620795, 'f1-score': 0.49872945777663175, 'support': 65400}, '2': {'precision': 0.4265378295349003, 'recall': 0.3446678309062306, 'f1-score': 0.381257234085013, 'support': 69287}, 'accuracy': 0.40882457037240943, 'macro avg': {'precision': 0.4309801994340905, 'recall': 0.41387383586799514, 'f1-score': 0.3832207755874412, 'support': 203432}, 'weighted avg': {'precision': 0.4317337080529988, 'recall': 0.40882457037240943, 'f1-score': 0.38131625328309793, 'support': 203432}}
[[12870 36567 19308]
 [ 6184 46417 12799]
 [ 7649 37757 23881]]
training model: results/ATVI/W0/deepVOL_L2/h200
Epoch 1/50
2538/2538 - 89s - loss: 3.2825 - accuracy200: 0.3747 - val_loss: 3.2940 - val_accuracy200: 0.3544 - 89s/epoch - 35ms/step
Epoch 2/50
2538/2538 - 89s - loss: 3.2661 - accuracy200: 0.3831 - val_loss: 3.2907 - val_accuracy200: 0.3612 - 89s/epoch - 35ms/step
Epoch 3/50
2538/2538 - 89s - loss: 3.2521 - accuracy200: 0.3945 - val_loss: 3.3121 - val_accuracy200: 0.3573 - 89s/epoch - 35ms/step
Epoch 4/50
2538/2538 - 84s - loss: 3.2422 - accuracy200: 0.3987 - val_loss: 3.3560 - val_accuracy200: 0.3577 - 84s/epoch - 33ms/step
Epoch 5/50
2538/2538 - 91s - loss: 3.2356 - accuracy200: 0.4019 - val_loss: 3.3473 - val_accuracy200: 0.3673 - 91s/epoch - 36ms/step
Epoch 6/50
2538/2538 - 90s - loss: 3.2303 - accuracy200: 0.4042 - val_loss: 3.3920 - val_accuracy200: 0.3659 - 90s/epoch - 35ms/step
Epoch 7/50
2538/2538 - 90s - loss: 3.2265 - accuracy200: 0.4069 - val_loss: 3.4037 - val_accuracy200: 0.3665 - 90s/epoch - 35ms/step
Epoch 8/50
2538/2538 - 85s - loss: 3.2230 - accuracy200: 0.4079 - val_loss: 3.4069 - val_accuracy200: 0.3645 - 85s/epoch - 33ms/step
Epoch 9/50
2538/2538 - 88s - loss: 3.2199 - accuracy200: 0.4101 - val_loss: 3.3903 - val_accuracy200: 0.3688 - 88s/epoch - 35ms/step
Epoch 10/50
2538/2538 - 90s - loss: 3.2171 - accuracy200: 0.4112 - val_loss: 3.4002 - val_accuracy200: 0.3739 - 90s/epoch - 35ms/step
Epoch 11/50
2538/2538 - 90s - loss: 3.2141 - accuracy200: 0.4129 - val_loss: 3.4095 - val_accuracy200: 0.3728 - 90s/epoch - 35ms/step
Epoch 12/50
2538/2538 - 90s - loss: 3.2121 - accuracy200: 0.4137 - val_loss: 3.3960 - val_accuracy200: 0.3733 - 90s/epoch - 35ms/step
testing model: results/ATVI/W0/deepVOL_L2/h200
Evaluating performance on  test set...
11876/11876 - 189s - 189s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1194987
{'0': {'precision': 0.43736796442480147, 'recall': 0.09965958050389177, 'f1-score': 0.16233025017815203, 'support': 1128020}, '1': {'precision': 0.24242105374938577, 'recall': 0.6738230937661, 'f1-score': 0.35656195976670796, 'support': 745344}, '2': {'precision': 0.42294489738543717, 'recall': 0.2578713484373862, 'f1-score': 0.32039591203256323, 'support': 1166795}, 'accuracy': 0.3011457624420302, 'macro avg': {'precision': 0.3675779718532081, 'recall': 0.3437846742357926, 'f1-score': 0.2797627073258077, 'support': 3040159}, 'weighted avg': {'precision': 0.38403809822482565, 'recall': 0.3011457624420302, 'f1-score': 0.2706139495751212, 'support': 3040159}}
[[112418 784563 231039]
 [ 63636 502230 179478]
 [ 80979 784933 300883]]
Evaluating performance on  train set...
2538/2538 - 44s - 44s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0971055
{'0': {'precision': 0.4089470061940812, 'recall': 0.13747946600032393, 'f1-score': 0.2057799864937404, 'support': 216105}, '1': {'precision': 0.34306831176647606, 'recall': 0.645149899041117, 'f1-score': 0.4479384902641543, 'support': 220882}, '2': {'precision': 0.3784591584158416, 'recall': 0.28762027483328473, 'f1-score': 0.3268454833555117, 'support': 212638}, 'accuracy': 0.35923956128535695, 'macro avg': {'precision': 0.37682482545879964, 'recall': 0.35674987995824187, 'f1-score': 0.32685465337113545, 'support': 649625}, 'weighted avg': {'precision': 0.3765678755288088, 'recall': 0.35923956128535695, 'f1-score': 0.32774508905523336, 'support': 649625}}
[[ 29710 140919  45476]
 [ 23415 142502  54965]
 [ 19525 131954  61159]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0962051
{'0': {'precision': 0.38732710151426303, 'recall': 0.16899437136923215, 'f1-score': 0.23531753931913196, 'support': 66446}, '1': {'precision': 0.3450040315077839, 'recall': 0.637462754985102, 'f1-score': 0.44770413296309713, 'support': 69808}, '2': {'precision': 0.38691510658424444, 'recall': 0.2618119027062431, 'f1-score': 0.31230079460203314, 'support': 67178}, 'accuracy': 0.3604005269574108, 'macro avg': {'precision': 0.3730820798687638, 'recall': 0.35608967635352573, 'f1-score': 0.3317741556280874, 'support': 203432}, 'weighted avg': {'precision': 0.3726678253609485, 'recall': 0.3604005269574108, 'f1-score': 0.3336199915021349, 'support': 203432}}
[[11229 42545 12672]
 [10111 44500 15197]
 [ 7651 41939 17588]]
training model: results/ATVI/W0/deepVOL_L2/h300
Epoch 1/50
2538/2538 - 92s - loss: 3.2945 - accuracy300: 0.3614 - val_loss: 3.3004 - val_accuracy300: 0.3304 - 92s/epoch - 36ms/step
Epoch 2/50
2538/2538 - 91s - loss: 3.2821 - accuracy300: 0.3689 - val_loss: 3.2958 - val_accuracy300: 0.3362 - 91s/epoch - 36ms/step
Epoch 3/50
2538/2538 - 92s - loss: 3.2755 - accuracy300: 0.3755 - val_loss: 3.2969 - val_accuracy300: 0.3428 - 92s/epoch - 36ms/step
Epoch 4/50
2538/2538 - 90s - loss: 3.2710 - accuracy300: 0.3769 - val_loss: 3.2992 - val_accuracy300: 0.3434 - 90s/epoch - 35ms/step
Epoch 5/50
2538/2538 - 90s - loss: 3.2661 - accuracy300: 0.3824 - val_loss: 3.3030 - val_accuracy300: 0.3485 - 90s/epoch - 36ms/step
Epoch 6/50
2538/2538 - 91s - loss: 3.2620 - accuracy300: 0.3846 - val_loss: 3.3172 - val_accuracy300: 0.3456 - 91s/epoch - 36ms/step
Epoch 7/50
2538/2538 - 91s - loss: 3.2558 - accuracy300: 0.3879 - val_loss: 3.3376 - val_accuracy300: 0.3476 - 91s/epoch - 36ms/step
Epoch 8/50
2538/2538 - 91s - loss: 3.2501 - accuracy300: 0.3928 - val_loss: 3.3523 - val_accuracy300: 0.3460 - 91s/epoch - 36ms/step
Epoch 9/50
2538/2538 - 89s - loss: 3.2470 - accuracy300: 0.3938 - val_loss: 3.3429 - val_accuracy300: 0.3496 - 89s/epoch - 35ms/step
Epoch 10/50
2538/2538 - 91s - loss: 3.2441 - accuracy300: 0.3963 - val_loss: 3.3582 - val_accuracy300: 0.3457 - 91s/epoch - 36ms/step
Epoch 11/50
2538/2538 - 90s - loss: 3.2417 - accuracy300: 0.3979 - val_loss: 3.3425 - val_accuracy300: 0.3511 - 90s/epoch - 36ms/step
Epoch 12/50
2538/2538 - 91s - loss: 3.2391 - accuracy300: 0.4001 - val_loss: 3.3415 - val_accuracy300: 0.3537 - 91s/epoch - 36ms/step
testing model: results/ATVI/W0/deepVOL_L2/h300
Evaluating performance on  test set...
11876/11876 - 196s - 196s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1143497
{'0': {'precision': 0.4269626941346, 'recall': 0.007107547860450405, 'f1-score': 0.013982335067434178, 'support': 1125564}, '1': {'precision': 0.24582583969805732, 'recall': 0.7584014774643978, 'f1-score': 0.3712997582115626, 'support': 749392}, '2': {'precision': 0.41186254334282413, 'recall': 0.2507717539347221, 'f1-score': 0.3117360293556762, 'support': 1165203}, 'accuracy': 0.28568900508164213, 'macro avg': {'precision': 0.36155035905849386, 'recall': 0.3387602597531901, 'f1-score': 0.23233937421155768, 'support': 3040159}, 'weighted avg': {'precision': 0.37652544706201624, 'recall': 0.28568900508164213, 'f1-score': 0.21618041622390236, 'support': 3040159}}
[[  8000 876832 240732]
 [  4524 568340 176528]
 [  6213 866790 292200]]
Evaluating performance on  train set...
2538/2538 - 45s - 45s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001287
{'0': {'precision': 0.3975, 'recall': 0.015049285395567694, 'f1-score': 0.029000612322003204, 'support': 221871}, '1': {'precision': 0.32252691190652505, 'recall': 0.8246507657161389, 'f1-score': 0.46369811766031, 'support': 209673}, '2': {'precision': 0.3804839998477988, 'recall': 0.18340891687033717, 'f1-score': 0.24750854720688112, 'support': 218081}, 'accuracy': 0.3328751202616894, 'macro avg': {'precision': 0.36683697058477466, 'recall': 0.34103632266068123, 'f1-score': 0.24673575906306477, 'support': 649625}, 'weighted avg': {'precision': 0.3675893613561434, 'recall': 0.3328751202616894, 'f1-score': 0.24265735118585216, 'support': 649625}}
[[  3339 187574  30958]
 [  2598 172907  34168]
 [  2463 175620  39998]]
Evaluating performance on  val set...
795/795 - 15s - 15s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.100201
{'0': {'precision': 0.39581856839121193, 'recall': 0.016309664607881788, 'f1-score': 0.03132844381494622, 'support': 68487}, '1': {'precision': 0.32541661276475636, 'recall': 0.8432657290444482, 'f1-score': 0.46961037638583053, 'support': 65627}, '2': {'precision': 0.3936755270394134, 'recall': 0.17349029112207506, 'f1-score': 0.24084272925720465, 'support': 69318}, 'accuracy': 0.3366432026426521, 'macro avg': {'precision': 0.3716369027317939, 'recall': 0.344355228258135, 'f1-score': 0.2472605164859938, 'support': 203432}, 'weighted avg': {'precision': 0.37237672796138094, 'recall': 0.3366432026426521, 'f1-score': 0.24410833895000805, 'support': 203432}}
[[ 1117 58289  9081]
 [  845 55341  9441]
 [  860 56432 12026]]
training model: results/ATVI/W0/deepVOL_L2/h500
Epoch 1/50
2538/2538 - 91s - loss: 3.2582 - accuracy500: 0.3924 - val_loss: 3.3009 - val_accuracy500: 0.3343 - 91s/epoch - 36ms/step
Epoch 2/50
2538/2538 - 89s - loss: 3.2624 - accuracy500: 0.3818 - val_loss: 3.2941 - val_accuracy500: 0.3489 - 89s/epoch - 35ms/step
Epoch 3/50
2538/2538 - 90s - loss: 3.2555 - accuracy500: 0.3829 - val_loss: 3.2942 - val_accuracy500: 0.3481 - 90s/epoch - 36ms/step
Epoch 4/50
2538/2538 - 90s - loss: 3.2524 - accuracy500: 0.3863 - val_loss: 3.3049 - val_accuracy500: 0.3419 - 90s/epoch - 35ms/step
Epoch 5/50
2538/2538 - 91s - loss: 3.2487 - accuracy500: 0.3873 - val_loss: 3.2978 - val_accuracy500: 0.3445 - 91s/epoch - 36ms/step
Epoch 6/50
2538/2538 - 90s - loss: 3.2466 - accuracy500: 0.3870 - val_loss: 3.2986 - val_accuracy500: 0.3451 - 90s/epoch - 35ms/step
Epoch 7/50
2538/2538 - 91s - loss: 3.2474 - accuracy500: 0.3888 - val_loss: 3.3057 - val_accuracy500: 0.3386 - 91s/epoch - 36ms/step
Epoch 8/50
2538/2538 - 91s - loss: 3.2463 - accuracy500: 0.3880 - val_loss: 3.3016 - val_accuracy500: 0.3415 - 91s/epoch - 36ms/step
Epoch 9/50
2538/2538 - 90s - loss: 3.2439 - accuracy500: 0.3882 - val_loss: 3.3007 - val_accuracy500: 0.3432 - 90s/epoch - 36ms/step
Epoch 10/50
2538/2538 - 89s - loss: 3.2410 - accuracy500: 0.3918 - val_loss: 3.3051 - val_accuracy500: 0.3342 - 89s/epoch - 35ms/step
Epoch 11/50
2538/2538 - 90s - loss: 3.2364 - accuracy500: 0.3948 - val_loss: 3.3026 - val_accuracy500: 0.3461 - 90s/epoch - 35ms/step
Epoch 12/50
2538/2538 - 90s - loss: 3.2341 - accuracy500: 0.3952 - val_loss: 3.3000 - val_accuracy500: 0.3456 - 90s/epoch - 35ms/step
testing model: results/ATVI/W0/deepVOL_L2/h500
Evaluating performance on  test set...
11876/11876 - 205s - 205s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0893247
{'0': {'precision': 0.4034476930877134, 'recall': 0.030137938638389344, 'f1-score': 0.0560861842661713, 'support': 1188137}, '1': {'precision': 0.2180396945342448, 'recall': 0.07015820619137716, 'f1-score': 0.10615812126683163, 'support': 621025}, '2': {'precision': 0.4078481511336404, 'recall': 0.9116399146382973, 'f1-score': 0.5635680432885759, 'support': 1230997}, 'accuracy': 0.3952438013932824, 'macro avg': {'precision': 0.34311184625186625, 'recall': 0.33731201982268794, 'f1-score': 0.24193744960719296, 'support': 3040159}, 'weighted avg': {'precision': 0.36735548486817426, 'recall': 0.3952438013932824, 'f1-score': 0.27180008958718843, 'support': 3040159}}
[[  35808   81009 1071320]
 [  19423   43570  558032]
 [  33524   75247 1122226]]
Evaluating performance on  train set...
2538/2538 - 44s - 44s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0998416
{'0': {'precision': 0.33750962227590053, 'recall': 0.05833157474607529, 'f1-score': 0.09947154519246941, 'support': 217978}, '1': {'precision': 0.3489846635687416, 'recall': 0.18871267626376054, 'f1-score': 0.2449624536270931, 'support': 217288}, '2': {'precision': 0.334862292548953, 'recall': 0.7724145009073563, 'f1-score': 0.46718669098901966, 'support': 214359}, 'accuracy': 0.3375701366172792, 'macro avg': {'precision': 0.34045219279786504, 'recall': 0.33981958397239737, 'f1-score': 0.27054022993619403, 'support': 649625}, 'weighted avg': {'precision': 0.34047427083391496, 'recall': 0.3375701366172792, 'f1-score': 0.2694718983958486, 'support': 649625}}
[[ 12715  39411 165852]
 [ 13255  41005 163028]
 [ 11703  37082 165574]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981513
{'0': {'precision': 0.3296524257784214, 'recall': 0.05304089479203076, 'f1-score': 0.09137896427137696, 'support': 68664}, '1': {'precision': 0.35711910620469506, 'recall': 0.1643986590947359, 'f1-score': 0.22515015251092732, 'support': 65329}, '2': {'precision': 0.34789600147865196, 'recall': 0.8131885539826322, 'f1-score': 0.4873117036103715, 'support': 69439}, 'accuracy': 0.3482687089543435, 'macro avg': {'precision': 0.3448891778205894, 'recall': 0.34354270262313297, 'f1-score': 0.26794694013089193, 'support': 203432}, 'weighted avg': {'precision': 0.3447001391107208, 'recall': 0.3482687089543435, 'f1-score': 0.26948423504225877, 'support': 203432}}
[[ 3642  9882 55140]
 [ 3886 10740 50703]
 [ 3520  9452 56467]]
training model: results/ATVI/W0/deepVOL_L2/h1000
Epoch 1/50
2538/2538 - 92s - loss: 3.2823 - accuracy1000: 0.3829 - val_loss: 3.3305 - val_accuracy1000: 0.3324 - 92s/epoch - 36ms/step
Epoch 2/50
2538/2538 - 92s - loss: 3.2795 - accuracy1000: 0.3769 - val_loss: 3.3252 - val_accuracy1000: 0.3333 - 92s/epoch - 36ms/step
Epoch 3/50
2538/2538 - 90s - loss: 3.2665 - accuracy1000: 0.3806 - val_loss: 3.3786 - val_accuracy1000: 0.3328 - 90s/epoch - 35ms/step
Epoch 4/50
2538/2538 - 90s - loss: 3.2616 - accuracy1000: 0.3842 - val_loss: 3.3719 - val_accuracy1000: 0.3328 - 90s/epoch - 35ms/step
Epoch 5/50
2538/2538 - 90s - loss: 3.2547 - accuracy1000: 0.3889 - val_loss: 3.3798 - val_accuracy1000: 0.3328 - 90s/epoch - 35ms/step
Epoch 6/50
2538/2538 - 90s - loss: 3.2533 - accuracy1000: 0.3885 - val_loss: 3.3589 - val_accuracy1000: 0.3358 - 90s/epoch - 36ms/step
Epoch 7/50
2538/2538 - 89s - loss: 3.2494 - accuracy1000: 0.3907 - val_loss: 3.3495 - val_accuracy1000: 0.3409 - 89s/epoch - 35ms/step
Epoch 8/50
2538/2538 - 92s - loss: 3.2465 - accuracy1000: 0.3911 - val_loss: 3.3457 - val_accuracy1000: 0.3418 - 92s/epoch - 36ms/step
Epoch 9/50
2538/2538 - 89s - loss: 3.2443 - accuracy1000: 0.3921 - val_loss: 3.3528 - val_accuracy1000: 0.3390 - 89s/epoch - 35ms/step
Epoch 10/50
2538/2538 - 90s - loss: 3.2423 - accuracy1000: 0.3941 - val_loss: 3.3520 - val_accuracy1000: 0.3462 - 90s/epoch - 36ms/step
Epoch 11/50
2538/2538 - 93s - loss: 3.2393 - accuracy1000: 0.3965 - val_loss: 3.3455 - val_accuracy1000: 0.3489 - 93s/epoch - 37ms/step
Epoch 12/50
2538/2538 - 90s - loss: 3.2368 - accuracy1000: 0.3989 - val_loss: 3.3605 - val_accuracy1000: 0.3430 - 90s/epoch - 35ms/step
testing model: results/ATVI/W0/deepVOL_L2/h1000
Evaluating performance on  test set...
11876/11876 - 193s - 193s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1307261
{'0': {'precision': 0.3310344827586207, 'recall': 4.197400235229305e-05, 'f1-score': 8.39373617437987e-05, 'support': 1143565}, '1': {'precision': 0.23535704476928576, 'recall': 0.9930776209494228, 'f1-score': 0.3805294992329514, 'support': 715361}, '2': {'precision': 0.40040772830468424, 'recall': 0.007316084125655141, 'f1-score': 0.014369612642332658, 'support': 1181233}, 'accuracy': 0.2365333523674255, 'macro avg': {'precision': 0.3222664186108635, 'recall': 0.33347855969247675, 'f1-score': 0.1316610164123426, 'support': 3040159}, 'weighted avg': {'precision': 0.33547571732517617, 'recall': 0.2365333523674255, 'f1-score': 0.09515482959286221, 'support': 3040159}}
[[     48 1135494    8023]
 [     34  710409    4918]
 [     63 1172528    8642]]
Evaluating performance on  train set...
2538/2538 - 44s - 44s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1014618
{'0': {'precision': 0.3469387755102041, 'recall': 0.0001570090695827253, 'f1-score': 0.00031387609279654366, 'support': 216548}, '1': {'precision': 0.34513579676385914, 'recall': 0.9890608921301061, 'f1-score': 0.5117091383824098, 'support': 223510}, '2': {'precision': 0.3687715014981689, 'recall': 0.01585650412517238, 'f1-score': 0.030405621791763125, 'support': 209567}, 'accuracy': 0.3454639214931691, 'macro avg': {'precision': 0.35361535792407733, 'recall': 0.33502480177495375, 'f1-score': 0.18080954542232316, 'support': 649625}, 'weighted avg': {'precision': 0.35336161192740523, 'recall': 0.3454639214931691, 'f1-score': 0.18597205110953205, 'support': 649625}}
[[    34 213244   3270]
 [    27 221065   2418]
 [    37 206207   3323]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1054909
{'0': {'precision': 0.34615384615384615, 'recall': 0.0001334203036053131, 'f1-score': 0.0002667377967457989, 'support': 67456}, '1': {'precision': 0.3332687280714832, 'recall': 0.9905759316976617, 'f1-score': 0.4987412660223634, 'support': 67699}, '2': {'precision': 0.3566849816849817, 'recall': 0.011409405802832579, 'f1-score': 0.02211152268630874, 'support': 68277}, 'accuracy': 0.3335217664870817, 'macro avg': {'precision': 0.345369185303437, 'recall': 0.33403958593469985, 'f1-score': 0.1737065088351393, 'support': 203432}, 'weighted avg': {'precision': 0.3454003989656036, 'recall': 0.3335217664870817, 'f1-score': 0.17348296466494142, 'support': 203432}}
[[    9 66670   777]
 [   10 67061   628]
 [    7 67491   779]]
training model: results/ATVI/W0/deepVOL_L3/h10
Epoch 1/50
2538/2538 - 117s - loss: 3.1437 - accuracy10: 0.4246 - val_loss: 3.0051 - val_accuracy10: 0.5137 - 117s/epoch - 46ms/step
Epoch 2/50
2538/2538 - 115s - loss: 2.8352 - accuracy10: 0.5100 - val_loss: 2.9511 - val_accuracy10: 0.5367 - 115s/epoch - 45ms/step
Epoch 3/50
2538/2538 - 113s - loss: 2.7490 - accuracy10: 0.5490 - val_loss: 2.8699 - val_accuracy10: 0.5831 - 113s/epoch - 45ms/step
Epoch 4/50
2538/2538 - 116s - loss: 2.6964 - accuracy10: 0.5643 - val_loss: 2.7890 - val_accuracy10: 0.6025 - 116s/epoch - 46ms/step
Epoch 5/50
2538/2538 - 115s - loss: 2.6647 - accuracy10: 0.5728 - val_loss: 2.7998 - val_accuracy10: 0.5986 - 115s/epoch - 45ms/step
Epoch 6/50
2538/2538 - 114s - loss: 2.6462 - accuracy10: 0.5786 - val_loss: 2.7872 - val_accuracy10: 0.6049 - 114s/epoch - 45ms/step
Epoch 7/50
2538/2538 - 115s - loss: 2.6245 - accuracy10: 0.5834 - val_loss: 2.7931 - val_accuracy10: 0.6148 - 115s/epoch - 45ms/step
Epoch 8/50
2538/2538 - 115s - loss: 2.6111 - accuracy10: 0.5856 - val_loss: 2.7775 - val_accuracy10: 0.6054 - 115s/epoch - 45ms/step
Epoch 9/50
2538/2538 - 115s - loss: 2.5987 - accuracy10: 0.5880 - val_loss: 2.7472 - val_accuracy10: 0.6074 - 115s/epoch - 46ms/step
Epoch 10/50
2538/2538 - 111s - loss: 2.5866 - accuracy10: 0.5911 - val_loss: 2.7262 - val_accuracy10: 0.6030 - 111s/epoch - 44ms/step
Epoch 11/50
2538/2538 - 111s - loss: 2.5766 - accuracy10: 0.5932 - val_loss: 2.7175 - val_accuracy10: 0.5955 - 111s/epoch - 44ms/step
Epoch 12/50
2538/2538 - 109s - loss: 2.5686 - accuracy10: 0.5950 - val_loss: 2.7049 - val_accuracy10: 0.6071 - 109s/epoch - 43ms/step
Epoch 13/50
2538/2538 - 108s - loss: 2.5617 - accuracy10: 0.5960 - val_loss: 2.6937 - val_accuracy10: 0.6013 - 108s/epoch - 43ms/step
Epoch 14/50
2538/2538 - 108s - loss: 2.5565 - accuracy10: 0.5969 - val_loss: 2.6940 - val_accuracy10: 0.6081 - 108s/epoch - 42ms/step
Epoch 15/50
2538/2538 - 110s - loss: 2.5500 - accuracy10: 0.5977 - val_loss: 2.6900 - val_accuracy10: 0.6069 - 110s/epoch - 43ms/step
Epoch 16/50
2538/2538 - 109s - loss: 2.5444 - accuracy10: 0.5988 - val_loss: 2.7072 - val_accuracy10: 0.6019 - 109s/epoch - 43ms/step
Epoch 17/50
2538/2538 - 112s - loss: 2.5394 - accuracy10: 0.6000 - val_loss: 2.7164 - val_accuracy10: 0.6043 - 112s/epoch - 44ms/step
Epoch 18/50
2538/2538 - 111s - loss: 2.5360 - accuracy10: 0.6007 - val_loss: 2.6946 - val_accuracy10: 0.6068 - 111s/epoch - 44ms/step
Epoch 19/50
2538/2538 - 109s - loss: 2.5307 - accuracy10: 0.6011 - val_loss: 2.6973 - val_accuracy10: 0.5981 - 109s/epoch - 43ms/step
Epoch 20/50
2538/2538 - 109s - loss: 2.5274 - accuracy10: 0.6024 - val_loss: 2.6914 - val_accuracy10: 0.5973 - 109s/epoch - 43ms/step
Epoch 21/50
2538/2538 - 108s - loss: 2.5225 - accuracy10: 0.6028 - val_loss: 2.7011 - val_accuracy10: 0.5945 - 108s/epoch - 43ms/step
Epoch 22/50
2538/2538 - 112s - loss: 2.5194 - accuracy10: 0.6034 - val_loss: 2.6982 - val_accuracy10: 0.6030 - 112s/epoch - 44ms/step
Epoch 23/50
2538/2538 - 109s - loss: 2.5154 - accuracy10: 0.6031 - val_loss: 2.6992 - val_accuracy10: 0.5858 - 109s/epoch - 43ms/step
Epoch 24/50
2538/2538 - 113s - loss: 2.5117 - accuracy10: 0.6042 - val_loss: 2.6969 - val_accuracy10: 0.5900 - 113s/epoch - 44ms/step
Epoch 25/50
2538/2538 - 113s - loss: 2.5085 - accuracy10: 0.6043 - val_loss: 2.6954 - val_accuracy10: 0.5853 - 113s/epoch - 44ms/step
testing model: results/ATVI/W0/deepVOL_L3/h10
Evaluating performance on  test set...
11876/11876 - 272s - 272s/epoch - 23ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96250206
{'0': {'precision': 0.5078803828454651, 'recall': 0.4398892143130014, 'f1-score': 0.47144602073055053, 'support': 785300}, '1': {'precision': 0.7108006108102407, 'recall': 0.5310365430430632, 'f1-score': 0.6079075633811434, 'support': 1459457}, '2': {'precision': 0.4251863135360269, 'recall': 0.6786895180047322, 'f1-score': 0.5228296262147488, 'support': 795402}, 'accuracy': 0.5461230810625365, 'macro avg': {'precision': 0.5479557690639109, 'recall': 0.5498717584535989, 'f1-score': 0.5340610701088142, 'support': 3040159}, 'weighted avg': {'precision': 0.5836587612223597, 'recall': 0.5461230810625365, 'f1-score': 0.550399251867984, 'support': 3040159}}
[[345445 167292 272563]
 [227192 775025 457240]
 [107533 148038 539831]]
Evaluating performance on  train set...
2538/2538 - 50s - 50s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8610943
{'0': {'precision': 0.47166170845728855, 'recall': 0.4520725388601036, 'f1-score': 0.46165941480378375, 'support': 122748}, '1': {'precision': 0.7985553145075509, 'recall': 0.6605080487022912, 'f1-score': 0.7230011058681745, 'support': 402363}, '2': {'precision': 0.39821960244817217, 'recall': 0.6369805804969723, 'f1-score': 0.49006589780742266, 'support': 124514}, 'accuracy': 0.6166142005002886, 'macro avg': {'precision': 0.5561455418043372, 'recall': 0.583187056019789, 'f1-score': 0.558242139493127, 'support': 649625}, 'weighted avg': {'precision': 0.6600555073775619, 'recall': 0.6166142005002886, 'f1-score': 0.6289732214868032, 'support': 649625}}
[[ 55491  35725  31532]
 [ 48275 265764  88324]
 [ 13884  31317  79313]]
Evaluating performance on  val set...
795/795 - 16s - 16s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87511677
{'0': {'precision': 0.44698438616185326, 'recall': 0.4560837194772739, 'f1-score': 0.45148821028218006, 'support': 38414}, '1': {'precision': 0.7931278472424155, 'recall': 0.6493433321429989, 'f1-score': 0.7140694199009534, 'support': 126015}, '2': {'precision': 0.39544099826417317, 'recall': 0.6191318616516678, 'f1-score': 0.4826269873787086, 'support': 39003}, 'accuracy': 0.6070578866648315, 'macro avg': {'precision': 0.5451844105561473, 'recall': 0.5748529710906468, 'f1-score': 0.549394872520614, 'support': 203432}, 'weighted avg': {'precision': 0.651519176607279, 'recall': 0.6070578866648315, 'f1-score': 0.6201129932721011, 'support': 203432}}
[[17520 10979  9915]
 [17185 81827 27003]
 [ 4491 10364 24148]]
training model: results/ATVI/W0/deepVOL_L3/h20
Epoch 1/50
2538/2538 - 116s - loss: 3.2172 - accuracy20: 0.4274 - val_loss: 3.2228 - val_accuracy20: 0.5199 - 116s/epoch - 46ms/step
Epoch 2/50
2538/2538 - 109s - loss: 3.1016 - accuracy20: 0.4869 - val_loss: 3.2178 - val_accuracy20: 0.5307 - 109s/epoch - 43ms/step
Epoch 3/50
2538/2538 - 113s - loss: 3.0576 - accuracy20: 0.5048 - val_loss: 3.1131 - val_accuracy20: 0.5413 - 113s/epoch - 45ms/step
Epoch 4/50
2538/2538 - 111s - loss: 2.8831 - accuracy20: 0.5388 - val_loss: 2.9646 - val_accuracy20: 0.5543 - 111s/epoch - 44ms/step
Epoch 5/50
2538/2538 - 110s - loss: 2.8346 - accuracy20: 0.5471 - val_loss: 2.9423 - val_accuracy20: 0.5641 - 110s/epoch - 43ms/step
Epoch 6/50
2538/2538 - 113s - loss: 2.8065 - accuracy20: 0.5518 - val_loss: 2.9869 - val_accuracy20: 0.5641 - 113s/epoch - 44ms/step
Epoch 7/50
2538/2538 - 113s - loss: 2.7849 - accuracy20: 0.5561 - val_loss: 2.9690 - val_accuracy20: 0.5672 - 113s/epoch - 44ms/step
Epoch 8/50
2538/2538 - 114s - loss: 2.7669 - accuracy20: 0.5608 - val_loss: 2.9446 - val_accuracy20: 0.5711 - 114s/epoch - 45ms/step
Epoch 9/50
2538/2538 - 113s - loss: 2.7480 - accuracy20: 0.5655 - val_loss: 2.9142 - val_accuracy20: 0.5710 - 113s/epoch - 45ms/step
Epoch 10/50
2538/2538 - 115s - loss: 2.7325 - accuracy20: 0.5691 - val_loss: 2.9157 - val_accuracy20: 0.5728 - 115s/epoch - 45ms/step
Epoch 11/50
2538/2538 - 112s - loss: 2.7180 - accuracy20: 0.5716 - val_loss: 2.8913 - val_accuracy20: 0.5712 - 112s/epoch - 44ms/step
Epoch 12/50
2538/2538 - 113s - loss: 2.7087 - accuracy20: 0.5736 - val_loss: 2.8824 - val_accuracy20: 0.5728 - 113s/epoch - 45ms/step
Epoch 13/50
2538/2538 - 109s - loss: 2.6996 - accuracy20: 0.5755 - val_loss: 2.8743 - val_accuracy20: 0.5717 - 109s/epoch - 43ms/step
Epoch 14/50
2538/2538 - 113s - loss: 2.6930 - accuracy20: 0.5771 - val_loss: 2.8603 - val_accuracy20: 0.5738 - 113s/epoch - 44ms/step
Epoch 15/50
2538/2538 - 108s - loss: 2.6829 - accuracy20: 0.5796 - val_loss: 2.8583 - val_accuracy20: 0.5737 - 108s/epoch - 43ms/step
Epoch 16/50
2538/2538 - 115s - loss: 2.6769 - accuracy20: 0.5807 - val_loss: 2.8417 - val_accuracy20: 0.5751 - 115s/epoch - 45ms/step
Epoch 17/50
2538/2538 - 114s - loss: 2.6711 - accuracy20: 0.5816 - val_loss: 2.8278 - val_accuracy20: 0.5746 - 114s/epoch - 45ms/step
Epoch 18/50
2538/2538 - 115s - loss: 2.6653 - accuracy20: 0.5833 - val_loss: 2.8277 - val_accuracy20: 0.5690 - 115s/epoch - 45ms/step
Epoch 19/50
2538/2538 - 111s - loss: 2.6595 - accuracy20: 0.5840 - val_loss: 2.8174 - val_accuracy20: 0.5724 - 111s/epoch - 44ms/step
Epoch 20/50
2538/2538 - 111s - loss: 2.6559 - accuracy20: 0.5847 - val_loss: 2.8060 - val_accuracy20: 0.5684 - 111s/epoch - 44ms/step
Epoch 21/50
2538/2538 - 111s - loss: 2.6507 - accuracy20: 0.5859 - val_loss: 2.8010 - val_accuracy20: 0.5716 - 111s/epoch - 44ms/step
Epoch 22/50
2538/2538 - 113s - loss: 2.6470 - accuracy20: 0.5865 - val_loss: 2.8034 - val_accuracy20: 0.5698 - 113s/epoch - 44ms/step
Epoch 23/50
2538/2538 - 114s - loss: 2.6426 - accuracy20: 0.5876 - val_loss: 2.7959 - val_accuracy20: 0.5701 - 114s/epoch - 45ms/step
Epoch 24/50
2538/2538 - 117s - loss: 2.6384 - accuracy20: 0.5882 - val_loss: 2.7890 - val_accuracy20: 0.5683 - 117s/epoch - 46ms/step
Epoch 25/50
2538/2538 - 115s - loss: 2.6346 - accuracy20: 0.5887 - val_loss: 2.7769 - val_accuracy20: 0.5716 - 115s/epoch - 45ms/step
Epoch 26/50
2538/2538 - 115s - loss: 2.6322 - accuracy20: 0.5897 - val_loss: 2.7744 - val_accuracy20: 0.5702 - 115s/epoch - 45ms/step
Epoch 27/50
2538/2538 - 114s - loss: 2.6286 - accuracy20: 0.5906 - val_loss: 2.7819 - val_accuracy20: 0.5726 - 114s/epoch - 45ms/step
Epoch 28/50
2538/2538 - 112s - loss: 2.6248 - accuracy20: 0.5908 - val_loss: 2.7692 - val_accuracy20: 0.5642 - 112s/epoch - 44ms/step
Epoch 29/50
2538/2538 - 111s - loss: 2.6225 - accuracy20: 0.5916 - val_loss: 2.7769 - val_accuracy20: 0.5717 - 111s/epoch - 44ms/step
Epoch 30/50
2538/2538 - 113s - loss: 2.6190 - accuracy20: 0.5919 - val_loss: 2.7706 - val_accuracy20: 0.5672 - 113s/epoch - 44ms/step
Epoch 31/50
2538/2538 - 115s - loss: 2.6157 - accuracy20: 0.5926 - val_loss: 2.7714 - val_accuracy20: 0.5630 - 115s/epoch - 45ms/step
Epoch 32/50
2538/2538 - 113s - loss: 2.6135 - accuracy20: 0.5933 - val_loss: 2.7815 - val_accuracy20: 0.5636 - 113s/epoch - 45ms/step
Epoch 33/50
2538/2538 - 115s - loss: 2.6120 - accuracy20: 0.5935 - val_loss: 2.7728 - val_accuracy20: 0.5630 - 115s/epoch - 45ms/step
Epoch 34/50
2538/2538 - 114s - loss: 2.6097 - accuracy20: 0.5940 - val_loss: 2.7631 - val_accuracy20: 0.5643 - 114s/epoch - 45ms/step
Epoch 35/50
2538/2538 - 115s - loss: 2.6065 - accuracy20: 0.5952 - val_loss: 2.7647 - val_accuracy20: 0.5650 - 115s/epoch - 45ms/step
Epoch 36/50
2538/2538 - 116s - loss: 2.6038 - accuracy20: 0.5950 - val_loss: 2.7602 - val_accuracy20: 0.5615 - 116s/epoch - 46ms/step
Epoch 37/50
2538/2538 - 115s - loss: 2.6007 - accuracy20: 0.5954 - val_loss: 2.7708 - val_accuracy20: 0.5602 - 115s/epoch - 45ms/step
Epoch 38/50
2538/2538 - 116s - loss: 2.5989 - accuracy20: 0.5960 - val_loss: 2.7791 - val_accuracy20: 0.5691 - 116s/epoch - 46ms/step
Epoch 39/50
2538/2538 - 115s - loss: 2.5958 - accuracy20: 0.5963 - val_loss: 2.7685 - val_accuracy20: 0.5677 - 115s/epoch - 45ms/step
Epoch 40/50
2538/2538 - 116s - loss: 2.5939 - accuracy20: 0.5967 - val_loss: 2.7733 - val_accuracy20: 0.5702 - 116s/epoch - 46ms/step
Epoch 41/50
2538/2538 - 108s - loss: 2.5917 - accuracy20: 0.5976 - val_loss: 2.7770 - val_accuracy20: 0.5674 - 108s/epoch - 43ms/step
Epoch 42/50
2538/2538 - 115s - loss: 2.5900 - accuracy20: 0.5975 - val_loss: 2.7703 - val_accuracy20: 0.5706 - 115s/epoch - 45ms/step
Epoch 43/50
2538/2538 - 112s - loss: 2.5871 - accuracy20: 0.5978 - val_loss: 2.7708 - val_accuracy20: 0.5661 - 112s/epoch - 44ms/step
Epoch 44/50
2538/2538 - 117s - loss: 2.5846 - accuracy20: 0.5986 - val_loss: 2.7779 - val_accuracy20: 0.5590 - 117s/epoch - 46ms/step
Epoch 45/50
2538/2538 - 115s - loss: 2.5826 - accuracy20: 0.5986 - val_loss: 2.7685 - val_accuracy20: 0.5617 - 115s/epoch - 45ms/step
Epoch 46/50
2538/2538 - 111s - loss: 2.5803 - accuracy20: 0.5993 - val_loss: 2.7696 - val_accuracy20: 0.5605 - 111s/epoch - 44ms/step
testing model: results/ATVI/W0/deepVOL_L3/h20
Evaluating performance on  test set...
11876/11876 - 243s - 243s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9663571
{'0': {'precision': 0.5323316795574524, 'recall': 0.45082719182899605, 'f1-score': 0.48820104908999384, 'support': 981030}, '1': {'precision': 0.6256176774427608, 'recall': 0.4561568896718239, 'f1-score': 0.5276142045513109, 'support': 1066074}, '2': {'precision': 0.4731666883143183, 'recall': 0.6823257523500712, 'f1-score': 0.5588159735695426, 'support': 993055}, 'accuracy': 0.5283141440957528, 'macro avg': {'precision': 0.5437053484381772, 'recall': 0.5297699446169637, 'f1-score': 0.5248770757369491, 'support': 3040159}, 'weighted avg': {'precision': 0.5457177184227328, 'recall': 0.5283141440957528, 'f1-score': 0.5250878843260149, 'support': 3040159}}
[[442275 157725 381030]
 [206368 486297 373409]
 [182183 133285 677587]]
Evaluating performance on  train set...
2538/2538 - 49s - 49s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9050162
{'0': {'precision': 0.5045369629036562, 'recall': 0.4690921497472163, 'f1-score': 0.4861693749296816, 'support': 161205}, '1': {'precision': 0.7326316362688697, 'recall': 0.5795262944137447, 'f1-score': 0.6471466389968785, 'support': 325012}, '2': {'precision': 0.4396424538643501, 'recall': 0.6528505336336042, 'f1-score': 0.5254419275874128, 'support': 163408}, 'accuracy': 0.5705660958245141, 'macro avg': {'precision': 0.5589370176789586, 'recall': 0.5671563259315217, 'f1-score': 0.552919313837991, 'support': 649625}, 'weighted avg': {'precision': 0.6023306501027016, 'recall': 0.5705660958245141, 'f1-score': 0.5765861412698045, 'support': 649625}}
[[ 75620  37913  47672]
 [ 48358 188353  88301]
 [ 25902  30825 106681]]
Evaluating performance on  val set...
795/795 - 16s - 16s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9242607
{'0': {'precision': 0.47693333602764365, 'recall': 0.4691500357795977, 'f1-score': 0.4730096698231374, 'support': 50308}, '1': {'precision': 0.7232572302109096, 'recall': 0.5720492681536239, 'f1-score': 0.6388275975629837, 'support': 101729}, '2': {'precision': 0.440857873822873, 'recall': 0.63033369004767, 'f1-score': 0.5188382354118788, 'support': 51395}, 'accuracy': 0.5613276180738527, 'macro avg': {'precision': 0.547016146687142, 'recall': 0.5571776646602972, 'f1-score': 0.5435585009326667, 'support': 203432}, 'weighted avg': {'precision': 0.5909969300116544, 'recall': 0.5613276180738527, 'f1-score': 0.5675073452108846, 'support': 203432}}
[[23602 11890 14816]
 [17263 58194 26272]
 [ 8622 10377 32396]]
training model: results/ATVI/W0/deepVOL_L3/h30
Epoch 1/50
2538/2538 - 113s - loss: 3.2778 - accuracy30: 0.3878 - val_loss: 3.3126 - val_accuracy30: 0.4227 - 113s/epoch - 45ms/step
Epoch 2/50
2538/2538 - 111s - loss: 3.2971 - accuracy30: 0.3565 - val_loss: 3.3178 - val_accuracy30: 0.4228 - 111s/epoch - 44ms/step
Epoch 3/50
2538/2538 - 112s - loss: 3.2669 - accuracy30: 0.3815 - val_loss: 3.2392 - val_accuracy30: 0.4433 - 112s/epoch - 44ms/step
Epoch 4/50
2538/2538 - 113s - loss: 3.1573 - accuracy30: 0.4394 - val_loss: 3.1752 - val_accuracy30: 0.4721 - 113s/epoch - 44ms/step
Epoch 5/50
2538/2538 - 113s - loss: 3.0574 - accuracy30: 0.4741 - val_loss: 3.0383 - val_accuracy30: 0.5010 - 113s/epoch - 45ms/step
Epoch 6/50
2538/2538 - 115s - loss: 2.9270 - accuracy30: 0.5208 - val_loss: 3.0300 - val_accuracy30: 0.5107 - 115s/epoch - 45ms/step
Epoch 7/50
2538/2538 - 111s - loss: 2.8830 - accuracy30: 0.5343 - val_loss: 3.0855 - val_accuracy30: 0.5300 - 111s/epoch - 44ms/step
Epoch 8/50
2538/2538 - 110s - loss: 2.8463 - accuracy30: 0.5421 - val_loss: 3.0454 - val_accuracy30: 0.5321 - 110s/epoch - 43ms/step
Epoch 9/50
2538/2538 - 114s - loss: 2.8244 - accuracy30: 0.5477 - val_loss: 2.9946 - val_accuracy30: 0.5384 - 114s/epoch - 45ms/step
Epoch 10/50
2538/2538 - 114s - loss: 2.8075 - accuracy30: 0.5511 - val_loss: 2.9768 - val_accuracy30: 0.5385 - 114s/epoch - 45ms/step
Epoch 11/50
2538/2538 - 109s - loss: 2.7960 - accuracy30: 0.5536 - val_loss: 2.9539 - val_accuracy30: 0.5412 - 109s/epoch - 43ms/step
Epoch 12/50
2538/2538 - 112s - loss: 2.7852 - accuracy30: 0.5556 - val_loss: 2.9454 - val_accuracy30: 0.5418 - 112s/epoch - 44ms/step
Epoch 13/50
2538/2538 - 113s - loss: 2.7754 - accuracy30: 0.5583 - val_loss: 2.9355 - val_accuracy30: 0.5423 - 113s/epoch - 45ms/step
Epoch 14/50
2538/2538 - 113s - loss: 2.7663 - accuracy30: 0.5603 - val_loss: 2.9153 - val_accuracy30: 0.5424 - 113s/epoch - 44ms/step
Epoch 15/50
2538/2538 - 112s - loss: 2.7594 - accuracy30: 0.5616 - val_loss: 2.9123 - val_accuracy30: 0.5439 - 112s/epoch - 44ms/step
Epoch 16/50
2538/2538 - 110s - loss: 2.7529 - accuracy30: 0.5629 - val_loss: 2.8944 - val_accuracy30: 0.5447 - 110s/epoch - 43ms/step
Epoch 17/50
2538/2538 - 110s - loss: 2.7458 - accuracy30: 0.5640 - val_loss: 2.8871 - val_accuracy30: 0.5449 - 110s/epoch - 43ms/step
Epoch 18/50
2538/2538 - 110s - loss: 2.7410 - accuracy30: 0.5652 - val_loss: 2.8858 - val_accuracy30: 0.5457 - 110s/epoch - 43ms/step
Epoch 19/50
2538/2538 - 114s - loss: 2.7351 - accuracy30: 0.5667 - val_loss: 2.8877 - val_accuracy30: 0.5432 - 114s/epoch - 45ms/step
Epoch 20/50
2538/2538 - 110s - loss: 2.7309 - accuracy30: 0.5666 - val_loss: 2.8909 - val_accuracy30: 0.5443 - 110s/epoch - 43ms/step
Epoch 21/50
2538/2538 - 113s - loss: 2.7264 - accuracy30: 0.5674 - val_loss: 2.8753 - val_accuracy30: 0.5439 - 113s/epoch - 45ms/step
Epoch 22/50
2538/2538 - 113s - loss: 2.7228 - accuracy30: 0.5685 - val_loss: 2.8845 - val_accuracy30: 0.5424 - 113s/epoch - 44ms/step
Epoch 23/50
2538/2538 - 109s - loss: 2.7187 - accuracy30: 0.5695 - val_loss: 2.8728 - val_accuracy30: 0.5424 - 109s/epoch - 43ms/step
Epoch 24/50
2538/2538 - 113s - loss: 2.7149 - accuracy30: 0.5706 - val_loss: 2.8751 - val_accuracy30: 0.5443 - 113s/epoch - 45ms/step
Epoch 25/50
2538/2538 - 110s - loss: 2.7113 - accuracy30: 0.5713 - val_loss: 2.8791 - val_accuracy30: 0.5412 - 110s/epoch - 43ms/step
Epoch 26/50
2538/2538 - 110s - loss: 2.7084 - accuracy30: 0.5711 - val_loss: 2.8638 - val_accuracy30: 0.5405 - 110s/epoch - 43ms/step
Epoch 27/50
2538/2538 - 114s - loss: 2.7051 - accuracy30: 0.5720 - val_loss: 2.8774 - val_accuracy30: 0.5421 - 114s/epoch - 45ms/step
Epoch 28/50
2538/2538 - 114s - loss: 2.7021 - accuracy30: 0.5730 - val_loss: 2.8764 - val_accuracy30: 0.5417 - 114s/epoch - 45ms/step
Epoch 29/50
2538/2538 - 111s - loss: 2.7001 - accuracy30: 0.5735 - val_loss: 2.8811 - val_accuracy30: 0.5434 - 111s/epoch - 44ms/step
Epoch 30/50
2538/2538 - 113s - loss: 2.6965 - accuracy30: 0.5740 - val_loss: 2.8725 - val_accuracy30: 0.5390 - 113s/epoch - 45ms/step
Epoch 31/50
2538/2538 - 109s - loss: 2.6943 - accuracy30: 0.5742 - val_loss: 2.8803 - val_accuracy30: 0.5436 - 109s/epoch - 43ms/step
Epoch 32/50
2538/2538 - 108s - loss: 2.6912 - accuracy30: 0.5751 - val_loss: 2.8894 - val_accuracy30: 0.5391 - 108s/epoch - 42ms/step
Epoch 33/50
2538/2538 - 111s - loss: 2.6883 - accuracy30: 0.5756 - val_loss: 2.8852 - val_accuracy30: 0.5390 - 111s/epoch - 44ms/step
Epoch 34/50
2538/2538 - 108s - loss: 2.6867 - accuracy30: 0.5757 - val_loss: 2.8804 - val_accuracy30: 0.5373 - 108s/epoch - 42ms/step
Epoch 35/50
2538/2538 - 108s - loss: 2.6841 - accuracy30: 0.5764 - val_loss: 2.8830 - val_accuracy30: 0.5353 - 108s/epoch - 43ms/step
Epoch 36/50
2538/2538 - 110s - loss: 2.6814 - accuracy30: 0.5771 - val_loss: 2.8871 - val_accuracy30: 0.5362 - 110s/epoch - 43ms/step
testing model: results/ATVI/W0/deepVOL_L3/h30
Evaluating performance on  test set...
11876/11876 - 246s - 246s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9861342
{'0': {'precision': 0.5353412794196651, 'recall': 0.4571731187560796, 'f1-score': 0.49317902644233746, 'support': 1087658}, '1': {'precision': 0.4777209759503206, 'recall': 0.4915967826365412, 'f1-score': 0.4845595630426516, 'support': 846283}, '2': {'precision': 0.5063380122729456, 'recall': 0.567779587748527, 'f1-score': 0.5353015123558063, 'support': 1106218}, 'accuracy': 0.5070017719467962, 'macro avg': {'precision': 0.5064667558809771, 'recall': 0.5055164963803825, 'f1-score': 0.5043467006135984, 'support': 3040159}, 'weighted avg': {'precision': 0.508748256009555, 'recall': 0.5070017719467962, 'f1-score': 0.5061066880475198, 'support': 3040159}}
[[497248 229419 360991]
 [178880 416030 251373]
 [252715 225415 628088]]
Evaluating performance on  train set...
2538/2538 - 49s - 49s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93254244
{'0': {'precision': 0.5285594661118018, 'recall': 0.4474974622833542, 'f1-score': 0.48466234472569053, 'support': 186191}, '1': {'precision': 0.6229537237888648, 'recall': 0.6254115050832447, 'f1-score': 0.6241801949963142, 'support': 275513}, '2': {'precision': 0.4792352441396729, 'recall': 0.549284007641509, 'f1-score': 0.5118742406585506, 'support': 187921}, 'accuracy': 0.5523971522031942, 'macro avg': {'precision': 0.5435828113467799, 'recall': 0.5407309916693692, 'f1-score': 0.5402389267935185, 'support': 649625}, 'weighted avg': {'precision': 0.5543247737864698, 'recall': 0.5523971522031942, 'f1-score': 0.5517051281425992, 'support': 649625}}
[[ 83320  52931  49940]
 [ 40977 172309  62227]
 [ 33339  51360 103222]]
Evaluating performance on  val set...
795/795 - 18s - 18s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9495266
{'0': {'precision': 0.5010547921774331, 'recall': 0.45443419805222784, 'f1-score': 0.47660712994431986, 'support': 58015}, '1': {'precision': 0.6123957786717975, 'recall': 0.6105162812866924, 'f1-score': 0.6114545856765284, 'support': 86019}, '2': {'precision': 0.47881955118352293, 'recall': 0.5244621031011145, 'f1-score': 0.500602612929663, 'support': 59398}, 'accuracy': 0.5408785245192497, 'macro avg': {'precision': 0.5307567073442512, 'recall': 0.5298041941466782, 'f1-score': 0.5295547761835038, 'support': 203432}, 'weighted avg': {'precision': 0.5416418751963409, 'recall': 0.5408785245192497, 'f1-score': 0.5406320964834694, 'support': 203432}}
[[26364 16437 15214]
 [14809 52516 18694]
 [11444 16802 31152]]
training model: results/ATVI/W0/deepVOL_L3/h50
Epoch 1/50
2538/2538 - 116s - loss: 3.2607 - accuracy50: 0.3884 - val_loss: 3.3088 - val_accuracy50: 0.3277 - 116s/epoch - 46ms/step
Epoch 2/50
2538/2538 - 109s - loss: 3.2922 - accuracy50: 0.3522 - val_loss: 3.3026 - val_accuracy50: 0.3277 - 109s/epoch - 43ms/step
Epoch 3/50
2538/2538 - 115s - loss: 3.2213 - accuracy50: 0.4097 - val_loss: 3.2494 - val_accuracy50: 0.3742 - 115s/epoch - 45ms/step
Epoch 4/50
2538/2538 - 111s - loss: 3.1446 - accuracy50: 0.4476 - val_loss: 3.1410 - val_accuracy50: 0.4513 - 111s/epoch - 44ms/step
Epoch 5/50
2538/2538 - 112s - loss: 3.0283 - accuracy50: 0.4875 - val_loss: 3.1350 - val_accuracy50: 0.4645 - 112s/epoch - 44ms/step
Epoch 6/50
2538/2538 - 112s - loss: 2.9653 - accuracy50: 0.5006 - val_loss: 3.1371 - val_accuracy50: 0.4615 - 112s/epoch - 44ms/step
Epoch 7/50
2538/2538 - 113s - loss: 2.9348 - accuracy50: 0.5063 - val_loss: 3.1230 - val_accuracy50: 0.4676 - 113s/epoch - 45ms/step
Epoch 8/50
2538/2538 - 111s - loss: 2.9178 - accuracy50: 0.5110 - val_loss: 3.0849 - val_accuracy50: 0.4733 - 111s/epoch - 44ms/step
Epoch 9/50
2538/2538 - 111s - loss: 2.9045 - accuracy50: 0.5142 - val_loss: 3.0550 - val_accuracy50: 0.4807 - 111s/epoch - 44ms/step
Epoch 10/50
2538/2538 - 110s - loss: 2.8952 - accuracy50: 0.5167 - val_loss: 3.0436 - val_accuracy50: 0.4863 - 110s/epoch - 44ms/step
Epoch 11/50
2538/2538 - 113s - loss: 2.8881 - accuracy50: 0.5184 - val_loss: 3.0371 - val_accuracy50: 0.4875 - 113s/epoch - 45ms/step
Epoch 12/50
2538/2538 - 112s - loss: 2.8818 - accuracy50: 0.5200 - val_loss: 3.0303 - val_accuracy50: 0.4868 - 112s/epoch - 44ms/step
Epoch 13/50
2538/2538 - 112s - loss: 2.8769 - accuracy50: 0.5211 - val_loss: 3.0231 - val_accuracy50: 0.4857 - 112s/epoch - 44ms/step
Epoch 14/50
2538/2538 - 114s - loss: 2.8726 - accuracy50: 0.5224 - val_loss: 3.0328 - val_accuracy50: 0.4908 - 114s/epoch - 45ms/step
Epoch 15/50
2538/2538 - 114s - loss: 2.8683 - accuracy50: 0.5234 - val_loss: 3.0357 - val_accuracy50: 0.4880 - 114s/epoch - 45ms/step
Epoch 16/50
2538/2538 - 115s - loss: 2.8637 - accuracy50: 0.5244 - val_loss: 3.0261 - val_accuracy50: 0.4884 - 115s/epoch - 45ms/step
Epoch 17/50
2538/2538 - 114s - loss: 2.8601 - accuracy50: 0.5249 - val_loss: 3.0111 - val_accuracy50: 0.4919 - 114s/epoch - 45ms/step
Epoch 18/50
2538/2538 - 111s - loss: 2.8573 - accuracy50: 0.5259 - val_loss: 3.0121 - val_accuracy50: 0.4927 - 111s/epoch - 44ms/step
Epoch 19/50
2538/2538 - 110s - loss: 2.8534 - accuracy50: 0.5267 - val_loss: 3.0106 - val_accuracy50: 0.4911 - 110s/epoch - 43ms/step
Epoch 20/50
2538/2538 - 110s - loss: 2.8504 - accuracy50: 0.5276 - val_loss: 3.0209 - val_accuracy50: 0.4927 - 110s/epoch - 43ms/step
Epoch 21/50
2538/2538 - 114s - loss: 2.8475 - accuracy50: 0.5279 - val_loss: 3.0241 - val_accuracy50: 0.4909 - 114s/epoch - 45ms/step
Epoch 22/50
2538/2538 - 110s - loss: 2.8439 - accuracy50: 0.5288 - val_loss: 3.0213 - val_accuracy50: 0.4929 - 110s/epoch - 43ms/step
Epoch 23/50
2538/2538 - 109s - loss: 2.8415 - accuracy50: 0.5293 - val_loss: 3.0460 - val_accuracy50: 0.4901 - 109s/epoch - 43ms/step
Epoch 24/50
2538/2538 - 117s - loss: 2.8390 - accuracy50: 0.5300 - val_loss: 3.0288 - val_accuracy50: 0.4916 - 117s/epoch - 46ms/step
Epoch 25/50
2538/2538 - 110s - loss: 2.8371 - accuracy50: 0.5305 - val_loss: 3.0608 - val_accuracy50: 0.4890 - 110s/epoch - 43ms/step
Epoch 26/50
2538/2538 - 124s - loss: 2.8342 - accuracy50: 0.5311 - val_loss: 3.0470 - val_accuracy50: 0.4912 - 124s/epoch - 49ms/step
Epoch 27/50
2538/2538 - 112s - loss: 2.8311 - accuracy50: 0.5316 - val_loss: 3.0344 - val_accuracy50: 0.4934 - 112s/epoch - 44ms/step
Epoch 28/50
2538/2538 - 114s - loss: 2.8292 - accuracy50: 0.5326 - val_loss: 3.0389 - val_accuracy50: 0.4932 - 114s/epoch - 45ms/step
Epoch 29/50
2538/2538 - 113s - loss: 2.8264 - accuracy50: 0.5332 - val_loss: 3.0273 - val_accuracy50: 0.4937 - 113s/epoch - 44ms/step
testing model: results/ATVI/W0/deepVOL_L3/h50
Evaluating performance on  test set...
11876/11876 - 240s - 240s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0063635
{'0': {'precision': 0.5053628213650492, 'recall': 0.4923485844881303, 'f1-score': 0.49877082349126656, 'support': 1199778}, '1': {'precision': 0.3761437936873182, 'recall': 0.3559539578560558, 'f1-score': 0.36577047751815195, 'support': 608486}, '2': {'precision': 0.5054131643525469, 'recall': 0.5314892908892398, 'f1-score': 0.5181233451032465, 'support': 1231895}, 'accuracy': 0.48090938664721156, 'macro avg': {'precision': 0.4623065931349714, 'recall': 0.4599306110778086, 'f1-score': 0.46088821537088837, 'support': 3040159}, 'weighted avg': {'precision': 0.4795201098486686, 'recall': 0.48090938664721156, 'f1-score': 0.47999266948399044, 'support': 3040159}}
[[590709 178723 430346]
 [181525 216593 210368]
 [396647 180509 654739]]
Evaluating performance on  train set...
2538/2538 - 54s - 54s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9920882
{'0': {'precision': 0.4813035978008613, 'recall': 0.5346046041446492, 'f1-score': 0.5065558460557165, 'support': 217630}, '1': {'precision': 0.5226800289877184, 'recall': 0.5135930289756623, 'f1-score': 0.5180966873740249, 'support': 213455}, '2': {'precision': 0.48812011102699976, 'recall': 0.44257801775418687, 'f1-score': 0.46423480285104035, 'support': 218540}, 'accuracy': 0.49674196651914565, 'macro avg': {'precision': 0.4973679126051931, 'recall': 0.4969252169581661, 'f1-score': 0.4962957787602606, 'support': 649625}, 'weighted avg': {'precision': 0.49719228268742033, 'recall': 0.49674196651914565, 'f1-score': 0.4961107577380711, 'support': 649625}}
[[116346  48967  52317]
 [ 54714 109629  49112]
 [ 70671  51148  96721]]
Evaluating performance on  val set...
795/795 - 17s - 17s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.002539
{'0': {'precision': 0.46598413504747765, 'recall': 0.5305659369994661, 'f1-score': 0.49618241204984703, 'support': 67428}, '1': {'precision': 0.5190302593876112, 'recall': 0.519069195222949, 'f1-score': 0.5190497265750998, 'support': 66652}, '2': {'precision': 0.4914502849905003, 'recall': 0.42519321721075093, 'f1-score': 0.4559271456622911, 'support': 69352}, 'accuracy': 0.49087655826025406, 'macro avg': {'precision': 0.49215489314186306, 'recall': 0.4916094498110553, 'f1-score': 0.49038642809574595, 'support': 203432}, 'weighted avg': {'precision': 0.4920457119398401, 'recall': 0.49087655826025406, 'f1-score': 0.48995118497262896, 'support': 203432}}
[[35775 14989 16664]
 [18205 34597 13850]
 [22793 17071 29488]]
training model: results/ATVI/W0/deepVOL_L3/h100
Epoch 1/50
2538/2538 - 118s - loss: 3.2909 - accuracy100: 0.3679 - val_loss: 3.3070 - val_accuracy100: 0.3216 - 118s/epoch - 46ms/step
Epoch 2/50
2538/2538 - 114s - loss: 3.2887 - accuracy100: 0.3600 - val_loss: 3.3027 - val_accuracy100: 0.3295 - 114s/epoch - 45ms/step
Epoch 3/50
2538/2538 - 112s - loss: 3.2582 - accuracy100: 0.3894 - val_loss: 3.2778 - val_accuracy100: 0.3730 - 112s/epoch - 44ms/step
Epoch 4/50
2538/2538 - 111s - loss: 3.2269 - accuracy100: 0.4070 - val_loss: 3.2657 - val_accuracy100: 0.3644 - 111s/epoch - 44ms/step
Epoch 5/50
2538/2538 - 116s - loss: 3.1973 - accuracy100: 0.4253 - val_loss: 3.2795 - val_accuracy100: 0.3815 - 116s/epoch - 46ms/step
Epoch 6/50
2538/2538 - 112s - loss: 3.1751 - accuracy100: 0.4350 - val_loss: 3.2446 - val_accuracy100: 0.4105 - 112s/epoch - 44ms/step
Epoch 7/50
2538/2538 - 113s - loss: 3.1602 - accuracy100: 0.4406 - val_loss: 3.2261 - val_accuracy100: 0.4113 - 113s/epoch - 44ms/step
Epoch 8/50
2538/2538 - 112s - loss: 3.1487 - accuracy100: 0.4439 - val_loss: 3.2562 - val_accuracy100: 0.4083 - 112s/epoch - 44ms/step
Epoch 9/50
2538/2538 - 114s - loss: 3.1420 - accuracy100: 0.4462 - val_loss: 3.2325 - val_accuracy100: 0.4078 - 114s/epoch - 45ms/step
Epoch 10/50
2538/2538 - 111s - loss: 3.1351 - accuracy100: 0.4491 - val_loss: 3.2384 - val_accuracy100: 0.4049 - 111s/epoch - 44ms/step
Epoch 11/50
2538/2538 - 112s - loss: 3.1299 - accuracy100: 0.4510 - val_loss: 3.2414 - val_accuracy100: 0.4048 - 112s/epoch - 44ms/step
Epoch 12/50
2538/2538 - 109s - loss: 3.1250 - accuracy100: 0.4530 - val_loss: 3.2284 - val_accuracy100: 0.4055 - 109s/epoch - 43ms/step
Epoch 13/50
2538/2538 - 113s - loss: 3.1209 - accuracy100: 0.4542 - val_loss: 3.2217 - val_accuracy100: 0.4078 - 113s/epoch - 44ms/step
Epoch 14/50
2538/2538 - 114s - loss: 3.1174 - accuracy100: 0.4553 - val_loss: 3.2199 - val_accuracy100: 0.4115 - 114s/epoch - 45ms/step
Epoch 15/50
2538/2538 - 114s - loss: 3.1140 - accuracy100: 0.4572 - val_loss: 3.2113 - val_accuracy100: 0.4102 - 114s/epoch - 45ms/step
Epoch 16/50
2538/2538 - 116s - loss: 3.1115 - accuracy100: 0.4575 - val_loss: 3.2073 - val_accuracy100: 0.4103 - 116s/epoch - 46ms/step
Epoch 17/50
2538/2538 - 114s - loss: 3.1089 - accuracy100: 0.4584 - val_loss: 3.2211 - val_accuracy100: 0.4089 - 114s/epoch - 45ms/step
Epoch 18/50
2538/2538 - 115s - loss: 3.1047 - accuracy100: 0.4604 - val_loss: 3.2171 - val_accuracy100: 0.4113 - 115s/epoch - 45ms/step
Epoch 19/50
2538/2538 - 113s - loss: 3.1020 - accuracy100: 0.4617 - val_loss: 3.2209 - val_accuracy100: 0.4088 - 113s/epoch - 45ms/step
Epoch 20/50
2538/2538 - 114s - loss: 3.0991 - accuracy100: 0.4625 - val_loss: 3.2243 - val_accuracy100: 0.4093 - 114s/epoch - 45ms/step
Epoch 21/50
2538/2538 - 111s - loss: 3.0968 - accuracy100: 0.4628 - val_loss: 3.2256 - val_accuracy100: 0.4104 - 111s/epoch - 44ms/step
Epoch 22/50
2538/2538 - 112s - loss: 3.0932 - accuracy100: 0.4644 - val_loss: 3.2332 - val_accuracy100: 0.4073 - 112s/epoch - 44ms/step
Epoch 23/50
2538/2538 - 113s - loss: 3.0912 - accuracy100: 0.4653 - val_loss: 3.2395 - val_accuracy100: 0.4081 - 113s/epoch - 44ms/step
Epoch 24/50
2538/2538 - 113s - loss: 3.0876 - accuracy100: 0.4665 - val_loss: 3.2402 - val_accuracy100: 0.4080 - 113s/epoch - 44ms/step
Epoch 25/50
2538/2538 - 114s - loss: 3.0850 - accuracy100: 0.4677 - val_loss: 3.2445 - val_accuracy100: 0.4033 - 114s/epoch - 45ms/step
Epoch 26/50
2538/2538 - 115s - loss: 3.0811 - accuracy100: 0.4688 - val_loss: 3.2495 - val_accuracy100: 0.4052 - 115s/epoch - 45ms/step
testing model: results/ATVI/W0/deepVOL_L3/h100
Evaluating performance on  test set...
11876/11876 - 250s - 250s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0947666
{'0': {'precision': 0.47502298286480543, 'recall': 0.1776418505102586, 'f1-score': 0.25858283577082003, 'support': 1160588}, '1': {'precision': 0.273763468602117, 'recall': 0.5795743653282814, 'f1-score': 0.37187215251980094, 'support': 695714}, '2': {'precision': 0.4467011391813072, 'recall': 0.4276133012686498, 'f1-score': 0.43694885951439005, 'support': 1183857}, 'accuracy': 0.36696107012824003, 'macro avg': {'precision': 0.39849586354940986, 'recall': 0.3949431723690633, 'f1-score': 0.3558012826016703, 'support': 3040159}, 'weighted avg': {'precision': 0.4179377861355005, 'recall': 0.36696107012824003, 'f1-score': 0.35396496199635363, 'support': 3040159}}
[[206169 542675 411744]
 [ 77203 403218 215293]
 [150647 526977 506233]]
Evaluating performance on  train set...
2538/2538 - 51s - 51s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0652527
{'0': {'precision': 0.4864705743824035, 'recall': 0.18572096452268355, 'f1-score': 0.26881559513042574, 'support': 222452}, '1': {'precision': 0.39061591551373537, 'recall': 0.6470238751191839, 'f1-score': 0.4871398063575891, 'support': 208711}, '2': {'precision': 0.42330559944471335, 'recall': 0.4243209345332369, 'f1-score': 0.42381265887602637, 'support': 218462}, 'accuracy': 0.4141666345968828, 'macro avg': {'precision': 0.43346402978028403, 'recall': 0.4190219247250348, 'f1-score': 0.393256020121347, 'support': 649625}, 'weighted avg': {'precision': 0.43443275492967887, 'recall': 0.4141666345968828, 'f1-score': 0.39108249217013924, 'support': 649625}}
[[ 41314 109124  72014]
 [ 19396 135041  54274]
 [ 24216 101548  92698]]
Evaluating performance on  val set...
795/795 - 18s - 18s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0710886
{'0': {'precision': 0.46970926800472257, 'recall': 0.18519165030184012, 'f1-score': 0.26564700727185464, 'support': 68745}, '1': {'precision': 0.3885190235555199, 'recall': 0.666559633027523, 'f1-score': 0.490903869867063, 'support': 65400}, '2': {'precision': 0.4240623781676413, 'recall': 0.3924690057297906, 'f1-score': 0.4076544838545258, 'support': 69287}, 'accuracy': 0.4105401313461009, 'macro avg': {'precision': 0.4274302232426279, 'recall': 0.41474009635305126, 'f1-score': 0.38806845366448117, 'support': 203432}, 'weighted avg': {'precision': 0.4280610610209653, 'recall': 0.4105401313461009, 'f1-score': 0.3864297299689238, 'support': 203432}}
[[12731 34499 21515]
 [ 6390 43593 15417]
 [ 7983 34111 27193]]
training model: results/ATVI/W0/deepVOL_L3/h200
Epoch 1/50
2538/2538 - 115s - loss: 3.2940 - accuracy200: 0.3623 - val_loss: 3.3025 - val_accuracy200: 0.3435 - 115s/epoch - 45ms/step
Epoch 2/50
2538/2538 - 114s - loss: 3.2866 - accuracy200: 0.3635 - val_loss: 3.3006 - val_accuracy200: 0.3435 - 114s/epoch - 45ms/step
Epoch 3/50
2538/2538 - 115s - loss: 3.2769 - accuracy200: 0.3742 - val_loss: 3.3043 - val_accuracy200: 0.3455 - 115s/epoch - 45ms/step
Epoch 4/50
2538/2538 - 116s - loss: 3.2686 - accuracy200: 0.3814 - val_loss: 3.2955 - val_accuracy200: 0.3479 - 116s/epoch - 46ms/step
Epoch 5/50
2538/2538 - 113s - loss: 3.2516 - accuracy200: 0.3956 - val_loss: 3.3142 - val_accuracy200: 0.3518 - 113s/epoch - 45ms/step
Epoch 6/50
2538/2538 - 113s - loss: 3.2404 - accuracy200: 0.4026 - val_loss: 3.3131 - val_accuracy200: 0.3575 - 113s/epoch - 45ms/step
Epoch 7/50
2538/2538 - 115s - loss: 3.2357 - accuracy200: 0.4048 - val_loss: 3.3101 - val_accuracy200: 0.3565 - 115s/epoch - 45ms/step
Epoch 8/50
2538/2538 - 114s - loss: 3.2271 - accuracy200: 0.4097 - val_loss: 3.3072 - val_accuracy200: 0.3585 - 114s/epoch - 45ms/step
Epoch 9/50
2538/2538 - 117s - loss: 3.2210 - accuracy200: 0.4127 - val_loss: 3.3022 - val_accuracy200: 0.3595 - 117s/epoch - 46ms/step
Epoch 10/50
2538/2538 - 115s - loss: 3.2160 - accuracy200: 0.4153 - val_loss: 3.3145 - val_accuracy200: 0.3576 - 115s/epoch - 45ms/step
Epoch 11/50
2538/2538 - 112s - loss: 3.2124 - accuracy200: 0.4168 - val_loss: 3.3171 - val_accuracy200: 0.3587 - 112s/epoch - 44ms/step
Epoch 12/50
2538/2538 - 113s - loss: 3.2072 - accuracy200: 0.4191 - val_loss: 3.3257 - val_accuracy200: 0.3565 - 113s/epoch - 45ms/step
Epoch 13/50
2538/2538 - 114s - loss: 3.2026 - accuracy200: 0.4208 - val_loss: 3.3232 - val_accuracy200: 0.3597 - 114s/epoch - 45ms/step
Epoch 14/50
2538/2538 - 113s - loss: 3.1978 - accuracy200: 0.4238 - val_loss: 3.3393 - val_accuracy200: 0.3567 - 113s/epoch - 44ms/step
testing model: results/ATVI/W0/deepVOL_L3/h200
Evaluating performance on  test set...
11876/11876 - 249s - 249s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1026767
{'0': {'precision': 0.40792464360845704, 'recall': 0.30770642364497086, 'f1-score': 0.35079816666750896, 'support': 1128020}, '1': {'precision': 0.2448485361313251, 'recall': 0.38822610767645543, 'f1-score': 0.3003013786203833, 'support': 745344}, '2': {'precision': 0.40641051982740906, 'recall': 0.35091511362321576, 'f1-score': 0.3766295169307866, 'support': 1166795}, 'accuracy': 0.34403036156990474, 'macro avg': {'precision': 0.35306123318906374, 'recall': 0.34894921498154735, 'f1-score': 0.342576354072893, 'support': 3040159}, 'weighted avg': {'precision': 0.36736279460367033, 'recall': 0.34403036156990474, 'f1-score': 0.3483319839251735, 'support': 3040159}}
[[347099 430661 350260]
 [208219 289362 247763]
 [295572 461777 409446]]
Evaluating performance on  train set...
2538/2538 - 52s - 52s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0956407
{'0': {'precision': 0.3746020606393474, 'recall': 0.34085745355267116, 'f1-score': 0.35693397586391534, 'support': 216105}, '1': {'precision': 0.3525822714654506, 'recall': 0.3283336804266531, 'f1-score': 0.3400262088786679, 'support': 220882}, '2': {'precision': 0.3518051242236025, 'recall': 0.4091460604407491, 'f1-score': 0.37831514956493767, 'support': 212638}, 'accuracy': 0.3589517029055224, 'macro avg': {'precision': 0.35966315210946687, 'recall': 0.35944573147335773, 'f1-score': 0.3584251114358403, 'support': 649625}, 'weighted avg': {'precision': 0.35965302075036554, 'recall': 0.3589517029055224, 'f1-score': 0.35818366395504875, 'support': 649625}}
[[73661 64299 78145]
 [66208 72523 82151]
 [56769 68869 87000]]
Evaluating performance on  val set...
795/795 - 16s - 16s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0983312
{'0': {'precision': 0.3508091809734786, 'recall': 0.3431959786894621, 'f1-score': 0.3469608216051731, 'support': 66446}, '1': {'precision': 0.3505422795515736, 'recall': 0.3301197570479028, 'f1-score': 0.34002464053589476, 'support': 69808}, '2': {'precision': 0.34121644860841693, 'recall': 0.3691982494268957, 'f1-score': 0.3546562756944196, 'support': 67178}, 'accuracy': 0.34729541075150416, 'macro avg': {'precision': 0.347522636377823, 'recall': 0.3475046617214202, 'f1-score': 0.34721391261182916, 'support': 203432}, 'weighted avg': {'precision': 0.3475498489643529, 'recall': 0.34729541075150416, 'f1-score': 0.3471218792889359, 'support': 203432}}
[[22804 19787 23855]
 [22733 23045 24030]
 [19467 22909 24802]]
training model: results/ATVI/W0/deepVOL_L3/h300
Epoch 1/50
2538/2538 - 115s - loss: 3.2913 - accuracy300: 0.3656 - val_loss: 3.3109 - val_accuracy300: 0.3259 - 115s/epoch - 45ms/step
Epoch 2/50
2538/2538 - 111s - loss: 3.2785 - accuracy300: 0.3726 - val_loss: 3.3115 - val_accuracy300: 0.3260 - 111s/epoch - 44ms/step
Epoch 3/50
2538/2538 - 113s - loss: 3.2697 - accuracy300: 0.3817 - val_loss: 3.3126 - val_accuracy300: 0.3291 - 113s/epoch - 45ms/step
Epoch 4/50
2538/2538 - 116s - loss: 3.2595 - accuracy300: 0.3902 - val_loss: 3.3242 - val_accuracy300: 0.3343 - 116s/epoch - 46ms/step
Epoch 5/50
2538/2538 - 116s - loss: 3.2537 - accuracy300: 0.3953 - val_loss: 3.3150 - val_accuracy300: 0.3400 - 116s/epoch - 46ms/step
Epoch 6/50
2538/2538 - 111s - loss: 3.2442 - accuracy300: 0.4019 - val_loss: 3.3235 - val_accuracy300: 0.3404 - 111s/epoch - 44ms/step
Epoch 7/50
2538/2538 - 113s - loss: 3.2375 - accuracy300: 0.4046 - val_loss: 3.3401 - val_accuracy300: 0.3405 - 113s/epoch - 45ms/step
Epoch 8/50
2538/2538 - 115s - loss: 3.2310 - accuracy300: 0.4084 - val_loss: 3.3457 - val_accuracy300: 0.3409 - 115s/epoch - 45ms/step
Epoch 9/50
2538/2538 - 111s - loss: 3.2248 - accuracy300: 0.4121 - val_loss: 3.3560 - val_accuracy300: 0.3421 - 111s/epoch - 44ms/step
Epoch 10/50
2538/2538 - 111s - loss: 3.2199 - accuracy300: 0.4152 - val_loss: 3.3677 - val_accuracy300: 0.3411 - 111s/epoch - 44ms/step
Epoch 11/50
2538/2538 - 114s - loss: 3.2154 - accuracy300: 0.4176 - val_loss: 3.3851 - val_accuracy300: 0.3397 - 114s/epoch - 45ms/step
testing model: results/ATVI/W0/deepVOL_L3/h300
Evaluating performance on  test set...
11876/11876 - 248s - 248s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1185424
{'0': {'precision': 0.3642697881828317, 'recall': 0.00232239126340217, 'f1-score': 0.0046153574518424355, 'support': 1125564}, '1': {'precision': 0.24658044510790345, 'recall': 0.9363483997694131, 'f1-score': 0.39036194981814054, 'support': 749392}, '2': {'precision': 0.3981077574469676, 'recall': 0.0639905664506528, 'f1-score': 0.11025852979754439, 'support': 1165203}, 'accuracy': 0.2561931793698948, 'macro avg': {'precision': 0.3363193302459009, 'recall': 0.33422045249448934, 'f1-score': 0.1684119456891758, 'support': 3040159}, 'weighted avg': {'precision': 0.34822873609143523, 'recall': 0.2561931793698948, 'f1-score': 0.14019088218370476, 'support': 3040159}}
[[   2614 1056142   66808]
 [   1779  701692   45921]
 [   2783 1087858   74562]]
Evaluating performance on  train set...
2538/2538 - 49s - 49s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.104681
{'0': {'precision': 0.33144570286475683, 'recall': 0.008969175782323964, 'f1-score': 0.017465715852989578, 'support': 221871}, '1': {'precision': 0.32491716676376714, 'recall': 0.8671121222093451, 'f1-score': 0.47270585818824257, 'support': 209673}, '2': {'precision': 0.3384842320640472, 'recall': 0.13047445673855126, 'f1-score': 0.18834727811904256, 'support': 218081}, 'accuracy': 0.32673311525880316, 'macro avg': {'precision': 0.3316157005641904, 'recall': 0.3355185849100734, 'f1-score': 0.22617295072009158, 'support': 649625}, 'weighted avg': {'precision': 0.33170140690386807, 'recall': 0.32673311525880316, 'f1-score': 0.22176448567312054, 'support': 649625}}
[[  1990 190151  29730]
 [  1984 181810  25879]
 [  2030 187597  28454]]
Evaluating performance on  val set...
795/795 - 16s - 16s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.105396
{'0': {'precision': 0.3552295918367347, 'recall': 0.008132930337144276, 'f1-score': 0.015901791449575334, 'support': 68487}, '1': {'precision': 0.32444229711943756, 'recall': 0.8902128697030186, 'f1-score': 0.47556329773378486, 'support': 65627}, '2': {'precision': 0.33209451709107596, 'recall': 0.10441732306183098, 'f1-score': 0.15887963298321864, 'support': 69318}, 'accuracy': 0.32549942978489127, 'macro avg': {'precision': 0.33725546868241607, 'recall': 0.33425437436733124, 'f1-score': 0.21678157405552625, 'support': 203432}, 'weighted avg': {'precision': 0.33741452389446586, 'recall': 0.32549942978489127, 'f1-score': 0.21290690221063016, 'support': 203432}}
[[  557 60061  7869]
 [  517 58422  6688]
 [  494 61586  7238]]
training model: results/ATVI/W0/deepVOL_L3/h500
Epoch 1/50
2538/2538 - 115s - loss: 3.2660 - accuracy500: 0.3908 - val_loss: 3.3033 - val_accuracy500: 0.3363 - 115s/epoch - 45ms/step
Epoch 2/50
2538/2538 - 113s - loss: 3.2676 - accuracy500: 0.3833 - val_loss: 3.3031 - val_accuracy500: 0.3345 - 113s/epoch - 44ms/step
Epoch 3/50
2538/2538 - 113s - loss: 3.2621 - accuracy500: 0.3888 - val_loss: 3.3101 - val_accuracy500: 0.3263 - 113s/epoch - 45ms/step
Epoch 4/50
2538/2538 - 109s - loss: 3.2523 - accuracy500: 0.3967 - val_loss: 3.3146 - val_accuracy500: 0.3254 - 109s/epoch - 43ms/step
Epoch 5/50
2538/2538 - 111s - loss: 3.2379 - accuracy500: 0.4071 - val_loss: 3.3318 - val_accuracy500: 0.3259 - 111s/epoch - 44ms/step
Epoch 6/50
2538/2538 - 110s - loss: 3.2373 - accuracy500: 0.4091 - val_loss: 3.3411 - val_accuracy500: 0.3264 - 110s/epoch - 43ms/step
Epoch 7/50
2538/2538 - 114s - loss: 3.2317 - accuracy500: 0.4102 - val_loss: 3.3374 - val_accuracy500: 0.3252 - 114s/epoch - 45ms/step
Epoch 8/50
2538/2538 - 113s - loss: 3.2253 - accuracy500: 0.4154 - val_loss: 3.3436 - val_accuracy500: 0.3261 - 113s/epoch - 44ms/step
Epoch 9/50
2538/2538 - 111s - loss: 3.2105 - accuracy500: 0.4208 - val_loss: 3.3650 - val_accuracy500: 0.3233 - 111s/epoch - 44ms/step
Epoch 10/50
2538/2538 - 109s - loss: 3.1986 - accuracy500: 0.4269 - val_loss: 3.3803 - val_accuracy500: 0.3251 - 109s/epoch - 43ms/step
Epoch 11/50
2538/2538 - 114s - loss: 3.1874 - accuracy500: 0.4325 - val_loss: 3.4071 - val_accuracy500: 0.3221 - 114s/epoch - 45ms/step
Epoch 12/50
2538/2538 - 108s - loss: 3.1798 - accuracy500: 0.4352 - val_loss: 3.4526 - val_accuracy500: 0.3228 - 108s/epoch - 43ms/step
testing model: results/ATVI/W0/deepVOL_L3/h500
Evaluating performance on  test set...
11876/11876 - 252s - 252s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.089047
{'0': {'precision': 0.39964813412958755, 'recall': 0.14396572112475245, 'f1-score': 0.21167831272147664, 'support': 1188137}, '1': {'precision': 0.20829000577700751, 'recall': 0.09289159051567972, 'f1-score': 0.1284832151984721, 'support': 621025}, '2': {'precision': 0.4080712745616533, 'recall': 0.7741091164316404, 'f1-score': 0.53442215113488, 'support': 1230997}, 'accuracy': 0.3886852628431605, 'macro avg': {'precision': 0.33866980482274944, 'recall': 0.3369888093573575, 'f1-score': 0.29152789301827625, 'support': 3040159}, 'weighted avg': {'precision': 0.36396930251002113, 'recall': 0.3886852628431605, 'f1-score': 0.325366597254016, 'support': 3040159}}
[[171051 111078 906008]
 [ 87076  57688 476261]
 [169877 108194 952926]]
Evaluating performance on  train set...
2538/2538 - 50s - 50s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1020616
{'0': {'precision': 0.3297855770728415, 'recall': 0.14570277734450265, 'f1-score': 0.202110836411769, 'support': 217978}, '1': {'precision': 0.3571943976761827, 'recall': 0.08884982143514598, 'f1-score': 0.14230274529459677, 'support': 217288}, '2': {'precision': 0.3342713676540396, 'recall': 0.7785630647651837, 'f1-score': 0.4677269733615459, 'support': 214359}, 'accuracy': 0.3355135655185684, 'macro avg': {'precision': 0.3404171141343546, 'recall': 0.3377052211816108, 'f1-score': 0.2707135183559706, 'support': 649625}, 'weighted avg': {'precision': 0.34043353149955513, 'recall': 0.3355135655185684, 'f1-score': 0.2697523665218311, 'support': 649625}}
[[ 31760  17973 168245]
 [ 33848  19306 164134]
 [ 30697  16770 166892]]
Evaluating performance on  val set...
795/795 - 16s - 16s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1013092
{'0': {'precision': 0.30495341468770587, 'recall': 0.14157345916346264, 'f1-score': 0.19337384748510555, 'support': 68664}, '1': {'precision': 0.33916515000293546, 'recall': 0.08842933459872339, 'f1-score': 0.1402831402831403, 'support': 65329}, '2': {'precision': 0.34017162604677653, 'recall': 0.7569809473062689, 'f1-score': 0.46940315501359614, 'support': 69439}, 'accuracy': 0.33456879940225726, 'macro avg': {'precision': 0.32809673024580593, 'recall': 0.32899458035615164, 'f1-score': 0.267686714260614, 'support': 203432}, 'weighted avg': {'precision': 0.32796127891246474, 'recall': 0.33456879940225726, 'f1-score': 0.2705437926002972, 'support': 203432}}
[[ 9721  5305 53638]
 [11232  5777 48320]
 [10924  5951 52564]]
training model: results/ATVI/W0/deepVOL_L3/h1000
Epoch 1/50
2538/2538 - 118s - loss: 3.2684 - accuracy1000: 0.3891 - val_loss: 3.3376 - val_accuracy1000: 0.3317 - 118s/epoch - 47ms/step
Epoch 2/50
2538/2538 - 110s - loss: 3.2697 - accuracy1000: 0.3791 - val_loss: 3.3518 - val_accuracy1000: 0.3362 - 110s/epoch - 43ms/step
Epoch 3/50
2538/2538 - 113s - loss: 3.2443 - accuracy1000: 0.4006 - val_loss: 3.3660 - val_accuracy1000: 0.3294 - 113s/epoch - 45ms/step
Epoch 4/50
2538/2538 - 111s - loss: 3.2365 - accuracy1000: 0.4018 - val_loss: 3.3978 - val_accuracy1000: 0.3090 - 111s/epoch - 44ms/step
Epoch 5/50
2538/2538 - 111s - loss: 3.2257 - accuracy1000: 0.4078 - val_loss: 3.3854 - val_accuracy1000: 0.3130 - 111s/epoch - 44ms/step
Epoch 6/50
2538/2538 - 122s - loss: 3.2049 - accuracy1000: 0.4183 - val_loss: 3.4791 - val_accuracy1000: 0.3168 - 122s/epoch - 48ms/step
Epoch 7/50
2538/2538 - 113s - loss: 3.1735 - accuracy1000: 0.4367 - val_loss: 3.5606 - val_accuracy1000: 0.3251 - 113s/epoch - 45ms/step
Epoch 8/50
2538/2538 - 112s - loss: 3.1606 - accuracy1000: 0.4426 - val_loss: 3.5756 - val_accuracy1000: 0.3268 - 112s/epoch - 44ms/step
Epoch 9/50
2538/2538 - 112s - loss: 3.1487 - accuracy1000: 0.4459 - val_loss: 3.5916 - val_accuracy1000: 0.3267 - 112s/epoch - 44ms/step
Epoch 10/50
2538/2538 - 114s - loss: 3.1442 - accuracy1000: 0.4477 - val_loss: 3.5895 - val_accuracy1000: 0.3267 - 114s/epoch - 45ms/step
Epoch 11/50
2538/2538 - 113s - loss: 3.1368 - accuracy1000: 0.4502 - val_loss: 3.5989 - val_accuracy1000: 0.3281 - 113s/epoch - 45ms/step
testing model: results/ATVI/W0/deepVOL_L3/h1000
Evaluating performance on  test set...
11876/11876 - 242s - 242s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1297903
{'0': {'precision': 0.35357917570498915, 'recall': 0.00014253671632132847, 'f1-score': 0.0002849585586341569, 'support': 1143565}, '1': {'precision': 0.2363565554285483, 'recall': 0.8492257755175359, 'f1-score': 0.3697924576711469, 'support': 715361}, '2': {'precision': 0.4085288954786373, 'recall': 0.1623473099718684, 'f1-score': 0.23235709105933486, 'support': 1181233}, 'accuracy': 0.2629586149934921, 'macro avg': {'precision': 0.3328215422040583, 'recall': 0.33723854073524184, 'f1-score': 0.20081150242970527, 'support': 3040159}, 'weighted avg': {'precision': 0.34734658440756383, 'recall': 0.2629586149934921, 'f1-score': 0.1774015223182357, 'support': 3040159}}
[[   163 973503 169899]
 [   111 607503 107747]
 [   187 989276 191770]]
Evaluating performance on  train set...
2538/2538 - 52s - 52s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1063706
{'0': {'precision': 0.3560311284046693, 'recall': 0.0008450782274599627, 'f1-score': 0.0016861541863615005, 'support': 216548}, '1': {'precision': 0.34945557134942995, 'recall': 0.7930472909489509, 'f1-score': 0.4851362798482085, 'support': 223510}, '2': {'precision': 0.33656136789726676, 'recall': 0.2278603024331121, 'f1-score': 0.2717435531186602, 'support': 209567}, 'accuracy': 0.3466446026553781, 'macro avg': {'precision': 0.3473493558837886, 'recall': 0.34058422386984094, 'f1-score': 0.2528553290510767, 'support': 649625}, 'weighted avg': {'precision': 0.34748785796761505, 'recall': 0.3466446026553781, 'f1-score': 0.25514169624327815, 'support': 649625}}
[[   183 168321  48044]
 [   170 177254  46086]
 [   161 161654  47752]]
Evaluating performance on  val set...
795/795 - 19s - 19s/epoch - 23ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1102982
{'0': {'precision': 0.2620689655172414, 'recall': 0.0005633301707779887, 'f1-score': 0.0011242437242052635, 'support': 67456}, '1': {'precision': 0.3353204172876304, 'recall': 0.8175896246621073, 'f1-score': 0.47558696539428175, 'support': 67699}, '2': {'precision': 0.3165537270087125, 'recall': 0.1772046223472033, 'f1-score': 0.22721553456402938, 'support': 68277}, 'accuracy': 0.3317423020960321, 'macro avg': {'precision': 0.3046477032711947, 'recall': 0.33178585906002955, 'f1-score': 0.23464224789417212, 'support': 203432}, 'weighted avg': {'precision': 0.3047323915945387, 'recall': 0.3317423020960321, 'f1-score': 0.23490008459001388, 'support': 203432}}
[[   38 53582 13836]
 [   63 55350 12286]
 [   44 56134 12099]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        32 (peak)   7.84 (ave)

============================================
