This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/LILAK_orderbooks/LILAK_orderbooks_2019-12-18.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-12-10.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-11-27.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-12-06.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-12-02.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-12-04.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-11-29.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-12-20.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-12-03.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-12-16.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-12-05.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-11-26.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-12-12.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-12-11.csv
training model: results/LILAK/W9/deepLOB_L1/h10
Epoch 1/50
200/200 - 26s - loss: 3.3398 - accuracy10: 0.3598 - val_loss: 3.3319 - val_accuracy10: 0.3325 - 26s/epoch - 128ms/step
Epoch 2/50
200/200 - 4s - loss: 3.2842 - accuracy10: 0.3738 - val_loss: 3.3160 - val_accuracy10: 0.3369 - 4s/epoch - 18ms/step
Epoch 3/50
200/200 - 4s - loss: 3.2650 - accuracy10: 0.3813 - val_loss: 3.2140 - val_accuracy10: 0.3780 - 4s/epoch - 18ms/step
Epoch 4/50
200/200 - 3s - loss: 3.2213 - accuracy10: 0.3983 - val_loss: 3.2210 - val_accuracy10: 0.3790 - 3s/epoch - 17ms/step
Epoch 5/50
200/200 - 4s - loss: 3.1893 - accuracy10: 0.4171 - val_loss: 3.1916 - val_accuracy10: 0.3969 - 4s/epoch - 18ms/step
Epoch 6/50
200/200 - 3s - loss: 3.1641 - accuracy10: 0.4352 - val_loss: 3.2096 - val_accuracy10: 0.4033 - 3s/epoch - 17ms/step
Epoch 7/50
200/200 - 3s - loss: 3.1452 - accuracy10: 0.4412 - val_loss: 3.1773 - val_accuracy10: 0.4154 - 3s/epoch - 17ms/step
Epoch 8/50
200/200 - 3s - loss: 3.1320 - accuracy10: 0.4517 - val_loss: 3.1627 - val_accuracy10: 0.4133 - 3s/epoch - 17ms/step
Epoch 9/50
200/200 - 3s - loss: 3.1117 - accuracy10: 0.4589 - val_loss: 3.1780 - val_accuracy10: 0.4004 - 3s/epoch - 17ms/step
Epoch 10/50
200/200 - 3s - loss: 3.0997 - accuracy10: 0.4662 - val_loss: 3.1480 - val_accuracy10: 0.4381 - 3s/epoch - 17ms/step
Epoch 11/50
200/200 - 3s - loss: 3.0855 - accuracy10: 0.4691 - val_loss: 3.1866 - val_accuracy10: 0.4203 - 3s/epoch - 17ms/step
Epoch 12/50
200/200 - 3s - loss: 3.0653 - accuracy10: 0.4805 - val_loss: 3.1532 - val_accuracy10: 0.4299 - 3s/epoch - 17ms/step
Epoch 13/50
200/200 - 3s - loss: 3.0628 - accuracy10: 0.4769 - val_loss: 3.1520 - val_accuracy10: 0.4219 - 3s/epoch - 17ms/step
Epoch 14/50
200/200 - 3s - loss: 3.0521 - accuracy10: 0.4810 - val_loss: 3.1476 - val_accuracy10: 0.4339 - 3s/epoch - 17ms/step
Epoch 15/50
200/200 - 3s - loss: 3.0368 - accuracy10: 0.4879 - val_loss: 3.1551 - val_accuracy10: 0.4318 - 3s/epoch - 17ms/step
Epoch 16/50
200/200 - 3s - loss: 3.0256 - accuracy10: 0.4911 - val_loss: 3.1488 - val_accuracy10: 0.4386 - 3s/epoch - 17ms/step
Epoch 17/50
200/200 - 3s - loss: 3.0157 - accuracy10: 0.4935 - val_loss: 3.1526 - val_accuracy10: 0.4352 - 3s/epoch - 17ms/step
Epoch 18/50
200/200 - 3s - loss: 3.0079 - accuracy10: 0.4992 - val_loss: 3.1512 - val_accuracy10: 0.4346 - 3s/epoch - 17ms/step
Epoch 19/50
200/200 - 3s - loss: 2.9982 - accuracy10: 0.4983 - val_loss: 3.1650 - val_accuracy10: 0.4320 - 3s/epoch - 17ms/step
Epoch 20/50
200/200 - 3s - loss: 2.9894 - accuracy10: 0.5015 - val_loss: 3.1698 - val_accuracy10: 0.4246 - 3s/epoch - 17ms/step
Epoch 21/50
200/200 - 3s - loss: 2.9850 - accuracy10: 0.5038 - val_loss: 3.1652 - val_accuracy10: 0.4320 - 3s/epoch - 17ms/step
Epoch 22/50
200/200 - 3s - loss: 2.9740 - accuracy10: 0.5058 - val_loss: 3.1803 - val_accuracy10: 0.4254 - 3s/epoch - 17ms/step
Epoch 23/50
200/200 - 4s - loss: 2.9721 - accuracy10: 0.5081 - val_loss: 3.1754 - val_accuracy10: 0.4322 - 4s/epoch - 18ms/step
Epoch 24/50
200/200 - 3s - loss: 2.9606 - accuracy10: 0.5099 - val_loss: 3.1903 - val_accuracy10: 0.4205 - 3s/epoch - 17ms/step
testing model: results/LILAK/W9/deepLOB_L1/h10
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1015432
{'0': {'precision': 0.3791525472818374, 'recall': 0.6124157934131736, 'f1-score': 0.46834695812389315, 'support': 21376}, '1': {'precision': 0.5561708196996392, 'recall': 0.21492721200920792, 'f1-score': 0.3100416257424816, 'support': 30843}, '2': {'precision': 0.41288716814159293, 'recall': 0.5158281148779961, 'f1-score': 0.45865253537622636, 'support': 23155}, 'accuracy': 0.42009180884655184, 'macro avg': {'precision': 0.44940351170768983, 'recall': 0.4477237067667925, 'f1-score': 0.41234703974753373, 'support': 75374}, 'weighted avg': {'precision': 0.46195165204196553, 'recall': 0.42009180884655184, 'f1-score': 0.4005903613483193, 'support': 75374}}
[[13091  2331  5954]
 [13184  6629 11030]
 [ 8252  2959 11944]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0472476
{'0': {'precision': 0.42582566323768273, 'recall': 0.4279107725788901, 'f1-score': 0.426865671641791, 'support': 14704}, '1': {'precision': 0.5349301397205589, 'recall': 0.48454167419996386, 'f1-score': 0.508490655535528, 'support': 22124}, '2': {'precision': 0.39024091215594925, 'recall': 0.4451436962450178, 'f1-score': 0.41588815574573723, 'support': 14301}, 'accuracy': 0.4572356197070156, 'macro avg': {'precision': 0.45033223837139696, 'recall': 0.45253204767462396, 'f1-score': 0.4504148276410187, 'support': 51129}, 'weighted avg': {'precision': 0.4630829910259689, 'recall': 0.4572356197070156, 'f1-score': 0.45911511303191344, 'support': 51129}}
[[ 6292  4559  3853]
 [ 5310 10720  6094]
 [ 3174  4761  6366]]
Evaluating performance on  val set...
53/53 - 1s - 542ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.077145
{'0': {'precision': 0.3771450122572129, 'recall': 0.5491488193300385, 'f1-score': 0.44717719396310796, 'support': 3642}, '1': {'precision': 0.5544685351665786, 'recall': 0.3455833882663151, 'f1-score': 0.4257868020304569, 'support': 6068}, '2': {'precision': 0.40955631399317405, 'recall': 0.47745358090185674, 'f1-score': 0.4409063074096754, 'support': 3770}, 'accuracy': 0.43746290801186943, 'macro avg': {'precision': 0.44705662047232186, 'recall': 0.45739526283273674, 'f1-score': 0.4379567678010801, 'support': 13480}, 'weighted avg': {'precision': 0.466031491823875, 'recall': 0.43746290801186943, 'f1-score': 0.4357945425867156, 'support': 13480}}
[[2000  758  884]
 [2260 2097 1711]
 [1043  927 1800]]
training model: results/LILAK/W9/deepLOB_L1/h20
Epoch 1/50
200/200 - 5s - loss: 3.3485 - accuracy20: 0.3568 - val_loss: 3.4192 - val_accuracy20: 0.3384 - 5s/epoch - 27ms/step
Epoch 2/50
200/200 - 4s - loss: 3.2982 - accuracy20: 0.3783 - val_loss: 3.3287 - val_accuracy20: 0.3535 - 4s/epoch - 18ms/step
Epoch 3/50
200/200 - 3s - loss: 3.2784 - accuracy20: 0.3808 - val_loss: 3.3160 - val_accuracy20: 0.3524 - 3s/epoch - 17ms/step
Epoch 4/50
200/200 - 4s - loss: 3.2557 - accuracy20: 0.3934 - val_loss: 3.2949 - val_accuracy20: 0.3647 - 4s/epoch - 18ms/step
Epoch 5/50
200/200 - 4s - loss: 3.2395 - accuracy20: 0.3997 - val_loss: 3.2955 - val_accuracy20: 0.3698 - 4s/epoch - 18ms/step
Epoch 6/50
200/200 - 4s - loss: 3.2222 - accuracy20: 0.4112 - val_loss: 3.2779 - val_accuracy20: 0.3731 - 4s/epoch - 18ms/step
Epoch 7/50
200/200 - 3s - loss: 3.2304 - accuracy20: 0.4121 - val_loss: 3.2677 - val_accuracy20: 0.3944 - 3s/epoch - 17ms/step
Epoch 8/50
200/200 - 4s - loss: 3.2095 - accuracy20: 0.4298 - val_loss: 3.2254 - val_accuracy20: 0.4082 - 4s/epoch - 18ms/step
Epoch 9/50
200/200 - 3s - loss: 3.1820 - accuracy20: 0.4404 - val_loss: 3.2002 - val_accuracy20: 0.4193 - 3s/epoch - 17ms/step
Epoch 10/50
200/200 - 3s - loss: 3.1672 - accuracy20: 0.4473 - val_loss: 3.2416 - val_accuracy20: 0.4125 - 3s/epoch - 17ms/step
Epoch 11/50
200/200 - 3s - loss: 3.1524 - accuracy20: 0.4545 - val_loss: 3.2175 - val_accuracy20: 0.4162 - 3s/epoch - 17ms/step
Epoch 12/50
200/200 - 3s - loss: 3.1281 - accuracy20: 0.4609 - val_loss: 3.1836 - val_accuracy20: 0.4333 - 3s/epoch - 17ms/step
Epoch 13/50
200/200 - 3s - loss: 3.1166 - accuracy20: 0.4640 - val_loss: 3.2019 - val_accuracy20: 0.4205 - 3s/epoch - 17ms/step
Epoch 14/50
200/200 - 3s - loss: 3.1078 - accuracy20: 0.4670 - val_loss: 3.1942 - val_accuracy20: 0.4260 - 3s/epoch - 17ms/step
Epoch 15/50
200/200 - 3s - loss: 3.0917 - accuracy20: 0.4716 - val_loss: 3.1939 - val_accuracy20: 0.4349 - 3s/epoch - 17ms/step
Epoch 16/50
200/200 - 3s - loss: 3.0826 - accuracy20: 0.4730 - val_loss: 3.1861 - val_accuracy20: 0.4367 - 3s/epoch - 17ms/step
Epoch 17/50
200/200 - 3s - loss: 3.0695 - accuracy20: 0.4783 - val_loss: 3.2193 - val_accuracy20: 0.4327 - 3s/epoch - 17ms/step
Epoch 18/50
200/200 - 3s - loss: 3.0552 - accuracy20: 0.4806 - val_loss: 3.1932 - val_accuracy20: 0.4396 - 3s/epoch - 17ms/step
Epoch 19/50
200/200 - 3s - loss: 3.0491 - accuracy20: 0.4827 - val_loss: 3.1973 - val_accuracy20: 0.4398 - 3s/epoch - 17ms/step
Epoch 20/50
200/200 - 3s - loss: 3.0359 - accuracy20: 0.4872 - val_loss: 3.2014 - val_accuracy20: 0.4379 - 3s/epoch - 17ms/step
Epoch 21/50
200/200 - 3s - loss: 3.0287 - accuracy20: 0.4893 - val_loss: 3.1880 - val_accuracy20: 0.4386 - 3s/epoch - 17ms/step
Epoch 22/50
200/200 - 3s - loss: 3.0223 - accuracy20: 0.4898 - val_loss: 3.1985 - val_accuracy20: 0.4404 - 3s/epoch - 17ms/step
testing model: results/LILAK/W9/deepLOB_L1/h20
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0964754
{'0': {'precision': 0.37905628565489524, 'recall': 0.6796422063939043, 'f1-score': 0.48667803395359177, 'support': 24148}, '1': {'precision': 0.4168737293878473, 'recall': 0.14981531842350937, 'f1-score': 0.2204174255770207, 'support': 24637}, '2': {'precision': 0.4642380398742626, 'recall': 0.4054684267930347, 'f1-score': 0.43286758210872883, 'support': 26589}, 'accuracy': 0.40974341284793164, 'macro avg': {'precision': 0.42005601830566835, 'recall': 0.41164198387014944, 'f1-score': 0.3799876805464471, 'support': 75374}, 'weighted avg': {'precision': 0.42146621512908394, 'recall': 0.40974341284793164, 'f1-score': 0.38066496959881907, 'support': 75374}}
[[16412  2236  5500]
 [14004  3691  6942]
 [12881  2927 10781]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0693537
{'0': {'precision': 0.40331864695849917, 'recall': 0.6760571768910065, 'f1-score': 0.5052298927315618, 'support': 16790}, '1': {'precision': 0.4932337844143724, 'recall': 0.23696894966931958, 'f1-score': 0.3201332626637389, 'support': 17842}, '2': {'precision': 0.4379379726635676, 'recall': 0.38261502091289323, 'f1-score': 0.40841151730831443, 'support': 16497}, 'accuracy': 0.4281523206008332, 'macro avg': {'precision': 0.44483013467881305, 'recall': 0.4318803824910731, 'f1-score': 0.4112582242345384, 'support': 51129}, 'weighted avg': {'precision': 0.4458655557312936, 'recall': 0.4281523206008332, 'f1-score': 0.40939960438194795, 'support': 51129}}
[[11351  1964  3475]
 [ 8988  4228  4626]
 [ 7805  2380  6312]]
Evaluating performance on  val set...
53/53 - 0s - 466ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0640384
{'0': {'precision': 0.39242636746143056, 'recall': 0.6649239543726235, 'f1-score': 0.4935614746868936, 'support': 4208}, '1': {'precision': 0.4900398406374502, 'recall': 0.29608826479438316, 'f1-score': 0.3691384269100913, 'support': 4985}, '2': {'precision': 0.46345116836429, 'recall': 0.3608584091439235, 'f1-score': 0.4057704918032787, 'support': 4287}, 'accuracy': 0.4318249258160237, 'macro avg': {'precision': 0.4486391254877236, 'recall': 0.4406235427703101, 'f1-score': 0.42282346446675456, 'support': 13480}, 'weighted avg': {'precision': 0.4511123085039392, 'recall': 0.4318249258160237, 'f1-score': 0.4196290683968775, 'support': 13480}}
[[2798  693  717]
 [2435 1476 1074]
 [1897  843 1547]]
training model: results/LILAK/W9/deepLOB_L1/h30
Epoch 1/50
200/200 - 5s - loss: 3.3495 - accuracy30: 0.3569 - val_loss: 3.3479 - val_accuracy30: 0.3680 - 5s/epoch - 27ms/step
Epoch 2/50
200/200 - 3s - loss: 3.3139 - accuracy30: 0.3659 - val_loss: 3.3618 - val_accuracy30: 0.3611 - 3s/epoch - 17ms/step
Epoch 3/50
200/200 - 3s - loss: 3.3034 - accuracy30: 0.3701 - val_loss: 3.3809 - val_accuracy30: 0.3576 - 3s/epoch - 17ms/step
Epoch 4/50
200/200 - 3s - loss: 3.2841 - accuracy30: 0.3777 - val_loss: 3.3774 - val_accuracy30: 0.3640 - 3s/epoch - 17ms/step
Epoch 5/50
200/200 - 3s - loss: 3.2819 - accuracy30: 0.3747 - val_loss: 3.3346 - val_accuracy30: 0.3710 - 3s/epoch - 17ms/step
Epoch 6/50
200/200 - 3s - loss: 3.2554 - accuracy30: 0.3925 - val_loss: 3.3083 - val_accuracy30: 0.3751 - 3s/epoch - 17ms/step
Epoch 7/50
200/200 - 3s - loss: 3.2514 - accuracy30: 0.3924 - val_loss: 3.3229 - val_accuracy30: 0.3775 - 3s/epoch - 17ms/step
Epoch 8/50
200/200 - 3s - loss: 3.2336 - accuracy30: 0.4091 - val_loss: 3.3099 - val_accuracy30: 0.3823 - 3s/epoch - 17ms/step
Epoch 9/50
200/200 - 3s - loss: 3.2180 - accuracy30: 0.4188 - val_loss: 3.3023 - val_accuracy30: 0.3949 - 3s/epoch - 17ms/step
Epoch 10/50
200/200 - 3s - loss: 3.2053 - accuracy30: 0.4268 - val_loss: 3.2750 - val_accuracy30: 0.3978 - 3s/epoch - 17ms/step
Epoch 11/50
200/200 - 3s - loss: 3.1912 - accuracy30: 0.4352 - val_loss: 3.2755 - val_accuracy30: 0.3935 - 3s/epoch - 17ms/step
Epoch 12/50
200/200 - 3s - loss: 3.1790 - accuracy30: 0.4392 - val_loss: 3.3070 - val_accuracy30: 0.3996 - 3s/epoch - 17ms/step
Epoch 13/50
200/200 - 3s - loss: 3.1677 - accuracy30: 0.4459 - val_loss: 3.3316 - val_accuracy30: 0.3905 - 3s/epoch - 17ms/step
Epoch 14/50
200/200 - 3s - loss: 3.1617 - accuracy30: 0.4458 - val_loss: 3.3174 - val_accuracy30: 0.4046 - 3s/epoch - 17ms/step
Epoch 15/50
200/200 - 3s - loss: 3.1429 - accuracy30: 0.4539 - val_loss: 3.3174 - val_accuracy30: 0.4074 - 3s/epoch - 17ms/step
Epoch 16/50
200/200 - 4s - loss: 3.1384 - accuracy30: 0.4531 - val_loss: 3.3362 - val_accuracy30: 0.4045 - 4s/epoch - 18ms/step
Epoch 17/50
200/200 - 3s - loss: 3.1235 - accuracy30: 0.4577 - val_loss: 3.3121 - val_accuracy30: 0.4042 - 3s/epoch - 17ms/step
Epoch 18/50
200/200 - 3s - loss: 3.1128 - accuracy30: 0.4627 - val_loss: 3.2851 - val_accuracy30: 0.4066 - 3s/epoch - 17ms/step
Epoch 19/50
200/200 - 3s - loss: 3.1028 - accuracy30: 0.4652 - val_loss: 3.3186 - val_accuracy30: 0.3977 - 3s/epoch - 17ms/step
Epoch 20/50
200/200 - 3s - loss: 3.0973 - accuracy30: 0.4663 - val_loss: 3.3061 - val_accuracy30: 0.4019 - 3s/epoch - 17ms/step
testing model: results/LILAK/W9/deepLOB_L1/h30
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.084268
{'0': {'precision': 0.384139080733508, 'recall': 0.7036684513186595, 'f1-score': 0.4969749593860288, 'support': 25215}, '1': {'precision': 0.40732113144758736, 'recall': 0.05424329714159096, 'f1-score': 0.09573719202190066, 'support': 22565}, '2': {'precision': 0.46138273491214665, 'recall': 0.43774008842501994, 'f1-score': 0.4492505671886041, 'support': 27594}, 'accuracy': 0.41189269509379894, 'macro avg': {'precision': 0.4176143156977474, 'recall': 0.39855061229509015, 'f1-score': 0.34732090619884454, 'support': 75374}, 'weighted avg': {'precision': 0.41935764904311823, 'recall': 0.41189269509379894, 'f1-score': 0.35938325536518223, 'support': 75374}}
[[17743   947  6525]
 [13765  1224  7576]
 [14681   834 12079]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0871274
{'0': {'precision': 0.38901083585937773, 'recall': 0.6374536111904082, 'f1-score': 0.4831660031158041, 'support': 17515}, '1': {'precision': 0.4172360248447205, 'recall': 0.16322439557769408, 'f1-score': 0.23465199545891186, 'support': 16462}, '2': {'precision': 0.409369527145359, 'recall': 0.38158815298507465, 'f1-score': 0.39499094749547375, 'support': 17152}, 'accuracy': 0.39893211289092295, 'macro avg': {'precision': 0.40520546261648577, 'recall': 0.39408871991772565, 'f1-score': 0.37093631535672994, 'support': 51129}, 'weighted avg': {'precision': 0.4049281300371216, 'recall': 0.39893211289092295, 'f1-score': 0.373572305839353, 'support': 51129}}
[[11165  1872  4478]
 [ 8810  2687  4965]
 [ 8726  1881  6545]]
Evaluating performance on  val set...
53/53 - 0s - 459ms/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0870159
{'0': {'precision': 0.3819275714451001, 'recall': 0.7464947987336047, 'f1-score': 0.5053195560658247, 'support': 4422}, '1': {'precision': 0.46142433234421365, 'recall': 0.06611394557823129, 'f1-score': 0.11565637783562663, 'support': 4704}, '2': {'precision': 0.4165265433581552, 'recall': 0.39825447864033076, 'f1-score': 0.407185628742515, 'support': 4354}, 'accuracy': 0.39658753709198813, 'macro avg': {'precision': 0.41995948238248965, 'recall': 0.4036210743173889, 'f1-score': 0.34272052088132215, 'support': 13480}, 'weighted avg': {'precision': 0.42084423961860684, 'recall': 0.39658753709198813, 'f1-score': 0.337645171053915, 'support': 13480}}
[[3301  143  978]
 [2942  311 1451]
 [2400  220 1734]]
training model: results/LILAK/W9/deepLOB_L1/h50
Epoch 1/50
200/200 - 5s - loss: 3.3576 - accuracy50: 0.3532 - val_loss: 3.3940 - val_accuracy50: 0.3395 - 5s/epoch - 27ms/step
Epoch 2/50
200/200 - 3s - loss: 3.3211 - accuracy50: 0.3636 - val_loss: 3.3364 - val_accuracy50: 0.3539 - 3s/epoch - 17ms/step
Epoch 3/50
200/200 - 3s - loss: 3.3121 - accuracy50: 0.3651 - val_loss: 3.3481 - val_accuracy50: 0.3381 - 3s/epoch - 17ms/step
Epoch 4/50
200/200 - 3s - loss: 3.2902 - accuracy50: 0.3789 - val_loss: 3.3176 - val_accuracy50: 0.3573 - 3s/epoch - 17ms/step
Epoch 5/50
200/200 - 3s - loss: 3.2692 - accuracy50: 0.3875 - val_loss: 3.3140 - val_accuracy50: 0.3674 - 3s/epoch - 17ms/step
Epoch 6/50
200/200 - 3s - loss: 3.2542 - accuracy50: 0.3993 - val_loss: 3.2993 - val_accuracy50: 0.3652 - 3s/epoch - 17ms/step
Epoch 7/50
200/200 - 3s - loss: 3.2426 - accuracy50: 0.4040 - val_loss: 3.3194 - val_accuracy50: 0.3545 - 3s/epoch - 17ms/step
Epoch 8/50
200/200 - 3s - loss: 3.2482 - accuracy50: 0.4016 - val_loss: 3.2760 - val_accuracy50: 0.3796 - 3s/epoch - 17ms/step
Epoch 9/50
200/200 - 3s - loss: 3.2287 - accuracy50: 0.4117 - val_loss: 3.2970 - val_accuracy50: 0.3682 - 3s/epoch - 17ms/step
Epoch 10/50
200/200 - 3s - loss: 3.2100 - accuracy50: 0.4226 - val_loss: 3.2845 - val_accuracy50: 0.3749 - 3s/epoch - 17ms/step
Epoch 11/50
200/200 - 3s - loss: 3.2051 - accuracy50: 0.4254 - val_loss: 3.2702 - val_accuracy50: 0.3711 - 3s/epoch - 17ms/step
Epoch 12/50
200/200 - 3s - loss: 3.1905 - accuracy50: 0.4304 - val_loss: 3.2684 - val_accuracy50: 0.3781 - 3s/epoch - 17ms/step
Epoch 13/50
200/200 - 3s - loss: 3.1847 - accuracy50: 0.4346 - val_loss: 3.2760 - val_accuracy50: 0.3722 - 3s/epoch - 17ms/step
Epoch 14/50
200/200 - 3s - loss: 3.1807 - accuracy50: 0.4336 - val_loss: 3.2987 - val_accuracy50: 0.3783 - 3s/epoch - 17ms/step
Epoch 15/50
200/200 - 3s - loss: 3.1769 - accuracy50: 0.4352 - val_loss: 3.2651 - val_accuracy50: 0.3813 - 3s/epoch - 17ms/step
Epoch 16/50
200/200 - 3s - loss: 3.1639 - accuracy50: 0.4396 - val_loss: 3.2872 - val_accuracy50: 0.3745 - 3s/epoch - 17ms/step
Epoch 17/50
200/200 - 3s - loss: 3.1645 - accuracy50: 0.4409 - val_loss: 3.2589 - val_accuracy50: 0.3795 - 3s/epoch - 17ms/step
Epoch 18/50
200/200 - 3s - loss: 3.1622 - accuracy50: 0.4396 - val_loss: 3.2495 - val_accuracy50: 0.3923 - 3s/epoch - 17ms/step
Epoch 19/50
200/200 - 3s - loss: 3.1550 - accuracy50: 0.4438 - val_loss: 3.2895 - val_accuracy50: 0.3751 - 3s/epoch - 17ms/step
Epoch 20/50
200/200 - 3s - loss: 3.1450 - accuracy50: 0.4475 - val_loss: 3.2945 - val_accuracy50: 0.3795 - 3s/epoch - 17ms/step
Epoch 21/50
200/200 - 3s - loss: 3.1389 - accuracy50: 0.4496 - val_loss: 3.2770 - val_accuracy50: 0.3796 - 3s/epoch - 17ms/step
Epoch 22/50
200/200 - 3s - loss: 3.1362 - accuracy50: 0.4504 - val_loss: 3.2703 - val_accuracy50: 0.3858 - 3s/epoch - 17ms/step
Epoch 23/50
200/200 - 3s - loss: 3.1263 - accuracy50: 0.4532 - val_loss: 3.2718 - val_accuracy50: 0.3864 - 3s/epoch - 17ms/step
Epoch 24/50
200/200 - 3s - loss: 3.1165 - accuracy50: 0.4563 - val_loss: 3.2930 - val_accuracy50: 0.3804 - 3s/epoch - 17ms/step
Epoch 25/50
200/200 - 3s - loss: 3.1142 - accuracy50: 0.4573 - val_loss: 3.2898 - val_accuracy50: 0.3769 - 3s/epoch - 17ms/step
Epoch 26/50
200/200 - 3s - loss: 3.1101 - accuracy50: 0.4587 - val_loss: 3.2850 - val_accuracy50: 0.3861 - 3s/epoch - 17ms/step
Epoch 27/50
200/200 - 3s - loss: 3.1006 - accuracy50: 0.4609 - val_loss: 3.2962 - val_accuracy50: 0.3846 - 3s/epoch - 17ms/step
Epoch 28/50
200/200 - 3s - loss: 3.1026 - accuracy50: 0.4598 - val_loss: 3.2911 - val_accuracy50: 0.3924 - 3s/epoch - 17ms/step
testing model: results/LILAK/W9/deepLOB_L1/h50
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1070318
{'0': {'precision': 0.3576982553960752, 'recall': 0.668498392152074, 'f1-score': 0.4660329171396141, 'support': 24567}, '1': {'precision': 0.3276192300325608, 'recall': 0.14534562603560353, 'f1-score': 0.20135966332146327, 'support': 23537}, '2': {'precision': 0.4452915505547084, 'recall': 0.3105610561056106, 'f1-score': 0.3659184687506751, 'support': 27270}, 'accuracy': 0.3756335075755566, 'macro avg': {'precision': 0.3768696786611148, 'recall': 0.37480169143109604, 'f1-score': 0.3444370164039175, 'support': 75374}, 'weighted avg': {'precision': 0.3799963839151254, 'recall': 0.3756335075755566, 'f1-score': 0.3471625456231206, 'support': 75374}}
[[16423  3370  4774]
 [14340  3421  5776]
 [15150  3651  8469]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0919538
{'0': {'precision': 0.4049345182413471, 'recall': 0.3990550818160867, 'f1-score': 0.4019733023795705, 'support': 17356}, '1': {'precision': 0.3830432231566595, 'recall': 0.23343265792610252, 'f1-score': 0.29008368510701327, 'support': 16780}, '2': {'precision': 0.3708979368881045, 'recall': 0.5194491849585123, 'f1-score': 0.4327809374387135, 'support': 16993}, 'accuracy': 0.3847131764751902, 'macro avg': {'precision': 0.38629189276203707, 'recall': 0.3839789749002338, 'f1-score': 0.37494597497509913, 'support': 51129}, 'weighted avg': {'precision': 0.38643778334614654, 'recall': 0.3847131764751902, 'f1-score': 0.37549139122790526, 'support': 51129}}
[[6926 3097 7333]
 [5224 3917 7639]
 [4954 3212 8827]]
Evaluating performance on  val set...
53/53 - 0s - 441ms/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.08169
{'0': {'precision': 0.3739401280498356, 'recall': 0.49405578417924095, 'f1-score': 0.42568698906727076, 'support': 4374}, '1': {'precision': 0.40173603383040285, 'recall': 0.37254901960784315, 'f1-score': 0.386592418076676, 'support': 4845}, '2': {'precision': 0.41334164588528677, 'recall': 0.31119455526871626, 'f1-score': 0.3550676127995715, 'support': 4261}, 'accuracy': 0.39258160237388723, 'macro avg': {'precision': 0.3963392692551751, 'recall': 0.3925997863519335, 'f1-score': 0.3891156733145061, 'support': 13480}, 'weighted avg': {'precision': 0.3963853083913568, 'recall': 0.39258160237388723, 'f1-score': 0.38931292684723373, 'support': 13480}}
[[2161 1431  782]
 [1940 1805 1100]
 [1678 1257 1326]]
training model: results/LILAK/W9/deepLOB_L1/h100
Epoch 1/50
200/200 - 5s - loss: 3.3542 - accuracy100: 0.3530 - val_loss: 3.3678 - val_accuracy100: 0.3446 - 5s/epoch - 27ms/step
Epoch 2/50
200/200 - 3s - loss: 3.3225 - accuracy100: 0.3581 - val_loss: 3.3005 - val_accuracy100: 0.3654 - 3s/epoch - 17ms/step
Epoch 3/50
200/200 - 3s - loss: 3.3062 - accuracy100: 0.3627 - val_loss: 3.3433 - val_accuracy100: 0.3438 - 3s/epoch - 17ms/step
Epoch 4/50
200/200 - 3s - loss: 3.2859 - accuracy100: 0.3739 - val_loss: 3.3271 - val_accuracy100: 0.3515 - 3s/epoch - 17ms/step
Epoch 5/50
200/200 - 3s - loss: 3.2820 - accuracy100: 0.3720 - val_loss: 3.3150 - val_accuracy100: 0.3566 - 3s/epoch - 17ms/step
Epoch 6/50
200/200 - 3s - loss: 3.2695 - accuracy100: 0.3790 - val_loss: 3.3010 - val_accuracy100: 0.3547 - 3s/epoch - 17ms/step
Epoch 7/50
200/200 - 3s - loss: 3.2498 - accuracy100: 0.3883 - val_loss: 3.3126 - val_accuracy100: 0.3510 - 3s/epoch - 17ms/step
Epoch 8/50
200/200 - 3s - loss: 3.2400 - accuracy100: 0.3944 - val_loss: 3.3146 - val_accuracy100: 0.3520 - 3s/epoch - 17ms/step
Epoch 9/50
200/200 - 3s - loss: 3.2317 - accuracy100: 0.4031 - val_loss: 3.3118 - val_accuracy100: 0.3583 - 3s/epoch - 17ms/step
Epoch 10/50
200/200 - 3s - loss: 3.2206 - accuracy100: 0.4085 - val_loss: 3.3051 - val_accuracy100: 0.3622 - 3s/epoch - 17ms/step
Epoch 11/50
200/200 - 3s - loss: 3.2214 - accuracy100: 0.4120 - val_loss: 3.3199 - val_accuracy100: 0.3673 - 3s/epoch - 17ms/step
Epoch 12/50
200/200 - 3s - loss: 3.2098 - accuracy100: 0.4151 - val_loss: 3.3308 - val_accuracy100: 0.3596 - 3s/epoch - 17ms/step
testing model: results/LILAK/W9/deepLOB_L1/h100
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1126785
{'0': {'precision': 0.3190516039051604, 'recall': 0.48805256869773, 'f1-score': 0.3858583814053908, 'support': 23436}, '1': {'precision': 0.3710993562143765, 'recall': 0.32624369142033166, 'f1-score': 0.3472288833042377, 'support': 27740}, '2': {'precision': 0.3381779744995706, 'recall': 0.2115464087941152, 'f1-score': 0.2602771069022499, 'support': 24198}, 'accuracy': 0.33973253376495877, 'macro avg': {'precision': 0.3427763115397025, 'recall': 0.341947556304059, 'f1-score': 0.33112145720395947, 'support': 75374}, 'weighted avg': {'precision': 0.344347124438782, 'recall': 0.33973253376495877, 'f1-score': 0.33132501502238093, 'support': 75374}}
[[11438  7490  4508]
 [13180  9050  5510]
 [11232  7847  5119]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1167517
{'0': {'precision': 0.35898851590106007, 'recall': 0.36999943094520005, 'f1-score': 0.3644108168698333, 'support': 17573}, '1': {'precision': 0.33109583932662084, 'recall': 0.3784557301181342, 'f1-score': 0.35319523768931327, 'support': 16422}, '2': {'precision': 0.3414291731012214, 'recall': 0.28388000466907903, 'f1-score': 0.310006373486297, 'support': 17134}, 'accuracy': 0.3438557374484148, 'macro avg': {'precision': 0.34383784277630075, 'recall': 0.34411172191080447, 'f1-score': 0.34253747601514783, 'support': 51129}, 'weighted avg': {'precision': 0.344145367898207, 'recall': 0.3438557374484148, 'f1-score': 0.3425768679516849, 'support': 51129}}
[[6502 6077 4994]
 [5819 6215 4388]
 [5791 6479 4864]]
Evaluating performance on  val set...
53/53 - 0s - 449ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0994586
{'0': {'precision': 0.35854708856019474, 'recall': 0.4321823516136312, 'f1-score': 0.39193614408514127, 'support': 4431}, '1': {'precision': 0.38618262641229856, 'recall': 0.4284833538840937, 'f1-score': 0.4062347783731125, 'support': 4866}, '2': {'precision': 0.3441605839416058, 'recall': 0.22543628974420274, 'f1-score': 0.27242524916943517, 'support': 4183}, 'accuracy': 0.3666913946587537, 'macro avg': {'precision': 0.3629634329713664, 'recall': 0.36203399841397593, 'f1-score': 0.356865390542563, 'support': 13480}, 'weighted avg': {'precision': 0.3640586448190063, 'recall': 0.3666913946587537, 'f1-score': 0.3600120403027132, 'support': 13480}}
[[1915 1728  788]
 [1772 2085 1009]
 [1654 1586  943]]
training model: results/LILAK/W9/deepLOB_L1/h200
Epoch 1/50
200/200 - 5s - loss: 3.3676 - accuracy200: 0.3457 - val_loss: 3.3517 - val_accuracy200: 0.3405 - 5s/epoch - 26ms/step
Epoch 2/50
200/200 - 3s - loss: 3.3452 - accuracy200: 0.3461 - val_loss: 3.3326 - val_accuracy200: 0.3424 - 3s/epoch - 17ms/step
Epoch 3/50
200/200 - 3s - loss: 3.3256 - accuracy200: 0.3470 - val_loss: 3.3260 - val_accuracy200: 0.3423 - 3s/epoch - 17ms/step
Epoch 4/50
200/200 - 3s - loss: 3.3073 - accuracy200: 0.3566 - val_loss: 3.3074 - val_accuracy200: 0.3407 - 3s/epoch - 17ms/step
Epoch 5/50
200/200 - 3s - loss: 3.2992 - accuracy200: 0.3615 - val_loss: 3.3134 - val_accuracy200: 0.3438 - 3s/epoch - 17ms/step
Epoch 6/50
200/200 - 3s - loss: 3.2995 - accuracy200: 0.3600 - val_loss: 3.3048 - val_accuracy200: 0.3402 - 3s/epoch - 17ms/step
Epoch 7/50
200/200 - 3s - loss: 3.2906 - accuracy200: 0.3649 - val_loss: 3.3033 - val_accuracy200: 0.3504 - 3s/epoch - 17ms/step
Epoch 8/50
200/200 - 3s - loss: 3.2743 - accuracy200: 0.3776 - val_loss: 3.3021 - val_accuracy200: 0.3553 - 3s/epoch - 17ms/step
Epoch 9/50
200/200 - 3s - loss: 3.2686 - accuracy200: 0.3842 - val_loss: 3.3057 - val_accuracy200: 0.3554 - 3s/epoch - 17ms/step
Epoch 10/50
200/200 - 3s - loss: 3.2575 - accuracy200: 0.3942 - val_loss: 3.2988 - val_accuracy200: 0.3585 - 3s/epoch - 17ms/step
Epoch 11/50
200/200 - 3s - loss: 3.2500 - accuracy200: 0.3971 - val_loss: 3.2984 - val_accuracy200: 0.3665 - 3s/epoch - 17ms/step
Epoch 12/50
200/200 - 3s - loss: 3.2421 - accuracy200: 0.3992 - val_loss: 3.3131 - val_accuracy200: 0.3565 - 3s/epoch - 17ms/step
Epoch 13/50
200/200 - 3s - loss: 3.2347 - accuracy200: 0.4054 - val_loss: 3.3042 - val_accuracy200: 0.3724 - 3s/epoch - 17ms/step
Epoch 14/50
200/200 - 3s - loss: 3.2309 - accuracy200: 0.4089 - val_loss: 3.3223 - val_accuracy200: 0.3636 - 3s/epoch - 17ms/step
Epoch 15/50
200/200 - 4s - loss: 3.2323 - accuracy200: 0.4103 - val_loss: 3.3114 - val_accuracy200: 0.3697 - 4s/epoch - 18ms/step
Epoch 16/50
200/200 - 3s - loss: 3.2237 - accuracy200: 0.4115 - val_loss: 3.3028 - val_accuracy200: 0.3606 - 3s/epoch - 17ms/step
Epoch 17/50
200/200 - 3s - loss: 3.2145 - accuracy200: 0.4123 - val_loss: 3.3221 - val_accuracy200: 0.3567 - 3s/epoch - 17ms/step
Epoch 18/50
200/200 - 3s - loss: 3.2090 - accuracy200: 0.4140 - val_loss: 3.3152 - val_accuracy200: 0.3578 - 3s/epoch - 17ms/step
Epoch 19/50
200/200 - 3s - loss: 3.2043 - accuracy200: 0.4180 - val_loss: 3.3188 - val_accuracy200: 0.3605 - 3s/epoch - 17ms/step
Epoch 20/50
200/200 - 3s - loss: 3.1935 - accuracy200: 0.4219 - val_loss: 3.3390 - val_accuracy200: 0.3492 - 3s/epoch - 17ms/step
Epoch 21/50
200/200 - 3s - loss: 3.1866 - accuracy200: 0.4271 - val_loss: 3.3435 - val_accuracy200: 0.3458 - 3s/epoch - 17ms/step
testing model: results/LILAK/W9/deepLOB_L1/h200
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1232501
{'0': {'precision': 0.36443562110039707, 'recall': 0.18391956202812468, 'f1-score': 0.24446505433877913, 'support': 27947}, '1': {'precision': 0.29351439281420183, 'recall': 0.5747126436781609, 'f1-score': 0.3885767790262172, 'support': 21663}, '2': {'precision': 0.3640269453137432, 'recall': 0.26637944418568543, 'f1-score': 0.30764058542707934, 'support': 25764}, 'accuracy': 0.3244222145567437, 'macro avg': {'precision': 0.34065898640944736, 'recall': 0.3416705499639903, 'f1-score': 0.3135608062640252, 'support': 75374}, 'weighted avg': {'precision': 0.3439126862510963, 'recall': 0.3244222145567437, 'f1-score': 0.3074781181918709, 'support': 75374}}
[[ 5140 15920  6887]
 [ 4110 12450  5103]
 [ 4854 14047  6863]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1049231
{'0': {'precision': 0.38666996413997773, 'recall': 0.18310106569855955, 'f1-score': 0.24851976952116037, 'support': 17078}, '1': {'precision': 0.35058681913933193, 'recall': 0.4151077854979512, 'f1-score': 0.38012888490088914, 'support': 16839}, '2': {'precision': 0.3524930747922438, 'recall': 0.47315826167789915, 'f1-score': 0.40400833416013493, 'support': 17212}, 'accuracy': 0.357155430381975, 'macro avg': {'precision': 0.3632499526905178, 'recall': 0.3571223709581366, 'f1-score': 0.34421899619406143, 'support': 51129}, 'weighted avg': {'precision': 0.36328095402597055, 'recall': 0.357155430381975, 'f1-score': 0.3442078343854308, 'support': 51129}}
[[3127 6413 7538]
 [2427 6990 7422]
 [2533 6535 8144]]
Evaluating performance on  val set...
53/53 - 0s - 447ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0995189
{'0': {'precision': 0.3711034141514102, 'recall': 0.17064846416382254, 'f1-score': 0.23379052369077305, 'support': 4395}, '1': {'precision': 0.3732340097611097, 'recall': 0.586715122148193, 'f1-score': 0.4562367532773373, 'support': 4953}, '2': {'precision': 0.34032126327252926, 'recall': 0.30251694094869314, 'f1-score': 0.3203074951953876, 'support': 4132}, 'accuracy': 0.36394658753709197, 'macro avg': {'precision': 0.36155289572834975, 'recall': 0.3532935090869029, 'f1-score': 0.3367782573878326, 'support': 13480}, 'weighted avg': {'precision': 0.362450668797056, 'recall': 0.36394658753709197, 'f1-score': 0.3420445519844912, 'support': 13480}}
[[ 750 2623 1022]
 [ 646 2906 1401]
 [ 625 2257 1250]]
training model: results/LILAK/W9/deepLOB_L1/h300
Epoch 1/50
200/200 - 6s - loss: 3.3586 - accuracy300: 0.3562 - val_loss: 3.3481 - val_accuracy300: 0.3377 - 6s/epoch - 28ms/step
Epoch 2/50
200/200 - 3s - loss: 3.3324 - accuracy300: 0.3550 - val_loss: 3.3332 - val_accuracy300: 0.3442 - 3s/epoch - 17ms/step
Epoch 3/50
200/200 - 3s - loss: 3.3114 - accuracy300: 0.3621 - val_loss: 3.3514 - val_accuracy300: 0.3228 - 3s/epoch - 17ms/step
Epoch 4/50
200/200 - 3s - loss: 3.3125 - accuracy300: 0.3644 - val_loss: 3.3427 - val_accuracy300: 0.3318 - 3s/epoch - 17ms/step
Epoch 5/50
200/200 - 3s - loss: 3.2917 - accuracy300: 0.3697 - val_loss: 3.4695 - val_accuracy300: 0.3062 - 3s/epoch - 17ms/step
Epoch 6/50
200/200 - 3s - loss: 3.2978 - accuracy300: 0.3724 - val_loss: 3.2914 - val_accuracy300: 0.3671 - 3s/epoch - 17ms/step
Epoch 7/50
200/200 - 3s - loss: 3.2864 - accuracy300: 0.3703 - val_loss: 3.3019 - val_accuracy300: 0.3934 - 3s/epoch - 17ms/step
Epoch 8/50
200/200 - 3s - loss: 3.2668 - accuracy300: 0.3820 - val_loss: 3.3350 - val_accuracy300: 0.3432 - 3s/epoch - 17ms/step
Epoch 9/50
200/200 - 3s - loss: 3.2527 - accuracy300: 0.3943 - val_loss: 3.3359 - val_accuracy300: 0.3269 - 3s/epoch - 17ms/step
Epoch 10/50
200/200 - 3s - loss: 3.2436 - accuracy300: 0.4029 - val_loss: 3.2914 - val_accuracy300: 0.3800 - 3s/epoch - 17ms/step
Epoch 11/50
200/200 - 3s - loss: 3.2320 - accuracy300: 0.4080 - val_loss: 3.3216 - val_accuracy300: 0.3550 - 3s/epoch - 17ms/step
Epoch 12/50
200/200 - 3s - loss: 3.2159 - accuracy300: 0.4149 - val_loss: 3.3927 - val_accuracy300: 0.3157 - 3s/epoch - 17ms/step
Epoch 13/50
200/200 - 3s - loss: 3.2085 - accuracy300: 0.4145 - val_loss: 3.3780 - val_accuracy300: 0.3315 - 3s/epoch - 17ms/step
Epoch 14/50
200/200 - 3s - loss: 3.2020 - accuracy300: 0.4218 - val_loss: 3.4279 - val_accuracy300: 0.3127 - 3s/epoch - 17ms/step
Epoch 15/50
200/200 - 3s - loss: 3.1955 - accuracy300: 0.4281 - val_loss: 3.4880 - val_accuracy300: 0.2996 - 3s/epoch - 17ms/step
Epoch 16/50
200/200 - 3s - loss: 3.2009 - accuracy300: 0.4251 - val_loss: 3.3732 - val_accuracy300: 0.3174 - 3s/epoch - 17ms/step
Epoch 17/50
200/200 - 3s - loss: 3.1917 - accuracy300: 0.4325 - val_loss: 3.4743 - val_accuracy300: 0.2995 - 3s/epoch - 17ms/step
Epoch 18/50
200/200 - 3s - loss: 3.1819 - accuracy300: 0.4342 - val_loss: 3.4495 - val_accuracy300: 0.3020 - 3s/epoch - 17ms/step
Epoch 19/50
200/200 - 3s - loss: 3.1691 - accuracy300: 0.4362 - val_loss: 3.4415 - val_accuracy300: 0.3040 - 3s/epoch - 17ms/step
Epoch 20/50
200/200 - 3s - loss: 3.1537 - accuracy300: 0.4439 - val_loss: 3.4072 - val_accuracy300: 0.3220 - 3s/epoch - 17ms/step
testing model: results/LILAK/W9/deepLOB_L1/h300
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1242508
{'0': {'precision': 0.3316551290119572, 'recall': 0.3981264637002342, 'f1-score': 0.36186356301713185, 'support': 26474}, '1': {'precision': 0.33375759328897886, 'recall': 0.4462579771804293, 'f1-score': 0.3818949110467521, 'support': 25855}, '2': {'precision': 0.2306072695035461, 'recall': 0.09030158385766977, 'f1-score': 0.12978265614768156, 'support': 23045}, 'accuracy': 0.3205216652957253, 'macro avg': {'precision': 0.2986733306014941, 'recall': 0.3115620082461111, 'f1-score': 0.2911803767371885, 'support': 75374}, 'weighted avg': {'precision': 0.30148174417781093, 'recall': 0.3205216652957253, 'f1-score': 0.29777788366482666, 'support': 75374}}
[[10540 12432  3502]
 [10876 11538  3441]
 [10364 10600  2081]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.134803
{'0': {'precision': 0.3486356932153392, 'recall': 0.11143193871538008, 'f1-score': 0.16888452263999285, 'support': 16970}, '1': {'precision': 0.353923431984795, 'recall': 0.15457132692991818, 'f1-score': 0.21517002310993727, 'support': 16866}, '2': {'precision': 0.3446620934296669, 'recall': 0.7641242121089458, 'f1-score': 0.475050330744895, 'support': 17293}, 'accuracy': 0.34641788417532127, 'macro avg': {'precision': 0.34907373954326704, 'recall': 0.3433758259180813, 'f1-score': 0.2863682921649417, 'support': 51129}, 'weighted avg': {'precision': 0.3490360049951904, 'recall': 0.34641788417532127, 'f1-score': 0.2877050857349909, 'support': 51129}}
[[ 1891  2279 12800]
 [ 1934  2607 12325]
 [ 1599  2480 13214]]
Evaluating performance on  val set...
53/53 - 0s - 465ms/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0962191
{'0': {'precision': 0.31808453718566077, 'recall': 0.28350023843586075, 'f1-score': 0.299798285426122, 'support': 4194}, '1': {'precision': 0.43722186904005084, 'recall': 0.5094444444444445, 'f1-score': 0.4705781731098187, 'support': 5400}, '2': {'precision': 0.3318840579710145, 'recall': 0.2946474523932064, 'f1-score': 0.3121592148309706, 'support': 3886}, 'accuracy': 0.3772255192878338, 'macro avg': {'precision': 0.36239682139890866, 'recall': 0.3625307117578372, 'f1-score': 0.3608452244556371, 'support': 13480}, 'weighted avg': {'precision': 0.3697882856860756, 'recall': 0.3772255192878338, 'f1-score': 0.3717749890729472, 'support': 13480}}
[[1189 1892 1113]
 [1457 2751 1192]
 [1092 1649 1145]]
training model: results/LILAK/W9/deepLOB_L1/h500
Epoch 1/50
200/200 - 5s - loss: 3.3629 - accuracy500: 0.3521 - val_loss: 3.3749 - val_accuracy500: 0.3324 - 5s/epoch - 26ms/step
Epoch 2/50
200/200 - 3s - loss: 3.3353 - accuracy500: 0.3542 - val_loss: 3.3453 - val_accuracy500: 0.3235 - 3s/epoch - 17ms/step
Epoch 3/50
200/200 - 3s - loss: 3.3129 - accuracy500: 0.3596 - val_loss: 3.3400 - val_accuracy500: 0.3297 - 3s/epoch - 17ms/step
Epoch 4/50
200/200 - 4s - loss: 3.3073 - accuracy500: 0.3657 - val_loss: 3.3327 - val_accuracy500: 0.3453 - 4s/epoch - 18ms/step
Epoch 5/50
200/200 - 3s - loss: 3.2747 - accuracy500: 0.3791 - val_loss: 3.3547 - val_accuracy500: 0.3232 - 3s/epoch - 17ms/step
Epoch 6/50
200/200 - 3s - loss: 3.2746 - accuracy500: 0.3861 - val_loss: 3.3369 - val_accuracy500: 0.3329 - 3s/epoch - 17ms/step
Epoch 7/50
200/200 - 3s - loss: 3.2674 - accuracy500: 0.3918 - val_loss: 3.3587 - val_accuracy500: 0.3241 - 3s/epoch - 17ms/step
Epoch 8/50
200/200 - 3s - loss: 3.2464 - accuracy500: 0.4002 - val_loss: 3.3668 - val_accuracy500: 0.3186 - 3s/epoch - 17ms/step
Epoch 9/50
200/200 - 3s - loss: 3.2329 - accuracy500: 0.4107 - val_loss: 3.4590 - val_accuracy500: 0.3117 - 3s/epoch - 17ms/step
Epoch 10/50
200/200 - 3s - loss: 3.2154 - accuracy500: 0.4222 - val_loss: 3.4075 - val_accuracy500: 0.3151 - 3s/epoch - 17ms/step
Epoch 11/50
200/200 - 3s - loss: 3.2087 - accuracy500: 0.4232 - val_loss: 3.3704 - val_accuracy500: 0.3176 - 3s/epoch - 17ms/step
Epoch 12/50
200/200 - 3s - loss: 3.1879 - accuracy500: 0.4374 - val_loss: 3.4295 - val_accuracy500: 0.3120 - 3s/epoch - 17ms/step
Epoch 13/50
200/200 - 3s - loss: 3.1771 - accuracy500: 0.4414 - val_loss: 3.3704 - val_accuracy500: 0.3239 - 3s/epoch - 17ms/step
Epoch 14/50
200/200 - 3s - loss: 3.1608 - accuracy500: 0.4423 - val_loss: 3.4723 - val_accuracy500: 0.3011 - 3s/epoch - 17ms/step
testing model: results/LILAK/W9/deepLOB_L1/h500
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1208477
{'0': {'precision': 0.40575673166202414, 'recall': 0.17978606692265497, 'f1-score': 0.24916848807374326, 'support': 29168}, '1': {'precision': 0.28993380342495323, 'recall': 0.7418419478068763, 'f1-score': 0.4169221019413081, 'support': 21727}, '2': {'precision': 0.3219597550306212, 'recall': 0.0901997630622166, 'f1-score': 0.1409196796119603, 'support': 24479}, 'accuracy': 0.31270729959933136, 'macro avg': {'precision': 0.33921676337253287, 'recall': 0.33727592593058264, 'f1-score': 0.2690034232090039, 'support': 75374}, 'weighted avg': {'precision': 0.3451555833513739, 'recall': 0.31270729959933136, 'f1-score': 0.2623687983420665, 'support': 75374}}
[[ 5244 21182  2742]
 [ 3701 16118  1908]
 [ 3979 18292  2208]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1225935
{'0': {'precision': 0.3306259475850119, 'recall': 0.18333033087131448, 'f1-score': 0.23587128674624327, 'support': 16653}, '1': {'precision': 0.34277980149049225, 'recall': 0.6001755412521943, 'f1-score': 0.4363473932742008, 'support': 17090}, '2': {'precision': 0.35441029067824925, 'recall': 0.24404693431496607, 'f1-score': 0.28905238776483416, 'support': 17386}, 'accuracy': 0.3433081030335035, 'macro avg': {'precision': 0.3426053465845844, 'recall': 0.3425176021461583, 'f1-score': 0.3204236892617594, 'support': 51129}, 'weighted avg': {'precision': 0.3427760767145408, 'recall': 0.3433081030335035, 'f1-score': 0.3209647421799896, 'support': 51129}}
[[ 3053  9637  3963]
 [ 3067 10257  3766]
 [ 3114 10029  4243]]
Evaluating performance on  val set...
53/53 - 0s - 435ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1103084
{'0': {'precision': 0.33614278631631134, 'recall': 0.15353260869565216, 'f1-score': 0.21078812373698116, 'support': 4416}, '1': {'precision': 0.35218783351120597, 'recall': 0.7741522712731925, 'f1-score': 0.484129101093625, 'support': 4689}, '2': {'precision': 0.305363321799308, 'recall': 0.08068571428571429, 'f1-score': 0.12764418730790092, 'support': 4375}, 'accuracy': 0.34577151335311573, 'macro avg': {'precision': 0.33123131387560845, 'recall': 0.3361235314181863, 'f1-score': 0.27418713737950234, 'support': 13480}, 'weighted avg': {'precision': 0.3317344086482825, 'recall': 0.34577151335311573, 'f1-score': 0.2788846460625062, 'support': 13480}}
[[ 678 3364  374]
 [ 630 3630  429]
 [ 709 3313  353]]
training model: results/LILAK/W9/deepLOB_L1/h1000
Epoch 1/50
200/200 - 5s - loss: 3.3317 - accuracy1000: 0.3660 - val_loss: 3.4438 - val_accuracy1000: 0.3197 - 5s/epoch - 27ms/step
Epoch 2/50
200/200 - 4s - loss: 3.3285 - accuracy1000: 0.3704 - val_loss: 3.3838 - val_accuracy1000: 0.3331 - 4s/epoch - 18ms/step
Epoch 3/50
200/200 - 3s - loss: 3.3043 - accuracy1000: 0.3776 - val_loss: 3.3850 - val_accuracy1000: 0.3298 - 3s/epoch - 17ms/step
Epoch 4/50
200/200 - 3s - loss: 3.3141 - accuracy1000: 0.3652 - val_loss: 3.3643 - val_accuracy1000: 0.3255 - 3s/epoch - 17ms/step
Epoch 5/50
200/200 - 3s - loss: 3.3104 - accuracy1000: 0.3628 - val_loss: 3.3625 - val_accuracy1000: 0.3135 - 3s/epoch - 17ms/step
Epoch 6/50
200/200 - 3s - loss: 3.2782 - accuracy1000: 0.3859 - val_loss: 3.3706 - val_accuracy1000: 0.3072 - 3s/epoch - 17ms/step
Epoch 7/50
200/200 - 3s - loss: 3.2821 - accuracy1000: 0.3809 - val_loss: 3.3879 - val_accuracy1000: 0.3083 - 3s/epoch - 17ms/step
Epoch 8/50
200/200 - 3s - loss: 3.2548 - accuracy1000: 0.3935 - val_loss: 3.4198 - val_accuracy1000: 0.3058 - 3s/epoch - 17ms/step
Epoch 9/50
200/200 - 3s - loss: 3.2216 - accuracy1000: 0.4115 - val_loss: 3.4551 - val_accuracy1000: 0.3085 - 3s/epoch - 17ms/step
Epoch 10/50
200/200 - 3s - loss: 3.2013 - accuracy1000: 0.4315 - val_loss: 3.4600 - val_accuracy1000: 0.3097 - 3s/epoch - 17ms/step
Epoch 11/50
200/200 - 3s - loss: 3.1765 - accuracy1000: 0.4364 - val_loss: 3.4914 - val_accuracy1000: 0.3088 - 3s/epoch - 17ms/step
Epoch 12/50
200/200 - 3s - loss: 3.1594 - accuracy1000: 0.4460 - val_loss: 3.4996 - val_accuracy1000: 0.3065 - 3s/epoch - 17ms/step
Epoch 13/50
200/200 - 3s - loss: 3.1363 - accuracy1000: 0.4531 - val_loss: 3.4225 - val_accuracy1000: 0.2989 - 3s/epoch - 17ms/step
Epoch 14/50
200/200 - 3s - loss: 3.1478 - accuracy1000: 0.4485 - val_loss: 3.5232 - val_accuracy1000: 0.3080 - 3s/epoch - 17ms/step
Epoch 15/50
200/200 - 3s - loss: 3.1320 - accuracy1000: 0.4570 - val_loss: 3.5283 - val_accuracy1000: 0.3071 - 3s/epoch - 17ms/step
testing model: results/LILAK/W9/deepLOB_L1/h1000
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1129377
{'0': {'precision': 0.3762740867494978, 'recall': 0.6830767152890329, 'f1-score': 0.48524826097385465, 'support': 29616}, '1': {'precision': 0.3141098948973479, 'recall': 0.2508698677800974, 'f1-score': 0.27895055011485914, 'support': 22992}, '2': {'precision': 0.2198952879581152, 'recall': 0.03136255820082579, 'f1-score': 0.054895629108522664, 'support': 22766}, 'accuracy': 0.3543927614296707, 'macro avg': {'precision': 0.30342642320165364, 'recall': 0.32176971375665203, 'f1-score': 0.27303148006574546, 'support': 75374}, 'weighted avg': {'precision': 0.31007886250308336, 'recall': 0.3543927614296707, 'f1-score': 0.2923355193770683, 'support': 75374}}
[[20230  7791  1595]
 [16286  5768   938]
 [17248  4804   714]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.131163
{'0': {'precision': 0.31537109225712756, 'recall': 0.2513860963870103, 'f1-score': 0.2797667480336317, 'support': 16413}, '1': {'precision': 0.3555666168906587, 'recall': 0.2608325219084713, 'f1-score': 0.3009197500526574, 'support': 16432}, '2': {'precision': 0.3587257617728532, 'recall': 0.5099540581929556, 'f1-score': 0.42117625801788783, 'support': 18284}, 'accuracy': 0.3468872851023881, 'macro avg': {'precision': 0.34322115697354655, 'recall': 0.3407242254961457, 'f1-score': 0.3339542520347257, 'support': 51129}, 'weighted avg': {'precision': 0.34379311573115817, 'recall': 0.3468872851023881, 'f1-score': 0.3371337532504122, 'support': 51129}}
[[4126 3645 8642]
 [4120 4286 8026]
 [4837 4123 9324]]
Evaluating performance on  val set...
53/53 - 0s - 434ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1266078
{'0': {'precision': 0.3122957286148991, 'recall': 0.6487941933973308, 'f1-score': 0.4216372489348752, 'support': 4271}, '1': {'precision': 0.3368046040010962, 'recall': 0.2684578418523373, 'f1-score': 0.2987723349945302, 'support': 4578}, '2': {'precision': 0.278705636743215, 'recall': 0.05765493413949471, 'f1-score': 0.09554482018250134, 'support': 4631}, 'accuracy': 0.31654302670623147, 'macro avg': {'precision': 0.3092686564530701, 'recall': 0.3249689897963876, 'f1-score': 0.2719848013706356, 'support': 13480}, 'weighted avg': {'precision': 0.30907955028108913, 'recall': 0.31654302670623147, 'f1-score': 0.26788282656312873, 'support': 13480}}
[[2771 1194  306]
 [2964 1229  385]
 [3138 1226  267]]
training model: results/LILAK/W9/deepOF_L1/h10
Epoch 1/50
200/200 - 6s - loss: 3.3039 - accuracy10: 0.3776 - val_loss: 3.3009 - val_accuracy10: 0.3277 - 6s/epoch - 29ms/step
Epoch 2/50
200/200 - 3s - loss: 3.2621 - accuracy10: 0.4017 - val_loss: 3.2873 - val_accuracy10: 0.3489 - 3s/epoch - 16ms/step
Epoch 3/50
200/200 - 3s - loss: 3.2404 - accuracy10: 0.4088 - val_loss: 3.2783 - val_accuracy10: 0.3555 - 3s/epoch - 16ms/step
Epoch 4/50
200/200 - 3s - loss: 3.2204 - accuracy10: 0.4178 - val_loss: 3.2715 - val_accuracy10: 0.3550 - 3s/epoch - 16ms/step
Epoch 5/50
200/200 - 3s - loss: 3.2034 - accuracy10: 0.4268 - val_loss: 3.2578 - val_accuracy10: 0.3605 - 3s/epoch - 16ms/step
Epoch 6/50
200/200 - 3s - loss: 3.1923 - accuracy10: 0.4311 - val_loss: 3.2426 - val_accuracy10: 0.3694 - 3s/epoch - 16ms/step
Epoch 7/50
200/200 - 3s - loss: 3.1833 - accuracy10: 0.4353 - val_loss: 3.2481 - val_accuracy10: 0.3662 - 3s/epoch - 15ms/step
Epoch 8/50
200/200 - 3s - loss: 3.1751 - accuracy10: 0.4397 - val_loss: 3.2359 - val_accuracy10: 0.3754 - 3s/epoch - 16ms/step
Epoch 9/50
200/200 - 3s - loss: 3.1666 - accuracy10: 0.4428 - val_loss: 3.2336 - val_accuracy10: 0.3785 - 3s/epoch - 16ms/step
Epoch 10/50
200/200 - 3s - loss: 3.1609 - accuracy10: 0.4449 - val_loss: 3.2222 - val_accuracy10: 0.3884 - 3s/epoch - 16ms/step
Epoch 11/50
200/200 - 3s - loss: 3.1567 - accuracy10: 0.4484 - val_loss: 3.2267 - val_accuracy10: 0.3878 - 3s/epoch - 15ms/step
Epoch 12/50
200/200 - 3s - loss: 3.1499 - accuracy10: 0.4514 - val_loss: 3.2264 - val_accuracy10: 0.3855 - 3s/epoch - 15ms/step
Epoch 13/50
200/200 - 3s - loss: 3.1423 - accuracy10: 0.4536 - val_loss: 3.2173 - val_accuracy10: 0.3933 - 3s/epoch - 16ms/step
Epoch 14/50
200/200 - 3s - loss: 3.1392 - accuracy10: 0.4535 - val_loss: 3.2226 - val_accuracy10: 0.3883 - 3s/epoch - 15ms/step
Epoch 15/50
200/200 - 3s - loss: 3.1314 - accuracy10: 0.4567 - val_loss: 3.2269 - val_accuracy10: 0.3894 - 3s/epoch - 15ms/step
Epoch 16/50
200/200 - 3s - loss: 3.1284 - accuracy10: 0.4604 - val_loss: 3.2292 - val_accuracy10: 0.3845 - 3s/epoch - 15ms/step
Epoch 17/50
200/200 - 3s - loss: 3.1254 - accuracy10: 0.4628 - val_loss: 3.2273 - val_accuracy10: 0.3847 - 3s/epoch - 15ms/step
Epoch 18/50
200/200 - 3s - loss: 3.1151 - accuracy10: 0.4620 - val_loss: 3.2311 - val_accuracy10: 0.3798 - 3s/epoch - 15ms/step
Epoch 19/50
200/200 - 3s - loss: 3.1099 - accuracy10: 0.4636 - val_loss: 3.2217 - val_accuracy10: 0.3944 - 3s/epoch - 15ms/step
Epoch 20/50
200/200 - 3s - loss: 3.1062 - accuracy10: 0.4654 - val_loss: 3.2243 - val_accuracy10: 0.3910 - 3s/epoch - 15ms/step
Epoch 21/50
200/200 - 3s - loss: 3.0995 - accuracy10: 0.4688 - val_loss: 3.2214 - val_accuracy10: 0.3982 - 3s/epoch - 15ms/step
Epoch 22/50
200/200 - 3s - loss: 3.0918 - accuracy10: 0.4722 - val_loss: 3.2133 - val_accuracy10: 0.4002 - 3s/epoch - 16ms/step
Epoch 23/50
200/200 - 3s - loss: 3.0871 - accuracy10: 0.4750 - val_loss: 3.2251 - val_accuracy10: 0.4013 - 3s/epoch - 15ms/step
Epoch 24/50
200/200 - 3s - loss: 3.0830 - accuracy10: 0.4725 - val_loss: 3.2370 - val_accuracy10: 0.3908 - 3s/epoch - 15ms/step
Epoch 25/50
200/200 - 3s - loss: 3.0727 - accuracy10: 0.4777 - val_loss: 3.2328 - val_accuracy10: 0.3986 - 3s/epoch - 15ms/step
Epoch 26/50
200/200 - 3s - loss: 3.0687 - accuracy10: 0.4805 - val_loss: 3.2289 - val_accuracy10: 0.3940 - 3s/epoch - 15ms/step
Epoch 27/50
200/200 - 3s - loss: 3.0621 - accuracy10: 0.4786 - val_loss: 3.2260 - val_accuracy10: 0.4019 - 3s/epoch - 15ms/step
Epoch 28/50
200/200 - 3s - loss: 3.0593 - accuracy10: 0.4823 - val_loss: 3.2212 - val_accuracy10: 0.4022 - 3s/epoch - 15ms/step
Epoch 29/50
200/200 - 3s - loss: 3.0492 - accuracy10: 0.4847 - val_loss: 3.2247 - val_accuracy10: 0.4048 - 3s/epoch - 15ms/step
Epoch 30/50
200/200 - 3s - loss: 3.0443 - accuracy10: 0.4861 - val_loss: 3.2261 - val_accuracy10: 0.3999 - 3s/epoch - 15ms/step
Epoch 31/50
200/200 - 3s - loss: 3.0379 - accuracy10: 0.4877 - val_loss: 3.2300 - val_accuracy10: 0.4016 - 3s/epoch - 15ms/step
Epoch 32/50
200/200 - 3s - loss: 3.0311 - accuracy10: 0.4905 - val_loss: 3.2310 - val_accuracy10: 0.4082 - 3s/epoch - 15ms/step
testing model: results/LILAK/W9/deepOF_L1/h10
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1035955
{'0': {'precision': 0.32945916627925, 'recall': 0.49728667664670656, 'f1-score': 0.39633862157677896, 'support': 21376}, '1': {'precision': 0.5808188955940562, 'recall': 0.29023053727181347, 'f1-score': 0.3870535328202024, 'support': 30841}, '2': {'precision': 0.38055174406008524, 'recall': 0.4551893923033732, 'f1-score': 0.41453773083957757, 'support': 23153}, 'accuracy': 0.3996284994029455, 'macro avg': {'precision': 0.4302766019777971, 'recall': 0.41423553540729774, 'f1-score': 0.39930996174551964, 'support': 75370}, 'weighted avg': {'precision': 0.44800940994592925, 'recall': 0.3996284994029455, 'f1-score': 0.3981298190614545, 'support': 75370}}
[[10630  3033  7713]
 [12448  8951  9442]
 [ 9187  3427 10539]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0742077
{'0': {'precision': 0.3699128911831129, 'recall': 0.5475508254877882, 'f1-score': 0.441534864530326, 'support': 14658}, '1': {'precision': 0.6066301226833725, 'recall': 0.3150047440473501, 'f1-score': 0.4146791173496699, 'support': 22133}, '2': {'precision': 0.382269305826596, 'recall': 0.47830333472861725, 'f1-score': 0.4249279494251449, 'support': 14334}, 'accuracy': 0.42746210268948653, 'macro avg': {'precision': 0.45293743989769375, 'recall': 0.4469529680879185, 'f1-score': 0.42704731043504696, 'support': 51125}, 'weighted avg': {'precision': 0.47585674120355165, 'recall': 0.42746210268948653, 'f1-score': 0.42525238485370737, 'support': 51125}}
[[8026 2280 4352]
 [8434 6972 6727]
 [5237 2241 6856]]
Evaluating performance on  val set...
53/53 - 0s - 431ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1053548
{'0': {'precision': 0.32619411864694886, 'recall': 0.5240305843801202, 'f1-score': 0.40209533787323204, 'support': 3662}, '1': {'precision': 0.5968161143599741, 'recall': 0.30333553500660504, 'f1-score': 0.40223341361944387, 'support': 6056}, '2': {'precision': 0.3489710112856827, 'recall': 0.41919191919191917, 'f1-score': 0.38087187537736983, 'support': 3762}, 'accuracy': 0.39562314540059346, 'macro avg': {'precision': 0.42399374809753526, 'recall': 0.41551934619288144, 'f1-score': 0.3950668756233486, 'support': 13480}, 'weighted avg': {'precision': 0.4541298364618596, 'recall': 0.39562314540059346, 'f1-score': 0.396234323096498, 'support': 13480}}
[[1919  616 1127]
 [2404 1837 1815]
 [1560  625 1577]]
training model: results/LILAK/W9/deepOF_L1/h20
Epoch 1/50
200/200 - 5s - loss: 3.3129 - accuracy20: 0.3615 - val_loss: 3.3261 - val_accuracy20: 0.3453 - 5s/epoch - 24ms/step
Epoch 2/50
200/200 - 3s - loss: 3.2782 - accuracy20: 0.3804 - val_loss: 3.3263 - val_accuracy20: 0.3433 - 3s/epoch - 15ms/step
Epoch 3/50
200/200 - 3s - loss: 3.2565 - accuracy20: 0.3855 - val_loss: 3.3180 - val_accuracy20: 0.3598 - 3s/epoch - 16ms/step
Epoch 4/50
200/200 - 3s - loss: 3.2375 - accuracy20: 0.3921 - val_loss: 3.3232 - val_accuracy20: 0.3583 - 3s/epoch - 15ms/step
Epoch 5/50
200/200 - 3s - loss: 3.2263 - accuracy20: 0.3993 - val_loss: 3.3080 - val_accuracy20: 0.3625 - 3s/epoch - 17ms/step
Epoch 6/50
200/200 - 3s - loss: 3.2179 - accuracy20: 0.4035 - val_loss: 3.2962 - val_accuracy20: 0.3651 - 3s/epoch - 16ms/step
Epoch 7/50
200/200 - 3s - loss: 3.2097 - accuracy20: 0.4063 - val_loss: 3.3046 - val_accuracy20: 0.3616 - 3s/epoch - 15ms/step
Epoch 8/50
200/200 - 3s - loss: 3.2011 - accuracy20: 0.4098 - val_loss: 3.2961 - val_accuracy20: 0.3711 - 3s/epoch - 16ms/step
Epoch 9/50
200/200 - 3s - loss: 3.1967 - accuracy20: 0.4110 - val_loss: 3.2962 - val_accuracy20: 0.3654 - 3s/epoch - 15ms/step
Epoch 10/50
200/200 - 3s - loss: 3.1935 - accuracy20: 0.4164 - val_loss: 3.2827 - val_accuracy20: 0.3763 - 3s/epoch - 16ms/step
Epoch 11/50
200/200 - 3s - loss: 3.1857 - accuracy20: 0.4183 - val_loss: 3.2866 - val_accuracy20: 0.3668 - 3s/epoch - 15ms/step
Epoch 12/50
200/200 - 3s - loss: 3.1823 - accuracy20: 0.4192 - val_loss: 3.2792 - val_accuracy20: 0.3667 - 3s/epoch - 16ms/step
Epoch 13/50
200/200 - 3s - loss: 3.1746 - accuracy20: 0.4249 - val_loss: 3.2811 - val_accuracy20: 0.3763 - 3s/epoch - 15ms/step
Epoch 14/50
200/200 - 3s - loss: 3.1706 - accuracy20: 0.4252 - val_loss: 3.2775 - val_accuracy20: 0.3722 - 3s/epoch - 16ms/step
Epoch 15/50
200/200 - 3s - loss: 3.1644 - accuracy20: 0.4323 - val_loss: 3.2856 - val_accuracy20: 0.3817 - 3s/epoch - 15ms/step
Epoch 16/50
200/200 - 3s - loss: 3.1592 - accuracy20: 0.4312 - val_loss: 3.2805 - val_accuracy20: 0.3839 - 3s/epoch - 15ms/step
Epoch 17/50
200/200 - 3s - loss: 3.1506 - accuracy20: 0.4363 - val_loss: 3.2779 - val_accuracy20: 0.3812 - 3s/epoch - 15ms/step
Epoch 18/50
200/200 - 3s - loss: 3.1452 - accuracy20: 0.4379 - val_loss: 3.2823 - val_accuracy20: 0.3831 - 3s/epoch - 15ms/step
Epoch 19/50
200/200 - 3s - loss: 3.1455 - accuracy20: 0.4392 - val_loss: 3.2821 - val_accuracy20: 0.3900 - 3s/epoch - 15ms/step
Epoch 20/50
200/200 - 3s - loss: 3.1387 - accuracy20: 0.4401 - val_loss: 3.2760 - val_accuracy20: 0.3921 - 3s/epoch - 16ms/step
Epoch 21/50
200/200 - 3s - loss: 3.1320 - accuracy20: 0.4426 - val_loss: 3.2842 - val_accuracy20: 0.3872 - 3s/epoch - 15ms/step
Epoch 22/50
200/200 - 3s - loss: 3.1266 - accuracy20: 0.4450 - val_loss: 3.2903 - val_accuracy20: 0.3857 - 3s/epoch - 15ms/step
Epoch 23/50
200/200 - 3s - loss: 3.1231 - accuracy20: 0.4487 - val_loss: 3.2983 - val_accuracy20: 0.3829 - 3s/epoch - 15ms/step
Epoch 24/50
200/200 - 3s - loss: 3.1177 - accuracy20: 0.4540 - val_loss: 3.2930 - val_accuracy20: 0.3910 - 3s/epoch - 15ms/step
Epoch 25/50
200/200 - 3s - loss: 3.1104 - accuracy20: 0.4583 - val_loss: 3.3013 - val_accuracy20: 0.3870 - 3s/epoch - 15ms/step
Epoch 26/50
200/200 - 3s - loss: 3.1055 - accuracy20: 0.4578 - val_loss: 3.3044 - val_accuracy20: 0.3884 - 3s/epoch - 15ms/step
Epoch 27/50
200/200 - 3s - loss: 3.0991 - accuracy20: 0.4555 - val_loss: 3.2944 - val_accuracy20: 0.3935 - 3s/epoch - 15ms/step
Epoch 28/50
200/200 - 3s - loss: 3.0905 - accuracy20: 0.4614 - val_loss: 3.3069 - val_accuracy20: 0.3935 - 3s/epoch - 15ms/step
Epoch 29/50
200/200 - 3s - loss: 3.0888 - accuracy20: 0.4620 - val_loss: 3.2909 - val_accuracy20: 0.3966 - 3s/epoch - 15ms/step
Epoch 30/50
200/200 - 3s - loss: 3.0780 - accuracy20: 0.4654 - val_loss: 3.3117 - val_accuracy20: 0.3836 - 3s/epoch - 15ms/step
testing model: results/LILAK/W9/deepOF_L1/h20
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0902315
{'0': {'precision': 0.35411729857819907, 'recall': 0.49513356802650654, 'f1-score': 0.4129177100423107, 'support': 24145}, '1': {'precision': 0.4746997929606625, 'recall': 0.23265819702074117, 'f1-score': 0.3122684680758335, 'support': 24637}, '2': {'precision': 0.40297951582867786, 'recall': 0.447645554385437, 'f1-score': 0.42413983571797653, 'support': 26588}, 'accuracy': 0.3925832559373756, 'macro avg': {'precision': 0.41059886912251314, 'recall': 0.3918124398108949, 'f1-score': 0.3831086712787069, 'support': 75370}, 'weighted avg': {'precision': 0.41077033753742, 'recall': 0.3925832559373756, 'f1-score': 0.38397620152614387, 'support': 75370}}
[[11955  2861  9329]
 [10601  5732  8304]
 [11204  3482 11902]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0653803
{'0': {'precision': 0.3905131522207848, 'recall': 0.5377991567195202, 'f1-score': 0.45247195783057287, 'support': 16839}, '1': {'precision': 0.5171960569550931, 'recall': 0.2648048452220727, 'f1-score': 0.3502707514279356, 'support': 17832}, '2': {'precision': 0.41074182398298326, 'recall': 0.4694299258538957, 'f1-score': 0.4381292719589325, 'support': 16454}, 'accuracy': 0.4205770171149144, 'macro avg': {'precision': 0.4394836777196203, 'recall': 0.4240113092651629, 'f1-score': 0.413623993739147, 'support': 51125}, 'weighted avg': {'precision': 0.4412095262530077, 'recall': 0.4205770171149144, 'f1-score': 0.41220894627255233, 'support': 51125}}
[[9056 2249 5534]
 [7563 4722 5547]
 [6571 2159 7724]]
Evaluating performance on  val set...
53/53 - 0s - 447ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.096264
{'0': {'precision': 0.3490955252300857, 'recall': 0.5192353080009441, 'f1-score': 0.41749691621595975, 'support': 4237}, '1': {'precision': 0.523948354852145, 'recall': 0.25332259363672976, 'f1-score': 0.3415230080086874, 'support': 4966}, '2': {'precision': 0.3807829181494662, 'recall': 0.42529810614916996, 'f1-score': 0.4018113540976364, 'support': 4277}, 'accuracy': 0.39146884272997035, 'macro avg': {'precision': 0.4179422660772323, 'recall': 0.39928533592894794, 'f1-score': 0.3869437594407612, 'support': 13480}, 'weighted avg': {'precision': 0.4235648228131225, 'recall': 0.39146884272997035, 'f1-score': 0.3845315173036909, 'support': 13480}}
[[2200  575 1462]
 [2212 1258 1496]
 [1890  568 1819]]
training model: results/LILAK/W9/deepOF_L1/h30
Epoch 1/50
200/200 - 5s - loss: 3.3223 - accuracy30: 0.3521 - val_loss: 3.3426 - val_accuracy30: 0.3470 - 5s/epoch - 25ms/step
Epoch 2/50
200/200 - 3s - loss: 3.2843 - accuracy30: 0.3723 - val_loss: 3.3586 - val_accuracy30: 0.3480 - 3s/epoch - 15ms/step
Epoch 3/50
200/200 - 3s - loss: 3.2615 - accuracy30: 0.3756 - val_loss: 3.3452 - val_accuracy30: 0.3579 - 3s/epoch - 16ms/step
Epoch 4/50
200/200 - 3s - loss: 3.2488 - accuracy30: 0.3809 - val_loss: 3.3516 - val_accuracy30: 0.3521 - 3s/epoch - 16ms/step
Epoch 5/50
200/200 - 3s - loss: 3.2355 - accuracy30: 0.3895 - val_loss: 3.3454 - val_accuracy30: 0.3594 - 3s/epoch - 16ms/step
Epoch 6/50
200/200 - 3s - loss: 3.2261 - accuracy30: 0.3945 - val_loss: 3.3388 - val_accuracy30: 0.3595 - 3s/epoch - 16ms/step
Epoch 7/50
200/200 - 3s - loss: 3.2191 - accuracy30: 0.3965 - val_loss: 3.3287 - val_accuracy30: 0.3619 - 3s/epoch - 16ms/step
Epoch 8/50
200/200 - 3s - loss: 3.2114 - accuracy30: 0.4015 - val_loss: 3.3348 - val_accuracy30: 0.3607 - 3s/epoch - 15ms/step
Epoch 9/50
200/200 - 3s - loss: 3.2063 - accuracy30: 0.4031 - val_loss: 3.3334 - val_accuracy30: 0.3605 - 3s/epoch - 15ms/step
Epoch 10/50
200/200 - 3s - loss: 3.1976 - accuracy30: 0.4092 - val_loss: 3.3296 - val_accuracy30: 0.3631 - 3s/epoch - 15ms/step
Epoch 11/50
200/200 - 3s - loss: 3.1940 - accuracy30: 0.4088 - val_loss: 3.3277 - val_accuracy30: 0.3622 - 3s/epoch - 16ms/step
Epoch 12/50
200/200 - 3s - loss: 3.1913 - accuracy30: 0.4125 - val_loss: 3.3226 - val_accuracy30: 0.3659 - 3s/epoch - 16ms/step
Epoch 13/50
200/200 - 3s - loss: 3.1846 - accuracy30: 0.4148 - val_loss: 3.3234 - val_accuracy30: 0.3635 - 3s/epoch - 15ms/step
Epoch 14/50
200/200 - 3s - loss: 3.1804 - accuracy30: 0.4165 - val_loss: 3.3261 - val_accuracy30: 0.3708 - 3s/epoch - 15ms/step
Epoch 15/50
200/200 - 3s - loss: 3.1764 - accuracy30: 0.4197 - val_loss: 3.3239 - val_accuracy30: 0.3706 - 3s/epoch - 15ms/step
Epoch 16/50
200/200 - 3s - loss: 3.1703 - accuracy30: 0.4200 - val_loss: 3.3253 - val_accuracy30: 0.3739 - 3s/epoch - 15ms/step
Epoch 17/50
200/200 - 3s - loss: 3.1683 - accuracy30: 0.4237 - val_loss: 3.3223 - val_accuracy30: 0.3764 - 3s/epoch - 16ms/step
Epoch 18/50
200/200 - 3s - loss: 3.1634 - accuracy30: 0.4268 - val_loss: 3.3311 - val_accuracy30: 0.3703 - 3s/epoch - 15ms/step
Epoch 19/50
200/200 - 3s - loss: 3.1613 - accuracy30: 0.4276 - val_loss: 3.3284 - val_accuracy30: 0.3746 - 3s/epoch - 15ms/step
Epoch 20/50
200/200 - 3s - loss: 3.1555 - accuracy30: 0.4316 - val_loss: 3.3369 - val_accuracy30: 0.3713 - 3s/epoch - 15ms/step
Epoch 21/50
200/200 - 3s - loss: 3.1488 - accuracy30: 0.4329 - val_loss: 3.3416 - val_accuracy30: 0.3745 - 3s/epoch - 15ms/step
Epoch 22/50
200/200 - 3s - loss: 3.1481 - accuracy30: 0.4342 - val_loss: 3.3433 - val_accuracy30: 0.3778 - 3s/epoch - 15ms/step
Epoch 23/50
200/200 - 3s - loss: 3.1439 - accuracy30: 0.4371 - val_loss: 3.3455 - val_accuracy30: 0.3712 - 3s/epoch - 16ms/step
Epoch 24/50
200/200 - 3s - loss: 3.1382 - accuracy30: 0.4392 - val_loss: 3.3601 - val_accuracy30: 0.3772 - 3s/epoch - 15ms/step
Epoch 25/50
200/200 - 3s - loss: 3.1321 - accuracy30: 0.4429 - val_loss: 3.3527 - val_accuracy30: 0.3770 - 3s/epoch - 15ms/step
Epoch 26/50
200/200 - 3s - loss: 3.1258 - accuracy30: 0.4461 - val_loss: 3.3588 - val_accuracy30: 0.3789 - 3s/epoch - 15ms/step
Epoch 27/50
200/200 - 3s - loss: 3.1221 - accuracy30: 0.4477 - val_loss: 3.3576 - val_accuracy30: 0.3762 - 3s/epoch - 15ms/step
testing model: results/LILAK/W9/deepOF_L1/h30
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0905112
{'0': {'precision': 0.3567974207415368, 'recall': 0.5267124102645461, 'f1-score': 0.4254160460013134, 'support': 25213}, '1': {'precision': 0.44671891449292317, 'recall': 0.1692444050520718, 'f1-score': 0.24548434788198242, 'support': 22565}, '2': {'precision': 0.40569575352184045, 'recall': 0.4352348506813569, 'f1-score': 0.4199464969489273, 'support': 27592}, 'accuracy': 0.3862014063951174, 'macro avg': {'precision': 0.4030706962521002, 'recall': 0.3770638886659916, 'f1-score': 0.3636156302774077, 'support': 75370}, 'weighted avg': {'precision': 0.40162004651537486, 'recall': 0.3862014063951174, 'f1-score': 0.36954402045379925, 'support': 75370}}
[[13280  2179  9754]
 [10908  3819  7838]
 [13032  2551 12009]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0701822
{'0': {'precision': 0.3888310648518815, 'recall': 0.5545849035057668, 'f1-score': 0.45714689132583425, 'support': 17514}, '1': {'precision': 0.49229021262782013, 'recall': 0.183617871413004, 'f1-score': 0.26747211076326116, 'support': 16518}, '2': {'precision': 0.41047838270616493, 'recall': 0.47990405429123034, 'f1-score': 0.44248455916066565, 'support': 17093}, 'accuracy': 0.409760391198044, 'macro avg': {'precision': 0.43053322006195555, 'recall': 0.4060356097366671, 'f1-score': 0.38903452041658704, 'support': 51125}, 'weighted avg': {'precision': 0.4294952371168443, 'recall': 0.409760391198044, 'f1-score': 0.3909626122249676, 'support': 51125}}
[[9713 1656 6145]
 [7849 3033 5636]
 [7418 1472 8203]]
Evaluating performance on  val set...
53/53 - 0s - 422ms/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1030446
{'0': {'precision': 0.35906720741599074, 'recall': 0.5599728936074091, 'f1-score': 0.43756067425646455, 'support': 4427}, '1': {'precision': 0.5041374920432845, 'recall': 0.1683673469387755, 'f1-score': 0.2524302788844621, 'support': 4704}, '2': {'precision': 0.3674325674325674, 'recall': 0.42285582892618995, 'f1-score': 0.39320076972418216, 'support': 4349}, 'accuracy': 0.37908011869436203, 'macro avg': {'precision': 0.4102124222972809, 'recall': 0.3837320231574582, 'f1-score': 0.361063907621703, 'support': 13480}, 'weighted avg': {'precision': 0.41239002415181275, 'recall': 0.37908011869436203, 'f1-score': 0.3586456442386014, 'support': 13480}}
[[2479  394 1554]
 [2300  792 1612]
 [2125  385 1839]]
training model: results/LILAK/W9/deepOF_L1/h50
Epoch 1/50
200/200 - 5s - loss: 3.3326 - accuracy50: 0.3431 - val_loss: 3.3328 - val_accuracy50: 0.3499 - 5s/epoch - 26ms/step
Epoch 2/50
200/200 - 3s - loss: 3.2961 - accuracy50: 0.3637 - val_loss: 3.3338 - val_accuracy50: 0.3454 - 3s/epoch - 16ms/step
Epoch 3/50
200/200 - 3s - loss: 3.2755 - accuracy50: 0.3670 - val_loss: 3.3202 - val_accuracy50: 0.3528 - 3s/epoch - 16ms/step
Epoch 4/50
200/200 - 3s - loss: 3.2599 - accuracy50: 0.3757 - val_loss: 3.3246 - val_accuracy50: 0.3542 - 3s/epoch - 16ms/step
Epoch 5/50
200/200 - 3s - loss: 3.2491 - accuracy50: 0.3832 - val_loss: 3.3113 - val_accuracy50: 0.3636 - 3s/epoch - 16ms/step
Epoch 6/50
200/200 - 3s - loss: 3.2411 - accuracy50: 0.3857 - val_loss: 3.3069 - val_accuracy50: 0.3612 - 3s/epoch - 16ms/step
Epoch 7/50
200/200 - 3s - loss: 3.2365 - accuracy50: 0.3889 - val_loss: 3.3129 - val_accuracy50: 0.3554 - 3s/epoch - 16ms/step
Epoch 8/50
200/200 - 3s - loss: 3.2303 - accuracy50: 0.3921 - val_loss: 3.3055 - val_accuracy50: 0.3614 - 3s/epoch - 16ms/step
Epoch 9/50
200/200 - 3s - loss: 3.2255 - accuracy50: 0.3938 - val_loss: 3.3084 - val_accuracy50: 0.3627 - 3s/epoch - 16ms/step
Epoch 10/50
200/200 - 3s - loss: 3.2187 - accuracy50: 0.3953 - val_loss: 3.3113 - val_accuracy50: 0.3629 - 3s/epoch - 16ms/step
Epoch 11/50
200/200 - 3s - loss: 3.2172 - accuracy50: 0.3964 - val_loss: 3.3075 - val_accuracy50: 0.3596 - 3s/epoch - 17ms/step
Epoch 12/50
200/200 - 3s - loss: 3.2127 - accuracy50: 0.3986 - val_loss: 3.3009 - val_accuracy50: 0.3662 - 3s/epoch - 16ms/step
Epoch 13/50
200/200 - 3s - loss: 3.2056 - accuracy50: 0.3999 - val_loss: 3.3049 - val_accuracy50: 0.3637 - 3s/epoch - 16ms/step
Epoch 14/50
200/200 - 3s - loss: 3.2009 - accuracy50: 0.4055 - val_loss: 3.3132 - val_accuracy50: 0.3594 - 3s/epoch - 16ms/step
Epoch 15/50
200/200 - 3s - loss: 3.1956 - accuracy50: 0.4088 - val_loss: 3.3065 - val_accuracy50: 0.3593 - 3s/epoch - 16ms/step
Epoch 16/50
200/200 - 3s - loss: 3.1916 - accuracy50: 0.4127 - val_loss: 3.3146 - val_accuracy50: 0.3639 - 3s/epoch - 15ms/step
Epoch 17/50
200/200 - 3s - loss: 3.1900 - accuracy50: 0.4127 - val_loss: 3.3236 - val_accuracy50: 0.3571 - 3s/epoch - 15ms/step
Epoch 18/50
200/200 - 3s - loss: 3.1837 - accuracy50: 0.4145 - val_loss: 3.3245 - val_accuracy50: 0.3596 - 3s/epoch - 16ms/step
Epoch 19/50
200/200 - 3s - loss: 3.1837 - accuracy50: 0.4142 - val_loss: 3.3216 - val_accuracy50: 0.3600 - 3s/epoch - 16ms/step
Epoch 20/50
200/200 - 3s - loss: 3.1788 - accuracy50: 0.4182 - val_loss: 3.3172 - val_accuracy50: 0.3602 - 3s/epoch - 16ms/step
Epoch 21/50
200/200 - 3s - loss: 3.1730 - accuracy50: 0.4200 - val_loss: 3.3262 - val_accuracy50: 0.3618 - 3s/epoch - 16ms/step
Epoch 22/50
200/200 - 3s - loss: 3.1697 - accuracy50: 0.4225 - val_loss: 3.3275 - val_accuracy50: 0.3551 - 3s/epoch - 15ms/step
testing model: results/LILAK/W9/deepOF_L1/h50
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.099335
{'0': {'precision': 0.3414866365923877, 'recall': 0.6132302055770406, 'f1-score': 0.4386848772532688, 'support': 24565}, '1': {'precision': 0.3756476683937824, 'recall': 0.049284105875855036, 'f1-score': 0.08713615023474178, 'support': 23537}, '2': {'precision': 0.4082857041428521, 'recall': 0.4217764412498166, 'f1-score': 0.414921442357992, 'support': 27268}, 'accuracy': 0.3678519304763168, 'macro avg': {'precision': 0.3751400030430074, 'recall': 0.36143025090090414, 'f1-score': 0.3135808232820009, 'support': 75370}, 'weighted avg': {'precision': 0.3763217855837037, 'recall': 0.3678519304763168, 'f1-score': 0.3203037742871089, 'support': 75370}}
[[15064  1038  8463]
 [14172  1160  8205]
 [14877   890 11501]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0776217
{'0': {'precision': 0.3739294926913156, 'recall': 0.6255466052934407, 'f1-score': 0.46806587019696483, 'support': 17380}, '1': {'precision': 0.5605897159295218, 'recall': 0.09290822407628128, 'f1-score': 0.15939880374213997, 'support': 16780}, '2': {'precision': 0.3960765997197571, 'recall': 0.449867374005305, 'f1-score': 0.4212617983109786, 'support': 16965}, 'accuracy': 0.39243031784841076, 'macro avg': {'precision': 0.4435319361135315, 'recall': 0.3894407344583424, 'f1-score': 0.34957549075002775, 'support': 51125}, 'weighted avg': {'precision': 0.4425433649001099, 'recall': 0.39243031784841076, 'f1-score': 0.35122548966576256, 'support': 51125}}
[[10872   639  5869]
 [ 9453  1559  5768]
 [ 8750   583  7632]]
Evaluating performance on  val set...
53/53 - 0s - 431ms/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0991249
{'0': {'precision': 0.3518779643635431, 'recall': 0.6259977194982896, 'f1-score': 0.4505169867060561, 'support': 4385}, '1': {'precision': 0.564935064935065, 'recall': 0.07248489897937929, 'f1-score': 0.12848440095994093, 'support': 4801}, '2': {'precision': 0.3557179537823425, 'recall': 0.41942244993013506, 'f1-score': 0.38495244202201556, 'support': 4294}, 'accuracy': 0.36305637982195843, 'macro avg': {'precision': 0.42417699436031686, 'recall': 0.37263502280260136, 'f1-score': 0.32131794322933754, 'support': 13480}, 'weighted avg': {'precision': 0.4289830129101455, 'recall': 0.36305637982195843, 'f1-score': 0.3149374170443076, 'support': 13480}}
[[2745  142 1498]
 [2689  348 1764]
 [2367  126 1801]]
training model: results/LILAK/W9/deepOF_L1/h100
Epoch 1/50
200/200 - 5s - loss: 3.3286 - accuracy100: 0.3449 - val_loss: 3.3304 - val_accuracy100: 0.3454 - 5s/epoch - 26ms/step
Epoch 2/50
200/200 - 3s - loss: 3.3004 - accuracy100: 0.3543 - val_loss: 3.3290 - val_accuracy100: 0.3501 - 3s/epoch - 16ms/step
Epoch 3/50
200/200 - 3s - loss: 3.2793 - accuracy100: 0.3625 - val_loss: 3.3145 - val_accuracy100: 0.3546 - 3s/epoch - 16ms/step
Epoch 4/50
200/200 - 3s - loss: 3.2627 - accuracy100: 0.3714 - val_loss: 3.3154 - val_accuracy100: 0.3532 - 3s/epoch - 15ms/step
Epoch 5/50
200/200 - 3s - loss: 3.2513 - accuracy100: 0.3775 - val_loss: 3.3205 - val_accuracy100: 0.3461 - 3s/epoch - 15ms/step
Epoch 6/50
200/200 - 3s - loss: 3.2485 - accuracy100: 0.3791 - val_loss: 3.3187 - val_accuracy100: 0.3522 - 3s/epoch - 15ms/step
Epoch 7/50
200/200 - 3s - loss: 3.2438 - accuracy100: 0.3763 - val_loss: 3.3012 - val_accuracy100: 0.3613 - 3s/epoch - 16ms/step
Epoch 8/50
200/200 - 3s - loss: 3.2351 - accuracy100: 0.3853 - val_loss: 3.3083 - val_accuracy100: 0.3590 - 3s/epoch - 15ms/step
Epoch 9/50
200/200 - 3s - loss: 3.2325 - accuracy100: 0.3875 - val_loss: 3.3093 - val_accuracy100: 0.3559 - 3s/epoch - 15ms/step
Epoch 10/50
200/200 - 3s - loss: 3.2250 - accuracy100: 0.3903 - val_loss: 3.3132 - val_accuracy100: 0.3522 - 3s/epoch - 15ms/step
Epoch 11/50
200/200 - 3s - loss: 3.2240 - accuracy100: 0.3933 - val_loss: 3.3114 - val_accuracy100: 0.3544 - 3s/epoch - 15ms/step
Epoch 12/50
200/200 - 3s - loss: 3.2199 - accuracy100: 0.3945 - val_loss: 3.3069 - val_accuracy100: 0.3605 - 3s/epoch - 15ms/step
Epoch 13/50
200/200 - 3s - loss: 3.2170 - accuracy100: 0.3951 - val_loss: 3.3145 - val_accuracy100: 0.3521 - 3s/epoch - 15ms/step
Epoch 14/50
200/200 - 3s - loss: 3.2142 - accuracy100: 0.3975 - val_loss: 3.3120 - val_accuracy100: 0.3539 - 3s/epoch - 15ms/step
Epoch 15/50
200/200 - 3s - loss: 3.2070 - accuracy100: 0.4026 - val_loss: 3.3124 - val_accuracy100: 0.3536 - 3s/epoch - 15ms/step
Epoch 16/50
200/200 - 3s - loss: 3.2047 - accuracy100: 0.4039 - val_loss: 3.3082 - val_accuracy100: 0.3561 - 3s/epoch - 15ms/step
Epoch 17/50
200/200 - 3s - loss: 3.2019 - accuracy100: 0.4047 - val_loss: 3.3179 - val_accuracy100: 0.3553 - 3s/epoch - 15ms/step
testing model: results/LILAK/W9/deepOF_L1/h100
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1038069
{'0': {'precision': 0.32957179119302504, 'recall': 0.5097077021548965, 'f1-score': 0.4003083161581126, 'support': 23435}, '1': {'precision': 0.38245412844036697, 'recall': 0.12022783806193446, 'f1-score': 0.1829452261444362, 'support': 27739}, '2': {'precision': 0.35890942577122936, 'recall': 0.4510249628037692, 'f1-score': 0.399728947657595, 'support': 24196}, 'accuracy': 0.3475255406660475, 'macro avg': {'precision': 0.3569784484682071, 'recall': 0.3603201676735334, 'f1-score': 0.3276608299867146, 'support': 75370}, 'weighted avg': {'precision': 0.35845273267051275, 'recall': 0.3475255406660475, 'f1-score': 0.3201245141927697, 'support': 75370}}
[[11945  2839  8651]
 [13562  3335 10842]
 [10737  2546 10913]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0796267
{'0': {'precision': 0.38283284816914354, 'recall': 0.5697429174029528, 'f1-score': 0.4579505624155232, 'support': 17543}, '1': {'precision': 0.4371671991480298, 'recall': 0.14979018427294288, 'f1-score': 0.2231281424106536, 'support': 16443}, '2': {'precision': 0.38280967858432646, 'recall': 0.4329307427504522, 'f1-score': 0.40633043097311206, 'support': 17139}, 'accuracy': 0.3888117359413203, 'macro avg': {'precision': 0.4009365753004999, 'recall': 0.38415461480878266, 'f1-score': 0.36246971193309624, 'support': 51125}, 'weighted avg': {'precision': 0.400300283467562, 'recall': 0.3888117359413203, 'f1-score': 0.3651211739572042, 'support': 51125}}
[[9995 1577 5971]
 [7988 2463 5992]
 [8125 1594 7420]]
Evaluating performance on  val set...
53/53 - 0s - 426ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0963174
{'0': {'precision': 0.352897363324892, 'recall': 0.537431941923775, 'f1-score': 0.4260408236669365, 'support': 4408}, '1': {'precision': 0.4444444444444444, 'recall': 0.13265097236438075, 'f1-score': 0.20431972252877187, 'support': 4885}, '2': {'precision': 0.33998869843661705, 'recall': 0.4310962502985431, 'f1-score': 0.38016006739679864, 'support': 4187}, 'accuracy': 0.35771513353115725, 'macro avg': {'precision': 0.37911016873531783, 'recall': 0.3670597215288996, 'f1-score': 0.3368402045308357, 'support': 13480}, 'weighted avg': {'precision': 0.38206345467369074, 'recall': 0.35771513353115725, 'f1-score': 0.3314406526311055, 'support': 13480}}
[[2369  421 1618]
 [2351  648 1886]
 [1993  389 1805]]
training model: results/LILAK/W9/deepOF_L1/h200
Epoch 1/50
200/200 - 5s - loss: 3.3300 - accuracy200: 0.3448 - val_loss: 3.3175 - val_accuracy200: 0.3442 - 5s/epoch - 25ms/step
Epoch 2/50
200/200 - 3s - loss: 3.3023 - accuracy200: 0.3509 - val_loss: 3.3055 - val_accuracy200: 0.3486 - 3s/epoch - 16ms/step
Epoch 3/50
200/200 - 3s - loss: 3.2790 - accuracy200: 0.3607 - val_loss: 3.2976 - val_accuracy200: 0.3533 - 3s/epoch - 16ms/step
Epoch 4/50
200/200 - 3s - loss: 3.2711 - accuracy200: 0.3673 - val_loss: 3.2921 - val_accuracy200: 0.3606 - 3s/epoch - 16ms/step
Epoch 5/50
200/200 - 3s - loss: 3.2645 - accuracy200: 0.3681 - val_loss: 3.2931 - val_accuracy200: 0.3570 - 3s/epoch - 15ms/step
Epoch 6/50
200/200 - 3s - loss: 3.2572 - accuracy200: 0.3686 - val_loss: 3.2935 - val_accuracy200: 0.3543 - 3s/epoch - 16ms/step
Epoch 7/50
200/200 - 3s - loss: 3.2518 - accuracy200: 0.3739 - val_loss: 3.2893 - val_accuracy200: 0.3554 - 3s/epoch - 16ms/step
Epoch 8/50
200/200 - 3s - loss: 3.2462 - accuracy200: 0.3782 - val_loss: 3.2906 - val_accuracy200: 0.3593 - 3s/epoch - 15ms/step
Epoch 9/50
200/200 - 3s - loss: 3.2438 - accuracy200: 0.3787 - val_loss: 3.2966 - val_accuracy200: 0.3545 - 3s/epoch - 15ms/step
Epoch 10/50
200/200 - 3s - loss: 3.2371 - accuracy200: 0.3836 - val_loss: 3.2953 - val_accuracy200: 0.3564 - 3s/epoch - 15ms/step
Epoch 11/50
200/200 - 3s - loss: 3.2341 - accuracy200: 0.3854 - val_loss: 3.2921 - val_accuracy200: 0.3572 - 3s/epoch - 15ms/step
Epoch 12/50
200/200 - 3s - loss: 3.2319 - accuracy200: 0.3856 - val_loss: 3.2854 - val_accuracy200: 0.3625 - 3s/epoch - 15ms/step
Epoch 13/50
200/200 - 3s - loss: 3.2275 - accuracy200: 0.3894 - val_loss: 3.2891 - val_accuracy200: 0.3601 - 3s/epoch - 15ms/step
Epoch 14/50
200/200 - 3s - loss: 3.2268 - accuracy200: 0.3916 - val_loss: 3.2891 - val_accuracy200: 0.3608 - 3s/epoch - 16ms/step
Epoch 15/50
200/200 - 3s - loss: 3.2233 - accuracy200: 0.3931 - val_loss: 3.2957 - val_accuracy200: 0.3651 - 3s/epoch - 15ms/step
Epoch 16/50
200/200 - 3s - loss: 3.2207 - accuracy200: 0.3967 - val_loss: 3.2910 - val_accuracy200: 0.3655 - 3s/epoch - 15ms/step
Epoch 17/50
200/200 - 3s - loss: 3.2178 - accuracy200: 0.3980 - val_loss: 3.2996 - val_accuracy200: 0.3616 - 3s/epoch - 15ms/step
Epoch 18/50
200/200 - 3s - loss: 3.2170 - accuracy200: 0.4001 - val_loss: 3.2956 - val_accuracy200: 0.3612 - 3s/epoch - 15ms/step
Epoch 19/50
200/200 - 3s - loss: 3.2122 - accuracy200: 0.4019 - val_loss: 3.2950 - val_accuracy200: 0.3595 - 3s/epoch - 15ms/step
Epoch 20/50
200/200 - 3s - loss: 3.2065 - accuracy200: 0.4062 - val_loss: 3.3046 - val_accuracy200: 0.3613 - 3s/epoch - 15ms/step
Epoch 21/50
200/200 - 3s - loss: 3.2071 - accuracy200: 0.4059 - val_loss: 3.3004 - val_accuracy200: 0.3674 - 3s/epoch - 15ms/step
Epoch 22/50
200/200 - 3s - loss: 3.2039 - accuracy200: 0.4075 - val_loss: 3.3047 - val_accuracy200: 0.3608 - 3s/epoch - 15ms/step
testing model: results/LILAK/W9/deepOF_L1/h200
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1052831
{'0': {'precision': 0.40460852329038655, 'recall': 0.23373649180562514, 'f1-score': 0.29630301655704244, 'support': 27946}, '1': {'precision': 0.29286247732849674, 'recall': 0.5068784045794479, 'f1-score': 0.3712344051120804, 'support': 21662}, '2': {'precision': 0.37857734425324374, 'recall': 0.3193851409052092, 'f1-score': 0.34647128179215086, 'support': 25762}, 'accuracy': 0.3415151917208438, 'macro avg': {'precision': 0.3586827816240423, 'recall': 0.3533333457634274, 'f1-score': 0.3380029011537579, 'support': 75370}, 'weighted avg': {'precision': 0.363594086750897, 'recall': 0.3415151917208438, 'f1-score': 0.3349868242771711, 'support': 75370}}
[[ 6532 13801  7613]
 [ 4789 10980  5893]
 [ 4823 12711  8228]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0814282
{'0': {'precision': 0.3922723239493426, 'recall': 0.2845357205546779, 'f1-score': 0.3298290830168204, 'support': 17091}, '1': {'precision': 0.3598789051002817, 'recall': 0.5081636288072197, 'f1-score': 0.4213557820115198, 'support': 16843}, '2': {'precision': 0.3870859819337571, 'recall': 0.33651329183875284, 'f1-score': 0.36003236245954695, 'support': 17191}, 'accuracy': 0.37568704156479216, 'macro avg': {'precision': 0.3797457369944605, 'recall': 0.37640421373355015, 'f1-score': 0.37040574249596236, 'support': 51125}, 'weighted avg': {'precision': 0.3798564655774176, 'recall': 0.37568704156479216, 'f1-score': 0.3701383009741336, 'support': 51125}}
[[4863 7548 4680]
 [3804 8559 4480]
 [3730 7676 5785]]
Evaluating performance on  val set...
53/53 - 0s - 429ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0945396
{'0': {'precision': 0.3629918468628146, 'recall': 0.23235761288858633, 'f1-score': 0.28334255672385167, 'support': 4407}, '1': {'precision': 0.37984381906586123, 'recall': 0.5230269831608846, 'f1-score': 0.4400819392284056, 'support': 4929}, '2': {'precision': 0.3442665289256198, 'recall': 0.3216698841698842, 'f1-score': 0.33258483033932135, 'support': 4144}, 'accuracy': 0.3660979228486647, 'macro avg': {'precision': 0.3623673982847652, 'recall': 0.3590181600731184, 'f1-score': 0.35200310876385954, 'support': 13480}, 'weighted avg': {'precision': 0.3633973107691263, 'recall': 0.3660979228486647, 'f1-score': 0.3557927346339001, 'support': 13480}}
[[1024 2177 1206]
 [1018 2578 1333]
 [ 779 2032 1333]]
training model: results/LILAK/W9/deepOF_L1/h300
Epoch 1/50
200/200 - 5s - loss: 3.3310 - accuracy300: 0.3458 - val_loss: 3.3236 - val_accuracy300: 0.3335 - 5s/epoch - 26ms/step
Epoch 2/50
200/200 - 3s - loss: 3.3007 - accuracy300: 0.3542 - val_loss: 3.3202 - val_accuracy300: 0.3387 - 3s/epoch - 16ms/step
Epoch 3/50
200/200 - 3s - loss: 3.2857 - accuracy300: 0.3557 - val_loss: 3.3044 - val_accuracy300: 0.3412 - 3s/epoch - 17ms/step
Epoch 4/50
200/200 - 3s - loss: 3.2731 - accuracy300: 0.3639 - val_loss: 3.3021 - val_accuracy300: 0.3410 - 3s/epoch - 16ms/step
Epoch 5/50
200/200 - 3s - loss: 3.2676 - accuracy300: 0.3628 - val_loss: 3.2974 - val_accuracy300: 0.3439 - 3s/epoch - 16ms/step
Epoch 6/50
200/200 - 3s - loss: 3.2613 - accuracy300: 0.3666 - val_loss: 3.2946 - val_accuracy300: 0.3467 - 3s/epoch - 16ms/step
Epoch 7/50
200/200 - 3s - loss: 3.2571 - accuracy300: 0.3699 - val_loss: 3.2965 - val_accuracy300: 0.3433 - 3s/epoch - 15ms/step
Epoch 8/50
200/200 - 3s - loss: 3.2482 - accuracy300: 0.3791 - val_loss: 3.2961 - val_accuracy300: 0.3495 - 3s/epoch - 15ms/step
Epoch 9/50
200/200 - 3s - loss: 3.2475 - accuracy300: 0.3752 - val_loss: 3.3006 - val_accuracy300: 0.3385 - 3s/epoch - 15ms/step
Epoch 10/50
200/200 - 3s - loss: 3.2452 - accuracy300: 0.3814 - val_loss: 3.2972 - val_accuracy300: 0.3401 - 3s/epoch - 15ms/step
Epoch 11/50
200/200 - 3s - loss: 3.2428 - accuracy300: 0.3790 - val_loss: 3.3030 - val_accuracy300: 0.3409 - 3s/epoch - 15ms/step
Epoch 12/50
200/200 - 3s - loss: 3.2413 - accuracy300: 0.3817 - val_loss: 3.2935 - val_accuracy300: 0.3445 - 3s/epoch - 16ms/step
Epoch 13/50
200/200 - 3s - loss: 3.2372 - accuracy300: 0.3832 - val_loss: 3.2949 - val_accuracy300: 0.3443 - 3s/epoch - 15ms/step
Epoch 14/50
200/200 - 3s - loss: 3.2324 - accuracy300: 0.3882 - val_loss: 3.2940 - val_accuracy300: 0.3472 - 3s/epoch - 15ms/step
Epoch 15/50
200/200 - 3s - loss: 3.2314 - accuracy300: 0.3898 - val_loss: 3.3018 - val_accuracy300: 0.3428 - 3s/epoch - 15ms/step
Epoch 16/50
200/200 - 3s - loss: 3.2289 - accuracy300: 0.3899 - val_loss: 3.3005 - val_accuracy300: 0.3433 - 3s/epoch - 15ms/step
Epoch 17/50
200/200 - 3s - loss: 3.2260 - accuracy300: 0.3894 - val_loss: 3.3045 - val_accuracy300: 0.3385 - 3s/epoch - 15ms/step
Epoch 18/50
200/200 - 3s - loss: 3.2226 - accuracy300: 0.3937 - val_loss: 3.3055 - val_accuracy300: 0.3388 - 3s/epoch - 15ms/step
Epoch 19/50
200/200 - 3s - loss: 3.2211 - accuracy300: 0.3969 - val_loss: 3.2990 - val_accuracy300: 0.3451 - 3s/epoch - 15ms/step
Epoch 20/50
200/200 - 3s - loss: 3.2192 - accuracy300: 0.3972 - val_loss: 3.3101 - val_accuracy300: 0.3365 - 3s/epoch - 15ms/step
Epoch 21/50
200/200 - 3s - loss: 3.2137 - accuracy300: 0.4007 - val_loss: 3.3132 - val_accuracy300: 0.3412 - 3s/epoch - 15ms/step
Epoch 22/50
200/200 - 3s - loss: 3.2145 - accuracy300: 0.4012 - val_loss: 3.3098 - val_accuracy300: 0.3414 - 3s/epoch - 15ms/step
testing model: results/LILAK/W9/deepOF_L1/h300
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1027696
{'0': {'precision': 0.3753250680374962, 'recall': 0.23443638561498942, 'f1-score': 0.2886041807147674, 'support': 26472}, '1': {'precision': 0.35734060402684564, 'recall': 0.32949139431444596, 'f1-score': 0.34285139350035215, 'support': 25855}, '2': {'precision': 0.3267038148306901, 'recall': 0.4961593542507486, 'f1-score': 0.3939832523519074, 'support': 23043}, 'accuracy': 0.3470611649197293, 'macro avg': {'precision': 0.353123162298344, 'recall': 0.35336237806006127, 'f1-score': 0.341812942189009, 'support': 75370}, 'weighted avg': {'precision': 0.3542906000178624, 'recall': 0.3470611649197293, 'f1-score': 0.33943092390577057, 'support': 75370}}
[[ 6206  8369 11897]
 [ 5671  8519 11665]
 [ 4658  6952 11433]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0808762
{'0': {'precision': 0.380379077523794, 'recall': 0.27520452004002116, 'f1-score': 0.3193552793334244, 'support': 16991}, '1': {'precision': 0.39296886637866824, 'recall': 0.3133016627078385, 'f1-score': 0.3486420405735809, 'support': 16840}, '2': {'precision': 0.36900732110525075, 'recall': 0.54209552445935, 'f1-score': 0.43911007025761123, 'support': 17294}, 'accuracy': 0.3780342298288509, 'macro avg': {'precision': 0.3807850883359043, 'recall': 0.37686723573573655, 'f1-score': 0.3690357967215388, 'support': 51125}, 'weighted avg': {'precision': 0.38067930028787805, 'recall': 0.3780342298288509, 'f1-score': 0.36951133632172994, 'support': 51125}}
[[4676 4065 8250]
 [3783 5276 7781]
 [3834 4085 9375]]
Evaluating performance on  val set...
53/53 - 0s - 415ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0959179
{'0': {'precision': 0.32351057014734147, 'recall': 0.24122283257702412, 'f1-score': 0.27637159666165, 'support': 4187}, '1': {'precision': 0.42888224095730215, 'recall': 0.2917668825161887, 'f1-score': 0.34728033472803344, 'support': 5405}, '2': {'precision': 0.3022002694207454, 'recall': 0.5192901234567902, 'f1-score': 0.38206074368435994, 'support': 3888}, 'accuracy': 0.3416913946587537, 'macro avg': {'precision': 0.3515310268417964, 'recall': 0.35075994618333434, 'f1-score': 0.33523755835801444, 'support': 13480}, 'weighted avg': {'precision': 0.35961438554072667, 'recall': 0.3416913946587537, 'f1-score': 0.3352871109697434, 'support': 13480}}
[[1010 1118 2059]
 [1225 1577 2603]
 [ 887  982 2019]]
training model: results/LILAK/W9/deepOF_L1/h500
Epoch 1/50
200/200 - 5s - loss: 3.3339 - accuracy500: 0.3427 - val_loss: 3.3317 - val_accuracy500: 0.3389 - 5s/epoch - 25ms/step
Epoch 2/50
200/200 - 3s - loss: 3.3102 - accuracy500: 0.3484 - val_loss: 3.3290 - val_accuracy500: 0.3367 - 3s/epoch - 16ms/step
Epoch 3/50
200/200 - 3s - loss: 3.2924 - accuracy500: 0.3534 - val_loss: 3.3167 - val_accuracy500: 0.3449 - 3s/epoch - 16ms/step
Epoch 4/50
200/200 - 3s - loss: 3.2754 - accuracy500: 0.3598 - val_loss: 3.3086 - val_accuracy500: 0.3530 - 3s/epoch - 16ms/step
Epoch 5/50
200/200 - 3s - loss: 3.2735 - accuracy500: 0.3581 - val_loss: 3.3074 - val_accuracy500: 0.3458 - 3s/epoch - 16ms/step
Epoch 6/50
200/200 - 3s - loss: 3.2658 - accuracy500: 0.3623 - val_loss: 3.3112 - val_accuracy500: 0.3432 - 3s/epoch - 15ms/step
Epoch 7/50
200/200 - 3s - loss: 3.2593 - accuracy500: 0.3639 - val_loss: 3.3101 - val_accuracy500: 0.3402 - 3s/epoch - 15ms/step
Epoch 8/50
200/200 - 3s - loss: 3.2528 - accuracy500: 0.3704 - val_loss: 3.3131 - val_accuracy500: 0.3447 - 3s/epoch - 15ms/step
Epoch 9/50
200/200 - 3s - loss: 3.2488 - accuracy500: 0.3725 - val_loss: 3.3052 - val_accuracy500: 0.3467 - 3s/epoch - 16ms/step
Epoch 10/50
200/200 - 3s - loss: 3.2453 - accuracy500: 0.3763 - val_loss: 3.3074 - val_accuracy500: 0.3484 - 3s/epoch - 15ms/step
Epoch 11/50
200/200 - 3s - loss: 3.2433 - accuracy500: 0.3771 - val_loss: 3.3062 - val_accuracy500: 0.3478 - 3s/epoch - 15ms/step
Epoch 12/50
200/200 - 3s - loss: 3.2414 - accuracy500: 0.3788 - val_loss: 3.3053 - val_accuracy500: 0.3457 - 3s/epoch - 15ms/step
Epoch 13/50
200/200 - 3s - loss: 3.2359 - accuracy500: 0.3821 - val_loss: 3.3049 - val_accuracy500: 0.3451 - 3s/epoch - 16ms/step
Epoch 14/50
200/200 - 3s - loss: 3.2356 - accuracy500: 0.3822 - val_loss: 3.3058 - val_accuracy500: 0.3427 - 3s/epoch - 15ms/step
Epoch 15/50
200/200 - 3s - loss: 3.2321 - accuracy500: 0.3841 - val_loss: 3.3117 - val_accuracy500: 0.3446 - 3s/epoch - 15ms/step
Epoch 16/50
200/200 - 3s - loss: 3.2294 - accuracy500: 0.3886 - val_loss: 3.3114 - val_accuracy500: 0.3515 - 3s/epoch - 15ms/step
Epoch 17/50
200/200 - 3s - loss: 3.2264 - accuracy500: 0.3872 - val_loss: 3.3113 - val_accuracy500: 0.3495 - 3s/epoch - 15ms/step
Epoch 18/50
200/200 - 3s - loss: 3.2242 - accuracy500: 0.3882 - val_loss: 3.3156 - val_accuracy500: 0.3448 - 3s/epoch - 15ms/step
Epoch 19/50
200/200 - 3s - loss: 3.2212 - accuracy500: 0.3927 - val_loss: 3.3158 - val_accuracy500: 0.3455 - 3s/epoch - 15ms/step
Epoch 20/50
200/200 - 3s - loss: 3.2193 - accuracy500: 0.3934 - val_loss: 3.3203 - val_accuracy500: 0.3421 - 3s/epoch - 15ms/step
Epoch 21/50
200/200 - 3s - loss: 3.2158 - accuracy500: 0.3931 - val_loss: 3.3303 - val_accuracy500: 0.3492 - 3s/epoch - 15ms/step
Epoch 22/50
200/200 - 3s - loss: 3.2126 - accuracy500: 0.3967 - val_loss: 3.3239 - val_accuracy500: 0.3396 - 3s/epoch - 15ms/step
Epoch 23/50
200/200 - 3s - loss: 3.2087 - accuracy500: 0.4013 - val_loss: 3.3296 - val_accuracy500: 0.3454 - 3s/epoch - 15ms/step
testing model: results/LILAK/W9/deepOF_L1/h500
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1123122
{'0': {'precision': 0.38203815728245694, 'recall': 0.112592998937155, 'f1-score': 0.17392685962450016, 'support': 29167}, '1': {'precision': 0.29614529280948854, 'recall': 0.3677621283255086, 'f1-score': 0.32809099494928756, 'support': 21726}, '2': {'precision': 0.3373875458611851, 'recall': 0.5485149323855047, 'f1-score': 0.4177934060462728, 'support': 24477}, 'accuracy': 0.32771659811596127, 'macro avg': {'precision': 0.33852366531771017, 'recall': 0.34295668654938943, 'f1-score': 0.3066037535400202, 'support': 75370}, 'weighted avg': {'precision': 0.34277822111026396, 'recall': 0.32771659811596127, 'f1-score': 0.2975634718154523, 'support': 75370}}
[[ 3284 10703 15180]
 [ 2548  7990 11188]
 [ 2764  8287 13426]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0830245
{'0': {'precision': 0.38279711096520025, 'recall': 0.13990880729541635, 'f1-score': 0.20492091388400702, 'support': 16668}, '1': {'precision': 0.38252098880597013, 'recall': 0.38485452839042705, 'f1-score': 0.3836842105263158, 'support': 17048}, '2': {'precision': 0.3646210681108999, 'recall': 0.583950830030444, 'f1-score': 0.448929123426805, 'support': 17409}, 'accuracy': 0.3727921760391198, 'macro avg': {'precision': 0.37664638929402344, 'recall': 0.36957138857209576, 'f1-score': 0.3458447492790426, 'support': 51125}, 'weighted avg': {'precision': 0.3765157601462062, 'recall': 0.3727921760391198, 'f1-score': 0.34762009434539876, 'support': 51125}}
[[ 2332  5204  9132]
 [ 1904  6561  8583]
 [ 1856  5387 10166]]
Evaluating performance on  val set...
53/53 - 0s - 436ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1001098
{'0': {'precision': 0.3547466095645967, 'recall': 0.1123671716029844, 'f1-score': 0.17067307692307693, 'support': 4423}, '1': {'precision': 0.369140625, 'recall': 0.36237750319556883, 'f1-score': 0.36572780047301656, 'support': 4694}, '2': {'precision': 0.33248561102931334, 'recall': 0.569333027733211, 'f1-score': 0.4198073347980395, 'support': 4363}, 'accuracy': 0.3473293768545994, 'macro avg': {'precision': 0.3521242818646367, 'recall': 0.34802590084392143, 'f1-score': 0.3187360707313777, 'support': 13480}, 'weighted avg': {'precision': 0.3525537884848001, 'recall': 0.3473293768545994, 'f1-score': 0.31923091367766737, 'support': 13480}}
[[ 497 1450 2476]
 [ 482 1701 2511]
 [ 422 1457 2484]]
training model: results/LILAK/W9/deepOF_L1/h1000
Epoch 1/50
200/200 - 5s - loss: 3.3440 - accuracy1000: 0.3400 - val_loss: 3.3449 - val_accuracy1000: 0.3388 - 5s/epoch - 25ms/step
Epoch 2/50
200/200 - 3s - loss: 3.3124 - accuracy1000: 0.3502 - val_loss: 3.3358 - val_accuracy1000: 0.3478 - 3s/epoch - 16ms/step
Epoch 3/50
200/200 - 3s - loss: 3.2943 - accuracy1000: 0.3607 - val_loss: 3.3327 - val_accuracy1000: 0.3505 - 3s/epoch - 16ms/step
Epoch 4/50
200/200 - 3s - loss: 3.2840 - accuracy1000: 0.3617 - val_loss: 3.3294 - val_accuracy1000: 0.3516 - 3s/epoch - 16ms/step
Epoch 5/50
200/200 - 3s - loss: 3.2783 - accuracy1000: 0.3648 - val_loss: 3.3274 - val_accuracy1000: 0.3553 - 3s/epoch - 16ms/step
Epoch 6/50
200/200 - 3s - loss: 3.2740 - accuracy1000: 0.3646 - val_loss: 3.3229 - val_accuracy1000: 0.3516 - 3s/epoch - 16ms/step
Epoch 7/50
200/200 - 3s - loss: 3.2681 - accuracy1000: 0.3680 - val_loss: 3.3192 - val_accuracy1000: 0.3545 - 3s/epoch - 16ms/step
Epoch 8/50
200/200 - 3s - loss: 3.2638 - accuracy1000: 0.3706 - val_loss: 3.3223 - val_accuracy1000: 0.3495 - 3s/epoch - 16ms/step
Epoch 9/50
200/200 - 3s - loss: 3.2580 - accuracy1000: 0.3706 - val_loss: 3.3190 - val_accuracy1000: 0.3558 - 3s/epoch - 16ms/step
Epoch 10/50
200/200 - 3s - loss: 3.2552 - accuracy1000: 0.3728 - val_loss: 3.3156 - val_accuracy1000: 0.3541 - 3s/epoch - 16ms/step
Epoch 11/50
200/200 - 3s - loss: 3.2534 - accuracy1000: 0.3746 - val_loss: 3.3124 - val_accuracy1000: 0.3531 - 3s/epoch - 16ms/step
Epoch 12/50
200/200 - 3s - loss: 3.2500 - accuracy1000: 0.3747 - val_loss: 3.3254 - val_accuracy1000: 0.3539 - 3s/epoch - 15ms/step
Epoch 13/50
200/200 - 3s - loss: 3.2450 - accuracy1000: 0.3803 - val_loss: 3.3157 - val_accuracy1000: 0.3522 - 3s/epoch - 15ms/step
Epoch 14/50
200/200 - 3s - loss: 3.2424 - accuracy1000: 0.3784 - val_loss: 3.3203 - val_accuracy1000: 0.3509 - 3s/epoch - 16ms/step
Epoch 15/50
200/200 - 3s - loss: 3.2416 - accuracy1000: 0.3782 - val_loss: 3.3157 - val_accuracy1000: 0.3487 - 3s/epoch - 15ms/step
Epoch 16/50
200/200 - 3s - loss: 3.2377 - accuracy1000: 0.3813 - val_loss: 3.3142 - val_accuracy1000: 0.3546 - 3s/epoch - 15ms/step
Epoch 17/50
200/200 - 3s - loss: 3.2363 - accuracy1000: 0.3824 - val_loss: 3.3213 - val_accuracy1000: 0.3529 - 3s/epoch - 15ms/step
Epoch 18/50
200/200 - 3s - loss: 3.2331 - accuracy1000: 0.3833 - val_loss: 3.3224 - val_accuracy1000: 0.3539 - 3s/epoch - 15ms/step
Epoch 19/50
200/200 - 3s - loss: 3.2317 - accuracy1000: 0.3842 - val_loss: 3.3256 - val_accuracy1000: 0.3539 - 3s/epoch - 15ms/step
Epoch 20/50
200/200 - 3s - loss: 3.2287 - accuracy1000: 0.3892 - val_loss: 3.3258 - val_accuracy1000: 0.3600 - 3s/epoch - 16ms/step
Epoch 21/50
200/200 - 3s - loss: 3.2249 - accuracy1000: 0.3906 - val_loss: 3.3293 - val_accuracy1000: 0.3558 - 3s/epoch - 15ms/step
testing model: results/LILAK/W9/deepOF_L1/h1000
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1108942
{'0': {'precision': 0.39805920407763185, 'recall': 0.13713571742140276, 'f1-score': 0.2039934697978149, 'support': 29613}, '1': {'precision': 0.32259464150124745, 'recall': 0.12934933890048714, 'f1-score': 0.18465741516873121, 'support': 22992}, '2': {'precision': 0.3061001983949668, 'recall': 0.7522951899846255, 'f1-score': 0.4351449551541021, 'support': 22765}, 'accuracy': 0.32056521162266155, 'macro avg': {'precision': 0.3422513479912821, 'recall': 0.33959341543550514, 'f1-score': 0.2745986133735494, 'support': 75370}, 'weighted avg': {'precision': 0.3472627600399232, 'recall': 0.32056521162266155, 'f1-score': 0.2679126550983852, 'support': 75370}}
[[ 4061  3609 21943]
 [ 3138  2974 16880]
 [ 3003  2636 17126]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0847
{'0': {'precision': 0.3728082382410242, 'recall': 0.16290665855883246, 'f1-score': 0.2267360670305954, 'support': 16445}, '1': {'precision': 0.4270367054610564, 'recall': 0.1747146083877663, 'f1-score': 0.24797469999566782, 'support': 16381}, '2': {'precision': 0.3723447109058195, 'recall': 0.7576916771408274, 'f1-score': 0.4993157591472198, 'support': 18299}, 'accuracy': 0.3795794621026895, 'macro avg': {'precision': 0.3907298848693, 'recall': 0.3651043146958088, 'f1-score': 0.32467550872449435, 'support': 51125}, 'weighted avg': {'precision': 0.3900177137388127, 'recall': 0.3795794621026895, 'f1-score': 0.33110468967397855, 'support': 51125}}
[[ 2679  1788 11978]
 [ 2125  2862 11394]
 [ 2382  2052 13865]]
Evaluating performance on  val set...
53/53 - 0s - 433ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1004628
{'0': {'precision': 0.3083997547516861, 'recall': 0.11782618880299836, 'f1-score': 0.1705084745762712, 'support': 4269}, '1': {'precision': 0.3855633802816901, 'recall': 0.1432308698495749, 'f1-score': 0.20886981402002863, 'support': 4587}, '2': {'precision': 0.3522917693445047, 'recall': 0.7729238754325259, 'f1-score': 0.48398672895930667, 'support': 4624}, 'accuracy': 0.35118694362017805, 'macro avg': {'precision': 0.34875163479262694, 'recall': 0.3446603113616997, 'f1-score': 0.28778833918520214, 'support': 13480}, 'weighted avg': {'precision': 0.34971327298487015, 'recall': 0.35118694362017805, 'f1-score': 0.2910935570907869, 'support': 13480}}
[[ 503  531 3235]
 [ 594  657 3336]
 [ 534  516 3574]]
training model: results/LILAK/W9/deepLOB_L2/h10
Epoch 1/50
200/200 - 11s - loss: 3.3735 - accuracy10: 0.3479 - val_loss: 3.3925 - val_accuracy10: 0.2838 - 11s/epoch - 56ms/step
Epoch 2/50
200/200 - 8s - loss: 3.3208 - accuracy10: 0.3530 - val_loss: 3.3523 - val_accuracy10: 0.2930 - 8s/epoch - 42ms/step
Epoch 3/50
200/200 - 8s - loss: 3.2887 - accuracy10: 0.3736 - val_loss: 3.3385 - val_accuracy10: 0.2991 - 8s/epoch - 41ms/step
Epoch 4/50
200/200 - 8s - loss: 3.2609 - accuracy10: 0.3923 - val_loss: 3.3548 - val_accuracy10: 0.3085 - 8s/epoch - 42ms/step
Epoch 5/50
200/200 - 8s - loss: 3.2206 - accuracy10: 0.4145 - val_loss: 3.3057 - val_accuracy10: 0.3352 - 8s/epoch - 42ms/step
Epoch 6/50
200/200 - 8s - loss: 3.1750 - accuracy10: 0.4317 - val_loss: 3.2174 - val_accuracy10: 0.3671 - 8s/epoch - 41ms/step
Epoch 7/50
200/200 - 8s - loss: 3.1266 - accuracy10: 0.4531 - val_loss: 3.2093 - val_accuracy10: 0.3728 - 8s/epoch - 42ms/step
Epoch 8/50
200/200 - 8s - loss: 3.0839 - accuracy10: 0.4680 - val_loss: 3.1623 - val_accuracy10: 0.4079 - 8s/epoch - 42ms/step
Epoch 9/50
200/200 - 8s - loss: 3.0438 - accuracy10: 0.4864 - val_loss: 3.1801 - val_accuracy10: 0.3929 - 8s/epoch - 41ms/step
Epoch 10/50
200/200 - 8s - loss: 3.0039 - accuracy10: 0.4961 - val_loss: 3.1719 - val_accuracy10: 0.3950 - 8s/epoch - 41ms/step
Epoch 11/50
200/200 - 8s - loss: 2.9872 - accuracy10: 0.5006 - val_loss: 3.1350 - val_accuracy10: 0.4177 - 8s/epoch - 42ms/step
Epoch 12/50
200/200 - 8s - loss: 2.9623 - accuracy10: 0.5094 - val_loss: 3.1342 - val_accuracy10: 0.4341 - 8s/epoch - 42ms/step
Epoch 13/50
200/200 - 8s - loss: 2.9501 - accuracy10: 0.5118 - val_loss: 3.1368 - val_accuracy10: 0.4245 - 8s/epoch - 42ms/step
Epoch 14/50
200/200 - 8s - loss: 2.9268 - accuracy10: 0.5201 - val_loss: 3.1385 - val_accuracy10: 0.4297 - 8s/epoch - 42ms/step
Epoch 15/50
200/200 - 8s - loss: 2.9155 - accuracy10: 0.5220 - val_loss: 3.1268 - val_accuracy10: 0.4377 - 8s/epoch - 42ms/step
Epoch 16/50
200/200 - 8s - loss: 2.9036 - accuracy10: 0.5252 - val_loss: 3.1582 - val_accuracy10: 0.4237 - 8s/epoch - 41ms/step
Epoch 17/50
200/200 - 8s - loss: 2.8898 - accuracy10: 0.5293 - val_loss: 3.2027 - val_accuracy10: 0.3974 - 8s/epoch - 41ms/step
Epoch 18/50
200/200 - 8s - loss: 2.8706 - accuracy10: 0.5332 - val_loss: 3.1833 - val_accuracy10: 0.4145 - 8s/epoch - 41ms/step
Epoch 19/50
200/200 - 8s - loss: 2.8562 - accuracy10: 0.5391 - val_loss: 3.1733 - val_accuracy10: 0.4196 - 8s/epoch - 41ms/step
Epoch 20/50
200/200 - 8s - loss: 2.8557 - accuracy10: 0.5388 - val_loss: 3.1554 - val_accuracy10: 0.4303 - 8s/epoch - 41ms/step
Epoch 21/50
200/200 - 8s - loss: 2.8312 - accuracy10: 0.5458 - val_loss: 3.1644 - val_accuracy10: 0.4308 - 8s/epoch - 41ms/step
Epoch 22/50
200/200 - 8s - loss: 2.8139 - accuracy10: 0.5502 - val_loss: 3.1812 - val_accuracy10: 0.4252 - 8s/epoch - 41ms/step
Epoch 23/50
200/200 - 8s - loss: 2.7991 - accuracy10: 0.5525 - val_loss: 3.1982 - val_accuracy10: 0.4139 - 8s/epoch - 41ms/step
Epoch 24/50
200/200 - 8s - loss: 2.7888 - accuracy10: 0.5555 - val_loss: 3.2094 - val_accuracy10: 0.4180 - 8s/epoch - 41ms/step
Epoch 25/50
200/200 - 8s - loss: 2.7725 - accuracy10: 0.5585 - val_loss: 3.2279 - val_accuracy10: 0.4172 - 8s/epoch - 41ms/step
testing model: results/LILAK/W9/deepLOB_L2/h10
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0685604
{'0': {'precision': 0.3735086734818357, 'recall': 0.7161770209580839, 'f1-score': 0.49096419351217874, 'support': 21376}, '1': {'precision': 0.5987440308759077, 'recall': 0.29676101546542166, 'f1-score': 0.39683503143290705, 'support': 30843}, '2': {'precision': 0.46151832460732983, 'recall': 0.38069531418700064, 'f1-score': 0.4172287303277719, 'support': 23155}, 'accuracy': 0.44149176108472415, 'macro avg': {'precision': 0.477923676321691, 'recall': 0.4645444502035021, 'f1-score': 0.43500931842428586, 'support': 75374}, 'weighted avg': {'precision': 0.49271154980412424, 'recall': 0.44149176108472415, 'f1-score': 0.42979495218166797, 'support': 75374}}
[[15309  2406  3661]
 [15066  9153  6624]
 [10612  3728  8815]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0010176
{'0': {'precision': 0.41757383874745196, 'recall': 0.6547878128400435, 'f1-score': 0.5099441222425254, 'support': 14704}, '1': {'precision': 0.6017806342851122, 'recall': 0.516317121677816, 'f1-score': 0.5557826108110738, 'support': 22124}, '2': {'precision': 0.49053905390539054, 'recall': 0.31179637787567305, 'f1-score': 0.3812577487067676, 'support': 14301}, 'accuracy': 0.4989340687281191, 'macro avg': {'precision': 0.5032978423126515, 'recall': 0.4943004374645108, 'f1-score': 0.482328160586789, 'support': 51129}, 'weighted avg': {'precision': 0.5176905374203944, 'recall': 0.4989340687281191, 'f1-score': 0.49378473897971353, 'support': 51129}}
[[ 9628  3270  1806]
 [ 7876 11423  2825]
 [ 5553  4289  4459]]
Evaluating performance on  val set...
53/53 - 1s - 902ms/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0668025
{'0': {'precision': 0.34342909138177563, 'recall': 0.7254255903349808, 'f1-score': 0.46616674018526694, 'support': 3642}, '1': {'precision': 0.6152439024390244, 'recall': 0.3325642715886618, 'f1-score': 0.4317501069747539, 'support': 6068}, '2': {'precision': 0.46828879138412444, 'recall': 0.31140583554376655, 'f1-score': 0.37406404333280224, 'support': 3770}, 'accuracy': 0.4327893175074184, 'macro avg': {'precision': 0.4756539284016415, 'recall': 0.45646523248913634, 'f1-score': 0.4239936301642744, 'support': 13480}, 'weighted avg': {'precision': 0.5007060455734849, 'recall': 0.4327893175074184, 'f1-score': 0.42491545699126215, 'support': 13480}}
[[2642  521  479]
 [3196 2018  854]
 [1855  741 1174]]
training model: results/LILAK/W9/deepLOB_L2/h20
Epoch 1/50
200/200 - 11s - loss: 3.3666 - accuracy20: 0.3468 - val_loss: 3.3944 - val_accuracy20: 0.3243 - 11s/epoch - 53ms/step
Epoch 2/50
200/200 - 8s - loss: 3.3262 - accuracy20: 0.3541 - val_loss: 3.4157 - val_accuracy20: 0.3245 - 8s/epoch - 42ms/step
Epoch 3/50
200/200 - 8s - loss: 3.3000 - accuracy20: 0.3676 - val_loss: 3.3726 - val_accuracy20: 0.3246 - 8s/epoch - 42ms/step
Epoch 4/50
200/200 - 8s - loss: 3.2798 - accuracy20: 0.3734 - val_loss: 3.3558 - val_accuracy20: 0.3376 - 8s/epoch - 41ms/step
Epoch 5/50
200/200 - 8s - loss: 3.2497 - accuracy20: 0.3925 - val_loss: 3.3396 - val_accuracy20: 0.3337 - 8s/epoch - 42ms/step
Epoch 6/50
200/200 - 8s - loss: 3.2131 - accuracy20: 0.4085 - val_loss: 3.3423 - val_accuracy20: 0.3409 - 8s/epoch - 41ms/step
Epoch 7/50
200/200 - 8s - loss: 3.1881 - accuracy20: 0.4182 - val_loss: 3.3121 - val_accuracy20: 0.3519 - 8s/epoch - 41ms/step
Epoch 8/50
200/200 - 8s - loss: 3.1557 - accuracy20: 0.4352 - val_loss: 3.3274 - val_accuracy20: 0.3596 - 8s/epoch - 41ms/step
Epoch 9/50
200/200 - 8s - loss: 3.1221 - accuracy20: 0.4514 - val_loss: 3.2481 - val_accuracy20: 0.4050 - 8s/epoch - 41ms/step
Epoch 10/50
200/200 - 8s - loss: 3.0971 - accuracy20: 0.4617 - val_loss: 3.2620 - val_accuracy20: 0.4046 - 8s/epoch - 41ms/step
Epoch 11/50
200/200 - 8s - loss: 3.0691 - accuracy20: 0.4743 - val_loss: 3.2462 - val_accuracy20: 0.4103 - 8s/epoch - 42ms/step
Epoch 12/50
200/200 - 8s - loss: 3.0392 - accuracy20: 0.4844 - val_loss: 3.2255 - val_accuracy20: 0.4223 - 8s/epoch - 41ms/step
Epoch 13/50
200/200 - 8s - loss: 3.0137 - accuracy20: 0.4915 - val_loss: 3.2266 - val_accuracy20: 0.4265 - 8s/epoch - 41ms/step
Epoch 14/50
200/200 - 8s - loss: 3.0039 - accuracy20: 0.4945 - val_loss: 3.2142 - val_accuracy20: 0.4296 - 8s/epoch - 42ms/step
Epoch 15/50
200/200 - 8s - loss: 2.9862 - accuracy20: 0.5027 - val_loss: 3.2225 - val_accuracy20: 0.4360 - 8s/epoch - 41ms/step
Epoch 16/50
200/200 - 8s - loss: 2.9961 - accuracy20: 0.4983 - val_loss: 3.2517 - val_accuracy20: 0.4208 - 8s/epoch - 41ms/step
Epoch 17/50
200/200 - 8s - loss: 2.9661 - accuracy20: 0.5053 - val_loss: 3.2202 - val_accuracy20: 0.4353 - 8s/epoch - 41ms/step
Epoch 18/50
200/200 - 8s - loss: 2.9465 - accuracy20: 0.5132 - val_loss: 3.2579 - val_accuracy20: 0.4199 - 8s/epoch - 41ms/step
Epoch 19/50
200/200 - 8s - loss: 2.9276 - accuracy20: 0.5197 - val_loss: 3.2395 - val_accuracy20: 0.4250 - 8s/epoch - 41ms/step
Epoch 20/50
200/200 - 8s - loss: 2.9212 - accuracy20: 0.5201 - val_loss: 3.2396 - val_accuracy20: 0.4280 - 8s/epoch - 41ms/step
Epoch 21/50
200/200 - 8s - loss: 2.9089 - accuracy20: 0.5216 - val_loss: 3.2759 - val_accuracy20: 0.4200 - 8s/epoch - 41ms/step
Epoch 22/50
200/200 - 8s - loss: 2.8922 - accuracy20: 0.5279 - val_loss: 3.2438 - val_accuracy20: 0.4315 - 8s/epoch - 41ms/step
Epoch 23/50
200/200 - 8s - loss: 2.8659 - accuracy20: 0.5343 - val_loss: 3.2351 - val_accuracy20: 0.4388 - 8s/epoch - 41ms/step
Epoch 24/50
200/200 - 8s - loss: 2.8549 - accuracy20: 0.5358 - val_loss: 3.2890 - val_accuracy20: 0.4194 - 8s/epoch - 41ms/step
testing model: results/LILAK/W9/deepLOB_L2/h20
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0830864
{'0': {'precision': 0.3842911566831482, 'recall': 0.5889928772569157, 'f1-score': 0.4651155185663598, 'support': 24148}, '1': {'precision': 0.4514191419141914, 'recall': 0.2775906157405528, 'f1-score': 0.3437806318646794, 'support': 24637}, '2': {'precision': 0.4463016413216732, 'recall': 0.389634811388168, 'f1-score': 0.4160475482912333, 'support': 26589}, 'accuracy': 0.4168811526521082, 'macro avg': {'precision': 0.4273373133063376, 'recall': 0.4187394347952122, 'f1-score': 0.4083145662407575, 'support': 75374}, 'weighted avg': {'precision': 0.42810771077595156, 'recall': 0.4168811526521082, 'f1-score': 0.40814632673211143, 'support': 75374}}
[[14223  3791  6134]
 [11079  6839  6719]
 [11709  4520 10360]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0488998
{'0': {'precision': 0.4404898804047838, 'recall': 0.45628350208457413, 'f1-score': 0.4482476157041717, 'support': 16790}, '1': {'precision': 0.47202479559664406, 'recall': 0.49506781750924783, 'f1-score': 0.48327178224593076, 'support': 17842}, '2': {'precision': 0.4300452609158679, 'recall': 0.39164696611505123, 'f1-score': 0.40994892294026203, 'support': 16497}, 'accuracy': 0.4489624283674627, 'macro avg': {'precision': 0.44751997897243195, 'recall': 0.44766609523629103, 'f1-score': 0.4471561069634548, 'support': 51129}, 'weighted avg': {'precision': 0.44812431622681287, 'recall': 0.4489624283674627, 'f1-score': 0.4481124212922303, 'support': 51129}}
[[7661 4913 4216]
 [4662 8833 4347]
 [5069 4967 6461]]
Evaluating performance on  val set...
53/53 - 1s - 915ms/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0785576
{'0': {'precision': 0.3950331636587999, 'recall': 0.6086026615969582, 'f1-score': 0.47909456552240204, 'support': 4208}, '1': {'precision': 0.5057019268580417, 'recall': 0.2579739217652959, 'f1-score': 0.34165781083953245, 'support': 4985}, '2': {'precision': 0.4319712617871576, 'recall': 0.44879869372521575, 'f1-score': 0.4402242306372269, 'support': 4287}, 'accuracy': 0.42811572700296735, 'macro avg': {'precision': 0.44423545076799975, 'recall': 0.4384584256958233, 'f1-score': 0.4203255356663871, 'support': 13480}, 'weighted avg': {'precision': 0.4477065621175899, 'recall': 0.42811572700296735, 'f1-score': 0.4159076702889561, 'support': 13480}}
[[2561  586 1061]
 [2230 1286 1469]
 [1692  671 1924]]
training model: results/LILAK/W9/deepLOB_L2/h30
Epoch 1/50
200/200 - 10s - loss: 3.3787 - accuracy30: 0.3396 - val_loss: 3.4158 - val_accuracy30: 0.3347 - 10s/epoch - 51ms/step
Epoch 2/50
200/200 - 8s - loss: 3.3283 - accuracy30: 0.3538 - val_loss: 3.4091 - val_accuracy30: 0.3381 - 8s/epoch - 41ms/step
Epoch 3/50
200/200 - 8s - loss: 3.3088 - accuracy30: 0.3601 - val_loss: 3.3884 - val_accuracy30: 0.3314 - 8s/epoch - 41ms/step
Epoch 4/50
200/200 - 8s - loss: 3.2935 - accuracy30: 0.3696 - val_loss: 3.4249 - val_accuracy30: 0.3349 - 8s/epoch - 41ms/step
Epoch 5/50
200/200 - 8s - loss: 3.2744 - accuracy30: 0.3797 - val_loss: 3.3883 - val_accuracy30: 0.3389 - 8s/epoch - 42ms/step
Epoch 6/50
200/200 - 8s - loss: 3.2368 - accuracy30: 0.3962 - val_loss: 3.4123 - val_accuracy30: 0.3458 - 8s/epoch - 41ms/step
Epoch 7/50
200/200 - 8s - loss: 3.2121 - accuracy30: 0.4105 - val_loss: 3.3750 - val_accuracy30: 0.3502 - 8s/epoch - 42ms/step
Epoch 8/50
200/200 - 8s - loss: 3.2007 - accuracy30: 0.4126 - val_loss: 3.3546 - val_accuracy30: 0.3527 - 8s/epoch - 42ms/step
Epoch 9/50
200/200 - 8s - loss: 3.1805 - accuracy30: 0.4232 - val_loss: 3.3633 - val_accuracy30: 0.3577 - 8s/epoch - 41ms/step
Epoch 10/50
200/200 - 8s - loss: 3.1484 - accuracy30: 0.4404 - val_loss: 3.3425 - val_accuracy30: 0.3638 - 8s/epoch - 42ms/step
Epoch 11/50
200/200 - 8s - loss: 3.1329 - accuracy30: 0.4457 - val_loss: 3.3364 - val_accuracy30: 0.3644 - 8s/epoch - 41ms/step
Epoch 12/50
200/200 - 8s - loss: 3.1083 - accuracy30: 0.4560 - val_loss: 3.3397 - val_accuracy30: 0.3713 - 8s/epoch - 41ms/step
Epoch 13/50
200/200 - 8s - loss: 3.0854 - accuracy30: 0.4648 - val_loss: 3.3484 - val_accuracy30: 0.3766 - 8s/epoch - 41ms/step
Epoch 14/50
200/200 - 8s - loss: 3.0630 - accuracy30: 0.4721 - val_loss: 3.3534 - val_accuracy30: 0.3746 - 8s/epoch - 41ms/step
Epoch 15/50
200/200 - 8s - loss: 3.0396 - accuracy30: 0.4803 - val_loss: 3.3497 - val_accuracy30: 0.3860 - 8s/epoch - 41ms/step
Epoch 16/50
200/200 - 8s - loss: 3.0230 - accuracy30: 0.4867 - val_loss: 3.3450 - val_accuracy30: 0.3812 - 8s/epoch - 41ms/step
Epoch 17/50
200/200 - 8s - loss: 3.0038 - accuracy30: 0.4936 - val_loss: 3.3539 - val_accuracy30: 0.3862 - 8s/epoch - 41ms/step
Epoch 18/50
200/200 - 8s - loss: 2.9881 - accuracy30: 0.4960 - val_loss: 3.3571 - val_accuracy30: 0.3883 - 8s/epoch - 41ms/step
Epoch 19/50
200/200 - 8s - loss: 2.9722 - accuracy30: 0.5017 - val_loss: 3.3514 - val_accuracy30: 0.3931 - 8s/epoch - 41ms/step
Epoch 20/50
200/200 - 8s - loss: 2.9528 - accuracy30: 0.5082 - val_loss: 3.3521 - val_accuracy30: 0.3887 - 8s/epoch - 41ms/step
Epoch 21/50
200/200 - 8s - loss: 2.9367 - accuracy30: 0.5116 - val_loss: 3.3388 - val_accuracy30: 0.3952 - 8s/epoch - 41ms/step
testing model: results/LILAK/W9/deepLOB_L2/h30
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1047864
{'0': {'precision': 0.341821920031742, 'recall': 0.7516557604600437, 'f1-score': 0.4699362773052987, 'support': 25215}, '1': {'precision': 0.3494661921708185, 'recall': 0.06527808553068912, 'f1-score': 0.11000746825989545, 'support': 22565}, '2': {'precision': 0.43686354378818737, 'recall': 0.24874972820178298, 'f1-score': 0.31699995381702306, 'support': 27594}, 'accuracy': 0.36206118820813543, 'macro avg': {'precision': 0.37605055199691595, 'recall': 0.3552278580641719, 'f1-score': 0.2989812331274057, 'support': 75374}, 'weighted avg': {'precision': 0.3789046218487295, 'recall': 0.36206118820813543, 'f1-score': 0.30619389284321624, 'support': 75374}}
[[18953  1388  4874]
 [17118  1473  3974]
 [19376  1354  6864]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0722538
{'0': {'precision': 0.3948414412857513, 'recall': 0.5217813302883243, 'f1-score': 0.44952165465679644, 'support': 17515}, '1': {'precision': 0.4968740696635904, 'recall': 0.30415502369092456, 'f1-score': 0.37733147443385207, 'support': 16462}, '2': {'precision': 0.39511895454037754, 'recall': 0.4124883395522388, 'f1-score': 0.40361686348337045, 'support': 17152}, 'accuracy': 0.41504821138688414, 'macro avg': {'precision': 0.4289448218299064, 'recall': 0.41280823117716253, 'f1-score': 0.4101566641913396, 'support': 51129}, 'weighted avg': {'precision': 0.42778597444109046, 'recall': 0.41504821138688414, 'f1-score': 0.41087912839896407, 'support': 51129}}
[[9139 2553 5823]
 [6447 5007 5008]
 [7560 2517 7075]]
Evaluating performance on  val set...
53/53 - 1s - 901ms/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1081274
{'0': {'precision': 0.33960071828456745, 'recall': 0.7270465852555404, 'f1-score': 0.4629562963496292, 'support': 4422}, '1': {'precision': 0.3960463531015678, 'recall': 0.12351190476190477, 'f1-score': 0.1883001134338033, 'support': 4704}, '2': {'precision': 0.4186959937156324, 'recall': 0.2448323380799265, 'f1-score': 0.30898550724637674, 'support': 4354}, 'accuracy': 0.3606824925816024, 'macro avg': {'precision': 0.3847810217005892, 'recall': 0.36513027603245723, 'f1-score': 0.3200806390099364, 'support': 13480}, 'weighted avg': {'precision': 0.3848456066678038, 'recall': 0.3606824925816024, 'f1-score': 0.3173797755639018, 'support': 13480}}
[[3215  482  725]
 [3368  581  755]
 [2884  404 1066]]
training model: results/LILAK/W9/deepLOB_L2/h50
Epoch 1/50
200/200 - 10s - loss: 3.3798 - accuracy50: 0.3431 - val_loss: 3.3935 - val_accuracy50: 0.3323 - 10s/epoch - 52ms/step
Epoch 2/50
200/200 - 8s - loss: 3.3155 - accuracy50: 0.3600 - val_loss: 3.3996 - val_accuracy50: 0.3260 - 8s/epoch - 42ms/step
Epoch 3/50
200/200 - 8s - loss: 3.3033 - accuracy50: 0.3640 - val_loss: 3.3960 - val_accuracy50: 0.3196 - 8s/epoch - 42ms/step
Epoch 4/50
200/200 - 8s - loss: 3.2986 - accuracy50: 0.3610 - val_loss: 3.3796 - val_accuracy50: 0.3409 - 8s/epoch - 42ms/step
Epoch 5/50
200/200 - 8s - loss: 3.2849 - accuracy50: 0.3737 - val_loss: 3.4082 - val_accuracy50: 0.3303 - 8s/epoch - 42ms/step
Epoch 6/50
200/200 - 8s - loss: 3.2593 - accuracy50: 0.3881 - val_loss: 3.3829 - val_accuracy50: 0.3341 - 8s/epoch - 42ms/step
Epoch 7/50
200/200 - 8s - loss: 3.2376 - accuracy50: 0.3953 - val_loss: 3.3680 - val_accuracy50: 0.3506 - 8s/epoch - 42ms/step
Epoch 8/50
200/200 - 8s - loss: 3.2237 - accuracy50: 0.4057 - val_loss: 3.3661 - val_accuracy50: 0.3425 - 8s/epoch - 42ms/step
Epoch 9/50
200/200 - 8s - loss: 3.1915 - accuracy50: 0.4171 - val_loss: 3.3465 - val_accuracy50: 0.3465 - 8s/epoch - 42ms/step
Epoch 10/50
200/200 - 8s - loss: 3.1676 - accuracy50: 0.4280 - val_loss: 3.3587 - val_accuracy50: 0.3481 - 8s/epoch - 41ms/step
Epoch 11/50
200/200 - 8s - loss: 3.1491 - accuracy50: 0.4384 - val_loss: 3.3585 - val_accuracy50: 0.3554 - 8s/epoch - 41ms/step
Epoch 12/50
200/200 - 8s - loss: 3.1303 - accuracy50: 0.4491 - val_loss: 3.3429 - val_accuracy50: 0.3662 - 8s/epoch - 42ms/step
Epoch 13/50
200/200 - 8s - loss: 3.1135 - accuracy50: 0.4527 - val_loss: 3.3599 - val_accuracy50: 0.3581 - 8s/epoch - 41ms/step
Epoch 14/50
200/200 - 8s - loss: 3.0865 - accuracy50: 0.4639 - val_loss: 3.3694 - val_accuracy50: 0.3586 - 8s/epoch - 41ms/step
Epoch 15/50
200/200 - 8s - loss: 3.0669 - accuracy50: 0.4728 - val_loss: 3.3581 - val_accuracy50: 0.3665 - 8s/epoch - 41ms/step
Epoch 16/50
200/200 - 8s - loss: 3.0510 - accuracy50: 0.4765 - val_loss: 3.3766 - val_accuracy50: 0.3693 - 8s/epoch - 41ms/step
Epoch 17/50
200/200 - 8s - loss: 3.0263 - accuracy50: 0.4854 - val_loss: 3.3964 - val_accuracy50: 0.3659 - 8s/epoch - 41ms/step
Epoch 18/50
200/200 - 8s - loss: 3.0186 - accuracy50: 0.4890 - val_loss: 3.4134 - val_accuracy50: 0.3570 - 8s/epoch - 41ms/step
Epoch 19/50
200/200 - 8s - loss: 2.9963 - accuracy50: 0.4947 - val_loss: 3.4349 - val_accuracy50: 0.3605 - 8s/epoch - 41ms/step
Epoch 20/50
200/200 - 8s - loss: 2.9765 - accuracy50: 0.5018 - val_loss: 3.4328 - val_accuracy50: 0.3668 - 8s/epoch - 41ms/step
Epoch 21/50
200/200 - 8s - loss: 2.9640 - accuracy50: 0.5061 - val_loss: 3.4592 - val_accuracy50: 0.3608 - 8s/epoch - 41ms/step
Epoch 22/50
200/200 - 8s - loss: 2.9478 - accuracy50: 0.5092 - val_loss: 3.4675 - val_accuracy50: 0.3632 - 8s/epoch - 42ms/step
testing model: results/LILAK/W9/deepLOB_L2/h50
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1197984
{'0': {'precision': 0.34027479604980676, 'recall': 0.6451744209712216, 'f1-score': 0.4455563832628221, 'support': 24567}, '1': {'precision': 0.3082060272142917, 'recall': 0.1568594128393593, 'f1-score': 0.20790629575402636, 'support': 23537}, '2': {'precision': 0.400297353553375, 'recall': 0.24682801613494681, 'f1-score': 0.3053646364976749, 'support': 27270}, 'accuracy': 0.3485684718868575, 'macro avg': {'precision': 0.34959272560582444, 'recall': 0.34962061664850924, 'f1-score': 0.3196091051715078, 'support': 75374}, 'weighted avg': {'precision': 0.3519766100843649, 'recall': 0.3485684718868575, 'f1-score': 0.3206247218944445, 'support': 75374}}
[[15850  3785  4932]
 [14693  3692  5152]
 [16037  4502  6731]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0820202
{'0': {'precision': 0.39333647785257925, 'recall': 0.5285203964047015, 'f1-score': 0.4510165449762765, 'support': 17356}, '1': {'precision': 0.4431269932128547, 'recall': 0.3229439809296782, 'f1-score': 0.37360819056154987, 'support': 16780}, '2': {'precision': 0.3963027151935298, 'recall': 0.3633260754428294, 'f1-score': 0.3790986123050472, 'support': 16993}, 'accuracy': 0.4061491521445755, 'macro avg': {'precision': 0.4109220620863212, 'recall': 0.40493015092573637, 'f1-score': 0.40124111594762457, 'support': 51129}, 'weighted avg': {'precision': 0.4106630463143171, 'recall': 0.4061491521445755, 'f1-score': 0.4017096229367038, 'support': 51129}}
[[9173 3320 4863]
 [6819 5419 4542]
 [7329 3490 6174]]
Evaluating performance on  val set...
53/53 - 1s - 902ms/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.114635
{'0': {'precision': 0.3476983349657199, 'recall': 0.6492912665752172, 'f1-score': 0.452878328815181, 'support': 4374}, '1': {'precision': 0.3904282115869018, 'recall': 0.15995872033023736, 'f1-score': 0.22693997071742314, 'support': 4845}, '2': {'precision': 0.3817252780282537, 'recall': 0.29805210044590474, 'f1-score': 0.33473906167633105, 'support': 4261}, 'accuracy': 0.3623887240356083, 'macro avg': {'precision': 0.37328394152695843, 'recall': 0.3691006957837864, 'f1-score': 0.338185787069645, 'support': 13480}, 'weighted avg': {'precision': 0.3738122115695094, 'recall': 0.3623887240356083, 'f1-score': 0.3343276787957243, 'support': 13480}}
[[2840  622  912]
 [2925  775 1145]
 [2403  588 1270]]
training model: results/LILAK/W9/deepLOB_L2/h100
Epoch 1/50
200/200 - 10s - loss: 3.3778 - accuracy100: 0.3419 - val_loss: 3.3951 - val_accuracy100: 0.3267 - 10s/epoch - 52ms/step
Epoch 2/50
200/200 - 8s - loss: 3.3300 - accuracy100: 0.3517 - val_loss: 3.3877 - val_accuracy100: 0.3302 - 8s/epoch - 42ms/step
Epoch 3/50
200/200 - 8s - loss: 3.3046 - accuracy100: 0.3590 - val_loss: 3.3762 - val_accuracy100: 0.3369 - 8s/epoch - 42ms/step
Epoch 4/50
200/200 - 8s - loss: 3.2998 - accuracy100: 0.3599 - val_loss: 3.3630 - val_accuracy100: 0.3268 - 8s/epoch - 41ms/step
Epoch 5/50
200/200 - 8s - loss: 3.2988 - accuracy100: 0.3635 - val_loss: 3.3674 - val_accuracy100: 0.3330 - 8s/epoch - 41ms/step
Epoch 6/50
200/200 - 8s - loss: 3.2753 - accuracy100: 0.3732 - val_loss: 3.3531 - val_accuracy100: 0.3414 - 8s/epoch - 41ms/step
Epoch 7/50
200/200 - 8s - loss: 3.2544 - accuracy100: 0.3865 - val_loss: 3.3572 - val_accuracy100: 0.3398 - 8s/epoch - 41ms/step
Epoch 8/50
200/200 - 8s - loss: 3.2306 - accuracy100: 0.3978 - val_loss: 3.3543 - val_accuracy100: 0.3390 - 8s/epoch - 41ms/step
Epoch 9/50
200/200 - 8s - loss: 3.2131 - accuracy100: 0.4076 - val_loss: 3.3518 - val_accuracy100: 0.3453 - 8s/epoch - 42ms/step
Epoch 10/50
200/200 - 8s - loss: 3.1857 - accuracy100: 0.4214 - val_loss: 3.3584 - val_accuracy100: 0.3470 - 8s/epoch - 42ms/step
Epoch 11/50
200/200 - 8s - loss: 3.1663 - accuracy100: 0.4289 - val_loss: 3.3850 - val_accuracy100: 0.3477 - 8s/epoch - 41ms/step
Epoch 12/50
200/200 - 8s - loss: 3.1420 - accuracy100: 0.4411 - val_loss: 3.3970 - val_accuracy100: 0.3536 - 8s/epoch - 41ms/step
Epoch 13/50
200/200 - 8s - loss: 3.1250 - accuracy100: 0.4483 - val_loss: 3.4060 - val_accuracy100: 0.3505 - 8s/epoch - 41ms/step
Epoch 14/50
200/200 - 8s - loss: 3.1065 - accuracy100: 0.4561 - val_loss: 3.4118 - val_accuracy100: 0.3509 - 8s/epoch - 41ms/step
Epoch 15/50
200/200 - 8s - loss: 3.0941 - accuracy100: 0.4655 - val_loss: 3.4456 - val_accuracy100: 0.3486 - 8s/epoch - 41ms/step
Epoch 16/50
200/200 - 8s - loss: 3.0732 - accuracy100: 0.4726 - val_loss: 3.4496 - val_accuracy100: 0.3505 - 8s/epoch - 41ms/step
Epoch 17/50
200/200 - 8s - loss: 3.0581 - accuracy100: 0.4730 - val_loss: 3.4618 - val_accuracy100: 0.3487 - 8s/epoch - 41ms/step
Epoch 18/50
200/200 - 8s - loss: 3.0332 - accuracy100: 0.4865 - val_loss: 3.4826 - val_accuracy100: 0.3535 - 8s/epoch - 41ms/step
Epoch 19/50
200/200 - 8s - loss: 3.0079 - accuracy100: 0.4904 - val_loss: 3.5255 - val_accuracy100: 0.3480 - 8s/epoch - 41ms/step
testing model: results/LILAK/W9/deepLOB_L2/h100
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1187563
{'0': {'precision': 0.3085992804920506, 'recall': 0.5673323092677931, 'f1-score': 0.39975346131296885, 'support': 23436}, '1': {'precision': 0.3989355804412906, 'recall': 0.1297043979812545, 'f1-score': 0.19576158219755707, 'support': 27740}, '2': {'precision': 0.3480017189514396, 'recall': 0.3346557566741053, 'f1-score': 0.3411982809471644, 'support': 24198}, 'accuracy': 0.3315732215352774, 'macro avg': {'precision': 0.35184552662826024, 'recall': 0.3438974879743843, 'f1-score': 0.3122377748192301, 'support': 75374}, 'weighted avg': {'precision': 0.3544955997325342, 'recall': 0.3315732215352774, 'f1-score': 0.30587953952092833, 'support': 75374}}
[[13296  3008  7132]
 [16102  3598  8040]
 [13687  2413  8098]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0978155
{'0': {'precision': 0.3797175272053716, 'recall': 0.373299948785068, 'f1-score': 0.3764813911446527, 'support': 17573}, '1': {'precision': 0.44354592615196825, 'recall': 0.17701863354037267, 'f1-score': 0.25304665738161564, 'support': 16422}, '2': {'precision': 0.36114876002783985, 'recall': 0.5754056262402241, 'f1-score': 0.4437692705871762, 'support': 17134}, 'accuracy': 0.3779850965205656, 'macro avg': {'precision': 0.3948040711283933, 'recall': 0.37524140285522156, 'f1-score': 0.3577657730378148, 'support': 51129}, 'weighted avg': {'precision': 0.39399577850465745, 'recall': 0.3779850965205656, 'f1-score': 0.359384740095573, 'support': 51129}}
[[6560 1835 9178]
 [5253 2907 8262]
 [5463 1812 9859]]
Evaluating performance on  val set...
53/53 - 1s - 881ms/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1128392
{'0': {'precision': 0.3520953668428168, 'recall': 0.6465809072444143, 'f1-score': 0.45591979630808405, 'support': 4431}, '1': {'precision': 0.3620364550597109, 'recall': 0.11837237977805179, 'f1-score': 0.17841102679262816, 'support': 4866}, '2': {'precision': 0.3296908315565032, 'recall': 0.29572077456371026, 'f1-score': 0.3117832388153749, 'support': 4183}, 'accuracy': 0.3470326409495549, 'macro avg': {'precision': 0.34794088448634364, 'recall': 0.3535580205287254, 'f1-score': 0.31537135397202903, 'support': 13480}, 'weighted avg': {'precision': 0.34873150661735364, 'recall': 0.3470326409495549, 'f1-score': 0.3110176529509468, 'support': 13480}}
[[2865  514 1052]
 [2827  576 1463]
 [2445  501 1237]]
training model: results/LILAK/W9/deepLOB_L2/h200
Epoch 1/50
200/200 - 10s - loss: 3.3812 - accuracy200: 0.3407 - val_loss: 3.3637 - val_accuracy200: 0.3363 - 10s/epoch - 51ms/step
Epoch 2/50
200/200 - 8s - loss: 3.3380 - accuracy200: 0.3453 - val_loss: 3.3549 - val_accuracy200: 0.3340 - 8s/epoch - 41ms/step
Epoch 3/50
200/200 - 8s - loss: 3.3167 - accuracy200: 0.3497 - val_loss: 3.3679 - val_accuracy200: 0.3132 - 8s/epoch - 41ms/step
Epoch 4/50
200/200 - 8s - loss: 3.2892 - accuracy200: 0.3681 - val_loss: 3.3510 - val_accuracy200: 0.3246 - 8s/epoch - 41ms/step
Epoch 5/50
200/200 - 8s - loss: 3.2726 - accuracy200: 0.3697 - val_loss: 3.3446 - val_accuracy200: 0.3309 - 8s/epoch - 41ms/step
Epoch 6/50
200/200 - 8s - loss: 3.2452 - accuracy200: 0.3875 - val_loss: 3.3248 - val_accuracy200: 0.3413 - 8s/epoch - 41ms/step
Epoch 7/50
200/200 - 8s - loss: 3.2224 - accuracy200: 0.4005 - val_loss: 3.3153 - val_accuracy200: 0.3494 - 8s/epoch - 41ms/step
Epoch 8/50
200/200 - 8s - loss: 3.2011 - accuracy200: 0.4149 - val_loss: 3.3141 - val_accuracy200: 0.3494 - 8s/epoch - 42ms/step
Epoch 9/50
200/200 - 8s - loss: 3.1803 - accuracy200: 0.4255 - val_loss: 3.3292 - val_accuracy200: 0.3551 - 8s/epoch - 42ms/step
Epoch 10/50
200/200 - 8s - loss: 3.1662 - accuracy200: 0.4304 - val_loss: 3.3394 - val_accuracy200: 0.3490 - 8s/epoch - 42ms/step
Epoch 11/50
200/200 - 8s - loss: 3.1444 - accuracy200: 0.4408 - val_loss: 3.3546 - val_accuracy200: 0.3527 - 8s/epoch - 42ms/step
Epoch 12/50
200/200 - 8s - loss: 3.1189 - accuracy200: 0.4500 - val_loss: 3.3777 - val_accuracy200: 0.3611 - 8s/epoch - 42ms/step
Epoch 13/50
200/200 - 8s - loss: 3.0987 - accuracy200: 0.4623 - val_loss: 3.4209 - val_accuracy200: 0.3443 - 8s/epoch - 41ms/step
Epoch 14/50
200/200 - 8s - loss: 3.0841 - accuracy200: 0.4685 - val_loss: 3.4394 - val_accuracy200: 0.3540 - 8s/epoch - 41ms/step
Epoch 15/50
200/200 - 8s - loss: 3.0562 - accuracy200: 0.4775 - val_loss: 3.4494 - val_accuracy200: 0.3541 - 8s/epoch - 41ms/step
Epoch 16/50
200/200 - 8s - loss: 3.0339 - accuracy200: 0.4854 - val_loss: 3.4684 - val_accuracy200: 0.3479 - 8s/epoch - 41ms/step
Epoch 17/50
200/200 - 8s - loss: 3.0090 - accuracy200: 0.4936 - val_loss: 3.4751 - val_accuracy200: 0.3511 - 8s/epoch - 41ms/step
Epoch 18/50
200/200 - 8s - loss: 2.9791 - accuracy200: 0.5023 - val_loss: 3.5186 - val_accuracy200: 0.3472 - 8s/epoch - 41ms/step
testing model: results/LILAK/W9/deepLOB_L2/h200
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1247178
{'0': {'precision': 0.34908187937005813, 'recall': 0.19114752925179804, 'f1-score': 0.247028901734104, 'support': 27947}, '1': {'precision': 0.29327385206911, 'recall': 0.5492775700503162, 'f1-score': 0.3823831865801144, 'support': 21663}, '2': {'precision': 0.3468048004923582, 'recall': 0.2624592454587797, 'f1-score': 0.29879369007114137, 'support': 25764}, 'accuracy': 0.3184519860960013, 'macro avg': {'precision': 0.3297201773105088, 'recall': 0.33429478158696463, 'f1-score': 0.30940192612845324, 'support': 75374}, 'weighted avg': {'precision': 0.3322639321253119, 'recall': 0.3184519860960013, 'f1-score': 0.30362464933055044, 'support': 75374}}
[[ 5342 15427  7178]
 [ 4206 11899  5558]
 [ 5755 13247  6762]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0960329
{'0': {'precision': 0.3739291277258567, 'recall': 0.22490923995784048, 'f1-score': 0.2808775137111517, 'support': 17078}, '1': {'precision': 0.3662390696435705, 'recall': 0.4899934675455787, 'f1-score': 0.41917293233082703, 'support': 16839}, '2': {'precision': 0.37467263203841117, 'recall': 0.39896583778759004, 'f1-score': 0.3864378165447383, 'support': 17212}, 'accuracy': 0.37080717401083535, 'macro avg': {'precision': 0.3716136098026128, 'recall': 0.3712895150970031, 'f1-score': 0.3621627541955723, 'support': 51129}, 'weighted avg': {'precision': 0.37164674997898245, 'recall': 0.37080717401083535, 'f1-score': 0.36195988353079234, 'support': 51129}}
[[3841 7320 5917]
 [3044 8251 5544]
 [3387 6958 6867]]
Evaluating performance on  val set...
53/53 - 1s - 899ms/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1050711
{'0': {'precision': 0.32558139534883723, 'recall': 0.3217292377701934, 'f1-score': 0.3236438544289312, 'support': 4395}, '1': {'precision': 0.36859635210150676, 'recall': 0.46921057944679995, 'f1-score': 0.4128619648250133, 'support': 4953}, '2': {'precision': 0.3343926553672316, 'recall': 0.22918683446272992, 'f1-score': 0.27197013210798393, 'support': 4132}, 'accuracy': 0.3475519287833828, 'macro avg': {'precision': 0.34285680093919185, 'recall': 0.34004221722657446, 'f1-score': 0.33615865045397614, 'support': 13480}, 'weighted avg': {'precision': 0.3440874196212391, 'recall': 0.3475519287833828, 'f1-score': 0.3405861007317235, 'support': 13480}}
[[1414 2042  939]
 [1683 2324  946]
 [1246 1939  947]]
training model: results/LILAK/W9/deepLOB_L2/h300
Epoch 1/50
200/200 - 10s - loss: 3.3747 - accuracy300: 0.3473 - val_loss: 3.3856 - val_accuracy300: 0.3169 - 10s/epoch - 51ms/step
Epoch 2/50
200/200 - 8s - loss: 3.3187 - accuracy300: 0.3561 - val_loss: 3.3349 - val_accuracy300: 0.3467 - 8s/epoch - 42ms/step
Epoch 3/50
200/200 - 8s - loss: 3.3010 - accuracy300: 0.3708 - val_loss: 3.3569 - val_accuracy300: 0.3289 - 8s/epoch - 41ms/step
Epoch 4/50
200/200 - 8s - loss: 3.2864 - accuracy300: 0.3790 - val_loss: 3.3307 - val_accuracy300: 0.3360 - 8s/epoch - 41ms/step
Epoch 5/50
200/200 - 8s - loss: 3.2561 - accuracy300: 0.3958 - val_loss: 3.3444 - val_accuracy300: 0.3263 - 8s/epoch - 41ms/step
Epoch 6/50
200/200 - 8s - loss: 3.2296 - accuracy300: 0.4060 - val_loss: 3.3032 - val_accuracy300: 0.3577 - 8s/epoch - 41ms/step
Epoch 7/50
200/200 - 8s - loss: 3.2271 - accuracy300: 0.4060 - val_loss: 3.3253 - val_accuracy300: 0.3531 - 8s/epoch - 41ms/step
Epoch 8/50
200/200 - 8s - loss: 3.1983 - accuracy300: 0.4238 - val_loss: 3.3030 - val_accuracy300: 0.3681 - 8s/epoch - 41ms/step
Epoch 9/50
200/200 - 8s - loss: 3.1759 - accuracy300: 0.4327 - val_loss: 3.3086 - val_accuracy300: 0.3783 - 8s/epoch - 41ms/step
Epoch 10/50
200/200 - 8s - loss: 3.1448 - accuracy300: 0.4451 - val_loss: 3.3163 - val_accuracy300: 0.3798 - 8s/epoch - 41ms/step
Epoch 11/50
200/200 - 8s - loss: 3.1341 - accuracy300: 0.4468 - val_loss: 3.3250 - val_accuracy300: 0.3799 - 8s/epoch - 41ms/step
Epoch 12/50
200/200 - 8s - loss: 3.1027 - accuracy300: 0.4601 - val_loss: 3.3378 - val_accuracy300: 0.3728 - 8s/epoch - 41ms/step
Epoch 13/50
200/200 - 8s - loss: 3.0874 - accuracy300: 0.4675 - val_loss: 3.3631 - val_accuracy300: 0.3623 - 8s/epoch - 41ms/step
Epoch 14/50
200/200 - 8s - loss: 3.0622 - accuracy300: 0.4746 - val_loss: 3.3880 - val_accuracy300: 0.3682 - 8s/epoch - 41ms/step
Epoch 15/50
200/200 - 8s - loss: 3.0418 - accuracy300: 0.4830 - val_loss: 3.4071 - val_accuracy300: 0.3667 - 8s/epoch - 41ms/step
Epoch 16/50
200/200 - 8s - loss: 3.0069 - accuracy300: 0.4945 - val_loss: 3.4511 - val_accuracy300: 0.3512 - 8s/epoch - 41ms/step
Epoch 17/50
200/200 - 8s - loss: 2.9824 - accuracy300: 0.5030 - val_loss: 3.4683 - val_accuracy300: 0.3535 - 8s/epoch - 41ms/step
Epoch 18/50
200/200 - 8s - loss: 2.9514 - accuracy300: 0.5131 - val_loss: 3.4829 - val_accuracy300: 0.3583 - 8s/epoch - 41ms/step
testing model: results/LILAK/W9/deepLOB_L2/h300
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1344272
{'0': {'precision': 0.3770508253474487, 'recall': 0.28386341316008157, 'f1-score': 0.32388751212153866, 'support': 26474}, '1': {'precision': 0.35371312933096216, 'recall': 0.446180622703539, 'f1-score': 0.39460226786844316, 'support': 25855}, '2': {'precision': 0.2832800385474616, 'recall': 0.28062486439574746, 'f1-score': 0.2819462004621355, 'support': 23045}, 'accuracy': 0.33855175524716746, 'macro avg': {'precision': 0.33801466440862415, 'recall': 0.33688963341978934, 'f1-score': 0.33347866015070576, 'support': 75374}, 'weighted avg': {'precision': 0.3403757926795266, 'recall': 0.33855175524716746, 'f1-score': 0.3353210632485224, 'support': 75374}}
[[ 7515 10928  8031]
 [ 5988 11536  8331]
 [ 6428 10150  6467]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1138707
{'0': {'precision': 0.36386509635974307, 'recall': 0.400530347672363, 'f1-score': 0.38131837307152877, 'support': 16970}, '1': {'precision': 0.4147714966428417, 'recall': 0.22708407446934661, 'f1-score': 0.2934865900383142, 'support': 16866}, '2': {'precision': 0.36385957355158305, 'recall': 0.4884635401607587, 'f1-score': 0.41705342154636127, 'support': 17293}, 'accuracy': 0.3730563867863639, 'macro avg': {'precision': 0.38083205551805593, 'recall': 0.3720259874341561, 'f1-score': 0.3639527948854014, 'support': 51129}, 'weighted avg': {'precision': 0.38065579911655884, 'recall': 0.3730563867863639, 'f1-score': 0.36443158359074646, 'support': 51129}}
[[6797 2711 7462]
 [5730 3830 7306]
 [6153 2693 8447]]
Evaluating performance on  val set...
53/53 - 1s - 905ms/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011595
{'0': {'precision': 0.3350197628458498, 'recall': 0.505245588936576, 'f1-score': 0.40289000855594637, 'support': 4194}, '1': {'precision': 0.44094659140251846, 'recall': 0.3761111111111111, 'f1-score': 0.4059564261443134, 'support': 5400}, '2': {'precision': 0.33660258925068653, 'recall': 0.22079258878023675, 'f1-score': 0.2666666666666666, 'support': 3886}, 'accuracy': 0.37151335311572703, 'macro avg': {'precision': 0.370856314499685, 'recall': 0.3673830962759746, 'f1-score': 0.35850436712230876, 'support': 13480}, 'weighted avg': {'precision': 0.37790965436033097, 'recall': 0.37151335311572703, 'f1-score': 0.3648480759443322, 'support': 13480}}
[[2119 1337  738]
 [2416 2031  953]
 [1790 1238  858]]
training model: results/LILAK/W9/deepLOB_L2/h500
Epoch 1/50
200/200 - 11s - loss: 3.3671 - accuracy500: 0.3515 - val_loss: 3.3978 - val_accuracy500: 0.3233 - 11s/epoch - 53ms/step
Epoch 2/50
200/200 - 8s - loss: 3.3281 - accuracy500: 0.3600 - val_loss: 3.3289 - val_accuracy500: 0.3385 - 8s/epoch - 42ms/step
Epoch 3/50
200/200 - 8s - loss: 3.2993 - accuracy500: 0.3685 - val_loss: 3.3314 - val_accuracy500: 0.3533 - 8s/epoch - 41ms/step
Epoch 4/50
200/200 - 8s - loss: 3.2846 - accuracy500: 0.3769 - val_loss: 3.3538 - val_accuracy500: 0.3421 - 8s/epoch - 42ms/step
Epoch 5/50
200/200 - 8s - loss: 3.2436 - accuracy500: 0.3954 - val_loss: 3.3720 - val_accuracy500: 0.3399 - 8s/epoch - 42ms/step
Epoch 6/50
200/200 - 8s - loss: 3.2149 - accuracy500: 0.4118 - val_loss: 3.3756 - val_accuracy500: 0.3427 - 8s/epoch - 42ms/step
Epoch 7/50
200/200 - 8s - loss: 3.1876 - accuracy500: 0.4257 - val_loss: 3.3762 - val_accuracy500: 0.3475 - 8s/epoch - 42ms/step
Epoch 8/50
200/200 - 8s - loss: 3.1596 - accuracy500: 0.4398 - val_loss: 3.4060 - val_accuracy500: 0.3448 - 8s/epoch - 41ms/step
Epoch 9/50
200/200 - 8s - loss: 3.1293 - accuracy500: 0.4502 - val_loss: 3.4152 - val_accuracy500: 0.3524 - 8s/epoch - 41ms/step
Epoch 10/50
200/200 - 8s - loss: 3.0991 - accuracy500: 0.4627 - val_loss: 3.5097 - val_accuracy500: 0.3504 - 8s/epoch - 41ms/step
Epoch 11/50
200/200 - 8s - loss: 3.0751 - accuracy500: 0.4721 - val_loss: 3.4674 - val_accuracy500: 0.3396 - 8s/epoch - 41ms/step
Epoch 12/50
200/200 - 8s - loss: 3.0426 - accuracy500: 0.4853 - val_loss: 3.4776 - val_accuracy500: 0.3323 - 8s/epoch - 41ms/step
testing model: results/LILAK/W9/deepLOB_L2/h500
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1162953
{'0': {'precision': 0.3980628520292678, 'recall': 0.25925671969281405, 'f1-score': 0.3140039447731755, 'support': 29168}, '1': {'precision': 0.2989492743683301, 'recall': 0.5015418603580798, 'f1-score': 0.37460895871291555, 'support': 21727}, '2': {'precision': 0.3318779484091137, 'recall': 0.27014992442501734, 'f1-score': 0.2978493412903952, 'support': 24479}, 'accuracy': 0.3326345954838538, 'macro avg': {'precision': 0.34296335826890384, 'recall': 0.34364950149197043, 'f1-score': 0.32882074825882873, 'support': 75374}, 'weighted avg': {'precision': 0.3479980955143297, 'recall': 0.3326345954838538, 'f1-score': 0.3262272127331319, 'support': 75374}}
[[ 7562 14029  7577]
 [ 5094 10897  5736]
 [ 6341 11525  6613]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1223435
{'0': {'precision': 0.3107958050586058, 'recall': 0.15126403650993814, 'f1-score': 0.20348978108086274, 'support': 16653}, '1': {'precision': 0.3422222222222222, 'recall': 0.4775892334698654, 'f1-score': 0.3987298485588666, 'support': 17090}, '2': {'precision': 0.34890998226765413, 'recall': 0.38479236167030945, 'f1-score': 0.36597374179431075, 'support': 17386}, 'accuracy': 0.33974847933658003, 'macro avg': {'precision': 0.3339760031828274, 'recall': 0.3378818772167043, 'f1-score': 0.32273112381134667, 'support': 51129}, 'weighted avg': {'precision': 0.33426058149238547, 'recall': 0.33974847933658003, 'f1-score': 0.3240006241281176, 'support': 51129}}
[[2519 7639 6495]
 [2939 8162 5989]
 [2647 8049 6690]]
Evaluating performance on  val set...
53/53 - 1s - 880ms/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.110072
{'0': {'precision': 0.3375139353400223, 'recall': 0.2742300724637681, 'f1-score': 0.3025987006496752, 'support': 4416}, '1': {'precision': 0.34311264512080325, 'recall': 0.46641074856046066, 'f1-score': 0.39537196058935187, 'support': 4689}, '2': {'precision': 0.3368391131324616, 'recall': 0.27085714285714285, 'f1-score': 0.30026605853287724, 'support': 4375}, 'accuracy': 0.33998516320474775, 'macro avg': {'precision': 0.3391552311977624, 'recall': 0.3371659879604572, 'f1-score': 0.3327455732573014, 'support': 13480}, 'weighted avg': {'precision': 0.33924242220975553, 'recall': 0.33998516320474775, 'f1-score': 0.33411268481852924, 'support': 13480}}
[[1211 2074 1131]
 [1300 2187 1202]
 [1077 2113 1185]]
training model: results/LILAK/W9/deepLOB_L2/h1000
Epoch 1/50
200/200 - 10s - loss: 3.3734 - accuracy1000: 0.3482 - val_loss: 3.3981 - val_accuracy1000: 0.3226 - 10s/epoch - 51ms/step
Epoch 2/50
200/200 - 8s - loss: 3.3063 - accuracy1000: 0.3680 - val_loss: 3.3880 - val_accuracy1000: 0.3337 - 8s/epoch - 42ms/step
Epoch 3/50
200/200 - 8s - loss: 3.3129 - accuracy1000: 0.3715 - val_loss: 3.3399 - val_accuracy1000: 0.3283 - 8s/epoch - 42ms/step
Epoch 4/50
200/200 - 8s - loss: 3.2852 - accuracy1000: 0.3744 - val_loss: 3.3430 - val_accuracy1000: 0.3230 - 8s/epoch - 41ms/step
Epoch 5/50
200/200 - 8s - loss: 3.2365 - accuracy1000: 0.3963 - val_loss: 3.3636 - val_accuracy1000: 0.3159 - 8s/epoch - 41ms/step
Epoch 6/50
200/200 - 8s - loss: 3.2185 - accuracy1000: 0.4095 - val_loss: 3.3761 - val_accuracy1000: 0.3180 - 8s/epoch - 41ms/step
Epoch 7/50
200/200 - 8s - loss: 3.1791 - accuracy1000: 0.4314 - val_loss: 3.4124 - val_accuracy1000: 0.3154 - 8s/epoch - 41ms/step
Epoch 8/50
200/200 - 8s - loss: 3.1601 - accuracy1000: 0.4435 - val_loss: 3.3823 - val_accuracy1000: 0.3207 - 8s/epoch - 41ms/step
Epoch 9/50
200/200 - 8s - loss: 3.1349 - accuracy1000: 0.4509 - val_loss: 3.4193 - val_accuracy1000: 0.3240 - 8s/epoch - 41ms/step
Epoch 10/50
200/200 - 8s - loss: 3.1011 - accuracy1000: 0.4638 - val_loss: 3.4471 - val_accuracy1000: 0.3194 - 8s/epoch - 41ms/step
Epoch 11/50
200/200 - 8s - loss: 3.0759 - accuracy1000: 0.4719 - val_loss: 3.5002 - val_accuracy1000: 0.3168 - 8s/epoch - 41ms/step
Epoch 12/50
200/200 - 8s - loss: 3.0451 - accuracy1000: 0.4800 - val_loss: 3.4980 - val_accuracy1000: 0.3182 - 8s/epoch - 42ms/step
Epoch 13/50
200/200 - 8s - loss: 3.0178 - accuracy1000: 0.4910 - val_loss: 3.6914 - val_accuracy1000: 0.3096 - 8s/epoch - 41ms/step
testing model: results/LILAK/W9/deepLOB_L2/h1000
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.101699
{'0': {'precision': 0.3981253217023813, 'recall': 0.4962182603997839, 'f1-score': 0.44179230110177514, 'support': 29616}, '1': {'precision': 0.3071846934791097, 'recall': 0.3421624913013222, 'f1-score': 0.32373153368174146, 'support': 22992}, '2': {'precision': 0.29818691152439497, 'recall': 0.16832118070807345, 'f1-score': 0.21517814526770923, 'support': 22766}, 'accuracy': 0.3501870671584366, 'macro avg': {'precision': 0.3344989755686287, 'recall': 0.3355673108030599, 'f1-score': 0.32690066001707524, 'support': 75374}, 'weighted avg': {'precision': 0.34019944845402644, 'recall': 0.3501870671584366, 'f1-score': 0.33733252669362696, 'support': 75374}}
[[14696  9771  5149]
 [11255  7867  3870]
 [10962  7972  3832]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1218797
{'0': {'precision': 0.32556947608200454, 'recall': 0.34832145250715896, 'f1-score': 0.33656138698378124, 'support': 16413}, '1': {'precision': 0.33381395117585644, 'recall': 0.4085929892891918, 'f1-score': 0.3674374059378848, 'support': 16432}, '2': {'precision': 0.3770808561236623, 'recall': 0.2775103915992124, 'f1-score': 0.31972274732199113, 'support': 18284}, 'accuracy': 0.3423693011793698, 'macro avg': {'precision': 0.3454880944605077, 'recall': 0.3448082777985211, 'f1-score': 0.34124051341455236, 'support': 51129}, 'weighted avg': {'precision': 0.3466398527258632, 'recall': 0.3423693011793698, 'f1-score': 0.3404628334403453, 'support': 51129}}
[[5717 6423 4273]
 [5609 6714 4109]
 [6234 6976 5074]]
Evaluating performance on  val set...
53/53 - 1s - 903ms/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1167338
{'0': {'precision': 0.30916414904330314, 'recall': 0.43128073050807775, 'f1-score': 0.36015250757649814, 'support': 4271}, '1': {'precision': 0.3384725708139118, 'recall': 0.4124071647007427, 'f1-score': 0.37179992122883027, 'support': 4578}, '2': {'precision': 0.36162551440329216, 'recall': 0.15180306629237747, 'f1-score': 0.21384030418250952, 'support': 4631}, 'accuracy': 0.32885756676557865, 'macro avg': {'precision': 0.33642074475350237, 'recall': 0.33183032050039935, 'f1-score': 0.3152642443292793, 'support': 13480}, 'weighted avg': {'precision': 0.3371405984385521, 'recall': 0.32885756676557865, 'f1-score': 0.3138431637918405, 'support': 13480}}
[[1842 1838  591]
 [2040 1888  650]
 [2076 1852  703]]
training model: results/LILAK/W9/deepOF_L2/h10
Epoch 1/50
200/200 - 7s - loss: 3.2707 - accuracy10: 0.4135 - val_loss: 3.2186 - val_accuracy10: 0.3889 - 7s/epoch - 34ms/step
Epoch 2/50
200/200 - 5s - loss: 3.1607 - accuracy10: 0.4731 - val_loss: 3.1421 - val_accuracy10: 0.4527 - 5s/epoch - 24ms/step
Epoch 3/50
200/200 - 5s - loss: 3.1078 - accuracy10: 0.4905 - val_loss: 3.1048 - val_accuracy10: 0.4657 - 5s/epoch - 24ms/step
Epoch 4/50
200/200 - 5s - loss: 3.0705 - accuracy10: 0.4996 - val_loss: 3.0754 - val_accuracy10: 0.4782 - 5s/epoch - 24ms/step
Epoch 5/50
200/200 - 5s - loss: 3.0382 - accuracy10: 0.5068 - val_loss: 3.0559 - val_accuracy10: 0.4855 - 5s/epoch - 24ms/step
Epoch 6/50
200/200 - 5s - loss: 3.0057 - accuracy10: 0.5149 - val_loss: 3.0323 - val_accuracy10: 0.4962 - 5s/epoch - 24ms/step
Epoch 7/50
200/200 - 5s - loss: 2.9762 - accuracy10: 0.5218 - val_loss: 3.0214 - val_accuracy10: 0.4978 - 5s/epoch - 25ms/step
Epoch 8/50
200/200 - 5s - loss: 2.9513 - accuracy10: 0.5251 - val_loss: 3.0214 - val_accuracy10: 0.4870 - 5s/epoch - 24ms/step
Epoch 9/50
200/200 - 5s - loss: 2.9325 - accuracy10: 0.5310 - val_loss: 3.0034 - val_accuracy10: 0.4989 - 5s/epoch - 24ms/step
Epoch 10/50
200/200 - 5s - loss: 2.9084 - accuracy10: 0.5355 - val_loss: 2.9979 - val_accuracy10: 0.4941 - 5s/epoch - 24ms/step
Epoch 11/50
200/200 - 5s - loss: 2.8873 - accuracy10: 0.5394 - val_loss: 2.9783 - val_accuracy10: 0.5108 - 5s/epoch - 23ms/step
Epoch 12/50
200/200 - 5s - loss: 2.8756 - accuracy10: 0.5441 - val_loss: 2.9885 - val_accuracy10: 0.4993 - 5s/epoch - 23ms/step
Epoch 13/50
200/200 - 5s - loss: 2.8526 - accuracy10: 0.5479 - val_loss: 2.9744 - val_accuracy10: 0.5022 - 5s/epoch - 24ms/step
Epoch 14/50
200/200 - 5s - loss: 2.8399 - accuracy10: 0.5514 - val_loss: 2.9776 - val_accuracy10: 0.5022 - 5s/epoch - 24ms/step
Epoch 15/50
200/200 - 5s - loss: 2.8241 - accuracy10: 0.5526 - val_loss: 2.9726 - val_accuracy10: 0.5085 - 5s/epoch - 24ms/step
Epoch 16/50
200/200 - 5s - loss: 2.8039 - accuracy10: 0.5568 - val_loss: 2.9739 - val_accuracy10: 0.5059 - 5s/epoch - 23ms/step
Epoch 17/50
200/200 - 5s - loss: 2.7878 - accuracy10: 0.5614 - val_loss: 2.9846 - val_accuracy10: 0.4991 - 5s/epoch - 23ms/step
Epoch 18/50
200/200 - 5s - loss: 2.7754 - accuracy10: 0.5631 - val_loss: 2.9941 - val_accuracy10: 0.4961 - 5s/epoch - 24ms/step
Epoch 19/50
200/200 - 5s - loss: 2.7598 - accuracy10: 0.5653 - val_loss: 2.9741 - val_accuracy10: 0.5077 - 5s/epoch - 24ms/step
Epoch 20/50
200/200 - 5s - loss: 2.7445 - accuracy10: 0.5701 - val_loss: 2.9803 - val_accuracy10: 0.5089 - 5s/epoch - 24ms/step
Epoch 21/50
200/200 - 5s - loss: 2.7253 - accuracy10: 0.5740 - val_loss: 2.9841 - val_accuracy10: 0.5080 - 5s/epoch - 24ms/step
Epoch 22/50
200/200 - 5s - loss: 2.7172 - accuracy10: 0.5756 - val_loss: 3.0016 - val_accuracy10: 0.5088 - 5s/epoch - 24ms/step
Epoch 23/50
200/200 - 5s - loss: 2.6930 - accuracy10: 0.5815 - val_loss: 3.0036 - val_accuracy10: 0.5101 - 5s/epoch - 23ms/step
Epoch 24/50
200/200 - 5s - loss: 2.6784 - accuracy10: 0.5832 - val_loss: 3.0103 - val_accuracy10: 0.5065 - 5s/epoch - 23ms/step
Epoch 25/50
200/200 - 5s - loss: 2.6655 - accuracy10: 0.5865 - val_loss: 3.0069 - val_accuracy10: 0.5083 - 5s/epoch - 23ms/step
testing model: results/LILAK/W9/deepOF_L2/h10
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0467036
{'0': {'precision': 0.39477194765595225, 'recall': 0.5814464820359282, 'f1-score': 0.47026106696935305, 'support': 21376}, '1': {'precision': 0.6333544504276212, 'recall': 0.38899516876884666, 'f1-score': 0.4819717574272342, 'support': 30841}, '2': {'precision': 0.4629971135343169, 'recall': 0.49881224895261955, 'f1-score': 0.48023785267272395, 'support': 23153}, 'accuracy': 0.4773119278227411, 'macro avg': {'precision': 0.4970411705392968, 'recall': 0.4897512999191315, 'f1-score': 0.4774902256897704, 'support': 75370}, 'weighted avg': {'precision': 0.5133567988376269, 'recall': 0.4773119278227411, 'f1-score': 0.4781177994066843, 'support': 75370}}
[[12429  2912  6035]
 [11484 11997  7360]
 [ 7571  4033 11549]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9688388
{'0': {'precision': 0.46320126138039774, 'recall': 0.6212989493791786, 'f1-score': 0.5307264197674758, 'support': 14658}, '1': {'precision': 0.6959208032015727, 'recall': 0.44783806985044955, 'f1-score': 0.5449747085990763, 'support': 22133}, '2': {'precision': 0.4792404622263515, 'recall': 0.5757639179573043, 'f1-score': 0.5230866740611629, 'support': 14334}, 'accuracy': 0.5334376528117359, 'macro avg': {'precision': 0.5461208422694407, 'recall': 0.5483003123956441, 'f1-score': 0.5329292674759051, 'support': 51125}, 'weighted avg': {'precision': 0.5684469831222846, 'recall': 0.5334376528117359, 'f1-score': 0.5347528111954567, 'support': 51125}}
[[9107 2053 3498]
 [6751 9912 5470]
 [3803 2278 8253]]
Evaluating performance on  val set...
53/53 - 1s - 616ms/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0082355
{'0': {'precision': 0.4110586383313656, 'recall': 0.5704533042053522, 'f1-score': 0.4778133577310155, 'support': 3662}, '1': {'precision': 0.6758620689655173, 'recall': 0.4692866578599736, 'f1-score': 0.5539421109053699, 'support': 6056}, '2': {'precision': 0.4586215120438827, 'recall': 0.511164274322169, 'f1-score': 0.48346951602765553, 'support': 3762}, 'accuracy': 0.5084569732937686, 'macro avg': {'precision': 0.5151807397802552, 'recall': 0.5169680787958316, 'f1-score': 0.5050749948880137, 'support': 13480}, 'weighted avg': {'precision': 0.5432975928437478, 'recall': 0.5084569732937686, 'f1-score': 0.5135933426520727, 'support': 13480}}
[[2089  647  926]
 [1870 2842 1344]
 [1123  716 1923]]
training model: results/LILAK/W9/deepOF_L2/h20
Epoch 1/50
200/200 - 7s - loss: 3.2878 - accuracy20: 0.3907 - val_loss: 3.2753 - val_accuracy20: 0.3742 - 7s/epoch - 34ms/step
Epoch 2/50
200/200 - 5s - loss: 3.2016 - accuracy20: 0.4369 - val_loss: 3.2232 - val_accuracy20: 0.4211 - 5s/epoch - 24ms/step
Epoch 3/50
200/200 - 5s - loss: 3.1586 - accuracy20: 0.4542 - val_loss: 3.1842 - val_accuracy20: 0.4398 - 5s/epoch - 24ms/step
Epoch 4/50
200/200 - 5s - loss: 3.1293 - accuracy20: 0.4654 - val_loss: 3.1719 - val_accuracy20: 0.4458 - 5s/epoch - 24ms/step
Epoch 5/50
200/200 - 5s - loss: 3.0986 - accuracy20: 0.4753 - val_loss: 3.1444 - val_accuracy20: 0.4604 - 5s/epoch - 24ms/step
Epoch 6/50
200/200 - 5s - loss: 3.0768 - accuracy20: 0.4791 - val_loss: 3.1106 - val_accuracy20: 0.4710 - 5s/epoch - 24ms/step
Epoch 7/50
200/200 - 5s - loss: 3.0552 - accuracy20: 0.4840 - val_loss: 3.1021 - val_accuracy20: 0.4754 - 5s/epoch - 24ms/step
Epoch 8/50
200/200 - 5s - loss: 3.0329 - accuracy20: 0.4928 - val_loss: 3.0961 - val_accuracy20: 0.4738 - 5s/epoch - 24ms/step
Epoch 9/50
200/200 - 5s - loss: 3.0192 - accuracy20: 0.4977 - val_loss: 3.1034 - val_accuracy20: 0.4688 - 5s/epoch - 24ms/step
Epoch 10/50
200/200 - 5s - loss: 2.9994 - accuracy20: 0.5032 - val_loss: 3.0935 - val_accuracy20: 0.4737 - 5s/epoch - 24ms/step
Epoch 11/50
200/200 - 5s - loss: 2.9851 - accuracy20: 0.5067 - val_loss: 3.0856 - val_accuracy20: 0.4801 - 5s/epoch - 24ms/step
Epoch 12/50
200/200 - 5s - loss: 2.9709 - accuracy20: 0.5080 - val_loss: 3.0787 - val_accuracy20: 0.4804 - 5s/epoch - 24ms/step
Epoch 13/50
200/200 - 5s - loss: 2.9548 - accuracy20: 0.5133 - val_loss: 3.0787 - val_accuracy20: 0.4770 - 5s/epoch - 24ms/step
Epoch 14/50
200/200 - 5s - loss: 2.9433 - accuracy20: 0.5169 - val_loss: 3.0766 - val_accuracy20: 0.4874 - 5s/epoch - 24ms/step
Epoch 15/50
200/200 - 5s - loss: 2.9317 - accuracy20: 0.5202 - val_loss: 3.0555 - val_accuracy20: 0.4949 - 5s/epoch - 24ms/step
Epoch 16/50
200/200 - 5s - loss: 2.9100 - accuracy20: 0.5276 - val_loss: 3.0606 - val_accuracy20: 0.4915 - 5s/epoch - 24ms/step
Epoch 17/50
200/200 - 5s - loss: 2.8976 - accuracy20: 0.5295 - val_loss: 3.0485 - val_accuracy20: 0.4960 - 5s/epoch - 24ms/step
Epoch 18/50
200/200 - 5s - loss: 2.8871 - accuracy20: 0.5319 - val_loss: 3.0471 - val_accuracy20: 0.4935 - 5s/epoch - 24ms/step
Epoch 19/50
200/200 - 5s - loss: 2.8696 - accuracy20: 0.5385 - val_loss: 3.0630 - val_accuracy20: 0.4903 - 5s/epoch - 23ms/step
Epoch 20/50
200/200 - 5s - loss: 2.8591 - accuracy20: 0.5402 - val_loss: 3.0648 - val_accuracy20: 0.4872 - 5s/epoch - 23ms/step
Epoch 21/50
200/200 - 5s - loss: 2.8432 - accuracy20: 0.5444 - val_loss: 3.0687 - val_accuracy20: 0.4864 - 5s/epoch - 24ms/step
Epoch 22/50
200/200 - 5s - loss: 2.8243 - accuracy20: 0.5494 - val_loss: 3.0833 - val_accuracy20: 0.4852 - 5s/epoch - 24ms/step
Epoch 23/50
200/200 - 5s - loss: 2.8068 - accuracy20: 0.5549 - val_loss: 3.0896 - val_accuracy20: 0.4827 - 5s/epoch - 23ms/step
Epoch 24/50
200/200 - 5s - loss: 2.7904 - accuracy20: 0.5582 - val_loss: 3.0778 - val_accuracy20: 0.4872 - 5s/epoch - 24ms/step
Epoch 25/50
200/200 - 5s - loss: 2.7801 - accuracy20: 0.5625 - val_loss: 3.0952 - val_accuracy20: 0.4848 - 5s/epoch - 23ms/step
Epoch 26/50
200/200 - 5s - loss: 2.7649 - accuracy20: 0.5657 - val_loss: 3.1106 - val_accuracy20: 0.4854 - 5s/epoch - 23ms/step
Epoch 27/50
200/200 - 5s - loss: 2.7420 - accuracy20: 0.5720 - val_loss: 3.1148 - val_accuracy20: 0.4843 - 5s/epoch - 23ms/step
Epoch 28/50
200/200 - 5s - loss: 2.7325 - accuracy20: 0.5732 - val_loss: 3.1296 - val_accuracy20: 0.4800 - 5s/epoch - 24ms/step
testing model: results/LILAK/W9/deepOF_L2/h20
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0639291
{'0': {'precision': 0.41210063771058725, 'recall': 0.5379581693932491, 'f1-score': 0.4666930152342627, 'support': 24145}, '1': {'precision': 0.5059450813116503, 'recall': 0.38515241303730163, 'f1-score': 0.43736172566371684, 'support': 24637}, '2': {'precision': 0.47453777494421423, 'recall': 0.44790883105160223, 'f1-score': 0.4608389443541521, 'support': 26588}, 'accuracy': 0.45624253681836274, 'macro avg': {'precision': 0.4641944979888173, 'recall': 0.45700647116071763, 'f1-score': 0.45496456175071054, 'support': 75370}, 'weighted avg': {'precision': 0.4648022983417012, 'recall': 0.45624253681836274, 'f1-score': 0.4550400628963309, 'support': 75370}}
[[12989  4116  7040]
 [ 9001  9489  6147]
 [ 9529  5150 11909]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96953285
{'0': {'precision': 0.5016797312430011, 'recall': 0.5853079161470396, 'f1-score': 0.5402768260929148, 'support': 16839}, '1': {'precision': 0.5887057850099979, 'recall': 0.4788021534320323, 'f1-score': 0.528096489871656, 'support': 17832}, '2': {'precision': 0.5136074458058435, 'recall': 0.5299015436975811, 'f1-score': 0.5216272808854322, 'support': 16454}, 'accuracy': 0.5303276283618582, 'macro avg': {'precision': 0.5346643206862808, 'recall': 0.531337204425551, 'f1-score': 0.5300001989500011, 'support': 51125}, 'weighted avg': {'precision': 0.5358725372320494, 'recall': 0.5303276283618582, 'f1-score': 0.5300262760226673, 'support': 51125}}
[[9856 2975 4008]
 [5045 8538 4249]
 [4745 2990 8719]]
Evaluating performance on  val set...
53/53 - 1s - 598ms/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0191524
{'0': {'precision': 0.4376600354540083, 'recall': 0.5244276610809535, 'f1-score': 0.4771312003435688, 'support': 4237}, '1': {'precision': 0.5736154885186853, 'recall': 0.5130890052356021, 'f1-score': 0.5416666666666667, 'support': 4966}, '2': {'precision': 0.4748800807876799, 'recall': 0.4397942483048866, 'f1-score': 0.45666423889293517, 'support': 4277}, 'accuracy': 0.49339762611275967, 'macro avg': {'precision': 0.49538520158679117, 'recall': 0.4924369715404808, 'f1-score': 0.4918207019677236, 'support': 13480}, 'weighted avg': {'precision': 0.49955505873377826, 'recall': 0.49339762611275967, 'f1-score': 0.4944120558061908, 'support': 13480}}
[[2222  947 1068]
 [1406 2548 1012]
 [1449  947 1881]]
training model: results/LILAK/W9/deepOF_L2/h30
Epoch 1/50
200/200 - 7s - loss: 3.3109 - accuracy30: 0.3732 - val_loss: 3.3062 - val_accuracy30: 0.3666 - 7s/epoch - 33ms/step
Epoch 2/50
200/200 - 5s - loss: 3.2426 - accuracy30: 0.4123 - val_loss: 3.2749 - val_accuracy30: 0.3937 - 5s/epoch - 24ms/step
Epoch 3/50
200/200 - 5s - loss: 3.2079 - accuracy30: 0.4287 - val_loss: 3.2580 - val_accuracy30: 0.4073 - 5s/epoch - 24ms/step
Epoch 4/50
200/200 - 5s - loss: 3.1838 - accuracy30: 0.4361 - val_loss: 3.2333 - val_accuracy30: 0.4180 - 5s/epoch - 24ms/step
Epoch 5/50
200/200 - 5s - loss: 3.1611 - accuracy30: 0.4471 - val_loss: 3.2198 - val_accuracy30: 0.4302 - 5s/epoch - 24ms/step
Epoch 6/50
200/200 - 5s - loss: 3.1391 - accuracy30: 0.4512 - val_loss: 3.2039 - val_accuracy30: 0.4349 - 5s/epoch - 24ms/step
Epoch 7/50
200/200 - 5s - loss: 3.1200 - accuracy30: 0.4587 - val_loss: 3.1900 - val_accuracy30: 0.4445 - 5s/epoch - 24ms/step
Epoch 8/50
200/200 - 5s - loss: 3.1034 - accuracy30: 0.4649 - val_loss: 3.1774 - val_accuracy30: 0.4433 - 5s/epoch - 24ms/step
Epoch 9/50
200/200 - 5s - loss: 3.0861 - accuracy30: 0.4699 - val_loss: 3.1668 - val_accuracy30: 0.4493 - 5s/epoch - 24ms/step
Epoch 10/50
200/200 - 5s - loss: 3.0699 - accuracy30: 0.4748 - val_loss: 3.1630 - val_accuracy30: 0.4525 - 5s/epoch - 24ms/step
Epoch 11/50
200/200 - 5s - loss: 3.0539 - accuracy30: 0.4800 - val_loss: 3.1638 - val_accuracy30: 0.4504 - 5s/epoch - 24ms/step
Epoch 12/50
200/200 - 5s - loss: 3.0431 - accuracy30: 0.4831 - val_loss: 3.1634 - val_accuracy30: 0.4536 - 5s/epoch - 24ms/step
Epoch 13/50
200/200 - 5s - loss: 3.0270 - accuracy30: 0.4895 - val_loss: 3.1680 - val_accuracy30: 0.4520 - 5s/epoch - 24ms/step
Epoch 14/50
200/200 - 5s - loss: 3.0144 - accuracy30: 0.4937 - val_loss: 3.1633 - val_accuracy30: 0.4547 - 5s/epoch - 24ms/step
Epoch 15/50
200/200 - 5s - loss: 3.0047 - accuracy30: 0.4961 - val_loss: 3.1596 - val_accuracy30: 0.4573 - 5s/epoch - 24ms/step
Epoch 16/50
200/200 - 5s - loss: 2.9870 - accuracy30: 0.5004 - val_loss: 3.1651 - val_accuracy30: 0.4499 - 5s/epoch - 24ms/step
Epoch 17/50
200/200 - 5s - loss: 2.9763 - accuracy30: 0.5055 - val_loss: 3.1534 - val_accuracy30: 0.4602 - 5s/epoch - 24ms/step
Epoch 18/50
200/200 - 5s - loss: 2.9615 - accuracy30: 0.5112 - val_loss: 3.1551 - val_accuracy30: 0.4586 - 5s/epoch - 23ms/step
Epoch 19/50
200/200 - 5s - loss: 2.9443 - accuracy30: 0.5167 - val_loss: 3.1684 - val_accuracy30: 0.4567 - 5s/epoch - 24ms/step
Epoch 20/50
200/200 - 5s - loss: 2.9358 - accuracy30: 0.5162 - val_loss: 3.1666 - val_accuracy30: 0.4562 - 5s/epoch - 24ms/step
Epoch 21/50
200/200 - 5s - loss: 2.9215 - accuracy30: 0.5219 - val_loss: 3.1635 - val_accuracy30: 0.4602 - 5s/epoch - 23ms/step
Epoch 22/50
200/200 - 5s - loss: 2.9031 - accuracy30: 0.5277 - val_loss: 3.1883 - val_accuracy30: 0.4544 - 5s/epoch - 24ms/step
Epoch 23/50
200/200 - 5s - loss: 2.8869 - accuracy30: 0.5306 - val_loss: 3.1895 - val_accuracy30: 0.4539 - 5s/epoch - 23ms/step
Epoch 24/50
200/200 - 5s - loss: 2.8750 - accuracy30: 0.5364 - val_loss: 3.2008 - val_accuracy30: 0.4543 - 5s/epoch - 24ms/step
Epoch 25/50
200/200 - 5s - loss: 2.8533 - accuracy30: 0.5422 - val_loss: 3.2038 - val_accuracy30: 0.4548 - 5s/epoch - 23ms/step
Epoch 26/50
200/200 - 5s - loss: 2.8437 - accuracy30: 0.5453 - val_loss: 3.2232 - val_accuracy30: 0.4518 - 5s/epoch - 23ms/step
Epoch 27/50
200/200 - 5s - loss: 2.8292 - accuracy30: 0.5498 - val_loss: 3.2303 - val_accuracy30: 0.4524 - 5s/epoch - 23ms/step
testing model: results/LILAK/W9/deepOF_L2/h30
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0755609
{'0': {'precision': 0.4074820233077114, 'recall': 0.5214373537460834, 'f1-score': 0.457469944499539, 'support': 25213}, '1': {'precision': 0.4363606770833333, 'recall': 0.3564369598936406, 'f1-score': 0.39237017342732394, 'support': 22565}, '2': {'precision': 0.4618626894706979, 'recall': 0.41301826616410553, 'f1-score': 0.43607699077794365, 'support': 27592}, 'accuracy': 0.43234708770067665, 'macro avg': {'precision': 0.43523512995391417, 'recall': 0.4302975266012765, 'f1-score': 0.4286390362349355, 'support': 75370}, 'weighted avg': {'precision': 0.43603606554223484, 'recall': 0.43234708770067665, 'f1-score': 0.43014805630356195, 'support': 75370}}
[[13147  4756  7310]
 [ 8554  8043  5968]
 [10563  5633 11396]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99692976
{'0': {'precision': 0.4851236476043277, 'recall': 0.5734840698869476, 'f1-score': 0.5256162017897327, 'support': 17514}, '1': {'precision': 0.5319647677226879, 'recall': 0.4533841869475723, 'f1-score': 0.4895411164858151, 'support': 16518}, '2': {'precision': 0.5050480327969161, 'recall': 0.4828877318200433, 'f1-score': 0.4937193444191889, 'support': 17093}, 'accuracy': 0.5043911980440098, 'macro avg': {'precision': 0.5073788160413106, 'recall': 0.5032519962181877, 'f1-score': 0.5029588875649122, 'support': 51125}, 'weighted avg': {'precision': 0.5069190341708213, 'recall': 0.5043911980440098, 'f1-score': 0.5032963730936971, 'support': 51125}}
[[10044  3331  4139]
 [ 5079  7489  3950]
 [ 5581  3258  8254]]
Evaluating performance on  val set...
53/53 - 1s - 609ms/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0463206
{'0': {'precision': 0.428598922247883, 'recall': 0.5030494691664784, 'f1-score': 0.46284942325678063, 'support': 4427}, '1': {'precision': 0.5158969598514737, 'recall': 0.4725765306122449, 'f1-score': 0.49328747364917347, 'support': 4704}, '2': {'precision': 0.4450314465408805, 'recall': 0.4067601747528167, 'f1-score': 0.42503604036520903, 'support': 4349}, 'accuracy': 0.4613501483679525, 'macro avg': {'precision': 0.4631757762134124, 'recall': 0.46079539151051335, 'f1-score': 0.46039097909038773, 'support': 13480}, 'weighted avg': {'precision': 0.4643641312269287, 'recall': 0.4613501483679525, 'f1-score': 0.4612715439430099, 'support': 13480}}
[[2227 1067 1133]
 [1408 2223 1073]
 [1561 1019 1769]]
training model: results/LILAK/W9/deepOF_L2/h50
Epoch 1/50
200/200 - 7s - loss: 3.3398 - accuracy50: 0.3499 - val_loss: 3.3431 - val_accuracy50: 0.3431 - 7s/epoch - 33ms/step
Epoch 2/50
200/200 - 5s - loss: 3.2950 - accuracy50: 0.3766 - val_loss: 3.3143 - val_accuracy50: 0.3612 - 5s/epoch - 24ms/step
Epoch 3/50
200/200 - 5s - loss: 3.2671 - accuracy50: 0.3926 - val_loss: 3.3096 - val_accuracy50: 0.3649 - 5s/epoch - 24ms/step
Epoch 4/50
200/200 - 5s - loss: 3.2504 - accuracy50: 0.4021 - val_loss: 3.2996 - val_accuracy50: 0.3648 - 5s/epoch - 24ms/step
Epoch 5/50
200/200 - 5s - loss: 3.2349 - accuracy50: 0.4088 - val_loss: 3.2898 - val_accuracy50: 0.3757 - 5s/epoch - 24ms/step
Epoch 6/50
200/200 - 5s - loss: 3.2172 - accuracy50: 0.4136 - val_loss: 3.2817 - val_accuracy50: 0.3793 - 5s/epoch - 24ms/step
Epoch 7/50
200/200 - 5s - loss: 3.2029 - accuracy50: 0.4193 - val_loss: 3.2690 - val_accuracy50: 0.3904 - 5s/epoch - 24ms/step
Epoch 8/50
200/200 - 5s - loss: 3.1904 - accuracy50: 0.4266 - val_loss: 3.2598 - val_accuracy50: 0.3915 - 5s/epoch - 24ms/step
Epoch 9/50
200/200 - 5s - loss: 3.1752 - accuracy50: 0.4312 - val_loss: 3.2535 - val_accuracy50: 0.3957 - 5s/epoch - 24ms/step
Epoch 10/50
200/200 - 5s - loss: 3.1646 - accuracy50: 0.4347 - val_loss: 3.2529 - val_accuracy50: 0.3970 - 5s/epoch - 24ms/step
Epoch 11/50
200/200 - 5s - loss: 3.1486 - accuracy50: 0.4412 - val_loss: 3.2446 - val_accuracy50: 0.4021 - 5s/epoch - 24ms/step
Epoch 12/50
200/200 - 5s - loss: 3.1371 - accuracy50: 0.4439 - val_loss: 3.2446 - val_accuracy50: 0.3992 - 5s/epoch - 23ms/step
Epoch 13/50
200/200 - 5s - loss: 3.1257 - accuracy50: 0.4473 - val_loss: 3.2330 - val_accuracy50: 0.4062 - 5s/epoch - 24ms/step
Epoch 14/50
200/200 - 5s - loss: 3.1140 - accuracy50: 0.4546 - val_loss: 3.2323 - val_accuracy50: 0.4066 - 5s/epoch - 24ms/step
Epoch 15/50
200/200 - 5s - loss: 3.1055 - accuracy50: 0.4550 - val_loss: 3.2304 - val_accuracy50: 0.4102 - 5s/epoch - 24ms/step
Epoch 16/50
200/200 - 5s - loss: 3.0934 - accuracy50: 0.4589 - val_loss: 3.2334 - val_accuracy50: 0.4104 - 5s/epoch - 23ms/step
Epoch 17/50
200/200 - 5s - loss: 3.0864 - accuracy50: 0.4643 - val_loss: 3.2363 - val_accuracy50: 0.4105 - 5s/epoch - 23ms/step
Epoch 18/50
200/200 - 5s - loss: 3.0733 - accuracy50: 0.4672 - val_loss: 3.2421 - val_accuracy50: 0.4096 - 5s/epoch - 23ms/step
Epoch 19/50
200/200 - 5s - loss: 3.0608 - accuracy50: 0.4701 - val_loss: 3.2357 - val_accuracy50: 0.4142 - 5s/epoch - 23ms/step
Epoch 20/50
200/200 - 5s - loss: 3.0497 - accuracy50: 0.4761 - val_loss: 3.2384 - val_accuracy50: 0.4159 - 5s/epoch - 23ms/step
Epoch 21/50
200/200 - 5s - loss: 3.0337 - accuracy50: 0.4811 - val_loss: 3.2480 - val_accuracy50: 0.4175 - 5s/epoch - 24ms/step
Epoch 22/50
200/200 - 5s - loss: 3.0259 - accuracy50: 0.4845 - val_loss: 3.2560 - val_accuracy50: 0.4140 - 5s/epoch - 23ms/step
Epoch 23/50
200/200 - 5s - loss: 3.0141 - accuracy50: 0.4863 - val_loss: 3.2561 - val_accuracy50: 0.4123 - 5s/epoch - 23ms/step
Epoch 24/50
200/200 - 5s - loss: 3.0026 - accuracy50: 0.4921 - val_loss: 3.2732 - val_accuracy50: 0.4084 - 5s/epoch - 23ms/step
Epoch 25/50
200/200 - 5s - loss: 2.9882 - accuracy50: 0.4960 - val_loss: 3.2711 - val_accuracy50: 0.4122 - 5s/epoch - 23ms/step
testing model: results/LILAK/W9/deepOF_L2/h50
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1048881
{'0': {'precision': 0.3627678297064, 'recall': 0.5286383065336862, 'f1-score': 0.4302707001093403, 'support': 24565}, '1': {'precision': 0.3722443837917279, 'recall': 0.2259846199600629, 'f1-score': 0.28123512927615923, 'support': 23537}, '2': {'precision': 0.4135421610504667, 'recall': 0.3834531318761919, 'f1-score': 0.39792966966052673, 'support': 27268}, 'accuracy': 0.38159745256733446, 'macro avg': {'precision': 0.38285145818286487, 'recall': 0.37935868612331364, 'f1-score': 0.3698118330153421, 'support': 75370}, 'weighted avg': {'precision': 0.3840967950851498, 'recall': 0.38159745256733446, 'f1-score': 0.372028356352158, 'support': 75370}}
[[12986  4300  7279]
 [10669  5319  7549]
 [12142  4670 10456]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0395018
{'0': {'precision': 0.4306655933567767, 'recall': 0.5848676639815881, 'f1-score': 0.4960593416782568, 'support': 17380}, '1': {'precision': 0.4880425954336251, 'recall': 0.3222884386174017, 'f1-score': 0.38821291410932846, 'support': 16780}, '2': {'precision': 0.45648074934614685, 'recall': 0.44238137341585615, 'f1-score': 0.44932048135065555, 'support': 16965}, 'accuracy': 0.4514034229828851, 'macro avg': {'precision': 0.4583963127121829, 'recall': 0.449845825338282, 'f1-score': 0.4445309123794136, 'support': 51125}, 'weighted avg': {'precision': 0.45806393499412007, 'recall': 0.4514034229828851, 'f1-score': 0.4451529784496139, 'support': 51125}}
[[10165  2903  4312]
 [ 6748  5408  4624]
 [ 6690  2770  7505]]
Evaluating performance on  val set...
53/53 - 1s - 602ms/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0754232
{'0': {'precision': 0.38734516237027117, 'recall': 0.5277080957810718, 'f1-score': 0.44676127039289504, 'support': 4385}, '1': {'precision': 0.47876794258373206, 'recall': 0.33347219329306393, 'f1-score': 0.3931246163290362, 'support': 4801}, '2': {'precision': 0.3945218644882268, 'recall': 0.3823940381928272, 'f1-score': 0.3883632923368023, 'support': 4294}, 'accuracy': 0.41224035608308607, 'macro avg': {'precision': 0.4202116564807434, 'recall': 0.41452477575565433, 'f1-score': 0.40941639301957783, 'support': 13480}, 'weighted avg': {'precision': 0.42219215989989484, 'recall': 0.41224035608308607, 'f1-score': 0.4090557441367045, 'support': 13480}}
[[2314  888 1183]
 [1863 1601 1337]
 [1797  855 1642]]
training model: results/LILAK/W9/deepOF_L2/h100
Epoch 1/50
200/200 - 7s - loss: 3.3536 - accuracy100: 0.3350 - val_loss: 3.3548 - val_accuracy100: 0.3332 - 7s/epoch - 34ms/step
Epoch 2/50
200/200 - 5s - loss: 3.3218 - accuracy100: 0.3487 - val_loss: 3.3409 - val_accuracy100: 0.3405 - 5s/epoch - 24ms/step
Epoch 3/50
200/200 - 5s - loss: 3.2952 - accuracy100: 0.3662 - val_loss: 3.3329 - val_accuracy100: 0.3463 - 5s/epoch - 24ms/step
Epoch 4/50
200/200 - 5s - loss: 3.2811 - accuracy100: 0.3714 - val_loss: 3.3194 - val_accuracy100: 0.3522 - 5s/epoch - 23ms/step
Epoch 5/50
200/200 - 5s - loss: 3.2681 - accuracy100: 0.3804 - val_loss: 3.3140 - val_accuracy100: 0.3564 - 5s/epoch - 24ms/step
Epoch 6/50
200/200 - 5s - loss: 3.2541 - accuracy100: 0.3854 - val_loss: 3.3032 - val_accuracy100: 0.3581 - 5s/epoch - 24ms/step
Epoch 7/50
200/200 - 5s - loss: 3.2414 - accuracy100: 0.3939 - val_loss: 3.3002 - val_accuracy100: 0.3594 - 5s/epoch - 24ms/step
Epoch 8/50
200/200 - 5s - loss: 3.2320 - accuracy100: 0.3948 - val_loss: 3.2941 - val_accuracy100: 0.3581 - 5s/epoch - 24ms/step
Epoch 9/50
200/200 - 5s - loss: 3.2187 - accuracy100: 0.4005 - val_loss: 3.2953 - val_accuracy100: 0.3522 - 5s/epoch - 23ms/step
Epoch 10/50
200/200 - 5s - loss: 3.2099 - accuracy100: 0.4064 - val_loss: 3.2935 - val_accuracy100: 0.3579 - 5s/epoch - 24ms/step
Epoch 11/50
200/200 - 5s - loss: 3.2013 - accuracy100: 0.4120 - val_loss: 3.2853 - val_accuracy100: 0.3629 - 5s/epoch - 24ms/step
Epoch 12/50
200/200 - 5s - loss: 3.1913 - accuracy100: 0.4173 - val_loss: 3.2830 - val_accuracy100: 0.3646 - 5s/epoch - 24ms/step
Epoch 13/50
200/200 - 5s - loss: 3.1817 - accuracy100: 0.4222 - val_loss: 3.2875 - val_accuracy100: 0.3654 - 5s/epoch - 24ms/step
Epoch 14/50
200/200 - 5s - loss: 3.1744 - accuracy100: 0.4258 - val_loss: 3.2877 - val_accuracy100: 0.3701 - 5s/epoch - 23ms/step
Epoch 15/50
200/200 - 5s - loss: 3.1663 - accuracy100: 0.4282 - val_loss: 3.2924 - val_accuracy100: 0.3649 - 5s/epoch - 23ms/step
Epoch 16/50
200/200 - 5s - loss: 3.1503 - accuracy100: 0.4357 - val_loss: 3.2861 - val_accuracy100: 0.3768 - 5s/epoch - 23ms/step
Epoch 17/50
200/200 - 5s - loss: 3.1479 - accuracy100: 0.4370 - val_loss: 3.2847 - val_accuracy100: 0.3760 - 5s/epoch - 23ms/step
Epoch 18/50
200/200 - 5s - loss: 3.1370 - accuracy100: 0.4436 - val_loss: 3.3013 - val_accuracy100: 0.3640 - 5s/epoch - 23ms/step
Epoch 19/50
200/200 - 5s - loss: 3.1277 - accuracy100: 0.4446 - val_loss: 3.3040 - val_accuracy100: 0.3682 - 5s/epoch - 23ms/step
Epoch 20/50
200/200 - 5s - loss: 3.1178 - accuracy100: 0.4489 - val_loss: 3.3001 - val_accuracy100: 0.3695 - 5s/epoch - 23ms/step
Epoch 21/50
200/200 - 5s - loss: 3.1067 - accuracy100: 0.4554 - val_loss: 3.3043 - val_accuracy100: 0.3727 - 5s/epoch - 23ms/step
Epoch 22/50
200/200 - 5s - loss: 3.0935 - accuracy100: 0.4593 - val_loss: 3.3194 - val_accuracy100: 0.3703 - 5s/epoch - 23ms/step
testing model: results/LILAK/W9/deepOF_L2/h100
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.111281
{'0': {'precision': 0.3254182231606302, 'recall': 0.42748026456155325, 'f1-score': 0.3695315381777942, 'support': 23435}, '1': {'precision': 0.38076321174912725, 'recall': 0.2280543638919932, 'f1-score': 0.2852569161048858, 'support': 27739}, '2': {'precision': 0.3490758285366987, 'recall': 0.4035377748388163, 'f1-score': 0.374336266221941, 'support': 24196}, 'accuracy': 0.34639777099641766, 'macro avg': {'precision': 0.3517524211488188, 'recall': 0.3530241344307876, 'f1-score': 0.34304157350154035, 'support': 75370}, 'weighted avg': {'precision': 0.35338205569526837, 'recall': 0.34639777099641766, 'f1-score': 0.3400577615833371, 'support': 75370}}
[[10018  5166  8251]
 [11457  6326  9956]
 [ 9310  5122  9764]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0635765
{'0': {'precision': 0.4185988281836847, 'recall': 0.4764863478310437, 'f1-score': 0.44567071870334823, 'support': 17543}, '1': {'precision': 0.4192469336992881, 'recall': 0.2972693547406191, 'f1-score': 0.3478755960429863, 'support': 16443}, '2': {'precision': 0.4078576191208904, 'recall': 0.46397106015520156, 'f1-score': 0.434108527131783, 'support': 17139}, 'accuracy': 0.41465036674816624, 'macro avg': {'precision': 0.41523446033462114, 'recall': 0.41257558757562146, 'f1-score': 0.40921828062603915, 'support': 51125}, 'weighted avg': {'precision': 0.415206421667613, 'recall': 0.41465036674816624, 'f1-score': 0.4103414355102062, 'support': 51125}}
[[8359 3422 5762]
 [5772 4888 5783]
 [5838 3349 7952]]
Evaluating performance on  val set...
53/53 - 1s - 591ms/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0900091
{'0': {'precision': 0.36419753086419754, 'recall': 0.41492740471869327, 'f1-score': 0.3879109225874867, 'support': 4408}, '1': {'precision': 0.40347610180012417, 'recall': 0.2661207778915046, 'f1-score': 0.32071049710127053, 'support': 4885}, '2': {'precision': 0.34110007639419404, 'recall': 0.42655839503224263, 'f1-score': 0.37907248222434464, 'support': 4187}, 'accuracy': 0.3646142433234421, 'macro avg': {'precision': 0.3695912363528386, 'recall': 0.3692021925474802, 'f1-score': 0.36256463397103394, 'support': 13480}, 'weighted avg': {'precision': 0.3712573808015934, 'recall': 0.3646142433234421, 'f1-score': 0.3608129531289821, 'support': 13480}}
[[1829  990 1589]
 [1724 1300 1861]
 [1469  932 1786]]
training model: results/LILAK/W9/deepOF_L2/h200
Epoch 1/50
200/200 - 6s - loss: 3.3561 - accuracy200: 0.3315 - val_loss: 3.3256 - val_accuracy200: 0.3421 - 6s/epoch - 32ms/step
Epoch 2/50
200/200 - 5s - loss: 3.3232 - accuracy200: 0.3407 - val_loss: 3.3158 - val_accuracy200: 0.3455 - 5s/epoch - 24ms/step
Epoch 3/50
200/200 - 5s - loss: 3.3051 - accuracy200: 0.3548 - val_loss: 3.3137 - val_accuracy200: 0.3470 - 5s/epoch - 24ms/step
Epoch 4/50
200/200 - 5s - loss: 3.2942 - accuracy200: 0.3629 - val_loss: 3.3082 - val_accuracy200: 0.3473 - 5s/epoch - 24ms/step
Epoch 5/50
200/200 - 5s - loss: 3.2812 - accuracy200: 0.3692 - val_loss: 3.3082 - val_accuracy200: 0.3425 - 5s/epoch - 24ms/step
Epoch 6/50
200/200 - 5s - loss: 3.2701 - accuracy200: 0.3747 - val_loss: 3.2964 - val_accuracy200: 0.3631 - 5s/epoch - 24ms/step
Epoch 7/50
200/200 - 5s - loss: 3.2619 - accuracy200: 0.3780 - val_loss: 3.2997 - val_accuracy200: 0.3536 - 5s/epoch - 24ms/step
Epoch 8/50
200/200 - 5s - loss: 3.2508 - accuracy200: 0.3844 - val_loss: 3.2973 - val_accuracy200: 0.3547 - 5s/epoch - 24ms/step
Epoch 9/50
200/200 - 5s - loss: 3.2416 - accuracy200: 0.3863 - val_loss: 3.2975 - val_accuracy200: 0.3571 - 5s/epoch - 24ms/step
Epoch 10/50
200/200 - 5s - loss: 3.2311 - accuracy200: 0.3908 - val_loss: 3.2952 - val_accuracy200: 0.3562 - 5s/epoch - 24ms/step
Epoch 11/50
200/200 - 5s - loss: 3.2203 - accuracy200: 0.3992 - val_loss: 3.2901 - val_accuracy200: 0.3576 - 5s/epoch - 24ms/step
Epoch 12/50
200/200 - 5s - loss: 3.2073 - accuracy200: 0.4051 - val_loss: 3.2896 - val_accuracy200: 0.3607 - 5s/epoch - 24ms/step
Epoch 13/50
200/200 - 5s - loss: 3.1955 - accuracy200: 0.4094 - val_loss: 3.2934 - val_accuracy200: 0.3620 - 5s/epoch - 23ms/step
Epoch 14/50
200/200 - 5s - loss: 3.1878 - accuracy200: 0.4168 - val_loss: 3.2931 - val_accuracy200: 0.3642 - 5s/epoch - 23ms/step
Epoch 15/50
200/200 - 5s - loss: 3.1821 - accuracy200: 0.4169 - val_loss: 3.2964 - val_accuracy200: 0.3602 - 5s/epoch - 24ms/step
Epoch 16/50
200/200 - 5s - loss: 3.1696 - accuracy200: 0.4268 - val_loss: 3.3057 - val_accuracy200: 0.3634 - 5s/epoch - 24ms/step
Epoch 17/50
200/200 - 5s - loss: 3.1629 - accuracy200: 0.4295 - val_loss: 3.3109 - val_accuracy200: 0.3623 - 5s/epoch - 23ms/step
Epoch 18/50
200/200 - 5s - loss: 3.1500 - accuracy200: 0.4365 - val_loss: 3.3184 - val_accuracy200: 0.3662 - 5s/epoch - 23ms/step
Epoch 19/50
200/200 - 5s - loss: 3.1420 - accuracy200: 0.4371 - val_loss: 3.3207 - val_accuracy200: 0.3607 - 5s/epoch - 23ms/step
Epoch 20/50
200/200 - 5s - loss: 3.1355 - accuracy200: 0.4418 - val_loss: 3.3232 - val_accuracy200: 0.3628 - 5s/epoch - 23ms/step
Epoch 21/50
200/200 - 5s - loss: 3.1253 - accuracy200: 0.4476 - val_loss: 3.3364 - val_accuracy200: 0.3630 - 5s/epoch - 23ms/step
Epoch 22/50
200/200 - 5s - loss: 3.1144 - accuracy200: 0.4520 - val_loss: 3.3455 - val_accuracy200: 0.3634 - 5s/epoch - 23ms/step
testing model: results/LILAK/W9/deepOF_L2/h200
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1138407
{'0': {'precision': 0.39386373723923657, 'recall': 0.2540256208401918, 'f1-score': 0.3088536001740266, 'support': 27946}, '1': {'precision': 0.2976619786031975, 'recall': 0.45725233127135073, 'f1-score': 0.36058829953766064, 'support': 21662}, '2': {'precision': 0.3604902368093062, 'recall': 0.33681391196335686, 'f1-score': 0.3482501204045593, 'support': 25762}, 'accuracy': 0.34073238689133606, 'macro avg': {'precision': 0.35067198421724677, 'recall': 0.34936395469163317, 'f1-score': 0.3392306733720822, 'support': 75370}, 'weighted avg': {'precision': 0.35480720793514015, 'recall': 0.34073238689133606, 'f1-score': 0.3371886169153564, 'support': 75370}}
[[ 7099 12201  8646]
 [ 5010  9905  6747]
 [ 5915 11170  8677]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0715469
{'0': {'precision': 0.41396752875907644, 'recall': 0.2968813995670236, 'f1-score': 0.34578165462723187, 'support': 17091}, '1': {'precision': 0.3865684962070504, 'recall': 0.5143383007777712, 'f1-score': 0.4413930145466588, 'support': 16843}, '2': {'precision': 0.41171466763883824, 'recall': 0.39415973474492466, 'f1-score': 0.4027459954233409, 'support': 17191}, 'accuracy': 0.4012322738386308, 'macro avg': {'precision': 0.404083564201655, 'recall': 0.40179314502990643, 'f1-score': 0.3966402215324105, 'support': 51125}, 'weighted avg': {'precision': 0.40418345363356467, 'recall': 0.4012322738386308, 'f1-score': 0.3964350750232968, 'support': 51125}}
[[5074 6988 5029]
 [3527 8663 4653]
 [3656 6759 6776]]
Evaluating performance on  val set...
53/53 - 1s - 582ms/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0962915
{'0': {'precision': 0.3485881207400195, 'recall': 0.24370319945541186, 'f1-score': 0.28685897435897434, 'support': 4407}, '1': {'precision': 0.38219895287958117, 'recall': 0.47392980320551836, 'f1-score': 0.4231500769857803, 'support': 4929}, '2': {'precision': 0.3305341730814089, 'recall': 0.34194015444015446, 'f1-score': 0.33614043411220496, 'support': 4144}, 'accuracy': 0.3580860534124629, 'macro avg': {'precision': 0.3537737489003365, 'recall': 0.35319105236702825, 'f1-score': 0.34871649515231984, 'support': 13480}, 'weighted avg': {'precision': 0.35532790060045105, 'recall': 0.3580860534124629, 'f1-score': 0.3518442276278849, 'support': 13480}}
[[1074 1968 1365]
 [1088 2336 1505]
 [ 919 1808 1417]]
training model: results/LILAK/W9/deepOF_L2/h300
Epoch 1/50
200/200 - 7s - loss: 3.3568 - accuracy300: 0.3321 - val_loss: 3.3485 - val_accuracy300: 0.3266 - 7s/epoch - 33ms/step
Epoch 2/50
200/200 - 5s - loss: 3.3265 - accuracy300: 0.3428 - val_loss: 3.3373 - val_accuracy300: 0.3264 - 5s/epoch - 24ms/step
Epoch 3/50
200/200 - 5s - loss: 3.3051 - accuracy300: 0.3534 - val_loss: 3.3355 - val_accuracy300: 0.3293 - 5s/epoch - 24ms/step
Epoch 4/50
200/200 - 5s - loss: 3.2956 - accuracy300: 0.3565 - val_loss: 3.3260 - val_accuracy300: 0.3315 - 5s/epoch - 24ms/step
Epoch 5/50
200/200 - 5s - loss: 3.2836 - accuracy300: 0.3666 - val_loss: 3.3193 - val_accuracy300: 0.3363 - 5s/epoch - 24ms/step
Epoch 6/50
200/200 - 5s - loss: 3.2744 - accuracy300: 0.3716 - val_loss: 3.3131 - val_accuracy300: 0.3370 - 5s/epoch - 24ms/step
Epoch 7/50
200/200 - 5s - loss: 3.2634 - accuracy300: 0.3794 - val_loss: 3.3122 - val_accuracy300: 0.3410 - 5s/epoch - 24ms/step
Epoch 8/50
200/200 - 5s - loss: 3.2561 - accuracy300: 0.3785 - val_loss: 3.3083 - val_accuracy300: 0.3441 - 5s/epoch - 24ms/step
Epoch 9/50
200/200 - 5s - loss: 3.2470 - accuracy300: 0.3847 - val_loss: 3.3073 - val_accuracy300: 0.3439 - 5s/epoch - 24ms/step
Epoch 10/50
200/200 - 5s - loss: 3.2335 - accuracy300: 0.3911 - val_loss: 3.3105 - val_accuracy300: 0.3458 - 5s/epoch - 23ms/step
Epoch 11/50
200/200 - 5s - loss: 3.2226 - accuracy300: 0.3967 - val_loss: 3.3038 - val_accuracy300: 0.3454 - 5s/epoch - 24ms/step
Epoch 12/50
200/200 - 5s - loss: 3.2127 - accuracy300: 0.4023 - val_loss: 3.3079 - val_accuracy300: 0.3490 - 5s/epoch - 23ms/step
Epoch 13/50
200/200 - 5s - loss: 3.2037 - accuracy300: 0.4068 - val_loss: 3.3122 - val_accuracy300: 0.3420 - 5s/epoch - 23ms/step
Epoch 14/50
200/200 - 5s - loss: 3.1941 - accuracy300: 0.4124 - val_loss: 3.3099 - val_accuracy300: 0.3447 - 5s/epoch - 23ms/step
Epoch 15/50
200/200 - 5s - loss: 3.1893 - accuracy300: 0.4134 - val_loss: 3.3102 - val_accuracy300: 0.3458 - 5s/epoch - 23ms/step
Epoch 16/50
200/200 - 5s - loss: 3.1766 - accuracy300: 0.4188 - val_loss: 3.3100 - val_accuracy300: 0.3518 - 5s/epoch - 23ms/step
Epoch 17/50
200/200 - 5s - loss: 3.1719 - accuracy300: 0.4223 - val_loss: 3.3140 - val_accuracy300: 0.3493 - 5s/epoch - 23ms/step
Epoch 18/50
200/200 - 5s - loss: 3.1617 - accuracy300: 0.4287 - val_loss: 3.3129 - val_accuracy300: 0.3533 - 5s/epoch - 23ms/step
Epoch 19/50
200/200 - 5s - loss: 3.1511 - accuracy300: 0.4329 - val_loss: 3.3129 - val_accuracy300: 0.3568 - 5s/epoch - 24ms/step
Epoch 20/50
200/200 - 5s - loss: 3.1416 - accuracy300: 0.4386 - val_loss: 3.3261 - val_accuracy300: 0.3543 - 5s/epoch - 23ms/step
Epoch 21/50
200/200 - 5s - loss: 3.1329 - accuracy300: 0.4406 - val_loss: 3.3292 - val_accuracy300: 0.3580 - 5s/epoch - 23ms/step
testing model: results/LILAK/W9/deepOF_L2/h300
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1118841
{'0': {'precision': 0.36788545734232636, 'recall': 0.23488969477183438, 'f1-score': 0.28671554387421033, 'support': 26472}, '1': {'precision': 0.34013225295706434, 'recall': 0.2824985496035583, 'f1-score': 0.3086479748145957, 'support': 25855}, '2': {'precision': 0.3181056387522301, 'recall': 0.5106973918326607, 'f1-score': 0.39202491796725353, 'support': 23043}, 'accuracy': 0.33554464641103887, 'macro avg': {'precision': 0.3420411163505403, 'recall': 0.3426952120693511, 'f1-score': 0.32912947888535315, 'support': 75370}, 'weighted avg': {'precision': 0.34314570068646144, 'recall': 0.33554464641103887, 'f1-score': 0.3264356833088615, 'support': 75370}}
[[ 6218  7898 12356]
 [ 5681  7304 12870]
 [ 5003  6272 11768]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0742829
{'0': {'precision': 0.4080971659919028, 'recall': 0.2669648637513978, 'f1-score': 0.3227780545079343, 'support': 16991}, '1': {'precision': 0.40630238015420717, 'recall': 0.35985748218527314, 'f1-score': 0.3816721776098252, 'support': 16840}, '2': {'precision': 0.3819884439131301, 'recall': 0.5542962877298485, 'f1-score': 0.4522871499681521, 'support': 17294}, 'accuracy': 0.39475794621026894, 'macro avg': {'precision': 0.39879599668641336, 'recall': 0.39370621122217314, 'f1-score': 0.3855791273619705, 'support': 51125}, 'weighted avg': {'precision': 0.3986742137545025, 'recall': 0.39475794621026894, 'f1-score': 0.3859860218414277, 'support': 51125}}
[[4536 4553 7902]
 [3173 6060 7607]
 [3406 4302 9586]]
Evaluating performance on  val set...
53/53 - 1s - 588ms/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0998042
{'0': {'precision': 0.3393711551606288, 'recall': 0.2371626462861237, 'f1-score': 0.27920708561788277, 'support': 4187}, '1': {'precision': 0.4317673378076063, 'recall': 0.2856614246068455, 'f1-score': 0.343836989199421, 'support': 5405}, '2': {'precision': 0.30252221266838636, 'recall': 0.5429526748971193, 'f1-score': 0.3885514448739187, 'support': 3888}, 'accuracy': 0.34480712166172106, 'macro avg': {'precision': 0.3578869018788738, 'recall': 0.3552589152633628, 'f1-score': 0.33719850656374084, 'support': 13480}, 'weighted avg': {'precision': 0.3657904933503228, 'recall': 0.34480712166172106, 'f1-score': 0.3366592738705298, 'support': 13480}}
[[ 993 1112 2082]
 [1076 1544 2785]
 [ 857  920 2111]]
training model: results/LILAK/W9/deepOF_L2/h500
Epoch 1/50
200/200 - 7s - loss: 3.3634 - accuracy500: 0.3298 - val_loss: 3.3380 - val_accuracy500: 0.3297 - 7s/epoch - 35ms/step
Epoch 2/50
200/200 - 5s - loss: 3.3274 - accuracy500: 0.3424 - val_loss: 3.3313 - val_accuracy500: 0.3378 - 5s/epoch - 25ms/step
Epoch 3/50
200/200 - 5s - loss: 3.3074 - accuracy500: 0.3567 - val_loss: 3.3141 - val_accuracy500: 0.3467 - 5s/epoch - 25ms/step
Epoch 4/50
200/200 - 5s - loss: 3.2921 - accuracy500: 0.3646 - val_loss: 3.3172 - val_accuracy500: 0.3395 - 5s/epoch - 25ms/step
Epoch 5/50
200/200 - 5s - loss: 3.2784 - accuracy500: 0.3707 - val_loss: 3.3100 - val_accuracy500: 0.3470 - 5s/epoch - 25ms/step
Epoch 6/50
200/200 - 5s - loss: 3.2782 - accuracy500: 0.3677 - val_loss: 3.3081 - val_accuracy500: 0.3447 - 5s/epoch - 25ms/step
Epoch 7/50
200/200 - 5s - loss: 3.2619 - accuracy500: 0.3761 - val_loss: 3.3092 - val_accuracy500: 0.3502 - 5s/epoch - 24ms/step
Epoch 8/50
200/200 - 5s - loss: 3.2491 - accuracy500: 0.3818 - val_loss: 3.3150 - val_accuracy500: 0.3468 - 5s/epoch - 24ms/step
Epoch 9/50
200/200 - 5s - loss: 3.2409 - accuracy500: 0.3897 - val_loss: 3.3086 - val_accuracy500: 0.3464 - 5s/epoch - 24ms/step
Epoch 10/50
200/200 - 5s - loss: 3.2345 - accuracy500: 0.3921 - val_loss: 3.3073 - val_accuracy500: 0.3541 - 5s/epoch - 24ms/step
Epoch 11/50
200/200 - 5s - loss: 3.2263 - accuracy500: 0.3944 - val_loss: 3.3088 - val_accuracy500: 0.3484 - 5s/epoch - 24ms/step
Epoch 12/50
200/200 - 5s - loss: 3.2154 - accuracy500: 0.4028 - val_loss: 3.3082 - val_accuracy500: 0.3539 - 5s/epoch - 24ms/step
Epoch 13/50
200/200 - 5s - loss: 3.2047 - accuracy500: 0.4079 - val_loss: 3.3146 - val_accuracy500: 0.3491 - 5s/epoch - 24ms/step
Epoch 14/50
200/200 - 5s - loss: 3.2017 - accuracy500: 0.4098 - val_loss: 3.3068 - val_accuracy500: 0.3556 - 5s/epoch - 24ms/step
Epoch 15/50
200/200 - 5s - loss: 3.1965 - accuracy500: 0.4084 - val_loss: 3.3172 - val_accuracy500: 0.3576 - 5s/epoch - 24ms/step
Epoch 16/50
200/200 - 5s - loss: 3.1867 - accuracy500: 0.4187 - val_loss: 3.3170 - val_accuracy500: 0.3543 - 5s/epoch - 24ms/step
Epoch 17/50
200/200 - 5s - loss: 3.1769 - accuracy500: 0.4208 - val_loss: 3.3151 - val_accuracy500: 0.3577 - 5s/epoch - 24ms/step
Epoch 18/50
200/200 - 5s - loss: 3.1675 - accuracy500: 0.4270 - val_loss: 3.3205 - val_accuracy500: 0.3620 - 5s/epoch - 24ms/step
Epoch 19/50
200/200 - 5s - loss: 3.1588 - accuracy500: 0.4307 - val_loss: 3.3345 - val_accuracy500: 0.3535 - 5s/epoch - 24ms/step
Epoch 20/50
200/200 - 5s - loss: 3.1568 - accuracy500: 0.4320 - val_loss: 3.3298 - val_accuracy500: 0.3562 - 5s/epoch - 24ms/step
Epoch 21/50
200/200 - 5s - loss: 3.1395 - accuracy500: 0.4386 - val_loss: 3.3467 - val_accuracy500: 0.3525 - 5s/epoch - 24ms/step
Epoch 22/50
200/200 - 5s - loss: 3.1322 - accuracy500: 0.4411 - val_loss: 3.3420 - val_accuracy500: 0.3594 - 5s/epoch - 23ms/step
Epoch 23/50
200/200 - 5s - loss: 3.1197 - accuracy500: 0.4473 - val_loss: 3.3433 - val_accuracy500: 0.3600 - 5s/epoch - 23ms/step
Epoch 24/50
200/200 - 5s - loss: 3.1107 - accuracy500: 0.4505 - val_loss: 3.3546 - val_accuracy500: 0.3568 - 5s/epoch - 23ms/step
testing model: results/LILAK/W9/deepOF_L2/h500
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.118188
{'0': {'precision': 0.38963457211575764, 'recall': 0.17218088936126444, 'f1-score': 0.2388244245767548, 'support': 29167}, '1': {'precision': 0.29465444676080715, 'recall': 0.3447942557304612, 'f1-score': 0.3177585950921547, 'support': 21726}, '2': {'precision': 0.32505801716228616, 'recall': 0.4921354741185603, 'f1-score': 0.3915170228325343, 'support': 24477}, 'accuracy': 0.3258458272522224, 'macro avg': {'precision': 0.33644901201295035, 'recall': 0.33637020640342863, 'f1-score': 0.31603334750048123, 'support': 75370}, 'weighted avg': {'precision': 0.3412840541502837, 'recall': 0.3258458272522224, 'f1-score': 0.31116594661635005, 'support': 75370}}
[[ 5022  9787 14358]
 [ 3581  7491 10654]
 [ 4286  8145 12046]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0732164
{'0': {'precision': 0.4192312027956262, 'recall': 0.22312215022798176, 'f1-score': 0.29124084733153216, 'support': 16668}, '1': {'precision': 0.40975279376904844, 'recall': 0.42585640544345377, 'f1-score': 0.41764942760167983, 'support': 17048}, '2': {'precision': 0.38559667427453537, 'recall': 0.5434545350106267, 'f1-score': 0.45111455477410894, 'support': 17409}, 'accuracy': 0.39980440097799513, 'macro avg': {'precision': 0.40486022361307, 'recall': 0.39747769689402074, 'f1-score': 0.38666827656910696, 'support': 51125}, 'weighted avg': {'precision': 0.4046173852091467, 'recall': 0.39980440097799513, 'f1-score': 0.38783262922519074, 'support': 51125}}
[[3719 5187 7762]
 [2475 7260 7313]
 [2677 5271 9461]]
Evaluating performance on  val set...
53/53 - 1s - 586ms/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1023068
{'0': {'precision': 0.3470319634703196, 'recall': 0.18901198281709247, 'f1-score': 0.2447306791569087, 'support': 4423}, '1': {'precision': 0.38134135855546003, 'recall': 0.377929271410311, 'f1-score': 0.37962764819173983, 'support': 4694}, '2': {'precision': 0.3298021498675806, 'recall': 0.48521659408663764, 'f1-score': 0.39269152290855125, 'support': 4363}, 'accuracy': 0.3506676557863502, 'macro avg': {'precision': 0.35272515729778675, 'recall': 0.350719282771347, 'f1-score': 0.33901661675239997, 'support': 13480}, 'weighted avg': {'precision': 0.35340248452231504, 'recall': 0.3506676557863502, 'f1-score': 0.3395941460662495, 'support': 13480}}
[[ 836 1447 2140]
 [ 758 1774 2162]
 [ 815 1431 2117]]
training model: results/LILAK/W9/deepOF_L2/h1000
Epoch 1/50
200/200 - 7s - loss: 3.3672 - accuracy1000: 0.3353 - val_loss: 3.3541 - val_accuracy1000: 0.3321 - 7s/epoch - 33ms/step
Epoch 2/50
200/200 - 5s - loss: 3.3351 - accuracy1000: 0.3468 - val_loss: 3.3433 - val_accuracy1000: 0.3366 - 5s/epoch - 24ms/step
Epoch 3/50
200/200 - 5s - loss: 3.3193 - accuracy1000: 0.3556 - val_loss: 3.3370 - val_accuracy1000: 0.3409 - 5s/epoch - 24ms/step
Epoch 4/50
200/200 - 5s - loss: 3.3059 - accuracy1000: 0.3632 - val_loss: 3.3393 - val_accuracy1000: 0.3394 - 5s/epoch - 23ms/step
Epoch 5/50
200/200 - 5s - loss: 3.2937 - accuracy1000: 0.3697 - val_loss: 3.3436 - val_accuracy1000: 0.3377 - 5s/epoch - 24ms/step
Epoch 6/50
200/200 - 5s - loss: 3.2860 - accuracy1000: 0.3700 - val_loss: 3.3276 - val_accuracy1000: 0.3467 - 5s/epoch - 24ms/step
Epoch 7/50
200/200 - 5s - loss: 3.2778 - accuracy1000: 0.3781 - val_loss: 3.3293 - val_accuracy1000: 0.3493 - 5s/epoch - 24ms/step
Epoch 8/50
200/200 - 5s - loss: 3.2741 - accuracy1000: 0.3778 - val_loss: 3.3312 - val_accuracy1000: 0.3377 - 5s/epoch - 24ms/step
Epoch 9/50
200/200 - 5s - loss: 3.2640 - accuracy1000: 0.3831 - val_loss: 3.3297 - val_accuracy1000: 0.3441 - 5s/epoch - 23ms/step
Epoch 10/50
200/200 - 5s - loss: 3.2560 - accuracy1000: 0.3869 - val_loss: 3.3322 - val_accuracy1000: 0.3437 - 5s/epoch - 23ms/step
Epoch 11/50
200/200 - 5s - loss: 3.2426 - accuracy1000: 0.3868 - val_loss: 3.3275 - val_accuracy1000: 0.3507 - 5s/epoch - 24ms/step
Epoch 12/50
200/200 - 5s - loss: 3.2339 - accuracy1000: 0.3938 - val_loss: 3.3315 - val_accuracy1000: 0.3462 - 5s/epoch - 23ms/step
Epoch 13/50
200/200 - 5s - loss: 3.2212 - accuracy1000: 0.3997 - val_loss: 3.3318 - val_accuracy1000: 0.3448 - 5s/epoch - 23ms/step
Epoch 14/50
200/200 - 5s - loss: 3.2169 - accuracy1000: 0.3999 - val_loss: 3.3364 - val_accuracy1000: 0.3483 - 5s/epoch - 23ms/step
Epoch 15/50
200/200 - 5s - loss: 3.2056 - accuracy1000: 0.4071 - val_loss: 3.3415 - val_accuracy1000: 0.3394 - 5s/epoch - 23ms/step
Epoch 16/50
200/200 - 5s - loss: 3.1998 - accuracy1000: 0.4093 - val_loss: 3.3378 - val_accuracy1000: 0.3442 - 5s/epoch - 23ms/step
Epoch 17/50
200/200 - 5s - loss: 3.1893 - accuracy1000: 0.4156 - val_loss: 3.3430 - val_accuracy1000: 0.3466 - 5s/epoch - 23ms/step
Epoch 18/50
200/200 - 5s - loss: 3.1806 - accuracy1000: 0.4201 - val_loss: 3.3410 - val_accuracy1000: 0.3499 - 5s/epoch - 24ms/step
Epoch 19/50
200/200 - 5s - loss: 3.1728 - accuracy1000: 0.4246 - val_loss: 3.3509 - val_accuracy1000: 0.3420 - 5s/epoch - 23ms/step
Epoch 20/50
200/200 - 5s - loss: 3.1639 - accuracy1000: 0.4275 - val_loss: 3.3550 - val_accuracy1000: 0.3447 - 5s/epoch - 23ms/step
Epoch 21/50
200/200 - 5s - loss: 3.1565 - accuracy1000: 0.4298 - val_loss: 3.3518 - val_accuracy1000: 0.3463 - 5s/epoch - 23ms/step
testing model: results/LILAK/W9/deepOF_L2/h1000
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1122954
{'0': {'precision': 0.38508557457212717, 'recall': 0.23401884307567622, 'f1-score': 0.29112142662101703, 'support': 29613}, '1': {'precision': 0.3061381566288243, 'recall': 0.13839596381350036, 'f1-score': 0.19061882226082794, 'support': 22992}, '2': {'precision': 0.3020434227330779, 'recall': 0.6233252800351416, 'f1-score': 0.4069108896695103, 'support': 22765}, 'accuracy': 0.32243598248640043, 'macro avg': {'precision': 0.33108905131134314, 'recall': 0.3319133623081061, 'f1-score': 0.2962170461837851, 'support': 75370}, 'weighted avg': {'precision': 0.3359199434195681, 'recall': 0.32243598248640043, 'f1-score': 0.2954360245624988, 'support': 75370}}
[[ 6930  4098 18585]
 [ 5605  3182 14205]
 [ 5461  3114 14190]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0845553
{'0': {'precision': 0.3741680854356911, 'recall': 0.29401033748859834, 'f1-score': 0.3292811659345524, 'support': 16445}, '1': {'precision': 0.42815934065934064, 'recall': 0.19028142360051278, 'f1-score': 0.2634715354380627, 'support': 16381}, '2': {'precision': 0.3862820554279986, 'recall': 0.6527679108147986, 'f1-score': 0.4853520783389541, 'support': 18299}, 'accuracy': 0.3891833740831296, 'macro avg': {'precision': 0.3962031605076768, 'recall': 0.37901989063463654, 'f1-score': 0.3593682599038564, 'support': 51125}, 'weighted avg': {'precision': 0.3958033771463578, 'recall': 0.3891833740831296, 'f1-score': 0.36405699124360175, 'support': 51125}}
[[ 4835  1992  9618]
 [ 3904  3117  9360]
 [ 4183  2171 11945]]
Evaluating performance on  val set...
53/53 - 1s - 599ms/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1074547
{'0': {'precision': 0.32914719626168226, 'recall': 0.2639962520496603, 'f1-score': 0.2929936305732484, 'support': 4269}, '1': {'precision': 0.360146252285192, 'recall': 0.12884238064094178, 'f1-score': 0.18978805394990367, 'support': 4587}, '2': {'precision': 0.34759358288770054, 'recall': 0.6325692041522492, 'f1-score': 0.448654037886341, 'support': 4624}, 'accuracy': 0.34443620178041545, 'macro avg': {'precision': 0.3456290104781916, 'recall': 0.3418026122809504, 'f1-score': 0.3104785741364977, 'support': 13480}, 'weighted avg': {'precision': 0.346023217162168, 'recall': 0.34443620178041545, 'f1-score': 0.31127031777239217, 'support': 13480}}
[[1127  475 2667]
 [1173  591 2823]
 [1124  575 2925]]
training model: results/LILAK/W9/deepVOL_L2/h10
Epoch 1/50
200/200 - 7s - loss: 3.3259 - accuracy10: 0.3675 - val_loss: 3.2434 - val_accuracy10: 0.3901 - 7s/epoch - 34ms/step
Epoch 2/50
200/200 - 4s - loss: 3.2375 - accuracy10: 0.4091 - val_loss: 3.1629 - val_accuracy10: 0.4387 - 4s/epoch - 21ms/step
Epoch 3/50
200/200 - 4s - loss: 3.1794 - accuracy10: 0.4318 - val_loss: 3.1303 - val_accuracy10: 0.4538 - 4s/epoch - 21ms/step
Epoch 4/50
200/200 - 4s - loss: 3.1512 - accuracy10: 0.4400 - val_loss: 3.1123 - val_accuracy10: 0.4596 - 4s/epoch - 21ms/step
Epoch 5/50
200/200 - 4s - loss: 3.1325 - accuracy10: 0.4504 - val_loss: 3.1049 - val_accuracy10: 0.4702 - 4s/epoch - 21ms/step
Epoch 6/50
200/200 - 4s - loss: 3.1157 - accuracy10: 0.4542 - val_loss: 3.0907 - val_accuracy10: 0.4686 - 4s/epoch - 21ms/step
Epoch 7/50
200/200 - 4s - loss: 3.1008 - accuracy10: 0.4608 - val_loss: 3.0861 - val_accuracy10: 0.4749 - 4s/epoch - 22ms/step
Epoch 8/50
200/200 - 4s - loss: 3.0797 - accuracy10: 0.4692 - val_loss: 3.0812 - val_accuracy10: 0.4882 - 4s/epoch - 22ms/step
Epoch 9/50
200/200 - 4s - loss: 3.0643 - accuracy10: 0.4744 - val_loss: 3.0641 - val_accuracy10: 0.4864 - 4s/epoch - 22ms/step
Epoch 10/50
200/200 - 4s - loss: 3.0465 - accuracy10: 0.4765 - val_loss: 3.0446 - val_accuracy10: 0.4927 - 4s/epoch - 21ms/step
Epoch 11/50
200/200 - 4s - loss: 3.0238 - accuracy10: 0.4850 - val_loss: 3.0372 - val_accuracy10: 0.4878 - 4s/epoch - 22ms/step
Epoch 12/50
200/200 - 4s - loss: 3.0071 - accuracy10: 0.4905 - val_loss: 3.0356 - val_accuracy10: 0.4821 - 4s/epoch - 21ms/step
Epoch 13/50
200/200 - 4s - loss: 2.9869 - accuracy10: 0.4956 - val_loss: 3.0371 - val_accuracy10: 0.4803 - 4s/epoch - 21ms/step
Epoch 14/50
200/200 - 4s - loss: 2.9735 - accuracy10: 0.5001 - val_loss: 3.0296 - val_accuracy10: 0.4820 - 4s/epoch - 21ms/step
Epoch 15/50
200/200 - 4s - loss: 2.9483 - accuracy10: 0.5085 - val_loss: 3.0170 - val_accuracy10: 0.4878 - 4s/epoch - 21ms/step
Epoch 16/50
200/200 - 4s - loss: 2.9389 - accuracy10: 0.5118 - val_loss: 3.0152 - val_accuracy10: 0.4981 - 4s/epoch - 21ms/step
Epoch 17/50
200/200 - 4s - loss: 2.9179 - accuracy10: 0.5176 - val_loss: 3.0049 - val_accuracy10: 0.5007 - 4s/epoch - 21ms/step
Epoch 18/50
200/200 - 4s - loss: 2.9033 - accuracy10: 0.5223 - val_loss: 2.9973 - val_accuracy10: 0.5076 - 4s/epoch - 21ms/step
Epoch 19/50
200/200 - 4s - loss: 2.8904 - accuracy10: 0.5231 - val_loss: 2.9964 - val_accuracy10: 0.4920 - 4s/epoch - 21ms/step
Epoch 20/50
200/200 - 4s - loss: 2.8704 - accuracy10: 0.5302 - val_loss: 2.9756 - val_accuracy10: 0.5004 - 4s/epoch - 21ms/step
Epoch 21/50
200/200 - 4s - loss: 2.8630 - accuracy10: 0.5328 - val_loss: 2.9864 - val_accuracy10: 0.5017 - 4s/epoch - 21ms/step
Epoch 22/50
200/200 - 4s - loss: 2.8518 - accuracy10: 0.5349 - val_loss: 3.0086 - val_accuracy10: 0.4879 - 4s/epoch - 21ms/step
Epoch 23/50
200/200 - 4s - loss: 2.8365 - accuracy10: 0.5393 - val_loss: 3.0029 - val_accuracy10: 0.4966 - 4s/epoch - 21ms/step
Epoch 24/50
200/200 - 4s - loss: 2.8285 - accuracy10: 0.5419 - val_loss: 3.0121 - val_accuracy10: 0.4819 - 4s/epoch - 21ms/step
Epoch 25/50
200/200 - 4s - loss: 2.8194 - accuracy10: 0.5446 - val_loss: 3.0011 - val_accuracy10: 0.4916 - 4s/epoch - 21ms/step
Epoch 26/50
200/200 - 4s - loss: 2.8102 - accuracy10: 0.5463 - val_loss: 3.0192 - val_accuracy10: 0.4765 - 4s/epoch - 21ms/step
Epoch 27/50
200/200 - 4s - loss: 2.8057 - accuracy10: 0.5473 - val_loss: 3.0467 - val_accuracy10: 0.4725 - 4s/epoch - 21ms/step
Epoch 28/50
200/200 - 4s - loss: 2.8005 - accuracy10: 0.5490 - val_loss: 3.0642 - val_accuracy10: 0.4629 - 4s/epoch - 21ms/step
Epoch 29/50
200/200 - 4s - loss: 2.7893 - accuracy10: 0.5518 - val_loss: 3.0522 - val_accuracy10: 0.4698 - 4s/epoch - 21ms/step
Epoch 30/50
200/200 - 4s - loss: 2.7802 - accuracy10: 0.5537 - val_loss: 3.0626 - val_accuracy10: 0.4628 - 4s/epoch - 21ms/step
testing model: results/LILAK/W9/deepVOL_L2/h10
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0310925
{'0': {'precision': 0.4087866704642552, 'recall': 0.5371444610778443, 'f1-score': 0.4642568332524664, 'support': 21376}, '1': {'precision': 0.6184580476495832, 'recall': 0.4065103913367701, 'f1-score': 0.4905704671727052, 'support': 30843}, '2': {'precision': 0.4082478806500574, 'recall': 0.4762686244871518, 'f1-score': 0.439642800191357, 'support': 23155}, 'accuracy': 0.46498792687133494, 'macro avg': {'precision': 0.4784975329212986, 'recall': 0.4733078256339221, 'f1-score': 0.4648233668721762, 'support': 75374}, 'weighted avg': {'precision': 0.49441856751601476, 'recall': 0.46498792687133494, 'f1-score': 0.4674628920455772, 'support': 75374}}
[[11482  3444  6450]
 [ 8770 12538  9535]
 [ 7836  4291 11028]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9652923
{'0': {'precision': 0.46440596440596443, 'recall': 0.5252992383025027, 'f1-score': 0.49297932090885876, 'support': 14704}, '1': {'precision': 0.6639006523978482, 'recall': 0.5243626830591214, 'f1-score': 0.5859386837719077, 'support': 22124}, '2': {'precision': 0.43235622393232687, 'recall': 0.5146493252220125, 'f1-score': 0.46992721236112883, 'support': 14301}, 'accuracy': 0.5219151557824326, 'macro avg': {'precision': 0.5202209469120466, 'recall': 0.5214370821945455, 'f1-score': 0.5162817390139651, 'support': 51129}, 'weighted avg': {'precision': 0.5417647458923801, 'recall': 0.5219151557824326, 'f1-score': 0.5267559396504928, 'support': 51129}}
[[ 7724  2950  4030]
 [ 4890 11601  5633]
 [ 4018  2923  7360]]
Evaluating performance on  val set...
53/53 - 1s - 524ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9961109
{'0': {'precision': 0.4174167416741674, 'recall': 0.5093355299286106, 'f1-score': 0.45881770962156815, 'support': 3642}, '1': {'precision': 0.6755025403136735, 'recall': 0.503955174686882, 'f1-score': 0.5772534214252005, 'support': 6068}, '2': {'precision': 0.4074074074074074, 'recall': 0.4872679045092838, 'f1-score': 0.4437734025848532, 'support': 3770}, 'accuracy': 0.5007418397626113, 'macro avg': {'precision': 0.5001088964650827, 'recall': 0.5001862030415921, 'f1-score': 0.49328151121054065, 'support': 13480}, 'weighted avg': {'precision': 0.5307942962705203, 'recall': 0.5007418397626113, 'f1-score': 0.5079238566316591, 'support': 13480}}
[[1855  725 1062]
 [1400 3058 1610]
 [1189  744 1837]]
training model: results/LILAK/W9/deepVOL_L2/h20
Epoch 1/50
200/200 - 7s - loss: 3.3223 - accuracy20: 0.3664 - val_loss: 3.2816 - val_accuracy20: 0.3833 - 7s/epoch - 34ms/step
Epoch 2/50
200/200 - 5s - loss: 3.2338 - accuracy20: 0.4033 - val_loss: 3.1997 - val_accuracy20: 0.4204 - 5s/epoch - 23ms/step
Epoch 3/50
200/200 - 4s - loss: 3.1751 - accuracy20: 0.4257 - val_loss: 3.1384 - val_accuracy20: 0.4486 - 4s/epoch - 22ms/step
Epoch 4/50
200/200 - 4s - loss: 3.1408 - accuracy20: 0.4389 - val_loss: 3.1233 - val_accuracy20: 0.4496 - 4s/epoch - 22ms/step
Epoch 5/50
200/200 - 4s - loss: 3.1188 - accuracy20: 0.4517 - val_loss: 3.1322 - val_accuracy20: 0.4483 - 4s/epoch - 22ms/step
Epoch 6/50
200/200 - 4s - loss: 3.1069 - accuracy20: 0.4539 - val_loss: 3.1181 - val_accuracy20: 0.4603 - 4s/epoch - 22ms/step
Epoch 7/50
200/200 - 4s - loss: 3.0789 - accuracy20: 0.4627 - val_loss: 3.1086 - val_accuracy20: 0.4628 - 4s/epoch - 22ms/step
Epoch 8/50
200/200 - 4s - loss: 3.0547 - accuracy20: 0.4710 - val_loss: 3.1004 - val_accuracy20: 0.4634 - 4s/epoch - 22ms/step
Epoch 9/50
200/200 - 4s - loss: 3.0444 - accuracy20: 0.4742 - val_loss: 3.0885 - val_accuracy20: 0.4620 - 4s/epoch - 21ms/step
Epoch 10/50
200/200 - 4s - loss: 3.0194 - accuracy20: 0.4844 - val_loss: 3.0930 - val_accuracy20: 0.4554 - 4s/epoch - 21ms/step
Epoch 11/50
200/200 - 4s - loss: 3.0019 - accuracy20: 0.4920 - val_loss: 3.0767 - val_accuracy20: 0.4713 - 4s/epoch - 21ms/step
Epoch 12/50
200/200 - 4s - loss: 2.9930 - accuracy20: 0.4919 - val_loss: 3.0746 - val_accuracy20: 0.4668 - 4s/epoch - 21ms/step
Epoch 13/50
200/200 - 4s - loss: 2.9749 - accuracy20: 0.4981 - val_loss: 3.0778 - val_accuracy20: 0.4746 - 4s/epoch - 21ms/step
Epoch 14/50
200/200 - 4s - loss: 2.9649 - accuracy20: 0.5004 - val_loss: 3.0630 - val_accuracy20: 0.4728 - 4s/epoch - 21ms/step
Epoch 15/50
200/200 - 4s - loss: 2.9510 - accuracy20: 0.5059 - val_loss: 3.0765 - val_accuracy20: 0.4725 - 4s/epoch - 21ms/step
Epoch 16/50
200/200 - 4s - loss: 2.9356 - accuracy20: 0.5097 - val_loss: 3.0832 - val_accuracy20: 0.4720 - 4s/epoch - 21ms/step
Epoch 17/50
200/200 - 4s - loss: 2.9350 - accuracy20: 0.5104 - val_loss: 3.0811 - val_accuracy20: 0.4671 - 4s/epoch - 21ms/step
Epoch 18/50
200/200 - 4s - loss: 2.9214 - accuracy20: 0.5140 - val_loss: 3.0883 - val_accuracy20: 0.4685 - 4s/epoch - 21ms/step
Epoch 19/50
200/200 - 4s - loss: 2.9016 - accuracy20: 0.5201 - val_loss: 3.0803 - val_accuracy20: 0.4777 - 4s/epoch - 21ms/step
Epoch 20/50
200/200 - 4s - loss: 2.8930 - accuracy20: 0.5234 - val_loss: 3.0825 - val_accuracy20: 0.4804 - 4s/epoch - 21ms/step
Epoch 21/50
200/200 - 4s - loss: 2.8902 - accuracy20: 0.5259 - val_loss: 3.0848 - val_accuracy20: 0.4733 - 4s/epoch - 21ms/step
Epoch 22/50
200/200 - 4s - loss: 2.8839 - accuracy20: 0.5270 - val_loss: 3.0916 - val_accuracy20: 0.4671 - 4s/epoch - 21ms/step
Epoch 23/50
200/200 - 4s - loss: 2.8704 - accuracy20: 0.5307 - val_loss: 3.0858 - val_accuracy20: 0.4709 - 4s/epoch - 21ms/step
Epoch 24/50
200/200 - 4s - loss: 2.8650 - accuracy20: 0.5314 - val_loss: 3.0864 - val_accuracy20: 0.4753 - 4s/epoch - 21ms/step
testing model: results/LILAK/W9/deepVOL_L2/h20
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0503604
{'0': {'precision': 0.4022624814493322, 'recall': 0.5949146927281762, 'f1-score': 0.47997861712968376, 'support': 24148}, '1': {'precision': 0.49505248882414987, 'recall': 0.4000487072289646, 'f1-score': 0.44250886723836036, 'support': 24637}, '2': {'precision': 0.4685095180234913, 'recall': 0.34803866260483657, 'f1-score': 0.39938715176625444, 'support': 26589}, 'accuracy': 0.44413192878180807, 'macro avg': {'precision': 0.4552748294323245, 'recall': 0.4476673541873258, 'f1-score': 0.44062487871143285, 'support': 75374}, 'weighted avg': {'precision': 0.4559615005695023, 'recall': 0.44413192878180807, 'f1-score': 0.4393016104613266, 'support': 75374}}
[[14366  4388  5394]
 [ 9677  9856  5104]
 [11670  5665  9254]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0040145
{'0': {'precision': 0.45639771801140994, 'recall': 0.5670041691483025, 'f1-score': 0.5057239236101888, 'support': 16790}, '1': {'precision': 0.5658249570973278, 'recall': 0.5174307813025446, 'f1-score': 0.540546870425669, 'support': 17842}, '2': {'precision': 0.4653146051311452, 'recall': 0.3935867127356489, 'f1-score': 0.42645561722110925, 'support': 16497}, 'accuracy': 0.49375110015842283, 'macro avg': {'precision': 0.495845760079961, 'recall': 0.4926738877288321, 'f1-score': 0.4909088037523223, 'support': 51129}, 'weighted avg': {'precision': 0.4974605724890101, 'recall': 0.49375110015842283, 'f1-score': 0.4922994828149679, 'support': 51129}}
[[9520 3410 3860]
 [5009 9232 3601]
 [6330 3674 6493]]
Evaluating performance on  val set...
53/53 - 1s - 523ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0220716
{'0': {'precision': 0.41810193321616873, 'recall': 0.565351711026616, 'f1-score': 0.48070317235805216, 'support': 4208}, '1': {'precision': 0.5785945446139621, 'recall': 0.5021063189568706, 'f1-score': 0.5376436472988938, 'support': 4985}, '2': {'precision': 0.43475750577367206, 'recall': 0.35129461161651504, 'f1-score': 0.3885950199974197, 'support': 4287}, 'accuracy': 0.4738872403560831, 'macro avg': {'precision': 0.4771513278679343, 'recall': 0.4729175472000005, 'f1-score': 0.46898061321812196, 'support': 13480}, 'weighted avg': {'precision': 0.4827501607660216, 'recall': 0.4738872403560831, 'f1-score': 0.4724673131896593, 'support': 13480}}
[[2379  876  953]
 [1477 2503 1005]
 [1834  947 1506]]
training model: results/LILAK/W9/deepVOL_L2/h30
Epoch 1/50
200/200 - 6s - loss: 3.3270 - accuracy30: 0.3728 - val_loss: 3.2818 - val_accuracy30: 0.3922 - 6s/epoch - 31ms/step
Epoch 2/50
200/200 - 4s - loss: 3.2396 - accuracy30: 0.4040 - val_loss: 3.2060 - val_accuracy30: 0.4274 - 4s/epoch - 21ms/step
Epoch 3/50
200/200 - 4s - loss: 3.1930 - accuracy30: 0.4229 - val_loss: 3.1843 - val_accuracy30: 0.4329 - 4s/epoch - 21ms/step
Epoch 4/50
200/200 - 4s - loss: 3.1737 - accuracy30: 0.4298 - val_loss: 3.1627 - val_accuracy30: 0.4435 - 4s/epoch - 21ms/step
Epoch 5/50
200/200 - 4s - loss: 3.1473 - accuracy30: 0.4414 - val_loss: 3.1538 - val_accuracy30: 0.4389 - 4s/epoch - 21ms/step
Epoch 6/50
200/200 - 4s - loss: 3.1323 - accuracy30: 0.4448 - val_loss: 3.1411 - val_accuracy30: 0.4461 - 4s/epoch - 21ms/step
Epoch 7/50
200/200 - 4s - loss: 3.1095 - accuracy30: 0.4550 - val_loss: 3.1604 - val_accuracy30: 0.4453 - 4s/epoch - 21ms/step
Epoch 8/50
200/200 - 4s - loss: 3.0944 - accuracy30: 0.4564 - val_loss: 3.1535 - val_accuracy30: 0.4457 - 4s/epoch - 21ms/step
Epoch 9/50
200/200 - 4s - loss: 3.0802 - accuracy30: 0.4630 - val_loss: 3.1490 - val_accuracy30: 0.4450 - 4s/epoch - 22ms/step
Epoch 10/50
200/200 - 4s - loss: 3.0698 - accuracy30: 0.4659 - val_loss: 3.1606 - val_accuracy30: 0.4413 - 4s/epoch - 22ms/step
Epoch 11/50
200/200 - 4s - loss: 3.0520 - accuracy30: 0.4733 - val_loss: 3.1591 - val_accuracy30: 0.4407 - 4s/epoch - 21ms/step
Epoch 12/50
200/200 - 4s - loss: 3.0428 - accuracy30: 0.4744 - val_loss: 3.1484 - val_accuracy30: 0.4440 - 4s/epoch - 21ms/step
Epoch 13/50
200/200 - 4s - loss: 3.0273 - accuracy30: 0.4807 - val_loss: 3.1345 - val_accuracy30: 0.4523 - 4s/epoch - 21ms/step
Epoch 14/50
200/200 - 4s - loss: 3.0227 - accuracy30: 0.4811 - val_loss: 3.1308 - val_accuracy30: 0.4513 - 4s/epoch - 21ms/step
Epoch 15/50
200/200 - 4s - loss: 3.0048 - accuracy30: 0.4883 - val_loss: 3.1463 - val_accuracy30: 0.4428 - 4s/epoch - 21ms/step
Epoch 16/50
200/200 - 4s - loss: 2.9932 - accuracy30: 0.4923 - val_loss: 3.1368 - val_accuracy30: 0.4485 - 4s/epoch - 21ms/step
Epoch 17/50
200/200 - 4s - loss: 2.9841 - accuracy30: 0.4949 - val_loss: 3.1402 - val_accuracy30: 0.4464 - 4s/epoch - 21ms/step
Epoch 18/50
200/200 - 4s - loss: 2.9790 - accuracy30: 0.4953 - val_loss: 3.1465 - val_accuracy30: 0.4481 - 4s/epoch - 21ms/step
Epoch 19/50
200/200 - 4s - loss: 2.9692 - accuracy30: 0.4976 - val_loss: 3.1798 - val_accuracy30: 0.4375 - 4s/epoch - 22ms/step
Epoch 20/50
200/200 - 4s - loss: 2.9610 - accuracy30: 0.5000 - val_loss: 3.1538 - val_accuracy30: 0.4430 - 4s/epoch - 21ms/step
Epoch 21/50
200/200 - 4s - loss: 2.9532 - accuracy30: 0.5028 - val_loss: 3.1675 - val_accuracy30: 0.4361 - 4s/epoch - 21ms/step
Epoch 22/50
200/200 - 4s - loss: 2.9415 - accuracy30: 0.5076 - val_loss: 3.1739 - val_accuracy30: 0.4405 - 4s/epoch - 21ms/step
Epoch 23/50
200/200 - 4s - loss: 2.9320 - accuracy30: 0.5101 - val_loss: 3.1864 - val_accuracy30: 0.4322 - 4s/epoch - 21ms/step
Epoch 24/50
200/200 - 4s - loss: 2.9234 - accuracy30: 0.5132 - val_loss: 3.1985 - val_accuracy30: 0.4341 - 4s/epoch - 21ms/step
testing model: results/LILAK/W9/deepVOL_L2/h30
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0839152
{'0': {'precision': 0.38623795821343676, 'recall': 0.6121752924846322, 'f1-score': 0.4736422215403498, 'support': 25215}, '1': {'precision': 0.41908905758192927, 'recall': 0.40124085973853313, 'f1-score': 0.4099707939957889, 'support': 22565}, '2': {'precision': 0.44223107569721115, 'recall': 0.2212437486410089, 'f1-score': 0.29493466025749415, 'support': 27594}, 'accuracy': 0.4059091994586993, 'macro avg': {'precision': 0.41585269716419243, 'recall': 0.41155330028805803, 'f1-score': 0.3928492252645443, 'support': 75374}, 'weighted avg': {'precision': 0.4165714835815651, 'recall': 0.4059091994586993, 'f1-score': 0.3891568259320215, 'support': 75374}}
[[15436  5596  4183]
 [ 9994  9054  3517]
 [14535  6954  6105]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0299512
{'0': {'precision': 0.4358963207793337, 'recall': 0.5722523551241793, 'f1-score': 0.4948529956306006, 'support': 17515}, '1': {'precision': 0.5002011147503304, 'recall': 0.5287935852265825, 'f1-score': 0.5141001033515429, 'support': 16462}, '2': {'precision': 0.4614237793514722, 'recall': 0.2887126865671642, 'f1-score': 0.35518576961698467, 'support': 17152}, 'accuracy': 0.46314224803927323, 'macro avg': {'precision': 0.46584040496037876, 'recall': 0.46325287563930867, 'f1-score': 0.45471295619970936, 'support': 51129}, 'weighted avg': {'precision': 0.46516410399003344, 'recall': 0.46314224803927323, 'f1-score': 0.4541964920165384, 'support': 51129}}
[[10023  4260  3232]
 [ 5209  8705  2548]
 [ 7762  4438  4952]]
Evaluating performance on  val set...
53/53 - 1s - 514ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0417771
{'0': {'precision': 0.4102225886232481, 'recall': 0.5626413387607417, 'f1-score': 0.47449222847334793, 'support': 4422}, '1': {'precision': 0.5323076923076923, 'recall': 0.5148809523809523, 'f1-score': 0.5234493192133132, 'support': 4704}, '2': {'precision': 0.41396160558464223, 'recall': 0.27239320165365183, 'f1-score': 0.3285773652860507, 'support': 4354}, 'accuracy': 0.45222551928783383, 'macro avg': {'precision': 0.4521639621718609, 'recall': 0.44997183093178195, 'f1-score': 0.4421729709909039, 'support': 13480}, 'weighted avg': {'precision': 0.4540332716782582, 'recall': 0.45222551928783383, 'f1-score': 0.44444629676142683, 'support': 13480}}
[[2488 1051  883]
 [1486 2422  796]
 [2091 1077 1186]]
training model: results/LILAK/W9/deepVOL_L2/h50
Epoch 1/50
200/200 - 6s - loss: 3.3393 - accuracy50: 0.3624 - val_loss: 3.3412 - val_accuracy50: 0.3602 - 6s/epoch - 32ms/step
Epoch 2/50
200/200 - 4s - loss: 3.2941 - accuracy50: 0.3770 - val_loss: 3.2801 - val_accuracy50: 0.3875 - 4s/epoch - 22ms/step
Epoch 3/50
200/200 - 4s - loss: 3.2551 - accuracy50: 0.3952 - val_loss: 3.2843 - val_accuracy50: 0.3894 - 4s/epoch - 21ms/step
Epoch 4/50
200/200 - 4s - loss: 3.2286 - accuracy50: 0.4048 - val_loss: 3.2571 - val_accuracy50: 0.3981 - 4s/epoch - 22ms/step
Epoch 5/50
200/200 - 4s - loss: 3.2123 - accuracy50: 0.4142 - val_loss: 3.2258 - val_accuracy50: 0.4190 - 4s/epoch - 22ms/step
Epoch 6/50
200/200 - 4s - loss: 3.1881 - accuracy50: 0.4228 - val_loss: 3.2404 - val_accuracy50: 0.4122 - 4s/epoch - 21ms/step
Epoch 7/50
200/200 - 4s - loss: 3.1697 - accuracy50: 0.4300 - val_loss: 3.2218 - val_accuracy50: 0.4163 - 4s/epoch - 21ms/step
Epoch 8/50
200/200 - 4s - loss: 3.1540 - accuracy50: 0.4362 - val_loss: 3.2388 - val_accuracy50: 0.4125 - 4s/epoch - 21ms/step
Epoch 9/50
200/200 - 4s - loss: 3.1433 - accuracy50: 0.4430 - val_loss: 3.2397 - val_accuracy50: 0.4113 - 4s/epoch - 21ms/step
Epoch 10/50
200/200 - 4s - loss: 3.1325 - accuracy50: 0.4461 - val_loss: 3.2316 - val_accuracy50: 0.4199 - 4s/epoch - 21ms/step
Epoch 11/50
200/200 - 4s - loss: 3.1184 - accuracy50: 0.4502 - val_loss: 3.2360 - val_accuracy50: 0.4114 - 4s/epoch - 21ms/step
Epoch 12/50
200/200 - 4s - loss: 3.1099 - accuracy50: 0.4522 - val_loss: 3.2217 - val_accuracy50: 0.4164 - 4s/epoch - 22ms/step
Epoch 13/50
200/200 - 4s - loss: 3.1002 - accuracy50: 0.4583 - val_loss: 3.2457 - val_accuracy50: 0.4055 - 4s/epoch - 22ms/step
Epoch 14/50
200/200 - 4s - loss: 3.0942 - accuracy50: 0.4593 - val_loss: 3.2551 - val_accuracy50: 0.3984 - 4s/epoch - 21ms/step
Epoch 15/50
200/200 - 4s - loss: 3.0794 - accuracy50: 0.4647 - val_loss: 3.2415 - val_accuracy50: 0.4086 - 4s/epoch - 21ms/step
Epoch 16/50
200/200 - 4s - loss: 3.0746 - accuracy50: 0.4654 - val_loss: 3.2435 - val_accuracy50: 0.4112 - 4s/epoch - 22ms/step
Epoch 17/50
200/200 - 4s - loss: 3.0628 - accuracy50: 0.4706 - val_loss: 3.2641 - val_accuracy50: 0.4008 - 4s/epoch - 21ms/step
Epoch 18/50
200/200 - 4s - loss: 3.0510 - accuracy50: 0.4736 - val_loss: 3.2675 - val_accuracy50: 0.3994 - 4s/epoch - 22ms/step
Epoch 19/50
200/200 - 5s - loss: 3.0408 - accuracy50: 0.4768 - val_loss: 3.2846 - val_accuracy50: 0.3915 - 5s/epoch - 23ms/step
Epoch 20/50
200/200 - 4s - loss: 3.0354 - accuracy50: 0.4789 - val_loss: 3.2990 - val_accuracy50: 0.3895 - 4s/epoch - 22ms/step
Epoch 21/50
200/200 - 4s - loss: 3.0247 - accuracy50: 0.4820 - val_loss: 3.3054 - val_accuracy50: 0.3930 - 4s/epoch - 21ms/step
Epoch 22/50
200/200 - 4s - loss: 3.0168 - accuracy50: 0.4838 - val_loss: 3.3395 - val_accuracy50: 0.3835 - 4s/epoch - 21ms/step
testing model: results/LILAK/W9/deepVOL_L2/h50
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0906688
{'0': {'precision': 0.35656645569620254, 'recall': 0.5503724508486995, 'f1-score': 0.43276201449901575, 'support': 24567}, '1': {'precision': 0.42459562321598476, 'recall': 0.3033521689255215, 'f1-score': 0.3538770351646717, 'support': 23537}, '2': {'precision': 0.4207287527861227, 'recall': 0.3184085075174184, 'f1-score': 0.3624864323286298, 'support': 27270}, 'accuracy': 0.3893119643378353, 'macro avg': {'precision': 0.40063027723277006, 'recall': 0.39071104243054644, 'f1-score': 0.38304182733077247, 'support': 75374}, 'weighted avg': {'precision': 0.40102354113090466, 'recall': 0.3893119643378353, 'f1-score': 0.38270322918340455, 'support': 75374}}
[[13521  4600  6446]
 [10888  7140  5509]
 [13511  5076  8683]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0445702
{'0': {'precision': 0.424199124222171, 'recall': 0.5302489052777137, 'f1-score': 0.47133236024685665, 'support': 17356}, '1': {'precision': 0.4976322833024501, 'recall': 0.4321215733015495, 'f1-score': 0.4625689770661223, 'support': 16780}, '2': {'precision': 0.427437260310839, 'recall': 0.3738598246336727, 'f1-score': 0.39885735811150175, 'support': 16993}, 'accuracy': 0.44606778931721724, 'macro avg': {'precision': 0.44975622261181997, 'recall': 0.4454101010709786, 'f1-score': 0.4442528984748269, 'support': 51129}, 'weighted avg': {'precision': 0.44937532668890845, 'recall': 0.44606778931721724, 'f1-score': 0.4443688506718834, 'support': 51129}}
[[9203 3529 4624]
 [5643 7251 3886]
 [6849 3791 6353]]
Evaluating performance on  val set...
53/53 - 1s - 510ms/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0733429
{'0': {'precision': 0.3801867219917012, 'recall': 0.5027434842249657, 'f1-score': 0.4329592439456586, 'support': 4374}, '1': {'precision': 0.5097508125677139, 'recall': 0.38844169246646026, 'f1-score': 0.4409042989340518, 'support': 4845}, '2': {'precision': 0.38311688311688313, 'recall': 0.3600093874677306, 'f1-score': 0.3712038717483363, 'support': 4261}, 'accuracy': 0.41654302670623145, 'macro avg': {'precision': 0.4243514725587661, 'recall': 0.4170648547197189, 'f1-score': 0.41502247154268224, 'support': 13480}, 'weighted avg': {'precision': 0.42768104212487495, 'recall': 0.41654302670623145, 'f1-score': 0.4162941215781493, 'support': 13480}}
[[2199  906 1269]
 [1762 1882 1201]
 [1823  904 1534]]
training model: results/LILAK/W9/deepVOL_L2/h100
Epoch 1/50
200/200 - 6s - loss: 3.3656 - accuracy100: 0.3523 - val_loss: 3.3425 - val_accuracy100: 0.3472 - 6s/epoch - 32ms/step
Epoch 2/50
200/200 - 4s - loss: 3.3114 - accuracy100: 0.3579 - val_loss: 3.3176 - val_accuracy100: 0.3633 - 4s/epoch - 22ms/step
Epoch 3/50
200/200 - 4s - loss: 3.2834 - accuracy100: 0.3721 - val_loss: 3.3358 - val_accuracy100: 0.3426 - 4s/epoch - 21ms/step
Epoch 4/50
200/200 - 4s - loss: 3.2736 - accuracy100: 0.3703 - val_loss: 3.3318 - val_accuracy100: 0.3396 - 4s/epoch - 21ms/step
Epoch 5/50
200/200 - 4s - loss: 3.2445 - accuracy100: 0.3852 - val_loss: 3.3354 - val_accuracy100: 0.3355 - 4s/epoch - 21ms/step
Epoch 6/50
200/200 - 4s - loss: 3.2278 - accuracy100: 0.3911 - val_loss: 3.3233 - val_accuracy100: 0.3523 - 4s/epoch - 22ms/step
Epoch 7/50
200/200 - 4s - loss: 3.2144 - accuracy100: 0.4006 - val_loss: 3.3293 - val_accuracy100: 0.3496 - 4s/epoch - 21ms/step
Epoch 8/50
200/200 - 4s - loss: 3.2015 - accuracy100: 0.4055 - val_loss: 3.3326 - val_accuracy100: 0.3551 - 4s/epoch - 21ms/step
Epoch 9/50
200/200 - 4s - loss: 3.1873 - accuracy100: 0.4154 - val_loss: 3.3520 - val_accuracy100: 0.3476 - 4s/epoch - 21ms/step
Epoch 10/50
200/200 - 4s - loss: 3.1779 - accuracy100: 0.4186 - val_loss: 3.3572 - val_accuracy100: 0.3544 - 4s/epoch - 21ms/step
Epoch 11/50
200/200 - 4s - loss: 3.1671 - accuracy100: 0.4229 - val_loss: 3.3563 - val_accuracy100: 0.3570 - 4s/epoch - 21ms/step
Epoch 12/50
200/200 - 4s - loss: 3.1548 - accuracy100: 0.4315 - val_loss: 3.3677 - val_accuracy100: 0.3493 - 4s/epoch - 21ms/step
testing model: results/LILAK/W9/deepVOL_L2/h100
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1128337
{'0': {'precision': 0.31268762026940344, 'recall': 0.5200119474313023, 'f1-score': 0.3905401291439009, 'support': 23436}, '1': {'precision': 0.3556490047659097, 'recall': 0.2286589762076424, 'f1-score': 0.27835436094349975, 'support': 27740}, '2': {'precision': 0.346961861667744, 'recall': 0.266179023059757, 'f1-score': 0.30124877227444924, 'support': 24198}, 'accuracy': 0.3312946108737761, 'macro avg': {'precision': 0.338432828901019, 'recall': 0.3382833155662339, 'f1-score': 0.32338108745394994, 'support': 75374}, 'weighted avg': {'precision': 0.3395021305685799, 'recall': 0.3312946108737761, 'f1-score': 0.3205862264267024, 'support': 75374}}
[[12187  5682  5567]
 [14841  6343  6556]
 [11947  5810  6441]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0972053
{'0': {'precision': 0.3597900649141384, 'recall': 0.44471632618221135, 'f1-score': 0.39777065200794015, 'support': 17573}, '1': {'precision': 0.36868756936736957, 'recall': 0.3236511996102789, 'f1-score': 0.34470458525196185, 'support': 16422}, '2': {'precision': 0.3677294557097118, 'recall': 0.3217579082525972, 'f1-score': 0.34321110626906554, 'support': 17134}, 'accuracy': 0.36462672847112204, 'macro avg': {'precision': 0.36540236333040665, 'recall': 0.3633751446816958, 'f1-score': 0.36189544784298916, 'support': 51129}, 'weighted avg': {'precision': 0.36530842709650685, 'recall': 0.36462672847112204, 'f1-score': 0.3624428692436273, 'support': 51129}}
[[7815 4642 5116]
 [6744 5315 4363]
 [7162 4459 5513]]
Evaluating performance on  val set...
53/53 - 1s - 516ms/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1029634
{'0': {'precision': 0.33623819898329704, 'recall': 0.41796434213495826, 'f1-score': 0.37267330717375996, 'support': 4431}, '1': {'precision': 0.40850760456273766, 'recall': 0.3532675709001233, 'f1-score': 0.3788847255895966, 'support': 4866}, '2': {'precision': 0.32678002125398514, 'recall': 0.2940473344489601, 'f1-score': 0.3095507738769347, 'support': 4183}, 'accuracy': 0.35615727002967357, 'macro avg': {'precision': 0.35717527493333995, 'recall': 0.3550930824946805, 'f1-score': 0.3537029355467638, 'support': 13480}, 'weighted avg': {'precision': 0.3593909712464904, 'recall': 0.35615727002967357, 'f1-score': 0.35532784762115177, 'support': 13480}}
[[1852 1304 1275]
 [1888 1719 1259]
 [1768 1185 1230]]
training model: results/LILAK/W9/deepVOL_L2/h200
Epoch 1/50
200/200 - 6s - loss: 3.3642 - accuracy200: 0.3474 - val_loss: 3.3275 - val_accuracy200: 0.3489 - 6s/epoch - 31ms/step
Epoch 2/50
200/200 - 4s - loss: 3.3282 - accuracy200: 0.3473 - val_loss: 3.3279 - val_accuracy200: 0.3401 - 4s/epoch - 22ms/step
Epoch 3/50
200/200 - 4s - loss: 3.3052 - accuracy200: 0.3550 - val_loss: 3.3265 - val_accuracy200: 0.3412 - 4s/epoch - 22ms/step
Epoch 4/50
200/200 - 4s - loss: 3.2831 - accuracy200: 0.3670 - val_loss: 3.3270 - val_accuracy200: 0.3361 - 4s/epoch - 21ms/step
Epoch 5/50
200/200 - 4s - loss: 3.2633 - accuracy200: 0.3742 - val_loss: 3.3221 - val_accuracy200: 0.3412 - 4s/epoch - 21ms/step
Epoch 6/50
200/200 - 4s - loss: 3.2533 - accuracy200: 0.3790 - val_loss: 3.3355 - val_accuracy200: 0.3348 - 4s/epoch - 21ms/step
Epoch 7/50
200/200 - 4s - loss: 3.2313 - accuracy200: 0.3880 - val_loss: 3.3303 - val_accuracy200: 0.3403 - 4s/epoch - 21ms/step
Epoch 8/50
200/200 - 4s - loss: 3.2111 - accuracy200: 0.4033 - val_loss: 3.3253 - val_accuracy200: 0.3487 - 4s/epoch - 21ms/step
Epoch 9/50
200/200 - 4s - loss: 3.2036 - accuracy200: 0.4077 - val_loss: 3.3411 - val_accuracy200: 0.3414 - 4s/epoch - 21ms/step
Epoch 10/50
200/200 - 4s - loss: 3.1876 - accuracy200: 0.4164 - val_loss: 3.3315 - val_accuracy200: 0.3499 - 4s/epoch - 21ms/step
Epoch 11/50
200/200 - 4s - loss: 3.1766 - accuracy200: 0.4236 - val_loss: 3.3441 - val_accuracy200: 0.3509 - 4s/epoch - 21ms/step
Epoch 12/50
200/200 - 4s - loss: 3.1653 - accuracy200: 0.4289 - val_loss: 3.3561 - val_accuracy200: 0.3477 - 4s/epoch - 21ms/step
Epoch 13/50
200/200 - 4s - loss: 3.1519 - accuracy200: 0.4364 - val_loss: 3.3653 - val_accuracy200: 0.3477 - 4s/epoch - 21ms/step
Epoch 14/50
200/200 - 4s - loss: 3.1341 - accuracy200: 0.4430 - val_loss: 3.3666 - val_accuracy200: 0.3515 - 4s/epoch - 21ms/step
Epoch 15/50
200/200 - 4s - loss: 3.1264 - accuracy200: 0.4456 - val_loss: 3.3896 - val_accuracy200: 0.3545 - 4s/epoch - 21ms/step
testing model: results/LILAK/W9/deepVOL_L2/h200
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1138043
{'0': {'precision': 0.374345449680847, 'recall': 0.35044906430028266, 'f1-score': 0.3620033265570135, 'support': 27947}, '1': {'precision': 0.281283721673794, 'recall': 0.3248857498961363, 'f1-score': 0.30151657955616484, 'support': 21663}, '2': {'precision': 0.32310872261264983, 'recall': 0.30336904207421206, 'f1-score': 0.31292789366216917, 'support': 25764}, 'accuracy': 0.3270093135563988, 'macro avg': {'precision': 0.3262459646557636, 'recall': 0.326234618756877, 'f1-score': 0.32548259992511586, 'support': 75374}, 'weighted avg': {'precision': 0.33008536994510496, 'recall': 0.3270093135563988, 'f1-score': 0.32784428161602386, 'support': 75374}}
[[9794 9004 9149]
 [7400 7038 7225]
 [8969 8979 7816]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0928199
{'0': {'precision': 0.35666190573352374, 'recall': 0.4094156224382246, 'f1-score': 0.38122239790633, 'support': 17078}, '1': {'precision': 0.3698093220338983, 'recall': 0.414632697903676, 'f1-score': 0.3909403958677455, 'support': 16839}, '2': {'precision': 0.37500988533017005, 'recall': 0.2755054613060655, 'f1-score': 0.3176474528586261, 'support': 17212}, 'accuracy': 0.36605448962428366, 'macro avg': {'precision': 0.3671603710325307, 'recall': 0.3665179272159887, 'f1-score': 0.3632700822109005, 'support': 51129}, 'weighted avg': {'precision': 0.36716856081966825, 'recall': 0.36605448962428366, 'f1-score': 0.36302116990482786, 'support': 51129}}
[[6992 5961 4125]
 [6079 6982 3778]
 [6533 5937 4742]]
Evaluating performance on  val set...
53/53 - 1s - 518ms/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1072822
{'0': {'precision': 0.3229770054414604, 'recall': 0.41865756541524457, 'f1-score': 0.36464526357510896, 'support': 4395}, '1': {'precision': 0.37436955524988536, 'recall': 0.32969917221885725, 'f1-score': 0.35061728395061725, 'support': 4953}, '2': {'precision': 0.31862028646594565, 'recall': 0.2637947725072604, 'f1-score': 0.2886270356149875, 'support': 4132}, 'accuracy': 0.3385014836795252, 'macro avg': {'precision': 0.3386556157190972, 'recall': 0.3373838367137874, 'f1-score': 0.3346298610469045, 'support': 13480}, 'weighted avg': {'precision': 0.34052487906121576, 'recall': 0.3385014836795252, 'f1-score': 0.3361891878324287, 'support': 13480}}
[[1840 1439 1116]
 [2105 1633 1215]
 [1752 1290 1090]]
training model: results/LILAK/W9/deepVOL_L2/h300
Epoch 1/50
200/200 - 6s - loss: 3.3643 - accuracy300: 0.3508 - val_loss: 3.3497 - val_accuracy300: 0.3393 - 6s/epoch - 32ms/step
Epoch 2/50
200/200 - 4s - loss: 3.3185 - accuracy300: 0.3552 - val_loss: 3.3394 - val_accuracy300: 0.3448 - 4s/epoch - 22ms/step
Epoch 3/50
200/200 - 4s - loss: 3.3036 - accuracy300: 0.3588 - val_loss: 3.3203 - val_accuracy300: 0.3463 - 4s/epoch - 21ms/step
Epoch 4/50
200/200 - 4s - loss: 3.2772 - accuracy300: 0.3658 - val_loss: 3.3130 - val_accuracy300: 0.3462 - 4s/epoch - 22ms/step
Epoch 5/50
200/200 - 4s - loss: 3.2617 - accuracy300: 0.3728 - val_loss: 3.3148 - val_accuracy300: 0.3423 - 4s/epoch - 21ms/step
Epoch 6/50
200/200 - 4s - loss: 3.2572 - accuracy300: 0.3796 - val_loss: 3.3241 - val_accuracy300: 0.3342 - 4s/epoch - 21ms/step
Epoch 7/50
200/200 - 4s - loss: 3.2456 - accuracy300: 0.3796 - val_loss: 3.3181 - val_accuracy300: 0.3430 - 4s/epoch - 21ms/step
Epoch 8/50
200/200 - 4s - loss: 3.2265 - accuracy300: 0.3921 - val_loss: 3.3432 - val_accuracy300: 0.3228 - 4s/epoch - 21ms/step
Epoch 9/50
200/200 - 4s - loss: 3.2126 - accuracy300: 0.4002 - val_loss: 3.3560 - val_accuracy300: 0.3259 - 4s/epoch - 21ms/step
Epoch 10/50
200/200 - 4s - loss: 3.1969 - accuracy300: 0.4094 - val_loss: 3.3597 - val_accuracy300: 0.3296 - 4s/epoch - 21ms/step
Epoch 11/50
200/200 - 4s - loss: 3.1878 - accuracy300: 0.4125 - val_loss: 3.3853 - val_accuracy300: 0.3163 - 4s/epoch - 21ms/step
Epoch 12/50
200/200 - 4s - loss: 3.1844 - accuracy300: 0.4148 - val_loss: 3.4009 - val_accuracy300: 0.3175 - 4s/epoch - 21ms/step
Epoch 13/50
200/200 - 4s - loss: 3.1731 - accuracy300: 0.4198 - val_loss: 3.4040 - val_accuracy300: 0.3203 - 4s/epoch - 21ms/step
Epoch 14/50
200/200 - 4s - loss: 3.1600 - accuracy300: 0.4270 - val_loss: 3.4121 - val_accuracy300: 0.3211 - 4s/epoch - 21ms/step
testing model: results/LILAK/W9/deepVOL_L2/h300
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1109185
{'0': {'precision': 0.33093266114512065, 'recall': 0.20827982171186823, 'f1-score': 0.25565652818991097, 'support': 26474}, '1': {'precision': 0.33584400587864793, 'recall': 0.49495262038290466, 'f1-score': 0.40016260416829535, 'support': 25855}, '2': {'precision': 0.2959045031055901, 'recall': 0.26461271425471905, 'f1-score': 0.27938515107781825, 'support': 23045}, 'accuracy': 0.32383845888502666, 'macro avg': {'precision': 0.3208937233764529, 'recall': 0.32261505211649727, 'f1-score': 0.31173476114534154, 'support': 75374}, 'weighted avg': {'precision': 0.3219077840796122, 'recall': 0.32383845888502666, 'f1-score': 0.3124802433817935, 'support': 75374}}
[[ 5514 13518  7442]
 [ 5990 12797  7068]
 [ 5158 11789  6098]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1023204
{'0': {'precision': 0.35709306378529104, 'recall': 0.24148497348261638, 'f1-score': 0.28812486817127186, 'support': 16970}, '1': {'precision': 0.33764836795252223, 'recall': 0.53972489031187, 'f1-score': 0.41541550677679906, 'support': 16866}, '2': {'precision': 0.3378239974789254, 'recall': 0.24796160296073555, 'f1-score': 0.2860001333955846, 'support': 17293}, 'accuracy': 0.34205636722799193, 'macro avg': {'precision': 0.3441884764055796, 'recall': 0.34305715558507394, 'f1-score': 0.32984683611455184, 'support': 51129}, 'weighted avg': {'precision': 0.3441615727811357, 'recall': 0.34205636722799193, 'f1-score': 0.32939578824099475, 'support': 51129}}
[[4098 8611 4261]
 [3619 9103 4144]
 [3759 9246 4288]]
Evaluating performance on  val set...
53/53 - 1s - 509ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1026117
{'0': {'precision': 0.3164179104477612, 'recall': 0.22746781115879827, 'f1-score': 0.264669163545568, 'support': 4194}, '1': {'precision': 0.3968460648148148, 'recall': 0.507962962962963, 'f1-score': 0.44558154645873943, 'support': 5400}, '2': {'precision': 0.2848297213622291, 'recall': 0.26042202779207413, 'f1-score': 0.27207958058878884, 'support': 3886}, 'accuracy': 0.34933234421364984, 'macro avg': {'precision': 0.332697898874935, 'recall': 0.33195093397127845, 'f1-score': 0.3274434301976987, 'support': 13480}, 'weighted avg': {'precision': 0.3395306946314193, 'recall': 0.34933234421364984, 'f1-score': 0.3392777502192388, 'support': 13480}}
[[ 954 2141 1099]
 [1215 2743 1442]
 [ 846 2028 1012]]
training model: results/LILAK/W9/deepVOL_L2/h500
Epoch 1/50
200/200 - 6s - loss: 3.3469 - accuracy500: 0.3614 - val_loss: 3.3461 - val_accuracy500: 0.3530 - 6s/epoch - 29ms/step
Epoch 2/50
200/200 - 4s - loss: 3.3154 - accuracy500: 0.3556 - val_loss: 3.3376 - val_accuracy500: 0.3526 - 4s/epoch - 21ms/step
Epoch 3/50
200/200 - 4s - loss: 3.2914 - accuracy500: 0.3628 - val_loss: 3.3163 - val_accuracy500: 0.3478 - 4s/epoch - 21ms/step
Epoch 4/50
200/200 - 4s - loss: 3.2681 - accuracy500: 0.3754 - val_loss: 3.3197 - val_accuracy500: 0.3411 - 4s/epoch - 21ms/step
Epoch 5/50
200/200 - 4s - loss: 3.2702 - accuracy500: 0.3747 - val_loss: 3.3230 - val_accuracy500: 0.3428 - 4s/epoch - 21ms/step
Epoch 6/50
200/200 - 4s - loss: 3.2616 - accuracy500: 0.3798 - val_loss: 3.3032 - val_accuracy500: 0.3555 - 4s/epoch - 22ms/step
Epoch 7/50
200/200 - 4s - loss: 3.2411 - accuracy500: 0.3866 - val_loss: 3.3109 - val_accuracy500: 0.3444 - 4s/epoch - 21ms/step
Epoch 8/50
200/200 - 4s - loss: 3.2307 - accuracy500: 0.3977 - val_loss: 3.3277 - val_accuracy500: 0.3438 - 4s/epoch - 21ms/step
Epoch 9/50
200/200 - 4s - loss: 3.2169 - accuracy500: 0.4051 - val_loss: 3.3317 - val_accuracy500: 0.3489 - 4s/epoch - 21ms/step
Epoch 10/50
200/200 - 4s - loss: 3.1984 - accuracy500: 0.4123 - val_loss: 3.3285 - val_accuracy500: 0.3504 - 4s/epoch - 22ms/step
Epoch 11/50
200/200 - 4s - loss: 3.1825 - accuracy500: 0.4187 - val_loss: 3.3331 - val_accuracy500: 0.3547 - 4s/epoch - 22ms/step
Epoch 12/50
200/200 - 4s - loss: 3.1625 - accuracy500: 0.4327 - val_loss: 3.3542 - val_accuracy500: 0.3447 - 4s/epoch - 22ms/step
Epoch 13/50
200/200 - 4s - loss: 3.1529 - accuracy500: 0.4382 - val_loss: 3.3526 - val_accuracy500: 0.3545 - 4s/epoch - 22ms/step
Epoch 14/50
200/200 - 4s - loss: 3.1366 - accuracy500: 0.4460 - val_loss: 3.3715 - val_accuracy500: 0.3473 - 4s/epoch - 21ms/step
Epoch 15/50
200/200 - 4s - loss: 3.1205 - accuracy500: 0.4487 - val_loss: 3.3710 - val_accuracy500: 0.3467 - 4s/epoch - 21ms/step
Epoch 16/50
200/200 - 4s - loss: 3.1032 - accuracy500: 0.4575 - val_loss: 3.4013 - val_accuracy500: 0.3451 - 4s/epoch - 21ms/step
testing model: results/LILAK/W9/deepVOL_L2/h500
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1128933
{'0': {'precision': 0.4074074074074074, 'recall': 0.1723464070213933, 'f1-score': 0.2422242031464572, 'support': 29168}, '1': {'precision': 0.2885749708832701, 'recall': 0.3535232659824182, 'f1-score': 0.3177643554525898, 'support': 21727}, '2': {'precision': 0.31500906145312757, 'recall': 0.4686465950406471, 'f1-score': 0.3767673284398246, 'support': 24479}, 'accuracy': 0.32080027595722665, 'macro avg': {'precision': 0.3369971465812684, 'recall': 0.3315054226814862, 'f1-score': 0.3122519623462905, 'support': 75374}, 'weighted avg': {'precision': 0.34314530828868284, 'recall': 0.32080027595722665, 'f1-score': 0.3076942863742504, 'support': 75374}}
[[ 5027  9809 14332]
 [ 3432  7681 10614]
 [ 3880  9127 11472]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0894033
{'0': {'precision': 0.36767454645409564, 'recall': 0.20080465982105328, 'f1-score': 0.25974832996737607, 'support': 16653}, '1': {'precision': 0.3760348971779578, 'recall': 0.49432416617905206, 'f1-score': 0.4271412680756396, 'support': 17090}, '2': {'precision': 0.37341578086672117, 'recall': 0.4202806856091108, 'f1-score': 0.39546463170428103, 'support': 17386}, 'accuracy': 0.37354534608539186, 'macro avg': {'precision': 0.37237507483292487, 'recall': 0.3718031705364054, 'f1-score': 0.3607847432490989, 'support': 51129}, 'weighted avg': {'precision': 0.3724212752258047, 'recall': 0.37354534608539186, 'f1-score': 0.3618490738557379, 'support': 51129}}
[[3344 6953 6356]
 [2737 8448 5905]
 [3014 7065 7307]]
Evaluating performance on  val set...
53/53 - 1s - 510ms/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995047
{'0': {'precision': 0.3498769483182937, 'recall': 0.19316123188405798, 'f1-score': 0.24890574846804786, 'support': 4416}, '1': {'precision': 0.37495688168333907, 'recall': 0.4636383024098955, 'f1-score': 0.4146085629827405, 'support': 4689}, '2': {'precision': 0.34286803966437834, 'recall': 0.4109714285714286, 'f1-score': 0.3738434348684895, 'support': 4375}, 'accuracy': 0.35793768545994065, 'macro avg': {'precision': 0.3559006232220037, 'recall': 0.3559236542884607, 'f1-score': 0.34578591543975934, 'support': 13480}, 'weighted avg': {'precision': 0.3563261940295562, 'recall': 0.35793768545994065, 'f1-score': 0.34709438906606904, 'support': 13480}}
[[ 853 1857 1706]
 [ 775 2174 1740]
 [ 810 1767 1798]]
training model: results/LILAK/W9/deepVOL_L2/h1000
Epoch 1/50
200/200 - 6s - loss: 3.3496 - accuracy1000: 0.3614 - val_loss: 3.3653 - val_accuracy1000: 0.3357 - 6s/epoch - 32ms/step
Epoch 2/50
200/200 - 4s - loss: 3.3420 - accuracy1000: 0.3551 - val_loss: 3.3446 - val_accuracy1000: 0.3281 - 4s/epoch - 21ms/step
Epoch 3/50
200/200 - 5s - loss: 3.3034 - accuracy1000: 0.3650 - val_loss: 3.3436 - val_accuracy1000: 0.3416 - 5s/epoch - 23ms/step
Epoch 4/50
200/200 - 4s - loss: 3.2901 - accuracy1000: 0.3682 - val_loss: 3.3307 - val_accuracy1000: 0.3349 - 4s/epoch - 21ms/step
Epoch 5/50
200/200 - 4s - loss: 3.2752 - accuracy1000: 0.3704 - val_loss: 3.3122 - val_accuracy1000: 0.3487 - 4s/epoch - 21ms/step
Epoch 6/50
200/200 - 4s - loss: 3.2654 - accuracy1000: 0.3798 - val_loss: 3.3301 - val_accuracy1000: 0.3346 - 4s/epoch - 21ms/step
Epoch 7/50
200/200 - 4s - loss: 3.2516 - accuracy1000: 0.3782 - val_loss: 3.3276 - val_accuracy1000: 0.3399 - 4s/epoch - 21ms/step
Epoch 8/50
200/200 - 4s - loss: 3.2310 - accuracy1000: 0.3931 - val_loss: 3.3481 - val_accuracy1000: 0.3345 - 4s/epoch - 21ms/step
Epoch 9/50
200/200 - 4s - loss: 3.2193 - accuracy1000: 0.3971 - val_loss: 3.3358 - val_accuracy1000: 0.3379 - 4s/epoch - 21ms/step
Epoch 10/50
200/200 - 4s - loss: 3.2006 - accuracy1000: 0.4079 - val_loss: 3.3425 - val_accuracy1000: 0.3447 - 4s/epoch - 21ms/step
Epoch 11/50
200/200 - 4s - loss: 3.1857 - accuracy1000: 0.4198 - val_loss: 3.3511 - val_accuracy1000: 0.3396 - 4s/epoch - 21ms/step
Epoch 12/50
200/200 - 4s - loss: 3.1682 - accuracy1000: 0.4247 - val_loss: 3.3708 - val_accuracy1000: 0.3353 - 4s/epoch - 21ms/step
Epoch 13/50
200/200 - 4s - loss: 3.1573 - accuracy1000: 0.4264 - val_loss: 3.3828 - val_accuracy1000: 0.3441 - 4s/epoch - 21ms/step
Epoch 14/50
200/200 - 4s - loss: 3.1486 - accuracy1000: 0.4338 - val_loss: 3.4193 - val_accuracy1000: 0.3316 - 4s/epoch - 21ms/step
Epoch 15/50
200/200 - 4s - loss: 3.1365 - accuracy1000: 0.4421 - val_loss: 3.4491 - val_accuracy1000: 0.3352 - 4s/epoch - 21ms/step
testing model: results/LILAK/W9/deepVOL_L2/h1000
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1065798
{'0': {'precision': 0.41688722819035756, 'recall': 0.27123851971907076, 'f1-score': 0.32864886979646113, 'support': 29616}, '1': {'precision': 0.3002355037871555, 'recall': 0.20515831593597772, 'f1-score': 0.24375371418236313, 'support': 22992}, '2': {'precision': 0.2950685745407734, 'recall': 0.5235438812263903, 'f1-score': 0.3774224192526916, 'support': 22766}, 'accuracy': 0.3272879242179001, 'macro avg': {'precision': 0.33739710217276214, 'recall': 0.3333135722938129, 'f1-score': 0.3166083344105053, 'support': 75374}, 'weighted avg': {'precision': 0.3445097516538217, 'recall': 0.3272879242179001, 'f1-score': 0.31748413406585374, 'support': 75374}}
[[ 8033  5977 15606]
 [ 5406  4717 12869]
 [ 5830  5017 11919]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.085068
{'0': {'precision': 0.35603591619554376, 'recall': 0.32614391031499423, 'f1-score': 0.340435003815823, 'support': 16413}, '1': {'precision': 0.42951767888795594, 'recall': 0.2801850048685492, 'f1-score': 0.33914036315421164, 'support': 16432}, '2': {'precision': 0.39716256157635466, 'recall': 0.5511922992780574, 'f1-score': 0.46166884262122354, 'support': 18284}, 'accuracy': 0.39185198224099826, 'macro avg': {'precision': 0.39423871888661816, 'recall': 0.38584040482053356, 'f1-score': 0.38041473653041935, 'support': 51129}, 'weighted avg': {'precision': 0.3943588231310298, 'recall': 0.39185198224099826, 'f1-score': 0.38337278811370373, 'support': 51129}}
[[ 5353  2906  8154]
 [ 4685  4604  7143]
 [ 4997  3209 10078]]
Evaluating performance on  val set...
53/53 - 1s - 511ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0998865
{'0': {'precision': 0.3253483255927646, 'recall': 0.31163661905876844, 'f1-score': 0.3183448935661325, 'support': 4271}, '1': {'precision': 0.3674825174825175, 'recall': 0.22957623416339012, 'f1-score': 0.2826028502285561, 'support': 4578}, '2': {'precision': 0.3606984224230357, 'recall': 0.5085294752753186, 'f1-score': 0.42204301075268813, 'support': 4631}, 'accuracy': 0.35140949554896145, 'macro avg': {'precision': 0.3511764218327726, 'recall': 0.34991410949915897, 'f1-score': 0.34099691818245886, 'support': 13480}, 'weighted avg': {'precision': 0.3518020814453072, 'recall': 0.35140949554896145, 'f1-score': 0.34183145931476117, 'support': 13480}}
[[1331  878 2062]
 [1415 1051 2112]
 [1345  931 2355]]
training model: results/LILAK/W9/deepVOL_L3/h10
Epoch 1/50
200/200 - 9s - loss: 3.3517 - accuracy10: 0.3501 - val_loss: 3.3226 - val_accuracy10: 0.3270 - 9s/epoch - 43ms/step
Epoch 2/50
200/200 - 7s - loss: 3.3202 - accuracy10: 0.3700 - val_loss: 3.3285 - val_accuracy10: 0.3197 - 7s/epoch - 33ms/step
Epoch 3/50
200/200 - 7s - loss: 3.2798 - accuracy10: 0.3851 - val_loss: 3.2627 - val_accuracy10: 0.3557 - 7s/epoch - 33ms/step
Epoch 4/50
200/200 - 7s - loss: 3.2258 - accuracy10: 0.4090 - val_loss: 3.2008 - val_accuracy10: 0.4098 - 7s/epoch - 33ms/step
Epoch 5/50
200/200 - 7s - loss: 3.1920 - accuracy10: 0.4203 - val_loss: 3.1591 - val_accuracy10: 0.4507 - 7s/epoch - 33ms/step
Epoch 6/50
200/200 - 7s - loss: 3.1610 - accuracy10: 0.4282 - val_loss: 3.1555 - val_accuracy10: 0.4424 - 7s/epoch - 33ms/step
Epoch 7/50
200/200 - 7s - loss: 3.1496 - accuracy10: 0.4345 - val_loss: 3.1546 - val_accuracy10: 0.4311 - 7s/epoch - 33ms/step
Epoch 8/50
200/200 - 7s - loss: 3.1297 - accuracy10: 0.4394 - val_loss: 3.1325 - val_accuracy10: 0.4443 - 7s/epoch - 33ms/step
Epoch 9/50
200/200 - 7s - loss: 3.1169 - accuracy10: 0.4442 - val_loss: 3.1365 - val_accuracy10: 0.4463 - 7s/epoch - 33ms/step
Epoch 10/50
200/200 - 7s - loss: 3.1040 - accuracy10: 0.4514 - val_loss: 3.1337 - val_accuracy10: 0.4485 - 7s/epoch - 33ms/step
Epoch 11/50
200/200 - 7s - loss: 3.0891 - accuracy10: 0.4565 - val_loss: 3.1533 - val_accuracy10: 0.4254 - 7s/epoch - 33ms/step
Epoch 12/50
200/200 - 7s - loss: 3.0782 - accuracy10: 0.4627 - val_loss: 3.1543 - val_accuracy10: 0.4237 - 7s/epoch - 33ms/step
Epoch 13/50
200/200 - 7s - loss: 3.0721 - accuracy10: 0.4621 - val_loss: 3.1333 - val_accuracy10: 0.4521 - 7s/epoch - 34ms/step
Epoch 14/50
200/200 - 7s - loss: 3.0575 - accuracy10: 0.4723 - val_loss: 3.1413 - val_accuracy10: 0.4364 - 7s/epoch - 33ms/step
Epoch 15/50
200/200 - 7s - loss: 3.0470 - accuracy10: 0.4755 - val_loss: 3.1573 - val_accuracy10: 0.4266 - 7s/epoch - 36ms/step
Epoch 16/50
200/200 - 7s - loss: 3.0379 - accuracy10: 0.4783 - val_loss: 3.1424 - val_accuracy10: 0.4366 - 7s/epoch - 33ms/step
Epoch 17/50
200/200 - 7s - loss: 3.0246 - accuracy10: 0.4811 - val_loss: 3.1480 - val_accuracy10: 0.4325 - 7s/epoch - 33ms/step
Epoch 18/50
200/200 - 7s - loss: 3.0108 - accuracy10: 0.4887 - val_loss: 3.1541 - val_accuracy10: 0.4250 - 7s/epoch - 35ms/step
testing model: results/LILAK/W9/deepVOL_L3/h10
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0792657
{'0': {'precision': 0.33378209443215695, 'recall': 0.48713510479041916, 'f1-score': 0.3961348981416316, 'support': 21376}, '1': {'precision': 0.6069250442651977, 'recall': 0.4000907823493175, 'f1-score': 0.482266731802638, 'support': 30843}, '2': {'precision': 0.32455441392325435, 'recall': 0.3342258691427338, 'f1-score': 0.3293191489361702, 'support': 23155}, 'accuracy': 0.4045426804999071, 'macro avg': {'precision': 0.42175385087353634, 'recall': 0.40715058542749016, 'f1-score': 0.4025735929601466, 'support': 75374}, 'weighted avg': {'precision': 0.44271728507504216, 'recall': 0.4045426804999071, 'f1-score': 0.4108541046684706, 'support': 75374}}
[[10413  3710  7253]
 [ 9650 12340  8853]
 [11134  4282  7739]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0473235
{'0': {'precision': 0.3642916093535076, 'recall': 0.45028563656147985, 'f1-score': 0.40274947534900696, 'support': 14704}, '1': {'precision': 0.6186089610814346, 'recall': 0.5129723377327788, 'f1-score': 0.5608598962194218, 'support': 22124}, '2': {'precision': 0.3308461117196057, 'recall': 0.33794839521711767, 'f1-score': 0.33435954201113843, 'support': 14301}, 'accuracy': 0.4459895558293728, 'macro avg': {'precision': 0.4379155607181826, 'recall': 0.4337354565037921, 'f1-score': 0.4326563045265224, 'support': 51129}, 'weighted avg': {'precision': 0.4649822746895444, 'recall': 0.4459895558293728, 'f1-score': 0.45203638717345485, 'support': 51129}}
[[ 6621  3343  4740]
 [ 5740 11349  5035]
 [ 5814  3654  4833]]
Evaluating performance on  val set...
53/53 - 1s - 851ms/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.049593
{'0': {'precision': 0.3481763257999552, 'recall': 0.4272377814387699, 'f1-score': 0.38367648871902355, 'support': 3642}, '1': {'precision': 0.6368536634058695, 'recall': 0.525708635464733, 'f1-score': 0.5759682224428998, 'support': 6068}, '2': {'precision': 0.34132933533233384, 'recall': 0.3623342175066313, 'f1-score': 0.35151827071538855, 'support': 3770}, 'accuracy': 0.45341246290801185, 'macro avg': {'precision': 0.44211977484605286, 'recall': 0.4384268781367114, 'f1-score': 0.43705432729243726, 'support': 13480}, 'weighted avg': {'precision': 0.47620903577990736, 'recall': 0.45341246290801185, 'f1-score': 0.4612424945322859, 'support': 13480}}
[[1556  892 1194]
 [1436 3190 1442]
 [1477  927 1366]]
training model: results/LILAK/W9/deepVOL_L3/h20
Epoch 1/50
200/200 - 9s - loss: 3.3630 - accuracy20: 0.3455 - val_loss: 3.4177 - val_accuracy20: 0.3192 - 9s/epoch - 46ms/step
Epoch 2/50
200/200 - 7s - loss: 3.3158 - accuracy20: 0.3539 - val_loss: 3.3423 - val_accuracy20: 0.3383 - 7s/epoch - 33ms/step
Epoch 3/50
200/200 - 7s - loss: 3.2858 - accuracy20: 0.3724 - val_loss: 3.2652 - val_accuracy20: 0.3814 - 7s/epoch - 33ms/step
Epoch 4/50
200/200 - 7s - loss: 3.2315 - accuracy20: 0.3973 - val_loss: 3.2188 - val_accuracy20: 0.4094 - 7s/epoch - 33ms/step
Epoch 5/50
200/200 - 7s - loss: 3.1931 - accuracy20: 0.4157 - val_loss: 3.1954 - val_accuracy20: 0.4201 - 7s/epoch - 33ms/step
Epoch 6/50
200/200 - 7s - loss: 3.1779 - accuracy20: 0.4163 - val_loss: 3.1814 - val_accuracy20: 0.4200 - 7s/epoch - 34ms/step
Epoch 7/50
200/200 - 7s - loss: 3.1553 - accuracy20: 0.4268 - val_loss: 3.1578 - val_accuracy20: 0.4321 - 7s/epoch - 33ms/step
Epoch 8/50
200/200 - 7s - loss: 3.1356 - accuracy20: 0.4323 - val_loss: 3.1429 - val_accuracy20: 0.4381 - 7s/epoch - 33ms/step
Epoch 9/50
200/200 - 6s - loss: 3.1161 - accuracy20: 0.4388 - val_loss: 3.1473 - val_accuracy20: 0.4384 - 6s/epoch - 32ms/step
Epoch 10/50
200/200 - 7s - loss: 3.1136 - accuracy20: 0.4409 - val_loss: 3.1432 - val_accuracy20: 0.4391 - 7s/epoch - 33ms/step
Epoch 11/50
200/200 - 7s - loss: 3.0995 - accuracy20: 0.4439 - val_loss: 3.1481 - val_accuracy20: 0.4384 - 7s/epoch - 35ms/step
Epoch 12/50
200/200 - 7s - loss: 3.0929 - accuracy20: 0.4478 - val_loss: 3.1442 - val_accuracy20: 0.4422 - 7s/epoch - 33ms/step
Epoch 13/50
200/200 - 6s - loss: 3.0783 - accuracy20: 0.4535 - val_loss: 3.1454 - val_accuracy20: 0.4438 - 6s/epoch - 32ms/step
Epoch 14/50
200/200 - 7s - loss: 3.0628 - accuracy20: 0.4580 - val_loss: 3.1643 - val_accuracy20: 0.4326 - 7s/epoch - 34ms/step
Epoch 15/50
200/200 - 6s - loss: 3.0493 - accuracy20: 0.4654 - val_loss: 3.1529 - val_accuracy20: 0.4400 - 6s/epoch - 32ms/step
Epoch 16/50
200/200 - 7s - loss: 3.0369 - accuracy20: 0.4687 - val_loss: 3.1351 - val_accuracy20: 0.4426 - 7s/epoch - 34ms/step
Epoch 17/50
200/200 - 7s - loss: 3.0288 - accuracy20: 0.4701 - val_loss: 3.1811 - val_accuracy20: 0.4275 - 7s/epoch - 33ms/step
Epoch 18/50
200/200 - 6s - loss: 3.0151 - accuracy20: 0.4771 - val_loss: 3.1695 - val_accuracy20: 0.4266 - 6s/epoch - 32ms/step
Epoch 19/50
200/200 - 7s - loss: 3.0045 - accuracy20: 0.4783 - val_loss: 3.1569 - val_accuracy20: 0.4431 - 7s/epoch - 37ms/step
Epoch 20/50
200/200 - 7s - loss: 2.9979 - accuracy20: 0.4839 - val_loss: 3.2116 - val_accuracy20: 0.4250 - 7s/epoch - 36ms/step
Epoch 21/50
200/200 - 7s - loss: 2.9869 - accuracy20: 0.4859 - val_loss: 3.1874 - val_accuracy20: 0.4397 - 7s/epoch - 33ms/step
Epoch 22/50
200/200 - 6s - loss: 2.9710 - accuracy20: 0.4900 - val_loss: 3.2036 - val_accuracy20: 0.4272 - 6s/epoch - 32ms/step
Epoch 23/50
200/200 - 7s - loss: 2.9677 - accuracy20: 0.4935 - val_loss: 3.1945 - val_accuracy20: 0.4286 - 7s/epoch - 33ms/step
Epoch 24/50
200/200 - 7s - loss: 2.9536 - accuracy20: 0.4976 - val_loss: 3.2016 - val_accuracy20: 0.4326 - 7s/epoch - 33ms/step
Epoch 25/50
200/200 - 7s - loss: 2.9415 - accuracy20: 0.5021 - val_loss: 3.2170 - val_accuracy20: 0.4270 - 7s/epoch - 33ms/step
Epoch 26/50
200/200 - 7s - loss: 2.9340 - accuracy20: 0.5065 - val_loss: 3.1998 - val_accuracy20: 0.4352 - 7s/epoch - 33ms/step
testing model: results/LILAK/W9/deepVOL_L3/h20
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0719026
{'0': {'precision': 0.36252898685929047, 'recall': 0.5632350505217824, 'f1-score': 0.44112543582258984, 'support': 24148}, '1': {'precision': 0.5289606787404144, 'recall': 0.3947720907578033, 'f1-score': 0.45211974711788766, 'support': 24637}, '2': {'precision': 0.3991782229070365, 'recall': 0.2923013276166836, 'f1-score': 0.3374801884539395, 'support': 26589}, 'accuracy': 0.4125958553347308, 'macro avg': {'precision': 0.4302226295022471, 'recall': 0.41676948963208976, 'f1-score': 0.4102417904648057, 'support': 75374}, 'weighted avg': {'precision': 0.4298578287696146, 'recall': 0.4125958553347308, 'f1-score': 0.4081570828772401, 'support': 75374}}
[[13601  3997  6550]
 [ 9763  9726  5148]
 [14153  4664  7772]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0260817
{'0': {'precision': 0.41625438301551465, 'recall': 0.5161405598570578, 'f1-score': 0.46084713765322133, 'support': 16790}, '1': {'precision': 0.5780474681652418, 'recall': 0.5419235511713933, 'f1-score': 0.559402933263907, 'support': 17842}, '2': {'precision': 0.40094235441360526, 'recall': 0.33012062799296843, 'f1-score': 0.36210106382978724, 'support': 16497}, 'accuracy': 0.46511764360734614, 'macro avg': {'precision': 0.46508140186478725, 'recall': 0.4627282463404732, 'f1-score': 0.4607837115823052, 'support': 51129}, 'weighted avg': {'precision': 0.46777328010710123, 'recall': 0.46511764360734614, 'f1-score': 0.463378353312058, 'support': 51129}}
[[8666 3439 4685]
 [4721 9669 3452]
 [7432 3619 5446]]
Evaluating performance on  val set...
53/53 - 1s - 836ms/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0476645
{'0': {'precision': 0.38737392603660814, 'recall': 0.4928707224334601, 'f1-score': 0.43380046015477935, 'support': 4208}, '1': {'precision': 0.5669045495093666, 'recall': 0.5099297893681043, 'f1-score': 0.5369099165698595, 'support': 4985}, '2': {'precision': 0.3816584294343767, 'recall': 0.324236062514579, 'f1-score': 0.350611678648001, 'support': 4287}, 'accuracy': 0.44554896142433237, 'macro avg': {'precision': 0.4453123016601172, 'recall': 0.4423455247720478, 'f1-score': 0.4404406851242133, 'support': 13480}, 'weighted avg': {'precision': 0.45194794859431847, 'recall': 0.44554896142433237, 'f1-score': 0.44547481726973603, 'support': 13480}}
[[2074  965 1169]
 [1360 2542 1083]
 [1920  977 1390]]
training model: results/LILAK/W9/deepVOL_L3/h30
Epoch 1/50
200/200 - 9s - loss: 3.3436 - accuracy30: 0.3543 - val_loss: 3.3719 - val_accuracy30: 0.3464 - 9s/epoch - 45ms/step
Epoch 2/50
200/200 - 7s - loss: 3.2958 - accuracy30: 0.3674 - val_loss: 3.3443 - val_accuracy30: 0.3567 - 7s/epoch - 33ms/step
Epoch 3/50
200/200 - 7s - loss: 3.2760 - accuracy30: 0.3782 - val_loss: 3.3084 - val_accuracy30: 0.3691 - 7s/epoch - 33ms/step
Epoch 4/50
200/200 - 7s - loss: 3.2385 - accuracy30: 0.3924 - val_loss: 3.2482 - val_accuracy30: 0.4086 - 7s/epoch - 34ms/step
Epoch 5/50
200/200 - 7s - loss: 3.2009 - accuracy30: 0.4079 - val_loss: 3.2040 - val_accuracy30: 0.4152 - 7s/epoch - 33ms/step
Epoch 6/50
200/200 - 7s - loss: 3.1769 - accuracy30: 0.4177 - val_loss: 3.1940 - val_accuracy30: 0.4195 - 7s/epoch - 33ms/step
Epoch 7/50
200/200 - 6s - loss: 3.1556 - accuracy30: 0.4249 - val_loss: 3.2042 - val_accuracy30: 0.4197 - 6s/epoch - 32ms/step
Epoch 8/50
200/200 - 7s - loss: 3.1414 - accuracy30: 0.4293 - val_loss: 3.1986 - val_accuracy30: 0.4169 - 7s/epoch - 33ms/step
Epoch 9/50
200/200 - 6s - loss: 3.1266 - accuracy30: 0.4374 - val_loss: 3.2256 - val_accuracy30: 0.4046 - 6s/epoch - 32ms/step
Epoch 10/50
200/200 - 6s - loss: 3.1076 - accuracy30: 0.4443 - val_loss: 3.2145 - val_accuracy30: 0.4084 - 6s/epoch - 32ms/step
Epoch 11/50
200/200 - 7s - loss: 3.1022 - accuracy30: 0.4442 - val_loss: 3.1993 - val_accuracy30: 0.4167 - 7s/epoch - 33ms/step
Epoch 12/50
200/200 - 6s - loss: 3.0871 - accuracy30: 0.4509 - val_loss: 3.2097 - val_accuracy30: 0.4118 - 6s/epoch - 32ms/step
Epoch 13/50
200/200 - 6s - loss: 3.0779 - accuracy30: 0.4540 - val_loss: 3.2179 - val_accuracy30: 0.4137 - 6s/epoch - 32ms/step
Epoch 14/50
200/200 - 7s - loss: 3.0655 - accuracy30: 0.4574 - val_loss: 3.2309 - val_accuracy30: 0.4082 - 7s/epoch - 33ms/step
Epoch 15/50
200/200 - 7s - loss: 3.0592 - accuracy30: 0.4599 - val_loss: 3.2241 - val_accuracy30: 0.4119 - 7s/epoch - 33ms/step
Epoch 16/50
200/200 - 7s - loss: 3.0479 - accuracy30: 0.4640 - val_loss: 3.2317 - val_accuracy30: 0.4122 - 7s/epoch - 33ms/step
testing model: results/LILAK/W9/deepVOL_L3/h30
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0786595
{'0': {'precision': 0.36490753270184934, 'recall': 0.5775133848899464, 'f1-score': 0.4472290044686046, 'support': 25215}, '1': {'precision': 0.4555619930475087, 'recall': 0.34846000443164193, 'f1-score': 0.3948775894538606, 'support': 22565}, '2': {'precision': 0.37077108963093147, 'recall': 0.24465463506559396, 'f1-score': 0.2947906204969215, 'support': 27594}, 'accuracy': 0.38708307904582484, 'macro avg': {'precision': 0.3970802051267632, 'recall': 0.3902093414623941, 'f1-score': 0.37896573813979556, 'support': 75374}, 'weighted avg': {'precision': 0.3941937174286901, 'recall': 0.38708307904582484, 'f1-score': 0.37574952285528535, 'support': 75374}}
[[14562  4253  6400]
 [ 9645  7863  5057]
 [15699  5144  6751]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0572014
{'0': {'precision': 0.40138454076458396, 'recall': 0.5197259491864117, 'f1-score': 0.45295317709110816, 'support': 17515}, '1': {'precision': 0.4901797405070825, 'recall': 0.5003037298019681, 'f1-score': 0.49518999518999524, 'support': 16462}, '2': {'precision': 0.37774725274725274, 'recall': 0.25652985074626866, 'f1-score': 0.3055555555555556, 'support': 17152}, 'accuracy': 0.42517944806274327, 'macro avg': {'precision': 0.4231038446729731, 'recall': 0.4255198432448828, 'f1-score': 0.417899575945553, 'support': 51129}, 'weighted avg': {'precision': 0.42204443659841107, 'recall': 0.42517944806274327, 'f1-score': 0.4171053900224403, 'support': 51129}}
[[9103 4148 4264]
 [5242 8236 2984]
 [8334 4418 4400]]
Evaluating performance on  val set...
53/53 - 1s - 840ms/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0622789
{'0': {'precision': 0.3871187595842563, 'recall': 0.5137946630483944, 'f1-score': 0.44155086969196383, 'support': 4422}, '1': {'precision': 0.5139101861993428, 'recall': 0.4987244897959184, 'f1-score': 0.5062034739454094, 'support': 4704}, '2': {'precision': 0.35915955351280365, 'recall': 0.25126320624712906, 'f1-score': 0.29567567567567565, 'support': 4354}, 'accuracy': 0.42373887240356084, 'macro avg': {'precision': 0.42006283309880094, 'recall': 0.421260786363814, 'f1-score': 0.41447667310434966, 'support': 13480}, 'weighted avg': {'precision': 0.4223333358129107, 'recall': 0.42373887240356084, 'f1-score': 0.41699487975585775, 'support': 13480}}
[[2272 1106 1044]
 [1450 2346  908]
 [2147 1113 1094]]
training model: results/LILAK/W9/deepVOL_L3/h50
Epoch 1/50
200/200 - 8s - loss: 3.3534 - accuracy50: 0.3488 - val_loss: 3.4117 - val_accuracy50: 0.3251 - 8s/epoch - 42ms/step
Epoch 2/50
200/200 - 7s - loss: 3.3268 - accuracy50: 0.3563 - val_loss: 3.3398 - val_accuracy50: 0.3473 - 7s/epoch - 33ms/step
Epoch 3/50
200/200 - 6s - loss: 3.3062 - accuracy50: 0.3582 - val_loss: 3.3615 - val_accuracy50: 0.3282 - 6s/epoch - 32ms/step
Epoch 4/50
200/200 - 6s - loss: 3.3001 - accuracy50: 0.3618 - val_loss: 3.3296 - val_accuracy50: 0.3553 - 6s/epoch - 32ms/step
Epoch 5/50
200/200 - 6s - loss: 3.2747 - accuracy50: 0.3721 - val_loss: 3.3291 - val_accuracy50: 0.3575 - 6s/epoch - 32ms/step
Epoch 6/50
200/200 - 6s - loss: 3.2499 - accuracy50: 0.3861 - val_loss: 3.3012 - val_accuracy50: 0.3664 - 6s/epoch - 32ms/step
Epoch 7/50
200/200 - 6s - loss: 3.2259 - accuracy50: 0.3943 - val_loss: 3.3079 - val_accuracy50: 0.3620 - 6s/epoch - 32ms/step
Epoch 8/50
200/200 - 6s - loss: 3.2082 - accuracy50: 0.4056 - val_loss: 3.3072 - val_accuracy50: 0.3684 - 6s/epoch - 32ms/step
Epoch 9/50
200/200 - 6s - loss: 3.1914 - accuracy50: 0.4137 - val_loss: 3.2936 - val_accuracy50: 0.3769 - 6s/epoch - 32ms/step
Epoch 10/50
200/200 - 7s - loss: 3.1740 - accuracy50: 0.4190 - val_loss: 3.3092 - val_accuracy50: 0.3751 - 7s/epoch - 33ms/step
Epoch 11/50
200/200 - 7s - loss: 3.1643 - accuracy50: 0.4219 - val_loss: 3.3113 - val_accuracy50: 0.3705 - 7s/epoch - 33ms/step
Epoch 12/50
200/200 - 7s - loss: 3.1538 - accuracy50: 0.4273 - val_loss: 3.3056 - val_accuracy50: 0.3730 - 7s/epoch - 33ms/step
Epoch 13/50
200/200 - 7s - loss: 3.1443 - accuracy50: 0.4306 - val_loss: 3.2973 - val_accuracy50: 0.3749 - 7s/epoch - 33ms/step
Epoch 14/50
200/200 - 7s - loss: 3.1332 - accuracy50: 0.4389 - val_loss: 3.3101 - val_accuracy50: 0.3737 - 7s/epoch - 33ms/step
Epoch 15/50
200/200 - 7s - loss: 3.1224 - accuracy50: 0.4402 - val_loss: 3.3034 - val_accuracy50: 0.3717 - 7s/epoch - 33ms/step
Epoch 16/50
200/200 - 7s - loss: 3.1088 - accuracy50: 0.4486 - val_loss: 3.3135 - val_accuracy50: 0.3694 - 7s/epoch - 34ms/step
Epoch 17/50
200/200 - 7s - loss: 3.0937 - accuracy50: 0.4504 - val_loss: 3.3135 - val_accuracy50: 0.3778 - 7s/epoch - 33ms/step
Epoch 18/50
200/200 - 7s - loss: 3.0900 - accuracy50: 0.4538 - val_loss: 3.3176 - val_accuracy50: 0.3738 - 7s/epoch - 33ms/step
Epoch 19/50
200/200 - 7s - loss: 3.0769 - accuracy50: 0.4593 - val_loss: 3.3253 - val_accuracy50: 0.3743 - 7s/epoch - 33ms/step
testing model: results/LILAK/W9/deepVOL_L3/h50
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0970669
{'0': {'precision': 0.3358519257728039, 'recall': 0.5753653274718118, 'f1-score': 0.42413058481111415, 'support': 24567}, '1': {'precision': 0.4197942980873331, 'recall': 0.19768874537961506, 'f1-score': 0.268796395251437, 'support': 23537}, '2': {'precision': 0.3763004999324416, 'recall': 0.3063806380638064, 'f1-score': 0.3377599902977382, 'support': 27270}, 'accuracy': 0.36011091357762626, 'macro avg': {'precision': 0.37731557459752624, 'recall': 0.3598115703050777, 'f1-score': 0.34356232345342974, 'support': 75374}, 'weighted avg': {'precision': 0.37669869302013576, 'recall': 0.36011091357762626, 'f1-score': 0.34437593556806106, 'support': 75374}}
[[14135  3131  7301]
 [12337  4653  6547]
 [15615  3300  8355]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0689846
{'0': {'precision': 0.38074398249452956, 'recall': 0.5413689790274256, 'f1-score': 0.44706666032259595, 'support': 17356}, '1': {'precision': 0.5103008361348159, 'recall': 0.3528009535160906, 'f1-score': 0.4171805080863958, 'support': 16780}, '2': {'precision': 0.38026936026936026, 'recall': 0.33231330547872656, 'f1-score': 0.354677637157303, 'support': 16993}, 'accuracy': 0.41000215142091573, 'macro avg': {'precision': 0.4237713929662352, 'recall': 0.4088277460074143, 'f1-score': 0.4063082685220982, 'support': 51129}, 'weighted avg': {'precision': 0.42310543584999716, 'recall': 0.41000215142091573, 'f1-score': 0.40655234740485335, 'support': 51129}}
[[9396 2919 5041]
 [6698 5920 4162]
 [8584 2762 5647]]
Evaluating performance on  val set...
53/53 - 1s - 843ms/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0962683
{'0': {'precision': 0.34441489361702127, 'recall': 0.5329218106995884, 'f1-score': 0.41841680129240705, 'support': 4374}, '1': {'precision': 0.4773286467486819, 'recall': 0.2802889576883385, 'f1-score': 0.353185955786736, 'support': 4845}, '2': {'precision': 0.35712438582880784, 'recall': 0.32410232339826334, 'f1-score': 0.33981299212598426, 'support': 4261}, 'accuracy': 0.37611275964391694, 'macro avg': {'precision': 0.39295597539817034, 'recall': 0.3791043639287301, 'f1-score': 0.3704719164017091, 'support': 13480}, 'weighted avg': {'precision': 0.3962043802815107, 'recall': 0.37611275964391694, 'f1-score': 0.3701249409561234, 'support': 13480}}
[[2331  750 1293]
 [2294 1358 1193]
 [2143  737 1381]]
training model: results/LILAK/W9/deepVOL_L3/h100
Epoch 1/50
200/200 - 9s - loss: 3.3631 - accuracy100: 0.3437 - val_loss: 3.3480 - val_accuracy100: 0.3290 - 9s/epoch - 43ms/step
Epoch 2/50
200/200 - 7s - loss: 3.3254 - accuracy100: 0.3473 - val_loss: 3.3242 - val_accuracy100: 0.3448 - 7s/epoch - 35ms/step
Epoch 3/50
200/200 - 7s - loss: 3.3063 - accuracy100: 0.3514 - val_loss: 3.3263 - val_accuracy100: 0.3410 - 7s/epoch - 35ms/step
Epoch 4/50
200/200 - 7s - loss: 3.2922 - accuracy100: 0.3579 - val_loss: 3.3308 - val_accuracy100: 0.3376 - 7s/epoch - 35ms/step
Epoch 5/50
200/200 - 7s - loss: 3.2781 - accuracy100: 0.3683 - val_loss: 3.3559 - val_accuracy100: 0.3207 - 7s/epoch - 35ms/step
Epoch 6/50
200/200 - 7s - loss: 3.2697 - accuracy100: 0.3698 - val_loss: 3.3571 - val_accuracy100: 0.3318 - 7s/epoch - 35ms/step
Epoch 7/50
200/200 - 7s - loss: 3.2660 - accuracy100: 0.3749 - val_loss: 3.3415 - val_accuracy100: 0.3344 - 7s/epoch - 35ms/step
Epoch 8/50
200/200 - 7s - loss: 3.2446 - accuracy100: 0.3856 - val_loss: 3.3357 - val_accuracy100: 0.3419 - 7s/epoch - 35ms/step
Epoch 9/50
200/200 - 7s - loss: 3.2373 - accuracy100: 0.3889 - val_loss: 3.3289 - val_accuracy100: 0.3381 - 7s/epoch - 35ms/step
Epoch 10/50
200/200 - 7s - loss: 3.2185 - accuracy100: 0.3972 - val_loss: 3.3332 - val_accuracy100: 0.3421 - 7s/epoch - 35ms/step
Epoch 11/50
200/200 - 7s - loss: 3.2024 - accuracy100: 0.4059 - val_loss: 3.3478 - val_accuracy100: 0.3401 - 7s/epoch - 35ms/step
Epoch 12/50
200/200 - 7s - loss: 3.1842 - accuracy100: 0.4145 - val_loss: 3.3573 - val_accuracy100: 0.3381 - 7s/epoch - 35ms/step
testing model: results/LILAK/W9/deepVOL_L3/h100
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1081525
{'0': {'precision': 0.3097513640191878, 'recall': 0.3609404335210787, 'f1-score': 0.3333924524583703, 'support': 23436}, '1': {'precision': 0.3794425251999432, 'recall': 0.28904109589041094, 'f1-score': 0.3281291563503918, 'support': 27740}, '2': {'precision': 0.3240885126605777, 'recall': 0.3607322919249525, 'f1-score': 0.3414300242509583, 'support': 24198}, 'accuracy': 0.3344123968477194, 'macro avg': {'precision': 0.33776080062656955, 'recall': 0.33690460711214737, 'f1-score': 0.3343172110199068, 'support': 75374}, 'weighted avg': {'precision': 0.34000268588055255, 'recall': 0.3344123968477194, 'f1-score': 0.33403576883008623, 'support': 75374}}
[[8459 6664 8313]
 [9830 8018 9892]
 [9020 6449 8729]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1001166
{'0': {'precision': 0.35008008542445274, 'recall': 0.37312923234507483, 'f1-score': 0.36123736330330825, 'support': 17573}, '1': {'precision': 0.35830684968557713, 'recall': 0.3226768968456948, 'f1-score': 0.33955977059370096, 'support': 16422}, '2': {'precision': 0.34997160704145375, 'recall': 0.35969417532391734, 'f1-score': 0.3547662905825466, 'support': 17134}, 'accuracy': 0.3524223043673845, 'macro avg': {'precision': 0.3527861807171612, 'recall': 0.351833434838229, 'f1-score': 0.3518544748265186, 'support': 51129}, 'weighted avg': {'precision': 0.352686067432352, 'recall': 0.3524223043673845, 'f1-score': 0.3521062481343298, 'support': 51129}}
[[6557 4927 6089]
 [5765 5299 5358]
 [6408 4563 6163]]
Evaluating performance on  val set...
53/53 - 1s - 844ms/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1048646
{'0': {'precision': 0.32457747912848706, 'recall': 0.3597382080794403, 'f1-score': 0.34125454934703486, 'support': 4431}, '1': {'precision': 0.38778024143877804, 'recall': 0.32346896835182903, 'f1-score': 0.3527170868347339, 'support': 4866}, '2': {'precision': 0.3155210643015521, 'recall': 0.34018646904135785, 'f1-score': 0.3273898539054411, 'support': 4183}, 'accuracy': 0.3405786350148368, 'macro avg': {'precision': 0.342626261622939, 'recall': 0.34113121515754236, 'f1-score': 0.34045383002907, 'support': 13480}, 'weighted avg': {'precision': 0.34458205317750834, 'recall': 0.3405786350148368, 'f1-score': 0.34108991183835213, 'support': 13480}}
[[1594 1260 1577]
 [1782 1574 1510]
 [1535 1225 1423]]
training model: results/LILAK/W9/deepVOL_L3/h200
Epoch 1/50
200/200 - 9s - loss: 3.3659 - accuracy200: 0.3416 - val_loss: 3.3476 - val_accuracy200: 0.3468 - 9s/epoch - 44ms/step
Epoch 2/50
200/200 - 7s - loss: 3.3324 - accuracy200: 0.3515 - val_loss: 3.3178 - val_accuracy200: 0.3617 - 7s/epoch - 33ms/step
Epoch 3/50
200/200 - 7s - loss: 3.3071 - accuracy200: 0.3546 - val_loss: 3.3138 - val_accuracy200: 0.3496 - 7s/epoch - 36ms/step
Epoch 4/50
200/200 - 7s - loss: 3.2950 - accuracy200: 0.3612 - val_loss: 3.3235 - val_accuracy200: 0.3407 - 7s/epoch - 34ms/step
Epoch 5/50
200/200 - 7s - loss: 3.3051 - accuracy200: 0.3563 - val_loss: 3.3318 - val_accuracy200: 0.3252 - 7s/epoch - 34ms/step
Epoch 6/50
200/200 - 7s - loss: 3.2869 - accuracy200: 0.3668 - val_loss: 3.3050 - val_accuracy200: 0.3510 - 7s/epoch - 33ms/step
Epoch 7/50
200/200 - 7s - loss: 3.2665 - accuracy200: 0.3797 - val_loss: 3.3235 - val_accuracy200: 0.3458 - 7s/epoch - 33ms/step
Epoch 8/50
200/200 - 7s - loss: 3.2581 - accuracy200: 0.3881 - val_loss: 3.3129 - val_accuracy200: 0.3599 - 7s/epoch - 33ms/step
Epoch 9/50
200/200 - 7s - loss: 3.2430 - accuracy200: 0.3951 - val_loss: 3.3101 - val_accuracy200: 0.3534 - 7s/epoch - 34ms/step
Epoch 10/50
200/200 - 7s - loss: 3.2206 - accuracy200: 0.4060 - val_loss: 3.3263 - val_accuracy200: 0.3522 - 7s/epoch - 34ms/step
Epoch 11/50
200/200 - 7s - loss: 3.2034 - accuracy200: 0.4161 - val_loss: 3.3414 - val_accuracy200: 0.3514 - 7s/epoch - 33ms/step
Epoch 12/50
200/200 - 6s - loss: 3.1863 - accuracy200: 0.4229 - val_loss: 3.3558 - val_accuracy200: 0.3425 - 6s/epoch - 32ms/step
Epoch 13/50
200/200 - 7s - loss: 3.1675 - accuracy200: 0.4292 - val_loss: 3.3704 - val_accuracy200: 0.3405 - 7s/epoch - 33ms/step
Epoch 14/50
200/200 - 7s - loss: 3.1433 - accuracy200: 0.4411 - val_loss: 3.3781 - val_accuracy200: 0.3481 - 7s/epoch - 33ms/step
Epoch 15/50
200/200 - 7s - loss: 3.1208 - accuracy200: 0.4513 - val_loss: 3.4246 - val_accuracy200: 0.3371 - 7s/epoch - 35ms/step
Epoch 16/50
200/200 - 7s - loss: 3.0957 - accuracy200: 0.4609 - val_loss: 3.4606 - val_accuracy200: 0.3397 - 7s/epoch - 36ms/step
testing model: results/LILAK/W9/deepVOL_L3/h200
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1057788
{'0': {'precision': 0.3767752715121136, 'recall': 0.27434071635595947, 'f1-score': 0.31750041411297003, 'support': 27947}, '1': {'precision': 0.30884692136391245, 'recall': 0.4929603471356691, 'f1-score': 0.3797652916073969, 'support': 21663}, '2': {'precision': 0.3419894366197183, 'recall': 0.2714252445272473, 'f1-score': 0.3026486626850169, 'support': 25764}, 'accuracy': 0.3361769310372277, 'macro avg': {'precision': 0.34253720983191477, 'recall': 0.3462421026729587, 'f1-score': 0.33330478946846126, 'support': 75374}, 'weighted avg': {'precision': 0.34536186504001243, 'recall': 0.3361769310372277, 'f1-score': 0.3303192046424893, 'support': 75374}}
[[ 7667 12497  7783]
 [ 5312 10679  5672]
 [ 7370 11401  6993]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0893886
{'0': {'precision': 0.3690947666195191, 'recall': 0.3055978451809345, 'f1-score': 0.33435838298417575, 'support': 17078}, '1': {'precision': 0.37120007270413957, 'recall': 0.485123819704258, 'f1-score': 0.42058384389641146, 'support': 16839}, '2': {'precision': 0.3881991723401415, 'recall': 0.33790378805484544, 'f1-score': 0.3613095607877244, 'support': 17212}, 'accuracy': 0.37559897514130924, 'macro avg': {'precision': 0.37616467055460007, 'recall': 0.37620848431334597, 'f1-score': 0.3720839292227705, 'support': 51129}, 'weighted avg': {'precision': 0.3762194176086305, 'recall': 0.37559897514130924, 'f1-score': 0.3718289810529003, 'support': 51129}}
[[5219 7068 4791]
 [4295 8169 4375]
 [4626 6770 5816]]
Evaluating performance on  val set...
53/53 - 1s - 829ms/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1008835
{'0': {'precision': 0.34402852049910876, 'recall': 0.3073947667804323, 'f1-score': 0.3246815669310262, 'support': 4395}, '1': {'precision': 0.3932642487046632, 'recall': 0.4597213809812235, 'f1-score': 0.4239039374476403, 'support': 4953}, '2': {'precision': 0.31570555407919215, 'recall': 0.28751210067763794, 'f1-score': 0.30094996833438886, 'support': 4132}, 'accuracy': 0.3572700296735905, 'macro avg': {'precision': 0.35099944109432135, 'recall': 0.35154274947976455, 'f1-score': 0.3498451575710184, 'support': 13480}, 'weighted avg': {'precision': 0.3534375757331603, 'recall': 0.3572700296735905, 'f1-score': 0.3538647594953796, 'support': 13480}}
[[1351 1822 1222]
 [1323 2277 1353]
 [1253 1691 1188]]
training model: results/LILAK/W9/deepVOL_L3/h300
Epoch 1/50
200/200 - 9s - loss: 3.3571 - accuracy300: 0.3449 - val_loss: 3.3129 - val_accuracy300: 0.3620 - 9s/epoch - 44ms/step
Epoch 2/50
200/200 - 7s - loss: 3.3214 - accuracy300: 0.3486 - val_loss: 3.3186 - val_accuracy300: 0.3565 - 7s/epoch - 33ms/step
Epoch 3/50
200/200 - 7s - loss: 3.3183 - accuracy300: 0.3469 - val_loss: 3.3236 - val_accuracy300: 0.3215 - 7s/epoch - 33ms/step
Epoch 4/50
200/200 - 7s - loss: 3.2993 - accuracy300: 0.3516 - val_loss: 3.3013 - val_accuracy300: 0.3599 - 7s/epoch - 33ms/step
Epoch 5/50
200/200 - 7s - loss: 3.2914 - accuracy300: 0.3589 - val_loss: 3.3350 - val_accuracy300: 0.3445 - 7s/epoch - 33ms/step
Epoch 6/50
200/200 - 7s - loss: 3.2758 - accuracy300: 0.3695 - val_loss: 3.3098 - val_accuracy300: 0.3605 - 7s/epoch - 34ms/step
Epoch 7/50
200/200 - 7s - loss: 3.2784 - accuracy300: 0.3697 - val_loss: 3.2987 - val_accuracy300: 0.3647 - 7s/epoch - 34ms/step
Epoch 8/50
200/200 - 7s - loss: 3.2603 - accuracy300: 0.3766 - val_loss: 3.3004 - val_accuracy300: 0.3566 - 7s/epoch - 34ms/step
Epoch 9/50
200/200 - 7s - loss: 3.2459 - accuracy300: 0.3894 - val_loss: 3.3213 - val_accuracy300: 0.3554 - 7s/epoch - 34ms/step
Epoch 10/50
200/200 - 7s - loss: 3.2427 - accuracy300: 0.3891 - val_loss: 3.3570 - val_accuracy300: 0.3260 - 7s/epoch - 33ms/step
Epoch 11/50
200/200 - 7s - loss: 3.2223 - accuracy300: 0.3958 - val_loss: 3.3748 - val_accuracy300: 0.3223 - 7s/epoch - 33ms/step
Epoch 12/50
200/200 - 7s - loss: 3.2000 - accuracy300: 0.4114 - val_loss: 3.4003 - val_accuracy300: 0.3165 - 7s/epoch - 33ms/step
Epoch 13/50
200/200 - 6s - loss: 3.1797 - accuracy300: 0.4209 - val_loss: 3.4130 - val_accuracy300: 0.3196 - 6s/epoch - 32ms/step
Epoch 14/50
200/200 - 7s - loss: 3.1639 - accuracy300: 0.4291 - val_loss: 3.4291 - val_accuracy300: 0.3220 - 7s/epoch - 33ms/step
Epoch 15/50
200/200 - 7s - loss: 3.1427 - accuracy300: 0.4392 - val_loss: 3.4407 - val_accuracy300: 0.3217 - 7s/epoch - 33ms/step
Epoch 16/50
200/200 - 7s - loss: 3.1327 - accuracy300: 0.4428 - val_loss: 3.4425 - val_accuracy300: 0.3262 - 7s/epoch - 33ms/step
Epoch 17/50
200/200 - 6s - loss: 3.1104 - accuracy300: 0.4537 - val_loss: 3.4499 - val_accuracy300: 0.3342 - 6s/epoch - 32ms/step
testing model: results/LILAK/W9/deepVOL_L3/h300
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1040556
{'0': {'precision': 0.36317506342877853, 'recall': 0.07569691017602176, 'f1-score': 0.12528132033008252, 'support': 26474}, '1': {'precision': 0.33450948795599145, 'recall': 0.46567395087990715, 'f1-score': 0.38934161169318326, 'support': 25855}, '2': {'precision': 0.30366476685467914, 'recall': 0.44621392926882186, 'f1-score': 0.36139031419132633, 'support': 23045}, 'accuracy': 0.32275055058773583, 'macro avg': {'precision': 0.3337831060798164, 'recall': 0.32919493010825024, 'f1-score': 0.29200441540486405, 'support': 75374}, 'weighted avg': {'precision': 0.33514731860431607, 'recall': 0.32275055058773583, 'f1-score': 0.2880484628026239, 'support': 75374}}
[[ 2004 12797 11673]
 [ 1908 12040 11907]
 [ 1606 11156 10283]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0891409
{'0': {'precision': 0.3771991555242787, 'recall': 0.09475545079552151, 'f1-score': 0.15146234634766637, 'support': 16970}, '1': {'precision': 0.35518106848332737, 'recall': 0.5873354678050516, 'f1-score': 0.4426669049959782, 'support': 16866}, '2': {'precision': 0.3672533726812816, 'recall': 0.4029954316775574, 'f1-score': 0.3842951280708043, 'support': 17293}, 'accuracy': 0.3614973889573432, 'macro avg': {'precision': 0.36654453222962924, 'recall': 0.36169545009271015, 'f1-score': 0.3261414598048163, 'support': 51129}, 'weighted avg': {'precision': 0.366572124314268, 'recall': 0.3614973889573432, 'f1-score': 0.3262718161299944, 'support': 51129}}
[[1608 9093 6269]
 [1222 9906 5738]
 [1433 8891 6969]]
Evaluating performance on  val set...
53/53 - 1s - 833ms/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0985281
{'0': {'precision': 0.3112529928172386, 'recall': 0.09298998569384835, 'f1-score': 0.14319809069212408, 'support': 4194}, '1': {'precision': 0.41153739994479716, 'recall': 0.5522222222222222, 'f1-score': 0.47161157678317256, 'support': 5400}, '2': {'precision': 0.30174663722144146, 'recall': 0.3867730313947504, 'f1-score': 0.33900981166121574, 'support': 3886}, 'accuracy': 0.361646884272997, 'macro avg': {'precision': 0.34151234332782576, 'recall': 0.3439950797702736, 'f1-score': 0.3179398263788375, 'support': 13480}, 'weighted avg': {'precision': 0.3486857896008846, 'recall': 0.361646884272997, 'f1-score': 0.33120678301983564, 'support': 13480}}
[[ 390 2248 1556]
 [ 496 2982 1922]
 [ 367 2016 1503]]
training model: results/LILAK/W9/deepVOL_L3/h500
Epoch 1/50
200/200 - 9s - loss: 3.3553 - accuracy500: 0.3498 - val_loss: 3.3700 - val_accuracy500: 0.3389 - 9s/epoch - 46ms/step
Epoch 2/50
200/200 - 7s - loss: 3.3350 - accuracy500: 0.3508 - val_loss: 3.3352 - val_accuracy500: 0.3447 - 7s/epoch - 33ms/step
Epoch 3/50
200/200 - 6s - loss: 3.3120 - accuracy500: 0.3488 - val_loss: 3.3241 - val_accuracy500: 0.3374 - 6s/epoch - 32ms/step
Epoch 4/50
200/200 - 7s - loss: 3.2984 - accuracy500: 0.3564 - val_loss: 3.3218 - val_accuracy500: 0.3450 - 7s/epoch - 33ms/step
Epoch 5/50
200/200 - 7s - loss: 3.2850 - accuracy500: 0.3636 - val_loss: 3.3133 - val_accuracy500: 0.3553 - 7s/epoch - 33ms/step
Epoch 6/50
200/200 - 6s - loss: 3.2758 - accuracy500: 0.3719 - val_loss: 3.3301 - val_accuracy500: 0.3375 - 6s/epoch - 32ms/step
Epoch 7/50
200/200 - 6s - loss: 3.2593 - accuracy500: 0.3877 - val_loss: 3.3348 - val_accuracy500: 0.3493 - 6s/epoch - 32ms/step
Epoch 8/50
200/200 - 7s - loss: 3.2400 - accuracy500: 0.3965 - val_loss: 3.3592 - val_accuracy500: 0.3389 - 7s/epoch - 33ms/step
Epoch 9/50
200/200 - 7s - loss: 3.2220 - accuracy500: 0.4064 - val_loss: 3.3816 - val_accuracy500: 0.3565 - 7s/epoch - 33ms/step
Epoch 10/50
200/200 - 7s - loss: 3.2134 - accuracy500: 0.4143 - val_loss: 3.3800 - val_accuracy500: 0.3435 - 7s/epoch - 33ms/step
Epoch 11/50
200/200 - 7s - loss: 3.1922 - accuracy500: 0.4209 - val_loss: 3.3892 - val_accuracy500: 0.3497 - 7s/epoch - 33ms/step
Epoch 12/50
200/200 - 6s - loss: 3.1579 - accuracy500: 0.4373 - val_loss: 3.4202 - val_accuracy500: 0.3442 - 6s/epoch - 32ms/step
Epoch 13/50
200/200 - 7s - loss: 3.1408 - accuracy500: 0.4460 - val_loss: 3.4294 - val_accuracy500: 0.3398 - 7s/epoch - 33ms/step
Epoch 14/50
200/200 - 7s - loss: 3.1216 - accuracy500: 0.4551 - val_loss: 3.4496 - val_accuracy500: 0.3384 - 7s/epoch - 33ms/step
Epoch 15/50
200/200 - 6s - loss: 3.1047 - accuracy500: 0.4584 - val_loss: 3.4425 - val_accuracy500: 0.3491 - 6s/epoch - 32ms/step
testing model: results/LILAK/W9/deepVOL_L3/h500
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1101782
{'0': {'precision': 0.3940238696750588, 'recall': 0.15506719692814042, 'f1-score': 0.2225502497109258, 'support': 29168}, '1': {'precision': 0.3059946518633856, 'recall': 0.4160721682698946, 'f1-score': 0.35264287107470255, 'support': 21727}, '2': {'precision': 0.34516185374941777, 'recall': 0.48437436169778175, 'f1-score': 0.40308680797538715, 'support': 24479}, 'accuracy': 0.33725157216016133, 'macro avg': {'precision': 0.34839345842928743, 'recall': 0.3518379089652723, 'f1-score': 0.32609330958700516, 'support': 75374}, 'weighted avg': {'precision': 0.3527801503124406, 'recall': 0.33725157216016133, 'f1-score': 0.31868256050943095, 'support': 75374}}
[[ 4523 11468 13177]
 [ 3369  9040  9318]
 [ 3587  9035 11857]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0875181
{'0': {'precision': 0.38589630377191875, 'recall': 0.18369062631357713, 'f1-score': 0.24890154597233524, 'support': 16653}, '1': {'precision': 0.3881932021466905, 'recall': 0.4698069046225863, 'f1-score': 0.4251184708654329, 'support': 17090}, '2': {'precision': 0.3812780318841867, 'recall': 0.49384562291498907, 'f1-score': 0.43032201478511467, 'support': 17386}, 'accuracy': 0.3847914099630347, 'macro avg': {'precision': 0.38512251260093194, 'recall': 0.3824477179503842, 'f1-score': 0.368114010540961, 'support': 51129}, 'weighted avg': {'precision': 0.3850936422331587, 'recall': 0.3847914099630347, 'f1-score': 0.3694930599311849, 'support': 51129}}
[[3059 6287 7307]
 [2435 8029 6626]
 [2433 6367 8586]]
Evaluating performance on  val set...
53/53 - 1s - 835ms/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018522
{'0': {'precision': 0.3258875149581173, 'recall': 0.1850090579710145, 'f1-score': 0.23602484472049687, 'support': 4416}, '1': {'precision': 0.38332058148431525, 'recall': 0.4273832373640435, 'f1-score': 0.4041544822022789, 'support': 4689}, '2': {'precision': 0.33907745865970407, 'recall': 0.44525714285714285, 'f1-score': 0.3849802371541502, 'support': 4375}, 'accuracy': 0.3537833827893175, 'macro avg': {'precision': 0.34942851836737887, 'recall': 0.3525498127307336, 'f1-score': 0.34171985469230864, 'support': 13480}, 'weighted avg': {'precision': 0.3501463912664099, 'recall': 0.3537833827893175, 'f1-score': 0.3428527165342438, 'support': 13480}}
[[ 817 1612 1987]
 [ 875 2004 1810]
 [ 815 1612 1948]]
training model: results/LILAK/W9/deepVOL_L3/h1000
Epoch 1/50
200/200 - 9s - loss: 3.3589 - accuracy1000: 0.3563 - val_loss: 3.3151 - val_accuracy1000: 0.3500 - 9s/epoch - 46ms/step
Epoch 2/50
200/200 - 7s - loss: 3.3208 - accuracy1000: 0.3650 - val_loss: 3.3234 - val_accuracy1000: 0.3480 - 7s/epoch - 33ms/step
Epoch 3/50
200/200 - 7s - loss: 3.3084 - accuracy1000: 0.3612 - val_loss: 3.3060 - val_accuracy1000: 0.3639 - 7s/epoch - 34ms/step
Epoch 4/50
200/200 - 7s - loss: 3.2938 - accuracy1000: 0.3664 - val_loss: 3.3169 - val_accuracy1000: 0.3501 - 7s/epoch - 33ms/step
Epoch 5/50
200/200 - 7s - loss: 3.2811 - accuracy1000: 0.3773 - val_loss: 3.3143 - val_accuracy1000: 0.3642 - 7s/epoch - 33ms/step
Epoch 6/50
200/200 - 6s - loss: 3.2611 - accuracy1000: 0.3876 - val_loss: 3.3105 - val_accuracy1000: 0.3628 - 6s/epoch - 32ms/step
Epoch 7/50
200/200 - 6s - loss: 3.2573 - accuracy1000: 0.3855 - val_loss: 3.3102 - val_accuracy1000: 0.3634 - 6s/epoch - 32ms/step
Epoch 8/50
200/200 - 6s - loss: 3.2422 - accuracy1000: 0.3942 - val_loss: 3.3273 - val_accuracy1000: 0.3628 - 6s/epoch - 32ms/step
Epoch 9/50
200/200 - 7s - loss: 3.2174 - accuracy1000: 0.4077 - val_loss: 3.3360 - val_accuracy1000: 0.3522 - 7s/epoch - 33ms/step
Epoch 10/50
200/200 - 6s - loss: 3.2100 - accuracy1000: 0.4147 - val_loss: 3.3343 - val_accuracy1000: 0.3524 - 6s/epoch - 32ms/step
Epoch 11/50
200/200 - 7s - loss: 3.1830 - accuracy1000: 0.4239 - val_loss: 3.3593 - val_accuracy1000: 0.3513 - 7s/epoch - 33ms/step
Epoch 12/50
200/200 - 6s - loss: 3.1729 - accuracy1000: 0.4282 - val_loss: 3.3431 - val_accuracy1000: 0.3637 - 6s/epoch - 32ms/step
Epoch 13/50
200/200 - 6s - loss: 3.1638 - accuracy1000: 0.4342 - val_loss: 3.3452 - val_accuracy1000: 0.3558 - 6s/epoch - 32ms/step
testing model: results/LILAK/W9/deepVOL_L3/h1000
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1121302
{'0': {'precision': 0.3843466107617051, 'recall': 0.1299972987574284, 'f1-score': 0.19428254232583955, 'support': 29616}, '1': {'precision': 0.3132803632236095, 'recall': 0.32411273486430064, 'f1-score': 0.31860450202013724, 'support': 22992}, '2': {'precision': 0.32210728891027185, 'recall': 0.5881577791443381, 'f1-score': 0.4162521760756031, 'support': 22766}, 'accuracy': 0.3275930692281158, 'macro avg': {'precision': 0.3399114209651955, 'recall': 0.3474226042553557, 'f1-score': 0.30971307347385996, 'support': 75374}, 'weighted avg': {'precision': 0.34386984735966164, 'recall': 0.3275930692281158, 'f1-score': 0.29924939003510814, 'support': 75374}}
[[ 3850 10032 15734]
 [ 3094  7452 12446]
 [ 3073  6303 13390]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0884715
{'0': {'precision': 0.3448960523242233, 'recall': 0.17991835739962225, 'f1-score': 0.23647647647647646, 'support': 16413}, '1': {'precision': 0.3968552277140888, 'recall': 0.3855282375851996, 'f1-score': 0.3911097391572773, 'support': 16432}, '2': {'precision': 0.3940384904525635, 'recall': 0.5733428133887551, 'f1-score': 0.4670736054179291, 'support': 18284}, 'accuracy': 0.3866885720432631, 'macro avg': {'precision': 0.37859659016362524, 'recall': 0.379596469457859, 'f1-score': 0.3648866070172276, 'support': 51129}, 'weighted avg': {'precision': 0.37916845172074665, 'recall': 0.3866885720432631, 'f1-score': 0.36863575355868894, 'support': 51129}}
[[ 2953  4682  8778]
 [ 2754  6335  7343]
 [ 2855  4946 10483]]
Evaluating performance on  val set...
53/53 - 1s - 824ms/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1008203
{'0': {'precision': 0.3142985611510791, 'recall': 0.16366190587684384, 'f1-score': 0.21524249422632796, 'support': 4271}, '1': {'precision': 0.3655841226883175, 'recall': 0.35408475316732196, 'f1-score': 0.35974256546826444, 'support': 4578}, '2': {'precision': 0.36909997068308414, 'recall': 0.5437270567911898, 'f1-score': 0.4397101196193137, 'support': 4631}, 'accuracy': 0.3589020771513353, 'macro avg': {'precision': 0.3496608848408269, 'recall': 0.35382457194511857, 'f1-score': 0.33823172643796867, 'support': 13480}, 'weighted avg': {'precision': 0.35054267303981745, 'recall': 0.3589020771513353, 'f1-score': 0.3414317300824483, 'support': 13480}}
[[ 699 1413 2159]
 [ 812 1621 2145]
 [ 713 1400 2518]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        13 (peak)   8.57 (ave)

============================================
