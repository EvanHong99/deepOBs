This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/PCAR_orderbooks/PCAR_orderbooks_2019-06-26.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-06-18.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-06-05.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-06-06.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-06-14.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-06-10.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-06-12.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-06-07.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-06-28.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-06-11.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-06-24.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-06-13.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-06-04.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-06-20.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-06-19.csv
training model: results/PCAR/W4/deepLOB_L1/h10
Epoch 1/50
538/538 - 18s - loss: 3.2478 - accuracy10: 0.4095 - val_loss: 3.3403 - val_accuracy10: 0.3549 - 18s/epoch - 34ms/step
Epoch 2/50
538/538 - 9s - loss: 3.1845 - accuracy10: 0.4363 - val_loss: 3.2741 - val_accuracy10: 0.3784 - 9s/epoch - 17ms/step
Epoch 3/50
538/538 - 9s - loss: 3.1648 - accuracy10: 0.4425 - val_loss: 3.2217 - val_accuracy10: 0.3966 - 9s/epoch - 17ms/step
Epoch 4/50
538/538 - 9s - loss: 3.1501 - accuracy10: 0.4483 - val_loss: 3.2007 - val_accuracy10: 0.4085 - 9s/epoch - 17ms/step
Epoch 5/50
538/538 - 14s - loss: 3.1329 - accuracy10: 0.4561 - val_loss: 3.1903 - val_accuracy10: 0.4175 - 14s/epoch - 26ms/step
Epoch 6/50
538/538 - 9s - loss: 3.1265 - accuracy10: 0.4580 - val_loss: 3.1743 - val_accuracy10: 0.4267 - 9s/epoch - 17ms/step
Epoch 7/50
538/538 - 9s - loss: 3.1144 - accuracy10: 0.4627 - val_loss: 3.1779 - val_accuracy10: 0.4235 - 9s/epoch - 16ms/step
Epoch 8/50
538/538 - 9s - loss: 3.1069 - accuracy10: 0.4652 - val_loss: 3.1997 - val_accuracy10: 0.4151 - 9s/epoch - 17ms/step
Epoch 9/50
538/538 - 9s - loss: 3.0997 - accuracy10: 0.4686 - val_loss: 3.2097 - val_accuracy10: 0.4114 - 9s/epoch - 16ms/step
Epoch 10/50
538/538 - 9s - loss: 3.0927 - accuracy10: 0.4701 - val_loss: 3.2420 - val_accuracy10: 0.4032 - 9s/epoch - 16ms/step
Epoch 11/50
538/538 - 9s - loss: 3.0866 - accuracy10: 0.4720 - val_loss: 3.2648 - val_accuracy10: 0.3969 - 9s/epoch - 16ms/step
Epoch 12/50
538/538 - 9s - loss: 3.0806 - accuracy10: 0.4740 - val_loss: 3.2564 - val_accuracy10: 0.3950 - 9s/epoch - 16ms/step
Epoch 13/50
538/538 - 9s - loss: 3.0773 - accuracy10: 0.4756 - val_loss: 3.2510 - val_accuracy10: 0.4017 - 9s/epoch - 16ms/step
Epoch 14/50
538/538 - 9s - loss: 3.0726 - accuracy10: 0.4767 - val_loss: 3.2350 - val_accuracy10: 0.4059 - 9s/epoch - 16ms/step
Epoch 15/50
538/538 - 9s - loss: 3.0674 - accuracy10: 0.4784 - val_loss: 3.3333 - val_accuracy10: 0.4021 - 9s/epoch - 17ms/step
Epoch 16/50
538/538 - 9s - loss: 3.0637 - accuracy10: 0.4794 - val_loss: 3.2763 - val_accuracy10: 0.4046 - 9s/epoch - 17ms/step
testing model: results/PCAR/W4/deepLOB_L1/h10
Evaluating performance on  test set...
1590/1590 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0449631
{'0': {'precision': 0.44305403591360876, 'recall': 0.39349175240894985, 'f1-score': 0.416804701995061, 'support': 122460}, '1': {'precision': 0.4721864190351724, 'recall': 0.47412490594431905, 'f1-score': 0.4731536770271407, 'support': 166125}, '2': {'precision': 0.39466776233194095, 'recall': 0.4380542183937167, 'f1-score': 0.4152307304362445, 'support': 118410}, 'accuracy': 0.4393690340176169, 'macro avg': {'precision': 0.4366360724269074, 'recall': 0.4352236255823286, 'f1-score': 0.43506303648614875, 'support': 406995}, 'weighted avg': {'precision': 0.4408677645620306, 'recall': 0.4393690340176169, 'f1-score': 0.4393469924529899, 'support': 406995}}
[[48187 42199 32074]
 [39878 78764 47483]
 [20696 45844 51870]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0593984
{'0': {'precision': 0.4722025853362957, 'recall': 0.4056697900399098, 'f1-score': 0.43641497106589516, 'support': 46104}, '1': {'precision': 0.3928761713730529, 'recall': 0.5545209236485888, 'f1-score': 0.4599086456441583, 'support': 45212}, '2': {'precision': 0.46982217420503986, 'recall': 0.34711884883394817, 'f1-score': 0.39925558312655085, 'support': 46353}, 'accuracy': 0.43484008745614483, 'macro avg': {'precision': 0.4449669769714628, 'recall': 0.435769854174149, 'f1-score': 0.43185973327886806, 'support': 137669}, 'weighted avg': {'precision': 0.4453494446490441, 'recall': 0.43484008745614483, 'f1-score': 0.4316190250350531, 'support': 137669}}
[[18703 18383  9018]
 [11002 25071  9139]
 [ 9903 20360 16090]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0575578
{'0': {'precision': 0.46734492943879224, 'recall': 0.33592828497287097, 'f1-score': 0.3908866318967884, 'support': 16956}, '1': {'precision': 0.4346467708090464, 'recall': 0.4695717884130982, 'f1-score': 0.4514347984017436, 'support': 19850}, '2': {'precision': 0.405408127297447, 'recall': 0.4825002996524032, 'f1-score': 0.4406074702421672, 'support': 16686}, 'accuracy': 0.431242054886712, 'macro avg': {'precision': 0.4357999425150952, 'recall': 0.42933345767945746, 'f1-score': 0.42764296684689973, 'support': 53492}, 'weighted avg': {'precision': 0.4358909563338244, 'recall': 0.431242054886712, 'f1-score': 0.4288647036412428, 'support': 53492}}
[[5696 6100 5160]
 [3881 9321 6648]
 [2611 6024 8051]]
training model: results/PCAR/W4/deepLOB_L1/h20
Epoch 1/50
538/538 - 11s - loss: 3.2800 - accuracy20: 0.3895 - val_loss: 3.2945 - val_accuracy20: 0.3626 - 11s/epoch - 20ms/step
Epoch 2/50
538/538 - 9s - loss: 3.2331 - accuracy20: 0.4116 - val_loss: 3.3034 - val_accuracy20: 0.3569 - 9s/epoch - 16ms/step
Epoch 3/50
538/538 - 9s - loss: 3.2134 - accuracy20: 0.4198 - val_loss: 3.2786 - val_accuracy20: 0.3636 - 9s/epoch - 17ms/step
Epoch 4/50
538/538 - 9s - loss: 3.1964 - accuracy20: 0.4281 - val_loss: 3.2647 - val_accuracy20: 0.3649 - 9s/epoch - 17ms/step
Epoch 5/50
538/538 - 9s - loss: 3.1900 - accuracy20: 0.4289 - val_loss: 3.2796 - val_accuracy20: 0.3624 - 9s/epoch - 17ms/step
Epoch 6/50
538/538 - 9s - loss: 3.1824 - accuracy20: 0.4328 - val_loss: 3.2516 - val_accuracy20: 0.3870 - 9s/epoch - 17ms/step
Epoch 7/50
538/538 - 9s - loss: 3.1770 - accuracy20: 0.4345 - val_loss: 3.2725 - val_accuracy20: 0.3761 - 9s/epoch - 17ms/step
Epoch 8/50
538/538 - 9s - loss: 3.1712 - accuracy20: 0.4364 - val_loss: 3.2529 - val_accuracy20: 0.3876 - 9s/epoch - 16ms/step
Epoch 9/50
538/538 - 9s - loss: 3.1640 - accuracy20: 0.4392 - val_loss: 3.2475 - val_accuracy20: 0.3884 - 9s/epoch - 17ms/step
Epoch 10/50
538/538 - 9s - loss: 3.1619 - accuracy20: 0.4396 - val_loss: 3.2516 - val_accuracy20: 0.3921 - 9s/epoch - 17ms/step
Epoch 11/50
538/538 - 9s - loss: 3.1582 - accuracy20: 0.4425 - val_loss: 3.2712 - val_accuracy20: 0.3918 - 9s/epoch - 17ms/step
Epoch 12/50
538/538 - 9s - loss: 3.1550 - accuracy20: 0.4441 - val_loss: 3.2877 - val_accuracy20: 0.3832 - 9s/epoch - 16ms/step
Epoch 13/50
538/538 - 9s - loss: 3.1525 - accuracy20: 0.4451 - val_loss: 3.2765 - val_accuracy20: 0.3801 - 9s/epoch - 16ms/step
Epoch 14/50
538/538 - 9s - loss: 3.1495 - accuracy20: 0.4461 - val_loss: 3.2840 - val_accuracy20: 0.3796 - 9s/epoch - 17ms/step
Epoch 15/50
538/538 - 9s - loss: 3.1461 - accuracy20: 0.4473 - val_loss: 3.2710 - val_accuracy20: 0.3878 - 9s/epoch - 17ms/step
Epoch 16/50
538/538 - 9s - loss: 3.1416 - accuracy20: 0.4492 - val_loss: 3.2751 - val_accuracy20: 0.3835 - 9s/epoch - 17ms/step
Epoch 17/50
538/538 - 9s - loss: 3.1395 - accuracy20: 0.4502 - val_loss: 3.2682 - val_accuracy20: 0.3862 - 9s/epoch - 17ms/step
Epoch 18/50
538/538 - 9s - loss: 3.1376 - accuracy20: 0.4510 - val_loss: 3.2896 - val_accuracy20: 0.3782 - 9s/epoch - 17ms/step
Epoch 19/50
538/538 - 9s - loss: 3.1352 - accuracy20: 0.4523 - val_loss: 3.3108 - val_accuracy20: 0.3761 - 9s/epoch - 17ms/step
testing model: results/PCAR/W4/deepLOB_L1/h20
Evaluating performance on  test set...
1590/1590 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0621297
{'0': {'precision': 0.4429902464865539, 'recall': 0.3403155148062145, 'f1-score': 0.38492364345283225, 'support': 125319}, '1': {'precision': 0.421568769185545, 'recall': 0.5430297086245639, 'f1-score': 0.47465214006093137, 'support': 161098}, '2': {'precision': 0.379123913612185, 'recall': 0.3245119341836819, 'f1-score': 0.3496985973269225, 'support': 120578}, 'accuracy': 0.41587243086524406, 'macro avg': {'precision': 0.41456097642809464, 'recall': 0.40261905253815344, 'f1-score': 0.4030914602802287, 'support': 406995}, 'weighted avg': {'precision': 0.4155898316520631, 'recall': 0.41587243086524406, 'f1-score': 0.41000433421021654, 'support': 406995}}
[[42648 56862 25809]
 [35346 87481 38271]
 [18279 63170 39129]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0719826
{'0': {'precision': 0.4404751172015867, 'recall': 0.42521758050478675, 'f1-score': 0.4327118944291914, 'support': 45960}, '1': {'precision': 0.37270691217452256, 'recall': 0.47852141273569376, 'f1-score': 0.4190373673689066, 'support': 45557}, '2': {'precision': 0.4462798046538351, 'recall': 0.3366051308719015, 'f1-score': 0.3837602826017144, 'support': 46152}, 'accuracy': 0.41315038243903857, 'macro avg': {'precision': 0.4198206113433148, 'recall': 0.413448041370794, 'f1-score': 0.41183651479993744, 'support': 137669}, 'weighted avg': {'precision': 0.4199954291009846, 'recall': 0.41315038243903857, 'f1-score': 0.4117762791610692, 'support': 137669}}
[[19543 17480  8937]
 [13419 21800 10338]
 [11406 19211 15535]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0824608
{'0': {'precision': 0.46031179340711653, 'recall': 0.22466167160364756, 'f1-score': 0.30195160031225604, 'support': 17217}, '1': {'precision': 0.3718970701349556, 'recall': 0.5594887439511887, 'f1-score': 0.4468013609442601, 'support': 19012}, '2': {'precision': 0.38242251470855826, 'recall': 0.36523199907316223, 'f1-score': 0.3736296296296296, 'support': 17263}, 'accuracy': 0.38903013534734165, 'macro avg': {'precision': 0.4048771260835435, 'recall': 0.3831274715426662, 'f1-score': 0.3741275302953819, 'support': 53492}, 'weighted avg': {'precision': 0.4037511238299174, 'recall': 0.38903013534734165, 'f1-score': 0.37656577568878863, 'support': 53492}}
[[ 3868  8742  4607]
 [ 2800 10637  5575]
 [ 1735  9223  6305]]
training model: results/PCAR/W4/deepLOB_L1/h30
Epoch 1/50
538/538 - 11s - loss: 3.2944 - accuracy30: 0.3797 - val_loss: 3.3132 - val_accuracy30: 0.3537 - 11s/epoch - 20ms/step
Epoch 2/50
538/538 - 9s - loss: 3.2486 - accuracy30: 0.4014 - val_loss: 3.2823 - val_accuracy30: 0.3604 - 9s/epoch - 17ms/step
Epoch 3/50
538/538 - 9s - loss: 3.2292 - accuracy30: 0.4108 - val_loss: 3.2575 - val_accuracy30: 0.3808 - 9s/epoch - 17ms/step
Epoch 4/50
538/538 - 9s - loss: 3.2180 - accuracy30: 0.4166 - val_loss: 3.2607 - val_accuracy30: 0.3783 - 9s/epoch - 17ms/step
Epoch 5/50
538/538 - 9s - loss: 3.2084 - accuracy30: 0.4209 - val_loss: 3.2542 - val_accuracy30: 0.3776 - 9s/epoch - 17ms/step
Epoch 6/50
538/538 - 9s - loss: 3.2036 - accuracy30: 0.4223 - val_loss: 3.2670 - val_accuracy30: 0.3784 - 9s/epoch - 17ms/step
Epoch 7/50
538/538 - 9s - loss: 3.1981 - accuracy30: 0.4258 - val_loss: 3.2481 - val_accuracy30: 0.3839 - 9s/epoch - 17ms/step
Epoch 8/50
538/538 - 9s - loss: 3.1934 - accuracy30: 0.4288 - val_loss: 3.2520 - val_accuracy30: 0.3831 - 9s/epoch - 17ms/step
Epoch 9/50
538/538 - 9s - loss: 3.1890 - accuracy30: 0.4304 - val_loss: 3.2461 - val_accuracy30: 0.3865 - 9s/epoch - 17ms/step
Epoch 10/50
538/538 - 9s - loss: 3.1849 - accuracy30: 0.4329 - val_loss: 3.2551 - val_accuracy30: 0.3869 - 9s/epoch - 17ms/step
Epoch 11/50
538/538 - 9s - loss: 3.1819 - accuracy30: 0.4337 - val_loss: 3.2522 - val_accuracy30: 0.3837 - 9s/epoch - 17ms/step
Epoch 12/50
538/538 - 9s - loss: 3.1777 - accuracy30: 0.4359 - val_loss: 3.2455 - val_accuracy30: 0.3867 - 9s/epoch - 17ms/step
Epoch 13/50
538/538 - 9s - loss: 3.1749 - accuracy30: 0.4368 - val_loss: 3.2533 - val_accuracy30: 0.3881 - 9s/epoch - 17ms/step
Epoch 14/50
538/538 - 9s - loss: 3.1726 - accuracy30: 0.4371 - val_loss: 3.2560 - val_accuracy30: 0.3820 - 9s/epoch - 17ms/step
Epoch 15/50
538/538 - 9s - loss: 3.1697 - accuracy30: 0.4373 - val_loss: 3.2484 - val_accuracy30: 0.3911 - 9s/epoch - 17ms/step
Epoch 16/50
538/538 - 9s - loss: 3.1671 - accuracy30: 0.4391 - val_loss: 3.2675 - val_accuracy30: 0.3837 - 9s/epoch - 17ms/step
Epoch 17/50
538/538 - 9s - loss: 3.1625 - accuracy30: 0.4419 - val_loss: 3.2594 - val_accuracy30: 0.3855 - 9s/epoch - 17ms/step
Epoch 18/50
538/538 - 9s - loss: 3.1606 - accuracy30: 0.4416 - val_loss: 3.2725 - val_accuracy30: 0.3844 - 9s/epoch - 17ms/step
Epoch 19/50
538/538 - 9s - loss: 3.1592 - accuracy30: 0.4426 - val_loss: 3.2571 - val_accuracy30: 0.3927 - 9s/epoch - 17ms/step
Epoch 20/50
538/538 - 9s - loss: 3.1580 - accuracy30: 0.4430 - val_loss: 3.2783 - val_accuracy30: 0.3873 - 9s/epoch - 17ms/step
Epoch 21/50
538/538 - 9s - loss: 3.1543 - accuracy30: 0.4446 - val_loss: 3.2772 - val_accuracy30: 0.3799 - 9s/epoch - 17ms/step
Epoch 22/50
538/538 - 9s - loss: 3.1508 - accuracy30: 0.4451 - val_loss: 3.2816 - val_accuracy30: 0.3821 - 9s/epoch - 17ms/step
testing model: results/PCAR/W4/deepLOB_L1/h30
Evaluating performance on  test set...
1590/1590 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0732796
{'0': {'precision': 0.4317755272693487, 'recall': 0.3578926291307596, 'f1-score': 0.3913777639286, 'support': 129849}, '1': {'precision': 0.3900439401524, 'recall': 0.46416775329463394, 'f1-score': 0.42388981742018744, 'support': 151079}, '2': {'precision': 0.38457035333472717, 'recall': 0.3647663543988514, 'f1-score': 0.3744066568420709, 'support': 126067}, 'accuracy': 0.3994717379820391, 'macro avg': {'precision': 0.4021299402521586, 'recall': 0.39560891227474837, 'f1-score': 0.3965580793969528, 'support': 406995}, 'weighted avg': {'precision': 0.40166267302677217, 'recall': 0.3994717379820391, 'f1-score': 0.3981896215002607, 'support': 406995}}
[[46472 53670 29707]
 [37070 70126 43883]
 [24088 55994 45985]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0780882
{'0': {'precision': 0.4290969899665552, 'recall': 0.4163872000692356, 'f1-score': 0.4226465646927055, 'support': 46219}, '1': {'precision': 0.371930567315834, 'recall': 0.3885878580117218, 'f1-score': 0.38007679411605644, 'support': 45215}, '2': {'precision': 0.42344061958358015, 'recall': 0.41743268086947116, 'f1-score': 0.4204151872263489, 'support': 46235}, 'accuracy': 0.4076081034946139, 'macro avg': {'precision': 0.4081560589553231, 'recall': 0.4074692463168095, 'f1-score': 0.40771284867837027, 'support': 137669}, 'weighted avg': {'precision': 0.40842202258240035, 'recall': 0.4076081034946139, 'f1-score': 0.40791587068185203, 'support': 137669}}
[[19245 14552 12422]
 [13788 17570 13857]
 [11817 15118 19300]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.082322
{'0': {'precision': 0.437295335870431, 'recall': 0.2830707533657978, 'f1-score': 0.34367392362801696, 'support': 17455}, '1': {'precision': 0.360045880328809, 'recall': 0.5095779220779221, 'f1-score': 0.42195586423210485, 'support': 18480}, '2': {'precision': 0.4044768674398304, 'recall': 0.3694822577889161, 'f1-score': 0.3861884208959666, 'support': 17557}, 'accuracy': 0.3896844387945861, 'macro avg': {'precision': 0.40060602787969013, 'recall': 0.387376977744212, 'f1-score': 0.38393940291869616, 'support': 53492}, 'weighted avg': {'precision': 0.3998362057454548, 'recall': 0.3896844387945861, 'f1-score': 0.38467215309965636, 'support': 53492}}
[[4941 8364 4150]
 [3662 9417 5401]
 [2696 8374 6487]]
training model: results/PCAR/W4/deepLOB_L1/h50
Epoch 1/50
538/538 - 11s - loss: 3.3072 - accuracy50: 0.3729 - val_loss: 3.2943 - val_accuracy50: 0.3627 - 11s/epoch - 21ms/step
Epoch 2/50
538/538 - 9s - loss: 3.2653 - accuracy50: 0.3911 - val_loss: 3.2684 - val_accuracy50: 0.3717 - 9s/epoch - 17ms/step
Epoch 3/50
538/538 - 9s - loss: 3.2489 - accuracy50: 0.3999 - val_loss: 3.3194 - val_accuracy50: 0.3483 - 9s/epoch - 17ms/step
Epoch 4/50
538/538 - 9s - loss: 3.2391 - accuracy50: 0.4050 - val_loss: 3.2694 - val_accuracy50: 0.3611 - 9s/epoch - 17ms/step
Epoch 5/50
538/538 - 9s - loss: 3.2338 - accuracy50: 0.4069 - val_loss: 3.3009 - val_accuracy50: 0.3417 - 9s/epoch - 17ms/step
Epoch 6/50
538/538 - 9s - loss: 3.2288 - accuracy50: 0.4103 - val_loss: 3.3254 - val_accuracy50: 0.3345 - 9s/epoch - 17ms/step
Epoch 7/50
538/538 - 9s - loss: 3.2249 - accuracy50: 0.4113 - val_loss: 3.3384 - val_accuracy50: 0.3264 - 9s/epoch - 17ms/step
Epoch 8/50
538/538 - 9s - loss: 3.2220 - accuracy50: 0.4122 - val_loss: 3.3215 - val_accuracy50: 0.3394 - 9s/epoch - 17ms/step
Epoch 9/50
538/538 - 9s - loss: 3.2196 - accuracy50: 0.4147 - val_loss: 3.3349 - val_accuracy50: 0.3357 - 9s/epoch - 17ms/step
Epoch 10/50
538/538 - 9s - loss: 3.2162 - accuracy50: 0.4163 - val_loss: 3.3398 - val_accuracy50: 0.3305 - 9s/epoch - 17ms/step
Epoch 11/50
538/538 - 9s - loss: 3.2119 - accuracy50: 0.4190 - val_loss: 3.3253 - val_accuracy50: 0.3381 - 9s/epoch - 17ms/step
Epoch 12/50
538/538 - 9s - loss: 3.2080 - accuracy50: 0.4201 - val_loss: 3.3326 - val_accuracy50: 0.3360 - 9s/epoch - 17ms/step
testing model: results/PCAR/W4/deepLOB_L1/h50
Evaluating performance on  test set...
1590/1590 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0836108
{'0': {'precision': 0.34150864313566104, 'recall': 0.22415819793082176, 'f1-score': 0.2706609490447142, 'support': 119951}, '1': {'precision': 0.41018419635009595, 'recall': 0.5127290340110338, 'f1-score': 0.4557597395778641, 'support': 169298}, '2': {'precision': 0.32803497942386833, 'recall': 0.32495371392658773, 'f1-score': 0.32648707687319206, 'support': 117746}, 'accuracy': 0.37335593803363676, 'macro avg': {'precision': 0.3599092729698751, 'recall': 0.35394698195614777, 'f1-score': 0.3509692551652568, 'support': 406995}, 'weighted avg': {'precision': 0.3661776533217534, 'recall': 0.37335593803363676, 'f1-score': 0.3638074454070115, 'support': 406995}}
[[26888 63060 30003]
 [34119 86804 48375]
 [17726 61758 38262]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0909271
{'0': {'precision': 0.40662464118872066, 'recall': 0.3146353678984387, 'f1-score': 0.3547638631425169, 'support': 45923}, '1': {'precision': 0.3495596099402328, 'recall': 0.4891603389457467, 'f1-score': 0.40774205384580103, 'support': 45435}, '2': {'precision': 0.38819867721436907, 'recall': 0.32318455658482864, 'f1-score': 0.3527207597860156, 'support': 46311}, 'accuracy': 0.3751098649659691, 'macro avg': {'precision': 0.3814609761144408, 'recall': 0.37566008780967136, 'f1-score': 0.3717422255914445, 'support': 137669}, 'weighted avg': {'precision': 0.3815930472032102, 'recall': 0.3751098649659691, 'f1-score': 0.3715610065448862, 'support': 137669}}
[[14449 20309 11165]
 [10787 22225 12423]
 [10298 21046 14967]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0896704
{'0': {'precision': 0.3892146863844977, 'recall': 0.17480675636988263, 'f1-score': 0.24125805049587104, 'support': 17465}, '1': {'precision': 0.3794648262501514, 'recall': 0.5037505357908273, 'f1-score': 0.4328629635597708, 'support': 18664}, '2': {'precision': 0.3600210818839538, 'recall': 0.43275931578644244, 'f1-score': 0.39305330334257477, 'support': 17363}, 'accuracy': 0.37330815822926794, 'macro avg': {'precision': 0.3762335315062009, 'recall': 0.37043886931571746, 'f1-score': 0.3557247724660722, 'support': 53492}, 'weighted avg': {'precision': 0.3763368739173926, 'recall': 0.37330815822926794, 'f1-score': 0.35738261253509074, 'support': 53492}}
[[3053 7816 6596]
 [2501 9402 6761]
 [2290 7559 7514]]
training model: results/PCAR/W4/deepLOB_L1/h100
Epoch 1/50
538/538 - 11s - loss: 3.3261 - accuracy100: 0.3563 - val_loss: 3.3212 - val_accuracy100: 0.3525 - 11s/epoch - 21ms/step
Epoch 2/50
538/538 - 9s - loss: 3.2936 - accuracy100: 0.3664 - val_loss: 3.3129 - val_accuracy100: 0.3446 - 9s/epoch - 17ms/step
Epoch 3/50
538/538 - 9s - loss: 3.2879 - accuracy100: 0.3678 - val_loss: 3.3191 - val_accuracy100: 0.3392 - 9s/epoch - 17ms/step
Epoch 4/50
538/538 - 9s - loss: 3.2717 - accuracy100: 0.3797 - val_loss: 3.3226 - val_accuracy100: 0.3415 - 9s/epoch - 17ms/step
Epoch 5/50
538/538 - 9s - loss: 3.2661 - accuracy100: 0.3824 - val_loss: 3.3372 - val_accuracy100: 0.3439 - 9s/epoch - 17ms/step
Epoch 6/50
538/538 - 9s - loss: 3.2616 - accuracy100: 0.3883 - val_loss: 3.3411 - val_accuracy100: 0.3439 - 9s/epoch - 17ms/step
Epoch 7/50
538/538 - 9s - loss: 3.2564 - accuracy100: 0.3923 - val_loss: 3.3310 - val_accuracy100: 0.3419 - 9s/epoch - 17ms/step
Epoch 8/50
538/538 - 9s - loss: 3.2529 - accuracy100: 0.3950 - val_loss: 3.3397 - val_accuracy100: 0.3452 - 9s/epoch - 17ms/step
Epoch 9/50
538/538 - 9s - loss: 3.2486 - accuracy100: 0.3977 - val_loss: 3.3224 - val_accuracy100: 0.3437 - 9s/epoch - 17ms/step
Epoch 10/50
538/538 - 9s - loss: 3.2449 - accuracy100: 0.3991 - val_loss: 3.3309 - val_accuracy100: 0.3458 - 9s/epoch - 17ms/step
Epoch 11/50
538/538 - 9s - loss: 3.2409 - accuracy100: 0.4016 - val_loss: 3.3311 - val_accuracy100: 0.3487 - 9s/epoch - 17ms/step
Epoch 12/50
538/538 - 9s - loss: 3.2379 - accuracy100: 0.4040 - val_loss: 3.3259 - val_accuracy100: 0.3409 - 9s/epoch - 17ms/step
testing model: results/PCAR/W4/deepLOB_L1/h100
Evaluating performance on  test set...
1590/1590 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1054004
{'0': {'precision': 0.33890939440379314, 'recall': 0.36470624670940566, 'f1-score': 0.3513349220378678, 'support': 129156}, '1': {'precision': 0.3655792349069205, 'recall': 0.20066580358794156, 'f1-score': 0.2591077924237837, 'support': 151396}, '2': {'precision': 0.3197066633496839, 'recall': 0.46753082416582964, 'f1-score': 0.37973984262084476, 'support': 126443}, 'accuracy': 0.33563065885330284, 'macro avg': {'precision': 0.34139843088679916, 'recall': 0.34430095815439227, 'f1-score': 0.3300608523608321, 'support': 406995}, 'weighted avg': {'precision': 0.34286437235226114, 'recall': 0.33563065885330284, 'f1-score': 0.32585250790064124, 'support': 406995}}
[[47104 25257 56795]
 [52020 30380 68996]
 [39863 27464 59116]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1028806
{'0': {'precision': 0.3521571085344197, 'recall': 0.3693737125827234, 'f1-score': 0.3605600059893688, 'support': 45634}, '1': {'precision': 0.34311028400356014, 'recall': 0.18647757255936676, 'f1-score': 0.24163081569275482, 'support': 45480}, '2': {'precision': 0.3548689426297514, 'recall': 0.4961228654279884, 'f1-score': 0.41377271790829534, 'support': 46555}, 'accuracy': 0.3518148602808185, 'macro avg': {'precision': 0.35004544505591045, 'recall': 0.3506580501900262, 'f1-score': 0.33865451319680634, 'support': 137669}, 'weighted avg': {'precision': 0.35008547190340383, 'recall': 0.3518148602808185, 'f1-score': 0.3392655840693695, 'support': 137669}}
[[16856  7816 20962]
 [15972  8481 21027]
 [15037  8421 23097]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1049938
{'0': {'precision': 0.3527224570875567, 'recall': 0.3856005345509215, 'f1-score': 0.3684294530751224, 'support': 17959}, '1': {'precision': 0.35797213622291024, 'recall': 0.2528289509648499, 'f1-score': 0.29635087944125843, 'support': 18293}, '2': {'precision': 0.32198290271741725, 'recall': 0.39106728538283064, 'f1-score': 0.353178448885513, 'support': 17240}, 'accuracy': 0.3419576759141554, 'macro avg': {'precision': 0.34422583200929474, 'recall': 0.3431655902995341, 'f1-score': 0.33931959380063126, 'support': 53492}, 'weighted avg': {'precision': 0.34461063593825997, 'recall': 0.3419576759141554, 'f1-score': 0.33886501989421425, 'support': 53492}}
[[6925 4026 7008]
 [6479 4625 7189]
 [6229 4269 6742]]
training model: results/PCAR/W4/deepLOB_L1/h200
Epoch 1/50
538/538 - 11s - loss: 3.3356 - accuracy200: 0.3537 - val_loss: 3.4571 - val_accuracy200: 0.3345 - 11s/epoch - 21ms/step
Epoch 2/50
538/538 - 9s - loss: 3.2907 - accuracy200: 0.3684 - val_loss: 3.3780 - val_accuracy200: 0.3309 - 9s/epoch - 17ms/step
Epoch 3/50
538/538 - 9s - loss: 3.2810 - accuracy200: 0.3743 - val_loss: 3.4195 - val_accuracy200: 0.3161 - 9s/epoch - 17ms/step
Epoch 4/50
538/538 - 9s - loss: 3.2708 - accuracy200: 0.3759 - val_loss: 3.4601 - val_accuracy200: 0.3193 - 9s/epoch - 17ms/step
Epoch 5/50
538/538 - 9s - loss: 3.2635 - accuracy200: 0.3826 - val_loss: 3.4737 - val_accuracy200: 0.3204 - 9s/epoch - 17ms/step
Epoch 6/50
538/538 - 9s - loss: 3.2542 - accuracy200: 0.3897 - val_loss: 3.4874 - val_accuracy200: 0.3153 - 9s/epoch - 17ms/step
Epoch 7/50
538/538 - 9s - loss: 3.2488 - accuracy200: 0.3941 - val_loss: 3.5138 - val_accuracy200: 0.3126 - 9s/epoch - 17ms/step
Epoch 8/50
538/538 - 9s - loss: 3.2435 - accuracy200: 0.3990 - val_loss: 3.4888 - val_accuracy200: 0.3161 - 9s/epoch - 17ms/step
Epoch 9/50
538/538 - 9s - loss: 3.2379 - accuracy200: 0.4028 - val_loss: 3.4920 - val_accuracy200: 0.3085 - 9s/epoch - 17ms/step
Epoch 10/50
538/538 - 9s - loss: 3.2315 - accuracy200: 0.4066 - val_loss: 3.4718 - val_accuracy200: 0.3152 - 9s/epoch - 17ms/step
Epoch 11/50
538/538 - 9s - loss: 3.2261 - accuracy200: 0.4116 - val_loss: 3.4545 - val_accuracy200: 0.3050 - 9s/epoch - 17ms/step
Epoch 12/50
538/538 - 9s - loss: 3.2214 - accuracy200: 0.4131 - val_loss: 3.4985 - val_accuracy200: 0.3096 - 9s/epoch - 17ms/step
testing model: results/PCAR/W4/deepLOB_L1/h200
Evaluating performance on  test set...
1590/1590 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1135433
{'0': {'precision': 0.3276044420941301, 'recall': 0.1051693404634581, 'f1-score': 0.15922380003855297, 'support': 129591}, '1': {'precision': 0.36490333074562864, 'recall': 0.3242559621575455, 'f1-score': 0.3433809333310142, 'support': 152210}, '2': {'precision': 0.31373784424997175, 'recall': 0.5767289167212486, 'f1-score': 0.40639739736359237, 'support': 125194}, 'accuracy': 0.3321588717306109, 'macro avg': {'precision': 0.33541520569657685, 'recall': 0.33538473978075073, 'f1-score': 0.3030007102443865, 'support': 406995}, 'weighted avg': {'precision': 0.33728821951435156, 'recall': 0.3321588717306109, 'f1-score': 0.3041278126233673, 'support': 406995}}
[[13629 44171 71791]
 [16711 49355 86144]
 [11262 41729 72203]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.108457
{'0': {'precision': 0.34470163516670205, 'recall': 0.17880984379475204, 'f1-score': 0.23547161052601037, 'support': 45389}, '1': {'precision': 0.34216404467395223, 'recall': 0.3134502409293934, 'f1-score': 0.32717835652932803, 'support': 45449}, '2': {'precision': 0.34470057525969455, 'recall': 0.5335568320129829, 'f1-score': 0.4188233322158901, 'support': 46831}, 'accuracy': 0.34393363792865494, 'macro avg': {'precision': 0.34385541836678296, 'recall': 0.3419389722457094, 'f1-score': 0.32715776642374284, 'support': 137669}, 'weighted avg': {'precision': 0.3438635337291231, 'recall': 0.34393363792865494, 'f1-score': 0.32811791708423005, 'support': 137669}}
[[ 8116 13480 23793]
 [ 7494 14246 23709]
 [ 7935 13909 24987]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1238663
{'0': {'precision': 0.37534246575342467, 'recall': 0.007181799119312225, 'f1-score': 0.014093925209608562, 'support': 19076}, '1': {'precision': 0.3340615221113538, 'recall': 0.33270610372809595, 'f1-score': 0.3333824352591109, 'support': 17006}, '2': {'precision': 0.32837800497374964, 'recall': 0.6825962090752441, 'f1-score': 0.44343283582089554, 'support': 17410}, 'accuracy': 0.33049801839527404, 'macro avg': {'precision': 0.34592733094617606, 'recall': 0.34082803730755074, 'f1-score': 0.263636398763205, 'support': 53492}, 'weighted avg': {'precision': 0.3469330776252709, 'recall': 0.33049801839527404, 'f1-score': 0.2553376782127556, 'support': 53492}}
[[  137  5857 13082]
 [  124  5658 11224]
 [  104  5422 11884]]
training model: results/PCAR/W4/deepLOB_L1/h300
Epoch 1/50
538/538 - 11s - loss: 3.3220 - accuracy300: 0.3632 - val_loss: 3.4114 - val_accuracy300: 0.3281 - 11s/epoch - 20ms/step
Epoch 2/50
538/538 - 9s - loss: 3.2886 - accuracy300: 0.3734 - val_loss: 3.4992 - val_accuracy300: 0.3243 - 9s/epoch - 16ms/step
Epoch 3/50
538/538 - 9s - loss: 3.2800 - accuracy300: 0.3750 - val_loss: 3.5021 - val_accuracy300: 0.3235 - 9s/epoch - 16ms/step
Epoch 4/50
538/538 - 9s - loss: 3.2663 - accuracy300: 0.3831 - val_loss: 3.4522 - val_accuracy300: 0.3234 - 9s/epoch - 16ms/step
Epoch 5/50
538/538 - 9s - loss: 3.2570 - accuracy300: 0.3894 - val_loss: 3.4910 - val_accuracy300: 0.3230 - 9s/epoch - 16ms/step
Epoch 6/50
538/538 - 9s - loss: 3.2494 - accuracy300: 0.3936 - val_loss: 3.4749 - val_accuracy300: 0.3235 - 9s/epoch - 17ms/step
Epoch 7/50
538/538 - 9s - loss: 3.2376 - accuracy300: 0.4016 - val_loss: 3.4752 - val_accuracy300: 0.3172 - 9s/epoch - 17ms/step
Epoch 8/50
538/538 - 9s - loss: 3.2345 - accuracy300: 0.4049 - val_loss: 3.4443 - val_accuracy300: 0.3223 - 9s/epoch - 17ms/step
Epoch 9/50
538/538 - 9s - loss: 3.2290 - accuracy300: 0.4094 - val_loss: 3.4600 - val_accuracy300: 0.3200 - 9s/epoch - 17ms/step
Epoch 10/50
538/538 - 9s - loss: 3.2226 - accuracy300: 0.4107 - val_loss: 3.4595 - val_accuracy300: 0.3214 - 9s/epoch - 17ms/step
Epoch 11/50
538/538 - 10s - loss: 3.2159 - accuracy300: 0.4171 - val_loss: 3.4219 - val_accuracy300: 0.3210 - 10s/epoch - 18ms/step
testing model: results/PCAR/W4/deepLOB_L1/h300
Evaluating performance on  test set...
1590/1590 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1239203
{'0': {'precision': 0.34631812432402703, 'recall': 0.1434102054139402, 'f1-score': 0.20282899857744854, 'support': 131734}, '1': {'precision': 0.36632677564264005, 'recall': 0.4242228989616045, 'f1-score': 0.39315481802753166, 'support': 147439}, '2': {'precision': 0.321447637078089, 'recall': 0.4569479432335592, 'f1-score': 0.377404086907358, 'support': 127822}, 'accuracy': 0.34360864384083345, 'macro avg': {'precision': 0.344697512348252, 'recall': 0.3415270158697013, 'f1-score': 0.3244626345041128, 'support': 406995}, 'weighted avg': {'precision': 0.34575561156837814, 'recall': 0.34360864384083345, 'f1-score': 0.3266044391465132, 'support': 406995}}
[[18892 54421 58421]
 [20018 62547 64874]
 [15641 53773 58408]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.123121
{'0': {'precision': 0.33646580583452895, 'recall': 0.3114086533141529, 'f1-score': 0.32345267513361303, 'support': 45185}, '1': {'precision': 0.3476358652680407, 'recall': 0.289877368027779, 'f1-score': 0.31614016585973825, 'support': 45502}, '2': {'precision': 0.3491978517277704, 'recall': 0.4303988761653399, 'f1-score': 0.3855695068119631, 'support': 46982}, 'accuracy': 0.34489972324924273, 'macro avg': {'precision': 0.34443317427677994, 'recall': 0.3438949658357573, 'f1-score': 0.34172078260177147, 'support': 137669}, 'weighted avg': {'precision': 0.34450274243245527, 'recall': 0.34489972324924273, 'f1-score': 0.34223423953033555, 'support': 137669}}
[[14071 12399 18715]
 [13341 13190 18971]
 [14408 12353 20221]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1328092
{'0': {'precision': 0.35339233038348083, 'recall': 0.03143037044810578, 'f1-score': 0.057726593745482585, 'support': 19058}, '1': {'precision': 0.33909585962485955, 'recall': 0.44942146866765953, 'f1-score': 0.38654054586658787, 'support': 17458}, '2': {'precision': 0.32230712865068567, 'recall': 0.5441211121583411, 'f1-score': 0.404820861181111, 'support': 16976}, 'accuracy': 0.330554101547895, 'macro avg': {'precision': 0.33826510621967537, 'recall': 0.34165765042470214, 'f1-score': 0.28302933359772714, 'support': 53492}, 'weighted avg': {'precision': 0.3388613692842522, 'recall': 0.330554101547895, 'f1-score': 0.2751928739391094, 'support': 53492}}
[[  599  8132 10327]
 [  517  7846  9095]
 [  579  7160  9237]]
training model: results/PCAR/W4/deepLOB_L1/h500
Epoch 1/50
538/538 - 12s - loss: 3.3275 - accuracy500: 0.3619 - val_loss: 3.5242 - val_accuracy500: 0.3169 - 12s/epoch - 22ms/step
Epoch 2/50
538/538 - 9s - loss: 3.2964 - accuracy500: 0.3704 - val_loss: 3.4801 - val_accuracy500: 0.3087 - 9s/epoch - 18ms/step
Epoch 3/50
538/538 - 9s - loss: 3.2785 - accuracy500: 0.3814 - val_loss: 3.5992 - val_accuracy500: 0.3155 - 9s/epoch - 18ms/step
Epoch 4/50
538/538 - 9s - loss: 3.2693 - accuracy500: 0.3851 - val_loss: 3.6874 - val_accuracy500: 0.3164 - 9s/epoch - 18ms/step
Epoch 5/50
538/538 - 9s - loss: 3.2603 - accuracy500: 0.3874 - val_loss: 3.7854 - val_accuracy500: 0.3150 - 9s/epoch - 17ms/step
Epoch 6/50
538/538 - 9s - loss: 3.2522 - accuracy500: 0.3952 - val_loss: 3.7302 - val_accuracy500: 0.3147 - 9s/epoch - 16ms/step
Epoch 7/50
538/538 - 9s - loss: 3.2464 - accuracy500: 0.3966 - val_loss: 3.8274 - val_accuracy500: 0.3143 - 9s/epoch - 17ms/step
Epoch 8/50
538/538 - 9s - loss: 3.2350 - accuracy500: 0.4073 - val_loss: 3.7662 - val_accuracy500: 0.3145 - 9s/epoch - 17ms/step
Epoch 9/50
538/538 - 9s - loss: 3.2237 - accuracy500: 0.4135 - val_loss: 3.7490 - val_accuracy500: 0.3145 - 9s/epoch - 17ms/step
Epoch 10/50
538/538 - 9s - loss: 3.2169 - accuracy500: 0.4175 - val_loss: 3.7705 - val_accuracy500: 0.3145 - 9s/epoch - 17ms/step
Epoch 11/50
538/538 - 9s - loss: 3.2121 - accuracy500: 0.4181 - val_loss: 3.7800 - val_accuracy500: 0.3141 - 9s/epoch - 17ms/step
Epoch 12/50
538/538 - 9s - loss: 3.2072 - accuracy500: 0.4214 - val_loss: 3.8913 - val_accuracy500: 0.3139 - 9s/epoch - 17ms/step
testing model: results/PCAR/W4/deepLOB_L1/h500
Evaluating performance on  test set...
1590/1590 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1331604
{'0': {'precision': 0.37508906391419056, 'recall': 0.1460733141348692, 'f1-score': 0.21026269343077514, 'support': 133344}, '1': {'precision': 0.3231971618719908, 'recall': 0.16610232226578564, 'f1-score': 0.21943125172612069, 'support': 145892}, '2': {'precision': 0.3163445643675001, 'recall': 0.6935245266478292, 'f1-score': 0.4344973347783232, 'support': 127759}, 'accuracy': 0.3251022739837099, 'macro avg': {'precision': 0.3382102633845605, 'recall': 0.335233387682828, 'f1-score': 0.28806375997840633, 'support': 406995}, 'weighted avg': {'precision': 0.3380474494218105, 'recall': 0.3251022739837099, 'f1-score': 0.2839383229857966, 'support': 406995}}
[[ 19478  26062  87804]
 [ 17980  24233 103679]
 [ 14471  24684  88604]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1261734
{'0': {'precision': 0.3307738224441068, 'recall': 0.27139963044591375, 'f1-score': 0.29815958422500766, 'support': 44919}, '1': {'precision': 0.3328981723237598, 'recall': 0.14000834559550215, 'f1-score': 0.19711516163443252, 'support': 45533}, '2': {'precision': 0.34312969153717104, 'recall': 0.5934515111082873, 'f1-score': 0.43483860955928, 'support': 47217}, 'accuracy': 0.3383986227836332, 'macro avg': {'precision': 0.33560056210167927, 'recall': 0.3349531623832344, 'f1-score': 0.3100377851395734, 'support': 137669}, 'weighted avg': {'precision': 0.3357141873340781, 'recall': 0.3383986227836332, 'f1-score': 0.311617355004135, 'support': 137669}}
[[12191  6263 26465]
 [11981  6375 27177]
 [12684  6512 28021]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.152648
{'0': {'precision': 0.3121869782971619, 'recall': 0.02958860759493671, 'f1-score': 0.05405405405405406, 'support': 18960}, '1': {'precision': 0.3241047030058967, 'recall': 0.25430231902048184, 'f1-score': 0.28499162161307656, 'support': 17723}, '2': {'precision': 0.3049829315409246, 'recall': 0.6856445951573562, 'f1-score': 0.42217663650683174, 'support': 16809}, 'accuracy': 0.3101959171464892, 'macro avg': {'precision': 0.3137582042813277, 'recall': 0.3231785072575916, 'f1-score': 0.2537407707246541, 'support': 53492}, 'weighted avg': {'precision': 0.31387180991847563, 'recall': 0.3101959171464892, 'f1-score': 0.2462450171568974, 'support': 53492}}
[[  561  4731 13668]
 [  620  4507 12596]
 [  616  4668 11525]]
training model: results/PCAR/W4/deepLOB_L1/h1000
Epoch 1/50
538/538 - 11s - loss: 3.3151 - accuracy1000: 0.3787 - val_loss: 3.8030 - val_accuracy1000: 0.3086 - 11s/epoch - 21ms/step
Epoch 2/50
538/538 - 9s - loss: 3.2798 - accuracy1000: 0.3915 - val_loss: 3.6881 - val_accuracy1000: 0.3073 - 9s/epoch - 17ms/step
Epoch 3/50
538/538 - 9s - loss: 3.2584 - accuracy1000: 0.3929 - val_loss: 3.5505 - val_accuracy1000: 0.3071 - 9s/epoch - 17ms/step
Epoch 4/50
538/538 - 9s - loss: 3.2458 - accuracy1000: 0.3992 - val_loss: 3.4740 - val_accuracy1000: 0.2958 - 9s/epoch - 17ms/step
Epoch 5/50
538/538 - 9s - loss: 3.2220 - accuracy1000: 0.4159 - val_loss: 3.4336 - val_accuracy1000: 0.3063 - 9s/epoch - 17ms/step
Epoch 6/50
538/538 - 9s - loss: 3.2133 - accuracy1000: 0.4184 - val_loss: 3.4810 - val_accuracy1000: 0.2997 - 9s/epoch - 17ms/step
Epoch 7/50
538/538 - 9s - loss: 3.2005 - accuracy1000: 0.4272 - val_loss: 3.5051 - val_accuracy1000: 0.3024 - 9s/epoch - 17ms/step
Epoch 8/50
538/538 - 9s - loss: 3.1859 - accuracy1000: 0.4337 - val_loss: 3.5430 - val_accuracy1000: 0.3023 - 9s/epoch - 17ms/step
Epoch 9/50
538/538 - 9s - loss: 3.1743 - accuracy1000: 0.4393 - val_loss: 3.5904 - val_accuracy1000: 0.3077 - 9s/epoch - 17ms/step
Epoch 10/50
538/538 - 9s - loss: 3.1673 - accuracy1000: 0.4428 - val_loss: 3.6679 - val_accuracy1000: 0.3077 - 9s/epoch - 17ms/step
Epoch 11/50
538/538 - 9s - loss: 3.1601 - accuracy1000: 0.4438 - val_loss: 3.6973 - val_accuracy1000: 0.3082 - 9s/epoch - 17ms/step
Epoch 12/50
538/538 - 9s - loss: 3.1552 - accuracy1000: 0.4465 - val_loss: 3.7193 - val_accuracy1000: 0.3068 - 9s/epoch - 17ms/step
Epoch 13/50
538/538 - 9s - loss: 3.1453 - accuracy1000: 0.4515 - val_loss: 3.6817 - val_accuracy1000: 0.3066 - 9s/epoch - 17ms/step
Epoch 14/50
538/538 - 9s - loss: 3.1428 - accuracy1000: 0.4513 - val_loss: 3.6583 - val_accuracy1000: 0.3069 - 9s/epoch - 17ms/step
Epoch 15/50
538/538 - 9s - loss: 3.1433 - accuracy1000: 0.4499 - val_loss: 3.6482 - val_accuracy1000: 0.3080 - 9s/epoch - 17ms/step
testing model: results/PCAR/W4/deepLOB_L1/h1000
Evaluating performance on  test set...
1590/1590 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1095223
{'0': {'precision': 0.4607787704022014, 'recall': 0.09065693647191445, 'f1-score': 0.15150557425000158, 'support': 134838}, '1': {'precision': 0.35003336680408387, 'recall': 0.40128413210258757, 'f1-score': 0.37391072618254495, 'support': 139861}, '2': {'precision': 0.3344523843054237, 'recall': 0.5564945274233537, 'f1-score': 0.41780474032625564, 'support': 132296}, 'accuracy': 0.3488249241391172, 'macro avg': {'precision': 0.381754840503903, 'recall': 0.34947853199928525, 'f1-score': 0.3144070135862674, 'support': 406995}, 'weighted avg': {'precision': 0.38165878497806693, 'recall': 0.3488249241391172, 'f1-score': 0.3144955899250383, 'support': 406995}}
[[12224 51305 71309]
 [ 8541 56124 75196]
 [ 5764 52910 73622]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1284347
{'0': {'precision': 0.3437507888824376, 'recall': 0.30207640090509785, 'f1-score': 0.3215689978864343, 'support': 45078}, '1': {'precision': 0.3394906434159286, 'recall': 0.2198834847436441, 'f1-score': 0.2668996721666802, 'support': 44801}, '2': {'precision': 0.34703573342603455, 'recall': 0.5013391922996443, 'f1-score': 0.41015501288207556, 'support': 47790}, 'accuracy': 0.3445002142820824, 'macro avg': {'precision': 0.3434257219081336, 'recall': 0.34109969264946205, 'f1-score': 0.3328745609783967, 'support': 137669}, 'weighted avg': {'precision': 0.3435047547185622, 'recall': 0.3445002142820824, 'f1-score': 0.33452968762102225, 'support': 137669}}
[[13617  8975 22486]
 [12356  9851 22594]
 [13640 10191 23959]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1388962
{'0': {'precision': 0.5, 'recall': 0.0010606060606060607, 'f1-score': 0.0021167221046265497, 'support': 19800}, '1': {'precision': 0.3164703164703165, 'recall': 0.398742650910996, 'f1-score': 0.3528745106119926, 'support': 17179}, '2': {'precision': 0.29847508253419275, 'recall': 0.5748803972627626, 'f1-score': 0.3929384494391324, 'support': 16513}, 'accuracy': 0.30591490316308984, 'macro avg': {'precision': 0.37164846633483634, 'recall': 0.3248945514114549, 'f1-score': 0.24930989405191717, 'support': 53492}, 'weighted avg': {'precision': 0.3788484746229472, 'recall': 0.30591490316308984, 'f1-score': 0.23540968614116914, 'support': 53492}}
[[   21  7783 11996]
 [   13  6850 10316]
 [    8  7012  9493]]
training model: results/PCAR/W4/deepOF_L1/h10
Epoch 1/50
538/538 - 11s - loss: 3.2864 - accuracy10: 0.3843 - val_loss: 3.2416 - val_accuracy10: 0.4035 - 11s/epoch - 21ms/step
Epoch 2/50
538/538 - 8s - loss: 3.2512 - accuracy10: 0.4024 - val_loss: 3.2315 - val_accuracy10: 0.4071 - 8s/epoch - 15ms/step
Epoch 3/50
538/538 - 8s - loss: 3.2406 - accuracy10: 0.4070 - val_loss: 3.2259 - val_accuracy10: 0.4102 - 8s/epoch - 15ms/step
Epoch 4/50
538/538 - 8s - loss: 3.2311 - accuracy10: 0.4113 - val_loss: 3.2227 - val_accuracy10: 0.4129 - 8s/epoch - 15ms/step
Epoch 5/50
538/538 - 8s - loss: 3.2265 - accuracy10: 0.4135 - val_loss: 3.2222 - val_accuracy10: 0.4153 - 8s/epoch - 15ms/step
Epoch 6/50
538/538 - 8s - loss: 3.2238 - accuracy10: 0.4146 - val_loss: 3.2201 - val_accuracy10: 0.4136 - 8s/epoch - 16ms/step
Epoch 7/50
538/538 - 8s - loss: 3.2208 - accuracy10: 0.4158 - val_loss: 3.2188 - val_accuracy10: 0.4164 - 8s/epoch - 15ms/step
Epoch 8/50
538/538 - 8s - loss: 3.2178 - accuracy10: 0.4176 - val_loss: 3.2181 - val_accuracy10: 0.4195 - 8s/epoch - 15ms/step
Epoch 9/50
538/538 - 8s - loss: 3.2154 - accuracy10: 0.4186 - val_loss: 3.2162 - val_accuracy10: 0.4158 - 8s/epoch - 15ms/step
Epoch 10/50
538/538 - 8s - loss: 3.2131 - accuracy10: 0.4202 - val_loss: 3.2160 - val_accuracy10: 0.4175 - 8s/epoch - 15ms/step
Epoch 11/50
538/538 - 8s - loss: 3.2106 - accuracy10: 0.4211 - val_loss: 3.2147 - val_accuracy10: 0.4173 - 8s/epoch - 15ms/step
Epoch 12/50
538/538 - 8s - loss: 3.2087 - accuracy10: 0.4220 - val_loss: 3.2124 - val_accuracy10: 0.4183 - 8s/epoch - 15ms/step
Epoch 13/50
538/538 - 8s - loss: 3.2057 - accuracy10: 0.4219 - val_loss: 3.2135 - val_accuracy10: 0.4177 - 8s/epoch - 15ms/step
Epoch 14/50
538/538 - 8s - loss: 3.2037 - accuracy10: 0.4231 - val_loss: 3.2095 - val_accuracy10: 0.4224 - 8s/epoch - 15ms/step
Epoch 15/50
538/538 - 8s - loss: 3.2028 - accuracy10: 0.4227 - val_loss: 3.2110 - val_accuracy10: 0.4197 - 8s/epoch - 16ms/step
Epoch 16/50
538/538 - 8s - loss: 3.2007 - accuracy10: 0.4237 - val_loss: 3.2126 - val_accuracy10: 0.4212 - 8s/epoch - 15ms/step
Epoch 17/50
538/538 - 8s - loss: 3.1978 - accuracy10: 0.4253 - val_loss: 3.2125 - val_accuracy10: 0.4168 - 8s/epoch - 15ms/step
Epoch 18/50
538/538 - 8s - loss: 3.1972 - accuracy10: 0.4246 - val_loss: 3.2135 - val_accuracy10: 0.4189 - 8s/epoch - 15ms/step
Epoch 19/50
538/538 - 8s - loss: 3.1952 - accuracy10: 0.4265 - val_loss: 3.2105 - val_accuracy10: 0.4206 - 8s/epoch - 15ms/step
Epoch 20/50
538/538 - 8s - loss: 3.1930 - accuracy10: 0.4282 - val_loss: 3.2098 - val_accuracy10: 0.4203 - 8s/epoch - 15ms/step
Epoch 21/50
538/538 - 8s - loss: 3.1904 - accuracy10: 0.4281 - val_loss: 3.2100 - val_accuracy10: 0.4201 - 8s/epoch - 15ms/step
Epoch 22/50
538/538 - 8s - loss: 3.1894 - accuracy10: 0.4306 - val_loss: 3.2112 - val_accuracy10: 0.4211 - 8s/epoch - 15ms/step
Epoch 23/50
538/538 - 8s - loss: 3.1866 - accuracy10: 0.4300 - val_loss: 3.2105 - val_accuracy10: 0.4202 - 8s/epoch - 15ms/step
Epoch 24/50
538/538 - 8s - loss: 3.1849 - accuracy10: 0.4302 - val_loss: 3.2118 - val_accuracy10: 0.4200 - 8s/epoch - 15ms/step
testing model: results/PCAR/W4/deepOF_L1/h10
Evaluating performance on  test set...
1590/1590 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0655317
{'0': {'precision': 0.40412692939393663, 'recall': 0.36368090544590437, 'f1-score': 0.38283862427040083, 'support': 122459}, '1': {'precision': 0.4620704773387406, 'recall': 0.5075365389708892, 'f1-score': 0.483737528471517, 'support': 166124}, '2': {'precision': 0.3925366084081247, 'recall': 0.37897777177217756, 'f1-score': 0.38563804645806654, 'support': 118408}, 'accuracy': 0.4268497337778968, 'macro avg': {'precision': 0.419578005046934, 'recall': 0.416731738729657, 'f1-score': 0.4174047330666615, 'support': 406991}, 'weighted avg': {'precision': 0.42440606881346826, 'recall': 0.4268497337778968, 'f1-score': 0.4248375961000072, 'support': 406991}}
[[44536 51110 26813]
 [39179 84314 42631]
 [26488 47046 44874]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0697789
{'0': {'precision': 0.43786244021902365, 'recall': 0.41099039316461733, 'f1-score': 0.4240010738735514, 'support': 46113}, '1': {'precision': 0.3857420079664998, 'recall': 0.418918319357558, 'f1-score': 0.40164623057862664, 'support': 45078}, '2': {'precision': 0.444055559224284, 'recall': 0.4340519838196058, 'f1-score': 0.43899679016375603, 'support': 46476}, 'accuracy': 0.4213718610850821, 'macro avg': {'precision': 0.42255333580326915, 'recall': 0.42132023211392705, 'f1-score': 0.4215480315386447, 'support': 137667}, 'weighted avg': {'precision': 0.4228867855872616, 'recall': 0.4213718610850821, 'f1-score': 0.42174366493934734, 'support': 137667}}
[[18952 15142 12019]
 [12957 18884 13237]
 [11374 14929 20173]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0702456
{'0': {'precision': 0.4273510022870981, 'recall': 0.3739478486079228, 'f1-score': 0.39886987913985245, 'support': 16989}, '1': {'precision': 0.4189888354361441, 'recall': 0.4667104797532986, 'f1-score': 0.4415640320459165, 'support': 19781}, '2': {'precision': 0.41076487252124644, 'recall': 0.4075713175049339, 'f1-score': 0.4091618635926993, 'support': 16721}, 'accuracy': 0.4187620347348152, 'macro avg': {'precision': 0.4190349034148296, 'recall': 0.41607654862205184, 'f1-score': 0.4165319249261561, 'support': 53491}, 'weighted avg': {'precision': 0.4190739332793486, 'recall': 0.4187620347348152, 'f1-score': 0.41787541858893557, 'support': 53491}}
[[6353 6417 4219]
 [4992 9232 5557]
 [3521 6385 6815]]
training model: results/PCAR/W4/deepOF_L1/h20
Epoch 1/50
538/538 - 10s - loss: 3.2969 - accuracy20: 0.3747 - val_loss: 3.2598 - val_accuracy20: 0.3862 - 10s/epoch - 19ms/step
Epoch 2/50
538/538 - 8s - loss: 3.2651 - accuracy20: 0.3921 - val_loss: 3.2522 - val_accuracy20: 0.3892 - 8s/epoch - 16ms/step
Epoch 3/50
538/538 - 8s - loss: 3.2550 - accuracy20: 0.3951 - val_loss: 3.2454 - val_accuracy20: 0.3941 - 8s/epoch - 15ms/step
Epoch 4/50
538/538 - 8s - loss: 3.2486 - accuracy20: 0.3973 - val_loss: 3.2437 - val_accuracy20: 0.3952 - 8s/epoch - 15ms/step
Epoch 5/50
538/538 - 8s - loss: 3.2458 - accuracy20: 0.3996 - val_loss: 3.2416 - val_accuracy20: 0.3944 - 8s/epoch - 16ms/step
Epoch 6/50
538/538 - 8s - loss: 3.2411 - accuracy20: 0.4023 - val_loss: 3.2397 - val_accuracy20: 0.3970 - 8s/epoch - 15ms/step
Epoch 7/50
538/538 - 8s - loss: 3.2384 - accuracy20: 0.4020 - val_loss: 3.2371 - val_accuracy20: 0.3993 - 8s/epoch - 15ms/step
Epoch 8/50
538/538 - 8s - loss: 3.2357 - accuracy20: 0.4051 - val_loss: 3.2398 - val_accuracy20: 0.3967 - 8s/epoch - 15ms/step
Epoch 9/50
538/538 - 8s - loss: 3.2333 - accuracy20: 0.4044 - val_loss: 3.2371 - val_accuracy20: 0.4005 - 8s/epoch - 15ms/step
Epoch 10/50
538/538 - 8s - loss: 3.2311 - accuracy20: 0.4068 - val_loss: 3.2369 - val_accuracy20: 0.4012 - 8s/epoch - 15ms/step
Epoch 11/50
538/538 - 8s - loss: 3.2301 - accuracy20: 0.4066 - val_loss: 3.2382 - val_accuracy20: 0.4004 - 8s/epoch - 15ms/step
Epoch 12/50
538/538 - 8s - loss: 3.2277 - accuracy20: 0.4094 - val_loss: 3.2348 - val_accuracy20: 0.4003 - 8s/epoch - 15ms/step
Epoch 13/50
538/538 - 8s - loss: 3.2260 - accuracy20: 0.4091 - val_loss: 3.2366 - val_accuracy20: 0.3988 - 8s/epoch - 16ms/step
Epoch 14/50
538/538 - 8s - loss: 3.2255 - accuracy20: 0.4081 - val_loss: 3.2360 - val_accuracy20: 0.4007 - 8s/epoch - 15ms/step
Epoch 15/50
538/538 - 8s - loss: 3.2231 - accuracy20: 0.4098 - val_loss: 3.2346 - val_accuracy20: 0.4027 - 8s/epoch - 15ms/step
Epoch 16/50
538/538 - 8s - loss: 3.2220 - accuracy20: 0.4116 - val_loss: 3.2361 - val_accuracy20: 0.3993 - 8s/epoch - 15ms/step
Epoch 17/50
538/538 - 8s - loss: 3.2200 - accuracy20: 0.4114 - val_loss: 3.2356 - val_accuracy20: 0.3989 - 8s/epoch - 15ms/step
Epoch 18/50
538/538 - 8s - loss: 3.2180 - accuracy20: 0.4126 - val_loss: 3.2378 - val_accuracy20: 0.3993 - 8s/epoch - 15ms/step
Epoch 19/50
538/538 - 8s - loss: 3.2173 - accuracy20: 0.4129 - val_loss: 3.2366 - val_accuracy20: 0.3986 - 8s/epoch - 15ms/step
Epoch 20/50
538/538 - 8s - loss: 3.2151 - accuracy20: 0.4147 - val_loss: 3.2359 - val_accuracy20: 0.3994 - 8s/epoch - 15ms/step
Epoch 21/50
538/538 - 8s - loss: 3.2139 - accuracy20: 0.4134 - val_loss: 3.2355 - val_accuracy20: 0.4016 - 8s/epoch - 16ms/step
Epoch 22/50
538/538 - 8s - loss: 3.2117 - accuracy20: 0.4169 - val_loss: 3.2358 - val_accuracy20: 0.3985 - 8s/epoch - 15ms/step
Epoch 23/50
538/538 - 8s - loss: 3.2095 - accuracy20: 0.4169 - val_loss: 3.2375 - val_accuracy20: 0.3984 - 8s/epoch - 15ms/step
Epoch 24/50
538/538 - 8s - loss: 3.2084 - accuracy20: 0.4172 - val_loss: 3.2393 - val_accuracy20: 0.3988 - 8s/epoch - 15ms/step
Epoch 25/50
538/538 - 8s - loss: 3.2060 - accuracy20: 0.4190 - val_loss: 3.2385 - val_accuracy20: 0.3982 - 8s/epoch - 15ms/step
testing model: results/PCAR/W4/deepOF_L1/h20
Evaluating performance on  test set...
1590/1590 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0764555
{'0': {'precision': 0.3935784085621219, 'recall': 0.4049570289745206, 'f1-score': 0.39918664972842444, 'support': 125317}, '1': {'precision': 0.4289068654184088, 'recall': 0.3515003289922904, 'f1-score': 0.38636472185642834, 'support': 161098}, '2': {'precision': 0.37760825052901176, 'recall': 0.4573132298301486, 'f1-score': 0.4136562604321782, 'support': 120576}, 'accuracy': 0.39930858421930704, 'macro avg': {'precision': 0.4000311748365141, 'recall': 0.4045901959323199, 'f1-score': 0.39973587733901034, 'support': 406991}, 'weighted avg': {'precision': 0.4028310111200011, 'recall': 0.39930858421930704, 'f1-score': 0.3983981822780214, 'support': 406991}}
[[50748 39813 34756]
 [48342 56626 56130]
 [29850 35585 55141]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.075005
{'0': {'precision': 0.4261602518533564, 'recall': 0.4566963411183423, 'f1-score': 0.4409002080312677, 'support': 45943}, '1': {'precision': 0.36631483885533667, 'recall': 0.2851807096561573, 'f1-score': 0.32069574670471535, 'support': 45515}, '2': {'precision': 0.4256198347107438, 'recall': 0.4881516587677725, 'f1-score': 0.45474613686534215, 'support': 46209}, 'accuracy': 0.4105486427393638, 'macro avg': {'precision': 0.40603164180647894, 'recall': 0.41000956984742404, 'f1-score': 0.4054473638671084, 'support': 137667}, 'weighted avg': {'precision': 0.4061929676941326, 'recall': 0.4105486427393638, 'f1-score': 0.4058061075439738, 'support': 137667}}
[[20982 11370 13591]
 [15685 12980 16850]
 [12568 11084 22557]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0782491
{'0': {'precision': 0.4189454251759548, 'recall': 0.42147417295414974, 'f1-score': 0.42020599467654207, 'support': 17230}, '1': {'precision': 0.38873351977626847, 'recall': 0.3067143007250184, 'f1-score': 0.34288734876071886, 'support': 19034}, '2': {'precision': 0.395997918539193, 'recall': 0.485923259998839, 'f1-score': 0.4363759578793724, 'support': 17227}, 'accuracy': 0.40139462713353646, 'macro avg': {'precision': 0.40122562116380545, 'recall': 0.4047039112260024, 'f1-score': 0.39982310043887775, 'support': 53491}, 'weighted avg': {'precision': 0.4008046144936133, 'recall': 0.40139462713353646, 'f1-score': 0.3979008751187357, 'support': 53491}}
[[7262 4557 5411]
 [5839 5838 7357]
 [4233 4623 8371]]
training model: results/PCAR/W4/deepOF_L1/h30
Epoch 1/50
538/538 - 10s - loss: 3.3011 - accuracy30: 0.3691 - val_loss: 3.2780 - val_accuracy30: 0.3774 - 10s/epoch - 19ms/step
Epoch 2/50
538/538 - 8s - loss: 3.2743 - accuracy30: 0.3836 - val_loss: 3.2683 - val_accuracy30: 0.3800 - 8s/epoch - 15ms/step
Epoch 3/50
538/538 - 8s - loss: 3.2624 - accuracy30: 0.3869 - val_loss: 3.2608 - val_accuracy30: 0.3859 - 8s/epoch - 16ms/step
Epoch 4/50
538/538 - 8s - loss: 3.2574 - accuracy30: 0.3891 - val_loss: 3.2596 - val_accuracy30: 0.3851 - 8s/epoch - 15ms/step
Epoch 5/50
538/538 - 8s - loss: 3.2535 - accuracy30: 0.3926 - val_loss: 3.2579 - val_accuracy30: 0.3853 - 8s/epoch - 15ms/step
Epoch 6/50
538/538 - 8s - loss: 3.2499 - accuracy30: 0.3943 - val_loss: 3.2538 - val_accuracy30: 0.3890 - 8s/epoch - 15ms/step
Epoch 7/50
538/538 - 8s - loss: 3.2481 - accuracy30: 0.3959 - val_loss: 3.2525 - val_accuracy30: 0.3887 - 8s/epoch - 16ms/step
Epoch 8/50
538/538 - 8s - loss: 3.2459 - accuracy30: 0.3968 - val_loss: 3.2515 - val_accuracy30: 0.3889 - 8s/epoch - 15ms/step
Epoch 9/50
538/538 - 8s - loss: 3.2429 - accuracy30: 0.3986 - val_loss: 3.2516 - val_accuracy30: 0.3894 - 8s/epoch - 15ms/step
Epoch 10/50
538/538 - 8s - loss: 3.2416 - accuracy30: 0.3995 - val_loss: 3.2509 - val_accuracy30: 0.3886 - 8s/epoch - 15ms/step
Epoch 11/50
538/538 - 8s - loss: 3.2394 - accuracy30: 0.4016 - val_loss: 3.2509 - val_accuracy30: 0.3886 - 8s/epoch - 15ms/step
Epoch 12/50
538/538 - 8s - loss: 3.2381 - accuracy30: 0.4024 - val_loss: 3.2508 - val_accuracy30: 0.3901 - 8s/epoch - 15ms/step
Epoch 13/50
538/538 - 8s - loss: 3.2367 - accuracy30: 0.4033 - val_loss: 3.2499 - val_accuracy30: 0.3911 - 8s/epoch - 15ms/step
Epoch 14/50
538/538 - 8s - loss: 3.2346 - accuracy30: 0.4047 - val_loss: 3.2493 - val_accuracy30: 0.3911 - 8s/epoch - 15ms/step
Epoch 15/50
538/538 - 8s - loss: 3.2336 - accuracy30: 0.4057 - val_loss: 3.2475 - val_accuracy30: 0.3937 - 8s/epoch - 15ms/step
Epoch 16/50
538/538 - 8s - loss: 3.2315 - accuracy30: 0.4061 - val_loss: 3.2478 - val_accuracy30: 0.3920 - 8s/epoch - 15ms/step
Epoch 17/50
538/538 - 8s - loss: 3.2290 - accuracy30: 0.4086 - val_loss: 3.2493 - val_accuracy30: 0.3922 - 8s/epoch - 15ms/step
Epoch 18/50
538/538 - 8s - loss: 3.2284 - accuracy30: 0.4088 - val_loss: 3.2510 - val_accuracy30: 0.3911 - 8s/epoch - 15ms/step
Epoch 19/50
538/538 - 8s - loss: 3.2269 - accuracy30: 0.4093 - val_loss: 3.2512 - val_accuracy30: 0.3912 - 8s/epoch - 15ms/step
Epoch 20/50
538/538 - 8s - loss: 3.2254 - accuracy30: 0.4099 - val_loss: 3.2501 - val_accuracy30: 0.3908 - 8s/epoch - 15ms/step
Epoch 21/50
538/538 - 8s - loss: 3.2241 - accuracy30: 0.4107 - val_loss: 3.2521 - val_accuracy30: 0.3898 - 8s/epoch - 15ms/step
Epoch 22/50
538/538 - 8s - loss: 3.2220 - accuracy30: 0.4121 - val_loss: 3.2512 - val_accuracy30: 0.3913 - 8s/epoch - 15ms/step
Epoch 23/50
538/538 - 8s - loss: 3.2207 - accuracy30: 0.4131 - val_loss: 3.2523 - val_accuracy30: 0.3918 - 8s/epoch - 15ms/step
Epoch 24/50
538/538 - 8s - loss: 3.2185 - accuracy30: 0.4137 - val_loss: 3.2529 - val_accuracy30: 0.3910 - 8s/epoch - 15ms/step
Epoch 25/50
538/538 - 8s - loss: 3.2163 - accuracy30: 0.4146 - val_loss: 3.2533 - val_accuracy30: 0.3912 - 8s/epoch - 16ms/step
testing model: results/PCAR/W4/deepOF_L1/h30
Evaluating performance on  test set...
1590/1590 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0821897
{'0': {'precision': 0.3940208495958502, 'recall': 0.4820365507096814, 'f1-score': 0.43360732111992073, 'support': 129847}, '1': {'precision': 0.39803666341251764, 'recall': 0.14573170328106488, 'f1-score': 0.21335025897196125, 'support': 151079}, '2': {'precision': 0.3665447945027875, 'recall': 0.5606552175465038, 'f1-score': 0.44328138229483516, 'support': 126065}, 'accuracy': 0.3815489777415225, 'macro avg': {'precision': 0.3862007691703851, 'recall': 0.3961411571790834, 'f1-score': 0.3634129874622391, 'support': 406991}, 'weighted avg': {'precision': 0.3870008817103228, 'recall': 0.3815489777415225, 'f1-score': 0.35484229641363496, 'support': 406991}}
[[62591 16684 50572]
 [57488 22017 71574]
 [38773 16613 70679]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0772982
{'0': {'precision': 0.4182229971419841, 'recall': 0.503298795128599, 'f1-score': 0.456833755473091, 'support': 46229}, '1': {'precision': 0.36868141240689145, 'recall': 0.1441401387159879, 'f1-score': 0.20725256109060108, 'support': 44984}, '2': {'precision': 0.40718730119322855, 'recall': 0.5649029147113274, 'f1-score': 0.4732509174849641, 'support': 46454}, 'accuracy': 0.40672782874617736, 'macro avg': {'precision': 0.39803057024736804, 'recall': 0.4041139495186381, 'f1-score': 0.3791124113495521, 'support': 137667}, 'weighted avg': {'precision': 0.39831095673050637, 'recall': 0.40672782874617736, 'f1-score': 0.38082049445917787, 'support': 137667}}
[[23267  5464 17498]
 [17793  6484 20707]
 [14573  5639 26242]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.082191
{'0': {'precision': 0.40603034562993845, 'recall': 0.47914879011498196, 'f1-score': 0.4395696667541328, 'support': 17481}, '1': {'precision': 0.3653061224489796, 'recall': 0.12651552220953624, 'f1-score': 0.18794168719460486, 'support': 18393}, '2': {'precision': 0.38940057375811565, 'recall': 0.5855707555202362, 'f1-score': 0.46775034573443064, 'support': 17617}, 'accuracy': 0.3929446075040661, 'macro avg': {'precision': 0.38691234727901125, 'recall': 0.3970783559482515, 'f1-score': 0.3650872332277227, 'support': 53491}, 'weighted avg': {'precision': 0.3865502961256615, 'recall': 0.3929446075040661, 'f1-score': 0.36232799233334256, 'support': 53491}}
[[ 8376  1996  7109]
 [ 6999  2327  9067]
 [ 5254  2047 10316]]
training model: results/PCAR/W4/deepOF_L1/h50
Epoch 1/50
538/538 - 10s - loss: 3.3038 - accuracy50: 0.3712 - val_loss: 3.2837 - val_accuracy50: 0.3624 - 10s/epoch - 19ms/step
Epoch 2/50
538/538 - 8s - loss: 3.2751 - accuracy50: 0.3865 - val_loss: 3.2751 - val_accuracy50: 0.3631 - 8s/epoch - 16ms/step
Epoch 3/50
538/538 - 8s - loss: 3.2640 - accuracy50: 0.3911 - val_loss: 3.2688 - val_accuracy50: 0.3703 - 8s/epoch - 15ms/step
Epoch 4/50
538/538 - 8s - loss: 3.2601 - accuracy50: 0.3942 - val_loss: 3.2665 - val_accuracy50: 0.3714 - 8s/epoch - 16ms/step
Epoch 5/50
538/538 - 8s - loss: 3.2567 - accuracy50: 0.3958 - val_loss: 3.2635 - val_accuracy50: 0.3747 - 8s/epoch - 15ms/step
Epoch 6/50
538/538 - 8s - loss: 3.2544 - accuracy50: 0.3958 - val_loss: 3.2621 - val_accuracy50: 0.3768 - 8s/epoch - 15ms/step
Epoch 7/50
538/538 - 8s - loss: 3.2519 - accuracy50: 0.3962 - val_loss: 3.2610 - val_accuracy50: 0.3792 - 8s/epoch - 15ms/step
Epoch 8/50
538/538 - 8s - loss: 3.2518 - accuracy50: 0.3968 - val_loss: 3.2587 - val_accuracy50: 0.3788 - 8s/epoch - 15ms/step
Epoch 9/50
538/538 - 8s - loss: 3.2500 - accuracy50: 0.3977 - val_loss: 3.2583 - val_accuracy50: 0.3821 - 8s/epoch - 15ms/step
Epoch 10/50
538/538 - 8s - loss: 3.2485 - accuracy50: 0.3987 - val_loss: 3.2603 - val_accuracy50: 0.3807 - 8s/epoch - 15ms/step
Epoch 11/50
538/538 - 8s - loss: 3.2464 - accuracy50: 0.3992 - val_loss: 3.2586 - val_accuracy50: 0.3822 - 8s/epoch - 16ms/step
Epoch 12/50
538/538 - 8s - loss: 3.2450 - accuracy50: 0.4007 - val_loss: 3.2588 - val_accuracy50: 0.3834 - 8s/epoch - 15ms/step
Epoch 13/50
538/538 - 8s - loss: 3.2444 - accuracy50: 0.4004 - val_loss: 3.2579 - val_accuracy50: 0.3843 - 8s/epoch - 15ms/step
Epoch 14/50
538/538 - 8s - loss: 3.2424 - accuracy50: 0.4011 - val_loss: 3.2563 - val_accuracy50: 0.3856 - 8s/epoch - 16ms/step
Epoch 15/50
538/538 - 8s - loss: 3.2416 - accuracy50: 0.4024 - val_loss: 3.2582 - val_accuracy50: 0.3847 - 8s/epoch - 15ms/step
Epoch 16/50
538/538 - 8s - loss: 3.2396 - accuracy50: 0.4033 - val_loss: 3.2576 - val_accuracy50: 0.3853 - 8s/epoch - 15ms/step
Epoch 17/50
538/538 - 8s - loss: 3.2378 - accuracy50: 0.4034 - val_loss: 3.2594 - val_accuracy50: 0.3801 - 8s/epoch - 15ms/step
Epoch 18/50
538/538 - 8s - loss: 3.2362 - accuracy50: 0.4052 - val_loss: 3.2592 - val_accuracy50: 0.3849 - 8s/epoch - 15ms/step
Epoch 19/50
538/538 - 8s - loss: 3.2345 - accuracy50: 0.4076 - val_loss: 3.2601 - val_accuracy50: 0.3818 - 8s/epoch - 15ms/step
Epoch 20/50
538/538 - 8s - loss: 3.2332 - accuracy50: 0.4072 - val_loss: 3.2595 - val_accuracy50: 0.3845 - 8s/epoch - 15ms/step
Epoch 21/50
538/538 - 8s - loss: 3.2319 - accuracy50: 0.4080 - val_loss: 3.2587 - val_accuracy50: 0.3837 - 8s/epoch - 15ms/step
Epoch 22/50
538/538 - 8s - loss: 3.2315 - accuracy50: 0.4091 - val_loss: 3.2605 - val_accuracy50: 0.3845 - 8s/epoch - 15ms/step
Epoch 23/50
538/538 - 8s - loss: 3.2284 - accuracy50: 0.4103 - val_loss: 3.2617 - val_accuracy50: 0.3833 - 8s/epoch - 15ms/step
Epoch 24/50
538/538 - 8s - loss: 3.2271 - accuracy50: 0.4120 - val_loss: 3.2610 - val_accuracy50: 0.3836 - 8s/epoch - 15ms/step
testing model: results/PCAR/W4/deepOF_L1/h50
Evaluating performance on  test set...
1590/1590 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.082562
{'0': {'precision': 0.3660770634690501, 'recall': 0.35785507053056326, 'f1-score': 0.36191937673375435, 'support': 119948}, '1': {'precision': 0.42387789419221317, 'recall': 0.3290588193599452, 'f1-score': 0.37049796325546597, 'support': 169298}, '2': {'precision': 0.34089444760280463, 'recall': 0.4583379336702195, 'f1-score': 0.39098730325478614, 'support': 117745}, 'accuracy': 0.37494686614691725, 'macro avg': {'precision': 0.3769498017546893, 'recall': 0.381750607853576, 'f1-score': 0.37446821441466877, 'support': 406991}, 'weighted avg': {'precision': 0.38283526680671354, 'recall': 0.37494686614691725, 'f1-score': 0.3738973825107165, 'support': 406991}}
[[42924 38971 38053]
 [47299 55709 66290]
 [27031 36747 53967]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0829575
{'0': {'precision': 0.4200529311192824, 'recall': 0.39023063533507396, 'f1-score': 0.40459298194164023, 'support': 45960}, '1': {'precision': 0.34940042323066073, 'recall': 0.32754364309645567, 'f1-score': 0.33811918359917176, 'support': 45368}, '2': {'precision': 0.4084096109839817, 'recall': 0.46218088435227345, 'f1-score': 0.4336346794359125, 'support': 46339}, 'accuracy': 0.3937908140658255, 'macro avg': {'precision': 0.3926209884446416, 'recall': 0.39331838759460097, 'f1-score': 0.3921156149922415, 'support': 137667}, 'weighted avg': {'precision': 0.39285031328319464, 'recall': 0.3937908140658255, 'f1-score': 0.3924621149726932, 'support': 137667}}
[[17935 13938 14087]
 [13572 14860 16936]
 [11190 13732 21417]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0859039
{'0': {'precision': 0.4051513200257566, 'recall': 0.3605317442126977, 'f1-score': 0.38154144684979685, 'support': 17452}, '1': {'precision': 0.35737398879900434, 'recall': 0.3075398950412338, 'f1-score': 0.33058945429426656, 'support': 18674}, '2': {'precision': 0.38472431592892053, 'recall': 0.4849985603224878, 'f1-score': 0.4290809048298349, 'support': 17365}, 'accuracy': 0.3824381671683087, 'macro avg': {'precision': 0.38241654158456057, 'recall': 0.38435673319213975, 'f1-score': 0.38040393532463274, 'support': 53491}, 'weighted avg': {'precision': 0.381840691892614, 'recall': 0.3824381671683087, 'f1-score': 0.3791867550108219, 'support': 53491}}
[[6292 5280 5880]
 [5342 5743 7589]
 [3896 5047 8422]]
training model: results/PCAR/W4/deepOF_L1/h100
Epoch 1/50
538/538 - 10s - loss: 3.3260 - accuracy100: 0.3493 - val_loss: 3.3145 - val_accuracy100: 0.3525 - 10s/epoch - 19ms/step
Epoch 2/50
538/538 - 8s - loss: 3.3021 - accuracy100: 0.3590 - val_loss: 3.3037 - val_accuracy100: 0.3537 - 8s/epoch - 15ms/step
Epoch 3/50
538/538 - 8s - loss: 3.2910 - accuracy100: 0.3640 - val_loss: 3.2983 - val_accuracy100: 0.3545 - 8s/epoch - 15ms/step
Epoch 4/50
538/538 - 8s - loss: 3.2860 - accuracy100: 0.3655 - val_loss: 3.2939 - val_accuracy100: 0.3577 - 8s/epoch - 15ms/step
Epoch 5/50
538/538 - 8s - loss: 3.2819 - accuracy100: 0.3696 - val_loss: 3.2897 - val_accuracy100: 0.3609 - 8s/epoch - 15ms/step
Epoch 6/50
538/538 - 8s - loss: 3.2802 - accuracy100: 0.3693 - val_loss: 3.2880 - val_accuracy100: 0.3614 - 8s/epoch - 15ms/step
Epoch 7/50
538/538 - 8s - loss: 3.2772 - accuracy100: 0.3726 - val_loss: 3.2866 - val_accuracy100: 0.3633 - 8s/epoch - 15ms/step
Epoch 8/50
538/538 - 8s - loss: 3.2759 - accuracy100: 0.3729 - val_loss: 3.2846 - val_accuracy100: 0.3659 - 8s/epoch - 16ms/step
Epoch 9/50
538/538 - 8s - loss: 3.2734 - accuracy100: 0.3756 - val_loss: 3.2846 - val_accuracy100: 0.3666 - 8s/epoch - 16ms/step
Epoch 10/50
538/538 - 8s - loss: 3.2724 - accuracy100: 0.3747 - val_loss: 3.2848 - val_accuracy100: 0.3652 - 8s/epoch - 15ms/step
Epoch 11/50
538/538 - 8s - loss: 3.2708 - accuracy100: 0.3759 - val_loss: 3.2827 - val_accuracy100: 0.3665 - 8s/epoch - 15ms/step
Epoch 12/50
538/538 - 8s - loss: 3.2690 - accuracy100: 0.3771 - val_loss: 3.2843 - val_accuracy100: 0.3643 - 8s/epoch - 15ms/step
Epoch 13/50
538/538 - 8s - loss: 3.2688 - accuracy100: 0.3787 - val_loss: 3.2819 - val_accuracy100: 0.3684 - 8s/epoch - 15ms/step
Epoch 14/50
538/538 - 8s - loss: 3.2675 - accuracy100: 0.3786 - val_loss: 3.2836 - val_accuracy100: 0.3642 - 8s/epoch - 15ms/step
Epoch 15/50
538/538 - 8s - loss: 3.2655 - accuracy100: 0.3808 - val_loss: 3.2834 - val_accuracy100: 0.3667 - 8s/epoch - 15ms/step
Epoch 16/50
538/538 - 8s - loss: 3.2650 - accuracy100: 0.3824 - val_loss: 3.2847 - val_accuracy100: 0.3652 - 8s/epoch - 15ms/step
Epoch 17/50
538/538 - 8s - loss: 3.2633 - accuracy100: 0.3833 - val_loss: 3.2832 - val_accuracy100: 0.3654 - 8s/epoch - 15ms/step
Epoch 18/50
538/538 - 8s - loss: 3.2618 - accuracy100: 0.3823 - val_loss: 3.2846 - val_accuracy100: 0.3671 - 8s/epoch - 15ms/step
Epoch 19/50
538/538 - 8s - loss: 3.2608 - accuracy100: 0.3851 - val_loss: 3.2830 - val_accuracy100: 0.3671 - 8s/epoch - 15ms/step
Epoch 20/50
538/538 - 8s - loss: 3.2595 - accuracy100: 0.3857 - val_loss: 3.2839 - val_accuracy100: 0.3664 - 8s/epoch - 16ms/step
Epoch 21/50
538/538 - 8s - loss: 3.2584 - accuracy100: 0.3871 - val_loss: 3.2847 - val_accuracy100: 0.3671 - 8s/epoch - 15ms/step
Epoch 22/50
538/538 - 8s - loss: 3.2574 - accuracy100: 0.3882 - val_loss: 3.2849 - val_accuracy100: 0.3668 - 8s/epoch - 15ms/step
Epoch 23/50
538/538 - 8s - loss: 3.2547 - accuracy100: 0.3889 - val_loss: 3.2875 - val_accuracy100: 0.3666 - 8s/epoch - 15ms/step
testing model: results/PCAR/W4/deepOF_L1/h100
Evaluating performance on  test set...
1590/1590 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0946658
{'0': {'precision': 0.36752968925701435, 'recall': 0.41502713835528404, 'f1-score': 0.38983698003978223, 'support': 129153}, '1': {'precision': 0.3870374480768621, 'recall': 0.08062300192871674, 'f1-score': 0.13344776502872635, 'support': 151396}, '2': {'precision': 0.3386133008144245, 'recall': 0.6148985305515572, 'f1-score': 0.43672834305101504, 'support': 126442}, 'accuracy': 0.352727701595367, 'macro avg': {'precision': 0.364393479382767, 'recall': 0.3701828902785193, 'f1-score': 0.32000436270650784, 'support': 406991}, 'weighted avg': {'precision': 0.3658027485306389, 'recall': 0.352727701595367, 'f1-score': 0.3090311050353042, 'support': 406991}}
[[53602  9589 65962]
 [53291 12206 85899]
 [38951  9742 77749]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0885389
{'0': {'precision': 0.3929408027950927, 'recall': 0.4338886453309952, 'f1-score': 0.4124007750484405, 'support': 45620}, '1': {'precision': 0.3763313609467456, 'recall': 0.0978741178798338, 'f1-score': 0.15534658129350803, 'support': 45487}, '2': {'precision': 0.37679392549991386, 'recall': 0.6106958762886598, 'f1-score': 0.46604328692131813, 'support': 46560}, 'accuracy': 0.3826625117130467, 'macro avg': {'precision': 0.3820220297472507, 'recall': 0.38081954649982963, 'f1-score': 0.3445968810877556, 'support': 137667}, 'weighted avg': {'precision': 0.38199182963362854, 'recall': 0.3826625117130467, 'f1-score': 0.3456089603177539, 'support': 137667}}
[[19794  3631 22195]
 [16201  4452 24834]
 [14379  3747 28434]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0935158
{'0': {'precision': 0.381665699667704, 'recall': 0.40318716219981054, 'f1-score': 0.3921313607543489, 'support': 17947}, '1': {'precision': 0.3697411003236246, 'recall': 0.07495899398578458, 'f1-score': 0.12464769524502227, 'support': 18290}, '2': {'precision': 0.3562483778873605, 'recall': 0.6364321316796105, 'f1-score': 0.4567993676941637, 'support': 17254}, 'accuracy': 0.36619244358864106, 'macro avg': {'precision': 0.36921839262622963, 'recall': 0.3715260959550686, 'f1-score': 0.32452614123117823, 'support': 53491}, 'weighted avg': {'precision': 0.3693897767647622, 'recall': 0.36619244358864106, 'f1-score': 0.3215308027085838, 'support': 53491}}
[[ 7236  1222  9489]
 [ 6565  1371 10354]
 [ 5158  1115 10981]]
training model: results/PCAR/W4/deepOF_L1/h200
Epoch 1/50
538/538 - 11s - loss: 3.3393 - accuracy200: 0.3383 - val_loss: 3.3168 - val_accuracy200: 0.3413 - 11s/epoch - 20ms/step
Epoch 2/50
538/538 - 8s - loss: 3.3151 - accuracy200: 0.3471 - val_loss: 3.3134 - val_accuracy200: 0.3418 - 8s/epoch - 16ms/step
Epoch 3/50
538/538 - 8s - loss: 3.3047 - accuracy200: 0.3519 - val_loss: 3.3079 - val_accuracy200: 0.3429 - 8s/epoch - 15ms/step
Epoch 4/50
538/538 - 8s - loss: 3.2998 - accuracy200: 0.3538 - val_loss: 3.3035 - val_accuracy200: 0.3452 - 8s/epoch - 15ms/step
Epoch 5/50
538/538 - 8s - loss: 3.2953 - accuracy200: 0.3565 - val_loss: 3.3026 - val_accuracy200: 0.3456 - 8s/epoch - 15ms/step
Epoch 6/50
538/538 - 8s - loss: 3.2929 - accuracy200: 0.3572 - val_loss: 3.3018 - val_accuracy200: 0.3484 - 8s/epoch - 16ms/step
Epoch 7/50
538/538 - 8s - loss: 3.2904 - accuracy200: 0.3589 - val_loss: 3.2997 - val_accuracy200: 0.3501 - 8s/epoch - 16ms/step
Epoch 8/50
538/538 - 8s - loss: 3.2882 - accuracy200: 0.3616 - val_loss: 3.2996 - val_accuracy200: 0.3512 - 8s/epoch - 16ms/step
Epoch 9/50
538/538 - 8s - loss: 3.2867 - accuracy200: 0.3620 - val_loss: 3.2980 - val_accuracy200: 0.3543 - 8s/epoch - 15ms/step
Epoch 10/50
538/538 - 8s - loss: 3.2851 - accuracy200: 0.3634 - val_loss: 3.2984 - val_accuracy200: 0.3538 - 8s/epoch - 16ms/step
Epoch 11/50
538/538 - 8s - loss: 3.2835 - accuracy200: 0.3635 - val_loss: 3.2974 - val_accuracy200: 0.3549 - 8s/epoch - 15ms/step
Epoch 12/50
538/538 - 8s - loss: 3.2824 - accuracy200: 0.3642 - val_loss: 3.2983 - val_accuracy200: 0.3551 - 8s/epoch - 15ms/step
Epoch 13/50
538/538 - 8s - loss: 3.2822 - accuracy200: 0.3659 - val_loss: 3.2974 - val_accuracy200: 0.3550 - 8s/epoch - 16ms/step
Epoch 14/50
538/538 - 8s - loss: 3.2805 - accuracy200: 0.3666 - val_loss: 3.2981 - val_accuracy200: 0.3519 - 8s/epoch - 15ms/step
Epoch 15/50
538/538 - 8s - loss: 3.2799 - accuracy200: 0.3675 - val_loss: 3.2997 - val_accuracy200: 0.3551 - 8s/epoch - 16ms/step
Epoch 16/50
538/538 - 8s - loss: 3.2780 - accuracy200: 0.3698 - val_loss: 3.2978 - val_accuracy200: 0.3558 - 8s/epoch - 15ms/step
Epoch 17/50
538/538 - 8s - loss: 3.2782 - accuracy200: 0.3698 - val_loss: 3.2987 - val_accuracy200: 0.3538 - 8s/epoch - 16ms/step
Epoch 18/50
538/538 - 8s - loss: 3.2757 - accuracy200: 0.3722 - val_loss: 3.2985 - val_accuracy200: 0.3536 - 8s/epoch - 15ms/step
Epoch 19/50
538/538 - 8s - loss: 3.2756 - accuracy200: 0.3714 - val_loss: 3.2986 - val_accuracy200: 0.3536 - 8s/epoch - 15ms/step
Epoch 20/50
538/538 - 8s - loss: 3.2738 - accuracy200: 0.3743 - val_loss: 3.3006 - val_accuracy200: 0.3551 - 8s/epoch - 15ms/step
Epoch 21/50
538/538 - 8s - loss: 3.2725 - accuracy200: 0.3745 - val_loss: 3.2992 - val_accuracy200: 0.3518 - 8s/epoch - 16ms/step
testing model: results/PCAR/W4/deepOF_L1/h200
Evaluating performance on  test set...
1590/1590 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0975707
{'0': {'precision': 0.35327915859636216, 'recall': 0.25194462450226873, 'f1-score': 0.2941285106191302, 'support': 129588}, '1': {'precision': 0.3757154434483108, 'recall': 0.1949346297877932, 'f1-score': 0.25668953465235184, 'support': 152210}, '2': {'precision': 0.3225991290396516, 'recall': 0.6071026335338238, 'f1-score': 0.4213195859144389, 'support': 125193}, 'accuracy': 0.3398723804703298, 'macro avg': {'precision': 0.3505312436947749, 'recall': 0.35132729594129525, 'f1-score': 0.32404587706197363, 'support': 406991}, 'weighted avg': {'precision': 0.35223270296717585, 'recall': 0.3398723804703298, 'f1-score': 0.3192515373139275, 'support': 406991}}
[[32649 25486 71453]
 [34395 29671 88144]
 [25373 23815 76005]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0934247
{'0': {'precision': 0.3784675546865453, 'recall': 0.2724793243005455, 'f1-score': 0.31684485139904855, 'support': 45464}, '1': {'precision': 0.3573138616231745, 'recall': 0.1974293399179858, 'f1-score': 0.2543311559216132, 'support': 45358}, '2': {'precision': 0.36625643208593645, 'recall': 0.6244850037357242, 'f1-score': 0.46171814580406895, 'support': 46845}, 'accuracy': 0.3675317977438311, 'macro avg': {'precision': 0.36734594946521876, 'recall': 0.3647978893180852, 'f1-score': 0.3442980510415769, 'support': 137667}, 'weighted avg': {'precision': 0.367342744469181, 'recall': 0.3675317977438311, 'f1-score': 0.34554521733233445, 'support': 137667}}
[[12388  8259 24817]
 [10601  8955 25802]
 [ 9743  7848 29254]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0983129
{'0': {'precision': 0.39238205403618936, 'recall': 0.24942226890756303, 'f1-score': 0.3049802523841633, 'support': 19040}, '1': {'precision': 0.3315433358393298, 'recall': 0.18106633820165405, 'f1-score': 0.23421851289833076, 'support': 17049}, '2': {'precision': 0.3436418617701157, 'recall': 0.6334329387426733, 'f1-score': 0.4455627640008893, 'support': 17402}, 'accuracy': 0.3525639827260661, 'macro avg': {'precision': 0.35585575054854496, 'recall': 0.3546405152839635, 'f1-score': 0.3282538430944611, 'support': 53491}, 'weighted avg': {'precision': 0.35713470154039617, 'recall': 0.3525639827260661, 'f1-score': 0.32816172161562857, 'support': 53491}}
[[ 4749  3372 10919]
 [ 3827  3087 10135]
 [ 3527  2852 11023]]
training model: results/PCAR/W4/deepOF_L1/h300
Epoch 1/50
538/538 - 10s - loss: 3.3398 - accuracy300: 0.3386 - val_loss: 3.3305 - val_accuracy300: 0.3324 - 10s/epoch - 18ms/step
Epoch 2/50
538/538 - 8s - loss: 3.3159 - accuracy300: 0.3455 - val_loss: 3.3215 - val_accuracy300: 0.3324 - 8s/epoch - 15ms/step
Epoch 3/50
538/538 - 8s - loss: 3.3070 - accuracy300: 0.3475 - val_loss: 3.3171 - val_accuracy300: 0.3324 - 8s/epoch - 16ms/step
Epoch 4/50
538/538 - 8s - loss: 3.3020 - accuracy300: 0.3481 - val_loss: 3.3113 - val_accuracy300: 0.3352 - 8s/epoch - 15ms/step
Epoch 5/50
538/538 - 9s - loss: 3.2975 - accuracy300: 0.3516 - val_loss: 3.3088 - val_accuracy300: 0.3389 - 9s/epoch - 16ms/step
Epoch 6/50
538/538 - 8s - loss: 3.2956 - accuracy300: 0.3520 - val_loss: 3.3079 - val_accuracy300: 0.3366 - 8s/epoch - 16ms/step
Epoch 7/50
538/538 - 8s - loss: 3.2927 - accuracy300: 0.3532 - val_loss: 3.3077 - val_accuracy300: 0.3388 - 8s/epoch - 15ms/step
Epoch 8/50
538/538 - 8s - loss: 3.2912 - accuracy300: 0.3533 - val_loss: 3.3060 - val_accuracy300: 0.3385 - 8s/epoch - 16ms/step
Epoch 9/50
538/538 - 8s - loss: 3.2898 - accuracy300: 0.3568 - val_loss: 3.3060 - val_accuracy300: 0.3339 - 8s/epoch - 16ms/step
Epoch 10/50
538/538 - 8s - loss: 3.2883 - accuracy300: 0.3579 - val_loss: 3.3055 - val_accuracy300: 0.3367 - 8s/epoch - 16ms/step
Epoch 11/50
538/538 - 8s - loss: 3.2872 - accuracy300: 0.3591 - val_loss: 3.3066 - val_accuracy300: 0.3369 - 8s/epoch - 15ms/step
Epoch 12/50
538/538 - 8s - loss: 3.2859 - accuracy300: 0.3608 - val_loss: 3.3059 - val_accuracy300: 0.3388 - 8s/epoch - 15ms/step
Epoch 13/50
538/538 - 8s - loss: 3.2849 - accuracy300: 0.3618 - val_loss: 3.3060 - val_accuracy300: 0.3374 - 8s/epoch - 15ms/step
Epoch 14/50
538/538 - 8s - loss: 3.2842 - accuracy300: 0.3625 - val_loss: 3.3069 - val_accuracy300: 0.3369 - 8s/epoch - 15ms/step
Epoch 15/50
538/538 - 8s - loss: 3.2829 - accuracy300: 0.3633 - val_loss: 3.3074 - val_accuracy300: 0.3367 - 8s/epoch - 16ms/step
Epoch 16/50
538/538 - 8s - loss: 3.2820 - accuracy300: 0.3637 - val_loss: 3.3078 - val_accuracy300: 0.3380 - 8s/epoch - 15ms/step
Epoch 17/50
538/538 - 8s - loss: 3.2805 - accuracy300: 0.3652 - val_loss: 3.3069 - val_accuracy300: 0.3384 - 8s/epoch - 15ms/step
Epoch 18/50
538/538 - 8s - loss: 3.2811 - accuracy300: 0.3652 - val_loss: 3.3062 - val_accuracy300: 0.3387 - 8s/epoch - 16ms/step
Epoch 19/50
538/538 - 8s - loss: 3.2794 - accuracy300: 0.3662 - val_loss: 3.3082 - val_accuracy300: 0.3353 - 8s/epoch - 15ms/step
Epoch 20/50
538/538 - 8s - loss: 3.2774 - accuracy300: 0.3683 - val_loss: 3.3098 - val_accuracy300: 0.3388 - 8s/epoch - 15ms/step
testing model: results/PCAR/W4/deepOF_L1/h300
Evaluating performance on  test set...
1590/1590 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988449
{'0': {'precision': 0.3471232777637146, 'recall': 0.1457363870311468, 'f1-score': 0.20528558520506637, 'support': 131731}, '1': {'precision': 0.36228554670316243, 'recall': 0.30162982657234516, 'f1-score': 0.3291869145388666, 'support': 147439}, '2': {'precision': 0.3213937824060525, 'recall': 0.5756252884893719, 'f1-score': 0.41248262098040095, 'support': 127821}, 'accuracy': 0.33722367325075986, 'macro avg': {'precision': 0.34360086895764314, 'recall': 0.340997167364288, 'f1-score': 0.3156517069081113, 'support': 406991}, 'weighted avg': {'precision': 0.3445353579916595, 'recall': 0.33722367325075986, 'f1-score': 0.3152438408065053, 'support': 406991}}
[[19198 40231 72302]
 [19915 44472 83052]
 [16193 38051 73577]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0951388
{'0': {'precision': 0.37462572951027656, 'recall': 0.16344152681220386, 'f1-score': 0.22759014043255074, 'support': 45166}, '1': {'precision': 0.35031650088049116, 'recall': 0.32362381287372494, 'f1-score': 0.3364415495371957, 'support': 45488}, '2': {'precision': 0.36107453252567817, 'recall': 0.5832429328058196, 'f1-score': 0.44602409050612835, 'support': 47013}, 'accuracy': 0.3597303638489979, 'macro avg': {'precision': 0.3620055876388153, 'recall': 0.35676942416391616, 'f1-score': 0.33668526015862493, 'support': 137667}, 'weighted avg': {'precision': 0.3619657556912161, 'recall': 0.3597303638489979, 'f1-score': 0.33815162715167146, 'support': 137667}}
[[ 7382 13785 23999]
 [ 6246 14721 24521]
 [ 6077 13516 27420]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1004642
{'0': {'precision': 0.38032100488485693, 'recall': 0.143037110912813, 'f1-score': 0.2078883124809277, 'support': 19051}, '1': {'precision': 0.3253106605624591, 'recall': 0.28424481398937085, 'f1-score': 0.3033944310591967, 'support': 17499}, '2': {'precision': 0.33010052841861065, 'recall': 0.6047458827696122, 'f1-score': 0.4270796423286158, 'support': 16941}, 'accuracy': 0.3354583013964966, 'macro avg': {'precision': 0.3452440646219756, 'recall': 0.344009269223932, 'f1-score': 0.31278746195624674, 'support': 53491}, 'weighted avg': {'precision': 0.3464197671605235, 'recall': 0.3354583013964966, 'f1-score': 0.3085516369271114, 'support': 53491}}
[[ 2725  5658 10668]
 [ 2402  4974 10123]
 [ 2038  4658 10245]]
training model: results/PCAR/W4/deepOF_L1/h500
Epoch 1/50
538/538 - 10s - loss: 3.3417 - accuracy500: 0.3379 - val_loss: 3.3414 - val_accuracy500: 0.3277 - 10s/epoch - 19ms/step
Epoch 2/50
538/538 - 8s - loss: 3.3206 - accuracy500: 0.3403 - val_loss: 3.3251 - val_accuracy500: 0.3319 - 8s/epoch - 15ms/step
Epoch 3/50
538/538 - 8s - loss: 3.3105 - accuracy500: 0.3430 - val_loss: 3.3191 - val_accuracy500: 0.3329 - 8s/epoch - 15ms/step
Epoch 4/50
538/538 - 9s - loss: 3.3048 - accuracy500: 0.3452 - val_loss: 3.3115 - val_accuracy500: 0.3349 - 9s/epoch - 16ms/step
Epoch 5/50
538/538 - 8s - loss: 3.3010 - accuracy500: 0.3445 - val_loss: 3.3095 - val_accuracy500: 0.3342 - 8s/epoch - 16ms/step
Epoch 6/50
538/538 - 8s - loss: 3.2983 - accuracy500: 0.3464 - val_loss: 3.3089 - val_accuracy500: 0.3357 - 8s/epoch - 15ms/step
Epoch 7/50
538/538 - 8s - loss: 3.2959 - accuracy500: 0.3481 - val_loss: 3.3076 - val_accuracy500: 0.3380 - 8s/epoch - 15ms/step
Epoch 8/50
538/538 - 8s - loss: 3.2945 - accuracy500: 0.3502 - val_loss: 3.3053 - val_accuracy500: 0.3390 - 8s/epoch - 15ms/step
Epoch 9/50
538/538 - 8s - loss: 3.2928 - accuracy500: 0.3521 - val_loss: 3.3064 - val_accuracy500: 0.3367 - 8s/epoch - 15ms/step
Epoch 10/50
538/538 - 8s - loss: 3.2923 - accuracy500: 0.3514 - val_loss: 3.3055 - val_accuracy500: 0.3370 - 8s/epoch - 15ms/step
Epoch 11/50
538/538 - 8s - loss: 3.2908 - accuracy500: 0.3535 - val_loss: 3.3056 - val_accuracy500: 0.3382 - 8s/epoch - 15ms/step
Epoch 12/50
538/538 - 8s - loss: 3.2894 - accuracy500: 0.3548 - val_loss: 3.3052 - val_accuracy500: 0.3385 - 8s/epoch - 15ms/step
Epoch 13/50
538/538 - 8s - loss: 3.2890 - accuracy500: 0.3565 - val_loss: 3.3062 - val_accuracy500: 0.3364 - 8s/epoch - 15ms/step
Epoch 14/50
538/538 - 9s - loss: 3.2875 - accuracy500: 0.3551 - val_loss: 3.3063 - val_accuracy500: 0.3376 - 9s/epoch - 16ms/step
Epoch 15/50
538/538 - 8s - loss: 3.2869 - accuracy500: 0.3583 - val_loss: 3.3059 - val_accuracy500: 0.3397 - 8s/epoch - 15ms/step
Epoch 16/50
538/538 - 8s - loss: 3.2862 - accuracy500: 0.3580 - val_loss: 3.3053 - val_accuracy500: 0.3415 - 8s/epoch - 15ms/step
Epoch 17/50
538/538 - 8s - loss: 3.2856 - accuracy500: 0.3588 - val_loss: 3.3062 - val_accuracy500: 0.3375 - 8s/epoch - 16ms/step
Epoch 18/50
538/538 - 8s - loss: 3.2837 - accuracy500: 0.3601 - val_loss: 3.3059 - val_accuracy500: 0.3390 - 8s/epoch - 15ms/step
Epoch 19/50
538/538 - 8s - loss: 3.2837 - accuracy500: 0.3598 - val_loss: 3.3052 - val_accuracy500: 0.3394 - 8s/epoch - 15ms/step
Epoch 20/50
538/538 - 8s - loss: 3.2809 - accuracy500: 0.3648 - val_loss: 3.3069 - val_accuracy500: 0.3385 - 8s/epoch - 15ms/step
Epoch 21/50
538/538 - 8s - loss: 3.2822 - accuracy500: 0.3634 - val_loss: 3.3068 - val_accuracy500: 0.3410 - 8s/epoch - 15ms/step
Epoch 22/50
538/538 - 8s - loss: 3.2811 - accuracy500: 0.3629 - val_loss: 3.3073 - val_accuracy500: 0.3404 - 8s/epoch - 15ms/step
testing model: results/PCAR/W4/deepOF_L1/h500
Evaluating performance on  test set...
1590/1590 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1002734
{'0': {'precision': 0.34704150614232754, 'recall': 0.28643423351806996, 'f1-score': 0.3138385942423757, 'support': 133343}, '1': {'precision': 0.35611296128746606, 'recall': 0.126801883623851, 'f1-score': 0.18701348591762873, 'support': 145889}, '2': {'precision': 0.32056263980276584, 'recall': 0.6147042478416394, 'f1-score': 0.42137964893077606, 'support': 127759}, 'accuracy': 0.3322604185350536, 'macro avg': {'precision': 0.3412390357441865, 'recall': 0.34264678832785345, 'f1-score': 0.30741057636359354, 'support': 406991}, 'weighted avg': {'precision': 0.3419812272540795, 'recall': 0.3322604185350536, 'f1-score': 0.30213550836958325, 'support': 406991}}
[[38194 17160 77989]
 [38925 18499 88465]
 [32937 16288 78534]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0951395
{'0': {'precision': 0.3571972956361401, 'recall': 0.32314672716354176, 'f1-score': 0.3393199121864636, 'support': 44961}, '1': {'precision': 0.3660652542905639, 'recall': 0.12791055267551182, 'f1-score': 0.18957855154563658, 'support': 45524}, '2': {'precision': 0.3615465252512795, 'recall': 0.6213386460938494, 'f1-score': 0.45710899919698755, 'support': 47182}, 'accuracy': 0.3607836300638497, 'macro avg': {'precision': 0.36160302505932784, 'recall': 0.357465308644301, 'f1-score': 0.3286691543096959, 'support': 137667}, 'weighted avg': {'precision': 0.36162036217703586, 'recall': 0.3607836300638497, 'f1-score': 0.33017246945521744, 'support': 137667}}
[[14529  5080 25352]
 [13284  5823 26417]
 [12862  5004 29316]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0997428
{'0': {'precision': 0.37505035584799246, 'recall': 0.294449422803226, 'f1-score': 0.32989812490772186, 'support': 18971}, '1': {'precision': 0.3445279866332498, 'recall': 0.11631317689530686, 'f1-score': 0.1739130434782609, 'support': 17728}, '2': {'precision': 0.32021955108549, 'recall': 0.6219032872796569, 'f1-score': 0.4227592907456886, 'support': 16792}, 'accuracy': 0.33820642724944383, 'macro avg': {'precision': 0.3465992978555774, 'recall': 0.3442219623260632, 'f1-score': 0.30885681971055706, 'support': 53491}, 'weighted avg': {'precision': 0.34772203080245395, 'recall': 0.33820642724944383, 'f1-score': 0.3073526719001066, 'support': 53491}}
[[ 5586  2089 11296]
 [ 4793  2062 10873]
 [ 4515  1834 10443]]
training model: results/PCAR/W4/deepOF_L1/h1000
Epoch 1/50
538/538 - 11s - loss: 3.3483 - accuracy1000: 0.3373 - val_loss: 3.3428 - val_accuracy1000: 0.3265 - 11s/epoch - 20ms/step
Epoch 2/50
538/538 - 8s - loss: 3.3280 - accuracy1000: 0.3351 - val_loss: 3.3272 - val_accuracy1000: 0.3245 - 8s/epoch - 16ms/step
Epoch 3/50
538/538 - 8s - loss: 3.3163 - accuracy1000: 0.3353 - val_loss: 3.3146 - val_accuracy1000: 0.3290 - 8s/epoch - 16ms/step
Epoch 4/50
538/538 - 8s - loss: 3.3091 - accuracy1000: 0.3353 - val_loss: 3.3081 - val_accuracy1000: 0.3399 - 8s/epoch - 16ms/step
Epoch 5/50
538/538 - 8s - loss: 3.3046 - accuracy1000: 0.3374 - val_loss: 3.3063 - val_accuracy1000: 0.3367 - 8s/epoch - 15ms/step
Epoch 6/50
538/538 - 8s - loss: 3.3012 - accuracy1000: 0.3405 - val_loss: 3.3063 - val_accuracy1000: 0.3356 - 8s/epoch - 15ms/step
Epoch 7/50
538/538 - 8s - loss: 3.2992 - accuracy1000: 0.3408 - val_loss: 3.3067 - val_accuracy1000: 0.3326 - 8s/epoch - 15ms/step
Epoch 8/50
538/538 - 8s - loss: 3.2974 - accuracy1000: 0.3447 - val_loss: 3.3063 - val_accuracy1000: 0.3368 - 8s/epoch - 15ms/step
Epoch 9/50
538/538 - 8s - loss: 3.2966 - accuracy1000: 0.3455 - val_loss: 3.3058 - val_accuracy1000: 0.3365 - 8s/epoch - 16ms/step
Epoch 10/50
538/538 - 8s - loss: 3.2951 - accuracy1000: 0.3468 - val_loss: 3.3068 - val_accuracy1000: 0.3363 - 8s/epoch - 15ms/step
Epoch 11/50
538/538 - 8s - loss: 3.2941 - accuracy1000: 0.3486 - val_loss: 3.3063 - val_accuracy1000: 0.3358 - 8s/epoch - 15ms/step
Epoch 12/50
538/538 - 8s - loss: 3.2937 - accuracy1000: 0.3469 - val_loss: 3.3062 - val_accuracy1000: 0.3391 - 8s/epoch - 15ms/step
Epoch 13/50
538/538 - 8s - loss: 3.2924 - accuracy1000: 0.3492 - val_loss: 3.3072 - val_accuracy1000: 0.3357 - 8s/epoch - 15ms/step
Epoch 14/50
538/538 - 8s - loss: 3.2908 - accuracy1000: 0.3533 - val_loss: 3.3073 - val_accuracy1000: 0.3339 - 8s/epoch - 15ms/step
Epoch 15/50
538/538 - 8s - loss: 3.2908 - accuracy1000: 0.3523 - val_loss: 3.3074 - val_accuracy1000: 0.3357 - 8s/epoch - 15ms/step
Epoch 16/50
538/538 - 8s - loss: 3.2896 - accuracy1000: 0.3511 - val_loss: 3.3065 - val_accuracy1000: 0.3353 - 8s/epoch - 15ms/step
Epoch 17/50
538/538 - 8s - loss: 3.2887 - accuracy1000: 0.3536 - val_loss: 3.3060 - val_accuracy1000: 0.3395 - 8s/epoch - 15ms/step
Epoch 18/50
538/538 - 8s - loss: 3.2872 - accuracy1000: 0.3549 - val_loss: 3.3068 - val_accuracy1000: 0.3365 - 8s/epoch - 15ms/step
Epoch 19/50
538/538 - 8s - loss: 3.2875 - accuracy1000: 0.3557 - val_loss: 3.3072 - val_accuracy1000: 0.3339 - 8s/epoch - 15ms/step
testing model: results/PCAR/W4/deepOF_L1/h1000
Evaluating performance on  test set...
1590/1590 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0995879
{'0': {'precision': 0.33633109583370535, 'recall': 0.30731407042629566, 'f1-score': 0.32116850553598486, 'support': 134836}, '1': {'precision': 0.3427863524717643, 'recall': 0.22850707850707852, 'f1-score': 0.2742167289450992, 'support': 139860}, '2': {'precision': 0.3266773372517121, 'recall': 0.470539324993386, 'f1-score': 0.38562800061948277, 'support': 132295}, 'accuracy': 0.33328992533004415, 'macro avg': {'precision': 0.3352649285190606, 'recall': 0.33545349130892005, 'f1-score': 0.32700441170018896, 'support': 406991}, 'weighted avg': {'precision': 0.3354113904883639, 'recall': 0.33328992533004415, 'f1-score': 0.32598677775347884, 'support': 406991}}
[[41437 31068 62331]
 [41927 31959 65974]
 [39839 30206 62250]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0966688
{'0': {'precision': 0.34913197981032573, 'recall': 0.34188886672429464, 'f1-score': 0.34547246298909273, 'support': 45117}, '1': {'precision': 0.34218676677616144, 'recall': 0.24428265142040378, 'f1-score': 0.2850627435138974, 'support': 44776}, '2': {'precision': 0.3625428715397994, 'recall': 0.4668648218696362, 'f1-score': 0.40814309895237655, 'support': 47774}, 'accuracy': 0.35351246122890745, 'macro avg': {'precision': 0.3512872060420955, 'recall': 0.3510121133381115, 'f1-score': 0.3462261018184556, 'support': 137667}, 'weighted avg': {'precision': 0.3515269842969938, 'recall': 0.35351246122890745, 'f1-score': 0.34757261308525644, 'support': 137667}}
[[15425 10329 19363]
 [13984 10938 19854]
 [14772 10698 22304]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991995
{'0': {'precision': 0.37786598732152377, 'recall': 0.3221863002626793, 'f1-score': 0.3478118609406953, 'support': 19796}, '1': {'precision': 0.32139376218323584, 'recall': 0.23029915027354209, 'f1-score': 0.2683257611717637, 'support': 17182}, '2': {'precision': 0.31205761316872427, 'recall': 0.4592139526433719, 'f1-score': 0.3715972851787421, 'support': 16513}, 'accuracy': 0.33497223832046513, 'macro avg': {'precision': 0.337105787557828, 'recall': 0.33723313439319774, 'f1-score': 0.3292449690970671, 'support': 53491}, 'weighted avg': {'precision': 0.3394109303079843, 'recall': 0.33497223832046513, 'f1-score': 0.32962260563070084, 'support': 53491}}
[[6378 4544 8874]
 [5382 3957 7843]
 [5119 3811 7583]]
training model: results/PCAR/W4/deepLOB_L2/h10
Epoch 1/50
538/538 - 26s - loss: 3.3044 - accuracy10: 0.3752 - val_loss: 3.3006 - val_accuracy10: 0.3714 - 26s/epoch - 49ms/step
Epoch 2/50
538/538 - 23s - loss: 3.2218 - accuracy10: 0.4148 - val_loss: 3.2959 - val_accuracy10: 0.3792 - 23s/epoch - 43ms/step
Epoch 3/50
538/538 - 23s - loss: 3.1542 - accuracy10: 0.4484 - val_loss: 3.2460 - val_accuracy10: 0.3831 - 23s/epoch - 42ms/step
Epoch 4/50
538/538 - 23s - loss: 3.1233 - accuracy10: 0.4600 - val_loss: 3.2344 - val_accuracy10: 0.3933 - 23s/epoch - 42ms/step
Epoch 5/50
538/538 - 23s - loss: 3.1082 - accuracy10: 0.4635 - val_loss: 3.2341 - val_accuracy10: 0.3843 - 23s/epoch - 42ms/step
Epoch 6/50
538/538 - 23s - loss: 3.0927 - accuracy10: 0.4686 - val_loss: 3.2364 - val_accuracy10: 0.3941 - 23s/epoch - 42ms/step
Epoch 7/50
538/538 - 23s - loss: 3.0828 - accuracy10: 0.4720 - val_loss: 3.2472 - val_accuracy10: 0.3841 - 23s/epoch - 42ms/step
Epoch 8/50
538/538 - 23s - loss: 3.0716 - accuracy10: 0.4752 - val_loss: 3.2330 - val_accuracy10: 0.3858 - 23s/epoch - 42ms/step
Epoch 9/50
538/538 - 23s - loss: 3.0644 - accuracy10: 0.4771 - val_loss: 3.2286 - val_accuracy10: 0.3882 - 23s/epoch - 42ms/step
Epoch 10/50
538/538 - 23s - loss: 3.0574 - accuracy10: 0.4796 - val_loss: 3.2130 - val_accuracy10: 0.4019 - 23s/epoch - 42ms/step
Epoch 11/50
538/538 - 23s - loss: 3.0501 - accuracy10: 0.4826 - val_loss: 3.2086 - val_accuracy10: 0.4051 - 23s/epoch - 42ms/step
Epoch 12/50
538/538 - 23s - loss: 3.0406 - accuracy10: 0.4855 - val_loss: 3.1943 - val_accuracy10: 0.4103 - 23s/epoch - 43ms/step
Epoch 13/50
538/538 - 23s - loss: 3.0340 - accuracy10: 0.4875 - val_loss: 3.1918 - val_accuracy10: 0.4139 - 23s/epoch - 42ms/step
Epoch 14/50
538/538 - 23s - loss: 3.0309 - accuracy10: 0.4881 - val_loss: 3.2040 - val_accuracy10: 0.4128 - 23s/epoch - 42ms/step
Epoch 15/50
538/538 - 23s - loss: 3.0222 - accuracy10: 0.4919 - val_loss: 3.2367 - val_accuracy10: 0.4030 - 23s/epoch - 42ms/step
Epoch 16/50
538/538 - 23s - loss: 3.0149 - accuracy10: 0.4946 - val_loss: 3.2472 - val_accuracy10: 0.4004 - 23s/epoch - 43ms/step
Epoch 17/50
538/538 - 23s - loss: 3.0081 - accuracy10: 0.4963 - val_loss: 3.2337 - val_accuracy10: 0.4029 - 23s/epoch - 42ms/step
Epoch 18/50
538/538 - 23s - loss: 3.0020 - accuracy10: 0.4974 - val_loss: 3.2767 - val_accuracy10: 0.3990 - 23s/epoch - 42ms/step
Epoch 19/50
538/538 - 23s - loss: 2.9946 - accuracy10: 0.4998 - val_loss: 3.2706 - val_accuracy10: 0.3969 - 23s/epoch - 42ms/step
Epoch 20/50
538/538 - 23s - loss: 2.9878 - accuracy10: 0.5023 - val_loss: 3.2821 - val_accuracy10: 0.3958 - 23s/epoch - 42ms/step
Epoch 21/50
538/538 - 23s - loss: 2.9798 - accuracy10: 0.5042 - val_loss: 3.3022 - val_accuracy10: 0.3942 - 23s/epoch - 42ms/step
Epoch 22/50
538/538 - 23s - loss: 2.9731 - accuracy10: 0.5069 - val_loss: 3.3232 - val_accuracy10: 0.3921 - 23s/epoch - 42ms/step
Epoch 23/50
538/538 - 23s - loss: 2.9677 - accuracy10: 0.5073 - val_loss: 3.3328 - val_accuracy10: 0.3924 - 23s/epoch - 42ms/step
testing model: results/PCAR/W4/deepLOB_L2/h10
Evaluating performance on  test set...
1590/1590 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0372628
{'0': {'precision': 0.4809259259259259, 'recall': 0.21206924710109423, 'f1-score': 0.2943443273263062, 'support': 122460}, '1': {'precision': 0.472186275994893, 'recall': 0.6567404063205418, 'f1-score': 0.5493781157157964, 'support': 166125}, '2': {'precision': 0.3955961948499262, 'recall': 0.40738957858288993, 'f1-score': 0.4014062825046807, 'support': 118410}, 'accuracy': 0.45039865354611236, 'macro avg': {'precision': 0.4495694655902484, 'recall': 0.42539974400150865, 'f1-score': 0.41504290851559444, 'support': 406995}, 'weighted avg': {'precision': 0.45253302723797645, 'recall': 0.45039865354611236, 'f1-score': 0.4295909377487325, 'support': 406995}}
[[ 25970  62452  34038]
 [ 17361 109101  39663]
 [ 10669  59502  48239]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0406046
{'0': {'precision': 0.46605775753464485, 'recall': 0.4172522991497484, 'f1-score': 0.4403067063401236, 'support': 46104}, '1': {'precision': 0.4214465622264697, 'recall': 0.5218304874811996, 'f1-score': 0.46629707588469554, 'support': 45212}, '2': {'precision': 0.48106997921409483, 'recall': 0.41941190429961384, 'f1-score': 0.44813000633896155, 'support': 46353}, 'accuracy': 0.45232405261896286, 'macro avg': {'precision': 0.4561914329917365, 'recall': 0.4528315636435207, 'f1-score': 0.45157792952126025, 'support': 137669}, 'weighted avg': {'precision': 0.4564615532274612, 'recall': 0.45232405261896286, 'f1-score': 0.45147632341219734, 'support': 137669}}
[[19237 16264 10603]
 [11251 23593 10368]
 [10788 16124 19441]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0640556
{'0': {'precision': 0.4901212020587747, 'recall': 0.1740976645435244, 'f1-score': 0.2569302406545106, 'support': 16956}, '1': {'precision': 0.41509784954237666, 'recall': 0.562065491183879, 'f1-score': 0.4775295326142784, 'support': 19850}, '2': {'precision': 0.3930357923364577, 'recall': 0.4850173798393863, 'f1-score': 0.4342087614346648, 'support': 16686}, 'accuracy': 0.4150527181634637, 'macro avg': {'precision': 0.4327516146458697, 'recall': 0.4070601785222632, 'f1-score': 0.3895561782344846, 'support': 53492}, 'weighted avg': {'precision': 0.43199698359475985, 'recall': 0.4150527181634637, 'f1-score': 0.3940902896924797, 'support': 53492}}
[[ 2952  8391  5613]
 [ 1808 11157  6885]
 [ 1263  7330  8093]]
training model: results/PCAR/W4/deepLOB_L2/h20
Epoch 1/50
538/538 - 25s - loss: 3.3126 - accuracy20: 0.3666 - val_loss: 3.2961 - val_accuracy20: 0.3682 - 25s/epoch - 46ms/step
Epoch 2/50
538/538 - 23s - loss: 3.2308 - accuracy20: 0.4114 - val_loss: 3.2438 - val_accuracy20: 0.4008 - 23s/epoch - 42ms/step
Epoch 3/50
538/538 - 23s - loss: 3.1959 - accuracy20: 0.4272 - val_loss: 3.2225 - val_accuracy20: 0.4084 - 23s/epoch - 42ms/step
Epoch 4/50
538/538 - 23s - loss: 3.1755 - accuracy20: 0.4370 - val_loss: 3.2172 - val_accuracy20: 0.4150 - 23s/epoch - 42ms/step
Epoch 5/50
538/538 - 23s - loss: 3.1611 - accuracy20: 0.4419 - val_loss: 3.2203 - val_accuracy20: 0.4108 - 23s/epoch - 42ms/step
Epoch 6/50
538/538 - 23s - loss: 3.1534 - accuracy20: 0.4448 - val_loss: 3.2142 - val_accuracy20: 0.4137 - 23s/epoch - 42ms/step
Epoch 7/50
538/538 - 23s - loss: 3.1458 - accuracy20: 0.4473 - val_loss: 3.2110 - val_accuracy20: 0.4113 - 23s/epoch - 42ms/step
Epoch 8/50
538/538 - 23s - loss: 3.1392 - accuracy20: 0.4501 - val_loss: 3.2084 - val_accuracy20: 0.4134 - 23s/epoch - 42ms/step
Epoch 9/50
538/538 - 23s - loss: 3.1333 - accuracy20: 0.4517 - val_loss: 3.2118 - val_accuracy20: 0.4136 - 23s/epoch - 42ms/step
Epoch 10/50
538/538 - 23s - loss: 3.1289 - accuracy20: 0.4538 - val_loss: 3.2121 - val_accuracy20: 0.4140 - 23s/epoch - 42ms/step
Epoch 11/50
538/538 - 23s - loss: 3.1244 - accuracy20: 0.4539 - val_loss: 3.2109 - val_accuracy20: 0.4156 - 23s/epoch - 43ms/step
Epoch 12/50
538/538 - 23s - loss: 3.1191 - accuracy20: 0.4565 - val_loss: 3.2183 - val_accuracy20: 0.4137 - 23s/epoch - 42ms/step
Epoch 13/50
538/538 - 23s - loss: 3.1141 - accuracy20: 0.4586 - val_loss: 3.2103 - val_accuracy20: 0.4182 - 23s/epoch - 42ms/step
Epoch 14/50
538/538 - 23s - loss: 3.1092 - accuracy20: 0.4605 - val_loss: 3.2130 - val_accuracy20: 0.4182 - 23s/epoch - 42ms/step
Epoch 15/50
538/538 - 23s - loss: 3.1047 - accuracy20: 0.4611 - val_loss: 3.2133 - val_accuracy20: 0.4192 - 23s/epoch - 42ms/step
Epoch 16/50
538/538 - 23s - loss: 3.0992 - accuracy20: 0.4633 - val_loss: 3.2129 - val_accuracy20: 0.4210 - 23s/epoch - 42ms/step
Epoch 17/50
538/538 - 23s - loss: 3.0948 - accuracy20: 0.4646 - val_loss: 3.2221 - val_accuracy20: 0.4167 - 23s/epoch - 42ms/step
Epoch 18/50
538/538 - 23s - loss: 3.0889 - accuracy20: 0.4670 - val_loss: 3.2387 - val_accuracy20: 0.4147 - 23s/epoch - 42ms/step
testing model: results/PCAR/W4/deepLOB_L2/h20
Evaluating performance on  test set...
1590/1590 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0531023
{'0': {'precision': 0.42766565231027437, 'recall': 0.4025965735443149, 'f1-score': 0.41475264291468683, 'support': 125319}, '1': {'precision': 0.4511877533458638, 'recall': 0.49470508634495775, 'f1-score': 0.47194537713111506, 'support': 161098}, '2': {'precision': 0.40465894328475077, 'recall': 0.3771666473154307, 'f1-score': 0.3904294225717279, 'support': 120578}, 'accuracy': 0.43152127176009536, 'macro avg': {'precision': 0.42783744964696296, 'recall': 0.42482276906823446, 'f1-score': 0.4257091475391766, 'support': 406995}, 'weighted avg': {'precision': 0.43016018042917464, 'recall': 0.43152127176009536, 'f1-score': 0.4301847485530481, 'support': 406995}}
[[50453 47936 26930]
 [41424 79696 39978]
 [26096 49004 45478]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0555912
{'0': {'precision': 0.4405232615324088, 'recall': 0.48724978241949524, 'f1-score': 0.4627098507154295, 'support': 45960}, '1': {'precision': 0.420281281092855, 'recall': 0.34306473209386046, 'f1-score': 0.37776757227110125, 'support': 45557}, '2': {'precision': 0.44983584103772634, 'recall': 0.48390102270757496, 'f1-score': 0.4662470380692909, 'support': 46152}, 'accuracy': 0.4384138767623793, 'macro avg': {'precision': 0.43688012788766334, 'recall': 0.4380718457403103, 'f1-score': 0.43557482035194056, 'support': 137669}, 'weighted avg': {'precision': 0.4369467865557958, 'recall': 0.4384138767623793, 'f1-score': 0.43578681714699463, 'support': 137669}}
[[22394 10959 12607]
 [15221 15629 14707]
 [13220 10599 22333]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0689853
{'0': {'precision': 0.43783269961977184, 'recall': 0.4012894232444677, 'f1-score': 0.41876534230384577, 'support': 17217}, '1': {'precision': 0.402328187250996, 'recall': 0.3399431937723543, 'f1-score': 0.3685140837039571, 'support': 19012}, '2': {'precision': 0.40590354767184034, 'recall': 0.5090077043387592, 'f1-score': 0.451646064094986, 'support': 17263}, 'accuracy': 0.41424885964256336, 'macro avg': {'precision': 0.4153548115142027, 'recall': 0.4167467737851937, 'f1-score': 0.41297516336759627, 'support': 53492}, 'weighted avg': {'precision': 0.41490955710813815, 'recall': 0.41424885964256336, 'f1-score': 0.41151646343933085, 'support': 53492}}
[[6909 5007 5301]
 [4989 6463 7560]
 [3882 4594 8787]]
training model: results/PCAR/W4/deepLOB_L2/h30
Epoch 1/50
538/538 - 25s - loss: 3.3255 - accuracy30: 0.3584 - val_loss: 3.3300 - val_accuracy30: 0.3551 - 25s/epoch - 46ms/step
Epoch 2/50
538/538 - 23s - loss: 3.2643 - accuracy30: 0.3888 - val_loss: 3.3046 - val_accuracy30: 0.3700 - 23s/epoch - 42ms/step
Epoch 3/50
538/538 - 23s - loss: 3.2236 - accuracy30: 0.4134 - val_loss: 3.2592 - val_accuracy30: 0.3842 - 23s/epoch - 43ms/step
Epoch 4/50
538/538 - 23s - loss: 3.2033 - accuracy30: 0.4238 - val_loss: 3.2362 - val_accuracy30: 0.3950 - 23s/epoch - 42ms/step
Epoch 5/50
538/538 - 23s - loss: 3.1918 - accuracy30: 0.4294 - val_loss: 3.2370 - val_accuracy30: 0.4016 - 23s/epoch - 42ms/step
Epoch 6/50
538/538 - 23s - loss: 3.1855 - accuracy30: 0.4326 - val_loss: 3.2420 - val_accuracy30: 0.3996 - 23s/epoch - 42ms/step
Epoch 7/50
538/538 - 23s - loss: 3.1798 - accuracy30: 0.4339 - val_loss: 3.2387 - val_accuracy30: 0.3975 - 23s/epoch - 42ms/step
Epoch 8/50
538/538 - 23s - loss: 3.1728 - accuracy30: 0.4370 - val_loss: 3.2460 - val_accuracy30: 0.3989 - 23s/epoch - 43ms/step
Epoch 9/50
538/538 - 23s - loss: 3.1668 - accuracy30: 0.4405 - val_loss: 3.2557 - val_accuracy30: 0.3933 - 23s/epoch - 43ms/step
Epoch 10/50
538/538 - 23s - loss: 3.1630 - accuracy30: 0.4421 - val_loss: 3.2408 - val_accuracy30: 0.4028 - 23s/epoch - 42ms/step
Epoch 11/50
538/538 - 23s - loss: 3.1596 - accuracy30: 0.4439 - val_loss: 3.2363 - val_accuracy30: 0.4051 - 23s/epoch - 42ms/step
Epoch 12/50
538/538 - 23s - loss: 3.1529 - accuracy30: 0.4457 - val_loss: 3.2355 - val_accuracy30: 0.4064 - 23s/epoch - 42ms/step
Epoch 13/50
538/538 - 23s - loss: 3.1480 - accuracy30: 0.4477 - val_loss: 3.2396 - val_accuracy30: 0.4060 - 23s/epoch - 43ms/step
Epoch 14/50
538/538 - 23s - loss: 3.1415 - accuracy30: 0.4509 - val_loss: 3.2357 - val_accuracy30: 0.4107 - 23s/epoch - 42ms/step
Epoch 15/50
538/538 - 23s - loss: 3.1371 - accuracy30: 0.4521 - val_loss: 3.2411 - val_accuracy30: 0.4066 - 23s/epoch - 42ms/step
Epoch 16/50
538/538 - 23s - loss: 3.1312 - accuracy30: 0.4538 - val_loss: 3.2554 - val_accuracy30: 0.4029 - 23s/epoch - 42ms/step
Epoch 17/50
538/538 - 23s - loss: 3.1249 - accuracy30: 0.4560 - val_loss: 3.2515 - val_accuracy30: 0.4027 - 23s/epoch - 42ms/step
Epoch 18/50
538/538 - 23s - loss: 3.1206 - accuracy30: 0.4578 - val_loss: 3.2615 - val_accuracy30: 0.3971 - 23s/epoch - 42ms/step
Epoch 19/50
538/538 - 23s - loss: 3.1153 - accuracy30: 0.4598 - val_loss: 3.2665 - val_accuracy30: 0.3980 - 23s/epoch - 42ms/step
Epoch 20/50
538/538 - 23s - loss: 3.1076 - accuracy30: 0.4615 - val_loss: 3.2672 - val_accuracy30: 0.4010 - 23s/epoch - 42ms/step
Epoch 21/50
538/538 - 23s - loss: 3.1024 - accuracy30: 0.4647 - val_loss: 3.2736 - val_accuracy30: 0.3951 - 23s/epoch - 42ms/step
Epoch 22/50
538/538 - 23s - loss: 3.0959 - accuracy30: 0.4666 - val_loss: 3.2827 - val_accuracy30: 0.3947 - 23s/epoch - 42ms/step
testing model: results/PCAR/W4/deepLOB_L2/h30
Evaluating performance on  test set...
1590/1590 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0733924
{'0': {'precision': 0.4150538441334284, 'recall': 0.4259409005845251, 'f1-score': 0.4204269034298224, 'support': 129849}, '1': {'precision': 0.4215838154067392, 'recall': 0.42690248148319754, 'f1-score': 0.4242264786360766, 'support': 151079}, '2': {'precision': 0.3856651898472113, 'recall': 0.36941467632290764, 'f1-score': 0.37736506470249814, 'support': 126067}, 'accuracy': 0.4087888057592845, 'macro avg': {'precision': 0.4074342831291264, 'recall': 0.40741935279687674, 'f1-score': 0.4073394822561324, 'support': 406995}, 'weighted avg': {'precision': 0.40837465163745174, 'recall': 0.4087888057592845, 'f1-score': 0.4084988925199785, 'support': 406995}}
[[55308 41503 33038]
 [45437 64496 41146]
 [32510 46986 46571]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0665493
{'0': {'precision': 0.42143210574680146, 'recall': 0.5159782773318332, 'f1-score': 0.46393728053537214, 'support': 46219}, '1': {'precision': 0.42871139677065373, 'recall': 0.24193298684065023, 'f1-score': 0.3093127482998968, 'support': 45215}, '2': {'precision': 0.42713938630432824, 'recall': 0.5133340542878772, 'f1-score': 0.466286836935167, 'support': 46235}, 'accuracy': 0.425084804858029, 'macro avg': {'precision': 0.42576096294059446, 'recall': 0.4237484394867869, 'f1-score': 0.413178955256812, 'support': 137669}, 'weighted avg': {'precision': 0.4257396060571163, 'recall': 0.425084804858029, 'f1-score': 0.4139426086420447, 'support': 137669}}
[[23848  7465 14906]
 [17351 10939 16925]
 [15389  7112 23734]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0780444
{'0': {'precision': 0.4266897746967071, 'recall': 0.35262102549412777, 'f1-score': 0.38613550815558345, 'support': 17455}, '1': {'precision': 0.3944114087249382, 'recall': 0.4055735930735931, 'f1-score': 0.3999146279646773, 'support': 18480}, '2': {'precision': 0.4072966507177033, 'recall': 0.46545537392493025, 'f1-score': 0.4344382127003535, 'support': 17557}, 'accuracy': 0.4079488521648097, 'macro avg': {'precision': 0.4094659447131162, 'recall': 0.40788333083088374, 'f1-score': 0.4068294496068714, 'support': 53492}, 'weighted avg': {'precision': 0.4091733370825282, 'recall': 0.4079488521648097, 'f1-score': 0.4067495947061813, 'support': 53492}}
[[6155 5731 5569]
 [4662 7495 6323]
 [3608 5777 8172]]
training model: results/PCAR/W4/deepLOB_L2/h50
Epoch 1/50
538/538 - 25s - loss: 3.3208 - accuracy50: 0.3611 - val_loss: 3.3229 - val_accuracy50: 0.3612 - 25s/epoch - 46ms/step
Epoch 2/50
538/538 - 23s - loss: 3.2653 - accuracy50: 0.3890 - val_loss: 3.2822 - val_accuracy50: 0.3717 - 23s/epoch - 42ms/step
Epoch 3/50
538/538 - 23s - loss: 3.2391 - accuracy50: 0.4032 - val_loss: 3.2885 - val_accuracy50: 0.3818 - 23s/epoch - 42ms/step
Epoch 4/50
538/538 - 23s - loss: 3.2273 - accuracy50: 0.4099 - val_loss: 3.2455 - val_accuracy50: 0.3932 - 23s/epoch - 42ms/step
Epoch 5/50
538/538 - 23s - loss: 3.2162 - accuracy50: 0.4184 - val_loss: 3.2390 - val_accuracy50: 0.3977 - 23s/epoch - 42ms/step
Epoch 6/50
538/538 - 23s - loss: 3.2135 - accuracy50: 0.4173 - val_loss: 3.2520 - val_accuracy50: 0.3973 - 23s/epoch - 42ms/step
Epoch 7/50
538/538 - 23s - loss: 3.2046 - accuracy50: 0.4209 - val_loss: 3.2550 - val_accuracy50: 0.4008 - 23s/epoch - 42ms/step
Epoch 8/50
538/538 - 23s - loss: 3.1981 - accuracy50: 0.4250 - val_loss: 3.2651 - val_accuracy50: 0.4001 - 23s/epoch - 42ms/step
Epoch 9/50
538/538 - 23s - loss: 3.1928 - accuracy50: 0.4277 - val_loss: 3.2902 - val_accuracy50: 0.4004 - 23s/epoch - 42ms/step
Epoch 10/50
538/538 - 23s - loss: 3.1843 - accuracy50: 0.4314 - val_loss: 3.3193 - val_accuracy50: 0.3963 - 23s/epoch - 43ms/step
Epoch 11/50
538/538 - 23s - loss: 3.1806 - accuracy50: 0.4346 - val_loss: 3.2867 - val_accuracy50: 0.3954 - 23s/epoch - 42ms/step
Epoch 12/50
538/538 - 23s - loss: 3.1762 - accuracy50: 0.4355 - val_loss: 3.3164 - val_accuracy50: 0.3883 - 23s/epoch - 42ms/step
Epoch 13/50
538/538 - 23s - loss: 3.1713 - accuracy50: 0.4380 - val_loss: 3.3435 - val_accuracy50: 0.3888 - 23s/epoch - 43ms/step
Epoch 14/50
538/538 - 23s - loss: 3.1657 - accuracy50: 0.4415 - val_loss: 3.3412 - val_accuracy50: 0.3897 - 23s/epoch - 42ms/step
Epoch 15/50
538/538 - 23s - loss: 3.1580 - accuracy50: 0.4434 - val_loss: 3.3104 - val_accuracy50: 0.3954 - 23s/epoch - 42ms/step
testing model: results/PCAR/W4/deepLOB_L2/h50
Evaluating performance on  test set...
1590/1590 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0705651
{'0': {'precision': 0.3647273415929909, 'recall': 0.30505789864194544, 'f1-score': 0.33223472157909545, 'support': 119951}, '1': {'precision': 0.45107698843559924, 'recall': 0.6522522416094697, 'f1-score': 0.5333239958367644, 'support': 169298}, '2': {'precision': 0.36506910207710336, 'recall': 0.191811186791908, 'f1-score': 0.2514879378211802, 'support': 117746}, 'accuracy': 0.4167176500939815, 'macro avg': {'precision': 0.3936244773685645, 'recall': 0.3830404423477744, 'f1-score': 0.3723488850790133, 'support': 406995}, 'weighted avg': {'precision': 0.4007451389642663, 'recall': 0.4167176500939815, 'f1-score': 0.39252146012112993, 'support': 406995}}
[[ 36592  66644  16715]
 [ 36308 110425  22565]
 [ 27427  67734  22585]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0841188
{'0': {'precision': 0.396757436792338, 'recall': 0.42577793262635283, 'f1-score': 0.41075573761882256, 'support': 45923}, '1': {'precision': 0.3850125210112861, 'recall': 0.49404643996918673, 'f1-score': 0.43276747929861087, 'support': 45435}, '2': {'precision': 0.42808708658800065, 'recall': 0.2780980760510462, 'f1-score': 0.3371642494371433, 'support': 46311}, 'accuracy': 0.3986300474326101, 'macro avg': {'precision': 0.40328568146387495, 'recall': 0.39930748288219525, 'f1-score': 0.39356248878485883, 'support': 137669}, 'weighted avg': {'precision': 0.4034203541025156, 'recall': 0.3986300474326101, 'f1-score': 0.3932645673048044, 'support': 137669}}
[[19553 17834  8536]
 [14318 22447  8670]
 [15411 18021 12879]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0797734
{'0': {'precision': 0.3982882285576517, 'recall': 0.37835671342685373, 'f1-score': 0.3880667136481091, 'support': 17465}, '1': {'precision': 0.4048664944013781, 'recall': 0.5036969567081011, 'f1-score': 0.44890650367682167, 'support': 18664}, '2': {'precision': 0.39390395438929904, 'recall': 0.3103726314576974, 'f1-score': 0.34718464115449044, 'support': 17363}, 'accuracy': 0.40002243326104836, 'macro avg': {'precision': 0.39901955911610965, 'recall': 0.3974754338642174, 'f1-score': 0.39471928615980706, 'support': 53492}, 'weighted avg': {'precision': 0.3991603702110242, 'recall': 0.40002243326104836, 'f1-score': 0.39602450951270923, 'support': 53492}}
[[6608 7034 3823]
 [4794 9401 4469]
 [5189 6785 5389]]
training model: results/PCAR/W4/deepLOB_L2/h100
Epoch 1/50
538/538 - 25s - loss: 3.3366 - accuracy100: 0.3510 - val_loss: 3.3408 - val_accuracy100: 0.3462 - 25s/epoch - 47ms/step
Epoch 2/50
538/538 - 23s - loss: 3.2953 - accuracy100: 0.3666 - val_loss: 3.3438 - val_accuracy100: 0.3420 - 23s/epoch - 42ms/step
Epoch 3/50
538/538 - 23s - loss: 3.2755 - accuracy100: 0.3778 - val_loss: 3.3330 - val_accuracy100: 0.3512 - 23s/epoch - 43ms/step
Epoch 4/50
538/538 - 23s - loss: 3.2580 - accuracy100: 0.3920 - val_loss: 3.3237 - val_accuracy100: 0.3550 - 23s/epoch - 42ms/step
Epoch 5/50
538/538 - 23s - loss: 3.2431 - accuracy100: 0.4010 - val_loss: 3.3253 - val_accuracy100: 0.3598 - 23s/epoch - 42ms/step
Epoch 6/50
538/538 - 23s - loss: 3.2327 - accuracy100: 0.4057 - val_loss: 3.3572 - val_accuracy100: 0.3560 - 23s/epoch - 42ms/step
Epoch 7/50
538/538 - 23s - loss: 3.2260 - accuracy100: 0.4089 - val_loss: 3.3440 - val_accuracy100: 0.3590 - 23s/epoch - 42ms/step
Epoch 8/50
538/538 - 23s - loss: 3.2187 - accuracy100: 0.4135 - val_loss: 3.3642 - val_accuracy100: 0.3553 - 23s/epoch - 42ms/step
Epoch 9/50
538/538 - 23s - loss: 3.2106 - accuracy100: 0.4171 - val_loss: 3.3911 - val_accuracy100: 0.3550 - 23s/epoch - 42ms/step
Epoch 10/50
538/538 - 23s - loss: 3.2027 - accuracy100: 0.4208 - val_loss: 3.4613 - val_accuracy100: 0.3520 - 23s/epoch - 42ms/step
Epoch 11/50
538/538 - 23s - loss: 3.1966 - accuracy100: 0.4234 - val_loss: 3.4964 - val_accuracy100: 0.3474 - 23s/epoch - 42ms/step
Epoch 12/50
538/538 - 23s - loss: 3.1861 - accuracy100: 0.4272 - val_loss: 3.4984 - val_accuracy100: 0.3522 - 23s/epoch - 43ms/step
Epoch 13/50
538/538 - 23s - loss: 3.1779 - accuracy100: 0.4326 - val_loss: 3.5756 - val_accuracy100: 0.3454 - 23s/epoch - 42ms/step
Epoch 14/50
538/538 - 23s - loss: 3.1697 - accuracy100: 0.4353 - val_loss: 3.6395 - val_accuracy100: 0.3435 - 23s/epoch - 42ms/step
testing model: results/PCAR/W4/deepLOB_L2/h100
Evaluating performance on  test set...
1590/1590 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1001151
{'0': {'precision': 0.3410755465362974, 'recall': 0.1431447242094831, 'f1-score': 0.2016568408767404, 'support': 129156}, '1': {'precision': 0.3789595523037878, 'recall': 0.7071587096092367, 'f1-score': 0.493472133557958, 'support': 151396}, '2': {'precision': 0.3389160038134809, 'recall': 0.18836946292005094, 'f1-score': 0.24215128100854005, 'support': 126443}, 'accuracy': 0.3669995945896141, 'macro avg': {'precision': 0.352983700884522, 'recall': 0.34622429891292356, 'f1-score': 0.3124267518144128, 'support': 406995}, 'weighted avg': {'precision': 0.3544969101321005, 'recall': 0.3669995945896141, 'f1-score': 0.3227883204879169, 'support': 406995}}
[[ 18488  87546  23122]
 [ 20998 107061  23337]
 [ 14719  87906  23818]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1023506
{'0': {'precision': 0.3606778096208959, 'recall': 0.4109216812026121, 'f1-score': 0.3841638924455826, 'support': 45634}, '1': {'precision': 0.3640131888836552, 'recall': 0.5097625329815303, 'f1-score': 0.4247320692497939, 'support': 45480}, '2': {'precision': 0.3868928506458068, 'recall': 0.18273010417785415, 'f1-score': 0.24822374276001924, 'support': 46555}, 'accuracy': 0.36640783328127613, 'macro avg': {'precision': 0.370527949716786, 'recall': 0.36780477278733215, 'f1-score': 0.3523732348184652, 'support': 137669}, 'weighted avg': {'precision': 0.37064471781217373, 'recall': 0.36640783328127613, 'f1-score': 0.3515955365516931, 'support': 137669}}
[[18752 20057  6825]
 [15640 23184  6656]
 [17599 20449  8507]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1072999
{'0': {'precision': 0.38137839628893305, 'recall': 0.06409042819756111, 'f1-score': 0.10973923821328121, 'support': 17959}, '1': {'precision': 0.35591951613869094, 'recall': 0.64981140326901, 'f1-score': 0.4599253254918651, 'support': 18293}, '2': {'precision': 0.3463925977980792, 'recall': 0.3430974477958237, 'f1-score': 0.3447371488518476, 'support': 17240}, 'accuracy': 0.35431466387497196, 'macro avg': {'precision': 0.36123017007523445, 'recall': 0.3523330930874649, 'f1-score': 0.3048005708523313, 'support': 53492}, 'weighted avg': {'precision': 0.3613964464539914, 'recall': 0.35431466387497196, 'f1-score': 0.3052323600632031, 'support': 53492}}
[[ 1151 11150  5658]
 [  903 11887  5503]
 [  964 10361  5915]]
training model: results/PCAR/W4/deepLOB_L2/h200
Epoch 1/50
538/538 - 25s - loss: 3.3204 - accuracy200: 0.3613 - val_loss: 3.3166 - val_accuracy200: 0.3591 - 25s/epoch - 46ms/step
Epoch 2/50
538/538 - 23s - loss: 3.2769 - accuracy200: 0.3791 - val_loss: 3.3761 - val_accuracy200: 0.3402 - 23s/epoch - 42ms/step
Epoch 3/50
538/538 - 23s - loss: 3.2447 - accuracy200: 0.3946 - val_loss: 3.3378 - val_accuracy200: 0.3545 - 23s/epoch - 42ms/step
Epoch 4/50
538/538 - 23s - loss: 3.2409 - accuracy200: 0.3978 - val_loss: 3.3636 - val_accuracy200: 0.3580 - 23s/epoch - 42ms/step
Epoch 5/50
538/538 - 23s - loss: 3.2260 - accuracy200: 0.4086 - val_loss: 3.3379 - val_accuracy200: 0.3511 - 23s/epoch - 42ms/step
Epoch 6/50
538/538 - 23s - loss: 3.2161 - accuracy200: 0.4127 - val_loss: 3.3830 - val_accuracy200: 0.3411 - 23s/epoch - 42ms/step
Epoch 7/50
538/538 - 23s - loss: 3.2074 - accuracy200: 0.4191 - val_loss: 3.3894 - val_accuracy200: 0.3377 - 23s/epoch - 42ms/step
Epoch 8/50
538/538 - 23s - loss: 3.1987 - accuracy200: 0.4236 - val_loss: 3.4206 - val_accuracy200: 0.3397 - 23s/epoch - 42ms/step
Epoch 9/50
538/538 - 23s - loss: 3.1879 - accuracy200: 0.4288 - val_loss: 3.4375 - val_accuracy200: 0.3396 - 23s/epoch - 42ms/step
Epoch 10/50
538/538 - 23s - loss: 3.1765 - accuracy200: 0.4322 - val_loss: 3.4397 - val_accuracy200: 0.3409 - 23s/epoch - 42ms/step
Epoch 11/50
538/538 - 23s - loss: 3.1691 - accuracy200: 0.4375 - val_loss: 3.4744 - val_accuracy200: 0.3511 - 23s/epoch - 42ms/step
testing model: results/PCAR/W4/deepLOB_L2/h200
Evaluating performance on  test set...
1590/1590 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1041412
{'0': {'precision': 0.3626969033693351, 'recall': 0.1559984875492897, 'f1-score': 0.2181633743235004, 'support': 129591}, '1': {'precision': 0.40189784382433436, 'recall': 0.5161618816109322, 'f1-score': 0.451919066998375, 'support': 152210}, '2': {'precision': 0.3097732583519503, 'recall': 0.385433806731952, 'f1-score': 0.343486400489739, 'support': 125194}, 'accuracy': 0.36126979446921953, 'macro avg': {'precision': 0.3581226685152066, 'recall': 0.35253139196405797, 'f1-score': 0.33785628060387146, 'support': 406995}, 'weighted avg': {'precision': 0.3610778474407585, 'recall': 0.36126979446921953, 'f1-score': 0.34413456541896525, 'support': 406995}}
[[20216 57442 51933]
 [18060 78565 55585]
 [17462 59478 48254]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0970455
{'0': {'precision': 0.35963712290301675, 'recall': 0.22009738042256935, 'f1-score': 0.2730739267702653, 'support': 45389}, '1': {'precision': 0.39555537854952405, 'recall': 0.43706132148122073, 'f1-score': 0.41527381437695343, 'support': 45449}, '2': {'precision': 0.35424731453085984, 'recall': 0.4513890371762294, 'f1-score': 0.3969616164651093, 'support': 46831}, 'accuracy': 0.37040292295287974, 'macro avg': {'precision': 0.3698132719944669, 'recall': 0.3695159130266732, 'f1-score': 0.361769785870776, 'support': 137669}, 'weighted avg': {'precision': 0.3696614470791322, 'recall': 0.37040292295287974, 'f1-score': 0.36216171768859556, 'support': 137669}}
[[ 9990 14877 20522]
 [ 7573 19864 18012]
 [10215 15477 21139]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1046534
{'0': {'precision': 0.37798384135145063, 'recall': 0.21582092681903964, 'f1-score': 0.27475974372664175, 'support': 19076}, '1': {'precision': 0.3686853469920659, 'recall': 0.4317299776549453, 'f1-score': 0.39772481040086677, 'support': 17006}, '2': {'precision': 0.33765317817155954, 'recall': 0.4399770246984492, 'f1-score': 0.3820830007980846, 'support': 17410}, 'accuracy': 0.35741793165333136, 'macro avg': {'precision': 0.3614407888383587, 'recall': 0.3625093097241447, 'f1-score': 0.35152251830853104, 'support': 53492}, 'weighted avg': {'precision': 0.36190130487800404, 'recall': 0.35741793165333136, 'f1-score': 0.3487828094089062, 'support': 53492}}
[[4117 6585 8374]
 [3012 7342 6652]
 [3763 5987 7660]]
training model: results/PCAR/W4/deepLOB_L2/h300
Epoch 1/50
538/538 - 25s - loss: 3.3278 - accuracy300: 0.3607 - val_loss: 3.4006 - val_accuracy300: 0.3282 - 25s/epoch - 46ms/step
Epoch 2/50
538/538 - 23s - loss: 3.2893 - accuracy300: 0.3706 - val_loss: 3.4330 - val_accuracy300: 0.3366 - 23s/epoch - 42ms/step
Epoch 3/50
538/538 - 23s - loss: 3.2663 - accuracy300: 0.3820 - val_loss: 3.4264 - val_accuracy300: 0.3471 - 23s/epoch - 42ms/step
Epoch 4/50
538/538 - 23s - loss: 3.2482 - accuracy300: 0.3956 - val_loss: 3.4476 - val_accuracy300: 0.3495 - 23s/epoch - 42ms/step
Epoch 5/50
538/538 - 23s - loss: 3.2312 - accuracy300: 0.4066 - val_loss: 3.4289 - val_accuracy300: 0.3462 - 23s/epoch - 42ms/step
Epoch 6/50
538/538 - 23s - loss: 3.2207 - accuracy300: 0.4120 - val_loss: 3.4703 - val_accuracy300: 0.3444 - 23s/epoch - 43ms/step
Epoch 7/50
538/538 - 23s - loss: 3.2142 - accuracy300: 0.4145 - val_loss: 3.4267 - val_accuracy300: 0.3388 - 23s/epoch - 42ms/step
Epoch 8/50
538/538 - 23s - loss: 3.2041 - accuracy300: 0.4183 - val_loss: 3.4765 - val_accuracy300: 0.3389 - 23s/epoch - 42ms/step
Epoch 9/50
538/538 - 23s - loss: 3.1922 - accuracy300: 0.4261 - val_loss: 3.4419 - val_accuracy300: 0.3332 - 23s/epoch - 42ms/step
Epoch 10/50
538/538 - 23s - loss: 3.1793 - accuracy300: 0.4314 - val_loss: 3.4641 - val_accuracy300: 0.3324 - 23s/epoch - 42ms/step
Epoch 11/50
538/538 - 23s - loss: 3.1690 - accuracy300: 0.4370 - val_loss: 3.5711 - val_accuracy300: 0.3329 - 23s/epoch - 42ms/step
testing model: results/PCAR/W4/deepLOB_L2/h300
Evaluating performance on  test set...
1590/1590 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.113371
{'0': {'precision': 0.34904638960606316, 'recall': 0.12725644100991393, 'f1-score': 0.18651327866846162, 'support': 131734}, '1': {'precision': 0.38835668528973, 'recall': 0.3601964202144616, 'f1-score': 0.37374686386076766, 'support': 147439}, '2': {'precision': 0.3184471174832035, 'recall': 0.5536214423182237, 'f1-score': 0.4043240648952551, 'support': 127822}, 'accuracy': 0.3455472425951179, 'macro avg': {'precision': 0.35195006412633223, 'recall': 0.34702476784753306, 'f1-score': 0.3215280691414948, 'support': 406995}, 'weighted avg': {'precision': 0.35367693918042153, 'recall': 0.3455472425951179, 'f1-score': 0.32274724440329766, 'support': 406995}}
[[16764 40935 74035]
 [16913 53107 77419]
 [14351 42706 70765]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1073369
{'0': {'precision': 0.34803480348034804, 'recall': 0.2310501272546199, 'f1-score': 0.27772605144848506, 'support': 45185}, '1': {'precision': 0.3926725623061904, 'recall': 0.22541866291591578, 'f1-score': 0.28641637462826186, 'support': 45502}, '2': {'precision': 0.3483464335201285, 'recall': 0.6046571027201907, 'f1-score': 0.4420343413753666, 'support': 46982}, 'accuracy': 0.35668886968017494, 'macro avg': {'precision': 0.3630179331022223, 'recall': 0.35370863096357547, 'f1-score': 0.3353922558173712, 'support': 137669}, 'weighted avg': {'precision': 0.36289470879398034, 'recall': 0.35668886968017494, 'f1-score': 0.3366714869689795, 'support': 137669}}
[[10440  7748 26997]
 [ 9099 10257 26146]
 [10458  8116 28408]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.131332
{'0': {'precision': 0.36272821219428175, 'recall': 0.05525238744884038, 'f1-score': 0.09589727243750285, 'support': 19058}, '1': {'precision': 0.3321533602004139, 'recall': 0.3493527322717379, 'f1-score': 0.340536013400335, 'support': 17458}, '2': {'precision': 0.3201663201663202, 'recall': 0.607799245994345, 'f1-score': 0.4194053208137715, 'support': 16976}, 'accuracy': 0.3265908920960144, 'macro avg': {'precision': 0.3383492975203386, 'recall': 0.33746812190497444, 'f1-score': 0.2852795355505365, 'support': 53492}, 'weighted avg': {'precision': 0.33924233682645816, 'recall': 0.3265908920960144, 'f1-score': 0.27840635358916405, 'support': 53492}}
[[ 1053  6526 11479]
 [  929  6099 10430]
 [  921  5737 10318]]
training model: results/PCAR/W4/deepLOB_L2/h500
Epoch 1/50
538/538 - 26s - loss: 3.3331 - accuracy500: 0.3592 - val_loss: 3.4488 - val_accuracy500: 0.3232 - 26s/epoch - 48ms/step
Epoch 2/50
538/538 - 23s - loss: 3.2974 - accuracy500: 0.3723 - val_loss: 3.4842 - val_accuracy500: 0.3204 - 23s/epoch - 42ms/step
Epoch 3/50
538/538 - 23s - loss: 3.2771 - accuracy500: 0.3806 - val_loss: 3.4878 - val_accuracy500: 0.3177 - 23s/epoch - 42ms/step
Epoch 4/50
538/538 - 23s - loss: 3.2509 - accuracy500: 0.3962 - val_loss: 3.5502 - val_accuracy500: 0.3106 - 23s/epoch - 42ms/step
Epoch 5/50
538/538 - 23s - loss: 3.2346 - accuracy500: 0.4036 - val_loss: 3.5582 - val_accuracy500: 0.3155 - 23s/epoch - 42ms/step
Epoch 6/50
538/538 - 23s - loss: 3.2184 - accuracy500: 0.4113 - val_loss: 3.4778 - val_accuracy500: 0.3219 - 23s/epoch - 42ms/step
Epoch 7/50
538/538 - 23s - loss: 3.2016 - accuracy500: 0.4203 - val_loss: 3.5349 - val_accuracy500: 0.3130 - 23s/epoch - 42ms/step
Epoch 8/50
538/538 - 23s - loss: 3.1870 - accuracy500: 0.4266 - val_loss: 3.5068 - val_accuracy500: 0.3140 - 23s/epoch - 43ms/step
Epoch 9/50
538/538 - 23s - loss: 3.1734 - accuracy500: 0.4331 - val_loss: 3.5669 - val_accuracy500: 0.3149 - 23s/epoch - 42ms/step
Epoch 10/50
538/538 - 23s - loss: 3.1635 - accuracy500: 0.4375 - val_loss: 3.6151 - val_accuracy500: 0.3112 - 23s/epoch - 42ms/step
Epoch 11/50
538/538 - 23s - loss: 3.1518 - accuracy500: 0.4430 - val_loss: 3.6491 - val_accuracy500: 0.3117 - 23s/epoch - 42ms/step
testing model: results/PCAR/W4/deepLOB_L2/h500
Evaluating performance on  test set...
1590/1590 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1409585
{'0': {'precision': 0.3540925578705732, 'recall': 0.1515403767698584, 'f1-score': 0.21224614124184002, 'support': 133344}, '1': {'precision': 0.357638633409364, 'recall': 0.09995064842486223, 'f1-score': 0.1562371092599041, 'support': 145892}, '2': {'precision': 0.3152690398020411, 'recall': 0.7628973301293842, 'f1-score': 0.4461610294016672, 'support': 127759}, 'accuracy': 0.3249573090578508, 'macro avg': {'precision': 0.34233341036065945, 'recall': 0.3381294517747016, 'f1-score': 0.2715480933011371, 'support': 406995}, 'weighted avg': {'precision': 0.34317667489311077, 'recall': 0.3249573090578508, 'f1-score': 0.2655968273743546, 'support': 406995}}
[[ 20207  12919 100218]
 [ 19840  14582 111470]
 [ 17020  13272  97467]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1197219
{'0': {'precision': 0.332987180405357, 'recall': 0.20701707517976803, 'f1-score': 0.25530921820303387, 'support': 44919}, '1': {'precision': 0.3701862307238561, 'recall': 0.0964794764236927, 'f1-score': 0.15306620209059232, 'support': 45533}, '2': {'precision': 0.34893130082962115, 'recall': 0.7232988118686067, 'f1-score': 0.4707601331559758, 'support': 47217}, 'accuracy': 0.3475292186330982, 'macro avg': {'precision': 0.35070157065294477, 'recall': 0.3422651211573558, 'f1-score': 0.29304518448320066, 'support': 137669}, 'weighted avg': {'precision': 0.35075892199006165, 'recall': 0.3475292186330982, 'f1-score': 0.29538733745054246, 'support': 137669}}
[[ 9299  3805 31815]
 [ 9231  4393 31909]
 [ 9396  3669 34152]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1430544
{'0': {'precision': 0.363543490951547, 'recall': 0.13138185654008439, 'f1-score': 0.1930110026344336, 'support': 18960}, '1': {'precision': 0.3410514329094705, 'recall': 0.10139366924335609, 'f1-score': 0.1563152400835073, 'support': 17723}, '2': {'precision': 0.3134321142829518, 'recall': 0.7714319709679338, 'f1-score': 0.44575455482983845, 'support': 16809}, 'accuracy': 0.32257159949151276, 'macro avg': {'precision': 0.3393423460479898, 'recall': 0.3347358322504581, 'f1-score': 0.26502693251592646, 'support': 53492}, 'weighted avg': {'precision': 0.34034471589916276, 'recall': 0.32257159949151276, 'f1-score': 0.26027353477311777, 'support': 53492}}
[[ 2491  1853 14616]
 [ 2138  1797 13788]
 [ 2223  1619 12967]]
training model: results/PCAR/W4/deepLOB_L2/h1000
Epoch 1/50
538/538 - 25s - loss: 3.3199 - accuracy1000: 0.3785 - val_loss: 3.4218 - val_accuracy1000: 0.3070 - 25s/epoch - 46ms/step
Epoch 2/50
538/538 - 23s - loss: 3.2863 - accuracy1000: 0.3842 - val_loss: 3.5574 - val_accuracy1000: 0.3098 - 23s/epoch - 42ms/step
Epoch 3/50
538/538 - 23s - loss: 3.2705 - accuracy1000: 0.3856 - val_loss: 3.5065 - val_accuracy1000: 0.3096 - 23s/epoch - 42ms/step
Epoch 4/50
538/538 - 23s - loss: 3.2396 - accuracy1000: 0.4063 - val_loss: 3.4196 - val_accuracy1000: 0.3038 - 23s/epoch - 43ms/step
Epoch 5/50
538/538 - 23s - loss: 3.2292 - accuracy1000: 0.4146 - val_loss: 3.4671 - val_accuracy1000: 0.2956 - 23s/epoch - 42ms/step
Epoch 6/50
538/538 - 23s - loss: 3.2119 - accuracy1000: 0.4204 - val_loss: 3.4866 - val_accuracy1000: 0.3042 - 23s/epoch - 42ms/step
Epoch 7/50
538/538 - 23s - loss: 3.1998 - accuracy1000: 0.4249 - val_loss: 3.5027 - val_accuracy1000: 0.3025 - 23s/epoch - 42ms/step
Epoch 8/50
538/538 - 23s - loss: 3.1892 - accuracy1000: 0.4294 - val_loss: 3.4886 - val_accuracy1000: 0.3001 - 23s/epoch - 42ms/step
Epoch 9/50
538/538 - 23s - loss: 3.1708 - accuracy1000: 0.4342 - val_loss: 3.5940 - val_accuracy1000: 0.3052 - 23s/epoch - 42ms/step
Epoch 10/50
538/538 - 23s - loss: 3.1616 - accuracy1000: 0.4395 - val_loss: 3.6200 - val_accuracy1000: 0.3144 - 23s/epoch - 42ms/step
Epoch 11/50
538/538 - 23s - loss: 3.1586 - accuracy1000: 0.4397 - val_loss: 3.7028 - val_accuracy1000: 0.3128 - 23s/epoch - 42ms/step
Epoch 12/50
538/538 - 23s - loss: 3.1371 - accuracy1000: 0.4500 - val_loss: 3.6773 - val_accuracy1000: 0.3075 - 23s/epoch - 42ms/step
Epoch 13/50
538/538 - 23s - loss: 3.1362 - accuracy1000: 0.4495 - val_loss: 3.7003 - val_accuracy1000: 0.3139 - 23s/epoch - 42ms/step
Epoch 14/50
538/538 - 23s - loss: 3.1224 - accuracy1000: 0.4552 - val_loss: 3.7007 - val_accuracy1000: 0.3179 - 23s/epoch - 42ms/step
testing model: results/PCAR/W4/deepLOB_L2/h1000
Evaluating performance on  test set...
1590/1590 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1131988
{'0': {'precision': 0.37718016174607816, 'recall': 0.11483409721295183, 'f1-score': 0.17606458582068338, 'support': 134838}, '1': {'precision': 0.3577175506396588, 'recall': 0.30708346143671217, 'f1-score': 0.3304722516110416, 'support': 139861}, '2': {'precision': 0.3351648575112149, 'recall': 0.6229213279313055, 'f1-score': 0.43582997289614595, 'support': 132296}, 'accuracy': 0.34605584835194536, 'macro avg': {'precision': 0.35668752329898396, 'recall': 0.34827962886032315, 'f1-score': 0.3141222701092903, 'support': 406995}, 'weighted avg': {'precision': 0.3568346613320426, 'recall': 0.34605584835194536, 'f1-score': 0.3135638970988089, 'support': 406995}}
[[15484 37449 81905]
 [15348 42949 81564]
 [10220 39666 82410]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1222037
{'0': {'precision': 0.35345294623792983, 'recall': 0.24604019699188073, 'f1-score': 0.29012386047059135, 'support': 45078}, '1': {'precision': 0.34816929305875155, 'recall': 0.26680208031070735, 'f1-score': 0.30210281554870344, 'support': 44801}, '2': {'precision': 0.3507413944051474, 'recall': 0.5281230382925298, 'f1-score': 0.4215317038138106, 'support': 47790}, 'accuracy': 0.3507180265709782, 'macro avg': {'precision': 0.35078787790060956, 'recall': 0.34698843853170597, 'f1-score': 0.33791945994436845, 'support': 137669}, 'weighted avg': {'precision': 0.35079223098490236, 'recall': 0.3507180265709782, 'f1-score': 0.33963863866921956, 'support': 137669}}
[[11091 10976 23011]
 [ 9139 11953 23709]
 [11149 11402 25239]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1344985
{'0': {'precision': 0.5349462365591398, 'recall': 0.010050505050505051, 'f1-score': 0.019730319254412057, 'support': 19800}, '1': {'precision': 0.30805421754228746, 'recall': 0.32015833284824496, 'f1-score': 0.31398966688550795, 'support': 17179}, '2': {'precision': 0.3027845516928486, 'recall': 0.6466420396051595, 'f1-score': 0.4124451997914212, 'support': 16513}, 'accuracy': 0.3061579301577806, 'macro avg': {'precision': 0.3819283352647586, 'recall': 0.32561695916796984, 'f1-score': 0.2487217286437804, 'support': 53492}, 'weighted avg': {'precision': 0.39041127998829606, 'recall': 0.3061579301577806, 'f1-score': 0.23546317940662598, 'support': 53492}}
[[  199  6598 13003]
 [   94  5500 11585]
 [   79  5756 10678]]
training model: results/PCAR/W4/deepOF_L2/h10
Epoch 1/50
538/538 - 15s - loss: 3.2502 - accuracy10: 0.3968 - val_loss: 3.1859 - val_accuracy10: 0.4247 - 15s/epoch - 28ms/step
Epoch 2/50
538/538 - 13s - loss: 3.1595 - accuracy10: 0.4382 - val_loss: 3.1470 - val_accuracy10: 0.4399 - 13s/epoch - 24ms/step
Epoch 3/50
538/538 - 13s - loss: 3.1165 - accuracy10: 0.4583 - val_loss: 3.1316 - val_accuracy10: 0.4455 - 13s/epoch - 24ms/step
Epoch 4/50
538/538 - 13s - loss: 3.0879 - accuracy10: 0.4689 - val_loss: 3.1276 - val_accuracy10: 0.4478 - 13s/epoch - 24ms/step
Epoch 5/50
538/538 - 13s - loss: 3.0671 - accuracy10: 0.4771 - val_loss: 3.1258 - val_accuracy10: 0.4513 - 13s/epoch - 24ms/step
Epoch 6/50
538/538 - 13s - loss: 3.0521 - accuracy10: 0.4819 - val_loss: 3.1259 - val_accuracy10: 0.4516 - 13s/epoch - 24ms/step
Epoch 7/50
538/538 - 13s - loss: 3.0402 - accuracy10: 0.4842 - val_loss: 3.1181 - val_accuracy10: 0.4573 - 13s/epoch - 24ms/step
Epoch 8/50
538/538 - 13s - loss: 3.0287 - accuracy10: 0.4893 - val_loss: 3.1089 - val_accuracy10: 0.4595 - 13s/epoch - 24ms/step
Epoch 9/50
538/538 - 13s - loss: 3.0163 - accuracy10: 0.4935 - val_loss: 3.1030 - val_accuracy10: 0.4619 - 13s/epoch - 24ms/step
Epoch 10/50
538/538 - 13s - loss: 3.0081 - accuracy10: 0.4953 - val_loss: 3.1013 - val_accuracy10: 0.4631 - 13s/epoch - 24ms/step
Epoch 11/50
538/538 - 13s - loss: 3.0004 - accuracy10: 0.4976 - val_loss: 3.0975 - val_accuracy10: 0.4651 - 13s/epoch - 24ms/step
Epoch 12/50
538/538 - 13s - loss: 2.9918 - accuracy10: 0.4995 - val_loss: 3.0925 - val_accuracy10: 0.4665 - 13s/epoch - 24ms/step
Epoch 13/50
538/538 - 13s - loss: 2.9833 - accuracy10: 0.5025 - val_loss: 3.0904 - val_accuracy10: 0.4686 - 13s/epoch - 24ms/step
Epoch 14/50
538/538 - 13s - loss: 2.9763 - accuracy10: 0.5050 - val_loss: 3.0853 - val_accuracy10: 0.4686 - 13s/epoch - 24ms/step
Epoch 15/50
538/538 - 13s - loss: 2.9717 - accuracy10: 0.5064 - val_loss: 3.0867 - val_accuracy10: 0.4701 - 13s/epoch - 24ms/step
Epoch 16/50
538/538 - 13s - loss: 2.9638 - accuracy10: 0.5083 - val_loss: 3.0831 - val_accuracy10: 0.4711 - 13s/epoch - 24ms/step
Epoch 17/50
538/538 - 13s - loss: 2.9587 - accuracy10: 0.5104 - val_loss: 3.0777 - val_accuracy10: 0.4729 - 13s/epoch - 24ms/step
Epoch 18/50
538/538 - 13s - loss: 2.9508 - accuracy10: 0.5114 - val_loss: 3.0791 - val_accuracy10: 0.4730 - 13s/epoch - 24ms/step
Epoch 19/50
538/538 - 13s - loss: 2.9451 - accuracy10: 0.5143 - val_loss: 3.0777 - val_accuracy10: 0.4739 - 13s/epoch - 24ms/step
Epoch 20/50
538/538 - 13s - loss: 2.9376 - accuracy10: 0.5162 - val_loss: 3.0811 - val_accuracy10: 0.4750 - 13s/epoch - 24ms/step
Epoch 21/50
538/538 - 13s - loss: 2.9321 - accuracy10: 0.5174 - val_loss: 3.0776 - val_accuracy10: 0.4733 - 13s/epoch - 24ms/step
Epoch 22/50
538/538 - 13s - loss: 2.9278 - accuracy10: 0.5171 - val_loss: 3.0759 - val_accuracy10: 0.4754 - 13s/epoch - 24ms/step
Epoch 23/50
538/538 - 13s - loss: 2.9219 - accuracy10: 0.5205 - val_loss: 3.0784 - val_accuracy10: 0.4735 - 13s/epoch - 24ms/step
Epoch 24/50
538/538 - 13s - loss: 2.9156 - accuracy10: 0.5222 - val_loss: 3.0815 - val_accuracy10: 0.4747 - 13s/epoch - 24ms/step
Epoch 25/50
538/538 - 13s - loss: 2.9078 - accuracy10: 0.5236 - val_loss: 3.0901 - val_accuracy10: 0.4743 - 13s/epoch - 24ms/step
Epoch 26/50
538/538 - 13s - loss: 2.9027 - accuracy10: 0.5238 - val_loss: 3.0866 - val_accuracy10: 0.4761 - 13s/epoch - 24ms/step
Epoch 27/50
538/538 - 13s - loss: 2.8948 - accuracy10: 0.5253 - val_loss: 3.0955 - val_accuracy10: 0.4752 - 13s/epoch - 24ms/step
Epoch 28/50
538/538 - 13s - loss: 2.8902 - accuracy10: 0.5279 - val_loss: 3.0927 - val_accuracy10: 0.4738 - 13s/epoch - 24ms/step
Epoch 29/50
538/538 - 13s - loss: 2.8848 - accuracy10: 0.5287 - val_loss: 3.0934 - val_accuracy10: 0.4732 - 13s/epoch - 24ms/step
Epoch 30/50
538/538 - 13s - loss: 2.8790 - accuracy10: 0.5301 - val_loss: 3.0934 - val_accuracy10: 0.4722 - 13s/epoch - 24ms/step
Epoch 31/50
538/538 - 13s - loss: 2.8736 - accuracy10: 0.5337 - val_loss: 3.0958 - val_accuracy10: 0.4755 - 13s/epoch - 24ms/step
Epoch 32/50
538/538 - 13s - loss: 2.8695 - accuracy10: 0.5339 - val_loss: 3.1002 - val_accuracy10: 0.4735 - 13s/epoch - 24ms/step
testing model: results/PCAR/W4/deepOF_L2/h10
Evaluating performance on  test set...
1590/1590 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.010443
{'0': {'precision': 0.4761092150170648, 'recall': 0.3987048726512547, 'f1-score': 0.43398264069437226, 'support': 122459}, '1': {'precision': 0.4977985420412277, 'recall': 0.7016806722689075, 'f1-score': 0.5824121193043991, 'support': 166124}, '2': {'precision': 0.4901107032072626, 'recall': 0.2908925072630228, 'f1-score': 0.3650933296587983, 'support': 118408}, 'accuracy': 0.4910059436203749, 'macro avg': {'precision': 0.4880061534218518, 'recall': 0.4637593507277284, 'f1-score': 0.46049602988585653, 'support': 406991}, 'weighted avg': {'precision': 0.48903580547284137, 'recall': 0.4910059436203749, 'f1-score': 0.4745256825884482, 'support': 406991}}
[[ 48825  57950  15684]
 [ 29408 116566  20150]
 [ 24317  59647  34444]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9966908
{'0': {'precision': 0.5212068009610054, 'recall': 0.489276342896797, 'f1-score': 0.5047370834778134, 'support': 46113}, '1': {'precision': 0.4458521917529325, 'recall': 0.6315497581969032, 'f1-score': 0.5226978546052088, 'support': 45078}, '2': {'precision': 0.5736093821660224, 'recall': 0.37675359325243135, 'f1-score': 0.45479338199007824, 'support': 46476}, 'accuracy': 0.4978753078079714, 'macro avg': {'precision': 0.5135561249599868, 'recall': 0.4991932314487105, 'f1-score': 0.4940761066910335, 'support': 137667}, 'weighted avg': {'precision': 0.5142234809947307, 'recall': 0.4978753078079714, 'f1-score': 0.49375734374742597, 'support': 137667}}
[[22562 17163  6388]
 [ 9981 28469  6628]
 [10745 18221 17510]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0263433
{'0': {'precision': 0.4845395625168782, 'recall': 0.42244982047207014, 'f1-score': 0.45136945379076127, 'support': 16989}, '1': {'precision': 0.460010435301133, 'recall': 0.6239826095748445, 'f1-score': 0.5295947482461975, 'support': 19781}, '2': {'precision': 0.4911792014856082, 'recall': 0.34800550206327374, 'f1-score': 0.40737888546625595, 'support': 16721}, 'accuracy': 0.4737058570600662, 'macro avg': {'precision': 0.47857639976787314, 'recall': 0.4648126440367295, 'f1-score': 0.46278102916773817, 'support': 53491}, 'weighted avg': {'precision': 0.47754419390798086, 'recall': 0.4737058570600662, 'f1-score': 0.4665459929593865, 'support': 53491}}
[[ 7177  7180  2632]
 [ 4042 12343  3396]
 [ 3593  7309  5819]]
training model: results/PCAR/W4/deepOF_L2/h20
Epoch 1/50
538/538 - 15s - loss: 3.2880 - accuracy20: 0.3732 - val_loss: 3.2376 - val_accuracy20: 0.3944 - 15s/epoch - 27ms/step
Epoch 2/50
538/538 - 13s - loss: 3.2206 - accuracy20: 0.4094 - val_loss: 3.2072 - val_accuracy20: 0.4117 - 13s/epoch - 24ms/step
Epoch 3/50
538/538 - 13s - loss: 3.1913 - accuracy20: 0.4253 - val_loss: 3.1933 - val_accuracy20: 0.4163 - 13s/epoch - 24ms/step
Epoch 4/50
538/538 - 13s - loss: 3.1720 - accuracy20: 0.4355 - val_loss: 3.1893 - val_accuracy20: 0.4166 - 13s/epoch - 24ms/step
Epoch 5/50
538/538 - 13s - loss: 3.1549 - accuracy20: 0.4427 - val_loss: 3.1874 - val_accuracy20: 0.4179 - 13s/epoch - 24ms/step
Epoch 6/50
538/538 - 13s - loss: 3.1455 - accuracy20: 0.4486 - val_loss: 3.1827 - val_accuracy20: 0.4203 - 13s/epoch - 24ms/step
Epoch 7/50
538/538 - 13s - loss: 3.1364 - accuracy20: 0.4500 - val_loss: 3.1853 - val_accuracy20: 0.4208 - 13s/epoch - 24ms/step
Epoch 8/50
538/538 - 13s - loss: 3.1276 - accuracy20: 0.4553 - val_loss: 3.1746 - val_accuracy20: 0.4250 - 13s/epoch - 24ms/step
Epoch 9/50
538/538 - 13s - loss: 3.1197 - accuracy20: 0.4556 - val_loss: 3.1787 - val_accuracy20: 0.4252 - 13s/epoch - 24ms/step
Epoch 10/50
538/538 - 13s - loss: 3.1138 - accuracy20: 0.4586 - val_loss: 3.1709 - val_accuracy20: 0.4280 - 13s/epoch - 24ms/step
Epoch 11/50
538/538 - 13s - loss: 3.1064 - accuracy20: 0.4618 - val_loss: 3.1682 - val_accuracy20: 0.4281 - 13s/epoch - 24ms/step
Epoch 12/50
538/538 - 13s - loss: 3.1013 - accuracy20: 0.4636 - val_loss: 3.1664 - val_accuracy20: 0.4319 - 13s/epoch - 24ms/step
Epoch 13/50
538/538 - 13s - loss: 3.0939 - accuracy20: 0.4663 - val_loss: 3.1628 - val_accuracy20: 0.4332 - 13s/epoch - 24ms/step
Epoch 14/50
538/538 - 13s - loss: 3.0895 - accuracy20: 0.4681 - val_loss: 3.1639 - val_accuracy20: 0.4304 - 13s/epoch - 24ms/step
Epoch 15/50
538/538 - 13s - loss: 3.0836 - accuracy20: 0.4704 - val_loss: 3.1620 - val_accuracy20: 0.4378 - 13s/epoch - 24ms/step
Epoch 16/50
538/538 - 13s - loss: 3.0769 - accuracy20: 0.4737 - val_loss: 3.1627 - val_accuracy20: 0.4362 - 13s/epoch - 24ms/step
Epoch 17/50
538/538 - 13s - loss: 3.0708 - accuracy20: 0.4749 - val_loss: 3.1601 - val_accuracy20: 0.4383 - 13s/epoch - 24ms/step
Epoch 18/50
538/538 - 13s - loss: 3.0660 - accuracy20: 0.4748 - val_loss: 3.1550 - val_accuracy20: 0.4414 - 13s/epoch - 24ms/step
Epoch 19/50
538/538 - 13s - loss: 3.0605 - accuracy20: 0.4791 - val_loss: 3.1587 - val_accuracy20: 0.4406 - 13s/epoch - 24ms/step
Epoch 20/50
538/538 - 13s - loss: 3.0536 - accuracy20: 0.4809 - val_loss: 3.1571 - val_accuracy20: 0.4397 - 13s/epoch - 24ms/step
Epoch 21/50
538/538 - 13s - loss: 3.0475 - accuracy20: 0.4834 - val_loss: 3.1630 - val_accuracy20: 0.4396 - 13s/epoch - 24ms/step
Epoch 22/50
538/538 - 13s - loss: 3.0415 - accuracy20: 0.4840 - val_loss: 3.1609 - val_accuracy20: 0.4421 - 13s/epoch - 24ms/step
Epoch 23/50
538/538 - 13s - loss: 3.0350 - accuracy20: 0.4870 - val_loss: 3.1606 - val_accuracy20: 0.4410 - 13s/epoch - 24ms/step
Epoch 24/50
538/538 - 13s - loss: 3.0276 - accuracy20: 0.4904 - val_loss: 3.1712 - val_accuracy20: 0.4398 - 13s/epoch - 23ms/step
Epoch 25/50
538/538 - 13s - loss: 3.0228 - accuracy20: 0.4922 - val_loss: 3.1695 - val_accuracy20: 0.4402 - 13s/epoch - 23ms/step
Epoch 26/50
538/538 - 12s - loss: 3.0166 - accuracy20: 0.4934 - val_loss: 3.1729 - val_accuracy20: 0.4430 - 12s/epoch - 23ms/step
Epoch 27/50
538/538 - 13s - loss: 3.0102 - accuracy20: 0.4938 - val_loss: 3.1694 - val_accuracy20: 0.4405 - 13s/epoch - 24ms/step
Epoch 28/50
538/538 - 13s - loss: 3.0027 - accuracy20: 0.4977 - val_loss: 3.1764 - val_accuracy20: 0.4404 - 13s/epoch - 24ms/step
testing model: results/PCAR/W4/deepOF_L2/h20
Evaluating performance on  test set...
1590/1590 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0426112
{'0': {'precision': 0.4417657107881202, 'recall': 0.3858774148758748, 'f1-score': 0.4119345770508562, 'support': 125317}, '1': {'precision': 0.4645108718960415, 'recall': 0.6050913108790922, 'f1-score': 0.5255626753937852, 'support': 161098}, '2': {'precision': 0.4347305389221557, 'recall': 0.3161076831210191, 'f1-score': 0.3660486624313929, 'support': 120576}, 'accuracy': 0.45197805356875215, 'macro avg': {'precision': 0.44700237386877245, 'recall': 0.4356921362919954, 'f1-score': 0.4345153049586781, 'support': 406991}, 'weighted avg': {'precision': 0.448684603543128, 'recall': 0.45197805356875215, 'f1-score': 0.4433173824340041, 'support': 406991}}
[[48357 56375 20585]
 [34644 97479 28975]
 [26462 55999 38115]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0295813
{'0': {'precision': 0.4776661821065151, 'recall': 0.47204144265720566, 'f1-score': 0.47483715583775793, 'support': 45943}, '1': {'precision': 0.4285474985110185, 'recall': 0.5058771833461496, 'f1-score': 0.46401257519422023, 'support': 45515}, '2': {'precision': 0.503542050496925, 'recall': 0.41993983855958794, 'f1-score': 0.45795671772119034, 'support': 46209}, 'accuracy': 0.4657397923975971, 'macro avg': {'precision': 0.4699185770381529, 'recall': 0.465952821520981, 'f1-score': 0.46560214958438945, 'support': 137667}, 'weighted avg': {'precision': 0.4701121649390271, 'recall': 0.4657397923975971, 'f1-score': 0.46559231900017817, 'support': 137667}}
[[21687 15277  8979]
 [12337 23025 10153]
 [11378 15426 19405]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0519402
{'0': {'precision': 0.4493647234678625, 'recall': 0.4187463726059199, 'f1-score': 0.43351559214084, 'support': 17230}, '1': {'precision': 0.42762169300122943, 'recall': 0.4933802668908269, 'f1-score': 0.45815343334552994, 'support': 19034}, '2': {'precision': 0.449398991857309, 'recall': 0.40366865966215826, 'f1-score': 0.4253080945536834, 'support': 17227}, 'accuracy': 0.4404479258192967, 'macro avg': {'precision': 0.44212846944213363, 'recall': 0.4385984330529684, 'f1-score': 0.43899237334668445, 'support': 53491}, 'weighted avg': {'precision': 0.4416388162992379, 'recall': 0.4404479258192967, 'f1-score': 0.43963935330731885, 'support': 53491}}
[[7215 6290 3725]
 [4848 9391 4795]
 [3993 6280 6954]]
training model: results/PCAR/W4/deepOF_L2/h30
Epoch 1/50
538/538 - 15s - loss: 3.3009 - accuracy30: 0.3669 - val_loss: 3.2604 - val_accuracy30: 0.3828 - 15s/epoch - 28ms/step
Epoch 2/50
538/538 - 13s - loss: 3.2462 - accuracy30: 0.3962 - val_loss: 3.2397 - val_accuracy30: 0.3948 - 13s/epoch - 23ms/step
Epoch 3/50
538/538 - 13s - loss: 3.2244 - accuracy30: 0.4082 - val_loss: 3.2285 - val_accuracy30: 0.4028 - 13s/epoch - 24ms/step
Epoch 4/50
538/538 - 13s - loss: 3.2101 - accuracy30: 0.4169 - val_loss: 3.2181 - val_accuracy30: 0.4077 - 13s/epoch - 24ms/step
Epoch 5/50
538/538 - 13s - loss: 3.1995 - accuracy30: 0.4238 - val_loss: 3.2166 - val_accuracy30: 0.4099 - 13s/epoch - 24ms/step
Epoch 6/50
538/538 - 13s - loss: 3.1904 - accuracy30: 0.4281 - val_loss: 3.2143 - val_accuracy30: 0.4106 - 13s/epoch - 24ms/step
Epoch 7/50
538/538 - 13s - loss: 3.1834 - accuracy30: 0.4311 - val_loss: 3.2086 - val_accuracy30: 0.4121 - 13s/epoch - 24ms/step
Epoch 8/50
538/538 - 13s - loss: 3.1760 - accuracy30: 0.4351 - val_loss: 3.2056 - val_accuracy30: 0.4152 - 13s/epoch - 24ms/step
Epoch 9/50
538/538 - 13s - loss: 3.1697 - accuracy30: 0.4370 - val_loss: 3.2057 - val_accuracy30: 0.4156 - 13s/epoch - 24ms/step
Epoch 10/50
538/538 - 13s - loss: 3.1637 - accuracy30: 0.4411 - val_loss: 3.2035 - val_accuracy30: 0.4158 - 13s/epoch - 24ms/step
Epoch 11/50
538/538 - 13s - loss: 3.1580 - accuracy30: 0.4432 - val_loss: 3.2030 - val_accuracy30: 0.4183 - 13s/epoch - 24ms/step
Epoch 12/50
538/538 - 13s - loss: 3.1529 - accuracy30: 0.4449 - val_loss: 3.2023 - val_accuracy30: 0.4177 - 13s/epoch - 24ms/step
Epoch 13/50
538/538 - 13s - loss: 3.1479 - accuracy30: 0.4466 - val_loss: 3.2015 - val_accuracy30: 0.4176 - 13s/epoch - 24ms/step
Epoch 14/50
538/538 - 13s - loss: 3.1416 - accuracy30: 0.4499 - val_loss: 3.2033 - val_accuracy30: 0.4167 - 13s/epoch - 24ms/step
Epoch 15/50
538/538 - 13s - loss: 3.1374 - accuracy30: 0.4524 - val_loss: 3.2075 - val_accuracy30: 0.4189 - 13s/epoch - 24ms/step
Epoch 16/50
538/538 - 13s - loss: 3.1289 - accuracy30: 0.4543 - val_loss: 3.2032 - val_accuracy30: 0.4209 - 13s/epoch - 24ms/step
Epoch 17/50
538/538 - 13s - loss: 3.1260 - accuracy30: 0.4553 - val_loss: 3.2024 - val_accuracy30: 0.4186 - 13s/epoch - 24ms/step
Epoch 18/50
538/538 - 13s - loss: 3.1197 - accuracy30: 0.4573 - val_loss: 3.2048 - val_accuracy30: 0.4213 - 13s/epoch - 24ms/step
Epoch 19/50
538/538 - 13s - loss: 3.1133 - accuracy30: 0.4607 - val_loss: 3.2136 - val_accuracy30: 0.4188 - 13s/epoch - 24ms/step
Epoch 20/50
538/538 - 13s - loss: 3.1088 - accuracy30: 0.4627 - val_loss: 3.2096 - val_accuracy30: 0.4177 - 13s/epoch - 24ms/step
Epoch 21/50
538/538 - 13s - loss: 3.1016 - accuracy30: 0.4660 - val_loss: 3.2139 - val_accuracy30: 0.4188 - 13s/epoch - 24ms/step
Epoch 22/50
538/538 - 13s - loss: 3.0949 - accuracy30: 0.4675 - val_loss: 3.2071 - val_accuracy30: 0.4216 - 13s/epoch - 23ms/step
Epoch 23/50
538/538 - 13s - loss: 3.0907 - accuracy30: 0.4694 - val_loss: 3.2140 - val_accuracy30: 0.4189 - 13s/epoch - 24ms/step
testing model: results/PCAR/W4/deepOF_L2/h30
Evaluating performance on  test set...
1590/1590 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.06148
{'0': {'precision': 0.4424478405566188, 'recall': 0.36142536985837176, 'f1-score': 0.397853473270147, 'support': 129847}, '1': {'precision': 0.41661883941522054, 'recall': 0.5285314305760562, 'f1-score': 0.46594950706218397, 'support': 151079}, '2': {'precision': 0.4173531026908292, 'recall': 0.3617181612660136, 'f1-score': 0.3875491341761394, 'support': 126065}, 'accuracy': 0.4235474494521992, 'macro avg': {'precision': 0.4254732608875562, 'recall': 0.41722498723348056, 'f1-score': 0.4171173715028234, 'support': 406991}, 'weighted avg': {'precision': 0.425086798684705, 'recall': 0.4235474494521992, 'f1-score': 0.4199396230409799, 'support': 406991}}
[[46930 56209 26708]
 [34277 79850 36952]
 [24862 55603 45600]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0533509
{'0': {'precision': 0.4649849673681895, 'recall': 0.41149494905795064, 'f1-score': 0.4366077576313978, 'support': 46229}, '1': {'precision': 0.393864336700862, 'recall': 0.44893739996443177, 'f1-score': 0.41960148766855737, 'support': 44984}, '2': {'precision': 0.4641616463655952, 'recall': 0.4544495630085676, 'f1-score': 0.4592542638357118, 'support': 46454}, 'accuracy': 0.4382241205227106, 'macro avg': {'precision': 0.4410036501448822, 'recall': 0.43829397067698334, 'f1-score': 0.43848783637855565, 'support': 137667}, 'weighted avg': {'precision': 0.4414678063652362, 'recall': 0.4382241205227106, 'f1-score': 0.4386925764420553, 'support': 137667}}
[[19023 15994 11212]
 [11630 20195 13159]
 [10258 15085 21111]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0665429
{'0': {'precision': 0.4481607629427793, 'recall': 0.3763514673073623, 'f1-score': 0.4091290693697336, 'support': 17481}, '1': {'precision': 0.3925832492431887, 'recall': 0.4230413744359267, 'f1-score': 0.4072436081961637, 'support': 18393}, '2': {'precision': 0.4304670633457954, 'recall': 0.4640404155077482, 'f1-score': 0.4466236888111888, 'support': 17617}, 'accuracy': 0.4212858237834402, 'macro avg': {'precision': 0.4237370251772545, 'recall': 0.42114441908367906, 'f1-score': 0.420998788792362, 'support': 53491}, 'weighted avg': {'precision': 0.42322297686144533, 'recall': 0.4212858237834402, 'f1-score': 0.42082941939748864, 'support': 53491}}
[[6579 6214 4688]
 [4484 7781 6128]
 [3617 5825 8175]]
training model: results/PCAR/W4/deepOF_L2/h50
Epoch 1/50
538/538 - 15s - loss: 3.3057 - accuracy50: 0.3664 - val_loss: 3.2738 - val_accuracy50: 0.3728 - 15s/epoch - 28ms/step
Epoch 2/50
538/538 - 13s - loss: 3.2581 - accuracy50: 0.3944 - val_loss: 3.2608 - val_accuracy50: 0.3777 - 13s/epoch - 24ms/step
Epoch 3/50
538/538 - 13s - loss: 3.2387 - accuracy50: 0.4041 - val_loss: 3.2529 - val_accuracy50: 0.3816 - 13s/epoch - 24ms/step
Epoch 4/50
538/538 - 13s - loss: 3.2282 - accuracy50: 0.4102 - val_loss: 3.2493 - val_accuracy50: 0.3827 - 13s/epoch - 24ms/step
Epoch 5/50
538/538 - 13s - loss: 3.2182 - accuracy50: 0.4155 - val_loss: 3.2476 - val_accuracy50: 0.3843 - 13s/epoch - 24ms/step
Epoch 6/50
538/538 - 13s - loss: 3.2105 - accuracy50: 0.4186 - val_loss: 3.2468 - val_accuracy50: 0.3839 - 13s/epoch - 24ms/step
Epoch 7/50
538/538 - 13s - loss: 3.2043 - accuracy50: 0.4233 - val_loss: 3.2484 - val_accuracy50: 0.3853 - 13s/epoch - 24ms/step
Epoch 8/50
538/538 - 13s - loss: 3.1986 - accuracy50: 0.4260 - val_loss: 3.2479 - val_accuracy50: 0.3830 - 13s/epoch - 24ms/step
Epoch 9/50
538/538 - 13s - loss: 3.1928 - accuracy50: 0.4286 - val_loss: 3.2482 - val_accuracy50: 0.3871 - 13s/epoch - 24ms/step
Epoch 10/50
538/538 - 13s - loss: 3.1898 - accuracy50: 0.4302 - val_loss: 3.2444 - val_accuracy50: 0.3886 - 13s/epoch - 24ms/step
Epoch 11/50
538/538 - 13s - loss: 3.1835 - accuracy50: 0.4328 - val_loss: 3.2476 - val_accuracy50: 0.3882 - 13s/epoch - 24ms/step
Epoch 12/50
538/538 - 13s - loss: 3.1791 - accuracy50: 0.4344 - val_loss: 3.2463 - val_accuracy50: 0.3870 - 13s/epoch - 24ms/step
Epoch 13/50
538/538 - 13s - loss: 3.1763 - accuracy50: 0.4357 - val_loss: 3.2438 - val_accuracy50: 0.3909 - 13s/epoch - 24ms/step
Epoch 14/50
538/538 - 13s - loss: 3.1705 - accuracy50: 0.4388 - val_loss: 3.2468 - val_accuracy50: 0.3926 - 13s/epoch - 24ms/step
Epoch 15/50
538/538 - 13s - loss: 3.1658 - accuracy50: 0.4410 - val_loss: 3.2460 - val_accuracy50: 0.3910 - 13s/epoch - 24ms/step
Epoch 16/50
538/538 - 13s - loss: 3.1624 - accuracy50: 0.4423 - val_loss: 3.2472 - val_accuracy50: 0.3931 - 13s/epoch - 24ms/step
Epoch 17/50
538/538 - 13s - loss: 3.1557 - accuracy50: 0.4468 - val_loss: 3.2457 - val_accuracy50: 0.3944 - 13s/epoch - 24ms/step
Epoch 18/50
538/538 - 13s - loss: 3.1502 - accuracy50: 0.4475 - val_loss: 3.2488 - val_accuracy50: 0.3909 - 13s/epoch - 24ms/step
Epoch 19/50
538/538 - 13s - loss: 3.1460 - accuracy50: 0.4486 - val_loss: 3.2530 - val_accuracy50: 0.3931 - 13s/epoch - 24ms/step
Epoch 20/50
538/538 - 13s - loss: 3.1405 - accuracy50: 0.4524 - val_loss: 3.2487 - val_accuracy50: 0.3957 - 13s/epoch - 24ms/step
Epoch 21/50
538/538 - 13s - loss: 3.1346 - accuracy50: 0.4529 - val_loss: 3.2528 - val_accuracy50: 0.3962 - 13s/epoch - 24ms/step
Epoch 22/50
538/538 - 13s - loss: 3.1262 - accuracy50: 0.4581 - val_loss: 3.2588 - val_accuracy50: 0.3940 - 13s/epoch - 24ms/step
Epoch 23/50
538/538 - 13s - loss: 3.1217 - accuracy50: 0.4599 - val_loss: 3.2633 - val_accuracy50: 0.3949 - 13s/epoch - 24ms/step
testing model: results/PCAR/W4/deepOF_L2/h50
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0652814
{'0': {'precision': 0.4027328919707571, 'recall': 0.21401774102110915, 'f1-score': 0.2795035113506451, 'support': 119948}, '1': {'precision': 0.4306731115688714, 'recall': 0.7483726919396567, 'f1-score': 0.5467200593763755, 'support': 169298}, '2': {'precision': 0.38831706173695046, 'recall': 0.1618072954265574, 'f1-score': 0.22843029111313606, 'support': 117745}, 'accuracy': 0.4211911319906337, 'macro avg': {'precision': 0.4072410217588596, 'recall': 0.37473257612910776, 'f1-score': 0.3515512872800522, 'support': 406991}, 'weighted avg': {'precision': 0.410184730872949, 'recall': 0.4211911319906337, 'f1-score': 0.3758830647825259, 'support': 406991}}
[[ 25671  83003  11274]
 [ 23863 126698  18737]
 [ 14208  84485  19052]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0755117
{'0': {'precision': 0.47622774408139307, 'recall': 0.26479547432550044, 'f1-score': 0.34034817870376843, 'support': 45960}, '1': {'precision': 0.3596098641531611, 'recall': 0.7013533768294833, 'f1-score': 0.475442659693687, 'support': 45368}, '2': {'precision': 0.48214134574693185, 'recall': 0.24586201687563392, 'f1-score': 0.3256585059097601, 'support': 46339}, 'accuracy': 0.4022895828339399, 'macro avg': {'precision': 0.4393263179938287, 'recall': 0.40400362267687256, 'f1-score': 0.3804831147690719, 'support': 137667}, 'weighted avg': {'precision': 0.4397869878434811, 'recall': 0.4022895828339399, 'f1-score': 0.37992383347905284, 'support': 137667}}
[[12170 28144  5646]
 [ 6958 31819  6591]
 [ 6427 28519 11393]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0816753
{'0': {'precision': 0.4357398301296379, 'recall': 0.22341278936511574, 'f1-score': 0.29537878787878785, 'support': 17452}, '1': {'precision': 0.36794842274925166, 'recall': 0.6845881974938417, 'f1-score': 0.4786401587479876, 'support': 18674}, '2': {'precision': 0.4273905500561282, 'recall': 0.24117477684998562, 'f1-score': 0.30834928581946697, 'support': 17365}, 'accuracy': 0.3901777869174254, 'macro avg': {'precision': 0.41035960097833923, 'recall': 0.38305858790298103, 'f1-score': 0.36078941081541416, 'support': 53491}, 'weighted avg': {'precision': 0.40936301926616875, 'recall': 0.3901777869174254, 'f1-score': 0.36356699778982576, 'support': 53491}}
[[ 3899 11024  2529]
 [ 2808 12784  3082]
 [ 2241 10936  4188]]
training model: results/PCAR/W4/deepOF_L2/h100
Epoch 1/50
538/538 - 15s - loss: 3.3269 - accuracy100: 0.3470 - val_loss: 3.3052 - val_accuracy100: 0.3524 - 15s/epoch - 27ms/step
Epoch 2/50
538/538 - 13s - loss: 3.2885 - accuracy100: 0.3692 - val_loss: 3.2951 - val_accuracy100: 0.3578 - 13s/epoch - 24ms/step
Epoch 3/50
538/538 - 13s - loss: 3.2712 - accuracy100: 0.3809 - val_loss: 3.2897 - val_accuracy100: 0.3637 - 13s/epoch - 24ms/step
Epoch 4/50
538/538 - 13s - loss: 3.2610 - accuracy100: 0.3890 - val_loss: 3.2848 - val_accuracy100: 0.3692 - 13s/epoch - 24ms/step
Epoch 5/50
538/538 - 13s - loss: 3.2539 - accuracy100: 0.3941 - val_loss: 3.2837 - val_accuracy100: 0.3704 - 13s/epoch - 24ms/step
Epoch 6/50
538/538 - 13s - loss: 3.2481 - accuracy100: 0.3984 - val_loss: 3.2830 - val_accuracy100: 0.3726 - 13s/epoch - 24ms/step
Epoch 7/50
538/538 - 13s - loss: 3.2418 - accuracy100: 0.4033 - val_loss: 3.2800 - val_accuracy100: 0.3746 - 13s/epoch - 24ms/step
Epoch 8/50
538/538 - 13s - loss: 3.2366 - accuracy100: 0.4061 - val_loss: 3.2802 - val_accuracy100: 0.3757 - 13s/epoch - 24ms/step
Epoch 9/50
538/538 - 13s - loss: 3.2333 - accuracy100: 0.4082 - val_loss: 3.2789 - val_accuracy100: 0.3771 - 13s/epoch - 24ms/step
Epoch 10/50
538/538 - 13s - loss: 3.2298 - accuracy100: 0.4105 - val_loss: 3.2817 - val_accuracy100: 0.3780 - 13s/epoch - 24ms/step
Epoch 11/50
538/538 - 13s - loss: 3.2254 - accuracy100: 0.4112 - val_loss: 3.2792 - val_accuracy100: 0.3793 - 13s/epoch - 24ms/step
Epoch 12/50
538/538 - 13s - loss: 3.2219 - accuracy100: 0.4148 - val_loss: 3.2795 - val_accuracy100: 0.3789 - 13s/epoch - 24ms/step
Epoch 13/50
538/538 - 13s - loss: 3.2183 - accuracy100: 0.4161 - val_loss: 3.2819 - val_accuracy100: 0.3791 - 13s/epoch - 24ms/step
Epoch 14/50
538/538 - 13s - loss: 3.2150 - accuracy100: 0.4172 - val_loss: 3.2812 - val_accuracy100: 0.3794 - 13s/epoch - 24ms/step
Epoch 15/50
538/538 - 13s - loss: 3.2093 - accuracy100: 0.4201 - val_loss: 3.2842 - val_accuracy100: 0.3771 - 13s/epoch - 24ms/step
Epoch 16/50
538/538 - 13s - loss: 3.2050 - accuracy100: 0.4211 - val_loss: 3.2855 - val_accuracy100: 0.3788 - 13s/epoch - 24ms/step
Epoch 17/50
538/538 - 13s - loss: 3.2017 - accuracy100: 0.4231 - val_loss: 3.2820 - val_accuracy100: 0.3810 - 13s/epoch - 24ms/step
Epoch 18/50
538/538 - 13s - loss: 3.1980 - accuracy100: 0.4255 - val_loss: 3.2854 - val_accuracy100: 0.3793 - 13s/epoch - 24ms/step
Epoch 19/50
538/538 - 13s - loss: 3.1948 - accuracy100: 0.4267 - val_loss: 3.2874 - val_accuracy100: 0.3791 - 13s/epoch - 24ms/step
testing model: results/PCAR/W4/deepOF_L2/h100
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0901681
{'0': {'precision': 0.38139765017653027, 'recall': 0.3521327417868729, 'f1-score': 0.36618141999066006, 'support': 129153}, '1': {'precision': 0.40102416908574967, 'recall': 0.32484345689450184, 'f1-score': 0.3589361826356046, 'support': 151396}, '2': {'precision': 0.34537768302727845, 'recall': 0.45100520396703625, 'f1-score': 0.39118653834281125, 'support': 126442}, 'accuracy': 0.3726986591841097, 'macro avg': {'precision': 0.3759331674298528, 'recall': 0.37599380088280365, 'f1-score': 0.3721013803230253, 'support': 406991}, 'weighted avg': {'precision': 0.3775079812907183, 'recall': 0.3726986591841097, 'f1-score': 0.37125474402012687, 'support': 406991}}
[[45479 35663 48011]
 [42141 49180 60075]
 [31623 37793 57026]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0794868
{'0': {'precision': 0.4106255084515954, 'recall': 0.3983121437965804, 'f1-score': 0.4043751112693609, 'support': 45620}, '1': {'precision': 0.3923026783598009, 'recall': 0.29109415877063777, 'f1-score': 0.3342041166597257, 'support': 45487}, '2': {'precision': 0.39406332232707036, 'recall': 0.5049613402061855, 'f1-score': 0.4426724908918031, 'support': 46560}, 'accuracy': 0.39895545047106423, 'macro avg': {'precision': 0.39899716971282223, 'recall': 0.3981225475911345, 'f1-score': 0.3937505729402966, 'support': 137667}, 'weighted avg': {'precision': 0.3989699485981567, 'recall': 0.39895545047106423, 'f1-score': 0.39414214304467693, 'support': 137667}}
[[18171 10024 17425]
 [13519 13241 18727]
 [12562 10487 23511]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0920392
{'0': {'precision': 0.39328026076600014, 'recall': 0.34958488883936034, 'f1-score': 0.3701474926253688, 'support': 17947}, '1': {'precision': 0.38720678755614707, 'recall': 0.254510661563696, 'f1-score': 0.3071390868302982, 'support': 18290}, '2': {'precision': 0.3666718921461044, 'recall': 0.5422510722151385, 'f1-score': 0.43750292260930557, 'support': 17254}, 'accuracy': 0.3792226729730235, 'macro avg': {'precision': 0.3823863134894172, 'recall': 0.38211554087273153, 'f1-score': 0.3715965006883242, 'support': 53491}, 'weighted avg': {'precision': 0.382620811191756, 'recall': 0.3792226729730235, 'f1-score': 0.3703293334387954, 'support': 53491}}
[[6274 3849 7824]
 [5299 4655 8336]
 [4380 3518 9356]]
training model: results/PCAR/W4/deepOF_L2/h200
Epoch 1/50
538/538 - 15s - loss: 3.3346 - accuracy200: 0.3415 - val_loss: 3.3130 - val_accuracy200: 0.3448 - 15s/epoch - 28ms/step
Epoch 2/50
538/538 - 13s - loss: 3.2965 - accuracy200: 0.3624 - val_loss: 3.3055 - val_accuracy200: 0.3513 - 13s/epoch - 24ms/step
Epoch 3/50
538/538 - 13s - loss: 3.2760 - accuracy200: 0.3768 - val_loss: 3.3071 - val_accuracy200: 0.3520 - 13s/epoch - 24ms/step
Epoch 4/50
538/538 - 13s - loss: 3.2605 - accuracy200: 0.3879 - val_loss: 3.3135 - val_accuracy200: 0.3508 - 13s/epoch - 24ms/step
Epoch 5/50
538/538 - 13s - loss: 3.2497 - accuracy200: 0.3958 - val_loss: 3.3153 - val_accuracy200: 0.3533 - 13s/epoch - 24ms/step
Epoch 6/50
538/538 - 13s - loss: 3.2440 - accuracy200: 0.3974 - val_loss: 3.3200 - val_accuracy200: 0.3526 - 13s/epoch - 24ms/step
Epoch 7/50
538/538 - 13s - loss: 3.2379 - accuracy200: 0.4009 - val_loss: 3.3205 - val_accuracy200: 0.3550 - 13s/epoch - 24ms/step
Epoch 8/50
538/538 - 13s - loss: 3.2329 - accuracy200: 0.4032 - val_loss: 3.3117 - val_accuracy200: 0.3572 - 13s/epoch - 24ms/step
Epoch 9/50
538/538 - 13s - loss: 3.2297 - accuracy200: 0.4062 - val_loss: 3.3129 - val_accuracy200: 0.3573 - 13s/epoch - 24ms/step
Epoch 10/50
538/538 - 13s - loss: 3.2253 - accuracy200: 0.4072 - val_loss: 3.3085 - val_accuracy200: 0.3598 - 13s/epoch - 24ms/step
Epoch 11/50
538/538 - 13s - loss: 3.2208 - accuracy200: 0.4101 - val_loss: 3.3080 - val_accuracy200: 0.3599 - 13s/epoch - 24ms/step
Epoch 12/50
538/538 - 13s - loss: 3.2182 - accuracy200: 0.4122 - val_loss: 3.3079 - val_accuracy200: 0.3598 - 13s/epoch - 24ms/step
testing model: results/PCAR/W4/deepOF_L2/h200
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0959338
{'0': {'precision': 0.35401511620838483, 'recall': 0.13481958206006728, 'f1-score': 0.1952732495431404, 'support': 129588}, '1': {'precision': 0.394289667316521, 'recall': 0.617856908218908, 'f1-score': 0.48138204619617375, 'support': 152210}, '2': {'precision': 0.3192109129066107, 'recall': 0.30373902694240096, 'f1-score': 0.31128283630350606, 'support': 125193}, 'accuracy': 0.3674307294264492, 'macro avg': {'precision': 0.35583856547717213, 'recall': 0.35213850574045874, 'f1-score': 0.3293127106809401, 'support': 406991}, 'weighted avg': {'precision': 0.35837134718206826, 'recall': 0.3674307294264492, 'f1-score': 0.33795996284601115, 'support': 406991}}
[[17471 71923 40194]
 [17261 94044 40905]
 [14619 72548 38026]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0934054
{'0': {'precision': 0.37541801718372175, 'recall': 0.16050061587189865, 'f1-score': 0.22486556447512368, 'support': 45464}, '1': {'precision': 0.3671454611738972, 'recall': 0.5550729749988976, 'f1-score': 0.44196150369076564, 'support': 45358}, '2': {'precision': 0.37238948746349815, 'recall': 0.39472729213363217, 'f1-score': 0.38323316062176166, 'support': 46845}, 'accuracy': 0.37020491475807565, 'macro avg': {'precision': 0.371650988607039, 'recall': 0.3701002943348095, 'f1-score': 0.35002007626255033, 'support': 137667}, 'weighted avg': {'precision': 0.3716618659620238, 'recall': 0.37020491475807565, 'f1-score': 0.3502824592460735, 'support': 137667}}
[[ 7297 21478 16689]
 [ 5706 25177 14475]
 [ 6434 21920 18491]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1002965
{'0': {'precision': 0.39048549107142855, 'recall': 0.1470063025210084, 'f1-score': 0.21359890109890112, 'support': 19040}, '1': {'precision': 0.3449097843626229, 'recall': 0.5516452577863804, 'f1-score': 0.42444208768644087, 'support': 17049}, '2': {'precision': 0.34447651535030177, 'recall': 0.3771980232157223, 'f1-score': 0.3600954549194942, 'support': 17402}, 'accuracy': 0.35086276195995586, 'macro avg': {'precision': 0.35995726359478436, 'recall': 0.3586165278410371, 'f1-score': 0.332712147901612, 'support': 53491}, 'weighted avg': {'precision': 0.3609914001182313, 'recall': 0.35086276195995586, 'f1-score': 0.32845931720099164, 'support': 53491}}
[[2799 9337 6904]
 [2057 9405 5587]
 [2312 8526 6564]]
training model: results/PCAR/W4/deepOF_L2/h300
Epoch 1/50
538/538 - 15s - loss: 3.3386 - accuracy300: 0.3404 - val_loss: 3.3236 - val_accuracy300: 0.3355 - 15s/epoch - 28ms/step
Epoch 2/50
538/538 - 13s - loss: 3.3010 - accuracy300: 0.3566 - val_loss: 3.3123 - val_accuracy300: 0.3420 - 13s/epoch - 24ms/step
Epoch 3/50
538/538 - 13s - loss: 3.2815 - accuracy300: 0.3705 - val_loss: 3.3122 - val_accuracy300: 0.3419 - 13s/epoch - 24ms/step
Epoch 4/50
538/538 - 13s - loss: 3.2694 - accuracy300: 0.3793 - val_loss: 3.3100 - val_accuracy300: 0.3490 - 13s/epoch - 24ms/step
Epoch 5/50
538/538 - 13s - loss: 3.2594 - accuracy300: 0.3854 - val_loss: 3.3093 - val_accuracy300: 0.3496 - 13s/epoch - 24ms/step
Epoch 6/50
538/538 - 13s - loss: 3.2531 - accuracy300: 0.3899 - val_loss: 3.3118 - val_accuracy300: 0.3502 - 13s/epoch - 24ms/step
Epoch 7/50
538/538 - 13s - loss: 3.2475 - accuracy300: 0.3937 - val_loss: 3.3116 - val_accuracy300: 0.3517 - 13s/epoch - 24ms/step
Epoch 8/50
538/538 - 13s - loss: 3.2429 - accuracy300: 0.3949 - val_loss: 3.3115 - val_accuracy300: 0.3524 - 13s/epoch - 24ms/step
Epoch 9/50
538/538 - 13s - loss: 3.2386 - accuracy300: 0.3988 - val_loss: 3.3108 - val_accuracy300: 0.3534 - 13s/epoch - 24ms/step
Epoch 10/50
538/538 - 13s - loss: 3.2354 - accuracy300: 0.3997 - val_loss: 3.3113 - val_accuracy300: 0.3537 - 13s/epoch - 25ms/step
Epoch 11/50
538/538 - 13s - loss: 3.2318 - accuracy300: 0.4026 - val_loss: 3.3155 - val_accuracy300: 0.3532 - 13s/epoch - 25ms/step
Epoch 12/50
538/538 - 13s - loss: 3.2290 - accuracy300: 0.4044 - val_loss: 3.3148 - val_accuracy300: 0.3538 - 13s/epoch - 24ms/step
Epoch 13/50
538/538 - 13s - loss: 3.2267 - accuracy300: 0.4052 - val_loss: 3.3138 - val_accuracy300: 0.3541 - 13s/epoch - 24ms/step
Epoch 14/50
538/538 - 13s - loss: 3.2219 - accuracy300: 0.4081 - val_loss: 3.3172 - val_accuracy300: 0.3565 - 13s/epoch - 24ms/step
Epoch 15/50
538/538 - 13s - loss: 3.2190 - accuracy300: 0.4099 - val_loss: 3.3171 - val_accuracy300: 0.3569 - 13s/epoch - 25ms/step
testing model: results/PCAR/W4/deepOF_L2/h300
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0966967
{'0': {'precision': 0.36783617556611686, 'recall': 0.0799052614798339, 'f1-score': 0.13129026423943072, 'support': 131731}, '1': {'precision': 0.3815505997437988, 'recall': 0.7111008620514246, 'f1-score': 0.4966285588421285, 'support': 147439}, '2': {'precision': 0.322643859022502, 'recall': 0.2614828549299411, 'f1-score': 0.2888614246452215, 'support': 127821}, 'accuracy': 0.36559285094756394, 'macro avg': {'precision': 0.3573435447774726, 'recall': 0.35082965948706657, 'f1-score': 0.3055934159089269, 'support': 406991}, 'weighted avg': {'precision': 0.3586111899851381, 'recall': 0.36559285094756394, 'f1-score': 0.31312724862521746, 'support': 406991}}
[[ 10526  84368  36837]
 [  9264 104844  33331]
 [  8826  85572  33423]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0889976
{'0': {'precision': 0.3918148557815026, 'recall': 0.10195722446087765, 'f1-score': 0.16180888631212775, 'support': 45166}, '1': {'precision': 0.3733356368078779, 'recall': 0.6650984875131903, 'f1-score': 0.47822959889349936, 'support': 45488}, '2': {'precision': 0.3879492835973884, 'recall': 0.37032310212069003, 'f1-score': 0.37893133093916637, 'support': 47013}, 'accuracy': 0.37967704678681163, 'macro avg': {'precision': 0.3843665920622563, 'recall': 0.37912627136491933, 'f1-score': 0.33965660538159786, 'support': 137667}, 'weighted avg': {'precision': 0.38438885784616583, 'recall': 0.37967704678681163, 'f1-score': 0.34050765118063214, 'support': 137667}}
[[ 4605 25082 15479]
 [ 3246 30254 11988]
 [ 3902 25701 17410]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1017396
{'0': {'precision': 0.37776274244474517, 'recall': 0.08792189386383917, 'f1-score': 0.14264424100489675, 'support': 19051}, '1': {'precision': 0.3518826312088474, 'recall': 0.6291216640950912, 'f1-score': 0.45132725222916875, 'support': 17499}, '2': {'precision': 0.3372910922289123, 'recall': 0.3538161855852665, 'f1-score': 0.34535607282784053, 'support': 16941}, 'accuracy': 0.3491802359275392, 'macro avg': {'precision': 0.3556454886275016, 'recall': 0.35695324784806565, 'f1-score': 0.31310918868730203, 'support': 53491}, 'weighted avg': {'precision': 0.3564786704920167, 'recall': 0.3491802359275392, 'f1-score': 0.30782689147555586, 'support': 53491}}
[[ 1675 10756  6620]
 [ 1333 11009  5157]
 [ 1426  9521  5994]]
training model: results/PCAR/W4/deepOF_L2/h500
Epoch 1/50
538/538 - 15s - loss: 3.3373 - accuracy500: 0.3431 - val_loss: 3.3344 - val_accuracy500: 0.3313 - 15s/epoch - 28ms/step
Epoch 2/50
538/538 - 13s - loss: 3.3061 - accuracy500: 0.3540 - val_loss: 3.3166 - val_accuracy500: 0.3378 - 13s/epoch - 24ms/step
Epoch 3/50
538/538 - 13s - loss: 3.2895 - accuracy500: 0.3631 - val_loss: 3.3130 - val_accuracy500: 0.3373 - 13s/epoch - 24ms/step
Epoch 4/50
538/538 - 13s - loss: 3.2789 - accuracy500: 0.3694 - val_loss: 3.3056 - val_accuracy500: 0.3477 - 13s/epoch - 24ms/step
Epoch 5/50
538/538 - 13s - loss: 3.2698 - accuracy500: 0.3757 - val_loss: 3.3024 - val_accuracy500: 0.3528 - 13s/epoch - 24ms/step
Epoch 6/50
538/538 - 13s - loss: 3.2644 - accuracy500: 0.3793 - val_loss: 3.3036 - val_accuracy500: 0.3528 - 13s/epoch - 24ms/step
Epoch 7/50
538/538 - 13s - loss: 3.2596 - accuracy500: 0.3832 - val_loss: 3.3009 - val_accuracy500: 0.3562 - 13s/epoch - 25ms/step
Epoch 8/50
538/538 - 13s - loss: 3.2540 - accuracy500: 0.3869 - val_loss: 3.3006 - val_accuracy500: 0.3537 - 13s/epoch - 24ms/step
Epoch 9/50
538/538 - 13s - loss: 3.2516 - accuracy500: 0.3885 - val_loss: 3.2990 - val_accuracy500: 0.3556 - 13s/epoch - 24ms/step
Epoch 10/50
538/538 - 13s - loss: 3.2478 - accuracy500: 0.3921 - val_loss: 3.2998 - val_accuracy500: 0.3542 - 13s/epoch - 24ms/step
Epoch 11/50
538/538 - 13s - loss: 3.2442 - accuracy500: 0.3940 - val_loss: 3.3035 - val_accuracy500: 0.3542 - 13s/epoch - 24ms/step
Epoch 12/50
538/538 - 13s - loss: 3.2412 - accuracy500: 0.3969 - val_loss: 3.3020 - val_accuracy500: 0.3570 - 13s/epoch - 24ms/step
Epoch 13/50
538/538 - 13s - loss: 3.2389 - accuracy500: 0.3967 - val_loss: 3.2996 - val_accuracy500: 0.3580 - 13s/epoch - 24ms/step
Epoch 14/50
538/538 - 13s - loss: 3.2357 - accuracy500: 0.3989 - val_loss: 3.3031 - val_accuracy500: 0.3576 - 13s/epoch - 24ms/step
Epoch 15/50
538/538 - 13s - loss: 3.2327 - accuracy500: 0.4021 - val_loss: 3.3059 - val_accuracy500: 0.3575 - 13s/epoch - 24ms/step
Epoch 16/50
538/538 - 13s - loss: 3.2300 - accuracy500: 0.4030 - val_loss: 3.3041 - val_accuracy500: 0.3591 - 13s/epoch - 24ms/step
Epoch 17/50
538/538 - 13s - loss: 3.2275 - accuracy500: 0.4048 - val_loss: 3.3075 - val_accuracy500: 0.3581 - 13s/epoch - 24ms/step
Epoch 18/50
538/538 - 13s - loss: 3.2238 - accuracy500: 0.4073 - val_loss: 3.3085 - val_accuracy500: 0.3593 - 13s/epoch - 24ms/step
Epoch 19/50
538/538 - 13s - loss: 3.2210 - accuracy500: 0.4098 - val_loss: 3.3092 - val_accuracy500: 0.3595 - 13s/epoch - 24ms/step
testing model: results/PCAR/W4/deepOF_L2/h500
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0951397
{'0': {'precision': 0.3685025215958456, 'recall': 0.16603796224773704, 'f1-score': 0.22892712383158242, 'support': 133343}, '1': {'precision': 0.38236724332610794, 'recall': 0.6360040852977263, 'f1-score': 0.4776001091233841, 'support': 145889}, '2': {'precision': 0.32788159005448547, 'recall': 0.26754279541950077, 'f1-score': 0.29465490265379923, 'support': 127759}, 'accuracy': 0.3663643667796094, 'macro avg': {'precision': 0.3595837849921463, 'recall': 0.3565282809883214, 'f1-score': 0.3337273785362553, 'support': 406991}, 'weighted avg': {'precision': 0.360721073838312, 'recall': 0.3663643667796094, 'f1-score': 0.33869851544904633, 'support': 406991}}
[[22140 74884 36319]
 [19355 92786 33748]
 [18586 74992 34181]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.085798
{'0': {'precision': 0.3838595864409807, 'recall': 0.19116567691999733, 'f1-score': 0.25522627390426417, 'support': 44961}, '1': {'precision': 0.3790254930118152, 'recall': 0.5855812318776908, 'f1-score': 0.4601879903674357, 'support': 45524}, '2': {'precision': 0.3912956411454509, 'recall': 0.372726887372303, 'f1-score': 0.38178561736770694, 'support': 47182}, 'accuracy': 0.3838174725969187, 'macro avg': {'precision': 0.3847269068660823, 'recall': 0.38315793205666376, 'f1-score': 0.3657332938798023, 'support': 137667}, 'weighted avg': {'precision': 0.3848095647494859, 'recall': 0.3838174725969187, 'f1-score': 0.36637854804085157, 'support': 137667}}
[[ 8595 21437 14929]
 [ 6438 26658 12428]
 [ 7358 22238 17586]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0980679
{'0': {'precision': 0.3787272934993716, 'recall': 0.17474039323177482, 'f1-score': 0.2391429808108498, 'support': 18971}, '1': {'precision': 0.35889193874602715, 'recall': 0.5605257220216606, 'f1-score': 0.43759908402325165, 'support': 17728}, '2': {'precision': 0.33706744868035193, 'recall': 0.34224630776560266, 'f1-score': 0.3396371372850305, 'support': 16792}, 'accuracy': 0.35518124544315866, 'macro avg': {'precision': 0.3582288936419169, 'recall': 0.3591708076730127, 'f1-score': 0.338793067373044, 'support': 53491}, 'weighted avg': {'precision': 0.35907551500825596, 'recall': 0.35518124544315866, 'f1-score': 0.33646267334349833, 'support': 53491}}
[[3315 9425 6231]
 [2719 9937 5072]
 [2719 8326 5747]]
training model: results/PCAR/W4/deepOF_L2/h1000
Epoch 1/50
538/538 - 16s - loss: 3.3459 - accuracy1000: 0.3417 - val_loss: 3.3462 - val_accuracy1000: 0.3219 - 16s/epoch - 30ms/step
Epoch 2/50
538/538 - 13s - loss: 3.3173 - accuracy1000: 0.3469 - val_loss: 3.3248 - val_accuracy1000: 0.3278 - 13s/epoch - 25ms/step
Epoch 3/50
538/538 - 13s - loss: 3.3005 - accuracy1000: 0.3542 - val_loss: 3.3140 - val_accuracy1000: 0.3360 - 13s/epoch - 25ms/step
Epoch 4/50
538/538 - 13s - loss: 3.2903 - accuracy1000: 0.3575 - val_loss: 3.3061 - val_accuracy1000: 0.3451 - 13s/epoch - 25ms/step
Epoch 5/50
538/538 - 13s - loss: 3.2825 - accuracy1000: 0.3636 - val_loss: 3.3050 - val_accuracy1000: 0.3471 - 13s/epoch - 24ms/step
Epoch 6/50
538/538 - 13s - loss: 3.2756 - accuracy1000: 0.3678 - val_loss: 3.3061 - val_accuracy1000: 0.3479 - 13s/epoch - 24ms/step
Epoch 7/50
538/538 - 13s - loss: 3.2700 - accuracy1000: 0.3734 - val_loss: 3.3068 - val_accuracy1000: 0.3485 - 13s/epoch - 24ms/step
Epoch 8/50
538/538 - 13s - loss: 3.2657 - accuracy1000: 0.3755 - val_loss: 3.3065 - val_accuracy1000: 0.3490 - 13s/epoch - 24ms/step
Epoch 9/50
538/538 - 13s - loss: 3.2619 - accuracy1000: 0.3777 - val_loss: 3.3062 - val_accuracy1000: 0.3477 - 13s/epoch - 24ms/step
Epoch 10/50
538/538 - 13s - loss: 3.2589 - accuracy1000: 0.3792 - val_loss: 3.3055 - val_accuracy1000: 0.3502 - 13s/epoch - 24ms/step
Epoch 11/50
538/538 - 13s - loss: 3.2546 - accuracy1000: 0.3817 - val_loss: 3.3079 - val_accuracy1000: 0.3485 - 13s/epoch - 24ms/step
Epoch 12/50
538/538 - 13s - loss: 3.2529 - accuracy1000: 0.3823 - val_loss: 3.3061 - val_accuracy1000: 0.3489 - 13s/epoch - 24ms/step
Epoch 13/50
538/538 - 13s - loss: 3.2500 - accuracy1000: 0.3846 - val_loss: 3.3064 - val_accuracy1000: 0.3502 - 13s/epoch - 24ms/step
Epoch 14/50
538/538 - 13s - loss: 3.2472 - accuracy1000: 0.3876 - val_loss: 3.3085 - val_accuracy1000: 0.3506 - 13s/epoch - 24ms/step
Epoch 15/50
538/538 - 13s - loss: 3.2442 - accuracy1000: 0.3880 - val_loss: 3.3108 - val_accuracy1000: 0.3472 - 13s/epoch - 24ms/step
testing model: results/PCAR/W4/deepOF_L2/h1000
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0971464
{'0': {'precision': 0.3818070904014453, 'recall': 0.24137470705152927, 'f1-score': 0.2957678641209026, 'support': 134836}, '1': {'precision': 0.3616456036062346, 'recall': 0.548956098956099, 'f1-score': 0.436035995104484, 'support': 139860}, '2': {'precision': 0.32850616719963455, 'recall': 0.2717789787973846, 'f1-score': 0.2974622019069681, 'support': 132295}, 'accuracy': 0.3569562963308771, 'macro avg': {'precision': 0.3573196204024381, 'recall': 0.35403659493500433, 'f1-score': 0.34308868704411827, 'support': 406991}, 'weighted avg': {'precision': 0.35755291480994145, 'recall': 0.3569562963308771, 'f1-score': 0.34452091570379073, 'support': 406991}}
[[32546 65345 36945]
 [26533 76777 36550]
 [26163 70177 35955]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0903358
{'0': {'precision': 0.3702806379971734, 'recall': 0.28454906132943236, 'f1-score': 0.32180277736000396, 'support': 45117}, '1': {'precision': 0.36637271810224203, 'recall': 0.5029033410755762, 'f1-score': 0.42391611287863096, 'support': 44776}, '2': {'precision': 0.37345307458949295, 'recall': 0.3246745091472349, 'f1-score': 0.34735969901912483, 'support': 47774}, 'accuracy': 0.36949305207493444, 'macro avg': {'precision': 0.37003547689630284, 'recall': 0.37070897051741447, 'f1-score': 0.36435952975258656, 'support': 137667}, 'weighted avg': {'precision': 0.37011050982227334, 'recall': 0.36949305207493444, 'f1-score': 0.3638839085426758, 'support': 137667}}
[[12838 18916 13363]
 [ 9598 22518 12660]
 [12235 20028 15511]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988926
{'0': {'precision': 0.3884391314216539, 'recall': 0.25934532228733076, 'f1-score': 0.3110289885802562, 'support': 19796}, '1': {'precision': 0.34413450193831113, 'recall': 0.47532301245489467, 'f1-score': 0.399227648237767, 'support': 17182}, '2': {'precision': 0.31332366098416153, 'recall': 0.3138739175195301, 'f1-score': 0.3135985478747542, 'support': 16513}, 'accuracy': 0.3455534575909966, 'macro avg': {'precision': 0.3486324314480422, 'recall': 0.34951408408725176, 'f1-score': 0.34128506156425914, 'support': 53491}, 'weighted avg': {'precision': 0.3510193055235195, 'recall': 0.3455534575909966, 'f1-score': 0.34015277581297565, 'support': 53491}}
[[5134 8491 6171]
 [3827 8167 5188]
 [4256 7074 5183]]
training model: results/PCAR/W4/deepVOL_L2/h10
Epoch 1/50
538/538 - 16s - loss: 3.2896 - accuracy10: 0.3841 - val_loss: 3.2378 - val_accuracy10: 0.4055 - 16s/epoch - 30ms/step
Epoch 2/50
538/538 - 14s - loss: 3.2000 - accuracy10: 0.4280 - val_loss: 3.2068 - val_accuracy10: 0.4182 - 14s/epoch - 25ms/step
Epoch 3/50
538/538 - 14s - loss: 3.1417 - accuracy10: 0.4515 - val_loss: 3.1693 - val_accuracy10: 0.4323 - 14s/epoch - 26ms/step
Epoch 4/50
538/538 - 14s - loss: 3.1184 - accuracy10: 0.4602 - val_loss: 3.1495 - val_accuracy10: 0.4387 - 14s/epoch - 26ms/step
Epoch 5/50
538/538 - 14s - loss: 3.1003 - accuracy10: 0.4663 - val_loss: 3.1476 - val_accuracy10: 0.4431 - 14s/epoch - 26ms/step
Epoch 6/50
538/538 - 14s - loss: 3.0838 - accuracy10: 0.4718 - val_loss: 3.1554 - val_accuracy10: 0.4413 - 14s/epoch - 25ms/step
Epoch 7/50
538/538 - 14s - loss: 3.0709 - accuracy10: 0.4763 - val_loss: 3.1565 - val_accuracy10: 0.4420 - 14s/epoch - 25ms/step
Epoch 8/50
538/538 - 14s - loss: 3.0617 - accuracy10: 0.4799 - val_loss: 3.1418 - val_accuracy10: 0.4480 - 14s/epoch - 25ms/step
Epoch 9/50
538/538 - 14s - loss: 3.0529 - accuracy10: 0.4820 - val_loss: 3.1293 - val_accuracy10: 0.4516 - 14s/epoch - 25ms/step
Epoch 10/50
538/538 - 14s - loss: 3.0454 - accuracy10: 0.4843 - val_loss: 3.1245 - val_accuracy10: 0.4552 - 14s/epoch - 26ms/step
Epoch 11/50
538/538 - 14s - loss: 3.0363 - accuracy10: 0.4888 - val_loss: 3.1150 - val_accuracy10: 0.4575 - 14s/epoch - 26ms/step
Epoch 12/50
538/538 - 14s - loss: 3.0293 - accuracy10: 0.4900 - val_loss: 3.1098 - val_accuracy10: 0.4586 - 14s/epoch - 25ms/step
Epoch 13/50
538/538 - 14s - loss: 3.0246 - accuracy10: 0.4915 - val_loss: 3.1100 - val_accuracy10: 0.4618 - 14s/epoch - 26ms/step
Epoch 14/50
538/538 - 14s - loss: 3.0176 - accuracy10: 0.4931 - val_loss: 3.1096 - val_accuracy10: 0.4600 - 14s/epoch - 26ms/step
Epoch 15/50
538/538 - 14s - loss: 3.0135 - accuracy10: 0.4949 - val_loss: 3.1149 - val_accuracy10: 0.4584 - 14s/epoch - 26ms/step
Epoch 16/50
538/538 - 14s - loss: 3.0094 - accuracy10: 0.4961 - val_loss: 3.1073 - val_accuracy10: 0.4642 - 14s/epoch - 26ms/step
Epoch 17/50
538/538 - 14s - loss: 3.0054 - accuracy10: 0.4958 - val_loss: 3.1009 - val_accuracy10: 0.4616 - 14s/epoch - 26ms/step
Epoch 18/50
538/538 - 14s - loss: 3.0005 - accuracy10: 0.4980 - val_loss: 3.1171 - val_accuracy10: 0.4600 - 14s/epoch - 25ms/step
Epoch 19/50
538/538 - 14s - loss: 2.9953 - accuracy10: 0.4999 - val_loss: 3.1098 - val_accuracy10: 0.4623 - 14s/epoch - 26ms/step
Epoch 20/50
538/538 - 14s - loss: 2.9926 - accuracy10: 0.5002 - val_loss: 3.1124 - val_accuracy10: 0.4591 - 14s/epoch - 26ms/step
Epoch 21/50
538/538 - 14s - loss: 2.9877 - accuracy10: 0.5009 - val_loss: 3.1062 - val_accuracy10: 0.4615 - 14s/epoch - 26ms/step
Epoch 22/50
538/538 - 14s - loss: 2.9838 - accuracy10: 0.5026 - val_loss: 3.1028 - val_accuracy10: 0.4639 - 14s/epoch - 26ms/step
Epoch 23/50
538/538 - 14s - loss: 2.9792 - accuracy10: 0.5039 - val_loss: 3.1123 - val_accuracy10: 0.4599 - 14s/epoch - 25ms/step
Epoch 24/50
538/538 - 14s - loss: 2.9763 - accuracy10: 0.5041 - val_loss: 3.1050 - val_accuracy10: 0.4602 - 14s/epoch - 25ms/step
Epoch 25/50
538/538 - 14s - loss: 2.9721 - accuracy10: 0.5054 - val_loss: 3.1042 - val_accuracy10: 0.4630 - 14s/epoch - 25ms/step
Epoch 26/50
538/538 - 14s - loss: 2.9683 - accuracy10: 0.5073 - val_loss: 3.1116 - val_accuracy10: 0.4597 - 14s/epoch - 25ms/step
Epoch 27/50
538/538 - 14s - loss: 2.9639 - accuracy10: 0.5077 - val_loss: 3.1005 - val_accuracy10: 0.4639 - 14s/epoch - 26ms/step
Epoch 28/50
538/538 - 14s - loss: 2.9606 - accuracy10: 0.5090 - val_loss: 3.1118 - val_accuracy10: 0.4608 - 14s/epoch - 25ms/step
Epoch 29/50
538/538 - 14s - loss: 2.9572 - accuracy10: 0.5105 - val_loss: 3.1025 - val_accuracy10: 0.4631 - 14s/epoch - 26ms/step
Epoch 30/50
538/538 - 14s - loss: 2.9558 - accuracy10: 0.5089 - val_loss: 3.1241 - val_accuracy10: 0.4587 - 14s/epoch - 25ms/step
Epoch 31/50
538/538 - 14s - loss: 2.9496 - accuracy10: 0.5125 - val_loss: 3.1129 - val_accuracy10: 0.4625 - 14s/epoch - 26ms/step
Epoch 32/50
538/538 - 14s - loss: 2.9444 - accuracy10: 0.5142 - val_loss: 3.1167 - val_accuracy10: 0.4617 - 14s/epoch - 26ms/step
Epoch 33/50
538/538 - 14s - loss: 2.9427 - accuracy10: 0.5144 - val_loss: 3.1238 - val_accuracy10: 0.4595 - 14s/epoch - 25ms/step
Epoch 34/50
538/538 - 14s - loss: 2.9361 - accuracy10: 0.5169 - val_loss: 3.1172 - val_accuracy10: 0.4621 - 14s/epoch - 26ms/step
Epoch 35/50
538/538 - 14s - loss: 2.9321 - accuracy10: 0.5169 - val_loss: 3.1223 - val_accuracy10: 0.4614 - 14s/epoch - 26ms/step
Epoch 36/50
538/538 - 14s - loss: 2.9279 - accuracy10: 0.5187 - val_loss: 3.1314 - val_accuracy10: 0.4590 - 14s/epoch - 26ms/step
Epoch 37/50
538/538 - 14s - loss: 2.9227 - accuracy10: 0.5182 - val_loss: 3.1291 - val_accuracy10: 0.4627 - 14s/epoch - 26ms/step
testing model: results/PCAR/W4/deepVOL_L2/h10
Evaluating performance on  test set...
1590/1590 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0173703
{'0': {'precision': 0.49011200149960166, 'recall': 0.3416135881104034, 'f1-score': 0.4026061515956423, 'support': 122460}, '1': {'precision': 0.49097302474492893, 'recall': 0.6572580887885628, 'f1-score': 0.5620749831408908, 'support': 166125}, '2': {'precision': 0.43880100755667506, 'recall': 0.3677983278439321, 'f1-score': 0.40017458421391167, 'support': 118410}, 'accuracy': 0.47806975515669725, 'macro avg': {'precision': 0.47329534460040185, 'recall': 0.4555566682476328, 'f1-score': 0.45495190631681487, 'support': 406995}, 'weighted avg': {'precision': 0.4755351705651874, 'recall': 0.47806975515669725, 'f1-score': 0.4669898362767408, 'support': 406995}}
[[ 41834  55991  24635]
 [ 25874 109187  31064]
 [ 17648  57211  43551]]
Evaluating performance on  train set...
538/538 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0154909
{'0': {'precision': 0.5243671667169459, 'recall': 0.4147145583897276, 'f1-score': 0.4631390264875798, 'support': 46104}, '1': {'precision': 0.4513238575469543, 'recall': 0.5681677430770592, 'f1-score': 0.5030500641345749, 'support': 45212}, '2': {'precision': 0.4934633882002303, 'recall': 0.4714905184130477, 'f1-score': 0.4822267822863573, 'support': 46353}, 'accuracy': 0.4842266595965686, 'macro avg': {'precision': 0.4897181374880435, 'recall': 0.4847909399599448, 'f1-score': 0.482805290969504, 'support': 137669}, 'weighted avg': {'precision': 0.4899736798769239, 'recall': 0.4842266595965686, 'f1-score': 0.48267307248658226, 'support': 137669}}
[[19120 15335 11649]
 [ 8739 25688 10785]
 [ 8604 15894 21855]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0341114
{'0': {'precision': 0.4908274634259618, 'recall': 0.3739679169615475, 'f1-score': 0.4245020920502092, 'support': 16956}, '1': {'precision': 0.46557149467838965, 'recall': 0.5068513853904282, 'f1-score': 0.48533526290400386, 'support': 19850}, '2': {'precision': 0.44133312239624534, 'recall': 0.5015581924967039, 'f1-score': 0.46952228674016105, 'support': 16686}, 'accuracy': 0.46307859119120615, 'macro avg': {'precision': 0.4659106935001989, 'recall': 0.4607924982828932, 'f1-score': 0.459786547231458, 'support': 53492}, 'weighted avg': {'precision': 0.4660163972093097, 'recall': 0.46307859119120615, 'f1-score': 0.4611196313092453, 'support': 53492}}
[[ 6341  5933  4682]
 [ 3877 10061  5912]
 [ 2701  5616  8369]]
training model: results/PCAR/W4/deepVOL_L2/h20
Epoch 1/50
538/538 - 17s - loss: 3.2990 - accuracy20: 0.3745 - val_loss: 3.2425 - val_accuracy20: 0.3945 - 17s/epoch - 31ms/step
Epoch 2/50
538/538 - 14s - loss: 3.2225 - accuracy20: 0.4137 - val_loss: 3.2147 - val_accuracy20: 0.4155 - 14s/epoch - 27ms/step
Epoch 3/50
538/538 - 14s - loss: 3.1889 - accuracy20: 0.4300 - val_loss: 3.2004 - val_accuracy20: 0.4205 - 14s/epoch - 27ms/step
Epoch 4/50
538/538 - 14s - loss: 3.1715 - accuracy20: 0.4372 - val_loss: 3.1948 - val_accuracy20: 0.4236 - 14s/epoch - 27ms/step
Epoch 5/50
538/538 - 14s - loss: 3.1615 - accuracy20: 0.4415 - val_loss: 3.1937 - val_accuracy20: 0.4254 - 14s/epoch - 26ms/step
Epoch 6/50
538/538 - 14s - loss: 3.1519 - accuracy20: 0.4462 - val_loss: 3.1876 - val_accuracy20: 0.4253 - 14s/epoch - 26ms/step
Epoch 7/50
538/538 - 14s - loss: 3.1437 - accuracy20: 0.4480 - val_loss: 3.1894 - val_accuracy20: 0.4265 - 14s/epoch - 26ms/step
Epoch 8/50
538/538 - 14s - loss: 3.1380 - accuracy20: 0.4520 - val_loss: 3.1861 - val_accuracy20: 0.4259 - 14s/epoch - 26ms/step
Epoch 9/50
538/538 - 14s - loss: 3.1345 - accuracy20: 0.4530 - val_loss: 3.1815 - val_accuracy20: 0.4271 - 14s/epoch - 26ms/step
Epoch 10/50
538/538 - 14s - loss: 3.1283 - accuracy20: 0.4542 - val_loss: 3.1753 - val_accuracy20: 0.4311 - 14s/epoch - 26ms/step
Epoch 11/50
538/538 - 14s - loss: 3.1218 - accuracy20: 0.4561 - val_loss: 3.1747 - val_accuracy20: 0.4300 - 14s/epoch - 26ms/step
Epoch 12/50
538/538 - 14s - loss: 3.1177 - accuracy20: 0.4580 - val_loss: 3.1737 - val_accuracy20: 0.4285 - 14s/epoch - 27ms/step
Epoch 13/50
538/538 - 14s - loss: 3.1144 - accuracy20: 0.4600 - val_loss: 3.1699 - val_accuracy20: 0.4305 - 14s/epoch - 26ms/step
Epoch 14/50
538/538 - 14s - loss: 3.1096 - accuracy20: 0.4620 - val_loss: 3.1747 - val_accuracy20: 0.4284 - 14s/epoch - 26ms/step
Epoch 15/50
538/538 - 14s - loss: 3.1070 - accuracy20: 0.4621 - val_loss: 3.1734 - val_accuracy20: 0.4280 - 14s/epoch - 27ms/step
Epoch 16/50
538/538 - 14s - loss: 3.1024 - accuracy20: 0.4638 - val_loss: 3.1731 - val_accuracy20: 0.4285 - 14s/epoch - 26ms/step
Epoch 17/50
538/538 - 14s - loss: 3.0992 - accuracy20: 0.4647 - val_loss: 3.1717 - val_accuracy20: 0.4312 - 14s/epoch - 26ms/step
Epoch 18/50
538/538 - 14s - loss: 3.0962 - accuracy20: 0.4661 - val_loss: 3.1779 - val_accuracy20: 0.4275 - 14s/epoch - 26ms/step
Epoch 19/50
538/538 - 14s - loss: 3.0921 - accuracy20: 0.4676 - val_loss: 3.1714 - val_accuracy20: 0.4300 - 14s/epoch - 26ms/step
Epoch 20/50
538/538 - 14s - loss: 3.0886 - accuracy20: 0.4684 - val_loss: 3.1747 - val_accuracy20: 0.4306 - 14s/epoch - 26ms/step
Epoch 21/50
538/538 - 14s - loss: 3.0853 - accuracy20: 0.4706 - val_loss: 3.1776 - val_accuracy20: 0.4312 - 14s/epoch - 26ms/step
Epoch 22/50
538/538 - 14s - loss: 3.0828 - accuracy20: 0.4718 - val_loss: 3.1771 - val_accuracy20: 0.4310 - 14s/epoch - 26ms/step
Epoch 23/50
538/538 - 14s - loss: 3.0794 - accuracy20: 0.4721 - val_loss: 3.1811 - val_accuracy20: 0.4310 - 14s/epoch - 26ms/step
testing model: results/PCAR/W4/deepVOL_L2/h20
Evaluating performance on  test set...
1590/1590 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0433491
{'0': {'precision': 0.43880979043353063, 'recall': 0.4158746877967427, 'f1-score': 0.42703451214316146, 'support': 125319}, '1': {'precision': 0.46070080117874573, 'recall': 0.496865262138574, 'f1-score': 0.4781001188620304, 'support': 161098}, '2': {'precision': 0.4160392026694153, 'recall': 0.3950057224369288, 'f1-score': 0.4052497234748575, 'support': 120578}, 'accuracy': 0.44174989864740355, 'macro avg': {'precision': 0.4385165980938972, 'recall': 0.43591522412408185, 'f1-score': 0.4367947848266831, 'support': 406995}, 'weighted avg': {'precision': 0.4407286496765463, 'recall': 0.44174989864740355, 'f1-score': 0.44079340565082026, 'support': 406995}}
[[52117 45806 27396]
 [41597 80044 39457]
 [25055 47894 47629]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0457733
{'0': {'precision': 0.4635917147127909, 'recall': 0.47236727589208005, 'f1-score': 0.46793835542623125, 'support': 45960}, '1': {'precision': 0.41609341825902335, 'recall': 0.4301863599446847, 'f1-score': 0.42302254551733814, 'support': 45557}, '2': {'precision': 0.4651455223027504, 'recall': 0.44082596637198823, 'f1-score': 0.45265933185747187, 'support': 46152}, 'accuracy': 0.447835024587961, 'macro avg': {'precision': 0.4482768850915216, 'recall': 0.447793200736251, 'f1-score': 0.4478734109336804, 'support': 137669}, 'weighted avg': {'precision': 0.44839462194933305, 'recall': 0.447835024587961, 'f1-score': 0.44795283183148715, 'support': 137669}}
[[21710 13342 10908]
 [13473 19598 12486]
 [11647 14160 20345]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0566962
{'0': {'precision': 0.45212235073093404, 'recall': 0.447290468722774, 'f1-score': 0.44969343065693423, 'support': 17217}, '1': {'precision': 0.41936914111983786, 'recall': 0.3482537344834841, 'f1-score': 0.3805172413793103, 'support': 19012}, '2': {'precision': 0.42518504184606454, 'recall': 0.5091235590569426, 'f1-score': 0.4633837718142036, 'support': 17263}, 'accuracy': 0.43204591340761234, 'macro avg': {'precision': 0.4322255112322788, 'recall': 0.4348892540877336, 'f1-score': 0.4311981479501494, 'support': 53492}, 'weighted avg': {'precision': 0.4317880430885639, 'recall': 0.43204591340761234, 'f1-score': 0.4295251559401869, 'support': 53492}}
[[7701 4607 4909]
 [5418 6621 6973]
 [3914 4560 8789]]
training model: results/PCAR/W4/deepVOL_L2/h30
Epoch 1/50
538/538 - 16s - loss: 3.2990 - accuracy30: 0.3737 - val_loss: 3.2587 - val_accuracy30: 0.3941 - 16s/epoch - 30ms/step
Epoch 2/50
538/538 - 14s - loss: 3.2407 - accuracy30: 0.4026 - val_loss: 3.2400 - val_accuracy30: 0.3997 - 14s/epoch - 26ms/step
Epoch 3/50
538/538 - 14s - loss: 3.2161 - accuracy30: 0.4156 - val_loss: 3.2225 - val_accuracy30: 0.4099 - 14s/epoch - 26ms/step
Epoch 4/50
538/538 - 14s - loss: 3.2036 - accuracy30: 0.4221 - val_loss: 3.2173 - val_accuracy30: 0.4130 - 14s/epoch - 26ms/step
Epoch 5/50
538/538 - 14s - loss: 3.1951 - accuracy30: 0.4256 - val_loss: 3.2156 - val_accuracy30: 0.4143 - 14s/epoch - 26ms/step
Epoch 6/50
538/538 - 14s - loss: 3.1869 - accuracy30: 0.4304 - val_loss: 3.2096 - val_accuracy30: 0.4176 - 14s/epoch - 26ms/step
Epoch 7/50
538/538 - 14s - loss: 3.1818 - accuracy30: 0.4323 - val_loss: 3.2156 - val_accuracy30: 0.4169 - 14s/epoch - 26ms/step
Epoch 8/50
538/538 - 14s - loss: 3.1770 - accuracy30: 0.4343 - val_loss: 3.2119 - val_accuracy30: 0.4174 - 14s/epoch - 26ms/step
Epoch 9/50
538/538 - 14s - loss: 3.1716 - accuracy30: 0.4358 - val_loss: 3.2111 - val_accuracy30: 0.4159 - 14s/epoch - 26ms/step
Epoch 10/50
538/538 - 14s - loss: 3.1680 - accuracy30: 0.4377 - val_loss: 3.2146 - val_accuracy30: 0.4174 - 14s/epoch - 26ms/step
Epoch 11/50
538/538 - 14s - loss: 3.1642 - accuracy30: 0.4398 - val_loss: 3.2131 - val_accuracy30: 0.4175 - 14s/epoch - 27ms/step
Epoch 12/50
538/538 - 14s - loss: 3.1609 - accuracy30: 0.4414 - val_loss: 3.2157 - val_accuracy30: 0.4182 - 14s/epoch - 26ms/step
Epoch 13/50
538/538 - 14s - loss: 3.1587 - accuracy30: 0.4413 - val_loss: 3.2170 - val_accuracy30: 0.4173 - 14s/epoch - 26ms/step
Epoch 14/50
538/538 - 14s - loss: 3.1548 - accuracy30: 0.4432 - val_loss: 3.2234 - val_accuracy30: 0.4161 - 14s/epoch - 26ms/step
Epoch 15/50
538/538 - 14s - loss: 3.1510 - accuracy30: 0.4454 - val_loss: 3.2172 - val_accuracy30: 0.4165 - 14s/epoch - 26ms/step
Epoch 16/50
538/538 - 14s - loss: 3.1467 - accuracy30: 0.4455 - val_loss: 3.2206 - val_accuracy30: 0.4156 - 14s/epoch - 25ms/step
testing model: results/PCAR/W4/deepVOL_L2/h30
Evaluating performance on  test set...
1590/1590 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0676837
{'0': {'precision': 0.428141195044102, 'recall': 0.384284823140725, 'f1-score': 0.40502928201236216, 'support': 129849}, '1': {'precision': 0.41517974405180047, 'recall': 0.4498772165555769, 'f1-score': 0.43183262173426856, 'support': 151079}, '2': {'precision': 0.40187151851793407, 'recall': 0.4040232574742002, 'f1-score': 0.40294451542468823, 'support': 126067}, 'accuracy': 0.41474710991535524, 'macro avg': {'precision': 0.4150641525379455, 'recall': 0.4127284323901674, 'f1-score': 0.41326880639043967, 'support': 406995}, 'weighted avg': {'precision': 0.4151927746333099, 'recall': 0.41474710991535524, 'f1-score': 0.41433308548031045, 'support': 406995}}
[[49899 46418 33532]
 [40836 67967 42276]
 [25813 49320 50934]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0646422
{'0': {'precision': 0.45248923508636124, 'recall': 0.40470369328631084, 'f1-score': 0.42726452482382904, 'support': 46219}, '1': {'precision': 0.3909323434210824, 'recall': 0.38197500829370784, 'f1-score': 0.3864017719310021, 'support': 45215}, '2': {'precision': 0.43373216751035437, 'recall': 0.48923975343354603, 'f1-score': 0.4598168457214876, 'support': 46235}, 'accuracy': 0.4256295898132477, 'macro avg': {'precision': 0.425717915339266, 'recall': 0.42530615167118824, 'f1-score': 0.4244943808254396, 'support': 137669}, 'weighted avg': {'precision': 0.4259725328801837, 'recall': 0.4256295898132477, 'f1-score': 0.4247762898882522, 'support': 137669}}
[[18705 13423 14091]
 [12503 17271 15441]
 [10130 13485 22620]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0695616
{'0': {'precision': 0.4442854355038054, 'recall': 0.391291893440275, 'f1-score': 0.4161082003168027, 'support': 17455}, '1': {'precision': 0.3960755325582958, 'recall': 0.31893939393939397, 'f1-score': 0.35334672222055696, 'support': 18480}, '2': {'precision': 0.4109217660728118, 'recall': 0.5438856296633822, 'f1-score': 0.4681456060791764, 'support': 17557}, 'accuracy': 0.4163800194421596, 'macro avg': {'precision': 0.41709424471163764, 'recall': 0.41803897234768367, 'f1-score': 0.4125335095388454, 'support': 53492}, 'weighted avg': {'precision': 0.4166797196840011, 'recall': 0.4163800194421596, 'f1-score': 0.41150543014091423, 'support': 53492}}
[[6830 4534 6091]
 [4988 5894 7598]
 [3555 4453 9549]]
training model: results/PCAR/W4/deepVOL_L2/h50
Epoch 1/50
538/538 - 16s - loss: 3.3031 - accuracy50: 0.3714 - val_loss: 3.2914 - val_accuracy50: 0.3772 - 16s/epoch - 30ms/step
Epoch 2/50
538/538 - 14s - loss: 3.2525 - accuracy50: 0.3977 - val_loss: 3.2550 - val_accuracy50: 0.3906 - 14s/epoch - 26ms/step
Epoch 3/50
538/538 - 14s - loss: 3.2364 - accuracy50: 0.4061 - val_loss: 3.2476 - val_accuracy50: 0.3958 - 14s/epoch - 26ms/step
Epoch 4/50
538/538 - 13s - loss: 3.2293 - accuracy50: 0.4110 - val_loss: 3.2510 - val_accuracy50: 0.3930 - 13s/epoch - 25ms/step
Epoch 5/50
538/538 - 14s - loss: 3.2203 - accuracy50: 0.4173 - val_loss: 3.2444 - val_accuracy50: 0.3977 - 14s/epoch - 26ms/step
Epoch 6/50
538/538 - 14s - loss: 3.2152 - accuracy50: 0.4206 - val_loss: 3.2437 - val_accuracy50: 0.3997 - 14s/epoch - 25ms/step
Epoch 7/50
538/538 - 13s - loss: 3.2096 - accuracy50: 0.4221 - val_loss: 3.2457 - val_accuracy50: 0.4004 - 13s/epoch - 25ms/step
Epoch 8/50
538/538 - 14s - loss: 3.2064 - accuracy50: 0.4248 - val_loss: 3.2447 - val_accuracy50: 0.3971 - 14s/epoch - 25ms/step
Epoch 9/50
538/538 - 14s - loss: 3.2037 - accuracy50: 0.4248 - val_loss: 3.2387 - val_accuracy50: 0.4011 - 14s/epoch - 25ms/step
Epoch 10/50
538/538 - 14s - loss: 3.2002 - accuracy50: 0.4261 - val_loss: 3.2453 - val_accuracy50: 0.3988 - 14s/epoch - 26ms/step
Epoch 11/50
538/538 - 14s - loss: 3.1991 - accuracy50: 0.4267 - val_loss: 3.2469 - val_accuracy50: 0.3997 - 14s/epoch - 25ms/step
Epoch 12/50
538/538 - 14s - loss: 3.1954 - accuracy50: 0.4282 - val_loss: 3.2415 - val_accuracy50: 0.4006 - 14s/epoch - 26ms/step
Epoch 13/50
538/538 - 14s - loss: 3.1921 - accuracy50: 0.4295 - val_loss: 3.2500 - val_accuracy50: 0.3982 - 14s/epoch - 26ms/step
Epoch 14/50
538/538 - 14s - loss: 3.1894 - accuracy50: 0.4306 - val_loss: 3.2555 - val_accuracy50: 0.3954 - 14s/epoch - 26ms/step
Epoch 15/50
538/538 - 14s - loss: 3.1854 - accuracy50: 0.4325 - val_loss: 3.2482 - val_accuracy50: 0.3974 - 14s/epoch - 25ms/step
Epoch 16/50
538/538 - 13s - loss: 3.1835 - accuracy50: 0.4337 - val_loss: 3.2535 - val_accuracy50: 0.3988 - 13s/epoch - 25ms/step
Epoch 17/50
538/538 - 14s - loss: 3.1814 - accuracy50: 0.4343 - val_loss: 3.2541 - val_accuracy50: 0.3979 - 14s/epoch - 25ms/step
Epoch 18/50
538/538 - 14s - loss: 3.1779 - accuracy50: 0.4347 - val_loss: 3.2565 - val_accuracy50: 0.3971 - 14s/epoch - 25ms/step
Epoch 19/50
538/538 - 13s - loss: 3.1756 - accuracy50: 0.4357 - val_loss: 3.2637 - val_accuracy50: 0.3980 - 13s/epoch - 25ms/step
testing model: results/PCAR/W4/deepVOL_L2/h50
Evaluating performance on  test set...
1590/1590 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.066431
{'0': {'precision': 0.39506689884717966, 'recall': 0.2988386924660903, 'f1-score': 0.34028051356290195, 'support': 119951}, '1': {'precision': 0.4433685568477168, 'recall': 0.6902148873583858, 'f1-score': 0.539915398530217, 'support': 169298}, '2': {'precision': 0.3925739005046864, 'recall': 0.1757257146739592, 'f1-score': 0.24277802548518057, 'support': 117746}, 'accuracy': 0.42602243270801854, 'macro avg': {'precision': 0.41033645206652763, 'recall': 0.3882597648328117, 'f1-score': 0.37432464585943315, 'support': 406995}, 'weighted avg': {'precision': 0.4144377351310154, 'recall': 0.42602243270801854, 'f1-score': 0.39511474689254267, 'support': 406995}}
[[ 35846  70666  13439]
 [ 33870 116852  18576]
 [ 21018  76037  20691]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.08184
{'0': {'precision': 0.4355997501041233, 'recall': 0.3643925701718093, 'f1-score': 0.3968270906697969, 'support': 45923}, '1': {'precision': 0.3675689711132749, 'recall': 0.6231319467370969, 'f1-score': 0.4623877184386739, 'support': 45435}, '2': {'precision': 0.4534820946553896, 'recall': 0.21765887154239813, 'f1-score': 0.2941391032842615, 'support': 46311}, 'accuracy': 0.4004242058851303, 'macro avg': {'precision': 0.4188836052909292, 'recall': 0.4017277961504348, 'f1-score': 0.3844513041309108, 'support': 137669}, 'weighted avg': {'precision': 0.4191630128216886, 'recall': 0.4004242058851303, 'f1-score': 0.3839205084971029, 'support': 137669}}
[[16734 23597  5592]
 [10567 28312  6556]
 [11115 25116 10080]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0802606
{'0': {'precision': 0.4212005476688045, 'recall': 0.3346693386773547, 'f1-score': 0.3729819411652096, 'support': 17465}, '1': {'precision': 0.38436231275374494, 'recall': 0.5884054864980711, 'f1-score': 0.46498433398255573, 'support': 18664}, '2': {'precision': 0.4228923299827945, 'recall': 0.2689627368542303, 'f1-score': 0.32880377385059495, 'support': 17363}, 'accuracy': 0.4018731772975398, 'macro avg': {'precision': 0.409485063468448, 'recall': 0.39734585400988537, 'f1-score': 0.38892334966612013, 'support': 53492}, 'weighted avg': {'precision': 0.40889638255744465, 'recall': 0.4018731772975398, 'f1-score': 0.39074286131138647, 'support': 53492}}
[[ 5845  8753  2867]
 [ 4176 10982  3506]
 [ 3856  8837  4670]]
training model: results/PCAR/W4/deepVOL_L2/h100
Epoch 1/50
538/538 - 16s - loss: 3.3295 - accuracy100: 0.3544 - val_loss: 3.3122 - val_accuracy100: 0.3614 - 16s/epoch - 29ms/step
Epoch 2/50
538/538 - 13s - loss: 3.2766 - accuracy100: 0.3781 - val_loss: 3.2839 - val_accuracy100: 0.3753 - 13s/epoch - 25ms/step
Epoch 3/50
538/538 - 14s - loss: 3.2619 - accuracy100: 0.3889 - val_loss: 3.2824 - val_accuracy100: 0.3772 - 14s/epoch - 25ms/step
Epoch 4/50
538/538 - 14s - loss: 3.2512 - accuracy100: 0.3949 - val_loss: 3.2824 - val_accuracy100: 0.3814 - 14s/epoch - 25ms/step
Epoch 5/50
538/538 - 14s - loss: 3.2453 - accuracy100: 0.4004 - val_loss: 3.2799 - val_accuracy100: 0.3837 - 14s/epoch - 25ms/step
Epoch 6/50
538/538 - 13s - loss: 3.2400 - accuracy100: 0.4019 - val_loss: 3.2905 - val_accuracy100: 0.3789 - 13s/epoch - 25ms/step
Epoch 7/50
538/538 - 14s - loss: 3.2373 - accuracy100: 0.4052 - val_loss: 3.2842 - val_accuracy100: 0.3834 - 14s/epoch - 26ms/step
Epoch 8/50
538/538 - 14s - loss: 3.2321 - accuracy100: 0.4069 - val_loss: 3.2885 - val_accuracy100: 0.3833 - 14s/epoch - 26ms/step
Epoch 9/50
538/538 - 13s - loss: 3.2289 - accuracy100: 0.4087 - val_loss: 3.2864 - val_accuracy100: 0.3863 - 13s/epoch - 25ms/step
Epoch 10/50
538/538 - 13s - loss: 3.2268 - accuracy100: 0.4094 - val_loss: 3.2913 - val_accuracy100: 0.3823 - 13s/epoch - 25ms/step
Epoch 11/50
538/538 - 13s - loss: 3.2216 - accuracy100: 0.4128 - val_loss: 3.2965 - val_accuracy100: 0.3846 - 13s/epoch - 25ms/step
Epoch 12/50
538/538 - 13s - loss: 3.2200 - accuracy100: 0.4132 - val_loss: 3.2873 - val_accuracy100: 0.3867 - 13s/epoch - 25ms/step
Epoch 13/50
538/538 - 14s - loss: 3.2152 - accuracy100: 0.4156 - val_loss: 3.2960 - val_accuracy100: 0.3820 - 14s/epoch - 25ms/step
Epoch 14/50
538/538 - 13s - loss: 3.2120 - accuracy100: 0.4172 - val_loss: 3.3096 - val_accuracy100: 0.3815 - 13s/epoch - 25ms/step
Epoch 15/50
538/538 - 13s - loss: 3.2089 - accuracy100: 0.4189 - val_loss: 3.3182 - val_accuracy100: 0.3819 - 13s/epoch - 25ms/step
testing model: results/PCAR/W4/deepVOL_L2/h100
Evaluating performance on  test set...
1590/1590 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.09472
{'0': {'precision': 0.3590922675650709, 'recall': 0.409326705689244, 'f1-score': 0.38256747955713144, 'support': 129156}, '1': {'precision': 0.3985215905954663, 'recall': 0.3528957171919998, 'f1-score': 0.3743234580097317, 'support': 151396}, '2': {'precision': 0.3569780761765361, 'recall': 0.35490299977064765, 'f1-score': 0.3559375136327042, 'support': 126443}, 'accuracy': 0.37142716740991905, 'macro avg': {'precision': 0.3715306447790245, 'recall': 0.3723751408839638, 'f1-score': 0.3709428170665225, 'support': 406995}, 'weighted avg': {'precision': 0.37310255537639353, 'recall': 0.37142716740991905, 'f1-score': 0.3712275744782669, 'support': 406995}}
[[52867 38094 38195]
 [55331 53427 42638]
 [39026 42542 44875]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0846894
{'0': {'precision': 0.39115659856874424, 'recall': 0.4288030854187667, 'f1-score': 0.409115617813088, 'support': 45634}, '1': {'precision': 0.3950146321070234, 'recall': 0.3324098504837291, 'f1-score': 0.36101824434043367, 'support': 45480}, '2': {'precision': 0.3916874278422556, 'recall': 0.41537965846847813, 'f1-score': 0.4031857890457228, 'support': 46555}, 'accuracy': 0.3924194989431172, 'macro avg': {'precision': 0.3926195528393411, 'recall': 0.3921975314569914, 'f1-score': 0.3911065503997482, 'support': 137669}, 'weighted avg': {'precision': 0.39261063776529, 'recall': 0.3924194989431172, 'f1-score': 0.3912210175486784, 'support': 137669}}
[[19568 11350 14716]
 [15045 15118 15317]
 [15413 11804 19338]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0922794
{'0': {'precision': 0.3830569022709875, 'recall': 0.4179520017818364, 'f1-score': 0.3997443681099217, 'support': 17959}, '1': {'precision': 0.3967122843954976, 'recall': 0.2678073580057946, 'f1-score': 0.31975719600548264, 'support': 18293}, '2': {'precision': 0.37511602004826433, 'recall': 0.46885150812064963, 'f1-score': 0.4167783850675466, 'support': 17240}, 'accuracy': 0.3830105436326927, 'macro avg': {'precision': 0.38496173557158314, 'recall': 0.38487028930276024, 'f1-score': 0.37875998306098363, 'support': 53492}, 'weighted avg': {'precision': 0.3851674439535553, 'recall': 0.3830105436326927, 'f1-score': 0.37788055881213795, 'support': 53492}}
[[7506 3865 6588]
 [6517 4899 6877]
 [5572 3585 8083]]
training model: results/PCAR/W4/deepVOL_L2/h200
Epoch 1/50
538/538 - 16s - loss: 3.3194 - accuracy200: 0.3633 - val_loss: 3.3150 - val_accuracy200: 0.3626 - 16s/epoch - 29ms/step
Epoch 2/50
538/538 - 14s - loss: 3.2600 - accuracy200: 0.3876 - val_loss: 3.3119 - val_accuracy200: 0.3598 - 14s/epoch - 26ms/step
Epoch 3/50
538/538 - 14s - loss: 3.2489 - accuracy200: 0.3917 - val_loss: 3.3157 - val_accuracy200: 0.3636 - 14s/epoch - 25ms/step
Epoch 4/50
538/538 - 14s - loss: 3.2429 - accuracy200: 0.3939 - val_loss: 3.3238 - val_accuracy200: 0.3610 - 14s/epoch - 25ms/step
Epoch 5/50
538/538 - 14s - loss: 3.2371 - accuracy200: 0.3960 - val_loss: 3.3233 - val_accuracy200: 0.3635 - 14s/epoch - 25ms/step
Epoch 6/50
538/538 - 13s - loss: 3.2330 - accuracy200: 0.3999 - val_loss: 3.3312 - val_accuracy200: 0.3626 - 13s/epoch - 25ms/step
Epoch 7/50
538/538 - 13s - loss: 3.2295 - accuracy200: 0.4023 - val_loss: 3.3359 - val_accuracy200: 0.3631 - 13s/epoch - 24ms/step
Epoch 8/50
538/538 - 14s - loss: 3.2260 - accuracy200: 0.4039 - val_loss: 3.3284 - val_accuracy200: 0.3664 - 14s/epoch - 26ms/step
Epoch 9/50
538/538 - 14s - loss: 3.2209 - accuracy200: 0.4087 - val_loss: 3.3373 - val_accuracy200: 0.3655 - 14s/epoch - 26ms/step
Epoch 10/50
538/538 - 14s - loss: 3.2179 - accuracy200: 0.4088 - val_loss: 3.3371 - val_accuracy200: 0.3668 - 14s/epoch - 25ms/step
Epoch 11/50
538/538 - 14s - loss: 3.2141 - accuracy200: 0.4126 - val_loss: 3.3299 - val_accuracy200: 0.3690 - 14s/epoch - 25ms/step
Epoch 12/50
538/538 - 13s - loss: 3.2113 - accuracy200: 0.4139 - val_loss: 3.3286 - val_accuracy200: 0.3700 - 13s/epoch - 25ms/step
testing model: results/PCAR/W4/deepVOL_L2/h200
Evaluating performance on  test set...
1590/1590 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0940232
{'0': {'precision': 0.3611852982322269, 'recall': 0.02191510212900587, 'f1-score': 0.04132291530257395, 'support': 129591}, '1': {'precision': 0.4066529101521634, 'recall': 0.74058866040339, 'f1-score': 0.5250202602628711, 'support': 152210}, '2': {'precision': 0.32408759124087594, 'recall': 0.3156381296228254, 'f1-score': 0.31980706042310747, 'support': 125194}, 'accuracy': 0.3810390791041659, 'macro avg': {'precision': 0.36397526654175544, 'recall': 0.3593806307184071, 'f1-score': 0.2953834119961842, 'support': 406995}, 'weighted avg': {'precision': 0.36677803249495333, 'recall': 0.3810390791041659, 'f1-score': 0.3078817598599442, 'support': 406995}}
[[  2840  81283  45468]
 [  2539 112725  36946]
 [  2484  83194  39516]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0911386
{'0': {'precision': 0.3870858688302907, 'recall': 0.02522637643481901, 'f1-score': 0.047365917223405794, 'support': 45389}, '1': {'precision': 0.38526321244865963, 'recall': 0.6542498184778544, 'f1-score': 0.4849547419065482, 'support': 45449}, '2': {'precision': 0.38230488440813487, 'recall': 0.4696461745425039, 'f1-score': 0.4214984524870402, 'support': 46831}, 'accuracy': 0.38406612962976416, 'macro avg': {'precision': 0.3848846552290284, 'recall': 0.38304078981839246, 'f1-score': 0.3179397038723314, 'support': 137669}, 'weighted avg': {'precision': 0.38485779866661746, 'recall': 0.38406612962976416, 'f1-score': 0.3190972093222473, 'support': 137669}}
[[ 1145 23671 20573]
 [  751 29735 14963]
 [ 1062 23775 21994]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1024511
{'0': {'precision': 0.36627505183137526, 'recall': 0.02778360243237576, 'f1-score': 0.05164936900063344, 'support': 19076}, '1': {'precision': 0.3609252254873436, 'recall': 0.5835587439727156, 'f1-score': 0.4460024268572199, 'support': 17006}, '2': {'precision': 0.356511466862194, 'recall': 0.5026995979322229, 'f1-score': 0.41716914130460686, 'support': 17410}, 'accuracy': 0.35904434307933897, 'macro avg': {'precision': 0.36123724806030433, 'recall': 0.3713473147791047, 'f1-score': 0.30494031238748676, 'support': 53492}, 'weighted avg': {'precision': 0.3613965062335279, 'recall': 0.35904434307933897, 'f1-score': 0.29598622942315056, 'support': 53492}}
[[ 530 9413 9133]
 [ 418 9924 6664]
 [ 499 8159 8752]]
training model: results/PCAR/W4/deepVOL_L2/h300
Epoch 1/50
538/538 - 16s - loss: 3.3239 - accuracy300: 0.3638 - val_loss: 3.3192 - val_accuracy300: 0.3517 - 16s/epoch - 30ms/step
Epoch 2/50
538/538 - 14s - loss: 3.2696 - accuracy300: 0.3791 - val_loss: 3.3303 - val_accuracy300: 0.3501 - 14s/epoch - 25ms/step
Epoch 3/50
538/538 - 13s - loss: 3.2545 - accuracy300: 0.3844 - val_loss: 3.3273 - val_accuracy300: 0.3515 - 13s/epoch - 25ms/step
Epoch 4/50
538/538 - 13s - loss: 3.2512 - accuracy300: 0.3871 - val_loss: 3.3197 - val_accuracy300: 0.3538 - 13s/epoch - 25ms/step
Epoch 5/50
538/538 - 13s - loss: 3.2459 - accuracy300: 0.3887 - val_loss: 3.3199 - val_accuracy300: 0.3589 - 13s/epoch - 25ms/step
Epoch 6/50
538/538 - 14s - loss: 3.2424 - accuracy300: 0.3905 - val_loss: 3.3173 - val_accuracy300: 0.3576 - 14s/epoch - 25ms/step
Epoch 7/50
538/538 - 14s - loss: 3.2397 - accuracy300: 0.3929 - val_loss: 3.3191 - val_accuracy300: 0.3559 - 14s/epoch - 25ms/step
Epoch 8/50
538/538 - 14s - loss: 3.2364 - accuracy300: 0.3943 - val_loss: 3.3210 - val_accuracy300: 0.3579 - 14s/epoch - 25ms/step
Epoch 9/50
538/538 - 14s - loss: 3.2337 - accuracy300: 0.3983 - val_loss: 3.3224 - val_accuracy300: 0.3555 - 14s/epoch - 25ms/step
Epoch 10/50
538/538 - 14s - loss: 3.2319 - accuracy300: 0.3976 - val_loss: 3.3174 - val_accuracy300: 0.3573 - 14s/epoch - 25ms/step
Epoch 11/50
538/538 - 13s - loss: 3.2292 - accuracy300: 0.4002 - val_loss: 3.3213 - val_accuracy300: 0.3600 - 13s/epoch - 25ms/step
Epoch 12/50
538/538 - 14s - loss: 3.2269 - accuracy300: 0.4034 - val_loss: 3.3210 - val_accuracy300: 0.3537 - 14s/epoch - 25ms/step
Epoch 13/50
538/538 - 13s - loss: 3.2237 - accuracy300: 0.4059 - val_loss: 3.3243 - val_accuracy300: 0.3565 - 13s/epoch - 25ms/step
Epoch 14/50
538/538 - 14s - loss: 3.2220 - accuracy300: 0.4060 - val_loss: 3.3297 - val_accuracy300: 0.3545 - 14s/epoch - 25ms/step
Epoch 15/50
538/538 - 13s - loss: 3.2185 - accuracy300: 0.4076 - val_loss: 3.3357 - val_accuracy300: 0.3498 - 13s/epoch - 25ms/step
Epoch 16/50
538/538 - 13s - loss: 3.2143 - accuracy300: 0.4113 - val_loss: 3.3325 - val_accuracy300: 0.3531 - 13s/epoch - 25ms/step
testing model: results/PCAR/W4/deepVOL_L2/h300
Evaluating performance on  test set...
1590/1590 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0970424
{'0': {'precision': 0.35044642857142855, 'recall': 0.005958977940395039, 'f1-score': 0.011718691686446625, 'support': 131734}, '1': {'precision': 0.38962696752781295, 'recall': 0.8073847489470222, 'f1-score': 0.525607004561089, 'support': 147439}, '2': {'precision': 0.3242401644630764, 'recall': 0.2517172317754377, 'f1-score': 0.2834127564367948, 'support': 127822}, 'accuracy': 0.373468961535154, 'macro avg': {'precision': 0.35477118685410597, 'recall': 0.3550203195542849, 'f1-score': 0.2735794842281101, 'support': 406995}, 'weighted avg': {'precision': 0.3564096526708218, 'recall': 0.373468961535154, 'f1-score': 0.2832101294349285, 'support': 406995}}
[[   785  91655  39294]
 [   636 119040  27763]
 [   819  94828  32175]]
Evaluating performance on  train set...
538/538 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0877689
{'0': {'precision': 0.4287515762925599, 'recall': 0.007524621002545092, 'f1-score': 0.01478968202183653, 'support': 45185}, '1': {'precision': 0.3830600578700981, 'recall': 0.715726781240385, 'f1-score': 0.4990346307079375, 'support': 45502}, '2': {'precision': 0.39093293223803466, 'recall': 0.43150568302754244, 'f1-score': 0.4102185350060704, 'support': 46982}, 'accuracy': 0.38628885224705634, 'macro avg': {'precision': 0.40091485546689754, 'recall': 0.38491902842349085, 'f1-score': 0.3080142825786148, 'support': 137669}, 'weighted avg': {'precision': 0.40074344805578505, 'recall': 0.38628885224705634, 'f1-score': 0.3097882076595636, 'support': 137669}}
[[  340 26017 18828]
 [  178 32567 12757]
 [  275 26434 20273]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1038389
{'0': {'precision': 0.4116279069767442, 'recall': 0.009287438346101375, 'f1-score': 0.018165024630541874, 'support': 19058}, '1': {'precision': 0.36040592783505154, 'recall': 0.6407950509794936, 'f1-score': 0.46133861190152164, 'support': 17458}, '2': {'precision': 0.3502406684224866, 'recall': 0.4543473138548539, 'f1-score': 0.39555874660238977, 'support': 16976}, 'accuracy': 0.356632767516638, 'macro avg': {'precision': 0.3740915010780941, 'recall': 0.3681432677268163, 'f1-score': 0.29168746104481774, 'support': 53492}, 'weighted avg': {'precision': 0.37542916560321643, 'recall': 0.356632767516638, 'f1-score': 0.2825701751347454, 'support': 53492}}
[[  177 10734  8147]
 [  109 11187  6162]
 [  144  9119  7713]]
training model: results/PCAR/W4/deepVOL_L2/h500
Epoch 1/50
538/538 - 16s - loss: 3.3333 - accuracy500: 0.3613 - val_loss: 3.3616 - val_accuracy500: 0.3300 - 16s/epoch - 30ms/step
Epoch 2/50
538/538 - 14s - loss: 3.2822 - accuracy500: 0.3745 - val_loss: 3.3433 - val_accuracy500: 0.3401 - 14s/epoch - 25ms/step
Epoch 3/50
538/538 - 14s - loss: 3.2636 - accuracy500: 0.3801 - val_loss: 3.3272 - val_accuracy500: 0.3416 - 14s/epoch - 25ms/step
Epoch 4/50
538/538 - 13s - loss: 3.2536 - accuracy500: 0.3865 - val_loss: 3.3206 - val_accuracy500: 0.3449 - 13s/epoch - 25ms/step
Epoch 5/50
538/538 - 13s - loss: 3.2498 - accuracy500: 0.3879 - val_loss: 3.3244 - val_accuracy500: 0.3416 - 13s/epoch - 25ms/step
Epoch 6/50
538/538 - 14s - loss: 3.2452 - accuracy500: 0.3913 - val_loss: 3.3194 - val_accuracy500: 0.3464 - 14s/epoch - 26ms/step
Epoch 7/50
538/538 - 14s - loss: 3.2402 - accuracy500: 0.3935 - val_loss: 3.3153 - val_accuracy500: 0.3509 - 14s/epoch - 26ms/step
Epoch 8/50
538/538 - 13s - loss: 3.2365 - accuracy500: 0.3964 - val_loss: 3.3239 - val_accuracy500: 0.3500 - 13s/epoch - 25ms/step
Epoch 9/50
538/538 - 14s - loss: 3.2331 - accuracy500: 0.3990 - val_loss: 3.3312 - val_accuracy500: 0.3462 - 14s/epoch - 26ms/step
Epoch 10/50
538/538 - 13s - loss: 3.2310 - accuracy500: 0.3993 - val_loss: 3.3360 - val_accuracy500: 0.3440 - 13s/epoch - 25ms/step
Epoch 11/50
538/538 - 14s - loss: 3.2261 - accuracy500: 0.4027 - val_loss: 3.3294 - val_accuracy500: 0.3493 - 14s/epoch - 25ms/step
Epoch 12/50
538/538 - 14s - loss: 3.2225 - accuracy500: 0.4077 - val_loss: 3.3430 - val_accuracy500: 0.3437 - 14s/epoch - 25ms/step
Epoch 13/50
538/538 - 13s - loss: 3.2196 - accuracy500: 0.4082 - val_loss: 3.3362 - val_accuracy500: 0.3475 - 13s/epoch - 25ms/step
Epoch 14/50
538/538 - 13s - loss: 3.2177 - accuracy500: 0.4086 - val_loss: 3.3386 - val_accuracy500: 0.3486 - 13s/epoch - 25ms/step
Epoch 15/50
538/538 - 14s - loss: 3.2146 - accuracy500: 0.4105 - val_loss: 3.3437 - val_accuracy500: 0.3465 - 14s/epoch - 25ms/step
Epoch 16/50
538/538 - 13s - loss: 3.2085 - accuracy500: 0.4142 - val_loss: 3.3476 - val_accuracy500: 0.3465 - 13s/epoch - 25ms/step
Epoch 17/50
538/538 - 14s - loss: 3.2027 - accuracy500: 0.4172 - val_loss: 3.3486 - val_accuracy500: 0.3514 - 14s/epoch - 25ms/step
testing model: results/PCAR/W4/deepVOL_L2/h500
Evaluating performance on  test set...
1590/1590 - 18s - 18s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1015437
{'0': {'precision': 0.3272435947784288, 'recall': 0.156227501799856, 'f1-score': 0.21148916513961716, 'support': 133344}, '1': {'precision': 0.3852570145427969, 'recall': 0.4986222685274038, 'f1-score': 0.4346695985229181, 'support': 145892}, '2': {'precision': 0.31202350596062495, 'recall': 0.3773667608544212, 'f1-score': 0.3415983817084879, 'support': 127759}, 'accuracy': 0.34838020123097335, 'macro avg': {'precision': 0.34150803842728356, 'recall': 0.3440721770605603, 'f1-score': 0.32925238179034105, 'support': 406995}, 'weighted avg': {'precision': 0.3432614586563374, 'recall': 0.34838020123097335, 'f1-score': 0.33233306540074786, 'support': 406995}}
[[20832 56265 56247]
 [23092 72745 50055]
 [19735 59812 48212]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0859262
{'0': {'precision': 0.3719198028673835, 'recall': 0.14784389679200338, 'f1-score': 0.2115810434090004, 'support': 44919}, '1': {'precision': 0.39914138302787616, 'recall': 0.45534008301671314, 'f1-score': 0.42539265672927973, 'support': 45533}, '2': {'precision': 0.381234436929968, 'recall': 0.5479806002075523, 'f1-score': 0.4496463514241524, 'support': 47217}, 'accuracy': 0.3867827906064546, 'macro avg': {'precision': 0.38409854094174256, 'recall': 0.38372152667208964, 'f1-score': 0.3622066838541442, 'support': 137669}, 'weighted avg': {'precision': 0.3841178233802133, 'recall': 0.3867827906064546, 'f1-score': 0.3639480529599066, 'support': 137669}}
[[ 6641 15247 23031]
 [ 5836 20733 18964]
 [ 5379 15964 25874]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1011965
{'0': {'precision': 0.3651003167898627, 'recall': 0.1458860759493671, 'f1-score': 0.20847151040096473, 'support': 18960}, '1': {'precision': 0.37113836113888743, 'recall': 0.3979010325565649, 'f1-score': 0.38405402461605487, 'support': 17723}, '2': {'precision': 0.33780419840237785, 'recall': 0.5409007079540722, 'f1-score': 0.4158814381117921, 'support': 16809}, 'accuracy': 0.35351080535407164, 'macro avg': {'precision': 0.358014292110376, 'recall': 0.3615626054866681, 'f1-score': 0.3361356577096039, 'support': 53492}, 'weighted avg': {'precision': 0.35852347924448275, 'recall': 0.35351080535407164, 'f1-score': 0.33182084066203815, 'support': 53492}}
[[2766 6452 9742]
 [2590 7052 8081]
 [2220 5497 9092]]
training model: results/PCAR/W4/deepVOL_L2/h1000
Epoch 1/50
538/538 - 16s - loss: 3.3406 - accuracy1000: 0.3635 - val_loss: 3.3469 - val_accuracy1000: 0.3245 - 16s/epoch - 29ms/step
Epoch 2/50
538/538 - 13s - loss: 3.3003 - accuracy1000: 0.3563 - val_loss: 3.3087 - val_accuracy1000: 0.3426 - 13s/epoch - 25ms/step
Epoch 3/50
538/538 - 14s - loss: 3.2815 - accuracy1000: 0.3620 - val_loss: 3.3088 - val_accuracy1000: 0.3392 - 14s/epoch - 25ms/step
Epoch 4/50
538/538 - 13s - loss: 3.2718 - accuracy1000: 0.3708 - val_loss: 3.3095 - val_accuracy1000: 0.3386 - 13s/epoch - 25ms/step
Epoch 5/50
538/538 - 13s - loss: 3.2656 - accuracy1000: 0.3731 - val_loss: 3.3117 - val_accuracy1000: 0.3373 - 13s/epoch - 25ms/step
Epoch 6/50
538/538 - 13s - loss: 3.2625 - accuracy1000: 0.3776 - val_loss: 3.3124 - val_accuracy1000: 0.3379 - 13s/epoch - 24ms/step
Epoch 7/50
538/538 - 13s - loss: 3.2603 - accuracy1000: 0.3804 - val_loss: 3.3147 - val_accuracy1000: 0.3373 - 13s/epoch - 25ms/step
Epoch 8/50
538/538 - 13s - loss: 3.2590 - accuracy1000: 0.3796 - val_loss: 3.3129 - val_accuracy1000: 0.3389 - 13s/epoch - 25ms/step
Epoch 9/50
538/538 - 13s - loss: 3.2554 - accuracy1000: 0.3834 - val_loss: 3.3172 - val_accuracy1000: 0.3356 - 13s/epoch - 25ms/step
Epoch 10/50
538/538 - 13s - loss: 3.2529 - accuracy1000: 0.3863 - val_loss: 3.3130 - val_accuracy1000: 0.3431 - 13s/epoch - 25ms/step
Epoch 11/50
538/538 - 13s - loss: 3.2490 - accuracy1000: 0.3904 - val_loss: 3.3187 - val_accuracy1000: 0.3364 - 13s/epoch - 25ms/step
Epoch 12/50
538/538 - 13s - loss: 3.2455 - accuracy1000: 0.3912 - val_loss: 3.3214 - val_accuracy1000: 0.3363 - 13s/epoch - 25ms/step
testing model: results/PCAR/W4/deepVOL_L2/h1000
Evaluating performance on  test set...
1590/1590 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0979874
{'0': {'precision': 0.32716739316716964, 'recall': 0.130252599415595, 'f1-score': 0.18632505834924673, 'support': 134838}, '1': {'precision': 0.37599074960777523, 'recall': 0.5277597042778187, 'f1-score': 0.43913176689660505, 'support': 139861}, '2': {'precision': 0.3189615088186398, 'recall': 0.37851484549797426, 'f1-score': 0.3461957254409889, 'support': 132296}, 'accuracy': 0.3475521812307277, 'macro avg': {'precision': 0.340706550531195, 'recall': 0.34550904973046265, 'f1-score': 0.32388418356228027, 'support': 406995}, 'weighted avg': {'precision': 0.3412778313282439, 'recall': 0.3475521812307277, 'f1-score': 0.32516717886107416, 'support': 406995}}
[[17563 58259 59016]
 [18143 73813 47905]
 [17976 64244 50076]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0927598
{'0': {'precision': 0.3347384224506294, 'recall': 0.1285993167398731, 'f1-score': 0.18581319315340727, 'support': 45078}, '1': {'precision': 0.375343371129975, 'recall': 0.4056382670029687, 'f1-score': 0.3899032375721427, 'support': 44801}, '2': {'precision': 0.3691578391303139, 'recall': 0.5556601799539652, 'f1-score': 0.4436036216631586, 'support': 47790}, 'accuracy': 0.3670034648323152, 'macro avg': {'precision': 0.3597465442369728, 'recall': 0.36329925456560236, 'f1-score': 0.33977335079623616, 'support': 137669}, 'weighted avg': {'precision': 0.3599005593798254, 'recall': 0.3670034648323152, 'f1-score': 0.3417178823607435, 'support': 137669}}
[[ 5797 14903 24378]
 [ 5627 18173 21001]
 [ 5894 15341 26555]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991933
{'0': {'precision': 0.36450327355536577, 'recall': 0.12934343434343434, 'f1-score': 0.19093416834414373, 'support': 19800}, '1': {'precision': 0.3496577438922589, 'recall': 0.36573723732464053, 'f1-score': 0.3575167861613748, 'support': 17179}, '2': {'precision': 0.32859599256062044, 'recall': 0.5670683703748561, 'f1-score': 0.4160853143745834, 'support': 16513}, 'accuracy': 0.3403873476407687, 'macro avg': {'precision': 0.3475856700027484, 'recall': 0.35404968068097703, 'f1-score': 0.32151208962670064, 'support': 53492}, 'weighted avg': {'precision': 0.3486510286374576, 'recall': 0.3403873476407687, 'f1-score': 0.31393655497920814, 'support': 53492}}
[[ 2561  6726 10513]
 [ 2276  6283  8620]
 [ 2189  4960  9364]]
training model: results/PCAR/W4/deepVOL_L3/h10
Epoch 1/50
538/538 - 24s - loss: 3.3131 - accuracy10: 0.3652 - val_loss: 3.2845 - val_accuracy10: 0.3710 - 24s/epoch - 44ms/step
Epoch 2/50
538/538 - 22s - loss: 3.2600 - accuracy10: 0.3866 - val_loss: 3.2427 - val_accuracy10: 0.3971 - 22s/epoch - 40ms/step
Epoch 3/50
538/538 - 21s - loss: 3.1961 - accuracy10: 0.4258 - val_loss: 3.1829 - val_accuracy10: 0.4275 - 21s/epoch - 40ms/step
Epoch 4/50
538/538 - 22s - loss: 3.1473 - accuracy10: 0.4479 - val_loss: 3.1617 - val_accuracy10: 0.4326 - 22s/epoch - 40ms/step
Epoch 5/50
538/538 - 22s - loss: 3.1210 - accuracy10: 0.4591 - val_loss: 3.1518 - val_accuracy10: 0.4363 - 22s/epoch - 40ms/step
Epoch 6/50
538/538 - 21s - loss: 3.0994 - accuracy10: 0.4666 - val_loss: 3.1470 - val_accuracy10: 0.4370 - 21s/epoch - 40ms/step
Epoch 7/50
538/538 - 21s - loss: 3.0884 - accuracy10: 0.4709 - val_loss: 3.1646 - val_accuracy10: 0.4267 - 21s/epoch - 39ms/step
Epoch 8/50
538/538 - 21s - loss: 3.0775 - accuracy10: 0.4737 - val_loss: 3.1645 - val_accuracy10: 0.4288 - 21s/epoch - 39ms/step
Epoch 9/50
538/538 - 21s - loss: 3.0690 - accuracy10: 0.4769 - val_loss: 3.1362 - val_accuracy10: 0.4476 - 21s/epoch - 40ms/step
Epoch 10/50
538/538 - 22s - loss: 3.0601 - accuracy10: 0.4811 - val_loss: 3.1250 - val_accuracy10: 0.4494 - 22s/epoch - 40ms/step
Epoch 11/50
538/538 - 21s - loss: 3.0511 - accuracy10: 0.4838 - val_loss: 3.1176 - val_accuracy10: 0.4506 - 21s/epoch - 39ms/step
Epoch 12/50
538/538 - 22s - loss: 3.0447 - accuracy10: 0.4852 - val_loss: 3.1044 - val_accuracy10: 0.4573 - 22s/epoch - 40ms/step
Epoch 13/50
538/538 - 22s - loss: 3.0398 - accuracy10: 0.4879 - val_loss: 3.1061 - val_accuracy10: 0.4541 - 22s/epoch - 41ms/step
Epoch 14/50
538/538 - 22s - loss: 3.0335 - accuracy10: 0.4898 - val_loss: 3.0977 - val_accuracy10: 0.4578 - 22s/epoch - 40ms/step
Epoch 15/50
538/538 - 21s - loss: 3.0276 - accuracy10: 0.4906 - val_loss: 3.0889 - val_accuracy10: 0.4632 - 21s/epoch - 40ms/step
Epoch 16/50
538/538 - 21s - loss: 3.0219 - accuracy10: 0.4934 - val_loss: 3.0906 - val_accuracy10: 0.4637 - 21s/epoch - 39ms/step
Epoch 17/50
538/538 - 21s - loss: 3.0165 - accuracy10: 0.4957 - val_loss: 3.0831 - val_accuracy10: 0.4662 - 21s/epoch - 39ms/step
Epoch 18/50
538/538 - 21s - loss: 3.0110 - accuracy10: 0.4970 - val_loss: 3.0845 - val_accuracy10: 0.4662 - 21s/epoch - 39ms/step
Epoch 19/50
538/538 - 21s - loss: 3.0029 - accuracy10: 0.4996 - val_loss: 3.0833 - val_accuracy10: 0.4666 - 21s/epoch - 39ms/step
Epoch 20/50
538/538 - 21s - loss: 3.0015 - accuracy10: 0.5002 - val_loss: 3.0831 - val_accuracy10: 0.4644 - 21s/epoch - 39ms/step
Epoch 21/50
538/538 - 21s - loss: 2.9946 - accuracy10: 0.5011 - val_loss: 3.0868 - val_accuracy10: 0.4637 - 21s/epoch - 39ms/step
Epoch 22/50
538/538 - 21s - loss: 2.9892 - accuracy10: 0.5029 - val_loss: 3.0837 - val_accuracy10: 0.4637 - 21s/epoch - 39ms/step
Epoch 23/50
538/538 - 21s - loss: 2.9857 - accuracy10: 0.5037 - val_loss: 3.0845 - val_accuracy10: 0.4646 - 21s/epoch - 39ms/step
Epoch 24/50
538/538 - 21s - loss: 2.9836 - accuracy10: 0.5037 - val_loss: 3.0859 - val_accuracy10: 0.4646 - 21s/epoch - 39ms/step
Epoch 25/50
538/538 - 21s - loss: 2.9775 - accuracy10: 0.5070 - val_loss: 3.0876 - val_accuracy10: 0.4642 - 21s/epoch - 39ms/step
Epoch 26/50
538/538 - 21s - loss: 2.9718 - accuracy10: 0.5082 - val_loss: 3.0878 - val_accuracy10: 0.4649 - 21s/epoch - 39ms/step
Epoch 27/50
538/538 - 21s - loss: 2.9677 - accuracy10: 0.5089 - val_loss: 3.0920 - val_accuracy10: 0.4618 - 21s/epoch - 39ms/step
testing model: results/PCAR/W4/deepVOL_L3/h10
Evaluating performance on  test set...
1590/1590 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0108976
{'0': {'precision': 0.46130607990530786, 'recall': 0.4264576188143067, 'f1-score': 0.44319787498567903, 'support': 122460}, '1': {'precision': 0.4996404590463419, 'recall': 0.6190218209179834, 'f1-score': 0.5529610719922139, 'support': 166125}, '2': {'precision': 0.4540855765732994, 'recall': 0.3373448188497593, 'f1-score': 0.38710521470311754, 'support': 118410}, 'accuracy': 0.47913119325790243, 'macro avg': {'precision': 0.47167737184164976, 'recall': 0.4609414195273498, 'f1-score': 0.46108805389367014, 'support': 406995}, 'weighted avg': {'precision': 0.4748524844932294, 'recall': 0.47913119325790243, 'f1-score': 0.4716809747747489, 'support': 406995}}
[[ 52224  49415  20821]
 [ 36088 102835  27202]
 [ 24897  53568  39945]]
Evaluating performance on  train set...
538/538 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0153618
{'0': {'precision': 0.4844776659232021, 'recall': 0.5229698073919833, 'f1-score': 0.5029883906499357, 'support': 46104}, '1': {'precision': 0.45688711319413766, 'recall': 0.5260992656816774, 'f1-score': 0.4890565727385811, 'support': 45212}, '2': {'precision': 0.5120113836109483, 'recall': 0.3958967057148405, 'f1-score': 0.44652894371851964, 'support': 46353}, 'accuracy': 0.48121218284435857, 'macro avg': {'precision': 0.4844587209094294, 'recall': 0.481655259596167, 'f1-score': 0.4795246357023455, 'support': 137669}, 'weighted avg': {'precision': 0.48468719999400706, 'recall': 0.48121218284435857, 'f1-score': 0.4794031964884317, 'support': 137669}}
[[24111 13334  8659]
 [12595 23786  8831]
 [13061 14941 18351]]
Evaluating performance on  val set...
209/209 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0272051
{'0': {'precision': 0.4665409990574929, 'recall': 0.4962845010615711, 'f1-score': 0.4809533335238476, 'support': 16956}, '1': {'precision': 0.47486142176407664, 'recall': 0.49198992443324935, 'f1-score': 0.4832739509105305, 'support': 19850}, '2': {'precision': 0.45207871583047887, 'recall': 0.40339206520436294, 'f1-score': 0.4263499604117181, 'support': 16686}, 'accuracy': 0.4657144993643909, 'macro avg': {'precision': 0.4644937122173494, 'recall': 0.4638888302330611, 'f1-score': 0.4635257482820321, 'support': 53492}, 'weighted avg': {'precision': 0.4651172858442971, 'recall': 0.4657144993643909, 'f1-score': 0.4647818007970223, 'support': 53492}}
[[8415 5162 3379]
 [5305 9766 4779]
 [4317 5638 6731]]
training model: results/PCAR/W4/deepVOL_L3/h20
Epoch 1/50
538/538 - 23s - loss: 3.3282 - accuracy20: 0.3521 - val_loss: 3.2954 - val_accuracy20: 0.3651 - 23s/epoch - 43ms/step
Epoch 2/50
538/538 - 21s - loss: 3.2838 - accuracy20: 0.3651 - val_loss: 3.2795 - val_accuracy20: 0.3748 - 21s/epoch - 39ms/step
Epoch 3/50
538/538 - 20s - loss: 3.2616 - accuracy20: 0.3842 - val_loss: 3.2598 - val_accuracy20: 0.3845 - 20s/epoch - 38ms/step
Epoch 4/50
538/538 - 20s - loss: 3.2278 - accuracy20: 0.4103 - val_loss: 3.2200 - val_accuracy20: 0.4095 - 20s/epoch - 38ms/step
Epoch 5/50
538/538 - 20s - loss: 3.2011 - accuracy20: 0.4264 - val_loss: 3.1993 - val_accuracy20: 0.4174 - 20s/epoch - 38ms/step
Epoch 6/50
538/538 - 20s - loss: 3.1792 - accuracy20: 0.4351 - val_loss: 3.1905 - val_accuracy20: 0.4215 - 20s/epoch - 38ms/step
Epoch 7/50
538/538 - 21s - loss: 3.1661 - accuracy20: 0.4420 - val_loss: 3.1845 - val_accuracy20: 0.4245 - 21s/epoch - 38ms/step
Epoch 8/50
538/538 - 21s - loss: 3.1561 - accuracy20: 0.4461 - val_loss: 3.1843 - val_accuracy20: 0.4241 - 21s/epoch - 40ms/step
Epoch 9/50
538/538 - 20s - loss: 3.1474 - accuracy20: 0.4498 - val_loss: 3.1799 - val_accuracy20: 0.4271 - 20s/epoch - 38ms/step
Epoch 10/50
538/538 - 20s - loss: 3.1416 - accuracy20: 0.4515 - val_loss: 3.1761 - val_accuracy20: 0.4290 - 20s/epoch - 38ms/step
Epoch 11/50
538/538 - 20s - loss: 3.1339 - accuracy20: 0.4538 - val_loss: 3.1765 - val_accuracy20: 0.4267 - 20s/epoch - 38ms/step
Epoch 12/50
538/538 - 20s - loss: 3.1288 - accuracy20: 0.4566 - val_loss: 3.1780 - val_accuracy20: 0.4241 - 20s/epoch - 38ms/step
Epoch 13/50
538/538 - 20s - loss: 3.1247 - accuracy20: 0.4571 - val_loss: 3.1783 - val_accuracy20: 0.4268 - 20s/epoch - 38ms/step
Epoch 14/50
538/538 - 20s - loss: 3.1167 - accuracy20: 0.4612 - val_loss: 3.1815 - val_accuracy20: 0.4241 - 20s/epoch - 38ms/step
Epoch 15/50
538/538 - 20s - loss: 3.1150 - accuracy20: 0.4615 - val_loss: 3.1782 - val_accuracy20: 0.4255 - 20s/epoch - 38ms/step
Epoch 16/50
538/538 - 20s - loss: 3.1110 - accuracy20: 0.4626 - val_loss: 3.1835 - val_accuracy20: 0.4257 - 20s/epoch - 37ms/step
Epoch 17/50
538/538 - 21s - loss: 3.1067 - accuracy20: 0.4634 - val_loss: 3.1845 - val_accuracy20: 0.4261 - 21s/epoch - 39ms/step
Epoch 18/50
538/538 - 20s - loss: 3.1041 - accuracy20: 0.4650 - val_loss: 3.1852 - val_accuracy20: 0.4251 - 20s/epoch - 37ms/step
Epoch 19/50
538/538 - 20s - loss: 3.0986 - accuracy20: 0.4652 - val_loss: 3.1842 - val_accuracy20: 0.4245 - 20s/epoch - 38ms/step
Epoch 20/50
538/538 - 20s - loss: 3.0957 - accuracy20: 0.4667 - val_loss: 3.1871 - val_accuracy20: 0.4257 - 20s/epoch - 38ms/step
testing model: results/PCAR/W4/deepVOL_L3/h20
Evaluating performance on  test set...
1590/1590 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0471662
{'0': {'precision': 0.4128127418952782, 'recall': 0.5021584915296164, 'f1-score': 0.4531233686514666, 'support': 125319}, '1': {'precision': 0.4657278284540809, 'recall': 0.484270444077518, 'f1-score': 0.47481817351876077, 'support': 161098}, '2': {'precision': 0.41486196160430144, 'recall': 0.29947419927349933, 'f1-score': 0.34784870363502385, 'support': 120578}, 'accuracy': 0.43502991437241245, 'macro avg': {'precision': 0.4311341773178869, 'recall': 0.4286343782935446, 'f1-score': 0.425263415268417, 'support': 406995}, 'weighted avg': {'precision': 0.4343648627530887, 'recall': 0.43502991437241245, 'f1-score': 0.43052157038897865, 'support': 406995}}
[[62930 40482 21907]
 [54059 78015 29024]
 [35453 49015 36110]]
Evaluating performance on  train set...
538/538 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0548097
{'0': {'precision': 0.4378294628864511, 'recall': 0.5349216710182768, 'f1-score': 0.48153008461297403, 'support': 45960}, '1': {'precision': 0.4216373075789521, 'recall': 0.40823583642469874, 'f1-score': 0.4148283630361564, 'support': 45557}, '2': {'precision': 0.4668787425149701, 'recall': 0.37842347027214424, 'f1-score': 0.41802297750119677, 'support': 46152}, 'accuracy': 0.4405349061880307, 'macro avg': {'precision': 0.4421151709934577, 'recall': 0.4405269925717066, 'f1-score': 0.43812714171677575, 'support': 137669}, 'weighted avg': {'precision': 0.4422096525738294, 'recall': 0.4405349061880307, 'f1-score': 0.4381673062293305, 'support': 137669}}
[[24585 11887  9488]
 [16504 18598 10455]
 [15063 13624 17465]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0587854
{'0': {'precision': 0.42438707883394355, 'recall': 0.5318580472788523, 'f1-score': 0.4720833118523483, 'support': 17217}, '1': {'precision': 0.4280213080033374, 'recall': 0.3507784557121818, 'f1-score': 0.3855693348365276, 'support': 19012}, '2': {'precision': 0.4324721439941227, 'recall': 0.4091988646237618, 'f1-score': 0.4205137363455071, 'support': 17263}, 'accuracy': 0.42791445449786886, 'macro avg': {'precision': 0.4282935102771345, 'recall': 0.430611789204932, 'f1-score': 0.426055461011461, 'support': 53492}, 'weighted avg': {'precision': 0.4282879695246765, 'recall': 0.42791445449786886, 'f1-score': 0.4246921260114865, 'support': 53492}}
[[9157 4185 3875]
 [6948 6669 5395]
 [5472 4727 7064]]
training model: results/PCAR/W4/deepVOL_L3/h30
Epoch 1/50
538/538 - 23s - loss: 3.3286 - accuracy30: 0.3529 - val_loss: 3.3199 - val_accuracy30: 0.3475 - 23s/epoch - 42ms/step
Epoch 2/50
538/538 - 22s - loss: 3.2914 - accuracy30: 0.3625 - val_loss: 3.2798 - val_accuracy30: 0.3715 - 22s/epoch - 40ms/step
Epoch 3/50
538/538 - 22s - loss: 3.2584 - accuracy30: 0.3913 - val_loss: 3.2499 - val_accuracy30: 0.3959 - 22s/epoch - 40ms/step
Epoch 4/50
538/538 - 21s - loss: 3.2384 - accuracy30: 0.4050 - val_loss: 3.2394 - val_accuracy30: 0.4008 - 21s/epoch - 40ms/step
Epoch 5/50
538/538 - 21s - loss: 3.2215 - accuracy30: 0.4145 - val_loss: 3.2274 - val_accuracy30: 0.4077 - 21s/epoch - 40ms/step
Epoch 6/50
538/538 - 21s - loss: 3.2099 - accuracy30: 0.4194 - val_loss: 3.2191 - val_accuracy30: 0.4094 - 21s/epoch - 40ms/step
Epoch 7/50
538/538 - 21s - loss: 3.1998 - accuracy30: 0.4254 - val_loss: 3.2135 - val_accuracy30: 0.4127 - 21s/epoch - 40ms/step
Epoch 8/50
538/538 - 21s - loss: 3.1940 - accuracy30: 0.4280 - val_loss: 3.2139 - val_accuracy30: 0.4141 - 21s/epoch - 40ms/step
Epoch 9/50
538/538 - 21s - loss: 3.1872 - accuracy30: 0.4298 - val_loss: 3.2165 - val_accuracy30: 0.4134 - 21s/epoch - 39ms/step
Epoch 10/50
538/538 - 21s - loss: 3.1833 - accuracy30: 0.4316 - val_loss: 3.2146 - val_accuracy30: 0.4151 - 21s/epoch - 40ms/step
Epoch 11/50
538/538 - 21s - loss: 3.1798 - accuracy30: 0.4329 - val_loss: 3.2134 - val_accuracy30: 0.4150 - 21s/epoch - 39ms/step
Epoch 12/50
538/538 - 21s - loss: 3.1767 - accuracy30: 0.4345 - val_loss: 3.2083 - val_accuracy30: 0.4162 - 21s/epoch - 40ms/step
Epoch 13/50
538/538 - 21s - loss: 3.1704 - accuracy30: 0.4377 - val_loss: 3.2126 - val_accuracy30: 0.4153 - 21s/epoch - 39ms/step
Epoch 14/50
538/538 - 21s - loss: 3.1669 - accuracy30: 0.4380 - val_loss: 3.2080 - val_accuracy30: 0.4144 - 21s/epoch - 40ms/step
Epoch 15/50
538/538 - 21s - loss: 3.1625 - accuracy30: 0.4406 - val_loss: 3.2108 - val_accuracy30: 0.4143 - 21s/epoch - 39ms/step
Epoch 16/50
538/538 - 21s - loss: 3.1586 - accuracy30: 0.4422 - val_loss: 3.2098 - val_accuracy30: 0.4169 - 21s/epoch - 39ms/step
Epoch 17/50
538/538 - 21s - loss: 3.1546 - accuracy30: 0.4439 - val_loss: 3.2067 - val_accuracy30: 0.4164 - 21s/epoch - 39ms/step
Epoch 18/50
538/538 - 21s - loss: 3.1519 - accuracy30: 0.4452 - val_loss: 3.2101 - val_accuracy30: 0.4146 - 21s/epoch - 39ms/step
Epoch 19/50
538/538 - 21s - loss: 3.1486 - accuracy30: 0.4463 - val_loss: 3.2083 - val_accuracy30: 0.4161 - 21s/epoch - 39ms/step
Epoch 20/50
538/538 - 21s - loss: 3.1453 - accuracy30: 0.4464 - val_loss: 3.2089 - val_accuracy30: 0.4193 - 21s/epoch - 39ms/step
Epoch 21/50
538/538 - 21s - loss: 3.1410 - accuracy30: 0.4487 - val_loss: 3.2082 - val_accuracy30: 0.4195 - 21s/epoch - 39ms/step
Epoch 22/50
538/538 - 21s - loss: 3.1388 - accuracy30: 0.4498 - val_loss: 3.2085 - val_accuracy30: 0.4184 - 21s/epoch - 39ms/step
Epoch 23/50
538/538 - 21s - loss: 3.1360 - accuracy30: 0.4502 - val_loss: 3.2133 - val_accuracy30: 0.4174 - 21s/epoch - 39ms/step
Epoch 24/50
538/538 - 21s - loss: 3.1343 - accuracy30: 0.4515 - val_loss: 3.2142 - val_accuracy30: 0.4173 - 21s/epoch - 40ms/step
Epoch 25/50
538/538 - 21s - loss: 3.1302 - accuracy30: 0.4540 - val_loss: 3.2135 - val_accuracy30: 0.4185 - 21s/epoch - 39ms/step
Epoch 26/50
538/538 - 21s - loss: 3.1277 - accuracy30: 0.4550 - val_loss: 3.2224 - val_accuracy30: 0.4158 - 21s/epoch - 40ms/step
Epoch 27/50
538/538 - 21s - loss: 3.1226 - accuracy30: 0.4566 - val_loss: 3.2316 - val_accuracy30: 0.4154 - 21s/epoch - 39ms/step
testing model: results/PCAR/W4/deepVOL_L3/h30
Evaluating performance on  test set...
1590/1590 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0658015
{'0': {'precision': 0.4105939497457932, 'recall': 0.47392740798927985, 'f1-score': 0.43999327916146813, 'support': 129849}, '1': {'precision': 0.45594149497854364, 'recall': 0.2686475287763356, 'f1-score': 0.3380883559561344, 'support': 151079}, '2': {'precision': 0.39269121172642313, 'recall': 0.5236183933939889, 'f1-score': 0.44880101711278664, 'support': 126067}, 'accuracy': 0.4131180972739223, 'macro avg': {'precision': 0.41974221881692, 'recall': 0.42206444338653476, 'f1-score': 0.40896088407679637, 'support': 406995}, 'weighted avg': {'precision': 0.4218818459418909, 'recall': 0.4131180972739223, 'f1-score': 0.4048937600208651, 'support': 406995}}
[[61539 23620 44690]
 [53094 40587 57398]
 [35245 24811 66011]]
Evaluating performance on  train set...
538/538 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0574939
{'0': {'precision': 0.44175658429052095, 'recall': 0.49427724528873407, 'f1-score': 0.46654345317717216, 'support': 46219}, '1': {'precision': 0.44037601083699357, 'recall': 0.23726639389583104, 'f1-score': 0.30838220075888234, 'support': 45215}, '2': {'precision': 0.429717180244829, 'recall': 0.5724667459716665, 'f1-score': 0.49092544677220407, 'support': 46235}, 'accuracy': 0.43612577995046087, 'macro avg': {'precision': 0.4372832584574478, 'recall': 0.4346701283854106, 'f1-score': 0.4219503669027529, 'support': 137669}, 'weighted avg': {'precision': 0.43725982412843795, 'recall': 0.43612577995046087, 'f1-score': 0.4227866193639922, 'support': 137669}}
[[22845  6925 16449]
 [15810 10728 18677]
 [13059  6708 26468]]
Evaluating performance on  val set...
209/209 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0677481
{'0': {'precision': 0.42938833860921066, 'recall': 0.48181036952162704, 'f1-score': 0.4540914122188926, 'support': 17455}, '1': {'precision': 0.42751420642262455, 'recall': 0.17505411255411255, 'f1-score': 0.24839712826813068, 'support': 18480}, '2': {'precision': 0.4056342306086032, 'recall': 0.608532209375178, 'f1-score': 0.4867869509750319, 'support': 17557}, 'accuracy': 0.4174269049577507, 'macro avg': {'precision': 0.42084559188014614, 'recall': 0.4217988971503059, 'f1-score': 0.39642516382068504, 'support': 53492}, 'weighted avg': {'precision': 0.4209443687263351, 'recall': 0.4174269049577507, 'f1-score': 0.39376099283901256, 'support': 53492}}
[[ 8410  2207  6838]
 [ 6428  3235  8817]
 [ 4748  2125 10684]]
training model: results/PCAR/W4/deepVOL_L3/h50
Epoch 1/50
538/538 - 23s - loss: 3.3207 - accuracy50: 0.3596 - val_loss: 3.3029 - val_accuracy50: 0.3486 - 23s/epoch - 42ms/step
Epoch 2/50
538/538 - 21s - loss: 3.2921 - accuracy50: 0.3619 - val_loss: 3.2891 - val_accuracy50: 0.3606 - 21s/epoch - 38ms/step
Epoch 3/50
538/538 - 21s - loss: 3.2820 - accuracy50: 0.3679 - val_loss: 3.2813 - val_accuracy50: 0.3702 - 21s/epoch - 39ms/step
Epoch 4/50
538/538 - 21s - loss: 3.2628 - accuracy50: 0.3856 - val_loss: 3.2714 - val_accuracy50: 0.3731 - 21s/epoch - 38ms/step
Epoch 5/50
538/538 - 20s - loss: 3.2520 - accuracy50: 0.3939 - val_loss: 3.2591 - val_accuracy50: 0.3905 - 20s/epoch - 38ms/step
Epoch 6/50
538/538 - 21s - loss: 3.2403 - accuracy50: 0.4048 - val_loss: 3.2553 - val_accuracy50: 0.3967 - 21s/epoch - 38ms/step
Epoch 7/50
538/538 - 20s - loss: 3.2315 - accuracy50: 0.4081 - val_loss: 3.2548 - val_accuracy50: 0.3916 - 20s/epoch - 38ms/step
Epoch 8/50
538/538 - 20s - loss: 3.2238 - accuracy50: 0.4141 - val_loss: 3.2551 - val_accuracy50: 0.3924 - 20s/epoch - 38ms/step
Epoch 9/50
538/538 - 21s - loss: 3.2191 - accuracy50: 0.4180 - val_loss: 3.2448 - val_accuracy50: 0.3950 - 21s/epoch - 38ms/step
Epoch 10/50
538/538 - 21s - loss: 3.2159 - accuracy50: 0.4201 - val_loss: 3.2440 - val_accuracy50: 0.3969 - 21s/epoch - 38ms/step
Epoch 11/50
538/538 - 20s - loss: 3.2098 - accuracy50: 0.4225 - val_loss: 3.2381 - val_accuracy50: 0.4005 - 20s/epoch - 38ms/step
Epoch 12/50
538/538 - 21s - loss: 3.2055 - accuracy50: 0.4264 - val_loss: 3.2319 - val_accuracy50: 0.4077 - 21s/epoch - 38ms/step
Epoch 13/50
538/538 - 20s - loss: 3.2016 - accuracy50: 0.4274 - val_loss: 3.2365 - val_accuracy50: 0.4039 - 20s/epoch - 38ms/step
Epoch 14/50
538/538 - 21s - loss: 3.1972 - accuracy50: 0.4307 - val_loss: 3.2414 - val_accuracy50: 0.4013 - 21s/epoch - 38ms/step
Epoch 15/50
538/538 - 21s - loss: 3.1931 - accuracy50: 0.4322 - val_loss: 3.2459 - val_accuracy50: 0.3965 - 21s/epoch - 38ms/step
Epoch 16/50
538/538 - 21s - loss: 3.1905 - accuracy50: 0.4332 - val_loss: 3.2467 - val_accuracy50: 0.3978 - 21s/epoch - 38ms/step
Epoch 17/50
538/538 - 20s - loss: 3.1864 - accuracy50: 0.4346 - val_loss: 3.2448 - val_accuracy50: 0.4018 - 20s/epoch - 38ms/step
Epoch 18/50
538/538 - 21s - loss: 3.1849 - accuracy50: 0.4341 - val_loss: 3.2495 - val_accuracy50: 0.3986 - 21s/epoch - 38ms/step
Epoch 19/50
538/538 - 20s - loss: 3.1813 - accuracy50: 0.4358 - val_loss: 3.2507 - val_accuracy50: 0.3996 - 20s/epoch - 38ms/step
Epoch 20/50
538/538 - 21s - loss: 3.1801 - accuracy50: 0.4361 - val_loss: 3.2554 - val_accuracy50: 0.3948 - 21s/epoch - 38ms/step
Epoch 21/50
538/538 - 20s - loss: 3.1787 - accuracy50: 0.4367 - val_loss: 3.2444 - val_accuracy50: 0.4032 - 20s/epoch - 38ms/step
Epoch 22/50
538/538 - 20s - loss: 3.1733 - accuracy50: 0.4398 - val_loss: 3.2508 - val_accuracy50: 0.3992 - 20s/epoch - 38ms/step
testing model: results/PCAR/W4/deepVOL_L3/h50
Evaluating performance on  test set...
1590/1590 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0711569
{'0': {'precision': 0.37269607843137254, 'recall': 0.38030529132729196, 'f1-score': 0.37646223865385325, 'support': 119951}, '1': {'precision': 0.4622194203251731, 'recall': 0.5153575352337298, 'f1-score': 0.4873442644927233, 'support': 169298}, '2': {'precision': 0.3624287831041175, 'recall': 0.29498241978496087, 'f1-score': 0.3252458095327278, 'support': 117746}, 'accuracy': 0.4117986707453409, 'macro avg': {'precision': 0.39911476062022105, 'recall': 0.3968817487819942, 'f1-score': 0.3963507708931014, 'support': 406995}, 'weighted avg': {'precision': 0.40696477898133915, 'recall': 0.4117986707453409, 'f1-score': 0.4077687056796717, 'support': 406995}}
[[45618 47897 26436]
 [47384 87249 34665]
 [29398 53615 34733]]
Evaluating performance on  train set...
538/538 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0778096
{'0': {'precision': 0.41654196157735085, 'recall': 0.4485334146288352, 'f1-score': 0.43194614828096006, 'support': 45923}, '1': {'precision': 0.38546485599164304, 'recall': 0.45480356553317924, 'f1-score': 0.41727330553395997, 'support': 45435}, '2': {'precision': 0.42995001589090176, 'recall': 0.3213275463712725, 'f1-score': 0.3677862633152913, 'support': 46311}, 'accuracy': 0.4078114898778955, 'macro avg': {'precision': 0.4106522778199652, 'recall': 0.408221508844429, 'f1-score': 0.4056685723767371, 'support': 137669}, 'weighted avg': {'precision': 0.4107959483937599, 'recall': 0.4078114898778955, 'f1-score': 0.4055206709196439, 'support': 137669}}
[[20598 15839  9486]
 [14527 20664 10244]
 [14325 17105 14881]]
Evaluating performance on  val set...
209/209 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0768871
{'0': {'precision': 0.4118564742589704, 'recall': 0.42324649298597194, 'f1-score': 0.41747380905317255, 'support': 17465}, '1': {'precision': 0.4053020647463676, 'recall': 0.42595370767252466, 'f1-score': 0.41537135243867396, 'support': 18664}, '2': {'precision': 0.40981856990394877, 'recall': 0.3759718942579047, 'f1-score': 0.39216628619488164, 'support': 17363}, 'accuracy': 0.40884618260674493, 'macro avg': {'precision': 0.4089923696364289, 'recall': 0.4083906983054671, 'f1-score': 0.4083371492289094, 'support': 53492}, 'weighted avg': {'precision': 0.4089080776303258, 'recall': 0.40884618260674493, 'f1-score': 0.4085256528869887, 'support': 53492}}
[[7392 5789 4284]
 [5597 7950 5117]
 [4959 5876 6528]]
training model: results/PCAR/W4/deepVOL_L3/h100
Epoch 1/50
538/538 - 23s - loss: 3.3306 - accuracy100: 0.3511 - val_loss: 3.3446 - val_accuracy100: 0.3332 - 23s/epoch - 43ms/step
Epoch 2/50
538/538 - 21s - loss: 3.2935 - accuracy100: 0.3636 - val_loss: 3.3046 - val_accuracy100: 0.3461 - 21s/epoch - 38ms/step
Epoch 3/50
538/538 - 21s - loss: 3.2796 - accuracy100: 0.3715 - val_loss: 3.2993 - val_accuracy100: 0.3584 - 21s/epoch - 38ms/step
Epoch 4/50
538/538 - 21s - loss: 3.2706 - accuracy100: 0.3794 - val_loss: 3.2995 - val_accuracy100: 0.3627 - 21s/epoch - 39ms/step
Epoch 5/50
538/538 - 21s - loss: 3.2618 - accuracy100: 0.3878 - val_loss: 3.2977 - val_accuracy100: 0.3682 - 21s/epoch - 39ms/step
Epoch 6/50
538/538 - 21s - loss: 3.2551 - accuracy100: 0.3932 - val_loss: 3.2961 - val_accuracy100: 0.3735 - 21s/epoch - 38ms/step
Epoch 7/50
538/538 - 20s - loss: 3.2502 - accuracy100: 0.3972 - val_loss: 3.2906 - val_accuracy100: 0.3763 - 20s/epoch - 38ms/step
Epoch 8/50
538/538 - 21s - loss: 3.2448 - accuracy100: 0.4001 - val_loss: 3.2891 - val_accuracy100: 0.3751 - 21s/epoch - 38ms/step
Epoch 9/50
538/538 - 20s - loss: 3.2410 - accuracy100: 0.4022 - val_loss: 3.2899 - val_accuracy100: 0.3762 - 20s/epoch - 38ms/step
Epoch 10/50
538/538 - 20s - loss: 3.2364 - accuracy100: 0.4036 - val_loss: 3.2897 - val_accuracy100: 0.3766 - 20s/epoch - 38ms/step
Epoch 11/50
538/538 - 21s - loss: 3.2317 - accuracy100: 0.4088 - val_loss: 3.2931 - val_accuracy100: 0.3773 - 21s/epoch - 38ms/step
Epoch 12/50
538/538 - 20s - loss: 3.2295 - accuracy100: 0.4083 - val_loss: 3.2923 - val_accuracy100: 0.3760 - 20s/epoch - 38ms/step
Epoch 13/50
538/538 - 21s - loss: 3.2241 - accuracy100: 0.4117 - val_loss: 3.2918 - val_accuracy100: 0.3787 - 21s/epoch - 38ms/step
Epoch 14/50
538/538 - 21s - loss: 3.2205 - accuracy100: 0.4133 - val_loss: 3.2949 - val_accuracy100: 0.3791 - 21s/epoch - 39ms/step
Epoch 15/50
538/538 - 21s - loss: 3.2148 - accuracy100: 0.4163 - val_loss: 3.2920 - val_accuracy100: 0.3829 - 21s/epoch - 38ms/step
Epoch 16/50
538/538 - 21s - loss: 3.2099 - accuracy100: 0.4182 - val_loss: 3.3028 - val_accuracy100: 0.3793 - 21s/epoch - 39ms/step
Epoch 17/50
538/538 - 21s - loss: 3.2046 - accuracy100: 0.4218 - val_loss: 3.3013 - val_accuracy100: 0.3795 - 21s/epoch - 38ms/step
Epoch 18/50
538/538 - 21s - loss: 3.1985 - accuracy100: 0.4248 - val_loss: 3.3048 - val_accuracy100: 0.3809 - 21s/epoch - 39ms/step
testing model: results/PCAR/W4/deepVOL_L3/h100
Evaluating performance on  test set...
1590/1590 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0973547
{'0': {'precision': 0.3582904884318766, 'recall': 0.3453188392331754, 'f1-score': 0.35168509202163734, 'support': 129156}, '1': {'precision': 0.4125335639193556, 'recall': 0.2993672223836825, 'f1-score': 0.3469557262660711, 'support': 151396}, '2': {'precision': 0.3495337387778743, 'recall': 0.4772664362598167, 'f1-score': 0.4035333491589572, 'support': 126443}, 'accuracy': 0.36921829506504994, 'macro avg': {'precision': 0.3734525970430355, 'recall': 0.37398416595889156, 'f1-score': 0.3673913891488885, 'support': 406995}, 'weighted avg': {'precision': 0.3757475946862565, 'recall': 0.36921829506504994, 'f1-score': 0.366033774730969, 'support': 406995}}
[[44600 31144 53412]
 [47182 45323 58891]
 [32698 33398 60347]]
Evaluating performance on  train set...
538/538 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0847635
{'0': {'precision': 0.39429530201342283, 'recall': 0.36047683744576414, 'f1-score': 0.3766284314398883, 'support': 45634}, '1': {'precision': 0.41270688734650296, 'recall': 0.23795074758135445, 'f1-score': 0.301860478089872, 'support': 45480}, '2': {'precision': 0.38224790970499234, 'recall': 0.5725056384921061, 'f1-score': 0.45842004781479506, 'support': 46555}, 'accuracy': 0.3917003828022285, 'macro avg': {'precision': 0.396416699688306, 'recall': 0.39031107450640823, 'f1-score': 0.3789696524481851, 'support': 137669}, 'weighted avg': {'precision': 0.39630368844776537, 'recall': 0.3917003828022285, 'f1-score': 0.37958742861408895, 'support': 137669}}
[[16450  7819 21365]
 [12949 10822 21709]
 [12321  7581 26653]]
Evaluating performance on  val set...
209/209 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0951408
{'0': {'precision': 0.3797150041911148, 'recall': 0.32791358093435047, 'f1-score': 0.35191825026891355, 'support': 17959}, '1': {'precision': 0.4031067533325989, 'recall': 0.200021866287651, 'f1-score': 0.2673730361709901, 'support': 18293}, '2': {'precision': 0.3664637099564104, 'recall': 0.6144431554524362, 'f1-score': 0.4591080483682226, 'support': 17240}, 'accuracy': 0.3765235923128692, 'macro avg': {'precision': 0.3830951558267081, 'recall': 0.38079286755814595, 'f1-score': 0.3594664449360421, 'support': 53492}, 'weighted avg': {'precision': 0.3834436543526131, 'recall': 0.3765235923128692, 'f1-score': 0.35755211173864315, 'support': 53492}}
[[ 5889  3051  9019]
 [ 5340  3659  9294]
 [ 4280  2367 10593]]
training model: results/PCAR/W4/deepVOL_L3/h200
Epoch 1/50
538/538 - 24s - loss: 3.3270 - accuracy200: 0.3577 - val_loss: 3.3373 - val_accuracy200: 0.3338 - 24s/epoch - 45ms/step
Epoch 2/50
538/538 - 21s - loss: 3.2863 - accuracy200: 0.3703 - val_loss: 3.3114 - val_accuracy200: 0.3570 - 21s/epoch - 40ms/step
Epoch 3/50
538/538 - 21s - loss: 3.2629 - accuracy200: 0.3830 - val_loss: 3.3151 - val_accuracy200: 0.3625 - 21s/epoch - 40ms/step
Epoch 4/50
538/538 - 21s - loss: 3.2490 - accuracy200: 0.3893 - val_loss: 3.3097 - val_accuracy200: 0.3615 - 21s/epoch - 40ms/step
Epoch 5/50
538/538 - 21s - loss: 3.2391 - accuracy200: 0.3978 - val_loss: 3.3037 - val_accuracy200: 0.3665 - 21s/epoch - 40ms/step
Epoch 6/50
538/538 - 21s - loss: 3.2327 - accuracy200: 0.4029 - val_loss: 3.3008 - val_accuracy200: 0.3693 - 21s/epoch - 40ms/step
Epoch 7/50
538/538 - 21s - loss: 3.2267 - accuracy200: 0.4051 - val_loss: 3.3116 - val_accuracy200: 0.3723 - 21s/epoch - 39ms/step
Epoch 8/50
538/538 - 21s - loss: 3.2219 - accuracy200: 0.4095 - val_loss: 3.3004 - val_accuracy200: 0.3701 - 21s/epoch - 39ms/step
Epoch 9/50
538/538 - 21s - loss: 3.2129 - accuracy200: 0.4152 - val_loss: 3.3073 - val_accuracy200: 0.3714 - 21s/epoch - 39ms/step
Epoch 10/50
538/538 - 21s - loss: 3.2107 - accuracy200: 0.4168 - val_loss: 3.3066 - val_accuracy200: 0.3723 - 21s/epoch - 39ms/step
Epoch 11/50
538/538 - 21s - loss: 3.2048 - accuracy200: 0.4193 - val_loss: 3.3036 - val_accuracy200: 0.3747 - 21s/epoch - 40ms/step
Epoch 12/50
538/538 - 21s - loss: 3.2020 - accuracy200: 0.4210 - val_loss: 3.3000 - val_accuracy200: 0.3748 - 21s/epoch - 40ms/step
Epoch 13/50
538/538 - 21s - loss: 3.1956 - accuracy200: 0.4237 - val_loss: 3.3175 - val_accuracy200: 0.3731 - 21s/epoch - 40ms/step
Epoch 14/50
538/538 - 21s - loss: 3.1920 - accuracy200: 0.4252 - val_loss: 3.3306 - val_accuracy200: 0.3706 - 21s/epoch - 39ms/step
Epoch 15/50
538/538 - 21s - loss: 3.1854 - accuracy200: 0.4269 - val_loss: 3.3329 - val_accuracy200: 0.3695 - 21s/epoch - 39ms/step
Epoch 16/50
538/538 - 21s - loss: 3.1822 - accuracy200: 0.4294 - val_loss: 3.3325 - val_accuracy200: 0.3708 - 21s/epoch - 39ms/step
Epoch 17/50
538/538 - 21s - loss: 3.1772 - accuracy200: 0.4317 - val_loss: 3.3446 - val_accuracy200: 0.3688 - 21s/epoch - 39ms/step
Epoch 18/50
538/538 - 21s - loss: 3.1698 - accuracy200: 0.4351 - val_loss: 3.3656 - val_accuracy200: 0.3662 - 21s/epoch - 39ms/step
Epoch 19/50
538/538 - 21s - loss: 3.1644 - accuracy200: 0.4375 - val_loss: 3.3649 - val_accuracy200: 0.3664 - 21s/epoch - 39ms/step
Epoch 20/50
538/538 - 21s - loss: 3.1614 - accuracy200: 0.4377 - val_loss: 3.3671 - val_accuracy200: 0.3634 - 21s/epoch - 39ms/step
Epoch 21/50
538/538 - 21s - loss: 3.1550 - accuracy200: 0.4405 - val_loss: 3.3752 - val_accuracy200: 0.3635 - 21s/epoch - 39ms/step
Epoch 22/50
538/538 - 21s - loss: 3.1500 - accuracy200: 0.4418 - val_loss: 3.3850 - val_accuracy200: 0.3631 - 21s/epoch - 39ms/step
testing model: results/PCAR/W4/deepVOL_L3/h200
Evaluating performance on  test set...
1590/1590 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0978744
{'0': {'precision': 0.35896744365247546, 'recall': 0.21568627450980393, 'f1-score': 0.26946436834798704, 'support': 129591}, '1': {'precision': 0.43241276920437943, 'recall': 0.4802903882793509, 'f1-score': 0.4550958219333713, 'support': 152210}, '2': {'precision': 0.33647160251644626, 'recall': 0.43019633528763357, 'f1-score': 0.37760507044425984, 'support': 125194}, 'accuracy': 0.38062875465300555, 'macro avg': {'precision': 0.3759506051244337, 'recall': 0.37539099935892944, 'f1-score': 0.36738842024187274, 'support': 406995}, 'weighted avg': {'precision': 0.379515039242277, 'recall': 0.38062875465300555, 'f1-score': 0.37215243726399855, 'support': 406995}}
[[27951 47605 54035]
 [26931 73105 52174]
 [22983 48353 53858]]
Evaluating performance on  train set...
538/538 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0808774
{'0': {'precision': 0.39707521804708507, 'recall': 0.26680473242415564, 'f1-score': 0.3191587491928789, 'support': 45389}, '1': {'precision': 0.4379773760030939, 'recall': 0.3986886400140817, 'f1-score': 0.41741053431773417, 'support': 45449}, '2': {'precision': 0.3873159166552683, 'recall': 0.5441908137771989, 'f1-score': 0.4525437272485129, 'support': 46831}, 'accuracy': 0.40470258373344764, 'macro avg': {'precision': 0.4074561702351491, 'recall': 0.40322806207181205, 'f1-score': 0.3963710035863753, 'support': 137669}, 'weighted avg': {'precision': 0.40725851518342276, 'recall': 0.40470258373344764, 'f1-score': 0.3969685487081143, 'support': 137669}}
[[12110 11617 21662]
 [ 8677 18120 18652]
 [ 9711 11635 25485]]
Evaluating performance on  val set...
209/209 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0985546
{'0': {'precision': 0.4022660362208939, 'recall': 0.23637030824072133, 'f1-score': 0.2977711738484398, 'support': 19076}, '1': {'precision': 0.3883288760885963, 'recall': 0.333000117605551, 'f1-score': 0.3585425306277501, 'support': 17006}, '2': {'precision': 0.3571841155234657, 'recall': 0.5682940838598507, 'f1-score': 0.43866105076479717, 'support': 17410}, 'accuracy': 0.3751215134973454, 'macro avg': {'precision': 0.38259300927765194, 'recall': 0.37922150323537435, 'f1-score': 0.3649915850803291, 'support': 53492}, 'weighted avg': {'precision': 0.3831624023213934, 'recall': 0.3751215134973454, 'f1-score': 0.3629467225380146, 'support': 53492}}
[[4509 4914 9653]
 [3190 5663 8153]
 [3510 4006 9894]]
training model: results/PCAR/W4/deepVOL_L3/h300
Epoch 1/50
538/538 - 23s - loss: 3.3369 - accuracy300: 0.3542 - val_loss: 3.3425 - val_accuracy300: 0.3309 - 23s/epoch - 42ms/step
Epoch 2/50
538/538 - 22s - loss: 3.2843 - accuracy300: 0.3690 - val_loss: 3.3223 - val_accuracy300: 0.3432 - 22s/epoch - 40ms/step
Epoch 3/50
538/538 - 21s - loss: 3.2611 - accuracy300: 0.3811 - val_loss: 3.3333 - val_accuracy300: 0.3463 - 21s/epoch - 40ms/step
Epoch 4/50
538/538 - 21s - loss: 3.2496 - accuracy300: 0.3879 - val_loss: 3.3156 - val_accuracy300: 0.3489 - 21s/epoch - 40ms/step
Epoch 5/50
538/538 - 21s - loss: 3.2416 - accuracy300: 0.3918 - val_loss: 3.3149 - val_accuracy300: 0.3509 - 21s/epoch - 40ms/step
Epoch 6/50
538/538 - 21s - loss: 3.2347 - accuracy300: 0.3978 - val_loss: 3.3213 - val_accuracy300: 0.3507 - 21s/epoch - 39ms/step
Epoch 7/50
538/538 - 21s - loss: 3.2312 - accuracy300: 0.4010 - val_loss: 3.3180 - val_accuracy300: 0.3493 - 21s/epoch - 39ms/step
Epoch 8/50
538/538 - 21s - loss: 3.2265 - accuracy300: 0.4022 - val_loss: 3.3202 - val_accuracy300: 0.3541 - 21s/epoch - 40ms/step
Epoch 9/50
538/538 - 21s - loss: 3.2220 - accuracy300: 0.4059 - val_loss: 3.3269 - val_accuracy300: 0.3515 - 21s/epoch - 40ms/step
Epoch 10/50
538/538 - 21s - loss: 3.2187 - accuracy300: 0.4082 - val_loss: 3.3309 - val_accuracy300: 0.3504 - 21s/epoch - 39ms/step
Epoch 11/50
538/538 - 22s - loss: 3.2137 - accuracy300: 0.4123 - val_loss: 3.3369 - val_accuracy300: 0.3528 - 22s/epoch - 40ms/step
Epoch 12/50
538/538 - 21s - loss: 3.2113 - accuracy300: 0.4141 - val_loss: 3.3562 - val_accuracy300: 0.3518 - 21s/epoch - 40ms/step
Epoch 13/50
538/538 - 21s - loss: 3.2072 - accuracy300: 0.4170 - val_loss: 3.3533 - val_accuracy300: 0.3509 - 21s/epoch - 40ms/step
Epoch 14/50
538/538 - 21s - loss: 3.1994 - accuracy300: 0.4224 - val_loss: 3.3611 - val_accuracy300: 0.3499 - 21s/epoch - 39ms/step
Epoch 15/50
538/538 - 21s - loss: 3.1951 - accuracy300: 0.4239 - val_loss: 3.3720 - val_accuracy300: 0.3532 - 21s/epoch - 39ms/step
testing model: results/PCAR/W4/deepVOL_L3/h300
Evaluating performance on  test set...
1590/1590 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0941886
{'0': {'precision': 0.4078629318925068, 'recall': 0.04354988082044119, 'f1-score': 0.0786968449931413, 'support': 131734}, '1': {'precision': 0.3996597887151193, 'recall': 0.6740618153948412, 'f1-score': 0.5017974895735505, 'support': 147439}, '2': {'precision': 0.32548176902814363, 'recall': 0.36733895573531944, 'f1-score': 0.34514594864783416, 'support': 127822}, 'accuracy': 0.3736507819506382, 'macro avg': {'precision': 0.37766816321192326, 'recall': 0.36165021731686725, 'f1-score': 0.3085467610715087, 'support': 406995}, 'weighted avg': {'precision': 0.3790183804199348, 'recall': 0.3736507819506382, 'f1-score': 0.31565207359211944, 'support': 406995}}
[[ 5737 72583 53414]
 [ 4164 99383 43892]
 [ 4165 76703 46954]]
Evaluating performance on  train set...
538/538 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0833243
{'0': {'precision': 0.41167023554603854, 'recall': 0.05105676662609273, 'f1-score': 0.09084644312744886, 'support': 45185}, '1': {'precision': 0.39931439481601483, 'recall': 0.6067205837106061, 'f1-score': 0.48163785132329595, 'support': 45502}, '2': {'precision': 0.3817794657471118, 'recall': 0.5113660550849262, 'f1-score': 0.4371718936230222, 'support': 46982}, 'accuracy': 0.39180207599386935, 'macro avg': {'precision': 0.39758803203638843, 'recall': 0.389714468473875, 'f1-score': 0.33655206269125565, 'support': 137669}, 'weighted avg': {'precision': 0.39738565723435826, 'recall': 0.39180207599386935, 'f1-score': 0.338199536205124, 'support': 137669}}
[[ 2307 20626 22252]
 [ 1243 27607 16652]
 [ 2054 20903 24025]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1028197
{'0': {'precision': 0.3751595065929392, 'recall': 0.04627977752125092, 'f1-score': 0.08239525433229015, 'support': 19058}, '1': {'precision': 0.35977246324560347, 'recall': 0.5144346431435445, 'f1-score': 0.4234223615662054, 'support': 17458}, '2': {'precision': 0.33948353579341434, 'recall': 0.5235037700282752, 'f1-score': 0.4118737544607684, 'support': 16976}, 'accuracy': 0.35051970388095416, 'macro avg': {'precision': 0.35813850187731894, 'recall': 0.36140606356435684, 'f1-score': 0.305897123453088, 'support': 53492}, 'weighted avg': {'precision': 0.3588157115759175, 'recall': 0.35051970388095416, 'f1-score': 0.29825703284628735, 'support': 53492}}
[[ 882 8695 9481]
 [ 667 8981 7810]
 [ 802 7287 8887]]
training model: results/PCAR/W4/deepVOL_L3/h500
Epoch 1/50
538/538 - 23s - loss: 3.3291 - accuracy500: 0.3549 - val_loss: 3.3554 - val_accuracy500: 0.3195 - 23s/epoch - 42ms/step
Epoch 2/50
538/538 - 21s - loss: 3.3050 - accuracy500: 0.3458 - val_loss: 3.3132 - val_accuracy500: 0.3284 - 21s/epoch - 38ms/step
Epoch 3/50
538/538 - 21s - loss: 3.2931 - accuracy500: 0.3566 - val_loss: 3.3127 - val_accuracy500: 0.3375 - 21s/epoch - 38ms/step
Epoch 4/50
538/538 - 21s - loss: 3.2811 - accuracy500: 0.3678 - val_loss: 3.3134 - val_accuracy500: 0.3360 - 21s/epoch - 38ms/step
Epoch 5/50
538/538 - 20s - loss: 3.2704 - accuracy500: 0.3744 - val_loss: 3.3153 - val_accuracy500: 0.3363 - 20s/epoch - 38ms/step
Epoch 6/50
538/538 - 20s - loss: 3.2635 - accuracy500: 0.3796 - val_loss: 3.3174 - val_accuracy500: 0.3391 - 20s/epoch - 38ms/step
Epoch 7/50
538/538 - 20s - loss: 3.2572 - accuracy500: 0.3833 - val_loss: 3.3082 - val_accuracy500: 0.3478 - 20s/epoch - 38ms/step
Epoch 8/50
538/538 - 20s - loss: 3.2513 - accuracy500: 0.3888 - val_loss: 3.3136 - val_accuracy500: 0.3507 - 20s/epoch - 38ms/step
Epoch 9/50
538/538 - 21s - loss: 3.2450 - accuracy500: 0.3928 - val_loss: 3.3111 - val_accuracy500: 0.3574 - 21s/epoch - 38ms/step
Epoch 10/50
538/538 - 20s - loss: 3.2354 - accuracy500: 0.3983 - val_loss: 3.3174 - val_accuracy500: 0.3535 - 20s/epoch - 38ms/step
Epoch 11/50
538/538 - 20s - loss: 3.2313 - accuracy500: 0.4050 - val_loss: 3.3281 - val_accuracy500: 0.3532 - 20s/epoch - 38ms/step
Epoch 12/50
538/538 - 20s - loss: 3.2254 - accuracy500: 0.4073 - val_loss: 3.3326 - val_accuracy500: 0.3496 - 20s/epoch - 38ms/step
Epoch 13/50
538/538 - 20s - loss: 3.2182 - accuracy500: 0.4123 - val_loss: 3.3418 - val_accuracy500: 0.3439 - 20s/epoch - 38ms/step
Epoch 14/50
538/538 - 21s - loss: 3.2088 - accuracy500: 0.4171 - val_loss: 3.3488 - val_accuracy500: 0.3472 - 21s/epoch - 38ms/step
Epoch 15/50
538/538 - 21s - loss: 3.1998 - accuracy500: 0.4220 - val_loss: 3.3555 - val_accuracy500: 0.3521 - 21s/epoch - 38ms/step
Epoch 16/50
538/538 - 20s - loss: 3.1927 - accuracy500: 0.4245 - val_loss: 3.3666 - val_accuracy500: 0.3484 - 20s/epoch - 38ms/step
Epoch 17/50
538/538 - 20s - loss: 3.1863 - accuracy500: 0.4283 - val_loss: 3.3757 - val_accuracy500: 0.3518 - 20s/epoch - 38ms/step
testing model: results/PCAR/W4/deepVOL_L3/h500
Evaluating performance on  test set...
1590/1590 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1006591
{'0': {'precision': 0.3420937267107974, 'recall': 0.11704313654907607, 'f1-score': 0.17441301699764203, 'support': 133344}, '1': {'precision': 0.394493594214603, 'recall': 0.3682998382365037, 'f1-score': 0.3809469792305483, 'support': 145892}, '2': {'precision': 0.32404249271654945, 'recall': 0.5711065365258025, 'f1-score': 0.4134792747508692, 'support': 127759}, 'accuracy': 0.34964311600879616, 'macro avg': {'precision': 0.35354327121398327, 'recall': 0.3521498371037941, 'f1-score': 0.3229464236596865, 'support': 406995}, 'weighted avg': {'precision': 0.3552106295375989, 'recall': 0.34964311600879616, 'f1-score': 0.32349229031151006, 'support': 406995}}
[[15607 40647 77090]
 [17046 53732 75114]
 [12969 41826 72964]]
Evaluating performance on  train set...
538/538 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0862558
{'0': {'precision': 0.3798296576231034, 'recall': 0.1499142901667446, 'f1-score': 0.214978929894011, 'support': 44919}, '1': {'precision': 0.4295405922756446, 'recall': 0.33511958359870864, 'f1-score': 0.3765004873113981, 'support': 45533}, '2': {'precision': 0.3679041887793783, 'recall': 0.6577503865133321, 'f1-score': 0.47187255475450685, 'support': 47217}, 'accuracy': 0.3853445583246773, 'macro avg': {'precision': 0.3924248128927088, 'recall': 0.38092808675959516, 'f1-score': 0.354450657319972, 'support': 137669}, 'weighted avg': {'precision': 0.39218104482821126, 'recall': 0.3853445583246773, 'f1-score': 0.3565090300539883, 'support': 137669}}
[[ 6734  9805 28380]
 [ 5295 15259 24979]
 [ 5700 10460 31057]]
Evaluating performance on  val set...
209/209 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.099573
{'0': {'precision': 0.38293980711672765, 'recall': 0.1214662447257384, 'f1-score': 0.18443180908144471, 'support': 18960}, '1': {'precision': 0.39135465740970327, 'recall': 0.2671669581899227, 'f1-score': 0.3175508014217691, 'support': 17723}, '2': {'precision': 0.3277933237231126, 'recall': 0.6899280147540008, 'f1-score': 0.4444316701157354, 'support': 16809}, 'accuracy': 0.34836984969715096, 'macro avg': {'precision': 0.36736259608318117, 'recall': 0.3595204058898873, 'f1-score': 0.3154714268729831, 'support': 53492}, 'weighted avg': {'precision': 0.368398925347101, 'recall': 0.34836984969715096, 'f1-score': 0.31023764108198615, 'support': 53492}}
[[ 2303  3896 12761]
 [ 1967  4735 11021]
 [ 1744  3468 11597]]
training model: results/PCAR/W4/deepVOL_L3/h1000
Epoch 1/50
538/538 - 23s - loss: 3.3402 - accuracy1000: 0.3625 - val_loss: 3.3370 - val_accuracy1000: 0.3162 - 23s/epoch - 43ms/step
Epoch 2/50
538/538 - 20s - loss: 3.3137 - accuracy1000: 0.3371 - val_loss: 3.3131 - val_accuracy1000: 0.3227 - 20s/epoch - 38ms/step
Epoch 3/50
538/538 - 21s - loss: 3.3043 - accuracy1000: 0.3435 - val_loss: 3.3096 - val_accuracy1000: 0.3320 - 21s/epoch - 39ms/step
Epoch 4/50
538/538 - 21s - loss: 3.2987 - accuracy1000: 0.3511 - val_loss: 3.3080 - val_accuracy1000: 0.3404 - 21s/epoch - 38ms/step
Epoch 5/50
538/538 - 21s - loss: 3.2916 - accuracy1000: 0.3559 - val_loss: 3.3083 - val_accuracy1000: 0.3458 - 21s/epoch - 38ms/step
Epoch 6/50
538/538 - 20s - loss: 3.2842 - accuracy1000: 0.3647 - val_loss: 3.3102 - val_accuracy1000: 0.3513 - 20s/epoch - 38ms/step
Epoch 7/50
538/538 - 21s - loss: 3.2708 - accuracy1000: 0.3765 - val_loss: 3.3141 - val_accuracy1000: 0.3545 - 21s/epoch - 38ms/step
Epoch 8/50
538/538 - 21s - loss: 3.2689 - accuracy1000: 0.3761 - val_loss: 3.3190 - val_accuracy1000: 0.3444 - 21s/epoch - 38ms/step
Epoch 9/50
538/538 - 21s - loss: 3.2630 - accuracy1000: 0.3836 - val_loss: 3.3226 - val_accuracy1000: 0.3506 - 21s/epoch - 39ms/step
Epoch 10/50
538/538 - 21s - loss: 3.2548 - accuracy1000: 0.3903 - val_loss: 3.3205 - val_accuracy1000: 0.3504 - 21s/epoch - 38ms/step
Epoch 11/50
538/538 - 21s - loss: 3.2479 - accuracy1000: 0.3946 - val_loss: 3.3203 - val_accuracy1000: 0.3530 - 21s/epoch - 38ms/step
Epoch 12/50
538/538 - 21s - loss: 3.2422 - accuracy1000: 0.3969 - val_loss: 3.3257 - val_accuracy1000: 0.3516 - 21s/epoch - 39ms/step
Epoch 13/50
538/538 - 21s - loss: 3.2381 - accuracy1000: 0.3994 - val_loss: 3.3285 - val_accuracy1000: 0.3505 - 21s/epoch - 38ms/step
Epoch 14/50
538/538 - 21s - loss: 3.2281 - accuracy1000: 0.4036 - val_loss: 3.3422 - val_accuracy1000: 0.3517 - 21s/epoch - 38ms/step
testing model: results/PCAR/W4/deepVOL_L3/h1000
Evaluating performance on  test set...
1590/1590 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0966921
{'0': {'precision': 0.3590950258386461, 'recall': 0.14996514335721384, 'f1-score': 0.21157317066790826, 'support': 134838}, '1': {'precision': 0.3745876519403602, 'recall': 0.3889004082624892, 'f1-score': 0.38160987280138636, 'support': 139861}, '2': {'precision': 0.33857961154181204, 'recall': 0.5258737981496039, 'f1-score': 0.41193694027089034, 'support': 132296}, 'accuracy': 0.3542647944077937, 'macro avg': {'precision': 0.35742076310693943, 'recall': 0.35491311658976893, 'f1-score': 0.3350399945800617, 'support': 406995}, 'weighted avg': {'precision': 0.35775030889961207, 'recall': 0.3542647944077937, 'f1-score': 0.33513446370710165, 'support': 406995}}
[[20221 43523 71094]
 [20655 54392 64814]
 [15435 47290 69571]]
Evaluating performance on  train set...
538/538 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.091539
{'0': {'precision': 0.3747768776603048, 'recall': 0.12110120236035317, 'f1-score': 0.18305277982697338, 'support': 45078}, '1': {'precision': 0.3990996428751069, 'recall': 0.3542108435079574, 'f1-score': 0.3753178103898868, 'support': 44801}, '2': {'precision': 0.36805413901921025, 'recall': 0.6418497593638837, 'f1-score': 0.46783750600544494, 'support': 47790}, 'accuracy': 0.37773209655042167, 'macro avg': {'precision': 0.380643553184874, 'recall': 0.3723872684107314, 'f1-score': 0.3420693654074351, 'support': 137669}, 'weighted avg': {'precision': 0.38035841398823944, 'recall': 0.37773209655042167, 'f1-score': 0.3444800270526977, 'support': 137669}}
[[ 5459 11445 28174]
 [ 4439 15869 24493]
 [ 4668 12448 30674]]
Evaluating performance on  val set...
209/209 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984861
{'0': {'precision': 0.39384116693679094, 'recall': 0.12272727272727273, 'f1-score': 0.18713900654601465, 'support': 19800}, '1': {'precision': 0.36290103317020117, 'recall': 0.3107864252866872, 'f1-score': 0.33482800790191586, 'support': 17179}, '2': {'precision': 0.3265869365225391, 'recall': 0.6449464058620481, 'f1-score': 0.43360543940720236, 'support': 16513}, 'accuracy': 0.3443318627084424, 'macro avg': {'precision': 0.3611097122098437, 'recall': 0.35948670129200266, 'f1-score': 0.3185241512850443, 'support': 53492}, 'weighted avg': {'precision': 0.3631433118405749, 'recall': 0.3443318627084424, 'f1-score': 0.31065372949766756, 'support': 53492}}
[[ 2430  5243 12127]
 [ 2007  5339  9833]
 [ 1733  4130 10650]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        12 (peak)  11.15 (ave)

============================================
